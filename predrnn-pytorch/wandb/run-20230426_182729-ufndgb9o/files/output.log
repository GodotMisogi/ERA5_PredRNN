After initialize model, args.img_channel:30
load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
train_data_files nums: 41
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448368638753891, gen p mean: -0.2531047463417053, mean p set: 0.44894084334373474
The modified gen p mean: 0.4475838541984558, gen p mean: -0.2477123886346817, mean p set: 0.44816192984580994
loss_pred:0.015767952427268028, decouple_loss:0.003200629260390997
loss_pred:0.015413961373269558, decouple_loss:0.003704468486830592
The modified gen p mean: 0.44849374890327454, gen p mean: -0.24818451702594757, mean p set: 0.4490780532360077
loss_pred:0.015756720677018166, decouple_loss:0.0035488882567733526
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447017103433609, gen p mean: -0.21939797699451447, mean p set: 0.44759488105773926
loss_pred:0.02701430581510067, decouple_loss:0.031100088730454445
The modified gen p mean: 0.4473775029182434, gen p mean: -0.22619786858558655, mean p set: 0.4479498863220215
loss_pred:0.02570812590420246, decouple_loss:0.031312085688114166
The modified gen p mean: 0.4478594958782196, gen p mean: -0.23196221888065338, mean p set: 0.44843214750289917
loss_pred:0.026208313181996346, decouple_loss:0.031251631677150726
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479326605796814, gen p mean: -0.271135538816452, mean p set: 0.4485081434249878
loss_pred:0.021145012229681015, decouple_loss:0.02492549456655979
The modified gen p mean: 0.4480561316013336, gen p mean: -0.27384600043296814, mean p set: 0.4486263692378998
loss_pred:0.021108584478497505, decouple_loss:0.025150800123810768
The modified gen p mean: 0.4472656548023224, gen p mean: -0.26813259720802307, mean p set: 0.44784215092658997
loss_pred:0.020512200891971588, decouple_loss:0.02626408264040947
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787514209747314, gen p mean: -0.30323609709739685, mean p set: 0.44844159483909607
loss_pred:0.02209942601621151, decouple_loss:0.015986088663339615
The modified gen p mean: 0.44651541113853455, gen p mean: -0.2994687557220459, mean p set: 0.4470933675765991
The modified gen p mean: 0.44726675748825073, gen p mean: -0.2932150363922119, mean p set: 0.4477945566177368
loss_pred:0.023232605308294296, decouple_loss:0.016028787940740585
loss_pred:0.022637637332081795, decouple_loss:0.016058599576354027
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700026512145996, gen p mean: -0.29961472749710083, mean p set: 0.4475710391998291
loss_pred:0.02154483087360859, decouple_loss:0.01351888943463564
The modified gen p mean: 0.4480760097503662, gen p mean: -0.29542267322540283, mean p set: 0.44865697622299194
loss_pred:0.02262621559202671, decouple_loss:0.013566247187554836
The modified gen p mean: 0.4480321407318115, gen p mean: -0.2927282750606537, mean p set: 0.44856035709381104
loss_pred:0.02237282320857048, decouple_loss:0.013900643214583397
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489292800426483, gen p mean: -0.29732373356819153, mean p set: 0.4495067000389099
loss_pred:0.02053206041455269, decouple_loss:0.013312019407749176
The modified gen p mean: 0.4471715986728668, gen p mean: -0.2914542257785797, mean p set: 0.4477514326572418
The modified gen p mean: 0.4472542405128479, gen p mean: -0.29700613021850586, mean p set: 0.44777724146842957
loss_pred:0.022953787818551064, decouple_loss:0.012940971180796623
loss_pred:0.022747930139303207, decouple_loss:0.012882266193628311
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762569665908813, gen p mean: -0.3014097213745117, mean p set: 0.4482114315032959
loss_pred:0.021151555702090263, decouple_loss:0.013447071425616741
The modified gen p mean: 0.4484066069126129, gen p mean: -0.30595386028289795, mean p set: 0.4489799737930298
loss_pred:0.022106816992163658, decouple_loss:0.01318073458969593
The modified gen p mean: 0.4487403333187103, gen p mean: -0.29892852902412415, mean p set: 0.4492571949958801
loss_pred:0.02099372074007988, decouple_loss:0.014492632821202278
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470504820346832, gen p mean: -0.28126150369644165, mean p set: 0.44763508439064026
loss_pred:0.020483259111642838, decouple_loss:0.013701234012842178
The modified gen p mean: 0.44822490215301514, gen p mean: -0.28682398796081543, mean p set: 0.4488038718700409
The modified gen p mean: 0.44740626215934753, gen p mean: -0.28374212980270386, mean p set: 0.4479329288005829
loss_pred:0.019901426509022713, decouple_loss:0.013430730439722538
loss_pred:0.020276494324207306, decouple_loss:0.01339919213205576
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473136067390442, gen p mean: -0.27081871032714844, mean p set: 0.44784268736839294
loss_pred:0.021442092955112457, decouple_loss:0.013816393911838531
The modified gen p mean: 0.4473549723625183, gen p mean: -0.2708496153354645, mean p set: 0.44793590903282166
loss_pred:0.020060105249285698, decouple_loss:0.013648749329149723
The modified gen p mean: 0.4468471109867096, gen p mean: -0.2729280889034271, mean p set: 0.4474125802516937
loss_pred:0.019267287105321884, decouple_loss:0.013472773134708405
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471581280231476, gen p mean: -0.268270879983902, mean p set: 0.44773516058921814
loss_pred:0.020207412540912628, decouple_loss:0.013218846172094345
The modified gen p mean: 0.448476105928421, gen p mean: -0.2675935626029968, mean p set: 0.44905373454093933
The modified gen p mean: 0.44860029220581055, gen p mean: -0.2694982588291168, mean p set: 0.449133038520813
loss_pred:0.019806833937764168, decouple_loss:0.012838528491556644
loss_pred:0.019656889140605927, decouple_loss:0.012864566408097744
2023-04-26 18:32:19 testing...
The modified gen p mean: 0.44938036799430847, gen p mean: -0.2611352503299713, mean p set: 0.4499112665653229
loss_pred:0.02149859629571438, decouple_loss:0.012050474993884563
The modified gen p mean: 0.44925254583358765, gen p mean: -0.2619916796684265, mean p set: 0.4498290419578552
The modified gen p mean: 0.44821712374687195, gen p mean: -0.25985410809516907, mean p set: 0.44879910349845886
loss_pred:0.020919177681207657, decouple_loss:0.012091086246073246
loss_pred:0.02151423692703247, decouple_loss:0.012000405229628086
WV_1_PC_1_EH_0_PS_30, loss: 0.021913036704063416, avg_mse: 0.031267523765563965
current test mse: 0.031268
At step 10, Best test: 0.031268
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481777250766754, gen p mean: -0.2633664906024933, mean p set: 0.4487045109272003
loss_pred:0.018890725448727608, decouple_loss:0.011774278245866299
The modified gen p mean: 0.447134405374527, gen p mean: -0.2586512863636017, mean p set: 0.44771671295166016
loss_pred:0.019440043717622757, decouple_loss:0.012060037814080715
The modified gen p mean: 0.4480648338794708, gen p mean: -0.26091092824935913, mean p set: 0.4486351013183594
loss_pred:0.01822987198829651, decouple_loss:0.011302493512630463
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480781555175781, gen p mean: -0.2695377469062805, mean p set: 0.44860297441482544
loss_pred:0.01744682900607586, decouple_loss:0.011018102057278156
The modified gen p mean: 0.4475537836551666, gen p mean: -0.2622872591018677, mean p set: 0.44812890887260437
The modified gen p mean: 0.4474189877510071, gen p mean: -0.263714998960495, mean p set: 0.4479990005493164
loss_pred:0.01861954852938652, decouple_loss:0.011097494512796402
loss_pred:0.01767454482614994, decouple_loss:0.011187588796019554
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838398694992065, gen p mean: -0.26476141810417175, mean p set: 0.4489099383354187
loss_pred:0.017429254949092865, decouple_loss:0.010231288149952888
The modified gen p mean: 0.447683721780777, gen p mean: -0.25835153460502625, mean p set: 0.4482528567314148
The modified gen p mean: 0.4492892324924469, gen p mean: -0.25572407245635986, mean p set: 0.4498658776283264
loss_pred:0.017143113538622856, decouple_loss:0.010694907046854496
loss_pred:0.0179856326431036, decouple_loss:0.010780809447169304
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492688477039337, gen p mean: -0.24769039452075958, mean p set: 0.4497953951358795
loss_pred:0.017761416733264923, decouple_loss:0.010075867176055908
The modified gen p mean: 0.44753432273864746, gen p mean: -0.2522880733013153, mean p set: 0.44811877608299255
The modified gen p mean: 0.44864025712013245, gen p mean: -0.2507881224155426, mean p set: 0.44921019673347473
loss_pred:0.01757439225912094, decouple_loss:0.009744346141815186
loss_pred:0.017485324293375015, decouple_loss:0.009914190508425236
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484490752220154, gen p mean: -0.24633747339248657, mean p set: 0.4489794969558716
loss_pred:0.018154611811041832, decouple_loss:0.009300585836172104
The modified gen p mean: 0.44825324416160583, gen p mean: -0.24684229493141174, mean p set: 0.4488280117511749
The modified gen p mean: 0.44786831736564636, gen p mean: -0.24122323095798492, mean p set: 0.4484385848045349
loss_pred:0.017805663868784904, decouple_loss:0.00944874994456768
loss_pred:0.017386093735694885, decouple_loss:0.009687021374702454
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757750630378723, gen p mean: -0.25172731280326843, mean p set: 0.4481014907360077
loss_pred:0.01698678359389305, decouple_loss:0.009023936465382576
The modified gen p mean: 0.4472109377384186, gen p mean: -0.25024518370628357, mean p set: 0.4477807283401489
The modified gen p mean: 0.44827800989151, gen p mean: -0.2506142258644104, mean p set: 0.4488556683063507
loss_pred:0.0179164819419384, decouple_loss:0.008973238989710808
loss_pred:0.017747195437550545, decouple_loss:0.009086964651942253
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480762481689453, gen p mean: -0.25014233589172363, mean p set: 0.4486044645309448
loss_pred:0.016722261905670166, decouple_loss:0.00900598056614399
The modified gen p mean: 0.4471874237060547, gen p mean: -0.2555450201034546, mean p set: 0.44776979088783264
The modified gen p mean: 0.4476836323738098, gen p mean: -0.25045186281204224, mean p set: 0.44825834035873413
loss_pred:0.01694432459771633, decouple_loss:0.008798468858003616
loss_pred:0.017112141475081444, decouple_loss:0.00892659556120634
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832491874694824, gen p mean: -0.24557450413703918, mean p set: 0.4488582909107208
loss_pred:0.017350241541862488, decouple_loss:0.008320057764649391
The modified gen p mean: 0.4480084180831909, gen p mean: -0.25360432267189026, mean p set: 0.4485870599746704
The modified gen p mean: 0.4489647150039673, gen p mean: -0.24939453601837158, mean p set: 0.4495420455932617
loss_pred:0.01654859073460102, decouple_loss:0.008129307068884373
loss_pred:0.016540618613362312, decouple_loss:0.008590289391577244
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474587142467499, gen p mean: -0.2405375987291336, mean p set: 0.44798383116722107
loss_pred:0.017959648743271828, decouple_loss:0.007908610627055168
The modified gen p mean: 0.44842529296875, gen p mean: -0.2449801117181778, mean p set: 0.4489966928958893
The modified gen p mean: 0.4479246437549591, gen p mean: -0.2504662871360779, mean p set: 0.4485073983669281
loss_pred:0.017211752012372017, decouple_loss:0.007699303328990936
loss_pred:0.016639595851302147, decouple_loss:0.007753584999591112
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483304023742676, gen p mean: -0.23913094401359558, mean p set: 0.4488586187362671
loss_pred:0.016487957909703255, decouple_loss:0.007611429318785667
The modified gen p mean: 0.4474632441997528, gen p mean: -0.2365776002407074, mean p set: 0.44803711771965027
The modified gen p mean: 0.4482954740524292, gen p mean: -0.2473539263010025, mean p set: 0.4488692879676819
loss_pred:0.01759709045290947, decouple_loss:0.007601373828947544
loss_pred:0.017241869121789932, decouple_loss:0.007412396837025881
2023-04-26 18:35:49 testing...
The modified gen p mean: 0.4482331871986389, gen p mean: -0.23622648417949677, mean p set: 0.44879910349845886
loss_pred:0.01932281255722046, decouple_loss:0.007385566830635071
The modified gen p mean: 0.44938406348228455, gen p mean: -0.2390296757221222, mean p set: 0.4499112665653229
loss_pred:0.019407805055379868, decouple_loss:0.007567071821540594
The modified gen p mean: 0.449258953332901, gen p mean: -0.23909024894237518, mean p set: 0.4498290419578552
loss_pred:0.018927542492747307, decouple_loss:0.007546084932982922
WV_1_PC_1_EH_0_PS_30, loss: 0.01959436759352684, avg_mse: 0.028406230732798576
current test mse: 0.028406
At step 20, Best test: 0.028406
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663551449775696, gen p mean: -0.2407866269350052, mean p set: 0.44715940952301025
loss_pred:0.01754719205200672, decouple_loss:0.007260340731590986
The modified gen p mean: 0.44621217250823975, gen p mean: -0.23851826786994934, mean p set: 0.4467838406562805
loss_pred:0.017059223726391792, decouple_loss:0.007364210672676563
The modified gen p mean: 0.4474985897541046, gen p mean: -0.2394150048494339, mean p set: 0.44808098673820496
loss_pred:0.0176997072994709, decouple_loss:0.007341371383517981
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473048150539398, gen p mean: -0.23739226162433624, mean p set: 0.4478280544281006
loss_pred:0.01697436533868313, decouple_loss:0.007329790852963924
The modified gen p mean: 0.44723570346832275, gen p mean: -0.24428395926952362, mean p set: 0.4478095471858978
loss_pred:0.01701519265770912, decouple_loss:0.007034659385681152
The modified gen p mean: 0.44672733545303345, gen p mean: -0.23981159925460815, mean p set: 0.4473038911819458
loss_pred:0.016921335831284523, decouple_loss:0.007022515870630741
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487529695034027, gen p mean: -0.23573315143585205, mean p set: 0.44927704334259033
loss_pred:0.01721804030239582, decouple_loss:0.007181343622505665
The modified gen p mean: 0.4463486075401306, gen p mean: -0.2331753373146057, mean p set: 0.4469289183616638
loss_pred:0.01702204719185829, decouple_loss:0.0068484763614833355
The modified gen p mean: 0.4472976624965668, gen p mean: -0.22843442857265472, mean p set: 0.44787678122520447
loss_pred:0.01745877042412758, decouple_loss:0.006929481867700815
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447162389755249, gen p mean: -0.22970663011074066, mean p set: 0.4476941227912903
loss_pred:0.017204981297254562, decouple_loss:0.00672620814293623
The modified gen p mean: 0.4457235038280487, gen p mean: -0.2291887104511261, mean p set: 0.44630563259124756
loss_pred:0.016547346487641335, decouple_loss:0.006450716871768236
The modified gen p mean: 0.44666972756385803, gen p mean: -0.2253689020872116, mean p set: 0.447246253490448
loss_pred:0.016419559717178345, decouple_loss:0.006576948333531618
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464276432991028, gen p mean: -0.22668582201004028, mean p set: 0.44695523381233215
loss_pred:0.016525261104106903, decouple_loss:0.006270978599786758
The modified gen p mean: 0.4473765194416046, gen p mean: -0.23052126169204712, mean p set: 0.447951078414917
loss_pred:0.016428954899311066, decouple_loss:0.006127765867859125
The modified gen p mean: 0.44599443674087524, gen p mean: -0.2247702181339264, mean p set: 0.4465752840042114
loss_pred:0.017259620130062103, decouple_loss:0.006420645862817764
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754859805107117, gen p mean: -0.2304679900407791, mean p set: 0.448073148727417
loss_pred:0.016881324350833893, decouple_loss:0.006129519548267126
The modified gen p mean: 0.4480170011520386, gen p mean: -0.22879719734191895, mean p set: 0.44858697056770325
loss_pred:0.017077933996915817, decouple_loss:0.006172786001116037
The modified gen p mean: 0.4463233947753906, gen p mean: -0.22791427373886108, mean p set: 0.44689324498176575
loss_pred:0.017454350367188454, decouple_loss:0.006212203297764063
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470052719116211, gen p mean: -0.22946971654891968, mean p set: 0.44752782583236694
loss_pred:0.01705826446413994, decouple_loss:0.005870358552783728
The modified gen p mean: 0.44741910696029663, gen p mean: -0.2334567904472351, mean p set: 0.44799599051475525
loss_pred:0.016061600297689438, decouple_loss:0.005904796067625284
The modified gen p mean: 0.44558438658714294, gen p mean: -0.23377865552902222, mean p set: 0.4461599588394165
loss_pred:0.017169859260320663, decouple_loss:0.006023688241839409
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741159677505493, gen p mean: -0.23433226346969604, mean p set: 0.44794052839279175
loss_pred:0.016356851905584335, decouple_loss:0.005843116901814938
The modified gen p mean: 0.44810351729393005, gen p mean: -0.22681531310081482, mean p set: 0.44868341088294983
loss_pred:0.016671407967805862, decouple_loss:0.005978670436888933
The modified gen p mean: 0.4460481107234955, gen p mean: -0.22020313143730164, mean p set: 0.4466271698474884
loss_pred:0.016549106687307358, decouple_loss:0.00591764273121953
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452134072780609, gen p mean: -0.2337196320295334, mean p set: 0.44573795795440674
loss_pred:0.016614576801657677, decouple_loss:0.005555103998631239
The modified gen p mean: 0.4480803906917572, gen p mean: -0.22858166694641113, mean p set: 0.44865259528160095
loss_pred:0.016371188685297966, decouple_loss:0.005506661254912615
The modified gen p mean: 0.44583335518836975, gen p mean: -0.22436551749706268, mean p set: 0.4464118480682373
loss_pred:0.017285114154219627, decouple_loss:0.005387046840041876
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776710867881775, gen p mean: -0.22917883098125458, mean p set: 0.4482913017272949
loss_pred:0.016550954431295395, decouple_loss:0.005384867545217276
The modified gen p mean: 0.44637733697891235, gen p mean: -0.22718825936317444, mean p set: 0.44694921374320984
loss_pred:0.016613775864243507, decouple_loss:0.005301032215356827
The modified gen p mean: 0.4462249279022217, gen p mean: -0.22622855007648468, mean p set: 0.44680535793304443
loss_pred:0.016107013449072838, decouple_loss:0.005114251282066107
2023-04-26 18:39:56 testing...
The modified gen p mean: 0.449382483959198, gen p mean: -0.22741784155368805, mean p set: 0.4499112665653229
loss_pred:0.018710676580667496, decouple_loss:0.005072482395917177
The modified gen p mean: 0.4482251703739166, gen p mean: -0.2251136600971222, mean p set: 0.44879910349845886
loss_pred:0.018565289676189423, decouple_loss:0.005061376839876175
The modified gen p mean: 0.44924867153167725, gen p mean: -0.22788959741592407, mean p set: 0.4498290419578552
loss_pred:0.018259664997458458, decouple_loss:0.005056852474808693
WV_1_PC_1_EH_0_PS_30, loss: 0.018765054643154144, avg_mse: 0.027364367619156837
current test mse: 0.027364
At step 30, Best test: 0.027364
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487903118133545, gen p mean: -0.23164983093738556, mean p set: 0.44931700825691223
loss_pred:0.01656278222799301, decouple_loss:0.005376061890274286
The modified gen p mean: 0.44611456990242004, gen p mean: -0.2260037213563919, mean p set: 0.44668781757354736
loss_pred:0.01725272834300995, decouple_loss:0.005031200125813484
The modified gen p mean: 0.4465969204902649, gen p mean: -0.22941763699054718, mean p set: 0.4471711814403534
loss_pred:0.01654181443154812, decouple_loss:0.005108000710606575
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44597601890563965, gen p mean: -0.22592687606811523, mean p set: 0.44651132822036743
loss_pred:0.017185751348733902, decouple_loss:0.004930390510708094
The modified gen p mean: 0.44681885838508606, gen p mean: -0.23089130222797394, mean p set: 0.4473998546600342
loss_pred:0.01618454046547413, decouple_loss:0.005028991959989071
The modified gen p mean: 0.44735053181648254, gen p mean: -0.23051095008850098, mean p set: 0.4479255974292755
loss_pred:0.01674804836511612, decouple_loss:0.005073740147054195
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621512293815613, gen p mean: -0.2278471142053604, mean p set: 0.4467402696609497
loss_pred:0.01696436107158661, decouple_loss:0.004725017584860325
The modified gen p mean: 0.4482080936431885, gen p mean: -0.23016425967216492, mean p set: 0.4487825632095337
loss_pred:0.016498306766152382, decouple_loss:0.0050822836346924305
The modified gen p mean: 0.44894787669181824, gen p mean: -0.2330068200826645, mean p set: 0.44952791929244995
loss_pred:0.016144540160894394, decouple_loss:0.005034506320953369
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44572898745536804, gen p mean: -0.2320542335510254, mean p set: 0.44625577330589294
loss_pred:0.016544543206691742, decouple_loss:0.004817342851310968
The modified gen p mean: 0.4467797875404358, gen p mean: -0.2333676666021347, mean p set: 0.4473566710948944
loss_pred:0.015997102484107018, decouple_loss:0.004817354492843151
The modified gen p mean: 0.4485037624835968, gen p mean: -0.23640471696853638, mean p set: 0.44907623529434204
loss_pred:0.016945326700806618, decouple_loss:0.0052883620373904705
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479562044143677, gen p mean: -0.24337084591388702, mean p set: 0.448486864566803
loss_pred:0.016647957265377045, decouple_loss:0.004881660919636488
The modified gen p mean: 0.4455925226211548, gen p mean: -0.2454713135957718, mean p set: 0.4461652636528015
loss_pred:0.01683874800801277, decouple_loss:0.005189963616430759
The modified gen p mean: 0.447163462638855, gen p mean: -0.24515831470489502, mean p set: 0.4477439522743225
loss_pred:0.016035428270697594, decouple_loss:0.005021050572395325
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465964138507843, gen p mean: -0.23886318504810333, mean p set: 0.44712045788764954
loss_pred:0.016201689839363098, decouple_loss:0.004670175723731518
The modified gen p mean: 0.44661667943000793, gen p mean: -0.23884718120098114, mean p set: 0.4471926689147949
loss_pred:0.01654300093650818, decouple_loss:0.004769995342940092
The modified gen p mean: 0.4451882243156433, gen p mean: -0.24639452993869781, mean p set: 0.4457697868347168
loss_pred:0.016502056270837784, decouple_loss:0.004750145599246025
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813182950019836, gen p mean: -0.24575074017047882, mean p set: 0.4486584961414337
loss_pred:0.016208762302994728, decouple_loss:0.004177261609584093
The modified gen p mean: 0.44615936279296875, gen p mean: -0.24473100900650024, mean p set: 0.44673389196395874
loss_pred:0.015956398099660873, decouple_loss:0.004348548129200935
The modified gen p mean: 0.44787535071372986, gen p mean: -0.2461182326078415, mean p set: 0.4484470784664154
loss_pred:0.016297314316034317, decouple_loss:0.0042920890264213085
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44594308733940125, gen p mean: -0.24269385635852814, mean p set: 0.44647401571273804
loss_pred:0.0165114663541317, decouple_loss:0.004614771343767643
The modified gen p mean: 0.4457243084907532, gen p mean: -0.24291327595710754, mean p set: 0.44630685448646545
loss_pred:0.016644591465592384, decouple_loss:0.004617966245859861
The modified gen p mean: 0.4466807246208191, gen p mean: -0.24622076749801636, mean p set: 0.44725558161735535
loss_pred:0.016370832920074463, decouple_loss:0.004330039490014315
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488092064857483, gen p mean: -0.2504107356071472, mean p set: 0.44933852553367615
loss_pred:0.01677766442298889, decouple_loss:0.004819786176085472
The modified gen p mean: 0.44847115874290466, gen p mean: -0.24897828698158264, mean p set: 0.4490543007850647
loss_pred:0.017071185633540154, decouple_loss:0.005022489000111818
The modified gen p mean: 0.4461747407913208, gen p mean: -0.2463817149400711, mean p set: 0.44675159454345703
loss_pred:0.016169073060154915, decouple_loss:0.004618519451469183
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705531001091003, gen p mean: -0.2457086443901062, mean p set: 0.44758522510528564
loss_pred:0.016227012500166893, decouple_loss:0.004390810616314411
The modified gen p mean: 0.4472520351409912, gen p mean: -0.24688223004341125, mean p set: 0.44782623648643494
loss_pred:0.01601327769458294, decouple_loss:0.004359036684036255
The modified gen p mean: 0.4467949867248535, gen p mean: -0.2504628598690033, mean p set: 0.4473665952682495
loss_pred:0.016371093690395355, decouple_loss:0.004534002859145403
2023-04-26 18:43:26 testing...
The modified gen p mean: 0.44822216033935547, gen p mean: -0.24596992135047913, mean p set: 0.44879910349845886
loss_pred:0.01837664283812046, decouple_loss:0.004251085687428713
The modified gen p mean: 0.4493885934352875, gen p mean: -0.2484072595834732, mean p set: 0.4499112665653229
loss_pred:0.018617840483784676, decouple_loss:0.004390891175717115
The modified gen p mean: 0.449250191450119, gen p mean: -0.24878723919391632, mean p set: 0.4498290419578552
loss_pred:0.018089404329657555, decouple_loss:0.004254981875419617
WV_1_PC_1_EH_0_PS_30, loss: 0.0185762457549572, avg_mse: 0.027178838849067688
current test mse: 0.027179
At step 40, Best test: 0.027179
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470638930797577, gen p mean: -0.25157439708709717, mean p set: 0.44758692383766174
loss_pred:0.017304616048932076, decouple_loss:0.004462039563804865
The modified gen p mean: 0.44867071509361267, gen p mean: -0.2490759789943695, mean p set: 0.44924864172935486
loss_pred:0.015655821189284325, decouple_loss:0.0049396688118577
The modified gen p mean: 0.44713473320007324, gen p mean: -0.24590493738651276, mean p set: 0.4477090537548065
loss_pred:0.01603148691356182, decouple_loss:0.004436100833117962
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468507468700409, gen p mean: -0.2500768303871155, mean p set: 0.44737890362739563
loss_pred:0.016840049996972084, decouple_loss:0.0046479348093271255
The modified gen p mean: 0.44754403829574585, gen p mean: -0.24995122849941254, mean p set: 0.4481172263622284
loss_pred:0.01662861928343773, decouple_loss:0.004637608770281076
The modified gen p mean: 0.4465678632259369, gen p mean: -0.24431398510932922, mean p set: 0.4471501410007477
loss_pred:0.01665022224187851, decouple_loss:0.00458941888064146
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808340072631836, gen p mean: -0.2468402236700058, mean p set: 0.44860947132110596
loss_pred:0.016021938994526863, decouple_loss:0.004130787216126919
The modified gen p mean: 0.4470508396625519, gen p mean: -0.24354548752307892, mean p set: 0.44762441515922546
loss_pred:0.016190873458981514, decouple_loss:0.004599418956786394
The modified gen p mean: 0.4471268057823181, gen p mean: -0.24950140714645386, mean p set: 0.4477013349533081
loss_pred:0.016688473522663116, decouple_loss:0.004119392018765211
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474833905696869, gen p mean: -0.24186238646507263, mean p set: 0.44800394773483276
loss_pred:0.016587134450674057, decouple_loss:0.005014805123209953
The modified gen p mean: 0.4477270543575287, gen p mean: -0.23941604793071747, mean p set: 0.44830334186553955
loss_pred:0.016623741015791893, decouple_loss:0.004633371718227863
The modified gen p mean: 0.4490888714790344, gen p mean: -0.23565250635147095, mean p set: 0.44966015219688416
loss_pred:0.015746483579277992, decouple_loss:0.005162490531802177
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479956328868866, gen p mean: -0.23510591685771942, mean p set: 0.4485197067260742
loss_pred:0.016170397400856018, decouple_loss:0.004108948167413473
The modified gen p mean: 0.44712939858436584, gen p mean: -0.2358139008283615, mean p set: 0.4477039873600006
loss_pred:0.015678156167268753, decouple_loss:0.004066874738782644
The modified gen p mean: 0.44706544280052185, gen p mean: -0.23590391874313354, mean p set: 0.4476398825645447
loss_pred:0.016444142907857895, decouple_loss:0.003969958517700434
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480074644088745, gen p mean: -0.2417910099029541, mean p set: 0.44853144884109497
loss_pred:0.016229940578341484, decouple_loss:0.004747969564050436
The modified gen p mean: 0.4469040334224701, gen p mean: -0.23572346568107605, mean p set: 0.4474763870239258
loss_pred:0.016447888687253, decouple_loss:0.0046900673769414425
The modified gen p mean: 0.44737446308135986, gen p mean: -0.23595017194747925, mean p set: 0.44794946908950806
loss_pred:0.016035286709666252, decouple_loss:0.005149773322045803
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482880234718323, gen p mean: -0.2462855875492096, mean p set: 0.44880568981170654
loss_pred:0.016140170395374298, decouple_loss:0.0041570295579731464
The modified gen p mean: 0.4466361105442047, gen p mean: -0.24217553436756134, mean p set: 0.4472118318080902
loss_pred:0.016023533418774605, decouple_loss:0.00415935879573226
The modified gen p mean: 0.447811484336853, gen p mean: -0.2443625032901764, mean p set: 0.4483886957168579
loss_pred:0.016157709062099457, decouple_loss:0.004134489689022303
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485305845737457, gen p mean: -0.24152325093746185, mean p set: 0.4490576982498169
loss_pred:0.015642141923308372, decouple_loss:0.004098872654139996
The modified gen p mean: 0.4474233388900757, gen p mean: -0.23946306109428406, mean p set: 0.44800183176994324
loss_pred:0.016300426796078682, decouple_loss:0.004310955759137869
The modified gen p mean: 0.44713112711906433, gen p mean: -0.2393878549337387, mean p set: 0.44770386815071106
loss_pred:0.01634225808084011, decouple_loss:0.0041315555572509766
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472253620624542, gen p mean: -0.2349630445241928, mean p set: 0.4477570950984955
loss_pred:0.016315193846821785, decouple_loss:0.004689530469477177
The modified gen p mean: 0.44839364290237427, gen p mean: -0.23801347613334656, mean p set: 0.44896969199180603
loss_pred:0.016009600833058357, decouple_loss:0.004296684172004461
The modified gen p mean: 0.44707924127578735, gen p mean: -0.24126432836055756, mean p set: 0.4476523995399475
loss_pred:0.016598567366600037, decouple_loss:0.004333047661930323
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480341374874115, gen p mean: -0.244359090924263, mean p set: 0.4485662877559662
loss_pred:0.015864241868257523, decouple_loss:0.004164110403507948
The modified gen p mean: 0.44742244482040405, gen p mean: -0.24267300963401794, mean p set: 0.4479982852935791
loss_pred:0.015586256049573421, decouple_loss:0.003840635996311903
The modified gen p mean: 0.44702011346817017, gen p mean: -0.24527832865715027, mean p set: 0.44759440422058105
loss_pred:0.015863260254263878, decouple_loss:0.003824840998277068
2023-04-26 18:47:34 testing...
The modified gen p mean: 0.44822198152542114, gen p mean: -0.24034324288368225, mean p set: 0.44879910349845886
loss_pred:0.018752606585621834, decouple_loss:0.004000185988843441
The modified gen p mean: 0.4493879973888397, gen p mean: -0.24222713708877563, mean p set: 0.4499112665653229
loss_pred:0.018767017871141434, decouple_loss:0.004260472487658262
The modified gen p mean: 0.4492543041706085, gen p mean: -0.24256232380867004, mean p set: 0.4498290419578552
loss_pred:0.018239356577396393, decouple_loss:0.004117375239729881
WV_1_PC_1_EH_0_PS_30, loss: 0.01879262737929821, avg_mse: 0.027484700083732605
current test mse: 0.027485
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808492064476013, gen p mean: -0.23913319408893585, mean p set: 0.44866064190864563
loss_pred:0.016270853579044342, decouple_loss:0.004088263027369976
The modified gen p mean: 0.4477287828922272, gen p mean: -0.24275323748588562, mean p set: 0.448304146528244
loss_pred:0.015909302979707718, decouple_loss:0.0036837069783359766
The modified gen p mean: 0.44821152091026306, gen p mean: -0.24735844135284424, mean p set: 0.4487426280975342
loss_pred:0.016324186697602272, decouple_loss:0.0037441509775817394
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879812002182007, gen p mean: -0.24100008606910706, mean p set: 0.449325829744339
loss_pred:0.015108308754861355, decouple_loss:0.004237419459968805
The modified gen p mean: 0.44725969433784485, gen p mean: -0.24135948717594147, mean p set: 0.4478378891944885
loss_pred:0.015773650258779526, decouple_loss:0.0039367214776575565
The modified gen p mean: 0.44761863350868225, gen p mean: -0.24042893946170807, mean p set: 0.4481918513774872
loss_pred:0.01584206148982048, decouple_loss:0.0038942003156989813
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816848635673523, gen p mean: -0.243218794465065, mean p set: 0.44869139790534973
loss_pred:0.015569770708680153, decouple_loss:0.004131839610636234
The modified gen p mean: 0.44675952196121216, gen p mean: -0.24764484167099, mean p set: 0.4473388195037842The modified gen p mean: 0.44790932536125183, gen p mean: -0.24266108870506287, mean p set: 0.448486864566803
loss_pred:0.015741784125566483, decouple_loss:0.003914328292012215
loss_pred:0.015845369547605515, decouple_loss:0.0040113432332873344
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486141502857208, gen p mean: -0.24286873638629913, mean p set: 0.4491487443447113
loss_pred:0.015490138903260231, decouple_loss:0.004125756211578846
The modified gen p mean: 0.4480292499065399, gen p mean: -0.24290964007377625, mean p set: 0.4486024081707001
loss_pred:0.01598014310002327, decouple_loss:0.004048017784953117
The modified gen p mean: 0.44772660732269287, gen p mean: -0.2400086373090744, mean p set: 0.44830429553985596
loss_pred:0.01564203016459942, decouple_loss:0.004217234905809164
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479080140590668, gen p mean: -0.24646569788455963, mean p set: 0.448443204164505
loss_pred:0.015805289149284363, decouple_loss:0.0038465482648462057
The modified gen p mean: 0.4483962655067444, gen p mean: -0.24220749735832214, mean p set: 0.44897186756134033
loss_pred:0.01577010005712509, decouple_loss:0.004235106520354748
The modified gen p mean: 0.44684356451034546, gen p mean: -0.24125410616397858, mean p set: 0.447422593832016
loss_pred:0.016147246584296227, decouple_loss:0.003698947373777628
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447363018989563, gen p mean: -0.2491811364889145, mean p set: 0.44789108633995056
loss_pred:0.016718128696084023, decouple_loss:0.004775749519467354
The modified gen p mean: 0.44647225737571716, gen p mean: -0.24497146904468536, mean p set: 0.4470519721508026The modified gen p mean: 0.44710615277290344, gen p mean: -0.24651023745536804, mean p set: 0.44768473505973816
loss_pred:0.016154197975993156, decouple_loss:0.004619834944605827
loss_pred:0.01608910970389843, decouple_loss:0.0050722151063382626
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770699739456177, gen p mean: -0.24384541809558868, mean p set: 0.4482389986515045
loss_pred:0.01580081507563591, decouple_loss:0.003800666658207774
The modified gen p mean: 0.4483063519001007, gen p mean: -0.2362031638622284, mean p set: 0.44888588786125183The modified gen p mean: 0.44679999351501465, gen p mean: -0.23740988969802856, mean p set: 0.4473787844181061
loss_pred:0.015606479719281197, decouple_loss:0.003819739678874612
loss_pred:0.015962645411491394, decouple_loss:0.0037584640085697174
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640129804611206, gen p mean: -0.2404622733592987, mean p set: 0.4469318985939026
loss_pred:0.016950776800513268, decouple_loss:0.005295386537909508
The modified gen p mean: 0.448032945394516, gen p mean: -0.2384258508682251, mean p set: 0.4486064314842224
loss_pred:0.015590045601129532, decouple_loss:0.0048354798927903175
The modified gen p mean: 0.4465482234954834, gen p mean: -0.24210476875305176, mean p set: 0.4471273422241211
loss_pred:0.01707199588418007, decouple_loss:0.004968543071299791
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730621576309204, gen p mean: -0.24340373277664185, mean p set: 0.44783034920692444
loss_pred:0.016219578683376312, decouple_loss:0.004071437753736973
The modified gen p mean: 0.4488380551338196, gen p mean: -0.23775872588157654, mean p set: 0.44941452145576477
loss_pred:0.015818551182746887, decouple_loss:0.0038804688956588507
The modified gen p mean: 0.4476807713508606, gen p mean: -0.2358393669128418, mean p set: 0.4482576549053192
loss_pred:0.016213975846767426, decouple_loss:0.004149115178734064
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483829140663147, gen p mean: -0.24170652031898499, mean p set: 0.448910653591156
loss_pred:0.015183039009571075, decouple_loss:0.004642598796635866
The modified gen p mean: 0.4475025236606598, gen p mean: -0.24314652383327484, mean p set: 0.448081910610199
loss_pred:0.01639062538743019, decouple_loss:0.004467726219445467
The modified gen p mean: 0.4470829665660858, gen p mean: -0.23784589767456055, mean p set: 0.4476620554924011
loss_pred:0.01613900251686573, decouple_loss:0.00459815189242363
2023-04-26 18:50:59 testing...
The modified gen p mean: 0.44937917590141296, gen p mean: -0.24277032911777496, mean p set: 0.4499112665653229
loss_pred:0.018735209479928017, decouple_loss:0.004294031765311956
The modified gen p mean: 0.4482254087924957, gen p mean: -0.24123071134090424, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492560029029846, gen p mean: -0.24329710006713867, mean p set: 0.4498290419578552
loss_pred:0.018718937411904335, decouple_loss:0.003970462828874588
loss_pred:0.018170485273003578, decouple_loss:0.0041291010566055775
WV_1_PC_1_EH_0_PS_30, loss: 0.018748104572296143, avg_mse: 0.027450846508145332
current test mse: 0.027451
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817763566970825, gen p mean: -0.24326546490192413, mean p set: 0.4487118422985077
loss_pred:0.016147080808877945, decouple_loss:0.004181280266493559
The modified gen p mean: 0.4471261203289032, gen p mean: -0.24613679945468903, mean p set: 0.4477040469646454
loss_pred:0.016681523993611336, decouple_loss:0.004097692668437958
The modified gen p mean: 0.44809770584106445, gen p mean: -0.24987547099590302, mean p set: 0.4486749470233917
loss_pred:0.01697090081870556, decouple_loss:0.004016074817627668
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481133222579956, gen p mean: -0.24518267810344696, mean p set: 0.4486413896083832
loss_pred:0.016052111983299255, decouple_loss:0.004522243514657021
The modified gen p mean: 0.447541207075119, gen p mean: -0.24710673093795776, mean p set: 0.44812464714050293
loss_pred:0.016751030460000038, decouple_loss:0.004675277043133974
The modified gen p mean: 0.44800812005996704, gen p mean: -0.24230463802814484, mean p set: 0.4485739767551422
loss_pred:0.016238415613770485, decouple_loss:0.004659350495785475
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719570875167847, gen p mean: -0.23537777364253998, mean p set: 0.4477280378341675
loss_pred:0.01662210002541542, decouple_loss:0.0040860665030777454
The modified gen p mean: 0.44745224714279175, gen p mean: -0.2331801801919937, mean p set: 0.44803258776664734
loss_pred:0.016279639676213264, decouple_loss:0.004137588664889336
The modified gen p mean: 0.44764018058776855, gen p mean: -0.23989595472812653, mean p set: 0.4482135772705078
loss_pred:0.016639694571495056, decouple_loss:0.004122545477002859
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478428363800049, gen p mean: -0.23926492035388947, mean p set: 0.44837021827697754
loss_pred:0.016863077878952026, decouple_loss:0.004591287113726139
The modified gen p mean: 0.4474051594734192, gen p mean: -0.23902565240859985, mean p set: 0.44797828793525696
loss_pred:0.016811877489089966, decouple_loss:0.0045868693850934505
The modified gen p mean: 0.4465268850326538, gen p mean: -0.2411017268896103, mean p set: 0.44709837436676025
loss_pred:0.017294006422162056, decouple_loss:0.0046012429520487785
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478488266468048, gen p mean: -0.23450425267219543, mean p set: 0.44838324189186096
loss_pred:0.016559556126594543, decouple_loss:0.0040128836408257484
The modified gen p mean: 0.4470873773097992, gen p mean: -0.23515518009662628, mean p set: 0.44765913486480713
The modified gen p mean: 0.4484868347644806, gen p mean: -0.2353334128856659, mean p set: 0.4490656852722168
loss_pred:0.016600700095295906, decouple_loss:0.0037777074612677097
loss_pred:0.016071036458015442, decouple_loss:0.0037211545277386904
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725367426872253, gen p mean: -0.23981696367263794, mean p set: 0.4477818012237549
loss_pred:0.016246536746621132, decouple_loss:0.004209156613796949
The modified gen p mean: 0.44739413261413574, gen p mean: -0.2404349446296692, mean p set: 0.44797375798225403
loss_pred:0.017699187621474266, decouple_loss:0.004076456651091576
The modified gen p mean: 0.4477058947086334, gen p mean: -0.23374833166599274, mean p set: 0.4482816159725189
loss_pred:0.0169643834233284, decouple_loss:0.0039709690026938915
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447338342666626, gen p mean: -0.23564191162586212, mean p set: 0.4478640854358673
loss_pred:0.015687651932239532, decouple_loss:0.0037510432302951813
The modified gen p mean: 0.446042001247406, gen p mean: -0.24362291395664215, mean p set: 0.44661951065063477The modified gen p mean: 0.44625821709632874, gen p mean: -0.24370180070400238, mean p set: 0.4468306601047516
loss_pred:0.01671525277197361, decouple_loss:0.0038108511362224817
loss_pred:0.015476907603442669, decouple_loss:0.0035379331093281507
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464815855026245, gen p mean: -0.2500275671482086, mean p set: 0.4470071494579315
loss_pred:0.016306685283780098, decouple_loss:0.003714075544849038
The modified gen p mean: 0.44744715094566345, gen p mean: -0.24506625533103943, mean p set: 0.44802215695381165
loss_pred:0.016180621460080147, decouple_loss:0.003997019026428461
The modified gen p mean: 0.4471506178379059, gen p mean: -0.2487458884716034, mean p set: 0.447729229927063
loss_pred:0.016473423689603806, decouple_loss:0.003545542946085334
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472852647304535, gen p mean: -0.2479180246591568, mean p set: 0.4478125274181366
loss_pred:0.016054153442382812, decouple_loss:0.0034466790966689587
The modified gen p mean: 0.4472266137599945, gen p mean: -0.25131314992904663, mean p set: 0.4478060305118561
loss_pred:0.016377141699194908, decouple_loss:0.004060173407196999
The modified gen p mean: 0.4482901692390442, gen p mean: -0.25019073486328125, mean p set: 0.4488631784915924
loss_pred:0.01629454456269741, decouple_loss:0.004076364915817976
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463919401168823, gen p mean: -0.24946148693561554, mean p set: 0.44691428542137146
loss_pred:0.01685526967048645, decouple_loss:0.0033133758697658777
The modified gen p mean: 0.4468882977962494, gen p mean: -0.249027818441391, mean p set: 0.44746458530426025
loss_pred:0.016436947509646416, decouple_loss:0.0032862965017557144
The modified gen p mean: 0.44580885767936707, gen p mean: -0.2501932382583618, mean p set: 0.44638389348983765
loss_pred:0.015585770830512047, decouple_loss:0.0037045383360236883
2023-04-26 18:55:03 testing...
The modified gen p mean: 0.4482194781303406, gen p mean: -0.24092577397823334, mean p set: 0.44879910349845886
loss_pred:0.018489137291908264, decouple_loss:0.004073124844580889
The modified gen p mean: 0.4493872821331024, gen p mean: -0.24282614886760712, mean p set: 0.4499112665653229
loss_pred:0.018594441935420036, decouple_loss:0.004517590627074242
The modified gen p mean: 0.44925493001937866, gen p mean: -0.24313776195049286, mean p set: 0.4498290419578552
loss_pred:0.01810891553759575, decouple_loss:0.004168145824223757
WV_1_PC_1_EH_0_PS_30, loss: 0.018610145896673203, avg_mse: 0.027218377217650414
current test mse: 0.027218
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44604793190956116, gen p mean: -0.24604062736034393, mean p set: 0.4466179311275482
loss_pred:0.016416320577263832, decouple_loss:0.004155700094997883
The modified gen p mean: 0.44752758741378784, gen p mean: -0.23899982869625092, mean p set: 0.44809815287590027
loss_pred:0.015598965808749199, decouple_loss:0.00449632341042161
The modified gen p mean: 0.4465588629245758, gen p mean: -0.24325305223464966, mean p set: 0.4470813572406769
loss_pred:0.01621071994304657, decouple_loss:0.004261742811650038
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673284888267517, gen p mean: -0.23945215344429016, mean p set: 0.44725507497787476
loss_pred:0.01631581410765648, decouple_loss:0.0033829673193395138
The modified gen p mean: 0.4476199448108673, gen p mean: -0.23965059220790863, mean p set: 0.4481956660747528
loss_pred:0.016389233991503716, decouple_loss:0.0031597863417118788
The modified gen p mean: 0.44798341393470764, gen p mean: -0.24320179224014282, mean p set: 0.4485515058040619
loss_pred:0.016972482204437256, decouple_loss:0.0033526031766086817
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472063481807709, gen p mean: -0.23883865773677826, mean p set: 0.4477352201938629
loss_pred:0.017018869519233704, decouple_loss:0.003526193555444479
The modified gen p mean: 0.4472184479236603, gen p mean: -0.23708988726139069, mean p set: 0.44779056310653687The modified gen p mean: 0.4470207989215851, gen p mean: -0.23759514093399048, mean p set: 0.44759562611579895
loss_pred:0.01588619314134121, decouple_loss:0.0036299293860793114loss_pred:0.015879414975643158, decouple_loss:0.003620350733399391
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621750712394714, gen p mean: -0.2446346879005432, mean p set: 0.4467509686946869
loss_pred:0.01667427457869053, decouple_loss:0.0037559219636023045
The modified gen p mean: 0.44826728105545044, gen p mean: -0.24008920788764954, mean p set: 0.44884711503982544The modified gen p mean: 0.44751518964767456, gen p mean: -0.2395007312297821, mean p set: 0.44809025526046753
loss_pred:0.016785673797130585, decouple_loss:0.003602531971409917loss_pred:0.016485407948493958, decouple_loss:0.0035458472557365894
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484238028526306, gen p mean: -0.23557473719120026, mean p set: 0.448952317237854
loss_pred:0.01607408933341503, decouple_loss:0.003685222240164876
The modified gen p mean: 0.44737347960472107, gen p mean: -0.2382768988609314, mean p set: 0.4479471743106842The modified gen p mean: 0.4478469491004944, gen p mean: -0.23959124088287354, mean p set: 0.44841933250427246
loss_pred:0.016627997159957886, decouple_loss:0.0033756671473383904
loss_pred:0.01708075776696205, decouple_loss:0.003596422029659152
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466628134250641, gen p mean: -0.23507839441299438, mean p set: 0.44719401001930237
loss_pred:0.01703573763370514, decouple_loss:0.004130213055759668
The modified gen p mean: 0.44830945134162903, gen p mean: -0.23576347529888153, mean p set: 0.44888749718666077
loss_pred:0.015988977625966072, decouple_loss:0.003681047121062875
The modified gen p mean: 0.4469887912273407, gen p mean: -0.24122802913188934, mean p set: 0.44756636023521423
loss_pred:0.016370994970202446, decouple_loss:0.003833353752270341
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678589701652527, gen p mean: -0.23834128677845, mean p set: 0.4473138451576233
loss_pred:0.01635974645614624, decouple_loss:0.0032119604293257
The modified gen p mean: 0.44759050011634827, gen p mean: -0.23395776748657227, mean p set: 0.44816744327545166
loss_pred:0.016758712008595467, decouple_loss:0.003184081055223942
The modified gen p mean: 0.4474336802959442, gen p mean: -0.23682361841201782, mean p set: 0.4480046033859253
loss_pred:0.01600908488035202, decouple_loss:0.0032441639341413975
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467104375362396, gen p mean: -0.23206347227096558, mean p set: 0.44724181294441223
loss_pred:0.01598651148378849, decouple_loss:0.0038886968977749348
The modified gen p mean: 0.4459528625011444, gen p mean: -0.23370462656021118, mean p set: 0.4465283155441284
loss_pred:0.016848277300596237, decouple_loss:0.0037570949643850327
The modified gen p mean: 0.4472692608833313, gen p mean: -0.23142777383327484, mean p set: 0.44784313440322876
loss_pred:0.01689283177256584, decouple_loss:0.004100458230823278
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44589507579803467, gen p mean: -0.23016220331192017, mean p set: 0.44642776250839233
loss_pred:0.016195936128497124, decouple_loss:0.003964068368077278
The modified gen p mean: 0.447888046503067, gen p mean: -0.22542835772037506, mean p set: 0.4484681785106659
The modified gen p mean: 0.4476969242095947, gen p mean: -0.2267846316099167, mean p set: 0.44827502965927124
loss_pred:0.016754793003201485, decouple_loss:0.003581944154575467
loss_pred:0.016336843371391296, decouple_loss:0.0034206300042569637
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480486214160919, gen p mean: -0.22899474203586578, mean p set: 0.4485728442668915
loss_pred:0.016323620453476906, decouple_loss:0.0034292491618543863
The modified gen p mean: 0.44762876629829407, gen p mean: -0.23328569531440735, mean p set: 0.44820475578308105
loss_pred:0.016882101073861122, decouple_loss:0.003269283566623926
The modified gen p mean: 0.44758832454681396, gen p mean: -0.22918781638145447, mean p set: 0.4481656849384308
loss_pred:0.016571123152971268, decouple_loss:0.0031984983943402767
2023-04-26 18:58:28 testing...
The modified gen p mean: 0.4493881165981293, gen p mean: -0.22747188806533813, mean p set: 0.4499112665653229
loss_pred:0.018399197608232498, decouple_loss:0.0038223250303417444
The modified gen p mean: 0.4482210576534271, gen p mean: -0.2249956727027893, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492543339729309, gen p mean: -0.22763551771640778, mean p set: 0.4498290419578552
loss_pred:0.018361013382673264, decouple_loss:0.003591729560866952
loss_pred:0.01791670359671116, decouple_loss:0.0036973922979086637
WV_1_PC_1_EH_0_PS_30, loss: 0.018410829827189445, avg_mse: 0.027022868394851685
current test mse: 0.027023
At step 80, Best test: 0.027023
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934287667274475, gen p mean: -0.2258959710597992, mean p set: 0.449869304895401
loss_pred:0.016859430819749832, decouple_loss:0.0036614839918911457
The modified gen p mean: 0.44717562198638916, gen p mean: -0.23178628087043762, mean p set: 0.44775891304016113
loss_pred:0.016923826187849045, decouple_loss:0.004559379070997238
The modified gen p mean: 0.44793567061424255, gen p mean: -0.22517473995685577, mean p set: 0.4485120475292206
loss_pred:0.017442794516682625, decouple_loss:0.003762314096093178
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461924433708191, gen p mean: -0.23601792752742767, mean p set: 0.44671642780303955
loss_pred:0.01679096929728985, decouple_loss:0.0034983118530362844
The modified gen p mean: 0.4473964273929596, gen p mean: -0.23110389709472656, mean p set: 0.4479758143424988
loss_pred:0.01588248275220394, decouple_loss:0.003491797484457493
The modified gen p mean: 0.44842833280563354, gen p mean: -0.23274700343608856, mean p set: 0.44900041818618774
loss_pred:0.015898989513516426, decouple_loss:0.003751262789592147
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475594162940979, gen p mean: -0.23949046432971954, mean p set: 0.44808489084243774
loss_pred:0.016502825543284416, decouple_loss:0.0035616792738437653
The modified gen p mean: 0.44549593329429626, gen p mean: -0.24124886095523834, mean p set: 0.44606801867485046The modified gen p mean: 0.44757404923439026, gen p mean: -0.238197922706604, mean p set: 0.4481530487537384
loss_pred:0.01684202067553997, decouple_loss:0.003750123782083392
loss_pred:0.01627548784017563, decouple_loss:0.003434110200032592
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977813959121704, gen p mean: -0.23809272050857544, mean p set: 0.45031026005744934
loss_pred:0.016593826934695244, decouple_loss:0.003839275799691677
The modified gen p mean: 0.4463316798210144, gen p mean: -0.24237291514873505, mean p set: 0.4469049572944641
loss_pred:0.016650157049298286, decouple_loss:0.003852866357192397
The modified gen p mean: 0.44811978936195374, gen p mean: -0.24274472892284393, mean p set: 0.44869065284729004
loss_pred:0.016266779974102974, decouple_loss:0.0033465952146798372
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846460223197937, gen p mean: -0.24235877394676208, mean p set: 0.4489942789077759
loss_pred:0.016369450837373734, decouple_loss:0.003960597328841686
The modified gen p mean: 0.4470251202583313, gen p mean: -0.2439059168100357, mean p set: 0.4476076066493988
loss_pred:0.01631433144211769, decouple_loss:0.0038674739189445972
The modified gen p mean: 0.4476999044418335, gen p mean: -0.23828430473804474, mean p set: 0.44827497005462646
loss_pred:0.015898123383522034, decouple_loss:0.0042316606268286705
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904348254203796, gen p mean: -0.24593132734298706, mean p set: 0.44957879185676575
loss_pred:0.01601983793079853, decouple_loss:0.0034832991659641266
The modified gen p mean: 0.4473213255405426, gen p mean: -0.23727816343307495, mean p set: 0.44789430499076843The modified gen p mean: 0.44605445861816406, gen p mean: -0.244282528758049, mean p set: 0.4466274678707123
loss_pred:0.01630728505551815, decouple_loss:0.0031690688338130713
loss_pred:0.016754677519202232, decouple_loss:0.003400644054636359
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487479627132416, gen p mean: -0.23275437951087952, mean p set: 0.4492754638195038
loss_pred:0.01668827421963215, decouple_loss:0.004329885821789503
The modified gen p mean: 0.4482177793979645, gen p mean: -0.23466336727142334, mean p set: 0.4487912356853485
The modified gen p mean: 0.446828156709671, gen p mean: -0.24393102526664734, mean p set: 0.44740915298461914
loss_pred:0.016855882480740547, decouple_loss:0.003817023243755102
loss_pred:0.016647616401314735, decouple_loss:0.003934462554752827
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482811391353607, gen p mean: -0.24125269055366516, mean p set: 0.4488007128238678
loss_pred:0.016205763444304466, decouple_loss:0.0034171994775533676
The modified gen p mean: 0.44793540239334106, gen p mean: -0.23721714317798615, mean p set: 0.44851356744766235
loss_pred:0.01669253408908844, decouple_loss:0.003573060967028141
The modified gen p mean: 0.4460679888725281, gen p mean: -0.24177142977714539, mean p set: 0.4466356933116913
loss_pred:0.016390949487686157, decouple_loss:0.0035482707899063826
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448349267244339, gen p mean: -0.24027463793754578, mean p set: 0.44887441396713257
loss_pred:0.016421740874648094, decouple_loss:0.0034646412823349237
The modified gen p mean: 0.44679367542266846, gen p mean: -0.2378189116716385, mean p set: 0.44736772775650024
loss_pred:0.016212619841098785, decouple_loss:0.003436508821323514
The modified gen p mean: 0.4453880190849304, gen p mean: -0.2428060621023178, mean p set: 0.445966511964798
loss_pred:0.0166180320084095, decouple_loss:0.0035273933317512274
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865626096725464, gen p mean: -0.24253708124160767, mean p set: 0.449184387922287
loss_pred:0.015973960980772972, decouple_loss:0.003629322862252593
The modified gen p mean: 0.44599565863609314, gen p mean: -0.2415686845779419, mean p set: 0.44656795263290405
loss_pred:0.016720406711101532, decouple_loss:0.0035277260467410088
The modified gen p mean: 0.447508305311203, gen p mean: -0.23857280611991882, mean p set: 0.448087215423584
loss_pred:0.01646191067993641, decouple_loss:0.003839263692498207
2023-04-26 19:02:42 testing...
The modified gen p mean: 0.448221355676651, gen p mean: -0.23950257897377014, mean p set: 0.44879910349845886
loss_pred:0.01855849102139473, decouple_loss:0.003505104687064886
The modified gen p mean: 0.4493812024593353, gen p mean: -0.24194730818271637, mean p set: 0.4499112665653229
loss_pred:0.01853932812809944, decouple_loss:0.003530890913680196
The modified gen p mean: 0.4492577314376831, gen p mean: -0.24197518825531006, mean p set: 0.4498290419578552
loss_pred:0.017978141084313393, decouple_loss:0.003610860789194703
WV_1_PC_1_EH_0_PS_30, loss: 0.018536102026700974, avg_mse: 0.027132738381624222
current test mse: 0.027133
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476381242275238, gen p mean: -0.24085821211338043, mean p set: 0.44821611046791077
loss_pred:0.01705198548734188, decouple_loss:0.0035478039644658566
The modified gen p mean: 0.4474363923072815, gen p mean: -0.23666854202747345, mean p set: 0.44801437854766846
loss_pred:0.016355006024241447, decouple_loss:0.0036150047089904547
The modified gen p mean: 0.4473157227039337, gen p mean: -0.2439933717250824, mean p set: 0.44784191250801086
loss_pred:0.01658407412469387, decouple_loss:0.003566319588571787
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756847620010376, gen p mean: -0.24953648447990417, mean p set: 0.4480946362018585
loss_pred:0.01647164113819599, decouple_loss:0.0034778693225234747
The modified gen p mean: 0.4472995102405548, gen p mean: -0.24983760714530945, mean p set: 0.4478735327720642The modified gen p mean: 0.44826647639274597, gen p mean: -0.24851544201374054, mean p set: 0.4488462209701538
loss_pred:0.016794472932815552, decouple_loss:0.003558065975084901
loss_pred:0.016457103192806244, decouple_loss:0.0034421421587467194
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773125648498535, gen p mean: -0.24211513996124268, mean p set: 0.44826194643974304
loss_pred:0.01653219573199749, decouple_loss:0.003490668488666415
The modified gen p mean: 0.4477442502975464, gen p mean: -0.24001634120941162, mean p set: 0.44832706451416016The modified gen p mean: 0.4467412531375885, gen p mean: -0.24034874141216278, mean p set: 0.4473150670528412
loss_pred:0.01657985709607601, decouple_loss:0.0037836774718016386
loss_pred:0.01696242019534111, decouple_loss:0.003951419610530138
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674572348594666, gen p mean: -0.24759867787361145, mean p set: 0.44727712869644165
loss_pred:0.01603105291724205, decouple_loss:0.003454983700066805
The modified gen p mean: 0.4473286271095276, gen p mean: -0.24109067022800446, mean p set: 0.4479130506515503The modified gen p mean: 0.44771960377693176, gen p mean: -0.24317815899848938, mean p set: 0.4482978880405426
loss_pred:0.016138337552547455, decouple_loss:0.0032765839714556932
loss_pred:0.016522811725735664, decouple_loss:0.003356887260451913
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708770513534546, gen p mean: -0.25002384185791016, mean p set: 0.44761988520622253
loss_pred:0.016552655026316643, decouple_loss:0.0034731964115053415
The modified gen p mean: 0.4465201497077942, gen p mean: -0.24953171610832214, mean p set: 0.44709834456443787The modified gen p mean: 0.44688379764556885, gen p mean: -0.2471483051776886, mean p set: 0.44745954871177673
loss_pred:0.016430871561169624, decouple_loss:0.0033264318481087685
loss_pred:0.01651861146092415, decouple_loss:0.0031767061445862055
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446936696767807, gen p mean: -0.24270907044410706, mean p set: 0.4474617540836334
loss_pred:0.017092086374759674, decouple_loss:0.0039102425798773766
The modified gen p mean: 0.4493367671966553, gen p mean: -0.23912830650806427, mean p set: 0.4499136209487915The modified gen p mean: 0.4472258388996124, gen p mean: -0.23928363621234894, mean p set: 0.44780421257019043
loss_pred:0.016409635543823242, decouple_loss:0.003829878056421876
loss_pred:0.015986159443855286, decouple_loss:0.003792658681049943
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477821886539459, gen p mean: -0.24235448241233826, mean p set: 0.4483223557472229
loss_pred:0.016006363555788994, decouple_loss:0.003326223697513342
The modified gen p mean: 0.4460517466068268, gen p mean: -0.25127241015434265, mean p set: 0.4466353952884674The modified gen p mean: 0.4470689296722412, gen p mean: -0.24570022523403168, mean p set: 0.447646826505661
loss_pred:0.016084155067801476, decouple_loss:0.0035420546773821115loss_pred:0.016610071063041687, decouple_loss:0.0037072075065225363
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714975357055664, gen p mean: -0.25547507405281067, mean p set: 0.44767752289772034
loss_pred:0.01622038707137108, decouple_loss:0.0034743850119411945
The modified gen p mean: 0.4469897150993347, gen p mean: -0.2536412179470062, mean p set: 0.447562575340271The modified gen p mean: 0.4479234516620636, gen p mean: -0.2548578977584839, mean p set: 0.4484986364841461
loss_pred:0.016357064247131348, decouple_loss:0.0032124363351613283
loss_pred:0.016130687668919563, decouple_loss:0.003339870600029826
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675689935684204, gen p mean: -0.2547023296356201, mean p set: 0.4472885727882385
loss_pred:0.017361123114824295, decouple_loss:0.003800226841121912
The modified gen p mean: 0.447186678647995, gen p mean: -0.2541554272174835, mean p set: 0.44775715470314026The modified gen p mean: 0.4471934139728546, gen p mean: -0.2511424422264099, mean p set: 0.4477689266204834
loss_pred:0.01637064293026924, decouple_loss:0.0035118411760777235loss_pred:0.016543308272957802, decouple_loss:0.0034855578560382128
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474850296974182, gen p mean: -0.25891098380088806, mean p set: 0.44801008701324463
loss_pred:0.016176862642169, decouple_loss:0.00306609645485878
The modified gen p mean: 0.44845810532569885, gen p mean: -0.2516263425350189, mean p set: 0.44902777671813965The modified gen p mean: 0.44921448826789856, gen p mean: -0.2550101578235626, mean p set: 0.449787974357605
loss_pred:0.01619827374815941, decouple_loss:0.0033297385089099407
loss_pred:0.016076525673270226, decouple_loss:0.003438252257183194
2023-04-26 19:06:06 testing...
The modified gen p mean: 0.4482252299785614, gen p mean: -0.2517136037349701, mean p set: 0.44879910349845886
loss_pred:0.018466699868440628, decouple_loss:0.0033952314406633377
The modified gen p mean: 0.44937822222709656, gen p mean: -0.2542937695980072, mean p set: 0.4499112665653229
loss_pred:0.018433231860399246, decouple_loss:0.003420648630708456
The modified gen p mean: 0.4492526650428772, gen p mean: -0.25444185733795166, mean p set: 0.4498290419578552
loss_pred:0.017878832295536995, decouple_loss:0.003380248323082924
WV_1_PC_1_EH_0_PS_30, loss: 0.018429525196552277, avg_mse: 0.027043646201491356
current test mse: 0.027044
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733160734176636, gen p mean: -0.25648021697998047, mean p set: 0.4478645324707031
loss_pred:0.016029655933380127, decouple_loss:0.003854060312733054
The modified gen p mean: 0.44770777225494385, gen p mean: -0.25708115100860596, mean p set: 0.44828295707702637
loss_pred:0.016545552760362625, decouple_loss:0.0037511580158025026
The modified gen p mean: 0.4474973976612091, gen p mean: -0.25609785318374634, mean p set: 0.44806867837905884
loss_pred:0.016282327473163605, decouple_loss:0.0035128325689584017
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478345811367035, gen p mean: -0.24648679792881012, mean p set: 0.4483618438243866
loss_pred:0.01600920595228672, decouple_loss:0.0034290046896785498
The modified gen p mean: 0.4474482238292694, gen p mean: -0.25304168462753296, mean p set: 0.44802039861679077The modified gen p mean: 0.44746291637420654, gen p mean: -0.25314033031463623, mean p set: 0.4480433166027069
loss_pred:0.01599453017115593, decouple_loss:0.0034287837333977222loss_pred:0.015473911538720131, decouple_loss:0.003639681963250041
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486786425113678, gen p mean: -0.24674883484840393, mean p set: 0.4492107927799225
loss_pred:0.01645607315003872, decouple_loss:0.0036115616094321012
The modified gen p mean: 0.44608551263809204, gen p mean: -0.24956807494163513, mean p set: 0.44665300846099854
loss_pred:0.016342414543032646, decouple_loss:0.0034188975114375353
The modified gen p mean: 0.44765719771385193, gen p mean: -0.25156572461128235, mean p set: 0.44823944568634033
loss_pred:0.016276493668556213, decouple_loss:0.0036318437196314335
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472081959247589, gen p mean: -0.24808946251869202, mean p set: 0.4477456510066986
loss_pred:0.016406510025262833, decouple_loss:0.003305767895653844
The modified gen p mean: 0.4479821026325226, gen p mean: -0.24831996858119965, mean p set: 0.44855615496635437The modified gen p mean: 0.44828277826309204, gen p mean: -0.24713446199893951, mean p set: 0.4488621652126312
loss_pred:0.01594497449696064, decouple_loss:0.003448626259341836
loss_pred:0.016790367662906647, decouple_loss:0.0033852355554699898
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473254084587097, gen p mean: -0.24251604080200195, mean p set: 0.44785353541374207
loss_pred:0.015949420630931854, decouple_loss:0.0035619186237454414
The modified gen p mean: 0.44824108481407166, gen p mean: -0.24105359613895416, mean p set: 0.4488186836242676
loss_pred:0.01638747937977314, decouple_loss:0.0035540282260626554
The modified gen p mean: 0.4478946328163147, gen p mean: -0.24599014222621918, mean p set: 0.44846081733703613
loss_pred:0.01595052145421505, decouple_loss:0.0038134800270199776
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472130537033081, gen p mean: -0.2410096824169159, mean p set: 0.4477413594722748
loss_pred:0.016228292137384415, decouple_loss:0.003343195654451847
The modified gen p mean: 0.4475192725658417, gen p mean: -0.24279667437076569, mean p set: 0.4480917155742645
loss_pred:0.016435492783784866, decouple_loss:0.003489644732326269
The modified gen p mean: 0.447357177734375, gen p mean: -0.2416633814573288, mean p set: 0.44792893528938293
loss_pred:0.01655278354883194, decouple_loss:0.0034000875893980265
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719499349594116, gen p mean: -0.24174126982688904, mean p set: 0.44771865010261536
loss_pred:0.015478840097784996, decouple_loss:0.003497692057862878
The modified gen p mean: 0.4476569890975952, gen p mean: -0.24072667956352234, mean p set: 0.4482308626174927
loss_pred:0.01628039963543415, decouple_loss:0.003594175213947892
The modified gen p mean: 0.4466046094894409, gen p mean: -0.2401907593011856, mean p set: 0.4471800923347473
loss_pred:0.01645425707101822, decouple_loss:0.003262842074036598
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469030797481537, gen p mean: -0.2457813024520874, mean p set: 0.44742754101753235
loss_pred:0.015524517744779587, decouple_loss:0.0034462003968656063
The modified gen p mean: 0.44816818833351135, gen p mean: -0.2426239550113678, mean p set: 0.4487457573413849
loss_pred:0.01628933660686016, decouple_loss:0.003531682537868619
The modified gen p mean: 0.4469682276248932, gen p mean: -0.24312342703342438, mean p set: 0.44754406809806824
loss_pred:0.015913883224129677, decouple_loss:0.0033300905488431454
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467930197715759, gen p mean: -0.23802073299884796, mean p set: 0.44731831550598145
loss_pred:0.016414472833275795, decouple_loss:0.0036079694982618093
The modified gen p mean: 0.4474310278892517, gen p mean: -0.24657441675662994, mean p set: 0.4480080008506775
loss_pred:0.01630496047437191, decouple_loss:0.003474398050457239
The modified gen p mean: 0.44820529222488403, gen p mean: -0.24396853148937225, mean p set: 0.44877755641937256
loss_pred:0.016347043216228485, decouple_loss:0.003324703546240926
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476107358932495, gen p mean: -0.24624057114124298, mean p set: 0.4481387734413147
loss_pred:0.01599397137761116, decouple_loss:0.0039254287257790565
The modified gen p mean: 0.4471275806427002, gen p mean: -0.24593663215637207, mean p set: 0.44770246744155884
loss_pred:0.015900973230600357, decouple_loss:0.003694697516039014
The modified gen p mean: 0.448758602142334, gen p mean: -0.24511441588401794, mean p set: 0.4493274986743927
loss_pred:0.01607343927025795, decouple_loss:0.0036954167298972607
2023-04-26 19:10:23 testing...
The modified gen p mean: 0.4493798613548279, gen p mean: -0.2437707930803299, mean p set: 0.4499112665653229
loss_pred:0.01851811632514, decouple_loss:0.003686180105432868
The modified gen p mean: 0.4482332468032837, gen p mean: -0.24067644774913788, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492497146129608, gen p mean: -0.2435532957315445, mean p set: 0.4498290419578552
loss_pred:0.018385212868452072, decouple_loss:0.003617811482399702
loss_pred:0.018039941787719727, decouple_loss:0.003633559215813875
WV_1_PC_1_EH_0_PS_30, loss: 0.018496718257665634, avg_mse: 0.027203403413295746
current test mse: 0.027203
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671839475631714, gen p mean: -0.24374786019325256, mean p set: 0.4472944438457489
loss_pred:0.015937676653265953, decouple_loss:0.003401996800675988
The modified gen p mean: 0.44734683632850647, gen p mean: -0.2446836680173874, mean p set: 0.4479289650917053
loss_pred:0.016327664256095886, decouple_loss:0.0034538020845502615
The modified gen p mean: 0.4481709897518158, gen p mean: -0.2408745288848877, mean p set: 0.44870179891586304
loss_pred:0.016238681972026825, decouple_loss:0.003534720279276371
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488627314567566, gen p mean: -0.2413640320301056, mean p set: 0.4493890404701233
loss_pred:0.01594780944287777, decouple_loss:0.003645368618890643
The modified gen p mean: 0.44764965772628784, gen p mean: -0.24819377064704895, mean p set: 0.4482249617576599
loss_pred:0.015625253319740295, decouple_loss:0.0035825916565954685
The modified gen p mean: 0.44766098260879517, gen p mean: -0.24636265635490417, mean p set: 0.4482399523258209
loss_pred:0.016356946900486946, decouple_loss:0.003783492837101221
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470779001712799, gen p mean: -0.23937107622623444, mean p set: 0.44760891795158386
loss_pred:0.016494102776050568, decouple_loss:0.0033317937050014734
The modified gen p mean: 0.4472508132457733, gen p mean: -0.24495923519134521, mean p set: 0.4478244483470917
loss_pred:0.01610472798347473, decouple_loss:0.003462605644017458
The modified gen p mean: 0.4473370611667633, gen p mean: -0.24481725692749023, mean p set: 0.4479069411754608
loss_pred:0.016452882438898087, decouple_loss:0.0033143244218081236
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476909041404724, gen p mean: -0.24375848472118378, mean p set: 0.44821682572364807
loss_pred:0.01612723432481289, decouple_loss:0.0033554015681147575
The modified gen p mean: 0.4489126205444336, gen p mean: -0.2436322271823883, mean p set: 0.4494889974594116The modified gen p mean: 0.4470377564430237, gen p mean: -0.2474515438079834, mean p set: 0.4476131498813629
loss_pred:0.01533674355596304, decouple_loss:0.003924794495105743
loss_pred:0.015274696983397007, decouple_loss:0.0037249005399644375
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851821660995483, gen p mean: -0.24355939030647278, mean p set: 0.44904205203056335
loss_pred:0.01565934717655182, decouple_loss:0.0034428650978952646
The modified gen p mean: 0.44763094186782837, gen p mean: -0.24386772513389587, mean p set: 0.4482089579105377
loss_pred:0.01604488119482994, decouple_loss:0.003555427072569728
The modified gen p mean: 0.44687631726264954, gen p mean: -0.24498435854911804, mean p set: 0.44745007157325745
loss_pred:0.015382248908281326, decouple_loss:0.0034549362026154995
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722017645835876, gen p mean: -0.24068593978881836, mean p set: 0.4477475583553314
loss_pred:0.015556429512798786, decouple_loss:0.0041807484813034534
The modified gen p mean: 0.44821348786354065, gen p mean: -0.24368628859519958, mean p set: 0.44879069924354553
loss_pred:0.0151585778221488, decouple_loss:0.0033390698954463005
The modified gen p mean: 0.4480738043785095, gen p mean: -0.2396453469991684, mean p set: 0.4486466944217682
loss_pred:0.016082661226391792, decouple_loss:0.003378655295819044
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447092741727829, gen p mean: -0.24428009986877441, mean p set: 0.44761648774147034
loss_pred:0.01547437347471714, decouple_loss:0.003781875828281045
The modified gen p mean: 0.44761332869529724, gen p mean: -0.24187062680721283, mean p set: 0.44819164276123047
loss_pred:0.015470148995518684, decouple_loss:0.004019607789814472
The modified gen p mean: 0.4475727081298828, gen p mean: -0.24146901071071625, mean p set: 0.44814959168434143
loss_pred:0.015484069474041462, decouple_loss:0.0037947504315525293
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473154842853546, gen p mean: -0.24148619174957275, mean p set: 0.4478406012058258
loss_pred:0.016214778646826744, decouple_loss:0.0033707325346767902
The modified gen p mean: 0.447714626789093, gen p mean: -0.24073952436447144, mean p set: 0.4482864737510681
loss_pred:0.015903033316135406, decouple_loss:0.0034265134017914534
The modified gen p mean: 0.44777771830558777, gen p mean: -0.23890812695026398, mean p set: 0.4483511745929718
loss_pred:0.015683522447943687, decouple_loss:0.0034521950874477625
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44607433676719666, gen p mean: -0.23631498217582703, mean p set: 0.44660380482673645
loss_pred:0.016135212033987045, decouple_loss:0.0038531434256583452
The modified gen p mean: 0.44819045066833496, gen p mean: -0.24179242551326752, mean p set: 0.4487678110599518
loss_pred:0.01556760910898447, decouple_loss:0.003682396374642849
The modified gen p mean: 0.44744348526000977, gen p mean: -0.24037757515907288, mean p set: 0.4480248689651489
loss_pred:0.015699153766036034, decouple_loss:0.003544586943462491
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477868974208832, gen p mean: -0.23952852189540863, mean p set: 0.44831904768943787
loss_pred:0.016224006190896034, decouple_loss:0.003609861247241497
The modified gen p mean: 0.44724443554878235, gen p mean: -0.23933687806129456, mean p set: 0.4478210508823395
loss_pred:0.016168011352419853, decouple_loss:0.0030704117380082607
The modified gen p mean: 0.4464876651763916, gen p mean: -0.2389196753501892, mean p set: 0.44706112146377563
loss_pred:0.016054421663284302, decouple_loss:0.0032826235983520746
2023-04-26 19:13:48 testing...
The modified gen p mean: 0.4482228457927704, gen p mean: -0.23687435686588287, mean p set: 0.44879910349845886
loss_pred:0.018388589844107628, decouple_loss:0.0037231582682579756
The modified gen p mean: 0.44938206672668457, gen p mean: -0.2396617829799652, mean p set: 0.4499112665653229
loss_pred:0.01852996274828911, decouple_loss:0.0038425414822995663
The modified gen p mean: 0.44925740361213684, gen p mean: -0.23945528268814087, mean p set: 0.4498290419578552
loss_pred:0.018079014495015144, decouple_loss:0.003899096278473735
WV_1_PC_1_EH_0_PS_30, loss: 0.018523603677749634, avg_mse: 0.027251893654465675
current test mse: 0.027252
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665688276290894, gen p mean: -0.2437751740217209, mean p set: 0.44719311594963074
loss_pred:0.016380108892917633, decouple_loss:0.003851638175547123
The modified gen p mean: 0.44573524594306946, gen p mean: -0.2416563779115677, mean p set: 0.44631072878837585
loss_pred:0.01652618497610092, decouple_loss:0.003580999094992876
The modified gen p mean: 0.44786813855171204, gen p mean: -0.23882168531417847, mean p set: 0.4484444558620453
loss_pred:0.0174944456666708, decouple_loss:0.004244976211339235
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455358684062958, gen p mean: -0.2386114001274109, mean p set: 0.44606199860572815
loss_pred:0.01676737330853939, decouple_loss:0.0035132302436977625
The modified gen p mean: 0.44716501235961914, gen p mean: -0.24201714992523193, mean p set: 0.44773659110069275
loss_pred:0.016539232805371284, decouple_loss:0.0035502819810062647
The modified gen p mean: 0.44409120082855225, gen p mean: -0.23787067830562592, mean p set: 0.44466984272003174
loss_pred:0.017295805737376213, decouple_loss:0.0039265831001102924
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44612857699394226, gen p mean: -0.2381088137626648, mean p set: 0.4466569721698761
loss_pred:0.01692144386470318, decouple_loss:0.003387857461348176
The modified gen p mean: 0.44696900248527527, gen p mean: -0.23900139331817627, mean p set: 0.4475449025630951
loss_pred:0.017525723204016685, decouple_loss:0.0034523243084549904
The modified gen p mean: 0.44581523537635803, gen p mean: -0.24063649773597717, mean p set: 0.44639402627944946
loss_pred:0.01660154014825821, decouple_loss:0.0032671738881617785
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640129804611206, gen p mean: -0.24358735978603363, mean p set: 0.4469238221645355
loss_pred:0.017012206837534904, decouple_loss:0.003590143285691738
The modified gen p mean: 0.44631633162498474, gen p mean: -0.24001510441303253, mean p set: 0.4468989372253418
loss_pred:0.016592537984251976, decouple_loss:0.00347504741512239
The modified gen p mean: 0.44623005390167236, gen p mean: -0.24171777069568634, mean p set: 0.4468083381652832
loss_pred:0.01665765419602394, decouple_loss:0.003611059859395027
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700175523757935, gen p mean: -0.2395230531692505, mean p set: 0.4475346803665161
loss_pred:0.017536060884594917, decouple_loss:0.0034673167392611504
The modified gen p mean: 0.44590696692466736, gen p mean: -0.23940034210681915, mean p set: 0.44647544622421265
loss_pred:0.017527347430586815, decouple_loss:0.0035020422656089067
The modified gen p mean: 0.4460020065307617, gen p mean: -0.24260297417640686, mean p set: 0.4465799629688263
loss_pred:0.016285624355077744, decouple_loss:0.00335317593999207
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660934805870056, gen p mean: -0.24571919441223145, mean p set: 0.44713932275772095
loss_pred:0.01662382110953331, decouple_loss:0.003263355465605855
The modified gen p mean: 0.4470456838607788, gen p mean: -0.24253961443901062, mean p set: 0.4476243555545807
loss_pred:0.01646341010928154, decouple_loss:0.0033049150370061398
The modified gen p mean: 0.4468686878681183, gen p mean: -0.24176615476608276, mean p set: 0.44744303822517395
loss_pred:0.016807109117507935, decouple_loss:0.0034396457485854626
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697105884552, gen p mean: -0.24960291385650635, mean p set: 0.44749611616134644
loss_pred:0.016392093151807785, decouple_loss:0.0036532599478960037
The modified gen p mean: 0.44673776626586914, gen p mean: -0.24728713929653168, mean p set: 0.44731536507606506The modified gen p mean: 0.4457002878189087, gen p mean: -0.24146829545497894, mean p set: 0.446274995803833
loss_pred:0.017149070277810097, decouple_loss:0.003253834554925561
loss_pred:0.01682603359222412, decouple_loss:0.0033669499680399895
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711506366729736, gen p mean: -0.2367544025182724, mean p set: 0.44763532280921936
loss_pred:0.017048154026269913, decouple_loss:0.003075833199545741
The modified gen p mean: 0.44705766439437866, gen p mean: -0.2434876710176468, mean p set: 0.4476405084133148
loss_pred:0.016575802117586136, decouple_loss:0.0029484638944268227
The modified gen p mean: 0.446700781583786, gen p mean: -0.2398533821105957, mean p set: 0.4472745358943939
loss_pred:0.015831278637051582, decouple_loss:0.003215611446648836
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702112674713135, gen p mean: -0.23799997568130493, mean p set: 0.44754984974861145
loss_pred:0.016672618687152863, decouple_loss:0.003539887722581625
The modified gen p mean: 0.44643664360046387, gen p mean: -0.2378610223531723, mean p set: 0.4470106363296509
loss_pred:0.016826579347252846, decouple_loss:0.0039606159552931786
The modified gen p mean: 0.44682538509368896, gen p mean: -0.24038934707641602, mean p set: 0.447405070066452
loss_pred:0.016413269564509392, decouple_loss:0.003427662421017885
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700002670288086, gen p mean: -0.24074600636959076, mean p set: 0.44752374291419983
loss_pred:0.017227796837687492, decouple_loss:0.0038087540306150913
The modified gen p mean: 0.44547101855278015, gen p mean: -0.24348032474517822, mean p set: 0.44604605436325073
loss_pred:0.01632930152118206, decouple_loss:0.003562613157555461
The modified gen p mean: 0.4450761079788208, gen p mean: -0.23926867544651031, mean p set: 0.4456527829170227
loss_pred:0.016261350363492966, decouple_loss:0.0035141054540872574
2023-04-26 19:18:06 testing...
The modified gen p mean: 0.44938924908638, gen p mean: -0.24410730600357056, mean p set: 0.4499112665653229
loss_pred:0.018499212339520454, decouple_loss:0.0035329710226505995
The modified gen p mean: 0.44822704792022705, gen p mean: -0.2416517734527588, mean p set: 0.44879910349845886
The modified gen p mean: 0.44925588369369507, gen p mean: -0.24365651607513428, mean p set: 0.4498290419578552
loss_pred:0.018347684293985367, decouple_loss:0.003494950942695141
loss_pred:0.018005020916461945, decouple_loss:0.0035936792846769094
WV_1_PC_1_EH_0_PS_30, loss: 0.01846100017428398, avg_mse: 0.02719077467918396
current test mse: 0.027191
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445762574672699, gen p mean: -0.24419280886650085, mean p set: 0.4463409185409546
loss_pred:0.016379641368985176, decouple_loss:0.003315115114673972
The modified gen p mean: 0.44649675488471985, gen p mean: -0.24837499856948853, mean p set: 0.44707778096199036
loss_pred:0.016673732548952103, decouple_loss:0.0032833965960890055
The modified gen p mean: 0.4464254677295685, gen p mean: -0.24817436933517456, mean p set: 0.44695594906806946
loss_pred:0.015966415405273438, decouple_loss:0.0035851679276674986
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459114968776703, gen p mean: -0.24603863060474396, mean p set: 0.4464392364025116
loss_pred:0.016614152118563652, decouple_loss:0.003548473585397005
The modified gen p mean: 0.44646310806274414, gen p mean: -0.24798771739006042, mean p set: 0.4470418095588684
loss_pred:0.016283826902508736, decouple_loss:0.003624615492299199
The modified gen p mean: 0.44620421528816223, gen p mean: -0.24655653536319733, mean p set: 0.44678211212158203
loss_pred:0.016357973217964172, decouple_loss:0.0035957300569862127
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717833399772644, gen p mean: -0.2508220672607422, mean p set: 0.44770827889442444
loss_pred:0.016972076147794724, decouple_loss:0.00329600740224123
The modified gen p mean: 0.4464257061481476, gen p mean: -0.24659623205661774, mean p set: 0.447003036737442
loss_pred:0.0166013240814209, decouple_loss:0.003574693575501442
The modified gen p mean: 0.44708359241485596, gen p mean: -0.2509966790676117, mean p set: 0.44765836000442505
loss_pred:0.016413835808634758, decouple_loss:0.0036297112237662077
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44655388593673706, gen p mean: -0.2508285939693451, mean p set: 0.4470827281475067
loss_pred:0.01661207340657711, decouple_loss:0.003869221778586507
The modified gen p mean: 0.4457879066467285, gen p mean: -0.25164586305618286, mean p set: 0.4463599622249603
loss_pred:0.016780521720647812, decouple_loss:0.0037123977672308683
The modified gen p mean: 0.44537439942359924, gen p mean: -0.24682007730007172, mean p set: 0.4459480941295624
loss_pred:0.016650820150971413, decouple_loss:0.0035915274638682604
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475744664669037, gen p mean: -0.25200676918029785, mean p set: 0.4481041729450226
loss_pred:0.01711985096335411, decouple_loss:0.003461953718215227
The modified gen p mean: 0.4467273950576782, gen p mean: -0.24868443608283997, mean p set: 0.44729533791542053
loss_pred:0.016180863603949547, decouple_loss:0.003330888459458947
The modified gen p mean: 0.44559964537620544, gen p mean: -0.25312569737434387, mean p set: 0.446174293756485
loss_pred:0.016570216044783592, decouple_loss:0.0035103748086839914
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464209973812103, gen p mean: -0.2460075467824936, mean p set: 0.44695156812667847
loss_pred:0.016591107472777367, decouple_loss:0.0037337818648666143
The modified gen p mean: 0.446413516998291, gen p mean: -0.2458907663822174, mean p set: 0.446982741355896
loss_pred:0.01661686785519123, decouple_loss:0.003489273600280285
The modified gen p mean: 0.44645825028419495, gen p mean: -0.24832138419151306, mean p set: 0.4470359981060028
loss_pred:0.01620352454483509, decouple_loss:0.0035246561747044325
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733187556266785, gen p mean: -0.2435559779405594, mean p set: 0.4478660225868225
loss_pred:0.017267514020204544, decouple_loss:0.003605660516768694
The modified gen p mean: 0.44695645570755005, gen p mean: -0.24821124970912933, mean p set: 0.4475320279598236
loss_pred:0.016153497621417046, decouple_loss:0.003427371382713318
The modified gen p mean: 0.44556310772895813, gen p mean: -0.24434804916381836, mean p set: 0.44613370299339294
loss_pred:0.016294091939926147, decouple_loss:0.003548507811501622
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454234838485718, gen p mean: -0.24779361486434937, mean p set: 0.44595643877983093
loss_pred:0.01673617772758007, decouple_loss:0.003265548264607787
The modified gen p mean: 0.44656136631965637, gen p mean: -0.24740029871463776, mean p set: 0.44714006781578064
loss_pred:0.016668695956468582, decouple_loss:0.003390137804672122
The modified gen p mean: 0.4455462396144867, gen p mean: -0.24521975219249725, mean p set: 0.44611749053001404
loss_pred:0.016367198899388313, decouple_loss:0.0034429836086928844
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759663939476013, gen p mean: -0.2465457171201706, mean p set: 0.44812965393066406
loss_pred:0.01692579686641693, decouple_loss:0.0035851432476192713
The modified gen p mean: 0.44481852650642395, gen p mean: -0.24509964883327484, mean p set: 0.4453986883163452
loss_pred:0.017068613320589066, decouple_loss:0.00388823333196342
The modified gen p mean: 0.4466610848903656, gen p mean: -0.24631299078464508, mean p set: 0.44723621010780334
loss_pred:0.016561388969421387, decouple_loss:0.0037218325305730104
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44587960839271545, gen p mean: -0.24550692737102509, mean p set: 0.44640541076660156
loss_pred:0.016387760639190674, decouple_loss:0.0033251321874558926
The modified gen p mean: 0.44706007838249207, gen p mean: -0.2462860345840454, mean p set: 0.4476345181465149
loss_pred:0.01658717170357704, decouple_loss:0.0035428269766271114
The modified gen p mean: 0.44627606868743896, gen p mean: -0.24714882671833038, mean p set: 0.4468485414981842
loss_pred:0.01632160320878029, decouple_loss:0.0033968319185078144
2023-04-26 19:21:31 testing...
The modified gen p mean: 0.44822055101394653, gen p mean: -0.2418128252029419, mean p set: 0.44879910349845886
loss_pred:0.018438756465911865, decouple_loss:0.003924029879271984
The modified gen p mean: 0.44937726855278015, gen p mean: -0.24478010833263397, mean p set: 0.4499112665653229
loss_pred:0.018460087478160858, decouple_loss:0.004089753143489361
The modified gen p mean: 0.44925162196159363, gen p mean: -0.24419179558753967, mean p set: 0.4498290419578552
loss_pred:0.01804967038333416, decouple_loss:0.0039550443179905415
WV_1_PC_1_EH_0_PS_30, loss: 0.018515652045607567, avg_mse: 0.02717963047325611
current test mse: 0.02718
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489578604698181, gen p mean: -0.24464815855026245, mean p set: 0.4494836926460266
loss_pred:0.01634031906723976, decouple_loss:0.003917895257472992
The modified gen p mean: 0.44973355531692505, gen p mean: -0.2388845682144165, mean p set: 0.450310081243515
loss_pred:0.016895553097128868, decouple_loss:0.0041038901545107365
The modified gen p mean: 0.450015127658844, gen p mean: -0.24657323956489563, mean p set: 0.45059165358543396
loss_pred:0.016717687249183655, decouple_loss:0.0039533935487270355
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804316759109497, gen p mean: -0.24144193530082703, mean p set: 0.4485754370689392
loss_pred:0.0171494260430336, decouple_loss:0.0038782437331974506
The modified gen p mean: 0.44982418417930603, gen p mean: -0.2425457090139389, mean p set: 0.4504038989543915
loss_pred:0.016129057854413986, decouple_loss:0.0036030791234225035
The modified gen p mean: 0.44880104064941406, gen p mean: -0.23709993064403534, mean p set: 0.4493807256221771
loss_pred:0.016332317143678665, decouple_loss:0.0039057403337210417
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940587878227234, gen p mean: -0.24211730062961578, mean p set: 0.4499303698539734
loss_pred:0.01741739921271801, decouple_loss:0.004104008432477713
The modified gen p mean: 0.4489666521549225, gen p mean: -0.2422894537448883, mean p set: 0.4495515525341034
loss_pred:0.016437022015452385, decouple_loss:0.0036424591671675444
The modified gen p mean: 0.450597882270813, gen p mean: -0.2337389886379242, mean p set: 0.451172411441803
loss_pred:0.01655283197760582, decouple_loss:0.004337342921644449
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495006501674652, gen p mean: -0.24022047221660614, mean p set: 0.45003435015678406
loss_pred:0.016113582998514175, decouple_loss:0.0035661268047988415
The modified gen p mean: 0.44952136278152466, gen p mean: -0.23982839286327362, mean p set: 0.4500974118709564
loss_pred:0.016220390796661377, decouple_loss:0.003945157863199711
The modified gen p mean: 0.449467271566391, gen p mean: -0.2374604493379593, mean p set: 0.45004376769065857
loss_pred:0.015151195228099823, decouple_loss:0.0039974418468773365
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487036466598511, gen p mean: -0.24315756559371948, mean p set: 0.449236124753952
loss_pred:0.01631622016429901, decouple_loss:0.003648219397291541
The modified gen p mean: 0.4489189386367798, gen p mean: -0.2345341145992279, mean p set: 0.4494929015636444
loss_pred:0.016539674252271652, decouple_loss:0.003669469151645899
The modified gen p mean: 0.44842010736465454, gen p mean: -0.23820488154888153, mean p set: 0.44899484515190125
loss_pred:0.017333291471004486, decouple_loss:0.00382435810752213
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780874252319336, gen p mean: -0.24215415120124817, mean p set: 0.44834738969802856
loss_pred:0.016136767342686653, decouple_loss:0.0036354740150272846
The modified gen p mean: 0.44782885909080505, gen p mean: -0.2335413247346878, mean p set: 0.4484051764011383
loss_pred:0.01622975617647171, decouple_loss:0.003923751879483461
The modified gen p mean: 0.4491918683052063, gen p mean: -0.2376335710287094, mean p set: 0.4497624933719635
loss_pred:0.0163885410875082, decouple_loss:0.0039053193759173155
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864189624786377, gen p mean: -0.2377873659133911, mean p set: 0.4491713047027588
loss_pred:0.016673265025019646, decouple_loss:0.003868168219923973
The modified gen p mean: 0.4479159116744995, gen p mean: -0.24304354190826416, mean p set: 0.44848892092704773The modified gen p mean: 0.44869381189346313, gen p mean: -0.24110758304595947, mean p set: 0.4492739737033844
loss_pred:0.01678462140262127, decouple_loss:0.00410087825730443
loss_pred:0.01686943508684635, decouple_loss:0.00397397531196475
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478946328163147, gen p mean: -0.24370385706424713, mean p set: 0.44842392206192017
loss_pred:0.016201045364141464, decouple_loss:0.0035816968884319067
The modified gen p mean: 0.4492088258266449, gen p mean: -0.24181966483592987, mean p set: 0.4497894048690796
loss_pred:0.016087794676423073, decouple_loss:0.0035439671482890844
The modified gen p mean: 0.44927945733070374, gen p mean: -0.2373107224702835, mean p set: 0.44986000657081604
loss_pred:0.016089025884866714, decouple_loss:0.0035110958851873875
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482947587966919, gen p mean: -0.23685738444328308, mean p set: 0.4488248825073242
loss_pred:0.016413448378443718, decouple_loss:0.004424508195370436
The modified gen p mean: 0.4484022259712219, gen p mean: -0.23647794127464294, mean p set: 0.44897210597991943
loss_pred:0.016604524105787277, decouple_loss:0.004547952674329281
The modified gen p mean: 0.44841551780700684, gen p mean: -0.2340712547302246, mean p set: 0.4489958584308624
loss_pred:0.016571426764130592, decouple_loss:0.004226279444992542
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478050768375397, gen p mean: -0.24583661556243896, mean p set: 0.44832560420036316
loss_pred:0.016023045405745506, decouple_loss:0.0035496402997523546
The modified gen p mean: 0.4489092528820038, gen p mean: -0.23945066332817078, mean p set: 0.4494885504245758
loss_pred:0.017020097002387047, decouple_loss:0.003405742347240448
The modified gen p mean: 0.4481816589832306, gen p mean: -0.2446296513080597, mean p set: 0.4487546384334564
loss_pred:0.016588345170021057, decouple_loss:0.003498837584629655
2023-04-26 19:25:47 testing...
The modified gen p mean: 0.4493817687034607, gen p mean: -0.2426355928182602, mean p set: 0.4499112665653229
loss_pred:0.01843266934156418, decouple_loss:0.004256368614733219
The modified gen p mean: 0.4482220411300659, gen p mean: -0.23968525230884552, mean p set: 0.44879910349845886
loss_pred:0.018383312970399857, decouple_loss:0.003974694758653641
The modified gen p mean: 0.4492547810077667, gen p mean: -0.24235013127326965, mean p set: 0.4498290419578552
loss_pred:0.01812402345240116, decouple_loss:0.0042061288841068745
WV_1_PC_1_EH_0_PS_30, loss: 0.018520621582865715, avg_mse: 0.02717842161655426
current test mse: 0.027178
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935351610183716, gen p mean: -0.2404594123363495, mean p set: 0.4499305486679077
loss_pred:0.01570672169327736, decouple_loss:0.0036537721753120422
The modified gen p mean: 0.4499500095844269, gen p mean: -0.23584693670272827, mean p set: 0.450520396232605
loss_pred:0.015959257259964943, decouple_loss:0.003769383067265153
The modified gen p mean: 0.4484814405441284, gen p mean: -0.2347986251115799, mean p set: 0.44901344180107117
loss_pred:0.016213560476899147, decouple_loss:0.0036625936627388
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448349267244339, gen p mean: -0.23662805557250977, mean p set: 0.4488753378391266
loss_pred:0.016530178487300873, decouple_loss:0.003719425993040204
The modified gen p mean: 0.44843554496765137, gen p mean: -0.24283169209957123, mean p set: 0.4490082263946533
loss_pred:0.015890447422862053, decouple_loss:0.00350704207085073
The modified gen p mean: 0.4489319920539856, gen p mean: -0.23458270728588104, mean p set: 0.4495154023170471
loss_pred:0.015802595764398575, decouple_loss:0.0035482479725033045
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905218482017517, gen p mean: -0.24072572588920593, mean p set: 0.4495806396007538
loss_pred:0.01556339394301176, decouple_loss:0.003561759367585182
The modified gen p mean: 0.4477825164794922, gen p mean: -0.24350422620773315, mean p set: 0.4483579099178314
loss_pred:0.015383070334792137, decouple_loss:0.0033428226597607136
The modified gen p mean: 0.4509566128253937, gen p mean: -0.2329777628183365, mean p set: 0.4515393376350403
loss_pred:0.016310904175043106, decouple_loss:0.0035964972339570522
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491678774356842, gen p mean: -0.24202324450016022, mean p set: 0.4496983587741852
loss_pred:0.01644081622362137, decouple_loss:0.0033927070908248425
The modified gen p mean: 0.4493907690048218, gen p mean: -0.23939211666584015, mean p set: 0.44996556639671326
loss_pred:0.015875838696956635, decouple_loss:0.003391947830095887
The modified gen p mean: 0.44793030619621277, gen p mean: -0.2475873976945877, mean p set: 0.44850850105285645
loss_pred:0.015539301559329033, decouple_loss:0.003435177495703101
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479246139526367, gen p mean: -0.24540455639362335, mean p set: 0.4484458863735199
loss_pred:0.01619957759976387, decouple_loss:0.0032836804166436195
The modified gen p mean: 0.44973018765449524, gen p mean: -0.23973232507705688, mean p set: 0.4503089487552643
loss_pred:0.01555499155074358, decouple_loss:0.0031775706447660923
The modified gen p mean: 0.4487585127353668, gen p mean: -0.24264506995677948, mean p set: 0.44933852553367615
loss_pred:0.016054820269346237, decouple_loss:0.0032637647818773985
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776642322540283, gen p mean: -0.24222517013549805, mean p set: 0.44829061627388
loss_pred:0.01626925729215145, decouple_loss:0.0033750582952052355
The modified gen p mean: 0.44920632243156433, gen p mean: -0.2344721108675003, mean p set: 0.44977647066116333
loss_pred:0.015827594324946404, decouple_loss:0.0031586536206305027
The modified gen p mean: 0.4488326609134674, gen p mean: -0.23301810026168823, mean p set: 0.44941237568855286
loss_pred:0.01648353412747383, decouple_loss:0.0032847593538463116
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493843615055084, gen p mean: -0.24102655053138733, mean p set: 0.44991445541381836
loss_pred:0.016257839277386665, decouple_loss:0.0030275715980678797
The modified gen p mean: 0.4487772285938263, gen p mean: -0.23849141597747803, mean p set: 0.4493550956249237
loss_pred:0.01605919934809208, decouple_loss:0.0032650779467076063
The modified gen p mean: 0.44944313168525696, gen p mean: -0.23138588666915894, mean p set: 0.4500153958797455
loss_pred:0.015342721715569496, decouple_loss:0.0031577441841363907
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911226630210876, gen p mean: -0.22821468114852905, mean p set: 0.44964277744293213
loss_pred:0.016325848177075386, decouple_loss:0.0033973834943026304
The modified gen p mean: 0.44852519035339355, gen p mean: -0.23383623361587524, mean p set: 0.44910159707069397
loss_pred:0.016144657507538795, decouple_loss:0.0031106784008443356
The modified gen p mean: 0.4499686062335968, gen p mean: -0.2292981594800949, mean p set: 0.45054665207862854
loss_pred:0.01586151123046875, decouple_loss:0.0032218878623098135
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857165217399597, gen p mean: -0.22717930376529694, mean p set: 0.44910016655921936
loss_pred:0.016698475927114487, decouple_loss:0.0030286703258752823
The modified gen p mean: 0.4491390883922577, gen p mean: -0.23132579028606415, mean p set: 0.44971972703933716
loss_pred:0.01585695892572403, decouple_loss:0.002904593013226986
The modified gen p mean: 0.4474699795246124, gen p mean: -0.2394925355911255, mean p set: 0.4480412006378174
loss_pred:0.016306282952427864, decouple_loss:0.0030717088375240564
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44875141978263855, gen p mean: -0.22898265719413757, mean p set: 0.44927287101745605
loss_pred:0.016434645280241966, decouple_loss:0.003641638206318021
The modified gen p mean: 0.4481388032436371, gen p mean: -0.23181188106536865, mean p set: 0.4487136900424957
loss_pred:0.016764508560299873, decouple_loss:0.003420863999053836
The modified gen p mean: 0.4481360912322998, gen p mean: -0.23683781921863556, mean p set: 0.44871246814727783
loss_pred:0.016305597499012947, decouple_loss:0.0032269437797367573
2023-04-26 19:29:12 testing...
The modified gen p mean: 0.4482220709323883, gen p mean: -0.23073972761631012, mean p set: 0.44879910349845886
loss_pred:0.018462801352143288, decouple_loss:0.0033037427347153425
The modified gen p mean: 0.44938376545906067, gen p mean: -0.23357000946998596, mean p set: 0.4499112665653229
loss_pred:0.018451638519763947, decouple_loss:0.003378929803147912
The modified gen p mean: 0.44925588369369507, gen p mean: -0.2334470897912979, mean p set: 0.4498290419578552
loss_pred:0.018039828166365623, decouple_loss:0.003311841981485486
WV_1_PC_1_EH_0_PS_30, loss: 0.01848466508090496, avg_mse: 0.027211874723434448
current test mse: 0.027212
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765257835388184, gen p mean: -0.23238402605056763, mean p set: 0.4481835961341858
loss_pred:0.01587907411158085, decouple_loss:0.003296782961115241
The modified gen p mean: 0.4485946297645569, gen p mean: -0.22819538414478302, mean p set: 0.44917070865631104
loss_pred:0.016145959496498108, decouple_loss:0.003242361592128873
The modified gen p mean: 0.4478045403957367, gen p mean: -0.23330886662006378, mean p set: 0.44837847352027893
loss_pred:0.015800636261701584, decouple_loss:0.0031160672660917044
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478538930416107, gen p mean: -0.2363862246274948, mean p set: 0.4483788311481476
loss_pred:0.015999000519514084, decouple_loss:0.0032225404866039753
The modified gen p mean: 0.44840118288993835, gen p mean: -0.239414781332016, mean p set: 0.44897761940956116
loss_pred:0.015525504015386105, decouple_loss:0.003182155778631568
The modified gen p mean: 0.446921706199646, gen p mean: -0.2400125414133072, mean p set: 0.4475003480911255
loss_pred:0.01587517373263836, decouple_loss:0.0034429337829351425
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476454555988312, gen p mean: -0.2399081289768219, mean p set: 0.44817450642585754
loss_pred:0.016029929742217064, decouple_loss:0.003250161185860634
The modified gen p mean: 0.4470933675765991, gen p mean: -0.2395893931388855, mean p set: 0.4476650059223175The modified gen p mean: 0.4487958252429962, gen p mean: -0.233173206448555, mean p set: 0.44937047362327576
loss_pred:0.01608758047223091, decouple_loss:0.003136266255751252
loss_pred:0.01617794670164585, decouple_loss:0.00337010296061635
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747403264045715, gen p mean: -0.23377901315689087, mean p set: 0.44800058007240295
loss_pred:0.015172580257058144, decouple_loss:0.002960852812975645
The modified gen p mean: 0.44678378105163574, gen p mean: -0.231960728764534, mean p set: 0.4473542869091034
loss_pred:0.015775879845023155, decouple_loss:0.00309357768855989
The modified gen p mean: 0.44791778922080994, gen p mean: -0.22866687178611755, mean p set: 0.4484962224960327
loss_pred:0.015883808955550194, decouple_loss:0.0033110259100794792
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44592970609664917, gen p mean: -0.23986542224884033, mean p set: 0.44645851850509644
loss_pred:0.0156288743019104, decouple_loss:0.0028627519495785236
The modified gen p mean: 0.4471903145313263, gen p mean: -0.2425573617219925, mean p set: 0.4477671980857849
loss_pred:0.015794016420841217, decouple_loss:0.002962514292448759
The modified gen p mean: 0.44753727316856384, gen p mean: -0.23886868357658386, mean p set: 0.4481063485145569
loss_pred:0.016302097588777542, decouple_loss:0.003135555423796177
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480736255645752, gen p mean: -0.24648860096931458, mean p set: 0.44860121607780457
loss_pred:0.015271809883415699, decouple_loss:0.003036762122064829
The modified gen p mean: 0.44857072830200195, gen p mean: -0.24544940888881683, mean p set: 0.4491502642631531
loss_pred:0.016206810250878334, decouple_loss:0.0035102928522974253
The modified gen p mean: 0.4466918706893921, gen p mean: -0.24336761236190796, mean p set: 0.4472596049308777
loss_pred:0.015972280874848366, decouple_loss:0.0030189796816557646
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486085772514343, gen p mean: -0.23506802320480347, mean p set: 0.44913291931152344
loss_pred:0.016490019857883453, decouple_loss:0.0034292289055883884
The modified gen p mean: 0.44669198989868164, gen p mean: -0.2394547462463379, mean p set: 0.44727250933647156
loss_pred:0.01599275693297386, decouple_loss:0.003390102181583643
The modified gen p mean: 0.447194367647171, gen p mean: -0.2429322749376297, mean p set: 0.4477669298648834
loss_pred:0.01606057956814766, decouple_loss:0.0033674663864076138
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487221837043762, gen p mean: -0.23143982887268066, mean p set: 0.44924822449684143
loss_pred:0.015960926190018654, decouple_loss:0.003908528946340084
The modified gen p mean: 0.44628626108169556, gen p mean: -0.2362239509820938, mean p set: 0.4468632936477661
loss_pred:0.016278717666864395, decouple_loss:0.003454335033893585
The modified gen p mean: 0.44763869047164917, gen p mean: -0.23274029791355133, mean p set: 0.4482133686542511
loss_pred:0.01631879061460495, decouple_loss:0.0033257578033953905
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807198643684387, gen p mean: -0.23119620978832245, mean p set: 0.44860079884529114
loss_pred:0.0161855760961771, decouple_loss:0.0034988040570169687
The modified gen p mean: 0.4461856186389923, gen p mean: -0.23448003828525543, mean p set: 0.44676437973976135The modified gen p mean: 0.44769176840782166, gen p mean: -0.23191797733306885, mean p set: 0.4482652246952057
loss_pred:0.016083594411611557, decouple_loss:0.003569834865629673
loss_pred:0.016006924211978912, decouple_loss:0.0034856011625379324
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447689950466156, gen p mean: -0.23931145668029785, mean p set: 0.44821637868881226
loss_pred:0.016231728717684746, decouple_loss:0.0038567872252315283
The modified gen p mean: 0.4477371871471405, gen p mean: -0.24127861857414246, mean p set: 0.4483039677143097
loss_pred:0.015570717863738537, decouple_loss:0.0037275138311088085
The modified gen p mean: 0.44772419333457947, gen p mean: -0.24026255309581757, mean p set: 0.4483005702495575
loss_pred:0.016574477776885033, decouple_loss:0.003820159239694476
2023-04-26 19:33:24 testing...
The modified gen p mean: 0.4482208788394928, gen p mean: -0.24337685108184814, mean p set: 0.44879910349845886
loss_pred:0.018634382635354996, decouple_loss:0.00387611729092896
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24617882072925568, mean p set: 0.4499112665653229
loss_pred:0.018743421882390976, decouple_loss:0.00401614885777235
The modified gen p mean: 0.4492494463920593, gen p mean: -0.24618986248970032, mean p set: 0.4498290419578552
loss_pred:0.01817459426820278, decouple_loss:0.003890624502673745
WV_1_PC_1_EH_0_PS_30, loss: 0.018713850528001785, avg_mse: 0.02753470465540886
current test mse: 0.027535
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455335736274719, gen p mean: -0.24845393002033234, mean p set: 0.4461096227169037
loss_pred:0.015960870310664177, decouple_loss:0.0035382602363824844
The modified gen p mean: 0.44694074988365173, gen p mean: -0.24772395193576813, mean p set: 0.4475173056125641
loss_pred:0.01613457128405571, decouple_loss:0.003712130943313241
The modified gen p mean: 0.44737231731414795, gen p mean: -0.24626928567886353, mean p set: 0.44789940118789673
loss_pred:0.01655549928545952, decouple_loss:0.003694837214425206
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472624659538269, gen p mean: -0.25627341866493225, mean p set: 0.44778600335121155
loss_pred:0.015947559848427773, decouple_loss:0.0036257815081626177
The modified gen p mean: 0.4463757574558258, gen p mean: -0.25458967685699463, mean p set: 0.44695839285850525
loss_pred:0.015917010605335236, decouple_loss:0.0035326143261045218
The modified gen p mean: 0.4471084177494049, gen p mean: -0.2570849061012268, mean p set: 0.4476828873157501
loss_pred:0.015606142580509186, decouple_loss:0.0037008854560554028
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484046697616577, gen p mean: -0.2518043518066406, mean p set: 0.448940247297287
loss_pred:0.016028154641389847, decouple_loss:0.003562169149518013
The modified gen p mean: 0.4478156864643097, gen p mean: -0.2511301040649414, mean p set: 0.44838836789131165The modified gen p mean: 0.44680503010749817, gen p mean: -0.25506356358528137, mean p set: 0.4473881721496582
loss_pred:0.015292683616280556, decouple_loss:0.0035366364754736423
loss_pred:0.01610778272151947, decouple_loss:0.0036430666223168373
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738706946372986, gen p mean: -0.24629798531532288, mean p set: 0.4479072690010071
loss_pred:0.01603008061647415, decouple_loss:0.0035495951306074858
The modified gen p mean: 0.44722601771354675, gen p mean: -0.25170496106147766, mean p set: 0.44780340790748596The modified gen p mean: 0.44685590267181396, gen p mean: -0.2529659867286682, mean p set: 0.4474402070045471
loss_pred:0.016033820807933807, decouple_loss:0.00356094678863883
loss_pred:0.01624690555036068, decouple_loss:0.0036587396170943975
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474579095840454, gen p mean: -0.24851536750793457, mean p set: 0.4480327069759369
The modified gen p mean: 0.44644495844841003, gen p mean: -0.25411635637283325, mean p set: 0.4470282196998596
loss_pred:0.015505456365644932, decouple_loss:0.0035594089422374964
loss_pred:0.015578259713947773, decouple_loss:0.0036112465895712376
The modified gen p mean: 0.4480920135974884, gen p mean: -0.25134819746017456, mean p set: 0.44862261414527893
loss_pred:0.01569843478500843, decouple_loss:0.003638126887381077
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476029872894287, gen p mean: -0.24920986592769623, mean p set: 0.4481825828552246
loss_pred:0.015416492708027363, decouple_loss:0.003393198363482952
The modified gen p mean: 0.4474438726902008, gen p mean: -0.2527261972427368, mean p set: 0.4479711353778839The modified gen p mean: 0.4475563168525696, gen p mean: -0.25458377599716187, mean p set: 0.44813501834869385
loss_pred:0.016142044216394424, decouple_loss:0.0035808831453323364
loss_pred:0.015957055613398552, decouple_loss:0.003681967733427882
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854339957237244, gen p mean: -0.24142615497112274, mean p set: 0.4491216838359833
loss_pred:0.015660375356674194, decouple_loss:0.003971411846578121
The modified gen p mean: 0.4475173056125641, gen p mean: -0.2448212206363678, mean p set: 0.4480895698070526
loss_pred:0.015656035393476486, decouple_loss:0.0036635994911193848
The modified gen p mean: 0.4471796452999115, gen p mean: -0.24682247638702393, mean p set: 0.4477144777774811
loss_pred:0.015615160576999187, decouple_loss:0.0038102411199361086
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676288962364197, gen p mean: -0.25207602977752686, mean p set: 0.4473342299461365
loss_pred:0.015858028084039688, decouple_loss:0.0032621920108795166
The modified gen p mean: 0.44737792015075684, gen p mean: -0.25131237506866455, mean p set: 0.4479547441005707
loss_pred:0.015330727212131023, decouple_loss:0.0033254458103328943
The modified gen p mean: 0.44689515233039856, gen p mean: -0.2524055242538452, mean p set: 0.4474206268787384
loss_pred:0.0160022284835577, decouple_loss:0.0032728149089962244
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447620153427124, gen p mean: -0.2519006133079529, mean p set: 0.4481982886791229
loss_pred:0.015630656853318214, decouple_loss:0.00346393627114594
The modified gen p mean: 0.44829198718070984, gen p mean: -0.25444138050079346, mean p set: 0.44886934757232666
loss_pred:0.015568433329463005, decouple_loss:0.0035821988712996244
The modified gen p mean: 0.4473887085914612, gen p mean: -0.2555934488773346, mean p set: 0.4479212760925293
loss_pred:0.015468647703528404, decouple_loss:0.003433246398344636
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473415017127991, gen p mean: -0.25273919105529785, mean p set: 0.44791606068611145
loss_pred:0.016360193490982056, decouple_loss:0.0036448438186198473
The modified gen p mean: 0.4479447603225708, gen p mean: -0.2552959620952606, mean p set: 0.44852009415626526
loss_pred:0.015551171265542507, decouple_loss:0.003560379147529602
The modified gen p mean: 0.4481174647808075, gen p mean: -0.2508791983127594, mean p set: 0.4486541748046875
loss_pred:0.01610967516899109, decouple_loss:0.0036422996781766415
2023-04-26 19:36:51 testing...
The modified gen p mean: 0.44822022318840027, gen p mean: -0.24567094445228577, mean p set: 0.44879910349845886
loss_pred:0.01851401850581169, decouple_loss:0.0036594499833881855
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24855896830558777, mean p set: 0.4499112665653229
loss_pred:0.018713513389229774, decouple_loss:0.0037428471259772778
The modified gen p mean: 0.4492512345314026, gen p mean: -0.24857982993125916, mean p set: 0.4498290419578552
loss_pred:0.018101414665579796, decouple_loss:0.0036350993905216455
WV_1_PC_1_EH_0_PS_30, loss: 0.01862693950533867, avg_mse: 0.02742721326649189
current test mse: 0.027427
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481991231441498, gen p mean: -0.2501784563064575, mean p set: 0.4487214982509613
loss_pred:0.016564833000302315, decouple_loss:0.0035479748621582985
The modified gen p mean: 0.4491499066352844, gen p mean: -0.2505093216896057, mean p set: 0.4497232735157013
loss_pred:0.01589442417025566, decouple_loss:0.0038090560119599104
The modified gen p mean: 0.4467547535896301, gen p mean: -0.2514132857322693, mean p set: 0.4473358392715454
loss_pred:0.015936970710754395, decouple_loss:0.0036691203713417053
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736844301223755, gen p mean: -0.2478514015674591, mean p set: 0.4479025602340698
loss_pred:0.01576639898121357, decouple_loss:0.0034327679313719273
The modified gen p mean: 0.4484214186668396, gen p mean: -0.24288304150104523, mean p set: 0.44900330901145935The modified gen p mean: 0.4500609338283539, gen p mean: -0.2441699355840683, mean p set: 0.4506426155567169
loss_pred:0.015745796263217926, decouple_loss:0.0034929062239825726
loss_pred:0.015854185447096825, decouple_loss:0.003844175487756729
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795894622802734, gen p mean: -0.23940889537334442, mean p set: 0.4484834671020508
loss_pred:0.016036922112107277, decouple_loss:0.003561555640771985
The modified gen p mean: 0.44768521189689636, gen p mean: -0.24339216947555542, mean p set: 0.4482649564743042The modified gen p mean: 0.4474967420101166, gen p mean: -0.24795691668987274, mean p set: 0.4480707347393036
loss_pred:0.01608414389193058, decouple_loss:0.0036198210436850786
loss_pred:0.017116185277700424, decouple_loss:0.0038324915803968906
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698742032051086, gen p mean: -0.246806338429451, mean p set: 0.44750893115997314
loss_pred:0.015827564522624016, decouple_loss:0.003438565880060196
The modified gen p mean: 0.44758176803588867, gen p mean: -0.24116069078445435, mean p set: 0.4481564164161682The modified gen p mean: 0.44833844900131226, gen p mean: -0.24001780152320862, mean p set: 0.4489106833934784
loss_pred:0.015926236286759377, decouple_loss:0.0034755105152726173
loss_pred:0.016285058110952377, decouple_loss:0.0038601155392825603
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753605127334595, gen p mean: -0.24559785425662994, mean p set: 0.4481089115142822
loss_pred:0.016550373286008835, decouple_loss:0.003983871079981327
The modified gen p mean: 0.4487265348434448, gen p mean: -0.2453087717294693, mean p set: 0.44929543137550354
loss_pred:0.01596839167177677, decouple_loss:0.00380949885584414
The modified gen p mean: 0.4478868842124939, gen p mean: -0.24202097952365875, mean p set: 0.44841471314430237
loss_pred:0.016399763524532318, decouple_loss:0.0033866302110254765
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467819333076477, gen p mean: -0.25205084681510925, mean p set: 0.447309285402298
loss_pred:0.015648599714040756, decouple_loss:0.0035430341958999634
The modified gen p mean: 0.44604557752609253, gen p mean: -0.24911029636859894, mean p set: 0.4466237425804138
loss_pred:0.01617594063282013, decouple_loss:0.0037026468198746443
The modified gen p mean: 0.44797641038894653, gen p mean: -0.2488892525434494, mean p set: 0.4485537111759186
loss_pred:0.017212938517332077, decouple_loss:0.0036150971427559853
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460836350917816, gen p mean: -0.24403508007526398, mean p set: 0.44665804505348206
loss_pred:0.01569543592631817, decouple_loss:0.0036030563060194254
The modified gen p mean: 0.44744443893432617, gen p mean: -0.2463008463382721, mean p set: 0.4480155408382416
loss_pred:0.017580555751919746, decouple_loss:0.003604223020374775
The modified gen p mean: 0.4470052719116211, gen p mean: -0.2493804544210434, mean p set: 0.4475356340408325
loss_pred:0.01571514457464218, decouple_loss:0.003634711494669318
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484430253505707, gen p mean: -0.24791742861270905, mean p set: 0.4490198791027069
loss_pred:0.016208358108997345, decouple_loss:0.0034565823152661324
The modified gen p mean: 0.446818083524704, gen p mean: -0.24656495451927185, mean p set: 0.4473958909511566
loss_pred:0.016139883548021317, decouple_loss:0.003372605424374342
The modified gen p mean: 0.44779494404792786, gen p mean: -0.2504192888736725, mean p set: 0.4483180344104767
loss_pred:0.016826147213578224, decouple_loss:0.003526396118104458
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468006491661072, gen p mean: -0.245394766330719, mean p set: 0.447368323802948
loss_pred:0.01622442714869976, decouple_loss:0.003415583400055766
The modified gen p mean: 0.4481157064437866, gen p mean: -0.24326933920383453, mean p set: 0.44869574904441833
loss_pred:0.016278520226478577, decouple_loss:0.003758467035368085
The modified gen p mean: 0.44636568427085876, gen p mean: -0.24750873446464539, mean p set: 0.4468948543071747
loss_pred:0.01572353020310402, decouple_loss:0.0034527063835412264
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482744038105011, gen p mean: -0.24754662811756134, mean p set: 0.4488431215286255
loss_pred:0.015596974641084671, decouple_loss:0.003690259763970971
The modified gen p mean: 0.4479897916316986, gen p mean: -0.24952319264411926, mean p set: 0.4485693573951721
loss_pred:0.015428237617015839, decouple_loss:0.003278841031715274
The modified gen p mean: 0.44695618748664856, gen p mean: -0.2513713836669922, mean p set: 0.4474853575229645
loss_pred:0.015513492748141289, decouple_loss:0.003241980914026499
2023-04-26 19:41:09 testing...
The modified gen p mean: 0.448228120803833, gen p mean: -0.24763868749141693, mean p set: 0.44879910349845886
loss_pred:0.01819051429629326, decouple_loss:0.0034222144167870283
The modified gen p mean: 0.4494309723377228, gen p mean: -0.2503059506416321, mean p set: 0.4499112665653229
loss_pred:0.01850234530866146, decouple_loss:0.00356692704372108
The modified gen p mean: 0.4492533504962921, gen p mean: -0.2502831220626831, mean p set: 0.4498290419578552
loss_pred:0.017843369394540787, decouple_loss:0.0034120355267077684
WV_1_PC_1_EH_0_PS_30, loss: 0.018352095037698746, avg_mse: 0.027005581185221672
current test mse: 0.027006
At step 190, Best test: 0.027006
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44887134432792664, gen p mean: -0.2509988248348236, mean p set: 0.44939976930618286
loss_pred:0.01603945903480053, decouple_loss:0.003957443404942751
The modified gen p mean: 0.4481428265571594, gen p mean: -0.25022202730178833, mean p set: 0.44871997833251953
loss_pred:0.01563657820224762, decouple_loss:0.0032744347117841244
The modified gen p mean: 0.4466855525970459, gen p mean: -0.24738486111164093, mean p set: 0.44726231694221497
loss_pred:0.016802022233605385, decouple_loss:0.0032825772650539875
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702327251434326, gen p mean: -0.2507667541503906, mean p set: 0.44755110144615173
loss_pred:0.016389956697821617, decouple_loss:0.0034426702186465263
The modified gen p mean: 0.44731006026268005, gen p mean: -0.25210869312286377, mean p set: 0.4478845000267029
loss_pred:0.015415848232805729, decouple_loss:0.003545696847140789
The modified gen p mean: 0.4457869827747345, gen p mean: -0.24962401390075684, mean p set: 0.44636374711990356
loss_pred:0.015586878173053265, decouple_loss:0.003480859799310565
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938716292381287, gen p mean: -0.2502572238445282, mean p set: 0.4499242305755615
loss_pred:0.015796644613146782, decouple_loss:0.0035480009391903877
The modified gen p mean: 0.44945886731147766, gen p mean: -0.2496064454317093, mean p set: 0.4500364065170288
loss_pred:0.01560972910374403, decouple_loss:0.0033168657682836056
The modified gen p mean: 0.447153240442276, gen p mean: -0.2484448403120041, mean p set: 0.4477330446243286
loss_pred:0.015955859795212746, decouple_loss:0.003325437195599079
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965288043022156, gen p mean: -0.2480003833770752, mean p set: 0.45018208026885986
loss_pred:0.0146819818764925, decouple_loss:0.0032582541462033987
The modified gen p mean: 0.44748392701148987, gen p mean: -0.24908281862735748, mean p set: 0.4480571746826172
loss_pred:0.016084520146250725, decouple_loss:0.003293482353910804
The modified gen p mean: 0.44762372970581055, gen p mean: -0.2461669147014618, mean p set: 0.44819900393486023
loss_pred:0.01581985503435135, decouple_loss:0.0032041624654084444
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477938115596771, gen p mean: -0.24693147838115692, mean p set: 0.44832107424736023
loss_pred:0.016559025272727013, decouple_loss:0.0035072395112365484
The modified gen p mean: 0.44707292318344116, gen p mean: -0.24531245231628418, mean p set: 0.4476448595523834
loss_pred:0.01611466519534588, decouple_loss:0.0031140658538788557
The modified gen p mean: 0.4481573700904846, gen p mean: -0.24596767127513885, mean p set: 0.4487282633781433
loss_pred:0.015939760953187943, decouple_loss:0.0032389252446591854
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44894808530807495, gen p mean: -0.25199130177497864, mean p set: 0.44952166080474854
loss_pred:0.015603172592818737, decouple_loss:0.0034126073587685823
The modified gen p mean: 0.44655245542526245, gen p mean: -0.25030818581581116, mean p set: 0.4471263289451599
loss_pred:0.015306959860026836, decouple_loss:0.003262196434661746
The modified gen p mean: 0.4481750726699829, gen p mean: -0.24611307680606842, mean p set: 0.4486992359161377
loss_pred:0.016454001888632774, decouple_loss:0.0036405897699296474
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478515088558197, gen p mean: -0.24975678324699402, mean p set: 0.44843170046806335
loss_pred:0.015565607696771622, decouple_loss:0.003122432390227914
The modified gen p mean: 0.4480331242084503, gen p mean: -0.2489979863166809, mean p set: 0.44860541820526123
loss_pred:0.01624731905758381, decouple_loss:0.003138213651254773
The modified gen p mean: 0.4491371214389801, gen p mean: -0.2537926435470581, mean p set: 0.449665904045105
loss_pred:0.015014821663498878, decouple_loss:0.0031008790247142315
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476160705089569, gen p mean: -0.24373549222946167, mean p set: 0.4481905400753021
loss_pred:0.016474949195981026, decouple_loss:0.0032819362822920084
The modified gen p mean: 0.4479368329048157, gen p mean: -0.24713699519634247, mean p set: 0.4485156238079071
loss_pred:0.015367429703474045, decouple_loss:0.003540517995133996
The modified gen p mean: 0.44708359241485596, gen p mean: -0.2491655945777893, mean p set: 0.4476125240325928
loss_pred:0.016029514372348785, decouple_loss:0.0031342359725385904
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482277035713196, gen p mean: -0.2491571307182312, mean p set: 0.4488097131252289
loss_pred:0.016103023663163185, decouple_loss:0.003066847799345851
The modified gen p mean: 0.4482955038547516, gen p mean: -0.24727840721607208, mean p set: 0.4488748610019684The modified gen p mean: 0.4465812146663666, gen p mean: -0.2474677860736847, mean p set: 0.447110116481781
loss_pred:0.016431117430329323, decouple_loss:0.0034229743760079145
loss_pred:0.016775257885456085, decouple_loss:0.0031854594126343727
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499910771846771, gen p mean: -0.25188982486724854, mean p set: 0.4505683481693268
loss_pred:0.015194596722722054, decouple_loss:0.003263967577368021
The modified gen p mean: 0.44767287373542786, gen p mean: -0.25410059094429016, mean p set: 0.4482479691505432
loss_pred:0.016273196786642075, decouple_loss:0.003274898510426283
The modified gen p mean: 0.44852402806282043, gen p mean: -0.25385937094688416, mean p set: 0.44904476404190063
loss_pred:0.016323009505867958, decouple_loss:0.003231597365811467
2023-04-26 19:44:41 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2500782310962677, mean p set: 0.4499112665653229
loss_pred:0.0184030681848526, decouple_loss:0.0032653731759637594
The modified gen p mean: 0.44822728633880615, gen p mean: -0.24676285684108734, mean p set: 0.44879910349845886
The modified gen p mean: 0.44926196336746216, gen p mean: -0.24939678609371185, mean p set: 0.4498290419578552
loss_pred:0.018133090808987617, decouple_loss:0.003099879017099738
loss_pred:0.017847105860710144, decouple_loss:0.003277348354458809
WV_1_PC_1_EH_0_PS_30, loss: 0.018288467079401016, avg_mse: 0.02690613828599453
current test mse: 0.026906
At step 200, Best test: 0.026906
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854989647865295, gen p mean: -0.25122612714767456, mean p set: 0.44907715916633606
loss_pred:0.015992362052202225, decouple_loss:0.0031439997255802155
The modified gen p mean: 0.4467128813266754, gen p mean: -0.2464662492275238, mean p set: 0.44729292392730713
loss_pred:0.016713418066501617, decouple_loss:0.003185997949913144
The modified gen p mean: 0.4466116726398468, gen p mean: -0.24914845824241638, mean p set: 0.44717955589294434
loss_pred:0.01617642492055893, decouple_loss:0.0032806519884616137
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448985755443573, gen p mean: -0.24998752772808075, mean p set: 0.4495137631893158
loss_pred:0.01603849232196808, decouple_loss:0.0032564981374889612
The modified gen p mean: 0.4469236135482788, gen p mean: -0.25180429220199585, mean p set: 0.4474954903125763
loss_pred:0.016373828053474426, decouple_loss:0.0030910884961485863
The modified gen p mean: 0.4458857476711273, gen p mean: -0.2547759413719177, mean p set: 0.446456640958786
loss_pred:0.016182618215680122, decouple_loss:0.0032393471337854862
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475041925907135, gen p mean: -0.2555047273635864, mean p set: 0.44802701473236084
loss_pred:0.014926113188266754, decouple_loss:0.0035616043023765087
The modified gen p mean: 0.4478132426738739, gen p mean: -0.25431594252586365, mean p set: 0.44838783144950867
loss_pred:0.016179271042346954, decouple_loss:0.003370155580341816
The modified gen p mean: 0.4468848705291748, gen p mean: -0.2516104578971863, mean p set: 0.4474574029445648
loss_pred:0.016241423785686493, decouple_loss:0.0033778436481952667
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740569591522217, gen p mean: -0.25540316104888916, mean p set: 0.44793781638145447
loss_pred:0.017039036378264427, decouple_loss:0.0037540094926953316
The modified gen p mean: 0.44682174921035767, gen p mean: -0.2533777058124542, mean p set: 0.44739776849746704
loss_pred:0.016083868220448494, decouple_loss:0.003268998581916094
The modified gen p mean: 0.4471166729927063, gen p mean: -0.25677767395973206, mean p set: 0.44769522547721863
loss_pred:0.01620347797870636, decouple_loss:0.0032115771900862455
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625043869018555, gen p mean: -0.2564677894115448, mean p set: 0.4467789828777313
loss_pred:0.016306407749652863, decouple_loss:0.0031209152657538652
The modified gen p mean: 0.44735151529312134, gen p mean: -0.25725752115249634, mean p set: 0.4479331374168396
loss_pred:0.016218123957514763, decouple_loss:0.0034566596150398254
The modified gen p mean: 0.44664329290390015, gen p mean: -0.2527644634246826, mean p set: 0.44721704721450806
loss_pred:0.015732254832983017, decouple_loss:0.003211266826838255
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468715786933899, gen p mean: -0.25141236186027527, mean p set: 0.44744551181793213
loss_pred:0.016278555616736412, decouple_loss:0.0031909483950585127
The modified gen p mean: 0.44750872254371643, gen p mean: -0.25893720984458923, mean p set: 0.44808200001716614The modified gen p mean: 0.4470597505569458, gen p mean: -0.2560916244983673, mean p set: 0.44758957624435425
loss_pred:0.015038993209600449, decouple_loss:0.0033342570532113314
loss_pred:0.016511179506778717, decouple_loss:0.0031709298491477966
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790953397750854, gen p mean: -0.25573861598968506, mean p set: 0.44844114780426025
loss_pred:0.016150038689374924, decouple_loss:0.0034294803626835346
The modified gen p mean: 0.446136474609375, gen p mean: -0.253665953874588, mean p set: 0.4467063546180725
loss_pred:0.01652592420578003, decouple_loss:0.0032790289260447025
The modified gen p mean: 0.4465835392475128, gen p mean: -0.25356438755989075, mean p set: 0.44716206192970276
loss_pred:0.01678067445755005, decouple_loss:0.0034784451127052307
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471234083175659, gen p mean: -0.2518883943557739, mean p set: 0.4477007985115051
loss_pred:0.016521301120519638, decouple_loss:0.0034682464320212603
The modified gen p mean: 0.4457501173019409, gen p mean: -0.25003287196159363, mean p set: 0.4463306665420532
loss_pred:0.016501177102327347, decouple_loss:0.003439804306253791
The modified gen p mean: 0.44492918252944946, gen p mean: -0.25392138957977295, mean p set: 0.4454576373100281
loss_pred:0.016393890604376793, decouple_loss:0.003708793083205819
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818779826164246, gen p mean: -0.24494294822216034, mean p set: 0.44876447319984436
loss_pred:0.015724502503871918, decouple_loss:0.0037226821295917034
The modified gen p mean: 0.44622334837913513, gen p mean: -0.2460373193025589, mean p set: 0.44680383801460266
loss_pred:0.016293663531541824, decouple_loss:0.0034767561592161655
The modified gen p mean: 0.4465065598487854, gen p mean: -0.24718758463859558, mean p set: 0.4470267593860626
loss_pred:0.01621161215007305, decouple_loss:0.003626501187682152
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463512599468231, gen p mean: -0.25154000520706177, mean p set: 0.4469318985939026
loss_pred:0.016560129821300507, decouple_loss:0.0035682159941643476
The modified gen p mean: 0.4463619291782379, gen p mean: -0.25084730982780457, mean p set: 0.44694095849990845The modified gen p mean: 0.44808584451675415, gen p mean: -0.2509610056877136, mean p set: 0.44861549139022827
loss_pred:0.016930608078837395, decouple_loss:0.003562004305422306
loss_pred:0.016314366832375526, decouple_loss:0.003390285884961486
2023-04-26 19:49:07 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2563987672328949, mean p set: 0.4499112665653229
loss_pred:0.018444422632455826, decouple_loss:0.003963442984968424
The modified gen p mean: 0.4482213258743286, gen p mean: -0.253314733505249, mean p set: 0.44879910349845886
loss_pred:0.01821538619697094, decouple_loss:0.00401178328320384
The modified gen p mean: 0.449245423078537, gen p mean: -0.2560042440891266, mean p set: 0.4498290419578552
loss_pred:0.01799003966152668, decouple_loss:0.003869993845000863
WV_1_PC_1_EH_0_PS_30, loss: 0.018414035439491272, avg_mse: 0.02709035575389862
current test mse: 0.02709
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471099376678467, gen p mean: -0.25685474276542664, mean p set: 0.4476804733276367
loss_pred:0.016807742416858673, decouple_loss:0.003814991330727935
The modified gen p mean: 0.44717609882354736, gen p mean: -0.2497285157442093, mean p set: 0.4477542042732239
loss_pred:0.016630178317427635, decouple_loss:0.0038133966736495495
The modified gen p mean: 0.4477875530719757, gen p mean: -0.2542596161365509, mean p set: 0.44831427931785583
loss_pred:0.01619306020438671, decouple_loss:0.003895380301401019
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483466148376465, gen p mean: -0.2586703598499298, mean p set: 0.448881059885025
loss_pred:0.015925467014312744, decouple_loss:0.003404952585697174
The modified gen p mean: 0.4477667808532715, gen p mean: -0.25496554374694824, mean p set: 0.44834378361701965The modified gen p mean: 0.44658270478248596, gen p mean: -0.2578737139701843, mean p set: 0.44716131687164307
loss_pred:0.015683675184845924, decouple_loss:0.0032239235006272793
loss_pred:0.01650504395365715, decouple_loss:0.0031436553690582514
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458237290382385, gen p mean: -0.2558298707008362, mean p set: 0.44635844230651855
loss_pred:0.016122186556458473, decouple_loss:0.004273037891834974
The modified gen p mean: 0.4471386671066284, gen p mean: -0.2550082206726074, mean p set: 0.44771286845207214The modified gen p mean: 0.445481538772583, gen p mean: -0.25590845942497253, mean p set: 0.4460590183734894
loss_pred:0.01573917269706726, decouple_loss:0.004139144439250231
loss_pred:0.016299251466989517, decouple_loss:0.00444793188944459
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454552233219147, gen p mean: -0.2622126042842865, mean p set: 0.44598105549812317
loss_pred:0.015939638018608093, decouple_loss:0.00337552884593606
The modified gen p mean: 0.44683757424354553, gen p mean: -0.25506001710891724, mean p set: 0.44741740822792053The modified gen p mean: 0.44800278544425964, gen p mean: -0.2591315507888794, mean p set: 0.44858217239379883
loss_pred:0.015909871086478233, decouple_loss:0.0033117991406470537loss_pred:0.01704069972038269, decouple_loss:0.0033788708969950676
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447623074054718, gen p mean: -0.2578592896461487, mean p set: 0.4481981694698334
loss_pred:0.016751769930124283, decouple_loss:0.004424109123647213
The modified gen p mean: 0.44491952657699585, gen p mean: -0.26066216826438904, mean p set: 0.44549062848091125The modified gen p mean: 0.44655948877334595, gen p mean: -0.25725170969963074, mean p set: 0.44708412885665894
loss_pred:0.015970954671502113, decouple_loss:0.00417152838781476
loss_pred:0.01641576923429966, decouple_loss:0.004311197903007269
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474351704120636, gen p mean: -0.24121439456939697, mean p set: 0.448009192943573
loss_pred:0.01646951027214527, decouple_loss:0.0036060085985809565
The modified gen p mean: 0.44782692193984985, gen p mean: -0.24897649884223938, mean p set: 0.4483581483364105The modified gen p mean: 0.44731295108795166, gen p mean: -0.2482866644859314, mean p set: 0.4478902518749237
loss_pred:0.016543462872505188, decouple_loss:0.0034830616787075996
loss_pred:0.015352592803537846, decouple_loss:0.0035998790990561247
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777607917785645, gen p mean: -0.24756844341754913, mean p set: 0.4483422338962555
loss_pred:0.015955151990056038, decouple_loss:0.004155374597758055
The modified gen p mean: 0.44643035531044006, gen p mean: -0.24857623875141144, mean p set: 0.44696754217147827The modified gen p mean: 0.4465301036834717, gen p mean: -0.24406957626342773, mean p set: 0.44710773229599
loss_pred:0.016291901469230652, decouple_loss:0.004444795195013285
loss_pred:0.015132955275475979, decouple_loss:0.004618257284164429
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476343095302582, gen p mean: -0.24050559103488922, mean p set: 0.448209285736084
loss_pred:0.015701280906796455, decouple_loss:0.003667602315545082
The modified gen p mean: 0.44703835248947144, gen p mean: -0.24150778353214264, mean p set: 0.4476129114627838
loss_pred:0.016732485964894295, decouple_loss:0.003948839846998453
The modified gen p mean: 0.44656646251678467, gen p mean: -0.24547085165977478, mean p set: 0.4470905363559723
loss_pred:0.015978386625647545, decouple_loss:0.003755694953724742
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460127055644989, gen p mean: -0.23871205747127533, mean p set: 0.4465861916542053
loss_pred:0.016014449298381805, decouple_loss:0.0038773200940340757
The modified gen p mean: 0.4471818506717682, gen p mean: -0.23740236461162567, mean p set: 0.44775307178497314
loss_pred:0.015009512193500996, decouple_loss:0.004242855589836836
The modified gen p mean: 0.4484982490539551, gen p mean: -0.23258164525032043, mean p set: 0.4490286707878113
loss_pred:0.016663068905472755, decouple_loss:0.003938114736229181
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457095265388489, gen p mean: -0.2368089109659195, mean p set: 0.4462839961051941
loss_pred:0.015852870419621468, decouple_loss:0.0033799922093749046
The modified gen p mean: 0.44622108340263367, gen p mean: -0.23771724104881287, mean p set: 0.446748286485672The modified gen p mean: 0.4463314116001129, gen p mean: -0.23239804804325104, mean p set: 0.44690370559692383
loss_pred:0.015949061140418053, decouple_loss:0.0036662458442151546
loss_pred:0.016460813581943512, decouple_loss:0.0035655631218105555
2023-04-26 19:52:33 testing...
The modified gen p mean: 0.44822296500205994, gen p mean: -0.24151837825775146, mean p set: 0.44879910349845886
loss_pred:0.018375977873802185, decouple_loss:0.003862349782139063
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24479395151138306, mean p set: 0.4499112665653229
loss_pred:0.018493756651878357, decouple_loss:0.003665517084300518
The modified gen p mean: 0.449245810508728, gen p mean: -0.2440635710954666, mean p set: 0.4498290419578552
loss_pred:0.018029434606432915, decouple_loss:0.0038652438670396805
WV_1_PC_1_EH_0_PS_30, loss: 0.01848961040377617, avg_mse: 0.027140073478221893
current test mse: 0.02714
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491582214832306, gen p mean: -0.24673154950141907, mean p set: 0.449685275554657
loss_pred:0.016317546367645264, decouple_loss:0.003607279621064663
The modified gen p mean: 0.4477608799934387, gen p mean: -0.2424919158220291, mean p set: 0.4483354985713959
loss_pred:0.01630319282412529, decouple_loss:0.0034922664053738117
The modified gen p mean: 0.44709232449531555, gen p mean: -0.24229103326797485, mean p set: 0.4476754069328308
loss_pred:0.01600758172571659, decouple_loss:0.003572324989363551
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799375534057617, gen p mean: -0.25477027893066406, mean p set: 0.4485251009464264
loss_pred:0.017028821632266045, decouple_loss:0.003381905844435096
The modified gen p mean: 0.4485394358634949, gen p mean: -0.25315573811531067, mean p set: 0.4491156041622162
loss_pred:0.016260534524917603, decouple_loss:0.003293917514383793
The modified gen p mean: 0.4486248195171356, gen p mean: -0.25121191143989563, mean p set: 0.4492001235485077
loss_pred:0.015717823058366776, decouple_loss:0.0034193142782896757
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485737085342407, gen p mean: -0.25295859575271606, mean p set: 0.44910410046577454
loss_pred:0.01650765910744667, decouple_loss:0.0035446309484541416
The modified gen p mean: 0.4489281475543976, gen p mean: -0.2522472143173218, mean p set: 0.44951245188713074
loss_pred:0.01558702252805233, decouple_loss:0.003915740177035332
The modified gen p mean: 0.4484924376010895, gen p mean: -0.25621548295021057, mean p set: 0.44906941056251526
loss_pred:0.016238223761320114, decouple_loss:0.0032738090958446264
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480362832546234, gen p mean: -0.2556447982788086, mean p set: 0.44856706261634827
loss_pred:0.016228685155510902, decouple_loss:0.0036040381528437138
The modified gen p mean: 0.44820278882980347, gen p mean: -0.25650736689567566, mean p set: 0.4487766921520233
loss_pred:0.01605292782187462, decouple_loss:0.0036665531806647778
The modified gen p mean: 0.449455201625824, gen p mean: -0.2611319422721863, mean p set: 0.45003825426101685
loss_pred:0.01605507731437683, decouple_loss:0.0037246847059577703
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485408663749695, gen p mean: -0.2542637586593628, mean p set: 0.44911760091781616
loss_pred:0.016118988394737244, decouple_loss:0.0035188256297260523
The modified gen p mean: 0.4483782947063446, gen p mean: -0.2581830620765686, mean p set: 0.44895440340042114The modified gen p mean: 0.44800591468811035, gen p mean: -0.2549871802330017, mean p set: 0.44853806495666504
loss_pred:0.015738582238554955, decouple_loss:0.0034568586852401495
loss_pred:0.015790093690156937, decouple_loss:0.003335328074172139
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448848158121109, gen p mean: -0.24709641933441162, mean p set: 0.4494262933731079
loss_pred:0.01655060425400734, decouple_loss:0.0038198295515030622
The modified gen p mean: 0.4473389685153961, gen p mean: -0.25158798694610596, mean p set: 0.4479115903377533The modified gen p mean: 0.4494961202144623, gen p mean: -0.2551548480987549, mean p set: 0.450029194355011
loss_pred:0.016071701422333717, decouple_loss:0.0036018986720591784
loss_pred:0.016268931329250336, decouple_loss:0.003437937470152974
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478940963745117, gen p mean: -0.2459024339914322, mean p set: 0.4484765827655792
loss_pred:0.01595739647746086, decouple_loss:0.003245929954573512
The modified gen p mean: 0.4480896294116974, gen p mean: -0.24706697463989258, mean p set: 0.44861912727355957The modified gen p mean: 0.44811245799064636, gen p mean: -0.24770808219909668, mean p set: 0.4486883282661438
loss_pred:0.016231883317232132, decouple_loss:0.003518638899549842
loss_pred:0.016242587938904762, decouple_loss:0.0035283807665109634
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486275315284729, gen p mean: -0.24425733089447021, mean p set: 0.4492073655128479
loss_pred:0.01537138968706131, decouple_loss:0.003378325840458274
The modified gen p mean: 0.44858309626579285, gen p mean: -0.24281442165374756, mean p set: 0.44910916686058044
loss_pred:0.01601584441959858, decouple_loss:0.003501300932839513
The modified gen p mean: 0.4465635120868683, gen p mean: -0.24411208927631378, mean p set: 0.44714176654815674
loss_pred:0.0162114966660738, decouple_loss:0.0031699759420007467
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846779108047485, gen p mean: -0.2453801929950714, mean p set: 0.4490397274494171
loss_pred:0.01615038886666298, decouple_loss:0.004031780641525984
The modified gen p mean: 0.4476523697376251, gen p mean: -0.24292610585689545, mean p set: 0.4482291042804718
loss_pred:0.01593889109790325, decouple_loss:0.0033679730258882046
The modified gen p mean: 0.4486602246761322, gen p mean: -0.24642221629619598, mean p set: 0.4491857588291168
loss_pred:0.016056301072239876, decouple_loss:0.0036833102349191904
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492364525794983, gen p mean: -0.244921013712883, mean p set: 0.44981372356414795
loss_pred:0.015448505990207195, decouple_loss:0.003334467066451907
The modified gen p mean: 0.44867080450057983, gen p mean: -0.24720463156700134, mean p set: 0.4492553174495697
loss_pred:0.016003232449293137, decouple_loss:0.003225313499569893
The modified gen p mean: 0.4481613039970398, gen p mean: -0.2456604242324829, mean p set: 0.4486922323703766
loss_pred:0.01628764346241951, decouple_loss:0.002909964881837368
2023-04-26 19:56:45 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2449909746646881, mean p set: 0.4499112665653229
loss_pred:0.01832674629986286, decouple_loss:0.003288781503215432
The modified gen p mean: 0.44822096824645996, gen p mean: -0.24166439473628998, mean p set: 0.44879910349845886
The modified gen p mean: 0.44924965500831604, gen p mean: -0.24443072080612183, mean p set: 0.4498290419578552
loss_pred:0.01811964251101017, decouple_loss:0.003271634690463543
loss_pred:0.017894424498081207, decouple_loss:0.003267610212787986
WV_1_PC_1_EH_0_PS_30, loss: 0.018277404829859734, avg_mse: 0.02692740224301815
current test mse: 0.026927
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449052095413208, gen p mean: -0.24690282344818115, mean p set: 0.4496248662471771
loss_pred:0.015950175002217293, decouple_loss:0.00324288010597229
The modified gen p mean: 0.44831061363220215, gen p mean: -0.2448296844959259, mean p set: 0.4488835632801056
loss_pred:0.015305250883102417, decouple_loss:0.0032994074281305075
The modified gen p mean: 0.4479142129421234, gen p mean: -0.24700620770454407, mean p set: 0.4484313726425171
loss_pred:0.016049763187766075, decouple_loss:0.0031639193184673786
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767633080482483, gen p mean: -0.2345726639032364, mean p set: 0.4482038617134094
loss_pred:0.01591118797659874, decouple_loss:0.00345853203907609
The modified gen p mean: 0.4482412338256836, gen p mean: -0.2378987967967987, mean p set: 0.4488137364387512
loss_pred:0.016026966273784637, decouple_loss:0.003782586194574833
The modified gen p mean: 0.44879648089408875, gen p mean: -0.24266384541988373, mean p set: 0.44937053322792053
loss_pred:0.016184916719794273, decouple_loss:0.0033817747607827187
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481895864009857, gen p mean: -0.23936204612255096, mean p set: 0.44871124625205994
loss_pred:0.01575910672545433, decouple_loss:0.0031835937406867743
The modified gen p mean: 0.448477566242218, gen p mean: -0.24346071481704712, mean p set: 0.4490547776222229
loss_pred:0.015740495175123215, decouple_loss:0.003226818051189184
The modified gen p mean: 0.4472945034503937, gen p mean: -0.23602068424224854, mean p set: 0.447873055934906
loss_pred:0.015870122238993645, decouple_loss:0.003192634554579854
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483399987220764, gen p mean: -0.245134636759758, mean p set: 0.44887199997901917
loss_pred:0.016122745350003242, decouple_loss:0.003088857512921095
The modified gen p mean: 0.44866788387298584, gen p mean: -0.24517953395843506, mean p set: 0.44924765825271606
loss_pred:0.015623259358108044, decouple_loss:0.0031250149477273226
The modified gen p mean: 0.4493759870529175, gen p mean: -0.23910515010356903, mean p set: 0.44995051622390747
loss_pred:0.015912555158138275, decouple_loss:0.003315071342512965
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471546709537506, gen p mean: -0.23838748037815094, mean p set: 0.4477364122867584
loss_pred:0.016109606251120567, decouple_loss:0.003374276449903846
The modified gen p mean: 0.44778352975845337, gen p mean: -0.2352447658777237, mean p set: 0.4483604431152344The modified gen p mean: 0.4487766921520233, gen p mean: -0.24260850250720978, mean p set: 0.44930675625801086
loss_pred:0.015793221071362495, decouple_loss:0.0032141886185854673
loss_pred:0.016007758677005768, decouple_loss:0.0032679825089871883
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742220640182495, gen p mean: -0.23889175057411194, mean p set: 0.4479973018169403
loss_pred:0.01607925072312355, decouple_loss:0.003094644518569112
The modified gen p mean: 0.44630521535873413, gen p mean: -0.24083171784877777, mean p set: 0.44683340191841125The modified gen p mean: 0.44798383116722107, gen p mean: -0.2398458570241928, mean p set: 0.44855865836143494
loss_pred:0.016146495938301086, decouple_loss:0.0030653022695332766
loss_pred:0.016366101801395416, decouple_loss:0.003144920337945223
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888705015182495, gen p mean: -0.24382656812667847, mean p set: 0.4494645595550537
loss_pred:0.01593034900724888, decouple_loss:0.003102510701864958
The modified gen p mean: 0.4475148618221283, gen p mean: -0.2458771914243698, mean p set: 0.44804278016090393The modified gen p mean: 0.44867128133773804, gen p mean: -0.24447683990001678, mean p set: 0.44925105571746826
loss_pred:0.0160411074757576, decouple_loss:0.003443287219852209
loss_pred:0.01630053110420704, decouple_loss:0.003122318536043167
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728073477745056, gen p mean: -0.24724717438220978, mean p set: 0.44785305857658386
loss_pred:0.016051549464464188, decouple_loss:0.0030038701370358467
The modified gen p mean: 0.44767314195632935, gen p mean: -0.24275805056095123, mean p set: 0.4482443630695343
loss_pred:0.016254210844635963, decouple_loss:0.002890845062211156
The modified gen p mean: 0.4486466944217682, gen p mean: -0.24621190130710602, mean p set: 0.44916975498199463
loss_pred:0.016397625207901, decouple_loss:0.0028767616022378206
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484044313430786, gen p mean: -0.24813711643218994, mean p set: 0.44898921251296997
loss_pred:0.015339694917201996, decouple_loss:0.0029076377395540476
The modified gen p mean: 0.4486503601074219, gen p mean: -0.2442353218793869, mean p set: 0.4492258131504059
loss_pred:0.01572841964662075, decouple_loss:0.0030147486831992865
The modified gen p mean: 0.4475371539592743, gen p mean: -0.2388565093278885, mean p set: 0.4480650722980499
loss_pred:0.015635838732123375, decouple_loss:0.0032735192216932774
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791075587272644, gen p mean: -0.24176134169101715, mean p set: 0.4484924077987671
loss_pred:0.015971213579177856, decouple_loss:0.0034360247664153576
The modified gen p mean: 0.44814807176589966, gen p mean: -0.2438170611858368, mean p set: 0.4486764669418335The modified gen p mean: 0.44858887791633606, gen p mean: -0.24114100635051727, mean p set: 0.44917428493499756
loss_pred:0.015424341894686222, decouple_loss:0.0033239314798265696
loss_pred:0.015392865985631943, decouple_loss:0.0032878476195037365
2023-04-26 20:00:11 testing...
The modified gen p mean: 0.4482281804084778, gen p mean: -0.24020341038703918, mean p set: 0.44879910349845886
loss_pred:0.018166253343224525, decouple_loss:0.0035677668638527393
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24332395195960999, mean p set: 0.4499112665653229
loss_pred:0.018432730808854103, decouple_loss:0.003824346698820591
The modified gen p mean: 0.4492563307285309, gen p mean: -0.24291428923606873, mean p set: 0.4498290419578552
loss_pred:0.01789604127407074, decouple_loss:0.003689476288855076
WV_1_PC_1_EH_0_PS_30, loss: 0.018349703401327133, avg_mse: 0.027009138837456703
current test mse: 0.027009
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880011677742004, gen p mean: -0.24878205358982086, mean p set: 0.44932815432548523
loss_pred:0.015591607429087162, decouple_loss:0.0033540844451636076
The modified gen p mean: 0.44796091318130493, gen p mean: -0.2372743785381317, mean p set: 0.4485420286655426
loss_pred:0.01591838151216507, decouple_loss:0.0033546858467161655
The modified gen p mean: 0.4478641450405121, gen p mean: -0.24036817252635956, mean p set: 0.44843941926956177
loss_pred:0.015587172470986843, decouple_loss:0.0033267545513808727
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828909635543823, gen p mean: -0.2405828833580017, mean p set: 0.44881969690322876
loss_pred:0.01650083065032959, decouple_loss:0.003246803767979145
The modified gen p mean: 0.44837120175361633, gen p mean: -0.2362907975912094, mean p set: 0.44894805550575256
loss_pred:0.01624170131981373, decouple_loss:0.003271497320383787
The modified gen p mean: 0.4471587538719177, gen p mean: -0.24312525987625122, mean p set: 0.4477364122867584
loss_pred:0.015834415331482887, decouple_loss:0.003465611720457673
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477044939994812, gen p mean: -0.2389918863773346, mean p set: 0.448231041431427
loss_pred:0.01592598482966423, decouple_loss:0.0035553097259253263
The modified gen p mean: 0.44883617758750916, gen p mean: -0.24934512376785278, mean p set: 0.4494134187698364
loss_pred:0.015317945741117, decouple_loss:0.003274187445640564
The modified gen p mean: 0.4468042552471161, gen p mean: -0.24454964697360992, mean p set: 0.44738414883613586
loss_pred:0.01632842794060707, decouple_loss:0.00328638544306159
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488254189491272, gen p mean: -0.2477380931377411, mean p set: 0.44935348629951477
loss_pred:0.0159989595413208, decouple_loss:0.0032452696468681097
The modified gen p mean: 0.44811657071113586, gen p mean: -0.24516479671001434, mean p set: 0.44869375228881836The modified gen p mean: 0.4477706849575043, gen p mean: -0.24452413618564606, mean p set: 0.4483504593372345
loss_pred:0.015732834115624428, decouple_loss:0.0033139025326818228
loss_pred:0.015435760840773582, decouple_loss:0.0033733416348695755
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931620359420776, gen p mean: -0.24917487800121307, mean p set: 0.44984567165374756
loss_pred:0.015772664919495583, decouple_loss:0.003399536944925785
The modified gen p mean: 0.44752123951911926, gen p mean: -0.24593788385391235, mean p set: 0.4480955898761749
loss_pred:0.01623738743364811, decouple_loss:0.003499864134937525
The modified gen p mean: 0.447929322719574, gen p mean: -0.2483438402414322, mean p set: 0.448505699634552
loss_pred:0.015566916204988956, decouple_loss:0.0031666515860706568
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483506679534912, gen p mean: -0.24933311343193054, mean p set: 0.44892609119415283
loss_pred:0.015364231541752815, decouple_loss:0.003203807631507516
The modified gen p mean: 0.44670140743255615, gen p mean: -0.24886639416217804, mean p set: 0.44727620482444763The modified gen p mean: 0.44736966490745544, gen p mean: -0.24796026945114136, mean p set: 0.4478953182697296
loss_pred:0.016114093363285065, decouple_loss:0.003436343278735876
loss_pred:0.015517475083470345, decouple_loss:0.00322984391823411
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450476735830307, gen p mean: -0.2514967620372772, mean p set: 0.4510541558265686
loss_pred:0.015624887309968472, decouple_loss:0.003853705246001482
The modified gen p mean: 0.44754159450531006, gen p mean: -0.24448497593402863, mean p set: 0.4481230676174164
The modified gen p mean: 0.4481167197227478, gen p mean: -0.24413514137268066, mean p set: 0.448650062084198
loss_pred:0.015715207904577255, decouple_loss:0.003410806180909276
loss_pred:0.01564563438296318, decouple_loss:0.003366009332239628
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490717053413391, gen p mean: -0.2456381469964981, mean p set: 0.4496456980705261
loss_pred:0.015179993584752083, decouple_loss:0.003515926655381918
The modified gen p mean: 0.44823187589645386, gen p mean: -0.2435687929391861, mean p set: 0.44880932569503784
loss_pred:0.015887940302491188, decouple_loss:0.0031118278857320547
The modified gen p mean: 0.44817492365837097, gen p mean: -0.2504039704799652, mean p set: 0.4486970603466034
loss_pred:0.0160633847117424, decouple_loss:0.003321103285998106
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926854968070984, gen p mean: -0.24247759580612183, mean p set: 0.44984006881713867
loss_pred:0.016093602403998375, decouple_loss:0.003517611650750041
The modified gen p mean: 0.44806206226348877, gen p mean: -0.2395590990781784, mean p set: 0.44864022731781006
loss_pred:0.0159800685942173, decouple_loss:0.003569545689970255
The modified gen p mean: 0.4480929672718048, gen p mean: -0.24316127598285675, mean p set: 0.448621928691864
loss_pred:0.015927737578749657, decouple_loss:0.0034543985966593027
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480658173561096, gen p mean: -0.2526117265224457, mean p set: 0.4486437141895294
loss_pred:0.015543065033853054, decouple_loss:0.0033025627490133047
The modified gen p mean: 0.44929489493370056, gen p mean: -0.25222498178482056, mean p set: 0.4498688280582428The modified gen p mean: 0.44755107164382935, gen p mean: -0.246675044298172, mean p set: 0.4480842351913452
loss_pred:0.015312154777348042, decouple_loss:0.0034538046456873417
loss_pred:0.015346558764576912, decouple_loss:0.003436942817643285
2023-04-26 20:04:24 testing...
The modified gen p mean: 0.4482225775718689, gen p mean: -0.24424275755882263, mean p set: 0.44879910349845886
loss_pred:0.018398921936750412, decouple_loss:0.003562496043741703
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24746865034103394, mean p set: 0.4499112665653229
loss_pred:0.01847190409898758, decouple_loss:0.003751912619918585
The modified gen p mean: 0.44925352931022644, gen p mean: -0.24696312844753265, mean p set: 0.4498290419578552
loss_pred:0.017979595810174942, decouple_loss:0.0038083333056420088
WV_1_PC_1_EH_0_PS_30, loss: 0.01846885308623314, avg_mse: 0.027244530618190765
current test mse: 0.027245
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485391676425934, gen p mean: -0.24664950370788574, mean p set: 0.4491152763366699
loss_pred:0.015406394377350807, decouple_loss:0.003153923200443387
The modified gen p mean: 0.44814714789390564, gen p mean: -0.2472808063030243, mean p set: 0.44871968030929565
loss_pred:0.015146329998970032, decouple_loss:0.003156627994030714
The modified gen p mean: 0.44840574264526367, gen p mean: -0.24966101348400116, mean p set: 0.4489334523677826
loss_pred:0.015269987285137177, decouple_loss:0.0032381087075918913
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488319754600525, gen p mean: -0.24754008650779724, mean p set: 0.44937342405319214
loss_pred:0.015172140672802925, decouple_loss:0.0036649703979492188
The modified gen p mean: 0.4482846260070801, gen p mean: -0.24291908740997314, mean p set: 0.4488562345504761
loss_pred:0.015711506828665733, decouple_loss:0.0035860417410731316
The modified gen p mean: 0.4476524591445923, gen p mean: -0.23380538821220398, mean p set: 0.44823071360588074
loss_pred:0.015476913191378117, decouple_loss:0.0035987922456115484
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504495859146118, gen p mean: -0.24659967422485352, mean p set: 0.45098060369491577
loss_pred:0.015437474474310875, decouple_loss:0.003576891729608178
The modified gen p mean: 0.44964659214019775, gen p mean: -0.2397039830684662, mean p set: 0.4502216577529907The modified gen p mean: 0.44814741611480713, gen p mean: -0.24043326079845428, mean p set: 0.44872117042541504
loss_pred:0.016057515516877174, decouple_loss:0.0035030615981668234
loss_pred:0.016045164316892624, decouple_loss:0.0036055762320756912
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479738175868988, gen p mean: -0.24373690783977509, mean p set: 0.4484964609146118
loss_pred:0.015273116528987885, decouple_loss:0.003969022538512945
The modified gen p mean: 0.44672223925590515, gen p mean: -0.24200673401355743, mean p set: 0.44730088114738464
loss_pred:0.01565338857471943, decouple_loss:0.003581164637580514
The modified gen p mean: 0.4489355683326721, gen p mean: -0.23729319870471954, mean p set: 0.4495035707950592
loss_pred:0.015021421015262604, decouple_loss:0.004320347681641579
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448849081993103, gen p mean: -0.23920443654060364, mean p set: 0.4494239091873169
loss_pred:0.0147399278357625, decouple_loss:0.0037486818619072437
The modified gen p mean: 0.4489600658416748, gen p mean: -0.24230673909187317, mean p set: 0.449531614780426The modified gen p mean: 0.4489314556121826, gen p mean: -0.23982197046279907, mean p set: 0.4494667053222656
loss_pred:0.015736117959022522, decouple_loss:0.0036026467569172382
loss_pred:0.014963138848543167, decouple_loss:0.0038114360067993402
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447609543800354, gen p mean: -0.24743059277534485, mean p set: 0.4481446146965027
loss_pred:0.01650061085820198, decouple_loss:0.0033894628286361694
The modified gen p mean: 0.44837191700935364, gen p mean: -0.24416768550872803, mean p set: 0.4489465653896332
loss_pred:0.015344000421464443, decouple_loss:0.003298971801996231
The modified gen p mean: 0.44844678044319153, gen p mean: -0.2392881065607071, mean p set: 0.44902175664901733
loss_pred:0.015799060463905334, decouple_loss:0.003547843312844634
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485253393650055, gen p mean: -0.24217505753040314, mean p set: 0.44909510016441345
loss_pred:0.015477791428565979, decouple_loss:0.004162798635661602
The modified gen p mean: 0.44871389865875244, gen p mean: -0.25141438841819763, mean p set: 0.4492855668067932
loss_pred:0.015277638100087643, decouple_loss:0.0035443564411252737
The modified gen p mean: 0.4486753046512604, gen p mean: -0.24870812892913818, mean p set: 0.4492042660713196
loss_pred:0.01495488453656435, decouple_loss:0.003511273767799139
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473520815372467, gen p mean: -0.2445261925458908, mean p set: 0.4479316174983978
loss_pred:0.016099562868475914, decouple_loss:0.0034059062600135803
The modified gen p mean: 0.4476410448551178, gen p mean: -0.2406611293554306, mean p set: 0.4482152760028839
loss_pred:0.015618768520653248, decouple_loss:0.0034829890355467796
The modified gen p mean: 0.44848448038101196, gen p mean: -0.239996999502182, mean p set: 0.44901901483535767
loss_pred:0.015906764194369316, decouple_loss:0.0033142752945423126
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732943177223206, gen p mean: -0.23974348604679108, mean p set: 0.4479077458381653
loss_pred:0.015161216259002686, decouple_loss:0.003529852256178856
The modified gen p mean: 0.4471570551395416, gen p mean: -0.24258223176002502, mean p set: 0.4477311074733734
loss_pred:0.015652090311050415, decouple_loss:0.0035010981373488903
The modified gen p mean: 0.4483652412891388, gen p mean: -0.25096893310546875, mean p set: 0.44889357686042786
loss_pred:0.015326978638768196, decouple_loss:0.0035115336067974567
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693633913993835, gen p mean: -0.2479880303144455, mean p set: 0.4475100636482239
loss_pred:0.015272083692252636, decouple_loss:0.0031786938197910786
The modified gen p mean: 0.4480544328689575, gen p mean: -0.24957376718521118, mean p set: 0.44863688945770264
loss_pred:0.015092042274773121, decouple_loss:0.00308095570653677
The modified gen p mean: 0.448386013507843, gen p mean: -0.2526020109653473, mean p set: 0.44891637563705444
loss_pred:0.015460138209164143, decouple_loss:0.0029706349596381187
2023-04-26 20:07:52 testing...
The modified gen p mean: 0.4482245147228241, gen p mean: -0.24715270102024078, mean p set: 0.44879910349845886
loss_pred:0.018505508080124855, decouple_loss:0.003406334901228547
The modified gen p mean: 0.4494309723377228, gen p mean: -0.2500388026237488, mean p set: 0.4499112665653229
loss_pred:0.018466796725988388, decouple_loss:0.003397855209186673
The modified gen p mean: 0.44926267862319946, gen p mean: -0.24990688264369965, mean p set: 0.4498290419578552
loss_pred:0.018007030710577965, decouple_loss:0.003382326103746891
WV_1_PC_1_EH_0_PS_30, loss: 0.01849622093141079, avg_mse: 0.02730199135839939
current test mse: 0.027302
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829025864601135, gen p mean: -0.255519300699234, mean p set: 0.4488264322280884
loss_pred:0.015703389421105385, decouple_loss:0.003361940383911133
The modified gen p mean: 0.4476601481437683, gen p mean: -0.2514075040817261, mean p set: 0.4482307732105255
loss_pred:0.015594718046486378, decouple_loss:0.0032069669105112553
The modified gen p mean: 0.4500873386859894, gen p mean: -0.25302615761756897, mean p set: 0.45066288113594055
loss_pred:0.01548137329518795, decouple_loss:0.00337993330322206
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482875466346741, gen p mean: -0.24816079437732697, mean p set: 0.4488143026828766
loss_pred:0.015775252133607864, decouple_loss:0.0034310987684875727
The modified gen p mean: 0.44865405559539795, gen p mean: -0.24544599652290344, mean p set: 0.4492274820804596The modified gen p mean: 0.448988676071167, gen p mean: -0.2560807168483734, mean p set: 0.4495646357536316
loss_pred:0.015575691126286983, decouple_loss:0.004090027883648872
loss_pred:0.01561578270047903, decouple_loss:0.0033132191747426987
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477468729019165, gen p mean: -0.2513006627559662, mean p set: 0.4482734203338623
loss_pred:0.015325870364904404, decouple_loss:0.003021380864083767
The modified gen p mean: 0.4466902017593384, gen p mean: -0.2512371242046356, mean p set: 0.4472724497318268
loss_pred:0.015984153375029564, decouple_loss:0.003135833190754056
The modified gen p mean: 0.44841042160987854, gen p mean: -0.24451963603496552, mean p set: 0.44898515939712524
loss_pred:0.016003718599677086, decouple_loss:0.003178966697305441
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480597674846649, gen p mean: -0.25131961703300476, mean p set: 0.4485855996608734
loss_pred:0.01605449989438057, decouple_loss:0.0034450446255505085
The modified gen p mean: 0.4480128586292267, gen p mean: -0.2467832714319229, mean p set: 0.4485826790332794
loss_pred:0.01553285215049982, decouple_loss:0.0031950492411851883
The modified gen p mean: 0.4472900331020355, gen p mean: -0.2521856427192688, mean p set: 0.4478631317615509
loss_pred:0.01604597270488739, decouple_loss:0.0028820063453167677
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768208265304565, gen p mean: -0.23822319507598877, mean p set: 0.4482579529285431
loss_pred:0.015650669112801552, decouple_loss:0.0036748158745467663
The modified gen p mean: 0.44866859912872314, gen p mean: -0.23525221645832062, mean p set: 0.4492424428462982The modified gen p mean: 0.4478829503059387, gen p mean: -0.24297642707824707, mean p set: 0.448408842086792
loss_pred:0.015493141487240791, decouple_loss:0.003861114149913192
loss_pred:0.016003459692001343, decouple_loss:0.0034341386053711176
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475120007991791, gen p mean: -0.2351507991552353, mean p set: 0.44809263944625854
loss_pred:0.015317093580961227, decouple_loss:0.003375883912667632
The modified gen p mean: 0.4474922716617584, gen p mean: -0.23965664207935333, mean p set: 0.4480714499950409The modified gen p mean: 0.4482426345348358, gen p mean: -0.243930846452713, mean p set: 0.4487667679786682
loss_pred:0.015171097591519356, decouple_loss:0.0031625202391296625
loss_pred:0.015939997509121895, decouple_loss:0.003257257165387273
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777220487594604, gen p mean: -0.24055057764053345, mean p set: 0.4483499228954315
loss_pred:0.015576253645122051, decouple_loss:0.0031035675201565027
The modified gen p mean: 0.44799333810806274, gen p mean: -0.2401891052722931, mean p set: 0.4485265016555786
loss_pred:0.015050264075398445, decouple_loss:0.0031502435449510813
The modified gen p mean: 0.4482583999633789, gen p mean: -0.2355874627828598, mean p set: 0.44883567094802856
loss_pred:0.016031328588724136, decouple_loss:0.0029480059165507555
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45011427998542786, gen p mean: -0.24765843152999878, mean p set: 0.450685054063797
loss_pred:0.015961702913045883, decouple_loss:0.003834884613752365
The modified gen p mean: 0.4480862319469452, gen p mean: -0.2505307197570801, mean p set: 0.4486563205718994
loss_pred:0.015070552937686443, decouple_loss:0.003507679095491767
The modified gen p mean: 0.4461107850074768, gen p mean: -0.25018852949142456, mean p set: 0.44663533568382263
loss_pred:0.015545510686933994, decouple_loss:0.003514382988214493
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487425982952118, gen p mean: -0.24349825084209442, mean p set: 0.449319064617157
loss_pred:0.015605532564222813, decouple_loss:0.0030921672005206347
The modified gen p mean: 0.4493052363395691, gen p mean: -0.24126644432544708, mean p set: 0.44983553886413574The modified gen p mean: 0.44646507501602173, gen p mean: -0.2513520121574402, mean p set: 0.44704070687294006
loss_pred:0.015101884491741657, decouple_loss:0.003238379955291748
loss_pred:0.015730423852801323, decouple_loss:0.0033791777677834034
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855743646621704, gen p mean: -0.23668313026428223, mean p set: 0.44913890957832336
loss_pred:0.015523277223110199, decouple_loss:0.0032688076607882977
The modified gen p mean: 0.4507855772972107, gen p mean: -0.24763116240501404, mean p set: 0.4513660967350006
loss_pred:0.015564007684588432, decouple_loss:0.0033474534284323454
The modified gen p mean: 0.4486672580242157, gen p mean: -0.24028712511062622, mean p set: 0.44919851422309875
loss_pred:0.015770168974995613, decouple_loss:0.003437932813540101
2023-04-26 20:12:03 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24581360816955566, mean p set: 0.4499112665653229
loss_pred:0.018454229459166527, decouple_loss:0.004027164075523615
The modified gen p mean: 0.44822120666503906, gen p mean: -0.2426915019750595, mean p set: 0.44879910349845886
The modified gen p mean: 0.44925346970558167, gen p mean: -0.24575315415859222, mean p set: 0.4498290419578552
loss_pred:0.018432263284921646, decouple_loss:0.0036589964292943478
loss_pred:0.017969414591789246, decouple_loss:0.0038342487532645464
WV_1_PC_1_EH_0_PS_30, loss: 0.018477309495210648, avg_mse: 0.027189046144485474
current test mse: 0.027189
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478659927845001, gen p mean: -0.24420048296451569, mean p set: 0.44844454526901245
loss_pred:0.015352380461990833, decouple_loss:0.003359090769663453
The modified gen p mean: 0.4482220709323883, gen p mean: -0.24433621764183044, mean p set: 0.44879457354545593
loss_pred:0.015649499371647835, decouple_loss:0.003449131967499852
The modified gen p mean: 0.4476166069507599, gen p mean: -0.2414519190788269, mean p set: 0.4481477439403534
loss_pred:0.01571805402636528, decouple_loss:0.0034869571682065725
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464412033557892, gen p mean: -0.24833831191062927, mean p set: 0.44696733355522156
loss_pred:0.01530578825622797, decouple_loss:0.0031972581055015326
The modified gen p mean: 0.4481865465641022, gen p mean: -0.2417607605457306, mean p set: 0.44876742362976074
loss_pred:0.015782807022333145, decouple_loss:0.0030373837798833847
The modified gen p mean: 0.4469795227050781, gen p mean: -0.24890756607055664, mean p set: 0.44755133986473083
loss_pred:0.015131402760744095, decouple_loss:0.0030566726345568895
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749772548675537, gen p mean: -0.242163747549057, mean p set: 0.4480225145816803
loss_pred:0.016257749870419502, decouple_loss:0.003305120160803199
The modified gen p mean: 0.44773033261299133, gen p mean: -0.2418302297592163, mean p set: 0.44830387830734253
loss_pred:0.016623131930828094, decouple_loss:0.0033087958581745625
The modified gen p mean: 0.4482809901237488, gen p mean: -0.23754771053791046, mean p set: 0.44885557889938354
loss_pred:0.015329334884881973, decouple_loss:0.0035190104972571135
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836026430130005, gen p mean: -0.24053721129894257, mean p set: 0.4488862454891205
loss_pred:0.01566019095480442, decouple_loss:0.0030561774037778378
The modified gen p mean: 0.44641080498695374, gen p mean: -0.250373512506485, mean p set: 0.446990966796875
loss_pred:0.015709200873970985, decouple_loss:0.0033709772396832705
The modified gen p mean: 0.4479677677154541, gen p mean: -0.239826500415802, mean p set: 0.44854292273521423
loss_pred:0.015319659374654293, decouple_loss:0.0030653271824121475
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472287893295288, gen p mean: -0.2521483302116394, mean p set: 0.44775673747062683
loss_pred:0.015273349359631538, decouple_loss:0.003247243817895651
The modified gen p mean: 0.4472225606441498, gen p mean: -0.24666547775268555, mean p set: 0.44780102372169495The modified gen p mean: 0.44869640469551086, gen p mean: -0.2513972818851471, mean p set: 0.4492718279361725
loss_pred:0.016265712678432465, decouple_loss:0.003418554784730077loss_pred:0.015893805772066116, decouple_loss:0.003426802810281515
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483780860900879, gen p mean: -0.24883835017681122, mean p set: 0.44895556569099426
loss_pred:0.016192594543099403, decouple_loss:0.002970581641420722
The modified gen p mean: 0.4485182464122772, gen p mean: -0.25004175305366516, mean p set: 0.4490965008735657The modified gen p mean: 0.4478451907634735, gen p mean: -0.2511778473854065, mean p set: 0.44836726784706116
loss_pred:0.01580655574798584, decouple_loss:0.0032568478491157293
loss_pred:0.0149078369140625, decouple_loss:0.003144231392070651
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44913914799690247, gen p mean: -0.2486279457807541, mean p set: 0.44971415400505066
loss_pred:0.016027502715587616, decouple_loss:0.0033539868891239166
The modified gen p mean: 0.44813913106918335, gen p mean: -0.24477124214172363, mean p set: 0.44866693019866943The modified gen p mean: 0.4481673836708069, gen p mean: -0.24821366369724274, mean p set: 0.4487411379814148
loss_pred:0.014979814179241657, decouple_loss:0.003299121977761388
loss_pred:0.0154952984303236, decouple_loss:0.003222042229026556
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486653804779053, gen p mean: -0.2430610954761505, mean p set: 0.4492388665676117
loss_pred:0.015095248818397522, decouple_loss:0.0034474178683012724
The modified gen p mean: 0.44952473044395447, gen p mean: -0.24997764825820923, mean p set: 0.4501021206378937
loss_pred:0.015631280839443207, decouple_loss:0.003170755924656987
The modified gen p mean: 0.44936639070510864, gen p mean: -0.24200306832790375, mean p set: 0.44988885521888733
loss_pred:0.015769850462675095, decouple_loss:0.0033259429037570953
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739437103271484, gen p mean: -0.24826085567474365, mean p set: 0.44796544313430786
loss_pred:0.015647422522306442, decouple_loss:0.0030418350361287594
The modified gen p mean: 0.4486302435398102, gen p mean: -0.24413077533245087, mean p set: 0.44920095801353455
loss_pred:0.015381383709609509, decouple_loss:0.0030619390308856964
The modified gen p mean: 0.4463476836681366, gen p mean: -0.2531576454639435, mean p set: 0.4468747675418854
loss_pred:0.015912584960460663, decouple_loss:0.0033899189438670874
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481550455093384, gen p mean: -0.24905255436897278, mean p set: 0.4487343728542328
loss_pred:0.016385996714234352, decouple_loss:0.0031561146024614573
The modified gen p mean: 0.44854193925857544, gen p mean: -0.24638280272483826, mean p set: 0.4491168260574341
loss_pred:0.015999900177121162, decouple_loss:0.00326340040192008
The modified gen p mean: 0.4475191533565521, gen p mean: -0.25125378370285034, mean p set: 0.44804564118385315
loss_pred:0.01555513683706522, decouple_loss:0.003205681685358286
2023-04-26 20:15:30 testing...
The modified gen p mean: 0.44821998476982117, gen p mean: -0.2398063689470291, mean p set: 0.44879910349845886
loss_pred:0.018453562632203102, decouple_loss:0.003364532720297575
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24297524988651276, mean p set: 0.4499112665653229
loss_pred:0.018469473347067833, decouple_loss:0.0034401158336549997
The modified gen p mean: 0.44924914836883545, gen p mean: -0.24329215288162231, mean p set: 0.4498290419578552
loss_pred:0.017983119934797287, decouple_loss:0.003412030404433608
WV_1_PC_1_EH_0_PS_30, loss: 0.018472328782081604, avg_mse: 0.02718680165708065
current test mse: 0.027187
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461771547794342, gen p mean: -0.24199074506759644, mean p set: 0.44670602679252625
loss_pred:0.01716499961912632, decouple_loss:0.0031124905217438936
The modified gen p mean: 0.44678741693496704, gen p mean: -0.24128252267837524, mean p set: 0.44736430048942566
loss_pred:0.016601813957095146, decouple_loss:0.0033455207012593746
The modified gen p mean: 0.4468497633934021, gen p mean: -0.2422993928194046, mean p set: 0.44742023944854736
loss_pred:0.016409287229180336, decouple_loss:0.003098580054938793
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741055369377136, gen p mean: -0.24238620698451996, mean p set: 0.44793686270713806
loss_pred:0.016561686992645264, decouple_loss:0.0030603453051298857
The modified gen p mean: 0.448733389377594, gen p mean: -0.24593457579612732, mean p set: 0.44930416345596313
loss_pred:0.016627132892608643, decouple_loss:0.003353804349899292
The modified gen p mean: 0.4474477171897888, gen p mean: -0.24510525166988373, mean p set: 0.44802361726760864
loss_pred:0.016451459378004074, decouple_loss:0.0031990711577236652
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479570984840393, gen p mean: -0.25030091404914856, mean p set: 0.4484843611717224
loss_pred:0.01654689386487007, decouple_loss:0.0033909822814166546
The modified gen p mean: 0.44666242599487305, gen p mean: -0.25306379795074463, mean p set: 0.44723477959632874
loss_pred:0.01730729080736637, decouple_loss:0.0032645240426063538
The modified gen p mean: 0.44756731390953064, gen p mean: -0.24523557722568512, mean p set: 0.4481446444988251
loss_pred:0.017348334193229675, decouple_loss:0.003236099611967802
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778403639793396, gen p mean: -0.25790342688560486, mean p set: 0.4483122229576111
loss_pred:0.01606758125126362, decouple_loss:0.0033097814302891493
The modified gen p mean: 0.4485335648059845, gen p mean: -0.2548203468322754, mean p set: 0.44910916686058044
loss_pred:0.01701265387237072, decouple_loss:0.0032303486950695515
The modified gen p mean: 0.4470255672931671, gen p mean: -0.2558572292327881, mean p set: 0.4476010799407959
loss_pred:0.016691671684384346, decouple_loss:0.0034236980136483908
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714999198913574, gen p mean: -0.2564552426338196, mean p set: 0.4477294087409973
loss_pred:0.01701970025897026, decouple_loss:0.0035020371433347464
The modified gen p mean: 0.4480700194835663, gen p mean: -0.2558296322822571, mean p set: 0.4485948383808136The modified gen p mean: 0.44651874899864197, gen p mean: -0.25437721610069275, mean p set: 0.4470870792865753
loss_pred:0.016389453783631325, decouple_loss:0.003232074435800314
loss_pred:0.017079629004001617, decouple_loss:0.0035949735902249813
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724348187446594, gen p mean: -0.24993690848350525, mean p set: 0.4478200376033783
loss_pred:0.016896231099963188, decouple_loss:0.0037053758278489113
The modified gen p mean: 0.4469936192035675, gen p mean: -0.250885009765625, mean p set: 0.4475705623626709The modified gen p mean: 0.44738608598709106, gen p mean: -0.24916593730449677, mean p set: 0.4479181170463562
loss_pred:0.016014032065868378, decouple_loss:0.003685018280521035
loss_pred:0.016391843557357788, decouple_loss:0.003679676214233041
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471915364265442, gen p mean: -0.25082314014434814, mean p set: 0.4477703869342804
loss_pred:0.01676642894744873, decouple_loss:0.0033112731762230396
The modified gen p mean: 0.44804781675338745, gen p mean: -0.24677042663097382, mean p set: 0.44862401485443115
loss_pred:0.016861137002706528, decouple_loss:0.003338801208883524
The modified gen p mean: 0.4472430944442749, gen p mean: -0.24378041923046112, mean p set: 0.4477764964103699
loss_pred:0.0163442213088274, decouple_loss:0.003317084861919284
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806787371635437, gen p mean: -0.2480478584766388, mean p set: 0.4486437737941742
loss_pred:0.016137247905135155, decouple_loss:0.003415424609556794
The modified gen p mean: 0.4472486674785614, gen p mean: -0.24518245458602905, mean p set: 0.44782111048698425
loss_pred:0.016850555315613747, decouple_loss:0.0034453137777745724
The modified gen p mean: 0.4465655982494354, gen p mean: -0.25253599882125854, mean p set: 0.44708749651908875
loss_pred:0.016873495653271675, decouple_loss:0.003550527151674032
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483051896095276, gen p mean: -0.2521240711212158, mean p set: 0.4488847255706787
loss_pred:0.01632915437221527, decouple_loss:0.00366254267282784
The modified gen p mean: 0.44789403676986694, gen p mean: -0.24885402619838715, mean p set: 0.44842514395713806
loss_pred:0.01665969006717205, decouple_loss:0.003366307355463505
The modified gen p mean: 0.44679903984069824, gen p mean: -0.2501195967197418, mean p set: 0.44737330079078674
loss_pred:0.016328267753124237, decouple_loss:0.0036859754472970963
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467245936393738, gen p mean: -0.2509065568447113, mean p set: 0.4472969174385071
loss_pred:0.015934960916638374, decouple_loss:0.0031384716276079416
The modified gen p mean: 0.44751298427581787, gen p mean: -0.24557077884674072, mean p set: 0.4480918347835541
loss_pred:0.017198601737618446, decouple_loss:0.003013358451426029
The modified gen p mean: 0.4492615759372711, gen p mean: -0.2542262375354767, mean p set: 0.4497888684272766
loss_pred:0.01591695100069046, decouple_loss:0.0032476717606186867
2023-04-26 20:19:43 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24971313774585724, mean p set: 0.4499112665653229
loss_pred:0.018419193103909492, decouple_loss:0.003326842561364174
The modified gen p mean: 0.4482268989086151, gen p mean: -0.24636119604110718, mean p set: 0.44879910349845886
loss_pred:0.01830599084496498, decouple_loss:0.0032903177198022604
The modified gen p mean: 0.4492565393447876, gen p mean: -0.24950148165225983, mean p set: 0.4498290419578552
loss_pred:0.017862584441900253, decouple_loss:0.0033647804521024227
WV_1_PC_1_EH_0_PS_30, loss: 0.018362289294600487, avg_mse: 0.02700558491051197
current test mse: 0.027006
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464353322982788, gen p mean: -0.252958744764328, mean p set: 0.44701075553894043
loss_pred:0.0163388941437006, decouple_loss:0.0031801657751202583
The modified gen p mean: 0.4472757577896118, gen p mean: -0.2504107356071472, mean p set: 0.4478473961353302
loss_pred:0.016931811347603798, decouple_loss:0.0033077127300202847
The modified gen p mean: 0.44811689853668213, gen p mean: -0.24847178161144257, mean p set: 0.44864028692245483
loss_pred:0.016820503398776054, decouple_loss:0.0032281626481562853
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471699595451355, gen p mean: -0.25203579664230347, mean p set: 0.4476999342441559
loss_pred:0.016290709376335144, decouple_loss:0.0033536821138113737
The modified gen p mean: 0.44817647337913513, gen p mean: -0.257173091173172, mean p set: 0.4487501382827759
loss_pred:0.01609162613749504, decouple_loss:0.0037155505269765854
The modified gen p mean: 0.4465578496456146, gen p mean: -0.2553408443927765, mean p set: 0.4471310079097748
loss_pred:0.01579740270972252, decouple_loss:0.0032510021701455116
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683656096458435, gen p mean: -0.25663939118385315, mean p set: 0.44736161828041077
loss_pred:0.015970703214406967, decouple_loss:0.0032022492960095406
The modified gen p mean: 0.44718340039253235, gen p mean: -0.25268319249153137, mean p set: 0.4477572739124298The modified gen p mean: 0.44726282358169556, gen p mean: -0.2548055052757263, mean p set: 0.4478357136249542
loss_pred:0.01705957017838955, decouple_loss:0.0035253153182566166
loss_pred:0.016298465430736542, decouple_loss:0.0032158365938812494
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671934843063354, gen p mean: -0.25351113080978394, mean p set: 0.4472491443157196
loss_pred:0.016231099143624306, decouple_loss:0.0031317370012402534
The modified gen p mean: 0.4482223689556122, gen p mean: -0.25155580043792725, mean p set: 0.44880321621894836The modified gen p mean: 0.44785478711128235, gen p mean: -0.25168201327323914, mean p set: 0.4484269320964813
loss_pred:0.016611488536000252, decouple_loss:0.0030472944490611553
loss_pred:0.01608589105308056, decouple_loss:0.003225591266527772
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476405382156372, gen p mean: -0.24742622673511505, mean p set: 0.44817429780960083
loss_pred:0.01638892851769924, decouple_loss:0.0030283844098448753
The modified gen p mean: 0.4467274248600006, gen p mean: -0.2425655871629715, mean p set: 0.4473079442977905
loss_pred:0.016306953504681587, decouple_loss:0.003017060225829482
The modified gen p mean: 0.44764116406440735, gen p mean: -0.24485287070274353, mean p set: 0.44822028279304504
loss_pred:0.01597631722688675, decouple_loss:0.003282941412180662
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481625556945801, gen p mean: -0.24357612431049347, mean p set: 0.44868743419647217
loss_pred:0.016031833365559578, decouple_loss:0.0035120523534715176
The modified gen p mean: 0.44690069556236267, gen p mean: -0.24338339269161224, mean p set: 0.44747352600097656
loss_pred:0.01649303548038006, decouple_loss:0.0038163834251463413
The modified gen p mean: 0.4472271502017975, gen p mean: -0.2450195848941803, mean p set: 0.44780635833740234
loss_pred:0.016940291970968246, decouple_loss:0.0040377103723585606
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44845297932624817, gen p mean: -0.24966534972190857, mean p set: 0.4490325152873993
loss_pred:0.015747826546430588, decouple_loss:0.0033367823343724012
The modified gen p mean: 0.4478975534439087, gen p mean: -0.24760620296001434, mean p set: 0.44843074679374695The modified gen p mean: 0.44757142663002014, gen p mean: -0.24336495995521545, mean p set: 0.4481441080570221
loss_pred:0.015974940732121468, decouple_loss:0.0031976052559912205
loss_pred:0.01631893962621689, decouple_loss:0.003230609931051731
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470905363559723, gen p mean: -0.24757251143455505, mean p set: 0.4476657211780548
loss_pred:0.015970539301633835, decouple_loss:0.0034341183491051197
The modified gen p mean: 0.44721221923828125, gen p mean: -0.2488861232995987, mean p set: 0.4477914571762085
loss_pred:0.015863003209233284, decouple_loss:0.0037071469705551863
The modified gen p mean: 0.44719168543815613, gen p mean: -0.24608144164085388, mean p set: 0.44771599769592285
loss_pred:0.016103029251098633, decouple_loss:0.0038266044575721025
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814443588256836, gen p mean: -0.25094911456108093, mean p set: 0.44871804118156433
loss_pred:0.016329264268279076, decouple_loss:0.003192357486113906
The modified gen p mean: 0.4473276436328888, gen p mean: -0.25492027401924133, mean p set: 0.4479072690010071
loss_pred:0.0156753771007061, decouple_loss:0.0032322132028639317
The modified gen p mean: 0.44676700234413147, gen p mean: -0.25901663303375244, mean p set: 0.4472888708114624
loss_pred:0.016088509932160378, decouple_loss:0.003099626861512661
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670847058296204, gen p mean: -0.2573784291744232, mean p set: 0.44728556275367737
loss_pred:0.016982879489660263, decouple_loss:0.003248293185606599
The modified gen p mean: 0.4473804831504822, gen p mean: -0.2506257891654968, mean p set: 0.4479510188102722
loss_pred:0.016584163531661034, decouple_loss:0.0031768481712788343
The modified gen p mean: 0.44771143794059753, gen p mean: -0.25558218359947205, mean p set: 0.4482421875
loss_pred:0.016031155362725258, decouple_loss:0.0033125600311905146
2023-04-26 20:23:09 testing...
The modified gen p mean: 0.44821515679359436, gen p mean: -0.2526748478412628, mean p set: 0.44879910349845886
loss_pred:0.018275853246450424, decouple_loss:0.003351834136992693
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25546765327453613, mean p set: 0.4499112665653229
loss_pred:0.0183322224766016, decouple_loss:0.003292327979579568
The modified gen p mean: 0.44924893975257874, gen p mean: -0.25570249557495117, mean p set: 0.4498290419578552
loss_pred:0.017804712057113647, decouple_loss:0.0032357960008084774
WV_1_PC_1_EH_0_PS_30, loss: 0.01830226182937622, avg_mse: 0.026973756030201912
current test mse: 0.026974
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878488779067993, gen p mean: -0.26447638869285583, mean p set: 0.44930580258369446
loss_pred:0.016116801649332047, decouple_loss:0.003208272624760866
The modified gen p mean: 0.4463563561439514, gen p mean: -0.2531912326812744, mean p set: 0.44692397117614746
loss_pred:0.016833459958434105, decouple_loss:0.003201844170689583
The modified gen p mean: 0.4472687840461731, gen p mean: -0.2591416835784912, mean p set: 0.4478381872177124
loss_pred:0.016358811408281326, decouple_loss:0.0031167147681117058
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693395495414734, gen p mean: -0.2493075579404831, mean p set: 0.4474518895149231
loss_pred:0.016617758199572563, decouple_loss:0.0031928755342960358
The modified gen p mean: 0.4477628171443939, gen p mean: -0.2555687725543976, mean p set: 0.44833290576934814The modified gen p mean: 0.446891188621521, gen p mean: -0.25759267807006836, mean p set: 0.4474670886993408
loss_pred:0.016260506585240364, decouple_loss:0.0028953440487384796loss_pred:0.016084037721157074, decouple_loss:0.0028556331526488066
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717520475387573, gen p mean: -0.2525187134742737, mean p set: 0.4477064609527588
loss_pred:0.016006311401724815, decouple_loss:0.0035928094293922186
The modified gen p mean: 0.44788631796836853, gen p mean: -0.25222301483154297, mean p set: 0.44846251606941223
loss_pred:0.016012009233236313, decouple_loss:0.0036886269226670265
The modified gen p mean: 0.44800007343292236, gen p mean: -0.2536986172199249, mean p set: 0.448570191860199
loss_pred:0.016300076618790627, decouple_loss:0.0032733483240008354
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691383838653564, gen p mean: -0.2531581521034241, mean p set: 0.4474417567253113
loss_pred:0.016631999984383583, decouple_loss:0.003066306933760643
The modified gen p mean: 0.4471549391746521, gen p mean: -0.2550029158592224, mean p set: 0.44772762060165405
loss_pred:0.015601156279444695, decouple_loss:0.0031358301639556885
The modified gen p mean: 0.44679802656173706, gen p mean: -0.24946372210979462, mean p set: 0.447368860244751
loss_pred:0.016470523551106453, decouple_loss:0.0031374399550259113
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446857213973999, gen p mean: -0.2516670227050781, mean p set: 0.4474363923072815
loss_pred:0.01623595878481865, decouple_loss:0.003489857306703925
The modified gen p mean: 0.44682419300079346, gen p mean: -0.25251320004463196, mean p set: 0.44735097885131836The modified gen p mean: 0.44680970907211304, gen p mean: -0.25162893533706665, mean p set: 0.44738972187042236
loss_pred:0.016216635704040527, decouple_loss:0.0033997995778918266loss_pred:0.01637512445449829, decouple_loss:0.003321197349578142
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755440950393677, gen p mean: -0.2485567033290863, mean p set: 0.4481275677680969
loss_pred:0.016054049134254456, decouple_loss:0.0031390120275318623
The modified gen p mean: 0.44675666093826294, gen p mean: -0.250999391078949, mean p set: 0.4472809433937073The modified gen p mean: 0.44616225361824036, gen p mean: -0.2489328235387802, mean p set: 0.44673141837120056
loss_pred:0.016859835013747215, decouple_loss:0.0031513147987425327
loss_pred:0.016436411067843437, decouple_loss:0.003143593203276396
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722944498062134, gen p mean: -0.2511386573314667, mean p set: 0.4478035867214203
loss_pred:0.016570787876844406, decouple_loss:0.003359411610290408
The modified gen p mean: 0.44702959060668945, gen p mean: -0.25193196535110474, mean p set: 0.4475582242012024The modified gen p mean: 0.446446031332016, gen p mean: -0.24716995656490326, mean p set: 0.44702303409576416
loss_pred:0.016756311058998108, decouple_loss:0.0032710263039916754
loss_pred:0.015775443986058235, decouple_loss:0.0032794540748000145
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649389386177063, gen p mean: -0.24334079027175903, mean p set: 0.4470658302307129
loss_pred:0.01657462678849697, decouple_loss:0.0034541015047580004
The modified gen p mean: 0.4468231797218323, gen p mean: -0.24497202038764954, mean p set: 0.447394996881485
loss_pred:0.016405228525400162, decouple_loss:0.003254698123782873
The modified gen p mean: 0.44610241055488586, gen p mean: -0.24264496564865112, mean p set: 0.4466211497783661
loss_pred:0.01622409000992775, decouple_loss:0.0030928084161132574
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691556692123413, gen p mean: -0.24456661939620972, mean p set: 0.4474965035915375
loss_pred:0.015971684828400612, decouple_loss:0.0031041069887578487
The modified gen p mean: 0.44594788551330566, gen p mean: -0.24047403037548065, mean p set: 0.4465225338935852
loss_pred:0.016359280794858932, decouple_loss:0.0030541219748556614
The modified gen p mean: 0.4479667544364929, gen p mean: -0.24924084544181824, mean p set: 0.44850221276283264
loss_pred:0.01593048870563507, decouple_loss:0.0029381290078163147
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467383921146393, gen p mean: -0.24666272103786469, mean p set: 0.44731974601745605
loss_pred:0.015973079949617386, decouple_loss:0.003282701363787055
The modified gen p mean: 0.44666072726249695, gen p mean: -0.24516616761684418, mean p set: 0.44718724489212036The modified gen p mean: 0.447420597076416, gen p mean: -0.245538130402565, mean p set: 0.4479915201663971
loss_pred:0.015974463894963264, decouple_loss:0.0034775687381625175
loss_pred:0.01655673049390316, decouple_loss:0.003199284663423896
2023-04-26 20:27:25 testing...
The modified gen p mean: 0.4482242166996002, gen p mean: -0.2422935664653778, mean p set: 0.44879910349845886
loss_pred:0.01825440675020218, decouple_loss:0.0033751141745597124
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24524182081222534, mean p set: 0.4499112665653229
loss_pred:0.018301870673894882, decouple_loss:0.0035141734406352043
The modified gen p mean: 0.4492519497871399, gen p mean: -0.2452174574136734, mean p set: 0.4498290419578552
loss_pred:0.01776617020368576, decouple_loss:0.0034916317090392113
WV_1_PC_1_EH_0_PS_30, loss: 0.018280498683452606, avg_mse: 0.026906317099928856
current test mse: 0.026906
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676390290260315, gen p mean: -0.24459679424762726, mean p set: 0.4473459720611572
loss_pred:0.016534924507141113, decouple_loss:0.003495321609079838
The modified gen p mean: 0.44837790727615356, gen p mean: -0.25164908170700073, mean p set: 0.4489026963710785
loss_pred:0.01609494723379612, decouple_loss:0.003430082928389311
The modified gen p mean: 0.4464409351348877, gen p mean: -0.24489694833755493, mean p set: 0.44701918959617615
loss_pred:0.01672993041574955, decouple_loss:0.0033113432582467794
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44601312279701233, gen p mean: -0.23757848143577576, mean p set: 0.4465442895889282
loss_pred:0.016247831284999847, decouple_loss:0.0032702982425689697
The modified gen p mean: 0.4470953345298767, gen p mean: -0.24649262428283691, mean p set: 0.4476762115955353The modified gen p mean: 0.44589123129844666, gen p mean: -0.24122406542301178, mean p set: 0.4464643895626068
loss_pred:0.015587126836180687, decouple_loss:0.0030428229365497828
loss_pred:0.01619490049779415, decouple_loss:0.0031155140604823828
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447051078081131, gen p mean: -0.24229663610458374, mean p set: 0.4475724399089813
loss_pred:0.015996452420949936, decouple_loss:0.003262817859649658
The modified gen p mean: 0.44701582193374634, gen p mean: -0.2461804449558258, mean p set: 0.447593629360199
loss_pred:0.016016686335206032, decouple_loss:0.0031336694955825806
The modified gen p mean: 0.44593143463134766, gen p mean: -0.24475198984146118, mean p set: 0.446504145860672
loss_pred:0.016676880419254303, decouple_loss:0.0033378282096236944
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445986270904541, gen p mean: -0.24461394548416138, mean p set: 0.44651639461517334
loss_pred:0.016563385725021362, decouple_loss:0.0033256930764764547
The modified gen p mean: 0.4472525119781494, gen p mean: -0.24489296972751617, mean p set: 0.44783177971839905
loss_pred:0.01641548052430153, decouple_loss:0.003173653967678547
The modified gen p mean: 0.4472452998161316, gen p mean: -0.24791710078716278, mean p set: 0.44781920313835144
loss_pred:0.0164624210447073, decouple_loss:0.003194329794496298
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44612622261047363, gen p mean: -0.24419453740119934, mean p set: 0.4466512203216553
loss_pred:0.016806332394480705, decouple_loss:0.0036297966726124287
The modified gen p mean: 0.44660574197769165, gen p mean: -0.24573485553264618, mean p set: 0.4471836984157562The modified gen p mean: 0.44749578833580017, gen p mean: -0.24799132347106934, mean p set: 0.44806966185569763
loss_pred:0.016397498548030853, decouple_loss:0.0031903123017400503
loss_pred:0.015930769965052605, decouple_loss:0.0030715714674443007
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477309286594391, gen p mean: -0.24873504042625427, mean p set: 0.4483036994934082
loss_pred:0.015745099633932114, decouple_loss:0.004085457883775234
The modified gen p mean: 0.44700559973716736, gen p mean: -0.2503056526184082, mean p set: 0.447585791349411The modified gen p mean: 0.4470352828502655, gen p mean: -0.25230932235717773, mean p set: 0.4475627839565277
loss_pred:0.01612463779747486, decouple_loss:0.003657507011666894
loss_pred:0.01493848767131567, decouple_loss:0.003669431433081627
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464241862297058, gen p mean: -0.2557726502418518, mean p set: 0.44700121879577637
loss_pred:0.016340188682079315, decouple_loss:0.0031484218779951334
The modified gen p mean: 0.44771745800971985, gen p mean: -0.25300708413124084, mean p set: 0.44829118251800537The modified gen p mean: 0.44671308994293213, gen p mean: -0.2512701749801636, mean p set: 0.44724246859550476
loss_pred:0.01582268625497818, decouple_loss:0.003274833783507347
loss_pred:0.01588548719882965, decouple_loss:0.0030664040241390467
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467696249485016, gen p mean: -0.25246500968933105, mean p set: 0.4473433792591095
loss_pred:0.016221387311816216, decouple_loss:0.003877796232700348
The modified gen p mean: 0.4457557797431946, gen p mean: -0.25304579734802246, mean p set: 0.4463328719139099
loss_pred:0.01584308035671711, decouple_loss:0.0038475494366139174
The modified gen p mean: 0.44804197549819946, gen p mean: -0.25220486521720886, mean p set: 0.44856566190719604
loss_pred:0.015906959772109985, decouple_loss:0.0035087799187749624
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447624534368515, gen p mean: -0.2509615421295166, mean p set: 0.44819772243499756
loss_pred:0.01671181432902813, decouple_loss:0.003075795713812113
The modified gen p mean: 0.44599810242652893, gen p mean: -0.24635042250156403, mean p set: 0.44658011198043823
loss_pred:0.01666097901761532, decouple_loss:0.003239561105147004
The modified gen p mean: 0.44624418020248413, gen p mean: -0.2533325254917145, mean p set: 0.4467797577381134
loss_pred:0.016236381605267525, decouple_loss:0.0030325523111969233
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469558000564575, gen p mean: -0.24823017418384552, mean p set: 0.4475339949131012
loss_pred:0.016736865043640137, decouple_loss:0.0038653623778373003
The modified gen p mean: 0.4471280872821808, gen p mean: -0.2506292462348938, mean p set: 0.4476585388183594The modified gen p mean: 0.4466700553894043, gen p mean: -0.2492326945066452, mean p set: 0.44724223017692566
loss_pred:0.016317108646035194, decouple_loss:0.0036971368826925755
loss_pred:0.01648784801363945, decouple_loss:0.0033949092030525208
2023-04-26 20:30:52 testing...
The modified gen p mean: 0.4482235610485077, gen p mean: -0.24071040749549866, mean p set: 0.44879910349845886
loss_pred:0.018156738951802254, decouple_loss:0.003225146559998393
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24354426562786102, mean p set: 0.4499112665653229
loss_pred:0.018253974616527557, decouple_loss:0.0033087197225540876
The modified gen p mean: 0.4492568075656891, gen p mean: -0.24334101378917694, mean p set: 0.4498290419578552
loss_pred:0.017784809693694115, decouple_loss:0.0032934530172497034
WV_1_PC_1_EH_0_PS_30, loss: 0.018228963017463684, avg_mse: 0.02686242386698723
current test mse: 0.026862
At step 320, Best test: 0.026862
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474770426750183, gen p mean: -0.24103502929210663, mean p set: 0.44800853729248047
loss_pred:0.016094887629151344, decouple_loss:0.0031028499361127615
The modified gen p mean: 0.44721338152885437, gen p mean: -0.24059747159481049, mean p set: 0.44779151678085327
loss_pred:0.016092341393232346, decouple_loss:0.0034394424874335527
The modified gen p mean: 0.44779670238494873, gen p mean: -0.23737172782421112, mean p set: 0.4483778774738312
loss_pred:0.01585954613983631, decouple_loss:0.003461793065071106
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474610686302185, gen p mean: -0.23635634779930115, mean p set: 0.44798827171325684
loss_pred:0.015174582600593567, decouple_loss:0.004010837525129318
The modified gen p mean: 0.44879770278930664, gen p mean: -0.233950674533844, mean p set: 0.44937291741371155
loss_pred:0.015841353684663773, decouple_loss:0.003596329828724265
The modified gen p mean: 0.4461764097213745, gen p mean: -0.2359301745891571, mean p set: 0.44675159454345703
loss_pred:0.016609689220786095, decouple_loss:0.0033915226813405752
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479997456073761, gen p mean: -0.23995351791381836, mean p set: 0.4485274851322174
loss_pred:0.015889910981059074, decouple_loss:0.003417921718209982
The modified gen p mean: 0.4479001760482788, gen p mean: -0.23270930349826813, mean p set: 0.44847285747528076
loss_pred:0.015370165929198265, decouple_loss:0.003420356661081314
The modified gen p mean: 0.4473719298839569, gen p mean: -0.23680584132671356, mean p set: 0.4479469656944275
loss_pred:0.01583930477499962, decouple_loss:0.003647838020697236
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719070196151733, gen p mean: -0.2402285635471344, mean p set: 0.44772061705589294
loss_pred:0.01579449698328972, decouple_loss:0.0032603759318590164
The modified gen p mean: 0.4466899633407593, gen p mean: -0.23921284079551697, mean p set: 0.44725939631462097
loss_pred:0.016251564025878906, decouple_loss:0.0030910843051970005
The modified gen p mean: 0.4466223418712616, gen p mean: -0.24074934422969818, mean p set: 0.4471994936466217
loss_pred:0.016426604241132736, decouple_loss:0.003144812537357211
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722408056259155, gen p mean: -0.2392132431268692, mean p set: 0.4478025436401367
loss_pred:0.015675175935029984, decouple_loss:0.0036467236932367086
The modified gen p mean: 0.4477248191833496, gen p mean: -0.23989315330982208, mean p set: 0.44824886322021484The modified gen p mean: 0.4461877942085266, gen p mean: -0.23287366330623627, mean p set: 0.44676467776298523
loss_pred:0.015549001283943653, decouple_loss:0.0037176478654146194
loss_pred:0.015494046732783318, decouple_loss:0.003789694979786873
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469871520996094, gen p mean: -0.23530475795269012, mean p set: 0.44756919145584106
loss_pred:0.01667010597884655, decouple_loss:0.0032445904798805714
The modified gen p mean: 0.4471668601036072, gen p mean: -0.2409955859184265, mean p set: 0.4477385878562927The modified gen p mean: 0.4471193552017212, gen p mean: -0.24176767468452454, mean p set: 0.44765228033065796
loss_pred:0.01590864360332489, decouple_loss:0.003328715218231082
loss_pred:0.01617599092423916, decouple_loss:0.003176905680447817
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473552703857422, gen p mean: -0.24832099676132202, mean p set: 0.44793838262557983
loss_pred:0.015675416216254234, decouple_loss:0.003934961743652821
The modified gen p mean: 0.44699183106422424, gen p mean: -0.2458408921957016, mean p set: 0.44756677746772766The modified gen p mean: 0.4468734562397003, gen p mean: -0.24150776863098145, mean p set: 0.4474049210548401
loss_pred:0.015801966190338135, decouple_loss:0.0032841770444065332
loss_pred:0.015805745497345924, decouple_loss:0.003311888547614217
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465303421020508, gen p mean: -0.2422850877046585, mean p set: 0.447108656167984
loss_pred:0.015041190199553967, decouple_loss:0.003735046600922942
The modified gen p mean: 0.44866088032722473, gen p mean: -0.2373749315738678, mean p set: 0.44924309849739075
loss_pred:0.015793709084391594, decouple_loss:0.004013749770820141
The modified gen p mean: 0.44688066840171814, gen p mean: -0.2441864311695099, mean p set: 0.4474024176597595
loss_pred:0.015925198793411255, decouple_loss:0.003777566598728299
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804316759109497, gen p mean: -0.2480846494436264, mean p set: 0.4486168920993805
loss_pred:0.015585667453706264, decouple_loss:0.003495641518384218
The modified gen p mean: 0.4473479092121124, gen p mean: -0.24655961990356445, mean p set: 0.4479270875453949
loss_pred:0.015263201668858528, decouple_loss:0.0035750060342252254
The modified gen p mean: 0.447833776473999, gen p mean: -0.2503502070903778, mean p set: 0.44836175441741943
loss_pred:0.015421247109770775, decouple_loss:0.003511223243549466
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448442280292511, gen p mean: -0.24019411206245422, mean p set: 0.4490176737308502
loss_pred:0.015542584471404552, decouple_loss:0.0037138788029551506
The modified gen p mean: 0.44672349095344543, gen p mean: -0.2443595826625824, mean p set: 0.44729676842689514
loss_pred:0.015803126618266106, decouple_loss:0.003429634962230921
The modified gen p mean: 0.4462571442127228, gen p mean: -0.2433762103319168, mean p set: 0.44677630066871643
loss_pred:0.01628931239247322, decouple_loss:0.0032565498258918524
2023-04-26 20:35:12 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2440590113401413, mean p set: 0.4499112665653229
loss_pred:0.01847071759402752, decouple_loss:0.003587404964491725
The modified gen p mean: 0.4482191801071167, gen p mean: -0.24101153016090393, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492567181587219, gen p mean: -0.2434605211019516, mean p set: 0.4498290419578552
loss_pred:0.018385086208581924, decouple_loss:0.0034726818557828665
loss_pred:0.017877060920000076, decouple_loss:0.003556597977876663
WV_1_PC_1_EH_0_PS_30, loss: 0.0184212327003479, avg_mse: 0.027178442105650902
current test mse: 0.027178
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482002854347229, gen p mean: -0.24117733538150787, mean p set: 0.44877946376800537
loss_pred:0.014868314377963543, decouple_loss:0.0034249115269631147
The modified gen p mean: 0.4482937455177307, gen p mean: -0.2392926812171936, mean p set: 0.4488696753978729
loss_pred:0.015064834617078304, decouple_loss:0.0036175374407321215
The modified gen p mean: 0.44811221957206726, gen p mean: -0.23638851940631866, mean p set: 0.4486429989337921
loss_pred:0.015774279832839966, decouple_loss:0.0035069945733994246
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649964570999146, gen p mean: -0.24436353147029877, mean p set: 0.4470299780368805
loss_pred:0.016250019893050194, decouple_loss:0.0035051258746534586
The modified gen p mean: 0.4473148584365845, gen p mean: -0.24479305744171143, mean p set: 0.4478895962238312The modified gen p mean: 0.44659948348999023, gen p mean: -0.2437201887369156, mean p set: 0.4471812844276428
loss_pred:0.015011217445135117, decouple_loss:0.0036234683357179165loss_pred:0.015921948477625847, decouple_loss:0.003513998119160533
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488679766654968, gen p mean: -0.2437961846590042, mean p set: 0.4493965804576874
loss_pred:0.015075729228556156, decouple_loss:0.0033630880061537027
The modified gen p mean: 0.44702473282814026, gen p mean: -0.2500590682029724, mean p set: 0.44759422540664673The modified gen p mean: 0.4471159279346466, gen p mean: -0.24653245508670807, mean p set: 0.4476914703845978
loss_pred:0.015629088506102562, decouple_loss:0.0034290500916540623
loss_pred:0.015887271612882614, decouple_loss:0.003286861814558506
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468677043914795, gen p mean: -0.2396947741508484, mean p set: 0.44739410281181335
loss_pred:0.016704490408301353, decouple_loss:0.003837982891127467
The modified gen p mean: 0.44641903042793274, gen p mean: -0.24270400404930115, mean p set: 0.4469953179359436
loss_pred:0.015545704402029514, decouple_loss:0.004088318441063166
The modified gen p mean: 0.44753900170326233, gen p mean: -0.24067801237106323, mean p set: 0.4481112062931061
loss_pred:0.016293983906507492, decouple_loss:0.0035670350771397352
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733431935310364, gen p mean: -0.24608702957630157, mean p set: 0.44790735840797424
loss_pred:0.01547208707779646, decouple_loss:0.0033312987070530653
The modified gen p mean: 0.4478510916233063, gen p mean: -0.24118317663669586, mean p set: 0.4483802020549774The modified gen p mean: 0.44642186164855957, gen p mean: -0.2478467971086502, mean p set: 0.44700247049331665
loss_pred:0.015312815085053444, decouple_loss:0.003337813075631857
loss_pred:0.01596769690513611, decouple_loss:0.0034943586215376854
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810211658477783, gen p mean: -0.2450748085975647, mean p set: 0.4486709535121918
loss_pred:0.014867753721773624, decouple_loss:0.0034834009129554033
The modified gen p mean: 0.44737890362739563, gen p mean: -0.24825842678546906, mean p set: 0.44795170426368713The modified gen p mean: 0.44770538806915283, gen p mean: -0.24967923760414124, mean p set: 0.4482361972332001
loss_pred:0.015622799284756184, decouple_loss:0.0035139441024512053
loss_pred:0.015515436418354511, decouple_loss:0.003265146864578128
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467412233352661, gen p mean: -0.25401172041893005, mean p set: 0.4473215639591217
loss_pred:0.016356712207198143, decouple_loss:0.0032076952047646046
The modified gen p mean: 0.4486161470413208, gen p mean: -0.247975692152977, mean p set: 0.449184387922287The modified gen p mean: 0.4477440416812897, gen p mean: -0.25407370924949646, mean p set: 0.44827136397361755
loss_pred:0.015783190727233887, decouple_loss:0.003393888706341386
loss_pred:0.01568962261080742, decouple_loss:0.0033298933412879705
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695183634757996, gen p mean: -0.24994567036628723, mean p set: 0.4475267231464386
loss_pred:0.016556071117520332, decouple_loss:0.0032072735484689474
The modified gen p mean: 0.4469953179359436, gen p mean: -0.24698349833488464, mean p set: 0.4475743770599365
loss_pred:0.017728252336382866, decouple_loss:0.003198451828211546
The modified gen p mean: 0.4479524791240692, gen p mean: -0.25395920872688293, mean p set: 0.4484791159629822
loss_pred:0.016387298703193665, decouple_loss:0.0034284181892871857
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486779570579529, gen p mean: -0.2543679475784302, mean p set: 0.44926023483276367
loss_pred:0.016632797196507454, decouple_loss:0.003193655051290989
The modified gen p mean: 0.4478965699672699, gen p mean: -0.25644904375076294, mean p set: 0.4484758675098419
loss_pred:0.016510477289557457, decouple_loss:0.00332307955250144
The modified gen p mean: 0.44843530654907227, gen p mean: -0.25322383642196655, mean p set: 0.4489628076553345
loss_pred:0.016492603346705437, decouple_loss:0.003163139568641782
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471791684627533, gen p mean: -0.25616270303726196, mean p set: 0.4477514624595642
loss_pred:0.015904977917671204, decouple_loss:0.003815027419477701
The modified gen p mean: 0.4477904736995697, gen p mean: -0.25364068150520325, mean p set: 0.44832685589790344The modified gen p mean: 0.44798293709754944, gen p mean: -0.2530894875526428, mean p set: 0.4485653042793274
loss_pred:0.015655983239412308, decouple_loss:0.0036354183685034513
loss_pred:0.016199493780732155, decouple_loss:0.003786776913329959
2023-04-26 20:38:38 testing...
The modified gen p mean: 0.4482288658618927, gen p mean: -0.25002115964889526, mean p set: 0.44879910349845886
loss_pred:0.01900327578186989, decouple_loss:0.004015485756099224
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2528979182243347, mean p set: 0.4499112665653229
loss_pred:0.01893935725092888, decouple_loss:0.00408915476873517
The modified gen p mean: 0.4492621123790741, gen p mean: -0.25305116176605225, mean p set: 0.4498290419578552
loss_pred:0.01841840334236622, decouple_loss:0.004096171818673611
WV_1_PC_1_EH_0_PS_30, loss: 0.01899036020040512, avg_mse: 0.028229672461748123
current test mse: 0.02823
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489753246307373, gen p mean: -0.24819830060005188, mean p set: 0.44950512051582336
loss_pred:0.01620790734887123, decouple_loss:0.004254892002791166
The modified gen p mean: 0.447316974401474, gen p mean: -0.24688281118869781, mean p set: 0.4478890001773834
loss_pred:0.016523286700248718, decouple_loss:0.004165781661868095
The modified gen p mean: 0.44875743985176086, gen p mean: -0.2508382201194763, mean p set: 0.4493320882320404
loss_pred:0.016256431117653847, decouple_loss:0.004640274215489626
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871431589126587, gen p mean: -0.24405525624752045, mean p set: 0.44924888014793396
loss_pred:0.01582905650138855, decouple_loss:0.004283538553863764
The modified gen p mean: 0.4478454291820526, gen p mean: -0.23687399923801422, mean p set: 0.44841745495796204The modified gen p mean: 0.4481351971626282, gen p mean: -0.2455621361732483, mean p set: 0.4487197697162628
loss_pred:0.015587863512337208, decouple_loss:0.004282933659851551
loss_pred:0.016137877479195595, decouple_loss:0.004554322455078363
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469974935054779, gen p mean: -0.23772181570529938, mean p set: 0.44752633571624756
loss_pred:0.015380915254354477, decouple_loss:0.004327896982431412
The modified gen p mean: 0.44781017303466797, gen p mean: -0.2300962656736374, mean p set: 0.44838523864746094The modified gen p mean: 0.4477333426475525, gen p mean: -0.2315405309200287, mean p set: 0.4483111500740051
loss_pred:0.01692378707230091, decouple_loss:0.004372888244688511
loss_pred:0.016656646504998207, decouple_loss:0.0044555761851370335
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867202639579773, gen p mean: -0.26459383964538574, mean p set: 0.4491964280605316
loss_pred:0.016312861815094948, decouple_loss:0.0043160878121852875
The modified gen p mean: 0.44727131724357605, gen p mean: -0.2549741864204407, mean p set: 0.44784975051879883
loss_pred:0.015740176662802696, decouple_loss:0.004208694212138653
The modified gen p mean: 0.44820302724838257, gen p mean: -0.26277726888656616, mean p set: 0.44878509640693665
loss_pred:0.016199953854084015, decouple_loss:0.0044017210602760315
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848495721817017, gen p mean: -0.26462438702583313, mean p set: 0.44906049966812134
loss_pred:0.015853693708777428, decouple_loss:0.004295813851058483
The modified gen p mean: 0.44867002964019775, gen p mean: -0.2650916576385498, mean p set: 0.44924619793891907
loss_pred:0.016204485669732094, decouple_loss:0.004269660450518131
The modified gen p mean: 0.44810590147972107, gen p mean: -0.2719973623752594, mean p set: 0.44863414764404297
loss_pred:0.015599733218550682, decouple_loss:0.00417697848752141
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931814074516296, gen p mean: -0.2622140347957611, mean p set: 0.44985491037368774
loss_pred:0.01636376604437828, decouple_loss:0.004030358977615833
The modified gen p mean: 0.4473940432071686, gen p mean: -0.2693758010864258, mean p set: 0.4479677379131317
loss_pred:0.01576855778694153, decouple_loss:0.0041806804947555065
The modified gen p mean: 0.44880345463752747, gen p mean: -0.26362863183021545, mean p set: 0.4493766129016876
loss_pred:0.016251731663942337, decouple_loss:0.004175181966274977
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44592881202697754, gen p mean: -0.26154276728630066, mean p set: 0.4464992880821228
The modified gen p mean: 0.4479414224624634, gen p mean: -0.2615363597869873, mean p set: 0.4485096037387848
loss_pred:0.016627497971057892, decouple_loss:0.004407832864671946
loss_pred:0.016124604269862175, decouple_loss:0.004653284791857004
The modified gen p mean: 0.44998860359191895, gen p mean: -0.25650474429130554, mean p set: 0.4505167305469513
loss_pred:0.01631253957748413, decouple_loss:0.004274626262485981
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447062611579895, gen p mean: -0.25807076692581177, mean p set: 0.4476434886455536
loss_pred:0.01599695347249508, decouple_loss:0.00403694249689579
The modified gen p mean: 0.4487804174423218, gen p mean: -0.2598092555999756, mean p set: 0.4493577182292938
loss_pred:0.015476206317543983, decouple_loss:0.004331372212618589
The modified gen p mean: 0.4481884241104126, gen p mean: -0.2596378028392792, mean p set: 0.4487130343914032
loss_pred:0.016025856137275696, decouple_loss:0.00421487633138895
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478521943092346, gen p mean: -0.24804909527301788, mean p set: 0.44842419028282166
loss_pred:0.015938814729452133, decouple_loss:0.00442586001008749
The modified gen p mean: 0.44651541113853455, gen p mean: -0.24986068904399872, mean p set: 0.44709157943725586
loss_pred:0.015965593978762627, decouple_loss:0.004059487488120794
The modified gen p mean: 0.446139931678772, gen p mean: -0.24944716691970825, mean p set: 0.4466628134250641
loss_pred:0.016519298776984215, decouple_loss:0.004124707076698542
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463711380958557, gen p mean: -0.24731378257274628, mean p set: 0.4469376802444458
loss_pred:0.016293508931994438, decouple_loss:0.004101978149265051
The modified gen p mean: 0.4491037130355835, gen p mean: -0.2478187531232834, mean p set: 0.4496791362762451
loss_pred:0.016156524419784546, decouple_loss:0.004274230450391769
The modified gen p mean: 0.4472998082637787, gen p mean: -0.24379535019397736, mean p set: 0.44782590866088867
loss_pred:0.01634238474071026, decouple_loss:0.00397428497672081
2023-04-26 20:42:58 testing...
The modified gen p mean: 0.448229044675827, gen p mean: -0.24982622265815735, mean p set: 0.44879910349845886
loss_pred:0.01852450892329216, decouple_loss:0.00453578494489193
The modified gen p mean: 0.4494309425354004, gen p mean: -0.251905620098114, mean p set: 0.4499112665653229
loss_pred:0.018581736832857132, decouple_loss:0.004433090798556805
The modified gen p mean: 0.44924911856651306, gen p mean: -0.25207576155662537, mean p set: 0.4498290419578552
loss_pred:0.01814270205795765, decouple_loss:0.004431818146258593
WV_1_PC_1_EH_0_PS_30, loss: 0.018639661371707916, avg_mse: 0.027377303689718246
current test mse: 0.027377
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490054249763489, gen p mean: -0.24821972846984863, mean p set: 0.4495809078216553
loss_pred:0.01595821976661682, decouple_loss:0.00430033216252923
The modified gen p mean: 0.44962093234062195, gen p mean: -0.2502482831478119, mean p set: 0.45020049810409546
loss_pred:0.015591601841151714, decouple_loss:0.004397847689688206
The modified gen p mean: 0.4491923451423645, gen p mean: -0.25419577956199646, mean p set: 0.4497106075286865
loss_pred:0.015861405059695244, decouple_loss:0.004373857751488686
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813501834869385, gen p mean: -0.24870987236499786, mean p set: 0.44866541028022766
loss_pred:0.016159314662218094, decouple_loss:0.004084213636815548
The modified gen p mean: 0.44765719771385193, gen p mean: -0.24670152366161346, mean p set: 0.44823670387268066
loss_pred:0.01580851711332798, decouple_loss:0.004095742478966713
The modified gen p mean: 0.4485078752040863, gen p mean: -0.24861979484558105, mean p set: 0.449078768491745
loss_pred:0.015659965574741364, decouple_loss:0.0039687384851276875
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688519835472107, gen p mean: -0.24983395636081696, mean p set: 0.44741183519363403
loss_pred:0.015766482800245285, decouple_loss:0.0039819818921387196
The modified gen p mean: 0.4489120543003082, gen p mean: -0.24431051313877106, mean p set: 0.44948315620422363
loss_pred:0.0157835241407156, decouple_loss:0.004003061912953854
The modified gen p mean: 0.4472951292991638, gen p mean: -0.2510790228843689, mean p set: 0.44786572456359863
loss_pred:0.01538502611219883, decouple_loss:0.003984075039625168
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714951515197754, gen p mean: -0.24867485463619232, mean p set: 0.4476757347583771
loss_pred:0.015977108851075172, decouple_loss:0.003970680758357048
The modified gen p mean: 0.44821804761886597, gen p mean: -0.2514811158180237, mean p set: 0.44880014657974243
loss_pred:0.015323168598115444, decouple_loss:0.003928522579371929
The modified gen p mean: 0.4471876919269562, gen p mean: -0.24825866520404816, mean p set: 0.447760671377182
loss_pred:0.015924997627735138, decouple_loss:0.004027058836072683
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756466150283813, gen p mean: -0.24944351613521576, mean p set: 0.4481406807899475
loss_pred:0.015921052545309067, decouple_loss:0.004309311509132385
The modified gen p mean: 0.4471700191497803, gen p mean: -0.2501714527606964, mean p set: 0.4477404057979584The modified gen p mean: 0.44836699962615967, gen p mean: -0.24739901721477509, mean p set: 0.4488963484764099
loss_pred:0.016072314232587814, decouple_loss:0.004368997178971767
loss_pred:0.015880923718214035, decouple_loss:0.0044090887531638145
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449227511882782, gen p mean: -0.250241756439209, mean p set: 0.4498105049133301
loss_pred:0.016179149970412254, decouple_loss:0.004021383356302977
The modified gen p mean: 0.45009535551071167, gen p mean: -0.2486155480146408, mean p set: 0.4506722390651703
loss_pred:0.015620678663253784, decouple_loss:0.004051060415804386
The modified gen p mean: 0.4469728171825409, gen p mean: -0.2522347569465637, mean p set: 0.44749414920806885
loss_pred:0.016112713143229485, decouple_loss:0.004210430663079023
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481826424598694, gen p mean: -0.2539585828781128, mean p set: 0.4487580358982086
loss_pred:0.0149686885997653, decouple_loss:0.004069195128977299
The modified gen p mean: 0.4478060305118561, gen p mean: -0.2505960762500763, mean p set: 0.4483746588230133
loss_pred:0.01592855527997017, decouple_loss:0.004128960892558098
The modified gen p mean: 0.44761449098587036, gen p mean: -0.24977029860019684, mean p set: 0.4481384754180908
loss_pred:0.01508462056517601, decouple_loss:0.004084369167685509
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919317960739136, gen p mean: -0.2449045479297638, mean p set: 0.44976967573165894
loss_pred:0.015521835535764694, decouple_loss:0.004156416282057762
The modified gen p mean: 0.4472157657146454, gen p mean: -0.2518118619918823, mean p set: 0.4477921724319458
loss_pred:0.015696756541728973, decouple_loss:0.004138806369155645
The modified gen p mean: 0.4491748511791229, gen p mean: -0.2477150708436966, mean p set: 0.44969815015792847
loss_pred:0.015925055369734764, decouple_loss:0.004048624541610479
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741660356521606, gen p mean: -0.254112184047699, mean p set: 0.44798991084098816
loss_pred:0.015179918147623539, decouple_loss:0.003766099689528346
The modified gen p mean: 0.44630172848701477, gen p mean: -0.24717484414577484, mean p set: 0.4468816816806793
loss_pred:0.01651104725897312, decouple_loss:0.004341823048889637
The modified gen p mean: 0.44688257575035095, gen p mean: -0.2479960322380066, mean p set: 0.44741132855415344
loss_pred:0.016252869740128517, decouple_loss:0.00423981761559844
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446778267621994, gen p mean: -0.2521345317363739, mean p set: 0.4473493695259094
loss_pred:0.01609412021934986, decouple_loss:0.003968936391174793
The modified gen p mean: 0.44695979356765747, gen p mean: -0.24982181191444397, mean p set: 0.44753846526145935
loss_pred:0.016297398135066032, decouple_loss:0.0038641237188130617
The modified gen p mean: 0.44878822565078735, gen p mean: -0.25122788548469543, mean p set: 0.4493098258972168
loss_pred:0.01537747960537672, decouple_loss:0.004142774268984795
2023-04-26 20:46:25 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24505865573883057, mean p set: 0.4499112665653229
loss_pred:0.018466288223862648, decouple_loss:0.004035840276628733
The modified gen p mean: 0.448223739862442, gen p mean: -0.24269764125347137, mean p set: 0.44879910349845886
The modified gen p mean: 0.44925040006637573, gen p mean: -0.2455567866563797, mean p set: 0.4498290419578552
loss_pred:0.01845562644302845, decouple_loss:0.003994395490735769
loss_pred:0.018200747668743134, decouple_loss:0.004085978027433157
WV_1_PC_1_EH_0_PS_30, loss: 0.018576158210635185, avg_mse: 0.02732643485069275
current test mse: 0.027326
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648292660713196, gen p mean: -0.24679869413375854, mean p set: 0.44700896739959717
loss_pred:0.016543956473469734, decouple_loss:0.004130850546061993
The modified gen p mean: 0.44565650820732117, gen p mean: -0.24560610949993134, mean p set: 0.44622352719306946
loss_pred:0.017369449138641357, decouple_loss:0.00421362416818738
The modified gen p mean: 0.44650572538375854, gen p mean: -0.2434810996055603, mean p set: 0.4470832645893097
loss_pred:0.016613369807600975, decouple_loss:0.004091749899089336
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621923565864563, gen p mean: -0.23984144628047943, mean p set: 0.44674646854400635
loss_pred:0.016415977850556374, decouple_loss:0.00370682030916214
The modified gen p mean: 0.4457240402698517, gen p mean: -0.24109633266925812, mean p set: 0.4462953209877014
loss_pred:0.01607966423034668, decouple_loss:0.0039419811218976974
The modified gen p mean: 0.44749701023101807, gen p mean: -0.2396751046180725, mean p set: 0.4480704963207245
loss_pred:0.016860436648130417, decouple_loss:0.004432776477187872
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44554588198661804, gen p mean: -0.23675252497196198, mean p set: 0.4460710883140564
loss_pred:0.01652311533689499, decouple_loss:0.003673716215416789
The modified gen p mean: 0.44761765003204346, gen p mean: -0.23691459000110626, mean p set: 0.44819650053977966
loss_pred:0.016440775245428085, decouple_loss:0.0035834037698805332
The modified gen p mean: 0.4473785161972046, gen p mean: -0.24081119894981384, mean p set: 0.4479503035545349
loss_pred:0.015826571732759476, decouple_loss:0.0036059245467185974
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633588194847107, gen p mean: -0.2460128217935562, mean p set: 0.4468649923801422
loss_pred:0.016767771914601326, decouple_loss:0.0039033882785588503
The modified gen p mean: 0.44715097546577454, gen p mean: -0.25200584530830383, mean p set: 0.4477214217185974
loss_pred:0.016517670825123787, decouple_loss:0.0037561438512057066
The modified gen p mean: 0.4469181001186371, gen p mean: -0.2451484352350235, mean p set: 0.44749605655670166
loss_pred:0.016873322427272797, decouple_loss:0.003731820732355118
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476451277732849, gen p mean: -0.24813738465309143, mean p set: 0.44821488857269287
loss_pred:0.01659245416522026, decouple_loss:0.0033816590439528227
The modified gen p mean: 0.4464518129825592, gen p mean: -0.25059837102890015, mean p set: 0.44698208570480347The modified gen p mean: 0.445980042219162, gen p mean: -0.2514022886753082, mean p set: 0.4465586841106415
loss_pred:0.017782937735319138, decouple_loss:0.0034755542874336243
loss_pred:0.016967156901955605, decouple_loss:0.003472841577604413
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731026887893677, gen p mean: -0.25375181436538696, mean p set: 0.447883665561676
loss_pred:0.01779046840965748, decouple_loss:0.003473825752735138
The modified gen p mean: 0.44715189933776855, gen p mean: -0.2526507079601288, mean p set: 0.44772863388061523The modified gen p mean: 0.4473121166229248, gen p mean: -0.25844472646713257, mean p set: 0.4478432536125183
loss_pred:0.016547953709959984, decouple_loss:0.003438110463321209
loss_pred:0.01694711297750473, decouple_loss:0.0034660217352211475
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736334681510925, gen p mean: -0.249716117978096, mean p set: 0.4479365348815918
loss_pred:0.016998982056975365, decouple_loss:0.003258584765717387
The modified gen p mean: 0.4470148980617523, gen p mean: -0.2503904700279236, mean p set: 0.4475901126861572
The modified gen p mean: 0.44690513610839844, gen p mean: -0.2580256164073944, mean p set: 0.44743674993515015
loss_pred:0.016888849437236786, decouple_loss:0.0035280499141663313
loss_pred:0.016389379277825356, decouple_loss:0.003422142006456852
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462099075317383, gen p mean: -0.24710367619991302, mean p set: 0.44678789377212524
loss_pred:0.016077658161520958, decouple_loss:0.0035639340057969093
The modified gen p mean: 0.44649553298950195, gen p mean: -0.246388241648674, mean p set: 0.44702792167663574
loss_pred:0.01656453125178814, decouple_loss:0.0034153324086219072
The modified gen p mean: 0.44616177678108215, gen p mean: -0.24755512177944183, mean p set: 0.4467359483242035
loss_pred:0.016761282458901405, decouple_loss:0.003673983970656991
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464851915836334, gen p mean: -0.24612194299697876, mean p set: 0.44706523418426514
loss_pred:0.016565043479204178, decouple_loss:0.003406781004741788
The modified gen p mean: 0.4461336135864258, gen p mean: -0.23801195621490479, mean p set: 0.446708619594574
loss_pred:0.0166307482868433, decouple_loss:0.0034939588513225317
The modified gen p mean: 0.44694769382476807, gen p mean: -0.24706023931503296, mean p set: 0.4474724233150482
loss_pred:0.016772575676441193, decouple_loss:0.003521449863910675
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474732577800751, gen p mean: -0.24332712590694427, mean p set: 0.4480500817298889
loss_pred:0.015763375908136368, decouple_loss:0.0036332891322672367
The modified gen p mean: 0.44692569971084595, gen p mean: -0.24392670392990112, mean p set: 0.44745466113090515The modified gen p mean: 0.4461478292942047, gen p mean: -0.23819632828235626, mean p set: 0.44672611355781555
loss_pred:0.01712903566658497, decouple_loss:0.003752145217731595
loss_pred:0.01625276356935501, decouple_loss:0.00370426126755774
2023-04-26 20:50:42 testing...
The modified gen p mean: 0.4482288360595703, gen p mean: -0.23473796248435974, mean p set: 0.44879910349845886
loss_pred:0.018422383815050125, decouple_loss:0.003811034606769681
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2370433509349823, mean p set: 0.4499112665653229
loss_pred:0.01838519610464573, decouple_loss:0.004026997834444046
The modified gen p mean: 0.4492568373680115, gen p mean: -0.23739463090896606, mean p set: 0.4498290419578552
loss_pred:0.01802193559706211, decouple_loss:0.003941422328352928
WV_1_PC_1_EH_0_PS_30, loss: 0.018472831696271896, avg_mse: 0.027041416615247726
current test mse: 0.027041
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687214493751526, gen p mean: -0.23541036248207092, mean p set: 0.44745174050331116
loss_pred:0.016768204048275948, decouple_loss:0.004066643305122852
The modified gen p mean: 0.44624897837638855, gen p mean: -0.23684631288051605, mean p set: 0.4468272626399994
loss_pred:0.017189286649227142, decouple_loss:0.00395280821248889
The modified gen p mean: 0.44746437668800354, gen p mean: -0.2349432408809662, mean p set: 0.4479900598526001
loss_pred:0.01714295893907547, decouple_loss:0.003662539878860116
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471721351146698, gen p mean: -0.24171601235866547, mean p set: 0.4476989209651947
loss_pred:0.016684090718626976, decouple_loss:0.0034352492075413465
The modified gen p mean: 0.44556742906570435, gen p mean: -0.23904335498809814, mean p set: 0.4461430609226227
loss_pred:0.017269551753997803, decouple_loss:0.0033153078984469175
The modified gen p mean: 0.44716066122055054, gen p mean: -0.23798838257789612, mean p set: 0.44773682951927185
loss_pred:0.015937332063913345, decouple_loss:0.0033933978993445635
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446635901927948, gen p mean: -0.24357464909553528, mean p set: 0.44716861844062805
loss_pred:0.016297416761517525, decouple_loss:0.003790159709751606
The modified gen p mean: 0.4466873109340668, gen p mean: -0.2449183464050293, mean p set: 0.44726207852363586
loss_pred:0.01642780192196369, decouple_loss:0.0035135173238813877
The modified gen p mean: 0.44696399569511414, gen p mean: -0.24149900674819946, mean p set: 0.4475388824939728
loss_pred:0.015278677456080914, decouple_loss:0.003801875514909625
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756942987442017, gen p mean: -0.23968563973903656, mean p set: 0.4480966627597809
loss_pred:0.016567708924412727, decouple_loss:0.003401669906452298
The modified gen p mean: 0.44664886593818665, gen p mean: -0.24896188080310822, mean p set: 0.44722431898117065
loss_pred:0.016390360891819, decouple_loss:0.0034068746026605368
The modified gen p mean: 0.44655492901802063, gen p mean: -0.24569986760616302, mean p set: 0.4471304714679718
loss_pred:0.016728639602661133, decouple_loss:0.0034648755099624395
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710174202919006, gen p mean: -0.23854488134384155, mean p set: 0.44768035411834717
loss_pred:0.01610965095460415, decouple_loss:0.003544436302036047
The modified gen p mean: 0.44785815477371216, gen p mean: -0.23984618484973907, mean p set: 0.4484312832355499The modified gen p mean: 0.4458613693714142, gen p mean: -0.23982904851436615, mean p set: 0.44638508558273315
loss_pred:0.016442645341157913, decouple_loss:0.0036665990483015776
loss_pred:0.016208026558160782, decouple_loss:0.00376786757260561
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470018744468689, gen p mean: -0.24192796647548676, mean p set: 0.44756782054901123
loss_pred:0.015876350924372673, decouple_loss:0.0032651121728122234
The modified gen p mean: 0.44607803225517273, gen p mean: -0.23957809805870056, mean p set: 0.44659891724586487The modified gen p mean: 0.4466794729232788, gen p mean: -0.24531607329845428, mean p set: 0.44725584983825684
loss_pred:0.015950903296470642, decouple_loss:0.0032133942004293203
loss_pred:0.016575120389461517, decouple_loss:0.003425828879699111
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44662556052207947, gen p mean: -0.241164892911911, mean p set: 0.4472024440765381
loss_pred:0.016526253893971443, decouple_loss:0.00325049483217299
The modified gen p mean: 0.4465698301792145, gen p mean: -0.246326744556427, mean p set: 0.44714680314064026The modified gen p mean: 0.4464866518974304, gen p mean: -0.23988230526447296, mean p set: 0.4470199644565582
loss_pred:0.016529051586985588, decouple_loss:0.0031020361930131912
loss_pred:0.0161848496645689, decouple_loss:0.0032488941214978695
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640976190567017, gen p mean: -0.24809402227401733, mean p set: 0.4469858705997467
loss_pred:0.01662280224263668, decouple_loss:0.003971458412706852
The modified gen p mean: 0.4465179443359375, gen p mean: -0.24737156927585602, mean p set: 0.44709739089012146
loss_pred:0.017129188403487206, decouple_loss:0.003203029278665781
The modified gen p mean: 0.4478008449077606, gen p mean: -0.24933820962905884, mean p set: 0.4483300447463989
loss_pred:0.016577085480093956, decouple_loss:0.003884216072037816
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447512686252594, gen p mean: -0.2510042190551758, mean p set: 0.4480864405632019
loss_pred:0.016235047951340675, decouple_loss:0.0036984062753617764
The modified gen p mean: 0.4463944733142853, gen p mean: -0.25041449069976807, mean p set: 0.44696730375289917
loss_pred:0.016083015128970146, decouple_loss:0.004301226232200861
The modified gen p mean: 0.4459340572357178, gen p mean: -0.2495781034231186, mean p set: 0.4464685022830963
loss_pred:0.01719236746430397, decouple_loss:0.004007915034890175
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742998480796814, gen p mean: -0.2527008354663849, mean p set: 0.4480128884315491
loss_pred:0.017424939200282097, decouple_loss:0.0036060218699276447
The modified gen p mean: 0.44694650173187256, gen p mean: -0.2540398836135864, mean p set: 0.44752398133277893
loss_pred:0.015878397971391678, decouple_loss:0.003394106402993202
The modified gen p mean: 0.44692811369895935, gen p mean: -0.2493395060300827, mean p set: 0.44745591282844543
loss_pred:0.01668749563395977, decouple_loss:0.0032492931932210922
2023-04-26 20:54:08 testing...
The modified gen p mean: 0.4482211470603943, gen p mean: -0.24684956669807434, mean p set: 0.44879910349845886
loss_pred:0.018302587792277336, decouple_loss:0.004148042760789394
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24946491420269012, mean p set: 0.4499112665653229
loss_pred:0.018273670226335526, decouple_loss:0.004511331673711538
The modified gen p mean: 0.44925656914711, gen p mean: -0.25006264448165894, mean p set: 0.4498290419578552
loss_pred:0.017797699198126793, decouple_loss:0.004352044314146042
WV_1_PC_1_EH_0_PS_30, loss: 0.018341509625315666, avg_mse: 0.0268816277384758
current test mse: 0.026882
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481987953186035, gen p mean: -0.25197717547416687, mean p set: 0.4487267732620239
loss_pred:0.01669722981750965, decouple_loss:0.004760622046887875
The modified gen p mean: 0.4465864896774292, gen p mean: -0.24984946846961975, mean p set: 0.4471592903137207
loss_pred:0.01622934266924858, decouple_loss:0.0038716373965144157
The modified gen p mean: 0.4468255937099457, gen p mean: -0.250251829624176, mean p set: 0.4473989009857178
loss_pred:0.01746763102710247, decouple_loss:0.004438664764165878
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475387632846832, gen p mean: -0.2467772662639618, mean p set: 0.4480628967285156
loss_pred:0.01669887825846672, decouple_loss:0.003849006025120616
The modified gen p mean: 0.4475325345993042, gen p mean: -0.24724943935871124, mean p set: 0.4481140077114105
loss_pred:0.016118066385388374, decouple_loss:0.00382499978877604
The modified gen p mean: 0.4471854567527771, gen p mean: -0.23932869732379913, mean p set: 0.4477604627609253
loss_pred:0.016789982095360756, decouple_loss:0.003900232957676053
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489690065383911, gen p mean: -0.24352571368217468, mean p set: 0.4494958221912384
loss_pred:0.016535405069589615, decouple_loss:0.0043291011825203896
The modified gen p mean: 0.4484218657016754, gen p mean: -0.2418171465396881, mean p set: 0.44899824261665344
loss_pred:0.01645280420780182, decouple_loss:0.004784798715263605
The modified gen p mean: 0.44683241844177246, gen p mean: -0.24387042224407196, mean p set: 0.4474082589149475
loss_pred:0.017541300505399704, decouple_loss:0.004851019475609064
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465703070163727, gen p mean: -0.24626702070236206, mean p set: 0.4471015930175781
loss_pred:0.017401689663529396, decouple_loss:0.004202025942504406
The modified gen p mean: 0.4473879337310791, gen p mean: -0.2390294075012207, mean p set: 0.4479648470878601
loss_pred:0.016413576900959015, decouple_loss:0.003927788697183132
The modified gen p mean: 0.4468650817871094, gen p mean: -0.24369560182094574, mean p set: 0.44744372367858887
loss_pred:0.016566641628742218, decouple_loss:0.004133846610784531
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468575716018677, gen p mean: -0.24053479731082916, mean p set: 0.4474294185638428
loss_pred:0.015687372535467148, decouple_loss:0.004783468786627054
The modified gen p mean: 0.44795671105384827, gen p mean: -0.23907968401908875, mean p set: 0.4484897553920746The modified gen p mean: 0.4476732015609741, gen p mean: -0.2467009276151657, mean p set: 0.4482457637786865
loss_pred:0.01652640663087368, decouple_loss:0.00478016072884202
loss_pred:0.016254179179668427, decouple_loss:0.004691801965236664
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744205474853516, gen p mean: -0.23937389254570007, mean p set: 0.44802284240722656
loss_pred:0.016087500378489494, decouple_loss:0.00394719373434782
The modified gen p mean: 0.4468117356300354, gen p mean: -0.24002666771411896, mean p set: 0.44738900661468506The modified gen p mean: 0.44628942012786865, gen p mean: -0.24632759392261505, mean p set: 0.4468221068382263
loss_pred:0.015899568796157837, decouple_loss:0.004024195950478315
loss_pred:0.0165049210190773, decouple_loss:0.004069409798830748
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480353891849518, gen p mean: -0.23844021558761597, mean p set: 0.44861525297164917
loss_pred:0.016915813088417053, decouple_loss:0.0040348609909415245
The modified gen p mean: 0.4469839930534363, gen p mean: -0.23705385625362396, mean p set: 0.44751542806625366The modified gen p mean: 0.448202908039093, gen p mean: -0.24469056725502014, mean p set: 0.4487859904766083
loss_pred:0.016533534973859787, decouple_loss:0.00397775461897254
loss_pred:0.015795039013028145, decouple_loss:0.004396529868245125
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740843772888184, gen p mean: -0.23942968249320984, mean p set: 0.44798544049263
loss_pred:0.017071375623345375, decouple_loss:0.003761267988011241
The modified gen p mean: 0.4475599229335785, gen p mean: -0.24100974202156067, mean p set: 0.44813334941864014
loss_pred:0.016222843900322914, decouple_loss:0.004144897218793631
The modified gen p mean: 0.44700902700424194, gen p mean: -0.24046334624290466, mean p set: 0.44753316044807434
loss_pred:0.017551260069012642, decouple_loss:0.0038172053173184395
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714727997779846, gen p mean: -0.23895791172981262, mean p set: 0.4477183520793915
loss_pred:0.017560124397277832, decouple_loss:0.0037058850284665823
The modified gen p mean: 0.44822433590888977, gen p mean: -0.2409629076719284, mean p set: 0.448797345161438
loss_pred:0.016613198444247246, decouple_loss:0.004065645858645439
The modified gen p mean: 0.4468505084514618, gen p mean: -0.23523378372192383, mean p set: 0.44737815856933594
loss_pred:0.016301734372973442, decouple_loss:0.003762004664167762
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657260179519653, gen p mean: -0.2399374544620514, mean p set: 0.44714486598968506
loss_pred:0.01550061535090208, decouple_loss:0.0038057989440858364
The modified gen p mean: 0.44682109355926514, gen p mean: -0.2486945390701294, mean p set: 0.4473494589328766The modified gen p mean: 0.44932305812835693, gen p mean: -0.24228788912296295, mean p set: 0.44989389181137085
loss_pred:0.015921099111437798, decouple_loss:0.0038382066413760185
loss_pred:0.017528895288705826, decouple_loss:0.003608152735978365
2023-04-26 20:58:16 testing...
The modified gen p mean: 0.4482296407222748, gen p mean: -0.23944027721881866, mean p set: 0.44879910349845886
loss_pred:0.01843992806971073, decouple_loss:0.0041255950927734375
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24226251244544983, mean p set: 0.4499112665653229
loss_pred:0.018454914912581444, decouple_loss:0.003966630902141333
The modified gen p mean: 0.4492572546005249, gen p mean: -0.2423742562532425, mean p set: 0.4498290419578552
loss_pred:0.017997130751609802, decouple_loss:0.0039244163781404495
WV_1_PC_1_EH_0_PS_30, loss: 0.01849760115146637, avg_mse: 0.027220502495765686
current test mse: 0.027221
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642123579978943, gen p mean: -0.24621225893497467, mean p set: 0.44699788093566895
loss_pred:0.016548870131373405, decouple_loss:0.004040214698761702
The modified gen p mean: 0.4472579061985016, gen p mean: -0.2385866641998291, mean p set: 0.4478318989276886
loss_pred:0.017027756199240685, decouple_loss:0.003699735039845109
The modified gen p mean: 0.4465086758136749, gen p mean: -0.24794568121433258, mean p set: 0.44703981280326843
loss_pred:0.016585180535912514, decouple_loss:0.004025474656373262
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446826308965683, gen p mean: -0.23761004209518433, mean p set: 0.4473569989204407
loss_pred:0.015758085995912552, decouple_loss:0.0036416223738342524
The modified gen p mean: 0.4495144486427307, gen p mean: -0.2395515739917755, mean p set: 0.4500883221626282
loss_pred:0.01571577601134777, decouple_loss:0.0037588172126561403
The modified gen p mean: 0.44762274622917175, gen p mean: -0.23868276178836823, mean p set: 0.44820234179496765
loss_pred:0.016624324023723602, decouple_loss:0.0034599166829138994
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446419358253479, gen p mean: -0.24557529389858246, mean p set: 0.4469473958015442
loss_pred:0.01642610877752304, decouple_loss:0.003674545791000128
The modified gen p mean: 0.44792476296424866, gen p mean: -0.24542394280433655, mean p set: 0.4484971761703491
loss_pred:0.01574021764099598, decouple_loss:0.0037019068840891123
The modified gen p mean: 0.44839203357696533, gen p mean: -0.24458259344100952, mean p set: 0.44897395372390747
loss_pred:0.016350260004401207, decouple_loss:0.003760243533179164
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757765531539917, gen p mean: -0.23754288256168365, mean p set: 0.4481060206890106
loss_pred:0.016809187829494476, decouple_loss:0.0036149893421679735
The modified gen p mean: 0.4478928744792938, gen p mean: -0.23959144949913025, mean p set: 0.44846174120903015
loss_pred:0.0161857008934021, decouple_loss:0.0036343252286314964
The modified gen p mean: 0.4472905993461609, gen p mean: -0.23881769180297852, mean p set: 0.4478605389595032
loss_pred:0.01680324412882328, decouple_loss:0.0035744295455515385
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447501003742218, gen p mean: -0.24308668076992035, mean p set: 0.44807443022727966
loss_pred:0.01577799580991268, decouple_loss:0.0036320609506219625
The modified gen p mean: 0.44675713777542114, gen p mean: -0.24099518358707428, mean p set: 0.44728177785873413The modified gen p mean: 0.44619444012641907, gen p mean: -0.24362604320049286, mean p set: 0.44677209854125977
loss_pred:0.016894640401005745, decouple_loss:0.0035123222041875124
loss_pred:0.016362536698579788, decouple_loss:0.0035328466910868883
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44626322388648987, gen p mean: -0.23853406310081482, mean p set: 0.4468388855457306
loss_pred:0.016528276726603508, decouple_loss:0.0035983535926789045
The modified gen p mean: 0.44920575618743896, gen p mean: -0.23346424102783203, mean p set: 0.4497283697128296The modified gen p mean: 0.44768238067626953, gen p mean: -0.23795881867408752, mean p set: 0.4482575058937073
loss_pred:0.01651807501912117, decouple_loss:0.0036642318591475487
loss_pred:0.0158385057002306, decouple_loss:0.0037906167563050985
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470587968826294, gen p mean: -0.226122185587883, mean p set: 0.4476413428783417
loss_pred:0.016235768795013428, decouple_loss:0.0033463865984231234
The modified gen p mean: 0.44856566190719604, gen p mean: -0.23152363300323486, mean p set: 0.449098140001297The modified gen p mean: 0.4467645585536957, gen p mean: -0.23314714431762695, mean p set: 0.44733917713165283
loss_pred:0.016222545877099037, decouple_loss:0.003355968976393342
loss_pred:0.016332438215613365, decouple_loss:0.0036005103029310703
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465007781982422, gen p mean: -0.2357066124677658, mean p set: 0.4470820426940918
loss_pred:0.016154415905475616, decouple_loss:0.003366251476109028
The modified gen p mean: 0.44695398211479187, gen p mean: -0.23234932124614716, mean p set: 0.44752857089042664
loss_pred:0.01598520204424858, decouple_loss:0.0033742219675332308
The modified gen p mean: 0.44750985503196716, gen p mean: -0.23250830173492432, mean p set: 0.44803139567375183
loss_pred:0.016598127782344818, decouple_loss:0.00304348673671484
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463866055011749, gen p mean: -0.23655898869037628, mean p set: 0.4469609558582306
loss_pred:0.015479166992008686, decouple_loss:0.003836977295577526
The modified gen p mean: 0.44835206866264343, gen p mean: -0.23437081277370453, mean p set: 0.4489316940307617
loss_pred:0.0158909372985363, decouple_loss:0.0035339852329343557
The modified gen p mean: 0.44684186577796936, gen p mean: -0.23921839892864227, mean p set: 0.44736534357070923
loss_pred:0.016918953508138657, decouple_loss:0.003416891908273101
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475386440753937, gen p mean: -0.24014855921268463, mean p set: 0.4481104910373688
loss_pred:0.015818322077393532, decouple_loss:0.0033802692778408527
The modified gen p mean: 0.4465714693069458, gen p mean: -0.23377172648906708, mean p set: 0.4471484422683716
loss_pred:0.015758300200104713, decouple_loss:0.003431023331359029
The modified gen p mean: 0.4483698010444641, gen p mean: -0.2416267991065979, mean p set: 0.44890403747558594
loss_pred:0.016066372394561768, decouple_loss:0.003256584517657757
2023-04-26 21:01:43 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2399713546037674, mean p set: 0.4499112665653229
loss_pred:0.0183342844247818, decouple_loss:0.0037082124035805464
The modified gen p mean: 0.44822394847869873, gen p mean: -0.23716960847377777, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492495656013489, gen p mean: -0.24023321270942688, mean p set: 0.4498290419578552
loss_pred:0.01845540478825569, decouple_loss:0.003719247877597809
loss_pred:0.01798889972269535, decouple_loss:0.0038104664999991655
WV_1_PC_1_EH_0_PS_30, loss: 0.018446829169988632, avg_mse: 0.0271765049546957
current test mse: 0.027177
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799697399139404, gen p mean: -0.24078427255153656, mean p set: 0.448532372713089
loss_pred:0.016825256869196892, decouple_loss:0.003838958218693733
The modified gen p mean: 0.44592350721359253, gen p mean: -0.2434273511171341, mean p set: 0.4465000033378601
loss_pred:0.016516057774424553, decouple_loss:0.003611186984926462
The modified gen p mean: 0.4461374282836914, gen p mean: -0.23763296008110046, mean p set: 0.44671353697776794
loss_pred:0.017001651227474213, decouple_loss:0.004013661295175552
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461789131164551, gen p mean: -0.24174155294895172, mean p set: 0.4467087388038635
loss_pred:0.017034895718097687, decouple_loss:0.003800151636824012
The modified gen p mean: 0.4466249942779541, gen p mean: -0.24637745320796967, mean p set: 0.4471932351589203
loss_pred:0.01773856207728386, decouple_loss:0.0038709337823092937
The modified gen p mean: 0.4475099444389343, gen p mean: -0.24206049740314484, mean p set: 0.44807806611061096
loss_pred:0.017148582264780998, decouple_loss:0.0038232821971178055
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657254219055176, gen p mean: -0.24101443588733673, mean p set: 0.447105348110199
loss_pred:0.01699060946702957, decouple_loss:0.003940053284168243
The modified gen p mean: 0.44709455966949463, gen p mean: -0.24313682317733765, mean p set: 0.44766902923583984The modified gen p mean: 0.4464397132396698, gen p mean: -0.2442747801542282, mean p set: 0.4470173120498657
loss_pred:0.016648609191179276, decouple_loss:0.003969081211835146
loss_pred:0.016677571460604668, decouple_loss:0.0036825546994805336
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44590261578559875, gen p mean: -0.2422671765089035, mean p set: 0.44643494486808777
loss_pred:0.016693027690052986, decouple_loss:0.00400439091026783
The modified gen p mean: 0.4465580880641937, gen p mean: -0.24080201983451843, mean p set: 0.44713470339775085
loss_pred:0.016936933621764183, decouple_loss:0.0038704858161509037
The modified gen p mean: 0.44741377234458923, gen p mean: -0.23979933559894562, mean p set: 0.4479850232601166
loss_pred:0.01682361401617527, decouple_loss:0.003951834514737129
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462699592113495, gen p mean: -0.23968063294887543, mean p set: 0.44679760932922363
loss_pred:0.017442701384425163, decouple_loss:0.0035248692147433758
The modified gen p mean: 0.4474179148674011, gen p mean: -0.2367589771747589, mean p set: 0.44799020886421204The modified gen p mean: 0.44647178053855896, gen p mean: -0.23918108642101288, mean p set: 0.4470498263835907
loss_pred:0.016301648691296577, decouple_loss:0.0034950459375977516
loss_pred:0.01603076420724392, decouple_loss:0.0034607064444571733
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464641809463501, gen p mean: -0.23858144879341125, mean p set: 0.44704657793045044
loss_pred:0.016858143731951714, decouple_loss:0.003238567616790533
The modified gen p mean: 0.4464222192764282, gen p mean: -0.24020853638648987, mean p set: 0.44695183634757996The modified gen p mean: 0.4475613832473755, gen p mean: -0.23472663760185242, mean p set: 0.44813206791877747
loss_pred:0.016886163502931595, decouple_loss:0.003287184052169323
loss_pred:0.01680530048906803, decouple_loss:0.003435349790379405
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687458872795105, gen p mean: -0.23510804772377014, mean p set: 0.44744786620140076
loss_pred:0.01668853871524334, decouple_loss:0.00357507960870862
The modified gen p mean: 0.44716084003448486, gen p mean: -0.23939882218837738, mean p set: 0.447732150554657The modified gen p mean: 0.446933388710022, gen p mean: -0.2393590807914734, mean p set: 0.4474559724330902
loss_pred:0.01678326725959778, decouple_loss:0.0036759614013135433
loss_pred:0.016512271016836166, decouple_loss:0.0035799071192741394
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475216865539551, gen p mean: -0.24225343763828278, mean p set: 0.44809842109680176
loss_pred:0.016758548095822334, decouple_loss:0.0032492931932210922
The modified gen p mean: 0.4459800720214844, gen p mean: -0.24092312157154083, mean p set: 0.44655176997184753
loss_pred:0.017428996041417122, decouple_loss:0.003054720116779208
The modified gen p mean: 0.4454266130924225, gen p mean: -0.24540190398693085, mean p set: 0.44596222043037415
loss_pred:0.01674441620707512, decouple_loss:0.003198599210008979
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455041289329529, gen p mean: -0.24785101413726807, mean p set: 0.4460800588130951
loss_pred:0.016486264765262604, decouple_loss:0.0035367384552955627
The modified gen p mean: 0.44729939103126526, gen p mean: -0.24137581884860992, mean p set: 0.44787484407424927
loss_pred:0.0162961408495903, decouple_loss:0.00352876796387136
The modified gen p mean: 0.4465004503726959, gen p mean: -0.2434157431125641, mean p set: 0.44702646136283875
loss_pred:0.016341621056199074, decouple_loss:0.0036801155656576157
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44565850496292114, gen p mean: -0.24393223226070404, mean p set: 0.4462362825870514
loss_pred:0.01618889719247818, decouple_loss:0.0029191712383180857
The modified gen p mean: 0.4477440416812897, gen p mean: -0.2446414828300476, mean p set: 0.448323518037796
loss_pred:0.016891030594706535, decouple_loss:0.003132276702672243
The modified gen p mean: 0.4472266733646393, gen p mean: -0.24656778573989868, mean p set: 0.44775912165641785
loss_pred:0.017297353595495224, decouple_loss:0.003233004128560424
2023-04-26 21:05:59 testing...
The modified gen p mean: 0.4482184052467346, gen p mean: -0.24330167472362518, mean p set: 0.44879910349845886
loss_pred:0.018322698771953583, decouple_loss:0.003424327354878187
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2457447350025177, mean p set: 0.4499112665653229
loss_pred:0.018309082835912704, decouple_loss:0.0032623657025396824
The modified gen p mean: 0.44925040006637573, gen p mean: -0.2459249347448349, mean p set: 0.4498290419578552
loss_pred:0.017826316878199577, decouple_loss:0.0033988754730671644
WV_1_PC_1_EH_0_PS_30, loss: 0.01832079142332077, avg_mse: 0.026963718235492706
current test mse: 0.026964
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464104175567627, gen p mean: -0.2494889199733734, mean p set: 0.4469846189022064
loss_pred:0.01727510243654251, decouple_loss:0.003271276829764247
The modified gen p mean: 0.44609856605529785, gen p mean: -0.24512545764446259, mean p set: 0.44667407870292664
loss_pred:0.017239727079868317, decouple_loss:0.0031059710308909416
The modified gen p mean: 0.4457845985889435, gen p mean: -0.24277722835540771, mean p set: 0.4463140368461609
loss_pred:0.016486842185258865, decouple_loss:0.0033753651659935713
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836533069610596, gen p mean: -0.2482127845287323, mean p set: 0.44888943433761597
loss_pred:0.016589822247624397, decouple_loss:0.003296738490462303
The modified gen p mean: 0.44611620903015137, gen p mean: -0.24574410915374756, mean p set: 0.44669607281684875
loss_pred:0.015999995172023773, decouple_loss:0.0033897128887474537
The modified gen p mean: 0.44734159111976624, gen p mean: -0.24846318364143372, mean p set: 0.447918564081192
loss_pred:0.01600285805761814, decouple_loss:0.003486047498881817
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457817077636719, gen p mean: -0.25348594784736633, mean p set: 0.44631776213645935
loss_pred:0.016276052221655846, decouple_loss:0.0033978524152189493
The modified gen p mean: 0.44784751534461975, gen p mean: -0.24974028766155243, mean p set: 0.4484235644340515
loss_pred:0.016191788017749786, decouple_loss:0.0034760027192533016
The modified gen p mean: 0.44635552167892456, gen p mean: -0.25033727288246155, mean p set: 0.4469307065010071
loss_pred:0.017912551760673523, decouple_loss:0.0034320582635700703
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44524192810058594, gen p mean: -0.24520675837993622, mean p set: 0.4457741975784302
loss_pred:0.01626626029610634, decouple_loss:0.0034916051663458347
The modified gen p mean: 0.4466685354709625, gen p mean: -0.2394772469997406, mean p set: 0.4472399353981018
loss_pred:0.016832562163472176, decouple_loss:0.0036494869273155928
The modified gen p mean: 0.44660502672195435, gen p mean: -0.24935153126716614, mean p set: 0.4471801817417145
loss_pred:0.017413146793842316, decouple_loss:0.003506214590743184
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672447443008423, gen p mean: -0.240708589553833, mean p set: 0.4473114311695099
loss_pred:0.015795277431607246, decouple_loss:0.003244356717914343
The modified gen p mean: 0.4461461901664734, gen p mean: -0.23904478549957275, mean p set: 0.4467202425003052
loss_pred:0.01667332835495472, decouple_loss:0.003140015760436654
The modified gen p mean: 0.44587308168411255, gen p mean: -0.24215446412563324, mean p set: 0.44640329480171204
loss_pred:0.016917701810598373, decouple_loss:0.003008620347827673
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680196046829224, gen p mean: -0.23941165208816528, mean p set: 0.44737792015075684
loss_pred:0.016313672065734863, decouple_loss:0.0032050281297415495
The modified gen p mean: 0.4456334710121155, gen p mean: -0.2355513870716095, mean p set: 0.44616246223449707
The modified gen p mean: 0.4463895559310913, gen p mean: -0.24317394196987152, mean p set: 0.4469722807407379
loss_pred:0.016357457265257835, decouple_loss:0.003044912125915289
loss_pred:0.016707606613636017, decouple_loss:0.0032932681497186422
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469445049762726, gen p mean: -0.23937587440013885, mean p set: 0.44751712679862976
loss_pred:0.016914483159780502, decouple_loss:0.0031367104966193438
The modified gen p mean: 0.446353942155838, gen p mean: -0.23854725062847137, mean p set: 0.44692856073379517
loss_pred:0.01592700369656086, decouple_loss:0.002992720576003194
The modified gen p mean: 0.44756948947906494, gen p mean: -0.23844295740127563, mean p set: 0.4480991065502167
loss_pred:0.016516204923391342, decouple_loss:0.0030254574958235025
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466785788536072, gen p mean: -0.23781320452690125, mean p set: 0.44725537300109863
loss_pred:0.01628127321600914, decouple_loss:0.003085432341322303
The modified gen p mean: 0.445954829454422, gen p mean: -0.23998188972473145, mean p set: 0.44653645157814026
loss_pred:0.015549570322036743, decouple_loss:0.0029115041252225637
The modified gen p mean: 0.44797980785369873, gen p mean: -0.24044857919216156, mean p set: 0.44851207733154297
loss_pred:0.01614225283265114, decouple_loss:0.003223828971385956
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458228349685669, gen p mean: -0.23869578540325165, mean p set: 0.4464031159877777
loss_pred:0.01628054678440094, decouple_loss:0.0030213147401809692
The modified gen p mean: 0.44773900508880615, gen p mean: -0.24414917826652527, mean p set: 0.4482622444629669The modified gen p mean: 0.4479258358478546, gen p mean: -0.24132102727890015, mean p set: 0.4484979510307312
loss_pred:0.017009833827614784, decouple_loss:0.003016528906300664
loss_pred:0.016842566430568695, decouple_loss:0.003143757116049528
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644173979759216, gen p mean: -0.24331200122833252, mean p set: 0.4470142424106598
loss_pred:0.01608416996896267, decouple_loss:0.0030630934052169323
The modified gen p mean: 0.44730642437934875, gen p mean: -0.24450504779815674, mean p set: 0.44788745045661926
loss_pred:0.016847645863890648, decouple_loss:0.002953488379716873
The modified gen p mean: 0.4458557963371277, gen p mean: -0.24674946069717407, mean p set: 0.4463808834552765
loss_pred:0.016504183411598206, decouple_loss:0.003028899896889925
2023-04-26 21:09:25 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2435784637928009, mean p set: 0.4499112665653229
loss_pred:0.018510019406676292, decouple_loss:0.0031075438018888235
The modified gen p mean: 0.448223739862442, gen p mean: -0.24114519357681274, mean p set: 0.44879910349845886
loss_pred:0.018615713343024254, decouple_loss:0.003144866554066539
The modified gen p mean: 0.449257493019104, gen p mean: -0.24365629255771637, mean p set: 0.4498290419578552
loss_pred:0.018171461299061775, decouple_loss:0.0031540740747004747
WV_1_PC_1_EH_0_PS_30, loss: 0.018589172512292862, avg_mse: 0.02745296061038971
current test mse: 0.027453
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475339651107788, gen p mean: -0.23978538811206818, mean p set: 0.4480615258216858
loss_pred:0.01594243198633194, decouple_loss:0.003576323390007019
The modified gen p mean: 0.4471761882305145, gen p mean: -0.24467583000659943, mean p set: 0.44775503873825073The modified gen p mean: 0.44692981243133545, gen p mean: -0.23992779850959778, mean p set: 0.4475088119506836
loss_pred:0.016207443550229073, decouple_loss:0.003106907941401005
loss_pred:0.016564011573791504, decouple_loss:0.0036985939368605614
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471108317375183, gen p mean: -0.2391829490661621, mean p set: 0.4476364552974701
loss_pred:0.01669762283563614, decouple_loss:0.003557484829798341
The modified gen p mean: 0.4478808045387268, gen p mean: -0.24411185085773468, mean p set: 0.44845813512802124The modified gen p mean: 0.4475736916065216, gen p mean: -0.2360062152147293, mean p set: 0.44814783334732056
loss_pred:0.015423063188791275, decouple_loss:0.003418455831706524loss_pred:0.015916727483272552, decouple_loss:0.0034111721906811
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477379024028778, gen p mean: -0.23238901793956757, mean p set: 0.4482676684856415
loss_pred:0.016096534207463264, decouple_loss:0.003302154364064336
The modified gen p mean: 0.4484420418739319, gen p mean: -0.2294432371854782, mean p set: 0.4490176737308502
loss_pred:0.016232386231422424, decouple_loss:0.003228577319532633
The modified gen p mean: 0.44820764660835266, gen p mean: -0.23178641498088837, mean p set: 0.4487749934196472
loss_pred:0.016256725415587425, decouple_loss:0.003196301404386759
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485859274864197, gen p mean: -0.23225688934326172, mean p set: 0.4491144120693207
loss_pred:0.016214586794376373, decouple_loss:0.0035380530171096325
The modified gen p mean: 0.44743743538856506, gen p mean: -0.238557368516922, mean p set: 0.4480154812335968
loss_pred:0.015846874564886093, decouple_loss:0.003212681971490383
The modified gen p mean: 0.44787687063217163, gen p mean: -0.2334565669298172, mean p set: 0.44845467805862427
loss_pred:0.015378599986433983, decouple_loss:0.0033689115662127733
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489804208278656, gen p mean: -0.23032942414283752, mean p set: 0.4495594799518585
loss_pred:0.01574167236685753, decouple_loss:0.003620029892772436
The modified gen p mean: 0.4472164213657379, gen p mean: -0.24065522849559784, mean p set: 0.4477936327457428
loss_pred:0.015644656494259834, decouple_loss:0.0032176191452890635
The modified gen p mean: 0.44700729846954346, gen p mean: -0.24295483529567719, mean p set: 0.44753962755203247
loss_pred:0.015774648636579514, decouple_loss:0.00336620700545609
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475938379764557, gen p mean: -0.2421691119670868, mean p set: 0.44816869497299194
loss_pred:0.016612086445093155, decouple_loss:0.003298013238236308
The modified gen p mean: 0.4465944468975067, gen p mean: -0.23586708307266235, mean p set: 0.4471684396266937The modified gen p mean: 0.44780758023262024, gen p mean: -0.23504018783569336, mean p set: 0.4483305513858795
loss_pred:0.01659112609922886, decouple_loss:0.003830872941762209
loss_pred:0.016757642850279808, decouple_loss:0.003871228313073516
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794803857803345, gen p mean: -0.2306278645992279, mean p set: 0.4485217034816742
loss_pred:0.015825331211090088, decouple_loss:0.003909800201654434
The modified gen p mean: 0.4477096498012543, gen p mean: -0.2303447276353836, mean p set: 0.4482842683792114The modified gen p mean: 0.4472792148590088, gen p mean: -0.2381727397441864, mean p set: 0.44780364632606506
loss_pred:0.016494503244757652, decouple_loss:0.003996990621089935
loss_pred:0.016450071707367897, decouple_loss:0.0036234105937182903
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476375877857208, gen p mean: -0.2329661101102829, mean p set: 0.44821614027023315
loss_pred:0.01633627898991108, decouple_loss:0.003272682661190629
The modified gen p mean: 0.44801411032676697, gen p mean: -0.23519091308116913, mean p set: 0.4485950767993927
loss_pred:0.01588493213057518, decouple_loss:0.00319138215854764
The modified gen p mean: 0.44745248556137085, gen p mean: -0.2298160046339035, mean p set: 0.44798195362091064
loss_pred:0.01590169034898281, decouple_loss:0.0033308793790638447
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480290412902832, gen p mean: -0.2327612340450287, mean p set: 0.44860655069351196
loss_pred:0.015310641378164291, decouple_loss:0.00337371532805264
The modified gen p mean: 0.4468061029911041, gen p mean: -0.24036304652690887, mean p set: 0.4473792016506195
loss_pred:0.01593681052327156, decouple_loss:0.0033680498600006104
The modified gen p mean: 0.4475302994251251, gen p mean: -0.2377113252878189, mean p set: 0.44805845618247986
loss_pred:0.015828972682356834, decouple_loss:0.0033120333682745695
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702044129371643, gen p mean: -0.23480741679668427, mean p set: 0.4475933611392975
loss_pred:0.016510171815752983, decouple_loss:0.003351454855874181
The modified gen p mean: 0.4467318058013916, gen p mean: -0.24071207642555237, mean p set: 0.4473148286342621The modified gen p mean: 0.4480590522289276, gen p mean: -0.24011127650737762, mean p set: 0.44859078526496887
loss_pred:0.01600361056625843, decouple_loss:0.003111098660156131
loss_pred:0.01524088904261589, decouple_loss:0.0032698954455554485
2023-04-26 21:13:40 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24087406694889069, mean p set: 0.4499112665653229
loss_pred:0.018461771309375763, decouple_loss:0.0034166802652180195
The modified gen p mean: 0.44822072982788086, gen p mean: -0.23781700432300568, mean p set: 0.44879910349845886
loss_pred:0.018484624102711678, decouple_loss:0.0034097135066986084
The modified gen p mean: 0.44925057888031006, gen p mean: -0.24046331644058228, mean p set: 0.4498290419578552
loss_pred:0.018054012209177017, decouple_loss:0.0034338622353971004
WV_1_PC_1_EH_0_PS_30, loss: 0.018504474312067032, avg_mse: 0.027244240045547485
current test mse: 0.027244
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694453477859497, gen p mean: -0.24003469944000244, mean p set: 0.4475235044956207
loss_pred:0.015995223075151443, decouple_loss:0.003261442994698882
The modified gen p mean: 0.4485400319099426, gen p mean: -0.23509430885314941, mean p set: 0.4491148293018341
loss_pred:0.015812918543815613, decouple_loss:0.003446498652920127
The modified gen p mean: 0.4470899999141693, gen p mean: -0.23634861409664154, mean p set: 0.4476158618927002
loss_pred:0.016366804018616676, decouple_loss:0.0035883302334696054
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770485162734985, gen p mean: -0.23962853848934174, mean p set: 0.44822585582733154
loss_pred:0.016312867403030396, decouple_loss:0.0032937433570623398
The modified gen p mean: 0.4477914869785309, gen p mean: -0.24490845203399658, mean p set: 0.4483700692653656
loss_pred:0.015354572795331478, decouple_loss:0.0032219309359788895
The modified gen p mean: 0.44707998633384705, gen p mean: -0.24652451276779175, mean p set: 0.4476613700389862
loss_pred:0.015853701159358025, decouple_loss:0.003287825034931302
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733738899230957, gen p mean: -0.24549321830272675, mean p set: 0.4478708505630493
loss_pred:0.015449641272425652, decouple_loss:0.0032669901847839355
The modified gen p mean: 0.4475616216659546, gen p mean: -0.24646082520484924, mean p set: 0.44813597202301025
loss_pred:0.016326015815138817, decouple_loss:0.0032783173955976963
The modified gen p mean: 0.4493862986564636, gen p mean: -0.2383827567100525, mean p set: 0.4499603509902954
loss_pred:0.015491358004510403, decouple_loss:0.003572044661268592
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490431845188141, gen p mean: -0.23748058080673218, mean p set: 0.4495725929737091
loss_pred:0.01629743166267872, decouple_loss:0.003440511180087924
The modified gen p mean: 0.4475496709346771, gen p mean: -0.24640390276908875, mean p set: 0.44812917709350586
loss_pred:0.016563089564442635, decouple_loss:0.003369356505572796
The modified gen p mean: 0.44710904359817505, gen p mean: -0.2472439408302307, mean p set: 0.44768205285072327
loss_pred:0.01697448268532753, decouple_loss:0.00336145656183362
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760334491729736, gen p mean: -0.24972575902938843, mean p set: 0.4481755197048187
loss_pred:0.015376540832221508, decouple_loss:0.0030773181933909655
The modified gen p mean: 0.44741982221603394, gen p mean: -0.2409510612487793, mean p set: 0.4479523003101349The modified gen p mean: 0.4466988146305084, gen p mean: -0.24665115773677826, mean p set: 0.4472792148590088
loss_pred:0.016340821981430054, decouple_loss:0.0033884034492075443loss_pred:0.01616440899670124, decouple_loss:0.0032750817481428385
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731560349464417, gen p mean: -0.2391698807477951, mean p set: 0.4478912055492401
loss_pred:0.016885709017515182, decouple_loss:0.003197961952537298
The modified gen p mean: 0.4486064314842224, gen p mean: -0.24163611233234406, mean p set: 0.44918543100357056The modified gen p mean: 0.4473058879375458, gen p mean: -0.24297094345092773, mean p set: 0.44783204793930054
loss_pred:0.01529062632471323, decouple_loss:0.003296648385003209
loss_pred:0.01595856249332428, decouple_loss:0.0032028646674007177
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480653405189514, gen p mean: -0.244707852602005, mean p set: 0.4486410617828369
loss_pred:0.01563640683889389, decouple_loss:0.0031246005091816187
The modified gen p mean: 0.44784173369407654, gen p mean: -0.24040867388248444, mean p set: 0.44842052459716797
loss_pred:0.01579509861767292, decouple_loss:0.0030828744638711214
The modified gen p mean: 0.447836309671402, gen p mean: -0.2408614605665207, mean p set: 0.44836780428886414
loss_pred:0.017158620059490204, decouple_loss:0.0033585825003683567
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464401602745056, gen p mean: -0.23926618695259094, mean p set: 0.44701725244522095
loss_pred:0.016193849965929985, decouple_loss:0.0035948632284998894
The modified gen p mean: 0.4484836757183075, gen p mean: -0.2392045557498932, mean p set: 0.44905948638916016
loss_pred:0.016447627916932106, decouple_loss:0.0034032731782644987
The modified gen p mean: 0.4495790898799896, gen p mean: -0.24106155335903168, mean p set: 0.45010778307914734
loss_pred:0.015373483300209045, decouple_loss:0.0037308528553694487
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480588436126709, gen p mean: -0.24357417225837708, mean p set: 0.44863179326057434
loss_pred:0.015279156155884266, decouple_loss:0.003212476149201393
The modified gen p mean: 0.44771432876586914, gen p mean: -0.23715583980083466, mean p set: 0.44824254512786865
loss_pred:0.01658899150788784, decouple_loss:0.003450185526162386
The modified gen p mean: 0.4475979804992676, gen p mean: -0.2425573617219925, mean p set: 0.4481693506240845
loss_pred:0.01551635842770338, decouple_loss:0.0032527483999729156
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471141993999481, gen p mean: -0.24344316124916077, mean p set: 0.4476836025714874
loss_pred:0.01509673148393631, decouple_loss:0.0032921689562499523
The modified gen p mean: 0.44873204827308655, gen p mean: -0.24856124818325043, mean p set: 0.449308842420578The modified gen p mean: 0.4480326771736145, gen p mean: -0.23932760953903198, mean p set: 0.44856393337249756
loss_pred:0.015198367647826672, decouple_loss:0.0031568806152790785
loss_pred:0.016626503318548203, decouple_loss:0.003478170372545719
2023-04-26 21:17:05 testing...
The modified gen p mean: 0.4482254385948181, gen p mean: -0.2466563731431961, mean p set: 0.44879910349845886
loss_pred:0.018507566303014755, decouple_loss:0.0033836825750768185
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24991284310817719, mean p set: 0.4499112665653229
loss_pred:0.018461180850863457, decouple_loss:0.0034481424372643232
The modified gen p mean: 0.4492502212524414, gen p mean: -0.24926753342151642, mean p set: 0.4498290419578552
loss_pred:0.01809244602918625, decouple_loss:0.003447648836299777
WV_1_PC_1_EH_0_PS_30, loss: 0.018525056540966034, avg_mse: 0.027349401265382767
current test mse: 0.027349
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477817416191101, gen p mean: -0.2520993649959564, mean p set: 0.4483141601085663
loss_pred:0.015976373106241226, decouple_loss:0.0033105958718806505
The modified gen p mean: 0.44974955916404724, gen p mean: -0.2470439225435257, mean p set: 0.45032650232315063
loss_pred:0.016104651615023613, decouple_loss:0.0032392735593020916
The modified gen p mean: 0.4491097927093506, gen p mean: -0.2506282925605774, mean p set: 0.4496924579143524
loss_pred:0.015951095148921013, decouple_loss:0.0035321235191076994
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470902383327484, gen p mean: -0.2527293562889099, mean p set: 0.44762104749679565
loss_pred:0.01669546216726303, decouple_loss:0.0033529584761708975
The modified gen p mean: 0.44710591435432434, gen p mean: -0.25332412123680115, mean p set: 0.44768157601356506
loss_pred:0.01659783162176609, decouple_loss:0.003171609714627266
The modified gen p mean: 0.448368638753891, gen p mean: -0.25362616777420044, mean p set: 0.448948472738266
loss_pred:0.016808101907372475, decouple_loss:0.003303144359961152
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489494860172272, gen p mean: -0.251134991645813, mean p set: 0.449482798576355
loss_pred:0.016222456470131874, decouple_loss:0.0034490334801375866
The modified gen p mean: 0.4487628936767578, gen p mean: -0.26032915711402893, mean p set: 0.44933804869651794
loss_pred:0.015339339151978493, decouple_loss:0.0035096285864710808
The modified gen p mean: 0.4493151307106018, gen p mean: -0.2592003047466278, mean p set: 0.449893593788147
loss_pred:0.01595340669155121, decouple_loss:0.00332747888751328
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448495477437973, gen p mean: -0.2559177279472351, mean p set: 0.44901934266090393
loss_pred:0.01574062928557396, decouple_loss:0.0032321675680577755
The modified gen p mean: 0.4489094316959381, gen p mean: -0.25757524371147156, mean p set: 0.44948384165763855
loss_pred:0.016727855429053307, decouple_loss:0.0032521970570087433
The modified gen p mean: 0.4487905204296112, gen p mean: -0.2505747377872467, mean p set: 0.4493674635887146
loss_pred:0.016208475455641747, decouple_loss:0.003238031407818198
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790658354759216, gen p mean: -0.2521044611930847, mean p set: 0.4484889805316925
loss_pred:0.01630382426083088, decouple_loss:0.0032636160030961037
The modified gen p mean: 0.4482818841934204, gen p mean: -0.24746017158031464, mean p set: 0.4488604962825775
loss_pred:0.015570406801998615, decouple_loss:0.0036794720217585564
The modified gen p mean: 0.4477793574333191, gen p mean: -0.2524867057800293, mean p set: 0.44830194115638733
loss_pred:0.01669956184923649, decouple_loss:0.0032777050510048866
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476054906845093, gen p mean: -0.24520011246204376, mean p set: 0.4481810927391052
loss_pred:0.016951100900769234, decouple_loss:0.003386744298040867
The modified gen p mean: 0.44862642884254456, gen p mean: -0.2492806315422058, mean p set: 0.4492034912109375
loss_pred:0.01650054007768631, decouple_loss:0.003473927965387702
The modified gen p mean: 0.4483436346054077, gen p mean: -0.24889487028121948, mean p set: 0.44887539744377136
loss_pred:0.016142429783940315, decouple_loss:0.003412349848076701
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447786420583725, gen p mean: -0.24627256393432617, mean p set: 0.44836223125457764
loss_pred:0.016697634011507034, decouple_loss:0.003348051104694605
The modified gen p mean: 0.4474703073501587, gen p mean: -0.2354205846786499, mean p set: 0.44804272055625916
loss_pred:0.015766795724630356, decouple_loss:0.003820649115368724
The modified gen p mean: 0.4474809169769287, gen p mean: -0.24606038630008698, mean p set: 0.4480117857456207
loss_pred:0.016189349815249443, decouple_loss:0.00327822333201766
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485841989517212, gen p mean: -0.2383807897567749, mean p set: 0.4491572082042694
loss_pred:0.015660326927900314, decouple_loss:0.0036931512877345085
The modified gen p mean: 0.44813328981399536, gen p mean: -0.24203035235404968, mean p set: 0.4487088918685913
loss_pred:0.015771489590406418, decouple_loss:0.003661678172647953
The modified gen p mean: 0.4488900601863861, gen p mean: -0.24697265028953552, mean p set: 0.44941920042037964
loss_pred:0.01672257110476494, decouple_loss:0.003350602462887764
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828474521636963, gen p mean: -0.24570712447166443, mean p set: 0.4488602578639984
loss_pred:0.01624995283782482, decouple_loss:0.0033048593904823065
The modified gen p mean: 0.44801706075668335, gen p mean: -0.24158239364624023, mean p set: 0.4485989212989807
loss_pred:0.01675041764974594, decouple_loss:0.0032294397242367268
The modified gen p mean: 0.4497564136981964, gen p mean: -0.24310965836048126, mean p set: 0.4502778649330139
loss_pred:0.01669209636747837, decouple_loss:0.0032378858886659145
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492293894290924, gen p mean: -0.2496863156557083, mean p set: 0.4497983753681183
loss_pred:0.016426371410489082, decouple_loss:0.0036277344916015863
The modified gen p mean: 0.4482642710208893, gen p mean: -0.2439064383506775, mean p set: 0.44884148240089417
loss_pred:0.015334287658333778, decouple_loss:0.003297210205346346
The modified gen p mean: 0.44818115234375, gen p mean: -0.23618878424167633, mean p set: 0.44870755076408386
loss_pred:0.01518298964947462, decouple_loss:0.003400313202291727
2023-04-26 21:21:22 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2511919438838959, mean p set: 0.4499112665653229
loss_pred:0.01846161112189293, decouple_loss:0.0036171837709844112
The modified gen p mean: 0.44822198152542114, gen p mean: -0.24756157398223877, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492532014846802, gen p mean: -0.25071483850479126, mean p set: 0.4498290419578552
loss_pred:0.018482128158211708, decouple_loss:0.003580803517252207
loss_pred:0.018079308792948723, decouple_loss:0.003607002319768071
WV_1_PC_1_EH_0_PS_30, loss: 0.018521100282669067, avg_mse: 0.027333253994584084
current test mse: 0.027333
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876012206077576, gen p mean: -0.24372856318950653, mean p set: 0.44933751225471497
loss_pred:0.01598788984119892, decouple_loss:0.003087213495746255
The modified gen p mean: 0.447902649641037, gen p mean: -0.25098204612731934, mean p set: 0.44847777485847473
loss_pred:0.016949176788330078, decouple_loss:0.0032424970995634794
The modified gen p mean: 0.4472235143184662, gen p mean: -0.25143375992774963, mean p set: 0.4477550983428955
loss_pred:0.016485942527651787, decouple_loss:0.003365534357726574
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945889711380005, gen p mean: -0.26152417063713074, mean p set: 0.4499812126159668
loss_pred:0.015964481979608536, decouple_loss:0.003323109820485115
The modified gen p mean: 0.4495059549808502, gen p mean: -0.2475903183221817, mean p set: 0.45008060336112976
loss_pred:0.015738047659397125, decouple_loss:0.0030565871857106686
The modified gen p mean: 0.4485979974269867, gen p mean: -0.25663483142852783, mean p set: 0.44917547702789307
loss_pred:0.016126081347465515, decouple_loss:0.003086566925048828
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493999183177948, gen p mean: -0.2543738782405853, mean p set: 0.4499293565750122
loss_pred:0.016288837417960167, decouple_loss:0.0032392232678830624
The modified gen p mean: 0.4486533999443054, gen p mean: -0.2503082752227783, mean p set: 0.4492361843585968
loss_pred:0.015420425683259964, decouple_loss:0.0034781326539814472
The modified gen p mean: 0.4488371014595032, gen p mean: -0.2576078176498413, mean p set: 0.4494136571884155
loss_pred:0.01535881869494915, decouple_loss:0.0033797442447394133
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759702682495117, gen p mean: -0.2566070258617401, mean p set: 0.4481314718723297
loss_pred:0.017007751390337944, decouple_loss:0.0034999409690499306
The modified gen p mean: 0.4470883905887604, gen p mean: -0.2553148865699768, mean p set: 0.44766971468925476
loss_pred:0.01674862951040268, decouple_loss:0.0034532235004007816
The modified gen p mean: 0.4474288821220398, gen p mean: -0.25641876459121704, mean p set: 0.44801095128059387
loss_pred:0.016537755727767944, decouple_loss:0.003342948853969574
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487374424934387, gen p mean: -0.2565353810787201, mean p set: 0.449317067861557
loss_pred:0.015753168612718582, decouple_loss:0.0034510442055761814
The modified gen p mean: 0.44802963733673096, gen p mean: -0.2417113184928894, mean p set: 0.4485621154308319The modified gen p mean: 0.4485488533973694, gen p mean: -0.25400081276893616, mean p set: 0.44912344217300415
loss_pred:0.01568656973540783, decouple_loss:0.0036499483976513147
loss_pred:0.014742815867066383, decouple_loss:0.0032566480804234743
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731268286705017, gen p mean: -0.24405205249786377, mean p set: 0.44789305329322815
loss_pred:0.016403282061219215, decouple_loss:0.003427790477871895
The modified gen p mean: 0.44753575325012207, gen p mean: -0.25209248065948486, mean p set: 0.44810163974761963
loss_pred:0.015859918668866158, decouple_loss:0.00327052129432559
The modified gen p mean: 0.44924408197402954, gen p mean: -0.24995459616184235, mean p set: 0.4497707486152649
loss_pred:0.015797995030879974, decouple_loss:0.003199859755113721
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716769456863403, gen p mean: -0.2397204041481018, mean p set: 0.44773876667022705
loss_pred:0.016441041603684425, decouple_loss:0.0034177175257354975
The modified gen p mean: 0.44673022627830505, gen p mean: -0.24069833755493164, mean p set: 0.44730639457702637The modified gen p mean: 0.44808077812194824, gen p mean: -0.23857158422470093, mean p set: 0.4486178159713745
loss_pred:0.01602661982178688, decouple_loss:0.0034649549052119255
loss_pred:0.01629745587706566, decouple_loss:0.0035422248765826225
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478625953197479, gen p mean: -0.24345870316028595, mean p set: 0.4484424889087677
loss_pred:0.01636345311999321, decouple_loss:0.0032786792144179344
The modified gen p mean: 0.4484333395957947, gen p mean: -0.2420445829629898, mean p set: 0.44901350140571594
loss_pred:0.016306931152939796, decouple_loss:0.0034431058447808027
The modified gen p mean: 0.4487270414829254, gen p mean: -0.24085412919521332, mean p set: 0.4492538273334503
loss_pred:0.01616949774324894, decouple_loss:0.0032351247500628233
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773390889167786, gen p mean: -0.24438662827014923, mean p set: 0.4483092129230499
loss_pred:0.015983987599611282, decouple_loss:0.003539430443197489
The modified gen p mean: 0.4477893114089966, gen p mean: -0.2455519288778305, mean p set: 0.44836267828941345
loss_pred:0.016657477244734764, decouple_loss:0.00344036309979856
The modified gen p mean: 0.4485984146595001, gen p mean: -0.24343042075634003, mean p set: 0.4491303265094757
loss_pred:0.01551284734159708, decouple_loss:0.0034303434658795595
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493178427219391, gen p mean: -0.23964868485927582, mean p set: 0.449893057346344
loss_pred:0.01555333286523819, decouple_loss:0.0031023449264466763
The modified gen p mean: 0.44755393266677856, gen p mean: -0.24040250480175018, mean p set: 0.4480784237384796The modified gen p mean: 0.448525995016098, gen p mean: -0.24059049785137177, mean p set: 0.44909700751304626
loss_pred:0.015220949426293373, decouple_loss:0.00310940551571548
loss_pred:0.01648630015552044, decouple_loss:0.003041572403162718
2023-04-26 21:24:48 testing...
The modified gen p mean: 0.4482272267341614, gen p mean: -0.2358020544052124, mean p set: 0.44879910349845886
loss_pred:0.018531594425439835, decouple_loss:0.003452111268416047
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23962265253067017, mean p set: 0.4499112665653229
loss_pred:0.018497085198760033, decouple_loss:0.00380718894302845
The modified gen p mean: 0.4492482841014862, gen p mean: -0.23874279856681824, mean p set: 0.4498290419578552
loss_pred:0.01804943196475506, decouple_loss:0.0035147247835993767
WV_1_PC_1_EH_0_PS_30, loss: 0.018538936972618103, avg_mse: 0.02728048898279667
current test mse: 0.02728
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639086723327637, gen p mean: -0.24394850432872772, mean p set: 0.44691917300224304
loss_pred:0.016611779108643532, decouple_loss:0.0033998433500528336
The modified gen p mean: 0.4489095211029053, gen p mean: -0.23873408138751984, mean p set: 0.449484258890152
loss_pred:0.016102125868201256, decouple_loss:0.0032335314899683
The modified gen p mean: 0.4465077519416809, gen p mean: -0.23178187012672424, mean p set: 0.4470857083797455
loss_pred:0.01714535988867283, decouple_loss:0.003396139480173588
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472164213657379, gen p mean: -0.2375084012746811, mean p set: 0.447747141122818
loss_pred:0.016091452911496162, decouple_loss:0.0031139475759118795
The modified gen p mean: 0.44806161522865295, gen p mean: -0.23856180906295776, mean p set: 0.4486396908760071
loss_pred:0.01621292345225811, decouple_loss:0.003459722036495805
The modified gen p mean: 0.4473443925380707, gen p mean: -0.2428380399942398, mean p set: 0.44791606068611145
loss_pred:0.016137149184942245, decouple_loss:0.003185621462762356
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477035105228424, gen p mean: -0.23648285865783691, mean p set: 0.4482302665710449
loss_pred:0.01569710299372673, decouple_loss:0.004362513776868582
The modified gen p mean: 0.4470372200012207, gen p mean: -0.24134811758995056, mean p set: 0.44761136174201965The modified gen p mean: 0.44669508934020996, gen p mean: -0.24182680249214172, mean p set: 0.4472673535346985
loss_pred:0.016315849497914314, decouple_loss:0.003624690929427743
loss_pred:0.01671741157770157, decouple_loss:0.00378209026530385
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687843322753906, gen p mean: -0.2346571385860443, mean p set: 0.44740498065948486
loss_pred:0.016030166298151016, decouple_loss:0.004087201319634914
The modified gen p mean: 0.4482281506061554, gen p mean: -0.23344017565250397, mean p set: 0.4488039016723633The modified gen p mean: 0.4478825330734253, gen p mean: -0.23217910528182983, mean p set: 0.44846025109291077
loss_pred:0.014964999631047249, decouple_loss:0.004018845502287149
loss_pred:0.01591392420232296, decouple_loss:0.00390660809352994
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474765360355377, gen p mean: -0.23117265105247498, mean p set: 0.4480552673339844
loss_pred:0.015763137489557266, decouple_loss:0.0037795931566506624
The modified gen p mean: 0.44756489992141724, gen p mean: -0.22960346937179565, mean p set: 0.44813862442970276
loss_pred:0.016512589529156685, decouple_loss:0.0036447022575885057
The modified gen p mean: 0.4468209147453308, gen p mean: -0.23883295059204102, mean p set: 0.4473487436771393
loss_pred:0.016478117555379868, decouple_loss:0.003586790757253766
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492533504962921, gen p mean: -0.2276533991098404, mean p set: 0.4498293101787567
loss_pred:0.016168059781193733, decouple_loss:0.004375580698251724
The modified gen p mean: 0.44829368591308594, gen p mean: -0.22868943214416504, mean p set: 0.448875367641449
loss_pred:0.016168298199772835, decouple_loss:0.004718402866274118
The modified gen p mean: 0.44797611236572266, gen p mean: -0.2290724664926529, mean p set: 0.44850608706474304
loss_pred:0.015165655873715878, decouple_loss:0.004349848721176386
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483402371406555, gen p mean: -0.2335216999053955, mean p set: 0.4489155113697052
loss_pred:0.015789739787578583, decouple_loss:0.0034890056122094393
The modified gen p mean: 0.44753581285476685, gen p mean: -0.23015587031841278, mean p set: 0.44810861349105835
loss_pred:0.015710605308413506, decouple_loss:0.00343694887124002
The modified gen p mean: 0.44786307215690613, gen p mean: -0.2330787479877472, mean p set: 0.4483965039253235
loss_pred:0.01586839370429516, decouple_loss:0.0034317842219024897
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785600900650024, gen p mean: -0.23372426629066467, mean p set: 0.4484281837940216
loss_pred:0.016873562708497047, decouple_loss:0.00383337726816535
The modified gen p mean: 0.4468068480491638, gen p mean: -0.22628694772720337, mean p set: 0.44738268852233887
loss_pred:0.016350287944078445, decouple_loss:0.003956503234803677
The modified gen p mean: 0.447221040725708, gen p mean: -0.23010583221912384, mean p set: 0.4477500915527344
loss_pred:0.015858454629778862, decouple_loss:0.003811066970229149
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476828873157501, gen p mean: -0.23844456672668457, mean p set: 0.44826218485832214
loss_pred:0.015524688176810741, decouple_loss:0.0035648762714117765
The modified gen p mean: 0.44783565402030945, gen p mean: -0.2375406175851822, mean p set: 0.44841110706329346
loss_pred:0.016703978180885315, decouple_loss:0.00340778729878366
The modified gen p mean: 0.44734105467796326, gen p mean: -0.23539109528064728, mean p set: 0.4478660821914673
loss_pred:0.015755081549286842, decouple_loss:0.003356360364705324
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44967782497406006, gen p mean: -0.240883469581604, mean p set: 0.45025789737701416
loss_pred:0.01527172140777111, decouple_loss:0.0032563030254095793
The modified gen p mean: 0.44826045632362366, gen p mean: -0.23933756351470947, mean p set: 0.4488346576690674
loss_pred:0.015875864773988724, decouple_loss:0.003255612915381789
The modified gen p mean: 0.447571337223053, gen p mean: -0.24949154257774353, mean p set: 0.4481002688407898
loss_pred:0.016182916238904, decouple_loss:0.0034488681703805923
2023-04-26 21:29:10 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24568015336990356, mean p set: 0.4499112665653229
loss_pred:0.018475955352187157, decouple_loss:0.0037115728482604027
The modified gen p mean: 0.4482249617576599, gen p mean: -0.24197804927825928, mean p set: 0.44879910349845886
loss_pred:0.018448075279593468, decouple_loss:0.0033864080905914307
The modified gen p mean: 0.44924405217170715, gen p mean: -0.24485908448696136, mean p set: 0.4498290419578552
loss_pred:0.017942583188414574, decouple_loss:0.003588467836380005
WV_1_PC_1_EH_0_PS_30, loss: 0.018466979265213013, avg_mse: 0.02722928486764431
current test mse: 0.027229
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938239455223083, gen p mean: -0.24511031806468964, mean p set: 0.4499613046646118
loss_pred:0.015398984774947166, decouple_loss:0.0034521385096013546
The modified gen p mean: 0.4483800530433655, gen p mean: -0.24320676922798157, mean p set: 0.44895458221435547
loss_pred:0.015369286760687828, decouple_loss:0.0032307947985827923
The modified gen p mean: 0.447775661945343, gen p mean: -0.24555212259292603, mean p set: 0.44829997420310974
loss_pred:0.01610066555440426, decouple_loss:0.0032654365058988333
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447466105222702, gen p mean: -0.24938707053661346, mean p set: 0.4479939937591553
loss_pred:0.015724478289484978, decouple_loss:0.0032285479828715324
The modified gen p mean: 0.4488917887210846, gen p mean: -0.2457219958305359, mean p set: 0.4494676887989044
loss_pred:0.01579592004418373, decouple_loss:0.0033903177827596664
The modified gen p mean: 0.4463547468185425, gen p mean: -0.24566754698753357, mean p set: 0.44693389534950256
loss_pred:0.01622699946165085, decouple_loss:0.00344857363961637
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731560349464417, gen p mean: -0.2440880686044693, mean p set: 0.4478446841239929
loss_pred:0.01624210923910141, decouple_loss:0.0031284072902053595
The modified gen p mean: 0.4480040967464447, gen p mean: -0.24289336800575256, mean p set: 0.4485850930213928
loss_pred:0.015187128446996212, decouple_loss:0.0031599472276866436
The modified gen p mean: 0.4470660388469696, gen p mean: -0.24875739216804504, mean p set: 0.4476391673088074
loss_pred:0.015659170225262642, decouple_loss:0.0031482772901654243
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448162704706192, gen p mean: -0.24214838445186615, mean p set: 0.4486897885799408
loss_pred:0.015521476976573467, decouple_loss:0.0032900641672313213
The modified gen p mean: 0.4490818977355957, gen p mean: -0.24042873084545135, mean p set: 0.4496593773365021
loss_pred:0.01511522475630045, decouple_loss:0.0033968978095799685
The modified gen p mean: 0.4468841254711151, gen p mean: -0.23851796984672546, mean p set: 0.4474572539329529
loss_pred:0.015647204592823982, decouple_loss:0.0034954645670950413
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485240876674652, gen p mean: -0.23514798283576965, mean p set: 0.4491024613380432
loss_pred:0.01522059366106987, decouple_loss:0.003132684389129281
The modified gen p mean: 0.448173850774765, gen p mean: -0.23435251414775848, mean p set: 0.44874149560928345
loss_pred:0.0152213703840971, decouple_loss:0.0030972901731729507
The modified gen p mean: 0.44682568311691284, gen p mean: -0.23987872898578644, mean p set: 0.44735386967658997
loss_pred:0.016194509342312813, decouple_loss:0.0031395915430039167
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475806951522827, gen p mean: -0.23909805715084076, mean p set: 0.44815701246261597
loss_pred:0.015952827408909798, decouple_loss:0.003162443870678544
The modified gen p mean: 0.44765597581863403, gen p mean: -0.23881056904792786, mean p set: 0.4482366442680359The modified gen p mean: 0.4461285173892975, gen p mean: -0.2328711450099945, mean p set: 0.44665467739105225
loss_pred:0.015403369441628456, decouple_loss:0.003214929485693574
loss_pred:0.016800932586193085, decouple_loss:0.0031026918441057205
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819268584251404, gen p mean: -0.23890957236289978, mean p set: 0.44876906275749207
loss_pred:0.014897357672452927, decouple_loss:0.003094390034675598
The modified gen p mean: 0.4485253393650055, gen p mean: -0.24687954783439636, mean p set: 0.44905540347099304
The modified gen p mean: 0.4480203688144684, gen p mean: -0.24002911150455475, mean p set: 0.44859424233436584
loss_pred:0.016023064032197, decouple_loss:0.00318958074785769
loss_pred:0.01605706661939621, decouple_loss:0.0032958381343632936
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477008283138275, gen p mean: -0.23871293663978577, mean p set: 0.44827526807785034
loss_pred:0.015974629670381546, decouple_loss:0.003016186412423849
The modified gen p mean: 0.44780975580215454, gen p mean: -0.24276702105998993, mean p set: 0.4483831226825714
loss_pred:0.015518651343882084, decouple_loss:0.0030838951934129
The modified gen p mean: 0.4471611976623535, gen p mean: -0.24010828137397766, mean p set: 0.4476827085018158
loss_pred:0.015700016170740128, decouple_loss:0.003097616136074066
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478730857372284, gen p mean: -0.24397048354148865, mean p set: 0.4484524726867676
loss_pred:0.015791986137628555, decouple_loss:0.0030059674754738808
The modified gen p mean: 0.4479443430900574, gen p mean: -0.24029211699962616, mean p set: 0.4485248327255249
loss_pred:0.0157947838306427, decouple_loss:0.0031295327935367823
The modified gen p mean: 0.44793662428855896, gen p mean: -0.24544470012187958, mean p set: 0.44846752285957336
loss_pred:0.015383911319077015, decouple_loss:0.0031891425605863333
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842398166656494, gen p mean: -0.24379704892635345, mean p set: 0.4489942789077759
loss_pred:0.015353274531662464, decouple_loss:0.0034975700546056032
The modified gen p mean: 0.4465859532356262, gen p mean: -0.24302640557289124, mean p set: 0.44716405868530273
loss_pred:0.015817489475011826, decouple_loss:0.0030439761467278004
The modified gen p mean: 0.44686180353164673, gen p mean: -0.2443811595439911, mean p set: 0.4473954439163208
loss_pred:0.01622849889099598, decouple_loss:0.003111807396635413
2023-04-26 21:32:36 testing...
The modified gen p mean: 0.4482177793979645, gen p mean: -0.23615726828575134, mean p set: 0.44879910349845886
loss_pred:0.01832575350999832, decouple_loss:0.0033162562176585197
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23937135934829712, mean p set: 0.4499112665653229
loss_pred:0.018392406404018402, decouple_loss:0.0035622587893158197
The modified gen p mean: 0.44925299286842346, gen p mean: -0.239219531416893, mean p set: 0.4498290419578552
loss_pred:0.017977695912122726, decouple_loss:0.003465337445959449
WV_1_PC_1_EH_0_PS_30, loss: 0.01840434968471527, avg_mse: 0.02713155932724476
current test mse: 0.027132
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480789601802826, gen p mean: -0.23729708790779114, mean p set: 0.448609322309494
loss_pred:0.018251795321702957, decouple_loss:0.0033068617340177298
The modified gen p mean: 0.4485830068588257, gen p mean: -0.2372797280550003, mean p set: 0.4491656422615051
loss_pred:0.017906449735164642, decouple_loss:0.003404230810701847
The modified gen p mean: 0.45005279779434204, gen p mean: -0.23499904572963715, mean p set: 0.4506319463253021
loss_pred:0.017894349992275238, decouple_loss:0.0034670946188271046
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504035413265228, gen p mean: -0.23338106274604797, mean p set: 0.45092761516571045
loss_pred:0.018070723861455917, decouple_loss:0.0032729392405599356
The modified gen p mean: 0.4503697156906128, gen p mean: -0.2370867133140564, mean p set: 0.4509483277797699
loss_pred:0.01880643144249916, decouple_loss:0.003177303820848465
The modified gen p mean: 0.44923317432403564, gen p mean: -0.23903685808181763, mean p set: 0.4498143792152405
loss_pred:0.01764432154595852, decouple_loss:0.0030600661411881447
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008447766304016, gen p mean: -0.23855659365653992, mean p set: 0.4506154954433441
loss_pred:0.017942195758223534, decouple_loss:0.003386510768905282
The modified gen p mean: 0.4495718479156494, gen p mean: -0.23286603391170502, mean p set: 0.45014673471450806
loss_pred:0.017550623044371605, decouple_loss:0.003566093510016799
The modified gen p mean: 0.4488661587238312, gen p mean: -0.2364981323480606, mean p set: 0.44944941997528076
loss_pred:0.017821261659264565, decouple_loss:0.0034878633450716734
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501495063304901, gen p mean: -0.23118898272514343, mean p set: 0.45067691802978516
loss_pred:0.017843620851635933, decouple_loss:0.0031890044920146465
The modified gen p mean: 0.4511376917362213, gen p mean: -0.23477613925933838, mean p set: 0.4517151713371277
loss_pred:0.01805044896900654, decouple_loss:0.003226273227483034
The modified gen p mean: 0.4505012333393097, gen p mean: -0.23242993652820587, mean p set: 0.4510757029056549
loss_pred:0.018752826377749443, decouple_loss:0.0032101168762892485
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956135749816895, gen p mean: -0.23714299499988556, mean p set: 0.450135201215744
loss_pred:0.016910187900066376, decouple_loss:0.0033825417049229145
The modified gen p mean: 0.44908976554870605, gen p mean: -0.23957939445972443, mean p set: 0.4496159553527832The modified gen p mean: 0.4492315649986267, gen p mean: -0.23999744653701782, mean p set: 0.4498046338558197
loss_pred:0.017669005319476128, decouple_loss:0.0033937154803425074
loss_pred:0.018291987478733063, decouple_loss:0.0035294850822538137
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504276514053345, gen p mean: -0.2423344999551773, mean p set: 0.4510018229484558
loss_pred:0.018731161952018738, decouple_loss:0.0031476079020649195
The modified gen p mean: 0.44937968254089355, gen p mean: -0.23603560030460358, mean p set: 0.44995349645614624
loss_pred:0.01768031157553196, decouple_loss:0.003147656563669443
The modified gen p mean: 0.4493570029735565, gen p mean: -0.2369830310344696, mean p set: 0.44988352060317993
loss_pred:0.016934029757976532, decouple_loss:0.0030245634261518717
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970598816871643, gen p mean: -0.23641741275787354, mean p set: 0.4502823054790497
loss_pred:0.017713233828544617, decouple_loss:0.003198728896677494
The modified gen p mean: 0.4486156404018402, gen p mean: -0.23857173323631287, mean p set: 0.4491916298866272
loss_pred:0.01770496740937233, decouple_loss:0.003061541123315692
The modified gen p mean: 0.4500502049922943, gen p mean: -0.2433672547340393, mean p set: 0.450583815574646
loss_pred:0.018347706645727158, decouple_loss:0.0031696525402367115
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506934881210327, gen p mean: -0.2430264800786972, mean p set: 0.45127072930336
loss_pred:0.018447939306497574, decouple_loss:0.0030407034792006016
The modified gen p mean: 0.44916051626205444, gen p mean: -0.24007749557495117, mean p set: 0.44973650574684143
loss_pred:0.017564067617058754, decouple_loss:0.00311107630841434
The modified gen p mean: 0.4498853385448456, gen p mean: -0.23617394268512726, mean p set: 0.4504148066043854
loss_pred:0.018111305311322212, decouple_loss:0.0031579253263771534
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963014125823975, gen p mean: -0.24474181234836578, mean p set: 0.4502067267894745
loss_pred:0.017285237088799477, decouple_loss:0.0032336371950805187
The modified gen p mean: 0.44946420192718506, gen p mean: -0.24242790043354034, mean p set: 0.4500381648540497
loss_pred:0.01750517450273037, decouple_loss:0.003372717881575227
The modified gen p mean: 0.44930851459503174, gen p mean: -0.24154548346996307, mean p set: 0.4498342275619507
loss_pred:0.017584217712283134, decouple_loss:0.003224500920623541
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506872296333313, gen p mean: -0.2427520900964737, mean p set: 0.4512575566768646
loss_pred:0.01786802150309086, decouple_loss:0.002976535353809595
The modified gen p mean: 0.44956260919570923, gen p mean: -0.24813911318778992, mean p set: 0.4501415491104126
loss_pred:0.017524683848023415, decouple_loss:0.0030877545941621065
The modified gen p mean: 0.44885221123695374, gen p mean: -0.2419576495885849, mean p set: 0.4493815302848816
loss_pred:0.017731638625264168, decouple_loss:0.0030302845407277346
2023-04-26 21:37:06 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24516597390174866, mean p set: 0.4499112665653229
loss_pred:0.017593806609511375, decouple_loss:0.003137590829282999
The modified gen p mean: 0.44822531938552856, gen p mean: -0.24194490909576416, mean p set: 0.44879910349845886
loss_pred:0.017737647518515587, decouple_loss:0.0031865171622484922
The modified gen p mean: 0.4492441713809967, gen p mean: -0.2449931800365448, mean p set: 0.4498290419578552
loss_pred:0.017126385122537613, decouple_loss:0.003139981534332037
WV_1_PC_1_EH_0_PS_30, loss: 0.017643680796027184, avg_mse: 0.02587863802909851
current test mse: 0.025879
At step 490, Best test: 0.025879
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500409662723541, gen p mean: -0.24634185433387756, mean p set: 0.45056453347206116
loss_pred:0.018428176641464233, decouple_loss:0.0030768427532166243
The modified gen p mean: 0.44914788007736206, gen p mean: -0.2418432980775833, mean p set: 0.44972866773605347
loss_pred:0.018361279740929604, decouple_loss:0.0030011676717549562
The modified gen p mean: 0.4493163228034973, gen p mean: -0.2447449415922165, mean p set: 0.44988662004470825
loss_pred:0.017192387953400612, decouple_loss:0.002921212464570999
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485689401626587, gen p mean: -0.24352893233299255, mean p set: 0.4490925073623657
loss_pred:0.018248379230499268, decouple_loss:0.002864658134058118
The modified gen p mean: 0.4506242871284485, gen p mean: -0.24439159035682678, mean p set: 0.4511975646018982
loss_pred:0.017343096435070038, decouple_loss:0.0030805219430476427
The modified gen p mean: 0.44863197207450867, gen p mean: -0.2456892430782318, mean p set: 0.4492048919200897
loss_pred:0.01715068146586418, decouple_loss:0.0028354390524327755
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450126051902771, gen p mean: -0.24683789908885956, mean p set: 0.4506498873233795
loss_pred:0.018226392567157745, decouple_loss:0.0030029015615582466
The modified gen p mean: 0.4492505192756653, gen p mean: -0.24942104518413544, mean p set: 0.4498307406902313
loss_pred:0.017031345516443253, decouple_loss:0.0028083038050681353
The modified gen p mean: 0.4481218159198761, gen p mean: -0.24686068296432495, mean p set: 0.4486955404281616
loss_pred:0.017927197739481926, decouple_loss:0.0027875686064362526
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866102933883667, gen p mean: -0.25413593649864197, mean p set: 0.4491928219795227
loss_pred:0.017455099150538445, decouple_loss:0.0029200916178524494
The modified gen p mean: 0.45024725794792175, gen p mean: -0.25040334463119507, mean p set: 0.4508230984210968
loss_pred:0.017832495272159576, decouple_loss:0.0032158137764781713
The modified gen p mean: 0.44934505224227905, gen p mean: -0.24880824983119965, mean p set: 0.4499199688434601
loss_pred:0.017437970265746117, decouple_loss:0.0029534026980400085
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502871632575989, gen p mean: -0.24176611006259918, mean p set: 0.4508611261844635
loss_pred:0.018301764503121376, decouple_loss:0.0029301848262548447
The modified gen p mean: 0.4500999450683594, gen p mean: -0.24570594727993011, mean p set: 0.45062586665153503The modified gen p mean: 0.44968143105506897, gen p mean: -0.24353061616420746, mean p set: 0.4502556622028351
loss_pred:0.018004586920142174, decouple_loss:0.00268165091983974
loss_pred:0.01796788163483143, decouple_loss:0.0028862901963293552
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489467740058899, gen p mean: -0.24360311031341553, mean p set: 0.44952836632728577
loss_pred:0.017107531428337097, decouple_loss:0.0029652814846485853
The modified gen p mean: 0.4498470425605774, gen p mean: -0.24356935918331146, mean p set: 0.45038241147994995The modified gen p mean: 0.4492506980895996, gen p mean: -0.23825593292713165, mean p set: 0.4498307704925537
loss_pred:0.0181709174066782, decouple_loss:0.003007860854268074
loss_pred:0.017441216856241226, decouple_loss:0.0029583745636045933
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960182905197144, gen p mean: -0.24327459931373596, mean p set: 0.45017993450164795
loss_pred:0.018002230674028397, decouple_loss:0.002918794983997941
The modified gen p mean: 0.45006105303764343, gen p mean: -0.24679185450077057, mean p set: 0.45058757066726685The modified gen p mean: 0.45073071122169495, gen p mean: -0.24573053419589996, mean p set: 0.4513084292411804
loss_pred:0.01819925755262375, decouple_loss:0.0028081757482141256
loss_pred:0.01810036413371563, decouple_loss:0.0027338354848325253
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948869943618774, gen p mean: -0.23880742490291595, mean p set: 0.45006564259529114
loss_pred:0.017459016293287277, decouple_loss:0.0034904859494417906
The modified gen p mean: 0.45015889406204224, gen p mean: -0.2435985803604126, mean p set: 0.45073747634887695
loss_pred:0.018645653501152992, decouple_loss:0.003191141178831458
The modified gen p mean: 0.45023486018180847, gen p mean: -0.23746465146541595, mean p set: 0.4507621228694916
loss_pred:0.01818936876952648, decouple_loss:0.0032217761036008596
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501402974128723, gen p mean: -0.24385590851306915, mean p set: 0.4507182538509369
loss_pred:0.01718185283243656, decouple_loss:0.002860590349882841
The modified gen p mean: 0.4497906267642975, gen p mean: -0.24193693697452545, mean p set: 0.45036831498146057
loss_pred:0.01736566796898842, decouple_loss:0.0030701744835823774
The modified gen p mean: 0.44906070828437805, gen p mean: -0.2391921877861023, mean p set: 0.4495888352394104
loss_pred:0.017497055232524872, decouple_loss:0.0030918018892407417
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450522243976593, gen p mean: -0.2458251267671585, mean p set: 0.451102077960968
loss_pred:0.017592446878552437, decouple_loss:0.003413025988265872
The modified gen p mean: 0.4505910277366638, gen p mean: -0.24630685150623322, mean p set: 0.45116761326789856The modified gen p mean: 0.44981274008750916, gen p mean: -0.24816174805164337, mean p set: 0.4503425657749176
loss_pred:0.018216703087091446, decouple_loss:0.0033023266587406397
loss_pred:0.017436211928725243, decouple_loss:0.0033147644717246294
2023-04-26 21:40:36 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2515255808830261, mean p set: 0.4499112665653229
loss_pred:0.017266882583498955, decouple_loss:0.003066903678700328
The modified gen p mean: 0.4482167363166809, gen p mean: -0.2480017989873886, mean p set: 0.44879910349845886
loss_pred:0.017028866335749626, decouple_loss:0.00297589972615242
The modified gen p mean: 0.4492517411708832, gen p mean: -0.2508387863636017, mean p set: 0.4498290419578552
loss_pred:0.016748223453760147, decouple_loss:0.003038765862584114
WV_1_PC_1_EH_0_PS_30, loss: 0.01716601848602295, avg_mse: 0.025087058544158936
current test mse: 0.025087
At step 500, Best test: 0.025087
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742682576179504, gen p mean: -0.25195181369781494, mean p set: 0.44794782996177673
loss_pred:0.01797836646437645, decouple_loss:0.0032733127009123564
The modified gen p mean: 0.44736507534980774, gen p mean: -0.24686288833618164, mean p set: 0.4479406476020813The modified gen p mean: 0.44742801785469055, gen p mean: -0.24894367158412933, mean p set: 0.4480014741420746
loss_pred:0.016685649752616882, decouple_loss:0.0032890469301491976
loss_pred:0.016906969249248505, decouple_loss:0.003280284348875284
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932821393013, gen p mean: -0.242471843957901, mean p set: 0.44985130429267883
loss_pred:0.01671377755701542, decouple_loss:0.0036395001225173473
The modified gen p mean: 0.4481091797351837, gen p mean: -0.251053124666214, mean p set: 0.4486868679523468
loss_pred:0.01647617109119892, decouple_loss:0.003445964539423585
The modified gen p mean: 0.4484618902206421, gen p mean: -0.24886009097099304, mean p set: 0.4490351974964142
loss_pred:0.0162919070571661, decouple_loss:0.003653657855466008
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473550617694855, gen p mean: -0.2517167329788208, mean p set: 0.4478928744792938
loss_pred:0.01620803214609623, decouple_loss:0.003324534511193633
The modified gen p mean: 0.4476020932197571, gen p mean: -0.2573133409023285, mean p set: 0.448184072971344
loss_pred:0.016947468742728233, decouple_loss:0.00349846831522882
The modified gen p mean: 0.4478434920310974, gen p mean: -0.24939924478530884, mean p set: 0.44841864705085754
loss_pred:0.01672830991446972, decouple_loss:0.0034004056360572577
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44561728835105896, gen p mean: -0.2511850595474243, mean p set: 0.4461473524570465
loss_pred:0.017076682299375534, decouple_loss:0.004228414501994848
The modified gen p mean: 0.4478660225868225, gen p mean: -0.2538023591041565, mean p set: 0.44844329357147217
loss_pred:0.01717253029346466, decouple_loss:0.0036598616279661655
The modified gen p mean: 0.4482674300670624, gen p mean: -0.24922211468219757, mean p set: 0.4488369822502136
loss_pred:0.01669304259121418, decouple_loss:0.003374297171831131
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462522566318512, gen p mean: -0.246432363986969, mean p set: 0.4467865526676178
loss_pred:0.01704239659011364, decouple_loss:0.0035682106390595436
The modified gen p mean: 0.4483148753643036, gen p mean: -0.2468811720609665, mean p set: 0.44889581203460693The modified gen p mean: 0.4476955533027649, gen p mean: -0.2475833147764206, mean p set: 0.44827160239219666
loss_pred:0.017055172473192215, decouple_loss:0.003608836093917489
loss_pred:0.01735367812216282, decouple_loss:0.0033853440545499325
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788989424705505, gen p mean: -0.243229940533638, mean p set: 0.448468953371048
loss_pred:0.016901955008506775, decouple_loss:0.0033405576832592487
The modified gen p mean: 0.4473765194416046, gen p mean: -0.24207767844200134, mean p set: 0.4479483664035797
loss_pred:0.01639079488813877, decouple_loss:0.0032561921980232
The modified gen p mean: 0.44798287749290466, gen p mean: -0.24131783843040466, mean p set: 0.44850867986679077
loss_pred:0.016723524779081345, decouple_loss:0.0034972496796399355
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484853744506836, gen p mean: -0.24046140909194946, mean p set: 0.4490565061569214
loss_pred:0.016168735921382904, decouple_loss:0.003755265614017844
The modified gen p mean: 0.44746968150138855, gen p mean: -0.24084284901618958, mean p set: 0.4480428397655487
loss_pred:0.01563771441578865, decouple_loss:0.003498582635074854
The modified gen p mean: 0.44898805022239685, gen p mean: -0.2398826777935028, mean p set: 0.44951605796813965
loss_pred:0.01625690422952175, decouple_loss:0.003706097137182951
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44632208347320557, gen p mean: -0.24116474390029907, mean p set: 0.44689464569091797
loss_pred:0.016908789053559303, decouple_loss:0.0036801963578909636
The modified gen p mean: 0.445874959230423, gen p mean: -0.242839515209198, mean p set: 0.44645223021507263
loss_pred:0.016881920397281647, decouple_loss:0.0036130226217210293
The modified gen p mean: 0.448419451713562, gen p mean: -0.24337749183177948, mean p set: 0.4489506781101227
loss_pred:0.016831837594509125, decouple_loss:0.0034012787509709597
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481631815433502, gen p mean: -0.23669172823429108, mean p set: 0.4487389624118805
loss_pred:0.016866350546479225, decouple_loss:0.003811855101957917
The modified gen p mean: 0.44793933629989624, gen p mean: -0.24290624260902405, mean p set: 0.4485113322734833
loss_pred:0.01599377579987049, decouple_loss:0.003564774990081787
The modified gen p mean: 0.4491424262523651, gen p mean: -0.23501677811145782, mean p set: 0.44967639446258545
loss_pred:0.01617209054529667, decouple_loss:0.003597561502829194
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483429193496704, gen p mean: -0.24443702399730682, mean p set: 0.448919415473938
loss_pred:0.016541674733161926, decouple_loss:0.003984217997640371
The modified gen p mean: 0.44765615463256836, gen p mean: -0.2549379765987396, mean p set: 0.4482314884662628
loss_pred:0.01670914515852928, decouple_loss:0.0037381071597337723
The modified gen p mean: 0.4471133351325989, gen p mean: -0.24435707926750183, mean p set: 0.44764459133148193
loss_pred:0.016080418601632118, decouple_loss:0.003825486171990633
2023-04-26 21:45:08 testing...
The modified gen p mean: 0.44822388887405396, gen p mean: -0.2487412989139557, mean p set: 0.44879910349845886
loss_pred:0.01702788472175598, decouple_loss:0.0035448898561298847
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25228673219680786, mean p set: 0.4499112665653229
loss_pred:0.01709885336458683, decouple_loss:0.003570033935829997
The modified gen p mean: 0.44924843311309814, gen p mean: -0.2520826458930969, mean p set: 0.4498290419578552
loss_pred:0.016684507951140404, decouple_loss:0.003594242502003908
WV_1_PC_1_EH_0_PS_30, loss: 0.01711556874215603, avg_mse: 0.025026638060808182
current test mse: 0.025027
At step 510, Best test: 0.025027
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471052289009094, gen p mean: -0.24999317526817322, mean p set: 0.4476326107978821
loss_pred:0.016044406220316887, decouple_loss:0.0033351359888911247
The modified gen p mean: 0.448726624250412, gen p mean: -0.24383248388767242, mean p set: 0.44930681586265564
The modified gen p mean: 0.4475315809249878, gen p mean: -0.25311338901519775, mean p set: 0.4481014013290405
loss_pred:0.017006713896989822, decouple_loss:0.003433006349951029
loss_pred:0.01698179729282856, decouple_loss:0.0033723581582307816
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711658358573914, gen p mean: -0.2476264238357544, mean p set: 0.44764280319213867
loss_pred:0.016740309074521065, decouple_loss:0.003771084826439619
The modified gen p mean: 0.44817548990249634, gen p mean: -0.2523510754108429, mean p set: 0.4487598240375519
loss_pred:0.016550354659557343, decouple_loss:0.003715143771842122
The modified gen p mean: 0.44746214151382446, gen p mean: -0.2503458559513092, mean p set: 0.4480399191379547
loss_pred:0.015772074460983276, decouple_loss:0.0034979237243533134
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489215016365051, gen p mean: -0.24905292689800262, mean p set: 0.44944167137145996
loss_pred:0.016262108460068703, decouple_loss:0.003566884435713291
The modified gen p mean: 0.447896808385849, gen p mean: -0.25005751848220825, mean p set: 0.44847002625465393
loss_pred:0.016660507768392563, decouple_loss:0.0033631878904998302
The modified gen p mean: 0.448363721370697, gen p mean: -0.25687554478645325, mean p set: 0.4489421248435974
loss_pred:0.016242116689682007, decouple_loss:0.0036285854876041412
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485571086406708, gen p mean: -0.25547030568122864, mean p set: 0.44908660650253296
loss_pred:0.016398072242736816, decouple_loss:0.0037411425728350878
The modified gen p mean: 0.4471060037612915, gen p mean: -0.2601633667945862, mean p set: 0.44767823815345764
loss_pred:0.016357138752937317, decouple_loss:0.003710746066644788
The modified gen p mean: 0.44829604029655457, gen p mean: -0.2482682168483734, mean p set: 0.4488692581653595
loss_pred:0.01648586057126522, decouple_loss:0.003846991341561079
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472304582595825, gen p mean: -0.24295499920845032, mean p set: 0.44780370593070984
loss_pred:0.01687542535364628, decouple_loss:0.0034422692842781544
The modified gen p mean: 0.4488620460033417, gen p mean: -0.24687713384628296, mean p set: 0.4494354724884033
loss_pred:0.016287533566355705, decouple_loss:0.0034563264343887568
The modified gen p mean: 0.4471367299556732, gen p mean: -0.24755457043647766, mean p set: 0.4476655125617981
loss_pred:0.015575543977320194, decouple_loss:0.003476204350590706
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588637351989746, gen p mean: -0.24711179733276367, mean p set: 0.44645413756370544
loss_pred:0.016129441559314728, decouple_loss:0.0035942760296165943
The modified gen p mean: 0.44715237617492676, gen p mean: -0.24895955622196198, mean p set: 0.4477252662181854The modified gen p mean: 0.4470553994178772, gen p mean: -0.24314145743846893, mean p set: 0.4475817382335663
loss_pred:0.016955792903900146, decouple_loss:0.003686476731672883
loss_pred:0.016496451571583748, decouple_loss:0.003464242210611701
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462697207927704, gen p mean: -0.24121885001659393, mean p set: 0.4468391239643097
loss_pred:0.016380082815885544, decouple_loss:0.0030014561489224434
The modified gen p mean: 0.4471942186355591, gen p mean: -0.2444598525762558, mean p set: 0.44777119159698486
loss_pred:0.01677297241985798, decouple_loss:0.003197320271283388
The modified gen p mean: 0.4486839473247528, gen p mean: -0.23996444046497345, mean p set: 0.4492167532444
loss_pred:0.017083128914237022, decouple_loss:0.0032994160428643227
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769158959388733, gen p mean: -0.2433110773563385, mean p set: 0.44826918840408325
loss_pred:0.01643964648246765, decouple_loss:0.003425368806347251
The modified gen p mean: 0.4480951428413391, gen p mean: -0.24240310490131378, mean p set: 0.4486686885356903
loss_pred:0.01682063192129135, decouple_loss:0.003288054373115301
The modified gen p mean: 0.4453142285346985, gen p mean: -0.2471432089805603, mean p set: 0.44584187865257263
loss_pred:0.016894523054361343, decouple_loss:0.003400714136660099
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811689853668213, gen p mean: -0.24536024034023285, mean p set: 0.44869908690452576
loss_pred:0.01618010923266411, decouple_loss:0.003976604901254177
The modified gen p mean: 0.4458678662776947, gen p mean: -0.2461664080619812, mean p set: 0.4464397132396698
loss_pred:0.016605932265520096, decouple_loss:0.003058644011616707
The modified gen p mean: 0.4468477666378021, gen p mean: -0.24242353439331055, mean p set: 0.4473777115345001
loss_pred:0.017147187143564224, decouple_loss:0.0031203513499349356
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489239454269409, gen p mean: -0.2372802048921585, mean p set: 0.4495036005973816
loss_pred:0.01680488884449005, decouple_loss:0.0032606953755021095
The modified gen p mean: 0.44754505157470703, gen p mean: -0.24757644534111023, mean p set: 0.44812238216400146
loss_pred:0.016637837514281273, decouple_loss:0.003362603485584259
The modified gen p mean: 0.44814151525497437, gen p mean: -0.24531978368759155, mean p set: 0.4486646354198456
loss_pred:0.016028547659516335, decouple_loss:0.0032406484242528677
2023-04-26 21:48:40 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24123629927635193, mean p set: 0.4499112665653229
loss_pred:0.017143139615654945, decouple_loss:0.003945678472518921
The modified gen p mean: 0.44822052121162415, gen p mean: -0.2382841855287552, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492582380771637, gen p mean: -0.24106638133525848, mean p set: 0.4498290419578552
loss_pred:0.017115892842411995, decouple_loss:0.004133225418627262
loss_pred:0.016742398962378502, decouple_loss:0.0041109067387878895
WV_1_PC_1_EH_0_PS_30, loss: 0.017203642055392265, avg_mse: 0.025154119357466698
current test mse: 0.025154
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761091470718384, gen p mean: -0.24205130338668823, mean p set: 0.4481402039527893
loss_pred:0.015931973233819008, decouple_loss:0.004146412014961243
The modified gen p mean: 0.4487108588218689, gen p mean: -0.23503564298152924, mean p set: 0.4492860734462738
loss_pred:0.016053473576903343, decouple_loss:0.004206807818263769
The modified gen p mean: 0.4472472667694092, gen p mean: -0.23446695506572723, mean p set: 0.44782793521881104
loss_pred:0.016707032918930054, decouple_loss:0.003803495317697525
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911012053489685, gen p mean: -0.2456129938364029, mean p set: 0.4496400058269501
loss_pred:0.015817895531654358, decouple_loss:0.003419005312025547
The modified gen p mean: 0.4498584270477295, gen p mean: -0.23425930738449097, mean p set: 0.4504365622997284
loss_pred:0.015158778056502342, decouple_loss:0.0032107664737850428
The modified gen p mean: 0.4480975270271301, gen p mean: -0.24599161744117737, mean p set: 0.44867387413978577
loss_pred:0.016230730339884758, decouple_loss:0.0029630118515342474
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516102969646454, gen p mean: -0.23970313370227814, mean p set: 0.4521370232105255
loss_pred:0.01608143374323845, decouple_loss:0.004245575517416
The modified gen p mean: 0.448099821805954, gen p mean: -0.245519757270813, mean p set: 0.44867774844169617
loss_pred:0.0162577573210001, decouple_loss:0.0036547924391925335
The modified gen p mean: 0.4496644139289856, gen p mean: -0.24155589938163757, mean p set: 0.45023879408836365
loss_pred:0.016344290226697922, decouple_loss:0.0038926200941205025
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480685889720917, gen p mean: -0.245559424161911, mean p set: 0.44859644770622253
loss_pred:0.015685822814702988, decouple_loss:0.0035293763503432274
The modified gen p mean: 0.4484657645225525, gen p mean: -0.24749813973903656, mean p set: 0.44904303550720215
loss_pred:0.016628209501504898, decouple_loss:0.003319960320368409
The modified gen p mean: 0.4480944275856018, gen p mean: -0.24141448736190796, mean p set: 0.44867458939552307
loss_pred:0.01666524074971676, decouple_loss:0.00344548630528152
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448757529258728, gen p mean: -0.25616979598999023, mean p set: 0.4493279755115509
loss_pred:0.014872526749968529, decouple_loss:0.0037584342062473297
The modified gen p mean: 0.4475584626197815, gen p mean: -0.24959880113601685, mean p set: 0.44814345240592957
loss_pred:0.016608351841568947, decouple_loss:0.0034563431981951
The modified gen p mean: 0.44871029257774353, gen p mean: -0.25190746784210205, mean p set: 0.44923779368400574
loss_pred:0.01647428795695305, decouple_loss:0.00328460824675858
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465952515602112, gen p mean: -0.2627089023590088, mean p set: 0.447174608707428
loss_pred:0.016649743542075157, decouple_loss:0.003274876857176423
The modified gen p mean: 0.4468616843223572, gen p mean: -0.2554982602596283, mean p set: 0.447394996881485The modified gen p mean: 0.44717010855674744, gen p mean: -0.2522159814834595, mean p set: 0.447748064994812
loss_pred:0.015701137483119965, decouple_loss:0.0032604183070361614
loss_pred:0.015678852796554565, decouple_loss:0.0032506317365914583
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489879906177521, gen p mean: -0.255918949842453, mean p set: 0.4495624303817749
loss_pred:0.015561637468636036, decouple_loss:0.0035976055078208447
The modified gen p mean: 0.44733405113220215, gen p mean: -0.25917452573776245, mean p set: 0.4479064643383026
loss_pred:0.0160418339073658, decouple_loss:0.003449628595262766
The modified gen p mean: 0.44832098484039307, gen p mean: -0.26000773906707764, mean p set: 0.44884639978408813
loss_pred:0.015894515439867973, decouple_loss:0.0035755850840359926
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478949308395386, gen p mean: -0.2510746121406555, mean p set: 0.44846272468566895
loss_pred:0.014632588252425194, decouple_loss:0.0034730699844658375
The modified gen p mean: 0.44860172271728516, gen p mean: -0.24606913328170776, mean p set: 0.449176549911499
loss_pred:0.016156354919075966, decouple_loss:0.0032450007274746895
The modified gen p mean: 0.4488414227962494, gen p mean: -0.2546035051345825, mean p set: 0.4493709206581116
loss_pred:0.016376918181777, decouple_loss:0.003232948249205947
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702431559562683, gen p mean: -0.24917419254779816, mean p set: 0.4475933015346527
loss_pred:0.01629979908466339, decouple_loss:0.003307055216282606
The modified gen p mean: 0.44830355048179626, gen p mean: -0.2433806210756302, mean p set: 0.4488815367221832
loss_pred:0.017108488827943802, decouple_loss:0.003318078350275755
The modified gen p mean: 0.4488847851753235, gen p mean: -0.2461501955986023, mean p set: 0.4494149386882782
loss_pred:0.01615029014647007, decouple_loss:0.0032852725125849247
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745883345603943, gen p mean: -0.23941205441951752, mean p set: 0.4480287730693817
loss_pred:0.016598153859376907, decouple_loss:0.00335076916962862
The modified gen p mean: 0.45008885860443115, gen p mean: -0.2378448098897934, mean p set: 0.45067334175109863
loss_pred:0.015360014513134956, decouple_loss:0.0036075725220143795
The modified gen p mean: 0.44966864585876465, gen p mean: -0.24992118775844574, mean p set: 0.45020073652267456
loss_pred:0.014932508580386639, decouple_loss:0.003802253631874919
2023-04-26 21:52:57 testing...
The modified gen p mean: 0.4482252597808838, gen p mean: -0.24426670372486115, mean p set: 0.44879910349845886
loss_pred:0.017173856496810913, decouple_loss:0.0032236904371529818
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24787135422229767, mean p set: 0.4499112665653229
loss_pred:0.017311615869402885, decouple_loss:0.0032339938916265965
The modified gen p mean: 0.44925904273986816, gen p mean: -0.24750587344169617, mean p set: 0.4498290419578552
loss_pred:0.0168156735599041, decouple_loss:0.0034067686647176743
WV_1_PC_1_EH_0_PS_30, loss: 0.01726479083299637, avg_mse: 0.02531205490231514
current test mse: 0.025312
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476034343242645, gen p mean: -0.24043512344360352, mean p set: 0.4481779932975769
loss_pred:0.016789494082331657, decouple_loss:0.0032342534977942705
The modified gen p mean: 0.448976069688797, gen p mean: -0.24156033992767334, mean p set: 0.449554443359375
loss_pred:0.015723880380392075, decouple_loss:0.003611995605751872
The modified gen p mean: 0.44974541664123535, gen p mean: -0.24386857450008392, mean p set: 0.4502794146537781
loss_pred:0.016088133677840233, decouple_loss:0.003581191413104534
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488495886325836, gen p mean: -0.24768966436386108, mean p set: 0.4493841528892517
loss_pred:0.015952663496136665, decouple_loss:0.0032336486037820578
The modified gen p mean: 0.4485338032245636, gen p mean: -0.2551671266555786, mean p set: 0.44910797476768494
loss_pred:0.015267464332282543, decouple_loss:0.0032336136791855097
The modified gen p mean: 0.4473342001438141, gen p mean: -0.24707132577896118, mean p set: 0.4479128420352936
loss_pred:0.015551429241895676, decouple_loss:0.003138040192425251
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489014744758606, gen p mean: -0.25688594579696655, mean p set: 0.4494233727455139
loss_pred:0.01602969504892826, decouple_loss:0.0033835286740213633
The modified gen p mean: 0.4473930299282074, gen p mean: -0.25693225860595703, mean p set: 0.4479774832725525
loss_pred:0.015401631593704224, decouple_loss:0.0032906895503401756
The modified gen p mean: 0.4477654695510864, gen p mean: -0.25724971294403076, mean p set: 0.4483363628387451
loss_pred:0.016540121287107468, decouple_loss:0.0032239784486591816
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674310088157654, gen p mean: -0.2592870891094208, mean p set: 0.4472704529762268
loss_pred:0.015725629404187202, decouple_loss:0.00347018800675869
The modified gen p mean: 0.44830256700515747, gen p mean: -0.25634682178497314, mean p set: 0.44887375831604004
loss_pred:0.01684131659567356, decouple_loss:0.0034943714272230864
The modified gen p mean: 0.4485301077365875, gen p mean: -0.2567673325538635, mean p set: 0.44910773634910583
loss_pred:0.015068147331476212, decouple_loss:0.0034346897155046463
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495171010494232, gen p mean: -0.26191771030426025, mean p set: 0.45009157061576843
loss_pred:0.015058253891766071, decouple_loss:0.0033891566563397646
The modified gen p mean: 0.4490277171134949, gen p mean: -0.2670377790927887, mean p set: 0.4496042728424072The modified gen p mean: 0.4483800530433655, gen p mean: -0.25940752029418945, mean p set: 0.44889771938323975
loss_pred:0.014471297152340412, decouple_loss:0.003522448008880019
loss_pred:0.01689310558140278, decouple_loss:0.0029732862021774054
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736161828041077, gen p mean: -0.25530779361724854, mean p set: 0.4478965699672699
loss_pred:0.015944845974445343, decouple_loss:0.003371340688318014
The modified gen p mean: 0.44718536734580994, gen p mean: -0.25892123579978943, mean p set: 0.4477499723434448The modified gen p mean: 0.4506516456604004, gen p mean: -0.25335702300071716, mean p set: 0.45123034715652466
loss_pred:0.01579650491476059, decouple_loss:0.00342777487821877
loss_pred:0.0154055031016469, decouple_loss:0.0035443149972707033
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492599368095398, gen p mean: -0.2551981508731842, mean p set: 0.4498351216316223
loss_pred:0.015589387156069279, decouple_loss:0.0032614795491099358
The modified gen p mean: 0.44750431180000305, gen p mean: -0.2549060881137848, mean p set: 0.44803765416145325The modified gen p mean: 0.44797396659851074, gen p mean: -0.24918775260448456, mean p set: 0.4485572874546051
loss_pred:0.016141479834914207, decouple_loss:0.0031330420169979334
loss_pred:0.015919551253318787, decouple_loss:0.0030719726346433163
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486308991909027, gen p mean: -0.2556234300136566, mean p set: 0.44920656085014343
loss_pred:0.015857094898819923, decouple_loss:0.003424065187573433
The modified gen p mean: 0.44716164469718933, gen p mean: -0.24606013298034668, mean p set: 0.4477371871471405
loss_pred:0.01573294773697853, decouple_loss:0.003067892277613282
The modified gen p mean: 0.44791191816329956, gen p mean: -0.2544747591018677, mean p set: 0.44843384623527527
loss_pred:0.01589854806661606, decouple_loss:0.0031803445890545845
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728994369506836, gen p mean: -0.2472577542066574, mean p set: 0.44786569476127625
loss_pred:0.015464352443814278, decouple_loss:0.0032075883354991674
The modified gen p mean: 0.4483387768268585, gen p mean: -0.25087693333625793, mean p set: 0.44885799288749695
loss_pred:0.015394291840493679, decouple_loss:0.0032475595362484455
The modified gen p mean: 0.44890400767326355, gen p mean: -0.2565014660358429, mean p set: 0.4494871497154236
loss_pred:0.01418477576225996, decouple_loss:0.003727567847818136
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496587812900543, gen p mean: -0.24747484922409058, mean p set: 0.4502353370189667
loss_pred:0.015301534906029701, decouple_loss:0.003195430850610137
The modified gen p mean: 0.44780462980270386, gen p mean: -0.24962644279003143, mean p set: 0.44833314418792725The modified gen p mean: 0.44994473457336426, gen p mean: -0.24769343435764313, mean p set: 0.4505176842212677
loss_pred:0.015118174254894257, decouple_loss:0.0032686463091522455
loss_pred:0.016288302838802338, decouple_loss:0.003241822123527527
2023-04-26 21:56:23 testing...
The modified gen p mean: 0.4482188820838928, gen p mean: -0.2533225119113922, mean p set: 0.44879910349845886
loss_pred:0.017189890146255493, decouple_loss:0.0033587419893592596
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2566295564174652, mean p set: 0.4499112665653229
loss_pred:0.017262738198041916, decouple_loss:0.0034574256278574467
The modified gen p mean: 0.44925203919410706, gen p mean: -0.2565368413925171, mean p set: 0.4498290419578552
loss_pred:0.016905691474676132, decouple_loss:0.0035259348805993795
WV_1_PC_1_EH_0_PS_30, loss: 0.017291810363531113, avg_mse: 0.025330644100904465
current test mse: 0.025331
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737714529037476, gen p mean: -0.25317174196243286, mean p set: 0.44789719581604004
loss_pred:0.016252022236585617, decouple_loss:0.0033505833707749844
The modified gen p mean: 0.4477917551994324, gen p mean: -0.2589475214481354, mean p set: 0.44836533069610596
loss_pred:0.016650913283228874, decouple_loss:0.0032441038638353348
The modified gen p mean: 0.44739553332328796, gen p mean: -0.2600645124912262, mean p set: 0.4479837417602539
loss_pred:0.016727425158023834, decouple_loss:0.003317159367725253
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480147659778595, gen p mean: -0.2550106942653656, mean p set: 0.44854387640953064
loss_pred:0.016416175290942192, decouple_loss:0.003251691348850727
The modified gen p mean: 0.44770219922065735, gen p mean: -0.2557259500026703, mean p set: 0.44828298687934875
loss_pred:0.016680678352713585, decouple_loss:0.0031750232446938753
The modified gen p mean: 0.44781866669654846, gen p mean: -0.2559290826320648, mean p set: 0.44839832186698914
loss_pred:0.016221322119235992, decouple_loss:0.0033979418221861124
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723188877105713, gen p mean: -0.2541464567184448, mean p set: 0.4477587640285492
loss_pred:0.016532914713025093, decouple_loss:0.00328616751357913
The modified gen p mean: 0.4480966627597809, gen p mean: -0.25489187240600586, mean p set: 0.4486706554889679
loss_pred:0.015759862959384918, decouple_loss:0.003321622498333454
The modified gen p mean: 0.4477841258049011, gen p mean: -0.25561070442199707, mean p set: 0.4483576714992523
loss_pred:0.01675679348409176, decouple_loss:0.0032073799520730972
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475940763950348, gen p mean: -0.2512854337692261, mean p set: 0.4481166899204254
loss_pred:0.016677575185894966, decouple_loss:0.0028866506181657314
The modified gen p mean: 0.44831356406211853, gen p mean: -0.24839559197425842, mean p set: 0.44889721274375916
loss_pred:0.01587790809571743, decouple_loss:0.0029895335901528597
The modified gen p mean: 0.4478124678134918, gen p mean: -0.2498687356710434, mean p set: 0.44838589429855347
loss_pred:0.016907066106796265, decouple_loss:0.0029383357614278793
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485931992530823, gen p mean: -0.24824267625808716, mean p set: 0.4491655230522156
loss_pred:0.016129232943058014, decouple_loss:0.0032134244684129953
The modified gen p mean: 0.4487134516239166, gen p mean: -0.24790994822978973, mean p set: 0.44928398728370667
loss_pred:0.016832677647471428, decouple_loss:0.0032405066303908825
The modified gen p mean: 0.4476637840270996, gen p mean: -0.25636202096939087, mean p set: 0.44819343090057373
loss_pred:0.016378354281187057, decouple_loss:0.0031761713325977325
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802477955818176, gen p mean: -0.25253671407699585, mean p set: 0.4485950171947479
loss_pred:0.016901720315217972, decouple_loss:0.0031358636915683746
The modified gen p mean: 0.4476396143436432, gen p mean: -0.2573651671409607, mean p set: 0.4482157230377197The modified gen p mean: 0.4480217397212982, gen p mean: -0.2508711814880371, mean p set: 0.4485490918159485
loss_pred:0.016210926696658134, decouple_loss:0.003073431085795164
loss_pred:0.017202820628881454, decouple_loss:0.003256712108850479
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801899790763855, gen p mean: -0.2502138614654541, mean p set: 0.44859370589256287
loss_pred:0.01628151535987854, decouple_loss:0.003060227958485484
The modified gen p mean: 0.44724375009536743, gen p mean: -0.25858163833618164, mean p set: 0.44776955246925354The modified gen p mean: 0.44834956526756287, gen p mean: -0.25021541118621826, mean p set: 0.44892874360084534
loss_pred:0.016012614592909813, decouple_loss:0.003002529963850975
loss_pred:0.016205498948693275, decouple_loss:0.002883920446038246
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744983315467834, gen p mean: -0.25635865330696106, mean p set: 0.44802939891815186
loss_pred:0.016602084040641785, decouple_loss:0.0030788227450102568
The modified gen p mean: 0.4490683376789093, gen p mean: -0.2522335350513458, mean p set: 0.4496433436870575
loss_pred:0.01627929136157036, decouple_loss:0.0030344633851200342
The modified gen p mean: 0.4477428197860718, gen p mean: -0.25358161330223083, mean p set: 0.44826412200927734
loss_pred:0.016517817974090576, decouple_loss:0.0031465436331927776
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742003083229065, gen p mean: -0.2539841830730438, mean p set: 0.4479960799217224
loss_pred:0.0164597537368536, decouple_loss:0.00291613582521677
The modified gen p mean: 0.44751518964767456, gen p mean: -0.25596824288368225, mean p set: 0.448095440864563
loss_pred:0.015818461775779724, decouple_loss:0.003138208296149969
The modified gen p mean: 0.4487438499927521, gen p mean: -0.258227676153183, mean p set: 0.44926151633262634
loss_pred:0.016132395714521408, decouple_loss:0.0031368264462798834
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823598861694336, gen p mean: -0.25116655230522156, mean p set: 0.4488089084625244
loss_pred:0.016428139060735703, decouple_loss:0.0029804387595504522
The modified gen p mean: 0.4481845796108246, gen p mean: -0.25024983286857605, mean p set: 0.4487065374851227The modified gen p mean: 0.447738915681839, gen p mean: -0.25205621123313904, mean p set: 0.4483139216899872
loss_pred:0.01608123630285263, decouple_loss:0.0029630367644131184
loss_pred:0.015829328447580338, decouple_loss:0.00302769779227674
2023-04-26 22:00:30 testing...
The modified gen p mean: 0.4482208490371704, gen p mean: -0.25110241770744324, mean p set: 0.44879910349845886
loss_pred:0.017042290419340134, decouple_loss:0.003554177237674594
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2542724907398224, mean p set: 0.4499112665653229
loss_pred:0.01723715290427208, decouple_loss:0.003492461983114481
The modified gen p mean: 0.44925418496131897, gen p mean: -0.2539137601852417, mean p set: 0.4498290419578552
loss_pred:0.016811789944767952, decouple_loss:0.003640252398326993
WV_1_PC_1_EH_0_PS_30, loss: 0.017208527773618698, avg_mse: 0.025193218141794205
current test mse: 0.025193
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480208158493042, gen p mean: -0.2511679530143738, mean p set: 0.44859760999679565
loss_pred:0.01704099215567112, decouple_loss:0.0035544231068342924
The modified gen p mean: 0.4479025602340698, gen p mean: -0.2583596706390381, mean p set: 0.44847777485847473
loss_pred:0.015984702855348587, decouple_loss:0.0032859500497579575
The modified gen p mean: 0.4480869770050049, gen p mean: -0.2557317912578583, mean p set: 0.4486139416694641
loss_pred:0.016015540808439255, decouple_loss:0.0035705207847058773
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739216566085815, gen p mean: -0.2527689039707184, mean p set: 0.44792643189430237
loss_pred:0.016422031447291374, decouple_loss:0.0029628966003656387
The modified gen p mean: 0.4479089677333832, gen p mean: -0.2577500641345978, mean p set: 0.44847962260246277
loss_pred:0.016760943457484245, decouple_loss:0.0029452936723828316
The modified gen p mean: 0.4475293457508087, gen p mean: -0.2591768205165863, mean p set: 0.44810721278190613
loss_pred:0.01622362621128559, decouple_loss:0.002979551674798131
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871631264686584, gen p mean: -0.25081756711006165, mean p set: 0.4492427408695221
loss_pred:0.016031844541430473, decouple_loss:0.0033515281975269318
The modified gen p mean: 0.44802266359329224, gen p mean: -0.25916415452957153, mean p set: 0.44859638810157776
loss_pred:0.016644036397337914, decouple_loss:0.0031287181191146374
The modified gen p mean: 0.4482043981552124, gen p mean: -0.2531316578388214, mean p set: 0.448775053024292
loss_pred:0.016989359632134438, decouple_loss:0.0029295957647264004
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801855087280273, gen p mean: -0.2531076967716217, mean p set: 0.44854554533958435
loss_pred:0.015419693663716316, decouple_loss:0.003028859617188573
The modified gen p mean: 0.4476228654384613, gen p mean: -0.253269225358963, mean p set: 0.448201984167099
loss_pred:0.015720482915639877, decouple_loss:0.003106913296505809
The modified gen p mean: 0.4482557773590088, gen p mean: -0.2533470690250397, mean p set: 0.4488312005996704
loss_pred:0.01563934236764908, decouple_loss:0.003169092582538724
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478863775730133, gen p mean: -0.24684332311153412, mean p set: 0.44846177101135254
loss_pred:0.016060493886470795, decouple_loss:0.002979523967951536
The modified gen p mean: 0.4473666250705719, gen p mean: -0.249410018324852, mean p set: 0.4478999972343445The modified gen p mean: 0.4476225674152374, gen p mean: -0.24908335506916046, mean p set: 0.44819650053977966
loss_pred:0.016151156276464462, decouple_loss:0.00337734492495656
loss_pred:0.015726875513792038, decouple_loss:0.0030075954273343086
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478558897972107, gen p mean: -0.25254663825035095, mean p set: 0.44843557476997375
loss_pred:0.01635502278804779, decouple_loss:0.0037426629569381475
The modified gen p mean: 0.4474390745162964, gen p mean: -0.24861738085746765, mean p set: 0.4480193257331848
loss_pred:0.016113465651869774, decouple_loss:0.003709978424012661
The modified gen p mean: 0.44838637113571167, gen p mean: -0.2518994212150574, mean p set: 0.4489077031612396
loss_pred:0.015501206740736961, decouple_loss:0.0034983064979314804
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771072268486023, gen p mean: -0.2503006160259247, mean p set: 0.44828253984451294
loss_pred:0.01635671593248844, decouple_loss:0.0030755673069506884
The modified gen p mean: 0.44715508818626404, gen p mean: -0.2529534697532654, mean p set: 0.4476796090602875The modified gen p mean: 0.44740045070648193, gen p mean: -0.2485075145959854, mean p set: 0.44797900319099426
loss_pred:0.01620441861450672, decouple_loss:0.002986004576086998
loss_pred:0.016400279477238655, decouple_loss:0.0029698184225708246
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846436381340027, gen p mean: -0.25032496452331543, mean p set: 0.44904080033302307
loss_pred:0.015625838190317154, decouple_loss:0.003400625893846154
The modified gen p mean: 0.44769659638404846, gen p mean: -0.2516879737377167, mean p set: 0.4482753276824951
loss_pred:0.016410281881690025, decouple_loss:0.003865467617288232
The modified gen p mean: 0.4477183520793915, gen p mean: -0.2512546479701996, mean p set: 0.4482516348361969
loss_pred:0.016465501859784126, decouple_loss:0.003947843797504902
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702833890914917, gen p mean: -0.25304198265075684, mean p set: 0.4476061165332794
loss_pred:0.01664210483431816, decouple_loss:0.0030556360725313425
The modified gen p mean: 0.4477534592151642, gen p mean: -0.25024324655532837, mean p set: 0.4483332633972168
loss_pred:0.016171231865882874, decouple_loss:0.0029195118695497513
The modified gen p mean: 0.4474705159664154, gen p mean: -0.25027573108673096, mean p set: 0.44799885153770447
loss_pred:0.01557865273207426, decouple_loss:0.002871348988264799
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477613866329193, gen p mean: -0.2548448145389557, mean p set: 0.448341965675354
loss_pred:0.016429541632533073, decouple_loss:0.0036238546017557383
The modified gen p mean: 0.4479544460773468, gen p mean: -0.2506368160247803, mean p set: 0.4484822154045105The modified gen p mean: 0.44780433177948, gen p mean: -0.2547105550765991, mean p set: 0.44838467240333557
loss_pred:0.015620647929608822, decouple_loss:0.0036449602339416742
loss_pred:0.016004981473088264, decouple_loss:0.0035906308330595493
2023-04-26 22:03:56 testing...
The modified gen p mean: 0.4482246935367584, gen p mean: -0.24782831966876984, mean p set: 0.44879910349845886
loss_pred:0.017017971724271774, decouple_loss:0.0030538931023329496
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2506422996520996, mean p set: 0.4499112665653229
loss_pred:0.017155727371573448, decouple_loss:0.003225005231797695
The modified gen p mean: 0.44925031065940857, gen p mean: -0.250540554523468, mean p set: 0.4498290419578552
loss_pred:0.016752874478697777, decouple_loss:0.0031485201325267553
WV_1_PC_1_EH_0_PS_30, loss: 0.017132647335529327, avg_mse: 0.025125136598944664
current test mse: 0.025125
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459245502948761, gen p mean: -0.2523086965084076, mean p set: 0.4464513063430786
loss_pred:0.01710917241871357, decouple_loss:0.0030903522856533527
The modified gen p mean: 0.4481602609157562, gen p mean: -0.25266435742378235, mean p set: 0.44873204827308655
loss_pred:0.015888553112745285, decouple_loss:0.0030720073264092207
The modified gen p mean: 0.4471985995769501, gen p mean: -0.24817821383476257, mean p set: 0.44777190685272217
loss_pred:0.01526663824915886, decouple_loss:0.0031113901641219854
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483828544616699, gen p mean: -0.2537727355957031, mean p set: 0.4489142596721649
loss_pred:0.016161836683750153, decouple_loss:0.0038139664102345705
The modified gen p mean: 0.4461246728897095, gen p mean: -0.25076523423194885, mean p set: 0.4467092752456665The modified gen p mean: 0.4487236738204956, gen p mean: -0.2517303228378296, mean p set: 0.44929662346839905
loss_pred:0.01719663292169571, decouple_loss:0.0034399335272610188
loss_pred:0.016075415536761284, decouple_loss:0.0037095793522894382
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463443160057068, gen p mean: -0.2507796287536621, mean p set: 0.44687342643737793
loss_pred:0.017200874164700508, decouple_loss:0.003210330381989479
The modified gen p mean: 0.4465242326259613, gen p mean: -0.2525644600391388, mean p set: 0.44710099697113037
loss_pred:0.01598620042204857, decouple_loss:0.003278927179053426
The modified gen p mean: 0.44721484184265137, gen p mean: -0.2502784729003906, mean p set: 0.44778627157211304
loss_pred:0.01636326313018799, decouple_loss:0.0032897035125643015
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723930954933167, gen p mean: -0.25043246150016785, mean p set: 0.4477720260620117
loss_pred:0.01617765799164772, decouple_loss:0.003404999617487192
The modified gen p mean: 0.44699716567993164, gen p mean: -0.2537720203399658, mean p set: 0.44757208228111267The modified gen p mean: 0.44698622822761536, gen p mean: -0.25012335181236267, mean p set: 0.4475656747817993
loss_pred:0.015958476811647415, decouple_loss:0.003301119664683938loss_pred:0.01621561124920845, decouple_loss:0.0035135685466229916
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746118783950806, gen p mean: -0.2528981864452362, mean p set: 0.44803762435913086
loss_pred:0.016368983313441277, decouple_loss:0.00335516594350338
The modified gen p mean: 0.44806990027427673, gen p mean: -0.25155505537986755, mean p set: 0.44859448075294495The modified gen p mean: 0.44807296991348267, gen p mean: -0.252998411655426, mean p set: 0.4486530125141144
loss_pred:0.016920579597353935, decouple_loss:0.003675006330013275
loss_pred:0.016919778659939766, decouple_loss:0.003560089273378253
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451413154602051, gen p mean: -0.25999191403388977, mean p set: 0.44571492075920105
loss_pred:0.01588401384651661, decouple_loss:0.0034117710310965776
The modified gen p mean: 0.4482559263706207, gen p mean: -0.2563115656375885, mean p set: 0.4488321542739868
The modified gen p mean: 0.44648051261901855, gen p mean: -0.2562338709831238, mean p set: 0.44701406359672546
loss_pred:0.016062237322330475, decouple_loss:0.003007551422342658
loss_pred:0.01710052788257599, decouple_loss:0.003041260875761509
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480558931827545, gen p mean: -0.25659316778182983, mean p set: 0.4486321210861206
loss_pred:0.015927916392683983, decouple_loss:0.003292390611022711
The modified gen p mean: 0.44690531492233276, gen p mean: -0.2553252577781677, mean p set: 0.44747447967529297The modified gen p mean: 0.448748379945755, gen p mean: -0.2608020305633545, mean p set: 0.44927650690078735
loss_pred:0.016154784709215164, decouple_loss:0.003990375902503729
loss_pred:0.01569853164255619, decouple_loss:0.0039052923675626516
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463838040828705, gen p mean: -0.25180283188819885, mean p set: 0.44696107506752014
loss_pred:0.01638844795525074, decouple_loss:0.0029618656262755394
The modified gen p mean: 0.4459097385406494, gen p mean: -0.25092607736587524, mean p set: 0.44649171829223633
loss_pred:0.016612105071544647, decouple_loss:0.003176883328706026
The modified gen p mean: 0.4477740228176117, gen p mean: -0.25116005539894104, mean p set: 0.4483067989349365
loss_pred:0.01657702773809433, decouple_loss:0.003187432186678052
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692790508270264, gen p mean: -0.2534652054309845, mean p set: 0.4475022256374359
loss_pred:0.01643195003271103, decouple_loss:0.004198289941996336
The modified gen p mean: 0.4473397135734558, gen p mean: -0.24998721480369568, mean p set: 0.4479168951511383
loss_pred:0.015577178448438644, decouple_loss:0.004474070388823748
The modified gen p mean: 0.44653430581092834, gen p mean: -0.25164997577667236, mean p set: 0.4470709264278412
loss_pred:0.017260970547795296, decouple_loss:0.0034723742865025997
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777238368988037, gen p mean: -0.25071483850479126, mean p set: 0.4483468234539032
loss_pred:0.015613132156431675, decouple_loss:0.0033645823132246733
The modified gen p mean: 0.44697532057762146, gen p mean: -0.24774067103862762, mean p set: 0.44754740595817566
loss_pred:0.016726823523640633, decouple_loss:0.0030528169590979815
The modified gen p mean: 0.44811007380485535, gen p mean: -0.25276681780815125, mean p set: 0.4486336410045624
loss_pred:0.016612229868769646, decouple_loss:0.0033862916752696037
2023-04-26 22:08:12 testing...
The modified gen p mean: 0.44821321964263916, gen p mean: -0.24238795042037964, mean p set: 0.44879910349845886
loss_pred:0.017152132466435432, decouple_loss:0.0041376384906470776
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24518196284770966, mean p set: 0.4499112665653229
loss_pred:0.01720401830971241, decouple_loss:0.004481383133679628
The modified gen p mean: 0.4492493271827698, gen p mean: -0.24500322341918945, mean p set: 0.4498290419578552
loss_pred:0.01684301719069481, decouple_loss:0.004188967403024435
WV_1_PC_1_EH_0_PS_30, loss: 0.01727985590696335, avg_mse: 0.025244610384106636
current test mse: 0.025245
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466586410999298, gen p mean: -0.244699627161026, mean p set: 0.4472406804561615
loss_pred:0.016136839985847473, decouple_loss:0.0038354091811925173
The modified gen p mean: 0.44816818833351135, gen p mean: -0.24646532535552979, mean p set: 0.4487445652484894
loss_pred:0.016071725636720657, decouple_loss:0.003992940299212933
The modified gen p mean: 0.4466246962547302, gen p mean: -0.24656517803668976, mean p set: 0.44714486598968506
loss_pred:0.01641848497092724, decouple_loss:0.004052216187119484
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765663146972656, gen p mean: -0.24567027390003204, mean p set: 0.44818755984306335
loss_pred:0.016467276960611343, decouple_loss:0.0032947862055152655
The modified gen p mean: 0.4489143192768097, gen p mean: -0.24526941776275635, mean p set: 0.44949212670326233
loss_pred:0.01589072495698929, decouple_loss:0.003552121575921774
The modified gen p mean: 0.44564759731292725, gen p mean: -0.2434053122997284, mean p set: 0.4462227523326874
loss_pred:0.01567704975605011, decouple_loss:0.003265147330239415
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790971279144287, gen p mean: -0.23790287971496582, mean p set: 0.44843539595603943
loss_pred:0.01555363554507494, decouple_loss:0.0033922840375453234
The modified gen p mean: 0.44793277978897095, gen p mean: -0.2378753423690796, mean p set: 0.4485151767730713
loss_pred:0.015747757628560066, decouple_loss:0.0040900916792452335
The modified gen p mean: 0.44765833020210266, gen p mean: -0.2403603196144104, mean p set: 0.44823282957077026
loss_pred:0.016666464507579803, decouple_loss:0.00377172464504838
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799038767814636, gen p mean: -0.23870305716991425, mean p set: 0.4485243558883667
loss_pred:0.01580767147243023, decouple_loss:0.003004447789862752
The modified gen p mean: 0.4454859495162964, gen p mean: -0.24176901578903198, mean p set: 0.4460570514202118
loss_pred:0.015519315376877785, decouple_loss:0.0033705050591379404
The modified gen p mean: 0.4478100538253784, gen p mean: -0.24212081730365753, mean p set: 0.4483872950077057
loss_pred:0.016013052314519882, decouple_loss:0.0033680591732263565
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714123010635376, gen p mean: -0.2404528260231018, mean p set: 0.4477138817310333
loss_pred:0.015865512192249298, decouple_loss:0.003154367208480835
The modified gen p mean: 0.4471554160118103, gen p mean: -0.24229659140110016, mean p set: 0.44768208265304565The modified gen p mean: 0.4487043023109436, gen p mean: -0.24532751739025116, mean p set: 0.44928810000419617
loss_pred:0.0154607268050313, decouple_loss:0.003107259050011635loss_pred:0.016227006912231445, decouple_loss:0.0037988319527357817
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678452610969543, gen p mean: -0.24505342543125153, mean p set: 0.4473552703857422
loss_pred:0.01606941409409046, decouple_loss:0.003572961315512657
The modified gen p mean: 0.4485180377960205, gen p mean: -0.25410106778144836, mean p set: 0.449090838432312
loss_pred:0.016085229814052582, decouple_loss:0.003397418884560466
The modified gen p mean: 0.4465804994106293, gen p mean: -0.2466566264629364, mean p set: 0.4471120834350586
loss_pred:0.01623225025832653, decouple_loss:0.0032896562479436398
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460585117340088, gen p mean: -0.24823836982250214, mean p set: 0.4466347098350525
loss_pred:0.015731293708086014, decouple_loss:0.0032747755758464336
The modified gen p mean: 0.4475845694541931, gen p mean: -0.24760286509990692, mean p set: 0.44815605878829956
loss_pred:0.015673410147428513, decouple_loss:0.00306570902466774
The modified gen p mean: 0.4459882974624634, gen p mean: -0.25332942605018616, mean p set: 0.44651445746421814
loss_pred:0.015540383756160736, decouple_loss:0.0031837760470807552
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465891122817993, gen p mean: -0.2515031099319458, mean p set: 0.44717034697532654
loss_pred:0.01698857732117176, decouple_loss:0.003659317269921303
The modified gen p mean: 0.44685301184654236, gen p mean: -0.25233194231987, mean p set: 0.44742488861083984
loss_pred:0.016921812668442726, decouple_loss:0.003302187193185091
The modified gen p mean: 0.4486197531223297, gen p mean: -0.2536070644855499, mean p set: 0.44913914799690247
loss_pred:0.016469692811369896, decouple_loss:0.0038022377993911505
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447151243686676, gen p mean: -0.24998126924037933, mean p set: 0.44772249460220337
loss_pred:0.01637415774166584, decouple_loss:0.0029163085855543613
The modified gen p mean: 0.4475659430027008, gen p mean: -0.2521856427192688, mean p set: 0.4481431543827057
loss_pred:0.01577458158135414, decouple_loss:0.003021613694727421
The modified gen p mean: 0.44634440541267395, gen p mean: -0.2521246671676636, mean p set: 0.44687098264694214
loss_pred:0.015503081493079662, decouple_loss:0.0028807336930185556
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463461637496948, gen p mean: -0.2524220943450928, mean p set: 0.4469250440597534
loss_pred:0.01728723756968975, decouple_loss:0.003282874822616577
The modified gen p mean: 0.44795840978622437, gen p mean: -0.2551249563694, mean p set: 0.44847849011421204The modified gen p mean: 0.4471331834793091, gen p mean: -0.2540720999240875, mean p set: 0.4477066397666931
loss_pred:0.016239074990153313, decouple_loss:0.003168939845636487
loss_pred:0.01589788682758808, decouple_loss:0.0030730790458619595
2023-04-26 22:11:38 testing...
The modified gen p mean: 0.4482298791408539, gen p mean: -0.2516963481903076, mean p set: 0.44879910349845886
loss_pred:0.01713590696454048, decouple_loss:0.0030565685592591763
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2543598413467407, mean p set: 0.4499112665653229
loss_pred:0.017221296206116676, decouple_loss:0.0031077926978468895
The modified gen p mean: 0.449249804019928, gen p mean: -0.25391510128974915, mean p set: 0.4498290419578552
loss_pred:0.016775252297520638, decouple_loss:0.0031540431082248688
WV_1_PC_1_EH_0_PS_30, loss: 0.017199460417032242, avg_mse: 0.025243794545531273
current test mse: 0.025244
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487704038619995, gen p mean: -0.25629404187202454, mean p set: 0.44930025935173035
loss_pred:0.015524127520620823, decouple_loss:0.003325299359858036
The modified gen p mean: 0.44848671555519104, gen p mean: -0.25330525636672974, mean p set: 0.4490686058998108
loss_pred:0.016663502901792526, decouple_loss:0.003480704501271248
The modified gen p mean: 0.44872596859931946, gen p mean: -0.24886570870876312, mean p set: 0.44930222630500793
loss_pred:0.016114234924316406, decouple_loss:0.0033927697222679853
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483022093772888, gen p mean: -0.25807812809944153, mean p set: 0.44883859157562256
loss_pred:0.01532910205423832, decouple_loss:0.0034408855717629194
The modified gen p mean: 0.4470551609992981, gen p mean: -0.25372689962387085, mean p set: 0.4476362466812134
loss_pred:0.016981739550828934, decouple_loss:0.0035785911604762077
The modified gen p mean: 0.44751617312431335, gen p mean: -0.25269535183906555, mean p set: 0.4480898678302765
loss_pred:0.016039283946156502, decouple_loss:0.0037046174984425306
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496780037879944, gen p mean: -0.2497749924659729, mean p set: 0.450207382440567
loss_pred:0.015555672347545624, decouple_loss:0.003493113676086068
The modified gen p mean: 0.4490872919559479, gen p mean: -0.24856866896152496, mean p set: 0.44965940713882446
loss_pred:0.015225679613649845, decouple_loss:0.0035064006224274635
The modified gen p mean: 0.4493449628353119, gen p mean: -0.24872080981731415, mean p set: 0.44992080330848694
loss_pred:0.016488753259181976, decouple_loss:0.003339646151289344
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483652412891388, gen p mean: -0.24531203508377075, mean p set: 0.4488929510116577
loss_pred:0.016164278611540794, decouple_loss:0.0032144510187208652
The modified gen p mean: 0.44784224033355713, gen p mean: -0.24583807587623596, mean p set: 0.4484257698059082
loss_pred:0.016077063977718353, decouple_loss:0.0033624330535531044
The modified gen p mean: 0.447729229927063, gen p mean: -0.24289605021476746, mean p set: 0.44830384850502014
loss_pred:0.015138735063374043, decouple_loss:0.0032270352821797132
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486643075942993, gen p mean: -0.24056845903396606, mean p set: 0.4492400586605072
loss_pred:0.016524480655789375, decouple_loss:0.003383172210305929
The modified gen p mean: 0.44840139150619507, gen p mean: -0.23945674300193787, mean p set: 0.44897738099098206
loss_pred:0.015350480563938618, decouple_loss:0.003451213240623474
The modified gen p mean: 0.44778206944465637, gen p mean: -0.239287331700325, mean p set: 0.4483124613761902
loss_pred:0.015296904370188713, decouple_loss:0.0029846932739019394
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738879799842834, gen p mean: -0.24522756040096283, mean p set: 0.4479579031467438
loss_pred:0.015933379530906677, decouple_loss:0.0036584483459591866
The modified gen p mean: 0.4478902518749237, gen p mean: -0.24774900078773499, mean p set: 0.448469340801239The modified gen p mean: 0.44872817397117615, gen p mean: -0.242651104927063, mean p set: 0.44925642013549805
loss_pred:0.015662502497434616, decouple_loss:0.0037229242734611034
loss_pred:0.016325289383530617, decouple_loss:0.003795925062149763
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833293557167053, gen p mean: -0.23571465909481049, mean p set: 0.4489034116268158
loss_pred:0.015447435900568962, decouple_loss:0.00359976664185524
The modified gen p mean: 0.44724276661872864, gen p mean: -0.23756350576877594, mean p set: 0.4478180706501007
loss_pred:0.016563618555665016, decouple_loss:0.003948430065065622
The modified gen p mean: 0.4475669860839844, gen p mean: -0.23401673138141632, mean p set: 0.4480970501899719
loss_pred:0.015448172576725483, decouple_loss:0.0033570239320397377
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862011075019836, gen p mean: -0.2285117208957672, mean p set: 0.44919553399086
loss_pred:0.015920447185635567, decouple_loss:0.0034048326779156923
The modified gen p mean: 0.4482482373714447, gen p mean: -0.2378987818956375, mean p set: 0.4488309919834137
loss_pred:0.016445264220237732, decouple_loss:0.0032534936908632517
The modified gen p mean: 0.44918325543403625, gen p mean: -0.22793793678283691, mean p set: 0.44971105456352234
loss_pred:0.015749098733067513, decouple_loss:0.0032902518287301064
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475893974304199, gen p mean: -0.23416583240032196, mean p set: 0.4481671154499054
loss_pred:0.015476883389055729, decouple_loss:0.003814773168414831
The modified gen p mean: 0.44790491461753845, gen p mean: -0.24028567969799042, mean p set: 0.4484882652759552
loss_pred:0.015316883102059364, decouple_loss:0.0041419160552322865
The modified gen p mean: 0.4490955173969269, gen p mean: -0.23198282718658447, mean p set: 0.4496217370033264
loss_pred:0.015303632244467735, decouple_loss:0.003845755010843277
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477498531341553, gen p mean: -0.24282273650169373, mean p set: 0.44832542538642883
loss_pred:0.016104651615023613, decouple_loss:0.003437628736719489
The modified gen p mean: 0.4493538737297058, gen p mean: -0.24341219663619995, mean p set: 0.4499247372150421
loss_pred:0.015198715962469578, decouple_loss:0.0035090509336441755
The modified gen p mean: 0.44849318265914917, gen p mean: -0.24387864768505096, mean p set: 0.4490225911140442
loss_pred:0.016199307516217232, decouple_loss:0.0036793029867112637
2023-04-26 22:15:52 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.23792202770709991, mean p set: 0.4499112665653229
loss_pred:0.017412802204489708, decouple_loss:0.003967088647186756
The modified gen p mean: 0.44822484254837036, gen p mean: -0.23515719175338745, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492432773113251, gen p mean: -0.237566277384758, mean p set: 0.4498290419578552
loss_pred:0.01723560132086277, decouple_loss:0.0038139489479362965
loss_pred:0.016953488811850548, decouple_loss:0.004156795796006918
WV_1_PC_1_EH_0_PS_30, loss: 0.01739959418773651, avg_mse: 0.025503089651465416
current test mse: 0.025503
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488542079925537, gen p mean: -0.23761968314647675, mean p set: 0.44943690299987793
loss_pred:0.015477590262889862, decouple_loss:0.003735677571967244
The modified gen p mean: 0.4498782753944397, gen p mean: -0.23786607384681702, mean p set: 0.4504498541355133
loss_pred:0.015391567721962929, decouple_loss:0.0038235855754464865
The modified gen p mean: 0.4478890597820282, gen p mean: -0.23415504395961761, mean p set: 0.44841691851615906
loss_pred:0.015181678347289562, decouple_loss:0.0035015172325074673
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810593128204346, gen p mean: -0.23264062404632568, mean p set: 0.4486420452594757
loss_pred:0.016371089965105057, decouple_loss:0.0035230780486017466
The modified gen p mean: 0.4484749138355255, gen p mean: -0.23050124943256378, mean p set: 0.44905519485473633
loss_pred:0.015941569581627846, decouple_loss:0.003928077407181263
The modified gen p mean: 0.44849270582199097, gen p mean: -0.2356991320848465, mean p set: 0.4490663409233093
loss_pred:0.015393555164337158, decouple_loss:0.0038167585153132677
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488992393016815, gen p mean: -0.23273059725761414, mean p set: 0.449429988861084
loss_pred:0.01619456522166729, decouple_loss:0.004186551086604595
The modified gen p mean: 0.4479888379573822, gen p mean: -0.23385100066661835, mean p set: 0.4485659599304199
loss_pred:0.016053689643740654, decouple_loss:0.003994693513959646
The modified gen p mean: 0.4487518072128296, gen p mean: -0.23062022030353546, mean p set: 0.44932955503463745
loss_pred:0.0160103440284729, decouple_loss:0.004309141077101231
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447659432888031, gen p mean: -0.23165997862815857, mean p set: 0.4481886029243469
loss_pred:0.01552513986825943, decouple_loss:0.004341079853475094
The modified gen p mean: 0.4477756917476654, gen p mean: -0.23640987277030945, mean p set: 0.44834965467453003
loss_pred:0.01641850918531418, decouple_loss:0.003930066246539354
The modified gen p mean: 0.45009636878967285, gen p mean: -0.23293878138065338, mean p set: 0.4506753385066986
loss_pred:0.015414752066135406, decouple_loss:0.003975138533860445
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867801666259766, gen p mean: -0.234623983502388, mean p set: 0.4492567181587219
loss_pred:0.0156445000320673, decouple_loss:0.004173102788627148
The modified gen p mean: 0.4486030340194702, gen p mean: -0.23223403096199036, mean p set: 0.44913092255592346The modified gen p mean: 0.44782137870788574, gen p mean: -0.22958433628082275, mean p set: 0.44840162992477417
loss_pred:0.015672355890274048, decouple_loss:0.004113490227609873
loss_pred:0.015207177959382534, decouple_loss:0.004381055943667889
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935834407806396, gen p mean: -0.23805761337280273, mean p set: 0.44993188977241516
loss_pred:0.015612101182341576, decouple_loss:0.0037661453243345022
The modified gen p mean: 0.4488898813724518, gen p mean: -0.2410445213317871, mean p set: 0.44945937395095825
loss_pred:0.014418612234294415, decouple_loss:0.004004757385700941
The modified gen p mean: 0.4484708309173584, gen p mean: -0.23808984458446503, mean p set: 0.44900044798851013
loss_pred:0.01541117299348116, decouple_loss:0.004271435085684061
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44907888770103455, gen p mean: -0.24835452437400818, mean p set: 0.4496510326862335
loss_pred:0.015819663181900978, decouple_loss:0.003383338451385498
The modified gen p mean: 0.44809120893478394, gen p mean: -0.24278023838996887, mean p set: 0.44866296648979187
loss_pred:0.016041569411754608, decouple_loss:0.003568624146282673
The modified gen p mean: 0.4496608376502991, gen p mean: -0.24687066674232483, mean p set: 0.45019209384918213
loss_pred:0.016292333602905273, decouple_loss:0.0036308644339442253
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447347491979599, gen p mean: -0.24599020183086395, mean p set: 0.4479256868362427
loss_pred:0.015443796291947365, decouple_loss:0.003570136846974492
The modified gen p mean: 0.4487138092517853, gen p mean: -0.24359489977359772, mean p set: 0.4492858350276947
loss_pred:0.014986008405685425, decouple_loss:0.003907294012606144
The modified gen p mean: 0.44812682271003723, gen p mean: -0.2450234740972519, mean p set: 0.4486553370952606
loss_pred:0.016058525070548058, decouple_loss:0.0038600245025008917
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491299092769623, gen p mean: -0.24186979234218597, mean p set: 0.4497077465057373
loss_pred:0.0156380757689476, decouple_loss:0.0030312829185277224
The modified gen p mean: 0.448309063911438, gen p mean: -0.2366315871477127, mean p set: 0.4488828480243683
loss_pred:0.01594586670398712, decouple_loss:0.0036789760924875736
The modified gen p mean: 0.448363721370697, gen p mean: -0.2395317554473877, mean p set: 0.4488871097564697
loss_pred:0.01532502006739378, decouple_loss:0.0033097867853939533
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858649373054504, gen p mean: -0.23653042316436768, mean p set: 0.44916436076164246
loss_pred:0.015200654044747353, decouple_loss:0.0031329176854342222
The modified gen p mean: 0.4479920268058777, gen p mean: -0.23790664970874786, mean p set: 0.44856372475624084
loss_pred:0.015290104784071445, decouple_loss:0.003382495604455471
The modified gen p mean: 0.4486253559589386, gen p mean: -0.2408415973186493, mean p set: 0.449150025844574
loss_pred:0.015421226620674133, decouple_loss:0.003571582492440939
2023-04-26 22:19:19 testing...
The modified gen p mean: 0.4482251703739166, gen p mean: -0.23473526537418365, mean p set: 0.44879910349845886
loss_pred:0.017211265861988068, decouple_loss:0.0037187007255852222
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2376878559589386, mean p set: 0.4499112665653229
loss_pred:0.01748349331319332, decouple_loss:0.003575629787519574
The modified gen p mean: 0.4492546319961548, gen p mean: -0.23734325170516968, mean p set: 0.4498290419578552
loss_pred:0.016960829496383667, decouple_loss:0.003512066323310137
WV_1_PC_1_EH_0_PS_30, loss: 0.017398636788129807, avg_mse: 0.025553958490490913
current test mse: 0.025554
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965824484825134, gen p mean: -0.24209316074848175, mean p set: 0.4501863420009613
loss_pred:0.01690567284822464, decouple_loss:0.0036181143950670958
The modified gen p mean: 0.4472799301147461, gen p mean: -0.2367260605096817, mean p set: 0.44785773754119873
loss_pred:0.0163058303296566, decouple_loss:0.0036015212535858154
The modified gen p mean: 0.447637677192688, gen p mean: -0.23919866979122162, mean p set: 0.44820985198020935
loss_pred:0.01685960590839386, decouple_loss:0.0033251135610044003
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869765639305115, gen p mean: -0.23773442208766937, mean p set: 0.44922152161598206
loss_pred:0.01668844372034073, decouple_loss:0.0029826334211975336
The modified gen p mean: 0.44909074902534485, gen p mean: -0.24241945147514343, mean p set: 0.4496676027774811
loss_pred:0.017218833789229393, decouple_loss:0.0033293389715254307
The modified gen p mean: 0.44742727279663086, gen p mean: -0.2391815334558487, mean p set: 0.44799840450286865
loss_pred:0.017044708132743835, decouple_loss:0.0034025104250758886
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823431968688965, gen p mean: -0.23881813883781433, mean p set: 0.44876912236213684
loss_pred:0.016591764986515045, decouple_loss:0.0035202617291361094
The modified gen p mean: 0.44815391302108765, gen p mean: -0.24054132401943207, mean p set: 0.4487335979938507The modified gen p mean: 0.44709935784339905, gen p mean: -0.23917829990386963, mean p set: 0.4476771950721741
loss_pred:0.016491763293743134, decouple_loss:0.0037046498619019985
loss_pred:0.017748359590768814, decouple_loss:0.0035212570801377296
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480515420436859, gen p mean: -0.24352018535137177, mean p set: 0.44857507944107056
loss_pred:0.015930885449051857, decouple_loss:0.003266231156885624
The modified gen p mean: 0.4473021924495697, gen p mean: -0.24544741213321686, mean p set: 0.4478755593299866
loss_pred:0.015998322516679764, decouple_loss:0.0030366035643965006
The modified gen p mean: 0.44813641905784607, gen p mean: -0.24161003530025482, mean p set: 0.44871145486831665
loss_pred:0.016822202131152153, decouple_loss:0.003160931868478656
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477691054344177, gen p mean: -0.24277812242507935, mean p set: 0.44833654165267944
loss_pred:0.016119714826345444, decouple_loss:0.00352242449298501
The modified gen p mean: 0.4472825825214386, gen p mean: -0.24093270301818848, mean p set: 0.4478580951690674
loss_pred:0.01582447439432144, decouple_loss:0.0032394900918006897
The modified gen p mean: 0.44715386629104614, gen p mean: -0.24149395525455475, mean p set: 0.447688490152359
loss_pred:0.016200844198465347, decouple_loss:0.0032955848146229982
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482368230819702, gen p mean: -0.2400761991739273, mean p set: 0.44880983233451843
loss_pred:0.017168590798974037, decouple_loss:0.0033549731597304344
The modified gen p mean: 0.44795215129852295, gen p mean: -0.23970383405685425, mean p set: 0.4485322833061218The modified gen p mean: 0.44823378324508667, gen p mean: -0.24084436893463135, mean p set: 0.4487592875957489
loss_pred:0.015906672924757004, decouple_loss:0.0030748567078262568
loss_pred:0.017423441633582115, decouple_loss:0.0033138233702629805
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475787281990051, gen p mean: -0.2477952390909195, mean p set: 0.44816285371780396
loss_pred:0.015338362194597721, decouple_loss:0.003080516355112195
The modified gen p mean: 0.4484894871711731, gen p mean: -0.2439015656709671, mean p set: 0.4490683674812317
loss_pred:0.015701409429311752, decouple_loss:0.0030170076061040163
The modified gen p mean: 0.4477258324623108, gen p mean: -0.2442057579755783, mean p set: 0.44825538992881775
loss_pred:0.015989307314157486, decouple_loss:0.003582305507734418
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470047950744629, gen p mean: -0.24838827550411224, mean p set: 0.44758591055870056
loss_pred:0.015658484771847725, decouple_loss:0.002858491148799658
The modified gen p mean: 0.4479486048221588, gen p mean: -0.24701206386089325, mean p set: 0.44852176308631897
loss_pred:0.016821319237351418, decouple_loss:0.0028777767438441515
The modified gen p mean: 0.447670578956604, gen p mean: -0.2472955882549286, mean p set: 0.44819530844688416
loss_pred:0.016308622434735298, decouple_loss:0.0029803719371557236
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485110938549042, gen p mean: -0.24578669667243958, mean p set: 0.44908908009529114
loss_pred:0.01640508510172367, decouple_loss:0.003174468409270048
The modified gen p mean: 0.4471674859523773, gen p mean: -0.2488279938697815, mean p set: 0.4477599561214447
loss_pred:0.01577608846127987, decouple_loss:0.0031647931318730116
The modified gen p mean: 0.4493986666202545, gen p mean: -0.2473943531513214, mean p set: 0.4499371349811554
loss_pred:0.01600564457476139, decouple_loss:0.0031719638500362635
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783976674079895, gen p mean: -0.24809931218624115, mean p set: 0.4484177529811859
loss_pred:0.01644069515168667, decouple_loss:0.003070652484893799
The modified gen p mean: 0.4473204016685486, gen p mean: -0.24394966661930084, mean p set: 0.44789284467697144
loss_pred:0.015846863389015198, decouple_loss:0.0030198933091014624
The modified gen p mean: 0.44756215810775757, gen p mean: -0.24462763965129852, mean p set: 0.4480845034122467
loss_pred:0.01700669713318348, decouple_loss:0.003056430257856846
2023-04-26 22:23:33 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24796651303768158, mean p set: 0.4499112665653229
loss_pred:0.017317714169621468, decouple_loss:0.0032018322963267565
The modified gen p mean: 0.44925305247306824, gen p mean: -0.24746935069561005, mean p set: 0.4498290419578552
loss_pred:0.01688258908689022, decouple_loss:0.0032332998234778643
The modified gen p mean: 0.448228657245636, gen p mean: -0.24502134323120117, mean p set: 0.44879910349845886
loss_pred:0.01715582236647606, decouple_loss:0.0030487640760838985
WV_1_PC_1_EH_0_PS_30, loss: 0.01727677509188652, avg_mse: 0.02537764050066471
current test mse: 0.025378
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484279155731201, gen p mean: -0.25030264258384705, mean p set: 0.4489997327327728
loss_pred:0.01630548946559429, decouple_loss:0.0028936315793544054
The modified gen p mean: 0.4503342807292938, gen p mean: -0.2518676817417145, mean p set: 0.4508599638938904
loss_pred:0.01601036824285984, decouple_loss:0.003609066130593419
The modified gen p mean: 0.4498561918735504, gen p mean: -0.24979403614997864, mean p set: 0.45043665170669556
loss_pred:0.01648954302072525, decouple_loss:0.00350682670250535
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842880964279175, gen p mean: -0.24661917984485626, mean p set: 0.44895321130752563
loss_pred:0.015774661675095558, decouple_loss:0.0035736258141696453
The modified gen p mean: 0.44826504588127136, gen p mean: -0.24882975220680237, mean p set: 0.4488394856452942
The modified gen p mean: 0.4473251700401306, gen p mean: -0.25212058424949646, mean p set: 0.44789400696754456
loss_pred:0.01602843403816223, decouple_loss:0.003217650344595313
loss_pred:0.016653690487146378, decouple_loss:0.002964799525216222
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480859339237213, gen p mean: -0.2465035319328308, mean p set: 0.44861847162246704
loss_pred:0.015667932108044624, decouple_loss:0.0029889901634305716
The modified gen p mean: 0.44940873980522156, gen p mean: -0.2458844631910324, mean p set: 0.4499906599521637
The modified gen p mean: 0.44811928272247314, gen p mean: -0.24420177936553955, mean p set: 0.44869568943977356
loss_pred:0.01599426008760929, decouple_loss:0.002845289185643196
loss_pred:0.016290277242660522, decouple_loss:0.0030622275080531836
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475848078727722, gen p mean: -0.2465425580739975, mean p set: 0.4481090009212494
loss_pred:0.01612926833331585, decouple_loss:0.0031974338926374912
The modified gen p mean: 0.44802847504615784, gen p mean: -0.24728208780288696, mean p set: 0.44860783219337463
The modified gen p mean: 0.44740861654281616, gen p mean: -0.24837462604045868, mean p set: 0.44798803329467773
loss_pred:0.015562557615339756, decouple_loss:0.0028505707159638405
loss_pred:0.015826193615794182, decouple_loss:0.0032510648015886545
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860315322875977, gen p mean: -0.24796730279922485, mean p set: 0.44918495416641235
loss_pred:0.015789486467838287, decouple_loss:0.002681286307051778
The modified gen p mean: 0.4483170211315155, gen p mean: -0.24642182886600494, mean p set: 0.4488926827907562
loss_pred:0.01636950671672821, decouple_loss:0.003111319849267602
The modified gen p mean: 0.4483627378940582, gen p mean: -0.24772141873836517, mean p set: 0.4488913416862488
loss_pred:0.017032239586114883, decouple_loss:0.0029305373318493366
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490962028503418, gen p mean: -0.25367000699043274, mean p set: 0.4496730864048004
loss_pred:0.016415772959589958, decouple_loss:0.002957176649942994
The modified gen p mean: 0.44834351539611816, gen p mean: -0.25251173973083496, mean p set: 0.44892382621765137
loss_pred:0.01598264090716839, decouple_loss:0.003007739782333374
The modified gen p mean: 0.4479871094226837, gen p mean: -0.2526126205921173, mean p set: 0.4485079050064087
loss_pred:0.01580095663666725, decouple_loss:0.0030274123419076204
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485653340816498, gen p mean: -0.25104963779449463, mean p set: 0.4491422176361084
loss_pred:0.016397707164287567, decouple_loss:0.0028779569547623396
The modified gen p mean: 0.4472433626651764, gen p mean: -0.2557533383369446, mean p set: 0.4478192627429962
loss_pred:0.015161394141614437, decouple_loss:0.0031075566075742245
The modified gen p mean: 0.44836950302124023, gen p mean: -0.2507489323616028, mean p set: 0.448894202709198
loss_pred:0.016736026853322983, decouple_loss:0.002949184039607644
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747740030288696, gen p mean: -0.24765707552433014, mean p set: 0.44804567098617554
loss_pred:0.015407782979309559, decouple_loss:0.0036334258038550615
The modified gen p mean: 0.44775301218032837, gen p mean: -0.24917086958885193, mean p set: 0.44832760095596313
loss_pred:0.01574898324906826, decouple_loss:0.0035806302912533283
The modified gen p mean: 0.448118656873703, gen p mean: -0.24817132949829102, mean p set: 0.4486456513404846
loss_pred:0.01661611534655094, decouple_loss:0.003636410227045417
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768020510673523, gen p mean: -0.24514783918857574, mean p set: 0.4482552707195282
loss_pred:0.016526371240615845, decouple_loss:0.0032242725137621164
The modified gen p mean: 0.4485134482383728, gen p mean: -0.24503183364868164, mean p set: 0.4490887224674225
loss_pred:0.015662528574466705, decouple_loss:0.0034426215570420027
The modified gen p mean: 0.44819167256355286, gen p mean: -0.24204492568969727, mean p set: 0.44872695207595825
loss_pred:0.016530411317944527, decouple_loss:0.003237639321014285
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474412500858307, gen p mean: -0.25059008598327637, mean p set: 0.4480244815349579
loss_pred:0.016187559813261032, decouple_loss:0.0034299485851079226
The modified gen p mean: 0.4470091462135315, gen p mean: -0.24730876088142395, mean p set: 0.4475880563259125
loss_pred:0.01647047884762287, decouple_loss:0.0032400107011198997
The modified gen p mean: 0.4471023976802826, gen p mean: -0.24406391382217407, mean p set: 0.44762876629829407
loss_pred:0.017651164904236794, decouple_loss:0.0034751524217426777
2023-04-26 22:26:59 testing...
The modified gen p mean: 0.4482201337814331, gen p mean: -0.24435767531394958, mean p set: 0.44879910349845886
loss_pred:0.017149431630969048, decouple_loss:0.0033031590282917023
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24699118733406067, mean p set: 0.4499112665653229
loss_pred:0.017329340800642967, decouple_loss:0.0031564647797495127
The modified gen p mean: 0.449256956577301, gen p mean: -0.24647507071495056, mean p set: 0.4498290419578552
loss_pred:0.01686772331595421, decouple_loss:0.003232714021578431
WV_1_PC_1_EH_0_PS_30, loss: 0.01727703958749771, avg_mse: 0.025399282574653625
current test mse: 0.025399
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44638538360595703, gen p mean: -0.2494262009859085, mean p set: 0.44691362977027893
loss_pred:0.016350526362657547, decouple_loss:0.0032342462800443172
The modified gen p mean: 0.44634121656417847, gen p mean: -0.2454472780227661, mean p set: 0.44691479206085205
loss_pred:0.016785262152552605, decouple_loss:0.003177584381774068
The modified gen p mean: 0.4460150897502899, gen p mean: -0.24765639007091522, mean p set: 0.44658660888671875
loss_pred:0.016429372131824493, decouple_loss:0.0033022561110556126
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465237557888031, gen p mean: -0.2401427924633026, mean p set: 0.44704607129096985
loss_pred:0.015870366245508194, decouple_loss:0.003079876769334078
The modified gen p mean: 0.4464276432991028, gen p mean: -0.24574561417102814, mean p set: 0.4470020830631256
loss_pred:0.0161728635430336, decouple_loss:0.003269016742706299
The modified gen p mean: 0.4462742805480957, gen p mean: -0.2455650418996811, mean p set: 0.446846604347229
loss_pred:0.016318459063768387, decouple_loss:0.0031357009429484606
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673264026641846, gen p mean: -0.24322457611560822, mean p set: 0.44726231694221497
loss_pred:0.015781322494149208, decouple_loss:0.0031844433397054672
The modified gen p mean: 0.44651350378990173, gen p mean: -0.2468416690826416, mean p set: 0.44709545373916626The modified gen p mean: 0.44760459661483765, gen p mean: -0.23806169629096985, mean p set: 0.44818106293678284
loss_pred:0.01604108139872551, decouple_loss:0.0029490881133824587loss_pred:0.015600121580064297, decouple_loss:0.003187339287251234
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469378888607025, gen p mean: -0.24459896981716156, mean p set: 0.44746461510658264
loss_pred:0.016296256333589554, decouple_loss:0.0029736373107880354
The modified gen p mean: 0.44669368863105774, gen p mean: -0.2492542415857315, mean p set: 0.4472668468952179
loss_pred:0.015838338062167168, decouple_loss:0.003174789948388934
The modified gen p mean: 0.44669827818870544, gen p mean: -0.24204933643341064, mean p set: 0.44727569818496704
loss_pred:0.015871239826083183, decouple_loss:0.0032216531690210104
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44624143838882446, gen p mean: -0.24348266422748566, mean p set: 0.446819543838501
loss_pred:0.01637977547943592, decouple_loss:0.003081789007410407
The modified gen p mean: 0.44715237617492676, gen p mean: -0.24162879586219788, mean p set: 0.4477251172065735
loss_pred:0.016398591920733452, decouple_loss:0.002818136475980282
The modified gen p mean: 0.44719967246055603, gen p mean: -0.24236825108528137, mean p set: 0.4477333426475525
loss_pred:0.017173686996102333, decouple_loss:0.002752993255853653
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750264286994934, gen p mean: -0.24746659398078918, mean p set: 0.44807347655296326
loss_pred:0.015973582863807678, decouple_loss:0.0026969341561198235
The modified gen p mean: 0.44702884554862976, gen p mean: -0.24421429634094238, mean p set: 0.44760966300964355
loss_pred:0.016621273010969162, decouple_loss:0.0028533651493489742
The modified gen p mean: 0.44513216614723206, gen p mean: -0.24691419303417206, mean p set: 0.44565579295158386
loss_pred:0.015983005985617638, decouple_loss:0.0030273532029241323
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834673404693604, gen p mean: -0.24757471680641174, mean p set: 0.4489297568798065
loss_pred:0.015383039601147175, decouple_loss:0.002919887425377965
The modified gen p mean: 0.44597843289375305, gen p mean: -0.24322378635406494, mean p set: 0.4465474784374237The modified gen p mean: 0.44700947403907776, gen p mean: -0.24512098729610443, mean p set: 0.4475364685058594
loss_pred:0.01632254756987095, decouple_loss:0.003298844676464796
loss_pred:0.015689630061388016, decouple_loss:0.0030062596779316664
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746196269989014, gen p mean: -0.24301181733608246, mean p set: 0.4480440020561218
loss_pred:0.015768149867653847, decouple_loss:0.0028828356880694628
The modified gen p mean: 0.44659510254859924, gen p mean: -0.23687061667442322, mean p set: 0.4471670687198639
loss_pred:0.015900995582342148, decouple_loss:0.0028038115706294775
The modified gen p mean: 0.44669589400291443, gen p mean: -0.24408318102359772, mean p set: 0.44722166657447815
loss_pred:0.016594139859080315, decouple_loss:0.002861128654330969
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452846944332123, gen p mean: -0.24171453714370728, mean p set: 0.445857435464859
loss_pred:0.016690125688910484, decouple_loss:0.003057856811210513
The modified gen p mean: 0.4460251033306122, gen p mean: -0.24537278711795807, mean p set: 0.44659578800201416
loss_pred:0.016054483130574226, decouple_loss:0.002941687358543277
The modified gen p mean: 0.4471096694469452, gen p mean: -0.239601731300354, mean p set: 0.4476316571235657
loss_pred:0.016460686922073364, decouple_loss:0.003035728819668293
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460334777832031, gen p mean: -0.24071291089057922, mean p set: 0.4466037154197693
loss_pred:0.01646396517753601, decouple_loss:0.0028060423210263252
The modified gen p mean: 0.4469034969806671, gen p mean: -0.24512293934822083, mean p set: 0.44748565554618835
loss_pred:0.015512011013925076, decouple_loss:0.002882462227717042
The modified gen p mean: 0.44605427980422974, gen p mean: -0.2450612634420395, mean p set: 0.4465794563293457
loss_pred:0.01611526682972908, decouple_loss:0.002999999327585101
2023-04-26 22:31:09 testing...
The modified gen p mean: 0.44822511076927185, gen p mean: -0.24198995530605316, mean p set: 0.44879910349845886
loss_pred:0.017230289056897163, decouple_loss:0.0028250713367015123
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24454306066036224, mean p set: 0.4499112665653229
loss_pred:0.01732228882610798, decouple_loss:0.00281631201505661
The modified gen p mean: 0.44926515221595764, gen p mean: -0.24462804198265076, mean p set: 0.4498290419578552
loss_pred:0.01696096733212471, decouple_loss:0.0028094197623431683
WV_1_PC_1_EH_0_PS_30, loss: 0.017312029376626015, avg_mse: 0.02542218565940857
current test mse: 0.025422
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469156861305237, gen p mean: -0.24180684983730316, mean p set: 0.44749704003334045
loss_pred:0.017064344137907028, decouple_loss:0.002663547871634364
The modified gen p mean: 0.4466111958026886, gen p mean: -0.24338625371456146, mean p set: 0.447183758020401
loss_pred:0.016295883804559708, decouple_loss:0.002681954763829708
The modified gen p mean: 0.446929931640625, gen p mean: -0.2423277497291565, mean p set: 0.4474572241306305
loss_pred:0.015763308852910995, decouple_loss:0.0028117501642555
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447299599647522, gen p mean: -0.24678324162960052, mean p set: 0.44782721996307373
loss_pred:0.015808267518877983, decouple_loss:0.002901058876886964
The modified gen p mean: 0.4465298056602478, gen p mean: -0.2382519394159317, mean p set: 0.4471038281917572
loss_pred:0.016501950100064278, decouple_loss:0.0026678070425987244
The modified gen p mean: 0.4476720988750458, gen p mean: -0.23848238587379456, mean p set: 0.4482450783252716
loss_pred:0.0158309917896986, decouple_loss:0.0027337628416717052
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44525521993637085, gen p mean: -0.2445383220911026, mean p set: 0.44578808546066284
loss_pred:0.015966078266501427, decouple_loss:0.002785485005006194
The modified gen p mean: 0.44748806953430176, gen p mean: -0.2399308979511261, mean p set: 0.44806838035583496The modified gen p mean: 0.44658011198043823, gen p mean: -0.24442411959171295, mean p set: 0.4471500515937805
loss_pred:0.015636663883924484, decouple_loss:0.002601809799671173
loss_pred:0.016633987426757812, decouple_loss:0.002677538199350238
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462928771972656, gen p mean: -0.24876219034194946, mean p set: 0.44682133197784424
loss_pred:0.016434108838438988, decouple_loss:0.0028946506790816784
The modified gen p mean: 0.44648370146751404, gen p mean: -0.24585384130477905, mean p set: 0.44706007838249207
loss_pred:0.015551312826573849, decouple_loss:0.002843441441655159
The modified gen p mean: 0.44558003544807434, gen p mean: -0.24936644732952118, mean p set: 0.4461512565612793
loss_pred:0.016066305339336395, decouple_loss:0.0028333510272204876
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671058654785156, gen p mean: -0.2506140172481537, mean p set: 0.44728177785873413
loss_pred:0.015761520713567734, decouple_loss:0.003038696711882949
The modified gen p mean: 0.44671010971069336, gen p mean: -0.24641582369804382, mean p set: 0.44728413224220276
loss_pred:0.01596486195921898, decouple_loss:0.0034914487041532993
The modified gen p mean: 0.44666987657546997, gen p mean: -0.24685989320278168, mean p set: 0.44719746708869934
loss_pred:0.01615343615412712, decouple_loss:0.0030327027197927237
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678622484207153, gen p mean: -0.24994102120399475, mean p set: 0.4473608434200287
loss_pred:0.01625179313123226, decouple_loss:0.00280974549241364
The modified gen p mean: 0.4464346170425415, gen p mean: -0.2461259812116623, mean p set: 0.4469999372959137
loss_pred:0.01626201532781124, decouple_loss:0.0026607804466038942
The modified gen p mean: 0.4464660584926605, gen p mean: -0.2503044307231903, mean p set: 0.44699564576148987
loss_pred:0.016333503648638725, decouple_loss:0.0028313619550317526
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696104526519775, gen p mean: -0.2469942271709442, mean p set: 0.44753265380859375
loss_pred:0.01575237326323986, decouple_loss:0.003176293335855007
The modified gen p mean: 0.4467722773551941, gen p mean: -0.24634550511837006, mean p set: 0.4473506212234497
loss_pred:0.01642753928899765, decouple_loss:0.00313980458304286
The modified gen p mean: 0.446274995803833, gen p mean: -0.2502060532569885, mean p set: 0.44680705666542053
loss_pred:0.01619492471218109, decouple_loss:0.003055478911846876
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730937480926514, gen p mean: -0.24337787926197052, mean p set: 0.44788506627082825
loss_pred:0.01591615006327629, decouple_loss:0.0030493210069835186
The modified gen p mean: 0.44595739245414734, gen p mean: -0.2426971197128296, mean p set: 0.44653791189193726
loss_pred:0.01620803214609623, decouple_loss:0.0028032984118908644
The modified gen p mean: 0.44677162170410156, gen p mean: -0.24234560132026672, mean p set: 0.44730156660079956
loss_pred:0.016079679131507874, decouple_loss:0.0027357034850865602
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674307107925415, gen p mean: -0.2415347546339035, mean p set: 0.4473183751106262
loss_pred:0.016220929101109505, decouple_loss:0.0032078397925943136
The modified gen p mean: 0.4467203617095947, gen p mean: -0.2411765605211258, mean p set: 0.44729331135749817
loss_pred:0.01619451493024826, decouple_loss:0.0031765266321599483
The modified gen p mean: 0.44515830278396606, gen p mean: -0.24126917123794556, mean p set: 0.4456845819950104
loss_pred:0.01638433337211609, decouple_loss:0.003527624299749732
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458972215652466, gen p mean: -0.23936891555786133, mean p set: 0.44647684693336487
loss_pred:0.016758278012275696, decouple_loss:0.0034593248274177313
The modified gen p mean: 0.4468514621257782, gen p mean: -0.23972120881080627, mean p set: 0.4474301338195801
loss_pred:0.01587722823023796, decouple_loss:0.0031299039255827665
The modified gen p mean: 0.44661232829093933, gen p mean: -0.23990757763385773, mean p set: 0.4471467435359955
loss_pred:0.01573988050222397, decouple_loss:0.0029968370217829943
2023-04-26 22:34:37 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24204066395759583, mean p set: 0.4499112665653229
loss_pred:0.017323588952422142, decouple_loss:0.0028962185606360435
The modified gen p mean: 0.448223352432251, gen p mean: -0.23970197141170502, mean p set: 0.44879910349845886
loss_pred:0.017352109774947166, decouple_loss:0.002873949706554413
The modified gen p mean: 0.44925087690353394, gen p mean: -0.24225707352161407, mean p set: 0.4498290419578552
loss_pred:0.016956521198153496, decouple_loss:0.002912648720666766
WV_1_PC_1_EH_0_PS_30, loss: 0.017355453222990036, avg_mse: 0.025519225746393204
current test mse: 0.025519
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663605093955994, gen p mean: -0.24265576899051666, mean p set: 0.44715800881385803
loss_pred:0.015046795830130577, decouple_loss:0.0032032423187047243
The modified gen p mean: 0.4486614763736725, gen p mean: -0.2427021563053131, mean p set: 0.44923636317253113
loss_pred:0.015181341208517551, decouple_loss:0.003079391550272703
The modified gen p mean: 0.4470759928226471, gen p mean: -0.23859672248363495, mean p set: 0.44764676690101624
loss_pred:0.016589926555752754, decouple_loss:0.0029595468658953905
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481271505355835, gen p mean: -0.24488389492034912, mean p set: 0.4486611485481262
loss_pred:0.016391457989811897, decouple_loss:0.0030801668763160706
The modified gen p mean: 0.44757479429244995, gen p mean: -0.24157212674617767, mean p set: 0.44814640283584595
loss_pred:0.016608621925115585, decouple_loss:0.0030755947809666395
The modified gen p mean: 0.446815550327301, gen p mean: -0.2449825257062912, mean p set: 0.44739529490470886
loss_pred:0.01553485170006752, decouple_loss:0.0032139394897967577
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816654920578003, gen p mean: -0.24377088248729706, mean p set: 0.44869264960289
loss_pred:0.01563919149339199, decouple_loss:0.002916197758167982
The modified gen p mean: 0.44811826944351196, gen p mean: -0.2424878180027008, mean p set: 0.4486927390098572
loss_pred:0.015387759543955326, decouple_loss:0.0029862201772630215
The modified gen p mean: 0.446845680475235, gen p mean: -0.24545903503894806, mean p set: 0.447416752576828
loss_pred:0.015545079484581947, decouple_loss:0.0030002351850271225
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463629722595215, gen p mean: -0.24626879394054413, mean p set: 0.44688504934310913
loss_pred:0.01532295998185873, decouple_loss:0.0029825568199157715
The modified gen p mean: 0.4468565583229065, gen p mean: -0.253824383020401, mean p set: 0.44743743538856506
loss_pred:0.016126612201333046, decouple_loss:0.0031404499895870686
The modified gen p mean: 0.44680285453796387, gen p mean: -0.2556021511554718, mean p set: 0.4473738372325897
loss_pred:0.015199020504951477, decouple_loss:0.002817512024194002
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465593993663788, gen p mean: -0.25187310576438904, mean p set: 0.44713205099105835
loss_pred:0.015770750120282173, decouple_loss:0.0029253943357616663
The modified gen p mean: 0.4478544592857361, gen p mean: -0.2480703443288803, mean p set: 0.44842812418937683
loss_pred:0.015810731798410416, decouple_loss:0.002720253774896264
The modified gen p mean: 0.4469855725765228, gen p mean: -0.24832968413829803, mean p set: 0.44751641154289246
loss_pred:0.015777280554175377, decouple_loss:0.002836529863998294
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721877574920654, gen p mean: -0.24748258292675018, mean p set: 0.4477875828742981
loss_pred:0.016336193308234215, decouple_loss:0.0028782242443412542
The modified gen p mean: 0.4480587840080261, gen p mean: -0.24583154916763306, mean p set: 0.4486280083656311
loss_pred:0.015076056122779846, decouple_loss:0.0030915781389921904
The modified gen p mean: 0.44664737582206726, gen p mean: -0.24836593866348267, mean p set: 0.44717565178871155
loss_pred:0.016308698803186417, decouple_loss:0.0029241612646728754
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720155000686646, gen p mean: -0.24175797402858734, mean p set: 0.4477759003639221
loss_pred:0.015611586160957813, decouple_loss:0.003009440843015909
The modified gen p mean: 0.4472067952156067, gen p mean: -0.24064958095550537, mean p set: 0.4477759599685669The modified gen p mean: 0.44776350259780884, gen p mean: -0.2450627237558365, mean p set: 0.4482881724834442
loss_pred:0.016376418992877007, decouple_loss:0.002786430763080716
loss_pred:0.015710730105638504, decouple_loss:0.002935060067102313
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473755359649658, gen p mean: -0.24586954712867737, mean p set: 0.4479525089263916
loss_pred:0.01562953181564808, decouple_loss:0.0027896761894226074
The modified gen p mean: 0.44673898816108704, gen p mean: -0.24187150597572327, mean p set: 0.44732168316841125
loss_pred:0.015302188694477081, decouple_loss:0.00288436864502728
The modified gen p mean: 0.4471617043018341, gen p mean: -0.24049662053585052, mean p set: 0.44768741726875305
loss_pred:0.01523633673787117, decouple_loss:0.0028444635681807995
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642749428749084, gen p mean: -0.24506352841854095, mean p set: 0.4470026195049286
loss_pred:0.01590312458574772, decouple_loss:0.0030033905059099197
The modified gen p mean: 0.4460495710372925, gen p mean: -0.24777264893054962, mean p set: 0.44662564992904663
loss_pred:0.016171623021364212, decouple_loss:0.0031025041826069355
The modified gen p mean: 0.4481010138988495, gen p mean: -0.23867198824882507, mean p set: 0.44862768054008484
loss_pred:0.015205112285912037, decouple_loss:0.003077000379562378
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460000693798065, gen p mean: -0.23965002596378326, mean p set: 0.4465774595737457
loss_pred:0.016549134626984596, decouple_loss:0.002966115949675441
The modified gen p mean: 0.4472923278808594, gen p mean: -0.2382870614528656, mean p set: 0.44786933064460754
loss_pred:0.01590767689049244, decouple_loss:0.0031546803656965494
The modified gen p mean: 0.447153240442276, gen p mean: -0.24020522832870483, mean p set: 0.4476839005947113
loss_pred:0.014588412828743458, decouple_loss:0.0032885761465877295
2023-04-26 22:38:50 testing...
The modified gen p mean: 0.4482302963733673, gen p mean: -0.24155202507972717, mean p set: 0.44879910349845886
loss_pred:0.017418937757611275, decouple_loss:0.0031433268450200558
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24388544261455536, mean p set: 0.4499112665653229
loss_pred:0.017471734434366226, decouple_loss:0.0032033456955105066
The modified gen p mean: 0.449253648519516, gen p mean: -0.2439325600862503, mean p set: 0.4498290419578552
loss_pred:0.017045294865965843, decouple_loss:0.003221644554287195
WV_1_PC_1_EH_0_PS_30, loss: 0.01747146062552929, avg_mse: 0.02570660226047039
current test mse: 0.025707
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466967284679413, gen p mean: -0.2454579919576645, mean p set: 0.4472716748714447
loss_pred:0.01669752039015293, decouple_loss:0.0029014493338763714
The modified gen p mean: 0.447456419467926, gen p mean: -0.24806664884090424, mean p set: 0.4480327367782593
loss_pred:0.015629637986421585, decouple_loss:0.0028766451869159937
The modified gen p mean: 0.4481971263885498, gen p mean: -0.2406073808670044, mean p set: 0.44872787594795227
loss_pred:0.014936912804841995, decouple_loss:0.0030378869269043207
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472220838069916, gen p mean: -0.23747625946998596, mean p set: 0.4477570950984955
loss_pred:0.015176698565483093, decouple_loss:0.00321791204623878
The modified gen p mean: 0.4470805525779724, gen p mean: -0.24547751247882843, mean p set: 0.44765499234199524
loss_pred:0.01588287577033043, decouple_loss:0.0029266916681081057
The modified gen p mean: 0.4462806284427643, gen p mean: -0.24917331337928772, mean p set: 0.4468553960323334
loss_pred:0.01612701825797558, decouple_loss:0.0033803200349211693
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460237920284271, gen p mean: -0.24098458886146545, mean p set: 0.4465501010417938
loss_pred:0.01600576564669609, decouple_loss:0.003283790312707424
The modified gen p mean: 0.4472806751728058, gen p mean: -0.24199645221233368, mean p set: 0.44785767793655396
loss_pred:0.016330121085047722, decouple_loss:0.0031124905217438936
The modified gen p mean: 0.44710370898246765, gen p mean: -0.2398054599761963, mean p set: 0.4476735293865204
loss_pred:0.015678811818361282, decouple_loss:0.003230347065255046
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466586410999298, gen p mean: -0.24131818115711212, mean p set: 0.4471876323223114
loss_pred:0.016190139576792717, decouple_loss:0.0030109931249171495
The modified gen p mean: 0.4468560218811035, gen p mean: -0.23992721736431122, mean p set: 0.4474334716796875
loss_pred:0.01609528250992298, decouple_loss:0.0029583889991045
The modified gen p mean: 0.44802865386009216, gen p mean: -0.23313161730766296, mean p set: 0.44860100746154785
loss_pred:0.015273275785148144, decouple_loss:0.003043173812329769
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469303488731384, gen p mean: -0.23620563745498657, mean p set: 0.4475066065788269
loss_pred:0.014597606845200062, decouple_loss:0.0030909173656255007
The modified gen p mean: 0.4483081102371216, gen p mean: -0.23224620521068573, mean p set: 0.44888240098953247
loss_pred:0.015378066338598728, decouple_loss:0.0032031554728746414
The modified gen p mean: 0.446481853723526, gen p mean: -0.23661211133003235, mean p set: 0.4470112919807434
loss_pred:0.014780113473534584, decouple_loss:0.0032246739137917757
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465268850326538, gen p mean: -0.23819230496883392, mean p set: 0.4471038579940796
loss_pred:0.016763944178819656, decouple_loss:0.002894147764891386
The modified gen p mean: 0.4465303421020508, gen p mean: -0.23016296327114105, mean p set: 0.4471050798892975
loss_pred:0.014923778362572193, decouple_loss:0.003017899114638567
The modified gen p mean: 0.44654691219329834, gen p mean: -0.23753049969673157, mean p set: 0.44708362221717834
loss_pred:0.01550739910453558, decouple_loss:0.002980325371026993
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675782322883606, gen p mean: -0.23706142604351044, mean p set: 0.4473371207714081
loss_pred:0.01498383842408657, decouple_loss:0.0030424543656408787
The modified gen p mean: 0.4472232162952423, gen p mean: -0.23782384395599365, mean p set: 0.4477977156639099
loss_pred:0.015440834686160088, decouple_loss:0.0029814059380441904
The modified gen p mean: 0.44740569591522217, gen p mean: -0.241373211145401, mean p set: 0.447934627532959
loss_pred:0.01608337089419365, decouple_loss:0.002833678387105465
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470688998699188, gen p mean: -0.23625414073467255, mean p set: 0.4476470947265625
loss_pred:0.015245463699102402, decouple_loss:0.0032453793101012707
The modified gen p mean: 0.44794344902038574, gen p mean: -0.241371288895607, mean p set: 0.4485190510749817
loss_pred:0.01616787724196911, decouple_loss:0.0030273552983999252
The modified gen p mean: 0.447650283575058, gen p mean: -0.24113613367080688, mean p set: 0.44817930459976196
loss_pred:0.015678243711590767, decouple_loss:0.0029013536404818296
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708943367004395, gen p mean: -0.2378380298614502, mean p set: 0.4476739168167114
loss_pred:0.015937892720103264, decouple_loss:0.002872081473469734
The modified gen p mean: 0.4477541148662567, gen p mean: -0.23915107548236847, mean p set: 0.44832831621170044
loss_pred:0.016091056168079376, decouple_loss:0.0029553016647696495
The modified gen p mean: 0.4474889039993286, gen p mean: -0.2377653867006302, mean p set: 0.44801655411720276
loss_pred:0.014487119391560555, decouple_loss:0.0028792049270123243
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470643997192383, gen p mean: -0.23809261620044708, mean p set: 0.44764021039009094
loss_pred:0.01623395085334778, decouple_loss:0.0031104141380637884
The modified gen p mean: 0.4465271234512329, gen p mean: -0.2462950348854065, mean p set: 0.4471111297607422
loss_pred:0.015484146773815155, decouple_loss:0.002878924598917365
The modified gen p mean: 0.4473487436771393, gen p mean: -0.2429271638393402, mean p set: 0.4478755593299866
loss_pred:0.016161303967237473, decouple_loss:0.0030437009409070015
2023-04-26 22:42:18 testing...
The modified gen p mean: 0.4482245147228241, gen p mean: -0.23256489634513855, mean p set: 0.44879910349845886
loss_pred:0.017507145181298256, decouple_loss:0.0033351897727698088
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23559820652008057, mean p set: 0.4499112665653229
loss_pred:0.01746862381696701, decouple_loss:0.003395176725462079
The modified gen p mean: 0.4492628872394562, gen p mean: -0.23520846664905548, mean p set: 0.4498290419578552
loss_pred:0.017034076154232025, decouple_loss:0.0033121888991445303
WV_1_PC_1_EH_0_PS_30, loss: 0.017503991723060608, avg_mse: 0.025749268010258675
current test mse: 0.025749
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007240772247314, gen p mean: -0.22920824587345123, mean p set: 0.4506046175956726
loss_pred:0.01661689765751362, decouple_loss:0.0029861219227313995
The modified gen p mean: 0.4493360221385956, gen p mean: -0.2315019965171814, mean p set: 0.44991418719291687
loss_pred:0.016076982021331787, decouple_loss:0.003054883098229766
The modified gen p mean: 0.449975848197937, gen p mean: -0.22867749631404877, mean p set: 0.4505513906478882
loss_pred:0.01577325165271759, decouple_loss:0.0034260028041899204
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44907239079475403, gen p mean: -0.22831687331199646, mean p set: 0.44959837198257446
loss_pred:0.0165408942848444, decouple_loss:0.002958721946924925
The modified gen p mean: 0.4483676254749298, gen p mean: -0.23660437762737274, mean p set: 0.4489458501338959
loss_pred:0.016014939174056053, decouple_loss:0.003161983098834753
The modified gen p mean: 0.4475644528865814, gen p mean: -0.23429542779922485, mean p set: 0.44813892245292664
loss_pred:0.01716875284910202, decouple_loss:0.0029435434844344854
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483242332935333, gen p mean: -0.23075538873672485, mean p set: 0.44885316491127014
loss_pred:0.01641313172876835, decouple_loss:0.0031970480922609568
The modified gen p mean: 0.44910067319869995, gen p mean: -0.231594055891037, mean p set: 0.4496765732765198The modified gen p mean: 0.44917431473731995, gen p mean: -0.23134194314479828, mean p set: 0.4497471749782562
loss_pred:0.01682339981198311, decouple_loss:0.00312020699493587loss_pred:0.015158078633248806, decouple_loss:0.0031195390038192272
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868889451026917, gen p mean: -0.23634073138237, mean p set: 0.449221134185791
loss_pred:0.01591969095170498, decouple_loss:0.002777433954179287
The modified gen p mean: 0.44958779215812683, gen p mean: -0.23410850763320923, mean p set: 0.45017269253730774
loss_pred:0.016239136457443237, decouple_loss:0.0026562134735286236
The modified gen p mean: 0.44793593883514404, gen p mean: -0.2335744947195053, mean p set: 0.44850999116897583
loss_pred:0.016456061974167824, decouple_loss:0.0028518319595605135
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501971900463104, gen p mean: -0.22561399638652802, mean p set: 0.4507763385772705
loss_pred:0.015735240653157234, decouple_loss:0.00297917565330863
The modified gen p mean: 0.4497421085834503, gen p mean: -0.23640179634094238, mean p set: 0.4503171145915985
loss_pred:0.01609162800014019, decouple_loss:0.0028743515722453594
The modified gen p mean: 0.4485386312007904, gen p mean: -0.23070409893989563, mean p set: 0.44906798005104065
loss_pred:0.016147075220942497, decouple_loss:0.0029782792553305626
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048820972442627, gen p mean: -0.23422163724899292, mean p set: 0.45106619596481323
loss_pred:0.015497451648116112, decouple_loss:0.0029926705174148083
The modified gen p mean: 0.44788146018981934, gen p mean: -0.233531191945076, mean p set: 0.44845327734947205
loss_pred:0.015395148657262325, decouple_loss:0.002917248522862792
The modified gen p mean: 0.44801411032676697, gen p mean: -0.23559044301509857, mean p set: 0.4485381245613098
loss_pred:0.017056314274668694, decouple_loss:0.00284055364318192
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508037269115448, gen p mean: -0.23562310636043549, mean p set: 0.45138660073280334
loss_pred:0.01574980467557907, decouple_loss:0.0029414966702461243
The modified gen p mean: 0.448917955160141, gen p mean: -0.23994992673397064, mean p set: 0.44949063658714294
loss_pred:0.016242332756519318, decouple_loss:0.002942887833341956
The modified gen p mean: 0.44995224475860596, gen p mean: -0.23533838987350464, mean p set: 0.4504837691783905
loss_pred:0.016032643616199493, decouple_loss:0.0028647552244365215
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959548115730286, gen p mean: -0.23590366542339325, mean p set: 0.4501734673976898
loss_pred:0.016013937070965767, decouple_loss:0.002967260777950287
The modified gen p mean: 0.4507127106189728, gen p mean: -0.23208969831466675, mean p set: 0.45129016041755676
loss_pred:0.016033362597227097, decouple_loss:0.0028267677407711744
The modified gen p mean: 0.4503380358219147, gen p mean: -0.23063106834888458, mean p set: 0.4508661925792694
loss_pred:0.01593056693673134, decouple_loss:0.0029221235308796167
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448542058467865, gen p mean: -0.2335742861032486, mean p set: 0.4491119980812073
loss_pred:0.01686827279627323, decouple_loss:0.002860642969608307
The modified gen p mean: 0.44939008355140686, gen p mean: -0.23689985275268555, mean p set: 0.44996631145477295
loss_pred:0.01572546176612377, decouple_loss:0.00293188588693738
The modified gen p mean: 0.4500938057899475, gen p mean: -0.2297288179397583, mean p set: 0.4506189823150635
loss_pred:0.015974830836057663, decouple_loss:0.0029645354952663183
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485117197036743, gen p mean: -0.23598752915859222, mean p set: 0.44908788800239563
loss_pred:0.01683228835463524, decouple_loss:0.0028633030597120523
The modified gen p mean: 0.4491863548755646, gen p mean: -0.23598919808864594, mean p set: 0.4497663974761963The modified gen p mean: 0.44915780425071716, gen p mean: -0.2390117347240448, mean p set: 0.4496835172176361
loss_pred:0.015580879524350166, decouple_loss:0.002939690137282014
loss_pred:0.01629742980003357, decouple_loss:0.0028754814993590117
2023-04-26 22:46:35 testing...
The modified gen p mean: 0.4482329487800598, gen p mean: -0.24146625399589539, mean p set: 0.44879910349845886
loss_pred:0.01747964695096016, decouple_loss:0.0034358843695372343
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2450079321861267, mean p set: 0.4499112665653229
loss_pred:0.017511891201138496, decouple_loss:0.00360933062620461
The modified gen p mean: 0.44924789667129517, gen p mean: -0.2440202683210373, mean p set: 0.4498290419578552
loss_pred:0.017038527876138687, decouple_loss:0.0032983392011374235
WV_1_PC_1_EH_0_PS_30, loss: 0.017515746876597404, avg_mse: 0.02575303055346012
current test mse: 0.025753
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505635201931, gen p mean: -0.2389734834432602, mean p set: 0.451143354177475
loss_pred:0.016184747219085693, decouple_loss:0.0029006535187363625
The modified gen p mean: 0.44955238699913025, gen p mean: -0.23854826390743256, mean p set: 0.45013123750686646
loss_pred:0.016176702454686165, decouple_loss:0.002840731991454959
The modified gen p mean: 0.44899168610572815, gen p mean: -0.24228212237358093, mean p set: 0.4495182931423187
loss_pred:0.015773212537169456, decouple_loss:0.0028620520606637
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491303265094757, gen p mean: -0.24419210851192474, mean p set: 0.4496645927429199
loss_pred:0.01596793159842491, decouple_loss:0.0028740749694406986
The modified gen p mean: 0.44873130321502686, gen p mean: -0.24583734571933746, mean p set: 0.4493071436882019The modified gen p mean: 0.44968652725219727, gen p mean: -0.2452523559331894, mean p set: 0.4502677023410797
loss_pred:0.01682853326201439, decouple_loss:0.003003970952704549
loss_pred:0.016248144209384918, decouple_loss:0.002812432823702693
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500589072704315, gen p mean: -0.2379978597164154, mean p set: 0.4505905210971832
loss_pred:0.016076218336820602, decouple_loss:0.0029241926968097687
The modified gen p mean: 0.44968605041503906, gen p mean: -0.24276158213615417, mean p set: 0.45026013255119324
loss_pred:0.016198525205254555, decouple_loss:0.0030405253637582064
The modified gen p mean: 0.4482751488685608, gen p mean: -0.24400299787521362, mean p set: 0.44884949922561646
loss_pred:0.016379663720726967, decouple_loss:0.0029251587111502886
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914698600769043, gen p mean: -0.2450268715620041, mean p set: 0.44967731833457947
loss_pred:0.015897465869784355, decouple_loss:0.0029876972548663616
The modified gen p mean: 0.448297381401062, gen p mean: -0.24002163112163544, mean p set: 0.4488740861415863The modified gen p mean: 0.44914230704307556, gen p mean: -0.24049727618694305, mean p set: 0.4497183561325073
loss_pred:0.016205057501792908, decouple_loss:0.0028822734020650387loss_pred:0.016448980197310448, decouple_loss:0.0028719480615109205
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813072681427, gen p mean: -0.24309122562408447, mean p set: 0.44870686531066895
loss_pred:0.01719401590526104, decouple_loss:0.0030396694783121347
The modified gen p mean: 0.44842249155044556, gen p mean: -0.24429839849472046, mean p set: 0.448993444442749
loss_pred:0.01626056246459484, decouple_loss:0.0030241829808801413
The modified gen p mean: 0.4493103325366974, gen p mean: -0.24623198807239532, mean p set: 0.4498424530029297
loss_pred:0.01628345064818859, decouple_loss:0.0030265962705016136
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881632924079895, gen p mean: -0.23908498883247375, mean p set: 0.4493984878063202
loss_pred:0.01662377454340458, decouple_loss:0.002962378552183509
The modified gen p mean: 0.4500954747200012, gen p mean: -0.23833270370960236, mean p set: 0.45066767930984497The modified gen p mean: 0.44962480664253235, gen p mean: -0.23968559503555298, mean p set: 0.4501534700393677
loss_pred:0.01649620197713375, decouple_loss:0.0029639163985848427
loss_pred:0.0159002635627985, decouple_loss:0.002871759934350848
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495570659637451, gen p mean: -0.2400623857975006, mean p set: 0.45013657212257385
loss_pred:0.01577187143266201, decouple_loss:0.002887678099796176
The modified gen p mean: 0.4501296281814575, gen p mean: -0.23397423326969147, mean p set: 0.45070981979370117
loss_pred:0.016005413606762886, decouple_loss:0.003141804365441203
The modified gen p mean: 0.4488057494163513, gen p mean: -0.23625358939170837, mean p set: 0.4493391215801239
loss_pred:0.015916217118501663, decouple_loss:0.0029515670612454414
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507279396057129, gen p mean: -0.23024387657642365, mean p set: 0.45130491256713867
loss_pred:0.016483882442116737, decouple_loss:0.003448386676609516
The modified gen p mean: 0.44893765449523926, gen p mean: -0.2334991693496704, mean p set: 0.4495089054107666
loss_pred:0.016615739092230797, decouple_loss:0.003089306177571416
The modified gen p mean: 0.44921979308128357, gen p mean: -0.23632726073265076, mean p set: 0.4497511684894562
loss_pred:0.017178857699036598, decouple_loss:0.0033294628374278545
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487629532814026, gen p mean: -0.24245630204677582, mean p set: 0.44934147596359253
loss_pred:0.01645522564649582, decouple_loss:0.003406540723517537
The modified gen p mean: 0.44794535636901855, gen p mean: -0.24466830492019653, mean p set: 0.44851261377334595
loss_pred:0.015523935668170452, decouple_loss:0.003286476945504546
The modified gen p mean: 0.449428528547287, gen p mean: -0.24132058024406433, mean p set: 0.44995465874671936
loss_pred:0.016051506623625755, decouple_loss:0.003593933302909136
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491793215274811, gen p mean: -0.2430228441953659, mean p set: 0.4497552812099457
loss_pred:0.016396919265389442, decouple_loss:0.003309819148853421
The modified gen p mean: 0.44919681549072266, gen p mean: -0.25184521079063416, mean p set: 0.4497673809528351
loss_pred:0.017051341012120247, decouple_loss:0.0032710698433220387
The modified gen p mean: 0.4488942325115204, gen p mean: -0.25165730714797974, mean p set: 0.4494198262691498
loss_pred:0.01746782287955284, decouple_loss:0.0032614076044410467
2023-04-26 22:50:02 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25692862272262573, mean p set: 0.4499112665653229
loss_pred:0.018913425505161285, decouple_loss:0.0037193293683230877
The modified gen p mean: 0.4482235312461853, gen p mean: -0.2539387345314026, mean p set: 0.44879910349845886
loss_pred:0.01863180659711361, decouple_loss:0.0036072363145649433
The modified gen p mean: 0.4492584466934204, gen p mean: -0.25675734877586365, mean p set: 0.4498290419578552
loss_pred:0.018373016268014908, decouple_loss:0.003558616153895855
WV_1_PC_1_EH_0_PS_30, loss: 0.018820837140083313, avg_mse: 0.027831457555294037
current test mse: 0.027831
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697892665863037, gen p mean: -0.25739631056785583, mean p set: 0.4475100040435791
loss_pred:0.01693566143512726, decouple_loss:0.003901983378455043
The modified gen p mean: 0.44728416204452515, gen p mean: -0.25874751806259155, mean p set: 0.44785624742507935
loss_pred:0.017098180949687958, decouple_loss:0.0037331287749111652
The modified gen p mean: 0.44655245542526245, gen p mean: -0.2622864842414856, mean p set: 0.4471312463283539
loss_pred:0.01716046780347824, decouple_loss:0.003509559202939272
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687414169311523, gen p mean: -0.2605784833431244, mean p set: 0.44740432500839233
loss_pred:0.01750350371003151, decouple_loss:0.0035363384522497654
The modified gen p mean: 0.44645819067955017, gen p mean: -0.2551306188106537, mean p set: 0.44703078269958496
The modified gen p mean: 0.4475756287574768, gen p mean: -0.25919198989868164, mean p set: 0.4481556713581085
loss_pred:0.017593394964933395, decouple_loss:0.003652858780696988
loss_pred:0.017674557864665985, decouple_loss:0.003763879183679819
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698452949523926, gen p mean: -0.2612653076648712, mean p set: 0.447516530752182
loss_pred:0.017697617411613464, decouple_loss:0.0037135614547878504
The modified gen p mean: 0.4468700885772705, gen p mean: -0.261976033449173, mean p set: 0.44745346903800964
The modified gen p mean: 0.4464057385921478, gen p mean: -0.26369282603263855, mean p set: 0.4469849467277527
loss_pred:0.017941957339644432, decouple_loss:0.003733055666089058
loss_pred:0.016763078048825264, decouple_loss:0.0035696798004209995
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731050729751587, gen p mean: -0.26622796058654785, mean p set: 0.44783279299736023
loss_pred:0.01685742661356926, decouple_loss:0.0037861899472773075
The modified gen p mean: 0.4469858705997467, gen p mean: -0.26895028352737427, mean p set: 0.4475601017475128
The modified gen p mean: 0.4473907947540283, gen p mean: -0.26999616622924805, mean p set: 0.447966605424881
loss_pred:0.01688896119594574, decouple_loss:0.0037981325294822454
loss_pred:0.016394518315792084, decouple_loss:0.003757362486794591
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44632208347320557, gen p mean: -0.261408269405365, mean p set: 0.4468908905982971
loss_pred:0.016744310036301613, decouple_loss:0.004143749363720417
The modified gen p mean: 0.44638726115226746, gen p mean: -0.2583305537700653, mean p set: 0.44692057371139526The modified gen p mean: 0.4483485817909241, gen p mean: -0.25702187418937683, mean p set: 0.44892388582229614
loss_pred:0.016975753009319305, decouple_loss:0.004238390363752842loss_pred:0.018215103074908257, decouple_loss:0.004274246282875538
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470057785511017, gen p mean: -0.253505140542984, mean p set: 0.4475838840007782
loss_pred:0.017120756208896637, decouple_loss:0.004173750057816505
The modified gen p mean: 0.44871488213539124, gen p mean: -0.25001367926597595, mean p set: 0.44924843311309814The modified gen p mean: 0.44742876291275024, gen p mean: -0.24734492599964142, mean p set: 0.4480137526988983
loss_pred:0.01692124642431736, decouple_loss:0.003980478271842003
loss_pred:0.017163746058940887, decouple_loss:0.004014236386865377
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44543489813804626, gen p mean: -0.23521435260772705, mean p set: 0.4460061490535736
loss_pred:0.016906755045056343, decouple_loss:0.004184162709861994
The modified gen p mean: 0.44664132595062256, gen p mean: -0.23618866503238678, mean p set: 0.4471677839756012The modified gen p mean: 0.4469262361526489, gen p mean: -0.2378254234790802, mean p set: 0.44750016927719116
loss_pred:0.0181579627096653, decouple_loss:0.00415113614872098
loss_pred:0.016521461308002472, decouple_loss:0.004008188843727112
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478800594806671, gen p mean: -0.2336672693490982, mean p set: 0.44845691323280334
loss_pred:0.01707717403769493, decouple_loss:0.0037850274238735437
The modified gen p mean: 0.4471932053565979, gen p mean: -0.23618054389953613, mean p set: 0.44777220487594604
loss_pred:0.016635961830615997, decouple_loss:0.004046805668622255
The modified gen p mean: 0.4475308358669281, gen p mean: -0.2341388463973999, mean p set: 0.448056697845459
loss_pred:0.01668325997889042, decouple_loss:0.004040530417114496
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457562267780304, gen p mean: -0.23307542502880096, mean p set: 0.4463326036930084
loss_pred:0.01624673418700695, decouple_loss:0.0038249355275183916
The modified gen p mean: 0.4470441937446594, gen p mean: -0.23125606775283813, mean p set: 0.44762295484542847
loss_pred:0.01656939834356308, decouple_loss:0.0038743626791983843
The modified gen p mean: 0.44658857583999634, gen p mean: -0.23279380798339844, mean p set: 0.4471190571784973
loss_pred:0.01615438610315323, decouple_loss:0.003762465203180909
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481690227985382, gen p mean: -0.22733667492866516, mean p set: 0.44875115156173706
loss_pred:0.017386021092534065, decouple_loss:0.003940940834581852
The modified gen p mean: 0.447719931602478, gen p mean: -0.23058493435382843, mean p set: 0.44829845428466797The modified gen p mean: 0.4468703269958496, gen p mean: -0.22740337252616882, mean p set: 0.44739779829978943
loss_pred:0.015873951837420464, decouple_loss:0.00379564194008708
loss_pred:0.016490381211042404, decouple_loss:0.0039005426224321127
2023-04-26 22:54:17 testing...
The modified gen p mean: 0.44822216033935547, gen p mean: -0.22633886337280273, mean p set: 0.44879910349845886
loss_pred:0.017832765355706215, decouple_loss:0.0037915606517344713
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22941237688064575, mean p set: 0.4499112665653229
loss_pred:0.017964661121368408, decouple_loss:0.00382445240393281
The modified gen p mean: 0.44925519824028015, gen p mean: -0.2290390282869339, mean p set: 0.4498290419578552
loss_pred:0.017472775653004646, decouple_loss:0.004029772710055113
WV_1_PC_1_EH_0_PS_30, loss: 0.01795083098113537, avg_mse: 0.02620871178805828
current test mse: 0.026209
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714492559432983, gen p mean: -0.230003222823143, mean p set: 0.44771912693977356
loss_pred:0.016680913046002388, decouple_loss:0.0038886868860572577
The modified gen p mean: 0.44759392738342285, gen p mean: -0.22977109253406525, mean p set: 0.4481663107872009
loss_pred:0.017284391447901726, decouple_loss:0.0037844351027160883
The modified gen p mean: 0.44669458270072937, gen p mean: -0.2257300764322281, mean p set: 0.4472208023071289
loss_pred:0.016548333689570427, decouple_loss:0.003797180950641632
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460879862308502, gen p mean: -0.23840509355068207, mean p set: 0.4466158449649811
loss_pred:0.016080697998404503, decouple_loss:0.003576299175620079
The modified gen p mean: 0.4475763440132141, gen p mean: -0.24154038727283478, mean p set: 0.44815176725387573
loss_pred:0.016401007771492004, decouple_loss:0.003591331886127591
The modified gen p mean: 0.44868025183677673, gen p mean: -0.24044980108737946, mean p set: 0.4492546021938324
loss_pred:0.016820447519421577, decouple_loss:0.003634205786511302
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44541215896606445, gen p mean: -0.24721159040927887, mean p set: 0.44594070315361023
loss_pred:0.015965258702635765, decouple_loss:0.003609864506870508
The modified gen p mean: 0.4472709894180298, gen p mean: -0.24931494891643524, mean p set: 0.4478478729724884
loss_pred:0.015846217051148415, decouple_loss:0.0038004573434591293
The modified gen p mean: 0.44915464520454407, gen p mean: -0.2481764405965805, mean p set: 0.44973060488700867
loss_pred:0.016289982944726944, decouple_loss:0.003640680806711316
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478134214878082, gen p mean: -0.24957604706287384, mean p set: 0.44834670424461365
loss_pred:0.01683729887008667, decouple_loss:0.004022473469376564
The modified gen p mean: 0.4464118182659149, gen p mean: -0.2505348026752472, mean p set: 0.4469926357269287
loss_pred:0.016645612195134163, decouple_loss:0.003940407652407885
The modified gen p mean: 0.4462137222290039, gen p mean: -0.2473663091659546, mean p set: 0.44678959250450134
loss_pred:0.016013367101550102, decouple_loss:0.0041461000218987465
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483013451099396, gen p mean: -0.2454686462879181, mean p set: 0.44887736439704895
loss_pred:0.016787089407444, decouple_loss:0.003799986559897661
The modified gen p mean: 0.44713103771209717, gen p mean: -0.24247439205646515, mean p set: 0.44765836000442505The modified gen p mean: 0.4477632939815521, gen p mean: -0.2470952868461609, mean p set: 0.44834285974502563
loss_pred:0.017121290788054466, decouple_loss:0.00407147454097867
loss_pred:0.016688881441950798, decouple_loss:0.004025144036859274
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794631004333496, gen p mean: -0.2397060990333557, mean p set: 0.4485260546207428
loss_pred:0.016484491527080536, decouple_loss:0.0037763456348329782
The modified gen p mean: 0.4466545283794403, gen p mean: -0.24364645779132843, mean p set: 0.44718244671821594The modified gen p mean: 0.4465213119983673, gen p mean: -0.2389882355928421, mean p set: 0.44709280133247375
loss_pred:0.016089485958218575, decouple_loss:0.00356187392026186
loss_pred:0.016054518520832062, decouple_loss:0.0037153768353164196
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467979371547699, gen p mean: -0.23431016504764557, mean p set: 0.4473719894886017
loss_pred:0.016551977023482323, decouple_loss:0.004151691682636738
The modified gen p mean: 0.44547757506370544, gen p mean: -0.23509104549884796, mean p set: 0.44600710272789The modified gen p mean: 0.44728609919548035, gen p mean: -0.23990760743618011, mean p set: 0.44786328077316284
loss_pred:0.015458506532013416, decouple_loss:0.0038503562100231647
loss_pred:0.016580134630203247, decouple_loss:0.0039296457543969154
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645506143569946, gen p mean: -0.2326182872056961, mean p set: 0.4470318555831909
loss_pred:0.016201047226786613, decouple_loss:0.0035303179174661636
The modified gen p mean: 0.4491206705570221, gen p mean: -0.23448364436626434, mean p set: 0.44964826107025146
loss_pred:0.01627974584698677, decouple_loss:0.0036197740118950605
The modified gen p mean: 0.44635632634162903, gen p mean: -0.23501460254192352, mean p set: 0.44693562388420105
loss_pred:0.01597021333873272, decouple_loss:0.003816428128629923
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818538427352905, gen p mean: -0.2291170060634613, mean p set: 0.44875821471214294
loss_pred:0.016830017790198326, decouple_loss:0.003537814598530531
The modified gen p mean: 0.4480595588684082, gen p mean: -0.22685828804969788, mean p set: 0.44864004850387573
loss_pred:0.016897566616535187, decouple_loss:0.0037686205469071865
The modified gen p mean: 0.44694241881370544, gen p mean: -0.23514389991760254, mean p set: 0.4474697411060333
loss_pred:0.015942296013236046, decouple_loss:0.0037781079299747944
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462355673313141, gen p mean: -0.23251871764659882, mean p set: 0.44681257009506226
loss_pred:0.01567666605114937, decouple_loss:0.0035053258761763573
The modified gen p mean: 0.4461023807525635, gen p mean: -0.22975412011146545, mean p set: 0.4466286599636078The modified gen p mean: 0.44730144739151, gen p mean: -0.22987206280231476, mean p set: 0.44787725806236267
loss_pred:0.016945714130997658, decouple_loss:0.003821026301011443
loss_pred:0.015970993787050247, decouple_loss:0.003826902713626623
2023-04-26 22:57:44 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22914725542068481, mean p set: 0.4499112665653229
loss_pred:0.017628677189350128, decouple_loss:0.0036753390450030565
The modified gen p mean: 0.4482218325138092, gen p mean: -0.22656980156898499, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492577910423279, gen p mean: -0.2290019541978836, mean p set: 0.4498290419578552
loss_pred:0.01750952936708927, decouple_loss:0.003658630885183811
loss_pred:0.017123069614171982, decouple_loss:0.0035270308144390583
WV_1_PC_1_EH_0_PS_30, loss: 0.017601443454623222, avg_mse: 0.025826718658208847
current test mse: 0.025827
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919562339782715, gen p mean: -0.2303999811410904, mean p set: 0.44972550868988037
loss_pred:0.016571421176195145, decouple_loss:0.0036076887045055628
The modified gen p mean: 0.4490611255168915, gen p mean: -0.2358565330505371, mean p set: 0.4496367573738098
loss_pred:0.01672498509287834, decouple_loss:0.0036598690785467625
The modified gen p mean: 0.44769930839538574, gen p mean: -0.22893120348453522, mean p set: 0.4482733905315399
loss_pred:0.017032116651535034, decouple_loss:0.0034895658027380705
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889530539512634, gen p mean: -0.22983211278915405, mean p set: 0.44942986965179443
loss_pred:0.016735965386033058, decouple_loss:0.0034271832555532455
The modified gen p mean: 0.4487665891647339, gen p mean: -0.22477582097053528, mean p set: 0.44934189319610596
loss_pred:0.016769757494330406, decouple_loss:0.0037374221719801426
The modified gen p mean: 0.44828954339027405, gen p mean: -0.22950972616672516, mean p set: 0.4488653242588043
loss_pred:0.016864297911524773, decouple_loss:0.0035583877470344305
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848933815956116, gen p mean: -0.22010143101215363, mean p set: 0.44901883602142334
loss_pred:0.015854379162192345, decouple_loss:0.0036344423424452543
The modified gen p mean: 0.448599636554718, gen p mean: -0.2217809557914734, mean p set: 0.44917774200439453
loss_pred:0.017068155109882355, decouple_loss:0.003613231936469674
The modified gen p mean: 0.44788599014282227, gen p mean: -0.22196543216705322, mean p set: 0.44845834374427795
loss_pred:0.016414117068052292, decouple_loss:0.003738347440958023
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899338483810425, gen p mean: -0.22328974306583405, mean p set: 0.44951876997947693
loss_pred:0.016624730080366135, decouple_loss:0.0035716199781745672
The modified gen p mean: 0.44932690262794495, gen p mean: -0.2290223240852356, mean p set: 0.4498986005783081
loss_pred:0.01700008474290371, decouple_loss:0.0036433690693229437
The modified gen p mean: 0.44842684268951416, gen p mean: -0.21964909136295319, mean p set: 0.4490050673484802
loss_pred:0.017009425908327103, decouple_loss:0.0038725738413631916
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879353046417236, gen p mean: -0.22358134388923645, mean p set: 0.4493670165538788
loss_pred:0.01618891768157482, decouple_loss:0.0036583966575562954
The modified gen p mean: 0.44832268357276917, gen p mean: -0.2251226305961609, mean p set: 0.4488937258720398The modified gen p mean: 0.4474763870239258, gen p mean: -0.22488577663898468, mean p set: 0.4480001628398895
loss_pred:0.01735556311905384, decouple_loss:0.0038650338537991047
loss_pred:0.01736784540116787, decouple_loss:0.003542819060385227
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890016317367554, gen p mean: -0.22473907470703125, mean p set: 0.4494735598564148
loss_pred:0.01655370183289051, decouple_loss:0.0033897391986101866
The modified gen p mean: 0.44942590594291687, gen p mean: -0.22906069457530975, mean p set: 0.4500062167644501The modified gen p mean: 0.4490649700164795, gen p mean: -0.22498218715190887, mean p set: 0.4495936930179596
loss_pred:0.016487784683704376, decouple_loss:0.003296441398561001
loss_pred:0.016246750950813293, decouple_loss:0.0036154647823423147
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485958516597748, gen p mean: -0.22016263008117676, mean p set: 0.4491669833660126
loss_pred:0.016353333368897438, decouple_loss:0.003353592474013567
The modified gen p mean: 0.4488590359687805, gen p mean: -0.22598735988140106, mean p set: 0.4494372606277466The modified gen p mean: 0.4480857849121094, gen p mean: -0.22012707591056824, mean p set: 0.4486114978790283
loss_pred:0.016251029446721077, decouple_loss:0.0034206623677164316
loss_pred:0.017299609258770943, decouple_loss:0.0035302231553941965
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493022561073303, gen p mean: -0.22834612429141998, mean p set: 0.4498789310455322
loss_pred:0.01660834439098835, decouple_loss:0.0037834171671420336
The modified gen p mean: 0.44939368963241577, gen p mean: -0.22522693872451782, mean p set: 0.449928879737854
loss_pred:0.016734356060624123, decouple_loss:0.0037818371783941984
The modified gen p mean: 0.4489595890045166, gen p mean: -0.22471031546592712, mean p set: 0.4495360851287842
loss_pred:0.017021967098116875, decouple_loss:0.004003935493528843
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799551367759705, gen p mean: -0.22863218188285828, mean p set: 0.448577344417572
loss_pred:0.01664179377257824, decouple_loss:0.0035178768448531628
The modified gen p mean: 0.44868940114974976, gen p mean: -0.22718343138694763, mean p set: 0.4492647647857666
loss_pred:0.016220783814787865, decouple_loss:0.0034803126472979784
The modified gen p mean: 0.4472865164279938, gen p mean: -0.22467942535877228, mean p set: 0.4478098452091217
loss_pred:0.0172889344394207, decouple_loss:0.0033859401009976864
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482942819595337, gen p mean: -0.23253560066223145, mean p set: 0.4488733410835266
loss_pred:0.01681182160973549, decouple_loss:0.0033896767999976873
The modified gen p mean: 0.44887015223503113, gen p mean: -0.231720432639122, mean p set: 0.4494089186191559
The modified gen p mean: 0.44887644052505493, gen p mean: -0.23119130730628967, mean p set: 0.4494534134864807
loss_pred:0.016513947397470474, decouple_loss:0.0033176045399159193
loss_pred:0.01597176305949688, decouple_loss:0.003290749154984951
2023-04-26 23:02:01 testing...
The modified gen p mean: 0.44821858406066895, gen p mean: -0.22911062836647034, mean p set: 0.44879910349845886
loss_pred:0.01746561750769615, decouple_loss:0.003563513047993183
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23171062767505646, mean p set: 0.4499112665653229
loss_pred:0.017488587647676468, decouple_loss:0.0038169731851667166
The modified gen p mean: 0.4492565989494324, gen p mean: -0.2313929796218872, mean p set: 0.4498290419578552
loss_pred:0.01704397425055504, decouple_loss:0.0035769417881965637
WV_1_PC_1_EH_0_PS_30, loss: 0.017515351995825768, avg_mse: 0.025629457086324692
current test mse: 0.025629
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889169931411743, gen p mean: -0.2317238599061966, mean p set: 0.44947290420532227
loss_pred:0.016314102336764336, decouple_loss:0.0036173113621771336
The modified gen p mean: 0.44806110858917236, gen p mean: -0.2253764420747757, mean p set: 0.4486406445503235
loss_pred:0.017217688262462616, decouple_loss:0.003702268935739994
The modified gen p mean: 0.4482334554195404, gen p mean: -0.2311009019613266, mean p set: 0.4487597644329071
loss_pred:0.016620101407170296, decouple_loss:0.0033122145105153322
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494211971759796, gen p mean: -0.23412039875984192, mean p set: 0.4499538242816925
loss_pred:0.016413265839219093, decouple_loss:0.0030981097370386124
The modified gen p mean: 0.449389785528183, gen p mean: -0.23705841600894928, mean p set: 0.4499637186527252
loss_pred:0.01635938696563244, decouple_loss:0.003133779391646385
The modified gen p mean: 0.44928357005119324, gen p mean: -0.23866026103496552, mean p set: 0.4498598277568817
loss_pred:0.016489455476403236, decouple_loss:0.0031709305476397276
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479697346687317, gen p mean: -0.23191538453102112, mean p set: 0.448492169380188
loss_pred:0.016949517652392387, decouple_loss:0.003049565013498068
The modified gen p mean: 0.44905930757522583, gen p mean: -0.24173155426979065, mean p set: 0.4496401250362396
loss_pred:0.016670364886522293, decouple_loss:0.0033877205569297075
The modified gen p mean: 0.4494807720184326, gen p mean: -0.24095672369003296, mean p set: 0.45005539059638977
loss_pred:0.016025874763727188, decouple_loss:0.003105322364717722
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491104483604431, gen p mean: -0.24000567197799683, mean p set: 0.4496358335018158
loss_pred:0.016747141256928444, decouple_loss:0.003516001859679818
The modified gen p mean: 0.44772666692733765, gen p mean: -0.2312740683555603, mean p set: 0.44830653071403503
loss_pred:0.016244137659668922, decouple_loss:0.003140433458611369
The modified gen p mean: 0.4484637379646301, gen p mean: -0.24427537620067596, mean p set: 0.4490435719490051
loss_pred:0.016200995072722435, decouple_loss:0.003492002608254552
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478779733181, gen p mean: -0.2345750629901886, mean p set: 0.4484536051750183
loss_pred:0.016844844445586205, decouple_loss:0.0030377497896552086
The modified gen p mean: 0.44899237155914307, gen p mean: -0.24011677503585815, mean p set: 0.44956550002098083The modified gen p mean: 0.4489870071411133, gen p mean: -0.24140195548534393, mean p set: 0.44951972365379333
loss_pred:0.016738824546337128, decouple_loss:0.002852181438356638
loss_pred:0.016098733991384506, decouple_loss:0.0029522799886763096
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44929182529449463, gen p mean: -0.24017897248268127, mean p set: 0.4498666524887085
loss_pred:0.01700509898364544, decouple_loss:0.003138726344332099
The modified gen p mean: 0.4485412836074829, gen p mean: -0.234429270029068, mean p set: 0.44911903142929077
loss_pred:0.016529550775885582, decouple_loss:0.0029698165599256754
The modified gen p mean: 0.4474920928478241, gen p mean: -0.22875462472438812, mean p set: 0.4480302929878235
loss_pred:0.016515333205461502, decouple_loss:0.0032704423647373915
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803279638290405, gen p mean: -0.24144238233566284, mean p set: 0.44861117005348206
loss_pred:0.016793562099337578, decouple_loss:0.0030799538362771273
The modified gen p mean: 0.4477917551994324, gen p mean: -0.23768000304698944, mean p set: 0.44836896657943726
loss_pred:0.017236728221178055, decouple_loss:0.003023374592885375
The modified gen p mean: 0.44777438044548035, gen p mean: -0.2374737411737442, mean p set: 0.4483001232147217
loss_pred:0.016574636101722717, decouple_loss:0.0030026729218661785
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784650206565857, gen p mean: -0.23966099321842194, mean p set: 0.4484219551086426
loss_pred:0.01620660535991192, decouple_loss:0.0028823891188949347
The modified gen p mean: 0.44745370745658875, gen p mean: -0.24333514273166656, mean p set: 0.4480241537094116
loss_pred:0.01714768260717392, decouple_loss:0.00295428279787302
The modified gen p mean: 0.44814857840538025, gen p mean: -0.2426731139421463, mean p set: 0.4486761689186096
loss_pred:0.016750911250710487, decouple_loss:0.0030159929301589727
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919905066490173, gen p mean: -0.24089373648166656, mean p set: 0.4497752785682678
loss_pred:0.015776099637150764, decouple_loss:0.0031803033780306578
The modified gen p mean: 0.44872424006462097, gen p mean: -0.24633532762527466, mean p set: 0.4493010640144348
loss_pred:0.016379235312342644, decouple_loss:0.0030403081327676773
The modified gen p mean: 0.44840842485427856, gen p mean: -0.24175584316253662, mean p set: 0.4489397704601288
loss_pred:0.015965761616826057, decouple_loss:0.0035048290155828
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853097200393677, gen p mean: -0.23948398232460022, mean p set: 0.4491029977798462
loss_pred:0.016850844025611877, decouple_loss:0.003276956034824252
The modified gen p mean: 0.4481038451194763, gen p mean: -0.23516136407852173, mean p set: 0.4486786425113678The modified gen p mean: 0.4487243890762329, gen p mean: -0.2369670420885086, mean p set: 0.44925159215927124
loss_pred:0.017362454906105995, decouple_loss:0.0032149720937013626
loss_pred:0.016359077766537666, decouple_loss:0.003024099860340357
2023-04-26 23:05:27 testing...
The modified gen p mean: 0.44822362065315247, gen p mean: -0.2322477549314499, mean p set: 0.44879910349845886
loss_pred:0.017369158565998077, decouple_loss:0.0027671968564391136
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2347378134727478, mean p set: 0.4499112665653229
loss_pred:0.01741071604192257, decouple_loss:0.0028297503013163805
The modified gen p mean: 0.449255108833313, gen p mean: -0.23490044474601746, mean p set: 0.4498290419578552
loss_pred:0.016952594742178917, decouple_loss:0.0027859502006322145
WV_1_PC_1_EH_0_PS_30, loss: 0.017383871600031853, avg_mse: 0.025489874184131622
current test mse: 0.02549
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464370906352997, gen p mean: -0.23713776469230652, mean p set: 0.4469698667526245
loss_pred:0.015820465981960297, decouple_loss:0.002928670961409807
The modified gen p mean: 0.44901108741760254, gen p mean: -0.23598259687423706, mean p set: 0.44958946108818054The modified gen p mean: 0.4486025869846344, gen p mean: -0.23647074401378632, mean p set: 0.44917967915534973
loss_pred:0.015980729833245277, decouple_loss:0.0029972170013934374
loss_pred:0.015919653698801994, decouple_loss:0.0030291518196463585
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487972855567932, gen p mean: -0.2331247329711914, mean p set: 0.44932347536087036
loss_pred:0.015605207532644272, decouple_loss:0.0030948028434067965
The modified gen p mean: 0.4479999244213104, gen p mean: -0.23028139770030975, mean p set: 0.4485769271850586
loss_pred:0.015782402828335762, decouple_loss:0.0032003268133848906
The modified gen p mean: 0.4491076171398163, gen p mean: -0.23320740461349487, mean p set: 0.449687123298645
loss_pred:0.01667701080441475, decouple_loss:0.003216223092749715
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499377906322479, gen p mean: -0.23070131242275238, mean p set: 0.45046207308769226
loss_pred:0.015616332180798054, decouple_loss:0.0031200640369206667
The modified gen p mean: 0.44754597544670105, gen p mean: -0.23603487014770508, mean p set: 0.4481198489665985
loss_pred:0.015569983050227165, decouple_loss:0.002784650307148695
The modified gen p mean: 0.44845327734947205, gen p mean: -0.2358454167842865, mean p set: 0.44902855157852173
loss_pred:0.016410792246460915, decouple_loss:0.003063764190301299
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473338723182678, gen p mean: -0.2384190410375595, mean p set: 0.4478663504123688
loss_pred:0.015946080908179283, decouple_loss:0.0036691471468657255
The modified gen p mean: 0.44942787289619446, gen p mean: -0.23907600343227386, mean p set: 0.4500042200088501
loss_pred:0.016176404431462288, decouple_loss:0.0032526995055377483
The modified gen p mean: 0.4489229619503021, gen p mean: -0.2337924838066101, mean p set: 0.44949984550476074
loss_pred:0.016083408147096634, decouple_loss:0.0030886009335517883
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902122020721436, gen p mean: -0.23531462252140045, mean p set: 0.4495994448661804
loss_pred:0.016246289014816284, decouple_loss:0.003288036212325096
The modified gen p mean: 0.4487801790237427, gen p mean: -0.23338280618190765, mean p set: 0.44930922985076904The modified gen p mean: 0.44972729682922363, gen p mean: -0.2286706566810608, mean p set: 0.45029905438423157
loss_pred:0.015734659507870674, decouple_loss:0.003550291061401367
loss_pred:0.01617770455777645, decouple_loss:0.0031410125084221363
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801685214042664, gen p mean: -0.2242293804883957, mean p set: 0.4485895335674286
loss_pred:0.01541056390851736, decouple_loss:0.0033713190350681543
The modified gen p mean: 0.4482920467853546, gen p mean: -0.23784926533699036, mean p set: 0.4488680362701416
loss_pred:0.015472279861569405, decouple_loss:0.0032428514678031206
The modified gen p mean: 0.4484913945198059, gen p mean: -0.22876203060150146, mean p set: 0.44900989532470703
loss_pred:0.016137365251779556, decouple_loss:0.003458043560385704
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492877423763275, gen p mean: -0.23177967965602875, mean p set: 0.4498685300350189
loss_pred:0.016423316672444344, decouple_loss:0.0032406714744865894
The modified gen p mean: 0.44949057698249817, gen p mean: -0.23766256868839264, mean p set: 0.4500616788864136
loss_pred:0.015891993418335915, decouple_loss:0.0031623991671949625
The modified gen p mean: 0.44784361124038696, gen p mean: -0.22946394979953766, mean p set: 0.44837456941604614
loss_pred:0.015966014936566353, decouple_loss:0.0032353370916098356
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937869906425476, gen p mean: -0.23592419922351837, mean p set: 0.4499533474445343
loss_pred:0.015672460198402405, decouple_loss:0.003295332193374634
The modified gen p mean: 0.4493110775947571, gen p mean: -0.2380574345588684, mean p set: 0.44987955689430237
loss_pred:0.015960371121764183, decouple_loss:0.0035051375161856413
The modified gen p mean: 0.44767969846725464, gen p mean: -0.23795877397060394, mean p set: 0.44820713996887207
loss_pred:0.01653721183538437, decouple_loss:0.003261786652728915
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44898638129234314, gen p mean: -0.23838579654693604, mean p set: 0.4495595097541809
loss_pred:0.015948006883263588, decouple_loss:0.003613468026742339
The modified gen p mean: 0.4496428072452545, gen p mean: -0.23317749798297882, mean p set: 0.45022737979888916
loss_pred:0.016177544370293617, decouple_loss:0.003741686465218663
The modified gen p mean: 0.44719794392585754, gen p mean: -0.2326766848564148, mean p set: 0.4477255642414093
loss_pred:0.015520554967224598, decouple_loss:0.00342751806601882
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491714537143707, gen p mean: -0.23758193850517273, mean p set: 0.44975459575653076
loss_pred:0.015585985966026783, decouple_loss:0.0033356803469359875
The modified gen p mean: 0.4478728175163269, gen p mean: -0.2327023446559906, mean p set: 0.44844722747802734
loss_pred:0.015987619757652283, decouple_loss:0.0034524931106716394
The modified gen p mean: 0.45011115074157715, gen p mean: -0.2337970733642578, mean p set: 0.4506332576274872
loss_pred:0.015053954906761646, decouple_loss:0.003413008525967598
2023-04-26 23:09:37 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24233263731002808, mean p set: 0.4499112665653229
loss_pred:0.017637161538004875, decouple_loss:0.0035814372822642326
The modified gen p mean: 0.4482261836528778, gen p mean: -0.23942317068576813, mean p set: 0.44879910349845886
The modified gen p mean: 0.44925668835639954, gen p mean: -0.24253667891025543, mean p set: 0.4498290419578552
loss_pred:0.017410239204764366, decouple_loss:0.0034561571665108204
loss_pred:0.017138486728072166, decouple_loss:0.0034700899850577116
WV_1_PC_1_EH_0_PS_30, loss: 0.01757042482495308, avg_mse: 0.025821087881922722
current test mse: 0.025821
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500584602355957, gen p mean: -0.23762351274490356, mean p set: 0.45063140988349915
loss_pred:0.015920549631118774, decouple_loss:0.0036728945560753345
The modified gen p mean: 0.449259877204895, gen p mean: -0.24033205211162567, mean p set: 0.4498407244682312
loss_pred:0.01580020971596241, decouple_loss:0.0034466416109353304
The modified gen p mean: 0.4478389322757721, gen p mean: -0.23683995008468628, mean p set: 0.4483669102191925
loss_pred:0.01586952991783619, decouple_loss:0.0036124135367572308
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497377574443817, gen p mean: -0.2436511367559433, mean p set: 0.4502703547477722
loss_pred:0.015932783484458923, decouple_loss:0.0030937064439058304
The modified gen p mean: 0.44888028502464294, gen p mean: -0.24308891594409943, mean p set: 0.44945788383483887
loss_pred:0.015347547829151154, decouple_loss:0.00294997775927186
The modified gen p mean: 0.44902318716049194, gen p mean: -0.24489475786685944, mean p set: 0.4496126174926758
loss_pred:0.015251778066158295, decouple_loss:0.003164462512359023
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493907690048218, gen p mean: -0.23294466733932495, mean p set: 0.4499235153198242
loss_pred:0.01621287316083908, decouple_loss:0.004025341011583805
The modified gen p mean: 0.44856229424476624, gen p mean: -0.24408450722694397, mean p set: 0.449137419462204
loss_pred:0.01578209176659584, decouple_loss:0.0037252020556479692
The modified gen p mean: 0.4486526548862457, gen p mean: -0.24087460339069366, mean p set: 0.4492279887199402
loss_pred:0.015364665538072586, decouple_loss:0.004129827953875065
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44845980405807495, gen p mean: -0.2425527721643448, mean p set: 0.44898566603660583
loss_pred:0.015583601780235767, decouple_loss:0.003290190827101469
The modified gen p mean: 0.4480546712875366, gen p mean: -0.23770204186439514, mean p set: 0.448634535074234
loss_pred:0.015626290813088417, decouple_loss:0.0030932545196264982
The modified gen p mean: 0.44865602254867554, gen p mean: -0.23129476606845856, mean p set: 0.4492368996143341
loss_pred:0.015633599832654, decouple_loss:0.00320984423160553
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487732946872711, gen p mean: -0.2438909113407135, mean p set: 0.4493459463119507
loss_pred:0.01647929660975933, decouple_loss:0.004241448827087879
The modified gen p mean: 0.44802093505859375, gen p mean: -0.2373954951763153, mean p set: 0.4485909342765808
loss_pred:0.016251031309366226, decouple_loss:0.004150353372097015
The modified gen p mean: 0.4491135776042938, gen p mean: -0.23778276145458221, mean p set: 0.44964301586151123
loss_pred:0.01623627543449402, decouple_loss:0.004077085759490728
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447776734828949, gen p mean: -0.22982904314994812, mean p set: 0.4483490288257599
loss_pred:0.015694433823227882, decouple_loss:0.0038583651185035706
The modified gen p mean: 0.4492647647857666, gen p mean: -0.23779112100601196, mean p set: 0.44983842968940735
loss_pred:0.016252567991614342, decouple_loss:0.003457264043390751
The modified gen p mean: 0.446574330329895, gen p mean: -0.2365109622478485, mean p set: 0.44710251688957214
loss_pred:0.015582216903567314, decouple_loss:0.003650770988315344
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480321705341339, gen p mean: -0.22827839851379395, mean p set: 0.44861605763435364
loss_pred:0.015623606741428375, decouple_loss:0.003690911689773202
The modified gen p mean: 0.4483889937400818, gen p mean: -0.2319115698337555, mean p set: 0.44896194338798523
loss_pred:0.01622871682047844, decouple_loss:0.003646939992904663
The modified gen p mean: 0.45036154985427856, gen p mean: -0.22627833485603333, mean p set: 0.4508882462978363
loss_pred:0.015630116686224937, decouple_loss:0.0038380546029657125
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476396441459656, gen p mean: -0.23175360262393951, mean p set: 0.44820865988731384
loss_pred:0.01586606539785862, decouple_loss:0.003350234357640147
The modified gen p mean: 0.44870781898498535, gen p mean: -0.23431846499443054, mean p set: 0.449288934469223
loss_pred:0.015918398275971413, decouple_loss:0.0033643029164522886
The modified gen p mean: 0.44985637068748474, gen p mean: -0.23455430567264557, mean p set: 0.4503842294216156
loss_pred:0.015749849379062653, decouple_loss:0.0033523179590702057
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877710938453674, gen p mean: -0.24047905206680298, mean p set: 0.44936034083366394
loss_pred:0.015661772340536118, decouple_loss:0.0036188431549817324
The modified gen p mean: 0.4474810063838959, gen p mean: -0.2367645800113678, mean p set: 0.448056697845459
loss_pred:0.015234905295073986, decouple_loss:0.003596429480239749
The modified gen p mean: 0.4484153091907501, gen p mean: -0.23518171906471252, mean p set: 0.448943167924881
loss_pred:0.015582531690597534, decouple_loss:0.003536830423399806
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010265707969666, gen p mean: -0.23800072073936462, mean p set: 0.450682133436203
loss_pred:0.015869012102484703, decouple_loss:0.004178586881607771
The modified gen p mean: 0.4484637677669525, gen p mean: -0.2461061179637909, mean p set: 0.44904085993766785
loss_pred:0.015497034415602684, decouple_loss:0.003789780428633094
The modified gen p mean: 0.44835248589515686, gen p mean: -0.23189760744571686, mean p set: 0.44888070225715637
loss_pred:0.015270048752427101, decouple_loss:0.0037653774488717318
2023-04-26 23:13:03 testing...
The modified gen p mean: 0.44822248816490173, gen p mean: -0.23854577541351318, mean p set: 0.44879910349845886
loss_pred:0.017510609701275826, decouple_loss:0.0032914038747549057
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24141542613506317, mean p set: 0.4499112665653229
loss_pred:0.017630651593208313, decouple_loss:0.003382559632882476
The modified gen p mean: 0.449252188205719, gen p mean: -0.24145478010177612, mean p set: 0.4498290419578552
loss_pred:0.01703290082514286, decouple_loss:0.003324382472783327
WV_1_PC_1_EH_0_PS_30, loss: 0.017558027058839798, avg_mse: 0.02581169828772545
current test mse: 0.025812
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725465774536133, gen p mean: -0.2423899918794632, mean p set: 0.4477778375148773
loss_pred:0.016466965898871422, decouple_loss:0.003465697169303894
The modified gen p mean: 0.4473946690559387, gen p mean: -0.23943398892879486, mean p set: 0.4479668438434601
loss_pred:0.0176780316978693, decouple_loss:0.0034817808773368597
The modified gen p mean: 0.4472585618495941, gen p mean: -0.24168264865875244, mean p set: 0.44783589243888855
loss_pred:0.01629730314016342, decouple_loss:0.0034642801620066166
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751057028770447, gen p mean: -0.24028494954109192, mean p set: 0.4480361342430115
loss_pred:0.01704067923128605, decouple_loss:0.0033644288778305054
The modified gen p mean: 0.447482705116272, gen p mean: -0.24585536122322083, mean p set: 0.4480603337287903The modified gen p mean: 0.44701695442199707, gen p mean: -0.24012386798858643, mean p set: 0.4475988745689392
loss_pred:0.01697511412203312, decouple_loss:0.003764386987313628
loss_pred:0.01670401357114315, decouple_loss:0.0035479029174894094
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478054642677307, gen p mean: -0.2407134771347046, mean p set: 0.44833505153656006
loss_pred:0.017122332006692886, decouple_loss:0.0030910864006727934
The modified gen p mean: 0.44756487011909485, gen p mean: -0.24396146833896637, mean p set: 0.4481448233127594
loss_pred:0.01706479862332344, decouple_loss:0.0031173520255833864
The modified gen p mean: 0.44686827063560486, gen p mean: -0.24256663024425507, mean p set: 0.447443425655365
loss_pred:0.01662345603108406, decouple_loss:0.003039485542103648
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728943705558777, gen p mean: -0.23671723902225494, mean p set: 0.44781771302223206
loss_pred:0.017351189628243446, decouple_loss:0.003557361662387848
The modified gen p mean: 0.44762206077575684, gen p mean: -0.24213680624961853, mean p set: 0.44820162653923035The modified gen p mean: 0.4475381374359131, gen p mean: -0.23841243982315063, mean p set: 0.4481123387813568
loss_pred:0.017322881147265434, decouple_loss:0.0035350441467016935
loss_pred:0.016407089307904243, decouple_loss:0.0035226959735155106
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743096828460693, gen p mean: -0.24710364639759064, mean p set: 0.44800713658332825
loss_pred:0.016587942838668823, decouple_loss:0.0031803122255951166
The modified gen p mean: 0.4476407468318939, gen p mean: -0.24364979565143585, mean p set: 0.4482216238975525
loss_pred:0.01765238307416439, decouple_loss:0.0028855532873421907
The modified gen p mean: 0.44649627804756165, gen p mean: -0.24379512667655945, mean p set: 0.44702383875846863
loss_pred:0.016486605629324913, decouple_loss:0.0029484734404832125
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471034109592438, gen p mean: -0.2486581653356552, mean p set: 0.44768041372299194
loss_pred:0.015881657600402832, decouple_loss:0.0032665759790688753
The modified gen p mean: 0.4462055265903473, gen p mean: -0.24711890518665314, mean p set: 0.44678664207458496The modified gen p mean: 0.44741111993789673, gen p mean: -0.2478533536195755, mean p set: 0.44793930649757385
loss_pred:0.01635606214404106, decouple_loss:0.0035343882627785206
loss_pred:0.017470989376306534, decouple_loss:0.0034051600378006697
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744378328323364, gen p mean: -0.2467285841703415, mean p set: 0.4480176270008087
loss_pred:0.017109764739871025, decouple_loss:0.0033079239074140787
The modified gen p mean: 0.4469260573387146, gen p mean: -0.24540074169635773, mean p set: 0.44749921560287476
loss_pred:0.016873160377144814, decouple_loss:0.003199978033080697
The modified gen p mean: 0.44727739691734314, gen p mean: -0.24650850892066956, mean p set: 0.4478038251399994
loss_pred:0.016855105757713318, decouple_loss:0.003101179376244545
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709786772727966, gen p mean: -0.2461899220943451, mean p set: 0.44767072796821594
loss_pred:0.01725839450955391, decouple_loss:0.003396302927285433
The modified gen p mean: 0.446717232465744, gen p mean: -0.24891646206378937, mean p set: 0.44729599356651306
loss_pred:0.015909092500805855, decouple_loss:0.0036446780432015657
The modified gen p mean: 0.4470481276512146, gen p mean: -0.25224441289901733, mean p set: 0.44758090376853943
loss_pred:0.01678331568837166, decouple_loss:0.0035546713043004274
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44592225551605225, gen p mean: -0.25000929832458496, mean p set: 0.44649389386177063
loss_pred:0.015891851857304573, decouple_loss:0.0028025228530168533
The modified gen p mean: 0.4474988579750061, gen p mean: -0.24949032068252563, mean p set: 0.44807714223861694
loss_pred:0.017127899453043938, decouple_loss:0.003145066322758794
The modified gen p mean: 0.4477384686470032, gen p mean: -0.25403499603271484, mean p set: 0.4482708275318146
loss_pred:0.017765026539564133, decouple_loss:0.003108276752755046
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474335312843323, gen p mean: -0.2558287978172302, mean p set: 0.4480067491531372
loss_pred:0.01693890243768692, decouple_loss:0.0032004970125854015
The modified gen p mean: 0.4480430483818054, gen p mean: -0.2564345598220825, mean p set: 0.4486217796802521
loss_pred:0.016488080844283104, decouple_loss:0.003144901478663087
The modified gen p mean: 0.4475669860839844, gen p mean: -0.24954597651958466, mean p set: 0.4480897784233093
loss_pred:0.016771158203482628, decouple_loss:0.0032797548919916153
2023-04-26 23:17:16 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2503319978713989, mean p set: 0.4499112665653229
loss_pred:0.017435558140277863, decouple_loss:0.003162884619086981
The modified gen p mean: 0.44822072982788086, gen p mean: -0.24742081761360168, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492495059967041, gen p mean: -0.2501285672187805, mean p set: 0.4498290419578552
loss_pred:0.01741602085530758, decouple_loss:0.003292251145467162
loss_pred:0.01694585382938385, decouple_loss:0.0032386232633143663
WV_1_PC_1_EH_0_PS_30, loss: 0.01742737554013729, avg_mse: 0.025614123791456223
current test mse: 0.025614
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705384969711304, gen p mean: -0.25110456347465515, mean p set: 0.44763314723968506
loss_pred:0.01719719171524048, decouple_loss:0.0031528607942163944
The modified gen p mean: 0.4469807744026184, gen p mean: -0.2447747439146042, mean p set: 0.44755926728248596
loss_pred:0.01759687252342701, decouple_loss:0.0032853251323103905
The modified gen p mean: 0.446865975856781, gen p mean: -0.25257575511932373, mean p set: 0.44739648699760437
loss_pred:0.01730964332818985, decouple_loss:0.0029808625113219023
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853901863098145, gen p mean: -0.24910424649715424, mean p set: 0.4490669369697571
loss_pred:0.016428552567958832, decouple_loss:0.00301994732581079
The modified gen p mean: 0.4477178752422333, gen p mean: -0.2557341754436493, mean p set: 0.4482952058315277
loss_pred:0.016450518742203712, decouple_loss:0.003018956398591399
The modified gen p mean: 0.44756728410720825, gen p mean: -0.246269091963768, mean p set: 0.4481445848941803
loss_pred:0.01632789894938469, decouple_loss:0.0027808849699795246
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471781253814697, gen p mean: -0.24915598332881927, mean p set: 0.44771143794059753
loss_pred:0.017107665538787842, decouple_loss:0.0032339030876755714
The modified gen p mean: 0.44720521569252014, gen p mean: -0.24693414568901062, mean p set: 0.44777771830558777
loss_pred:0.017135057598352432, decouple_loss:0.002948504639789462
The modified gen p mean: 0.44617825746536255, gen p mean: -0.24455897510051727, mean p set: 0.4467572569847107
loss_pred:0.01586764119565487, decouple_loss:0.002821605885401368
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753801822662354, gen p mean: -0.24702288210391998, mean p set: 0.44806763529777527
loss_pred:0.01665746048092842, decouple_loss:0.003050481202080846
The modified gen p mean: 0.44709813594818115, gen p mean: -0.2499495893716812, mean p set: 0.44767072796821594
loss_pred:0.017311058938503265, decouple_loss:0.002918571699410677
The modified gen p mean: 0.44735077023506165, gen p mean: -0.24711735546588898, mean p set: 0.44792598485946655
loss_pred:0.016873294487595558, decouple_loss:0.002975894371047616
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476616382598877, gen p mean: -0.2487521469593048, mean p set: 0.44824355840682983
loss_pred:0.017063923180103302, decouple_loss:0.003184340428560972
The modified gen p mean: 0.44733962416648865, gen p mean: -0.2383316606283188, mean p set: 0.4478713572025299The modified gen p mean: 0.4476713240146637, gen p mean: -0.2502068877220154, mean p set: 0.4482428729534149
loss_pred:0.01722222939133644, decouple_loss:0.0032028944697231054
loss_pred:0.016540570184588432, decouple_loss:0.0033250385895371437
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473917782306671, gen p mean: -0.24473878741264343, mean p set: 0.4479702413082123
loss_pred:0.016676487401127815, decouple_loss:0.0031943991780281067
The modified gen p mean: 0.44790831208229065, gen p mean: -0.24949626624584198, mean p set: 0.44848695397377014The modified gen p mean: 0.44757089018821716, gen p mean: -0.24458758533000946, mean p set: 0.4481000304222107
loss_pred:0.016568129882216454, decouple_loss:0.0027909965720027685
loss_pred:0.01693517342209816, decouple_loss:0.002960182260721922
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742998480796814, gen p mean: -0.24675287306308746, mean p set: 0.4480043649673462
loss_pred:0.017196763306856155, decouple_loss:0.0030539389699697495
The modified gen p mean: 0.44688764214515686, gen p mean: -0.24159614741802216, mean p set: 0.4474641680717468
The modified gen p mean: 0.44798827171325684, gen p mean: -0.24460582435131073, mean p set: 0.4485156238079071
loss_pred:0.017576275393366814, decouple_loss:0.0031060457695275545
loss_pred:0.0158387403935194, decouple_loss:0.0029780396725982428
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849488139152527, gen p mean: -0.24401606619358063, mean p set: 0.4490697383880615
loss_pred:0.016108883544802666, decouple_loss:0.0035848570987582207
The modified gen p mean: 0.4480324983596802, gen p mean: -0.24025756120681763, mean p set: 0.4486115872859955
loss_pred:0.01680041290819645, decouple_loss:0.003491816809400916
The modified gen p mean: 0.44714391231536865, gen p mean: -0.2399035394191742, mean p set: 0.4476606547832489
loss_pred:0.01713535189628601, decouple_loss:0.0030242628417909145
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478161931037903, gen p mean: -0.23879727721214294, mean p set: 0.4483889639377594
loss_pred:0.01665053330361843, decouple_loss:0.0028725769370794296
The modified gen p mean: 0.44717398285865784, gen p mean: -0.2429656684398651, mean p set: 0.44774720072746277
loss_pred:0.016267789527773857, decouple_loss:0.0029538883827626705
The modified gen p mean: 0.4482813775539398, gen p mean: -0.2410208284854889, mean p set: 0.4488099217414856
loss_pred:0.017146611586213112, decouple_loss:0.0029031450394541025
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477488100528717, gen p mean: -0.23611821234226227, mean p set: 0.4482730031013489
loss_pred:0.01630963385105133, decouple_loss:0.0033350586891174316
The modified gen p mean: 0.44708251953125, gen p mean: -0.23807813227176666, mean p set: 0.4476645588874817
loss_pred:0.01689518243074417, decouple_loss:0.0035423256922513247
The modified gen p mean: 0.4466758668422699, gen p mean: -0.23800037801265717, mean p set: 0.44725102186203003
loss_pred:0.016101209446787834, decouple_loss:0.002904615132138133
2023-04-26 23:20:42 testing...
The modified gen p mean: 0.44821667671203613, gen p mean: -0.23646467924118042, mean p set: 0.44879910349845886
loss_pred:0.017331315204501152, decouple_loss:0.0027717091143131256
The modified gen p mean: 0.4494309425354004, gen p mean: -0.239017516374588, mean p set: 0.4499112665653229
loss_pred:0.017485637217760086, decouple_loss:0.0028033838607370853
The modified gen p mean: 0.44924601912498474, gen p mean: -0.23915551602840424, mean p set: 0.4498290419578552
loss_pred:0.01703198440372944, decouple_loss:0.002743777586147189
WV_1_PC_1_EH_0_PS_30, loss: 0.017421627417206764, avg_mse: 0.0256364606320858
current test mse: 0.025636
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450022429227829, gen p mean: -0.2384176105260849, mean p set: 0.4505492150783539
loss_pred:0.015489275567233562, decouple_loss:0.0032357184682041407
The modified gen p mean: 0.4477871358394623, gen p mean: -0.2350623458623886, mean p set: 0.44835996627807617
loss_pred:0.016971152275800705, decouple_loss:0.0029027715791016817
The modified gen p mean: 0.4504995346069336, gen p mean: -0.2407621592283249, mean p set: 0.4510750472545624
loss_pred:0.015779200941324234, decouple_loss:0.0026299902237951756
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471583366394043, gen p mean: -0.24144718050956726, mean p set: 0.4476839303970337
loss_pred:0.015889972448349, decouple_loss:0.0039008576422929764
The modified gen p mean: 0.4488215148448944, gen p mean: -0.23869825899600983, mean p set: 0.4494022727012634
loss_pred:0.016696050763130188, decouple_loss:0.0035837600007653236
The modified gen p mean: 0.4493292570114136, gen p mean: -0.24214768409729004, mean p set: 0.4498968720436096
loss_pred:0.015105465427041054, decouple_loss:0.003785282839089632
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905102252960205, gen p mean: -0.24205127358436584, mean p set: 0.44958579540252686
loss_pred:0.016148248687386513, decouple_loss:0.0030051646754145622
The modified gen p mean: 0.4501481354236603, gen p mean: -0.23796656727790833, mean p set: 0.4507233798503876
loss_pred:0.016026511788368225, decouple_loss:0.003020178759470582
The modified gen p mean: 0.4492260217666626, gen p mean: -0.2416786551475525, mean p set: 0.4497992694377899
loss_pred:0.015735823661088943, decouple_loss:0.0033926605246961117
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939282536506653, gen p mean: -0.24423982203006744, mean p set: 0.4499218463897705
loss_pred:0.015976764261722565, decouple_loss:0.0036961748264729977
The modified gen p mean: 0.4486768841743469, gen p mean: -0.23657536506652832, mean p set: 0.4492511451244354
loss_pred:0.01711421087384224, decouple_loss:0.003940005786716938
The modified gen p mean: 0.44983339309692383, gen p mean: -0.23826023936271667, mean p set: 0.450408935546875
loss_pred:0.015443339943885803, decouple_loss:0.0032212105579674244
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488181471824646, gen p mean: -0.23846781253814697, mean p set: 0.44939103722572327
loss_pred:0.01605280302464962, decouple_loss:0.00295641808770597
The modified gen p mean: 0.4501884877681732, gen p mean: -0.23600636422634125, mean p set: 0.4507656991481781The modified gen p mean: 0.44928261637687683, gen p mean: -0.24075162410736084, mean p set: 0.4498126208782196
loss_pred:0.01571599580347538, decouple_loss:0.0031471734400838614
loss_pred:0.01571260578930378, decouple_loss:0.0032743948977440596
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934746623039246, gen p mean: -0.2339276224374771, mean p set: 0.4499257802963257
loss_pred:0.0158087108284235, decouple_loss:0.003809282323345542
The modified gen p mean: 0.4489128589630127, gen p mean: -0.24052107334136963, mean p set: 0.4494844079017639The modified gen p mean: 0.4496079385280609, gen p mean: -0.23153313994407654, mean p set: 0.4501335322856903
loss_pred:0.016340339556336403, decouple_loss:0.0038713484536856413
loss_pred:0.01522346492856741, decouple_loss:0.0036401727702468634
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489153325557709, gen p mean: -0.22802039980888367, mean p set: 0.44949066638946533
loss_pred:0.01618826948106289, decouple_loss:0.002911598887294531
The modified gen p mean: 0.45018690824508667, gen p mean: -0.23488658666610718, mean p set: 0.45076262950897217
loss_pred:0.015021915547549725, decouple_loss:0.0029547845479100943
The modified gen p mean: 0.448200523853302, gen p mean: -0.23236630856990814, mean p set: 0.44873154163360596
loss_pred:0.015711672604084015, decouple_loss:0.002978421514853835
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877082109451294, gen p mean: -0.23522159457206726, mean p set: 0.4493516683578491
loss_pred:0.01682068035006523, decouple_loss:0.0031725484877824783
The modified gen p mean: 0.4486537277698517, gen p mean: -0.23255708813667297, mean p set: 0.4492337107658386
loss_pred:0.015318422578275204, decouple_loss:0.002968432381749153
The modified gen p mean: 0.4495464563369751, gen p mean: -0.23362812399864197, mean p set: 0.45007139444351196
loss_pred:0.01626022346317768, decouple_loss:0.0033065497409552336
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474296569824219, gen p mean: -0.23662610352039337, mean p set: 0.448009192943573
loss_pred:0.015332723967730999, decouple_loss:0.0032753252889961004
The modified gen p mean: 0.448217511177063, gen p mean: -0.23554934561252594, mean p set: 0.4487907588481903
loss_pred:0.016066184267401695, decouple_loss:0.003291320288553834
The modified gen p mean: 0.44902709126472473, gen p mean: -0.24429316818714142, mean p set: 0.4495563805103302
loss_pred:0.016187813133001328, decouple_loss:0.0031850780360400677
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714614748954773, gen p mean: -0.2421732097864151, mean p set: 0.4477207064628601
loss_pred:0.01559004932641983, decouple_loss:0.0031470160465687513
The modified gen p mean: 0.4482676386833191, gen p mean: -0.2457437664270401, mean p set: 0.44884857535362244
loss_pred:0.0159330815076828, decouple_loss:0.003279539057984948
The modified gen p mean: 0.45011377334594727, gen p mean: -0.24127180874347687, mean p set: 0.45064398646354675
loss_pred:0.014641827903687954, decouple_loss:0.0035384022630751133
2023-04-26 23:24:58 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23709039390087128, mean p set: 0.4499112665653229
loss_pred:0.01767348125576973, decouple_loss:0.00324326497502625
The modified gen p mean: 0.4482187032699585, gen p mean: -0.23442691564559937, mean p set: 0.44879910349845886
The modified gen p mean: 0.44925200939178467, gen p mean: -0.2370493859052658, mean p set: 0.4498290419578552
loss_pred:0.017552483826875687, decouple_loss:0.003053396474570036
loss_pred:0.017211075872182846, decouple_loss:0.0031819352880120277
WV_1_PC_1_EH_0_PS_30, loss: 0.017636992037296295, avg_mse: 0.025946494191884995
current test mse: 0.025946
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45034730434417725, gen p mean: -0.23456338047981262, mean p set: 0.4509190618991852
loss_pred:0.015931811183691025, decouple_loss:0.0030360643286257982
The modified gen p mean: 0.4483089745044708, gen p mean: -0.23356811702251434, mean p set: 0.44889214634895325
loss_pred:0.015851138159632683, decouple_loss:0.0027417163364589214
The modified gen p mean: 0.44910377264022827, gen p mean: -0.24136342108249664, mean p set: 0.4496326744556427
loss_pred:0.015697067603468895, decouple_loss:0.0028674877248704433
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491821229457855, gen p mean: -0.2341565191745758, mean p set: 0.449707955121994
loss_pred:0.01611819490790367, decouple_loss:0.0035632518120110035
The modified gen p mean: 0.44764235615730286, gen p mean: -0.23336893320083618, mean p set: 0.4482172131538391
loss_pred:0.01570371352136135, decouple_loss:0.003294892143458128
The modified gen p mean: 0.4488442838191986, gen p mean: -0.23384898900985718, mean p set: 0.4494141638278961
loss_pred:0.016375482082366943, decouple_loss:0.0032884066458791494
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900596141815186, gen p mean: -0.229848712682724, mean p set: 0.44953563809394836
loss_pred:0.01564502902328968, decouple_loss:0.0028607824351638556
The modified gen p mean: 0.44975554943084717, gen p mean: -0.2317960560321808, mean p set: 0.4503350555896759
loss_pred:0.015719786286354065, decouple_loss:0.00286865490488708
The modified gen p mean: 0.4483533799648285, gen p mean: -0.23081614077091217, mean p set: 0.4489321708679199
loss_pred:0.015448242425918579, decouple_loss:0.002925833687186241
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44946539402008057, gen p mean: -0.23057153820991516, mean p set: 0.4499913156032562
loss_pred:0.015532514080405235, decouple_loss:0.003215082688257098
The modified gen p mean: 0.45024290680885315, gen p mean: -0.23189646005630493, mean p set: 0.4508228898048401
loss_pred:0.015280305407941341, decouple_loss:0.003399217501282692
The modified gen p mean: 0.4493287205696106, gen p mean: -0.23317301273345947, mean p set: 0.4499005675315857
loss_pred:0.015683148056268692, decouple_loss:0.003082670271396637
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048341155052185, gen p mean: -0.2293519675731659, mean p set: 0.45106109976768494
loss_pred:0.014797279611229897, decouple_loss:0.0028578704223036766
The modified gen p mean: 0.45043468475341797, gen p mean: -0.22923697531223297, mean p set: 0.4510194957256317The modified gen p mean: 0.4474620521068573, gen p mean: -0.23062653839588165, mean p set: 0.4479977786540985
loss_pred:0.015332103706896305, decouple_loss:0.0029178985860198736
loss_pred:0.015688162297010422, decouple_loss:0.0029429136775434017
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852879643440247, gen p mean: -0.23158030211925507, mean p set: 0.4491027593612671
loss_pred:0.01580759696662426, decouple_loss:0.0029938414227217436
The modified gen p mean: 0.45035597681999207, gen p mean: -0.23384162783622742, mean p set: 0.45092666149139404The modified gen p mean: 0.4501725137233734, gen p mean: -0.23376674950122833, mean p set: 0.4507005214691162
loss_pred:0.015740307047963142, decouple_loss:0.003502157749608159
loss_pred:0.014959212392568588, decouple_loss:0.003484091954305768
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981393218040466, gen p mean: -0.23448263108730316, mean p set: 0.4503912329673767
loss_pred:0.014449752867221832, decouple_loss:0.002984980121254921
The modified gen p mean: 0.44996586441993713, gen p mean: -0.2353108674287796, mean p set: 0.4504936933517456The modified gen p mean: 0.449306458234787, gen p mean: -0.23974421620368958, mean p set: 0.4498860538005829
loss_pred:0.016439033672213554, decouple_loss:0.0031233862973749638
loss_pred:0.01488375011831522, decouple_loss:0.0029146026354283094
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45011207461357117, gen p mean: -0.23963306844234467, mean p set: 0.4506858289241791
loss_pred:0.015616400167346, decouple_loss:0.0034019649028778076
The modified gen p mean: 0.44890671968460083, gen p mean: -0.24152293801307678, mean p set: 0.4494830369949341
loss_pred:0.015475590713322163, decouple_loss:0.0030933052767068148
The modified gen p mean: 0.4500730633735657, gen p mean: -0.2384428232908249, mean p set: 0.4505973160266876
loss_pred:0.015664439648389816, decouple_loss:0.0033662139903753996
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785964488983154, gen p mean: -0.23890569806098938, mean p set: 0.44843724370002747
loss_pred:0.015637949109077454, decouple_loss:0.0028797907289117575
The modified gen p mean: 0.4506758749485016, gen p mean: -0.23070982098579407, mean p set: 0.4512515664100647
loss_pred:0.01564066670835018, decouple_loss:0.002859849249944091
The modified gen p mean: 0.4496467113494873, gen p mean: -0.2323542982339859, mean p set: 0.4501778185367584
loss_pred:0.015690721571445465, decouple_loss:0.002750373911112547
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44946256279945374, gen p mean: -0.22928626835346222, mean p set: 0.4500423073768616
loss_pred:0.016498757526278496, decouple_loss:0.003140088403597474
The modified gen p mean: 0.4495999217033386, gen p mean: -0.23290009796619415, mean p set: 0.45017769932746887The modified gen p mean: 0.4503656327724457, gen p mean: -0.23092444241046906, mean p set: 0.4508989155292511
loss_pred:0.01527398731559515, decouple_loss:0.0030764895491302013
loss_pred:0.015043304301798344, decouple_loss:0.0029516133945435286
2023-04-26 23:28:23 testing...
The modified gen p mean: 0.44822099804878235, gen p mean: -0.22525867819786072, mean p set: 0.44879910349845886
loss_pred:0.017452074214816093, decouple_loss:0.0029434459283947945
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22801057994365692, mean p set: 0.4499112665653229
loss_pred:0.01759486272931099, decouple_loss:0.0030327134300023317
The modified gen p mean: 0.4492461085319519, gen p mean: -0.22802624106407166, mean p set: 0.4498290419578552
loss_pred:0.017187796533107758, decouple_loss:0.0029943150002509356
WV_1_PC_1_EH_0_PS_30, loss: 0.017561085522174835, avg_mse: 0.025848545134067535
current test mse: 0.025849
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486035406589508, gen p mean: -0.22643521428108215, mean p set: 0.4491317868232727
loss_pred:0.015729205682873726, decouple_loss:0.002902453765273094
The modified gen p mean: 0.4474222660064697, gen p mean: -0.22544990479946136, mean p set: 0.44799429178237915
loss_pred:0.015693528577685356, decouple_loss:0.0028734244406223297
The modified gen p mean: 0.44803205132484436, gen p mean: -0.2278883159160614, mean p set: 0.44860827922821045
loss_pred:0.015811925753951073, decouple_loss:0.0028590138535946608
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657909870147705, gen p mean: -0.23065440356731415, mean p set: 0.4471103250980377
loss_pred:0.01671421527862549, decouple_loss:0.002859692554920912
The modified gen p mean: 0.4481864869594574, gen p mean: -0.23292092978954315, mean p set: 0.44875964522361755
loss_pred:0.016177218407392502, decouple_loss:0.0029662782326340675
The modified gen p mean: 0.4482223689556122, gen p mean: -0.22232948243618011, mean p set: 0.4487995207309723
loss_pred:0.01688351295888424, decouple_loss:0.0028851614333689213
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479113519191742, gen p mean: -0.23572216928005219, mean p set: 0.44843369722366333
loss_pred:0.015912901610136032, decouple_loss:0.0029009287245571613
The modified gen p mean: 0.4480593800544739, gen p mean: -0.23508574068546295, mean p set: 0.4486377537250519
loss_pred:0.01613825373351574, decouple_loss:0.00314376805908978
The modified gen p mean: 0.44735127687454224, gen p mean: -0.22944878041744232, mean p set: 0.44792816042900085
loss_pred:0.015757497400045395, decouple_loss:0.0029399837367236614
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804883003234863, gen p mean: -0.2387458086013794, mean p set: 0.44857946038246155
loss_pred:0.01569369249045849, decouple_loss:0.002948933281004429
The modified gen p mean: 0.4471903145313263, gen p mean: -0.23435690999031067, mean p set: 0.4477651119232178
loss_pred:0.016412287950515747, decouple_loss:0.002900179009884596
The modified gen p mean: 0.44576361775398254, gen p mean: -0.24022845923900604, mean p set: 0.446336567401886
loss_pred:0.015958068892359734, decouple_loss:0.0032945596612989902
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472319185733795, gen p mean: -0.24669353663921356, mean p set: 0.44780153036117554
loss_pred:0.016920994967222214, decouple_loss:0.003243177430704236
The modified gen p mean: 0.4478152096271515, gen p mean: -0.24088124930858612, mean p set: 0.4483456313610077The modified gen p mean: 0.4479689300060272, gen p mean: -0.24179762601852417, mean p set: 0.4485393166542053
loss_pred:0.016110125929117203, decouple_loss:0.003418919863179326
loss_pred:0.015553900972008705, decouple_loss:0.003510536625981331
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473792314529419, gen p mean: -0.24102595448493958, mean p set: 0.4479508101940155
loss_pred:0.01618424616754055, decouple_loss:0.0030341108795255423
The modified gen p mean: 0.4475075602531433, gen p mean: -0.24027709662914276, mean p set: 0.4480930268764496The modified gen p mean: 0.44768640398979187, gen p mean: -0.23880288004875183, mean p set: 0.44820424914360046
loss_pred:0.01645457185804844, decouple_loss:0.0029698393773287535
loss_pred:0.016199015080928802, decouple_loss:0.0029491190798580647
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477282464504242, gen p mean: -0.2480853796005249, mean p set: 0.44830334186553955
loss_pred:0.01591070555150509, decouple_loss:0.0035948827862739563
The modified gen p mean: 0.44724151492118835, gen p mean: -0.24240736663341522, mean p set: 0.4478101134300232
loss_pred:0.01609218120574951, decouple_loss:0.0035710795782506466
The modified gen p mean: 0.44721025228500366, gen p mean: -0.24250729382038116, mean p set: 0.44773492217063904
loss_pred:0.015852533280849457, decouple_loss:0.0036098116543143988
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447182297706604, gen p mean: -0.2407298982143402, mean p set: 0.44775745272636414
loss_pred:0.015995938330888748, decouple_loss:0.002981681376695633
The modified gen p mean: 0.4472470283508301, gen p mean: -0.23731166124343872, mean p set: 0.447822630405426
loss_pred:0.015776673331856728, decouple_loss:0.0031081591732800007
The modified gen p mean: 0.4476074278354645, gen p mean: -0.23685266077518463, mean p set: 0.4481382668018341
loss_pred:0.01577821373939514, decouple_loss:0.0031400013249367476
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783109426498413, gen p mean: -0.23226886987686157, mean p set: 0.44840726256370544
loss_pred:0.01615113951265812, decouple_loss:0.0035334862768650055
The modified gen p mean: 0.4480244219303131, gen p mean: -0.23271715641021729, mean p set: 0.4485970735549927
loss_pred:0.015441847033798695, decouple_loss:0.003805285319685936
The modified gen p mean: 0.44758760929107666, gen p mean: -0.2394857555627823, mean p set: 0.44811320304870605
loss_pred:0.016029009595513344, decouple_loss:0.0038744541816413403
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469197392463684, gen p mean: -0.23726829886436462, mean p set: 0.4474954903125763
loss_pred:0.01678314246237278, decouple_loss:0.0029320036992430687
The modified gen p mean: 0.4477955102920532, gen p mean: -0.23280371725559235, mean p set: 0.44832247495651245
loss_pred:0.016858907416462898, decouple_loss:0.0031370813958346844
The modified gen p mean: 0.4475262761116028, gen p mean: -0.24064122140407562, mean p set: 0.44810402393341064
loss_pred:0.015661466866731644, decouple_loss:0.0030049909837543964
2023-04-26 23:32:39 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2444136142730713, mean p set: 0.4499112665653229
loss_pred:0.017557915300130844, decouple_loss:0.0037581624928861856
The modified gen p mean: 0.448228657245636, gen p mean: -0.2417156845331192, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492582380771637, gen p mean: -0.2441532164812088, mean p set: 0.4498290419578552
loss_pred:0.01735663414001465, decouple_loss:0.0037870316300541162
loss_pred:0.017143040895462036, decouple_loss:0.003931344486773014
WV_1_PC_1_EH_0_PS_30, loss: 0.01754380576312542, avg_mse: 0.025737639516592026
current test mse: 0.025738
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475996196269989, gen p mean: -0.24309125542640686, mean p set: 0.44817250967025757
loss_pred:0.016132377088069916, decouple_loss:0.004045250825583935
The modified gen p mean: 0.447441041469574, gen p mean: -0.24145543575286865, mean p set: 0.4480171501636505
loss_pred:0.016323935240507126, decouple_loss:0.003838234581053257
The modified gen p mean: 0.446138471364975, gen p mean: -0.24589340388774872, mean p set: 0.44667288661003113
loss_pred:0.015781676396727562, decouple_loss:0.0039392332546412945
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814667105674744, gen p mean: -0.241170734167099, mean p set: 0.4486773908138275
loss_pred:0.015845810994505882, decouple_loss:0.0032837209291756153
The modified gen p mean: 0.447240948677063, gen p mean: -0.24937736988067627, mean p set: 0.44781628251075745The modified gen p mean: 0.4470958113670349, gen p mean: -0.2396416962146759, mean p set: 0.4476746618747711
loss_pred:0.016444724053144455, decouple_loss:0.003133393358439207loss_pred:0.01612955704331398, decouple_loss:0.0030971525702625513
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446640282869339, gen p mean: -0.24153250455856323, mean p set: 0.4471621811389923
loss_pred:0.015920674428343773, decouple_loss:0.003497014520689845
The modified gen p mean: 0.4466051161289215, gen p mean: -0.2392258495092392, mean p set: 0.447177916765213The modified gen p mean: 0.4479486048221588, gen p mean: -0.23952974379062653, mean p set: 0.44852498173713684
loss_pred:0.015719519928097725, decouple_loss:0.0032729485537856817
loss_pred:0.016286075115203857, decouple_loss:0.003331078914925456
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485885798931122, gen p mean: -0.24171242117881775, mean p set: 0.449113667011261
loss_pred:0.016160475090146065, decouple_loss:0.003268133383244276
The modified gen p mean: 0.44774946570396423, gen p mean: -0.2378206104040146, mean p set: 0.44832614064216614
loss_pred:0.015037472359836102, decouple_loss:0.003369923448190093
The modified gen p mean: 0.4461757242679596, gen p mean: -0.23898206651210785, mean p set: 0.4467467665672302
loss_pred:0.015818268060684204, decouple_loss:0.0032482112292200327
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44659173488616943, gen p mean: -0.23847734928131104, mean p set: 0.4471730887889862
loss_pred:0.016218971461057663, decouple_loss:0.003477024147287011
The modified gen p mean: 0.4459656774997711, gen p mean: -0.24148526787757874, mean p set: 0.4465450048446655
loss_pred:0.016014382243156433, decouple_loss:0.003494769800454378
The modified gen p mean: 0.4466034770011902, gen p mean: -0.23796643316745758, mean p set: 0.44713273644447327
loss_pred:0.016005538403987885, decouple_loss:0.003300958313047886
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470664858818054, gen p mean: -0.2315615713596344, mean p set: 0.44764673709869385
loss_pred:0.016670210286974907, decouple_loss:0.0029163837898522615
The modified gen p mean: 0.44767287373542786, gen p mean: -0.23984453082084656, mean p set: 0.4482541084289551The modified gen p mean: 0.4472676217556, gen p mean: -0.23947486281394958, mean p set: 0.4477926790714264
loss_pred:0.016339091584086418, decouple_loss:0.002942741382867098
loss_pred:0.016219861805438995, decouple_loss:0.0028709822800010443
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467438757419586, gen p mean: -0.23758426308631897, mean p set: 0.4473235309123993
loss_pred:0.0159133430570364, decouple_loss:0.0035340283066034317
The modified gen p mean: 0.44799506664276123, gen p mean: -0.23716138303279877, mean p set: 0.4485742151737213
loss_pred:0.015661856159567833, decouple_loss:0.0031877162400633097
The modified gen p mean: 0.4463770091533661, gen p mean: -0.23420818150043488, mean p set: 0.4469052851200104
loss_pred:0.015810709446668625, decouple_loss:0.002973441733047366
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477671980857849, gen p mean: -0.23687785863876343, mean p set: 0.44834527373313904
loss_pred:0.016616091132164, decouple_loss:0.0028774267993867397
The modified gen p mean: 0.44658392667770386, gen p mean: -0.24211998283863068, mean p set: 0.44715774059295654
loss_pred:0.015996547415852547, decouple_loss:0.002971181645989418
The modified gen p mean: 0.44627150893211365, gen p mean: -0.24485619366168976, mean p set: 0.4468037486076355
loss_pred:0.016267938539385796, decouple_loss:0.002795487642288208
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44594645500183105, gen p mean: -0.24001869559288025, mean p set: 0.44651728868484497
loss_pred:0.015983693301677704, decouple_loss:0.0034571459982544184
The modified gen p mean: 0.4466637670993805, gen p mean: -0.24501697719097137, mean p set: 0.447241872549057
loss_pred:0.016383569687604904, decouple_loss:0.0034412245731800795
The modified gen p mean: 0.44729048013687134, gen p mean: -0.24135327339172363, mean p set: 0.44781988859176636
loss_pred:0.016559645533561707, decouple_loss:0.0030717020854353905
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789373874664307, gen p mean: -0.24093298614025116, mean p set: 0.4484725892543793
The modified gen p mean: 0.44807669520378113, gen p mean: -0.24013690650463104, mean p set: 0.4486536979675293
loss_pred:0.01532258652150631, decouple_loss:0.003231174312531948
loss_pred:0.015610909089446068, decouple_loss:0.003137354040518403
The modified gen p mean: 0.4482933580875397, gen p mean: -0.23851482570171356, mean p set: 0.4488171935081482
loss_pred:0.01552968192845583, decouple_loss:0.003010525368154049
2023-04-26 23:36:04 testing...
The modified gen p mean: 0.4482162296772003, gen p mean: -0.22945308685302734, mean p set: 0.44879910349845886
loss_pred:0.017468933016061783, decouple_loss:0.0035486689303070307
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23195835947990417, mean p set: 0.4499112665653229
loss_pred:0.017486531287431717, decouple_loss:0.0037062286864966154
The modified gen p mean: 0.449256032705307, gen p mean: -0.23168101906776428, mean p set: 0.4498290419578552
loss_pred:0.017126262187957764, decouple_loss:0.0036367608699947596
WV_1_PC_1_EH_0_PS_30, loss: 0.017542105168104172, avg_mse: 0.02572736330330372
current test mse: 0.025727
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488387405872345, gen p mean: -0.23221905529499054, mean p set: 0.44936102628707886
loss_pred:0.01583499275147915, decouple_loss:0.0032597999088466167
The modified gen p mean: 0.4473605453968048, gen p mean: -0.2335963100194931, mean p set: 0.4479339122772217
loss_pred:0.01681295596063137, decouple_loss:0.0032383326906710863
The modified gen p mean: 0.44713661074638367, gen p mean: -0.2357942759990692, mean p set: 0.447712779045105
loss_pred:0.016519177705049515, decouple_loss:0.0034272796474397182
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695422053337097, gen p mean: -0.22946006059646606, mean p set: 0.44748347997665405
loss_pred:0.016446731984615326, decouple_loss:0.003324628807604313
The modified gen p mean: 0.4466668963432312, gen p mean: -0.22742173075675964, mean p set: 0.44724538922309875The modified gen p mean: 0.4470578134059906, gen p mean: -0.2208009958267212, mean p set: 0.4476318955421448
loss_pred:0.017097650095820427, decouple_loss:0.003200934734195471loss_pred:0.017593326047062874, decouple_loss:0.0034095270093530416
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769972562789917, gen p mean: -0.2307509034872055, mean p set: 0.44823122024536133
loss_pred:0.016718773171305656, decouple_loss:0.0029979462269693613
The modified gen p mean: 0.4478224515914917, gen p mean: -0.23089782893657684, mean p set: 0.44839873909950256
loss_pred:0.016997160390019417, decouple_loss:0.003007977269589901
The modified gen p mean: 0.44814279675483704, gen p mean: -0.233083114027977, mean p set: 0.44871973991394043
loss_pred:0.016735075041651726, decouple_loss:0.003496419172734022
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827768206596375, gen p mean: -0.23812492191791534, mean p set: 0.4488029479980469
loss_pred:0.016325142234563828, decouple_loss:0.003553888062015176
The modified gen p mean: 0.4477602243423462, gen p mean: -0.23746751248836517, mean p set: 0.448335200548172
loss_pred:0.016109159216284752, decouple_loss:0.0035267500206828117
The modified gen p mean: 0.44752267003059387, gen p mean: -0.23947186768054962, mean p set: 0.4481017291545868
loss_pred:0.016278641298413277, decouple_loss:0.0032680495642125607
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486595094203949, gen p mean: -0.23939353227615356, mean p set: 0.4492388963699341The modified gen p mean: 0.44821205735206604, gen p mean: -0.23846222460269928, mean p set: 0.44878846406936646
loss_pred:0.016387686133384705, decouple_loss:0.0032668872736394405
loss_pred:0.015791017562150955, decouple_loss:0.003263528225943446
The modified gen p mean: 0.44740962982177734, gen p mean: -0.23575465381145477, mean p set: 0.4479440450668335
loss_pred:0.01680014468729496, decouple_loss:0.003196137025952339
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44607114791870117, gen p mean: -0.23981526494026184, mean p set: 0.44664737582206726
loss_pred:0.016769034788012505, decouple_loss:0.003019247902557254
The modified gen p mean: 0.44773560762405396, gen p mean: -0.23749493062496185, mean p set: 0.44831880927085876
loss_pred:0.01694079115986824, decouple_loss:0.0032492028549313545
The modified gen p mean: 0.44801124930381775, gen p mean: -0.23526674509048462, mean p set: 0.4485422670841217
loss_pred:0.016356611624360085, decouple_loss:0.003128217766061425
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481804072856903, gen p mean: -0.23328936100006104, mean p set: 0.4487583637237549
loss_pred:0.016682099550962448, decouple_loss:0.003183456137776375
The modified gen p mean: 0.44773054122924805, gen p mean: -0.2337866574525833, mean p set: 0.44831034541130066The modified gen p mean: 0.44805410504341125, gen p mean: -0.23624184727668762, mean p set: 0.44858577847480774
loss_pred:0.016982436180114746, decouple_loss:0.0030789279844611883
loss_pred:0.016412146389484406, decouple_loss:0.0032063627149909735
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473084807395935, gen p mean: -0.23302535712718964, mean p set: 0.447892427444458
loss_pred:0.016747944056987762, decouple_loss:0.002928369678556919
The modified gen p mean: 0.4481162428855896, gen p mean: -0.23368392884731293, mean p set: 0.44869464635849
loss_pred:0.016559269279241562, decouple_loss:0.0030281301587820053
The modified gen p mean: 0.4486759603023529, gen p mean: -0.23372645676136017, mean p set: 0.44920313358306885
loss_pred:0.016162540763616562, decouple_loss:0.003067170036956668
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479966461658478, gen p mean: -0.22786642611026764, mean p set: 0.44857192039489746
loss_pred:0.017235010862350464, decouple_loss:0.0029154489748179913
The modified gen p mean: 0.446824848651886, gen p mean: -0.23363636434078217, mean p set: 0.44740280508995056
loss_pred:0.016201693564653397, decouple_loss:0.002831139136105776
The modified gen p mean: 0.44848692417144775, gen p mean: -0.2285166084766388, mean p set: 0.4490111172199249
loss_pred:0.016085483133792877, decouple_loss:0.003013160778209567
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723865389823914, gen p mean: -0.2260245829820633, mean p set: 0.44781461358070374
loss_pred:0.016791338101029396, decouple_loss:0.0030696620233356953
The modified gen p mean: 0.44792768359184265, gen p mean: -0.2279621660709381, mean p set: 0.4485013484954834
loss_pred:0.01660868525505066, decouple_loss:0.0033444263972342014
The modified gen p mean: 0.4483982026576996, gen p mean: -0.22534766793251038, mean p set: 0.4489271342754364
loss_pred:0.015854043886065483, decouple_loss:0.0029480215162038803
2023-04-26 23:40:24 testing...
The modified gen p mean: 0.44822320342063904, gen p mean: -0.2255755364894867, mean p set: 0.44879910349845886
loss_pred:0.0173483993858099, decouple_loss:0.0029948102310299873
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22787858545780182, mean p set: 0.4499112665653229
loss_pred:0.01738789491355419, decouple_loss:0.002963154809549451
The modified gen p mean: 0.44925302267074585, gen p mean: -0.22786559164524078, mean p set: 0.4498290419578552
loss_pred:0.017037570476531982, decouple_loss:0.003028841922059655
WV_1_PC_1_EH_0_PS_30, loss: 0.0174077358096838, avg_mse: 0.02559809200465679
current test mse: 0.025598
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478784203529358, gen p mean: -0.22652487456798553, mean p set: 0.44845762848854065
loss_pred:0.015782522037625313, decouple_loss:0.0028809269424527884
The modified gen p mean: 0.4481113851070404, gen p mean: -0.22783106565475464, mean p set: 0.4486865699291229
loss_pred:0.016281230375170708, decouple_loss:0.0030391893815249205
The modified gen p mean: 0.44806864857673645, gen p mean: -0.22940278053283691, mean p set: 0.448603093624115
loss_pred:0.01652413234114647, decouple_loss:0.002976071322336793
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473632574081421, gen p mean: -0.22309266030788422, mean p set: 0.4478871822357178
loss_pred:0.017298510298132896, decouple_loss:0.0029624872840940952
The modified gen p mean: 0.4464753270149231, gen p mean: -0.23142534494400024, mean p set: 0.4470512866973877
loss_pred:0.01660972461104393, decouple_loss:0.0031971398275345564
The modified gen p mean: 0.4462762773036957, gen p mean: -0.23191502690315247, mean p set: 0.44685330986976624
loss_pred:0.0164495799690485, decouple_loss:0.0031800814904272556
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858428835868835, gen p mean: -0.22765189409255981, mean p set: 0.44911372661590576
loss_pred:0.016342751681804657, decouple_loss:0.0032666432671248913
The modified gen p mean: 0.4481200575828552, gen p mean: -0.22425036132335663, mean p set: 0.44870471954345703
loss_pred:0.01688295044004917, decouple_loss:0.002982380101457238
The modified gen p mean: 0.44743040204048157, gen p mean: -0.22577959299087524, mean p set: 0.44800689816474915
loss_pred:0.01631559431552887, decouple_loss:0.0030220295302569866
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477364122867584, gen p mean: -0.22673606872558594, mean p set: 0.4482678174972534
loss_pred:0.016631444916129112, decouple_loss:0.002763882279396057
The modified gen p mean: 0.44752931594848633, gen p mean: -0.22975048422813416, mean p set: 0.44810402393341064
loss_pred:0.015941176563501358, decouple_loss:0.00268577435053885
The modified gen p mean: 0.4478137791156769, gen p mean: -0.22838348150253296, mean p set: 0.4483935534954071
loss_pred:0.016064688563346863, decouple_loss:0.0027809320017695427
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481566548347473, gen p mean: -0.22789804637432098, mean p set: 0.44872552156448364
loss_pred:0.016576964408159256, decouple_loss:0.002993975533172488
The modified gen p mean: 0.44772475957870483, gen p mean: -0.22772786021232605, mean p set: 0.4483031630516052
loss_pred:0.016863131895661354, decouple_loss:0.0031289602629840374
The modified gen p mean: 0.4472605586051941, gen p mean: -0.2327570915222168, mean p set: 0.4477825164794922
loss_pred:0.016530103981494904, decouple_loss:0.0035166435409337282
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477165639400482, gen p mean: -0.23500995337963104, mean p set: 0.44829073548316956
loss_pred:0.01687331311404705, decouple_loss:0.0026294286362826824
The modified gen p mean: 0.44798046350479126, gen p mean: -0.23507404327392578, mean p set: 0.44850432872772217The modified gen p mean: 0.4480675458908081, gen p mean: -0.23415179550647736, mean p set: 0.44864311814308167
loss_pred:0.016218213364481926, decouple_loss:0.0029654086101800203
loss_pred:0.01608845591545105, decouple_loss:0.0028496498707681894
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785594940185547, gen p mean: -0.23703576624393463, mean p set: 0.4484356641769409
loss_pred:0.01657947152853012, decouple_loss:0.003377435030415654
The modified gen p mean: 0.44698524475097656, gen p mean: -0.24009284377098083, mean p set: 0.4475124180316925The modified gen p mean: 0.44801706075668335, gen p mean: -0.23661866784095764, mean p set: 0.4485968351364136
loss_pred:0.01587977074086666, decouple_loss:0.003189776325598359
loss_pred:0.016354525461792946, decouple_loss:0.0029250234365463257
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477614164352417, gen p mean: -0.23896847665309906, mean p set: 0.4483374059200287
loss_pred:0.016050729900598526, decouple_loss:0.0027233953587710857
The modified gen p mean: 0.44869181513786316, gen p mean: -0.24015849828720093, mean p set: 0.4492678940296173
loss_pred:0.015826335176825523, decouple_loss:0.002777665387839079
The modified gen p mean: 0.4481222927570343, gen p mean: -0.23724094033241272, mean p set: 0.44864511489868164
loss_pred:0.01612476259469986, decouple_loss:0.0026490152813494205
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472622871398926, gen p mean: -0.2403804212808609, mean p set: 0.4478394687175751
loss_pred:0.0166468508541584, decouple_loss:0.0028583803214132786
The modified gen p mean: 0.447873592376709, gen p mean: -0.23488730192184448, mean p set: 0.4484493136405945
loss_pred:0.01601586863398552, decouple_loss:0.0028801148291677237
The modified gen p mean: 0.447767049074173, gen p mean: -0.24030360579490662, mean p set: 0.4482938349246979
loss_pred:0.01627553068101406, decouple_loss:0.0029850418213754892
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881153106689453, gen p mean: -0.23149004578590393, mean p set: 0.44938814640045166
loss_pred:0.016680285334587097, decouple_loss:0.002898723352700472
The modified gen p mean: 0.44869986176490784, gen p mean: -0.23602628707885742, mean p set: 0.44927188754081726
loss_pred:0.015952182933688164, decouple_loss:0.0028258266393095255
The modified gen p mean: 0.447804719209671, gen p mean: -0.23228415846824646, mean p set: 0.4483359158039093
loss_pred:0.016302818432450294, decouple_loss:0.0028794121462851763
2023-04-26 23:43:51 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23503820598125458, mean p set: 0.4499112665653229
loss_pred:0.017443493008613586, decouple_loss:0.0028434540145099163
The modified gen p mean: 0.4482211768627167, gen p mean: -0.23245655000209808, mean p set: 0.44879910349845886
The modified gen p mean: 0.44925472140312195, gen p mean: -0.23465022444725037, mean p set: 0.4498290419578552
loss_pred:0.01734304055571556, decouple_loss:0.0028133061714470387
loss_pred:0.01712898723781109, decouple_loss:0.0027755226474255323
WV_1_PC_1_EH_0_PS_30, loss: 0.01744571141898632, avg_mse: 0.02567715011537075
current test mse: 0.025677
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493311047554016, gen p mean: -0.22819818556308746, mean p set: 0.4498658776283264
loss_pred:0.015761731192469597, decouple_loss:0.003052170155569911
The modified gen p mean: 0.4489651620388031, gen p mean: -0.2335503101348877, mean p set: 0.4495420455932617
loss_pred:0.01534032542258501, decouple_loss:0.0029997071251273155
The modified gen p mean: 0.4475543200969696, gen p mean: -0.23514050245285034, mean p set: 0.44812890887260437
loss_pred:0.016147520393133163, decouple_loss:0.0030580051243305206
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854581356048584, gen p mean: -0.23378580808639526, mean p set: 0.4490780532360077
loss_pred:0.015254149213433266, decouple_loss:0.003269017208367586
The modified gen p mean: 0.4482525885105133, gen p mean: -0.23814545571804047, mean p set: 0.4488280117511749
loss_pred:0.01581471785902977, decouple_loss:0.0031669563613831997
The modified gen p mean: 0.4478587806224823, gen p mean: -0.23292207717895508, mean p set: 0.4484385848045349
loss_pred:0.015342102386057377, decouple_loss:0.003247759770601988
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724714756011963, gen p mean: -0.23758092522621155, mean p set: 0.44776979088783264
loss_pred:0.015439405106008053, decouple_loss:0.003013764275237918
The modified gen p mean: 0.4474063217639923, gen p mean: -0.23138928413391113, mean p set: 0.44798383116722107
loss_pred:0.016989242285490036, decouple_loss:0.002635647775605321
The modified gen p mean: 0.44702091813087463, gen p mean: -0.22968247532844543, mean p set: 0.44759488105773926
loss_pred:0.016273634508252144, decouple_loss:0.002585790818557143
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484146237373352, gen p mean: -0.2371489405632019, mean p set: 0.44894084334373474
loss_pred:0.015358000062406063, decouple_loss:0.0027634843718260527
The modified gen p mean: 0.4472672641277313, gen p mean: -0.23120631277561188, mean p set: 0.44784268736839294
loss_pred:0.016659265384078026, decouple_loss:0.0030597883742302656
The modified gen p mean: 0.44768473505973816, gen p mean: -0.2322724610567093, mean p set: 0.44825834035873413
loss_pred:0.015589197166264057, decouple_loss:0.0030401116237044334
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469878077507019, gen p mean: -0.2378462851047516, mean p set: 0.4475710391998291
loss_pred:0.01538071222603321, decouple_loss:0.0028495921287685633
The modified gen p mean: 0.4475390911102295, gen p mean: -0.23552776873111725, mean p set: 0.44811877608299255
loss_pred:0.01533062569797039, decouple_loss:0.002841928042471409
The modified gen p mean: 0.44797495007514954, gen p mean: -0.23675212264060974, mean p set: 0.4485073983669281
loss_pred:0.01538525614887476, decouple_loss:0.0027609497774392366
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472061097621918, gen p mean: -0.22480140626430511, mean p set: 0.44777724146842957
loss_pred:0.016460927203297615, decouple_loss:0.0027733584865927696
The modified gen p mean: 0.447374165058136, gen p mean: -0.22943530976772308, mean p set: 0.4479498863220215
loss_pred:0.015186555683612823, decouple_loss:0.0029663369059562683
The modified gen p mean: 0.447981595993042, gen p mean: -0.22752885520458221, mean p set: 0.4485081434249878
loss_pred:0.015883315354585648, decouple_loss:0.0028778016567230225
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473545551300049, gen p mean: -0.22969204187393188, mean p set: 0.4479329288005829
loss_pred:0.015038019977509975, decouple_loss:0.0027588624507188797
The modified gen p mean: 0.4483949840068817, gen p mean: -0.23664633929729462, mean p set: 0.4489799737930298
loss_pred:0.015787048265337944, decouple_loss:0.0029478585347533226
The modified gen p mean: 0.44720908999443054, gen p mean: -0.23006142675876617, mean p set: 0.44773516058921814
loss_pred:0.016383031383156776, decouple_loss:0.0030758525244891644
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471953213214874, gen p mean: -0.22999724745750427, mean p set: 0.4477807283401489
loss_pred:0.016138654202222824, decouple_loss:0.0031660471577197313
The modified gen p mean: 0.4465124309062958, gen p mean: -0.23461347818374634, mean p set: 0.4470933675765991
loss_pred:0.015777593478560448, decouple_loss:0.003157483646646142
The modified gen p mean: 0.4483228027820587, gen p mean: -0.2296014279127121, mean p set: 0.4488586187362671
loss_pred:0.015258034691214561, decouple_loss:0.003361910115927458
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476732909679413, gen p mean: -0.23005545139312744, mean p set: 0.4482528567314148
loss_pred:0.014681552536785603, decouple_loss:0.0027476779650896788
The modified gen p mean: 0.44804805517196655, gen p mean: -0.2316623330116272, mean p set: 0.4486263692378998
loss_pred:0.01590082049369812, decouple_loss:0.002623565960675478
The modified gen p mean: 0.44719380140304565, gen p mean: -0.23030006885528564, mean p set: 0.44771671295166016
loss_pred:0.015966806560754776, decouple_loss:0.0027041558641940355
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492131471633911, gen p mean: -0.2290751039981842, mean p set: 0.4497953951358795
loss_pred:0.015519246459007263, decouple_loss:0.0032428980339318514
The modified gen p mean: 0.44745489954948425, gen p mean: -0.22799105942249298, mean p set: 0.44803711771965027
loss_pred:0.01619720831513405, decouple_loss:0.002825249684974551
The modified gen p mean: 0.44817861914634705, gen p mean: -0.23435638844966888, mean p set: 0.4487045109272003
loss_pred:0.015272719785571098, decouple_loss:0.002912804950028658
2023-04-26 23:48:10 testing...
The modified gen p mean: 0.44822558760643005, gen p mean: -0.2333640158176422, mean p set: 0.44879910349845886
loss_pred:0.01752382144331932, decouple_loss:0.0028375843539834023
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23636439442634583, mean p set: 0.4499112665653229
loss_pred:0.017684852704405785, decouple_loss:0.0029014875181019306
The modified gen p mean: 0.4492524266242981, gen p mean: -0.23600898683071136, mean p set: 0.4498290419578552
loss_pred:0.017344564199447632, decouple_loss:0.0029085418209433556
WV_1_PC_1_EH_0_PS_30, loss: 0.017661873251199722, avg_mse: 0.026024624705314636
current test mse: 0.026025
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840559363365173, gen p mean: -0.23924635350704193, mean p set: 0.4489794969558716
loss_pred:0.015685247257351875, decouple_loss:0.0029476950876414776
The modified gen p mean: 0.44802868366241455, gen p mean: -0.24164173007011414, mean p set: 0.44860297441482544
loss_pred:0.015096768736839294, decouple_loss:0.002866760129109025
The modified gen p mean: 0.44757241010665894, gen p mean: -0.23473264276981354, mean p set: 0.4481014907360077
loss_pred:0.015345187857747078, decouple_loss:0.0028734479565173388
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485202133655548, gen p mean: -0.2412227839231491, mean p set: 0.44905373454093933
loss_pred:0.015797602012753487, decouple_loss:0.002963873790577054
The modified gen p mean: 0.44802576303482056, gen p mean: -0.23994962871074677, mean p set: 0.4486044645309448The modified gen p mean: 0.44735440611839294, gen p mean: -0.23734571039676666, mean p set: 0.44793590903282166
loss_pred:0.015181545168161392, decouple_loss:0.00286734732799232
loss_pred:0.015532395802438259, decouple_loss:0.0028871905524283648
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483233392238617, gen p mean: -0.24146254360675812, mean p set: 0.4488582909107208
loss_pred:0.01579764485359192, decouple_loss:0.0029439982026815414
The modified gen p mean: 0.44741764664649963, gen p mean: -0.2452990859746933, mean p set: 0.4479990005493164The modified gen p mean: 0.4479891359806061, gen p mean: -0.24297210574150085, mean p set: 0.44856035709381104
loss_pred:0.015238182619214058, decouple_loss:0.0029630663339048624
loss_pred:0.015135376714169979, decouple_loss:0.0032931743189692497
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813272356987, gen p mean: -0.24780359864234924, mean p set: 0.44865697622299194
loss_pred:0.015684179961681366, decouple_loss:0.0027067551854997873
The modified gen p mean: 0.44842541217803955, gen p mean: -0.24528254568576813, mean p set: 0.4489966928958893
loss_pred:0.015679536387324333, decouple_loss:0.0028042513877153397
The modified gen p mean: 0.44786205887794495, gen p mean: -0.25374287366867065, mean p set: 0.44844159483909607
loss_pred:0.015075372532010078, decouple_loss:0.002848238218575716
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683995842933655, gen p mean: -0.24375680088996887, mean p set: 0.4474125802516937
loss_pred:0.01519015897065401, decouple_loss:0.003071805229410529
The modified gen p mean: 0.44801291823387146, gen p mean: -0.2486685961484909, mean p set: 0.4485870599746704The modified gen p mean: 0.44768330454826355, gen p mean: -0.24854058027267456, mean p set: 0.4482114315032959
loss_pred:0.014926956035196781, decouple_loss:0.003303414210677147
loss_pred:0.015007882378995419, decouple_loss:0.002871390897780657
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482952654361725, gen p mean: -0.2512190639972687, mean p set: 0.4488692879676819
loss_pred:0.015773773193359375, decouple_loss:0.0027189659886062145
The modified gen p mean: 0.4478543698787689, gen p mean: -0.25051283836364746, mean p set: 0.44843214750289917
loss_pred:0.015171156264841557, decouple_loss:0.0028606951236724854
The modified gen p mean: 0.44897541403770447, gen p mean: -0.2399022877216339, mean p set: 0.4495067000389099
loss_pred:0.014460636302828789, decouple_loss:0.002900938270613551
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486786127090454, gen p mean: -0.2424924224615097, mean p set: 0.4492571949958801
loss_pred:0.014848949387669563, decouple_loss:0.0032507211435586214
The modified gen p mean: 0.44705843925476074, gen p mean: -0.24075335264205933, mean p set: 0.44763508439064026
loss_pred:0.015187880955636501, decouple_loss:0.0031922231428325176
The modified gen p mean: 0.4476272761821747, gen p mean: -0.24280105531215668, mean p set: 0.44816192984580994
loss_pred:0.014723608270287514, decouple_loss:0.003232697956264019
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482264816761017, gen p mean: -0.2500322461128235, mean p set: 0.4488038718700409
loss_pred:0.014744658023118973, decouple_loss:0.002797916065901518
The modified gen p mean: 0.44856011867523193, gen p mean: -0.24840719997882843, mean p set: 0.449133038520813
loss_pred:0.01562524028122425, decouple_loss:0.0028502095956355333
The modified gen p mean: 0.4473121464252472, gen p mean: -0.24366308748722076, mean p set: 0.44784215092658997
loss_pred:0.014937218278646469, decouple_loss:0.0029549668543040752
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483354389667511, gen p mean: -0.2523989677429199, mean p set: 0.4489099383354187
loss_pred:0.014918294735252857, decouple_loss:0.003014213405549526
The modified gen p mean: 0.4471719264984131, gen p mean: -0.24068662524223328, mean p set: 0.4477514326572418
loss_pred:0.01639627292752266, decouple_loss:0.002911101561039686
The modified gen p mean: 0.44727084040641785, gen p mean: -0.24152854084968567, mean p set: 0.4477945566177368
loss_pred:0.015625571832060814, decouple_loss:0.003038479946553707
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486287236213684, gen p mean: -0.24613574147224426, mean p set: 0.44921019673347473
loss_pred:0.015330306254327297, decouple_loss:0.0032312932889908552
The modified gen p mean: 0.4480540156364441, gen p mean: -0.24807752668857574, mean p set: 0.4486351013183594
loss_pred:0.015007573179900646, decouple_loss:0.003113653277978301
The modified gen p mean: 0.4483267366886139, gen p mean: -0.24537160992622375, mean p set: 0.4488556683063507
loss_pred:0.015738869085907936, decouple_loss:0.0031196721829473972
2023-04-26 23:51:36 testing...
The modified gen p mean: 0.4482268989086151, gen p mean: -0.2412893921136856, mean p set: 0.44879910349845886
loss_pred:0.01749793440103531, decouple_loss:0.003096901811659336
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2441507875919342, mean p set: 0.4499112665653229
loss_pred:0.01771055907011032, decouple_loss:0.003043660894036293
The modified gen p mean: 0.44925281405448914, gen p mean: -0.2436182051897049, mean p set: 0.4498290419578552
loss_pred:0.017202598974108696, decouple_loss:0.0029599799308925867
WV_1_PC_1_EH_0_PS_30, loss: 0.01762204058468342, avg_mse: 0.025942837819457054
current test mse: 0.025943
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622132182121277, gen p mean: -0.24353304505348206, mean p set: 0.44675159454345703
loss_pred:0.016287975013256073, decouple_loss:0.003099583787843585
The modified gen p mean: 0.44679802656173706, gen p mean: -0.244728222489357, mean p set: 0.4473665952682495
loss_pred:0.016503358259797096, decouple_loss:0.0032494727056473494
The modified gen p mean: 0.4475087523460388, gen p mean: -0.24442347884178162, mean p set: 0.44808098673820496
loss_pred:0.016712043434381485, decouple_loss:0.0030763319227844477
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480491578578949, gen p mean: -0.24307881295681, mean p set: 0.44858697056770325
loss_pred:0.016224417835474014, decouple_loss:0.003291428554803133
The modified gen p mean: 0.4485017955303192, gen p mean: -0.24486657977104187, mean p set: 0.44907623529434204The modified gen p mean: 0.44558578729629517, gen p mean: -0.2455737292766571, mean p set: 0.4461652636528015
loss_pred:0.01671927608549595, decouple_loss:0.003528756555169821
loss_pred:0.01657046750187874, decouple_loss:0.0031534507870674133
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467756152153015, gen p mean: -0.24515169858932495, mean p set: 0.4473038911819458
loss_pred:0.015955736860632896, decouple_loss:0.00269625848159194
The modified gen p mean: 0.44662153720855713, gen p mean: -0.24054306745529175, mean p set: 0.4471926689147949
loss_pred:0.0163422878831625, decouple_loss:0.002686599735170603
The modified gen p mean: 0.4457206428050995, gen p mean: -0.23804275691509247, mean p set: 0.44630563259124756
loss_pred:0.015862785279750824, decouple_loss:0.0027191140688955784
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473535716533661, gen p mean: -0.23895108699798584, mean p set: 0.44787678122520447
loss_pred:0.016472678631544113, decouple_loss:0.0036842466797679663
The modified gen p mean: 0.44677087664604187, gen p mean: -0.24255074560642242, mean p set: 0.4473566710948944
loss_pred:0.01575852558016777, decouple_loss:0.003665047697722912
The modified gen p mean: 0.44590190052986145, gen p mean: -0.23846650123596191, mean p set: 0.44647401571273804
loss_pred:0.01650281436741352, decouple_loss:0.0036712889559566975
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489535093307495, gen p mean: -0.2522522211074829, mean p set: 0.44952791929244995
The modified gen p mean: 0.4471251964569092, gen p mean: -0.24700695276260376, mean p set: 0.4476941227912903
loss_pred:0.01589864306151867, decouple_loss:0.0033194194547832012
loss_pred:0.016475794836878777, decouple_loss:0.003014324000105262
The modified gen p mean: 0.447213739156723, gen p mean: -0.2530842423439026, mean p set: 0.4477439522743225
loss_pred:0.015800558030605316, decouple_loss:0.002921679522842169
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448081374168396, gen p mean: -0.25502192974090576, mean p set: 0.4486584961414337
loss_pred:0.015814030542969704, decouple_loss:0.003511792281642556
The modified gen p mean: 0.4465980529785156, gen p mean: -0.2542196214199066, mean p set: 0.4471711814403534
loss_pred:0.01606997847557068, decouple_loss:0.0034015506971627474
The modified gen p mean: 0.4470002055168152, gen p mean: -0.2555478513240814, mean p set: 0.44752782583236694
loss_pred:0.016266105696558952, decouple_loss:0.003608991391956806
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848182797431946, gen p mean: -0.2554651200771332, mean p set: 0.4490543007850647
loss_pred:0.016561588272452354, decouple_loss:0.0036104326136410236
The modified gen p mean: 0.44682577252388, gen p mean: -0.2554822862148285, mean p set: 0.4473998546600342
loss_pred:0.01570303365588188, decouple_loss:0.0032853165175765753
The modified gen p mean: 0.4487904906272888, gen p mean: -0.25620269775390625, mean p set: 0.44931700825691223
loss_pred:0.01592930033802986, decouple_loss:0.003459472442045808
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44599586725234985, gen p mean: -0.2525746822357178, mean p set: 0.4465752840042114
loss_pred:0.016308236867189407, decouple_loss:0.0030518167186528444
The modified gen p mean: 0.44870272278785706, gen p mean: -0.2593415081501007, mean p set: 0.44927704334259033
loss_pred:0.016045114025473595, decouple_loss:0.003104829229414463
The modified gen p mean: 0.44577571749687195, gen p mean: -0.2527446448802948, mean p set: 0.44630685448646545
loss_pred:0.016316579654812813, decouple_loss:0.0030608063098043203
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44519275426864624, gen p mean: -0.26532676815986633, mean p set: 0.4457697868347168
loss_pred:0.016350623220205307, decouple_loss:0.0031349847558885813
The modified gen p mean: 0.4465196132659912, gen p mean: -0.2649485170841217, mean p set: 0.4471011161804199
loss_pred:0.01673370786011219, decouple_loss:0.0033057702239602804
The modified gen p mean: 0.4467223286628723, gen p mean: -0.25994065403938293, mean p set: 0.44725558161735535
loss_pred:0.016102580353617668, decouple_loss:0.003244022373110056
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807112216949463, gen p mean: -0.2579409182071686, mean p set: 0.44865259528160095
loss_pred:0.015676720067858696, decouple_loss:0.0030727291014045477
The modified gen p mean: 0.4465431272983551, gen p mean: -0.25520262122154236, mean p set: 0.44712045788764954
loss_pred:0.01591832935810089, decouple_loss:0.0029750976245850325
The modified gen p mean: 0.44881394505500793, gen p mean: -0.25812485814094543, mean p set: 0.44933852553367615
loss_pred:0.01623309589922428, decouple_loss:0.003369415644556284
2023-04-26 23:55:52 testing...
The modified gen p mean: 0.4482225477695465, gen p mean: -0.2503967881202698, mean p set: 0.44879910349845886
loss_pred:0.017332779243588448, decouple_loss:0.0030768041033297777
The modified gen p mean: 0.4494309425354004, gen p mean: -0.253057062625885, mean p set: 0.4499112665653229
loss_pred:0.017515059560537338, decouple_loss:0.0030708559788763523
The modified gen p mean: 0.44925326108932495, gen p mean: -0.25302010774612427, mean p set: 0.4498290419578552
loss_pred:0.017041340470314026, decouple_loss:0.003030449617654085
WV_1_PC_1_EH_0_PS_30, loss: 0.017449362203478813, avg_mse: 0.02563421055674553
current test mse: 0.025634
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447248250246048, gen p mean: -0.2514203190803528, mean p set: 0.44782623648643494
loss_pred:0.015789363533258438, decouple_loss:0.003210444003343582
The modified gen p mean: 0.4460552930831909, gen p mean: -0.2492312490940094, mean p set: 0.4466271698474884
loss_pred:0.01599786803126335, decouple_loss:0.0031313567887991667
The modified gen p mean: 0.44743090867996216, gen p mean: -0.25679463148117065, mean p set: 0.447951078414917
loss_pred:0.015510554425418377, decouple_loss:0.003135963575914502
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621729850769043, gen p mean: -0.2517198622226715, mean p set: 0.4467402696609497
loss_pred:0.01654348336160183, decouple_loss:0.003222952364012599
The modified gen p mean: 0.44630861282348633, gen p mean: -0.2555270791053772, mean p set: 0.44689324498176575
loss_pred:0.01654505357146263, decouple_loss:0.002998463809490204
The modified gen p mean: 0.44821539521217346, gen p mean: -0.2537045478820801, mean p set: 0.4487825632095337
loss_pred:0.016007721424102783, decouple_loss:0.003076454857364297
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775882363319397, gen p mean: -0.25531214475631714, mean p set: 0.4482913017272949
loss_pred:0.015976082533597946, decouple_loss:0.002813478233292699
The modified gen p mean: 0.44666799902915955, gen p mean: -0.2513137757778168, mean p set: 0.447246253490448
loss_pred:0.015437976457178593, decouple_loss:0.0029791868291795254
The modified gen p mean: 0.44583427906036377, gen p mean: -0.2519327402114868, mean p set: 0.4464118480682373
loss_pred:0.016617676243185997, decouple_loss:0.0027626254595816135
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663482904434204, gen p mean: -0.25327441096305847, mean p set: 0.44715940952301025
loss_pred:0.016345834359526634, decouple_loss:0.0027632731944322586
The modified gen p mean: 0.4461592137813568, gen p mean: -0.25168973207473755, mean p set: 0.44673389196395874
loss_pred:0.015632541850209236, decouple_loss:0.0030218278989195824
The modified gen p mean: 0.44734737277030945, gen p mean: -0.25223445892333984, mean p set: 0.4479255974292755
loss_pred:0.016250869259238243, decouple_loss:0.002886879025027156
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790494441986084, gen p mean: -0.2489369660615921, mean p set: 0.448486864566803
loss_pred:0.016115734353661537, decouple_loss:0.0028331507928669453
The modified gen p mean: 0.4463559091091156, gen p mean: -0.24840182065963745, mean p set: 0.4469289183616638
loss_pred:0.016021892428398132, decouple_loss:0.0027780018281191587
The modified gen p mean: 0.44572487473487854, gen p mean: -0.2456084042787552, mean p set: 0.44625577330589294
loss_pred:0.0160199161618948, decouple_loss:0.002957007847726345
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472387731075287, gen p mean: -0.2533397376537323, mean p set: 0.4478095471858978
loss_pred:0.015836337581276894, decouple_loss:0.00282952468842268
The modified gen p mean: 0.4461130201816559, gen p mean: -0.2427523285150528, mean p set: 0.44668781757354736
loss_pred:0.01658797264099121, decouple_loss:0.0029009724967181683
The modified gen p mean: 0.44814833998680115, gen p mean: -0.24444358050823212, mean p set: 0.44868341088294983
loss_pred:0.015786703675985336, decouple_loss:0.0028404502663761377
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459340572357178, gen p mean: -0.24051663279533386, mean p set: 0.44651132822036743
loss_pred:0.0166926309466362, decouple_loss:0.002607595408335328
The modified gen p mean: 0.4451614022254944, gen p mean: -0.2502440810203552, mean p set: 0.44573795795440674
loss_pred:0.015946559607982635, decouple_loss:0.0031269907485693693
The modified gen p mean: 0.4462713599205017, gen p mean: -0.24182890355587006, mean p set: 0.44680535793304443
loss_pred:0.01550394855439663, decouple_loss:0.002927588764578104
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462083876132965, gen p mean: -0.24405622482299805, mean p set: 0.4467838406562805
loss_pred:0.015622066333889961, decouple_loss:0.002686405321583152
The modified gen p mean: 0.4475019872188568, gen p mean: -0.24936173856258392, mean p set: 0.448073148727417
loss_pred:0.01601378619670868, decouple_loss:0.002977984258905053
The modified gen p mean: 0.44562920928001404, gen p mean: -0.2514816224575043, mean p set: 0.4461599588394165
loss_pred:0.016226336359977722, decouple_loss:0.002972288290038705
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44637149572372437, gen p mean: -0.24718253314495087, mean p set: 0.44695523381233215
loss_pred:0.015651829540729523, decouple_loss:0.0030448914039880037
The modified gen p mean: 0.4473632574081421, gen p mean: -0.2570752203464508, mean p set: 0.44794052839279175
loss_pred:0.0155663276091218, decouple_loss:0.0029120291583240032
The modified gen p mean: 0.44729873538017273, gen p mean: -0.25027287006378174, mean p set: 0.4478280544281006
loss_pred:0.015890968963503838, decouple_loss:0.002917991252616048
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478723406791687, gen p mean: -0.2503896653652191, mean p set: 0.4484470784664154
loss_pred:0.01594914309680462, decouple_loss:0.0028609568253159523
The modified gen p mean: 0.4474196434020996, gen p mean: -0.25427424907684326, mean p set: 0.44799599051475525
loss_pred:0.015143286436796188, decouple_loss:0.0027425491716712713
The modified gen p mean: 0.4464150369167328, gen p mean: -0.24792400002479553, mean p set: 0.44694921374320984
loss_pred:0.015866069123148918, decouple_loss:0.002939858939498663
2023-04-26 23:59:19 testing...
The modified gen p mean: 0.44822821021080017, gen p mean: -0.24641545116901398, mean p set: 0.44879910349845886
loss_pred:0.017444202676415443, decouple_loss:0.002841839101165533
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2493142932653427, mean p set: 0.4499112665653229
loss_pred:0.017547722905874252, decouple_loss:0.0029265829361975193
The modified gen p mean: 0.44925379753112793, gen p mean: -0.24921855330467224, mean p set: 0.4498290419578552
loss_pred:0.0169968344271183, decouple_loss:0.002832659287378192
WV_1_PC_1_EH_0_PS_30, loss: 0.01747293956577778, avg_mse: 0.025674602016806602
current test mse: 0.025675
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483483135700226, gen p mean: -0.24395331740379333, mean p set: 0.44888588786125183
loss_pred:0.015406466089189053, decouple_loss:0.0034073074348270893
The modified gen p mean: 0.4475390315055847, gen p mean: -0.25145041942596436, mean p set: 0.4481172263622284
loss_pred:0.015987636521458626, decouple_loss:0.0030937264673411846
The modified gen p mean: 0.44713157415390015, gen p mean: -0.2480831891298294, mean p set: 0.4477090537548065
loss_pred:0.01543240062892437, decouple_loss:0.003031210508197546
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723016023635864, gen p mean: -0.2467208206653595, mean p set: 0.4477570950984955
loss_pred:0.01577155292034149, decouple_loss:0.0029859021306037903
The modified gen p mean: 0.4468994438648224, gen p mean: -0.24865120649337769, mean p set: 0.4474763870239258The modified gen p mean: 0.4472575783729553, gen p mean: -0.2554943859577179, mean p set: 0.44783034920692444
loss_pred:0.016180207952857018, decouple_loss:0.0028518876060843468
loss_pred:0.01587284356355667, decouple_loss:0.0031216039787977934
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446852445602417, gen p mean: -0.24495115876197815, mean p set: 0.4473787844181061
loss_pred:0.015735577791929245, decouple_loss:0.0029866318218410015
The modified gen p mean: 0.44762083888053894, gen p mean: -0.2475157082080841, mean p set: 0.4481918513774872
loss_pred:0.015388522297143936, decouple_loss:0.0029255645349621773
The modified gen p mean: 0.448032408952713, gen p mean: -0.24841086566448212, mean p set: 0.4486024081707001
loss_pred:0.0156601183116436, decouple_loss:0.002870653523132205
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466289281845093, gen p mean: -0.24243934452533722, mean p set: 0.4471501410007477
loss_pred:0.01595880836248398, decouple_loss:0.0028890734538435936
The modified gen p mean: 0.4470175504684448, gen p mean: -0.2497764527797699, mean p set: 0.44759440422058105
loss_pred:0.015522892586886883, decouple_loss:0.0028919184114784002
The modified gen p mean: 0.44791150093078613, gen p mean: -0.24417078495025635, mean p set: 0.448486864566803
loss_pred:0.015407022088766098, decouple_loss:0.0030340731609612703
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713112711906433, gen p mean: -0.2440638542175293, mean p set: 0.4477039873600006
loss_pred:0.014948770403862, decouple_loss:0.002932481002062559
The modified gen p mean: 0.44866257905960083, gen p mean: -0.24183088541030884, mean p set: 0.44924864172935486
loss_pred:0.01483421865850687, decouple_loss:0.003354092361405492
The modified gen p mean: 0.4491322934627533, gen p mean: -0.23723874986171722, mean p set: 0.44966015219688416
loss_pred:0.014919293113052845, decouple_loss:0.0031604627147316933
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476592540740967, gen p mean: -0.24572759866714478, mean p set: 0.4482389986515045
loss_pred:0.015596467070281506, decouple_loss:0.003705365350469947
The modified gen p mean: 0.44736945629119873, gen p mean: -0.2403261363506317, mean p set: 0.44794946908950806
loss_pred:0.015366360545158386, decouple_loss:0.003513540141284466
The modified gen p mean: 0.4480295777320862, gen p mean: -0.24507686495780945, mean p set: 0.4485662877559662
loss_pred:0.01538323238492012, decouple_loss:0.0032141467090696096
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466313123703003, gen p mean: -0.24936583638191223, mean p set: 0.4472118318080902
The modified gen p mean: 0.44700896739959717, gen p mean: -0.25270935893058777, mean p set: 0.44758692383766174
loss_pred:0.015465217642486095, decouple_loss:0.002928258152678609
loss_pred:0.016393890604376793, decouple_loss:0.002815652871504426
The modified gen p mean: 0.44807493686676025, gen p mean: -0.25006765127182007, mean p set: 0.4486064314842224
loss_pred:0.015147223137319088, decouple_loss:0.002845907351002097
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468531906604767, gen p mean: -0.25161266326904297, mean p set: 0.447422593832016
loss_pred:0.01567687839269638, decouple_loss:0.0031318562105298042
The modified gen p mean: 0.44713351130485535, gen p mean: -0.2526947259902954, mean p set: 0.44770386815071106
loss_pred:0.015881333500146866, decouple_loss:0.0031559173949062824
The modified gen p mean: 0.44791167974472046, gen p mean: -0.25705116987228394, mean p set: 0.448443204164505
loss_pred:0.015368947759270668, decouple_loss:0.0036336490884423256
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731032848358154, gen p mean: -0.2539970278739929, mean p set: 0.44789108633995056
loss_pred:0.016271116212010384, decouple_loss:0.003471571719273925
The modified gen p mean: 0.44875219464302063, gen p mean: -0.25078436732292175, mean p set: 0.449325829744339
loss_pred:0.014496518298983574, decouple_loss:0.003426659619435668
The modified gen p mean: 0.44659486413002014, gen p mean: -0.2559775114059448, mean p set: 0.4471273422241211
loss_pred:0.016095487400889397, decouple_loss:0.00299831316806376
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474193751811981, gen p mean: -0.24676549434661865, mean p set: 0.4479982852935791
The modified gen p mean: 0.4478122591972351, gen p mean: -0.24949300289154053, mean p set: 0.4483886957168579
loss_pred:0.015054035000503063, decouple_loss:0.003911587875336409
loss_pred:0.015629637986421585, decouple_loss:0.0037538313772529364
The modified gen p mean: 0.4464056193828583, gen p mean: -0.24727222323417664, mean p set: 0.4469318985939026
loss_pred:0.016476675868034363, decouple_loss:0.0037304586730897427
2023-04-27 00:03:37 testing...
The modified gen p mean: 0.4482259452342987, gen p mean: -0.2420533299446106, mean p set: 0.44879910349845886
loss_pred:0.017516303807497025, decouple_loss:0.0032454286701977253
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24487026035785675, mean p set: 0.4499112665653229
loss_pred:0.017619119957089424, decouple_loss:0.003435618244111538
The modified gen p mean: 0.44925516843795776, gen p mean: -0.24483750760555267, mean p set: 0.4498290419578552
loss_pred:0.01709146425127983, decouple_loss:0.0032077839132398367
WV_1_PC_1_EH_0_PS_30, loss: 0.017573777586221695, avg_mse: 0.025869544595479965
current test mse: 0.02587
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467623233795166, gen p mean: -0.24850377440452576, mean p set: 0.4473388195037842
loss_pred:0.015246226452291012, decouple_loss:0.0031172523740679026
The modified gen p mean: 0.4482232630252838, gen p mean: -0.25042539834976196, mean p set: 0.44880568981170654
loss_pred:0.015388475731015205, decouple_loss:0.003206079127267003
The modified gen p mean: 0.44731268286705017, gen p mean: -0.24411489069461823, mean p set: 0.4478378891944885
loss_pred:0.015225250273942947, decouple_loss:0.003213005606085062
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485304057598114, gen p mean: -0.24960857629776, mean p set: 0.4490576982498169
loss_pred:0.014733308926224709, decouple_loss:0.0038203583098948
The modified gen p mean: 0.4479459822177887, gen p mean: -0.24931763112545013, mean p set: 0.4485197067260742The modified gen p mean: 0.4477292001247406, gen p mean: -0.25094038248062134, mean p set: 0.448304146528244
loss_pred:0.015333560295403004, decouple_loss:0.003715956350788474
loss_pred:0.015314104966819286, decouple_loss:0.004076438955962658
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474762976169586, gen p mean: -0.2518044412136078, mean p set: 0.44800394773483276
loss_pred:0.01575242169201374, decouple_loss:0.0034710669424384832
The modified gen p mean: 0.4480331540107727, gen p mean: -0.25167104601860046, mean p set: 0.44860947132110596
loss_pred:0.015295743010938168, decouple_loss:0.0035174016375094652
The modified gen p mean: 0.44834238290786743, gen p mean: -0.24983268976211548, mean p set: 0.448910653591156
loss_pred:0.014730971306562424, decouple_loss:0.003198462538421154
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479995369911194, gen p mean: -0.2541922330856323, mean p set: 0.44853144884109497
loss_pred:0.015472132712602615, decouple_loss:0.003463566768914461
The modified gen p mean: 0.446793794631958, gen p mean: -0.2523185610771179, mean p set: 0.44737890362739563The modified gen p mean: 0.4470466077327728, gen p mean: -0.24663101136684418, mean p set: 0.44762441515922546
loss_pred:0.015612492337822914, decouple_loss:0.003287524450570345
loss_pred:0.01546644326299429, decouple_loss:0.0032772698905318975
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483872056007385, gen p mean: -0.2506294846534729, mean p set: 0.44896969199180603
loss_pred:0.01537008211016655, decouple_loss:0.0037100163754075766
The modified gen p mean: 0.44708678126335144, gen p mean: -0.24731583893299103, mean p set: 0.4476620554924011
loss_pred:0.015794185921549797, decouple_loss:0.003845947328954935
The modified gen p mean: 0.4484368562698364, gen p mean: -0.24922771751880646, mean p set: 0.44897186756134033
loss_pred:0.015056810341775417, decouple_loss:0.0039981817826628685
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767940044403076, gen p mean: -0.24932946264743805, mean p set: 0.4482576549053192
loss_pred:0.015540096908807755, decouple_loss:0.003250187961384654
The modified gen p mean: 0.4471180737018585, gen p mean: -0.25604143738746643, mean p set: 0.4477013349533081
loss_pred:0.015882233157753944, decouple_loss:0.0034305097069591284
The modified gen p mean: 0.4481518566608429, gen p mean: -0.25115013122558594, mean p set: 0.44869139790534973
loss_pred:0.015004757791757584, decouple_loss:0.003145146183669567
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883933663368225, gen p mean: -0.24632030725479126, mean p set: 0.44941452145576477
loss_pred:0.015314181335270405, decouple_loss:0.0032021035440266132
The modified gen p mean: 0.447735071182251, gen p mean: -0.2468792051076889, mean p set: 0.44830334186553955
loss_pred:0.015944845974445343, decouple_loss:0.003364946460351348
The modified gen p mean: 0.447479784488678, gen p mean: -0.24677176773548126, mean p set: 0.44800183176994324
loss_pred:0.01564357988536358, decouple_loss:0.003365178592503071
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485660195350647, gen p mean: -0.24338673055171967, mean p set: 0.4491487443447113
loss_pred:0.014974047429859638, decouple_loss:0.0034256530925631523
The modified gen p mean: 0.4475082755088806, gen p mean: -0.244694322347641, mean p set: 0.448081910610199
loss_pred:0.01593518815934658, decouple_loss:0.0032143844291567802
The modified gen p mean: 0.4482119083404541, gen p mean: -0.24773487448692322, mean p set: 0.4487426280975342
loss_pred:0.015698574483394623, decouple_loss:0.003241712925955653
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808393716812134, gen p mean: -0.2373347282409668, mean p set: 0.44866064190864563
loss_pred:0.01569513976573944, decouple_loss:0.003034760244190693
The modified gen p mean: 0.447060763835907, gen p mean: -0.24211730062961578, mean p set: 0.4476398825645447
loss_pred:0.015589717775583267, decouple_loss:0.002993812086060643
The modified gen p mean: 0.44651973247528076, gen p mean: -0.23999859392642975, mean p set: 0.4470519721508026
loss_pred:0.015608767978847027, decouple_loss:0.0029649764765053988
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707393646240234, gen p mean: -0.2434549629688263, mean p set: 0.4476523995399475
loss_pred:0.015870289877057076, decouple_loss:0.0029707266949117184
The modified gen p mean: 0.4471084177494049, gen p mean: -0.24109874665737152, mean p set: 0.44768473505973816
loss_pred:0.015533311292529106, decouple_loss:0.0036182242911309004
The modified gen p mean: 0.447775661945343, gen p mean: -0.23877407610416412, mean p set: 0.44830429553985596
loss_pred:0.015060384757816792, decouple_loss:0.0032237002160400152
2023-04-27 00:07:02 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24085618555545807, mean p set: 0.4499112665653229
loss_pred:0.017619511112570763, decouple_loss:0.0031943314243108034
The modified gen p mean: 0.4482281804084778, gen p mean: -0.23850293457508087, mean p set: 0.44879910349845886
loss_pred:0.01755392923951149, decouple_loss:0.0030329255387187004
The modified gen p mean: 0.44925445318222046, gen p mean: -0.24092580378055573, mean p set: 0.4498290419578552
loss_pred:0.017210356891155243, decouple_loss:0.003095480613410473
WV_1_PC_1_EH_0_PS_30, loss: 0.017616644501686096, avg_mse: 0.02595498599112034
current test mse: 0.025955
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478541612625122, gen p mean: -0.23963817954063416, mean p set: 0.44838324189186096
loss_pred:0.016039051115512848, decouple_loss:0.002998187206685543
The modified gen p mean: 0.44652315974235535, gen p mean: -0.24254055321216583, mean p set: 0.44709837436676025
loss_pred:0.016838664188981056, decouple_loss:0.0028759436681866646
The modified gen p mean: 0.44643434882164, gen p mean: -0.24648192524909973, mean p set: 0.4470071494579315
loss_pred:0.016151556745171547, decouple_loss:0.0028540249913930893
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475101828575134, gen p mean: -0.23537877202033997, mean p set: 0.44803258776664734
loss_pred:0.015922851860523224, decouple_loss:0.0027948226779699326
The modified gen p mean: 0.448271781206131, gen p mean: -0.24076785147190094, mean p set: 0.44884711503982544
loss_pred:0.016612928360700607, decouple_loss:0.0029573740903288126
The modified gen p mean: 0.44702038168907166, gen p mean: -0.23957346379756927, mean p set: 0.44759562611579895
loss_pred:0.01571950688958168, decouple_loss:0.002816715044900775
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465506970882416, gen p mean: -0.24118727445602417, mean p set: 0.4470813572406769
loss_pred:0.01580546237528324, decouple_loss:0.003029183018952608
The modified gen p mean: 0.4474242925643921, gen p mean: -0.24524886906147003, mean p set: 0.4480046033859253
loss_pred:0.01567710191011429, decouple_loss:0.0030935003887861967
The modified gen p mean: 0.4475152790546417, gen p mean: -0.23654650151729584, mean p set: 0.44809815287590027
loss_pred:0.015256938524544239, decouple_loss:0.0028194740880280733
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609081745147705, gen p mean: -0.2474995255470276, mean p set: 0.4466179311275482
loss_pred:0.016058484092354774, decouple_loss:0.0028616031631827354
The modified gen p mean: 0.44698387384414673, gen p mean: -0.2523292303085327, mean p set: 0.44756636023521423
loss_pred:0.016055665910243988, decouple_loss:0.0028301330748945475
The modified gen p mean: 0.4476333260536194, gen p mean: -0.2511105239391327, mean p set: 0.44820475578308105
loss_pred:0.016832346096634865, decouple_loss:0.002839163178578019
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472939074039459, gen p mean: -0.2401474267244339, mean p set: 0.4478640854358673
loss_pred:0.01529715396463871, decouple_loss:0.003952357918024063
The modified gen p mean: 0.4473997950553894, gen p mean: -0.24881713092327118, mean p set: 0.44797375798225403The modified gen p mean: 0.4481721818447113, gen p mean: -0.2434074878692627, mean p set: 0.4487118422985077
loss_pred:0.017119498923420906, decouple_loss:0.003089781617745757
loss_pred:0.015548831783235073, decouple_loss:0.0034642713144421577
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476364850997925, gen p mean: -0.2475864589214325, mean p set: 0.4482135772705078
loss_pred:0.015947941690683365, decouple_loss:0.003013710957020521
The modified gen p mean: 0.4471534192562103, gen p mean: -0.24629896879196167, mean p set: 0.4477352201938629
loss_pred:0.01668689027428627, decouple_loss:0.0028060353361070156
The modified gen p mean: 0.44789353013038635, gen p mean: -0.2466624230146408, mean p set: 0.4484192430973053
loss_pred:0.016707923263311386, decouple_loss:0.0028759862761944532
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478343427181244, gen p mean: -0.24679459631443024, mean p set: 0.44841933250427246
loss_pred:0.016691314056515694, decouple_loss:0.003092709230259061
The modified gen p mean: 0.44689399003982544, gen p mean: -0.24840602278709412, mean p set: 0.44746458530426025
loss_pred:0.015950120985507965, decouple_loss:0.0037150774151086807
The modified gen p mean: 0.4474157392978668, gen p mean: -0.2451692521572113, mean p set: 0.4479471743106842
loss_pred:0.016407549381256104, decouple_loss:0.003382385242730379
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799157977104187, gen p mean: -0.24312542378902435, mean p set: 0.4485728442668915
loss_pred:0.01602775789797306, decouple_loss:0.003134517464786768
The modified gen p mean: 0.44714927673339844, gen p mean: -0.23944182693958282, mean p set: 0.4477280378341675
loss_pred:0.015862304717302322, decouple_loss:0.002879735780879855
The modified gen p mean: 0.447275847196579, gen p mean: -0.24900145828723907, mean p set: 0.4478060305118561
loss_pred:0.01592249982059002, decouple_loss:0.0032175430096685886
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44595491886138916, gen p mean: -0.2447977215051651, mean p set: 0.4465283155441284
loss_pred:0.016486231237649918, decouple_loss:0.003110351040959358
The modified gen p mean: 0.44759202003479004, gen p mean: -0.24188710749149323, mean p set: 0.44816744327545166
loss_pred:0.016293108463287354, decouple_loss:0.003332112915813923
The modified gen p mean: 0.44784224033355713, gen p mean: -0.24158775806427002, mean p set: 0.44837021827697754
loss_pred:0.01608741283416748, decouple_loss:0.0032695888075977564
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633883237838745, gen p mean: -0.24470511078834534, mean p set: 0.44691428542137146
loss_pred:0.01626153104007244, decouple_loss:0.0031316601671278477
The modified gen p mean: 0.4458560347557068, gen p mean: -0.24454069137573242, mean p set: 0.44642776250839233
loss_pred:0.015900230035185814, decouple_loss:0.0030545885674655437
The modified gen p mean: 0.4466681480407715, gen p mean: -0.24082434177398682, mean p set: 0.44719401001930237
loss_pred:0.01668507792055607, decouple_loss:0.0032032448798418045
2023-04-27 00:11:19 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24025408923625946, mean p set: 0.4499112665653229
loss_pred:0.01761886477470398, decouple_loss:0.0036998421419411898
The modified gen p mean: 0.44822242856025696, gen p mean: -0.23824599385261536, mean p set: 0.44879910349845886
The modified gen p mean: 0.44925373792648315, gen p mean: -0.24075213074684143, mean p set: 0.4498290419578552
loss_pred:0.017557624727487564, decouple_loss:0.0038555776700377464
loss_pred:0.01709591969847679, decouple_loss:0.0037772860378026962
WV_1_PC_1_EH_0_PS_30, loss: 0.017613016068935394, avg_mse: 0.02585320733487606
current test mse: 0.025853
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472378194332123, gen p mean: -0.24412888288497925, mean p set: 0.4478125274181366
loss_pred:0.015511393547058105, decouple_loss:0.0030209494289010763
The modified gen p mean: 0.447208434343338, gen p mean: -0.24429772794246674, mean p set: 0.4477818012237549
loss_pred:0.01582890748977661, decouple_loss:0.003124397015199065
The modified gen p mean: 0.4479403495788574, gen p mean: -0.240707129240036, mean p set: 0.4484681785106659
loss_pred:0.01627563126385212, decouple_loss:0.0033185023348778486
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759953022003174, gen p mean: -0.2457360327243805, mean p set: 0.44812464714050293
loss_pred:0.016118444502353668, decouple_loss:0.0030399609822779894
The modified gen p mean: 0.4475155174732208, gen p mean: -0.24312002956867218, mean p set: 0.44809025526046753The modified gen p mean: 0.44828492403030396, gen p mean: -0.24828168749809265, mean p set: 0.4488631784915924
loss_pred:0.015853816643357277, decouple_loss:0.002797752618789673
loss_pred:0.015749473124742508, decouple_loss:0.003214319469407201
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476385712623596, gen p mean: -0.2423737794160843, mean p set: 0.4481656849384308
loss_pred:0.01611669920384884, decouple_loss:0.003224580781534314
The modified gen p mean: 0.4477003812789917, gen p mean: -0.23865218460559845, mean p set: 0.4482816159725189
loss_pred:0.01627020165324211, decouple_loss:0.0032049554865807295
The modified gen p mean: 0.44831085205078125, gen p mean: -0.24322251975536346, mean p set: 0.44888749718666077
loss_pred:0.01553409080952406, decouple_loss:0.0031029086094349623
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725844264030457, gen p mean: -0.23818029463291168, mean p set: 0.44779056310653687
loss_pred:0.015453043393790722, decouple_loss:0.002924267202615738
The modified gen p mean: 0.44848236441612244, gen p mean: -0.23739556968212128, mean p set: 0.4490656852722168
loss_pred:0.01566164381802082, decouple_loss:0.002682645106688142
The modified gen p mean: 0.4477001428604126, gen p mean: -0.2390981912612915, mean p set: 0.44827502965927124
loss_pred:0.01593830995261669, decouple_loss:0.0027313593309372663
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837719202041626, gen p mean: -0.23457542061805725, mean p set: 0.448952317237854
loss_pred:0.015503992326557636, decouple_loss:0.0033739106729626656
The modified gen p mean: 0.4466804563999176, gen p mean: -0.23813284933567047, mean p set: 0.44725507497787476
loss_pred:0.015753628686070442, decouple_loss:0.003217906691133976
The modified gen p mean: 0.44622230529785156, gen p mean: -0.24204319715499878, mean p set: 0.4467509686946869
loss_pred:0.016270935535430908, decouple_loss:0.003922720905393362
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446666419506073, gen p mean: -0.23865656554698944, mean p set: 0.44724181294441223
The modified gen p mean: 0.4471261203289032, gen p mean: -0.23806600272655487, mean p set: 0.4477040469646454
loss_pred:0.015501047484576702, decouple_loss:0.002695122268050909
loss_pred:0.01584422029554844, decouple_loss:0.002515600761398673
The modified gen p mean: 0.44585272669792175, gen p mean: -0.24073709547519684, mean p set: 0.44638389348983765
loss_pred:0.014996467158198357, decouple_loss:0.0026759174652397633
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715583324432373, gen p mean: -0.23942720890045166, mean p set: 0.447729229927063
loss_pred:0.015837540850043297, decouple_loss:0.0034885418135672808
The modified gen p mean: 0.4476143717765808, gen p mean: -0.23701591789722443, mean p set: 0.4481956660747528
loss_pred:0.015898386016488075, decouple_loss:0.003678474575281143
The modified gen p mean: 0.4471296966075897, gen p mean: -0.23406687378883362, mean p set: 0.44765913486480713
loss_pred:0.01599254459142685, decouple_loss:0.0033069367054849863
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740036129951477, gen p mean: -0.2375427484512329, mean p set: 0.44797828793525696
loss_pred:0.016263963654637337, decouple_loss:0.002693993505090475
The modified gen p mean: 0.44604983925819397, gen p mean: -0.2392902970314026, mean p set: 0.44661951065063477
loss_pred:0.016128364950418472, decouple_loss:0.0029090014286339283
The modified gen p mean: 0.448154479265213, gen p mean: -0.24332566559314728, mean p set: 0.4486749470233917
loss_pred:0.016076968982815742, decouple_loss:0.0026930803433060646
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799959659576416, gen p mean: -0.24095359444618225, mean p set: 0.4485739767551422
loss_pred:0.015527944080531597, decouple_loss:0.00282923667691648
The modified gen p mean: 0.44625189900398254, gen p mean: -0.2442580759525299, mean p set: 0.4468306601047516
loss_pred:0.014802234247326851, decouple_loss:0.0030402278061956167
The modified gen p mean: 0.44801804423332214, gen p mean: -0.24566181004047394, mean p set: 0.4485515058040619
loss_pred:0.016435377299785614, decouple_loss:0.003055321518331766
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744768738746643, gen p mean: -0.24527591466903687, mean p set: 0.44802215695381165
loss_pred:0.015506395138800144, decouple_loss:0.00278360559605062
The modified gen p mean: 0.4472748041152954, gen p mean: -0.24503664672374725, mean p set: 0.44784313440322876
loss_pred:0.016332466155290604, decouple_loss:0.0030161968898028135
The modified gen p mean: 0.44811591506004333, gen p mean: -0.24606655538082123, mean p set: 0.4486413896083832
loss_pred:0.015391586348414421, decouple_loss:0.002631406532600522
2023-04-27 00:14:45 testing...
The modified gen p mean: 0.44821983575820923, gen p mean: -0.24012447893619537, mean p set: 0.44879910349845886
loss_pred:0.01730259694159031, decouple_loss:0.0027014079969376326
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24258434772491455, mean p set: 0.4499112665653229
loss_pred:0.017548952251672745, decouple_loss:0.0029619901906698942
The modified gen p mean: 0.4492531418800354, gen p mean: -0.24282924830913544, mean p set: 0.4498290419578552
loss_pred:0.017046984285116196, decouple_loss:0.002830162178725004
WV_1_PC_1_EH_0_PS_30, loss: 0.017441071569919586, avg_mse: 0.025696663185954094
current test mse: 0.025697
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772157073020935, gen p mean: -0.24429476261138916, mean p set: 0.44826194643974304
loss_pred:0.016374951228499413, decouple_loss:0.0027013951912522316
The modified gen p mean: 0.4486962556838989, gen p mean: -0.2380756288766861, mean p set: 0.4492754638195038
loss_pred:0.01621365360915661, decouple_loss:0.0026462343521416187
The modified gen p mean: 0.44707271456718445, gen p mean: -0.24107810854911804, mean p set: 0.447646826505661
loss_pred:0.01625523343682289, decouple_loss:0.003093125531449914
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755813479423523, gen p mean: -0.24404312670230865, mean p set: 0.44808489084243774
loss_pred:0.016174105927348137, decouple_loss:0.002651252318173647
The modified gen p mean: 0.44743672013282776, gen p mean: -0.24639303982257843, mean p set: 0.44801008701324463
loss_pred:0.016176404431462288, decouple_loss:0.0027401703409850597
The modified gen p mean: 0.4471818208694458, gen p mean: -0.24489983916282654, mean p set: 0.44775891304016113
loss_pred:0.016493448987603188, decouple_loss:0.0030140290036797523
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482627511024475, gen p mean: -0.2329944223165512, mean p set: 0.4487912356853485
loss_pred:0.01618117094039917, decouple_loss:0.0031432679388672113
The modified gen p mean: 0.4461386501789093, gen p mean: -0.24179381132125854, mean p set: 0.44671642780303955
loss_pred:0.01632724702358246, decouple_loss:0.0034298051614314318
The modified gen p mean: 0.44772014021873474, gen p mean: -0.2363651543855667, mean p set: 0.4482978880405426
loss_pred:0.016265111044049263, decouple_loss:0.003359188325703144
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493410289287567, gen p mean: -0.23237279057502747, mean p set: 0.449869304895401
loss_pred:0.016170667484402657, decouple_loss:0.0028978316113352776
The modified gen p mean: 0.4472999572753906, gen p mean: -0.23934465646743774, mean p set: 0.4478735327720642
loss_pred:0.01635720767080784, decouple_loss:0.002671376336365938
The modified gen p mean: 0.4485204219818115, gen p mean: -0.23222605884075165, mean p set: 0.44909462332725525
loss_pred:0.016037555411458015, decouple_loss:0.0029696431010961533
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460534453392029, gen p mean: -0.23946233093738556, mean p set: 0.4466274678707123
loss_pred:0.016301186755299568, decouple_loss:0.0030052342917770147
The modified gen p mean: 0.44847431778907776, gen p mean: -0.23594626784324646, mean p set: 0.44900041818618774The modified gen p mean: 0.44829803705215454, gen p mean: -0.23644796013832092, mean p set: 0.44887441396713257
loss_pred:0.015437026508152485, decouple_loss:0.0029835281893610954
loss_pred:0.016013121232390404, decouple_loss:0.002837985288351774
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699108600616455, gen p mean: -0.23874825239181519, mean p set: 0.447562575340271
loss_pred:0.01639815978705883, decouple_loss:0.0029061282984912395
The modified gen p mean: 0.4484121799468994, gen p mean: -0.23777246475219727, mean p set: 0.4489942789077759The modified gen p mean: 0.4473777115345001, gen p mean: -0.23601511120796204, mean p set: 0.4479130506515503
loss_pred:0.015773534774780273, decouple_loss:0.0027716178447008133
loss_pred:0.015798339620232582, decouple_loss:0.0029349932447075844
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476964771747589, gen p mean: -0.2381194829940796, mean p set: 0.44827497005462646
loss_pred:0.015353147871792316, decouple_loss:0.00319267762824893
The modified gen p mean: 0.44731754064559937, gen p mean: -0.23765027523040771, mean p set: 0.44789430499076843
loss_pred:0.015919150784611702, decouple_loss:0.003200656734406948
The modified gen p mean: 0.4479687213897705, gen p mean: -0.24407002329826355, mean p set: 0.4484986364841461
loss_pred:0.01595480926334858, decouple_loss:0.0031857809517532587
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471006691455841, gen p mean: -0.24810367822647095, mean p set: 0.44767752289772034
loss_pred:0.01586715690791607, decouple_loss:0.0029377643950283527
The modified gen p mean: 0.44793999195098877, gen p mean: -0.24134401977062225, mean p set: 0.4485120475292206
loss_pred:0.01675093173980713, decouple_loss:0.002701972844079137
The modified gen p mean: 0.4486513137817383, gen p mean: -0.246773362159729, mean p set: 0.449184387922287
loss_pred:0.01563587225973606, decouple_loss:0.0030303392559289932
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688674807548523, gen p mean: -0.24636618793010712, mean p set: 0.44745954871177673
loss_pred:0.01614670641720295, decouple_loss:0.0029221901204437017
The modified gen p mean: 0.4481146037578583, gen p mean: -0.24601629376411438, mean p set: 0.44869065284729004
loss_pred:0.015738580375909805, decouple_loss:0.00274693313986063
The modified gen p mean: 0.44724223017692566, gen p mean: -0.24056458473205566, mean p set: 0.4477689266204834
loss_pred:0.016117997467517853, decouple_loss:0.003065610770136118
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484536051750183, gen p mean: -0.23703396320343018, mean p set: 0.44902777671813965
loss_pred:0.015785595402121544, decouple_loss:0.0026940698735415936
The modified gen p mean: 0.4471813440322876, gen p mean: -0.24010199308395386, mean p set: 0.44775715470314026
loss_pred:0.015965674072504044, decouple_loss:0.0028664246201515198
The modified gen p mean: 0.44768208265304565, gen p mean: -0.23851454257965088, mean p set: 0.44821611046791077
loss_pred:0.01647173799574375, decouple_loss:0.0029352521523833275
2023-04-27 00:19:00 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23931150138378143, mean p set: 0.4499112665653229
loss_pred:0.017489492893218994, decouple_loss:0.003022777149453759
The modified gen p mean: 0.4482208490371704, gen p mean: -0.23662114143371582, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492577612400055, gen p mean: -0.23927398025989532, mean p set: 0.4498290419578552
loss_pred:0.01736908033490181, decouple_loss:0.0028447406366467476
loss_pred:0.01698504574596882, decouple_loss:0.0029698770958930254
WV_1_PC_1_EH_0_PS_30, loss: 0.01742849498987198, avg_mse: 0.025673504918813705
current test mse: 0.025674
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475161135196686, gen p mean: -0.2449546456336975, mean p set: 0.4480946362018585
loss_pred:0.01601000875234604, decouple_loss:0.002615718636661768
The modified gen p mean: 0.4459834694862366, gen p mean: -0.24179242551326752, mean p set: 0.44656795263290405
loss_pred:0.016188330948352814, decouple_loss:0.0032863810192793608
The modified gen p mean: 0.44745227694511414, gen p mean: -0.24013689160346985, mean p set: 0.4479758143424988
loss_pred:0.015335431322455406, decouple_loss:0.0027856521774083376
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798168540000916, gen p mean: -0.24107015132904053, mean p set: 0.44851356744766235
loss_pred:0.01623082160949707, decouple_loss:0.0027538081631064415
The modified gen p mean: 0.4467891454696655, gen p mean: -0.24137753248214722, mean p set: 0.44736772775650024
loss_pred:0.01584291085600853, decouple_loss:0.0028835847042500973
The modified gen p mean: 0.4460617005825043, gen p mean: -0.24615249037742615, mean p set: 0.4466353952884674
loss_pred:0.015772853046655655, decouple_loss:0.002558673033490777
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656941294670105, gen p mean: -0.24937699735164642, mean p set: 0.44709834456443787
loss_pred:0.015865711495280266, decouple_loss:0.002643357729539275
The modified gen p mean: 0.446698933839798, gen p mean: -0.2489948570728302, mean p set: 0.44727712869644165
loss_pred:0.01548056211322546, decouple_loss:0.0026631394866853952
The modified gen p mean: 0.44899964332580566, gen p mean: -0.24871210753917694, mean p set: 0.44957879185676575
loss_pred:0.015496478416025639, decouple_loss:0.0027984101325273514
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492645561695099, gen p mean: -0.24650037288665771, mean p set: 0.449787974357605
loss_pred:0.015659941360354424, decouple_loss:0.002637243829667568
The modified gen p mean: 0.44673386216163635, gen p mean: -0.2441367208957672, mean p set: 0.4473150670528412
loss_pred:0.016426607966423035, decouple_loss:0.0028523628134280443
The modified gen p mean: 0.44539105892181396, gen p mean: -0.24973030388355255, mean p set: 0.445966511964798
loss_pred:0.016120241954922676, decouple_loss:0.0024853639770299196
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757962226867676, gen p mean: -0.2499925047159195, mean p set: 0.4481530487537384
loss_pred:0.015673242509365082, decouple_loss:0.002563874702900648
The modified gen p mean: 0.44823336601257324, gen p mean: -0.251311719417572, mean p set: 0.4488007128238678The modified gen p mean: 0.4455377161502838, gen p mean: -0.25363120436668396, mean p set: 0.44606801867485046
loss_pred:0.015631867572665215, decouple_loss:0.002915723016485572
loss_pred:0.01618577539920807, decouple_loss:0.0027956010308116674
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726476073265076, gen p mean: -0.252678245306015, mean p set: 0.44784191250801086
loss_pred:0.01584978774189949, decouple_loss:0.002845039591193199
The modified gen p mean: 0.4482617676258087, gen p mean: -0.25491252541542053, mean p set: 0.4488462209701538
loss_pred:0.015860794112086296, decouple_loss:0.00259696994908154
The modified gen p mean: 0.4478023648262024, gen p mean: -0.24929021298885345, mean p set: 0.44832706451416016
loss_pred:0.01607518456876278, decouple_loss:0.0026978279929608107
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477415084838867, gen p mean: -0.24429523944854736, mean p set: 0.4483223557472229
loss_pred:0.015501335263252258, decouple_loss:0.0027114213444292545
The modified gen p mean: 0.4467184841632843, gen p mean: -0.249980628490448, mean p set: 0.4472885727882385
loss_pred:0.0169080663472414, decouple_loss:0.003215201897546649
The modified gen p mean: 0.44687792658805847, gen p mean: -0.2546115219593048, mean p set: 0.44740915298461914
loss_pred:0.016267193481326103, decouple_loss:0.002849920652806759
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474393427371979, gen p mean: -0.24209104478359222, mean p set: 0.44801437854766846
loss_pred:0.01573328673839569, decouple_loss:0.0026137041859328747
The modified gen p mean: 0.44703248143196106, gen p mean: -0.2492743283510208, mean p set: 0.4476076066493988
loss_pred:0.01569596491754055, decouple_loss:0.002576289465650916
The modified gen p mean: 0.44692909717559814, gen p mean: -0.24840985238552094, mean p set: 0.4474617540836334
loss_pred:0.01633112132549286, decouple_loss:0.002493833424523473
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446328729391098, gen p mean: -0.2534237504005432, mean p set: 0.4469049572944641
loss_pred:0.0161050446331501, decouple_loss:0.002745748031884432
The modified gen p mean: 0.449734628200531, gen p mean: -0.24983301758766174, mean p set: 0.45031026005744934
loss_pred:0.015977289527654648, decouple_loss:0.0028286015149205923
The modified gen p mean: 0.447277307510376, gen p mean: -0.24827438592910767, mean p set: 0.44780421257019043
loss_pred:0.015421455726027489, decouple_loss:0.0025506759993731976
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704669713974, gen p mean: -0.26132524013519287, mean p set: 0.44761988520622253
loss_pred:0.016028178855776787, decouple_loss:0.0028040525503456593
The modified gen p mean: 0.4460603594779968, gen p mean: -0.25776392221450806, mean p set: 0.4466356933116913
loss_pred:0.015910238027572632, decouple_loss:0.0026407032273709774
The modified gen p mean: 0.4475563168525696, gen p mean: -0.2553626596927643, mean p set: 0.448087215423584
loss_pred:0.015749378129839897, decouple_loss:0.002690789522603154
2023-04-27 00:22:26 testing...
The modified gen p mean: 0.44822120666503906, gen p mean: -0.25162190198898315, mean p set: 0.44879910349845886
loss_pred:0.01753351464867592, decouple_loss:0.0031057544983923435
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2541603147983551, mean p set: 0.4499112665653229
loss_pred:0.017540890723466873, decouple_loss:0.002851472469046712
The modified gen p mean: 0.4492533206939697, gen p mean: -0.25426262617111206, mean p set: 0.4498290419578552
loss_pred:0.01705506257712841, decouple_loss:0.0028632276225835085
WV_1_PC_1_EH_0_PS_30, loss: 0.017523497343063354, avg_mse: 0.025826558470726013
current test mse: 0.025827
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824469089508057, gen p mean: -0.2548815906047821, mean p set: 0.44877755641937256
loss_pred:0.016178149729967117, decouple_loss:0.003099269000813365
The modified gen p mean: 0.44750091433525085, gen p mean: -0.25758275389671326, mean p set: 0.44806867837905884
loss_pred:0.01594698429107666, decouple_loss:0.0028069601394236088
The modified gen p mean: 0.4484657049179077, gen p mean: -0.253788560628891, mean p set: 0.44904205203056335
loss_pred:0.01566225104033947, decouple_loss:0.0029260721057653427
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470852017402649, gen p mean: -0.2573312520980835, mean p set: 0.44761648774147034
loss_pred:0.015544399619102478, decouple_loss:0.0031838456634432077
The modified gen p mean: 0.4474489092826843, gen p mean: -0.25300097465515137, mean p set: 0.4480248689651489
loss_pred:0.015548869036138058, decouple_loss:0.0029686656780540943
The modified gen p mean: 0.44727906584739685, gen p mean: -0.2520310580730438, mean p set: 0.44785353541374207
loss_pred:0.01581854373216629, decouple_loss:0.0031764069572091103
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707828760147095, gen p mean: -0.2539721131324768, mean p set: 0.4476131498813629
loss_pred:0.015163622796535492, decouple_loss:0.0031951998826116323
The modified gen p mean: 0.4468746781349182, gen p mean: -0.252618670463562, mean p set: 0.44745007157325745
loss_pred:0.015294763259589672, decouple_loss:0.003377836663275957
The modified gen p mean: 0.4476527273654938, gen p mean: -0.2524458169937134, mean p set: 0.4482308626174927
loss_pred:0.015977727249264717, decouple_loss:0.0031503939535468817
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476906955242157, gen p mean: -0.25519847869873047, mean p set: 0.4482249617576599
loss_pred:0.015645332634449005, decouple_loss:0.003107980825006962
The modified gen p mean: 0.44743260741233826, gen p mean: -0.25321921706199646, mean p set: 0.4480080008506775
loss_pred:0.01612352393567562, decouple_loss:0.002895577810704708
The modified gen p mean: 0.4472397267818451, gen p mean: -0.250044584274292, mean p set: 0.4478210508823395
loss_pred:0.01619192399084568, decouple_loss:0.0030928554479032755
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750404357910156, gen p mean: -0.24844439327716827, mean p set: 0.4480917155742645
loss_pred:0.01612274907529354, decouple_loss:0.002798098139464855
The modified gen p mean: 0.44760680198669434, gen p mean: -0.24983128905296326, mean p set: 0.4481387734413147The modified gen p mean: 0.44778862595558167, gen p mean: -0.24185815453529358, mean p set: 0.4483618438243866
loss_pred:0.015797991305589676, decouple_loss:0.003465864807367325
loss_pred:0.015433029271662235, decouple_loss:0.0029216527473181486
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726669788360596, gen p mean: -0.24828140437602997, mean p set: 0.4478406012058258
loss_pred:0.01603739522397518, decouple_loss:0.002910611918196082
The modified gen p mean: 0.4468556344509125, gen p mean: -0.2507084608078003, mean p set: 0.44742754101753235The modified gen p mean: 0.44664961099624634, gen p mean: -0.24539153277873993, mean p set: 0.4471800923347473
loss_pred:0.015364575199782848, decouple_loss:0.003069372149184346
loss_pred:0.01619202084839344, decouple_loss:0.002993738977238536
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714343547821045, gen p mean: -0.2470342218875885, mean p set: 0.44771865010261536
loss_pred:0.015076389536261559, decouple_loss:0.0029532858170568943
The modified gen p mean: 0.4478834271430969, gen p mean: -0.24841634929180145, mean p set: 0.44846081733703613
loss_pred:0.015455324202775955, decouple_loss:0.0030374687630683184
The modified gen p mean: 0.4473925530910492, gen p mean: -0.24819986522197723, mean p set: 0.4479289650917053
loss_pred:0.0161761362105608, decouple_loss:0.003346954705193639
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476226568222046, gen p mean: -0.24552208185195923, mean p set: 0.44819164276123047
loss_pred:0.015241293236613274, decouple_loss:0.0028293426148593426
The modified gen p mean: 0.4473235011100769, gen p mean: -0.2446971833705902, mean p set: 0.4479069411754608
loss_pred:0.016062883660197258, decouple_loss:0.0028177695348858833
The modified gen p mean: 0.4460720121860504, gen p mean: -0.24119865894317627, mean p set: 0.44660380482673645
loss_pred:0.01622050628066063, decouple_loss:0.0030526656191796064
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471334218978882, gen p mean: -0.24622687697410583, mean p set: 0.44770246744155884
loss_pred:0.015607553534209728, decouple_loss:0.003055829554796219
The modified gen p mean: 0.44806352257728577, gen p mean: -0.24098393321037292, mean p set: 0.4486466944217682
loss_pred:0.015716243535280228, decouple_loss:0.0028654292691498995
The modified gen p mean: 0.4477509558200836, gen p mean: -0.24854281544685364, mean p set: 0.44828295707702637
loss_pred:0.015976570546627045, decouple_loss:0.0028834566473960876
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479805529117584, gen p mean: -0.247075617313385, mean p set: 0.44855615496635437
loss_pred:0.01549540925770998, decouple_loss:0.002876823768019676
The modified gen p mean: 0.4477404057979584, gen p mean: -0.24684564769268036, mean p set: 0.44831904768943787
loss_pred:0.016162121668457985, decouple_loss:0.0031074623111635447
The modified gen p mean: 0.44720861315727234, gen p mean: -0.24699650704860687, mean p set: 0.4477413594722748
loss_pred:0.015676766633987427, decouple_loss:0.0028787939809262753
2023-04-27 00:26:48 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2486659437417984, mean p set: 0.4499112665653229
loss_pred:0.017665069550275803, decouple_loss:0.0031505317892879248
The modified gen p mean: 0.4482174813747406, gen p mean: -0.24610334634780884, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492565393447876, gen p mean: -0.24884258210659027, mean p set: 0.4498290419578552
loss_pred:0.01748715527355671, decouple_loss:0.0029666749760508537
loss_pred:0.017074115574359894, decouple_loss:0.0029986733570694923
WV_1_PC_1_EH_0_PS_30, loss: 0.01756071113049984, avg_mse: 0.025895774364471436
current test mse: 0.025896
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729307293891907, gen p mean: -0.2521202564239502, mean p set: 0.4478645324707031
loss_pred:0.01525409147143364, decouple_loss:0.0029721225146204233
The modified gen p mean: 0.4487515687942505, gen p mean: -0.24858999252319336, mean p set: 0.4493274986743927
loss_pred:0.015569502487778664, decouple_loss:0.002988759195432067
The modified gen p mean: 0.4476924240589142, gen p mean: -0.24770066142082214, mean p set: 0.44821682572364807
loss_pred:0.01590121164917946, decouple_loss:0.0028535095043480396
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679316878318787, gen p mean: -0.24273639917373657, mean p set: 0.44731831550598145
loss_pred:0.015969417989253998, decouple_loss:0.003079422516748309
The modified gen p mean: 0.44816893339157104, gen p mean: -0.2489061951637268, mean p set: 0.4487457573413849
loss_pred:0.015786992385983467, decouple_loss:0.0027249762788414955
The modified gen p mean: 0.44777727127075195, gen p mean: -0.2479364424943924, mean p set: 0.4483511745929718
loss_pred:0.015453432686626911, decouple_loss:0.002817137399688363
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770345091819763, gen p mean: -0.24971666932106018, mean p set: 0.44823944568634033
loss_pred:0.015841417014598846, decouple_loss:0.002830319572240114
The modified gen p mean: 0.44744205474853516, gen p mean: -0.24949979782104492, mean p set: 0.44802039861679077
loss_pred:0.015214039012789726, decouple_loss:0.0027408471796661615
The modified gen p mean: 0.44821858406066895, gen p mean: -0.2505236268043518, mean p set: 0.44879069924354553
loss_pred:0.014993120916187763, decouple_loss:0.0028984067030251026
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676560163497925, gen p mean: -0.2505640387535095, mean p set: 0.4472944438457489
loss_pred:0.01551434863358736, decouple_loss:0.0028928935062140226
The modified gen p mean: 0.4488220810890198, gen p mean: -0.24493569135665894, mean p set: 0.4493890404701233
loss_pred:0.015552286058664322, decouple_loss:0.0028685396537184715
The modified gen p mean: 0.448238343000412, gen p mean: -0.2468864619731903, mean p set: 0.4488186836242676
loss_pred:0.01570705696940422, decouple_loss:0.003030299674719572
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482777714729309, gen p mean: -0.24643130600452423, mean p set: 0.4488621652126312
loss_pred:0.016131872311234474, decouple_loss:0.002744866069406271
The modified gen p mean: 0.4481920301914215, gen p mean: -0.24852058291435242, mean p set: 0.4487678110599518The modified gen p mean: 0.44612860679626465, gen p mean: -0.24525587260723114, mean p set: 0.44665300846099854
loss_pred:0.01525286864489317, decouple_loss:0.002956945216283202
loss_pred:0.01564176008105278, decouple_loss:0.002717038383707404
Iteration: 936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716936349868774, gen p mean: -0.24449171125888824, mean p set: 0.4477475583553314
loss_pred:0.014988351613283157, decouple_loss:0.002841561334207654
The modified gen p mean: 0.44817763566970825, gen p mean: -0.24513040482997894, mean p set: 0.44870179891586304The modified gen p mean: 0.44696909189224243, gen p mean: -0.24805161356925964, mean p set: 0.44754406809806824
loss_pred:0.01537276804447174, decouple_loss:0.003047840902581811
loss_pred:0.015871137380599976, decouple_loss:0.0029181106947362423
Iteration: 937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648411870002747, gen p mean: -0.2466057986021042, mean p set: 0.44706112146377563
loss_pred:0.015766924247145653, decouple_loss:0.0029722684994339943
The modified gen p mean: 0.44867801666259766, gen p mean: -0.24149291217327118, mean p set: 0.4492107927799225The modified gen p mean: 0.44757160544395447, gen p mean: -0.24736212193965912, mean p set: 0.44814959168434143
loss_pred:0.015108805149793625, decouple_loss:0.002880398416891694
loss_pred:0.015759406611323357, decouple_loss:0.0029622195288538933
Iteration: 938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891422986984253, gen p mean: -0.2464921772480011, mean p set: 0.4494889974594116
loss_pred:0.014892668463289738, decouple_loss:0.002852982608601451
The modified gen p mean: 0.4470245838165283, gen p mean: -0.24356761574745178, mean p set: 0.44760891795158386
loss_pred:0.015968741849064827, decouple_loss:0.0027956352569162846
The modified gen p mean: 0.4477560818195343, gen p mean: -0.2484380155801773, mean p set: 0.4482864737510681
loss_pred:0.015543105080723763, decouple_loss:0.002816484309732914
Iteration: 939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474739134311676, gen p mean: -0.24766986072063446, mean p set: 0.4480433166027069
loss_pred:0.014737224206328392, decouple_loss:0.0030067472252994776
The modified gen p mean: 0.44766518473625183, gen p mean: -0.25097033381462097, mean p set: 0.4482399523258209
loss_pred:0.015803826972842216, decouple_loss:0.00281484704464674
The modified gen p mean: 0.44721871614456177, gen p mean: -0.24833907186985016, mean p set: 0.4477456510066986
loss_pred:0.01588601991534233, decouple_loss:0.0025755416136235
Iteration: 940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735658168792725, gen p mean: -0.24916259944438934, mean p set: 0.44792893528938293
loss_pred:0.01603034697473049, decouple_loss:0.0028018024750053883
The modified gen p mean: 0.44768190383911133, gen p mean: -0.2485470175743103, mean p set: 0.4482089579105377The modified gen p mean: 0.4472513794898987, gen p mean: -0.24935956299304962, mean p set: 0.4478244483470917
loss_pred:0.01551617868244648, decouple_loss:0.002923113526776433
loss_pred:0.015667108818888664, decouple_loss:0.002910320647060871
2023-04-27 00:30:13 testing...
The modified gen p mean: 0.4482182562351227, gen p mean: -0.24818864464759827, mean p set: 0.44879910349845886
loss_pred:0.017487114295363426, decouple_loss:0.003088831203058362
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25086358189582825, mean p set: 0.4499112665653229
loss_pred:0.017793385311961174, decouple_loss:0.0031662997789680958
The modified gen p mean: 0.4492505192756653, gen p mean: -0.25093874335289, mean p set: 0.4498290419578552
loss_pred:0.017214983701705933, decouple_loss:0.003005851758643985
WV_1_PC_1_EH_0_PS_30, loss: 0.0176528450101614, avg_mse: 0.026090187951922417
current test mse: 0.02609
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459146559238434, gen p mean: -0.25032761693000793, mean p set: 0.4464392364025116
loss_pred:0.01651267521083355, decouple_loss:0.002969734137877822
The modified gen p mean: 0.44600191712379456, gen p mean: -0.25324746966362, mean p set: 0.4465799629688263
loss_pred:0.01611381396651268, decouple_loss:0.0030192802660167217
The modified gen p mean: 0.4453742802143097, gen p mean: -0.24949724972248077, mean p set: 0.4459480941295624
loss_pred:0.01632707379758358, decouple_loss:0.002901147585362196
Iteration: 942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678062200546265, gen p mean: -0.25339221954345703, mean p set: 0.44731536507606506
loss_pred:0.016707556322216988, decouple_loss:0.002896757796406746
The modified gen p mean: 0.44650185108184814, gen p mean: -0.25571104884147644, mean p set: 0.44707778096199036
loss_pred:0.016345230862498283, decouple_loss:0.002894454635679722
The modified gen p mean: 0.4470517337322235, gen p mean: -0.2512519955635071, mean p set: 0.4476243555545807
loss_pred:0.016032608225941658, decouple_loss:0.002739862771704793
Iteration: 943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467533230781555, gen p mean: -0.2493482083082199, mean p set: 0.4472745358943939
loss_pred:0.01575828157365322, decouple_loss:0.003133833408355713
The modified gen p mean: 0.4469694197177887, gen p mean: -0.2476915568113327, mean p set: 0.44754984974861145
loss_pred:0.01620243862271309, decouple_loss:0.0030093605164438486
The modified gen p mean: 0.445737361907959, gen p mean: -0.2491758167743683, mean p set: 0.44631072878837585
loss_pred:0.015861013904213905, decouple_loss:0.0032021133229136467
Iteration: 944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645965099334717, gen p mean: -0.24588243663311005, mean p set: 0.446982741355896
loss_pred:0.01646249368786812, decouple_loss:0.002697354182600975
The modified gen p mean: 0.4462021589279175, gen p mean: -0.244808629155159, mean p set: 0.44678211212158203
loss_pred:0.01614377833902836, decouple_loss:0.002833378268405795
The modified gen p mean: 0.44590136408805847, gen p mean: -0.2424485981464386, mean p set: 0.44647544622421265
loss_pred:0.016892919316887856, decouple_loss:0.003005080856382847
Iteration: 945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463233947753906, gen p mean: -0.24150463938713074, mean p set: 0.4468989372253418
loss_pred:0.0161286648362875, decouple_loss:0.0029502396937459707
The modified gen p mean: 0.4455931782722473, gen p mean: -0.24592770636081696, mean p set: 0.446174293756485
loss_pred:0.01612687297165394, decouple_loss:0.0031407021451741457
The modified gen p mean: 0.44587334990501404, gen p mean: -0.24204182624816895, mean p set: 0.44640541076660156
loss_pred:0.016192762181162834, decouple_loss:0.0027732555754482746
Iteration: 946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453849196434021, gen p mean: -0.24325376749038696, mean p set: 0.44595643877983093
loss_pred:0.016332415863871574, decouple_loss:0.002913010073825717
The modified gen p mean: 0.4467225670814514, gen p mean: -0.2422877550125122, mean p set: 0.44729533791542053
loss_pred:0.01585257798433304, decouple_loss:0.0029214441310614347
The modified gen p mean: 0.4466147720813751, gen p mean: -0.24332195520401, mean p set: 0.44714006781578064
loss_pred:0.016480104997754097, decouple_loss:0.003024196019396186
Iteration: 947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642674922943115, gen p mean: -0.24002572894096375, mean p set: 0.447003036737442
loss_pred:0.016217023134231567, decouple_loss:0.0026630829088389874
The modified gen p mean: 0.44708478450775146, gen p mean: -0.2441084086894989, mean p set: 0.44765836000442505
loss_pred:0.015925699844956398, decouple_loss:0.002934297313913703
The modified gen p mean: 0.44711577892303467, gen p mean: -0.24501819908618927, mean p set: 0.4476405084133148
loss_pred:0.01619848608970642, decouple_loss:0.0026828076224774122
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446463406085968, gen p mean: -0.24744825065135956, mean p set: 0.4470359981060028
loss_pred:0.015836715698242188, decouple_loss:0.0030008950270712376
The modified gen p mean: 0.4457002878189087, gen p mean: -0.24022428691387177, mean p set: 0.446274995803833
loss_pred:0.016417866572737694, decouple_loss:0.0029977569356560707
The modified gen p mean: 0.4469166398048401, gen p mean: -0.2426956743001938, mean p set: 0.44744303822517395
loss_pred:0.01638585515320301, decouple_loss:0.003155412618070841
Iteration: 949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464390277862549, gen p mean: -0.24903272092342377, mean p set: 0.4470106363296509
loss_pred:0.016217326745390892, decouple_loss:0.002865568734705448
The modified gen p mean: 0.4466145932674408, gen p mean: -0.2532499432563782, mean p set: 0.44719311594963074
loss_pred:0.015948038548231125, decouple_loss:0.0028411864768713713
The modified gen p mean: 0.4448690116405487, gen p mean: -0.24725808203220367, mean p set: 0.4453986883163452
loss_pred:0.01679324172437191, decouple_loss:0.0031344806775450706
Iteration: 950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450817406177521, gen p mean: -0.24749313294887543, mean p set: 0.4456527829170227
loss_pred:0.01588497869670391, decouple_loss:0.002668416127562523
The modified gen p mean: 0.44608813524246216, gen p mean: -0.24719156324863434, mean p set: 0.44666188955307007
loss_pred:0.016496876254677773, decouple_loss:0.002947145141661167
The modified gen p mean: 0.44791117310523987, gen p mean: -0.24805882573127747, mean p set: 0.4484444558620453
loss_pred:0.016821639612317085, decouple_loss:0.0033909373451024294
2023-04-27 00:34:49 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.244400754570961, mean p set: 0.4499112665653229
loss_pred:0.017545949667692184, decouple_loss:0.003003690391778946
The modified gen p mean: 0.44823023676872253, gen p mean: -0.24170321226119995, mean p set: 0.44879910349845886
loss_pred:0.017308397218585014, decouple_loss:0.0029491467867046595
The modified gen p mean: 0.4492458999156952, gen p mean: -0.24409249424934387, mean p set: 0.4498290419578552
loss_pred:0.01698920503258705, decouple_loss:0.0029584779404103756
WV_1_PC_1_EH_0_PS_30, loss: 0.017429707571864128, avg_mse: 0.025717150419950485
current test mse: 0.025717
Iteration: 951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462675452232361, gen p mean: -0.24753466248512268, mean p set: 0.4468485414981842
loss_pred:0.01614704169332981, decouple_loss:0.0031414655968546867
The modified gen p mean: 0.4455614686012268, gen p mean: -0.2440277636051178, mean p set: 0.44613370299339294
loss_pred:0.01584334671497345, decouple_loss:0.003046013880521059
The modified gen p mean: 0.44696682691574097, gen p mean: -0.2501427233219147, mean p set: 0.44749611616134644
loss_pred:0.01591506414115429, decouple_loss:0.002886646892875433
Iteration: 952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470162093639374, gen p mean: -0.24145998060703278, mean p set: 0.4475449025630951
loss_pred:0.016875499859452248, decouple_loss:0.0030278239864856005
The modified gen p mean: 0.44576817750930786, gen p mean: -0.24205712974071503, mean p set: 0.4463409185409546
loss_pred:0.01580374501645565, decouple_loss:0.0032941263634711504
The modified gen p mean: 0.446664422750473, gen p mean: -0.24156554043293, mean p set: 0.44723621010780334
loss_pred:0.01610325463116169, decouple_loss:0.0028193164616823196
Iteration: 953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733452796936035, gen p mean: -0.24429462850093842, mean p set: 0.4478660225868225
loss_pred:0.016896093264222145, decouple_loss:0.002995725255459547
The modified gen p mean: 0.44581475853919983, gen p mean: -0.245655819773674, mean p set: 0.44639402627944946
loss_pred:0.016029877588152885, decouple_loss:0.0029047029092907906
The modified gen p mean: 0.44752585887908936, gen p mean: -0.24843500554561615, mean p set: 0.4481041729450226
loss_pred:0.01675575040280819, decouple_loss:0.0029355227015912533
Iteration: 954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466058015823364, gen p mean: -0.2500879466533661, mean p set: 0.44713932275772095
loss_pred:0.015975212678313255, decouple_loss:0.002719901269301772
The modified gen p mean: 0.4463422894477844, gen p mean: -0.2492540180683136, mean p set: 0.4469238221645355
loss_pred:0.016533441841602325, decouple_loss:0.003010485554113984
The modified gen p mean: 0.44695669412612915, gen p mean: -0.24585148692131042, mean p set: 0.4475346803665161
loss_pred:0.016776323318481445, decouple_loss:0.002907518995925784
Iteration: 955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716042280197144, gen p mean: -0.2507760524749756, mean p set: 0.44773659110069275
loss_pred:0.015888387337327003, decouple_loss:0.00314951129257679
The modified gen p mean: 0.4465145468711853, gen p mean: -0.2503432631492615, mean p set: 0.4470418095588684The modified gen p mean: 0.4454875886440277, gen p mean: -0.2488546222448349, mean p set: 0.44606199860572815
loss_pred:0.015854405239224434, decouple_loss:0.0029782173223793507loss_pred:0.016027694568037987, decouple_loss:0.002971205161884427
Iteration: 956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695156812667847, gen p mean: -0.2505542039871216, mean p set: 0.44752374291419983
loss_pred:0.016557319089770317, decouple_loss:0.0031789024360477924
The modified gen p mean: 0.44710320234298706, gen p mean: -0.24665874242782593, mean p set: 0.44763532280921936The modified gen p mean: 0.446384072303772, gen p mean: -0.25281888246536255, mean p set: 0.44695594906806946
loss_pred:0.015446344390511513, decouple_loss:0.0028827867936342955
loss_pred:0.016650862991809845, decouple_loss:0.003223860403522849
Iteration: 957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470535218715668, gen p mean: -0.24971066415309906, mean p set: 0.4476345181465149
loss_pred:0.016146376729011536, decouple_loss:0.002609264338389039
The modified gen p mean: 0.4475560784339905, gen p mean: -0.24772706627845764, mean p set: 0.44812965393066406The modified gen p mean: 0.4462818205356598, gen p mean: -0.2486783266067505, mean p set: 0.4468083381652832
loss_pred:0.01638837717473507, decouple_loss:0.0028159578796476126
loss_pred:0.01612938940525055, decouple_loss:0.0028061512857675552
Iteration: 958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44547685980796814, gen p mean: -0.2517043352127075, mean p set: 0.44604605436325073
loss_pred:0.01585683971643448, decouple_loss:0.004086805507540703
The modified gen p mean: 0.44695746898651123, gen p mean: -0.2506938576698303, mean p set: 0.4475320279598236
loss_pred:0.01560457143932581, decouple_loss:0.003481784835457802
The modified gen p mean: 0.4464195668697357, gen p mean: -0.2468535602092743, mean p set: 0.44695156812667847
loss_pred:0.016061166301369667, decouple_loss:0.0031563343945890665
Iteration: 959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44608214497566223, gen p mean: -0.24134975671768188, mean p set: 0.4466569721698761
loss_pred:0.016206961125135422, decouple_loss:0.0026653639506548643
The modified gen p mean: 0.4440934658050537, gen p mean: -0.2406199425458908, mean p set: 0.44466984272003174
loss_pred:0.01641690544784069, decouple_loss:0.002956239739432931
The modified gen p mean: 0.44655126333236694, gen p mean: -0.2456713318824768, mean p set: 0.4470827281475067
loss_pred:0.015893153846263885, decouple_loss:0.0027670811396092176
Iteration: 960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471387565135956, gen p mean: -0.2471906542778015, mean p set: 0.44770827889442444
loss_pred:0.016444232314825058, decouple_loss:0.003971634432673454
The modified gen p mean: 0.445590078830719, gen p mean: -0.2413671910762787, mean p set: 0.44611749053001404The modified gen p mean: 0.4457945227622986, gen p mean: -0.24686144292354584, mean p set: 0.4463599622249603
loss_pred:0.01618068665266037, decouple_loss:0.0037868579383939505
loss_pred:0.0158736240118742, decouple_loss:0.0039120689034461975
2023-04-27 00:38:15 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24578166007995605, mean p set: 0.4499112665653229
loss_pred:0.017514441162347794, decouple_loss:0.003745068795979023
The modified gen p mean: 0.4482225775718689, gen p mean: -0.24312655627727509, mean p set: 0.44879910349845886The modified gen p mean: 0.4492487609386444, gen p mean: -0.24560022354125977, mean p set: 0.4498290419578552
loss_pred:0.017373383045196533, decouple_loss:0.003509087022393942
loss_pred:0.017000246793031693, decouple_loss:0.0035522354301065207
WV_1_PC_1_EH_0_PS_30, loss: 0.01747613027691841, avg_mse: 0.0257567148655653
current test mse: 0.025757
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479742646217346, gen p mean: -0.24967101216316223, mean p set: 0.44850850105285645
loss_pred:0.015410756692290306, decouple_loss:0.0033984684851020575
The modified gen p mean: 0.4484310746192932, gen p mean: -0.23945194482803345, mean p set: 0.44901344180107117
loss_pred:0.016235146671533585, decouple_loss:0.003584383288398385
The modified gen p mean: 0.4490661323070526, gen p mean: -0.23785555362701416, mean p set: 0.44964277744293213
loss_pred:0.016339780762791634, decouple_loss:0.003562426194548607
Iteration: 962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45101192593574524, gen p mean: -0.2372818887233734, mean p set: 0.4515393376350403
loss_pred:0.01608593948185444, decouple_loss:0.004049752373248339
The modified gen p mean: 0.4489149749279022, gen p mean: -0.24184709787368774, mean p set: 0.4494885504245758
The modified gen p mean: 0.4481346309185028, gen p mean: -0.2489795982837677, mean p set: 0.44871246814727783
loss_pred:0.017033863812685013, decouple_loss:0.0038253250531852245
loss_pred:0.01649242267012596, decouple_loss:0.003554943948984146
Iteration: 963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488596022129059, gen p mean: -0.2383636236190796, mean p set: 0.4493807256221771
loss_pred:0.015734536573290825, decouple_loss:0.0038136017974466085
The modified gen p mean: 0.4494597315788269, gen p mean: -0.24100074172019958, mean p set: 0.45003435015678406
The modified gen p mean: 0.44920992851257324, gen p mean: -0.24197717010974884, mean p set: 0.4497894048690796
loss_pred:0.0155868548899889, decouple_loss:0.0038427659310400486
loss_pred:0.01562713086605072, decouple_loss:0.0038071610033512115
Iteration: 964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493996500968933, gen p mean: -0.24102963507175446, mean p set: 0.4499303698539734
loss_pred:0.016604600474238396, decouple_loss:0.0035025556571781635
The modified gen p mean: 0.44996142387390137, gen p mean: -0.23561228811740875, mean p set: 0.45054665207862854The modified gen p mean: 0.4488411843776703, gen p mean: -0.23753343522548676, mean p set: 0.44941237568855286
loss_pred:0.015829378738999367, decouple_loss:0.0033700084313750267
loss_pred:0.016298703849315643, decouple_loss:0.0036332765594124794
Iteration: 965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059290528297424, gen p mean: -0.23187343776226044, mean p set: 0.451172411441803
loss_pred:0.015838950872421265, decouple_loss:0.0044175502844154835
The modified gen p mean: 0.44843998551368713, gen p mean: -0.2422465980052948, mean p set: 0.4490082263946533
loss_pred:0.015536888502538204, decouple_loss:0.004529488272964954
The modified gen p mean: 0.4492458999156952, gen p mean: -0.23710528016090393, mean p set: 0.44977647066116333
loss_pred:0.015658918768167496, decouple_loss:0.0039023119024932384
Iteration: 966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852301478385925, gen p mean: -0.2284422069787979, mean p set: 0.44910016655921936
loss_pred:0.01639607548713684, decouple_loss:0.003376529784873128
The modified gen p mean: 0.4487709403038025, gen p mean: -0.23653677105903625, mean p set: 0.44933852553367615
loss_pred:0.01585465855896473, decouple_loss:0.0032304669730365276
The modified gen p mean: 0.4478997588157654, gen p mean: -0.2367171347141266, mean p set: 0.44842392206192017
loss_pred:0.01571473479270935, decouple_loss:0.0034828190691769123
Iteration: 967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487066864967346, gen p mean: -0.23072002828121185, mean p set: 0.44927287101745605
loss_pred:0.016202421858906746, decouple_loss:0.0039328765124082565
The modified gen p mean: 0.44787150621414185, gen p mean: -0.227345809340477, mean p set: 0.4484051764011383The modified gen p mean: 0.44890186190605164, gen p mean: -0.23575928807258606, mean p set: 0.4494836926460266
loss_pred:0.015702392905950546, decouple_loss:0.0036130622029304504
loss_pred:0.0158027745783329, decouple_loss:0.004341043531894684
Iteration: 968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491235315799713, gen p mean: -0.23554816842079163, mean p set: 0.4496983587741852
loss_pred:0.016085565090179443, decouple_loss:0.0030176318250596523
The modified gen p mean: 0.44891753792762756, gen p mean: -0.23041005432605743, mean p set: 0.4494929015636444
loss_pred:0.015916496515274048, decouple_loss:0.002934474730864167
The modified gen p mean: 0.4477618336677551, gen p mean: -0.24031080305576324, mean p set: 0.44829061627388
loss_pred:0.015856148675084114, decouple_loss:0.0029678689315915108
Iteration: 969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483954906463623, gen p mean: -0.23616820573806763, mean p set: 0.44897210597991943
loss_pred:0.016148244962096214, decouple_loss:0.0030864907894283533
The modified gen p mean: 0.44775915145874023, gen p mean: -0.24533817172050476, mean p set: 0.44832560420036316
loss_pred:0.01562587171792984, decouple_loss:0.0036328015848994255
The modified gen p mean: 0.4480500817298889, gen p mean: -0.24041737616062164, mean p set: 0.4485754370689392
loss_pred:0.016456151381134987, decouple_loss:0.003504763124510646
Iteration: 970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491803050041199, gen p mean: -0.24023175239562988, mean p set: 0.4497624933719635
loss_pred:0.015800705179572105, decouple_loss:0.0033307631965726614
The modified gen p mean: 0.4484201967716217, gen p mean: -0.24053621292114258, mean p set: 0.44899484515190125The modified gen p mean: 0.4485761523246765, gen p mean: -0.24099603295326233, mean p set: 0.44910159707069397
loss_pred:0.016761697828769684, decouple_loss:0.0031964192166924477
loss_pred:0.015775054693222046, decouple_loss:0.0031875118147581816
2023-04-27 00:42:35 testing...
The modified gen p mean: 0.4482206106185913, gen p mean: -0.24305464327335358, mean p set: 0.44879910349845886
loss_pred:0.01744357869029045, decouple_loss:0.0028910019900649786
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24574129283428192, mean p set: 0.4499112665653229
loss_pred:0.01760689727962017, decouple_loss:0.0030524455942213535
The modified gen p mean: 0.4492509067058563, gen p mean: -0.24572233855724335, mean p set: 0.4498290419578552
loss_pred:0.017226437106728554, decouple_loss:0.0029823575168848038
WV_1_PC_1_EH_0_PS_30, loss: 0.017574403434991837, avg_mse: 0.025936506688594818
current test mse: 0.025937
Iteration: 971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817811250686646, gen p mean: -0.2488735467195511, mean p set: 0.4487546384334564
loss_pred:0.01608751155436039, decouple_loss:0.0029219130519777536
The modified gen p mean: 0.4500167667865753, gen p mean: -0.2480209618806839, mean p set: 0.45059165358543396
loss_pred:0.016104046255350113, decouple_loss:0.0026586740277707577
The modified gen p mean: 0.44905340671539307, gen p mean: -0.24506665766239166, mean p set: 0.4495806396007538
loss_pred:0.01520058698952198, decouple_loss:0.0027969307266175747
Iteration: 972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829419255256653, gen p mean: -0.2433072328567505, mean p set: 0.4488248825073242
loss_pred:0.016067391261458397, decouple_loss:0.003017722861841321
The modified gen p mean: 0.4483034610748291, gen p mean: -0.24131882190704346, mean p set: 0.4488753378391266
loss_pred:0.016143804416060448, decouple_loss:0.003224011277779937
The modified gen p mean: 0.44935089349746704, gen p mean: -0.24542519450187683, mean p set: 0.4499305486679077
loss_pred:0.015452121384441853, decouple_loss:0.003050149418413639
Iteration: 973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951340556144714, gen p mean: -0.24204030632972717, mean p set: 0.45004376769065857
loss_pred:0.014836297370493412, decouple_loss:0.0027191771660000086
The modified gen p mean: 0.4486630856990814, gen p mean: -0.24711637198925018, mean p set: 0.449236124753952The modified gen p mean: 0.44778120517730713, gen p mean: -0.2488432675600052, mean p set: 0.4483579099178314
loss_pred:0.01582697406411171, decouple_loss:0.0025616674683988094loss_pred:0.014988106675446033, decouple_loss:0.0026731539983302355
Iteration: 974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781988859176636, gen p mean: -0.24745061993598938, mean p set: 0.44834738969802856
loss_pred:0.015486969612538815, decouple_loss:0.0027282610535621643
The modified gen p mean: 0.4487835764884949, gen p mean: -0.24729640781879425, mean p set: 0.4493550956249237
loss_pred:0.015698952600359917, decouple_loss:0.003283886704593897
The modified gen p mean: 0.44928184151649475, gen p mean: -0.24141761660575867, mean p set: 0.44986000657081604
loss_pred:0.015573741868138313, decouple_loss:0.003303138306364417
Iteration: 975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479145407676697, gen p mean: -0.24642245471477509, mean p set: 0.44848892092704773
loss_pred:0.016237428411841393, decouple_loss:0.003274621907621622
The modified gen p mean: 0.44859549403190613, gen p mean: -0.24087002873420715, mean p set: 0.4491713047027588
loss_pred:0.01612698845565319, decouple_loss:0.003451224882155657
The modified gen p mean: 0.4479218125343323, gen p mean: -0.25009071826934814, mean p set: 0.4484458863735199
loss_pred:0.015803705900907516, decouple_loss:0.0034779084380716085
Iteration: 976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497390687465668, gen p mean: -0.23749986290931702, mean p set: 0.450310081243515
loss_pred:0.016086705029010773, decouple_loss:0.0029640428256243467
The modified gen p mean: 0.44943979382514954, gen p mean: -0.2381094992160797, mean p set: 0.4500153958797455
loss_pred:0.015046192333102226, decouple_loss:0.0028482333291321993
The modified gen p mean: 0.4498796761035919, gen p mean: -0.24433155357837677, mean p set: 0.4504038989543915
loss_pred:0.015499214641749859, decouple_loss:0.0025784329045563936
Iteration: 977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893914461135864, gen p mean: -0.23372597992420197, mean p set: 0.4495154023170471
loss_pred:0.015310263261198997, decouple_loss:0.003281181678175926
The modified gen p mean: 0.4474685788154602, gen p mean: -0.2441655546426773, mean p set: 0.4480412006378174
loss_pred:0.015909718349575996, decouple_loss:0.00367564195767045
The modified gen p mean: 0.44902467727661133, gen p mean: -0.23919741809368134, mean p set: 0.4495515525341034
loss_pred:0.015736209228634834, decouple_loss:0.00302943866699934
Iteration: 978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493883550167084, gen p mean: -0.23354485630989075, mean p set: 0.44996556639671326
loss_pred:0.01549936830997467, decouple_loss:0.002907689893618226
The modified gen p mean: 0.44869863986968994, gen p mean: -0.23494350910186768, mean p set: 0.4492739737033844
loss_pred:0.01631893590092659, decouple_loss:0.0028753229416906834
The modified gen p mean: 0.4491897523403168, gen p mean: -0.23474758863449097, mean p set: 0.44971972703933716
loss_pred:0.015566552057862282, decouple_loss:0.002619227161630988
Iteration: 979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951751828193665, gen p mean: -0.2381715327501297, mean p set: 0.4500974118709564
The modified gen p mean: 0.44973286986351013, gen p mean: -0.23739856481552124, mean p set: 0.4503089487552643
loss_pred:0.015458219684660435, decouple_loss:0.0030528176575899124
loss_pred:0.015125776641070843, decouple_loss:0.00322731863707304
The modified gen p mean: 0.4499894976615906, gen p mean: -0.23502330482006073, mean p set: 0.450520396232605
loss_pred:0.015490910038352013, decouple_loss:0.0030444941949099302
Iteration: 980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481387138366699, gen p mean: -0.24061208963394165, mean p set: 0.4487136900424957
loss_pred:0.01637292467057705, decouple_loss:0.0032490422017872334
The modified gen p mean: 0.4484209418296814, gen p mean: -0.23432473838329315, mean p set: 0.4489958584308624
loss_pred:0.016027560457587242, decouple_loss:0.0029810748528689146
The modified gen p mean: 0.4493860900402069, gen p mean: -0.24386125802993774, mean p set: 0.44991445541381836
loss_pred:0.015893420204520226, decouple_loss:0.002835525432601571
2023-04-27 00:46:01 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24176320433616638, mean p set: 0.4499112665653229
loss_pred:0.017582248896360397, decouple_loss:0.0034648661967366934
The modified gen p mean: 0.44822272658348083, gen p mean: -0.23898302018642426, mean p set: 0.44879910349845886
loss_pred:0.01745748519897461, decouple_loss:0.0032559523824602365
The modified gen p mean: 0.44926002621650696, gen p mean: -0.24190090596675873, mean p set: 0.4498290419578552
loss_pred:0.0171342883259058, decouple_loss:0.00327221117913723
WV_1_PC_1_EH_0_PS_30, loss: 0.017557892948389053, avg_mse: 0.02590338885784149
current test mse: 0.025903
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649651646614075, gen p mean: -0.24549928307533264, mean p set: 0.4470282196998596
loss_pred:0.015356587246060371, decouple_loss:0.0028167651034891605
The modified gen p mean: 0.44683802127838135, gen p mean: -0.24395903944969177, mean p set: 0.4474206268787384
loss_pred:0.015763381496071815, decouple_loss:0.0030846809968352318
The modified gen p mean: 0.447952538728714, gen p mean: -0.24263568222522736, mean p set: 0.44852009415626526
loss_pred:0.015402083285152912, decouple_loss:0.0032358590979129076
Iteration: 982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478509724140167, gen p mean: -0.241627037525177, mean p set: 0.4483788311481476
loss_pred:0.01575436443090439, decouple_loss:0.0031535401940345764
The modified gen p mean: 0.44804641604423523, gen p mean: -0.24251994490623474, mean p set: 0.44862261414527893
loss_pred:0.01515293586999178, decouple_loss:0.0028299037367105484
The modified gen p mean: 0.4471047818660736, gen p mean: -0.24591611325740814, mean p set: 0.4476828873157501
loss_pred:0.015121767297387123, decouple_loss:0.002657100325450301
Iteration: 983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467335045337677, gen p mean: -0.24283842742443085, mean p set: 0.4472596049308777
loss_pred:0.015587640926241875, decouple_loss:0.002948804758489132
The modified gen p mean: 0.44772282242774963, gen p mean: -0.24470306932926178, mean p set: 0.4483005702495575
loss_pred:0.01626119203865528, decouple_loss:0.003114402526989579
The modified gen p mean: 0.4472087025642395, gen p mean: -0.24845416843891144, mean p set: 0.44778600335121155
loss_pred:0.015619796700775623, decouple_loss:0.0029162687715142965
Iteration: 984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766882061958313, gen p mean: -0.24261443316936493, mean p set: 0.4481982886791229
loss_pred:0.015279419720172882, decouple_loss:0.0027524761389940977
The modified gen p mean: 0.44669345021247864, gen p mean: -0.24481061100959778, mean p set: 0.44727250933647156
loss_pred:0.015560245141386986, decouple_loss:0.0025305929593741894
The modified gen p mean: 0.44733113050460815, gen p mean: -0.2413606494665146, mean p set: 0.4479072690010071
loss_pred:0.015609115362167358, decouple_loss:0.0026882588863372803
Iteration: 985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829487800598145, gen p mean: -0.24206146597862244, mean p set: 0.44886934757232666
loss_pred:0.015204677358269691, decouple_loss:0.0029070230666548014
The modified gen p mean: 0.4471988379955292, gen p mean: -0.24649150669574738, mean p set: 0.4477669298648834
loss_pred:0.015582941472530365, decouple_loss:0.0027130001690238714
The modified gen p mean: 0.4476511478424072, gen p mean: -0.2464861124753952, mean p set: 0.44817450642585754
loss_pred:0.015654386952519417, decouple_loss:0.00285814655944705
Iteration: 986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485458731651306, gen p mean: -0.2318277359008789, mean p set: 0.4491216838359833
loss_pred:0.015208945609629154, decouple_loss:0.002961430698633194
The modified gen p mean: 0.44807860255241394, gen p mean: -0.23587094247341156, mean p set: 0.4486541748046875
loss_pred:0.015799103304743767, decouple_loss:0.0032931070309132338
The modified gen p mean: 0.4477373957633972, gen p mean: -0.23415718972682953, mean p set: 0.4482652246952057
loss_pred:0.015409874729812145, decouple_loss:0.0028570692520588636
Iteration: 987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474570155143738, gen p mean: -0.23800522089004517, mean p set: 0.4480327069759369
loss_pred:0.014941360801458359, decouple_loss:0.002635524608194828
The modified gen p mean: 0.4459279179573059, gen p mean: -0.2423153519630432, mean p set: 0.44645851850509644The modified gen p mean: 0.44840511679649353, gen p mean: -0.24272270500659943, mean p set: 0.44897761940956116
loss_pred:0.015183386392891407, decouple_loss:0.002745461417362094
loss_pred:0.015144906006753445, decouple_loss:0.0026445656549185514
Iteration: 988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471879303455353, gen p mean: -0.2492407113313675, mean p set: 0.4477671980857849
loss_pred:0.015552607364952564, decouple_loss:0.0026634144596755505
The modified gen p mean: 0.44638922810554504, gen p mean: -0.24772582948207855, mean p set: 0.44695839285850525
loss_pred:0.015494275838136673, decouple_loss:0.002519165864214301
The modified gen p mean: 0.44765380024909973, gen p mean: -0.24375978112220764, mean p set: 0.4481825828552246
loss_pred:0.014990769326686859, decouple_loss:0.0025772834196686745
Iteration: 989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737449288368225, gen p mean: -0.24824507534503937, mean p set: 0.4479547441005707
loss_pred:0.014910207130014896, decouple_loss:0.002545375609770417
The modified gen p mean: 0.44694429636001587, gen p mean: -0.24625100195407867, mean p set: 0.4475173056125641
loss_pred:0.015505090355873108, decouple_loss:0.002769153332337737
The modified gen p mean: 0.4469732344150543, gen p mean: -0.2486681342124939, mean p set: 0.4475003480911255
loss_pred:0.015314686112105846, decouple_loss:0.002558463718742132
Iteration: 990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858041405677795, gen p mean: -0.24145115911960602, mean p set: 0.4491502642631531
loss_pred:0.015673331916332245, decouple_loss:0.0028726111631840467
The modified gen p mean: 0.4478086829185486, gen p mean: -0.24229735136032104, mean p set: 0.44838836789131165
loss_pred:0.01497924979776144, decouple_loss:0.0025618544314056635
The modified gen p mean: 0.4476781487464905, gen p mean: -0.2401808798313141, mean p set: 0.4482133686542511
loss_pred:0.01547025516629219, decouple_loss:0.0025663000997155905
2023-04-27 00:50:18 testing...
The modified gen p mean: 0.4482220411300659, gen p mean: -0.23612652719020844, mean p set: 0.44879910349845886
loss_pred:0.017536697909235954, decouple_loss:0.0030913257505744696
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23897603154182434, mean p set: 0.4499112665653229
loss_pred:0.017623363062739372, decouple_loss:0.0030252658762037754
The modified gen p mean: 0.4492496848106384, gen p mean: -0.23944616317749023, mean p set: 0.4498290419578552
loss_pred:0.0171462781727314, decouple_loss:0.0030074017122387886
WV_1_PC_1_EH_0_PS_30, loss: 0.017587512731552124, avg_mse: 0.025995934382081032
current test mse: 0.025996
Iteration: 991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471399188041687, gen p mean: -0.2393275648355484, mean p set: 0.4477144777774811
loss_pred:0.015164797194302082, decouple_loss:0.0028614471666514874
The modified gen p mean: 0.44756466150283813, gen p mean: -0.24234740436077118, mean p set: 0.44813501834869385
loss_pred:0.0157209113240242, decouple_loss:0.0029314844869077206
The modified gen p mean: 0.44796067476272583, gen p mean: -0.2341802418231964, mean p set: 0.4484962224960327
loss_pred:0.015431743115186691, decouple_loss:0.002922389656305313
Iteration: 992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488399922847748, gen p mean: -0.23913446068763733, mean p set: 0.44937047362327576
loss_pred:0.015729494392871857, decouple_loss:0.002750318730250001
The modified gen p mean: 0.4485543668270111, gen p mean: -0.23804576694965363, mean p set: 0.44913291931152344
loss_pred:0.015817860141396523, decouple_loss:0.002767321188002825
The modified gen p mean: 0.4477282464504242, gen p mean: -0.24357841908931732, mean p set: 0.4483039677143097
loss_pred:0.01501308474689722, decouple_loss:0.002412464702501893
Iteration: 993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463397264480591, gen p mean: -0.24504724144935608, mean p set: 0.4468632936477661
loss_pred:0.015367603860795498, decouple_loss:0.002976010087877512
The modified gen p mean: 0.4486718773841858, gen p mean: -0.2402617335319519, mean p set: 0.44924822449684143
loss_pred:0.015089595690369606, decouple_loss:0.0031136467587202787
The modified gen p mean: 0.4480224549770355, gen p mean: -0.23888731002807617, mean p set: 0.44860079884529114
loss_pred:0.015410502441227436, decouple_loss:0.0030160362366586924
Iteration: 994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806820154190063, gen p mean: -0.24416372179985046, mean p set: 0.44860121607780457
loss_pred:0.014770470559597015, decouple_loss:0.0024761571548879147
The modified gen p mean: 0.44722476601600647, gen p mean: -0.24577485024929047, mean p set: 0.44780340790748596
loss_pred:0.015507749281823635, decouple_loss:0.002540918765589595
The modified gen p mean: 0.4483518898487091, gen p mean: -0.24490953981876373, mean p set: 0.448940247297287
loss_pred:0.015402281656861305, decouple_loss:0.0028635915368795395
Iteration: 995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744402170181274, gen p mean: -0.24699458479881287, mean p set: 0.4479711353778839
loss_pred:0.015598948113620281, decouple_loss:0.0029515547212213278
The modified gen p mean: 0.4474215507507324, gen p mean: -0.24603556096553802, mean p set: 0.44800058007240295
loss_pred:0.014792205765843391, decouple_loss:0.0027514726389199495
The modified gen p mean: 0.4473414123058319, gen p mean: -0.24442118406295776, mean p set: 0.44791606068611145
loss_pred:0.016050556674599648, decouple_loss:0.0031215359922498465
Iteration: 996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455806016921997, gen p mean: -0.2497018575668335, mean p set: 0.4461096227169037
loss_pred:0.015283685177564621, decouple_loss:0.002520984038710594
The modified gen p mean: 0.4468684196472168, gen p mean: -0.2516254186630249, mean p set: 0.4474402070045471
loss_pred:0.015640782192349434, decouple_loss:0.002698943018913269
The modified gen p mean: 0.4476088583469391, gen p mean: -0.24770691990852356, mean p set: 0.4481835961341858
loss_pred:0.015530126169323921, decouple_loss:0.0025769558269530535
Iteration: 997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44618868827819824, gen p mean: -0.24959006905555725, mean p set: 0.44676437973976135
loss_pred:0.015260016545653343, decouple_loss:0.0026110797189176083
The modified gen p mean: 0.44785162806510925, gen p mean: -0.250980943441391, mean p set: 0.44837847352027893
The modified gen p mean: 0.4485931396484375, gen p mean: -0.2461763322353363, mean p set: 0.44917070865631104
loss_pred:0.01533826719969511, decouple_loss:0.002687059808522463
loss_pred:0.015489891171455383, decouple_loss:0.002694525523111224
Iteration: 998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473389685153961, gen p mean: -0.2520821690559387, mean p set: 0.4479212760925293
loss_pred:0.01520994771271944, decouple_loss:0.0025143949314951897
The modified gen p mean: 0.44681283831596375, gen p mean: -0.2537529468536377, mean p set: 0.4473881721496582
loss_pred:0.015414873138070107, decouple_loss:0.0026695162523537874
The modified gen p mean: 0.4476875066757202, gen p mean: -0.2491675764322281, mean p set: 0.44821637868881226
loss_pred:0.015720760449767113, decouple_loss:0.00266181118786335
Iteration: 999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675353169441223, gen p mean: -0.2513051927089691, mean p set: 0.4473342299461365
loss_pred:0.015497810207307339, decouple_loss:0.0026847668923437595
The modified gen p mean: 0.44756263494491577, gen p mean: -0.24513515830039978, mean p set: 0.4480895698070526
The modified gen p mean: 0.44732537865638733, gen p mean: -0.24840475618839264, mean p set: 0.44789940118789673
loss_pred:0.01580689661204815, decouple_loss:0.0028173839673399925
loss_pred:0.015086375176906586, decouple_loss:0.002700853394344449
Iteration: 1000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678282737731934, gen p mean: -0.24711425602436066, mean p set: 0.4473542869091034
loss_pred:0.015224319882690907, decouple_loss:0.0025293389335274696
The modified gen p mean: 0.44708576798439026, gen p mean: -0.2528008222579956, mean p set: 0.4476650059223175
loss_pred:0.01563132368028164, decouple_loss:0.002621264895424247
The modified gen p mean: 0.447579562664032, gen p mean: -0.249505415558815, mean p set: 0.4481063485145569
loss_pred:0.015853505581617355, decouple_loss:0.002811250975355506
2023-04-27 00:53:43 itr: 1000
training loss: [0.01599407 0.01535079 0.01576239]
2023-04-27 00:53:43 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2526192367076874, mean p set: 0.4499112665653229
loss_pred:0.017601868137717247, decouple_loss:0.0029406859539449215
The modified gen p mean: 0.44822219014167786, gen p mean: -0.24968384206295013, mean p set: 0.44879910349845886
loss_pred:0.017422068864107132, decouple_loss:0.0030105188488960266
The modified gen p mean: 0.44925686717033386, gen p mean: -0.2528814673423767, mean p set: 0.4498290419578552
loss_pred:0.017139650881290436, decouple_loss:0.0029405069071799517
WV_1_PC_1_EH_0_PS_30, loss: 0.017536059021949768, avg_mse: 0.025902001187205315
current test mse: 0.025902
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 1001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778263568878174, gen p mean: -0.25865691900253296, mean p set: 0.4483180344104767
loss_pred:0.016589267179369926, decouple_loss:0.0029559305403381586
The modified gen p mean: 0.4470342695713043, gen p mean: -0.25362473726272583, mean p set: 0.4476125240325928
loss_pred:0.016023317351937294, decouple_loss:0.002617092104628682
The modified gen p mean: 0.44872382283210754, gen p mean: -0.25205522775650024, mean p set: 0.44929543137550354
loss_pred:0.015742098912596703, decouple_loss:0.003312250366434455
Iteration: 1002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476741850376129, gen p mean: -0.256352037191391, mean p set: 0.44819900393486023
loss_pred:0.015697941184043884, decouple_loss:0.0028304054867476225
The modified gen p mean: 0.447664350271225, gen p mean: -0.25744420289993286, mean p set: 0.4482479691505432The modified gen p mean: 0.4467894732952118, gen p mean: -0.25391915440559387, mean p set: 0.447368323802948
loss_pred:0.016149815171957016, decouple_loss:0.0029830189887434244
loss_pred:0.01602821610867977, decouple_loss:0.0033283212687820196
Iteration: 1003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473525881767273, gen p mean: -0.25445684790611267, mean p set: 0.4478845000267029
loss_pred:0.015275715850293636, decouple_loss:0.0028375335969030857
The modified gen p mean: 0.4482954740524292, gen p mean: -0.25075772404670715, mean p set: 0.4488748610019684
loss_pred:0.016245035454630852, decouple_loss:0.003282805671915412
The modified gen p mean: 0.44715410470962524, gen p mean: -0.25267836451530457, mean p set: 0.4477330446243286
loss_pred:0.015682511031627655, decouple_loss:0.002833431586623192
Iteration: 1004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489997923374176, gen p mean: -0.25604262948036194, mean p set: 0.44952166080474854
loss_pred:0.015456177294254303, decouple_loss:0.002740963362157345
The modified gen p mean: 0.44631555676460266, gen p mean: -0.2551092207431793, mean p set: 0.4468948543071747
loss_pred:0.015295430086553097, decouple_loss:0.0028995077591389418
The modified gen p mean: 0.4478923976421356, gen p mean: -0.2514954209327698, mean p set: 0.448472261428833
loss_pred:0.015328599140048027, decouple_loss:0.0028924276120960712
Iteration: 1005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483427107334137, gen p mean: -0.24679148197174072, mean p set: 0.4489106833934784
loss_pred:0.015908341854810715, decouple_loss:0.002840030239894986
The modified gen p mean: 0.4477364122867584, gen p mean: -0.2514738440513611, mean p set: 0.4482649564743042The modified gen p mean: 0.4473307430744171, gen p mean: -0.25472086668014526, mean p set: 0.4479025602340698
loss_pred:0.01566912978887558, decouple_loss:0.00291193719021976loss_pred:0.015348067507147789, decouple_loss:0.0025352993980050087
Iteration: 1006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706860184669495, gen p mean: -0.2500731945037842, mean p set: 0.4476448595523834
loss_pred:0.015857713297009468, decouple_loss:0.0026567603927105665
The modified gen p mean: 0.44761666655540466, gen p mean: -0.24512523412704468, mean p set: 0.4481905400753021The modified gen p mean: 0.4468100965023041, gen p mean: -0.25175637006759644, mean p set: 0.4473358392715454
loss_pred:0.016206424683332443, decouple_loss:0.002709189197048545
loss_pred:0.01538382563740015, decouple_loss:0.0025340348947793245
Iteration: 1007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482307732105255, gen p mean: -0.24904696643352509, mean p set: 0.4488097131252289
loss_pred:0.015791963785886765, decouple_loss:0.0027185683138668537
The modified gen p mean: 0.4483135938644409, gen p mean: -0.24786339700222015, mean p set: 0.4488431215286255The modified gen p mean: 0.44998785853385925, gen p mean: -0.25010916590690613, mean p set: 0.4505683481693268
loss_pred:0.015152768231928349, decouple_loss:0.00271551962941885
loss_pred:0.015193452127277851, decouple_loss:0.0027116548735648394
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882529973983765, gen p mean: -0.2496379017829895, mean p set: 0.44939976930618286
loss_pred:0.015688611194491386, decouple_loss:0.003046936122700572
The modified gen p mean: 0.447790265083313, gen p mean: -0.2520148456096649, mean p set: 0.44832107424736023
loss_pred:0.01622609794139862, decouple_loss:0.0027245611418038607
The modified gen p mean: 0.44843095541000366, gen p mean: -0.24974846839904785, mean p set: 0.44900330901145935
loss_pred:0.01496897917240858, decouple_loss:0.002740420401096344
Iteration: 1009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480271637439728, gen p mean: -0.25232648849487305, mean p set: 0.44860541820526123
loss_pred:0.015853289514780045, decouple_loss:0.0027216861490160227
The modified gen p mean: 0.4484405219554901, gen p mean: -0.2572365403175354, mean p set: 0.4490198791027069
loss_pred:0.015835478901863098, decouple_loss:0.0026313820853829384
The modified gen p mean: 0.44753921031951904, gen p mean: -0.26006489992141724, mean p set: 0.4480707347393036
loss_pred:0.016479242593050003, decouple_loss:0.002750893123447895
Iteration: 1010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656115770339966, gen p mean: -0.2565183639526367, mean p set: 0.4471263289451599
loss_pred:0.014924021437764168, decouple_loss:0.0029091541655361652
The modified gen p mean: 0.4480190873146057, gen p mean: -0.2556869387626648, mean p set: 0.4485537111759186The modified gen p mean: 0.44579657912254333, gen p mean: -0.2531799077987671, mean p set: 0.44636374711990356
loss_pred:0.015349030494689941, decouple_loss:0.002773792017251253
loss_pred:0.0166952945291996, decouple_loss:0.0031024019699543715
2023-04-27 00:58:08 testing...
The modified gen p mean: 0.4482263922691345, gen p mean: -0.2517511546611786, mean p set: 0.44879910349845886
loss_pred:0.01730481907725334, decouple_loss:0.002685328247025609
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2546466290950775, mean p set: 0.4499112665653229
loss_pred:0.017497969791293144, decouple_loss:0.002649160800501704
The modified gen p mean: 0.4492546617984772, gen p mean: -0.25467756390571594, mean p set: 0.4498290419578552
loss_pred:0.017113396897912025, decouple_loss:0.002688903594389558
WV_1_PC_1_EH_0_PS_30, loss: 0.017439119517803192, avg_mse: 0.025748049840331078
current test mse: 0.025748
Iteration: 1011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480341970920563, gen p mean: -0.25594377517700195, mean p set: 0.4485693573951721
loss_pred:0.015074442140758038, decouple_loss:0.0028425545897334814
The modified gen p mean: 0.4468173086643219, gen p mean: -0.25645673274993896, mean p set: 0.4473958909511566
loss_pred:0.015607834793627262, decouple_loss:0.002563992515206337
The modified gen p mean: 0.44960886240005493, gen p mean: -0.25787296891212463, mean p set: 0.45018208026885986
loss_pred:0.014400096610188484, decouple_loss:0.0025860783644020557
Iteration: 1012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701719284057617, gen p mean: -0.25183990597724915, mean p set: 0.44755110144615173
loss_pred:0.01590918004512787, decouple_loss:0.0026561294216662645
The modified gen p mean: 0.4491530954837799, gen p mean: -0.2535841763019562, mean p set: 0.4497232735157013
The modified gen p mean: 0.4479367136955261, gen p mean: -0.25054511427879333, mean p set: 0.4485156238079071
loss_pred:0.015135045163333416, decouple_loss:0.002755766035988927
loss_pred:0.015009747818112373, decouple_loss:0.0028232543263584375
Iteration: 1013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481927752494812, gen p mean: -0.2515644133090973, mean p set: 0.4487214982509613
loss_pred:0.015882086008787155, decouple_loss:0.0027789503801614046
The modified gen p mean: 0.4481196105480194, gen p mean: -0.2472863793373108, mean p set: 0.44869574904441833
The modified gen p mean: 0.44607821106910706, gen p mean: -0.24800409376621246, mean p set: 0.44665804505348206
loss_pred:0.015715640038251877, decouple_loss:0.0029571657069027424
loss_pred:0.015334557741880417, decouple_loss:0.0029643226880580187
Iteration: 1014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478398561477661, gen p mean: -0.24545104801654816, mean p set: 0.44841471314430237
loss_pred:0.015839826315641403, decouple_loss:0.0026512029580771923
The modified gen p mean: 0.44610151648521423, gen p mean: -0.25031742453575134, mean p set: 0.4466237425804138The modified gen p mean: 0.4481508731842041, gen p mean: -0.2509031593799591, mean p set: 0.4487282633781433
loss_pred:0.01561957411468029, decouple_loss:0.002787391422316432loss_pred:0.015482330694794655, decouple_loss:0.0024898676201701164
Iteration: 1015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744929671287537, gen p mean: -0.248858243227005, mean p set: 0.4480155408382416
loss_pred:0.016984276473522186, decouple_loss:0.002791470615193248
The modified gen p mean: 0.44695428013801575, gen p mean: -0.25231248140335083, mean p set: 0.4474853575229645The modified gen p mean: 0.4490901827812195, gen p mean: -0.25332075357437134, mean p set: 0.449665904045105
loss_pred:0.015050452202558517, decouple_loss:0.002602594206109643
loss_pred:0.014736801385879517, decouple_loss:0.0027631705161184072
Iteration: 1016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812747836112976, gen p mean: -0.24591410160064697, mean p set: 0.4486992359161377
loss_pred:0.016066309064626694, decouple_loss:0.0028034697752445936
The modified gen p mean: 0.45006757974624634, gen p mean: -0.25091174244880676, mean p set: 0.4506426155567169
loss_pred:0.015167465433478355, decouple_loss:0.0029401457868516445
The modified gen p mean: 0.4467255771160126, gen p mean: -0.2469697892665863, mean p set: 0.44726231694221497
loss_pred:0.016474377363920212, decouple_loss:0.0026032854802906513
Iteration: 1017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479057192802429, gen p mean: -0.24980995059013367, mean p set: 0.4484834671020508
loss_pred:0.015418353490531445, decouple_loss:0.0031208812724798918
The modified gen p mean: 0.44814902544021606, gen p mean: -0.25232210755348206, mean p set: 0.44871997833251953
loss_pred:0.015056000091135502, decouple_loss:0.00300371996127069
The modified gen p mean: 0.446982204914093, gen p mean: -0.2555740475654602, mean p set: 0.44750893115997314
loss_pred:0.015223381109535694, decouple_loss:0.0030749530997127295
Iteration: 1018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478631615638733, gen p mean: -0.2537974715232849, mean p set: 0.44843170046806335
loss_pred:0.015112724155187607, decouple_loss:0.0027883967850357294
The modified gen p mean: 0.4467710852622986, gen p mean: -0.257407546043396, mean p set: 0.447309285402298The modified gen p mean: 0.4484710991382599, gen p mean: -0.25677409768104553, mean p set: 0.44904476404190063
loss_pred:0.015910198912024498, decouple_loss:0.002919168444350362
loss_pred:0.015094920992851257, decouple_loss:0.0028446330688893795
Iteration: 1019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493367671966553, gen p mean: -0.25434526801109314, mean p set: 0.4499242305755615
loss_pred:0.01528165303170681, decouple_loss:0.0035831877030432224
The modified gen p mean: 0.4465305805206299, gen p mean: -0.2504976987838745, mean p set: 0.447110116481781
loss_pred:0.016298368573188782, decouple_loss:0.0030048659536987543
The modified gen p mean: 0.4476274847984314, gen p mean: -0.2508005201816559, mean p set: 0.4481564164161682
loss_pred:0.015399226918816566, decouple_loss:0.0031761457212269306
Iteration: 1020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945499300956726, gen p mean: -0.25461453199386597, mean p set: 0.4500364065170288
loss_pred:0.015172739513218403, decouple_loss:0.003323776414617896
The modified gen p mean: 0.4474788010120392, gen p mean: -0.25747618079185486, mean p set: 0.4480571746826172
loss_pred:0.015729635953903198, decouple_loss:0.0029386624228209257
The modified gen p mean: 0.44701123237609863, gen p mean: -0.2572331130504608, mean p set: 0.4475356340408325
loss_pred:0.015170915052294731, decouple_loss:0.0029059378430247307
2023-04-27 01:01:37 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25558891892433167, mean p set: 0.4499112665653229
loss_pred:0.017502164468169212, decouple_loss:0.002994605340063572
The modified gen p mean: 0.44821417331695557, gen p mean: -0.25258752703666687, mean p set: 0.44879910349845886
The modified gen p mean: 0.449258029460907, gen p mean: -0.2554040253162384, mean p set: 0.4498290419578552
loss_pred:0.01731450855731964, decouple_loss:0.0031592261511832476
loss_pred:0.017041396349668503, decouple_loss:0.0029631147626787424
WV_1_PC_1_EH_0_PS_30, loss: 0.017437972128391266, avg_mse: 0.02573138289153576
current test mse: 0.025731
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 1021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446962833404541, gen p mean: -0.25694870948791504, mean p set: 0.4474954903125763
loss_pred:0.016004495322704315, decouple_loss:0.0028370320796966553
The modified gen p mean: 0.4471365809440613, gen p mean: -0.2541816234588623, mean p set: 0.44771286845207214
loss_pred:0.015610416419804096, decouple_loss:0.0030383276753127575
The modified gen p mean: 0.4471156895160675, gen p mean: -0.2581988275051117, mean p set: 0.44769522547721863
loss_pred:0.015852268785238266, decouple_loss:0.0029622430447489023
Iteration: 1022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44545045495033264, gen p mean: -0.2628846764564514, mean p set: 0.44598105549812317
loss_pred:0.015646349638700485, decouple_loss:0.0034134802408516407
The modified gen p mean: 0.44645148515701294, gen p mean: -0.25700321793556213, mean p set: 0.4470267593860626
loss_pred:0.015870433300733566, decouple_loss:0.0029632567893713713
The modified gen p mean: 0.4477330446243286, gen p mean: -0.2544732987880707, mean p set: 0.44831427931785583
loss_pred:0.01589343696832657, decouple_loss:0.0031307730823755264
Iteration: 1023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474756717681885, gen p mean: -0.25160476565361023, mean p set: 0.448009192943573
loss_pred:0.016167892143130302, decouple_loss:0.002757363487035036
The modified gen p mean: 0.44660326838493347, gen p mean: -0.25817668437957764, mean p set: 0.44717955589294434
loss_pred:0.01553329173475504, decouple_loss:0.002974280621856451
The modified gen p mean: 0.4471002519130707, gen p mean: -0.2584373652935028, mean p set: 0.4476804733276367
loss_pred:0.016460727900266647, decouple_loss:0.003040920477360487
Iteration: 1024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465523362159729, gen p mean: -0.2625981271266937, mean p set: 0.44708412885665894
loss_pred:0.016008732840418816, decouple_loss:0.0031203075777739286
The modified gen p mean: 0.447014719247818, gen p mean: -0.2603049576282501, mean p set: 0.44758957624435425
loss_pred:0.016222059726715088, decouple_loss:0.003126279916614294
The modified gen p mean: 0.44619911909103394, gen p mean: -0.2602734863758087, mean p set: 0.4467789828777313
loss_pred:0.01594030298292637, decouple_loss:0.0032925449777394533
Iteration: 1025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704189896583557, gen p mean: -0.2565918564796448, mean p set: 0.4476129114627838
loss_pred:0.016523895785212517, decouple_loss:0.002857206156477332
The modified gen p mean: 0.44750887155532837, gen p mean: -0.2591521143913269, mean p set: 0.44808200001716614The modified gen p mean: 0.44583067297935486, gen p mean: -0.25571879744529724, mean p set: 0.44635844230651855
loss_pred:0.014705518260598183, decouple_loss:0.002902379259467125
loss_pred:0.01585351675748825, decouple_loss:0.002975378418341279
Iteration: 1026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468720555305481, gen p mean: -0.24653920531272888, mean p set: 0.44744551181793213
loss_pred:0.015790756791830063, decouple_loss:0.0027180705219507217
The modified gen p mean: 0.4476695954799652, gen p mean: -0.25448405742645264, mean p set: 0.4481981694698334The modified gen p mean: 0.4467175304889679, gen p mean: -0.24825206398963928, mean p set: 0.44729292392730713
loss_pred:0.016141898930072784, decouple_loss:0.0028247381560504436
loss_pred:0.016380947083234787, decouple_loss:0.0032894823234528303
Iteration: 1027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457569122314453, gen p mean: -0.24905051290988922, mean p set: 0.4463306665420532
loss_pred:0.015962813049554825, decouple_loss:0.0027722984086722136
The modified gen p mean: 0.44496455788612366, gen p mean: -0.25566548109054565, mean p set: 0.44549062848091125The modified gen p mean: 0.44688403606414795, gen p mean: -0.249346062541008, mean p set: 0.4474574029445648
loss_pred:0.01573910191655159, decouple_loss:0.0027594075072556734
loss_pred:0.015706129372119904, decouple_loss:0.002885200548917055
Iteration: 1028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446181058883667, gen p mean: -0.24902933835983276, mean p set: 0.446748286485672
loss_pred:0.01612711511552334, decouple_loss:0.0026707439683377743
The modified gen p mean: 0.44786471128463745, gen p mean: -0.25028565526008606, mean p set: 0.44844114780426025
loss_pred:0.015763159841299057, decouple_loss:0.0025662845000624657
The modified gen p mean: 0.4466305673122406, gen p mean: -0.2482137531042099, mean p set: 0.44716206192970276
loss_pred:0.016201529651880264, decouple_loss:0.002711869776248932
Iteration: 1029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477654695510864, gen p mean: -0.24863681197166443, mean p set: 0.4483422338962555
loss_pred:0.015480369329452515, decouple_loss:0.0027892226353287697
The modified gen p mean: 0.4466477334499359, gen p mean: -0.2423052340745926, mean p set: 0.44721704721450806
loss_pred:0.01531925518065691, decouple_loss:0.0025467167142778635
The modified gen p mean: 0.4483495056629181, gen p mean: -0.24660281836986542, mean p set: 0.448881059885025
loss_pred:0.015577917918562889, decouple_loss:0.002581388922408223
Iteration: 1030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44601020216941833, gen p mean: -0.24879717826843262, mean p set: 0.4465861916542053
loss_pred:0.015549170784652233, decouple_loss:0.002570293378084898
The modified gen p mean: 0.44722655415534973, gen p mean: -0.2394910454750061, mean p set: 0.4477542042732239The modified gen p mean: 0.4480380713939667, gen p mean: -0.24362239241600037, mean p set: 0.44861549139022827
loss_pred:0.015719717368483543, decouple_loss:0.002419104101136327
loss_pred:0.016102688387036324, decouple_loss:0.002372963586822152
2023-04-27 01:05:49 testing...
The modified gen p mean: 0.4482153654098511, gen p mean: -0.2458287477493286, mean p set: 0.44879910349845886
loss_pred:0.017350735142827034, decouple_loss:0.002743509830906987
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24883754551410675, mean p set: 0.4499112665653229
loss_pred:0.01745755784213543, decouple_loss:0.0027232058346271515
The modified gen p mean: 0.44925183057785034, gen p mean: -0.24878224730491638, mean p set: 0.4498290419578552
loss_pred:0.017054665833711624, decouple_loss:0.0026863128878176212
WV_1_PC_1_EH_0_PS_30, loss: 0.017423538491129875, avg_mse: 0.02572094462811947
current test mse: 0.025721
Iteration: 1031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768092036247253, gen p mean: -0.24833562970161438, mean p set: 0.448209285736084
loss_pred:0.015437078662216663, decouple_loss:0.0027498339768499136
The modified gen p mean: 0.4473579227924347, gen p mean: -0.24914997816085815, mean p set: 0.44793781638145447
loss_pred:0.01634291000664234, decouple_loss:0.0029520245734602213
The modified gen p mean: 0.4480101764202118, gen p mean: -0.2519737184047699, mean p set: 0.44858217239379883
loss_pred:0.015509651042521, decouple_loss:0.002513995161280036
Iteration: 1032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44493189454078674, gen p mean: -0.25404036045074463, mean p set: 0.4454576373100281
loss_pred:0.015895800665020943, decouple_loss:0.00269321515224874
The modified gen p mean: 0.4478088617324829, gen p mean: -0.25203463435173035, mean p set: 0.44838783144950867
loss_pred:0.015568727627396584, decouple_loss:0.002531003439798951
The modified gen p mean: 0.44570398330688477, gen p mean: -0.24885118007659912, mean p set: 0.4462839961051941
loss_pred:0.015461800619959831, decouple_loss:0.002534103114157915
Iteration: 1033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455309510231018, gen p mean: -0.24711643159389496, mean p set: 0.4460590183734894
loss_pred:0.0158206969499588, decouple_loss:0.002651108196005225
The modified gen p mean: 0.4463956356048584, gen p mean: -0.2504681348800659, mean p set: 0.44696754217147827
loss_pred:0.014775174669921398, decouple_loss:0.002656723605468869
The modified gen p mean: 0.44745051860809326, gen p mean: -0.2520611882209778, mean p set: 0.44802701473236084
loss_pred:0.014312631450593472, decouple_loss:0.002640071092173457
Iteration: 1034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464172124862671, gen p mean: -0.24466826021671295, mean p set: 0.44694095849990845
loss_pred:0.01638796180486679, decouple_loss:0.002502103103324771
The modified gen p mean: 0.44776564836502075, gen p mean: -0.24479283392429352, mean p set: 0.44834378361701965
loss_pred:0.01521257497370243, decouple_loss:0.0027407051529735327
The modified gen p mean: 0.4462296664714813, gen p mean: -0.2464759200811386, mean p set: 0.44680383801460266
loss_pred:0.015581012703478336, decouple_loss:0.002733181696385145
Iteration: 1035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717922806739807, gen p mean: -0.25003889203071594, mean p set: 0.44775307178497314
loss_pred:0.014650045894086361, decouple_loss:0.002713441150262952
The modified gen p mean: 0.4463590979576111, gen p mean: -0.2521716356277466, mean p set: 0.44692835211753845
The modified gen p mean: 0.44658163189888, gen p mean: -0.24675969779491425, mean p set: 0.44710773229599
loss_pred:0.015751538798213005, decouple_loss:0.002601431682705879
loss_pred:0.015826627612113953, decouple_loss:0.002519899746403098
Iteration: 1036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471154510974884, gen p mean: -0.24964086711406708, mean p set: 0.4477007985115051
loss_pred:0.015619471669197083, decouple_loss:0.00268761720508337
The modified gen p mean: 0.44658368825912476, gen p mean: -0.24879223108291626, mean p set: 0.44716131687164307
The modified gen p mean: 0.4474084973335266, gen p mean: -0.24980029463768005, mean p set: 0.4479331374168396
loss_pred:0.015991566702723503, decouple_loss:0.0025331557262688875
loss_pred:0.015660440549254417, decouple_loss:0.002787899924442172
Iteration: 1037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849953055381775, gen p mean: -0.25264662504196167, mean p set: 0.44907715916633606
loss_pred:0.015330960974097252, decouple_loss:0.0026629362255334854
The modified gen p mean: 0.44683897495269775, gen p mean: -0.24905581772327423, mean p set: 0.44741740822792053The modified gen p mean: 0.44686761498451233, gen p mean: -0.24959918856620789, mean p set: 0.44739776849746704
loss_pred:0.01636354625225067, decouple_loss:0.0027062436565756798
loss_pred:0.015528510324656963, decouple_loss:0.002719745971262455
Iteration: 1038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731447100639343, gen p mean: -0.25257715582847595, mean p set: 0.4478902518749237
loss_pred:0.016106097027659416, decouple_loss:0.002704044571146369
The modified gen p mean: 0.44635775685310364, gen p mean: -0.25196126103401184, mean p set: 0.4469318985939026
loss_pred:0.01601063460111618, decouple_loss:0.002600587671622634
The modified gen p mean: 0.4478261470794678, gen p mean: -0.2539214491844177, mean p set: 0.4483581483364105
loss_pred:0.014832677319645882, decouple_loss:0.0025931433774530888
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44845151901245117, gen p mean: -0.25284844636917114, mean p set: 0.4490286707878113
loss_pred:0.016224954277276993, decouple_loss:0.002754337852820754
The modified gen p mean: 0.448935329914093, gen p mean: -0.2570222318172455, mean p set: 0.4495137631893158
loss_pred:0.015611598268151283, decouple_loss:0.002859807340428233
The modified gen p mean: 0.44656309485435486, gen p mean: -0.26026108860969543, mean p set: 0.4470905363559723
loss_pred:0.015506746247410774, decouple_loss:0.002886464586481452
Iteration: 1040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481911063194275, gen p mean: -0.25438162684440613, mean p set: 0.44876447319984436
loss_pred:0.015109690837562084, decouple_loss:0.002996360184624791
The modified gen p mean: 0.4463247060775757, gen p mean: -0.2529318034648895, mean p set: 0.44690370559692383
loss_pred:0.015620728954672813, decouple_loss:0.0030454995576292276
The modified gen p mean: 0.44592949748039246, gen p mean: -0.2617633640766144, mean p set: 0.446456640958786
loss_pred:0.015697307884693146, decouple_loss:0.0028739573899656534
2023-04-27 01:09:15 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2543424069881439, mean p set: 0.4499112665653229
loss_pred:0.017495138570666313, decouple_loss:0.0027003432624042034
The modified gen p mean: 0.44822317361831665, gen p mean: -0.25136592984199524, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492570161819458, gen p mean: -0.25444191694259644, mean p set: 0.4498290419578552
loss_pred:0.01745271496474743, decouple_loss:0.002681844402104616
loss_pred:0.01702556386590004, decouple_loss:0.002686665393412113
WV_1_PC_1_EH_0_PS_30, loss: 0.017458952963352203, avg_mse: 0.02577417716383934
current test mse: 0.025774
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 1041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491506814956665, gen p mean: -0.2575049102306366, mean p set: 0.449685275554657
loss_pred:0.01565413549542427, decouple_loss:0.0027926310431212187
The modified gen p mean: 0.44847536087036133, gen p mean: -0.2533608675003052, mean p set: 0.4490547776222229
loss_pred:0.015562471933662891, decouple_loss:0.0025719753466546535
The modified gen p mean: 0.44785815477371216, gen p mean: -0.2571953237056732, mean p set: 0.4484313726425171
loss_pred:0.015827279537916183, decouple_loss:0.0025217467918992043
Iteration: 1042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859257340431213, gen p mean: -0.2521345615386963, mean p set: 0.4491156041622162
loss_pred:0.015834061428904533, decouple_loss:0.002962882164865732
The modified gen p mean: 0.44852039217948914, gen p mean: -0.24993473291397095, mean p set: 0.44910410046577454
loss_pred:0.015910053625702858, decouple_loss:0.0030606163199990988
The modified gen p mean: 0.4485350251197815, gen p mean: -0.2507677674293518, mean p set: 0.44910916686058044
loss_pred:0.015786929056048393, decouple_loss:0.0030038999393582344
Iteration: 1043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486537277698517, gen p mean: -0.25155937671661377, mean p set: 0.4491857588291168
loss_pred:0.015602708794176579, decouple_loss:0.0027639935724437237
The modified gen p mean: 0.44656190276145935, gen p mean: -0.2521764039993286, mean p set: 0.44714176654815674
loss_pred:0.015736816450953484, decouple_loss:0.0027832849882543087
The modified gen p mean: 0.4477922022342682, gen p mean: -0.2476484328508377, mean p set: 0.4483604431152344
loss_pred:0.015784410759806633, decouple_loss:0.0025803078897297382
Iteration: 1044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825032353401184, gen p mean: -0.2535591125488281, mean p set: 0.4487766921520233
loss_pred:0.015531289391219616, decouple_loss:0.003116719890385866
The modified gen p mean: 0.4494582414627075, gen p mean: -0.25452932715415955, mean p set: 0.450029194355011
loss_pred:0.015779322013258934, decouple_loss:0.0030109647195786238
The modified gen p mean: 0.4486709535121918, gen p mean: -0.2500516176223755, mean p set: 0.44925105571746826
loss_pred:0.01589699275791645, decouple_loss:0.002977067371830344
Iteration: 1045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796034693717957, gen p mean: -0.2509932219982147, mean p set: 0.44853806495666504
loss_pred:0.015279734507203102, decouple_loss:0.0025933394208550453
The modified gen p mean: 0.44892698526382446, gen p mean: -0.24929004907608032, mean p set: 0.44951245188713074The modified gen p mean: 0.4487258791923523, gen p mean: -0.2503030300140381, mean p set: 0.4492553174495697
loss_pred:0.015033083967864513, decouple_loss:0.0026757484301924706
loss_pred:0.015504440292716026, decouple_loss:0.002712846966460347
Iteration: 1046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813480973243713, gen p mean: -0.24503760039806366, mean p set: 0.44871124625205994
loss_pred:0.015477594919502735, decouple_loss:0.003097076900303364
The modified gen p mean: 0.4484638571739197, gen p mean: -0.24907590448856354, mean p set: 0.4490397274494171
loss_pred:0.015847278758883476, decouple_loss:0.002753877080976963
The modified gen p mean: 0.4479513168334961, gen p mean: -0.24892254173755646, mean p set: 0.4484765827655792
loss_pred:0.01545967347919941, decouple_loss:0.002846542512997985
Iteration: 1047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809824228286743, gen p mean: -0.25218790769577026, mean p set: 0.4486764669418335
loss_pred:0.015225679613649845, decouple_loss:0.0028634730260819197
The modified gen p mean: 0.44709739089012146, gen p mean: -0.24862903356552124, mean p set: 0.4476754069328308
loss_pred:0.01547131035476923, decouple_loss:0.00270232860930264
The modified gen p mean: 0.4485308825969696, gen p mean: -0.25316768884658813, mean p set: 0.44906941056251526
loss_pred:0.01562667079269886, decouple_loss:0.0028528538532555103
Iteration: 1048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937214255332947, gen p mean: -0.24745404720306396, mean p set: 0.44995051622390747
loss_pred:0.015544768422842026, decouple_loss:0.002925136825069785
The modified gen p mean: 0.4479801654815674, gen p mean: -0.25158220529556274, mean p set: 0.44855865836143494
loss_pred:0.015726929530501366, decouple_loss:0.00273529882542789
The modified gen p mean: 0.4475153088569641, gen p mean: -0.2511019706726074, mean p set: 0.44804278016090393
loss_pred:0.01597963459789753, decouple_loss:0.0028332218062132597
Iteration: 1049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853848218917847, gen p mean: -0.24849478900432587, mean p set: 0.44911760091781616
loss_pred:0.015526732429862022, decouple_loss:0.0026947755832225084
The modified gen p mean: 0.4485939145088196, gen p mean: -0.24943044781684875, mean p set: 0.44917428493499756
loss_pred:0.015169982798397541, decouple_loss:0.0026272241957485676
The modified gen p mean: 0.44796428084373474, gen p mean: -0.25021395087242126, mean p set: 0.4484924077987671
loss_pred:0.01576096937060356, decouple_loss:0.002868075855076313
Iteration: 1050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492305517196655, gen p mean: -0.24854540824890137, mean p set: 0.44981372356414795
loss_pred:0.015030991286039352, decouple_loss:0.0025303715374320745
The modified gen p mean: 0.447162389755249, gen p mean: -0.251288503408432, mean p set: 0.4477364122867584
loss_pred:0.015674374997615814, decouple_loss:0.0025163795799016953
The modified gen p mean: 0.4486438035964966, gen p mean: -0.2504316568374634, mean p set: 0.44916975498199463
loss_pred:0.015976566821336746, decouple_loss:0.002447751583531499
2023-04-27 01:13:25 testing...
The modified gen p mean: 0.448227196931839, gen p mean: -0.24885281920433044, mean p set: 0.44879910349845886
loss_pred:0.01732047274708748, decouple_loss:0.0026749789249151945
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25175172090530396, mean p set: 0.4499112665653229
loss_pred:0.01752287521958351, decouple_loss:0.002894446486607194
The modified gen p mean: 0.44925394654273987, gen p mean: -0.25167253613471985, mean p set: 0.4498290419578552
loss_pred:0.017078349366784096, decouple_loss:0.0027214051224291325
WV_1_PC_1_EH_0_PS_30, loss: 0.017445413395762444, avg_mse: 0.02573123574256897
current test mse: 0.025731
Iteration: 1051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729694724082947, gen p mean: -0.24398773908615112, mean p set: 0.447873055934906
loss_pred:0.015451628714799881, decouple_loss:0.0027580608148127794
The modified gen p mean: 0.44865286350250244, gen p mean: -0.2527811825275421, mean p set: 0.4492258131504059
loss_pred:0.015347257256507874, decouple_loss:0.002524338196963072
The modified gen p mean: 0.448159784078598, gen p mean: -0.25305378437042236, mean p set: 0.4486883282661438
loss_pred:0.015676911920309067, decouple_loss:0.0026928926818072796
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951939582824707, gen p mean: -0.2571030259132385, mean p set: 0.45003825426101685
loss_pred:0.015420487150549889, decouple_loss:0.002769090235233307
The modified gen p mean: 0.44862648844718933, gen p mean: -0.25055333971977234, mean p set: 0.4492001235485077
loss_pred:0.015116848051548004, decouple_loss:0.0026372175198048353
The modified gen p mean: 0.44869476556777954, gen p mean: -0.2503032982349396, mean p set: 0.44926580786705017
loss_pred:0.015517020598053932, decouple_loss:0.0026140143163502216
Iteration: 1053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769811630249023, gen p mean: -0.24640695750713348, mean p set: 0.4482291042804718
loss_pred:0.01548133697360754, decouple_loss:0.0028147201519459486
The modified gen p mean: 0.4484105110168457, gen p mean: -0.25219905376434326, mean p set: 0.44898921251296997
loss_pred:0.014947494491934776, decouple_loss:0.002850149990990758
The modified gen p mean: 0.44879236817359924, gen p mean: -0.24875681102275848, mean p set: 0.44937053322792053
loss_pred:0.015645092353224754, decouple_loss:0.0027247266843914986
Iteration: 1054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877567887306213, gen p mean: -0.25149184465408325, mean p set: 0.44930675625801086
loss_pred:0.015401674434542656, decouple_loss:0.002525458810850978
The modified gen p mean: 0.4476661682128906, gen p mean: -0.2433193475008011, mean p set: 0.4482443630695343
loss_pred:0.015883134678006172, decouple_loss:0.002496564295142889
The modified gen p mean: 0.44734135270118713, gen p mean: -0.24766872823238373, mean p set: 0.4479115903377533
loss_pred:0.015635596588253975, decouple_loss:0.0025833596009761095
Iteration: 1055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474909007549286, gen p mean: -0.2469167560338974, mean p set: 0.4480650722980499
loss_pred:0.01523108221590519, decouple_loss:0.0027816498186439276
The modified gen p mean: 0.4483775794506073, gen p mean: -0.2547649145126343, mean p set: 0.44895440340042114
loss_pred:0.015136738307774067, decouple_loss:0.0028071501292288303
The modified gen p mean: 0.44732561707496643, gen p mean: -0.2510036826133728, mean p set: 0.44785305857658386
loss_pred:0.015481377951800823, decouple_loss:0.003032915061339736
Iteration: 1056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488508999347687, gen p mean: -0.24722421169281006, mean p set: 0.4494262933731079
loss_pred:0.015940628945827484, decouple_loss:0.002569442382082343
The modified gen p mean: 0.4490945339202881, gen p mean: -0.25418272614479065, mean p set: 0.4496248662471771The modified gen p mean: 0.4488926827907562, gen p mean: -0.2515633702278137, mean p set: 0.4494645595550537
loss_pred:0.01556047797203064, decouple_loss:0.002611901145428419
loss_pred:0.015450956299901009, decouple_loss:0.002735156798735261
Iteration: 1057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803890585899353, gen p mean: -0.2509608566761017, mean p set: 0.44861912727355957
loss_pred:0.015587053261697292, decouple_loss:0.0030720937065780163
The modified gen p mean: 0.4476645886898041, gen p mean: -0.2426811307668686, mean p set: 0.4482038617134094The modified gen p mean: 0.44829636812210083, gen p mean: -0.2521238327026367, mean p set: 0.44887199997901917
loss_pred:0.015465856529772282, decouple_loss:0.0029207051265984774
loss_pred:0.015357333235442638, decouple_loss:0.002970130415633321
Iteration: 1058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479585587978363, gen p mean: -0.25210657715797424, mean p set: 0.4485251009464264
loss_pred:0.016062526032328606, decouple_loss:0.0027252454310655594
The modified gen p mean: 0.4474667012691498, gen p mean: -0.24892830848693848, mean p set: 0.4479973018169403The modified gen p mean: 0.44830605387687683, gen p mean: -0.2502129375934601, mean p set: 0.4488835632801056
loss_pred:0.0148831307888031, decouple_loss:0.0029266243800520897
loss_pred:0.015459485352039337, decouple_loss:0.0026681041345000267
Iteration: 1059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482354521751404, gen p mean: -0.24541103839874268, mean p set: 0.4488137364387512
loss_pred:0.015599208883941174, decouple_loss:0.0030313925817608833
The modified gen p mean: 0.4487195611000061, gen p mean: -0.2524275481700897, mean p set: 0.44924765825271606The modified gen p mean: 0.44799214601516724, gen p mean: -0.2530680298805237, mean p set: 0.44856706261634827
loss_pred:0.015613305382430553, decouple_loss:0.002947114408016205
loss_pred:0.015340818092226982, decouple_loss:0.0026790588162839413
Iteration: 1060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486314058303833, gen p mean: -0.25176990032196045, mean p set: 0.4492073655128479
loss_pred:0.01488405466079712, decouple_loss:0.0029278788715600967
The modified gen p mean: 0.4481152892112732, gen p mean: -0.25051647424697876, mean p set: 0.4486922323703766
loss_pred:0.015743739902973175, decouple_loss:0.0029279100708663464
The modified gen p mean: 0.4478064477443695, gen p mean: -0.2500849664211273, mean p set: 0.4483354985713959
loss_pred:0.015586519613862038, decouple_loss:0.002906265202909708
2023-04-27 01:16:51 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.251284658908844, mean p set: 0.4499112665653229
loss_pred:0.017601706087589264, decouple_loss:0.0030197056476026773
The modified gen p mean: 0.44822168350219727, gen p mean: -0.24865314364433289, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492431879043579, gen p mean: -0.2512547969818115, mean p set: 0.4498290419578552
loss_pred:0.017347844317555428, decouple_loss:0.002866694238036871
loss_pred:0.017199695110321045, decouple_loss:0.0029433330055326223
WV_1_PC_1_EH_0_PS_30, loss: 0.01753024384379387, avg_mse: 0.025840850546956062
current test mse: 0.025841
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 1061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884228706359863, gen p mean: -0.25698235630989075, mean p set: 0.44937342405319214
loss_pred:0.01521272212266922, decouple_loss:0.003304081503301859
The modified gen p mean: 0.4475480318069458, gen p mean: -0.24791081249713898, mean p set: 0.4481230676174164
loss_pred:0.015536829829216003, decouple_loss:0.0035256841219961643
The modified gen p mean: 0.4483756124973297, gen p mean: -0.2439812868833542, mean p set: 0.44894805550575256
loss_pred:0.015451972372829914, decouple_loss:0.0033264397643506527
Iteration: 1062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889596104621887, gen p mean: -0.2459670603275299, mean p set: 0.4494239091873169
loss_pred:0.014743038453161716, decouple_loss:0.003823010018095374
The modified gen p mean: 0.44862914085388184, gen p mean: -0.25469475984573364, mean p set: 0.4492042660713196
loss_pred:0.014822505414485931, decouple_loss:0.0033337378408759832
The modified gen p mean: 0.4467260241508484, gen p mean: -0.25055795907974243, mean p set: 0.44730088114738464
loss_pred:0.01550877746194601, decouple_loss:0.0037801354192197323
Iteration: 1063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828540086746216, gen p mean: -0.2453795224428177, mean p set: 0.44880932569503784
loss_pred:0.015595145523548126, decouple_loss:0.0032014772295951843
The modified gen p mean: 0.4487832486629486, gen p mean: -0.25229912996292114, mean p set: 0.44935348629951477
loss_pred:0.015500533394515514, decouple_loss:0.0031657388899475336
The modified gen p mean: 0.4481405019760132, gen p mean: -0.252959668636322, mean p set: 0.44871968030929565
loss_pred:0.014966936782002449, decouple_loss:0.0029438892379403114
Iteration: 1064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840750098228455, gen p mean: -0.25420087575912476, mean p set: 0.4489334523677826
loss_pred:0.015028457157313824, decouple_loss:0.003964548464864492
The modified gen p mean: 0.44757094979286194, gen p mean: -0.25019755959510803, mean p set: 0.4481446146965027
loss_pred:0.016253501176834106, decouple_loss:0.0034955129958689213
The modified gen p mean: 0.44812142848968506, gen p mean: -0.25238075852394104, mean p set: 0.4486970603466034
loss_pred:0.015642940998077393, decouple_loss:0.003662184812128544
Iteration: 1065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504011273384094, gen p mean: -0.2570619583129883, mean p set: 0.45098060369491577
loss_pred:0.015327504836022854, decouple_loss:0.0034070718102157116
The modified gen p mean: 0.4481675326824188, gen p mean: -0.25013285875320435, mean p set: 0.44869375228881836
The modified gen p mean: 0.44806188344955444, gen p mean: -0.2441270500421524, mean p set: 0.44864022731781006
loss_pred:0.015287077985703945, decouple_loss:0.0027362112887203693
loss_pred:0.01542193628847599, decouple_loss:0.0030223731882870197
Iteration: 1066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844457507133484, gen p mean: -0.24702489376068115, mean p set: 0.44901901483535767
loss_pred:0.01590569317340851, decouple_loss:0.0035505681298673153
The modified gen p mean: 0.4478648900985718, gen p mean: -0.2511572241783142, mean p set: 0.44843941926956177The modified gen p mean: 0.44880411028862, gen p mean: -0.2594345211982727, mean p set: 0.44932815432548523
loss_pred:0.014977940358221531, decouple_loss:0.0032958025112748146
loss_pred:0.014913331717252731, decouple_loss:0.0033141139429062605
Iteration: 1067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805508852005005, gen p mean: -0.2525692582130432, mean p set: 0.44863688945770264
loss_pred:0.014811954461038113, decouple_loss:0.0029808722902089357
The modified gen p mean: 0.4473377764225006, gen p mean: -0.24450325965881348, mean p set: 0.4479077458381653
loss_pred:0.01488345954567194, decouple_loss:0.002805213211104274
The modified gen p mean: 0.44813764095306396, gen p mean: -0.24745433032512665, mean p set: 0.448650062084198
loss_pred:0.015297338366508484, decouple_loss:0.0030176544096320868
Iteration: 1068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476555585861206, gen p mean: -0.2418915033340454, mean p set: 0.44823071360588074
loss_pred:0.014951852150261402, decouple_loss:0.003682401729747653
The modified gen p mean: 0.44680389761924744, gen p mean: -0.24850383400917053, mean p set: 0.44738414883613586
loss_pred:0.01586342416703701, decouple_loss:0.003342124866321683
The modified gen p mean: 0.448886901140213, gen p mean: -0.2541517913341522, mean p set: 0.4494134187698364
loss_pred:0.014825061894953251, decouple_loss:0.0035795739386230707
Iteration: 1069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475163519382477, gen p mean: -0.24810220301151276, mean p set: 0.4480842351913452
loss_pred:0.015048463828861713, decouple_loss:0.0028230876196175814
The modified gen p mean: 0.44964876770973206, gen p mean: -0.24803392589092255, mean p set: 0.4502216577529907
loss_pred:0.01559792272746563, decouple_loss:0.003162097418680787
The modified gen p mean: 0.44875577092170715, gen p mean: -0.2547927796840668, mean p set: 0.4492855668067932
loss_pred:0.01493318285793066, decouple_loss:0.0030587196815758944
Iteration: 1070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448957234621048, gen p mean: -0.2501381039619446, mean p set: 0.449531614780426
loss_pred:0.015316440723836422, decouple_loss:0.0030604053754359484
The modified gen p mean: 0.4474027156829834, gen p mean: -0.2502148747444153, mean p set: 0.4479316174983978
loss_pred:0.015768416225910187, decouple_loss:0.0035382292699068785
The modified gen p mean: 0.4482799470424652, gen p mean: -0.25228768587112427, mean p set: 0.4488562345504761
loss_pred:0.015240747481584549, decouple_loss:0.003586987964808941
2023-04-27 01:20:56 testing...
The modified gen p mean: 0.4482170641422272, gen p mean: -0.2487015724182129, mean p set: 0.44879910349845886
loss_pred:0.017589077353477478, decouple_loss:0.0030720452778041363
The modified gen p mean: 0.44925135374069214, gen p mean: -0.25130584836006165, mean p set: 0.4498290419578552
loss_pred:0.01718049868941307, decouple_loss:0.003008501837030053
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2512381374835968, mean p set: 0.4499112665653229
loss_pred:0.01754758134484291, decouple_loss:0.0030313346069306135
WV_1_PC_1_EH_0_PS_30, loss: 0.017590917646884918, avg_mse: 0.02597307413816452
current test mse: 0.025973
Iteration: 1071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484443962574005, gen p mean: -0.24407394230365753, mean p set: 0.44902175664901733
loss_pred:0.015470176935195923, decouple_loss:0.002738066017627716
The modified gen p mean: 0.44801899790763855, gen p mean: -0.24548564851284027, mean p set: 0.4485420286655426
loss_pred:0.015498465858399868, decouple_loss:0.0025966905523091555
The modified gen p mean: 0.4479370415210724, gen p mean: -0.25136375427246094, mean p set: 0.448505699634552
loss_pred:0.01503610797226429, decouple_loss:0.0029041829984635115
Iteration: 1072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839757680892944, gen p mean: -0.2506655752658844, mean p set: 0.44892609119415283
loss_pred:0.015023919753730297, decouple_loss:0.0032322192564606667
The modified gen p mean: 0.4481413960456848, gen p mean: -0.25039857625961304, mean p set: 0.44872117042541504
The modified gen p mean: 0.44889211654663086, gen p mean: -0.2471584677696228, mean p set: 0.4494667053222656
loss_pred:0.015538434498012066, decouple_loss:0.0032745758071541786
loss_pred:0.014451169408857822, decouple_loss:0.0032275179401040077
Iteration: 1073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489777982234955, gen p mean: -0.2462066262960434, mean p set: 0.4495035707950592
loss_pred:0.014653797261416912, decouple_loss:0.0030862579587846994
The modified gen p mean: 0.4477737843990326, gen p mean: -0.250174343585968, mean p set: 0.4483504593372345The modified gen p mean: 0.4504779279232025, gen p mean: -0.25327855348587036, mean p set: 0.4510541558265686
loss_pred:0.014995953068137169, decouple_loss:0.0028554131276905537
loss_pred:0.015107077546417713, decouple_loss:0.0030336244963109493
Iteration: 1074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473634362220764, gen p mean: -0.2493993639945984, mean p set: 0.4478953182697296
loss_pred:0.01510527916252613, decouple_loss:0.0027332438621670008
The modified gen p mean: 0.4479306638240814, gen p mean: -0.25465258955955505, mean p set: 0.4484964609146118
The modified gen p mean: 0.44837257266044617, gen p mean: -0.24945442378520966, mean p set: 0.4489465653896332
loss_pred:0.014843552373349667, decouple_loss:0.002899156417697668
loss_pred:0.014936604537069798, decouple_loss:0.002774972701445222
Iteration: 1075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471556544303894, gen p mean: -0.25550082325935364, mean p set: 0.4477364122867584
loss_pred:0.015231449156999588, decouple_loss:0.0034366215113550425
The modified gen p mean: 0.4476385712623596, gen p mean: -0.2511669397354126, mean p set: 0.4482152760028839
loss_pred:0.015252985060214996, decouple_loss:0.0034037085715681314
The modified gen p mean: 0.44857123494148254, gen p mean: -0.2510099411010742, mean p set: 0.44909510016441345
loss_pred:0.015242250636219978, decouple_loss:0.003134013619273901
Iteration: 1076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471527636051178, gen p mean: -0.25460657477378845, mean p set: 0.4477311074733734
loss_pred:0.01527618058025837, decouple_loss:0.002618676982820034
The modified gen p mean: 0.4483344852924347, gen p mean: -0.26198673248291016, mean p set: 0.44891637563705444
loss_pred:0.015159174799919128, decouple_loss:0.0026673718821257353
The modified gen p mean: 0.44836413860321045, gen p mean: -0.2621963918209076, mean p set: 0.44889357686042786
loss_pred:0.014940536580979824, decouple_loss:0.002711034147068858
Iteration: 1077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469854235649109, gen p mean: -0.25588682293891907, mean p set: 0.4475100636482239
loss_pred:0.014865786768496037, decouple_loss:0.0034286347217857838
The modified gen p mean: 0.44926759600639343, gen p mean: -0.25341105461120605, mean p set: 0.44984006881713867The modified gen p mean: 0.4480481743812561, gen p mean: -0.2534390985965729, mean p set: 0.448621928691864
loss_pred:0.015584002248942852, decouple_loss:0.0034333153162151575
loss_pred:0.015359149314463139, decouple_loss:0.0035817958414554596
Iteration: 1078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854044914245605, gen p mean: -0.2538693845272064, mean p set: 0.4491152763366699
loss_pred:0.01487723644822836, decouple_loss:0.0027453580405563116
The modified gen p mean: 0.4480714797973633, gen p mean: -0.2569023072719574, mean p set: 0.4486437141895294
loss_pred:0.015148906968533993, decouple_loss:0.0029777605086565018
The modified gen p mean: 0.4475588798522949, gen p mean: -0.2512523829936981, mean p set: 0.4480955898761749
loss_pred:0.015604119747877121, decouple_loss:0.0027676736935973167
Iteration: 1079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490668773651123, gen p mean: -0.2488274872303009, mean p set: 0.4496456980705261
loss_pred:0.0145590053871274, decouple_loss:0.0035780337639153004
The modified gen p mean: 0.44928768277168274, gen p mean: -0.254853218793869, mean p set: 0.4498688280582428
loss_pred:0.01481233723461628, decouple_loss:0.003353065811097622
The modified gen p mean: 0.4467504918575287, gen p mean: -0.2481987625360489, mean p set: 0.44727620482444763
loss_pred:0.015467334538698196, decouple_loss:0.0033794317860156298
Iteration: 1080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765302538871765, gen p mean: -0.2420082688331604, mean p set: 0.448231041431427
loss_pred:0.015146882273256779, decouple_loss:0.0033254267182201147
The modified gen p mean: 0.4482422471046448, gen p mean: -0.245144322514534, mean p set: 0.44881969690322876
loss_pred:0.015704825520515442, decouple_loss:0.003145720111206174
The modified gen p mean: 0.4493207037448883, gen p mean: -0.249043270945549, mean p set: 0.44984567165374756
loss_pred:0.0152581837028265, decouple_loss:0.003278246382251382
2023-04-27 01:24:26 testing...
The modified gen p mean: 0.4482221305370331, gen p mean: -0.24636854231357574, mean p set: 0.44879910349845886
loss_pred:0.017594538629055023, decouple_loss:0.0035298357252031565
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24883688986301422, mean p set: 0.4499112665653229
loss_pred:0.017575830221176147, decouple_loss:0.0034741712734103203
The modified gen p mean: 0.44929972290992737, gen p mean: -0.2490427941083908, mean p set: 0.4498290419578552
loss_pred:0.01711808517575264, decouple_loss:0.00343490531668067
WV_1_PC_1_EH_0_PS_30, loss: 0.017603468149900436, avg_mse: 0.025968555361032486
current test mse: 0.025969
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 1081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463427662849426, gen p mean: -0.254787802696228, mean p set: 0.4468747675418854
loss_pred:0.015705816447734833, decouple_loss:0.0035076977219432592
The modified gen p mean: 0.446062296628952, gen p mean: -0.25280487537384033, mean p set: 0.44663533568382263
loss_pred:0.01514356303960085, decouple_loss:0.0033541140146553516
The modified gen p mean: 0.4481680393218994, gen p mean: -0.25053003430366516, mean p set: 0.4487343728542328
loss_pred:0.016057977452874184, decouple_loss:0.003179521532729268
Iteration: 1082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486195743083954, gen p mean: -0.23513811826705933, mean p set: 0.44913890957832336
loss_pred:0.015110118314623833, decouple_loss:0.0032257544808089733
The modified gen p mean: 0.4486258924007416, gen p mean: -0.23929323256015778, mean p set: 0.44919851422309875
loss_pred:0.015206004492938519, decouple_loss:0.003347956109791994
The modified gen p mean: 0.44853895902633667, gen p mean: -0.24538719654083252, mean p set: 0.4491168260574341
loss_pred:0.015690498054027557, decouple_loss:0.0032023792155086994
Iteration: 1083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477044939994812, gen p mean: -0.24419692158699036, mean p set: 0.4482307732105255
loss_pred:0.014948604628443718, decouple_loss:0.0031619241926819086
The modified gen p mean: 0.44840994477272034, gen p mean: -0.2365913689136505, mean p set: 0.44898515939712524The modified gen p mean: 0.44783294200897217, gen p mean: -0.24286924302577972, mean p set: 0.448408842086792
loss_pred:0.015415552072227001, decouple_loss:0.0032183616422116756loss_pred:0.015516374260187149, decouple_loss:0.00322826043702662
Iteration: 1084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482061266899109, gen p mean: -0.24438637495040894, mean p set: 0.4487411379814148
loss_pred:0.014694258570671082, decouple_loss:0.0030088473577052355
The modified gen p mean: 0.44747084379196167, gen p mean: -0.24618543684482574, mean p set: 0.44804564118385315
loss_pred:0.015367154031991959, decouple_loss:0.003037575399503112
The modified gen p mean: 0.44718044996261597, gen p mean: -0.24542741477489471, mean p set: 0.44775673747062683
loss_pred:0.014851247891783714, decouple_loss:0.0031362923327833414
Iteration: 1085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479949474334717, gen p mean: -0.23934884369373322, mean p set: 0.4485265016555786
loss_pred:0.014615018852055073, decouple_loss:0.003486508270725608
The modified gen p mean: 0.4486583173274994, gen p mean: -0.23816704750061035, mean p set: 0.4492388665676117
loss_pred:0.014744546264410019, decouple_loss:0.003497754456475377
The modified gen p mean: 0.44738414883613586, gen p mean: -0.23950527608394623, mean p set: 0.44796544313430786
loss_pred:0.015405596233904362, decouple_loss:0.0037112291902303696
Iteration: 1086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477684199810028, gen p mean: -0.23901161551475525, mean p set: 0.4483499228954315
loss_pred:0.014981740154325962, decouple_loss:0.0028192598838359118
The modified gen p mean: 0.4478720724582672, gen p mean: -0.2382870465517044, mean p set: 0.44844454526901245
loss_pred:0.014739952981472015, decouple_loss:0.002921281848102808
The modified gen p mean: 0.44813328981399536, gen p mean: -0.2432379573583603, mean p set: 0.4486563205718994
loss_pred:0.014538884162902832, decouple_loss:0.002877322258427739
Iteration: 1087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446742445230484, gen p mean: -0.24141454696655273, mean p set: 0.4472724497318268
loss_pred:0.015205021016299725, decouple_loss:0.003132232464849949
The modified gen p mean: 0.4500824213027954, gen p mean: -0.2440488487482071, mean p set: 0.45066288113594055The modified gen p mean: 0.44800832867622375, gen p mean: -0.2391025424003601, mean p set: 0.4485826790332794
loss_pred:0.014879539608955383, decouple_loss:0.003662410192191601loss_pred:0.015024756081402302, decouple_loss:0.0032787013333290815
Iteration: 1088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476190507411957, gen p mean: -0.24204570055007935, mean p set: 0.4481477439403534
loss_pred:0.01516072265803814, decouple_loss:0.0029451940208673477
The modified gen p mean: 0.449259877204895, gen p mean: -0.23746414482593536, mean p set: 0.44983553886413574The modified gen p mean: 0.4495229423046112, gen p mean: -0.24948763847351074, mean p set: 0.4501021206378937
loss_pred:0.014945457689464092, decouple_loss:0.002994396723806858
loss_pred:0.01511492021381855, decouple_loss:0.0027357072103768587
Iteration: 1089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447970449924469, gen p mean: -0.24131473898887634, mean p set: 0.44854292273521423
loss_pred:0.01486104354262352, decouple_loss:0.0033140091691166162
The modified gen p mean: 0.44838252663612366, gen p mean: -0.24758076667785645, mean p set: 0.44895556569099426
loss_pred:0.0157318115234375, decouple_loss:0.003338814713060856
The modified gen p mean: 0.44869863986968994, gen p mean: -0.2415725290775299, mean p set: 0.4492274820804596
loss_pred:0.01485179178416729, decouple_loss:0.0031686031725257635
Iteration: 1090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463992118835449, gen p mean: -0.2512531876564026, mean p set: 0.44696733355522156
loss_pred:0.014856070280075073, decouple_loss:0.002850106917321682
The modified gen p mean: 0.4480119049549103, gen p mean: -0.24924801290035248, mean p set: 0.4485855996608734
loss_pred:0.015308191068470478, decouple_loss:0.002765998477116227
The modified gen p mean: 0.4487930238246918, gen p mean: -0.24294203519821167, mean p set: 0.449319064617157
loss_pred:0.015151049941778183, decouple_loss:0.0027872389182448387
2023-04-27 01:28:31 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24904213845729828, mean p set: 0.4499112665653229
loss_pred:0.01760789379477501, decouple_loss:0.0030075926333665848
The modified gen p mean: 0.44930633902549744, gen p mean: -0.24887339770793915, mean p set: 0.4498290419578552
loss_pred:0.01714622601866722, decouple_loss:0.0031721661798655987
The modified gen p mean: 0.44822239875793457, gen p mean: -0.2466398924589157, mean p set: 0.44879910349845886
loss_pred:0.017515070736408234, decouple_loss:0.0031963090877979994
WV_1_PC_1_EH_0_PS_30, loss: 0.0175793319940567, avg_mse: 0.02599216438829899
current test mse: 0.025992
Iteration: 1091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079296827316284, gen p mean: -0.2503851652145386, mean p set: 0.4513660967350006
loss_pred:0.015072143636643887, decouple_loss:0.0027988755609840155
The modified gen p mean: 0.4475647807121277, gen p mean: -0.24573169648647308, mean p set: 0.44809263944625854
loss_pred:0.014764544554054737, decouple_loss:0.003248170018196106
The modified gen p mean: 0.4482787549495697, gen p mean: -0.24505554139614105, mean p set: 0.44885557889938354
loss_pred:0.014869187027215958, decouple_loss:0.0032630127388983965
Iteration: 1092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483609199523926, gen p mean: -0.24527518451213837, mean p set: 0.4488862454891205
loss_pred:0.015201259404420853, decouple_loss:0.0026799223851412535
The modified gen p mean: 0.4491398334503174, gen p mean: -0.2520538568496704, mean p set: 0.44971415400505066
The modified gen p mean: 0.44645991921424866, gen p mean: -0.25228095054626465, mean p set: 0.44704070687294006
loss_pred:0.015612348914146423, decouple_loss:0.002809771103784442
loss_pred:0.014608164317905903, decouple_loss:0.0027588317170739174
Iteration: 1093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773098826408386, gen p mean: -0.24140731990337372, mean p set: 0.4482579529285431
loss_pred:0.015094001777470112, decouple_loss:0.0027998564764857292
The modified gen p mean: 0.44899240136146545, gen p mean: -0.25092652440071106, mean p set: 0.4495646357536316
The modified gen p mean: 0.448622465133667, gen p mean: -0.242330402135849, mean p set: 0.44920095801353455
loss_pred:0.015013761818408966, decouple_loss:0.003123194444924593
loss_pred:0.014943588525056839, decouple_loss:0.0028733869548887014
Iteration: 1094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487408995628357, gen p mean: -0.24876512587070465, mean p set: 0.4492718279361725
loss_pred:0.015398076735436916, decouple_loss:0.0027490523643791676
The modified gen p mean: 0.44808873534202576, gen p mean: -0.24520252645015717, mean p set: 0.44866693019866943
The modified gen p mean: 0.4474436640739441, gen p mean: -0.2456357777118683, mean p set: 0.4480225145816803
loss_pred:0.015112776309251785, decouple_loss:0.002741007599979639
loss_pred:0.01571323350071907, decouple_loss:0.0028004164341837168
Iteration: 1095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472311735153198, gen p mean: -0.24368199706077576, mean p set: 0.44780102372169495
loss_pred:0.015854114666581154, decouple_loss:0.0028443944174796343
The modified gen p mean: 0.44732943177223206, gen p mean: -0.2482130527496338, mean p set: 0.4478631317615509
The modified gen p mean: 0.4477861523628235, gen p mean: -0.24927227199077606, mean p set: 0.44836726784706116
loss_pred:0.014426923356950283, decouple_loss:0.0027198942843824625
loss_pred:0.015232189558446407, decouple_loss:0.002676840405911207
Iteration: 1096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824039936065674, gen p mean: -0.24465516209602356, mean p set: 0.44876742362976074
loss_pred:0.015233244746923447, decouple_loss:0.0024996032007038593
The modified gen p mean: 0.44824978709220886, gen p mean: -0.251321941614151, mean p set: 0.4488264322280884
The modified gen p mean: 0.44818708300590515, gen p mean: -0.25003841519355774, mean p set: 0.4487667679786682
loss_pred:0.014895047061145306, decouple_loss:0.00309427990578115
loss_pred:0.015280268155038357, decouple_loss:0.0030273545999079943
Iteration: 1097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493158161640167, gen p mean: -0.24255408346652985, mean p set: 0.44988885521888733
loss_pred:0.015250631608068943, decouple_loss:0.0027192579582333565
The modified gen p mean: 0.4477439820766449, gen p mean: -0.2461613118648529, mean p set: 0.4482734203338623The modified gen p mean: 0.4486684203147888, gen p mean: -0.2379111796617508, mean p set: 0.4492424428462982
loss_pred:0.014868160709738731, decouple_loss:0.002987315645441413
loss_pred:0.01477457769215107, decouple_loss:0.002650491427630186
Iteration: 1098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482390284538269, gen p mean: -0.24784739315509796, mean p set: 0.4488143026828766
loss_pred:0.015033460222184658, decouple_loss:0.002694370225071907
The modified gen p mean: 0.4464161992073059, gen p mean: -0.25613564252853394, mean p set: 0.446990966796875
loss_pred:0.015278221108019352, decouple_loss:0.0026671793311834335
The modified gen p mean: 0.44702187180519104, gen p mean: -0.2551511824131012, mean p set: 0.44755133986473083
loss_pred:0.014359664171934128, decouple_loss:0.0025601128581911325
Iteration: 1099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010581612586975, gen p mean: -0.2516098916530609, mean p set: 0.450685054063797
loss_pred:0.015178187750279903, decouple_loss:0.002921156585216522
The modified gen p mean: 0.4482579231262207, gen p mean: -0.24621330201625824, mean p set: 0.44883567094802856
loss_pred:0.015383586287498474, decouple_loss:0.00242285686545074
The modified gen p mean: 0.4485679566860199, gen p mean: -0.25411975383758545, mean p set: 0.4490965008735657
loss_pred:0.015350986272096634, decouple_loss:0.002732293913140893
Iteration: 1100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822096824645996, gen p mean: -0.24852736294269562, mean p set: 0.44879457354545593
loss_pred:0.014985010027885437, decouple_loss:0.002934022108092904
The modified gen p mean: 0.4477351903915405, gen p mean: -0.24853947758674622, mean p set: 0.44830387830734253
loss_pred:0.015876036137342453, decouple_loss:0.0026958619710057974
The modified gen p mean: 0.44754722714424133, gen p mean: -0.24946704506874084, mean p set: 0.4480714499950409
loss_pred:0.01463592890650034, decouple_loss:0.002785570453852415
2023-04-27 01:31:56 testing...
The modified gen p mean: 0.4482225179672241, gen p mean: -0.24399574100971222, mean p set: 0.44879910349845886
loss_pred:0.017537103965878487, decouple_loss:0.0028710528276860714
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24686786532402039, mean p set: 0.4499112665653229
loss_pred:0.01761496067047119, decouple_loss:0.002676846459507942
The modified gen p mean: 0.4493013024330139, gen p mean: -0.24660354852676392, mean p set: 0.4498290419578552
loss_pred:0.017179930582642555, decouple_loss:0.0028365447651594877
WV_1_PC_1_EH_0_PS_30, loss: 0.017583739012479782, avg_mse: 0.026027673855423927
current test mse: 0.026028
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 1101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471297264099121, gen p mean: -0.2460988163948059, mean p set: 0.4476657211780548
loss_pred:0.015776103362441063, decouple_loss:0.0027941775042563677
The modified gen p mean: 0.44714441895484924, gen p mean: -0.24505922198295593, mean p set: 0.44771599769592285
loss_pred:0.01594405062496662, decouple_loss:0.0028446917422115803
The modified gen p mean: 0.44822508096694946, gen p mean: -0.24799667298793793, mean p set: 0.44880321621894836
loss_pred:0.016262445598840714, decouple_loss:0.0026438087224960327
Iteration: 1102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670870900154114, gen p mean: -0.2499181628227234, mean p set: 0.44723477959632874
loss_pred:0.01683240756392479, decouple_loss:0.002663242630660534
The modified gen p mean: 0.4469953179359436, gen p mean: -0.2467527985572815, mean p set: 0.4475705623626709
loss_pred:0.015632115304470062, decouple_loss:0.0026050438173115253
The modified gen p mean: 0.44751790165901184, gen p mean: -0.24362285435199738, mean p set: 0.4480918347835541
loss_pred:0.01687716878950596, decouple_loss:0.002523442031815648
Iteration: 1103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474078416824341, gen p mean: -0.24751946330070496, mean p set: 0.44793686270713806
loss_pred:0.01597675494849682, decouple_loss:0.0025340814609080553
The modified gen p mean: 0.44720548391342163, gen p mean: -0.2449120581150055, mean p set: 0.4477764964103699
loss_pred:0.015915412455797195, decouple_loss:0.0027604273054748774
The modified gen p mean: 0.44655299186706543, gen p mean: -0.2519162893295288, mean p set: 0.4471310079097748
loss_pred:0.015537414699792862, decouple_loss:0.0027951400261372328
Iteration: 1104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775572419166565, gen p mean: -0.2504590153694153, mean p set: 0.4482831358909607
loss_pred:0.016299542039632797, decouple_loss:0.002505350625142455
The modified gen p mean: 0.44689619541168213, gen p mean: -0.24968896806240082, mean p set: 0.44747352600097656
loss_pred:0.016233816742897034, decouple_loss:0.0026868663262575865
The modified gen p mean: 0.44737905263900757, gen p mean: -0.24686723947525024, mean p set: 0.4479510188102722
loss_pred:0.016392981633543968, decouple_loss:0.0023816702887415886
Iteration: 1105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478476345539093, gen p mean: -0.2515483796596527, mean p set: 0.44842514395713806
loss_pred:0.01612783782184124, decouple_loss:0.0029029587749391794
The modified gen p mean: 0.4467865228652954, gen p mean: -0.24977968633174896, mean p set: 0.44736430048942566
loss_pred:0.015935581177473068, decouple_loss:0.0028641968965530396
The modified gen p mean: 0.4476136267185211, gen p mean: -0.2507690191268921, mean p set: 0.4481441080570221
loss_pred:0.01574246771633625, decouple_loss:0.0027975477278232574
Iteration: 1106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467769265174866, gen p mean: -0.2503592371940613, mean p set: 0.4473079442977905
loss_pred:0.016080863773822784, decouple_loss:0.0024880487471818924
The modified gen p mean: 0.44702449440956116, gen p mean: -0.25302428007125854, mean p set: 0.4476010799407959The modified gen p mean: 0.4475681483745575, gen p mean: -0.24836570024490356, mean p set: 0.4481446444988251
loss_pred:0.01601378247141838, decouple_loss:0.0027672459837049246
loss_pred:0.01668676920235157, decouple_loss:0.0024233467411249876
Iteration: 1107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446755588054657, gen p mean: -0.25460246205329895, mean p set: 0.44728556275367737
loss_pred:0.016709469258785248, decouple_loss:0.002662078710272908
The modified gen p mean: 0.4476622939109802, gen p mean: -0.2523389160633087, mean p set: 0.4482421875
loss_pred:0.015714295208454132, decouple_loss:0.0026422739028930664
The modified gen p mean: 0.4481463134288788, gen p mean: -0.2503412961959839, mean p set: 0.44871804118156433
loss_pred:0.015914902091026306, decouple_loss:0.0026079812087118626
Iteration: 1108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473254978656769, gen p mean: -0.25296664237976074, mean p set: 0.4479072690010071
loss_pred:0.015360411256551743, decouple_loss:0.0025841244496405125
The modified gen p mean: 0.44858288764953613, gen p mean: -0.25069770216941833, mean p set: 0.44910916686058044The modified gen p mean: 0.44744673371315, gen p mean: -0.2524771988391876, mean p set: 0.44802361726760864
loss_pred:0.015751315280795097, decouple_loss:0.002580992877483368
loss_pred:0.016336210072040558, decouple_loss:0.0025502003263682127
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448093980550766, gen p mean: -0.2529892921447754, mean p set: 0.44862401485443115
loss_pred:0.016287367790937424, decouple_loss:0.0026457449421286583
The modified gen p mean: 0.44650739431381226, gen p mean: -0.250749409198761, mean p set: 0.4470870792865753
loss_pred:0.01637989841401577, decouple_loss:0.0027398644015192986
The modified gen p mean: 0.4483095705509186, gen p mean: -0.2539549469947815, mean p set: 0.4488847255706787
loss_pred:0.01571984775364399, decouple_loss:0.0026309844106435776
Iteration: 1110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484620690345764, gen p mean: -0.2590735852718353, mean p set: 0.4490325152873993
loss_pred:0.015232422389090061, decouple_loss:0.002478326205164194
The modified gen p mean: 0.4466765820980072, gen p mean: -0.2586863934993744, mean p set: 0.4472491443157196
loss_pred:0.015784453600645065, decouple_loss:0.0025637175422161818
The modified gen p mean: 0.44806796312332153, gen p mean: -0.25389111042022705, mean p set: 0.4485948383808136
loss_pred:0.01581420935690403, decouple_loss:0.002507175551727414
2023-04-27 01:36:08 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25471818447113037, mean p set: 0.4499112665653229
loss_pred:0.017504606395959854, decouple_loss:0.002656456781551242
The modified gen p mean: 0.4492968022823334, gen p mean: -0.2549994885921478, mean p set: 0.4498290419578552
loss_pred:0.0171098243445158, decouple_loss:0.002733023837208748
The modified gen p mean: 0.4482218027114868, gen p mean: -0.25207439064979553, mean p set: 0.44879910349845886
loss_pred:0.017407676205039024, decouple_loss:0.0026087751612067223
WV_1_PC_1_EH_0_PS_30, loss: 0.017474006861448288, avg_mse: 0.025847772136330605
current test mse: 0.025848
Iteration: 1111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785967469215393, gen p mean: -0.25827664136886597, mean p set: 0.44843074679374695
loss_pred:0.015866722911596298, decouple_loss:0.0025641093961894512
The modified gen p mean: 0.44811365008354187, gen p mean: -0.2537625730037689, mean p set: 0.4486437737941742
loss_pred:0.01568947173655033, decouple_loss:0.002713284455239773
The modified gen p mean: 0.4473440647125244, gen p mean: -0.2524532675743103, mean p set: 0.4479181170463562
loss_pred:0.01575762778520584, decouple_loss:0.002652997151017189
Iteration: 1112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492577016353607, gen p mean: -0.25665104389190674, mean p set: 0.4497888684272766
loss_pred:0.015550930052995682, decouple_loss:0.0027899094857275486
The modified gen p mean: 0.4471278786659241, gen p mean: -0.25322917103767395, mean p set: 0.4476999342441559
The modified gen p mean: 0.4472338855266571, gen p mean: -0.2550398111343384, mean p set: 0.44780635833740234
loss_pred:0.015756770968437195, decouple_loss:0.0026519414968788624
loss_pred:0.016392750665545464, decouple_loss:0.00261473935097456
Iteration: 1113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461759626865387, gen p mean: -0.249959334731102, mean p set: 0.44670602679252625
loss_pred:0.016362953931093216, decouple_loss:0.0025749928317964077
The modified gen p mean: 0.44678202271461487, gen p mean: -0.2524639070034027, mean p set: 0.44736161828041077
The modified gen p mean: 0.4468453824520111, gen p mean: -0.24996256828308105, mean p set: 0.44742023944854736
loss_pred:0.015441286377608776, decouple_loss:0.00243144272826612
loss_pred:0.01565849408507347, decouple_loss:0.0024931025691330433
Iteration: 1114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477837085723877, gen p mean: -0.2532165050506592, mean p set: 0.4483122229576111
loss_pred:0.015459197573363781, decouple_loss:0.002589129377156496
The modified gen p mean: 0.4467228949069977, gen p mean: -0.2528759241104126, mean p set: 0.4472969174385071
The modified gen p mean: 0.44784367084503174, gen p mean: -0.252084881067276, mean p set: 0.4484269320964813
loss_pred:0.015301182866096497, decouple_loss:0.0027165354695171118
loss_pred:0.015450270846486092, decouple_loss:0.003069676924496889
Iteration: 1115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464854300022125, gen p mean: -0.25824645161628723, mean p set: 0.44701075553894043
loss_pred:0.015890272334218025, decouple_loss:0.002427139552310109
The modified gen p mean: 0.4472682774066925, gen p mean: -0.2552090287208557, mean p set: 0.4478473961353302
The modified gen p mean: 0.4475976228713989, gen p mean: -0.25651663541793823, mean p set: 0.44817429780960083
loss_pred:0.016364900395274162, decouple_loss:0.002558547304943204
loss_pred:0.016005732119083405, decouple_loss:0.0025929759722203016
Iteration: 1116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471961259841919, gen p mean: -0.2589902877807617, mean p set: 0.4477703869342804
loss_pred:0.01627585105597973, decouple_loss:0.002686101011931896
The modified gen p mean: 0.4472648501396179, gen p mean: -0.25503870844841003, mean p set: 0.4477914571762085The modified gen p mean: 0.44725051522254944, gen p mean: -0.2528379559516907, mean p set: 0.44782111048698425
loss_pred:0.01614370383322239, decouple_loss:0.0028102099895477295
loss_pred:0.01536048948764801, decouple_loss:0.002676732372492552
Iteration: 1117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818034768104553, gen p mean: -0.2584265470504761, mean p set: 0.4487501382827759
loss_pred:0.015516187064349651, decouple_loss:0.002557804575189948
The modified gen p mean: 0.446560800075531, gen p mean: -0.2589149475097656, mean p set: 0.44708749651908875The modified gen p mean: 0.44718337059020996, gen p mean: -0.25197434425354004, mean p set: 0.4477572739124298
loss_pred:0.016481636092066765, decouple_loss:0.002684962470084429
loss_pred:0.01632576994597912, decouple_loss:0.0025999858044087887
Iteration: 1118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679901003837585, gen p mean: -0.2526976764202118, mean p set: 0.44737330079078674
loss_pred:0.015804031863808632, decouple_loss:0.0026224672328680754
The modified gen p mean: 0.44790416955947876, gen p mean: -0.2530021667480469, mean p set: 0.4484843611717224
loss_pred:0.015908168628811836, decouple_loss:0.0024640492629259825
The modified gen p mean: 0.4481067955493927, gen p mean: -0.2536214292049408, mean p set: 0.44864028692245483
loss_pred:0.01616080477833748, decouple_loss:0.0025444787461310625
Iteration: 1119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810858368873596, gen p mean: -0.25203952193260193, mean p set: 0.44868743419647217
loss_pred:0.015597693622112274, decouple_loss:0.0027394352946430445
The modified gen p mean: 0.44671571254730225, gen p mean: -0.25793877243995667, mean p set: 0.4472888708114624
loss_pred:0.015773726627230644, decouple_loss:0.0024731606245040894
The modified gen p mean: 0.4487759470939636, gen p mean: -0.2532077431678772, mean p set: 0.44930416345596313
loss_pred:0.015915947034955025, decouple_loss:0.0024693841114640236
Iteration: 1120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724029302597046, gen p mean: -0.2469911128282547, mean p set: 0.4478200376033783
loss_pred:0.01627741940319538, decouple_loss:0.002367977751418948
The modified gen p mean: 0.44725653529167175, gen p mean: -0.24904629588127136, mean p set: 0.4478357136249542
loss_pred:0.01571034826338291, decouple_loss:0.002425716258585453
The modified gen p mean: 0.44769275188446045, gen p mean: -0.24760960042476654, mean p set: 0.44822028279304504
loss_pred:0.015547682531177998, decouple_loss:0.002546910662204027
2023-04-27 01:39:32 testing...
The modified gen p mean: 0.4482298195362091, gen p mean: -0.24563725292682648, mean p set: 0.44879910349845886
loss_pred:0.017400676384568214, decouple_loss:0.002316985512152314
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2482738196849823, mean p set: 0.4499112665653229
loss_pred:0.017562925815582275, decouple_loss:0.0023809706326574087
The modified gen p mean: 0.4492988884449005, gen p mean: -0.24840779602527618, mean p set: 0.4498290419578552
loss_pred:0.017091356217861176, decouple_loss:0.0024093682877719402
WV_1_PC_1_EH_0_PS_30, loss: 0.017470110207796097, avg_mse: 0.025806572288274765
current test mse: 0.025807
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 1121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466543197631836, gen p mean: -0.2465979903936386, mean p set: 0.4471836984157562
loss_pred:0.01623326912522316, decouple_loss:0.002428940497338772
The modified gen p mean: 0.44676896929740906, gen p mean: -0.24638038873672485, mean p set: 0.4473459720611572
loss_pred:0.01640869677066803, decouple_loss:0.002292380901053548
The modified gen p mean: 0.4479266107082367, gen p mean: -0.25466811656951904, mean p set: 0.44850221276283264
loss_pred:0.01553273107856512, decouple_loss:0.002444858429953456
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609659910202026, gen p mean: -0.24908135831356049, mean p set: 0.4466211497783661
loss_pred:0.01570320501923561, decouple_loss:0.002319652820006013
The modified gen p mean: 0.4477171301841736, gen p mean: -0.25179535150527954, mean p set: 0.44829118251800537
loss_pred:0.015458867885172367, decouple_loss:0.002309252740815282
The modified gen p mean: 0.4471002519130707, gen p mean: -0.2550676465034485, mean p set: 0.4476762115955353
loss_pred:0.01535233948379755, decouple_loss:0.0023367733228951693
Iteration: 1123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44601380825042725, gen p mean: -0.2463926523923874, mean p set: 0.4465442895889282
loss_pred:0.01580701768398285, decouple_loss:0.0024024180602282286
The modified gen p mean: 0.4477308392524719, gen p mean: -0.25067517161369324, mean p set: 0.4483036994934082
loss_pred:0.01537582278251648, decouple_loss:0.002512117149308324
The modified gen p mean: 0.4461590647697449, gen p mean: -0.2506586015224457, mean p set: 0.44673141837120056
loss_pred:0.016258317977190018, decouple_loss:0.0024137096479535103
Iteration: 1124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467155933380127, gen p mean: -0.24901042878627777, mean p set: 0.44724246859550476
loss_pred:0.015653342008590698, decouple_loss:0.0027776898350566626
The modified gen p mean: 0.44621121883392334, gen p mean: -0.2527410387992859, mean p set: 0.4467797577381134
loss_pred:0.01603151671588421, decouple_loss:0.002793204737827182
The modified gen p mean: 0.4479967951774597, gen p mean: -0.2520163655281067, mean p set: 0.448570191860199
loss_pred:0.01563008688390255, decouple_loss:0.002601339714601636
Iteration: 1125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474194347858429, gen p mean: -0.2514874339103699, mean p set: 0.4479915201663971
loss_pred:0.01545529905706644, decouple_loss:0.0025762408040463924
The modified gen p mean: 0.4487329125404358, gen p mean: -0.26161786913871765, mean p set: 0.44930580258369446The modified gen p mean: 0.4464801549911499, gen p mean: -0.25694751739501953, mean p set: 0.44700121879577637
loss_pred:0.015454618260264397, decouple_loss:0.0025267668534070253
loss_pred:0.016173582524061203, decouple_loss:0.0024810112081468105
Iteration: 1126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44589608907699585, gen p mean: -0.25016161799430847, mean p set: 0.4464643895626068
loss_pred:0.01585543155670166, decouple_loss:0.0024410372134298086
The modified gen p mean: 0.4470527768135071, gen p mean: -0.24985478818416595, mean p set: 0.4475724399089813The modified gen p mean: 0.4459443986415863, gen p mean: -0.24890249967575073, mean p set: 0.44651639461517334
loss_pred:0.016208412125706673, decouple_loss:0.002490203594788909
loss_pred:0.015568805858492851, decouple_loss:0.0024854044895619154
Iteration: 1127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474983811378479, gen p mean: -0.2539064586162567, mean p set: 0.44806966185569763
loss_pred:0.015530571341514587, decouple_loss:0.0025907387025654316
The modified gen p mean: 0.4472421109676361, gen p mean: -0.25441163778305054, mean p set: 0.44781920313835144The modified gen p mean: 0.44692137837409973, gen p mean: -0.24931977689266205, mean p set: 0.4474518895149231
loss_pred:0.01607353426516056, decouple_loss:0.0024019568227231503
loss_pred:0.015797453001141548, decouple_loss:0.002549976110458374
Iteration: 1128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701382517814636, gen p mean: -0.25441718101501465, mean p set: 0.447593629360199
loss_pred:0.015568805858492851, decouple_loss:0.0023900086525827646
The modified gen p mean: 0.44691696763038635, gen p mean: -0.2533433139324188, mean p set: 0.4474417567253113The modified gen p mean: 0.44575580954551697, gen p mean: -0.2532368302345276, mean p set: 0.4463328719139099
loss_pred:0.015520961955189705, decouple_loss:0.002438955008983612
loss_pred:0.015898430719971657, decouple_loss:0.002454856876283884
Iteration: 1129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832637906074524, gen p mean: -0.25983670353889465, mean p set: 0.4489026963710785
loss_pred:0.015496717765927315, decouple_loss:0.002729478059336543
The modified gen p mean: 0.44670650362968445, gen p mean: -0.25383102893829346, mean p set: 0.4472809433937073
loss_pred:0.01594601385295391, decouple_loss:0.002733821514993906
The modified gen p mean: 0.44649791717529297, gen p mean: -0.25363457202911377, mean p set: 0.44702303409576416
loss_pred:0.016034506261348724, decouple_loss:0.0025747090112417936
Iteration: 1130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713056087493896, gen p mean: -0.25284451246261597, mean p set: 0.4477064609527588
loss_pred:0.015360051766037941, decouple_loss:0.0023202395532280207
The modified gen p mean: 0.446440726518631, gen p mean: -0.25242921710014343, mean p set: 0.44701918959617615The modified gen p mean: 0.4461170434951782, gen p mean: -0.24957256019115448, mean p set: 0.4466512203216553
loss_pred:0.016269821673631668, decouple_loss:0.0024117801804095507
loss_pred:0.016372038051486015, decouple_loss:0.00255333399400115
2023-04-27 01:43:38 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2523547112941742, mean p set: 0.4499112665653229
loss_pred:0.017549926415085793, decouple_loss:0.0029910956509411335
The modified gen p mean: 0.4493011236190796, gen p mean: -0.2527505159378052, mean p set: 0.4498290419578552
loss_pred:0.01706155575811863, decouple_loss:0.0028832186944782734
The modified gen p mean: 0.44821643829345703, gen p mean: -0.2498336136341095, mean p set: 0.44879910349845886
loss_pred:0.017430953681468964, decouple_loss:0.0026984652504324913
WV_1_PC_1_EH_0_PS_30, loss: 0.017490359023213387, avg_mse: 0.025813952088356018
current test mse: 0.025814
Iteration: 1131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762542843818665, gen p mean: -0.25254547595977783, mean p set: 0.44819772243499756
loss_pred:0.016237420961260796, decouple_loss:0.002677155891433358
The modified gen p mean: 0.44599881768226624, gen p mean: -0.25019383430480957, mean p set: 0.4465225338935852
loss_pred:0.0157136470079422, decouple_loss:0.0027985521592199802
The modified gen p mean: 0.44682827591896057, gen p mean: -0.25187093019485474, mean p set: 0.447394996881485
loss_pred:0.015825806185603142, decouple_loss:0.0027071009390056133
Iteration: 1132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653674960136414, gen p mean: -0.24910560250282288, mean p set: 0.4470658302307129
loss_pred:0.01600036397576332, decouple_loss:0.002772702369838953
The modified gen p mean: 0.4466702938079834, gen p mean: -0.25302180647850037, mean p set: 0.44724223017692566
loss_pred:0.01595863327383995, decouple_loss:0.002750624204054475
The modified gen p mean: 0.4469252824783325, gen p mean: -0.25209492444992065, mean p set: 0.4474965035915375
loss_pred:0.015426527708768845, decouple_loss:0.002791339298710227
Iteration: 1133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472815692424774, gen p mean: -0.251498281955719, mean p set: 0.4478035867214203
loss_pred:0.015779081732034683, decouple_loss:0.002587344730272889
The modified gen p mean: 0.447992205619812, gen p mean: -0.24603639543056488, mean p set: 0.44856566190719604
loss_pred:0.01539565995335579, decouple_loss:0.0026531789917498827
The modified gen p mean: 0.44661250710487366, gen p mean: -0.24677340686321259, mean p set: 0.44718724489212036
loss_pred:0.01597491092979908, decouple_loss:0.002511411439627409
Iteration: 1134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681689143180847, gen p mean: -0.2447344958782196, mean p set: 0.4473433792591095
loss_pred:0.01579752005636692, decouple_loss:0.002740192459896207
The modified gen p mean: 0.44686123728752136, gen p mean: -0.2445855736732483, mean p set: 0.4474363923072815
loss_pred:0.015829356387257576, decouple_loss:0.0028670786414295435
The modified gen p mean: 0.4478910565376282, gen p mean: -0.24399040639400482, mean p set: 0.44846251606941223
loss_pred:0.015405022539198399, decouple_loss:0.0025599836371839046
Iteration: 1135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469777047634125, gen p mean: -0.2496938854455948, mean p set: 0.4475582242012024
loss_pred:0.015233966521918774, decouple_loss:0.0028363491874188185
The modified gen p mean: 0.447758287191391, gen p mean: -0.24744804203510284, mean p set: 0.44833290576934814The modified gen p mean: 0.44605180621147156, gen p mean: -0.2400466501712799, mean p set: 0.44658011198043823
loss_pred:0.015670370310544968, decouple_loss:0.002539577428251505
loss_pred:0.016041964292526245, decouple_loss:0.0027345982380211353
Iteration: 1136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467794597148895, gen p mean: -0.24540862441062927, mean p set: 0.44735097885131836
loss_pred:0.01548661757260561, decouple_loss:0.0024856838863343
The modified gen p mean: 0.44708627462387085, gen p mean: -0.2468215525150299, mean p set: 0.4476585388183594The modified gen p mean: 0.44639357924461365, gen p mean: -0.24252550303936005, mean p set: 0.44692397117614746
loss_pred:0.01609610952436924, decouple_loss:0.00254265358671546
loss_pred:0.01596161164343357, decouple_loss:0.002512948587536812
Iteration: 1137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472585618495941, gen p mean: -0.23966626822948456, mean p set: 0.44783177971839905
loss_pred:0.015834752470254898, decouple_loss:0.0028719520196318626
The modified gen p mean: 0.44703343510627747, gen p mean: -0.2451896369457245, mean p set: 0.4475627839565277The modified gen p mean: 0.4470091462135315, gen p mean: -0.24341925978660583, mean p set: 0.447585791349411
loss_pred:0.015710165724158287, decouple_loss:0.0026045620907098055
loss_pred:0.014574246481060982, decouple_loss:0.002754045883193612
Iteration: 1138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467378556728363, gen p mean: -0.24324317276477814, mean p set: 0.44731974601745605
loss_pred:0.015353916212916374, decouple_loss:0.0024698053020983934
The modified gen p mean: 0.44689545035362244, gen p mean: -0.2473617047071457, mean p set: 0.4474670886993408The modified gen p mean: 0.4468642473220825, gen p mean: -0.24270600080490112, mean p set: 0.44738972187042236
loss_pred:0.015353924594819546, decouple_loss:0.002616551471874118
loss_pred:0.015834646299481392, decouple_loss:0.0026764203794300556
Iteration: 1139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467923939228058, gen p mean: -0.2423476129770279, mean p set: 0.447368860244751
loss_pred:0.016009578481316566, decouple_loss:0.0029900779481977224
The modified gen p mean: 0.4459366798400879, gen p mean: -0.24583180248737335, mean p set: 0.446504145860672
loss_pred:0.01606685481965542, decouple_loss:0.002854712074622512
The modified gen p mean: 0.4473133385181427, gen p mean: -0.24885033071041107, mean p set: 0.4478381872177124
loss_pred:0.015667209401726723, decouple_loss:0.002872730838134885
Iteration: 1140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471028745174408, gen p mean: -0.24924981594085693, mean p set: 0.44767507910728455
loss_pred:0.01528921164572239, decouple_loss:0.0026143803261220455
The modified gen p mean: 0.4475415050983429, gen p mean: -0.24490715563297272, mean p set: 0.4481275677680969
loss_pred:0.015486901625990868, decouple_loss:0.002544150920584798
The modified gen p mean: 0.4471921920776367, gen p mean: -0.24768269062042236, mean p set: 0.44772762060165405
loss_pred:0.014940260909497738, decouple_loss:0.0025969126727432013
2023-04-27 01:47:03 testing...
The modified gen p mean: 0.4482211172580719, gen p mean: -0.2396840900182724, mean p set: 0.44879910349845886
loss_pred:0.017352167516946793, decouple_loss:0.003155768383294344
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24246516823768616, mean p set: 0.4499112665653229
loss_pred:0.017498506233096123, decouple_loss:0.003160113235935569
The modified gen p mean: 0.4492991268634796, gen p mean: -0.24279019236564636, mean p set: 0.4498290419578552
loss_pred:0.017124421894550323, decouple_loss:0.0033895904198288918
WV_1_PC_1_EH_0_PS_30, loss: 0.01748679019510746, avg_mse: 0.025783667340874672
current test mse: 0.025784
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 1141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473986327648163, gen p mean: -0.2423313409090042, mean p set: 0.4479270875453949
loss_pred:0.015195406973361969, decouple_loss:0.0035664825700223446
The modified gen p mean: 0.44789919257164, gen p mean: -0.24640876054763794, mean p set: 0.4484791159629822
loss_pred:0.015467546880245209, decouple_loss:0.0037233540788292885
The modified gen p mean: 0.44662603735923767, gen p mean: -0.24533796310424805, mean p set: 0.4471994936466217
loss_pred:0.01595913991332054, decouple_loss:0.003015549387782812
Iteration: 1142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737696647644043, gen p mean: -0.2429257184267044, mean p set: 0.44790735840797424
loss_pred:0.015530367381870747, decouple_loss:0.0027686641551554203
The modified gen p mean: 0.4482857882976532, gen p mean: -0.238039031624794, mean p set: 0.4488696753978729
loss_pred:0.015027416869997978, decouple_loss:0.002948254346847534
The modified gen p mean: 0.446452260017395, gen p mean: -0.2399221956729889, mean p set: 0.4470299780368805
loss_pred:0.01612664759159088, decouple_loss:0.0029337259475141764
Iteration: 1143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758620858192444, gen p mean: -0.24351459741592407, mean p set: 0.4481112062931061
loss_pred:0.016005611047148705, decouple_loss:0.0033045951277017593
The modified gen p mean: 0.44865939021110535, gen p mean: -0.23730093240737915, mean p set: 0.44924309849739075
loss_pred:0.01567772775888443, decouple_loss:0.003561218036338687
The modified gen p mean: 0.4477511942386627, gen p mean: -0.2443954050540924, mean p set: 0.44832685589790344
loss_pred:0.015384029597043991, decouple_loss:0.002913836622610688
Iteration: 1144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473668336868286, gen p mean: -0.25086966156959534, mean p set: 0.4478895962238312
loss_pred:0.01492494810372591, decouple_loss:0.002881510416045785
The modified gen p mean: 0.44722050428390503, gen p mean: -0.2522393763065338, mean p set: 0.44779151678085327
loss_pred:0.015550978481769562, decouple_loss:0.0029542928095906973
The modified gen p mean: 0.44803479313850403, gen p mean: -0.2553131580352783, mean p set: 0.4486168920993805
loss_pred:0.015393775887787342, decouple_loss:0.002955240895971656
Iteration: 1145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465349018573761, gen p mean: -0.24443291127681732, mean p set: 0.447108656167984
loss_pred:0.014687093906104565, decouple_loss:0.0037833990063518286
The modified gen p mean: 0.4471392035484314, gen p mean: -0.25178512930870056, mean p set: 0.44772061705589294The modified gen p mean: 0.44687238335609436, gen p mean: -0.24711912870407104, mean p set: 0.4474049210548401
loss_pred:0.015387670136988163, decouple_loss:0.002972611226141453
loss_pred:0.015452198684215546, decouple_loss:0.0031875446438789368
Iteration: 1146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474117159843445, gen p mean: -0.2409939020872116, mean p set: 0.44798827171325684
loss_pred:0.014854676090180874, decouple_loss:0.00288646062836051
The modified gen p mean: 0.44717469811439514, gen p mean: -0.2452961802482605, mean p set: 0.4477514624595642The modified gen p mean: 0.4474200904369354, gen p mean: -0.24393430352210999, mean p set: 0.4479469656944275
loss_pred:0.01509158592671156, decouple_loss:0.0028740898706018925
loss_pred:0.01534290611743927, decouple_loss:0.0028757427353411913
Iteration: 1147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476594626903534, gen p mean: -0.2462388426065445, mean p set: 0.4482361972332001
loss_pred:0.015251876786351204, decouple_loss:0.00306501192972064
The modified gen p mean: 0.44881975650787354, gen p mean: -0.23968374729156494, mean p set: 0.4493965804576874The modified gen p mean: 0.4468751847743988, gen p mean: -0.24110521376132965, mean p set: 0.4474024176597595
loss_pred:0.015035895630717278, decouple_loss:0.0029138580430299044
loss_pred:0.015348177403211594, decouple_loss:0.0027447619941085577
Iteration: 1148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486047923564911, gen p mean: -0.24296274781227112, mean p set: 0.449184387922287
loss_pred:0.015063818544149399, decouple_loss:0.002732381457462907
The modified gen p mean: 0.447430819272995, gen p mean: -0.2430180460214615, mean p set: 0.44800853729248047The modified gen p mean: 0.4484320878982544, gen p mean: -0.24714753031730652, mean p set: 0.4489628076553345
loss_pred:0.015383543446660042, decouple_loss:0.0026667858473956585
loss_pred:0.0151338716968894, decouple_loss:0.0029288760852068663
Iteration: 1149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701945781707764, gen p mean: -0.24652566015720367, mean p set: 0.44759422540664673
loss_pred:0.015282253734767437, decouple_loss:0.002738838316872716
The modified gen p mean: 0.4481050968170166, gen p mean: -0.24119143187999725, mean p set: 0.4486709535121918
loss_pred:0.014584428630769253, decouple_loss:0.0029075031634420156
The modified gen p mean: 0.4474300742149353, gen p mean: -0.24591442942619324, mean p set: 0.44795170426368713
loss_pred:0.015455967746675014, decouple_loss:0.0027451221831142902
Iteration: 1150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479931890964508, gen p mean: -0.24046868085861206, mean p set: 0.4485653042793274
loss_pred:0.014617149718105793, decouple_loss:0.0032320115715265274
The modified gen p mean: 0.4480682611465454, gen p mean: -0.23696334660053253, mean p set: 0.4486429989337921The modified gen p mean: 0.44721850752830505, gen p mean: -0.24441584944725037, mean p set: 0.4477385878562927
loss_pred:0.015353476628661156, decouple_loss:0.00345639418810606
loss_pred:0.015628211200237274, decouple_loss:0.0027635046280920506
2023-04-27 01:51:06 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24572469294071198, mean p set: 0.4499112665653229
loss_pred:0.017707668244838715, decouple_loss:0.0033592942636460066
The modified gen p mean: 0.4482245147228241, gen p mean: -0.24263189733028412, mean p set: 0.44879910349845886
loss_pred:0.017641540616750717, decouple_loss:0.002979530952870846
The modified gen p mean: 0.44929778575897217, gen p mean: -0.24557188153266907, mean p set: 0.4498290419578552
loss_pred:0.017293449491262436, decouple_loss:0.0030999311711639166
WV_1_PC_1_EH_0_PS_30, loss: 0.017704864963889122, avg_mse: 0.02620379440486431
current test mse: 0.026204
Iteration: 1151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461832344532013, gen p mean: -0.24175557494163513, mean p set: 0.44675159454345703
loss_pred:0.015963036566972733, decouple_loss:0.002754240296781063
The modified gen p mean: 0.44716304540634155, gen p mean: -0.24463117122650146, mean p set: 0.4476914703845978
loss_pred:0.015472129918634892, decouple_loss:0.0029044130351394415
The modified gen p mean: 0.4478086829185486, gen p mean: -0.2415793091058731, mean p set: 0.4483802020549774
loss_pred:0.01494696643203497, decouple_loss:0.0029477481730282307
Iteration: 1152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482475817203522, gen p mean: -0.2474135309457779, mean p set: 0.44877946376800537
loss_pred:0.014438322745263577, decouple_loss:0.0033187498338520527
The modified gen p mean: 0.4470028281211853, gen p mean: -0.24689209461212158, mean p set: 0.4475743770599365
loss_pred:0.016541412100195885, decouple_loss:0.002745587145909667
The modified gen p mean: 0.4466850757598877, gen p mean: -0.25095659494400024, mean p set: 0.44725939631462097
loss_pred:0.015705140307545662, decouple_loss:0.0032898522913455963
Iteration: 1153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872990250587463, gen p mean: -0.2552764415740967, mean p set: 0.44926023483276367
loss_pred:0.015325038693845272, decouple_loss:0.0029581375420093536
The modified gen p mean: 0.44844335317611694, gen p mean: -0.24943099915981293, mean p set: 0.4490176737308502
loss_pred:0.015120560303330421, decouple_loss:0.0031343288719654083
The modified gen p mean: 0.44766661524772644, gen p mean: -0.25565510988235474, mean p set: 0.44824886322021484
loss_pred:0.015103336423635483, decouple_loss:0.002925294451415539
Iteration: 1154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467985928058624, gen p mean: -0.2559523284435272, mean p set: 0.4473215639591217
loss_pred:0.015498701483011246, decouple_loss:0.0027417519595474005
The modified gen p mean: 0.44618865847587585, gen p mean: -0.24811159074306488, mean p set: 0.44676467776298523
loss_pred:0.014968602918088436, decouple_loss:0.003266716841608286
The modified gen p mean: 0.4469887912273407, gen p mean: -0.25361543893814087, mean p set: 0.44756677746772766
loss_pred:0.015326222404837608, decouple_loss:0.002611715579405427
Iteration: 1155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470803141593933, gen p mean: -0.2520652711391449, mean p set: 0.44765228033065796
loss_pred:0.015538434498012066, decouple_loss:0.0028261085972189903
The modified gen p mean: 0.448001891374588, gen p mean: -0.2537897825241089, mean p set: 0.4485274851322174The modified gen p mean: 0.44694453477859497, gen p mean: -0.2497556060552597, mean p set: 0.4475267231464386
loss_pred:0.015295720659196377, decouple_loss:0.0031599123030900955
loss_pred:0.015296624042093754, decouple_loss:0.0029557086527347565
Iteration: 1156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469930827617645, gen p mean: -0.24669308960437775, mean p set: 0.44756919145584106
loss_pred:0.01616271212697029, decouple_loss:0.0028586320113390684
The modified gen p mean: 0.44647085666656494, gen p mean: -0.25378498435020447, mean p set: 0.44700247049331665The modified gen p mean: 0.4468187987804413, gen p mean: -0.2461172640323639, mean p set: 0.44739410281181335
loss_pred:0.016377640888094902, decouple_loss:0.002848999109119177
loss_pred:0.015593708492815495, decouple_loss:0.0025855430867522955
Iteration: 1157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879886507987976, gen p mean: -0.24561822414398193, mean p set: 0.44937291741371155
loss_pred:0.015206729993224144, decouple_loss:0.0027053127996623516
The modified gen p mean: 0.44641274213790894, gen p mean: -0.24894322454929352, mean p set: 0.4469953179359436
loss_pred:0.015160583890974522, decouple_loss:0.0026069253217428923
The modified gen p mean: 0.4477473497390747, gen p mean: -0.25620609521865845, mean p set: 0.44827136397361755
loss_pred:0.01503961905837059, decouple_loss:0.003428821684792638
Iteration: 1158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473631680011749, gen p mean: -0.2526463270187378, mean p set: 0.44793838262557983
loss_pred:0.015051878988742828, decouple_loss:0.0030070925131440163
The modified gen p mean: 0.44790318608283997, gen p mean: -0.25389155745506287, mean p set: 0.4484758675098419
loss_pred:0.015248945914208889, decouple_loss:0.0028818822465837
The modified gen p mean: 0.44665205478668213, gen p mean: -0.245557963848114, mean p set: 0.4471812844276428
loss_pred:0.015501192770898342, decouple_loss:0.002615812700241804
Iteration: 1159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478003680706024, gen p mean: -0.2379446178674698, mean p set: 0.4483778774738312
loss_pred:0.015149037353694439, decouple_loss:0.003337205620482564
The modified gen p mean: 0.44672271609306335, gen p mean: -0.24500496685504913, mean p set: 0.44729676842689514
loss_pred:0.015315608121454716, decouple_loss:0.003037423826754093
The modified gen p mean: 0.4472772777080536, gen p mean: -0.24754367768764496, mean p set: 0.4478025436401367
loss_pred:0.014989852905273438, decouple_loss:0.002861453453078866
Iteration: 1160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478960633277893, gen p mean: -0.23859192430973053, mean p set: 0.44847285747528076
loss_pred:0.014866086654365063, decouple_loss:0.002931308699771762
The modified gen p mean: 0.44619739055633545, gen p mean: -0.24402126669883728, mean p set: 0.44677630066871643
loss_pred:0.015763672068715096, decouple_loss:0.002580246888101101
The modified gen p mean: 0.4478345215320587, gen p mean: -0.24676202237606049, mean p set: 0.44836175441741943
loss_pred:0.015047078020870686, decouple_loss:0.0029336523730307817
2023-04-27 01:54:30 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24746935069561005, mean p set: 0.4499112665653229
loss_pred:0.017583584412932396, decouple_loss:0.0029622414149343967
The modified gen p mean: 0.4493020176887512, gen p mean: -0.24753360450267792, mean p set: 0.4498290419578552
loss_pred:0.017266737297177315, decouple_loss:0.0027683794032782316
The modified gen p mean: 0.4482303559780121, gen p mean: -0.24446944892406464, mean p set: 0.44879910349845886
loss_pred:0.017686214298009872, decouple_loss:0.002843219554051757
WV_1_PC_1_EH_0_PS_30, loss: 0.01765507645905018, avg_mse: 0.02608119696378708
current test mse: 0.026081
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 1161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481126666069031, gen p mean: -0.249393492937088, mean p set: 0.44863414764404297
loss_pred:0.014947074465453625, decouple_loss:0.002768983133137226
The modified gen p mean: 0.44890639185905457, gen p mean: -0.24218030273914337, mean p set: 0.44948315620422363
loss_pred:0.015495247207581997, decouple_loss:0.0026265045162290335
The modified gen p mean: 0.4471907913684845, gen p mean: -0.24572093784809113, mean p set: 0.447760671377182
loss_pred:0.015461721457540989, decouple_loss:0.002616621321067214
Iteration: 1162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871553778648376, gen p mean: -0.24418722093105316, mean p set: 0.44924619793891907
loss_pred:0.01522817276418209, decouple_loss:0.0028465643990784883
The modified gen p mean: 0.44774043560028076, gen p mean: -0.2440781146287918, mean p set: 0.4483111500740051
The modified gen p mean: 0.4476625919342041, gen p mean: -0.24492889642715454, mean p set: 0.44823670387268066
loss_pred:0.015443474985659122, decouple_loss:0.0028569772839546204
loss_pred:0.01521269604563713, decouple_loss:0.0028848701622337103
Iteration: 1163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491453468799591, gen p mean: -0.2452186793088913, mean p set: 0.4496791362762451
loss_pred:0.01526548620313406, decouple_loss:0.0028021365869790316
The modified gen p mean: 0.4474093019962311, gen p mean: -0.25003963708877563, mean p set: 0.44798991084098816
The modified gen p mean: 0.4488028287887573, gen p mean: -0.24317358434200287, mean p set: 0.4493766129016876
loss_pred:0.01477824430912733, decouple_loss:0.0026279182638972998
loss_pred:0.015200026333332062, decouple_loss:0.0027075360994786024
Iteration: 1164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471472203731537, gen p mean: -0.23999345302581787, mean p set: 0.4476757347583771
loss_pred:0.015239379368722439, decouple_loss:0.002931725000962615
The modified gen p mean: 0.44814226031303406, gen p mean: -0.24229198694229126, mean p set: 0.4487197697162628
The modified gen p mean: 0.44813552498817444, gen p mean: -0.24386106431484222, mean p set: 0.4487130343914032
loss_pred:0.015253824181854725, decouple_loss:0.0034230374731123447
loss_pred:0.015118829905986786, decouple_loss:0.002948024310171604
Iteration: 1165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486245810985565, gen p mean: -0.24184957146644592, mean p set: 0.4491964280605316
loss_pred:0.015103993006050587, decouple_loss:0.0029419863130897284
The modified gen p mean: 0.4463631212711334, gen p mean: -0.23632779717445374, mean p set: 0.4469376802444458
loss_pred:0.015594634227454662, decouple_loss:0.0027679556515067816
The modified gen p mean: 0.44813528656959534, gen p mean: -0.2369445413351059, mean p set: 0.44866541028022766
loss_pred:0.015490061603486538, decouple_loss:0.002690147142857313
Iteration: 1166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919174909591675, gen p mean: -0.23845519125461578, mean p set: 0.44976967573165894
loss_pred:0.014901511371135712, decouple_loss:0.00293816183693707
The modified gen p mean: 0.44792690873146057, gen p mean: -0.24441711604595184, mean p set: 0.4485096037387848
loss_pred:0.01510324701666832, decouple_loss:0.0035157271195203066
The modified gen p mean: 0.4485498070716858, gen p mean: -0.2425125688314438, mean p set: 0.449078768491745
loss_pred:0.014991411939263344, decouple_loss:0.00289490376599133
Iteration: 1167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44993820786476135, gen p mean: -0.24488551914691925, mean p set: 0.4505167305469513
loss_pred:0.015374448150396347, decouple_loss:0.0027895960956811905
The modified gen p mean: 0.446995347738266, gen p mean: -0.2535061538219452, mean p set: 0.44752633571624756The modified gen p mean: 0.44780784845352173, gen p mean: -0.2510111629962921, mean p set: 0.4483746588230133
loss_pred:0.015291756950318813, decouple_loss:0.0031703580170869827
loss_pred:0.014402665197849274, decouple_loss:0.0026817764155566692
Iteration: 1168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731244444847107, gen p mean: -0.2515174150466919, mean p set: 0.4478890001773834
loss_pred:0.015199625864624977, decouple_loss:0.0029722426552325487
The modified gen p mean: 0.44724777340888977, gen p mean: -0.2495054453611374, mean p set: 0.44782590866088867
loss_pred:0.015413315035402775, decouple_loss:0.0027546787168830633
The modified gen p mean: 0.4474412500858307, gen p mean: -0.2591088116168976, mean p set: 0.4479677379131317
loss_pred:0.014596443623304367, decouple_loss:0.00268812314607203
Iteration: 1169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491281807422638, gen p mean: -0.2571429908275604, mean p set: 0.44969815015792847
loss_pred:0.015119828283786774, decouple_loss:0.0028842990286648273
The modified gen p mean: 0.44873395562171936, gen p mean: -0.2611977458000183, mean p set: 0.4493098258972168
loss_pred:0.014736664481461048, decouple_loss:0.003203444182872772
The modified gen p mean: 0.4473404288291931, gen p mean: -0.2634347677230835, mean p set: 0.44786572456359863
loss_pred:0.014752659015357494, decouple_loss:0.002692670561373234
Iteration: 1170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478453993797302, gen p mean: -0.2607463002204895, mean p set: 0.44842419028282166
loss_pred:0.015132430009543896, decouple_loss:0.0026318798772990704
The modified gen p mean: 0.4465130865573883, gen p mean: -0.2623254358768463, mean p set: 0.44709157943725586
loss_pred:0.01505188550800085, decouple_loss:0.002520463429391384
The modified gen p mean: 0.4488227963447571, gen p mean: -0.2655624449253082, mean p set: 0.4493577182292938
loss_pred:0.014372363686561584, decouple_loss:0.00273574679158628
2023-04-27 01:58:35 testing...
The modified gen p mean: 0.44822975993156433, gen p mean: -0.2602837383747101, mean p set: 0.44879910349845886
loss_pred:0.01745137758553028, decouple_loss:0.002820905763655901
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2632235288619995, mean p set: 0.4499112665653229
loss_pred:0.017643874511122704, decouple_loss:0.002871577860787511
The modified gen p mean: 0.4493047893047333, gen p mean: -0.26340410113334656, mean p set: 0.4498290419578552
loss_pred:0.017149100080132484, decouple_loss:0.002994745969772339
WV_1_PC_1_EH_0_PS_30, loss: 0.01755957119166851, avg_mse: 0.025918612256646156
current test mse: 0.025919
Iteration: 1171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677621126174927, gen p mean: -0.2644762396812439, mean p set: 0.4473493695259094
loss_pred:0.01549587119370699, decouple_loss:0.0027512444648891687
The modified gen p mean: 0.4483155906200409, gen p mean: -0.258007675409317, mean p set: 0.4488963484764099
loss_pred:0.01511235348880291, decouple_loss:0.0029762890189886093
The modified gen p mean: 0.44760656356811523, gen p mean: -0.26005977392196655, mean p set: 0.4481384754180908
loss_pred:0.014577502384781837, decouple_loss:0.0027560710441321135
Iteration: 1172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687262177467346, gen p mean: -0.2596189081668854, mean p set: 0.44741132855415344
loss_pred:0.015690715983510017, decouple_loss:0.002972898306325078
The modified gen p mean: 0.44609224796295166, gen p mean: -0.26040443778038025, mean p set: 0.4466628134250641
loss_pred:0.015595702454447746, decouple_loss:0.0027552645187824965
The modified gen p mean: 0.4491357207298279, gen p mean: -0.2647402286529541, mean p set: 0.4497106075286865
loss_pred:0.014986302703619003, decouple_loss:0.002737830625846982
Iteration: 1173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485321044921875, gen p mean: -0.2498929500579834, mean p set: 0.44906049966812134
loss_pred:0.01490012276917696, decouple_loss:0.0025569561403244734
The modified gen p mean: 0.4486754536628723, gen p mean: -0.2574620842933655, mean p set: 0.44924888014793396
loss_pred:0.014913106337189674, decouple_loss:0.00265984027646482
The modified gen p mean: 0.44630226492881775, gen p mean: -0.2537754774093628, mean p set: 0.4468816816806793
loss_pred:0.01582171954214573, decouple_loss:0.0029063948895782232
Iteration: 1174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44927889108657837, gen p mean: -0.24741911888122559, mean p set: 0.4498105049133301
loss_pred:0.015380814671516418, decouple_loss:0.002759708324447274
The modified gen p mean: 0.44818174839019775, gen p mean: -0.25330930948257446, mean p set: 0.4487580358982086
loss_pred:0.01419958658516407, decouple_loss:0.0028588282875716686
The modified gen p mean: 0.44756388664245605, gen p mean: -0.24980603158473969, mean p set: 0.4481406807899475
loss_pred:0.01497103925794363, decouple_loss:0.003099882509559393
Iteration: 1175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500977694988251, gen p mean: -0.2432849109172821, mean p set: 0.4506722390651703
loss_pred:0.0148622440174222, decouple_loss:0.002600482665002346
The modified gen p mean: 0.4470142424106598, gen p mean: -0.24853113293647766, mean p set: 0.44753846526145935The modified gen p mean: 0.4492829144001007, gen p mean: -0.24614565074443817, mean p set: 0.44985491037368774
loss_pred:0.015093619003891945, decouple_loss:0.0024994898121804
loss_pred:0.015401138924062252, decouple_loss:0.0027001192793250084
Iteration: 1176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727227091789246, gen p mean: -0.2447051703929901, mean p set: 0.44784975051879883
loss_pred:0.014439037069678307, decouple_loss:0.0028381531592458487
The modified gen p mean: 0.4482201635837555, gen p mean: -0.254121333360672, mean p set: 0.44880014657974243The modified gen p mean: 0.44788408279418945, gen p mean: -0.24421097338199615, mean p set: 0.44841745495796204
loss_pred:0.014461487531661987, decouple_loss:0.002536486368626356
loss_pred:0.014626172371208668, decouple_loss:0.0027627344243228436
Iteration: 1177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707539677619934, gen p mean: -0.25327417254447937, mean p set: 0.4476434886455536
loss_pred:0.014936955645680428, decouple_loss:0.0028895854484289885
The modified gen p mean: 0.4472660422325134, gen p mean: -0.25425639748573303, mean p set: 0.4477921724319458The modified gen p mean: 0.44899845123291016, gen p mean: -0.2480301856994629, mean p set: 0.4495809078216553
loss_pred:0.015094920992851257, decouple_loss:0.003098421497270465
loss_pred:0.015230963937938213, decouple_loss:0.0031870740931481123
Iteration: 1178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487605094909668, gen p mean: -0.2513379454612732, mean p set: 0.4493320882320404
loss_pred:0.01524345949292183, decouple_loss:0.0027855767402797937
The modified gen p mean: 0.44691601395606995, gen p mean: -0.24953502416610718, mean p set: 0.44749414920806885The modified gen p mean: 0.4489796757698059, gen p mean: -0.24856264889240265, mean p set: 0.44950512051582336
loss_pred:0.01542468462139368, decouple_loss:0.003003267338499427
loss_pred:0.01487028133124113, decouple_loss:0.0026797479949891567
Iteration: 1179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468308091163635, gen p mean: -0.25399038195610046, mean p set: 0.44741183519363403
loss_pred:0.015040934085845947, decouple_loss:0.0032552340999245644
The modified gen p mean: 0.44821783900260925, gen p mean: -0.25223612785339355, mean p set: 0.44878509640693665
loss_pred:0.015243671834468842, decouple_loss:0.003115058410912752
The modified gen p mean: 0.4472164809703827, gen p mean: -0.2509792447090149, mean p set: 0.4477404057979584
loss_pred:0.015279497019946575, decouple_loss:0.00327668571844697
Iteration: 1180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44592106342315674, gen p mean: -0.25017085671424866, mean p set: 0.4464992880821228
loss_pred:0.015610476024448872, decouple_loss:0.0029456058982759714
The modified gen p mean: 0.44962430000305176, gen p mean: -0.249330535531044, mean p set: 0.45020049810409546The modified gen p mean: 0.44785746932029724, gen p mean: -0.24591267108917236, mean p set: 0.44838523864746094
loss_pred:0.014848567545413971, decouple_loss:0.0026324887294322252
loss_pred:0.015533090569078922, decouple_loss:0.0029949615709483624
2023-04-27 02:02:00 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2530633509159088, mean p set: 0.4499112665653229
loss_pred:0.017600541934370995, decouple_loss:0.0036444230936467648
The modified gen p mean: 0.44929707050323486, gen p mean: -0.25355154275894165, mean p set: 0.4498290419578552
loss_pred:0.017220517620444298, decouple_loss:0.003664321033284068
The modified gen p mean: 0.44822001457214355, gen p mean: -0.2506411671638489, mean p set: 0.44879910349845886
loss_pred:0.017497055232524872, decouple_loss:0.0033468599431216717
WV_1_PC_1_EH_0_PS_30, loss: 0.017616964876651764, avg_mse: 0.02599719911813736
current test mse: 0.025997
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 1181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475146532058716, gen p mean: -0.25421714782714844, mean p set: 0.4480864405632019
loss_pred:0.01605927012860775, decouple_loss:0.003917251247912645
The modified gen p mean: 0.4469715356826782, gen p mean: -0.253418892621994, mean p set: 0.44749605655670166
loss_pred:0.01677086390554905, decouple_loss:0.003906601574271917
The modified gen p mean: 0.44628119468688965, gen p mean: -0.25158941745758057, mean p set: 0.4468649923801422
loss_pred:0.016318993642926216, decouple_loss:0.0031516391318291426
Iteration: 1182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466419816017151, gen p mean: -0.25671708583831787, mean p set: 0.44716861844062805
loss_pred:0.016034863889217377, decouple_loss:0.00283819530159235
The modified gen p mean: 0.44589105248451233, gen p mean: -0.2555929124355316, mean p set: 0.4464685022830963
The modified gen p mean: 0.4477519392967224, gen p mean: -0.25818219780921936, mean p set: 0.4483300447463989
loss_pred:0.016834644600749016, decouple_loss:0.003004855941981077
loss_pred:0.016229772940278053, decouple_loss:0.003175899852067232
Iteration: 1183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720664620399475, gen p mean: -0.2591770887374878, mean p set: 0.44773682951927185
loss_pred:0.01555783860385418, decouple_loss:0.0033857333473861217
The modified gen p mean: 0.44639045000076294, gen p mean: -0.2601332366466522, mean p set: 0.44696730375289917
The modified gen p mean: 0.4456518590450287, gen p mean: -0.2609440088272095, mean p set: 0.44622352719306946
loss_pred:0.01588423363864422, decouple_loss:0.0034559641499072313
loss_pred:0.01629621721804142, decouple_loss:0.003199912142008543
Iteration: 1184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465716779232025, gen p mean: -0.2622789144515991, mean p set: 0.44709739089012146
loss_pred:0.01695876568555832, decouple_loss:0.0030867045279592276
The modified gen p mean: 0.4455704391002655, gen p mean: -0.2619623839855194, mean p set: 0.4461430609226227
The modified gen p mean: 0.44731244444847107, gen p mean: -0.2618705928325653, mean p set: 0.447883665561676
loss_pred:0.016909509897232056, decouple_loss:0.002955237403512001
loss_pred:0.016896089538931847, decouple_loss:0.002899797633290291
Iteration: 1185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464280605316162, gen p mean: -0.2626231610774994, mean p set: 0.4469989240169525
loss_pred:0.016299251466989517, decouple_loss:0.0030764867551624775
The modified gen p mean: 0.4462178647518158, gen p mean: -0.26295146346092224, mean p set: 0.44674646854400635The modified gen p mean: 0.4457230269908905, gen p mean: -0.26320162415504456, mean p set: 0.4462953209877014
loss_pred:0.01535764243453741, decouple_loss:0.0031976033933460712
loss_pred:0.01588578335940838, decouple_loss:0.003069112775847316
Iteration: 1186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694802165031433, gen p mean: -0.26203349232673645, mean p set: 0.44752398133277893
loss_pred:0.015573836863040924, decouple_loss:0.0027038429398089647
The modified gen p mean: 0.4472085237503052, gen p mean: -0.2588108777999878, mean p set: 0.44772863388061523The modified gen p mean: 0.44785839319229126, gen p mean: -0.25966864824295044, mean p set: 0.4484312832355499
loss_pred:0.016073523089289665, decouple_loss:0.002947620116174221
loss_pred:0.015879204496741295, decouple_loss:0.0026414438616484404
Iteration: 1187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459819495677948, gen p mean: -0.25485095381736755, mean p set: 0.4465586841106415
loss_pred:0.016391200944781303, decouple_loss:0.003063289914280176
The modified gen p mean: 0.4474286735057831, gen p mean: -0.2583339214324951, mean p set: 0.4479503035545349The modified gen p mean: 0.44664764404296875, gen p mean: -0.26058241724967957, mean p set: 0.44722431898117065
loss_pred:0.015775546431541443, decouple_loss:0.0031116153113543987
loss_pred:0.015033286064863205, decouple_loss:0.0029371583368629217
Iteration: 1188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641318917274475, gen p mean: -0.25255924463272095, mean p set: 0.4469858705997467
loss_pred:0.01627722568809986, decouple_loss:0.0030536118429154158
The modified gen p mean: 0.4469318985939026, gen p mean: -0.24907810986042023, mean p set: 0.44745591282844543The modified gen p mean: 0.4474351704120636, gen p mean: -0.25208449363708496, mean p set: 0.4480128884315491
loss_pred:0.017113784328103065, decouple_loss:0.0026916968636214733
loss_pred:0.016146712005138397, decouple_loss:0.0026154096703976393
Iteration: 1189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469584822654724, gen p mean: -0.2479703426361084, mean p set: 0.4475388824939728
loss_pred:0.014702515676617622, decouple_loss:0.003197834361344576
The modified gen p mean: 0.4464517831802368, gen p mean: -0.24767296016216278, mean p set: 0.44698208570480347The modified gen p mean: 0.4465666115283966, gen p mean: -0.2508838176727295, mean p set: 0.44714680314064026
loss_pred:0.016024135053157806, decouple_loss:0.0032762635964900255
loss_pred:0.01697593927383423, decouple_loss:0.0029643550515174866
Iteration: 1190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473583400249481, gen p mean: -0.24862587451934814, mean p set: 0.4479365348815918
loss_pred:0.016504565253853798, decouple_loss:0.0027883166912943125
The modified gen p mean: 0.4475410580635071, gen p mean: -0.251755952835083, mean p set: 0.4480704963207245
The modified gen p mean: 0.44668638706207275, gen p mean: -0.2563997209072113, mean p set: 0.44725584983825684
loss_pred:0.015692899003624916, decouple_loss:0.0027462937869131565
loss_pred:0.016255345195531845, decouple_loss:0.0033703255467116833
2023-04-27 02:06:11 testing...
The modified gen p mean: 0.44821837544441223, gen p mean: -0.24803821742534637, mean p set: 0.44879910349845886
loss_pred:0.017485639080405235, decouple_loss:0.002777673304080963
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2508459687232971, mean p set: 0.4499112665653229
loss_pred:0.017578333616256714, decouple_loss:0.0028532673604786396
The modified gen p mean: 0.44930872321128845, gen p mean: -0.2510276138782501, mean p set: 0.4498290419578552
loss_pred:0.01722291111946106, decouple_loss:0.002736324444413185
WV_1_PC_1_EH_0_PS_30, loss: 0.017568416893482208, avg_mse: 0.025943728163838387
current test mse: 0.025944
Iteration: 1191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461590349674225, gen p mean: -0.25181835889816284, mean p set: 0.4467359483242035
loss_pred:0.01624273881316185, decouple_loss:0.0027636338490992785
The modified gen p mean: 0.4472682774066925, gen p mean: -0.25492045283317566, mean p set: 0.4478432536125183
loss_pred:0.016202228143811226, decouple_loss:0.002627359004691243
The modified gen p mean: 0.44691118597984314, gen p mean: -0.2564431130886078, mean p set: 0.44743674993515015
loss_pred:0.015759669244289398, decouple_loss:0.0024745140690356493
Iteration: 1192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44585755467414856, gen p mean: -0.2497604787349701, mean p set: 0.44638508558273315
loss_pred:0.015691090375185013, decouple_loss:0.0027541553135961294
The modified gen p mean: 0.44687312841415405, gen p mean: -0.24737831950187683, mean p set: 0.44745174050331116
loss_pred:0.016295896843075752, decouple_loss:0.0031743133440613747
The modified gen p mean: 0.44700995087623596, gen p mean: -0.24893757700920105, mean p set: 0.4475901126861572
loss_pred:0.016288915649056435, decouple_loss:0.003062305273488164
Iteration: 1193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467369318008423, gen p mean: -0.2541100084781647, mean p set: 0.44726207852363586
loss_pred:0.015916617587208748, decouple_loss:0.0029656579717993736
The modified gen p mean: 0.44687578082084656, gen p mean: -0.2574710249900818, mean p set: 0.44745466113090515
loss_pred:0.015628160908818245, decouple_loss:0.0027989710215479136
The modified gen p mean: 0.446460485458374, gen p mean: -0.2502112090587616, mean p set: 0.44702792167663574
loss_pred:0.015928976237773895, decouple_loss:0.0026738718152046204
Iteration: 1194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44626182317733765, gen p mean: -0.24988007545471191, mean p set: 0.44678789377212524
loss_pred:0.015202615410089493, decouple_loss:0.003056806279346347
The modified gen p mean: 0.44612976908683777, gen p mean: -0.2465251237154007, mean p set: 0.446708619594574
loss_pred:0.015848543494939804, decouple_loss:0.0029538399539887905
The modified gen p mean: 0.44648823142051697, gen p mean: -0.25473645329475403, mean p set: 0.44706523418426514
loss_pred:0.015810120850801468, decouple_loss:0.002942279214039445
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44662439823150635, gen p mean: -0.2469291239976883, mean p set: 0.4472024440765381
loss_pred:0.0160036813467741, decouple_loss:0.0029924786649644375
The modified gen p mean: 0.44762173295021057, gen p mean: -0.24798758327960968, mean p set: 0.44819650053977966The modified gen p mean: 0.446071982383728, gen p mean: -0.25038036704063416, mean p set: 0.44659891724586487
loss_pred:0.015496640466153622, decouple_loss:0.0028056646697223186
loss_pred:0.016181694343686104, decouple_loss:0.002955012023448944
Iteration: 1196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689705967903137, gen p mean: -0.2586452066898346, mean p set: 0.4474724233150482
loss_pred:0.01604933850467205, decouple_loss:0.002943128813058138
The modified gen p mean: 0.44764062762260437, gen p mean: -0.24971716105937958, mean p set: 0.44821488857269287The modified gen p mean: 0.44756588339805603, gen p mean: -0.2503826916217804, mean p set: 0.4480966627597809
loss_pred:0.01590210758149624, decouple_loss:0.002712399000301957
loss_pred:0.015951458364725113, decouple_loss:0.002674412215128541
Iteration: 1197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44655102491378784, gen p mean: -0.25998497009277344, mean p set: 0.4471304714679718
loss_pred:0.016200510784983635, decouple_loss:0.0027892887592315674
The modified gen p mean: 0.44719401001930237, gen p mean: -0.2638361155986786, mean p set: 0.4477214217185974The modified gen p mean: 0.44698747992515564, gen p mean: -0.25909411907196045, mean p set: 0.44756782054901123
loss_pred:0.015442999079823494, decouple_loss:0.002565408358350396
loss_pred:0.015799930319190025, decouple_loss:0.002588313538581133
Iteration: 1198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454940855503082, gen p mean: -0.256173700094223, mean p set: 0.4460710883140564
loss_pred:0.01554742269217968, decouple_loss:0.0035865469835698605
The modified gen p mean: 0.4471358060836792, gen p mean: -0.2599114179611206, mean p set: 0.4476989209651947The modified gen p mean: 0.44715744256973267, gen p mean: -0.2576940357685089, mean p set: 0.44768035411834717
loss_pred:0.015904800966382027, decouple_loss:0.0031461019534617662
loss_pred:0.015550747513771057, decouple_loss:0.003707053605467081
Iteration: 1199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44650694727897644, gen p mean: -0.255755752325058, mean p set: 0.4470832645893097
loss_pred:0.015720536932349205, decouple_loss:0.0028217986691743135
The modified gen p mean: 0.4462502598762512, gen p mean: -0.25756093859672546, mean p set: 0.4468272626399994
loss_pred:0.01635548286139965, decouple_loss:0.003107542172074318
The modified gen p mean: 0.4474591314792633, gen p mean: -0.25411662459373474, mean p set: 0.4479900598526001
loss_pred:0.016512444242835045, decouple_loss:0.002821624744683504
Iteration: 1200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747161865234375, gen p mean: -0.2598899304866791, mean p set: 0.4480500817298889
loss_pred:0.015044443309307098, decouple_loss:0.0034757324028760195
The modified gen p mean: 0.4464331567287445, gen p mean: -0.2569408714771271, mean p set: 0.44700896739959717
loss_pred:0.015863729640841484, decouple_loss:0.0032344707287847996
The modified gen p mean: 0.44649338722229004, gen p mean: -0.2516123354434967, mean p set: 0.4470199644565582
loss_pred:0.0156245781108737, decouple_loss:0.0034120811615139246
2023-04-27 02:09:36 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2559680938720703, mean p set: 0.4499112665653229
loss_pred:0.017527850344777107, decouple_loss:0.003112221136689186
The modified gen p mean: 0.4493040144443512, gen p mean: -0.25599998235702515, mean p set: 0.4498290419578552
loss_pred:0.017135780304670334, decouple_loss:0.002928667701780796
The modified gen p mean: 0.44821810722351074, gen p mean: -0.25298187136650085, mean p set: 0.44879910349845886
loss_pred:0.017432888969779015, decouple_loss:0.0029657292179763317
WV_1_PC_1_EH_0_PS_30, loss: 0.017515618354082108, avg_mse: 0.025771938264369965
current test mse: 0.025772
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 1201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675302505493164, gen p mean: -0.25777468085289, mean p set: 0.44728177785873413
loss_pred:0.01680927723646164, decouple_loss:0.002972234971821308
The modified gen p mean: 0.44788023829460144, gen p mean: -0.25558313727378845, mean p set: 0.44846174120903015
loss_pred:0.01603158377110958, decouple_loss:0.0029382924549281597
The modified gen p mean: 0.4476291239261627, gen p mean: -0.2528984546661377, mean p set: 0.44820234179496765
loss_pred:0.01634684018790722, decouple_loss:0.002991660963743925
Iteration: 1202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468580186367035, gen p mean: -0.24812830984592438, mean p set: 0.44737815856933594
loss_pred:0.015937142074108124, decouple_loss:0.003132155165076256
The modified gen p mean: 0.44626930356025696, gen p mean: -0.25622233748435974, mean p set: 0.4468388855457306
The modified gen p mean: 0.4474945068359375, gen p mean: -0.25553780794143677, mean p set: 0.4480628967285156
loss_pred:0.016206759959459305, decouple_loss:0.0031697486992925406
loss_pred:0.01602150872349739, decouple_loss:0.003872935427352786
Iteration: 1203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484010636806488, gen p mean: -0.2460956871509552, mean p set: 0.4489316940307617
loss_pred:0.01543720718473196, decouple_loss:0.0033814881462603807
The modified gen p mean: 0.4474528133869171, gen p mean: -0.2471895068883896, mean p set: 0.44803139567375183
The modified gen p mean: 0.4468326270580292, gen p mean: -0.25188693404197693, mean p set: 0.4474082589149475
loss_pred:0.016236696392297745, decouple_loss:0.0031416851561516523
loss_pred:0.016822244971990585, decouple_loss:0.003250221721827984
Iteration: 1204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483771026134491, gen p mean: -0.25484412908554077, mean p set: 0.44890403747558594
loss_pred:0.015838030725717545, decouple_loss:0.0030741854570806026
The modified gen p mean: 0.448148250579834, gen p mean: -0.25478747487068176, mean p set: 0.4487267732620239
The modified gen p mean: 0.44676387310028076, gen p mean: -0.2524911165237427, mean p set: 0.44733917713165283
loss_pred:0.01603316329419613, decouple_loss:0.0031335093080997467
loss_pred:0.015916479751467705, decouple_loss:0.0030600675381720066
Iteration: 1205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767269492149353, gen p mean: -0.25465038418769836, mean p set: 0.4482575058937073
loss_pred:0.016041025519371033, decouple_loss:0.003439479973167181
The modified gen p mean: 0.44682037830352783, gen p mean: -0.2587200701236725, mean p set: 0.4473494589328766The modified gen p mean: 0.44840243458747864, gen p mean: -0.25475794076919556, mean p set: 0.44897395372390747
loss_pred:0.015856614336371422, decouple_loss:0.003196093952283263
loss_pred:0.016981875523924828, decouple_loss:0.0028983771335333586
Iteration: 1206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472610652446747, gen p mean: -0.24364489316940308, mean p set: 0.4478318989276886
loss_pred:0.01642714813351631, decouple_loss:0.0029978081583976746
The modified gen p mean: 0.4475744664669037, gen p mean: -0.2448371797800064, mean p set: 0.4481060206890106The modified gen p mean: 0.4489172101020813, gen p mean: -0.2489597499370575, mean p set: 0.4494958221912384
loss_pred:0.015864107757806778, decouple_loss:0.0032626299653202295
loss_pred:0.016397258266806602, decouple_loss:0.0030938247218728065
Iteration: 1207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739043712615967, gen p mean: -0.24145594239234924, mean p set: 0.4479648470878601
loss_pred:0.015660570934414864, decouple_loss:0.0034235010389238596
The modified gen p mean: 0.44700151681900024, gen p mean: -0.2442653626203537, mean p set: 0.44753316044807434The modified gen p mean: 0.44647225737571716, gen p mean: -0.250722199678421, mean p set: 0.44703981280326843
loss_pred:0.016051869839429855, decouple_loss:0.0038309970404952765
loss_pred:0.016888411715626717, decouple_loss:0.003523404709994793
Iteration: 1208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468100965023041, gen p mean: -0.24030621349811554, mean p set: 0.44738900661468506
loss_pred:0.015274498611688614, decouple_loss:0.0030237112659960985
The modified gen p mean: 0.4463823437690735, gen p mean: -0.24235683679580688, mean p set: 0.4469609558582306
loss_pred:0.015112451277673244, decouple_loss:0.002937039127573371
The modified gen p mean: 0.4469066858291626, gen p mean: -0.24156948924064636, mean p set: 0.4474294185638428
loss_pred:0.015037410892546177, decouple_loss:0.0029014006722718477
Iteration: 1209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464249312877655, gen p mean: -0.25010165572166443, mean p set: 0.44699788093566895
loss_pred:0.01602894812822342, decouple_loss:0.003127030562609434
The modified gen p mean: 0.446196973323822, gen p mean: -0.25150802731513977, mean p set: 0.44677209854125977
loss_pred:0.016026128083467484, decouple_loss:0.003047386882826686
The modified gen p mean: 0.44758763909339905, gen p mean: -0.24742649495601654, mean p set: 0.4481104910373688
loss_pred:0.015397079288959503, decouple_loss:0.003432583762332797
Iteration: 1210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44650915265083313, gen p mean: -0.24834102392196655, mean p set: 0.4470820426940918
loss_pred:0.01575605385005474, decouple_loss:0.003192614996805787
The modified gen p mean: 0.44624581933021545, gen p mean: -0.25064513087272644, mean p set: 0.4468221068382263
loss_pred:0.01588071696460247, decouple_loss:0.00305302650667727
The modified gen p mean: 0.4493604898452759, gen p mean: -0.24749332666397095, mean p set: 0.44989389181137085
loss_pred:0.01522938534617424, decouple_loss:0.0032904744148254395
2023-04-27 02:13:39 testing...
The modified gen p mean: 0.44822460412979126, gen p mean: -0.24596862494945526, mean p set: 0.44879910349845886
loss_pred:0.01755727082490921, decouple_loss:0.0032192207872867584
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2486884593963623, mean p set: 0.4499112665653229
loss_pred:0.017646808177232742, decouple_loss:0.003152119927108288
The modified gen p mean: 0.4492928683757782, gen p mean: -0.2486957460641861, mean p set: 0.4498290419578552
loss_pred:0.01725102588534355, decouple_loss:0.0033034649677574635
WV_1_PC_1_EH_0_PS_30, loss: 0.01764628291130066, avg_mse: 0.026123246178030968
current test mse: 0.026123
Iteration: 1211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656896591186523, gen p mean: -0.24654266238212585, mean p set: 0.44714486598968506
loss_pred:0.014798144809901714, decouple_loss:0.00305343559011817
The modified gen p mean: 0.44822609424591064, gen p mean: -0.25024402141571045, mean p set: 0.448797345161438
loss_pred:0.015903938561677933, decouple_loss:0.002911309478804469
The modified gen p mean: 0.4491971731185913, gen p mean: -0.24725855886936188, mean p set: 0.4497283697128296
loss_pred:0.015435129404067993, decouple_loss:0.002971758134663105
Iteration: 1212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475501775741577, gen p mean: -0.25467154383659363, mean p set: 0.44807443022727966
loss_pred:0.01520366221666336, decouple_loss:0.0033016526140272617
The modified gen p mean: 0.44678470492362976, gen p mean: -0.251980721950531, mean p set: 0.44736534357070923
loss_pred:0.01650453358888626, decouple_loss:0.003665037453174591
The modified gen p mean: 0.4476655125617981, gen p mean: -0.2549877166748047, mean p set: 0.4482457637786865
loss_pred:0.01545492373406887, decouple_loss:0.003521066391840577
Iteration: 1213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682908058166504, gen p mean: -0.24459831416606903, mean p set: 0.4473569989204407
loss_pred:0.01504250057041645, decouple_loss:0.002997454022988677
The modified gen p mean: 0.4465250074863434, gen p mean: -0.25156334042549133, mean p set: 0.4471015930175781
loss_pred:0.016902804374694824, decouple_loss:0.0027650143019855022
The modified gen p mean: 0.4474509358406067, gen p mean: -0.2428406924009323, mean p set: 0.44802284240722656
loss_pred:0.01534977275878191, decouple_loss:0.0030558337457478046
Iteration: 1214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796937704086304, gen p mean: -0.24035808444023132, mean p set: 0.4484897553920746
loss_pred:0.015757272019982338, decouple_loss:0.003448141971603036
The modified gen p mean: 0.4471818506717682, gen p mean: -0.23907849192619324, mean p set: 0.4477604627609253
loss_pred:0.016075987368822098, decouple_loss:0.003197274636477232
The modified gen p mean: 0.44821789860725403, gen p mean: -0.24642032384872437, mean p set: 0.4487859904766083
loss_pred:0.015789704397320747, decouple_loss:0.0031756991520524025
Iteration: 1215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695356488227844, gen p mean: -0.24078281223773956, mean p set: 0.44752857089042664
loss_pred:0.015513252466917038, decouple_loss:0.0030179128516465425
The modified gen p mean: 0.44637179374694824, gen p mean: -0.24627698957920074, mean p set: 0.4469473958015442The modified gen p mean: 0.44808176159858704, gen p mean: -0.23936302959918976, mean p set: 0.44861525297164917
loss_pred:0.016095180064439774, decouple_loss:0.0027026247698813677
loss_pred:0.016306960955262184, decouple_loss:0.003027944825589657
Iteration: 1216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657278060913086, gen p mean: -0.23845525085926056, mean p set: 0.4471484422683716
loss_pred:0.015253434889018536, decouple_loss:0.003173338482156396
The modified gen p mean: 0.44682469964027405, gen p mean: -0.243810772895813, mean p set: 0.4473989009857178The modified gen p mean: 0.44956183433532715, gen p mean: -0.2414926290512085, mean p set: 0.4500883221626282
loss_pred:0.016784610226750374, decouple_loss:0.003204694716259837
loss_pred:0.015171978622674942, decouple_loss:0.003179596271365881
Iteration: 1217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852307438850403, gen p mean: -0.2397032082080841, mean p set: 0.449098140001297
loss_pred:0.01581568270921707, decouple_loss:0.002807257231324911
The modified gen p mean: 0.44719022512435913, gen p mean: -0.24165508151054382, mean p set: 0.4477183520793915The modified gen p mean: 0.44842615723609924, gen p mean: -0.2411772906780243, mean p set: 0.44899824261665344
loss_pred:0.015398013405501842, decouple_loss:0.002741826931014657
loss_pred:0.016832197085022926, decouple_loss:0.002660818863660097
Iteration: 1218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470670223236084, gen p mean: -0.23493628203868866, mean p set: 0.4476413428783417
loss_pred:0.015571100637316704, decouple_loss:0.0025099264457821846
The modified gen p mean: 0.44733190536499023, gen p mean: -0.24013212323188782, mean p set: 0.4478605389595032The modified gen p mean: 0.44693949818611145, gen p mean: -0.2360936552286148, mean p set: 0.44751542806625366
loss_pred:0.01528398972004652, decouple_loss:0.0027009653858840466
loss_pred:0.0163468848913908, decouple_loss:0.0026692738756537437
Iteration: 1219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753965735435486, gen p mean: -0.2459048330783844, mean p set: 0.4481140077114105
loss_pred:0.0152754420414567, decouple_loss:0.0029013867024332285
The modified gen p mean: 0.4474082291126251, gen p mean: -0.2426922470331192, mean p set: 0.44798544049263
loss_pred:0.016272442415356636, decouple_loss:0.002689289627596736
The modified gen p mean: 0.4469214677810669, gen p mean: -0.24487827718257904, mean p set: 0.44744372367858887
loss_pred:0.0159610565751791, decouple_loss:0.0027783066034317017
Iteration: 1220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447917103767395, gen p mean: -0.24357852339744568, mean p set: 0.4484971761703491
loss_pred:0.01527421921491623, decouple_loss:0.0026173663791269064
The modified gen p mean: 0.44658607244491577, gen p mean: -0.23993703722953796, mean p set: 0.4471592903137207
loss_pred:0.01547754742205143, decouple_loss:0.0025987799745053053
The modified gen p mean: 0.4476009011268616, gen p mean: -0.24141031503677368, mean p set: 0.44813334941864014
loss_pred:0.015553095377981663, decouple_loss:0.002716965973377228
2023-04-27 02:17:04 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.23476244509220123, mean p set: 0.4499112665653229
loss_pred:0.017655767500400543, decouple_loss:0.003024851670488715
The modified gen p mean: 0.44929853081703186, gen p mean: -0.23434999585151672, mean p set: 0.4498290419578552
loss_pred:0.017300723120570183, decouple_loss:0.0030886586755514145
The modified gen p mean: 0.4482266306877136, gen p mean: -0.23172925412654877, mean p set: 0.44879910349845886
loss_pred:0.017480406910181046, decouple_loss:0.002840158063918352
WV_1_PC_1_EH_0_PS_30, loss: 0.017628194764256477, avg_mse: 0.025988679379224777
current test mse: 0.025989
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 1221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483584761619568, gen p mean: -0.2354116588830948, mean p set: 0.44888943433761597
loss_pred:0.016417203471064568, decouple_loss:0.002753778826445341
The modified gen p mean: 0.4464521110057831, gen p mean: -0.2357998639345169, mean p set: 0.44702646136283875
loss_pred:0.016185693442821503, decouple_loss:0.0027097254060208797
The modified gen p mean: 0.4469411373138428, gen p mean: -0.2368132323026657, mean p set: 0.44751712679862976
loss_pred:0.0167526938021183, decouple_loss:0.002968828659504652
Iteration: 1222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660988450050354, gen p mean: -0.23843303322792053, mean p set: 0.44713470339775085
loss_pred:0.016493508592247963, decouple_loss:0.0025439525488764048
The modified gen p mean: 0.44558578729629517, gen p mean: -0.23372848331928253, mean p set: 0.44616246223449707
The modified gen p mean: 0.44635114073753357, gen p mean: -0.23965294659137726, mean p set: 0.4469307065010071
loss_pred:0.016570087522268295, decouple_loss:0.002864493988454342
loss_pred:0.01756073720753193, decouple_loss:0.0027026617899537086
Iteration: 1223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457859396934509, gen p mean: -0.24340908229351044, mean p set: 0.4463140368461609
loss_pred:0.016104480251669884, decouple_loss:0.002794223837554455
The modified gen p mean: 0.44614216685295105, gen p mean: -0.243920236825943, mean p set: 0.4467202425003052
The modified gen p mean: 0.44661885499954224, gen p mean: -0.24860967695713043, mean p set: 0.4471932351589203
loss_pred:0.016415242105722427, decouple_loss:0.002724424935877323
loss_pred:0.017000745981931686, decouple_loss:0.002718587638810277
Iteration: 1224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447734534740448, gen p mean: -0.2534523904323578, mean p set: 0.4482622444629669
loss_pred:0.01657172106206417, decouple_loss:0.0029262385796755552
The modified gen p mean: 0.44740521907806396, gen p mean: -0.2503696084022522, mean p set: 0.4479850232601166
The modified gen p mean: 0.4461425542831421, gen p mean: -0.2489975541830063, mean p set: 0.44671353697776794
loss_pred:0.01636958308517933, decouple_loss:0.0027744928374886513
loss_pred:0.01633441261947155, decouple_loss:0.002751265885308385
Iteration: 1225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472964406013489, gen p mean: -0.24878188967704773, mean p set: 0.44787484407424927
loss_pred:0.01593521237373352, decouple_loss:0.002816051710397005
The modified gen p mean: 0.4455065131187439, gen p mean: -0.2562258541584015, mean p set: 0.4460800588130951
loss_pred:0.0160838533192873, decouple_loss:0.002824520692229271
The modified gen p mean: 0.4460221529006958, gen p mean: -0.25157612562179565, mean p set: 0.44655176997184753
loss_pred:0.016983000561594963, decouple_loss:0.0026610130444169044
Iteration: 1226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468819797039032, gen p mean: -0.2503224015235901, mean p set: 0.4474559724330902
loss_pred:0.015896957367658615, decouple_loss:0.003113896120339632
The modified gen p mean: 0.44793015718460083, gen p mean: -0.24968820810317993, mean p set: 0.4484979510307312
loss_pred:0.01667090691626072, decouple_loss:0.0028413240797817707
The modified gen p mean: 0.44645628333091736, gen p mean: -0.2531096935272217, mean p set: 0.4469846189022064
loss_pred:0.016762541607022285, decouple_loss:0.0028791388031095266
Iteration: 1227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460988938808441, gen p mean: -0.24839651584625244, mean p set: 0.44667407870292664
loss_pred:0.01669393666088581, decouple_loss:0.00261478777974844
The modified gen p mean: 0.4465341866016388, gen p mean: -0.24659349024295807, mean p set: 0.447105348110199The modified gen p mean: 0.44641000032424927, gen p mean: -0.24746538698673248, mean p set: 0.4469420909881592
loss_pred:0.016248606145381927, decouple_loss:0.002706891391426325
loss_pred:0.016910608857870102, decouple_loss:0.0027480795979499817
Iteration: 1228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453839361667633, gen p mean: -0.24995644390583038, mean p set: 0.44596222043037415
loss_pred:0.016142670065164566, decouple_loss:0.0027738006319850683
The modified gen p mean: 0.44755271077156067, gen p mean: -0.24374230206012726, mean p set: 0.44813206791877747
loss_pred:0.0162808895111084, decouple_loss:0.0026443435344845057
The modified gen p mean: 0.44665059447288513, gen p mean: -0.25056785345077515, mean p set: 0.4471801817417145
loss_pred:0.016998834908008575, decouple_loss:0.0026208744384348392
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44582825899124146, gen p mean: -0.23755094408988953, mean p set: 0.4464031159877777
loss_pred:0.01582305319607258, decouple_loss:0.002678793389350176
The modified gen p mean: 0.4467124938964844, gen p mean: -0.2360205203294754, mean p set: 0.4472399353981018The modified gen p mean: 0.4467298090457916, gen p mean: -0.23957259953022003, mean p set: 0.4473114311695099
loss_pred:0.015351125039160252, decouple_loss:0.0029362866189330816
loss_pred:0.016382718458771706, decouple_loss:0.0027171007823199034
Iteration: 1230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456612467765808, gen p mean: -0.2404116690158844, mean p set: 0.4462362825870514
loss_pred:0.015766695141792297, decouple_loss:0.002587240654975176
The modified gen p mean: 0.4458494484424591, gen p mean: -0.24001985788345337, mean p set: 0.4463808834552765The modified gen p mean: 0.44734299182891846, gen p mean: -0.23984643816947937, mean p set: 0.447918564081192
loss_pred:0.015575754456222057, decouple_loss:0.0027811862528324127
loss_pred:0.016123251989483833, decouple_loss:0.002631345996633172
2023-04-27 02:21:10 testing...
The modified gen p mean: 0.4482191205024719, gen p mean: -0.24140764772891998, mean p set: 0.44879910349845886
loss_pred:0.017427317798137665, decouple_loss:0.002776163397356868
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2441636621952057, mean p set: 0.4499112665653229
loss_pred:0.017549287527799606, decouple_loss:0.002889083232730627
The modified gen p mean: 0.44930383563041687, gen p mean: -0.2441442906856537, mean p set: 0.4498290419578552
loss_pred:0.01713516004383564, decouple_loss:0.0028338278643786907
WV_1_PC_1_EH_0_PS_30, loss: 0.017512239515781403, avg_mse: 0.025871580466628075
current test mse: 0.025872
Iteration: 1231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464414715766907, gen p mean: -0.24142426252365112, mean p set: 0.4470142424106598
loss_pred:0.01575668901205063, decouple_loss:0.002730041742324829
The modified gen p mean: 0.446397602558136, gen p mean: -0.24760253727436066, mean p set: 0.4469722807407379
loss_pred:0.015910454094409943, decouple_loss:0.002563031390309334
The modified gen p mean: 0.4478955566883087, gen p mean: -0.24580121040344238, mean p set: 0.4484235644340515
loss_pred:0.015758266672492027, decouple_loss:0.0026080897077918053
Iteration: 1232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464026391506195, gen p mean: -0.25007379055023193, mean p set: 0.44692856073379517
loss_pred:0.01572665385901928, decouple_loss:0.0027955889236181974
The modified gen p mean: 0.4479333758354187, gen p mean: -0.25232890248298645, mean p set: 0.44851207733154297
loss_pred:0.015690738335251808, decouple_loss:0.0028832820244133472
The modified gen p mean: 0.44637471437454224, gen p mean: -0.2523355782032013, mean p set: 0.44695183634757996
loss_pred:0.016246534883975983, decouple_loss:0.002733861329033971
Iteration: 1233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459117352962494, gen p mean: -0.252918541431427, mean p set: 0.44643494486808777
loss_pred:0.016003569588065147, decouple_loss:0.0024824689608067274
The modified gen p mean: 0.44708606600761414, gen p mean: -0.2504296600818634, mean p set: 0.44766902923583984
loss_pred:0.01600840501487255, decouple_loss:0.002621718682348728
The modified gen p mean: 0.44596099853515625, gen p mean: -0.25202715396881104, mean p set: 0.44653645157814026
loss_pred:0.01537054218351841, decouple_loss:0.002543453359976411
Iteration: 1234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461682438850403, gen p mean: -0.24443966150283813, mean p set: 0.44669607281684875
loss_pred:0.015591654926538467, decouple_loss:0.0029863875824958086
The modified gen p mean: 0.4458253085613251, gen p mean: -0.24896468222141266, mean p set: 0.44640329480171204
loss_pred:0.016343330964446068, decouple_loss:0.0028739836998283863
The modified gen p mean: 0.44750839471817017, gen p mean: -0.24595744907855988, mean p set: 0.44807806611061096
loss_pred:0.016546793282032013, decouple_loss:0.0029352500569075346
Iteration: 1235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774574041366577, gen p mean: -0.24878129363059998, mean p set: 0.448323518037796
loss_pred:0.01639448292553425, decouple_loss:0.002499152207747102
The modified gen p mean: 0.4464452862739563, gen p mean: -0.24992290139198303, mean p set: 0.4470173120498657The modified gen p mean: 0.4474572539329529, gen p mean: -0.24759452044963837, mean p set: 0.44799020886421204
loss_pred:0.015935856848955154, decouple_loss:0.002429107902571559
loss_pred:0.015763048082590103, decouple_loss:0.0024730702862143517
Iteration: 1236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44592487812042236, gen p mean: -0.2503735423088074, mean p set: 0.4465000033378601
loss_pred:0.015632888302206993, decouple_loss:0.0026903662364929914
The modified gen p mean: 0.44647228717803955, gen p mean: -0.24875451624393463, mean p set: 0.4470498263835907The modified gen p mean: 0.44800400733947754, gen p mean: -0.24880361557006836, mean p set: 0.448532372713089
loss_pred:0.015296625904738903, decouple_loss:0.002846372779458761
loss_pred:0.016294831410050392, decouple_loss:0.002746445592492819
Iteration: 1237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462206959724426, gen p mean: -0.24932679533958435, mean p set: 0.44679760932922363
loss_pred:0.016712771728634834, decouple_loss:0.0028360041324049234
The modified gen p mean: 0.44731709361076355, gen p mean: -0.24712708592414856, mean p set: 0.44788745045661926
loss_pred:0.01640068180859089, decouple_loss:0.0030358051881194115
The modified gen p mean: 0.4452461898326874, gen p mean: -0.24885517358779907, mean p set: 0.4457741975784302
loss_pred:0.015739373862743378, decouple_loss:0.0028476568404585123
Iteration: 1238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686779379844666, gen p mean: -0.24969109892845154, mean p set: 0.44744786620140076
loss_pred:0.01616494171321392, decouple_loss:0.0026427428238093853
The modified gen p mean: 0.446805477142334, gen p mean: -0.2529195249080658, mean p set: 0.44737792015075684
loss_pred:0.0157623328268528, decouple_loss:0.002515822649002075
The modified gen p mean: 0.44651785492897034, gen p mean: -0.2542051374912262, mean p set: 0.44704657793045044
loss_pred:0.01639656163752079, decouple_loss:0.002401642734184861
Iteration: 1239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715091586112976, gen p mean: -0.2578814923763275, mean p set: 0.447732150554657
loss_pred:0.01599397324025631, decouple_loss:0.0027172628324478865
The modified gen p mean: 0.44614043831825256, gen p mean: -0.2557494640350342, mean p set: 0.4467087388038635
loss_pred:0.016418032348155975, decouple_loss:0.003043042728677392
The modified gen p mean: 0.4457886815071106, gen p mean: -0.2611766755580902, mean p set: 0.44631776213645935
loss_pred:0.015699997544288635, decouple_loss:0.002726160455495119
Iteration: 1240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752568006515503, gen p mean: -0.25641486048698425, mean p set: 0.4480991065502167
loss_pred:0.015847695991396904, decouple_loss:0.002904297783970833
The modified gen p mean: 0.44718432426452637, gen p mean: -0.2572222948074341, mean p set: 0.44775912165641785
loss_pred:0.016513125970959663, decouple_loss:0.002691026544198394
The modified gen p mean: 0.4467372000217438, gen p mean: -0.2561546564102173, mean p set: 0.44725537300109863
loss_pred:0.015784651041030884, decouple_loss:0.002701987512409687
2023-04-27 02:24:35 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2510566711425781, mean p set: 0.4499112665653229
loss_pred:0.01746140979230404, decouple_loss:0.0028429259546101093
The modified gen p mean: 0.4492984414100647, gen p mean: -0.25061407685279846, mean p set: 0.4498290419578552
loss_pred:0.01709352433681488, decouple_loss:0.0028412039391696453
The modified gen p mean: 0.44822633266448975, gen p mean: -0.24806241691112518, mean p set: 0.44879910349845886
loss_pred:0.017403369769454002, decouple_loss:0.0027338785585016012
WV_1_PC_1_EH_0_PS_30, loss: 0.01745973527431488, avg_mse: 0.025828484445810318
current test mse: 0.025828
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 1241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476821720600128, gen p mean: -0.25103989243507385, mean p set: 0.44821614027023315
loss_pred:0.01588532142341137, decouple_loss:0.003143441630527377
The modified gen p mean: 0.44819343090057373, gen p mean: -0.24702408909797668, mean p set: 0.4487749934196472
loss_pred:0.015727415680885315, decouple_loss:0.003247943241149187
The modified gen p mean: 0.4478863775730133, gen p mean: -0.25436392426490784, mean p set: 0.44845813512802124
loss_pred:0.01472869049757719, decouple_loss:0.0031098737381398678
Iteration: 1242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760245084762573, gen p mean: -0.24451936781406403, mean p set: 0.44812917709350586
loss_pred:0.016018936410546303, decouple_loss:0.0030146981589496136
The modified gen p mean: 0.44848233461380005, gen p mean: -0.24101696908473969, mean p set: 0.44905948638916016The modified gen p mean: 0.4470615088939667, gen p mean: -0.24347446858882904, mean p set: 0.4476364552974701
loss_pred:0.01623092032968998, decouple_loss:0.0033287450205534697
loss_pred:0.015821823850274086, decouple_loss:0.003210376715287566
Iteration: 1243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806739687919617, gen p mean: -0.243414968252182, mean p set: 0.4485950767993927
loss_pred:0.01554424874484539, decouple_loss:0.003183566965162754
The modified gen p mean: 0.4464431703090668, gen p mean: -0.2375524938106537, mean p set: 0.44701725244522095
The modified gen p mean: 0.4495317041873932, gen p mean: -0.2395453006029129, mean p set: 0.45010778307914734
loss_pred:0.01576412282884121, decouple_loss:0.0033383439294993877
loss_pred:0.015084577724337578, decouple_loss:0.0032007331028580666
Iteration: 1244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904282689094543, gen p mean: -0.2309085875749588, mean p set: 0.4495725929737091
loss_pred:0.015533876605331898, decouple_loss:0.003102409653365612
The modified gen p mean: 0.4475986957550049, gen p mean: -0.2442329227924347, mean p set: 0.4481755197048187
The modified gen p mean: 0.447227418422699, gen p mean: -0.24607324600219727, mean p set: 0.44780364632606506
loss_pred:0.015076138079166412, decouple_loss:0.00305414036847651
loss_pred:0.015853755176067352, decouple_loss:0.0028133708983659744
Iteration: 1245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779518246650696, gen p mean: -0.23783530294895172, mean p set: 0.4483700692653656
loss_pred:0.014776074327528477, decouple_loss:0.0030921841971576214
The modified gen p mean: 0.4494249224662781, gen p mean: -0.2308495193719864, mean p set: 0.4499603509902954The modified gen p mean: 0.4475955069065094, gen p mean: -0.24538534879684448, mean p set: 0.44816869497299194
loss_pred:0.015892967581748962, decouple_loss:0.002917300211265683
loss_pred:0.015113173983991146, decouple_loss:0.0033890153281390667
Iteration: 1246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469454288482666, gen p mean: -0.2390788197517395, mean p set: 0.4475235044956207
loss_pred:0.01540116686373949, decouple_loss:0.0028478559106588364
The modified gen p mean: 0.4472154974937439, gen p mean: -0.24470961093902588, mean p set: 0.4477936327457428
loss_pred:0.014899175614118576, decouple_loss:0.002899721497669816
The modified gen p mean: 0.44742825627326965, gen p mean: -0.2347373515367508, mean p set: 0.4479523003101349
loss_pred:0.015846863389015198, decouple_loss:0.0030808679293841124
Iteration: 1247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718122482299805, gen p mean: -0.2439645528793335, mean p set: 0.44775503873825073
loss_pred:0.015148657374083996, decouple_loss:0.002627118956297636
The modified gen p mean: 0.44732123613357544, gen p mean: -0.2382660210132599, mean p set: 0.4478912055492401
loss_pred:0.016342569142580032, decouple_loss:0.0027395854704082012
The modified gen p mean: 0.44730815291404724, gen p mean: -0.24197907745838165, mean p set: 0.44783204793930054
loss_pred:0.01562948152422905, decouple_loss:0.0028249756433069706
Iteration: 1248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711098074913025, gen p mean: -0.24533531069755554, mean p set: 0.44768205285072327
loss_pred:0.01663369871675968, decouple_loss:0.00261718244291842
The modified gen p mean: 0.44764792919158936, gen p mean: -0.24496591091156006, mean p set: 0.4481693506240845The modified gen p mean: 0.4469655156135559, gen p mean: -0.25196295976638794, mean p set: 0.44753962755203247
loss_pred:0.015187675133347511, decouple_loss:0.002616714220494032
loss_pred:0.015038936398923397, decouple_loss:0.002736383816227317
Iteration: 1249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470200538635254, gen p mean: -0.24812202155590057, mean p set: 0.4475933611392975
loss_pred:0.015812214463949203, decouple_loss:0.0027237527538090944
The modified gen p mean: 0.4476127028465271, gen p mean: -0.24551640450954437, mean p set: 0.44814783334732056The modified gen p mean: 0.44658854603767395, gen p mean: -0.2490442842245102, mean p set: 0.4471684396266937
loss_pred:0.015809716656804085, decouple_loss:0.002876055194064975
loss_pred:0.015325081534683704, decouple_loss:0.002874702215194702
Iteration: 1250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480273723602295, gen p mean: -0.24994640052318573, mean p set: 0.44860655069351196
loss_pred:0.014782401733100414, decouple_loss:0.0026150313206017017
The modified gen p mean: 0.4480544626712799, gen p mean: -0.25527721643447876, mean p set: 0.44863179326057434
loss_pred:0.014858980663120747, decouple_loss:0.002850294578820467
The modified gen p mean: 0.44866088032722473, gen p mean: -0.2526300847530365, mean p set: 0.44918543100357056
loss_pred:0.01481645554304123, decouple_loss:0.0030400746036320925
2023-04-27 02:28:55 testing...
The modified gen p mean: 0.4482235014438629, gen p mean: -0.24900516867637634, mean p set: 0.44879910349845886
loss_pred:0.017672762274742126, decouple_loss:0.0027933139353990555
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25221386551856995, mean p set: 0.4499112665653229
loss_pred:0.017603565007448196, decouple_loss:0.002747937338426709
The modified gen p mean: 0.4493063986301422, gen p mean: -0.2520802319049835, mean p set: 0.4498290419578552
loss_pred:0.0172480046749115, decouple_loss:0.002773020416498184
WV_1_PC_1_EH_0_PS_30, loss: 0.017646681517362595, avg_mse: 0.026132045313715935
current test mse: 0.026132
Iteration: 1251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674062728881836, gen p mean: -0.2547750771045685, mean p set: 0.4473148286342621
loss_pred:0.01540156826376915, decouple_loss:0.0026622400619089603
The modified gen p mean: 0.446931391954422, gen p mean: -0.2482789307832718, mean p set: 0.4475088119506836
loss_pred:0.015482340939342976, decouple_loss:0.0028447869699448347
The modified gen p mean: 0.44849443435668945, gen p mean: -0.2451789826154709, mean p set: 0.4490176737308502
loss_pred:0.015408046543598175, decouple_loss:0.0029796226881444454
Iteration: 1252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713687896728516, gen p mean: -0.24761813879013062, mean p set: 0.4476613700389862
loss_pred:0.015121664851903915, decouple_loss:0.0030747498385608196
The modified gen p mean: 0.4478490352630615, gen p mean: -0.24615997076034546, mean p set: 0.44842052459716797
loss_pred:0.015305882319808006, decouple_loss:0.002969768363982439
The modified gen p mean: 0.4472898840904236, gen p mean: -0.24529200792312622, mean p set: 0.4478708505630493
loss_pred:0.014758545905351639, decouple_loss:0.003002702724188566
Iteration: 1253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806280732154846, gen p mean: -0.24880211055278778, mean p set: 0.44859078526496887
loss_pred:0.014688920229673386, decouple_loss:0.0026544774882495403
The modified gen p mean: 0.44806477427482605, gen p mean: -0.24851642549037933, mean p set: 0.4486410617828369The modified gen p mean: 0.4479416608810425, gen p mean: -0.24444431066513062, mean p set: 0.4485217034816742
loss_pred:0.01496502198278904, decouple_loss:0.0027049530763179064
loss_pred:0.015161090530455112, decouple_loss:0.002830387093126774
Iteration: 1254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485902786254883, gen p mean: -0.24069663882255554, mean p set: 0.4491148293018341
loss_pred:0.015125329606235027, decouple_loss:0.003270854242146015
The modified gen p mean: 0.44897955656051636, gen p mean: -0.24026958644390106, mean p set: 0.4495594799518585
loss_pred:0.01505125779658556, decouple_loss:0.003402451751753688
The modified gen p mean: 0.4478756785392761, gen p mean: -0.24268612265586853, mean p set: 0.44845467805862427
loss_pred:0.014637055806815624, decouple_loss:0.0032627638429403305
Iteration: 1255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485397934913635, gen p mean: -0.23942147195339203, mean p set: 0.4491144120693207
loss_pred:0.015521051362156868, decouple_loss:0.0027479049749672413
The modified gen p mean: 0.44779089093208313, gen p mean: -0.24329890310764313, mean p set: 0.44836780428886414The modified gen p mean: 0.44803670048713684, gen p mean: -0.23886793851852417, mean p set: 0.44856393337249756
loss_pred:0.016567636281251907, decouple_loss:0.002663023304194212
loss_pred:0.01580887846648693, decouple_loss:0.0026697954162955284
Iteration: 1256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747892022132874, gen p mean: -0.24697893857955933, mean p set: 0.44805845618247986
loss_pred:0.015269008465111256, decouple_loss:0.0030678752809762955
The modified gen p mean: 0.4476913511753082, gen p mean: -0.2420164942741394, mean p set: 0.4482676684856415
loss_pred:0.015192361548542976, decouple_loss:0.0029055599588900805
The modified gen p mean: 0.4470873773097992, gen p mean: -0.2396748811006546, mean p set: 0.4476158618927002
loss_pred:0.015749236568808556, decouple_loss:0.0031085219234228134
Iteration: 1257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680607318878174, gen p mean: -0.25031810998916626, mean p set: 0.4473792016506195
loss_pred:0.015421219170093536, decouple_loss:0.0024670318234711885
The modified gen p mean: 0.44769158959388733, gen p mean: -0.23946064710617065, mean p set: 0.44822585582733154The modified gen p mean: 0.4475594460964203, gen p mean: -0.24398669600486755, mean p set: 0.44813597202301025
loss_pred:0.01557923760265112, decouple_loss:0.0026556113734841347
loss_pred:0.015525256283581257, decouple_loss:0.002599500585347414
Iteration: 1258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740942120552063, gen p mean: -0.24319656193256378, mean p set: 0.44798195362091064
loss_pred:0.015071315690875053, decouple_loss:0.0028055603615939617
The modified gen p mean: 0.4474959969520569, gen p mean: -0.24845242500305176, mean p set: 0.4480154812335968The modified gen p mean: 0.4477582573890686, gen p mean: -0.24484866857528687, mean p set: 0.4483305513858795
loss_pred:0.01595679111778736, decouple_loss:0.003370309015735984
loss_pred:0.015042276121675968, decouple_loss:0.0030399756506085396
Iteration: 1259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710874557495117, gen p mean: -0.24507705867290497, mean p set: 0.4476836025714874
loss_pred:0.014424272812902927, decouple_loss:0.002685204381123185
The modified gen p mean: 0.4474863111972809, gen p mean: -0.2434217631816864, mean p set: 0.4480615258216858
loss_pred:0.01496792584657669, decouple_loss:0.002691072877496481
The modified gen p mean: 0.4487798810005188, gen p mean: -0.25002509355545044, mean p set: 0.449308842420578
loss_pred:0.014522251673042774, decouple_loss:0.0028776321560144424
Iteration: 1260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476650059223175, gen p mean: -0.24435481429100037, mean p set: 0.44824254512786865
loss_pred:0.015928078442811966, decouple_loss:0.0030752490274608135
The modified gen p mean: 0.44770580530166626, gen p mean: -0.24638760089874268, mean p set: 0.4482842683792114
loss_pred:0.015640513971447945, decouple_loss:0.002723093843087554
The modified gen p mean: 0.4467445909976959, gen p mean: -0.2498743236064911, mean p set: 0.4472792148590088
loss_pred:0.015396015718579292, decouple_loss:0.0027290736325085163
2023-04-27 02:32:20 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2500242292881012, mean p set: 0.4499112665653229
loss_pred:0.017595594748854637, decouple_loss:0.0027068820782005787
The modified gen p mean: 0.4493023455142975, gen p mean: -0.2495676577091217, mean p set: 0.4498290419578552
loss_pred:0.01722153276205063, decouple_loss:0.0027581388130784035
The modified gen p mean: 0.44822248816490173, gen p mean: -0.24684743583202362, mean p set: 0.44879910349845886
loss_pred:0.01764543354511261, decouple_loss:0.0027985458727926016
WV_1_PC_1_EH_0_PS_30, loss: 0.017625248059630394, avg_mse: 0.026112010702490807
current test mse: 0.026112
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 1261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859105348587036, gen p mean: -0.2522810697555542, mean p set: 0.44912344217300415
loss_pred:0.014298752881586552, decouple_loss:0.0026958712842315435
The modified gen p mean: 0.44911232590675354, gen p mean: -0.25082170963287354, mean p set: 0.4496924579143524
loss_pred:0.015218527987599373, decouple_loss:0.0028152032755315304
The modified gen p mean: 0.448016494512558, gen p mean: -0.2488318383693695, mean p set: 0.4485989212989807
loss_pred:0.016284191980957985, decouple_loss:0.0028644234407693148
Iteration: 1262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809192419052124, gen p mean: -0.2474111169576645, mean p set: 0.4486178159713745
loss_pred:0.01565374806523323, decouple_loss:0.0029539053793996572
The modified gen p mean: 0.4470522403717041, gen p mean: -0.24931567907333374, mean p set: 0.44762104749679565The modified gen p mean: 0.4482797384262085, gen p mean: -0.24495451152324677, mean p set: 0.4488604962825775
loss_pred:0.015903841704130173, decouple_loss:0.003123659873381257
loss_pred:0.014848641119897366, decouple_loss:0.0031081149354577065
Iteration: 1263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472077786922455, gen p mean: -0.24999912083148956, mean p set: 0.44773876667022705
loss_pred:0.015941400080919266, decouple_loss:0.0023971793707460165
The modified gen p mean: 0.44813552498817444, gen p mean: -0.24623815715312958, mean p set: 0.4487088918685913The modified gen p mean: 0.44932296872138977, gen p mean: -0.2519059181213379, mean p set: 0.449893593788147
loss_pred:0.0148743512108922, decouple_loss:0.0026257664430886507
loss_pred:0.015373088419437408, decouple_loss:0.0025008858647197485
Iteration: 1264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979727268218994, gen p mean: -0.2464047372341156, mean p set: 0.45032650232315063
loss_pred:0.015333193354308605, decouple_loss:0.0029337627347558737
The modified gen p mean: 0.4486219882965088, gen p mean: -0.25063684582710266, mean p set: 0.4492034912109375The modified gen p mean: 0.4477333128452301, gen p mean: -0.24916234612464905, mean p set: 0.44830194115638733
loss_pred:0.01595485210418701, decouple_loss:0.003055403009057045
loss_pred:0.015824006870388985, decouple_loss:0.0027928247582167387
Iteration: 1265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475603997707367, gen p mean: -0.24452494084835052, mean p set: 0.4481314718723297
loss_pred:0.016621917486190796, decouple_loss:0.00265032728202641
The modified gen p mean: 0.449185311794281, gen p mean: -0.24889756739139557, mean p set: 0.4497707486152649
loss_pred:0.01541221421211958, decouple_loss:0.002572696190327406
The modified gen p mean: 0.4483465552330017, gen p mean: -0.24641823768615723, mean p set: 0.44887539744377136
loss_pred:0.015398801304399967, decouple_loss:0.0028191334567964077
Iteration: 1266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485993981361389, gen p mean: -0.24366122484207153, mean p set: 0.44917547702789307
loss_pred:0.015556592494249344, decouple_loss:0.0030333995819091797
The modified gen p mean: 0.4492189586162567, gen p mean: -0.24620656669139862, mean p set: 0.4497983753681183
loss_pred:0.015652472153306007, decouple_loss:0.0032824967056512833
The modified gen p mean: 0.44871219992637634, gen p mean: -0.23577097058296204, mean p set: 0.4492361843585968
loss_pred:0.014949402771890163, decouple_loss:0.002889394061639905
Iteration: 1267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473232328891754, gen p mean: -0.23958633840084076, mean p set: 0.44789305329322815
loss_pred:0.016089359298348427, decouple_loss:0.0031063384376466274
The modified gen p mean: 0.4488444924354553, gen p mean: -0.24284018576145172, mean p set: 0.44941920042037964
loss_pred:0.015956226736307144, decouple_loss:0.002838721266016364
The modified gen p mean: 0.44783222675323486, gen p mean: -0.24251514673233032, mean p set: 0.44836267828941345
loss_pred:0.01618734747171402, decouple_loss:0.002890476491302252
Iteration: 1268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778525829315186, gen p mean: -0.24644814431667328, mean p set: 0.44836223125457764
The modified gen p mean: 0.4474351704120636, gen p mean: -0.24498076736927032, mean p set: 0.4480117857456207loss_pred:0.0159708634018898, decouple_loss:0.00301393773406744
loss_pred:0.015427141450345516, decouple_loss:0.002577161183580756
The modified gen p mean: 0.4493614435195923, gen p mean: -0.24477389454841614, mean p set: 0.449893057346344
loss_pred:0.015126598998904228, decouple_loss:0.0027367465663701296
Iteration: 1269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474642276763916, gen p mean: -0.23498889803886414, mean p set: 0.44804272055625916
loss_pred:0.014835767447948456, decouple_loss:0.0029119173996150494
The modified gen p mean: 0.4471101760864258, gen p mean: -0.24601051211357117, mean p set: 0.44768157601356506The modified gen p mean: 0.4471418857574463, gen p mean: -0.24585245549678802, mean p set: 0.44766971468925476
loss_pred:0.015616183169186115, decouple_loss:0.0025222471449524164
loss_pred:0.016018114984035492, decouple_loss:0.002605393063277006
Iteration: 1270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743862748146057, gen p mean: -0.24592289328575134, mean p set: 0.44801095128059387
loss_pred:0.01580039970576763, decouple_loss:0.002932250499725342
The modified gen p mean: 0.44672808051109314, gen p mean: -0.24666212499141693, mean p set: 0.44730639457702637
loss_pred:0.01538655161857605, decouple_loss:0.002876844024285674
The modified gen p mean: 0.44975748658180237, gen p mean: -0.2464626133441925, mean p set: 0.4502778649330139
loss_pred:0.01606532745063305, decouple_loss:0.002813967177644372
2023-04-27 02:36:34 testing...
The modified gen p mean: 0.4482268989086151, gen p mean: -0.24613185226917267, mean p set: 0.44879910349845886
loss_pred:0.017535513266921043, decouple_loss:0.0028011652175337076
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2491413652896881, mean p set: 0.4499112665653229
loss_pred:0.017606090754270554, decouple_loss:0.0028644606936722994
The modified gen p mean: 0.4493027925491333, gen p mean: -0.2489391416311264, mean p set: 0.4498290419578552
loss_pred:0.017237680032849312, decouple_loss:0.002868061885237694
WV_1_PC_1_EH_0_PS_30, loss: 0.017601989209651947, avg_mse: 0.026062555611133575
current test mse: 0.026063
Iteration: 1271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890108704566956, gen p mean: -0.25318843126296997, mean p set: 0.44948384165763855
loss_pred:0.015763862058520317, decouple_loss:0.002495774533599615
The modified gen p mean: 0.4489152431488037, gen p mean: -0.24318668246269226, mean p set: 0.449482798576355
loss_pred:0.015405572019517422, decouple_loss:0.002862841123715043
The modified gen p mean: 0.4484124779701233, gen p mean: -0.24961063265800476, mean p set: 0.448948472738266
loss_pred:0.0161025058478117, decouple_loss:0.0026377951726317406
Iteration: 1272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778525829315186, gen p mean: -0.25443410873413086, mean p set: 0.4483141601085663
loss_pred:0.01534155011177063, decouple_loss:0.0027710406575351954
The modified gen p mean: 0.4478641450405121, gen p mean: -0.25460416078567505, mean p set: 0.4484424889087677
loss_pred:0.015773603692650795, decouple_loss:0.002528608776628971
The modified gen p mean: 0.44875794649124146, gen p mean: -0.24469618499279022, mean p set: 0.44933751225471497
loss_pred:0.015353286638855934, decouple_loss:0.002791639184579253
Iteration: 1273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448318749666214, gen p mean: -0.2523098587989807, mean p set: 0.44884148240089417
loss_pred:0.01461469754576683, decouple_loss:0.002866441383957863
The modified gen p mean: 0.4475342333316803, gen p mean: -0.2591513395309448, mean p set: 0.44810163974761963
loss_pred:0.015244781970977783, decouple_loss:0.0026355627924203873
The modified gen p mean: 0.4481319487094879, gen p mean: -0.24517516791820526, mean p set: 0.44870755076408386
loss_pred:0.014575554057955742, decouple_loss:0.0028331121429800987
Iteration: 1274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487314522266388, gen p mean: -0.2555069625377655, mean p set: 0.4492538273334503
loss_pred:0.01571846567094326, decouple_loss:0.0029308958910405636
The modified gen p mean: 0.44717937707901, gen p mean: -0.2567400634288788, mean p set: 0.4477550983428955
loss_pred:0.015623023733496666, decouple_loss:0.0029528040904551744
The modified gen p mean: 0.4484398066997528, gen p mean: -0.25629207491874695, mean p set: 0.44901350140571594
loss_pred:0.015444109216332436, decouple_loss:0.0029560732655227184
Iteration: 1275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487664997577667, gen p mean: -0.25349968671798706, mean p set: 0.44933804869651794
loss_pred:0.014672570861876011, decouple_loss:0.002566151786595583
The modified gen p mean: 0.44940292835235596, gen p mean: -0.25665047764778137, mean p set: 0.4499812126159668
loss_pred:0.015289967879652977, decouple_loss:0.002721948316320777
The modified gen p mean: 0.44878634810447693, gen p mean: -0.2543693780899048, mean p set: 0.449317067861557
loss_pred:0.01500014029443264, decouple_loss:0.0026817137841135263
Iteration: 1276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477340281009674, gen p mean: -0.24844235181808472, mean p set: 0.4483092129230499
loss_pred:0.015429742634296417, decouple_loss:0.0027904959861189127
The modified gen p mean: 0.44844555854797363, gen p mean: -0.24817447364330292, mean p set: 0.44901934266090393The modified gen p mean: 0.44796043634414673, gen p mean: -0.24628320336341858, mean p set: 0.4484889805316925
loss_pred:0.01505628414452076, decouple_loss:0.0028766831383109093
loss_pred:0.015759989619255066, decouple_loss:0.0027631884440779686
Iteration: 1277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879189133644104, gen p mean: -0.24153172969818115, mean p set: 0.4493674635887146
loss_pred:0.015420196577906609, decouple_loss:0.0026514146011322737
The modified gen p mean: 0.44858330488204956, gen p mean: -0.2388262152671814, mean p set: 0.4491572082042694
loss_pred:0.014832863584160805, decouple_loss:0.0030233939178287983
The modified gen p mean: 0.449398934841156, gen p mean: -0.2443917989730835, mean p set: 0.4499293565750122
loss_pred:0.015541856177151203, decouple_loss:0.002760416828095913
Iteration: 1278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828853011131287, gen p mean: -0.24907301366329193, mean p set: 0.4488602578639984
loss_pred:0.015391492284834385, decouple_loss:0.002984734484925866
The modified gen p mean: 0.4479016661643982, gen p mean: -0.24734443426132202, mean p set: 0.44847777485847473
loss_pred:0.016202814877033234, decouple_loss:0.002909028669819236
The modified gen p mean: 0.4476504325866699, gen p mean: -0.24463236331939697, mean p set: 0.4481810927391052
loss_pred:0.01629871316254139, decouple_loss:0.0028827572241425514
Iteration: 1279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488351047039032, gen p mean: -0.2462022602558136, mean p set: 0.4494136571884155
loss_pred:0.01476822979748249, decouple_loss:0.002718183444812894
The modified gen p mean: 0.44749805331230164, gen p mean: -0.2453291118144989, mean p set: 0.4480784237384796The modified gen p mean: 0.448035329580307, gen p mean: -0.23510000109672546, mean p set: 0.4485621154308319
loss_pred:0.01602848619222641, decouple_loss:0.0027520079165697098
loss_pred:0.014933271333575249, decouple_loss:0.0027957449201494455
Iteration: 1280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495043456554413, gen p mean: -0.23553374409675598, mean p set: 0.45008060336112976
loss_pred:0.015138943679630756, decouple_loss:0.002750711515545845
The modified gen p mean: 0.44855743646621704, gen p mean: -0.2450087070465088, mean p set: 0.4491303265094757
loss_pred:0.01495680958032608, decouple_loss:0.002717467024922371
The modified gen p mean: 0.44857263565063477, gen p mean: -0.24277128279209137, mean p set: 0.44909700751304626
loss_pred:0.014663707464933395, decouple_loss:0.0026042917743325233
2023-04-27 02:39:59 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24418814480304718, mean p set: 0.4499112665653229
loss_pred:0.017650313675403595, decouple_loss:0.0029780594632029533
The modified gen p mean: 0.4482240080833435, gen p mean: -0.241059809923172, mean p set: 0.44879910349845886
loss_pred:0.017582383006811142, decouple_loss:0.0029046027921140194
The modified gen p mean: 0.4492998421192169, gen p mean: -0.24357816576957703, mean p set: 0.4498290419578552
loss_pred:0.01727781817317009, decouple_loss:0.0029373634606599808
WV_1_PC_1_EH_0_PS_30, loss: 0.017650505527853966, avg_mse: 0.026076119393110275
current test mse: 0.026076
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 1281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738858938217163, gen p mean: -0.24756446480751038, mean p set: 0.44791606068611145
loss_pred:0.015474999323487282, decouple_loss:0.0026353909634053707
The modified gen p mean: 0.44825488328933716, gen p mean: -0.24075303971767426, mean p set: 0.4488346576690674
loss_pred:0.015364031307399273, decouple_loss:0.003075619461014867
The modified gen p mean: 0.4478721618652344, gen p mean: -0.24349714815616608, mean p set: 0.4484524726867676
loss_pred:0.015679173171520233, decouple_loss:0.0027289444115012884
Iteration: 1282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484654664993286, gen p mean: -0.24755947291851044, mean p set: 0.4489942789077759
loss_pred:0.01506895199418068, decouple_loss:0.0027943758759647608
The modified gen p mean: 0.4478922188282013, gen p mean: -0.24865075945854187, mean p set: 0.44846752285957336The modified gen p mean: 0.4478830397129059, gen p mean: -0.2437843233346939, mean p set: 0.44846025109291077
loss_pred:0.015142963267862797, decouple_loss:0.0027132544200867414
loss_pred:0.015336885116994381, decouple_loss:0.0029814683366566896
Iteration: 1283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478987753391266, gen p mean: -0.24558749794960022, mean p set: 0.4484281837940216
loss_pred:0.01637369394302368, decouple_loss:0.0028928632382303476
The modified gen p mean: 0.4479435086250305, gen p mean: -0.24208025634288788, mean p set: 0.4485248327255249The modified gen p mean: 0.4478355944156647, gen p mean: -0.24519187211990356, mean p set: 0.44841110706329346
loss_pred:0.01546736154705286, decouple_loss:0.0026738899759948254
loss_pred:0.01612234115600586, decouple_loss:0.0028009372763335705
Iteration: 1284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806402921676636, gen p mean: -0.23930269479751587, mean p set: 0.44859424233436584
loss_pred:0.015602792613208294, decouple_loss:0.0029343138448894024
The modified gen p mean: 0.44680652022361755, gen p mean: -0.23537571728229523, mean p set: 0.44738268852233887
loss_pred:0.015887845307588577, decouple_loss:0.0030272817239165306
The modified gen p mean: 0.4480604827404022, gen p mean: -0.23898330330848694, mean p set: 0.4486396908760071
loss_pred:0.015599454753100872, decouple_loss:0.002938290825113654
Iteration: 1285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475151300430298, gen p mean: -0.25121742486953735, mean p set: 0.4481002688407898
loss_pred:0.015830235555768013, decouple_loss:0.003124511567875743
The modified gen p mean: 0.44686999917030334, gen p mean: -0.24540331959724426, mean p set: 0.4473954439163208The modified gen p mean: 0.4476625323295593, gen p mean: -0.2450696974992752, mean p set: 0.4482366442680359
loss_pred:0.015981430187821388, decouple_loss:0.0028134763706475496
loss_pred:0.01491814386099577, decouple_loss:0.002888717455789447
Iteration: 1286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829970598220825, gen p mean: -0.24180284142494202, mean p set: 0.448875367641449
loss_pred:0.01534747239202261, decouple_loss:0.002887139795348048
The modified gen p mean: 0.44728782773017883, gen p mean: -0.24427883327007294, mean p set: 0.4478660821914673
loss_pred:0.015264516696333885, decouple_loss:0.002863476052880287
The modified gen p mean: 0.4466409981250763, gen p mean: -0.24550189077854156, mean p set: 0.44716405868530273
loss_pred:0.01546616293489933, decouple_loss:0.003147030947729945
Iteration: 1287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726622104644775, gen p mean: -0.24439683556556702, mean p set: 0.4478446841239929
loss_pred:0.015875104814767838, decouple_loss:0.0025571801234036684
The modified gen p mean: 0.4465104639530182, gen p mean: -0.2391754686832428, mean p set: 0.4470857083797455
loss_pred:0.01608344167470932, decouple_loss:0.0024916280526667833
The modified gen p mean: 0.44762811064720154, gen p mean: -0.24854077398777008, mean p set: 0.44815701246261597
loss_pred:0.015476811677217484, decouple_loss:0.002619937527924776
Iteration: 1288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678452610969543, gen p mean: -0.2537645995616913, mean p set: 0.4473487436771393
loss_pred:0.0157618448138237, decouple_loss:0.002824072726070881
The modified gen p mean: 0.44765931367874146, gen p mean: -0.24338296055793762, mean p set: 0.4482302665710449
loss_pred:0.015057374723255634, decouple_loss:0.0029082540422677994
The modified gen p mean: 0.44786587357521057, gen p mean: -0.24760407209396362, mean p set: 0.4483965039253235
loss_pred:0.015289869159460068, decouple_loss:0.0028843460604548454
Iteration: 1289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634220004081726, gen p mean: -0.2476242333650589, mean p set: 0.44691917300224304
loss_pred:0.0159970223903656, decouple_loss:0.00246915384195745
The modified gen p mean: 0.4484812617301941, gen p mean: -0.24835465848445892, mean p set: 0.44905540347099304
loss_pred:0.015437725931406021, decouple_loss:0.002713921247050166
The modified gen p mean: 0.4475802481174469, gen p mean: -0.24051855504512787, mean p set: 0.44810861349105835
loss_pred:0.014996876008808613, decouple_loss:0.0027080646250396967
Iteration: 1290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490777850151062, gen p mean: -0.23614825308322906, mean p set: 0.4496593773365021
loss_pred:0.01458158902823925, decouple_loss:0.002709905384108424
The modified gen p mean: 0.4483885169029236, gen p mean: -0.23759037256240845, mean p set: 0.4489155113697052
loss_pred:0.015157833695411682, decouple_loss:0.0028037880547344685
The modified gen p mean: 0.4468829035758972, gen p mean: -0.23437726497650146, mean p set: 0.4474572539329529
loss_pred:0.015201294794678688, decouple_loss:0.0027749950531870127
2023-04-27 02:44:01 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2364293932914734, mean p set: 0.4499112665653229
loss_pred:0.01759680174291134, decouple_loss:0.003041162621229887
The modified gen p mean: 0.44929757714271545, gen p mean: -0.23614655435085297, mean p set: 0.4498290419578552
loss_pred:0.017142020165920258, decouple_loss:0.002948840381577611
The modified gen p mean: 0.44822758436203003, gen p mean: -0.23320883512496948, mean p set: 0.44879910349845886
loss_pred:0.017505601048469543, decouple_loss:0.002933046780526638
WV_1_PC_1_EH_0_PS_30, loss: 0.017563525587320328, avg_mse: 0.025959016755223274
current test mse: 0.025959
Iteration: 1291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471738934516907, gen p mean: -0.23508596420288086, mean p set: 0.4477500915527344
loss_pred:0.015190024860203266, decouple_loss:0.002520288573578
The modified gen p mean: 0.44773098826408386, gen p mean: -0.23874828219413757, mean p set: 0.44826218485832214
loss_pred:0.014935025945305824, decouple_loss:0.002841016510501504
The modified gen p mean: 0.44793662428855896, gen p mean: -0.2350972443819046, mean p set: 0.44850608706474304
loss_pred:0.014514083974063396, decouple_loss:0.0025960777420550585
Iteration: 1292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827917218208313, gen p mean: -0.24016432464122772, mean p set: 0.4488039016723633
loss_pred:0.014203465543687344, decouple_loss:0.0025693944189697504
The modified gen p mean: 0.44677668809890747, gen p mean: -0.24485425651073456, mean p set: 0.44735386967658997
The modified gen p mean: 0.4478011429309845, gen p mean: -0.2432204782962799, mean p set: 0.4483831226825714
loss_pred:0.015715308487415314, decouple_loss:0.002562485635280609
loss_pred:0.015072155743837357, decouple_loss:0.002607718575745821
Iteration: 1293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476105868816376, gen p mean: -0.24622474610805511, mean p set: 0.44813862442970276
loss_pred:0.015682555735111237, decouple_loss:0.0024779282975941896
The modified gen p mean: 0.4474870562553406, gen p mean: -0.24765022099018097, mean p set: 0.4480552673339844
The modified gen p mean: 0.44811445474624634, gen p mean: -0.2489374727010727, mean p set: 0.4486897885799408
loss_pred:0.014894298277795315, decouple_loss:0.0024795227218419313
loss_pred:0.014936808496713638, decouple_loss:0.0024555295240134
Iteration: 1294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482138454914093, gen p mean: -0.24781471490859985, mean p set: 0.44874149560928345
loss_pred:0.01469746045768261, decouple_loss:0.0027675465680658817
The modified gen p mean: 0.44635921716690063, gen p mean: -0.24959486722946167, mean p set: 0.44693389534950256
The modified gen p mean: 0.44668957591056824, gen p mean: -0.2513900399208069, mean p set: 0.4472673535346985
loss_pred:0.015545099973678589, decouple_loss:0.0025204007979482412
loss_pred:0.015772175043821335, decouple_loss:0.0024338404182344675
Iteration: 1295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481860399246216, gen p mean: -0.24699677526950836, mean p set: 0.44876906275749207
loss_pred:0.014390184544026852, decouple_loss:0.0025990325957536697
The modified gen p mean: 0.44772347807884216, gen p mean: -0.24910520017147064, mean p set: 0.44829997420310974The modified gen p mean: 0.44972550868988037, gen p mean: -0.24816471338272095, mean p set: 0.45025789737701416
loss_pred:0.01545316819101572, decouple_loss:0.0024375026114284992
loss_pred:0.014571713283658028, decouple_loss:0.002639363519847393
Iteration: 1296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488902986049652, gen p mean: -0.2420056015253067, mean p set: 0.4494676887989044
loss_pred:0.015160190872848034, decouple_loss:0.0025317647960036993
The modified gen p mean: 0.448051393032074, gen p mean: -0.24035653471946716, mean p set: 0.4485850930213928The modified gen p mean: 0.44608020782470703, gen p mean: -0.2395249605178833, mean p set: 0.44665467739105225
loss_pred:0.01621154323220253, decouple_loss:0.002553618513047695
loss_pred:0.014747614040970802, decouple_loss:0.0024161601904779673
Iteration: 1297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470665752887726, gen p mean: -0.2433868944644928, mean p set: 0.4476391673088074
loss_pred:0.014949827454984188, decouple_loss:0.0025863891933113337
The modified gen p mean: 0.4494323134422302, gen p mean: -0.24006372690200806, mean p set: 0.4499613046646118The modified gen p mean: 0.4474150538444519, gen p mean: -0.2424895465373993, mean p set: 0.4479939937591553
loss_pred:0.015028124675154686, decouple_loss:0.0024120379239320755
loss_pred:0.014703614637255669, decouple_loss:0.0025226064026355743
Iteration: 1298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710928201675415, gen p mean: -0.23872597515583038, mean p set: 0.4476827085018158
loss_pred:0.01531955599784851, decouple_loss:0.0027278736233711243
The modified gen p mean: 0.44837626814842224, gen p mean: -0.23909048736095428, mean p set: 0.44895458221435547
loss_pred:0.014760006219148636, decouple_loss:0.002493682550266385
The modified gen p mean: 0.44857120513916016, gen p mean: -0.23862998187541962, mean p set: 0.4491024613380432
loss_pred:0.014779172837734222, decouple_loss:0.002551592420786619
Iteration: 1299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489058554172516, gen p mean: -0.2422739863395691, mean p set: 0.449484258890152
loss_pred:0.015171976760029793, decouple_loss:0.0025566620752215385
The modified gen p mean: 0.447165846824646, gen p mean: -0.24088698625564575, mean p set: 0.447747141122818
loss_pred:0.015421300195157528, decouple_loss:0.002473972737789154
The modified gen p mean: 0.4492974579334259, gen p mean: -0.24105730652809143, mean p set: 0.4498293101787567
loss_pred:0.015491177327930927, decouple_loss:0.0025235696230083704
Iteration: 1300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702863693237305, gen p mean: -0.24442841112613678, mean p set: 0.44761136174201965
loss_pred:0.015362110920250416, decouple_loss:0.002532919868826866
The modified gen p mean: 0.4468245208263397, gen p mean: -0.24147029221057892, mean p set: 0.44740498065948486
loss_pred:0.015398788265883923, decouple_loss:0.0024516854900866747
The modified gen p mean: 0.4477500319480896, gen p mean: -0.2404048591852188, mean p set: 0.44827526807785034
loss_pred:0.015347867272794247, decouple_loss:0.00255467277020216
2023-04-27 02:47:26 testing...
The modified gen p mean: 0.4482182562351227, gen p mean: -0.24021022021770477, mean p set: 0.44879910349845886
loss_pred:0.017407935112714767, decouple_loss:0.0026158394757658243
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24350841343402863, mean p set: 0.4499112665653229
loss_pred:0.017573252320289612, decouple_loss:0.0027797576040029526
The modified gen p mean: 0.4493013024330139, gen p mean: -0.24330465495586395, mean p set: 0.4498290419578552
loss_pred:0.017083171755075455, decouple_loss:0.0026582006830722094
WV_1_PC_1_EH_0_PS_30, loss: 0.01748901605606079, avg_mse: 0.02582486718893051
current test mse: 0.025825
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 1301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866669178009033, gen p mean: -0.24697868525981903, mean p set: 0.4491928219795227
loss_pred:0.016782140359282494, decouple_loss:0.0025567193515598774
The modified gen p mean: 0.4497082829475403, gen p mean: -0.2408483475446701, mean p set: 0.4502823054790497
loss_pred:0.01730113849043846, decouple_loss:0.0027529834769666195
The modified gen p mean: 0.4500451982021332, gen p mean: -0.2449168860912323, mean p set: 0.4506154954433441
loss_pred:0.0174222681671381, decouple_loss:0.0027623334899544716
Iteration: 1302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009851455688477, gen p mean: -0.24050988256931305, mean p set: 0.45062586665153503
loss_pred:0.017529549077153206, decouple_loss:0.0025000404566526413
The modified gen p mean: 0.4507337808609009, gen p mean: -0.24151648581027985, mean p set: 0.4513084292411804
loss_pred:0.01730343885719776, decouple_loss:0.002517452696338296
The modified gen p mean: 0.4480351209640503, gen p mean: -0.23853304982185364, mean p set: 0.448609322309494
loss_pred:0.017163008451461792, decouple_loss:0.0026139181572943926
Iteration: 1303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935768842697144, gen p mean: -0.24110004305839539, mean p set: 0.44988662004470825
loss_pred:0.016494838520884514, decouple_loss:0.002593814628198743
The modified gen p mean: 0.45028427243232727, gen p mean: -0.23573389649391174, mean p set: 0.4508611261844635
loss_pred:0.01739000715315342, decouple_loss:0.002574647543951869
The modified gen p mean: 0.4497971534729004, gen p mean: -0.2396472543478012, mean p set: 0.45036831498146057
loss_pred:0.01674305833876133, decouple_loss:0.002599427942186594
Iteration: 1304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506625235080719, gen p mean: -0.2433834671974182, mean p set: 0.4511975646018982
loss_pred:0.016435470432043076, decouple_loss:0.0026229594368487597
The modified gen p mean: 0.44960296154022217, gen p mean: -0.24405530095100403, mean p set: 0.45017993450164795
loss_pred:0.017358550801873207, decouple_loss:0.002524488139897585
The modified gen p mean: 0.4493712782859802, gen p mean: -0.24210165441036224, mean p set: 0.44995349645614624
loss_pred:0.016887253150343895, decouple_loss:0.0023422567173838615
Iteration: 1305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450004518032074, gen p mean: -0.2525365650653839, mean p set: 0.450583815574646
loss_pred:0.017459090799093246, decouple_loss:0.002582088578492403
The modified gen p mean: 0.45007088780403137, gen p mean: -0.24543774127960205, mean p set: 0.4506498873233795
loss_pred:0.017430931329727173, decouple_loss:0.0026520700193941593
The modified gen p mean: 0.44920822978019714, gen p mean: -0.2486077845096588, mean p set: 0.44973650574684143
loss_pred:0.016742365434765816, decouple_loss:0.0025855866260826588
Iteration: 1306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009806752204895, gen p mean: -0.24578022956848145, mean p set: 0.4506319463253021
loss_pred:0.016861770302057266, decouple_loss:0.002530998084694147
The modified gen p mean: 0.45014190673828125, gen p mean: -0.24984267354011536, mean p set: 0.4507182538509369
loss_pred:0.016569646075367928, decouple_loss:0.0025125211104750633
The modified gen p mean: 0.45050525665283203, gen p mean: -0.2454196959733963, mean p set: 0.4510757029056549
loss_pred:0.01774662360548973, decouple_loss:0.0023897169157862663
Iteration: 1307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867458939552307, gen p mean: -0.2498020976781845, mean p set: 0.4492048919200897
loss_pred:0.016487186774611473, decouple_loss:0.0025562401860952377
The modified gen p mean: 0.44925639033317566, gen p mean: -0.24981926381587982, mean p set: 0.4498307406902313
loss_pred:0.016466522589325905, decouple_loss:0.00254844781011343
The modified gen p mean: 0.4505890905857086, gen p mean: -0.24793919920921326, mean p set: 0.45116761326789856
loss_pred:0.01752530038356781, decouple_loss:0.0025767742190510035
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955605268478394, gen p mean: -0.2498168796300888, mean p set: 0.450135201215744
loss_pred:0.016085956245660782, decouple_loss:0.002656754804775119
The modified gen p mean: 0.44957587122917175, gen p mean: -0.24734579026699066, mean p set: 0.45014673471450806
loss_pred:0.016726883128285408, decouple_loss:0.0025757052935659885
The modified gen p mean: 0.4507467448711395, gen p mean: -0.25422877073287964, mean p set: 0.45127072930336
loss_pred:0.01713920198380947, decouple_loss:0.0027777578216046095
Iteration: 1309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505283534526825, gen p mean: -0.24655850231647491, mean p set: 0.451102077960968
loss_pred:0.01658122055232525, decouple_loss:0.0026745209470391273
The modified gen p mean: 0.4504198729991913, gen p mean: -0.24882756173610687, mean p set: 0.4509483277797699The modified gen p mean: 0.4491218328475952, gen p mean: -0.24823471903800964, mean p set: 0.4496990144252777
loss_pred:0.017944494262337685, decouple_loss:0.0027223716024309397
loss_pred:0.017841078341007233, decouple_loss:0.0028843942563980818
Iteration: 1310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489580988883972, gen p mean: -0.25004133582115173, mean p set: 0.44952836632728577
loss_pred:0.016440274193882942, decouple_loss:0.002498854184523225
The modified gen p mean: 0.4485147297382355, gen p mean: -0.2480236142873764, mean p set: 0.4490925073623657
loss_pred:0.017537783831357956, decouple_loss:0.002510715276002884
The modified gen p mean: 0.44938552379608154, gen p mean: -0.24879004061222076, mean p set: 0.4499199688434601
loss_pred:0.01666394993662834, decouple_loss:0.0023997630923986435
2023-04-27 02:51:30 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2500327229499817, mean p set: 0.4499112665653229
loss_pred:0.01728689856827259, decouple_loss:0.002765067620202899
The modified gen p mean: 0.44929948449134827, gen p mean: -0.2497801035642624, mean p set: 0.4498290419578552
loss_pred:0.01651165448129177, decouple_loss:0.002673415234312415
The modified gen p mean: 0.44822028279304504, gen p mean: -0.2469453662633896, mean p set: 0.44879910349845886
loss_pred:0.016892435029149055, decouple_loss:0.0026607767213135958
WV_1_PC_1_EH_0_PS_30, loss: 0.01703198440372944, avg_mse: 0.025114774703979492
current test mse: 0.025115
Iteration: 1311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498385190963745, gen p mean: -0.2448170781135559, mean p set: 0.4504148066043854
loss_pred:0.017465654760599136, decouple_loss:0.0029582928400486708
The modified gen p mean: 0.4486709237098694, gen p mean: -0.24913470447063446, mean p set: 0.4491916298866272
loss_pred:0.016749853268265724, decouple_loss:0.0026467882562428713
The modified gen p mean: 0.45042407512664795, gen p mean: -0.25269031524658203, mean p set: 0.4510018229484558
loss_pred:0.017987316474318504, decouple_loss:0.002766728401184082
Iteration: 1312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44908881187438965, gen p mean: -0.24777741730213165, mean p set: 0.4496159553527832
loss_pred:0.016871867701411247, decouple_loss:0.002345063490793109
The modified gen p mean: 0.450154572725296, gen p mean: -0.24830865859985352, mean p set: 0.45073747634887695
The modified gen p mean: 0.4496281147003174, gen p mean: -0.24878448247909546, mean p set: 0.4502067267894745
loss_pred:0.017705652862787247, decouple_loss:0.0024261188227683306
loss_pred:0.01646210066974163, decouple_loss:0.002445345977321267
Iteration: 1313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501401484012604, gen p mean: -0.24232222139835358, mean p set: 0.45067691802978516
loss_pred:0.017239078879356384, decouple_loss:0.0028871719259768724
The modified gen p mean: 0.4502439796924591, gen p mean: -0.24727699160575867, mean p set: 0.4508230984210968
The modified gen p mean: 0.44947129487991333, gen p mean: -0.2464970052242279, mean p set: 0.4500381648540497
loss_pred:0.017053183168172836, decouple_loss:0.0026318056043237448
loss_pred:0.016618486493825912, decouple_loss:0.0029833801090717316
Iteration: 1314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497256278991699, gen p mean: -0.24779659509658813, mean p set: 0.4502556622028351
loss_pred:0.0171995647251606, decouple_loss:0.002822964685037732
The modified gen p mean: 0.44880181550979614, gen p mean: -0.24812965095043182, mean p set: 0.4493815302848816
The modified gen p mean: 0.44925448298454285, gen p mean: -0.24476489424705505, mean p set: 0.4498307704925537
loss_pred:0.017090819776058197, decouple_loss:0.0025435243733227253
loss_pred:0.017331549897789955, decouple_loss:0.0026644410099834204
Iteration: 1315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906026124954224, gen p mean: -0.24986281991004944, mean p set: 0.4495888352394104
loss_pred:0.016915112733840942, decouple_loss:0.002536144107580185
The modified gen p mean: 0.45018574595451355, gen p mean: -0.24996674060821533, mean p set: 0.4507621228694916
The modified gen p mean: 0.44925594329833984, gen p mean: -0.25220412015914917, mean p set: 0.4498342275619507
loss_pred:0.01738242246210575, decouple_loss:0.0027070266660302877
loss_pred:0.016765430569648743, decouple_loss:0.002474579494446516
Iteration: 1316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44980373978614807, gen p mean: -0.2529614269733429, mean p set: 0.45038241147994995
loss_pred:0.016678577288985252, decouple_loss:0.0028342355508357286
The modified gen p mean: 0.45119237899780273, gen p mean: -0.25123894214630127, mean p set: 0.4517151713371277The modified gen p mean: 0.4481196701526642, gen p mean: -0.24962115287780762, mean p set: 0.4486955404281616
loss_pred:0.01726572960615158, decouple_loss:0.0029683378525078297
loss_pred:0.017155518755316734, decouple_loss:0.0029085876885801554
Iteration: 1317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859081506729126, gen p mean: -0.2528669536113739, mean p set: 0.4491656422615051
loss_pred:0.01689649000763893, decouple_loss:0.002548601245507598
The modified gen p mean: 0.44936245679855347, gen p mean: -0.25169405341148376, mean p set: 0.44988352060317993The modified gen p mean: 0.4491496980190277, gen p mean: -0.25094881653785706, mean p set: 0.44972866773605347
loss_pred:0.017546778544783592, decouple_loss:0.0026815920136868954
loss_pred:0.016064785420894623, decouple_loss:0.0026401167269796133
Iteration: 1318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949379563331604, gen p mean: -0.2541915774345398, mean p set: 0.45006564259529114
loss_pred:0.01692560315132141, decouple_loss:0.003017581533640623
The modified gen p mean: 0.4497773051261902, gen p mean: -0.25722992420196533, mean p set: 0.4503425657749176
loss_pred:0.016543425619602203, decouple_loss:0.002769382670521736
The modified gen p mean: 0.4492882490158081, gen p mean: -0.2564929723739624, mean p set: 0.4498143792152405
loss_pred:0.016887594014406204, decouple_loss:0.0031728276517242193
Iteration: 1319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499817192554474, gen p mean: -0.2622135579586029, mean p set: 0.45056453347206116
loss_pred:0.017421988770365715, decouple_loss:0.00256681302562356
The modified gen p mean: 0.4495645761489868, gen p mean: -0.2638506591320038, mean p set: 0.4501415491104126
loss_pred:0.016904257237911224, decouple_loss:0.002614725148305297
The modified gen p mean: 0.4504008889198303, gen p mean: -0.25611501932144165, mean p set: 0.45092761516571045
loss_pred:0.01716289110481739, decouple_loss:0.002666186075657606
Iteration: 1320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449229896068573, gen p mean: -0.2652864456176758, mean p set: 0.4498046338558197
loss_pred:0.017298230901360512, decouple_loss:0.003232227871194482
The modified gen p mean: 0.450684517621994, gen p mean: -0.2626284956932068, mean p set: 0.4512575566768646
loss_pred:0.01700514741241932, decouple_loss:0.0034164602402597666
The modified gen p mean: 0.45006778836250305, gen p mean: -0.2663377523422241, mean p set: 0.45058757066726685
loss_pred:0.01729869656264782, decouple_loss:0.0034038075245916843
2023-04-27 02:54:53 testing...
The modified gen p mean: 0.4482240676879883, gen p mean: -0.2619103491306305, mean p set: 0.44879910349845886
loss_pred:0.01627846620976925, decouple_loss:0.002820576773956418
The modified gen p mean: 0.4494309425354004, gen p mean: -0.26492053270339966, mean p set: 0.4499112665653229
loss_pred:0.01649048551917076, decouple_loss:0.002782073337584734
The modified gen p mean: 0.4492945671081543, gen p mean: -0.26471152901649475, mean p set: 0.4498290419578552
loss_pred:0.01602851040661335, decouple_loss:0.0027344143018126488
WV_1_PC_1_EH_0_PS_30, loss: 0.01640477031469345, avg_mse: 0.02406684309244156
current test mse: 0.024067
At step 1320, Best test: 0.024067
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 1321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896942377090454, gen p mean: -0.25965139269828796, mean p set: 0.4495036005973816
loss_pred:0.01680687814950943, decouple_loss:0.0030802099499851465
The modified gen p mean: 0.4473705291748047, gen p mean: -0.2643949091434479, mean p set: 0.4479483664035797
loss_pred:0.016061821952462196, decouple_loss:0.002817125292494893
The modified gen p mean: 0.44625550508499146, gen p mean: -0.26158544421195984, mean p set: 0.4468391239643097
loss_pred:0.01641784980893135, decouple_loss:0.002778151538223028
Iteration: 1322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482279419898987, gen p mean: -0.2605728805065155, mean p set: 0.4487598240375519
loss_pred:0.01622086763381958, decouple_loss:0.003135628765448928
The modified gen p mean: 0.4486399292945862, gen p mean: -0.25908762216567993, mean p set: 0.4492167532444
loss_pred:0.01683560572564602, decouple_loss:0.003222976578399539
The modified gen p mean: 0.44718998670578003, gen p mean: -0.2637525498867035, mean p set: 0.44777119159698486
loss_pred:0.016720782965421677, decouple_loss:0.0031377580016851425
Iteration: 1323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475870132446289, gen p mean: -0.26371991634368896, mean p set: 0.44812238216400146
loss_pred:0.016486410051584244, decouple_loss:0.003082417882978916
The modified gen p mean: 0.44631969928741455, gen p mean: -0.25777533650398254, mean p set: 0.44689464569091797
loss_pred:0.016516508534550667, decouple_loss:0.0029169947374612093
The modified gen p mean: 0.4489481747150421, gen p mean: -0.2574622333049774, mean p set: 0.44951605796813965
loss_pred:0.015729177743196487, decouple_loss:0.0027780518867075443
Iteration: 1324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478931725025177, gen p mean: -0.25234347581863403, mean p set: 0.44841864705085754
loss_pred:0.015931976959109306, decouple_loss:0.0036408116575330496
The modified gen p mean: 0.4483747184276581, gen p mean: -0.2541693150997162, mean p set: 0.4489506781101227
loss_pred:0.01641158014535904, decouple_loss:0.0034741638228297234
The modified gen p mean: 0.44746866822242737, gen p mean: -0.24815310537815094, mean p set: 0.4480399191379547
loss_pred:0.015588914975523949, decouple_loss:0.003245820989832282
Iteration: 1325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707557559013367, gen p mean: -0.24893853068351746, mean p set: 0.44764459133148193
loss_pred:0.015543600544333458, decouple_loss:0.002693404443562031
The modified gen p mean: 0.44927266240119934, gen p mean: -0.24223463237285614, mean p set: 0.44985130429267883The modified gen p mean: 0.44705435633659363, gen p mean: -0.24684393405914307, mean p set: 0.4475817382335663
loss_pred:0.015876097604632378, decouple_loss:0.003193527925759554
loss_pred:0.016076967120170593, decouple_loss:0.002752884291112423
Iteration: 1326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484620690345764, gen p mean: -0.24942028522491455, mean p set: 0.4490351974964142
loss_pred:0.015652574598789215, decouple_loss:0.0028683985583484173
The modified gen p mean: 0.448337584733963, gen p mean: -0.24377167224884033, mean p set: 0.4488692581653595The modified gen p mean: 0.448733925819397, gen p mean: -0.24289651215076447, mean p set: 0.44930681586265564
loss_pred:0.01642635650932789, decouple_loss:0.0032076602801680565
loss_pred:0.01615491323173046, decouple_loss:0.00317613803781569
Iteration: 1327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488617181777954, gen p mean: -0.2471437007188797, mean p set: 0.4494354724884033
loss_pred:0.01602713204920292, decouple_loss:0.0028876762371510267
The modified gen p mean: 0.44679924845695496, gen p mean: -0.2500213086605072, mean p set: 0.4473777115345001The modified gen p mean: 0.44719481468200684, gen p mean: -0.2532516121864319, mean p set: 0.4477252662181854
loss_pred:0.01690809056162834, decouple_loss:0.0027236458845436573
loss_pred:0.0167266633361578, decouple_loss:0.0026694179978221655
Iteration: 1328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476569592952728, gen p mean: -0.25955188274383545, mean p set: 0.4482314884662628
loss_pred:0.015922341495752335, decouple_loss:0.002820628695189953
The modified gen p mean: 0.4470844268798828, gen p mean: -0.24927908182144165, mean p set: 0.4476655125617981
loss_pred:0.015156254172325134, decouple_loss:0.0026794399600476027
The modified gen p mean: 0.44793936610221863, gen p mean: -0.25302207469940186, mean p set: 0.448468953371048
loss_pred:0.016175318509340286, decouple_loss:0.002636719262227416
Iteration: 1329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453124403953552, gen p mean: -0.2593556046485901, mean p set: 0.44584187865257263
loss_pred:0.01649753749370575, decouple_loss:0.002781887538731098
The modified gen p mean: 0.4478735029697418, gen p mean: -0.2592219412326813, mean p set: 0.44844329357147217
loss_pred:0.016187183558940887, decouple_loss:0.0029041129164397717
The modified gen p mean: 0.4474639892578125, gen p mean: -0.25523021817207336, mean p set: 0.4480428397655487
loss_pred:0.015047885477542877, decouple_loss:0.0027864500880241394
Iteration: 1330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476906955242157, gen p mean: -0.2607005834579468, mean p set: 0.44826918840408325
loss_pred:0.016010351479053497, decouple_loss:0.0029129742179065943
The modified gen p mean: 0.44837087392807007, gen p mean: -0.2586354613304138, mean p set: 0.4489421248435974
loss_pred:0.015789834782481194, decouple_loss:0.002623022999614477
The modified gen p mean: 0.44793838262557983, gen p mean: -0.2524372339248657, mean p set: 0.44847002625465393
loss_pred:0.016042718663811684, decouple_loss:0.0027579425368458033
2023-04-27 02:59:09 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.26467597484588623, mean p set: 0.4499112665653229
loss_pred:0.01646755263209343, decouple_loss:0.003751724259927869
The modified gen p mean: 0.4493022859096527, gen p mean: -0.26432955265045166, mean p set: 0.4498290419578552
loss_pred:0.016141705214977264, decouple_loss:0.003628877690061927
The modified gen p mean: 0.448222815990448, gen p mean: -0.2610797584056854, mean p set: 0.44879910349845886
loss_pred:0.016513777896761894, decouple_loss:0.0036958688870072365
WV_1_PC_1_EH_0_PS_30, loss: 0.016558952629566193, avg_mse: 0.024201037362217903
current test mse: 0.024201
Iteration: 1331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476023018360138, gen p mean: -0.26971930265426636, mean p set: 0.448184072971344
loss_pred:0.016165444627404213, decouple_loss:0.00335414195433259
The modified gen p mean: 0.448563814163208, gen p mean: -0.2638651132583618, mean p set: 0.44908660650253296
loss_pred:0.01591978408396244, decouple_loss:0.0033128666691482067
The modified gen p mean: 0.4480910301208496, gen p mean: -0.2636169195175171, mean p set: 0.4486686885356903
loss_pred:0.016238050535321236, decouple_loss:0.003210955299437046
Iteration: 1332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741734862327576, gen p mean: -0.26056838035583496, mean p set: 0.44794782996177673
loss_pred:0.017088070511817932, decouple_loss:0.0031598329078406096
The modified gen p mean: 0.4481636881828308, gen p mean: -0.2521604597568512, mean p set: 0.4487389624118805
The modified gen p mean: 0.44705772399902344, gen p mean: -0.2572425305843353, mean p set: 0.4476326107978821
loss_pred:0.01674303039908409, decouple_loss:0.003852633060887456
loss_pred:0.01588749885559082, decouple_loss:0.002948321169242263
Iteration: 1333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459194839000702, gen p mean: -0.2542550265789032, mean p set: 0.44645413756370544
loss_pred:0.01613001339137554, decouple_loss:0.0032257353886961937
The modified gen p mean: 0.4481104016304016, gen p mean: -0.2560611069202423, mean p set: 0.4486868679523468
The modified gen p mean: 0.44557687640190125, gen p mean: -0.2575981616973877, mean p set: 0.4461473524570465
loss_pred:0.015979046002030373, decouple_loss:0.003098386339843273
loss_pred:0.016583716496825218, decouple_loss:0.003456835402175784
Iteration: 1334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774749875068665, gen p mean: -0.25468897819519043, mean p set: 0.44827160239219666
loss_pred:0.016808640211820602, decouple_loss:0.003379622008651495
The modified gen p mean: 0.44811540842056274, gen p mean: -0.2571132779121399, mean p set: 0.44869908690452576
The modified gen p mean: 0.4491053521633148, gen p mean: -0.24419349431991577, mean p set: 0.44967639446258545
loss_pred:0.01576961763203144, decouple_loss:0.0036847481969743967
loss_pred:0.01565834879875183, decouple_loss:0.0034101170022040606
Iteration: 1335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482583999633789, gen p mean: -0.24658063054084778, mean p set: 0.4488369822502136
loss_pred:0.016113614663481712, decouple_loss:0.0033056323882192373
The modified gen p mean: 0.44621166586875916, gen p mean: -0.247334823012352, mean p set: 0.4467865526676178
The modified gen p mean: 0.44798293709754944, gen p mean: -0.24618901312351227, mean p set: 0.4485113322734833
loss_pred:0.016396336257457733, decouple_loss:0.0031812135130167007
loss_pred:0.0155717134475708, decouple_loss:0.0032124703284353018
Iteration: 1336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475249648094177, gen p mean: -0.24863232672214508, mean p set: 0.4481014013290405
loss_pred:0.01634254865348339, decouple_loss:0.0030150501988828182
The modified gen p mean: 0.4471571445465088, gen p mean: -0.25203999876976013, mean p set: 0.44767823815345764The modified gen p mean: 0.44736236333847046, gen p mean: -0.24493825435638428, mean p set: 0.4479406476020813
loss_pred:0.015906890854239464, decouple_loss:0.003093291772529483
loss_pred:0.01592271402478218, decouple_loss:0.0028094749432057142
Iteration: 1337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834449887275696, gen p mean: -0.24763669073581696, mean p set: 0.448919415473938
loss_pred:0.01596507430076599, decouple_loss:0.003568550804629922
The modified gen p mean: 0.44711190462112427, gen p mean: -0.24189086258411407, mean p set: 0.44764280319213867The modified gen p mean: 0.44832301139831543, gen p mean: -0.2487100213766098, mean p set: 0.44889581203460693
loss_pred:0.01631157286465168, decouple_loss:0.004098670091480017
loss_pred:0.01619977131485939, decouple_loss:0.003387855365872383
Iteration: 1338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742244482040405, gen p mean: -0.2535805106163025, mean p set: 0.4480014741420746
loss_pred:0.0157951470464468, decouple_loss:0.0027381523977965117
The modified gen p mean: 0.4473181962966919, gen p mean: -0.2551002502441406, mean p set: 0.4478928744792938
loss_pred:0.015329201705753803, decouple_loss:0.0028538662008941174
The modified gen p mean: 0.4481365382671356, gen p mean: -0.25511476397514343, mean p set: 0.4486646354198456
loss_pred:0.015592742711305618, decouple_loss:0.0029387695249170065
Iteration: 1339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848355650901794, gen p mean: -0.25335779786109924, mean p set: 0.4490565061569214
loss_pred:0.01549606490880251, decouple_loss:0.002960465382784605
The modified gen p mean: 0.4472247362136841, gen p mean: -0.24506385624408722, mean p set: 0.44780370593070984
loss_pred:0.01622980646789074, decouple_loss:0.002964387182146311
The modified gen p mean: 0.4489160180091858, gen p mean: -0.24436190724372864, mean p set: 0.44944167137145996
loss_pred:0.015890760347247124, decouple_loss:0.0028915838338434696
Iteration: 1340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588372111320496, gen p mean: -0.2455562800168991, mean p set: 0.44645223021507263
loss_pred:0.016075177118182182, decouple_loss:0.0028175164479762316
The modified gen p mean: 0.44792771339416504, gen p mean: -0.24307353794574738, mean p set: 0.44850867986679077
loss_pred:0.015715712681412697, decouple_loss:0.0033469314221292734
The modified gen p mean: 0.44591158628463745, gen p mean: -0.24883653223514557, mean p set: 0.4464397132396698
loss_pred:0.016234632581472397, decouple_loss:0.002838823711499572
2023-04-27 03:02:33 testing...
The modified gen p mean: 0.44822755455970764, gen p mean: -0.24113678932189941, mean p set: 0.44879910349845886
loss_pred:0.016612334176898003, decouple_loss:0.00351917976513505
The modified gen p mean: 0.4493051767349243, gen p mean: -0.24353796243667603, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2447793334722519, mean p set: 0.4499112665653229
loss_pred:0.016267891973257065, decouple_loss:0.003434724174439907
loss_pred:0.016668852418661118, decouple_loss:0.0033698384650051594
WV_1_PC_1_EH_0_PS_30, loss: 0.016688421368598938, avg_mse: 0.0244502741843462
current test mse: 0.02445
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 1341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903403520584106, gen p mean: -0.24242331087589264, mean p set: 0.4495624303817749
loss_pred:0.01512555219233036, decouple_loss:0.003055557142943144
The modified gen p mean: 0.4465959370136261, gen p mean: -0.24484199285507202, mean p set: 0.447174608707428
The modified gen p mean: 0.44716596603393555, gen p mean: -0.23726733028888702, mean p set: 0.447748064994812
loss_pred:0.016124235466122627, decouple_loss:0.002703534672036767
loss_pred:0.015497403219342232, decouple_loss:0.0030153284315019846
Iteration: 1342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803324341773987, gen p mean: -0.2414504438638687, mean p set: 0.4485572874546051
loss_pred:0.016022996976971626, decouple_loss:0.003088973229750991
The modified gen p mean: 0.4496177136898041, gen p mean: -0.2521272599697113, mean p set: 0.45020073652267456
The modified gen p mean: 0.44785502552986145, gen p mean: -0.24899351596832275, mean p set: 0.44843384623527527
loss_pred:0.01482008583843708, decouple_loss:0.0034023316111415625
loss_pred:0.01565861888229847, decouple_loss:0.002826905809342861
Iteration: 1343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472065567970276, gen p mean: -0.2450690120458603, mean p set: 0.4477371871471405
loss_pred:0.015533902682363987, decouple_loss:0.0032545505091547966
The modified gen p mean: 0.4497060775756836, gen p mean: -0.24791249632835388, mean p set: 0.4502794146537781
The modified gen p mean: 0.4496646821498871, gen p mean: -0.24594280123710632, mean p set: 0.4502353370189667
loss_pred:0.015487209893763065, decouple_loss:0.0038419815246015787
loss_pred:0.01495942659676075, decouple_loss:0.0040122587233781815
Iteration: 1344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474019706249237, gen p mean: -0.25596848130226135, mean p set: 0.4479774832725525
loss_pred:0.01511541660875082, decouple_loss:0.0029247687198221684
The modified gen p mean: 0.4472239911556244, gen p mean: -0.25773903727531433, mean p set: 0.4477499723434448The modified gen p mean: 0.44701850414276123, gen p mean: -0.2600117325782776, mean p set: 0.4475933015346527
loss_pred:0.015450759790837765, decouple_loss:0.0028644276317209005loss_pred:0.015953974798321724, decouple_loss:0.0030559743754565716
Iteration: 1345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488486349582672, gen p mean: -0.2599247992038727, mean p set: 0.4494233727455139
loss_pred:0.01566935144364834, decouple_loss:0.0037438813596963882
The modified gen p mean: 0.44801756739616394, gen p mean: -0.2606681287288666, mean p set: 0.44859644770622253
loss_pred:0.015263649635016918, decouple_loss:0.0032365296501666307
The modified gen p mean: 0.4473802447319031, gen p mean: -0.2613561451435089, mean p set: 0.4479064643383026
loss_pred:0.01547754555940628, decouple_loss:0.003168736817315221
Iteration: 1346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486256539821625, gen p mean: -0.26449650526046753, mean p set: 0.44920656085014343
loss_pred:0.015462072566151619, decouple_loss:0.00314754038117826
The modified gen p mean: 0.449025958776474, gen p mean: -0.25809651613235474, mean p set: 0.449554443359375The modified gen p mean: 0.44876471161842346, gen p mean: -0.2669856548309326, mean p set: 0.4493279755115509
loss_pred:0.014330996200442314, decouple_loss:0.0037108862306922674
loss_pred:0.015269817784428596, decouple_loss:0.003272422356531024
Iteration: 1347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481017291545868, gen p mean: -0.2678412199020386, mean p set: 0.44867387413978577
loss_pred:0.015567038208246231, decouple_loss:0.003950559999793768
The modified gen p mean: 0.4481028616428375, gen p mean: -0.25923100113868713, mean p set: 0.44867458939552307
loss_pred:0.01605047844350338, decouple_loss:0.0035359286703169346
The modified gen p mean: 0.45070385932922363, gen p mean: -0.2592114210128784, mean p set: 0.45123034715652466
loss_pred:0.014963766559958458, decouple_loss:0.003675187472254038
Iteration: 1348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775867462158203, gen p mean: -0.26499423384666443, mean p set: 0.4483363628387451
loss_pred:0.016055626794695854, decouple_loss:0.0030242628417909145
The modified gen p mean: 0.44751814007759094, gen p mean: -0.2637772262096405, mean p set: 0.44803765416145325The modified gen p mean: 0.44903451204299927, gen p mean: -0.27090340852737427, mean p set: 0.4496042728424072
loss_pred:0.01403549499809742, decouple_loss:0.003539407392963767
loss_pred:0.01564793661236763, decouple_loss:0.003106499556452036
Iteration: 1349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727823138237, gen p mean: -0.25898271799087524, mean p set: 0.44786569476127625
loss_pred:0.015092459507286549, decouple_loss:0.0032704793848097324
The modified gen p mean: 0.44775497913360596, gen p mean: -0.25882023572921753, mean p set: 0.44833314418792725
loss_pred:0.015878962352871895, decouple_loss:0.0032069527078419924
The modified gen p mean: 0.4483788311481476, gen p mean: -0.2616420388221741, mean p set: 0.44889771938323975
loss_pred:0.016334695741534233, decouple_loss:0.003060181625187397
Iteration: 1350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498681128025055, gen p mean: -0.2558574676513672, mean p set: 0.4504365622997284
loss_pred:0.014570427127182484, decouple_loss:0.0033925531897693872
The modified gen p mean: 0.4474538266658783, gen p mean: -0.25839143991470337, mean p set: 0.4480287730693817
loss_pred:0.01604578085243702, decouple_loss:0.00291491043753922
The modified gen p mean: 0.44888976216316223, gen p mean: -0.26386216282844543, mean p set: 0.4494149386882782
loss_pred:0.01550464890897274, decouple_loss:0.003042032942175865
2023-04-27 03:06:41 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.26339584589004517, mean p set: 0.4499112665653229
loss_pred:0.01660834066569805, decouple_loss:0.003023205790668726
The modified gen p mean: 0.4493054747581482, gen p mean: -0.26340770721435547, mean p set: 0.4498290419578552
loss_pred:0.016172589734196663, decouple_loss:0.002978646196424961
The modified gen p mean: 0.4482218325138092, gen p mean: -0.26037129759788513, mean p set: 0.44879910349845886
loss_pred:0.016579536721110344, decouple_loss:0.002978330245241523
WV_1_PC_1_EH_0_PS_30, loss: 0.01660316064953804, avg_mse: 0.024329623207449913
current test mse: 0.02433
Iteration: 1351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756120443344116, gen p mean: -0.26347994804382324, mean p set: 0.4481402039527893
loss_pred:0.015470650047063828, decouple_loss:0.0029112689662724733
The modified gen p mean: 0.4488409161567688, gen p mean: -0.2662479281425476, mean p set: 0.4493709206581116
loss_pred:0.015680301934480667, decouple_loss:0.0030462429858744144
The modified gen p mean: 0.4499381184577942, gen p mean: -0.2567344009876251, mean p set: 0.4505176842212677
loss_pred:0.014707154594361782, decouple_loss:0.002978089964017272
Iteration: 1352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495684504508972, gen p mean: -0.26054298877716064, mean p set: 0.45009157061576843
loss_pred:0.014498136006295681, decouple_loss:0.0034019153099507093
The modified gen p mean: 0.44870859384536743, gen p mean: -0.2534951865673065, mean p set: 0.4492860734462738
The modified gen p mean: 0.4482969045639038, gen p mean: -0.25669851899147034, mean p set: 0.4488815367221832
loss_pred:0.015432912856340408, decouple_loss:0.0033764387480914593
loss_pred:0.016430934891104698, decouple_loss:0.003059396520256996
Iteration: 1353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45161062479019165, gen p mean: -0.2531512677669525, mean p set: 0.4521370232105255
loss_pred:0.015273810364305973, decouple_loss:0.003041096031665802
The modified gen p mean: 0.4486008584499359, gen p mean: -0.25120168924331665, mean p set: 0.449176549911499
The modified gen p mean: 0.4480969309806824, gen p mean: -0.2590794265270233, mean p set: 0.44867774844169617
loss_pred:0.015429092571139336, decouple_loss:0.002870062831789255
loss_pred:0.015731800347566605, decouple_loss:0.0027308387216180563
Iteration: 1354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501406252384186, gen p mean: -0.24514728784561157, mean p set: 0.45067334175109863
loss_pred:0.014665190130472183, decouple_loss:0.0029950416646897793
The modified gen p mean: 0.4476035535335541, gen p mean: -0.24482326209545135, mean p set: 0.4481779932975769
The modified gen p mean: 0.44853395223617554, gen p mean: -0.24926820397377014, mean p set: 0.44910773634910583
loss_pred:0.016054050996899605, decouple_loss:0.0027915809769183397
loss_pred:0.014606719836592674, decouple_loss:0.003363097785040736
Iteration: 1355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483017325401306, gen p mean: -0.2485206127166748, mean p set: 0.44887375831604004
loss_pred:0.01602935791015625, decouple_loss:0.0030220134649425745
The modified gen p mean: 0.4472973048686981, gen p mean: -0.24544012546539307, mean p set: 0.44782793521881104The modified gen p mean: 0.44925886392593384, gen p mean: -0.25043246150016785, mean p set: 0.4498351216316223
loss_pred:0.01571492850780487, decouple_loss:0.0029455225449055433
loss_pred:0.01489787083119154, decouple_loss:0.0030996317509561777
Iteration: 1356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490646421909332, gen p mean: -0.2581922709941864, mean p set: 0.4496400058269501
loss_pred:0.015122071839869022, decouple_loss:0.0027078897692263126
The modified gen p mean: 0.4473375380039215, gen p mean: -0.24880903959274292, mean p set: 0.4479128420352936The modified gen p mean: 0.4485114812850952, gen p mean: -0.256544828414917, mean p set: 0.44904303550720215
loss_pred:0.014929661527276039, decouple_loss:0.0025597913190722466
loss_pred:0.015804508700966835, decouple_loss:0.0024486395996063948
Iteration: 1357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485305845737457, gen p mean: -0.259321928024292, mean p set: 0.44910797476768494
loss_pred:0.014699012972414494, decouple_loss:0.002762919059023261
The modified gen p mean: 0.44827768206596375, gen p mean: -0.2587079405784607, mean p set: 0.44884639978408813The modified gen p mean: 0.4497160315513611, gen p mean: -0.25582295656204224, mean p set: 0.45023879408836365
loss_pred:0.01513459999114275, decouple_loss:0.0027351423632353544
loss_pred:0.01551151368767023, decouple_loss:0.0028499015606939793
Iteration: 1358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828537106513977, gen p mean: -0.25693121552467346, mean p set: 0.44885799288749695
loss_pred:0.014977211132645607, decouple_loss:0.002749831648543477
The modified gen p mean: 0.44760796427726746, gen p mean: -0.25451943278312683, mean p set: 0.44814345240592957The modified gen p mean: 0.4489140212535858, gen p mean: -0.2622756063938141, mean p set: 0.4494871497154236
loss_pred:0.013636892661452293, decouple_loss:0.0030401088297367096
loss_pred:0.015881046652793884, decouple_loss:0.0026100946124643087
Iteration: 1359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732487201690674, gen p mean: -0.2575478255748749, mean p set: 0.4478965699672699
loss_pred:0.015367000363767147, decouple_loss:0.002985939849168062
The modified gen p mean: 0.4467419385910034, gen p mean: -0.25986191630363464, mean p set: 0.4472704529762268The modified gen p mean: 0.4468158185482025, gen p mean: -0.2565484046936035, mean p set: 0.447394996881485
loss_pred:0.015179757960140705, decouple_loss:0.0029936928767710924
loss_pred:0.01525240857154131, decouple_loss:0.003029049839824438
Iteration: 1360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488065242767334, gen p mean: -0.25309479236602783, mean p set: 0.4493841528892517
loss_pred:0.015234814956784248, decouple_loss:0.002856655977666378
The modified gen p mean: 0.44793105125427246, gen p mean: -0.2583533525466919, mean p set: 0.44846272468566895The modified gen p mean: 0.448663592338562, gen p mean: -0.25732719898223877, mean p set: 0.44923779368400574
loss_pred:0.015497560612857342, decouple_loss:0.0025746910832822323
loss_pred:0.014056678861379623, decouple_loss:0.00282665784470737
2023-04-27 03:10:04 testing...
The modified gen p mean: 0.44821837544441223, gen p mean: -0.25191888213157654, mean p set: 0.44879910349845886
loss_pred:0.01661222241818905, decouple_loss:0.002716573653742671
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2553177773952484, mean p set: 0.4499112665653229
loss_pred:0.01665584184229374, decouple_loss:0.002654043957591057
The modified gen p mean: 0.44929853081703186, gen p mean: -0.2548506557941437, mean p set: 0.4498290419578552
loss_pred:0.016272123903036118, decouple_loss:0.0027187063824385405
WV_1_PC_1_EH_0_PS_30, loss: 0.016648218035697937, avg_mse: 0.024376003071665764
current test mse: 0.024376
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 1361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474499523639679, gen p mean: -0.2532126307487488, mean p set: 0.44797900319099426
loss_pred:0.016084741801023483, decouple_loss:0.0029689990915358067
The modified gen p mean: 0.4476180672645569, gen p mean: -0.2598692774772644, mean p set: 0.44819343090057373The modified gen p mean: 0.44742104411125183, gen p mean: -0.25473445653915405, mean p set: 0.4479960799217224
loss_pred:0.016188809648156166, decouple_loss:0.002790894592180848
loss_pred:0.016220904886722565, decouple_loss:0.0026305331848561764
Iteration: 1362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482820928096771, gen p mean: -0.25095134973526, mean p set: 0.4488089084625244
loss_pred:0.016214214265346527, decouple_loss:0.0028810801450163126
The modified gen p mean: 0.4477352797985077, gen p mean: -0.25153738260269165, mean p set: 0.4483139216899872
The modified gen p mean: 0.4483553469181061, gen p mean: -0.2512538433074951, mean p set: 0.44892874360084534
loss_pred:0.0157611221075058, decouple_loss:0.0028624862898141146
loss_pred:0.015683025121688843, decouple_loss:0.0029818066395819187
Iteration: 1363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768956303596497, gen p mean: -0.25775983929634094, mean p set: 0.4482157230377197
loss_pred:0.015750374644994736, decouple_loss:0.002770746126770973
The modified gen p mean: 0.4475228190422058, gen p mean: -0.25421956181526184, mean p set: 0.448095440864563
The modified gen p mean: 0.44780734181404114, gen p mean: -0.25140413641929626, mean p set: 0.44838589429855347
loss_pred:0.015557187609374523, decouple_loss:0.0028552149888128042
loss_pred:0.01624932326376438, decouple_loss:0.002786469180136919
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477025866508484, gen p mean: -0.25421223044395447, mean p set: 0.44828298687934875
loss_pred:0.016205687075853348, decouple_loss:0.0028226168360561132
The modified gen p mean: 0.44724127650260925, gen p mean: -0.260770320892334, mean p set: 0.44776955246925354The modified gen p mean: 0.44870200753211975, gen p mean: -0.25112631916999817, mean p set: 0.44928398728370667
loss_pred:0.01585286669433117, decouple_loss:0.0029678940773010254
loss_pred:0.016224345192313194, decouple_loss:0.0028634730260819197
Iteration: 1365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787195324897766, gen p mean: -0.25822150707244873, mean p set: 0.44843557476997375
loss_pred:0.0160724725574255, decouple_loss:0.0026800199411809444
The modified gen p mean: 0.44703078269958496, gen p mean: -0.25732338428497314, mean p set: 0.4476061165332794The modified gen p mean: 0.44737112522125244, gen p mean: -0.254626989364624, mean p set: 0.4478999972343445
loss_pred:0.016165565699338913, decouple_loss:0.0026023404207080603
loss_pred:0.015924593433737755, decouple_loss:0.0027242032811045647
Iteration: 1366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478585124015808, gen p mean: -0.2485918253660202, mean p set: 0.44843021035194397
loss_pred:0.015674322843551636, decouple_loss:0.002910223323851824
The modified gen p mean: 0.4485931396484375, gen p mean: -0.24997572600841522, mean p set: 0.4491655230522156
loss_pred:0.015544320456683636, decouple_loss:0.0031462498009204865
The modified gen p mean: 0.44774746894836426, gen p mean: -0.25401195883750916, mean p set: 0.4482753276824951
loss_pred:0.016326172277331352, decouple_loss:0.003042281139642
Iteration: 1367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478115141391754, gen p mean: -0.2529425323009491, mean p set: 0.44838467240333557
loss_pred:0.015435603447258472, decouple_loss:0.002740667201578617
The modified gen p mean: 0.44782623648643494, gen p mean: -0.2510310411453247, mean p set: 0.44839832186698914
loss_pred:0.015339680947363377, decouple_loss:0.0028667037840932608
The modified gen p mean: 0.4474901556968689, gen p mean: -0.24770157039165497, mean p set: 0.4480193257331848
loss_pred:0.015652598813176155, decouple_loss:0.002718191361054778
Iteration: 1368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449061781167984, gen p mean: -0.24989350140094757, mean p set: 0.4496433436870575
loss_pred:0.015744615346193314, decouple_loss:0.0027330906596034765
The modified gen p mean: 0.4480155110359192, gen p mean: -0.25153422355651855, mean p set: 0.44854554533958435The modified gen p mean: 0.44801250100135803, gen p mean: -0.24962468445301056, mean p set: 0.4485950171947479
loss_pred:0.016285553574562073, decouple_loss:0.002767647849395871
loss_pred:0.01497835386544466, decouple_loss:0.0028520915657281876
Iteration: 1369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481000602245331, gen p mean: -0.2537883222103119, mean p set: 0.4486706554889679
loss_pred:0.015159673988819122, decouple_loss:0.0026897296775132418
The modified gen p mean: 0.4487088918685913, gen p mean: -0.24809041619300842, mean p set: 0.4492427408695221The modified gen p mean: 0.4477590322494507, gen p mean: -0.24965304136276245, mean p set: 0.4483332633972168
loss_pred:0.015758084133267403, decouple_loss:0.0026758064050227404
loss_pred:0.015694810077548027, decouple_loss:0.0026431104633957148
Iteration: 1370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480462074279785, gen p mean: -0.25562670826911926, mean p set: 0.4486139416694641
loss_pred:0.015441152267158031, decouple_loss:0.0025900709442794323
The modified gen p mean: 0.4474250376224518, gen p mean: -0.25313058495521545, mean p set: 0.44799885153770447
loss_pred:0.015277883969247341, decouple_loss:0.002679223660379648
The modified gen p mean: 0.4487319588661194, gen p mean: -0.25761163234710693, mean p set: 0.44926151633262634
loss_pred:0.015568635426461697, decouple_loss:0.003040218260139227
2023-04-27 03:14:16 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2565631568431854, mean p set: 0.4499112665653229
loss_pred:0.016497325152158737, decouple_loss:0.0032909109722822905
The modified gen p mean: 0.44929495453834534, gen p mean: -0.25637003779411316, mean p set: 0.4498290419578552
loss_pred:0.01618172787129879, decouple_loss:0.0030380727257579565
The modified gen p mean: 0.4482194483280182, gen p mean: -0.25362497568130493, mean p set: 0.44879910349845886
loss_pred:0.01648881286382675, decouple_loss:0.0032287994399666786
WV_1_PC_1_EH_0_PS_30, loss: 0.016548585146665573, avg_mse: 0.024223456159234047
current test mse: 0.024223
Iteration: 1371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752800464630127, gen p mean: -0.2607779800891876, mean p set: 0.44810721278190613
loss_pred:0.01563156768679619, decouple_loss:0.002926160814240575
The modified gen p mean: 0.4480288624763489, gen p mean: -0.25462472438812256, mean p set: 0.4485490918159485
loss_pred:0.01654159277677536, decouple_loss:0.003018483752384782
The modified gen p mean: 0.44802212715148926, gen p mean: -0.26068076491355896, mean p set: 0.44859638810157776
loss_pred:0.016422627493739128, decouple_loss:0.0029363371431827545
Iteration: 1372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478360712528229, gen p mean: -0.2587834596633911, mean p set: 0.44836533069610596
loss_pred:0.01603752188384533, decouple_loss:0.0026097330264747143
The modified gen p mean: 0.4479042887687683, gen p mean: -0.2557353675365448, mean p set: 0.4484822154045105
The modified gen p mean: 0.4476659595966339, gen p mean: -0.25824686884880066, mean p set: 0.4482516348361969
loss_pred:0.015649810433387756, decouple_loss:0.0028073813300579786
loss_pred:0.01604791171848774, decouple_loss:0.002682653721421957
Iteration: 1373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807350635528564, gen p mean: -0.25626662373542786, mean p set: 0.44859370589256287
loss_pred:0.015711816027760506, decouple_loss:0.002970375819131732
The modified gen p mean: 0.4476180672645569, gen p mean: -0.2582532465457916, mean p set: 0.44819650053977966
The modified gen p mean: 0.4473606050014496, gen p mean: -0.25676730275154114, mean p set: 0.44792643189430237
loss_pred:0.015287178568542004, decouple_loss:0.00277877994813025
loss_pred:0.01595902629196644, decouple_loss:0.0025754645466804504
Iteration: 1374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824814796447754, gen p mean: -0.2564696669578552, mean p set: 0.448775053024292
loss_pred:0.01639939844608307, decouple_loss:0.0025804827455431223
The modified gen p mean: 0.4474140703678131, gen p mean: -0.2602618634700775, mean p set: 0.4479837417602539
The modified gen p mean: 0.4479077458381653, gen p mean: -0.2605046033859253, mean p set: 0.44847962260246277
loss_pred:0.015987008810043335, decouple_loss:0.002820601686835289
loss_pred:0.01626029796898365, decouple_loss:0.0026834276504814625
Iteration: 1375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484691023826599, gen p mean: -0.2569468021392822, mean p set: 0.44904080033302307
loss_pred:0.015151526778936386, decouple_loss:0.002735114423558116
The modified gen p mean: 0.4483708143234253, gen p mean: -0.2547721564769745, mean p set: 0.44889721274375916The modified gen p mean: 0.4471115171909332, gen p mean: -0.25979846715927124, mean p set: 0.4476796090602875
loss_pred:0.016027456149458885, decouple_loss:0.0025863992050290108
loss_pred:0.015298749320209026, decouple_loss:0.0026688252110034227
Iteration: 1376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474515914916992, gen p mean: -0.25764793157577515, mean p set: 0.44802939891815186
loss_pred:0.016119271516799927, decouple_loss:0.002695919945836067
The modified gen p mean: 0.4483850598335266, gen p mean: -0.25606340169906616, mean p set: 0.4489077031612396The modified gen p mean: 0.4480259418487549, gen p mean: -0.25161880254745483, mean p set: 0.44859760999679565
loss_pred:0.01640317216515541, decouple_loss:0.00265739974565804
loss_pred:0.014970398508012295, decouple_loss:0.002956409938633442
Iteration: 1377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481353461742401, gen p mean: -0.2513425946235657, mean p set: 0.4487065374851227
loss_pred:0.01530580036342144, decouple_loss:0.002626079600304365
The modified gen p mean: 0.44783762097358704, gen p mean: -0.25756072998046875, mean p set: 0.4483576714992523The modified gen p mean: 0.4479711353778839, gen p mean: -0.2541029751300812, mean p set: 0.44854387640953064
loss_pred:0.015787074342370033, decouple_loss:0.002625771565362811
loss_pred:0.016080250963568687, decouple_loss:0.0027549981605261564
Iteration: 1378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447896808385849, gen p mean: -0.26067984104156494, mean p set: 0.44847777485847473
loss_pred:0.015398177318274975, decouple_loss:0.0025817903224378824
The modified gen p mean: 0.4477768838405609, gen p mean: -0.2581796646118164, mean p set: 0.448341965675354
loss_pred:0.01600039005279541, decouple_loss:0.002481665927916765
The modified gen p mean: 0.4477481544017792, gen p mean: -0.2570978105068207, mean p set: 0.44828253984451294
loss_pred:0.01568746007978916, decouple_loss:0.002396194264292717
Iteration: 1379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731757044792175, gen p mean: -0.25511622428894043, mean p set: 0.44789719581604004
loss_pred:0.015342005528509617, decouple_loss:0.0026332573033869267
The modified gen p mean: 0.4471786618232727, gen p mean: -0.2592153549194336, mean p set: 0.4477587640285492
loss_pred:0.0158520694822073, decouple_loss:0.002704361919313669
The modified gen p mean: 0.4475887417793274, gen p mean: -0.2577991783618927, mean p set: 0.4481166899204254
loss_pred:0.016145724803209305, decouple_loss:0.0029432778246700764
Iteration: 1380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478794038295746, gen p mean: -0.2557049095630646, mean p set: 0.44846177101135254
loss_pred:0.015519479289650917, decouple_loss:0.0024714351166039705
The modified gen p mean: 0.44824862480163574, gen p mean: -0.2594935894012451, mean p set: 0.4488312005996704
loss_pred:0.015116237103939056, decouple_loss:0.0025510143022984266
The modified gen p mean: 0.4476768970489502, gen p mean: -0.25984710454940796, mean p set: 0.448201984167099
loss_pred:0.015153340063989162, decouple_loss:0.0026818120386451483
2023-04-27 03:17:40 testing...
The modified gen p mean: 0.4482216536998749, gen p mean: -0.25281310081481934, mean p set: 0.44879910349845886
loss_pred:0.01637093722820282, decouple_loss:0.002706376602873206
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2557721436023712, mean p set: 0.4499112665653229
loss_pred:0.016548044979572296, decouple_loss:0.0026919636875391006
The modified gen p mean: 0.44930320978164673, gen p mean: -0.25578823685646057, mean p set: 0.4498290419578552
loss_pred:0.01614215224981308, decouple_loss:0.0026859145145863295
WV_1_PC_1_EH_0_PS_30, loss: 0.016488447785377502, avg_mse: 0.02420945279300213
current test mse: 0.024209
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 1381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470437467098236, gen p mean: -0.2538396120071411, mean p set: 0.4475656747817993
loss_pred:0.01582225039601326, decouple_loss:0.002538796281442046
The modified gen p mean: 0.44870811700820923, gen p mean: -0.2623983323574066, mean p set: 0.44927650690078735
loss_pred:0.015332016162574291, decouple_loss:0.0025718435645103455
The modified gen p mean: 0.4468996524810791, gen p mean: -0.25693678855895996, mean p set: 0.44747447967529297
loss_pred:0.015538058243691921, decouple_loss:0.0026804213412106037
Iteration: 1382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482992887496948, gen p mean: -0.2526458501815796, mean p set: 0.4488321542739868
loss_pred:0.015462532639503479, decouple_loss:0.002491282531991601
The modified gen p mean: 0.4480619728565216, gen p mean: -0.2551763653755188, mean p set: 0.4486336410045624
loss_pred:0.015818148851394653, decouple_loss:0.0027922175358980894
The modified gen p mean: 0.4479001462459564, gen p mean: -0.2525665760040283, mean p set: 0.44847849011421204
loss_pred:0.015554646030068398, decouple_loss:0.0025804871693253517
Iteration: 1383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480641484260559, gen p mean: -0.24818925559520721, mean p set: 0.44859448075294495
loss_pred:0.016251850873231888, decouple_loss:0.002908997004851699
The modified gen p mean: 0.4461309015750885, gen p mean: -0.25252220034599304, mean p set: 0.4467092752456665
loss_pred:0.01631525531411171, decouple_loss:0.0027593374252319336
The modified gen p mean: 0.4471423327922821, gen p mean: -0.24715711176395416, mean p set: 0.4477138817310333
loss_pred:0.0155932093039155, decouple_loss:0.0025051378179341555
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477691054344177, gen p mean: -0.24882066249847412, mean p set: 0.4483067989349365
loss_pred:0.016118071973323822, decouple_loss:0.0025677825324237347
The modified gen p mean: 0.4476149380207062, gen p mean: -0.25378546118736267, mean p set: 0.44818755984306335
loss_pred:0.016076959669589996, decouple_loss:0.0025540704373270273
The modified gen p mean: 0.44871577620506287, gen p mean: -0.2521025538444519, mean p set: 0.44928810000419617
loss_pred:0.015666795894503593, decouple_loss:0.002630419097840786
Iteration: 1385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476141929626465, gen p mean: -0.2523243725299835, mean p set: 0.4481431543827057
loss_pred:0.015365419909358025, decouple_loss:0.0024309610016644
The modified gen p mean: 0.4464905560016632, gen p mean: -0.2510135769844055, mean p set: 0.4470709264278412
loss_pred:0.016800347715616226, decouple_loss:0.002756627509370446
The modified gen p mean: 0.4479343295097351, gen p mean: -0.253412127494812, mean p set: 0.4485151767730713
loss_pred:0.015254518948495388, decouple_loss:0.002432816429063678
Iteration: 1386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715040922164917, gen p mean: -0.2499316781759262, mean p set: 0.44772249460220337
loss_pred:0.015915608033537865, decouple_loss:0.0023117021191865206
The modified gen p mean: 0.44781455397605896, gen p mean: -0.25561144948005676, mean p set: 0.4483872950077057The modified gen p mean: 0.44689634442329407, gen p mean: -0.25429773330688477, mean p set: 0.44742488861083984
loss_pred:0.015568048693239689, decouple_loss:0.0025304979644715786
loss_pred:0.016496766358613968, decouple_loss:0.002703741192817688
Iteration: 1387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466380178928375, gen p mean: -0.2522943615913391, mean p set: 0.44717034697532654
loss_pred:0.016461022198200226, decouple_loss:0.003008119761943817
The modified gen p mean: 0.44719359278678894, gen p mean: -0.2483813613653183, mean p set: 0.44777190685272217
loss_pred:0.014827391132712364, decouple_loss:0.002618289552628994
The modified gen p mean: 0.44593802094459534, gen p mean: -0.2550991177558899, mean p set: 0.44651445746421814
loss_pred:0.015032406896352768, decouple_loss:0.0027319369837641716
Iteration: 1388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807612895965576, gen p mean: -0.24774092435836792, mean p set: 0.4486530125141144
loss_pred:0.01635962910950184, decouple_loss:0.00298141036182642
The modified gen p mean: 0.44656771421432495, gen p mean: -0.25038567185401917, mean p set: 0.44710099697113037
The modified gen p mean: 0.44635245203971863, gen p mean: -0.24710066616535187, mean p set: 0.4469250440597534
loss_pred:0.016819065436720848, decouple_loss:0.002857279498130083
loss_pred:0.015267218463122845, decouple_loss:0.002526417374610901
Iteration: 1389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485660493373871, gen p mean: -0.2511478364467621, mean p set: 0.44913914799690247
loss_pred:0.016029804944992065, decouple_loss:0.0026193694211542606
The modified gen p mean: 0.44548243284225464, gen p mean: -0.250535249710083, mean p set: 0.4460570514202118
loss_pred:0.015124141238629818, decouple_loss:0.0024680595379322767
The modified gen p mean: 0.44717687368392944, gen p mean: -0.2470320165157318, mean p set: 0.4477066397666931
loss_pred:0.015895480290055275, decouple_loss:0.0024292797315865755
Iteration: 1390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485118091106415, gen p mean: -0.25635623931884766, mean p set: 0.449090838432312
loss_pred:0.015485537238419056, decouple_loss:0.002739802235737443
The modified gen p mean: 0.4487760066986084, gen p mean: -0.25172436237335205, mean p set: 0.44929662346839905The modified gen p mean: 0.4476637840270996, gen p mean: -0.2525272071361542, mean p set: 0.44823282957077026
loss_pred:0.016167866066098213, decouple_loss:0.0026238104328513145
loss_pred:0.015269135124981403, decouple_loss:0.0027582410257309675
2023-04-27 03:21:43 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25062939524650574, mean p set: 0.4499112665653229
loss_pred:0.016583001241087914, decouple_loss:0.0027246978133916855
The modified gen p mean: 0.4482225179672241, gen p mean: -0.247661292552948, mean p set: 0.44879910349845886
loss_pred:0.0164980199187994, decouple_loss:0.002754796063527465
The modified gen p mean: 0.44929927587509155, gen p mean: -0.2505621612071991, mean p set: 0.4498290419578552
loss_pred:0.016174806281924248, decouple_loss:0.002678828313946724
WV_1_PC_1_EH_0_PS_30, loss: 0.016554582864046097, avg_mse: 0.024295490235090256
current test mse: 0.024295
Iteration: 1391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446532666683197, gen p mean: -0.2500231862068176, mean p set: 0.4471120834350586
loss_pred:0.015781667083501816, decouple_loss:0.0027030191849917173
The modified gen p mean: 0.4459657371044159, gen p mean: -0.248636394739151, mean p set: 0.44649171829223633
loss_pred:0.016058266162872314, decouple_loss:0.0028066819068044424
The modified gen p mean: 0.44606298208236694, gen p mean: -0.24997219443321228, mean p set: 0.4466347098350525
loss_pred:0.01528850570321083, decouple_loss:0.0027422765269875526
Iteration: 1392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476242959499359, gen p mean: -0.254885733127594, mean p set: 0.44815605878829956
loss_pred:0.015316040255129337, decouple_loss:0.0025586052797734737
The modified gen p mean: 0.44693082571029663, gen p mean: -0.2559891939163208, mean p set: 0.4475022256374359
The modified gen p mean: 0.4463898837566376, gen p mean: -0.2540998160839081, mean p set: 0.44696107506752014
loss_pred:0.015722479671239853, decouple_loss:0.0025432780385017395
loss_pred:0.015837209299206734, decouple_loss:0.0026967492885887623
Iteration: 1393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478171169757843, gen p mean: -0.25446152687072754, mean p set: 0.4483468234539032
loss_pred:0.015116490423679352, decouple_loss:0.002545337425544858
The modified gen p mean: 0.44719934463500977, gen p mean: -0.25157445669174194, mean p set: 0.4477720260620117
The modified gen p mean: 0.4472086429595947, gen p mean: -0.25458675622940063, mean p set: 0.44778627157211304
loss_pred:0.01563841663300991, decouple_loss:0.0025679769460111856
loss_pred:0.01562851294875145, decouple_loss:0.0025514508597552776
Iteration: 1394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745302200317383, gen p mean: -0.2526567876338959, mean p set: 0.4479806125164032
loss_pred:0.01562892086803913, decouple_loss:0.002448883606120944
The modified gen p mean: 0.44629573822021484, gen p mean: -0.25064215064048767, mean p set: 0.44687098264694214
The modified gen p mean: 0.4481644034385681, gen p mean: -0.25102856755256653, mean p set: 0.4487445652484894
loss_pred:0.015004701912403107, decouple_loss:0.0024875786621123552
loss_pred:0.015588506124913692, decouple_loss:0.002314699115231633
Iteration: 1395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701841473579407, gen p mean: -0.24454765021800995, mean p set: 0.44754740595817566
loss_pred:0.016159560531377792, decouple_loss:0.0029144063591957092
The modified gen p mean: 0.44586896896362305, gen p mean: -0.24903389811515808, mean p set: 0.4464513063430786
The modified gen p mean: 0.44834479689598083, gen p mean: -0.2523767650127411, mean p set: 0.4489142596721649
loss_pred:0.016276704147458076, decouple_loss:0.0027782157994806767
loss_pred:0.015240039676427841, decouple_loss:0.0028139441274106503
Iteration: 1396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44514185190200806, gen p mean: -0.25316524505615234, mean p set: 0.44571492075920105
loss_pred:0.01517588458955288, decouple_loss:0.00259383930824697
The modified gen p mean: 0.44715598225593567, gen p mean: -0.24741728603839874, mean p set: 0.44768208265304565The modified gen p mean: 0.4481613337993622, gen p mean: -0.25003719329833984, mean p set: 0.44873204827308655
loss_pred:0.015046628192067146, decouple_loss:0.0025290579069405794
loss_pred:0.015023738145828247, decouple_loss:0.0026246749330312014
Iteration: 1397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656693935394287, gen p mean: -0.25423383712768555, mean p set: 0.44714486598968506
loss_pred:0.016041850671172142, decouple_loss:0.002590390620753169
The modified gen p mean: 0.4470418095588684, gen p mean: -0.25389206409454346, mean p set: 0.44757208228111267The modified gen p mean: 0.4473443031311035, gen p mean: -0.25127431750297546, mean p set: 0.4479168951511383
loss_pred:0.015027367509901524, decouple_loss:0.00241467054001987
loss_pred:0.01520115789026022, decouple_loss:0.002508310368284583
Iteration: 1398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489209055900574, gen p mean: -0.2576199769973755, mean p set: 0.44949212670326233
loss_pred:0.015292247757315636, decouple_loss:0.002660202095285058
The modified gen p mean: 0.44643133878707886, gen p mean: -0.2544008791446686, mean p set: 0.44701406359672546
loss_pred:0.016255972906947136, decouple_loss:0.0028100355993956327
The modified gen p mean: 0.4467204511165619, gen p mean: -0.2521469295024872, mean p set: 0.4472406804561615
loss_pred:0.01554986834526062, decouple_loss:0.002463905606418848
Iteration: 1399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678205251693726, gen p mean: -0.24895164370536804, mean p set: 0.4473552703857422
loss_pred:0.01561810914427042, decouple_loss:0.0025610371958464384
The modified gen p mean: 0.4462982714176178, gen p mean: -0.2513335645198822, mean p set: 0.44687342643737793
loss_pred:0.016434412449598312, decouple_loss:0.002486975397914648
The modified gen p mean: 0.445690393447876, gen p mean: -0.2519608736038208, mean p set: 0.4462227523326874
loss_pred:0.015097487717866898, decouple_loss:0.002873976482078433
Iteration: 1400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448051393032074, gen p mean: -0.24780550599098206, mean p set: 0.4486321210861206
loss_pred:0.015143468976020813, decouple_loss:0.002272040583193302
The modified gen p mean: 0.447945773601532, gen p mean: -0.24577724933624268, mean p set: 0.4485243558883667
loss_pred:0.015088184736669064, decouple_loss:0.002426625695079565
The modified gen p mean: 0.44791269302368164, gen p mean: -0.24679848551750183, mean p set: 0.44843539595603943
loss_pred:0.014985249377787113, decouple_loss:0.0024937246926128864
2023-04-27 03:25:08 testing...
The modified gen p mean: 0.44821977615356445, gen p mean: -0.2407446801662445, mean p set: 0.44879910349845886
loss_pred:0.0164678655564785, decouple_loss:0.003107978729531169
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24380163848400116, mean p set: 0.4499112665653229
loss_pred:0.016502026468515396, decouple_loss:0.0031941919587552547
The modified gen p mean: 0.4493015706539154, gen p mean: -0.24312391877174377, mean p set: 0.4498290419578552
loss_pred:0.016158945858478546, decouple_loss:0.003026286605745554
WV_1_PC_1_EH_0_PS_30, loss: 0.016531754285097122, avg_mse: 0.024304639548063278
current test mse: 0.024305
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 1401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487312138080597, gen p mean: -0.24362878501415253, mean p set: 0.4492567181587219
loss_pred:0.015438532456755638, decouple_loss:0.0026170529890805483
The modified gen p mean: 0.4485873878002167, gen p mean: -0.24200475215911865, mean p set: 0.44916436076164246
The modified gen p mean: 0.4493573307991028, gen p mean: -0.24259507656097412, mean p set: 0.44993188977241516
loss_pred:0.015138691291213036, decouple_loss:0.002981254830956459
loss_pred:0.015561141073703766, decouple_loss:0.0025526522658765316
Iteration: 1402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481394290924072, gen p mean: -0.2441151887178421, mean p set: 0.44866296648979187
loss_pred:0.015909776091575623, decouple_loss:0.0029715292621403933
The modified gen p mean: 0.44856882095336914, gen p mean: -0.24986398220062256, mean p set: 0.449150025844574
loss_pred:0.015291476622223854, decouple_loss:0.002812741557136178
The modified gen p mean: 0.44808101654052734, gen p mean: -0.246907040476799, mean p set: 0.4486553370952606
loss_pred:0.01577192172408104, decouple_loss:0.0026111130136996508
Iteration: 1403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872868061065674, gen p mean: -0.24616031348705292, mean p set: 0.44925642013549805
loss_pred:0.015667326748371124, decouple_loss:0.0028988271951675415
The modified gen p mean: 0.44798317551612854, gen p mean: -0.24677594006061554, mean p set: 0.44856372475624084
loss_pred:0.015250631608068943, decouple_loss:0.002959928475320339
The modified gen p mean: 0.44751644134521484, gen p mean: -0.2425827831029892, mean p set: 0.4480970501899719
loss_pred:0.015123918652534485, decouple_loss:0.0026833871379494667
Iteration: 1404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848692417144775, gen p mean: -0.2489759922027588, mean p set: 0.4490225911140442
loss_pred:0.015600336715579033, decouple_loss:0.0029906912241131067
The modified gen p mean: 0.44772911071777344, gen p mean: -0.2461707592010498, mean p set: 0.44830384850502014
loss_pred:0.014598983339965343, decouple_loss:0.002551034325733781
The modified gen p mean: 0.44907814264297485, gen p mean: -0.2529146373271942, mean p set: 0.4496510326862335
loss_pred:0.015532383695244789, decouple_loss:0.0028473862912505865
Iteration: 1405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987550377845764, gen p mean: -0.2469858080148697, mean p set: 0.4504498541355133
loss_pred:0.01502138003706932, decouple_loss:0.003150694537907839
The modified gen p mean: 0.4478888213634491, gen p mean: -0.25297412276268005, mean p set: 0.448469340801239The modified gen p mean: 0.44879940152168274, gen p mean: -0.24363195896148682, mean p set: 0.44932955503463745
loss_pred:0.014978514984250069, decouple_loss:0.0029870460275560617
loss_pred:0.015641894191503525, decouple_loss:0.0032270746305584908
Iteration: 1406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475158452987671, gen p mean: -0.24181155860424042, mean p set: 0.4480898678302765
loss_pred:0.01543074008077383, decouple_loss:0.0027904838789254427
The modified gen p mean: 0.44784969091415405, gen p mean: -0.24533240497112274, mean p set: 0.4484257698059082The modified gen p mean: 0.4472866654396057, gen p mean: -0.24457356333732605, mean p set: 0.4478180706501007
loss_pred:0.015468103811144829, decouple_loss:0.0026320009492337704
loss_pred:0.016068672761321068, decouple_loss:0.0032104107085615396
Iteration: 1407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448713481426239, gen p mean: -0.2394985556602478, mean p set: 0.4492858350276947
loss_pred:0.015194255858659744, decouple_loss:0.0030155745334923267
The modified gen p mean: 0.44826439023017883, gen p mean: -0.24535226821899414, mean p set: 0.44883859157562256The modified gen p mean: 0.44787201285362244, gen p mean: -0.23611904680728912, mean p set: 0.44840162992477417
loss_pred:0.014685810543596745, decouple_loss:0.0030645374208688736
loss_pred:0.014732428826391697, decouple_loss:0.0030891690403223038
Iteration: 1408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479887783527374, gen p mean: -0.23950280249118805, mean p set: 0.4485659599304199
loss_pred:0.015640219673514366, decouple_loss:0.0028238629456609488
The modified gen p mean: 0.4488585591316223, gen p mean: -0.2389986664056778, mean p set: 0.44943690299987793The modified gen p mean: 0.4476639926433563, gen p mean: -0.23422348499298096, mean p set: 0.4481886029243469
loss_pred:0.014944811351597309, decouple_loss:0.002695011207833886
loss_pred:0.015033658593893051, decouple_loss:0.0027222556527704
Iteration: 1409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448487251996994, gen p mean: -0.24328525364398956, mean p set: 0.4490663409233093
loss_pred:0.01488539855927229, decouple_loss:0.00307283503934741
The modified gen p mean: 0.4473447799682617, gen p mean: -0.24486970901489258, mean p set: 0.4479256868362427
loss_pred:0.015062405727803707, decouple_loss:0.003008453408256173
The modified gen p mean: 0.44939282536506653, gen p mean: -0.24076300859451294, mean p set: 0.4499247372150421
loss_pred:0.014726316556334496, decouple_loss:0.0028262492269277573
Iteration: 1410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935137033462524, gen p mean: -0.23967643082141876, mean p set: 0.44992080330848694
loss_pred:0.015953900292515755, decouple_loss:0.0026534623466432095
The modified gen p mean: 0.4485284984111786, gen p mean: -0.2373465597629547, mean p set: 0.44905519485473633The modified gen p mean: 0.44888192415237427, gen p mean: -0.24099959433078766, mean p set: 0.44945937395095825
loss_pred:0.014098906889557838, decouple_loss:0.002660971600562334
loss_pred:0.015341797843575478, decouple_loss:0.0030007222667336464
2023-04-27 03:29:14 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2407948225736618, mean p set: 0.4499112665653229
loss_pred:0.016779744997620583, decouple_loss:0.003001850564032793
The modified gen p mean: 0.44929882884025574, gen p mean: -0.2402224838733673, mean p set: 0.4498290419578552
loss_pred:0.01629314199090004, decouple_loss:0.003045888850465417
The modified gen p mean: 0.44822564721107483, gen p mean: -0.23765812814235687, mean p set: 0.44879910349845886
loss_pred:0.016699284315109253, decouple_loss:0.0030687586404383183
WV_1_PC_1_EH_0_PS_30, loss: 0.016742665320634842, avg_mse: 0.024693617597222328
current test mse: 0.024694
Iteration: 1411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773462414741516, gen p mean: -0.23738107085227966, mean p set: 0.4483124613761902
loss_pred:0.01486119069159031, decouple_loss:0.0027763708494603634
The modified gen p mean: 0.44838395714759827, gen p mean: -0.23865661025047302, mean p set: 0.4489034116268158
loss_pred:0.015093968249857426, decouple_loss:0.0030897685792297125
The modified gen p mean: 0.44839853048324585, gen p mean: -0.23873646557331085, mean p set: 0.44897738099098206
loss_pred:0.01468304917216301, decouple_loss:0.0029985581059008837
Iteration: 1412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836053252220154, gen p mean: -0.2394409030675888, mean p set: 0.4488871097564697
loss_pred:0.014941385947167873, decouple_loss:0.0030869790352880955
The modified gen p mean: 0.44759005308151245, gen p mean: -0.2342880815267563, mean p set: 0.4481671154499054
The modified gen p mean: 0.44904351234436035, gen p mean: -0.23191846907138824, mean p set: 0.4496217370033264
loss_pred:0.014929287135601044, decouple_loss:0.002795197768136859
loss_pred:0.014727537520229816, decouple_loss:0.0030189126264303923
Iteration: 1413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448712021112442, gen p mean: -0.23952162265777588, mean p set: 0.4492400586605072
loss_pred:0.015924206003546715, decouple_loss:0.0025611212477087975
The modified gen p mean: 0.44774389266967773, gen p mean: -0.24139569699764252, mean p set: 0.44832542538642883
The modified gen p mean: 0.4482990503311157, gen p mean: -0.2393842190504074, mean p set: 0.4488828480243683
loss_pred:0.01546378806233406, decouple_loss:0.002744758501648903
loss_pred:0.015540298074483871, decouple_loss:0.0028130740392953157
Iteration: 1414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471093714237213, gen p mean: -0.24235127866268158, mean p set: 0.4476362466812134
loss_pred:0.016127312555909157, decouple_loss:0.0031294841319322586
The modified gen p mean: 0.4496099352836609, gen p mean: -0.243689626455307, mean p set: 0.45019209384918213
The modified gen p mean: 0.4496382772922516, gen p mean: -0.2421610802412033, mean p set: 0.450207382440567
loss_pred:0.01572572998702526, decouple_loss:0.0027115349657833576
loss_pred:0.014687948860228062, decouple_loss:0.0029429553542286158
Iteration: 1415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738221168518066, gen p mean: -0.24634946882724762, mean p set: 0.4479579031467438
loss_pred:0.015414782799780369, decouple_loss:0.002907632850110531
The modified gen p mean: 0.44781747460365295, gen p mean: -0.24484585225582123, mean p set: 0.44834965467453003The modified gen p mean: 0.44842100143432617, gen p mean: -0.24240387976169586, mean p set: 0.44900044798851013
loss_pred:0.015924660488963127, decouple_loss:0.002682184102013707
loss_pred:0.014888685196638107, decouple_loss:0.0029150466434657574
Iteration: 1416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806161522865295, gen p mean: -0.24858196079730988, mean p set: 0.4486420452594757
loss_pred:0.01578225940465927, decouple_loss:0.0032870089635252953
The modified gen p mean: 0.44890227913856506, gen p mean: -0.24704419076442719, mean p set: 0.449429988861084The modified gen p mean: 0.4490868151187897, gen p mean: -0.24726331233978271, mean p set: 0.44965940713882446
loss_pred:0.014424091205000877, decouple_loss:0.003016899572685361
loss_pred:0.01564926467835903, decouple_loss:0.002955084666609764
Iteration: 1417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483184814453125, gen p mean: -0.25256359577178955, mean p set: 0.4488929510116577
loss_pred:0.015521830879151821, decouple_loss:0.0026710270904004574
The modified gen p mean: 0.4483034610748291, gen p mean: -0.2526191771030426, mean p set: 0.4488309919834137The modified gen p mean: 0.44783705472946167, gen p mean: -0.2465248852968216, mean p set: 0.44841691851615906
loss_pred:0.014666062779724598, decouple_loss:0.002553024096414447
loss_pred:0.015697987750172615, decouple_loss:0.0026102939154952765
Iteration: 1418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44913503527641296, gen p mean: -0.2521595060825348, mean p set: 0.4497077465057373
loss_pred:0.01518045924603939, decouple_loss:0.0028746374882757664
The modified gen p mean: 0.44872990250587463, gen p mean: -0.2433861941099167, mean p set: 0.44930222630500793The modified gen p mean: 0.4485999643802643, gen p mean: -0.24721810221672058, mean p set: 0.44913092255592346
loss_pred:0.015342975035309792, decouple_loss:0.0032073785550892353
loss_pred:0.015074452385306358, decouple_loss:0.0031302461866289377
Iteration: 1419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44913849234580994, gen p mean: -0.24129293859004974, mean p set: 0.44971105456352234
loss_pred:0.015028725378215313, decouple_loss:0.0026857813354581594
The modified gen p mean: 0.4487803876399994, gen p mean: -0.24999268352985382, mean p set: 0.44930025935173035The modified gen p mean: 0.4479089677333832, gen p mean: -0.24889902770519257, mean p set: 0.4484882652759552
loss_pred:0.014633585698902607, decouple_loss:0.002551501616835594
loss_pred:0.014750785194337368, decouple_loss:0.0027153482660651207
Iteration: 1420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500974118709564, gen p mean: -0.24673905968666077, mean p set: 0.4506753385066986
loss_pred:0.014846852980554104, decouple_loss:0.003588538384065032
The modified gen p mean: 0.44854021072387695, gen p mean: -0.24791283905506134, mean p set: 0.4490686058998108The modified gen p mean: 0.44862574338912964, gen p mean: -0.2420431673526764, mean p set: 0.44919553399086
loss_pred:0.015268830582499504, decouple_loss:0.0032080679666250944
loss_pred:0.015746628865599632, decouple_loss:0.003119193483144045
2023-04-27 03:32:39 testing...
The modified gen p mean: 0.44822126626968384, gen p mean: -0.2439560741186142, mean p set: 0.44879910349845886
loss_pred:0.016581973060965538, decouple_loss:0.002763227093964815
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24695158004760742, mean p set: 0.4499112665653229
loss_pred:0.016739582642912865, decouple_loss:0.0027402399573475122
The modified gen p mean: 0.44929614663124084, gen p mean: -0.246597021818161, mean p set: 0.4498290419578552
loss_pred:0.016232367604970932, decouple_loss:0.002676028059795499
WV_1_PC_1_EH_0_PS_30, loss: 0.016654299572110176, avg_mse: 0.02452106960117817
current test mse: 0.024521
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 1421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491353929042816, gen p mean: -0.2486843317747116, mean p set: 0.4496676027774811
loss_pred:0.016523446887731552, decouple_loss:0.0027670355048030615
The modified gen p mean: 0.4482314884662628, gen p mean: -0.24650925397872925, mean p set: 0.44880983233451843
loss_pred:0.016966084018349648, decouple_loss:0.0028201709501445293
The modified gen p mean: 0.4485163986682892, gen p mean: -0.24698171019554138, mean p set: 0.4490887224674225
loss_pred:0.015392987057566643, decouple_loss:0.0028855171985924244
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751831889152527, gen p mean: -0.24241791665554047, mean p set: 0.44804567098617554
loss_pred:0.015418356284499168, decouple_loss:0.0029313310515135527
The modified gen p mean: 0.4476310610771179, gen p mean: -0.24436594545841217, mean p set: 0.44820985198020935
loss_pred:0.016145844012498856, decouple_loss:0.0028417338617146015
The modified gen p mean: 0.447321355342865, gen p mean: -0.24637503921985626, mean p set: 0.44789400696754456
loss_pred:0.01631755381822586, decouple_loss:0.002884448738768697
Iteration: 1423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831353425979614, gen p mean: -0.24220116436481476, mean p set: 0.4488394856452942
loss_pred:0.015641480684280396, decouple_loss:0.0028090241830796003
The modified gen p mean: 0.4471115171909332, gen p mean: -0.24212609231472015, mean p set: 0.447688490152359
loss_pred:0.015716305002570152, decouple_loss:0.0025328409392386675
The modified gen p mean: 0.4483199715614319, gen p mean: -0.24204906821250916, mean p set: 0.4488913416862488
loss_pred:0.01674707606434822, decouple_loss:0.002528019715100527
Iteration: 1424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745367765426636, gen p mean: -0.24931979179382324, mean p set: 0.44798803329467773
loss_pred:0.015719881281256676, decouple_loss:0.0027833092026412487
The modified gen p mean: 0.44773048162460327, gen p mean: -0.24455991387367249, mean p set: 0.4483044445514679
loss_pred:0.016575763002038002, decouple_loss:0.002884139306843281
The modified gen p mean: 0.44936394691467285, gen p mean: -0.2477780282497406, mean p set: 0.4499371349811554
loss_pred:0.015583858825266361, decouple_loss:0.0027256153989583254
Iteration: 1425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799840450286865, gen p mean: -0.2519300580024719, mean p set: 0.44857507944107056
loss_pred:0.01529095321893692, decouple_loss:0.002468458143994212
The modified gen p mean: 0.448493093252182, gen p mean: -0.25114771723747253, mean p set: 0.4490683674812317The modified gen p mean: 0.4480922520160675, gen p mean: -0.2520156800746918, mean p set: 0.44861847162246704
loss_pred:0.015217202715575695, decouple_loss:0.0023800991475582123
loss_pred:0.01539159007370472, decouple_loss:0.002509048907086253
Iteration: 1426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783708453178406, gen p mean: -0.2534954249858856, mean p set: 0.4484177529811859
loss_pred:0.01587534137070179, decouple_loss:0.002847380004823208
The modified gen p mean: 0.447534441947937, gen p mean: -0.2510972321033478, mean p set: 0.4481090009212494The modified gen p mean: 0.4479736387729645, gen p mean: -0.2522926330566406, mean p set: 0.4485079050064087
loss_pred:0.0159089807420969, decouple_loss:0.002771075116470456
loss_pred:0.01536540500819683, decouple_loss:0.00287004467099905
Iteration: 1427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815945625305176, gen p mean: -0.24796618521213531, mean p set: 0.44872695207595825
loss_pred:0.016064735129475594, decouple_loss:0.0025278660468757153
The modified gen p mean: 0.44842782616615295, gen p mean: -0.2529275715351105, mean p set: 0.4489997327327728The modified gen p mean: 0.44946855306625366, gen p mean: -0.25026220083236694, mean p set: 0.4499906599521637
loss_pred:0.015760332345962524, decouple_loss:0.0026903857942670584
loss_pred:0.015596047975122929, decouple_loss:0.0024377168156206608
Iteration: 1428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474451541900635, gen p mean: -0.2542707324028015, mean p set: 0.4480244815349579
loss_pred:0.01579338312149048, decouple_loss:0.0024799664970487356
The modified gen p mean: 0.44837918877601624, gen p mean: -0.24903041124343872, mean p set: 0.44895321130752563
loss_pred:0.015169911086559296, decouple_loss:0.002566695213317871
The modified gen p mean: 0.44811156392097473, gen p mean: -0.25230687856674194, mean p set: 0.4486456513404846
loss_pred:0.01614537462592125, decouple_loss:0.0024999743327498436
Iteration: 1429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481831192970276, gen p mean: -0.24694281816482544, mean p set: 0.4487592875957489
loss_pred:0.016771048307418823, decouple_loss:0.002618449041619897
The modified gen p mean: 0.4470149576663971, gen p mean: -0.2484104037284851, mean p set: 0.4475880563259125The modified gen p mean: 0.448081910610199, gen p mean: -0.2494201362133026, mean p set: 0.44860783219337463
loss_pred:0.016071420162916183, decouple_loss:0.0027546361088752747
loss_pred:0.015186293981969357, decouple_loss:0.002444852376356721
Iteration: 1430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851648807525635, gen p mean: -0.24685676395893097, mean p set: 0.44908908009529114
loss_pred:0.015914522111415863, decouple_loss:0.002667941153049469
The modified gen p mean: 0.448345422744751, gen p mean: -0.2491377890110016, mean p set: 0.44892382621765137
loss_pred:0.015445008873939514, decouple_loss:0.0025531654246151447
The modified gen p mean: 0.4486147463321686, gen p mean: -0.2472444772720337, mean p set: 0.4491422176361084
loss_pred:0.015856165438890457, decouple_loss:0.0027045707684010267
2023-04-27 03:37:00 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2481454759836197, mean p set: 0.4499112665653229
loss_pred:0.016709351912140846, decouple_loss:0.0030567815992981195
The modified gen p mean: 0.44929566979408264, gen p mean: -0.24790845811367035, mean p set: 0.4498290419578552
loss_pred:0.016260387375950813, decouple_loss:0.003129883436486125
The modified gen p mean: 0.4482237994670868, gen p mean: -0.245504230260849, mean p set: 0.44879910349845886
loss_pred:0.016578469425439835, decouple_loss:0.0033090258948504925
WV_1_PC_1_EH_0_PS_30, loss: 0.016674332320690155, avg_mse: 0.02440989948809147
current test mse: 0.02441
Iteration: 1431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719505310058594, gen p mean: -0.25074049830436707, mean p set: 0.4477599561214447
loss_pred:0.015207002870738506, decouple_loss:0.0030165906064212322
The modified gen p mean: 0.44836699962615967, gen p mean: -0.2469543069601059, mean p set: 0.4488926827907562
loss_pred:0.015885716304183006, decouple_loss:0.002886963775381446
The modified gen p mean: 0.4474203884601593, gen p mean: -0.24818314611911774, mean p set: 0.44799840450286865
loss_pred:0.0162286926060915, decouple_loss:0.0032176459208130836
Iteration: 1432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763243198394775, gen p mean: -0.2559710741043091, mean p set: 0.44816285371780396
loss_pred:0.014803764410316944, decouple_loss:0.0027824004646390676
The modified gen p mean: 0.44728437066078186, gen p mean: -0.24906711280345917, mean p set: 0.44785773754119873
The modified gen p mean: 0.44727328419685364, gen p mean: -0.2493373155593872, mean p set: 0.4478580951690674
loss_pred:0.015595781616866589, decouple_loss:0.0027338748332113028
loss_pred:0.01530529372394085, decouple_loss:0.0027060930151492357
Iteration: 1433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486881196498871, gen p mean: -0.24829943478107452, mean p set: 0.44922152161598206
loss_pred:0.01595234125852585, decouple_loss:0.002423072000965476
The modified gen p mean: 0.44768381118774414, gen p mean: -0.25130876898765564, mean p set: 0.4482552707195282
The modified gen p mean: 0.44705018401145935, gen p mean: -0.24797256290912628, mean p set: 0.44762876629829407
loss_pred:0.0159792210906744, decouple_loss:0.0024999757297337055
loss_pred:0.017160745337605476, decouple_loss:0.0024487958289682865
Iteration: 1434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816723465919495, gen p mean: -0.24759052693843842, mean p set: 0.44869568943977356
loss_pred:0.015662968158721924, decouple_loss:0.0028567719273269176
The modified gen p mean: 0.448148250579834, gen p mean: -0.24954746663570404, mean p set: 0.4487335979938507
The modified gen p mean: 0.44795000553131104, gen p mean: -0.2504655122756958, mean p set: 0.44852176308631897
loss_pred:0.015801524743437767, decouple_loss:0.002872913144528866
loss_pred:0.01615191251039505, decouple_loss:0.0029951059259474277
Iteration: 1435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447238564491272, gen p mean: -0.2524474263191223, mean p set: 0.4478192627429962
loss_pred:0.014752816408872604, decouple_loss:0.0023361456114798784
The modified gen p mean: 0.4502823054790497, gen p mean: -0.2507018446922302, mean p set: 0.4508599638938904
loss_pred:0.015567515045404434, decouple_loss:0.0027386811561882496
The modified gen p mean: 0.44965580105781555, gen p mean: -0.25117793679237366, mean p set: 0.4501863420009613
loss_pred:0.015980469062924385, decouple_loss:0.0026915937196463346
Iteration: 1436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750165939331055, gen p mean: -0.24463823437690735, mean p set: 0.4480845034122467
loss_pred:0.016256825998425484, decouple_loss:0.0026811775751411915
The modified gen p mean: 0.4490964710712433, gen p mean: -0.24684403836727142, mean p set: 0.4496730864048004
loss_pred:0.01592290587723255, decouple_loss:0.002691289409995079
The modified gen p mean: 0.448184609413147, gen p mean: -0.2447720766067505, mean p set: 0.44871145486831665
loss_pred:0.016106896102428436, decouple_loss:0.0026621432043612003
Iteration: 1437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775840640068054, gen p mean: -0.24763137102127075, mean p set: 0.44833654165267944
loss_pred:0.015752725303173065, decouple_loss:0.002636467572301626
The modified gen p mean: 0.44860759377479553, gen p mean: -0.24614666402339935, mean p set: 0.44918495416641235
loss_pred:0.015394377522170544, decouple_loss:0.0030084087047725916
The modified gen p mean: 0.44780123233795166, gen p mean: -0.24803495407104492, mean p set: 0.44832760095596313
loss_pred:0.015340002253651619, decouple_loss:0.002439104486256838
Iteration: 1438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447952538728714, gen p mean: -0.24894872307777405, mean p set: 0.4485322833061218
loss_pred:0.015412304550409317, decouple_loss:0.0027663568034768105
The modified gen p mean: 0.44761475920677185, gen p mean: -0.25097668170928955, mean p set: 0.44819530844688416
loss_pred:0.01574014686048031, decouple_loss:0.0030911664944142103
The modified gen p mean: 0.4482393264770508, gen p mean: -0.24602696299552917, mean p set: 0.44876912236213684
loss_pred:0.015976576134562492, decouple_loss:0.0030428487807512283
Iteration: 1439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832226634025574, gen p mean: -0.24982061982154846, mean p set: 0.448894202709198
loss_pred:0.01628163643181324, decouple_loss:0.0024732635356485844
The modified gen p mean: 0.4470032751560211, gen p mean: -0.2522713541984558, mean p set: 0.44758591055870056
loss_pred:0.015110157430171967, decouple_loss:0.0023793845903128386
The modified gen p mean: 0.4499078691005707, gen p mean: -0.2515726685523987, mean p set: 0.45043665170669556
loss_pred:0.01599987782537937, decouple_loss:0.0026771947741508484
Iteration: 1440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731801748275757, gen p mean: -0.24847863614559174, mean p set: 0.44789284467697144
loss_pred:0.01533462293446064, decouple_loss:0.0026378133334219456
The modified gen p mean: 0.4476780593395233, gen p mean: -0.2512776851654053, mean p set: 0.44825538992881775
loss_pred:0.01550273597240448, decouple_loss:0.002766895806416869
The modified gen p mean: 0.4471476078033447, gen p mean: -0.24813492596149445, mean p set: 0.4476771950721741
loss_pred:0.017040682956576347, decouple_loss:0.0027342557441443205
2023-04-27 03:40:25 testing...
The modified gen p mean: 0.44822219014167786, gen p mean: -0.2475632131099701, mean p set: 0.44879910349845886
loss_pred:0.016597261652350426, decouple_loss:0.002635316224768758
The modified gen p mean: 0.4493061304092407, gen p mean: -0.2501911520957947, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2501344084739685, mean p set: 0.4499112665653229loss_pred:0.01628296449780464, decouple_loss:0.0026028528809547424
loss_pred:0.01667420007288456, decouple_loss:0.0026310270186513662
WV_1_PC_1_EH_0_PS_30, loss: 0.016649296507239342, avg_mse: 0.024457966908812523
current test mse: 0.024458
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 1441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470207989215851, gen p mean: -0.24773362278938293, mean p set: 0.4475364685058594
loss_pred:0.015266255475580692, decouple_loss:0.0024457969702780247
The modified gen p mean: 0.4471552073955536, gen p mean: -0.24695661664009094, mean p set: 0.4477333426475525
loss_pred:0.016576096415519714, decouple_loss:0.002421010984107852
The modified gen p mean: 0.4465312361717224, gen p mean: -0.24570904672145844, mean p set: 0.4471038281917572
loss_pred:0.016034990549087524, decouple_loss:0.002454454079270363
Iteration: 1442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677621126174927, gen p mean: -0.24740231037139893, mean p set: 0.44730156660079956
loss_pred:0.01576952636241913, decouple_loss:0.0024304408580064774
The modified gen p mean: 0.44507911801338196, gen p mean: -0.248522087931633, mean p set: 0.44565579295158386
The modified gen p mean: 0.44696488976478577, gen p mean: -0.24925391376018524, mean p set: 0.44753265380859375
loss_pred:0.01572597213089466, decouple_loss:0.002489290200173855
loss_pred:0.015505993738770485, decouple_loss:0.0023717437870800495
Iteration: 1443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462904930114746, gen p mean: -0.2466084361076355, mean p set: 0.44682133197784424
loss_pred:0.016003264114260674, decouple_loss:0.0027840568218380213
The modified gen p mean: 0.44688326120376587, gen p mean: -0.24630779027938843, mean p set: 0.44746461510658264
The modified gen p mean: 0.4471460282802582, gen p mean: -0.24178029596805573, mean p set: 0.4477251172065735
loss_pred:0.015632381662726402, decouple_loss:0.0026221296284347773
loss_pred:0.015838870778679848, decouple_loss:0.00262499344535172
Iteration: 1444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459005892276764, gen p mean: -0.24361130595207214, mean p set: 0.44647684693336487
loss_pred:0.01648697257041931, decouple_loss:0.002474450273439288
The modified gen p mean: 0.44663435220718384, gen p mean: -0.23931504786014557, mean p set: 0.4471670687198639The modified gen p mean: 0.4467110335826874, gen p mean: -0.24440817534923553, mean p set: 0.44729331135749817
loss_pred:0.015272760763764381, decouple_loss:0.002709886757656932
loss_pred:0.015958746895194054, decouple_loss:0.002675976138561964
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785094261169434, gen p mean: -0.249897301197052, mean p set: 0.44842633605003357
loss_pred:0.015481463633477688, decouple_loss:0.002612265758216381
The modified gen p mean: 0.4462311267852783, gen p mean: -0.24931350350379944, mean p set: 0.44680705666542053
loss_pred:0.015932565554976463, decouple_loss:0.002344694919884205
The modified gen p mean: 0.44708263874053955, gen p mean: -0.24371396005153656, mean p set: 0.44760966300964355
loss_pred:0.016009913757443428, decouple_loss:0.002409272128716111
Iteration: 1446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657087326049805, gen p mean: -0.24339954555034637, mean p set: 0.4471467435359955
loss_pred:0.015219326131045818, decouple_loss:0.002533898688852787
The modified gen p mean: 0.44627249240875244, gen p mean: -0.24547147750854492, mean p set: 0.446846604347229
The modified gen p mean: 0.44532179832458496, gen p mean: -0.24386587738990784, mean p set: 0.445857435464859
loss_pred:0.015589440241456032, decouple_loss:0.0026480720844119787
loss_pred:0.016023026779294014, decouple_loss:0.002488185651600361
Iteration: 1447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476689100265503, gen p mean: -0.23857493698596954, mean p set: 0.4482450783252716
loss_pred:0.015430883504450321, decouple_loss:0.0024248382542282343
The modified gen p mean: 0.44670814275741577, gen p mean: -0.24123188853263855, mean p set: 0.44728413224220276
loss_pred:0.01541995070874691, decouple_loss:0.002544139279052615
The modified gen p mean: 0.4451591372489929, gen p mean: -0.24198411405086517, mean p set: 0.4456845819950104
loss_pred:0.0158873088657856, decouple_loss:0.002463559154421091
Iteration: 1448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460132420063019, gen p mean: -0.24458645284175873, mean p set: 0.44658660888671875
loss_pred:0.015877362340688705, decouple_loss:0.0024947102647274733
The modified gen p mean: 0.44682592153549194, gen p mean: -0.24506860971450806, mean p set: 0.4473608434200287The modified gen p mean: 0.4464839696884155, gen p mean: -0.2423335611820221, mean p set: 0.44706007838249207
loss_pred:0.015073833055794239, decouple_loss:0.0023669726215302944
loss_pred:0.015734445303678513, decouple_loss:0.0025236571673303843
Iteration: 1449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677674770355225, gen p mean: -0.2423917055130005, mean p set: 0.4473506212234497
loss_pred:0.015825733542442322, decouple_loss:0.0025801039300858974
The modified gen p mean: 0.4483547806739807, gen p mean: -0.24439045786857605, mean p set: 0.4489297568798065
loss_pred:0.014824891462922096, decouple_loss:0.0026819969061762094
The modified gen p mean: 0.44638487696647644, gen p mean: -0.2472158521413803, mean p set: 0.44691362977027893
loss_pred:0.015764359384775162, decouple_loss:0.0026209845673292875
Iteration: 1450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641873240470886, gen p mean: -0.24263623356819153, mean p set: 0.4469999372959137
loss_pred:0.01577676832675934, decouple_loss:0.0026385560631752014
The modified gen p mean: 0.44685661792755127, gen p mean: -0.2419671267271042, mean p set: 0.4474301338195801
loss_pred:0.01537504605948925, decouple_loss:0.002588084666058421
The modified gen p mean: 0.446732759475708, gen p mean: -0.24824123084545135, mean p set: 0.4472668468952179
loss_pred:0.015191675163805485, decouple_loss:0.00251001981087029
2023-04-27 03:44:29 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2451324313879013, mean p set: 0.4499112665653229
loss_pred:0.016641950234770775, decouple_loss:0.002841017208993435
The modified gen p mean: 0.44929882884025574, gen p mean: -0.24564392864704132, mean p set: 0.4498290419578552
loss_pred:0.01624780334532261, decouple_loss:0.0026471808087080717
The modified gen p mean: 0.44821661710739136, gen p mean: -0.242831751704216, mean p set: 0.44879910349845886
loss_pred:0.01660602167248726, decouple_loss:0.002731948159635067
WV_1_PC_1_EH_0_PS_30, loss: 0.0166355948895216, avg_mse: 0.024428309872746468
current test mse: 0.024428
Iteration: 1451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459615647792816, gen p mean: -0.24302232265472412, mean p set: 0.44653791189193726
loss_pred:0.015781356021761894, decouple_loss:0.0027469501364976168
The modified gen p mean: 0.4465648829936981, gen p mean: -0.24813753366470337, mean p set: 0.44709545373916626
loss_pred:0.015519944950938225, decouple_loss:0.002726126229390502
The modified gen p mean: 0.44643038511276245, gen p mean: -0.2463584989309311, mean p set: 0.4470020830631256
loss_pred:0.01561166811734438, decouple_loss:0.0026784855872392654
Iteration: 1452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754886627197266, gen p mean: -0.24635344743728638, mean p set: 0.44807347655296326
loss_pred:0.015447632409632206, decouple_loss:0.002465577330440283
The modified gen p mean: 0.44662266969680786, gen p mean: -0.24617202579975128, mean p set: 0.44719746708869934
The modified gen p mean: 0.4466446340084076, gen p mean: -0.24658849835395813, mean p set: 0.44722166657447815
loss_pred:0.015527147799730301, decouple_loss:0.0026011753361672163
loss_pred:0.015879809856414795, decouple_loss:0.00256921024993062
Iteration: 1453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460146427154541, gen p mean: -0.245693638920784, mean p set: 0.4465474784374237
loss_pred:0.015427994541823864, decouple_loss:0.002681255806237459
The modified gen p mean: 0.44623857736587524, gen p mean: -0.24793952703475952, mean p set: 0.446819543838501
The modified gen p mean: 0.4459961950778961, gen p mean: -0.25184524059295654, mean p set: 0.4465794563293457
loss_pred:0.015756525099277496, decouple_loss:0.0027202561032027006
loss_pred:0.01565348356962204, decouple_loss:0.002743873745203018
Iteration: 1454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466171860694885, gen p mean: -0.2546066343784332, mean p set: 0.4471500515937805
loss_pred:0.01612875983119011, decouple_loss:0.0026143204886466265
The modified gen p mean: 0.4474940299987793, gen p mean: -0.25085583329200745, mean p set: 0.44806838035583496
The modified gen p mean: 0.4466930329799652, gen p mean: -0.255178302526474, mean p set: 0.44726231694221497
loss_pred:0.014984799548983574, decouple_loss:0.0024913290981203318
loss_pred:0.015312141738831997, decouple_loss:0.0024276007898151875
Iteration: 1455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467408359050751, gen p mean: -0.25720566511154175, mean p set: 0.4473183751106262
loss_pred:0.015744658187031746, decouple_loss:0.0026301259640604258
The modified gen p mean: 0.44710829854011536, gen p mean: -0.2551431655883789, mean p set: 0.4476316571235657The modified gen p mean: 0.4468749463558197, gen p mean: -0.25566914677619934, mean p set: 0.4474572241306305
loss_pred:0.015916014090180397, decouple_loss:0.002501394832506776
loss_pred:0.015205961652100086, decouple_loss:0.0027911688666790724
Iteration: 1456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724583625793457, gen p mean: -0.2614186108112335, mean p set: 0.44782721996307373
loss_pred:0.015144088305532932, decouple_loss:0.00243000197224319
The modified gen p mean: 0.44526153802871704, gen p mean: -0.2581363022327423, mean p set: 0.44578808546066284The modified gen p mean: 0.4460274279117584, gen p mean: -0.2546139061450958, mean p set: 0.4466037154197693
loss_pred:0.01585167646408081, decouple_loss:0.002370513742789626
loss_pred:0.015328257344663143, decouple_loss:0.002452278044074774
Iteration: 1457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473116397857666, gen p mean: -0.2567203938961029, mean p set: 0.44788506627082825
loss_pred:0.015340001322329044, decouple_loss:0.0024433829821646214
The modified gen p mean: 0.44665592908859253, gen p mean: -0.25656214356422424, mean p set: 0.447183758020401The modified gen p mean: 0.4476054012775421, gen p mean: -0.2525053918361664, mean p set: 0.44818106293678284
loss_pred:0.015007240697741508, decouple_loss:0.0025595768820494413
loss_pred:0.015724675729870796, decouple_loss:0.0024405326694250107
Iteration: 1458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474734663963318, gen p mean: -0.2525181472301483, mean p set: 0.4480440020561218
loss_pred:0.015116018243134022, decouple_loss:0.0024632641579955816
The modified gen p mean: 0.4469084143638611, gen p mean: -0.25622814893722534, mean p set: 0.44748565554618835
loss_pred:0.015021217986941338, decouple_loss:0.0024725080002099276
The modified gen p mean: 0.446472704410553, gen p mean: -0.2556156516075134, mean p set: 0.44699564576148987
loss_pred:0.015758560970425606, decouple_loss:0.0024648767430335283
Iteration: 1459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455823004245758, gen p mean: -0.2512222230434418, mean p set: 0.4461512565612793
loss_pred:0.015283253975212574, decouple_loss:0.002399703487753868
The modified gen p mean: 0.4467114210128784, gen p mean: -0.25065433979034424, mean p set: 0.44728177785873413
loss_pred:0.015325977467000484, decouple_loss:0.0024821392726153135
The modified gen p mean: 0.4465264081954956, gen p mean: -0.24447032809257507, mean p set: 0.44704607129096985
loss_pred:0.015146595425903797, decouple_loss:0.0025443758349865675
Iteration: 1460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691771268844604, gen p mean: -0.2443404644727707, mean p set: 0.44749704003334045
loss_pred:0.016231559216976166, decouple_loss:0.0026208902709186077
The modified gen p mean: 0.4463420808315277, gen p mean: -0.24552837014198303, mean p set: 0.44691479206085205
loss_pred:0.016079895198345184, decouple_loss:0.0026413018349558115
The modified gen p mean: 0.44606801867485046, gen p mean: -0.25011304020881653, mean p set: 0.44659578800201416
loss_pred:0.015394702553749084, decouple_loss:0.0025407953653484583
2023-04-27 03:47:53 testing...
The modified gen p mean: 0.4482182264328003, gen p mean: -0.24725203216075897, mean p set: 0.44879910349845886
loss_pred:0.016674602404236794, decouple_loss:0.002557739382609725
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24970152974128723, mean p set: 0.4499112665653229
loss_pred:0.016628239303827286, decouple_loss:0.002542529022321105
The modified gen p mean: 0.44929730892181396, gen p mean: -0.250198632478714, mean p set: 0.4498290419578552
loss_pred:0.016369914636015892, decouple_loss:0.0023879006039351225
WV_1_PC_1_EH_0_PS_30, loss: 0.016682390123605728, avg_mse: 0.024468790739774704
current test mse: 0.024469
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 1461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761669635772705, gen p mean: -0.24803656339645386, mean p set: 0.44814640283584595
loss_pred:0.015978526324033737, decouple_loss:0.0026468883734196424
The modified gen p mean: 0.44707173109054565, gen p mean: -0.2471468448638916, mean p set: 0.44764676690101624
loss_pred:0.015811176970601082, decouple_loss:0.0025324642192572355
The modified gen p mean: 0.44727957248687744, gen p mean: -0.25254276394844055, mean p set: 0.44785767793655396
loss_pred:0.01606598123908043, decouple_loss:0.0024901260621845722
Iteration: 1462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465755522251129, gen p mean: -0.2506660223007202, mean p set: 0.4471038579940796
loss_pred:0.016446072608232498, decouple_loss:0.0023524125572293997
The modified gen p mean: 0.44693008065223694, gen p mean: -0.2489784061908722, mean p set: 0.4475066065788269
loss_pred:0.014420410618185997, decouple_loss:0.0027947830967605114
The modified gen p mean: 0.4480207562446594, gen p mean: -0.24586378037929535, mean p set: 0.44860100746154785
loss_pred:0.015220053493976593, decouple_loss:0.002601346932351589
Iteration: 1463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464748501777649, gen p mean: -0.24990162253379822, mean p set: 0.4470026195049286
loss_pred:0.015525700524449348, decouple_loss:0.0026210674550384283
The modified gen p mean: 0.44650280475616455, gen p mean: -0.24907271564006805, mean p set: 0.44708362221717834
loss_pred:0.015318690799176693, decouple_loss:0.0025891754776239395
The modified gen p mean: 0.44785019755363464, gen p mean: -0.24746011197566986, mean p set: 0.44842812418937683
loss_pred:0.015271859243512154, decouple_loss:0.00252700736746192
Iteration: 1464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460960924625397, gen p mean: -0.2527635097503662, mean p set: 0.44662564992904663
loss_pred:0.015785707160830498, decouple_loss:0.0028517600148916245
The modified gen p mean: 0.44710773229599, gen p mean: -0.24617764353752136, mean p set: 0.4476839005947113
loss_pred:0.014206485822796822, decouple_loss:0.0026393323205411434
The modified gen p mean: 0.44759902358055115, gen p mean: -0.24977578222751617, mean p set: 0.44817930459976196
loss_pred:0.015448622405529022, decouple_loss:0.0024865823797881603
Iteration: 1465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694963097572327, gen p mean: -0.2470107525587082, mean p set: 0.44751641154289246
loss_pred:0.01514453999698162, decouple_loss:0.002582535147666931
The modified gen p mean: 0.4466099739074707, gen p mean: -0.25038936734199524, mean p set: 0.4471876323223114
loss_pred:0.01573486067354679, decouple_loss:0.002577525796368718
The modified gen p mean: 0.44780266284942627, gen p mean: -0.24582986533641815, mean p set: 0.44832831621170044
loss_pred:0.01580851525068283, decouple_loss:0.0025198550429195166
Iteration: 1466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467592239379883, gen p mean: -0.2442731112241745, mean p set: 0.4473371207714081
loss_pred:0.014601594768464565, decouple_loss:0.0026979378890246153
The modified gen p mean: 0.4465559422969818, gen p mean: -0.24987895786762238, mean p set: 0.44713205099105835The modified gen p mean: 0.4471571147441864, gen p mean: -0.24221406877040863, mean p set: 0.44768741726875305
loss_pred:0.01520857959985733, decouple_loss:0.0025676824152469635
loss_pred:0.015019741840660572, decouple_loss:0.0024073519743978977
Iteration: 1467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809189438819885, gen p mean: -0.2428174912929535, mean p set: 0.4486611485481262
loss_pred:0.015618991106748581, decouple_loss:0.0026532907504588366
The modified gen p mean: 0.44710075855255127, gen p mean: -0.2435874044895172, mean p set: 0.4476735293865204
loss_pred:0.015278571285307407, decouple_loss:0.0026373490691184998
The modified gen p mean: 0.44776231050491333, gen p mean: -0.24379105865955353, mean p set: 0.4482881724834442
loss_pred:0.015291688032448292, decouple_loss:0.0025327319744974375
Iteration: 1468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735822081565857, gen p mean: -0.24229556322097778, mean p set: 0.447934627532959
loss_pred:0.015658680349588394, decouple_loss:0.0024849693290889263
The modified gen p mean: 0.4483092427253723, gen p mean: -0.23555828630924225, mean p set: 0.44888240098953247
loss_pred:0.014798500575125217, decouple_loss:0.0026609040796756744
The modified gen p mean: 0.4460235834121704, gen p mean: -0.2432040423154831, mean p set: 0.4465501010417938
loss_pred:0.015336055308580399, decouple_loss:0.002892552874982357
Iteration: 1469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652533531188965, gen p mean: -0.230703204870224, mean p set: 0.4471050798892975
loss_pred:0.014586329460144043, decouple_loss:0.0025328444316983223
The modified gen p mean: 0.4473736882209778, gen p mean: -0.2390497624874115, mean p set: 0.4479525089263916
loss_pred:0.01513916440308094, decouple_loss:0.0026607157196849585
The modified gen p mean: 0.44686228036880493, gen p mean: -0.2378358542919159, mean p set: 0.44739529490470886
loss_pred:0.014837047085165977, decouple_loss:0.0026573026552796364
Iteration: 1470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709983468055725, gen p mean: -0.236149862408638, mean p set: 0.4476739168167114
loss_pred:0.015499488450586796, decouple_loss:0.0025263226125389338
The modified gen p mean: 0.4469067454338074, gen p mean: -0.2404477745294571, mean p set: 0.4474334716796875The modified gen p mean: 0.44794172048568726, gen p mean: -0.23935331404209137, mean p set: 0.4485190510749817
loss_pred:0.015599073842167854, decouple_loss:0.0025000646710395813
loss_pred:0.015659131109714508, decouple_loss:0.002406185958534479
2023-04-27 03:51:56 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2403022050857544, mean p set: 0.4499112665653229
loss_pred:0.0167264174669981, decouple_loss:0.002682202495634556
The modified gen p mean: 0.4492921829223633, gen p mean: -0.24069742858409882, mean p set: 0.4498290419578552
loss_pred:0.01642443612217903, decouple_loss:0.002642222912982106
The modified gen p mean: 0.4482227563858032, gen p mean: -0.23778754472732544, mean p set: 0.44879910349845886
loss_pred:0.016760248690843582, decouple_loss:0.0026461512316018343
WV_1_PC_1_EH_0_PS_30, loss: 0.016769878566265106, avg_mse: 0.024711918085813522
current test mse: 0.024712
Iteration: 1471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467986822128296, gen p mean: -0.2452746331691742, mean p set: 0.4473738372325897
loss_pred:0.014531249180436134, decouple_loss:0.002523689065128565
The modified gen p mean: 0.4471093416213989, gen p mean: -0.24015741050243378, mean p set: 0.44764021039009094
loss_pred:0.01572115533053875, decouple_loss:0.0028428921941667795
The modified gen p mean: 0.4467453956604004, gen p mean: -0.23745028674602509, mean p set: 0.44732168316841125
loss_pred:0.014695842750370502, decouple_loss:0.0026040857192128897
Iteration: 1472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473395347595215, gen p mean: -0.2452019900083542, mean p set: 0.4478755593299866
loss_pred:0.015628214925527573, decouple_loss:0.002629186725243926
The modified gen p mean: 0.44630664587020874, gen p mean: -0.2367815226316452, mean p set: 0.44688504934310913
The modified gen p mean: 0.4472927749156952, gen p mean: -0.23817658424377441, mean p set: 0.44786933064460754
loss_pred:0.014814128167927265, decouple_loss:0.0026342482306063175
loss_pred:0.015349076129496098, decouple_loss:0.0024268438573926687
Iteration: 1473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472697675228119, gen p mean: -0.24141936004161835, mean p set: 0.4477977156639099
loss_pred:0.014876837842166424, decouple_loss:0.0024408965837210417
The modified gen p mean: 0.4466961622238159, gen p mean: -0.24458959698677063, mean p set: 0.4472716748714447
The modified gen p mean: 0.4474363923072815, gen p mean: -0.24046292901039124, mean p set: 0.44801655411720276
loss_pred:0.015883930027484894, decouple_loss:0.00250317994505167
loss_pred:0.014128667302429676, decouple_loss:0.002656532684341073
Iteration: 1474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725316762924194, gen p mean: -0.2406633347272873, mean p set: 0.4477759003639221
loss_pred:0.014905550517141819, decouple_loss:0.002585981274023652
The modified gen p mean: 0.4470738172531128, gen p mean: -0.24036718904972076, mean p set: 0.4476470947265625
The modified gen p mean: 0.44660311937332153, gen p mean: -0.24643132090568542, mean p set: 0.44717565178871155
loss_pred:0.01486936304718256, decouple_loss:0.0025096044410020113
loss_pred:0.015633100643754005, decouple_loss:0.0024442970752716064
Iteration: 1475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686204195022583, gen p mean: -0.2485121786594391, mean p set: 0.44743743538856506
loss_pred:0.015373832546174526, decouple_loss:0.002802461851388216
The modified gen p mean: 0.4481169581413269, gen p mean: -0.2413388043642044, mean p set: 0.44869264960289
loss_pred:0.01480779703706503, decouple_loss:0.0026459607761353254
The modified gen p mean: 0.44809862971305847, gen p mean: -0.24446620047092438, mean p set: 0.4486280083656311
loss_pred:0.014683658257126808, decouple_loss:0.002872385084629059
Iteration: 1476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481624364852905, gen p mean: -0.2412790209054947, mean p set: 0.44872787594795227
loss_pred:0.014241728000342846, decouple_loss:0.0025380789302289486
The modified gen p mean: 0.44717979431152344, gen p mean: -0.23856331408023834, mean p set: 0.4477570950984955
loss_pred:0.014589278027415276, decouple_loss:0.0025219647213816643
The modified gen p mean: 0.44662603735923767, gen p mean: -0.24441316723823547, mean p set: 0.44715800881385803
loss_pred:0.014193996787071228, decouple_loss:0.0024605849757790565
Iteration: 1477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464327394962311, gen p mean: -0.24199436604976654, mean p set: 0.4470112919807434
loss_pred:0.014146913774311543, decouple_loss:0.002566081238910556
The modified gen p mean: 0.4460063874721527, gen p mean: -0.2409011274576187, mean p set: 0.4465774595737457
loss_pred:0.016023002564907074, decouple_loss:0.0022520481143146753
The modified gen p mean: 0.4472578167915344, gen p mean: -0.2451183795928955, mean p set: 0.4477875828742981
loss_pred:0.01566212996840477, decouple_loss:0.0024490768555551767
Iteration: 1478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468432068824768, gen p mean: -0.23810797929763794, mean p set: 0.447416752576828
loss_pred:0.014667930081486702, decouple_loss:0.0024034648668020964
The modified gen p mean: 0.44653844833374023, gen p mean: -0.24879972636699677, mean p set: 0.4471111297607422
loss_pred:0.015018939971923828, decouple_loss:0.002469561994075775
The modified gen p mean: 0.44750186800956726, gen p mean: -0.2456500381231308, mean p set: 0.4480327367782593
loss_pred:0.015036220662295818, decouple_loss:0.002334275748580694
Iteration: 1479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720080494880676, gen p mean: -0.2330954521894455, mean p set: 0.4477759599685669
loss_pred:0.01578044705092907, decouple_loss:0.002423829399049282
The modified gen p mean: 0.4462840259075165, gen p mean: -0.24342475831508636, mean p set: 0.4468553960323334
loss_pred:0.015155945904552937, decouple_loss:0.002375588985159993
The modified gen p mean: 0.44809985160827637, gen p mean: -0.23100124299526215, mean p set: 0.44862768054008484
loss_pred:0.014618274755775928, decouple_loss:0.002494954504072666
Iteration: 1480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481188952922821, gen p mean: -0.2321528047323227, mean p set: 0.4486927390098572
loss_pred:0.01449250802397728, decouple_loss:0.002756522037088871
The modified gen p mean: 0.4487101137638092, gen p mean: -0.23752349615097046, mean p set: 0.44923636317253113The modified gen p mean: 0.4470798969268799, gen p mean: -0.24034631252288818, mean p set: 0.44765499234199524
loss_pred:0.015242021530866623, decouple_loss:0.002563315210863948
loss_pred:0.014451969414949417, decouple_loss:0.00254148431122303
2023-04-27 03:55:21 testing...
The modified gen p mean: 0.4482205808162689, gen p mean: -0.23739340901374817, mean p set: 0.44879910349845886
loss_pred:0.01676461100578308, decouple_loss:0.002762271324172616
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23993265628814697, mean p set: 0.4499112665653229
loss_pred:0.01676928624510765, decouple_loss:0.0029299366287887096
The modified gen p mean: 0.4493023157119751, gen p mean: -0.24037498235702515, mean p set: 0.4498290419578552
loss_pred:0.01641901209950447, decouple_loss:0.00270531396381557
WV_1_PC_1_EH_0_PS_30, loss: 0.016790930181741714, avg_mse: 0.02473604306578636
current test mse: 0.024736
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 1481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922807812690735, gen p mean: -0.23863035440444946, mean p set: 0.4497511684894562
loss_pred:0.01608184538781643, decouple_loss:0.0025679871905595064
The modified gen p mean: 0.45008885860443115, gen p mean: -0.23354558646678925, mean p set: 0.45066767930984497
loss_pred:0.016038918867707253, decouple_loss:0.002639518352225423
The modified gen p mean: 0.4483017325401306, gen p mean: -0.23445501923561096, mean p set: 0.4488740861415863
loss_pred:0.015900446102023125, decouple_loss:0.002417745301499963
Iteration: 1482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025357604026794, gen p mean: -0.23146450519561768, mean p set: 0.4507763385772705
loss_pred:0.015143307857215405, decouple_loss:0.00276195234619081
The modified gen p mean: 0.44864732027053833, gen p mean: -0.24522927403450012, mean p set: 0.449221134185791
loss_pred:0.01549349632114172, decouple_loss:0.002521459711715579
The modified gen p mean: 0.4499734938144684, gen p mean: -0.2339049130678177, mean p set: 0.4505513906478882
loss_pred:0.015021369792521, decouple_loss:0.0028106695972383022
Iteration: 1483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448414146900177, gen p mean: -0.24265803396701813, mean p set: 0.4489458501338959
loss_pred:0.015405275858938694, decouple_loss:0.0026031602174043655
The modified gen p mean: 0.4485118091106415, gen p mean: -0.23720651865005493, mean p set: 0.44908788800239563
loss_pred:0.016284793615341187, decouple_loss:0.0025872066617012024
The modified gen p mean: 0.4495615065097809, gen p mean: -0.23843595385551453, mean p set: 0.45013657212257385
loss_pred:0.015298094600439072, decouple_loss:0.0024537527933716774
Iteration: 1484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497901499271393, gen p mean: -0.23924116790294647, mean p set: 0.4503171145915985
loss_pred:0.015374258160591125, decouple_loss:0.0025126137770712376
The modified gen p mean: 0.4491020739078522, gen p mean: -0.23978526890277863, mean p set: 0.4496835172176361
loss_pred:0.01576022431254387, decouple_loss:0.002421259181573987
The modified gen p mean: 0.4495736062526703, gen p mean: -0.2337120622396469, mean p set: 0.4501534700393677
loss_pred:0.015546426177024841, decouple_loss:0.0025488410610705614
Iteration: 1485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910165667533875, gen p mean: -0.23436342179775238, mean p set: 0.4496765732765198
loss_pred:0.01602242887020111, decouple_loss:0.002854409860447049
The modified gen p mean: 0.4493406116962433, gen p mean: -0.23339053988456726, mean p set: 0.44991418719291687The modified gen p mean: 0.45007118582725525, gen p mean: -0.2309633493423462, mean p set: 0.4506046175956726
loss_pred:0.0153921814635396, decouple_loss:0.002789529738947749
loss_pred:0.01564905419945717, decouple_loss:0.002819475019350648
Iteration: 1486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841793179512024, gen p mean: -0.24031491577625275, mean p set: 0.448993444442749
loss_pred:0.015696931630373, decouple_loss:0.0026046016719192266
The modified gen p mean: 0.4496476352214813, gen p mean: -0.24144347012043, mean p set: 0.45017269253730774The modified gen p mean: 0.4499059319496155, gen p mean: -0.23659715056419373, mean p set: 0.4504837691783905
loss_pred:0.015525786206126213, decouple_loss:0.0025343764573335648
loss_pred:0.01557802502065897, decouple_loss:0.0026566293090581894
Iteration: 1487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968727231025696, gen p mean: -0.24172772467136383, mean p set: 0.4502677023410797
loss_pred:0.0156162204220891, decouple_loss:0.002437431598082185
The modified gen p mean: 0.4482647776603699, gen p mean: -0.24366991221904755, mean p set: 0.44884949922561646
loss_pred:0.015951596200466156, decouple_loss:0.0025289470795542
The modified gen p mean: 0.4489800035953522, gen p mean: -0.23978088796138763, mean p set: 0.4495089054107666
loss_pred:0.01540235336869955, decouple_loss:0.0022984689567238092
Iteration: 1488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914424419403076, gen p mean: -0.24210640788078308, mean p set: 0.4497183561325073
loss_pred:0.015942681580781937, decouple_loss:0.0027035835664719343
The modified gen p mean: 0.4491930305957794, gen p mean: -0.24427439272403717, mean p set: 0.4497673809528351
loss_pred:0.015821382403373718, decouple_loss:0.0026612356305122375
The modified gen p mean: 0.4507572054862976, gen p mean: -0.23911885917186737, mean p set: 0.45129016041755676
loss_pred:0.015449956059455872, decouple_loss:0.0028389589861035347
Iteration: 1489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081454515457153, gen p mean: -0.24153822660446167, mean p set: 0.45138660073280334
loss_pred:0.015108780935406685, decouple_loss:0.0025626407004892826
The modified gen p mean: 0.44955092668533325, gen p mean: -0.2399987429380417, mean p set: 0.45013123750686646
loss_pred:0.015482318587601185, decouple_loss:0.002790842903777957
The modified gen p mean: 0.447975218296051, gen p mean: -0.24328042566776276, mean p set: 0.44851261377334595
loss_pred:0.014869851991534233, decouple_loss:0.0024172693956643343
Iteration: 1490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792965054512024, gen p mean: -0.2464386224746704, mean p set: 0.44850999116897583
loss_pred:0.015537158586084843, decouple_loss:0.002590274903923273
The modified gen p mean: 0.44854140281677246, gen p mean: -0.2426357865333557, mean p set: 0.44906798005104065The modified gen p mean: 0.45001453161239624, gen p mean: -0.24079342186450958, mean p set: 0.4505905210971832
loss_pred:0.015510761179029942, decouple_loss:0.0024609689135104418
loss_pred:0.015505442395806313, decouple_loss:0.0026297224685549736
2023-04-27 03:59:20 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2432490587234497, mean p set: 0.4499112665653229
loss_pred:0.016703683882951736, decouple_loss:0.0027312070596963167
The modified gen p mean: 0.4482234716415405, gen p mean: -0.24035602807998657, mean p set: 0.44879910349845886
loss_pred:0.01669948920607567, decouple_loss:0.0025893927086144686
The modified gen p mean: 0.44929584860801697, gen p mean: -0.2432984560728073, mean p set: 0.4498290419578552
loss_pred:0.016293158754706383, decouple_loss:0.002548596588894725
WV_1_PC_1_EH_0_PS_30, loss: 0.016696596518158913, avg_mse: 0.024596044793725014
current test mse: 0.024596
Iteration: 1491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492625296115875, gen p mean: -0.24475206434726715, mean p set: 0.4498424530029297
loss_pred:0.015697579830884933, decouple_loss:0.0023431999143213034
The modified gen p mean: 0.45049142837524414, gen p mean: -0.23937520384788513, mean p set: 0.45106619596481323
loss_pred:0.014679847285151482, decouple_loss:0.002411436289548874
The modified gen p mean: 0.4488102197647095, gen p mean: -0.23773694038391113, mean p set: 0.44934147596359253
loss_pred:0.01588580012321472, decouple_loss:0.0025062458589673042
Iteration: 1492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44887280464172363, gen p mean: -0.23747211694717407, mean p set: 0.4493984878063202
loss_pred:0.01586676575243473, decouple_loss:0.0025479586329311132
The modified gen p mean: 0.44827741384506226, gen p mean: -0.23884747922420502, mean p set: 0.44885316491127014
loss_pred:0.01588241569697857, decouple_loss:0.002379622543230653
The modified gen p mean: 0.447561651468277, gen p mean: -0.24163775146007538, mean p set: 0.44813892245292664
loss_pred:0.01654014177620411, decouple_loss:0.0024265155661851168
Iteration: 1493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487825632095337, gen p mean: -0.24023836851119995, mean p set: 0.4493071436882019
loss_pred:0.016211573034524918, decouple_loss:0.002433312823995948
The modified gen p mean: 0.4487624168395996, gen p mean: -0.23790782690048218, mean p set: 0.4493391215801239
loss_pred:0.015273875556886196, decouple_loss:0.0024410721380263567
The modified gen p mean: 0.44788244366645813, gen p mean: -0.23757432401180267, mean p set: 0.44845327734947205
loss_pred:0.014724038541316986, decouple_loss:0.002413953887298703
Iteration: 1494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896310567855835, gen p mean: -0.2470656931400299, mean p set: 0.44949063658714294
loss_pred:0.015213614329695702, decouple_loss:0.002582571469247341
The modified gen p mean: 0.44938868284225464, gen p mean: -0.2480074167251587, mean p set: 0.44996631145477295
loss_pred:0.014988734386861324, decouple_loss:0.0024134060367941856
The modified gen p mean: 0.44918015599250793, gen p mean: -0.2371753305196762, mean p set: 0.4497552812099457
loss_pred:0.015297817066311836, decouple_loss:0.0024519143626093864
Iteration: 1495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003464818000793, gen p mean: -0.242020845413208, mean p set: 0.4506189823150635
loss_pred:0.01528939325362444, decouple_loss:0.0027464323211461306
The modified gen p mean: 0.4496431052684784, gen p mean: -0.24577859044075012, mean p set: 0.4501734673976898The modified gen p mean: 0.44902369379997253, gen p mean: -0.2427864968776703, mean p set: 0.44959837198257446
loss_pred:0.015304644592106342, decouple_loss:0.0025887414813041687
loss_pred:0.015941323712468147, decouple_loss:0.0025171793531626463
Iteration: 1496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507240951061249, gen p mean: -0.23995839059352875, mean p set: 0.45130491256713867
loss_pred:0.015227941796183586, decouple_loss:0.002606283640488982
The modified gen p mean: 0.449129581451416, gen p mean: -0.241738960146904, mean p set: 0.4496645927429199The modified gen p mean: 0.4491672217845917, gen p mean: -0.2428991198539734, mean p set: 0.4497471749782562
loss_pred:0.014611695893108845, decouple_loss:0.0024943402968347073
loss_pred:0.015316328033804893, decouple_loss:0.00258105481043458
Iteration: 1497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813528656959534, gen p mean: -0.24438804388046265, mean p set: 0.44870686531066895
loss_pred:0.016706710681319237, decouple_loss:0.0026382289361208677
The modified gen p mean: 0.44853881001472473, gen p mean: -0.24298721551895142, mean p set: 0.4491119980812073
loss_pred:0.016139443963766098, decouple_loss:0.002673115348443389
The modified gen p mean: 0.44973263144493103, gen p mean: -0.24361717700958252, mean p set: 0.45026013255119324
loss_pred:0.01559017226099968, decouple_loss:0.002632936229929328
Iteration: 1498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489436447620392, gen p mean: -0.2458251714706421, mean p set: 0.4495182931423187
loss_pred:0.015141861513257027, decouple_loss:0.0024046797771006823
The modified gen p mean: 0.45012691617012024, gen p mean: -0.2393435686826706, mean p set: 0.45070981979370117
loss_pred:0.015051368623971939, decouple_loss:0.0025889158714562654
The modified gen p mean: 0.4494340419769287, gen p mean: -0.23914405703544617, mean p set: 0.44995465874671936
loss_pred:0.015100531280040741, decouple_loss:0.002554390113800764
Iteration: 1499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502866864204407, gen p mean: -0.23939968645572662, mean p set: 0.4508661925792694
loss_pred:0.015070931054651737, decouple_loss:0.0025105809327214956
The modified gen p mean: 0.4505654275417328, gen p mean: -0.24232688546180725, mean p set: 0.451143354177475
loss_pred:0.015416482463479042, decouple_loss:0.002880181884393096
The modified gen p mean: 0.4491475820541382, gen p mean: -0.24827559292316437, mean p set: 0.44967731833457947
loss_pred:0.015228082425892353, decouple_loss:0.0027267131954431534
Iteration: 1500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479701519012451, gen p mean: -0.2453160136938095, mean p set: 0.4485381245613098
loss_pred:0.016248730942606926, decouple_loss:0.002628850983455777
The modified gen p mean: 0.44923752546310425, gen p mean: -0.24667811393737793, mean p set: 0.4497663974761963
The modified gen p mean: 0.4488445818424225, gen p mean: -0.24770183861255646, mean p set: 0.4494198262691498
loss_pred:0.016182512044906616, decouple_loss:0.002482051495462656
loss_pred:0.01500271912664175, decouple_loss:0.002347903558984399
2023-04-27 04:02:44 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24960973858833313, mean p set: 0.4499112665653229
loss_pred:0.016807658597826958, decouple_loss:0.002939696656540036
The modified gen p mean: 0.4482206702232361, gen p mean: -0.24624082446098328, mean p set: 0.44879910349845886
loss_pred:0.01679466851055622, decouple_loss:0.002920854836702347
The modified gen p mean: 0.4493032693862915, gen p mean: -0.24960428476333618, mean p set: 0.4498290419578552
loss_pred:0.016392430290579796, decouple_loss:0.0029652786906808615
WV_1_PC_1_EH_0_PS_30, loss: 0.016812017187476158, avg_mse: 0.024758635088801384
current test mse: 0.024759
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 1501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734466075897217, gen p mean: -0.24860872328281403, mean p set: 0.44787725806236267
loss_pred:0.01641286537051201, decouple_loss:0.002651982242241502
The modified gen p mean: 0.4454323649406433, gen p mean: -0.24940291047096252, mean p set: 0.44600710272789
loss_pred:0.015956493094563484, decouple_loss:0.00244930200278759
The modified gen p mean: 0.4481794238090515, gen p mean: -0.2504692077636719, mean p set: 0.44875115156173706
loss_pred:0.01662031002342701, decouple_loss:0.0027911935467272997
Iteration: 1502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466908276081085, gen p mean: -0.24788813292980194, mean p set: 0.4472208023071289
loss_pred:0.015866396948695183, decouple_loss:0.0025272644124925137
The modified gen p mean: 0.446990430355072, gen p mean: -0.25417360663414, mean p set: 0.4475601017475128
loss_pred:0.0159034114331007, decouple_loss:0.002829460659995675
The modified gen p mean: 0.445758193731308, gen p mean: -0.2543501555919647, mean p set: 0.4463326036930084
loss_pred:0.015093301422894001, decouple_loss:0.0025817323476076126
Iteration: 1503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471305012702942, gen p mean: -0.2512945830821991, mean p set: 0.44765836000442505
loss_pred:0.016576146706938744, decouple_loss:0.0025860751047730446
The modified gen p mean: 0.44743961095809937, gen p mean: -0.2518578767776489, mean p set: 0.4480137526988983
loss_pred:0.015737146139144897, decouple_loss:0.0026466897688806057
The modified gen p mean: 0.44694191217422485, gen p mean: -0.24966219067573547, mean p set: 0.447516530752182
loss_pred:0.016052110120654106, decouple_loss:0.00261810515075922
Iteration: 1504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469372034072876, gen p mean: -0.25668030977249146, mean p set: 0.4474697411060333
loss_pred:0.015505842864513397, decouple_loss:0.002540034241974354
The modified gen p mean: 0.44771942496299744, gen p mean: -0.25593432784080505, mean p set: 0.44829845428466797
loss_pred:0.01518224086612463, decouple_loss:0.002516456414014101
The modified gen p mean: 0.44834771752357483, gen p mean: -0.2518756687641144, mean p set: 0.44892388582229614
loss_pred:0.016372598707675934, decouple_loss:0.0025922246277332306
Iteration: 1505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466054439544678, gen p mean: -0.2523639500141144, mean p set: 0.44718244671821594
loss_pred:0.015291456133127213, decouple_loss:0.002529936144128442
The modified gen p mean: 0.4471910297870636, gen p mean: -0.25267350673675537, mean p set: 0.44777220487594604The modified gen p mean: 0.4463738799095154, gen p mean: -0.2504594027996063, mean p set: 0.4468908905982971
loss_pred:0.015560470521450043, decouple_loss:0.002509209094569087
loss_pred:0.015488666482269764, decouple_loss:0.002365291118621826
Iteration: 1506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468750059604645, gen p mean: -0.24409732222557068, mean p set: 0.44745346903800964
loss_pred:0.016519224271178246, decouple_loss:0.002449259627610445
The modified gen p mean: 0.447007417678833, gen p mean: -0.24961362779140472, mean p set: 0.4475838840007782The modified gen p mean: 0.4464091658592224, gen p mean: -0.24699419736862183, mean p set: 0.44693562388420105
loss_pred:0.015506071969866753, decouple_loss:0.0025590236764401197
loss_pred:0.015372090972959995, decouple_loss:0.002861297456547618
Iteration: 1507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44623905420303345, gen p mean: -0.24727490544319153, mean p set: 0.44681257009506226
loss_pred:0.015180510468780994, decouple_loss:0.002384315710514784
The modified gen p mean: 0.4472476840019226, gen p mean: -0.24524225294589996, mean p set: 0.44783279299736023
loss_pred:0.015608374960720539, decouple_loss:0.0024137580767273903
The modified gen p mean: 0.44663769006729126, gen p mean: -0.2441759705543518, mean p set: 0.4471677839756012
loss_pred:0.015209633857011795, decouple_loss:0.002411823021247983
Iteration: 1508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727882742881775, gen p mean: -0.249525785446167, mean p set: 0.44785624742507935
loss_pred:0.015231749042868614, decouple_loss:0.002419952070340514
The modified gen p mean: 0.44758209586143494, gen p mean: -0.2490876317024231, mean p set: 0.4481663107872009
loss_pred:0.016160523518919945, decouple_loss:0.0024544158950448036
The modified gen p mean: 0.44709134101867676, gen p mean: -0.2498936951160431, mean p set: 0.44762295484542847
loss_pred:0.015486335381865501, decouple_loss:0.0024001484271138906
Iteration: 1509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486766755580902, gen p mean: -0.24773958325386047, mean p set: 0.44924843311309814
loss_pred:0.01591312699019909, decouple_loss:0.0027237948961555958
The modified gen p mean: 0.4481757879257202, gen p mean: -0.24525408446788788, mean p set: 0.44875821471214294
loss_pred:0.016208333894610405, decouple_loss:0.0026162085123360157
The modified gen p mean: 0.4454815685749054, gen p mean: -0.2429405301809311, mean p set: 0.4460061490535736
loss_pred:0.015710270032286644, decouple_loss:0.002580558182671666
Iteration: 1510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645383954048157, gen p mean: -0.24406379461288452, mean p set: 0.4470318555831909
loss_pred:0.015394541434943676, decouple_loss:0.002463617129251361
The modified gen p mean: 0.4467995762825012, gen p mean: -0.24604973196983337, mean p set: 0.4473719894886017The modified gen p mean: 0.44744041562080383, gen p mean: -0.250310480594635, mean p set: 0.447966605424881
loss_pred:0.016021300107240677, decouple_loss:0.0024230764247477055
loss_pred:0.015236868523061275, decouple_loss:0.0025088663678616285
2023-04-27 04:06:48 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2489045411348343, mean p set: 0.4499112665653229
loss_pred:0.016788236796855927, decouple_loss:0.0025097429752349854
The modified gen p mean: 0.44930392503738403, gen p mean: -0.24872581660747528, mean p set: 0.4498290419578552
loss_pred:0.016361145302653313, decouple_loss:0.0024897740222513676
The modified gen p mean: 0.44821780920028687, gen p mean: -0.24564281105995178, mean p set: 0.44879910349845886
loss_pred:0.01671409420669079, decouple_loss:0.0025234997738152742
WV_1_PC_1_EH_0_PS_30, loss: 0.01674654334783554, avg_mse: 0.024743489921092987
current test mse: 0.024743
Iteration: 1511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477689564228058, gen p mean: -0.2507883906364441, mean p set: 0.44834285974502563
loss_pred:0.015880431979894638, decouple_loss:0.0024848065804690123
The modified gen p mean: 0.4481142461299896, gen p mean: -0.24632824957370758, mean p set: 0.44864004850387573
loss_pred:0.01613869145512581, decouple_loss:0.0025994658935815096
The modified gen p mean: 0.4462128281593323, gen p mean: -0.2454005777835846, mean p set: 0.44678959250450134
loss_pred:0.015274730511009693, decouple_loss:0.0024925684556365013
Iteration: 1512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468732178211212, gen p mean: -0.25391247868537903, mean p set: 0.44739779829978943
loss_pred:0.015302315354347229, decouple_loss:0.002629716182127595
The modified gen p mean: 0.44536644220352173, gen p mean: -0.25184720754623413, mean p set: 0.44594070315361023
The modified gen p mean: 0.447478711605072, gen p mean: -0.2540164291858673, mean p set: 0.448056697845459
loss_pred:0.01505775935947895, decouple_loss:0.0028565360698848963
loss_pred:0.015272578224539757, decouple_loss:0.002678666263818741
Iteration: 1513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446501761674881, gen p mean: -0.2521323561668396, mean p set: 0.44703078269958496
loss_pred:0.015568435192108154, decouple_loss:0.002550306497141719
The modified gen p mean: 0.449072927236557, gen p mean: -0.2540215253829956, mean p set: 0.44964826107025146
The modified gen p mean: 0.4472850263118744, gen p mean: -0.2569076120853424, mean p set: 0.44786328077316284
loss_pred:0.015571744181215763, decouple_loss:0.0023991758935153484
loss_pred:0.014797484502196312, decouple_loss:0.002264239825308323
Iteration: 1514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446582168340683, gen p mean: -0.25611433386802673, mean p set: 0.4471190571784973
loss_pred:0.014937428757548332, decouple_loss:0.0028954138979315758
The modified gen p mean: 0.4471377432346344, gen p mean: -0.2529287040233612, mean p set: 0.44771912693977356
The modified gen p mean: 0.44915464520454407, gen p mean: -0.2536364495754242, mean p set: 0.44973060488700867
loss_pred:0.015561599284410477, decouple_loss:0.0029257654678076506
loss_pred:0.015525051392614841, decouple_loss:0.002806026255711913
Iteration: 1515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795435667037964, gen p mean: -0.25389131903648376, mean p set: 0.4485260546207428
loss_pred:0.015580687671899796, decouple_loss:0.002427375642582774
The modified gen p mean: 0.4473247528076172, gen p mean: -0.2557308077812195, mean p set: 0.4478478729724884The modified gen p mean: 0.44682741165161133, gen p mean: -0.2571099102497101, mean p set: 0.44740432500839233
loss_pred:0.015555347315967083, decouple_loss:0.0024339701049029827
loss_pred:0.015075027011334896, decouple_loss:0.002318168291822076
Iteration: 1516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464143216609955, gen p mean: -0.2535313069820404, mean p set: 0.4469926357269287
loss_pred:0.015646059066057205, decouple_loss:0.002656281227245927
The modified gen p mean: 0.4483512043952942, gen p mean: -0.25382712483406067, mean p set: 0.44887736439704895The modified gen p mean: 0.4477727711200714, gen p mean: -0.2535787522792816, mean p set: 0.44834670424461365
loss_pred:0.015803895890712738, decouple_loss:0.0025710195768624544
loss_pred:0.015885354951024055, decouple_loss:0.0025089350529015064
Iteration: 1517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758340716362, gen p mean: -0.2551812529563904, mean p set: 0.44815176725387573
loss_pred:0.015496539883315563, decouple_loss:0.002442853292450309
The modified gen p mean: 0.4464101195335388, gen p mean: -0.2526240050792694, mean p set: 0.4469849467277527The modified gen p mean: 0.4466029703617096, gen p mean: -0.2563452124595642, mean p set: 0.4471312463283539
loss_pred:0.01532216090708971, decouple_loss:0.0023309807293117046
loss_pred:0.015277775004506111, decouple_loss:0.002326401649042964
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634419679641724, gen p mean: -0.25011107325553894, mean p set: 0.44692057371139526
loss_pred:0.015398264862596989, decouple_loss:0.0024417894892394543
The modified gen p mean: 0.44698235392570496, gen p mean: -0.25032004714012146, mean p set: 0.4475100040435791The modified gen p mean: 0.44758230447769165, gen p mean: -0.25424060225486755, mean p set: 0.4481556713581085
loss_pred:0.01552753709256649, decouple_loss:0.0024002345744520426
loss_pred:0.014979531988501549, decouple_loss:0.002521055517718196
Iteration: 1519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788244366645813, gen p mean: -0.2556113600730896, mean p set: 0.44845691323280334
loss_pred:0.01571894809603691, decouple_loss:0.0024829800240695477
The modified gen p mean: 0.44656693935394287, gen p mean: -0.25353166460990906, mean p set: 0.44709280133247375The modified gen p mean: 0.44604697823524475, gen p mean: -0.25177720189094543, mean p set: 0.4466286599636078
loss_pred:0.015431538224220276, decouple_loss:0.0026105993892997503
loss_pred:0.0153243038803339, decouple_loss:0.002513675484806299
Iteration: 1520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460434019565582, gen p mean: -0.256366491317749, mean p set: 0.4466158449649811
loss_pred:0.015004785731434822, decouple_loss:0.0025942097418010235
The modified gen p mean: 0.4486805200576782, gen p mean: -0.2587606906890869, mean p set: 0.4492546021938324
loss_pred:0.015670018270611763, decouple_loss:0.0024907460901886225
The modified gen p mean: 0.446748286485672, gen p mean: -0.25952625274658203, mean p set: 0.4472857117652893
loss_pred:0.01552544068545103, decouple_loss:0.0025915836449712515
2023-04-27 04:10:12 testing...
The modified gen p mean: 0.4482235908508301, gen p mean: -0.25284719467163086, mean p set: 0.44879910349845886
loss_pred:0.01669355109333992, decouple_loss:0.0023292964324355125
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2558133006095886, mean p set: 0.4499112665653229
loss_pred:0.016729790717363358, decouple_loss:0.002355614211410284
The modified gen p mean: 0.44929394125938416, gen p mean: -0.2557264268398285, mean p set: 0.4498290419578552
loss_pred:0.016335517168045044, decouple_loss:0.002303804736584425
WV_1_PC_1_EH_0_PS_30, loss: 0.016702763736248016, avg_mse: 0.02464125119149685
current test mse: 0.024641
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 1521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903796911239624, gen p mean: -0.25838229060173035, mean p set: 0.44956550002098083
loss_pred:0.016375457867980003, decouple_loss:0.002125977771356702
The modified gen p mean: 0.4474567472934723, gen p mean: -0.24849699437618256, mean p set: 0.4480302929878235
loss_pred:0.01634221337735653, decouple_loss:0.002568046096712351
The modified gen p mean: 0.44854500889778137, gen p mean: -0.2541942000389099, mean p set: 0.44911903142929077
loss_pred:0.01640622317790985, decouple_loss:0.0022658470552414656
Iteration: 1522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483657777309418, gen p mean: -0.2557213008403778, mean p set: 0.4488937258720398
loss_pred:0.016826413571834564, decouple_loss:0.0026634996756911278
The modified gen p mean: 0.4491531252861023, gen p mean: -0.2549373507499695, mean p set: 0.44972550868988037
loss_pred:0.015896597877144814, decouple_loss:0.0030632202979177237
The modified gen p mean: 0.44770145416259766, gen p mean: -0.2534439265727997, mean p set: 0.4482733905315399
loss_pred:0.016268230974674225, decouple_loss:0.0030143463518470526
Iteration: 1523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489513635635376, gen p mean: -0.2540953755378723, mean p set: 0.44947290420532227
loss_pred:0.015794597566127777, decouple_loss:0.0024209318216890097
The modified gen p mean: 0.44893696904182434, gen p mean: -0.25491735339164734, mean p set: 0.44951876997947693
loss_pred:0.016054704785346985, decouple_loss:0.00236935680732131
The modified gen p mean: 0.4492853879928589, gen p mean: -0.25893479585647583, mean p set: 0.4498598277568817
loss_pred:0.015732359141111374, decouple_loss:0.0024024173617362976
Iteration: 1524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493981599807739, gen p mean: -0.25818195939064026, mean p set: 0.449928879737854
loss_pred:0.016056234017014503, decouple_loss:0.002817698521539569
The modified gen p mean: 0.44889533519744873, gen p mean: -0.256686270236969, mean p set: 0.4494735598564148
loss_pred:0.01597599871456623, decouple_loss:0.002937657292932272
The modified gen p mean: 0.44772863388061523, gen p mean: -0.2464827597141266, mean p set: 0.44830653071403503
loss_pred:0.015825306996703148, decouple_loss:0.003469649702310562
Iteration: 1525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932636618614197, gen p mean: -0.26159051060676575, mean p set: 0.4498986005783081
loss_pred:0.016365719959139824, decouple_loss:0.0028017053846269846
The modified gen p mean: 0.44911015033721924, gen p mean: -0.25862640142440796, mean p set: 0.4496401250362396The modified gen p mean: 0.4481828510761261, gen p mean: -0.25435951352119446, mean p set: 0.4487597644329071
loss_pred:0.01639961265027523, decouple_loss:0.0026434934698045254
loss_pred:0.016017533838748932, decouple_loss:0.0026576374657452106
Iteration: 1526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893190264701843, gen p mean: -0.2552609443664551, mean p set: 0.44951972365379333
loss_pred:0.015715735033154488, decouple_loss:0.0027659370098263025
The modified gen p mean: 0.4484861195087433, gen p mean: -0.2518514096736908, mean p set: 0.44901883602142334The modified gen p mean: 0.44810232520103455, gen p mean: -0.2501337230205536, mean p set: 0.4486786425113678
loss_pred:0.01701376959681511, decouple_loss:0.002424974227324128
loss_pred:0.015196875669062138, decouple_loss:0.0027159214951097965
Iteration: 1527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859009981155396, gen p mean: -0.2529688775539398, mean p set: 0.4491669833660126
loss_pred:0.015692338347434998, decouple_loss:0.0023750581312924623
The modified gen p mean: 0.4472498595714569, gen p mean: -0.2516540586948395, mean p set: 0.4478098452091217The modified gen p mean: 0.4479374885559082, gen p mean: -0.25397151708602905, mean p set: 0.44845834374427795
loss_pred:0.01664690114557743, decouple_loss:0.0025597342755645514
loss_pred:0.01574302278459072, decouple_loss:0.0026482734829187393
Iteration: 1528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803738594055176, gen p mean: -0.2537875771522522, mean p set: 0.4486114978790283
loss_pred:0.016645288094878197, decouple_loss:0.002529511461034417
The modified gen p mean: 0.44799473881721497, gen p mean: -0.25643831491470337, mean p set: 0.448577344417572
loss_pred:0.01593291014432907, decouple_loss:0.0024768037255853415
The modified gen p mean: 0.44808557629585266, gen p mean: -0.2568378448486328, mean p set: 0.44861117005348206
loss_pred:0.016244903206825256, decouple_loss:0.00240302667953074
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487383961677551, gen p mean: -0.26045870780944824, mean p set: 0.4493010640144348
loss_pred:0.01590725965797901, decouple_loss:0.0022643194533884525
The modified gen p mean: 0.44834911823272705, gen p mean: -0.2580578625202179, mean p set: 0.4488733410835266The modified gen p mean: 0.4493761658668518, gen p mean: -0.2551231384277344, mean p set: 0.4499538242816925
loss_pred:0.015824533998966217, decouple_loss:0.0023038180079311132
loss_pred:0.01611180230975151, decouple_loss:0.002468380145728588
Iteration: 1530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867974519729614, gen p mean: -0.255172461271286, mean p set: 0.4492647647857666
loss_pred:0.015623345039784908, decouple_loss:0.002297230064868927
The modified gen p mean: 0.44883111119270325, gen p mean: -0.25599271059036255, mean p set: 0.4494089186191559
loss_pred:0.015867972746491432, decouple_loss:0.00246638897806406
The modified gen p mean: 0.4492546617984772, gen p mean: -0.2539021968841553, mean p set: 0.4497752785682678
loss_pred:0.015311704948544502, decouple_loss:0.0023996743839234114
2023-04-27 04:14:25 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2514464259147644, mean p set: 0.4499112665653229
loss_pred:0.01672268658876419, decouple_loss:0.002569708274677396
The modified gen p mean: 0.4482273459434509, gen p mean: -0.2481776624917984, mean p set: 0.44879910349845886
loss_pred:0.0167559664696455, decouple_loss:0.002604302717372775
The modified gen p mean: 0.44930535554885864, gen p mean: -0.2515859007835388, mean p set: 0.4498290419578552
loss_pred:0.016247214749455452, decouple_loss:0.0026633914094418287
WV_1_PC_1_EH_0_PS_30, loss: 0.016705913469195366, avg_mse: 0.024623140692710876
current test mse: 0.024623
Iteration: 1531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485282301902771, gen p mean: -0.2537289559841156, mean p set: 0.4491029977798462
loss_pred:0.01629738137125969, decouple_loss:0.0025630146265029907
The modified gen p mean: 0.44779011607170105, gen p mean: -0.25085797905921936, mean p set: 0.44836896657943726
loss_pred:0.016605893149971962, decouple_loss:0.002461446914821863
The modified gen p mean: 0.4490661323070526, gen p mean: -0.25299498438835144, mean p set: 0.4495936930179596
loss_pred:0.015531692653894424, decouple_loss:0.002496937057003379
Iteration: 1532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840890169143677, gen p mean: -0.2518138587474823, mean p set: 0.4489397704601288
loss_pred:0.015497793443500996, decouple_loss:0.002176022157073021
The modified gen p mean: 0.44886234402656555, gen p mean: -0.2568966746330261, mean p set: 0.4494372606277466
loss_pred:0.01564733497798443, decouple_loss:0.0022734440863132477
The modified gen p mean: 0.44810089468955994, gen p mean: -0.2524433732032776, mean p set: 0.4486761689186096
loss_pred:0.01615726388990879, decouple_loss:0.002349090063944459
Iteration: 1533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489160180091858, gen p mean: -0.24811816215515137, mean p set: 0.4494384229183197
loss_pred:0.015565724112093449, decouple_loss:0.002358008874580264
The modified gen p mean: 0.44931089878082275, gen p mean: -0.25684285163879395, mean p set: 0.4498789310455322
loss_pred:0.015775687992572784, decouple_loss:0.002354729687795043
The modified gen p mean: 0.44938552379608154, gen p mean: -0.2528267800807953, mean p set: 0.4499637186527252
loss_pred:0.015726879239082336, decouple_loss:0.0024868000764399767
Iteration: 1534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834181666374207, gen p mean: -0.2561217248439789, mean p set: 0.4488653242588043
loss_pred:0.016060031950473785, decouple_loss:0.0023750404361635447
The modified gen p mean: 0.44929084181785583, gen p mean: -0.2541270852088928, mean p set: 0.4498666524887085
loss_pred:0.016250373795628548, decouple_loss:0.0023663025349378586
The modified gen p mean: 0.4490690529346466, gen p mean: -0.25768306851387024, mean p set: 0.4496367573738098
loss_pred:0.0157559085637331, decouple_loss:0.0023114599753171206
Iteration: 1535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846653938293457, gen p mean: -0.2579156756401062, mean p set: 0.4490435719490051
loss_pred:0.015556705184280872, decouple_loss:0.002417532727122307
The modified gen p mean: 0.44885414838790894, gen p mean: -0.2582644820213318, mean p set: 0.44942986965179443The modified gen p mean: 0.44811421632766724, gen p mean: -0.2479482740163803, mean p set: 0.4486406445503235
loss_pred:0.015776393935084343, decouple_loss:0.002359705278649926
loss_pred:0.016586480662226677, decouple_loss:0.0024515145923942327
Iteration: 1536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787874817848206, gen p mean: -0.25359612703323364, mean p set: 0.4484536051750183
loss_pred:0.01632906310260296, decouple_loss:0.002724881749600172
The modified gen p mean: 0.44864773750305176, gen p mean: -0.257184773683548, mean p set: 0.44917774200439453The modified gen p mean: 0.44772985577583313, gen p mean: -0.25583314895629883, mean p set: 0.4483001232147217
loss_pred:0.015980517491698265, decouple_loss:0.0025301645509898663
loss_pred:0.01625528559088707, decouple_loss:0.0023862174712121487
Iteration: 1537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488843083381653, gen p mean: -0.25779426097869873, mean p set: 0.4494534134864807
loss_pred:0.015428224578499794, decouple_loss:0.0022483053617179394
The modified gen p mean: 0.4494861662387848, gen p mean: -0.2598113417625427, mean p set: 0.45005539059638977
loss_pred:0.015390193089842796, decouple_loss:0.0022763970773667097
The modified gen p mean: 0.44796186685562134, gen p mean: -0.25197485089302063, mean p set: 0.448492169380188
loss_pred:0.016218038275837898, decouple_loss:0.0023265848867595196
Iteration: 1538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876787066459656, gen p mean: -0.2550576627254486, mean p set: 0.44934189319610596
loss_pred:0.016036950051784515, decouple_loss:0.0024105694610625505
The modified gen p mean: 0.4494337737560272, gen p mean: -0.26136547327041626, mean p set: 0.4500062167644501
loss_pred:0.015806613489985466, decouple_loss:0.002269577933475375
The modified gen p mean: 0.44910556077957153, gen p mean: -0.2552091181278229, mean p set: 0.4496358335018158
loss_pred:0.015949277207255363, decouple_loss:0.0024906364269554615
Iteration: 1539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486793875694275, gen p mean: -0.25159138441085815, mean p set: 0.44925159215927124
The modified gen p mean: 0.4474288523197174, gen p mean: -0.25302809476852417, mean p set: 0.4480001628398895
loss_pred:0.01653345860540867, decouple_loss:0.0024275679606944323loss_pred:0.015788599848747253, decouple_loss:0.0025303063448518515
The modified gen p mean: 0.44748955965042114, gen p mean: -0.2537049651145935, mean p set: 0.4480241537094116
loss_pred:0.016454070806503296, decouple_loss:0.0025500787887722254
Iteration: 1540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843676686286926, gen p mean: -0.2502670884132385, mean p set: 0.4490050673484802
loss_pred:0.016224222257733345, decouple_loss:0.002271717181429267
The modified gen p mean: 0.44878679513931274, gen p mean: -0.25339996814727783, mean p set: 0.4493670165538788
loss_pred:0.015409084036946297, decouple_loss:0.00225335662253201
The modified gen p mean: 0.4490102231502533, gen p mean: -0.2566453218460083, mean p set: 0.4495360851287842
loss_pred:0.01615935005247593, decouple_loss:0.002402182435616851
2023-04-27 04:17:50 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2563057541847229, mean p set: 0.4499112665653229
loss_pred:0.016737552359700203, decouple_loss:0.0029551233164966106
The modified gen p mean: 0.44929495453834534, gen p mean: -0.2566121220588684, mean p set: 0.4498290419578552
loss_pred:0.01644582487642765, decouple_loss:0.0028852615505456924
The modified gen p mean: 0.4482230842113495, gen p mean: -0.2530089020729065, mean p set: 0.44879910349845886
loss_pred:0.016785139217972755, decouple_loss:0.0028420165181159973
WV_1_PC_1_EH_0_PS_30, loss: 0.016800880432128906, avg_mse: 0.024664394557476044
current test mse: 0.024664
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 1541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44907793402671814, gen p mean: -0.2577946186065674, mean p set: 0.4495994448661804
loss_pred:0.015894874930381775, decouple_loss:0.00307677686214447
The modified gen p mean: 0.44866061210632324, gen p mean: -0.24559541046619415, mean p set: 0.4492368996143341
loss_pred:0.015493778511881828, decouple_loss:0.0031290301121771336
The modified gen p mean: 0.4497252404689789, gen p mean: -0.25143975019454956, mean p set: 0.45029905438423157
loss_pred:0.015505945309996605, decouple_loss:0.002939028199762106
Iteration: 1542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480637311935425, gen p mean: -0.24838636815547943, mean p set: 0.4485895335674286
loss_pred:0.015101412311196327, decouple_loss:0.002678768942132592
The modified gen p mean: 0.4491823613643646, gen p mean: -0.2573423981666565, mean p set: 0.44975459575653076
loss_pred:0.015274552628397942, decouple_loss:0.0026821931824088097
The modified gen p mean: 0.44980284571647644, gen p mean: -0.25760993361473083, mean p set: 0.4503842294216156
loss_pred:0.015667904168367386, decouple_loss:0.0028201828245073557
Iteration: 1543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492984712123871, gen p mean: -0.26063454151153564, mean p set: 0.44983842968940735
loss_pred:0.01598602719604969, decouple_loss:0.0032115650828927755
The modified gen p mean: 0.44639769196510315, gen p mean: -0.25815433263778687, mean p set: 0.4469698667526245
loss_pred:0.015056057833135128, decouple_loss:0.0032488906290382147
The modified gen p mean: 0.4492923617362976, gen p mean: -0.25300654768943787, mean p set: 0.4498685300350189
loss_pred:0.015776706859469414, decouple_loss:0.003240105928853154
Iteration: 1544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476793706417084, gen p mean: -0.25238844752311707, mean p set: 0.44820865988731384
loss_pred:0.015584863722324371, decouple_loss:0.00318436068482697
The modified gen p mean: 0.4494269788265228, gen p mean: -0.2579997777938843, mean p set: 0.4500042200088501
loss_pred:0.015534374862909317, decouple_loss:0.002801569877192378
The modified gen p mean: 0.4498925507068634, gen p mean: -0.2506589889526367, mean p set: 0.45046207308769226
loss_pred:0.015024267137050629, decouple_loss:0.0028051668778061867
Iteration: 1545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501083195209503, gen p mean: -0.251009464263916, mean p set: 0.450682133436203
loss_pred:0.015476204454898834, decouple_loss:0.0031510184053331614
The modified gen p mean: 0.4484439194202423, gen p mean: -0.2553469240665436, mean p set: 0.44902855157852173The modified gen p mean: 0.45010241866111755, gen p mean: -0.2490290105342865, mean p set: 0.4506332576274872
loss_pred:0.015684781596064568, decouple_loss:0.002683598781004548
loss_pred:0.014689628034830093, decouple_loss:0.0027158043812960386
Iteration: 1546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969645142555237, gen p mean: -0.25362709164619446, mean p set: 0.4502703547477722
loss_pred:0.015666352584958076, decouple_loss:0.002654400886967778
The modified gen p mean: 0.44763076305389404, gen p mean: -0.2531605064868927, mean p set: 0.44820713996887207
loss_pred:0.01580064371228218, decouple_loss:0.0025722661521285772
The modified gen p mean: 0.44869694113731384, gen p mean: -0.252931147813797, mean p set: 0.4492279887199402
loss_pred:0.015029537491500378, decouple_loss:0.0027848256286233664
Iteration: 1547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856178760528564, gen p mean: -0.25347810983657837, mean p set: 0.449137419462204
loss_pred:0.015302679501473904, decouple_loss:0.002611280884593725
The modified gen p mean: 0.44798919558525085, gen p mean: -0.2466636300086975, mean p set: 0.4485769271850586
loss_pred:0.014987233094871044, decouple_loss:0.0028639500960707664
The modified gen p mean: 0.4484776258468628, gen p mean: -0.24754278361797333, mean p set: 0.44900989532470703
loss_pred:0.01546570286154747, decouple_loss:0.002902351086959243
Iteration: 1548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489876627922058, gen p mean: -0.25465211272239685, mean p set: 0.4495595097541809
loss_pred:0.015379008837044239, decouple_loss:0.002746249083429575
The modified gen p mean: 0.448057621717453, gen p mean: -0.2503198981285095, mean p set: 0.448634535074234
loss_pred:0.015250843949615955, decouple_loss:0.0027949248906224966
The modified gen p mean: 0.44882693886756897, gen p mean: -0.25521528720855713, mean p set: 0.44936034083366394
loss_pred:0.015142996795475483, decouple_loss:0.002868845360353589
Iteration: 1549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829103350639343, gen p mean: -0.25724151730537415, mean p set: 0.4488680362701416
loss_pred:0.01470153871923685, decouple_loss:0.0025847074575722218
The modified gen p mean: 0.4475877583026886, gen p mean: -0.25451165437698364, mean p set: 0.4481198489665985The modified gen p mean: 0.44966113567352295, gen p mean: -0.2492581158876419, mean p set: 0.45022737979888916
loss_pred:0.015687135979533195, decouple_loss:0.0026761286426335573
loss_pred:0.014963611029088497, decouple_loss:0.0025694728828966618
Iteration: 1550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492667317390442, gen p mean: -0.24977467954158783, mean p set: 0.4498407244682312
loss_pred:0.015156462788581848, decouple_loss:0.0026752531994134188
The modified gen p mean: 0.44653016328811646, gen p mean: -0.25459155440330505, mean p set: 0.44710251688957214
loss_pred:0.015185224823653698, decouple_loss:0.0027271381113678217
The modified gen p mean: 0.44752824306488037, gen p mean: -0.24936704337596893, mean p set: 0.448056697845459
loss_pred:0.014863661490380764, decouple_loss:0.0028153294697403908
2023-04-27 04:21:54 testing...
The modified gen p mean: 0.448223352432251, gen p mean: -0.2480953186750412, mean p set: 0.44879910349845886
loss_pred:0.016762027516961098, decouple_loss:0.0025834853295236826
The modified gen p mean: 0.44930222630500793, gen p mean: -0.2513120174407959, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25132450461387634, mean p set: 0.4499112665653229loss_pred:0.01644562929868698, decouple_loss:0.0026867338456213474
loss_pred:0.016841676086187363, decouple_loss:0.0027491950895637274
WV_1_PC_1_EH_0_PS_30, loss: 0.016816768795251846, avg_mse: 0.024824583902955055
current test mse: 0.024825
Iteration: 1551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906875491142273, gen p mean: -0.2510291039943695, mean p set: 0.44958946108818054
loss_pred:0.015195392072200775, decouple_loss:0.002544928342103958
The modified gen p mean: 0.450310617685318, gen p mean: -0.24518899619579315, mean p set: 0.4508882462978363
loss_pred:0.014982372522354126, decouple_loss:0.0026192383375018835
The modified gen p mean: 0.44910892844200134, gen p mean: -0.24930037558078766, mean p set: 0.449687123298645
loss_pred:0.015915771946310997, decouple_loss:0.0024313987232744694
Iteration: 1552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44942665100097656, gen p mean: -0.24533160030841827, mean p set: 0.4499533474445343
loss_pred:0.01505897007882595, decouple_loss:0.00271363602951169
The modified gen p mean: 0.44930434226989746, gen p mean: -0.2481335699558258, mean p set: 0.44987955689430237
The modified gen p mean: 0.44903209805488586, gen p mean: -0.24972474575042725, mean p set: 0.4496126174926758
loss_pred:0.015194840729236603, decouple_loss:0.0027754101902246475
loss_pred:0.014633693732321262, decouple_loss:0.0027608154341578484
Iteration: 1553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488212764263153, gen p mean: -0.2518404424190521, mean p set: 0.4493459463119507
loss_pred:0.015909720212221146, decouple_loss:0.0029829053673893213
The modified gen p mean: 0.44871315360069275, gen p mean: -0.2476814091205597, mean p set: 0.449288934469223
The modified gen p mean: 0.4490620493888855, gen p mean: -0.24495278298854828, mean p set: 0.44964301586151123
loss_pred:0.015397817827761173, decouple_loss:0.0026830972637981176
loss_pred:0.015780454501509666, decouple_loss:0.002738210605457425
Iteration: 1554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934338331222534, gen p mean: -0.2408396601676941, mean p set: 0.4499235153198242
loss_pred:0.015473416075110435, decouple_loss:0.002481029834598303
The modified gen p mean: 0.44783762097358704, gen p mean: -0.24454717338085175, mean p set: 0.4483669102191925
The modified gen p mean: 0.4483897387981415, gen p mean: -0.25089913606643677, mean p set: 0.44896194338798523
loss_pred:0.015257189981639385, decouple_loss:0.002350911032408476
loss_pred:0.01557665504515171, decouple_loss:0.002557702362537384
Iteration: 1555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472818374633789, gen p mean: -0.2560974657535553, mean p set: 0.4478663504123688
loss_pred:0.01509432215243578, decouple_loss:0.002627616049721837
The modified gen p mean: 0.44776827096939087, gen p mean: -0.2486623078584671, mean p set: 0.4483490288257599
loss_pred:0.01507641188800335, decouple_loss:0.0028676369693130255
The modified gen p mean: 0.44845327734947205, gen p mean: -0.2550794780254364, mean p set: 0.44898566603660583
loss_pred:0.015120779164135456, decouple_loss:0.0025180638767778873
Iteration: 1556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486008286476135, gen p mean: -0.25234317779541016, mean p set: 0.44917967915534973
loss_pred:0.014906836673617363, decouple_loss:0.002628508722409606
The modified gen p mean: 0.4495362341403961, gen p mean: -0.25384944677352905, mean p set: 0.4500616788864136The modified gen p mean: 0.4489195644855499, gen p mean: -0.2510986328125, mean p set: 0.44949984550476074
loss_pred:0.015460336580872536, decouple_loss:0.0027187231462448835
loss_pred:0.015266946516931057, decouple_loss:0.002718992531299591
Iteration: 1557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477912485599518, gen p mean: -0.2457088977098465, mean p set: 0.44837456941604614
loss_pred:0.015543735586106777, decouple_loss:0.002592700067907572
The modified gen p mean: 0.4483693540096283, gen p mean: -0.24767915904521942, mean p set: 0.448943167924881
loss_pred:0.015251384116709232, decouple_loss:0.002508653560653329
The modified gen p mean: 0.448781281709671, gen p mean: -0.2508731186389923, mean p set: 0.44930922985076904
loss_pred:0.01514466293156147, decouple_loss:0.0031794067472219467
Iteration: 1558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487423002719879, gen p mean: -0.25020632147789, mean p set: 0.44932347536087036
loss_pred:0.01501713041216135, decouple_loss:0.0024566773790866137
The modified gen p mean: 0.44888052344322205, gen p mean: -0.2519046664237976, mean p set: 0.44945788383483887
loss_pred:0.014851856045424938, decouple_loss:0.0025019601453095675
The modified gen p mean: 0.44791996479034424, gen p mean: -0.24631042778491974, mean p set: 0.44844722747802734
loss_pred:0.015545052476227283, decouple_loss:0.002363900188356638
Iteration: 1559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471459686756134, gen p mean: -0.25101396441459656, mean p set: 0.4477255642414093
loss_pred:0.014879138208925724, decouple_loss:0.002448952291160822
The modified gen p mean: 0.4500596225261688, gen p mean: -0.24984028935432434, mean p set: 0.45063140988349915
loss_pred:0.01547040231525898, decouple_loss:0.0027089579962193966
The modified gen p mean: 0.4485088586807251, gen p mean: -0.2592683434486389, mean p set: 0.44904085993766785
loss_pred:0.015071156434714794, decouple_loss:0.002425316022709012
Iteration: 1560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803565740585327, gen p mean: -0.2513326406478882, mean p set: 0.44861605763435364
loss_pred:0.015139135532081127, decouple_loss:0.0024612299166619778
The modified gen p mean: 0.4483027160167694, gen p mean: -0.2446753829717636, mean p set: 0.44888070225715637
loss_pred:0.014924613758921623, decouple_loss:0.002647866029292345
The modified gen p mean: 0.44806981086730957, gen p mean: -0.25243067741394043, mean p set: 0.4485909342765808
loss_pred:0.015752337872982025, decouple_loss:0.0025367483031004667
2023-04-27 04:25:19 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2575820982456207, mean p set: 0.4499112665653229
loss_pred:0.016943732276558876, decouple_loss:0.0030621266923844814
The modified gen p mean: 0.4493083655834198, gen p mean: -0.25738659501075745, mean p set: 0.4498290419578552
loss_pred:0.01650582067668438, decouple_loss:0.003054979955777526
The modified gen p mean: 0.4482256770133972, gen p mean: -0.2539025545120239, mean p set: 0.44879910349845886
loss_pred:0.0167867299169302, decouple_loss:0.002874532714486122
WV_1_PC_1_EH_0_PS_30, loss: 0.016895288601517677, avg_mse: 0.024896422401070595
current test mse: 0.024896
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 1561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717806577682495, gen p mean: -0.25850000977516174, mean p set: 0.44771143794059753
loss_pred:0.0165043193846941, decouple_loss:0.002769071375951171
The modified gen p mean: 0.4475037753582001, gen p mean: -0.25583887100219727, mean p set: 0.44807714223861694
loss_pred:0.016604099422693253, decouple_loss:0.0027096422854810953
The modified gen p mean: 0.44735628366470337, gen p mean: -0.2594299018383026, mean p set: 0.44792598485946655
loss_pred:0.016454089432954788, decouple_loss:0.0030716105829924345
Iteration: 1562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482872188091278, gen p mean: -0.25745895504951477, mean p set: 0.4488099217414856
loss_pred:0.01706286333501339, decouple_loss:0.002787610748782754
The modified gen p mean: 0.4464465379714966, gen p mean: -0.2553102672100067, mean p set: 0.44702383875846863
The modified gen p mean: 0.44803619384765625, gen p mean: -0.2558319866657257, mean p set: 0.4486115872859955
loss_pred:0.01603752188384533, decouple_loss:0.0026928300503641367
loss_pred:0.01656266488134861, decouple_loss:0.002767563331872225
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753432273864746, gen p mean: -0.25467434525489807, mean p set: 0.4480603337287903
loss_pred:0.016292760148644447, decouple_loss:0.0029543263372033834
The modified gen p mean: 0.4475659430027008, gen p mean: -0.2527495324611664, mean p set: 0.4481448233127594
The modified gen p mean: 0.44705215096473694, gen p mean: -0.25296005606651306, mean p set: 0.44763314723968506
loss_pred:0.016373710706830025, decouple_loss:0.0031993354205042124
loss_pred:0.016849040985107422, decouple_loss:0.003225030843168497
Iteration: 1564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472152590751648, gen p mean: -0.2508644461631775, mean p set: 0.44774720072746277
loss_pred:0.015724221244454384, decouple_loss:0.002856412436813116
The modified gen p mean: 0.4471990466117859, gen p mean: -0.24787478148937225, mean p set: 0.44777771830558777
The modified gen p mean: 0.4469200670719147, gen p mean: -0.24606584012508392, mean p set: 0.44749921560287476
loss_pred:0.016692226752638817, decouple_loss:0.002766579622402787
loss_pred:0.01665782742202282, decouple_loss:0.0026791896671056747
Iteration: 1565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753801822662354, gen p mean: -0.2461158186197281, mean p set: 0.4481123387813568
loss_pred:0.015647877007722855, decouple_loss:0.0027535303961485624
The modified gen p mean: 0.44744402170181274, gen p mean: -0.24739323556423187, mean p set: 0.4480176270008087
loss_pred:0.016510380432009697, decouple_loss:0.0028391003143042326
The modified gen p mean: 0.44808971881866455, gen p mean: -0.25300922989845276, mean p set: 0.4486217796802521
loss_pred:0.015900099650025368, decouple_loss:0.003152281977236271
Iteration: 1566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474366009235382, gen p mean: -0.2515638470649719, mean p set: 0.4480043649673462
loss_pred:0.01679004170000553, decouple_loss:0.0027306978590786457
The modified gen p mean: 0.4470180571079254, gen p mean: -0.2454744428396225, mean p set: 0.4475988745689392The modified gen p mean: 0.44734036922454834, gen p mean: -0.24303101003170013, mean p set: 0.4478713572025299
loss_pred:0.015953736379742622, decouple_loss:0.0027878079563379288
loss_pred:0.01685076765716076, decouple_loss:0.002671878319233656
Iteration: 1567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769570231437683, gen p mean: -0.2517414093017578, mean p set: 0.4482708275318146
loss_pred:0.01710936613380909, decouple_loss:0.002738325158134103
The modified gen p mean: 0.4469324052333832, gen p mean: -0.24601656198501587, mean p set: 0.4474641680717468
The modified gen p mean: 0.447090744972229, gen p mean: -0.2471926212310791, mean p set: 0.4476645588874817
loss_pred:0.01636265031993389, decouple_loss:0.0027653935831040144
loss_pred:0.017083439975976944, decouple_loss:0.002859109779819846
Iteration: 1568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472447335720062, gen p mean: -0.24420620501041412, mean p set: 0.44781771302223206
loss_pred:0.01660817861557007, decouple_loss:0.00270847138017416
The modified gen p mean: 0.44708704948425293, gen p mean: -0.24741466343402863, mean p set: 0.4476606547832489
loss_pred:0.016534078866243362, decouple_loss:0.002693803980946541
The modified gen p mean: 0.4476180672645569, gen p mean: -0.2461465746164322, mean p set: 0.4481445848941803
loss_pred:0.015855250880122185, decouple_loss:0.002785242861136794
Iteration: 1569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742774963378906, gen p mean: -0.2537687420845032, mean p set: 0.4480067491531372
loss_pred:0.01638166606426239, decouple_loss:0.0027976976707577705
The modified gen p mean: 0.44849616289138794, gen p mean: -0.2523869574069977, mean p set: 0.4490697383880615
loss_pred:0.01574506051838398, decouple_loss:0.002499394817277789
The modified gen p mean: 0.4475405514240265, gen p mean: -0.2522388994693756, mean p set: 0.44806763529777527
loss_pred:0.01612313650548458, decouple_loss:0.0032891591545194387
Iteration: 1570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475207030773163, gen p mean: -0.2490130066871643, mean p set: 0.4481000304222107
loss_pred:0.016417818143963814, decouple_loss:0.002471047220751643
The modified gen p mean: 0.4468722641468048, gen p mean: -0.24999262392520905, mean p set: 0.447443425655365
loss_pred:0.0159591156989336, decouple_loss:0.002463510725647211
The modified gen p mean: 0.447414755821228, gen p mean: -0.2513587176799774, mean p set: 0.44793930649757385
loss_pred:0.01669057458639145, decouple_loss:0.0024966238997876644
2023-04-27 04:29:19 testing...
The modified gen p mean: 0.4482251703739166, gen p mean: -0.24621514976024628, mean p set: 0.44879910349845886
loss_pred:0.016655273735523224, decouple_loss:0.003192861331626773
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24934770166873932, mean p set: 0.4499112665653229
loss_pred:0.016736401244997978, decouple_loss:0.003237671684473753
The modified gen p mean: 0.4492972791194916, gen p mean: -0.2490747720003128, mean p set: 0.4498290419578552
loss_pred:0.016358427703380585, decouple_loss:0.003508165944367647
WV_1_PC_1_EH_0_PS_30, loss: 0.01674901321530342, avg_mse: 0.024611784145236015
current test mse: 0.024612
Iteration: 1571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476698637008667, gen p mean: -0.25359493494033813, mean p set: 0.44824355840682983
loss_pred:0.01658134162425995, decouple_loss:0.0029330516699701548
The modified gen p mean: 0.44722461700439453, gen p mean: -0.24838434159755707, mean p set: 0.4478038251399994
loss_pred:0.016178667545318604, decouple_loss:0.0032813583966344595
The modified gen p mean: 0.44775915145874023, gen p mean: -0.25572770833969116, mean p set: 0.4482952058315277
loss_pred:0.015816377475857735, decouple_loss:0.0028167772106826305
Iteration: 1572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476916491985321, gen p mean: -0.25127503275871277, mean p set: 0.4482216238975525
loss_pred:0.017022207379341125, decouple_loss:0.002648991299793124
The modified gen p mean: 0.4471047818660736, gen p mean: -0.25402024388313293, mean p set: 0.44768041372299194
loss_pred:0.015332944691181183, decouple_loss:0.0026939972303807735
The modified gen p mean: 0.4469875395298004, gen p mean: -0.24582208693027496, mean p set: 0.44755926728248596
loss_pred:0.016828536987304688, decouple_loss:0.0027225548401474953
Iteration: 1573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853904843330383, gen p mean: -0.2569817006587982, mean p set: 0.4490669369697571
loss_pred:0.01587493345141411, decouple_loss:0.0030668338295072317
The modified gen p mean: 0.44791361689567566, gen p mean: -0.26016438007354736, mean p set: 0.44848695397377014
loss_pred:0.016038257628679276, decouple_loss:0.0026640479918569326
The modified gen p mean: 0.4476979672908783, gen p mean: -0.2537277936935425, mean p set: 0.4482730031013489
loss_pred:0.01579578034579754, decouple_loss:0.0025472340639680624
Iteration: 1574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714289903640747, gen p mean: -0.2558572292327881, mean p set: 0.44767072796821594
loss_pred:0.01669112592935562, decouple_loss:0.003090814221650362
The modified gen p mean: 0.44621142745018005, gen p mean: -0.25760117173194885, mean p set: 0.44678664207458496
loss_pred:0.01564641296863556, decouple_loss:0.0024645451921969652
The modified gen p mean: 0.4470958113670349, gen p mean: -0.26234468817710876, mean p set: 0.44767072796821594
loss_pred:0.016506539657711983, decouple_loss:0.0030185531359165907
Iteration: 1575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751715660095215, gen p mean: -0.2552271783351898, mean p set: 0.4480897784233093
loss_pred:0.01616021990776062, decouple_loss:0.003813082817941904
The modified gen p mean: 0.4474359154701233, gen p mean: -0.25669410824775696, mean p set: 0.4479702413082123The modified gen p mean: 0.4461720287799835, gen p mean: -0.2549799978733063, mean p set: 0.4467572569847107
loss_pred:0.015356549993157387, decouple_loss:0.0031292184721678495
loss_pred:0.0160759836435318, decouple_loss:0.0033009571488946676
Iteration: 1576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44591930508613586, gen p mean: -0.25563502311706543, mean p set: 0.44649389386177063
loss_pred:0.015234604477882385, decouple_loss:0.0026770825497806072
The modified gen p mean: 0.44667595624923706, gen p mean: -0.255361944437027, mean p set: 0.44725102186203003
loss_pred:0.015606086701154709, decouple_loss:0.002737815026193857
The modified gen p mean: 0.44676584005355835, gen p mean: -0.2577669322490692, mean p set: 0.44729599356651306
loss_pred:0.015305198729038239, decouple_loss:0.002687990665435791
Iteration: 1577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446564644575119, gen p mean: -0.25834962725639343, mean p set: 0.44713303446769714
loss_pred:0.015655605122447014, decouple_loss:0.0031311793718487024
The modified gen p mean: 0.44742852449417114, gen p mean: -0.2596155107021332, mean p set: 0.44800713658332825
loss_pred:0.01585754007101059, decouple_loss:0.0028088847175240517
The modified gen p mean: 0.4474446177482605, gen p mean: -0.2552206516265869, mean p set: 0.4479668438434601
loss_pred:0.016838932409882545, decouple_loss:0.0037276819348335266
Iteration: 1578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479404091835022, gen p mean: -0.25798118114471436, mean p set: 0.4485156238079071
loss_pred:0.01548298355191946, decouple_loss:0.002876403508707881
The modified gen p mean: 0.446865439414978, gen p mean: -0.2590148448944092, mean p set: 0.44739648699760437The modified gen p mean: 0.44726261496543884, gen p mean: -0.2564198672771454, mean p set: 0.44783589243888855
loss_pred:0.015458031557500362, decouple_loss:0.0028365361504256725
loss_pred:0.016774164512753487, decouple_loss:0.00282518588937819
Iteration: 1579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471970498561859, gen p mean: -0.2547246217727661, mean p set: 0.4477778375148773
loss_pred:0.01570303738117218, decouple_loss:0.002545240567997098
The modified gen p mean: 0.44700679183006287, gen p mean: -0.2585490345954895, mean p set: 0.44758090376853943
loss_pred:0.01588103547692299, decouple_loss:0.002650415524840355
The modified gen p mean: 0.4478047490119934, gen p mean: -0.25352078676223755, mean p set: 0.44833505153656006
loss_pred:0.016327034682035446, decouple_loss:0.002767144236713648
Iteration: 1580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766199588775635, gen p mean: -0.2592570185661316, mean p set: 0.4482428729534149
loss_pred:0.01597069762647152, decouple_loss:0.002968698041513562
The modified gen p mean: 0.4476214647293091, gen p mean: -0.25370627641677856, mean p set: 0.44820162653923035
loss_pred:0.016598228365182877, decouple_loss:0.0029291820246726274
The modified gen p mean: 0.44750165939331055, gen p mean: -0.2513108253479004, mean p set: 0.4480361342430115
loss_pred:0.016297902911901474, decouple_loss:0.00268642813898623
2023-04-27 04:32:44 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2522513270378113, mean p set: 0.4499112665653229
loss_pred:0.01683199033141136, decouple_loss:0.002769490471109748
The modified gen p mean: 0.4493025541305542, gen p mean: -0.25183820724487305, mean p set: 0.4498290419578552
loss_pred:0.016436219215393066, decouple_loss:0.0027335279155522585
The modified gen p mean: 0.44822582602500916, gen p mean: -0.24913448095321655, mean p set: 0.44879910349845886
loss_pred:0.016676077619194984, decouple_loss:0.0027826305013149977
WV_1_PC_1_EH_0_PS_30, loss: 0.01678619161248207, avg_mse: 0.0247250534594059
current test mse: 0.024725
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 1581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493645429611206, gen p mean: -0.25591278076171875, mean p set: 0.4498860538005829
loss_pred:0.015902873128652573, decouple_loss:0.002832650439813733
The modified gen p mean: 0.44714123010635376, gen p mean: -0.25448328256607056, mean p set: 0.4477207064628601
loss_pred:0.015318651683628559, decouple_loss:0.002861415036022663
The modified gen p mean: 0.44711241126060486, gen p mean: -0.25409626960754395, mean p set: 0.4476839303970337
loss_pred:0.015291811898350716, decouple_loss:0.003087041201069951
Iteration: 1582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489579498767853, gen p mean: -0.2552053928375244, mean p set: 0.4494830369949341
loss_pred:0.015047822147607803, decouple_loss:0.0028370132204145193
The modified gen p mean: 0.45014554262161255, gen p mean: -0.2495749443769455, mean p set: 0.4507233798503876The modified gen p mean: 0.44922447204589844, gen p mean: -0.2532082498073578, mean p set: 0.4497992694377899
loss_pred:0.01533826719969511, decouple_loss:0.002848004223778844
loss_pred:0.014929546974599361, decouple_loss:0.002555473707616329
Iteration: 1583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053374767303467, gen p mean: -0.2473960965871811, mean p set: 0.45106109976768494
loss_pred:0.014542548917233944, decouple_loss:0.00301709515042603
The modified gen p mean: 0.45049235224723816, gen p mean: -0.2521059811115265, mean p set: 0.4510750472545624
The modified gen p mean: 0.44827568531036377, gen p mean: -0.2552766501903534, mean p set: 0.44884857535362244
loss_pred:0.01524285227060318, decouple_loss:0.002932849572971463
loss_pred:0.015467829070985317, decouple_loss:0.0028071433771401644
Iteration: 1584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493938088417053, gen p mean: -0.2541756331920624, mean p set: 0.4499218463897705
loss_pred:0.01524500921368599, decouple_loss:0.0022678934037685394
The modified gen p mean: 0.4489888548851013, gen p mean: -0.2559342384338379, mean p set: 0.4495563805103302The modified gen p mean: 0.4489160180091858, gen p mean: -0.24641484022140503, mean p set: 0.44949066638946533
loss_pred:0.015559680759906769, decouple_loss:0.0024674003943800926
loss_pred:0.015492517501115799, decouple_loss:0.002764835488051176
Iteration: 1585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024603605270386, gen p mean: -0.24965094029903412, mean p set: 0.4508228898048401
loss_pred:0.014869128353893757, decouple_loss:0.0026234369724988937
The modified gen p mean: 0.44881781935691833, gen p mean: -0.2520405054092407, mean p set: 0.44939103722572327
loss_pred:0.015459919348359108, decouple_loss:0.0025109665002673864
The modified gen p mean: 0.4504857659339905, gen p mean: -0.24835674464702606, mean p set: 0.4510194957256317
loss_pred:0.014809253625571728, decouple_loss:0.0026458706706762314
Iteration: 1586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481552541255951, gen p mean: -0.2477649301290512, mean p set: 0.44873154163360596
loss_pred:0.014905959367752075, decouple_loss:0.0024794996716082096
The modified gen p mean: 0.4489646553993225, gen p mean: -0.24299846589565277, mean p set: 0.44953563809394836
loss_pred:0.015114267356693745, decouple_loss:0.002705947495996952
The modified gen p mean: 0.44987794756889343, gen p mean: -0.2449771910905838, mean p set: 0.450408935546875
loss_pred:0.014688229188323021, decouple_loss:0.0029707804787904024
Iteration: 1587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493507444858551, gen p mean: -0.24463286995887756, mean p set: 0.4499257802963257
loss_pred:0.015208693221211433, decouple_loss:0.002673511626198888
The modified gen p mean: 0.4486597180366516, gen p mean: -0.2405562698841095, mean p set: 0.4492337107658386
loss_pred:0.01487561035901308, decouple_loss:0.002336184261366725
The modified gen p mean: 0.4499637186527252, gen p mean: -0.2419624924659729, mean p set: 0.4504936933517456
loss_pred:0.014302194118499756, decouple_loss:0.002503355499356985
Iteration: 1588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931846857070923, gen p mean: -0.24467913806438446, mean p set: 0.4498968720436096
loss_pred:0.014468405395746231, decouple_loss:0.0026718934532254934
The modified gen p mean: 0.4498623013496399, gen p mean: -0.24049291014671326, mean p set: 0.4503912329673767The modified gen p mean: 0.450186550617218, gen p mean: -0.24586886167526245, mean p set: 0.45076262950897217
loss_pred:0.014437058940529823, decouple_loss:0.0026362971402704716
loss_pred:0.013968480750918388, decouple_loss:0.0025337759871035814
Iteration: 1589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488363564014435, gen p mean: -0.24411243200302124, mean p set: 0.4494141638278961
loss_pred:0.015688076615333557, decouple_loss:0.0024340753443539143
The modified gen p mean: 0.4474259614944458, gen p mean: -0.24409283697605133, mean p set: 0.4479977786540985
loss_pred:0.015139990486204624, decouple_loss:0.002508280100300908
The modified gen p mean: 0.4503883719444275, gen p mean: -0.24245212972164154, mean p set: 0.4509190618991852
loss_pred:0.01528003066778183, decouple_loss:0.002611861564218998
Iteration: 1590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506740868091583, gen p mean: -0.2437518984079361, mean p set: 0.4512515664100647
loss_pred:0.015093025751411915, decouple_loss:0.002681204816326499
The modified gen p mean: 0.44821634888648987, gen p mean: -0.24434998631477356, mean p set: 0.4487907588481903
loss_pred:0.015544761903584003, decouple_loss:0.002406948944553733
The modified gen p mean: 0.44928571581840515, gen p mean: -0.24969160556793213, mean p set: 0.4498126208782196
loss_pred:0.014851816929876804, decouple_loss:0.002716874470934272
2023-04-27 04:36:46 testing...
The modified gen p mean: 0.44821664690971375, gen p mean: -0.24391283094882965, mean p set: 0.44879910349845886
loss_pred:0.016843408346176147, decouple_loss:0.002693994902074337
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2471531480550766, mean p set: 0.4499112665653229
loss_pred:0.016973963007330894, decouple_loss:0.002940343925729394
The modified gen p mean: 0.44930019974708557, gen p mean: -0.24682007730007172, mean p set: 0.4498290419578552
loss_pred:0.016554169356822968, decouple_loss:0.0027358492370694876
WV_1_PC_1_EH_0_PS_30, loss: 0.01693001762032509, avg_mse: 0.024988438934087753
current test mse: 0.024988
Iteration: 1591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476410448551178, gen p mean: -0.24571123719215393, mean p set: 0.4482172131538391
loss_pred:0.015073838643729687, decouple_loss:0.0023929504677653313
The modified gen p mean: 0.45012667775154114, gen p mean: -0.24602673947811127, mean p set: 0.4507005214691162
loss_pred:0.014357447624206543, decouple_loss:0.002735897433012724
The modified gen p mean: 0.44980067014694214, gen p mean: -0.2452446073293686, mean p set: 0.4503350555896759
loss_pred:0.015113637782633305, decouple_loss:0.0026689970400184393
Iteration: 1592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872671365737915, gen p mean: -0.24060644209384918, mean p set: 0.4492511451244354
loss_pred:0.016225842759013176, decouple_loss:0.002850913442671299
The modified gen p mean: 0.448776513338089, gen p mean: -0.2435549795627594, mean p set: 0.4493516683578491
loss_pred:0.016063477843999863, decouple_loss:0.002830018987879157
The modified gen p mean: 0.44913336634635925, gen p mean: -0.2427482157945633, mean p set: 0.449707955121994
loss_pred:0.015228732489049435, decouple_loss:0.0029252672102302313
Iteration: 1593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44964954257011414, gen p mean: -0.23953275382518768, mean p set: 0.4501778185367584
loss_pred:0.01523754931986332, decouple_loss:0.0024040837306529284
The modified gen p mean: 0.4477851092815399, gen p mean: -0.23749825358390808, mean p set: 0.44835996627807617
loss_pred:0.01627095602452755, decouple_loss:0.0025255794171243906
The modified gen p mean: 0.4490107297897339, gen p mean: -0.24259045720100403, mean p set: 0.44958579540252686
loss_pred:0.015415887348353863, decouple_loss:0.0028464640490710735
Iteration: 1594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503650963306427, gen p mean: -0.24148134887218475, mean p set: 0.4508989155292511
loss_pred:0.014599662274122238, decouple_loss:0.0028587058186531067
The modified gen p mean: 0.45035699009895325, gen p mean: -0.24151647090911865, mean p set: 0.45092666149139404
loss_pred:0.015007107518613338, decouple_loss:0.0027044638991355896
The modified gen p mean: 0.4493328928947449, gen p mean: -0.24247552454471588, mean p set: 0.4499005675315857
loss_pred:0.015049145556986332, decouple_loss:0.0026476001366972923
Iteration: 1595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010969042778015, gen p mean: -0.2435556948184967, mean p set: 0.4506858289241791
loss_pred:0.014961304143071175, decouple_loss:0.0025945098605006933
The modified gen p mean: 0.45018085837364197, gen p mean: -0.23948293924331665, mean p set: 0.4507656991481781The modified gen p mean: 0.4491080641746521, gen p mean: -0.2459736466407776, mean p set: 0.4496326744556427
loss_pred:0.014976928010582924, decouple_loss:0.0027128804940730333
loss_pred:0.015115617774426937, decouple_loss:0.0026084634009748697
Iteration: 1596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483160674571991, gen p mean: -0.23812930285930634, mean p set: 0.44889214634895325
loss_pred:0.015191593207418919, decouple_loss:0.002567697549238801
The modified gen p mean: 0.4488746225833893, gen p mean: -0.24172665178775787, mean p set: 0.4494022727012634
The modified gen p mean: 0.44946473836898804, gen p mean: -0.24110554158687592, mean p set: 0.4500423073768616
loss_pred:0.015732625499367714, decouple_loss:0.0027111279778182507
loss_pred:0.015919551253318787, decouple_loss:0.0025285666342824697
Iteration: 1597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489007294178009, gen p mean: -0.25499188899993896, mean p set: 0.4494844079017639
loss_pred:0.015700707212090492, decouple_loss:0.002562029054388404
The modified gen p mean: 0.44949620962142944, gen p mean: -0.24611230194568634, mean p set: 0.45007139444351196The modified gen p mean: 0.44857874512672424, gen p mean: -0.2439037412405014, mean p set: 0.4491027593612671
loss_pred:0.015590180642902851, decouple_loss:0.0027020664419978857
loss_pred:0.015094983391463757, decouple_loss:0.0025038793683052063
Iteration: 1598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786307215690613, gen p mean: -0.2538217008113861, mean p set: 0.44843724370002747
loss_pred:0.01517574768513441, decouple_loss:0.0026526644360274076
The modified gen p mean: 0.4495965540409088, gen p mean: -0.2517300546169281, mean p set: 0.45017769932746887
loss_pred:0.014806156978011131, decouple_loss:0.002534994389861822
The modified gen p mean: 0.45006999373435974, gen p mean: -0.2500211298465729, mean p set: 0.4505973160266876
loss_pred:0.015089794062077999, decouple_loss:0.0027448793407529593
Iteration: 1599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45006731152534485, gen p mean: -0.24762481451034546, mean p set: 0.45064398646354675
loss_pred:0.01397794857621193, decouple_loss:0.002612037118524313
The modified gen p mean: 0.4474300444126129, gen p mean: -0.24665777385234833, mean p set: 0.448009192943573
loss_pred:0.0147181935608387, decouple_loss:0.0026164581067860126
The modified gen p mean: 0.4484056532382965, gen p mean: -0.24457402527332306, mean p set: 0.4489321708679199
loss_pred:0.014928269200026989, decouple_loss:0.0025943084619939327
Iteration: 1600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495601952075958, gen p mean: -0.24620376527309418, mean p set: 0.4501335322856903
loss_pred:0.014632788486778736, decouple_loss:0.0029128645546734333
The modified gen p mean: 0.44941797852516174, gen p mean: -0.24477048218250275, mean p set: 0.4499913156032562
loss_pred:0.0146243991330266, decouple_loss:0.002478574635460973
The modified gen p mean: 0.45001980662345886, gen p mean: -0.2457725703716278, mean p set: 0.4505492150783539
loss_pred:0.014508582651615143, decouple_loss:0.002539099659770727
2023-04-27 04:40:11 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2499421387910843, mean p set: 0.4499112665653229
loss_pred:0.016914082691073418, decouple_loss:0.002580374013632536
The modified gen p mean: 0.449294775724411, gen p mean: -0.24956099689006805, mean p set: 0.4498290419578552
loss_pred:0.016410844400525093, decouple_loss:0.0026827731635421515
The modified gen p mean: 0.4482232630252838, gen p mean: -0.24654430150985718, mean p set: 0.44879910349845886
loss_pred:0.016769250854849815, decouple_loss:0.002634319243952632
WV_1_PC_1_EH_0_PS_30, loss: 0.016829682514071465, avg_mse: 0.024869924411177635
current test mse: 0.02487
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 1601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44614535570144653, gen p mean: -0.25154444575309753, mean p set: 0.44667288661003113
loss_pred:0.015364800579845905, decouple_loss:0.0024878133554011583
The modified gen p mean: 0.44855549931526184, gen p mean: -0.2477644383907318, mean p set: 0.4491317868232727
loss_pred:0.015223135240375996, decouple_loss:0.0024593451526015997
The modified gen p mean: 0.44799163937568665, gen p mean: -0.24882785975933075, mean p set: 0.4485742151737213
loss_pred:0.015501179732382298, decouple_loss:0.002476663328707218
Iteration: 1602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757258892059326, gen p mean: -0.24556469917297363, mean p set: 0.4480930268764496
loss_pred:0.016046205535531044, decouple_loss:0.00303855468519032
The modified gen p mean: 0.4475666284561157, gen p mean: -0.25201448798179626, mean p set: 0.4481382668018341The modified gen p mean: 0.4465788006782532, gen p mean: -0.25094154477119446, mean p set: 0.44715774059295654
loss_pred:0.01538700982928276, decouple_loss:0.002601793734356761
loss_pred:0.015576576814055443, decouple_loss:0.002491026185452938
Iteration: 1603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858911633491516, gen p mean: -0.25184300541877747, mean p set: 0.449113667011261
loss_pred:0.015807580202817917, decouple_loss:0.0025910770054906607
The modified gen p mean: 0.4480196535587311, gen p mean: -0.2505182921886444, mean p set: 0.44860827922821045The modified gen p mean: 0.4478320777416229, gen p mean: -0.24934321641921997, mean p set: 0.44840726256370544
loss_pred:0.01515269000083208, decouple_loss:0.002674776827916503
loss_pred:0.01583569310605526, decouple_loss:0.0026923685800284147
Iteration: 1604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476788640022278, gen p mean: -0.24337585270404816, mean p set: 0.44820424914360046
loss_pred:0.015732817351818085, decouple_loss:0.0025951971765607595
The modified gen p mean: 0.44596731662750244, gen p mean: -0.2514199912548065, mean p set: 0.4465450048446655
The modified gen p mean: 0.44718635082244873, gen p mean: -0.2448645383119583, mean p set: 0.4477651119232178
loss_pred:0.015534702688455582, decouple_loss:0.0026910672895610332
loss_pred:0.015783071517944336, decouple_loss:0.0025726258754730225
Iteration: 1605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445758193731308, gen p mean: -0.24830645322799683, mean p set: 0.446336567401886
loss_pred:0.01527364831417799, decouple_loss:0.002659133169800043
The modified gen p mean: 0.4475318491458893, gen p mean: -0.250083327293396, mean p set: 0.44810402393341064
loss_pred:0.015266584232449532, decouple_loss:0.0028345673345029354
The modified gen p mean: 0.44828736782073975, gen p mean: -0.24544396996498108, mean p set: 0.4488171935081482
loss_pred:0.0152816791087389, decouple_loss:0.0026334102731198072
Iteration: 1606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472433626651764, gen p mean: -0.24800175428390503, mean p set: 0.44781988859176636
loss_pred:0.01624302938580513, decouple_loss:0.0028576126787811518
The modified gen p mean: 0.44801950454711914, gen p mean: -0.2473112791776657, mean p set: 0.4485970735549927
loss_pred:0.014828681014478207, decouple_loss:0.002901726169511676
The modified gen p mean: 0.4474262595176697, gen p mean: -0.24574479460716248, mean p set: 0.4479508101940155
loss_pred:0.015695327892899513, decouple_loss:0.0028618427459150553
Iteration: 1607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724637269973755, gen p mean: -0.24905775487422943, mean p set: 0.447822630405426
loss_pred:0.015322403982281685, decouple_loss:0.0023902663961052895
The modified gen p mean: 0.4472310245037079, gen p mean: -0.25089797377586365, mean p set: 0.44780153036117554
loss_pred:0.016319800168275833, decouple_loss:0.00252944091334939
The modified gen p mean: 0.4467121660709381, gen p mean: -0.24938230216503143, mean p set: 0.447241872549057
loss_pred:0.016065338626503944, decouple_loss:0.0026045190170407295
Iteration: 1608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633668661117554, gen p mean: -0.23967121541500092, mean p set: 0.4469052851200104
loss_pred:0.01532714068889618, decouple_loss:0.0027087603230029345
The modified gen p mean: 0.4474164545536041, gen p mean: -0.2413213700056076, mean p set: 0.44799429178237915
loss_pred:0.014899322763085365, decouple_loss:0.0025980535428971052
The modified gen p mean: 0.4477957785129547, gen p mean: -0.23845675587654114, mean p set: 0.44832247495651245
loss_pred:0.016172152012586594, decouple_loss:0.002817263826727867
Iteration: 1609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773510098457336, gen p mean: -0.2534269392490387, mean p set: 0.44830334186553955
loss_pred:0.01526862196624279, decouple_loss:0.002590023912489414
The modified gen p mean: 0.4476812481880188, gen p mean: -0.2493443489074707, mean p set: 0.4482541084289551
loss_pred:0.01582006923854351, decouple_loss:0.002631263341754675
The modified gen p mean: 0.4479005038738251, gen p mean: -0.24861428141593933, mean p set: 0.44843369722366333
loss_pred:0.015217852778732777, decouple_loss:0.0026531158946454525
Iteration: 1610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475978910923004, gen p mean: -0.24877937138080597, mean p set: 0.44817250967025757
loss_pred:0.015569500625133514, decouple_loss:0.0026058261282742023
The modified gen p mean: 0.4474887251853943, gen p mean: -0.24649278819561005, mean p set: 0.4480171501636505The modified gen p mean: 0.4480094313621521, gen p mean: -0.2492256462574005, mean p set: 0.44857946038246155
loss_pred:0.01492692343890667, decouple_loss:0.00250727660022676
loss_pred:0.01588142290711403, decouple_loss:0.002468146150931716
2023-04-27 04:44:12 testing...
The modified gen p mean: 0.44822317361831665, gen p mean: -0.2476232349872589, mean p set: 0.44879910349845886
loss_pred:0.016755465418100357, decouple_loss:0.002651933813467622
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25097426772117615, mean p set: 0.4499112665653229
loss_pred:0.016816802322864532, decouple_loss:0.0027229576371610165
The modified gen p mean: 0.4492998719215393, gen p mean: -0.25029319524765015, mean p set: 0.4498290419578552
loss_pred:0.016414927318692207, decouple_loss:0.002735904883593321
WV_1_PC_1_EH_0_PS_30, loss: 0.01679757796227932, avg_mse: 0.024793658405542374
current test mse: 0.024794
Iteration: 1611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459487497806549, gen p mean: -0.24722756445407867, mean p set: 0.44651728868484497
loss_pred:0.01551814191043377, decouple_loss:0.0026121879927814007
The modified gen p mean: 0.4462316334247589, gen p mean: -0.25375843048095703, mean p set: 0.4468037486076355
loss_pred:0.015724604949355125, decouple_loss:0.0027071828953921795
The modified gen p mean: 0.44679054617881775, gen p mean: -0.24965710937976837, mean p set: 0.4473235309123993
loss_pred:0.01538130547851324, decouple_loss:0.00244034081697464
Iteration: 1612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466037154197693, gen p mean: -0.2514948546886444, mean p set: 0.44713273644447327
loss_pred:0.015469581820070744, decouple_loss:0.0023538018576800823
The modified gen p mean: 0.44776803255081177, gen p mean: -0.2501281201839447, mean p set: 0.4483456313610077
loss_pred:0.015428174287080765, decouple_loss:0.002366679487749934
The modified gen p mean: 0.4470692276954651, gen p mean: -0.24612556397914886, mean p set: 0.44764673709869385
loss_pred:0.015866892412304878, decouple_loss:0.002449021441861987
Iteration: 1613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482263922691345, gen p mean: -0.2559801936149597, mean p set: 0.44875964522361755
loss_pred:0.015366926789283752, decouple_loss:0.0025349692441523075
The modified gen p mean: 0.4471551179885864, gen p mean: -0.25374943017959595, mean p set: 0.44773492217063904
loss_pred:0.015198680572211742, decouple_loss:0.0023769813124090433
The modified gen p mean: 0.44722166657447815, gen p mean: -0.2546332776546478, mean p set: 0.4477926790714264
loss_pred:0.015463637188076973, decouple_loss:0.0026023180689662695
Iteration: 1614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727906584739685, gen p mean: -0.2510620057582855, mean p set: 0.4478101134300232
loss_pred:0.015379618853330612, decouple_loss:0.002379932440817356
The modified gen p mean: 0.44790002703666687, gen p mean: -0.25036779046058655, mean p set: 0.4484725892543793
loss_pred:0.014972595497965813, decouple_loss:0.0023973025381565094
The modified gen p mean: 0.44809985160827637, gen p mean: -0.24734912812709808, mean p set: 0.4486773908138275
loss_pred:0.015147620812058449, decouple_loss:0.002496739849448204
Iteration: 1615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473540782928467, gen p mean: -0.24551285803318024, mean p set: 0.44792816042900085
loss_pred:0.01505932118743658, decouple_loss:0.002541463589295745
The modified gen p mean: 0.4472941756248474, gen p mean: -0.2541440725326538, mean p set: 0.44781628251075745The modified gen p mean: 0.44822826981544495, gen p mean: -0.2428199052810669, mean p set: 0.4487995207309723
loss_pred:0.015995852649211884, decouple_loss:0.0025302646681666374
loss_pred:0.015761129558086395, decouple_loss:0.0023741424083709717
Iteration: 1616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718366861343384, gen p mean: -0.2523719072341919, mean p set: 0.44775745272636414
loss_pred:0.015458982437849045, decouple_loss:0.0023789985571056604
The modified gen p mean: 0.44692131876945496, gen p mean: -0.24644282460212708, mean p set: 0.4474954903125763
The modified gen p mean: 0.44714194536209106, gen p mean: -0.2431558519601822, mean p set: 0.4476746618747711
loss_pred:0.015973074361681938, decouple_loss:0.002463440876454115
loss_pred:0.015523192472755909, decouple_loss:0.0026180746499449015
Iteration: 1617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477497935295105, gen p mean: -0.24799758195877075, mean p set: 0.44832614064216614
loss_pred:0.01448431983590126, decouple_loss:0.0025906874798238277
The modified gen p mean: 0.44664883613586426, gen p mean: -0.24701635539531708, mean p set: 0.447177916765213The modified gen p mean: 0.44776806235313416, gen p mean: -0.24656274914741516, mean p set: 0.44834527373313904
loss_pred:0.015897223725914955, decouple_loss:0.002481097122654319
loss_pred:0.015027389861643314, decouple_loss:0.0026244199834764004
Iteration: 1618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44616538286209106, gen p mean: -0.2509599030017853, mean p set: 0.4467467665672302
loss_pred:0.01523787621408701, decouple_loss:0.002466049510985613
The modified gen p mean: 0.447992205619812, gen p mean: -0.2493719905614853, mean p set: 0.44852498173713684The modified gen p mean: 0.44658374786376953, gen p mean: -0.25141435861587524, mean p set: 0.4471621811389923
loss_pred:0.01534773875027895, decouple_loss:0.0025361059233546257
loss_pred:0.01564708538353443, decouple_loss:0.0023507920559495687
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796109199523926, gen p mean: -0.25362125039100647, mean p set: 0.4485393166542053
loss_pred:0.014740390703082085, decouple_loss:0.002579046878963709
The modified gen p mean: 0.4480648934841156, gen p mean: -0.25551465153694153, mean p set: 0.4486377537250519
loss_pred:0.015491433441638947, decouple_loss:0.002674700692296028
The modified gen p mean: 0.4455333948135376, gen p mean: -0.2515159547328949, mean p set: 0.4460587203502655
loss_pred:0.01523300725966692, decouple_loss:0.0026177153922617435
Iteration: 1620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653406739234924, gen p mean: -0.2564501464366913, mean p set: 0.4471103250980377
loss_pred:0.015973340719938278, decouple_loss:0.002425708808004856
The modified gen p mean: 0.446649968624115, gen p mean: -0.2543298304080963, mean p set: 0.4471730887889862The modified gen p mean: 0.44753628969192505, gen p mean: -0.25928038358688354, mean p set: 0.44811320304870605
loss_pred:0.015180093236267567, decouple_loss:0.002512205159291625
loss_pred:0.01547437347471714, decouple_loss:0.0024311558809131384
2023-04-27 04:47:37 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25461411476135254, mean p set: 0.4499112665653229
loss_pred:0.016803525388240814, decouple_loss:0.002502291928976774
The modified gen p mean: 0.4493007957935333, gen p mean: -0.25381535291671753, mean p set: 0.4498290419578552
loss_pred:0.01640365645289421, decouple_loss:0.0024732453748583794
The modified gen p mean: 0.44822192192077637, gen p mean: -0.25173574686050415, mean p set: 0.44879910349845886
loss_pred:0.016839182004332542, decouple_loss:0.0024929873179644346
WV_1_PC_1_EH_0_PS_30, loss: 0.016806598752737045, avg_mse: 0.024809425696730614
current test mse: 0.024809
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 1621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478078782558441, gen p mean: -0.2501818537712097, mean p set: 0.4483359158039093
loss_pred:0.016048988327383995, decouple_loss:0.002424644073471427
The modified gen p mean: 0.4482164680957794, gen p mean: -0.25387057662010193, mean p set: 0.44878846406936646
loss_pred:0.015375548973679543, decouple_loss:0.0022724876180291176
The modified gen p mean: 0.44786348938941956, gen p mean: -0.2543785572052002, mean p set: 0.4484356641769409
loss_pred:0.016160454601049423, decouple_loss:0.0024126125499606133
Iteration: 1622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773468375205994, gen p mean: -0.25253841280937195, mean p set: 0.4482678174972534
loss_pred:0.016091670840978622, decouple_loss:0.0025114533491432667
The modified gen p mean: 0.4486891031265259, gen p mean: -0.2559390962123871, mean p set: 0.4492678940296173The modified gen p mean: 0.4480232298374176, gen p mean: -0.2533539831638336, mean p set: 0.4485968351364136
loss_pred:0.015527497977018356, decouple_loss:0.0025310192722827196
loss_pred:0.015653401613235474, decouple_loss:0.0024468929041177034
Iteration: 1623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698604941368103, gen p mean: -0.250864714384079, mean p set: 0.4475124180316925
loss_pred:0.01594725251197815, decouple_loss:0.0022706305608153343
The modified gen p mean: 0.44681861996650696, gen p mean: -0.2509312927722931, mean p set: 0.44740280508995056The modified gen p mean: 0.44743096828460693, gen p mean: -0.24746011197566986, mean p set: 0.44800689816474915
loss_pred:0.015694327652454376, decouple_loss:0.002465204568579793
loss_pred:0.015955457463860512, decouple_loss:0.002509294543415308
Iteration: 1624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44612064957618713, gen p mean: -0.24730388820171356, mean p set: 0.44664737582206726
loss_pred:0.01629960536956787, decouple_loss:0.002158861607313156
The modified gen p mean: 0.4480685293674469, gen p mean: -0.24414871633052826, mean p set: 0.44864311814308167
The modified gen p mean: 0.4481257498264313, gen p mean: -0.24295860528945923, mean p set: 0.44870471954345703
loss_pred:0.01583036221563816, decouple_loss:0.002173192799091339
loss_pred:0.016452543437480927, decouple_loss:0.0022872237022966146
Iteration: 1625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788339734077454, gen p mean: -0.24027416110038757, mean p set: 0.44845762848854065
loss_pred:0.015419538132846355, decouple_loss:0.0024749638978391886
The modified gen p mean: 0.44713908433914185, gen p mean: -0.24683348834514618, mean p set: 0.447712779045105
loss_pred:0.01585765928030014, decouple_loss:0.0025656467769294977
The modified gen p mean: 0.44791486859321594, gen p mean: -0.2396145761013031, mean p set: 0.4484493136405945
loss_pred:0.015548535622656345, decouple_loss:0.0024412241764366627
Iteration: 1626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691523909568787, gen p mean: -0.24211272597312927, mean p set: 0.44748347997665405
loss_pred:0.015705037862062454, decouple_loss:0.0023974336218088865
The modified gen p mean: 0.4481099247932434, gen p mean: -0.23822765052318573, mean p set: 0.4486865699291229
loss_pred:0.01590159721672535, decouple_loss:0.0023361435160040855
The modified gen p mean: 0.44870510697364807, gen p mean: -0.23908044397830963, mean p set: 0.4492388963699341
loss_pred:0.015780996531248093, decouple_loss:0.0021819265093654394
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853731989860535, gen p mean: -0.2380216270685196, mean p set: 0.44911372661590576
loss_pred:0.01572030410170555, decouple_loss:0.002489544916898012
The modified gen p mean: 0.44736823439598083, gen p mean: -0.23457418382167816, mean p set: 0.4479440450668335
loss_pred:0.016122939065098763, decouple_loss:0.002605219604447484
The modified gen p mean: 0.44819045066833496, gen p mean: -0.23832742869853973, mean p set: 0.44871973991394043
loss_pred:0.01598820835351944, decouple_loss:0.002463172422721982
Iteration: 1628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488165080547333, gen p mean: -0.23635494709014893, mean p set: 0.44938814640045166
loss_pred:0.016280168667435646, decouple_loss:0.0022640132810920477
The modified gen p mean: 0.44766050577163696, gen p mean: -0.2381269633769989, mean p set: 0.44823122024536133
loss_pred:0.01609170250594616, decouple_loss:0.0023014391772449017
The modified gen p mean: 0.4463232457637787, gen p mean: -0.24347148835659027, mean p set: 0.44685330986976624
loss_pred:0.01585761085152626, decouple_loss:0.002223680494353175
Iteration: 1629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705912470817566, gen p mean: -0.2371697872877121, mean p set: 0.4476318955421448
loss_pred:0.01640564203262329, decouple_loss:0.0025179197546094656
The modified gen p mean: 0.44772231578826904, gen p mean: -0.2387983500957489, mean p set: 0.4483031630516052
loss_pred:0.016331611201167107, decouple_loss:0.0023306286893785
The modified gen p mean: 0.4477865695953369, gen p mean: -0.24269598722457886, mean p set: 0.44831880927085876
loss_pred:0.016275249421596527, decouple_loss:0.00242034369148314
Iteration: 1630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776490330696106, gen p mean: -0.2468813806772232, mean p set: 0.4483374059200287
loss_pred:0.015550080686807632, decouple_loss:0.002513436833396554
The modified gen p mean: 0.4475231170654297, gen p mean: -0.24755097925662994, mean p set: 0.44810402393341064
loss_pred:0.01541799958795309, decouple_loss:0.0025137781631201506
The modified gen p mean: 0.44806820154190063, gen p mean: -0.2473868578672409, mean p set: 0.448603093624115
loss_pred:0.015931982547044754, decouple_loss:0.0023999675177037716
2023-04-27 04:51:41 testing...
The modified gen p mean: 0.44822269678115845, gen p mean: -0.2421528548002243, mean p set: 0.44879910349845886
loss_pred:0.016849366948008537, decouple_loss:0.002411258639767766
The modified gen p mean: 0.44930246472358704, gen p mean: -0.24426989257335663, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24544985592365265, mean p set: 0.4499112665653229loss_pred:0.016452692449092865, decouple_loss:0.0023657516576349735
loss_pred:0.01684061624109745, decouple_loss:0.0023753021378070116
WV_1_PC_1_EH_0_PS_30, loss: 0.016833432018756866, avg_mse: 0.024815253913402557
current test mse: 0.024815
Iteration: 1631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448745995759964, gen p mean: -0.24554210901260376, mean p set: 0.44927188754081726
loss_pred:0.015448092482984066, decouple_loss:0.002345532178878784
The modified gen p mean: 0.44781988859176636, gen p mean: -0.24342206120491028, mean p set: 0.44839873909950256
loss_pred:0.016169367358088493, decouple_loss:0.0022464534267783165
The modified gen p mean: 0.44878309965133667, gen p mean: -0.24557070434093475, mean p set: 0.44936102628707886
loss_pred:0.015212306752800941, decouple_loss:0.0023716511204838753
Iteration: 1632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732263684272766, gen p mean: -0.24846883118152618, mean p set: 0.4478394687175751
loss_pred:0.01611299254000187, decouple_loss:0.0022924761287868023
The modified gen p mean: 0.4473114609718323, gen p mean: -0.24201862514019012, mean p set: 0.4478871822357178
The modified gen p mean: 0.4473520517349243, gen p mean: -0.2474685162305832, mean p set: 0.4479339122772217
loss_pred:0.01657157391309738, decouple_loss:0.002281090011820197
loss_pred:0.016200536862015724, decouple_loss:0.002439718460664153
Iteration: 1633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776302576065063, gen p mean: -0.2512887716293335, mean p set: 0.4482938349246979
loss_pred:0.01554470881819725, decouple_loss:0.0022541487123817205
The modified gen p mean: 0.4479268491268158, gen p mean: -0.2494770884513855, mean p set: 0.4485013484954834
The modified gen p mean: 0.4480624794960022, gen p mean: -0.24822819232940674, mean p set: 0.44864511489868164
loss_pred:0.016002094373106956, decouple_loss:0.0022620325908064842
loss_pred:0.015591499395668507, decouple_loss:0.002287705894559622
Iteration: 1634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667375087738037, gen p mean: -0.2511858344078064, mean p set: 0.44724538922309875
loss_pred:0.01636343263089657, decouple_loss:0.002214615000411868
The modified gen p mean: 0.44819873571395874, gen p mean: -0.2475365698337555, mean p set: 0.44872552156448364The modified gen p mean: 0.44822749495506287, gen p mean: -0.25039082765579224, mean p set: 0.4488029479980469
loss_pred:0.015994727611541748, decouple_loss:0.002317100064828992
loss_pred:0.0156223364174366, decouple_loss:0.002375458599999547
Iteration: 1635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781431555747986, gen p mean: -0.25212371349334717, mean p set: 0.4483935534954071
loss_pred:0.015502171590924263, decouple_loss:0.002258875872939825
The modified gen p mean: 0.4483984410762787, gen p mean: -0.2475058138370514, mean p set: 0.4489271342754364The modified gen p mean: 0.4472324252128601, gen p mean: -0.24853406846523285, mean p set: 0.44781461358070374
loss_pred:0.01536005549132824, decouple_loss:0.0026340552140027285loss_pred:0.01623617857694626, decouple_loss:0.002233663573861122
Iteration: 1636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799450039863586, gen p mean: -0.24484722316265106, mean p set: 0.44857192039489746
loss_pred:0.01632617972791195, decouple_loss:0.0022360875736922026
The modified gen p mean: 0.4484342336654663, gen p mean: -0.2449747920036316, mean p set: 0.4490111172199249The modified gen p mean: 0.4479612410068512, gen p mean: -0.24478666484355927, mean p set: 0.44848933815956116
loss_pred:0.015440413728356361, decouple_loss:0.002275428269058466
loss_pred:0.01573922298848629, decouple_loss:0.0022623087279498577
Iteration: 1637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481199383735657, gen p mean: -0.24405771493911743, mean p set: 0.44869464635849
loss_pred:0.01579461805522442, decouple_loss:0.0024121711030602455
The modified gen p mean: 0.4479244649410248, gen p mean: -0.24508848786354065, mean p set: 0.44850432872772217
loss_pred:0.015506998635828495, decouple_loss:0.0028449553065001965
The modified gen p mean: 0.4473620653152466, gen p mean: -0.2437635362148285, mean p set: 0.447892427444458
loss_pred:0.01615198701620102, decouple_loss:0.0024684423115104437
Iteration: 1638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773179292678833, gen p mean: -0.24160149693489075, mean p set: 0.44831034541130066
loss_pred:0.01624269410967827, decouple_loss:0.0024146181531250477
The modified gen p mean: 0.447580486536026, gen p mean: -0.2456616461277008, mean p set: 0.4481017291545868The modified gen p mean: 0.44800928235054016, gen p mean: -0.2445090264081955, mean p set: 0.44858577847480774
loss_pred:0.015593865886330605, decouple_loss:0.0026060412637889385
loss_pred:0.015389839187264442, decouple_loss:0.0023866426199674606
Iteration: 1639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486296772956848, gen p mean: -0.24461227655410767, mean p set: 0.44920313358306885
loss_pred:0.015563770197331905, decouple_loss:0.0024283037055283785
The modified gen p mean: 0.4464660584926605, gen p mean: -0.24718734622001648, mean p set: 0.4470512866973877
loss_pred:0.015846820548176765, decouple_loss:0.0022943431977182627
The modified gen p mean: 0.4478112757205963, gen p mean: -0.24411024153232574, mean p set: 0.448335200548172
loss_pred:0.015569373965263367, decouple_loss:0.0023194188252091408
Iteration: 1640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771429896354675, gen p mean: -0.2442350536584854, mean p set: 0.44829073548316956
loss_pred:0.01619611866772175, decouple_loss:0.002281002700328827
The modified gen p mean: 0.44720375537872314, gen p mean: -0.24651648104190826, mean p set: 0.4477825164794922
loss_pred:0.016124796122312546, decouple_loss:0.0023908670991659164
The modified gen p mean: 0.44822654128074646, gen p mean: -0.24192728102207184, mean p set: 0.4487583637237549
loss_pred:0.015805494040250778, decouple_loss:0.002247424563392997
2023-04-27 04:55:05 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24476629495620728, mean p set: 0.4499112665653229
loss_pred:0.016839642077684402, decouple_loss:0.0024654599837958813
The modified gen p mean: 0.44929948449134827, gen p mean: -0.24405673146247864, mean p set: 0.4498290419578552
loss_pred:0.01644587703049183, decouple_loss:0.0024181376211345196
The modified gen p mean: 0.4482147693634033, gen p mean: -0.2416805624961853, mean p set: 0.44879910349845886
loss_pred:0.01682211086153984, decouple_loss:0.002406501676887274
WV_1_PC_1_EH_0_PS_30, loss: 0.016824044287204742, avg_mse: 0.02483842894434929
current test mse: 0.024838
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 1641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484119415283203, gen p mean: -0.24792851507663727, mean p set: 0.44894084334373474
loss_pred:0.014840012416243553, decouple_loss:0.0024532394018024206
The modified gen p mean: 0.44922134280204773, gen p mean: -0.23967435956001282, mean p set: 0.4497953951358795
loss_pred:0.015398126095533371, decouple_loss:0.002728227758780122
The modified gen p mean: 0.4480580687522888, gen p mean: -0.24709920585155487, mean p set: 0.4486351013183594
loss_pred:0.014865283854305744, decouple_loss:0.0026144669391214848
Iteration: 1642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473131000995636, gen p mean: -0.24130715429782867, mean p set: 0.44784268736839294
loss_pred:0.016154156997799873, decouple_loss:0.002804169896990061
The modified gen p mean: 0.44741126894950867, gen p mean: -0.2398761659860611, mean p set: 0.44798383116722107
The modified gen p mean: 0.44720739126205444, gen p mean: -0.24262312054634094, mean p set: 0.4477807283401489
loss_pred:0.016172261908650398, decouple_loss:0.002909221686422825
loss_pred:0.015771765261888504, decouple_loss:0.002779461443424225
Iteration: 1643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740766286849976, gen p mean: -0.24178370833396912, mean p set: 0.44793590903282166
loss_pred:0.01513768918812275, decouple_loss:0.0026850427966564894
The modified gen p mean: 0.4482826590538025, gen p mean: -0.245527982711792, mean p set: 0.4488556683063507
The modified gen p mean: 0.44863101840019226, gen p mean: -0.24688571691513062, mean p set: 0.44921019673347473
loss_pred:0.015601884573698044, decouple_loss:0.0026523242704570293
loss_pred:0.015174103900790215, decouple_loss:0.0025779027491807938
Iteration: 1644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707241654396057, gen p mean: -0.24369128048419952, mean p set: 0.44759488105773926
loss_pred:0.015480445697903633, decouple_loss:0.0024292911402881145
The modified gen p mean: 0.44867220520973206, gen p mean: -0.2460513710975647, mean p set: 0.4492571949958801
The modified gen p mean: 0.4471782445907593, gen p mean: -0.24271057546138763, mean p set: 0.4477514326572418
loss_pred:0.014581151306629181, decouple_loss:0.002743975492194295
loss_pred:0.016042286530137062, decouple_loss:0.002639318350702524
Iteration: 1645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785574078559875, gen p mean: -0.25665685534477234, mean p set: 0.44843214750289917
loss_pred:0.01480739377439022, decouple_loss:0.0026850933209061623
The modified gen p mean: 0.44752973318099976, gen p mean: -0.24996505677700043, mean p set: 0.4481014907360077The modified gen p mean: 0.4483330547809601, gen p mean: -0.24955761432647705, mean p set: 0.4488586187362671
loss_pred:0.014977225102484226, decouple_loss:0.0024897241964936256
loss_pred:0.014969118870794773, decouple_loss:0.0027021504938602448
Iteration: 1646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715428352355957, gen p mean: -0.25178617238998413, mean p set: 0.44773516058921814
loss_pred:0.015640320256352425, decouple_loss:0.002501914743334055
The modified gen p mean: 0.4483896493911743, gen p mean: -0.25587043166160583, mean p set: 0.4489099383354187The modified gen p mean: 0.44808265566825867, gen p mean: -0.25181248784065247, mean p set: 0.44865697622299194
loss_pred:0.015193813480436802, decouple_loss:0.002580861793830991
loss_pred:0.014559999108314514, decouple_loss:0.0024321922101080418
Iteration: 1647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447588711977005, gen p mean: -0.24600133299827576, mean p set: 0.44816192984580994
loss_pred:0.014319154433906078, decouple_loss:0.0025493416469544172
The modified gen p mean: 0.44806477427482605, gen p mean: -0.25223037600517273, mean p set: 0.4485870599746704
The modified gen p mean: 0.4473612606525421, gen p mean: -0.24982932209968567, mean p set: 0.4479329288005829
loss_pred:0.014494003728032112, decouple_loss:0.002705097198486328
loss_pred:0.014482861384749413, decouple_loss:0.002246081829071045
Iteration: 1648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475419521331787, gen p mean: -0.25005966424942017, mean p set: 0.44811877608299255
loss_pred:0.014813460409641266, decouple_loss:0.0024348481092602015
The modified gen p mean: 0.4478699862957001, gen p mean: -0.24444210529327393, mean p set: 0.4484385848045349
loss_pred:0.014608561061322689, decouple_loss:0.0025004518683999777
The modified gen p mean: 0.44704800844192505, gen p mean: -0.25210341811180115, mean p set: 0.4475710391998291
loss_pred:0.014517083764076233, decouple_loss:0.0023551820777356625
Iteration: 1649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474251866340637, gen p mean: -0.24716538190841675, mean p set: 0.4479990005493164
loss_pred:0.014631548896431923, decouple_loss:0.0025141355581581593
The modified gen p mean: 0.4482833445072174, gen p mean: -0.24295541644096375, mean p set: 0.4488582909107208
loss_pred:0.015328613109886646, decouple_loss:0.002335102530196309
The modified gen p mean: 0.44791504740715027, gen p mean: -0.25387459993362427, mean p set: 0.44844159483909607
loss_pred:0.014521188102662563, decouple_loss:0.0024314457550644875
Iteration: 1650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480472803115845, gen p mean: -0.2463291734457016, mean p set: 0.4486263692378998
loss_pred:0.015381633304059505, decouple_loss:0.0026299646124243736
The modified gen p mean: 0.44840386509895325, gen p mean: -0.2536594867706299, mean p set: 0.4489799737930298
loss_pred:0.015132221393287182, decouple_loss:0.0026864358223974705
The modified gen p mean: 0.4472668170928955, gen p mean: -0.24058769643306732, mean p set: 0.4477945566177368
loss_pred:0.015153522603213787, decouple_loss:0.002562697511166334
2023-04-27 04:59:04 testing...
The modified gen p mean: 0.44821998476982117, gen p mean: -0.2460535615682602, mean p set: 0.44879910349845886
loss_pred:0.016853345558047295, decouple_loss:0.0027621183544397354
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2492586374282837, mean p set: 0.4499112665653229
loss_pred:0.01703007146716118, decouple_loss:0.002922909799963236
The modified gen p mean: 0.44930562376976013, gen p mean: -0.2485131472349167, mean p set: 0.4498290419578552
loss_pred:0.016585297882556915, decouple_loss:0.002701610792428255
WV_1_PC_1_EH_0_PS_30, loss: 0.016962682828307152, avg_mse: 0.02503768727183342
current test mse: 0.025038
Iteration: 1651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471947252750397, gen p mean: -0.2520744502544403, mean p set: 0.44776979088783264
loss_pred:0.014690540730953217, decouple_loss:0.002672756789252162
The modified gen p mean: 0.44720080494880676, gen p mean: -0.24550873041152954, mean p set: 0.44777724146842957
loss_pred:0.015753163024783134, decouple_loss:0.002598481485620141
The modified gen p mean: 0.4468824565410614, gen p mean: -0.24833428859710693, mean p set: 0.4474125802516937
loss_pred:0.014795823022723198, decouple_loss:0.0024699971545487642
Iteration: 1652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477333426475525, gen p mean: -0.24778036773204803, mean p set: 0.44825834035873413
loss_pred:0.014936667867004871, decouple_loss:0.0024970497470349073
The modified gen p mean: 0.44767820835113525, gen p mean: -0.24712872505187988, mean p set: 0.4482528567314148
loss_pred:0.014196483418345451, decouple_loss:0.0024980236776173115
The modified gen p mean: 0.44829443097114563, gen p mean: -0.25649842619895935, mean p set: 0.4488692879676819
loss_pred:0.015320831909775734, decouple_loss:0.0023144762963056564
Iteration: 1653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479755759239197, gen p mean: -0.25219467282295227, mean p set: 0.4485073983669281
loss_pred:0.014732269570231438, decouple_loss:0.002606970025226474
The modified gen p mean: 0.448924720287323, gen p mean: -0.24448902904987335, mean p set: 0.4495067000389099
loss_pred:0.013919549994170666, decouple_loss:0.002595477504655719
The modified gen p mean: 0.4474635720252991, gen p mean: -0.2430044412612915, mean p set: 0.44803711771965027
loss_pred:0.015690110623836517, decouple_loss:0.0025520098861306906
Iteration: 1654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768157601356506, gen p mean: -0.25255826115608215, mean p set: 0.4482114315032959
loss_pred:0.014476434327661991, decouple_loss:0.0022242560517042875
The modified gen p mean: 0.44651317596435547, gen p mean: -0.2519506514072418, mean p set: 0.4470933675765991
loss_pred:0.01497337780892849, decouple_loss:0.002299561398103833
The modified gen p mean: 0.44896769523620605, gen p mean: -0.246236190199852, mean p set: 0.4495420455932617
loss_pred:0.014416409656405449, decouple_loss:0.002416866132989526
Iteration: 1655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481220543384552, gen p mean: -0.2512381970882416, mean p set: 0.4487045109272003
loss_pred:0.014740251004695892, decouple_loss:0.002425051759928465
The modified gen p mean: 0.44726163148880005, gen p mean: -0.24742533266544342, mean p set: 0.44784215092658997
The modified gen p mean: 0.4480253756046295, gen p mean: -0.24826312065124512, mean p set: 0.44856035709381104
loss_pred:0.014581234194338322, decouple_loss:0.0024648818653076887
loss_pred:0.01440333016216755, decouple_loss:0.0025166934356093407
Iteration: 1656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473748207092285, gen p mean: -0.2542892098426819, mean p set: 0.4479498863220215
loss_pred:0.014550916850566864, decouple_loss:0.0023130092304199934
The modified gen p mean: 0.4493376612663269, gen p mean: -0.2445744127035141, mean p set: 0.4498658776283264The modified gen p mean: 0.44803473353385925, gen p mean: -0.2582471966743469, mean p set: 0.44860297441482544
loss_pred:0.014568719081580639, decouple_loss:0.0022899811156094074
loss_pred:0.014994620345532894, decouple_loss:0.00233322917483747
Iteration: 1657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484090209007263, gen p mean: -0.2571953535079956, mean p set: 0.4489794969558716
loss_pred:0.015052691102027893, decouple_loss:0.0021908835042268038
The modified gen p mean: 0.4484202265739441, gen p mean: -0.2526342570781708, mean p set: 0.4489966928958893
loss_pred:0.015118174254894257, decouple_loss:0.0023435859475284815
The modified gen p mean: 0.44759228825569153, gen p mean: -0.25416842103004456, mean p set: 0.44812890887260437
loss_pred:0.01517935749143362, decouple_loss:0.0025749909691512585
Iteration: 1658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479358196258545, gen p mean: -0.2532372772693634, mean p set: 0.4485081434249878
loss_pred:0.015076303854584694, decouple_loss:0.002187937032431364
The modified gen p mean: 0.44855764508247375, gen p mean: -0.25622808933258057, mean p set: 0.449133038520813
loss_pred:0.01510115060955286, decouple_loss:0.0023477619979530573
The modified gen p mean: 0.44807466864585876, gen p mean: -0.2534411549568176, mean p set: 0.4486044645309448
loss_pred:0.01451581995934248, decouple_loss:0.0023413256276398897
Iteration: 1659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850441813468933, gen p mean: -0.25119397044181824, mean p set: 0.4490780532360077
loss_pred:0.014725759625434875, decouple_loss:0.002294255653396249
The modified gen p mean: 0.4482561945915222, gen p mean: -0.25535476207733154, mean p set: 0.4488280117511749
loss_pred:0.015151763334870338, decouple_loss:0.0021548604127019644
The modified gen p mean: 0.4471881687641144, gen p mean: -0.25004714727401733, mean p set: 0.44771671295166016
loss_pred:0.015386215411126614, decouple_loss:0.002202823990955949
Iteration: 1660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705820083618164, gen p mean: -0.24473965167999268, mean p set: 0.44763508439064026
loss_pred:0.014509118162095547, decouple_loss:0.002488554921001196
The modified gen p mean: 0.44822484254837036, gen p mean: -0.25219327211380005, mean p set: 0.4488038718700409
loss_pred:0.01443564984947443, decouple_loss:0.002295870566740632
The modified gen p mean: 0.44852641224861145, gen p mean: -0.2490236461162567, mean p set: 0.44905373454093933
loss_pred:0.015147292986512184, decouple_loss:0.002419082447886467
2023-04-27 05:02:29 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2491457611322403, mean p set: 0.4499112665653229
loss_pred:0.01700732856988907, decouple_loss:0.0024083764292299747
The modified gen p mean: 0.4492923319339752, gen p mean: -0.24839144945144653, mean p set: 0.4498290419578552
loss_pred:0.016555259004235268, decouple_loss:0.0024227683898061514
The modified gen p mean: 0.448217511177063, gen p mean: -0.24632064998149872, mean p set: 0.44879910349845886
loss_pred:0.016778109595179558, decouple_loss:0.00238118227571249
WV_1_PC_1_EH_0_PS_30, loss: 0.0169004388153553, avg_mse: 0.024951225146651268
current test mse: 0.024951
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 1661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448749840259552, gen p mean: -0.25217700004577637, mean p set: 0.44927704334259033
loss_pred:0.015755457803606987, decouple_loss:0.0026797230821102858
The modified gen p mean: 0.4475041329860687, gen p mean: -0.2530815899372101, mean p set: 0.448073148727417
loss_pred:0.015786146745085716, decouple_loss:0.002570528769865632
The modified gen p mean: 0.4460033178329468, gen p mean: -0.24428938329219818, mean p set: 0.4465752840042114
loss_pred:0.016000736504793167, decouple_loss:0.002594144782051444
Iteration: 1662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487919211387634, gen p mean: -0.25450071692466736, mean p set: 0.44931700825691223
loss_pred:0.015689712017774582, decouple_loss:0.0025797286070883274
The modified gen p mean: 0.446206271648407, gen p mean: -0.24971121549606323, mean p set: 0.4467838406562805
The modified gen p mean: 0.44611573219299316, gen p mean: -0.24935577809810638, mean p set: 0.44668781757354736
loss_pred:0.015396039932966232, decouple_loss:0.0026084226556122303
loss_pred:0.016408126801252365, decouple_loss:0.002794942818582058
Iteration: 1663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628357887268066, gen p mean: -0.25126317143440247, mean p set: 0.44680535793304443
loss_pred:0.015304637141525745, decouple_loss:0.0026347972452640533
The modified gen p mean: 0.4472562074661255, gen p mean: -0.2562706470489502, mean p set: 0.4478280544281006
The modified gen p mean: 0.4487602710723877, gen p mean: -0.2562228739261627, mean p set: 0.44933852553367615
loss_pred:0.015599153935909271, decouple_loss:0.002563295653089881
loss_pred:0.015989108011126518, decouple_loss:0.0029841596260666847
Iteration: 1664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457787573337555, gen p mean: -0.2528512477874756, mean p set: 0.44630563259124756
loss_pred:0.015234033577144146, decouple_loss:0.0022154063917696476
The modified gen p mean: 0.44667762517929077, gen p mean: -0.2551024258136749, mean p set: 0.44725558161735535
The modified gen p mean: 0.4489498436450958, gen p mean: -0.2584906220436096, mean p set: 0.44952791929244995
loss_pred:0.015617400407791138, decouple_loss:0.002256514271721244
loss_pred:0.015365582890808582, decouple_loss:0.002574311103671789
Iteration: 1665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605326652526855, gen p mean: -0.25277602672576904, mean p set: 0.4466271698474884
loss_pred:0.015451912768185139, decouple_loss:0.002700702752918005
The modified gen p mean: 0.4469917416572571, gen p mean: -0.25914815068244934, mean p set: 0.44752782583236694The modified gen p mean: 0.44515424966812134, gen p mean: -0.2629583477973938, mean p set: 0.44573795795440674
loss_pred:0.01577525958418846, decouple_loss:0.0027596154250204563loss_pred:0.01557878591120243, decouple_loss:0.002669193549081683
Iteration: 1666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467845559120178, gen p mean: -0.2597692310810089, mean p set: 0.4473665952682495
loss_pred:0.01567254774272442, decouple_loss:0.002535865642130375
The modified gen p mean: 0.44812214374542236, gen p mean: -0.2613634169101715, mean p set: 0.44865259528160095The modified gen p mean: 0.4481128752231598, gen p mean: -0.25917112827301025, mean p set: 0.44868341088294983
loss_pred:0.015628961846232414, decouple_loss:0.002749107778072357
loss_pred:0.0151493726298213, decouple_loss:0.0025771106593310833
Iteration: 1667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465945363044739, gen p mean: -0.2597874402999878, mean p set: 0.4471711814403534
loss_pred:0.015495004132390022, decouple_loss:0.002577981213107705
The modified gen p mean: 0.4455881714820862, gen p mean: -0.26179933547973633, mean p set: 0.4461652636528015
loss_pred:0.01602201536297798, decouple_loss:0.002464590361341834
The modified gen p mean: 0.44741159677505493, gen p mean: -0.26772600412368774, mean p set: 0.44794052839279175
loss_pred:0.0152545515447855, decouple_loss:0.002444871235638857
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44655388593673706, gen p mean: -0.25523337721824646, mean p set: 0.44712045788764954
loss_pred:0.01542202290147543, decouple_loss:0.0023629050701856613
The modified gen p mean: 0.44641759991645813, gen p mean: -0.25522908568382263, mean p set: 0.44694921374320984The modified gen p mean: 0.4466688930988312, gen p mean: -0.25306829810142517, mean p set: 0.447246253490448
loss_pred:0.01505962572991848, decouple_loss:0.0023677621502429247
loss_pred:0.015625469386577606, decouple_loss:0.002444940386340022
Iteration: 1669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484800398349762, gen p mean: -0.25727713108062744, mean p set: 0.4490543007850647
loss_pred:0.015893058851361275, decouple_loss:0.002599177183583379
The modified gen p mean: 0.44771525263786316, gen p mean: -0.25619110465049744, mean p set: 0.4482913017272949
loss_pred:0.015418089926242828, decouple_loss:0.002283836482092738
The modified gen p mean: 0.4473532438278198, gen p mean: -0.2509861886501312, mean p set: 0.44787678122520447
loss_pred:0.015783045440912247, decouple_loss:0.0024103913456201553
Iteration: 1670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44615283608436584, gen p mean: -0.25461557507514954, mean p set: 0.44673389196395874
loss_pred:0.01512569934129715, decouple_loss:0.002267480595037341
The modified gen p mean: 0.44663724303245544, gen p mean: -0.25754958391189575, mean p set: 0.44715940952301025The modified gen p mean: 0.4471125304698944, gen p mean: -0.25236234068870544, mean p set: 0.4476941227912903
loss_pred:0.01585874892771244, decouple_loss:0.00243449117988348
loss_pred:0.015911079943180084, decouple_loss:0.0022525640670210123
2023-04-27 05:06:29 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2519933879375458, mean p set: 0.4499112665653229
loss_pred:0.01684653013944626, decouple_loss:0.0022752690128982067
The modified gen p mean: 0.4493021070957184, gen p mean: -0.2517101764678955, mean p set: 0.4498290419578552
loss_pred:0.016398882493376732, decouple_loss:0.0023383821826428175
The modified gen p mean: 0.4482191801071167, gen p mean: -0.24915510416030884, mean p set: 0.44879910349845886
loss_pred:0.0167407114058733, decouple_loss:0.0022121374495327473
WV_1_PC_1_EH_0_PS_30, loss: 0.01677580550312996, avg_mse: 0.024776572361588478
current test mse: 0.024777
Iteration: 1671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463486671447754, gen p mean: -0.2533457577228546, mean p set: 0.4469289183616638
loss_pred:0.015464630909264088, decouple_loss:0.002594351302832365
The modified gen p mean: 0.44623151421546936, gen p mean: -0.2516689896583557, mean p set: 0.44675159454345703
loss_pred:0.015557252801954746, decouple_loss:0.0022248493041843176
The modified gen p mean: 0.44616463780403137, gen p mean: -0.2487274408340454, mean p set: 0.4467402696609497
loss_pred:0.01598958484828472, decouple_loss:0.00234213680960238
Iteration: 1672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479154944419861, gen p mean: -0.2554274797439575, mean p set: 0.4484470784664154
loss_pred:0.015515036880970001, decouple_loss:0.0023020198568701744
The modified gen p mean: 0.4457327127456665, gen p mean: -0.24823826551437378, mean p set: 0.44630685448646545
The modified gen p mean: 0.4474215805530548, gen p mean: -0.2597343325614929, mean p set: 0.44799599051475525
loss_pred:0.01584111526608467, decouple_loss:0.0025123143568634987
loss_pred:0.014887891709804535, decouple_loss:0.0024424756411463022
Iteration: 1673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466613829135895, gen p mean: -0.25651416182518005, mean p set: 0.4471926689147949
loss_pred:0.015603757463395596, decouple_loss:0.00252577755600214
The modified gen p mean: 0.44652408361434937, gen p mean: -0.26206907629966736, mean p set: 0.4471011161804199
The modified gen p mean: 0.44716429710388184, gen p mean: -0.2609500586986542, mean p set: 0.4477439522743225
loss_pred:0.016145450994372368, decouple_loss:0.0024885968305170536
loss_pred:0.015051063150167465, decouple_loss:0.0023567266762256622
Iteration: 1674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824695587158203, gen p mean: -0.25538188219070435, mean p set: 0.4487825632095337
loss_pred:0.015427840873599052, decouple_loss:0.002671249909326434
The modified gen p mean: 0.44735756516456604, gen p mean: -0.25639477372169495, mean p set: 0.4479255974292755
The modified gen p mean: 0.4459354281425476, gen p mean: -0.2525612413883209, mean p set: 0.44651132822036743
loss_pred:0.015660010278224945, decouple_loss:0.0024301207158714533
loss_pred:0.016209153458476067, decouple_loss:0.0023984378203749657
Iteration: 1675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44584164023399353, gen p mean: -0.25302356481552124, mean p set: 0.4464118480682373
loss_pred:0.01606466993689537, decouple_loss:0.0023589488118886948
The modified gen p mean: 0.4481280446052551, gen p mean: -0.25754380226135254, mean p set: 0.4486584961414337The modified gen p mean: 0.44677749276161194, gen p mean: -0.2538105845451355, mean p set: 0.4473566710948944
loss_pred:0.01528500858694315, decouple_loss:0.0023930715397000313
loss_pred:0.015073747374117374, decouple_loss:0.002400557743385434
Iteration: 1676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447905033826828, gen p mean: -0.25661134719848633, mean p set: 0.448486864566803
loss_pred:0.01567106321454048, decouple_loss:0.0024988646619021893
The modified gen p mean: 0.4456878900527954, gen p mean: -0.2539386749267578, mean p set: 0.44625577330589294
loss_pred:0.015496047213673592, decouple_loss:0.002365423832088709
The modified gen p mean: 0.44806602597236633, gen p mean: -0.2562732398509979, mean p set: 0.44858697056770325
loss_pred:0.015497121028602123, decouple_loss:0.002214194508269429
Iteration: 1677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463792145252228, gen p mean: -0.2537057399749756, mean p set: 0.44695523381233215
loss_pred:0.015202521346509457, decouple_loss:0.002494399668648839
The modified gen p mean: 0.44725120067596436, gen p mean: -0.2530515789985657, mean p set: 0.44782623648643494
loss_pred:0.015198822133243084, decouple_loss:0.0026487219147384167
The modified gen p mean: 0.44742268323898315, gen p mean: -0.25801682472229004, mean p set: 0.447951078414917
loss_pred:0.015145215205848217, decouple_loss:0.0023777110036462545
Iteration: 1678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682547450065613, gen p mean: -0.2588358223438263, mean p set: 0.4473998546600342
loss_pred:0.015049527399241924, decouple_loss:0.002314942190423608
The modified gen p mean: 0.44850966334342957, gen p mean: -0.25966590642929077, mean p set: 0.44907623529434204
loss_pred:0.015980497002601624, decouple_loss:0.0027638282626867294
The modified gen p mean: 0.44636812806129456, gen p mean: -0.2588590383529663, mean p set: 0.44689324498176575
loss_pred:0.015958158299326897, decouple_loss:0.0025687897577881813
Iteration: 1679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750675559043884, gen p mean: -0.26091933250427246, mean p set: 0.44808098673820496
loss_pred:0.015838399529457092, decouple_loss:0.0021886914037168026
The modified gen p mean: 0.4452461898326874, gen p mean: -0.2668207287788391, mean p set: 0.4457697868347168The modified gen p mean: 0.4470055401325226, gen p mean: -0.25759509205818176, mean p set: 0.44758522510528564
loss_pred:0.015878336504101753, decouple_loss:0.0022677858360111713
loss_pred:0.015599704347550869, decouple_loss:0.002408826258033514
Iteration: 1680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723111391067505, gen p mean: -0.27300015091896057, mean p set: 0.4478095471858978
loss_pred:0.01536518894135952, decouple_loss:0.0026207061018794775
The modified gen p mean: 0.4458965063095093, gen p mean: -0.2588996887207031, mean p set: 0.44647401571273804
loss_pred:0.015635915100574493, decouple_loss:0.0029203605372458696
The modified gen p mean: 0.4467772841453552, gen p mean: -0.2696616053581238, mean p set: 0.4473038911819458
loss_pred:0.015326003544032574, decouple_loss:0.002589344047009945
2023-04-27 05:09:53 testing...
The modified gen p mean: 0.448223739862442, gen p mean: -0.26213255524635315, mean p set: 0.44879910349845886
loss_pred:0.016664983704686165, decouple_loss:0.0022753924131393433
The modified gen p mean: 0.4494309425354004, gen p mean: -0.264690101146698, mean p set: 0.4499112665653229
loss_pred:0.016830284148454666, decouple_loss:0.0024125040508806705
The modified gen p mean: 0.44929638504981995, gen p mean: -0.2647860646247864, mean p set: 0.4498290419578552
loss_pred:0.01636454463005066, decouple_loss:0.002288851886987686
WV_1_PC_1_EH_0_PS_30, loss: 0.016736216843128204, avg_mse: 0.024732645601034164
current test mse: 0.024733
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 1681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706839323043823, gen p mean: -0.26773160696029663, mean p set: 0.44759440422058105
loss_pred:0.015009679831564426, decouple_loss:0.0023231422528624535
The modified gen p mean: 0.4475000202655792, gen p mean: -0.26573997735977173, mean p set: 0.448081910610199
The modified gen p mean: 0.44714298844337463, gen p mean: -0.26333293318748474, mean p set: 0.4477090537548065
loss_pred:0.015642857179045677, decouple_loss:0.0022215223871171474
loss_pred:0.014911534264683723, decouple_loss:0.0023876104969531298
Iteration: 1682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808298349380493, gen p mean: -0.2637747526168823, mean p set: 0.44860947132110596
loss_pred:0.014942561276257038, decouple_loss:0.0028942630160599947
The modified gen p mean: 0.4465731084346771, gen p mean: -0.2582069933414459, mean p set: 0.4471501410007477
The modified gen p mean: 0.44839778542518616, gen p mean: -0.2607533931732178, mean p set: 0.44896969199180603
loss_pred:0.015397710725665092, decouple_loss:0.0029141800478100777
loss_pred:0.015166264958679676, decouple_loss:0.002923240652307868
Iteration: 1683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474799931049347, gen p mean: -0.26198410987854004, mean p set: 0.44800394773483276
loss_pred:0.01531052403151989, decouple_loss:0.0024146316573023796
The modified gen p mean: 0.4479164481163025, gen p mean: -0.25922566652297974, mean p set: 0.448486864566803
The modified gen p mean: 0.4479893147945404, gen p mean: -0.26319020986557007, mean p set: 0.4485662877559662
loss_pred:0.014857154339551926, decouple_loss:0.0026002004742622375
loss_pred:0.014979759231209755, decouple_loss:0.002359285717830062
Iteration: 1684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470798075199127, gen p mean: -0.25448712706565857, mean p set: 0.4476620554924011
loss_pred:0.015311694703996181, decouple_loss:0.0033885787706822157
The modified gen p mean: 0.44778016209602356, gen p mean: -0.2575010061264038, mean p set: 0.44830334186553955The modified gen p mean: 0.44772765040397644, gen p mean: -0.2612321674823761, mean p set: 0.448304146528244
loss_pred:0.01551042590290308, decouple_loss:0.003185418201610446
loss_pred:0.014937888830900192, decouple_loss:0.003292711917310953
Iteration: 1685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725194573402405, gen p mean: -0.2546212375164032, mean p set: 0.4478378891944885
loss_pred:0.014725672081112862, decouple_loss:0.002385948318988085
The modified gen p mean: 0.4480767846107483, gen p mean: -0.25539037585258484, mean p set: 0.4486064314842224The modified gen p mean: 0.4488455653190613, gen p mean: -0.25528469681739807, mean p set: 0.44941452145576477
loss_pred:0.014641348272562027, decouple_loss:0.002635331591591239
loss_pred:0.015012117102742195, decouple_loss:0.0028081180062144995
Iteration: 1686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474324882030487, gen p mean: -0.25036659836769104, mean p set: 0.44800183176994324
loss_pred:0.015164298005402088, decouple_loss:0.0032424621749669313
The modified gen p mean: 0.44816893339157104, gen p mean: -0.2565716505050659, mean p set: 0.4487426280975342
loss_pred:0.015518562868237495, decouple_loss:0.003280396107584238
The modified gen p mean: 0.4484424293041229, gen p mean: -0.24902452528476715, mean p set: 0.44897186756134033
loss_pred:0.014756296761333942, decouple_loss:0.0033892442006617785
Iteration: 1687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476843774318695, gen p mean: -0.24614247679710388, mean p set: 0.4482576549053192
loss_pred:0.015177527442574501, decouple_loss:0.0028544554952532053
The modified gen p mean: 0.4476120173931122, gen p mean: -0.24826039373874664, mean p set: 0.4481918513774872
loss_pred:0.01482157688587904, decouple_loss:0.002866806462407112
The modified gen p mean: 0.4468088448047638, gen p mean: -0.25337502360343933, mean p set: 0.4473388195037842
loss_pred:0.014873784966766834, decouple_loss:0.002948518143966794
Iteration: 1688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471239745616913, gen p mean: -0.25288182497024536, mean p set: 0.4477013349533081
loss_pred:0.015478573739528656, decouple_loss:0.0035418623592704535
The modified gen p mean: 0.4471813142299652, gen p mean: -0.2502051889896393, mean p set: 0.4477039873600006The modified gen p mean: 0.4479561746120453, gen p mean: -0.2534582018852234, mean p set: 0.44853144884109497
loss_pred:0.014928544871509075, decouple_loss:0.0034910801332443953
loss_pred:0.014394225552678108, decouple_loss:0.003270244924351573
Iteration: 1689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713059067726135, gen p mean: -0.24674047529697418, mean p set: 0.44770386815071106
loss_pred:0.015119356103241444, decouple_loss:0.0027072574011981487
The modified gen p mean: 0.44773736596107483, gen p mean: -0.2464383840560913, mean p set: 0.44830429553985596
loss_pred:0.014629820361733437, decouple_loss:0.0027295993641018867
The modified gen p mean: 0.4486182630062103, gen p mean: -0.24878937005996704, mean p set: 0.4491487443447113
loss_pred:0.014517740346491337, decouple_loss:0.0033385956194251776
Iteration: 1690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468000829219818, gen p mean: -0.2526368498802185, mean p set: 0.44737890362739563
loss_pred:0.015197026543319225, decouple_loss:0.002741033211350441
The modified gen p mean: 0.4470791518688202, gen p mean: -0.25298094749450684, mean p set: 0.4476523995399475
loss_pred:0.015412745997309685, decouple_loss:0.003098112065345049
The modified gen p mean: 0.44912031292915344, gen p mean: -0.24503692984580994, mean p set: 0.44966015219688416
loss_pred:0.014427931979298592, decouple_loss:0.003341711824759841
2023-04-27 05:13:56 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2517530024051666, mean p set: 0.4499112665653229
loss_pred:0.016975805163383484, decouple_loss:0.002761272480711341
The modified gen p mean: 0.4493024945259094, gen p mean: -0.2515823245048523, mean p set: 0.4498290419578552
loss_pred:0.016454851254820824, decouple_loss:0.0026637674309313297
The modified gen p mean: 0.448224276304245, gen p mean: -0.24918940663337708, mean p set: 0.44879910349845886
loss_pred:0.016953827813267708, decouple_loss:0.0026001324877142906
WV_1_PC_1_EH_0_PS_30, loss: 0.01692858152091503, avg_mse: 0.024994535371661186
current test mse: 0.024995
Iteration: 1691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464748501777649, gen p mean: -0.2509010434150696, mean p set: 0.4470519721508026
loss_pred:0.015121525153517723, decouple_loss:0.0026108722668141127
The modified gen p mean: 0.4479503333568573, gen p mean: -0.25061655044555664, mean p set: 0.4485197067260742
loss_pred:0.014707479625940323, decouple_loss:0.002811847720295191
The modified gen p mean: 0.4464045464992523, gen p mean: -0.2534545063972473, mean p set: 0.4469318985939026
loss_pred:0.015847595408558846, decouple_loss:0.002624224405735731
Iteration: 1692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880411028862, gen p mean: -0.25222739577293396, mean p set: 0.449325829744339
loss_pred:0.0139541607350111, decouple_loss:0.0034054452553391457
The modified gen p mean: 0.4486764371395111, gen p mean: -0.25399038195610046, mean p set: 0.44924864172935486
The modified gen p mean: 0.4473832845687866, gen p mean: -0.252847820520401, mean p set: 0.44794946908950806
loss_pred:0.01419974397867918, decouple_loss:0.003774117911234498
loss_pred:0.014825965277850628, decouple_loss:0.0037586409598588943
Iteration: 1693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470958113670349, gen p mean: -0.2528788149356842, mean p set: 0.44762441515922546
loss_pred:0.014804841950535774, decouple_loss:0.002826646203175187
The modified gen p mean: 0.44725391268730164, gen p mean: -0.2592238485813141, mean p set: 0.44783034920692444The modified gen p mean: 0.44743287563323975, gen p mean: -0.25641658902168274, mean p set: 0.4479982852935791
loss_pred:0.0151255764067173, decouple_loss:0.0028393729589879513
loss_pred:0.014492896385490894, decouple_loss:0.0023780404590070248
Iteration: 1694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481502175331116, gen p mean: -0.2537015974521637, mean p set: 0.44869139790534973
loss_pred:0.014627679251134396, decouple_loss:0.0034200181253254414
The modified gen p mean: 0.44822990894317627, gen p mean: -0.2606004476547241, mean p set: 0.44880568981170654The modified gen p mean: 0.4476626217365265, gen p mean: -0.2577420473098755, mean p set: 0.4482389986515045
loss_pred:0.014770615845918655, decouple_loss:0.0032070809975266457
loss_pred:0.014801980927586555, decouple_loss:0.003323153592646122
Iteration: 1695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680219888687134, gen p mean: -0.2519935965538025, mean p set: 0.4473787844181061
loss_pred:0.01515631377696991, decouple_loss:0.002623578067868948
The modified gen p mean: 0.4484884440898895, gen p mean: -0.2553635835647583, mean p set: 0.4490576982498169
loss_pred:0.014274146407842636, decouple_loss:0.0023623881861567497
The modified gen p mean: 0.4479125440120697, gen p mean: -0.2583273649215698, mean p set: 0.448443204164505
loss_pred:0.01473864633589983, decouple_loss:0.002371683716773987
Iteration: 1696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466349482536316, gen p mean: -0.2571943700313568, mean p set: 0.4472118318080902
loss_pred:0.014997310005128384, decouple_loss:0.003073318162932992
The modified gen p mean: 0.446844220161438, gen p mean: -0.2546541392803192, mean p set: 0.447422593832016
loss_pred:0.015158364549279213, decouple_loss:0.0032077766954898834
The modified gen p mean: 0.44786643981933594, gen p mean: -0.26057422161102295, mean p set: 0.4483886957168579
loss_pred:0.015028165653347969, decouple_loss:0.0032453180756419897
Iteration: 1697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690316915512085, gen p mean: -0.25646260380744934, mean p set: 0.4474763870239258
loss_pred:0.015259400941431522, decouple_loss:0.0024261598009616137
The modified gen p mean: 0.44809049367904663, gen p mean: -0.2544628381729126, mean p set: 0.44866064190864563
loss_pred:0.015085906721651554, decouple_loss:0.0024404043797403574
The modified gen p mean: 0.4483526051044464, gen p mean: -0.25311514735221863, mean p set: 0.44888588786125183
loss_pred:0.0146308783441782, decouple_loss:0.0024798796512186527
Iteration: 1698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465501606464386, gen p mean: -0.2593655288219452, mean p set: 0.4471273422241211
loss_pred:0.015564448200166225, decouple_loss:0.002523640636354685
The modified gen p mean: 0.4471105635166168, gen p mean: -0.25578683614730835, mean p set: 0.44768473505973816
loss_pred:0.015046290121972561, decouple_loss:0.0027432648930698633
The modified gen p mean: 0.4473617374897003, gen p mean: -0.25646504759788513, mean p set: 0.44789108633995056
loss_pred:0.015623435378074646, decouple_loss:0.0028494372963905334
Iteration: 1699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470595419406891, gen p mean: -0.2528723478317261, mean p set: 0.4476398825645447
loss_pred:0.015153573825955391, decouple_loss:0.0023596156388521194
The modified gen p mean: 0.447013258934021, gen p mean: -0.2550826370716095, mean p set: 0.44758692383766174
loss_pred:0.01575404964387417, decouple_loss:0.0024487883783876896
The modified gen p mean: 0.4472256004810333, gen p mean: -0.24764809012413025, mean p set: 0.4477570950984955
loss_pred:0.014988402836024761, decouple_loss:0.002376515418291092
Iteration: 1700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802847504615784, gen p mean: -0.25007006525993347, mean p set: 0.4486024081707001
loss_pred:0.014841356314718723, decouple_loss:0.0023841948714107275
The modified gen p mean: 0.44753989577293396, gen p mean: -0.25285106897354126, mean p set: 0.4481172263622284
loss_pred:0.015420012176036835, decouple_loss:0.00241242628544569
The modified gen p mean: 0.4483795762062073, gen p mean: -0.24927012622356415, mean p set: 0.448910653591156
loss_pred:0.014300545677542686, decouple_loss:0.0024313689209520817
2023-04-27 05:17:20 testing...
The modified gen p mean: 0.44822460412979126, gen p mean: -0.2508927285671234, mean p set: 0.44879910349845886
loss_pred:0.01693900302052498, decouple_loss:0.00252384040504694
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25305595993995667, mean p set: 0.4499112665653229
loss_pred:0.017039140686392784, decouple_loss:0.0025500336196273565
The modified gen p mean: 0.4493010938167572, gen p mean: -0.25300362706184387, mean p set: 0.4498290419578552
loss_pred:0.016454443335533142, decouple_loss:0.0026125232689082623
WV_1_PC_1_EH_0_PS_30, loss: 0.016938969492912292, avg_mse: 0.025031395256519318
current test mse: 0.025031
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 1701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749417901039124, gen p mean: -0.25309401750564575, mean p set: 0.44802215695381165
loss_pred:0.015395374037325382, decouple_loss:0.002620456274598837
The modified gen p mean: 0.44624507427215576, gen p mean: -0.25602594017982483, mean p set: 0.4468306601047516
loss_pred:0.014806942082941532, decouple_loss:0.003222372615709901
The modified gen p mean: 0.4467444121837616, gen p mean: -0.25765758752822876, mean p set: 0.4473138451576233
loss_pred:0.016071056947112083, decouple_loss:0.0031708579044789076
Iteration: 1702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728007912635803, gen p mean: -0.25974515080451965, mean p set: 0.4478125274181366
loss_pred:0.015244007110595703, decouple_loss:0.002345931949093938
The modified gen p mean: 0.44797560572624207, gen p mean: -0.2611265182495117, mean p set: 0.4485515058040619
loss_pred:0.01624436117708683, decouple_loss:0.002217639237642288
The modified gen p mean: 0.4481319189071655, gen p mean: -0.2547510862350464, mean p set: 0.4487118422985077
loss_pred:0.015163248404860497, decouple_loss:0.002382949460297823
Iteration: 1703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648200273513794, gen p mean: -0.2617170810699463, mean p set: 0.4470071494579315
loss_pred:0.01534305326640606, decouple_loss:0.002421540440991521
The modified gen p mean: 0.4472014009952545, gen p mean: -0.25975480675697327, mean p set: 0.4477818012237549
loss_pred:0.015390179120004177, decouple_loss:0.0026125330477952957
The modified gen p mean: 0.4476991593837738, gen p mean: -0.25738826394081116, mean p set: 0.44827502965927124
loss_pred:0.015613419935107231, decouple_loss:0.0026906956918537617
Iteration: 1704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703787565231323, gen p mean: -0.2617524564266205, mean p set: 0.44756636023521423
loss_pred:0.015375190414488316, decouple_loss:0.0025711427442729473
The modified gen p mean: 0.4483060836791992, gen p mean: -0.2566527724266052, mean p set: 0.44888749718666077
loss_pred:0.015030941925942898, decouple_loss:0.002337290672585368
The modified gen p mean: 0.44633880257606506, gen p mean: -0.2589614987373352, mean p set: 0.44691428542137146
loss_pred:0.015874402597546577, decouple_loss:0.002745059784501791
Iteration: 1705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475906789302826, gen p mean: -0.25190743803977966, mean p set: 0.4481656849384308
loss_pred:0.015820754691958427, decouple_loss:0.0022822567261755466
The modified gen p mean: 0.4471263587474823, gen p mean: -0.2533571124076843, mean p set: 0.4477040469646454The modified gen p mean: 0.4473344385623932, gen p mean: -0.24821032583713531, mean p set: 0.4478640854358673
loss_pred:0.015416048467159271, decouple_loss:0.002306068316102028
loss_pred:0.014751412905752659, decouple_loss:0.002343992004171014
Iteration: 1706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477931559085846, gen p mean: -0.25072163343429565, mean p set: 0.44837021827697754
loss_pred:0.015522880479693413, decouple_loss:0.002172446344047785
The modified gen p mean: 0.4473995864391327, gen p mean: -0.2500627040863037, mean p set: 0.44797828793525696The modified gen p mean: 0.44669991731643677, gen p mean: -0.25260499119758606, mean p set: 0.44724181294441223
loss_pred:0.015751603990793228, decouple_loss:0.0021965736523270607
loss_pred:0.01509962510317564, decouple_loss:0.002265463350340724
Iteration: 1707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722962379455566, gen p mean: -0.25573670864105225, mean p set: 0.4478060305118561
loss_pred:0.015604209154844284, decouple_loss:0.002278229920193553
The modified gen p mean: 0.44719794392585754, gen p mean: -0.2532353401184082, mean p set: 0.447729229927063The modified gen p mean: 0.44789430499076843, gen p mean: -0.24989594519138336, mean p set: 0.4484681785106659
loss_pred:0.015709182247519493, decouple_loss:0.0022682847920805216
loss_pred:0.01546270027756691, decouple_loss:0.0024169920943677425
Iteration: 1708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448100209236145, gen p mean: -0.2575792372226715, mean p set: 0.4486749470233917
loss_pred:0.01567819155752659, decouple_loss:0.0022975096944719553
The modified gen p mean: 0.4475625157356262, gen p mean: -0.2514885663986206, mean p set: 0.44809025526046753The modified gen p mean: 0.4484858512878418, gen p mean: -0.24988827109336853, mean p set: 0.4490656852722168
loss_pred:0.01525852084159851, decouple_loss:0.0021854371298104525
loss_pred:0.01546345092356205, decouple_loss:0.0022176806814968586
Iteration: 1709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474656283855438, gen p mean: -0.2490393966436386, mean p set: 0.44803258776664734
loss_pred:0.015309520997107029, decouple_loss:0.002597607672214508
The modified gen p mean: 0.44603970646858215, gen p mean: -0.2550888657569885, mean p set: 0.4466179311275482
loss_pred:0.015487194061279297, decouple_loss:0.0024585863575339317
The modified gen p mean: 0.4474438726902008, gen p mean: -0.25719693303108215, mean p set: 0.44797375798225403
loss_pred:0.016526123508810997, decouple_loss:0.002263197908177972
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470890164375305, gen p mean: -0.2543841302394867, mean p set: 0.44765913486480713
loss_pred:0.015542102977633476, decouple_loss:0.0021674372255802155
The modified gen p mean: 0.44662004709243774, gen p mean: -0.256100594997406, mean p set: 0.44719401001930237
loss_pred:0.016089102253317833, decouple_loss:0.0024126311764121056
The modified gen p mean: 0.44589656591415405, gen p mean: -0.25970929861068726, mean p set: 0.44642776250839233
loss_pred:0.015399743802845478, decouple_loss:0.0027070899959653616
2023-04-27 05:21:24 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2560301721096039, mean p set: 0.4499112665653229
loss_pred:0.01697859913110733, decouple_loss:0.0025668854359537363
The modified gen p mean: 0.44930487871170044, gen p mean: -0.2563747465610504, mean p set: 0.4498290419578552
loss_pred:0.016417063772678375, decouple_loss:0.0024064427707344294
The modified gen p mean: 0.4482189118862152, gen p mean: -0.25392743945121765, mean p set: 0.44879910349845886
loss_pred:0.01686061918735504, decouple_loss:0.002447600243613124
WV_1_PC_1_EH_0_PS_30, loss: 0.016875775530934334, avg_mse: 0.024885710328817368
current test mse: 0.024886
Iteration: 1711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721806049346924, gen p mean: -0.2560531795024872, mean p set: 0.44779056310653687
loss_pred:0.015052380971610546, decouple_loss:0.002388902008533478
The modified gen p mean: 0.44762322306632996, gen p mean: -0.26193368434906006, mean p set: 0.44820475578308105
loss_pred:0.016010595485568047, decouple_loss:0.002357766032218933
The modified gen p mean: 0.4483198821544647, gen p mean: -0.25755366683006287, mean p set: 0.44884711503982544
loss_pred:0.016132744029164314, decouple_loss:0.0022687911987304688
Iteration: 1712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465532898902893, gen p mean: -0.2549094557762146, mean p set: 0.4470813572406769
loss_pred:0.015258120372891426, decouple_loss:0.0025647024158388376
The modified gen p mean: 0.44781357049942017, gen p mean: -0.25338056683540344, mean p set: 0.44838324189186096The modified gen p mean: 0.4482834041118622, gen p mean: -0.26087766885757446, mean p set: 0.4488631784915924
loss_pred:0.015565118752419949, decouple_loss:0.0027457554824650288
loss_pred:0.015245651826262474, decouple_loss:0.0023624093737453222
Iteration: 1713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789421558380127, gen p mean: -0.2512408196926117, mean p set: 0.44841933250427246
loss_pred:0.016151312738656998, decouple_loss:0.002512156032025814
The modified gen p mean: 0.4479926526546478, gen p mean: -0.25040334463119507, mean p set: 0.4485728442668915The modified gen p mean: 0.4475531280040741, gen p mean: -0.2531903088092804, mean p set: 0.44812464714050293
loss_pred:0.015541276894509792, decouple_loss:0.0025053999852389097
loss_pred:0.015540828928351402, decouple_loss:0.0023788895923644304
Iteration: 1714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480465054512024, gen p mean: -0.2445046305656433, mean p set: 0.4485739767551422
loss_pred:0.015081033110618591, decouple_loss:0.002491086721420288
The modified gen p mean: 0.44762280583381653, gen p mean: -0.24562278389930725, mean p set: 0.4481956660747528The modified gen p mean: 0.44806188344955444, gen p mean: -0.246372789144516, mean p set: 0.4486413896083832
loss_pred:0.01568666286766529, decouple_loss:0.00263190153054893
loss_pred:0.014933907426893711, decouple_loss:0.002592814154922962
Iteration: 1715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763413071632385, gen p mean: -0.24051500856876373, mean p set: 0.4482135772705078
loss_pred:0.015568748116493225, decouple_loss:0.002381428610533476
The modified gen p mean: 0.44715631008148193, gen p mean: -0.23946014046669006, mean p set: 0.4477352201938629
loss_pred:0.015871629118919373, decouple_loss:0.002330641495063901
The modified gen p mean: 0.44756725430488586, gen p mean: -0.2341976910829544, mean p set: 0.44809815287590027
loss_pred:0.014736399985849857, decouple_loss:0.002607368864119053
Iteration: 1716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477084279060364, gen p mean: -0.23276612162590027, mean p set: 0.4482816159725189
loss_pred:0.015723738819360733, decouple_loss:0.0026965984143316746
The modified gen p mean: 0.4474247395992279, gen p mean: -0.239688441157341, mean p set: 0.4480046033859253
loss_pred:0.015035153366625309, decouple_loss:0.0024702835362404585
The modified gen p mean: 0.44842806458473206, gen p mean: -0.23348945379257202, mean p set: 0.448952317237854
loss_pred:0.015122824348509312, decouple_loss:0.002692041452974081
Iteration: 1717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458073377609253, gen p mean: -0.24273298680782318, mean p set: 0.44638389348983765
loss_pred:0.014490137808024883, decouple_loss:0.0025463313795626163
The modified gen p mean: 0.44758766889572144, gen p mean: -0.23919950425624847, mean p set: 0.44816744327545166
loss_pred:0.015659082680940628, decouple_loss:0.0022633690387010574
The modified gen p mean: 0.44732117652893066, gen p mean: -0.23870006203651428, mean p set: 0.44784313440322876
loss_pred:0.015849623829126358, decouple_loss:0.0024293786846101284
Iteration: 1718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784000515937805, gen p mean: -0.2417992204427719, mean p set: 0.4484192430973053
loss_pred:0.016066815704107285, decouple_loss:0.002772070001810789
The modified gen p mean: 0.4461706280708313, gen p mean: -0.24526554346084595, mean p set: 0.4467509686946869
loss_pred:0.015798889100551605, decouple_loss:0.002822466194629669
The modified gen p mean: 0.44609004259109497, gen p mean: -0.2425675392150879, mean p set: 0.44661951065063477
loss_pred:0.015572990290820599, decouple_loss:0.0024807604495435953
Iteration: 1719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667619466781616, gen p mean: -0.2441728562116623, mean p set: 0.44725507497787476
loss_pred:0.01526927575469017, decouple_loss:0.0025533188600093126
The modified gen p mean: 0.44594281911849976, gen p mean: -0.24655096232891083, mean p set: 0.4465283155441284
loss_pred:0.01585712470114231, decouple_loss:0.002358013531193137
The modified gen p mean: 0.4469367563724518, gen p mean: -0.2471117526292801, mean p set: 0.44746458530426025
loss_pred:0.015358892269432545, decouple_loss:0.0022185167763382196
Iteration: 1720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657498598098755, gen p mean: -0.24540318548679352, mean p set: 0.44709837436676025
loss_pred:0.016139011830091476, decouple_loss:0.002837534761056304
The modified gen p mean: 0.44737279415130615, gen p mean: -0.244585782289505, mean p set: 0.4479471743106842The modified gen p mean: 0.44701504707336426, gen p mean: -0.24327145516872406, mean p set: 0.44759562611579895
loss_pred:0.015762997791171074, decouple_loss:0.0024677952751517296
loss_pred:0.01507492084056139, decouple_loss:0.0024188742972910404
2023-04-27 05:24:48 testing...
The modified gen p mean: 0.4482261538505554, gen p mean: -0.24167218804359436, mean p set: 0.44879910349845886
loss_pred:0.016809483990073204, decouple_loss:0.0023641411680728197
The modified gen p mean: 0.4493084251880646, gen p mean: -0.24416504800319672, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2441560924053192, mean p set: 0.4499112665653229
loss_pred:0.016365766525268555, decouple_loss:0.0026430534198880196
loss_pred:0.016880862414836884, decouple_loss:0.002624073065817356
WV_1_PC_1_EH_0_PS_30, loss: 0.016812559217214584, avg_mse: 0.02485489659011364
current test mse: 0.024855
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 1721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468344748020172, gen p mean: -0.24298253655433655, mean p set: 0.44736772775650024
loss_pred:0.015653332695364952, decouple_loss:0.002509396057575941
The modified gen p mean: 0.4467402994632721, gen p mean: -0.2422768920660019, mean p set: 0.4473150670528412
The modified gen p mean: 0.44710296392440796, gen p mean: -0.24839124083518982, mean p set: 0.44767752289772034
loss_pred:0.01617378368973732, decouple_loss:0.002754894318059087
loss_pred:0.015585352666676044, decouple_loss:0.0024963372852653265
Iteration: 1722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484976828098297, gen p mean: -0.2448968142271042, mean p set: 0.44902777671813965
loss_pred:0.015538627281785011, decouple_loss:0.0024475387763231993
The modified gen p mean: 0.44613608717918396, gen p mean: -0.2518696188926697, mean p set: 0.44671642780303955
The modified gen p mean: 0.4475126564502716, gen p mean: -0.2469089776277542, mean p set: 0.448087215423584
loss_pred:0.015816770493984222, decouple_loss:0.002314105164259672
loss_pred:0.015643302351236343, decouple_loss:0.002465100260451436
Iteration: 1723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467620551586151, gen p mean: -0.24845382571220398, mean p set: 0.4472885727882385
loss_pred:0.016735520213842392, decouple_loss:0.0025306004099547863
The modified gen p mean: 0.44899922609329224, gen p mean: -0.25219908356666565, mean p set: 0.44957879185676575
The modified gen p mean: 0.4482980966567993, gen p mean: -0.24864216148853302, mean p set: 0.44887441396713257
loss_pred:0.015187717042863369, decouple_loss:0.002470515202730894
loss_pred:0.015574295073747635, decouple_loss:0.0024022297002375126
Iteration: 1724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475025236606598, gen p mean: -0.24629753828048706, mean p set: 0.44808489084243774
loss_pred:0.01554426085203886, decouple_loss:0.0022635888308286667
The modified gen p mean: 0.4477967917919159, gen p mean: -0.2423447072505951, mean p set: 0.44832706451416016The modified gen p mean: 0.4473332464694977, gen p mean: -0.24243709444999695, mean p set: 0.4479130506515503
loss_pred:0.015964236110448837, decouple_loss:0.00251003191806376
loss_pred:0.015422061085700989, decouple_loss:0.0024591023102402687
Iteration: 1725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477318525314331, gen p mean: -0.24056898057460785, mean p set: 0.4482978880405426
loss_pred:0.015815405175089836, decouple_loss:0.002398964250460267
The modified gen p mean: 0.44763413071632385, gen p mean: -0.23985309898853302, mean p set: 0.44821611046791077
loss_pred:0.015913130715489388, decouple_loss:0.0023423940874636173
The modified gen p mean: 0.4470917582511902, gen p mean: -0.24766162037849426, mean p set: 0.44761988520622253
loss_pred:0.01570013538002968, decouple_loss:0.00243776710703969
Iteration: 1726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475158452987671, gen p mean: -0.24401864409446716, mean p set: 0.4480946362018585
loss_pred:0.01569385640323162, decouple_loss:0.0021267773117870092
The modified gen p mean: 0.44544458389282227, gen p mean: -0.2424890547990799, mean p set: 0.445966511964798The modified gen p mean: 0.44769033789634705, gen p mean: -0.2394540011882782, mean p set: 0.44826194643974304
loss_pred:0.015801625326275826, decouple_loss:0.002195321721956134
loss_pred:0.015867913141846657, decouple_loss:0.0022396971471607685
Iteration: 1727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727078080177307, gen p mean: -0.24106641113758087, mean p set: 0.44784191250801086
loss_pred:0.015573184005916119, decouple_loss:0.0023724124766886234
The modified gen p mean: 0.44933241605758667, gen p mean: -0.23757560551166534, mean p set: 0.4499136209487915
loss_pred:0.015940945595502853, decouple_loss:0.002569659147411585
The modified gen p mean: 0.4486541748046875, gen p mean: -0.2423851042985916, mean p set: 0.449184387922287
loss_pred:0.015274315141141415, decouple_loss:0.002459593117237091
Iteration: 1728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718435406684875, gen p mean: -0.24226784706115723, mean p set: 0.44775715470314026
loss_pred:0.015609849244356155, decouple_loss:0.002294449834153056
The modified gen p mean: 0.44683560729026794, gen p mean: -0.2469480335712433, mean p set: 0.44740915298461914The modified gen p mean: 0.4461033344268799, gen p mean: -0.24537593126296997, mean p set: 0.4466274678707123
loss_pred:0.01595480553805828, decouple_loss:0.002265731804072857
loss_pred:0.015920674428343773, decouple_loss:0.002469447208568454
Iteration: 1729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449214369058609, gen p mean: -0.24705208837985992, mean p set: 0.449787974357605
loss_pred:0.015237553045153618, decouple_loss:0.0025049345567822456
The modified gen p mean: 0.44549161195755005, gen p mean: -0.2509205937385559, mean p set: 0.44606801867485046
loss_pred:0.015875278040766716, decouple_loss:0.0023948010057210922
The modified gen p mean: 0.44734424352645874, gen p mean: -0.25127819180488586, mean p set: 0.4478735327720642
loss_pred:0.01574762538075447, decouple_loss:0.0023594116792082787
Iteration: 1730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477497935295105, gen p mean: -0.24655932188034058, mean p set: 0.4483223557472229
loss_pred:0.015172570012509823, decouple_loss:0.0025404670741409063
The modified gen p mean: 0.44633036851882935, gen p mean: -0.2531968653202057, mean p set: 0.4469049572944641
loss_pred:0.015710974112153053, decouple_loss:0.002488166792318225
The modified gen p mean: 0.44693082571029663, gen p mean: -0.2542394995689392, mean p set: 0.44745954871177673
loss_pred:0.01565796509385109, decouple_loss:0.002524332609027624
2023-04-27 05:28:53 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25251153111457825, mean p set: 0.4499112665653229
loss_pred:0.01704946719110012, decouple_loss:0.0025188231375068426
The modified gen p mean: 0.4492916166782379, gen p mean: -0.25223153829574585, mean p set: 0.4498290419578552
loss_pred:0.016459692269563675, decouple_loss:0.002465604804456234
The modified gen p mean: 0.4482252597808838, gen p mean: -0.24983064830303192, mean p set: 0.44879910349845886
loss_pred:0.016785476356744766, decouple_loss:0.0026000707875937223
WV_1_PC_1_EH_0_PS_30, loss: 0.01689128577709198, avg_mse: 0.02493605576455593
current test mse: 0.024936
Iteration: 1731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44599515199661255, gen p mean: -0.2549099624156952, mean p set: 0.44656795263290405
loss_pred:0.01576378382742405, decouple_loss:0.002490091836079955
The modified gen p mean: 0.44798219203948975, gen p mean: -0.24984906613826752, mean p set: 0.4485120475292206
loss_pred:0.016340970993041992, decouple_loss:0.002552390331402421
The modified gen p mean: 0.44743821024894714, gen p mean: -0.2569374740123749, mean p set: 0.44801008701324463
loss_pred:0.015437752939760685, decouple_loss:0.0023132041096687317
Iteration: 1732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469303488731384, gen p mean: -0.2538779079914093, mean p set: 0.4474617540836334
loss_pred:0.015947768464684486, decouple_loss:0.002312582451850176
The modified gen p mean: 0.44670379161834717, gen p mean: -0.2567313611507416, mean p set: 0.44727712869644165
The modified gen p mean: 0.4474383294582367, gen p mean: -0.24712488055229187, mean p set: 0.44801437854766846
loss_pred:0.015142051503062248, decouple_loss:0.002178020542487502
loss_pred:0.015378152020275593, decouple_loss:0.002276769606396556
Iteration: 1733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831517338752747, gen p mean: -0.259454607963562, mean p set: 0.4488462209701538
loss_pred:0.015533560886979103, decouple_loss:0.0021800438407808542
The modified gen p mean: 0.4473954439163208, gen p mean: -0.25478196144104004, mean p set: 0.4479758143424988
The modified gen p mean: 0.4492935538291931, gen p mean: -0.253511518239975, mean p set: 0.449869304895401
loss_pred:0.014882761985063553, decouple_loss:0.0021959012374281883
loss_pred:0.015539457090198994, decouple_loss:0.002348261419683695
Iteration: 1734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846752285957336, gen p mean: -0.2582920789718628, mean p set: 0.44900041818618774
loss_pred:0.014980029314756393, decouple_loss:0.0024185290094465017
The modified gen p mean: 0.4469834566116333, gen p mean: -0.25933507084846497, mean p set: 0.447562575340271
The modified gen p mean: 0.44605115056037903, gen p mean: -0.2611463963985443, mean p set: 0.4466353952884674
loss_pred:0.015664247795939445, decouple_loss:0.0023918880615383387
loss_pred:0.015387616120278835, decouple_loss:0.0023648401256650686
Iteration: 1735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475773274898529, gen p mean: -0.258929580450058, mean p set: 0.4481530487537384
loss_pred:0.015247256495058537, decouple_loss:0.002229781122878194
The modified gen p mean: 0.4470656216144562, gen p mean: -0.2558225691318512, mean p set: 0.447646826505661The modified gen p mean: 0.4484669864177704, gen p mean: -0.2583237588405609, mean p set: 0.4489942789077759
loss_pred:0.01554062869399786, decouple_loss:0.0023788234684616327
loss_pred:0.015307780355215073, decouple_loss:0.0022283766884356737
Iteration: 1736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722452759742737, gen p mean: -0.25710299611091614, mean p set: 0.44780421257019043
loss_pred:0.015065683051943779, decouple_loss:0.0023226856719702482
The modified gen p mean: 0.44723281264305115, gen p mean: -0.2576361894607544, mean p set: 0.4477689266204834The modified gen p mean: 0.44652244448661804, gen p mean: -0.26519110798835754, mean p set: 0.44709834456443787
loss_pred:0.015374950133264065, decouple_loss:0.0024757205974310637
loss_pred:0.015648726373910904, decouple_loss:0.0023309194948524237
Iteration: 1737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718867540359497, gen p mean: -0.26800620555877686, mean p set: 0.44775891304016113
loss_pred:0.015969596803188324, decouple_loss:0.002942412393167615
The modified gen p mean: 0.44797131419181824, gen p mean: -0.2666168808937073, mean p set: 0.4484986364841461The modified gen p mean: 0.44811779260635376, gen p mean: -0.2668799161911011, mean p set: 0.44869065284729004
loss_pred:0.01535822357982397, decouple_loss:0.0023954203352332115
loss_pred:0.01541766244918108, decouple_loss:0.0026426478289067745
Iteration: 1738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460645914077759, gen p mean: -0.2681199312210083, mean p set: 0.4466356933116913
loss_pred:0.015324248932301998, decouple_loss:0.0023120928090065718
The modified gen p mean: 0.4470258057117462, gen p mean: -0.2670691907405853, mean p set: 0.4476076066493988
loss_pred:0.015382478944957256, decouple_loss:0.0023092806804925203
The modified gen p mean: 0.4477408230304718, gen p mean: -0.26235052943229675, mean p set: 0.44827497005462646
loss_pred:0.014899351634085178, decouple_loss:0.0023037802893668413
Iteration: 1739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793593883514404, gen p mean: -0.263093501329422, mean p set: 0.44851356744766235
loss_pred:0.01563161425292492, decouple_loss:0.002575452672317624
The modified gen p mean: 0.44821587204933167, gen p mean: -0.2605268061161041, mean p set: 0.4487912356853485
loss_pred:0.01570846699178219, decouple_loss:0.002461920725181699
The modified gen p mean: 0.44875380396842957, gen p mean: -0.2581125795841217, mean p set: 0.4492754638195038
loss_pred:0.015579668805003166, decouple_loss:0.0026236940175294876
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497334063053131, gen p mean: -0.2595352828502655, mean p set: 0.45031026005744934
loss_pred:0.01546862069517374, decouple_loss:0.0023775314912199974
The modified gen p mean: 0.4485665261745453, gen p mean: -0.2588045299053192, mean p set: 0.44909462332725525The modified gen p mean: 0.44822680950164795, gen p mean: -0.2634608745574951, mean p set: 0.4488007128238678
loss_pred:0.015309812501072884, decouple_loss:0.0022863030899316072
loss_pred:0.015351756475865841, decouple_loss:0.0023639292921870947
2023-04-27 05:32:18 testing...
The modified gen p mean: 0.448219358921051, gen p mean: -0.2524229884147644, mean p set: 0.44879910349845886
loss_pred:0.016763366758823395, decouple_loss:0.0023521289695054293
The modified gen p mean: 0.4492989480495453, gen p mean: -0.2550840377807617, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2552529275417328, mean p set: 0.4499112665653229loss_pred:0.016418518498539925, decouple_loss:0.0022544781677424908
loss_pred:0.01699884422123432, decouple_loss:0.0022984936367720366
WV_1_PC_1_EH_0_PS_30, loss: 0.01684199646115303, avg_mse: 0.024813588708639145
current test mse: 0.024814
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 1741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474896192550659, gen p mean: -0.25440770387649536, mean p set: 0.44802039861679077
loss_pred:0.01505262404680252, decouple_loss:0.0024166926741600037
The modified gen p mean: 0.44846707582473755, gen p mean: -0.2550983130931854, mean p set: 0.44904205203056335
The modified gen p mean: 0.4474940299987793, gen p mean: -0.2567248046398163, mean p set: 0.44806867837905884
loss_pred:0.015115359798073769, decouple_loss:0.002499824855476618
loss_pred:0.01527259312570095, decouple_loss:0.0024682111106812954
Iteration: 1742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472140669822693, gen p mean: -0.2507961690425873, mean p set: 0.4477456510066986
loss_pred:0.015638327226042747, decouple_loss:0.0026148606557399035
The modified gen p mean: 0.4464891254901886, gen p mean: -0.24990634620189667, mean p set: 0.44706112146377563
The modified gen p mean: 0.4486375153064728, gen p mean: -0.24537408351898193, mean p set: 0.4492107927799225
loss_pred:0.015600921586155891, decouple_loss:0.002597422804683447
loss_pred:0.015726182609796524, decouple_loss:0.003097148612141609
Iteration: 1743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472135901451111, gen p mean: -0.25197046995162964, mean p set: 0.4477413594722748
loss_pred:0.015383835881948471, decouple_loss:0.0025107632391154766
The modified gen p mean: 0.4477761387825012, gen p mean: -0.2511613965034485, mean p set: 0.4483511745929718
The modified gen p mean: 0.4470219612121582, gen p mean: -0.24749624729156494, mean p set: 0.44760891795158386
loss_pred:0.01531006395816803, decouple_loss:0.0025910886470228434
loss_pred:0.015893427655100822, decouple_loss:0.002581372857093811
Iteration: 1744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746750593185425, gen p mean: -0.2526085376739502, mean p set: 0.4480433166027069
loss_pred:0.014607448130846024, decouple_loss:0.0027965116314589977
The modified gen p mean: 0.44690296053886414, gen p mean: -0.25622841715812683, mean p set: 0.44742754101753235The modified gen p mean: 0.44696882367134094, gen p mean: -0.2535850405693054, mean p set: 0.44754406809806824
loss_pred:0.01479406002908945, decouple_loss:0.0028378062415868044
loss_pred:0.015190184116363525, decouple_loss:0.0027714278548955917
Iteration: 1745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482821226119995, gen p mean: -0.24867543578147888, mean p set: 0.4488621652126312
loss_pred:0.01583748497068882, decouple_loss:0.0025988512206822634
The modified gen p mean: 0.44775596261024475, gen p mean: -0.25440454483032227, mean p set: 0.44828295707702637The modified gen p mean: 0.4470430016517639, gen p mean: -0.2526123821735382, mean p set: 0.4476131498813629
loss_pred:0.015723831951618195, decouple_loss:0.0026524881832301617
loss_pred:0.01455596461892128, decouple_loss:0.002723447512835264
Iteration: 1746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765400886535645, gen p mean: -0.2538228929042816, mean p set: 0.4482249617576599
loss_pred:0.014948705211281776, decouple_loss:0.002394170267507434
The modified gen p mean: 0.44735029339790344, gen p mean: -0.25111135840415955, mean p set: 0.44792893528938293
loss_pred:0.01567148044705391, decouple_loss:0.002354148542508483
The modified gen p mean: 0.44879671931266785, gen p mean: -0.2512871325016022, mean p set: 0.4493274986743927
loss_pred:0.01531167607754469, decouple_loss:0.0025884693022817373
Iteration: 1747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670915603637695, gen p mean: -0.2508179545402527, mean p set: 0.4472944438457489
loss_pred:0.015172027982771397, decouple_loss:0.002751997672021389
The modified gen p mean: 0.4473382234573364, gen p mean: -0.25338178873062134, mean p set: 0.4478645324707031The modified gen p mean: 0.4474490284919739, gen p mean: -0.24970056116580963, mean p set: 0.4480248689651489
loss_pred:0.014907489530742168, decouple_loss:0.0023703589104115963
loss_pred:0.014797074720263481, decouple_loss:0.0026494956109672785
Iteration: 1748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778919219970703, gen p mean: -0.2462887018918991, mean p set: 0.4483618438243866
loss_pred:0.014965114183723927, decouple_loss:0.002442785305902362
The modified gen p mean: 0.4476581811904907, gen p mean: -0.25007206201553345, mean p set: 0.4482308626174927The modified gen p mean: 0.4476211667060852, gen p mean: -0.25072383880615234, mean p set: 0.44814959168434143
loss_pred:0.015451530925929546, decouple_loss:0.0025101175997406244
loss_pred:0.014859432354569435, decouple_loss:0.0024296457413583994
Iteration: 1749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471750259399414, gen p mean: -0.24884051084518433, mean p set: 0.4477475583553314
loss_pred:0.014705481007695198, decouple_loss:0.002833570586517453
The modified gen p mean: 0.4477097690105438, gen p mean: -0.2526993751525879, mean p set: 0.4482399523258209The modified gen p mean: 0.44603171944618225, gen p mean: -0.24681344628334045, mean p set: 0.44660380482673645
loss_pred:0.01553361862897873, decouple_loss:0.002594734774902463
loss_pred:0.015525753609836102, decouple_loss:0.002915286226198077
Iteration: 1750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476386606693268, gen p mean: -0.2506280243396759, mean p set: 0.44821682572364807
loss_pred:0.015399412252008915, decouple_loss:0.002457044553011656
The modified gen p mean: 0.4472748935222626, gen p mean: -0.249407097697258, mean p set: 0.44785353541374207
loss_pred:0.015183410607278347, decouple_loss:0.0023920517414808273
The modified gen p mean: 0.4476117193698883, gen p mean: -0.25255754590034485, mean p set: 0.4481387734413147
loss_pred:0.015125817619264126, decouple_loss:0.0025385969784110785
2023-04-27 05:36:26 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25170961022377014, mean p set: 0.4499112665653229
loss_pred:0.01719016395509243, decouple_loss:0.002878692466765642
The modified gen p mean: 0.448223739862442, gen p mean: -0.24843959510326385, mean p set: 0.44879910349845886
loss_pred:0.01691809855401516, decouple_loss:0.003065600525587797
The modified gen p mean: 0.4493025243282318, gen p mean: -0.25153669714927673, mean p set: 0.4498290419578552
loss_pred:0.01663580909371376, decouple_loss:0.002697977004572749
WV_1_PC_1_EH_0_PS_30, loss: 0.017058728262782097, avg_mse: 0.02516741119325161
current test mse: 0.025167
Iteration: 1751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724172353744507, gen p mean: -0.2507449984550476, mean p set: 0.4478210508823395
loss_pred:0.015457995235919952, decouple_loss:0.0027791454922407866
The modified gen p mean: 0.44763192534446716, gen p mean: -0.25092393159866333, mean p set: 0.4482089579105377
loss_pred:0.015307947993278503, decouple_loss:0.002837555715814233
The modified gen p mean: 0.44817712903022766, gen p mean: -0.24876348674297333, mean p set: 0.44870179891586304
loss_pred:0.015520413406193256, decouple_loss:0.002940753009170294
Iteration: 1752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812527298927307, gen p mean: -0.2473956048488617, mean p set: 0.4486466944217682
loss_pred:0.015193168073892593, decouple_loss:0.0023448034189641476
The modified gen p mean: 0.4471435248851776, gen p mean: -0.2515762150287628, mean p set: 0.44771865010261536
loss_pred:0.014574089087545872, decouple_loss:0.002643914893269539
The modified gen p mean: 0.4476653039455414, gen p mean: -0.2509680986404419, mean p set: 0.44823944568634033
loss_pred:0.01525534875690937, decouple_loss:0.0025059508625417948
Iteration: 1753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469219148159027, gen p mean: -0.2524893879890442, mean p set: 0.44745007157325745
loss_pred:0.014616595581173897, decouple_loss:0.0032822631765156984
The modified gen p mean: 0.4489251971244812, gen p mean: -0.25043442845344543, mean p set: 0.4494889974594116
loss_pred:0.014569968916475773, decouple_loss:0.0031851117964833975
The modified gen p mean: 0.44751352071762085, gen p mean: -0.2529541850090027, mean p set: 0.4480917155742645
loss_pred:0.015604211017489433, decouple_loss:0.0032324744388461113
Iteration: 1754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472961127758026, gen p mean: -0.2517816126346588, mean p set: 0.4478244483470917
loss_pred:0.015350786969065666, decouple_loss:0.0026076138019561768
The modified gen p mean: 0.448219895362854, gen p mean: -0.25218307971954346, mean p set: 0.44879069924354553
loss_pred:0.014493436552584171, decouple_loss:0.0025198443327099085
The modified gen p mean: 0.4467409551143646, gen p mean: -0.246346116065979, mean p set: 0.44731831550598145
loss_pred:0.015402776189148426, decouple_loss:0.0026912351604551077
Iteration: 1755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482405185699463, gen p mean: -0.24769966304302216, mean p set: 0.4488186836242676
loss_pred:0.015170427039265633, decouple_loss:0.002899498213082552
The modified gen p mean: 0.4480333626270294, gen p mean: -0.2513686716556549, mean p set: 0.44855615496635437The modified gen p mean: 0.448209673166275, gen p mean: -0.2516419291496277, mean p set: 0.44877755641937256
loss_pred:0.015510128811001778, decouple_loss:0.0026926284190267324
loss_pred:0.0150448651984334, decouple_loss:0.002678636461496353
Iteration: 1756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743314385414124, gen p mean: -0.2539108395576477, mean p set: 0.4480080008506775
loss_pred:0.015447045676410198, decouple_loss:0.0032185555901378393
The modified gen p mean: 0.4482373893260956, gen p mean: -0.25106102228164673, mean p set: 0.4487678110599518The modified gen p mean: 0.4477090835571289, gen p mean: -0.2515239715576172, mean p set: 0.4482864737510681
loss_pred:0.015052842907607555, decouple_loss:0.0030174546409398317
loss_pred:0.01480918750166893, decouple_loss:0.002846991643309593
Iteration: 1757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726279377937317, gen p mean: -0.2499992400407791, mean p set: 0.4478406012058258
loss_pred:0.015421551652252674, decouple_loss:0.002640519291162491
The modified gen p mean: 0.4466073215007782, gen p mean: -0.24854499101638794, mean p set: 0.4471800923347473
loss_pred:0.01563669741153717, decouple_loss:0.002370223868638277
The modified gen p mean: 0.4473743736743927, gen p mean: -0.2491731196641922, mean p set: 0.4479069411754608
loss_pred:0.015521908178925514, decouple_loss:0.0023747922386974096
Iteration: 1758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735202193260193, gen p mean: -0.2512865662574768, mean p set: 0.4479289650917053
loss_pred:0.01550296787172556, decouple_loss:0.0024373517371714115
The modified gen p mean: 0.4478810429573059, gen p mean: -0.25029754638671875, mean p set: 0.44846081733703613
loss_pred:0.014862610027194023, decouple_loss:0.0028858608566224575
The modified gen p mean: 0.4470808804035187, gen p mean: -0.25224247574806213, mean p set: 0.44761648774147034
loss_pred:0.014788254164159298, decouple_loss:0.002846477786079049
Iteration: 1759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760704040527344, gen p mean: -0.2511393427848816, mean p set: 0.44819164276123047
loss_pred:0.014711787924170494, decouple_loss:0.0026189812924712896
The modified gen p mean: 0.4477432370185852, gen p mean: -0.2503381669521332, mean p set: 0.44831904768943787
loss_pred:0.015391405671834946, decouple_loss:0.0026046396233141422
The modified gen p mean: 0.4461236000061035, gen p mean: -0.24866609275341034, mean p set: 0.44665300846099854
loss_pred:0.015174263156950474, decouple_loss:0.0022318996489048004
Iteration: 1760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882187247276306, gen p mean: -0.24872098863124847, mean p set: 0.4493890404701233
loss_pred:0.01507656555622816, decouple_loss:0.0023599748965352774
The modified gen p mean: 0.4481637477874756, gen p mean: -0.25354883074760437, mean p set: 0.4487457573413849
loss_pred:0.015146249905228615, decouple_loss:0.002359668491408229
The modified gen p mean: 0.4471706748008728, gen p mean: -0.25358542799949646, mean p set: 0.44770246744155884
loss_pred:0.01483931764960289, decouple_loss:0.002321374136954546
2023-04-27 05:39:50 testing...
The modified gen p mean: 0.4482182562351227, gen p mean: -0.2511823773384094, mean p set: 0.44879910349845886
loss_pred:0.016917841508984566, decouple_loss:0.002777242800220847
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2542186975479126, mean p set: 0.4499112665653229
loss_pred:0.017128275707364082, decouple_loss:0.0026467705611139536
The modified gen p mean: 0.4493047893047333, gen p mean: -0.25441157817840576, mean p set: 0.4498290419578552
loss_pred:0.016644272953271866, decouple_loss:0.0025626649148762226
WV_1_PC_1_EH_0_PS_30, loss: 0.017029909417033195, avg_mse: 0.025202041491866112
current test mse: 0.025202
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 1761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460573196411133, gen p mean: -0.25501549243927, mean p set: 0.4465799629688263
loss_pred:0.015409952960908413, decouple_loss:0.0027371549513190985
The modified gen p mean: 0.4463266134262085, gen p mean: -0.25425785779953003, mean p set: 0.4468989372253418
loss_pred:0.015820400789380074, decouple_loss:0.002649898175150156
The modified gen p mean: 0.4470627009868622, gen p mean: -0.25880295038223267, mean p set: 0.4476405084133148
loss_pred:0.01608867570757866, decouple_loss:0.0027232058346271515
Iteration: 1762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648322463035583, gen p mean: -0.2530681788921356, mean p set: 0.4470106363296509
loss_pred:0.015943216159939766, decouple_loss:0.002428390784189105
The modified gen p mean: 0.44715452194213867, gen p mean: -0.25616374611854553, mean p set: 0.44773659110069275
loss_pred:0.015660759061574936, decouple_loss:0.0023861525114625692
The modified gen p mean: 0.44590213894844055, gen p mean: -0.252597838640213, mean p set: 0.44647544622421265
loss_pred:0.016575079411268234, decouple_loss:0.002434786641970277
Iteration: 1763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4448680877685547, gen p mean: -0.2515244781970978, mean p set: 0.4453986883163452
loss_pred:0.01651967503130436, decouple_loss:0.002570387674495578
The modified gen p mean: 0.44639965891838074, gen p mean: -0.25630390644073486, mean p set: 0.446982741355896
loss_pred:0.015739554539322853, decouple_loss:0.0025119418278336525
The modified gen p mean: 0.44638070464134216, gen p mean: -0.25727254152297974, mean p set: 0.44695594906806946
loss_pred:0.01518150232732296, decouple_loss:0.002439680276438594
Iteration: 1764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700852036476135, gen p mean: -0.2576298713684082, mean p set: 0.4475346803665161
loss_pred:0.016543438658118248, decouple_loss:0.002797633409500122
The modified gen p mean: 0.4455418586730957, gen p mean: -0.25612056255340576, mean p set: 0.44611749053001404
loss_pred:0.01574469543993473, decouple_loss:0.0024112684186547995
The modified gen p mean: 0.4458676874637604, gen p mean: -0.25809720158576965, mean p set: 0.4464392364025116
loss_pred:0.01579716056585312, decouple_loss:0.002232078230008483
Iteration: 1765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475254714488983, gen p mean: -0.2651171386241913, mean p set: 0.4481041729450226
loss_pred:0.016446661204099655, decouple_loss:0.0023576240055263042
The modified gen p mean: 0.4471763074398041, gen p mean: -0.26493555307388306, mean p set: 0.44770827889442444The modified gen p mean: 0.44673505425453186, gen p mean: -0.26345181465148926, mean p set: 0.44731536507606506
loss_pred:0.015995630994439125, decouple_loss:0.0023644401226192713
loss_pred:0.016170945018529892, decouple_loss:0.0022395499981939793
Iteration: 1766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462107717990875, gen p mean: -0.26205652952194214, mean p set: 0.44678211212158203
loss_pred:0.015653248876333237, decouple_loss:0.002529169199988246
The modified gen p mean: 0.44559210538864136, gen p mean: -0.26510944962501526, mean p set: 0.446174293756485The modified gen p mean: 0.4467730224132538, gen p mean: -0.2609119713306427, mean p set: 0.44729533791542053
loss_pred:0.015617472119629383, decouple_loss:0.0026299171149730682
loss_pred:0.015358781442046165, decouple_loss:0.0027584179770201445
Iteration: 1767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475537836551666, gen p mean: -0.2561003863811493, mean p set: 0.44812965393066406
loss_pred:0.016157107427716255, decouple_loss:0.002449005376547575
The modified gen p mean: 0.4464265704154968, gen p mean: -0.2574004530906677, mean p set: 0.44695156812667847The modified gen p mean: 0.44669783115386963, gen p mean: -0.25809136033058167, mean p set: 0.4472745358943939
loss_pred:0.015029099769890308, decouple_loss:0.002312042284756899
loss_pred:0.015656618401408195, decouple_loss:0.0028187776915729046
Iteration: 1768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462829828262329, gen p mean: -0.25780999660491943, mean p set: 0.4468485414981842
loss_pred:0.01565796136856079, decouple_loss:0.002471047453582287
The modified gen p mean: 0.44588038325309753, gen p mean: -0.2562500536441803, mean p set: 0.44640541076660156The modified gen p mean: 0.44607725739479065, gen p mean: -0.2540881633758545, mean p set: 0.4466569721698761
loss_pred:0.015886744484305382, decouple_loss:0.0024109629448503256
loss_pred:0.01563514582812786, decouple_loss:0.0026036081835627556
Iteration: 1769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470595419406891, gen p mean: -0.25509536266326904, mean p set: 0.44763532280921936
loss_pred:0.016195738688111305, decouple_loss:0.002469587605446577
The modified gen p mean: 0.4465659558773041, gen p mean: -0.2613048553466797, mean p set: 0.44713932275772095
loss_pred:0.01570788398385048, decouple_loss:0.0023675260599702597
The modified gen p mean: 0.44651710987091064, gen p mean: -0.2594791352748871, mean p set: 0.4470418095588684
loss_pred:0.015559396706521511, decouple_loss:0.002422977238893509
Iteration: 1770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665780663490295, gen p mean: -0.2543147802352905, mean p set: 0.44723621010780334
loss_pred:0.01562570594251156, decouple_loss:0.0022607806604355574
The modified gen p mean: 0.4468294680118561, gen p mean: -0.25641217827796936, mean p set: 0.447405070066452The modified gen p mean: 0.4462743103504181, gen p mean: -0.25460344552993774, mean p set: 0.4468083381652832
loss_pred:0.01579505205154419, decouple_loss:0.002517219167202711
loss_pred:0.015692688524723053, decouple_loss:0.0025221367832273245
2023-04-27 05:43:57 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2514443099498749, mean p set: 0.4499112665653229
loss_pred:0.016948500648140907, decouple_loss:0.0024523744359612465
The modified gen p mean: 0.4492988586425781, gen p mean: -0.25095614790916443, mean p set: 0.4498290419578552
loss_pred:0.0164434053003788, decouple_loss:0.0025555952452123165
The modified gen p mean: 0.44823402166366577, gen p mean: -0.2483592927455902, mean p set: 0.44879910349845886
loss_pred:0.016819054260849953, decouple_loss:0.0025240499526262283
WV_1_PC_1_EH_0_PS_30, loss: 0.016862519085407257, avg_mse: 0.02493344433605671
current test mse: 0.024933
Iteration: 1771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44608139991760254, gen p mean: -0.25012046098709106, mean p set: 0.44666188955307007
loss_pred:0.01602168008685112, decouple_loss:0.002551156561821699
The modified gen p mean: 0.44560712575912476, gen p mean: -0.2503923773765564, mean p set: 0.44613370299339294
loss_pred:0.015449806116521358, decouple_loss:0.0025066162925213575
The modified gen p mean: 0.4470653831958771, gen p mean: -0.2520085573196411, mean p set: 0.4476345181465149
loss_pred:0.015641633421182632, decouple_loss:0.0024052795488387346
Iteration: 1772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666266441345215, gen p mean: -0.25496548414230347, mean p set: 0.44719311594963074
loss_pred:0.015498836524784565, decouple_loss:0.0023358226753771305
The modified gen p mean: 0.4469461143016815, gen p mean: -0.2524588704109192, mean p set: 0.44752374291419983
The modified gen p mean: 0.4457565248012543, gen p mean: -0.2504369020462036, mean p set: 0.4463409185409546
loss_pred:0.01616746000945568, decouple_loss:0.002397742588073015
loss_pred:0.015443888492882252, decouple_loss:0.0022340514697134495
Iteration: 1773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457451105117798, gen p mean: -0.2493552714586258, mean p set: 0.446274995803833
loss_pred:0.015942620113492012, decouple_loss:0.0024731606245040894
The modified gen p mean: 0.4463508129119873, gen p mean: -0.2532975673675537, mean p set: 0.4469238221645355
The modified gen p mean: 0.44649964570999146, gen p mean: -0.2560238540172577, mean p set: 0.44707778096199036
loss_pred:0.016096284613013268, decouple_loss:0.0021496594417840242
loss_pred:0.01582263968884945, decouple_loss:0.002180417301133275
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470241367816925, gen p mean: -0.2513050138950348, mean p set: 0.44754984974861145
loss_pred:0.015661800280213356, decouple_loss:0.0024493522942066193
The modified gen p mean: 0.4469231963157654, gen p mean: -0.256672739982605, mean p set: 0.44749611616134644
The modified gen p mean: 0.446864515542984, gen p mean: -0.2512977123260498, mean p set: 0.44744303822517395
loss_pred:0.015389269217848778, decouple_loss:0.0025287545286118984
loss_pred:0.01584155671298504, decouple_loss:0.0026090387254953384
Iteration: 1775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695597887039185, gen p mean: -0.25358515977859497, mean p set: 0.4475320279598236
loss_pred:0.015240784734487534, decouple_loss:0.00218593399040401
The modified gen p mean: 0.44655483961105347, gen p mean: -0.2519834041595459, mean p set: 0.4470827281475067The modified gen p mean: 0.44656845927238464, gen p mean: -0.25030988454818726, mean p set: 0.44714006781578064
loss_pred:0.015848355367779732, decouple_loss:0.002288507530465722
loss_pred:0.015464413911104202, decouple_loss:0.002260425593703985
Iteration: 1776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454733729362488, gen p mean: -0.25335314869880676, mean p set: 0.44604605436325073
loss_pred:0.01526239700615406, decouple_loss:0.0025713362265378237
The modified gen p mean: 0.444097638130188, gen p mean: -0.24746182560920715, mean p set: 0.44466984272003174The modified gen p mean: 0.44710010290145874, gen p mean: -0.24962179362773895, mean p set: 0.4476243555545807
loss_pred:0.016074392944574356, decouple_loss:0.002912290161475539
loss_pred:0.015550825744867325, decouple_loss:0.0026458711363375187
Iteration: 1777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453762471675873, gen p mean: -0.25313088297843933, mean p set: 0.44595643877983093
loss_pred:0.01558761391788721, decouple_loss:0.0022811011876910925
The modified gen p mean: 0.44573336839675903, gen p mean: -0.25305432081222534, mean p set: 0.44631072878837585
loss_pred:0.01536540500819683, decouple_loss:0.0022421306930482388
The modified gen p mean: 0.44701528549194336, gen p mean: -0.2513048052787781, mean p set: 0.4475449025630951
loss_pred:0.016219358891248703, decouple_loss:0.0023886465933173895
Iteration: 1778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44578737020492554, gen p mean: -0.25543874502182007, mean p set: 0.4463599622249603
loss_pred:0.015764305368065834, decouple_loss:0.0025326358154416084
The modified gen p mean: 0.445374071598053, gen p mean: -0.2513931393623352, mean p set: 0.4459480941295624
loss_pred:0.015725092962384224, decouple_loss:0.0023148844484239817
The modified gen p mean: 0.4455356299877167, gen p mean: -0.25329241156578064, mean p set: 0.44606199860572815
loss_pred:0.015773814171552658, decouple_loss:0.002209728118032217
Iteration: 1779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458111822605133, gen p mean: -0.250192254781723, mean p set: 0.44639402627944946
loss_pred:0.015547405928373337, decouple_loss:0.0025056402664631605
The modified gen p mean: 0.44646385312080383, gen p mean: -0.25332382321357727, mean p set: 0.4470359981060028
loss_pred:0.015366338193416595, decouple_loss:0.002634381642565131
The modified gen p mean: 0.4473414719104767, gen p mean: -0.2491074800491333, mean p set: 0.4478660225868225
loss_pred:0.016332102939486504, decouple_loss:0.0029599422123283148
Iteration: 1780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643479585647583, gen p mean: -0.24376912415027618, mean p set: 0.447003036737442
loss_pred:0.015709569677710533, decouple_loss:0.0024621777702122927
The modified gen p mean: 0.44508126378059387, gen p mean: -0.24410244822502136, mean p set: 0.4456527829170227
loss_pred:0.01549842581152916, decouple_loss:0.0025330716744065285
The modified gen p mean: 0.4471321105957031, gen p mean: -0.24750107526779175, mean p set: 0.44765836000442505
loss_pred:0.015379764139652252, decouple_loss:0.0029508464504033327
2023-04-27 05:47:20 testing...
The modified gen p mean: 0.4482232332229614, gen p mean: -0.24315039813518524, mean p set: 0.44879910349845886
loss_pred:0.01680959202349186, decouple_loss:0.0022912807762622833
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24618755280971527, mean p set: 0.4499112665653229
loss_pred:0.01691313460469246, decouple_loss:0.0023645299952477217
The modified gen p mean: 0.44930654764175415, gen p mean: -0.24595367908477783, mean p set: 0.4498290419578552
loss_pred:0.016509199514985085, decouple_loss:0.002332727424800396
WV_1_PC_1_EH_0_PS_30, loss: 0.01686045154929161, avg_mse: 0.024933066219091415
current test mse: 0.024933
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 1781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818633794784546, gen p mean: -0.24964401125907898, mean p set: 0.44871246814727783
loss_pred:0.015937931835651398, decouple_loss:0.002658650279045105
The modified gen p mean: 0.44900357723236084, gen p mean: -0.24498315155506134, mean p set: 0.4495806396007538
loss_pred:0.0151741998270154, decouple_loss:0.0025300239212810993
The modified gen p mean: 0.4489058554172516, gen p mean: -0.24661436676979065, mean p set: 0.4494836926460266
loss_pred:0.01541340071707964, decouple_loss:0.0024617770686745644
Iteration: 1782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884735345840454, gen p mean: -0.24221165478229523, mean p set: 0.4493807256221771
loss_pred:0.015177635475993156, decouple_loss:0.0023189301136881113
The modified gen p mean: 0.44911399483680725, gen p mean: -0.2460487335920334, mean p set: 0.4496983587741852
loss_pred:0.015896139666438103, decouple_loss:0.0025348581839352846
The modified gen p mean: 0.44839683175086975, gen p mean: -0.2423659712076187, mean p set: 0.44897210597991943
loss_pred:0.015883732587099075, decouple_loss:0.0024805546272546053
Iteration: 1783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484623074531555, gen p mean: -0.24170079827308655, mean p set: 0.4489958584308624
loss_pred:0.01578662358224392, decouple_loss:0.002655869582667947
The modified gen p mean: 0.44928041100502014, gen p mean: -0.2445213347673416, mean p set: 0.44986000657081604
loss_pred:0.015388545580208302, decouple_loss:0.0026720850728452206
The modified gen p mean: 0.4487767219543457, gen p mean: -0.2499571144580841, mean p set: 0.4493550956249237
loss_pred:0.015576439909636974, decouple_loss:0.00293926103040576
Iteration: 1784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494020342826843, gen p mean: -0.24844418466091156, mean p set: 0.4499303698539734
loss_pred:0.01621653325855732, decouple_loss:0.002507630968466401
The modified gen p mean: 0.4486563205718994, gen p mean: -0.2509412169456482, mean p set: 0.449236124753952
loss_pred:0.01557787973433733, decouple_loss:0.0023957518860697746
The modified gen p mean: 0.44784075021743774, gen p mean: -0.2500288784503937, mean p set: 0.44842392206192017
loss_pred:0.015477374196052551, decouple_loss:0.0023494570050388575
Iteration: 1785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059582591056824, gen p mean: -0.23844245076179504, mean p set: 0.451172411441803
loss_pred:0.015405085869133472, decouple_loss:0.0032514864578843117
The modified gen p mean: 0.4497288167476654, gen p mean: -0.2438843995332718, mean p set: 0.4503089487552643
loss_pred:0.015069974586367607, decouple_loss:0.0025774638634175062
The modified gen p mean: 0.4484862685203552, gen p mean: -0.2398664653301239, mean p set: 0.44901344180107117
loss_pred:0.015580082312226295, decouple_loss:0.0029463351238518953
Iteration: 1786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494706988334656, gen p mean: -0.23862604796886444, mean p set: 0.45004376769065857
loss_pred:0.01440679281949997, decouple_loss:0.002375447191298008
The modified gen p mean: 0.4484670162200928, gen p mean: -0.24092070758342743, mean p set: 0.44899484515190125The modified gen p mean: 0.44982820749282837, gen p mean: -0.24433541297912598, mean p set: 0.4504038989543915
loss_pred:0.015195255167782307, decouple_loss:0.002281071851029992
loss_pred:0.016396543011069298, decouple_loss:0.0023604196030646563
Iteration: 1787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492114186286926, gen p mean: -0.2435978800058365, mean p set: 0.4497894048690796
loss_pred:0.015191198326647282, decouple_loss:0.002531451638787985
The modified gen p mean: 0.4491998851299286, gen p mean: -0.24131545424461365, mean p set: 0.44977647066116333
loss_pred:0.015111989341676235, decouple_loss:0.0025591731537133455
The modified gen p mean: 0.4478730857372284, gen p mean: -0.2372589409351349, mean p set: 0.4484051764011383
loss_pred:0.01534744817763567, decouple_loss:0.0024226182140409946
Iteration: 1788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933316111564636, gen p mean: -0.25072938203811646, mean p set: 0.44991445541381836
loss_pred:0.015541917644441128, decouple_loss:0.002225806936621666
The modified gen p mean: 0.447936475276947, gen p mean: -0.25140202045440674, mean p set: 0.44850850105285645
loss_pred:0.014916906133294106, decouple_loss:0.00231493404135108
The modified gen p mean: 0.448988139629364, gen p mean: -0.24111279845237732, mean p set: 0.4495154023170471
loss_pred:0.014963123947381973, decouple_loss:0.002571879420429468
Iteration: 1789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44993919134140015, gen p mean: -0.24552021920681, mean p set: 0.450520396232605
loss_pred:0.01525907777249813, decouple_loss:0.002570832846686244
The modified gen p mean: 0.44792070984840393, gen p mean: -0.25019460916519165, mean p set: 0.44848892092704773
loss_pred:0.01580231823027134, decouple_loss:0.002651801100000739
The modified gen p mean: 0.44863998889923096, gen p mean: -0.24466542899608612, mean p set: 0.4491713047027588
loss_pred:0.01581372134387493, decouple_loss:0.002487737452611327
Iteration: 1790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481353461742401, gen p mean: -0.2509782314300537, mean p set: 0.4487136900424957
loss_pred:0.015983549878001213, decouple_loss:0.0024670730344951153
The modified gen p mean: 0.44918587803840637, gen p mean: -0.248892679810524, mean p set: 0.4497624933719635
loss_pred:0.015352793969213963, decouple_loss:0.0024785627610981464
The modified gen p mean: 0.4495028555393219, gen p mean: -0.249684676527977, mean p set: 0.45003435015678406
loss_pred:0.015045308507978916, decouple_loss:0.0023279094602912664
2023-04-27 05:51:22 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2541124224662781, mean p set: 0.4499112665653229
loss_pred:0.01701202429831028, decouple_loss:0.002493841340765357
The modified gen p mean: 0.44821929931640625, gen p mean: -0.2514670491218567, mean p set: 0.44879910349845886
loss_pred:0.016955675557255745, decouple_loss:0.0024430975317955017
The modified gen p mean: 0.4493001401424408, gen p mean: -0.2543282210826874, mean p set: 0.4498290419578552
loss_pred:0.01657249592244625, decouple_loss:0.0024757706560194492
WV_1_PC_1_EH_0_PS_30, loss: 0.016970276832580566, avg_mse: 0.02513905055820942
current test mse: 0.025139
Iteration: 1791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509546756744385, gen p mean: -0.24588997662067413, mean p set: 0.4515393376350403
loss_pred:0.01528850942850113, decouple_loss:0.0026562190614640713
The modified gen p mean: 0.44869211316108704, gen p mean: -0.2494465708732605, mean p set: 0.44927287101745605
loss_pred:0.015682099387049675, decouple_loss:0.0023661553859710693
The modified gen p mean: 0.4483508765697479, gen p mean: -0.24868382513523102, mean p set: 0.4488753378391266
loss_pred:0.015687793493270874, decouple_loss:0.0023576205130666494
Iteration: 1792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447824090719223, gen p mean: -0.2569960653781891, mean p set: 0.4483579099178314
loss_pred:0.014584476128220558, decouple_loss:0.0024033449590206146
The modified gen p mean: 0.45001283288002014, gen p mean: -0.25695452094078064, mean p set: 0.45059165358543396
loss_pred:0.015520485118031502, decouple_loss:0.0023097372613847256
The modified gen p mean: 0.4490693211555481, gen p mean: -0.2468041032552719, mean p set: 0.44964277744293213
loss_pred:0.015589977614581585, decouple_loss:0.002496967324987054
Iteration: 1793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874143600463867, gen p mean: -0.24824486672878265, mean p set: 0.4492739737033844
loss_pred:0.015706708654761314, decouple_loss:0.0027507301419973373
The modified gen p mean: 0.4474654495716095, gen p mean: -0.25589150190353394, mean p set: 0.4480412006378174
loss_pred:0.015555799007415771, decouple_loss:0.0027934859972447157
The modified gen p mean: 0.4480062425136566, gen p mean: -0.24917587637901306, mean p set: 0.4485754370689392
loss_pred:0.015918835997581482, decouple_loss:0.002648434601724148
Iteration: 1794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001479983329773, gen p mean: -0.239389106631279, mean p set: 0.45054665207862854
loss_pred:0.015218131244182587, decouple_loss:0.0024376341607421637
The modified gen p mean: 0.4477525055408478, gen p mean: -0.2499869465827942, mean p set: 0.44832560420036316
loss_pred:0.015185549855232239, decouple_loss:0.0024043135344982147
The modified gen p mean: 0.448910117149353, gen p mean: -0.23943784832954407, mean p set: 0.4494929015636444
loss_pred:0.015527896583080292, decouple_loss:0.002428582403808832
Iteration: 1795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825872778892517, gen p mean: -0.2399330884218216, mean p set: 0.4488248825073242
loss_pred:0.015539281070232391, decouple_loss:0.0026700010057538748
The modified gen p mean: 0.44919106364250183, gen p mean: -0.23962050676345825, mean p set: 0.44971972703933716The modified gen p mean: 0.44771459698677063, gen p mean: -0.2465420514345169, mean p set: 0.44829061627388
loss_pred:0.01516722235828638, decouple_loss:0.002510110614821315
loss_pred:0.015405433252453804, decouple_loss:0.002466922625899315
Iteration: 1796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494422972202301, gen p mean: -0.23706096410751343, mean p set: 0.4500153958797455
loss_pred:0.014544996432960033, decouple_loss:0.0026496942155063152
The modified gen p mean: 0.4489118158817291, gen p mean: -0.23942022025585175, mean p set: 0.4494885504245758The modified gen p mean: 0.44940537214279175, gen p mean: -0.24164770543575287, mean p set: 0.4499305486679077
loss_pred:0.01623169519007206, decouple_loss:0.0025288413744419813
loss_pred:0.014969767071306705, decouple_loss:0.002346278168261051
Iteration: 1797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481813311576843, gen p mean: -0.24548059701919556, mean p set: 0.4487546384334564
loss_pred:0.015659717842936516, decouple_loss:0.0028818997088819742
The modified gen p mean: 0.44881001114845276, gen p mean: -0.24219577014446259, mean p set: 0.44933852553367615The modified gen p mean: 0.44786903262138367, gen p mean: -0.24603623151779175, mean p set: 0.4484458863735199
loss_pred:0.015398038551211357, decouple_loss:0.0025698125828057528
loss_pred:0.015339300036430359, decouple_loss:0.0024757334031164646
Iteration: 1798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477764666080475, gen p mean: -0.24149112403392792, mean p set: 0.44834738969802856
loss_pred:0.01505143940448761, decouple_loss:0.0024982865434139967
The modified gen p mean: 0.448971688747406, gen p mean: -0.2401411533355713, mean p set: 0.4495515525341034
loss_pred:0.015411232598125935, decouple_loss:0.0023877848871052265
The modified gen p mean: 0.449569970369339, gen p mean: -0.2379995435476303, mean p set: 0.4500974118709564
loss_pred:0.015063926577568054, decouple_loss:0.0024743652902543545
Iteration: 1799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485197365283966, gen p mean: -0.23294316232204437, mean p set: 0.44910016655921936
loss_pred:0.015752196311950684, decouple_loss:0.002688036300241947
The modified gen p mean: 0.4497314393520355, gen p mean: -0.23440653085708618, mean p set: 0.450310081243515
loss_pred:0.015483375638723373, decouple_loss:0.0025326476898044348
The modified gen p mean: 0.448483407497406, gen p mean: -0.24269217252731323, mean p set: 0.4490082263946533
loss_pred:0.015000495128333569, decouple_loss:0.002997871022671461
Iteration: 1800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485330879688263, gen p mean: -0.24185553193092346, mean p set: 0.44910159707069397
loss_pred:0.015249207615852356, decouple_loss:0.002846798859536648
The modified gen p mean: 0.44887787103652954, gen p mean: -0.23909206688404083, mean p set: 0.44941237568855286
loss_pred:0.015582126565277576, decouple_loss:0.002817631931975484
The modified gen p mean: 0.44939175248146057, gen p mean: -0.2383483201265335, mean p set: 0.44996556639671326
loss_pred:0.01503657829016447, decouple_loss:0.0027368918526917696
2023-04-27 05:54:47 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24577270448207855, mean p set: 0.4499112665653229
loss_pred:0.017039254307746887, decouple_loss:0.003079949179664254
The modified gen p mean: 0.4493040442466736, gen p mean: -0.2460358738899231, mean p set: 0.4498290419578552
loss_pred:0.016578830778598785, decouple_loss:0.002802805043756962
The modified gen p mean: 0.44822192192077637, gen p mean: -0.24277526140213013, mean p set: 0.44879910349845886
loss_pred:0.01697995699942112, decouple_loss:0.002697620540857315
WV_1_PC_1_EH_0_PS_30, loss: 0.01700901985168457, avg_mse: 0.025074079632759094
current test mse: 0.025074
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 1801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478614032268524, gen p mean: -0.24638763070106506, mean p set: 0.44838836789131165
loss_pred:0.014748435467481613, decouple_loss:0.002596000675112009
The modified gen p mean: 0.4473256766796112, gen p mean: -0.2461324781179428, mean p set: 0.44789940118789673
loss_pred:0.01586925983428955, decouple_loss:0.002804109826683998
The modified gen p mean: 0.44763821363449097, gen p mean: -0.24420055747032166, mean p set: 0.4482133686542511
loss_pred:0.015326923690736294, decouple_loss:0.002587102120742202
Iteration: 1802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480907917022705, gen p mean: -0.24636943638324738, mean p set: 0.44862261414527893
loss_pred:0.014813615009188652, decouple_loss:0.0025813651736825705
The modified gen p mean: 0.4475151300430298, gen p mean: -0.2425914853811264, mean p set: 0.4480895698070526
The modified gen p mean: 0.44840189814567566, gen p mean: -0.24790586531162262, mean p set: 0.44897761940956116
loss_pred:0.014888059347867966, decouple_loss:0.002385109895840287
loss_pred:0.014796222560107708, decouple_loss:0.0026926137506961823
Iteration: 1803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476499557495117, gen p mean: -0.24402815103530884, mean p set: 0.4481825828552246
loss_pred:0.014693479053676128, decouple_loss:0.0025172282475978136
The modified gen p mean: 0.4466826021671295, gen p mean: -0.24459001421928406, mean p set: 0.4472596049308777
The modified gen p mean: 0.448596715927124, gen p mean: -0.241073340177536, mean p set: 0.44917070865631104
loss_pred:0.015167745761573315, decouple_loss:0.0026261841412633657
loss_pred:0.015403146855533123, decouple_loss:0.0028214736375957727
Iteration: 1804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475035071372986, gen p mean: -0.24423173069953918, mean p set: 0.4480327069759369
loss_pred:0.014662950299680233, decouple_loss:0.002399020828306675
The modified gen p mean: 0.44856953620910645, gen p mean: -0.24676825106143951, mean p set: 0.4491502642631531
The modified gen p mean: 0.4475947320461273, gen p mean: -0.2515103220939636, mean p set: 0.44817450642585754
loss_pred:0.015431227162480354, decouple_loss:0.0026181875728070736
loss_pred:0.015294992364943027, decouple_loss:0.002419294323772192
Iteration: 1805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448790967464447, gen p mean: -0.24167662858963013, mean p set: 0.44937047362327576
loss_pred:0.015404672361910343, decouple_loss:0.0025452678091824055
The modified gen p mean: 0.44766509532928467, gen p mean: -0.2421783059835434, mean p set: 0.4481982886791229The modified gen p mean: 0.44792595505714417, gen p mean: -0.23906520009040833, mean p set: 0.4484962224960327
loss_pred:0.014923558570444584, decouple_loss:0.0027341055683791637
loss_pred:0.015073109418153763, decouple_loss:0.002588215284049511
Iteration: 1806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681623578071594, gen p mean: -0.24602815508842468, mean p set: 0.4473881721496582
loss_pred:0.015152358449995518, decouple_loss:0.002659379504621029
The modified gen p mean: 0.44758152961730957, gen p mean: -0.24252215027809143, mean p set: 0.4481063485145569The modified gen p mean: 0.4471385180950165, gen p mean: -0.24138586223125458, mean p set: 0.4477144777774811
loss_pred:0.01489893440157175, decouple_loss:0.00281770178116858
loss_pred:0.01552727073431015, decouple_loss:0.0029961864929646254
Iteration: 1807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676271080970764, gen p mean: -0.24128444492816925, mean p set: 0.4473342299461365
loss_pred:0.015274656005203724, decouple_loss:0.002710140310227871
The modified gen p mean: 0.4478033185005188, gen p mean: -0.23874875903129578, mean p set: 0.44837847352027893The modified gen p mean: 0.44799384474754333, gen p mean: -0.23831060528755188, mean p set: 0.44852009415626526
loss_pred:0.015116124413907528, decouple_loss:0.0025345520116388798
loss_pred:0.014964539557695389, decouple_loss:0.0027568123769015074
Iteration: 1808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588515162467957, gen p mean: -0.24293139576911926, mean p set: 0.44645851850509644
loss_pred:0.014739678241312504, decouple_loss:0.00253240461461246
The modified gen p mean: 0.44699275493621826, gen p mean: -0.24268007278442383, mean p set: 0.4475173056125641The modified gen p mean: 0.44686147570610046, gen p mean: -0.24511012434959412, mean p set: 0.4474402070045471
loss_pred:0.01540431659668684, decouple_loss:0.0025896260049194098
loss_pred:0.015091970562934875, decouple_loss:0.0028774950187653303
Iteration: 1809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473511874675751, gen p mean: -0.2527848184108734, mean p set: 0.4479212760925293
loss_pred:0.014880220405757427, decouple_loss:0.002831998048350215
The modified gen p mean: 0.4477740526199341, gen p mean: -0.25297674536705017, mean p set: 0.4483039677143097The modified gen p mean: 0.44719198346138, gen p mean: -0.25567540526390076, mean p set: 0.4477669298648834
loss_pred:0.01515712309628725, decouple_loss:0.002623905660584569
loss_pred:0.01455300860106945, decouple_loss:0.002625509165227413
Iteration: 1810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466918706893921, gen p mean: -0.2570042312145233, mean p set: 0.44727250933647156
loss_pred:0.015028911642730236, decouple_loss:0.0025963671505451202
The modified gen p mean: 0.448604553937912, gen p mean: -0.25085973739624023, mean p set: 0.44913291931152344The modified gen p mean: 0.4472043514251709, gen p mean: -0.2604348659515381, mean p set: 0.44778600335121155
loss_pred:0.015004976652562618, decouple_loss:0.0025292926002293825
loss_pred:0.01538809947669506, decouple_loss:0.0026997714303433895
2023-04-27 05:58:47 testing...
The modified gen p mean: 0.4482250511646271, gen p mean: -0.2523413896560669, mean p set: 0.44879910349845886
loss_pred:0.01694534532725811, decouple_loss:0.0025486096274107695
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25520190596580505, mean p set: 0.4499112665653229
loss_pred:0.01712483912706375, decouple_loss:0.002525102812796831
The modified gen p mean: 0.44930338859558105, gen p mean: -0.255636990070343, mean p set: 0.4498290419578552
loss_pred:0.016536585986614227, decouple_loss:0.0026114103384315968
WV_1_PC_1_EH_0_PS_30, loss: 0.01699700951576233, avg_mse: 0.025132274255156517
current test mse: 0.025132
Iteration: 1811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739052653312683, gen p mean: -0.2566801905632019, mean p set: 0.4479711353778839
loss_pred:0.015163962729275227, decouple_loss:0.0026301692705601454
The modified gen p mean: 0.4467780590057373, gen p mean: -0.2535025179386139, mean p set: 0.4473542869091034
loss_pred:0.014890450052917004, decouple_loss:0.00243879365734756
The modified gen p mean: 0.4471324384212494, gen p mean: -0.260618656873703, mean p set: 0.4476650059223175
loss_pred:0.015279963612556458, decouple_loss:0.0026271725073456764
Iteration: 1812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484119117259979, gen p mean: -0.255368173122406, mean p set: 0.448940247297287
loss_pred:0.015089874155819416, decouple_loss:0.0027391270268708467
The modified gen p mean: 0.4474218785762787, gen p mean: -0.2547551095485687, mean p set: 0.44800058007240295The modified gen p mean: 0.44710788130760193, gen p mean: -0.25809162855148315, mean p set: 0.4476828873157501
loss_pred:0.01441127061843872, decouple_loss:0.0027206032536923885
loss_pred:0.01462907250970602, decouple_loss:0.0026110662147402763
Iteration: 1813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807732105255127, gen p mean: -0.24702951312065125, mean p set: 0.44860079884529114
loss_pred:0.014963065274059772, decouple_loss:0.0026938803493976593
The modified gen p mean: 0.44763848185539246, gen p mean: -0.25043007731437683, mean p set: 0.44821637868881226The modified gen p mean: 0.447328120470047, gen p mean: -0.24801726639270782, mean p set: 0.4479072690010071
loss_pred:0.01521745603531599, decouple_loss:0.002577655715867877
loss_pred:0.015126227401196957, decouple_loss:0.002714126603677869
Iteration: 1814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465094804763794, gen p mean: -0.25353190302848816, mean p set: 0.4470282196998596
loss_pred:0.01478699129074812, decouple_loss:0.002470071194693446
The modified gen p mean: 0.44733256101608276, gen p mean: -0.24897241592407227, mean p set: 0.44791606068611145The modified gen p mean: 0.447566419839859, gen p mean: -0.25512969493865967, mean p set: 0.44813501834869385
loss_pred:0.015512351877987385, decouple_loss:0.0024530901573598385
loss_pred:0.015346836298704147, decouple_loss:0.0026116047520190477
Iteration: 1815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485495686531067, gen p mean: -0.24153241515159607, mean p set: 0.4491216838359833
loss_pred:0.014673002064228058, decouple_loss:0.0030840460676699877
The modified gen p mean: 0.4468376636505127, gen p mean: -0.2505596876144409, mean p set: 0.4474206268787384
loss_pred:0.015184457413852215, decouple_loss:0.0025513621512800455
The modified gen p mean: 0.4483495056629181, gen p mean: -0.2484382539987564, mean p set: 0.44886934757232666
loss_pred:0.014769384637475014, decouple_loss:0.002896580146625638
Iteration: 1816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779807329177856, gen p mean: -0.24874834716320038, mean p set: 0.4483788311481476
loss_pred:0.015356022864580154, decouple_loss:0.002470791805535555
The modified gen p mean: 0.44742801785469055, gen p mean: -0.2510039210319519, mean p set: 0.4479547441005707The modified gen p mean: 0.4469209909439087, gen p mean: -0.25214505195617676, mean p set: 0.4475003480911255
loss_pred:0.01496179774403572, decouple_loss:0.00255945255048573
loss_pred:0.014549589715898037, decouple_loss:0.0025073529686778784
Iteration: 1817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476926624774933, gen p mean: -0.24751126766204834, mean p set: 0.4482652246952057
loss_pred:0.014881301671266556, decouple_loss:0.0023863783571869135
The modified gen p mean: 0.44760656356811523, gen p mean: -0.250293493270874, mean p set: 0.4481835961341858
loss_pred:0.015051151625812054, decouple_loss:0.0024312655441462994
The modified gen p mean: 0.44812387228012085, gen p mean: -0.24821464717388153, mean p set: 0.4486541748046875
loss_pred:0.015265735797584057, decouple_loss:0.0023698098957538605
Iteration: 1818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866958260536194, gen p mean: -0.24720636010169983, mean p set: 0.44924822449684143
loss_pred:0.01462514977902174, decouple_loss:0.0026075120549649
The modified gen p mean: 0.4455353617668152, gen p mean: -0.25231045484542847, mean p set: 0.4461096227169037
loss_pred:0.014947627671062946, decouple_loss:0.002480963710695505
The modified gen p mean: 0.4472372531890869, gen p mean: -0.25347357988357544, mean p set: 0.4477671980857849
loss_pred:0.015065371058881283, decouple_loss:0.0026265389751642942
Iteration: 1819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463801980018616, gen p mean: -0.25170740485191345, mean p set: 0.44695839285850525
loss_pred:0.01487673819065094, decouple_loss:0.0023186784237623215
The modified gen p mean: 0.44722801446914673, gen p mean: -0.2530031204223633, mean p set: 0.44780340790748596
loss_pred:0.015216169878840446, decouple_loss:0.002405358711257577
The modified gen p mean: 0.44623175263404846, gen p mean: -0.24975459277629852, mean p set: 0.44676437973976135
loss_pred:0.014798391610383987, decouple_loss:0.002337020356208086
Iteration: 1820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446281373500824, gen p mean: -0.2539037764072418, mean p set: 0.4468632936477661
loss_pred:0.015005921013653278, decouple_loss:0.002390404464676976
The modified gen p mean: 0.44802823662757874, gen p mean: -0.2527255713939667, mean p set: 0.44860121607780457
loss_pred:0.014256027527153492, decouple_loss:0.0024027954787015915
The modified gen p mean: 0.4477730393409729, gen p mean: -0.2524734437465668, mean p set: 0.4483005702495575
loss_pred:0.01557654608041048, decouple_loss:0.002372253220528364
2023-04-27 06:02:13 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2515091896057129, mean p set: 0.4499112665653229
loss_pred:0.017176276072859764, decouple_loss:0.002680641831830144
The modified gen p mean: 0.4482261836528778, gen p mean: -0.24882039427757263, mean p set: 0.44879910349845886
loss_pred:0.016972392797470093, decouple_loss:0.002649586880579591
The modified gen p mean: 0.4492931365966797, gen p mean: -0.2518218159675598, mean p set: 0.4498290419578552
loss_pred:0.016571495682001114, decouple_loss:0.002618280705064535
WV_1_PC_1_EH_0_PS_30, loss: 0.01703919842839241, avg_mse: 0.025171242654323578
current test mse: 0.025171
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 1821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44637203216552734, gen p mean: -0.2549092173576355, mean p set: 0.4468948543071747
loss_pred:0.015149926766753197, decouple_loss:0.002638409147039056
The modified gen p mean: 0.4465407729148865, gen p mean: -0.2500109076499939, mean p set: 0.447110116481781
loss_pred:0.01635119318962097, decouple_loss:0.002553545404225588
The modified gen p mean: 0.4469556510448456, gen p mean: -0.2555373013019562, mean p set: 0.4475356340408325
loss_pred:0.015055900439620018, decouple_loss:0.002699851291254163
Iteration: 1822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876551628112793, gen p mean: -0.2473636120557785, mean p set: 0.44929543137550354
loss_pred:0.015169664286077023, decouple_loss:0.002828527009114623
The modified gen p mean: 0.44960707426071167, gen p mean: -0.25192806124687195, mean p set: 0.45018208026885986
The modified gen p mean: 0.44679322838783264, gen p mean: -0.248941570520401, mean p set: 0.447368323802948
loss_pred:0.01426402572542429, decouple_loss:0.002461120020598173
loss_pred:0.015484398230910301, decouple_loss:0.002426584716886282
Iteration: 1823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696423411369324, gen p mean: -0.2509334087371826, mean p set: 0.4474853575229645
loss_pred:0.014905697666108608, decouple_loss:0.0025104705709964037
The modified gen p mean: 0.44833096861839294, gen p mean: -0.24311335384845734, mean p set: 0.4489106833934784The modified gen p mean: 0.44757547974586487, gen p mean: -0.24504853785037994, mean p set: 0.4481564164161682
loss_pred:0.015434893779456615, decouple_loss:0.0027671135030686855
loss_pred:0.015237347222864628, decouple_loss:0.0026040510274469852
Iteration: 1824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470252990722656, gen p mean: -0.24630902707576752, mean p set: 0.44755110144615173
loss_pred:0.015649115666747093, decouple_loss:0.00243822718039155
The modified gen p mean: 0.44823339581489563, gen p mean: -0.2472725212574005, mean p set: 0.4488097131252289The modified gen p mean: 0.4474855959415436, gen p mean: -0.2524969279766083, mean p set: 0.4480707347393036
loss_pred:0.015575691126286983, decouple_loss:0.0023838842753320932
loss_pred:0.016026312485337257, decouple_loss:0.0026808995753526688
Iteration: 1825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479047656059265, gen p mean: -0.245286226272583, mean p set: 0.4484834671020508
loss_pred:0.015135619789361954, decouple_loss:0.00239638052880764
The modified gen p mean: 0.4480293095111847, gen p mean: -0.24638162553310394, mean p set: 0.44860541820526123
loss_pred:0.015587149187922478, decouple_loss:0.0023560833651572466
The modified gen p mean: 0.44772303104400635, gen p mean: -0.2505092918872833, mean p set: 0.4482479691505432
loss_pred:0.015432444401085377, decouple_loss:0.002467771526426077
Iteration: 1826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744250178337097, gen p mean: -0.24897907674312592, mean p set: 0.4480155408382416
loss_pred:0.01656830497086048, decouple_loss:0.0028325209859758615
The modified gen p mean: 0.4470332860946655, gen p mean: -0.25132060050964355, mean p set: 0.4476125240325928
loss_pred:0.015392230823636055, decouple_loss:0.002511600498110056
The modified gen p mean: 0.44737714529037476, gen p mean: -0.2535342574119568, mean p set: 0.4479025602340698
loss_pred:0.014803634956479073, decouple_loss:0.002453405177220702
Iteration: 1827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469316601753235, gen p mean: -0.2552646994590759, mean p set: 0.44750893115997314
loss_pred:0.01493197400122881, decouple_loss:0.0024255788885056973
The modified gen p mean: 0.44794121384620667, gen p mean: -0.24949435889720917, mean p set: 0.4485156238079071
loss_pred:0.014734795317053795, decouple_loss:0.0024774561170488596
The modified gen p mean: 0.4461238980293274, gen p mean: -0.2504599988460541, mean p set: 0.44665804505348206
loss_pred:0.01495328824967146, decouple_loss:0.0023510423488914967
Iteration: 1828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735169410705566, gen p mean: -0.2546054422855377, mean p set: 0.4478845000267029
loss_pred:0.014681057073175907, decouple_loss:0.0023552998900413513
The modified gen p mean: 0.4476233124732971, gen p mean: -0.25359758734703064, mean p set: 0.44819900393486023The modified gen p mean: 0.44797441363334656, gen p mean: -0.2528950273990631, mean p set: 0.4485537111759186
loss_pred:0.01518179103732109, decouple_loss:0.0024721878580749035
loss_pred:0.01630638912320137, decouple_loss:0.0025954865850508213
Iteration: 1829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846853613853455, gen p mean: -0.25719600915908813, mean p set: 0.44904476404190063
loss_pred:0.015625441446900368, decouple_loss:0.0026829252019524574
The modified gen p mean: 0.44814521074295044, gen p mean: -0.2539454996585846, mean p set: 0.44871997833251953
loss_pred:0.014769240282475948, decouple_loss:0.0026524944696575403
The modified gen p mean: 0.4483107030391693, gen p mean: -0.252579003572464, mean p set: 0.4488431215286255
loss_pred:0.014708909206092358, decouple_loss:0.0027200491167604923
Iteration: 1830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491346776485443, gen p mean: -0.2562444806098938, mean p set: 0.4497232735157013
loss_pred:0.014706060290336609, decouple_loss:0.0024926515761762857
The modified gen p mean: 0.44753119349479675, gen p mean: -0.25602346658706665, mean p set: 0.4481089115142822
loss_pred:0.01600620336830616, decouple_loss:0.0025083927903324366
The modified gen p mean: 0.4460955262184143, gen p mean: -0.2572329044342041, mean p set: 0.4466237425804138
loss_pred:0.015171718783676624, decouple_loss:0.002698118332773447
2023-04-27 06:06:17 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25913020968437195, mean p set: 0.4499112665653229
loss_pred:0.016949614509940147, decouple_loss:0.002666172804310918
The modified gen p mean: 0.44929999113082886, gen p mean: -0.25965774059295654, mean p set: 0.4498290419578552
loss_pred:0.01645505242049694, decouple_loss:0.002592793432995677
The modified gen p mean: 0.44823145866394043, gen p mean: -0.2565931975841522, mean p set: 0.44879910349845886
loss_pred:0.016793683171272278, decouple_loss:0.0025758971460163593
WV_1_PC_1_EH_0_PS_30, loss: 0.016863364726305008, avg_mse: 0.0248851478099823
current test mse: 0.024885
Iteration: 1831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007261633872986, gen p mean: -0.26014843583106995, mean p set: 0.4506426155567169
loss_pred:0.014764278195798397, decouple_loss:0.0027868961915373802
The modified gen p mean: 0.4465978443622589, gen p mean: -0.2612914741039276, mean p set: 0.4471263289451599
loss_pred:0.014450646005570889, decouple_loss:0.002403153106570244
The modified gen p mean: 0.44934502243995667, gen p mean: -0.26023027300834656, mean p set: 0.4499242305755615
loss_pred:0.014961715787649155, decouple_loss:0.0027058860287070274
Iteration: 1832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44950905442237854, gen p mean: -0.2632433772087097, mean p set: 0.4500364065170288
loss_pred:0.014793545007705688, decouple_loss:0.002410324988886714
The modified gen p mean: 0.44814446568489075, gen p mean: -0.26373445987701416, mean p set: 0.4487214982509613
The modified gen p mean: 0.44768133759498596, gen p mean: -0.2631301283836365, mean p set: 0.4482649564743042
loss_pred:0.015379710122942924, decouple_loss:0.0023307057563215494
loss_pred:0.015209934674203396, decouple_loss:0.0022411926183849573
Iteration: 1833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899940490722656, gen p mean: -0.2655063271522522, mean p set: 0.44952166080474854
loss_pred:0.014793097041547298, decouple_loss:0.002712490037083626
The modified gen p mean: 0.4457859694957733, gen p mean: -0.2616809606552124, mean p set: 0.44636374711990356
The modified gen p mean: 0.4478553533554077, gen p mean: -0.2633194029331207, mean p set: 0.44843170046806335
loss_pred:0.014816884882748127, decouple_loss:0.0026801005005836487
loss_pred:0.01478598639369011, decouple_loss:0.002580302068963647
Iteration: 1834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467332661151886, gen p mean: -0.2578408420085907, mean p set: 0.44726231694221497
loss_pred:0.015941722318530083, decouple_loss:0.0024019421543926
The modified gen p mean: 0.4470672607421875, gen p mean: -0.26186105608940125, mean p set: 0.4476448595523834
The modified gen p mean: 0.4488193392753601, gen p mean: -0.26114723086357117, mean p set: 0.44939976930618286
loss_pred:0.015366681851446629, decouple_loss:0.002309741685166955
loss_pred:0.01518872007727623, decouple_loss:0.002684724284335971
Iteration: 1835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499894678592682, gen p mean: -0.2603512406349182, mean p set: 0.4505683481693268
loss_pred:0.014402377419173717, decouple_loss:0.002290519420057535
The modified gen p mean: 0.4481511116027832, gen p mean: -0.26256778836250305, mean p set: 0.4487282633781433
loss_pred:0.015112830325961113, decouple_loss:0.0023681814782321453
The modified gen p mean: 0.447205126285553, gen p mean: -0.2592504024505615, mean p set: 0.4477330446243286
loss_pred:0.015204263851046562, decouple_loss:0.0023373481817543507
Iteration: 1836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676586985588074, gen p mean: -0.26127946376800537, mean p set: 0.4473358392715454
loss_pred:0.014800690114498138, decouple_loss:0.002236387226730585
The modified gen p mean: 0.44686976075172424, gen p mean: -0.26040390133857727, mean p set: 0.4473958909511566The modified gen p mean: 0.448113352060318, gen p mean: -0.25650569796562195, mean p set: 0.44869574904441833
loss_pred:0.015189276076853275, decouple_loss:0.0028151001315563917
loss_pred:0.015204313211143017, decouple_loss:0.0022992307785898447
Iteration: 1837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476114809513092, gen p mean: -0.2542744576931, mean p set: 0.4481905400753021
loss_pred:0.015414089895784855, decouple_loss:0.002208085497841239
The modified gen p mean: 0.44835689663887024, gen p mean: -0.2555808424949646, mean p set: 0.4488748610019684The modified gen p mean: 0.4478937089443207, gen p mean: -0.2568671703338623, mean p set: 0.448472261428833
loss_pred:0.014782268553972244, decouple_loss:0.002296823775395751
loss_pred:0.015780549496412277, decouple_loss:0.0023166746832430363
Iteration: 1838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474725127220154, gen p mean: -0.2654605805873871, mean p set: 0.4480571746826172
loss_pred:0.015215742401778698, decouple_loss:0.002487855264917016
The modified gen p mean: 0.4484511911869049, gen p mean: -0.2646808624267578, mean p set: 0.4490198791027069
loss_pred:0.015249487943947315, decouple_loss:0.002675881376489997
The modified gen p mean: 0.44803890585899353, gen p mean: -0.2627936005592346, mean p set: 0.4485693573951721
loss_pred:0.014613852836191654, decouple_loss:0.0024467469193041325
Iteration: 1839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783392548561096, gen p mean: -0.2578866481781006, mean p set: 0.44841471314430237
loss_pred:0.015555805526673794, decouple_loss:0.00243093678727746
The modified gen p mean: 0.4490959644317627, gen p mean: -0.26480263471603394, mean p set: 0.449665904045105
loss_pred:0.014394167810678482, decouple_loss:0.0026381658390164375
The modified gen p mean: 0.44779038429260254, gen p mean: -0.26700738072395325, mean p set: 0.4483180344104767
loss_pred:0.015845656394958496, decouple_loss:0.00282738427631557
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843530654907227, gen p mean: -0.25895389914512634, mean p set: 0.44900330901145935
loss_pred:0.014613291248679161, decouple_loss:0.002112435409799218
The modified gen p mean: 0.44817253947257996, gen p mean: -0.2552095353603363, mean p set: 0.4486992359161377The modified gen p mean: 0.4467415511608124, gen p mean: -0.2632737457752228, mean p set: 0.447309285402298
loss_pred:0.014567039906978607, decouple_loss:0.0022138378117233515
loss_pred:0.015615538693964481, decouple_loss:0.0022544357925653458
2023-04-27 06:09:43 testing...
The modified gen p mean: 0.44822806119918823, gen p mean: -0.2515387237071991, mean p set: 0.44879910349845886
loss_pred:0.0167470034211874, decouple_loss:0.002539270557463169
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2542627453804016, mean p set: 0.4499112665653229
loss_pred:0.016928648576140404, decouple_loss:0.0025092079304158688
The modified gen p mean: 0.44929516315460205, gen p mean: -0.25434863567352295, mean p set: 0.4498290419578552
loss_pred:0.01644103415310383, decouple_loss:0.002390993060544133
WV_1_PC_1_EH_0_PS_30, loss: 0.016829553991556168, avg_mse: 0.024863718077540398
current test mse: 0.024864
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717398285865784, gen p mean: -0.2558274269104004, mean p set: 0.4477007985115051
loss_pred:0.015510340221226215, decouple_loss:0.002299417043104768
The modified gen p mean: 0.44686657190322876, gen p mean: -0.250050812959671, mean p set: 0.44744551181793213
loss_pred:0.015294034965336323, decouple_loss:0.002365834079682827
The modified gen p mean: 0.44893527030944824, gen p mean: -0.2549203336238861, mean p set: 0.4495137631893158
loss_pred:0.015252218581736088, decouple_loss:0.0024124847259372473
Iteration: 1842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740527868270874, gen p mean: -0.2534566819667816, mean p set: 0.44793781638145447
loss_pred:0.01614644005894661, decouple_loss:0.002373747993260622
The modified gen p mean: 0.4477711319923401, gen p mean: -0.25463181734085083, mean p set: 0.4483422338962555
loss_pred:0.015274323523044586, decouple_loss:0.002112816320732236
The modified gen p mean: 0.44491496682167053, gen p mean: -0.25840866565704346, mean p set: 0.44549062848091125
loss_pred:0.015438426285982132, decouple_loss:0.0023229275830090046
Iteration: 1843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447826623916626, gen p mean: -0.250552773475647, mean p set: 0.4483581483364105
loss_pred:0.01468852162361145, decouple_loss:0.002085928339511156
The modified gen p mean: 0.44639086723327637, gen p mean: -0.2540378272533417, mean p set: 0.44696754217147827
loss_pred:0.014608821831643581, decouple_loss:0.0025157828349620104
The modified gen p mean: 0.44636034965515137, gen p mean: -0.2496182918548584, mean p set: 0.4469318985939026
loss_pred:0.015998071059584618, decouple_loss:0.00237460620701313
Iteration: 1844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470556080341339, gen p mean: -0.2516900300979614, mean p set: 0.44758957624435425
loss_pred:0.015549631789326668, decouple_loss:0.0023529832251369953
The modified gen p mean: 0.4477676451206207, gen p mean: -0.24741725623607635, mean p set: 0.44834378361701965
loss_pred:0.01498730294406414, decouple_loss:0.002295814221724868
The modified gen p mean: 0.4454841613769531, gen p mean: -0.2501184046268463, mean p set: 0.4460590183734894
loss_pred:0.015664326027035713, decouple_loss:0.0021830948535352945
Iteration: 1845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485062062740326, gen p mean: -0.2510020136833191, mean p set: 0.44907715916633606
loss_pred:0.014956647530198097, decouple_loss:0.002207833807915449
The modified gen p mean: 0.4472311735153198, gen p mean: -0.25059974193573, mean p set: 0.44775307178497314The modified gen p mean: 0.4470401704311371, gen p mean: -0.24958495795726776, mean p set: 0.4476129114627838
loss_pred:0.01590626686811447, decouple_loss:0.0022666638251394033
loss_pred:0.014369692653417587, decouple_loss:0.0022852818947285414
Iteration: 1846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484451413154602, gen p mean: -0.24330566823482513, mean p set: 0.4490286707878113
loss_pred:0.01587994396686554, decouple_loss:0.002511432161554694
The modified gen p mean: 0.4466574192047119, gen p mean: -0.2471582442522049, mean p set: 0.44717955589294434The modified gen p mean: 0.44579342007637024, gen p mean: -0.24754267930984497, mean p set: 0.44635844230651855
loss_pred:0.015534644946455956, decouple_loss:0.002259013010188937
loss_pred:0.01517680287361145, decouple_loss:0.002248520730063319
Iteration: 1847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762977957725525, gen p mean: -0.24717974662780762, mean p set: 0.448209285736084
loss_pred:0.015067153610289097, decouple_loss:0.002037239959463477
The modified gen p mean: 0.4470980763435364, gen p mean: -0.2469208836555481, mean p set: 0.4476804733276367The modified gen p mean: 0.44755807518959045, gen p mean: -0.250658243894577, mean p set: 0.44808200001716614
loss_pred:0.015932142734527588, decouple_loss:0.002329397015273571
loss_pred:0.014255712740123272, decouple_loss:0.0022251824848353863
Iteration: 1848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462551176548004, gen p mean: -0.2508348524570465, mean p set: 0.4467789828777313
loss_pred:0.015501362271606922, decouple_loss:0.002359052887186408
The modified gen p mean: 0.44658565521240234, gen p mean: -0.25167229771614075, mean p set: 0.44716206192970276The modified gen p mean: 0.4463579058647156, gen p mean: -0.2544042468070984, mean p set: 0.44692835211753845
loss_pred:0.015722224488854408, decouple_loss:0.002377257216721773
loss_pred:0.015238955616950989, decouple_loss:0.002529046032577753
Iteration: 1849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463335871696472, gen p mean: -0.25075188279151917, mean p set: 0.44690370559692383
loss_pred:0.015285012312233448, decouple_loss:0.002126263454556465
The modified gen p mean: 0.4465318024158478, gen p mean: -0.2531214952468872, mean p set: 0.44710773229599
loss_pred:0.015581953339278698, decouple_loss:0.002135724062100053
The modified gen p mean: 0.44808757305145264, gen p mean: -0.2525116801261902, mean p set: 0.44861549139022827
loss_pred:0.015360616147518158, decouple_loss:0.0020935977809131145
Iteration: 1850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474489688873291, gen p mean: -0.2641362249851227, mean p set: 0.44802701473236084
loss_pred:0.014020383358001709, decouple_loss:0.0022052123676985502
The modified gen p mean: 0.4478069245815277, gen p mean: -0.26271238923072815, mean p set: 0.44838783144950867The modified gen p mean: 0.4457501471042633, gen p mean: -0.25914567708969116, mean p set: 0.4462839961051941
loss_pred:0.015259110368788242, decouple_loss:0.0021512077655643225
loss_pred:0.015058374963700771, decouple_loss:0.0022443020716309547
2023-04-27 06:13:48 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2596297860145569, mean p set: 0.4499112665653229
loss_pred:0.01699957065284252, decouple_loss:0.002444461453706026
The modified gen p mean: 0.44929566979408264, gen p mean: -0.2594894468784332, mean p set: 0.4498290419578552
loss_pred:0.016463911160826683, decouple_loss:0.002356174634769559
The modified gen p mean: 0.4482264518737793, gen p mean: -0.2567174732685089, mean p set: 0.44879910349845886
loss_pred:0.016953589394688606, decouple_loss:0.0024100204464048147
WV_1_PC_1_EH_0_PS_30, loss: 0.016925867646932602, avg_mse: 0.02504468895494938
current test mse: 0.025045
Iteration: 1851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691723585128784, gen p mean: -0.26133397221565247, mean p set: 0.4474954903125763
loss_pred:0.015535667538642883, decouple_loss:0.0022781763691455126
The modified gen p mean: 0.4461756944656372, gen p mean: -0.2605103850364685, mean p set: 0.4467063546180725
loss_pred:0.01601167768239975, decouple_loss:0.0020485331770032644
The modified gen p mean: 0.44645050168037415, gen p mean: -0.2594987452030182, mean p set: 0.4470267593860626
loss_pred:0.015301374718546867, decouple_loss:0.0022336055990308523
Iteration: 1852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44580593705177307, gen p mean: -0.2567649781703949, mean p set: 0.4463306665420532
loss_pred:0.01546978298574686, decouple_loss:0.002220494206994772
The modified gen p mean: 0.44636863470077515, gen p mean: -0.25334519147872925, mean p set: 0.44694095849990845
The modified gen p mean: 0.44651809334754944, gen p mean: -0.2610098719596863, mean p set: 0.4470905363559723
loss_pred:0.016050375998020172, decouple_loss:0.0022450259421020746
loss_pred:0.01532914862036705, decouple_loss:0.002224280033260584
Iteration: 1853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460638463497162, gen p mean: -0.25658243894577026, mean p set: 0.4465861916542053
loss_pred:0.015148337930440903, decouple_loss:0.0021411366760730743
The modified gen p mean: 0.4454038441181183, gen p mean: -0.2593228816986084, mean p set: 0.44598105549812317
The modified gen p mean: 0.44616830348968506, gen p mean: -0.25497668981552124, mean p set: 0.446748286485672
loss_pred:0.014922957867383957, decouple_loss:0.002276205224916339
loss_pred:0.01573280617594719, decouple_loss:0.0021100228186696768
Iteration: 1854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473666250705719, gen p mean: -0.2516951560974121, mean p set: 0.4478902518749237
loss_pred:0.01564946211874485, decouple_loss:0.0022333196830004454
The modified gen p mean: 0.4477405250072479, gen p mean: -0.24996738135814667, mean p set: 0.44831427931785583
The modified gen p mean: 0.4448873996734619, gen p mean: -0.25619393587112427, mean p set: 0.4454576373100281
loss_pred:0.015175997279584408, decouple_loss:0.002112620510160923
loss_pred:0.015411069616675377, decouple_loss:0.0021773839835077524
Iteration: 1855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684818387031555, gen p mean: -0.2505982518196106, mean p set: 0.44741740822792053
loss_pred:0.016028601676225662, decouple_loss:0.0022445744834840298
The modified gen p mean: 0.4467165768146515, gen p mean: -0.24840857088565826, mean p set: 0.44729292392730713The modified gen p mean: 0.4459248185157776, gen p mean: -0.2572531998157501, mean p set: 0.446456640958786
loss_pred:0.015602009370923042, decouple_loss:0.002147387946024537
loss_pred:0.015293983742594719, decouple_loss:0.002170582301914692
Iteration: 1856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622671604156494, gen p mean: -0.252528578042984, mean p set: 0.44680383801460266
loss_pred:0.015145151875913143, decouple_loss:0.0022065911907702684
The modified gen p mean: 0.44762101769447327, gen p mean: -0.25773245096206665, mean p set: 0.4481981694698334The modified gen p mean: 0.4483567476272583, gen p mean: -0.25393587350845337, mean p set: 0.448881059885025
loss_pred:0.015789752826094627, decouple_loss:0.002302329521626234
loss_pred:0.015113914385437965, decouple_loss:0.002244672505185008
Iteration: 1857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651079177856445, gen p mean: -0.258171021938324, mean p set: 0.44708412885665894
loss_pred:0.015369254164397717, decouple_loss:0.0023088250309228897
The modified gen p mean: 0.44713547825813293, gen p mean: -0.25469085574150085, mean p set: 0.44771286845207214The modified gen p mean: 0.4466294050216675, gen p mean: -0.25536423921585083, mean p set: 0.44716131687164307
loss_pred:0.014956148341298103, decouple_loss:0.0023377619218081236
loss_pred:0.015535908751189709, decouple_loss:0.0023100306279957294
Iteration: 1858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717445969581604, gen p mean: -0.24595145881175995, mean p set: 0.4477542042732239
loss_pred:0.01564623974263668, decouple_loss:0.0024828468449413776
The modified gen p mean: 0.4478718340396881, gen p mean: -0.25524428486824036, mean p set: 0.44844114780426025
loss_pred:0.015299982391297817, decouple_loss:0.0024322797544300556
The modified gen p mean: 0.44823598861694336, gen p mean: -0.24990716576576233, mean p set: 0.44876447319984436
loss_pred:0.014688493683934212, decouple_loss:0.0025643811095505953
Iteration: 1859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473523497581482, gen p mean: -0.2533394694328308, mean p set: 0.4479331374168396
loss_pred:0.01518830843269825, decouple_loss:0.0022765437606722116
The modified gen p mean: 0.4468788802623749, gen p mean: -0.25060030817985535, mean p set: 0.4474574029445648
loss_pred:0.015265502966940403, decouple_loss:0.002130590844899416
The modified gen p mean: 0.4468722343444824, gen p mean: -0.25093695521354675, mean p set: 0.44739776849746704
loss_pred:0.014970309101045132, decouple_loss:0.0021529735531657934
Iteration: 1860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799813628196716, gen p mean: -0.25339969992637634, mean p set: 0.44858217239379883
loss_pred:0.014981456100940704, decouple_loss:0.0020483380649238825
The modified gen p mean: 0.4474395513534546, gen p mean: -0.24368014931678772, mean p set: 0.448009192943573
loss_pred:0.015496283769607544, decouple_loss:0.0021371811162680387
The modified gen p mean: 0.44669434428215027, gen p mean: -0.2466040402650833, mean p set: 0.44721704721450806
loss_pred:0.01477245893329382, decouple_loss:0.0022894698195159435
2023-04-27 06:17:13 testing...
The modified gen p mean: 0.4482196867465973, gen p mean: -0.2509647607803345, mean p set: 0.44879910349845886
loss_pred:0.01688322238624096, decouple_loss:0.002443232573568821
The modified gen p mean: 0.44929492473602295, gen p mean: -0.2539512813091278, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.254095196723938, mean p set: 0.4499112665653229loss_pred:0.01646060310304165, decouple_loss:0.002472701482474804
loss_pred:0.016937479376792908, decouple_loss:0.00251985271461308
WV_1_PC_1_EH_0_PS_30, loss: 0.016884364187717438, avg_mse: 0.02499203383922577
current test mse: 0.024992
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 1861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818180799484253, gen p mean: -0.248127281665802, mean p set: 0.44871124625205994
loss_pred:0.015155880711972713, decouple_loss:0.00245090713724494
The modified gen p mean: 0.44804325699806213, gen p mean: -0.25486913323402405, mean p set: 0.44861912727355957
The modified gen p mean: 0.44837579131126404, gen p mean: -0.25713756680488586, mean p set: 0.44895440340042114
loss_pred:0.015484319068491459, decouple_loss:0.002314402721822262
loss_pred:0.014877128414809704, decouple_loss:0.0023099409881979227
Iteration: 1862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485858976840973, gen p mean: -0.25815343856811523, mean p set: 0.4491156041622162
loss_pred:0.015429643914103508, decouple_loss:0.00212325481697917
The modified gen p mean: 0.44861146807670593, gen p mean: -0.25704434514045715, mean p set: 0.4491857588291168
The modified gen p mean: 0.4486699402332306, gen p mean: -0.25622087717056274, mean p set: 0.44925105571746826
loss_pred:0.015188154764473438, decouple_loss:0.002221934963017702
loss_pred:0.015359381213784218, decouple_loss:0.0021123038604855537
Iteration: 1863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492897391319275, gen p mean: -0.2542419135570526, mean p set: 0.44981372356414795
loss_pred:0.01472530048340559, decouple_loss:0.002212055493146181
The modified gen p mean: 0.4486830234527588, gen p mean: -0.2548091411590576, mean p set: 0.44926580786705017
The modified gen p mean: 0.44884809851646423, gen p mean: -0.25116369128227234, mean p set: 0.4494262933731079
loss_pred:0.015162434428930283, decouple_loss:0.002088428009301424
loss_pred:0.0158140379935503, decouple_loss:0.002226490993052721
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486287832260132, gen p mean: -0.25508058071136475, mean p set: 0.4492001235485077
loss_pred:0.014781909063458443, decouple_loss:0.0020454535260796547
The modified gen p mean: 0.4476276934146881, gen p mean: -0.2478744089603424, mean p set: 0.4482038617134094
loss_pred:0.015109819360077381, decouple_loss:0.0022086836397647858
The modified gen p mean: 0.44824445247650146, gen p mean: -0.25914230942726135, mean p set: 0.4487766921520233
loss_pred:0.015093526802957058, decouple_loss:0.0021592637058347464
Iteration: 1865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811615347862244, gen p mean: -0.25682610273361206, mean p set: 0.4486922323703766
loss_pred:0.015485212206840515, decouple_loss:0.002162793418392539
The modified gen p mean: 0.4481504261493683, gen p mean: -0.2589343786239624, mean p set: 0.4486764669418335The modified gen p mean: 0.4486793875694275, gen p mean: -0.2586797773838043, mean p set: 0.4492553174495697
loss_pred:0.014674137346446514, decouple_loss:0.002112793503329158
loss_pred:0.015051625669002533, decouple_loss:0.0021961184684187174
Iteration: 1866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485371708869934, gen p mean: -0.25380009412765503, mean p set: 0.44911760091781616
loss_pred:0.015216764993965626, decouple_loss:0.0021534410770982504
The modified gen p mean: 0.4476710855960846, gen p mean: -0.2513106167316437, mean p set: 0.4482443630695343
loss_pred:0.015624819323420525, decouple_loss:0.002032763324677944
The modified gen p mean: 0.4473877549171448, gen p mean: -0.25490623712539673, mean p set: 0.4479115903377533
loss_pred:0.01515422947704792, decouple_loss:0.0020416979677975178
Iteration: 1867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490503668785095, gen p mean: -0.25428760051727295, mean p set: 0.4496248662471771
loss_pred:0.015184429474174976, decouple_loss:0.002337959362193942
The modified gen p mean: 0.4487974941730499, gen p mean: -0.2526581585407257, mean p set: 0.44937053322792053
loss_pred:0.015311946161091328, decouple_loss:0.0022104622330516577
The modified gen p mean: 0.4481694996356964, gen p mean: -0.25310954451560974, mean p set: 0.4486883282661438
loss_pred:0.015218319371342659, decouple_loss:0.002186537254601717
Iteration: 1868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727927446365356, gen p mean: -0.250114381313324, mean p set: 0.44785305857658386
loss_pred:0.015217294916510582, decouple_loss:0.0020760123152285814
The modified gen p mean: 0.4485360085964203, gen p mean: -0.2529153525829315, mean p set: 0.44906941056251526The modified gen p mean: 0.44799360632896423, gen p mean: -0.2524144947528839, mean p set: 0.44856706261634827
loss_pred:0.015122735872864723, decouple_loss:0.002211883896961808
loss_pred:0.015163528732955456, decouple_loss:0.0021542496979236603
Iteration: 1869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715967774391174, gen p mean: -0.2533484101295471, mean p set: 0.4477364122867584
loss_pred:0.0153407733887434, decouple_loss:0.0022820387966930866
The modified gen p mean: 0.4466111361980438, gen p mean: -0.25445568561553955, mean p set: 0.44714176654815674The modified gen p mean: 0.44746339321136475, gen p mean: -0.25350168347358704, mean p set: 0.44804278016090393
loss_pred:0.015542170964181423, decouple_loss:0.00212207343429327
loss_pred:0.015177999623119831, decouple_loss:0.002262201625853777
Iteration: 1870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478507936000824, gen p mean: -0.25672823190689087, mean p set: 0.4484313726425171
loss_pred:0.015257388353347778, decouple_loss:0.0022204399574548006
The modified gen p mean: 0.4489421844482422, gen p mean: -0.2518443167209625, mean p set: 0.44951245188713074
loss_pred:0.01455081906169653, decouple_loss:0.002298057312145829
The modified gen p mean: 0.44715163111686707, gen p mean: -0.2516973316669464, mean p set: 0.4476754069328308
loss_pred:0.01499997265636921, decouple_loss:0.002096869982779026
2023-04-27 06:21:19 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2529171407222748, mean p set: 0.4499112665653229
loss_pred:0.01696569286286831, decouple_loss:0.002351720118895173
The modified gen p mean: 0.4492972195148468, gen p mean: -0.25269386172294617, mean p set: 0.4498290419578552
loss_pred:0.016453538089990616, decouple_loss:0.002223354298621416
The modified gen p mean: 0.4482174515724182, gen p mean: -0.25001055002212524, mean p set: 0.44879910349845886
loss_pred:0.01674262061715126, decouple_loss:0.002183582168072462
WV_1_PC_1_EH_0_PS_30, loss: 0.016833260655403137, avg_mse: 0.02491297759115696
current test mse: 0.024913
Iteration: 1871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841641187667847, gen p mean: -0.2583392560482025, mean p set: 0.44898921251296997
loss_pred:0.014688745141029358, decouple_loss:0.002297558356076479
The modified gen p mean: 0.4486728608608246, gen p mean: -0.2526150047779083, mean p set: 0.4492073655128479
loss_pred:0.014534585177898407, decouple_loss:0.002162219723686576
The modified gen p mean: 0.44858866930007935, gen p mean: -0.2527998983860016, mean p set: 0.44916975498199463
loss_pred:0.015539498068392277, decouple_loss:0.0020168772898614407
Iteration: 1872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482858180999756, gen p mean: -0.24785126745700836, mean p set: 0.4488137364387512
loss_pred:0.015259777195751667, decouple_loss:0.0021982735488563776
The modified gen p mean: 0.44829410314559937, gen p mean: -0.25490427017211914, mean p set: 0.44887199997901917
The modified gen p mean: 0.4479196071624756, gen p mean: -0.2540372610092163, mean p set: 0.4484924077987671
loss_pred:0.015045339241623878, decouple_loss:0.0021074183750897646
loss_pred:0.015292773023247719, decouple_loss:0.0023026110138744116
Iteration: 1873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486442804336548, gen p mean: -0.253396600484848, mean p set: 0.44917428493499756
loss_pred:0.014646762050688267, decouple_loss:0.0023098683450371027
The modified gen p mean: 0.44776010513305664, gen p mean: -0.25252565741539, mean p set: 0.4483354985713959
The modified gen p mean: 0.44846516847610474, gen p mean: -0.25442904233932495, mean p set: 0.4490397274494171
loss_pred:0.015230602584779263, decouple_loss:0.0022606928832829
loss_pred:0.015289656817913055, decouple_loss:0.002318152692168951
Iteration: 1874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803038239479065, gen p mean: -0.2580127418041229, mean p set: 0.44855865836143494
loss_pred:0.015131503343582153, decouple_loss:0.0021704421378672123
The modified gen p mean: 0.44830673933029175, gen p mean: -0.2568993866443634, mean p set: 0.4488835632801056
The modified gen p mean: 0.44796231389045715, gen p mean: -0.25724172592163086, mean p set: 0.44853806495666504
loss_pred:0.014448571018874645, decouple_loss:0.0021909549832344055
loss_pred:0.014771724119782448, decouple_loss:0.0021530049853026867
Iteration: 1875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44887974858283997, gen p mean: -0.25827455520629883, mean p set: 0.4494645595550537
loss_pred:0.015038968995213509, decouple_loss:0.0024427808821201324
The modified gen p mean: 0.4475439786911011, gen p mean: -0.2543465495109558, mean p set: 0.4480650722980499
The modified gen p mean: 0.44866693019866943, gen p mean: -0.2605474889278412, mean p set: 0.44924765825271606
loss_pred:0.014789320528507233, decouple_loss:0.0021500776056200266
loss_pred:0.014825818128883839, decouple_loss:0.0022572476882487535
Iteration: 1876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479546844959259, gen p mean: -0.2601504921913147, mean p set: 0.4485251009464264
loss_pred:0.015586940571665764, decouple_loss:0.002300719963386655
The modified gen p mean: 0.4473395347595215, gen p mean: -0.2486068308353424, mean p set: 0.447873055934906The modified gen p mean: 0.44853171706199646, gen p mean: -0.25554028153419495, mean p set: 0.44910410046577454
loss_pred:0.015407232567667961, decouple_loss:0.002157816896215081
loss_pred:0.01508253626525402, decouple_loss:0.0022832676768302917
Iteration: 1877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474130868911743, gen p mean: -0.25625166296958923, mean p set: 0.4479973018169403
loss_pred:0.015082377009093761, decouple_loss:0.0021697082556784153
The modified gen p mean: 0.4491611123085022, gen p mean: -0.2591787278652191, mean p set: 0.449685275554657The modified gen p mean: 0.4478950798511505, gen p mean: -0.25636616349220276, mean p set: 0.4484765827655792
loss_pred:0.015074710361659527, decouple_loss:0.0021323831751942635
loss_pred:0.015098407864570618, decouple_loss:0.0021365496795624495
Iteration: 1878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462626278400421, gen p mean: -0.2559867203235626, mean p set: 0.44683340191841125
loss_pred:0.015761947259306908, decouple_loss:0.0021546287462115288
The modified gen p mean: 0.4493718445301056, gen p mean: -0.2509134113788605, mean p set: 0.44995051622390747
loss_pred:0.015115231275558472, decouple_loss:0.00208765035495162
The modified gen p mean: 0.4487764835357666, gen p mean: -0.2605084478855133, mean p set: 0.44930675625801086
loss_pred:0.015041081234812737, decouple_loss:0.002045122906565666
Iteration: 1879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485374093055725, gen p mean: -0.2560124099254608, mean p set: 0.44910916686058044
loss_pred:0.015188089571893215, decouple_loss:0.002213067840784788
The modified gen p mean: 0.4494594931602478, gen p mean: -0.26119229197502136, mean p set: 0.45003825426101685
loss_pred:0.015010630711913109, decouple_loss:0.0020817755721509457
The modified gen p mean: 0.4495006799697876, gen p mean: -0.2585654556751251, mean p set: 0.450029194355011
loss_pred:0.01538019347935915, decouple_loss:0.0020351754501461983
Iteration: 1880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847342371940613, gen p mean: -0.2560385763645172, mean p set: 0.4490547776222229
loss_pred:0.014948598109185696, decouple_loss:0.0023716725409030914
The modified gen p mean: 0.44770386815071106, gen p mean: -0.25479865074157715, mean p set: 0.4482291042804718The modified gen p mean: 0.44778600335121155, gen p mean: -0.25224775075912476, mean p set: 0.4483604431152344
loss_pred:0.015111375600099564, decouple_loss:0.002363293431699276
loss_pred:0.015004563145339489, decouple_loss:0.0022278300020843744
2023-04-27 06:24:44 testing...
The modified gen p mean: 0.44822466373443604, gen p mean: -0.25613948702812195, mean p set: 0.44879910349845886
loss_pred:0.016789717599749565, decouple_loss:0.0022583487443625927
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2586350440979004, mean p set: 0.4499112665653229
loss_pred:0.01701272279024124, decouple_loss:0.0023392941802740097
The modified gen p mean: 0.44930046796798706, gen p mean: -0.25892454385757446, mean p set: 0.4498290419578552
loss_pred:0.016500167548656464, decouple_loss:0.002241747220978141
WV_1_PC_1_EH_0_PS_30, loss: 0.01688152551651001, avg_mse: 0.024952460080385208
current test mse: 0.024952
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 1881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759485125541687, gen p mean: -0.2550200819969177, mean p set: 0.4481230676174164
loss_pred:0.015023608691990376, decouple_loss:0.0025252029299736023
The modified gen p mean: 0.4483630657196045, gen p mean: -0.25106456875801086, mean p set: 0.44894805550575256
loss_pred:0.015100371092557907, decouple_loss:0.0022956407628953457
The modified gen p mean: 0.448345422744751, gen p mean: -0.2634471356868744, mean p set: 0.44891637563705444
loss_pred:0.015185019932687283, decouple_loss:0.002311653457581997
Iteration: 1882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739821553230286, gen p mean: -0.261623740196228, mean p set: 0.4479316174983978
loss_pred:0.015585855580866337, decouple_loss:0.0023297190200537443
The modified gen p mean: 0.44693806767463684, gen p mean: -0.26158466935157776, mean p set: 0.4475100636482239
loss_pred:0.014778309501707554, decouple_loss:0.0021818478126078844
The modified gen p mean: 0.4487816095352173, gen p mean: -0.26392361521720886, mean p set: 0.44935348629951477
loss_pred:0.015028764493763447, decouple_loss:0.002225977834314108
Iteration: 1883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487983286380768, gen p mean: -0.2700536847114563, mean p set: 0.44932815432548523
loss_pred:0.014674908481538296, decouple_loss:0.002310920273885131
The modified gen p mean: 0.44732123613357544, gen p mean: -0.26275455951690674, mean p set: 0.4478953182697296
loss_pred:0.014744910411536694, decouple_loss:0.0022167989518493414
The modified gen p mean: 0.4482336938381195, gen p mean: -0.25924715399742126, mean p set: 0.44880932569503784
loss_pred:0.015106038190424442, decouple_loss:0.002352688228711486
Iteration: 1884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484013020992279, gen p mean: -0.2617470920085907, mean p set: 0.44892609119415283
loss_pred:0.014694344252347946, decouple_loss:0.0025012108962982893
The modified gen p mean: 0.44927269220352173, gen p mean: -0.26404911279678345, mean p set: 0.44984567165374756
loss_pred:0.01503471564501524, decouple_loss:0.002340925158932805
The modified gen p mean: 0.44805240631103516, gen p mean: -0.25897687673568726, mean p set: 0.448621928691864
loss_pred:0.015161710791289806, decouple_loss:0.00246270839124918
Iteration: 1885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486260712146759, gen p mean: -0.26408469676971436, mean p set: 0.4492042660713196
loss_pred:0.014206509105861187, decouple_loss:0.0024812582414597273
The modified gen p mean: 0.44844406843185425, gen p mean: -0.2550923526287079, mean p set: 0.44902175664901733The modified gen p mean: 0.44875863194465637, gen p mean: -0.26575642824172974, mean p set: 0.4492855668067932
loss_pred:0.015183834359049797, decouple_loss:0.0023049269802868366
loss_pred:0.014494260773062706, decouple_loss:0.002338855993002653
Iteration: 1886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488045871257782, gen p mean: -0.2631947994232178, mean p set: 0.44937342405319214
loss_pred:0.014483124017715454, decouple_loss:0.002661194419488311
The modified gen p mean: 0.44669726490974426, gen p mean: -0.25547295808792114, mean p set: 0.44727620482444763The modified gen p mean: 0.44969671964645386, gen p mean: -0.25464364886283875, mean p set: 0.4502216577529907
loss_pred:0.015106222592294216, decouple_loss:0.0025452959816902876
loss_pred:0.015137262642383575, decouple_loss:0.0025778196286410093
Iteration: 1887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807642698287964, gen p mean: -0.24563956260681152, mean p set: 0.448650062084198
loss_pred:0.014737257733941078, decouple_loss:0.0028978034388273954
The modified gen p mean: 0.4480615258216858, gen p mean: -0.2523472011089325, mean p set: 0.44863688945770264The modified gen p mean: 0.44816720485687256, gen p mean: -0.2523152232170105, mean p set: 0.4486970603466034
loss_pred:0.014360437169671059, decouple_loss:0.0028349815402179956
loss_pred:0.01520500611513853, decouple_loss:0.002788640558719635
Iteration: 1888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447933167219162, gen p mean: -0.24875442683696747, mean p set: 0.448505699634552
loss_pred:0.014671086333692074, decouple_loss:0.002429434098303318
The modified gen p mean: 0.44737640023231506, gen p mean: -0.241933211684227, mean p set: 0.4479077458381653The modified gen p mean: 0.44832152128219604, gen p mean: -0.25339052081108093, mean p set: 0.44889357686042786
loss_pred:0.01460812147706747, decouple_loss:0.0022373106330633163
loss_pred:0.014421327970921993, decouple_loss:0.0025888620875775814
Iteration: 1889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889169931411743, gen p mean: -0.24718454480171204, mean p set: 0.4494667053222656
loss_pred:0.014099626801908016, decouple_loss:0.0030815615318715572
The modified gen p mean: 0.44806450605392456, gen p mean: -0.2547365128993988, mean p set: 0.4486437141895294
loss_pred:0.014687374234199524, decouple_loss:0.0028156605549156666
The modified gen p mean: 0.44684553146362305, gen p mean: -0.24941888451576233, mean p set: 0.44738414883613586
loss_pred:0.0153529467061162, decouple_loss:0.002977212658151984
Iteration: 1890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45047587156295776, gen p mean: -0.2530480623245239, mean p set: 0.4510541558265686
loss_pred:0.014673865400254726, decouple_loss:0.0029071499593555927
The modified gen p mean: 0.4476832151412964, gen p mean: -0.2461046725511551, mean p set: 0.4482152760028839The modified gen p mean: 0.4492586851119995, gen p mean: -0.2472703754901886, mean p set: 0.44984006881713867
loss_pred:0.015208949334919453, decouple_loss:0.00291558844037354
loss_pred:0.014856822788715363, decouple_loss:0.0027874428778886795
2023-04-27 06:28:48 testing...
The modified gen p mean: 0.44822579622268677, gen p mean: -0.24805200099945068, mean p set: 0.44879910349845886
loss_pred:0.01684042438864708, decouple_loss:0.0027929143980145454
The modified gen p mean: 0.4494309425354004, gen p mean: -0.250352680683136, mean p set: 0.4499112665653229
loss_pred:0.017021438106894493, decouple_loss:0.0029118740931153297
The modified gen p mean: 0.4492960572242737, gen p mean: -0.25074303150177, mean p set: 0.4498290419578552
loss_pred:0.016510505229234695, decouple_loss:0.002922036685049534
WV_1_PC_1_EH_0_PS_30, loss: 0.01693456992506981, avg_mse: 0.025117997080087662
current test mse: 0.025118
Iteration: 1891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825634360313416, gen p mean: -0.24750171601772308, mean p set: 0.44881969690322876
loss_pred:0.015307140536606312, decouple_loss:0.0026002642698585987
The modified gen p mean: 0.44851911067962646, gen p mean: -0.24534961581230164, mean p set: 0.44909510016441345
loss_pred:0.01482178270816803, decouple_loss:0.002741529606282711
The modified gen p mean: 0.4467736780643463, gen p mean: -0.25013893842697144, mean p set: 0.44730088114738464
loss_pred:0.014925728552043438, decouple_loss:0.0026237096171826124
Iteration: 1892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478243291378021, gen p mean: -0.24979329109191895, mean p set: 0.4483504593372345
loss_pred:0.014579198323190212, decouple_loss:0.002610082970932126
The modified gen p mean: 0.44796067476272583, gen p mean: -0.24505583941936493, mean p set: 0.4485420286655426
loss_pred:0.015068297274410725, decouple_loss:0.0026229112409055233
The modified gen p mean: 0.44786372780799866, gen p mean: -0.24826198816299438, mean p set: 0.44843941926956177
loss_pred:0.014632632955908775, decouple_loss:0.002612717216834426
Iteration: 1893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719967246055603, gen p mean: -0.2446468025445938, mean p set: 0.4477311074733734
loss_pred:0.014901511371135712, decouple_loss:0.0024167003575712442
The modified gen p mean: 0.44755879044532776, gen p mean: -0.2488001137971878, mean p set: 0.4481446146965027
loss_pred:0.015753556042909622, decouple_loss:0.0025564441457390785
The modified gen p mean: 0.44765663146972656, gen p mean: -0.24031327664852142, mean p set: 0.44823071360588074
loss_pred:0.014456764794886112, decouple_loss:0.002828906988725066
Iteration: 1894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842445850372314, gen p mean: -0.24406714737415314, mean p set: 0.4489465653896332
loss_pred:0.014691468328237534, decouple_loss:0.0025925636291503906
The modified gen p mean: 0.4503994882106781, gen p mean: -0.25115522742271423, mean p set: 0.45098060369491577
loss_pred:0.014661571942269802, decouple_loss:0.002515990985557437
The modified gen p mean: 0.4483563303947449, gen p mean: -0.2500695288181305, mean p set: 0.4489334523677826
loss_pred:0.01445182878524065, decouple_loss:0.0025120696518570185
Iteration: 1895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490679204463959, gen p mean: -0.24440228939056396, mean p set: 0.4496456980705261
loss_pred:0.014110840857028961, decouple_loss:0.0027078313287347555
The modified gen p mean: 0.4480646252632141, gen p mean: -0.23899871110916138, mean p set: 0.44864022731781006The modified gen p mean: 0.44820037484169006, gen p mean: -0.24511148035526276, mean p set: 0.44872117042541504
loss_pred:0.015000405721366405, decouple_loss:0.00270180799998343
loss_pred:0.015127458609640598, decouple_loss:0.0024483553133904934
Iteration: 1896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448142409324646, gen p mean: -0.24997681379318237, mean p set: 0.44871968030929565
loss_pred:0.01425953209400177, decouple_loss:0.0023405803367495537
The modified gen p mean: 0.4484356939792633, gen p mean: -0.24297048151493073, mean p set: 0.44901901483535767The modified gen p mean: 0.44755426049232483, gen p mean: -0.24667459726333618, mean p set: 0.4480842351913452
loss_pred:0.015089048072695732, decouple_loss:0.0024772805627435446
loss_pred:0.014481253921985626, decouple_loss:0.0024429343175143003
Iteration: 1897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489256739616394, gen p mean: -0.24633699655532837, mean p set: 0.4495035707950592
loss_pred:0.01416020467877388, decouple_loss:0.0025037333834916353
The modified gen p mean: 0.4483325183391571, gen p mean: -0.2517457902431488, mean p set: 0.4488562345504761The modified gen p mean: 0.4488500654697418, gen p mean: -0.24540449678897858, mean p set: 0.4494239091873169
loss_pred:0.014058150351047516, decouple_loss:0.0024317994248121977
loss_pred:0.014946549199521542, decouple_loss:0.0023667779751122
Iteration: 1898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485403597354889, gen p mean: -0.2514689266681671, mean p set: 0.4491152763366699
loss_pred:0.0144192511215806, decouple_loss:0.0024019042029976845
The modified gen p mean: 0.44765719771385193, gen p mean: -0.24525615572929382, mean p set: 0.448231041431427
loss_pred:0.014781327918171883, decouple_loss:0.002481904113665223
The modified gen p mean: 0.4475688338279724, gen p mean: -0.248741015791893, mean p set: 0.4480955898761749
loss_pred:0.01506622601300478, decouple_loss:0.0023457822389900684
Iteration: 1899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489596486091614, gen p mean: -0.2482641041278839, mean p set: 0.449531614780426
loss_pred:0.014931965619325638, decouple_loss:0.002821115544065833
The modified gen p mean: 0.44929710030555725, gen p mean: -0.2538728713989258, mean p set: 0.4498688280582428
loss_pred:0.014383826404809952, decouple_loss:0.0028353948146104813
The modified gen p mean: 0.4479769170284271, gen p mean: -0.252663254737854, mean p set: 0.4484964609146118
loss_pred:0.014336631633341312, decouple_loss:0.0028844475746154785
Iteration: 1900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471631348133087, gen p mean: -0.2499946504831314, mean p set: 0.4477364122867584
loss_pred:0.014746497385203838, decouple_loss:0.002640817081555724
The modified gen p mean: 0.44811511039733887, gen p mean: -0.25016629695892334, mean p set: 0.44869375228881836
loss_pred:0.014861301518976688, decouple_loss:0.002411430701613426
The modified gen p mean: 0.4488826096057892, gen p mean: -0.2540745437145233, mean p set: 0.4494134187698364
loss_pred:0.014256181195378304, decouple_loss:0.002688684267923236
2023-04-27 06:32:12 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25277069211006165, mean p set: 0.4499112665653229
loss_pred:0.01706608757376671, decouple_loss:0.002696536248549819
The modified gen p mean: 0.4482164978981018, gen p mean: -0.25041186809539795, mean p set: 0.44879910349845886
loss_pred:0.016903148964047432, decouple_loss:0.0027224142104387283
The modified gen p mean: 0.449307382106781, gen p mean: -0.2531944811344147, mean p set: 0.4498290419578552
loss_pred:0.01659081131219864, decouple_loss:0.0027119149453938007
WV_1_PC_1_EH_0_PS_30, loss: 0.016988864168524742, avg_mse: 0.02517908252775669
current test mse: 0.025179
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 1901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486699402332306, gen p mean: -0.2468663454055786, mean p set: 0.44919851422309875
loss_pred:0.014714590273797512, decouple_loss:0.002906360663473606
The modified gen p mean: 0.4493151009082794, gen p mean: -0.24893885850906372, mean p set: 0.44988885521888733
loss_pred:0.01510128378868103, decouple_loss:0.0028155266772955656
The modified gen p mean: 0.447182834148407, gen p mean: -0.2573516368865967, mean p set: 0.44775673747062683
loss_pred:0.014171798713505268, decouple_loss:0.00324597442522645
Iteration: 1902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791683554649353, gen p mean: -0.2543399930000305, mean p set: 0.44844454526901245
loss_pred:0.014323986135423183, decouple_loss:0.002516439650207758
The modified gen p mean: 0.448241651058197, gen p mean: -0.2514392137527466, mean p set: 0.4488143026828766
The modified gen p mean: 0.4501108229160309, gen p mean: -0.25479042530059814, mean p set: 0.450685054063797
loss_pred:0.014743441715836525, decouple_loss:0.0026160988491028547
loss_pred:0.014975781552493572, decouple_loss:0.002580736530944705
Iteration: 1903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835951924324036, gen p mean: -0.2489284873008728, mean p set: 0.4488862454891205
loss_pred:0.015048998408019543, decouple_loss:0.0023186567705124617
The modified gen p mean: 0.44642436504364014, gen p mean: -0.2608369290828705, mean p set: 0.446990966796875The modified gen p mean: 0.4486924409866333, gen p mean: -0.2572706937789917, mean p set: 0.4492718279361725
loss_pred:0.014984332025051117, decouple_loss:0.0023326952941715717
loss_pred:0.015072057954967022, decouple_loss:0.0022698398679494858
Iteration: 1904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930216670036316, gen p mean: -0.240730419754982, mean p set: 0.44983553886413574
loss_pred:0.014680054970085621, decouple_loss:0.003305780701339245
The modified gen p mean: 0.44815829396247864, gen p mean: -0.25050264596939087, mean p set: 0.4487343728542328The modified gen p mean: 0.44722214341163635, gen p mean: -0.2463732361793518, mean p set: 0.44780102372169495
loss_pred:0.015530643053352833, decouple_loss:0.0026852514129132032
loss_pred:0.015373853035271168, decouple_loss:0.002570027019828558
Iteration: 1905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864362478256226, gen p mean: -0.23864266276359558, mean p set: 0.4492274820804596
The modified gen p mean: 0.4463081359863281, gen p mean: -0.250950425863266, mean p set: 0.4468747675418854
loss_pred:0.014437057077884674, decouple_loss:0.0026822348590940237
loss_pred:0.014917350374162197, decouple_loss:0.002361898310482502
The modified gen p mean: 0.4485847055912018, gen p mean: -0.2448383867740631, mean p set: 0.4491168260574341
loss_pred:0.015093551017343998, decouple_loss:0.0024801380932331085
Iteration: 1906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477924704551697, gen p mean: -0.2481624037027359, mean p set: 0.44836726784706116
The modified gen p mean: 0.44757404923439026, gen p mean: -0.2408592253923416, mean p set: 0.4481477439403534
loss_pred:0.014092620462179184, decouple_loss:0.0028172829188406467
loss_pred:0.014723221771419048, decouple_loss:0.0026002053637057543
The modified gen p mean: 0.4484574496746063, gen p mean: -0.23695197701454163, mean p set: 0.44898515939712524
loss_pred:0.014664527028799057, decouple_loss:0.002551364479586482
Iteration: 1907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669631123542786, gen p mean: -0.24425145983695984, mean p set: 0.4472724497318268
loss_pred:0.014684750698506832, decouple_loss:0.0025756671093404293
The modified gen p mean: 0.44800078868865967, gen p mean: -0.24193893373012543, mean p set: 0.4485826790332794
loss_pred:0.014562227763235569, decouple_loss:0.0025431697722524405
The modified gen p mean: 0.44770506024360657, gen p mean: -0.24520812928676605, mean p set: 0.4482307732105255
loss_pred:0.014404205605387688, decouple_loss:0.0025278772227466106
Iteration: 1908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463943541049957, gen p mean: -0.2502974271774292, mean p set: 0.44696733355522156
loss_pred:0.014500664547085762, decouple_loss:0.0024490291252732277
The modified gen p mean: 0.450790673494339, gen p mean: -0.24663305282592773, mean p set: 0.4513660967350006
loss_pred:0.014650481753051281, decouple_loss:0.002542944625020027
The modified gen p mean: 0.44842109084129333, gen p mean: -0.24658194184303284, mean p set: 0.44895556569099426
loss_pred:0.015201455913484097, decouple_loss:0.0024709126446396112
Iteration: 1909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446975976228714, gen p mean: -0.254356324672699, mean p set: 0.44755133986473083
loss_pred:0.013944887556135654, decouple_loss:0.0030303369276225567
The modified gen p mean: 0.44856342673301697, gen p mean: -0.23844458162784576, mean p set: 0.44913890957832336
loss_pred:0.014589565806090832, decouple_loss:0.0029361590277403593
The modified gen p mean: 0.4477880597114563, gen p mean: -0.24764740467071533, mean p set: 0.44830387830734253
loss_pred:0.015677491202950478, decouple_loss:0.002437034621834755
Iteration: 1910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486284554004669, gen p mean: -0.24711105227470398, mean p set: 0.44920095801353455
loss_pred:0.014499876648187637, decouple_loss:0.0026409293059259653
The modified gen p mean: 0.4479582905769348, gen p mean: -0.2510983943939209, mean p set: 0.4485265016555786
loss_pred:0.01404548529535532, decouple_loss:0.002586057875305414
The modified gen p mean: 0.44904249906539917, gen p mean: -0.25634828209877014, mean p set: 0.4495646357536316
loss_pred:0.01469515636563301, decouple_loss:0.0023421591613441706
2023-04-27 06:36:14 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2514011263847351, mean p set: 0.4499112665653229
loss_pred:0.01698501780629158, decouple_loss:0.002731539774686098
The modified gen p mean: 0.4492984414100647, gen p mean: -0.25164178013801575, mean p set: 0.4498290419578552
loss_pred:0.01655072160065174, decouple_loss:0.002758908784016967
The modified gen p mean: 0.44822266697883606, gen p mean: -0.24893790483474731, mean p set: 0.44879910349845886
loss_pred:0.01689487136900425, decouple_loss:0.002750361105427146
WV_1_PC_1_EH_0_PS_30, loss: 0.0169475506991148, avg_mse: 0.025029269978404045
current test mse: 0.025029
Iteration: 1911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485136866569519, gen p mean: -0.2544461488723755, mean p set: 0.4490965008735657
loss_pred:0.01504986360669136, decouple_loss:0.0027483084704726934
The modified gen p mean: 0.44738730788230896, gen p mean: -0.25171104073524475, mean p set: 0.44796544313430786
loss_pred:0.01471108477562666, decouple_loss:0.0026926586870104074
The modified gen p mean: 0.45013248920440674, gen p mean: -0.2545539140701294, mean p set: 0.45066288113594055
loss_pred:0.01447127852588892, decouple_loss:0.00276504666544497
Iteration: 1912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753727316856384, gen p mean: -0.25188830494880676, mean p set: 0.4480714499950409
loss_pred:0.014129933901131153, decouple_loss:0.0024193022400140762
The modified gen p mean: 0.44827893376350403, gen p mean: -0.247041255235672, mean p set: 0.44885557889938354
The modified gen p mean: 0.4481959640979767, gen p mean: -0.24957069754600525, mean p set: 0.44876742362976074
loss_pred:0.014410369098186493, decouple_loss:0.0023958731908351183
loss_pred:0.014842810109257698, decouple_loss:0.002544773044064641
Iteration: 1913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821423292160034, gen p mean: -0.2544408142566681, mean p set: 0.4487411379814148
loss_pred:0.014098424464464188, decouple_loss:0.0026997276581823826
The modified gen p mean: 0.44825759530067444, gen p mean: -0.24622397124767303, mean p set: 0.44883567094802856
The modified gen p mean: 0.4482477307319641, gen p mean: -0.25637415051460266, mean p set: 0.4488264322280884
loss_pred:0.014956754632294178, decouple_loss:0.002568410011008382
loss_pred:0.014458945021033287, decouple_loss:0.0026229533832520247
Iteration: 1914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478744864463806, gen p mean: -0.2520727515220642, mean p set: 0.448408842086792
loss_pred:0.014933651313185692, decouple_loss:0.0027791999746114016
The modified gen p mean: 0.4460631012916565, gen p mean: -0.25604578852653503, mean p set: 0.44663533568382263The modified gen p mean: 0.446464866399765, gen p mean: -0.2556794285774231, mean p set: 0.44704070687294006
loss_pred:0.01457255519926548, decouple_loss:0.0023491119500249624
loss_pred:0.014161130413413048, decouple_loss:0.0023010249715298414
Iteration: 1915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866323471069336, gen p mean: -0.24910250306129456, mean p set: 0.4492388665676117
loss_pred:0.01424506027251482, decouple_loss:0.0022678878158330917
The modified gen p mean: 0.4474688768386841, gen p mean: -0.25650984048843384, mean p set: 0.44804564118385315
loss_pred:0.014781994745135307, decouple_loss:0.0021610173862427473
The modified gen p mean: 0.4480617344379425, gen p mean: -0.253621369600296, mean p set: 0.4485855996608734
loss_pred:0.014794050715863705, decouple_loss:0.0022360454313457012
Iteration: 1916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866758584976196, gen p mean: -0.2398657649755478, mean p set: 0.4492424428462982
loss_pred:0.014430604875087738, decouple_loss:0.002612444804981351
The modified gen p mean: 0.4476829469203949, gen p mean: -0.2440280169248581, mean p set: 0.4482579529285431
loss_pred:0.01454736664891243, decouple_loss:0.002389452187344432
The modified gen p mean: 0.4495745599269867, gen p mean: -0.2527559697628021, mean p set: 0.4501021206378937
loss_pred:0.014598348177969456, decouple_loss:0.0024490589275956154
Iteration: 1917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818928837776184, gen p mean: -0.250572144985199, mean p set: 0.4487667679786682
The modified gen p mean: 0.4475117623806, gen p mean: -0.2426518350839615, mean p set: 0.44809263944625854
loss_pred:0.01473244559019804, decouple_loss:0.002319531748071313
loss_pred:0.014214938506484032, decouple_loss:0.002502743387594819
The modified gen p mean: 0.4477415084838867, gen p mean: -0.24685683846473694, mean p set: 0.4482734203338623
loss_pred:0.01440898422151804, decouple_loss:0.002288098679855466
Iteration: 1918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796404242515564, gen p mean: -0.24067352712154388, mean p set: 0.44854292273521423
loss_pred:0.014417223632335663, decouple_loss:0.0021204818040132523
The modified gen p mean: 0.4477700889110565, gen p mean: -0.24633002281188965, mean p set: 0.4483499228954315
loss_pred:0.014516772702336311, decouple_loss:0.002098014112561941
The modified gen p mean: 0.44813522696495056, gen p mean: -0.25057122111320496, mean p set: 0.4486563205718994
loss_pred:0.014064768329262733, decouple_loss:0.002136281691491604
Iteration: 1919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487365782260895, gen p mean: -0.24421335756778717, mean p set: 0.449319064617157
loss_pred:0.014622489921748638, decouple_loss:0.0023560049012303352
The modified gen p mean: 0.44913968443870544, gen p mean: -0.2526082694530487, mean p set: 0.44971415400505066
loss_pred:0.014935796149075031, decouple_loss:0.0026718368753790855
The modified gen p mean: 0.44826847314834595, gen p mean: -0.24893693625926971, mean p set: 0.44879457354545593
loss_pred:0.01452657487243414, decouple_loss:0.0025001561734825373
Iteration: 1920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448091596364975, gen p mean: -0.25186753273010254, mean p set: 0.44866693019866943
loss_pred:0.014558244496583939, decouple_loss:0.0022567068226635456
The modified gen p mean: 0.44729283452033997, gen p mean: -0.25669798254966736, mean p set: 0.4478631317615509
loss_pred:0.014734940603375435, decouple_loss:0.0021853663492947817
The modified gen p mean: 0.4474961459636688, gen p mean: -0.2528741955757141, mean p set: 0.4480225145816803
loss_pred:0.015163686126470566, decouple_loss:0.002336781704798341
2023-04-27 06:39:38 testing...
The modified gen p mean: 0.44822779297828674, gen p mean: -0.25165611505508423, mean p set: 0.44879910349845886
loss_pred:0.016904808580875397, decouple_loss:0.002424388425424695
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2542729675769806, mean p set: 0.4499112665653229
loss_pred:0.01698542758822441, decouple_loss:0.0027067663613706827
The modified gen p mean: 0.4493015706539154, gen p mean: -0.2546647787094116, mean p set: 0.4498290419578552
loss_pred:0.016582278534770012, decouple_loss:0.002478198613971472
WV_1_PC_1_EH_0_PS_30, loss: 0.016950994729995728, avg_mse: 0.025149721652269363
current test mse: 0.02515
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 1921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476388096809387, gen p mean: -0.25639069080352783, mean p set: 0.44817429780960083
loss_pred:0.015840385109186172, decouple_loss:0.0029210459906607866
The modified gen p mean: 0.44751811027526855, gen p mean: -0.25095003843307495, mean p set: 0.4480918347835541
loss_pred:0.016188308596611023, decouple_loss:0.002421874552965164
The modified gen p mean: 0.4476477801799774, gen p mean: -0.2543725073337555, mean p set: 0.44822028279304504
loss_pred:0.01551756914705038, decouple_loss:0.0030699586495757103
Iteration: 1922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811365008354187, gen p mean: -0.2556614577770233, mean p set: 0.44864028692245483
loss_pred:0.015894101932644844, decouple_loss:0.002490727696567774
The modified gen p mean: 0.44613465666770935, gen p mean: -0.25474438071250916, mean p set: 0.44670602679252625
loss_pred:0.016056692227721214, decouple_loss:0.0026858197525143623
The modified gen p mean: 0.44732823967933655, gen p mean: -0.25729408860206604, mean p set: 0.4479072690010071
loss_pred:0.01507460605353117, decouple_loss:0.002330880844965577
Iteration: 1923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481143355369568, gen p mean: -0.2559164762496948, mean p set: 0.4486437737941742
loss_pred:0.015274989418685436, decouple_loss:0.0023778341710567474
The modified gen p mean: 0.44650787115097046, gen p mean: -0.25567492842674255, mean p set: 0.4470870792865753
loss_pred:0.015957100316882133, decouple_loss:0.0028184412512928247
The modified gen p mean: 0.4469946026802063, gen p mean: -0.25674086809158325, mean p set: 0.4475705623626709
loss_pred:0.014979523606598377, decouple_loss:0.002488260855898261
Iteration: 1924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719216227531433, gen p mean: -0.253866583108902, mean p set: 0.44771599769592285
loss_pred:0.01526261679828167, decouple_loss:0.002489270642399788
The modified gen p mean: 0.44920793175697327, gen p mean: -0.2596818804740906, mean p set: 0.4497888684272766
loss_pred:0.015144329518079758, decouple_loss:0.002433267654851079
The modified gen p mean: 0.4465518295764923, gen p mean: -0.2603054642677307, mean p set: 0.4471310079097748
loss_pred:0.0149556128308177, decouple_loss:0.0022683870047330856
Iteration: 1925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481709897518158, gen p mean: -0.2628532350063324, mean p set: 0.4487501382827759
loss_pred:0.015152012929320335, decouple_loss:0.0022201358806341887
The modified gen p mean: 0.447127103805542, gen p mean: -0.2571820616722107, mean p set: 0.4476999342441559
loss_pred:0.015477864071726799, decouple_loss:0.0022625261917710304
The modified gen p mean: 0.4481566250324249, gen p mean: -0.2568555772304535, mean p set: 0.44868743419647217
loss_pred:0.015316741541028023, decouple_loss:0.0023531527258455753
Iteration: 1926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785717129707336, gen p mean: -0.25863927602767944, mean p set: 0.4484269320964813
loss_pred:0.015145969577133656, decouple_loss:0.002273587044328451
The modified gen p mean: 0.44666987657546997, gen p mean: -0.26239481568336487, mean p set: 0.4472491443157196
loss_pred:0.015463692136108875, decouple_loss:0.0025788643397390842
The modified gen p mean: 0.44730764627456665, gen p mean: -0.2586100101470947, mean p set: 0.4478357136249542
loss_pred:0.015464612282812595, decouple_loss:0.0023692231625318527
Iteration: 1927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481443166732788, gen p mean: -0.25563284754753113, mean p set: 0.44871804118156433
loss_pred:0.015297405421733856, decouple_loss:0.002208755351603031
The modified gen p mean: 0.4480190873146057, gen p mean: -0.2567901611328125, mean p set: 0.4485948383808136
loss_pred:0.01541889738291502, decouple_loss:0.0021612788550555706
The modified gen p mean: 0.4472922086715698, gen p mean: -0.255353718996048, mean p set: 0.4478200376033783
loss_pred:0.015898335725069046, decouple_loss:0.002212204970419407
Iteration: 1928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471982717514038, gen p mean: -0.25961926579475403, mean p set: 0.4477703869342804
loss_pred:0.015835335478186607, decouple_loss:0.0024931919761002064
The modified gen p mean: 0.44734451174736023, gen p mean: -0.2533179223537445, mean p set: 0.4479181170463562
loss_pred:0.01531927939504385, decouple_loss:0.002326151356101036
The modified gen p mean: 0.4478900730609894, gen p mean: -0.2542092800140381, mean p set: 0.44842514395713806
loss_pred:0.015612282790243626, decouple_loss:0.0025008947122842073
Iteration: 1929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446710467338562, gen p mean: -0.2559936046600342, mean p set: 0.44728556275367737
loss_pred:0.01611829735338688, decouple_loss:0.002437025075778365
The modified gen p mean: 0.447734534740448, gen p mean: -0.2550780475139618, mean p set: 0.4483122229576111
loss_pred:0.015127161517739296, decouple_loss:0.0021659061312675476
The modified gen p mean: 0.44749927520751953, gen p mean: -0.25434771180152893, mean p set: 0.44802361726760864
loss_pred:0.015119938179850578, decouple_loss:0.002279688371345401
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785642623901367, gen p mean: -0.2596849799156189, mean p set: 0.44843074679374695
loss_pred:0.015425446443259716, decouple_loss:0.0023980510886758566
The modified gen p mean: 0.44804924726486206, gen p mean: -0.2566935122013092, mean p set: 0.44862401485443115
loss_pred:0.015733767300844193, decouple_loss:0.002417086623609066
The modified gen p mean: 0.44713884592056274, gen p mean: -0.25678497552871704, mean p set: 0.4476657211780548
loss_pred:0.015043682418763638, decouple_loss:0.0026085597928613424
2023-04-27 06:43:47 testing...
The modified gen p mean: 0.4482170641422272, gen p mean: -0.25833019614219666, mean p set: 0.44879910349845886
loss_pred:0.01682264171540737, decouple_loss:0.002370215021073818
The modified gen p mean: 0.4494309425354004, gen p mean: -0.26116886734962463, mean p set: 0.4499112665653229
loss_pred:0.016920654103159904, decouple_loss:0.0024561891332268715
The modified gen p mean: 0.44929900765419006, gen p mean: -0.2613462805747986, mean p set: 0.4498290419578552
loss_pred:0.016431134194135666, decouple_loss:0.002369288355112076
WV_1_PC_1_EH_0_PS_30, loss: 0.0168447382748127, avg_mse: 0.024948490783572197
current test mse: 0.024948
Iteration: 1931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770699739456177, gen p mean: -0.2618306577205658, mean p set: 0.4482831358909607
loss_pred:0.01555714663118124, decouple_loss:0.0023445244878530502
The modified gen p mean: 0.4471830725669861, gen p mean: -0.2599370777606964, mean p set: 0.4477572739124298
loss_pred:0.016028814017772675, decouple_loss:0.002485052216798067
The modified gen p mean: 0.4471961259841919, gen p mean: -0.2620624005794525, mean p set: 0.4477294087409973
loss_pred:0.016307935118675232, decouple_loss:0.0022442457266151905
Iteration: 1932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468374252319336, gen p mean: -0.2579650580883026, mean p set: 0.44736430048942566
loss_pred:0.01542571745812893, decouple_loss:0.002484059426933527
The modified gen p mean: 0.44766566157341003, gen p mean: -0.26211830973625183, mean p set: 0.4482421875
loss_pred:0.015117059461772442, decouple_loss:0.0023693800903856754
The modified gen p mean: 0.4482302963733673, gen p mean: -0.26185205578804016, mean p set: 0.44880321621894836
loss_pred:0.015583055093884468, decouple_loss:0.002534835832193494
Iteration: 1933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675254821777344, gen p mean: -0.26497882604599, mean p set: 0.4472888708114624
loss_pred:0.01532836351543665, decouple_loss:0.0024054080713540316
The modified gen p mean: 0.44690394401550293, gen p mean: -0.25968900322914124, mean p set: 0.44747352600097656
loss_pred:0.015471667982637882, decouple_loss:0.002326321555301547
The modified gen p mean: 0.4472407400608063, gen p mean: -0.25804615020751953, mean p set: 0.44782111048698425
loss_pred:0.015723926946520805, decouple_loss:0.0024105128832161427
Iteration: 1934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467853009700775, gen p mean: -0.25332382321357727, mean p set: 0.4473079442977905
loss_pred:0.015400082804262638, decouple_loss:0.0026265440974384546
The modified gen p mean: 0.44727790355682373, gen p mean: -0.257428914308548, mean p set: 0.4478473961353302
loss_pred:0.015781663358211517, decouple_loss:0.002275648759678006
The modified gen p mean: 0.44651415944099426, gen p mean: -0.2623862028121948, mean p set: 0.44708749651908875
loss_pred:0.015953855589032173, decouple_loss:0.002320891013368964
Iteration: 1935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678524136543274, gen p mean: -0.2583485245704651, mean p set: 0.44736161828041077
loss_pred:0.014885351061820984, decouple_loss:0.0023187140468508005
The modified gen p mean: 0.44740405678749084, gen p mean: -0.2545579969882965, mean p set: 0.44793686270713806The modified gen p mean: 0.4468417763710022, gen p mean: -0.255877822637558, mean p set: 0.44742023944854736
loss_pred:0.015478553250432014, decouple_loss:0.0022765423636883497loss_pred:0.015112807974219322, decouple_loss:0.002221498405560851
Iteration: 1936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479082226753235, gen p mean: -0.2559627592563629, mean p set: 0.4484843611717224
loss_pred:0.0153726264834404, decouple_loss:0.002402699086815119
The modified gen p mean: 0.44679030776023865, gen p mean: -0.2552766501903534, mean p set: 0.44737330079078674
loss_pred:0.015321477316319942, decouple_loss:0.0026936000213027
The modified gen p mean: 0.44670218229293823, gen p mean: -0.25956058502197266, mean p set: 0.44723477959632874
loss_pred:0.01621582917869091, decouple_loss:0.0025016923900693655
Iteration: 1937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447377473115921, gen p mean: -0.25350672006607056, mean p set: 0.4479510188102722
loss_pred:0.015746649354696274, decouple_loss:0.002481736708432436
The modified gen p mean: 0.4476190507411957, gen p mean: -0.2519356310367584, mean p set: 0.4481446444988251The modified gen p mean: 0.44721344113349915, gen p mean: -0.2569435238838196, mean p set: 0.4477914571762085
loss_pred:0.01483247708529234, decouple_loss:0.0024263248778879642
loss_pred:0.016174547374248505, decouple_loss:0.0024662651121616364
Iteration: 1938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472375512123108, gen p mean: -0.25985974073410034, mean p set: 0.44780635833740234
loss_pred:0.01589432917535305, decouple_loss:0.0023814626038074493
The modified gen p mean: 0.4487780034542084, gen p mean: -0.25943323969841003, mean p set: 0.44930416345596313The modified gen p mean: 0.44672489166259766, gen p mean: -0.26019206643104553, mean p set: 0.4472969174385071
loss_pred:0.014998596161603928, decouple_loss:0.002466763136908412
loss_pred:0.015232767909765244, decouple_loss:0.0026555145159363747
Iteration: 1939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484570622444153, gen p mean: -0.2614637315273285, mean p set: 0.4490325152873993
loss_pred:0.014835524372756481, decouple_loss:0.0026445938274264336
The modified gen p mean: 0.4464350640773773, gen p mean: -0.25979292392730713, mean p set: 0.44701075553894043The modified gen p mean: 0.4470677077770233, gen p mean: -0.25590282678604126, mean p set: 0.4476010799407959
loss_pred:0.015355987474322319, decouple_loss:0.002238670364022255
loss_pred:0.015550815500319004, decouple_loss:0.0023174032103270292
Iteration: 1940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830483198165894, gen p mean: -0.2557748854160309, mean p set: 0.4488847255706787
loss_pred:0.015265044756233692, decouple_loss:0.002716860268265009
The modified gen p mean: 0.44761693477630615, gen p mean: -0.25205010175704956, mean p set: 0.4481441080570221The modified gen p mean: 0.4485322833061218, gen p mean: -0.2532966732978821, mean p set: 0.44910916686058044
loss_pred:0.015598519705235958, decouple_loss:0.002545075723901391
loss_pred:0.015139248222112656, decouple_loss:0.002604976762086153
2023-04-27 06:47:12 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25451406836509705, mean p set: 0.4499112665653229
loss_pred:0.016881754621863365, decouple_loss:0.0025300062261521816
The modified gen p mean: 0.44930341839790344, gen p mean: -0.25463029742240906, mean p set: 0.4498290419578552
loss_pred:0.01648114249110222, decouple_loss:0.002534073544666171
The modified gen p mean: 0.4482154846191406, gen p mean: -0.2518105208873749, mean p set: 0.44879910349845886
loss_pred:0.016748368740081787, decouple_loss:0.002502282615751028
WV_1_PC_1_EH_0_PS_30, loss: 0.01682986319065094, avg_mse: 0.024884741753339767
current test mse: 0.024885
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 1941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468192756175995, gen p mean: -0.2532544732093811, mean p set: 0.4473459720611572
loss_pred:0.015814080834388733, decouple_loss:0.0027262717485427856
The modified gen p mean: 0.44712865352630615, gen p mean: -0.25496089458465576, mean p set: 0.4477064609527588The modified gen p mean: 0.446818470954895, gen p mean: -0.2547559440135956, mean p set: 0.44738972187042236
loss_pred:0.015083681792020798, decouple_loss:0.0024508372880518436
loss_pred:0.015600916929543018, decouple_loss:0.002509715035557747
Iteration: 1942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459955394268036, gen p mean: -0.25063908100128174, mean p set: 0.4465225338935852
loss_pred:0.015456960536539555, decouple_loss:0.0023640713188797235
The modified gen p mean: 0.44593313336372375, gen p mean: -0.25041860342025757, mean p set: 0.44651639461517334
loss_pred:0.015665985643863678, decouple_loss:0.0023306668736040592
The modified gen p mean: 0.44773104786872864, gen p mean: -0.2521609663963318, mean p set: 0.4483036994934082
loss_pred:0.014866708777844906, decouple_loss:0.0023555916268378496
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706735014915466, gen p mean: -0.25290167331695557, mean p set: 0.447593629360199
loss_pred:0.015339558012783527, decouple_loss:0.0022378629073500633
The modified gen p mean: 0.44710156321525574, gen p mean: -0.25581827759742737, mean p set: 0.4476762115955353The modified gen p mean: 0.446955144405365, gen p mean: -0.25323376059532166, mean p set: 0.4475339949131012
loss_pred:0.014981541782617569, decouple_loss:0.0022956961765885353loss_pred:0.016347425058484077, decouple_loss:0.002266282681375742
Iteration: 1944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467167556285858, gen p mean: -0.2501901686191559, mean p set: 0.44724246859550476
loss_pred:0.015196865424513817, decouple_loss:0.002403307007625699
The modified gen p mean: 0.4478849172592163, gen p mean: -0.24991649389266968, mean p set: 0.44846251606941223The modified gen p mean: 0.4468576908111572, gen p mean: -0.25032705068588257, mean p set: 0.4474363923072815
loss_pred:0.015014569275081158, decouple_loss:0.0024440691340714693
loss_pred:0.01543740089982748, decouple_loss:0.0025265454314649105
Iteration: 1945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467124342918396, gen p mean: -0.2569582462310791, mean p set: 0.4472809433937073
The modified gen p mean: 0.44676172733306885, gen p mean: -0.2554697096347809, mean p set: 0.4473433792591095
loss_pred:0.01559247076511383, decouple_loss:0.0022486101370304823
loss_pred:0.015606485307216644, decouple_loss:0.0022557706106454134
The modified gen p mean: 0.44704070687294006, gen p mean: -0.253677636384964, mean p set: 0.4475724399089813
loss_pred:0.015010303817689419, decouple_loss:0.0023507303558290005
Iteration: 1946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799208641052246, gen p mean: -0.25986945629119873, mean p set: 0.448570191860199
loss_pred:0.01531668659299612, decouple_loss:0.0021396272350102663
The modified gen p mean: 0.4464241564273834, gen p mean: -0.2627597749233246, mean p set: 0.44700121879577637The modified gen p mean: 0.4478102922439575, gen p mean: -0.2606448829174042, mean p set: 0.44833290576934814
loss_pred:0.015596266835927963, decouple_loss:0.0022696733940392733
loss_pred:0.015247425064444542, decouple_loss:0.00210028444416821
Iteration: 1947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446866512298584, gen p mean: -0.2570912837982178, mean p set: 0.4474417567253113
loss_pred:0.015499877743422985, decouple_loss:0.0022876872681081295
The modified gen p mean: 0.4472281038761139, gen p mean: -0.2606049180030823, mean p set: 0.4478035867214203
loss_pred:0.015534326434135437, decouple_loss:0.0022997562773525715
The modified gen p mean: 0.4460955560207367, gen p mean: -0.25419381260871887, mean p set: 0.4466211497783661
loss_pred:0.015126369893550873, decouple_loss:0.0022249689791351557
Iteration: 1948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710198044776917, gen p mean: -0.2547954022884369, mean p set: 0.44767507910728455
loss_pred:0.014994853176176548, decouple_loss:0.002358443569391966
The modified gen p mean: 0.44715172052383423, gen p mean: -0.2527906596660614, mean p set: 0.44772762060165405
loss_pred:0.014665650203824043, decouple_loss:0.002327549969777465
The modified gen p mean: 0.4462522268295288, gen p mean: -0.2525315582752228, mean p set: 0.4467797577381134
loss_pred:0.015461858361959457, decouple_loss:0.0023450017906725407
Iteration: 1949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771549105644226, gen p mean: -0.24575509130954742, mean p set: 0.44829118251800537
loss_pred:0.015062939375638962, decouple_loss:0.002349184127524495
The modified gen p mean: 0.44691741466522217, gen p mean: -0.24561916291713715, mean p set: 0.4474965035915375
loss_pred:0.015014784410595894, decouple_loss:0.002010955009609461
The modified gen p mean: 0.44766467809677124, gen p mean: -0.24456851184368134, mean p set: 0.44819772243499756
loss_pred:0.015868300572037697, decouple_loss:0.002143185818567872
Iteration: 1950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458877742290497, gen p mean: -0.2423301637172699, mean p set: 0.4464643895626068
loss_pred:0.01525565143674612, decouple_loss:0.0022509123664349318
The modified gen p mean: 0.44689512252807617, gen p mean: -0.24824875593185425, mean p set: 0.4474670886993408
loss_pred:0.0149608813226223, decouple_loss:0.002197871683165431
The modified gen p mean: 0.4468226134777069, gen p mean: -0.24439559876918793, mean p set: 0.44735097885131836
loss_pred:0.0151358712464571, decouple_loss:0.002149396575987339
2023-04-27 06:51:22 testing...
The modified gen p mean: 0.44821983575820923, gen p mean: -0.24334338307380676, mean p set: 0.44879910349845886
loss_pred:0.01681593991816044, decouple_loss:0.002459830604493618
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2459535300731659, mean p set: 0.4499112665653229
loss_pred:0.01687285117805004, decouple_loss:0.002624824643135071
The modified gen p mean: 0.4492988884449005, gen p mean: -0.24609538912773132, mean p set: 0.4498290419578552
loss_pred:0.016461649909615517, decouple_loss:0.0023235275875777006
WV_1_PC_1_EH_0_PS_30, loss: 0.016840284690260887, avg_mse: 0.024931296706199646
current test mse: 0.024931
Iteration: 1951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461970329284668, gen p mean: -0.2458818405866623, mean p set: 0.44673141837120056
loss_pred:0.015709668397903442, decouple_loss:0.0022473076824098825
The modified gen p mean: 0.44687625765800476, gen p mean: -0.24280032515525818, mean p set: 0.4474518895149231
loss_pred:0.015262645669281483, decouple_loss:0.0025720149278640747
The modified gen p mean: 0.44799524545669556, gen p mean: -0.24496260285377502, mean p set: 0.44856566190719604
loss_pred:0.014974807389080524, decouple_loss:0.002299948362633586
Iteration: 1952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470392167568207, gen p mean: -0.2521841824054718, mean p set: 0.4475627839565277
loss_pred:0.014115429483354092, decouple_loss:0.002141394419595599
The modified gen p mean: 0.44832926988601685, gen p mean: -0.25649183988571167, mean p set: 0.4489026963710785
The modified gen p mean: 0.446444034576416, gen p mean: -0.2496223747730255, mean p set: 0.44702303409576416
loss_pred:0.015041518956422806, decouple_loss:0.0025648283772170544
loss_pred:0.015595914795994759, decouple_loss:0.0023011560551822186
Iteration: 1953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702696800231934, gen p mean: -0.25651201605796814, mean p set: 0.4475582242012024
loss_pred:0.014957764185965061, decouple_loss:0.0022747169714421034
The modified gen p mean: 0.4460727572441101, gen p mean: -0.24722521007061005, mean p set: 0.4466512203216553
The modified gen p mean: 0.4474877417087555, gen p mean: -0.2524726688861847, mean p set: 0.44806966185569763
loss_pred:0.016004648059606552, decouple_loss:0.0022777975536882877
loss_pred:0.014961428940296173, decouple_loss:0.002080600941553712
Iteration: 1954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467921555042267, gen p mean: -0.2469593733549118, mean p set: 0.447368860244751
loss_pred:0.015638507902622223, decouple_loss:0.00211214367300272
The modified gen p mean: 0.4464931786060333, gen p mean: -0.2498244345188141, mean p set: 0.44701918959617615The modified gen p mean: 0.4464946985244751, gen p mean: -0.24769678711891174, mean p set: 0.4470658302307129
loss_pred:0.015720784664154053, decouple_loss:0.002240835689008236
loss_pred:0.015530157834291458, decouple_loss:0.00215744785964489
Iteration: 1955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472449719905853, gen p mean: -0.24760648608207703, mean p set: 0.44781920313835144
loss_pred:0.015550686046481133, decouple_loss:0.0021939040161669254
The modified gen p mean: 0.44580337405204773, gen p mean: -0.24712133407592773, mean p set: 0.4463328719139099The modified gen p mean: 0.4459274113178253, gen p mean: -0.24793022871017456, mean p set: 0.446504145860672
loss_pred:0.01502355094999075, decouple_loss:0.002202048432081938
loss_pred:0.01561383530497551, decouple_loss:0.0022456208243966103
Iteration: 1956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725391268730164, gen p mean: -0.24332666397094727, mean p set: 0.44783177971839905
loss_pred:0.01536989863961935, decouple_loss:0.002112508751451969
The modified gen p mean: 0.44741538166999817, gen p mean: -0.244913250207901, mean p set: 0.4479915201663971
loss_pred:0.01497243158519268, decouple_loss:0.002210544655099511
The modified gen p mean: 0.44679367542266846, gen p mean: -0.24666455388069153, mean p set: 0.44731974601745605
loss_pred:0.014938282780349255, decouple_loss:0.0020658159628510475
Iteration: 1957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792476296424866, gen p mean: -0.2520850598812103, mean p set: 0.44850221276283264
loss_pred:0.01498362235724926, decouple_loss:0.0022888085804879665
The modified gen p mean: 0.4463413655757904, gen p mean: -0.24245095252990723, mean p set: 0.44692397117614746
loss_pred:0.015557639300823212, decouple_loss:0.002160769421607256
The modified gen p mean: 0.4460431933403015, gen p mean: -0.23987562954425812, mean p set: 0.44658011198043823
loss_pred:0.015632707625627518, decouple_loss:0.0024057473056018353
Iteration: 1958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466148018836975, gen p mean: -0.24867746233940125, mean p set: 0.44718724489212036
loss_pred:0.01551546435803175, decouple_loss:0.002531952690333128
The modified gen p mean: 0.4460218548774719, gen p mean: -0.24469763040542603, mean p set: 0.4465442895889282The modified gen p mean: 0.4472636580467224, gen p mean: -0.2534013092517853, mean p set: 0.4478381872177124
loss_pred:0.015085064806044102, decouple_loss:0.002321499167010188
loss_pred:0.015333897434175014, decouple_loss:0.002400364028289914
Iteration: 1959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872671365737915, gen p mean: -0.2616589069366455, mean p set: 0.44930580258369446
loss_pred:0.015006002970039845, decouple_loss:0.0021272674202919006
The modified gen p mean: 0.4468189477920532, gen p mean: -0.25230708718299866, mean p set: 0.447394996881485
loss_pred:0.015417110174894333, decouple_loss:0.001999265979975462
The modified gen p mean: 0.44760146737098694, gen p mean: -0.25150832533836365, mean p set: 0.4481275677680969
loss_pred:0.015057667158544064, decouple_loss:0.0020829124841839075
Iteration: 1960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707587361335754, gen p mean: -0.2501544952392578, mean p set: 0.4476585388183594
loss_pred:0.01534915342926979, decouple_loss:0.00228519388474524
The modified gen p mean: 0.44701728224754333, gen p mean: -0.25006958842277527, mean p set: 0.447585791349411
loss_pred:0.015152695588767529, decouple_loss:0.0022864064667373896
The modified gen p mean: 0.4466554820537567, gen p mean: -0.24692997336387634, mean p set: 0.4471836984157562
loss_pred:0.015500425361096859, decouple_loss:0.0023411980364471674
2023-04-27 06:54:47 testing...
The modified gen p mean: 0.449430912733078, gen p mean: -0.2429710030555725, mean p set: 0.4499112665653229
loss_pred:0.016916213557124138, decouple_loss:0.0023534309584647417
The modified gen p mean: 0.44930046796798706, gen p mean: -0.24302297830581665, mean p set: 0.4498290419578552
loss_pred:0.016436250880360603, decouple_loss:0.0023293832782655954
The modified gen p mean: 0.4482215642929077, gen p mean: -0.24034805595874786, mean p set: 0.44879910349845886
loss_pred:0.016867410391569138, decouple_loss:0.0023515154607594013
WV_1_PC_1_EH_0_PS_30, loss: 0.016857197508215904, avg_mse: 0.025008874014019966
current test mse: 0.025009
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 1961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478018283843994, gen p mean: -0.2398756444454193, mean p set: 0.44832685589790344
loss_pred:0.015020651742815971, decouple_loss:0.0023535063955932856
The modified gen p mean: 0.44829484820365906, gen p mean: -0.23868156969547272, mean p set: 0.4488696753978729
loss_pred:0.014500938355922699, decouple_loss:0.002491842722520232
The modified gen p mean: 0.44768863916397095, gen p mean: -0.24731558561325073, mean p set: 0.44827136397361755
loss_pred:0.01484477985650301, decouple_loss:0.002443392761051655
Iteration: 1962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488663971424103, gen p mean: -0.23665456473827362, mean p set: 0.4493965804576874
loss_pred:0.01453110296279192, decouple_loss:0.0024931144434958696
The modified gen p mean: 0.44780147075653076, gen p mean: -0.2362925261259079, mean p set: 0.4483802020549774
The modified gen p mean: 0.44844457507133484, gen p mean: -0.2384759783744812, mean p set: 0.4490176737308502
loss_pred:0.014845888130366802, decouple_loss:0.0025181355886161327
loss_pred:0.015033523552119732, decouple_loss:0.0025237640365958214
Iteration: 1963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680023193359375, gen p mean: -0.24735669791698456, mean p set: 0.4473215639591217
loss_pred:0.015329533256590366, decouple_loss:0.002532628830522299
The modified gen p mean: 0.4478006958961487, gen p mean: -0.23719626665115356, mean p set: 0.4483778774738312
The modified gen p mean: 0.44660720229148865, gen p mean: -0.24008634686470032, mean p set: 0.4471812844276428
loss_pred:0.014878271147608757, decouple_loss:0.0024342292454093695
loss_pred:0.015219343826174736, decouple_loss:0.0025004695635288954
Iteration: 1964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794920086860657, gen p mean: -0.2509881258010864, mean p set: 0.4484791159629822
loss_pred:0.014874055050313473, decouple_loss:0.0027303548995405436
The modified gen p mean: 0.44742926955223083, gen p mean: -0.2450142502784729, mean p set: 0.44800853729248047
The modified gen p mean: 0.44683918356895447, gen p mean: -0.24414031207561493, mean p set: 0.4474049210548401
loss_pred:0.015032533556222916, decouple_loss:0.0023414241150021553
loss_pred:0.015004546381533146, decouple_loss:0.0023437081836163998
Iteration: 1965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466171860694885, gen p mean: -0.25311824679374695, mean p set: 0.4471994936466217
loss_pred:0.015371843241155148, decouple_loss:0.0024311591405421495
The modified gen p mean: 0.44712090492248535, gen p mean: -0.24900706112384796, mean p set: 0.4476914703845978
loss_pred:0.015072871930897236, decouple_loss:0.002457525348290801
The modified gen p mean: 0.44825097918510437, gen p mean: -0.24568532407283783, mean p set: 0.44877946376800537
loss_pred:0.014335825107991695, decouple_loss:0.0024742784444242716
Iteration: 1966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475395679473877, gen p mean: -0.24753610789775848, mean p set: 0.4481112062931061
loss_pred:0.015569991432130337, decouple_loss:0.00234901811927557
The modified gen p mean: 0.44618549942970276, gen p mean: -0.24857549369335175, mean p set: 0.44676467776298523
loss_pred:0.014666036702692509, decouple_loss:0.002383876359090209
The modified gen p mean: 0.44720739126205444, gen p mean: -0.25508302450180054, mean p set: 0.4477385878562927
loss_pred:0.015106580220162868, decouple_loss:0.0024619847536087036
Iteration: 1967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795066118240356, gen p mean: -0.26081612706184387, mean p set: 0.4485274851322174
loss_pred:0.015014066360890865, decouple_loss:0.002269171876832843
The modified gen p mean: 0.44641563296318054, gen p mean: -0.2540019452571869, mean p set: 0.4469953179359436
loss_pred:0.014882927760481834, decouple_loss:0.002272798679769039
The modified gen p mean: 0.44871726632118225, gen p mean: -0.24696144461631775, mean p set: 0.44924309849739075
loss_pred:0.014924702234566212, decouple_loss:0.0024018660187721252
Iteration: 1968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468133747577667, gen p mean: -0.2518479824066162, mean p set: 0.44739410281181335
loss_pred:0.015964321792125702, decouple_loss:0.002736276714131236
The modified gen p mean: 0.4473264813423157, gen p mean: -0.2580101191997528, mean p set: 0.44790735840797424
loss_pred:0.014859025366604328, decouple_loss:0.002512845443561673
The modified gen p mean: 0.44624295830726624, gen p mean: -0.25826290249824524, mean p set: 0.44677630066871643
loss_pred:0.015608631074428558, decouple_loss:0.002676792908459902
Iteration: 1969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480494558811188, gen p mean: -0.2530418336391449, mean p set: 0.4486168920993805
loss_pred:0.014745049178600311, decouple_loss:0.0025500068441033363
The modified gen p mean: 0.4486140310764313, gen p mean: -0.248785600066185, mean p set: 0.449184387922287
loss_pred:0.014632068574428558, decouple_loss:0.0025544201489537954
The modified gen p mean: 0.4478318393230438, gen p mean: -0.25533899664878845, mean p set: 0.44836175441741943
loss_pred:0.014716627076268196, decouple_loss:0.0026631734799593687
Iteration: 1970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476560652256012, gen p mean: -0.24906794726848602, mean p set: 0.4482361972332001
loss_pred:0.01459786668419838, decouple_loss:0.0024485266767442226
The modified gen p mean: 0.4471457302570343, gen p mean: -0.24925312399864197, mean p set: 0.44772061705589294
loss_pred:0.014835444279015064, decouple_loss:0.0024672742001712322
The modified gen p mean: 0.447415292263031, gen p mean: -0.2466503232717514, mean p set: 0.4479469656944275
loss_pred:0.014914722181856632, decouple_loss:0.002554706297814846
2023-04-27 06:58:53 testing...
The modified gen p mean: 0.44821375608444214, gen p mean: -0.24218781292438507, mean p set: 0.44879910349845886
loss_pred:0.016953356564044952, decouple_loss:0.0028526419773697853
The modified gen p mean: 0.4493078887462616, gen p mean: -0.24486321210861206, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24510632455348969, mean p set: 0.4499112665653229
loss_pred:0.016559230163693428, decouple_loss:0.0027345914859324694
loss_pred:0.017069675028324127, decouple_loss:0.002906578127294779
WV_1_PC_1_EH_0_PS_30, loss: 0.017002318054437637, avg_mse: 0.025232631713151932
current test mse: 0.025233
Iteration: 1971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464794397354126, gen p mean: -0.24754777550697327, mean p set: 0.44700247049331665
loss_pred:0.015178404748439789, decouple_loss:0.002746003679931164
The modified gen p mean: 0.4483867883682251, gen p mean: -0.24715492129325867, mean p set: 0.4489628076553345
loss_pred:0.01455629151314497, decouple_loss:0.002463151467964053
The modified gen p mean: 0.4469982385635376, gen p mean: -0.24183623492717743, mean p set: 0.4475743770599365
loss_pred:0.015942301601171494, decouple_loss:0.0026304712519049644
Iteration: 1972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480295479297638, gen p mean: -0.24419303238391876, mean p set: 0.4485653042793274
loss_pred:0.014091243967413902, decouple_loss:0.002622343134135008
The modified gen p mean: 0.4487970471382141, gen p mean: -0.23951669037342072, mean p set: 0.44937291741371155
The modified gen p mean: 0.44652870297431946, gen p mean: -0.24063162505626678, mean p set: 0.447108656167984
loss_pred:0.014718864113092422, decouple_loss:0.002406101441010833
loss_pred:0.014169086702167988, decouple_loss:0.002405113074928522
Iteration: 1973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740569591522217, gen p mean: -0.24701851606369019, mean p set: 0.4479270875453949
loss_pred:0.014528202824294567, decouple_loss:0.002387154847383499
The modified gen p mean: 0.4470762014389038, gen p mean: -0.24998533725738525, mean p set: 0.44765228033065796
The modified gen p mean: 0.44644805788993835, gen p mean: -0.2450316995382309, mean p set: 0.4470299780368805
loss_pred:0.015239962376654148, decouple_loss:0.0023710865061730146
loss_pred:0.015308134257793427, decouple_loss:0.0023591627832502127
Iteration: 1974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473131000995636, gen p mean: -0.24622167646884918, mean p set: 0.4478895962238312
loss_pred:0.01427657250314951, decouple_loss:0.002241299021989107
The modified gen p mean: 0.4481121301651001, gen p mean: -0.2415522038936615, mean p set: 0.4486429989337921The modified gen p mean: 0.4469488859176636, gen p mean: -0.2489042431116104, mean p set: 0.4475267231464386
loss_pred:0.0147964246571064, decouple_loss:0.0024532240349799395
loss_pred:0.014932178892195225, decouple_loss:0.002369242487475276
Iteration: 1975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470216631889343, gen p mean: -0.2516794204711914, mean p set: 0.44759422540664673
loss_pred:0.014812711626291275, decouple_loss:0.0022825251799076796
The modified gen p mean: 0.44671744108200073, gen p mean: -0.24998895823955536, mean p set: 0.44729676842689514
loss_pred:0.014857111498713493, decouple_loss:0.002289894502609968
The modified gen p mean: 0.44745954871177673, gen p mean: -0.24567919969558716, mean p set: 0.44798827171325684
loss_pred:0.014227439649403095, decouple_loss:0.00230483734048903
Iteration: 1976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466874599456787, gen p mean: -0.24992479383945465, mean p set: 0.44725939631462097
loss_pred:0.01517299935221672, decouple_loss:0.0022533705923706293
The modified gen p mean: 0.4477180242538452, gen p mean: -0.25233638286590576, mean p set: 0.44824886322021484The modified gen p mean: 0.44722169637680054, gen p mean: -0.2522287368774414, mean p set: 0.4478025436401367
loss_pred:0.014582030475139618, decouple_loss:0.0024493373930454254
loss_pred:0.014414070174098015, decouple_loss:0.0026495459023863077
Iteration: 1977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717511534690857, gen p mean: -0.2502620816230774, mean p set: 0.4477514624595642
loss_pred:0.014454534277319908, decouple_loss:0.0023204046301543713
The modified gen p mean: 0.44737568497657776, gen p mean: -0.25148776173591614, mean p set: 0.44795170426368713
loss_pred:0.014743742533028126, decouple_loss:0.0023962538689374924
The modified gen p mean: 0.4472602307796478, gen p mean: -0.24866247177124023, mean p set: 0.44779151678085327
loss_pred:0.014876591973006725, decouple_loss:0.0024866412859410048
Iteration: 1978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681960344314575, gen p mean: -0.24796141684055328, mean p set: 0.4474024176597595
loss_pred:0.014866498298943043, decouple_loss:0.0024689442943781614
The modified gen p mean: 0.44814160466194153, gen p mean: -0.2471581995487213, mean p set: 0.4486709535121918The modified gen p mean: 0.44736698269844055, gen p mean: -0.25523656606674194, mean p set: 0.44793838262557983
loss_pred:0.014667914249002934, decouple_loss:0.002597123384475708
loss_pred:0.014089359901845455, decouple_loss:0.002460218034684658
Iteration: 1979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699403643608093, gen p mean: -0.2463763803243637, mean p set: 0.44756919145584106
loss_pred:0.015795307233929634, decouple_loss:0.002464981283992529
The modified gen p mean: 0.4486810564994812, gen p mean: -0.2541613280773163, mean p set: 0.44926023483276367
loss_pred:0.014668251387774944, decouple_loss:0.0026737521402537823
The modified gen p mean: 0.4479491114616394, gen p mean: -0.25674712657928467, mean p set: 0.4484758675098419
loss_pred:0.014762685634195805, decouple_loss:0.0025466098450124264
Iteration: 1980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789624214172363, gen p mean: -0.24612551927566528, mean p set: 0.44847285747528076
loss_pred:0.014430023729801178, decouple_loss:0.0024049433413892984
The modified gen p mean: 0.446169912815094, gen p mean: -0.24653662741184235, mean p set: 0.44675159454345703
loss_pred:0.015477441251277924, decouple_loss:0.0023783938959240913
The modified gen p mean: 0.4470328688621521, gen p mean: -0.25405484437942505, mean p set: 0.44756677746772766
loss_pred:0.01484950352460146, decouple_loss:0.0023090660106390715
2023-04-27 07:02:18 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25091829895973206, mean p set: 0.4499112665653229
loss_pred:0.017148209735751152, decouple_loss:0.003385729854926467
The modified gen p mean: 0.4492917060852051, gen p mean: -0.25029292702674866, mean p set: 0.4498290419578552
loss_pred:0.016619935631752014, decouple_loss:0.0031348750926554203
The modified gen p mean: 0.4482313394546509, gen p mean: -0.2477695345878601, mean p set: 0.44879910349845886
loss_pred:0.017072057351469994, decouple_loss:0.003205260494723916
WV_1_PC_1_EH_0_PS_30, loss: 0.01710883341729641, avg_mse: 0.025359900668263435
current test mse: 0.02536
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 1981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501471221446991, gen p mean: -0.24249422550201416, mean p set: 0.4506722390651703
loss_pred:0.014824071899056435, decouple_loss:0.002730313455685973
The modified gen p mean: 0.4472905993461609, gen p mean: -0.25288549065589905, mean p set: 0.44786572456359863
loss_pred:0.014442754909396172, decouple_loss:0.002802629256621003
The modified gen p mean: 0.44756531715393066, gen p mean: -0.24797594547271729, mean p set: 0.4481406807899475
loss_pred:0.014911159873008728, decouple_loss:0.003229917259886861
Iteration: 1982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966837763786316, gen p mean: -0.24569159746170044, mean p set: 0.45020049810409546
loss_pred:0.01464921049773693, decouple_loss:0.00242553255520761
The modified gen p mean: 0.44635868072509766, gen p mean: -0.2462245374917984, mean p set: 0.4469376802444458The modified gen p mean: 0.4483199715614319, gen p mean: -0.2426503449678421, mean p set: 0.4488963484764099
loss_pred:0.015122752636671066, decouple_loss:0.00236512185074389
loss_pred:0.0148264579474926, decouple_loss:0.0027493187226355076
Iteration: 1983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474579989910126, gen p mean: -0.24769796431064606, mean p set: 0.44798991084098816
loss_pred:0.014161018654704094, decouple_loss:0.0027267576660960913
The modified gen p mean: 0.44993704557418823, gen p mean: -0.23821565508842468, mean p set: 0.4505167305469513The modified gen p mean: 0.4469691514968872, gen p mean: -0.24290671944618225, mean p set: 0.44753846526145935
loss_pred:0.014889586716890335, decouple_loss:0.0030253655277192593loss_pred:0.015253279358148575, decouple_loss:0.0029135553631931543
Iteration: 1984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761431217193604, gen p mean: -0.2377491146326065, mean p set: 0.4481384754180908
loss_pred:0.014170055277645588, decouple_loss:0.002493588486686349
The modified gen p mean: 0.4487560987472534, gen p mean: -0.24023786187171936, mean p set: 0.4493320882320404The modified gen p mean: 0.44691991806030273, gen p mean: -0.2397167831659317, mean p set: 0.44749414920806885
loss_pred:0.014778796583414078, decouple_loss:0.0026086049620062113loss_pred:0.015069892629981041, decouple_loss:0.0028909221291542053
Iteration: 1985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485020339488983, gen p mean: -0.23712597787380219, mean p set: 0.449078768491745
loss_pred:0.014532824046909809, decouple_loss:0.0029632553923875093
The modified gen p mean: 0.4473586082458496, gen p mean: -0.23501600325107574, mean p set: 0.4478890001773834
The modified gen p mean: 0.4491232633590698, gen p mean: -0.23489247262477875, mean p set: 0.44969815015792847
loss_pred:0.01473745983093977, decouple_loss:0.0026561347767710686
loss_pred:0.014705687761306763, decouple_loss:0.0028967091348022223
Iteration: 1986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467650055885315, gen p mean: -0.2434411495923996, mean p set: 0.4473493695259094
loss_pred:0.014949832111597061, decouple_loss:0.0026042729150503874
The modified gen p mean: 0.447737455368042, gen p mean: -0.23528611660003662, mean p set: 0.4483111500740051The modified gen p mean: 0.44726669788360596, gen p mean: -0.24502015113830566, mean p set: 0.4477921724319458
loss_pred:0.015032332390546799, decouple_loss:0.0028668453451246023
loss_pred:0.014691418036818504, decouple_loss:0.002582675777375698
Iteration: 1987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492768347263336, gen p mean: -0.24209101498126984, mean p set: 0.4498105049133301
loss_pred:0.014925616793334484, decouple_loss:0.002806475618854165
The modified gen p mean: 0.44879940152168274, gen p mean: -0.24352732300758362, mean p set: 0.4493766129016876
The modified gen p mean: 0.44785067439079285, gen p mean: -0.24556833505630493, mean p set: 0.44842419028282166
loss_pred:0.014526208862662315, decouple_loss:0.002997900592163205
loss_pred:0.014642548747360706, decouple_loss:0.003004829864948988
Iteration: 1988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479326009750366, gen p mean: -0.2530246675014496, mean p set: 0.4485096037387848
loss_pred:0.014622828923165798, decouple_loss:0.0029613389633595943
The modified gen p mean: 0.4472733736038208, gen p mean: -0.2466493546962738, mean p set: 0.44784975051879883
loss_pred:0.013970458880066872, decouple_loss:0.0026526974979788065
The modified gen p mean: 0.4478435516357422, gen p mean: -0.25266796350479126, mean p set: 0.4483746588230133
loss_pred:0.01474808994680643, decouple_loss:0.00288943899795413
Iteration: 1989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485313892364502, gen p mean: -0.252605676651001, mean p set: 0.44906049966812134
loss_pred:0.014480117708444595, decouple_loss:0.0024913346860557795
The modified gen p mean: 0.4482075870037079, gen p mean: -0.2600336968898773, mean p set: 0.44878509640693665
The modified gen p mean: 0.4487375319004059, gen p mean: -0.2604473829269409, mean p set: 0.4493098258972168
loss_pred:0.014746357686817646, decouple_loss:0.0027820845134556293
loss_pred:0.014211527071893215, decouple_loss:0.0027922114823013544
Iteration: 1990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609543681144714, gen p mean: -0.2612120509147644, mean p set: 0.4466628134250641
loss_pred:0.015169348567724228, decouple_loss:0.0026489198207855225
The modified gen p mean: 0.4482214152812958, gen p mean: -0.2647033631801605, mean p set: 0.44880014657974243
loss_pred:0.014022167772054672, decouple_loss:0.002540272893384099
The modified gen p mean: 0.4477149546146393, gen p mean: -0.25766292214393616, mean p set: 0.44823670387268066
loss_pred:0.014514531940221786, decouple_loss:0.0026524250861257315
2023-04-27 07:06:20 testing...
The modified gen p mean: 0.44821852445602417, gen p mean: -0.2571803629398346, mean p set: 0.44879910349845886
loss_pred:0.016983309760689735, decouple_loss:0.0025298551190644503
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25960615277290344, mean p set: 0.4499112665653229
loss_pred:0.017119871452450752, decouple_loss:0.002598783001303673
The modified gen p mean: 0.4493022859096527, gen p mean: -0.2599280774593353, mean p set: 0.4498290419578552
loss_pred:0.016640158370137215, decouple_loss:0.002482767216861248
WV_1_PC_1_EH_0_PS_30, loss: 0.01704130321741104, avg_mse: 0.025255732238292694
current test mse: 0.025256
Iteration: 1991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489328861236572, gen p mean: -0.25469082593917847, mean p set: 0.44950512051582336
loss_pred:0.014242256991565228, decouple_loss:0.002352624200284481
The modified gen p mean: 0.44919130206108093, gen p mean: -0.2533009946346283, mean p set: 0.44976967573165894
loss_pred:0.014258665032684803, decouple_loss:0.0023564749862998724
The modified gen p mean: 0.44721224904060364, gen p mean: -0.2586931884288788, mean p set: 0.4477404057979584
loss_pred:0.014705231413245201, decouple_loss:0.0027799573726952076
Iteration: 1992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711142778396606, gen p mean: -0.25603219866752625, mean p set: 0.4476434886455536
loss_pred:0.014373650774359703, decouple_loss:0.0024816025979816914
The modified gen p mean: 0.44651949405670166, gen p mean: -0.2550606429576874, mean p set: 0.44709157943725586
loss_pred:0.014614615589380264, decouple_loss:0.002342408522963524
The modified gen p mean: 0.44818180799484253, gen p mean: -0.2564087212085724, mean p set: 0.4487580358982086
loss_pred:0.013839435763657093, decouple_loss:0.0024980148300528526
Iteration: 1993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872555136680603, gen p mean: -0.2505069077014923, mean p set: 0.44924888014793396
loss_pred:0.01426574308425188, decouple_loss:0.002299658488482237
The modified gen p mean: 0.4480571746826172, gen p mean: -0.25213295221328735, mean p set: 0.44863414764404297
loss_pred:0.01418669056147337, decouple_loss:0.0022251885384321213
The modified gen p mean: 0.4486236870288849, gen p mean: -0.2533905506134033, mean p set: 0.4491964280605316
loss_pred:0.014434471726417542, decouple_loss:0.002280780114233494
Iteration: 1994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490600526332855, gen p mean: -0.24346090853214264, mean p set: 0.4495809078216553
loss_pred:0.014564919285476208, decouple_loss:0.002379616256803274
The modified gen p mean: 0.4491044282913208, gen p mean: -0.24878309667110443, mean p set: 0.4496791362762451
loss_pred:0.014515380375087261, decouple_loss:0.0023241029120981693
The modified gen p mean: 0.44784000515937805, gen p mean: -0.2422245591878891, mean p set: 0.44841745495796204
loss_pred:0.01428527757525444, decouple_loss:0.0023050764575600624
Iteration: 1995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683828949928284, gen p mean: -0.2543276846408844, mean p set: 0.44741183519363403
loss_pred:0.014588621445000172, decouple_loss:0.0022482990752905607
The modified gen p mean: 0.4469970762729645, gen p mean: -0.2549453675746918, mean p set: 0.44752633571624756The modified gen p mean: 0.4471021592617035, gen p mean: -0.2519286274909973, mean p set: 0.4476757347583771
loss_pred:0.013806209899485111, decouple_loss:0.002249961718916893
loss_pred:0.014512278139591217, decouple_loss:0.0021808771416544914
Iteration: 1996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446309357881546, gen p mean: -0.2507396638393402, mean p set: 0.4468816816806793
loss_pred:0.015354149043560028, decouple_loss:0.002737942151725292
The modified gen p mean: 0.44597017765045166, gen p mean: -0.25284335017204285, mean p set: 0.4464992880821228The modified gen p mean: 0.44927433133125305, gen p mean: -0.24990049004554749, mean p set: 0.44985491037368774
loss_pred:0.014581519179046154, decouple_loss:0.002102475380524993
loss_pred:0.015055658295750618, decouple_loss:0.0020771773997694254
Iteration: 1997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448678195476532, gen p mean: -0.2529919445514679, mean p set: 0.44924619793891907
loss_pred:0.014613511972129345, decouple_loss:0.0024358269292861223
The modified gen p mean: 0.4481373727321625, gen p mean: -0.25769299268722534, mean p set: 0.4487197697162628The modified gen p mean: 0.44917526841163635, gen p mean: -0.2621523439884186, mean p set: 0.4497106075286865
loss_pred:0.014724602922797203, decouple_loss:0.00281559769064188
loss_pred:0.014462290331721306, decouple_loss:0.0024836943484842777
Iteration: 1998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683584570884705, gen p mean: -0.2548457384109497, mean p set: 0.44741132855415344
loss_pred:0.0150811318308115, decouple_loss:0.0026260693557560444
The modified gen p mean: 0.4481324851512909, gen p mean: -0.26074838638305664, mean p set: 0.4487130343914032The modified gen p mean: 0.44785481691360474, gen p mean: -0.25127974152565, mean p set: 0.44838523864746094
loss_pred:0.014466593973338604, decouple_loss:0.002422784687951207
loss_pred:0.015108897350728512, decouple_loss:0.0022388340439647436
Iteration: 1999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489041566848755, gen p mean: -0.25381889939308167, mean p set: 0.44948315620422363
loss_pred:0.014593214727938175, decouple_loss:0.0025622916873544455
The modified gen p mean: 0.44718676805496216, gen p mean: -0.2563888132572174, mean p set: 0.447760671377182The modified gen p mean: 0.44744420051574707, gen p mean: -0.2612782120704651, mean p set: 0.4479677379131317
loss_pred:0.014551142230629921, decouple_loss:0.002419274067506194
loss_pred:0.014105726964771748, decouple_loss:0.002654754091054201
Iteration: 2000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878190755844116, gen p mean: -0.26173147559165955, mean p set: 0.4493577182292938
loss_pred:0.013955054804682732, decouple_loss:0.0023037984501570463
The modified gen p mean: 0.4480859339237213, gen p mean: -0.25797393918037415, mean p set: 0.44866541028022766The modified gen p mean: 0.44729989767074585, gen p mean: -0.25261351466178894, mean p set: 0.44782590866088867
loss_pred:0.014641761779785156, decouple_loss:0.002230273326858878
loss_pred:0.014787107706069946, decouple_loss:0.002314444864168763
2023-04-27 07:09:45 itr: 2000
training loss: [0.01490283 0.01407024 0.01475328]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_2000.ckpt
2023-04-27 07:09:49 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.26040565967559814, mean p set: 0.4499112665653229
loss_pred:0.017091872170567513, decouple_loss:0.002257558284327388
The modified gen p mean: 0.448224276304245, gen p mean: -0.25844162702560425, mean p set: 0.44879910349845886
loss_pred:0.016989372670650482, decouple_loss:0.002306804060935974
The modified gen p mean: 0.4493007957935333, gen p mean: -0.2614090144634247, mean p set: 0.4498290419578552
loss_pred:0.016531875357031822, decouple_loss:0.002283854875713587
WV_1_PC_1_EH_0_PS_30, loss: 0.016985177993774414, avg_mse: 0.025204945355653763
current test mse: 0.025205
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 2001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621819257736206, gen p mean: -0.2607841193675995, mean p set: 0.44674646854400635
loss_pred:0.015239434316754341, decouple_loss:0.002189770806580782
The modified gen p mean: 0.4465758204460144, gen p mean: -0.2642781138420105, mean p set: 0.44714680314064026
The modified gen p mean: 0.4468793272972107, gen p mean: -0.2577248811721802, mean p set: 0.44745591282844543
loss_pred:0.015742363408207893, decouple_loss:0.0024135441053658724
loss_pred:0.015838051214814186, decouple_loss:0.002034455072134733
Iteration: 2002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690391421318054, gen p mean: -0.2651633024215698, mean p set: 0.44743674993515015
loss_pred:0.015436441637575626, decouple_loss:0.0024480766151100397
The modified gen p mean: 0.44749176502227783, gen p mean: -0.25972798466682434, mean p set: 0.4480704963207245
loss_pred:0.01576193980872631, decouple_loss:0.0030810211319476366
The modified gen p mean: 0.44641196727752686, gen p mean: -0.25998353958129883, mean p set: 0.4469858705997467
loss_pred:0.015857530757784843, decouple_loss:0.0026923110708594322
Iteration: 2003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768717885017395, gen p mean: -0.2516087293624878, mean p set: 0.44821488857269287
loss_pred:0.015626221895217896, decouple_loss:0.002390148350968957
The modified gen p mean: 0.4473840594291687, gen p mean: -0.2580920159816742, mean p set: 0.4479503035545349
loss_pred:0.014649064280092716, decouple_loss:0.002562392270192504
The modified gen p mean: 0.4465630054473877, gen p mean: -0.2581258714199066, mean p set: 0.4471304714679718
loss_pred:0.016238873824477196, decouple_loss:0.0025302499998360872
Iteration: 2004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44553640484809875, gen p mean: -0.2533888518810272, mean p set: 0.4460710883140564
loss_pred:0.015232029370963573, decouple_loss:0.002291368553414941
The modified gen p mean: 0.4471563994884491, gen p mean: -0.25427088141441345, mean p set: 0.44772863388061523
loss_pred:0.015337889082729816, decouple_loss:0.0022369553335011005
The modified gen p mean: 0.44581338763237, gen p mean: -0.2553938627243042, mean p set: 0.44638508558273315
loss_pred:0.015327484346926212, decouple_loss:0.0022823268081992865
Iteration: 2005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474193751811981, gen p mean: -0.25450843572616577, mean p set: 0.4479900598526001
loss_pred:0.016055962070822716, decouple_loss:0.002414215123280883
The modified gen p mean: 0.44653165340423584, gen p mean: -0.2603803873062134, mean p set: 0.44706523418426514The modified gen p mean: 0.44785889983177185, gen p mean: -0.2568076550960541, mean p set: 0.4484312832355499
loss_pred:0.015524354763329029, decouple_loss:0.0026032421737909317
loss_pred:0.0155774662271142, decouple_loss:0.00291723245754838
Iteration: 2006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471462666988373, gen p mean: -0.26236215233802795, mean p set: 0.4477214217185974
loss_pred:0.015456154011189938, decouple_loss:0.0023726571816951036
The modified gen p mean: 0.44626545906066895, gen p mean: -0.25543150305747986, mean p set: 0.44678789377212524The modified gen p mean: 0.4469502866268158, gen p mean: -0.25882595777511597, mean p set: 0.44752398133277893
loss_pred:0.015081904828548431, decouple_loss:0.0024497834965586662
loss_pred:0.014858192764222622, decouple_loss:0.0022490646224468946
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44662895798683167, gen p mean: -0.24789214134216309, mean p set: 0.4472024440765381
loss_pred:0.015604487620294094, decouple_loss:0.0023318773601204157
The modified gen p mean: 0.4471546709537506, gen p mean: -0.2509572505950928, mean p set: 0.44768035411834717The modified gen p mean: 0.4473591148853302, gen p mean: -0.2501276135444641, mean p set: 0.4479365348815918
loss_pred:0.01605912670493126, decouple_loss:0.0024263772647827864
loss_pred:0.01535441167652607, decouple_loss:0.0024704919196665287
Iteration: 2008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469553828239441, gen p mean: -0.24746555089950562, mean p set: 0.4475388824939728
loss_pred:0.014313745312392712, decouple_loss:0.002491546096280217
The modified gen p mean: 0.44687944650650024, gen p mean: -0.2555004954338074, mean p set: 0.44745466113090515
loss_pred:0.015166882425546646, decouple_loss:0.0022491575218737125
The modified gen p mean: 0.44717028737068176, gen p mean: -0.25028762221336365, mean p set: 0.4476989209651947
loss_pred:0.015598131343722343, decouple_loss:0.0023612945806235075
Iteration: 2009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468768239021301, gen p mean: -0.24630819261074066, mean p set: 0.44745174050331116
loss_pred:0.015652509406208992, decouple_loss:0.002903483808040619
The modified gen p mean: 0.44735923409461975, gen p mean: -0.24737629294395447, mean p set: 0.447883665561676The modified gen p mean: 0.446441113948822, gen p mean: -0.24440240859985352, mean p set: 0.4470199644565582
loss_pred:0.015235671773552895, decouple_loss:0.002314278157427907
loss_pred:0.0163380466401577, decouple_loss:0.0026081677060574293
Iteration: 2010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475262761116028, gen p mean: -0.24956950545310974, mean p set: 0.4480966627597809
loss_pred:0.01547300536185503, decouple_loss:0.002220684429630637
The modified gen p mean: 0.4470161199569702, gen p mean: -0.25277063250541687, mean p set: 0.4475901126861572
loss_pred:0.015627197921276093, decouple_loss:0.0025096251629292965
The modified gen p mean: 0.4463062286376953, gen p mean: -0.253253698348999, mean p set: 0.4468272626399994
loss_pred:0.015966301783919334, decouple_loss:0.0030001711566001177
2023-04-27 07:13:52 testing...
The modified gen p mean: 0.4482256770133972, gen p mean: -0.25268587470054626, mean p set: 0.44879910349845886
loss_pred:0.016910918056964874, decouple_loss:0.0029478727374225855
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2550095021724701, mean p set: 0.4499112665653229
loss_pred:0.016951443627476692, decouple_loss:0.0028481914196163416
The modified gen p mean: 0.44930025935173035, gen p mean: -0.25562241673469543, mean p set: 0.4498290419578552
loss_pred:0.016428949311375618, decouple_loss:0.0026465877890586853
WV_1_PC_1_EH_0_PS_30, loss: 0.016904480755329132, avg_mse: 0.025026369839906693
current test mse: 0.025026
Iteration: 2011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446159303188324, gen p mean: -0.256030410528183, mean p set: 0.4467359483242035
loss_pred:0.01563147082924843, decouple_loss:0.0025035024154931307
The modified gen p mean: 0.44668930768966675, gen p mean: -0.25718700885772705, mean p set: 0.44726207852363586
loss_pred:0.015385925769805908, decouple_loss:0.0028640374075621367
The modified gen p mean: 0.44755780696868896, gen p mean: -0.256324827671051, mean p set: 0.4480864405632019
loss_pred:0.015221727080643177, decouple_loss:0.0026227179914712906
Iteration: 2012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461783170700073, gen p mean: -0.25095534324645996, mean p set: 0.446708619594574
loss_pred:0.015348204411566257, decouple_loss:0.0025767397601157427
The modified gen p mean: 0.44615301489830017, gen p mean: -0.25562381744384766, mean p set: 0.44672611355781555
loss_pred:0.01652146875858307, decouple_loss:0.002615121891722083
The modified gen p mean: 0.4464104175567627, gen p mean: -0.25393030047416687, mean p set: 0.44698208570480347
loss_pred:0.016341615468263626, decouple_loss:0.0025956048630177975
Iteration: 2013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606220722198486, gen p mean: -0.2568426728248596, mean p set: 0.44659891724586487
loss_pred:0.015587651170790195, decouple_loss:0.003268755506724119
The modified gen p mean: 0.44643843173980713, gen p mean: -0.2589086890220642, mean p set: 0.44700896739959717
loss_pred:0.015326510183513165, decouple_loss:0.0026874763425439596
The modified gen p mean: 0.4472655653953552, gen p mean: -0.2613771855831146, mean p set: 0.4478432536125183
loss_pred:0.015598892234265804, decouple_loss:0.002682610647752881
Iteration: 2014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44576480984687805, gen p mean: -0.2581029534339905, mean p set: 0.4462953209877014
loss_pred:0.014915065839886665, decouple_loss:0.0023731181863695383
The modified gen p mean: 0.44669055938720703, gen p mean: -0.26320680975914, mean p set: 0.44725584983825684
loss_pred:0.01517038606107235, decouple_loss:0.002478931564837694
The modified gen p mean: 0.447432279586792, gen p mean: -0.2582966983318329, mean p set: 0.4480128884315491
loss_pred:0.016363663598895073, decouple_loss:0.002537210937589407
Iteration: 2015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692298769950867, gen p mean: -0.2572372257709503, mean p set: 0.44749605655670166
loss_pred:0.01572519913315773, decouple_loss:0.0026149419136345387
The modified gen p mean: 0.4459810256958008, gen p mean: -0.2557002007961273, mean p set: 0.4465586841106415
loss_pred:0.015850195661187172, decouple_loss:0.0024071140214800835
The modified gen p mean: 0.446431964635849, gen p mean: -0.2567635774612427, mean p set: 0.44696730375289917
loss_pred:0.014982006512582302, decouple_loss:0.0024595200084149837
Iteration: 2016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465298354625702, gen p mean: -0.2533516585826874, mean p set: 0.44709739089012146
loss_pred:0.015972068533301353, decouple_loss:0.002299654996022582
The modified gen p mean: 0.44689783453941345, gen p mean: -0.2591680586338043, mean p set: 0.4474724233150482
loss_pred:0.015508437529206276, decouple_loss:0.0021779939997941256
The modified gen p mean: 0.4465555250644684, gen p mean: -0.2530013620853424, mean p set: 0.4470832645893097
loss_pred:0.015192539431154728, decouple_loss:0.002743154065683484
Iteration: 2017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645023345947266, gen p mean: -0.2517544627189636, mean p set: 0.44702792167663574
loss_pred:0.015274306759238243, decouple_loss:0.002351125469431281
The modified gen p mean: 0.44668933749198914, gen p mean: -0.2585144639015198, mean p set: 0.44722431898117065The modified gen p mean: 0.44557157158851624, gen p mean: -0.2524740993976593, mean p set: 0.4461430609226227
loss_pred:0.016161516308784485, decouple_loss:0.0026180599816143513
loss_pred:0.015200641937553883, decouple_loss:0.0027495911344885826
Iteration: 2018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44589245319366455, gen p mean: -0.2521412670612335, mean p set: 0.4464685022830963
loss_pred:0.01604517549276352, decouple_loss:0.002255324274301529
The modified gen p mean: 0.44659149646759033, gen p mean: -0.25242966413497925, mean p set: 0.44716861844062805The modified gen p mean: 0.4475174844264984, gen p mean: -0.25738224387168884, mean p set: 0.4480500817298889
loss_pred:0.015213347971439362, decouple_loss:0.0022950181737542152
loss_pred:0.014510954730212688, decouple_loss:0.0023976375814527273
Iteration: 2019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456525146961212, gen p mean: -0.2546296715736389, mean p set: 0.44622352719306946
loss_pred:0.015683086588978767, decouple_loss:0.0023848568089306355
The modified gen p mean: 0.44775307178497314, gen p mean: -0.25597527623176575, mean p set: 0.4483300447463989
loss_pred:0.015587945468723774, decouple_loss:0.002634880831465125
The modified gen p mean: 0.4463333785533905, gen p mean: -0.2530195415019989, mean p set: 0.4468649923801422
loss_pred:0.015492151491343975, decouple_loss:0.002277176594361663
Iteration: 2020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469923675060272, gen p mean: -0.25922301411628723, mean p set: 0.44756782054901123
loss_pred:0.014826384373009205, decouple_loss:0.002500214148312807
The modified gen p mean: 0.4464681148529053, gen p mean: -0.2573804259300232, mean p set: 0.4469989240169525The modified gen p mean: 0.4476228952407837, gen p mean: -0.25559231638908386, mean p set: 0.44819650053977966
loss_pred:0.01505032554268837, decouple_loss:0.002524174749851227
loss_pred:0.015458943322300911, decouple_loss:0.002488823141902685
2023-04-27 07:17:18 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25972142815589905, mean p set: 0.4499112665653229
loss_pred:0.016874199733138084, decouple_loss:0.002776017179712653
The modified gen p mean: 0.4492990970611572, gen p mean: -0.260479211807251, mean p set: 0.4498290419578552
loss_pred:0.016424627974629402, decouple_loss:0.0025716302916407585
The modified gen p mean: 0.4482247829437256, gen p mean: -0.25781989097595215, mean p set: 0.44879910349845886
loss_pred:0.01687389425933361, decouple_loss:0.002654883312061429
WV_1_PC_1_EH_0_PS_30, loss: 0.01685761660337448, avg_mse: 0.02490704134106636
current test mse: 0.024907
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 2021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466303288936615, gen p mean: -0.2615005671977997, mean p set: 0.4471592903137207
loss_pred:0.015159718692302704, decouple_loss:0.0022801775485277176
The modified gen p mean: 0.4482157230377197, gen p mean: -0.26147282123565674, mean p set: 0.448797345161438
loss_pred:0.01568734087049961, decouple_loss:0.002805988537147641
The modified gen p mean: 0.4463692009449005, gen p mean: -0.2655869126319885, mean p set: 0.4469473958015442
loss_pred:0.01587190292775631, decouple_loss:0.0023618892300873995
Iteration: 2022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771572947502136, gen p mean: -0.2615455090999603, mean p set: 0.4482457637786865
loss_pred:0.015244793146848679, decouple_loss:0.002694213530048728
The modified gen p mean: 0.4475400745868683, gen p mean: -0.2586895823478699, mean p set: 0.4481104910373688
The modified gen p mean: 0.4479161500930786, gen p mean: -0.25350603461265564, mean p set: 0.4484897553920746
loss_pred:0.015074004419147968, decouple_loss:0.0028907840605825186
loss_pred:0.015568089671432972, decouple_loss:0.0026735211722552776
Iteration: 2023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464721381664276, gen p mean: -0.2603543996810913, mean p set: 0.44699788093566895
loss_pred:0.015725210309028625, decouple_loss:0.0027926750481128693
The modified gen p mean: 0.44624173641204834, gen p mean: -0.26049965620040894, mean p set: 0.4468221068382263
The modified gen p mean: 0.44852524995803833, gen p mean: -0.25167033076286316, mean p set: 0.449098140001297
loss_pred:0.015478993766009808, decouple_loss:0.003005214734002948
loss_pred:0.015480020083487034, decouple_loss:0.0024277037009596825
Iteration: 2024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447003573179245, gen p mean: -0.2530762851238251, mean p set: 0.44752857089042664
loss_pred:0.015196550637483597, decouple_loss:0.002438083291053772
The modified gen p mean: 0.44755882024765015, gen p mean: -0.2573356330394745, mean p set: 0.44813334941864014
The modified gen p mean: 0.44657769799232483, gen p mean: -0.2509039640426636, mean p set: 0.4471484422683716
loss_pred:0.01508414838463068, decouple_loss:0.002736030612140894
loss_pred:0.014990882016718388, decouple_loss:0.002410909626632929
Iteration: 2025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740718603134155, gen p mean: -0.2567322850227356, mean p set: 0.44798544049263
loss_pred:0.015952665358781815, decouple_loss:0.0023627912160009146
The modified gen p mean: 0.4462687373161316, gen p mean: -0.26268529891967773, mean p set: 0.4468388855457306The modified gen p mean: 0.4469161927700043, gen p mean: -0.2607088088989258, mean p set: 0.44744372367858887
loss_pred:0.015618298202753067, decouple_loss:0.002451807726174593
loss_pred:0.015674356371164322, decouple_loss:0.0023955381475389004
Iteration: 2026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678160548210144, gen p mean: -0.25226691365242004, mean p set: 0.4473569989204407
loss_pred:0.014806944876909256, decouple_loss:0.002280289074406028
The modified gen p mean: 0.4484444558620453, gen p mean: -0.257809579372406, mean p set: 0.44897395372390747The modified gen p mean: 0.4469641447067261, gen p mean: -0.25627848505973816, mean p set: 0.44753316044807434
loss_pred:0.016597917303442955, decouple_loss:0.0022579010110348463
loss_pred:0.015311066061258316, decouple_loss:0.0023157421965152025
Iteration: 2027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482121467590332, gen p mean: -0.2563924789428711, mean p set: 0.4487859904766083
loss_pred:0.01533503644168377, decouple_loss:0.0023458199575543404
The modified gen p mean: 0.44683560729026794, gen p mean: -0.25645747780799866, mean p set: 0.44736534357070923The modified gen p mean: 0.4484230577945709, gen p mean: -0.2531113028526306, mean p set: 0.44899824261665344
loss_pred:0.01496044173836708, decouple_loss:0.002504628151655197
loss_pred:0.01592089608311653, decouple_loss:0.0022984861861914396
Iteration: 2028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489257037639618, gen p mean: -0.255237340927124, mean p set: 0.4494958221912384
loss_pred:0.015278239734470844, decouple_loss:0.002648687455803156
The modified gen p mean: 0.4474547505378723, gen p mean: -0.24989347159862518, mean p set: 0.44803139567375183
loss_pred:0.01570720225572586, decouple_loss:0.0023162001743912697
The modified gen p mean: 0.44749656319618225, gen p mean: -0.2479795664548874, mean p set: 0.44802284240722656
loss_pred:0.015047264285385609, decouple_loss:0.002415581839159131
Iteration: 2029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718554615974426, gen p mean: -0.24569548666477203, mean p set: 0.4477604627609253
loss_pred:0.01561051793396473, decouple_loss:0.002439602743834257
The modified gen p mean: 0.44793152809143066, gen p mean: -0.2501246929168701, mean p set: 0.44846174120903015The modified gen p mean: 0.44749075174331665, gen p mean: -0.25330859422683716, mean p set: 0.4480628967285156
loss_pred:0.015602635219693184, decouple_loss:0.0026003625243902206
loss_pred:0.015580130741000175, decouple_loss:0.002412502421066165
Iteration: 2030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470657706260681, gen p mean: -0.2393530309200287, mean p set: 0.4476413428783417
loss_pred:0.015179607085883617, decouple_loss:0.002254343591630459
The modified gen p mean: 0.4472842812538147, gen p mean: -0.24419118463993073, mean p set: 0.4478605389595032
loss_pred:0.015931658446788788, decouple_loss:0.002337976126000285
The modified gen p mean: 0.4477347433567047, gen p mean: -0.24794086813926697, mean p set: 0.4482575058937073
loss_pred:0.015466475859284401, decouple_loss:0.002313139382749796
2023-04-27 07:21:22 testing...
The modified gen p mean: 0.44821876287460327, gen p mean: -0.23827996850013733, mean p set: 0.44879910349845886
loss_pred:0.016957521438598633, decouple_loss:0.0027888594195246696
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24072648584842682, mean p set: 0.4499112665653229
loss_pred:0.01700257509946823, decouple_loss:0.002889526542276144
The modified gen p mean: 0.44929975271224976, gen p mean: -0.241108238697052, mean p set: 0.4498290419578552
loss_pred:0.01650923304259777, decouple_loss:0.0026484192349016666
WV_1_PC_1_EH_0_PS_30, loss: 0.01696189120411873, avg_mse: 0.02516828291118145
current test mse: 0.025168
Iteration: 2031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681447744369507, gen p mean: -0.23740558326244354, mean p set: 0.44738900661468506
loss_pred:0.014746120199561119, decouple_loss:0.0023699491284787655
The modified gen p mean: 0.4479217827320099, gen p mean: -0.24488051235675812, mean p set: 0.4484971761703491
loss_pred:0.014823787845671177, decouple_loss:0.002392563736066222
The modified gen p mean: 0.44688206911087036, gen p mean: -0.24258671700954437, mean p set: 0.4474082589149475
loss_pred:0.016284681856632233, decouple_loss:0.002212292980402708
Iteration: 2032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465775489807129, gen p mean: -0.2452855408191681, mean p set: 0.4471015930175781
loss_pred:0.016321448609232903, decouple_loss:0.0024879046250134706
The modified gen p mean: 0.4483259320259094, gen p mean: -0.2424255907535553, mean p set: 0.44890403747558594
loss_pred:0.015226298943161964, decouple_loss:0.0026501950342208147
The modified gen p mean: 0.44835010170936584, gen p mean: -0.23506204783916473, mean p set: 0.4489316940307617
loss_pred:0.014881513081490993, decouple_loss:0.0025526804383844137
Iteration: 2033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495563507080078, gen p mean: -0.2411607950925827, mean p set: 0.4500883221626282
loss_pred:0.01462646946310997, decouple_loss:0.0028096542228013277
The modified gen p mean: 0.446387380361557, gen p mean: -0.24072378873825073, mean p set: 0.4469609558582306
loss_pred:0.014578185975551605, decouple_loss:0.002858245512470603
The modified gen p mean: 0.44679856300354004, gen p mean: -0.23723912239074707, mean p set: 0.44737815856933594
loss_pred:0.015267578884959221, decouple_loss:0.0026317115407437086
Iteration: 2034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767361879348755, gen p mean: -0.24254772067070007, mean p set: 0.44820234179496765
loss_pred:0.015689443796873093, decouple_loss:0.0022398128639906645
The modified gen p mean: 0.4467020630836487, gen p mean: -0.2496350258588791, mean p set: 0.44728177785873413
loss_pred:0.0161153431981802, decouple_loss:0.0026197389233857393
The modified gen p mean: 0.4493180513381958, gen p mean: -0.248054638504982, mean p set: 0.44989389181137085
loss_pred:0.014685791917145252, decouple_loss:0.002411660272628069
Iteration: 2035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472506642341614, gen p mean: -0.2430923730134964, mean p set: 0.4478318989276886
loss_pred:0.015875590965151787, decouple_loss:0.002538378583267331
The modified gen p mean: 0.44651302695274353, gen p mean: -0.25363653898239136, mean p set: 0.44703981280326843The modified gen p mean: 0.44714343547821045, gen p mean: -0.24728114902973175, mean p set: 0.4477183520793915
loss_pred:0.01560320146381855, decouple_loss:0.0026149258483201265
loss_pred:0.01636548526585102, decouple_loss:0.0024622699711471796
Iteration: 2036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749516248703003, gen p mean: -0.24979956448078156, mean p set: 0.44807443022727966
loss_pred:0.014775608666241169, decouple_loss:0.0024138859007507563
The modified gen p mean: 0.4481399655342102, gen p mean: -0.2474706470966339, mean p set: 0.4487267732620239
loss_pred:0.015267079696059227, decouple_loss:0.0024502763990312815
The modified gen p mean: 0.44655710458755493, gen p mean: -0.2458304464817047, mean p set: 0.4470820426940918
loss_pred:0.015480962581932545, decouple_loss:0.0024569223169237375
Iteration: 2037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803571701049805, gen p mean: -0.23811690509319305, mean p set: 0.44861525297164917
loss_pred:0.015817441046237946, decouple_loss:0.002479089656844735
The modified gen p mean: 0.44656723737716675, gen p mean: -0.2399391531944275, mean p set: 0.44714486598968506The modified gen p mean: 0.44699183106422424, gen p mean: -0.23650817573070526, mean p set: 0.44751542806625366
loss_pred:0.014349293895065784, decouple_loss:0.002365196356549859
loss_pred:0.014846613630652428, decouple_loss:0.002329791896045208
Iteration: 2038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676998257637024, gen p mean: -0.24805189669132233, mean p set: 0.4473494589328766
loss_pred:0.016156364232301712, decouple_loss:0.002650142414495349
The modified gen p mean: 0.44624558091163635, gen p mean: -0.24673683941364288, mean p set: 0.44677209854125977The modified gen p mean: 0.44676223397254944, gen p mean: -0.24025952816009521, mean p set: 0.44733917713165283
loss_pred:0.015274752862751484, decouple_loss:0.0026089230086654425
loss_pred:0.015377826988697052, decouple_loss:0.0026130089536309242
Iteration: 2039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468535780906677, gen p mean: -0.2368534654378891, mean p set: 0.4474294185638428
loss_pred:0.01451886910945177, decouple_loss:0.0023652007803320885
The modified gen p mean: 0.44752857089042664, gen p mean: -0.2416827529668808, mean p set: 0.4481140077114105
loss_pred:0.014842166565358639, decouple_loss:0.0025238494854420424
The modified gen p mean: 0.44757533073425293, gen p mean: -0.23556841909885406, mean p set: 0.4481060206890106
loss_pred:0.015716347843408585, decouple_loss:0.0024045624304562807
Iteration: 2040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914907217025757, gen p mean: -0.23528695106506348, mean p set: 0.4497283697128296
loss_pred:0.014796952717006207, decouple_loss:0.0029295003041625023
The modified gen p mean: 0.4473952353000641, gen p mean: -0.23260971903800964, mean p set: 0.4479648470878601
loss_pred:0.015254643745720387, decouple_loss:0.0025252311024814844
The modified gen p mean: 0.446871817111969, gen p mean: -0.23787309229373932, mean p set: 0.4473989009857178
loss_pred:0.01626785285770893, decouple_loss:0.002587434370070696
2023-04-27 07:24:47 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23569737374782562, mean p set: 0.4499112665653229
loss_pred:0.01706654019653797, decouple_loss:0.003066528355702758
The modified gen p mean: 0.44929662346839905, gen p mean: -0.23624685406684875, mean p set: 0.4498290419578552
loss_pred:0.016563544049859047, decouple_loss:0.002903273096308112
The modified gen p mean: 0.448219895362854, gen p mean: -0.23351916670799255, mean p set: 0.44879910349845886
loss_pred:0.016972476616501808, decouple_loss:0.0029020332731306553
WV_1_PC_1_EH_0_PS_30, loss: 0.017015384510159492, avg_mse: 0.02520899474620819
current test mse: 0.025209
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 2041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756174087524414, gen p mean: -0.2362646609544754, mean p set: 0.4480991065502167
loss_pred:0.01586259715259075, decouple_loss:0.002954659750685096
The modified gen p mean: 0.446475625038147, gen p mean: -0.2373845875263214, mean p set: 0.4470498263835907
loss_pred:0.015252441167831421, decouple_loss:0.0026551459450274706
The modified gen p mean: 0.44734179973602295, gen p mean: -0.2369716912508011, mean p set: 0.447918564081192
loss_pred:0.015248686075210571, decouple_loss:0.0026668899226933718
Iteration: 2042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455496668815613, gen p mean: -0.24224059283733368, mean p set: 0.4460800588130951
loss_pred:0.015563668683171272, decouple_loss:0.0026294563431292772
The modified gen p mean: 0.44613805413246155, gen p mean: -0.23501040041446686, mean p set: 0.44671353697776794
The modified gen p mean: 0.4452020823955536, gen p mean: -0.23855313658714294, mean p set: 0.4457741975784302
loss_pred:0.015966350212693214, decouple_loss:0.0025762321893125772
loss_pred:0.01563132368028164, decouple_loss:0.002709873951971531
Iteration: 2043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457075893878937, gen p mean: -0.24136371910572052, mean p set: 0.4462362825870514
loss_pred:0.015401190146803856, decouple_loss:0.002422380493953824
The modified gen p mean: 0.4457378685474396, gen p mean: -0.2464730441570282, mean p set: 0.44631776213645935
The modified gen p mean: 0.44639965891838074, gen p mean: -0.2450399100780487, mean p set: 0.4469846189022064
loss_pred:0.015433914959430695, decouple_loss:0.002382050035521388
loss_pred:0.01637204922735691, decouple_loss:0.0025265163276344538
Iteration: 2044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657811522483826, gen p mean: -0.24384726583957672, mean p set: 0.447105348110199
loss_pred:0.016012294217944145, decouple_loss:0.0026624861638993025
The modified gen p mean: 0.44636160135269165, gen p mean: -0.24653594195842743, mean p set: 0.44692856073379517
The modified gen p mean: 0.4468778073787689, gen p mean: -0.24608214199543, mean p set: 0.4474559724330902
loss_pred:0.015403791330754757, decouple_loss:0.002574875019490719
loss_pred:0.015392244793474674, decouple_loss:0.002988682361319661
Iteration: 2045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644638895988464, gen p mean: -0.25038421154022217, mean p set: 0.4470173120498657
loss_pred:0.015590794384479523, decouple_loss:0.0023628855124115944
The modified gen p mean: 0.4472309350967407, gen p mean: -0.2516530156135559, mean p set: 0.44775912165641785The modified gen p mean: 0.4468057453632355, gen p mean: -0.24889510869979858, mean p set: 0.44737792015075684
loss_pred:0.016238391399383545, decouple_loss:0.0024846242740750313
loss_pred:0.015538899227976799, decouple_loss:0.002433819230645895
Iteration: 2046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636061787605286, gen p mean: -0.25477656722068787, mean p set: 0.4469307065010071
loss_pred:0.016698699444532394, decouple_loss:0.0027808104641735554
The modified gen p mean: 0.44617581367492676, gen p mean: -0.25142359733581543, mean p set: 0.4467087388038635The modified gen p mean: 0.44579920172691345, gen p mean: -0.253290593624115, mean p set: 0.4463808834552765
loss_pred:0.015931744128465652, decouple_loss:0.0026126918382942677
loss_pred:0.015925662592053413, decouple_loss:0.002614325378090143
Iteration: 2047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656190276145935, gen p mean: -0.2523868978023529, mean p set: 0.44713470339775085
loss_pred:0.016058240085840225, decouple_loss:0.00242410134524107
The modified gen p mean: 0.44755756855010986, gen p mean: -0.250207781791687, mean p set: 0.44807806611061096The modified gen p mean: 0.4463634490966797, gen p mean: -0.250677227973938, mean p set: 0.4469420909881592
loss_pred:0.0162802841514349, decouple_loss:0.0025529854465276003
loss_pred:0.016036543995141983, decouple_loss:0.002665457548573613
Iteration: 2048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755879044532776, gen p mean: -0.24841174483299255, mean p set: 0.44813206791877747
loss_pred:0.015807123854756355, decouple_loss:0.0023925614077597857
The modified gen p mean: 0.4483138918876648, gen p mean: -0.2515115439891815, mean p set: 0.44888943433761597
loss_pred:0.015694603323936462, decouple_loss:0.00235362839885056
The modified gen p mean: 0.4460063874721527, gen p mean: -0.2519085705280304, mean p set: 0.44653645157814026
loss_pred:0.014974075369536877, decouple_loss:0.0024356902576982975
Iteration: 2049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465988874435425, gen p mean: -0.2513107657432556, mean p set: 0.4471801817417145
loss_pred:0.01631811261177063, decouple_loss:0.002902735024690628
The modified gen p mean: 0.44563305377960205, gen p mean: -0.24152380228042603, mean p set: 0.44616246223449707The modified gen p mean: 0.44693854451179504, gen p mean: -0.24735549092292786, mean p set: 0.44751712679862976
loss_pred:0.016056189313530922, decouple_loss:0.0029192601796239614
loss_pred:0.015915652737021446, decouple_loss:0.003228670684620738
Iteration: 2050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463803172111511, gen p mean: -0.2466728389263153, mean p set: 0.44695183634757996
loss_pred:0.0157411377876997, decouple_loss:0.0023786763194948435
The modified gen p mean: 0.44622737169265747, gen p mean: -0.24399231374263763, mean p set: 0.44679760932922363
loss_pred:0.016334818676114082, decouple_loss:0.0024434144143015146
The modified gen p mean: 0.44678741693496704, gen p mean: -0.24259693920612335, mean p set: 0.4473114311695099
loss_pred:0.014883069321513176, decouple_loss:0.0025377862621098757
2023-04-27 07:28:48 testing...
The modified gen p mean: 0.44822943210601807, gen p mean: -0.2380853295326233, mean p set: 0.44879910349845886
loss_pred:0.01687242090702057, decouple_loss:0.0025966495741158724
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24048098921775818, mean p set: 0.4499112665653229
loss_pred:0.017005261033773422, decouple_loss:0.002875178586691618
The modified gen p mean: 0.4492977559566498, gen p mean: -0.24079802632331848, mean p set: 0.4498290419578552
loss_pred:0.01651354879140854, decouple_loss:0.0030060731805860996
WV_1_PC_1_EH_0_PS_30, loss: 0.016938377171754837, avg_mse: 0.02507125213742256
current test mse: 0.025071
Iteration: 2051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466187059879303, gen p mean: -0.24418573081493378, mean p set: 0.4471932351589203
loss_pred:0.016375260427594185, decouple_loss:0.002596945269033313
The modified gen p mean: 0.44741883873939514, gen p mean: -0.23997531831264496, mean p set: 0.44799020886421204
loss_pred:0.015259245410561562, decouple_loss:0.0029487009160220623
The modified gen p mean: 0.44543179869651794, gen p mean: -0.24498368799686432, mean p set: 0.44596222043037415
loss_pred:0.015530940145254135, decouple_loss:0.002456140937283635
Iteration: 2052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460257887840271, gen p mean: -0.24022632837295532, mean p set: 0.44655176997184753
loss_pred:0.016155708581209183, decouple_loss:0.002470251638442278
The modified gen p mean: 0.4458603858947754, gen p mean: -0.2431567758321762, mean p set: 0.44643494486808777
loss_pred:0.015477968379855156, decouple_loss:0.0024476065300405025
The modified gen p mean: 0.44715821743011475, gen p mean: -0.2413535714149475, mean p set: 0.447732150554657
loss_pred:0.015565910376608372, decouple_loss:0.002805250696837902
Iteration: 2053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474583864212036, gen p mean: -0.24216961860656738, mean p set: 0.4479850232601166
loss_pred:0.015856973826885223, decouple_loss:0.0028674008790403605
The modified gen p mean: 0.44583043456077576, gen p mean: -0.23903311789035797, mean p set: 0.4464031159877777
loss_pred:0.015398979187011719, decouple_loss:0.0027434909716248512
The modified gen p mean: 0.44687050580978394, gen p mean: -0.23789891600608826, mean p set: 0.44744786620140076
loss_pred:0.015601865947246552, decouple_loss:0.0029318544548004866
Iteration: 2054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459724724292755, gen p mean: -0.24446038901805878, mean p set: 0.4465000033378601
loss_pred:0.015156432054936886, decouple_loss:0.0024761026725172997
The modified gen p mean: 0.44611942768096924, gen p mean: -0.23848581314086914, mean p set: 0.44669607281684875
loss_pred:0.01504864264279604, decouple_loss:0.002481635892763734
The modified gen p mean: 0.4466772675514221, gen p mean: -0.24250993132591248, mean p set: 0.44725537300109863
loss_pred:0.015325398184359074, decouple_loss:0.0024121736641973257
Iteration: 2055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794148206710815, gen p mean: -0.244874507188797, mean p set: 0.44851207733154297
loss_pred:0.015156958252191544, decouple_loss:0.0027359172236174345
The modified gen p mean: 0.4477335512638092, gen p mean: -0.24458785355091095, mean p set: 0.4482622444629669
loss_pred:0.01597280614078045, decouple_loss:0.002861559623852372
The modified gen p mean: 0.4457421898841858, gen p mean: -0.24018727242946625, mean p set: 0.4463140368461609
loss_pred:0.015445109456777573, decouple_loss:0.002481697825714946
Iteration: 2056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44582512974739075, gen p mean: -0.24409373104572296, mean p set: 0.44640329480171204
loss_pred:0.015819597989320755, decouple_loss:0.002325369045138359
The modified gen p mean: 0.4478955864906311, gen p mean: -0.24459677934646606, mean p set: 0.4484235644340515The modified gen p mean: 0.447527140378952, gen p mean: -0.24452883005142212, mean p set: 0.44809842109680176
loss_pred:0.016134951263666153, decouple_loss:0.00240361038595438
loss_pred:0.015325584448873997, decouple_loss:0.0023635250981897116
Iteration: 2057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644686579704285, gen p mean: -0.2472369372844696, mean p set: 0.44702646136283875
loss_pred:0.015357961878180504, decouple_loss:0.0025782862212508917
The modified gen p mean: 0.44713690876960754, gen p mean: -0.2464350163936615, mean p set: 0.44766902923583984The modified gen p mean: 0.4463973939418793, gen p mean: -0.2508302628993988, mean p set: 0.4469722807407379
loss_pred:0.015407754108309746, decouple_loss:0.0026764837093651295
loss_pred:0.015335135161876678, decouple_loss:0.0025809481739997864
Iteration: 2058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731006026268005, gen p mean: -0.2473486363887787, mean p set: 0.44788745045661926
loss_pred:0.016058316454291344, decouple_loss:0.0023503187112510204
The modified gen p mean: 0.44614532589912415, gen p mean: -0.24893151223659515, mean p set: 0.44667407870292664The modified gen p mean: 0.44647279381752014, gen p mean: -0.25103434920310974, mean p set: 0.44704657793045044
loss_pred:0.015879660844802856, decouple_loss:0.0023399500641971827
loss_pred:0.016067897900938988, decouple_loss:0.0027509571518749
Iteration: 2059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461500644683838, gen p mean: -0.248958557844162, mean p set: 0.4467202425003052
loss_pred:0.015681544318795204, decouple_loss:0.0024944557808339596
The modified gen p mean: 0.4464799463748932, gen p mean: -0.24671344459056854, mean p set: 0.4470142424106598
The modified gen p mean: 0.4472976624965668, gen p mean: -0.24714459478855133, mean p set: 0.44787484407424927
loss_pred:0.015215902589261532, decouple_loss:0.0025652700569480658
loss_pred:0.01534160878509283, decouple_loss:0.002489024307578802
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479210674762726, gen p mean: -0.2493211179971695, mean p set: 0.4484979510307312
loss_pred:0.0159901175647974, decouple_loss:0.0023827997501939535
The modified gen p mean: 0.44779354333877563, gen p mean: -0.25021401047706604, mean p set: 0.448323518037796The modified gen p mean: 0.4466559588909149, gen p mean: -0.24524672329425812, mean p set: 0.4472399353981018
loss_pred:0.015645228326320648, decouple_loss:0.002396007999777794
loss_pred:0.0157913938164711, decouple_loss:0.0023948142770677805
2023-04-27 07:32:14 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2508511543273926, mean p set: 0.4499112665653229
loss_pred:0.016799136996269226, decouple_loss:0.002496844856068492
The modified gen p mean: 0.448221892118454, gen p mean: -0.24831192195415497, mean p set: 0.44879910349845886
loss_pred:0.0168635044246912, decouple_loss:0.0024493655655533075
The modified gen p mean: 0.4493061304092407, gen p mean: -0.25113797187805176, mean p set: 0.4498290419578552
loss_pred:0.016372285783290863, decouple_loss:0.0025800256989896297
WV_1_PC_1_EH_0_PS_30, loss: 0.016803747043013573, avg_mse: 0.024875840172171593
current test mse: 0.024876
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 2061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446746826171875, gen p mean: -0.25166964530944824, mean p set: 0.4472792148590088
loss_pred:0.015265760011970997, decouple_loss:0.002351186005398631
The modified gen p mean: 0.44769376516342163, gen p mean: -0.24828381836414337, mean p set: 0.4482676684856415
loss_pred:0.01514406781643629, decouple_loss:0.0027939409483224154
The modified gen p mean: 0.4472249448299408, gen p mean: -0.25700604915618896, mean p set: 0.44780364632606506
loss_pred:0.015364527702331543, decouple_loss:0.0023098140954971313
Iteration: 2062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481053948402405, gen p mean: -0.25204798579216003, mean p set: 0.44863179326057434
loss_pred:0.014703551307320595, decouple_loss:0.002569720381870866
The modified gen p mean: 0.44718703627586365, gen p mean: -0.25319284200668335, mean p set: 0.44775503873825073
loss_pred:0.014759482815861702, decouple_loss:0.0026436590123921633
The modified gen p mean: 0.4477074444293976, gen p mean: -0.24848619103431702, mean p set: 0.4482842683792114
loss_pred:0.015529695898294449, decouple_loss:0.0028901740442961454
Iteration: 2063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943633675575256, gen p mean: -0.24297800660133362, mean p set: 0.4499603509902954
loss_pred:0.014633635058999062, decouple_loss:0.00264103920198977
The modified gen p mean: 0.44779637455940247, gen p mean: -0.2499515414237976, mean p set: 0.4483700692653656
loss_pred:0.01429317332804203, decouple_loss:0.0024104726035147905
The modified gen p mean: 0.44763875007629395, gen p mean: -0.2522330582141876, mean p set: 0.44821614027023315
loss_pred:0.015210570767521858, decouple_loss:0.0025162373203784227
Iteration: 2064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770029187202454, gen p mean: -0.24554501473903656, mean p set: 0.44822585582733154
loss_pred:0.015290655195713043, decouple_loss:0.0026341627817600965
The modified gen p mean: 0.4480348825454712, gen p mean: -0.2480979561805725, mean p set: 0.44860655069351196
loss_pred:0.014501665718853474, decouple_loss:0.0025636593345552683
The modified gen p mean: 0.44755223393440247, gen p mean: -0.25148627161979675, mean p set: 0.44812917709350586
loss_pred:0.015374105423688889, decouple_loss:0.002388536464422941
Iteration: 2065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759833812713623, gen p mean: -0.25096386671066284, mean p set: 0.4481755197048187
loss_pred:0.014500437304377556, decouple_loss:0.0023704359773546457
The modified gen p mean: 0.4475391209125519, gen p mean: -0.24322736263275146, mean p set: 0.4480615258216858The modified gen p mean: 0.4478760361671448, gen p mean: -0.24358822405338287, mean p set: 0.44845467805862427
loss_pred:0.014491119422018528, decouple_loss:0.0023709035012871027
loss_pred:0.014189934358000755, decouple_loss:0.002583419205620885
Iteration: 2066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802114367485046, gen p mean: -0.24589569866657257, mean p set: 0.4485950767993927
loss_pred:0.014791639521718025, decouple_loss:0.002561404602602124
The modified gen p mean: 0.44715696573257446, gen p mean: -0.24100568890571594, mean p set: 0.4476836025714874The modified gen p mean: 0.4495284855365753, gen p mean: -0.24056513607501984, mean p set: 0.45010778307914734
loss_pred:0.0143140759319067, decouple_loss:0.002661763923242688
loss_pred:0.014079573564231396, decouple_loss:0.0023814875166863203
Iteration: 2067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658729434013367, gen p mean: -0.23997627198696136, mean p set: 0.4471684396266937
loss_pred:0.015295123681426048, decouple_loss:0.0025632812175899744
The modified gen p mean: 0.44643786549568176, gen p mean: -0.23689799010753632, mean p set: 0.44701725244522095
loss_pred:0.015210382640361786, decouple_loss:0.002422479446977377
The modified gen p mean: 0.4478422701358795, gen p mean: -0.24062325060367584, mean p set: 0.44836780428886414
loss_pred:0.016283445060253143, decouple_loss:0.002576755825430155
Iteration: 2068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470117688179016, gen p mean: -0.24022693932056427, mean p set: 0.4475933611392975
loss_pred:0.015385488048195839, decouple_loss:0.002887549577280879
The modified gen p mean: 0.44680777192115784, gen p mean: -0.24803036451339722, mean p set: 0.4473792016506195
loss_pred:0.015052692964673042, decouple_loss:0.002623662818223238
The modified gen p mean: 0.4471546411514282, gen p mean: -0.24385346472263336, mean p set: 0.44768205285072327
loss_pred:0.01600569859147072, decouple_loss:0.0027689533308148384
Iteration: 2069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701871275901794, gen p mean: -0.2536171078681946, mean p set: 0.44753962755203247
loss_pred:0.014688150025904179, decouple_loss:0.002537165069952607
The modified gen p mean: 0.447376549243927, gen p mean: -0.24269147217273712, mean p set: 0.4479523003101349
loss_pred:0.015186090022325516, decouple_loss:0.002560508204624057
The modified gen p mean: 0.44756895303726196, gen p mean: -0.24642513692378998, mean p set: 0.44813597202301025
loss_pred:0.015160354785621166, decouple_loss:0.0024198265746235847
Iteration: 2070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472101628780365, gen p mean: -0.25444868206977844, mean p set: 0.4477936327457428
loss_pred:0.014352064579725266, decouple_loss:0.0023037560749799013
The modified gen p mean: 0.44725826382637024, gen p mean: -0.2505621612071991, mean p set: 0.44783204793930054
loss_pred:0.0149116525426507, decouple_loss:0.0023773133289068937
The modified gen p mean: 0.4478946924209595, gen p mean: -0.24927306175231934, mean p set: 0.44842052459716797
loss_pred:0.014777624048292637, decouple_loss:0.0022975767496973276
2023-04-27 07:36:20 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25151100754737854, mean p set: 0.4499112665653229
loss_pred:0.017021555453538895, decouple_loss:0.002594832330942154
The modified gen p mean: 0.44930124282836914, gen p mean: -0.2511362135410309, mean p set: 0.4498290419578552
loss_pred:0.016566548496484756, decouple_loss:0.0027619688771665096
The modified gen p mean: 0.44822028279304504, gen p mean: -0.24864938855171204, mean p set: 0.44879910349845886
loss_pred:0.016985783353447914, decouple_loss:0.002559433225542307
WV_1_PC_1_EH_0_PS_30, loss: 0.016989899799227715, avg_mse: 0.02516986057162285
current test mse: 0.02517
Iteration: 2071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446736216545105, gen p mean: -0.2540288269519806, mean p set: 0.4473148286342621
loss_pred:0.014707324095070362, decouple_loss:0.002519238507375121
The modified gen p mean: 0.44734030961990356, gen p mean: -0.24967436492443085, mean p set: 0.4478708505630493
loss_pred:0.014306549914181232, decouple_loss:0.0023630736395716667
The modified gen p mean: 0.4474026560783386, gen p mean: -0.24795982241630554, mean p set: 0.44798195362091064
loss_pred:0.01480508130043745, decouple_loss:0.002602590713649988
Iteration: 2072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476442337036133, gen p mean: -0.25223618745803833, mean p set: 0.4481693506240845
loss_pred:0.014437566511332989, decouple_loss:0.0025047985836863518
The modified gen p mean: 0.4486094117164612, gen p mean: -0.2509525418281555, mean p set: 0.44918543100357056
The modified gen p mean: 0.44847774505615234, gen p mean: -0.2485603243112564, mean p set: 0.44905948638916016
loss_pred:0.014324121177196503, decouple_loss:0.002673924434930086
loss_pred:0.01535083819180727, decouple_loss:0.002736112102866173
Iteration: 2073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480651021003723, gen p mean: -0.24858136475086212, mean p set: 0.44859078526496887
loss_pred:0.0141715994104743, decouple_loss:0.002350353403016925
The modified gen p mean: 0.44756895303726196, gen p mean: -0.24020321667194366, mean p set: 0.44814783334732056
The modified gen p mean: 0.44844138622283936, gen p mean: -0.23957377672195435, mean p set: 0.4490176737308502
loss_pred:0.014736776240170002, decouple_loss:0.002732578432187438
loss_pred:0.01483694463968277, decouple_loss:0.002613744232803583
Iteration: 2074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736507534980774, gen p mean: -0.23841504752635956, mean p set: 0.4478912055492401
loss_pred:0.015615119598805904, decouple_loss:0.002544043119996786
The modified gen p mean: 0.44693395495414734, gen p mean: -0.2387971132993698, mean p set: 0.4475088119506836
The modified gen p mean: 0.44775620102882385, gen p mean: -0.24159586429595947, mean p set: 0.4483305513858795
loss_pred:0.014909542165696621, decouple_loss:0.002411229768767953
loss_pred:0.015441286377608776, decouple_loss:0.0026086599100381136
Iteration: 2075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485422968864441, gen p mean: -0.23847655951976776, mean p set: 0.4491144120693207
loss_pred:0.01491951197385788, decouple_loss:0.00253052799962461
The modified gen p mean: 0.44803011417388916, gen p mean: -0.23812668025493622, mean p set: 0.44856393337249756
The modified gen p mean: 0.448729932308197, gen p mean: -0.2467622309923172, mean p set: 0.449308842420578
loss_pred:0.015235408209264278, decouple_loss:0.0024700143840163946
loss_pred:0.014213786460459232, decouple_loss:0.0023289674427360296
Iteration: 2076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489935338497162, gen p mean: -0.24277840554714203, mean p set: 0.4495725929737091
loss_pred:0.01492153201252222, decouple_loss:0.002517334884032607
The modified gen p mean: 0.44764408469200134, gen p mean: -0.2571694552898407, mean p set: 0.44816869497299194
The modified gen p mean: 0.4479432702064514, gen p mean: -0.2497340589761734, mean p set: 0.4485217034816742
loss_pred:0.014623990282416344, decouple_loss:0.0024229194968938828
loss_pred:0.015343963168561459, decouple_loss:0.002541253110393882
Iteration: 2077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806739687919617, gen p mean: -0.2513561546802521, mean p set: 0.4486410617828369
loss_pred:0.014498064294457436, decouple_loss:0.0023898854851722717
The modified gen p mean: 0.44788655638694763, gen p mean: -0.2519727051258087, mean p set: 0.44845813512802124
loss_pred:0.014089149422943592, decouple_loss:0.0022987325210124254
The modified gen p mean: 0.448581725358963, gen p mean: -0.24382656812667847, mean p set: 0.4491148293018341
loss_pred:0.014675996266305447, decouple_loss:0.0024418500252068043
Iteration: 2078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469478130340576, gen p mean: -0.2451845407485962, mean p set: 0.4475235044956207
loss_pred:0.014809315092861652, decouple_loss:0.0022639769595116377
The modified gen p mean: 0.447666198015213, gen p mean: -0.24271900951862335, mean p set: 0.44824254512786865
loss_pred:0.0155416801571846, decouple_loss:0.002310472307726741
The modified gen p mean: 0.4471358358860016, gen p mean: -0.24573376774787903, mean p set: 0.4476613700389862
loss_pred:0.014724903739988804, decouple_loss:0.0026864935643970966
Iteration: 2079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706061482429504, gen p mean: -0.24462737143039703, mean p set: 0.4476364552974701
loss_pred:0.015127438120543957, decouple_loss:0.0023402601946145296
The modified gen p mean: 0.4482482373714447, gen p mean: -0.24271181225776672, mean p set: 0.4487749934196472The modified gen p mean: 0.44704994559288025, gen p mean: -0.24132254719734192, mean p set: 0.4476158618927002
loss_pred:0.01515737734735012, decouple_loss:0.002474155044183135
loss_pred:0.015176459215581417, decouple_loss:0.0022458594758063555
Iteration: 2080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474835991859436, gen p mean: -0.25581076741218567, mean p set: 0.44805845618247986
loss_pred:0.014824636280536652, decouple_loss:0.0025453565176576376
The modified gen p mean: 0.4489806890487671, gen p mean: -0.246342733502388, mean p set: 0.4495594799518585
loss_pred:0.01453721895813942, decouple_loss:0.002628857968375087
The modified gen p mean: 0.44748467206954956, gen p mean: -0.254853755235672, mean p set: 0.4480154812335968
loss_pred:0.014620963484048843, decouple_loss:0.00241269264370203
2023-04-27 07:39:46 testing...
The modified gen p mean: 0.4482210874557495, gen p mean: -0.24772484600543976, mean p set: 0.44879910349845886
loss_pred:0.020717481151223183, decouple_loss:0.0026429961435496807
The modified gen p mean: 0.449303537607193, gen p mean: -0.24921056628227234, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2496214210987091, mean p set: 0.4499112665653229
loss_pred:0.020041409879922867, decouple_loss:0.0026402275543659925
loss_pred:0.020752940326929092, decouple_loss:0.0025792245287448168
WV_1_PC_1_EH_0_PS_30, loss: 0.020634984597563744, avg_mse: 0.03208363056182861
current test mse: 0.032084
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 2081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486410915851593, gen p mean: -0.2525043487548828, mean p set: 0.44917547702789307
loss_pred:0.018845224753022194, decouple_loss:0.0026684775948524475
The modified gen p mean: 0.4494992196559906, gen p mean: -0.24612820148468018, mean p set: 0.45008060336112976
The modified gen p mean: 0.4477827548980713, gen p mean: -0.2532210648059845, mean p set: 0.44836267828941345
loss_pred:0.018962478265166283, decouple_loss:0.0026095807552337646
loss_pred:0.019265273585915565, decouple_loss:0.0026930985040962696
Iteration: 2082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488750398159027, gen p mean: -0.2585800290107727, mean p set: 0.44941920042037964
loss_pred:0.028062906116247177, decouple_loss:0.004638102371245623
The modified gen p mean: 0.4471776783466339, gen p mean: -0.25755739212036133, mean p set: 0.4477550983428955
The modified gen p mean: 0.44790133833885193, gen p mean: -0.25713038444519043, mean p set: 0.44847777485847473
loss_pred:0.028137344866991043, decouple_loss:0.004745469894260168
loss_pred:0.02837800234556198, decouple_loss:0.004611473064869642
Iteration: 2083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486815631389618, gen p mean: -0.27268409729003906, mean p set: 0.4492034912109375
loss_pred:0.027745826169848442, decouple_loss:0.005537727382034063
The modified gen p mean: 0.4483747184276581, gen p mean: -0.2705545723438263, mean p set: 0.448948472738266
The modified gen p mean: 0.4486776888370514, gen p mean: -0.2693549394607544, mean p set: 0.4492538273334503
loss_pred:0.028129635378718376, decouple_loss:0.005351046100258827
loss_pred:0.027468742802739143, decouple_loss:0.005460625048726797
Iteration: 2084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844624400138855, gen p mean: -0.2512304484844208, mean p set: 0.44901934266090393
loss_pred:0.025752944871783257, decouple_loss:0.006700619123876095
The modified gen p mean: 0.44803932309150696, gen p mean: -0.24890033900737762, mean p set: 0.4486178159713745
loss_pred:0.026845546439290047, decouple_loss:0.006579734850674868
The modified gen p mean: 0.448346346616745, gen p mean: -0.2518889904022217, mean p set: 0.44887539744377136
loss_pred:0.025505580008029938, decouple_loss:0.006565683521330357
Iteration: 2085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852182269096375, gen p mean: -0.18382485210895538, mean p set: 0.44909700751304626
loss_pred:0.02346678450703621, decouple_loss:0.015291146002709866
The modified gen p mean: 0.44777819514274597, gen p mean: -0.1847715675830841, mean p set: 0.4483092129230499The modified gen p mean: 0.44883793592453003, gen p mean: -0.18648996949195862, mean p set: 0.4494136571884155
loss_pred:0.02518473193049431, decouple_loss:0.015475229360163212
loss_pred:0.02411453239619732, decouple_loss:0.015509014017879963
Iteration: 2086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491937756538391, gen p mean: -0.15919873118400574, mean p set: 0.4497707486152649
loss_pred:0.026428097859025, decouple_loss:0.014323635026812553
The modified gen p mean: 0.4484356939792633, gen p mean: -0.15803976356983185, mean p set: 0.44901350140571594
loss_pred:0.02672298438847065, decouple_loss:0.013975203037261963
The modified gen p mean: 0.4488089382648468, gen p mean: -0.15208034217357635, mean p set: 0.44933751225471497
loss_pred:0.026374053210020065, decouple_loss:0.014031006954610348
Iteration: 2087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482870101928711, gen p mean: -0.15177127718925476, mean p set: 0.4488604962825775
loss_pred:0.022188927978277206, decouple_loss:0.012776099145412445
The modified gen p mean: 0.44879138469696045, gen p mean: -0.1545156091451645, mean p set: 0.4493674635887146
loss_pred:0.023216115310788155, decouple_loss:0.011837382800877094
The modified gen p mean: 0.4481795132160187, gen p mean: -0.1522018164396286, mean p set: 0.4487088918685913
loss_pred:0.022147689014673233, decouple_loss:0.012161164544522762
Iteration: 2088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778886437416077, gen p mean: -0.11693552136421204, mean p set: 0.44836223125457764
loss_pred:0.02902795933187008, decouple_loss:0.016434647142887115
The modified gen p mean: 0.4474797248840332, gen p mean: -0.11821749806404114, mean p set: 0.4480117857456207
The modified gen p mean: 0.44749924540519714, gen p mean: -0.12068884819746017, mean p set: 0.4480784237384796
loss_pred:0.029444869607686996, decouple_loss:0.01639511249959469
loss_pred:0.028720596805214882, decouple_loss:0.015516728162765503
Iteration: 2089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716256856918335, gen p mean: -0.14414437115192413, mean p set: 0.44773876667022705
loss_pred:0.028332548215985298, decouple_loss:0.033406440168619156
The modified gen p mean: 0.44974949955940247, gen p mean: -0.14507541060447693, mean p set: 0.45032650232315063
loss_pred:0.02738257311284542, decouple_loss:0.03465006873011589
The modified gen p mean: 0.44765469431877136, gen p mean: -0.1406511515378952, mean p set: 0.4481810927391052
loss_pred:0.029629835858941078, decouple_loss:0.031130611896514893
Iteration: 2090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474332928657532, gen p mean: -0.13535228371620178, mean p set: 0.44801095128059387
loss_pred:0.02655629813671112, decouple_loss:0.01597750559449196
The modified gen p mean: 0.44931378960609436, gen p mean: -0.13764098286628723, mean p set: 0.449893057346344
loss_pred:0.02553929015994072, decouple_loss:0.015802918002009392
The modified gen p mean: 0.4475155174732208, gen p mean: -0.12475691735744476, mean p set: 0.44804272055625916
loss_pred:0.02477504499256611, decouple_loss:0.017074760049581528
2023-04-27 07:43:54 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.14316917955875397, mean p set: 0.4499112665653229
loss_pred:0.025503098964691162, decouple_loss:0.014334795996546745
The modified gen p mean: 0.44929996132850647, gen p mean: -0.14355036616325378, mean p set: 0.4498290419578552
loss_pred:0.025212090462446213, decouple_loss:0.014980819076299667
The modified gen p mean: 0.4482235312461853, gen p mean: -0.14038679003715515, mean p set: 0.44879910349845886
loss_pred:0.02512326091527939, decouple_loss:0.015270617790520191
WV_1_PC_1_EH_0_PS_30, loss: 0.026022588834166527, avg_mse: 0.0345110185444355
current test mse: 0.034511
Iteration: 2091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480234384536743, gen p mean: -0.1390700340270996, mean p set: 0.4485989212989807
loss_pred:0.02567731961607933, decouple_loss:0.01500781625509262
The modified gen p mean: 0.44895681738853455, gen p mean: -0.14433832466602325, mean p set: 0.44948384165763855
loss_pred:0.02594725601375103, decouple_loss:0.015125585719943047
The modified gen p mean: 0.4470949172973633, gen p mean: -0.13966526091098785, mean p set: 0.44766971468925476
loss_pred:0.02566552720963955, decouple_loss:0.01711360178887844
Iteration: 2092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448957622051239, gen p mean: -0.14226293563842773, mean p set: 0.449482798576355
loss_pred:0.022393256425857544, decouple_loss:0.014460090547800064
The modified gen p mean: 0.4482663571834564, gen p mean: -0.14498230814933777, mean p set: 0.44884148240089417
The modified gen p mean: 0.448283851146698, gen p mean: -0.15290167927742004, mean p set: 0.4488602578639984
loss_pred:0.02183341048657894, decouple_loss:0.014731533825397491
loss_pred:0.022664470598101616, decouple_loss:0.015325593762099743
Iteration: 2093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677734375, gen p mean: -0.14063845574855804, mean p set: 0.44730639457702637
loss_pred:0.022299423813819885, decouple_loss:0.01598053053021431
The modified gen p mean: 0.44921875, gen p mean: -0.1526409089565277, mean p set: 0.4497983753681183
The modified gen p mean: 0.4473188519477844, gen p mean: -0.14060690999031067, mean p set: 0.44789305329322815
loss_pred:0.023089531809091568, decouple_loss:0.017759501934051514
loss_pred:0.022443348541855812, decouple_loss:0.016349859535694122
Iteration: 2094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475736916065216, gen p mean: -0.16531330347061157, mean p set: 0.44810163974761963
loss_pred:0.021587509661912918, decouple_loss:0.016524409875273705
The modified gen p mean: 0.44939979910850525, gen p mean: -0.16341263055801392, mean p set: 0.4499812126159668
The modified gen p mean: 0.4497024416923523, gen p mean: -0.15576355159282684, mean p set: 0.4502778649330139
loss_pred:0.021404825150966644, decouple_loss:0.018957527354359627
loss_pred:0.021963058039546013, decouple_loss:0.016288209706544876
Iteration: 2095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772660732269287, gen p mean: -0.18294455111026764, mean p set: 0.44830194115638733
loss_pred:0.021806105971336365, decouple_loss:0.015106122009456158
The modified gen p mean: 0.4493670165538788, gen p mean: -0.19589975476264954, mean p set: 0.449893593788147The modified gen p mean: 0.44855761528015137, gen p mean: -0.19296938180923462, mean p set: 0.4491303265094757
loss_pred:0.020836150273680687, decouple_loss:0.015122470445930958
loss_pred:0.02120325341820717, decouple_loss:0.01575395092368126
Iteration: 2096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935342669487, gen p mean: -0.19262094795703888, mean p set: 0.4499293565750122
loss_pred:0.020395833998918533, decouple_loss:0.012786547653377056
The modified gen p mean: 0.44916433095932007, gen p mean: -0.19883370399475098, mean p set: 0.4496924579143524The modified gen p mean: 0.4471067488193512, gen p mean: -0.18896014988422394, mean p set: 0.44768157601356506
loss_pred:0.021295567974448204, decouple_loss:0.012272506952285767
loss_pred:0.020276810973882675, decouple_loss:0.01434175856411457
Iteration: 2097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866234064102173, gen p mean: -0.1834912896156311, mean p set: 0.4492361843585968
loss_pred:0.01968134008347988, decouple_loss:0.012584789656102657
The modified gen p mean: 0.4485800266265869, gen p mean: -0.1798885017633438, mean p set: 0.4491572082042694The modified gen p mean: 0.4477841258049011, gen p mean: -0.19047260284423828, mean p set: 0.4483141601085663
loss_pred:0.019870132207870483, decouple_loss:0.01247392501682043
loss_pred:0.020055091008543968, decouple_loss:0.012039164081215858
Iteration: 2098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470423758029938, gen p mean: -0.16319148242473602, mean p set: 0.44762104749679565
loss_pred:0.02030729502439499, decouple_loss:0.013109196908771992
The modified gen p mean: 0.44786569476127625, gen p mean: -0.16828465461730957, mean p set: 0.4484424889087677
loss_pred:0.020835520699620247, decouple_loss:0.01211303286254406
The modified gen p mean: 0.44878649711608887, gen p mean: -0.17343948781490326, mean p set: 0.449317067861557
loss_pred:0.019908426329493523, decouple_loss:0.012350820004940033
Iteration: 2099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755399227142334, gen p mean: -0.1608482450246811, mean p set: 0.4481314718723297
loss_pred:0.02053140290081501, decouple_loss:0.012120508588850498
The modified gen p mean: 0.44791048765182495, gen p mean: -0.15935972332954407, mean p set: 0.4484889805316925
loss_pred:0.01982797309756279, decouple_loss:0.011883063241839409
The modified gen p mean: 0.44880813360214233, gen p mean: -0.16987253725528717, mean p set: 0.44933804869651794
loss_pred:0.01913316175341606, decouple_loss:0.012117656879127026
Iteration: 2100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481309950351715, gen p mean: -0.15659327805042267, mean p set: 0.44870755076408386
loss_pred:0.018517237156629562, decouple_loss:0.01225380040705204
The modified gen p mean: 0.4479866623878479, gen p mean: -0.15729662775993347, mean p set: 0.4485621154308319
loss_pred:0.018880823627114296, decouple_loss:0.012595178559422493
The modified gen p mean: 0.44859299063682556, gen p mean: -0.17289118468761444, mean p set: 0.44912344217300415
loss_pred:0.018115371465682983, decouple_loss:0.011903749778866768
2023-04-27 07:47:19 testing...
The modified gen p mean: 0.4482273757457733, gen p mean: -0.17010538280010223, mean p set: 0.44879910349845886
loss_pred:0.020647596567869186, decouple_loss:0.011428055353462696
The modified gen p mean: 0.4494309425354004, gen p mean: -0.17291009426116943, mean p set: 0.4499112665653229
loss_pred:0.02092175930738449, decouple_loss:0.012170693837106228
The modified gen p mean: 0.44929972290992737, gen p mean: -0.1745750457048416, mean p set: 0.4498290419578552
loss_pred:0.020153077319264412, decouple_loss:0.011414035223424435
WV_1_PC_1_EH_0_PS_30, loss: 0.02115769311785698, avg_mse: 0.029672229662537575
current test mse: 0.029672
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 2101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721710681915283, gen p mean: -0.17082783579826355, mean p set: 0.447747141122818
loss_pred:0.01900533027946949, decouple_loss:0.011010357178747654
The modified gen p mean: 0.44706234335899353, gen p mean: -0.17213279008865356, mean p set: 0.4476391673088074
The modified gen p mean: 0.44783657789230347, gen p mean: -0.172740176320076, mean p set: 0.44841110706329346
loss_pred:0.019245464354753494, decouple_loss:0.01050818432122469
loss_pred:0.020057467743754387, decouple_loss:0.011069278232753277
Iteration: 2102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473409652709961, gen p mean: -0.17519138753414154, mean p set: 0.4478660821914673
loss_pred:0.018685122951865196, decouple_loss:0.011132864281535149
The modified gen p mean: 0.44806429743766785, gen p mean: -0.17164528369903564, mean p set: 0.4486396908760071
loss_pred:0.01902545802295208, decouple_loss:0.011708813719451427
The modified gen p mean: 0.4460816979408264, gen p mean: -0.17476056516170502, mean p set: 0.44665467739105225
loss_pred:0.01966157741844654, decouple_loss:0.010968072339892387
Iteration: 2103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686833024024963, gen p mean: -0.1776268631219864, mean p set: 0.4473954439163208
loss_pred:0.019417807459831238, decouple_loss:0.009019316174089909
The modified gen p mean: 0.4482267498970032, gen p mean: -0.17017962038516998, mean p set: 0.4488039016723633
loss_pred:0.017494184896349907, decouple_loss:0.00989258661866188
The modified gen p mean: 0.4468306601047516, gen p mean: -0.17466968297958374, mean p set: 0.44740498065948486
loss_pred:0.018366318196058273, decouple_loss:0.009439603425562382
Iteration: 2104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973134994506836, gen p mean: -0.1744300276041031, mean p set: 0.45025789737701416
loss_pred:0.017622366547584534, decouple_loss:0.009583179838955402
The modified gen p mean: 0.44795000553131104, gen p mean: -0.16560900211334229, mean p set: 0.4485248327255249
loss_pred:0.018273185938596725, decouple_loss:0.009381362237036228
The modified gen p mean: 0.4480186402797699, gen p mean: -0.1687484085559845, mean p set: 0.44859424233436584
loss_pred:0.018684789538383484, decouple_loss:0.009086216799914837
Iteration: 2105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474201798439026, gen p mean: -0.1706077605485916, mean p set: 0.4479939937591553
loss_pred:0.018027665093541145, decouple_loss:0.009620314463973045
The modified gen p mean: 0.44765573740005493, gen p mean: -0.16345544159412384, mean p set: 0.4482302665710449The modified gen p mean: 0.4489518105983734, gen p mean: -0.16542237997055054, mean p set: 0.449484258890152
loss_pred:0.017555667087435722, decouple_loss:0.009019730612635612
loss_pred:0.01805000752210617, decouple_loss:0.00920861680060625
Iteration: 2106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811031222343445, gen p mean: -0.16268377006053925, mean p set: 0.4486897885799408
loss_pred:0.017890814691781998, decouple_loss:0.008466813713312149
The modified gen p mean: 0.4466937780380249, gen p mean: -0.16602742671966553, mean p set: 0.4472673535346985The modified gen p mean: 0.44638821482658386, gen p mean: -0.17167094349861145, mean p set: 0.44691917300224304
loss_pred:0.018364544957876205, decouple_loss:0.009036519564688206
loss_pred:0.018710630014538765, decouple_loss:0.008885161951184273
Iteration: 2107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475822150707245, gen p mean: -0.1674834042787552, mean p set: 0.44815701246261597
loss_pred:0.018091119825839996, decouple_loss:0.008225924335420132
The modified gen p mean: 0.44757553935050964, gen p mean: -0.17571230232715607, mean p set: 0.4481002688407898The modified gen p mean: 0.4465867578983307, gen p mean: -0.16547782719135284, mean p set: 0.44716405868530273
loss_pred:0.017735479399561882, decouple_loss:0.008499132469296455
loss_pred:0.018574707210063934, decouple_loss:0.008757066912949085
Iteration: 2108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781872630119324, gen p mean: -0.16060394048690796, mean p set: 0.4483965039253235
loss_pred:0.017580199986696243, decouple_loss:0.009225317277014256
The modified gen p mean: 0.44908127188682556, gen p mean: -0.16357937455177307, mean p set: 0.4496593773365021
loss_pred:0.016634540632367134, decouple_loss:0.008501666598021984
The modified gen p mean: 0.44770678877830505, gen p mean: -0.16119755804538727, mean p set: 0.4482366442680359
loss_pred:0.01746221072971821, decouple_loss:0.008286395110189915
Iteration: 2109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476849436759949, gen p mean: -0.15971802175045013, mean p set: 0.44826218485832214
loss_pred:0.017089763656258583, decouple_loss:0.008054042235016823
The modified gen p mean: 0.44635671377182007, gen p mean: -0.15686795115470886, mean p set: 0.44693389534950256
loss_pred:0.0178566575050354, decouple_loss:0.008560584858059883
The modified gen p mean: 0.4483496844768524, gen p mean: -0.15430039167404175, mean p set: 0.448875367641449
loss_pred:0.01782083883881569, decouple_loss:0.0083148293197155
Iteration: 2110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793227314949036, gen p mean: -0.15907838940620422, mean p set: 0.44850608706474304
loss_pred:0.016518834978342056, decouple_loss:0.008016570471227169
The modified gen p mean: 0.4477238655090332, gen p mean: -0.1620945930480957, mean p set: 0.44829997420310974
loss_pred:0.017834344878792763, decouple_loss:0.008090143091976643
The modified gen p mean: 0.44793760776519775, gen p mean: -0.16393151879310608, mean p set: 0.44846752285957336
loss_pred:0.0169904213398695, decouple_loss:0.007805307861417532
2023-04-27 07:51:20 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.15273097157478333, mean p set: 0.4499112665653229
loss_pred:0.019362132996320724, decouple_loss:0.008510351181030273
The modified gen p mean: 0.4493032991886139, gen p mean: -0.15394215285778046, mean p set: 0.4498290419578552
loss_pred:0.018870271742343903, decouple_loss:0.00810396671295166
The modified gen p mean: 0.44822293519973755, gen p mean: -0.15017849206924438, mean p set: 0.44879910349845886
loss_pred:0.019253011792898178, decouple_loss:0.008030086755752563
WV_1_PC_1_EH_0_PS_30, loss: 0.01957254484295845, avg_mse: 0.02824295684695244
current test mse: 0.028243
Iteration: 2111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488897919654846, gen p mean: -0.1505742371082306, mean p set: 0.4494676887989044
loss_pred:0.017201820388436317, decouple_loss:0.007806265261024237
The modified gen p mean: 0.4475249648094177, gen p mean: -0.14937922358512878, mean p set: 0.4480552673339844
loss_pred:0.017155569046735764, decouple_loss:0.0074982172809541225
The modified gen p mean: 0.4475305378437042, gen p mean: -0.14811201393604279, mean p set: 0.44810861349105835
loss_pred:0.017059240490198135, decouple_loss:0.007583065424114466
Iteration: 2112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469316601753235, gen p mean: -0.14463108777999878, mean p set: 0.4474572539329529
loss_pred:0.016712678596377373, decouple_loss:0.0071760970167815685
The modified gen p mean: 0.4467732310295105, gen p mean: -0.16200581192970276, mean p set: 0.4473487436771393
The modified gen p mean: 0.44769972562789917, gen p mean: -0.14424623548984528, mean p set: 0.44827526807785034
loss_pred:0.017728587612509727, decouple_loss:0.0075947996228933334
loss_pred:0.017362510785460472, decouple_loss:0.007386435754597187
Iteration: 2113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484676420688629, gen p mean: -0.1525571048259735, mean p set: 0.4489942789077759
loss_pred:0.016581423580646515, decouple_loss:0.007208509370684624
The modified gen p mean: 0.4470345079898834, gen p mean: -0.1513804942369461, mean p set: 0.44761136174201965
The modified gen p mean: 0.44925448298454285, gen p mean: -0.14869584143161774, mean p set: 0.4498293101787567
loss_pred:0.017251456156373024, decouple_loss:0.007181697525084019
loss_pred:0.01722414791584015, decouple_loss:0.006985838059335947
Iteration: 2114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790101051330566, gen p mean: -0.14979106187820435, mean p set: 0.4484281837940216
loss_pred:0.01783529669046402, decouple_loss:0.007489190902560949
The modified gen p mean: 0.44787925481796265, gen p mean: -0.14334414899349213, mean p set: 0.4484524726867676
The modified gen p mean: 0.44710657000541687, gen p mean: -0.1423252671957016, mean p set: 0.4476827085018158
loss_pred:0.016996150836348534, decouple_loss:0.006628349423408508
loss_pred:0.016858013346791267, decouple_loss:0.006827671080827713
Iteration: 2115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478853642940521, gen p mean: -0.14128108322620392, mean p set: 0.44846025109291077
loss_pred:0.016580043360590935, decouple_loss:0.006703113205730915
The modified gen p mean: 0.44821232557296753, gen p mean: -0.14100341498851776, mean p set: 0.44874149560928345The modified gen p mean: 0.44852572679519653, gen p mean: -0.1437283158302307, mean p set: 0.4491024613380432
loss_pred:0.01604519598186016, decouple_loss:0.00672792037948966
loss_pred:0.01605806313455105, decouple_loss:0.006798530463129282
Iteration: 2116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480065703392029, gen p mean: -0.14865513145923615, mean p set: 0.4485850930213928
loss_pred:0.016131823882460594, decouple_loss:0.0063254572451114655
The modified gen p mean: 0.44785457849502563, gen p mean: -0.1512470692396164, mean p set: 0.4483831226825714The modified gen p mean: 0.44727009534835815, gen p mean: -0.15188884735107422, mean p set: 0.4478446841239929
loss_pred:0.01698809489607811, decouple_loss:0.006192488130182028
loss_pred:0.016313079744577408, decouple_loss:0.006097359582781792
Iteration: 2117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468066394329071, gen p mean: -0.14744068682193756, mean p set: 0.44738268852233887
loss_pred:0.01700817607343197, decouple_loss:0.006743235047906637
The modified gen p mean: 0.4476138651371002, gen p mean: -0.14988362789154053, mean p set: 0.44813862442970276The modified gen p mean: 0.4481937289237976, gen p mean: -0.15417245030403137, mean p set: 0.44876906275749207
loss_pred:0.015782827511429787, decouple_loss:0.0060828616842627525
loss_pred:0.016986293718218803, decouple_loss:0.006581897381693125
Iteration: 2118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482567608356476, gen p mean: -0.15079759061336517, mean p set: 0.4488346576690674
loss_pred:0.01649974100291729, decouple_loss:0.005975150503218174
The modified gen p mean: 0.4483392536640167, gen p mean: -0.15231971442699432, mean p set: 0.4489155113697052
loss_pred:0.016480568796396255, decouple_loss:0.006042710039764643
The modified gen p mean: 0.447387158870697, gen p mean: -0.15558578073978424, mean p set: 0.44791606068611145
loss_pred:0.01667308807373047, decouple_loss:0.00583557179197669
Iteration: 2119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493851065635681, gen p mean: -0.1535656899213791, mean p set: 0.4499613046646118
loss_pred:0.016176633536815643, decouple_loss:0.005832697730511427
The modified gen p mean: 0.44677814841270447, gen p mean: -0.1564609557390213, mean p set: 0.44735386967658997
loss_pred:0.017010128125548363, decouple_loss:0.005768968723714352
The modified gen p mean: 0.4484233260154724, gen p mean: -0.15344251692295074, mean p set: 0.44895458221435547
loss_pred:0.015782779082655907, decouple_loss:0.005917620379477739
Iteration: 2120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465084671974182, gen p mean: -0.14294272661209106, mean p set: 0.4470857083797455
loss_pred:0.01753879338502884, decouple_loss:0.005934092216193676
The modified gen p mean: 0.44722050428390503, gen p mean: -0.14681291580200195, mean p set: 0.4477500915527344The modified gen p mean: 0.44847527146339417, gen p mean: -0.160257026553154, mean p set: 0.44905540347099304
loss_pred:0.0166880264878273, decouple_loss:0.00579012930393219
loss_pred:0.016464749351143837, decouple_loss:0.005816149991005659
2023-04-27 07:54:45 testing...
The modified gen p mean: 0.44822564721107483, gen p mean: -0.15002106130123138, mean p set: 0.44879910349845886
loss_pred:0.01842854730784893, decouple_loss:0.006658217869699001
The modified gen p mean: 0.4494309425354004, gen p mean: -0.1532028466463089, mean p set: 0.4499112665653229
loss_pred:0.018651409074664116, decouple_loss:0.006948412396013737
The modified gen p mean: 0.4493013620376587, gen p mean: -0.15356400609016418, mean p set: 0.4498290419578552
loss_pred:0.018102584406733513, decouple_loss:0.006915763020515442
WV_1_PC_1_EH_0_PS_30, loss: 0.01873622089624405, avg_mse: 0.027301723137497902
current test mse: 0.027302
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 2121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504178762435913, gen p mean: -0.15407712757587433, mean p set: 0.4509483277797699
loss_pred:0.0191904716193676, decouple_loss:0.007044000551104546
The modified gen p mean: 0.44930654764175415, gen p mean: -0.1537482589483261, mean p set: 0.44988662004470825
loss_pred:0.017481839284300804, decouple_loss:0.007285448722541332
The modified gen p mean: 0.45000696182250977, gen p mean: -0.15974947810173035, mean p set: 0.450583815574646
loss_pred:0.0188788790255785, decouple_loss:0.007472048979252577
Iteration: 2122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493531882762909, gen p mean: -0.14837315678596497, mean p set: 0.44988352060317993
loss_pred:0.017186980694532394, decouple_loss:0.0066305105574429035
The modified gen p mean: 0.45004892349243164, gen p mean: -0.14842042326927185, mean p set: 0.45062586665153503
loss_pred:0.018291214480996132, decouple_loss:0.007086130324751139
The modified gen p mean: 0.450056254863739, gen p mean: -0.14629298448562622, mean p set: 0.4506319463253021
loss_pred:0.01772991195321083, decouple_loss:0.007397666573524475
Iteration: 2123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891729950904846, gen p mean: -0.15432994067668915, mean p set: 0.44944941997528076
loss_pred:0.018253598362207413, decouple_loss:0.005516699980944395
The modified gen p mean: 0.44963088631629944, gen p mean: -0.15413452684879303, mean p set: 0.4502067267894745
loss_pred:0.017473869025707245, decouple_loss:0.005478135775774717
The modified gen p mean: 0.4502846896648407, gen p mean: -0.15301749110221863, mean p set: 0.4508611261844635
loss_pred:0.017991777509450912, decouple_loss:0.005296502262353897
Iteration: 2124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498191773891449, gen p mean: -0.155110165476799, mean p set: 0.4503425657749176
loss_pred:0.01727987825870514, decouple_loss:0.006532466039061546
The modified gen p mean: 0.45073583722114563, gen p mean: -0.1596394032239914, mean p set: 0.4513084292411804
loss_pred:0.01833137311041355, decouple_loss:0.007295893505215645
The modified gen p mean: 0.4504283666610718, gen p mean: -0.15784145891666412, mean p set: 0.4510018229484558
loss_pred:0.018655207008123398, decouple_loss:0.006696505472064018
Iteration: 2125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915807247161865, gen p mean: -0.15355949103832245, mean p set: 0.44973650574684143
loss_pred:0.017384178936481476, decouple_loss:0.005729296710342169
The modified gen p mean: 0.44851505756378174, gen p mean: -0.15008240938186646, mean p set: 0.4490925073623657
loss_pred:0.018280429765582085, decouple_loss:0.005794634111225605
The modified gen p mean: 0.45005878806114197, gen p mean: -0.1565670669078827, mean p set: 0.45058757066726685
loss_pred:0.0180988572537899, decouple_loss:0.005871233064681292
Iteration: 2126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979721307754517, gen p mean: -0.15724560618400574, mean p set: 0.45036831498146057
loss_pred:0.017441842705011368, decouple_loss:0.005459324922412634
The modified gen p mean: 0.4501837491989136, gen p mean: -0.15415382385253906, mean p set: 0.4507621228694916The modified gen p mean: 0.4498569369316101, gen p mean: -0.15882664918899536, mean p set: 0.45038241147994995
loss_pred:0.0182084608823061, decouple_loss:0.006302200723439455
loss_pred:0.01747053489089012, decouple_loss:0.005498301237821579
Iteration: 2127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933995604515076, gen p mean: -0.15570217370986938, mean p set: 0.4499199688434601
loss_pred:0.01743144541978836, decouple_loss:0.005552972666919231
The modified gen p mean: 0.4501234292984009, gen p mean: -0.15424436330795288, mean p set: 0.4506498873233795The modified gen p mean: 0.44983726739883423, gen p mean: -0.1493312418460846, mean p set: 0.4504148066043854
loss_pred:0.01820436120033264, decouple_loss:0.005545102525502443
loss_pred:0.018097708001732826, decouple_loss:0.005572406575083733
Iteration: 2128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449228972196579, gen p mean: -0.1476600021123886, mean p set: 0.4498046338558197
loss_pred:0.01787480339407921, decouple_loss:0.005906012840569019
The modified gen p mean: 0.4494583010673523, gen p mean: -0.14745788276195526, mean p set: 0.4500381648540497The modified gen p mean: 0.45055001974105835, gen p mean: -0.1434224545955658, mean p set: 0.4510757029056549
loss_pred:0.01707182265818119, decouple_loss:0.005471181124448776
loss_pred:0.018197715282440186, decouple_loss:0.005546149332076311
Iteration: 2129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486140310764313, gen p mean: -0.14487439393997192, mean p set: 0.4491916298866272
loss_pred:0.017453398555517197, decouple_loss:0.005358119960874319
The modified gen p mean: 0.44957342743873596, gen p mean: -0.14670796692371368, mean p set: 0.45014673471450806
loss_pred:0.017282553017139435, decouple_loss:0.005357010290026665
The modified gen p mean: 0.4493005573749542, gen p mean: -0.14321057498455048, mean p set: 0.4498307704925537
loss_pred:0.01771019585430622, decouple_loss:0.005892122630029917
Iteration: 2130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481184482574463, gen p mean: -0.15061573684215546, mean p set: 0.4486955404281616
loss_pred:0.017611579969525337, decouple_loss:0.005544671323150396
The modified gen p mean: 0.4492560029029846, gen p mean: -0.153116837143898, mean p set: 0.4498307406902313The modified gen p mean: 0.45019102096557617, gen p mean: -0.1515563279390335, mean p set: 0.4507182538509369
loss_pred:0.01681378111243248, decouple_loss:0.00555364741012454
loss_pred:0.017118576914072037, decouple_loss:0.005264167208224535
2023-04-27 07:58:50 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.15786431729793549, mean p set: 0.4499112665653229
loss_pred:0.01737298257648945, decouple_loss:0.005806686822324991
The modified gen p mean: 0.44929811358451843, gen p mean: -0.15887463092803955, mean p set: 0.4498290419578552
loss_pred:0.017402488738298416, decouple_loss:0.005712388549000025
The modified gen p mean: 0.4482265114784241, gen p mean: -0.15613965690135956, mean p set: 0.44879910349845886
loss_pred:0.017273982986807823, decouple_loss:0.0054028755985200405
WV_1_PC_1_EH_0_PS_30, loss: 0.017631851136684418, avg_mse: 0.02562163956463337
current test mse: 0.025622
Iteration: 2131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502488970756531, gen p mean: -0.16022762656211853, mean p set: 0.4508230984210968
loss_pred:0.01759723760187626, decouple_loss:0.005547012202441692
The modified gen p mean: 0.44863471388816833, gen p mean: -0.15664133429527283, mean p set: 0.4491656422615051
loss_pred:0.017285967245697975, decouple_loss:0.005510983057320118
The modified gen p mean: 0.45059168338775635, gen p mean: -0.15862365067005157, mean p set: 0.45116761326789856
loss_pred:0.017894774675369263, decouple_loss:0.005557634402066469
Iteration: 2132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45014965534210205, gen p mean: -0.15715141594409943, mean p set: 0.45067691802978516
loss_pred:0.01754651963710785, decouple_loss:0.005285867024213076
The modified gen p mean: 0.4499926269054413, gen p mean: -0.16267205774784088, mean p set: 0.45056453347206116
The modified gen p mean: 0.44967758655548096, gen p mean: -0.15755607187747955, mean p set: 0.4502556622028351
loss_pred:0.01806756854057312, decouple_loss:0.004580541513860226
loss_pred:0.017462830990552902, decouple_loss:0.004252890590578318
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500839412212372, gen p mean: -0.17105470597743988, mean p set: 0.4506154954433441
loss_pred:0.017568962648510933, decouple_loss:0.005346653982996941
The modified gen p mean: 0.45069602131843567, gen p mean: -0.17181965708732605, mean p set: 0.45127072930336
The modified gen p mean: 0.44803139567375183, gen p mean: -0.16376546025276184, mean p set: 0.448609322309494
loss_pred:0.01795051433146, decouple_loss:0.005345543380826712
loss_pred:0.0176981333643198, decouple_loss:0.005920076277107
Iteration: 2134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503991901874542, gen p mean: -0.1548088788986206, mean p set: 0.45092761516571045
loss_pred:0.01767544448375702, decouple_loss:0.004662861116230488
The modified gen p mean: 0.4494888186454773, gen p mean: -0.15799741446971893, mean p set: 0.45006564259529114
The modified gen p mean: 0.45016103982925415, gen p mean: -0.15864931046962738, mean p set: 0.45073747634887695
loss_pred:0.017264658585190773, decouple_loss:0.0045290132984519005
loss_pred:0.018133200705051422, decouple_loss:0.005211808253079653
Iteration: 2135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925713539123535, gen p mean: -0.15930111706256866, mean p set: 0.4498342275619507
loss_pred:0.017184894531965256, decouple_loss:0.006151613779366016
The modified gen p mean: 0.4488576352596283, gen p mean: -0.1607857644557953, mean p set: 0.4493815302848816The modified gen p mean: 0.45068344473838806, gen p mean: -0.16283510625362396, mean p set: 0.4512575566768646
loss_pred:0.017271412536501884, decouple_loss:0.006122558377683163
loss_pred:0.01763458177447319, decouple_loss:0.005645473953336477
Iteration: 2136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505242109298706, gen p mean: -0.1650189906358719, mean p set: 0.451102077960968
loss_pred:0.016997704282402992, decouple_loss:0.004579921253025532
The modified gen p mean: 0.44919705390930176, gen p mean: -0.16596105694770813, mean p set: 0.44972866773605347The modified gen p mean: 0.4490382671356201, gen p mean: -0.16971328854560852, mean p set: 0.4496159553527832
loss_pred:0.01719953864812851, decouple_loss:0.004654464777559042
loss_pred:0.017653830349445343, decouple_loss:0.005052513908594847
Iteration: 2137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495628774166107, gen p mean: -0.17156507074832916, mean p set: 0.4501415491104126
loss_pred:0.017312485724687576, decouple_loss:0.005509804934263229
The modified gen p mean: 0.4511846601963043, gen p mean: -0.16527317464351654, mean p set: 0.4517151713371277The modified gen p mean: 0.4492383301258087, gen p mean: -0.16906815767288208, mean p set: 0.4498143792152405
loss_pred:0.017153654247522354, decouple_loss:0.005927010904997587
loss_pred:0.017509808763861656, decouple_loss:0.006097187753766775
Iteration: 2138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506203234195709, gen p mean: -0.16818246245384216, mean p set: 0.4511975646018982
loss_pred:0.0166819728910923, decouple_loss:0.005079541355371475
The modified gen p mean: 0.4493750035762787, gen p mean: -0.16817881166934967, mean p set: 0.44995349645614624
loss_pred:0.01697426848113537, decouple_loss:0.00476383650675416
The modified gen p mean: 0.448677122592926, gen p mean: -0.1708097606897354, mean p set: 0.4492048919200897
loss_pred:0.016652889549732208, decouple_loss:0.004627596586942673
Iteration: 2139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901666045188904, gen p mean: -0.16775038838386536, mean p set: 0.4495888352394104
loss_pred:0.016963014379143715, decouple_loss:0.00521286902949214
The modified gen p mean: 0.44961223006248474, gen p mean: -0.17054903507232666, mean p set: 0.45017993450164795
loss_pred:0.017355626448988914, decouple_loss:0.005310469307005405
The modified gen p mean: 0.44975030422210693, gen p mean: -0.1729123294353485, mean p set: 0.4502823054790497
loss_pred:0.017317648977041245, decouple_loss:0.005154089070856571
Iteration: 2140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495569169521332, gen p mean: -0.16502803564071655, mean p set: 0.450135201215744
loss_pred:0.01646263338625431, decouple_loss:0.004630385432392359
The modified gen p mean: 0.4491216242313385, gen p mean: -0.16808179020881653, mean p set: 0.4496990144252777
loss_pred:0.018063601106405258, decouple_loss:0.00450851209461689
The modified gen p mean: 0.44900524616241455, gen p mean: -0.16964292526245117, mean p set: 0.44952836632728577
loss_pred:0.016656601801514626, decouple_loss:0.004745326936244965
2023-04-27 08:02:15 testing...
The modified gen p mean: 0.4482228755950928, gen p mean: -0.16226252913475037, mean p set: 0.44879910349845886
loss_pred:0.016665225848555565, decouple_loss:0.004227174911648035
The modified gen p mean: 0.4494309425354004, gen p mean: -0.16441020369529724, mean p set: 0.4499112665653229
loss_pred:0.016719583421945572, decouple_loss:0.004318336024880409
The modified gen p mean: 0.4492994546890259, gen p mean: -0.1650732308626175, mean p set: 0.4498290419578552
loss_pred:0.01644739881157875, decouple_loss:0.004216760862618685
WV_1_PC_1_EH_0_PS_30, loss: 0.01682344079017639, avg_mse: 0.024450508877635002
current test mse: 0.024451
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 2141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44562217593193054, gen p mean: -0.17006361484527588, mean p set: 0.4461473524570465
loss_pred:0.01757654920220375, decouple_loss:0.006245240569114685
The modified gen p mean: 0.447316974401474, gen p mean: -0.1704026609659195, mean p set: 0.4478928744792938
loss_pred:0.016452033072710037, decouple_loss:0.005559835582971573
The modified gen p mean: 0.4471953809261322, gen p mean: -0.16533759236335754, mean p set: 0.44777119159698486
loss_pred:0.01726926490664482, decouple_loss:0.004748175386339426
Iteration: 2142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483087360858917, gen p mean: -0.16781871020793915, mean p set: 0.4488369822502136
loss_pred:0.017087357118725777, decouple_loss:0.005164130125194788
The modified gen p mean: 0.4458654522895813, gen p mean: -0.16943925619125366, mean p set: 0.4464397132396698
loss_pred:0.017344186082482338, decouple_loss:0.005043805576860905
The modified gen p mean: 0.4470580518245697, gen p mean: -0.1653100848197937, mean p set: 0.4476326107978821
loss_pred:0.016379691660404205, decouple_loss:0.004997610580176115
Iteration: 2143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636601209640503, gen p mean: -0.16565190255641937, mean p set: 0.44689464569091797
loss_pred:0.01700226031243801, decouple_loss:0.00540277361869812
The modified gen p mean: 0.4484609067440033, gen p mean: -0.16028232872486115, mean p set: 0.4490351974964142
loss_pred:0.016262665390968323, decouple_loss:0.005085661541670561
The modified gen p mean: 0.4473751187324524, gen p mean: -0.1659344732761383, mean p set: 0.4479483664035797
loss_pred:0.016516005620360374, decouple_loss:0.004415510687977076
Iteration: 2144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487837553024292, gen p mean: -0.15218792855739594, mean p set: 0.44930681586265564
loss_pred:0.01690748892724514, decouple_loss:0.004708835389465094
The modified gen p mean: 0.448856383562088, gen p mean: -0.1565892994403839, mean p set: 0.4494354724884033
loss_pred:0.01664353534579277, decouple_loss:0.004384118597954512
The modified gen p mean: 0.4482944905757904, gen p mean: -0.15336987376213074, mean p set: 0.4488692581653595
loss_pred:0.01673703081905842, decouple_loss:0.004509174730628729
Iteration: 2145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491008520126343, gen p mean: -0.14780956506729126, mean p set: 0.44967639446258545
loss_pred:0.016142871230840683, decouple_loss:0.004808109253644943
The modified gen p mean: 0.4471530318260193, gen p mean: -0.1557578146457672, mean p set: 0.4477252662181854
The modified gen p mean: 0.44592225551605225, gen p mean: -0.15894603729248047, mean p set: 0.44645223021507263
loss_pred:0.017208315432071686, decouple_loss:0.00443823030218482
loss_pred:0.016927259042859077, decouple_loss:0.004629404284060001
Iteration: 2146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470059275627136, gen p mean: -0.1586117297410965, mean p set: 0.4475817382335663
loss_pred:0.016539346426725388, decouple_loss:0.004239092115312815
The modified gen p mean: 0.4483930766582489, gen p mean: -0.16168291866779327, mean p set: 0.448919415473938The modified gen p mean: 0.4474267065525055, gen p mean: -0.16292229294776917, mean p set: 0.4480014741420746
loss_pred:0.016371525824069977, decouple_loss:0.0041764420457184315
loss_pred:0.016595950350165367, decouple_loss:0.0040692794136703014
Iteration: 2147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473648965358734, gen p mean: -0.1714961975812912, mean p set: 0.4479406476020813
loss_pred:0.01647629775106907, decouple_loss:0.004434471949934959
The modified gen p mean: 0.4481753706932068, gen p mean: -0.17911985516548157, mean p set: 0.44869908690452576The modified gen p mean: 0.4475225806236267, gen p mean: -0.17571210861206055, mean p set: 0.4481014013290405
loss_pred:0.01715448871254921, decouple_loss:0.004430433269590139
loss_pred:0.016559258103370667, decouple_loss:0.005238229874521494
Iteration: 2148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848307967185974, gen p mean: -0.17452241480350494, mean p set: 0.4490565061569214
loss_pred:0.016180483624339104, decouple_loss:0.004726124927401543
The modified gen p mean: 0.4489738643169403, gen p mean: -0.169398233294487, mean p set: 0.4495036005973816The modified gen p mean: 0.4476914405822754, gen p mean: -0.17595863342285156, mean p set: 0.44826918840408325
loss_pred:0.016596002504229546, decouple_loss:0.004613526631146669
loss_pred:0.01684758812189102, decouple_loss:0.004539774730801582
Iteration: 2149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863706827163696, gen p mean: -0.16736474633216858, mean p set: 0.4492167532444
loss_pred:0.016831424087285995, decouple_loss:0.004097504075616598
The modified gen p mean: 0.4480881690979004, gen p mean: -0.174556702375412, mean p set: 0.4486646354198456
loss_pred:0.016065102070569992, decouple_loss:0.0039909309707582
The modified gen p mean: 0.446852445602417, gen p mean: -0.16848264634609222, mean p set: 0.4473777115345001
loss_pred:0.017329873517155647, decouple_loss:0.004336487036198378
Iteration: 2150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485132396221161, gen p mean: -0.1763707995414734, mean p set: 0.44908660650253296
loss_pred:0.01644046977162361, decouple_loss:0.005087556317448616
The modified gen p mean: 0.44794031977653503, gen p mean: -0.1660921275615692, mean p set: 0.44847002625465393The modified gen p mean: 0.4483773410320282, gen p mean: -0.173696830868721, mean p set: 0.4489506781101227
loss_pred:0.016738513484597206, decouple_loss:0.004131694789975882
loss_pred:0.01648833230137825, decouple_loss:0.004233914893120527
2023-04-27 08:06:22 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.1691589653491974, mean p set: 0.4499112665653229
loss_pred:0.016952117905020714, decouple_loss:0.004985517356544733
The modified gen p mean: 0.4492979049682617, gen p mean: -0.16945530474185944, mean p set: 0.4498290419578552
loss_pred:0.01641830988228321, decouple_loss:0.004867084324359894
The modified gen p mean: 0.4482278823852539, gen p mean: -0.1659717857837677, mean p set: 0.44879910349845886
loss_pred:0.01692390628159046, decouple_loss:0.00495482049882412
WV_1_PC_1_EH_0_PS_30, loss: 0.017011569812893867, avg_mse: 0.024753887206315994
current test mse: 0.024754
Iteration: 2151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44587841629981995, gen p mean: -0.16932903230190277, mean p set: 0.44645413756370544
loss_pred:0.016057787463068962, decouple_loss:0.0047410884872078896
The modified gen p mean: 0.4475908875465393, gen p mean: -0.17626723647117615, mean p set: 0.44812238216400146
loss_pred:0.016609925776720047, decouple_loss:0.004275716375559568
The modified gen p mean: 0.4489377439022064, gen p mean: -0.16972364485263824, mean p set: 0.44951605796813965
loss_pred:0.01593136042356491, decouple_loss:0.004351114854216576
Iteration: 2152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476548135280609, gen p mean: -0.17240728437900543, mean p set: 0.448184072971344
loss_pred:0.016437852755188942, decouple_loss:0.004059566184878349
The modified gen p mean: 0.44793596863746643, gen p mean: -0.16187043488025665, mean p set: 0.4485113322734833
loss_pred:0.015979744493961334, decouple_loss:0.003964758012443781
The modified gen p mean: 0.44746315479278564, gen p mean: -0.1673756241798401, mean p set: 0.4480428397655487
loss_pred:0.015405629761517048, decouple_loss:0.0041457852348685265
Iteration: 2153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472784101963043, gen p mean: -0.1530093550682068, mean p set: 0.44780370593070984
loss_pred:0.016840875148773193, decouple_loss:0.003972155973315239
The modified gen p mean: 0.44809389114379883, gen p mean: -0.16247199475765228, mean p set: 0.4486686885356903
loss_pred:0.016773603856563568, decouple_loss:0.003924092743545771
The modified gen p mean: 0.44765704870224, gen p mean: -0.16869203746318817, mean p set: 0.4482314884662628
loss_pred:0.01639128103852272, decouple_loss:0.00392073392868042
Iteration: 2154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711560010910034, gen p mean: -0.1555715948343277, mean p set: 0.44764280319213867
loss_pred:0.016503605991601944, decouple_loss:0.003926480654627085
The modified gen p mean: 0.4473729431629181, gen p mean: -0.1672818958759308, mean p set: 0.44794782996177673
loss_pred:0.016905775293707848, decouple_loss:0.00368534866720438
The modified gen p mean: 0.44746220111846924, gen p mean: -0.15824225544929504, mean p set: 0.4480399191379547
loss_pred:0.015509882010519505, decouple_loss:0.0036555230617523193
Iteration: 2155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470877945423126, gen p mean: -0.1636255979537964, mean p set: 0.4476655125617981
loss_pred:0.015406505204737186, decouple_loss:0.0038859285414218903
The modified gen p mean: 0.44816598296165466, gen p mean: -0.16183844208717346, mean p set: 0.4487389624118805The modified gen p mean: 0.4483684003353119, gen p mean: -0.17075064778327942, mean p set: 0.44889581203460693
loss_pred:0.016525179147720337, decouple_loss:0.004043114371597767
loss_pred:0.016883160918951035, decouple_loss:0.003778597107157111
Iteration: 2156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479333460330963, gen p mean: -0.1684786081314087, mean p set: 0.44850867986679077
loss_pred:0.015963684767484665, decouple_loss:0.003905664663761854
The modified gen p mean: 0.4484075605869293, gen p mean: -0.16722466051578522, mean p set: 0.4489421248435974The modified gen p mean: 0.44927388429641724, gen p mean: -0.16331711411476135, mean p set: 0.44985130429267883
loss_pred:0.01604420132935047, decouple_loss:0.0038774909917265177
loss_pred:0.015928715467453003, decouple_loss:0.0035989140160381794
Iteration: 2157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481131136417389, gen p mean: -0.1686912477016449, mean p set: 0.4486868679523468
loss_pred:0.01586938090622425, decouple_loss:0.003644157899543643
The modified gen p mean: 0.4488677382469177, gen p mean: -0.15997743606567383, mean p set: 0.44944167137145996The modified gen p mean: 0.4463087022304535, gen p mean: -0.16296005249023438, mean p set: 0.4468391239643097
loss_pred:0.016068095341324806, decouple_loss:0.0036174035631120205
loss_pred:0.016167884692549706, decouple_loss:0.003529665758833289
Iteration: 2158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478902518749237, gen p mean: -0.16999264061450958, mean p set: 0.448468953371048
loss_pred:0.016377924010157585, decouple_loss:0.0034176120534539223
The modified gen p mean: 0.4462607204914093, gen p mean: -0.17093148827552795, mean p set: 0.4467865526676178The modified gen p mean: 0.44526711106300354, gen p mean: -0.17152664065361023, mean p set: 0.44584187865257263
loss_pred:0.016575494781136513, decouple_loss:0.0038652531802654266
loss_pred:0.01668563298881054, decouple_loss:0.0038504062686115503
Iteration: 2159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784095883369446, gen p mean: -0.1650107502937317, mean p set: 0.44841864705085754
loss_pred:0.015805421397089958, decouple_loss:0.0036698186304420233
The modified gen p mean: 0.44787001609802246, gen p mean: -0.1715531051158905, mean p set: 0.44844329357147217The modified gen p mean: 0.4471481144428253, gen p mean: -0.17268912494182587, mean p set: 0.44767823815345764
loss_pred:0.01636115089058876, decouple_loss:0.004227894823998213
loss_pred:0.016027867794036865, decouple_loss:0.004371061455458403
Iteration: 2160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769537448883057, gen p mean: -0.16548731923103333, mean p set: 0.44827160239219666
loss_pred:0.01675022393465042, decouple_loss:0.00365172210149467
The modified gen p mean: 0.44707170128822327, gen p mean: -0.16356581449508667, mean p set: 0.44764459133148193The modified gen p mean: 0.4482306241989136, gen p mean: -0.16361460089683533, mean p set: 0.4487598240375519
loss_pred:0.015558075159788132, decouple_loss:0.003507863963022828
loss_pred:0.016333578154444695, decouple_loss:0.003570233704522252
2023-04-27 08:09:47 testing...
The modified gen p mean: 0.448226660490036, gen p mean: -0.1627514511346817, mean p set: 0.44879910349845886
loss_pred:0.016698863357305527, decouple_loss:0.004245804622769356
The modified gen p mean: 0.4494309425354004, gen p mean: -0.16514243185520172, mean p set: 0.4499112665653229
loss_pred:0.016780642792582512, decouple_loss:0.004691234324127436
The modified gen p mean: 0.44929856061935425, gen p mean: -0.165816068649292, mean p set: 0.4498290419578552
loss_pred:0.0162990540266037, decouple_loss:0.0042362818494439125
WV_1_PC_1_EH_0_PS_30, loss: 0.016812408342957497, avg_mse: 0.02452014572918415
current test mse: 0.02452
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 2161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499911963939667, gen p mean: -0.15999703109264374, mean p set: 0.4505176842212677
loss_pred:0.0151056544855237, decouple_loss:0.004276721738278866
The modified gen p mean: 0.44826972484588623, gen p mean: -0.16828188300132751, mean p set: 0.44884639978408813
The modified gen p mean: 0.4472865164279938, gen p mean: -0.16031526029109955, mean p set: 0.44786569476127625
loss_pred:0.015552565455436707, decouple_loss:0.004308763891458511
loss_pred:0.015467596240341663, decouple_loss:0.004262655973434448
Iteration: 2162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448712021112442, gen p mean: -0.1670733392238617, mean p set: 0.44923779368400574
loss_pred:0.015947692096233368, decouple_loss:0.003522949293255806
The modified gen p mean: 0.44733551144599915, gen p mean: -0.1612207293510437, mean p set: 0.4479128420352936
loss_pred:0.015580998733639717, decouple_loss:0.0037794632371515036
The modified gen p mean: 0.44884538650512695, gen p mean: -0.1709587424993515, mean p set: 0.4494233727455139
loss_pred:0.016020407900214195, decouple_loss:0.003558472031727433
Iteration: 2163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481462836265564, gen p mean: -0.17533810436725616, mean p set: 0.44867387413978577
loss_pred:0.015775641426444054, decouple_loss:0.0037468797527253628
The modified gen p mean: 0.4489865005016327, gen p mean: -0.16978880763053894, mean p set: 0.4495624303817749
loss_pred:0.01504654809832573, decouple_loss:0.00470642140135169
The modified gen p mean: 0.44775521755218506, gen p mean: -0.16924527287483215, mean p set: 0.4483363628387451
loss_pred:0.01609099470078945, decouple_loss:0.003606203244999051
Iteration: 2164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44875624775886536, gen p mean: -0.16776803135871887, mean p set: 0.4492860734462738
loss_pred:0.015534314326941967, decouple_loss:0.004096378572285175
The modified gen p mean: 0.4471733272075653, gen p mean: -0.16443662345409393, mean p set: 0.447748064994812
loss_pred:0.015165700577199459, decouple_loss:0.0037913359701633453
The modified gen p mean: 0.4485326409339905, gen p mean: -0.1755719780921936, mean p set: 0.44910797476768494
loss_pred:0.015018387697637081, decouple_loss:0.0034476611763238907
Iteration: 2165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481012523174286, gen p mean: -0.17750956118106842, mean p set: 0.44867774844169617
loss_pred:0.015859337523579597, decouple_loss:0.0036516981199383736
The modified gen p mean: 0.44659674167633057, gen p mean: -0.17994579672813416, mean p set: 0.447174608707428The modified gen p mean: 0.4516109526157379, gen p mean: -0.17247416079044342, mean p set: 0.4521370232105255
loss_pred:0.016209902241826057, decouple_loss:0.003248967695981264
loss_pred:0.015491819940507412, decouple_loss:0.003764545312151313
Iteration: 2166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802215695381165, gen p mean: -0.16850197315216064, mean p set: 0.44859644770622253
loss_pred:0.015426130965352058, decouple_loss:0.003910359926521778
The modified gen p mean: 0.4473673701286316, gen p mean: -0.1663193702697754, mean p set: 0.4478965699672699The modified gen p mean: 0.44829681515693665, gen p mean: -0.16632214188575745, mean p set: 0.44887375831604004
loss_pred:0.016423143446445465, decouple_loss:0.004186169244349003
loss_pred:0.015603385865688324, decouple_loss:0.004471873864531517
Iteration: 2167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485260546207428, gen p mean: -0.16991668939590454, mean p set: 0.44910773634910583
loss_pred:0.01498093269765377, decouple_loss:0.003686781506985426
The modified gen p mean: 0.4486437141895294, gen p mean: -0.17038527131080627, mean p set: 0.449176549911499The modified gen p mean: 0.44725358486175537, gen p mean: -0.16671791672706604, mean p set: 0.44782793521881104
loss_pred:0.015935899689793587, decouple_loss:0.003451064694672823
loss_pred:0.015669353306293488, decouple_loss:0.0034997588954865932
Iteration: 2168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740554690361023, gen p mean: -0.1770656257867813, mean p set: 0.4479774832725525
loss_pred:0.015153804793953896, decouple_loss:0.004631652496755123
The modified gen p mean: 0.44910988211631775, gen p mean: -0.18137948215007782, mean p set: 0.4496400058269501The modified gen p mean: 0.4474583566188812, gen p mean: -0.17275609076023102, mean p set: 0.4480287730693817
loss_pred:0.01613730378448963, decouple_loss:0.003966952674090862
loss_pred:0.01507535483688116, decouple_loss:0.004010825417935848
Iteration: 2169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828730821609497, gen p mean: -0.1754930317401886, mean p set: 0.44885799288749695
loss_pred:0.015153288841247559, decouple_loss:0.00364254810847342
The modified gen p mean: 0.447510302066803, gen p mean: -0.17532603442668915, mean p set: 0.44803765416145325
loss_pred:0.015446643345057964, decouple_loss:0.0033713141456246376
The modified gen p mean: 0.4500965178012848, gen p mean: -0.16972745954990387, mean p set: 0.45067334175109863
loss_pred:0.01477152667939663, decouple_loss:0.003817433025687933
Iteration: 2170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682347774505615, gen p mean: -0.16784140467643738, mean p set: 0.447394996881485
loss_pred:0.015076575800776482, decouple_loss:0.004447123501449823
The modified gen p mean: 0.44891029596328735, gen p mean: -0.18008330464363098, mean p set: 0.4494871497154236
loss_pred:0.01404888927936554, decouple_loss:0.005277944263070822
The modified gen p mean: 0.44884273409843445, gen p mean: -0.17980565130710602, mean p set: 0.4493709206581116
loss_pred:0.015731023624539375, decouple_loss:0.0042640347965061665
2023-04-27 08:13:53 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.17403700947761536, mean p set: 0.4499112665653229
loss_pred:0.016687801107764244, decouple_loss:0.0037260858807712793
The modified gen p mean: 0.4493016302585602, gen p mean: -0.17520654201507568, mean p set: 0.4498290419578552
loss_pred:0.01623447611927986, decouple_loss:0.003781104926019907
The modified gen p mean: 0.44822078943252563, gen p mean: -0.1718112975358963, mean p set: 0.44879910349845886
loss_pred:0.01666206121444702, decouple_loss:0.003687758930027485
WV_1_PC_1_EH_0_PS_30, loss: 0.01671469584107399, avg_mse: 0.0243835411965847
current test mse: 0.024384
Iteration: 2171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733133912086487, gen p mean: -0.17848166823387146, mean p set: 0.4479064643383026
loss_pred:0.015402394346892834, decouple_loss:0.0037286553997546434
The modified gen p mean: 0.45070764422416687, gen p mean: -0.1713472306728363, mean p set: 0.45123034715652466
loss_pred:0.015203080140054226, decouple_loss:0.003866245038807392
The modified gen p mean: 0.44986072182655334, gen p mean: -0.1675669401884079, mean p set: 0.4504365622997284
loss_pred:0.014783471822738647, decouple_loss:0.003844589227810502
Iteration: 2172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497114419937134, gen p mean: -0.18457813560962677, mean p set: 0.45023879408836365
loss_pred:0.015676410868763924, decouple_loss:0.003573769237846136
The modified gen p mean: 0.44788920879364014, gen p mean: -0.1815336048603058, mean p set: 0.44846272468566895
The modified gen p mean: 0.4479810297489166, gen p mean: -0.17510168254375458, mean p set: 0.4485572874546051
loss_pred:0.014223848469555378, decouple_loss:0.00394153967499733
loss_pred:0.015712829306721687, decouple_loss:0.003686982672661543
Iteration: 2173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814714789390564, gen p mean: -0.180588960647583, mean p set: 0.44867458939552307
loss_pred:0.01597481220960617, decouple_loss:0.0036640537437051535
The modified gen p mean: 0.4475667476654053, gen p mean: -0.1812322586774826, mean p set: 0.44814345240592957
The modified gen p mean: 0.4471741020679474, gen p mean: -0.18548321723937988, mean p set: 0.4477499723434448
loss_pred:0.01610354520380497, decouple_loss:0.0034945630468428135
loss_pred:0.015297088772058487, decouple_loss:0.0037720436230301857
Iteration: 2174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487980306148529, gen p mean: -0.19310571253299713, mean p set: 0.4493279755115509
loss_pred:0.014102382585406303, decouple_loss:0.004070413764566183
The modified gen p mean: 0.44883787631988525, gen p mean: -0.19143244624137878, mean p set: 0.4494149386882782
The modified gen p mean: 0.4483049511909485, gen p mean: -0.18405650556087494, mean p set: 0.4488815367221832
loss_pred:0.015584374777972698, decouple_loss:0.0040716626681387424
loss_pred:0.016335327178239822, decouple_loss:0.0038395896553993225
Iteration: 2175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962289929389954, gen p mean: -0.19382014870643616, mean p set: 0.45020073652267456
loss_pred:0.01441788300871849, decouple_loss:0.0035228682681918144
The modified gen p mean: 0.448371022939682, gen p mean: -0.18390829861164093, mean p set: 0.44889771938323975The modified gen p mean: 0.4489815831184387, gen p mean: -0.18165965378284454, mean p set: 0.449554443359375
loss_pred:0.015196206979453564, decouple_loss:0.0036032318603247404
loss_pred:0.016204629093408585, decouple_loss:0.004015300422906876
Iteration: 2176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471592903137207, gen p mean: -0.17558066546916962, mean p set: 0.4477371871471405
loss_pred:0.015337936580181122, decouple_loss:0.003773940959945321
The modified gen p mean: 0.4467439353466034, gen p mean: -0.18346209824085236, mean p set: 0.4472704529762268The modified gen p mean: 0.44970375299453735, gen p mean: -0.1819395273923874, mean p set: 0.4502794146537781
loss_pred:0.015276133082807064, decouple_loss:0.0035188596230000257
loss_pred:0.015455312095582485, decouple_loss:0.003894093679264188
Iteration: 2177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496555030345917, gen p mean: -0.17661701142787933, mean p set: 0.4502353370189667
loss_pred:0.014674799516797066, decouple_loss:0.003545602085068822
The modified gen p mean: 0.44863036274909973, gen p mean: -0.1858832985162735, mean p set: 0.44920656085014343The modified gen p mean: 0.44885146617889404, gen p mean: -0.17907364666461945, mean p set: 0.4493841528892517
loss_pred:0.01543613150715828, decouple_loss:0.003437439678236842
loss_pred:0.015340782701969147, decouple_loss:0.0038147675804793835
Iteration: 2178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902846217155457, gen p mean: -0.19034293293952942, mean p set: 0.4496042728424072
loss_pred:0.014074543491005898, decouple_loss:0.0035277027636766434
The modified gen p mean: 0.44926223158836365, gen p mean: -0.18095561861991882, mean p set: 0.4498351216316223
loss_pred:0.014936001040041447, decouple_loss:0.0032696849666535854
The modified gen p mean: 0.4476490914821625, gen p mean: -0.17575682699680328, mean p set: 0.4481779932975769
loss_pred:0.016084078699350357, decouple_loss:0.0033884202130138874
Iteration: 2179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484636187553406, gen p mean: -0.18400153517723083, mean p set: 0.44904303550720215
loss_pred:0.015974072739481926, decouple_loss:0.003455739701166749
The modified gen p mean: 0.44701728224754333, gen p mean: -0.18893687427043915, mean p set: 0.4475933015346527
loss_pred:0.01570267044007778, decouple_loss:0.004246564116328955
The modified gen p mean: 0.4495655298233032, gen p mean: -0.18463411927223206, mean p set: 0.45009157061576843
loss_pred:0.014600568450987339, decouple_loss:0.00414556497707963
Iteration: 2180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477561116218567, gen p mean: -0.177278071641922, mean p set: 0.44833314418792725
loss_pred:0.01584598608314991, decouple_loss:0.0034133309964090586
The modified gen p mean: 0.4475618302822113, gen p mean: -0.1822889745235443, mean p set: 0.4481402039527893
loss_pred:0.015449563041329384, decouple_loss:0.003250997746363282
The modified gen p mean: 0.44790393114089966, gen p mean: -0.1821971982717514, mean p set: 0.44843384623527527
loss_pred:0.015405523590743542, decouple_loss:0.003176484489813447
2023-04-27 08:17:18 testing...
The modified gen p mean: 0.44822201132774353, gen p mean: -0.18388979136943817, mean p set: 0.44879910349845886
loss_pred:0.016640860587358475, decouple_loss:0.0038328568916767836
The modified gen p mean: 0.4494309425354004, gen p mean: -0.1860615760087967, mean p set: 0.4499112665653229
loss_pred:0.016642559319734573, decouple_loss:0.003704680595546961
The modified gen p mean: 0.449301540851593, gen p mean: -0.1870337426662445, mean p set: 0.4498290419578552
loss_pred:0.016107022762298584, decouple_loss:0.003911553882062435
WV_1_PC_1_EH_0_PS_30, loss: 0.016654297709465027, avg_mse: 0.02436121739447117
current test mse: 0.024361
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 2181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480728805065155, gen p mean: -0.19361959397792816, mean p set: 0.44859638810157776
loss_pred:0.016679372638463974, decouple_loss:0.003816517535597086
The modified gen p mean: 0.44831955432891846, gen p mean: -0.1846643090248108, mean p set: 0.44889721274375916
loss_pred:0.015751173719763756, decouple_loss:0.003801929298788309
The modified gen p mean: 0.44778767228126526, gen p mean: -0.1910645216703415, mean p set: 0.44836533069610596
loss_pred:0.0162022914737463, decouple_loss:0.0037899084854871035
Iteration: 2182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447488933801651, gen p mean: -0.1910536289215088, mean p set: 0.4480193257331848
loss_pred:0.015802651643753052, decouple_loss:0.003433390287682414
The modified gen p mean: 0.44785651564598083, gen p mean: -0.1890231966972351, mean p set: 0.44843021035194397
loss_pred:0.01569867506623268, decouple_loss:0.003171499352902174
The modified gen p mean: 0.44796597957611084, gen p mean: -0.19228217005729675, mean p set: 0.44854387640953064
loss_pred:0.016149679198861122, decouple_loss:0.003327971091493964
Iteration: 2183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479055106639862, gen p mean: -0.19999131560325623, mean p set: 0.44843557476997375
loss_pred:0.016273237764835358, decouple_loss:0.003633776679635048
The modified gen p mean: 0.4483550488948822, gen p mean: -0.19544290006160736, mean p set: 0.44892874360084534
loss_pred:0.01570962741971016, decouple_loss:0.0032861176878213882
The modified gen p mean: 0.447809636592865, gen p mean: -0.1999671310186386, mean p set: 0.44838467240333557
loss_pred:0.01570393517613411, decouple_loss:0.0037728017196059227
Iteration: 2184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482864439487457, gen p mean: -0.1900091916322708, mean p set: 0.4488089084625244
loss_pred:0.01621558889746666, decouple_loss:0.003363555995747447
The modified gen p mean: 0.4476291239261627, gen p mean: -0.1941254734992981, mean p set: 0.448201984167099
loss_pred:0.015615248121321201, decouple_loss:0.0033812313340604305
The modified gen p mean: 0.44796624779701233, gen p mean: -0.19314078986644745, mean p set: 0.44854554533958435
loss_pred:0.015180602669715881, decouple_loss:0.003430105047300458
Iteration: 2185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483368694782257, gen p mean: -0.1948261559009552, mean p set: 0.4489077031612396
loss_pred:0.015246308408677578, decouple_loss:0.003238081466406584
The modified gen p mean: 0.4480624794960022, gen p mean: -0.1880446821451187, mean p set: 0.44859370589256287The modified gen p mean: 0.44769951701164246, gen p mean: -0.19285602867603302, mean p set: 0.4482753276824951
loss_pred:0.016367362812161446, decouple_loss:0.0032573381904512644
loss_pred:0.015915529802441597, decouple_loss:0.0035233094822615385
Iteration: 2186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475393295288086, gen p mean: -0.1923847198486328, mean p set: 0.4481166899204254
loss_pred:0.016336148604750633, decouple_loss:0.0032316178549081087
The modified gen p mean: 0.4476853609085083, gen p mean: -0.19087126851081848, mean p set: 0.44826412200927734The modified gen p mean: 0.44707998633384705, gen p mean: -0.19459407031536102, mean p set: 0.4476061165332794
loss_pred:0.016235386952757835, decouple_loss:0.003395866369828582
loss_pred:0.01606215164065361, decouple_loss:0.003111253958195448
Iteration: 2187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486865699291229, gen p mean: -0.20064982771873474, mean p set: 0.44926151633262634
loss_pred:0.015752969309687614, decouple_loss:0.003902098396793008
The modified gen p mean: 0.4474527835845947, gen p mean: -0.19472439587116241, mean p set: 0.44797900319099426
The modified gen p mean: 0.4471050202846527, gen p mean: -0.20006608963012695, mean p set: 0.4476796090602875
loss_pred:0.015985475853085518, decouple_loss:0.0037059523165225983
loss_pred:0.016334790736436844, decouple_loss:0.0035140791442245245
Iteration: 2188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789743423461914, gen p mean: -0.19844292104244232, mean p set: 0.44847777485847473
loss_pred:0.015668736770749092, decouple_loss:0.0030082552693784237
The modified gen p mean: 0.44824889302253723, gen p mean: -0.1936214417219162, mean p set: 0.448775053024292The modified gen p mean: 0.44866707921028137, gen p mean: -0.19120565056800842, mean p set: 0.4492427408695221
loss_pred:0.015719186514616013, decouple_loss:0.0033695350866764784
loss_pred:0.016650043427944183, decouple_loss:0.003414643695577979
Iteration: 2189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801968336105347, gen p mean: -0.19091914594173431, mean p set: 0.44859760999679565
loss_pred:0.016666509211063385, decouple_loss:0.004417721647769213
The modified gen p mean: 0.44752123951911926, gen p mean: -0.19523067772388458, mean p set: 0.448095440864563
loss_pred:0.015412275679409504, decouple_loss:0.003854918759316206
The modified gen p mean: 0.4472404718399048, gen p mean: -0.20052923262119293, mean p set: 0.44776955246925354
loss_pred:0.01599188894033432, decouple_loss:0.0044798217713832855
Iteration: 2190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484650194644928, gen p mean: -0.19117829203605652, mean p set: 0.44904080033302307
loss_pred:0.015248576179146767, decouple_loss:0.003442934947088361
The modified gen p mean: 0.44770801067352295, gen p mean: -0.19216662645339966, mean p set: 0.44828298687934875
loss_pred:0.01611880026757717, decouple_loss:0.003417371306568384
The modified gen p mean: 0.4481455385684967, gen p mean: -0.19453343749046326, mean p set: 0.4486706554889679
loss_pred:0.015128693543374538, decouple_loss:0.0038763454649597406
2023-04-27 08:21:21 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.18870368599891663, mean p set: 0.4499112665653229
loss_pred:0.01658625341951847, decouple_loss:0.004161325749009848
The modified gen p mean: 0.44930151104927063, gen p mean: -0.18963204324245453, mean p set: 0.4498290419578552
loss_pred:0.016202885657548904, decouple_loss:0.004199070855975151
The modified gen p mean: 0.4482210576534271, gen p mean: -0.18648840487003326, mean p set: 0.44879910349845886
loss_pred:0.01655024290084839, decouple_loss:0.004005645867437124
WV_1_PC_1_EH_0_PS_30, loss: 0.016652561724185944, avg_mse: 0.024274930357933044
current test mse: 0.024275
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871053099632263, gen p mean: -0.18840156495571136, mean p set: 0.44928398728370667
loss_pred:0.01635150983929634, decouple_loss:0.004174735862761736
The modified gen p mean: 0.4476751983165741, gen p mean: -0.1905575692653656, mean p set: 0.44819650053977966
loss_pred:0.015224323607981205, decouple_loss:0.004261168651282787
The modified gen p mean: 0.4476754367351532, gen p mean: -0.19217939674854279, mean p set: 0.4482516348361969
loss_pred:0.01613728702068329, decouple_loss:0.004169711843132973
Iteration: 2192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766470789909363, gen p mean: -0.19642266631126404, mean p set: 0.44819343090057373
loss_pred:0.01591486856341362, decouple_loss:0.0034080143086612225
The modified gen p mean: 0.4482497572898865, gen p mean: -0.1932399570941925, mean p set: 0.4488312005996704
The modified gen p mean: 0.447456955909729, gen p mean: -0.19559188187122345, mean p set: 0.44802939891815186
loss_pred:0.015471966937184334, decouple_loss:0.0032672788947820663
loss_pred:0.016084499657154083, decouple_loss:0.0032614697702229023
Iteration: 2193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474561810493469, gen p mean: -0.19329392910003662, mean p set: 0.4479837417602539
loss_pred:0.01599210873246193, decouple_loss:0.0037670666351914406
The modified gen p mean: 0.4473518431186676, gen p mean: -0.1879008263349533, mean p set: 0.44792643189430237
The modified gen p mean: 0.44775936007499695, gen p mean: -0.18712854385375977, mean p set: 0.4483332633972168
loss_pred:0.015911825001239777, decouple_loss:0.0035357975866645575
loss_pred:0.01579364575445652, decouple_loss:0.0035369370598345995
Iteration: 2194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808512926101685, gen p mean: -0.19502854347229004, mean p set: 0.4486139416694641
loss_pred:0.015483087860047817, decouple_loss:0.0031736346427351236
The modified gen p mean: 0.4479038715362549, gen p mean: -0.18934620916843414, mean p set: 0.4484822154045105
The modified gen p mean: 0.44731849431991577, gen p mean: -0.18912014365196228, mean p set: 0.44789719581604004
loss_pred:0.015613549388945103, decouple_loss:0.0034418434370309114
loss_pred:0.015499898232519627, decouple_loss:0.0032029645517468452
Iteration: 2195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778451323509216, gen p mean: -0.19733457267284393, mean p set: 0.4483576714992523
loss_pred:0.01606917381286621, decouple_loss:0.00279686925932765
The modified gen p mean: 0.44742244482040405, gen p mean: -0.19263175129890442, mean p set: 0.44799885153770447The modified gen p mean: 0.44817811250686646, gen p mean: -0.18986822664737701, mean p set: 0.4487065374851227
loss_pred:0.015226902440190315, decouple_loss:0.003032143460586667
loss_pred:0.015246473252773285, decouple_loss:0.0030071125365793705
Iteration: 2196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471789300441742, gen p mean: -0.19524233043193817, mean p set: 0.4477587640285492
loss_pred:0.01586798019707203, decouple_loss:0.0030235140584409237
The modified gen p mean: 0.4480629563331604, gen p mean: -0.19170257449150085, mean p set: 0.4485950171947479The modified gen p mean: 0.44906923174858093, gen p mean: -0.19215106964111328, mean p set: 0.4496433436870575
loss_pred:0.015634339302778244, decouple_loss:0.0031478244345635176
loss_pred:0.01628657802939415, decouple_loss:0.0031647668220102787
Iteration: 2197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475293457508087, gen p mean: -0.19241094589233398, mean p set: 0.44810721278190613
loss_pred:0.015677347779273987, decouple_loss:0.0028815148398280144
The modified gen p mean: 0.4485919177532196, gen p mean: -0.18400414288043976, mean p set: 0.4491655230522156The modified gen p mean: 0.44802019000053406, gen p mean: -0.186118945479393, mean p set: 0.4485490918159485
loss_pred:0.015541821718215942, decouple_loss:0.002810330595821142
loss_pred:0.016359252855181694, decouple_loss:0.0028253805357962847
Iteration: 2198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477651119232178, gen p mean: -0.18433843553066254, mean p set: 0.448341965675354
loss_pred:0.015936991199851036, decouple_loss:0.0029636449180543423
The modified gen p mean: 0.44732722640037537, gen p mean: -0.1821843534708023, mean p set: 0.4478999972343445
loss_pred:0.01572806015610695, decouple_loss:0.0032197292894124985
The modified gen p mean: 0.44787096977233887, gen p mean: -0.18240053951740265, mean p set: 0.44839832186698914
loss_pred:0.015256891027092934, decouple_loss:0.003274720860645175
Iteration: 2199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478842616081238, gen p mean: -0.17784684896469116, mean p set: 0.44846177101135254
loss_pred:0.01547465194016695, decouple_loss:0.002926265588030219
The modified gen p mean: 0.44780898094177246, gen p mean: -0.17847277224063873, mean p set: 0.44838589429855347
loss_pred:0.016114946454763412, decouple_loss:0.0029898067004978657
The modified gen p mean: 0.4479517340660095, gen p mean: -0.18370214104652405, mean p set: 0.44847962260246277
loss_pred:0.016335202381014824, decouple_loss:0.0030035425443202257
Iteration: 2200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447709858417511, gen p mean: -0.18233098089694977, mean p set: 0.44828253984451294
loss_pred:0.01571924425661564, decouple_loss:0.002973921364173293
The modified gen p mean: 0.44741666316986084, gen p mean: -0.1795188933610916, mean p set: 0.4479960799217224
loss_pred:0.015825707465410233, decouple_loss:0.0029942551627755165
The modified gen p mean: 0.44778603315353394, gen p mean: -0.17823848128318787, mean p set: 0.4483139216899872
loss_pred:0.015400667674839497, decouple_loss:0.0031861593015491962
2023-04-27 08:24:46 testing...
The modified gen p mean: 0.4482209086418152, gen p mean: -0.1818961650133133, mean p set: 0.44879910349845886
loss_pred:0.016512712463736534, decouple_loss:0.0032004101667553186
The modified gen p mean: 0.4494309425354004, gen p mean: -0.18399518728256226, mean p set: 0.4499112665653229
loss_pred:0.01657024398446083, decouple_loss:0.003326491452753544
The modified gen p mean: 0.44930168986320496, gen p mean: -0.18488571047782898, mean p set: 0.4498290419578552
loss_pred:0.016155321151018143, decouple_loss:0.0031508207321166992
WV_1_PC_1_EH_0_PS_30, loss: 0.016574054956436157, avg_mse: 0.024292653426527977
current test mse: 0.024293
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 2201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465863108634949, gen p mean: -0.1853114664554596, mean p set: 0.4471120834350586
loss_pred:0.01582297310233116, decouple_loss:0.0033092289231717587
The modified gen p mean: 0.4477684795856476, gen p mean: -0.18849027156829834, mean p set: 0.4483468234539032
loss_pred:0.0153149189427495, decouple_loss:0.00322625576518476
The modified gen p mean: 0.4480220377445221, gen p mean: -0.18480589985847473, mean p set: 0.44859448075294495
loss_pred:0.016161667183041573, decouple_loss:0.0032141064293682575
Iteration: 2202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482087790966034, gen p mean: -0.1879512220621109, mean p set: 0.44873204827308655
loss_pred:0.015182695351541042, decouple_loss:0.0036644248757511377
The modified gen p mean: 0.44758614897727966, gen p mean: -0.18599191308021545, mean p set: 0.44815605878829956
loss_pred:0.015325936488807201, decouple_loss:0.0033316740300506353
The modified gen p mean: 0.44740307331085205, gen p mean: -0.1877748966217041, mean p set: 0.4479806125164032
loss_pred:0.015523900277912617, decouple_loss:0.003434410085901618
Iteration: 2203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657212495803833, gen p mean: -0.19077272713184357, mean p set: 0.44710099697113037
loss_pred:0.015422789379954338, decouple_loss:0.0031487601809203625
The modified gen p mean: 0.4480552673339844, gen p mean: -0.19597946107387543, mean p set: 0.4486336410045624
loss_pred:0.01569492556154728, decouple_loss:0.00316334655508399
The modified gen p mean: 0.4463474154472351, gen p mean: -0.18776097893714905, mean p set: 0.4469250440597534
loss_pred:0.01674838364124298, decouple_loss:0.0037910614628344774
Iteration: 2204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44596174359321594, gen p mean: -0.18799041211605072, mean p set: 0.44649171829223633
loss_pred:0.016118163242936134, decouple_loss:0.002980889054015279
The modified gen p mean: 0.44765302538871765, gen p mean: -0.1926807016134262, mean p set: 0.44823282957077026
loss_pred:0.016251232475042343, decouple_loss:0.002949767280369997
The modified gen p mean: 0.4487183392047882, gen p mean: -0.19274266064167023, mean p set: 0.44929662346839905
loss_pred:0.015213768929243088, decouple_loss:0.002920292317867279
Iteration: 2205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471822679042816, gen p mean: -0.18718872964382172, mean p set: 0.4477138817310333
loss_pred:0.015457156114280224, decouple_loss:0.003456051927059889
The modified gen p mean: 0.4474574029445648, gen p mean: -0.188066765666008, mean p set: 0.44803762435913086
loss_pred:0.016346029937267303, decouple_loss:0.0035387862008064985
The modified gen p mean: 0.44790345430374146, gen p mean: -0.1918293684720993, mean p set: 0.44847849011421204
loss_pred:0.015516657382249832, decouple_loss:0.0033482445869594812
Iteration: 2206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481704831123352, gen p mean: -0.18928609788417816, mean p set: 0.4487445652484894
loss_pred:0.015542090870440006, decouple_loss:0.002947046421468258
The modified gen p mean: 0.4472121000289917, gen p mean: -0.1892186999320984, mean p set: 0.44778627157211304The modified gen p mean: 0.4466138482093811, gen p mean: -0.1908421516418457, mean p set: 0.44714486598968506
loss_pred:0.015451095066964626, decouple_loss:0.0030253741424530745
loss_pred:0.015877727419137955, decouple_loss:0.003095892956480384
Iteration: 2207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44564685225486755, gen p mean: -0.19040615856647491, mean p set: 0.4462227523326874
loss_pred:0.015222346410155296, decouple_loss:0.00328634912148118
The modified gen p mean: 0.4485626816749573, gen p mean: -0.19527162611484528, mean p set: 0.449090838432312The modified gen p mean: 0.44593602418899536, gen p mean: -0.19274793565273285, mean p set: 0.44651445746421814
loss_pred:0.015134446322917938, decouple_loss:0.0031687135342508554
loss_pred:0.015556246973574162, decouple_loss:0.0032750496175140142
Iteration: 2208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833746552467346, gen p mean: -0.1906047910451889, mean p set: 0.4489142596721649
loss_pred:0.01535835862159729, decouple_loss:0.003714539110660553
The modified gen p mean: 0.44659098982810974, gen p mean: -0.18600037693977356, mean p set: 0.44717034697532654The modified gen p mean: 0.4476117193698883, gen p mean: -0.18562962114810944, mean p set: 0.4481431543827057
loss_pred:0.016353532671928406, decouple_loss:0.003497899044305086
loss_pred:0.015292605385184288, decouple_loss:0.0033210369292646646
Iteration: 2209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482521712779999, gen p mean: -0.18027718365192413, mean p set: 0.4488321542739868
loss_pred:0.015290128998458385, decouple_loss:0.003066443372517824
The modified gen p mean: 0.44643068313598633, gen p mean: -0.18046849966049194, mean p set: 0.44696107506752014
loss_pred:0.015974003821611404, decouple_loss:0.0032467199489474297
The modified gen p mean: 0.44714778661727905, gen p mean: -0.17903292179107666, mean p set: 0.44772249460220337
loss_pred:0.0159172210842371, decouple_loss:0.0031382893212139606
Iteration: 2210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649937748908997, gen p mean: -0.18017707765102386, mean p set: 0.4470709264278412
loss_pred:0.016509095206856728, decouple_loss:0.004006280563771725
The modified gen p mean: 0.44689619541168213, gen p mean: -0.18245770037174225, mean p set: 0.44747447967529297
loss_pred:0.015459279529750347, decouple_loss:0.003498428501188755
The modified gen p mean: 0.44812312722206116, gen p mean: -0.18266117572784424, mean p set: 0.4486530125141144
loss_pred:0.016293656080961227, decouple_loss:0.003639394883066416
2023-04-27 08:28:50 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.18249116837978363, mean p set: 0.4499112665653229
loss_pred:0.016531938686966896, decouple_loss:0.003462244989350438
The modified gen p mean: 0.44930195808410645, gen p mean: -0.183143749833107, mean p set: 0.4498290419578552
loss_pred:0.016147833317518234, decouple_loss:0.0034036869183182716
The modified gen p mean: 0.4482212960720062, gen p mean: -0.18013474345207214, mean p set: 0.44879910349845886
loss_pred:0.016490589827299118, decouple_loss:0.00322282244451344
WV_1_PC_1_EH_0_PS_30, loss: 0.016558267176151276, avg_mse: 0.024252278730273247
current test mse: 0.024252
Iteration: 2211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781169295310974, gen p mean: -0.18673838675022125, mean p set: 0.4483872950077057
loss_pred:0.01532213855534792, decouple_loss:0.0037253363989293575
The modified gen p mean: 0.4471087157726288, gen p mean: -0.18166780471801758, mean p set: 0.44768208265304565
loss_pred:0.014876259490847588, decouple_loss:0.0033898751717060804
The modified gen p mean: 0.4481023848056793, gen p mean: -0.1849563866853714, mean p set: 0.4486321210861206
loss_pred:0.015260854735970497, decouple_loss:0.0032422877848148346
Iteration: 2212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718122482299805, gen p mean: -0.18630962073802948, mean p set: 0.4477066397666931
loss_pred:0.015660090371966362, decouple_loss:0.002969077555462718
The modified gen p mean: 0.4469263553619385, gen p mean: -0.18803717195987701, mean p set: 0.4475022256374359
The modified gen p mean: 0.4458823502063751, gen p mean: -0.18796570599079132, mean p set: 0.4464513063430786
loss_pred:0.015658987686038017, decouple_loss:0.003095074323937297
loss_pred:0.01618570275604725, decouple_loss:0.0031624517869204283
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455237090587616, gen p mean: -0.19148515164852142, mean p set: 0.4460570514202118
loss_pred:0.014941651374101639, decouple_loss:0.0033513414673507214
The modified gen p mean: 0.4469875991344452, gen p mean: -0.1865321546792984, mean p set: 0.4475656747817993
The modified gen p mean: 0.4477347731590271, gen p mean: -0.18773233890533447, mean p set: 0.4483067989349365
loss_pred:0.015583274886012077, decouple_loss:0.0036125299520790577
loss_pred:0.015958411619067192, decouple_loss:0.0037249233573675156
Iteration: 2214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682711362838745, gen p mean: -0.1842678040266037, mean p set: 0.4473552703857422
loss_pred:0.015667054802179337, decouple_loss:0.003087857272475958
The modified gen p mean: 0.4464412331581116, gen p mean: -0.18857894837856293, mean p set: 0.44701406359672546The modified gen p mean: 0.4462990462779999, gen p mean: -0.1894388496875763, mean p set: 0.44687342643737793
loss_pred:0.016268227249383926, decouple_loss:0.003127215662971139
loss_pred:0.016514817252755165, decouple_loss:0.002999573480337858
Iteration: 2215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605743885040283, gen p mean: -0.18483664095401764, mean p set: 0.4466347098350525
loss_pred:0.015154150314629078, decouple_loss:0.003406490897759795
The modified gen p mean: 0.4451392590999603, gen p mean: -0.1902354210615158, mean p set: 0.44571492075920105
loss_pred:0.015096425078809261, decouple_loss:0.003673676634207368
The modified gen p mean: 0.44701799750328064, gen p mean: -0.18325366079807281, mean p set: 0.44754740595817566
loss_pred:0.016003474593162537, decouple_loss:0.0034016084391623735
Iteration: 2216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471990168094635, gen p mean: -0.18298549950122833, mean p set: 0.4477720260620117
loss_pred:0.01537126675248146, decouple_loss:0.002928035566583276
The modified gen p mean: 0.44799408316612244, gen p mean: -0.18452119827270508, mean p set: 0.4485243558883667The modified gen p mean: 0.4469990134239197, gen p mean: -0.1857660859823227, mean p set: 0.44757208228111267
loss_pred:0.015078363008797169, decouple_loss:0.0029371583368629217
loss_pred:0.015096635557711124, decouple_loss:0.003237477270886302
Iteration: 2217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891640543937683, gen p mean: -0.19074518978595734, mean p set: 0.44949212670326233
loss_pred:0.015249434858560562, decouple_loss:0.003298401366919279
The modified gen p mean: 0.446181058883667, gen p mean: -0.18942908942699432, mean p set: 0.4467092752456665The modified gen p mean: 0.4473405182361603, gen p mean: -0.1853867769241333, mean p set: 0.4479168951511383
loss_pred:0.014970025978982449, decouple_loss:0.003251660382375121
loss_pred:0.016352351754903793, decouple_loss:0.003022223711013794
Iteration: 2218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476085305213928, gen p mean: -0.1893789917230606, mean p set: 0.44818755984306335
loss_pred:0.01573551818728447, decouple_loss:0.0032037412747740746
The modified gen p mean: 0.4468528926372528, gen p mean: -0.18810297548770905, mean p set: 0.44742488861083984
loss_pred:0.016329100355505943, decouple_loss:0.0032201330177485943
The modified gen p mean: 0.44790613651275635, gen p mean: -0.1845400482416153, mean p set: 0.44843539595603943
loss_pred:0.014937207102775574, decouple_loss:0.002849521115422249
Iteration: 2219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447938472032547, gen p mean: -0.18456894159317017, mean p set: 0.4485151767730713
loss_pred:0.015192977152764797, decouple_loss:0.0028958700131624937
The modified gen p mean: 0.44869932532310486, gen p mean: -0.18742331862449646, mean p set: 0.44927650690078735
loss_pred:0.015106267295777798, decouple_loss:0.0029912362806499004
The modified gen p mean: 0.4487561285495758, gen p mean: -0.18777157366275787, mean p set: 0.44928810000419617
loss_pred:0.015590842813253403, decouple_loss:0.002946568187326193
Iteration: 2220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462936520576477, gen p mean: -0.18206799030303955, mean p set: 0.44687098264694214
loss_pred:0.014943407848477364, decouple_loss:0.00359537685289979
The modified gen p mean: 0.4471921920776367, gen p mean: -0.18021157383918762, mean p set: 0.44777190685272217
loss_pred:0.014736421406269073, decouple_loss:0.003616433823481202
The modified gen p mean: 0.44861096143722534, gen p mean: -0.19063065946102142, mean p set: 0.44913914799690247
loss_pred:0.015812452882528305, decouple_loss:0.002963462844491005
2023-04-27 08:32:15 testing...
The modified gen p mean: 0.4482167363166809, gen p mean: -0.18128900229930878, mean p set: 0.44879910349845886
loss_pred:0.016564341261982918, decouple_loss:0.0033283759839832783
The modified gen p mean: 0.4494309425354004, gen p mean: -0.18360154330730438, mean p set: 0.4499112665653229
loss_pred:0.016573285683989525, decouple_loss:0.0035622103605419397
The modified gen p mean: 0.44930022954940796, gen p mean: -0.1841014176607132, mean p set: 0.4498290419578552
loss_pred:0.016163188964128494, decouple_loss:0.003449025098234415
WV_1_PC_1_EH_0_PS_30, loss: 0.016605932265520096, avg_mse: 0.02436877228319645
current test mse: 0.024369
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 2221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831106066703796, gen p mean: -0.19003376364707947, mean p set: 0.44883859157562256
loss_pred:0.014851757325232029, decouple_loss:0.0036168077494949102
The modified gen p mean: 0.44761040806770325, gen p mean: -0.1817086935043335, mean p set: 0.4481886029243469
loss_pred:0.015225064009428024, decouple_loss:0.00343664875254035
The modified gen p mean: 0.44791942834854126, gen p mean: -0.18588733673095703, mean p set: 0.4484882652759552
loss_pred:0.015084680169820786, decouple_loss:0.0034730813931673765
Iteration: 2222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838014245033264, gen p mean: -0.18318788707256317, mean p set: 0.4489034116268158
loss_pred:0.01512952521443367, decouple_loss:0.0038094341289252043
The modified gen p mean: 0.4477548897266388, gen p mean: -0.18493428826332092, mean p set: 0.44832542538642883
loss_pred:0.015778744593262672, decouple_loss:0.003800267819315195
The modified gen p mean: 0.44861966371536255, gen p mean: -0.17883771657943726, mean p set: 0.44919553399086
loss_pred:0.015454012900590897, decouple_loss:0.004200938623398542
Iteration: 2223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729283452033997, gen p mean: -0.18931923806667328, mean p set: 0.4478180706501007
loss_pred:0.016118818894028664, decouple_loss:0.0038507101126015186
The modified gen p mean: 0.4486595690250397, gen p mean: -0.18676942586898804, mean p set: 0.4492400586605072
loss_pred:0.01591069996356964, decouple_loss:0.0035257921554148197
The modified gen p mean: 0.44773149490356445, gen p mean: -0.1864979863166809, mean p set: 0.44830384850502014
loss_pred:0.014612994156777859, decouple_loss:0.0035093247424811125
Iteration: 2224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475618302822113, gen p mean: -0.18874816596508026, mean p set: 0.4480898678302765
loss_pred:0.015397410839796066, decouple_loss:0.0037587492261081934
The modified gen p mean: 0.4490816295146942, gen p mean: -0.19169625639915466, mean p set: 0.44965940713882446
loss_pred:0.014753754250705242, decouple_loss:0.003866872750222683
The modified gen p mean: 0.44844576716423035, gen p mean: -0.19023722410202026, mean p set: 0.4490225911140442
loss_pred:0.015481269918382168, decouple_loss:0.0034226570278406143
Iteration: 2225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479888677597046, gen p mean: -0.19132772088050842, mean p set: 0.44856372475624084
loss_pred:0.014910653233528137, decouple_loss:0.0037853000685572624
The modified gen p mean: 0.44813796877861023, gen p mean: -0.1894194334745407, mean p set: 0.44866296648979187The modified gen p mean: 0.4491349160671234, gen p mean: -0.19052298367023468, mean p set: 0.4497077465057373
loss_pred:0.015190372243523598, decouple_loss:0.0034586454275995493
loss_pred:0.015655970200896263, decouple_loss:0.004142622463405132
Iteration: 2226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904905557632446, gen p mean: -0.17827695608139038, mean p set: 0.4496217370033264
loss_pred:0.014765055850148201, decouple_loss:0.0038913001772016287
The modified gen p mean: 0.44880303740501404, gen p mean: -0.18114811182022095, mean p set: 0.44932955503463745The modified gen p mean: 0.44806763529777527, gen p mean: -0.1831263154745102, mean p set: 0.4486420452594757
loss_pred:0.015843432396650314, decouple_loss:0.003641364863142371
loss_pred:0.015489584766328335, decouple_loss:0.004161193035542965
Iteration: 2227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484056532382965, gen p mean: -0.18060830235481262, mean p set: 0.44897738099098206
loss_pred:0.014692011289298534, decouple_loss:0.0037534895818680525
The modified gen p mean: 0.44853827357292175, gen p mean: -0.18163378536701202, mean p set: 0.4490686058998108The modified gen p mean: 0.44888532161712646, gen p mean: -0.18421730399131775, mean p set: 0.44945937395095825
loss_pred:0.014138612896203995, decouple_loss:0.0039002164267003536
loss_pred:0.015837378799915314, decouple_loss:0.003756667487323284
Iteration: 2228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484730660915375, gen p mean: -0.18039782345294952, mean p set: 0.44905519485473633
loss_pred:0.015231947414577007, decouple_loss:0.004691678564995527
The modified gen p mean: 0.44787275791168213, gen p mean: -0.17780165374279022, mean p set: 0.44840162992477417The modified gen p mean: 0.4479864537715912, gen p mean: -0.18348756432533264, mean p set: 0.4485659599304199
loss_pred:0.015372416004538536, decouple_loss:0.004547182936221361
loss_pred:0.01465300377458334, decouple_loss:0.00406746007502079
Iteration: 2229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872406125068665, gen p mean: -0.17936186492443085, mean p set: 0.44930222630500793
loss_pred:0.015200872905552387, decouple_loss:0.003556757001206279
The modified gen p mean: 0.44961652159690857, gen p mean: -0.1880844384431839, mean p set: 0.45019209384918213
loss_pred:0.015862928703427315, decouple_loss:0.003334582317620516
The modified gen p mean: 0.44739702343940735, gen p mean: -0.19152694940567017, mean p set: 0.4479256868362427
loss_pred:0.015205965377390385, decouple_loss:0.00354336597956717
Iteration: 2230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488588869571686, gen p mean: -0.18477395176887512, mean p set: 0.449429988861084
loss_pred:0.015674537047743797, decouple_loss:0.003531285095959902
The modified gen p mean: 0.4491841197013855, gen p mean: -0.18039359152317047, mean p set: 0.44971105456352234The modified gen p mean: 0.4487093687057495, gen p mean: -0.1868627518415451, mean p set: 0.4492858350276947
loss_pred:0.014571590349078178, decouple_loss:0.0034771193750202656
loss_pred:0.015140916220843792, decouple_loss:0.0033726596739143133
2023-04-27 08:36:20 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.18850935995578766, mean p set: 0.4499112665653229
loss_pred:0.016672763973474503, decouple_loss:0.0034540947526693344
The modified gen p mean: 0.44929248094558716, gen p mean: -0.18849986791610718, mean p set: 0.4498290419578552
loss_pred:0.016192685812711716, decouple_loss:0.0034088934771716595
The modified gen p mean: 0.44822242856025696, gen p mean: -0.1857561469078064, mean p set: 0.44879910349845886
loss_pred:0.0166320763528347, decouple_loss:0.003376570763066411
WV_1_PC_1_EH_0_PS_30, loss: 0.01666983589529991, avg_mse: 0.024551227688789368
current test mse: 0.024551
Iteration: 2231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789382815361023, gen p mean: -0.1975703090429306, mean p set: 0.448469340801239
loss_pred:0.01493648812174797, decouple_loss:0.003156948834657669
The modified gen p mean: 0.44860222935676575, gen p mean: -0.18600568175315857, mean p set: 0.44913092255592346
loss_pred:0.015102393925189972, decouple_loss:0.003123008646070957
The modified gen p mean: 0.4486750662326813, gen p mean: -0.1885962188243866, mean p set: 0.4492567181587219
loss_pred:0.015161996707320213, decouple_loss:0.0030502169393002987
Iteration: 2232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475692808628082, gen p mean: -0.190322145819664, mean p set: 0.4480970501899719
loss_pred:0.014880143105983734, decouple_loss:0.00366824003867805
The modified gen p mean: 0.44963863492012024, gen p mean: -0.19652633368968964, mean p set: 0.450207382440567
The modified gen p mean: 0.44987085461616516, gen p mean: -0.19652950763702393, mean p set: 0.4504498541355133
loss_pred:0.014682380482554436, decouple_loss:0.0031947926618158817
loss_pred:0.014775785617530346, decouple_loss:0.003076702356338501
Iteration: 2233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483560025691986, gen p mean: -0.18597853183746338, mean p set: 0.4488828480243683
loss_pred:0.015411359257996082, decouple_loss:0.003050827421247959
The modified gen p mean: 0.44872862100601196, gen p mean: -0.19215361773967743, mean p set: 0.44930025935173035
The modified gen p mean: 0.44831761717796326, gen p mean: -0.19112038612365723, mean p set: 0.4488929510116577
loss_pred:0.014639250934123993, decouple_loss:0.0030081658624112606
loss_pred:0.01549513079226017, decouple_loss:0.0030922521837055683
Iteration: 2234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476407766342163, gen p mean: -0.17854709923267365, mean p set: 0.4481671154499054
loss_pred:0.014717030338943005, decouple_loss:0.0034538141917437315
The modified gen p mean: 0.4493556022644043, gen p mean: -0.18260075151920319, mean p set: 0.44993188977241516
The modified gen p mean: 0.44857606291770935, gen p mean: -0.18826761841773987, mean p set: 0.449150025844574
loss_pred:0.015290000475943089, decouple_loss:0.0030404049903154373
loss_pred:0.01498895138502121, decouple_loss:0.0030940209981054068
Iteration: 2235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784289598464966, gen p mean: -0.17778661847114563, mean p set: 0.44841691851615906
loss_pred:0.014543399214744568, decouple_loss:0.003015952417626977
The modified gen p mean: 0.44812673330307007, gen p mean: -0.18338806927204132, mean p set: 0.4486553370952606The modified gen p mean: 0.4490756094455719, gen p mean: -0.18811775743961334, mean p set: 0.4496510326862335
loss_pred:0.015242046676576138, decouple_loss:0.0030340177472680807
loss_pred:0.015509304590523243, decouple_loss:0.002680534264072776
Iteration: 2236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859036803245544, gen p mean: -0.17706194519996643, mean p set: 0.44916436076164246
loss_pred:0.01483345590531826, decouple_loss:0.003375628963112831
The modified gen p mean: 0.44710832834243774, gen p mean: -0.18089796602725983, mean p set: 0.4476362466812134The modified gen p mean: 0.44784748554229736, gen p mean: -0.18041524291038513, mean p set: 0.4484257698059082
loss_pred:0.015382160432636738, decouple_loss:0.0031616040505468845
loss_pred:0.015939155593514442, decouple_loss:0.003993555437773466
Iteration: 2237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825249910354614, gen p mean: -0.1742829978466034, mean p set: 0.4488309919834137
loss_pred:0.015788966789841652, decouple_loss:0.003054547356441617
The modified gen p mean: 0.45014309883117676, gen p mean: -0.17213603854179382, mean p set: 0.4506753385066986The modified gen p mean: 0.449348509311676, gen p mean: -0.17119328677654266, mean p set: 0.44992080330848694
loss_pred:0.0158693864941597, decouple_loss:0.0027794272173196077
loss_pred:0.014989558607339859, decouple_loss:0.002880589570850134
Iteration: 2238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488578736782074, gen p mean: -0.17562226951122284, mean p set: 0.44943690299987793
loss_pred:0.014734279364347458, decouple_loss:0.002805815078318119
The modified gen p mean: 0.4478207230567932, gen p mean: -0.17724931240081787, mean p set: 0.44834965467453003The modified gen p mean: 0.44842469692230225, gen p mean: -0.17668791115283966, mean p set: 0.44900044798851013
loss_pred:0.014565195888280869, decouple_loss:0.0036791390739381313
loss_pred:0.015793327242136, decouple_loss:0.0028439750894904137
Iteration: 2239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483107626438141, gen p mean: -0.18865038454532623, mean p set: 0.4488871097564697
loss_pred:0.01486345287412405, decouple_loss:0.0035045454278588295
The modified gen p mean: 0.449347585439682, gen p mean: -0.18853583931922913, mean p set: 0.4499247372150421
The modified gen p mean: 0.4474318027496338, gen p mean: -0.19075994193553925, mean p set: 0.4479579031467438
loss_pred:0.014398882165551186, decouple_loss:0.003278206568211317
loss_pred:0.015173171646893024, decouple_loss:0.0032654607202857733
Iteration: 2240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848906993865967, gen p mean: -0.19101998209953308, mean p set: 0.4490663409233093
loss_pred:0.014641968533396721, decouple_loss:0.003267516614869237
The modified gen p mean: 0.4487314224243164, gen p mean: -0.19022269546985626, mean p set: 0.44925642013549805The modified gen p mean: 0.44773074984550476, gen p mean: -0.18698914349079132, mean p set: 0.4483124613761902
loss_pred:0.014728181064128876, decouple_loss:0.0031196800991892815
loss_pred:0.015533428639173508, decouple_loss:0.003191529307514429
2023-04-27 08:39:44 testing...
The modified gen p mean: 0.44821983575820923, gen p mean: -0.18122072517871857, mean p set: 0.44879910349845886
loss_pred:0.016713328659534454, decouple_loss:0.00324697676114738
The modified gen p mean: 0.4494309425354004, gen p mean: -0.18347285687923431, mean p set: 0.4499112665653229
loss_pred:0.01668715290725231, decouple_loss:0.003198196878656745
The modified gen p mean: 0.4493022859096527, gen p mean: -0.18429702520370483, mean p set: 0.4498290419578552
loss_pred:0.016172146424651146, decouple_loss:0.0032709434162825346
WV_1_PC_1_EH_0_PS_30, loss: 0.016686145216226578, avg_mse: 0.02454712614417076
current test mse: 0.024547
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 2241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480072259902954, gen p mean: -0.18334493041038513, mean p set: 0.4485322833061218
loss_pred:0.01557425782084465, decouple_loss:0.0031076371669769287
The modified gen p mean: 0.4476805329322815, gen p mean: -0.18373681604862213, mean p set: 0.44825538992881775
loss_pred:0.015654854476451874, decouple_loss:0.003082525683566928
The modified gen p mean: 0.4476320147514343, gen p mean: -0.18600250780582428, mean p set: 0.44820985198020935
loss_pred:0.015978464856743813, decouple_loss:0.003061613766476512
Iteration: 2242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990700483322144, gen p mean: -0.1794063299894333, mean p set: 0.45043665170669556
loss_pred:0.016113879159092903, decouple_loss:0.003010904649272561
The modified gen p mean: 0.44750913977622986, gen p mean: -0.17538021504878998, mean p set: 0.4480845034122467
loss_pred:0.01645834743976593, decouple_loss:0.0031426111236214638
The modified gen p mean: 0.4470519423484802, gen p mean: -0.1747598946094513, mean p set: 0.44762876629829407
loss_pred:0.0171845480799675, decouple_loss:0.002870116150006652
Iteration: 2243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828301668167114, gen p mean: -0.17748619616031647, mean p set: 0.44880983233451843
loss_pred:0.016723299399018288, decouple_loss:0.0029938509687781334
The modified gen p mean: 0.44741809368133545, gen p mean: -0.17575152218341827, mean p set: 0.44799840450286865
loss_pred:0.01648258976638317, decouple_loss:0.003353371052071452
The modified gen p mean: 0.4476780891418457, gen p mean: -0.17647835612297058, mean p set: 0.4482552707195282
loss_pred:0.016211383044719696, decouple_loss:0.002956225536763668
Iteration: 2244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745519757270813, gen p mean: -0.18137496709823608, mean p set: 0.44798803329467773
loss_pred:0.01552637480199337, decouple_loss:0.0029201472643762827
The modified gen p mean: 0.4479314684867859, gen p mean: -0.17982758581638336, mean p set: 0.4485079050064087
loss_pred:0.015333175659179688, decouple_loss:0.002893161727115512
The modified gen p mean: 0.4471012353897095, gen p mean: -0.17794112861156464, mean p set: 0.4476771950721741
loss_pred:0.016892772167921066, decouple_loss:0.002909549279138446
Iteration: 2245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700857996940613, gen p mean: -0.18260177969932556, mean p set: 0.44758591055870056
loss_pred:0.015114044770598412, decouple_loss:0.002845608163625002
The modified gen p mean: 0.4486088156700134, gen p mean: -0.1800823211669922, mean p set: 0.44918495416641235The modified gen p mean: 0.44733068346977234, gen p mean: -0.1769264042377472, mean p set: 0.44785773754119873
loss_pred:0.015437601134181023, decouple_loss:0.0028176719788461924
loss_pred:0.015457458794116974, decouple_loss:0.003153935307636857
Iteration: 2246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842106103897095, gen p mean: -0.18332916498184204, mean p set: 0.4489997327327728
loss_pred:0.015607105568051338, decouple_loss:0.002651069313287735
The modified gen p mean: 0.4473648965358734, gen p mean: -0.17808286845684052, mean p set: 0.44789284467697144The modified gen p mean: 0.4472391605377197, gen p mean: -0.18497461080551147, mean p set: 0.4478192627429962
loss_pred:0.014772804453969002, decouple_loss:0.0026576940435916185
loss_pred:0.015416051261126995, decouple_loss:0.0026912244502454996
Iteration: 2247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481525421142578, gen p mean: -0.1777523308992386, mean p set: 0.44872695207595825
loss_pred:0.016118191182613373, decouple_loss:0.0027294608298689127
The modified gen p mean: 0.4496119022369385, gen p mean: -0.1879979521036148, mean p set: 0.4501863420009613
loss_pred:0.016003303229808807, decouple_loss:0.0028548464179039
The modified gen p mean: 0.4473649859428406, gen p mean: -0.18603655695915222, mean p set: 0.44789400696754456
loss_pred:0.016096031293272972, decouple_loss:0.0026613473892211914
Iteration: 2248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477275609970093, gen p mean: -0.1860760748386383, mean p set: 0.4483044445514679
loss_pred:0.016254235059022903, decouple_loss:0.0030579257290810347
The modified gen p mean: 0.447846919298172, gen p mean: -0.19075298309326172, mean p set: 0.4484177529811859
loss_pred:0.015604441054165363, decouple_loss:0.002851995872333646
The modified gen p mean: 0.44854044914245605, gen p mean: -0.18886736035346985, mean p set: 0.4490683674812317
loss_pred:0.015112590976059437, decouple_loss:0.0030614391434937716
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474693834781647, gen p mean: -0.18825651705265045, mean p set: 0.44804567098617554
loss_pred:0.015095108188688755, decouple_loss:0.002949147019535303
The modified gen p mean: 0.44812020659446716, gen p mean: -0.18709106743335724, mean p set: 0.44869568943977356
loss_pred:0.015694497153162956, decouple_loss:0.0031689503230154514
The modified gen p mean: 0.4482358992099762, gen p mean: -0.1851322054862976, mean p set: 0.44876912236213684
loss_pred:0.015836650505661964, decouple_loss:0.0031224298290908337
Iteration: 2250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758719205856323, gen p mean: -0.19239847362041473, mean p set: 0.44816285371780396
loss_pred:0.014715495519340038, decouple_loss:0.002505565993487835
The modified gen p mean: 0.44834649562835693, gen p mean: -0.18895649909973145, mean p set: 0.44892382621765137
loss_pred:0.015335439704358578, decouple_loss:0.0027491177897900343
The modified gen p mean: 0.4485583007335663, gen p mean: -0.18763738870620728, mean p set: 0.44908908009529114
loss_pred:0.015835270285606384, decouple_loss:0.002803462790325284
2023-04-27 08:43:45 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.18483470380306244, mean p set: 0.4499112665653229
loss_pred:0.01662323623895645, decouple_loss:0.0033965064212679863
The modified gen p mean: 0.44930747151374817, gen p mean: -0.18536777794361115, mean p set: 0.4498290419578552
loss_pred:0.016143374145030975, decouple_loss:0.0032633324153721333
The modified gen p mean: 0.44821780920028687, gen p mean: -0.18229833245277405, mean p set: 0.44879910349845886
loss_pred:0.01652313768863678, decouple_loss:0.003325399477034807
WV_1_PC_1_EH_0_PS_30, loss: 0.016596335917711258, avg_mse: 0.024282321333885193
current test mse: 0.024282
Iteration: 2251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486420154571533, gen p mean: -0.1827206313610077, mean p set: 0.44922152161598206
loss_pred:0.016057198867201805, decouple_loss:0.0030829866882413626
The modified gen p mean: 0.45033684372901917, gen p mean: -0.18946672976016998, mean p set: 0.4508599638938904
loss_pred:0.015465017408132553, decouple_loss:0.0033695886377245188
The modified gen p mean: 0.4473020136356354, gen p mean: -0.19003359973430634, mean p set: 0.4478755593299866
loss_pred:0.015583747066557407, decouple_loss:0.0028372795786708593
Iteration: 2252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483635127544403, gen p mean: -0.18464145064353943, mean p set: 0.448894202709198
loss_pred:0.016271663829684258, decouple_loss:0.0028017612639814615
The modified gen p mean: 0.4480420649051666, gen p mean: -0.1860242486000061, mean p set: 0.44861847162246704
The modified gen p mean: 0.44753628969192505, gen p mean: -0.18614640831947327, mean p set: 0.4481090009212494
loss_pred:0.015173811465501785, decouple_loss:0.0027534053660929203
loss_pred:0.015589529648423195, decouple_loss:0.002700882963836193
Iteration: 2253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486134350299835, gen p mean: -0.19051465392112732, mean p set: 0.4491422176361084
loss_pred:0.0157015323638916, decouple_loss:0.00301611190661788
The modified gen p mean: 0.44711223244667053, gen p mean: -0.18924082815647125, mean p set: 0.447688490152359
The modified gen p mean: 0.44776293635368347, gen p mean: -0.19059377908706665, mean p set: 0.44833654165267944
loss_pred:0.015567601658403873, decouple_loss:0.002998588141053915
loss_pred:0.015454835258424282, decouple_loss:0.0029106272850185633
Iteration: 2254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722846150398254, gen p mean: -0.20012471079826355, mean p set: 0.4477599561214447
loss_pred:0.015008579939603806, decouple_loss:0.0029881943482905626
The modified gen p mean: 0.4472818672657013, gen p mean: -0.19566045701503754, mean p set: 0.4478580951690674
The modified gen p mean: 0.4493566155433655, gen p mean: -0.19655348360538483, mean p set: 0.4499371349811554
loss_pred:0.014995873905718327, decouple_loss:0.0028361883014440536
loss_pred:0.0155486473813653, decouple_loss:0.003492685267701745
Iteration: 2255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807249307632446, gen p mean: -0.19883926212787628, mean p set: 0.4486456513404846
loss_pred:0.016003215685486794, decouple_loss:0.003321152413263917
The modified gen p mean: 0.4491433799266815, gen p mean: -0.20184804499149323, mean p set: 0.4496676027774811The modified gen p mean: 0.44799497723579407, gen p mean: -0.19952650368213654, mean p set: 0.44857507944107056
loss_pred:0.015206052921712399, decouple_loss:0.0031716530211269855
loss_pred:0.016134940087795258, decouple_loss:0.003234900301322341
Iteration: 2256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483751356601715, gen p mean: -0.19237715005874634, mean p set: 0.44895321130752563
loss_pred:0.015137022361159325, decouple_loss:0.002908883849158883
The modified gen p mean: 0.44831207394599915, gen p mean: -0.1913740038871765, mean p set: 0.4488394856452942The modified gen p mean: 0.4494127035140991, gen p mean: -0.1919945329427719, mean p set: 0.4499906599521637
loss_pred:0.015400291420519352, decouple_loss:0.002834511687979102
loss_pred:0.015366794541478157, decouple_loss:0.0028777713887393475
Iteration: 2257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481790363788605, gen p mean: -0.19127723574638367, mean p set: 0.4487592875957489
loss_pred:0.01650257781147957, decouple_loss:0.002925362205132842
The modified gen p mean: 0.4480322599411011, gen p mean: -0.19268321990966797, mean p set: 0.44860783219337463The modified gen p mean: 0.4476652443408966, gen p mean: -0.19250300526618958, mean p set: 0.44819530844688416
loss_pred:0.015045149251818657, decouple_loss:0.0027882177382707596
loss_pred:0.01555998157709837, decouple_loss:0.002960153855383396
Iteration: 2258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815710186958313, gen p mean: -0.19067461788654327, mean p set: 0.4487335979938507
loss_pred:0.015554704703390598, decouple_loss:0.003291559172794223
The modified gen p mean: 0.4474484324455261, gen p mean: -0.19523924589157104, mean p set: 0.4480244815349579
loss_pred:0.015429113060235977, decouple_loss:0.0028777639381587505
The modified gen p mean: 0.44855833053588867, gen p mean: -0.19095371663570404, mean p set: 0.4490887224674225
loss_pred:0.015003383159637451, decouple_loss:0.002915550721809268
Iteration: 2259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794467091560364, gen p mean: -0.1952979415655136, mean p set: 0.44852176308631897
loss_pred:0.016048934310674667, decouple_loss:0.0026704510673880577
The modified gen p mean: 0.447013258934021, gen p mean: -0.19282551109790802, mean p set: 0.4475880563259125
loss_pred:0.015726136043667793, decouple_loss:0.0025060789193958044
The modified gen p mean: 0.4477970004081726, gen p mean: -0.19498424232006073, mean p set: 0.44832760095596313
loss_pred:0.01520964503288269, decouple_loss:0.002700506942346692
Iteration: 2260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831591844558716, gen p mean: -0.1889730542898178, mean p set: 0.4488913416862488
loss_pred:0.016190817579627037, decouple_loss:0.002884114161133766
The modified gen p mean: 0.44813528656959534, gen p mean: -0.18924537301063538, mean p set: 0.44871145486831665The modified gen p mean: 0.44914710521698, gen p mean: -0.19272367656230927, mean p set: 0.4496730864048004
loss_pred:0.01584514044225216, decouple_loss:0.0028001272585242987
loss_pred:0.015737423673272133, decouple_loss:0.0030599404126405716
2023-04-27 08:47:10 testing...
The modified gen p mean: 0.44821983575820923, gen p mean: -0.18356963992118835, mean p set: 0.44879910349845886
loss_pred:0.016476131975650787, decouple_loss:0.003000096417963505
The modified gen p mean: 0.44930002093315125, gen p mean: -0.18665863573551178, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.18582168221473694, mean p set: 0.4499112665653229loss_pred:0.01603374443948269, decouple_loss:0.0030170665122568607
loss_pred:0.016509076580405235, decouple_loss:0.0028883819468319416
WV_1_PC_1_EH_0_PS_30, loss: 0.016488075256347656, avg_mse: 0.024215510115027428
current test mse: 0.024216
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 2261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451283812522888, gen p mean: -0.18628504872322083, mean p set: 0.44565579295158386
loss_pred:0.015422697179019451, decouple_loss:0.0027595513965934515
The modified gen p mean: 0.4463408887386322, gen p mean: -0.18999972939491272, mean p set: 0.44691362977027893
loss_pred:0.015578190796077251, decouple_loss:0.002883603796362877
The modified gen p mean: 0.44766655564308167, gen p mean: -0.18171148002147675, mean p set: 0.4482450783252716
loss_pred:0.015368767082691193, decouple_loss:0.003013298846781254
Iteration: 2262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44602152705192566, gen p mean: -0.1830604523420334, mean p set: 0.4465474784374237
loss_pred:0.015507325530052185, decouple_loss:0.0028438230510801077
The modified gen p mean: 0.446590393781662, gen p mean: -0.17913909256458282, mean p set: 0.4471670687198639
The modified gen p mean: 0.44624635577201843, gen p mean: -0.1882084161043167, mean p set: 0.44682133197784424
loss_pred:0.01517026498913765, decouple_loss:0.0032231409568339586
loss_pred:0.0155772864818573, decouple_loss:0.002671598456799984
Iteration: 2263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466566741466522, gen p mean: -0.18747010827064514, mean p set: 0.447183758020401
loss_pred:0.015833456069231033, decouple_loss:0.0027000356931239367
The modified gen p mean: 0.446025550365448, gen p mean: -0.184135302901268, mean p set: 0.4466037154197693
The modified gen p mean: 0.4469589591026306, gen p mean: -0.18562519550323486, mean p set: 0.4475364685058594
loss_pred:0.015934234485030174, decouple_loss:0.0026339415926486254
loss_pred:0.015017152763903141, decouple_loss:0.002735511399805546
Iteration: 2264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447037011384964, gen p mean: -0.1839904487133026, mean p set: 0.44760966300964355
loss_pred:0.01569513976573944, decouple_loss:0.002843438647687435
The modified gen p mean: 0.4462931156158447, gen p mean: -0.1875206083059311, mean p set: 0.446819543838501The modified gen p mean: 0.44652581214904785, gen p mean: -0.1840304732322693, mean p set: 0.4471038281917572
loss_pred:0.015647610649466515, decouple_loss:0.0031098315957933664
loss_pred:0.01561399269849062, decouple_loss:0.0029326139483600855
Iteration: 2265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469236433506012, gen p mean: -0.18578512966632843, mean p set: 0.44749704003334045
loss_pred:0.016279462724924088, decouple_loss:0.002606005407869816
The modified gen p mean: 0.4465700685977936, gen p mean: -0.1876218616962433, mean p set: 0.4471467435359955
loss_pred:0.015081699937582016, decouple_loss:0.0024313039612025023
The modified gen p mean: 0.4468211531639099, gen p mean: -0.18631282448768616, mean p set: 0.4473506212234497
loss_pred:0.01565769501030445, decouple_loss:0.002617438090965152
Iteration: 2266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674208760261536, gen p mean: -0.1861802637577057, mean p set: 0.4473183751106262
loss_pred:0.015680892392992973, decouple_loss:0.00281229754909873
The modified gen p mean: 0.44720467925071716, gen p mean: -0.18402139842510223, mean p set: 0.4477333426475525The modified gen p mean: 0.4473104476928711, gen p mean: -0.18472746014595032, mean p set: 0.44788506627082825
loss_pred:0.0153042646124959, decouple_loss:0.0030206134542822838
loss_pred:0.016361884772777557, decouple_loss:0.002996713388711214
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465717375278473, gen p mean: -0.18871980905532837, mean p set: 0.4471500515937805
loss_pred:0.015884611755609512, decouple_loss:0.0025711948983371258
The modified gen p mean: 0.4478505551815033, gen p mean: -0.1931672990322113, mean p set: 0.44842633605003357
loss_pred:0.014941059984266758, decouple_loss:0.0027432232163846493
The modified gen p mean: 0.44648125767707825, gen p mean: -0.1904158592224121, mean p set: 0.4470020830631256
loss_pred:0.015482323244214058, decouple_loss:0.0028297603130340576
Iteration: 2268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462287127971649, gen p mean: -0.19432540237903595, mean p set: 0.44680705666542053
loss_pred:0.01564846746623516, decouple_loss:0.003150805365294218
The modified gen p mean: 0.4462686777114868, gen p mean: -0.19142819941043854, mean p set: 0.446846604347229
loss_pred:0.015443338081240654, decouple_loss:0.0030702813528478146
The modified gen p mean: 0.44676148891448975, gen p mean: -0.1913122832775116, mean p set: 0.44728413224220276
loss_pred:0.015105750411748886, decouple_loss:0.0028112211730331182
Iteration: 2269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668909907341003, gen p mean: -0.19448472559452057, mean p set: 0.4472668468952179
loss_pred:0.015035596676170826, decouple_loss:0.002688271226361394
The modified gen p mean: 0.44648322463035583, gen p mean: -0.18874132633209229, mean p set: 0.44706007838249207
loss_pred:0.014945502392947674, decouple_loss:0.002609385410323739
The modified gen p mean: 0.44656652212142944, gen p mean: -0.19354312121868134, mean p set: 0.44709545373916626
loss_pred:0.015324187465012074, decouple_loss:0.002657786477357149
Iteration: 2270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470546245574951, gen p mean: -0.18269917368888855, mean p set: 0.4476316571235657
loss_pred:0.015693994238972664, decouple_loss:0.003042656695470214
The modified gen p mean: 0.4460122585296631, gen p mean: -0.18794889748096466, mean p set: 0.44658660888671875
loss_pred:0.015538839623332024, decouple_loss:0.003041689284145832
The modified gen p mean: 0.44689980149269104, gen p mean: -0.18456865847110748, mean p set: 0.4474301338195801
loss_pred:0.015221755020320415, decouple_loss:0.0029232294764369726
2023-04-27 08:51:19 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.18434913456439972, mean p set: 0.4499112665653229
loss_pred:0.016496026888489723, decouple_loss:0.0026924361009150743
The modified gen p mean: 0.44930893182754517, gen p mean: -0.18541844189167023, mean p set: 0.4498290419578552
loss_pred:0.016093095764517784, decouple_loss:0.0028411722742021084
The modified gen p mean: 0.4482208490371704, gen p mean: -0.18213202059268951, mean p set: 0.44879910349845886
loss_pred:0.016511904075741768, decouple_loss:0.002765574026852846
WV_1_PC_1_EH_0_PS_30, loss: 0.016505328938364983, avg_mse: 0.02424684911966324
current test mse: 0.024247
Iteration: 2271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641783833503723, gen p mean: -0.18835626542568207, mean p set: 0.44699564576148987
loss_pred:0.015621074475347996, decouple_loss:0.0026593427173793316
The modified gen p mean: 0.44604504108428955, gen p mean: -0.18786366283893585, mean p set: 0.4465794563293457
loss_pred:0.015470242127776146, decouple_loss:0.0026038361247628927
The modified gen p mean: 0.44689127802848816, gen p mean: -0.18611252307891846, mean p set: 0.44746461510658264
loss_pred:0.015264555811882019, decouple_loss:0.002919214079156518
Iteration: 2272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446737140417099, gen p mean: -0.18897834420204163, mean p set: 0.44726231694221497
loss_pred:0.014954750426113605, decouple_loss:0.0028903556521981955
The modified gen p mean: 0.44834715127944946, gen p mean: -0.18843305110931396, mean p set: 0.4489297568798065
The modified gen p mean: 0.4469076693058014, gen p mean: -0.19006429612636566, mean p set: 0.44748565554618835
loss_pred:0.014581158757209778, decouple_loss:0.0028443452902138233
loss_pred:0.01493602804839611, decouple_loss:0.0029119609389454126
Iteration: 2273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471937417984009, gen p mean: -0.18629229068756104, mean p set: 0.4477251172065735
loss_pred:0.015436253510415554, decouple_loss:0.0025663035921752453
The modified gen p mean: 0.4460219442844391, gen p mean: -0.19233213365077972, mean p set: 0.44659578800201416
The modified gen p mean: 0.44646787643432617, gen p mean: -0.18573729693889618, mean p set: 0.44704607129096985
loss_pred:0.01528861653059721, decouple_loss:0.0025797539856284857
loss_pred:0.014951287768781185, decouple_loss:0.0024066916666924953
Iteration: 2274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456208646297455, gen p mean: -0.19061599671840668, mean p set: 0.4461512565612793
loss_pred:0.015171479433774948, decouple_loss:0.0031162435188889503
The modified gen p mean: 0.44633859395980835, gen p mean: -0.18747110664844513, mean p set: 0.44691479206085205
The modified gen p mean: 0.4451112449169159, gen p mean: -0.18811288475990295, mean p set: 0.4456845819950104
loss_pred:0.015804193913936615, decouple_loss:0.003140862565487623
loss_pred:0.015453147701919079, decouple_loss:0.0031159245409071445
Iteration: 2275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670215249061584, gen p mean: -0.18634961545467377, mean p set: 0.44727569818496704
loss_pred:0.015290317125618458, decouple_loss:0.002733818953856826
The modified gen p mean: 0.4470061957836151, gen p mean: -0.18592847883701324, mean p set: 0.44753265380859375The modified gen p mean: 0.4458990693092346, gen p mean: -0.18392464518547058, mean p set: 0.44647684693336487
loss_pred:0.01503414660692215, decouple_loss:0.002531948499381542
loss_pred:0.016176242381334305, decouple_loss:0.00295774033293128
Iteration: 2276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474685788154602, gen p mean: -0.1863940954208374, mean p set: 0.4480440020561218
loss_pred:0.014940970577299595, decouple_loss:0.002882871078327298
The modified gen p mean: 0.4469277262687683, gen p mean: -0.18613891303539276, mean p set: 0.4474572241306305The modified gen p mean: 0.44671961665153503, gen p mean: -0.1870904266834259, mean p set: 0.44729331135749817
loss_pred:0.015475629828870296, decouple_loss:0.0030982401221990585
loss_pred:0.014913889579474926, decouple_loss:0.002942799124866724
Iteration: 2277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44521430134773254, gen p mean: -0.18864844739437103, mean p set: 0.44578808546066284
loss_pred:0.015227771364152431, decouple_loss:0.0026176173705607653
The modified gen p mean: 0.44749078154563904, gen p mean: -0.18357115983963013, mean p set: 0.44806838035583496
loss_pred:0.014843374490737915, decouple_loss:0.0025060030166059732
The modified gen p mean: 0.44754573702812195, gen p mean: -0.1875162124633789, mean p set: 0.44807347655296326
loss_pred:0.01508492510765791, decouple_loss:0.002712312387302518
Iteration: 2278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466179311275482, gen p mean: -0.18914197385311127, mean p set: 0.44719746708869934
loss_pred:0.015273830853402615, decouple_loss:0.003053873311728239
The modified gen p mean: 0.4472993016242981, gen p mean: -0.19589699804782867, mean p set: 0.44782721996307373The modified gen p mean: 0.4467118978500366, gen p mean: -0.19377149641513824, mean p set: 0.44728177785873413
loss_pred:0.015145235694944859, decouple_loss:0.002877847757190466
loss_pred:0.015013917349278927, decouple_loss:0.0029092817567288876
Iteration: 2279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44527533650398254, gen p mean: -0.18924063444137573, mean p set: 0.445857435464859
loss_pred:0.015825098380446434, decouple_loss:0.002547972835600376
The modified gen p mean: 0.44642317295074463, gen p mean: -0.18820062279701233, mean p set: 0.4469999372959137
The modified gen p mean: 0.4467718005180359, gen p mean: -0.18748605251312256, mean p set: 0.44730156660079956
loss_pred:0.015512553043663502, decouple_loss:0.0023903476539999247
loss_pred:0.015420658513903618, decouple_loss:0.0023951770272105932
Iteration: 2280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678938388824463, gen p mean: -0.19341295957565308, mean p set: 0.4473608434200287
loss_pred:0.015481832437217236, decouple_loss:0.002895752666518092
The modified gen p mean: 0.44765588641166687, gen p mean: -0.1861708164215088, mean p set: 0.44818106293678284The modified gen p mean: 0.44596603512763977, gen p mean: -0.1885879933834076, mean p set: 0.44653791189193726
loss_pred:0.015566355548799038, decouple_loss:0.0029697304125875235
loss_pred:0.01477169618010521, decouple_loss:0.003116392297670245
2023-04-27 08:54:42 testing...
The modified gen p mean: 0.44822466373443604, gen p mean: -0.19171592593193054, mean p set: 0.44879910349845886
loss_pred:0.01659388840198517, decouple_loss:0.0024096320848912
The modified gen p mean: 0.4494309425354004, gen p mean: -0.1939045488834381, mean p set: 0.4499112665653229
loss_pred:0.016463881358504295, decouple_loss:0.0024690127465873957
The modified gen p mean: 0.44930747151374817, gen p mean: -0.19527116417884827, mean p set: 0.4498290419578552
loss_pred:0.01609933190047741, decouple_loss:0.0023732022382318974
WV_1_PC_1_EH_0_PS_30, loss: 0.016506565734744072, avg_mse: 0.024220606312155724
current test mse: 0.024221
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 2281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447115033864975, gen p mean: -0.19005686044692993, mean p set: 0.44764676690101624
loss_pred:0.015570441260933876, decouple_loss:0.0025453141424804926
The modified gen p mean: 0.44679540395736694, gen p mean: -0.20190797746181488, mean p set: 0.4473738372325897
loss_pred:0.014670063741505146, decouple_loss:0.0025913154240697622
The modified gen p mean: 0.4480220675468445, gen p mean: -0.19039593636989594, mean p set: 0.44860100746154785
loss_pred:0.014981814660131931, decouple_loss:0.002861473010852933
Iteration: 2282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697675108909607, gen p mean: -0.1963343322277069, mean p set: 0.4475066065788269
loss_pred:0.014157267287373543, decouple_loss:0.0025867531076073647
The modified gen p mean: 0.4469403624534607, gen p mean: -0.1964603066444397, mean p set: 0.44751641154289246
loss_pred:0.015099447220563889, decouple_loss:0.0023926531430333853
The modified gen p mean: 0.44642433524131775, gen p mean: -0.19867126643657684, mean p set: 0.4470026195049286
loss_pred:0.01527320221066475, decouple_loss:0.0025289461482316256
Iteration: 2283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471265375614166, gen p mean: -0.19616055488586426, mean p set: 0.44765499234199524
loss_pred:0.015520818531513214, decouple_loss:0.002702937927097082
The modified gen p mean: 0.4483083188533783, gen p mean: -0.18752457201480865, mean p set: 0.44888240098953247
loss_pred:0.01480874978005886, decouple_loss:0.0029804673977196217
The modified gen p mean: 0.44770827889442444, gen p mean: -0.19407974183559418, mean p set: 0.4482881724834442
loss_pred:0.015182064846158028, decouple_loss:0.002597631886601448
Iteration: 2284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472413659095764, gen p mean: -0.18956983089447021, mean p set: 0.4477759003639221
loss_pred:0.015019373968243599, decouple_loss:0.002726157894358039
The modified gen p mean: 0.44775259494781494, gen p mean: -0.18704310059547424, mean p set: 0.44832831621170044
loss_pred:0.01564999856054783, decouple_loss:0.0025147562846541405
The modified gen p mean: 0.4471953511238098, gen p mean: -0.18527324497699738, mean p set: 0.4477759599685669
loss_pred:0.01574440859258175, decouple_loss:0.002405046485364437
Iteration: 2285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728022813796997, gen p mean: -0.19054558873176575, mean p set: 0.44785767793655396
loss_pred:0.015642084181308746, decouple_loss:0.0026471468154340982
The modified gen p mean: 0.4480999708175659, gen p mean: -0.18155980110168457, mean p set: 0.44862768054008484The modified gen p mean: 0.446280300617218, gen p mean: -0.19791655242443085, mean p set: 0.4468553960323334
loss_pred:0.014692449942231178, decouple_loss:0.0029943580739200115
loss_pred:0.015270419418811798, decouple_loss:0.0027074702084064484
Iteration: 2286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447941392660141, gen p mean: -0.18813380599021912, mean p set: 0.4485190510749817
loss_pred:0.01552271842956543, decouple_loss:0.002846142975613475
The modified gen p mean: 0.44665905833244324, gen p mean: -0.19381599128246307, mean p set: 0.4471876323223114The modified gen p mean: 0.44684290885925293, gen p mean: -0.18553081154823303, mean p set: 0.447416752576828
loss_pred:0.014775684103369713, decouple_loss:0.0027968420181423426
loss_pred:0.015477054752409458, decouple_loss:0.002743518678471446
Iteration: 2287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630563259124756, gen p mean: -0.1851515769958496, mean p set: 0.44688504934310913
loss_pred:0.014662926085293293, decouple_loss:0.002940366044640541
The modified gen p mean: 0.4480494558811188, gen p mean: -0.18902868032455444, mean p set: 0.4486280083656311
loss_pred:0.014454948715865612, decouple_loss:0.0027398078236728907
The modified gen p mean: 0.44750091433525085, gen p mean: -0.19412896037101746, mean p set: 0.4480327367782593
loss_pred:0.01500456128269434, decouple_loss:0.002768853446468711
Iteration: 2288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711533188819885, gen p mean: -0.1867159903049469, mean p set: 0.44768741726875305
loss_pred:0.014711381867527962, decouple_loss:0.0029452249873429537
The modified gen p mean: 0.4465603828430176, gen p mean: -0.1969633847475052, mean p set: 0.44713205099105835
loss_pred:0.015078411437571049, decouple_loss:0.002982360776513815
The modified gen p mean: 0.44665026664733887, gen p mean: -0.19698134064674377, mean p set: 0.44717565178871155
loss_pred:0.01561227347701788, decouple_loss:0.0027786572463810444
Iteration: 2289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866159558296204, gen p mean: -0.19756454229354858, mean p set: 0.44923636317253113
loss_pred:0.014318957924842834, decouple_loss:0.0027601730544120073
The modified gen p mean: 0.44811439514160156, gen p mean: -0.19265076518058777, mean p set: 0.44869264960289
loss_pred:0.014867058023810387, decouple_loss:0.0028598846402019262
The modified gen p mean: 0.4472605586051941, gen p mean: -0.19787156581878662, mean p set: 0.4477875828742981
loss_pred:0.015580824576318264, decouple_loss:0.0029086449649184942
Iteration: 2290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785183668136597, gen p mean: -0.19543097913265228, mean p set: 0.44842812418937683
loss_pred:0.01505275722593069, decouple_loss:0.0026289590168744326
The modified gen p mean: 0.4470979571342468, gen p mean: -0.1959385871887207, mean p set: 0.4476735293865204The modified gen p mean: 0.44657909870147705, gen p mean: -0.19027112424373627, mean p set: 0.4471050798892975
loss_pred:0.01494617946445942, decouple_loss:0.0028698404785245657
loss_pred:0.014349577948451042, decouple_loss:0.002915279008448124
2023-04-27 08:58:40 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.19467471539974213, mean p set: 0.4499112665653229
loss_pred:0.0166387390345335, decouple_loss:0.002849266165867448
The modified gen p mean: 0.44929808378219604, gen p mean: -0.19572046399116516, mean p set: 0.4498290419578552
loss_pred:0.016246922314167023, decouple_loss:0.002805684693157673
The modified gen p mean: 0.4482249319553375, gen p mean: -0.19264155626296997, mean p set: 0.44879910349845886
loss_pred:0.016609221696853638, decouple_loss:0.0027999766170978546
WV_1_PC_1_EH_0_PS_30, loss: 0.016639210283756256, avg_mse: 0.024493394419550896
current test mse: 0.024493
Iteration: 2291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815337657928467, gen p mean: -0.19316110014915466, mean p set: 0.44872787594795227
loss_pred:0.014134611003100872, decouple_loss:0.002564327558502555
The modified gen p mean: 0.4473397135734558, gen p mean: -0.191458597779274, mean p set: 0.44786933064460754
loss_pred:0.015072815120220184, decouple_loss:0.0025940099731087685
The modified gen p mean: 0.44707489013671875, gen p mean: -0.1929541826248169, mean p set: 0.4476470947265625
loss_pred:0.014689525589346886, decouple_loss:0.0027643681969493628
Iteration: 2292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464821219444275, gen p mean: -0.19643859565258026, mean p set: 0.4470112919807434
loss_pred:0.014300402253866196, decouple_loss:0.0026179240085184574
The modified gen p mean: 0.44650769233703613, gen p mean: -0.19652116298675537, mean p set: 0.44708362221717834
The modified gen p mean: 0.4474390745162964, gen p mean: -0.1948256939649582, mean p set: 0.44801655411720276
loss_pred:0.014962362125515938, decouple_loss:0.002598054241389036
loss_pred:0.014009854756295681, decouple_loss:0.0029332637786865234
Iteration: 2293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765180349349976, gen p mean: -0.1913282871246338, mean p set: 0.44817930459976196
loss_pred:0.015103680081665516, decouple_loss:0.002665101084858179
The modified gen p mean: 0.4473010003566742, gen p mean: -0.1969984620809555, mean p set: 0.4478755593299866
The modified gen p mean: 0.4471089541912079, gen p mean: -0.1912631392478943, mean p set: 0.4476839005947113
loss_pred:0.015314949676394463, decouple_loss:0.002771650440990925
loss_pred:0.013902644626796246, decouple_loss:0.0026659888681024313
Iteration: 2294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468667209148407, gen p mean: -0.19104959070682526, mean p set: 0.44739529490470886
loss_pred:0.014712086878716946, decouple_loss:0.002492389176040888
The modified gen p mean: 0.44737508893013, gen p mean: -0.19252285361289978, mean p set: 0.4479525089263916
The modified gen p mean: 0.4471004605293274, gen p mean: -0.18540515005588531, mean p set: 0.4476739168167114
loss_pred:0.014842064119875431, decouple_loss:0.002566663781180978
loss_pred:0.01539251022040844, decouple_loss:0.002627696143463254
Iteration: 2295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468598961830139, gen p mean: -0.19766518473625183, mean p set: 0.4474334716796875
loss_pred:0.01521435659378767, decouple_loss:0.0025589230936020613
The modified gen p mean: 0.4465816915035248, gen p mean: -0.19638238847255707, mean p set: 0.44715800881385803The modified gen p mean: 0.4468058943748474, gen p mean: -0.19353127479553223, mean p set: 0.4473371207714081
loss_pred:0.0140264593064785, decouple_loss:0.003121902933344245
loss_pred:0.0141929155215621, decouple_loss:0.003057135036215186
Iteration: 2296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475758671760559, gen p mean: -0.1908487230539322, mean p set: 0.44814640283584595
loss_pred:0.01548364944756031, decouple_loss:0.0028365361504256725
The modified gen p mean: 0.4481154978275299, gen p mean: -0.18947070837020874, mean p set: 0.4486927390098572
loss_pred:0.014531000517308712, decouple_loss:0.003039732575416565
The modified gen p mean: 0.4467422068119049, gen p mean: -0.19894415140151978, mean p set: 0.4472716748714447
loss_pred:0.015837697312235832, decouple_loss:0.002816008636727929
Iteration: 2297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706445932388306, gen p mean: -0.19225706160068512, mean p set: 0.44764021039009094
loss_pred:0.015567177906632423, decouple_loss:0.002534242579713464
The modified gen p mean: 0.446054071187973, gen p mean: -0.19520075619220734, mean p set: 0.44662564992904663
loss_pred:0.01564471796154976, decouple_loss:0.002622907981276512
The modified gen p mean: 0.44679704308509827, gen p mean: -0.18722184002399445, mean p set: 0.44732168316841125
loss_pred:0.014494890347123146, decouple_loss:0.00270963367074728
Iteration: 2298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459769129753113, gen p mean: -0.18815287947654724, mean p set: 0.4465501010417938
loss_pred:0.015139922499656677, decouple_loss:0.003121491288766265
The modified gen p mean: 0.446002334356308, gen p mean: -0.1808563470840454, mean p set: 0.4465774595737457
loss_pred:0.015758207067847252, decouple_loss:0.00293204584158957
The modified gen p mean: 0.44813230633735657, gen p mean: -0.1825416386127472, mean p set: 0.4486611485481262
loss_pred:0.015411772765219212, decouple_loss:0.0030056810937821865
Iteration: 2299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718116521835327, gen p mean: -0.17478978633880615, mean p set: 0.4477570950984955
loss_pred:0.01461105141788721, decouple_loss:0.002676391741260886
The modified gen p mean: 0.4465310871601105, gen p mean: -0.18015286326408386, mean p set: 0.4471038579940796
loss_pred:0.01606081984937191, decouple_loss:0.0024008338805288076
The modified gen p mean: 0.44657909870147705, gen p mean: -0.19042758643627167, mean p set: 0.4471111297607422
loss_pred:0.014687716029584408, decouple_loss:0.0025017980951815844
Iteration: 2300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722244143486023, gen p mean: -0.18159189820289612, mean p set: 0.4477977156639099
loss_pred:0.014711725525557995, decouple_loss:0.0028912811540067196
The modified gen p mean: 0.447356641292572, gen p mean: -0.18804864585399628, mean p set: 0.447934627532959
loss_pred:0.015347981825470924, decouple_loss:0.0026457568164914846
The modified gen p mean: 0.44691038131713867, gen p mean: -0.1904401183128357, mean p set: 0.44743743538856506
loss_pred:0.015149430371820927, decouple_loss:0.002842652378603816
2023-04-27 09:02:04 testing...
The modified gen p mean: 0.4482199549674988, gen p mean: -0.18225103616714478, mean p set: 0.44879910349845886
loss_pred:0.016614718362689018, decouple_loss:0.0028201923705637455
The modified gen p mean: 0.4494309425354004, gen p mean: -0.18470366299152374, mean p set: 0.4499112665653229
loss_pred:0.01656269282102585, decouple_loss:0.002751313615590334
The modified gen p mean: 0.44930386543273926, gen p mean: -0.18549010157585144, mean p set: 0.4498290419578552
loss_pred:0.0162817295640707, decouple_loss:0.002944192849099636
WV_1_PC_1_EH_0_PS_30, loss: 0.016628310084342957, avg_mse: 0.02449384704232216
current test mse: 0.024494
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 2301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972774386405945, gen p mean: -0.18528655171394348, mean p set: 0.45026013255119324
loss_pred:0.01576971635222435, decouple_loss:0.0025616104248911142
The modified gen p mean: 0.44939273595809937, gen p mean: -0.18776585161685944, mean p set: 0.44996631145477295
loss_pred:0.015121955424547195, decouple_loss:0.0026350445114076138
The modified gen p mean: 0.4478747248649597, gen p mean: -0.18199698626995087, mean p set: 0.44845327734947205
loss_pred:0.014834544621407986, decouple_loss:0.00252911145798862
Iteration: 2302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489593207836151, gen p mean: -0.18715770542621613, mean p set: 0.44949063658714294
loss_pred:0.01527303084731102, decouple_loss:0.0030307876877486706
The modified gen p mean: 0.44957801699638367, gen p mean: -0.18237799406051636, mean p set: 0.4501534700393677
loss_pred:0.01545642875134945, decouple_loss:0.0030988669022917747
The modified gen p mean: 0.4491053521633148, gen p mean: -0.18339501321315765, mean p set: 0.4496765732765198
loss_pred:0.01579185016453266, decouple_loss:0.002834620652720332
Iteration: 2303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488134980201721, gen p mean: -0.18339861929416656, mean p set: 0.44934147596359253
loss_pred:0.015445223078131676, decouple_loss:0.00277890358120203
The modified gen p mean: 0.449163556098938, gen p mean: -0.1849338412284851, mean p set: 0.4497471749782562
loss_pred:0.014579981565475464, decouple_loss:0.0024779089726507664
The modified gen p mean: 0.44933709502220154, gen p mean: -0.1863096058368683, mean p set: 0.44991418719291687
loss_pred:0.015157900750637054, decouple_loss:0.002578640589490533
Iteration: 2304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494248032569885, gen p mean: -0.18392245471477509, mean p set: 0.44995465874671936
loss_pred:0.015276603400707245, decouple_loss:0.003411427605897188
The modified gen p mean: 0.4500928223133087, gen p mean: -0.1849374920129776, mean p set: 0.45066767930984497
loss_pred:0.015570959076285362, decouple_loss:0.0032624739687889814
The modified gen p mean: 0.4507136642932892, gen p mean: -0.18578575551509857, mean p set: 0.45129016041755676
loss_pred:0.015345740132033825, decouple_loss:0.0027121317107230425
Iteration: 2305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45029783248901367, gen p mean: -0.18554465472698212, mean p set: 0.4508661925792694
loss_pred:0.015076150186359882, decouple_loss:0.002998064737766981
The modified gen p mean: 0.4500774145126343, gen p mean: -0.1864897757768631, mean p set: 0.4506046175956726The modified gen p mean: 0.45056721568107605, gen p mean: -0.18857423961162567, mean p set: 0.451143354177475
loss_pred:0.015398481860756874, decouple_loss:0.002795672742649913
loss_pred:0.015602556988596916, decouple_loss:0.0026226595509797335
Iteration: 2306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001059770584106, gen p mean: -0.18521058559417725, mean p set: 0.4505905210971832
loss_pred:0.015483183786273003, decouple_loss:0.0028280627448111773
The modified gen p mean: 0.4480133056640625, gen p mean: -0.1879805475473404, mean p set: 0.4485381245613098The modified gen p mean: 0.44918978214263916, gen p mean: -0.19016632437705994, mean p set: 0.4497673809528351
loss_pred:0.015752147883176804, decouple_loss:0.0026285236235708
loss_pred:0.016393326222896576, decouple_loss:0.002955591306090355
Iteration: 2307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44917571544647217, gen p mean: -0.17677010595798492, mean p set: 0.4497552812099457
loss_pred:0.015143648721277714, decouple_loss:0.0034564752131700516
The modified gen p mean: 0.4488106667995453, gen p mean: -0.1809953898191452, mean p set: 0.4493391215801239The modified gen p mean: 0.44902074337005615, gen p mean: -0.18135137856006622, mean p set: 0.44959837198257446
loss_pred:0.015739714726805687, decouple_loss:0.0032954500056803226
loss_pred:0.015324432402849197, decouple_loss:0.003441478591412306
Iteration: 2308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990307092666626, gen p mean: -0.18651682138442993, mean p set: 0.4504837691783905
loss_pred:0.015260987915098667, decouple_loss:0.0026892174500972033
The modified gen p mean: 0.4496016502380371, gen p mean: -0.18527516722679138, mean p set: 0.45013123750686646The modified gen p mean: 0.4496005177497864, gen p mean: -0.19140569865703583, mean p set: 0.45017269253730774
loss_pred:0.015296585857868195, decouple_loss:0.002625563181936741
loss_pred:0.015219945460557938, decouple_loss:0.0027367835864424706
Iteration: 2309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488464593887329, gen p mean: -0.19598641991615295, mean p set: 0.4494198262691498
loss_pred:0.015928082168102264, decouple_loss:0.003154089907184243
The modified gen p mean: 0.4493151307106018, gen p mean: -0.19949385523796082, mean p set: 0.4498424530029297The modified gen p mean: 0.44756683707237244, gen p mean: -0.19548209011554718, mean p set: 0.44813892245292664
loss_pred:0.016280649229884148, decouple_loss:0.0033659571781754494
loss_pred:0.01561667863279581, decouple_loss:0.003187821712344885
Iteration: 2310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449192613363266, gen p mean: -0.19387304782867432, mean p set: 0.4497663974761963
loss_pred:0.014929250814020634, decouple_loss:0.003023781580850482
The modified gen p mean: 0.44913533329963684, gen p mean: -0.19359774887561798, mean p set: 0.4496645927429199The modified gen p mean: 0.44909945130348206, gen p mean: -0.19757579267024994, mean p set: 0.44967731833457947
loss_pred:0.01504717580974102, decouple_loss:0.002960615325719118
loss_pred:0.015108343213796616, decouple_loss:0.003129034535959363
2023-04-27 09:06:07 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.1924503743648529, mean p set: 0.4499112665653229
loss_pred:0.016608331352472305, decouple_loss:0.003361419076099992
The modified gen p mean: 0.44930219650268555, gen p mean: -0.1933804303407669, mean p set: 0.4498290419578552
loss_pred:0.01616344414651394, decouple_loss:0.0034814223181456327
The modified gen p mean: 0.4482220411300659, gen p mean: -0.18961112201213837, mean p set: 0.44879910349845886
loss_pred:0.016628798097372055, decouple_loss:0.003315799869596958
WV_1_PC_1_EH_0_PS_30, loss: 0.01663617044687271, avg_mse: 0.024415483698248863
current test mse: 0.024415
Iteration: 2311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488219916820526, gen p mean: -0.18995049595832825, mean p set: 0.4493984878063202
loss_pred:0.015708258375525475, decouple_loss:0.002983641345053911
The modified gen p mean: 0.44960957765579224, gen p mean: -0.19316351413726807, mean p set: 0.45013657212257385
loss_pred:0.014936125837266445, decouple_loss:0.003050892148166895
The modified gen p mean: 0.4491046667098999, gen p mean: -0.193961501121521, mean p set: 0.4496835172176361
loss_pred:0.015437174588441849, decouple_loss:0.0035552019253373146
Iteration: 2312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44964179396629333, gen p mean: -0.18706317245960236, mean p set: 0.4501734673976898
loss_pred:0.015094867907464504, decouple_loss:0.0032783462665975094
The modified gen p mean: 0.44873499870300293, gen p mean: -0.1854606568813324, mean p set: 0.4493071436882019
The modified gen p mean: 0.4479295611381531, gen p mean: -0.18839776515960693, mean p set: 0.44850999116897583
loss_pred:0.016047963872551918, decouple_loss:0.002980004297569394
loss_pred:0.015392424538731575, decouple_loss:0.0029675401747226715
Iteration: 2313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085886120796204, gen p mean: -0.18247090280056, mean p set: 0.45138660073280334
loss_pred:0.014981729909777641, decouple_loss:0.0036684393417090178
The modified gen p mean: 0.4483684003353119, gen p mean: -0.1883995085954666, mean p set: 0.4489458501338959
The modified gen p mean: 0.4491400718688965, gen p mean: -0.18361151218414307, mean p set: 0.4497183561325073
loss_pred:0.01514451950788498, decouple_loss:0.0033417847007513046
loss_pred:0.01560022123157978, decouple_loss:0.003199766855686903
Iteration: 2314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009320974349976, gen p mean: -0.1809345930814743, mean p set: 0.4506189823150635
loss_pred:0.015017559751868248, decouple_loss:0.0029792883433401585
The modified gen p mean: 0.45012953877449036, gen p mean: -0.17940981686115265, mean p set: 0.45070981979370117
The modified gen p mean: 0.450200617313385, gen p mean: -0.1764119416475296, mean p set: 0.4507763385772705
loss_pred:0.01480932254344225, decouple_loss:0.0026988331228494644
loss_pred:0.014731476083397865, decouple_loss:0.002836968982592225
Iteration: 2315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841673970222473, gen p mean: -0.18561147153377533, mean p set: 0.448993444442749
loss_pred:0.01543965470045805, decouple_loss:0.0037827829364687204
The modified gen p mean: 0.4507346451282501, gen p mean: -0.18211950361728668, mean p set: 0.45130491256713867The modified gen p mean: 0.4497898817062378, gen p mean: -0.1874888688325882, mean p set: 0.4503171145915985
loss_pred:0.014968443661928177, decouple_loss:0.003063562558963895
loss_pred:0.01503941509872675, decouple_loss:0.003911897074431181
Iteration: 2316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482731819152832, gen p mean: -0.18953387439250946, mean p set: 0.44884949922561646
loss_pred:0.015567232854664326, decouple_loss:0.00252363970503211
The modified gen p mean: 0.44853660464286804, gen p mean: -0.18685689568519592, mean p set: 0.44906798005104065The modified gen p mean: 0.44794344902038574, gen p mean: -0.18619264662265778, mean p set: 0.44851261377334595
loss_pred:0.014457697980105877, decouple_loss:0.0026347909588366747
loss_pred:0.015205951407551765, decouple_loss:0.0028466149233281612
Iteration: 2317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481276273727417, gen p mean: -0.18928632140159607, mean p set: 0.44870686531066895
loss_pred:0.016346383839845657, decouple_loss:0.002873902441933751
The modified gen p mean: 0.44869041442871094, gen p mean: -0.1949966698884964, mean p set: 0.449221134185791The modified gen p mean: 0.4482939541339874, gen p mean: -0.18382073938846588, mean p set: 0.4488740861415863
loss_pred:0.015358863398432732, decouple_loss:0.0032873540185391903
loss_pred:0.015027324669063091, decouple_loss:0.003343884600326419
Iteration: 2318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969239830970764, gen p mean: -0.19096720218658447, mean p set: 0.4502677023410797
loss_pred:0.015180404298007488, decouple_loss:0.0027799922972917557
The modified gen p mean: 0.44893190264701843, gen p mean: -0.18732494115829468, mean p set: 0.4495089054107666
loss_pred:0.015086166560649872, decouple_loss:0.002727056387811899
The modified gen p mean: 0.4489912688732147, gen p mean: -0.19137996435165405, mean p set: 0.4495182931423187
loss_pred:0.014892924576997757, decouple_loss:0.0027523639146238565
Iteration: 2319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44917163252830505, gen p mean: -0.18691958487033844, mean p set: 0.4497511684894562
loss_pred:0.015579677186906338, decouple_loss:0.003701293608173728
The modified gen p mean: 0.4482792615890503, gen p mean: -0.1846599280834198, mean p set: 0.44885316491127014
loss_pred:0.015448509715497494, decouple_loss:0.0029870669823139906
The modified gen p mean: 0.450537770986557, gen p mean: -0.1846769005060196, mean p set: 0.45106619596481323
loss_pred:0.014515791088342667, decouple_loss:0.0032393469009548426
Iteration: 2320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499741494655609, gen p mean: -0.18392227590084076, mean p set: 0.4505513906478882
loss_pred:0.014679805375635624, decouple_loss:0.0027480488643050194
The modified gen p mean: 0.4485837519168854, gen p mean: -0.1858130842447281, mean p set: 0.4491119980812073The modified gen p mean: 0.44850805401802063, gen p mean: -0.186297208070755, mean p set: 0.44908788800239563
loss_pred:0.015920214354991913, decouple_loss:0.0027370487805455923
loss_pred:0.015826093032956123, decouple_loss:0.002813542727380991
2023-04-27 09:09:32 testing...
The modified gen p mean: 0.44821810722351074, gen p mean: -0.18525412678718567, mean p set: 0.44879910349845886
loss_pred:0.016603976488113403, decouple_loss:0.003370727179571986
The modified gen p mean: 0.4494309425354004, gen p mean: -0.1881743222475052, mean p set: 0.4499112665653229
loss_pred:0.01662645861506462, decouple_loss:0.003374991239979863
The modified gen p mean: 0.449298620223999, gen p mean: -0.18909965455532074, mean p set: 0.4498290419578552
loss_pred:0.01620631106197834, decouple_loss:0.0033280823845416307
WV_1_PC_1_EH_0_PS_30, loss: 0.016646813601255417, avg_mse: 0.02443346381187439
current test mse: 0.024433
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 2321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454135596752167, gen p mean: -0.18881288170814514, mean p set: 0.44594070315361023
loss_pred:0.015138726681470871, decouple_loss:0.0028226401191204786
The modified gen p mean: 0.4467107057571411, gen p mean: -0.19179461896419525, mean p set: 0.4472857117652893
loss_pred:0.015362712554633617, decouple_loss:0.003114611841738224
The modified gen p mean: 0.4457630515098572, gen p mean: -0.19099663197994232, mean p set: 0.4463326036930084
loss_pred:0.014835837297141552, decouple_loss:0.0029005473479628563
Iteration: 2322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719046354293823, gen p mean: -0.18909013271331787, mean p set: 0.44771912693977356
loss_pred:0.01540087629109621, decouple_loss:0.0024587090592831373
The modified gen p mean: 0.4467967748641968, gen p mean: -0.18746575713157654, mean p set: 0.4473719894886017
loss_pred:0.015841420739889145, decouple_loss:0.0024539262522011995
The modified gen p mean: 0.4470798969268799, gen p mean: -0.1861400604248047, mean p set: 0.44765836000442505
loss_pred:0.016204118728637695, decouple_loss:0.0025509747210890055
Iteration: 2323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478187561035156, gen p mean: -0.19007077813148499, mean p set: 0.44834670424461365
loss_pred:0.015610454604029655, decouple_loss:0.0029603273142129183
The modified gen p mean: 0.4470095634460449, gen p mean: -0.1958034187555313, mean p set: 0.4475838840007782
loss_pred:0.015316303819417953, decouple_loss:0.0038585432339459658
The modified gen p mean: 0.4475767910480499, gen p mean: -0.19302129745483398, mean p set: 0.44815176725387573
loss_pred:0.01531294547021389, decouple_loss:0.0032499758526682854
Iteration: 2324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822365045547485, gen p mean: -0.1929190754890442, mean p set: 0.44875115156173706
loss_pred:0.01593048870563507, decouple_loss:0.002608148381114006
The modified gen p mean: 0.4469216465950012, gen p mean: -0.1932676136493683, mean p set: 0.44750016927719116
loss_pred:0.01687374897301197, decouple_loss:0.0026709039229899645
The modified gen p mean: 0.4468979239463806, gen p mean: -0.19740527868270874, mean p set: 0.4474697411060333
loss_pred:0.015041666105389595, decouple_loss:0.0028376851696521044
Iteration: 2325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776803255081177, gen p mean: -0.19683614373207092, mean p set: 0.44834285974502563
loss_pred:0.01562458649277687, decouple_loss:0.003526324173435569
The modified gen p mean: 0.44640931487083435, gen p mean: -0.19673267006874084, mean p set: 0.4469849467277527The modified gen p mean: 0.4483507573604584, gen p mean: -0.19535352289676666, mean p set: 0.44887736439704895
loss_pred:0.015100989490747452, decouple_loss:0.003391633275896311loss_pred:0.01565830036997795, decouple_loss:0.0038284119218587875
Iteration: 2326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758176803588867, gen p mean: -0.1982208788394928, mean p set: 0.4481556713581085
loss_pred:0.015271454118192196, decouple_loss:0.0030097533017396927
The modified gen p mean: 0.44795259833335876, gen p mean: -0.1970188021659851, mean p set: 0.4485260546207428
loss_pred:0.015400995500385761, decouple_loss:0.0029557053931057453
The modified gen p mean: 0.4454760253429413, gen p mean: -0.1933971494436264, mean p set: 0.4460061490535736
loss_pred:0.015399831347167492, decouple_loss:0.003154840087518096
Iteration: 2327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728052616119385, gen p mean: -0.19787365198135376, mean p set: 0.44785624742507935
loss_pred:0.014733297750353813, decouple_loss:0.003350726794451475
The modified gen p mean: 0.44651690125465393, gen p mean: -0.19619645178318024, mean p set: 0.44709280133247375
loss_pred:0.014954651705920696, decouple_loss:0.0036500846035778522
The modified gen p mean: 0.44911807775497437, gen p mean: -0.19815552234649658, mean p set: 0.44964826107025146
loss_pred:0.015296880155801773, decouple_loss:0.0029052167665213346
Iteration: 2328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463164210319519, gen p mean: -0.19956474006175995, mean p set: 0.4468908905982971
loss_pred:0.014994877390563488, decouple_loss:0.003307862440124154
The modified gen p mean: 0.44659459590911865, gen p mean: -0.1954042762517929, mean p set: 0.4471677839756012
loss_pred:0.014936616644263268, decouple_loss:0.0030822858680039644
The modified gen p mean: 0.447435587644577, gen p mean: -0.20028503239154816, mean p set: 0.447966605424881
loss_pred:0.014971747994422913, decouple_loss:0.003126592840999365
Iteration: 2329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473031759262085, gen p mean: -0.2010854035615921, mean p set: 0.44787725806236267
loss_pred:0.01596478372812271, decouple_loss:0.0034333732910454273
The modified gen p mean: 0.4468700885772705, gen p mean: -0.20487281680107117, mean p set: 0.44739779829978943The modified gen p mean: 0.44743701815605164, gen p mean: -0.19928641617298126, mean p set: 0.4480137526988983
loss_pred:0.01536187157034874, decouple_loss:0.0030288277193903923
loss_pred:0.015073653310537338, decouple_loss:0.0031086113303899765
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687533378601074, gen p mean: -0.2010483741760254, mean p set: 0.44745346903800964
loss_pred:0.015880441293120384, decouple_loss:0.002730968175455928
The modified gen p mean: 0.44633984565734863, gen p mean: -0.20335081219673157, mean p set: 0.44692057371139526
loss_pred:0.015180746093392372, decouple_loss:0.0029965166468173265
The modified gen p mean: 0.4475257396697998, gen p mean: -0.2070758193731308, mean p set: 0.448056697845459
loss_pred:0.014992657117545605, decouple_loss:0.0029556024819612503
2023-04-27 09:13:43 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.20238018035888672, mean p set: 0.4499112665653229
loss_pred:0.01656874269247055, decouple_loss:0.0026410033460706472
The modified gen p mean: 0.44930070638656616, gen p mean: -0.20377467572689056, mean p set: 0.4498290419578552
loss_pred:0.016062363982200623, decouple_loss:0.002762313699349761
The modified gen p mean: 0.4482225179672241, gen p mean: -0.19971589744091034, mean p set: 0.44879910349845886
loss_pred:0.016524553298950195, decouple_loss:0.0026491389144212008
WV_1_PC_1_EH_0_PS_30, loss: 0.01651942729949951, avg_mse: 0.024415170773863792
current test mse: 0.024415
Iteration: 2331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868016242980957, gen p mean: -0.2056448608636856, mean p set: 0.4492546021938324
loss_pred:0.015254741534590721, decouple_loss:0.00283792638219893
The modified gen p mean: 0.4477649927139282, gen p mean: -0.20691722631454468, mean p set: 0.44829845428466797
loss_pred:0.014588633552193642, decouple_loss:0.002605991903692484
The modified gen p mean: 0.4472474455833435, gen p mean: -0.20284239947795868, mean p set: 0.44783279299736023
loss_pred:0.015255443751811981, decouple_loss:0.002734319306910038
Iteration: 2332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491994380950928, gen p mean: -0.20178240537643433, mean p set: 0.44973060488700867
loss_pred:0.015245508402585983, decouple_loss:0.002803025534376502
The modified gen p mean: 0.4475879967212677, gen p mean: -0.2021588385105133, mean p set: 0.4481663107872009
The modified gen p mean: 0.44621267914772034, gen p mean: -0.19776830077171326, mean p set: 0.44678959250450134
loss_pred:0.015810005366802216, decouple_loss:0.0023894086480140686
loss_pred:0.01497459877282381, decouple_loss:0.002711583161726594
Iteration: 2333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703519344329834, gen p mean: -0.20227009057998657, mean p set: 0.4475601017475128
loss_pred:0.015418576076626778, decouple_loss:0.0026547550223767757
The modified gen p mean: 0.4472704231739044, gen p mean: -0.20290899276733398, mean p set: 0.4478478729724884
The modified gen p mean: 0.4465545117855072, gen p mean: -0.20410582423210144, mean p set: 0.4471312463283539
loss_pred:0.014723703265190125, decouple_loss:0.0028619058430194855
loss_pred:0.014990857802331448, decouple_loss:0.002742225071415305
Iteration: 2334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465027451515198, gen p mean: -0.2007221132516861, mean p set: 0.4470318555831909
loss_pred:0.015210146084427834, decouple_loss:0.002358891535550356
The modified gen p mean: 0.4463634490966797, gen p mean: -0.20371034741401672, mean p set: 0.44693562388420105
The modified gen p mean: 0.44806143641471863, gen p mean: -0.19830390810966492, mean p set: 0.44864004850387573
loss_pred:0.014968645758926868, decouple_loss:0.0024090195074677467
loss_pred:0.01577053777873516, decouple_loss:0.0028394863475114107
Iteration: 2335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466504156589508, gen p mean: -0.1983683854341507, mean p set: 0.4472208023071289
loss_pred:0.015086446888744831, decouple_loss:0.0030595704447478056
The modified gen p mean: 0.4469797909259796, gen p mean: -0.19943615794181824, mean p set: 0.4475100040435791The modified gen p mean: 0.44719967246055603, gen p mean: -0.2051689475774765, mean p set: 0.44777220487594604
loss_pred:0.01462661661207676, decouple_loss:0.0024966979399323463
loss_pred:0.015083068050444126, decouple_loss:0.002457757480442524
Iteration: 2336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641977548599243, gen p mean: -0.19695106148719788, mean p set: 0.4469926357269287
loss_pred:0.015361255966126919, decouple_loss:0.0025688353925943375
The modified gen p mean: 0.4465894401073456, gen p mean: -0.2009345442056656, mean p set: 0.4471190571784973The modified gen p mean: 0.4470447599887848, gen p mean: -0.20043060183525085, mean p set: 0.44762295484542847
loss_pred:0.015031876973807812, decouple_loss:0.002666381886228919
loss_pred:0.014725318178534508, decouple_loss:0.002562824869528413
Iteration: 2337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44543153047561646, gen p mean: -0.19812019169330597, mean p set: 0.44600710272789
loss_pred:0.015384003520011902, decouple_loss:0.002592772478237748
The modified gen p mean: 0.4473349452018738, gen p mean: -0.20225690305233002, mean p set: 0.44786328077316284The modified gen p mean: 0.44604000449180603, gen p mean: -0.19787649810314178, mean p set: 0.4466158449649811
loss_pred:0.014815251342952251, decouple_loss:0.003458009334281087
loss_pred:0.01439331192523241, decouple_loss:0.0028800820000469685
Iteration: 2338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478730857372284, gen p mean: -0.2023196667432785, mean p set: 0.44845691323280334
loss_pred:0.015364769846200943, decouple_loss:0.0029348901007324457
The modified gen p mean: 0.44818115234375, gen p mean: -0.2000846415758133, mean p set: 0.44875821471214294
loss_pred:0.0157318077981472, decouple_loss:0.0031583739910274744
The modified gen p mean: 0.4483913779258728, gen p mean: -0.19964230060577393, mean p set: 0.44892388582229614
loss_pred:0.015865446999669075, decouple_loss:0.0033623541239649057
Iteration: 2339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605451822280884, gen p mean: -0.20038571953773499, mean p set: 0.4466286599636078
loss_pred:0.015158909372985363, decouple_loss:0.0028883335180580616
The modified gen p mean: 0.4466582238674164, gen p mean: -0.20484110713005066, mean p set: 0.44718244671821594The modified gen p mean: 0.44694387912750244, gen p mean: -0.19878916442394257, mean p set: 0.447516530752182
loss_pred:0.015676265582442284, decouple_loss:0.002742630196735263
loss_pred:0.014903000555932522, decouple_loss:0.002713686553761363
Iteration: 2340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682860374450684, gen p mean: -0.20449386537075043, mean p set: 0.44740432500839233
loss_pred:0.014968370087444782, decouple_loss:0.002396105322986841
The modified gen p mean: 0.44628652930259705, gen p mean: -0.20165710151195526, mean p set: 0.44681257009506226The modified gen p mean: 0.44645220041275024, gen p mean: -0.2024461030960083, mean p set: 0.44703078269958496
loss_pred:0.015053949318826199, decouple_loss:0.002948838286101818
loss_pred:0.014751977287232876, decouple_loss:0.002881732303649187
2023-04-27 09:17:08 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.20008666813373566, mean p set: 0.4499112665653229
loss_pred:0.016455762088298798, decouple_loss:0.003235426964238286
The modified gen p mean: 0.44930076599121094, gen p mean: -0.20140357315540314, mean p set: 0.4498290419578552
loss_pred:0.016067223623394966, decouple_loss:0.002909033792093396
The modified gen p mean: 0.4482242166996002, gen p mean: -0.19744235277175903, mean p set: 0.44879910349845886
loss_pred:0.016482405364513397, decouple_loss:0.0030424429569393396
WV_1_PC_1_EH_0_PS_30, loss: 0.016488246619701385, avg_mse: 0.02429758943617344
current test mse: 0.024298
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 2341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493362605571747, gen p mean: -0.20431631803512573, mean p set: 0.4498666524887085
loss_pred:0.01623728685081005, decouple_loss:0.0031656960491091013
The modified gen p mean: 0.44854265451431274, gen p mean: -0.19855131208896637, mean p set: 0.44911903142929077
loss_pred:0.0158791895955801, decouple_loss:0.003455973928794265
The modified gen p mean: 0.44842833280563354, gen p mean: -0.1975199282169342, mean p set: 0.4490050673484802
loss_pred:0.016339613124728203, decouple_loss:0.0033595808781683445
Iteration: 2342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932785630226135, gen p mean: -0.2046957165002823, mean p set: 0.4498598277568817
loss_pred:0.015399085357785225, decouple_loss:0.0024211867712438107
The modified gen p mean: 0.44818246364593506, gen p mean: -0.19888423383235931, mean p set: 0.4487597644329071
The modified gen p mean: 0.44803693890571594, gen p mean: -0.1989903748035431, mean p set: 0.4486114978790283
loss_pred:0.015872707590460777, decouple_loss:0.002552720019593835
loss_pred:0.016503188759088516, decouple_loss:0.002895066514611244
Iteration: 2343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481104910373688, gen p mean: -0.19119830429553986, mean p set: 0.4486406445503235
loss_pred:0.016490986570715904, decouple_loss:0.0027820663526654243
The modified gen p mean: 0.4479184150695801, gen p mean: -0.19168177247047424, mean p set: 0.448492169380188
The modified gen p mean: 0.44886136054992676, gen p mean: -0.2034965604543686, mean p set: 0.4494372606277466
loss_pred:0.01616186834871769, decouple_loss:0.0028555875178426504
loss_pred:0.015513784252107143, decouple_loss:0.0030652061104774475
Iteration: 2344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478347897529602, gen p mean: -0.20083627104759216, mean p set: 0.44836896657943726
loss_pred:0.016410725191235542, decouple_loss:0.002365955151617527
The modified gen p mean: 0.4494338631629944, gen p mean: -0.20904643833637238, mean p set: 0.4500062167644501
The modified gen p mean: 0.44932207465171814, gen p mean: -0.20806671679019928, mean p set: 0.4498986005783081
loss_pred:0.015728097409009933, decouple_loss:0.0029757514130324125
loss_pred:0.015980025753378868, decouple_loss:0.002705526305362582
Iteration: 2345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44887906312942505, gen p mean: -0.2071392685174942, mean p set: 0.4494534134864807
loss_pred:0.015286552719771862, decouple_loss:0.002781566930934787
The modified gen p mean: 0.4474971294403076, gen p mean: -0.19654279947280884, mean p set: 0.4480302929878235The modified gen p mean: 0.44906219840049744, gen p mean: -0.2092767059803009, mean p set: 0.4496401250362396
loss_pred:0.01587996818125248, decouple_loss:0.002670695772394538
loss_pred:0.01597190834581852, decouple_loss:0.0026420734357088804
Iteration: 2346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481090009212494, gen p mean: -0.2019653022289276, mean p set: 0.4486786425113678
loss_pred:0.016474654898047447, decouple_loss:0.002680583391338587
The modified gen p mean: 0.44888144731521606, gen p mean: -0.2060585618019104, mean p set: 0.4494089186191559The modified gen p mean: 0.4488527774810791, gen p mean: -0.20916692912578583, mean p set: 0.44942986965179443
loss_pred:0.015626173466444016, decouple_loss:0.0024020210839807987
loss_pred:0.015658080577850342, decouple_loss:0.002447262406349182
Iteration: 2347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487648606300354, gen p mean: -0.20331792533397675, mean p set: 0.44934189319610596
loss_pred:0.01574607938528061, decouple_loss:0.002874290570616722
The modified gen p mean: 0.4489402174949646, gen p mean: -0.2019713670015335, mean p set: 0.44951876997947693The modified gen p mean: 0.4485725462436676, gen p mean: -0.20742803812026978, mean p set: 0.4491029977798462
loss_pred:0.01555274985730648, decouple_loss:0.002611622679978609
loss_pred:0.015930017456412315, decouple_loss:0.00272666965611279
Iteration: 2348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491981267929077, gen p mean: -0.20407290756702423, mean p set: 0.4497752785682678
loss_pred:0.015087582170963287, decouple_loss:0.0025808734353631735
The modified gen p mean: 0.44803890585899353, gen p mean: -0.20598456263542175, mean p set: 0.44861117005348206
loss_pred:0.015793265774846077, decouple_loss:0.0022514923475682735
The modified gen p mean: 0.4477517008781433, gen p mean: -0.20388777554035187, mean p set: 0.4482733905315399
loss_pred:0.015896139666438103, decouple_loss:0.002064830856397748
Iteration: 2349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494822323322296, gen p mean: -0.2096053957939148, mean p set: 0.45005539059638977
loss_pred:0.015330200083553791, decouple_loss:0.0026427200064063072
The modified gen p mean: 0.44905996322631836, gen p mean: -0.21345579624176025, mean p set: 0.4496367573738098
loss_pred:0.015565073117613792, decouple_loss:0.0026315911673009396
The modified gen p mean: 0.4472794234752655, gen p mean: -0.20505274832248688, mean p set: 0.4478098452091217
loss_pred:0.0162177924066782, decouple_loss:0.002855345606803894
Iteration: 2350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867420196533203, gen p mean: -0.2076418250799179, mean p set: 0.44925159215927124
loss_pred:0.015531139448285103, decouple_loss:0.0021429380867630243
The modified gen p mean: 0.4493958353996277, gen p mean: -0.20991042256355286, mean p set: 0.449928879737854The modified gen p mean: 0.4478863775730133, gen p mean: -0.20908138155937195, mean p set: 0.44845834374427795
loss_pred:0.015285186469554901, decouple_loss:0.002139883581548929
loss_pred:0.015659091994166374, decouple_loss:0.0022035909350961447
2023-04-27 09:21:11 testing...
The modified gen p mean: 0.4482244551181793, gen p mean: -0.2045968770980835, mean p set: 0.44879910349845886
loss_pred:0.016452891752123833, decouple_loss:0.0023519396781921387
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2066522240638733, mean p set: 0.4499112665653229
loss_pred:0.0164797306060791, decouple_loss:0.002457922324538231
The modified gen p mean: 0.4493006765842438, gen p mean: -0.20828421413898468, mean p set: 0.4498290419578552
loss_pred:0.01592261530458927, decouple_loss:0.002669280394911766
WV_1_PC_1_EH_0_PS_30, loss: 0.016409730538725853, avg_mse: 0.024181026965379715
current test mse: 0.024181
Iteration: 2351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844046235084534, gen p mean: -0.20548827946186066, mean p set: 0.44901883602142334
loss_pred:0.0148567920550704, decouple_loss:0.00235563307069242
The modified gen p mean: 0.44800513982772827, gen p mean: -0.2090366780757904, mean p set: 0.448577344417572
loss_pred:0.015587442554533482, decouple_loss:0.0024804403074085712
The modified gen p mean: 0.44776999950408936, gen p mean: -0.2068031132221222, mean p set: 0.4483001232147217
loss_pred:0.01585415191948414, decouple_loss:0.002255302621051669
Iteration: 2352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943806529045105, gen p mean: -0.21187667548656464, mean p set: 0.4499637186527252
loss_pred:0.0153233977034688, decouple_loss:0.002317486796528101
The modified gen p mean: 0.44810542464256287, gen p mean: -0.21130312979221344, mean p set: 0.4486761689186096
loss_pred:0.015839673578739166, decouple_loss:0.0021804983261972666
The modified gen p mean: 0.44784849882125854, gen p mean: -0.20722010731697083, mean p set: 0.4484219551086426
loss_pred:0.015774525701999664, decouple_loss:0.002133655361831188
Iteration: 2353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448337197303772, gen p mean: -0.21410715579986572, mean p set: 0.4488653242588043
loss_pred:0.015752224251627922, decouple_loss:0.002409892389550805
The modified gen p mean: 0.4488958418369293, gen p mean: -0.20894581079483032, mean p set: 0.44947290420532227
loss_pred:0.015310022979974747, decouple_loss:0.0024511960800737143
The modified gen p mean: 0.44914549589157104, gen p mean: -0.210933655500412, mean p set: 0.44972550868988037
loss_pred:0.015434924513101578, decouple_loss:0.002455384936183691
Iteration: 2354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483632743358612, gen p mean: -0.20907248556613922, mean p set: 0.4488937258720398
loss_pred:0.01641598530113697, decouple_loss:0.0028104623779654503
The modified gen p mean: 0.4490625858306885, gen p mean: -0.20874884724617004, mean p set: 0.4496358335018158
loss_pred:0.01569710113108158, decouple_loss:0.002421856392174959
The modified gen p mean: 0.4489414095878601, gen p mean: -0.20997533202171326, mean p set: 0.44951972365379333
loss_pred:0.015238931402564049, decouple_loss:0.002755810273811221
Iteration: 2355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829607009887695, gen p mean: -0.20806559920310974, mean p set: 0.4488733410835266
loss_pred:0.01575358770787716, decouple_loss:0.0022487000096589327
The modified gen p mean: 0.4487920105457306, gen p mean: -0.20384514331817627, mean p set: 0.4493670165538788The modified gen p mean: 0.4487402141094208, gen p mean: -0.20414993166923523, mean p set: 0.4492647647857666
loss_pred:0.015266261994838715, decouple_loss:0.0023089370224624872
loss_pred:0.015331238508224487, decouple_loss:0.0023044119589030743
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937682151794434, gen p mean: -0.2021181583404541, mean p set: 0.4499538242816925
loss_pred:0.015412124805152416, decouple_loss:0.0029950698371976614
The modified gen p mean: 0.44792842864990234, gen p mean: -0.19844584167003632, mean p set: 0.4484536051750183The modified gen p mean: 0.44901737570762634, gen p mean: -0.20365357398986816, mean p set: 0.4495936930179596
loss_pred:0.015120433643460274, decouple_loss:0.003244014922529459
loss_pred:0.01606752723455429, decouple_loss:0.0026454429607838392
Iteration: 2357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493001401424408, gen p mean: -0.20737911760807037, mean p set: 0.4498789310455322
loss_pred:0.015498085878789425, decouple_loss:0.0028549341950565577
The modified gen p mean: 0.44744956493377686, gen p mean: -0.20386552810668945, mean p set: 0.4480241537094116
loss_pred:0.016056794673204422, decouple_loss:0.0024150225799530745
The modified gen p mean: 0.44864025712013245, gen p mean: -0.199524387717247, mean p set: 0.4491669833660126
loss_pred:0.01539171114563942, decouple_loss:0.0025780699215829372
Iteration: 2358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889506697654724, gen p mean: -0.20516811311244965, mean p set: 0.4494735598564148
loss_pred:0.015494893305003643, decouple_loss:0.0032457245979458094
The modified gen p mean: 0.4489605724811554, gen p mean: -0.20768561959266663, mean p set: 0.4495360851287842
loss_pred:0.015886245295405388, decouple_loss:0.003498211968690157
The modified gen p mean: 0.4486442804336548, gen p mean: -0.20242108404636383, mean p set: 0.44917774200439453
loss_pred:0.01590677723288536, decouple_loss:0.002908681519329548
Iteration: 2359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483609199523926, gen p mean: -0.20636919140815735, mean p set: 0.4489397704601288
loss_pred:0.015047065913677216, decouple_loss:0.0025719907134771347
The modified gen p mean: 0.4484689235687256, gen p mean: -0.2096836119890213, mean p set: 0.4490435719490051
loss_pred:0.015301747247576714, decouple_loss:0.0030296684708446264
The modified gen p mean: 0.4489135146141052, gen p mean: -0.20261260867118835, mean p set: 0.4494384229183197
loss_pred:0.01502835750579834, decouple_loss:0.002618110505864024
Iteration: 2360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772812724113464, gen p mean: -0.20097830891609192, mean p set: 0.44830653071403503
loss_pred:0.015326711349189281, decouple_loss:0.002759805880486965
The modified gen p mean: 0.44899240136146545, gen p mean: -0.21098829805850983, mean p set: 0.44956550002098083The modified gen p mean: 0.4487761855125427, gen p mean: -0.21494756639003754, mean p set: 0.4493010640144348
loss_pred:0.015690423548221588, decouple_loss:0.0025300406850874424
loss_pred:0.015584464184939861, decouple_loss:0.002766357734799385
2023-04-27 09:24:36 testing...
The modified gen p mean: 0.4482199549674988, gen p mean: -0.20969246327877045, mean p set: 0.44879910349845886
loss_pred:0.016463859006762505, decouple_loss:0.002837846055626869
The modified gen p mean: 0.4492954909801483, gen p mean: -0.21336613595485687, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2121816724538803, mean p set: 0.4499112665653229loss_pred:0.0160085316747427, decouple_loss:0.002687859581783414
loss_pred:0.01650053635239601, decouple_loss:0.0028548226691782475
WV_1_PC_1_EH_0_PS_30, loss: 0.016463985666632652, avg_mse: 0.024220718070864677
current test mse: 0.024221
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 2361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494245946407318, gen p mean: -0.21049848198890686, mean p set: 0.4499533474445343
loss_pred:0.015107722021639347, decouple_loss:0.0027899877168238163
The modified gen p mean: 0.4500572383403778, gen p mean: -0.20816102623939514, mean p set: 0.4506332576274872
The modified gen p mean: 0.4477727711200714, gen p mean: -0.2090323567390442, mean p set: 0.4483490288257599
loss_pred:0.014596144668757915, decouple_loss:0.0028092293068766594
loss_pred:0.015200641937553883, decouple_loss:0.003666273085400462
Iteration: 2362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491147994995117, gen p mean: -0.21237067878246307, mean p set: 0.44964301586151123
loss_pred:0.01577753759920597, decouple_loss:0.0025438915472477674
The modified gen p mean: 0.4482945203781128, gen p mean: -0.2177129089832306, mean p set: 0.4488680362701416
The modified gen p mean: 0.4492902159690857, gen p mean: -0.2090347856283188, mean p set: 0.4498685300350189
loss_pred:0.014691180549561977, decouple_loss:0.00263026962056756
loss_pred:0.015467389486730099, decouple_loss:0.002454593777656555
Iteration: 2363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472021758556366, gen p mean: -0.2063838392496109, mean p set: 0.4477255642414093
loss_pred:0.01485905610024929, decouple_loss:0.002793347230181098
The modified gen p mean: 0.4478777348995209, gen p mean: -0.20259034633636475, mean p set: 0.44844722747802734
The modified gen p mean: 0.4487317204475403, gen p mean: -0.2098839432001114, mean p set: 0.44930922985076904
loss_pred:0.015476367436349392, decouple_loss:0.0029441779479384422
loss_pred:0.015046501532196999, decouple_loss:0.002736151684075594
Iteration: 2364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484490156173706, gen p mean: -0.2082013338804245, mean p set: 0.44902855157852173
loss_pred:0.01540746632963419, decouple_loss:0.002627659821882844
The modified gen p mean: 0.44837114214897156, gen p mean: -0.2028302401304245, mean p set: 0.448943167924881
loss_pred:0.015013281255960464, decouple_loss:0.0026483112014830112
The modified gen p mean: 0.4490291178226471, gen p mean: -0.20872506499290466, mean p set: 0.4495595097541809
loss_pred:0.015125805512070656, decouple_loss:0.0026446389965713024
Iteration: 2365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855883717536926, gen p mean: -0.20968955755233765, mean p set: 0.449137419462204
loss_pred:0.014965776354074478, decouple_loss:0.003341799834743142
The modified gen p mean: 0.45010414719581604, gen p mean: -0.20196180045604706, mean p set: 0.45063140988349915The modified gen p mean: 0.4486039876937866, gen p mean: -0.20678353309631348, mean p set: 0.44917967915534973
loss_pred:0.01482722070068121, decouple_loss:0.002967346692457795
loss_pred:0.015282549895346165, decouple_loss:0.0035972832702100277
Iteration: 2366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490104615688324, gen p mean: -0.20430567860603333, mean p set: 0.44958946108818054
loss_pred:0.015002299100160599, decouple_loss:0.002867195988073945
The modified gen p mean: 0.44870561361312866, gen p mean: -0.19460998475551605, mean p set: 0.4492368996143341The modified gen p mean: 0.44652852416038513, gen p mean: -0.20712904632091522, mean p set: 0.44710251688957214
loss_pred:0.014848523773252964, decouple_loss:0.0033606335055083036
loss_pred:0.014900271780788898, decouple_loss:0.003339525079354644
Iteration: 2367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892019033432007, gen p mean: -0.20294393599033356, mean p set: 0.44949984550476074
loss_pred:0.01521435659378767, decouple_loss:0.002696850337088108
The modified gen p mean: 0.4498031735420227, gen p mean: -0.20407752692699432, mean p set: 0.4503842294216156
loss_pred:0.015239119529724121, decouple_loss:0.002755809808149934
The modified gen p mean: 0.449308842420578, gen p mean: -0.20916035771369934, mean p set: 0.44983842968940735
loss_pred:0.015548287890851498, decouple_loss:0.002730816835537553
Iteration: 2368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483015835285187, gen p mean: -0.19169573485851288, mean p set: 0.44888070225715637
loss_pred:0.014727797359228134, decouple_loss:0.0031023805495351553
The modified gen p mean: 0.44800156354904175, gen p mean: -0.19874483346939087, mean p set: 0.4485769271850586
loss_pred:0.014702130109071732, decouple_loss:0.0034802339505404234
The modified gen p mean: 0.44869837164878845, gen p mean: -0.20342212915420532, mean p set: 0.4492279887199402
loss_pred:0.014634937979280949, decouple_loss:0.0031131587456911802
Iteration: 2369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878506660461426, gen p mean: -0.20543205738067627, mean p set: 0.44936034083366394
loss_pred:0.01484976802021265, decouple_loss:0.0023762411437928677
The modified gen p mean: 0.4492289125919342, gen p mean: -0.20482243597507477, mean p set: 0.44975459575653076The modified gen p mean: 0.4494304358959198, gen p mean: -0.20729240775108337, mean p set: 0.4500042200088501
loss_pred:0.01514982059597969, decouple_loss:0.0026392529252916574
loss_pred:0.014699213206768036, decouple_loss:0.0026012181770056486
Iteration: 2370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902417063713074, gen p mean: -0.20736095309257507, mean p set: 0.4495994448661804
loss_pred:0.015175308100879192, decouple_loss:0.003148086369037628
The modified gen p mean: 0.44888487458229065, gen p mean: -0.204697385430336, mean p set: 0.44945788383483887
loss_pred:0.014663365669548512, decouple_loss:0.0028502356726676226
The modified gen p mean: 0.44733864068984985, gen p mean: -0.20885346829891205, mean p set: 0.4478663504123688
loss_pred:0.014785493724048138, decouple_loss:0.0030382752884179354
2023-04-27 09:28:46 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.20148560404777527, mean p set: 0.4499112665653229
loss_pred:0.016745759174227715, decouple_loss:0.002687558764591813
The modified gen p mean: 0.4482204020023346, gen p mean: -0.19860626757144928, mean p set: 0.44879910349845886
loss_pred:0.016593242064118385, decouple_loss:0.0025864189956337214
The modified gen p mean: 0.4493028521537781, gen p mean: -0.20260655879974365, mean p set: 0.4498290419578552
loss_pred:0.016197914257645607, decouple_loss:0.0026307315565645695
WV_1_PC_1_EH_0_PS_30, loss: 0.016644051298499107, avg_mse: 0.02455894462764263
current test mse: 0.024559
Iteration: 2371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778937101364136, gen p mean: -0.19689936935901642, mean p set: 0.4483669102191925
loss_pred:0.01496344804763794, decouple_loss:0.0025300446432083845
The modified gen p mean: 0.44935211539268494, gen p mean: -0.2021212875843048, mean p set: 0.44987955689430237
loss_pred:0.014913828112185001, decouple_loss:0.002518625231459737
The modified gen p mean: 0.4477972090244293, gen p mean: -0.1948949098587036, mean p set: 0.44837456941604614
loss_pred:0.015038946643471718, decouple_loss:0.002280970336869359
Iteration: 2372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487949013710022, gen p mean: -0.20004065334796906, mean p set: 0.44932347536087036
loss_pred:0.014778205193579197, decouple_loss:0.0026851585134863853
The modified gen p mean: 0.449878066778183, gen p mean: -0.1985633671283722, mean p set: 0.45046207308769226
loss_pred:0.014669817872345448, decouple_loss:0.003806282766163349
The modified gen p mean: 0.4480176568031311, gen p mean: -0.1897798478603363, mean p set: 0.4485895335674286
loss_pred:0.01439716387540102, decouple_loss:0.002705424325540662
Iteration: 2373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493063986301422, gen p mean: -0.20219115912914276, mean p set: 0.4498407244682312
loss_pred:0.014922980219125748, decouple_loss:0.0025812070816755295
The modified gen p mean: 0.44763147830963135, gen p mean: -0.20420192182064056, mean p set: 0.44820713996887207
loss_pred:0.015406235121190548, decouple_loss:0.0023968566674739122
The modified gen p mean: 0.44843029975891113, gen p mean: -0.19941605627536774, mean p set: 0.44900989532470703
loss_pred:0.015084346756339073, decouple_loss:0.002614159369841218
Iteration: 2374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475884735584259, gen p mean: -0.20606838166713715, mean p set: 0.4481198489665985
loss_pred:0.014696141704916954, decouple_loss:0.002955252304673195
The modified gen p mean: 0.44964778423309326, gen p mean: -0.20293237268924713, mean p set: 0.45022737979888916
loss_pred:0.015327539294958115, decouple_loss:0.003360144793987274
The modified gen p mean: 0.4484662711620331, gen p mean: -0.21147336065769196, mean p set: 0.44904085993766785
loss_pred:0.014649785123765469, decouple_loss:0.003051345469430089
Iteration: 2375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911184906959534, gen p mean: -0.20269829034805298, mean p set: 0.449687123298645
loss_pred:0.015464049763977528, decouple_loss:0.002546957926824689
The modified gen p mean: 0.44903764128685, gen p mean: -0.20302163064479828, mean p set: 0.4496126174926758The modified gen p mean: 0.4464404582977295, gen p mean: -0.20375260710716248, mean p set: 0.4469698667526245
loss_pred:0.014410512521862984, decouple_loss:0.002409097272902727
loss_pred:0.01471229549497366, decouple_loss:0.0024887886829674244
Iteration: 2376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948235154151917, gen p mean: -0.206682950258255, mean p set: 0.4500616788864136
loss_pred:0.014929772354662418, decouple_loss:0.0026048754807561636
The modified gen p mean: 0.44762954115867615, gen p mean: -0.2012735903263092, mean p set: 0.44820865988731384The modified gen p mean: 0.4493965208530426, gen p mean: -0.19593797624111176, mean p set: 0.4499235153198242
loss_pred:0.015071092173457146, decouple_loss:0.002714123809710145
loss_pred:0.015365785919129848, decouple_loss:0.0025838236324489117
Iteration: 2377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483899772167206, gen p mean: -0.20872926712036133, mean p set: 0.44896194338798523
loss_pred:0.015263265930116177, decouple_loss:0.0023978862445801497
The modified gen p mean: 0.4480392634868622, gen p mean: -0.2049238234758377, mean p set: 0.44861605763435364
loss_pred:0.014870932325720787, decouple_loss:0.002621548483148217
The modified gen p mean: 0.4481080174446106, gen p mean: -0.2034984529018402, mean p set: 0.448634535074234
loss_pred:0.014769528061151505, decouple_loss:0.0025005326606333256
Iteration: 2378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497215449810028, gen p mean: -0.20446863770484924, mean p set: 0.45029905438423157
loss_pred:0.015084548853337765, decouple_loss:0.00221224850974977
The modified gen p mean: 0.4488201141357422, gen p mean: -0.21313853561878204, mean p set: 0.4493459463119507
loss_pred:0.0155160091817379, decouple_loss:0.002535094739869237
The modified gen p mean: 0.44871512055397034, gen p mean: -0.20944860577583313, mean p set: 0.449288934469223
loss_pred:0.01509050466120243, decouple_loss:0.0022025040816515684
Iteration: 2379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840070605278015, gen p mean: -0.2087036669254303, mean p set: 0.44898566603660583
loss_pred:0.01489871833473444, decouple_loss:0.0027732739690691233
The modified gen p mean: 0.4480150043964386, gen p mean: -0.20394092798233032, mean p set: 0.4485909342765808
loss_pred:0.015486220829188824, decouple_loss:0.002523898147046566
The modified gen p mean: 0.4503631293773651, gen p mean: -0.20182280242443085, mean p set: 0.4508882462978363
loss_pred:0.014820633456110954, decouple_loss:0.002701102988794446
Iteration: 2380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474782645702362, gen p mean: -0.20354487001895905, mean p set: 0.448056697845459
loss_pred:0.014553943648934364, decouple_loss:0.00263152620755136
The modified gen p mean: 0.45010581612586975, gen p mean: -0.20358482003211975, mean p set: 0.450682133436203
loss_pred:0.01503773033618927, decouple_loss:0.0025843139737844467
The modified gen p mean: 0.44973495602607727, gen p mean: -0.2065192610025406, mean p set: 0.4502703547477722
loss_pred:0.015082968398928642, decouple_loss:0.0023943146225064993
2023-04-27 09:32:10 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2029971033334732, mean p set: 0.4499112665653229
loss_pred:0.016715098172426224, decouple_loss:0.0026771463453769684
The modified gen p mean: 0.4492994546890259, gen p mean: -0.20418484508991241, mean p set: 0.4498290419578552
loss_pred:0.016194818541407585, decouple_loss:0.00246817315928638
The modified gen p mean: 0.4482240676879883, gen p mean: -0.20031140744686127, mean p set: 0.44879910349845886
loss_pred:0.016601433977484703, decouple_loss:0.0025596246123313904
WV_1_PC_1_EH_0_PS_30, loss: 0.01663219928741455, avg_mse: 0.024500926956534386
current test mse: 0.024501
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 2381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718313217163086, gen p mean: -0.20573998987674713, mean p set: 0.44771143794059753
loss_pred:0.01631159521639347, decouple_loss:0.0033430748153477907
The modified gen p mean: 0.4475732445716858, gen p mean: -0.20554324984550476, mean p set: 0.4481448233127594
loss_pred:0.016125446185469627, decouple_loss:0.002671137684956193
The modified gen p mean: 0.4475078582763672, gen p mean: -0.20196057856082916, mean p set: 0.44807714223861694
loss_pred:0.016215955838561058, decouple_loss:0.0027744027320295572
Iteration: 2382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462599456310272, gen p mean: -0.20408187806606293, mean p set: 0.44678664207458496
loss_pred:0.015613056719303131, decouple_loss:0.00243532657623291
The modified gen p mean: 0.4480467736721039, gen p mean: -0.20952259004116058, mean p set: 0.4486217796802521
The modified gen p mean: 0.4474308490753174, gen p mean: -0.20728521049022675, mean p set: 0.44800713658332825
loss_pred:0.01566564477980137, decouple_loss:0.0027963968459516764
loss_pred:0.015722423791885376, decouple_loss:0.0025089383125305176
Iteration: 2383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704878330230713, gen p mean: -0.20836184918880463, mean p set: 0.44758090376853943
loss_pred:0.015779756009578705, decouple_loss:0.002366814063861966
The modified gen p mean: 0.4479093849658966, gen p mean: -0.20765839517116547, mean p set: 0.44848695397377014
The modified gen p mean: 0.44752898812294006, gen p mean: -0.2017703652381897, mean p set: 0.4481000304222107
loss_pred:0.01582936942577362, decouple_loss:0.002667019609361887
loss_pred:0.01620854064822197, decouple_loss:0.0024816941004246473
Iteration: 2384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467250406742096, gen p mean: -0.19865554571151733, mean p set: 0.44725102186203003
loss_pred:0.015421356074512005, decouple_loss:0.0027028867043554783
The modified gen p mean: 0.4465540647506714, gen p mean: -0.2017480880022049, mean p set: 0.44713303446769714
The modified gen p mean: 0.4473482370376587, gen p mean: -0.20273159444332123, mean p set: 0.44792598485946655
loss_pred:0.01549084484577179, decouple_loss:0.0027848503086715937
loss_pred:0.015932736918330193, decouple_loss:0.0028010031674057245
Iteration: 2385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472315013408661, gen p mean: -0.1983548402786255, mean p set: 0.4478038251399994
loss_pred:0.01591423898935318, decouple_loss:0.0032212422229349613
The modified gen p mean: 0.44769200682640076, gen p mean: -0.20186784863471985, mean p set: 0.4482708275318146The modified gen p mean: 0.4475400745868683, gen p mean: -0.1995803415775299, mean p set: 0.44806763529777527
loss_pred:0.016716955229640007, decouple_loss:0.0024939824361354113
loss_pred:0.015760058537125587, decouple_loss:0.003257965436205268
Iteration: 2386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472387433052063, gen p mean: -0.19716139137744904, mean p set: 0.44781771302223206
loss_pred:0.01632661558687687, decouple_loss:0.002870365045964718
The modified gen p mean: 0.4484917223453522, gen p mean: -0.19957461953163147, mean p set: 0.4490669369697571The modified gen p mean: 0.44676390290260315, gen p mean: -0.20124788582324982, mean p set: 0.44729599356651306
loss_pred:0.015651719644665718, decouple_loss:0.002360503887757659
loss_pred:0.015136538073420525, decouple_loss:0.0024526973720639944
Iteration: 2387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472019672393799, gen p mean: -0.20121991634368896, mean p set: 0.44777771830558777
loss_pred:0.016139110550284386, decouple_loss:0.003197232261300087
The modified gen p mean: 0.4469376802444458, gen p mean: -0.1992335319519043, mean p set: 0.4474641680717468The modified gen p mean: 0.44618409872055054, gen p mean: -0.19828511774539948, mean p set: 0.4467572569847107
loss_pred:0.014991587959229946, decouple_loss:0.0026292267721146345
loss_pred:0.01663006842136383, decouple_loss:0.0030007704626768827
Iteration: 2388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736382365226746, gen p mean: -0.20596665143966675, mean p set: 0.44793930649757385
loss_pred:0.01635758765041828, decouple_loss:0.002442494034767151
The modified gen p mean: 0.44751691818237305, gen p mean: -0.20159758627414703, mean p set: 0.4480897784233093
loss_pred:0.015928808599710464, decouple_loss:0.0025873209815472364
The modified gen p mean: 0.44747817516326904, gen p mean: -0.2080296128988266, mean p set: 0.4480043649673462
loss_pred:0.016355309635400772, decouple_loss:0.002396636176854372
Iteration: 2389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459229111671448, gen p mean: -0.20351001620292664, mean p set: 0.44649389386177063
loss_pred:0.015054510906338692, decouple_loss:0.0029330989345908165
The modified gen p mean: 0.4476475119590759, gen p mean: -0.20526686310768127, mean p set: 0.4482216238975525
loss_pred:0.016518067568540573, decouple_loss:0.0029807891696691513
The modified gen p mean: 0.4472194314002991, gen p mean: -0.2073693871498108, mean p set: 0.44774720072746277
loss_pred:0.015367682091891766, decouple_loss:0.0029223687015473843
Iteration: 2390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477587342262268, gen p mean: -0.2030070573091507, mean p set: 0.44833505153656006
loss_pred:0.01603919081389904, decouple_loss:0.0025921438354998827
The modified gen p mean: 0.44794192910194397, gen p mean: -0.204219788312912, mean p set: 0.4485156238079071
loss_pred:0.015135640278458595, decouple_loss:0.0023533091880381107
The modified gen p mean: 0.4477652311325073, gen p mean: -0.2095845341682434, mean p set: 0.4482952058315277
loss_pred:0.01560324989259243, decouple_loss:0.0023984939325600863
2023-04-27 09:36:13 testing...
The modified gen p mean: 0.44822388887405396, gen p mean: -0.19654802978038788, mean p set: 0.44879910349845886
loss_pred:0.016532782465219498, decouple_loss:0.002553971717134118
The modified gen p mean: 0.4494309425354004, gen p mean: -0.1989579200744629, mean p set: 0.4499112665653229
loss_pred:0.016537625342607498, decouple_loss:0.0025816326960921288
The modified gen p mean: 0.44929996132850647, gen p mean: -0.20020027458667755, mean p set: 0.4498290419578552
loss_pred:0.01608327589929104, decouple_loss:0.0026790702249854803
WV_1_PC_1_EH_0_PS_30, loss: 0.01651480607688427, avg_mse: 0.024322301149368286
current test mse: 0.024322
Iteration: 2391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823578000068665, gen p mean: -0.20068348944187164, mean p set: 0.4488099217414856
loss_pred:0.016369396820664406, decouple_loss:0.00283645186573267
The modified gen p mean: 0.44720157980918884, gen p mean: -0.19983147084712982, mean p set: 0.4477778375148773
loss_pred:0.015365667641162872, decouple_loss:0.0027430022601038218
The modified gen p mean: 0.44697195291519165, gen p mean: -0.19796618819236755, mean p set: 0.44749921560287476
loss_pred:0.015974922105669975, decouple_loss:0.0026619979180395603
Iteration: 2392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477408230304718, gen p mean: -0.19613783061504364, mean p set: 0.4482730031013489
loss_pred:0.015492991544306278, decouple_loss:0.002229216042906046
The modified gen p mean: 0.44746118783950806, gen p mean: -0.19854405522346497, mean p set: 0.4480361342430115
loss_pred:0.015936240553855896, decouple_loss:0.002253301441669464
The modified gen p mean: 0.4470891058444977, gen p mean: -0.19998513162136078, mean p set: 0.4476645588874817
loss_pred:0.015929028391838074, decouple_loss:0.0022635371424257755
Iteration: 2393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686704874038696, gen p mean: -0.20618997514247894, mean p set: 0.44739648699760437
loss_pred:0.016448460519313812, decouple_loss:0.002500705188140273
The modified gen p mean: 0.4470994472503662, gen p mean: -0.20544788241386414, mean p set: 0.44768041372299194
loss_pred:0.015095127746462822, decouple_loss:0.002534418599680066
The modified gen p mean: 0.4473932981491089, gen p mean: -0.20188316702842712, mean p set: 0.4479702413082123
loss_pred:0.015748241916298866, decouple_loss:0.0023913655895739794
Iteration: 2394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477154016494751, gen p mean: -0.2074243426322937, mean p set: 0.4482428729534149
loss_pred:0.015594244003295898, decouple_loss:0.002479919232428074
The modified gen p mean: 0.4474344551563263, gen p mean: -0.1998308002948761, mean p set: 0.4480176270008087
loss_pred:0.016194961965084076, decouple_loss:0.0023251802194863558
The modified gen p mean: 0.4468642473220825, gen p mean: -0.2018274962902069, mean p set: 0.447443425655365
loss_pred:0.01552318874746561, decouple_loss:0.002164864679798484
Iteration: 2395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478112757205963, gen p mean: -0.1968725472688675, mean p set: 0.4483889639377594
loss_pred:0.016178559511899948, decouple_loss:0.0026181673165410757
The modified gen p mean: 0.4485354423522949, gen p mean: -0.20111045241355896, mean p set: 0.4490697383880615The modified gen p mean: 0.4470196068286896, gen p mean: -0.19510164856910706, mean p set: 0.4475988745689392
loss_pred:0.015519311651587486, decouple_loss:0.002432825742289424
loss_pred:0.015295227989554405, decouple_loss:0.0028009621892124414
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739240407943726, gen p mean: -0.19921937584877014, mean p set: 0.4479668438434601
loss_pred:0.01652710884809494, decouple_loss:0.0026426468975842
The modified gen p mean: 0.4474850594997406, gen p mean: -0.20523013174533844, mean p set: 0.4480603337287903The modified gen p mean: 0.4464939832687378, gen p mean: -0.2005966156721115, mean p set: 0.44702383875846863
loss_pred:0.01583656296133995, decouple_loss:0.002632226562127471
loss_pred:0.015447822399437428, decouple_loss:0.0022646356374025345
Iteration: 2397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730907678604126, gen p mean: -0.20389288663864136, mean p set: 0.44783589243888855
loss_pred:0.015191944316029549, decouple_loss:0.0022488818503916264
The modified gen p mean: 0.44709187746047974, gen p mean: -0.20722883939743042, mean p set: 0.44767072796821594
loss_pred:0.01609668880701065, decouple_loss:0.0022109602577984333
The modified gen p mean: 0.4476698040962219, gen p mean: -0.20738506317138672, mean p set: 0.44824355840682983
loss_pred:0.016215067356824875, decouple_loss:0.002369785215705633
Iteration: 2398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469839334487915, gen p mean: -0.2037399262189865, mean p set: 0.44755926728248596
loss_pred:0.01660679280757904, decouple_loss:0.0025172578170895576
The modified gen p mean: 0.4471324384212494, gen p mean: -0.20740829408168793, mean p set: 0.4476606547832489The modified gen p mean: 0.44762322306632996, gen p mean: -0.20904171466827393, mean p set: 0.44820162653923035
loss_pred:0.01616770215332508, decouple_loss:0.0024396588560193777
loss_pred:0.016089631244540215, decouple_loss:0.0025784566532820463
Iteration: 2399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756633043289185, gen p mean: -0.20775946974754333, mean p set: 0.4481445848941803
loss_pred:0.015324453823268414, decouple_loss:0.002270077122375369
The modified gen p mean: 0.4472998082637787, gen p mean: -0.20578768849372864, mean p set: 0.4478713572025299
loss_pred:0.01623513549566269, decouple_loss:0.002314154291525483
The modified gen p mean: 0.4474787414073944, gen p mean: -0.21605247259140015, mean p set: 0.4480067491531372
loss_pred:0.01590326614677906, decouple_loss:0.002331176772713661
Iteration: 2400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470579922199249, gen p mean: -0.21211980283260345, mean p set: 0.44763314723968506
loss_pred:0.016334859654307365, decouple_loss:0.002394250361248851
The modified gen p mean: 0.4480351209640503, gen p mean: -0.2095801681280136, mean p set: 0.4486115872859955The modified gen p mean: 0.44714006781578064, gen p mean: -0.20980089902877808, mean p set: 0.44767072796821594
loss_pred:0.015891730785369873, decouple_loss:0.0026823750231415033
loss_pred:0.016113171353936195, decouple_loss:0.0024833758361637592
2023-04-27 09:39:38 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21270129084587097, mean p set: 0.4499112665653229
loss_pred:0.016621604561805725, decouple_loss:0.00243120058439672
The modified gen p mean: 0.44929808378219604, gen p mean: -0.21395885944366455, mean p set: 0.4498290419578552
loss_pred:0.016133641824126244, decouple_loss:0.002390417503193021
The modified gen p mean: 0.44821906089782715, gen p mean: -0.21047915518283844, mean p set: 0.44879910349845886
loss_pred:0.016455523669719696, decouple_loss:0.002439949894323945
WV_1_PC_1_EH_0_PS_30, loss: 0.01652461662888527, avg_mse: 0.024484096094965935
current test mse: 0.024484
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 2401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45015549659729004, gen p mean: -0.21520842611789703, mean p set: 0.4506858289241791
loss_pred:0.014885179698467255, decouple_loss:0.0027145231142640114
The modified gen p mean: 0.449057012796402, gen p mean: -0.21766559779644012, mean p set: 0.4496326744556427
loss_pred:0.015227504074573517, decouple_loss:0.002441073302179575
The modified gen p mean: 0.44890761375427246, gen p mean: -0.22188009321689606, mean p set: 0.4494844079017639
loss_pred:0.015548140741884708, decouple_loss:0.002457197057083249
Iteration: 2402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482662081718445, gen p mean: -0.20699794590473175, mean p set: 0.4487907588481903
loss_pred:0.015533625148236752, decouple_loss:0.002352770185098052
The modified gen p mean: 0.44913163781166077, gen p mean: -0.2097005397081375, mean p set: 0.449707955121994
The modified gen p mean: 0.44852322340011597, gen p mean: -0.20628796517848969, mean p set: 0.4491027593612671
loss_pred:0.015427738428115845, decouple_loss:0.0026519405655562878
loss_pred:0.015439503826200962, decouple_loss:0.0024434332735836506
Iteration: 2403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986215233802795, gen p mean: -0.20723411440849304, mean p set: 0.4503912329673767
loss_pred:0.013796624727547169, decouple_loss:0.0025690270122140646
The modified gen p mean: 0.4499199688434601, gen p mean: -0.2087312936782837, mean p set: 0.4504936933517456
The modified gen p mean: 0.44983071088790894, gen p mean: -0.2072557806968689, mean p set: 0.450408935546875
loss_pred:0.014109643176198006, decouple_loss:0.0024965594056993723
loss_pred:0.014498645439743996, decouple_loss:0.002372435759752989
Iteration: 2404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495140612125397, gen p mean: -0.20740501582622528, mean p set: 0.4500423073768616
loss_pred:0.016060443595051765, decouple_loss:0.002571732271462679
The modified gen p mean: 0.4486583173274994, gen p mean: -0.20401839911937714, mean p set: 0.4492337107658386
The modified gen p mean: 0.4501904547214508, gen p mean: -0.20699554681777954, mean p set: 0.4507656991481781
loss_pred:0.014904993586242199, decouple_loss:0.0026294768322259188
loss_pred:0.015045328997075558, decouple_loss:0.0026342382188886404
Iteration: 2405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049959421157837, gen p mean: -0.2066727578639984, mean p set: 0.4510750472545624
loss_pred:0.015078631229698658, decouple_loss:0.0025838841684162617
The modified gen p mean: 0.44832149147987366, gen p mean: -0.20802952349185944, mean p set: 0.44884857535362244The modified gen p mean: 0.44948992133140564, gen p mean: -0.20372527837753296, mean p set: 0.45007139444351196
loss_pred:0.015471982769668102, decouple_loss:0.002996371127665043
loss_pred:0.015275554731488228, decouple_loss:0.0027644310612231493
Iteration: 2406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488270878791809, gen p mean: -0.18802683055400848, mean p set: 0.4494022727012634
loss_pred:0.015968022868037224, decouple_loss:0.0028238047380000353
The modified gen p mean: 0.4493550658226013, gen p mean: -0.19230318069458008, mean p set: 0.4498860538005829The modified gen p mean: 0.44932153820991516, gen p mean: -0.1896442174911499, mean p set: 0.4498968720436096
loss_pred:0.014471338130533695, decouple_loss:0.002837279811501503
loss_pred:0.015805602073669434, decouple_loss:0.0028637018986046314
Iteration: 2407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501477777957916, gen p mean: -0.1910979002714157, mean p set: 0.4507233798503876
loss_pred:0.015218180604279041, decouple_loss:0.0028976264875382185
The modified gen p mean: 0.44872400164604187, gen p mean: -0.19113753736019135, mean p set: 0.4492511451244354The modified gen p mean: 0.44881337881088257, gen p mean: -0.1945492923259735, mean p set: 0.44939103722572327
loss_pred:0.015343597158789635, decouple_loss:0.002832538913935423
loss_pred:0.016323795542120934, decouple_loss:0.0027091591618955135
Iteration: 2408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786232709884644, gen p mean: -0.21103540062904358, mean p set: 0.44843724370002747
loss_pred:0.015099977143108845, decouple_loss:0.0030532439704984426
The modified gen p mean: 0.4489116370677948, gen p mean: -0.20270483195781708, mean p set: 0.44949066638946533
loss_pred:0.01511822734028101, decouple_loss:0.002924710977822542
The modified gen p mean: 0.45006805658340454, gen p mean: -0.20883746445178986, mean p set: 0.4505973160266876
loss_pred:0.015032017603516579, decouple_loss:0.0027840121183544397
Iteration: 2409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503443241119385, gen p mean: -0.21289223432540894, mean p set: 0.4509190618991852
loss_pred:0.015152759850025177, decouple_loss:0.0027354746125638485
The modified gen p mean: 0.45035332441329956, gen p mean: -0.2145901918411255, mean p set: 0.45092666149139404
loss_pred:0.015028915368020535, decouple_loss:0.002676863456144929
The modified gen p mean: 0.45011693239212036, gen p mean: -0.21527478098869324, mean p set: 0.45064398646354675
loss_pred:0.014052645303308964, decouple_loss:0.0026623194571584463
Iteration: 2410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960349798202515, gen p mean: -0.21370087563991547, mean p set: 0.45017769932746887
loss_pred:0.014806756749749184, decouple_loss:0.0023649532813578844
The modified gen p mean: 0.4493457078933716, gen p mean: -0.21554893255233765, mean p set: 0.4499218463897705
loss_pred:0.015036853961646557, decouple_loss:0.0024557283613830805
The modified gen p mean: 0.45029884576797485, gen p mean: -0.21190118789672852, mean p set: 0.4508228898048401
loss_pred:0.014367294497787952, decouple_loss:0.002435189438983798
2023-04-27 09:43:45 testing...
The modified gen p mean: 0.4482266902923584, gen p mean: -0.2004854679107666, mean p set: 0.44879910349845886
loss_pred:0.01657555066049099, decouple_loss:0.002808701479807496
The modified gen p mean: 0.44930124282836914, gen p mean: -0.20369930565357208, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.20270973443984985, mean p set: 0.4499112665653229
loss_pred:0.016245022416114807, decouple_loss:0.0027907469775527716
loss_pred:0.016697291284799576, decouple_loss:0.002746535697951913
WV_1_PC_1_EH_0_PS_30, loss: 0.016645057126879692, avg_mse: 0.02459569275379181
current test mse: 0.024596
Iteration: 2411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498109817504883, gen p mean: -0.20169921219348907, mean p set: 0.4503350555896759
loss_pred:0.014854577369987965, decouple_loss:0.002690501045435667
The modified gen p mean: 0.44923505187034607, gen p mean: -0.20694303512573242, mean p set: 0.4498126208782196
loss_pred:0.014618055894970894, decouple_loss:0.0030480045825242996
The modified gen p mean: 0.4501875936985016, gen p mean: -0.20606794953346252, mean p set: 0.45076262950897217
loss_pred:0.014252218417823315, decouple_loss:0.0028471495024859905
Iteration: 2412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482024908065796, gen p mean: -0.1989380121231079, mean p set: 0.44873154163360596
loss_pred:0.014517216943204403, decouple_loss:0.002584819681942463
The modified gen p mean: 0.4488426446914673, gen p mean: -0.19613312184810638, mean p set: 0.4494141638278961
The modified gen p mean: 0.4477827250957489, gen p mean: -0.19399233162403107, mean p set: 0.44835996627807617
loss_pred:0.01556988712400198, decouple_loss:0.0025953836739063263
loss_pred:0.015895994380116463, decouple_loss:0.0025032039266079664
Iteration: 2413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072343945503235, gen p mean: -0.19630451500415802, mean p set: 0.4512515664100647
loss_pred:0.014806141145527363, decouple_loss:0.0027825459837913513
The modified gen p mean: 0.4493495225906372, gen p mean: -0.20183299481868744, mean p set: 0.4499257802963257
The modified gen p mean: 0.4495975375175476, gen p mean: -0.1966519057750702, mean p set: 0.4501778185367584
loss_pred:0.014925562776625156, decouple_loss:0.0024631416890770197
loss_pred:0.01509190909564495, decouple_loss:0.002742977812886238
Iteration: 2414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032137632369995, gen p mean: -0.20287807285785675, mean p set: 0.4508989155292511
loss_pred:0.014283926226198673, decouple_loss:0.002736912574619055
The modified gen p mean: 0.44936853647232056, gen p mean: -0.2024737298488617, mean p set: 0.4499005675315857The modified gen p mean: 0.44743314385414124, gen p mean: -0.19951994717121124, mean p set: 0.448009192943573
loss_pred:0.014827461913228035, decouple_loss:0.0026716915890574455
loss_pred:0.01453390158712864, decouple_loss:0.0026892023161053658
Iteration: 2415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487735629081726, gen p mean: -0.2040809988975525, mean p set: 0.4493516683578491
loss_pred:0.01581968367099762, decouple_loss:0.0026259864680469036
The modified gen p mean: 0.4499717354774475, gen p mean: -0.20196522772312164, mean p set: 0.4505492150783539
loss_pred:0.014394774101674557, decouple_loss:0.0029067902360111475
The modified gen p mean: 0.4483998417854309, gen p mean: -0.1986895352602005, mean p set: 0.4489321708679199
loss_pred:0.014495977200567722, decouple_loss:0.0025891102850437164
Iteration: 2416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476442039012909, gen p mean: -0.19684338569641113, mean p set: 0.4482172131538391
loss_pred:0.014743580482900143, decouple_loss:0.0025118826888501644
The modified gen p mean: 0.44960349798202515, gen p mean: -0.19740982353687286, mean p set: 0.4501335322856903The modified gen p mean: 0.4492287337779999, gen p mean: -0.20097646117210388, mean p set: 0.4497992694377899
loss_pred:0.014528241008520126, decouple_loss:0.0028977037873119116
loss_pred:0.01425134763121605, decouple_loss:0.0027768737636506557
Iteration: 2417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901514053344727, gen p mean: -0.19724304974079132, mean p set: 0.44958579540252686
loss_pred:0.01525163371115923, decouple_loss:0.002536374842748046
The modified gen p mean: 0.4489102363586426, gen p mean: -0.19977816939353943, mean p set: 0.4494830369949341
loss_pred:0.01456083357334137, decouple_loss:0.0024410311598330736
The modified gen p mean: 0.4505334794521332, gen p mean: -0.19383150339126587, mean p set: 0.45106109976768494
loss_pred:0.014037903398275375, decouple_loss:0.0026333702262490988
Iteration: 2418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714027643203735, gen p mean: -0.19289304316043854, mean p set: 0.4477207064628601
loss_pred:0.014872582629323006, decouple_loss:0.0029031590092927217
The modified gen p mean: 0.44710949063301086, gen p mean: -0.19408829510211945, mean p set: 0.4476839303970337The modified gen p mean: 0.44747185707092285, gen p mean: -0.19026529788970947, mean p set: 0.4479977786540985
loss_pred:0.01486148964613676, decouple_loss:0.0027886813040822744
loss_pred:0.014775137417018414, decouple_loss:0.0028950627893209457
Iteration: 2419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489768147468567, gen p mean: -0.1974506676197052, mean p set: 0.4495563805103302
loss_pred:0.015093798749148846, decouple_loss:0.0024132549297064543
The modified gen p mean: 0.4489573538303375, gen p mean: -0.18730026483535767, mean p set: 0.44953563809394836
loss_pred:0.014601881615817547, decouple_loss:0.0027567653451114893
The modified gen p mean: 0.4504925310611725, gen p mean: -0.191158264875412, mean p set: 0.4510194957256317
loss_pred:0.014495423063635826, decouple_loss:0.0025068840477615595
Iteration: 2420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012378692626953, gen p mean: -0.19274933636188507, mean p set: 0.4507005214691162
loss_pred:0.014083717949688435, decouple_loss:0.0025719355326145887
The modified gen p mean: 0.44941097497940063, gen p mean: -0.19067153334617615, mean p set: 0.4499913156032562
loss_pred:0.014321795664727688, decouple_loss:0.0026850923895835876
The modified gen p mean: 0.4483681619167328, gen p mean: -0.1896677166223526, mean p set: 0.44889214634895325
loss_pred:0.014924613758921623, decouple_loss:0.002801215974614024
2023-04-27 09:47:10 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.19511599838733673, mean p set: 0.4499112665653229
loss_pred:0.016750875860452652, decouple_loss:0.0028695070650428534
The modified gen p mean: 0.44930192828178406, gen p mean: -0.1964138001203537, mean p set: 0.4498290419578552
loss_pred:0.01633482798933983, decouple_loss:0.0029842029325664043
The modified gen p mean: 0.44822317361831665, gen p mean: -0.19306229054927826, mean p set: 0.44879910349845886
loss_pred:0.016665205359458923, decouple_loss:0.0028645978309214115
WV_1_PC_1_EH_0_PS_30, loss: 0.016728943213820457, avg_mse: 0.024694304913282394
current test mse: 0.024694
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 2421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461403489112854, gen p mean: -0.1985120326280594, mean p set: 0.44667288661003113
loss_pred:0.015107682906091213, decouple_loss:0.0026971569750458
The modified gen p mean: 0.44799715280532837, gen p mean: -0.19517798721790314, mean p set: 0.4485742151737213
loss_pred:0.015374929644167423, decouple_loss:0.002816850785166025
The modified gen p mean: 0.44660165905952454, gen p mean: -0.19172371923923492, mean p set: 0.447177916765213
loss_pred:0.015357931144535542, decouple_loss:0.002981976605951786
Iteration: 2422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480080306529999, gen p mean: -0.1960916519165039, mean p set: 0.4485393166542053
loss_pred:0.014852679334580898, decouple_loss:0.002743937773630023
The modified gen p mean: 0.44623038172721863, gen p mean: -0.2028936743736267, mean p set: 0.4468037486076355
The modified gen p mean: 0.4481029808521271, gen p mean: -0.19479231536388397, mean p set: 0.4486773908138275
loss_pred:0.01579563319683075, decouple_loss:0.0026017543859779835
loss_pred:0.015412026084959507, decouple_loss:0.0024606697261333466
Iteration: 2423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474666118621826, gen p mean: -0.19514483213424683, mean p set: 0.44799429178237915
loss_pred:0.014670809730887413, decouple_loss:0.0027448844630271196
The modified gen p mean: 0.44691717624664307, gen p mean: -0.19760094583034515, mean p set: 0.4474954903125763
The modified gen p mean: 0.44807615876197815, gen p mean: -0.19861465692520142, mean p set: 0.4486536979675293
loss_pred:0.01581823080778122, decouple_loss:0.002827294869348407
loss_pred:0.015432651154696941, decouple_loss:0.002826166804879904
Iteration: 2424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663354754447937, gen p mean: -0.19890692830085754, mean p set: 0.44715774059295654
loss_pred:0.015170625410974026, decouple_loss:0.002428813837468624
The modified gen p mean: 0.44801443815231323, gen p mean: -0.19758905470371246, mean p set: 0.4485970735549927
The modified gen p mean: 0.44576066732406616, gen p mean: -0.1993914246559143, mean p set: 0.446336567401886
loss_pred:0.01474766619503498, decouple_loss:0.0024911200162023306
loss_pred:0.015073438175022602, decouple_loss:0.0026015539187937975
Iteration: 2425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475418031215668, gen p mean: -0.2018820345401764, mean p set: 0.44811320304870605
loss_pred:0.0151156485080719, decouple_loss:0.0028788719791918993
The modified gen p mean: 0.44775041937828064, gen p mean: -0.1932365894317627, mean p set: 0.44832614064216614The modified gen p mean: 0.44764626026153564, gen p mean: -0.195120707154274, mean p set: 0.44817250967025757
loss_pred:0.014477943070232868, decouple_loss:0.002803392242640257
loss_pred:0.01528777927160263, decouple_loss:0.003571357112377882
Iteration: 2426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674932956695557, gen p mean: -0.19497066736221313, mean p set: 0.4473235309123993
loss_pred:0.015271652489900589, decouple_loss:0.002510824240744114
The modified gen p mean: 0.44768065214157104, gen p mean: -0.1987334042787552, mean p set: 0.4482541084289551The modified gen p mean: 0.4466407299041748, gen p mean: -0.19455623626708984, mean p set: 0.4471730887889862
loss_pred:0.015414392575621605, decouple_loss:0.002583234803751111
loss_pred:0.015401177108287811, decouple_loss:0.002441078657284379
Iteration: 2427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478592276573181, gen p mean: -0.1974593698978424, mean p set: 0.44843369722366333
loss_pred:0.015100876800715923, decouple_loss:0.0025512268766760826
The modified gen p mean: 0.44777730107307434, gen p mean: -0.2012965828180313, mean p set: 0.44830334186553955The modified gen p mean: 0.44707006216049194, gen p mean: -0.1887296885251999, mean p set: 0.44764673709869385
loss_pred:0.015633702278137207, decouple_loss:0.002681687707081437
loss_pred:0.014988971874117851, decouple_loss:0.0028854908887296915
Iteration: 2428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473685026168823, gen p mean: -0.19245222210884094, mean p set: 0.4479508101940155
loss_pred:0.015399615280330181, decouple_loss:0.002533386228606105
The modified gen p mean: 0.4476255774497986, gen p mean: -0.19131112098693848, mean p set: 0.44820424914360046
loss_pred:0.015361188910901546, decouple_loss:0.00264201732352376
The modified gen p mean: 0.4467102587223053, gen p mean: -0.1998782604932785, mean p set: 0.447241872549057
loss_pred:0.01567048393189907, decouple_loss:0.00246576895006001
Iteration: 2429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806206226348877, gen p mean: -0.20047111809253693, mean p set: 0.4486377537250519
loss_pred:0.015084986574947834, decouple_loss:0.002518929773941636
The modified gen p mean: 0.4472421705722809, gen p mean: -0.20382679998874664, mean p set: 0.44781628251075745
loss_pred:0.01550281047821045, decouple_loss:0.002405778504908085
The modified gen p mean: 0.44823238253593445, gen p mean: -0.20260165631771088, mean p set: 0.44875964522361755
loss_pred:0.015070327557623386, decouple_loss:0.002384358551353216
Iteration: 2430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822269678115845, gen p mean: -0.19597771763801575, mean p set: 0.4487995207309723
loss_pred:0.01567995361983776, decouple_loss:0.002476317575201392
The modified gen p mean: 0.4480783939361572, gen p mean: -0.20095136761665344, mean p set: 0.44860827922821045The modified gen p mean: 0.4479474723339081, gen p mean: -0.19908110797405243, mean p set: 0.44852498173713684
loss_pred:0.015572180040180683, decouple_loss:0.0023211599327623844
loss_pred:0.014850027859210968, decouple_loss:0.002571979770436883
2023-04-27 09:51:18 testing...
The modified gen p mean: 0.4482223689556122, gen p mean: -0.20233465731143951, mean p set: 0.44879910349845886
loss_pred:0.01644737459719181, decouple_loss:0.0027292182203382254
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2043810784816742, mean p set: 0.4499112665653229
The modified gen p mean: 0.44930601119995117, gen p mean: -0.2059219628572464, mean p set: 0.4498290419578552
loss_pred:0.016140766441822052, decouple_loss:0.0027699018828570843
loss_pred:0.016508452594280243, decouple_loss:0.003008750034496188
WV_1_PC_1_EH_0_PS_30, loss: 0.016507331281900406, avg_mse: 0.024358823895454407
current test mse: 0.024359
Iteration: 2431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726771116256714, gen p mean: -0.20852342247962952, mean p set: 0.4477926790714264
loss_pred:0.01532761100679636, decouple_loss:0.0027840095572173595
The modified gen p mean: 0.4472251832485199, gen p mean: -0.20880790054798126, mean p set: 0.44780153036117554
loss_pred:0.015833381563425064, decouple_loss:0.0026332635898143053
The modified gen p mean: 0.4482382833957672, gen p mean: -0.20342740416526794, mean p set: 0.4488171935081482
loss_pred:0.014765922911465168, decouple_loss:0.002427427563816309
Iteration: 2432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779035449028015, gen p mean: -0.198829784989357, mean p set: 0.44832247495651245
loss_pred:0.01570783741772175, decouple_loss:0.0023913164623081684
The modified gen p mean: 0.44788992404937744, gen p mean: -0.20462319254875183, mean p set: 0.4484725892543793
The modified gen p mean: 0.4474479854106903, gen p mean: -0.20160827040672302, mean p set: 0.4480171501636505
loss_pred:0.014635761268436909, decouple_loss:0.0022292763460427523
loss_pred:0.015523330308496952, decouple_loss:0.002257742453366518
Iteration: 2433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478793442249298, gen p mean: -0.2013210952281952, mean p set: 0.44840726256370544
loss_pred:0.015170346945524216, decouple_loss:0.0026426236145198345
The modified gen p mean: 0.44616571068763733, gen p mean: -0.20197466015815735, mean p set: 0.4467467665672302
The modified gen p mean: 0.4472464919090271, gen p mean: -0.2015223205089569, mean p set: 0.44781988859176636
loss_pred:0.015028966590762138, decouple_loss:0.0028555607423186302
loss_pred:0.015826629474759102, decouple_loss:0.0023376697208732367
Iteration: 2434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856005907058716, gen p mean: -0.20103372633457184, mean p set: 0.4491317868232727
loss_pred:0.014712803065776825, decouple_loss:0.002255174098536372
The modified gen p mean: 0.44709524512290955, gen p mean: -0.197219580411911, mean p set: 0.4476746618747711The modified gen p mean: 0.44755828380584717, gen p mean: -0.1975165605545044, mean p set: 0.4480930268764496
loss_pred:0.015182232484221458, decouple_loss:0.0023237995337694883
loss_pred:0.015541156753897667, decouple_loss:0.0023319702595472336
Iteration: 2435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473511874675751, gen p mean: -0.197405144572258, mean p set: 0.44792816042900085
loss_pred:0.014692651107907295, decouple_loss:0.003009763080626726
The modified gen p mean: 0.44723886251449585, gen p mean: -0.19724559783935547, mean p set: 0.4477651119232178The modified gen p mean: 0.4477657377719879, gen p mean: -0.19829420745372772, mean p set: 0.44834527373313904
loss_pred:0.015312213450670242, decouple_loss:0.002789746504276991loss_pred:0.01565014198422432, decouple_loss:0.0028727513272315264
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465867280960083, gen p mean: -0.2012375295162201, mean p set: 0.4471621811389923
loss_pred:0.014991933479905128, decouple_loss:0.002939694095402956
The modified gen p mean: 0.44552963972091675, gen p mean: -0.19689247012138367, mean p set: 0.4460587203502655The modified gen p mean: 0.4471783936023712, gen p mean: -0.20620197057724, mean p set: 0.44775745272636414
loss_pred:0.01510661095380783, decouple_loss:0.0024527539499104023
loss_pred:0.01496925950050354, decouple_loss:0.0028427629731595516
Iteration: 2437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475272595882416, gen p mean: -0.20455481112003326, mean p set: 0.44810402393341064
loss_pred:0.014826611615717411, decouple_loss:0.002457363996654749
The modified gen p mean: 0.4477695822715759, gen p mean: -0.20010684430599213, mean p set: 0.4483456313610077
loss_pred:0.014956983737647533, decouple_loss:0.002585531445220113
The modified gen p mean: 0.44660499691963196, gen p mean: -0.20125770568847656, mean p set: 0.44713273644447327
loss_pred:0.015088023617863655, decouple_loss:0.0026179912965744734
Iteration: 2438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459705948829651, gen p mean: -0.20360122621059418, mean p set: 0.4465450048446655
loss_pred:0.014984390698373318, decouple_loss:0.002626419300213456
The modified gen p mean: 0.4465333819389343, gen p mean: -0.20253974199295044, mean p set: 0.4471103250980377
loss_pred:0.015596910379827023, decouple_loss:0.0024635905865579844
The modified gen p mean: 0.44729089736938477, gen p mean: -0.20244856178760529, mean p set: 0.447822630405426
loss_pred:0.01498930063098669, decouple_loss:0.0025277805980294943
Iteration: 2439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723770022392273, gen p mean: -0.20049640536308289, mean p set: 0.4478101134300232
loss_pred:0.015103356912732124, decouple_loss:0.0023032589815557003
The modified gen p mean: 0.4485847055912018, gen p mean: -0.19935820996761322, mean p set: 0.449113667011261
The modified gen p mean: 0.4475623667240143, gen p mean: -0.20068052411079407, mean p set: 0.4481382668018341
loss_pred:0.014957516454160213, decouple_loss:0.002326641231775284
loss_pred:0.01530655287206173, decouple_loss:0.002510573249310255
Iteration: 2440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459410309791565, gen p mean: -0.19380757212638855, mean p set: 0.44651728868484497
loss_pred:0.01499974075704813, decouple_loss:0.0025816180277615786
The modified gen p mean: 0.44805046916007996, gen p mean: -0.19671176373958588, mean p set: 0.44857946038246155The modified gen p mean: 0.44715920090675354, gen p mean: -0.19686347246170044, mean p set: 0.44773492217063904
loss_pred:0.014845939353108406, decouple_loss:0.0025326432660222054
loss_pred:0.01466209813952446, decouple_loss:0.0026749144308269024
2023-04-27 09:54:42 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.19643926620483398, mean p set: 0.4499112665653229
loss_pred:0.016545355319976807, decouple_loss:0.0025060868356376886
The modified gen p mean: 0.44929832220077515, gen p mean: -0.19751062989234924, mean p set: 0.4498290419578552
loss_pred:0.016182085499167442, decouple_loss:0.0025058144237846136
The modified gen p mean: 0.44822123646736145, gen p mean: -0.19456064701080322, mean p set: 0.44879910349845886
loss_pred:0.016594059765338898, decouple_loss:0.002366027794778347
WV_1_PC_1_EH_0_PS_30, loss: 0.01656346581876278, avg_mse: 0.02447878010571003
current test mse: 0.024479
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 2441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775936007499695, gen p mean: -0.19779767096042633, mean p set: 0.44829073548316956
loss_pred:0.016319848597049713, decouple_loss:0.002701766323298216
The modified gen p mean: 0.44774866104125977, gen p mean: -0.19723741710186005, mean p set: 0.44831880927085876
loss_pred:0.01631338894367218, decouple_loss:0.00229827594012022
The modified gen p mean: 0.44880837202072144, gen p mean: -0.1936126947402954, mean p set: 0.44938814640045166
loss_pred:0.015913203358650208, decouple_loss:0.002655490068718791
Iteration: 2442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780561327934265, gen p mean: -0.19442901015281677, mean p set: 0.4483359158039093
loss_pred:0.01539659220725298, decouple_loss:0.002524932147935033
The modified gen p mean: 0.4487876892089844, gen p mean: -0.19840694963932037, mean p set: 0.44936102628707886
The modified gen p mean: 0.4478189945220947, gen p mean: -0.19427132606506348, mean p set: 0.44839873909950256
loss_pred:0.015033703297376633, decouple_loss:0.0027761433739215136
loss_pred:0.016011783853173256, decouple_loss:0.0026203831657767296
Iteration: 2443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487094283103943, gen p mean: -0.19825437664985657, mean p set: 0.4492388963699341
loss_pred:0.015505771152675152, decouple_loss:0.002565185772255063
The modified gen p mean: 0.4477158486843109, gen p mean: -0.2004813849925995, mean p set: 0.4482938349246979The modified gen p mean: 0.44714075326919556, gen p mean: -0.20272508263587952, mean p set: 0.447712779045105
loss_pred:0.015329357236623764, decouple_loss:0.0023253627587109804loss_pred:0.01554136723279953, decouple_loss:0.0024504452012479305
Iteration: 2444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479726552963257, gen p mean: -0.1993555873632431, mean p set: 0.4485013484954834
loss_pred:0.015871722251176834, decouple_loss:0.002825872041285038
The modified gen p mean: 0.44834983348846436, gen p mean: -0.19559922814369202, mean p set: 0.4489271342754364
The modified gen p mean: 0.44647541642189026, gen p mean: -0.20222364366054535, mean p set: 0.4470512866973877
loss_pred:0.015053973533213139, decouple_loss:0.0026348046958446503
loss_pred:0.015612974762916565, decouple_loss:0.002713918685913086
Iteration: 2445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480655789375305, gen p mean: -0.19709272682666779, mean p set: 0.44864311814308167
loss_pred:0.015342789702117443, decouple_loss:0.002568583469837904
The modified gen p mean: 0.4478699862957001, gen p mean: -0.19660480320453644, mean p set: 0.4484493136405945
loss_pred:0.015112629160284996, decouple_loss:0.002768194302916527
The modified gen p mean: 0.4475772976875305, gen p mean: -0.20080572366714478, mean p set: 0.44810402393341064
loss_pred:0.015199492685496807, decouple_loss:0.0028038981836289167
Iteration: 2446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869264960289, gen p mean: -0.20228147506713867, mean p set: 0.4492678940296173
loss_pred:0.015063161961734295, decouple_loss:0.002854326507076621
The modified gen p mean: 0.4466686546802521, gen p mean: -0.20084764063358307, mean p set: 0.44724538922309875
loss_pred:0.01607794314622879, decouple_loss:0.0028690507169812918
The modified gen p mean: 0.4471050202846527, gen p mean: -0.19483640789985657, mean p set: 0.4476318955421448
loss_pred:0.016050908714532852, decouple_loss:0.002549072029069066
Iteration: 2447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776269793510437, gen p mean: -0.20082834362983704, mean p set: 0.448335200548172
loss_pred:0.015230442397296429, decouple_loss:0.002657233737409115
The modified gen p mean: 0.44782039523124695, gen p mean: -0.20171327888965607, mean p set: 0.4483935534954071
loss_pred:0.015245222486555576, decouple_loss:0.002641197293996811
The modified gen p mean: 0.4473627805709839, gen p mean: -0.19827696681022644, mean p set: 0.447892427444458
loss_pred:0.016042139381170273, decouple_loss:0.002559003420174122
Iteration: 2448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786450266838074, gen p mean: -0.20093637704849243, mean p set: 0.4484356641769409
loss_pred:0.01561579667031765, decouple_loss:0.0024807339068502188
The modified gen p mean: 0.4460674524307251, gen p mean: -0.20359919965267181, mean p set: 0.44664737582206726
loss_pred:0.01579882763326168, decouple_loss:0.002184957033023238
The modified gen p mean: 0.4482761323451996, gen p mean: -0.19973249733448029, mean p set: 0.4488029479980469
loss_pred:0.015283705666661263, decouple_loss:0.0022368815261870623
Iteration: 2449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869428873062134, gen p mean: -0.20058469474315643, mean p set: 0.44927188754081726
loss_pred:0.015131507068872452, decouple_loss:0.002514316700398922
The modified gen p mean: 0.44743072986602783, gen p mean: -0.19939732551574707, mean p set: 0.44800689816474915
loss_pred:0.015469823032617569, decouple_loss:0.002328698756173253
The modified gen p mean: 0.44774553179740906, gen p mean: -0.199675515294075, mean p set: 0.4482678174972534
loss_pred:0.01551911886781454, decouple_loss:0.002657117322087288
Iteration: 2450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815772771835327, gen p mean: -0.1989474594593048, mean p set: 0.44872552156448364
loss_pred:0.015643086284399033, decouple_loss:0.002184234093874693
The modified gen p mean: 0.4473611116409302, gen p mean: -0.20395520329475403, mean p set: 0.4479339122772217
loss_pred:0.015687398612499237, decouple_loss:0.002163402270525694
The modified gen p mean: 0.448670357465744, gen p mean: -0.20192845165729523, mean p set: 0.44920313358306885
loss_pred:0.01530870608985424, decouple_loss:0.0023773745633661747
2023-04-27 09:58:45 testing...
The modified gen p mean: 0.4482208490371704, gen p mean: -0.1993696242570877, mean p set: 0.44879910349845886
loss_pred:0.01654984802007675, decouple_loss:0.003666035598143935
The modified gen p mean: 0.4494309425354004, gen p mean: -0.20116576552391052, mean p set: 0.4499112665653229
loss_pred:0.01651480421423912, decouple_loss:0.003351715160533786
The modified gen p mean: 0.44930151104927063, gen p mean: -0.20228876173496246, mean p set: 0.4498290419578552
loss_pred:0.016107533127069473, decouple_loss:0.003441711887717247
WV_1_PC_1_EH_0_PS_30, loss: 0.016565052792429924, avg_mse: 0.024365689605474472
current test mse: 0.024366
Iteration: 2451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473671317100525, gen p mean: -0.19832658767700195, mean p set: 0.4479440450668335
loss_pred:0.015529900789260864, decouple_loss:0.003747735871002078
The modified gen p mean: 0.44811713695526123, gen p mean: -0.201316699385643, mean p set: 0.44869464635849
loss_pred:0.01538083702325821, decouple_loss:0.0035626741591840982
The modified gen p mean: 0.4472818374633789, gen p mean: -0.1988871693611145, mean p set: 0.44781461358070374
loss_pred:0.015917612239718437, decouple_loss:0.0032344937790185213
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481922388076782, gen p mean: -0.20449069142341614, mean p set: 0.44871973991394043
loss_pred:0.015655746683478355, decouple_loss:0.0028857651632279158
The modified gen p mean: 0.4462718367576599, gen p mean: -0.20603430271148682, mean p set: 0.44685330986976624
loss_pred:0.015467471443116665, decouple_loss:0.0029726705979555845
The modified gen p mean: 0.4472641050815582, gen p mean: -0.20464149117469788, mean p set: 0.4478394687175751
loss_pred:0.01573990285396576, decouple_loss:0.0028828298673033714
Iteration: 2453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778087735176086, gen p mean: -0.1988629549741745, mean p set: 0.44831034541130066
loss_pred:0.01584300957620144, decouple_loss:0.003323571290820837
The modified gen p mean: 0.448438823223114, gen p mean: -0.1986284852027893, mean p set: 0.4490111172199249
loss_pred:0.015004348941147327, decouple_loss:0.002849941374734044
The modified gen p mean: 0.44811302423477173, gen p mean: -0.20115667581558228, mean p set: 0.4486865699291229
loss_pred:0.015412631444633007, decouple_loss:0.00326699111610651
Iteration: 2454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469830393791199, gen p mean: -0.198012575507164, mean p set: 0.4475124180316925
loss_pred:0.01550634577870369, decouple_loss:0.0030400510877370834
The modified gen p mean: 0.4479990005493164, gen p mean: -0.1934960037469864, mean p set: 0.44857192039489746
loss_pred:0.015935635194182396, decouple_loss:0.00301553076133132
The modified gen p mean: 0.4478866457939148, gen p mean: -0.19235816597938538, mean p set: 0.44845762848854065
loss_pred:0.014978921972215176, decouple_loss:0.0026372552383691072
Iteration: 2455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447727233171463, gen p mean: -0.1901473104953766, mean p set: 0.4483031630516052
loss_pred:0.01581355556845665, decouple_loss:0.002452127868309617
The modified gen p mean: 0.44765371084213257, gen p mean: -0.192389577627182, mean p set: 0.44823122024536133The modified gen p mean: 0.4480556547641754, gen p mean: -0.19605755805969238, mean p set: 0.44858577847480774
loss_pred:0.01558500062674284, decouple_loss:0.002414948306977749
loss_pred:0.01523940172046423, decouple_loss:0.002230812795460224
Iteration: 2456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485365152359009, gen p mean: -0.1970193088054657, mean p set: 0.44911372661590576
loss_pred:0.015442946925759315, decouple_loss:0.0023714115377515554
The modified gen p mean: 0.4482303261756897, gen p mean: -0.19341616332530975, mean p set: 0.4487583637237549The modified gen p mean: 0.4479353427886963, gen p mean: -0.19565652310848236, mean p set: 0.44850432872772217
loss_pred:0.015068589709699154, decouple_loss:0.0027046729810535908
loss_pred:0.015581296756863594, decouple_loss:0.0029820685740560293
Iteration: 2457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472038149833679, gen p mean: -0.2007252275943756, mean p set: 0.4477825164794922
loss_pred:0.015634622424840927, decouple_loss:0.002456553978845477
The modified gen p mean: 0.44796058535575867, gen p mean: -0.1950247883796692, mean p set: 0.44848933815956116
The modified gen p mean: 0.44821715354919434, gen p mean: -0.19782079756259918, mean p set: 0.44878846406936646
loss_pred:0.014850540086627007, decouple_loss:0.0028117310721427202
loss_pred:0.015203401446342468, decouple_loss:0.003150072181597352
Iteration: 2458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480288624763489, gen p mean: -0.2015381157398224, mean p set: 0.448603093624115
loss_pred:0.015496660955250263, decouple_loss:0.003055660519748926
The modified gen p mean: 0.4480707049369812, gen p mean: -0.19873367249965668, mean p set: 0.44864511489868164The modified gen p mean: 0.44757241010665894, gen p mean: -0.2015872597694397, mean p set: 0.4481017291545868
loss_pred:0.015236757695674896, decouple_loss:0.0028165203984826803
loss_pred:0.015043719671666622, decouple_loss:0.0030518309213221073
Iteration: 2459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477582275867462, gen p mean: -0.20287182927131653, mean p set: 0.4483374059200287
loss_pred:0.014982008375227451, decouple_loss:0.0031855562701821327
The modified gen p mean: 0.4469098150730133, gen p mean: -0.2035892754793167, mean p set: 0.44748347997665405
loss_pred:0.015347893349826336, decouple_loss:0.0026003392413258553
The modified gen p mean: 0.4480172395706177, gen p mean: -0.19740965962409973, mean p set: 0.4485422670841217
loss_pred:0.01575036346912384, decouple_loss:0.002435536589473486
Iteration: 2460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481305181980133, gen p mean: -0.19731546938419342, mean p set: 0.44870471954345703
loss_pred:0.01578456163406372, decouple_loss:0.0029347706586122513
The modified gen p mean: 0.4473157227039337, gen p mean: -0.19588437676429749, mean p set: 0.4478871822357178
loss_pred:0.01598023623228073, decouple_loss:0.002839262830093503
The modified gen p mean: 0.4468767046928406, gen p mean: -0.20366956293582916, mean p set: 0.44740280508995056
loss_pred:0.015195789746940136, decouple_loss:0.0030288679990917444
2023-04-27 10:02:10 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.19782596826553345, mean p set: 0.4499112665653229
loss_pred:0.016506126150488853, decouple_loss:0.0027135040145367384
The modified gen p mean: 0.4492993950843811, gen p mean: -0.1985142081975937, mean p set: 0.4498290419578552
loss_pred:0.0161543358117342, decouple_loss:0.002670804038643837
The modified gen p mean: 0.4482240080833435, gen p mean: -0.1958039402961731, mean p set: 0.44879910349845886
loss_pred:0.016550196334719658, decouple_loss:0.0028527621179819107
WV_1_PC_1_EH_0_PS_30, loss: 0.01654083840548992, avg_mse: 0.02441968396306038
current test mse: 0.02442
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 2461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465625584125519, gen p mean: -0.2018873542547226, mean p set: 0.4470933675765991
loss_pred:0.015123775228857994, decouple_loss:0.002591402269899845
The modified gen p mean: 0.44726452231407166, gen p mean: -0.1968257874250412, mean p set: 0.44784268736839294
loss_pred:0.015734508633613586, decouple_loss:0.0026294481940567493
The modified gen p mean: 0.44767501950263977, gen p mean: -0.19750435650348663, mean p set: 0.4482528567314148
loss_pred:0.014219658449292183, decouple_loss:0.002858710940927267
Iteration: 2462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817599654197693, gen p mean: -0.19774417579174042, mean p set: 0.4487045109272003
loss_pred:0.014661342836916447, decouple_loss:0.002637248719111085
The modified gen p mean: 0.4471803605556488, gen p mean: -0.18857529759407043, mean p set: 0.4477514326572418The modified gen p mean: 0.44803136587142944, gen p mean: -0.19507192075252533, mean p set: 0.4486044645309448
loss_pred:0.015639077872037888, decouple_loss:0.002498229034245014
loss_pred:0.014527594670653343, decouple_loss:0.003117590444162488
Iteration: 2463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791290163993835, gen p mean: -0.20630435645580292, mean p set: 0.44844159483909607
loss_pred:0.014383746311068535, decouple_loss:0.002645439002662897
The modified gen p mean: 0.44755321741104126, gen p mean: -0.19923986494541168, mean p set: 0.44812890887260437
loss_pred:0.01517408061772585, decouple_loss:0.003281837096437812
The modified gen p mean: 0.4472198486328125, gen p mean: -0.19497525691986084, mean p set: 0.4477945566177368
loss_pred:0.014976241625845432, decouple_loss:0.0024612457491457462
Iteration: 2464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763824343681335, gen p mean: -0.1966928094625473, mean p set: 0.44816192984580994
loss_pred:0.01408407837152481, decouple_loss:0.0026525987777858973
The modified gen p mean: 0.4489663243293762, gen p mean: -0.19741380214691162, mean p set: 0.4495420455932617The modified gen p mean: 0.44792640209198, gen p mean: -0.20273402333259583, mean p set: 0.4485073983669281
loss_pred:0.014195773750543594, decouple_loss:0.0030080396682024
loss_pred:0.014561817049980164, decouple_loss:0.002424940699711442
Iteration: 2465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736382365226746, gen p mean: -0.1972985565662384, mean p set: 0.44793590903282166
The modified gen p mean: 0.44683709740638733, gen p mean: -0.1992589831352234, mean p set: 0.4474125802516937
loss_pred:0.01460074819624424, decouple_loss:0.002736319089308381
loss_pred:0.01462576724588871, decouple_loss:0.002265095943585038
The modified gen p mean: 0.44812771677970886, gen p mean: -0.20103012025356293, mean p set: 0.44865697622299194
loss_pred:0.014754041098058224, decouple_loss:0.0024553819093853235
Iteration: 2466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446990042924881, gen p mean: -0.20669867098331451, mean p set: 0.4475710391998291
loss_pred:0.014230012893676758, decouple_loss:0.003008711850270629
The modified gen p mean: 0.44735756516456604, gen p mean: -0.20431777834892273, mean p set: 0.4479329288005829
loss_pred:0.014111173339188099, decouple_loss:0.0028720637783408165
The modified gen p mean: 0.44741809368133545, gen p mean: -0.20279674232006073, mean p set: 0.4479498863220215
loss_pred:0.014301248826086521, decouple_loss:0.0030326100531965494
Iteration: 2467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482804536819458, gen p mean: -0.20400549471378326, mean p set: 0.4488582909107208
loss_pred:0.01497048418968916, decouple_loss:0.00233925087377429
The modified gen p mean: 0.447020560503006, gen p mean: -0.20402714610099792, mean p set: 0.44759488105773926
loss_pred:0.01508235465735197, decouple_loss:0.002268511103466153
The modified gen p mean: 0.4475742280483246, gen p mean: -0.20751899480819702, mean p set: 0.4481014907360077
loss_pred:0.014468642883002758, decouple_loss:0.0022979644127190113
Iteration: 2468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802799820899963, gen p mean: -0.2112436443567276, mean p set: 0.44860297441482544
The modified gen p mean: 0.44726425409317017, gen p mean: -0.20279228687286377, mean p set: 0.44784215092658997loss_pred:0.01431902777403593, decouple_loss:0.0025498473551124334
loss_pred:0.014441451989114285, decouple_loss:0.0029539570678025484
The modified gen p mean: 0.44720664620399475, gen p mean: -0.2077087014913559, mean p set: 0.44773516058921814
loss_pred:0.015297448262572289, decouple_loss:0.002629450988024473
Iteration: 2469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855380058288574, gen p mean: -0.20582090318202972, mean p set: 0.449133038520813
The modified gen p mean: 0.44829052686691284, gen p mean: -0.2118290215730667, mean p set: 0.4488692879676819
loss_pred:0.014849045313894749, decouple_loss:0.0023826747201383114
loss_pred:0.015033408999443054, decouple_loss:0.002476203255355358
The modified gen p mean: 0.4484178125858307, gen p mean: -0.20726262032985687, mean p set: 0.44894084334373474
loss_pred:0.014514566399157047, decouple_loss:0.002611976582556963
Iteration: 2470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706130027770996, gen p mean: -0.2005702257156372, mean p set: 0.44763508439064026
The modified gen p mean: 0.44840261340141296, gen p mean: -0.2071162611246109, mean p set: 0.4489794969558716
loss_pred:0.014366631396114826, decouple_loss:0.002760967006906867
loss_pred:0.014929017052054405, decouple_loss:0.002951623173430562
The modified gen p mean: 0.44838398694992065, gen p mean: -0.2094074785709381, mean p set: 0.4489099383354187
loss_pred:0.014197858050465584, decouple_loss:0.0027889215853065252
2023-04-27 10:06:23 testing...
The modified gen p mean: 0.4482235610485077, gen p mean: -0.20301294326782227, mean p set: 0.44879910349845886
loss_pred:0.016680754721164703, decouple_loss:0.002507236087694764
The modified gen p mean: 0.44930803775787354, gen p mean: -0.20590873062610626, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.20536689460277557, mean p set: 0.4499112665653229loss_pred:0.01637098751962185, decouple_loss:0.0025416086427867413
loss_pred:0.016840925440192223, decouple_loss:0.0025928800459951162
WV_1_PC_1_EH_0_PS_30, loss: 0.016758251935243607, avg_mse: 0.024826936423778534
current test mse: 0.024827
Iteration: 2471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772690534591675, gen p mean: -0.20481710135936737, mean p set: 0.44825834035873413
loss_pred:0.014606529846787453, decouple_loss:0.0024479804560542107
The modified gen p mean: 0.447541207075119, gen p mean: -0.20933836698532104, mean p set: 0.44811877608299255
loss_pred:0.014337128028273582, decouple_loss:0.002519001020118594
The modified gen p mean: 0.447634756565094, gen p mean: -0.211241215467453, mean p set: 0.4482114315032959
loss_pred:0.014218471944332123, decouple_loss:0.002467245562002063
Iteration: 2472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746631383895874, gen p mean: -0.20612145960330963, mean p set: 0.4479990005493164
loss_pred:0.014275377616286278, decouple_loss:0.002550447126850486
The modified gen p mean: 0.4482836127281189, gen p mean: -0.20467893779277802, mean p set: 0.4488586187362671
The modified gen p mean: 0.44798415899276733, gen p mean: -0.20485560595989227, mean p set: 0.44856035709381104
loss_pred:0.014477497898042202, decouple_loss:0.0025642220862209797
loss_pred:0.014293639920651913, decouple_loss:0.002545248717069626
Iteration: 2473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481075406074524, gen p mean: -0.20708701014518738, mean p set: 0.4486351013183594
loss_pred:0.014290396124124527, decouple_loss:0.0024655621964484453
The modified gen p mean: 0.4483991861343384, gen p mean: -0.21406415104866028, mean p set: 0.4489799737930298
The modified gen p mean: 0.4485010504722595, gen p mean: -0.20509925484657288, mean p set: 0.4490780532360077
loss_pred:0.014973760582506657, decouple_loss:0.0026410261634737253
loss_pred:0.014392423443496227, decouple_loss:0.0024487373884767294
Iteration: 2474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720566272735596, gen p mean: -0.20447681844234467, mean p set: 0.44777724146842957
loss_pred:0.015432284213602543, decouple_loss:0.002424101112410426
The modified gen p mean: 0.4484662413597107, gen p mean: -0.2059532105922699, mean p set: 0.4489966928958893The modified gen p mean: 0.4472041726112366, gen p mean: -0.20585940778255463, mean p set: 0.4477807283401489
loss_pred:0.014769593253731728, decouple_loss:0.002412323607131839
loss_pred:0.015290765091776848, decouple_loss:0.0023380275815725327
Iteration: 2475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482818841934204, gen p mean: -0.2085358202457428, mean p set: 0.4488556683063507
loss_pred:0.014834866859018803, decouple_loss:0.0029490385204553604
The modified gen p mean: 0.44847938418388367, gen p mean: -0.2098347395658493, mean p set: 0.44905373454093933
loss_pred:0.01486353948712349, decouple_loss:0.0024092858657240868
The modified gen p mean: 0.44790858030319214, gen p mean: -0.20715568959712982, mean p set: 0.4484385848045349
loss_pred:0.01437804289162159, decouple_loss:0.0027297816704958677
Iteration: 2476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928988814353943, gen p mean: -0.2027871161699295, mean p set: 0.4498658776283264
loss_pred:0.014567727223038673, decouple_loss:0.002657565986737609
The modified gen p mean: 0.447904109954834, gen p mean: -0.21531298756599426, mean p set: 0.44843214750289917The modified gen p mean: 0.44805318117141724, gen p mean: -0.20793789625167847, mean p set: 0.4486263692378998
loss_pred:0.014973834156990051, decouple_loss:0.002348083769902587
loss_pred:0.01446627639234066, decouple_loss:0.0022413909900933504
Iteration: 2477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480130970478058, gen p mean: -0.20824483036994934, mean p set: 0.4485870599746704
loss_pred:0.014145116321742535, decouple_loss:0.0024806291330605745
The modified gen p mean: 0.44863682985305786, gen p mean: -0.20398788154125214, mean p set: 0.44921019673347473
loss_pred:0.014815186150372028, decouple_loss:0.0023766448721289635
The modified gen p mean: 0.4487305283546448, gen p mean: -0.20318956673145294, mean p set: 0.4492571949958801
loss_pred:0.014247559010982513, decouple_loss:0.0025395078118890524
Iteration: 2478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492211937904358, gen p mean: -0.19895091652870178, mean p set: 0.4497953951358795
loss_pred:0.014657261781394482, decouple_loss:0.002471941290423274
The modified gen p mean: 0.44750863313674927, gen p mean: -0.1961735337972641, mean p set: 0.44803711771965027The modified gen p mean: 0.44893208146095276, gen p mean: -0.1990233063697815, mean p set: 0.4495067000389099
loss_pred:0.013646806590259075, decouple_loss:0.0026581534184515476
loss_pred:0.01535793486982584, decouple_loss:0.0023559287656098604
Iteration: 2479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479355216026306, gen p mean: -0.2017364799976349, mean p set: 0.4485081434249878
loss_pred:0.014797900803387165, decouple_loss:0.0023624910973012447
The modified gen p mean: 0.4471927583217621, gen p mean: -0.20500724017620087, mean p set: 0.44776979088783264
loss_pred:0.014248724095523357, decouple_loss:0.002198018366470933
The modified gen p mean: 0.4474557638168335, gen p mean: -0.19860240817070007, mean p set: 0.44798383116722107
loss_pred:0.015701135620474815, decouple_loss:0.0022810969967395067
Iteration: 2480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482487440109253, gen p mean: -0.2077530324459076, mean p set: 0.4488280117511749
loss_pred:0.014796377159655094, decouple_loss:0.0025901487097144127
The modified gen p mean: 0.44713857769966125, gen p mean: -0.20384499430656433, mean p set: 0.44771671295166016
loss_pred:0.015048179775476456, decouple_loss:0.0029780694749206305
The modified gen p mean: 0.4482828378677368, gen p mean: -0.20893928408622742, mean p set: 0.4488038718700409
loss_pred:0.014015518128871918, decouple_loss:0.002740158699452877
2023-04-27 10:09:47 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.20864342153072357, mean p set: 0.4499112665653229
loss_pred:0.01678619533777237, decouple_loss:0.0024376953952014446
The modified gen p mean: 0.44930535554885864, gen p mean: -0.2094505876302719, mean p set: 0.4498290419578552
loss_pred:0.016308603808283806, decouple_loss:0.002382647478953004
The modified gen p mean: 0.44822484254837036, gen p mean: -0.20668520033359528, mean p set: 0.44879910349845886
loss_pred:0.01665574312210083, decouple_loss:0.0024454190861433744
WV_1_PC_1_EH_0_PS_30, loss: 0.016704611480236053, avg_mse: 0.024707935750484467
current test mse: 0.024708
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 2481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477596580982208, gen p mean: -0.21064698696136475, mean p set: 0.4482913017272949
loss_pred:0.01533187460154295, decouple_loss:0.0024366648867726326
The modified gen p mean: 0.448082834482193, gen p mean: -0.21164105832576752, mean p set: 0.4486584961414337
loss_pred:0.015328686684370041, decouple_loss:0.0023144406732171774
The modified gen p mean: 0.4478684961795807, gen p mean: -0.21157871186733246, mean p set: 0.4484470784664154
loss_pred:0.01567852310836315, decouple_loss:0.00229422259144485
Iteration: 2482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881075620651245, gen p mean: -0.21349407732486725, mean p set: 0.44933852553367615
loss_pred:0.015615968033671379, decouple_loss:0.0026942496187984943
The modified gen p mean: 0.4475021958351135, gen p mean: -0.2095409333705902, mean p set: 0.44808098673820496
The modified gen p mean: 0.4480142295360565, gen p mean: -0.21088244020938873, mean p set: 0.44858697056770325
loss_pred:0.01569485291838646, decouple_loss:0.0025556127075105906
loss_pred:0.01543383114039898, decouple_loss:0.002618602477014065
Iteration: 2483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642338156700134, gen p mean: -0.2084585279226303, mean p set: 0.44695523381233215
loss_pred:0.015173731371760368, decouple_loss:0.002638196339830756
The modified gen p mean: 0.445998877286911, gen p mean: -0.20674163103103638, mean p set: 0.4465752840042114
The modified gen p mean: 0.44658327102661133, gen p mean: -0.21274499595165253, mean p set: 0.44715940952301025
loss_pred:0.015583239495754242, decouple_loss:0.0027683896478265524
loss_pred:0.015727872028946877, decouple_loss:0.003013145411387086
Iteration: 2484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666504859924316, gen p mean: -0.2105679214000702, mean p set: 0.4471926689147949
loss_pred:0.0154038667678833, decouple_loss:0.002530868863686919
The modified gen p mean: 0.4472331404685974, gen p mean: -0.21790757775306702, mean p set: 0.4478095471858978
The modified gen p mean: 0.44807782769203186, gen p mean: -0.21270158886909485, mean p set: 0.44865259528160095
loss_pred:0.015397395938634872, decouple_loss:0.0027611597906798124
loss_pred:0.015012559480965137, decouple_loss:0.0030585837084800005
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667506217956543, gen p mean: -0.20736965537071228, mean p set: 0.447246253490448
loss_pred:0.014861127361655235, decouple_loss:0.0028354316018521786
The modified gen p mean: 0.4467722475528717, gen p mean: -0.215338796377182, mean p set: 0.4473038911819458The modified gen p mean: 0.44874778389930725, gen p mean: -0.21413204073905945, mean p set: 0.44931700825691223
loss_pred:0.015118631534278393, decouple_loss:0.0026052410248667loss_pred:0.015328598208725452, decouple_loss:0.0031250847969204187
Iteration: 2486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462312161922455, gen p mean: -0.20788362622261047, mean p set: 0.44680535793304443
loss_pred:0.014799688011407852, decouple_loss:0.0025133301969617605
The modified gen p mean: 0.4468264877796173, gen p mean: -0.21171696484088898, mean p set: 0.4473998546600342The modified gen p mean: 0.44853100180625916, gen p mean: -0.21375404298305511, mean p set: 0.4490543007850647
loss_pred:0.01486967597156763, decouple_loss:0.002453122055158019
loss_pred:0.015615567564964294, decouple_loss:0.002970363711938262
Iteration: 2487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469562768936157, gen p mean: -0.2148633599281311, mean p set: 0.44752782583236694
loss_pred:0.015515252016484737, decouple_loss:0.003071065526455641
The modified gen p mean: 0.4473012089729309, gen p mean: -0.20717433094978333, mean p set: 0.44787678122520447
loss_pred:0.015655510127544403, decouple_loss:0.002859319793060422
The modified gen p mean: 0.4457245469093323, gen p mean: -0.20964686572551727, mean p set: 0.44625577330589294
loss_pred:0.015257171355187893, decouple_loss:0.003350662998855114
Iteration: 2488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479087293148041, gen p mean: -0.21598373353481293, mean p set: 0.448486864566803
loss_pred:0.015558580867946148, decouple_loss:0.002795193577185273
The modified gen p mean: 0.44725582003593445, gen p mean: -0.21468991041183472, mean p set: 0.4478280544281006
loss_pred:0.015134693123400211, decouple_loss:0.0026305511128157377
The modified gen p mean: 0.4462021589279175, gen p mean: -0.2141033262014389, mean p set: 0.44673389196395874
loss_pred:0.015045617707073689, decouple_loss:0.0026850306894630194
Iteration: 2489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459002912044525, gen p mean: -0.20573440194129944, mean p set: 0.44647401571273804
loss_pred:0.015370460227131844, decouple_loss:0.002586489310488105
The modified gen p mean: 0.4474109411239624, gen p mean: -0.21938276290893555, mean p set: 0.44794052839279175The modified gen p mean: 0.44712087512016296, gen p mean: -0.21031475067138672, mean p set: 0.4476941227912903
loss_pred:0.015499292872846127, decouple_loss:0.0022991453297436237
loss_pred:0.015073675662279129, decouple_loss:0.0024477201513946056
Iteration: 2490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451674222946167, gen p mean: -0.2180495262145996, mean p set: 0.44573795795440674
loss_pred:0.015245242975652218, decouple_loss:0.0024289381690323353
The modified gen p mean: 0.4473981559276581, gen p mean: -0.21322262287139893, mean p set: 0.4479255974292755The modified gen p mean: 0.44869551062583923, gen p mean: -0.21512240171432495, mean p set: 0.44927704334259033
loss_pred:0.015324682928621769, decouple_loss:0.0031359530985355377
loss_pred:0.015463319607079029, decouple_loss:0.0028328844346106052
2023-04-27 10:13:54 testing...
The modified gen p mean: 0.4482283890247345, gen p mean: -0.21056748926639557, mean p set: 0.44879910349845886
loss_pred:0.016431020572781563, decouple_loss:0.0026883825194090605
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21284155547618866, mean p set: 0.4499112665653229
loss_pred:0.016533227637410164, decouple_loss:0.002795581705868244
The modified gen p mean: 0.4493046700954437, gen p mean: -0.21360206604003906, mean p set: 0.4498290419578552
loss_pred:0.016118112951517105, decouple_loss:0.002716007409617305
WV_1_PC_1_EH_0_PS_30, loss: 0.016497453674674034, avg_mse: 0.02436615526676178
current test mse: 0.024366
Iteration: 2491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44611215591430664, gen p mean: -0.21252192556858063, mean p set: 0.44668781757354736
loss_pred:0.015901634469628334, decouple_loss:0.002520269714295864
The modified gen p mean: 0.44655027985572815, gen p mean: -0.21216298639774323, mean p set: 0.44712045788764954
loss_pred:0.015060282312333584, decouple_loss:0.002656538039445877
The modified gen p mean: 0.44815078377723694, gen p mean: -0.214066281914711, mean p set: 0.44868341088294983
loss_pred:0.015167251229286194, decouple_loss:0.0024666597601026297
Iteration: 2492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490000605583191, gen p mean: -0.22306562960147858, mean p set: 0.44952791929244995
loss_pred:0.015006156638264656, decouple_loss:0.0024645584635436535
The modified gen p mean: 0.4465252459049225, gen p mean: -0.22455334663391113, mean p set: 0.4471011161804199
loss_pred:0.015658317133784294, decouple_loss:0.0025603664107620716
The modified gen p mean: 0.4455855190753937, gen p mean: -0.2239314466714859, mean p set: 0.4461652636528015
loss_pred:0.015528053976595402, decouple_loss:0.002469861414283514
Iteration: 2493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466482102870941, gen p mean: -0.22111745178699493, mean p set: 0.4471711814403534
loss_pred:0.015156669542193413, decouple_loss:0.0024745771661400795
The modified gen p mean: 0.44558027386665344, gen p mean: -0.22675348818302155, mean p set: 0.4461599588394165
loss_pred:0.01595497503876686, decouple_loss:0.0025521668139845133
The modified gen p mean: 0.44635581970214844, gen p mean: -0.21985217928886414, mean p set: 0.4469289183616638
loss_pred:0.015122578479349613, decouple_loss:0.0024397994857281446
Iteration: 2494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482502043247223, gen p mean: -0.21763555705547333, mean p set: 0.4487825632095337
loss_pred:0.015235165134072304, decouple_loss:0.0022485011722892523
The modified gen p mean: 0.44849473237991333, gen p mean: -0.2198193520307541, mean p set: 0.44907623529434204
loss_pred:0.01571195386350155, decouple_loss:0.0025377008132636547
The modified gen p mean: 0.44572705030441284, gen p mean: -0.21450413763523102, mean p set: 0.44630685448646545
loss_pred:0.01553289219737053, decouple_loss:0.002355891978368163
Iteration: 2495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742029905319214, gen p mean: -0.22279830276966095, mean p set: 0.44799599051475525
loss_pred:0.014560298062860966, decouple_loss:0.0025130929425358772
The modified gen p mean: 0.4475432336330414, gen p mean: -0.21903377771377563, mean p set: 0.448073148727417The modified gen p mean: 0.4463134706020355, gen p mean: -0.21804161369800568, mean p set: 0.44689324498176575
loss_pred:0.015260191634297371, decouple_loss:0.0025212918408215046loss_pred:0.015711508691310883, decouple_loss:0.0026270949747413397
Iteration: 2496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451906681060791, gen p mean: -0.22291739284992218, mean p set: 0.4457697868347168
loss_pred:0.015390033833682537, decouple_loss:0.0023125694133341312
The modified gen p mean: 0.4467312693595886, gen p mean: -0.21878261864185333, mean p set: 0.44725558161735535The modified gen p mean: 0.44616711139678955, gen p mean: -0.2151520997285843, mean p set: 0.4467402696609497
loss_pred:0.01565590873360634, decouple_loss:0.0023123598657548428
loss_pred:0.015294346027076244, decouple_loss:0.0024039780255407095
Iteration: 2497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678086042404175, gen p mean: -0.21997728943824768, mean p set: 0.4473665952682495
loss_pred:0.015337547287344933, decouple_loss:0.002383751794695854
The modified gen p mean: 0.446050226688385, gen p mean: -0.2133955955505371, mean p set: 0.4466271698474884
loss_pred:0.015052355825901031, decouple_loss:0.002501864219084382
The modified gen p mean: 0.44598865509033203, gen p mean: -0.2156478762626648, mean p set: 0.44651132822036743
loss_pred:0.015810497105121613, decouple_loss:0.0023854428436607122
Iteration: 2498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44637346267700195, gen p mean: -0.2179177850484848, mean p set: 0.44694921374320984
loss_pred:0.015211675316095352, decouple_loss:0.002230067504569888
The modified gen p mean: 0.4472486674785614, gen p mean: -0.2169240564107895, mean p set: 0.44782623648643494
loss_pred:0.014909572899341583, decouple_loss:0.002410647226497531
The modified gen p mean: 0.4468306005001068, gen p mean: -0.21824683248996735, mean p set: 0.4473566710948944
loss_pred:0.014771798625588417, decouple_loss:0.0022546444088220596
Iteration: 2499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737672805786133, gen p mean: -0.22238372266292572, mean p set: 0.447951078414917
loss_pred:0.014834043569862843, decouple_loss:0.0025656824000179768
The modified gen p mean: 0.4458361268043518, gen p mean: -0.2179439812898636, mean p set: 0.4464118480682373
loss_pred:0.015744086354970932, decouple_loss:0.0023365879897028208
The modified gen p mean: 0.4462278187274933, gen p mean: -0.21933408081531525, mean p set: 0.44675159454345703
loss_pred:0.015125357545912266, decouple_loss:0.0023449005093425512
Iteration: 2500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44620785117149353, gen p mean: -0.21634361147880554, mean p set: 0.4467838406562805
loss_pred:0.014883363619446754, decouple_loss:0.0021958535071462393
The modified gen p mean: 0.44577497243881226, gen p mean: -0.21682600677013397, mean p set: 0.44630563259124756The modified gen p mean: 0.44717273116111755, gen p mean: -0.2223488986492157, mean p set: 0.4477439522743225
loss_pred:0.014826474711298943, decouple_loss:0.002318304032087326
loss_pred:0.014757450670003891, decouple_loss:0.002400130033493042
2023-04-27 10:17:19 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21513159573078156, mean p set: 0.4499112665653229
loss_pred:0.01644200086593628, decouple_loss:0.0021268560085445642
The modified gen p mean: 0.44929584860801697, gen p mean: -0.215877503156662, mean p set: 0.4498290419578552
loss_pred:0.016077857464551926, decouple_loss:0.002067389665171504
The modified gen p mean: 0.44821807742118835, gen p mean: -0.2129548341035843, mean p set: 0.44879910349845886
loss_pred:0.01643427275121212, decouple_loss:0.002063937019556761
WV_1_PC_1_EH_0_PS_30, loss: 0.016422346234321594, avg_mse: 0.024251766502857208
current test mse: 0.024252
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 2501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731178879737854, gen p mean: -0.21392929553985596, mean p set: 0.4478378891944885
loss_pred:0.01455671712756157, decouple_loss:0.0021462005097419024
The modified gen p mean: 0.4482303261756897, gen p mean: -0.2211381494998932, mean p set: 0.44880568981170654
loss_pred:0.014821844175457954, decouple_loss:0.002255614846944809
The modified gen p mean: 0.4474286735057831, gen p mean: -0.21809759736061096, mean p set: 0.44800394773483276
loss_pred:0.01506749913096428, decouple_loss:0.002329048002138734
Iteration: 2502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468492269515991, gen p mean: -0.2116985321044922, mean p set: 0.4473787844181061
loss_pred:0.01498520839959383, decouple_loss:0.0026371951680630445
The modified gen p mean: 0.4470096230506897, gen p mean: -0.2202211320400238, mean p set: 0.44758692383766174
The modified gen p mean: 0.4471101760864258, gen p mean: -0.2151043564081192, mean p set: 0.44768473505973816
loss_pred:0.015744071453809738, decouple_loss:0.0023768064565956593
loss_pred:0.01512205135077238, decouple_loss:0.0025034307036548853
Iteration: 2503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471680521965027, gen p mean: -0.21928200125694275, mean p set: 0.4477013349533081
loss_pred:0.015282548032701015, decouple_loss:0.002465947763994336
The modified gen p mean: 0.44663646817207336, gen p mean: -0.21512863039970398, mean p set: 0.4472118318080902
The modified gen p mean: 0.4465760588645935, gen p mean: -0.21067464351654053, mean p set: 0.4471501410007477
loss_pred:0.014847379177808762, decouple_loss:0.002416352741420269
loss_pred:0.015032468363642693, decouple_loss:0.0025580956134945154
Iteration: 2504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491327106952667, gen p mean: -0.20994411408901215, mean p set: 0.44966015219688416
loss_pred:0.014174303971230984, decouple_loss:0.002274231519550085
The modified gen p mean: 0.4476158916950226, gen p mean: -0.2133682519197464, mean p set: 0.4481918513774872
The modified gen p mean: 0.448032945394516, gen p mean: -0.2162054032087326, mean p set: 0.44860947132110596
loss_pred:0.014475827105343342, decouple_loss:0.0023166334722191095
loss_pred:0.014503625221550465, decouple_loss:0.0021747606806457043
Iteration: 2505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485745429992676, gen p mean: -0.21834684908390045, mean p set: 0.4491487443447113
loss_pred:0.014277402311563492, decouple_loss:0.002289571799337864
The modified gen p mean: 0.4488375186920166, gen p mean: -0.2162514477968216, mean p set: 0.44941452145576477
loss_pred:0.01464319508522749, decouple_loss:0.00252861762419343
The modified gen p mean: 0.44777369499206543, gen p mean: -0.21448765695095062, mean p set: 0.44830429553985596
loss_pred:0.014367717318236828, decouple_loss:0.0022217899095267057
Iteration: 2506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781047105789185, gen p mean: -0.21983535587787628, mean p set: 0.4483886957168579
loss_pred:0.014805416576564312, decouple_loss:0.0023932133335620165
The modified gen p mean: 0.44712942838668823, gen p mean: -0.21359913051128387, mean p set: 0.44770386815071106
loss_pred:0.014909734949469566, decouple_loss:0.002421960700303316
The modified gen p mean: 0.44807296991348267, gen p mean: -0.21681095659732819, mean p set: 0.4486064314842224
loss_pred:0.014369110576808453, decouple_loss:0.0024073163513094187
Iteration: 2507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44655340909957886, gen p mean: -0.21870458126068115, mean p set: 0.4471273422241211
loss_pred:0.015310279093682766, decouple_loss:0.002173745771870017
The modified gen p mean: 0.448026180267334, gen p mean: -0.21557645499706268, mean p set: 0.4486024081707001The modified gen p mean: 0.446847528219223, gen p mean: -0.21849854290485382, mean p set: 0.44737890362739563
loss_pred:0.014694337733089924, decouple_loss:0.002347649075090885
loss_pred:0.014873643405735493, decouple_loss:0.0022943641524761915
Iteration: 2508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483949840068817, gen p mean: -0.2118593454360962, mean p set: 0.44896969199180603
loss_pred:0.014571908861398697, decouple_loss:0.0023219436407089233
The modified gen p mean: 0.4465169906616211, gen p mean: -0.2111000418663025, mean p set: 0.4470519721508026The modified gen p mean: 0.4475068747997284, gen p mean: -0.21343304216861725, mean p set: 0.448081910610199
loss_pred:0.015124363824725151, decouple_loss:0.002594243735074997
loss_pred:0.01478644460439682, decouple_loss:0.002077061915770173
Iteration: 2509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483942985534668, gen p mean: -0.21136368811130524, mean p set: 0.44897186756134033
loss_pred:0.014387210831046104, decouple_loss:0.002485675271600485
The modified gen p mean: 0.44800737500190735, gen p mean: -0.21588927507400513, mean p set: 0.44853144884109497The modified gen p mean: 0.4483087956905365, gen p mean: -0.2064567506313324, mean p set: 0.44888588786125183
loss_pred:0.014417939819395542, decouple_loss:0.0024838754907250404
loss_pred:0.014701868407428265, decouple_loss:0.0023269394878298044
Iteration: 2510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874894618988037, gen p mean: -0.209873765707016, mean p set: 0.449325829744339
loss_pred:0.013670915737748146, decouple_loss:0.0022336875554174185
The modified gen p mean: 0.4477771818637848, gen p mean: -0.2108132690191269, mean p set: 0.44830334186553955The modified gen p mean: 0.4470492899417877, gen p mean: -0.20995336771011353, mean p set: 0.44762441515922546
loss_pred:0.01445006113499403, decouple_loss:0.0023696869611740112
loss_pred:0.01506838109344244, decouple_loss:0.0022406477946788073
2023-04-27 10:21:21 testing...
The modified gen p mean: 0.44821876287460327, gen p mean: -0.20986203849315643, mean p set: 0.44879910349845886
loss_pred:0.016631312668323517, decouple_loss:0.002285885624587536
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2119632214307785, mean p set: 0.4499112665653229
loss_pred:0.016752425581216812, decouple_loss:0.0023209473583847284
The modified gen p mean: 0.4492988586425781, gen p mean: -0.2127695381641388, mean p set: 0.4498290419578552
loss_pred:0.016218136996030807, decouple_loss:0.002390526235103607
WV_1_PC_1_EH_0_PS_30, loss: 0.016650579869747162, avg_mse: 0.024629848077893257
current test mse: 0.02463
Iteration: 2511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473637640476227, gen p mean: -0.21623679995536804, mean p set: 0.44789108633995056
loss_pred:0.015251698903739452, decouple_loss:0.0025647636502981186
The modified gen p mean: 0.4470868706703186, gen p mean: -0.2089126855134964, mean p set: 0.4476620554924011
loss_pred:0.014828241430222988, decouple_loss:0.002381199738010764
The modified gen p mean: 0.4470672607421875, gen p mean: -0.21493174135684967, mean p set: 0.4476398825645447
loss_pred:0.014903165400028229, decouple_loss:0.002335424767807126
Iteration: 2512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712352752685547, gen p mean: -0.21531039476394653, mean p set: 0.4476523995399475
loss_pred:0.015008462592959404, decouple_loss:0.002429116750136018
The modified gen p mean: 0.44808539748191833, gen p mean: -0.20974762737751007, mean p set: 0.44866064190864563
The modified gen p mean: 0.44737619161605835, gen p mean: -0.2126561552286148, mean p set: 0.44794946908950806
loss_pred:0.014816539362072945, decouple_loss:0.0023067656438797712
loss_pred:0.01445757132023573, decouple_loss:0.0025207737926393747
Iteration: 2513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718214869499207, gen p mean: -0.20848868787288666, mean p set: 0.4477090537548065
loss_pred:0.014426101930439472, decouple_loss:0.0022523258812725544
The modified gen p mean: 0.44765838980674744, gen p mean: -0.21294128894805908, mean p set: 0.4482389986515045
The modified gen p mean: 0.4483390152454376, gen p mean: -0.21114100515842438, mean p set: 0.448910653591156
loss_pred:0.014447386376559734, decouple_loss:0.0021794752683490515
loss_pred:0.013966000638902187, decouple_loss:0.0024565381463617086
Iteration: 2514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467621445655823, gen p mean: -0.2135024070739746, mean p set: 0.4473388195037842
loss_pred:0.014475072734057903, decouple_loss:0.0021940639708191156
The modified gen p mean: 0.44867265224456787, gen p mean: -0.21014393866062164, mean p set: 0.44924864172935486
loss_pred:0.013834677636623383, decouple_loss:0.0023794325534254313
The modified gen p mean: 0.4468953609466553, gen p mean: -0.2066606879234314, mean p set: 0.447422593832016
loss_pred:0.01475578173995018, decouple_loss:0.0022543752565979958
Iteration: 2515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44635698199272156, gen p mean: -0.21281671524047852, mean p set: 0.4469318985939026
loss_pred:0.015516750514507294, decouple_loss:0.002322545973584056
The modified gen p mean: 0.4475843906402588, gen p mean: -0.2122560441493988, mean p set: 0.4481172263622284The modified gen p mean: 0.44742220640182495, gen p mean: -0.21206846833229065, mean p set: 0.4479982852935791
loss_pred:0.015028013847768307, decouple_loss:0.0023641351144760847loss_pred:0.014188314788043499, decouple_loss:0.002209280850365758
Iteration: 2516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768422842025757, gen p mean: -0.20601698756217957, mean p set: 0.4482576549053192
loss_pred:0.014731395989656448, decouple_loss:0.0022273024078458548
The modified gen p mean: 0.44694527983665466, gen p mean: -0.20852813124656677, mean p set: 0.4474763870239258The modified gen p mean: 0.44717979431152344, gen p mean: -0.20558971166610718, mean p set: 0.4477570950984955
loss_pred:0.014791063033044338, decouple_loss:0.0021905750036239624
loss_pred:0.014776794239878654, decouple_loss:0.00226890342310071
Iteration: 2517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725802540779114, gen p mean: -0.2134329080581665, mean p set: 0.44783034920692444
loss_pred:0.014706096611917019, decouple_loss:0.0023153487127274275
The modified gen p mean: 0.44853076338768005, gen p mean: -0.20975232124328613, mean p set: 0.4490576982498169The modified gen p mean: 0.44794532656669617, gen p mean: -0.20947609841823578, mean p set: 0.4485197067260742
loss_pred:0.014270463958382607, decouple_loss:0.002331389347091317
loss_pred:0.013897397555410862, decouple_loss:0.0022990088909864426
Iteration: 2518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447983980178833, gen p mean: -0.2094915211200714, mean p set: 0.4485662877559662
loss_pred:0.014416641555726528, decouple_loss:0.0025831398088485003
The modified gen p mean: 0.44712570309638977, gen p mean: -0.2075493186712265, mean p set: 0.4477039873600006
loss_pred:0.01404380239546299, decouple_loss:0.0021666474640369415
The modified gen p mean: 0.44792020320892334, gen p mean: -0.20990008115768433, mean p set: 0.448443204164505
loss_pred:0.014376414939761162, decouple_loss:0.0023932268377393484
Iteration: 2519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470202922821045, gen p mean: -0.20943008363246918, mean p set: 0.44759440422058105
loss_pred:0.014419062994420528, decouple_loss:0.002011885866522789
The modified gen p mean: 0.4481164813041687, gen p mean: -0.20556603372097015, mean p set: 0.44869139790534973The modified gen p mean: 0.447957843542099, gen p mean: -0.203218013048172, mean p set: 0.448486864566803
loss_pred:0.01423624623566866, decouple_loss:0.0021760191302746534
loss_pred:0.014363081194460392, decouple_loss:0.0020519536919891834
Iteration: 2520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742515683174133, gen p mean: -0.20367170870304108, mean p set: 0.44800183176994324
loss_pred:0.01481141522526741, decouple_loss:0.0024779513478279114
The modified gen p mean: 0.4477270543575287, gen p mean: -0.20592807233333588, mean p set: 0.448304146528244
loss_pred:0.01456830371171236, decouple_loss:0.0024757215287536383
The modified gen p mean: 0.44821038842201233, gen p mean: -0.210226371884346, mean p set: 0.4487426280975342
loss_pred:0.014733557589352131, decouple_loss:0.002386654494330287
2023-04-27 10:24:45 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.20390863716602325, mean p set: 0.4499112665653229
loss_pred:0.016780298203229904, decouple_loss:0.002444029087200761
The modified gen p mean: 0.4492989182472229, gen p mean: -0.20461112260818481, mean p set: 0.4498290419578552
loss_pred:0.016237031668424606, decouple_loss:0.0023232686799019575
The modified gen p mean: 0.44822394847869873, gen p mean: -0.20167754590511322, mean p set: 0.44879910349845886
loss_pred:0.016610149294137955, decouple_loss:0.0023319111205637455
WV_1_PC_1_EH_0_PS_30, loss: 0.016660815104842186, avg_mse: 0.024656105786561966
current test mse: 0.024656
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 2521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473738372325897, gen p mean: -0.20472732186317444, mean p set: 0.4479471743106842
loss_pred:0.01575741171836853, decouple_loss:0.0022552013397216797
The modified gen p mean: 0.44818222522735596, gen p mean: -0.2023652195930481, mean p set: 0.4487118422985077
loss_pred:0.014795668423175812, decouple_loss:0.002264325274154544
The modified gen p mean: 0.44715574383735657, gen p mean: -0.2053421586751938, mean p set: 0.4477352201938629
loss_pred:0.015923788771033287, decouple_loss:0.002294720383360982
Iteration: 2522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480525255203247, gen p mean: -0.20427682995796204, mean p set: 0.4485728442668915
loss_pred:0.015340231359004974, decouple_loss:0.0024917200207710266
The modified gen p mean: 0.4475466012954712, gen p mean: -0.2073940485715866, mean p set: 0.44812464714050293
The modified gen p mean: 0.4477074444293976, gen p mean: -0.20000769197940826, mean p set: 0.4482816159725189
loss_pred:0.015354177914559841, decouple_loss:0.0025813926476985216
loss_pred:0.015511260367929935, decouple_loss:0.0022663893178105354
Iteration: 2523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478415846824646, gen p mean: -0.20460836589336395, mean p set: 0.44837021827697754
loss_pred:0.015404030680656433, decouple_loss:0.0020487757865339518
The modified gen p mean: 0.4471554160118103, gen p mean: -0.20217430591583252, mean p set: 0.4477280378341675
The modified gen p mean: 0.44759437441825867, gen p mean: -0.20586217939853668, mean p set: 0.44816744327545166
loss_pred:0.015446705743670464, decouple_loss:0.002003870438784361
loss_pred:0.015547357499599457, decouple_loss:0.002096602227538824
Iteration: 2524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476728141307831, gen p mean: -0.20991016924381256, mean p set: 0.44820475578308105
loss_pred:0.015665961429476738, decouple_loss:0.0022950165439397097
The modified gen p mean: 0.44713687896728516, gen p mean: -0.20436088740825653, mean p set: 0.4477040469646454
The modified gen p mean: 0.4473994970321655, gen p mean: -0.20805707573890686, mean p set: 0.44797375798225403
loss_pred:0.015108386054635048, decouple_loss:0.002180393086746335
loss_pred:0.016309116035699844, decouple_loss:0.0022136543411761522
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780901074409485, gen p mean: -0.20515893399715424, mean p set: 0.44838324189186096
loss_pred:0.015268881805241108, decouple_loss:0.0022246241569519043
The modified gen p mean: 0.4470826983451843, gen p mean: -0.20532546937465668, mean p set: 0.44765913486480713The modified gen p mean: 0.44789057970046997, gen p mean: -0.20896083116531372, mean p set: 0.44841933250427246
loss_pred:0.01527926791459322, decouple_loss:0.002029465278610587
loss_pred:0.015938054770231247, decouple_loss:0.0021536308340728283
Iteration: 2526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479978084564209, gen p mean: -0.21153321862220764, mean p set: 0.4485739767551422
loss_pred:0.014837205410003662, decouple_loss:0.002137613482773304
The modified gen p mean: 0.4460439383983612, gen p mean: -0.21376806497573853, mean p set: 0.4466179311275482
loss_pred:0.015212037600576878, decouple_loss:0.0024140006862580776
The modified gen p mean: 0.44666650891304016, gen p mean: -0.21295611560344696, mean p set: 0.44719401001930237
loss_pred:0.015785403549671173, decouple_loss:0.002355179749429226
Iteration: 2527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472048282623291, gen p mean: -0.2185535579919815, mean p set: 0.4477818012237549
loss_pred:0.014968188479542732, decouple_loss:0.0022099949419498444
The modified gen p mean: 0.4467230439186096, gen p mean: -0.21712158620357513, mean p set: 0.44725507497787476The modified gen p mean: 0.44633784890174866, gen p mean: -0.21882294118404388, mean p set: 0.44691428542137146
loss_pred:0.015438898466527462, decouple_loss:0.0021202550269663334
loss_pred:0.015254412777721882, decouple_loss:0.002197191584855318
Iteration: 2528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745388627052307, gen p mean: -0.209284707903862, mean p set: 0.44803258776664734
loss_pred:0.014946774579584599, decouple_loss:0.0023601457942277193
The modified gen p mean: 0.446736216545105, gen p mean: -0.21808049082756042, mean p set: 0.4473138451576233
loss_pred:0.015418633818626404, decouple_loss:0.002084439154714346
The modified gen p mean: 0.4476872980594635, gen p mean: -0.21436108648777008, mean p set: 0.4482135772705078
loss_pred:0.015014361590147018, decouple_loss:0.002166309393942356
Iteration: 2529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739893078804016, gen p mean: -0.20873011648654938, mean p set: 0.44797828793525696
loss_pred:0.015367039479315281, decouple_loss:0.00210594548843801
The modified gen p mean: 0.44723594188690186, gen p mean: -0.210837259888649, mean p set: 0.4478125274181366
loss_pred:0.014809440821409225, decouple_loss:0.0020611549261957407
The modified gen p mean: 0.44730907678604126, gen p mean: -0.2094624787569046, mean p set: 0.44784313440322876
loss_pred:0.015673594549298286, decouple_loss:0.00206789025105536
Iteration: 2530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462551176548004, gen p mean: -0.20795269310474396, mean p set: 0.4468306601047516
loss_pred:0.014144979417324066, decouple_loss:0.002396755386143923
The modified gen p mean: 0.44789016246795654, gen p mean: -0.20482498407363892, mean p set: 0.4484681785106659
loss_pred:0.01544833555817604, decouple_loss:0.0021395073272287846
The modified gen p mean: 0.44657424092292786, gen p mean: -0.20626945793628693, mean p set: 0.44709837436676025
loss_pred:0.015817919746041298, decouple_loss:0.0022135181352496147
2023-04-27 10:28:55 testing...
The modified gen p mean: 0.4482235312461853, gen p mean: -0.2024664282798767, mean p set: 0.44879910349845886
loss_pred:0.016525382176041603, decouple_loss:0.002418327843770385
The modified gen p mean: 0.4494309425354004, gen p mean: -0.20457084476947784, mean p set: 0.4499112665653229
loss_pred:0.016657551750540733, decouple_loss:0.0027270768769085407
The modified gen p mean: 0.4492994546890259, gen p mean: -0.20543229579925537, mean p set: 0.4498290419578552
loss_pred:0.016128836199641228, decouple_loss:0.002411455847322941
WV_1_PC_1_EH_0_PS_30, loss: 0.016563205048441887, avg_mse: 0.024450523778796196
current test mse: 0.024451
Iteration: 2531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643232226371765, gen p mean: -0.20866310596466064, mean p set: 0.4470071494579315
loss_pred:0.015126747079193592, decouple_loss:0.0022327157203108072
The modified gen p mean: 0.44761985540390015, gen p mean: -0.20614810287952423, mean p set: 0.4481956660747528
loss_pred:0.015108473598957062, decouple_loss:0.0020478914957493544
The modified gen p mean: 0.447635293006897, gen p mean: -0.2059352844953537, mean p set: 0.4481656849384308
loss_pred:0.015334226191043854, decouple_loss:0.0021776645444333553
Iteration: 2532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703567028045654, gen p mean: -0.211045041680336, mean p set: 0.44756636023521423
loss_pred:0.015033339150249958, decouple_loss:0.002057482488453388
The modified gen p mean: 0.44827866554260254, gen p mean: -0.20677031576633453, mean p set: 0.44884711503982544
loss_pred:0.015480324625968933, decouple_loss:0.002090676221996546
The modified gen p mean: 0.4465063810348511, gen p mean: -0.20557861030101776, mean p set: 0.4470813572406769
loss_pred:0.014784655533730984, decouple_loss:0.002262586960569024
Iteration: 2533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726142287254333, gen p mean: -0.20583035051822662, mean p set: 0.44779056310653687
loss_pred:0.014759830199182034, decouple_loss:0.0021123168990015984
The modified gen p mean: 0.4474431276321411, gen p mean: -0.20705965161323547, mean p set: 0.44802215695381165
loss_pred:0.014889813959598541, decouple_loss:0.002243045950308442
The modified gen p mean: 0.44806230068206787, gen p mean: -0.2087804079055786, mean p set: 0.4486413896083832
loss_pred:0.014650830067694187, decouple_loss:0.0022554032038897276
Iteration: 2534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481445550918579, gen p mean: -0.21369367837905884, mean p set: 0.4486749470233917
loss_pred:0.015213429927825928, decouple_loss:0.0025082172360271215
The modified gen p mean: 0.44617778062820435, gen p mean: -0.2122255563735962, mean p set: 0.4467509686946869
loss_pred:0.015310116112232208, decouple_loss:0.002507725963369012
The modified gen p mean: 0.4458094537258148, gen p mean: -0.2120383232831955, mean p set: 0.44638389348983765
loss_pred:0.014189655892550945, decouple_loss:0.0023672545794397593
Iteration: 2535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752150774002075, gen p mean: -0.20343266427516937, mean p set: 0.44809815287590027
loss_pred:0.01443606149405241, decouple_loss:0.0026889750733971596
The modified gen p mean: 0.4466669261455536, gen p mean: -0.20940865576267242, mean p set: 0.44724181294441223The modified gen p mean: 0.4458993375301361, gen p mean: -0.21159952878952026, mean p set: 0.44642776250839233
loss_pred:0.014718720689415932, decouple_loss:0.00245842058211565
loss_pred:0.01502471324056387, decouple_loss:0.0022056405432522297
Iteration: 2536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743210077285767, gen p mean: -0.21224139630794525, mean p set: 0.4480046033859253
loss_pred:0.014775239862501621, decouple_loss:0.002052058232948184
The modified gen p mean: 0.44830772280693054, gen p mean: -0.20838864147663116, mean p set: 0.44888749718666077
loss_pred:0.014589189551770687, decouple_loss:0.0025060572661459446
The modified gen p mean: 0.44774338603019714, gen p mean: -0.20809495449066162, mean p set: 0.44827502965927124
loss_pred:0.015369180589914322, decouple_loss:0.0024442996364086866
Iteration: 2537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44595572352409363, gen p mean: -0.2115272879600525, mean p set: 0.4465283155441284
loss_pred:0.01545102708041668, decouple_loss:0.002811780897900462
The modified gen p mean: 0.44727620482444763, gen p mean: -0.2126132845878601, mean p set: 0.4478060305118561The modified gen p mean: 0.448285847902298, gen p mean: -0.21405941247940063, mean p set: 0.4488631784915924
loss_pred:0.014850156381726265, decouple_loss:0.002528301440179348
loss_pred:0.015154470689594746, decouple_loss:0.0026205494068562984
Iteration: 2538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447286993265152, gen p mean: -0.20154589414596558, mean p set: 0.4478640854358673
loss_pred:0.014421211555600166, decouple_loss:0.0025013950653374195
The modified gen p mean: 0.4484255313873291, gen p mean: -0.20244744420051575, mean p set: 0.448952317237854The modified gen p mean: 0.4484891891479492, gen p mean: -0.20389273762702942, mean p set: 0.4490656852722168
loss_pred:0.014810146763920784, decouple_loss:0.002421262674033642
loss_pred:0.014829789288341999, decouple_loss:0.002315233228728175
Iteration: 2539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468912184238434, gen p mean: -0.20815710723400116, mean p set: 0.44746458530426025
loss_pred:0.015128809958696365, decouple_loss:0.0021949138026684523
The modified gen p mean: 0.4479752779006958, gen p mean: -0.21129940450191498, mean p set: 0.4485515058040619
loss_pred:0.01563086360692978, decouple_loss:0.002327641472220421
The modified gen p mean: 0.44609010219573975, gen p mean: -0.20707088708877563, mean p set: 0.44661951065063477
loss_pred:0.015309346839785576, decouple_loss:0.0022388165816664696
Iteration: 2540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715583324432373, gen p mean: -0.20901799201965332, mean p set: 0.447729229927063
loss_pred:0.015010825358331203, decouple_loss:0.0023164849262684584
The modified gen p mean: 0.4478437900543213, gen p mean: -0.20722328126430511, mean p set: 0.4484192430973053
loss_pred:0.01559395156800747, decouple_loss:0.001958350883796811
The modified gen p mean: 0.447563499212265, gen p mean: -0.2050824612379074, mean p set: 0.44809025526046753
loss_pred:0.01504730898886919, decouple_loss:0.0020636646077036858
2023-04-27 10:32:19 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.20640325546264648, mean p set: 0.4499112665653229
loss_pred:0.01664588414132595, decouple_loss:0.0022142105735838413
The modified gen p mean: 0.4493005871772766, gen p mean: -0.20724999904632568, mean p set: 0.4498290419578552
loss_pred:0.01610502414405346, decouple_loss:0.0022562590893357992
The modified gen p mean: 0.44822025299072266, gen p mean: -0.20422476530075073, mean p set: 0.44879910349845886
loss_pred:0.016452202573418617, decouple_loss:0.0022376172710210085
WV_1_PC_1_EH_0_PS_30, loss: 0.016512839123606682, avg_mse: 0.024422181770205498
current test mse: 0.024422
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 2541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744396209716797, gen p mean: -0.2069123387336731, mean p set: 0.4479758143424988
loss_pred:0.014700074680149555, decouple_loss:0.0021430072374641895
The modified gen p mean: 0.44842445850372314, gen p mean: -0.20809859037399292, mean p set: 0.4489942789077759
loss_pred:0.015207292512059212, decouple_loss:0.0021829274483025074
The modified gen p mean: 0.4468865990638733, gen p mean: -0.20856741070747375, mean p set: 0.4474617540836334
loss_pred:0.015599810518324375, decouple_loss:0.00228208233602345
Iteration: 2542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736814498901367, gen p mean: -0.20480692386627197, mean p set: 0.44789430499076843
loss_pred:0.015635212883353233, decouple_loss:0.002266502007842064
The modified gen p mean: 0.4469860792160034, gen p mean: -0.20972920954227448, mean p set: 0.447562575340271
The modified gen p mean: 0.4467402696609497, gen p mean: -0.20489539206027985, mean p set: 0.4473150670528412
loss_pred:0.015555627644062042, decouple_loss:0.002532773418352008
loss_pred:0.015959126874804497, decouple_loss:0.002766836667433381
Iteration: 2543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454328119754791, gen p mean: -0.2121017724275589, mean p set: 0.445966511964798
loss_pred:0.015617496334016323, decouple_loss:0.002363495994359255
The modified gen p mean: 0.44792211055755615, gen p mean: -0.211480513215065, mean p set: 0.4484986364841461
The modified gen p mean: 0.44793322682380676, gen p mean: -0.20688770711421967, mean p set: 0.44851356744766235
loss_pred:0.015201770700514317, decouple_loss:0.002154190558940172
loss_pred:0.015461796894669533, decouple_loss:0.0020454665645956993
Iteration: 2544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755566120147705, gen p mean: -0.2106563001871109, mean p set: 0.448087215423584
loss_pred:0.015242146328091621, decouple_loss:0.002263980684801936
The modified gen p mean: 0.4482249915599823, gen p mean: -0.21155862510204315, mean p set: 0.4488007128238678
The modified gen p mean: 0.446333646774292, gen p mean: -0.21245341002941132, mean p set: 0.4469049572944641
loss_pred:0.015012150630354881, decouple_loss:0.002091676462441683
loss_pred:0.015453792177140713, decouple_loss:0.002101335907354951
Iteration: 2545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476880431175232, gen p mean: -0.20793063938617706, mean p set: 0.44826194643974304
loss_pred:0.017068058252334595, decouple_loss:0.017085636034607887
The modified gen p mean: 0.44973045587539673, gen p mean: -0.2043725550174713, mean p set: 0.45031026005744934
loss_pred:0.016864219680428505, decouple_loss:0.014466648921370506
The modified gen p mean: 0.44731834530830383, gen p mean: -0.20969262719154358, mean p set: 0.44784191250801086
loss_pred:0.017258383333683014, decouple_loss:0.01938147470355034
Iteration: 2546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482964873313904, gen p mean: -0.20384515821933746, mean p set: 0.44887441396713257
loss_pred:0.01608065888285637, decouple_loss:0.005366030149161816
The modified gen p mean: 0.4460415244102478, gen p mean: -0.2062566727399826, mean p set: 0.44656795263290405The modified gen p mean: 0.4476999044418335, gen p mean: -0.20037905871868134, mean p set: 0.44827497005462646
loss_pred:0.015759699046611786, decouple_loss:0.005782869178801775
loss_pred:0.01654636301100254, decouple_loss:0.005333739798516035
Iteration: 2547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733574986457825, gen p mean: -0.20683075487613678, mean p set: 0.4479130506515503
loss_pred:0.01585301011800766, decouple_loss:0.008177272975444794
The modified gen p mean: 0.4482232332229614, gen p mean: -0.2050512284040451, mean p set: 0.4487912356853485The modified gen p mean: 0.44757044315338135, gen p mean: -0.21365463733673096, mean p set: 0.4480946362018585
loss_pred:0.01652340777218342, decouple_loss:0.008168024942278862
loss_pred:0.01613530144095421, decouple_loss:0.008636802434921265
Iteration: 2548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484490752220154, gen p mean: -0.21319547295570374, mean p set: 0.44902777671813965
loss_pred:0.016486600041389465, decouple_loss:0.006963836960494518
The modified gen p mean: 0.4487461447715759, gen p mean: -0.21154971420764923, mean p set: 0.4492754638195038The modified gen p mean: 0.44549649953842163, gen p mean: -0.21977634727954865, mean p set: 0.44606801867485046
loss_pred:0.01708480715751648, decouple_loss:0.006060839165002108
loss_pred:0.01691679283976555, decouple_loss:0.007337796967476606
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687673449516296, gen p mean: -0.21967992186546326, mean p set: 0.44745954871177673
loss_pred:0.0163709819316864, decouple_loss:0.006453323177993298
The modified gen p mean: 0.44857192039489746, gen p mean: -0.2149006426334381, mean p set: 0.44909462332725525The modified gen p mean: 0.44743749499320984, gen p mean: -0.21140095591545105, mean p set: 0.44801437854766846
loss_pred:0.01624707691371441, decouple_loss:0.007224367465823889
loss_pred:0.016017844900488853, decouple_loss:0.006460364442318678
Iteration: 2550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651666283607483, gen p mean: -0.22512955963611603, mean p set: 0.44709834456443787
loss_pred:0.016271451488137245, decouple_loss:0.00703887315467
The modified gen p mean: 0.4479354918003082, gen p mean: -0.21645206212997437, mean p set: 0.4485120475292206
loss_pred:0.016972308978438377, decouple_loss:0.007989838719367981
The modified gen p mean: 0.44938692450523376, gen p mean: -0.21934854984283447, mean p set: 0.4499136209487915
loss_pred:0.016433900222182274, decouple_loss:0.0071906582452356815
2023-04-27 10:36:26 testing...
The modified gen p mean: 0.4482225775718689, gen p mean: -0.2220299392938614, mean p set: 0.44879910349845886
loss_pred:0.017415056005120277, decouple_loss:0.006494027096778154
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2251938134431839, mean p set: 0.4499112665653229
loss_pred:0.01760934665799141, decouple_loss:0.0068766712211072445
The modified gen p mean: 0.4493044316768646, gen p mean: -0.22535492479801178, mean p set: 0.4498290419578552
loss_pred:0.017072441056370735, decouple_loss:0.006537226494401693
WV_1_PC_1_EH_0_PS_30, loss: 0.017697414383292198, avg_mse: 0.02585943602025509
current test mse: 0.025859
Iteration: 2551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460633099079132, gen p mean: -0.22895310819149017, mean p set: 0.4466356933116913
loss_pred:0.016334904357790947, decouple_loss:0.006756600923836231
The modified gen p mean: 0.44743236899375916, gen p mean: -0.2287442535161972, mean p set: 0.44801008701324463
loss_pred:0.0160719882696867, decouple_loss:0.006429589819163084
The modified gen p mean: 0.4461022615432739, gen p mean: -0.22806978225708008, mean p set: 0.4466274678707123
loss_pred:0.01664222590625286, decouple_loss:0.006711682304739952
Iteration: 2552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934290647506714, gen p mean: -0.22970817983150482, mean p set: 0.449869304895401
loss_pred:0.016190633177757263, decouple_loss:0.0063706315122544765
The modified gen p mean: 0.4471018612384796, gen p mean: -0.2339538186788559, mean p set: 0.44767752289772034
loss_pred:0.01605011150240898, decouple_loss:0.006375993136316538
The modified gen p mean: 0.4477212429046631, gen p mean: -0.23367206752300262, mean p set: 0.4482978880405426
loss_pred:0.01647082529962063, decouple_loss:0.00812132190912962
Iteration: 2553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477890431880951, gen p mean: -0.2342325896024704, mean p set: 0.4483223557472229
loss_pred:0.015584002248942852, decouple_loss:0.007016693241894245
The modified gen p mean: 0.4467180669307709, gen p mean: -0.24002502858638763, mean p set: 0.4472885727882385
loss_pred:0.017123593017458916, decouple_loss:0.008394666947424412
The modified gen p mean: 0.4461384117603302, gen p mean: -0.2404915690422058, mean p set: 0.44671642780303955
loss_pred:0.016375916078686714, decouple_loss:0.00625514704734087
Iteration: 2554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473433494567871, gen p mean: -0.2444203943014145, mean p set: 0.4478735327720642
loss_pred:0.016241757199168205, decouple_loss:0.006009014323353767
The modified gen p mean: 0.44718530774116516, gen p mean: -0.24412500858306885, mean p set: 0.44775891304016113
loss_pred:0.01651930622756481, decouple_loss:0.007678105030208826
The modified gen p mean: 0.4470442235469818, gen p mean: -0.24516819417476654, mean p set: 0.44761988520622253
loss_pred:0.016203787177801132, decouple_loss:0.00655761081725359
Iteration: 2555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717925786972046, gen p mean: -0.23609484732151031, mean p set: 0.44775715470314026
loss_pred:0.016208238899707794, decouple_loss:0.005554003641009331
The modified gen p mean: 0.4461106061935425, gen p mean: -0.24043887853622437, mean p set: 0.4466353952884674The modified gen p mean: 0.4486132562160492, gen p mean: -0.24076566100120544, mean p set: 0.449184387922287
loss_pred:0.015917882323265076, decouple_loss:0.0060718730092048645
loss_pred:0.015882618725299835, decouple_loss:0.005326541606336832
Iteration: 2556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703519344329834, gen p mean: -0.23390431702136993, mean p set: 0.4476076066493988
loss_pred:0.015816478058695793, decouple_loss:0.004679433070123196
The modified gen p mean: 0.4472365975379944, gen p mean: -0.2285517007112503, mean p set: 0.44780421257019043
loss_pred:0.015577319078147411, decouple_loss:0.005723525770008564
The modified gen p mean: 0.4481647312641144, gen p mean: -0.2351163774728775, mean p set: 0.44869065284729004
loss_pred:0.015718694776296616, decouple_loss:0.005117434076964855
Iteration: 2557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490025043487549, gen p mean: -0.24053899943828583, mean p set: 0.44957879185676575
loss_pred:0.015487520955502987, decouple_loss:0.006019778549671173
The modified gen p mean: 0.4468836188316345, gen p mean: -0.24094770848751068, mean p set: 0.44740915298461914The modified gen p mean: 0.4475056827068329, gen p mean: -0.2367275208234787, mean p set: 0.44808489084243774
loss_pred:0.015961691737174988, decouple_loss:0.005201380234211683
loss_pred:0.01620018482208252, decouple_loss:0.00544862262904644
Iteration: 2558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921207427978516, gen p mean: -0.24184755980968475, mean p set: 0.449787974357605
loss_pred:0.015663741156458855, decouple_loss:0.00616554357111454
The modified gen p mean: 0.4470684826374054, gen p mean: -0.23742441833019257, mean p set: 0.447646826505661
loss_pred:0.015919595956802368, decouple_loss:0.006696097087115049
The modified gen p mean: 0.44675084948539734, gen p mean: -0.24450695514678955, mean p set: 0.44727712869644165
loss_pred:0.015445646829903126, decouple_loss:0.00546278664842248
Iteration: 2559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775572419166565, gen p mean: -0.23751884698867798, mean p set: 0.44832706451416016
loss_pred:0.015840360894799232, decouple_loss:0.005139293149113655
The modified gen p mean: 0.44679123163223267, gen p mean: -0.237129345536232, mean p set: 0.44736772775650024
loss_pred:0.015801221132278442, decouple_loss:0.005416653584688902
The modified gen p mean: 0.44831550121307373, gen p mean: -0.2432214319705963, mean p set: 0.4488462209701538
loss_pred:0.015884261578321457, decouple_loss:0.005411582998931408
Iteration: 2560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476347863674164, gen p mean: -0.23462331295013428, mean p set: 0.44821611046791077
loss_pred:0.016166016459465027, decouple_loss:0.00495696859434247
The modified gen p mean: 0.4475818872451782, gen p mean: -0.23598656058311462, mean p set: 0.4481530487537384
loss_pred:0.015424318611621857, decouple_loss:0.004584184382110834
The modified gen p mean: 0.4472489058971405, gen p mean: -0.23124706745147705, mean p set: 0.4477689266204834
loss_pred:0.016036970540881157, decouple_loss:0.005158251151442528
2023-04-27 10:39:52 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22929911315441132, mean p set: 0.4499112665653229
loss_pred:0.017084820196032524, decouple_loss:0.004891241434961557
The modified gen p mean: 0.4493013918399811, gen p mean: -0.22989051043987274, mean p set: 0.4498290419578552
loss_pred:0.016590138897299767, decouple_loss:0.00441579008474946
The modified gen p mean: 0.4482228755950928, gen p mean: -0.22616280615329742, mean p set: 0.44879910349845886
loss_pred:0.017009859904646873, decouple_loss:0.004450671840459108
WV_1_PC_1_EH_0_PS_30, loss: 0.0171242356300354, avg_mse: 0.025104232132434845
current test mse: 0.025104
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 2561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747596979141235, gen p mean: -0.23233899474143982, mean p set: 0.4480080008506775
loss_pred:0.015836108475923538, decouple_loss:0.005026091821491718
The modified gen p mean: 0.44607648253440857, gen p mean: -0.22501185536384583, mean p set: 0.44665300846099854
loss_pred:0.015719741582870483, decouple_loss:0.004455088637769222
The modified gen p mean: 0.44672003388404846, gen p mean: -0.22865960001945496, mean p set: 0.4472944438457489
loss_pred:0.01560153067111969, decouple_loss:0.00537920044735074
Iteration: 2562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488634467124939, gen p mean: -0.2204822450876236, mean p set: 0.4493890404701233
loss_pred:0.01581142470240593, decouple_loss:0.004816523753106594
The modified gen p mean: 0.44798070192337036, gen p mean: -0.22386343777179718, mean p set: 0.44855615496635437
The modified gen p mean: 0.4475632309913635, gen p mean: -0.22538842260837555, mean p set: 0.4481387734413147
loss_pred:0.015519483014941216, decouple_loss:0.004710039589554071
loss_pred:0.01585860177874565, decouple_loss:0.005927104502916336
Iteration: 2563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474058747291565, gen p mean: -0.22186212241649628, mean p set: 0.4479289650917053
loss_pred:0.015900561586022377, decouple_loss:0.004239698406308889
The modified gen p mean: 0.44891420006752014, gen p mean: -0.21799640357494354, mean p set: 0.4494889974594116
The modified gen p mean: 0.44766172766685486, gen p mean: -0.219863623380661, mean p set: 0.4482399523258209
loss_pred:0.01496092975139618, decouple_loss:0.004600370768457651
loss_pred:0.01593821495771408, decouple_loss:0.0047263274900615215
Iteration: 2564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448249876499176, gen p mean: -0.21311576664447784, mean p set: 0.44877755641937256
loss_pred:0.0157557874917984, decouple_loss:0.004022146109491587
The modified gen p mean: 0.44846025109291077, gen p mean: -0.2147335708141327, mean p set: 0.44904205203056335
The modified gen p mean: 0.4475155770778656, gen p mean: -0.21602538228034973, mean p set: 0.4480917155742645
loss_pred:0.015067907981574535, decouple_loss:0.0048806327395141125
loss_pred:0.016058454290032387, decouple_loss:0.004853368271142244
Iteration: 2565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482390582561493, gen p mean: -0.20868107676506042, mean p set: 0.4488186836242676
loss_pred:0.015390310436487198, decouple_loss:0.004419541452080011
The modified gen p mean: 0.4460236728191376, gen p mean: -0.20709584653377533, mean p set: 0.44660380482673645
loss_pred:0.01573694497346878, decouple_loss:0.004527132958173752
The modified gen p mean: 0.4481159746646881, gen p mean: -0.20707069337368011, mean p set: 0.4486466944217682
loss_pred:0.015508593060076237, decouple_loss:0.004180788993835449
Iteration: 2566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481920003890991, gen p mean: -0.21788614988327026, mean p set: 0.4487678110599518
loss_pred:0.015091422013938427, decouple_loss:0.0038977093063294888
The modified gen p mean: 0.4477453827857971, gen p mean: -0.21746784448623657, mean p set: 0.44831904768943787
loss_pred:0.015701862052083015, decouple_loss:0.004233293700963259
The modified gen p mean: 0.44782593846321106, gen p mean: -0.21504801511764526, mean p set: 0.4483511745929718
loss_pred:0.015090826898813248, decouple_loss:0.0037844576872885227
Iteration: 2567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727933406829834, gen p mean: -0.2191379964351654, mean p set: 0.44785353541374207
loss_pred:0.015261624939739704, decouple_loss:0.0036606299690902233
The modified gen p mean: 0.44816163182258606, gen p mean: -0.2202460914850235, mean p set: 0.4487457573413849
loss_pred:0.01558640692383051, decouple_loss:0.003595396177843213
The modified gen p mean: 0.44692111015319824, gen p mean: -0.22281788289546967, mean p set: 0.44745007157325745
loss_pred:0.014807239174842834, decouple_loss:0.0035654292441904545
Iteration: 2568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476427733898163, gen p mean: -0.2202550321817398, mean p set: 0.44821682572364807
loss_pred:0.01544147077947855, decouple_loss:0.0037659599911421537
The modified gen p mean: 0.4470349848270416, gen p mean: -0.21621160209178925, mean p set: 0.44760891795158386
loss_pred:0.015657326206564903, decouple_loss:0.004268554970622063
The modified gen p mean: 0.44733473658561707, gen p mean: -0.22460752725601196, mean p set: 0.4478645324707031
loss_pred:0.014978306367993355, decouple_loss:0.0041741481982171535
Iteration: 2569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473320543766022, gen p mean: -0.22385767102241516, mean p set: 0.4479069411754608
loss_pred:0.015630848705768585, decouple_loss:0.0036159097217023373
The modified gen p mean: 0.44661036133766174, gen p mean: -0.22036251425743103, mean p set: 0.4471800923347473
loss_pred:0.015730295330286026, decouple_loss:0.0034891238901764154
The modified gen p mean: 0.4481731057167053, gen p mean: -0.21800807118415833, mean p set: 0.44870179891586304
loss_pred:0.015504669398069382, decouple_loss:0.003836733056232333
Iteration: 2570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478832185268402, gen p mean: -0.2208666056394577, mean p set: 0.44846081733703613
loss_pred:0.015058746561408043, decouple_loss:0.003998373169451952
The modified gen p mean: 0.4471711814403534, gen p mean: -0.21945792436599731, mean p set: 0.4477456510066986
loss_pred:0.015530252829194069, decouple_loss:0.003459947183728218
The modified gen p mean: 0.4472956955432892, gen p mean: -0.21872681379318237, mean p set: 0.4478244483470917
loss_pred:0.015205842442810535, decouple_loss:0.004104461520910263
2023-04-27 10:43:56 testing...
The modified gen p mean: 0.44822022318840027, gen p mean: -0.21378105878829956, mean p set: 0.44879910349845886
loss_pred:0.016979746520519257, decouple_loss:0.0035575772635638714
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21706418693065643, mean p set: 0.4499112665653229
loss_pred:0.017119642347097397, decouple_loss:0.0035594922956079245
The modified gen p mean: 0.44929710030555725, gen p mean: -0.21798579394817352, mean p set: 0.4498290419578552
loss_pred:0.01662585511803627, decouple_loss:0.003702352521941066
WV_1_PC_1_EH_0_PS_30, loss: 0.017088737338781357, avg_mse: 0.025196822360157967
current test mse: 0.025197
Iteration: 2571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464825689792633, gen p mean: -0.2156369984149933, mean p set: 0.44706112146377563
loss_pred:0.015375740826129913, decouple_loss:0.0034452767577022314
The modified gen p mean: 0.44716736674308777, gen p mean: -0.2126719206571579, mean p set: 0.4477475583553314
loss_pred:0.014640752226114273, decouple_loss:0.0037677562795579433
The modified gen p mean: 0.4476248323917389, gen p mean: -0.21790270507335663, mean p set: 0.44814959168434143
loss_pred:0.014860357157886028, decouple_loss:0.00360441068187356
Iteration: 2572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471684694290161, gen p mean: -0.21656344830989838, mean p set: 0.44770246744155884
loss_pred:0.014931744895875454, decouple_loss:0.004070631228387356
The modified gen p mean: 0.44766107201576233, gen p mean: -0.21501460671424866, mean p set: 0.44823944568634033
loss_pred:0.015249361284077168, decouple_loss:0.0037993888836354017
The modified gen p mean: 0.44703900814056396, gen p mean: -0.219014510512352, mean p set: 0.44761648774147034
loss_pred:0.014862452633678913, decouple_loss:0.0038376383017748594
Iteration: 2573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826167821884155, gen p mean: -0.21407820284366608, mean p set: 0.44879069924354553
loss_pred:0.014630129560828209, decouple_loss:0.003838823176920414
The modified gen p mean: 0.4468578100204468, gen p mean: -0.21514183282852173, mean p set: 0.44742754101753235
loss_pred:0.014689229428768158, decouple_loss:0.003726825350895524
The modified gen p mean: 0.4477114677429199, gen p mean: -0.21176677942276, mean p set: 0.4482864737510681
loss_pred:0.015111318789422512, decouple_loss:0.003685545641928911
Iteration: 2574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476630389690399, gen p mean: -0.2127000093460083, mean p set: 0.44819164276123047
loss_pred:0.014604737982153893, decouple_loss:0.004181677009910345
The modified gen p mean: 0.4471670687198639, gen p mean: -0.2116524577140808, mean p set: 0.4477413594722748
loss_pred:0.015317760407924652, decouple_loss:0.0042873769998550415
The modified gen p mean: 0.4474506378173828, gen p mean: -0.21236830949783325, mean p set: 0.4480248689651489
loss_pred:0.014983908273279667, decouple_loss:0.00414879759773612
Iteration: 2575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696715474128723, gen p mean: -0.21484364569187164, mean p set: 0.44754406809806824
loss_pred:0.01491814386099577, decouple_loss:0.0035328641533851624
The modified gen p mean: 0.4477081000804901, gen p mean: -0.2135258913040161, mean p set: 0.4482308626174927The modified gen p mean: 0.4472641944885254, gen p mean: -0.2135169953107834, mean p set: 0.4478406012058258
loss_pred:0.01535144355148077, decouple_loss:0.0037045804783701897
loss_pred:0.015172833576798439, decouple_loss:0.003809357061982155
Iteration: 2576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703876972198486, gen p mean: -0.21689894795417786, mean p set: 0.4476131498813629
loss_pred:0.014391349628567696, decouple_loss:0.004174737259745598
The modified gen p mean: 0.4467944800853729, gen p mean: -0.20831267535686493, mean p set: 0.44731831550598145
The modified gen p mean: 0.44713592529296875, gen p mean: -0.21440428495407104, mean p set: 0.44771865010261536
loss_pred:0.0155707485973835, decouple_loss:0.003933633212000132
loss_pred:0.014550287276506424, decouple_loss:0.004304249305278063
Iteration: 2577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749197363853455, gen p mean: -0.21861907839775085, mean p set: 0.44806867837905884
loss_pred:0.015345943160355091, decouple_loss:0.003813013667240739
The modified gen p mean: 0.4472912847995758, gen p mean: -0.21183162927627563, mean p set: 0.4478210508823395The modified gen p mean: 0.4486330449581146, gen p mean: -0.20918691158294678, mean p set: 0.4492107927799225
loss_pred:0.015408966690301895, decouple_loss:0.00392926437780261
loss_pred:0.015341083519160748, decouple_loss:0.0037026137579232454
Iteration: 2578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477027654647827, gen p mean: -0.21873562037944794, mean p set: 0.44828295707702637
loss_pred:0.015387870371341705, decouple_loss:0.0036489618942141533
The modified gen p mean: 0.4476794898509979, gen p mean: -0.21412387490272522, mean p set: 0.4482089579105377
loss_pred:0.01522260345518589, decouple_loss:0.00399535708129406
The modified gen p mean: 0.44875141978263855, gen p mean: -0.2151760756969452, mean p set: 0.4493274986743927
loss_pred:0.01514042541384697, decouple_loss:0.003673473373055458
Iteration: 2579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778817892074585, gen p mean: -0.2080191671848297, mean p set: 0.4483618438243866
loss_pred:0.014925794675946236, decouple_loss:0.004418758675456047
The modified gen p mean: 0.44746771454811096, gen p mean: -0.2144985944032669, mean p set: 0.4480433166027069
loss_pred:0.014365122653543949, decouple_loss:0.004616861697286367
The modified gen p mean: 0.44748926162719727, gen p mean: -0.21482664346694946, mean p set: 0.44802039861679077
loss_pred:0.01474141888320446, decouple_loss:0.004961090162396431
Iteration: 2580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482880234718323, gen p mean: -0.20923420786857605, mean p set: 0.4488621652126312
loss_pred:0.01555576454848051, decouple_loss:0.003464488545432687
The modified gen p mean: 0.4476466178894043, gen p mean: -0.2163504809141159, mean p set: 0.4482249617576599
loss_pred:0.014761517755687237, decouple_loss:0.003541769925504923
The modified gen p mean: 0.44739994406700134, gen p mean: -0.21394169330596924, mean p set: 0.44792893528938293
loss_pred:0.015522602014243603, decouple_loss:0.0036311133299022913
2023-04-27 10:47:21 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.20837897062301636, mean p set: 0.4499112665653229
loss_pred:0.016988635063171387, decouple_loss:0.004237145185470581
The modified gen p mean: 0.44929808378219604, gen p mean: -0.209117591381073, mean p set: 0.4498290419578552
loss_pred:0.01659763790667057, decouple_loss:0.004532842896878719
The modified gen p mean: 0.44822317361831665, gen p mean: -0.20527181029319763, mean p set: 0.44879910349845886
loss_pred:0.016832176595926285, decouple_loss:0.004411910194903612
WV_1_PC_1_EH_0_PS_30, loss: 0.017025848850607872, avg_mse: 0.02507469616830349
current test mse: 0.025075
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 2581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464549720287323, gen p mean: -0.2111959010362625, mean p set: 0.4470359981060028
loss_pred:0.015798775479197502, decouple_loss:0.00378853059373796
The modified gen p mean: 0.44612377882003784, gen p mean: -0.20736588537693024, mean p set: 0.4466569721698761
loss_pred:0.016031773760914803, decouple_loss:0.004137849900871515
The modified gen p mean: 0.4464382231235504, gen p mean: -0.20653139054775238, mean p set: 0.4470106363296509
loss_pred:0.015850413590669632, decouple_loss:0.0038339218590408564
Iteration: 2582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469948709011078, gen p mean: -0.20960482954978943, mean p set: 0.44752374291419983
loss_pred:0.0163593590259552, decouple_loss:0.004367030691355467
The modified gen p mean: 0.44650471210479736, gen p mean: -0.21050947904586792, mean p set: 0.44707778096199036
The modified gen p mean: 0.4469558000564575, gen p mean: -0.2107449173927307, mean p set: 0.4475320279598236
loss_pred:0.015801046043634415, decouple_loss:0.00367761985398829
loss_pred:0.015423769131302834, decouple_loss:0.0038031446747481823
Iteration: 2583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458114206790924, gen p mean: -0.20868633687496185, mean p set: 0.4463409185409546
loss_pred:0.015606801025569439, decouple_loss:0.0036737038753926754
The modified gen p mean: 0.44704699516296387, gen p mean: -0.20890192687511444, mean p set: 0.4476243555545807
The modified gen p mean: 0.4454675614833832, gen p mean: -0.2121429592370987, mean p set: 0.44604605436325073
loss_pred:0.015563244931399822, decouple_loss:0.0034518507309257984
loss_pred:0.015524358488619328, decouple_loss:0.004082332830876112
Iteration: 2584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459134638309479, gen p mean: -0.20592837035655975, mean p set: 0.4464392364025116
loss_pred:0.01570049114525318, decouple_loss:0.003479832550510764
The modified gen p mean: 0.4453830122947693, gen p mean: -0.2082791030406952, mean p set: 0.44595643877983093
The modified gen p mean: 0.44672054052352905, gen p mean: -0.20610307157039642, mean p set: 0.44729533791542053
loss_pred:0.015835953876376152, decouple_loss:0.0035555774811655283
loss_pred:0.015320369973778725, decouple_loss:0.0032084831036627293
Iteration: 2585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469698965549469, gen p mean: -0.20472799241542816, mean p set: 0.4475449025630951
loss_pred:0.01628471165895462, decouple_loss:0.003794570453464985
The modified gen p mean: 0.44641977548599243, gen p mean: -0.2055603712797165, mean p set: 0.44695156812667847The modified gen p mean: 0.44556188583374023, gen p mean: -0.20370787382125854, mean p set: 0.44613370299339294
loss_pred:0.015524904243648052, decouple_loss:0.0030608847737312317
loss_pred:0.015590107068419456, decouple_loss:0.0031329963821917772
Iteration: 2586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713547825813293, gen p mean: -0.21081091463565826, mean p set: 0.44770827889442444
loss_pred:0.016038531437516212, decouple_loss:0.003238464705646038
The modified gen p mean: 0.4468707740306854, gen p mean: -0.20995904505252838, mean p set: 0.447405070066452The modified gen p mean: 0.4454857110977173, gen p mean: -0.2092095911502838, mean p set: 0.44606199860572815
loss_pred:0.015715403482317924, decouple_loss:0.003052104264497757
loss_pred:0.015599783509969711, decouple_loss:0.003115858184173703
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686755537986755, gen p mean: -0.20805197954177856, mean p set: 0.44744303822517395
loss_pred:0.01583188772201538, decouple_loss:0.003288677893579006
The modified gen p mean: 0.44702428579330444, gen p mean: -0.20794987678527832, mean p set: 0.44754984974861145The modified gen p mean: 0.4440939128398895, gen p mean: -0.2058657854795456, mean p set: 0.44466984272003174
loss_pred:0.015953993424773216, decouple_loss:0.0036338428035378456
loss_pred:0.01566649042069912, decouple_loss:0.003591723507270217
Iteration: 2588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466977119445801, gen p mean: -0.21004773676395416, mean p set: 0.4472745358943939
loss_pred:0.015096471644937992, decouple_loss:0.002816416323184967
The modified gen p mean: 0.44583091139793396, gen p mean: -0.20787794888019562, mean p set: 0.44640541076660156
loss_pred:0.01564975269138813, decouple_loss:0.0031884077470749617
The modified gen p mean: 0.4465087354183197, gen p mean: -0.20783261954784393, mean p set: 0.4470418095588684
loss_pred:0.015503467991948128, decouple_loss:0.00333495088852942
Iteration: 2589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458965063095093, gen p mean: -0.20692676305770874, mean p set: 0.44647544622421265
loss_pred:0.016409454867243767, decouple_loss:0.003922747448086739
The modified gen p mean: 0.4463742971420288, gen p mean: -0.21073780953884125, mean p set: 0.44695594906806946
loss_pred:0.015075594186782837, decouple_loss:0.0037817987613379955
The modified gen p mean: 0.4448736011981964, gen p mean: -0.20572541654109955, mean p set: 0.4453986883163452
loss_pred:0.016359297558665276, decouple_loss:0.0038601686246693134
Iteration: 2590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463215172290802, gen p mean: -0.21170634031295776, mean p set: 0.4468989372253418
loss_pred:0.01553438976407051, decouple_loss:0.0028419732116162777
The modified gen p mean: 0.44558873772621155, gen p mean: -0.20918670296669006, mean p set: 0.44611749053001404The modified gen p mean: 0.4460033178329468, gen p mean: -0.21158018708229065, mean p set: 0.4465799629688263
loss_pred:0.015132495202124119, decouple_loss:0.003112269099801779
loss_pred:0.01544024609029293, decouple_loss:0.0029032505117356777
2023-04-27 10:51:38 testing...
The modified gen p mean: 0.4482262134552002, gen p mean: -0.21533437073230743, mean p set: 0.44879910349845886
loss_pred:0.016707127913832664, decouple_loss:0.003395312000066042
The modified gen p mean: 0.44929563999176025, gen p mean: -0.21901462972164154, mean p set: 0.4498290419578552
loss_pred:0.01648491434752941, decouple_loss:0.0035416721366345882
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21842089295387268, mean p set: 0.4499112665653229
loss_pred:0.016868850216269493, decouple_loss:0.004039446357637644
WV_1_PC_1_EH_0_PS_30, loss: 0.016869906336069107, avg_mse: 0.02487400360405445
current test mse: 0.024874
Iteration: 2591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44578126072883606, gen p mean: -0.21860554814338684, mean p set: 0.44631072878837585
loss_pred:0.015386227518320084, decouple_loss:0.0035113233607262373
The modified gen p mean: 0.4466133117675781, gen p mean: -0.22162258625030518, mean p set: 0.44719311594963074
loss_pred:0.015333091840147972, decouple_loss:0.0035520181991159916
The modified gen p mean: 0.447866290807724, gen p mean: -0.21838261187076569, mean p set: 0.4484444558620453
loss_pred:0.01659504324197769, decouple_loss:0.003365399781614542
Iteration: 2592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758284091949463, gen p mean: -0.22018171846866608, mean p set: 0.4481041729450226
loss_pred:0.01603636145591736, decouple_loss:0.003230964532122016
The modified gen p mean: 0.44695478677749634, gen p mean: -0.21621626615524292, mean p set: 0.4475346803665161
The modified gen p mean: 0.44656217098236084, gen p mean: -0.21681495010852814, mean p set: 0.44714006781578064
loss_pred:0.016298752278089523, decouple_loss:0.0033200918696820736
loss_pred:0.015932291746139526, decouple_loss:0.0035757580772042274
Iteration: 2593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471087157726288, gen p mean: -0.21597282588481903, mean p set: 0.44763532280921936
loss_pred:0.015996236354112625, decouple_loss:0.002682217163965106
The modified gen p mean: 0.4462081491947174, gen p mean: -0.2183641940355301, mean p set: 0.44678211212158203
The modified gen p mean: 0.4464085102081299, gen p mean: -0.22028689086437225, mean p set: 0.446982741355896
loss_pred:0.015334099531173706, decouple_loss:0.0027488579507917166
loss_pred:0.015375607647001743, decouple_loss:0.002836970379576087
Iteration: 2594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44537609815597534, gen p mean: -0.2165730744600296, mean p set: 0.4459480941295624
loss_pred:0.015628619119524956, decouple_loss:0.0035600948613137007
The modified gen p mean: 0.44733962416648865, gen p mean: -0.21947290003299713, mean p set: 0.4478660225868225The modified gen p mean: 0.4470626711845398, gen p mean: -0.22355470061302185, mean p set: 0.4476405084133148
loss_pred:0.016273224726319313, decouple_loss:0.0033424857538193464
loss_pred:0.015601788647472858, decouple_loss:0.003490525297820568
Iteration: 2595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470844268798828, gen p mean: -0.21978974342346191, mean p set: 0.44765836000442505
loss_pred:0.01526210643351078, decouple_loss:0.0027844742871820927
The modified gen p mean: 0.4467430114746094, gen p mean: -0.21670737862586975, mean p set: 0.44731536507606506
loss_pred:0.01583421789109707, decouple_loss:0.002912198891863227
The modified gen p mean: 0.44696909189224243, gen p mean: -0.22292692959308624, mean p set: 0.44749611616134644
loss_pred:0.015221135690808296, decouple_loss:0.0025562283117324114
Iteration: 2596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634753465652466, gen p mean: -0.21223293244838715, mean p set: 0.4469238221645355
loss_pred:0.016001341864466667, decouple_loss:0.0031528135295957327
The modified gen p mean: 0.4475514888763428, gen p mean: -0.21166886389255524, mean p set: 0.44812965393066406The modified gen p mean: 0.44583573937416077, gen p mean: -0.21247431635856628, mean p set: 0.4463599622249603
loss_pred:0.015799015760421753, decouple_loss:0.002838793443515897
loss_pred:0.015664653852581978, decouple_loss:0.0034554172307252884
Iteration: 2597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456961750984192, gen p mean: -0.20752841234207153, mean p set: 0.446274995803833
loss_pred:0.015711316838860512, decouple_loss:0.002895160811021924
The modified gen p mean: 0.4458196759223938, gen p mean: -0.211477130651474, mean p set: 0.44639402627944946
loss_pred:0.015484715811908245, decouple_loss:0.002908874535933137
The modified gen p mean: 0.4461323320865631, gen p mean: -0.20782563090324402, mean p set: 0.44666188955307007
loss_pred:0.015725528821349144, decouple_loss:0.0028811958618462086
Iteration: 2598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44627800583839417, gen p mean: -0.21615956723690033, mean p set: 0.4468485414981842
loss_pred:0.015358098782598972, decouple_loss:0.003228625515475869
The modified gen p mean: 0.44560062885284424, gen p mean: -0.2167484313249588, mean p set: 0.446174293756485The modified gen p mean: 0.4472060799598694, gen p mean: -0.2170882672071457, mean p set: 0.44773659110069275
loss_pred:0.015457508154213428, decouple_loss:0.0036950516514480114
loss_pred:0.015352409332990646, decouple_loss:0.003747520735487342
Iteration: 2599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462306499481201, gen p mean: -0.21280188858509064, mean p set: 0.4468083381652832
loss_pred:0.015455618500709534, decouple_loss:0.003476327983662486
The modified gen p mean: 0.4465107321739197, gen p mean: -0.2143445611000061, mean p set: 0.4470827281475067
loss_pred:0.015276582911610603, decouple_loss:0.002879834035411477
The modified gen p mean: 0.4466099739074707, gen p mean: -0.21741054952144623, mean p set: 0.44713932275772095
loss_pred:0.015387896448373795, decouple_loss:0.002524744952097535
Iteration: 2600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464305341243744, gen p mean: -0.20858453214168549, mean p set: 0.447003036737442
loss_pred:0.0156388022005558, decouple_loss:0.003252655267715454
The modified gen p mean: 0.4470541179180145, gen p mean: -0.21264982223510742, mean p set: 0.4476345181465149
loss_pred:0.015393389388918877, decouple_loss:0.0028386039193719625
The modified gen p mean: 0.44670820236206055, gen p mean: -0.209504634141922, mean p set: 0.44723621010780334
loss_pred:0.01540474034845829, decouple_loss:0.00317200506106019
2023-04-27 10:55:04 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21087469160556793, mean p set: 0.4499112665653229
loss_pred:0.016713514924049377, decouple_loss:0.002853281795978546
The modified gen p mean: 0.4493025541305542, gen p mean: -0.21114395558834076, mean p set: 0.4498290419578552
loss_pred:0.01630013808608055, decouple_loss:0.0028089582920074463
The modified gen p mean: 0.4482226073741913, gen p mean: -0.2074597030878067, mean p set: 0.44879910349845886
loss_pred:0.016591090708971024, decouple_loss:0.00288441707380116
WV_1_PC_1_EH_0_PS_30, loss: 0.016677359119057655, avg_mse: 0.024667566642165184
current test mse: 0.024668
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 2601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776198267936707, gen p mean: -0.21453633904457092, mean p set: 0.44829061627388
loss_pred:0.015510166063904762, decouple_loss:0.00291652325540781
The modified gen p mean: 0.4497358500957489, gen p mean: -0.2058248072862625, mean p set: 0.450310081243515
loss_pred:0.015667425468564034, decouple_loss:0.003195778699591756
The modified gen p mean: 0.44982680678367615, gen p mean: -0.21072188019752502, mean p set: 0.4504038989543915
loss_pred:0.015222000889480114, decouple_loss:0.002961682388558984
Iteration: 2602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864577054977417, gen p mean: -0.20419688522815704, mean p set: 0.4491713047027588
loss_pred:0.015903646126389503, decouple_loss:0.0031669491436332464
The modified gen p mean: 0.4500162601470947, gen p mean: -0.21266591548919678, mean p set: 0.45059165358543396
The modified gen p mean: 0.4486970007419586, gen p mean: -0.2065957635641098, mean p set: 0.44927287101745605
loss_pred:0.015645822510123253, decouple_loss:0.0030363984405994415
loss_pred:0.015683965757489204, decouple_loss:0.0035628750920295715
Iteration: 2603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977593421936035, gen p mean: -0.20493295788764954, mean p set: 0.4503089487552643
loss_pred:0.014721800573170185, decouple_loss:0.002534146886318922
The modified gen p mean: 0.447846919298172, gen p mean: -0.20948387682437897, mean p set: 0.44842392206192017
The modified gen p mean: 0.44852182269096375, gen p mean: -0.20637305080890656, mean p set: 0.44910159707069397
loss_pred:0.015253365971148014, decouple_loss:0.002597280777990818
loss_pred:0.01548328623175621, decouple_loss:0.002846354153007269
Iteration: 2604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484685957431793, gen p mean: -0.20521141588687897, mean p set: 0.44899484515190125
loss_pred:0.016191579401493073, decouple_loss:0.002868805779144168
The modified gen p mean: 0.4474680721759796, gen p mean: -0.2129300981760025, mean p set: 0.4480412006378174
The modified gen p mean: 0.4491848945617676, gen p mean: -0.20357222855091095, mean p set: 0.4497624933719635
loss_pred:0.015501891262829304, decouple_loss:0.002897399477660656
loss_pred:0.015420196577906609, decouple_loss:0.002877010963857174
Iteration: 2605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488310217857361, gen p mean: -0.20117278397083282, mean p set: 0.44941237568855286
loss_pred:0.015683719888329506, decouple_loss:0.0026283308397978544
The modified gen p mean: 0.44917258620262146, gen p mean: -0.20484288036823273, mean p set: 0.4496983587741852The modified gen p mean: 0.44946324825286865, gen p mean: -0.2034292370080948, mean p set: 0.45003435015678406
loss_pred:0.015535393729805946, decouple_loss:0.0027925618924200535
loss_pred:0.015020571649074554, decouple_loss:0.0024014771915972233
Iteration: 2606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790977239608765, gen p mean: -0.206316739320755, mean p set: 0.44848892092704773
loss_pred:0.015600626356899738, decouple_loss:0.0029541582334786654
The modified gen p mean: 0.44948339462280273, gen p mean: -0.1989426463842392, mean p set: 0.4500153958797455The modified gen p mean: 0.44869256019592285, gen p mean: -0.20254497230052948, mean p set: 0.4492739737033844
loss_pred:0.015673495829105377, decouple_loss:0.0027583737391978502
loss_pred:0.014544364996254444, decouple_loss:0.0032874788157641888
Iteration: 2607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865939021110535, gen p mean: -0.20741429924964905, mean p set: 0.449236124753952
loss_pred:0.015106510370969772, decouple_loss:0.0024014378432184458
The modified gen p mean: 0.44834864139556885, gen p mean: -0.2003549337387085, mean p set: 0.4488753378391266The modified gen p mean: 0.4499455988407135, gen p mean: -0.20126008987426758, mean p set: 0.450520396232605
loss_pred:0.01509538758546114, decouple_loss:0.0027485578320920467
loss_pred:0.015545021742582321, decouple_loss:0.0025448251981288195
Iteration: 2608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479281008243561, gen p mean: -0.2138083130121231, mean p set: 0.44850850105285645
loss_pred:0.014697798527777195, decouple_loss:0.002433661138638854
The modified gen p mean: 0.44839492440223694, gen p mean: -0.20457196235656738, mean p set: 0.44897210597991943
loss_pred:0.01541550736874342, decouple_loss:0.002665451494976878
The modified gen p mean: 0.44902098178863525, gen p mean: -0.21102507412433624, mean p set: 0.4495515525341034
loss_pred:0.015254785306751728, decouple_loss:0.0024172060657292604
Iteration: 2609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493559002876282, gen p mean: -0.2094908356666565, mean p set: 0.4499305486679077
loss_pred:0.01477372832596302, decouple_loss:0.0023642745800316334
The modified gen p mean: 0.4489075243473053, gen p mean: -0.21096423268318176, mean p set: 0.4494836926460266
loss_pred:0.01511420588940382, decouple_loss:0.002859600353986025
The modified gen p mean: 0.4495176076889038, gen p mean: -0.20558594167232513, mean p set: 0.45004376769065857
loss_pred:0.014149194583296776, decouple_loss:0.002488630125299096
Iteration: 2610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876283407211304, gen p mean: -0.20802442729473114, mean p set: 0.44933852553367615
loss_pred:0.015141280367970467, decouple_loss:0.0027538847643882036
The modified gen p mean: 0.448830783367157, gen p mean: -0.2087841033935547, mean p set: 0.4493550956249237The modified gen p mean: 0.45096179842948914, gen p mean: -0.20074255764484406, mean p set: 0.4515393376350403
loss_pred:0.015184539370238781, decouple_loss:0.0033938090782612562
loss_pred:0.015155358240008354, decouple_loss:0.0032826841343194246
2023-04-27 10:59:10 testing...
The modified gen p mean: 0.4482278525829315, gen p mean: -0.20950835943222046, mean p set: 0.44879910349845886
loss_pred:0.01669900491833687, decouple_loss:0.0027033425867557526
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21270743012428284, mean p set: 0.4499112665653229
loss_pred:0.016808481886982918, decouple_loss:0.002837770152837038
The modified gen p mean: 0.44929972290992737, gen p mean: -0.21303485333919525, mean p set: 0.4498290419578552
loss_pred:0.01642853394150734, decouple_loss:0.0027617551386356354
WV_1_PC_1_EH_0_PS_30, loss: 0.01678372174501419, avg_mse: 0.024891633540391922
current test mse: 0.024892
Iteration: 2611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495199918746948, gen p mean: -0.2107430100440979, mean p set: 0.4500974118709564
loss_pred:0.014955147169530392, decouple_loss:0.0026074976194649935
The modified gen p mean: 0.4477888345718384, gen p mean: -0.21464098989963531, mean p set: 0.4483579099178314
loss_pred:0.014414415694773197, decouple_loss:0.002451653126627207
The modified gen p mean: 0.4489879012107849, gen p mean: -0.20526231825351715, mean p set: 0.4495154023170471
loss_pred:0.014718868769705296, decouple_loss:0.0026210197247564793
Iteration: 2612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911229610443115, gen p mean: -0.20554319024085999, mean p set: 0.44964277744293213
loss_pred:0.015439365990459919, decouple_loss:0.0026946000289171934
The modified gen p mean: 0.44799596071243286, gen p mean: -0.21152903139591217, mean p set: 0.4485754370689392
loss_pred:0.015625670552253723, decouple_loss:0.0031693316996097565
The modified gen p mean: 0.44900545477867126, gen p mean: -0.2134089171886444, mean p set: 0.4495806396007538
loss_pred:0.014520416967570782, decouple_loss:0.0025103408843278885
Iteration: 2613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846218824386597, gen p mean: -0.20816399157047272, mean p set: 0.4489958584308624
loss_pred:0.015263848006725311, decouple_loss:0.002484036609530449
The modified gen p mean: 0.4493362009525299, gen p mean: -0.21898934245109558, mean p set: 0.44991445541381836
loss_pred:0.01540814433246851, decouple_loss:0.0024889602791517973
The modified gen p mean: 0.4492887556552887, gen p mean: -0.20965275168418884, mean p set: 0.44986000657081604
loss_pred:0.014912125654518604, decouple_loss:0.002566871466115117
Iteration: 2614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506431519985199, gen p mean: -0.20884113013744354, mean p set: 0.451172411441803
loss_pred:0.015282289125025272, decouple_loss:0.0026661623269319534
The modified gen p mean: 0.44891002774238586, gen p mean: -0.21349072456359863, mean p set: 0.4494885504245758
loss_pred:0.01613037846982479, decouple_loss:0.00252061290666461
The modified gen p mean: 0.44997137784957886, gen p mean: -0.2103949934244156, mean p set: 0.45054665207862854
loss_pred:0.01501304842531681, decouple_loss:0.0025896260049194098
Iteration: 2615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783326983451843, gen p mean: -0.20470796525478363, mean p set: 0.4484051764011383
loss_pred:0.015149252489209175, decouple_loss:0.002738676033914089
The modified gen p mean: 0.44920381903648376, gen p mean: -0.20800459384918213, mean p set: 0.44977647066116333The modified gen p mean: 0.4482977092266083, gen p mean: -0.20901533961296082, mean p set: 0.4488248825073242
loss_pred:0.014846808277070522, decouple_loss:0.0026933138724416494
loss_pred:0.015425026416778564, decouple_loss:0.002541417721658945
Iteration: 2616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787168502807617, gen p mean: -0.21366563439369202, mean p set: 0.4484458863735199
loss_pred:0.015382957644760609, decouple_loss:0.002492136089131236
The modified gen p mean: 0.44818928837776184, gen p mean: -0.21325434744358063, mean p set: 0.44871246814727783The modified gen p mean: 0.44920992851257324, gen p mean: -0.209095299243927, mean p set: 0.4497894048690796
loss_pred:0.015086477622389793, decouple_loss:0.002639986341819167
loss_pred:0.01565428450703621, decouple_loss:0.0024044488091021776
Iteration: 2617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477473497390747, gen p mean: -0.20993924140930176, mean p set: 0.44832560420036316
loss_pred:0.015020702965557575, decouple_loss:0.002447820734232664
The modified gen p mean: 0.44813963770866394, gen p mean: -0.20538552105426788, mean p set: 0.4487136900424957
loss_pred:0.015639806166291237, decouple_loss:0.00243271142244339
The modified gen p mean: 0.4484848380088806, gen p mean: -0.20038531720638275, mean p set: 0.44901344180107117
loss_pred:0.015279577113687992, decouple_loss:0.002781095216050744
Iteration: 2618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481779634952545, gen p mean: -0.20880228281021118, mean p set: 0.4487546384334564
loss_pred:0.015398905612528324, decouple_loss:0.002613332588225603
The modified gen p mean: 0.44939184188842773, gen p mean: -0.20130467414855957, mean p set: 0.44996556639671326
loss_pred:0.014882891438901424, decouple_loss:0.0025822005700320005
The modified gen p mean: 0.4484780728816986, gen p mean: -0.20758794248104095, mean p set: 0.4490082263946533
loss_pred:0.014816241338849068, decouple_loss:0.002649439498782158
Iteration: 2619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935452938079834, gen p mean: -0.2064504623413086, mean p set: 0.4499303698539734
loss_pred:0.015902642160654068, decouple_loss:0.0029286742210388184
The modified gen p mean: 0.4491395950317383, gen p mean: -0.20392146706581116, mean p set: 0.44971972703933716
loss_pred:0.015041347593069077, decouple_loss:0.0022148271091282368
The modified gen p mean: 0.44856712222099304, gen p mean: -0.2001495063304901, mean p set: 0.44910016655921936
loss_pred:0.015600931830704212, decouple_loss:0.0022783975582569838
Iteration: 2620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880378246307373, gen p mean: -0.2065354287624359, mean p set: 0.4493807256221771
loss_pred:0.0149445291608572, decouple_loss:0.0024194244761019945
The modified gen p mean: 0.4477764368057251, gen p mean: -0.21247349679470062, mean p set: 0.44834738969802856The modified gen p mean: 0.4489613473415375, gen p mean: -0.20442897081375122, mean p set: 0.4494929015636444
loss_pred:0.014863649383187294, decouple_loss:0.0023161110002547503
loss_pred:0.015330801717936993, decouple_loss:0.002229242818430066
2023-04-27 11:02:35 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2156040072441101, mean p set: 0.4499112665653229
loss_pred:0.016876520588994026, decouple_loss:0.002689725486561656
The modified gen p mean: 0.4492989778518677, gen p mean: -0.21614448726177216, mean p set: 0.4498290419578552
loss_pred:0.016475850716233253, decouple_loss:0.0025028919335454702
The modified gen p mean: 0.44822853803634644, gen p mean: -0.2125348150730133, mean p set: 0.44879910349845886
loss_pred:0.01677425019443035, decouple_loss:0.002393277594819665
WV_1_PC_1_EH_0_PS_30, loss: 0.016835305839776993, avg_mse: 0.02493199333548546
current test mse: 0.024932
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 2621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727808237075806, gen p mean: -0.21723304688930511, mean p set: 0.44780340790748596
loss_pred:0.01523774117231369, decouple_loss:0.002211471786722541
The modified gen p mean: 0.4478153884410858, gen p mean: -0.2160726636648178, mean p set: 0.44838836789131165
loss_pred:0.01443380955606699, decouple_loss:0.0024915118701756
The modified gen p mean: 0.44792065024375916, gen p mean: -0.20894332230091095, mean p set: 0.4484962224960327
loss_pred:0.014929886907339096, decouple_loss:0.0024256412871181965
Iteration: 2622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649749994277954, gen p mean: -0.21422389149665833, mean p set: 0.4470282196998596
loss_pred:0.01478252001106739, decouple_loss:0.002134606707841158
The modified gen p mean: 0.4479428231716156, gen p mean: -0.2140781283378601, mean p set: 0.44852009415626526
The modified gen p mean: 0.4477236270904541, gen p mean: -0.21214665472507477, mean p set: 0.4483005702495575
loss_pred:0.014971425756812096, decouple_loss:0.002546577015891671
loss_pred:0.01558227650821209, decouple_loss:0.002399009419605136
Iteration: 2623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455772042274475, gen p mean: -0.20953021943569183, mean p set: 0.4461096227169037
loss_pred:0.01490235235542059, decouple_loss:0.0024270350113511086
The modified gen p mean: 0.4471937119960785, gen p mean: -0.21276766061782837, mean p set: 0.4477671980857849
The modified gen p mean: 0.4480259418487549, gen p mean: -0.20983406901359558, mean p set: 0.44860121607780457
loss_pred:0.014928859658539295, decouple_loss:0.002483983291313052
loss_pred:0.014342976734042168, decouple_loss:0.002471438143402338
Iteration: 2624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486221373081207, gen p mean: -0.21098801493644714, mean p set: 0.4491502642631531
loss_pred:0.015201644040644169, decouple_loss:0.0029368121176958084
The modified gen p mean: 0.44836315512657166, gen p mean: -0.21343164145946503, mean p set: 0.448940247297287
The modified gen p mean: 0.4485570788383484, gen p mean: -0.206776425242424, mean p set: 0.44913291931152344
loss_pred:0.01503728423267603, decouple_loss:0.002996325958520174
loss_pred:0.015317058190703392, decouple_loss:0.00316923251375556
Iteration: 2625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480469822883606, gen p mean: -0.2099994570016861, mean p set: 0.44862261414527893
loss_pred:0.014438692480325699, decouple_loss:0.002386462176218629
The modified gen p mean: 0.4476684629917145, gen p mean: -0.20872890949249268, mean p set: 0.4481982886791229The modified gen p mean: 0.44678202271461487, gen p mean: -0.20836377143859863, mean p set: 0.4473542869091034
loss_pred:0.014687011018395424, decouple_loss:0.0023319681640714407
loss_pred:0.014782552607357502, decouple_loss:0.0025601370725780725
Iteration: 2626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694268703460693, gen p mean: -0.21192295849323273, mean p set: 0.4475173056125641
loss_pred:0.014929058030247688, decouple_loss:0.002819205867126584
The modified gen p mean: 0.44628292322158813, gen p mean: -0.21228255331516266, mean p set: 0.4468632936477661
loss_pred:0.014804459176957607, decouple_loss:0.002444487763568759
The modified gen p mean: 0.4462321996688843, gen p mean: -0.20917809009552002, mean p set: 0.44676437973976135
loss_pred:0.014774919487535954, decouple_loss:0.0028287998866289854
Iteration: 2627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486794173717499, gen p mean: -0.21007207036018372, mean p set: 0.44924822449684143
loss_pred:0.01465149037539959, decouple_loss:0.0028149683494120836
The modified gen p mean: 0.44854530692100525, gen p mean: -0.20649394392967224, mean p set: 0.4491216838359833
loss_pred:0.014614981599152088, decouple_loss:0.002713824389502406
The modified gen p mean: 0.4468061923980713, gen p mean: -0.2155333161354065, mean p set: 0.4473342299461365
loss_pred:0.014933518134057522, decouple_loss:0.0027009989134967327
Iteration: 2628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476868510246277, gen p mean: -0.2108675241470337, mean p set: 0.4482652246952057
loss_pred:0.014747043140232563, decouple_loss:0.0026847044937312603
The modified gen p mean: 0.4486004412174225, gen p mean: -0.20871864259243011, mean p set: 0.44917070865631104
loss_pred:0.015027719549834728, decouple_loss:0.002816400257870555
The modified gen p mean: 0.44592610001564026, gen p mean: -0.2144472748041153, mean p set: 0.44645851850509644
loss_pred:0.014400412328541279, decouple_loss:0.0022387951612472534
Iteration: 2629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446683794260025, gen p mean: -0.21235623955726624, mean p set: 0.4472596049308777
loss_pred:0.014928989112377167, decouple_loss:0.0025685119908303022
The modified gen p mean: 0.4473417401313782, gen p mean: -0.21674208343029022, mean p set: 0.4479212760925293
loss_pred:0.01460008230060339, decouple_loss:0.0030514185782521963
The modified gen p mean: 0.44784945249557495, gen p mean: -0.21303267776966095, mean p set: 0.44837847352027893
loss_pred:0.014667400158941746, decouple_loss:0.0024262440856546164
Iteration: 2630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732242822647095, gen p mean: -0.21195989847183228, mean p set: 0.44789940118789673
loss_pred:0.01542193815112114, decouple_loss:0.002581897424533963
The modified gen p mean: 0.4483983516693115, gen p mean: -0.21379920840263367, mean p set: 0.44897761940956116
loss_pred:0.014514617621898651, decouple_loss:0.0024673223961144686
The modified gen p mean: 0.44713324308395386, gen p mean: -0.21659910678863525, mean p set: 0.4476650059223175
loss_pred:0.015023572370409966, decouple_loss:0.0024827823508530855
2023-04-27 11:06:41 testing...
The modified gen p mean: 0.4482240080833435, gen p mean: -0.20990367233753204, mean p set: 0.44879910349845886
loss_pred:0.016704093664884567, decouple_loss:0.002495772670954466
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21297699213027954, mean p set: 0.4499112665653229
loss_pred:0.016847427934408188, decouple_loss:0.002661809790879488
The modified gen p mean: 0.44930675625801086, gen p mean: -0.21340405941009521, mean p set: 0.4498290419578552
loss_pred:0.016331171616911888, decouple_loss:0.0025534790474921465
WV_1_PC_1_EH_0_PS_30, loss: 0.016756080090999603, avg_mse: 0.024810105562210083
current test mse: 0.02481
Iteration: 2631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476381540298462, gen p mean: -0.2112734466791153, mean p set: 0.4482133686542511
loss_pred:0.014819066971540451, decouple_loss:0.0023539969697594643
The modified gen p mean: 0.44683974981307983, gen p mean: -0.21540895104408264, mean p set: 0.4474206268787384
loss_pred:0.01488740649074316, decouple_loss:0.0025105776730924845
The modified gen p mean: 0.44755953550338745, gen p mean: -0.2095411866903305, mean p set: 0.4480895698070526
loss_pred:0.014555612578988075, decouple_loss:0.0021756559144705534
Iteration: 2632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725584983825684, gen p mean: -0.2191498726606369, mean p set: 0.44778600335121155
loss_pred:0.01480281911790371, decouple_loss:0.0027492274530231953
The modified gen p mean: 0.4463781416416168, gen p mean: -0.2176305651664734, mean p set: 0.44695839285850525
loss_pred:0.014657815918326378, decouple_loss:0.0023804979864507914
The modified gen p mean: 0.44755977392196655, gen p mean: -0.2196262776851654, mean p set: 0.44813501834869385
loss_pred:0.01502248551696539, decouple_loss:0.002751524094492197
Iteration: 2633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483362138271332, gen p mean: -0.22079475224018097, mean p set: 0.44886934757232666
loss_pred:0.014450562186539173, decouple_loss:0.003546602325513959
The modified gen p mean: 0.44681164622306824, gen p mean: -0.2237776666879654, mean p set: 0.4473881721496582
loss_pred:0.014673956669867039, decouple_loss:0.0022723267320543528
The modified gen p mean: 0.4487936794757843, gen p mean: -0.2168908566236496, mean p set: 0.44937047362327576
loss_pred:0.015055832453072071, decouple_loss:0.003454261226579547
Iteration: 2634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474712908267975, gen p mean: -0.21786467730998993, mean p set: 0.44800058007240295
loss_pred:0.014313029125332832, decouple_loss:0.0022540087811648846
The modified gen p mean: 0.44807353615760803, gen p mean: -0.21691375970840454, mean p set: 0.4486541748046875
loss_pred:0.014931256882846355, decouple_loss:0.0031112630385905504
The modified gen p mean: 0.44714081287384033, gen p mean: -0.21739380061626434, mean p set: 0.4477144777774811
loss_pred:0.014496688731014729, decouple_loss:0.0025295300874859095
Iteration: 2635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476082921028137, gen p mean: -0.21566304564476013, mean p set: 0.4481835961341858
loss_pred:0.014819617383182049, decouple_loss:0.003000483149662614
The modified gen p mean: 0.44745132327079773, gen p mean: -0.21431724727153778, mean p set: 0.4480327069759369
loss_pred:0.014292304404079914, decouple_loss:0.002996658207848668
The modified gen p mean: 0.4476450979709625, gen p mean: -0.22081440687179565, mean p set: 0.44817450642585754
loss_pred:0.014836783520877361, decouple_loss:0.0027669896371662617
Iteration: 2636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739821553230286, gen p mean: -0.21812810003757477, mean p set: 0.4479711353778839
loss_pred:0.01481505949050188, decouple_loss:0.0023157403338700533
The modified gen p mean: 0.4476066529750824, gen p mean: -0.21363244950771332, mean p set: 0.4481825828552246
loss_pred:0.014239663258194923, decouple_loss:0.0021553216502070427
The modified gen p mean: 0.4478492736816406, gen p mean: -0.21516939997673035, mean p set: 0.4483788311481476
loss_pred:0.014987137168645859, decouple_loss:0.002381782280281186
Iteration: 2637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469233751296997, gen p mean: -0.2177853137254715, mean p set: 0.4475003480911255
loss_pred:0.014634164981544018, decouple_loss:0.002321485197171569
The modified gen p mean: 0.4473831355571747, gen p mean: -0.2172183096408844, mean p set: 0.4479547441005707
loss_pred:0.014290118589997292, decouple_loss:0.0022512299474328756
The modified gen p mean: 0.448070764541626, gen p mean: -0.2109476774930954, mean p set: 0.44860079884529114
loss_pred:0.014796359464526176, decouple_loss:0.003079549875110388
Iteration: 2638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446699321269989, gen p mean: -0.2160888910293579, mean p set: 0.44727250933647156
loss_pred:0.014693624339997768, decouple_loss:0.0023362860083580017
The modified gen p mean: 0.4473351836204529, gen p mean: -0.21432144939899445, mean p set: 0.44791606068611145
loss_pred:0.01510827336460352, decouple_loss:0.002435355680063367
The modified gen p mean: 0.4476872980594635, gen p mean: -0.21444113552570343, mean p set: 0.44821637868881226
loss_pred:0.01487498078495264, decouple_loss:0.0027441303245723248
Iteration: 2639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477335512638092, gen p mean: -0.2163175791501999, mean p set: 0.4483039677143097
loss_pred:0.014207209460437298, decouple_loss:0.0029117166996002197
The modified gen p mean: 0.4471917748451233, gen p mean: -0.2198621779680252, mean p set: 0.4477669298648834
loss_pred:0.014822127297520638, decouple_loss:0.0031956841703504324
The modified gen p mean: 0.44757765531539917, gen p mean: -0.21640639007091522, mean p set: 0.4481063485145569
loss_pred:0.015165655873715878, decouple_loss:0.003019217401742935
Iteration: 2640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447327584028244, gen p mean: -0.21046657860279083, mean p set: 0.4479072690010071
loss_pred:0.014818931929767132, decouple_loss:0.002464042278006673
The modified gen p mean: 0.4468693435192108, gen p mean: -0.21616476774215698, mean p set: 0.4474402070045471
loss_pred:0.014985170215368271, decouple_loss:0.0025650891475379467
The modified gen p mean: 0.4471522569656372, gen p mean: -0.21714235842227936, mean p set: 0.4476828873157501
loss_pred:0.014424453489482403, decouple_loss:0.002649029018357396
2023-04-27 11:10:07 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21221980452537537, mean p set: 0.4499112665653229
loss_pred:0.01680626906454563, decouple_loss:0.0028796708211302757
The modified gen p mean: 0.44822078943252563, gen p mean: -0.2093532830476761, mean p set: 0.44879910349845886
loss_pred:0.01671513170003891, decouple_loss:0.0026743290945887566
The modified gen p mean: 0.4492984414100647, gen p mean: -0.2127709686756134, mean p set: 0.4498290419578552
loss_pred:0.016334103420376778, decouple_loss:0.0027440269477665424
WV_1_PC_1_EH_0_PS_30, loss: 0.016756802797317505, avg_mse: 0.024807831272482872
current test mse: 0.024808
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 2641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876930117607117, gen p mean: -0.21391382813453674, mean p set: 0.44929543137550354
loss_pred:0.014842460863292217, decouple_loss:0.0030133728869259357
The modified gen p mean: 0.4471554160118103, gen p mean: -0.21310532093048096, mean p set: 0.4477330446243286
loss_pred:0.015163561329245567, decouple_loss:0.0026933043263852596
The modified gen p mean: 0.4480280578136444, gen p mean: -0.21068598330020905, mean p set: 0.44860541820526123
loss_pred:0.015344308689236641, decouple_loss:0.0025939277838915586
Iteration: 2642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484919309616089, gen p mean: -0.21935760974884033, mean p set: 0.4490198791027069
loss_pred:0.015347817912697792, decouple_loss:0.0023565497249364853
The modified gen p mean: 0.4481179416179657, gen p mean: -0.21518725156784058, mean p set: 0.44869574904441833
loss_pred:0.015232304111123085, decouple_loss:0.0030596042051911354
The modified gen p mean: 0.4476848840713501, gen p mean: -0.21530112624168396, mean p set: 0.4482649564743042
loss_pred:0.015126453712582588, decouple_loss:0.0024376094806939363
Iteration: 2643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483499228954315, gen p mean: -0.21749082207679749, mean p set: 0.4488748610019684
loss_pred:0.015645988285541534, decouple_loss:0.0027547571808099747
The modified gen p mean: 0.44761306047439575, gen p mean: -0.21485356986522675, mean p set: 0.4481905400753021
loss_pred:0.015160205774009228, decouple_loss:0.0023689549416303635
The modified gen p mean: 0.4474911391735077, gen p mean: -0.22544538974761963, mean p set: 0.4480707347393036
loss_pred:0.015756795182824135, decouple_loss:0.002789410063996911
Iteration: 2644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609618186950684, gen p mean: -0.22089576721191406, mean p set: 0.4466237425804138
loss_pred:0.015069535933434963, decouple_loss:0.0023680846206843853
The modified gen p mean: 0.44654953479766846, gen p mean: -0.22142180800437927, mean p set: 0.4471263289451599
loss_pred:0.014306130819022655, decouple_loss:0.002340502105653286
The modified gen p mean: 0.4467930197715759, gen p mean: -0.22036513686180115, mean p set: 0.447368323802948
loss_pred:0.015149812214076519, decouple_loss:0.002403796650469303
Iteration: 2645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447936475276947, gen p mean: -0.21684245765209198, mean p set: 0.4485156238079071
loss_pred:0.014375556260347366, decouple_loss:0.0025939196348190308
The modified gen p mean: 0.4496530294418335, gen p mean: -0.22078287601470947, mean p set: 0.45018208026885986The modified gen p mean: 0.4474814236164093, gen p mean: -0.22211863100528717, mean p set: 0.4480571746826172
loss_pred:0.013772619888186455, decouple_loss:0.0023978427052497864
loss_pred:0.015207343734800816, decouple_loss:0.0025468275416642427
Iteration: 2646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732606410980225, gen p mean: -0.2203308641910553, mean p set: 0.4479025602340698
loss_pred:0.014585222117602825, decouple_loss:0.0027839383110404015
The modified gen p mean: 0.44812294840812683, gen p mean: -0.212725430727005, mean p set: 0.4486992359161377
loss_pred:0.01558667328208685, decouple_loss:0.003098313929513097
The modified gen p mean: 0.44818830490112305, gen p mean: -0.21645468473434448, mean p set: 0.44871997833251953
loss_pred:0.0144976070150733, decouple_loss:0.0029267172794789076
Iteration: 2647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483340382575989, gen p mean: -0.21235759556293488, mean p set: 0.4489106833934784
loss_pred:0.015259952284395695, decouple_loss:0.002634761156514287
The modified gen p mean: 0.4463232755661011, gen p mean: -0.21575121581554413, mean p set: 0.4468948543071747
loss_pred:0.014527251943945885, decouple_loss:0.002452527405694127
The modified gen p mean: 0.4493982791900635, gen p mean: -0.21600957214832306, mean p set: 0.4499242305755615
loss_pred:0.014744607731699944, decouple_loss:0.00249471259303391
Iteration: 2648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447308748960495, gen p mean: -0.21685901284217834, mean p set: 0.4478845000267029
loss_pred:0.014349810779094696, decouple_loss:0.0022342270240187645
The modified gen p mean: 0.44757694005966187, gen p mean: -0.21379435062408447, mean p set: 0.4481564164161682
loss_pred:0.01484065130352974, decouple_loss:0.0024190146941691637
The modified gen p mean: 0.44613009691238403, gen p mean: -0.21335989236831665, mean p set: 0.44665804505348206
loss_pred:0.014677116647362709, decouple_loss:0.002345635090023279
Iteration: 2649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484645128250122, gen p mean: -0.22200711071491241, mean p set: 0.44904476404190063
loss_pred:0.015056266449391842, decouple_loss:0.0021641815546900034
The modified gen p mean: 0.4476788640022278, gen p mean: -0.2224636822938919, mean p set: 0.4482479691505432
loss_pred:0.015154422260820866, decouple_loss:0.0023791277781128883
The modified gen p mean: 0.4482784867286682, gen p mean: -0.2190801203250885, mean p set: 0.4488097131252289
loss_pred:0.015130829997360706, decouple_loss:0.002227307762950659
Iteration: 2650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703400135040283, gen p mean: -0.2220306396484375, mean p set: 0.4476125240325928
loss_pred:0.014890315011143684, decouple_loss:0.002518108580261469
The modified gen p mean: 0.4467358887195587, gen p mean: -0.224629744887352, mean p set: 0.447309285402298
loss_pred:0.014416255056858063, decouple_loss:0.0024108539801090956
The modified gen p mean: 0.4469777047634125, gen p mean: -0.2241457849740982, mean p set: 0.44750893115997314
loss_pred:0.014541001990437508, decouple_loss:0.0022592886816710234
2023-04-27 11:14:13 testing...
The modified gen p mean: 0.44822198152542114, gen p mean: -0.21814554929733276, mean p set: 0.44879910349845886
loss_pred:0.016527825966477394, decouple_loss:0.0021753853652626276
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22092798352241516, mean p set: 0.4499112665653229
loss_pred:0.016723254695534706, decouple_loss:0.00237848237156868
The modified gen p mean: 0.44930142164230347, gen p mean: -0.22148121893405914, mean p set: 0.4498290419578552
loss_pred:0.016193905845284462, decouple_loss:0.0022657886147499084
WV_1_PC_1_EH_0_PS_30, loss: 0.016595324501395226, avg_mse: 0.024575475603342056
current test mse: 0.024575
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842666387557983, gen p mean: -0.2212877869606018, mean p set: 0.44900330901145935
loss_pred:0.014448234811425209, decouple_loss:0.0022305885795503855
The modified gen p mean: 0.44945570826530457, gen p mean: -0.22332486510276794, mean p set: 0.4500364065170288
loss_pred:0.014553273096680641, decouple_loss:0.0024178922176361084
The modified gen p mean: 0.44913557171821594, gen p mean: -0.22564950585365295, mean p set: 0.449665904045105
loss_pred:0.014174033887684345, decouple_loss:0.0021983892656862736
Iteration: 2652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702255725860596, gen p mean: -0.22158746421337128, mean p set: 0.44755110144615173
loss_pred:0.015241359360516071, decouple_loss:0.0024310231674462557
The modified gen p mean: 0.4488213062286377, gen p mean: -0.2240094095468521, mean p set: 0.44939976930618286
loss_pred:0.014974595047533512, decouple_loss:0.002814391627907753
The modified gen p mean: 0.4477423429489136, gen p mean: -0.2274090051651001, mean p set: 0.4483180344104767
loss_pred:0.015649549663066864, decouple_loss:0.002702505560591817
Iteration: 2653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778764247894287, gen p mean: -0.22201207280158997, mean p set: 0.44832107424736023
loss_pred:0.015763066709041595, decouple_loss:0.0027254780288785696
The modified gen p mean: 0.4465297758579254, gen p mean: -0.21828961372375488, mean p set: 0.447110116481781
loss_pred:0.015558288432657719, decouple_loss:0.0027800260577350855
The modified gen p mean: 0.4474411904811859, gen p mean: -0.2197771668434143, mean p set: 0.4480155408382416
loss_pred:0.016006987541913986, decouple_loss:0.0025971869472414255
Iteration: 2654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45004507899284363, gen p mean: -0.22225379943847656, mean p set: 0.4505683481693268
loss_pred:0.014307660982012749, decouple_loss:0.002461440162733197
The modified gen p mean: 0.45006272196769714, gen p mean: -0.2236080914735794, mean p set: 0.4506426155567169
loss_pred:0.014503148384392262, decouple_loss:0.0030116443522274494
The modified gen p mean: 0.44707006216049194, gen p mean: -0.2217887043952942, mean p set: 0.4476448595523834
loss_pred:0.015141847543418407, decouple_loss:0.0025351746007800102
Iteration: 2655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478950500488281, gen p mean: -0.22266440093517303, mean p set: 0.448472261428833
loss_pred:0.014427841641008854, decouple_loss:0.0025675110518932343
The modified gen p mean: 0.44830384850502014, gen p mean: -0.2239203006029129, mean p set: 0.4488431215286255The modified gen p mean: 0.4478537142276764, gen p mean: -0.22375278174877167, mean p set: 0.44843170046806335
loss_pred:0.014530233107507229, decouple_loss:0.0028930639382451773
loss_pred:0.014423604123294353, decouple_loss:0.0022858898155391216
Iteration: 2656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797423481941223, gen p mean: -0.22691982984542847, mean p set: 0.4485537111759186
loss_pred:0.015895314514636993, decouple_loss:0.0025455106515437365
The modified gen p mean: 0.44790542125701904, gen p mean: -0.2233564704656601, mean p set: 0.4484834671020508
loss_pred:0.014685975387692451, decouple_loss:0.0024609784595668316
The modified gen p mean: 0.4470122158527374, gen p mean: -0.23031364381313324, mean p set: 0.4475356340408325
loss_pred:0.014531969092786312, decouple_loss:0.002491715829819441
Iteration: 2657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915062189102173, gen p mean: -0.2260347455739975, mean p set: 0.4497232735157013
loss_pred:0.014474661089479923, decouple_loss:0.002419157885015011
The modified gen p mean: 0.44895318150520325, gen p mean: -0.22664867341518402, mean p set: 0.44952166080474854
loss_pred:0.014566469006240368, decouple_loss:0.002281137043610215
The modified gen p mean: 0.4469580054283142, gen p mean: -0.22817112505435944, mean p set: 0.4474853575229645
loss_pred:0.014449660666286945, decouple_loss:0.002720662858337164
Iteration: 2658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468191862106323, gen p mean: -0.22396986186504364, mean p set: 0.4473958909511566
loss_pred:0.014879715628921986, decouple_loss:0.0022790965158492327
The modified gen p mean: 0.44668206572532654, gen p mean: -0.21971318125724792, mean p set: 0.44726231694221497
loss_pred:0.015773117542266846, decouple_loss:0.0025928884278982878
The modified gen p mean: 0.4476720690727234, gen p mean: -0.22385723888874054, mean p set: 0.44819900393486023
loss_pred:0.014833828434348106, decouple_loss:0.0024332895409315825
Iteration: 2659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481544494628906, gen p mean: -0.22205892205238342, mean p set: 0.4487282633781433
loss_pred:0.014891249127686024, decouple_loss:0.002490364946424961
The modified gen p mean: 0.4478392004966736, gen p mean: -0.21745531260967255, mean p set: 0.44841471314430237
loss_pred:0.015208333730697632, decouple_loss:0.0021668493282049894
The modified gen p mean: 0.44758546352386475, gen p mean: -0.2210797369480133, mean p set: 0.4481089115142822
loss_pred:0.015635374933481216, decouple_loss:0.0027240586932748556
Iteration: 2660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676199555397034, gen p mean: -0.22431397438049316, mean p set: 0.4473358392715454
loss_pred:0.014630462974309921, decouple_loss:0.002280350076034665
The modified gen p mean: 0.4481481611728668, gen p mean: -0.22408653795719147, mean p set: 0.4487214982509613
loss_pred:0.01515756081789732, decouple_loss:0.0024066076148301363
The modified gen p mean: 0.4480367600917816, gen p mean: -0.22319190204143524, mean p set: 0.4485693573951721
loss_pred:0.014333252795040607, decouple_loss:0.002327238442376256
2023-04-27 11:17:38 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22375370562076569, mean p set: 0.4499112665653229
loss_pred:0.016725139692425728, decouple_loss:0.0022956484463065863
The modified gen p mean: 0.4492992162704468, gen p mean: -0.22398395836353302, mean p set: 0.4498290419578552
loss_pred:0.016213634982705116, decouple_loss:0.0021672449074685574
The modified gen p mean: 0.44821739196777344, gen p mean: -0.22096917033195496, mean p set: 0.44879910349845886
loss_pred:0.01659257523715496, decouple_loss:0.0021916513796895742
WV_1_PC_1_EH_0_PS_30, loss: 0.016621358692646027, avg_mse: 0.024618875235319138
current test mse: 0.024619
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 2661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744136929512024, gen p mean: -0.2172863632440567, mean p set: 0.448009192943573
loss_pred:0.01565101183950901, decouple_loss:0.0022105469834059477
The modified gen p mean: 0.4467645287513733, gen p mean: -0.21987485885620117, mean p set: 0.44729292392730713
loss_pred:0.01564605161547661, decouple_loss:0.002274844329804182
The modified gen p mean: 0.4457813799381256, gen p mean: -0.22419202327728271, mean p set: 0.44635844230651855
loss_pred:0.015364638529717922, decouple_loss:0.0024081908632069826
Iteration: 2662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485032558441162, gen p mean: -0.22297388315200806, mean p set: 0.4490286707878113
loss_pred:0.015747617930173874, decouple_loss:0.0021028551273047924
The modified gen p mean: 0.44620299339294434, gen p mean: -0.22659097611904144, mean p set: 0.4467789828777313
The modified gen p mean: 0.44658344984054565, gen p mean: -0.22653810679912567, mean p set: 0.44716206192970276
loss_pred:0.015423683449625969, decouple_loss:0.002134284470230341
loss_pred:0.0156845860183239, decouple_loss:0.0022861252073198557
Iteration: 2663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668900966644287, gen p mean: -0.2242928296327591, mean p set: 0.44721704721450806
loss_pred:0.014788109809160233, decouple_loss:0.0022285564336925745
The modified gen p mean: 0.4471239745616913, gen p mean: -0.22807493805885315, mean p set: 0.4477007985115051
The modified gen p mean: 0.4471835792064667, gen p mean: -0.22924873232841492, mean p set: 0.44775307178497314
loss_pred:0.015279218554496765, decouple_loss:0.0024211660493165255
loss_pred:0.014257512986660004, decouple_loss:0.00218754168599844
Iteration: 2664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470568299293518, gen p mean: -0.22426722943782806, mean p set: 0.44758957624435425
loss_pred:0.01547494437545538, decouple_loss:0.0022837226279079914
The modified gen p mean: 0.44637027382850647, gen p mean: -0.22047807276248932, mean p set: 0.44694095849990845
The modified gen p mean: 0.444882869720459, gen p mean: -0.22846391797065735, mean p set: 0.4454576373100281
loss_pred:0.01602468267083168, decouple_loss:0.0023133838549256325
loss_pred:0.015475461259484291, decouple_loss:0.0024286466650664806
Iteration: 2665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477768540382385, gen p mean: -0.21768690645694733, mean p set: 0.44834378361701965
loss_pred:0.014743069186806679, decouple_loss:0.0024004823062568903
The modified gen p mean: 0.44548505544662476, gen p mean: -0.21923403441905975, mean p set: 0.4460590183734894
loss_pred:0.01524589117616415, decouple_loss:0.0023636980913579464
The modified gen p mean: 0.44722306728363037, gen p mean: -0.21282069385051727, mean p set: 0.4477542042732239
loss_pred:0.015590992756187916, decouple_loss:0.0021023997105658054
Iteration: 2666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468444883823395, gen p mean: -0.21616505086421967, mean p set: 0.44741740822792053
loss_pred:0.015905259177088737, decouple_loss:0.00256618345156312
The modified gen p mean: 0.4468798041343689, gen p mean: -0.21783515810966492, mean p set: 0.4474574029445648
loss_pred:0.014990700408816338, decouple_loss:0.002661961130797863
The modified gen p mean: 0.4449567496776581, gen p mean: -0.2248733788728714, mean p set: 0.44549062848091125
loss_pred:0.014857183210551739, decouple_loss:0.002581088338047266
Iteration: 2667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692251086235046, gen p mean: -0.2221614122390747, mean p set: 0.4474954903125763
loss_pred:0.015261056832969189, decouple_loss:0.002655111951753497
The modified gen p mean: 0.4465499818325043, gen p mean: -0.22478289902210236, mean p set: 0.44708412885665894The modified gen p mean: 0.4481929838657379, gen p mean: -0.2185649424791336, mean p set: 0.44876447319984436
loss_pred:0.014742463827133179, decouple_loss:0.002724976744502783
loss_pred:0.015313281677663326, decouple_loss:0.0026800658088177443
Iteration: 2668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461749792098999, gen p mean: -0.22012387216091156, mean p set: 0.446748286485672
loss_pred:0.01557545643299818, decouple_loss:0.0023385381791740656
The modified gen p mean: 0.4466012716293335, gen p mean: -0.22032544016838074, mean p set: 0.44717955589294434
loss_pred:0.014763152226805687, decouple_loss:0.002442122669890523
The modified gen p mean: 0.4471493065357208, gen p mean: -0.220486119389534, mean p set: 0.4476804733276367
loss_pred:0.01564113423228264, decouple_loss:0.0024370169267058372
Iteration: 2669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736453890800476, gen p mean: -0.22244983911514282, mean p set: 0.44793781638145447
loss_pred:0.015581010840833187, decouple_loss:0.002606033580377698
The modified gen p mean: 0.44830551743507385, gen p mean: -0.2207375168800354, mean p set: 0.448881059885025
loss_pred:0.014848432503640652, decouple_loss:0.0024643775541335344
The modified gen p mean: 0.4464017152786255, gen p mean: -0.21762971580028534, mean p set: 0.4469318985939026
loss_pred:0.015327919274568558, decouple_loss:0.002571584889665246
Iteration: 2670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477647542953491, gen p mean: -0.2214108258485794, mean p set: 0.4483422338962555
loss_pred:0.014892582781612873, decouple_loss:0.002303219633176923
The modified gen p mean: 0.4468231797218323, gen p mean: -0.21871595084667206, mean p set: 0.44739776849746704
loss_pred:0.014998158439993858, decouple_loss:0.0023877588100731373
The modified gen p mean: 0.44592663645744324, gen p mean: -0.22317658364772797, mean p set: 0.446456640958786
loss_pred:0.015004849061369896, decouple_loss:0.00232106470502913
2023-04-27 11:21:43 testing...
The modified gen p mean: 0.4482279419898987, gen p mean: -0.21521615982055664, mean p set: 0.44879910349845886
loss_pred:0.016555864363908768, decouple_loss:0.0025778908748179674
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2179976850748062, mean p set: 0.4499112665653229
loss_pred:0.016705574467778206, decouple_loss:0.0026366233360022306
The modified gen p mean: 0.4493058919906616, gen p mean: -0.21800631284713745, mean p set: 0.4498290419578552
loss_pred:0.01622067578136921, decouple_loss:0.002661881735548377
WV_1_PC_1_EH_0_PS_30, loss: 0.016625311225652695, avg_mse: 0.024634478613734245
current test mse: 0.024634
Iteration: 2671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712209701538086, gen p mean: -0.22223132848739624, mean p set: 0.44769522547721863
loss_pred:0.01553486380726099, decouple_loss:0.0022785146720707417
The modified gen p mean: 0.4480378031730652, gen p mean: -0.2158358097076416, mean p set: 0.44861549139022827
loss_pred:0.01508353278040886, decouple_loss:0.0021546108182519674
The modified gen p mean: 0.44644495844841003, gen p mean: -0.22191964089870453, mean p set: 0.44696754217147827
loss_pred:0.014167058281600475, decouple_loss:0.0024369836319237947
Iteration: 2672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464992582798004, gen p mean: -0.21708916127681732, mean p set: 0.4470267593860626
loss_pred:0.014954600483179092, decouple_loss:0.002323493594303727
The modified gen p mean: 0.44781383872032166, gen p mean: -0.22044667601585388, mean p set: 0.44838783144950867
loss_pred:0.015020754188299179, decouple_loss:0.002176830777898431
The modified gen p mean: 0.4470396637916565, gen p mean: -0.2160956710577011, mean p set: 0.4476129114627838
loss_pred:0.01559517253190279, decouple_loss:0.00232141325250268
Iteration: 2673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476744532585144, gen p mean: -0.22037945687770844, mean p set: 0.4481981694698334
loss_pred:0.015491425059735775, decouple_loss:0.002443024655804038
The modified gen p mean: 0.44745302200317383, gen p mean: -0.22176064550876617, mean p set: 0.44802701473236084
loss_pred:0.013631247915327549, decouple_loss:0.00263632507994771
The modified gen p mean: 0.44735366106033325, gen p mean: -0.2194291055202484, mean p set: 0.4479331374168396
loss_pred:0.015005216002464294, decouple_loss:0.002491598017513752
Iteration: 2674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783270359039307, gen p mean: -0.2171647846698761, mean p set: 0.4483581483364105
loss_pred:0.014457004144787788, decouple_loss:0.0023479957599192858
The modified gen p mean: 0.44612976908683777, gen p mean: -0.21825915575027466, mean p set: 0.4467063546180725
loss_pred:0.015414437279105186, decouple_loss:0.0023797708563506603
The modified gen p mean: 0.4465133547782898, gen p mean: -0.2214699536561966, mean p set: 0.4470905363559723
loss_pred:0.014917933382093906, decouple_loss:0.002262901747599244
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658803939819336, gen p mean: -0.21423326432704926, mean p set: 0.44716131687164307
loss_pred:0.015253696590662003, decouple_loss:0.0023418862838298082
The modified gen p mean: 0.4489426016807556, gen p mean: -0.21620677411556244, mean p set: 0.4495137631893158The modified gen p mean: 0.4485512971878052, gen p mean: -0.21585488319396973, mean p set: 0.44907715916633606
loss_pred:0.01481418963521719, decouple_loss:0.0023869264405220747
loss_pred:0.01452555414289236, decouple_loss:0.002350299386307597
Iteration: 2676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785937666893005, gen p mean: -0.21539784967899323, mean p set: 0.44844114780426025
loss_pred:0.014887291938066483, decouple_loss:0.002599284751340747
The modified gen p mean: 0.4473184049129486, gen p mean: -0.2121576964855194, mean p set: 0.4478902518749237
loss_pred:0.015333345159888268, decouple_loss:0.002428782870993018
The modified gen p mean: 0.4480501413345337, gen p mean: -0.21503499150276184, mean p set: 0.44858217239379883
loss_pred:0.014740587212145329, decouple_loss:0.0024049789644777775
Iteration: 2677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686922430992126, gen p mean: -0.20899111032485962, mean p set: 0.44744551181793213
loss_pred:0.01489752996712923, decouple_loss:0.002640675287693739
The modified gen p mean: 0.4477383494377136, gen p mean: -0.21178092062473297, mean p set: 0.44831427931785583The modified gen p mean: 0.4457983076572418, gen p mean: -0.21463318169116974, mean p set: 0.4463306665420532
loss_pred:0.01491091400384903, decouple_loss:0.0027022191789001226
loss_pred:0.015115207992494106, decouple_loss:0.002511050319299102
Iteration: 2678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460076093673706, gen p mean: -0.2211247980594635, mean p set: 0.4465861916542053
loss_pred:0.01484689675271511, decouple_loss:0.0025834098923951387
The modified gen p mean: 0.4454071521759033, gen p mean: -0.22406920790672302, mean p set: 0.44598105549812317
loss_pred:0.014756789430975914, decouple_loss:0.002606194233521819
The modified gen p mean: 0.44627538323402405, gen p mean: -0.21584834158420563, mean p set: 0.44680383801460266
loss_pred:0.014960494823753834, decouple_loss:0.0027267970144748688
Iteration: 2679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463348984718323, gen p mean: -0.2157401591539383, mean p set: 0.44690370559692383
loss_pred:0.014870857819914818, decouple_loss:0.0026847408153116703
The modified gen p mean: 0.4475041925907135, gen p mean: -0.22422631084918976, mean p set: 0.44808200001716614
loss_pred:0.01393214799463749, decouple_loss:0.0025845568161457777
The modified gen p mean: 0.44718828797340393, gen p mean: -0.2207196205854416, mean p set: 0.44771286845207214
loss_pred:0.014646919444203377, decouple_loss:0.0026260388549417257
Iteration: 2680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465353786945343, gen p mean: -0.22105585038661957, mean p set: 0.44710773229599
loss_pred:0.015079141594469547, decouple_loss:0.0026655057445168495
The modified gen p mean: 0.4457133412361145, gen p mean: -0.22090919315814972, mean p set: 0.4462839961051941
loss_pred:0.014791563153266907, decouple_loss:0.0025256129447370768
The modified gen p mean: 0.44768303632736206, gen p mean: -0.22221264243125916, mean p set: 0.448209285736084
loss_pred:0.014781618490815163, decouple_loss:0.0024900618009269238
2023-04-27 11:25:09 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2203318327665329, mean p set: 0.4499112665653229
loss_pred:0.01667010597884655, decouple_loss:0.002496866974979639
The modified gen p mean: 0.44929739832878113, gen p mean: -0.22093820571899414, mean p set: 0.4498290419578552
loss_pred:0.016178617253899574, decouple_loss:0.0023071477189660072
The modified gen p mean: 0.4482215940952301, gen p mean: -0.21763360500335693, mean p set: 0.44879910349845886
loss_pred:0.01654770039021969, decouple_loss:0.0024200594052672386
WV_1_PC_1_EH_0_PS_30, loss: 0.016585875302553177, avg_mse: 0.024558033794164658
current test mse: 0.024558
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 2681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864264130592346, gen p mean: -0.2201838493347168, mean p set: 0.44916975498199463
loss_pred:0.015444043092429638, decouple_loss:0.0023511163890361786
The modified gen p mean: 0.44885340332984924, gen p mean: -0.21586264669895172, mean p set: 0.4494262933731079
loss_pred:0.01548826601356268, decouple_loss:0.002612919779494405
The modified gen p mean: 0.4476679563522339, gen p mean: -0.21624968945980072, mean p set: 0.4482443630695343
loss_pred:0.015385972335934639, decouple_loss:0.002460567746311426
Iteration: 2682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472120702266693, gen p mean: -0.22015854716300964, mean p set: 0.4477364122867584
loss_pred:0.015214117243885994, decouple_loss:0.002553315134719014
The modified gen p mean: 0.4494560658931732, gen p mean: -0.223367378115654, mean p set: 0.450029194355011
The modified gen p mean: 0.448414146900177, gen p mean: -0.22477449476718903, mean p set: 0.44898921251296997
loss_pred:0.01526075229048729, decouple_loss:0.002430307911708951
loss_pred:0.01472440455108881, decouple_loss:0.0024166544899344444
Iteration: 2683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485933184623718, gen p mean: -0.21657408773899078, mean p set: 0.44911760091781616
loss_pred:0.01493380218744278, decouple_loss:0.0029295545537024736
The modified gen p mean: 0.44859281182289124, gen p mean: -0.21740251779556274, mean p set: 0.44917428493499756
The modified gen p mean: 0.44811248779296875, gen p mean: -0.21903663873672485, mean p set: 0.4486883282661438
loss_pred:0.01453340332955122, decouple_loss:0.0021411224734038115
loss_pred:0.015103044919669628, decouple_loss:0.0022226914297789335
Iteration: 2684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783538579940796, gen p mean: -0.2131296992301941, mean p set: 0.4483604431152344
loss_pred:0.015117497183382511, decouple_loss:0.0021941219456493855
The modified gen p mean: 0.4474230110645294, gen p mean: -0.216482475399971, mean p set: 0.4479973018169403
The modified gen p mean: 0.4472949504852295, gen p mean: -0.20750124752521515, mean p set: 0.447873055934906
loss_pred:0.014935653656721115, decouple_loss:0.0023581713903695345
loss_pred:0.014980151318013668, decouple_loss:0.002433785703033209
Iteration: 2685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804269075393677, gen p mean: -0.2194184511899948, mean p set: 0.44861912727355957
loss_pred:0.014818345196545124, decouple_loss:0.0028001610189676285
The modified gen p mean: 0.44879522919654846, gen p mean: -0.2193489819765091, mean p set: 0.44937053322792053
loss_pred:0.01508176140487194, decouple_loss:0.002341226674616337
The modified gen p mean: 0.4481582045555115, gen p mean: -0.2169196754693985, mean p set: 0.4486922323703766
loss_pred:0.015179670415818691, decouple_loss:0.00242473348043859
Iteration: 2686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486106336116791, gen p mean: -0.2191246896982193, mean p set: 0.4491857588291168
loss_pred:0.014793111942708492, decouple_loss:0.002348317066207528
The modified gen p mean: 0.44829127192497253, gen p mean: -0.22120608389377594, mean p set: 0.44887199997901917
loss_pred:0.014895382337272167, decouple_loss:0.0021518401335924864
The modified gen p mean: 0.447700172662735, gen p mean: -0.2171197384595871, mean p set: 0.4482291042804718
loss_pred:0.014833561144769192, decouple_loss:0.0021967904176563025
Iteration: 2687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749119877815247, gen p mean: -0.21399712562561035, mean p set: 0.4480650722980499
loss_pred:0.014637219719588757, decouple_loss:0.0026327872183173895
The modified gen p mean: 0.44709891080856323, gen p mean: -0.21609415113925934, mean p set: 0.4476754069328308
loss_pred:0.014839762821793556, decouple_loss:0.0023556675296276808
The modified gen p mean: 0.44941893219947815, gen p mean: -0.2152365744113922, mean p set: 0.44995051622390747
loss_pred:0.01497198548167944, decouple_loss:0.0022301648277789354
Iteration: 2688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486846625804901, gen p mean: -0.21809226274490356, mean p set: 0.4492553174495697
loss_pred:0.014653077349066734, decouple_loss:0.0024806419387459755
The modified gen p mean: 0.4494638442993164, gen p mean: -0.22504349052906036, mean p set: 0.45003825426101685
loss_pred:0.014710577204823494, decouple_loss:0.0022126559633761644
The modified gen p mean: 0.4482458531856537, gen p mean: -0.22127585113048553, mean p set: 0.4487766921520233
loss_pred:0.014796420000493526, decouple_loss:0.0021797996014356613
Iteration: 2689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799187779426575, gen p mean: -0.22002528607845306, mean p set: 0.44856706261634827
loss_pred:0.014790302142500877, decouple_loss:0.0021314870100468397
The modified gen p mean: 0.4485379159450531, gen p mean: -0.22122755646705627, mean p set: 0.4491156041622162
loss_pred:0.014930792152881622, decouple_loss:0.0021262678783386946
The modified gen p mean: 0.4485255479812622, gen p mean: -0.21804997324943542, mean p set: 0.4490547776222229
loss_pred:0.014606909826397896, decouple_loss:0.0021715431939810514
Iteration: 2690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867080450057983, gen p mean: -0.2181096374988556, mean p set: 0.44925105571746826
loss_pred:0.0149131640791893, decouple_loss:0.0026159677654504776
The modified gen p mean: 0.447905957698822, gen p mean: -0.21970558166503906, mean p set: 0.4484765827655792
loss_pred:0.014850864186882973, decouple_loss:0.0023562980350106955
The modified gen p mean: 0.44630300998687744, gen p mean: -0.21863485872745514, mean p set: 0.44683340191841125
loss_pred:0.01546541415154934, decouple_loss:0.0026329790707677603
2023-04-27 11:29:39 testing...
The modified gen p mean: 0.4482212960720062, gen p mean: -0.21559202671051025, mean p set: 0.44879910349845886
loss_pred:0.016442997381091118, decouple_loss:0.0023989370092749596
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21856826543807983, mean p set: 0.4499112665653229
loss_pred:0.01659484952688217, decouple_loss:0.002422037534415722
The modified gen p mean: 0.44930338859558105, gen p mean: -0.21885131299495697, mean p set: 0.4498290419578552
loss_pred:0.01616065204143524, decouple_loss:0.002509400015696883
WV_1_PC_1_EH_0_PS_30, loss: 0.016521673649549484, avg_mse: 0.024496261030435562
current test mse: 0.024496
Iteration: 2691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656649231910706, gen p mean: -0.21897998452186584, mean p set: 0.44714176654815674
loss_pred:0.014778855256736279, decouple_loss:0.0025530806742608547
The modified gen p mean: 0.44809603691101074, gen p mean: -0.21928033232688904, mean p set: 0.4486764669418335
loss_pred:0.014198183082044125, decouple_loss:0.0022269277833402157
The modified gen p mean: 0.4480265974998474, gen p mean: -0.2190990000963211, mean p set: 0.44855865836143494
loss_pred:0.014943007379770279, decouple_loss:0.002551471581682563
Iteration: 2692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483512043952942, gen p mean: -0.2187574803829193, mean p set: 0.4488835632801056
loss_pred:0.014203113503754139, decouple_loss:0.0021590294782072306
The modified gen p mean: 0.44872674345970154, gen p mean: -0.2237880676984787, mean p set: 0.44930675625801086
loss_pred:0.01483841985464096, decouple_loss:0.002224270487204194
The modified gen p mean: 0.44853460788726807, gen p mean: -0.2188206911087036, mean p set: 0.44910916686058044
loss_pred:0.014950361102819443, decouple_loss:0.002163335680961609
Iteration: 2693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448426216840744, gen p mean: -0.21965664625167847, mean p set: 0.44895440340042114
loss_pred:0.014383460395038128, decouple_loss:0.002140440745279193
The modified gen p mean: 0.44795989990234375, gen p mean: -0.21548105776309967, mean p set: 0.44853806495666504
loss_pred:0.014432298019528389, decouple_loss:0.002157728187739849
The modified gen p mean: 0.4485275149345398, gen p mean: -0.21352960169315338, mean p set: 0.44910410046577454
loss_pred:0.015139501541852951, decouple_loss:0.0020344513468444347
Iteration: 2694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479057490825653, gen p mean: -0.21970055997371674, mean p set: 0.4484313726425171
loss_pred:0.014922121539711952, decouple_loss:0.002622914034873247
The modified gen p mean: 0.4484950602054596, gen p mean: -0.22098644077777863, mean p set: 0.44906941056251526
loss_pred:0.014718590304255486, decouple_loss:0.0021937380079180002
The modified gen p mean: 0.447946161031723, gen p mean: -0.22104427218437195, mean p set: 0.4485251009464264
loss_pred:0.015094907023012638, decouple_loss:0.002533430466428399
Iteration: 2695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762641191482544, gen p mean: -0.21194370090961456, mean p set: 0.4482038617134094
loss_pred:0.014694495126605034, decouple_loss:0.0021840601693838835
The modified gen p mean: 0.44873926043510437, gen p mean: -0.22014042735099792, mean p set: 0.44926580786705017The modified gen p mean: 0.44888967275619507, gen p mean: -0.22077983617782593, mean p set: 0.4494645595550537
loss_pred:0.014633242040872574, decouple_loss:0.002228550845757127
loss_pred:0.014772339724004269, decouple_loss:0.0023622363805770874
Iteration: 2696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823357462882996, gen p mean: -0.21823537349700928, mean p set: 0.4488137364387512
loss_pred:0.014979691244661808, decouple_loss:0.0024850729387253523
The modified gen p mean: 0.44737672805786133, gen p mean: -0.22296802699565887, mean p set: 0.4479115903377533The modified gen p mean: 0.44776272773742676, gen p mean: -0.22253461182117462, mean p set: 0.4483354985713959
loss_pred:0.014863692224025726, decouple_loss:0.0021795551292598248
loss_pred:0.014790993183851242, decouple_loss:0.00244470639154315
Iteration: 2697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481390416622162, gen p mean: -0.21917439997196198, mean p set: 0.44871124625205994
loss_pred:0.014849532395601273, decouple_loss:0.0021881943102926016
The modified gen p mean: 0.44869837164878845, gen p mean: -0.22433239221572876, mean p set: 0.4492258131504059The modified gen p mean: 0.4472803473472595, gen p mean: -0.22358830273151398, mean p set: 0.44785305857658386
loss_pred:0.015024629421532154, decouple_loss:0.0020598154515028
loss_pred:0.014954870566725731, decouple_loss:0.0024758970830589533
Iteration: 2698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746485352516174, gen p mean: -0.21837998926639557, mean p set: 0.44804278016090393
loss_pred:0.015190369449555874, decouple_loss:0.002521655522286892
The modified gen p mean: 0.4490431845188141, gen p mean: -0.22151297330856323, mean p set: 0.4496248662471771The modified gen p mean: 0.44796937704086304, gen p mean: -0.219808891415596, mean p set: 0.4484924077987671
loss_pred:0.014758401550352573, decouple_loss:0.002236634958535433
loss_pred:0.014914145693182945, decouple_loss:0.002500631147995591
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862279295921326, gen p mean: -0.21408165991306305, mean p set: 0.4492001235485077
loss_pred:0.014422357082366943, decouple_loss:0.002676595700904727
The modified gen p mean: 0.44910889863967896, gen p mean: -0.21783438324928284, mean p set: 0.449685275554657The modified gen p mean: 0.4489794373512268, gen p mean: -0.21331869065761566, mean p set: 0.44951245188713074
loss_pred:0.014779879711568356, decouple_loss:0.0026481931563466787
loss_pred:0.014393219724297523, decouple_loss:0.0028014779090881348
Iteration: 2700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486290514469147, gen p mean: -0.2116706222295761, mean p set: 0.4492073655128479
loss_pred:0.014206617139279842, decouple_loss:0.0023907397408038378
The modified gen p mean: 0.4485149085521698, gen p mean: -0.21282146871089935, mean p set: 0.4490397274494171The modified gen p mean: 0.4492390751838684, gen p mean: -0.21115230023860931, mean p set: 0.44981372356414795
loss_pred:0.01423741690814495, decouple_loss:0.0025458144955337048
loss_pred:0.014978515915572643, decouple_loss:0.002637585625052452
2023-04-27 11:33:04 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21195928752422333, mean p set: 0.4499112665653229
loss_pred:0.016593847423791885, decouple_loss:0.00298816105350852
The modified gen p mean: 0.44929981231689453, gen p mean: -0.21237045526504517, mean p set: 0.4498290419578552
loss_pred:0.016164235770702362, decouple_loss:0.0031106160022318363
The modified gen p mean: 0.44822803139686584, gen p mean: -0.20915177464485168, mean p set: 0.44879910349845886
loss_pred:0.016467172652482986, decouple_loss:0.003001502016559243
WV_1_PC_1_EH_0_PS_30, loss: 0.016560090705752373, avg_mse: 0.024499861523509026
current test mse: 0.0245
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 2701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849494099617004, gen p mean: -0.20605185627937317, mean p set: 0.44901901483535767
loss_pred:0.015201120637357235, decouple_loss:0.003041895106434822
The modified gen p mean: 0.44837579131126404, gen p mean: -0.2045588195323944, mean p set: 0.44894805550575256
loss_pred:0.014806056395173073, decouple_loss:0.0029892241582274437
The modified gen p mean: 0.44669923186302185, gen p mean: -0.20838864147663116, mean p set: 0.44727620482444763
loss_pred:0.015025263652205467, decouple_loss:0.0023316896986216307
Iteration: 2702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811227917671204, gen p mean: -0.21658651530742645, mean p set: 0.44863688945770264
loss_pred:0.014175725169479847, decouple_loss:0.002875062869861722
The modified gen p mean: 0.44806522130966187, gen p mean: -0.2192099243402481, mean p set: 0.4486437141895294
The modified gen p mean: 0.4483512043952942, gen p mean: -0.2143247425556183, mean p set: 0.44892609119415283
loss_pred:0.014925708062946796, decouple_loss:0.002646722598001361
loss_pred:0.014347493648529053, decouple_loss:0.0029120352119207382
Iteration: 2703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475676417350769, gen p mean: -0.21523506939411163, mean p set: 0.4480955898761749
loss_pred:0.015057744458317757, decouple_loss:0.002830859739333391
The modified gen p mean: 0.4467252790927887, gen p mean: -0.215003103017807, mean p set: 0.44730088114738464
The modified gen p mean: 0.44814619421958923, gen p mean: -0.21700385212898254, mean p set: 0.44872117042541504
loss_pred:0.014743220992386341, decouple_loss:0.0025952470023185015
loss_pred:0.015191527083516121, decouple_loss:0.002697231248021126
Iteration: 2704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474070966243744, gen p mean: -0.2158409059047699, mean p set: 0.4479316174983978
loss_pred:0.015104305930435658, decouple_loss:0.0025432435795664787
The modified gen p mean: 0.44757166504859924, gen p mean: -0.21815724670886993, mean p set: 0.4481446146965027
The modified gen p mean: 0.44964852929115295, gen p mean: -0.21464566886425018, mean p set: 0.4502216577529907
loss_pred:0.015449974685907364, decouple_loss:0.0026145935989916325
loss_pred:0.014839084818959236, decouple_loss:0.0027511545922607183
Iteration: 2705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481198489665985, gen p mean: -0.21926285326480865, mean p set: 0.44869375228881836
loss_pred:0.014610943384468555, decouple_loss:0.0024294217582792044
The modified gen p mean: 0.44883695244789124, gen p mean: -0.22364479303359985, mean p set: 0.4494134187698364The modified gen p mean: 0.4480142891407013, gen p mean: -0.21452367305755615, mean p set: 0.4485420286655426
loss_pred:0.01411472912877798, decouple_loss:0.0026421626098454
loss_pred:0.014805823564529419, decouple_loss:0.0025040446780622005
Iteration: 2706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483215808868408, gen p mean: -0.2264566570520401, mean p set: 0.44889357686042786
loss_pred:0.014417137950658798, decouple_loss:0.002542345318943262
The modified gen p mean: 0.4493401348590851, gen p mean: -0.22494828701019287, mean p set: 0.4498688280582428The modified gen p mean: 0.4476528465747833, gen p mean: -0.21244913339614868, mean p set: 0.44823071360588074
loss_pred:0.014389313757419586, decouple_loss:0.002651091432198882
loss_pred:0.014306421391665936, decouple_loss:0.0026635031681507826
Iteration: 2707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715824723243713, gen p mean: -0.22083862125873566, mean p set: 0.4477364122867584
loss_pred:0.014502108097076416, decouple_loss:0.0023444807156920433
The modified gen p mean: 0.4475477933883667, gen p mean: -0.21812470257282257, mean p set: 0.4481230676174164The modified gen p mean: 0.44882816076278687, gen p mean: -0.22318585216999054, mean p set: 0.44935348629951477
loss_pred:0.014518000185489655, decouple_loss:0.002442646538838744
loss_pred:0.014655903913080692, decouple_loss:0.0022767807822674513
Iteration: 2708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880032539367676, gen p mean: -0.22702480852603912, mean p set: 0.44937342405319214
loss_pred:0.01416128221899271, decouple_loss:0.0023658289574086666
The modified gen p mean: 0.4482842683792114, gen p mean: -0.22289055585861206, mean p set: 0.4488562345504761
loss_pred:0.014502445235848427, decouple_loss:0.002406137064099312
The modified gen p mean: 0.4481137692928314, gen p mean: -0.21528691053390503, mean p set: 0.44864022731781006
loss_pred:0.014761264435946941, decouple_loss:0.002512426348403096
Iteration: 2709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482386112213135, gen p mean: -0.21856923401355743, mean p set: 0.44881969690322876
loss_pred:0.014951970428228378, decouple_loss:0.0024224077351391315
The modified gen p mean: 0.4481438994407654, gen p mean: -0.22282259166240692, mean p set: 0.44871968030929565
loss_pred:0.014102069661021233, decouple_loss:0.002338785445317626
The modified gen p mean: 0.4493122100830078, gen p mean: -0.22167935967445374, mean p set: 0.44984567165374756
loss_pred:0.014568107202649117, decouple_loss:0.0023095293436199427
Iteration: 2710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804883003234863, gen p mean: -0.21701757609844208, mean p set: 0.448621928691864
loss_pred:0.01463637501001358, decouple_loss:0.0022597569040954113
The modified gen p mean: 0.4486742615699768, gen p mean: -0.22245745360851288, mean p set: 0.4492042660713196The modified gen p mean: 0.4484521150588989, gen p mean: -0.21320930123329163, mean p set: 0.44902175664901733
loss_pred:0.014671940356492996, decouple_loss:0.0020149126648902893
loss_pred:0.013905213214457035, decouple_loss:0.0021906974725425243
2023-04-27 11:37:12 testing...
The modified gen p mean: 0.44822439551353455, gen p mean: -0.2167535424232483, mean p set: 0.44879910349845886
loss_pred:0.016590066254138947, decouple_loss:0.0025843014009296894
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21957021951675415, mean p set: 0.4499112665653229
loss_pred:0.016736505553126335, decouple_loss:0.002628432819619775
The modified gen p mean: 0.4493027329444885, gen p mean: -0.22021305561065674, mean p set: 0.4498290419578552
loss_pred:0.01624235138297081, decouple_loss:0.0026251559611409903
WV_1_PC_1_EH_0_PS_30, loss: 0.016653604805469513, avg_mse: 0.02470129169523716
current test mse: 0.024701
Iteration: 2711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485205113887787, gen p mean: -0.214174285531044, mean p set: 0.44909510016441345
loss_pred:0.014520695433020592, decouple_loss:0.0027496586553752422
The modified gen p mean: 0.4492620527744293, gen p mean: -0.21450817584991455, mean p set: 0.44984006881713867
loss_pred:0.01479021180421114, decouple_loss:0.002287285402417183
The modified gen p mean: 0.4476833939552307, gen p mean: -0.21449917554855347, mean p set: 0.4482152760028839
loss_pred:0.01455356739461422, decouple_loss:0.0024003959260880947
Iteration: 2712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052093267440796, gen p mean: -0.21969349682331085, mean p set: 0.4510541558265686
loss_pred:0.01418850664049387, decouple_loss:0.0022628693841397762
The modified gen p mean: 0.44884756207466125, gen p mean: -0.21427662670612335, mean p set: 0.4494239091873169
loss_pred:0.013673956505954266, decouple_loss:0.0023772597778588533
The modified gen p mean: 0.44853612780570984, gen p mean: -0.2200230211019516, mean p set: 0.4491152763366699
loss_pred:0.014071745797991753, decouple_loss:0.0022699988912791014
Iteration: 2713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479682445526123, gen p mean: -0.22153930366039276, mean p set: 0.4484964609146118
loss_pred:0.014141054823994637, decouple_loss:0.0022209605667740107
The modified gen p mean: 0.4480714797973633, gen p mean: -0.21502642333507538, mean p set: 0.448650062084198
loss_pred:0.014401582069694996, decouple_loss:0.002434847177937627
The modified gen p mean: 0.4483488202095032, gen p mean: -0.22316408157348633, mean p set: 0.44891637563705444
loss_pred:0.014612501487135887, decouple_loss:0.0021528666839003563
Iteration: 2714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893988966941833, gen p mean: -0.21610905230045319, mean p set: 0.4494667053222656
loss_pred:0.01376484613865614, decouple_loss:0.0022831580135971308
The modified gen p mean: 0.44792717695236206, gen p mean: -0.21942438185214996, mean p set: 0.448505699634552
loss_pred:0.014366036280989647, decouple_loss:0.0022522250656038523
The modified gen p mean: 0.4483579397201538, gen p mean: -0.22316963970661163, mean p set: 0.4489334523677826
loss_pred:0.014117822982370853, decouple_loss:0.0021846832241863012
Iteration: 2715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475041925907135, gen p mean: -0.21791063249111176, mean p set: 0.4480842351913452
loss_pred:0.014180933125317097, decouple_loss:0.002208865014836192
The modified gen p mean: 0.4504498541355133, gen p mean: -0.2244541049003601, mean p set: 0.45098060369491577The modified gen p mean: 0.4482320249080658, gen p mean: -0.21602065861225128, mean p set: 0.44880932569503784
loss_pred:0.014291446655988693, decouple_loss:0.002411263296380639
loss_pred:0.014613914303481579, decouple_loss:0.0021042118314653635
Iteration: 2716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874727725982666, gen p mean: -0.22619906067848206, mean p set: 0.44932815432548523
loss_pred:0.014125782996416092, decouple_loss:0.0023760225158184767
The modified gen p mean: 0.4484225809574127, gen p mean: -0.21836718916893005, mean p set: 0.4489465653896332The modified gen p mean: 0.4477740228176117, gen p mean: -0.21902306377887726, mean p set: 0.4483504593372345
loss_pred:0.014118950814008713, decouple_loss:0.002223145915195346
loss_pred:0.014238839037716389, decouple_loss:0.0022707039024680853
Iteration: 2717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481208324432373, gen p mean: -0.22144949436187744, mean p set: 0.4486970603466034
loss_pred:0.014655367471277714, decouple_loss:0.0022387253120541573
The modified gen p mean: 0.44681188464164734, gen p mean: -0.21782398223876953, mean p set: 0.44738414883613586
loss_pred:0.015009015798568726, decouple_loss:0.0023682594764977694
The modified gen p mean: 0.44770175218582153, gen p mean: -0.215292826294899, mean p set: 0.448231041431427
loss_pred:0.014485428109765053, decouple_loss:0.002669605426490307
Iteration: 2718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473395347595215, gen p mean: -0.21525999903678894, mean p set: 0.4479077458381653
loss_pred:0.01400085724890232, decouple_loss:0.0025406014174222946
The modified gen p mean: 0.4473239481449127, gen p mean: -0.22026143968105316, mean p set: 0.4478953182697296
loss_pred:0.014327038079500198, decouple_loss:0.002470744540914893
The modified gen p mean: 0.4487634301185608, gen p mean: -0.22605755925178528, mean p set: 0.4492855668067932
loss_pred:0.013993598520755768, decouple_loss:0.002400950063019991
Iteration: 2719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786709547042847, gen p mean: -0.2193303406238556, mean p set: 0.44843941926956177
loss_pred:0.014172524213790894, decouple_loss:0.0022587236016988754
The modified gen p mean: 0.44892802834510803, gen p mean: -0.21922758221626282, mean p set: 0.4495035707950592
loss_pred:0.013904465362429619, decouple_loss:0.002688927808776498
The modified gen p mean: 0.44911989569664, gen p mean: -0.22147327661514282, mean p set: 0.4496456980705261
loss_pred:0.013774926774203777, decouple_loss:0.0027193657588213682
Iteration: 2720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469330906867981, gen p mean: -0.21987198293209076, mean p set: 0.4475100636482239
loss_pred:0.014151813462376595, decouple_loss:0.002451669191941619
The modified gen p mean: 0.4489990472793579, gen p mean: -0.21887294948101044, mean p set: 0.449531614780426The modified gen p mean: 0.4471500515937805, gen p mean: -0.21736325323581696, mean p set: 0.4477311074733734
loss_pred:0.014560878276824951, decouple_loss:0.002423232886940241
loss_pred:0.014557675458490849, decouple_loss:0.0022756666876375675
2023-04-27 11:40:37 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22204625606536865, mean p set: 0.4499112665653229
loss_pred:0.016658809036016464, decouple_loss:0.002601827261969447
The modified gen p mean: 0.4492986798286438, gen p mean: -0.22250041365623474, mean p set: 0.4498290419578552
loss_pred:0.01622764952480793, decouple_loss:0.0027373800985515118
The modified gen p mean: 0.44822362065315247, gen p mean: -0.21911212801933289, mean p set: 0.44879910349845886
loss_pred:0.01663537696003914, decouple_loss:0.0027773347683250904
WV_1_PC_1_EH_0_PS_30, loss: 0.016642555594444275, avg_mse: 0.02469545789062977
current test mse: 0.024695
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 2721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820448756217957, gen p mean: -0.22323206067085266, mean p set: 0.4487343728542328
loss_pred:0.01510508731007576, decouple_loss:0.0021786545403301716
The modified gen p mean: 0.4478740096092224, gen p mean: -0.22131668031215668, mean p set: 0.44844454526901245
loss_pred:0.013854347169399261, decouple_loss:0.002382588805630803
The modified gen p mean: 0.44606006145477295, gen p mean: -0.22382386028766632, mean p set: 0.44663533568382263
loss_pred:0.014425518922507763, decouple_loss:0.0024724253453314304
Iteration: 2722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45083990693092346, gen p mean: -0.2209486961364746, mean p set: 0.4513660967350006
loss_pred:0.014430560171604156, decouple_loss:0.0024092753883451223
The modified gen p mean: 0.44862794876098633, gen p mean: -0.2141736000776291, mean p set: 0.44920095801353455
The modified gen p mean: 0.4501093626022339, gen p mean: -0.2197827249765396, mean p set: 0.450685054063797
loss_pred:0.014354324899613857, decouple_loss:0.0024257602635771036
loss_pred:0.014573158696293831, decouple_loss:0.0023253958206623793
Iteration: 2723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013004541397095, gen p mean: -0.21999673545360565, mean p set: 0.45066288113594055
loss_pred:0.01411970891058445, decouple_loss:0.002126737730577588
The modified gen p mean: 0.44757533073425293, gen p mean: -0.21501167118549347, mean p set: 0.4481477439403534
The modified gen p mean: 0.44800975918769836, gen p mean: -0.22010642290115356, mean p set: 0.4485855996608734
loss_pred:0.014418549835681915, decouple_loss:0.0023332855198532343
loss_pred:0.0145990289747715, decouple_loss:0.00257340120151639
Iteration: 2724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480535089969635, gen p mean: -0.21494503319263458, mean p set: 0.4485826790332794
loss_pred:0.01425872091203928, decouple_loss:0.002124723279848695
The modified gen p mean: 0.44646579027175903, gen p mean: -0.22021885216236115, mean p set: 0.44704070687294006
The modified gen p mean: 0.4482770264148712, gen p mean: -0.21302324533462524, mean p set: 0.44885557889938354
loss_pred:0.013967864215373993, decouple_loss:0.0020236498676240444
loss_pred:0.014189581386744976, decouple_loss:0.0020945488940924406
Iteration: 2725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773462414741516, gen p mean: -0.21798942983150482, mean p set: 0.44830387830734253
loss_pred:0.015254179947078228, decouple_loss:0.0021069860085844994
The modified gen p mean: 0.44821736216545105, gen p mean: -0.2232314944267273, mean p set: 0.4487411379814148The modified gen p mean: 0.44807887077331543, gen p mean: -0.22321850061416626, mean p set: 0.4486563205718994
loss_pred:0.01396738737821579, decouple_loss:0.002258824883028865
loss_pred:0.013873279094696045, decouple_loss:0.0020945421420037746
Iteration: 2726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925495982170105, gen p mean: -0.21299231052398682, mean p set: 0.44983553886413574
loss_pred:0.014192074537277222, decouple_loss:0.002343874191865325
The modified gen p mean: 0.4480160176753998, gen p mean: -0.21463343501091003, mean p set: 0.44854292273521423The modified gen p mean: 0.44697681069374084, gen p mean: -0.2273826152086258, mean p set: 0.44755133986473083
loss_pred:0.013773181475698948, decouple_loss:0.0020453492179512978
loss_pred:0.014178087003529072, decouple_loss:0.0020045549608767033
Iteration: 2727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864827394485474, gen p mean: -0.21659156680107117, mean p set: 0.4492274820804596
loss_pred:0.013959038071334362, decouple_loss:0.0021750316955149174
The modified gen p mean: 0.4482915997505188, gen p mean: -0.22832532227039337, mean p set: 0.4488264322280884The modified gen p mean: 0.44778886437416077, gen p mean: -0.22606055438518524, mean p set: 0.44836726784706116
loss_pred:0.013709061779081821, decouple_loss:0.0021099618170410395
loss_pred:0.01416893769055605, decouple_loss:0.0020705780480057
Iteration: 2728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486602246761322, gen p mean: -0.22031627595424652, mean p set: 0.4492388665676117
loss_pred:0.01386580616235733, decouple_loss:0.00218320288695395
The modified gen p mean: 0.4484131336212158, gen p mean: -0.21730297803878784, mean p set: 0.44898515939712524
loss_pred:0.014236606657505035, decouple_loss:0.002312208293005824
The modified gen p mean: 0.44824039936065674, gen p mean: -0.22723554074764252, mean p set: 0.4487667679786682
loss_pred:0.014506950974464417, decouple_loss:0.0021118687000125647
Iteration: 2729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808700680732727, gen p mean: -0.2204963117837906, mean p set: 0.44866693019866943
loss_pred:0.014381100423634052, decouple_loss:0.002096072304993868
The modified gen p mean: 0.4482153356075287, gen p mean: -0.22092203795909882, mean p set: 0.44879457354545593
loss_pred:0.014444069936871529, decouple_loss:0.002230987185612321
The modified gen p mean: 0.44878706336021423, gen p mean: -0.21680860221385956, mean p set: 0.449319064617157
loss_pred:0.014454104006290436, decouple_loss:0.0022693194914609194
Iteration: 2730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479474723339081, gen p mean: -0.22058714926242828, mean p set: 0.4485265016555786
loss_pred:0.01359657384455204, decouple_loss:0.0021010732743889093
The modified gen p mean: 0.4485737383365631, gen p mean: -0.22304990887641907, mean p set: 0.4490965008735657The modified gen p mean: 0.44751861691474915, gen p mean: -0.21821893751621246, mean p set: 0.44809263944625854
loss_pred:0.013932793401181698, decouple_loss:0.002087940461933613
loss_pred:0.014502455480396748, decouple_loss:0.002130372915416956
2023-04-27 11:44:43 testing...
The modified gen p mean: 0.4482261538505554, gen p mean: -0.22031302750110626, mean p set: 0.44879910349845886
loss_pred:0.016596559435129166, decouple_loss:0.002259248634800315
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22348003089427948, mean p set: 0.4499112665653229
loss_pred:0.016598409041762352, decouple_loss:0.0022832395043224096
The modified gen p mean: 0.44930386543273926, gen p mean: -0.22367705404758453, mean p set: 0.4498290419578552
loss_pred:0.01621118374168873, decouple_loss:0.002281090710312128
WV_1_PC_1_EH_0_PS_30, loss: 0.016582444310188293, avg_mse: 0.024634893983602524
current test mse: 0.024635
Iteration: 2731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767969846725464, gen p mean: -0.21695397794246674, mean p set: 0.4482579529285431
loss_pred:0.01423188578337431, decouple_loss:0.0022166490089148283
The modified gen p mean: 0.44874444603919983, gen p mean: -0.22594410181045532, mean p set: 0.4492718279361725
loss_pred:0.014699029736220837, decouple_loss:0.002235888969153166
The modified gen p mean: 0.4495316445827484, gen p mean: -0.2272244244813919, mean p set: 0.4501021206378937
loss_pred:0.014258245006203651, decouple_loss:0.002467955695465207
Iteration: 2732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770219922065735, gen p mean: -0.22533154487609863, mean p set: 0.4482307732105255
loss_pred:0.013981577008962631, decouple_loss:0.00212891330011189
The modified gen p mean: 0.44830527901649475, gen p mean: -0.2187119424343109, mean p set: 0.4488862454891205
loss_pred:0.014439143240451813, decouple_loss:0.002051552524790168
The modified gen p mean: 0.4491318464279175, gen p mean: -0.22664040327072144, mean p set: 0.44971415400505066
loss_pred:0.014628755860030651, decouple_loss:0.0022610723972320557
Iteration: 2733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475409686565399, gen p mean: -0.22281625866889954, mean p set: 0.4480714499950409
loss_pred:0.01388827059417963, decouple_loss:0.0019794271793216467
The modified gen p mean: 0.44629648327827454, gen p mean: -0.2282651662826538, mean p set: 0.4468747675418854
loss_pred:0.01460753008723259, decouple_loss:0.0024289677385240793
The modified gen p mean: 0.44856277108192444, gen p mean: -0.2136266529560089, mean p set: 0.44913890957832336
loss_pred:0.014202483929693699, decouple_loss:0.0021644579246640205
Iteration: 2734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744378328323364, gen p mean: -0.21876370906829834, mean p set: 0.44796544313430786
loss_pred:0.01432764157652855, decouple_loss:0.0028302327264100313
The modified gen p mean: 0.44669631123542786, gen p mean: -0.22005458176136017, mean p set: 0.4472724497318268
loss_pred:0.014405608177185059, decouple_loss:0.0027432048227638006
The modified gen p mean: 0.44862550497055054, gen p mean: -0.21297994256019592, mean p set: 0.44919851422309875
loss_pred:0.01442504208534956, decouple_loss:0.0027292370796203613
Iteration: 2735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854435324668884, gen p mean: -0.21434913575649261, mean p set: 0.4491168260574341
loss_pred:0.014968850649893284, decouple_loss:0.002214043168351054
The modified gen p mean: 0.4490363597869873, gen p mean: -0.21876780688762665, mean p set: 0.4495646357536316The modified gen p mean: 0.4483862519264221, gen p mean: -0.21591591835021973, mean p set: 0.44895556569099426
loss_pred:0.014369796961545944, decouple_loss:0.00236219959333539
loss_pred:0.014793473295867443, decouple_loss:0.0023377740290015936
Iteration: 2736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447695791721344, gen p mean: -0.21522630751132965, mean p set: 0.4482734203338623
loss_pred:0.014119083061814308, decouple_loss:0.0023161715362221003
The modified gen p mean: 0.4473336637020111, gen p mean: -0.21737909317016602, mean p set: 0.4478631317615509The modified gen p mean: 0.4493166506290436, gen p mean: -0.21042421460151672, mean p set: 0.44988885521888733
loss_pred:0.01445017009973526, decouple_loss:0.002142335055395961
loss_pred:0.014435891062021255, decouple_loss:0.002296329475939274
Iteration: 2737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477671682834625, gen p mean: -0.21991609036922455, mean p set: 0.4483499228954315
loss_pred:0.014173723757266998, decouple_loss:0.0027177948504686356
The modified gen p mean: 0.44646331667900085, gen p mean: -0.22541996836662292, mean p set: 0.446990966796875The modified gen p mean: 0.44819775223731995, gen p mean: -0.21668115258216858, mean p set: 0.44876742362976074
loss_pred:0.014484113082289696, decouple_loss:0.0026318130549043417
loss_pred:0.01441364549100399, decouple_loss:0.002849797485396266
Iteration: 2738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478317201137543, gen p mean: -0.22071553766727448, mean p set: 0.448408842086792
loss_pred:0.015032123774290085, decouple_loss:0.002241115551441908
The modified gen p mean: 0.4472300410270691, gen p mean: -0.2193007916212082, mean p set: 0.44780102372169495
loss_pred:0.015225200913846493, decouple_loss:0.0020011698361486197
The modified gen p mean: 0.4482894837856293, gen p mean: -0.21725375950336456, mean p set: 0.4488143026828766
loss_pred:0.014718684367835522, decouple_loss:0.002246761927381158
Iteration: 2739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718149304389954, gen p mean: -0.2311086356639862, mean p set: 0.44775673747062683
loss_pred:0.01401498168706894, decouple_loss:0.0024141063913702965
The modified gen p mean: 0.4486686587333679, gen p mean: -0.21889227628707886, mean p set: 0.4492424428462982
loss_pred:0.014067086391150951, decouple_loss:0.0024377459194511175
The modified gen p mean: 0.4474886357784271, gen p mean: -0.22622761130332947, mean p set: 0.4480225145816803
loss_pred:0.014892004430294037, decouple_loss:0.002203522017225623
Iteration: 2740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747018814086914, gen p mean: -0.22912949323654175, mean p set: 0.44804564118385315
loss_pred:0.01448751613497734, decouple_loss:0.0025480836629867554
The modified gen p mean: 0.44825777411460876, gen p mean: -0.22050519287586212, mean p set: 0.44883567094802856
loss_pred:0.014704074710607529, decouple_loss:0.0022861440666019917
The modified gen p mean: 0.44644251465797424, gen p mean: -0.2290954291820526, mean p set: 0.44696733355522156
loss_pred:0.014404757879674435, decouple_loss:0.002368910936638713
2023-04-27 11:48:08 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2178085893392563, mean p set: 0.4499112665653229
loss_pred:0.016883188858628273, decouple_loss:0.0023856605403125286
The modified gen p mean: 0.4492975175380707, gen p mean: -0.21780003607273102, mean p set: 0.4498290419578552
loss_pred:0.016453728079795837, decouple_loss:0.0023350713308900595
The modified gen p mean: 0.4482220411300659, gen p mean: -0.21508336067199707, mean p set: 0.44879910349845886
loss_pred:0.01687059924006462, decouple_loss:0.0023310696706175804
WV_1_PC_1_EH_0_PS_30, loss: 0.016853369772434235, avg_mse: 0.025078849866986275
current test mse: 0.025079
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 2741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729456305503845, gen p mean: -0.21565192937850952, mean p set: 0.4478200376033783
loss_pred:0.015853649005293846, decouple_loss:0.0021547016222029924
The modified gen p mean: 0.4467065632343292, gen p mean: -0.22126410901546478, mean p set: 0.44728556275367737
loss_pred:0.016155598685145378, decouple_loss:0.00243227556347847
The modified gen p mean: 0.44654691219329834, gen p mean: -0.2226346880197525, mean p set: 0.4471310079097748
loss_pred:0.014897222630679607, decouple_loss:0.0023905234411358833
Iteration: 2742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479587972164154, gen p mean: -0.22620797157287598, mean p set: 0.4484843611717224
loss_pred:0.015384242869913578, decouple_loss:0.0026029753498733044
The modified gen p mean: 0.44671231508255005, gen p mean: -0.23068782687187195, mean p set: 0.4472888708114624
The modified gen p mean: 0.44737446308135986, gen p mean: -0.22245222330093384, mean p set: 0.4479510188102722
loss_pred:0.015481439419090748, decouple_loss:0.002334331162273884
loss_pred:0.015751343220472336, decouple_loss:0.002318914979696274
Iteration: 2743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485853612422943, gen p mean: -0.2332986742258072, mean p set: 0.44910916686058044
loss_pred:0.01552059967070818, decouple_loss:0.00230255164206028
The modified gen p mean: 0.4471847116947174, gen p mean: -0.23278315365314484, mean p set: 0.4477572739124298
The modified gen p mean: 0.44727519154548645, gen p mean: -0.2356875091791153, mean p set: 0.4478473961353302
loss_pred:0.01605818420648575, decouple_loss:0.0023951868060976267
loss_pred:0.015971602872014046, decouple_loss:0.0022505088709294796
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717511534690857, gen p mean: -0.2332402467727661, mean p set: 0.4476999342441559
loss_pred:0.015282665379345417, decouple_loss:0.0022109344135969877
The modified gen p mean: 0.446719229221344, gen p mean: -0.23537273705005646, mean p set: 0.4472969174385071
The modified gen p mean: 0.4480500817298889, gen p mean: -0.23330512642860413, mean p set: 0.44862401485443115
loss_pred:0.01501673087477684, decouple_loss:0.0023564936127513647
loss_pred:0.015681659802794456, decouple_loss:0.002238469896838069
Iteration: 2745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471599757671356, gen p mean: -0.22825311124324799, mean p set: 0.4477294087409973
loss_pred:0.015875592827796936, decouple_loss:0.002342711668461561
The modified gen p mean: 0.4468933045864105, gen p mean: -0.2274254709482193, mean p set: 0.44742023944854736The modified gen p mean: 0.4478449523448944, gen p mean: -0.2253708839416504, mean p set: 0.44842514395713806
loss_pred:0.015039934776723385, decouple_loss:0.0021882872097194195
loss_pred:0.015324259176850319, decouple_loss:0.002091278089210391
Iteration: 2746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466736912727356, gen p mean: -0.2229163944721222, mean p set: 0.4472491443157196
loss_pred:0.015071728266775608, decouple_loss:0.002104670275002718
The modified gen p mean: 0.4477533996105194, gen p mean: -0.22191323339939117, mean p set: 0.4482831358909607
The modified gen p mean: 0.4469919800758362, gen p mean: -0.21971800923347473, mean p set: 0.4475705623626709
loss_pred:0.014807752333581448, decouple_loss:0.002290536416694522
loss_pred:0.015254710800945759, decouple_loss:0.0021720118820667267
Iteration: 2747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481433928012848, gen p mean: -0.21364526450634003, mean p set: 0.44871804118156433
loss_pred:0.015204192139208317, decouple_loss:0.0024391834158450365
The modified gen p mean: 0.4465571343898773, gen p mean: -0.21329087018966675, mean p set: 0.4470870792865753The modified gen p mean: 0.4492138922214508, gen p mean: -0.21972398459911346, mean p set: 0.4497888684272766
loss_pred:0.014980323612689972, decouple_loss:0.0023576433304697275
loss_pred:0.015743976458907127, decouple_loss:0.002478121779859066
Iteration: 2748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817474484443665, gen p mean: -0.21961700916290283, mean p set: 0.4487501382827759
loss_pred:0.014964652247726917, decouple_loss:0.002190272556617856
The modified gen p mean: 0.44651639461517334, gen p mean: -0.21829938888549805, mean p set: 0.44708749651908875
loss_pred:0.015717580914497375, decouple_loss:0.0022823899053037167
The modified gen p mean: 0.44618016481399536, gen p mean: -0.212162047624588, mean p set: 0.44670602679252625
loss_pred:0.015726089477539062, decouple_loss:0.002219610847532749
Iteration: 2749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785523414611816, gen p mean: -0.2157832533121109, mean p set: 0.4484269320964813
loss_pred:0.014882261864840984, decouple_loss:0.0025012725964188576
The modified gen p mean: 0.44689175486564636, gen p mean: -0.21364422142505646, mean p set: 0.44747352600097656
loss_pred:0.015155375003814697, decouple_loss:0.002348161768168211
The modified gen p mean: 0.4474083185195923, gen p mean: -0.21330875158309937, mean p set: 0.44793686270713806
loss_pred:0.015252101235091686, decouple_loss:0.0022473400458693504
Iteration: 2750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484536945819855, gen p mean: -0.22135086357593536, mean p set: 0.4490325152873993
loss_pred:0.014587610960006714, decouple_loss:0.002236581640318036
The modified gen p mean: 0.4473053812980652, gen p mean: -0.21821630001068115, mean p set: 0.4478357136249542The modified gen p mean: 0.4480173587799072, gen p mean: -0.21522881090641022, mean p set: 0.4485948383808136
loss_pred:0.015087483450770378, decouple_loss:0.002260897308588028
loss_pred:0.015140781179070473, decouple_loss:0.0022517452016472816
2023-04-27 11:52:16 testing...
The modified gen p mean: 0.4482194781303406, gen p mean: -0.21466687321662903, mean p set: 0.44879910349845886
loss_pred:0.016592560335993767, decouple_loss:0.002239193534478545
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21788863837718964, mean p set: 0.4499112665653229
loss_pred:0.01664615608751774, decouple_loss:0.002167724771425128
The modified gen p mean: 0.4493005871772766, gen p mean: -0.2179260551929474, mean p set: 0.4498290419578552
loss_pred:0.01617255061864853, decouple_loss:0.00220485613681376
WV_1_PC_1_EH_0_PS_30, loss: 0.016580618917942047, avg_mse: 0.024576393887400627
current test mse: 0.024576
Iteration: 2751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471328854560852, gen p mean: -0.21597985923290253, mean p set: 0.44771599769592285
loss_pred:0.01496997382491827, decouple_loss:0.002247605938464403
The modified gen p mean: 0.4482251703739166, gen p mean: -0.21906304359436035, mean p set: 0.44880321621894836
loss_pred:0.015148281119763851, decouple_loss:0.002262804424390197
The modified gen p mean: 0.44683516025543213, gen p mean: -0.22075995802879333, mean p set: 0.44736161828041077
loss_pred:0.014732950367033482, decouple_loss:0.002197808586061001
Iteration: 2752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815194606781006, gen p mean: -0.21944822371006012, mean p set: 0.44868743419647217
loss_pred:0.014890002086758614, decouple_loss:0.002137403702363372
The modified gen p mean: 0.44702601432800293, gen p mean: -0.219389870762825, mean p set: 0.4476010799407959
loss_pred:0.015345423482358456, decouple_loss:0.0022270511835813522
The modified gen p mean: 0.4472160041332245, gen p mean: -0.22071482241153717, mean p set: 0.4477914571762085
loss_pred:0.014820937067270279, decouple_loss:0.0021637319587171078
Iteration: 2753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764336943626404, gen p mean: -0.22204433381557465, mean p set: 0.44817429780960083
loss_pred:0.01515297032892704, decouple_loss:0.0019620582461357117
The modified gen p mean: 0.44830650091171265, gen p mean: -0.2214936465024948, mean p set: 0.4488847255706787
loss_pred:0.014928712509572506, decouple_loss:0.002186424098908901
The modified gen p mean: 0.44774001836776733, gen p mean: -0.22065237164497375, mean p set: 0.4483122229576111
loss_pred:0.014827175997197628, decouple_loss:0.0019401060417294502
Iteration: 2754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467792212963104, gen p mean: -0.21627098321914673, mean p set: 0.4473079442977905
loss_pred:0.015142805874347687, decouple_loss:0.0022549396380782127
The modified gen p mean: 0.4471939504146576, gen p mean: -0.22287584841251373, mean p set: 0.4477703869342804
loss_pred:0.015361160039901733, decouple_loss:0.002116668038070202
The modified gen p mean: 0.4468044936656952, gen p mean: -0.2185792177915573, mean p set: 0.44737330079078674
loss_pred:0.014975992031395435, decouple_loss:0.0021994959097355604
Iteration: 2755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472259283065796, gen p mean: -0.21954694390296936, mean p set: 0.44780635833740234
loss_pred:0.01554821990430355, decouple_loss:0.0022499500773847103
The modified gen p mean: 0.44764962792396545, gen p mean: -0.21776285767555237, mean p set: 0.44822028279304504The modified gen p mean: 0.4468284845352173, gen p mean: -0.21600006520748138, mean p set: 0.44736430048942566
loss_pred:0.014973370358347893, decouple_loss:0.0022130021825432777
loss_pred:0.015025481581687927, decouple_loss:0.0021434256341308355
Iteration: 2756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475150406360626, gen p mean: -0.21422336995601654, mean p set: 0.4480918347835541
loss_pred:0.01574699394404888, decouple_loss:0.002158053917810321
The modified gen p mean: 0.4477136433124542, gen p mean: -0.21841201186180115, mean p set: 0.4482421875The modified gen p mean: 0.4475751221179962, gen p mean: -0.21540066599845886, mean p set: 0.4481441080570221
loss_pred:0.014899746514856815, decouple_loss:0.002190240425989032
loss_pred:0.014823827892541885, decouple_loss:0.002239047084003687
Iteration: 2757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708481431007385, gen p mean: -0.21747617423534393, mean p set: 0.4476657211780548
loss_pred:0.01472217682749033, decouple_loss:0.002142438432201743
The modified gen p mean: 0.44877615571022034, gen p mean: -0.21944792568683624, mean p set: 0.44930416345596313The modified gen p mean: 0.4473314583301544, gen p mean: -0.21985746920108795, mean p set: 0.4479072690010071
loss_pred:0.014599462039768696, decouple_loss:0.0021646006498485804
loss_pred:0.015042683109641075, decouple_loss:0.0020091161131858826
Iteration: 2758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480679929256439, gen p mean: -0.21769732236862183, mean p set: 0.44864028692245483
loss_pred:0.015339063480496407, decouple_loss:0.0021404833532869816
The modified gen p mean: 0.4478552043437958, gen p mean: -0.22090718150138855, mean p set: 0.44843074679374695
loss_pred:0.01497605536133051, decouple_loss:0.0020296224392950535
The modified gen p mean: 0.4473845958709717, gen p mean: -0.21535885334014893, mean p set: 0.4479181170463562
loss_pred:0.015033802948892117, decouple_loss:0.00204713037237525
Iteration: 2759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757118821144104, gen p mean: -0.2124462127685547, mean p set: 0.4481446444988251
loss_pred:0.01580960303544998, decouple_loss:0.0021234811283648014
The modified gen p mean: 0.447447806596756, gen p mean: -0.21857336163520813, mean p set: 0.44802361726760864
loss_pred:0.014799954369664192, decouple_loss:0.002237611450254917
The modified gen p mean: 0.44648435711860657, gen p mean: -0.22054004669189453, mean p set: 0.44701075553894043
loss_pred:0.015095459297299385, decouple_loss:0.002180993091315031
Iteration: 2760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480744004249573, gen p mean: -0.21745963394641876, mean p set: 0.4486437737941742
loss_pred:0.01480933092534542, decouple_loss:0.001993269193917513
The modified gen p mean: 0.4466545581817627, gen p mean: -0.2213689684867859, mean p set: 0.44723477959632874
loss_pred:0.01596532203257084, decouple_loss:0.0021927282214164734
The modified gen p mean: 0.4472943842411041, gen p mean: -0.21631459891796112, mean p set: 0.44782111048698425
loss_pred:0.015321050770580769, decouple_loss:0.0020032688044011593
2023-04-27 11:55:41 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21935923397541046, mean p set: 0.4499112665653229
loss_pred:0.016561871394515038, decouple_loss:0.0020784868393093348
The modified gen p mean: 0.4493081867694855, gen p mean: -0.21977798640727997, mean p set: 0.4498290419578552
loss_pred:0.016117775812745094, decouple_loss:0.0019766977056860924
The modified gen p mean: 0.4482240676879883, gen p mean: -0.21653912961483002, mean p set: 0.44879910349845886
loss_pred:0.01642877608537674, decouple_loss:0.001979515189304948
WV_1_PC_1_EH_0_PS_30, loss: 0.016470052301883698, avg_mse: 0.024431295692920685
current test mse: 0.024431
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 2761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714993238449097, gen p mean: -0.22253814339637756, mean p set: 0.44767507910728455
loss_pred:0.014607558026909828, decouple_loss:0.0021292553283274174
The modified gen p mean: 0.44608092308044434, gen p mean: -0.21593795716762543, mean p set: 0.4466512203216553
loss_pred:0.015654483810067177, decouple_loss:0.0020579062402248383
The modified gen p mean: 0.44644197821617126, gen p mean: -0.21965433657169342, mean p set: 0.44701918959617615
loss_pred:0.01566382311284542, decouple_loss:0.0021171157713979483
Iteration: 2762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467141330242157, gen p mean: -0.2192312777042389, mean p set: 0.44724223017692566
loss_pred:0.015594271011650562, decouple_loss:0.002219626447185874
The modified gen p mean: 0.44698819518089294, gen p mean: -0.21993207931518555, mean p set: 0.4475627839565277
The modified gen p mean: 0.4466701149940491, gen p mean: -0.21673379838466644, mean p set: 0.44724246859550476
loss_pred:0.014009591192007065, decouple_loss:0.0021270241122692823
loss_pred:0.014854907058179379, decouple_loss:0.0022974302992224693
Iteration: 2763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471839368343353, gen p mean: -0.21409225463867188, mean p set: 0.4477064609527588
loss_pred:0.014715882018208504, decouple_loss:0.001957897562533617
The modified gen p mean: 0.44726186990737915, gen p mean: -0.21355855464935303, mean p set: 0.44783177971839905
The modified gen p mean: 0.446425199508667, gen p mean: -0.21912166476249695, mean p set: 0.44700121879577637
loss_pred:0.015403492376208305, decouple_loss:0.002162792719900608
loss_pred:0.01521251816302538, decouple_loss:0.002175417495891452
Iteration: 2764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479371905326843, gen p mean: -0.2152026891708374, mean p set: 0.44846251606941223
loss_pred:0.014520849101245403, decouple_loss:0.0020344906952232122
The modified gen p mean: 0.446816623210907, gen p mean: -0.21685071289539337, mean p set: 0.44738972187042236
The modified gen p mean: 0.44677114486694336, gen p mean: -0.21623505651950836, mean p set: 0.4473433792591095
loss_pred:0.01518331840634346, decouple_loss:0.0020165969617664814
loss_pred:0.015192114748060703, decouple_loss:0.0019446692895144224
Iteration: 2765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681668281555176, gen p mean: -0.2178022861480713, mean p set: 0.447394996881485
loss_pred:0.01521464716643095, decouple_loss:0.001935088774189353
The modified gen p mean: 0.4473106563091278, gen p mean: -0.22118759155273438, mean p set: 0.4478381872177124The modified gen p mean: 0.44645071029663086, gen p mean: -0.21753452718257904, mean p set: 0.44702303409576416
loss_pred:0.014910963363945484, decouple_loss:0.002116685500368476
loss_pred:0.015329991467297077, decouple_loss:0.0020879507064819336
Iteration: 2766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466116726398468, gen p mean: -0.2182653248310089, mean p set: 0.4471836984157562
loss_pred:0.015375806018710136, decouple_loss:0.0020192142110317945
The modified gen p mean: 0.445891797542572, gen p mean: -0.2189813256263733, mean p set: 0.4464643895626068The modified gen p mean: 0.44712159037590027, gen p mean: -0.2221752107143402, mean p set: 0.4476585388183594
loss_pred:0.014965447597205639, decouple_loss:0.002102799713611603
loss_pred:0.015295728109776974, decouple_loss:0.0019636733923107386
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447099506855011, gen p mean: -0.22588390111923218, mean p set: 0.4476762115955353
loss_pred:0.01457542646676302, decouple_loss:0.0020251290407031775
The modified gen p mean: 0.4459245800971985, gen p mean: -0.22516147792339325, mean p set: 0.446504145860672
The modified gen p mean: 0.446397602558136, gen p mean: -0.22206252813339233, mean p set: 0.44692397117614746
loss_pred:0.015256870537996292, decouple_loss:0.0020499653182923794
loss_pred:0.015299192629754543, decouple_loss:0.0020620222203433514
Iteration: 2768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479924738407135, gen p mean: -0.22176414728164673, mean p set: 0.44856566190719604
loss_pred:0.014667562209069729, decouple_loss:0.0019473101710900664
The modified gen p mean: 0.4467703402042389, gen p mean: -0.22394341230392456, mean p set: 0.44735097885131836
loss_pred:0.014761346392333508, decouple_loss:0.0018323451513424516
The modified gen p mean: 0.44705766439437866, gen p mean: -0.22414810955524445, mean p set: 0.447585791349411
loss_pred:0.014934735372662544, decouple_loss:0.0018342427210882306
Iteration: 2769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477587342262268, gen p mean: -0.22225548326969147, mean p set: 0.44833290576934814
loss_pred:0.015041439794003963, decouple_loss:0.001769295777194202
The modified gen p mean: 0.4467051029205322, gen p mean: -0.22107873857021332, mean p set: 0.4472809433937073
loss_pred:0.015086187049746513, decouple_loss:0.0019401127938181162
The modified gen p mean: 0.44620245695114136, gen p mean: -0.2189061939716339, mean p set: 0.44673141837120056
loss_pred:0.015450520440936089, decouple_loss:0.0020028462167829275
Iteration: 2770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447492778301239, gen p mean: -0.21794511377811432, mean p set: 0.44806966185569763
loss_pred:0.014717072248458862, decouple_loss:0.001730486168526113
The modified gen p mean: 0.44837480783462524, gen p mean: -0.2242988497018814, mean p set: 0.4489026963710785The modified gen p mean: 0.44702014327049255, gen p mean: -0.21876195073127747, mean p set: 0.447593629360199
loss_pred:0.014839692041277885, decouple_loss:0.00185946945566684
loss_pred:0.014646950177848339, decouple_loss:0.0020705657079815865
2023-04-27 11:59:54 testing...
The modified gen p mean: 0.4482226073741913, gen p mean: -0.21208961308002472, mean p set: 0.44879910349845886
loss_pred:0.016550369560718536, decouple_loss:0.0020713740959763527
The modified gen p mean: 0.4494309425354004, gen p mean: -0.214610293507576, mean p set: 0.4499112665653229
loss_pred:0.016636639833450317, decouple_loss:0.0021644998341798782
The modified gen p mean: 0.4492964744567871, gen p mean: -0.215102881193161, mean p set: 0.4498290419578552
loss_pred:0.01620725728571415, decouple_loss:0.0021121432073414326
WV_1_PC_1_EH_0_PS_30, loss: 0.0165705569088459, avg_mse: 0.024629566818475723
current test mse: 0.02463
Iteration: 2771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464873969554901, gen p mean: -0.21371278166770935, mean p set: 0.4470658302307129
loss_pred:0.01528423186391592, decouple_loss:0.0019708762411028147
The modified gen p mean: 0.44771525263786316, gen p mean: -0.2155434936285019, mean p set: 0.44829118251800537
loss_pred:0.01455056294798851, decouple_loss:0.0020970499608665705
The modified gen p mean: 0.4476728141307831, gen p mean: -0.21550551056861877, mean p set: 0.44819772243499756
loss_pred:0.015365781262516975, decouple_loss:0.0019150725565850735
Iteration: 2772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684284925460815, gen p mean: -0.20905444025993347, mean p set: 0.447368860244751
loss_pred:0.015203705988824368, decouple_loss:0.0018526673084124923
The modified gen p mean: 0.4459454417228699, gen p mean: -0.2113548219203949, mean p set: 0.44651639461517334
loss_pred:0.015225696377456188, decouple_loss:0.0020195096731185913
The modified gen p mean: 0.44620832800865173, gen p mean: -0.21523073315620422, mean p set: 0.4467797577381134
loss_pred:0.01506810449063778, decouple_loss:0.0019594242330640554
Iteration: 2773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469090700149536, gen p mean: -0.21328400075435638, mean p set: 0.4474363923072815
loss_pred:0.014982456341385841, decouple_loss:0.002451427048072219
The modified gen p mean: 0.44660961627960205, gen p mean: -0.21217219531536102, mean p set: 0.44718724489212036
loss_pred:0.015155953355133533, decouple_loss:0.0020124136935919523
The modified gen p mean: 0.4479939937591553, gen p mean: -0.2149636596441269, mean p set: 0.448570191860199
loss_pred:0.01473772618919611, decouple_loss:0.002054014941677451
Iteration: 2774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777750968933105, gen p mean: -0.2150624394416809, mean p set: 0.4483036994934082
loss_pred:0.01450714934617281, decouple_loss:0.0019088228000327945
The modified gen p mean: 0.4479216933250427, gen p mean: -0.22051693499088287, mean p set: 0.44850221276283264
loss_pred:0.014540135860443115, decouple_loss:0.0019344001775607467
The modified gen p mean: 0.4460448920726776, gen p mean: -0.21114413440227509, mean p set: 0.4466211497783661
loss_pred:0.014755968004465103, decouple_loss:0.0020310247782617807
Iteration: 2775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715073704719543, gen p mean: -0.21941466629505157, mean p set: 0.44772762060165405
loss_pred:0.014148686081171036, decouple_loss:0.0021142899058759212
The modified gen p mean: 0.4472944736480713, gen p mean: -0.21794740855693817, mean p set: 0.44781920313835144The modified gen p mean: 0.44873085618019104, gen p mean: -0.22492264211177826, mean p set: 0.44930580258369446
loss_pred:0.015177866443991661, decouple_loss:0.002003060420975089
loss_pred:0.01465229969471693, decouple_loss:0.0020157538820058107
Iteration: 2776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457556903362274, gen p mean: -0.2166074514389038, mean p set: 0.4463328719139099
loss_pred:0.01466695312410593, decouple_loss:0.0018299194052815437
The modified gen p mean: 0.44755256175994873, gen p mean: -0.21477533876895905, mean p set: 0.4481275677680969The modified gen p mean: 0.4470413327217102, gen p mean: -0.21527747809886932, mean p set: 0.4475724399089813
loss_pred:0.01469897199422121, decouple_loss:0.001886771759018302
loss_pred:0.01460797805339098, decouple_loss:0.0018516485579311848
Iteration: 2777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687214493751526, gen p mean: -0.21336500346660614, mean p set: 0.4474518895149231
loss_pred:0.014950171113014221, decouple_loss:0.002084559528157115
The modified gen p mean: 0.44597265124320984, gen p mean: -0.21122843027114868, mean p set: 0.4465442895889282
loss_pred:0.015060244128108025, decouple_loss:0.002296806313097477
The modified gen p mean: 0.4468141794204712, gen p mean: -0.21481545269489288, mean p set: 0.4473459720611572
loss_pred:0.015297998674213886, decouple_loss:0.002394357929006219
Iteration: 2778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44594651460647583, gen p mean: -0.21272605657577515, mean p set: 0.4465225338935852
loss_pred:0.014912878163158894, decouple_loss:0.0018835723167285323
The modified gen p mean: 0.4472304582595825, gen p mean: -0.21891294419765472, mean p set: 0.4478035867214203
loss_pred:0.01502138376235962, decouple_loss:0.002105466555804014
The modified gen p mean: 0.4469722807407379, gen p mean: -0.21610665321350098, mean p set: 0.4474965035915375
loss_pred:0.014528065919876099, decouple_loss:0.0018305906560271978
Iteration: 2779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686853885650635, gen p mean: -0.21648761630058289, mean p set: 0.4474417567253113
loss_pred:0.015064403414726257, decouple_loss:0.0018944828771054745
The modified gen p mean: 0.4468916058540344, gen p mean: -0.21900135278701782, mean p set: 0.4474670886993408
loss_pred:0.014613998122513294, decouple_loss:0.0020190374925732613
The modified gen p mean: 0.4474674165248871, gen p mean: -0.21514277160167694, mean p set: 0.4479915201663971
loss_pred:0.014529338106513023, decouple_loss:0.0019521855283528566
Iteration: 2780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674474000930786, gen p mean: -0.21755236387252808, mean p set: 0.44731974601745605
loss_pred:0.01459541916847229, decouple_loss:0.0020668033976107836
The modified gen p mean: 0.4460514485836029, gen p mean: -0.2109333872795105, mean p set: 0.44658011198043823The modified gen p mean: 0.4469785988330841, gen p mean: -0.22030803561210632, mean p set: 0.4475582242012024
loss_pred:0.01439185906201601, decouple_loss:0.0022129924036562443
loss_pred:0.015319657512009144, decouple_loss:0.0021911337971687317
2023-04-27 12:03:20 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21596017479896545, mean p set: 0.4499112665653229
loss_pred:0.016582874581217766, decouple_loss:0.002125651342794299
The modified gen p mean: 0.44929948449134827, gen p mean: -0.21622520685195923, mean p set: 0.4498290419578552
loss_pred:0.016102444380521774, decouple_loss:0.002102052792906761
The modified gen p mean: 0.4482225775718689, gen p mean: -0.21316932141780853, mean p set: 0.44879910349845886
loss_pred:0.0164567232131958, decouple_loss:0.002098297933116555
WV_1_PC_1_EH_0_PS_30, loss: 0.016486115753650665, avg_mse: 0.024463262408971786
current test mse: 0.024463
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 2781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780635833740234, gen p mean: -0.21212293207645416, mean p set: 0.44832685589790344
loss_pred:0.014454859308898449, decouple_loss:0.0020653605461120605
The modified gen p mean: 0.44672614336013794, gen p mean: -0.21799343824386597, mean p set: 0.44729676842689514
loss_pred:0.014831405133008957, decouple_loss:0.0021215619053691626
The modified gen p mean: 0.4461870491504669, gen p mean: -0.2115941345691681, mean p set: 0.44676467776298523
loss_pred:0.014428465627133846, decouple_loss:0.002529409248381853
Iteration: 2782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871652126312256, gen p mean: -0.20619229972362518, mean p set: 0.44924309849739075
loss_pred:0.014966513030230999, decouple_loss:0.0024648362305015326
The modified gen p mean: 0.4473188519477844, gen p mean: -0.21320518851280212, mean p set: 0.4478895962238312
The modified gen p mean: 0.4471150040626526, gen p mean: -0.21632736921310425, mean p set: 0.4476914703845978
loss_pred:0.014152591116726398, decouple_loss:0.002349026035517454
loss_pred:0.014813519082963467, decouple_loss:0.002282186411321163
Iteration: 2783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470634460449219, gen p mean: -0.22178910672664642, mean p set: 0.44759422540664673
loss_pred:0.01458238810300827, decouple_loss:0.0024941617157310247
The modified gen p mean: 0.44641968607902527, gen p mean: -0.214797243475914, mean p set: 0.4469953179359436
The modified gen p mean: 0.44741111993789673, gen p mean: -0.2150975614786148, mean p set: 0.44798827171325684
loss_pred:0.01454312913119793, decouple_loss:0.0023652275558561087
loss_pred:0.0140458345413208, decouple_loss:0.0022959010675549507
Iteration: 2784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468744099140167, gen p mean: -0.21527886390686035, mean p set: 0.4474049210548401
loss_pred:0.014676582999527454, decouple_loss:0.0021746407728642225
The modified gen p mean: 0.44829484820365906, gen p mean: -0.21292978525161743, mean p set: 0.4488696753978729
The modified gen p mean: 0.44619929790496826, gen p mean: -0.21955165266990662, mean p set: 0.44677630066871643
loss_pred:0.014080827124416828, decouple_loss:0.0021086600609123707
loss_pred:0.015369820408523083, decouple_loss:0.002139470772817731
Iteration: 2785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473367929458618, gen p mean: -0.21533037722110748, mean p set: 0.44790735840797424
loss_pred:0.014429230242967606, decouple_loss:0.002198531525209546
The modified gen p mean: 0.4471549987792969, gen p mean: -0.2175254374742508, mean p set: 0.4477385878562927The modified gen p mean: 0.44799840450286865, gen p mean: -0.21691828966140747, mean p set: 0.4485274851322174
loss_pred:0.014744809828698635, decouple_loss:0.002249316778033972
loss_pred:0.014688478782773018, decouple_loss:0.002405818086117506
Iteration: 2786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844406843185425, gen p mean: -0.2109375149011612, mean p set: 0.4490176737308502
loss_pred:0.014414641074836254, decouple_loss:0.0025311275385320187
The modified gen p mean: 0.44658419489860535, gen p mean: -0.20769919455051422, mean p set: 0.447108656167984The modified gen p mean: 0.44806748628616333, gen p mean: -0.20627005398273468, mean p set: 0.4486429989337921
loss_pred:0.014705847017467022, decouple_loss:0.0023305793292820454
loss_pred:0.014069671742618084, decouple_loss:0.0022792438976466656
Iteration: 2787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879788160324097, gen p mean: -0.20741519331932068, mean p set: 0.44937291741371155
loss_pred:0.014492569491267204, decouple_loss:0.002436216687783599
The modified gen p mean: 0.4467277526855469, gen p mean: -0.21712204813957214, mean p set: 0.44725939631462097The modified gen p mean: 0.44769352674484253, gen p mean: -0.21852046251296997, mean p set: 0.44827136397361755
loss_pred:0.014186630956828594, decouple_loss:0.002492649247869849
loss_pred:0.01480936724692583, decouple_loss:0.0026011436711996794
Iteration: 2788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767042994499207, gen p mean: -0.2212248146533966, mean p set: 0.44824886322021484
loss_pred:0.014290164224803448, decouple_loss:0.0024348096922039986
The modified gen p mean: 0.44681599736213684, gen p mean: -0.21132904291152954, mean p set: 0.44739410281181335
loss_pred:0.015423620119690895, decouple_loss:0.002455242443829775
The modified gen p mean: 0.4480929672718048, gen p mean: -0.21866407990455627, mean p set: 0.4486168920993805
loss_pred:0.014383570291101933, decouple_loss:0.0023664459586143494
Iteration: 2789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699880480766296, gen p mean: -0.21614621579647064, mean p set: 0.4475743770599365
loss_pred:0.01552500668913126, decouple_loss:0.0023587390314787626
The modified gen p mean: 0.447001188993454, gen p mean: -0.21542103588581085, mean p set: 0.44756919145584106
loss_pred:0.015462520532310009, decouple_loss:0.002408538246527314
The modified gen p mean: 0.4469973146915436, gen p mean: -0.21829384565353394, mean p set: 0.4475267231464386
loss_pred:0.014601006172597408, decouple_loss:0.002400168916210532
Iteration: 2790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790133833885193, gen p mean: -0.22328515350818634, mean p set: 0.4484791159629822
loss_pred:0.014433825388550758, decouple_loss:0.0026491452008485794
The modified gen p mean: 0.44721853733062744, gen p mean: -0.21948064863681793, mean p set: 0.4477514624595642The modified gen p mean: 0.4471473693847656, gen p mean: -0.2207459658384323, mean p set: 0.44772061705589294
loss_pred:0.014500768855214119, decouple_loss:0.0028082167264074087
loss_pred:0.01414819061756134, decouple_loss:0.002648091409355402
2023-04-27 12:07:24 testing...
The modified gen p mean: 0.4482199549674988, gen p mean: -0.21490757167339325, mean p set: 0.44879910349845886
loss_pred:0.01662520505487919, decouple_loss:0.002437285613268614
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21755674481391907, mean p set: 0.4499112665653229
loss_pred:0.016645267605781555, decouple_loss:0.0023392371367663145
The modified gen p mean: 0.4493054151535034, gen p mean: -0.2180885523557663, mean p set: 0.4498290419578552
loss_pred:0.01624639891088009, decouple_loss:0.002416431438177824
WV_1_PC_1_EH_0_PS_30, loss: 0.016625506803393364, avg_mse: 0.024694737046957016
current test mse: 0.024695
Iteration: 2791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470805525779724, gen p mean: -0.22026976943016052, mean p set: 0.44765228033065796
loss_pred:0.01486008707433939, decouple_loss:0.00232889992184937
The modified gen p mean: 0.44757914543151855, gen p mean: -0.2132120430469513, mean p set: 0.4481112062931061
loss_pred:0.015091919340193272, decouple_loss:0.0024584189523011446
The modified gen p mean: 0.44789958000183105, gen p mean: -0.22316989302635193, mean p set: 0.4484758675098419
loss_pred:0.01450247224420309, decouple_loss:0.0023572801146656275
Iteration: 2792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482492208480835, gen p mean: -0.21389862895011902, mean p set: 0.44877946376800537
loss_pred:0.013904877938330173, decouple_loss:0.0021972416434437037
The modified gen p mean: 0.4466230571269989, gen p mean: -0.22109264135360718, mean p set: 0.4471994936466217
loss_pred:0.01489192619919777, decouple_loss:0.002320073079317808
The modified gen p mean: 0.447790265083313, gen p mean: -0.22184818983078003, mean p set: 0.44836175441741943
loss_pred:0.01433571521192789, decouple_loss:0.0024786419235169888
Iteration: 2793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484350383281708, gen p mean: -0.21988384425640106, mean p set: 0.4489628076553345
loss_pred:0.014134920202195644, decouple_loss:0.0026233866810798645
The modified gen p mean: 0.44799214601516724, gen p mean: -0.21456710994243622, mean p set: 0.4485653042793274
loss_pred:0.013814598321914673, decouple_loss:0.0025630751624703407
The modified gen p mean: 0.447211891412735, gen p mean: -0.21713197231292725, mean p set: 0.44779151678085327
loss_pred:0.014545834623277187, decouple_loss:0.002568272640928626
Iteration: 2794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466497004032135, gen p mean: -0.21377745270729065, mean p set: 0.4471812844276428
loss_pred:0.014766179956495762, decouple_loss:0.0022035071160644293
The modified gen p mean: 0.4468296468257904, gen p mean: -0.21475525200366974, mean p set: 0.4474024176597595
loss_pred:0.014387566596269608, decouple_loss:0.0020939877722412348
The modified gen p mean: 0.44780290126800537, gen p mean: -0.21298709511756897, mean p set: 0.4483802020549774
loss_pred:0.014109461568295956, decouple_loss:0.002270412864163518
Iteration: 2795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809502363204956, gen p mean: -0.2126060575246811, mean p set: 0.4486709535121918
loss_pred:0.013836156576871872, decouple_loss:0.0027723226230591536
The modified gen p mean: 0.44742342829704285, gen p mean: -0.2205570638179779, mean p set: 0.44795170426368713The modified gen p mean: 0.4473513662815094, gen p mean: -0.2163238227367401, mean p set: 0.4479270875453949
loss_pred:0.014466957189142704, decouple_loss:0.0029874874744564295
loss_pred:0.014130773022770882, decouple_loss:0.002654893323779106
Iteration: 2796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473634958267212, gen p mean: -0.22258266806602478, mean p set: 0.44793838262557983
loss_pred:0.014320235699415207, decouple_loss:0.0025169886648654938
The modified gen p mean: 0.44886621832847595, gen p mean: -0.2130546122789383, mean p set: 0.4493965804576874The modified gen p mean: 0.44699522852897644, gen p mean: -0.22203250229358673, mean p set: 0.44756677746772766
loss_pred:0.014649116434156895, decouple_loss:0.002153818728402257
loss_pred:0.013978386297821999, decouple_loss:0.0022918288595974445
Iteration: 2797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464542865753174, gen p mean: -0.21581245958805084, mean p set: 0.4470299780368805
loss_pred:0.014893521554768085, decouple_loss:0.002532482147216797
The modified gen p mean: 0.44770899415016174, gen p mean: -0.22072632610797882, mean p set: 0.4482361972332001The modified gen p mean: 0.44742530584335327, gen p mean: -0.21709442138671875, mean p set: 0.44800853729248047
loss_pred:0.014551402069628239, decouple_loss:0.0025643238332122564
loss_pred:0.014152349904179573, decouple_loss:0.0024819455575197935
Iteration: 2798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464285373687744, gen p mean: -0.2236143797636032, mean p set: 0.44700247049331665
loss_pred:0.014802398160099983, decouple_loss:0.0023207443300634623
The modified gen p mean: 0.44621989130973816, gen p mean: -0.21620751917362213, mean p set: 0.44675159454345703The modified gen p mean: 0.44860973954200745, gen p mean: -0.21775969862937927, mean p set: 0.449184387922287
loss_pred:0.01418222114443779, decouple_loss:0.002553375205025077
loss_pred:0.01513658370822668, decouple_loss:0.0022207696456462145
Iteration: 2799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467536211013794, gen p mean: -0.22900822758674622, mean p set: 0.4473215639591217
loss_pred:0.014668580144643784, decouple_loss:0.002119177021086216
The modified gen p mean: 0.4478006958961487, gen p mean: -0.21732433140277863, mean p set: 0.4483778774738312The modified gen p mean: 0.44794583320617676, gen p mean: -0.2199980616569519, mean p set: 0.44847285747528076
loss_pred:0.014352483674883842, decouple_loss:0.002435533795505762
loss_pred:0.014050700701773167, decouple_loss:0.0023913399782031775
Iteration: 2800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868531823158264, gen p mean: -0.227509006857872, mean p set: 0.44926023483276367
loss_pred:0.014305702410638332, decouple_loss:0.0021395760122686625
The modified gen p mean: 0.447277694940567, gen p mean: -0.22889021039009094, mean p set: 0.4478025436401367The modified gen p mean: 0.44737228751182556, gen p mean: -0.22426487505435944, mean p set: 0.4479469656944275
loss_pred:0.014495203271508217, decouple_loss:0.002146998653188348
loss_pred:0.01424202136695385, decouple_loss:0.002099505625665188
2023-04-27 12:10:49 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22246134281158447, mean p set: 0.4499112665653229
loss_pred:0.016638025641441345, decouple_loss:0.0024894734378904104
The modified gen p mean: 0.4493030607700348, gen p mean: -0.22273693978786469, mean p set: 0.4498290419578552
loss_pred:0.016266973689198494, decouple_loss:0.002428938401862979
The modified gen p mean: 0.44822341203689575, gen p mean: -0.2197716385126114, mean p set: 0.44879910349845886
loss_pred:0.016679581254720688, decouple_loss:0.0024142416659742594
WV_1_PC_1_EH_0_PS_30, loss: 0.016650404781103134, avg_mse: 0.024705013260245323
current test mse: 0.024705
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 2801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810569286346436, gen p mean: -0.22413033246994019, mean p set: 0.44863414764404297
loss_pred:0.013944690115749836, decouple_loss:0.0023250391241163015
The modified gen p mean: 0.4469676613807678, gen p mean: -0.2197401374578476, mean p set: 0.44753846526145935
loss_pred:0.014720371924340725, decouple_loss:0.0025509600527584553
The modified gen p mean: 0.4489074647426605, gen p mean: -0.21711121499538422, mean p set: 0.44948315620422363
loss_pred:0.014460489153862, decouple_loss:0.0023446809500455856
Iteration: 2802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472644329071045, gen p mean: -0.22349275648593903, mean p set: 0.4477921724319458
loss_pred:0.014413370750844479, decouple_loss:0.0023181666620075703
The modified gen p mean: 0.4471818804740906, gen p mean: -0.21865981817245483, mean p set: 0.447760671377182
The modified gen p mean: 0.44909948110580444, gen p mean: -0.22046184539794922, mean p set: 0.4496791362762451
loss_pred:0.014443210326135159, decouple_loss:0.002156206639483571
loss_pred:0.01421284768730402, decouple_loss:0.002255777595564723
Iteration: 2803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482320547103882, gen p mean: -0.21976947784423828, mean p set: 0.4487580358982086
loss_pred:0.01365839596837759, decouple_loss:0.002242362592369318
The modified gen p mean: 0.4491212069988251, gen p mean: -0.21424812078475952, mean p set: 0.44969815015792847
The modified gen p mean: 0.44608673453330994, gen p mean: -0.2171117216348648, mean p set: 0.4466628134250641
loss_pred:0.01418605912476778, decouple_loss:0.0020996134262531996
loss_pred:0.014798128046095371, decouple_loss:0.0022362784948199987
Iteration: 2804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770342111587524, gen p mean: -0.21231120824813843, mean p set: 0.44823670387268066
loss_pred:0.014120080508291721, decouple_loss:0.0022718661930412054
The modified gen p mean: 0.44822958111763, gen p mean: -0.22001604735851288, mean p set: 0.44880014657974243
The modified gen p mean: 0.44716066122055054, gen p mean: -0.21789978444576263, mean p set: 0.4477404057979584
loss_pred:0.013783481903374195, decouple_loss:0.0022120734211057425
loss_pred:0.014655295759439468, decouple_loss:0.0024963687174022198
Iteration: 2805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470977187156677, gen p mean: -0.21788357198238373, mean p set: 0.4476757347583771
loss_pred:0.01446355041116476, decouple_loss:0.0021564981434494257
The modified gen p mean: 0.44877997040748596, gen p mean: -0.2197657972574234, mean p set: 0.4493098258972168The modified gen p mean: 0.44848722219467163, gen p mean: -0.2121933251619339, mean p set: 0.44906049966812134
loss_pred:0.01394748967140913, decouple_loss:0.00237538805231452
loss_pred:0.014140603132545948, decouple_loss:0.002586820162832737
Iteration: 2806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727474451065063, gen p mean: -0.20787443220615387, mean p set: 0.44784975051879883
loss_pred:0.01368981134146452, decouple_loss:0.0023572847712785006
The modified gen p mean: 0.44635429978370667, gen p mean: -0.21156546473503113, mean p set: 0.4468816816806793The modified gen p mean: 0.4499377906322479, gen p mean: -0.20815196633338928, mean p set: 0.4505167305469513
loss_pred:0.014495303854346275, decouple_loss:0.0025985613465309143
loss_pred:0.01496983878314495, decouple_loss:0.002639255253598094
Iteration: 2807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44592416286468506, gen p mean: -0.2146705836057663, mean p set: 0.4464992880821228
loss_pred:0.014879981055855751, decouple_loss:0.00227071950212121
The modified gen p mean: 0.44677653908729553, gen p mean: -0.21741555631160736, mean p set: 0.4473493695259094
loss_pred:0.014580977149307728, decouple_loss:0.0022524548694491386
The modified gen p mean: 0.4482578635215759, gen p mean: -0.2172151803970337, mean p set: 0.44878509640693665
loss_pred:0.014559638686478138, decouple_loss:0.00245158770121634
Iteration: 2808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475669264793396, gen p mean: -0.21524830162525177, mean p set: 0.4481406807899475
loss_pred:0.014294097200036049, decouple_loss:0.002766548888757825
The modified gen p mean: 0.4472483694553375, gen p mean: -0.20947305858135223, mean p set: 0.44782590866088867
loss_pred:0.014540509320795536, decouple_loss:0.002480042865499854
The modified gen p mean: 0.448135644197464, gen p mean: -0.21509835124015808, mean p set: 0.44866541028022766
loss_pred:0.01444956474006176, decouple_loss:0.0024805297143757343
Iteration: 2809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919273257255554, gen p mean: -0.21684274077415466, mean p set: 0.44976967573165894
loss_pred:0.013930424116551876, decouple_loss:0.002675814088433981
The modified gen p mean: 0.4478435814380646, gen p mean: -0.2159293293952942, mean p set: 0.44841745495796204
loss_pred:0.013921667821705341, decouple_loss:0.0024926913902163506
The modified gen p mean: 0.4501422643661499, gen p mean: -0.2163567841053009, mean p set: 0.4506722390651703
loss_pred:0.014162431471049786, decouple_loss:0.0024273095186799765
Iteration: 2810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877997040748596, gen p mean: -0.23190489411354065, mean p set: 0.4493577182292938
loss_pred:0.01368860062211752, decouple_loss:0.0022992421872913837
The modified gen p mean: 0.44746294617652893, gen p mean: -0.23116669058799744, mean p set: 0.44798991084098816The modified gen p mean: 0.44793039560317993, gen p mean: -0.22903820872306824, mean p set: 0.4485096037387848
loss_pred:0.014290809631347656, decouple_loss:0.002635637531057
loss_pred:0.013715634122490883, decouple_loss:0.002153768204152584
2023-04-27 12:14:55 testing...
The modified gen p mean: 0.448223739862442, gen p mean: -0.22680149972438812, mean p set: 0.44879910349845886
loss_pred:0.016683483496308327, decouple_loss:0.002765209414064884
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22959016263484955, mean p set: 0.4499112665653229
loss_pred:0.016818838194012642, decouple_loss:0.002578097628429532
The modified gen p mean: 0.44930553436279297, gen p mean: -0.22959446907043457, mean p set: 0.4498290419578552
loss_pred:0.01628834567964077, decouple_loss:0.002688805339857936
WV_1_PC_1_EH_0_PS_30, loss: 0.016730759292840958, avg_mse: 0.024843044579029083
current test mse: 0.024843
Iteration: 2811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818395376205444, gen p mean: -0.23270218074321747, mean p set: 0.4487130343914032
loss_pred:0.014118559658527374, decouple_loss:0.0027535799890756607
The modified gen p mean: 0.4486718773841858, gen p mean: -0.22489745914936066, mean p set: 0.44924619793891907
loss_pred:0.014113725163042545, decouple_loss:0.002769974758848548
The modified gen p mean: 0.4486704170703888, gen p mean: -0.23062202334403992, mean p set: 0.44924888014793396
loss_pred:0.013998094014823437, decouple_loss:0.0028745552990585566
Iteration: 2812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44898101687431335, gen p mean: -0.22640343010425568, mean p set: 0.44950512051582336
loss_pred:0.013870962895452976, decouple_loss:0.002161693526431918
The modified gen p mean: 0.4468366801738739, gen p mean: -0.22939904034137726, mean p set: 0.44741132855415344
The modified gen p mean: 0.44692113995552063, gen p mean: -0.2287084460258484, mean p set: 0.44749414920806885
loss_pred:0.014675155282020569, decouple_loss:0.0024874720256775618
loss_pred:0.014542516320943832, decouple_loss:0.002430715598165989
Iteration: 2813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468781352043152, gen p mean: -0.2338927537202835, mean p set: 0.44741183519363403
loss_pred:0.01427275687456131, decouple_loss:0.002555008279159665
The modified gen p mean: 0.44784513115882874, gen p mean: -0.23043645918369293, mean p set: 0.44842419028282166
The modified gen p mean: 0.44900408387184143, gen p mean: -0.22701041400432587, mean p set: 0.4495809078216553
loss_pred:0.014313261955976486, decouple_loss:0.002681420650333166
loss_pred:0.014315194450318813, decouple_loss:0.002758380491286516
Iteration: 2814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447798490524292, gen p mean: -0.2283129096031189, mean p set: 0.4483746588230133
loss_pred:0.01423973310738802, decouple_loss:0.0028420172166079283
The modified gen p mean: 0.4485001564025879, gen p mean: -0.22691427171230316, mean p set: 0.449078768491745
loss_pred:0.013943071477115154, decouple_loss:0.0025374724064022303
The modified gen p mean: 0.44785889983177185, gen p mean: -0.223439559340477, mean p set: 0.44838523864746094
loss_pred:0.01463998667895794, decouple_loss:0.0025962358340620995
Iteration: 2815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470690190792084, gen p mean: -0.22754579782485962, mean p set: 0.4476434886455536
loss_pred:0.0140982111915946, decouple_loss:0.002726420061662793
The modified gen p mean: 0.44699913263320923, gen p mean: -0.22866390645503998, mean p set: 0.44752633571624756The modified gen p mean: 0.44651851058006287, gen p mean: -0.2268812358379364, mean p set: 0.44709157943725586
loss_pred:0.014244713820517063, decouple_loss:0.0027110124938189983
loss_pred:0.013475906103849411, decouple_loss:0.00253479927778244
Iteration: 2816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730865955352783, gen p mean: -0.21831351518630981, mean p set: 0.4478890001773834
loss_pred:0.014340534806251526, decouple_loss:0.002962801605463028
The modified gen p mean: 0.44761157035827637, gen p mean: -0.2201261669397354, mean p set: 0.4481384754180908The modified gen p mean: 0.44962185621261597, gen p mean: -0.21945936977863312, mean p set: 0.45020049810409546
loss_pred:0.014072583988308907, decouple_loss:0.0024811008479446173
loss_pred:0.0136331208050251, decouple_loss:0.0026495829224586487
Iteration: 2817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492717981338501, gen p mean: -0.2156536728143692, mean p set: 0.44985491037368774
loss_pred:0.014254573732614517, decouple_loss:0.0025125183165073395
The modified gen p mean: 0.4486231803894043, gen p mean: -0.22365303337574005, mean p set: 0.4491964280605316
loss_pred:0.014021606184542179, decouple_loss:0.002709656488150358
The modified gen p mean: 0.447336345911026, gen p mean: -0.22172224521636963, mean p set: 0.44786572456359863
loss_pred:0.013827702961862087, decouple_loss:0.002593205077573657
Iteration: 2818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473941922187805, gen p mean: -0.2208365947008133, mean p set: 0.4479677379131317
loss_pred:0.013747998513281345, decouple_loss:0.0022314831148833036
The modified gen p mean: 0.4491298794746399, gen p mean: -0.22254963219165802, mean p set: 0.4497106075286865
loss_pred:0.01408811379224062, decouple_loss:0.0022496371529996395
The modified gen p mean: 0.4481930136680603, gen p mean: -0.2182563692331314, mean p set: 0.4487197697162628
loss_pred:0.014386595226824284, decouple_loss:0.002697773976251483
Iteration: 2819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44875645637512207, gen p mean: -0.21726644039154053, mean p set: 0.4493320882320404
loss_pred:0.014156380668282509, decouple_loss:0.0029303734190762043
The modified gen p mean: 0.4488520324230194, gen p mean: -0.21517235040664673, mean p set: 0.4493766129016876The modified gen p mean: 0.4483196437358856, gen p mean: -0.21258635818958282, mean p set: 0.4488963484764099
loss_pred:0.01420686487108469, decouple_loss:0.003150142263621092
loss_pred:0.014088304713368416, decouple_loss:0.0027179729659110308
Iteration: 2820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463629722595215, gen p mean: -0.21585975587368011, mean p set: 0.4469376802444458
loss_pred:0.014666842296719551, decouple_loss:0.0023043176624923944
The modified gen p mean: 0.4492347240447998, gen p mean: -0.21244500577449799, mean p set: 0.4498105049133301
loss_pred:0.014395511709153652, decouple_loss:0.0023711002431809902
The modified gen p mean: 0.44778674840927124, gen p mean: -0.21095262467861176, mean p set: 0.4483111500740051
loss_pred:0.014515934512019157, decouple_loss:0.002526167780160904
2023-04-27 12:18:21 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21720540523529053, mean p set: 0.4499112665653229
loss_pred:0.0166934821754694, decouple_loss:0.002404575003311038
The modified gen p mean: 0.44930997490882874, gen p mean: -0.21743999421596527, mean p set: 0.4498290419578552
loss_pred:0.01627478376030922, decouple_loss:0.0024230892304331064
The modified gen p mean: 0.4482225775718689, gen p mean: -0.21472865343093872, mean p set: 0.44879910349845886
loss_pred:0.016639214009046555, decouple_loss:0.0024033489171415567
WV_1_PC_1_EH_0_PS_30, loss: 0.016656342893838882, avg_mse: 0.02476176992058754
current test mse: 0.024762
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 2821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459424316883087, gen p mean: -0.2171100378036499, mean p set: 0.4464685022830963
loss_pred:0.01591927371919155, decouple_loss:0.0024079028517007828
The modified gen p mean: 0.44743746519088745, gen p mean: -0.21807174384593964, mean p set: 0.4480128884315491
loss_pred:0.016194842755794525, decouple_loss:0.0027223199140280485
The modified gen p mean: 0.4473636746406555, gen p mean: -0.21562813222408295, mean p set: 0.4479365348815918
loss_pred:0.015853218734264374, decouple_loss:0.002616800833493471
Iteration: 2822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742071628570557, gen p mean: -0.2194119393825531, mean p set: 0.4479503035545349
loss_pred:0.014308767393231392, decouple_loss:0.002119594020769
The modified gen p mean: 0.44762396812438965, gen p mean: -0.21536505222320557, mean p set: 0.44819650053977966
The modified gen p mean: 0.4471495449542999, gen p mean: -0.21724429726600647, mean p set: 0.44772863388061523
loss_pred:0.014871851541101933, decouple_loss:0.002088060136884451
loss_pred:0.015002955682575703, decouple_loss:0.0020254889968782663
Iteration: 2823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466972053050995, gen p mean: -0.22405976057052612, mean p set: 0.44722431898117065
loss_pred:0.015234912745654583, decouple_loss:0.0024751583114266396
The modified gen p mean: 0.44655415415763855, gen p mean: -0.22223439812660217, mean p set: 0.4471304714679718
The modified gen p mean: 0.4474177658557892, gen p mean: -0.2181459665298462, mean p set: 0.4479900598526001
loss_pred:0.015477637760341167, decouple_loss:0.002582429675385356
loss_pred:0.015714604407548904, decouple_loss:0.0023293429985642433
Iteration: 2824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467359483242035, gen p mean: -0.22215016186237335, mean p set: 0.44726207852363586
loss_pred:0.015262825414538383, decouple_loss:0.002362931380048394
The modified gen p mean: 0.44598135352134705, gen p mean: -0.21897220611572266, mean p set: 0.4465586841106415
The modified gen p mean: 0.446416974067688, gen p mean: -0.2191307544708252, mean p set: 0.4469989240169525
loss_pred:0.015636730939149857, decouple_loss:0.002465754048898816
loss_pred:0.015173005871474743, decouple_loss:0.0021782496478408575
Iteration: 2825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461654722690582, gen p mean: -0.22070282697677612, mean p set: 0.44674646854400635
loss_pred:0.014610628597438335, decouple_loss:0.0022854998242110014
The modified gen p mean: 0.44779983162879944, gen p mean: -0.2230464220046997, mean p set: 0.4483300447463989The modified gen p mean: 0.4475060999393463, gen p mean: -0.2223695069551468, mean p set: 0.4480864405632019
loss_pred:0.015067669562995434, decouple_loss:0.0024570252280682325
loss_pred:0.015386651270091534, decouple_loss:0.0024603158235549927
Iteration: 2826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44581031799316406, gen p mean: -0.2220609337091446, mean p set: 0.44638508558273315
loss_pred:0.01487190555781126, decouple_loss:0.0023953064810484648
The modified gen p mean: 0.44695398211479187, gen p mean: -0.22626204788684845, mean p set: 0.44752398133277893The modified gen p mean: 0.44704243540763855, gen p mean: -0.22444216907024384, mean p set: 0.44756782054901123
loss_pred:0.014775865711271763, decouple_loss:0.002198676113039255
loss_pred:0.014765043742954731, decouple_loss:0.002442180411890149
Iteration: 2827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44602274894714355, gen p mean: -0.2240336686372757, mean p set: 0.44659891724586487
loss_pred:0.01540782954543829, decouple_loss:0.0027005483862012625
The modified gen p mean: 0.4473550021648407, gen p mean: -0.22524264454841614, mean p set: 0.447883665561676The modified gen p mean: 0.4468792676925659, gen p mean: -0.2218283861875534, mean p set: 0.44745591282844543
loss_pred:0.015197264030575752, decouple_loss:0.0021585614886134863
loss_pred:0.01588216982781887, decouple_loss:0.0023692564573138952
Iteration: 2828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641000032424927, gen p mean: -0.22212685644626617, mean p set: 0.4469858705997467
loss_pred:0.01535884477198124, decouple_loss:0.002545579569414258
The modified gen p mean: 0.4462507963180542, gen p mean: -0.22105297446250916, mean p set: 0.4468272626399994
loss_pred:0.015674490481615067, decouple_loss:0.002593838842585683
The modified gen p mean: 0.44717085361480713, gen p mean: -0.2231786996126175, mean p set: 0.4476989209651947
loss_pred:0.015233766287565231, decouple_loss:0.002069592708721757
Iteration: 2829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471058249473572, gen p mean: -0.21855568885803223, mean p set: 0.44768035411834717
loss_pred:0.014796075411140919, decouple_loss:0.0025283226277679205
The modified gen p mean: 0.44692516326904297, gen p mean: -0.21889907121658325, mean p set: 0.44749605655670166
loss_pred:0.015446330420672894, decouple_loss:0.0025679024402052164
The modified gen p mean: 0.4464993178844452, gen p mean: -0.21709652245044708, mean p set: 0.44702792167663574
loss_pred:0.014988978393375874, decouple_loss:0.00253865122795105
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44662466645240784, gen p mean: -0.21592411398887634, mean p set: 0.4472024440765381
loss_pred:0.015132376924157143, decouple_loss:0.0024369091261178255
The modified gen p mean: 0.4461604654788971, gen p mean: -0.22033913433551788, mean p set: 0.4467359483242035
loss_pred:0.015236342325806618, decouple_loss:0.0024070434737950563
The modified gen p mean: 0.446907103061676, gen p mean: -0.2245641052722931, mean p set: 0.44743674993515015
loss_pred:0.014993119053542614, decouple_loss:0.002303636632859707
2023-04-27 12:22:36 testing...
The modified gen p mean: 0.44822582602500916, gen p mean: -0.21858520805835724, mean p set: 0.44879910349845886
loss_pred:0.016536137089133263, decouple_loss:0.0023353889118880033
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2212034910917282, mean p set: 0.4499112665653229
loss_pred:0.01662779226899147, decouple_loss:0.0025516683235764503
The modified gen p mean: 0.4493018388748169, gen p mean: -0.22163720428943634, mean p set: 0.4498290419578552
loss_pred:0.01622667908668518, decouple_loss:0.0024221402127295732
WV_1_PC_1_EH_0_PS_30, loss: 0.01658535562455654, avg_mse: 0.024573681876063347
current test mse: 0.024574
Iteration: 2831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44572392106056213, gen p mean: -0.2215012162923813, mean p set: 0.4462953209877014
loss_pred:0.014481520280241966, decouple_loss:0.0021111557725816965
The modified gen p mean: 0.44715455174446106, gen p mean: -0.2199370563030243, mean p set: 0.44773682951927185
loss_pred:0.014885678887367249, decouple_loss:0.002210763515904546
The modified gen p mean: 0.4456149637699127, gen p mean: -0.22113943099975586, mean p set: 0.4461430609226227
loss_pred:0.015705393627285957, decouple_loss:0.0024857674725353718
Iteration: 2832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625920057296753, gen p mean: -0.2267989069223404, mean p set: 0.44678789377212524
loss_pred:0.014514785259962082, decouple_loss:0.002228484023362398
The modified gen p mean: 0.44615185260772705, gen p mean: -0.22760654985904694, mean p set: 0.44672611355781555
loss_pred:0.015916697680950165, decouple_loss:0.0022986470721662045
The modified gen p mean: 0.4470100402832031, gen p mean: -0.22674192488193512, mean p set: 0.4475901126861572
loss_pred:0.015316098928451538, decouple_loss:0.0023857560008764267
Iteration: 2833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466412663459778, gen p mean: -0.22948671877384186, mean p set: 0.44716861844062805
loss_pred:0.014939910732209682, decouple_loss:0.0026903648395091295
The modified gen p mean: 0.44726359844207764, gen p mean: -0.23413655161857605, mean p set: 0.4478432536125183
loss_pred:0.015326181426644325, decouple_loss:0.0026601371355354786
The modified gen p mean: 0.4465066194534302, gen p mean: -0.22728468477725983, mean p set: 0.4470832645893097
loss_pred:0.014886523596942425, decouple_loss:0.002301471307873726
Iteration: 2834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455420970916748, gen p mean: -0.22482676804065704, mean p set: 0.4460710883140564
loss_pred:0.014749228954315186, decouple_loss:0.0021950111258774996
The modified gen p mean: 0.44752562046051025, gen p mean: -0.2239212542772293, mean p set: 0.4480966627597809
loss_pred:0.015112856402993202, decouple_loss:0.0022223314736038446
The modified gen p mean: 0.44687893986701965, gen p mean: -0.22494801878929138, mean p set: 0.44745174050331116
loss_pred:0.01522971410304308, decouple_loss:0.0023191580548882484
Iteration: 2835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44613683223724365, gen p mean: -0.22079327702522278, mean p set: 0.446708619594574
loss_pred:0.015027832239866257, decouple_loss:0.0020988748874515295
The modified gen p mean: 0.44661980867385864, gen p mean: -0.22772260010242462, mean p set: 0.44714680314064026The modified gen p mean: 0.447488397359848, gen p mean: -0.22633937001228333, mean p set: 0.4480704963207245
loss_pred:0.015238399617373943, decouple_loss:0.003210218623280525
loss_pred:0.01527092419564724, decouple_loss:0.002140973461791873
Iteration: 2836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465239346027374, gen p mean: -0.22424469888210297, mean p set: 0.44709739089012146
loss_pred:0.015585131011903286, decouple_loss:0.0021731690503656864
The modified gen p mean: 0.4471973180770874, gen p mean: -0.23094521462917328, mean p set: 0.4477214217185974The modified gen p mean: 0.44746702909469604, gen p mean: -0.2290646731853485, mean p set: 0.4480500817298889
loss_pred:0.01417908538132906, decouple_loss:0.002075715223327279
loss_pred:0.015082407742738724, decouple_loss:0.0019918023608624935
Iteration: 2837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785651564598083, gen p mean: -0.22346362471580505, mean p set: 0.4484312832355499
loss_pred:0.015049752779304981, decouple_loss:0.002265296643599868
The modified gen p mean: 0.4464104175567627, gen p mean: -0.22178325057029724, mean p set: 0.44698208570480347
loss_pred:0.01586548425257206, decouple_loss:0.0022384326439350843
The modified gen p mean: 0.4476863443851471, gen p mean: -0.21723578870296478, mean p set: 0.44821488857269287
loss_pred:0.015068620443344116, decouple_loss:0.002100402722135186
Iteration: 2838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687867164611816, gen p mean: -0.22800946235656738, mean p set: 0.44745466113090515
loss_pred:0.014807923696935177, decouple_loss:0.00202844082377851
The modified gen p mean: 0.4468979835510254, gen p mean: -0.227334663271904, mean p set: 0.4474724233150482
The modified gen p mean: 0.44569510221481323, gen p mean: -0.2233210802078247, mean p set: 0.44622352719306946
loss_pred:0.015164753422141075, decouple_loss:0.001955324085429311
loss_pred:0.01538328267633915, decouple_loss:0.00196642242372036
Iteration: 2839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44638878107070923, gen p mean: -0.22068513929843903, mean p set: 0.44696730375289917
loss_pred:0.014592920430004597, decouple_loss:0.0021073142997920513
The modified gen p mean: 0.4464902877807617, gen p mean: -0.22468164563179016, mean p set: 0.44706523418426514
loss_pred:0.015019133687019348, decouple_loss:0.002155531896278262
The modified gen p mean: 0.44649824500083923, gen p mean: -0.2175552248954773, mean p set: 0.4470199644565582
loss_pred:0.014817627146840096, decouple_loss:0.0020350366830825806
Iteration: 2840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628962874412537, gen p mean: -0.22052565217018127, mean p set: 0.4468649923801422
loss_pred:0.01516267005354166, decouple_loss:0.0019435241119936109
The modified gen p mean: 0.446681946516037, gen p mean: -0.22613906860351562, mean p set: 0.44725584983825684
loss_pred:0.014707567170262337, decouple_loss:0.0018997886218130589
The modified gen p mean: 0.44648343324661255, gen p mean: -0.22272874414920807, mean p set: 0.44700896739959717
loss_pred:0.014964163303375244, decouple_loss:0.001967918360605836
2023-04-27 12:26:01 testing...
The modified gen p mean: 0.44822052121162415, gen p mean: -0.22155363857746124, mean p set: 0.44879910349845886
loss_pred:0.016521792858839035, decouple_loss:0.00212400802411139
The modified gen p mean: 0.449293315410614, gen p mean: -0.22448913753032684, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22372619807720184, mean p set: 0.4499112665653229loss_pred:0.016113173216581345, decouple_loss:0.0021795909851789474
loss_pred:0.01659846119582653, decouple_loss:0.0022682419512420893
WV_1_PC_1_EH_0_PS_30, loss: 0.016520673409104347, avg_mse: 0.024483095854520798
current test mse: 0.024483
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 2841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468132555484772, gen p mean: -0.22419975697994232, mean p set: 0.44733917713165283
loss_pred:0.015141192823648453, decouple_loss:0.0024932946544140577
The modified gen p mean: 0.4483972489833832, gen p mean: -0.22805576026439667, mean p set: 0.44897395372390747
The modified gen p mean: 0.4483567476272583, gen p mean: -0.221504807472229, mean p set: 0.4489316940307617
loss_pred:0.015083115547895432, decouple_loss:0.0028531625866889954
loss_pred:0.014726250432431698, decouple_loss:0.0031794572714716196
Iteration: 2842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475476145744324, gen p mean: -0.23183318972587585, mean p set: 0.44807443022727966
loss_pred:0.014696924947202206, decouple_loss:0.002361432882025838
The modified gen p mean: 0.4484238922595978, gen p mean: -0.22745296359062195, mean p set: 0.44899824261665344The modified gen p mean: 0.44695809483528137, gen p mean: -0.2276245355606079, mean p set: 0.44753316044807434
loss_pred:0.01486011128872633, decouple_loss:0.002487956080585718
loss_pred:0.016045600175857544, decouple_loss:0.002080921083688736
Iteration: 2843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657212495803833, gen p mean: -0.2356276959180832, mean p set: 0.4471015930175781
loss_pred:0.016018802300095558, decouple_loss:0.0026120287366211414
The modified gen p mean: 0.44695690274238586, gen p mean: -0.22951246798038483, mean p set: 0.44752857089042664The modified gen p mean: 0.446866512298584, gen p mean: -0.23313085734844208, mean p set: 0.44744372367858887
loss_pred:0.014911484904587269, decouple_loss:0.0025948702823370695
loss_pred:0.015320831909775734, decouple_loss:0.0026838078629225492
Iteration: 2844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683361053466797, gen p mean: -0.23386430740356445, mean p set: 0.4474082589149475
loss_pred:0.015984289348125458, decouple_loss:0.0022574441973119974
The modified gen p mean: 0.44683462381362915, gen p mean: -0.2292686551809311, mean p set: 0.4473569989204407The modified gen p mean: 0.44852542877197266, gen p mean: -0.2294072061777115, mean p set: 0.449098140001297
loss_pred:0.014473904855549335, decouple_loss:0.002491324208676815
loss_pred:0.015014393255114555, decouple_loss:0.002181789604946971
Iteration: 2845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465847909450531, gen p mean: -0.22962696850299835, mean p set: 0.4471592903137207
loss_pred:0.014647817239165306, decouple_loss:0.002229873323813081
The modified gen p mean: 0.4470633864402771, gen p mean: -0.22361138463020325, mean p set: 0.4476413428783417
loss_pred:0.014958588406443596, decouple_loss:0.0025110412389039993
The modified gen p mean: 0.4465106427669525, gen p mean: -0.23514626920223236, mean p set: 0.44703981280326843
loss_pred:0.015332167036831379, decouple_loss:0.002354101277887821
Iteration: 2846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447407066822052, gen p mean: -0.2211914211511612, mean p set: 0.44798544049263
loss_pred:0.015623013488948345, decouple_loss:0.0024238168261945248
The modified gen p mean: 0.4468499720096588, gen p mean: -0.21817971765995026, mean p set: 0.44737815856933594The modified gen p mean: 0.4469413757324219, gen p mean: -0.21800650656223297, mean p set: 0.44751542806625366
loss_pred:0.014535738155245781, decouple_loss:0.0024340327363461256
loss_pred:0.014922043308615685, decouple_loss:0.002340658800676465
Iteration: 2847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714322686195374, gen p mean: -0.21805354952812195, mean p set: 0.4477183520793915
loss_pred:0.016124799847602844, decouple_loss:0.0021207050886005163
The modified gen p mean: 0.446824312210083, gen p mean: -0.21920087933540344, mean p set: 0.4473989009857178
loss_pred:0.015936437994241714, decouple_loss:0.0021694060415029526
The modified gen p mean: 0.447233647108078, gen p mean: -0.21201768517494202, mean p set: 0.4477604627609253
loss_pred:0.015078599564731121, decouple_loss:0.002187238773331046
Iteration: 2848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792258739471436, gen p mean: -0.21855702996253967, mean p set: 0.4484971761703491
loss_pred:0.014408915303647518, decouple_loss:0.002314021112397313
The modified gen p mean: 0.4476819932460785, gen p mean: -0.21122169494628906, mean p set: 0.44820234179496765The modified gen p mean: 0.4467892348766327, gen p mean: -0.21781913936138153, mean p set: 0.44736534357070923
loss_pred:0.015543763525784016, decouple_loss:0.0022207500878721476
loss_pred:0.015242481604218483, decouple_loss:0.002151078311726451
Iteration: 2849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447883278131485, gen p mean: -0.21297933161258698, mean p set: 0.44846174120903015
loss_pred:0.014833730645477772, decouple_loss:0.0020905325654894114
The modified gen p mean: 0.44745033979415894, gen p mean: -0.2099018692970276, mean p set: 0.44802284240722656
loss_pred:0.014566340483725071, decouple_loss:0.002625060500577092
The modified gen p mean: 0.4462486207485199, gen p mean: -0.22000394761562347, mean p set: 0.44677209854125977
loss_pred:0.015068473294377327, decouple_loss:0.002337442012503743
Iteration: 2850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463740885257721, gen p mean: -0.21971546113491058, mean p set: 0.4469473958015442
loss_pred:0.015230635181069374, decouple_loss:0.002040645107626915
The modified gen p mean: 0.4481510818004608, gen p mean: -0.21875640749931335, mean p set: 0.4487267732620239
loss_pred:0.014926082454621792, decouple_loss:0.0020926054567098618
The modified gen p mean: 0.4475780427455902, gen p mean: -0.21356791257858276, mean p set: 0.4481060206890106
loss_pred:0.015397712588310242, decouple_loss:0.002050755312666297
2023-04-27 12:30:10 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2169477939605713, mean p set: 0.4499112665653229
loss_pred:0.016767723485827446, decouple_loss:0.0023653260432183743
The modified gen p mean: 0.4493020176887512, gen p mean: -0.21742397546768188, mean p set: 0.4498290419578552
loss_pred:0.016314655542373657, decouple_loss:0.002563982270658016
The modified gen p mean: 0.4482233226299286, gen p mean: -0.21453112363815308, mean p set: 0.44879910349845886
loss_pred:0.016656678169965744, decouple_loss:0.0024588191881775856
WV_1_PC_1_EH_0_PS_30, loss: 0.016702821478247643, avg_mse: 0.024808168411254883
current test mse: 0.024808
Iteration: 2851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728437066078186, gen p mean: -0.21703147888183594, mean p set: 0.4478605389595032
loss_pred:0.01538974791765213, decouple_loss:0.0021679173223674297
The modified gen p mean: 0.4475035071372986, gen p mean: -0.2150050550699234, mean p set: 0.44803139567375183
loss_pred:0.01515097264200449, decouple_loss:0.002129395492374897
The modified gen p mean: 0.4474870562553406, gen p mean: -0.2199932336807251, mean p set: 0.4480628967285156
loss_pred:0.015058332122862339, decouple_loss:0.0024477550759911537
Iteration: 2852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686344265937805, gen p mean: -0.21280890703201294, mean p set: 0.44738900661468506
loss_pred:0.014253033325076103, decouple_loss:0.0022800727747380733
The modified gen p mean: 0.4462461471557617, gen p mean: -0.22011831402778625, mean p set: 0.4468221068382263
The modified gen p mean: 0.44753319025039673, gen p mean: -0.21938174962997437, mean p set: 0.4481140077114105
loss_pred:0.015013610944151878, decouple_loss:0.0024800149258226156
loss_pred:0.014451716095209122, decouple_loss:0.002267473377287388
Iteration: 2853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466232657432556, gen p mean: -0.20968399941921234, mean p set: 0.4471484422683716
loss_pred:0.014368963427841663, decouple_loss:0.0022094205487519503
The modified gen p mean: 0.4465087056159973, gen p mean: -0.2148660570383072, mean p set: 0.4470820426940918
The modified gen p mean: 0.44766438007354736, gen p mean: -0.21897858381271362, mean p set: 0.4482457637786865
loss_pred:0.015061370097100735, decouple_loss:0.0022305890452116728
loss_pred:0.01462636049836874, decouple_loss:0.0021435439120978117
Iteration: 2854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476011395454407, gen p mean: -0.21516050398349762, mean p set: 0.44813334941864014
loss_pred:0.01468685269355774, decouple_loss:0.0023669640067964792
The modified gen p mean: 0.44791680574417114, gen p mean: -0.21051503717899323, mean p set: 0.4484897553920746
The modified gen p mean: 0.4483318626880646, gen p mean: -0.21648049354553223, mean p set: 0.44890403747558594
loss_pred:0.014799588359892368, decouple_loss:0.00255871401168406
loss_pred:0.014653108082711697, decouple_loss:0.0023350799456238747
Iteration: 2855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820886850357056, gen p mean: -0.21565385162830353, mean p set: 0.4487859904766083
loss_pred:0.01485708449035883, decouple_loss:0.0020649752113968134
The modified gen p mean: 0.4482206106185913, gen p mean: -0.2147674560546875, mean p set: 0.448797345161438The modified gen p mean: 0.44647228717803955, gen p mean: -0.21765093505382538, mean p set: 0.44699788093566895
loss_pred:0.015085469000041485, decouple_loss:0.0023375635500997305
loss_pred:0.015269611030817032, decouple_loss:0.0020170211791992188
Iteration: 2856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677215814590454, gen p mean: -0.22267527878284454, mean p set: 0.4473494589328766
loss_pred:0.01579481177031994, decouple_loss:0.0022089157719165087
The modified gen p mean: 0.4489659368991852, gen p mean: -0.21726398169994354, mean p set: 0.4494958221912384The modified gen p mean: 0.44685637950897217, gen p mean: -0.21396362781524658, mean p set: 0.4474294185638428
loss_pred:0.014145123772323132, decouple_loss:0.0020568587351590395
loss_pred:0.01489770133048296, decouple_loss:0.0022566805128008127
Iteration: 2857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463856518268585, gen p mean: -0.21513992547988892, mean p set: 0.4469609558582306
loss_pred:0.014251064509153366, decouple_loss:0.002326664049178362
The modified gen p mean: 0.4473048150539398, gen p mean: -0.2122412919998169, mean p set: 0.4478318989276886The modified gen p mean: 0.44738683104515076, gen p mean: -0.21352747082710266, mean p set: 0.4479648470878601
loss_pred:0.014787297695875168, decouple_loss:0.002100106794387102
loss_pred:0.015558443032205105, decouple_loss:0.0024346441496163607
Iteration: 2858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491497278213501, gen p mean: -0.2160157710313797, mean p set: 0.4497283697128296
loss_pred:0.014400978572666645, decouple_loss:0.0022082661744207144
The modified gen p mean: 0.4463088810443878, gen p mean: -0.22123904526233673, mean p set: 0.4468388855457306The modified gen p mean: 0.4480363726615906, gen p mean: -0.2131713181734085, mean p set: 0.44861525297164917
loss_pred:0.015403073281049728, decouple_loss:0.002114747418090701
loss_pred:0.01516827754676342, decouple_loss:0.0020900946110486984
Iteration: 2859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495132863521576, gen p mean: -0.21556749939918518, mean p set: 0.4500883221626282
loss_pred:0.014378680847585201, decouple_loss:0.0025299007538706064
The modified gen p mean: 0.44758424162864685, gen p mean: -0.21790875494480133, mean p set: 0.4481104910373688The modified gen p mean: 0.44670262932777405, gen p mean: -0.21975530683994293, mean p set: 0.44728177785873413
loss_pred:0.01565500535070896, decouple_loss:0.002144032157957554
loss_pred:0.014465110376477242, decouple_loss:0.002642920473590493
Iteration: 2860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449314683675766, gen p mean: -0.2133830338716507, mean p set: 0.44989389181137085
loss_pred:0.014282853342592716, decouple_loss:0.002256928477436304
The modified gen p mean: 0.44661620259284973, gen p mean: -0.21051491796970367, mean p set: 0.44714486598968506The modified gen p mean: 0.44768255949020386, gen p mean: -0.21568532288074493, mean p set: 0.4482575058937073
loss_pred:0.014916939660906792, decouple_loss:0.0020055449567735195
loss_pred:0.013956166803836823, decouple_loss:0.0020184223540127277
2023-04-27 12:33:34 testing...
The modified gen p mean: 0.44822239875793457, gen p mean: -0.2090204805135727, mean p set: 0.44879910349845886
loss_pred:0.016700835898518562, decouple_loss:0.002692600479349494
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21166199445724487, mean p set: 0.4499112665653229
loss_pred:0.01676083542406559, decouple_loss:0.0027022608555853367
The modified gen p mean: 0.44930562376976013, gen p mean: -0.21196189522743225, mean p set: 0.4498290419578552
loss_pred:0.01628723368048668, decouple_loss:0.0029116475488990545
WV_1_PC_1_EH_0_PS_30, loss: 0.016721410676836967, avg_mse: 0.02477382868528366
current test mse: 0.024774
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 2861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649171829223633, gen p mean: -0.21394889056682587, mean p set: 0.4470173120498657
loss_pred:0.01541966013610363, decouple_loss:0.0023918149527162313
The modified gen p mean: 0.4469442665576935, gen p mean: -0.2146853655576706, mean p set: 0.44751712679862976
The modified gen p mean: 0.4463910460472107, gen p mean: -0.21568924188613892, mean p set: 0.4469722807407379
loss_pred:0.0159145537763834, decouple_loss:0.0027536426205188036
loss_pred:0.01544810552150011, decouple_loss:0.002454595873132348
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475700855255127, gen p mean: -0.21263495087623596, mean p set: 0.4480991065502167
loss_pred:0.015442730858922005, decouple_loss:0.0022747721523046494
The modified gen p mean: 0.4466681480407715, gen p mean: -0.20781120657920837, mean p set: 0.4472399353981018
The modified gen p mean: 0.44644707441329956, gen p mean: -0.21281570196151733, mean p set: 0.44702646136283875
loss_pred:0.015721717849373817, decouple_loss:0.002169413957744837
loss_pred:0.015172349289059639, decouple_loss:0.0021435609087347984
Iteration: 2863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465214014053345, gen p mean: -0.21519975364208221, mean p set: 0.44704657793045044
loss_pred:0.015828054398298264, decouple_loss:0.0025352181401103735
The modified gen p mean: 0.4473421573638916, gen p mean: -0.21391375362873077, mean p set: 0.447918564081192
The modified gen p mean: 0.44610005617141724, gen p mean: -0.21216267347335815, mean p set: 0.44667407870292664
loss_pred:0.014797682873904705, decouple_loss:0.002856334438547492
loss_pred:0.016078943386673927, decouple_loss:0.0021963557228446007
Iteration: 2864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774988293647766, gen p mean: -0.20915475487709045, mean p set: 0.448323518037796
loss_pred:0.015657007694244385, decouple_loss:0.002870730124413967
The modified gen p mean: 0.4464000165462494, gen p mean: -0.20961908996105194, mean p set: 0.44692856073379517The modified gen p mean: 0.4466804265975952, gen p mean: -0.20940500497817993, mean p set: 0.44725537300109863
loss_pred:0.014906683005392551, decouple_loss:0.0023899360094219446
loss_pred:0.01516222395002842, decouple_loss:0.0022163146641105413
Iteration: 2865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447948694229126, gen p mean: -0.21026693284511566, mean p set: 0.448532372713089
loss_pred:0.01573006622493267, decouple_loss:0.002054559299722314
The modified gen p mean: 0.44789427518844604, gen p mean: -0.2110564410686493, mean p set: 0.4484235644340515The modified gen p mean: 0.4465985596179962, gen p mean: -0.21443918347358704, mean p set: 0.4471801817417145
loss_pred:0.015060747042298317, decouple_loss:0.002015935955569148loss_pred:0.015883833169937134, decouple_loss:0.002063519088551402
Iteration: 2866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44613024592399597, gen p mean: -0.20984797179698944, mean p set: 0.4467087388038635
loss_pred:0.015595032833516598, decouple_loss:0.0023221687879413366
The modified gen p mean: 0.4479319155216217, gen p mean: -0.21371911466121674, mean p set: 0.44851207733154297
loss_pred:0.014939089305698872, decouple_loss:0.002765420125797391
The modified gen p mean: 0.44591131806373596, gen p mean: -0.21339130401611328, mean p set: 0.44643494486808777
loss_pred:0.015292204916477203, decouple_loss:0.00240717432461679
Iteration: 2867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473007023334503, gen p mean: -0.21156539022922516, mean p set: 0.44787484407424927
loss_pred:0.015112494118511677, decouple_loss:0.002290015807375312
The modified gen p mean: 0.4459249973297119, gen p mean: -0.2169400453567505, mean p set: 0.4465000033378601
loss_pred:0.014912104234099388, decouple_loss:0.0022557873744517565
The modified gen p mean: 0.4483610987663269, gen p mean: -0.21550486981868744, mean p set: 0.44888943433761597
loss_pred:0.015371086075901985, decouple_loss:0.0022428727243095636
Iteration: 2868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461398422718048, gen p mean: -0.21580086648464203, mean p set: 0.44671353697776794
loss_pred:0.01550453994423151, decouple_loss:0.002328737173229456
The modified gen p mean: 0.44723331928253174, gen p mean: -0.22093448042869568, mean p set: 0.44775912165641785The modified gen p mean: 0.4474058151245117, gen p mean: -0.2183532863855362, mean p set: 0.4479850232601166
loss_pred:0.01553907711058855, decouple_loss:0.002455105073750019
loss_pred:0.015762291848659515, decouple_loss:0.0027043684385716915
Iteration: 2869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447521835565567, gen p mean: -0.22341585159301758, mean p set: 0.44809842109680176
loss_pred:0.015577325597405434, decouple_loss:0.0021957452408969402
The modified gen p mean: 0.44643688201904297, gen p mean: -0.21831543743610382, mean p set: 0.4470142424106598
loss_pred:0.015021578408777714, decouple_loss:0.0020593188237398863
The modified gen p mean: 0.4458741545677185, gen p mean: -0.22189876437187195, mean p set: 0.44640329480171204
loss_pred:0.01552698202431202, decouple_loss:0.00215272163040936
Iteration: 2870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475046992301941, gen p mean: -0.22011102735996246, mean p set: 0.44807806611061096
loss_pred:0.015556363388895988, decouple_loss:0.002212517661973834
The modified gen p mean: 0.44635435938835144, gen p mean: -0.2235090285539627, mean p set: 0.4469307065010071
loss_pred:0.016237972304224968, decouple_loss:0.0026313667185604572
The modified gen p mean: 0.4461921155452728, gen p mean: -0.22155798971652985, mean p set: 0.4467202425003052
loss_pred:0.015397381968796253, decouple_loss:0.0023534607607871294
2023-04-27 12:37:51 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22117117047309875, mean p set: 0.4499112665653229
loss_pred:0.016620950773358345, decouple_loss:0.002093363320454955
The modified gen p mean: 0.4493063986301422, gen p mean: -0.22139281034469604, mean p set: 0.4498290419578552
loss_pred:0.016182562336325645, decouple_loss:0.0021275896579027176
The modified gen p mean: 0.44822263717651367, gen p mean: -0.21873509883880615, mean p set: 0.44879910349845886
loss_pred:0.016575034707784653, decouple_loss:0.0021657024044543505
WV_1_PC_1_EH_0_PS_30, loss: 0.0165659599006176, avg_mse: 0.02460058405995369
current test mse: 0.024601
Iteration: 2871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731131196022034, gen p mean: -0.2196238785982132, mean p set: 0.44788745045661926
loss_pred:0.015523552894592285, decouple_loss:0.0019164690747857094
The modified gen p mean: 0.44579190015792847, gen p mean: -0.22621819376945496, mean p set: 0.44631776213645935
loss_pred:0.014893333427608013, decouple_loss:0.0020685361232608557
The modified gen p mean: 0.4453841745853424, gen p mean: -0.22571724653244019, mean p set: 0.44596222043037415
loss_pred:0.015097897499799728, decouple_loss:0.00213939743116498
Iteration: 2872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720643758773804, gen p mean: -0.21965283155441284, mean p set: 0.447732150554657
loss_pred:0.015202697366476059, decouple_loss:0.0023081880062818527
The modified gen p mean: 0.4463757276535034, gen p mean: -0.22296641767024994, mean p set: 0.44695183634757996
The modified gen p mean: 0.4468745291233063, gen p mean: -0.2148716002702713, mean p set: 0.44744786620140076
loss_pred:0.015283212997019291, decouple_loss:0.002070996444672346
loss_pred:0.015562177635729313, decouple_loss:0.0021863244473934174
Iteration: 2873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460265636444092, gen p mean: -0.21630865335464478, mean p set: 0.44655176997184753
loss_pred:0.015614577569067478, decouple_loss:0.0019371217349544168
The modified gen p mean: 0.4462276101112366, gen p mean: -0.2174888253211975, mean p set: 0.44679760932922363
The modified gen p mean: 0.4468802213668823, gen p mean: -0.21667668223381042, mean p set: 0.4474559724330902
loss_pred:0.015819314867258072, decouple_loss:0.002041248604655266
loss_pred:0.014859180897474289, decouple_loss:0.002126662526279688
Iteration: 2874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468504786491394, gen p mean: -0.21523599326610565, mean p set: 0.44737792015075684
loss_pred:0.01503304298967123, decouple_loss:0.002229281235486269
The modified gen p mean: 0.4464786946773529, gen p mean: -0.21728353202342987, mean p set: 0.4470498263835907
The modified gen p mean: 0.4466187357902527, gen p mean: -0.22038696706295013, mean p set: 0.4471932351589203
loss_pred:0.01456662267446518, decouple_loss:0.002154554007574916
loss_pred:0.015950627624988556, decouple_loss:0.0021359657403081656
Iteration: 2875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636204838752747, gen p mean: -0.21559038758277893, mean p set: 0.4469420909881592
loss_pred:0.01566852256655693, decouple_loss:0.002009306102991104
The modified gen p mean: 0.447407990694046, gen p mean: -0.21548737585544586, mean p set: 0.44799020886421204The modified gen p mean: 0.4479725956916809, gen p mean: -0.21627530455589294, mean p set: 0.4484979510307312
loss_pred:0.014887991361320019, decouple_loss:0.0020879104267805815
loss_pred:0.015687068924307823, decouple_loss:0.0022654125932604074
Iteration: 2876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709327816963196, gen p mean: -0.21649609506130219, mean p set: 0.44766902923583984
loss_pred:0.015203716233372688, decouple_loss:0.0020913423504680395
The modified gen p mean: 0.4460145831108093, gen p mean: -0.2180650383234024, mean p set: 0.44653645157814026The modified gen p mean: 0.4455096125602722, gen p mean: -0.2212732583284378, mean p set: 0.4460800588130951
loss_pred:0.01502242311835289, decouple_loss:0.0024761429522186518
loss_pred:0.01441548578441143, decouple_loss:0.0022413034457713366
Iteration: 2877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44573915004730225, gen p mean: -0.21464738249778748, mean p set: 0.4463140368461609
loss_pred:0.015055449679493904, decouple_loss:0.0022354829125106335
The modified gen p mean: 0.4457983076572418, gen p mean: -0.2177647203207016, mean p set: 0.4463808834552765The modified gen p mean: 0.4466089606285095, gen p mean: -0.21760696172714233, mean p set: 0.44713470339775085
loss_pred:0.015265427529811859, decouple_loss:0.001910845167003572
loss_pred:0.01561578270047903, decouple_loss:0.0020708765368908644
Iteration: 2878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476902186870575, gen p mean: -0.21913523972034454, mean p set: 0.4482622444629669
loss_pred:0.015512799844145775, decouple_loss:0.002250194549560547
The modified gen p mean: 0.4455866515636444, gen p mean: -0.2124619483947754, mean p set: 0.44616246223449707
loss_pred:0.015478470362722874, decouple_loss:0.002160464646294713
The modified gen p mean: 0.4476008117198944, gen p mean: -0.21497780084609985, mean p set: 0.44813206791877747
loss_pred:0.015354306437075138, decouple_loss:0.00210441742092371
Iteration: 2879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673582911491394, gen p mean: -0.21763697266578674, mean p set: 0.4473114311695099
loss_pred:0.014540904201567173, decouple_loss:0.002176053589209914
The modified gen p mean: 0.44653311371803284, gen p mean: -0.21640734374523163, mean p set: 0.447105348110199
loss_pred:0.015433699823915958, decouple_loss:0.0023425165563821793
The modified gen p mean: 0.44586876034736633, gen p mean: -0.2143390029668808, mean p set: 0.4464031159877777
loss_pred:0.014978879131376743, decouple_loss:0.0022812779061496258
Iteration: 2880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44611942768096924, gen p mean: -0.2135898917913437, mean p set: 0.44669607281684875
loss_pred:0.014752623625099659, decouple_loss:0.0021214340813457966
The modified gen p mean: 0.445704847574234, gen p mean: -0.21661844849586487, mean p set: 0.4462362825870514The modified gen p mean: 0.44519397616386414, gen p mean: -0.21817679703235626, mean p set: 0.4457741975784302
loss_pred:0.015012168325483799, decouple_loss:0.002110299887135625
loss_pred:0.014902489259839058, decouple_loss:0.002158486982807517
2023-04-27 12:41:15 testing...
The modified gen p mean: 0.44822248816490173, gen p mean: -0.2141103297472, mean p set: 0.44879910349845886
loss_pred:0.01656886376440525, decouple_loss:0.0024906282778829336
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2166827768087387, mean p set: 0.4499112665653229
loss_pred:0.016600029543042183, decouple_loss:0.002761651063337922
The modified gen p mean: 0.4493046998977661, gen p mean: -0.21713034808635712, mean p set: 0.4498290419578552
loss_pred:0.01621178537607193, decouple_loss:0.0023858309723436832
WV_1_PC_1_EH_0_PS_30, loss: 0.016587529331445694, avg_mse: 0.02451494336128235
current test mse: 0.024515
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 2881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476880729198456, gen p mean: -0.21669715642929077, mean p set: 0.44821614027023315
loss_pred:0.015005608089268208, decouple_loss:0.0031443177722394466
The modified gen p mean: 0.44847962260246277, gen p mean: -0.2140834629535675, mean p set: 0.44905948638916016
loss_pred:0.015229947865009308, decouple_loss:0.0028146051336079836
The modified gen p mean: 0.44766250252723694, gen p mean: -0.21374355256557465, mean p set: 0.44824254512786865
loss_pred:0.015346013940870762, decouple_loss:0.002517652465030551
Iteration: 2882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467886686325073, gen p mean: -0.21814870834350586, mean p set: 0.4473148286342621
loss_pred:0.014582058414816856, decouple_loss:0.002424533711746335
The modified gen p mean: 0.4470858871936798, gen p mean: -0.21495042741298676, mean p set: 0.4476613700389862
loss_pred:0.01465771347284317, decouple_loss:0.002431438770145178
The modified gen p mean: 0.44952550530433655, gen p mean: -0.21436141431331635, mean p set: 0.45010778307914734
loss_pred:0.014097759500145912, decouple_loss:0.002747344085946679
Iteration: 2883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485844373703003, gen p mean: -0.20861409604549408, mean p set: 0.4491148293018341
loss_pred:0.014618845656514168, decouple_loss:0.002490036189556122
The modified gen p mean: 0.447488933801651, gen p mean: -0.21059054136276245, mean p set: 0.4480615258216858
loss_pred:0.014178027398884296, decouple_loss:0.0021904916502535343
The modified gen p mean: 0.4478745758533478, gen p mean: -0.21059748530387878, mean p set: 0.44845467805862427
loss_pred:0.014006774872541428, decouple_loss:0.002398740965873003
Iteration: 2884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476487636566162, gen p mean: -0.21906395256519318, mean p set: 0.4481755197048187
loss_pred:0.014245904982089996, decouple_loss:0.002710432279855013
The modified gen p mean: 0.4480169415473938, gen p mean: -0.21885207295417786, mean p set: 0.4485950767993927
loss_pred:0.01448342576622963, decouple_loss:0.0024593358393758535
The modified gen p mean: 0.44722476601600647, gen p mean: -0.22120815515518188, mean p set: 0.44780364632606506
loss_pred:0.014745996333658695, decouple_loss:0.0024675652384757996
Iteration: 2885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470232129096985, gen p mean: -0.2107289433479309, mean p set: 0.4475933611392975
loss_pred:0.015003150328993797, decouple_loss:0.002128002466633916
The modified gen p mean: 0.44743475317955017, gen p mean: -0.2146790623664856, mean p set: 0.4480154812335968
loss_pred:0.014288539066910744, decouple_loss:0.002052953466773033
The modified gen p mean: 0.4473433494567871, gen p mean: -0.21128425002098083, mean p set: 0.4478708505630493
loss_pred:0.014127598144114017, decouple_loss:0.00201597111299634
Iteration: 2886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471057653427124, gen p mean: -0.21221596002578735, mean p set: 0.4476836025714874
loss_pred:0.013761128298938274, decouple_loss:0.002147881081327796
The modified gen p mean: 0.4477497935295105, gen p mean: -0.21241168677806854, mean p set: 0.4482842683792114The modified gen p mean: 0.44755926728248596, gen p mean: -0.21333207190036774, mean p set: 0.44813597202301025
loss_pred:0.014897629618644714, decouple_loss:0.002303976332768798
loss_pred:0.014940693974494934, decouple_loss:0.0021727830171585083
Iteration: 2887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801607728004456, gen p mean: -0.22049012780189514, mean p set: 0.44859078526496887
loss_pred:0.013950098305940628, decouple_loss:0.0022128894925117493
The modified gen p mean: 0.44730931520462036, gen p mean: -0.2180183380842209, mean p set: 0.44783204793930054The modified gen p mean: 0.44711124897003174, gen p mean: -0.21912109851837158, mean p set: 0.44768205285072327
loss_pred:0.015735797584056854, decouple_loss:0.0021779926028102636
loss_pred:0.014579087495803833, decouple_loss:0.0021077711135149
Iteration: 2888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472159147262573, gen p mean: -0.22455811500549316, mean p set: 0.4477936327457428
loss_pred:0.0141097791492939, decouple_loss:0.0023537003435194492
The modified gen p mean: 0.44759994745254517, gen p mean: -0.21979296207427979, mean p set: 0.44812917709350586The modified gen p mean: 0.44799530506134033, gen p mean: -0.21428282558918, mean p set: 0.44856393337249756
loss_pred:0.01512218825519085, decouple_loss:0.0021173502318561077
loss_pred:0.015120147727429867, decouple_loss:0.0021697317715734243
Iteration: 2889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806450605392456, gen p mean: -0.22300925850868225, mean p set: 0.4486410617828369
loss_pred:0.014231598004698753, decouple_loss:0.00203457148745656
The modified gen p mean: 0.44769996404647827, gen p mean: -0.21556319296360016, mean p set: 0.44822585582733154The modified gen p mean: 0.4470568299293518, gen p mean: -0.21913018822669983, mean p set: 0.4476364552974701
loss_pred:0.014882220886647701, decouple_loss:0.0022251999471336603
loss_pred:0.014688300900161266, decouple_loss:0.0022661846596747637
Iteration: 2890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784045219421387, gen p mean: -0.21675090491771698, mean p set: 0.44842052459716797
loss_pred:0.014405201189219952, decouple_loss:0.002142893383279443
The modified gen p mean: 0.4470391571521759, gen p mean: -0.2144950032234192, mean p set: 0.4476158618927002
loss_pred:0.01512480154633522, decouple_loss:0.0021719089709222317
The modified gen p mean: 0.44866329431533813, gen p mean: -0.21559740602970123, mean p set: 0.44918543100357056
loss_pred:0.014011682942509651, decouple_loss:0.002211681567132473
2023-04-27 12:45:17 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21675750613212585, mean p set: 0.4499112665653229
loss_pred:0.016654130071401596, decouple_loss:0.002281778957694769
The modified gen p mean: 0.44930195808410645, gen p mean: -0.21677927672863007, mean p set: 0.4498290419578552
loss_pred:0.016355255618691444, decouple_loss:0.0024139368906617165
The modified gen p mean: 0.44822028279304504, gen p mean: -0.21405844390392303, mean p set: 0.44879910349845886
loss_pred:0.016821755096316338, decouple_loss:0.002392477123066783
WV_1_PC_1_EH_0_PS_30, loss: 0.016728516668081284, avg_mse: 0.024774722754955292
current test mse: 0.024775
Iteration: 2891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484443664550781, gen p mean: -0.211687833070755, mean p set: 0.4490176737308502
loss_pred:0.014569702558219433, decouple_loss:0.002472017891705036
The modified gen p mean: 0.44736894965171814, gen p mean: -0.2130662351846695, mean p set: 0.4478912055492401
loss_pred:0.01534793060272932, decouple_loss:0.002056787023320794
The modified gen p mean: 0.44775357842445374, gen p mean: -0.21583276987075806, mean p set: 0.4483305513858795
loss_pred:0.015191287733614445, decouple_loss:0.002249805722385645
Iteration: 2892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773951172828674, gen p mean: -0.21482142806053162, mean p set: 0.4482676684856415
loss_pred:0.014512061141431332, decouple_loss:0.0023918813094496727
The modified gen p mean: 0.4475880563259125, gen p mean: -0.22246620059013367, mean p set: 0.44816869497299194
The modified gen p mean: 0.4478819966316223, gen p mean: -0.21948006749153137, mean p set: 0.44845813512802124
loss_pred:0.015012060292065144, decouple_loss:0.0019843755289912224
loss_pred:0.01393673662096262, decouple_loss:0.0020403368398547173
Iteration: 2893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478404223918915, gen p mean: -0.21463237702846527, mean p set: 0.4483700692653656
loss_pred:0.013908538036048412, decouple_loss:0.0022872372064739466
The modified gen p mean: 0.4473728537559509, gen p mean: -0.21205012500286102, mean p set: 0.4479523003101349
The modified gen p mean: 0.44794565439224243, gen p mean: -0.21407915651798248, mean p set: 0.4485217034816742
loss_pred:0.014863925985991955, decouple_loss:0.0022349408827722073
loss_pred:0.014377652667462826, decouple_loss:0.0022590395528823137
Iteration: 2894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470146894454956, gen p mean: -0.2227688729763031, mean p set: 0.44753962755203247
loss_pred:0.01445670798420906, decouple_loss:0.002466701902449131
The modified gen p mean: 0.44718030095100403, gen p mean: -0.21931537985801697, mean p set: 0.44775503873825073
The modified gen p mean: 0.44853878021240234, gen p mean: -0.21271240711212158, mean p set: 0.4491144120693207
loss_pred:0.014380531385540962, decouple_loss:0.002626841189339757
loss_pred:0.014620925299823284, decouple_loss:0.0022820772137492895
Iteration: 2895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740191102027893, gen p mean: -0.21359051764011383, mean p set: 0.44798195362091064
loss_pred:0.014291551895439625, decouple_loss:0.0024111936800181866
The modified gen p mean: 0.44806012511253357, gen p mean: -0.21719330549240112, mean p set: 0.44863179326057434The modified gen p mean: 0.4466395974159241, gen p mean: -0.21646200120449066, mean p set: 0.4471684396266937
loss_pred:0.013925314880907536, decouple_loss:0.0022219757083803415
loss_pred:0.014766003005206585, decouple_loss:0.002462064614519477
Iteration: 2896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489855170249939, gen p mean: -0.21330401301383972, mean p set: 0.4495594799518585
loss_pred:0.014182458631694317, decouple_loss:0.0024537493009120226
The modified gen p mean: 0.44675400853157043, gen p mean: -0.2198767215013504, mean p set: 0.4472792148590088The modified gen p mean: 0.4481947124004364, gen p mean: -0.21490249037742615, mean p set: 0.4487749934196472
loss_pred:0.014735445380210876, decouple_loss:0.0019614777993410826
loss_pred:0.014721128158271313, decouple_loss:0.002124457387253642
Iteration: 2897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474847912788391, gen p mean: -0.21934865415096283, mean p set: 0.44805845618247986
loss_pred:0.014440429396927357, decouple_loss:0.002207796787843108
The modified gen p mean: 0.4468533396720886, gen p mean: -0.22287139296531677, mean p set: 0.4473792016506195The modified gen p mean: 0.4469355046749115, gen p mean: -0.21491603553295135, mean p set: 0.4475088119506836
loss_pred:0.01464014407247305, decouple_loss:0.0020742062479257584
loss_pred:0.014515666291117668, decouple_loss:0.0019660121761262417
Iteration: 2898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938790798187256, gen p mean: -0.2097196727991104, mean p set: 0.4499603509902954
loss_pred:0.014170619659125805, decouple_loss:0.002269557910040021
The modified gen p mean: 0.446491539478302, gen p mean: -0.21439817547798157, mean p set: 0.44701725244522095The modified gen p mean: 0.4469529092311859, gen p mean: -0.21637295186519623, mean p set: 0.4475235044956207
loss_pred:0.01438969373703003, decouple_loss:0.002184433862566948
loss_pred:0.01467425748705864, decouple_loss:0.0025947829708456993
Iteration: 2899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759342074394226, gen p mean: -0.21764932572841644, mean p set: 0.4481693506240845
loss_pred:0.014111471362411976, decouple_loss:0.002085351850837469
The modified gen p mean: 0.448777437210083, gen p mean: -0.22062066197395325, mean p set: 0.449308842420578
The modified gen p mean: 0.44803017377853394, gen p mean: -0.214340940117836, mean p set: 0.44860655069351196
loss_pred:0.013909765519201756, decouple_loss:0.0019792497623711824
loss_pred:0.01365649327635765, decouple_loss:0.0020262470934540033
Iteration: 2900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779741764068604, gen p mean: -0.2173411250114441, mean p set: 0.44836780428886414
loss_pred:0.015578973107039928, decouple_loss:0.0022059003822505474
The modified gen p mean: 0.4489987790584564, gen p mean: -0.20972076058387756, mean p set: 0.4495725929737091
loss_pred:0.014313203282654285, decouple_loss:0.002284118440002203
The modified gen p mean: 0.44761812686920166, gen p mean: -0.21342629194259644, mean p set: 0.44814783334732056
loss_pred:0.014230065979063511, decouple_loss:0.002422053599730134
2023-04-27 12:48:41 testing...
The modified gen p mean: 0.44822707772254944, gen p mean: -0.21566113829612732, mean p set: 0.44879910349845886
loss_pred:0.01676018163561821, decouple_loss:0.00246930168941617
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2185656875371933, mean p set: 0.4499112665653229
loss_pred:0.016715098172426224, decouple_loss:0.0026865017134696245
The modified gen p mean: 0.44929948449134827, gen p mean: -0.21837326884269714, mean p set: 0.4498290419578552
loss_pred:0.01633036695420742, decouple_loss:0.002583015477284789
WV_1_PC_1_EH_0_PS_30, loss: 0.016730863600969315, avg_mse: 0.024840734899044037
current test mse: 0.024841
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 2901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475545287132263, gen p mean: -0.2199936807155609, mean p set: 0.4480784237384796
loss_pred:0.015629030764102936, decouple_loss:0.0021659473422914743
The modified gen p mean: 0.447435587644577, gen p mean: -0.22006943821907043, mean p set: 0.4480117857456207
loss_pred:0.014941970817744732, decouple_loss:0.002101388992741704
The modified gen p mean: 0.447521448135376, gen p mean: -0.22351843118667603, mean p set: 0.44810163974761963
loss_pred:0.01492649968713522, decouple_loss:0.002408804837614298
Iteration: 2902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486505389213562, gen p mean: -0.22143657505512238, mean p set: 0.44917547702789307
loss_pred:0.014946150593459606, decouple_loss:0.0020655153784900904
The modified gen p mean: 0.4471701383590698, gen p mean: -0.21678057312965393, mean p set: 0.44773876667022705
loss_pred:0.015309980139136314, decouple_loss:0.0018295266199856997
The modified gen p mean: 0.4493522047996521, gen p mean: -0.2164960354566574, mean p set: 0.4499293565750122
loss_pred:0.015153184533119202, decouple_loss:0.0021779914386570454
Iteration: 2903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477754831314087, gen p mean: -0.217163547873497, mean p set: 0.44830194115638733
loss_pred:0.01526239700615406, decouple_loss:0.0020390565041452646
The modified gen p mean: 0.4489096701145172, gen p mean: -0.2113129198551178, mean p set: 0.449482798576355
loss_pred:0.015066888183355331, decouple_loss:0.002162968972697854
The modified gen p mean: 0.44875624775886536, gen p mean: -0.2094803750514984, mean p set: 0.44933751225471497
loss_pred:0.015001023188233376, decouple_loss:0.0022213065531104803
Iteration: 2904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477822184562683, gen p mean: -0.2186145931482315, mean p set: 0.4483141601085663
loss_pred:0.014883163385093212, decouple_loss:0.0021798890084028244
The modified gen p mean: 0.44672852754592896, gen p mean: -0.21586497128009796, mean p set: 0.44730639457702637
loss_pred:0.015003345906734467, decouple_loss:0.0020081503316760063
The modified gen p mean: 0.44883620738983154, gen p mean: -0.21909700334072113, mean p set: 0.4494136571884155
loss_pred:0.014294838532805443, decouple_loss:0.002123960992321372
Iteration: 2905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855087995529175, gen p mean: -0.22083377838134766, mean p set: 0.4491303265094757
loss_pred:0.014605257660150528, decouple_loss:0.0021594136487692595
The modified gen p mean: 0.4481341242790222, gen p mean: -0.21570119261741638, mean p set: 0.4487088918685913The modified gen p mean: 0.44936689734458923, gen p mean: -0.2210802435874939, mean p set: 0.449893593788147
loss_pred:0.014300285838544369, decouple_loss:0.0022044407669454813
loss_pred:0.014873964712023735, decouple_loss:0.002101510763168335
Iteration: 2906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865882396698, gen p mean: -0.21292778849601746, mean p set: 0.4492361843585968
loss_pred:0.014183122664690018, decouple_loss:0.002131736371666193
The modified gen p mean: 0.4480327069759369, gen p mean: -0.20867665112018585, mean p set: 0.4485621154308319The modified gen p mean: 0.4482828676700592, gen p mean: -0.21335941553115845, mean p set: 0.4488604962825775
loss_pred:0.014226765371859074, decouple_loss:0.0021289244759827852
loss_pred:0.014648156240582466, decouple_loss:0.0020755757577717304
Iteration: 2907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491141736507416, gen p mean: -0.22216399013996124, mean p set: 0.4496924579143524
loss_pred:0.014559835195541382, decouple_loss:0.0023614829406142235
The modified gen p mean: 0.4484451413154602, gen p mean: -0.22197020053863525, mean p set: 0.44901934266090393The modified gen p mean: 0.4479639530181885, gen p mean: -0.22057293355464935, mean p set: 0.4484889805316925
loss_pred:0.01439193356782198, decouple_loss:0.0020584617741405964
loss_pred:0.015074076130986214, decouple_loss:0.0020768705289810896
Iteration: 2908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473116397857666, gen p mean: -0.22114232182502747, mean p set: 0.44789305329322815
loss_pred:0.015315641649067402, decouple_loss:0.0020417720079421997
The modified gen p mean: 0.44761329889297485, gen p mean: -0.2218399941921234, mean p set: 0.4481314718723297The modified gen p mean: 0.4480420649051666, gen p mean: -0.22070005536079407, mean p set: 0.4486178159713745
loss_pred:0.014964248985052109, decouple_loss:0.001964250346645713
loss_pred:0.015799537301063538, decouple_loss:0.001962937181815505
Iteration: 2909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851958751678467, gen p mean: -0.22228460013866425, mean p set: 0.44909700751304626
loss_pred:0.014165450818836689, decouple_loss:0.0027232232969254255
The modified gen p mean: 0.4497026205062866, gen p mean: -0.22240467369556427, mean p set: 0.4502778649330139
loss_pred:0.015550969168543816, decouple_loss:0.002319360850378871
The modified gen p mean: 0.4478292465209961, gen p mean: -0.22553236782550812, mean p set: 0.44836267828941345
loss_pred:0.015331686474382877, decouple_loss:0.002297511789947748
Iteration: 2910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474361836910248, gen p mean: -0.22117604315280914, mean p set: 0.44801095128059387
loss_pred:0.015123303048312664, decouple_loss:0.002063739812001586
The modified gen p mean: 0.44883882999420166, gen p mean: -0.2252943068742752, mean p set: 0.44941920042037964The modified gen p mean: 0.4497891366481781, gen p mean: -0.22013558447360992, mean p set: 0.45032650232315063
loss_pred:0.015173204243183136, decouple_loss:0.0021536648273468018
loss_pred:0.014838890172541142, decouple_loss:0.0020873022731393576
2023-04-27 12:52:47 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21909059584140778, mean p set: 0.4499112665653229
loss_pred:0.01664327271282673, decouple_loss:0.0021310013253241777
The modified gen p mean: 0.4493028223514557, gen p mean: -0.21911540627479553, mean p set: 0.4498290419578552
loss_pred:0.016222795471549034, decouple_loss:0.002286032075062394
The modified gen p mean: 0.44822150468826294, gen p mean: -0.21592555940151215, mean p set: 0.44879910349845886
loss_pred:0.016626834869384766, decouple_loss:0.00229643820784986
WV_1_PC_1_EH_0_PS_30, loss: 0.016609525308012962, avg_mse: 0.024673838168382645
current test mse: 0.024674
Iteration: 2911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483017325401306, gen p mean: -0.22068968415260315, mean p set: 0.44887539744377136
loss_pred:0.014763067476451397, decouple_loss:0.002265033544972539
The modified gen p mean: 0.44881072640419006, gen p mean: -0.223403200507164, mean p set: 0.44933804869651794
loss_pred:0.014041888527572155, decouple_loss:0.0019991183653473854
The modified gen p mean: 0.4480237662792206, gen p mean: -0.21873416006565094, mean p set: 0.4485989212989807
loss_pred:0.01551064196974039, decouple_loss:0.002206900157034397
Iteration: 2912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479498565196991, gen p mean: -0.21791113913059235, mean p set: 0.44847777485847473
loss_pred:0.015599622391164303, decouple_loss:0.002355975564569235
The modified gen p mean: 0.44710132479667664, gen p mean: -0.21726401150226593, mean p set: 0.44768157601356506
The modified gen p mean: 0.44879433512687683, gen p mean: -0.21523329615592957, mean p set: 0.4493674635887146
loss_pred:0.015149753540754318, decouple_loss:0.002237052656710148
loss_pred:0.014720089733600616, decouple_loss:0.0025813281536102295
Iteration: 2913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486227035522461, gen p mean: -0.21080519258975983, mean p set: 0.4491572082042694
loss_pred:0.014207666739821434, decouple_loss:0.002405802719295025
The modified gen p mean: 0.44922512769699097, gen p mean: -0.22263135015964508, mean p set: 0.4497983753681183
The modified gen p mean: 0.4470386803150177, gen p mean: -0.21610789000988007, mean p set: 0.44762104749679565
loss_pred:0.015039254911243916, decouple_loss:0.002279261825606227
loss_pred:0.015218122862279415, decouple_loss:0.0021334916818886995
Iteration: 2914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484156370162964, gen p mean: -0.21758683025836945, mean p set: 0.448948472738266
loss_pred:0.015361710451543331, decouple_loss:0.002136466559022665
The modified gen p mean: 0.44828373193740845, gen p mean: -0.21976454555988312, mean p set: 0.4488602578639984
The modified gen p mean: 0.4482630491256714, gen p mean: -0.21436014771461487, mean p set: 0.44884148240089417
loss_pred:0.014761030673980713, decouple_loss:0.002241282258182764
loss_pred:0.014129783026874065, decouple_loss:0.0021823446732014418
Iteration: 2915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760861992836, gen p mean: -0.2163998931646347, mean p set: 0.4481810927391052
loss_pred:0.01573534868657589, decouple_loss:0.0021729215513914824
The modified gen p mean: 0.4477827250957489, gen p mean: -0.22057794034481049, mean p set: 0.44836223125457764The modified gen p mean: 0.44923990964889526, gen p mean: -0.2227736860513687, mean p set: 0.4497707486152649
loss_pred:0.015357732772827148, decouple_loss:0.002246321178972721
loss_pred:0.014615759253501892, decouple_loss:0.0020268033258616924
Iteration: 2916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746923446655273, gen p mean: -0.20727887749671936, mean p set: 0.44804272055625916
loss_pred:0.014451326802372932, decouple_loss:0.0027374345809221268
The modified gen p mean: 0.4494032561779022, gen p mean: -0.22588799893856049, mean p set: 0.4499812126159668The modified gen p mean: 0.44778066873550415, gen p mean: -0.22084470093250275, mean p set: 0.4483092129230499
loss_pred:0.014615668915212154, decouple_loss:0.002400308381766081
loss_pred:0.014845785684883595, decouple_loss:0.0023859646171331406
Iteration: 2917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931814074516296, gen p mean: -0.21850964426994324, mean p set: 0.449893057346344
loss_pred:0.014567178674042225, decouple_loss:0.0020649610087275505
The modified gen p mean: 0.44717901945114136, gen p mean: -0.21840904653072357, mean p set: 0.4477550983428955The modified gen p mean: 0.4487163722515106, gen p mean: -0.21759964525699615, mean p set: 0.4492538273334503
loss_pred:0.014895899221301079, decouple_loss:0.0025606269482523203
loss_pred:0.015019181184470654, decouple_loss:0.002302655251696706
Iteration: 2918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890737533569336, gen p mean: -0.22215789556503296, mean p set: 0.44948384165763855
loss_pred:0.015129278413951397, decouple_loss:0.002211604965850711
The modified gen p mean: 0.4481253921985626, gen p mean: -0.20802080631256104, mean p set: 0.44870755076408386
loss_pred:0.014013243839144707, decouple_loss:0.0022556032054126263
The modified gen p mean: 0.4487858712673187, gen p mean: -0.22223339974880219, mean p set: 0.449317067861557
loss_pred:0.014298098161816597, decouple_loss:0.0022354985121637583
Iteration: 2919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449508398771286, gen p mean: -0.21361127495765686, mean p set: 0.45008060336112976
loss_pred:0.014525964856147766, decouple_loss:0.0023877762723714113
The modified gen p mean: 0.44854241609573364, gen p mean: -0.22134122252464294, mean p set: 0.44912344217300415
loss_pred:0.013598412275314331, decouple_loss:0.00221837661229074
The modified gen p mean: 0.4484846591949463, gen p mean: -0.22083961963653564, mean p set: 0.44901350140571594
loss_pred:0.014757595025002956, decouple_loss:0.0022492322605103254
Iteration: 2920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786134362220764, gen p mean: -0.2224462926387787, mean p set: 0.4484424889087677
loss_pred:0.015086132101714611, decouple_loss:0.001927535398863256
The modified gen p mean: 0.4470938444137573, gen p mean: -0.2187051773071289, mean p set: 0.44766971468925476
loss_pred:0.015287317335605621, decouple_loss:0.0022089576814323664
The modified gen p mean: 0.4486747682094574, gen p mean: -0.22183582186698914, mean p set: 0.4492034912109375
loss_pred:0.014875924214720726, decouple_loss:0.002085290849208832
2023-04-27 12:56:12 testing...
The modified gen p mean: 0.44822630286216736, gen p mean: -0.2161761224269867, mean p set: 0.44879910349845886
loss_pred:0.016637397930026054, decouple_loss:0.0021072279196232557
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2195964753627777, mean p set: 0.4499112665653229
loss_pred:0.01659528538584709, decouple_loss:0.002281612018123269
The modified gen p mean: 0.44930729269981384, gen p mean: -0.21929669380187988, mean p set: 0.4498290419578552
loss_pred:0.016196152195334435, decouple_loss:0.0022947490215301514
WV_1_PC_1_EH_0_PS_30, loss: 0.016587672755122185, avg_mse: 0.024642109870910645
current test mse: 0.024642
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 2921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479335844516754, gen p mean: -0.21471551060676575, mean p set: 0.44846025109291077
loss_pred:0.014821077696979046, decouple_loss:0.002163378521800041
The modified gen p mean: 0.4478224515914917, gen p mean: -0.21952205896377563, mean p set: 0.4483965039253235
loss_pred:0.014796585775911808, decouple_loss:0.0020247322972863913
The modified gen p mean: 0.44769299030303955, gen p mean: -0.21496842801570892, mean p set: 0.44827526807785034
loss_pred:0.015015856362879276, decouple_loss:0.0019144186517223716
Iteration: 2922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733887910842896, gen p mean: -0.2180233746767044, mean p set: 0.4478660821914673
loss_pred:0.014685171656310558, decouple_loss:0.0019356929697096348
The modified gen p mean: 0.44752636551856995, gen p mean: -0.22788657248020172, mean p set: 0.4481002688407898
The modified gen p mean: 0.4475591480731964, gen p mean: -0.21515397727489471, mean p set: 0.44813862442970276
loss_pred:0.015162843279540539, decouple_loss:0.0020741764456033707
loss_pred:0.015183641575276852, decouple_loss:0.0018966509960591793
Iteration: 2923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471159875392914, gen p mean: -0.2191983461380005, mean p set: 0.4476391673088074
loss_pred:0.014590408653020859, decouple_loss:0.0024080302100628614
The modified gen p mean: 0.44785213470458984, gen p mean: -0.2177274525165558, mean p set: 0.4484281837940216
The modified gen p mean: 0.4471059739589691, gen p mean: -0.21411190927028656, mean p set: 0.4476827085018158
loss_pred:0.015578263439238071, decouple_loss:0.0020799138583242893
loss_pred:0.01482493244111538, decouple_loss:0.002177502727136016
Iteration: 2924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490773677825928, gen p mean: -0.21436788141727448, mean p set: 0.4496593773365021
loss_pred:0.014006988145411015, decouple_loss:0.002015438163653016
The modified gen p mean: 0.4479786455631256, gen p mean: -0.21277378499507904, mean p set: 0.44850608706474304The modified gen p mean: 0.4475829303264618, gen p mean: -0.21764051914215088, mean p set: 0.44815701246261597
loss_pred:0.014056213200092316, decouple_loss:0.0019202976254746318
loss_pred:0.01472074817866087, decouple_loss:0.0019862037152051926
Iteration: 2925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479483962059021, gen p mean: -0.21137115359306335, mean p set: 0.4485248327255249
loss_pred:0.014763797633349895, decouple_loss:0.001954185077920556
The modified gen p mean: 0.448228120803833, gen p mean: -0.2114177644252777, mean p set: 0.4488039016723633
loss_pred:0.013788229785859585, decouple_loss:0.001935659209266305
The modified gen p mean: 0.44851866364479065, gen p mean: -0.22246958315372467, mean p set: 0.44905540347099304
loss_pred:0.014685246162116528, decouple_loss:0.0022543082013726234
Iteration: 2926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841650128364563, gen p mean: -0.2161063700914383, mean p set: 0.4489942789077759
loss_pred:0.01420568861067295, decouple_loss:0.0021451530046761036
The modified gen p mean: 0.4468837082386017, gen p mean: -0.21344918012619019, mean p set: 0.44740498065948486The modified gen p mean: 0.44764989614486694, gen p mean: -0.21108819544315338, mean p set: 0.4482302665710449
loss_pred:0.014302544295787811, decouple_loss:0.0019555571489036083
loss_pred:0.014941230416297913, decouple_loss:0.0019144773250445724
Iteration: 2927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837626814842224, gen p mean: -0.21358801424503326, mean p set: 0.44895458221435547
loss_pred:0.01420467346906662, decouple_loss:0.0020206840708851814
The modified gen p mean: 0.4465092420578003, gen p mean: -0.20955133438110352, mean p set: 0.4470857083797455
loss_pred:0.015258392319083214, decouple_loss:0.0019465942168608308
The modified gen p mean: 0.44788262248039246, gen p mean: -0.2160491943359375, mean p set: 0.44841110706329346
loss_pred:0.015363918617367744, decouple_loss:0.00195207423530519
Iteration: 2928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483020305633545, gen p mean: -0.21374088525772095, mean p set: 0.448875367641449
loss_pred:0.014654690399765968, decouple_loss:0.0019052160205319524
The modified gen p mean: 0.44681549072265625, gen p mean: -0.22178304195404053, mean p set: 0.4473487436771393
The modified gen p mean: 0.44938164949417114, gen p mean: -0.21492885053157806, mean p set: 0.4499613046646118
loss_pred:0.014224662445485592, decouple_loss:0.0019336731638759375
loss_pred:0.015041723847389221, decouple_loss:0.0021300525404512882
Iteration: 2929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468193054199219, gen p mean: -0.21463626623153687, mean p set: 0.4473954439163208
loss_pred:0.015164120122790337, decouple_loss:0.002082338323816657
The modified gen p mean: 0.4474812150001526, gen p mean: -0.21116185188293457, mean p set: 0.4480552673339844
loss_pred:0.0143680265173316, decouple_loss:0.002071749186143279
The modified gen p mean: 0.44823887944221497, gen p mean: -0.2110408991575241, mean p set: 0.44876906275749207
loss_pred:0.013886621221899986, decouple_loss:0.0020984401926398277
Iteration: 2930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467763602733612, gen p mean: -0.21453207731246948, mean p set: 0.44735386967658997
loss_pred:0.015041396953165531, decouple_loss:0.002028515562415123
The modified gen p mean: 0.4476551413536072, gen p mean: -0.21408019959926605, mean p set: 0.4482366442680359
loss_pred:0.014180079102516174, decouple_loss:0.0019475873559713364
The modified gen p mean: 0.44776850938796997, gen p mean: -0.21281515061855316, mean p set: 0.44829997420310974
loss_pred:0.014941706322133541, decouple_loss:0.0023160423152148724
2023-04-27 13:00:20 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21535050868988037, mean p set: 0.4499112665653229
loss_pred:0.016663704067468643, decouple_loss:0.002264759736135602
The modified gen p mean: 0.4492989480495453, gen p mean: -0.21509535610675812, mean p set: 0.4498290419578552
loss_pred:0.016216738149523735, decouple_loss:0.0022109895944595337
The modified gen p mean: 0.44821974635124207, gen p mean: -0.21178372204303741, mean p set: 0.44879910349845886
loss_pred:0.016658293083310127, decouple_loss:0.0021098575089126825
WV_1_PC_1_EH_0_PS_30, loss: 0.016622673720121384, avg_mse: 0.02465062215924263
current test mse: 0.024651
Iteration: 2931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489077925682068, gen p mean: -0.21273675560951233, mean p set: 0.449484258890152
loss_pred:0.014595392160117626, decouple_loss:0.0020540845580399036
The modified gen p mean: 0.4479389786720276, gen p mean: -0.21541890501976013, mean p set: 0.44846752285957336
loss_pred:0.014200507663190365, decouple_loss:0.0018397258827462792
The modified gen p mean: 0.4473415017127991, gen p mean: -0.21798774600028992, mean p set: 0.44791606068611145
loss_pred:0.014638950116932392, decouple_loss:0.0018218238838016987
Iteration: 2932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480609893798828, gen p mean: -0.21431681513786316, mean p set: 0.44859424233436584
loss_pred:0.01478356309235096, decouple_loss:0.0023910298477858305
The modified gen p mean: 0.4478811025619507, gen p mean: -0.2153424471616745, mean p set: 0.4484524726867676
The modified gen p mean: 0.44816499948501587, gen p mean: -0.2119922935962677, mean p set: 0.44874149560928345
loss_pred:0.01481782179325819, decouple_loss:0.0023644084576517344
loss_pred:0.01411503553390503, decouple_loss:0.002247705589979887
Iteration: 2933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830483198165894, gen p mean: -0.21335598826408386, mean p set: 0.4488346576690674
loss_pred:0.014571831561625004, decouple_loss:0.0021129956003278494
The modified gen p mean: 0.44753149151802063, gen p mean: -0.21385201811790466, mean p set: 0.44810861349105835
The modified gen p mean: 0.44833824038505554, gen p mean: -0.21587532758712769, mean p set: 0.4489155113697052
loss_pred:0.014330428093671799, decouple_loss:0.001984576229006052
loss_pred:0.01448491495102644, decouple_loss:0.0020181164145469666
Iteration: 2934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44638946652412415, gen p mean: -0.21935486793518066, mean p set: 0.44691917300224304
loss_pred:0.015165257267653942, decouple_loss:0.0019351227674633265
The modified gen p mean: 0.4480627179145813, gen p mean: -0.21269403398036957, mean p set: 0.4486396908760071
The modified gen p mean: 0.4463590979576111, gen p mean: -0.213355153799057, mean p set: 0.44693389534950256
loss_pred:0.014857121743261814, decouple_loss:0.0020054487977176905
loss_pred:0.014912259764969349, decouple_loss:0.0019041026243939996
Iteration: 2935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488927125930786, gen p mean: -0.2107677459716797, mean p set: 0.4494676887989044
loss_pred:0.01445714384317398, decouple_loss:0.002087429165840149
The modified gen p mean: 0.44663769006729126, gen p mean: -0.21417394280433655, mean p set: 0.44716405868530273The modified gen p mean: 0.4470345973968506, gen p mean: -0.21329018473625183, mean p set: 0.44761136174201965
loss_pred:0.014651172794401646, decouple_loss:0.0019055962329730392
loss_pred:0.014838616363704205, decouple_loss:0.001941496622748673
Iteration: 2936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468829035758972, gen p mean: -0.2078876495361328, mean p set: 0.4474572539329529
loss_pred:0.014370562508702278, decouple_loss:0.0021578441374003887
The modified gen p mean: 0.446807861328125, gen p mean: -0.20508629083633423, mean p set: 0.44738268852233887
loss_pred:0.015055621974170208, decouple_loss:0.002254875609651208
The modified gen p mean: 0.44721871614456177, gen p mean: -0.2090907096862793, mean p set: 0.447747141122818
loss_pred:0.01485904585570097, decouple_loss:0.001993482932448387
Iteration: 2937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968128204345703, gen p mean: -0.21398460865020752, mean p set: 0.45025789737701416
loss_pred:0.013960552401840687, decouple_loss:0.0019958766642957926
The modified gen p mean: 0.447268545627594, gen p mean: -0.21275438368320465, mean p set: 0.4478446841239929The modified gen p mean: 0.4461272060871124, gen p mean: -0.21086379885673523, mean p set: 0.44665467739105225
loss_pred:0.015050971880555153, decouple_loss:0.0018093729158863425
loss_pred:0.015421482734382153, decouple_loss:0.001809318084269762
Iteration: 2938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471730589866638, gen p mean: -0.2141629457473755, mean p set: 0.4477500915527344
loss_pred:0.014392481185495853, decouple_loss:0.0021316262427717447
The modified gen p mean: 0.44768697023391724, gen p mean: -0.21745480597019196, mean p set: 0.44826218485832214The modified gen p mean: 0.44746488332748413, gen p mean: -0.21786220371723175, mean p set: 0.4479939937591553
loss_pred:0.01430464256554842, decouple_loss:0.0021494748070836067
loss_pred:0.014518770389258862, decouple_loss:0.0021003081928938627
Iteration: 2939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925349950790405, gen p mean: -0.21322746574878693, mean p set: 0.4498293101787567
loss_pred:0.014650066383183002, decouple_loss:0.0022021224722266197
The modified gen p mean: 0.44785305857658386, gen p mean: -0.21674571931362152, mean p set: 0.4483831226825714The modified gen p mean: 0.4481133222579956, gen p mean: -0.21636690199375153, mean p set: 0.4486897885799408
loss_pred:0.014360940083861351, decouple_loss:0.0020134972874075174
loss_pred:0.014220823533833027, decouple_loss:0.0020390856079757214
Iteration: 2940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801101088523865, gen p mean: -0.21262118220329285, mean p set: 0.4485850930213928
loss_pred:0.01408416498452425, decouple_loss:0.0020180349238216877
The modified gen p mean: 0.4485792815685272, gen p mean: -0.21394899487495422, mean p set: 0.4491024613380432The modified gen p mean: 0.4466869533061981, gen p mean: -0.21654090285301208, mean p set: 0.4472673535346985
loss_pred:0.015117280185222626, decouple_loss:0.0019183479016646743
loss_pred:0.01400185190141201, decouple_loss:0.0020277858711779118
2023-04-27 13:03:44 testing...
The modified gen p mean: 0.44821953773498535, gen p mean: -0.21159689128398895, mean p set: 0.44879910349845886
loss_pred:0.01644202321767807, decouple_loss:0.0022694638464599848
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2146873027086258, mean p set: 0.4499112665653229
loss_pred:0.01652202010154724, decouple_loss:0.0023965954314917326
The modified gen p mean: 0.4493018090724945, gen p mean: -0.21488739550113678, mean p set: 0.4498290419578552
loss_pred:0.01605989597737789, decouple_loss:0.0024062730371952057
WV_1_PC_1_EH_0_PS_30, loss: 0.016459185630083084, avg_mse: 0.024462588131427765
current test mse: 0.024463
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 2941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497484266757965, gen p mean: -0.21257486939430237, mean p set: 0.4502823054790497
loss_pred:0.0159467626363039, decouple_loss:0.00231666537001729
The modified gen p mean: 0.4490378201007843, gen p mean: -0.21469363570213318, mean p set: 0.4496159553527832
loss_pred:0.016010571271181107, decouple_loss:0.0021510939113795757
The modified gen p mean: 0.45024609565734863, gen p mean: -0.21460342407226562, mean p set: 0.4508230984210968
loss_pred:0.0161710437387228, decouple_loss:0.0022737167309969664
Iteration: 2942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498889446258545, gen p mean: -0.208395317196846, mean p set: 0.4504148066043854
loss_pred:0.016571369022130966, decouple_loss:0.002013259567320347
The modified gen p mean: 0.45016172528266907, gen p mean: -0.21420800685882568, mean p set: 0.45073747634887695
loss_pred:0.01674329675734043, decouple_loss:0.002211920451372862
The modified gen p mean: 0.4492610692977905, gen p mean: -0.2113119214773178, mean p set: 0.4498342275619507
loss_pred:0.015810944139957428, decouple_loss:0.0019466853700578213
Iteration: 2943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009645819664, gen p mean: -0.21223542094230652, mean p set: 0.45062586665153503
loss_pred:0.01623847335577011, decouple_loss:0.0019485895754769444
The modified gen p mean: 0.450051486492157, gen p mean: -0.20956295728683472, mean p set: 0.4506319463253021
loss_pred:0.015775159001350403, decouple_loss:0.0021248627454042435
The modified gen p mean: 0.4506770968437195, gen p mean: -0.2122294306755066, mean p set: 0.4512575566768646
loss_pred:0.01601817086338997, decouple_loss:0.001945042167790234
Iteration: 2944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496458172798157, gen p mean: -0.2111995667219162, mean p set: 0.45017993450164795
loss_pred:0.0161674153059721, decouple_loss:0.0021946674678474665
The modified gen p mean: 0.44812074303627014, gen p mean: -0.20825965702533722, mean p set: 0.4486955404281616
loss_pred:0.016233567148447037, decouple_loss:0.002081420039758086
The modified gen p mean: 0.4490106403827667, gen p mean: -0.2083953619003296, mean p set: 0.4495888352394104
loss_pred:0.015934087336063385, decouple_loss:0.0018974271370097995
Iteration: 2945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494936168193817, gen p mean: -0.21180811524391174, mean p set: 0.45006564259529114
loss_pred:0.015922045335173607, decouple_loss:0.00200580689124763
The modified gen p mean: 0.4490029215812683, gen p mean: -0.21401885151863098, mean p set: 0.44952836632728577The modified gen p mean: 0.4488091468811035, gen p mean: -0.21239836513996124, mean p set: 0.4493815302848816
loss_pred:0.015581932850182056, decouple_loss:0.002095623407512903loss_pred:0.01631435938179493, decouple_loss:0.002066749846562743
Iteration: 2946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979119300842285, gen p mean: -0.21463793516159058, mean p set: 0.45036831498146057
loss_pred:0.01561127882450819, decouple_loss:0.0021230143029242754
The modified gen p mean: 0.4492335021495819, gen p mean: -0.2164042741060257, mean p set: 0.4498143792152405The modified gen p mean: 0.4506396949291229, gen p mean: -0.2148861140012741, mean p set: 0.45116761326789856
loss_pred:0.01601199246942997, decouple_loss:0.0019068135879933834
loss_pred:0.016337189823389053, decouple_loss:0.0023464758414775133
Iteration: 2947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485118091106415, gen p mean: -0.21595154702663422, mean p set: 0.4490925073623657
loss_pred:0.016418101266026497, decouple_loss:0.0020218335557729006
The modified gen p mean: 0.44927772879600525, gen p mean: -0.21943533420562744, mean p set: 0.4498046338558197The modified gen p mean: 0.44861868023872375, gen p mean: -0.22262315452098846, mean p set: 0.4491928219795227
loss_pred:0.015752868726849556, decouple_loss:0.0020378022454679012
loss_pred:0.016356945037841797, decouple_loss:0.0020887667778879404
Iteration: 2948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925516843795776, gen p mean: -0.21917378902435303, mean p set: 0.4498307406902313
loss_pred:0.01544085331261158, decouple_loss:0.002214546548202634
The modified gen p mean: 0.4499838352203369, gen p mean: -0.2209359109401703, mean p set: 0.45056453347206116
loss_pred:0.016419872641563416, decouple_loss:0.002188843209296465
The modified gen p mean: 0.45008817315101624, gen p mean: -0.22171913087368011, mean p set: 0.4506154954433441
loss_pred:0.01609853468835354, decouple_loss:0.0021983073092997074
Iteration: 2949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44980940222740173, gen p mean: -0.21966387331485748, mean p set: 0.45038241147994995
loss_pred:0.015636397525668144, decouple_loss:0.002065857406705618
The modified gen p mean: 0.4505511224269867, gen p mean: -0.21642400324344635, mean p set: 0.4510757029056549The modified gen p mean: 0.4485856294631958, gen p mean: -0.2190377414226532, mean p set: 0.4491656422615051
loss_pred:0.015797585248947144, decouple_loss:0.002073989948257804
loss_pred:0.016346635296940804, decouple_loss:0.0020170812495052814
Iteration: 2950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495556950569153, gen p mean: -0.21803000569343567, mean p set: 0.450135201215744
loss_pred:0.015164647251367569, decouple_loss:0.002104391809552908
The modified gen p mean: 0.4495558440685272, gen p mean: -0.22396863996982574, mean p set: 0.4501415491104126
loss_pred:0.015723958611488342, decouple_loss:0.002409195527434349
The modified gen p mean: 0.4497296214103699, gen p mean: -0.21673856675624847, mean p set: 0.4502556622028351
loss_pred:0.016033602878451347, decouple_loss:0.002324998378753662
2023-04-27 13:08:03 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2199634313583374, mean p set: 0.4499112665653229
loss_pred:0.015711981803178787, decouple_loss:0.002220007823780179
The modified gen p mean: 0.44930049777030945, gen p mean: -0.22036616504192352, mean p set: 0.4498290419578552
loss_pred:0.015258005820214748, decouple_loss:0.002042233943939209
The modified gen p mean: 0.4482211172580719, gen p mean: -0.21735797822475433, mean p set: 0.44879910349845886
loss_pred:0.015691909939050674, decouple_loss:0.002070176647976041
WV_1_PC_1_EH_0_PS_30, loss: 0.015659507364034653, avg_mse: 0.02305361069738865
current test mse: 0.023054
At step 2950, Best test: 0.023054
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
Iteration: 2951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486762285232544, gen p mean: -0.22001545131206512, mean p set: 0.4492048919200897
loss_pred:0.015471071004867554, decouple_loss:0.001975908875465393
The modified gen p mean: 0.4480328857898712, gen p mean: -0.21883007884025574, mean p set: 0.448609322309494
loss_pred:0.016168590635061264, decouple_loss:0.0019892817363142967
The modified gen p mean: 0.4493415355682373, gen p mean: -0.21766042709350586, mean p set: 0.4499199688434601
loss_pred:0.015721963718533516, decouple_loss:0.001999851083382964
Iteration: 2952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450573593378067, gen p mean: -0.21757067739963531, mean p set: 0.451102077960968
loss_pred:0.015454098582267761, decouple_loss:0.002089116722345352
The modified gen p mean: 0.4491613805294037, gen p mean: -0.21918869018554688, mean p set: 0.44973650574684143
The modified gen p mean: 0.4501420557498932, gen p mean: -0.2194148600101471, mean p set: 0.4507182538509369
loss_pred:0.015626654028892517, decouple_loss:0.002118167467415333
loss_pred:0.015342801809310913, decouple_loss:0.0019364336039870977
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866523146629333, gen p mean: -0.2198086977005005, mean p set: 0.4491916298866272
loss_pred:0.015842871740460396, decouple_loss:0.001975199207663536
The modified gen p mean: 0.45036980509757996, gen p mean: -0.22036993503570557, mean p set: 0.4509483277797699
The modified gen p mean: 0.4506973326206207, gen p mean: -0.22373713552951813, mean p set: 0.45127072930336
loss_pred:0.016639407724142075, decouple_loss:0.0020781501661986113
loss_pred:0.01592082343995571, decouple_loss:0.0020195746328681707
Iteration: 2954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005637407302856, gen p mean: -0.22432450950145721, mean p set: 0.45058757066726685
loss_pred:0.015948018059134483, decouple_loss:0.0020589909981936216
The modified gen p mean: 0.45034945011138916, gen p mean: -0.21734263002872467, mean p set: 0.45092761516571045
The modified gen p mean: 0.45018404722213745, gen p mean: -0.2164706140756607, mean p set: 0.4507621228694916
loss_pred:0.01584511250257492, decouple_loss:0.0021224140655249357
loss_pred:0.016249166801571846, decouple_loss:0.0021527186036109924
Iteration: 2955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45006871223449707, gen p mean: -0.2165418565273285, mean p set: 0.4506498873233795
loss_pred:0.01617039181292057, decouple_loss:0.0019303937442600727
The modified gen p mean: 0.4496779441833496, gen p mean: -0.2211122214794159, mean p set: 0.4502067267894745The modified gen p mean: 0.44915178418159485, gen p mean: -0.2179185450077057, mean p set: 0.44972866773605347
loss_pred:0.015473629347980022, decouple_loss:0.0019423504127189517
loss_pred:0.016359828412532806, decouple_loss:0.0021339578088372946
Iteration: 2956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500134289264679, gen p mean: -0.22320476174354553, mean p set: 0.450583815574646
loss_pred:0.016264423727989197, decouple_loss:0.0019070315174758434
The modified gen p mean: 0.4494685232639313, gen p mean: -0.21742703020572662, mean p set: 0.4500381648540497The modified gen p mean: 0.44961708784103394, gen p mean: -0.21491695940494537, mean p set: 0.45014673471450806
loss_pred:0.015551109798252583, decouple_loss:0.0016721347346901894
loss_pred:0.015720153227448463, decouple_loss:0.0017855119658634067
Iteration: 2957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45042234659194946, gen p mean: -0.21966023743152618, mean p set: 0.4510018229484558
loss_pred:0.016802635043859482, decouple_loss:0.0021195565350353718
The modified gen p mean: 0.44981756806373596, gen p mean: -0.21587812900543213, mean p set: 0.4503425657749176The modified gen p mean: 0.4491223096847534, gen p mean: -0.21412968635559082, mean p set: 0.4496990144252777
loss_pred:0.016548827290534973, decouple_loss:0.002072816714644432
loss_pred:0.015578693710267544, decouple_loss:0.001888400292955339
Iteration: 2958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506254196166992, gen p mean: -0.21446746587753296, mean p set: 0.4511975646018982
loss_pred:0.015124893747270107, decouple_loss:0.0018704935209825635
The modified gen p mean: 0.45077458024024963, gen p mean: -0.21815554797649384, mean p set: 0.4513084292411804The modified gen p mean: 0.44886910915374756, gen p mean: -0.2156948298215866, mean p set: 0.44944941997528076
loss_pred:0.016316847875714302, decouple_loss:0.0018353902269154787
loss_pred:0.015828575938940048, decouple_loss:0.0017610961804166436
Iteration: 2959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492495059967041, gen p mean: -0.21314628422260284, mean p set: 0.4498307704925537
loss_pred:0.01589292660355568, decouple_loss:0.0021115487907081842
The modified gen p mean: 0.450332373380661, gen p mean: -0.21499978005886078, mean p set: 0.4508611261844635The modified gen p mean: 0.4511367380619049, gen p mean: -0.21750041842460632, mean p set: 0.4517151713371277
loss_pred:0.015783533453941345, decouple_loss:0.002117764437571168
loss_pred:0.016148962080478668, decouple_loss:0.0020014315377920866
Iteration: 2960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493062198162079, gen p mean: -0.22050897777080536, mean p set: 0.44988352060317993
loss_pred:0.015184846706688404, decouple_loss:0.0019059779588133097
The modified gen p mean: 0.4494270086288452, gen p mean: -0.21872107684612274, mean p set: 0.44995349645614624The modified gen p mean: 0.450099915266037, gen p mean: -0.2172599732875824, mean p set: 0.45067691802978516
loss_pred:0.01603425294160843, decouple_loss:0.002003713743761182
loss_pred:0.015753772109746933, decouple_loss:0.001920183072797954
2023-04-27 13:11:31 testing...
The modified gen p mean: 0.4482206702232361, gen p mean: -0.21954618394374847, mean p set: 0.44879910349845886
loss_pred:0.015405542217195034, decouple_loss:0.001916881068609655
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22228959202766418, mean p set: 0.4499112665653229
loss_pred:0.015468205325305462, decouple_loss:0.0021127527579665184
The modified gen p mean: 0.4493015706539154, gen p mean: -0.22238022089004517, mean p set: 0.4498290419578552
loss_pred:0.01498697604984045, decouple_loss:0.0020062262192368507
WV_1_PC_1_EH_0_PS_30, loss: 0.015387505292892456, avg_mse: 0.022451741620898247
current test mse: 0.022452
At step 2960, Best test: 0.022452
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 2961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484158754348755, gen p mean: -0.22215843200683594, mean p set: 0.4489421248435974
loss_pred:0.015314959920942783, decouple_loss:0.0020949500612914562
The modified gen p mean: 0.44746828079223633, gen p mean: -0.22320562601089478, mean p set: 0.4480428397655487
loss_pred:0.014741161838173866, decouple_loss:0.002203741343691945
The modified gen p mean: 0.44848594069480896, gen p mean: -0.22204256057739258, mean p set: 0.4490565061569214
loss_pred:0.01501641795039177, decouple_loss:0.0022596167400479317
Iteration: 2962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462607800960541, gen p mean: -0.22245244681835175, mean p set: 0.4467865526676178
loss_pred:0.015776032581925392, decouple_loss:0.00224177329801023
The modified gen p mean: 0.44927260279655457, gen p mean: -0.2152070254087448, mean p set: 0.44985130429267883The modified gen p mean: 0.44557544589042664, gen p mean: -0.2247563898563385, mean p set: 0.4461473524570465
loss_pred:0.015283421613276005, decouple_loss:0.0025361389853060246
loss_pred:0.01558366697281599, decouple_loss:0.0022033671848475933
Iteration: 2963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685259461402893, gen p mean: -0.2176622748374939, mean p set: 0.4473777115345001
loss_pred:0.015995202586054802, decouple_loss:0.0024020930286496878
The modified gen p mean: 0.4471532106399536, gen p mean: -0.22053804993629456, mean p set: 0.4477252662181854
loss_pred:0.015900621190667152, decouple_loss:0.002244876464828849
The modified gen p mean: 0.44731441140174866, gen p mean: -0.2206931710243225, mean p set: 0.4478928744792938
loss_pred:0.014749658294022083, decouple_loss:0.002424826379865408
Iteration: 2964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770702719688416, gen p mean: -0.22630201280117035, mean p set: 0.4482314884662628
loss_pred:0.015092240646481514, decouple_loss:0.0020839308854192495
The modified gen p mean: 0.4473780691623688, gen p mean: -0.21940208971500397, mean p set: 0.4479483664035797
loss_pred:0.01485992968082428, decouple_loss:0.0020481685642153025
The modified gen p mean: 0.4480937123298645, gen p mean: -0.21940062940120697, mean p set: 0.4486686885356903
loss_pred:0.015693817287683487, decouple_loss:0.0020762409549206495
Iteration: 2965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873589277267456, gen p mean: -0.21193300187587738, mean p set: 0.44930681586265564
loss_pred:0.015593736432492733, decouple_loss:0.0025828019715845585
The modified gen p mean: 0.44851118326187134, gen p mean: -0.2182956039905548, mean p set: 0.4490351974964142The modified gen p mean: 0.4481261670589447, gen p mean: -0.2240586131811142, mean p set: 0.44869908690452576
loss_pred:0.014837861061096191, decouple_loss:0.002296261955052614loss_pred:0.015099645592272282, decouple_loss:0.002445329213514924
Iteration: 2966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472295343875885, gen p mean: -0.2120267152786255, mean p set: 0.44780370593070984
loss_pred:0.015788471326231956, decouple_loss:0.0023876328486949205
The modified gen p mean: 0.44626331329345703, gen p mean: -0.21479402482509613, mean p set: 0.4468391239643097
loss_pred:0.015290383249521255, decouple_loss:0.002259492641314864
The modified gen p mean: 0.44705700874328613, gen p mean: -0.21473023295402527, mean p set: 0.4475817382335663
loss_pred:0.015307631343603134, decouple_loss:0.0023846239782869816
Iteration: 2967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474225342273712, gen p mean: -0.21930044889450073, mean p set: 0.4480014741420746
loss_pred:0.015061779879033566, decouple_loss:0.002079940401017666
The modified gen p mean: 0.44769176840782166, gen p mean: -0.22076261043548584, mean p set: 0.44826918840408325
loss_pred:0.015329480171203613, decouple_loss:0.002277593594044447
The modified gen p mean: 0.4479149580001831, gen p mean: -0.22292357683181763, mean p set: 0.44844329357147217
loss_pred:0.015374526381492615, decouple_loss:0.002260023495182395
Iteration: 2968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769570231437683, gen p mean: -0.22346845269203186, mean p set: 0.44827160239219666
loss_pred:0.015927214175462723, decouple_loss:0.002131126821041107
The modified gen p mean: 0.4475427269935608, gen p mean: -0.22724534571170807, mean p set: 0.44812238216400146
loss_pred:0.015463585965335369, decouple_loss:0.0021640092600136995
The modified gen p mean: 0.4486875534057617, gen p mean: -0.21789921820163727, mean p set: 0.4492167532444
loss_pred:0.01571461372077465, decouple_loss:0.0022719227708876133
Iteration: 2969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706660509109497, gen p mean: -0.21718376874923706, mean p set: 0.44764280319213867
loss_pred:0.015389992855489254, decouple_loss:0.0023678806610405445
The modified gen p mean: 0.44832032918930054, gen p mean: -0.2237296998500824, mean p set: 0.44889581203460693
loss_pred:0.015598139725625515, decouple_loss:0.0023206081241369247
The modified gen p mean: 0.44715821743011475, gen p mean: -0.22860538959503174, mean p set: 0.44767823815345764
loss_pred:0.015084483660757542, decouple_loss:0.002220044145360589
Iteration: 2970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707557559013367, gen p mean: -0.22335964441299438, mean p set: 0.44764459133148193
loss_pred:0.01471200305968523, decouple_loss:0.0019764553289860487
The modified gen p mean: 0.44587835669517517, gen p mean: -0.22466279566287994, mean p set: 0.44645413756370544The modified gen p mean: 0.44813272356987, gen p mean: -0.2277827113866806, mean p set: 0.4486646354198456
loss_pred:0.01505403034389019, decouple_loss:0.0023695570416748524
loss_pred:0.014829601161181927, decouple_loss:0.0022184972185641527
2023-04-27 13:15:45 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.226258784532547, mean p set: 0.4499112665653229
loss_pred:0.01571524143218994, decouple_loss:0.002478389535099268
The modified gen p mean: 0.4492962062358856, gen p mean: -0.2261599749326706, mean p set: 0.4498290419578552
loss_pred:0.015264124609529972, decouple_loss:0.0023958859965205193
The modified gen p mean: 0.44822219014167786, gen p mean: -0.22323216497898102, mean p set: 0.44879910349845886
loss_pred:0.015638424083590508, decouple_loss:0.0023443051613867283
WV_1_PC_1_EH_0_PS_30, loss: 0.015659574419260025, avg_mse: 0.022986875846982002
current test mse: 0.022987
Iteration: 2971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760850071907043, gen p mean: -0.23202355206012726, mean p set: 0.448184072971344
loss_pred:0.015222880057990551, decouple_loss:0.002230234444141388
The modified gen p mean: 0.4459238052368164, gen p mean: -0.2269919067621231, mean p set: 0.44645223021507263
loss_pred:0.015353879891335964, decouple_loss:0.002135300310328603
The modified gen p mean: 0.4491042494773865, gen p mean: -0.21789668500423431, mean p set: 0.44967639446258545
loss_pred:0.014867977239191532, decouple_loss:0.002386568346992135
Iteration: 2972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448388934135437, gen p mean: -0.22176821529865265, mean p set: 0.448919415473938
loss_pred:0.015195625834167004, decouple_loss:0.002383528044447303
The modified gen p mean: 0.44746193289756775, gen p mean: -0.21895387768745422, mean p set: 0.4480399191379547
The modified gen p mean: 0.4481007158756256, gen p mean: -0.22396887838840485, mean p set: 0.4486868679523468
loss_pred:0.014529088512063026, decouple_loss:0.0023144916631281376
loss_pred:0.014874412678182125, decouple_loss:0.0024317754432559013
Iteration: 2973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448312908411026, gen p mean: -0.22168727219104767, mean p set: 0.4488369822502136
loss_pred:0.015316563658416271, decouple_loss:0.0022175670601427555
The modified gen p mean: 0.4473626911640167, gen p mean: -0.2201501876115799, mean p set: 0.4479406476020813
The modified gen p mean: 0.44886186718940735, gen p mean: -0.21302588284015656, mean p set: 0.44944167137145996
loss_pred:0.015146661549806595, decouple_loss:0.0023078962694853544
loss_pred:0.015154993161559105, decouple_loss:0.0021966835483908653
Iteration: 2974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724249839782715, gen p mean: -0.2218540757894516, mean p set: 0.44777119159698486
loss_pred:0.01541475672274828, decouple_loss:0.002095205243676901
The modified gen p mean: 0.4489351212978363, gen p mean: -0.2209828495979309, mean p set: 0.44951605796813965The modified gen p mean: 0.44751808047294617, gen p mean: -0.22277846932411194, mean p set: 0.4481014013290405
loss_pred:0.014811372384428978, decouple_loss:0.0021048462949693203
loss_pred:0.015483071096241474, decouple_loss:0.0022661369293928146
Iteration: 2975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479339122772217, gen p mean: -0.2220538705587387, mean p set: 0.44850867986679077
loss_pred:0.014972697012126446, decouple_loss:0.0023995963856577873
The modified gen p mean: 0.4478967785835266, gen p mean: -0.2239363193511963, mean p set: 0.448468953371048The modified gen p mean: 0.44798338413238525, gen p mean: -0.22178131341934204, mean p set: 0.4485113322734833
loss_pred:0.015393991023302078, decouple_loss:0.0023017036728560925
loss_pred:0.014695743098855019, decouple_loss:0.0023456152994185686
Iteration: 2976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478425979614258, gen p mean: -0.22261440753936768, mean p set: 0.44841864705085754
loss_pred:0.01493273675441742, decouple_loss:0.002110246568918228
The modified gen p mean: 0.448973149061203, gen p mean: -0.21816055476665497, mean p set: 0.4495036005973816The modified gen p mean: 0.44816261529922485, gen p mean: -0.2171095758676529, mean p set: 0.4487389624118805
loss_pred:0.015457911416888237, decouple_loss:0.0021739029325544834
loss_pred:0.01558530144393444, decouple_loss:0.0021102777682244778
Iteration: 2977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452684223651886, gen p mean: -0.2283167690038681, mean p set: 0.44584187865257263
loss_pred:0.015451174229383469, decouple_loss:0.002236307365819812
The modified gen p mean: 0.44636231660842896, gen p mean: -0.2232266217470169, mean p set: 0.44689464569091797The modified gen p mean: 0.44885993003845215, gen p mean: -0.22111715376377106, mean p set: 0.4494354724884033
loss_pred:0.015067290514707565, decouple_loss:0.002179487142711878
loss_pred:0.015456916764378548, decouple_loss:0.0023704678751528263
Iteration: 2978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448512464761734, gen p mean: -0.2235751748085022, mean p set: 0.44908660650253296
loss_pred:0.014947944320738316, decouple_loss:0.002504298696294427
The modified gen p mean: 0.44713616371154785, gen p mean: -0.21967940032482147, mean p set: 0.4476655125617981The modified gen p mean: 0.4482930898666382, gen p mean: -0.21720176935195923, mean p set: 0.4488692581653595
loss_pred:0.01505474466830492, decouple_loss:0.0023304743226617575
loss_pred:0.014211609028279781, decouple_loss:0.0022036717273294926
Iteration: 2979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705575704574585, gen p mean: -0.22134360671043396, mean p set: 0.4476326107978821
loss_pred:0.014773475006222725, decouple_loss:0.002104813000187278
The modified gen p mean: 0.4483744204044342, gen p mean: -0.22457075119018555, mean p set: 0.4489506781101227The modified gen p mean: 0.4459068477153778, gen p mean: -0.22701120376586914, mean p set: 0.4464397132396698
loss_pred:0.015451996587216854, decouple_loss:0.002139153191819787
loss_pred:0.015578399412333965, decouple_loss:0.0019019989995285869
Iteration: 2980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823402166366577, gen p mean: -0.2226068377494812, mean p set: 0.4487598240375519
loss_pred:0.01513782236725092, decouple_loss:0.0023641290608793497
The modified gen p mean: 0.44790083169937134, gen p mean: -0.21847273409366608, mean p set: 0.44847002625465393The modified gen p mean: 0.44737163186073303, gen p mean: -0.2271369844675064, mean p set: 0.44794782996177673
loss_pred:0.015236345119774342, decouple_loss:0.002089574933052063
loss_pred:0.015664562582969666, decouple_loss:0.002290691016241908
2023-04-27 13:19:10 testing...
The modified gen p mean: 0.4482257068157196, gen p mean: -0.22550123929977417, mean p set: 0.44879910349845886
loss_pred:0.01566389389336109, decouple_loss:0.0022000407334417105
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22896124422550201, mean p set: 0.4499112665653229
loss_pred:0.015748903155326843, decouple_loss:0.0022256539668887854
The modified gen p mean: 0.44929903745651245, gen p mean: -0.22874301671981812, mean p set: 0.4498290419578552
loss_pred:0.015338585712015629, decouple_loss:0.002226833952590823
WV_1_PC_1_EH_0_PS_30, loss: 0.015694670379161835, avg_mse: 0.023101117461919785
current test mse: 0.023101
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 2981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761428236961365, gen p mean: -0.22425799071788788, mean p set: 0.44814345240592957
loss_pred:0.015421676449477673, decouple_loss:0.0021403266582638025
The modified gen p mean: 0.44776034355163574, gen p mean: -0.22365595400333405, mean p set: 0.44833314418792725
The modified gen p mean: 0.448531836271286, gen p mean: -0.23016129434108734, mean p set: 0.44910797476768494
loss_pred:0.015256473794579506, decouple_loss:0.00222226046025753
loss_pred:0.01418653316795826, decouple_loss:0.002311787800863385
Iteration: 2982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802674651145935, gen p mean: -0.2230905443429947, mean p set: 0.4485572874546051
loss_pred:0.014779056422412395, decouple_loss:0.002208790509030223
The modified gen p mean: 0.4497058093547821, gen p mean: -0.2253093272447586, mean p set: 0.4502794146537781
The modified gen p mean: 0.44962480664253235, gen p mean: -0.2342177927494049, mean p set: 0.45020073652267456
loss_pred:0.014576144516468048, decouple_loss:0.0022983415983617306
loss_pred:0.01376335322856903, decouple_loss:0.0023902084212750196
Iteration: 2983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470643401145935, gen p mean: -0.2304421216249466, mean p set: 0.4475933015346527
loss_pred:0.015051409602165222, decouple_loss:0.0024815627839416265
The modified gen p mean: 0.448658287525177, gen p mean: -0.22627270221710205, mean p set: 0.44923779368400574
The modified gen p mean: 0.448262095451355, gen p mean: -0.22845765948295593, mean p set: 0.44884639978408813
loss_pred:0.014856377616524696, decouple_loss:0.0022527130786329508
loss_pred:0.01435910165309906, decouple_loss:0.0024840959813445807
Iteration: 2984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486299753189087, gen p mean: -0.22637581825256348, mean p set: 0.44920656085014343
loss_pred:0.014644976705312729, decouple_loss:0.0024315654300153255
The modified gen p mean: 0.44814398884773254, gen p mean: -0.22098156809806824, mean p set: 0.44867458939552307The modified gen p mean: 0.44860249757766724, gen p mean: -0.22169744968414307, mean p set: 0.449176549911499
loss_pred:0.015221474692225456, decouple_loss:0.0022202020045369864
loss_pred:0.014637650921940804, decouple_loss:0.0022889666724950075
Iteration: 2985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489825665950775, gen p mean: -0.22039736807346344, mean p set: 0.449554443359375
loss_pred:0.014520642347633839, decouple_loss:0.002485202858224511
The modified gen p mean: 0.44760122895240784, gen p mean: -0.21864265203475952, mean p set: 0.4481779932975769
loss_pred:0.015317555516958237, decouple_loss:0.002293033991008997
The modified gen p mean: 0.4468685984611511, gen p mean: -0.2213040292263031, mean p set: 0.447394996881485
loss_pred:0.014444069005548954, decouple_loss:0.0024506172630935907
Iteration: 2986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481010138988495, gen p mean: -0.23209691047668457, mean p set: 0.44867387413978577
loss_pred:0.014618456363677979, decouple_loss:0.002154202666133642
The modified gen p mean: 0.44833213090896606, gen p mean: -0.2275107055902481, mean p set: 0.44885799288749695The modified gen p mean: 0.4477657377719879, gen p mean: -0.22798162698745728, mean p set: 0.4483363628387451
loss_pred:0.01491691917181015, decouple_loss:0.0020915623754262924
loss_pred:0.01426868885755539, decouple_loss:0.0022726859897375107
Iteration: 2987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786155223846436, gen p mean: -0.2327498346567154, mean p set: 0.44843384623527527
loss_pred:0.014695512130856514, decouple_loss:0.0022159412037581205
The modified gen p mean: 0.44744810461997986, gen p mean: -0.22674445807933807, mean p set: 0.4480287730693817
loss_pred:0.015207194723188877, decouple_loss:0.00235726241953671
The modified gen p mean: 0.4472077786922455, gen p mean: -0.22493332624435425, mean p set: 0.4477371871471405
loss_pred:0.01446231547743082, decouple_loss:0.0024138973094522953
Iteration: 2988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729429483413696, gen p mean: -0.22997531294822693, mean p set: 0.44786569476127625
loss_pred:0.014223028905689716, decouple_loss:0.0021720475051552057
The modified gen p mean: 0.44716790318489075, gen p mean: -0.2262798398733139, mean p set: 0.447748064994812The modified gen p mean: 0.4467430114746094, gen p mean: -0.23323796689510345, mean p set: 0.4472704529762268
loss_pred:0.014300787821412086, decouple_loss:0.002079087309539318
loss_pred:0.014608805999159813, decouple_loss:0.0022321988362818956
Iteration: 2989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473308324813843, gen p mean: -0.23320069909095764, mean p set: 0.4479064643383026
loss_pred:0.014557866379618645, decouple_loss:0.0024136702995747328
The modified gen p mean: 0.4498579204082489, gen p mean: -0.2248845100402832, mean p set: 0.4504365622997284
loss_pred:0.013717228546738625, decouple_loss:0.0024752758909016848
The modified gen p mean: 0.4488038718700409, gen p mean: -0.23671673238277435, mean p set: 0.4493279755115509
loss_pred:0.013396711088716984, decouple_loss:0.002490380546078086
Iteration: 2990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484676718711853, gen p mean: -0.23188908398151398, mean p set: 0.44904303550720215
loss_pred:0.015022355131804943, decouple_loss:0.0019277016399428248
The modified gen p mean: 0.4483000338077545, gen p mean: -0.22732506692409515, mean p set: 0.4488815367221832
loss_pred:0.015468914993107319, decouple_loss:0.002066916786134243
The modified gen p mean: 0.4474482238292694, gen p mean: -0.22891154885292053, mean p set: 0.4479774832725525
loss_pred:0.014123409986495972, decouple_loss:0.0019384564366191626
2023-04-27 13:23:14 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23016884922981262, mean p set: 0.4499112665653229
loss_pred:0.015737732872366905, decouple_loss:0.0025183160323649645
The modified gen p mean: 0.44929933547973633, gen p mean: -0.23026326298713684, mean p set: 0.4498290419578552
loss_pred:0.015350116416811943, decouple_loss:0.002828036667779088
The modified gen p mean: 0.4482206702232361, gen p mean: -0.22725842893123627, mean p set: 0.44879910349845886
loss_pred:0.015619675628840923, decouple_loss:0.0024778502993285656
WV_1_PC_1_EH_0_PS_30, loss: 0.015699580311775208, avg_mse: 0.02309550903737545
current test mse: 0.023096
Iteration: 2991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852861762046814, gen p mean: -0.22773490846157074, mean p set: 0.44910773634910583
loss_pred:0.013825357891619205, decouple_loss:0.002760879462584853
The modified gen p mean: 0.4479357600212097, gen p mean: -0.23064565658569336, mean p set: 0.44846272468566895
loss_pred:0.013343975879251957, decouple_loss:0.0029190685600042343
The modified gen p mean: 0.44756999611854553, gen p mean: -0.22950191795825958, mean p set: 0.4481402039527893
loss_pred:0.01454749796539545, decouple_loss:0.002465588506311178
Iteration: 2992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516156315803528, gen p mean: -0.23094981908798218, mean p set: 0.4521370232105255
loss_pred:0.014402348548173904, decouple_loss:0.0023459047079086304
The modified gen p mean: 0.4473382234573364, gen p mean: -0.2268986999988556, mean p set: 0.4479128420352936
The modified gen p mean: 0.4488072395324707, gen p mean: -0.22772297263145447, mean p set: 0.4493841528892517
loss_pred:0.014294090680778027, decouple_loss:0.0021837984677404165
loss_pred:0.014506246894598007, decouple_loss:0.0022794019896537066
Iteration: 2993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499889314174652, gen p mean: -0.23000165820121765, mean p set: 0.4505176842212677
loss_pred:0.013891108334064484, decouple_loss:0.002450577449053526
The modified gen p mean: 0.4489152431488037, gen p mean: -0.24143125116825104, mean p set: 0.4494871497154236
The modified gen p mean: 0.4487084448337555, gen p mean: -0.23033717274665833, mean p set: 0.4492860734462738
loss_pred:0.013048782013356686, decouple_loss:0.002499497029930353
loss_pred:0.01443779282271862, decouple_loss:0.00266043352894485
Iteration: 2994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930413365364075, gen p mean: -0.23128360509872437, mean p set: 0.4498351216316223
loss_pred:0.014118815772235394, decouple_loss:0.002390437526628375
The modified gen p mean: 0.4490281343460083, gen p mean: -0.23814207315444946, mean p set: 0.4496042728424072
The modified gen p mean: 0.4472556412220001, gen p mean: -0.22548621892929077, mean p set: 0.44782793521881104
loss_pred:0.01325715146958828, decouple_loss:0.0023505319841206074
loss_pred:0.014857913367450237, decouple_loss:0.0021294127218425274
Iteration: 2995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810256361961365, gen p mean: -0.23164679110050201, mean p set: 0.44867774844169617
loss_pred:0.014668615534901619, decouple_loss:0.0025036234874278307
The modified gen p mean: 0.4497118890285492, gen p mean: -0.2223314791917801, mean p set: 0.4502353370189667The modified gen p mean: 0.44745370745658875, gen p mean: -0.22752691805362701, mean p set: 0.44803765416145325
loss_pred:0.014474225230515003, decouple_loss:0.0023472958710044622
loss_pred:0.013890571892261505, decouple_loss:0.0023379549384117126
Iteration: 2996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449065625667572, gen p mean: -0.23334582149982452, mean p set: 0.4496400058269501
loss_pred:0.014140903018414974, decouple_loss:0.0022000130265951157
The modified gen p mean: 0.450704962015152, gen p mean: -0.22518973052501678, mean p set: 0.45123034715652466The modified gen p mean: 0.4495126008987427, gen p mean: -0.23134319484233856, mean p set: 0.45009157061576843
loss_pred:0.013580812141299248, decouple_loss:0.0021460638381540775
loss_pred:0.013985528610646725, decouple_loss:0.002192090731114149
Iteration: 2997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801896810531616, gen p mean: -0.2277863621711731, mean p set: 0.44859644770622253
loss_pred:0.014438625425100327, decouple_loss:0.002358770929276943
The modified gen p mean: 0.4472213387489319, gen p mean: -0.22945858538150787, mean p set: 0.4477499723434448The modified gen p mean: 0.4483177363872528, gen p mean: -0.2267826944589615, mean p set: 0.44889771938323975
loss_pred:0.0155122559517622, decouple_loss:0.0023950065951794386
loss_pred:0.014492064714431763, decouple_loss:0.0025049964897334576
Iteration: 2998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465999901294708, gen p mean: -0.23192530870437622, mean p set: 0.447174608707428
loss_pred:0.015006526373326778, decouple_loss:0.002333397511392832
The modified gen p mean: 0.448799192905426, gen p mean: -0.23325417935848236, mean p set: 0.4493709206581116
loss_pred:0.014728989452123642, decouple_loss:0.0023414965253323317
The modified gen p mean: 0.44971662759780884, gen p mean: -0.2288341075181961, mean p set: 0.45023879408836365
loss_pred:0.01459463406354189, decouple_loss:0.002659181598573923
Iteration: 2999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450099915266037, gen p mean: -0.2201102375984192, mean p set: 0.45067334175109863
loss_pred:0.014031678438186646, decouple_loss:0.0023948089219629765
The modified gen p mean: 0.4483010172843933, gen p mean: -0.2245795577764511, mean p set: 0.44887375831604004
loss_pred:0.015301755629479885, decouple_loss:0.0021784876007586718
The modified gen p mean: 0.44903087615966797, gen p mean: -0.22634553909301758, mean p set: 0.4495624303817749
loss_pred:0.014141020365059376, decouple_loss:0.0027303933165967464
Iteration: 3000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473140835762024, gen p mean: -0.22182434797286987, mean p set: 0.4478965699672699
loss_pred:0.014554733410477638, decouple_loss:0.0025613754987716675
The modified gen p mean: 0.44889914989471436, gen p mean: -0.22425805032253265, mean p set: 0.4494233727455139The modified gen p mean: 0.44884350895881653, gen p mean: -0.22501470148563385, mean p set: 0.4494149386882782
loss_pred:0.014690405689179897, decouple_loss:0.0025113581214100122
loss_pred:0.014729627408087254, decouple_loss:0.002572548808529973
2023-04-27 13:26:38 itr: 3000
training loss: [0.01485826 0.0146828  0.01481597]
2023-04-27 13:26:39 testing...
The modified gen p mean: 0.4482212960720062, gen p mean: -0.21392688155174255, mean p set: 0.44879910349845886
loss_pred:0.016027875244617462, decouple_loss:0.002594216028228402
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21603348851203918, mean p set: 0.4499112665653229
loss_pred:0.016088446602225304, decouple_loss:0.0025373618118464947
The modified gen p mean: 0.449302613735199, gen p mean: -0.21611985564231873, mean p set: 0.4498290419578552
loss_pred:0.015697643160820007, decouple_loss:0.0024260065983980894
WV_1_PC_1_EH_0_PS_30, loss: 0.016063949093222618, avg_mse: 0.023824486881494522
current test mse: 0.023824
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 3001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745028018951416, gen p mean: -0.21601489186286926, mean p set: 0.44797900319099426
loss_pred:0.015776535496115685, decouple_loss:0.002436287235468626
The modified gen p mean: 0.4486847519874573, gen p mean: -0.2209928333759308, mean p set: 0.44926151633262634
loss_pred:0.015245200134813786, decouple_loss:0.002279630396515131
The modified gen p mean: 0.4473547339439392, gen p mean: -0.2146076112985611, mean p set: 0.44792643189430237
loss_pred:0.015918565914034843, decouple_loss:0.002760697156190872
Iteration: 3002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478663504123688, gen p mean: -0.228842094540596, mean p set: 0.44839832186698914
loss_pred:0.015001798048615456, decouple_loss:0.002621322637423873
The modified gen p mean: 0.4477009177207947, gen p mean: -0.2299407720565796, mean p set: 0.4482753276824951
loss_pred:0.015859778970479965, decouple_loss:0.0025992291048169136
The modified gen p mean: 0.44788339734077454, gen p mean: -0.2262343317270279, mean p set: 0.44846177101135254
loss_pred:0.015358218923211098, decouple_loss:0.0026275571435689926
Iteration: 3003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758179783821106, gen p mean: -0.23665598034858704, mean p set: 0.4481166899204254
loss_pred:0.015744199976325035, decouple_loss:0.0028020739555358887
The modified gen p mean: 0.44742050766944885, gen p mean: -0.23555482923984528, mean p set: 0.4479960799217224
loss_pred:0.015637291595339775, decouple_loss:0.002856914885342121
The modified gen p mean: 0.4480416178703308, gen p mean: -0.23879139125347137, mean p set: 0.4486139416694641
loss_pred:0.015020244754850864, decouple_loss:0.0028202240355312824
Iteration: 3004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474949240684509, gen p mean: -0.2438313364982605, mean p set: 0.44802939891815186
loss_pred:0.015788160264492035, decouple_loss:0.0023331299889832735
The modified gen p mean: 0.4477047622203827, gen p mean: -0.24105122685432434, mean p set: 0.44828298687934875
loss_pred:0.015584235079586506, decouple_loss:0.0024789615999907255
The modified gen p mean: 0.4479729235172272, gen p mean: -0.23939724266529083, mean p set: 0.4485490918159485
loss_pred:0.01620449684560299, decouple_loss:0.0024530217051506042
Iteration: 3005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447907418012619, gen p mean: -0.24370643496513367, mean p set: 0.44847962260246277
loss_pred:0.015910349786281586, decouple_loss:0.002349256305024028
The modified gen p mean: 0.44714951515197754, gen p mean: -0.24494831264019012, mean p set: 0.4476796090602875The modified gen p mean: 0.44802507758140564, gen p mean: -0.24112656712532043, mean p set: 0.4485950171947479
loss_pred:0.015478109940886497, decouple_loss:0.0023368801921606064
loss_pred:0.01572249084711075, decouple_loss:0.0023649900685995817
Iteration: 3006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809845089912415, gen p mean: -0.24193400144577026, mean p set: 0.4486706554889679
loss_pred:0.014685975387692451, decouple_loss:0.0024701005313545465
The modified gen p mean: 0.44796523451805115, gen p mean: -0.2409083992242813, mean p set: 0.44854387640953064The modified gen p mean: 0.4476652145385742, gen p mean: -0.24582618474960327, mean p set: 0.44819343090057373
loss_pred:0.0153570044785738, decouple_loss:0.002322901738807559
loss_pred:0.01524332258850336, decouple_loss:0.002376248361542821
Iteration: 3007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474085569381714, gen p mean: -0.24026766419410706, mean p set: 0.4479837417602539
loss_pred:0.015374233946204185, decouple_loss:0.002199506852775812
The modified gen p mean: 0.44801896810531616, gen p mean: -0.24293720722198486, mean p set: 0.44859638810157776
loss_pred:0.015605402179062366, decouple_loss:0.0023555655498057604
The modified gen p mean: 0.4484003186225891, gen p mean: -0.23630519211292267, mean p set: 0.44892874360084534
loss_pred:0.014961461536586285, decouple_loss:0.0022957990877330303
Iteration: 3008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719284772872925, gen p mean: -0.2402910739183426, mean p set: 0.44776955246925354
loss_pred:0.015230616554617882, decouple_loss:0.00208083912730217
The modified gen p mean: 0.44774141907691956, gen p mean: -0.23330211639404297, mean p set: 0.4483139216899872
loss_pred:0.014859060756862164, decouple_loss:0.0020896594505757093
The modified gen p mean: 0.4473603367805481, gen p mean: -0.23244860768318176, mean p set: 0.44789719581604004
loss_pred:0.014843177981674671, decouple_loss:0.002164880046620965
Iteration: 3009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833195209503174, gen p mean: -0.2334141582250595, mean p set: 0.4489077031612396
loss_pred:0.014486847445368767, decouple_loss:0.0023425226099789143
The modified gen p mean: 0.44782695174217224, gen p mean: -0.23216122388839722, mean p set: 0.448341965675354The modified gen p mean: 0.4470273554325104, gen p mean: -0.2318480759859085, mean p set: 0.4476061165332794
loss_pred:0.015275024808943272, decouple_loss:0.002265600487589836
loss_pred:0.015595565550029278, decouple_loss:0.0023157522082328796
Iteration: 3010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785675406455994, gen p mean: -0.2268412709236145, mean p set: 0.44843557476997375
loss_pred:0.01520576886832714, decouple_loss:0.0021195823792368174
The modified gen p mean: 0.4478153586387634, gen p mean: -0.22357501089572906, mean p set: 0.44838589429855347
loss_pred:0.01546691358089447, decouple_loss:0.0021789695601910353
The modified gen p mean: 0.44830429553985596, gen p mean: -0.22510351240634918, mean p set: 0.4488312005996704
loss_pred:0.014501159079372883, decouple_loss:0.002524412702769041
2023-04-27 13:30:42 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22071722149848938, mean p set: 0.4499112665653229
loss_pred:0.015836209058761597, decouple_loss:0.0023114702198654413
The modified gen p mean: 0.4492999017238617, gen p mean: -0.22047200798988342, mean p set: 0.4498290419578552
loss_pred:0.015406153164803982, decouple_loss:0.0023562463466078043
The modified gen p mean: 0.4482213258743286, gen p mean: -0.21773211658000946, mean p set: 0.44879910349845886
loss_pred:0.01574568636715412, decouple_loss:0.0022451903205364943
WV_1_PC_1_EH_0_PS_30, loss: 0.01577789895236492, avg_mse: 0.023134147748351097
current test mse: 0.023134
Iteration: 3011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753217697143555, gen p mean: -0.22470515966415405, mean p set: 0.44810721278190613
loss_pred:0.014962788671255112, decouple_loss:0.0020817562472075224
The modified gen p mean: 0.4477003514766693, gen p mean: -0.22198891639709473, mean p set: 0.44828253984451294
loss_pred:0.015165486373007298, decouple_loss:0.0021490957587957382
The modified gen p mean: 0.447674036026001, gen p mean: -0.2215138077735901, mean p set: 0.448201984167099
loss_pred:0.014648414216935635, decouple_loss:0.0022185880225151777
Iteration: 3012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795122742652893, gen p mean: -0.2198118418455124, mean p set: 0.4484822154045105
loss_pred:0.014922460541129112, decouple_loss:0.0021077808924019337
The modified gen p mean: 0.4479031264781952, gen p mean: -0.2266962081193924, mean p set: 0.44847777485847473
The modified gen p mean: 0.4479735195636749, gen p mean: -0.22283156216144562, mean p set: 0.44854554533958435
loss_pred:0.014892631210386753, decouple_loss:0.0019288245821371675
loss_pred:0.014319689944386482, decouple_loss:0.0021094561088830233
Iteration: 3013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480752646923065, gen p mean: -0.2227940559387207, mean p set: 0.44859760999679565
loss_pred:0.015744544565677643, decouple_loss:0.002062376355752349
The modified gen p mean: 0.44761985540390015, gen p mean: -0.22578959167003632, mean p set: 0.44819650053977966
The modified gen p mean: 0.44813060760498047, gen p mean: -0.2223256677389145, mean p set: 0.4487065374851227
loss_pred:0.014564445242285728, decouple_loss:0.0022374182008206844
loss_pred:0.014676914550364017, decouple_loss:0.0022826234344393015
Iteration: 3014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474877417087555, gen p mean: -0.22760215401649475, mean p set: 0.4480193257331848
loss_pred:0.014910274185240269, decouple_loss:0.0021007577888667583
The modified gen p mean: 0.44777992367744446, gen p mean: -0.23302611708641052, mean p set: 0.4483576714992523
The modified gen p mean: 0.4478110373020172, gen p mean: -0.2319214791059494, mean p set: 0.44838467240333557
loss_pred:0.015460630878806114, decouple_loss:0.0021655906457453966
loss_pred:0.014759807847440243, decouple_loss:0.001975008985027671
Iteration: 3015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447692334651947, gen p mean: -0.2317369282245636, mean p set: 0.44826412200927734
loss_pred:0.015405725687742233, decouple_loss:0.002022199332714081
The modified gen p mean: 0.4477924704551697, gen p mean: -0.2330572009086609, mean p set: 0.44836533069610596
loss_pred:0.01519901491701603, decouple_loss:0.0020049549639225006
The modified gen p mean: 0.44780245423316956, gen p mean: -0.2296111285686493, mean p set: 0.4483332633972168
loss_pred:0.01503077708184719, decouple_loss:0.0021065433975309134
Iteration: 3016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732666015625, gen p mean: -0.23136427998542786, mean p set: 0.4478999972343445
loss_pred:0.015070225112140179, decouple_loss:0.0020853907335549593
The modified gen p mean: 0.4471761882305145, gen p mean: -0.23372529447078705, mean p set: 0.4477587640285492
loss_pred:0.015172175131738186, decouple_loss:0.0019133312162011862
The modified gen p mean: 0.44837114214897156, gen p mean: -0.22841431200504303, mean p set: 0.44889721274375916
loss_pred:0.014625806361436844, decouple_loss:0.0018946968484669924
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819724559783936, gen p mean: -0.22832340002059937, mean p set: 0.448775053024292
loss_pred:0.015731297433376312, decouple_loss:0.0020010683219879866
The modified gen p mean: 0.44764626026153564, gen p mean: -0.23456136882305145, mean p set: 0.4482157230377197The modified gen p mean: 0.44875067472457886, gen p mean: -0.22591184079647064, mean p set: 0.44928398728370667
loss_pred:0.015134901739656925, decouple_loss:0.0019421969773247838
loss_pred:0.015461824834346771, decouple_loss:0.001999697182327509
Iteration: 3018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801560044288635, gen p mean: -0.2242301106452942, mean p set: 0.44859370589256287
loss_pred:0.014937452971935272, decouple_loss:0.0021327894646674395
The modified gen p mean: 0.4486638605594635, gen p mean: -0.22337640821933746, mean p set: 0.4492427408695221
loss_pred:0.01482464000582695, decouple_loss:0.0021016353275626898
The modified gen p mean: 0.4482841491699219, gen p mean: -0.22437959909439087, mean p set: 0.4488089084625244
loss_pred:0.01531500555574894, decouple_loss:0.0020949607715010643
Iteration: 3019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448587030172348, gen p mean: -0.22243405878543854, mean p set: 0.4491655230522156
loss_pred:0.01478775404393673, decouple_loss:0.0020150174386799335
The modified gen p mean: 0.44767454266548157, gen p mean: -0.2268298864364624, mean p set: 0.4482516348361969
loss_pred:0.015248894691467285, decouple_loss:0.0020992672070860863
The modified gen p mean: 0.4474624991416931, gen p mean: -0.22454267740249634, mean p set: 0.44799885153770447
loss_pred:0.014475450851023197, decouple_loss:0.002033347962424159
Iteration: 3020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785207509994507, gen p mean: -0.22210662066936493, mean p set: 0.44843021035194397
loss_pred:0.014723316766321659, decouple_loss:0.0020963866263628006
The modified gen p mean: 0.4490683972835541, gen p mean: -0.22542065382003784, mean p set: 0.4496433436870575
loss_pred:0.014957047067582607, decouple_loss:0.0020793008152395487
The modified gen p mean: 0.44851216673851013, gen p mean: -0.22572818398475647, mean p set: 0.44904080033302307
loss_pred:0.01434422843158245, decouple_loss:0.002208995632827282
2023-04-27 13:34:06 testing...
The modified gen p mean: 0.4482213258743286, gen p mean: -0.22015710175037384, mean p set: 0.44879910349845886
loss_pred:0.015698710456490517, decouple_loss:0.0020871409215033054
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2229546457529068, mean p set: 0.4499112665653229
loss_pred:0.015769734978675842, decouple_loss:0.0020382797811180353
The modified gen p mean: 0.44929978251457214, gen p mean: -0.22310179471969604, mean p set: 0.4498290419578552
loss_pred:0.015392256900668144, decouple_loss:0.0022221035324037075
WV_1_PC_1_EH_0_PS_30, loss: 0.015726028010249138, avg_mse: 0.023123720660805702
current test mse: 0.023124
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 3021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806504249572754, gen p mean: -0.22107338905334473, mean p set: 0.44859448075294495
loss_pred:0.01539760921150446, decouple_loss:0.0021136736031621695
The modified gen p mean: 0.4472118616104126, gen p mean: -0.22335131466388702, mean p set: 0.44778627157211304
loss_pred:0.015014702454209328, decouple_loss:0.001960210967808962
The modified gen p mean: 0.4478100538253784, gen p mean: -0.22602614760398865, mean p set: 0.4483872950077057
loss_pred:0.014821617864072323, decouple_loss:0.002072190400213003
Iteration: 3022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447632759809494, gen p mean: -0.2192266881465912, mean p set: 0.44815605878829956
loss_pred:0.014605281874537468, decouple_loss:0.0018836340168491006
The modified gen p mean: 0.44714486598968506, gen p mean: -0.2176891416311264, mean p set: 0.44772249460220337
loss_pred:0.015344531275331974, decouple_loss:0.001985659124329686
The modified gen p mean: 0.4469905495643616, gen p mean: -0.21847820281982422, mean p set: 0.4475656747817993
loss_pred:0.015038474462926388, decouple_loss:0.002017828868702054
Iteration: 3023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475101828575134, gen p mean: -0.21752184629440308, mean p set: 0.44803762435913086
loss_pred:0.015220902860164642, decouple_loss:0.002019042382016778
The modified gen p mean: 0.4479033946990967, gen p mean: -0.21866600215435028, mean p set: 0.44847849011421204
loss_pred:0.014750145375728607, decouple_loss:0.0019186045974493027
The modified gen p mean: 0.4459208846092224, gen p mean: -0.21604999899864197, mean p set: 0.44649171829223633
loss_pred:0.01535127218812704, decouple_loss:0.002159857889637351
Iteration: 3024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469439387321472, gen p mean: -0.2189507782459259, mean p set: 0.44747447967529297
loss_pred:0.014737979508936405, decouple_loss:0.0021907533518970013
The modified gen p mean: 0.44685205817222595, gen p mean: -0.2211504876613617, mean p set: 0.44742488861083984
loss_pred:0.015730902552604675, decouple_loss:0.002277749590575695
The modified gen p mean: 0.4485618472099304, gen p mean: -0.22278115153312683, mean p set: 0.44913914799690247
loss_pred:0.01524847000837326, decouple_loss:0.0022244276478886604
Iteration: 3025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794991612434387, gen p mean: -0.21988388895988464, mean p set: 0.4485243558883667
loss_pred:0.014507639221847057, decouple_loss:0.0022435535211116076
The modified gen p mean: 0.445923388004303, gen p mean: -0.22188103199005127, mean p set: 0.4464513063430786The modified gen p mean: 0.44605642557144165, gen p mean: -0.21957948803901672, mean p set: 0.4466347098350525
loss_pred:0.01551423966884613, decouple_loss:0.0020368860568851233
loss_pred:0.014655535109341145, decouple_loss:0.002162666991353035
Iteration: 3026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482511878013611, gen p mean: -0.2233126163482666, mean p set: 0.4488321542739868
loss_pred:0.014585214667022228, decouple_loss:0.002220548689365387
The modified gen p mean: 0.4483948349952698, gen p mean: -0.22852763533592224, mean p set: 0.4489142596721649The modified gen p mean: 0.4478573203086853, gen p mean: -0.22396431863307953, mean p set: 0.44843539595603943
loss_pred:0.014393315650522709, decouple_loss:0.0018831155030056834
loss_pred:0.014506860636174679, decouple_loss:0.0022405998315662146
Iteration: 3027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469350576400757, gen p mean: -0.22603996098041534, mean p set: 0.4475022256374359
loss_pred:0.014912237413227558, decouple_loss:0.0024976155254989862
The modified gen p mean: 0.44612982869148254, gen p mean: -0.2265203446149826, mean p set: 0.4467092752456665
loss_pred:0.015525986440479755, decouple_loss:0.0027318671345710754
The modified gen p mean: 0.448208749294281, gen p mean: -0.22604450583457947, mean p set: 0.44873204827308655
loss_pred:0.014187696389853954, decouple_loss:0.0023018254432827234
Iteration: 3028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666793942451477, gen p mean: -0.2222074419260025, mean p set: 0.4472406804561615
loss_pred:0.015206198208034039, decouple_loss:0.0021062418818473816
The modified gen p mean: 0.44715195894241333, gen p mean: -0.22192871570587158, mean p set: 0.44768208265304565
loss_pred:0.014376402832567692, decouple_loss:0.002024643123149872
The modified gen p mean: 0.4480506479740143, gen p mean: -0.22722746431827545, mean p set: 0.4486336410045624
loss_pred:0.014857511967420578, decouple_loss:0.002052072901278734
Iteration: 3029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794216752052307, gen p mean: -0.22423483431339264, mean p set: 0.4485151767730713
loss_pred:0.014439198188483715, decouple_loss:0.002045621629804373
The modified gen p mean: 0.44704386591911316, gen p mean: -0.22393755614757538, mean p set: 0.44757208228111267The modified gen p mean: 0.44649675488471985, gen p mean: -0.2232905924320221, mean p set: 0.4470709264278412
loss_pred:0.015734540298581123, decouple_loss:0.0020988432224839926
loss_pred:0.014530764892697334, decouple_loss:0.00214591296389699
Iteration: 3030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713494181632996, gen p mean: -0.22293755412101746, mean p set: 0.4477066397666931
loss_pred:0.014866987243294716, decouple_loss:0.0020335596054792404
The modified gen p mean: 0.4476093053817749, gen p mean: -0.22723928093910217, mean p set: 0.44818755984306335
loss_pred:0.01500155683606863, decouple_loss:0.002051001414656639
The modified gen p mean: 0.4468309283256531, gen p mean: -0.22024455666542053, mean p set: 0.4473552703857422
loss_pred:0.014953541569411755, decouple_loss:0.0022122415248304605
2023-04-27 13:38:20 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22237415611743927, mean p set: 0.4499112665653229
loss_pred:0.015773871913552284, decouple_loss:0.0018919417634606361
The modified gen p mean: 0.44822585582733154, gen p mean: -0.21951232850551605, mean p set: 0.44879910349845886
loss_pred:0.015679454430937767, decouple_loss:0.0019364848267287016
The modified gen p mean: 0.4493020176887512, gen p mean: -0.22232158482074738, mean p set: 0.4498290419578552
loss_pred:0.015334950760006905, decouple_loss:0.00205571879632771
WV_1_PC_1_EH_0_PS_30, loss: 0.015694161877036095, avg_mse: 0.02314438857138157
current test mse: 0.023144
Iteration: 3031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465656280517578, gen p mean: -0.22316783666610718, mean p set: 0.44714486598968506
loss_pred:0.015029934234917164, decouple_loss:0.0018606381490826607
The modified gen p mean: 0.4463876783847809, gen p mean: -0.22232477366924286, mean p set: 0.44696107506752014
loss_pred:0.015018312260508537, decouple_loss:0.0018984682392328978
The modified gen p mean: 0.4465724527835846, gen p mean: -0.22443710267543793, mean p set: 0.44710099697113037
loss_pred:0.014420534484088421, decouple_loss:0.001939537818543613
Iteration: 3032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447623074054718, gen p mean: -0.2225424349308014, mean p set: 0.4481431543827057
loss_pred:0.014558815397322178, decouple_loss:0.0019852640107274055
The modified gen p mean: 0.4487132132053375, gen p mean: -0.22586005926132202, mean p set: 0.44928810000419617
loss_pred:0.014838647097349167, decouple_loss:0.002322989283129573
The modified gen p mean: 0.4474049508571625, gen p mean: -0.22407518327236176, mean p set: 0.4479806125164032
loss_pred:0.014632483944296837, decouple_loss:0.001985341077670455
Iteration: 3033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44598060846328735, gen p mean: -0.22662045061588287, mean p set: 0.44651445746421814
loss_pred:0.014237401075661182, decouple_loss:0.0017894143238663673
The modified gen p mean: 0.4451376795768738, gen p mean: -0.22710533440113068, mean p set: 0.44571492075920105
loss_pred:0.01440941821783781, decouple_loss:0.0018652328290045261
The modified gen p mean: 0.4456448256969452, gen p mean: -0.2233448028564453, mean p set: 0.4462227523326874
loss_pred:0.014301897957921028, decouple_loss:0.0019403926562517881
Iteration: 3034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463460147380829, gen p mean: -0.22313256561756134, mean p set: 0.44687342643737793
loss_pred:0.015508403070271015, decouple_loss:0.0019455645233392715
The modified gen p mean: 0.4487176835536957, gen p mean: -0.225361168384552, mean p set: 0.44929662346839905
loss_pred:0.014478828758001328, decouple_loss:0.0019566381815820932
The modified gen p mean: 0.4454839825630188, gen p mean: -0.22495892643928528, mean p set: 0.4460570514202118
loss_pred:0.014287563040852547, decouple_loss:0.0019837473519146442
Iteration: 3035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480704963207245, gen p mean: -0.22041839361190796, mean p set: 0.4486530125141144
loss_pred:0.015499020926654339, decouple_loss:0.0019489687401801348
The modified gen p mean: 0.44777369499206543, gen p mean: -0.22086241841316223, mean p set: 0.4483468234539032
loss_pred:0.014270348474383354, decouple_loss:0.0019287706818431616
The modified gen p mean: 0.44640469551086426, gen p mean: -0.21900200843811035, mean p set: 0.4469250440597534
loss_pred:0.01583334058523178, decouple_loss:0.002063496969640255
Iteration: 3036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44629424810409546, gen p mean: -0.2168610841035843, mean p set: 0.44687098264694214
loss_pred:0.014178824611008167, decouple_loss:0.00191734847612679
The modified gen p mean: 0.44822022318840027, gen p mean: -0.21761661767959595, mean p set: 0.4487445652484894The modified gen p mean: 0.4471423327922821, gen p mean: -0.21432222425937653, mean p set: 0.4477138817310333
loss_pred:0.014646768569946289, decouple_loss:0.0019500229973345995
loss_pred:0.014724011532962322, decouple_loss:0.002081801649183035
Iteration: 3037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765278697013855, gen p mean: -0.21827200055122375, mean p set: 0.44823282957077026
loss_pred:0.0152042331174016, decouple_loss:0.002056036377325654
The modified gen p mean: 0.44658583402633667, gen p mean: -0.21452458202838898, mean p set: 0.4471120834350586The modified gen p mean: 0.4485107362270355, gen p mean: -0.22273334860801697, mean p set: 0.449090838432312
loss_pred:0.014550608582794666, decouple_loss:0.002115265466272831
loss_pred:0.01475493423640728, decouple_loss:0.001973406644538045
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472019672393799, gen p mean: -0.21344681084156036, mean p set: 0.44777190685272217
loss_pred:0.01408365834504366, decouple_loss:0.002008838579058647
The modified gen p mean: 0.4477349817752838, gen p mean: -0.21540115773677826, mean p set: 0.4483067989349365
loss_pred:0.015306320041418076, decouple_loss:0.0021550357341766357
The modified gen p mean: 0.4487513303756714, gen p mean: -0.222660094499588, mean p set: 0.44927650690078735
loss_pred:0.014295747503638268, decouple_loss:0.0019464644137769938
Iteration: 3039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465971887111664, gen p mean: -0.22223810851573944, mean p set: 0.44717034697532654
loss_pred:0.015470046550035477, decouple_loss:0.0020627810154110193
The modified gen p mean: 0.44805845618247986, gen p mean: -0.22153766453266144, mean p set: 0.4486321210861206
loss_pred:0.014429356902837753, decouple_loss:0.0017871573800221086
The modified gen p mean: 0.44648119807243347, gen p mean: -0.22145670652389526, mean p set: 0.44701406359672546
loss_pred:0.01543815154582262, decouple_loss:0.002009188523516059
Iteration: 3040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473342001438141, gen p mean: -0.22156347334384918, mean p set: 0.4479168951511383
loss_pred:0.014161826111376286, decouple_loss:0.0021332253236323595
The modified gen p mean: 0.44891664385795593, gen p mean: -0.22772400081157684, mean p set: 0.44949212670326233The modified gen p mean: 0.44724053144454956, gen p mean: -0.2219313085079193, mean p set: 0.4477720260620117
loss_pred:0.014366270042955875, decouple_loss:0.002140643773600459
loss_pred:0.014569194987416267, decouple_loss:0.0020477352663874626
2023-04-27 13:41:45 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22718173265457153, mean p set: 0.4499112665653229
loss_pred:0.015765905380249023, decouple_loss:0.00201793247833848
The modified gen p mean: 0.44930580258369446, gen p mean: -0.22697608172893524, mean p set: 0.4498290419578552
loss_pred:0.0153108611702919, decouple_loss:0.0019771999213844538
The modified gen p mean: 0.44822177290916443, gen p mean: -0.22426261007785797, mean p set: 0.44879910349845886
loss_pred:0.015693295747041702, decouple_loss:0.002010417403653264
WV_1_PC_1_EH_0_PS_30, loss: 0.015690114349126816, avg_mse: 0.023136081174016
current test mse: 0.023136
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 3041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866693019866943, gen p mean: -0.22006502747535706, mean p set: 0.44919553399086
loss_pred:0.014652909711003304, decouple_loss:0.002314833225682378
The modified gen p mean: 0.44751885533332825, gen p mean: -0.22597582638263702, mean p set: 0.4480898678302765
loss_pred:0.014728235080838203, decouple_loss:0.002243757015094161
The modified gen p mean: 0.4491354823112488, gen p mean: -0.22051337361335754, mean p set: 0.44971105456352234
loss_pred:0.014577751979231834, decouple_loss:0.0023519080132246017
Iteration: 3042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496675729751587, gen p mean: -0.22895018756389618, mean p set: 0.45019209384918213
loss_pred:0.015199922025203705, decouple_loss:0.0019029078539460897
The modified gen p mean: 0.4485929310321808, gen p mean: -0.22644096612930298, mean p set: 0.44916436076164246
The modified gen p mean: 0.4493381679058075, gen p mean: -0.22608491778373718, mean p set: 0.44992080330848694
loss_pred:0.014330961741507053, decouple_loss:0.0020479841623455286
loss_pred:0.015374189242720604, decouple_loss:0.0019250183831900358
Iteration: 3043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803255796432495, gen p mean: -0.22469562292099, mean p set: 0.44856372475624084
loss_pred:0.01431015320122242, decouple_loss:0.0020016871858388186
The modified gen p mean: 0.44904470443725586, gen p mean: -0.2159070074558258, mean p set: 0.4496217370033264
The modified gen p mean: 0.44789060950279236, gen p mean: -0.22980709373950958, mean p set: 0.448469340801239
loss_pred:0.014049866236746311, decouple_loss:0.002152455970644951
loss_pred:0.014193318784236908, decouple_loss:0.0022462995257228613
Iteration: 3044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487733542919159, gen p mean: -0.22388941049575806, mean p set: 0.44930025935173035
loss_pred:0.014135065488517284, decouple_loss:0.00196249783039093
The modified gen p mean: 0.4476126432418823, gen p mean: -0.21706955134868622, mean p set: 0.4481886029243469
The modified gen p mean: 0.44868558645248413, gen p mean: -0.22166810929775238, mean p set: 0.44925642013549805
loss_pred:0.014421898871660233, decouple_loss:0.001933552441187203
loss_pred:0.014942426234483719, decouple_loss:0.002146675018593669
Iteration: 3045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962823390960693, gen p mean: -0.22102324664592743, mean p set: 0.450207382440567
loss_pred:0.014179317280650139, decouple_loss:0.0024461960420012474
The modified gen p mean: 0.4500993490219116, gen p mean: -0.2188965380191803, mean p set: 0.4506753385066986The modified gen p mean: 0.4491763710975647, gen p mean: -0.22222425043582916, mean p set: 0.4497077465057373
loss_pred:0.014297268353402615, decouple_loss:0.0026242618914693594
loss_pred:0.014359298162162304, decouple_loss:0.002241494134068489
Iteration: 3046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478432238101959, gen p mean: -0.22534888982772827, mean p set: 0.4484257698059082
loss_pred:0.014672641642391682, decouple_loss:0.0021222287323325872
The modified gen p mean: 0.44751766324043274, gen p mean: -0.22069640457630157, mean p set: 0.4480970501899719The modified gen p mean: 0.4483770430088043, gen p mean: -0.2208043932914734, mean p set: 0.4489034116268158
loss_pred:0.014212053269147873, decouple_loss:0.0023243287578225136
loss_pred:0.014190485700964928, decouple_loss:0.002564899390563369
Iteration: 3047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477722942829132, gen p mean: -0.22343094646930695, mean p set: 0.44834965467453003
loss_pred:0.015155906789004803, decouple_loss:0.00238664704374969
The modified gen p mean: 0.4482607841491699, gen p mean: -0.22549742460250854, mean p set: 0.44883859157562256The modified gen p mean: 0.44913044571876526, gen p mean: -0.22034192085266113, mean p set: 0.44965940713882446
loss_pred:0.013872665353119373, decouple_loss:0.002243419410660863
loss_pred:0.013780192472040653, decouple_loss:0.0023808982223272324
Iteration: 3048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447744220495224, gen p mean: -0.22072887420654297, mean p set: 0.4483124613761902
loss_pred:0.014007956720888615, decouple_loss:0.0020725575741380453
The modified gen p mean: 0.44868040084838867, gen p mean: -0.22123973071575165, mean p set: 0.4492567181587219
loss_pred:0.014523004181683064, decouple_loss:0.002183326752856374
The modified gen p mean: 0.44846588373184204, gen p mean: -0.22134989500045776, mean p set: 0.44900044798851013
loss_pred:0.014176566153764725, decouple_loss:0.0022594062611460686
Iteration: 3049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934865832328796, gen p mean: -0.22426213324069977, mean p set: 0.4499247372150421
loss_pred:0.013809652999043465, decouple_loss:0.002080590231344104
The modified gen p mean: 0.4484832286834717, gen p mean: -0.22248125076293945, mean p set: 0.44905519485473633
loss_pred:0.014410321600735188, decouple_loss:0.0022902165073901415
The modified gen p mean: 0.4483044445514679, gen p mean: -0.22654418647289276, mean p set: 0.4488309919834137
loss_pred:0.014932761900126934, decouple_loss:0.002256020437926054
Iteration: 3050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473482370376587, gen p mean: -0.22814279794692993, mean p set: 0.4479256868362427
loss_pred:0.014161661267280579, decouple_loss:0.002229010686278343
The modified gen p mean: 0.448451966047287, gen p mean: -0.22272072732448578, mean p set: 0.4490225911140442
loss_pred:0.014562682248651981, decouple_loss:0.002264579525217414
The modified gen p mean: 0.4486020505428314, gen p mean: -0.21922169625759125, mean p set: 0.44913092255592346
loss_pred:0.014361601322889328, decouple_loss:0.0021159902680665255
2023-04-27 13:46:09 testing...
The modified gen p mean: 0.4482276141643524, gen p mean: -0.2179667204618454, mean p set: 0.44879910349845886
loss_pred:0.015789536759257317, decouple_loss:0.002181657589972019
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22082674503326416, mean p set: 0.4499112665653229
loss_pred:0.015855003148317337, decouple_loss:0.0021619980689138174
The modified gen p mean: 0.44929757714271545, gen p mean: -0.22087907791137695, mean p set: 0.4498290419578552
loss_pred:0.015377090312540531, decouple_loss:0.0022218450903892517
WV_1_PC_1_EH_0_PS_30, loss: 0.01578330248594284, avg_mse: 0.023301249369978905
current test mse: 0.023301
Iteration: 3051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483044147491455, gen p mean: -0.21891933679580688, mean p set: 0.4488828480243683
loss_pred:0.0146351158618927, decouple_loss:0.0023905353154987097
The modified gen p mean: 0.448575884103775, gen p mean: -0.2246571183204651, mean p set: 0.449150025844574
loss_pred:0.014153541997075081, decouple_loss:0.002072787843644619
The modified gen p mean: 0.4474286735057831, gen p mean: -0.22384382784366608, mean p set: 0.4479579031467438
loss_pred:0.014407414011657238, decouple_loss:0.0023155759554356337
Iteration: 3052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890516996383667, gen p mean: -0.21707162261009216, mean p set: 0.449429988861084
loss_pred:0.014823776669800282, decouple_loss:0.0019284497248008847
The modified gen p mean: 0.44706323742866516, gen p mean: -0.22050465643405914, mean p set: 0.4476362466812134
loss_pred:0.015071570873260498, decouple_loss:0.0022264563012868166
The modified gen p mean: 0.44773027300834656, gen p mean: -0.21764938533306122, mean p set: 0.44830384850502014
loss_pred:0.0138285206630826, decouple_loss:0.0019894710276275873
Iteration: 3053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788721203804016, gen p mean: -0.21498188376426697, mean p set: 0.44841691851615906
loss_pred:0.013924621976912022, decouple_loss:0.0021558005828410387
The modified gen p mean: 0.4487081468105316, gen p mean: -0.21698063611984253, mean p set: 0.4492858350276947
loss_pred:0.013804946094751358, decouple_loss:0.002424454316496849
The modified gen p mean: 0.4484993517398834, gen p mean: -0.21703776717185974, mean p set: 0.4490686058998108
loss_pred:0.014904828742146492, decouple_loss:0.002625643275678158
Iteration: 3054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449919730424881, gen p mean: -0.21812216937541962, mean p set: 0.4504498541355133
loss_pred:0.014023386873304844, decouple_loss:0.002220678376033902
The modified gen p mean: 0.44866621494293213, gen p mean: -0.21640735864639282, mean p set: 0.4492400586605072
loss_pred:0.014976650476455688, decouple_loss:0.0021365168504416943
The modified gen p mean: 0.4488793909549713, gen p mean: -0.2189960479736328, mean p set: 0.44945937395095825
loss_pred:0.013179762288928032, decouple_loss:0.0019963644444942474
Iteration: 3055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798576831817627, gen p mean: -0.2193886935710907, mean p set: 0.4485659599304199
loss_pred:0.014508632011711597, decouple_loss:0.00221587554551661
The modified gen p mean: 0.4484010338783264, gen p mean: -0.2178521752357483, mean p set: 0.44897738099098206
loss_pred:0.013822965323925018, decouple_loss:0.002236452652141452
The modified gen p mean: 0.4494021534919739, gen p mean: -0.21832230687141418, mean p set: 0.44993188977241516
loss_pred:0.014431550167500973, decouple_loss:0.002211356535553932
Iteration: 3056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480886459350586, gen p mean: -0.2209143489599228, mean p set: 0.44866296648979187
loss_pred:0.01481158472597599, decouple_loss:0.0023463480174541473
The modified gen p mean: 0.4484887421131134, gen p mean: -0.22307556867599487, mean p set: 0.4490663409233093The modified gen p mean: 0.4477968215942383, gen p mean: -0.22147950530052185, mean p set: 0.44832542538642883
loss_pred:0.013996163383126259, decouple_loss:0.0027317225467413664
loss_pred:0.014722106046974659, decouple_loss:0.0023854528553783894
Iteration: 3057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447590172290802, gen p mean: -0.2156355232000351, mean p set: 0.4481671154499054
loss_pred:0.014084693044424057, decouple_loss:0.0024019114207476377
The modified gen p mean: 0.4483160972595215, gen p mean: -0.22406569123268127, mean p set: 0.4488929510116577The modified gen p mean: 0.44787415862083435, gen p mean: -0.21637117862701416, mean p set: 0.44840162992477417
loss_pred:0.014654146507382393, decouple_loss:0.0022887899540364742
loss_pred:0.013845566660165787, decouple_loss:0.002343330532312393
Iteration: 3058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487245976924896, gen p mean: -0.21514996886253357, mean p set: 0.44930222630500793
loss_pred:0.014368672855198383, decouple_loss:0.0025803493335843086
The modified gen p mean: 0.4480639696121216, gen p mean: -0.22168760001659393, mean p set: 0.4486420452594757The modified gen p mean: 0.4481196701526642, gen p mean: -0.2231374830007553, mean p set: 0.4486553370952606
loss_pred:0.014936191029846668, decouple_loss:0.0023636759724467993
loss_pred:0.014637158252298832, decouple_loss:0.002494682790711522
Iteration: 3059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479188024997711, gen p mean: -0.2223241776227951, mean p set: 0.4484882652759552
loss_pred:0.014025297947227955, decouple_loss:0.002427063649520278
The modified gen p mean: 0.44724389910697937, gen p mean: -0.2225000262260437, mean p set: 0.4478180706501007
loss_pred:0.01522344071418047, decouple_loss:0.0024976138956844807
The modified gen p mean: 0.4483610987663269, gen p mean: -0.22190776467323303, mean p set: 0.4488871097564697
loss_pred:0.014047537930309772, decouple_loss:0.00236109527759254
Iteration: 3060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488590359687805, gen p mean: -0.21972478926181793, mean p set: 0.44943690299987793
loss_pred:0.014092999510467052, decouple_loss:0.002007869305089116
The modified gen p mean: 0.44875481724739075, gen p mean: -0.21669450402259827, mean p set: 0.44932955503463745
loss_pred:0.014547808095812798, decouple_loss:0.00224135909229517
The modified gen p mean: 0.4491223692893982, gen p mean: -0.22399713099002838, mean p set: 0.4496510326862335
loss_pred:0.014282545074820518, decouple_loss:0.0024941423907876015
2023-04-27 13:49:34 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21782401204109192, mean p set: 0.4499112665653229
loss_pred:0.015858260914683342, decouple_loss:0.0022474839352071285
The modified gen p mean: 0.4493004381656647, gen p mean: -0.21801120042800903, mean p set: 0.4498290419578552
loss_pred:0.015360481105744839, decouple_loss:0.0024110109079629183
The modified gen p mean: 0.4482234716415405, gen p mean: -0.21499493718147278, mean p set: 0.44879910349845886
loss_pred:0.01583462581038475, decouple_loss:0.002254523802548647
WV_1_PC_1_EH_0_PS_30, loss: 0.015799671411514282, avg_mse: 0.023276744410395622
current test mse: 0.023277
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 3061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491494297981262, gen p mean: -0.22059814631938934, mean p set: 0.4496730864048004
loss_pred:0.01555906143039465, decouple_loss:0.0023305793292820454
The modified gen p mean: 0.4473194181919098, gen p mean: -0.2216721475124359, mean p set: 0.44789400696754456
loss_pred:0.015498568303883076, decouple_loss:0.002270516473799944
The modified gen p mean: 0.4485156536102295, gen p mean: -0.21743528544902802, mean p set: 0.44908908009529114
loss_pred:0.015352615155279636, decouple_loss:0.002302134409546852
Iteration: 3062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483669102191925, gen p mean: -0.2158823013305664, mean p set: 0.4488926827907562
loss_pred:0.015674801543354988, decouple_loss:0.0020229117944836617
The modified gen p mean: 0.448028564453125, gen p mean: -0.21966901421546936, mean p set: 0.44860783219337463
The modified gen p mean: 0.4481271207332611, gen p mean: -0.21586427092552185, mean p set: 0.44869568943977356
loss_pred:0.014650099910795689, decouple_loss:0.0021774843335151672
loss_pred:0.015115159563720226, decouple_loss:0.001996307633817196
Iteration: 3063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823089241981506, gen p mean: -0.2207997590303421, mean p set: 0.4487592875957489
loss_pred:0.016028236597776413, decouple_loss:0.0020228344947099686
The modified gen p mean: 0.44767576456069946, gen p mean: -0.2206769585609436, mean p set: 0.4482552707195282
The modified gen p mean: 0.4484911859035492, gen p mean: -0.2210700958967209, mean p set: 0.4490683674812317
loss_pred:0.015308675356209278, decouple_loss:0.0023901164531707764
loss_pred:0.014616195112466812, decouple_loss:0.0018907638732343912
Iteration: 3064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476347267627716, gen p mean: -0.2261614203453064, mean p set: 0.44816285371780396
loss_pred:0.014320735819637775, decouple_loss:0.0021344234701246023
The modified gen p mean: 0.4472810626029968, gen p mean: -0.2209826111793518, mean p set: 0.44785773754119873
The modified gen p mean: 0.4483473300933838, gen p mean: -0.22288157045841217, mean p set: 0.44892382621765137
loss_pred:0.014793148264288902, decouple_loss:0.0026972368359565735
loss_pred:0.014739057049155235, decouple_loss:0.0023799350019544363
Iteration: 3065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470110833644867, gen p mean: -0.22613851726055145, mean p set: 0.44758591055870056
loss_pred:0.014404287561774254, decouple_loss:0.0017873378237709403
The modified gen p mean: 0.44716060161590576, gen p mean: -0.223697692155838, mean p set: 0.447688490152359The modified gen p mean: 0.44826677441596985, gen p mean: -0.2234736680984497, mean p set: 0.4488394856452942
loss_pred:0.014835795387625694, decouple_loss:0.001897113979794085
loss_pred:0.014850771985948086, decouple_loss:0.0017955180956050754
Iteration: 3066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807130098342896, gen p mean: -0.22437407076358795, mean p set: 0.4486456513404846
loss_pred:0.015261449851095676, decouple_loss:0.0023104920983314514
The modified gen p mean: 0.44804346561431885, gen p mean: -0.22512756288051605, mean p set: 0.44861847162246704The modified gen p mean: 0.4481830596923828, gen p mean: -0.22283190488815308, mean p set: 0.44871145486831665
loss_pred:0.01455616019666195, decouple_loss:0.002491367282345891
loss_pred:0.015521935187280178, decouple_loss:0.002042394829913974
Iteration: 3067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477606415748596, gen p mean: -0.22266484797000885, mean p set: 0.44833654165267944
loss_pred:0.014907031320035458, decouple_loss:0.0019300761632621288
The modified gen p mean: 0.4473503828048706, gen p mean: -0.22485964000225067, mean p set: 0.4478755593299866The modified gen p mean: 0.4475290775299072, gen p mean: -0.22310307621955872, mean p set: 0.4481090009212494
loss_pred:0.014916984364390373, decouple_loss:0.001825591898523271
loss_pred:0.014739936217665672, decouple_loss:0.001740921987220645
Iteration: 3068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479468762874603, gen p mean: -0.21971440315246582, mean p set: 0.44852176308631897
loss_pred:0.01544493529945612, decouple_loss:0.0019206719007343054
The modified gen p mean: 0.4490922689437866, gen p mean: -0.22045032680034637, mean p set: 0.4496676027774811The modified gen p mean: 0.4479998052120209, gen p mean: -0.21723951399326324, mean p set: 0.4485322833061218
loss_pred:0.015372337773442268, decouple_loss:0.00200586742721498
loss_pred:0.014646594412624836, decouple_loss:0.0019569883588701487
Iteration: 3069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477308690547943, gen p mean: -0.21642763912677765, mean p set: 0.4483044445514679
loss_pred:0.015313909389078617, decouple_loss:0.0020434947218745947
The modified gen p mean: 0.4484700560569763, gen p mean: -0.22041279077529907, mean p set: 0.4489997327327728The modified gen p mean: 0.4483170807361603, gen p mean: -0.21781738102436066, mean p set: 0.448894202709198
loss_pred:0.015682322904467583, decouple_loss:0.002024626126512885
loss_pred:0.014958745799958706, decouple_loss:0.0020473196636885405
Iteration: 3070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494131803512573, gen p mean: -0.21948876976966858, mean p set: 0.4499906599521637
loss_pred:0.014751233160495758, decouple_loss:0.0017818231135606766
The modified gen p mean: 0.4493646025657654, gen p mean: -0.22123461961746216, mean p set: 0.4499371349811554
loss_pred:0.01478989515453577, decouple_loss:0.002309585688635707
The modified gen p mean: 0.44705939292907715, gen p mean: -0.22091075778007507, mean p set: 0.4475880563259125
loss_pred:0.015122748911380768, decouple_loss:0.0019096474861726165
2023-04-27 13:53:48 testing...
The modified gen p mean: 0.44822654128074646, gen p mean: -0.22272823750972748, mean p set: 0.44879910349845886
loss_pred:0.01576276682317257, decouple_loss:0.002366929315030575
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22542187571525574, mean p set: 0.4499112665653229
loss_pred:0.015791060402989388, decouple_loss:0.0023133710492402315
The modified gen p mean: 0.4492962658405304, gen p mean: -0.22530052065849304, mean p set: 0.4498290419578552
loss_pred:0.01534165907651186, decouple_loss:0.002557373372837901
WV_1_PC_1_EH_0_PS_30, loss: 0.015752457082271576, avg_mse: 0.02314625307917595
current test mse: 0.023146
Iteration: 3071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741854071617126, gen p mean: -0.2244722694158554, mean p set: 0.44799840450286865
loss_pred:0.015368192456662655, decouple_loss:0.002434023655951023
The modified gen p mean: 0.4470568001270294, gen p mean: -0.22225652635097504, mean p set: 0.44762876629829407
loss_pred:0.016195492818951607, decouple_loss:0.002116500400006771
The modified gen p mean: 0.4480490982532501, gen p mean: -0.22682370245456696, mean p set: 0.44857507944107056
loss_pred:0.01447901502251625, decouple_loss:0.0021263251546770334
Iteration: 3072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474959969520569, gen p mean: -0.23384280502796173, mean p set: 0.4480244815349579
loss_pred:0.014813077636063099, decouple_loss:0.0017452961765229702
The modified gen p mean: 0.4472825825214386, gen p mean: -0.22965224087238312, mean p set: 0.4478580951690674
loss_pred:0.014472671784460545, decouple_loss:0.0019273727666586637
The modified gen p mean: 0.44856104254722595, gen p mean: -0.23100833594799042, mean p set: 0.4491422176361084
loss_pred:0.014988347887992859, decouple_loss:0.0019142194651067257
Iteration: 3073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482818841934204, gen p mean: -0.2291671186685562, mean p set: 0.44880983233451843
loss_pred:0.015762856230139732, decouple_loss:0.0028258038219064474
The modified gen p mean: 0.4471062421798706, gen p mean: -0.22773952782154083, mean p set: 0.4476771950721741
loss_pred:0.016080651432275772, decouple_loss:0.0027128399815410376
The modified gen p mean: 0.4471835792064667, gen p mean: -0.232387512922287, mean p set: 0.4477599561214447
loss_pred:0.01440181490033865, decouple_loss:0.002700141165405512
Iteration: 3074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485630691051483, gen p mean: -0.22542056441307068, mean p set: 0.4490887224674225
loss_pred:0.014309431426227093, decouple_loss:0.0021000909619033337
The modified gen p mean: 0.4481568932533264, gen p mean: -0.22451148927211761, mean p set: 0.4487335979938507
loss_pred:0.01498914510011673, decouple_loss:0.001967143500223756
The modified gen p mean: 0.4481557607650757, gen p mean: -0.2220735251903534, mean p set: 0.44872695207595825
loss_pred:0.015140539966523647, decouple_loss:0.001964329509064555
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837266206741333, gen p mean: -0.22182299196720123, mean p set: 0.44895321130752563
loss_pred:0.014452318660914898, decouple_loss:0.0021278359927237034
The modified gen p mean: 0.44731736183166504, gen p mean: -0.222878098487854, mean p set: 0.44789284467697144The modified gen p mean: 0.44751766324043274, gen p mean: -0.2240421324968338, mean p set: 0.44804567098617554
loss_pred:0.014615683816373348, decouple_loss:0.002262355526909232
loss_pred:0.01441620197147131, decouple_loss:0.002336959121748805
Iteration: 3076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496055543422699, gen p mean: -0.22907103598117828, mean p set: 0.4501863420009613
loss_pred:0.0150877945125103, decouple_loss:0.001902691787108779
The modified gen p mean: 0.44861212372779846, gen p mean: -0.22436946630477905, mean p set: 0.44918495416641235
loss_pred:0.014804007485508919, decouple_loss:0.0017722317716106772
The modified gen p mean: 0.4503291845321655, gen p mean: -0.2284136712551117, mean p set: 0.4508599638938904
loss_pred:0.014694621786475182, decouple_loss:0.0018489169888198376
Iteration: 3077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481949806213379, gen p mean: -0.22196467220783234, mean p set: 0.44876912236213684
loss_pred:0.015271324664354324, decouple_loss:0.0021432568319141865
The modified gen p mean: 0.4486943483352661, gen p mean: -0.2220747321844101, mean p set: 0.44922152161598206The modified gen p mean: 0.4476425051689148, gen p mean: -0.22522671520709991, mean p set: 0.44820985198020935
loss_pred:0.015355284325778484, decouple_loss:0.0021960402373224497
loss_pred:0.015158270485699177, decouple_loss:0.0019698706455528736
Iteration: 3078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474169909954071, gen p mean: -0.22453828155994415, mean p set: 0.44798803329467773
loss_pred:0.014618794433772564, decouple_loss:0.001996581209823489
The modified gen p mean: 0.44831740856170654, gen p mean: -0.22125132381916046, mean p set: 0.4488913416862488The modified gen p mean: 0.44728851318359375, gen p mean: -0.2273309975862503, mean p set: 0.4478192627429962
loss_pred:0.015770865604281425, decouple_loss:0.0018469891510903835
loss_pred:0.013879384845495224, decouple_loss:0.0019281762652099133
Iteration: 3079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477491080760956, gen p mean: -0.2249085158109665, mean p set: 0.44832760095596313
loss_pred:0.014520308934152126, decouple_loss:0.0020914808847010136
The modified gen p mean: 0.4476783573627472, gen p mean: -0.22430427372455597, mean p set: 0.44825538992881775
loss_pred:0.014619726687669754, decouple_loss:0.0019557953346520662
The modified gen p mean: 0.4475559890270233, gen p mean: -0.22169509530067444, mean p set: 0.4480845034122467
loss_pred:0.015391415916383266, decouple_loss:0.002053598640486598
Iteration: 3080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478491544723511, gen p mean: -0.22859059274196625, mean p set: 0.4484177529811859
loss_pred:0.014977536164224148, decouple_loss:0.0020346175879240036
The modified gen p mean: 0.44986480474472046, gen p mean: -0.22851265966892242, mean p set: 0.45043665170669556
loss_pred:0.01506292074918747, decouple_loss:0.0020119170658290386
The modified gen p mean: 0.44767066836357117, gen p mean: -0.22819045186042786, mean p set: 0.44819530844688416
loss_pred:0.014910677447915077, decouple_loss:0.001997529063373804
2023-04-27 13:57:14 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22765620052814484, mean p set: 0.4499112665653229
loss_pred:0.015819363296031952, decouple_loss:0.0022250711917877197
The modified gen p mean: 0.4492967128753662, gen p mean: -0.22773468494415283, mean p set: 0.4498290419578552
loss_pred:0.015335945412516594, decouple_loss:0.0020191259682178497
The modified gen p mean: 0.44822007417678833, gen p mean: -0.2254064977169037, mean p set: 0.44879910349845886
loss_pred:0.01569453813135624, decouple_loss:0.002226897282525897
WV_1_PC_1_EH_0_PS_30, loss: 0.01572446897625923, avg_mse: 0.023188870400190353
current test mse: 0.023189
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 3081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446384459733963, gen p mean: -0.2313053011894226, mean p set: 0.44691362977027893
loss_pred:0.014950815588235855, decouple_loss:0.0019965488463640213
The modified gen p mean: 0.4465744197368622, gen p mean: -0.22842247784137726, mean p set: 0.4471500515937805
loss_pred:0.015465892851352692, decouple_loss:0.002131978515535593
The modified gen p mean: 0.44602781534194946, gen p mean: -0.22458912432193756, mean p set: 0.4466037154197693
loss_pred:0.015242035500705242, decouple_loss:0.0020771981216967106
Iteration: 3082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675368070602417, gen p mean: -0.22680407762527466, mean p set: 0.44727569818496704
loss_pred:0.014730715192854404, decouple_loss:0.0018980398308485746
The modified gen p mean: 0.44688814878463745, gen p mean: -0.22861458361148834, mean p set: 0.44746461510658264
The modified gen p mean: 0.4462721049785614, gen p mean: -0.2285498082637787, mean p set: 0.446846604347229
loss_pred:0.014772975817322731, decouple_loss:0.0018928560893982649
loss_pred:0.014798750169575214, decouple_loss:0.0020752958953380585
Iteration: 3083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710642099380493, gen p mean: -0.22303402423858643, mean p set: 0.4476316571235657
loss_pred:0.01518379058688879, decouple_loss:0.0021886422764509916
The modified gen p mean: 0.446523517370224, gen p mean: -0.22280146181583405, mean p set: 0.4471038281917572
The modified gen p mean: 0.4465722143650055, gen p mean: -0.22566941380500793, mean p set: 0.4471467435359955
loss_pred:0.01507246121764183, decouple_loss:0.00220940331928432
loss_pred:0.014507565647363663, decouple_loss:0.0023173571098595858
Iteration: 3084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666725397109985, gen p mean: -0.22446125745773315, mean p set: 0.44719746708869934
loss_pred:0.01482826005667448, decouple_loss:0.0019736471585929394
The modified gen p mean: 0.4464201033115387, gen p mean: -0.22636033594608307, mean p set: 0.44699564576148987
The modified gen p mean: 0.44695302844047546, gen p mean: -0.22313816845417023, mean p set: 0.44753265380859375
loss_pred:0.01503757480531931, decouple_loss:0.002037683967500925
loss_pred:0.014545323327183723, decouple_loss:0.001973358215764165
Iteration: 3085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463399350643158, gen p mean: -0.22127282619476318, mean p set: 0.44691479206085205
loss_pred:0.015304847620427608, decouple_loss:0.0022172124590724707
The modified gen p mean: 0.4474959075450897, gen p mean: -0.22191715240478516, mean p set: 0.44807347655296326
loss_pred:0.014814384281635284, decouple_loss:0.002081742975860834
The modified gen p mean: 0.44695863127708435, gen p mean: -0.22471582889556885, mean p set: 0.44748565554618835
loss_pred:0.014525877311825752, decouple_loss:0.0022031550761312246
Iteration: 3086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474969506263733, gen p mean: -0.2167925238609314, mean p set: 0.44806838035583496
loss_pred:0.014321436174213886, decouple_loss:0.0020783026702702045
The modified gen p mean: 0.4467628002166748, gen p mean: -0.22001773118972778, mean p set: 0.44729331135749817The modified gen p mean: 0.44674578309059143, gen p mean: -0.22103430330753326, mean p set: 0.4473183751106262
loss_pred:0.015122800134122372, decouple_loss:0.0019490085542201996
loss_pred:0.01496043149381876, decouple_loss:0.002162169897928834
Iteration: 3087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44527894258499146, gen p mean: -0.2204047441482544, mean p set: 0.445857435464859
loss_pred:0.01515954453498125, decouple_loss:0.0024351354222744703
The modified gen p mean: 0.44707998633384705, gen p mean: -0.21680790185928345, mean p set: 0.44760966300964355The modified gen p mean: 0.4450835883617401, gen p mean: -0.21978642046451569, mean p set: 0.44565579295158386
loss_pred:0.014776628464460373, decouple_loss:0.0022827808279544115
loss_pred:0.015044552274048328, decouple_loss:0.00230503105558455
Iteration: 3088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665199518203735, gen p mean: -0.22157827019691467, mean p set: 0.44722166657447815
loss_pred:0.015229352749884129, decouple_loss:0.0019757510162889957
The modified gen p mean: 0.4469258189201355, gen p mean: -0.21983718872070312, mean p set: 0.44749704003334045
loss_pred:0.015476974658668041, decouple_loss:0.0019464055076241493
The modified gen p mean: 0.4465304911136627, gen p mean: -0.22097976505756378, mean p set: 0.44706007838249207
loss_pred:0.014288323000073433, decouple_loss:0.0019187196157872677
Iteration: 3089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446010559797287, gen p mean: -0.22592870891094208, mean p set: 0.44658660888671875
loss_pred:0.014810286462306976, decouple_loss:0.0021927955094724894
The modified gen p mean: 0.4462321102619171, gen p mean: -0.22671206295490265, mean p set: 0.44680705666542053
loss_pred:0.014813963323831558, decouple_loss:0.002431262517347932
The modified gen p mean: 0.44647645950317383, gen p mean: -0.2249731421470642, mean p set: 0.4470020830631256
loss_pred:0.014750255271792412, decouple_loss:0.002222947310656309
Iteration: 3090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446856826543808, gen p mean: -0.22016240656375885, mean p set: 0.4474301338195801
loss_pred:0.01454352866858244, decouple_loss:0.002064828062430024
The modified gen p mean: 0.44687920808792114, gen p mean: -0.22005771100521088, mean p set: 0.4474572241306305
loss_pred:0.014419740997254848, decouple_loss:0.0019622177351266146
The modified gen p mean: 0.44675934314727783, gen p mean: -0.22167140245437622, mean p set: 0.44728413224220276
loss_pred:0.014472708106040955, decouple_loss:0.0020063547417521477
2023-04-27 14:01:21 testing...
The modified gen p mean: 0.44822341203689575, gen p mean: -0.21865300834178925, mean p set: 0.44879910349845886
loss_pred:0.015776773914694786, decouple_loss:0.00262287724763155
The modified gen p mean: 0.449430912733078, gen p mean: -0.22094488143920898, mean p set: 0.4499112665653229
loss_pred:0.015765050426125526, decouple_loss:0.002519227098673582
The modified gen p mean: 0.44930145144462585, gen p mean: -0.22116056084632874, mean p set: 0.4498290419578552
loss_pred:0.015324681997299194, decouple_loss:0.0028462831396609545
WV_1_PC_1_EH_0_PS_30, loss: 0.01575530879199505, avg_mse: 0.023172002285718918
current test mse: 0.023172
Iteration: 3091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455789625644684, gen p mean: -0.2238095998764038, mean p set: 0.4461512565612793
loss_pred:0.01458318717777729, decouple_loss:0.0029756948351860046
The modified gen p mean: 0.4467722475528717, gen p mean: -0.2198970764875412, mean p set: 0.4473506212234497
loss_pred:0.014925810508430004, decouple_loss:0.002266084076836705
The modified gen p mean: 0.44673240184783936, gen p mean: -0.22245049476623535, mean p set: 0.44726231694221497
loss_pred:0.01435163151472807, decouple_loss:0.0023448546417057514
Iteration: 3092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451539218425751, gen p mean: -0.2213170826435089, mean p set: 0.4456845819950104
loss_pred:0.014741266146302223, decouple_loss:0.0020867229904979467
The modified gen p mean: 0.44590434432029724, gen p mean: -0.21963128447532654, mean p set: 0.44647684693336487
loss_pred:0.015387475490570068, decouple_loss:0.0019407321233302355
The modified gen p mean: 0.4464302659034729, gen p mean: -0.21989303827285767, mean p set: 0.4469999372959137
loss_pred:0.014940338209271431, decouple_loss:0.0018441916909068823
Iteration: 3093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663870334625244, gen p mean: -0.2150811105966568, mean p set: 0.4471670687198639
loss_pred:0.014476911164820194, decouple_loss:0.0019530968274921179
The modified gen p mean: 0.4466879367828369, gen p mean: -0.22533667087554932, mean p set: 0.4472668468952179
loss_pred:0.014495423063635826, decouple_loss:0.0021667247638106346
The modified gen p mean: 0.4467180669307709, gen p mean: -0.21864281594753265, mean p set: 0.44730156660079956
loss_pred:0.014950506389141083, decouple_loss:0.002020582091063261
Iteration: 3094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452621042728424, gen p mean: -0.22124989330768585, mean p set: 0.44578808546066284
loss_pred:0.014704006724059582, decouple_loss:0.0019502606010064483
The modified gen p mean: 0.4476673901081085, gen p mean: -0.21607735753059387, mean p set: 0.4482450783252716
loss_pred:0.014671402983367443, decouple_loss:0.0018863442819565535
The modified gen p mean: 0.44599834084510803, gen p mean: -0.22333283722400665, mean p set: 0.4465794563293457
loss_pred:0.01474713534116745, decouple_loss:0.0018867620965465903
Iteration: 3095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835057854652405, gen p mean: -0.2239944487810135, mean p set: 0.4489297568798065
loss_pred:0.014004708267748356, decouple_loss:0.0026425467804074287
The modified gen p mean: 0.4471926987171173, gen p mean: -0.21967266499996185, mean p set: 0.4477251172065735The modified gen p mean: 0.4459594786167145, gen p mean: -0.22094963490962982, mean p set: 0.44653791189193726
loss_pred:0.01487039402127266, decouple_loss:0.0022064088843762875
loss_pred:0.014771679416298866, decouple_loss:0.0020526631269603968
Iteration: 3096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462483823299408, gen p mean: -0.2281438410282135, mean p set: 0.44682133197784424
loss_pred:0.01472256425768137, decouple_loss:0.0017487856093794107
The modified gen p mean: 0.4476502239704132, gen p mean: -0.22166086733341217, mean p set: 0.44818106293678284The modified gen p mean: 0.4469641149044037, gen p mean: -0.2247542440891266, mean p set: 0.4475364685058594
loss_pred:0.014393160119652748, decouple_loss:0.0022989336866885424
loss_pred:0.014276068657636642, decouple_loss:0.0021853086072951555
Iteration: 3097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471604526042938, gen p mean: -0.2280169129371643, mean p set: 0.4477333426475525
loss_pred:0.015697378665208817, decouple_loss:0.0018887220649048686
The modified gen p mean: 0.4460194706916809, gen p mean: -0.22648657858371735, mean p set: 0.4465474784374237The modified gen p mean: 0.44747111201286316, gen p mean: -0.22856903076171875, mean p set: 0.4480440020561218
loss_pred:0.014305809512734413, decouple_loss:0.002161178505048156
loss_pred:0.014609124511480331, decouple_loss:0.002560949418693781
Iteration: 3098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665759801864624, gen p mean: -0.22950802743434906, mean p set: 0.447183758020401
loss_pred:0.014823044650256634, decouple_loss:0.0022808145731687546
The modified gen p mean: 0.44725343585014343, gen p mean: -0.23419876396656036, mean p set: 0.44782721996307373
loss_pred:0.014357673935592175, decouple_loss:0.002436421113088727
The modified gen p mean: 0.44677913188934326, gen p mean: -0.2309110313653946, mean p set: 0.4473608434200287
loss_pred:0.014874226413667202, decouple_loss:0.0021764521952718496
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731178879737854, gen p mean: -0.2273051142692566, mean p set: 0.44788506627082825
loss_pred:0.014450594782829285, decouple_loss:0.0018471627263352275
The modified gen p mean: 0.4465213119983673, gen p mean: -0.2316516637802124, mean p set: 0.44709545373916626
loss_pred:0.014564111828804016, decouple_loss:0.00200254051014781
The modified gen p mean: 0.4479049742221832, gen p mean: -0.23100648820400238, mean p set: 0.44842633605003357
loss_pred:0.014215311035513878, decouple_loss:0.0024658257607370615
Iteration: 3100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462340176105499, gen p mean: -0.2247849851846695, mean p set: 0.446819543838501
loss_pred:0.014823871664702892, decouple_loss:0.0027181622572243214
The modified gen p mean: 0.4467541575431824, gen p mean: -0.22874689102172852, mean p set: 0.44728177785873413The modified gen p mean: 0.4464725852012634, gen p mean: -0.22285446524620056, mean p set: 0.44704607129096985
loss_pred:0.014257722534239292, decouple_loss:0.0022364198230206966
loss_pred:0.014497553929686546, decouple_loss:0.002179986098781228
2023-04-27 14:04:46 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22343173623085022, mean p set: 0.4499112665653229
loss_pred:0.015721093863248825, decouple_loss:0.002280761953443289
The modified gen p mean: 0.4492984414100647, gen p mean: -0.22398002445697784, mean p set: 0.4498290419578552
loss_pred:0.015366476029157639, decouple_loss:0.002085660817101598
The modified gen p mean: 0.4482181668281555, gen p mean: -0.22103270888328552, mean p set: 0.44879910349845886
loss_pred:0.01581498235464096, decouple_loss:0.0022497819736599922
WV_1_PC_1_EH_0_PS_30, loss: 0.01574445515871048, avg_mse: 0.023192569613456726
current test mse: 0.023193
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 3101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471176564693451, gen p mean: -0.21892118453979492, mean p set: 0.44764676690101624
loss_pred:0.014795015566051006, decouple_loss:0.0024128134828060865
The modified gen p mean: 0.44706636667251587, gen p mean: -0.223659485578537, mean p set: 0.44764021039009094
loss_pred:0.015189304016530514, decouple_loss:0.002641618251800537
The modified gen p mean: 0.44681859016418457, gen p mean: -0.22350434958934784, mean p set: 0.44739529490470886
loss_pred:0.014290930703282356, decouple_loss:0.002024143934249878
Iteration: 3102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658398628234863, gen p mean: -0.21528780460357666, mean p set: 0.4471050798892975
loss_pred:0.013995113782584667, decouple_loss:0.002538184402510524
The modified gen p mean: 0.44679638743400574, gen p mean: -0.22741061449050903, mean p set: 0.4473738372325897
The modified gen p mean: 0.44693973660469055, gen p mean: -0.22218161821365356, mean p set: 0.44751641154289246
loss_pred:0.013817952945828438, decouple_loss:0.00266052084043622
loss_pred:0.014381020329892635, decouple_loss:0.002597229555249214
Iteration: 3103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482019245624542, gen p mean: -0.21986015141010284, mean p set: 0.44872787594795227
loss_pred:0.013694409281015396, decouple_loss:0.0023336003068834543
The modified gen p mean: 0.44721508026123047, gen p mean: -0.22421982884407043, mean p set: 0.4477875828742981The modified gen p mean: 0.446548730134964, gen p mean: -0.22691817581653595, mean p set: 0.44713205099105835
loss_pred:0.014987663365900517, decouple_loss:0.0025888734962791204loss_pred:0.014434924349188805, decouple_loss:0.00260149990208447
Iteration: 3104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474964737892151, gen p mean: -0.2290259599685669, mean p set: 0.4480327367782593
loss_pred:0.014421115629374981, decouple_loss:0.002053752774372697
The modified gen p mean: 0.447712779045105, gen p mean: -0.2247554212808609, mean p set: 0.4482881724834442
The modified gen p mean: 0.44808077812194824, gen p mean: -0.224136084318161, mean p set: 0.4486611485481262
loss_pred:0.014351028017699718, decouple_loss:0.002013215096667409
loss_pred:0.015001395717263222, decouple_loss:0.002343515632674098
Iteration: 3105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447848916053772, gen p mean: -0.2210065722465515, mean p set: 0.44842812418937683
loss_pred:0.014529652893543243, decouple_loss:0.002116706920787692
The modified gen p mean: 0.44733279943466187, gen p mean: -0.22455908358097076, mean p set: 0.44785767793655396The modified gen p mean: 0.44674378633499146, gen p mean: -0.22029715776443481, mean p set: 0.44732168316841125
loss_pred:0.014139353297650814, decouple_loss:0.00255750585347414
loss_pred:0.015028662048280239, decouple_loss:0.0020107945892959833
Iteration: 3106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445997029542923, gen p mean: -0.21856793761253357, mean p set: 0.4465774595737457
loss_pred:0.015288565307855606, decouple_loss:0.001936318469233811
The modified gen p mean: 0.447798490524292, gen p mean: -0.21835178136825562, mean p set: 0.44832831621170044The modified gen p mean: 0.4486621916294098, gen p mean: -0.22093044221401215, mean p set: 0.44923636317253113
loss_pred:0.013777812011539936, decouple_loss:0.0020512999035418034
loss_pred:0.01489617582410574, decouple_loss:0.002011152682825923
Iteration: 3107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717249274253845, gen p mean: -0.21289265155792236, mean p set: 0.4477570950984955
loss_pred:0.014070700854063034, decouple_loss:0.0020233700051903725
The modified gen p mean: 0.4474153518676758, gen p mean: -0.2192113697528839, mean p set: 0.4479525089263916The modified gen p mean: 0.44830724596977234, gen p mean: -0.21218544244766235, mean p set: 0.44888240098953247
loss_pred:0.013954359106719494, decouple_loss:0.002145229373127222
loss_pred:0.014367971569299698, decouple_loss:0.002290249103680253
Iteration: 3108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802433252334595, gen p mean: -0.21029356122016907, mean p set: 0.44860100746154785
loss_pred:0.014217187650501728, decouple_loss:0.0020422579254955053
The modified gen p mean: 0.4463084638118744, gen p mean: -0.21018142998218536, mean p set: 0.44688504934310913
loss_pred:0.01404016837477684, decouple_loss:0.0020078164525330067
The modified gen p mean: 0.44691187143325806, gen p mean: -0.22027796506881714, mean p set: 0.44743743538856506
loss_pred:0.014710976742208004, decouple_loss:0.0020346513483673334
Iteration: 3109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473619759082794, gen p mean: -0.21660690009593964, mean p set: 0.447934627532959
loss_pred:0.014901883900165558, decouple_loss:0.0019640643149614334
The modified gen p mean: 0.446511447429657, gen p mean: -0.21450938284397125, mean p set: 0.44708362221717834
loss_pred:0.014390706084668636, decouple_loss:0.0019557636696845293
The modified gen p mean: 0.447338730096817, gen p mean: -0.20985935628414154, mean p set: 0.44786933064460754
loss_pred:0.01458693016320467, decouple_loss:0.001969394739717245
Iteration: 3110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476000666618347, gen p mean: -0.21583476662635803, mean p set: 0.44817930459976196
loss_pred:0.014439627528190613, decouple_loss:0.0018251128494739532
The modified gen p mean: 0.4470996856689453, gen p mean: -0.2143196314573288, mean p set: 0.4476839005947113
loss_pred:0.013279530219733715, decouple_loss:0.001906807068735361
The modified gen p mean: 0.44726303219795227, gen p mean: -0.21382080018520355, mean p set: 0.4477977156639099
loss_pred:0.014175319112837315, decouple_loss:0.0017354862065985799
2023-04-27 14:08:59 testing...
The modified gen p mean: 0.4482215344905853, gen p mean: -0.2175104022026062, mean p set: 0.44879910349845886
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2198365181684494, mean p set: 0.4499112665653229
loss_pred:0.01591763086616993, decouple_loss:0.002141733421012759
loss_pred:0.015909168869256973, decouple_loss:0.0021008942276239395
The modified gen p mean: 0.449298620223999, gen p mean: -0.220326766371727, mean p set: 0.4498290419578552
loss_pred:0.015439476817846298, decouple_loss:0.002042268868535757
WV_1_PC_1_EH_0_PS_30, loss: 0.015860173851251602, avg_mse: 0.023399174213409424
current test mse: 0.023399
Iteration: 3111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724613428115845, gen p mean: -0.2179833948612213, mean p set: 0.4477759003639221
loss_pred:0.014194093644618988, decouple_loss:0.0023026461713016033
The modified gen p mean: 0.44811517000198364, gen p mean: -0.21376338601112366, mean p set: 0.4486927390098572
loss_pred:0.013815484941005707, decouple_loss:0.0024388846941292286
The modified gen p mean: 0.4466925859451294, gen p mean: -0.22125278413295746, mean p set: 0.4472716748714447
loss_pred:0.01524453703314066, decouple_loss:0.00202230759896338
Iteration: 3112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633206725120544, gen p mean: -0.23085197806358337, mean p set: 0.4468553960323334
loss_pred:0.014386472292244434, decouple_loss:0.0021707748528569937
The modified gen p mean: 0.44642961025238037, gen p mean: -0.22460737824440002, mean p set: 0.4470026195049286
The modified gen p mean: 0.4469289481639862, gen p mean: -0.22163841128349304, mean p set: 0.4475066065788269
loss_pred:0.014483842998743057, decouple_loss:0.0018584189238026738
loss_pred:0.013468935154378414, decouple_loss:0.002124093472957611
Iteration: 3113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469079375267029, gen p mean: -0.22391095757484436, mean p set: 0.4474334716796875
loss_pred:0.014652186073362827, decouple_loss:0.0019476276356726885
The modified gen p mean: 0.44730260968208313, gen p mean: -0.2259902060031891, mean p set: 0.4478755593299866
The modified gen p mean: 0.44720104336738586, gen p mean: -0.21750159561634064, mean p set: 0.4477759599685669
loss_pred:0.014716623350977898, decouple_loss:0.002463581273332238
loss_pred:0.014981399290263653, decouple_loss:0.0022484820801764727
Iteration: 3114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447079598903656, gen p mean: -0.2199692577123642, mean p set: 0.44765499234199524
loss_pred:0.014455451630055904, decouple_loss:0.0021195702720433474
The modified gen p mean: 0.44749772548675537, gen p mean: -0.21582134068012238, mean p set: 0.44801655411720276The modified gen p mean: 0.447112500667572, gen p mean: -0.21309973299503326, mean p set: 0.44768741726875305
loss_pred:0.013242938555777073, decouple_loss:0.0019864062778651714loss_pred:0.014081987552344799, decouple_loss:0.002074821386486292
Iteration: 3115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804808497428894, gen p mean: -0.21218299865722656, mean p set: 0.44862768054008484
loss_pred:0.013858119025826454, decouple_loss:0.0021893451921641827
The modified gen p mean: 0.44664961099624634, gen p mean: -0.22099655866622925, mean p set: 0.44717565178871155The modified gen p mean: 0.44597145915031433, gen p mean: -0.22217600047588348, mean p set: 0.4465501010417938
loss_pred:0.014818963594734669, decouple_loss:0.002021598629653454
loss_pred:0.014596969820559025, decouple_loss:0.0023746390361338854
Iteration: 3116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464331567287445, gen p mean: -0.2173532098531723, mean p set: 0.4470112919807434
loss_pred:0.013473686762154102, decouple_loss:0.0019475918961688876
The modified gen p mean: 0.4471152722835541, gen p mean: -0.21437478065490723, mean p set: 0.4476470947265625The modified gen p mean: 0.4470949172973633, gen p mean: -0.21438297629356384, mean p set: 0.4476739168167114
loss_pred:0.014663893729448318, decouple_loss:0.0019500573398545384
loss_pred:0.013898230157792568, decouple_loss:0.001992579782381654
Iteration: 3117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811782240867615, gen p mean: -0.2174040675163269, mean p set: 0.44869264960289
loss_pred:0.014061005786061287, decouple_loss:0.0022436717990785837
The modified gen p mean: 0.4466077387332916, gen p mean: -0.22550445795059204, mean p set: 0.4471876323223114
loss_pred:0.014739383943378925, decouple_loss:0.0019336892291903496
The modified gen p mean: 0.4468923807144165, gen p mean: -0.21936377882957458, mean p set: 0.447416752576828
loss_pred:0.014026820659637451, decouple_loss:0.0019975192844867706
Iteration: 3118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709861278533936, gen p mean: -0.222266286611557, mean p set: 0.4476735293865204
loss_pred:0.014301193878054619, decouple_loss:0.0017741998890414834
The modified gen p mean: 0.4466257691383362, gen p mean: -0.22374218702316284, mean p set: 0.44715800881385803The modified gen p mean: 0.4475756883621216, gen p mean: -0.21943223476409912, mean p set: 0.44814640283584595
loss_pred:0.014721651561558247, decouple_loss:0.0018962541362270713
loss_pred:0.013371733017265797, decouple_loss:0.001941184513270855
Iteration: 3119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465230703353882, gen p mean: -0.2150823473930359, mean p set: 0.4471038579940796
loss_pred:0.015347574837505817, decouple_loss:0.0019145767437294126
The modified gen p mean: 0.44675952196121216, gen p mean: -0.2149847447872162, mean p set: 0.4473371207714081
loss_pred:0.013495969586074352, decouple_loss:0.0020707815419882536
The modified gen p mean: 0.44799190759658813, gen p mean: -0.21656200289726257, mean p set: 0.4485190510749817
loss_pred:0.014756822027266026, decouple_loss:0.0021151260007172823
Iteration: 3120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653308391571045, gen p mean: -0.22709378600120544, mean p set: 0.4471111297607422
loss_pred:0.014125344343483448, decouple_loss:0.0020168188493698835
The modified gen p mean: 0.44604915380477905, gen p mean: -0.22367337346076965, mean p set: 0.44662564992904663
loss_pred:0.014840742573142052, decouple_loss:0.002018132945522666
The modified gen p mean: 0.4481033980846405, gen p mean: -0.21881939470767975, mean p set: 0.4486280083656311
loss_pred:0.013892493210732937, decouple_loss:0.0023505594581365585
2023-04-27 14:12:25 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21642759442329407, mean p set: 0.4499112665653229
loss_pred:0.015940099954605103, decouple_loss:0.0022598763462156057
The modified gen p mean: 0.4492974877357483, gen p mean: -0.21709810197353363, mean p set: 0.4498290419578552
loss_pred:0.015459868125617504, decouple_loss:0.0021692158188670874
The modified gen p mean: 0.4482194781303406, gen p mean: -0.2140747606754303, mean p set: 0.44879910349845886
loss_pred:0.016005074605345726, decouple_loss:0.00219032377935946
WV_1_PC_1_EH_0_PS_30, loss: 0.015912003815174103, avg_mse: 0.02345872111618519
current test mse: 0.023459
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 3121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487830102443695, gen p mean: -0.21527642011642456, mean p set: 0.4493071436882019
loss_pred:0.015720762312412262, decouple_loss:0.0022147903218865395
The modified gen p mean: 0.44829419255256653, gen p mean: -0.21164575219154358, mean p set: 0.4488740861415863
loss_pred:0.015028655529022217, decouple_loss:0.0023315134458243847
The modified gen p mean: 0.45072388648986816, gen p mean: -0.21192623674869537, mean p set: 0.45130491256713867
loss_pred:0.01468532532453537, decouple_loss:0.0022502874489873648
Iteration: 3122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500955641269684, gen p mean: -0.2120852768421173, mean p set: 0.4506189823150635
loss_pred:0.014734306372702122, decouple_loss:0.0022015792783349752
The modified gen p mean: 0.44863957166671753, gen p mean: -0.2218715250492096, mean p set: 0.449221134185791
The modified gen p mean: 0.44919171929359436, gen p mean: -0.2159809023141861, mean p set: 0.4497663974761963
loss_pred:0.014482064172625542, decouple_loss:0.0019883851055055857
loss_pred:0.014395203441381454, decouple_loss:0.0019076811149716377
Iteration: 3123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818350672721863, gen p mean: -0.21675920486450195, mean p set: 0.44870686531066895
loss_pred:0.016011275351047516, decouple_loss:0.001990634249523282
The modified gen p mean: 0.44793882966041565, gen p mean: -0.21481604874134064, mean p set: 0.44851261377334595
The modified gen p mean: 0.4489159882068634, gen p mean: -0.21794411540031433, mean p set: 0.44949063658714294
loss_pred:0.014081099070608616, decouple_loss:0.0020666380878537893
loss_pred:0.014553057961165905, decouple_loss:0.00202818657271564
Iteration: 3124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797971844673157, gen p mean: -0.21793754398822784, mean p set: 0.44850999116897583
loss_pred:0.014857587404549122, decouple_loss:0.0021181004121899605
The modified gen p mean: 0.45019981265068054, gen p mean: -0.20817849040031433, mean p set: 0.4507763385772705
The modified gen p mean: 0.45048788189888, gen p mean: -0.21359583735466003, mean p set: 0.45106619596481323
loss_pred:0.014180101454257965, decouple_loss:0.0023646955378353596
loss_pred:0.014062334783375263, decouple_loss:0.0020134379155933857
Iteration: 3125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080605149269104, gen p mean: -0.21481935679912567, mean p set: 0.45138660073280334
loss_pred:0.014215686358511448, decouple_loss:0.002271956531330943
The modified gen p mean: 0.44855979084968567, gen p mean: -0.2162322700023651, mean p set: 0.44908788800239563The modified gen p mean: 0.4491012692451477, gen p mean: -0.21819156408309937, mean p set: 0.44967731833457947
loss_pred:0.01546977274119854, decouple_loss:0.00242380378767848
loss_pred:0.0145211610943079, decouple_loss:0.0021561449393630028
Iteration: 3126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500105082988739, gen p mean: -0.21245333552360535, mean p set: 0.4505905210971832
loss_pred:0.01470546331256628, decouple_loss:0.0020901872776448727
The modified gen p mean: 0.4480104148387909, gen p mean: -0.2144615650177002, mean p set: 0.4485381245613098The modified gen p mean: 0.44918814301490784, gen p mean: -0.21698932349681854, mean p set: 0.4497673809528351
loss_pred:0.014873933978378773, decouple_loss:0.0019986159168183804
loss_pred:0.015549208037555218, decouple_loss:0.0020114353392273188
Iteration: 3127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973862171173096, gen p mean: -0.2177981436252594, mean p set: 0.4503171145915985
loss_pred:0.014468513429164886, decouple_loss:0.002379003679379821
The modified gen p mean: 0.4485401213169098, gen p mean: -0.21221303939819336, mean p set: 0.44906798005104065The modified gen p mean: 0.4505690336227417, gen p mean: -0.21210934221744537, mean p set: 0.451143354177475
loss_pred:0.014813601039350033, decouple_loss:0.002364940010011196
loss_pred:0.014712444506585598, decouple_loss:0.0021573149133473635
Iteration: 3128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44894278049468994, gen p mean: -0.21321140229701996, mean p set: 0.4495182931423187
loss_pred:0.014419907703995705, decouple_loss:0.001984409522265196
The modified gen p mean: 0.450091689825058, gen p mean: -0.20690806210041046, mean p set: 0.45066767930984497The modified gen p mean: 0.4494226276874542, gen p mean: -0.20680508017539978, mean p set: 0.44995465874671936
loss_pred:0.014931800775229931, decouple_loss:0.0022195070050656796
loss_pred:0.01447929348796606, decouple_loss:0.00229690526612103
Iteration: 3129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482799172401428, gen p mean: -0.21366500854492188, mean p set: 0.44884949922561646
loss_pred:0.014942482113838196, decouple_loss:0.0024249700363725424
The modified gen p mean: 0.4497346580028534, gen p mean: -0.21229325234889984, mean p set: 0.45026013255119324The modified gen p mean: 0.44933873414993286, gen p mean: -0.21047396957874298, mean p set: 0.44991418719291687
loss_pred:0.014566467143595219, decouple_loss:0.0025406035128980875
loss_pred:0.014792121946811676, decouple_loss:0.0026041080709546804
Iteration: 3130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876495003700256, gen p mean: -0.21338693797588348, mean p set: 0.4493391215801239
loss_pred:0.014579279348254204, decouple_loss:0.002087756060063839
The modified gen p mean: 0.44960471987724304, gen p mean: -0.21130341291427612, mean p set: 0.45013123750686646The modified gen p mean: 0.44836732745170593, gen p mean: -0.2199385017156601, mean p set: 0.4489458501338959
loss_pred:0.014513036236166954, decouple_loss:0.002230470534414053
loss_pred:0.014543712139129639, decouple_loss:0.002075490541756153
2023-04-27 14:16:33 testing...
The modified gen p mean: 0.4482232332229614, gen p mean: -0.2186071276664734, mean p set: 0.44879910349845886
loss_pred:0.015855662524700165, decouple_loss:0.002481473609805107
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22178325057029724, mean p set: 0.4499112665653229
loss_pred:0.015889661386609077, decouple_loss:0.0029037788044661283
The modified gen p mean: 0.44930946826934814, gen p mean: -0.2219219207763672, mean p set: 0.4498290419578552
loss_pred:0.015453393571078777, decouple_loss:0.002681366167962551
WV_1_PC_1_EH_0_PS_30, loss: 0.01586735062301159, avg_mse: 0.023347992449998856
current test mse: 0.023348
Iteration: 3131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44887176156044006, gen p mean: -0.2171209752559662, mean p set: 0.4493984878063202
loss_pred:0.014965035021305084, decouple_loss:0.00223541515879333
The modified gen p mean: 0.4491739869117737, gen p mean: -0.22000496089458466, mean p set: 0.4497511684894562
loss_pred:0.01500384509563446, decouple_loss:0.002520403591915965
The modified gen p mean: 0.4491710662841797, gen p mean: -0.21828211843967438, mean p set: 0.4497471749782562
loss_pred:0.013736426830291748, decouple_loss:0.002213288564234972
Iteration: 3132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490703046321869, gen p mean: -0.21668827533721924, mean p set: 0.44959837198257446
loss_pred:0.015037085860967636, decouple_loss:0.0022632742766290903
The modified gen p mean: 0.4491845667362213, gen p mean: -0.2138832062482834, mean p set: 0.4497552812099457
The modified gen p mean: 0.4495994746685028, gen p mean: -0.22264747321605682, mean p set: 0.45017269253730774
loss_pred:0.01423662155866623, decouple_loss:0.00244463630951941
loss_pred:0.01467863004654646, decouple_loss:0.002079607220366597
Iteration: 3133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503322243690491, gen p mean: -0.21493829786777496, mean p set: 0.4508661925792694
loss_pred:0.014293275773525238, decouple_loss:0.002298033330589533
The modified gen p mean: 0.4487662613391876, gen p mean: -0.21581290662288666, mean p set: 0.44934147596359253
The modified gen p mean: 0.4478810429573059, gen p mean: -0.2166987806558609, mean p set: 0.44845327734947205
loss_pred:0.014708897098898888, decouple_loss:0.0023652566596865654
loss_pred:0.014002165757119656, decouple_loss:0.002642871579155326
Iteration: 3134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499756395816803, gen p mean: -0.216896653175354, mean p set: 0.4505513906478882
loss_pred:0.01407883781939745, decouple_loss:0.0022334461100399494
The modified gen p mean: 0.44908592104911804, gen p mean: -0.21781371533870697, mean p set: 0.4496645927429199
loss_pred:0.014426048845052719, decouple_loss:0.0021870373748242855
The modified gen p mean: 0.4501778483390808, gen p mean: -0.21601571142673492, mean p set: 0.45070981979370117
loss_pred:0.014167530462145805, decouple_loss:0.0020355391316115856
Iteration: 3135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500306248664856, gen p mean: -0.21506260335445404, mean p set: 0.4506046175956726
loss_pred:0.014841540716588497, decouple_loss:0.0023932710755616426
The modified gen p mean: 0.44857993721961975, gen p mean: -0.21920984983444214, mean p set: 0.4491119980812073The modified gen p mean: 0.4491405785083771, gen p mean: -0.21841181814670563, mean p set: 0.4497183561325073
loss_pred:0.015192443504929543, decouple_loss:0.002351217670366168
loss_pred:0.014781434088945389, decouple_loss:0.0018818882526829839
Iteration: 3136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493951201438904, gen p mean: -0.2221040278673172, mean p set: 0.44996631145477295
loss_pred:0.014263954013586044, decouple_loss:0.002192674670368433
The modified gen p mean: 0.44832348823547363, gen p mean: -0.21779276430606842, mean p set: 0.44885316491127014The modified gen p mean: 0.450713574886322, gen p mean: -0.21479733288288116, mean p set: 0.45129016041755676
loss_pred:0.014634853228926659, decouple_loss:0.0018689940916374326
loss_pred:0.014902099967002869, decouple_loss:0.0021311601158231497
Iteration: 3137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495560824871063, gen p mean: -0.21982406079769135, mean p set: 0.45013657212257385
loss_pred:0.014299732632935047, decouple_loss:0.0020605260506272316
The modified gen p mean: 0.4496909976005554, gen p mean: -0.2180822789669037, mean p set: 0.4502677023410797
loss_pred:0.014596539549529552, decouple_loss:0.0025843922048807144
The modified gen p mean: 0.44931620359420776, gen p mean: -0.22167983651161194, mean p set: 0.4498424530029297
loss_pred:0.014741748571395874, decouple_loss:0.001947011798620224
Iteration: 3138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499083161354065, gen p mean: -0.21766507625579834, mean p set: 0.4504837691783905
loss_pred:0.014538716524839401, decouple_loss:0.0021099711302667856
The modified gen p mean: 0.44888168573379517, gen p mean: -0.2205296903848648, mean p set: 0.4494198262691498
The modified gen p mean: 0.44755977392196655, gen p mean: -0.22050850093364716, mean p set: 0.44813892245292664
loss_pred:0.015537369064986706, decouple_loss:0.0021162042394280434
loss_pred:0.015161195769906044, decouple_loss:0.0020673845428973436
Iteration: 3139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960010051727295, gen p mean: -0.22187957167625427, mean p set: 0.4501734673976898
loss_pred:0.014422842301428318, decouple_loss:0.0019145974656566978
The modified gen p mean: 0.4491543173789978, gen p mean: -0.22631093859672546, mean p set: 0.4496835172176361The modified gen p mean: 0.44893428683280945, gen p mean: -0.22020402550697327, mean p set: 0.4495089054107666
loss_pred:0.014417565427720547, decouple_loss:0.0021195965819060802
loss_pred:0.014730249531567097, decouple_loss:0.0018752057803794742
Iteration: 3140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491024911403656, gen p mean: -0.22251921892166138, mean p set: 0.4496765732765198
loss_pred:0.015114547684788704, decouple_loss:0.002323378110304475
The modified gen p mean: 0.44841399788856506, gen p mean: -0.22428911924362183, mean p set: 0.448993444442749
loss_pred:0.014687804505228996, decouple_loss:0.0019166668644174933
The modified gen p mean: 0.4496302902698517, gen p mean: -0.22018854320049286, mean p set: 0.4501534700393677
loss_pred:0.014582750387489796, decouple_loss:0.001811755122616887
2023-04-27 14:19:58 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22333449125289917, mean p set: 0.4499112665653229
loss_pred:0.0158669576048851, decouple_loss:0.002063916763290763
The modified gen p mean: 0.44929882884025574, gen p mean: -0.22357168793678284, mean p set: 0.4498290419578552
loss_pred:0.015413503162562847, decouple_loss:0.0020091563928872347
The modified gen p mean: 0.44822418689727783, gen p mean: -0.2201985865831375, mean p set: 0.44879910349845886
loss_pred:0.015746556222438812, decouple_loss:0.0020401894580572844
WV_1_PC_1_EH_0_PS_30, loss: 0.01577756181359291, avg_mse: 0.023290714249014854
current test mse: 0.023291
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 3141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473504424095154, gen p mean: -0.2227933704853058, mean p set: 0.44787725806236267
loss_pred:0.015335709787905216, decouple_loss:0.0021928551141172647
The modified gen p mean: 0.44776687026023865, gen p mean: -0.22390273213386536, mean p set: 0.44834670424461365
loss_pred:0.015081152319908142, decouple_loss:0.0018807512242347002
The modified gen p mean: 0.44693905115127563, gen p mean: -0.22237887978553772, mean p set: 0.4475100040435791
loss_pred:0.01432250626385212, decouple_loss:0.0020657831337302923
Iteration: 3142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468476474285126, gen p mean: -0.2202158272266388, mean p set: 0.4473719894886017
loss_pred:0.015103712677955627, decouple_loss:0.0024956422857940197
The modified gen p mean: 0.4454267919063568, gen p mean: -0.21807324886322021, mean p set: 0.4460061490535736
The modified gen p mean: 0.4480670988559723, gen p mean: -0.21797290444374084, mean p set: 0.44864004850387573
loss_pred:0.014817670919001102, decouple_loss:0.0027277173940092325
loss_pred:0.015433084219694138, decouple_loss:0.002222802024334669
Iteration: 3143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472501575946808, gen p mean: -0.22614774107933044, mean p set: 0.44777220487594604
loss_pred:0.014619984664022923, decouple_loss:0.0018991142278537154
The modified gen p mean: 0.4486759305000305, gen p mean: -0.22234013676643372, mean p set: 0.44924843311309814
The modified gen p mean: 0.448349267244339, gen p mean: -0.2202255129814148, mean p set: 0.44892388582229614
loss_pred:0.015289472416043282, decouple_loss:0.0020580096170306206
loss_pred:0.015357251279056072, decouple_loss:0.00212242198176682
Iteration: 3144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752997159957886, gen p mean: -0.22551590204238892, mean p set: 0.448056697845459
loss_pred:0.014491798356175423, decouple_loss:0.0022095078602433205
The modified gen p mean: 0.4481816589832306, gen p mean: -0.222202867269516, mean p set: 0.44875821471214294
The modified gen p mean: 0.44688138365745544, gen p mean: -0.22132840752601624, mean p set: 0.44745346903800964
loss_pred:0.015370521694421768, decouple_loss:0.0023816891480237246
loss_pred:0.015370086766779423, decouple_loss:0.00215608230791986
Iteration: 3145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472503364086151, gen p mean: -0.22736747562885284, mean p set: 0.44783279299736023
loss_pred:0.014788927510380745, decouple_loss:0.0019614347256720066
The modified gen p mean: 0.4465070366859436, gen p mean: -0.22549255192279816, mean p set: 0.4470318555831909The modified gen p mean: 0.4481775760650635, gen p mean: -0.22815248370170593, mean p set: 0.44875115156173706
loss_pred:0.015291816554963589, decouple_loss:0.002150858286768198
loss_pred:0.01464306004345417, decouple_loss:0.0021709208376705647
Iteration: 3146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671544432640076, gen p mean: -0.2314598709344864, mean p set: 0.4472857117652893
loss_pred:0.014480606652796268, decouple_loss:0.0020580263808369637
The modified gen p mean: 0.44694334268569946, gen p mean: -0.2334461212158203, mean p set: 0.4474697411060333The modified gen p mean: 0.44651421904563904, gen p mean: -0.22852833569049835, mean p set: 0.44709280133247375
loss_pred:0.014450167305767536, decouple_loss:0.0021112875547260046
loss_pred:0.014386595226824284, decouple_loss:0.002031845273450017
Iteration: 3147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727224111557007, gen p mean: -0.22942066192626953, mean p set: 0.4478478729724884
loss_pred:0.01436864584684372, decouple_loss:0.002174170920625329
The modified gen p mean: 0.4468775689601898, gen p mean: -0.23148812353610992, mean p set: 0.44740432500839233The modified gen p mean: 0.44777294993400574, gen p mean: -0.22987975180149078, mean p set: 0.44834285974502563
loss_pred:0.01489498931914568, decouple_loss:0.002113711554557085
loss_pred:0.014612180180847645, decouple_loss:0.0018517969874665141
Iteration: 3148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44659337401390076, gen p mean: -0.22339950501918793, mean p set: 0.4471677839756012
loss_pred:0.014352098107337952, decouple_loss:0.0019116026815026999
The modified gen p mean: 0.4465552568435669, gen p mean: -0.23007822036743164, mean p set: 0.4471312463283539
loss_pred:0.014435776509344578, decouple_loss:0.002033260418102145
The modified gen p mean: 0.4477691650390625, gen p mean: -0.2287512719631195, mean p set: 0.44829845428466797
loss_pred:0.01403873972594738, decouple_loss:0.0019400810124352574
Iteration: 3149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486779570579529, gen p mean: -0.22731290757656097, mean p set: 0.4492546021938324
loss_pred:0.014686182141304016, decouple_loss:0.0020410052966326475
The modified gen p mean: 0.44795098900794983, gen p mean: -0.22651439905166626, mean p set: 0.4485260546207428
loss_pred:0.014768006280064583, decouple_loss:0.0018737491918727756
The modified gen p mean: 0.4466942548751831, gen p mean: -0.22308805584907532, mean p set: 0.4472208023071289
loss_pred:0.014639385044574738, decouple_loss:0.0017950277542695403
Iteration: 3150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463160037994385, gen p mean: -0.22717081010341644, mean p set: 0.4468908905982971
loss_pred:0.014336388558149338, decouple_loss:0.001956085441634059
The modified gen p mean: 0.4479294419288635, gen p mean: -0.22690875828266144, mean p set: 0.44845691323280334The modified gen p mean: 0.44714081287384033, gen p mean: -0.22559289634227753, mean p set: 0.44771912693977356
loss_pred:0.014532898552715778, decouple_loss:0.0019117963965982199
loss_pred:0.014860526658594608, decouple_loss:0.0019495829474180937
2023-04-27 14:24:01 testing...
The modified gen p mean: 0.4482230246067047, gen p mean: -0.2207866758108139, mean p set: 0.44879910349845886
loss_pred:0.015838297083973885, decouple_loss:0.0020544484723359346
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22378414869308472, mean p set: 0.4499112665653229
loss_pred:0.015851516276597977, decouple_loss:0.0020593118388205767
The modified gen p mean: 0.4493054151535034, gen p mean: -0.22433945536613464, mean p set: 0.4498290419578552
loss_pred:0.015411094762384892, decouple_loss:0.0019947702530771494
WV_1_PC_1_EH_0_PS_30, loss: 0.015802111476659775, avg_mse: 0.023385129868984222
current test mse: 0.023385
Iteration: 3151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682446122169495, gen p mean: -0.22666367888450623, mean p set: 0.44739779829978943
loss_pred:0.014382367953658104, decouple_loss:0.002067274646833539
The modified gen p mean: 0.44654297828674316, gen p mean: -0.22673027217388153, mean p set: 0.4471190571784973
loss_pred:0.014112929813563824, decouple_loss:0.0021919915452599525
The modified gen p mean: 0.4491220712661743, gen p mean: -0.2245340347290039, mean p set: 0.44964826107025146
loss_pred:0.01459544338285923, decouple_loss:0.0019699425902217627
Iteration: 3152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709154963493347, gen p mean: -0.22429971396923065, mean p set: 0.44762295484542847
loss_pred:0.014423287473618984, decouple_loss:0.002007477218285203
The modified gen p mean: 0.44574978947639465, gen p mean: -0.22509075701236725, mean p set: 0.4463326036930084
loss_pred:0.014102604240179062, decouple_loss:0.001807882683351636
The modified gen p mean: 0.4473857581615448, gen p mean: -0.225253164768219, mean p set: 0.447966605424881
loss_pred:0.014287012629210949, decouple_loss:0.0017887565772980452
Iteration: 3153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44626203179359436, gen p mean: -0.21822232007980347, mean p set: 0.44678959250450134
loss_pred:0.014308157376945019, decouple_loss:0.002096976852044463
The modified gen p mean: 0.4491516649723053, gen p mean: -0.2230473905801773, mean p set: 0.44973060488700867
loss_pred:0.014597378671169281, decouple_loss:0.001999812200665474
The modified gen p mean: 0.4469400644302368, gen p mean: -0.21832917630672455, mean p set: 0.447516530752182
loss_pred:0.015125607140362263, decouple_loss:0.0019452139968052506
Iteration: 3154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762280583381653, gen p mean: -0.2268822342157364, mean p set: 0.4481556713581085
loss_pred:0.014589175581932068, decouple_loss:0.0019931637216359377
The modified gen p mean: 0.4470110833644867, gen p mean: -0.2303055077791214, mean p set: 0.4475838840007782
loss_pred:0.014689910225570202, decouple_loss:0.0019267641473561525
The modified gen p mean: 0.44829919934272766, gen p mean: -0.2252342253923416, mean p set: 0.44887736439704895
loss_pred:0.01498078741133213, decouple_loss:0.001754904631525278
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759228825569153, gen p mean: -0.22711732983589172, mean p set: 0.4481663107872009
loss_pred:0.01523273903876543, decouple_loss:0.0018363784765824676
The modified gen p mean: 0.4453575909137726, gen p mean: -0.22651387751102448, mean p set: 0.44594070315361023
loss_pred:0.014250874519348145, decouple_loss:0.0019469530088827014
The modified gen p mean: 0.44639870524406433, gen p mean: -0.2271273136138916, mean p set: 0.44692057371139526
loss_pred:0.014543344266712666, decouple_loss:0.001887392601929605
Iteration: 3156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757401943206787, gen p mean: -0.23286916315555573, mean p set: 0.44815176725387573
loss_pred:0.014410127885639668, decouple_loss:0.001914191641844809
The modified gen p mean: 0.4462362229824066, gen p mean: -0.2303864061832428, mean p set: 0.44681257009506226
loss_pred:0.014276459813117981, decouple_loss:0.0019338232232257724
The modified gen p mean: 0.4464057981967926, gen p mean: -0.2315773367881775, mean p set: 0.44693562388420105
loss_pred:0.014357531443238258, decouple_loss:0.00195740326307714
Iteration: 3157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464043080806732, gen p mean: -0.2326522320508957, mean p set: 0.4469849467277527
loss_pred:0.01447354070842266, decouple_loss:0.001969715114682913
The modified gen p mean: 0.4471292197704315, gen p mean: -0.22968687117099762, mean p set: 0.44765836000442505The modified gen p mean: 0.4474322199821472, gen p mean: -0.22994570434093475, mean p set: 0.4480137526988983
loss_pred:0.014618468470871449, decouple_loss:0.002009952673688531
loss_pred:0.015585319139063358, decouple_loss:0.001978581305593252
Iteration: 3158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605571031570435, gen p mean: -0.23021286725997925, mean p set: 0.4466286599636078
loss_pred:0.014538617804646492, decouple_loss:0.0017812007572501898
The modified gen p mean: 0.44692155718803406, gen p mean: -0.23269200325012207, mean p set: 0.44750016927719116
loss_pred:0.01602213643491268, decouple_loss:0.0019442799966782331
The modified gen p mean: 0.44665470719337463, gen p mean: -0.23540635406970978, mean p set: 0.44718244671821594
loss_pred:0.014221670106053352, decouple_loss:0.0019051675917580724
Iteration: 3159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464187026023865, gen p mean: -0.2289646714925766, mean p set: 0.4469926357269287
loss_pred:0.014783667400479317, decouple_loss:0.0018837115494534373
The modified gen p mean: 0.4469788670539856, gen p mean: -0.23184238374233246, mean p set: 0.4475601017475128
loss_pred:0.014990129508078098, decouple_loss:0.001975009450688958
The modified gen p mean: 0.44733068346977234, gen p mean: -0.23126272857189178, mean p set: 0.44785624742507935
loss_pred:0.014202035032212734, decouple_loss:0.001851778943091631
Iteration: 3160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728901982307434, gen p mean: -0.2312663197517395, mean p set: 0.44786328077316284
loss_pred:0.013914523646235466, decouple_loss:0.0018323612166568637
The modified gen p mean: 0.44604066014289856, gen p mean: -0.22669769823551178, mean p set: 0.4466158449649811
loss_pred:0.014255194924771786, decouple_loss:0.0019175262423232198
The modified gen p mean: 0.44650301337242126, gen p mean: -0.22872380912303925, mean p set: 0.44703078269958496
loss_pred:0.014461515471339226, decouple_loss:0.00193416653200984
2023-04-27 14:27:27 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2271306812763214, mean p set: 0.4499112665653229
loss_pred:0.015822455286979675, decouple_loss:0.0021339028608053923
The modified gen p mean: 0.4493039846420288, gen p mean: -0.2277364879846573, mean p set: 0.4498290419578552
loss_pred:0.015343910083174706, decouple_loss:0.002017024904489517
The modified gen p mean: 0.4482201933860779, gen p mean: -0.2243126928806305, mean p set: 0.44879910349845886
loss_pred:0.015791036188602448, decouple_loss:0.0020431275479495525
WV_1_PC_1_EH_0_PS_30, loss: 0.015755701810121536, avg_mse: 0.023333879187703133
current test mse: 0.023334
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 3161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783610105514526, gen p mean: -0.225749671459198, mean p set: 0.44836896657943726
loss_pred:0.015820370987057686, decouple_loss:0.0020140428096055984
The modified gen p mean: 0.44914570450782776, gen p mean: -0.22889134287834167, mean p set: 0.44972550868988037
loss_pred:0.015060808509588242, decouple_loss:0.0020809571724385023
The modified gen p mean: 0.448988139629364, gen p mean: -0.228785440325737, mean p set: 0.44956550002098083
loss_pred:0.015338613651692867, decouple_loss:0.002024129033088684
Iteration: 3162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890573620796204, gen p mean: -0.23403102159500122, mean p set: 0.4494372606277466
loss_pred:0.014920245856046677, decouple_loss:0.0019978699274361134
The modified gen p mean: 0.4485292136669159, gen p mean: -0.2318268120288849, mean p set: 0.4491029977798462
The modified gen p mean: 0.44879359006881714, gen p mean: -0.22982357442378998, mean p set: 0.4493670165538788
loss_pred:0.015441029332578182, decouple_loss:0.0022580099757760763
loss_pred:0.015058613382279873, decouple_loss:0.0019464228535071015
Iteration: 3163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727814197540283, gen p mean: -0.22677873075008392, mean p set: 0.4478098452091217
loss_pred:0.01590566523373127, decouple_loss:0.0021539193112403154
The modified gen p mean: 0.44773435592651367, gen p mean: -0.22124400734901428, mean p set: 0.44830653071403503
The modified gen p mean: 0.44744598865509033, gen p mean: -0.23141685128211975, mean p set: 0.4480241537094116
loss_pred:0.01508338563144207, decouple_loss:0.0020815408788621426
loss_pred:0.015745015814900398, decouple_loss:0.00227093743160367
Iteration: 3164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485160708427429, gen p mean: -0.23234149813652039, mean p set: 0.4490435719490051
loss_pred:0.01495063491165638, decouple_loss:0.00195135991089046
The modified gen p mean: 0.4486825466156006, gen p mean: -0.2294420450925827, mean p set: 0.4492647647857666
The modified gen p mean: 0.4486784040927887, gen p mean: -0.2293245494365692, mean p set: 0.44925159215927124
loss_pred:0.014916143380105495, decouple_loss:0.0019483743235468864
loss_pred:0.014983169734477997, decouple_loss:0.0020328054670244455
Iteration: 3165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481813609600067, gen p mean: -0.2254602015018463, mean p set: 0.4487597644329071
loss_pred:0.015079958364367485, decouple_loss:0.0018171261763200164
The modified gen p mean: 0.44924384355545044, gen p mean: -0.2260468602180481, mean p set: 0.4497752785682678The modified gen p mean: 0.4490590989589691, gen p mean: -0.23229539394378662, mean p set: 0.4496367573738098
loss_pred:0.014994733035564423, decouple_loss:0.001820479752495885
loss_pred:0.014759227633476257, decouple_loss:0.0019251921912655234
Iteration: 3166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842633605003357, gen p mean: -0.22230961918830872, mean p set: 0.4490050673484802
loss_pred:0.01556168869137764, decouple_loss:0.0020173578523099422
The modified gen p mean: 0.44933709502220154, gen p mean: -0.22903238236904144, mean p set: 0.4498598277568817The modified gen p mean: 0.4490694999694824, gen p mean: -0.22749930620193481, mean p set: 0.4496401250362396
loss_pred:0.015292307361960411, decouple_loss:0.0018581632757559419
loss_pred:0.014955530874431133, decouple_loss:0.0018810657784342766
Iteration: 3167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829878211021423, gen p mean: -0.22802653908729553, mean p set: 0.4488733410835266
loss_pred:0.015379752963781357, decouple_loss:0.0019673609640449286
The modified gen p mean: 0.44887495040893555, gen p mean: -0.227052241563797, mean p set: 0.4494089186191559The modified gen p mean: 0.44932645559310913, gen p mean: -0.2311660647392273, mean p set: 0.4498986005783081
loss_pred:0.015292656607925892, decouple_loss:0.0018915532855316997
loss_pred:0.015077506192028522, decouple_loss:0.0018166896188631654
Iteration: 3168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490654766559601, gen p mean: -0.22612889111042023, mean p set: 0.4496358335018158
loss_pred:0.015156503766775131, decouple_loss:0.0018703838577494025
The modified gen p mean: 0.44858822226524353, gen p mean: -0.22359299659729004, mean p set: 0.44911903142929077The modified gen p mean: 0.4489588439464569, gen p mean: -0.22946971654891968, mean p set: 0.4495360851287842
loss_pred:0.015459909103810787, decouple_loss:0.0019635779317468405
loss_pred:0.015139945782721043, decouple_loss:0.0018151509575545788
Iteration: 3169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810324907302856, gen p mean: -0.2262532114982605, mean p set: 0.4486786425113678
loss_pred:0.01584738679230213, decouple_loss:0.0019848679658025503
The modified gen p mean: 0.44806623458862305, gen p mean: -0.22178669273853302, mean p set: 0.4486406445503235The modified gen p mean: 0.44774001836776733, gen p mean: -0.22727209329605103, mean p set: 0.4482733905315399
loss_pred:0.015916604548692703, decouple_loss:0.0018835722003132105
loss_pred:0.015310798771679401, decouple_loss:0.0019898205064237118
Iteration: 3170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485919177532196, gen p mean: -0.2292797714471817, mean p set: 0.4491669833660126
loss_pred:0.014973476529121399, decouple_loss:0.0019653181079775095
The modified gen p mean: 0.4489882290363312, gen p mean: -0.22956803441047668, mean p set: 0.44951876997947693The modified gen p mean: 0.449349969625473, gen p mean: -0.23327229917049408, mean p set: 0.449928879737854
loss_pred:0.015192905440926552, decouple_loss:0.0019528766861185431
loss_pred:0.015024344436824322, decouple_loss:0.0018916925182566047
2023-04-27 14:31:31 testing...
The modified gen p mean: 0.4482228457927704, gen p mean: -0.22624246776103973, mean p set: 0.44879910349845886
loss_pred:0.015700608491897583, decouple_loss:0.002275843173265457
The modified gen p mean: 0.44931086897850037, gen p mean: -0.2294941544532776, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2286904901266098, mean p set: 0.4499112665653229loss_pred:0.015295018441975117, decouple_loss:0.0022045450750738382
loss_pred:0.01579686999320984, decouple_loss:0.0023505687713623047
WV_1_PC_1_EH_0_PS_30, loss: 0.01571134850382805, avg_mse: 0.023187965154647827
current test mse: 0.023188
Iteration: 3171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494827091693878, gen p mean: -0.23486514389514923, mean p set: 0.4500062167644501
loss_pred:0.015054279938340187, decouple_loss:0.002282240893691778
The modified gen p mean: 0.44889941811561584, gen p mean: -0.23029223084449768, mean p set: 0.4494735598564148
loss_pred:0.015020637772977352, decouple_loss:0.0022079432383179665
The modified gen p mean: 0.4474550187587738, gen p mean: -0.2214510440826416, mean p set: 0.4480302929878235
loss_pred:0.015215468592941761, decouple_loss:0.002340080915018916
Iteration: 3172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489092528820038, gen p mean: -0.22465364634990692, mean p set: 0.4494384229183197
loss_pred:0.014555479399859905, decouple_loss:0.0018324404954910278
The modified gen p mean: 0.44901520013809204, gen p mean: -0.22944411635398865, mean p set: 0.4495936930179596
The modified gen p mean: 0.4487190544605255, gen p mean: -0.2325543314218521, mean p set: 0.4493010640144348
loss_pred:0.014758411794900894, decouple_loss:0.0018643676303327084
loss_pred:0.015143278986215591, decouple_loss:0.0017776000313460827
Iteration: 3173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495278596878052, gen p mean: -0.22881285846233368, mean p set: 0.45005539059638977
loss_pred:0.0148208849132061, decouple_loss:0.002288032555952668
The modified gen p mean: 0.4488984942436218, gen p mean: -0.2261488139629364, mean p set: 0.44947290420532227
The modified gen p mean: 0.44803881645202637, gen p mean: -0.2291199266910553, mean p set: 0.44861117005348206
loss_pred:0.014795833267271519, decouple_loss:0.0022763076703995466
loss_pred:0.01521934662014246, decouple_loss:0.002197352470830083
Iteration: 3174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482864737510681, gen p mean: -0.230733260512352, mean p set: 0.4488653242588043
loss_pred:0.015255097299814224, decouple_loss:0.0019014242570847273
The modified gen p mean: 0.4481066167354584, gen p mean: -0.2281535118818283, mean p set: 0.4486761689186096The modified gen p mean: 0.447929322719574, gen p mean: -0.22408844530582428, mean p set: 0.4484536051750183
loss_pred:0.015233880840241909, decouple_loss:0.001980800414457917
loss_pred:0.015576912090182304, decouple_loss:0.0019228572491556406
Iteration: 3175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483224153518677, gen p mean: -0.2275494635105133, mean p set: 0.4488937258720398
loss_pred:0.0157694760710001, decouple_loss:0.0026818469632416964
The modified gen p mean: 0.4478452801704407, gen p mean: -0.22398780286312103, mean p set: 0.4484219551086426
loss_pred:0.015050799585878849, decouple_loss:0.002405276522040367
The modified gen p mean: 0.4479338824748993, gen p mean: -0.22666287422180176, mean p set: 0.44845834374427795
loss_pred:0.01481174398213625, decouple_loss:0.0025220883544534445
Iteration: 3176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477197527885437, gen p mean: -0.225969597697258, mean p set: 0.4483001232147217
loss_pred:0.015205361880362034, decouple_loss:0.002157868118956685
The modified gen p mean: 0.4493570327758789, gen p mean: -0.23245085775852203, mean p set: 0.4498789310455322The modified gen p mean: 0.44939127564430237, gen p mean: -0.2290816307067871, mean p set: 0.4499637186527252
loss_pred:0.014959101565182209, decouple_loss:0.0022568677086383104
loss_pred:0.015029103495180607, decouple_loss:0.0021528915967792273
Iteration: 3177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448599636554718, gen p mean: -0.22317731380462646, mean p set: 0.44917774200439453
loss_pred:0.01537676528096199, decouple_loss:0.002046802779659629
The modified gen p mean: 0.44888243079185486, gen p mean: -0.22380220890045166, mean p set: 0.4494534134864807
loss_pred:0.014743332751095295, decouple_loss:0.0022643962875008583
The modified gen p mean: 0.4488121569156647, gen p mean: -0.2229282408952713, mean p set: 0.44934189319610596
loss_pred:0.01509311143308878, decouple_loss:0.002259516855701804
Iteration: 3178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488558769226074, gen p mean: -0.2289275825023651, mean p set: 0.44942986965179443
loss_pred:0.015038981102406979, decouple_loss:0.0020827765110880136
The modified gen p mean: 0.44807469844818115, gen p mean: -0.22400477528572083, mean p set: 0.4486114978790283The modified gen p mean: 0.44835424423217773, gen p mean: -0.22558996081352234, mean p set: 0.4489397704601288
loss_pred:0.014598362147808075, decouple_loss:0.001987095456570387
loss_pred:0.015710076317191124, decouple_loss:0.0020495920907706022
Iteration: 3179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791877269744873, gen p mean: -0.2191992700099945, mean p set: 0.448492169380188
loss_pred:0.015497220680117607, decouple_loss:0.0019288061885163188
The modified gen p mean: 0.4474320113658905, gen p mean: -0.22593338787555695, mean p set: 0.4480001628398895
loss_pred:0.015960881486535072, decouple_loss:0.0019984568934887648
The modified gen p mean: 0.44804486632347107, gen p mean: -0.22674255073070526, mean p set: 0.448577344417572
loss_pred:0.01503080502152443, decouple_loss:0.002178758382797241
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493776857852936, gen p mean: -0.22729066014289856, mean p set: 0.4499538242816925
loss_pred:0.014903861097991467, decouple_loss:0.0018807572778314352
The modified gen p mean: 0.449288547039032, gen p mean: -0.22960473597049713, mean p set: 0.4498666524887085
loss_pred:0.015358981676399708, decouple_loss:0.0018770468886941671
The modified gen p mean: 0.4484865963459015, gen p mean: -0.22528553009033203, mean p set: 0.44901883602142334
loss_pred:0.01434903871268034, decouple_loss:0.0020377326291054487
2023-04-27 14:34:56 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22927840054035187, mean p set: 0.4499112665653229
loss_pred:0.015878593549132347, decouple_loss:0.0019715905655175447
The modified gen p mean: 0.4492957592010498, gen p mean: -0.2299615889787674, mean p set: 0.4498290419578552
loss_pred:0.01545373909175396, decouple_loss:0.0020730618853121996
The modified gen p mean: 0.44822341203689575, gen p mean: -0.22667403519153595, mean p set: 0.44879910349845886
loss_pred:0.015822768211364746, decouple_loss:0.0019174417247995734
WV_1_PC_1_EH_0_PS_30, loss: 0.015817735344171524, avg_mse: 0.023404546082019806
current test mse: 0.023405
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 3181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489758312702179, gen p mean: -0.2266840785741806, mean p set: 0.44949984550476074
loss_pred:0.014756699092686176, decouple_loss:0.002078595571219921
The modified gen p mean: 0.44942140579223633, gen p mean: -0.23098795115947723, mean p set: 0.4500042200088501
loss_pred:0.014875849708914757, decouple_loss:0.0020644781179726124
The modified gen p mean: 0.4501081109046936, gen p mean: -0.22559554874897003, mean p set: 0.450682133436203
loss_pred:0.014913413673639297, decouple_loss:0.0021695399191230536
Iteration: 3182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490871727466583, gen p mean: -0.227649986743927, mean p set: 0.4496126174926758
loss_pred:0.014172249473631382, decouple_loss:0.002102070953696966
The modified gen p mean: 0.44901400804519653, gen p mean: -0.225484699010849, mean p set: 0.44958946108818054
The modified gen p mean: 0.4465324580669403, gen p mean: -0.22710628807544708, mean p set: 0.44710251688957214
loss_pred:0.014588016085326672, decouple_loss:0.002141567412763834
loss_pred:0.014488846063613892, decouple_loss:0.002264052163809538
Iteration: 3183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480586051940918, gen p mean: -0.22741009294986725, mean p set: 0.4485909342765808
loss_pred:0.015471363440155983, decouple_loss:0.002404221799224615
The modified gen p mean: 0.448367714881897, gen p mean: -0.22632375359535217, mean p set: 0.448943167924881
The modified gen p mean: 0.4500560760498047, gen p mean: -0.22618404030799866, mean p set: 0.4506332576274872
loss_pred:0.01468441542237997, decouple_loss:0.0022857841104269028
loss_pred:0.0141628822311759, decouple_loss:0.0024387494195252657
Iteration: 3184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486091136932373, gen p mean: -0.23421183228492737, mean p set: 0.449137419462204
loss_pred:0.014556254260241985, decouple_loss:0.002111730631440878
The modified gen p mean: 0.44803386926651, gen p mean: -0.2307298630475998, mean p set: 0.44861605763435364
The modified gen p mean: 0.4487273693084717, gen p mean: -0.23161832988262177, mean p set: 0.44930922985076904
loss_pred:0.01468227431178093, decouple_loss:0.0023421451915055513
loss_pred:0.014502701349556446, decouple_loss:0.0025436230935156345
Iteration: 3185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926995038986206, gen p mean: -0.23200592398643494, mean p set: 0.4498407244682312
loss_pred:0.014629879966378212, decouple_loss:0.0022828071378171444
The modified gen p mean: 0.44754523038864136, gen p mean: -0.23549138009548187, mean p set: 0.4481198489665985The modified gen p mean: 0.44974619150161743, gen p mean: -0.23563730716705322, mean p set: 0.4502703547477722
loss_pred:0.014354383572936058, decouple_loss:0.0023356035817414522
loss_pred:0.014889094047248363, decouple_loss:0.002143590012565255
Iteration: 3186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925788044929504, gen p mean: -0.24004627764225006, mean p set: 0.44983842968940735
loss_pred:0.015061390586197376, decouple_loss:0.0019047284731641412
The modified gen p mean: 0.4480622112751007, gen p mean: -0.22569172084331512, mean p set: 0.4485895335674286The modified gen p mean: 0.4498070180416107, gen p mean: -0.2361154407262802, mean p set: 0.4503842294216156
loss_pred:0.014808395877480507, decouple_loss:0.0021267132833600044
loss_pred:0.014232960529625416, decouple_loss:0.0019497873727232218
Iteration: 3187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763386249542236, gen p mean: -0.22382472455501556, mean p set: 0.44820865988731384
loss_pred:0.014740155078470707, decouple_loss:0.0023252491373568773
The modified gen p mean: 0.44903063774108887, gen p mean: -0.22755488753318787, mean p set: 0.4495595097541809The modified gen p mean: 0.4474829435348511, gen p mean: -0.22394520044326782, mean p set: 0.448056697845459
loss_pred:0.014219396747648716, decouple_loss:0.002273491583764553
loss_pred:0.014465225860476494, decouple_loss:0.0020362481009215117
Iteration: 3188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487701952457428, gen p mean: -0.21964915096759796, mean p set: 0.4493459463119507
loss_pred:0.015581303276121616, decouple_loss:0.0021388069726526737
The modified gen p mean: 0.4497258961200714, gen p mean: -0.21083170175552368, mean p set: 0.45029905438423157
loss_pred:0.015062959864735603, decouple_loss:0.0020180693827569485
The modified gen p mean: 0.44906866550445557, gen p mean: -0.2175002098083496, mean p set: 0.4495994448661804
loss_pred:0.015132438391447067, decouple_loss:0.0019945786334574223
Iteration: 3189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482995271682739, gen p mean: -0.23215351998806, mean p set: 0.4488680362701416
loss_pred:0.014290117658674717, decouple_loss:0.002582537941634655
The modified gen p mean: 0.4484061300754547, gen p mean: -0.23061951994895935, mean p set: 0.44898566603660583
loss_pred:0.014672920107841492, decouple_loss:0.0024001533165574074
The modified gen p mean: 0.4486966133117676, gen p mean: -0.22823256254196167, mean p set: 0.4492279887199402
loss_pred:0.01434252504259348, decouple_loss:0.002246759831905365
Iteration: 3190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005160570144653, gen p mean: -0.2316233217716217, mean p set: 0.45063140988349915
loss_pred:0.014625517651438713, decouple_loss:0.0023099472746253014
The modified gen p mean: 0.4494863748550415, gen p mean: -0.23884332180023193, mean p set: 0.4500616788864136
loss_pred:0.01461282279342413, decouple_loss:0.0023492842447012663
The modified gen p mean: 0.44718703627586365, gen p mean: -0.23333682119846344, mean p set: 0.4477255642414093
loss_pred:0.014481003396213055, decouple_loss:0.002359907841309905
2023-04-27 14:39:02 testing...
The modified gen p mean: 0.44821903109550476, gen p mean: -0.2380942553281784, mean p set: 0.44879910349845886
loss_pred:0.016122646629810333, decouple_loss:0.002377418801188469
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24141710996627808, mean p set: 0.4499112665653229
loss_pred:0.016239142045378685, decouple_loss:0.002429686952382326
The modified gen p mean: 0.4493086636066437, gen p mean: -0.2417585849761963, mean p set: 0.4498290419578552
loss_pred:0.015785450115799904, decouple_loss:0.002355326898396015
WV_1_PC_1_EH_0_PS_30, loss: 0.01616845279932022, avg_mse: 0.023935332894325256
current test mse: 0.023935
Iteration: 3191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806498289108276, gen p mean: -0.2364625632762909, mean p set: 0.448634535074234
loss_pred:0.014554798603057861, decouple_loss:0.0022307028993964195
The modified gen p mean: 0.44860368967056274, gen p mean: -0.24080336093902588, mean p set: 0.44917967915534973
loss_pred:0.014348586089909077, decouple_loss:0.002304122317582369
The modified gen p mean: 0.4464397132396698, gen p mean: -0.24099475145339966, mean p set: 0.4469698667526245
loss_pred:0.014404021203517914, decouple_loss:0.002397783799096942
Iteration: 3192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44993487000465393, gen p mean: -0.23896735906600952, mean p set: 0.45046207308769226
loss_pred:0.014353986829519272, decouple_loss:0.0022934162989258766
The modified gen p mean: 0.4491044282913208, gen p mean: -0.2388988435268402, mean p set: 0.449687123298645
loss_pred:0.015171260572969913, decouple_loss:0.0023171245120465755
The modified gen p mean: 0.4483840763568878, gen p mean: -0.24142757058143616, mean p set: 0.44896194338798523
loss_pred:0.015094626694917679, decouple_loss:0.0023738995660096407
Iteration: 3193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476760923862457, gen p mean: -0.2349412590265274, mean p set: 0.44820713996887207
loss_pred:0.015097239054739475, decouple_loss:0.0021976628340780735
The modified gen p mean: 0.4487420618534088, gen p mean: -0.23468901216983795, mean p set: 0.44932347536087036
loss_pred:0.014315509237349033, decouple_loss:0.002297398867085576
The modified gen p mean: 0.45031046867370605, gen p mean: -0.2305302917957306, mean p set: 0.4508882462978363
loss_pred:0.014469276182353497, decouple_loss:0.002210437785834074
Iteration: 3194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911208748817444, gen p mean: -0.2293338030576706, mean p set: 0.44964301586151123
loss_pred:0.014998745173215866, decouple_loss:0.002198589965701103
The modified gen p mean: 0.44786733388900757, gen p mean: -0.22598256170749664, mean p set: 0.44844722747802734
loss_pred:0.01497697178274393, decouple_loss:0.002272671088576317
The modified gen p mean: 0.44965291023254395, gen p mean: -0.22740478813648224, mean p set: 0.45022737979888916
loss_pred:0.014771215617656708, decouple_loss:0.0023406429681926966
Iteration: 3195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477948546409607, gen p mean: -0.22328850626945496, mean p set: 0.4483669102191925
loss_pred:0.014674151316285133, decouple_loss:0.002111187670379877
The modified gen p mean: 0.4488331377506256, gen p mean: -0.2301296591758728, mean p set: 0.44936034083366394The modified gen p mean: 0.44845882058143616, gen p mean: -0.2312324196100235, mean p set: 0.44902855157852173
loss_pred:0.014448059722781181, decouple_loss:0.0022345036268234253loss_pred:0.015062067657709122, decouple_loss:0.0022118170745670795
Iteration: 3196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871217012405396, gen p mean: -0.2270287573337555, mean p set: 0.449288934469223
loss_pred:0.014881772920489311, decouple_loss:0.0020827746484428644
The modified gen p mean: 0.447838693857193, gen p mean: -0.22060610353946686, mean p set: 0.44837456941604614The modified gen p mean: 0.44728586077690125, gen p mean: -0.22836002707481384, mean p set: 0.4478663504123688
loss_pred:0.01438257098197937, decouple_loss:0.002398127457126975
loss_pred:0.01460939459502697, decouple_loss:0.0020535639487206936
Iteration: 3197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865837693214417, gen p mean: -0.21352572739124298, mean p set: 0.4492368996143341
loss_pred:0.01447418425232172, decouple_loss:0.0023938200902193785
The modified gen p mean: 0.44846251606941223, gen p mean: -0.22780156135559082, mean p set: 0.44904085993766785
loss_pred:0.014216229319572449, decouple_loss:0.0023023406974971294
The modified gen p mean: 0.44939351081848145, gen p mean: -0.2148900032043457, mean p set: 0.4499235153198242
loss_pred:0.014918810687959194, decouple_loss:0.002272752346470952
Iteration: 3198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477750062942505, gen p mean: -0.2162882387638092, mean p set: 0.4483490288257599
loss_pred:0.014383173547685146, decouple_loss:0.0024470847565680742
The modified gen p mean: 0.44830673933029175, gen p mean: -0.21049059927463531, mean p set: 0.44888070225715637
loss_pred:0.014130433090031147, decouple_loss:0.002317920560017228
The modified gen p mean: 0.4484860599040985, gen p mean: -0.21613964438438416, mean p set: 0.44900989532470703
loss_pred:0.014563191682100296, decouple_loss:0.002283782698214054
Iteration: 3199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491770565509796, gen p mean: -0.21991971135139465, mean p set: 0.44975459575653076
loss_pred:0.014346882700920105, decouple_loss:0.0023821801878511906
The modified gen p mean: 0.4493797719478607, gen p mean: -0.2181549370288849, mean p set: 0.4499533474445343
loss_pred:0.014393657445907593, decouple_loss:0.0022823591716587543
The modified gen p mean: 0.4493522047996521, gen p mean: -0.22080077230930328, mean p set: 0.44987955689430237
loss_pred:0.014525446109473705, decouple_loss:0.002527829958125949
Iteration: 3200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492887556552887, gen p mean: -0.21416880190372467, mean p set: 0.4498685300350189
loss_pred:0.01487058587372303, decouple_loss:0.002110131550580263
The modified gen p mean: 0.4480522871017456, gen p mean: -0.2131848931312561, mean p set: 0.4485769271850586The modified gen p mean: 0.4488835334777832, gen p mean: -0.21819806098937988, mean p set: 0.44945788383483887
loss_pred:0.014126353897154331, decouple_loss:0.002024077344685793
loss_pred:0.014206706546247005, decouple_loss:0.00252523273229599
2023-04-27 14:42:27 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21880069375038147, mean p set: 0.4499112665653229
loss_pred:0.016053473576903343, decouple_loss:0.0022304009180516005
The modified gen p mean: 0.4493027925491333, gen p mean: -0.2191026657819748, mean p set: 0.4498290419578552
loss_pred:0.01562703773379326, decouple_loss:0.0023697116412222385
The modified gen p mean: 0.44822514057159424, gen p mean: -0.21588760614395142, mean p set: 0.44879910349845886
loss_pred:0.015981458127498627, decouple_loss:0.0022734079975634813
WV_1_PC_1_EH_0_PS_30, loss: 0.016001882031559944, avg_mse: 0.02362946793437004
current test mse: 0.023629
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 3201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747573137283325, gen p mean: -0.2219836413860321, mean p set: 0.4480043649673462
loss_pred:0.01614946685731411, decouple_loss:0.0021939047146588564
The modified gen p mean: 0.44744032621383667, gen p mean: -0.21797311305999756, mean p set: 0.4480176270008087
loss_pred:0.015983110293745995, decouple_loss:0.0022368149366229773
The modified gen p mean: 0.4472062289714813, gen p mean: -0.21879422664642334, mean p set: 0.44777771830558777
loss_pred:0.015900317579507828, decouple_loss:0.0021016693208366632
Iteration: 3202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479835331439972, gen p mean: -0.22145703434944153, mean p set: 0.4485156238079071
loss_pred:0.014922196976840496, decouple_loss:0.0024027221370488405
The modified gen p mean: 0.44776251912117004, gen p mean: -0.21927662193775177, mean p set: 0.44833505153656006
The modified gen p mean: 0.44722145795822144, gen p mean: -0.22007626295089722, mean p set: 0.4478038251399994
loss_pred:0.015727153047919273, decouple_loss:0.0023398122284561396
loss_pred:0.015569380484521389, decouple_loss:0.0022875608410686255
Iteration: 3203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796064496040344, gen p mean: -0.22509945929050446, mean p set: 0.44848695397377014
loss_pred:0.015315999276936054, decouple_loss:0.001971330726519227
The modified gen p mean: 0.4473941922187805, gen p mean: -0.22072631120681763, mean p set: 0.4479702413082123
The modified gen p mean: 0.44711369276046753, gen p mean: -0.2235182672739029, mean p set: 0.44768041372299194
loss_pred:0.015444436110556126, decouple_loss:0.001999269938096404
loss_pred:0.014828070066869259, decouple_loss:0.002187293255701661
Iteration: 3204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786036014556885, gen p mean: -0.22004292905330658, mean p set: 0.4483889639377594
loss_pred:0.01575418747961521, decouple_loss:0.002260725712403655
The modified gen p mean: 0.4480372369289398, gen p mean: -0.22177600860595703, mean p set: 0.4486115872859955
The modified gen p mean: 0.44742557406425476, gen p mean: -0.22648076713085175, mean p set: 0.4480067491531372
loss_pred:0.015576439909636974, decouple_loss:0.00217401422560215
loss_pred:0.01570441760122776, decouple_loss:0.0020469145383685827
Iteration: 3205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474301040172577, gen p mean: -0.22568883001804352, mean p set: 0.44800713658332825
loss_pred:0.015059394761919975, decouple_loss:0.002101063495501876
The modified gen p mean: 0.44767117500305176, gen p mean: -0.22680729627609253, mean p set: 0.44824355840682983
loss_pred:0.015747899189591408, decouple_loss:0.0020975160878151655
The modified gen p mean: 0.4469381272792816, gen p mean: -0.2195741981267929, mean p set: 0.4474641680717468
loss_pred:0.016197526827454567, decouple_loss:0.0021121164318174124
Iteration: 3206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804564118385315, gen p mean: -0.22955307364463806, mean p set: 0.4486217796802521
loss_pred:0.015091725625097752, decouple_loss:0.002218494424596429
The modified gen p mean: 0.44714170694351196, gen p mean: -0.22823509573936462, mean p set: 0.44767072796821594The modified gen p mean: 0.44753924012184143, gen p mean: -0.2222466915845871, mean p set: 0.4481123387813568
loss_pred:0.015195846557617188, decouple_loss:0.0022904525976628065
loss_pred:0.015811949968338013, decouple_loss:0.0020698257721960545
Iteration: 3207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462083876132965, gen p mean: -0.22397105395793915, mean p set: 0.44678664207458496
loss_pred:0.015029189176857471, decouple_loss:0.0019278778927400708
The modified gen p mean: 0.4470553994178772, gen p mean: -0.22814291715621948, mean p set: 0.44758090376853943The modified gen p mean: 0.44719448685646057, gen p mean: -0.22435824573040009, mean p set: 0.4477778375148773
loss_pred:0.014913448132574558, decouple_loss:0.0021688349079340696
loss_pred:0.015326605178415775, decouple_loss:0.002055135788396001
Iteration: 3208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738733768463135, gen p mean: -0.21912340819835663, mean p set: 0.4479668438434601
loss_pred:0.016022130846977234, decouple_loss:0.002162079093977809
The modified gen p mean: 0.44769641757011414, gen p mean: -0.21879532933235168, mean p set: 0.4482730031013489
loss_pred:0.015198110602796078, decouple_loss:0.0020027626305818558
The modified gen p mean: 0.4477434456348419, gen p mean: -0.22554680705070496, mean p set: 0.4482708275318146
loss_pred:0.015984060242772102, decouple_loss:0.002015695907175541
Iteration: 3209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744929671287537, gen p mean: -0.21892179548740387, mean p set: 0.4480361342430115
loss_pred:0.015496690757572651, decouple_loss:0.0019231169717386365
The modified gen p mean: 0.4466078281402588, gen p mean: -0.22168269753456116, mean p set: 0.44713303446769714The modified gen p mean: 0.4476407766342163, gen p mean: -0.22020494937896729, mean p set: 0.4482216238975525
loss_pred:0.015953753143548965, decouple_loss:0.0020733170676976442
loss_pred:0.014757813885807991, decouple_loss:0.001937716850079596
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708818197250366, gen p mean: -0.220376655459404, mean p set: 0.4476645588874817
loss_pred:0.015510658733546734, decouple_loss:0.0019886295776814222
The modified gen p mean: 0.4475152790546417, gen p mean: -0.2189725637435913, mean p set: 0.4480897784233093
loss_pred:0.015383468940854073, decouple_loss:0.002109583467245102
The modified gen p mean: 0.44753554463386536, gen p mean: -0.2238462120294571, mean p set: 0.4480603337287903
loss_pred:0.015397493727505207, decouple_loss:0.0021804184652864933
2023-04-27 14:46:30 testing...
The modified gen p mean: 0.44822487235069275, gen p mean: -0.21870481967926025, mean p set: 0.44879910349845886
loss_pred:0.015796303749084473, decouple_loss:0.0019447371596470475
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22172494232654572, mean p set: 0.4499112665653229
loss_pred:0.01584840752184391, decouple_loss:0.0020896862260997295
The modified gen p mean: 0.44930312037467957, gen p mean: -0.22170501947402954, mean p set: 0.4498290419578552
loss_pred:0.0154746538028121, decouple_loss:0.002022695494815707
WV_1_PC_1_EH_0_PS_30, loss: 0.015807408839464188, avg_mse: 0.02336747758090496
current test mse: 0.023367
Iteration: 3211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459163248538971, gen p mean: -0.22060352563858032, mean p set: 0.44649389386177063
loss_pred:0.014529762789607048, decouple_loss:0.001868077670224011
The modified gen p mean: 0.44677141308784485, gen p mean: -0.22266405820846558, mean p set: 0.44729599356651306
loss_pred:0.0145666329190135, decouple_loss:0.00204080599360168
The modified gen p mean: 0.4476659893989563, gen p mean: -0.2266256958246231, mean p set: 0.4482428729534149
loss_pred:0.015132791362702847, decouple_loss:0.0020516221411526203
Iteration: 3212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853904843330383, gen p mean: -0.2251909077167511, mean p set: 0.4490669369697571
loss_pred:0.015186110511422157, decouple_loss:0.00195843493565917
The modified gen p mean: 0.44702550768852234, gen p mean: -0.22095121443271637, mean p set: 0.4475988745689392
loss_pred:0.015088765881955624, decouple_loss:0.0018874142551794648
The modified gen p mean: 0.44849634170532227, gen p mean: -0.2277112901210785, mean p set: 0.4490697383880615
loss_pred:0.014836965128779411, decouple_loss:0.002015554578974843
Iteration: 3213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473487436771393, gen p mean: -0.22404274344444275, mean p set: 0.4478713572025299
loss_pred:0.01579716056585312, decouple_loss:0.002229895908385515
The modified gen p mean: 0.44716641306877136, gen p mean: -0.23127709329128265, mean p set: 0.44774720072746277
loss_pred:0.0148036889731884, decouple_loss:0.0019365805201232433
The modified gen p mean: 0.4468200206756592, gen p mean: -0.2306852489709854, mean p set: 0.44739648699760437
loss_pred:0.01598029024899006, decouple_loss:0.002049490576609969
Iteration: 3214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447133332490921, gen p mean: -0.22888366878032684, mean p set: 0.4476606547832489
loss_pred:0.015540293417870998, decouple_loss:0.0018806209554895759
The modified gen p mean: 0.4474916458129883, gen p mean: -0.23171035945415497, mean p set: 0.44806763529777527
loss_pred:0.015086176805198193, decouple_loss:0.0020168651826679707
The modified gen p mean: 0.4476252794265747, gen p mean: -0.23103581368923187, mean p set: 0.44820162653923035
loss_pred:0.015703456476330757, decouple_loss:0.0019079664489254355
Iteration: 3215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447131872177124, gen p mean: -0.23163437843322754, mean p set: 0.44771143794059753
loss_pred:0.015597340650856495, decouple_loss:0.0021006979513913393
The modified gen p mean: 0.44703447818756104, gen p mean: -0.22513426840305328, mean p set: 0.44755926728248596The modified gen p mean: 0.446677029132843, gen p mean: -0.22806617617607117, mean p set: 0.44725102186203003
loss_pred:0.016105642542243004, decouple_loss:0.0019328842172399163
loss_pred:0.014782870188355446, decouple_loss:0.001784777850843966
Iteration: 3216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475249648094177, gen p mean: -0.22492432594299316, mean p set: 0.4481000304222107
loss_pred:0.015474876388907433, decouple_loss:0.0020751655101776123
The modified gen p mean: 0.44622603058815, gen p mean: -0.22418630123138428, mean p set: 0.4467572569847107The modified gen p mean: 0.44734761118888855, gen p mean: -0.22875256836414337, mean p set: 0.44792598485946655
loss_pred:0.015359746292233467, decouple_loss:0.001952580874785781
loss_pred:0.014490712434053421, decouple_loss:0.001900729606859386
Iteration: 3217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705674052238464, gen p mean: -0.22516942024230957, mean p set: 0.44763314723968506
loss_pred:0.01583227887749672, decouple_loss:0.002026116708293557
The modified gen p mean: 0.44724005460739136, gen p mean: -0.22067216038703918, mean p set: 0.44781771302223206
loss_pred:0.01571819931268692, decouple_loss:0.0019037483725696802
The modified gen p mean: 0.4476170539855957, gen p mean: -0.22627687454223633, mean p set: 0.4481448233127594
loss_pred:0.015441235154867172, decouple_loss:0.0021317352075129747
Iteration: 3218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473627209663391, gen p mean: -0.2253522425889969, mean p set: 0.44793930649757385
loss_pred:0.01584017463028431, decouple_loss:0.0021110447123646736
The modified gen p mean: 0.4472610354423523, gen p mean: -0.22409416735172272, mean p set: 0.44783589243888855
loss_pred:0.014791256748139858, decouple_loss:0.001974338898435235
The modified gen p mean: 0.44691020250320435, gen p mean: -0.22477874159812927, mean p set: 0.447443425655365
loss_pred:0.015039914287626743, decouple_loss:0.0021704244427382946
Iteration: 3219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470933675765991, gen p mean: -0.22185862064361572, mean p set: 0.44767072796821594
loss_pred:0.01565587893128395, decouple_loss:0.00206514704041183
The modified gen p mean: 0.4469243884086609, gen p mean: -0.22044526040554047, mean p set: 0.44749921560287476
loss_pred:0.015361219644546509, decouple_loss:0.0022182194516062737
The modified gen p mean: 0.4476187229156494, gen p mean: -0.220290869474411, mean p set: 0.4481445848941803
loss_pred:0.014869745820760727, decouple_loss:0.00204946449957788
Iteration: 3220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749853014945984, gen p mean: -0.22302861511707306, mean p set: 0.44807714223861694
loss_pred:0.015400334261357784, decouple_loss:0.0022205905988812447
The modified gen p mean: 0.44649332761764526, gen p mean: -0.22400426864624023, mean p set: 0.44702383875846863The modified gen p mean: 0.44824057817459106, gen p mean: -0.22538426518440247, mean p set: 0.4488099217414856
loss_pred:0.015818346291780472, decouple_loss:0.0021071850787848234
loss_pred:0.014974758960306644, decouple_loss:0.0020015554036945105
2023-04-27 14:49:55 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22551366686820984, mean p set: 0.4499112665653229
loss_pred:0.01590358465909958, decouple_loss:0.0021345249842852354
The modified gen p mean: 0.4493010938167572, gen p mean: -0.22586970031261444, mean p set: 0.4498290419578552
loss_pred:0.015522788278758526, decouple_loss:0.002397967502474785
The modified gen p mean: 0.4482273459434509, gen p mean: -0.2228163629770279, mean p set: 0.44879910349845886
loss_pred:0.015873314812779427, decouple_loss:0.002347540343180299
WV_1_PC_1_EH_0_PS_30, loss: 0.01588122919201851, avg_mse: 0.023518038913607597
current test mse: 0.023518
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 3221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493868350982666, gen p mean: -0.22903068363666534, mean p set: 0.4499218463897705
loss_pred:0.014516662806272507, decouple_loss:0.002160588512197137
The modified gen p mean: 0.44933101534843445, gen p mean: -0.22528822720050812, mean p set: 0.4499005675315857
loss_pred:0.014560041949152946, decouple_loss:0.0023980350233614445
The modified gen p mean: 0.45006370544433594, gen p mean: -0.2251581996679306, mean p set: 0.45064398646354675
loss_pred:0.013440174981951714, decouple_loss:0.0025433674454689026
Iteration: 3222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501684606075287, gen p mean: -0.2243064045906067, mean p set: 0.4507005214691162
loss_pred:0.013791327364742756, decouple_loss:0.0024216792080551386
The modified gen p mean: 0.4498302936553955, gen p mean: -0.2223692536354065, mean p set: 0.450408935546875
The modified gen p mean: 0.4492224454879761, gen p mean: -0.22458085417747498, mean p set: 0.4497992694377899
loss_pred:0.013874183408915997, decouple_loss:0.00218922458589077
loss_pred:0.014082751236855984, decouple_loss:0.002261290093883872
Iteration: 3223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45054560899734497, gen p mean: -0.22502072155475616, mean p set: 0.4510750472545624
loss_pred:0.014372196048498154, decouple_loss:0.0022462636698037386
The modified gen p mean: 0.448772668838501, gen p mean: -0.22281363606452942, mean p set: 0.4493516683578491
The modified gen p mean: 0.44764336943626404, gen p mean: -0.22128303349018097, mean p set: 0.4482172131538391
loss_pred:0.015262339264154434, decouple_loss:0.0024410923942923546
loss_pred:0.014455283991992474, decouple_loss:0.0023877297062426805
Iteration: 3224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902679324150085, gen p mean: -0.23003911972045898, mean p set: 0.4495563805103302
loss_pred:0.014651547186076641, decouple_loss:0.0025478836614638567
The modified gen p mean: 0.4501499831676483, gen p mean: -0.22141875326633453, mean p set: 0.4507233798503876
The modified gen p mean: 0.44895678758621216, gen p mean: -0.21971958875656128, mean p set: 0.44953563809394836
loss_pred:0.014358279295265675, decouple_loss:0.00232946639880538
loss_pred:0.014173098839819431, decouple_loss:0.002173877786844969
Iteration: 3225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500269889831543, gen p mean: -0.227237731218338, mean p set: 0.4505973160266876
loss_pred:0.014388540759682655, decouple_loss:0.002690710127353668
The modified gen p mean: 0.449963241815567, gen p mean: -0.22556805610656738, mean p set: 0.4504936933517456The modified gen p mean: 0.45067325234413147, gen p mean: -0.22341236472129822, mean p set: 0.4512515664100647
loss_pred:0.013411054387688637, decouple_loss:0.0026923068799078465
loss_pred:0.01428270898759365, decouple_loss:0.002439143368974328
Iteration: 3226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494990408420563, gen p mean: -0.22656652331352234, mean p set: 0.45007139444351196
loss_pred:0.01474881824105978, decouple_loss:0.0021318020299077034
The modified gen p mean: 0.4502350389957428, gen p mean: -0.22904084622859955, mean p set: 0.45076262950897217The modified gen p mean: 0.44891002774238586, gen p mean: -0.2353038638830185, mean p set: 0.4494844079017639
loss_pred:0.014723081141710281, decouple_loss:0.0019917222671210766
loss_pred:0.01359852310270071, decouple_loss:0.0020890275482088327
Iteration: 3227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032572746276855, gen p mean: -0.22570069134235382, mean p set: 0.4508989155292511
loss_pred:0.013742509298026562, decouple_loss:0.0024136893916875124
The modified gen p mean: 0.44747674465179443, gen p mean: -0.22383496165275574, mean p set: 0.448009192943573The modified gen p mean: 0.4498136043548584, gen p mean: -0.22388987243175507, mean p set: 0.4503912329673767
loss_pred:0.013105333782732487, decouple_loss:0.0024886333849281073
loss_pred:0.013963987119495869, decouple_loss:0.0022364542819559574
Iteration: 3228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474264681339264, gen p mean: -0.22442975640296936, mean p set: 0.4479977786540985
loss_pred:0.01428630668669939, decouple_loss:0.001791888615116477
The modified gen p mean: 0.4490540325641632, gen p mean: -0.22767984867095947, mean p set: 0.44958579540252686The modified gen p mean: 0.44960254430770874, gen p mean: -0.2281879186630249, mean p set: 0.45017769932746887
loss_pred:0.01411148440092802, decouple_loss:0.0018331862520426512
loss_pred:0.014526383019983768, decouple_loss:0.0020045237615704536
Iteration: 3229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494635760784149, gen p mean: -0.22570228576660156, mean p set: 0.4500423073768616
loss_pred:0.01489343587309122, decouple_loss:0.002375227166339755
The modified gen p mean: 0.4485745429992676, gen p mean: -0.22276729345321655, mean p set: 0.4491027593612671The modified gen p mean: 0.44930943846702576, gen p mean: -0.22995755076408386, mean p set: 0.4498860538005829
loss_pred:0.014773841015994549, decouple_loss:0.0021652299910783768
loss_pred:0.014490150846540928, decouple_loss:0.002319563878700137
Iteration: 3230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881224632263184, gen p mean: -0.22538667917251587, mean p set: 0.44939103722572327
loss_pred:0.01458360068500042, decouple_loss:0.002181262243539095
The modified gen p mean: 0.45048391819000244, gen p mean: -0.22282211482524872, mean p set: 0.45106109976768494
loss_pred:0.013511741533875465, decouple_loss:0.002195697743445635
The modified gen p mean: 0.44870683550834656, gen p mean: -0.22300760447978973, mean p set: 0.4492337107658386
loss_pred:0.013868679292500019, decouple_loss:0.001960358116775751
2023-04-27 14:53:58 testing...
The modified gen p mean: 0.44822603464126587, gen p mean: -0.22054331004619598, mean p set: 0.44879910349845886
loss_pred:0.015950271859765053, decouple_loss:0.0021410505287349224
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2234497368335724, mean p set: 0.4499112665653229
loss_pred:0.01602509245276451, decouple_loss:0.002202315255999565
The modified gen p mean: 0.44930198788642883, gen p mean: -0.22365976870059967, mean p set: 0.4498290419578552
loss_pred:0.015648923814296722, decouple_loss:0.0022050165571272373
WV_1_PC_1_EH_0_PS_30, loss: 0.015983901917934418, avg_mse: 0.02366624027490616
current test mse: 0.023666
Iteration: 3231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502513110637665, gen p mean: -0.22170361876487732, mean p set: 0.4508228898048401
loss_pred:0.013717547990381718, decouple_loss:0.0021787232253700495
The modified gen p mean: 0.4482746124267578, gen p mean: -0.22737544775009155, mean p set: 0.44884857535362244
loss_pred:0.014518936164677143, decouple_loss:0.0022650272585451603
The modified gen p mean: 0.44895094633102417, gen p mean: -0.22522760927677155, mean p set: 0.4494830369949341
loss_pred:0.014029677957296371, decouple_loss:0.002102252095937729
Iteration: 3232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872143864631653, gen p mean: -0.21763992309570312, mean p set: 0.4492511451244354
loss_pred:0.015291583724319935, decouple_loss:0.0022763200104236603
The modified gen p mean: 0.44932428002357483, gen p mean: -0.2214871048927307, mean p set: 0.4498968720436096
loss_pred:0.013454592786729336, decouple_loss:0.0021113373804837465
The modified gen p mean: 0.45034661889076233, gen p mean: -0.22027285397052765, mean p set: 0.45092666149139404
loss_pred:0.014149323105812073, decouple_loss:0.002265214454382658
Iteration: 3233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45015376806259155, gen p mean: -0.21993732452392578, mean p set: 0.4506858289241791
loss_pred:0.014048313722014427, decouple_loss:0.0020309488754719496
The modified gen p mean: 0.4503442049026489, gen p mean: -0.21580585837364197, mean p set: 0.4509190618991852
loss_pred:0.014210708439350128, decouple_loss:0.0019274679943919182
The modified gen p mean: 0.44714656472206116, gen p mean: -0.219056636095047, mean p set: 0.4477207064628601
loss_pred:0.01421647984534502, decouple_loss:0.001968229888007045
Iteration: 3234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44946789741516113, gen p mean: -0.21788431704044342, mean p set: 0.4499913156032562
loss_pred:0.013902159407734871, decouple_loss:0.0023210004437714815
The modified gen p mean: 0.4471105933189392, gen p mean: -0.22176022827625275, mean p set: 0.4476839303970337
loss_pred:0.014215247705578804, decouple_loss:0.0025549561250954866
The modified gen p mean: 0.44815611839294434, gen p mean: -0.22067421674728394, mean p set: 0.44873154163360596
loss_pred:0.013901342637836933, decouple_loss:0.002376335673034191
Iteration: 3235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483550488948822, gen p mean: -0.21882854402065277, mean p set: 0.4489321708679199
loss_pred:0.013878106139600277, decouple_loss:0.001968919299542904
The modified gen p mean: 0.4504941701889038, gen p mean: -0.21831734478473663, mean p set: 0.4510194957256317
loss_pred:0.013708412647247314, decouple_loss:0.002179633127525449
The modified gen p mean: 0.44975560903549194, gen p mean: -0.21939274668693542, mean p set: 0.4503350555896759
loss_pred:0.014310191385447979, decouple_loss:0.002173042856156826
Iteration: 3236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483207166194916, gen p mean: -0.21970874071121216, mean p set: 0.44889214634895325
loss_pred:0.014323578216135502, decouple_loss:0.0018529582303017378
The modified gen p mean: 0.4496518075466156, gen p mean: -0.2210288941860199, mean p set: 0.4501778185367584The modified gen p mean: 0.4490637481212616, gen p mean: -0.22710713744163513, mean p set: 0.4496326744556427
loss_pred:0.014336016960442066, decouple_loss:0.002186152385547757
loss_pred:0.014331219717860222, decouple_loss:0.002132480265572667
Iteration: 3237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478616714477539, gen p mean: -0.22837437689304352, mean p set: 0.44843724370002747
loss_pred:0.014214225113391876, decouple_loss:0.002128258580341935
The modified gen p mean: 0.44938990473747253, gen p mean: -0.2258484810590744, mean p set: 0.4499257802963257The modified gen p mean: 0.44913557171821594, gen p mean: -0.22288386523723602, mean p set: 0.449707955121994
loss_pred:0.014336480759084225, decouple_loss:0.002099821576848626
loss_pred:0.014318451285362244, decouple_loss:0.0020135657396167517
Iteration: 3238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923514127731323, gen p mean: -0.22648504376411438, mean p set: 0.4498126208782196
loss_pred:0.013994690962135792, decouple_loss:0.0019052710849791765
The modified gen p mean: 0.4482661187648773, gen p mean: -0.2207048386335373, mean p set: 0.4487907588481903The modified gen p mean: 0.4488229751586914, gen p mean: -0.22282865643501282, mean p set: 0.4494022727012634
loss_pred:0.015035292133688927, decouple_loss:0.0017589235212653875
loss_pred:0.01452687568962574, decouple_loss:0.001830754685215652
Iteration: 3239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477809965610504, gen p mean: -0.2175547331571579, mean p set: 0.44835996627807617
loss_pred:0.015065031126141548, decouple_loss:0.0020832412410527468
The modified gen p mean: 0.44960248470306396, gen p mean: -0.2191416621208191, mean p set: 0.4501335322856903
The modified gen p mean: 0.4501882493495941, gen p mean: -0.21936441957950592, mean p set: 0.4507656991481781
loss_pred:0.01403676439076662, decouple_loss:0.0020783739164471626
loss_pred:0.013724340125918388, decouple_loss:0.0020532405469566584
Iteration: 3240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996902346611023, gen p mean: -0.22091734409332275, mean p set: 0.4505492150783539
loss_pred:0.013547184877097607, decouple_loss:0.001971967052668333
The modified gen p mean: 0.4489629566669464, gen p mean: -0.21861648559570312, mean p set: 0.44949066638946533The modified gen p mean: 0.44883620738983154, gen p mean: -0.22193360328674316, mean p set: 0.4494141638278961
loss_pred:0.014781717211008072, decouple_loss:0.0017131188651546836
loss_pred:0.014350426383316517, decouple_loss:0.0018680196953937411
2023-04-27 14:57:24 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22211945056915283, mean p set: 0.4499112665653229
loss_pred:0.016045566648244858, decouple_loss:0.001979681197553873
The modified gen p mean: 0.4493027627468109, gen p mean: -0.2224186807870865, mean p set: 0.4498290419578552
loss_pred:0.01563158817589283, decouple_loss:0.002184809185564518
The modified gen p mean: 0.4482254981994629, gen p mean: -0.2193175107240677, mean p set: 0.44879910349845886
loss_pred:0.015966687351465225, decouple_loss:0.002155034337192774
WV_1_PC_1_EH_0_PS_30, loss: 0.0159866064786911, avg_mse: 0.023663243278861046
current test mse: 0.023663
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 3241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472888112068176, gen p mean: -0.2272205948829651, mean p set: 0.44781628251075745
loss_pred:0.015278041362762451, decouple_loss:0.0019107852131128311
The modified gen p mean: 0.4460945427417755, gen p mean: -0.2238723188638687, mean p set: 0.44667288661003113
loss_pred:0.014517903327941895, decouple_loss:0.0019649986643344164
The modified gen p mean: 0.44807755947113037, gen p mean: -0.22101426124572754, mean p set: 0.4486536979675293
loss_pred:0.014771104790270329, decouple_loss:0.0017785769887268543
Iteration: 3242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828540086746216, gen p mean: -0.21647058427333832, mean p set: 0.4488171935081482
loss_pred:0.014588539488613605, decouple_loss:0.001833618269301951
The modified gen p mean: 0.448031485080719, gen p mean: -0.2186257541179657, mean p set: 0.44860827922821045
The modified gen p mean: 0.4457632005214691, gen p mean: -0.21989351511001587, mean p set: 0.446336567401886
loss_pred:0.0144377825781703, decouple_loss:0.0018737484933808446
loss_pred:0.014583395794034004, decouple_loss:0.0017833001911640167
Iteration: 3243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460180401802063, gen p mean: -0.22051884233951569, mean p set: 0.4465450048446655
loss_pred:0.01472916267812252, decouple_loss:0.0017904490232467651
The modified gen p mean: 0.44786229729652405, gen p mean: -0.21985392272472382, mean p set: 0.44843369722366333
The modified gen p mean: 0.4479997456073761, gen p mean: -0.21707536280155182, mean p set: 0.4485742151737213
loss_pred:0.014582122676074505, decouple_loss:0.0018095335690304637
loss_pred:0.014560623094439507, decouple_loss:0.0017963359132409096
Iteration: 3244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663798809051514, gen p mean: -0.21711453795433044, mean p set: 0.4471621811389923
loss_pred:0.014796068891882896, decouple_loss:0.0018823535647243261
The modified gen p mean: 0.4481777846813202, gen p mean: -0.2218063771724701, mean p set: 0.44875964522361755
The modified gen p mean: 0.4475911259651184, gen p mean: -0.21751540899276733, mean p set: 0.44817250967025757
loss_pred:0.014722543768584728, decouple_loss:0.001855266746133566
loss_pred:0.014677612110972404, decouple_loss:0.0019130792934447527
Iteration: 3245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707125425338745, gen p mean: -0.21423152089118958, mean p set: 0.44764673709869385
loss_pred:0.015043546445667744, decouple_loss:0.0019428333034738898
The modified gen p mean: 0.4477757513523102, gen p mean: -0.2258966863155365, mean p set: 0.44830334186553955The modified gen p mean: 0.4476272165775299, gen p mean: -0.21438804268836975, mean p set: 0.44820424914360046
loss_pred:0.014487037435173988, decouple_loss:0.0020209315698593855
loss_pred:0.014878707006573677, decouple_loss:0.0017886522691696882
Iteration: 3246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479675590991974, gen p mean: -0.218660369515419, mean p set: 0.4485393166542053
loss_pred:0.014179409481585026, decouple_loss:0.0021867984905838966
The modified gen p mean: 0.44660815596580505, gen p mean: -0.21903400123119354, mean p set: 0.44713273644447327
The modified gen p mean: 0.4477655589580536, gen p mean: -0.21636317670345306, mean p set: 0.44834527373313904
loss_pred:0.015393252484500408, decouple_loss:0.0020061691757291555
loss_pred:0.014821517281234264, decouple_loss:0.002050492214038968
Iteration: 3247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777151942253113, gen p mean: -0.218240424990654, mean p set: 0.4483456313610077
loss_pred:0.014668282121419907, decouple_loss:0.0018501922022551298
The modified gen p mean: 0.4474705755710602, gen p mean: -0.21629120409488678, mean p set: 0.44799429178237915The modified gen p mean: 0.4480222463607788, gen p mean: -0.21889793872833252, mean p set: 0.4485970735549927
loss_pred:0.013966545462608337, decouple_loss:0.0018407036550343037
loss_pred:0.014102380722761154, decouple_loss:0.001842894358560443
Iteration: 3248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737523794174194, gen p mean: -0.21873979270458221, mean p set: 0.4479508101940155
loss_pred:0.01486661285161972, decouple_loss:0.0020015547052025795
The modified gen p mean: 0.44652947783470154, gen p mean: -0.2235914170742035, mean p set: 0.4471103250980377
loss_pred:0.015240013599395752, decouple_loss:0.0019799789879471064
The modified gen p mean: 0.4467160105705261, gen p mean: -0.22470499575138092, mean p set: 0.447241872549057
loss_pred:0.015124483034014702, decouple_loss:0.002037737751379609
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479481279850006, gen p mean: -0.22227105498313904, mean p set: 0.44852498173713684
loss_pred:0.01507627498358488, decouple_loss:0.001839176402427256
The modified gen p mean: 0.4472484290599823, gen p mean: -0.22712339460849762, mean p set: 0.447822630405426
loss_pred:0.014513516798615456, decouple_loss:0.0018419187981635332
The modified gen p mean: 0.44553470611572266, gen p mean: -0.22130218148231506, mean p set: 0.4460587203502655
loss_pred:0.014521278440952301, decouple_loss:0.0021511055529117584
Iteration: 3250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475308656692505, gen p mean: -0.22923897206783295, mean p set: 0.44810402393341064
loss_pred:0.01443549059331417, decouple_loss:0.0019002235494554043
The modified gen p mean: 0.4473443925380707, gen p mean: -0.22313447296619415, mean p set: 0.44792816042900085
loss_pred:0.014386615715920925, decouple_loss:0.0019119882490485907
The modified gen p mean: 0.44598811864852905, gen p mean: -0.22362497448921204, mean p set: 0.44651728868484497
loss_pred:0.014636323787271976, decouple_loss:0.001920947921462357
2023-04-27 15:01:31 testing...
The modified gen p mean: 0.44821950793266296, gen p mean: -0.22504118084907532, mean p set: 0.44879910349845886
loss_pred:0.015805738046765327, decouple_loss:0.0019334966782480478
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22773128747940063, mean p set: 0.4499112665653229
loss_pred:0.015904990956187248, decouple_loss:0.0019098955672234297
The modified gen p mean: 0.4493003487586975, gen p mean: -0.22772039473056793, mean p set: 0.4498290419578552
loss_pred:0.015569566749036312, decouple_loss:0.001939179957844317
WV_1_PC_1_EH_0_PS_30, loss: 0.01585647463798523, avg_mse: 0.023500461131334305
current test mse: 0.0235
Iteration: 3251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710102677345276, gen p mean: -0.2225336879491806, mean p set: 0.4476746618747711
loss_pred:0.014749662950634956, decouple_loss:0.0017558685503900051
The modified gen p mean: 0.4465809762477875, gen p mean: -0.22816170752048492, mean p set: 0.44715774059295654
loss_pred:0.014545027166604996, decouple_loss:0.0018622246570885181
The modified gen p mean: 0.4481566250324249, gen p mean: -0.2240075320005417, mean p set: 0.4486773908138275
loss_pred:0.014408012852072716, decouple_loss:0.0017729327082633972
Iteration: 3252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44637802243232727, gen p mean: -0.22431784868240356, mean p set: 0.4469052851200104
loss_pred:0.014701029285788536, decouple_loss:0.0019862770568579435
The modified gen p mean: 0.4485371708869934, gen p mean: -0.22934722900390625, mean p set: 0.449113667011261
loss_pred:0.014791066758334637, decouple_loss:0.002052013296633959
The modified gen p mean: 0.4482293725013733, gen p mean: -0.22253337502479553, mean p set: 0.4487995207309723
loss_pred:0.014916779473423958, decouple_loss:0.0018731106538325548
Iteration: 3253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472253620624542, gen p mean: -0.23374289274215698, mean p set: 0.44775745272636414
loss_pred:0.014690319076180458, decouple_loss:0.0021566718351095915
The modified gen p mean: 0.44723808765411377, gen p mean: -0.2293371558189392, mean p set: 0.4478101134300232
loss_pred:0.01473215501755476, decouple_loss:0.0020028259605169296
The modified gen p mean: 0.4478954076766968, gen p mean: -0.22868774831295013, mean p set: 0.4484725892543793
loss_pred:0.014157192781567574, decouple_loss:0.0019147327402606606
Iteration: 3254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621607661247253, gen p mean: -0.22621174156665802, mean p set: 0.4467467665672302
loss_pred:0.014405176974833012, decouple_loss:0.0019177673384547234
The modified gen p mean: 0.446924090385437, gen p mean: -0.22621522843837738, mean p set: 0.4474954903125763
loss_pred:0.015193480998277664, decouple_loss:0.0018929986981675029
The modified gen p mean: 0.44767969846725464, gen p mean: -0.22996364533901215, mean p set: 0.4482541084289551
loss_pred:0.014747142791748047, decouple_loss:0.0017970381304621696
Iteration: 3255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472448229789734, gen p mean: -0.22804883122444153, mean p set: 0.44781988859176636
loss_pred:0.015171533450484276, decouple_loss:0.002025672234594822
The modified gen p mean: 0.44761231541633606, gen p mean: -0.23089443147182465, mean p set: 0.4481382668018341The modified gen p mean: 0.44752323627471924, gen p mean: -0.2239459604024887, mean p set: 0.4480930268764496
loss_pred:0.014361328445374966, decouple_loss:0.0017196665285155177
loss_pred:0.0149708716198802, decouple_loss:0.001952194725163281
Iteration: 3256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447748064994812, gen p mean: -0.22435224056243896, mean p set: 0.44832247495651245
loss_pred:0.015183615498244762, decouple_loss:0.0018762181280180812
The modified gen p mean: 0.4465979039669037, gen p mean: -0.22895897924900055, mean p set: 0.4471730887889862
loss_pred:0.014820178039371967, decouple_loss:0.001845498918555677
The modified gen p mean: 0.44805312156677246, gen p mean: -0.22883489727973938, mean p set: 0.44857946038246155
loss_pred:0.014219379983842373, decouple_loss:0.0018765091663226485
Iteration: 3257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475395381450653, gen p mean: -0.23202793300151825, mean p set: 0.44811320304870605
loss_pred:0.014577365480363369, decouple_loss:0.0017387382686138153
The modified gen p mean: 0.44806450605392456, gen p mean: -0.22860825061798096, mean p set: 0.4486377537250519
loss_pred:0.014543566852807999, decouple_loss:0.0018717874772846699
The modified gen p mean: 0.44627201557159424, gen p mean: -0.2304222732782364, mean p set: 0.4468037486076355
loss_pred:0.014955260790884495, decouple_loss:0.0018700826913118362
Iteration: 3258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715985655784607, gen p mean: -0.2257634401321411, mean p set: 0.44773492217063904
loss_pred:0.014403901062905788, decouple_loss:0.0018076600972563028
The modified gen p mean: 0.4474417269229889, gen p mean: -0.222601979970932, mean p set: 0.4480171501636505
loss_pred:0.014993129298090935, decouple_loss:0.0020006990525871515
The modified gen p mean: 0.44664886593818665, gen p mean: -0.22092659771442413, mean p set: 0.447177916765213
loss_pred:0.014380380511283875, decouple_loss:0.001984828617423773
Iteration: 3259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472140967845917, gen p mean: -0.2267710417509079, mean p set: 0.4477926790714264
loss_pred:0.014701636508107185, decouple_loss:0.002132061868906021
The modified gen p mean: 0.44783610105514526, gen p mean: -0.22407977283000946, mean p set: 0.44840726256370544
loss_pred:0.014636890962719917, decouple_loss:0.002010911703109741
The modified gen p mean: 0.44859960675239563, gen p mean: -0.22359490394592285, mean p set: 0.4491317868232727
loss_pred:0.014142848551273346, decouple_loss:0.0019514212617650628
Iteration: 3260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722121953964233, gen p mean: -0.2293267846107483, mean p set: 0.44780153036117554
loss_pred:0.01526997983455658, decouple_loss:0.0018819106044247746
The modified gen p mean: 0.4477534592151642, gen p mean: -0.2228350192308426, mean p set: 0.44832614064216614
loss_pred:0.013788615353405476, decouple_loss:0.001955804182216525
The modified gen p mean: 0.4472355246543884, gen p mean: -0.22222404181957245, mean p set: 0.4477651119232178
loss_pred:0.014902438037097454, decouple_loss:0.0018654227023944259
2023-04-27 15:04:57 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22315840423107147, mean p set: 0.4499112665653229
loss_pred:0.01596752181649208, decouple_loss:0.0020535436924546957
The modified gen p mean: 0.44823476672172546, gen p mean: -0.2209102213382721, mean p set: 0.44879910349845886
loss_pred:0.015952415764331818, decouple_loss:0.0022669534664601088
The modified gen p mean: 0.4493016004562378, gen p mean: -0.22347211837768555, mean p set: 0.4498290419578552
loss_pred:0.015586528927087784, decouple_loss:0.002216996857896447
WV_1_PC_1_EH_0_PS_30, loss: 0.015944447368383408, avg_mse: 0.02360144816339016
current test mse: 0.023601
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 3261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819900393486023, gen p mean: -0.22072020173072815, mean p set: 0.44872552156448364
loss_pred:0.015372276306152344, decouple_loss:0.002089550718665123
The modified gen p mean: 0.44693708419799805, gen p mean: -0.2253243625164032, mean p set: 0.4475124180316925
loss_pred:0.015239105559885502, decouple_loss:0.0022043900098651648
The modified gen p mean: 0.44796642661094666, gen p mean: -0.22036150097846985, mean p set: 0.4485422670841217
loss_pred:0.01525862980633974, decouple_loss:0.0020422320812940598
Iteration: 3262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815900921821594, gen p mean: -0.22654390335083008, mean p set: 0.4486865699291229
loss_pred:0.015135260298848152, decouple_loss:0.0018692044541239738
The modified gen p mean: 0.4478212296962738, gen p mean: -0.2243361473083496, mean p set: 0.44839873909950256
loss_pred:0.015476224012672901, decouple_loss:0.0017701727338135242
The modified gen p mean: 0.44786185026168823, gen p mean: -0.22691217064857483, mean p set: 0.4484356641769409
loss_pred:0.015272766351699829, decouple_loss:0.0018892788793891668
Iteration: 3263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467160999774933, gen p mean: -0.22688688337802887, mean p set: 0.44724538922309875
loss_pred:0.0155706275254488, decouple_loss:0.0019844172056764364
The modified gen p mean: 0.44853782653808594, gen p mean: -0.22895438969135284, mean p set: 0.44911372661590576
loss_pred:0.01507142186164856, decouple_loss:0.0020983212161809206
The modified gen p mean: 0.44869738817214966, gen p mean: -0.22882436215877533, mean p set: 0.4492678940296173
loss_pred:0.014657056890428066, decouple_loss:0.0019426991930231452
Iteration: 3264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811007380485535, gen p mean: -0.22453275322914124, mean p set: 0.44864311814308167
loss_pred:0.014888329431414604, decouple_loss:0.001747288042679429
The modified gen p mean: 0.4479304850101471, gen p mean: -0.22677366435527802, mean p set: 0.4485013484954834
loss_pred:0.015327257104218006, decouple_loss:0.0018421006388962269
The modified gen p mean: 0.44802457094192505, gen p mean: -0.22763372957706451, mean p set: 0.448603093624115
loss_pred:0.015263514593243599, decouple_loss:0.0017972239293158054
Iteration: 3265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682547450065613, gen p mean: -0.22661472856998444, mean p set: 0.44740280508995056
loss_pred:0.014876743778586388, decouple_loss:0.0019527245312929153
The modified gen p mean: 0.44835153222084045, gen p mean: -0.22105035185813904, mean p set: 0.4489271342754364The modified gen p mean: 0.44725465774536133, gen p mean: -0.22675198316574097, mean p set: 0.4477825164794922
loss_pred:0.01460253819823265, decouple_loss:0.0019634440541267395
loss_pred:0.015457483939826488, decouple_loss:0.002012187149375677
Iteration: 3266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843533635139465, gen p mean: -0.2180086374282837, mean p set: 0.4490111172199249
loss_pred:0.014506987296044827, decouple_loss:0.0018523384351283312
The modified gen p mean: 0.4472379684448242, gen p mean: -0.21718211472034454, mean p set: 0.44781461358070374
loss_pred:0.015452663414180279, decouple_loss:0.0017113682115450501
The modified gen p mean: 0.44786807894706726, gen p mean: -0.2213519960641861, mean p set: 0.4483935534954071
loss_pred:0.014721080660820007, decouple_loss:0.0017982814460992813
Iteration: 3267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866254925727844, gen p mean: -0.21767215430736542, mean p set: 0.4492388963699341
loss_pred:0.014759371988475323, decouple_loss:0.0020392066799104214
The modified gen p mean: 0.44811809062957764, gen p mean: -0.21710380911827087, mean p set: 0.44869464635849
loss_pred:0.014965472742915154, decouple_loss:0.0019167030695825815
The modified gen p mean: 0.44811758399009705, gen p mean: -0.2163022756576538, mean p set: 0.44864511489868164
loss_pred:0.014868263155221939, decouple_loss:0.0019972065929323435
Iteration: 3268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788220524787903, gen p mean: -0.21673466265201569, mean p set: 0.44845762848854065
loss_pred:0.014450094662606716, decouple_loss:0.0019971325527876616
The modified gen p mean: 0.44776323437690735, gen p mean: -0.22063839435577393, mean p set: 0.4483374059200287
loss_pred:0.014645107090473175, decouple_loss:0.002156701637431979
The modified gen p mean: 0.44867581129074097, gen p mean: -0.21921592950820923, mean p set: 0.44920313358306885
loss_pred:0.014692732132971287, decouple_loss:0.0022556064650416374
Iteration: 3269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765883684158325, gen p mean: -0.21934185922145844, mean p set: 0.44823122024536133
loss_pred:0.015078007243573666, decouple_loss:0.001834967639297247
The modified gen p mean: 0.44705814123153687, gen p mean: -0.21531683206558228, mean p set: 0.4476318955421448
loss_pred:0.015555880963802338, decouple_loss:0.0017641953891143203
The modified gen p mean: 0.4479658901691437, gen p mean: -0.218769833445549, mean p set: 0.44848933815956116
loss_pred:0.014594304375350475, decouple_loss:0.0017915986245498061
Iteration: 3270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737401604652405, gen p mean: -0.21813370287418365, mean p set: 0.4479440450668335
The modified gen p mean: 0.4460700750350952, gen p mean: -0.2241901010274887, mean p set: 0.44664737582206726
loss_pred:0.015037578530609608, decouple_loss:0.0021223442163318396
loss_pred:0.015263533219695091, decouple_loss:0.0020913819316774607
The modified gen p mean: 0.44817838072776794, gen p mean: -0.2192469835281372, mean p set: 0.44870471954345703
loss_pred:0.015311342664062977, decouple_loss:0.002113286405801773
2023-04-27 15:09:22 testing...
The modified gen p mean: 0.4482227563858032, gen p mean: -0.21612074971199036, mean p set: 0.44879910349845886
loss_pred:0.015939874574542046, decouple_loss:0.001953797647729516
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2182554453611374, mean p set: 0.4499112665653229
loss_pred:0.01600971817970276, decouple_loss:0.0020275693386793137
The modified gen p mean: 0.4493025839328766, gen p mean: -0.21871158480644226, mean p set: 0.4498290419578552
loss_pred:0.015575958415865898, decouple_loss:0.002005066955462098
WV_1_PC_1_EH_0_PS_30, loss: 0.015941623598337173, avg_mse: 0.023526785895228386
current test mse: 0.023527
Iteration: 3271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740578532218933, gen p mean: -0.2203534096479416, mean p set: 0.4479339122772217
loss_pred:0.015176539309322834, decouple_loss:0.0018808989552780986
The modified gen p mean: 0.44713398814201355, gen p mean: -0.2229132205247879, mean p set: 0.447712779045105
loss_pred:0.014966319315135479, decouple_loss:0.001951579237356782
The modified gen p mean: 0.44769102334976196, gen p mean: -0.21807578206062317, mean p set: 0.4482678174972534
loss_pred:0.014988693408668041, decouple_loss:0.0018543364712968469
Iteration: 3272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477653503417969, gen p mean: -0.21819962561130524, mean p set: 0.4482938349246979
loss_pred:0.014767797663807869, decouple_loss:0.002277076244354248
The modified gen p mean: 0.4477270543575287, gen p mean: -0.21262286603450775, mean p set: 0.4483031630516052
The modified gen p mean: 0.44627559185028076, gen p mean: -0.21967700123786926, mean p set: 0.44685330986976624
loss_pred:0.015324248932301998, decouple_loss:0.002575460122898221
loss_pred:0.014908014796674252, decouple_loss:0.0022622602991759777
Iteration: 3273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473646581172943, gen p mean: -0.21388177573680878, mean p set: 0.447892427444458
loss_pred:0.01531941257417202, decouple_loss:0.002088060136884451
The modified gen p mean: 0.4472649097442627, gen p mean: -0.21825732290744781, mean p set: 0.4478394687175751
The modified gen p mean: 0.4479939341545105, gen p mean: -0.21475692093372345, mean p set: 0.44857192039489746
loss_pred:0.015032581984996796, decouple_loss:0.002013379242271185
loss_pred:0.015351016074419022, decouple_loss:0.0019270011689513922
Iteration: 3274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822564721107483, gen p mean: -0.21765479445457458, mean p set: 0.4488029479980469
loss_pred:0.01470761839300394, decouple_loss:0.0025680060498416424
The modified gen p mean: 0.44793060421943665, gen p mean: -0.2187991738319397, mean p set: 0.44850432872772217
loss_pred:0.014538631774485111, decouple_loss:0.00241739209741354
The modified gen p mean: 0.44806069135665894, gen p mean: -0.21924787759780884, mean p set: 0.44858577847480774
loss_pred:0.014741789549589157, decouple_loss:0.0024335570633411407
Iteration: 3275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464736580848694, gen p mean: -0.22476255893707275, mean p set: 0.4470512866973877
loss_pred:0.014982153661549091, decouple_loss:0.0018140014726668596
The modified gen p mean: 0.44776058197021484, gen p mean: -0.21809984743595123, mean p set: 0.4483359158039093
loss_pred:0.01492661889642477, decouple_loss:0.0020066017750650644
The modified gen p mean: 0.4477783143520355, gen p mean: -0.21969164907932281, mean p set: 0.44831034541130066
loss_pred:0.0153170395642519, decouple_loss:0.0019911029376089573
Iteration: 3276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776251912117004, gen p mean: -0.22411668300628662, mean p set: 0.448335200548172
loss_pred:0.014657840132713318, decouple_loss:0.0024401769042015076
The modified gen p mean: 0.4474315047264099, gen p mean: -0.2227790653705597, mean p set: 0.44800689816474915
loss_pred:0.014871976338326931, decouple_loss:0.002619790844619274
The modified gen p mean: 0.44736236333847046, gen p mean: -0.21935907006263733, mean p set: 0.4478871822357178
loss_pred:0.015489935874938965, decouple_loss:0.0024922627490013838
Iteration: 3277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487859606742859, gen p mean: -0.22423133254051208, mean p set: 0.44936102628707886
loss_pred:0.014332438819110394, decouple_loss:0.001992238685488701
The modified gen p mean: 0.446908175945282, gen p mean: -0.2260860949754715, mean p set: 0.44748347997665405
loss_pred:0.014992505311965942, decouple_loss:0.002029856201261282
The modified gen p mean: 0.4488604664802551, gen p mean: -0.21959026157855988, mean p set: 0.44938814640045166
loss_pred:0.015400506556034088, decouple_loss:0.002231667982414365
Iteration: 3278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447875052690506, gen p mean: -0.21843726933002472, mean p set: 0.4484493136405945
loss_pred:0.014599131420254707, decouple_loss:0.002182778436690569
The modified gen p mean: 0.44774627685546875, gen p mean: -0.22207945585250854, mean p set: 0.44831880927085876
loss_pred:0.015263055451214314, decouple_loss:0.002222136128693819
The modified gen p mean: 0.44757404923439026, gen p mean: -0.22363057732582092, mean p set: 0.4481017291545868
loss_pred:0.014628549106419086, decouple_loss:0.002218269743025303
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869673252105713, gen p mean: -0.21943187713623047, mean p set: 0.44927188754081726
loss_pred:0.014599521644413471, decouple_loss:0.001985681476071477
The modified gen p mean: 0.44821450114250183, gen p mean: -0.21923062205314636, mean p set: 0.44878846406936646
loss_pred:0.014376834034919739, decouple_loss:0.0020340667106211185
The modified gen p mean: 0.4481975734233856, gen p mean: -0.2207186222076416, mean p set: 0.44871973991394043
loss_pred:0.015135599300265312, decouple_loss:0.001966396812349558
Iteration: 3280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818374514579773, gen p mean: -0.21641771495342255, mean p set: 0.4487583637237549
loss_pred:0.014974885620176792, decouple_loss:0.0022003899794071913
The modified gen p mean: 0.447530597448349, gen p mean: -0.22026465833187103, mean p set: 0.44810402393341064
loss_pred:0.014572412706911564, decouple_loss:0.0022257138043642044
The modified gen p mean: 0.4477594792842865, gen p mean: -0.21889689564704895, mean p set: 0.44829073548316956
loss_pred:0.015497637912631035, decouple_loss:0.002115334151312709
2023-04-27 15:12:47 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2177361100912094, mean p set: 0.4499112665653229
loss_pred:0.01589401438832283, decouple_loss:0.0021087254863232374
The modified gen p mean: 0.44929754734039307, gen p mean: -0.21776705980300903, mean p set: 0.4498290419578552
loss_pred:0.015471301972866058, decouple_loss:0.002488608006387949
The modified gen p mean: 0.44822219014167786, gen p mean: -0.21518351137638092, mean p set: 0.44879910349845886
loss_pred:0.015875456854701042, decouple_loss:0.0022661772090941668
WV_1_PC_1_EH_0_PS_30, loss: 0.01586131751537323, avg_mse: 0.023452723398804665
current test mse: 0.023453
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 3281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832709431648254, gen p mean: -0.21759827435016632, mean p set: 0.4488556683063507
loss_pred:0.014489348977804184, decouple_loss:0.0021584026981145144
The modified gen p mean: 0.44768133759498596, gen p mean: -0.21709997951984406, mean p set: 0.44825834035873413
loss_pred:0.014338422566652298, decouple_loss:0.0023118173703551292
The modified gen p mean: 0.4470612704753876, gen p mean: -0.21472708880901337, mean p set: 0.44763508439064026
loss_pred:0.01411523949354887, decouple_loss:0.0024112663231790066
Iteration: 3282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833359122276306, gen p mean: -0.21484781801700592, mean p set: 0.4488582909107208
loss_pred:0.014726960100233555, decouple_loss:0.002344738459214568
The modified gen p mean: 0.44785618782043457, gen p mean: -0.22537145018577576, mean p set: 0.44843214750289917
The modified gen p mean: 0.4475281834602356, gen p mean: -0.21858170628547668, mean p set: 0.4481014907360077
loss_pred:0.01415317878127098, decouple_loss:0.002090086694806814
loss_pred:0.014050068333745003, decouple_loss:0.0023343260399997234
Iteration: 3283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704732298851013, gen p mean: -0.22586017847061157, mean p set: 0.4475710391998291
loss_pred:0.01394172664731741, decouple_loss:0.0021065727341920137
The modified gen p mean: 0.44763681292533875, gen p mean: -0.2256859838962555, mean p set: 0.4482114315032959
The modified gen p mean: 0.44840529561042786, gen p mean: -0.22371123731136322, mean p set: 0.4489794969558716
loss_pred:0.013943021185696125, decouple_loss:0.002002648077905178
loss_pred:0.014414929784834385, decouple_loss:0.002144512487575412
Iteration: 3284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830265641212463, gen p mean: -0.22422412037849426, mean p set: 0.4488280117511749
loss_pred:0.014541867189109325, decouple_loss:0.0023000468499958515
The modified gen p mean: 0.4471469521522522, gen p mean: -0.217802956700325, mean p set: 0.44771671295166016The modified gen p mean: 0.44802701473236084, gen p mean: -0.21996240317821503, mean p set: 0.4486044645309448
loss_pred:0.0148209473118186, decouple_loss:0.002343249274417758
loss_pred:0.014000075869262218, decouple_loss:0.0022787805646657944
Iteration: 3285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485035538673401, gen p mean: -0.21856698393821716, mean p set: 0.4490780532360077
loss_pred:0.014100480824708939, decouple_loss:0.0022855480201542377
The modified gen p mean: 0.4471992254257202, gen p mean: -0.21908588707447052, mean p set: 0.4477807283401489
loss_pred:0.014853696338832378, decouple_loss:0.0021732086315751076
The modified gen p mean: 0.4475061595439911, gen p mean: -0.21492232382297516, mean p set: 0.44803711771965027
loss_pred:0.01499443780630827, decouple_loss:0.0023825664538890123
Iteration: 3286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484174847602844, gen p mean: -0.217598557472229, mean p set: 0.4489966928958893
loss_pred:0.014479300938546658, decouple_loss:0.0019177328795194626
The modified gen p mean: 0.44844546914100647, gen p mean: -0.2266860008239746, mean p set: 0.4489799737930298The modified gen p mean: 0.4482947587966919, gen p mean: -0.22619332373142242, mean p set: 0.4488692879676819
loss_pred:0.014706246554851532, decouple_loss:0.0017886811401695013
loss_pred:0.014485773630440235, decouple_loss:0.001805849839001894
Iteration: 3287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483644962310791, gen p mean: -0.2208896279335022, mean p set: 0.44894084334373474
loss_pred:0.014048400335013866, decouple_loss:0.002336177509278059
The modified gen p mean: 0.4471760094165802, gen p mean: -0.2106589823961258, mean p set: 0.4477514326572418
loss_pred:0.015079530887305737, decouple_loss:0.00199373927898705
The modified gen p mean: 0.44869059324264526, gen p mean: -0.21825328469276428, mean p set: 0.44921019673347473
loss_pred:0.014283658005297184, decouple_loss:0.002268340438604355
Iteration: 3288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800764322280884, gen p mean: -0.22364960610866547, mean p set: 0.4485870599746704
loss_pred:0.013813478872179985, decouple_loss:0.0018708216957747936
The modified gen p mean: 0.4471593499183655, gen p mean: -0.2221016138792038, mean p set: 0.44773516058921814
loss_pred:0.014752836897969246, decouple_loss:0.0019414894049987197
The modified gen p mean: 0.4472709596157074, gen p mean: -0.21537812054157257, mean p set: 0.4477945566177368
loss_pred:0.01440626010298729, decouple_loss:0.0019316336838528514
Iteration: 3289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475434422492981, gen p mean: -0.2257881909608841, mean p set: 0.44811877608299255
loss_pred:0.013993247412145138, decouple_loss:0.002168406965211034
The modified gen p mean: 0.44720375537872314, gen p mean: -0.22056451439857483, mean p set: 0.44777724146842957
loss_pred:0.01498000230640173, decouple_loss:0.0024014438968151808
The modified gen p mean: 0.4481791853904724, gen p mean: -0.22463269531726837, mean p set: 0.4487045109272003
loss_pred:0.014040852896869183, decouple_loss:0.0023886035196483135
Iteration: 3290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768232107162476, gen p mean: -0.22391201555728912, mean p set: 0.4482528567314148
loss_pred:0.013566077686846256, decouple_loss:0.0021070907823741436
The modified gen p mean: 0.44719821214675903, gen p mean: -0.22946277260780334, mean p set: 0.44776979088783264
loss_pred:0.013854142278432846, decouple_loss:0.001989147160202265
The modified gen p mean: 0.4486095607280731, gen p mean: -0.2273816019296646, mean p set: 0.449133038520813
loss_pred:0.014359190128743649, decouple_loss:0.002020401880145073
2023-04-27 15:16:53 testing...
The modified gen p mean: 0.44822609424591064, gen p mean: -0.22372765839099884, mean p set: 0.44879910349845886
loss_pred:0.01598305255174637, decouple_loss:0.002036157064139843
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22658222913742065, mean p set: 0.4499112665653229
loss_pred:0.016070980578660965, decouple_loss:0.0020507401786744595
The modified gen p mean: 0.449296772480011, gen p mean: -0.22663728892803192, mean p set: 0.4498290419578552
loss_pred:0.015639571473002434, decouple_loss:0.0020551567431539297
WV_1_PC_1_EH_0_PS_30, loss: 0.016000237315893173, avg_mse: 0.023751800879836082
current test mse: 0.023752
Iteration: 3291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483363926410675, gen p mean: -0.2316843867301941, mean p set: 0.4489099383354187
loss_pred:0.013655047863721848, decouple_loss:0.0020830014254897833
The modified gen p mean: 0.4480266869068146, gen p mean: -0.2319401651620865, mean p set: 0.44860297441482544
loss_pred:0.013741636648774147, decouple_loss:0.0020760642364621162
The modified gen p mean: 0.448127806186676, gen p mean: -0.22749049961566925, mean p set: 0.44865697622299194
loss_pred:0.01425984501838684, decouple_loss:0.001999531639739871
Iteration: 3292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803208112716675, gen p mean: -0.22392292320728302, mean p set: 0.44856035709381104
loss_pred:0.013621365651488304, decouple_loss:0.0020979815162718296
The modified gen p mean: 0.4486822187900543, gen p mean: -0.22345443069934845, mean p set: 0.4492571949958801
loss_pred:0.013674119487404823, decouple_loss:0.0020248033106327057
The modified gen p mean: 0.4480513334274292, gen p mean: -0.22504638135433197, mean p set: 0.4486263692378998
loss_pred:0.014521799981594086, decouple_loss:0.0019652636256068945
Iteration: 3293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473182260990143, gen p mean: -0.22164364159107208, mean p set: 0.44784268736839294
loss_pred:0.015257729217410088, decouple_loss:0.0022185971029102802
The modified gen p mean: 0.4474230706691742, gen p mean: -0.2237708419561386, mean p set: 0.4479990005493164
loss_pred:0.013718021102249622, decouple_loss:0.0021182294003665447
The modified gen p mean: 0.4478619694709778, gen p mean: -0.22089354693889618, mean p set: 0.4484385848045349
loss_pred:0.013645719736814499, decouple_loss:0.002199816284701228
Iteration: 3294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926291704177856, gen p mean: -0.2195802628993988, mean p set: 0.4497953951358795
loss_pred:0.014161983504891396, decouple_loss:0.0023339015897363424
The modified gen p mean: 0.4478670060634613, gen p mean: -0.23100826144218445, mean p set: 0.44844159483909607The modified gen p mean: 0.4470239281654358, gen p mean: -0.21984590590000153, mean p set: 0.44759488105773926
loss_pred:0.013659614138305187, decouple_loss:0.0019016556907445192
loss_pred:0.014560084789991379, decouple_loss:0.002002692548558116
Iteration: 3295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482285678386688, gen p mean: -0.22516414523124695, mean p set: 0.4488038718700409
loss_pred:0.013647114858031273, decouple_loss:0.001876672264188528
The modified gen p mean: 0.4474208950996399, gen p mean: -0.2235955148935318, mean p set: 0.4479498863220215The modified gen p mean: 0.44683602452278137, gen p mean: -0.222469300031662, mean p set: 0.4474125802516937
loss_pred:0.01399651076644659, decouple_loss:0.001825331593863666
loss_pred:0.013738998211920261, decouple_loss:0.001947230426594615
Iteration: 3296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484785497188568, gen p mean: -0.22157609462738037, mean p set: 0.44905373454093933
loss_pred:0.014296810142695904, decouple_loss:0.0018859023693948984
The modified gen p mean: 0.44893473386764526, gen p mean: -0.21768426895141602, mean p set: 0.4495067000389099The modified gen p mean: 0.44810768961906433, gen p mean: -0.22402323782444, mean p set: 0.4486351013183594
loss_pred:0.013128292746841908, decouple_loss:0.0018618805333971977
loss_pred:0.013706379570066929, decouple_loss:0.001816093921661377
Iteration: 3297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465157389640808, gen p mean: -0.2250828742980957, mean p set: 0.4470933675765991
loss_pred:0.014281782321631908, decouple_loss:0.002111231442540884
The modified gen p mean: 0.44731056690216064, gen p mean: -0.21953070163726807, mean p set: 0.44784215092658997The modified gen p mean: 0.44735825061798096, gen p mean: -0.22362138330936432, mean p set: 0.4479329288005829
loss_pred:0.013657287694513798, decouple_loss:0.0022022591438144445
loss_pred:0.013779365457594395, decouple_loss:0.001939704641699791
Iteration: 3298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793859124183655, gen p mean: -0.22448532283306122, mean p set: 0.4485081434249878
loss_pred:0.014312051236629486, decouple_loss:0.0018324690172448754
The modified gen p mean: 0.44929423928260803, gen p mean: -0.21791289746761322, mean p set: 0.4498658776283264The modified gen p mean: 0.4474085569381714, gen p mean: -0.22102627158164978, mean p set: 0.44793590903282166
loss_pred:0.013994935899972916, decouple_loss:0.002073634183034301
loss_pred:0.014023436233401299, decouple_loss:0.0019118670606985688
Iteration: 3299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489668011665344, gen p mean: -0.22611983120441437, mean p set: 0.4495420455932617
loss_pred:0.01345018856227398, decouple_loss:0.0021104386541992426
The modified gen p mean: 0.44833001494407654, gen p mean: -0.22705891728401184, mean p set: 0.4488586187362671
loss_pred:0.01399906538426876, decouple_loss:0.002164410660043359
The modified gen p mean: 0.4475865364074707, gen p mean: -0.2258334457874298, mean p set: 0.44816192984580994
loss_pred:0.013606923632323742, decouple_loss:0.0022482285276055336
Iteration: 3300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474065601825714, gen p mean: -0.22371046245098114, mean p set: 0.44798383116722107
loss_pred:0.015042089857161045, decouple_loss:0.0019824474584311247
The modified gen p mean: 0.4475559890270233, gen p mean: -0.22646871209144592, mean p set: 0.44812890887260437
loss_pred:0.014308673329651356, decouple_loss:0.0020628960337489843
The modified gen p mean: 0.4479798376560211, gen p mean: -0.23029908537864685, mean p set: 0.4485073983669281
loss_pred:0.01396255288273096, decouple_loss:0.002233601873740554
2023-04-27 15:20:21 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2228265106678009, mean p set: 0.4499112665653229
loss_pred:0.015994638204574585, decouple_loss:0.0019823573529720306
The modified gen p mean: 0.4493030905723572, gen p mean: -0.22293591499328613, mean p set: 0.4498290419578552
loss_pred:0.015578601509332657, decouple_loss:0.0021366651635617018
The modified gen p mean: 0.448223352432251, gen p mean: -0.2201703041791916, mean p set: 0.44879910349845886
loss_pred:0.015998447313904762, decouple_loss:0.002069723792374134
WV_1_PC_1_EH_0_PS_30, loss: 0.01596037670969963, avg_mse: 0.023661332204937935
current test mse: 0.023661
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 3301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460517466068268, gen p mean: -0.22002731263637543, mean p set: 0.4465752840042114
loss_pred:0.015086498111486435, decouple_loss:0.0020542272832244635
The modified gen p mean: 0.4487622082233429, gen p mean: -0.22689351439476013, mean p set: 0.44933852553367615
loss_pred:0.01512735616415739, decouple_loss:0.001990793738514185
The modified gen p mean: 0.44615790247917175, gen p mean: -0.22391392290592194, mean p set: 0.44673389196395874
loss_pred:0.014700271189212799, decouple_loss:0.0019834295380860567
Iteration: 3302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473499059677124, gen p mean: -0.21612747013568878, mean p set: 0.44787678122520447
loss_pred:0.01513691246509552, decouple_loss:0.00204570684581995
The modified gen p mean: 0.44750550389289856, gen p mean: -0.22078582644462585, mean p set: 0.44808098673820496
loss_pred:0.015247054398059845, decouple_loss:0.002016122452914715
The modified gen p mean: 0.44679129123687744, gen p mean: -0.22174072265625, mean p set: 0.4473665952682495
loss_pred:0.015037866309285164, decouple_loss:0.0020932580810040236
Iteration: 3303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481331408023834, gen p mean: -0.22518104314804077, mean p set: 0.4486584961414337
loss_pred:0.01471472717821598, decouple_loss:0.0019400130258873105
The modified gen p mean: 0.44573044776916504, gen p mean: -0.21916112303733826, mean p set: 0.44630685448646545The modified gen p mean: 0.44870391488075256, gen p mean: -0.2269231677055359, mean p set: 0.44927704334259033
loss_pred:0.015114224515855312, decouple_loss:0.002065926091745496loss_pred:0.014931496232748032, decouple_loss:0.0022209202870726585
Iteration: 3304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482470452785492, gen p mean: -0.22762492299079895, mean p set: 0.4487825632095337
loss_pred:0.014872359111905098, decouple_loss:0.0021885549649596214
The modified gen p mean: 0.44657662510871887, gen p mean: -0.2299683690071106, mean p set: 0.44715940952301025
The modified gen p mean: 0.446732759475708, gen p mean: -0.23190850019454956, mean p set: 0.4473038911819458
loss_pred:0.01522389892488718, decouple_loss:0.0020549828186631203
loss_pred:0.014718596823513508, decouple_loss:0.0020079663954675198
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468749463558197, gen p mean: -0.23246067762374878, mean p set: 0.4473998546600342
loss_pred:0.014311949722468853, decouple_loss:0.0022283659782260656
The modified gen p mean: 0.4466681480407715, gen p mean: -0.22926132380962372, mean p set: 0.447246253490448The modified gen p mean: 0.447914719581604, gen p mean: -0.23375439643859863, mean p set: 0.448486864566803
loss_pred:0.014320893213152885, decouple_loss:0.002073196228593588
loss_pred:0.015121323056519032, decouple_loss:0.0021080223377794027
Iteration: 3306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465970993041992, gen p mean: -0.2356434464454651, mean p set: 0.4471711814403534
The modified gen p mean: 0.44717323780059814, gen p mean: -0.23742608726024628, mean p set: 0.4477439522743225
loss_pred:0.014775882475078106, decouple_loss:0.0020852130837738514
loss_pred:0.014559450559318066, decouple_loss:0.0019623711705207825
The modified gen p mean: 0.4459512233734131, gen p mean: -0.2284645438194275, mean p set: 0.44647401571273804
loss_pred:0.015089878812432289, decouple_loss:0.002019526669755578
Iteration: 3307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465426206588745, gen p mean: -0.23082582652568817, mean p set: 0.44712045788764954
The modified gen p mean: 0.44652673602104187, gen p mean: -0.23638693988323212, mean p set: 0.4471011161804199
loss_pred:0.01458407286554575, decouple_loss:0.002151011023670435
loss_pred:0.015071510337293148, decouple_loss:0.0022470762487500906
The modified gen p mean: 0.4466612935066223, gen p mean: -0.23093701899051666, mean p set: 0.4471926689147949
loss_pred:0.014864858239889145, decouple_loss:0.0025352011434733868
Iteration: 3308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749438762664795, gen p mean: -0.23494184017181396, mean p set: 0.448073148727417
loss_pred:0.014873438514769077, decouple_loss:0.0021110172383487225
The modified gen p mean: 0.44895198941230774, gen p mean: -0.23635776340961456, mean p set: 0.44952791929244995
loss_pred:0.014529560692608356, decouple_loss:0.0024120002053678036
The modified gen p mean: 0.44524115324020386, gen p mean: -0.236913800239563, mean p set: 0.4457697868347168
loss_pred:0.014953588135540485, decouple_loss:0.0020237828139215708
Iteration: 3309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473644495010376, gen p mean: -0.24020741879940033, mean p set: 0.44794052839279175
loss_pred:0.014539578929543495, decouple_loss:0.0018862870056182146
The modified gen p mean: 0.44787538051605225, gen p mean: -0.2346642017364502, mean p set: 0.4484470784664154
loss_pred:0.014805803075432777, decouple_loss:0.0021418591495603323
The modified gen p mean: 0.4467245638370514, gen p mean: -0.2330486923456192, mean p set: 0.44725558161735535
loss_pred:0.01477383729070425, decouple_loss:0.0020787103567272425
Iteration: 3310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734540581703186, gen p mean: -0.2342090606689453, mean p set: 0.4479255974292755
loss_pred:0.015003877691924572, decouple_loss:0.0021408540196716785
The modified gen p mean: 0.44558873772621155, gen p mean: -0.23632903397083282, mean p set: 0.4461652636528015
loss_pred:0.01493300125002861, decouple_loss:0.0020519904792308807
The modified gen p mean: 0.44706085324287415, gen p mean: -0.2293553352355957, mean p set: 0.44758522510528564
loss_pred:0.0153605155646801, decouple_loss:0.0019313156371936202
2023-04-27 15:24:27 testing...
The modified gen p mean: 0.44822120666503906, gen p mean: -0.23156049847602844, mean p set: 0.44879910349845886
loss_pred:0.015939783304929733, decouple_loss:0.0018756602657958865
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2342778444290161, mean p set: 0.4499112665653229
loss_pred:0.01597750000655651, decouple_loss:0.001951656537130475
The modified gen p mean: 0.4492966830730438, gen p mean: -0.23447366058826447, mean p set: 0.4498290419578552
loss_pred:0.015470443293452263, decouple_loss:0.0019475945737212896
WV_1_PC_1_EH_0_PS_30, loss: 0.015892159193754196, avg_mse: 0.023554861545562744
current test mse: 0.023555
Iteration: 3311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461781084537506, gen p mean: -0.23444817960262299, mean p set: 0.44675159454345703
loss_pred:0.01478367019444704, decouple_loss:0.001911831903271377
The modified gen p mean: 0.4460502564907074, gen p mean: -0.230549618601799, mean p set: 0.4466271698474884
loss_pred:0.014702072367072105, decouple_loss:0.00194602832198143
The modified gen p mean: 0.44855090975761414, gen p mean: -0.23726582527160645, mean p set: 0.44907623529434204
loss_pred:0.015245461836457253, decouple_loss:0.0022762843873351812
Iteration: 3312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464069604873657, gen p mean: -0.2318735122680664, mean p set: 0.4469289183616638
loss_pred:0.0145632429048419, decouple_loss:0.0019807040225714445
The modified gen p mean: 0.4456805884838104, gen p mean: -0.22931921482086182, mean p set: 0.44625577330589294
loss_pred:0.014824549667537212, decouple_loss:0.0021488468628376722
The modified gen p mean: 0.4467843770980835, gen p mean: -0.23038780689239502, mean p set: 0.4473566710948944
loss_pred:0.014456245116889477, decouple_loss:0.0022022994235157967
Iteration: 3313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716107845306396, gen p mean: -0.23149482905864716, mean p set: 0.4476941227912903
loss_pred:0.014930352568626404, decouple_loss:0.002001669490709901
The modified gen p mean: 0.44623056054115295, gen p mean: -0.229983389377594, mean p set: 0.44680535793304443
loss_pred:0.014445132575929165, decouple_loss:0.0020381922367960215
The modified gen p mean: 0.44583860039711, gen p mean: -0.23108994960784912, mean p set: 0.4464118480682373
loss_pred:0.015446409583091736, decouple_loss:0.002049004193395376
Iteration: 3314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457826316356659, gen p mean: -0.23228393495082855, mean p set: 0.44630563259124756
loss_pred:0.01449124701321125, decouple_loss:0.002178870839998126
The modified gen p mean: 0.448003888130188, gen p mean: -0.23448936641216278, mean p set: 0.44858697056770325
loss_pred:0.014827419072389603, decouple_loss:0.0023051679600030184
The modified gen p mean: 0.4474194049835205, gen p mean: -0.2385655790567398, mean p set: 0.44799599051475525
loss_pred:0.014150918461382389, decouple_loss:0.0021918730344623327
Iteration: 3315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463185966014862, gen p mean: -0.23730413615703583, mean p set: 0.44689324498176575
loss_pred:0.015297887846827507, decouple_loss:0.0019562707748264074
The modified gen p mean: 0.44878771901130676, gen p mean: -0.2389165312051773, mean p set: 0.44931700825691223The modified gen p mean: 0.4463798701763153, gen p mean: -0.23485158383846283, mean p set: 0.44695523381233215
loss_pred:0.01463377382606268, decouple_loss:0.002046012319624424
loss_pred:0.014911307021975517, decouple_loss:0.0022081516217440367
Iteration: 3316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815772771835327, gen p mean: -0.23970338702201843, mean p set: 0.44868341088294983
loss_pred:0.014718905091285706, decouple_loss:0.0021984437480568886
The modified gen p mean: 0.4480751156806946, gen p mean: -0.24236562848091125, mean p set: 0.44865259528160095The modified gen p mean: 0.4461648762226105, gen p mean: -0.23748613893985748, mean p set: 0.4467402696609497
loss_pred:0.014514865353703499, decouple_loss:0.002109284047037363
loss_pred:0.015290419571101665, decouple_loss:0.0024613249115645885
Iteration: 3317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558557868003845, gen p mean: -0.24595946073532104, mean p set: 0.4461599588394165
loss_pred:0.015193678438663483, decouple_loss:0.002246389864012599
The modified gen p mean: 0.4469522535800934, gen p mean: -0.24340087175369263, mean p set: 0.44752782583236694The modified gen p mean: 0.4452148377895355, gen p mean: -0.24665474891662598, mean p set: 0.44573795795440674
loss_pred:0.015141814015805721, decouple_loss:0.0021279482170939445
loss_pred:0.014822683297097683, decouple_loss:0.0021770300809293985
Iteration: 3318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462113380432129, gen p mean: -0.23365691304206848, mean p set: 0.4467838406562805
loss_pred:0.014362355694174767, decouple_loss:0.0019056630553677678
The modified gen p mean: 0.4461575746536255, gen p mean: -0.23384398221969604, mean p set: 0.44668781757354736
The modified gen p mean: 0.44846996665000916, gen p mean: -0.2370234876871109, mean p set: 0.4490543007850647
loss_pred:0.015393242239952087, decouple_loss:0.0019773212261497974
loss_pred:0.015095541253685951, decouple_loss:0.002220607828348875
Iteration: 3319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771265983581543, gen p mean: -0.23512277007102966, mean p set: 0.4482913017272949
loss_pred:0.014578788541257381, decouple_loss:0.0021505197510123253
The modified gen p mean: 0.44723331928253174, gen p mean: -0.24213045835494995, mean p set: 0.4478095471858978
loss_pred:0.014554798603057861, decouple_loss:0.0022844562772661448
The modified gen p mean: 0.44729894399642944, gen p mean: -0.23231621086597443, mean p set: 0.44782623648643494
loss_pred:0.014560356736183167, decouple_loss:0.0020657265558838844
Iteration: 3320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725465774536133, gen p mean: -0.23921732604503632, mean p set: 0.4478280544281006
loss_pred:0.014634589664638042, decouple_loss:0.0018517301650717854
The modified gen p mean: 0.4459342360496521, gen p mean: -0.2339809238910675, mean p set: 0.44651132822036743The modified gen p mean: 0.4464150071144104, gen p mean: -0.2364303022623062, mean p set: 0.44694921374320984
loss_pred:0.015523307025432587, decouple_loss:0.0021955789998173714
loss_pred:0.014699812978506088, decouple_loss:0.0019958969205617905
2023-04-27 15:27:52 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23999883234500885, mean p set: 0.4499112665653229
loss_pred:0.015909355133771896, decouple_loss:0.0019733188673853874
The modified gen p mean: 0.4492975175380707, gen p mean: -0.2400999367237091, mean p set: 0.4498290419578552
loss_pred:0.01550750620663166, decouple_loss:0.001931834383867681
The modified gen p mean: 0.4482218027114868, gen p mean: -0.2371634542942047, mean p set: 0.44879910349845886
loss_pred:0.01586921513080597, decouple_loss:0.0019098400371149182
WV_1_PC_1_EH_0_PS_30, loss: 0.01585894450545311, avg_mse: 0.023524483665823936
current test mse: 0.023524
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 3321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813576340675354, gen p mean: -0.23505929112434387, mean p set: 0.44866064190864563
loss_pred:0.01458660326898098, decouple_loss:0.0025615589693188667
The modified gen p mean: 0.4480372369289398, gen p mean: -0.24079875648021698, mean p set: 0.44860947132110596
loss_pred:0.014153298921883106, decouple_loss:0.002090898808091879
The modified gen p mean: 0.4483982026576996, gen p mean: -0.23719900846481323, mean p set: 0.44897186756134033
loss_pred:0.014233470894396305, decouple_loss:0.0027585788629949093
Iteration: 3322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465959668159485, gen p mean: -0.24265526235103607, mean p set: 0.4471273422241211
loss_pred:0.01494663767516613, decouple_loss:0.0020322066266089678
The modified gen p mean: 0.4471297264099121, gen p mean: -0.23971439898014069, mean p set: 0.4477039873600006
The modified gen p mean: 0.447426438331604, gen p mean: -0.2379923164844513, mean p set: 0.44800183176994324
loss_pred:0.013877074234187603, decouple_loss:0.0021662453655153513
loss_pred:0.01469915360212326, decouple_loss:0.0022561324294656515
Iteration: 3323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709688425064087, gen p mean: -0.23334281146526337, mean p set: 0.44762441515922546
loss_pred:0.014162094332277775, decouple_loss:0.002557330997660756
The modified gen p mean: 0.4472651779651642, gen p mean: -0.23458296060562134, mean p set: 0.4478378891944885
The modified gen p mean: 0.4473113715648651, gen p mean: -0.23770353198051453, mean p set: 0.44789108633995056
loss_pred:0.013959881849586964, decouple_loss:0.0021621915511786938
loss_pred:0.014913634397089481, decouple_loss:0.002509016776457429
Iteration: 3324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715604186058044, gen p mean: -0.2328992336988449, mean p set: 0.44768473505973816
loss_pred:0.014462270773947239, decouple_loss:0.002167904982343316
The modified gen p mean: 0.4471811056137085, gen p mean: -0.22855885326862335, mean p set: 0.4477570950984955
The modified gen p mean: 0.44883766770362854, gen p mean: -0.23272711038589478, mean p set: 0.44941452145576477
loss_pred:0.014680106192827225, decouple_loss:0.002153076697140932
loss_pred:0.014213668182492256, decouple_loss:0.0024360199458897114
Iteration: 3325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798800349235535, gen p mean: -0.2311793714761734, mean p set: 0.4485197067260742
loss_pred:0.014036864042282104, decouple_loss:0.0022576269693672657
The modified gen p mean: 0.4474976658821106, gen p mean: -0.2325895130634308, mean p set: 0.448081910610199
The modified gen p mean: 0.44737130403518677, gen p mean: -0.2289460152387619, mean p set: 0.44794946908950806
loss_pred:0.014813002198934555, decouple_loss:0.0021284788381308317
loss_pred:0.014170167036354542, decouple_loss:0.0022674845531582832
Iteration: 3326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791075587272644, gen p mean: -0.23127174377441406, mean p set: 0.448486864566803
loss_pred:0.014073438011109829, decouple_loss:0.002205700846388936
The modified gen p mean: 0.44747546315193176, gen p mean: -0.23428875207901, mean p set: 0.44800394773483276The modified gen p mean: 0.44690510630607605, gen p mean: -0.2305506020784378, mean p set: 0.4474763870239258
loss_pred:0.014517785049974918, decouple_loss:0.0019946377724409103
loss_pred:0.014335696585476398, decouple_loss:0.0022861056495457888
Iteration: 3327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464806616306305, gen p mean: -0.23463021218776703, mean p set: 0.4470519721508026
loss_pred:0.014258629642426968, decouple_loss:0.0020785965025424957
The modified gen p mean: 0.4484395682811737, gen p mean: -0.23518995940685272, mean p set: 0.44896969199180603The modified gen p mean: 0.4471316933631897, gen p mean: -0.23346427083015442, mean p set: 0.4477090537548065
loss_pred:0.014065423049032688, decouple_loss:0.0022075441665947437
loss_pred:0.014166143722832203, decouple_loss:0.0020977258682250977
Iteration: 3328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866839051246643, gen p mean: -0.23582060635089874, mean p set: 0.44924864172935486
loss_pred:0.013442766852676868, decouple_loss:0.0023518449161201715
The modified gen p mean: 0.44786718487739563, gen p mean: -0.24091078341007233, mean p set: 0.448443204164505
loss_pred:0.014056582003831863, decouple_loss:0.002402309561148286
The modified gen p mean: 0.4471190273761749, gen p mean: -0.23993422091007233, mean p set: 0.4476523995399475
loss_pred:0.014617105014622211, decouple_loss:0.0024568913504481316
Iteration: 3329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448030948638916, gen p mean: -0.23795674741268158, mean p set: 0.4486064314842224
loss_pred:0.013887269422411919, decouple_loss:0.002082652412354946
The modified gen p mean: 0.4472556412220001, gen p mean: -0.24061642587184906, mean p set: 0.44783034920692444
loss_pred:0.014227191917598248, decouple_loss:0.002135778544470668
The modified gen p mean: 0.44717106223106384, gen p mean: -0.23558123409748077, mean p set: 0.44770386815071106
loss_pred:0.014396364800632, decouple_loss:0.0020750088151544333
Iteration: 3330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470641314983368, gen p mean: -0.23817501962184906, mean p set: 0.4476398825645447
loss_pred:0.014396481215953827, decouple_loss:0.002000756561756134
The modified gen p mean: 0.4468039572238922, gen p mean: -0.23308105766773224, mean p set: 0.4473787844181061
loss_pred:0.01434401422739029, decouple_loss:0.002457159338518977
The modified gen p mean: 0.4464024007320404, gen p mean: -0.23888707160949707, mean p set: 0.4469318985939026
loss_pred:0.015031494200229645, decouple_loss:0.0019591504242271185
2023-04-27 15:32:07 testing...
The modified gen p mean: 0.44822126626968384, gen p mean: -0.23329322040081024, mean p set: 0.44879910349845886
loss_pred:0.016049960628151894, decouple_loss:0.002037012716755271
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23614805936813354, mean p set: 0.4499112665653229
loss_pred:0.016101256012916565, decouple_loss:0.0020291018299758434
The modified gen p mean: 0.449296772480011, gen p mean: -0.23628386855125427, mean p set: 0.4498290419578552
loss_pred:0.015662452206015587, decouple_loss:0.002087707631289959
WV_1_PC_1_EH_0_PS_30, loss: 0.01604045368731022, avg_mse: 0.0238040741533041
current test mse: 0.023804
Iteration: 3331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467584192752838, gen p mean: -0.23898498713970184, mean p set: 0.4473388195037842
loss_pred:0.014046094380319118, decouple_loss:0.001959217945113778
The modified gen p mean: 0.448044091463089, gen p mean: -0.2385254055261612, mean p set: 0.4485662877559662
loss_pred:0.014097223989665508, decouple_loss:0.0022349385544657707
The modified gen p mean: 0.4470841586589813, gen p mean: -0.23023353517055511, mean p set: 0.4476620554924011
loss_pred:0.014348332770168781, decouple_loss:0.002217264613136649
Iteration: 3332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476638436317444, gen p mean: -0.23109804093837738, mean p set: 0.4481918513774872
loss_pred:0.01406847033649683, decouple_loss:0.0020269365049898624
The modified gen p mean: 0.44772258400917053, gen p mean: -0.2315921038389206, mean p set: 0.44830334186553955
loss_pred:0.014585656113922596, decouple_loss:0.001966675277799368
The modified gen p mean: 0.4482218027114868, gen p mean: -0.2380061149597168, mean p set: 0.44880568981170654
loss_pred:0.014102472923696041, decouple_loss:0.0019296064274385571
Iteration: 3333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471767544746399, gen p mean: -0.23467274010181427, mean p set: 0.4477013349533081
loss_pred:0.014623221009969711, decouple_loss:0.0020224249456077814
The modified gen p mean: 0.4468044638633728, gen p mean: -0.2325953096151352, mean p set: 0.44737890362739563
loss_pred:0.01431192085146904, decouple_loss:0.0020316948648542166
The modified gen p mean: 0.44831109046936035, gen p mean: -0.22499245405197144, mean p set: 0.44888588786125183
loss_pred:0.01387097965925932, decouple_loss:0.002141182543709874
Iteration: 3334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772863388061523, gen p mean: -0.22724226117134094, mean p set: 0.4482576549053192
loss_pred:0.014219935983419418, decouple_loss:0.0020194442477077246
The modified gen p mean: 0.4465739130973816, gen p mean: -0.2275799661874771, mean p set: 0.4471501410007477
loss_pred:0.014475714415311813, decouple_loss:0.0019330709474161267
The modified gen p mean: 0.44701021909713745, gen p mean: -0.23562900722026825, mean p set: 0.44758692383766174
loss_pred:0.014920108951628208, decouple_loss:0.0018807187443599105
Iteration: 3335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447660893201828, gen p mean: -0.23469281196594238, mean p set: 0.4482389986515045
loss_pred:0.013946420513093472, decouple_loss:0.0019432248082011938
The modified gen p mean: 0.44857099652290344, gen p mean: -0.23350223898887634, mean p set: 0.4491487443447113
loss_pred:0.013679325580596924, decouple_loss:0.0018934765830636024
The modified gen p mean: 0.4468918740749359, gen p mean: -0.23033542931079865, mean p set: 0.447422593832016
loss_pred:0.01431366242468357, decouple_loss:0.0018811298068612814
Iteration: 3336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478135108947754, gen p mean: -0.23699823021888733, mean p set: 0.4483886957168579
loss_pred:0.014186733402311802, decouple_loss:0.0019339121645316482
The modified gen p mean: 0.4483848512172699, gen p mean: -0.23357102274894714, mean p set: 0.448910653591156The modified gen p mean: 0.44701841473579407, gen p mean: -0.23698748648166656, mean p set: 0.44759440422058105
loss_pred:0.014073705300688744, decouple_loss:0.001899978844448924
loss_pred:0.013557628728449345, decouple_loss:0.0022757898550480604
Iteration: 3337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772836565971375, gen p mean: -0.22908420860767365, mean p set: 0.44830429553985596
loss_pred:0.013685718178749084, decouple_loss:0.002088790526613593
The modified gen p mean: 0.44664067029953003, gen p mean: -0.23077629506587982, mean p set: 0.4472118318080902
loss_pred:0.014158655889332294, decouple_loss:0.0019212913466617465
The modified gen p mean: 0.44816774129867554, gen p mean: -0.23048724234104156, mean p set: 0.44869139790534973
loss_pred:0.013831784948706627, decouple_loss:0.0018945037154480815
Iteration: 3338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848230481147766, gen p mean: -0.2256128489971161, mean p set: 0.4490576982498169
loss_pred:0.013442444615066051, decouple_loss:0.002143468242138624
The modified gen p mean: 0.448028564453125, gen p mean: -0.22563447058200836, mean p set: 0.4486024081707001
loss_pred:0.014037402346730232, decouple_loss:0.001868372317403555
The modified gen p mean: 0.44822049140930176, gen p mean: -0.23068778216838837, mean p set: 0.4487426280975342
loss_pred:0.014351804740726948, decouple_loss:0.002154580783098936
Iteration: 3339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874870777130127, gen p mean: -0.21868392825126648, mean p set: 0.449325829744339
loss_pred:0.01315317116677761, decouple_loss:0.0018975917482748628
The modified gen p mean: 0.44773074984550476, gen p mean: -0.2236410230398178, mean p set: 0.448304146528244
loss_pred:0.01398239005357027, decouple_loss:0.0019412949914112687
The modified gen p mean: 0.44799813628196716, gen p mean: -0.22670415043830872, mean p set: 0.44853144884109497
loss_pred:0.01404461357742548, decouple_loss:0.0019890263210982084
Iteration: 3340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742101430892944, gen p mean: -0.22246970236301422, mean p set: 0.4479982852935791
loss_pred:0.013700178824365139, decouple_loss:0.0021742775570601225
The modified gen p mean: 0.4475928544998169, gen p mean: -0.2234872579574585, mean p set: 0.4481172263622284The modified gen p mean: 0.44908440113067627, gen p mean: -0.2160758525133133, mean p set: 0.44966015219688416
loss_pred:0.013584749773144722, decouple_loss:0.0020895376801490784
loss_pred:0.014577673748135567, decouple_loss:0.0018506919732317328
2023-04-27 15:35:33 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22522060573101044, mean p set: 0.4499112665653229
loss_pred:0.016039248555898666, decouple_loss:0.002756943693384528
The modified gen p mean: 0.44821882247924805, gen p mean: -0.22262360155582428, mean p set: 0.44879910349845886
loss_pred:0.01604088768362999, decouple_loss:0.002692301757633686
The modified gen p mean: 0.44930580258369446, gen p mean: -0.22537800669670105, mean p set: 0.4498290419578552
loss_pred:0.015605714172124863, decouple_loss:0.002971660578623414
WV_1_PC_1_EH_0_PS_30, loss: 0.01603563129901886, avg_mse: 0.023732950910925865
current test mse: 0.023733
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 3341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44585564732551575, gen p mean: -0.22940605878829956, mean p set: 0.44638389348983765
loss_pred:0.013978933915495872, decouple_loss:0.0024555539712309837
The modified gen p mean: 0.4479784071445465, gen p mean: -0.22994448244571686, mean p set: 0.4485515058040619
loss_pred:0.015445622615516186, decouple_loss:0.0021894711535423994
The modified gen p mean: 0.4478905498981476, gen p mean: -0.2243427038192749, mean p set: 0.4484681785106659
loss_pred:0.015189365483820438, decouple_loss:0.0021012199576944113
Iteration: 3342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472002387046814, gen p mean: -0.2302154302597046, mean p set: 0.4477352201938629
loss_pred:0.015182610601186752, decouple_loss:0.0022271869238466024
The modified gen p mean: 0.4467390775680542, gen p mean: -0.23317107558250427, mean p set: 0.4473138451576233
loss_pred:0.014915425330400467, decouple_loss:0.001959349727258086
The modified gen p mean: 0.4476183354854584, gen p mean: -0.23074032366275787, mean p set: 0.4481956660747528
loss_pred:0.014957273378968239, decouple_loss:0.002166313584893942
Iteration: 3343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472074508666992, gen p mean: -0.22922353446483612, mean p set: 0.4477280378341675
loss_pred:0.014811456203460693, decouple_loss:0.001966428244486451
The modified gen p mean: 0.44754475355148315, gen p mean: -0.23479872941970825, mean p set: 0.44812464714050293
loss_pred:0.014867469668388367, decouple_loss:0.0021926395129412413
The modified gen p mean: 0.4472007155418396, gen p mean: -0.2339753806591034, mean p set: 0.4477818012237549
loss_pred:0.014542465098202229, decouple_loss:0.0020111280027776957
Iteration: 3344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472788870334625, gen p mean: -0.2357986867427826, mean p set: 0.4478060305118561
loss_pred:0.014893959276378155, decouple_loss:0.0021524913609027863
The modified gen p mean: 0.4479985237121582, gen p mean: -0.23035001754760742, mean p set: 0.4485739767551422
loss_pred:0.014488237909972668, decouple_loss:0.0018507306231185794
The modified gen p mean: 0.44688937067985535, gen p mean: -0.23417700827121735, mean p set: 0.44746458530426025
loss_pred:0.014760460704565048, decouple_loss:0.0018284182297065854
Iteration: 3345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827163219451904, gen p mean: -0.2269125133752823, mean p set: 0.44884711503982544
loss_pred:0.01517083402723074, decouple_loss:0.0021380018442869186
The modified gen p mean: 0.44830772280693054, gen p mean: -0.22605134546756744, mean p set: 0.44888749718666077
loss_pred:0.014265686273574829, decouple_loss:0.0018835412338376045
The modified gen p mean: 0.44774943590164185, gen p mean: -0.22160348296165466, mean p set: 0.4482816159725189
loss_pred:0.014823263511061668, decouple_loss:0.0022749463096261024
Iteration: 3346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727107882499695, gen p mean: -0.22395096719264984, mean p set: 0.44784313440322876
loss_pred:0.015142315998673439, decouple_loss:0.0018067203927785158
The modified gen p mean: 0.4460439085960388, gen p mean: -0.22378946840763092, mean p set: 0.44661951065063477
loss_pred:0.014994272962212563, decouple_loss:0.0019204086856916547
The modified gen p mean: 0.44745105504989624, gen p mean: -0.22595877945423126, mean p set: 0.44797375798225403
loss_pred:0.01563793048262596, decouple_loss:0.0018767504952847958
Iteration: 3347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476267397403717, gen p mean: -0.226362407207489, mean p set: 0.44820475578308105
loss_pred:0.014994049444794655, decouple_loss:0.0018518748693168163
The modified gen p mean: 0.4474527835845947, gen p mean: -0.2168663889169693, mean p set: 0.44803258776664734The modified gen p mean: 0.44768446683883667, gen p mean: -0.2219737023115158, mean p set: 0.4482135772705078
loss_pred:0.014487968757748604, decouple_loss:0.0018019945127889514
loss_pred:0.014553156681358814, decouple_loss:0.002118597272783518
Iteration: 3348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447285920381546, gen p mean: -0.21741028130054474, mean p set: 0.4478640854358673
loss_pred:0.013990024104714394, decouple_loss:0.002062608953565359
The modified gen p mean: 0.44849082827568054, gen p mean: -0.21964320540428162, mean p set: 0.4490656852722168The modified gen p mean: 0.44842278957366943, gen p mean: -0.21838784217834473, mean p set: 0.448952317237854
loss_pred:0.01442210003733635, decouple_loss:0.0019609236624091864
loss_pred:0.014486130326986313, decouple_loss:0.002062434097751975
Iteration: 3349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744598865509033, gen p mean: -0.2224373072385788, mean p set: 0.44802215695381165
loss_pred:0.014468607492744923, decouple_loss:0.002024345565587282
The modified gen p mean: 0.44804149866104126, gen p mean: -0.2227305918931961, mean p set: 0.4485728442668915
loss_pred:0.014746527187526226, decouple_loss:0.001975745428353548
The modified gen p mean: 0.4475261867046356, gen p mean: -0.21853433549404144, mean p set: 0.44809815287590027
loss_pred:0.013942630030214787, decouple_loss:0.0023532540071755648
Iteration: 3350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480968713760376, gen p mean: -0.23046529293060303, mean p set: 0.4486749470233917
loss_pred:0.014828626066446304, decouple_loss:0.0019953949376940727
The modified gen p mean: 0.4475858807563782, gen p mean: -0.22504757344722748, mean p set: 0.44816744327545166
loss_pred:0.015022071078419685, decouple_loss:0.0020097047090530396
The modified gen p mean: 0.44719991087913513, gen p mean: -0.22723588347434998, mean p set: 0.447729229927063
loss_pred:0.014621233567595482, decouple_loss:0.002374362200498581
2023-04-27 15:40:04 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22605745494365692, mean p set: 0.4499112665653229
loss_pred:0.015995025634765625, decouple_loss:0.0019088583067059517
The modified gen p mean: 0.4493058919906616, gen p mean: -0.22626934945583344, mean p set: 0.4498290419578552
loss_pred:0.015561257489025593, decouple_loss:0.0019944855011999607
The modified gen p mean: 0.44822120666503906, gen p mean: -0.2235611379146576, mean p set: 0.44879910349845886
loss_pred:0.015947062522172928, decouple_loss:0.0018505954649299383
WV_1_PC_1_EH_0_PS_30, loss: 0.015930350869894028, avg_mse: 0.023587608709931374
current test mse: 0.023588
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470824897289276, gen p mean: -0.22438164055347443, mean p set: 0.44765913486480713
loss_pred:0.01469364669173956, decouple_loss:0.0018405539449304342
The modified gen p mean: 0.44638702273368835, gen p mean: -0.22848208248615265, mean p set: 0.44691428542137146
loss_pred:0.014923554845154285, decouple_loss:0.0019716506358236074
The modified gen p mean: 0.4478455185890198, gen p mean: -0.22794468700885773, mean p set: 0.44841933250427246
loss_pred:0.015355749055743217, decouple_loss:0.0016055181622505188
Iteration: 3352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630083441734314, gen p mean: -0.23189692199230194, mean p set: 0.4468306601047516
loss_pred:0.013750733807682991, decouple_loss:0.0020621423609554768
The modified gen p mean: 0.448064923286438, gen p mean: -0.230409175157547, mean p set: 0.4486413896083832
The modified gen p mean: 0.44585564732551575, gen p mean: -0.23244152963161469, mean p set: 0.44642776250839233
loss_pred:0.0141432024538517, decouple_loss:0.0020307875238358974
loss_pred:0.014384094625711441, decouple_loss:0.002181375864893198
Iteration: 3353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471760094165802, gen p mean: -0.23119832575321198, mean p set: 0.4477040469646454
loss_pred:0.01457930263131857, decouple_loss:0.0019102038349956274
The modified gen p mean: 0.44723525643348694, gen p mean: -0.23270024359226227, mean p set: 0.4478125274181366
The modified gen p mean: 0.4460419714450836, gen p mean: -0.23122376203536987, mean p set: 0.4466179311275482
loss_pred:0.014229617081582546, decouple_loss:0.002002277411520481
loss_pred:0.01461281068623066, decouple_loss:0.0019097707699984312
Iteration: 3354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447557270526886, gen p mean: -0.22748051583766937, mean p set: 0.44809025526046753
loss_pred:0.014517678879201412, decouple_loss:0.0020344306249171495
The modified gen p mean: 0.44698697328567505, gen p mean: -0.2324315905570984, mean p set: 0.44756636023521423
The modified gen p mean: 0.44652843475341797, gen p mean: -0.22832876443862915, mean p set: 0.44709837436676025
loss_pred:0.014602670446038246, decouple_loss:0.0021875023376196623
loss_pred:0.015173977240920067, decouple_loss:0.002308119088411331
Iteration: 3355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828590750694275, gen p mean: -0.23021195828914642, mean p set: 0.4488631784915924
loss_pred:0.014426995068788528, decouple_loss:0.0017479646485298872
The modified gen p mean: 0.4472583532333374, gen p mean: -0.2232007086277008, mean p set: 0.44779056310653687The modified gen p mean: 0.4470251798629761, gen p mean: -0.22279925644397736, mean p set: 0.44759562611579895
loss_pred:0.014685485512018204, decouple_loss:0.0017923652194440365
loss_pred:0.014275722205638885, decouple_loss:0.0017390361754223704
Iteration: 3356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465090334415436, gen p mean: -0.22433389723300934, mean p set: 0.4470813572406769
loss_pred:0.014287392608821392, decouple_loss:0.0018330099992454052
The modified gen p mean: 0.4459569752216339, gen p mean: -0.2281162440776825, mean p set: 0.4465283155441284The modified gen p mean: 0.44747981429100037, gen p mean: -0.22765041887760162, mean p set: 0.4480046033859253
loss_pred:0.014978528022766113, decouple_loss:0.0019701970741152763
loss_pred:0.014263704419136047, decouple_loss:0.00191005680244416
Iteration: 3357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769972562789917, gen p mean: -0.22589360177516937, mean p set: 0.44827502965927124
loss_pred:0.014639242552220821, decouple_loss:0.001939248526468873
The modified gen p mean: 0.44667932391166687, gen p mean: -0.2258928120136261, mean p set: 0.44725507497787476
loss_pred:0.01450840663164854, decouple_loss:0.002003952395170927
The modified gen p mean: 0.4478473663330078, gen p mean: -0.22625137865543365, mean p set: 0.44837021827697754
loss_pred:0.014761028811335564, decouple_loss:0.001990071265026927
Iteration: 3358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478414058685303, gen p mean: -0.22851094603538513, mean p set: 0.4484192430973053
loss_pred:0.015169847756624222, decouple_loss:0.0018249995773658156
The modified gen p mean: 0.4466145634651184, gen p mean: -0.2290317416191101, mean p set: 0.44719401001930237
loss_pred:0.015211153775453568, decouple_loss:0.0018310255836695433
The modified gen p mean: 0.4474487006664276, gen p mean: -0.2282969206571579, mean p set: 0.44797828793525696
loss_pred:0.014850211329758167, decouple_loss:0.0017651886446401477
Iteration: 3359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481373131275177, gen p mean: -0.2251194417476654, mean p set: 0.4487118422985077
loss_pred:0.014275401830673218, decouple_loss:0.0018888900522142649
The modified gen p mean: 0.446176141500473, gen p mean: -0.23106873035430908, mean p set: 0.4467509686946869
loss_pred:0.01491800881922245, decouple_loss:0.002292781602591276
The modified gen p mean: 0.4467175602912903, gen p mean: -0.22841909527778625, mean p set: 0.44724181294441223
loss_pred:0.014170444570481777, decouple_loss:0.001967126037925482
Iteration: 3360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464387595653534, gen p mean: -0.226157546043396, mean p set: 0.4470071494579315
loss_pred:0.014547931030392647, decouple_loss:0.0017716084839776158
The modified gen p mean: 0.44759437441825867, gen p mean: -0.22358043491840363, mean p set: 0.4481656849384308The modified gen p mean: 0.4474254846572876, gen p mean: -0.2238965928554535, mean p set: 0.4479471743106842
loss_pred:0.014742394909262657, decouple_loss:0.0017420414369553328
loss_pred:0.014942072331905365, decouple_loss:0.0017530234763398767
2023-04-27 15:43:28 testing...
The modified gen p mean: 0.44822150468826294, gen p mean: -0.21638204157352448, mean p set: 0.44879910349845886
loss_pred:0.01587609201669693, decouple_loss:0.0022221568506211042
The modified gen p mean: 0.4492979049682617, gen p mean: -0.2194378823041916, mean p set: 0.4498290419578552
loss_pred:0.015489371493458748, decouple_loss:0.002199109410867095
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21895797550678253, mean p set: 0.4499112665653229
loss_pred:0.015987275168299675, decouple_loss:0.002364487387239933
WV_1_PC_1_EH_0_PS_30, loss: 0.015897344797849655, avg_mse: 0.023559385910630226
current test mse: 0.023559
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 3361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747859239578247, gen p mean: -0.22351624071598053, mean p set: 0.44801008701324463
loss_pred:0.014921309426426888, decouple_loss:0.0022148427087813616
The modified gen p mean: 0.44652220606803894, gen p mean: -0.22483181953430176, mean p set: 0.44709834456443787
The modified gen p mean: 0.4482268691062927, gen p mean: -0.22269845008850098, mean p set: 0.4488007128238678
loss_pred:0.0149800144135952, decouple_loss:0.0022571466397494078
loss_pred:0.014581507071852684, decouple_loss:0.0020825995597988367
Iteration: 3362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769424200057983, gen p mean: -0.21747127175331116, mean p set: 0.44821611046791077
loss_pred:0.015357466414570808, decouple_loss:0.0018965651979669929
The modified gen p mean: 0.44729357957839966, gen p mean: -0.2226138412952423, mean p set: 0.4478735327720642
The modified gen p mean: 0.44673892855644226, gen p mean: -0.21628610789775848, mean p set: 0.4473150670528412
loss_pred:0.015251751989126205, decouple_loss:0.0019115944160148501
loss_pred:0.015313261188566685, decouple_loss:0.0020593171939253807
Iteration: 3363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467531144618988, gen p mean: -0.2247694879770279, mean p set: 0.44727712869644165
loss_pred:0.014482819475233555, decouple_loss:0.0018675853498280048
The modified gen p mean: 0.4467082917690277, gen p mean: -0.22078219056129456, mean p set: 0.4472885727882385
The modified gen p mean: 0.44688764214515686, gen p mean: -0.22271062433719635, mean p set: 0.44745954871177673
loss_pred:0.015648014843463898, decouple_loss:0.0020736174192279577
loss_pred:0.014979523606598377, decouple_loss:0.0018976731225848198
Iteration: 3364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468317925930023, gen p mean: -0.2264205366373062, mean p set: 0.44740915298461914
loss_pred:0.015189040452241898, decouple_loss:0.001955515006557107
The modified gen p mean: 0.44934356212615967, gen p mean: -0.22064776718616486, mean p set: 0.449869304895401The modified gen p mean: 0.44973093271255493, gen p mean: -0.2212045043706894, mean p set: 0.45031026005744934
loss_pred:0.01491287350654602, decouple_loss:0.00202927365899086
loss_pred:0.014966854825615883, decouple_loss:0.002114098984748125
Iteration: 3365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463353753089905, gen p mean: -0.22269928455352783, mean p set: 0.4469049572944641
loss_pred:0.01490887813270092, decouple_loss:0.0018752713222056627
The modified gen p mean: 0.44722795486450195, gen p mean: -0.21810847520828247, mean p set: 0.44780421257019043
loss_pred:0.014548560604453087, decouple_loss:0.0017923959530889988
The modified gen p mean: 0.4472389817237854, gen p mean: -0.21733082830905914, mean p set: 0.4477689266204834
loss_pred:0.015018298290669918, decouple_loss:0.001810747548006475
Iteration: 3366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475090801715851, gen p mean: -0.22340020537376404, mean p set: 0.44808489084243774
loss_pred:0.0148397758603096, decouple_loss:0.0018882142612710595
The modified gen p mean: 0.4477232098579407, gen p mean: -0.22172710299491882, mean p set: 0.4482978880405426The modified gen p mean: 0.44707977771759033, gen p mean: -0.22323884069919586, mean p set: 0.4476076066493988
loss_pred:0.015013311989605427, decouple_loss:0.0021692877635359764
loss_pred:0.014805744402110577, decouple_loss:0.002010189462453127
Iteration: 3367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473307430744171, gen p mean: -0.2221076339483261, mean p set: 0.4479130506515503
loss_pred:0.014496770687401295, decouple_loss:0.0018670809222385287
The modified gen p mean: 0.4477025866508484, gen p mean: -0.22121112048625946, mean p set: 0.44827497005462646
loss_pred:0.014289694838225842, decouple_loss:0.0017979711992666125
The modified gen p mean: 0.4479868710041046, gen p mean: -0.22236810624599457, mean p set: 0.44851356744766235
loss_pred:0.014887731522321701, decouple_loss:0.0019181360257789493
Iteration: 3368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477554261684418, gen p mean: -0.22375847399234772, mean p set: 0.44832706451416016
loss_pred:0.014780663885176182, decouple_loss:0.0020338892936706543
The modified gen p mean: 0.44842955470085144, gen p mean: -0.2271222323179245, mean p set: 0.44900041818618774
loss_pred:0.014545160345733166, decouple_loss:0.001975162886083126
The modified gen p mean: 0.44779589772224426, gen p mean: -0.2211712896823883, mean p set: 0.4483223557472229
loss_pred:0.014469841495156288, decouple_loss:0.001929866150021553
Iteration: 3369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460476040840149, gen p mean: -0.23173776268959045, mean p set: 0.4466274678707123
loss_pred:0.01514847669750452, decouple_loss:0.0019622480031102896
The modified gen p mean: 0.44821640849113464, gen p mean: -0.22511710226535797, mean p set: 0.4487912356853485
loss_pred:0.015067963860929012, decouple_loss:0.0020551520865410566
The modified gen p mean: 0.4474869668483734, gen p mean: -0.2222977876663208, mean p set: 0.44801437854766846
loss_pred:0.014752793125808239, decouple_loss:0.002137664705514908
Iteration: 3370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475095272064209, gen p mean: -0.23078863322734833, mean p set: 0.448087215423584
loss_pred:0.014646473340690136, decouple_loss:0.001949371537193656
The modified gen p mean: 0.4475178122520447, gen p mean: -0.23504820466041565, mean p set: 0.4480946362018585
loss_pred:0.01482066698372364, decouple_loss:0.0017518941313028336
The modified gen p mean: 0.44866135716438293, gen p mean: -0.23397012054920197, mean p set: 0.449184387922287
loss_pred:0.0145276403054595, decouple_loss:0.0019265194423496723
2023-04-27 15:47:35 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22910234332084656, mean p set: 0.4499112665653229
loss_pred:0.01598803699016571, decouple_loss:0.0019143864046782255
The modified gen p mean: 0.4493001103401184, gen p mean: -0.2291995882987976, mean p set: 0.4498290419578552
loss_pred:0.015495711006224155, decouple_loss:0.001890711602754891
The modified gen p mean: 0.44822636246681213, gen p mean: -0.22650013864040375, mean p set: 0.44879910349845886
loss_pred:0.015869123861193657, decouple_loss:0.001960120163857937
WV_1_PC_1_EH_0_PS_30, loss: 0.01588037982583046, avg_mse: 0.02359151281416416
current test mse: 0.023592
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485204219818115, gen p mean: -0.22693456709384918, mean p set: 0.44909462332725525
loss_pred:0.014532108791172504, decouple_loss:0.0018795717041939497
The modified gen p mean: 0.4493834674358368, gen p mean: -0.22805142402648926, mean p set: 0.4499136209487915
loss_pred:0.015005849301815033, decouple_loss:0.001872885855846107
The modified gen p mean: 0.4484146237373352, gen p mean: -0.23115676641464233, mean p set: 0.4489942789077759
loss_pred:0.01463286578655243, decouple_loss:0.0017833685269579291
Iteration: 3372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723060727119446, gen p mean: -0.2333858460187912, mean p set: 0.44775891304016113
loss_pred:0.015187747776508331, decouple_loss:0.002420388860628009
The modified gen p mean: 0.4471002519130707, gen p mean: -0.23324687778949738, mean p set: 0.44767752289772034
The modified gen p mean: 0.44921445846557617, gen p mean: -0.2310492843389511, mean p set: 0.449787974357605
loss_pred:0.014702525921165943, decouple_loss:0.0018859771080315113
loss_pred:0.01449841819703579, decouple_loss:0.0019949879497289658
Iteration: 3373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473131000995636, gen p mean: -0.23119783401489258, mean p set: 0.44784191250801086
loss_pred:0.014833194203674793, decouple_loss:0.0018760273233056068
The modified gen p mean: 0.4473986029624939, gen p mean: -0.22919419407844543, mean p set: 0.4479758143424988
The modified gen p mean: 0.4469900131225586, gen p mean: -0.2308717668056488, mean p set: 0.447562575340271
loss_pred:0.014159775339066982, decouple_loss:0.001766667701303959
loss_pred:0.014909579418599606, decouple_loss:0.0020264964550733566
Iteration: 3374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461107850074768, gen p mean: -0.2311101257801056, mean p set: 0.4466356933116913
loss_pred:0.014665823429822922, decouple_loss:0.001971774734556675
The modified gen p mean: 0.4484522342681885, gen p mean: -0.2256947159767151, mean p set: 0.44902777671813965
The modified gen p mean: 0.4453880190849304, gen p mean: -0.2313193529844284, mean p set: 0.445966511964798
loss_pred:0.014548413455486298, decouple_loss:0.0021907463669776917
loss_pred:0.015019875019788742, decouple_loss:0.0020890943706035614
Iteration: 3375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829604029655457, gen p mean: -0.230087012052536, mean p set: 0.44887441396713257
loss_pred:0.014693520031869411, decouple_loss:0.0018529958324506879
The modified gen p mean: 0.4470897614955902, gen p mean: -0.23539882898330688, mean p set: 0.44761988520622253The modified gen p mean: 0.44706881046295166, gen p mean: -0.2274041473865509, mean p set: 0.447646826505661
loss_pred:0.014946487732231617, decouple_loss:0.001922284602187574
loss_pred:0.014789068140089512, decouple_loss:0.002821501111611724
Iteration: 3376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473218023777008, gen p mean: -0.22870676219463348, mean p set: 0.44789430499076843
loss_pred:0.014889259822666645, decouple_loss:0.0022497219033539295
The modified gen p mean: 0.4481693506240845, gen p mean: -0.2344781458377838, mean p set: 0.44869065284729004The modified gen p mean: 0.44768455624580383, gen p mean: -0.23272952437400818, mean p set: 0.44826194643974304
loss_pred:0.015041198581457138, decouple_loss:0.002269889460876584
loss_pred:0.014538141898810863, decouple_loss:0.0020690103992819786
Iteration: 3377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44598689675331116, gen p mean: -0.23574882745742798, mean p set: 0.44656795263290405
loss_pred:0.015029596164822578, decouple_loss:0.002012829761952162
The modified gen p mean: 0.4469318091869354, gen p mean: -0.23558978736400604, mean p set: 0.4474617540836334The modified gen p mean: 0.447933554649353, gen p mean: -0.23133985698223114, mean p set: 0.4485120475292206
loss_pred:0.015321164391934872, decouple_loss:0.0019633860792964697
loss_pred:0.014922178350389004, decouple_loss:0.002157083246856928
Iteration: 3378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718101620674133, gen p mean: -0.23551426827907562, mean p set: 0.44775715470314026
loss_pred:0.014780565164983273, decouple_loss:0.0018822052516043186
The modified gen p mean: 0.4467929005622864, gen p mean: -0.23456478118896484, mean p set: 0.44736772775650024
loss_pred:0.014559491537511349, decouple_loss:0.0019093401497229934
The modified gen p mean: 0.4483245611190796, gen p mean: -0.23898383975028992, mean p set: 0.4488462209701538
loss_pred:0.014857516624033451, decouple_loss:0.001969115110114217
Iteration: 3379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606417417526245, gen p mean: -0.24048633873462677, mean p set: 0.4466353952884674
loss_pred:0.014655521139502525, decouple_loss:0.0019831524696201086
The modified gen p mean: 0.44757595658302307, gen p mean: -0.2367851883172989, mean p set: 0.4481530487537384
loss_pred:0.014570461586117744, decouple_loss:0.0018987110815942287
The modified gen p mean: 0.4479692280292511, gen p mean: -0.23862385749816895, mean p set: 0.4484986364841461
loss_pred:0.014397435821592808, decouple_loss:0.0019348682835698128
Iteration: 3380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461374878883362, gen p mean: -0.2393624186515808, mean p set: 0.44671642780303955
loss_pred:0.015083367004990578, decouple_loss:0.002031540498137474
The modified gen p mean: 0.4490077495574951, gen p mean: -0.23966100811958313, mean p set: 0.44957879185676575
loss_pred:0.01437102910131216, decouple_loss:0.002178838476538658
The modified gen p mean: 0.44554004073143005, gen p mean: -0.23945632576942444, mean p set: 0.44606801867485046
loss_pred:0.01494710985571146, decouple_loss:0.0021543167531490326
2023-04-27 15:50:59 testing...
The modified gen p mean: 0.4482187032699585, gen p mean: -0.23084038496017456, mean p set: 0.44879910349845886
loss_pred:0.01591927371919155, decouple_loss:0.0024997671134769917
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2331332117319107, mean p set: 0.4499112665653229
loss_pred:0.016052884981036186, decouple_loss:0.0024176992010325193
The modified gen p mean: 0.4493068754673004, gen p mean: -0.23365518450737, mean p set: 0.4498290419578552
loss_pred:0.015522190369665623, decouple_loss:0.0022894118446856737
WV_1_PC_1_EH_0_PS_30, loss: 0.01595156639814377, avg_mse: 0.0236357394605875
current test mse: 0.023636
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 3381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756001234054565, gen p mean: -0.232760950922966, mean p set: 0.4480917155742645
loss_pred:0.015133555047214031, decouple_loss:0.0023547413293272257
The modified gen p mean: 0.44733303785324097, gen p mean: -0.2328893542289734, mean p set: 0.4479069411754608
loss_pred:0.015107549726963043, decouple_loss:0.0021925270557403564
The modified gen p mean: 0.4481920301914215, gen p mean: -0.23364926874637604, mean p set: 0.4487678110599518
loss_pred:0.014339721761643887, decouple_loss:0.002123364945873618
Iteration: 3382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779232144355774, gen p mean: -0.2304532676935196, mean p set: 0.44831904768943787
loss_pred:0.014959723688662052, decouple_loss:0.002272064099088311
The modified gen p mean: 0.4480704367160797, gen p mean: -0.22556930780410767, mean p set: 0.4486466944217682
loss_pred:0.01461054477840662, decouple_loss:0.002103702398017049
The modified gen p mean: 0.448123574256897, gen p mean: -0.22756245732307434, mean p set: 0.44870179891586304
loss_pred:0.014819133095443249, decouple_loss:0.0019546146504580975
Iteration: 3383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719383120536804, gen p mean: -0.23097118735313416, mean p set: 0.44771865010261536
loss_pred:0.01413746178150177, decouple_loss:0.0022602714598178864
The modified gen p mean: 0.44777482748031616, gen p mean: -0.22858943045139313, mean p set: 0.4483511745929718
loss_pred:0.014404769986867905, decouple_loss:0.0022318593692034483
The modified gen p mean: 0.44649311900138855, gen p mean: -0.2286195456981659, mean p set: 0.44706112146377563
loss_pred:0.014746883884072304, decouple_loss:0.0019975791219621897
Iteration: 3384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476921856403351, gen p mean: -0.22655948996543884, mean p set: 0.44821682572364807
loss_pred:0.014727283269166946, decouple_loss:0.0022970258723944426
The modified gen p mean: 0.44660264253616333, gen p mean: -0.2263147532939911, mean p set: 0.4471800923347473
loss_pred:0.014976231381297112, decouple_loss:0.0022786096669733524
The modified gen p mean: 0.44744738936424255, gen p mean: -0.22740231454372406, mean p set: 0.44802039861679077
loss_pred:0.014182482846081257, decouple_loss:0.0023647313937544823
Iteration: 3385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477081000804901, gen p mean: -0.22770924866199493, mean p set: 0.4482864737510681
loss_pred:0.014445057138800621, decouple_loss:0.00204898277297616
The modified gen p mean: 0.44829267263412476, gen p mean: -0.22695043683052063, mean p set: 0.4488621652126312
loss_pred:0.014986086636781693, decouple_loss:0.002253045327961445
The modified gen p mean: 0.44722428917884827, gen p mean: -0.22632481157779694, mean p set: 0.4477475583553314
loss_pred:0.01416842546314001, decouple_loss:0.002182271797209978
Iteration: 3386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757068157196045, gen p mean: -0.23034730553627014, mean p set: 0.44814959168434143
loss_pred:0.01411129254847765, decouple_loss:0.0021016860846430063
The modified gen p mean: 0.4470389485359192, gen p mean: -0.23126089572906494, mean p set: 0.4476131498813629The modified gen p mean: 0.4476688504219055, gen p mean: -0.2296367734670639, mean p set: 0.44819164276123047
loss_pred:0.013803624548017979, decouple_loss:0.002301635919138789
loss_pred:0.014149650000035763, decouple_loss:0.0020088350865989923
Iteration: 3387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471687078475952, gen p mean: -0.23069997131824493, mean p set: 0.4477413594722748
loss_pred:0.01457888726145029, decouple_loss:0.0019215737702324986
The modified gen p mean: 0.447639137506485, gen p mean: -0.23097528517246246, mean p set: 0.4482089579105377
The modified gen p mean: 0.44679591059684753, gen p mean: -0.22652706503868103, mean p set: 0.44731831550598145
loss_pred:0.014647289179265499, decouple_loss:0.0020801599603146315
loss_pred:0.014788275584578514, decouple_loss:0.0020316920708864927
Iteration: 3388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474336802959442, gen p mean: -0.2350691258907318, mean p set: 0.4480080008506775
loss_pred:0.014843231998383999, decouple_loss:0.002190312137827277
The modified gen p mean: 0.4476541578769684, gen p mean: -0.23653262853622437, mean p set: 0.4482249617576599
loss_pred:0.014299529604613781, decouple_loss:0.0020978162065148354
The modified gen p mean: 0.4479321837425232, gen p mean: -0.23448319733142853, mean p set: 0.44846081733703613
loss_pred:0.014198923483490944, decouple_loss:0.002209695754572749
Iteration: 3389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477027654647827, gen p mean: -0.23525935411453247, mean p set: 0.44828295707702637
loss_pred:0.014731132425367832, decouple_loss:0.0018883703742176294
The modified gen p mean: 0.4469715356826782, gen p mean: -0.2334306389093399, mean p set: 0.44754406809806824
loss_pred:0.01430529821664095, decouple_loss:0.0020358781330287457
The modified gen p mean: 0.4470725953578949, gen p mean: -0.22762015461921692, mean p set: 0.44760891795158386
loss_pred:0.01487648207694292, decouple_loss:0.0020504656713455915
Iteration: 3390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473497271537781, gen p mean: -0.233297199010849, mean p set: 0.44792893528938293
loss_pred:0.01492334809154272, decouple_loss:0.002005350776016712
The modified gen p mean: 0.4476622939109802, gen p mean: -0.23322156071662903, mean p set: 0.44823944568634033
loss_pred:0.014543937519192696, decouple_loss:0.0020837546326220036
The modified gen p mean: 0.44749951362609863, gen p mean: -0.2321394979953766, mean p set: 0.4480248689651489
loss_pred:0.014076321385800838, decouple_loss:0.0021010509226471186
2023-04-27 15:55:06 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23302628099918365, mean p set: 0.4499112665653229
loss_pred:0.016184983775019646, decouple_loss:0.002201457740738988
The modified gen p mean: 0.4493025839328766, gen p mean: -0.23347878456115723, mean p set: 0.4498290419578552
loss_pred:0.015697695314884186, decouple_loss:0.0021803530398756266
The modified gen p mean: 0.4482264816761017, gen p mean: -0.23033131659030914, mean p set: 0.44879910349845886
loss_pred:0.016019774600863457, decouple_loss:0.002307164715602994
WV_1_PC_1_EH_0_PS_30, loss: 0.016078967601060867, avg_mse: 0.02385428361594677
current test mse: 0.023854
Iteration: 3391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447042316198349, gen p mean: -0.23583440482616425, mean p set: 0.44761648774147034
loss_pred:0.014034053310751915, decouple_loss:0.0022232825867831707
The modified gen p mean: 0.4477057158946991, gen p mean: -0.23200610280036926, mean p set: 0.4482308626174927
loss_pred:0.014488473534584045, decouple_loss:0.002327692462131381
The modified gen p mean: 0.44862884283065796, gen p mean: -0.22743435204029083, mean p set: 0.4492107927799225
loss_pred:0.014652511104941368, decouple_loss:0.0021131073590368032
Iteration: 3392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721680879592896, gen p mean: -0.23086127638816833, mean p set: 0.4477456510066986
loss_pred:0.014718079008162022, decouple_loss:0.0024234375450760126
The modified gen p mean: 0.4471265971660614, gen p mean: -0.23116597533226013, mean p set: 0.44770246744155884
The modified gen p mean: 0.4472787082195282, gen p mean: -0.22855053842067719, mean p set: 0.44785353541374207
loss_pred:0.014202876947820187, decouple_loss:0.0021168370731174946
loss_pred:0.01433997880667448, decouple_loss:0.002293155761435628
Iteration: 3393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895970821380615, gen p mean: -0.22568009793758392, mean p set: 0.4494889974594116
loss_pred:0.013893715105950832, decouple_loss:0.002194308675825596
The modified gen p mean: 0.44821250438690186, gen p mean: -0.2278766632080078, mean p set: 0.44879069924354553
The modified gen p mean: 0.44724801182746887, gen p mean: -0.2271081507205963, mean p set: 0.4478244483470917
loss_pred:0.01382516510784626, decouple_loss:0.002231020713225007
loss_pred:0.014355259016156197, decouple_loss:0.0020937963854521513
Iteration: 3394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475387930870056, gen p mean: -0.22768521308898926, mean p set: 0.44806867837905884
loss_pred:0.014485039748251438, decouple_loss:0.0020549765322357416
The modified gen p mean: 0.44875189661979675, gen p mean: -0.22582532465457916, mean p set: 0.4493274986743927
The modified gen p mean: 0.4481680393218994, gen p mean: -0.22542153298854828, mean p set: 0.4487457573413849
loss_pred:0.014501643367111683, decouple_loss:0.0021167576778680086
loss_pred:0.014554381370544434, decouple_loss:0.0021820359397679567
Iteration: 3395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472656548023224, gen p mean: -0.22565466165542603, mean p set: 0.4478406012058258
loss_pred:0.014579099602997303, decouple_loss:0.0019390645902603865
The modified gen p mean: 0.4469224512577057, gen p mean: -0.22486673295497894, mean p set: 0.44745007157325745The modified gen p mean: 0.44846785068511963, gen p mean: -0.2234209030866623, mean p set: 0.44904205203056335
loss_pred:0.013886719942092896, decouple_loss:0.0021680803038179874
loss_pred:0.014216768555343151, decouple_loss:0.0021059189457446337
Iteration: 3396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820645451545715, gen p mean: -0.22507056593894958, mean p set: 0.44877755641937256
loss_pred:0.014736570417881012, decouple_loss:0.0021556015126407146
The modified gen p mean: 0.4472886323928833, gen p mean: -0.2290494590997696, mean p set: 0.4478645324707031
loss_pred:0.013992921449244022, decouple_loss:0.002654395531862974
The modified gen p mean: 0.4477139711380005, gen p mean: -0.22731134295463562, mean p set: 0.4482399523258209
loss_pred:0.014719383791089058, decouple_loss:0.002365780295804143
Iteration: 3397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473537504673004, gen p mean: -0.22898991405963898, mean p set: 0.4479289650917053
loss_pred:0.014816677197813988, decouple_loss:0.00215666345320642
The modified gen p mean: 0.4482414126396179, gen p mean: -0.22470706701278687, mean p set: 0.4488186836242676
The modified gen p mean: 0.44677260518074036, gen p mean: -0.22895404696464539, mean p set: 0.4472944438457489
loss_pred:0.01440210547298193, decouple_loss:0.0019343295134603977
loss_pred:0.014488405548036098, decouple_loss:0.0019706524908542633
Iteration: 3398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797587394714355, gen p mean: -0.2269773632287979, mean p set: 0.44855615496635437
loss_pred:0.014341341331601143, decouple_loss:0.0021228750701993704
The modified gen p mean: 0.4474652111530304, gen p mean: -0.22614948451519012, mean p set: 0.4480433166027069
loss_pred:0.01371072418987751, decouple_loss:0.0024658008478581905
The modified gen p mean: 0.44612663984298706, gen p mean: -0.22476311028003693, mean p set: 0.44665300846099854
loss_pred:0.014576440677046776, decouple_loss:0.0019804746843874454
Iteration: 3399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460326135158539, gen p mean: -0.22506773471832275, mean p set: 0.44660380482673645
loss_pred:0.014691043645143509, decouple_loss:0.0020650015212595463
The modified gen p mean: 0.44723814725875854, gen p mean: -0.2287268191576004, mean p set: 0.4478210508823395
loss_pred:0.014619745314121246, decouple_loss:0.0019166965503245592
The modified gen p mean: 0.44782984256744385, gen p mean: -0.22413450479507446, mean p set: 0.4483618438243866
loss_pred:0.014248775318264961, decouple_loss:0.0018675884930416942
Iteration: 3400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756457209587097, gen p mean: -0.23443949222564697, mean p set: 0.4481387734413147
loss_pred:0.014414978213608265, decouple_loss:0.002232464263215661
The modified gen p mean: 0.44689497351646423, gen p mean: -0.235306978225708, mean p set: 0.44742754101753235
The modified gen p mean: 0.44881531596183777, gen p mean: -0.2286674678325653, mean p set: 0.4493890404701233
loss_pred:0.014345424249768257, decouple_loss:0.0020403550006449223
loss_pred:0.013993360102176666, decouple_loss:0.002527956385165453
2023-04-27 15:58:31 testing...
The modified gen p mean: 0.44821852445602417, gen p mean: -0.22953671216964722, mean p set: 0.44879910349845886
loss_pred:0.015945397317409515, decouple_loss:0.0019164244877174497
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2322336882352829, mean p set: 0.4499112665653229
loss_pred:0.016131144016981125, decouple_loss:0.0019284175941720605
The modified gen p mean: 0.44930344820022583, gen p mean: -0.23289121687412262, mean p set: 0.4498290419578552
loss_pred:0.01564553938806057, decouple_loss:0.0018719462677836418
WV_1_PC_1_EH_0_PS_30, loss: 0.01600264012813568, avg_mse: 0.023783165961503983
current test mse: 0.023783
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 3401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44564980268478394, gen p mean: -0.23587791621685028, mean p set: 0.446174293756485
loss_pred:0.015082181431353092, decouple_loss:0.0017633098177611828
The modified gen p mean: 0.44576603174209595, gen p mean: -0.23145852982997894, mean p set: 0.4463409185409546
The modified gen p mean: 0.44708120822906494, gen p mean: -0.23601596057415009, mean p set: 0.44765836000442505
loss_pred:0.015104132704436779, decouple_loss:0.001913014450110495
loss_pred:0.015047294087707996, decouple_loss:0.0018814920913428068
Iteration: 3402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699037075042725, gen p mean: -0.23140893876552582, mean p set: 0.44752374291419983
loss_pred:0.015533833764493465, decouple_loss:0.002427474595606327
The modified gen p mean: 0.4465039372444153, gen p mean: -0.23345443606376648, mean p set: 0.44707778096199036
loss_pred:0.01503109373152256, decouple_loss:0.002312681172043085
The modified gen p mean: 0.44697463512420654, gen p mean: -0.23041586577892303, mean p set: 0.44754984974861145
loss_pred:0.015076350420713425, decouple_loss:0.0020683775655925274
Iteration: 3403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446550190448761, gen p mean: -0.23239587247371674, mean p set: 0.4470827281475067
loss_pred:0.014920110814273357, decouple_loss:0.0019695383962243795
The modified gen p mean: 0.44627276062965393, gen p mean: -0.23259025812149048, mean p set: 0.4468485414981842
loss_pred:0.015151718631386757, decouple_loss:0.0017612993251532316
The modified gen p mean: 0.44646018743515015, gen p mean: -0.23380376398563385, mean p set: 0.4470359981060028
loss_pred:0.014818314462900162, decouple_loss:0.0019683982245624065
Iteration: 3404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.444144606590271, gen p mean: -0.22941073775291443, mean p set: 0.44466984272003174
loss_pred:0.015407430939376354, decouple_loss:0.0020334532018750906
The modified gen p mean: 0.445902556180954, gen p mean: -0.23109084367752075, mean p set: 0.44647544622421265
loss_pred:0.015691615641117096, decouple_loss:0.0019360134610906243
The modified gen p mean: 0.44696006178855896, gen p mean: -0.23114138841629028, mean p set: 0.4475346803665161
loss_pred:0.01575128547847271, decouple_loss:0.0019621378742158413
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468713700771332, gen p mean: -0.23243525624275208, mean p set: 0.44744303822517395
loss_pred:0.015084794722497463, decouple_loss:0.001978579442948103
The modified gen p mean: 0.44705015420913696, gen p mean: -0.23231105506420135, mean p set: 0.4476243555545807The modified gen p mean: 0.44670796394348145, gen p mean: -0.23174433410167694, mean p set: 0.44723621010780334
loss_pred:0.01479464303702116, decouple_loss:0.001964740687981248loss_pred:0.014964721165597439, decouple_loss:0.001849877298809588
Iteration: 3406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640475511550903, gen p mean: -0.234445720911026, mean p set: 0.446982741355896
loss_pred:0.014959576539695263, decouple_loss:0.0019192923791706562
The modified gen p mean: 0.4467492997646332, gen p mean: -0.23405440151691437, mean p set: 0.4472745358943939The modified gen p mean: 0.44706594944000244, gen p mean: -0.2369404435157776, mean p set: 0.4476405084133148
loss_pred:0.01505305990576744, decouple_loss:0.0018394121434539557
loss_pred:0.01446820143610239, decouple_loss:0.001934295753017068
Iteration: 3407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705724716186523, gen p mean: -0.2263631373643875, mean p set: 0.44763532280921936
loss_pred:0.015435931272804737, decouple_loss:0.002025187946856022
The modified gen p mean: 0.44582441449165344, gen p mean: -0.22993974387645721, mean p set: 0.44640541076660156
loss_pred:0.01501518115401268, decouple_loss:0.001921104732900858
The modified gen p mean: 0.4463925063610077, gen p mean: -0.23111698031425476, mean p set: 0.4469238221645355
loss_pred:0.015392841771245003, decouple_loss:0.0022951767314225435
Iteration: 3408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729381799697876, gen p mean: -0.2281910479068756, mean p set: 0.4478660225868225
loss_pred:0.01572319120168686, decouple_loss:0.0022956987377256155
The modified gen p mean: 0.44717922806739807, gen p mean: -0.2314351350069046, mean p set: 0.44770827889442444The modified gen p mean: 0.4454665184020996, gen p mean: -0.23135045170783997, mean p set: 0.44604605436325073
loss_pred:0.014612646773457527, decouple_loss:0.0020928559824824333
loss_pred:0.01526101864874363, decouple_loss:0.0022779430728405714
Iteration: 3409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786950945854187, gen p mean: -0.22701860964298248, mean p set: 0.4484444558620453
loss_pred:0.01568484865128994, decouple_loss:0.001902892836369574
The modified gen p mean: 0.44647812843322754, gen p mean: -0.2269059121608734, mean p set: 0.4470106363296509The modified gen p mean: 0.4469190239906311, gen p mean: -0.2328418493270874, mean p set: 0.44749611616134644
loss_pred:0.014716671779751778, decouple_loss:0.0018596092704683542
loss_pred:0.015045288018882275, decouple_loss:0.001893581124022603
Iteration: 3410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455426335334778, gen p mean: -0.22531190514564514, mean p set: 0.44611749053001404
loss_pred:0.014794410206377506, decouple_loss:0.002116644522175193
The modified gen p mean: 0.4460070729255676, gen p mean: -0.22777462005615234, mean p set: 0.4465799629688263The modified gen p mean: 0.44487303495407104, gen p mean: -0.225525364279747, mean p set: 0.4453986883163452
loss_pred:0.014511833898723125, decouple_loss:0.0019595499616116285
loss_pred:0.015538415871560574, decouple_loss:0.0022907669190317392
2023-04-27 16:02:39 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2288464605808258, mean p set: 0.4499112665653229
loss_pred:0.016078820452094078, decouple_loss:0.00227751093916595
The modified gen p mean: 0.4482191801071167, gen p mean: -0.22606202960014343, mean p set: 0.44879910349845886
loss_pred:0.015981780365109444, decouple_loss:0.001994096441194415
The modified gen p mean: 0.4493023753166199, gen p mean: -0.22925733029842377, mean p set: 0.4498290419578552
loss_pred:0.015617862343788147, decouple_loss:0.0021406577434390783
WV_1_PC_1_EH_0_PS_30, loss: 0.015999693423509598, avg_mse: 0.02375986985862255
current test mse: 0.02376
Iteration: 3411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467203915119171, gen p mean: -0.22861003875732422, mean p set: 0.44729533791542053
loss_pred:0.014533394947648048, decouple_loss:0.001838582451455295
The modified gen p mean: 0.44608139991760254, gen p mean: -0.22711598873138428, mean p set: 0.4466569721698761
loss_pred:0.015141421929001808, decouple_loss:0.002048817928880453
The modified gen p mean: 0.445420503616333, gen p mean: -0.22728581726551056, mean p set: 0.4459480941295624
loss_pred:0.015002579428255558, decouple_loss:0.0018945630872622132
Iteration: 3412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678184390068054, gen p mean: -0.23105880618095398, mean p set: 0.44731536507606506
loss_pred:0.015172137878835201, decouple_loss:0.001949356053955853
The modified gen p mean: 0.44656357169151306, gen p mean: -0.22994616627693176, mean p set: 0.44714006781578064
loss_pred:0.015145104378461838, decouple_loss:0.0019223648123443127
The modified gen p mean: 0.44624075293540955, gen p mean: -0.22892293334007263, mean p set: 0.4468083381652832
loss_pred:0.014969218522310257, decouple_loss:0.0019017263548448682
Iteration: 3413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468705952167511, gen p mean: -0.23014596104621887, mean p set: 0.447405070066452
loss_pred:0.01474955677986145, decouple_loss:0.001990188844501972
The modified gen p mean: 0.44620758295059204, gen p mean: -0.22886256873607635, mean p set: 0.44678211212158203The modified gen p mean: 0.44705790281295776, gen p mean: -0.22943070530891418, mean p set: 0.4476345181465149
loss_pred:0.014797551557421684, decouple_loss:0.002147846855223179
loss_pred:0.014875411987304688, decouple_loss:0.0021320260129868984
Iteration: 3414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464241862297058, gen p mean: -0.22790256142616272, mean p set: 0.44695156812667847
loss_pred:0.014777546748518944, decouple_loss:0.0019871217664331198
The modified gen p mean: 0.4454876780509949, gen p mean: -0.22596225142478943, mean p set: 0.44606199860572815The modified gen p mean: 0.44696736335754395, gen p mean: -0.22593097388744354, mean p set: 0.4475449025630951
loss_pred:0.01498893927782774, decouple_loss:0.001878405804745853loss_pred:0.01540295034646988, decouple_loss:0.0017764311050996184
Iteration: 3415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44662022590637207, gen p mean: -0.2309800684452057, mean p set: 0.44719311594963074
loss_pred:0.014642829075455666, decouple_loss:0.002152682514861226
The modified gen p mean: 0.4450746178627014, gen p mean: -0.22508957982063293, mean p set: 0.4456527829170227
loss_pred:0.0150753827765584, decouple_loss:0.0019829331431537867
The modified gen p mean: 0.4457532465457916, gen p mean: -0.22390900552272797, mean p set: 0.446274995803833
loss_pred:0.01517616119235754, decouple_loss:0.001958704087883234
Iteration: 3416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44646647572517395, gen p mean: -0.2308286428451538, mean p set: 0.4470418095588684The modified gen p mean: 0.4475274980068207, gen p mean: -0.23201274871826172, mean p set: 0.4481041729450226
loss_pred:0.014659903012216091, decouple_loss:0.001997939310967922
loss_pred:0.015446309931576252, decouple_loss:0.0021258671768009663
The modified gen p mean: 0.4466097056865692, gen p mean: -0.23240450024604797, mean p set: 0.44713932275772095
loss_pred:0.014763472601771355, decouple_loss:0.001980504486709833
Iteration: 3417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44581669569015503, gen p mean: -0.23236407339572906, mean p set: 0.44639402627944946
loss_pred:0.014851914718747139, decouple_loss:0.001955055631697178
The modified gen p mean: 0.4457888603210449, gen p mean: -0.23383988440036774, mean p set: 0.4463599622249603
loss_pred:0.014990544877946377, decouple_loss:0.0019298299448564649
The modified gen p mean: 0.44591790437698364, gen p mean: -0.23126967251300812, mean p set: 0.4464392364025116
loss_pred:0.015093711204826832, decouple_loss:0.0018589637475088239
Iteration: 3418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716551899909973, gen p mean: -0.23432381451129913, mean p set: 0.44773659110069275
loss_pred:0.01465791929513216, decouple_loss:0.002159910975024104
The modified gen p mean: 0.44573426246643066, gen p mean: -0.23243141174316406, mean p set: 0.44631072878837585
loss_pred:0.014648267067968845, decouple_loss:0.002094598487019539
The modified gen p mean: 0.44613805413246155, gen p mean: -0.2298194169998169, mean p set: 0.44666188955307007
loss_pred:0.015201196074485779, decouple_loss:0.0021181649062782526
Iteration: 3419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455585181713104, gen p mean: -0.2296929657459259, mean p set: 0.44613370299339294
loss_pred:0.014664635993540287, decouple_loss:0.0017451437888666987
The modified gen p mean: 0.44638216495513916, gen p mean: -0.233372300863266, mean p set: 0.44695594906806946
loss_pred:0.014336707070469856, decouple_loss:0.001757855643518269
The modified gen p mean: 0.4454292356967926, gen p mean: -0.23101454973220825, mean p set: 0.44595643877983093
loss_pred:0.014930972829461098, decouple_loss:0.0017194801475852728
Iteration: 3420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754737615585327, gen p mean: -0.22832687199115753, mean p set: 0.44812965393066406
loss_pred:0.015134128741919994, decouple_loss:0.001899626455269754
The modified gen p mean: 0.446426659822464, gen p mean: -0.22700490057468414, mean p set: 0.447003036737442
loss_pred:0.01506947260349989, decouple_loss:0.0017289519309997559
The modified gen p mean: 0.44636738300323486, gen p mean: -0.2283836305141449, mean p set: 0.4468989372253418
loss_pred:0.014823317527770996, decouple_loss:0.0018398409010842443
2023-04-27 16:06:04 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22923344373703003, mean p set: 0.4499112665653229
loss_pred:0.016038181260228157, decouple_loss:0.001988379517570138
The modified gen p mean: 0.4482237994670868, gen p mean: -0.22622527182102203, mean p set: 0.44879910349845886
loss_pred:0.01585138589143753, decouple_loss:0.0017516635125502944
The modified gen p mean: 0.4492965340614319, gen p mean: -0.22907552123069763, mean p set: 0.4498290419578552
loss_pred:0.015555364079773426, decouple_loss:0.0018676369218155742
WV_1_PC_1_EH_0_PS_30, loss: 0.015908438712358475, avg_mse: 0.023610185831785202
current test mse: 0.02361
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 3421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500165581703186, gen p mean: -0.2216438502073288, mean p set: 0.45054665207862854
loss_pred:0.014803179539740086, decouple_loss:0.002186729572713375
The modified gen p mean: 0.4494413435459137, gen p mean: -0.22243180871009827, mean p set: 0.4500153958797455
The modified gen p mean: 0.44939088821411133, gen p mean: -0.2240176498889923, mean p set: 0.44996556639671326
loss_pred:0.014195657335221767, decouple_loss:0.0021705159451812506
loss_pred:0.014838973991572857, decouple_loss:0.0022245775908231735
Iteration: 3422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449243426322937, gen p mean: -0.22581620514392853, mean p set: 0.44977647066116333
loss_pred:0.014663971029222012, decouple_loss:0.0018690694123506546
The modified gen p mean: 0.44859346747398376, gen p mean: -0.22385945916175842, mean p set: 0.4491713047027588
loss_pred:0.015260420739650726, decouple_loss:0.0020165196619927883
The modified gen p mean: 0.44883328676223755, gen p mean: -0.2252499759197235, mean p set: 0.44941237568855286
loss_pred:0.015083837322890759, decouple_loss:0.0018793577328324318
Iteration: 3423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44916340708732605, gen p mean: -0.22775572538375854, mean p set: 0.4496983587741852
loss_pred:0.015019668266177177, decouple_loss:0.002243518363684416
The modified gen p mean: 0.4479326009750366, gen p mean: -0.23312339186668396, mean p set: 0.44850850105285645
loss_pred:0.014306515455245972, decouple_loss:0.002207993995398283
The modified gen p mean: 0.44813817739486694, gen p mean: -0.22822780907154083, mean p set: 0.4487136900424957
loss_pred:0.0154024763032794, decouple_loss:0.002350021619349718
Iteration: 3424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448703795671463, gen p mean: -0.2305019348859787, mean p set: 0.449236124753952
loss_pred:0.01472051627933979, decouple_loss:0.0020917244255542755
The modified gen p mean: 0.44906455278396606, gen p mean: -0.22010843455791473, mean p set: 0.44964277744293213
loss_pred:0.014992499724030495, decouple_loss:0.0026454865001142025
The modified gen p mean: 0.44880789518356323, gen p mean: -0.22277110815048218, mean p set: 0.4493807256221771
loss_pred:0.014512380585074425, decouple_loss:0.002065233653411269
Iteration: 3425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497286379337311, gen p mean: -0.22709417343139648, mean p set: 0.4503089487552643
loss_pred:0.014202618040144444, decouple_loss:0.0020700201857835054
The modified gen p mean: 0.4495126008987427, gen p mean: -0.2277555763721466, mean p set: 0.45003435015678406The modified gen p mean: 0.4485270380973816, gen p mean: -0.22731173038482666, mean p set: 0.44910159707069397
loss_pred:0.014531736262142658, decouple_loss:0.001827243366278708
loss_pred:0.014666394330561161, decouple_loss:0.001959224697202444
Iteration: 3426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500120282173157, gen p mean: -0.23137320578098297, mean p set: 0.45059165358543396
loss_pred:0.014928847551345825, decouple_loss:0.0021440349519252777
The modified gen p mean: 0.4489414393901825, gen p mean: -0.22171437740325928, mean p set: 0.4495154023170471The modified gen p mean: 0.44957268238067627, gen p mean: -0.22620652616024017, mean p set: 0.4500974118709564
loss_pred:0.014248612336814404, decouple_loss:0.0021481069270521402
loss_pred:0.014405348338186741, decouple_loss:0.0021521674934774637
Iteration: 3427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973790645599365, gen p mean: -0.22070413827896118, mean p set: 0.450310081243515
loss_pred:0.014904791489243507, decouple_loss:0.002152053639292717
The modified gen p mean: 0.44926270842552185, gen p mean: -0.22478008270263672, mean p set: 0.4497894048690796The modified gen p mean: 0.4484378695487976, gen p mean: -0.21929778158664703, mean p set: 0.44901344180107117
loss_pred:0.014690380543470383, decouple_loss:0.0022423407062888145
loss_pred:0.014354363083839417, decouple_loss:0.0018270971486344934
Iteration: 3428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877398014068604, gen p mean: -0.22438572347164154, mean p set: 0.4493550956249237
loss_pred:0.014618122950196266, decouple_loss:0.0021583116613328457
The modified gen p mean: 0.4482434093952179, gen p mean: -0.220766082406044, mean p set: 0.4488248825073242
loss_pred:0.014849192462861538, decouple_loss:0.00225115567445755
The modified gen p mean: 0.4485790729522705, gen p mean: -0.2166944444179535, mean p set: 0.44910016655921936
loss_pred:0.01514738891273737, decouple_loss:0.0019532814621925354
Iteration: 3429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774001836776733, gen p mean: -0.22785133123397827, mean p set: 0.44832560420036316
loss_pred:0.014568093232810497, decouple_loss:0.0019249925389885902
The modified gen p mean: 0.4478292465209961, gen p mean: -0.21635636687278748, mean p set: 0.4484051764011383
loss_pred:0.01464588288217783, decouple_loss:0.00220726546831429
The modified gen p mean: 0.44847285747528076, gen p mean: -0.21624484658241272, mean p set: 0.4489958584308624
loss_pred:0.014785154722630978, decouple_loss:0.0021972658578306437
Iteration: 3430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771814346313477, gen p mean: -0.22833827137947083, mean p set: 0.44829061627388
loss_pred:0.014601419679820538, decouple_loss:0.0020665444899350405
The modified gen p mean: 0.4483984410762787, gen p mean: -0.2191484421491623, mean p set: 0.44897210597991943
loss_pred:0.014798933640122414, decouple_loss:0.0023135582450777292
The modified gen p mean: 0.44818755984306335, gen p mean: -0.22868984937667847, mean p set: 0.44871246814727783
loss_pred:0.015010031871497631, decouple_loss:0.002065537963062525
2023-04-27 16:10:10 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22953671216964722, mean p set: 0.4499112665653229
loss_pred:0.01608363352715969, decouple_loss:0.0023780539631843567
The modified gen p mean: 0.44930294156074524, gen p mean: -0.22982582449913025, mean p set: 0.4498290419578552
loss_pred:0.015788568183779716, decouple_loss:0.002226941054686904
The modified gen p mean: 0.44821783900260925, gen p mean: -0.22655148804187775, mean p set: 0.44879910349845886
loss_pred:0.016039879992604256, decouple_loss:0.0021200783085078
WV_1_PC_1_EH_0_PS_30, loss: 0.016082778573036194, avg_mse: 0.023928187787532806
current test mse: 0.023928
Iteration: 3431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493541121482849, gen p mean: -0.22588570415973663, mean p set: 0.4499303698539734
loss_pred:0.015175078995525837, decouple_loss:0.0020945763681083918
The modified gen p mean: 0.4499906599521637, gen p mean: -0.2234969139099121, mean p set: 0.450520396232605
loss_pred:0.014422428794205189, decouple_loss:0.002043775748461485
The modified gen p mean: 0.4494691789150238, gen p mean: -0.22363995015621185, mean p set: 0.45004376769065857
loss_pred:0.013649611733853817, decouple_loss:0.0019072601571679115
Iteration: 3432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939738512039185, gen p mean: -0.23092502355575562, mean p set: 0.4499305486679077
loss_pred:0.014223388396203518, decouple_loss:0.002010887023061514
The modified gen p mean: 0.4479163885116577, gen p mean: -0.23168662190437317, mean p set: 0.44848892092704773
The modified gen p mean: 0.44799405336380005, gen p mean: -0.22976720333099365, mean p set: 0.4485754370689392
loss_pred:0.014962764456868172, decouple_loss:0.0021859051194041967
loss_pred:0.015106352977454662, decouple_loss:0.0020614180248230696
Iteration: 3433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487387239933014, gen p mean: -0.22728769481182098, mean p set: 0.44927287101745605
loss_pred:0.01478897500783205, decouple_loss:0.0021787688601762056
The modified gen p mean: 0.44777917861938477, gen p mean: -0.2329092025756836, mean p set: 0.4483579099178314
The modified gen p mean: 0.44843703508377075, gen p mean: -0.23265089094638824, mean p set: 0.4490082263946533
loss_pred:0.013858040794730186, decouple_loss:0.002037371974438429
loss_pred:0.014268253929913044, decouple_loss:0.0021758500952273607
Iteration: 3434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489516615867615, gen p mean: -0.23205849528312683, mean p set: 0.4494836926460266
loss_pred:0.014626892283558846, decouple_loss:0.0020302997436374426
The modified gen p mean: 0.44786879420280457, gen p mean: -0.23578354716300964, mean p set: 0.4484458863735199
The modified gen p mean: 0.4509687125682831, gen p mean: -0.22380290925502777, mean p set: 0.4515393376350403
loss_pred:0.014699278399348259, decouple_loss:0.002027269219979644
loss_pred:0.014611304737627506, decouple_loss:0.002100106095895171
Iteration: 3435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491479694843292, gen p mean: -0.22686292231082916, mean p set: 0.44971972703933716
loss_pred:0.014513762667775154, decouple_loss:0.002126983366906643
The modified gen p mean: 0.44781389832496643, gen p mean: -0.23139047622680664, mean p set: 0.44834738969802856The modified gen p mean: 0.44829344749450684, gen p mean: -0.22505004703998566, mean p set: 0.4488753378391266
loss_pred:0.014358564279973507, decouple_loss:0.0020012781023979187
loss_pred:0.0148248840123415, decouple_loss:0.0022259079851210117
Iteration: 3436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746947288513184, gen p mean: -0.2377505749464035, mean p set: 0.4480412006378174
loss_pred:0.01481692399829626, decouple_loss:0.0020043542608618736
The modified gen p mean: 0.4478928744792938, gen p mean: -0.23371747136116028, mean p set: 0.44842392206192017The modified gen p mean: 0.4489133954048157, gen p mean: -0.22686433792114258, mean p set: 0.4494929015636444
loss_pred:0.014709047973155975, decouple_loss:0.0019201334798708558
loss_pred:0.01443472970277071, decouple_loss:0.0020409836433827877
Iteration: 3437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449006050825119, gen p mean: -0.22899921238422394, mean p set: 0.4495806396007538
loss_pred:0.01405047532171011, decouple_loss:0.002487230347469449
The modified gen p mean: 0.4490216374397278, gen p mean: -0.22917820513248444, mean p set: 0.4495515525341034The modified gen p mean: 0.4491904079914093, gen p mean: -0.22599440813064575, mean p set: 0.4497624933719635
loss_pred:0.014668080024421215, decouple_loss:0.0020394620951265097
loss_pred:0.014739518985152245, decouple_loss:0.002350058639422059
Iteration: 3438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059657096862793, gen p mean: -0.2185903787612915, mean p set: 0.451172411441803
loss_pred:0.014649929478764534, decouple_loss:0.0019050933187827468
The modified gen p mean: 0.4492820203304291, gen p mean: -0.22122295200824738, mean p set: 0.44986000657081604
loss_pred:0.014456210657954216, decouple_loss:0.0018406097078695893
The modified gen p mean: 0.4482231140136719, gen p mean: -0.22934770584106445, mean p set: 0.4487546384334564
loss_pred:0.014820167794823647, decouple_loss:0.0020712732803076506
Iteration: 3439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891035556793213, gen p mean: -0.21982552111148834, mean p set: 0.4494885504245758
loss_pred:0.01533733494579792, decouple_loss:0.002028221031650901
The modified gen p mean: 0.4486948251724243, gen p mean: -0.21966956555843353, mean p set: 0.4492739737033844
loss_pred:0.014937522821128368, decouple_loss:0.0020851027220487595
The modified gen p mean: 0.4498715102672577, gen p mean: -0.22430448234081268, mean p set: 0.4504038989543915
loss_pred:0.01438702642917633, decouple_loss:0.002019882434979081
Iteration: 3440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934120774269104, gen p mean: -0.22411832213401794, mean p set: 0.44991445541381836
loss_pred:0.014652338810265064, decouple_loss:0.001818383694626391
The modified gen p mean: 0.4487619698047638, gen p mean: -0.22006946802139282, mean p set: 0.44933852553367615
loss_pred:0.014492266811430454, decouple_loss:0.001930362661369145
The modified gen p mean: 0.4484708309173584, gen p mean: -0.21771758794784546, mean p set: 0.44899484515190125
loss_pred:0.015427403151988983, decouple_loss:0.001976584317162633
2023-04-27 16:13:35 testing...
The modified gen p mean: 0.44822776317596436, gen p mean: -0.21571142971515656, mean p set: 0.44879910349845886
loss_pred:0.01596858724951744, decouple_loss:0.002042189473286271
The modified gen p mean: 0.4494309425354004, gen p mean: -0.21878235042095184, mean p set: 0.4499112665653229
loss_pred:0.01603427343070507, decouple_loss:0.0021312159951776266
The modified gen p mean: 0.44930100440979004, gen p mean: -0.2188667207956314, mean p set: 0.4498290419578552
loss_pred:0.015613900497555733, decouple_loss:0.00212475354783237
WV_1_PC_1_EH_0_PS_30, loss: 0.015977222472429276, avg_mse: 0.0237481277436018
current test mse: 0.023748
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 3441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488392770290375, gen p mean: -0.21612612903118134, mean p set: 0.44937047362327576
loss_pred:0.014742465689778328, decouple_loss:0.001949596800841391
The modified gen p mean: 0.447807639837265, gen p mean: -0.21802197396755219, mean p set: 0.44837847352027893
loss_pred:0.014337563887238503, decouple_loss:0.0017172192456200719
The modified gen p mean: 0.44768989086151123, gen p mean: -0.214539036154747, mean p set: 0.4482652246952057
loss_pred:0.01428112480789423, decouple_loss:0.0018836322706192732
Iteration: 3442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714123010635376, gen p mean: -0.22052255272865295, mean p set: 0.4476650059223175
loss_pred:0.01467504259198904, decouple_loss:0.0021545381750911474
The modified gen p mean: 0.4485763609409332, gen p mean: -0.2167474329471588, mean p set: 0.4491502642631531
loss_pred:0.014718426391482353, decouple_loss:0.0019345434848219156
The modified gen p mean: 0.44719597697257996, gen p mean: -0.22075745463371277, mean p set: 0.4477669298648834
loss_pred:0.014673817902803421, decouple_loss:0.0020386409014463425
Iteration: 3443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476577043533325, gen p mean: -0.21804243326187134, mean p set: 0.4481835961341858
loss_pred:0.01444203034043312, decouple_loss:0.001968492055311799
The modified gen p mean: 0.4471069574356079, gen p mean: -0.22359679639339447, mean p set: 0.4476828873157501
loss_pred:0.014071866869926453, decouple_loss:0.0017716680886223912
The modified gen p mean: 0.44743242859840393, gen p mean: -0.22018425166606903, mean p set: 0.44800058007240295
loss_pred:0.013881227001547813, decouple_loss:0.0017910442547872663
Iteration: 3444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777536392211914, gen p mean: -0.22687718272209167, mean p set: 0.4483039677143097
loss_pred:0.013880179263651371, decouple_loss:0.0018172585405409336
The modified gen p mean: 0.4480445384979248, gen p mean: -0.22554388642311096, mean p set: 0.44862261414527893
loss_pred:0.013917754404246807, decouple_loss:0.0018673855811357498
The modified gen p mean: 0.44753214716911316, gen p mean: -0.22612719237804413, mean p set: 0.4481063485145569
loss_pred:0.014816337265074253, decouple_loss:0.0021013610530644655
Iteration: 3445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686225056648254, gen p mean: -0.23313631117343903, mean p set: 0.4474402070045471
loss_pred:0.014648324809968472, decouple_loss:0.002052091993391514
The modified gen p mean: 0.4485940635204315, gen p mean: -0.22591224312782288, mean p set: 0.44917070865631104
loss_pred:0.014508228749036789, decouple_loss:0.0020776232704520226
The modified gen p mean: 0.44623544812202454, gen p mean: -0.22883224487304688, mean p set: 0.44676437973976135
loss_pred:0.014182178303599358, decouple_loss:0.001828242326155305
Iteration: 3446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480728209018707, gen p mean: -0.23096175491809845, mean p set: 0.4486541748046875
loss_pred:0.014500966295599937, decouple_loss:0.002043041167780757
The modified gen p mean: 0.4458804726600647, gen p mean: -0.23338595032691956, mean p set: 0.44645851850509644The modified gen p mean: 0.4475598633289337, gen p mean: -0.2289683073759079, mean p set: 0.4480895698070526
loss_pred:0.01405255775898695, decouple_loss:0.0018338883528485894
loss_pred:0.014139097183942795, decouple_loss:0.0019017652375623584
Iteration: 3447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478043019771576, gen p mean: -0.22907955944538116, mean p set: 0.4483788311481476
loss_pred:0.014636833220720291, decouple_loss:0.0019328745547682047
The modified gen p mean: 0.4467543363571167, gen p mean: -0.23253768682479858, mean p set: 0.4473342299461365The modified gen p mean: 0.4468918442726135, gen p mean: -0.23240579664707184, mean p set: 0.4474206268787384
loss_pred:0.01439727284014225, decouple_loss:0.0018120507011190057
loss_pred:0.014365298673510551, decouple_loss:0.00221043243072927
Iteration: 3448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467800259590149, gen p mean: -0.227125346660614, mean p set: 0.4473542869091034
loss_pred:0.01412029005587101, decouple_loss:0.0018896241672337055
The modified gen p mean: 0.447603315114975, gen p mean: -0.2335660755634308, mean p set: 0.44817450642585754The modified gen p mean: 0.4479832053184509, gen p mean: -0.23155231773853302, mean p set: 0.44852009415626526
loss_pred:0.014533579349517822, decouple_loss:0.0018090541707351804
loss_pred:0.014006241224706173, decouple_loss:0.002192598069086671
Iteration: 3449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471370577812195, gen p mean: -0.22868558764457703, mean p set: 0.4477144777774811
loss_pred:0.014151165261864662, decouple_loss:0.0019299359992146492
The modified gen p mean: 0.44760724902153015, gen p mean: -0.22663982212543488, mean p set: 0.4481825828552246
loss_pred:0.013841546140611172, decouple_loss:0.001902251155115664
The modified gen p mean: 0.44738900661468506, gen p mean: -0.22780582308769226, mean p set: 0.44791606068611145
loss_pred:0.014667273499071598, decouple_loss:0.0019322955049574375
Iteration: 3450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483998417854309, gen p mean: -0.23034043610095978, mean p set: 0.44897761940956116
loss_pred:0.014373748563230038, decouple_loss:0.002069748705253005
The modified gen p mean: 0.44734254479408264, gen p mean: -0.2308550626039505, mean p set: 0.4479212760925293
loss_pred:0.01433723233640194, decouple_loss:0.00212679011747241
The modified gen p mean: 0.44766685366630554, gen p mean: -0.2262813001871109, mean p set: 0.4481982886791229
loss_pred:0.014477552846074104, decouple_loss:0.001946481061168015
2023-04-27 16:17:41 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22948697209358215, mean p set: 0.4499112665653229
loss_pred:0.016421381384134293, decouple_loss:0.00215815007686615
The modified gen p mean: 0.4492969512939453, gen p mean: -0.22999905049800873, mean p set: 0.4498290419578552
loss_pred:0.016047755256295204, decouple_loss:0.002100413665175438
The modified gen p mean: 0.4482223689556122, gen p mean: -0.22673562169075012, mean p set: 0.44879910349845886
loss_pred:0.01630719192326069, decouple_loss:0.0021153728011995554
WV_1_PC_1_EH_0_PS_30, loss: 0.016365010291337967, avg_mse: 0.024426493793725967
current test mse: 0.024426
Iteration: 3451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469269812107086, gen p mean: -0.23255258798599243, mean p set: 0.4475003480911255
loss_pred:0.014426611363887787, decouple_loss:0.0019195176428183913
The modified gen p mean: 0.4486038088798523, gen p mean: -0.22559264302253723, mean p set: 0.44913291931152344
loss_pred:0.014858510345220566, decouple_loss:0.0025658882223069668
The modified gen p mean: 0.44645100831985474, gen p mean: -0.23284196853637695, mean p set: 0.4470282196998596
loss_pred:0.014285228215157986, decouple_loss:0.001874767942354083
Iteration: 3452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467467963695526, gen p mean: -0.2289484292268753, mean p set: 0.44727250933647156
loss_pred:0.014360574074089527, decouple_loss:0.00209217332303524
The modified gen p mean: 0.4486686587333679, gen p mean: -0.22561904788017273, mean p set: 0.44924822449684143
The modified gen p mean: 0.44737404584884644, gen p mean: -0.2310415357351303, mean p set: 0.4479547441005707
loss_pred:0.014096607454121113, decouple_loss:0.0022247103042900562
loss_pred:0.013972558081150055, decouple_loss:0.002219375455752015
Iteration: 3453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477700889110565, gen p mean: -0.23400090634822845, mean p set: 0.4483005702495575
loss_pred:0.015018753707408905, decouple_loss:0.0019394950941205025
The modified gen p mean: 0.4480259418487549, gen p mean: -0.23410195112228394, mean p set: 0.44860121607780457
The modified gen p mean: 0.44668376445770264, gen p mean: -0.23163877427577972, mean p set: 0.4472596049308777
loss_pred:0.013782643713057041, decouple_loss:0.0020083042327314615
loss_pred:0.014574524946510792, decouple_loss:0.0018541441531851888
Iteration: 3454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476817548274994, gen p mean: -0.23161664605140686, mean p set: 0.4482133686542511
loss_pred:0.014414189383387566, decouple_loss:0.002107823034748435
The modified gen p mean: 0.44802549481391907, gen p mean: -0.22737038135528564, mean p set: 0.44860079884529114
The modified gen p mean: 0.4474521279335022, gen p mean: -0.2295106202363968, mean p set: 0.4480327069759369
loss_pred:0.014373165555298328, decouple_loss:0.002508018398657441
loss_pred:0.013962128199636936, decouple_loss:0.002239061053842306
Iteration: 3455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473332166671753, gen p mean: -0.23186378180980682, mean p set: 0.4479072690010071
loss_pred:0.014449200592935085, decouple_loss:0.002045582514256239
The modified gen p mean: 0.44764161109924316, gen p mean: -0.23334051668643951, mean p set: 0.44821637868881226The modified gen p mean: 0.44840967655181885, gen p mean: -0.23587922751903534, mean p set: 0.448940247297287
loss_pred:0.014515304937958717, decouple_loss:0.0020400569774210453
loss_pred:0.01432866882532835, decouple_loss:0.0021628448739647865
Iteration: 3456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694289565086365, gen p mean: -0.23524583876132965, mean p set: 0.4475173056125641
loss_pred:0.014521472156047821, decouple_loss:0.0025042728520929813
The modified gen p mean: 0.4472759962081909, gen p mean: -0.23633268475532532, mean p set: 0.44780340790748596The modified gen p mean: 0.4478115141391754, gen p mean: -0.2363235503435135, mean p set: 0.44838836789131165
loss_pred:0.01393821556121111, decouple_loss:0.002782172989100218
loss_pred:0.014651711098849773, decouple_loss:0.0025798133574426174
Iteration: 3457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473225474357605, gen p mean: -0.22963044047355652, mean p set: 0.44789940118789673
loss_pred:0.014776438474655151, decouple_loss:0.0021747469436377287
The modified gen p mean: 0.4474465847015381, gen p mean: -0.23080261051654816, mean p set: 0.4479711353778839The modified gen p mean: 0.4463813900947571, gen p mean: -0.2306605726480484, mean p set: 0.44695839285850525
loss_pred:0.014212348498404026, decouple_loss:0.00202138046734035
loss_pred:0.014479209668934345, decouple_loss:0.0021143141202628613
Iteration: 3458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828736782073975, gen p mean: -0.22706419229507446, mean p set: 0.44886934757232666
loss_pred:0.013964211568236351, decouple_loss:0.0023926387075334787
The modified gen p mean: 0.4468133747577667, gen p mean: -0.23128969967365265, mean p set: 0.4473881721496582
loss_pred:0.014343472197651863, decouple_loss:0.0021143548656255007
The modified gen p mean: 0.44558224081993103, gen p mean: -0.22686636447906494, mean p set: 0.4461096227169037
loss_pred:0.014187412336468697, decouple_loss:0.002225359668955207
Iteration: 3459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472027122974396, gen p mean: -0.23293453454971313, mean p set: 0.44778600335121155
loss_pred:0.014345545321702957, decouple_loss:0.0020053167827427387
The modified gen p mean: 0.4485493004322052, gen p mean: -0.222702756524086, mean p set: 0.4491216838359833
loss_pred:0.01411671843379736, decouple_loss:0.0022905124351382256
The modified gen p mean: 0.44723278284072876, gen p mean: -0.2318214625120163, mean p set: 0.4477671980857849
loss_pred:0.014410878531634808, decouple_loss:0.002039537997916341
Iteration: 3460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475540816783905, gen p mean: -0.23284392058849335, mean p set: 0.44813501834869385
loss_pred:0.014618483372032642, decouple_loss:0.001935935695655644
The modified gen p mean: 0.4463387429714203, gen p mean: -0.23154838383197784, mean p set: 0.4468632936477661The modified gen p mean: 0.44791463017463684, gen p mean: -0.2236834466457367, mean p set: 0.4484962224960327
loss_pred:0.014345887117087841, decouple_loss:0.002063860883936286
loss_pred:0.014234174974262714, decouple_loss:0.002152519067749381
2023-04-27 16:21:06 testing...
The modified gen p mean: 0.44821810722351074, gen p mean: -0.2256729155778885, mean p set: 0.44879910349845886
loss_pred:0.01609647274017334, decouple_loss:0.001975115155801177
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22887581586837769, mean p set: 0.4499112665653229
loss_pred:0.01620050147175789, decouple_loss:0.002038085600361228
The modified gen p mean: 0.44929325580596924, gen p mean: -0.22877122461795807, mean p set: 0.4498290419578552
loss_pred:0.015813738107681274, decouple_loss:0.0021063063759356737
WV_1_PC_1_EH_0_PS_30, loss: 0.016138896346092224, avg_mse: 0.023995066061615944
current test mse: 0.023995
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 3461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475820064544678, gen p mean: -0.23039354383945465, mean p set: 0.4481089115142822
loss_pred:0.015498347580432892, decouple_loss:0.002334068063646555
The modified gen p mean: 0.44789600372314453, gen p mean: -0.22758008539676666, mean p set: 0.448472261428833
loss_pred:0.014514163136482239, decouple_loss:0.0021460731513798237
The modified gen p mean: 0.4484442472457886, gen p mean: -0.23238836228847504, mean p set: 0.4490198791027069
loss_pred:0.014862477779388428, decouple_loss:0.0019842672627419233
Iteration: 3462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44583478569984436, gen p mean: -0.22530780732631683, mean p set: 0.44636374711990356
loss_pred:0.014827895909547806, decouple_loss:0.002203607000410557
The modified gen p mean: 0.4467898905277252, gen p mean: -0.22820961475372314, mean p set: 0.447368323802948
loss_pred:0.014793913811445236, decouple_loss:0.0020247171632945538
The modified gen p mean: 0.4473320543766022, gen p mean: -0.2321934700012207, mean p set: 0.4479025602340698
loss_pred:0.014359500259160995, decouple_loss:0.002019197680056095
Iteration: 3463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460873305797577, gen p mean: -0.22864855825901031, mean p set: 0.4466237425804138
loss_pred:0.014673077501356602, decouple_loss:0.0019919152837246656
The modified gen p mean: 0.44790616631507874, gen p mean: -0.22507844865322113, mean p set: 0.4484834671020508
loss_pred:0.014448482543230057, decouple_loss:0.0019550060387700796
The modified gen p mean: 0.4474426507949829, gen p mean: -0.22860023379325867, mean p set: 0.4480155408382416
loss_pred:0.01597847230732441, decouple_loss:0.00198025768622756
Iteration: 3464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790709018707275, gen p mean: -0.2271103709936142, mean p set: 0.44843170046806335
The modified gen p mean: 0.4465568959712982, gen p mean: -0.22819149494171143, mean p set: 0.4471263289451599
loss_pred:0.013907772488892078, decouple_loss:0.0018174618016928434loss_pred:0.0143041480332613, decouple_loss:0.0017881134990602732
The modified gen p mean: 0.44774261116981506, gen p mean: -0.23040081560611725, mean p set: 0.44832107424736023
loss_pred:0.015421761199831963, decouple_loss:0.002225598320364952
Iteration: 3465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491512179374695, gen p mean: -0.22847190499305725, mean p set: 0.4497232735157013
loss_pred:0.014176059514284134, decouple_loss:0.0020758183673024178
The modified gen p mean: 0.44703179597854614, gen p mean: -0.22756391763687134, mean p set: 0.4476125240325928The modified gen p mean: 0.4479876756668091, gen p mean: -0.2259649634361267, mean p set: 0.4485156238079071
loss_pred:0.014566629193723202, decouple_loss:0.002064188476651907
loss_pred:0.013952210545539856, decouple_loss:0.0021107769571244717
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484279155731201, gen p mean: -0.2291904091835022, mean p set: 0.44900330901145935
loss_pred:0.01414171140640974, decouple_loss:0.0018440516432747245
The modified gen p mean: 0.44816720485687256, gen p mean: -0.22650845348834991, mean p set: 0.44869574904441833The modified gen p mean: 0.4481491446495056, gen p mean: -0.23135769367218018, mean p set: 0.4487214982509613
loss_pred:0.014894607476890087, decouple_loss:0.0018460493301972747
loss_pred:0.014597768895328045, decouple_loss:0.002077639102935791
Iteration: 3467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471529424190521, gen p mean: -0.22822363674640656, mean p set: 0.4477330446243286
loss_pred:0.014525487087666988, decouple_loss:0.0019429101375862956
The modified gen p mean: 0.44814762473106384, gen p mean: -0.22855806350708008, mean p set: 0.44871997833251953
loss_pred:0.014148905873298645, decouple_loss:0.0020352927967906
The modified gen p mean: 0.4475439190864563, gen p mean: -0.23633848130702972, mean p set: 0.4480707347393036
loss_pred:0.015319619327783585, decouple_loss:0.002129601314663887
Iteration: 3468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683027267456055, gen p mean: -0.23077966272830963, mean p set: 0.4473958909511566
loss_pred:0.01450465340167284, decouple_loss:0.0020071398466825485
The modified gen p mean: 0.447677880525589, gen p mean: -0.23238442838191986, mean p set: 0.4482479691505432
loss_pred:0.014651872217655182, decouple_loss:0.002071105409413576
The modified gen p mean: 0.4489933252334595, gen p mean: -0.2306274026632309, mean p set: 0.44952166080474854
loss_pred:0.014273416250944138, decouple_loss:0.0018968137446790934
Iteration: 3469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480331242084503, gen p mean: -0.22570344805717468, mean p set: 0.44860541820526123
loss_pred:0.014694628305733204, decouple_loss:0.0018887839978560805
The modified gen p mean: 0.4479922950267792, gen p mean: -0.2287646234035492, mean p set: 0.4485693573951721
loss_pred:0.014018739573657513, decouple_loss:0.0020243721082806587
The modified gen p mean: 0.4480237066745758, gen p mean: -0.22871388494968414, mean p set: 0.4485537111759186
loss_pred:0.015481487847864628, decouple_loss:0.0019397531868889928
Iteration: 3470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482645094394684, gen p mean: -0.2271699458360672, mean p set: 0.4488431215286255
loss_pred:0.014098689891397953, decouple_loss:0.0019635658245533705
The modified gen p mean: 0.4481217861175537, gen p mean: -0.22345109283924103, mean p set: 0.4486992359161377
loss_pred:0.014927932992577553, decouple_loss:0.0018799689132720232
The modified gen p mean: 0.44876453280448914, gen p mean: -0.2266497015953064, mean p set: 0.44929543137550354
loss_pred:0.014382714405655861, decouple_loss:0.002057697856798768
2023-04-27 16:25:22 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23064297437667847, mean p set: 0.4499112665653229
loss_pred:0.0160142220556736, decouple_loss:0.0022499579936265945
The modified gen p mean: 0.44930192828178406, gen p mean: -0.23058617115020752, mean p set: 0.4498290419578552
loss_pred:0.015586555004119873, decouple_loss:0.002440839307382703
The modified gen p mean: 0.44822511076927185, gen p mean: -0.22785046696662903, mean p set: 0.44879910349845886
loss_pred:0.015911702066659927, decouple_loss:0.0023883297108113766
WV_1_PC_1_EH_0_PS_30, loss: 0.015955477952957153, avg_mse: 0.023656466975808144
current test mse: 0.023656
Iteration: 3471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465353786945343, gen p mean: -0.2295762300491333, mean p set: 0.447110116481781
loss_pred:0.015219415538012981, decouple_loss:0.002217812230810523
The modified gen p mean: 0.446978896856308, gen p mean: -0.23384812474250793, mean p set: 0.44750893115997314
loss_pred:0.01416991837322712, decouple_loss:0.002324894070625305
The modified gen p mean: 0.44691187143325806, gen p mean: -0.23424896597862244, mean p set: 0.4474853575229645
loss_pred:0.014029127545654774, decouple_loss:0.002535303123295307
Iteration: 3472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702643156051636, gen p mean: -0.23230168223381042, mean p set: 0.44755110144615173
loss_pred:0.014723517000675201, decouple_loss:0.0018542975885793567
The modified gen p mean: 0.4482322037220001, gen p mean: -0.232576385140419, mean p set: 0.4488097131252289
The modified gen p mean: 0.44882380962371826, gen p mean: -0.2332186996936798, mean p set: 0.44939976930618286
loss_pred:0.014534728601574898, decouple_loss:0.0019003035267814994
loss_pred:0.014493956230580807, decouple_loss:0.0020671552047133446
Iteration: 3473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949236512184143, gen p mean: -0.23337972164154053, mean p set: 0.4500364065170288
loss_pred:0.014134732075035572, decouple_loss:0.0019447352970018983
The modified gen p mean: 0.447313517332077, gen p mean: -0.23504877090454102, mean p set: 0.4478845000267029
The modified gen p mean: 0.44758233428001404, gen p mean: -0.23122312128543854, mean p set: 0.4481564164161682
loss_pred:0.013938609510660172, decouple_loss:0.0020455787889659405
loss_pred:0.01423705369234085, decouple_loss:0.0021849300246685743
Iteration: 3474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767242670059204, gen p mean: -0.23457370698451996, mean p set: 0.44819900393486023
loss_pred:0.014342001639306545, decouple_loss:0.0020354636944830418
The modified gen p mean: 0.4490985870361328, gen p mean: -0.23706495761871338, mean p set: 0.449665904045105
The modified gen p mean: 0.44935116171836853, gen p mean: -0.23507387936115265, mean p set: 0.4499242305755615
loss_pred:0.013772416859865189, decouple_loss:0.001995229860767722
loss_pred:0.014272365719079971, decouple_loss:0.002109792549163103
Iteration: 3475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447746604681015, gen p mean: -0.23756363987922668, mean p set: 0.4483180344104767
loss_pred:0.015076822601258755, decouple_loss:0.0019499039044603705
The modified gen p mean: 0.44999557733535767, gen p mean: -0.23180942237377167, mean p set: 0.4505683481693268The modified gen p mean: 0.44965335726737976, gen p mean: -0.2339124232530594, mean p set: 0.45018208026885986
loss_pred:0.013860229402780533, decouple_loss:0.0020163615699857473
loss_pred:0.01333742868155241, decouple_loss:0.001975865103304386
Iteration: 3476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815167784690857, gen p mean: -0.23034727573394775, mean p set: 0.4487282633781433
loss_pred:0.01445893943309784, decouple_loss:0.0019260892877355218
The modified gen p mean: 0.4482961595058441, gen p mean: -0.22674772143363953, mean p set: 0.4488748610019684The modified gen p mean: 0.44677749276161194, gen p mean: -0.2329287976026535, mean p set: 0.447309285402298
loss_pred:0.015028473921120167, decouple_loss:0.0022496178280562162
loss_pred:0.013916279189288616, decouple_loss:0.0020070294849574566
Iteration: 3477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476891756057739, gen p mean: -0.2302817851305008, mean p set: 0.4482649564743042
loss_pred:0.014420523308217525, decouple_loss:0.0022234702482819557
The modified gen p mean: 0.44673141837120056, gen p mean: -0.2274681031703949, mean p set: 0.44726231694221497The modified gen p mean: 0.44608384370803833, gen p mean: -0.22772623598575592, mean p set: 0.44665804505348206
loss_pred:0.014173727482557297, decouple_loss:0.0020307779777795076
loss_pred:0.015293648466467857, decouple_loss:0.0020038574002683163
Iteration: 3478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706588983535767, gen p mean: -0.23666316270828247, mean p set: 0.4476448595523834
loss_pred:0.014586552046239376, decouple_loss:0.001906636287458241
The modified gen p mean: 0.4474814534187317, gen p mean: -0.2401174157857895, mean p set: 0.4480571746826172
loss_pred:0.01449920330196619, decouple_loss:0.0018091636011376977
The modified gen p mean: 0.44636455178260803, gen p mean: -0.2375560998916626, mean p set: 0.4468948543071747
loss_pred:0.014136338606476784, decouple_loss:0.001920024980790913
Iteration: 3479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846978783607483, gen p mean: -0.2413633018732071, mean p set: 0.44904476404190063
loss_pred:0.014556854031980038, decouple_loss:0.0020807445980608463
The modified gen p mean: 0.4483351409435272, gen p mean: -0.23635035753250122, mean p set: 0.4489106833934784
loss_pred:0.014648860320448875, decouple_loss:0.0022579191718250513
The modified gen p mean: 0.44788652658462524, gen p mean: -0.23618252575397491, mean p set: 0.44841471314430237
loss_pred:0.01472092978656292, decouple_loss:0.0019681418780237436
Iteration: 3480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760775566101074, gen p mean: -0.23365560173988342, mean p set: 0.4481905400753021
loss_pred:0.014403918758034706, decouple_loss:0.0019191658357158303
The modified gen p mean: 0.4470076560974121, gen p mean: -0.24105456471443176, mean p set: 0.4475356340408325The modified gen p mean: 0.4467562437057495, gen p mean: -0.23959000408649445, mean p set: 0.4473358392715454
loss_pred:0.014119613915681839, decouple_loss:0.0018888378981500864
loss_pred:0.014130732975900173, decouple_loss:0.001871391898021102
2023-04-27 16:28:47 testing...
The modified gen p mean: 0.44822484254837036, gen p mean: -0.2315455675125122, mean p set: 0.44879910349845886
loss_pred:0.01592269167304039, decouple_loss:0.0018922697054222226
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2346925288438797, mean p set: 0.4499112665653229
loss_pred:0.016055740416049957, decouple_loss:0.0018482927698642015
The modified gen p mean: 0.4493057429790497, gen p mean: -0.2342667430639267, mean p set: 0.4498290419578552
loss_pred:0.015659037977457047, decouple_loss:0.0020159075502306223
WV_1_PC_1_EH_0_PS_30, loss: 0.015975099056959152, avg_mse: 0.02371669001877308
current test mse: 0.023717
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 3481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480838179588318, gen p mean: -0.23261988162994385, mean p set: 0.44861549139022827
loss_pred:0.014941111207008362, decouple_loss:0.0018145308131352067
The modified gen p mean: 0.4457573890686035, gen p mean: -0.23404450714588165, mean p set: 0.4463306665420532
loss_pred:0.015069400891661644, decouple_loss:0.0018137417500838637
The modified gen p mean: 0.44736137986183167, gen p mean: -0.23580172657966614, mean p set: 0.44793781638145447
loss_pred:0.015292469412088394, decouple_loss:0.0021167569793760777
Iteration: 3482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469137191772461, gen p mean: -0.2279045730829239, mean p set: 0.44744551181793213
loss_pred:0.01455025002360344, decouple_loss:0.0020082592964172363
The modified gen p mean: 0.4471224546432495, gen p mean: -0.23675848543643951, mean p set: 0.44769522547721863
loss_pred:0.014923120848834515, decouple_loss:0.0020392623264342546
The modified gen p mean: 0.44620007276535034, gen p mean: -0.23276662826538086, mean p set: 0.4467789828777313
loss_pred:0.01472475379705429, decouple_loss:0.002037162659689784
Iteration: 3483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717496633529663, gen p mean: -0.23194429278373718, mean p set: 0.4477007985115051
loss_pred:0.01468107383698225, decouple_loss:0.0022221729159355164
The modified gen p mean: 0.44776639342308044, gen p mean: -0.23324333131313324, mean p set: 0.4483422338962555
loss_pred:0.014567217789590359, decouple_loss:0.002029684605076909
The modified gen p mean: 0.4461763799190521, gen p mean: -0.23223596811294556, mean p set: 0.446748286485672
loss_pred:0.015142605639994144, decouple_loss:0.0019485732773318887
Iteration: 3484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722798466682434, gen p mean: -0.2319217324256897, mean p set: 0.44775307178497314
loss_pred:0.01366117037832737, decouple_loss:0.001899866620078683
The modified gen p mean: 0.44623011350631714, gen p mean: -0.2298731803894043, mean p set: 0.44680383801460266
loss_pred:0.014763039536774158, decouple_loss:0.0018388578901067376
The modified gen p mean: 0.446877121925354, gen p mean: -0.2314913421869278, mean p set: 0.4474574029445648
loss_pred:0.014568555168807507, decouple_loss:0.0018883974989876151
Iteration: 3485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473567008972168, gen p mean: -0.234561026096344, mean p set: 0.4479331374168396
loss_pred:0.014659756794571877, decouple_loss:0.00187333591748029
The modified gen p mean: 0.44570669531822205, gen p mean: -0.23176999390125275, mean p set: 0.4462839961051941
The modified gen p mean: 0.44640159606933594, gen p mean: -0.23011012375354767, mean p set: 0.4469318985939026
loss_pred:0.014587602578103542, decouple_loss:0.001969399396330118
loss_pred:0.014832360669970512, decouple_loss:0.0017139186384156346
Iteration: 3486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703617691993713, gen p mean: -0.2325935661792755, mean p set: 0.4476129114627838
loss_pred:0.015158726833760738, decouple_loss:0.002051103161647916
The modified gen p mean: 0.44660142064094543, gen p mean: -0.2333262711763382, mean p set: 0.44717955589294434The modified gen p mean: 0.4466859698295593, gen p mean: -0.2287498563528061, mean p set: 0.44721704721450806
loss_pred:0.014446834102272987, decouple_loss:0.001963578164577484
loss_pred:0.014158225618302822, decouple_loss:0.0019194368505850434
Iteration: 3487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477793574333191, gen p mean: -0.23350930213928223, mean p set: 0.4483581483364105
loss_pred:0.01392065454274416, decouple_loss:0.0018737228820100427
The modified gen p mean: 0.4483015835285187, gen p mean: -0.23529362678527832, mean p set: 0.448881059885025
loss_pred:0.014433862641453743, decouple_loss:0.0018411623314023018
The modified gen p mean: 0.4466325044631958, gen p mean: -0.2352781891822815, mean p set: 0.44716206192970276
loss_pred:0.014967926777899265, decouple_loss:0.001955978339537978
Iteration: 3488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468374252319336, gen p mean: -0.233475461602211, mean p set: 0.44741740822792053
loss_pred:0.015311256982386112, decouple_loss:0.0017469794256612659
The modified gen p mean: 0.4465869069099426, gen p mean: -0.23445940017700195, mean p set: 0.44716131687164307
loss_pred:0.01489394623786211, decouple_loss:0.0017548640025779605
The modified gen p mean: 0.446061909198761, gen p mean: -0.2382330298423767, mean p set: 0.4465861916542053
loss_pred:0.014437231235206127, decouple_loss:0.001835934934206307
Iteration: 3489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713637232780457, gen p mean: -0.23640410602092743, mean p set: 0.44771286845207214
loss_pred:0.014217416755855083, decouple_loss:0.0018074081744998693
The modified gen p mean: 0.44588005542755127, gen p mean: -0.24107147753238678, mean p set: 0.446456640958786
loss_pred:0.014512738212943077, decouple_loss:0.0017737910384312272
The modified gen p mean: 0.4475569427013397, gen p mean: -0.2397606521844864, mean p set: 0.44808200001716614
loss_pred:0.013553964905440807, decouple_loss:0.0019257490057498217
Iteration: 3490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639456272125244, gen p mean: -0.23976844549179077, mean p set: 0.44696754217147827
loss_pred:0.01364368200302124, decouple_loss:0.0019360908772796392
The modified gen p mean: 0.4457813799381256, gen p mean: -0.2365678995847702, mean p set: 0.44635844230651855
loss_pred:0.014639217406511307, decouple_loss:0.0019486881792545319
The modified gen p mean: 0.4449608623981476, gen p mean: -0.24293452501296997, mean p set: 0.44549062848091125
loss_pred:0.01430955808609724, decouple_loss:0.0017617325065657496
2023-04-27 16:33:04 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23325271904468536, mean p set: 0.4499112665653229
loss_pred:0.01603909209370613, decouple_loss:0.0019204613054171205
The modified gen p mean: 0.4493033289909363, gen p mean: -0.23312614858150482, mean p set: 0.4498290419578552
loss_pred:0.015617642551660538, decouple_loss:0.0020599463023245335
The modified gen p mean: 0.44822046160697937, gen p mean: -0.23025622963905334, mean p set: 0.44879910349845886
loss_pred:0.01595565304160118, decouple_loss:0.0019331112271174788
WV_1_PC_1_EH_0_PS_30, loss: 0.015969354659318924, avg_mse: 0.02371613308787346
current test mse: 0.023716
Iteration: 3491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474337697029114, gen p mean: -0.2259320318698883, mean p set: 0.448009192943573
loss_pred:0.014958742074668407, decouple_loss:0.0018445281311869621
The modified gen p mean: 0.44801053404808044, gen p mean: -0.23570673167705536, mean p set: 0.44858217239379883
loss_pred:0.014344277791678905, decouple_loss:0.001802067388780415
The modified gen p mean: 0.44545090198516846, gen p mean: -0.23965410888195038, mean p set: 0.44598105549812317
loss_pred:0.01419868879020214, decouple_loss:0.0017498321831226349
Iteration: 3492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749364256858826, gen p mean: -0.23552991449832916, mean p set: 0.44802701473236084
loss_pred:0.013175245374441147, decouple_loss:0.0021197351161390543
The modified gen p mean: 0.4471035301685333, gen p mean: -0.23056353628635406, mean p set: 0.4476804733276367
The modified gen p mean: 0.4463678002357483, gen p mean: -0.22746101021766663, mean p set: 0.44694095849990845
loss_pred:0.01507541537284851, decouple_loss:0.0021078363060951233
loss_pred:0.015212924219667912, decouple_loss:0.0018845762824639678
Iteration: 3493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767385721206665, gen p mean: -0.23259006440639496, mean p set: 0.4481981694698334
loss_pred:0.015007870271801949, decouple_loss:0.0017930595204234123
The modified gen p mean: 0.4468212425708771, gen p mean: -0.2279113531112671, mean p set: 0.44739776849746704
The modified gen p mean: 0.4463341534137726, gen p mean: -0.22386497259140015, mean p set: 0.44690370559692383
loss_pred:0.014357986859977245, decouple_loss:0.001756560755893588
loss_pred:0.014498316682875156, decouple_loss:0.001711663673631847
Iteration: 3494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639861583709717, gen p mean: -0.23402278125286102, mean p set: 0.44692835211753845
loss_pred:0.014632629230618477, decouple_loss:0.002072867937386036
The modified gen p mean: 0.44786497950553894, gen p mean: -0.22985857725143433, mean p set: 0.44844114780426025
The modified gen p mean: 0.4473159909248352, gen p mean: -0.22789564728736877, mean p set: 0.4478902518749237
loss_pred:0.014622405171394348, decouple_loss:0.001982036978006363
loss_pred:0.014785469509661198, decouple_loss:0.0019027628004550934
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448934942483902, gen p mean: -0.23020607233047485, mean p set: 0.4495137631893158
loss_pred:0.014311671257019043, decouple_loss:0.001793362433090806
The modified gen p mean: 0.4470151364803314, gen p mean: -0.23040907084941864, mean p set: 0.44758957624435425The modified gen p mean: 0.44778338074684143, gen p mean: -0.2273017317056656, mean p set: 0.44831427931785583
loss_pred:0.014787501655519009, decouple_loss:0.0017400371143594384loss_pred:0.014577130787074566, decouple_loss:0.0016865079523995519
Iteration: 3496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481855630874634, gen p mean: -0.2275749295949936, mean p set: 0.44876447319984436
loss_pred:0.014029434882104397, decouple_loss:0.001999340485781431
The modified gen p mean: 0.4478106200695038, gen p mean: -0.2338230162858963, mean p set: 0.44838783144950867
loss_pred:0.014366865158081055, decouple_loss:0.0019695227965712547
The modified gen p mean: 0.4461812973022461, gen p mean: -0.23108437657356262, mean p set: 0.4467063546180725
loss_pred:0.014980807900428772, decouple_loss:0.0017744536744430661
Iteration: 3497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484999477863312, gen p mean: -0.23218251764774323, mean p set: 0.44907715916633606
loss_pred:0.014018789865076542, decouple_loss:0.002052631927654147
The modified gen p mean: 0.44645699858665466, gen p mean: -0.2304283082485199, mean p set: 0.4470267593860626
loss_pred:0.014483264647424221, decouple_loss:0.001878740033134818
The modified gen p mean: 0.44768527150154114, gen p mean: -0.23052062094211578, mean p set: 0.448209285736084
loss_pred:0.014064939692616463, decouple_loss:0.0018947862554341555
Iteration: 3498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465011954307556, gen p mean: -0.23343515396118164, mean p set: 0.44708412885665894
loss_pred:0.014558971859514713, decouple_loss:0.0019157956121489406
The modified gen p mean: 0.4471798837184906, gen p mean: -0.22403304278850555, mean p set: 0.4477542042732239
loss_pred:0.014965883456170559, decouple_loss:0.0018109760712832212
The modified gen p mean: 0.44658270478248596, gen p mean: -0.22906620800495148, mean p set: 0.44710773229599
loss_pred:0.014476485550403595, decouple_loss:0.00190899264998734
Iteration: 3499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454823434352875, gen p mean: -0.23151282966136932, mean p set: 0.4460590183734894
loss_pred:0.014598687179386616, decouple_loss:0.002132609486579895
The modified gen p mean: 0.4469214677810669, gen p mean: -0.2326931208372116, mean p set: 0.4474954903125763
loss_pred:0.014621695503592491, decouple_loss:0.0020835227333009243
The modified gen p mean: 0.44493114948272705, gen p mean: -0.23649655282497406, mean p set: 0.4454576373100281
loss_pred:0.014577437192201614, decouple_loss:0.002147671300917864
Iteration: 3500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467160999774933, gen p mean: -0.2281145602464676, mean p set: 0.44729292392730713
loss_pred:0.014920517802238464, decouple_loss:0.0018153919372707605
The modified gen p mean: 0.4485023617744446, gen p mean: -0.2275577038526535, mean p set: 0.4490286707878113The modified gen p mean: 0.44651171565055847, gen p mean: -0.23581203818321228, mean p set: 0.4470905363559723
loss_pred:0.014365500770509243, decouple_loss:0.0017790799029171467
loss_pred:0.014953519217669964, decouple_loss:0.002014231402426958
2023-04-27 16:36:29 testing...
The modified gen p mean: 0.4482259750366211, gen p mean: -0.23099346458911896, mean p set: 0.44879910349845886
loss_pred:0.015969008207321167, decouple_loss:0.002257007174193859
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2340872883796692, mean p set: 0.4499112665653229
loss_pred:0.015977274626493454, decouple_loss:0.002094330731779337
The modified gen p mean: 0.4493071138858795, gen p mean: -0.23401065170764923, mean p set: 0.4498290419578552
loss_pred:0.015613863244652748, decouple_loss:0.0022999164648354053
WV_1_PC_1_EH_0_PS_30, loss: 0.015964236110448837, avg_mse: 0.023760417476296425
current test mse: 0.02376
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 3501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829505681991577, gen p mean: -0.22961463034152985, mean p set: 0.4488137364387512
loss_pred:0.014761225320398808, decouple_loss:0.0020673968829214573
The modified gen p mean: 0.4479452967643738, gen p mean: -0.23750196397304535, mean p set: 0.4485251009464264
The modified gen p mean: 0.4472765326499939, gen p mean: -0.23347392678260803, mean p set: 0.44785305857658386
loss_pred:0.014962983317673206, decouple_loss:0.0021314274054020643
loss_pred:0.014703664928674698, decouple_loss:0.001960749039426446
Iteration: 3502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949468970298767, gen p mean: -0.23963196575641632, mean p set: 0.450029194355011
loss_pred:0.014703121967613697, decouple_loss:0.0019455784931778908
The modified gen p mean: 0.44764411449432373, gen p mean: -0.2343180626630783, mean p set: 0.4482291042804718
loss_pred:0.014560096897184849, decouple_loss:0.002099218312650919
The modified gen p mean: 0.4484148919582367, gen p mean: -0.24066650867462158, mean p set: 0.44898921251296997
loss_pred:0.014116281643509865, decouple_loss:0.0020012808963656425
Iteration: 3503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866323471069336, gen p mean: -0.23653699457645416, mean p set: 0.4491857588291168
loss_pred:0.014378692954778671, decouple_loss:0.002119761658832431
The modified gen p mean: 0.44811487197875977, gen p mean: -0.23639416694641113, mean p set: 0.4486883282661438
loss_pred:0.014491338282823563, decouple_loss:0.002011270960792899
The modified gen p mean: 0.4485366642475128, gen p mean: -0.235470250248909, mean p set: 0.44910916686058044
loss_pred:0.014567908830940723, decouple_loss:0.0020756633020937443
Iteration: 3504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490967392921448, gen p mean: -0.23544341325759888, mean p set: 0.4496248662471771
loss_pred:0.014426331035792828, decouple_loss:0.0021453038789331913
The modified gen p mean: 0.44776085019111633, gen p mean: -0.23141156136989594, mean p set: 0.4483354985713959
loss_pred:0.014613008126616478, decouple_loss:0.0020503452979028225
The modified gen p mean: 0.4491097927093506, gen p mean: -0.2364271730184555, mean p set: 0.449685275554657
loss_pred:0.014496907591819763, decouple_loss:0.002066903281956911
Iteration: 3505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838014245033264, gen p mean: -0.23385678231716156, mean p set: 0.44895440340042114
loss_pred:0.014030009508132935, decouple_loss:0.0019554535392671824
The modified gen p mean: 0.44767066836357117, gen p mean: -0.22546595335006714, mean p set: 0.4482443630695343The modified gen p mean: 0.44872790575027466, gen p mean: -0.232370063662529, mean p set: 0.44924765825271606
loss_pred:0.014826002530753613, decouple_loss:0.0017597476253286004
loss_pred:0.014546804130077362, decouple_loss:0.0018956627463921905
Iteration: 3506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481184780597687, gen p mean: -0.2278023362159729, mean p set: 0.4486922323703766
loss_pred:0.014650792814791203, decouple_loss:0.002313129138201475
The modified gen p mean: 0.4485451281070709, gen p mean: -0.22951491177082062, mean p set: 0.44911760091781616The modified gen p mean: 0.44853782653808594, gen p mean: -0.23252208530902863, mean p set: 0.44906941056251526
loss_pred:0.014387785457074642, decouple_loss:0.002252182923257351
loss_pred:0.01430737879127264, decouple_loss:0.0019670717883855104
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474666118621826, gen p mean: -0.23183318972587585, mean p set: 0.44804278016090393
loss_pred:0.014851395040750504, decouple_loss:0.0019051717827096581
The modified gen p mean: 0.4486251473426819, gen p mean: -0.23097948729991913, mean p set: 0.4492001235485077The modified gen p mean: 0.447343647480011, gen p mean: -0.22367867827415466, mean p set: 0.447873055934906
loss_pred:0.014043672010302544, decouple_loss:0.0018643013900145888
loss_pred:0.014314691536128521, decouple_loss:0.0019732853397727013
Iteration: 3508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474231004714966, gen p mean: -0.2357608824968338, mean p set: 0.4479973018169403
loss_pred:0.014238471165299416, decouple_loss:0.002013647696003318
The modified gen p mean: 0.4486832916736603, gen p mean: -0.23566871881484985, mean p set: 0.4492073655128479
The modified gen p mean: 0.4478580355644226, gen p mean: -0.23826813697814941, mean p set: 0.4484313726425171
loss_pred:0.01384940929710865, decouple_loss:0.002213098341599107
loss_pred:0.0145120183005929, decouple_loss:0.0020957672968506813
Iteration: 3509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625502824783325, gen p mean: -0.2369488626718521, mean p set: 0.44683340191841125
loss_pred:0.01474705059081316, decouple_loss:0.0019934563897550106
The modified gen p mean: 0.4481053650379181, gen p mean: -0.23787561058998108, mean p set: 0.4486764669418335The modified gen p mean: 0.4486364424228668, gen p mean: -0.23740608990192413, mean p set: 0.44916975498199463
loss_pred:0.01388841774314642, decouple_loss:0.0019165629055351019
loss_pred:0.014775694347918034, decouple_loss:0.0018971271347254515
Iteration: 3510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473349452018738, gen p mean: -0.23650969564914703, mean p set: 0.4479115903377533
loss_pred:0.014397460967302322, decouple_loss:0.002058636164292693
The modified gen p mean: 0.4471578001976013, gen p mean: -0.2370375245809555, mean p set: 0.4477364122867584
The modified gen p mean: 0.44835957884788513, gen p mean: -0.2374098002910614, mean p set: 0.4488835632801056
loss_pred:0.01451384462416172, decouple_loss:0.0019123046658933163
loss_pred:0.013748466968536377, decouple_loss:0.0020882172975689173
2023-04-27 16:40:37 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23825912177562714, mean p set: 0.4499112665653229
loss_pred:0.016032617539167404, decouple_loss:0.0018330507446080446
The modified gen p mean: 0.44822317361831665, gen p mean: -0.23534230887889862, mean p set: 0.44879910349845886
loss_pred:0.015931732952594757, decouple_loss:0.0019307821057736874
The modified gen p mean: 0.44930168986320496, gen p mean: -0.2381904572248459, mean p set: 0.4498290419578552
loss_pred:0.015614254400134087, decouple_loss:0.0019501697970554233
WV_1_PC_1_EH_0_PS_30, loss: 0.015954768285155296, avg_mse: 0.023756135255098343
current test mse: 0.023756
Iteration: 3511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763070344924927, gen p mean: -0.2297338843345642, mean p set: 0.4482038617134094
loss_pred:0.01415260136127472, decouple_loss:0.0019895818550139666
The modified gen p mean: 0.44885703921318054, gen p mean: -0.23313602805137634, mean p set: 0.4494262933731079
loss_pred:0.014866365119814873, decouple_loss:0.0019057586323469877
The modified gen p mean: 0.4487729072570801, gen p mean: -0.24328935146331787, mean p set: 0.44930675625801086
loss_pred:0.014223760925233364, decouple_loss:0.0019188341684639454
Iteration: 3512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796043634414673, gen p mean: -0.23876062035560608, mean p set: 0.4484924077987671
loss_pred:0.014495628885924816, decouple_loss:0.0018443773733451962
The modified gen p mean: 0.4486483931541443, gen p mean: -0.23820991814136505, mean p set: 0.4492258131504059
loss_pred:0.014338902197778225, decouple_loss:0.0018275207839906216
The modified gen p mean: 0.44937506318092346, gen p mean: -0.2346278578042984, mean p set: 0.44995051622390747
loss_pred:0.014445333741605282, decouple_loss:0.0020817886106669903
Iteration: 3513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804325699806213, gen p mean: -0.23739895224571228, mean p set: 0.44856706261634827
loss_pred:0.01435132697224617, decouple_loss:0.0018080971203744411
The modified gen p mean: 0.4482990801334381, gen p mean: -0.2370596081018448, mean p set: 0.44887199997901917
loss_pred:0.014352621510624886, decouple_loss:0.0018088595243170857
The modified gen p mean: 0.44879335165023804, gen p mean: -0.2356383055448532, mean p set: 0.44937053322792053
loss_pred:0.014571852050721645, decouple_loss:0.0018508791690692306
Iteration: 3514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482479691505432, gen p mean: -0.23473303020000458, mean p set: 0.4487766921520233
loss_pred:0.01430286094546318, decouple_loss:0.0018403182039037347
The modified gen p mean: 0.4484684467315674, gen p mean: -0.23189957439899445, mean p set: 0.4490397274494171
loss_pred:0.01446597184985876, decouple_loss:0.0020530899055302143
The modified gen p mean: 0.4486851692199707, gen p mean: -0.23079341650009155, mean p set: 0.44926580786705017
loss_pred:0.014205913059413433, decouple_loss:0.0019846868235617876
Iteration: 3515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484807848930359, gen p mean: -0.23029294610023499, mean p set: 0.4490547776222229
loss_pred:0.014170356094837189, decouple_loss:0.0018284935504198074
The modified gen p mean: 0.4487273693084717, gen p mean: -0.23176513612270355, mean p set: 0.4492553174495697The modified gen p mean: 0.44748473167419434, gen p mean: -0.22651298344135284, mean p set: 0.4480650722980499
loss_pred:0.014247980900108814, decouple_loss:0.001752767595462501loss_pred:0.014080699533224106, decouple_loss:0.0017512249760329723
Iteration: 3516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797831773757935, gen p mean: -0.23259314894676208, mean p set: 0.44855865836143494
loss_pred:0.014405131340026855, decouple_loss:0.0019862689077854156
The modified gen p mean: 0.4485344886779785, gen p mean: -0.23086458444595337, mean p set: 0.44910410046577454The modified gen p mean: 0.44864970445632935, gen p mean: -0.23153284192085266, mean p set: 0.44917428493499756
loss_pred:0.014593672938644886, decouple_loss:0.0020982595160603523
loss_pred:0.014013460837304592, decouple_loss:0.0021192145068198442
Iteration: 3517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709381461143494, gen p mean: -0.23097769916057587, mean p set: 0.4476754069328308
loss_pred:0.014300143346190453, decouple_loss:0.0017530331388115883
The modified gen p mean: 0.4480423033237457, gen p mean: -0.23324210941791534, mean p set: 0.44861912727355957The modified gen p mean: 0.44893261790275574, gen p mean: -0.23209422826766968, mean p set: 0.4494645595550537
loss_pred:0.014408036135137081, decouple_loss:0.0018567991210147738
loss_pred:0.014300655573606491, decouple_loss:0.0017798887565732002
Iteration: 3518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465644359588623, gen p mean: -0.2338944971561432, mean p set: 0.44714176654815674
loss_pred:0.01441231183707714, decouple_loss:0.0017264008056372404
The modified gen p mean: 0.44858813285827637, gen p mean: -0.23337814211845398, mean p set: 0.4491156041622162
loss_pred:0.014616771601140499, decouple_loss:0.0017577054677531123
The modified gen p mean: 0.4479027986526489, gen p mean: -0.2313316911458969, mean p set: 0.4484765827655792
loss_pred:0.014344247989356518, decouple_loss:0.0017506342846900225
Iteration: 3519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494580924510956, gen p mean: -0.23692284524440765, mean p set: 0.45003825426101685
loss_pred:0.014219805598258972, decouple_loss:0.0017589780036360025
The modified gen p mean: 0.44795599579811096, gen p mean: -0.23151037096977234, mean p set: 0.44853806495666504
loss_pred:0.014003099873661995, decouple_loss:0.0018221228383481503
The modified gen p mean: 0.44782835245132446, gen p mean: -0.22797223925590515, mean p set: 0.4483604431152344
loss_pred:0.014354085549712181, decouple_loss:0.0018875146051868796
Iteration: 3520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893109798431396, gen p mean: -0.2284815013408661, mean p set: 0.44951245188713074
loss_pred:0.013787391595542431, decouple_loss:0.001767464098520577
The modified gen p mean: 0.4492868185043335, gen p mean: -0.22934381663799286, mean p set: 0.44981372356414795
loss_pred:0.013834893703460693, decouple_loss:0.0017601278377696872
The modified gen p mean: 0.4486750662326813, gen p mean: -0.23030690848827362, mean p set: 0.44925105571746826
loss_pred:0.014521243050694466, decouple_loss:0.0016154833137989044
2023-04-27 16:44:02 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23231519758701324, mean p set: 0.4499112665653229
loss_pred:0.016079386696219444, decouple_loss:0.0019701034761965275
The modified gen p mean: 0.4493030309677124, gen p mean: -0.23234660923480988, mean p set: 0.4498290419578552
loss_pred:0.015645306557416916, decouple_loss:0.0019934677984565496
The modified gen p mean: 0.4482189416885376, gen p mean: -0.2297271490097046, mean p set: 0.44879910349845886
loss_pred:0.015896813943982124, decouple_loss:0.0019647644367069006
WV_1_PC_1_EH_0_PS_30, loss: 0.015972642228007317, avg_mse: 0.02374402806162834
current test mse: 0.023744
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 3521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505212903022766, gen p mean: -0.23410187661647797, mean p set: 0.4510541558265686
loss_pred:0.014197967946529388, decouple_loss:0.002052529249340296
The modified gen p mean: 0.4485403597354889, gen p mean: -0.23264537751674652, mean p set: 0.4491152763366699
loss_pred:0.013851202093064785, decouple_loss:0.0020029509905725718
The modified gen p mean: 0.44669899344444275, gen p mean: -0.22987334430217743, mean p set: 0.44727620482444763
loss_pred:0.014485935680568218, decouple_loss:0.0020487895235419273
Iteration: 3522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044687390327454, gen p mean: -0.23953144252300262, mean p set: 0.45098060369491577
loss_pred:0.014169667847454548, decouple_loss:0.0020154635421931744
The modified gen p mean: 0.44824090600013733, gen p mean: -0.2307656854391098, mean p set: 0.44881969690322876
The modified gen p mean: 0.4476547837257385, gen p mean: -0.2256973534822464, mean p set: 0.44823071360588074
loss_pred:0.01468667946755886, decouple_loss:0.0018870687345042825
loss_pred:0.014024595730006695, decouple_loss:0.002002868102863431
Iteration: 3523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849276542663574, gen p mean: -0.22835341095924377, mean p set: 0.44902175664901733
loss_pred:0.014410683885216713, decouple_loss:0.0019029600080102682
The modified gen p mean: 0.4473147988319397, gen p mean: -0.23348002135753632, mean p set: 0.4478953182697296
The modified gen p mean: 0.4482788145542145, gen p mean: -0.23688389360904694, mean p set: 0.4488562345504761
loss_pred:0.013956205919384956, decouple_loss:0.0018871164647862315
loss_pred:0.014130434952676296, decouple_loss:0.0018582874909043312
Iteration: 3524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493115544319153, gen p mean: -0.23215223848819733, mean p set: 0.44984006881713867
loss_pred:0.014464901760220528, decouple_loss:0.0020943116396665573
The modified gen p mean: 0.4492916166782379, gen p mean: -0.2414950579404831, mean p set: 0.4498688280582428
The modified gen p mean: 0.4484447240829468, gen p mean: -0.23108451068401337, mean p set: 0.44901901483535767
loss_pred:0.0138038145378232, decouple_loss:0.001962503418326378
loss_pred:0.01447729580104351, decouple_loss:0.0019914957229048014
Iteration: 3525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487019181251526, gen p mean: -0.24197714030742645, mean p set: 0.4492855668067932
loss_pred:0.013742589391767979, decouple_loss:0.0019507702672854066
The modified gen p mean: 0.44811561703681946, gen p mean: -0.23410068452358246, mean p set: 0.448650062084198The modified gen p mean: 0.448142945766449, gen p mean: -0.23733122646808624, mean p set: 0.44872117042541504
loss_pred:0.014067570678889751, decouple_loss:0.002138216281309724
loss_pred:0.014458625577390194, decouple_loss:0.00213144114241004
Iteration: 3526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480663239955902, gen p mean: -0.2257065623998642, mean p set: 0.44864022731781006
loss_pred:0.014300948940217495, decouple_loss:0.002058937679976225
The modified gen p mean: 0.44884777069091797, gen p mean: -0.2274807244539261, mean p set: 0.4494239091873169The modified gen p mean: 0.4472028613090515, gen p mean: -0.22830447554588318, mean p set: 0.4477311074733734
loss_pred:0.013301180675625801, decouple_loss:0.0021432803478091955
loss_pred:0.014361496083438396, decouple_loss:0.0018353174673393369
Iteration: 3527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471605122089386, gen p mean: -0.23330602049827576, mean p set: 0.4477364122867584
loss_pred:0.014074459671974182, decouple_loss:0.00230993190780282
The modified gen p mean: 0.44880059361457825, gen p mean: -0.23954638838768005, mean p set: 0.44937342405319214The modified gen p mean: 0.44740450382232666, gen p mean: -0.2327142059803009, mean p set: 0.4479316174983978
loss_pred:0.013820009306073189, decouple_loss:0.002127240877598524
loss_pred:0.014742754399776459, decouple_loss:0.002064913045614958
Iteration: 3528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488930106163025, gen p mean: -0.22972699999809265, mean p set: 0.4494667053222656
loss_pred:0.013479291461408138, decouple_loss:0.001994190737605095
The modified gen p mean: 0.4480704665184021, gen p mean: -0.23726028203964233, mean p set: 0.4486437141895294
loss_pred:0.014360862784087658, decouple_loss:0.001966699492186308
The modified gen p mean: 0.44756922125816345, gen p mean: -0.23142676055431366, mean p set: 0.4480955898761749
loss_pred:0.014408494345843792, decouple_loss:0.00210750475525856
Iteration: 3529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791921973228455, gen p mean: -0.2371947169303894, mean p set: 0.4484964609146118
loss_pred:0.013814396224915981, decouple_loss:0.0020344138611108065
The modified gen p mean: 0.4477716386318207, gen p mean: -0.23443755507469177, mean p set: 0.4483504593372345
loss_pred:0.013780055567622185, decouple_loss:0.0019127348205074668
The modified gen p mean: 0.44839635491371155, gen p mean: -0.2328580617904663, mean p set: 0.44892609119415283
loss_pred:0.013712665066123009, decouple_loss:0.0019778436981141567
Iteration: 3530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672608375549316, gen p mean: -0.2365647554397583, mean p set: 0.44730088114738464
loss_pred:0.014341359958052635, decouple_loss:0.0020043516997247934
The modified gen p mean: 0.4482310712337494, gen p mean: -0.23310141265392303, mean p set: 0.44880932569503784
loss_pred:0.014289810322225094, decouple_loss:0.001886056736111641
The modified gen p mean: 0.44900694489479065, gen p mean: -0.23480810225009918, mean p set: 0.449531614780426
loss_pred:0.014357400126755238, decouple_loss:0.0019629120361059904
2023-04-27 16:48:24 testing...
The modified gen p mean: 0.44822558760643005, gen p mean: -0.23796869814395905, mean p set: 0.44879910349845886
loss_pred:0.01606360822916031, decouple_loss:0.002148587955161929
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24042700231075287, mean p set: 0.4499112665653229
loss_pred:0.016200097277760506, decouple_loss:0.0021045145113021135
The modified gen p mean: 0.4493008553981781, gen p mean: -0.24084992706775665, mean p set: 0.4498290419578552
loss_pred:0.015769068151712418, decouple_loss:0.002223447198048234
WV_1_PC_1_EH_0_PS_30, loss: 0.016118867322802544, avg_mse: 0.024006713181734085
current test mse: 0.024007
Iteration: 3531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863641262054443, gen p mean: -0.2423444241285324, mean p set: 0.4492042660713196
loss_pred:0.013488231226801872, decouple_loss:0.002056509256362915
The modified gen p mean: 0.449271559715271, gen p mean: -0.2399592399597168, mean p set: 0.44984567165374756
loss_pred:0.014181542210280895, decouple_loss:0.002059830818325281
The modified gen p mean: 0.4491208493709564, gen p mean: -0.23792442679405212, mean p set: 0.4496456980705261
loss_pred:0.013531891629099846, decouple_loss:0.0021583139896392822
Iteration: 3532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888538122177124, gen p mean: -0.24326975643634796, mean p set: 0.4494134187698364
loss_pred:0.013437559828162193, decouple_loss:0.0016960352659225464
The modified gen p mean: 0.448367178440094, gen p mean: -0.23206976056098938, mean p set: 0.44894805550575256
loss_pred:0.01434879656881094, decouple_loss:0.001787455752491951
The modified gen p mean: 0.44755280017852783, gen p mean: -0.23509976267814636, mean p set: 0.4481230676174164
loss_pred:0.014120573177933693, decouple_loss:0.0018034887034446
Iteration: 3533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489772319793701, gen p mean: -0.23473535478115082, mean p set: 0.4495035707950592
loss_pred:0.01352768950164318, decouple_loss:0.0019784364849328995
The modified gen p mean: 0.44792845845222473, gen p mean: -0.23927251994609833, mean p set: 0.448505699634552
loss_pred:0.013999342918395996, decouple_loss:0.002015407895669341
The modified gen p mean: 0.4487740099430084, gen p mean: -0.23955443501472473, mean p set: 0.44935348629951477
loss_pred:0.014248174615204334, decouple_loss:0.0019153920002281666
Iteration: 3534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816064834594727, gen p mean: -0.2344202846288681, mean p set: 0.4486970603466034
loss_pred:0.014299977570772171, decouple_loss:0.0016680335393175483
The modified gen p mean: 0.44763997197151184, gen p mean: -0.22807487845420837, mean p set: 0.4482152760028839
loss_pred:0.014059091918170452, decouple_loss:0.0019469682592898607
The modified gen p mean: 0.4468119740486145, gen p mean: -0.231689915060997, mean p set: 0.44738414883613586
loss_pred:0.014641514047980309, decouple_loss:0.0017356827156618237
Iteration: 3535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485217332839966, gen p mean: -0.22676950693130493, mean p set: 0.44909510016441345
loss_pred:0.014164455235004425, decouple_loss:0.0021164806094020605
The modified gen p mean: 0.4481949210166931, gen p mean: -0.23277322947978973, mean p set: 0.44871968030929565The modified gen p mean: 0.44834426045417786, gen p mean: -0.23570740222930908, mean p set: 0.44891637563705444
loss_pred:0.013616345822811127, decouple_loss:0.002006413647904992
loss_pred:0.01408853568136692, decouple_loss:0.001958179520443082
Iteration: 3536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757330417633057, gen p mean: -0.23291625082492828, mean p set: 0.4481446146965027
loss_pred:0.01491820253431797, decouple_loss:0.0019210558384656906
The modified gen p mean: 0.4484088718891144, gen p mean: -0.23550303280353546, mean p set: 0.4489334523677826The modified gen p mean: 0.4481245279312134, gen p mean: -0.2310669869184494, mean p set: 0.44869375228881836
loss_pred:0.014021123759448528, decouple_loss:0.001954127801582217
loss_pred:0.013798111118376255, decouple_loss:0.002057581441476941
Iteration: 3537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765204191207886, gen p mean: -0.2252439707517624, mean p set: 0.448231041431427
loss_pred:0.014071586541831493, decouple_loss:0.002054137410596013
The modified gen p mean: 0.4479105770587921, gen p mean: -0.22803747653961182, mean p set: 0.44843941926956177The modified gen p mean: 0.44831418991088867, gen p mean: -0.23540225625038147, mean p set: 0.44889357686042786
loss_pred:0.013920314610004425, decouple_loss:0.001765405060723424
loss_pred:0.01378923561424017, decouple_loss:0.001956766005605459
Iteration: 3538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480481743812561, gen p mean: -0.22971053421497345, mean p set: 0.448621928691864
loss_pred:0.014224879443645477, decouple_loss:0.0020034422632306814
The modified gen p mean: 0.448749303817749, gen p mean: -0.23865583539009094, mean p set: 0.44932815432548523
loss_pred:0.013769631274044514, decouple_loss:0.001959633780643344
The modified gen p mean: 0.44698742032051086, gen p mean: -0.23184914886951447, mean p set: 0.4475100636482239
loss_pred:0.013809225521981716, decouple_loss:0.002036718651652336
Iteration: 3539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837620854377747, gen p mean: -0.2326119989156723, mean p set: 0.4489465653896332
loss_pred:0.013929133303463459, decouple_loss:0.001798182725906372
The modified gen p mean: 0.44806575775146484, gen p mean: -0.23647809028625488, mean p set: 0.44863688945770264
loss_pred:0.013640137389302254, decouple_loss:0.0018207046668976545
The modified gen p mean: 0.44801047444343567, gen p mean: -0.22978566586971283, mean p set: 0.4485420286655426
loss_pred:0.014298560097813606, decouple_loss:0.0018415238009765744
Iteration: 3540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447508305311203, gen p mean: -0.2328491359949112, mean p set: 0.4480842351913452
loss_pred:0.01367222424596548, decouple_loss:0.002014118479564786
The modified gen p mean: 0.44964537024497986, gen p mean: -0.23292258381843567, mean p set: 0.4502216577529907
loss_pred:0.014302859082818031, decouple_loss:0.002115535084158182
The modified gen p mean: 0.4473780393600464, gen p mean: -0.22895102202892303, mean p set: 0.4479077458381653
loss_pred:0.013586255721747875, decouple_loss:0.0023169738706201315
2023-04-27 16:51:50 testing...
The modified gen p mean: 0.44930246472358704, gen p mean: -0.23819321393966675, mean p set: 0.4498290419578552
loss_pred:0.015793239697813988, decouple_loss:0.0019087906694039702
The modified gen p mean: 0.44822412729263306, gen p mean: -0.2353290319442749, mean p set: 0.44879910349845886
loss_pred:0.016105908900499344, decouple_loss:0.001916254055686295
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2380804419517517, mean p set: 0.4499112665653229
loss_pred:0.01620229333639145, decouple_loss:0.0019869410898536444
WV_1_PC_1_EH_0_PS_30, loss: 0.016130682080984116, avg_mse: 0.023962276056408882
current test mse: 0.023962
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 3541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830673933029175, gen p mean: -0.23265980184078217, mean p set: 0.44883567094802856
loss_pred:0.014491939917206764, decouple_loss:0.0018649623962119222
The modified gen p mean: 0.4480884075164795, gen p mean: -0.23650462925434113, mean p set: 0.44866693019866943
loss_pred:0.014119558967649937, decouple_loss:0.0018097421852871776
The modified gen p mean: 0.4482805132865906, gen p mean: -0.23300856351852417, mean p set: 0.44885557889938354
loss_pred:0.013767705298960209, decouple_loss:0.001932215178385377
Iteration: 3542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475138783454895, gen p mean: -0.2401665896177292, mean p set: 0.44804564118385315
loss_pred:0.014120322652161121, decouple_loss:0.00214638514444232
The modified gen p mean: 0.44749557971954346, gen p mean: -0.23721614480018616, mean p set: 0.4480714499950409
The modified gen p mean: 0.44752177596092224, gen p mean: -0.2329624444246292, mean p set: 0.44809263944625854
loss_pred:0.01358707807958126, decouple_loss:0.0018580290488898754
loss_pred:0.013783765025436878, decouple_loss:0.002475098008289933
Iteration: 3543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674229621887207, gen p mean: -0.23281100392341614, mean p set: 0.4472724497318268
loss_pred:0.01396674569696188, decouple_loss:0.0019601741805672646
The modified gen p mean: 0.4478323757648468, gen p mean: -0.23142683506011963, mean p set: 0.448408842086792
The modified gen p mean: 0.4500889182090759, gen p mean: -0.23427148163318634, mean p set: 0.45066288113594055
loss_pred:0.014247310347855091, decouple_loss:0.001999314408749342
loss_pred:0.013721787370741367, decouple_loss:0.0017554026562720537
Iteration: 3544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477228820323944, gen p mean: -0.22860826551914215, mean p set: 0.44830387830734253
loss_pred:0.014759865589439869, decouple_loss:0.0024747445713728666
The modified gen p mean: 0.44701963663101196, gen p mean: -0.23504041135311127, mean p set: 0.44755133986473083The modified gen p mean: 0.44778814911842346, gen p mean: -0.23347173631191254, mean p set: 0.44836726784706116
loss_pred:0.013295919634401798, decouple_loss:0.002240447560325265
loss_pred:0.013326139189302921, decouple_loss:0.002401486039161682
Iteration: 3545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501083791255951, gen p mean: -0.23083409667015076, mean p set: 0.450685054063797
loss_pred:0.014069503173232079, decouple_loss:0.002116480376571417
The modified gen p mean: 0.4480104148387909, gen p mean: -0.22915174067020416, mean p set: 0.4485826790332794
loss_pred:0.013771072961390018, decouple_loss:0.0019703414291143417
The modified gen p mean: 0.44772547483444214, gen p mean: -0.22577577829360962, mean p set: 0.4482579529285431
loss_pred:0.013942626304924488, decouple_loss:0.002273101592436433
Iteration: 3546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479507505893707, gen p mean: -0.2323407381772995, mean p set: 0.4485265016555786
loss_pred:0.013398605398833752, decouple_loss:0.002441991586238146
The modified gen p mean: 0.4473925232887268, gen p mean: -0.23285187780857086, mean p set: 0.44796544313430786
loss_pred:0.013949085958302021, decouple_loss:0.0027073193341493607
The modified gen p mean: 0.4476096034049988, gen p mean: -0.22969861328601837, mean p set: 0.4481477439403534
loss_pred:0.01385338045656681, decouple_loss:0.002422994002699852
Iteration: 3547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862648844718933, gen p mean: -0.22934123873710632, mean p set: 0.44920095801353455
loss_pred:0.0137910982593894, decouple_loss:0.0024114290717989206
The modified gen p mean: 0.45079123973846436, gen p mean: -0.235032320022583, mean p set: 0.4513660967350006
loss_pred:0.013830214738845825, decouple_loss:0.002110952278599143
The modified gen p mean: 0.44805896282196045, gen p mean: -0.23635348677635193, mean p set: 0.4485855996608734
loss_pred:0.014006487093865871, decouple_loss:0.0024209758266806602
Iteration: 3548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482429027557373, gen p mean: -0.2317032665014267, mean p set: 0.4488143026828766
loss_pred:0.013895435258746147, decouple_loss:0.0021091869566589594
The modified gen p mean: 0.4489828050136566, gen p mean: -0.23841793835163116, mean p set: 0.4495646357536316
loss_pred:0.013903651386499405, decouple_loss:0.0020616413094103336
The modified gen p mean: 0.4487079977989197, gen p mean: -0.22599250078201294, mean p set: 0.4492424428462982
loss_pred:0.013766209594905376, decouple_loss:0.0022755067329853773
Iteration: 3549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486243724822998, gen p mean: -0.2284073829650879, mean p set: 0.44919851422309875
loss_pred:0.013835365884006023, decouple_loss:0.0025254059582948685
The modified gen p mean: 0.4485644996166229, gen p mean: -0.22472348809242249, mean p set: 0.44913890957832336
loss_pred:0.013784789480268955, decouple_loss:0.0024233921431005
The modified gen p mean: 0.4474884271621704, gen p mean: -0.23375165462493896, mean p set: 0.4480225145816803
loss_pred:0.014495882205665112, decouple_loss:0.0023553899955004454
Iteration: 3550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487431049346924, gen p mean: -0.23070953786373138, mean p set: 0.449319064617157
loss_pred:0.013940321281552315, decouple_loss:0.0021671010181307793
The modified gen p mean: 0.4476557672023773, gen p mean: -0.23637960851192474, mean p set: 0.4482307732105255
loss_pred:0.01355079747736454, decouple_loss:0.002155550755560398
The modified gen p mean: 0.44634491205215454, gen p mean: -0.24068352580070496, mean p set: 0.4468747675418854
loss_pred:0.014190451242029667, decouple_loss:0.0019978429190814495
2023-04-27 16:56:03 testing...
The modified gen p mean: 0.4482184052467346, gen p mean: -0.23180754482746124, mean p set: 0.44879910349845886
loss_pred:0.01609356515109539, decouple_loss:0.002207171870395541
The modified gen p mean: 0.4494309425354004, gen p mean: -0.234461709856987, mean p set: 0.4499112665653229
loss_pred:0.016153153032064438, decouple_loss:0.0022717334795743227
The modified gen p mean: 0.44929468631744385, gen p mean: -0.23460352420806885, mean p set: 0.4498290419578552
loss_pred:0.01569846086204052, decouple_loss:0.0022489142138510942
WV_1_PC_1_EH_0_PS_30, loss: 0.01609385758638382, avg_mse: 0.023870741948485374
current test mse: 0.023871
Iteration: 3551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786205887794495, gen p mean: -0.23328208923339844, mean p set: 0.44844454526901245
loss_pred:0.013435653410851955, decouple_loss:0.002367151202633977
The modified gen p mean: 0.4491354823112488, gen p mean: -0.23592506349086761, mean p set: 0.44971415400505066
loss_pred:0.014280018396675587, decouple_loss:0.0020921765826642513
The modified gen p mean: 0.4483546018600464, gen p mean: -0.22926545143127441, mean p set: 0.4488862454891205
loss_pred:0.014078878797590733, decouple_loss:0.0022754676174372435
Iteration: 3552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871020317077637, gen p mean: -0.22765812277793884, mean p set: 0.4492388665676117
loss_pred:0.013421004638075829, decouple_loss:0.0021256476175040007
The modified gen p mean: 0.44776710867881775, gen p mean: -0.23121629655361176, mean p set: 0.4483499228954315
loss_pred:0.013753622770309448, decouple_loss:0.002413144800812006
The modified gen p mean: 0.44722577929496765, gen p mean: -0.22909709811210632, mean p set: 0.44780102372169495
loss_pred:0.014477518387138844, decouple_loss:0.0023094629868865013
Iteration: 3553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859182834625244, gen p mean: -0.22836793959140778, mean p set: 0.4491168260574341
loss_pred:0.014375915750861168, decouple_loss:0.0023173431400209665
The modified gen p mean: 0.4463905096054077, gen p mean: -0.2326810508966446, mean p set: 0.44696733355522156
loss_pred:0.013695912435650826, decouple_loss:0.0019876311998814344
The modified gen p mean: 0.44837290048599243, gen p mean: -0.2305314689874649, mean p set: 0.44895556569099426
loss_pred:0.014241863042116165, decouple_loss:0.0023523569107055664
Iteration: 3554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820916652679443, gen p mean: -0.2308916598558426, mean p set: 0.4487343728542328
loss_pred:0.014700056053698063, decouple_loss:0.002147104125469923
The modified gen p mean: 0.4482455253601074, gen p mean: -0.2345237284898758, mean p set: 0.4488264322280884
loss_pred:0.013670898973941803, decouple_loss:0.002088435459882021
The modified gen p mean: 0.448219895362854, gen p mean: -0.22713704407215118, mean p set: 0.44879457354545593
loss_pred:0.01375000923871994, decouple_loss:0.002299393294379115
Iteration: 3555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492555260658264, gen p mean: -0.22191165387630463, mean p set: 0.44983553886413574
loss_pred:0.01375998742878437, decouple_loss:0.002254140330478549
The modified gen p mean: 0.4493158757686615, gen p mean: -0.22563081979751587, mean p set: 0.44988885521888733The modified gen p mean: 0.44802185893058777, gen p mean: -0.22451037168502808, mean p set: 0.44854292273521423
loss_pred:0.01403525099158287, decouple_loss:0.0022518152836710215
loss_pred:0.013604569248855114, decouple_loss:0.002245710464194417
Iteration: 3556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717615842819214, gen p mean: -0.23501071333885193, mean p set: 0.44775673747062683
loss_pred:0.013445733115077019, decouple_loss:0.001902515534311533
The modified gen p mean: 0.44728994369506836, gen p mean: -0.23426398634910583, mean p set: 0.4478631317615509The modified gen p mean: 0.44856441020965576, gen p mean: -0.23297731578350067, mean p set: 0.4490965008735657
loss_pred:0.014064770191907883, decouple_loss:0.002259504282847047
loss_pred:0.014122618362307549, decouple_loss:0.001875774934887886
Iteration: 3557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484085440635681, gen p mean: -0.22528302669525146, mean p set: 0.44898515939712524
loss_pred:0.01369077805429697, decouple_loss:0.0021230001002550125
The modified gen p mean: 0.44646450877189636, gen p mean: -0.23794490098953247, mean p set: 0.446990966796875The modified gen p mean: 0.44865351915359497, gen p mean: -0.2259957641363144, mean p set: 0.4492274820804596
loss_pred:0.01356469001621008, decouple_loss:0.002131399931386113
loss_pred:0.01394430547952652, decouple_loss:0.001896711066365242
Iteration: 3558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464593231678009, gen p mean: -0.23310282826423645, mean p set: 0.44704070687294006
loss_pred:0.013382590375840664, decouple_loss:0.001796067925170064
The modified gen p mean: 0.44808125495910645, gen p mean: -0.23478055000305176, mean p set: 0.4486563205718994The modified gen p mean: 0.4487450420856476, gen p mean: -0.23289552330970764, mean p set: 0.4492718279361725
loss_pred:0.013337665237486362, decouple_loss:0.0018703785026445985
loss_pred:0.014149416238069534, decouple_loss:0.001839767792262137
Iteration: 3559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769495725631714, gen p mean: -0.23068751394748688, mean p set: 0.4482734203338623
loss_pred:0.013569360598921776, decouple_loss:0.002060021972283721
The modified gen p mean: 0.4460628628730774, gen p mean: -0.23249414563179016, mean p set: 0.44663533568382263
loss_pred:0.013884029351174831, decouple_loss:0.0020580170676112175
The modified gen p mean: 0.4495737552642822, gen p mean: -0.23386335372924805, mean p set: 0.4501021206378937
loss_pred:0.013782437890768051, decouple_loss:0.0018580890027806163
Iteration: 3560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819125533103943, gen p mean: -0.23437674343585968, mean p set: 0.4487667679786682
loss_pred:0.013814049772918224, decouple_loss:0.001705615664832294
The modified gen p mean: 0.44819003343582153, gen p mean: -0.22801904380321503, mean p set: 0.44876742362976074
loss_pred:0.013960015028715134, decouple_loss:0.0017325564986094832
The modified gen p mean: 0.4482126533985138, gen p mean: -0.23313836753368378, mean p set: 0.4487411379814148
loss_pred:0.0132851991802454, decouple_loss:0.0018235697643831372
2023-04-27 16:59:29 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22967715561389923, mean p set: 0.4499112665653229
loss_pred:0.01616356149315834, decouple_loss:0.002059284830465913
The modified gen p mean: 0.44929981231689453, gen p mean: -0.2299421727657318, mean p set: 0.4498290419578552
loss_pred:0.01573469676077366, decouple_loss:0.0019166979473084211
The modified gen p mean: 0.44822242856025696, gen p mean: -0.22710023820400238, mean p set: 0.44879910349845886
loss_pred:0.016046959906816483, decouple_loss:0.001974082086235285
WV_1_PC_1_EH_0_PS_30, loss: 0.016080906614661217, avg_mse: 0.02387930080294609
current test mse: 0.023879
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 3561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467601478099823, gen p mean: -0.23464176058769226, mean p set: 0.4472888708114624
loss_pred:0.01477046124637127, decouple_loss:0.0018982309848070145
The modified gen p mean: 0.4474486708641052, gen p mean: -0.2308540940284729, mean p set: 0.44802361726760864
loss_pred:0.01474712509661913, decouple_loss:0.0018662243383005261
The modified gen p mean: 0.4461310803890228, gen p mean: -0.2285689264535904, mean p set: 0.44670602679252625
loss_pred:0.015437465161085129, decouple_loss:0.0018380939727649093
Iteration: 3562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683754444122314, gen p mean: -0.22763389348983765, mean p set: 0.44736430048942566
loss_pred:0.014848360791802406, decouple_loss:0.002178822411224246
The modified gen p mean: 0.4485345482826233, gen p mean: -0.22868283092975616, mean p set: 0.44910916686058044
The modified gen p mean: 0.447377473115921, gen p mean: -0.22607244551181793, mean p set: 0.4479510188102722
loss_pred:0.01484659779816866, decouple_loss:0.0020256913267076015
loss_pred:0.015089725144207478, decouple_loss:0.0019959670025855303
Iteration: 3563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684678316116333, gen p mean: -0.23190109431743622, mean p set: 0.44737330079078674
loss_pred:0.014751175418496132, decouple_loss:0.0019990934524685144
The modified gen p mean: 0.44725868105888367, gen p mean: -0.23420098423957825, mean p set: 0.4478357136249542
The modified gen p mean: 0.4477105736732483, gen p mean: -0.23346172273159027, mean p set: 0.4482831358909607
loss_pred:0.014868195168673992, decouple_loss:0.0018242415972054005
loss_pred:0.014756149612367153, decouple_loss:0.0019612472970038652
Iteration: 3564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447253555059433, gen p mean: -0.23035185039043427, mean p set: 0.4477764964103699
loss_pred:0.015336128883063793, decouple_loss:0.0021548252552747726
The modified gen p mean: 0.4481090009212494, gen p mean: -0.2335709184408188, mean p set: 0.44868743419647217
The modified gen p mean: 0.44785553216934204, gen p mean: -0.23251725733280182, mean p set: 0.44842514395713806
loss_pred:0.014579322189092636, decouple_loss:0.0020672453101724386
loss_pred:0.01473605539649725, decouple_loss:0.002129878383129835
Iteration: 3565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475161135196686, gen p mean: -0.22957685589790344, mean p set: 0.4480918347835541
loss_pred:0.015347803942859173, decouple_loss:0.0017169780330732465
The modified gen p mean: 0.4471806585788727, gen p mean: -0.2328321933746338, mean p set: 0.4477572739124298The modified gen p mean: 0.44764044880867004, gen p mean: -0.23490524291992188, mean p set: 0.44817429780960083
loss_pred:0.015325887128710747, decouple_loss:0.0021890297066420317
loss_pred:0.014705179259181023, decouple_loss:0.0017882150132209063
Iteration: 3566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816991686820984, gen p mean: -0.23571813106536865, mean p set: 0.4487501382827759
loss_pred:0.014325986616313457, decouple_loss:0.0021401375997811556
The modified gen p mean: 0.4487738311290741, gen p mean: -0.2318049818277359, mean p set: 0.44930416345596313The modified gen p mean: 0.44724366068840027, gen p mean: -0.22944700717926025, mean p set: 0.4478200376033783
loss_pred:0.01508146058768034, decouple_loss:0.0018928099889308214
loss_pred:0.01472488697618246, decouple_loss:0.0022908137179911137
Iteration: 3567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921380281448364, gen p mean: -0.23535721004009247, mean p set: 0.4497888684272766
loss_pred:0.014367238618433475, decouple_loss:0.001938695670105517
The modified gen p mean: 0.4472803473472595, gen p mean: -0.23440153896808624, mean p set: 0.44780635833740234The modified gen p mean: 0.44708824157714844, gen p mean: -0.233047217130661, mean p set: 0.4476657211780548
loss_pred:0.014283713884651661, decouple_loss:0.0017818972701206803
loss_pred:0.01521637849509716, decouple_loss:0.0017941519618034363
Iteration: 3568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689837098121643, gen p mean: -0.23346766829490662, mean p set: 0.44747352600097656
loss_pred:0.014599713496863842, decouple_loss:0.001936382264830172
The modified gen p mean: 0.44672369956970215, gen p mean: -0.2361534684896469, mean p set: 0.4472969174385071
loss_pred:0.014339694753289223, decouple_loss:0.0021305636037141085
The modified gen p mean: 0.44731876254081726, gen p mean: -0.23540492355823517, mean p set: 0.4478473961353302
loss_pred:0.015064466744661331, decouple_loss:0.0018051075749099255
Iteration: 3569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766226410865784, gen p mean: -0.2352467179298401, mean p set: 0.4482421875
loss_pred:0.014508995227515697, decouple_loss:0.0018047046614810824
The modified gen p mean: 0.44715312123298645, gen p mean: -0.2349451333284378, mean p set: 0.4477294087409973
loss_pred:0.015144961886107922, decouple_loss:0.0018613769207149744
The modified gen p mean: 0.44669845700263977, gen p mean: -0.23791036009788513, mean p set: 0.44723477959632874
loss_pred:0.015402428805828094, decouple_loss:0.0020830591674894094
Iteration: 3570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471259117126465, gen p mean: -0.23522812128067017, mean p set: 0.4476999342441559
loss_pred:0.014499980956315994, decouple_loss:0.0016951108118519187
The modified gen p mean: 0.4472475051879883, gen p mean: -0.23396381735801697, mean p set: 0.44782111048698425
loss_pred:0.014921232126653194, decouple_loss:0.0016505906824022532
The modified gen p mean: 0.44835585355758667, gen p mean: -0.23661179840564728, mean p set: 0.4488847255706787
loss_pred:0.014587024226784706, decouple_loss:0.001866657636128366
2023-04-27 17:03:33 testing...
The modified gen p mean: 0.44822195172309875, gen p mean: -0.23446457087993622, mean p set: 0.44879910349845886
loss_pred:0.01591002568602562, decouple_loss:0.001748455222696066
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2370971292257309, mean p set: 0.4499112665653229
loss_pred:0.016066672280430794, decouple_loss:0.0019241573754698038
The modified gen p mean: 0.4492989480495453, gen p mean: -0.23738856613636017, mean p set: 0.4498290419578552
loss_pred:0.015588291920721531, decouple_loss:0.0017613713862374425
WV_1_PC_1_EH_0_PS_30, loss: 0.015945564955472946, avg_mse: 0.023679474368691444
current test mse: 0.023679
Iteration: 3571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740942120552063, gen p mean: -0.23573623597621918, mean p set: 0.44793686270713806
loss_pred:0.014632713049650192, decouple_loss:0.0018186523811891675
The modified gen p mean: 0.4479129910469055, gen p mean: -0.2369670420885086, mean p set: 0.4484843611717224
loss_pred:0.014654132537543774, decouple_loss:0.0019074653973802924
The modified gen p mean: 0.447647362947464, gen p mean: -0.2366478592157364, mean p set: 0.44822028279304504
loss_pred:0.01449262909591198, decouple_loss:0.0019307528855279088
Iteration: 3572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485025405883789, gen p mean: -0.24220137298107147, mean p set: 0.4490325152873993
loss_pred:0.014162075705826283, decouple_loss:0.001726152841001749
The modified gen p mean: 0.44785061478614807, gen p mean: -0.2407388985157013, mean p set: 0.44843074679374695
The modified gen p mean: 0.44643428921699524, gen p mean: -0.241386279463768, mean p set: 0.44701075553894043
loss_pred:0.01456936914473772, decouple_loss:0.001744182431139052
loss_pred:0.014721052721142769, decouple_loss:0.0017144454177469015
Iteration: 3573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467180371284485, gen p mean: -0.24113625288009644, mean p set: 0.4472491443157196
loss_pred:0.014561377465724945, decouple_loss:0.0018290166044607759
The modified gen p mean: 0.4477331340312958, gen p mean: -0.23873893916606903, mean p set: 0.4483122229576111The modified gen p mean: 0.4471943974494934, gen p mean: -0.2414707988500595, mean p set: 0.4477703869342804
loss_pred:0.014328892342746258, decouple_loss:0.0015773953637108207
loss_pred:0.014831663109362125, decouple_loss:0.0016592303290963173
Iteration: 3574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651228189468384, gen p mean: -0.23641683161258698, mean p set: 0.4470870792865753
loss_pred:0.015075570903718472, decouple_loss:0.0017435046611353755
The modified gen p mean: 0.4475707709789276, gen p mean: -0.2353096604347229, mean p set: 0.4481441080570221
loss_pred:0.014511832036077976, decouple_loss:0.001818200689740479
The modified gen p mean: 0.44659653306007385, gen p mean: -0.2416301816701889, mean p set: 0.4471310079097748
loss_pred:0.014119033701717854, decouple_loss:0.0019533054437488317
Iteration: 3575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713976979255676, gen p mean: -0.23631876707077026, mean p set: 0.44771599769592285
loss_pred:0.01457369513809681, decouple_loss:0.0019333561649546027
The modified gen p mean: 0.44757044315338135, gen p mean: -0.23454931378364563, mean p set: 0.4481446444988251
loss_pred:0.01536957360804081, decouple_loss:0.0017840369837358594
The modified gen p mean: 0.44682708382606506, gen p mean: -0.2418849915266037, mean p set: 0.44736161828041077
loss_pred:0.014249483123421669, decouple_loss:0.0017600025748834014
Iteration: 3576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802141189575195, gen p mean: -0.2390492707490921, mean p set: 0.4485948383808136
loss_pred:0.014594598673284054, decouple_loss:0.0021726395934820175
The modified gen p mean: 0.448059618473053, gen p mean: -0.23944924771785736, mean p set: 0.44864028692245483
loss_pred:0.014821597374975681, decouple_loss:0.002554493024945259
The modified gen p mean: 0.4467533528804779, gen p mean: -0.24298730492591858, mean p set: 0.44728556275367737
loss_pred:0.015309687703847885, decouple_loss:0.0020502647385001183
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785693287849426, gen p mean: -0.2388802319765091, mean p set: 0.4484269320964813
loss_pred:0.014287491329014301, decouple_loss:0.002093173563480377
The modified gen p mean: 0.4480467736721039, gen p mean: -0.23910272121429443, mean p set: 0.44862401485443115
loss_pred:0.014957480132579803, decouple_loss:0.002110069151967764
The modified gen p mean: 0.4481858015060425, gen p mean: -0.23715688288211823, mean p set: 0.44871804118156433
loss_pred:0.014523830264806747, decouple_loss:0.0020067377481609583
Iteration: 3578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472132623195648, gen p mean: -0.23727716505527496, mean p set: 0.4477914571762085
loss_pred:0.014242949895560741, decouple_loss:0.0023267935030162334
The modified gen p mean: 0.44828200340270996, gen p mean: -0.23739172518253326, mean p set: 0.44880321621894836The modified gen p mean: 0.44651105999946594, gen p mean: -0.24246470630168915, mean p set: 0.44708749651908875
loss_pred:0.015106783248484135, decouple_loss:0.0026081500109285116
loss_pred:0.014690587297081947, decouple_loss:0.0021963007748126984
Iteration: 3579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473317265510559, gen p mean: -0.23372459411621094, mean p set: 0.4479072690010071
loss_pred:0.014158634468913078, decouple_loss:0.0020113796927034855
The modified gen p mean: 0.446725457906723, gen p mean: -0.22940979897975922, mean p set: 0.4473079442977905
loss_pred:0.014610773883759975, decouple_loss:0.0019818635191768408
The modified gen p mean: 0.4468940198421478, gen p mean: -0.23261749744415283, mean p set: 0.44742023944854736
loss_pred:0.014427727088332176, decouple_loss:0.0022127379197627306
Iteration: 3580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699716567993164, gen p mean: -0.22981567680835724, mean p set: 0.4475705623626709
loss_pred:0.014195606112480164, decouple_loss:0.0020361265633255243
The modified gen p mean: 0.44734135270118713, gen p mean: -0.2280346155166626, mean p set: 0.4479181170463562
loss_pred:0.014514594338834286, decouple_loss:0.0022024977952241898
The modified gen p mean: 0.4470747411251068, gen p mean: -0.2303781807422638, mean p set: 0.4476010799407959
loss_pred:0.01470970455557108, decouple_loss:0.0019269727636128664
2023-04-27 17:06:59 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22851580381393433, mean p set: 0.4499112665653229
loss_pred:0.01603870838880539, decouple_loss:0.002033567987382412
The modified gen p mean: 0.44930416345596313, gen p mean: -0.22872403264045715, mean p set: 0.4498290419578552
loss_pred:0.01563616283237934, decouple_loss:0.0021776119247078896
The modified gen p mean: 0.4482268691062927, gen p mean: -0.2258971780538559, mean p set: 0.44879910349845886
loss_pred:0.01591586135327816, decouple_loss:0.0019771719817072153
WV_1_PC_1_EH_0_PS_30, loss: 0.015966717153787613, avg_mse: 0.023729903623461723
current test mse: 0.02373
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704222679138184, gen p mean: -0.22690047323703766, mean p set: 0.4475724399089813
loss_pred:0.01443393062800169, decouple_loss:0.0021921999286860228
The modified gen p mean: 0.44710591435432434, gen p mean: -0.2321237176656723, mean p set: 0.4476762115955353
loss_pred:0.014161625877022743, decouple_loss:0.0022134811151772738
The modified gen p mean: 0.44741538166999817, gen p mean: -0.22730852663516998, mean p set: 0.4479915201663971
loss_pred:0.014479526318609715, decouple_loss:0.0023236339911818504
Iteration: 3582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717463850975037, gen p mean: -0.22785621881484985, mean p set: 0.4477064609527588
loss_pred:0.014235168695449829, decouple_loss:0.0022863266058266163
The modified gen p mean: 0.44648653268814087, gen p mean: -0.22678489983081818, mean p set: 0.4470658302307129
The modified gen p mean: 0.44670239090919495, gen p mean: -0.22925156354904175, mean p set: 0.4472809433937073
loss_pred:0.014992645010352135, decouple_loss:0.002575197257101536
loss_pred:0.014804739505052567, decouple_loss:0.0023212486412376165
Iteration: 3583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470369815826416, gen p mean: -0.23228389024734497, mean p set: 0.4475627839565277
loss_pred:0.013497309759259224, decouple_loss:0.0024261686485260725
The modified gen p mean: 0.4470173418521881, gen p mean: -0.23040005564689636, mean p set: 0.447593629360199
The modified gen p mean: 0.44595253467559814, gen p mean: -0.22706390917301178, mean p set: 0.4465225338935852
loss_pred:0.014445584267377853, decouple_loss:0.002184521174058318
loss_pred:0.014564440585672855, decouple_loss:0.002123164711520076
Iteration: 3584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446395605802536, gen p mean: -0.2299080193042755, mean p set: 0.44692397117614746
loss_pred:0.014931599609553814, decouple_loss:0.0019816048443317413
The modified gen p mean: 0.4466705322265625, gen p mean: -0.23307769000530243, mean p set: 0.44724223017692566
The modified gen p mean: 0.4466647207736969, gen p mean: -0.23091475665569305, mean p set: 0.44724246859550476
loss_pred:0.015222855843603611, decouple_loss:0.002079091500490904
loss_pred:0.014208786189556122, decouple_loss:0.002193943364545703
Iteration: 3585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44575950503349304, gen p mean: -0.23531846702098846, mean p set: 0.4463328719139099
loss_pred:0.014466255903244019, decouple_loss:0.002134772716090083
The modified gen p mean: 0.44730496406555176, gen p mean: -0.23217973113059998, mean p set: 0.44783177971839905The modified gen p mean: 0.4477183222770691, gen p mean: -0.23478056490421295, mean p set: 0.44829118251800537
loss_pred:0.014714843593537807, decouple_loss:0.002032398246228695
loss_pred:0.014218984171748161, decouple_loss:0.001962127396836877
Iteration: 3586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832843542099, gen p mean: -0.2440437227487564, mean p set: 0.4489026963710785
loss_pred:0.014360230416059494, decouple_loss:0.002340929815545678
The modified gen p mean: 0.4461269676685333, gen p mean: -0.233281672000885, mean p set: 0.4466512203216553The modified gen p mean: 0.44674959778785706, gen p mean: -0.2381560057401657, mean p set: 0.44731974601745605
loss_pred:0.014410248026251793, decouple_loss:0.002031101146712899
loss_pred:0.015055910684168339, decouple_loss:0.0021530743688344955
Iteration: 3587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723963737487793, gen p mean: -0.2375958114862442, mean p set: 0.44781920313835144
loss_pred:0.014940163120627403, decouple_loss:0.001840271521359682
The modified gen p mean: 0.4464867413043976, gen p mean: -0.2370239496231079, mean p set: 0.44701918959617615The modified gen p mean: 0.4470176696777344, gen p mean: -0.2385745346546173, mean p set: 0.447585791349411
loss_pred:0.014499567449092865, decouple_loss:0.0017068588640540838
loss_pred:0.01489073783159256, decouple_loss:0.0020572058856487274
Iteration: 3588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447993665933609, gen p mean: -0.23712177574634552, mean p set: 0.448570191860199
loss_pred:0.014533767476677895, decouple_loss:0.002239168155938387
The modified gen p mean: 0.44601279497146606, gen p mean: -0.23049069941043854, mean p set: 0.4465442895889282The modified gen p mean: 0.447620689868927, gen p mean: -0.23552542924880981, mean p set: 0.44819772243499756
loss_pred:0.01503643300384283, decouple_loss:0.00211185310035944
loss_pred:0.014685212634503841, decouple_loss:0.0024609332904219627
Iteration: 3589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679465889930725, gen p mean: -0.23308385908603668, mean p set: 0.447368860244751
loss_pred:0.014778953976929188, decouple_loss:0.0016724345041438937
The modified gen p mean: 0.4468197822570801, gen p mean: -0.23696653544902802, mean p set: 0.44738972187042236
loss_pred:0.014644728973507881, decouple_loss:0.001854633679613471
The modified gen p mean: 0.4469650983810425, gen p mean: -0.23757430911064148, mean p set: 0.4474965035915375
loss_pred:0.014229276217520237, decouple_loss:0.0017784411320462823
Iteration: 3590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468689262866974, gen p mean: -0.23879562318325043, mean p set: 0.4474417567253113
loss_pred:0.01470824796706438, decouple_loss:0.0018852336797863245
The modified gen p mean: 0.4460013806819916, gen p mean: -0.2321363389492035, mean p set: 0.44658011198043823
loss_pred:0.014916572719812393, decouple_loss:0.001988203963264823
The modified gen p mean: 0.44681495428085327, gen p mean: -0.23724915087223053, mean p set: 0.4473433792591095
loss_pred:0.014593594707548618, decouple_loss:0.0017010353039950132
2023-04-27 17:11:05 testing...
The modified gen p mean: 0.44822803139686584, gen p mean: -0.23370261490345, mean p set: 0.44879910349845886
loss_pred:0.015902414917945862, decouple_loss:0.0021623214706778526
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23594307899475098, mean p set: 0.4499112665653229
loss_pred:0.015988141298294067, decouple_loss:0.0021665648091584444
The modified gen p mean: 0.44930216670036316, gen p mean: -0.23666322231292725, mean p set: 0.4498290419578552
loss_pred:0.01561370026320219, decouple_loss:0.001954686129465699
WV_1_PC_1_EH_0_PS_30, loss: 0.01593947783112526, avg_mse: 0.023713402450084686
current test mse: 0.023713
Iteration: 3591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446475625038147, gen p mean: -0.24114611744880676, mean p set: 0.44700121879577637
loss_pred:0.014690794050693512, decouple_loss:0.0021648702677339315
The modified gen p mean: 0.4474881887435913, gen p mean: -0.23762863874435425, mean p set: 0.44806966185569763The modified gen p mean: 0.4475598633289337, gen p mean: -0.23479188978672028, mean p set: 0.4481275677680969
loss_pred:0.014282101765275002, decouple_loss:0.0018715052865445614
loss_pred:0.014303470961749554, decouple_loss:0.002110926201567054
Iteration: 3592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625264406204224, gen p mean: -0.23617029190063477, mean p set: 0.4467797577381134
loss_pred:0.014616669155657291, decouple_loss:0.001884595723822713
The modified gen p mean: 0.4469848871231079, gen p mean: -0.23932906985282898, mean p set: 0.4475582242012024
The modified gen p mean: 0.44707849621772766, gen p mean: -0.23529291152954102, mean p set: 0.4476585388183594
loss_pred:0.014033767394721508, decouple_loss:0.0019287586910650134
loss_pred:0.014636526815593243, decouple_loss:0.0021616185549646616
Iteration: 3593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469147324562073, gen p mean: -0.23062995076179504, mean p set: 0.4474363923072815
loss_pred:0.014559821225702763, decouple_loss:0.002232171827927232
The modified gen p mean: 0.4459291398525238, gen p mean: -0.2323913723230362, mean p set: 0.446504145860672
The modified gen p mean: 0.4464457035064697, gen p mean: -0.2317388355731964, mean p set: 0.44702303409576416
loss_pred:0.014617133885622025, decouple_loss:0.0019701423589140177
loss_pred:0.014724991284310818, decouple_loss:0.001837924704886973
Iteration: 3594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726288318634033, gen p mean: -0.2342681884765625, mean p set: 0.4478381872177124
loss_pred:0.014347301796078682, decouple_loss:0.0022272844798862934
The modified gen p mean: 0.44873252511024475, gen p mean: -0.24064211547374725, mean p set: 0.44930580258369446
loss_pred:0.01416353415697813, decouple_loss:0.002128132153302431
The modified gen p mean: 0.4472769796848297, gen p mean: -0.23566751182079315, mean p set: 0.4478035867214203
loss_pred:0.014625963754951954, decouple_loss:0.0022228460293263197
Iteration: 3595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446816623210907, gen p mean: -0.23059163987636566, mean p set: 0.447394996881485
loss_pred:0.01456581149250269, decouple_loss:0.002363769803196192
The modified gen p mean: 0.4467752277851105, gen p mean: -0.23171593248844147, mean p set: 0.44735097885131836
loss_pred:0.014350704848766327, decouple_loss:0.0020922808907926083
The modified gen p mean: 0.44780462980270386, gen p mean: -0.23337379097938538, mean p set: 0.44833290576934814
loss_pred:0.014455256052315235, decouple_loss:0.002220660448074341
Iteration: 3596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44604429602622986, gen p mean: -0.22862958908081055, mean p set: 0.4466211497783661
loss_pred:0.014321376569569111, decouple_loss:0.0023039677180349827
The modified gen p mean: 0.4459371566772461, gen p mean: -0.2298460751771927, mean p set: 0.44651639461517334
loss_pred:0.014669048599898815, decouple_loss:0.0020967742893844843
The modified gen p mean: 0.4479757845401764, gen p mean: -0.23822325468063354, mean p set: 0.44850221276283264
loss_pred:0.014162964187562466, decouple_loss:0.0024756535422056913
Iteration: 3597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803398847579956, gen p mean: -0.23199427127838135, mean p set: 0.44856566190719604
loss_pred:0.014212134294211864, decouple_loss:0.0019811294041574
The modified gen p mean: 0.4458979368209839, gen p mean: -0.23181001842021942, mean p set: 0.4464643895626068
The modified gen p mean: 0.44771823287010193, gen p mean: -0.23369157314300537, mean p set: 0.4483036994934082
loss_pred:0.014429351314902306, decouple_loss:0.001799281919375062
loss_pred:0.014024159871041775, decouple_loss:0.0020137401297688484
Iteration: 3598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467677175998688, gen p mean: -0.23514991998672485, mean p set: 0.4473459720611572
loss_pred:0.014810598455369473, decouple_loss:0.0019561753142625093
The modified gen p mean: 0.44615069031715393, gen p mean: -0.2355097383260727, mean p set: 0.44673141837120056
loss_pred:0.014907117001712322, decouple_loss:0.002035676734521985
The modified gen p mean: 0.44719555974006653, gen p mean: -0.23956099152565002, mean p set: 0.44772762060165405
loss_pred:0.013788683339953423, decouple_loss:0.002155844820663333
Iteration: 3599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468899667263031, gen p mean: -0.2405110001564026, mean p set: 0.4474670886993408
loss_pred:0.014102958142757416, decouple_loss:0.001985773677006364
The modified gen p mean: 0.4466039538383484, gen p mean: -0.2356521636247635, mean p set: 0.4471836984157562
loss_pred:0.014810245484113693, decouple_loss:0.00218843761831522
The modified gen p mean: 0.44700759649276733, gen p mean: -0.23824413120746613, mean p set: 0.4475339949131012
loss_pred:0.015525209717452526, decouple_loss:0.0020768342074006796
Iteration: 3600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710296392440796, gen p mean: -0.23817132413387299, mean p set: 0.44767507910728455
loss_pred:0.01386182475835085, decouple_loss:0.002035933779552579
The modified gen p mean: 0.44687771797180176, gen p mean: -0.23075780272483826, mean p set: 0.4474518895149231
loss_pred:0.014506230130791664, decouple_loss:0.0019441090989857912
The modified gen p mean: 0.4466647207736969, gen p mean: -0.23355737328529358, mean p set: 0.44718724489212036
loss_pred:0.014619335532188416, decouple_loss:0.0018404860747978091
2023-04-27 17:14:30 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2293495535850525, mean p set: 0.4499112665653229
loss_pred:0.016052354127168655, decouple_loss:0.002839831868186593
The modified gen p mean: 0.4482170045375824, gen p mean: -0.22708654403686523, mean p set: 0.44879910349845886
loss_pred:0.015940360724925995, decouple_loss:0.002278281841427088
The modified gen p mean: 0.44929763674736023, gen p mean: -0.22983038425445557, mean p set: 0.4498290419578552
loss_pred:0.01562879979610443, decouple_loss:0.002715538954362273
WV_1_PC_1_EH_0_PS_30, loss: 0.016004398465156555, avg_mse: 0.02377757430076599
current test mse: 0.023778
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 3601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468275010585785, gen p mean: -0.22767359018325806, mean p set: 0.4474024176597595
loss_pred:0.01462648157030344, decouple_loss:0.0020517201628535986
The modified gen p mean: 0.4473993480205536, gen p mean: -0.22897230088710785, mean p set: 0.4479270875453949
loss_pred:0.013993254862725735, decouple_loss:0.002196745714172721
The modified gen p mean: 0.44668909907341003, gen p mean: -0.2319534868001938, mean p set: 0.44725939631462097
loss_pred:0.014662197791039944, decouple_loss:0.0026116534136235714
Iteration: 3602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794774055480957, gen p mean: -0.23361703753471375, mean p set: 0.4484758675098419
loss_pred:0.014317640103399754, decouple_loss:0.0029729946982115507
The modified gen p mean: 0.44660934805870056, gen p mean: -0.2249569296836853, mean p set: 0.4471812844276428
The modified gen p mean: 0.44868335127830505, gen p mean: -0.23197703063488007, mean p set: 0.44926023483276367
loss_pred:0.01435890793800354, decouple_loss:0.002940946025773883
loss_pred:0.014282948337495327, decouple_loss:0.002275066450238228
Iteration: 3603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468795359134674, gen p mean: -0.22825181484222412, mean p set: 0.4474049210548401
loss_pred:0.014229887165129185, decouple_loss:0.0019887173548340797
The modified gen p mean: 0.44789624214172363, gen p mean: -0.22729021310806274, mean p set: 0.44847285747528076
The modified gen p mean: 0.44716736674308777, gen p mean: -0.23305551707744598, mean p set: 0.4477385878562927
loss_pred:0.013927756808698177, decouple_loss:0.0024434993974864483
loss_pred:0.014383315108716488, decouple_loss:0.0020713158883154392
Iteration: 3604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468684494495392, gen p mean: -0.2276916205883026, mean p set: 0.44739410281181335
loss_pred:0.015097538940608501, decouple_loss:0.001861415570601821
The modified gen p mean: 0.447218120098114, gen p mean: -0.2320861518383026, mean p set: 0.44779151678085327
The modified gen p mean: 0.4461761713027954, gen p mean: -0.2289009392261505, mean p set: 0.44675159454345703
loss_pred:0.014264670200645924, decouple_loss:0.002649505389854312
loss_pred:0.014890274032950401, decouple_loss:0.001976564759388566
Iteration: 3605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476620554924011, gen p mean: -0.23443174362182617, mean p set: 0.4482361972332001
loss_pred:0.014039512723684311, decouple_loss:0.002000019885599613
The modified gen p mean: 0.4471476078033447, gen p mean: -0.23366527259349823, mean p set: 0.44772061705589294The modified gen p mean: 0.4477398693561554, gen p mean: -0.23564031720161438, mean p set: 0.44827136397361755
loss_pred:0.014158260077238083, decouple_loss:0.002299878979101777
loss_pred:0.013782892376184464, decouple_loss:0.0024474922101944685
Iteration: 3606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478001892566681, gen p mean: -0.2267504632472992, mean p set: 0.4483778774738312
loss_pred:0.013991687446832657, decouple_loss:0.0023133475333452225
The modified gen p mean: 0.4466315507888794, gen p mean: -0.23594385385513306, mean p set: 0.4471994936466217The modified gen p mean: 0.4477193057537079, gen p mean: -0.23693647980690002, mean p set: 0.44824886322021484
loss_pred:0.014576565474271774, decouple_loss:0.0021436603274196386
loss_pred:0.013831923715770245, decouple_loss:0.002046888694167137
Iteration: 3607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473191797733307, gen p mean: -0.22733327746391296, mean p set: 0.4478895962238312
loss_pred:0.01370470691472292, decouple_loss:0.0020531336776912212
The modified gen p mean: 0.4487135708332062, gen p mean: -0.22040916979312897, mean p set: 0.44924309849739075The modified gen p mean: 0.4464286267757416, gen p mean: -0.23466257750988007, mean p set: 0.44700247049331665
loss_pred:0.0145344827324152, decouple_loss:0.0023335337173193693
loss_pred:0.01432411465793848, decouple_loss:0.002183648059144616
Iteration: 3608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474164545536041, gen p mean: -0.22738532721996307, mean p set: 0.44798827171325684
loss_pred:0.013434406369924545, decouple_loss:0.0019314417149871588
The modified gen p mean: 0.4474349319934845, gen p mean: -0.2288046032190323, mean p set: 0.44800853729248047
loss_pred:0.014195230789482594, decouple_loss:0.0019715980160981417
The modified gen p mean: 0.44623640179634094, gen p mean: -0.22707194089889526, mean p set: 0.44676467776298523
loss_pred:0.013865994289517403, decouple_loss:0.0023046741262078285
Iteration: 3609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701626896858215, gen p mean: -0.23311789333820343, mean p set: 0.44759422540664673
loss_pred:0.01400725543498993, decouple_loss:0.0018256299663335085
The modified gen p mean: 0.4480678141117096, gen p mean: -0.2245015799999237, mean p set: 0.4486429989337921
loss_pred:0.01409174781292677, decouple_loss:0.001872185617685318
The modified gen p mean: 0.44843411445617676, gen p mean: -0.23213091492652893, mean p set: 0.4489628076553345
loss_pred:0.01379029918462038, decouple_loss:0.0017653441755101085
Iteration: 3610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717714190483093, gen p mean: -0.2348213791847229, mean p set: 0.4477514624595642
loss_pred:0.013683908618986607, decouple_loss:0.0020422632806003094
The modified gen p mean: 0.4484401345252991, gen p mean: -0.23230695724487305, mean p set: 0.4490176737308502
loss_pred:0.01389345619827509, decouple_loss:0.0019234170904383063
The modified gen p mean: 0.44865381717681885, gen p mean: -0.23164249956607819, mean p set: 0.449184387922287
loss_pred:0.013808132149279118, decouple_loss:0.001948032877407968
2023-04-27 17:18:42 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2377776801586151, mean p set: 0.4499112665653229
loss_pred:0.01614534668624401, decouple_loss:0.0020288482774049044
The modified gen p mean: 0.44930315017700195, gen p mean: -0.23794996738433838, mean p set: 0.4498290419578552
loss_pred:0.01571555621922016, decouple_loss:0.0019117580959573388
The modified gen p mean: 0.4482175409793854, gen p mean: -0.23525381088256836, mean p set: 0.44879910349845886
loss_pred:0.016092970967292786, decouple_loss:0.0020334457512944937
WV_1_PC_1_EH_0_PS_30, loss: 0.01608419232070446, avg_mse: 0.02392958104610443
current test mse: 0.02393
Iteration: 3611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469844698905945, gen p mean: -0.2405432015657425, mean p set: 0.44756677746772766
loss_pred:0.014134843833744526, decouple_loss:0.0020747368689626455
The modified gen p mean: 0.4480398893356323, gen p mean: -0.23857976496219635, mean p set: 0.4486168920993805
loss_pred:0.013898811303079128, decouple_loss:0.002063044346868992
The modified gen p mean: 0.4473804533481598, gen p mean: -0.23800255358219147, mean p set: 0.44790735840797424
loss_pred:0.014008910395205021, decouple_loss:0.001787521643564105
Iteration: 3612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477977454662323, gen p mean: -0.23419679701328278, mean p set: 0.44832685589790344
loss_pred:0.014043056406080723, decouple_loss:0.0025868446100503206
The modified gen p mean: 0.4467208981513977, gen p mean: -0.23906640708446503, mean p set: 0.44729676842689514
The modified gen p mean: 0.4479062855243683, gen p mean: -0.24228724837303162, mean p set: 0.4484791159629822
loss_pred:0.014156910590827465, decouple_loss:0.0022708848118782043
loss_pred:0.013997495174407959, decouple_loss:0.0024820701219141483
Iteration: 3613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803857803344727, gen p mean: -0.23198100924491882, mean p set: 0.4485653042793274
loss_pred:0.013361489400267601, decouple_loss:0.001913633430376649
The modified gen p mean: 0.4482935070991516, gen p mean: -0.23090960085391998, mean p set: 0.4488696753978729
The modified gen p mean: 0.44881948828697205, gen p mean: -0.23039701581001282, mean p set: 0.4493965804576874
loss_pred:0.01356079988181591, decouple_loss:0.002275338163599372
loss_pred:0.013616821728646755, decouple_loss:0.0021369110327214003
Iteration: 3614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472695291042328, gen p mean: -0.2362642139196396, mean p set: 0.4478025436401367
loss_pred:0.01388715859502554, decouple_loss:0.0028625396080315113
The modified gen p mean: 0.4469965100288391, gen p mean: -0.22980423271656036, mean p set: 0.4475743770599365
The modified gen p mean: 0.4470755457878113, gen p mean: -0.23530152440071106, mean p set: 0.44765228033065796
loss_pred:0.015072871930897236, decouple_loss:0.0026865859981626272
loss_pred:0.014404362998902798, decouple_loss:0.002379748970270157
Iteration: 3615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645535945892334, gen p mean: -0.22974689304828644, mean p set: 0.4470299780368805
loss_pred:0.014523695223033428, decouple_loss:0.0021457448601722717
The modified gen p mean: 0.4462040364742279, gen p mean: -0.23452694714069366, mean p set: 0.44677630066871643
loss_pred:0.014642839320003986, decouple_loss:0.002088062698021531
The modified gen p mean: 0.44740623235702515, gen p mean: -0.23634806275367737, mean p set: 0.44793838262557983
loss_pred:0.013966713100671768, decouple_loss:0.0024456102401018143
Iteration: 3616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469936192035675, gen p mean: -0.22998221218585968, mean p set: 0.44756919145584106
loss_pred:0.01485960278660059, decouple_loss:0.002355315489694476
The modified gen p mean: 0.448252409696579, gen p mean: -0.22961623966693878, mean p set: 0.44877946376800537The modified gen p mean: 0.4480920135974884, gen p mean: -0.22972339391708374, mean p set: 0.4486709535121918
loss_pred:0.013458697125315666, decouple_loss:0.0023964690044522285
loss_pred:0.013469741679728031, decouple_loss:0.002434223424643278
Iteration: 3617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473753273487091, gen p mean: -0.23833417892456055, mean p set: 0.44795170426368713
loss_pred:0.014001568779349327, decouple_loss:0.002245292067527771
The modified gen p mean: 0.4479999244213104, gen p mean: -0.2378770112991333, mean p set: 0.4485274851322174The modified gen p mean: 0.4473721981048584, gen p mean: -0.23520803451538086, mean p set: 0.4479469656944275
loss_pred:0.01402469165623188, decouple_loss:0.0022319492418318987
loss_pred:0.014168296940624714, decouple_loss:0.002102792728692293
Iteration: 3618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879573583602905, gen p mean: -0.22554337978363037, mean p set: 0.44937291741371155
loss_pred:0.013971015810966492, decouple_loss:0.0023678785655647516
The modified gen p mean: 0.44712039828300476, gen p mean: -0.23166051506996155, mean p set: 0.4476914703845978
loss_pred:0.014309126883745193, decouple_loss:0.002397883916273713
The modified gen p mean: 0.4470047354698181, gen p mean: -0.23207184672355652, mean p set: 0.4475267231464386
loss_pred:0.014073213562369347, decouple_loss:0.0024272194132208824
Iteration: 3619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780462980270386, gen p mean: -0.22324372828006744, mean p set: 0.4483802020549774
loss_pred:0.013684253208339214, decouple_loss:0.0019106713589280844
The modified gen p mean: 0.4467446208000183, gen p mean: -0.23382917046546936, mean p set: 0.4473215639591217
loss_pred:0.014249135740101337, decouple_loss:0.0019016093574464321
The modified gen p mean: 0.44657814502716064, gen p mean: -0.22324924170970917, mean p set: 0.447108656167984
loss_pred:0.013609468005597591, decouple_loss:0.0019250646000728011
Iteration: 3620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447786420583725, gen p mean: -0.23019203543663025, mean p set: 0.44836175441741943
loss_pred:0.013857701793313026, decouple_loss:0.0019120716024190187
The modified gen p mean: 0.44753333926200867, gen p mean: -0.22213512659072876, mean p set: 0.4481112062931061
loss_pred:0.014675815589725971, decouple_loss:0.0021918301936239004
The modified gen p mean: 0.4464651644229889, gen p mean: -0.22358936071395874, mean p set: 0.4469953179359436
loss_pred:0.013887313194572926, decouple_loss:0.002047476824373007
2023-04-27 17:22:08 testing...
The modified gen p mean: 0.4482197165489197, gen p mean: -0.2261463701725006, mean p set: 0.44879910349845886
loss_pred:0.01611008308827877, decouple_loss:0.0018274930771440268
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22891521453857422, mean p set: 0.4499112665653229
loss_pred:0.016152193769812584, decouple_loss:0.0019106342224404216
The modified gen p mean: 0.44930246472358704, gen p mean: -0.2289631962776184, mean p set: 0.4498290419578552
loss_pred:0.015779687091708183, decouple_loss:0.0018688850104808807
WV_1_PC_1_EH_0_PS_30, loss: 0.016107438132166862, avg_mse: 0.023973241448402405
current test mse: 0.023973
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 3621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836658239364624, gen p mean: -0.22247284650802612, mean p set: 0.4488963484764099
loss_pred:0.013924806378781796, decouple_loss:0.0021716495975852013
The modified gen p mean: 0.448733925819397, gen p mean: -0.22935976088047028, mean p set: 0.4493098258972168
loss_pred:0.013570123352110386, decouple_loss:0.0019104289822280407
The modified gen p mean: 0.4484824240207672, gen p mean: -0.22199605405330658, mean p set: 0.44906049966812134
loss_pred:0.013795694336295128, decouple_loss:0.0020758758764714003
Iteration: 3622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476134181022644, gen p mean: -0.2303358018398285, mean p set: 0.4481406807899475
loss_pred:0.013914423994719982, decouple_loss:0.001977806445211172
The modified gen p mean: 0.4489056169986725, gen p mean: -0.2271055430173874, mean p set: 0.44948315620422363
The modified gen p mean: 0.4491974115371704, gen p mean: -0.2260502129793167, mean p set: 0.44976967573165894
loss_pred:0.013865184970200062, decouple_loss:0.0017003590473905206
loss_pred:0.013653326779603958, decouple_loss:0.0019198788795620203
Iteration: 3623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487168490886688, gen p mean: -0.23455503582954407, mean p set: 0.44924888014793396
loss_pred:0.01363059226423502, decouple_loss:0.001914943102747202
The modified gen p mean: 0.44651567935943604, gen p mean: -0.23464587330818176, mean p set: 0.44709157943725586
The modified gen p mean: 0.44892361760139465, gen p mean: -0.23091037571430206, mean p set: 0.44950512051582336
loss_pred:0.014033720828592777, decouple_loss:0.002120578195899725
loss_pred:0.013685096055269241, decouple_loss:0.0017249411903321743
Iteration: 3624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731298089027405, gen p mean: -0.22911350429058075, mean p set: 0.4478890001773834
loss_pred:0.014014781452715397, decouple_loss:0.0018869105260819197
The modified gen p mean: 0.4472721517086029, gen p mean: -0.2267383486032486, mean p set: 0.44784975051879883The modified gen p mean: 0.44825902581214905, gen p mean: -0.23478414118289948, mean p set: 0.44878509640693665
loss_pred:0.013303873129189014, decouple_loss:0.0021140894386917353
loss_pred:0.013989447616040707, decouple_loss:0.0021097324788570404
Iteration: 3625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480607509613037, gen p mean: -0.23376736044883728, mean p set: 0.44863414764404297
loss_pred:0.013344330713152885, decouple_loss:0.002298969542607665
The modified gen p mean: 0.44718536734580994, gen p mean: -0.2300451695919037, mean p set: 0.447760671377182
loss_pred:0.013848687522113323, decouple_loss:0.0023019860964268446
The modified gen p mean: 0.44640377163887024, gen p mean: -0.23028545081615448, mean p set: 0.4469376802444458
loss_pred:0.014175865799188614, decouple_loss:0.0025033021811395884
Iteration: 3626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44927963614463806, gen p mean: -0.22454944252967834, mean p set: 0.44985491037368774
loss_pred:0.013943289406597614, decouple_loss:0.001816696603782475
The modified gen p mean: 0.44683581590652466, gen p mean: -0.22723829746246338, mean p set: 0.44741132855415344The modified gen p mean: 0.4481874108314514, gen p mean: -0.2316053807735443, mean p set: 0.4487130343914032
loss_pred:0.014209098182618618, decouple_loss:0.0019737600814551115
loss_pred:0.013711925595998764, decouple_loss:0.001794304233044386
Iteration: 3627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725501537323, gen p mean: -0.22219794988632202, mean p set: 0.44782590866088867
loss_pred:0.014004867523908615, decouple_loss:0.002597331302240491
The modified gen p mean: 0.4485021233558655, gen p mean: -0.2259456068277359, mean p set: 0.449078768491745
loss_pred:0.013656139373779297, decouple_loss:0.0023864901158958673
The modified gen p mean: 0.44879958033561707, gen p mean: -0.22658786177635193, mean p set: 0.4493320882320404
loss_pred:0.01361160073429346, decouple_loss:0.0021956833079457283
Iteration: 3628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630759954452515, gen p mean: -0.22241926193237305, mean p set: 0.4468816816806793
loss_pred:0.014256280846893787, decouple_loss:0.002435617847368121
The modified gen p mean: 0.4488540291786194, gen p mean: -0.22232216596603394, mean p set: 0.4493766129016876The modified gen p mean: 0.4490058720111847, gen p mean: -0.22094732522964478, mean p set: 0.4495809078216553
loss_pred:0.013852550648152828, decouple_loss:0.002011662581935525
loss_pred:0.013667150400578976, decouple_loss:0.0019921581260859966
Iteration: 3629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491020739078522, gen p mean: -0.2274247705936432, mean p set: 0.4496791362762451
loss_pred:0.013722851872444153, decouple_loss:0.0024450947530567646
The modified gen p mean: 0.4472138583660126, gen p mean: -0.22990818321704865, mean p set: 0.4477921724319458
loss_pred:0.013837681151926517, decouple_loss:0.001840115524828434
The modified gen p mean: 0.44813305139541626, gen p mean: -0.22699446976184845, mean p set: 0.44866541028022766
loss_pred:0.013853455893695354, decouple_loss:0.0019630028400570154
Iteration: 3630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478048086166382, gen p mean: -0.2267695963382721, mean p set: 0.44838523864746094
loss_pred:0.014347758144140244, decouple_loss:0.0019770723301917315
The modified gen p mean: 0.4478422701358795, gen p mean: -0.22544172406196594, mean p set: 0.44841745495796204
loss_pred:0.013357583433389664, decouple_loss:0.00197000615298748
The modified gen p mean: 0.4481884241104126, gen p mean: -0.23277537524700165, mean p set: 0.4487197697162628
loss_pred:0.014005928300321102, decouple_loss:0.002002584980800748
2023-04-27 17:26:11 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2365606725215912, mean p set: 0.4499112665653229
loss_pred:0.01613980531692505, decouple_loss:0.0019022980704903603
The modified gen p mean: 0.4492979943752289, gen p mean: -0.23685607314109802, mean p set: 0.4498290419578552
loss_pred:0.015731453895568848, decouple_loss:0.001966406824067235
The modified gen p mean: 0.44821804761886597, gen p mean: -0.23403611779212952, mean p set: 0.44879910349845886
loss_pred:0.016020065173506737, decouple_loss:0.0019330655923113227
WV_1_PC_1_EH_0_PS_30, loss: 0.016060469672083855, avg_mse: 0.023891691118478775
current test mse: 0.023892
Iteration: 3631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447562038898468, gen p mean: -0.2330002784729004, mean p set: 0.4481384754180908
loss_pred:0.013185377232730389, decouple_loss:0.0018858736148104072
The modified gen p mean: 0.44771096110343933, gen p mean: -0.23204641044139862, mean p set: 0.44823670387268066
loss_pred:0.013613050803542137, decouple_loss:0.0019144732505083084
The modified gen p mean: 0.446837455034256, gen p mean: -0.23795157670974731, mean p set: 0.44741183519363403
loss_pred:0.013903857208788395, decouple_loss:0.0017978111281991005
Iteration: 3632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721120595932007, gen p mean: -0.23668919503688812, mean p set: 0.4477404057979584
loss_pred:0.013957152143120766, decouple_loss:0.0023425628896802664
The modified gen p mean: 0.4499416947364807, gen p mean: -0.2318962961435318, mean p set: 0.4505167305469513
The modified gen p mean: 0.4471028447151184, gen p mean: -0.23728668689727783, mean p set: 0.4476757347583771
loss_pred:0.014015275985002518, decouple_loss:0.002040014136582613
loss_pred:0.01384256687015295, decouple_loss:0.0017882530810311437
Iteration: 3633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866397976875305, gen p mean: -0.24008949100971222, mean p set: 0.4491964280605316
loss_pred:0.013416587375104427, decouple_loss:0.0019455136498436332
The modified gen p mean: 0.44913938641548157, gen p mean: -0.23923130333423615, mean p set: 0.4497106075286865
The modified gen p mean: 0.44741296768188477, gen p mean: -0.23854829370975494, mean p set: 0.44798991084098816
loss_pred:0.01370072178542614, decouple_loss:0.0019458458991721272
loss_pred:0.013213755562901497, decouple_loss:0.001823970815166831
Iteration: 3634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482291042804718, gen p mean: -0.23419462144374847, mean p set: 0.4487580358982086
loss_pred:0.012963956221938133, decouple_loss:0.0019484489457681775
The modified gen p mean: 0.4486725926399231, gen p mean: -0.22786381840705872, mean p set: 0.44924619793891907
The modified gen p mean: 0.4469490051269531, gen p mean: -0.23480014503002167, mean p set: 0.44752633571624756
loss_pred:0.013633748516440392, decouple_loss:0.0019402833422645926
loss_pred:0.013074054382741451, decouple_loss:0.001756432931870222
Iteration: 3635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729098677635193, gen p mean: -0.23566369712352753, mean p set: 0.44786572456359863
loss_pred:0.013458503410220146, decouple_loss:0.0019365918124094605
The modified gen p mean: 0.44691601395606995, gen p mean: -0.22982850670814514, mean p set: 0.44749414920806885The modified gen p mean: 0.44744551181793213, gen p mean: -0.23554813861846924, mean p set: 0.4479677379131317
loss_pred:0.013938912190496922, decouple_loss:0.0020129664335399866
loss_pred:0.013273214921355247, decouple_loss:0.0019067322136834264
Iteration: 3636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470641314983368, gen p mean: -0.23591889441013336, mean p set: 0.4476434886455536
loss_pred:0.013653929345309734, decouple_loss:0.0018252000445500016
The modified gen p mean: 0.44792941212654114, gen p mean: -0.23351700603961945, mean p set: 0.4485096037387848
loss_pred:0.01376122236251831, decouple_loss:0.0019260614644736052
The modified gen p mean: 0.44613081216812134, gen p mean: -0.23308958113193512, mean p set: 0.4466628134250641
loss_pred:0.014213429763913155, decouple_loss:0.001881071599200368
Iteration: 3637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492330849170685, gen p mean: -0.23197612166404724, mean p set: 0.4498105049133301
loss_pred:0.013914085924625397, decouple_loss:0.0023509382735937834
The modified gen p mean: 0.44592317938804626, gen p mean: -0.2355332374572754, mean p set: 0.4464992880821228The modified gen p mean: 0.44701698422431946, gen p mean: -0.2349952608346939, mean p set: 0.44753846526145935
loss_pred:0.014130059629678726, decouple_loss:0.0019136437913402915
loss_pred:0.014097797684371471, decouple_loss:0.0018826407613232732
Iteration: 3638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477309286594391, gen p mean: -0.22912588715553284, mean p set: 0.4483111500740051
loss_pred:0.013951243832707405, decouple_loss:0.0024417194072157145
The modified gen p mean: 0.4496263563632965, gen p mean: -0.23278400301933289, mean p set: 0.45020049810409546
loss_pred:0.013438164256513119, decouple_loss:0.0020688653457909822
The modified gen p mean: 0.4491676986217499, gen p mean: -0.2317015528678894, mean p set: 0.44969815015792847
loss_pred:0.01378316804766655, decouple_loss:0.002095527481287718
Iteration: 3639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779643416404724, gen p mean: -0.2346203327178955, mean p set: 0.4483746588230133
loss_pred:0.013907250948250294, decouple_loss:0.0029506662394851446
The modified gen p mean: 0.44878193736076355, gen p mean: -0.23700851202011108, mean p set: 0.4493577182292938
loss_pred:0.013228224590420723, decouple_loss:0.0026489868760108948
The modified gen p mean: 0.44827601313591003, gen p mean: -0.23809438943862915, mean p set: 0.44880014657974243
loss_pred:0.013182204216718674, decouple_loss:0.0024047093465924263
Iteration: 3640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467742443084717, gen p mean: -0.23545728623867035, mean p set: 0.4473493695259094
loss_pred:0.013995611108839512, decouple_loss:0.002177602844312787
The modified gen p mean: 0.4501434862613678, gen p mean: -0.22783663868904114, mean p set: 0.4506722390651703The modified gen p mean: 0.44784674048423767, gen p mean: -0.23298697173595428, mean p set: 0.44842419028282166
loss_pred:0.013810127973556519, decouple_loss:0.0024151576217263937
loss_pred:0.013564673252403736, decouple_loss:0.0024922997690737247
2023-04-27 17:29:36 testing...
The modified gen p mean: 0.44822317361831665, gen p mean: -0.2320285439491272, mean p set: 0.44879910349845886
loss_pred:0.01604895479977131, decouple_loss:0.002292994409799576
The modified gen p mean: 0.4494309425354004, gen p mean: -0.234580397605896, mean p set: 0.4499112665653229
loss_pred:0.016178328543901443, decouple_loss:0.0023681102320551872
The modified gen p mean: 0.4493054747581482, gen p mean: -0.23454004526138306, mean p set: 0.4498290419578552
loss_pred:0.015709569677710533, decouple_loss:0.0021788806188851595
WV_1_PC_1_EH_0_PS_30, loss: 0.016092952340841293, avg_mse: 0.023952612653374672
current test mse: 0.023953
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 3641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768404960632324, gen p mean: -0.2293775975704193, mean p set: 0.44821488857269287
loss_pred:0.01487403828650713, decouple_loss:0.002378137083724141
The modified gen p mean: 0.44736120104789734, gen p mean: -0.2330203503370285, mean p set: 0.4479365348815918
loss_pred:0.015298605896532536, decouple_loss:0.001995340920984745
The modified gen p mean: 0.44694453477859497, gen p mean: -0.23820260167121887, mean p set: 0.44752398133277893
loss_pred:0.014412629418075085, decouple_loss:0.002124388935044408
Iteration: 3642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44646039605140686, gen p mean: -0.23433373868465424, mean p set: 0.4469858705997467
loss_pred:0.015001215040683746, decouple_loss:0.002155168680474162
The modified gen p mean: 0.4465193748474121, gen p mean: -0.23255378007888794, mean p set: 0.44709739089012146
The modified gen p mean: 0.44643634557724, gen p mean: -0.2350553423166275, mean p set: 0.44700896739959717
loss_pred:0.015458473935723305, decouple_loss:0.0021253814920783043
loss_pred:0.014821302145719528, decouple_loss:0.002060450380668044
Iteration: 3643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649577140808105, gen p mean: -0.22992275655269623, mean p set: 0.44702792167663574
loss_pred:0.014643228612840176, decouple_loss:0.001807568478398025
The modified gen p mean: 0.44747400283813477, gen p mean: -0.235617995262146, mean p set: 0.4480500817298889
The modified gen p mean: 0.4465904235839844, gen p mean: -0.2313757836818695, mean p set: 0.44716861844062805
loss_pred:0.014155315235257149, decouple_loss:0.0018334416672587395
loss_pred:0.014683914370834827, decouple_loss:0.0019297268008813262
Iteration: 3644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465583264827728, gen p mean: -0.23294991254806519, mean p set: 0.4471304714679718
loss_pred:0.014960144646465778, decouple_loss:0.002128800842911005
The modified gen p mean: 0.44696250557899475, gen p mean: -0.22913652658462524, mean p set: 0.4475388824939728
loss_pred:0.013946485705673695, decouple_loss:0.002140023745596409
The modified gen p mean: 0.44693002104759216, gen p mean: -0.22870874404907227, mean p set: 0.44745591282844543
loss_pred:0.014759656973183155, decouple_loss:0.002151134191080928
Iteration: 3645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474397599697113, gen p mean: -0.23295007646083832, mean p set: 0.4480128884315491
loss_pred:0.0155215198174119, decouple_loss:0.002277274616062641
The modified gen p mean: 0.44633588194847107, gen p mean: -0.2308499962091446, mean p set: 0.4468649923801422The modified gen p mean: 0.4461579918861389, gen p mean: -0.23343783617019653, mean p set: 0.4467359483242035
loss_pred:0.014939792454242706, decouple_loss:0.002045082626864314
loss_pred:0.014997080899775028, decouple_loss:0.002215950982645154
Iteration: 3646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465690851211548, gen p mean: -0.23675601184368134, mean p set: 0.44714680314064026
loss_pred:0.014842563308775425, decouple_loss:0.0020286692306399345
The modified gen p mean: 0.4469072222709656, gen p mean: -0.2408798485994339, mean p set: 0.44743674993515015The modified gen p mean: 0.4470183849334717, gen p mean: -0.23541979491710663, mean p set: 0.4475901126861572
loss_pred:0.014964149333536625, decouple_loss:0.002251825761049986
loss_pred:0.014601088128983974, decouple_loss:0.002184217097237706
Iteration: 3647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44549819827079773, gen p mean: -0.2343791127204895, mean p set: 0.4460710883140564
loss_pred:0.014279396273195744, decouple_loss:0.0020877004135400057
The modified gen p mean: 0.4466913342475891, gen p mean: -0.2389693707227707, mean p set: 0.44726207852363586
loss_pred:0.01469151210039854, decouple_loss:0.0020396059844642878
The modified gen p mean: 0.4471953213214874, gen p mean: -0.24322953820228577, mean p set: 0.4477214217185974
loss_pred:0.014619894325733185, decouple_loss:0.0017452063038945198
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44662579894065857, gen p mean: -0.2323160320520401, mean p set: 0.4472024440765381
loss_pred:0.014622866176068783, decouple_loss:0.001967870630323887
The modified gen p mean: 0.4458589553833008, gen p mean: -0.23548690974712372, mean p set: 0.44638508558273315The modified gen p mean: 0.4472636878490448, gen p mean: -0.24058225750923157, mean p set: 0.4478432536125183
loss_pred:0.014834129251539707, decouple_loss:0.001754638971760869
loss_pred:0.014475090429186821, decouple_loss:0.001807501306757331
Iteration: 3649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461701512336731, gen p mean: -0.23472079634666443, mean p set: 0.44674646854400635
loss_pred:0.014195322059094906, decouple_loss:0.002107583452016115
The modified gen p mean: 0.44556644558906555, gen p mean: -0.23503053188323975, mean p set: 0.4461430609226227The modified gen p mean: 0.44703835248947144, gen p mean: -0.23643574118614197, mean p set: 0.44756782054901123
loss_pred:0.015315348282456398, decouple_loss:0.0022994191385805607
loss_pred:0.014123146422207355, decouple_loss:0.002317278180271387
Iteration: 3650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44571956992149353, gen p mean: -0.23426292836666107, mean p set: 0.4462953209877014
The modified gen p mean: 0.44741299748420715, gen p mean: -0.23308277130126953, mean p set: 0.4479900598526001
loss_pred:0.013991696760058403, decouple_loss:0.0018283805111423135
loss_pred:0.01506743859499693, decouple_loss:0.00192074419464916
The modified gen p mean: 0.4476672112941742, gen p mean: -0.23159348964691162, mean p set: 0.44819650053977966
loss_pred:0.014356927946209908, decouple_loss:0.0019388998625800014
2023-04-27 17:33:42 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23518072068691254, mean p set: 0.4499112665653229
loss_pred:0.01604039967060089, decouple_loss:0.002574640093371272
The modified gen p mean: 0.44929859042167664, gen p mean: -0.23544448614120483, mean p set: 0.4498290419578552
loss_pred:0.015633225440979004, decouple_loss:0.002078921999782324
The modified gen p mean: 0.4482176899909973, gen p mean: -0.23294086754322052, mean p set: 0.44879910349845886
loss_pred:0.015945876017212868, decouple_loss:0.002068812493234873
WV_1_PC_1_EH_0_PS_30, loss: 0.01598520576953888, avg_mse: 0.02372206561267376
current test mse: 0.023722
Iteration: 3651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748830795288086, gen p mean: -0.23741514980793, mean p set: 0.4480704963207245
loss_pred:0.014893529005348682, decouple_loss:0.0030073202215135098
The modified gen p mean: 0.44667577743530273, gen p mean: -0.24047741293907166, mean p set: 0.44725584983825684
loss_pred:0.014353504404425621, decouple_loss:0.0017855585319921374
The modified gen p mean: 0.4461950659751892, gen p mean: -0.23657546937465668, mean p set: 0.44672611355781555
loss_pred:0.01540055125951767, decouple_loss:0.0019161690725013614
Iteration: 3652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472108781337738, gen p mean: -0.2321562021970749, mean p set: 0.44773682951927185
loss_pred:0.014273164793848991, decouple_loss:0.002095888601616025
The modified gen p mean: 0.44650694727897644, gen p mean: -0.23242734372615814, mean p set: 0.4470832645893097
The modified gen p mean: 0.4471164345741272, gen p mean: -0.2360377162694931, mean p set: 0.4476989209651947
loss_pred:0.014359003864228725, decouple_loss:0.0021066421177238226
loss_pred:0.014709318056702614, decouple_loss:0.0019233378116041422
Iteration: 3653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469253718852997, gen p mean: -0.23984844982624054, mean p set: 0.44745466113090515
loss_pred:0.014348332770168781, decouple_loss:0.002122456906363368
The modified gen p mean: 0.4469142556190491, gen p mean: -0.2338787317276001, mean p set: 0.44749605655670166
The modified gen p mean: 0.4466535747051239, gen p mean: -0.23869141936302185, mean p set: 0.44722431898117065
loss_pred:0.014828826300799847, decouple_loss:0.0020549918990582228
loss_pred:0.014504819177091122, decouple_loss:0.001985873794183135
Iteration: 3654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474196434020996, gen p mean: -0.23229803144931793, mean p set: 0.4479503035545349
loss_pred:0.013749529607594013, decouple_loss:0.0018719827057793736
The modified gen p mean: 0.44785675406455994, gen p mean: -0.23261751234531403, mean p set: 0.4484312832355499
The modified gen p mean: 0.4468706250190735, gen p mean: -0.23004640638828278, mean p set: 0.44745174050331116
loss_pred:0.014686090871691704, decouple_loss:0.0022028021048754454
loss_pred:0.014773765578866005, decouple_loss:0.0020826125983148813
Iteration: 3655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471051096916199, gen p mean: -0.23071667551994324, mean p set: 0.44768035411834717
loss_pred:0.014375478029251099, decouple_loss:0.0017816645558923483
The modified gen p mean: 0.44730448722839355, gen p mean: -0.23095901310443878, mean p set: 0.447883665561676
loss_pred:0.015345899388194084, decouple_loss:0.0019426926737651229
The modified gen p mean: 0.4460676312446594, gen p mean: -0.23073188960552216, mean p set: 0.44659891724586487
loss_pred:0.014765125699341297, decouple_loss:0.0018970061792060733
Iteration: 3656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44598644971847534, gen p mean: -0.2322452813386917, mean p set: 0.4465586841106415
loss_pred:0.015035864897072315, decouple_loss:0.001736968755722046
The modified gen p mean: 0.4464547634124756, gen p mean: -0.23210006952285767, mean p set: 0.44698208570480347The modified gen p mean: 0.44614189863204956, gen p mean: -0.2284826785326004, mean p set: 0.446708619594574
loss_pred:0.01451659481972456, decouple_loss:0.0019134607864543796
loss_pred:0.015511301346123219, decouple_loss:0.001736701000481844
Iteration: 3657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642123579978943, gen p mean: -0.23377466201782227, mean p set: 0.4469989240169525
loss_pred:0.014577183872461319, decouple_loss:0.0019320956198498607
The modified gen p mean: 0.4463975727558136, gen p mean: -0.23382210731506348, mean p set: 0.44696730375289917
The modified gen p mean: 0.4457024931907654, gen p mean: -0.23606717586517334, mean p set: 0.44622352719306946
loss_pred:0.01416744664311409, decouple_loss:0.001867963233962655
loss_pred:0.014912438578903675, decouple_loss:0.001979243941605091
Iteration: 3658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468991756439209, gen p mean: -0.24029041826725006, mean p set: 0.4474724233150482
loss_pred:0.014756237156689167, decouple_loss:0.001999802887439728
The modified gen p mean: 0.4465387463569641, gen p mean: -0.2391580194234848, mean p set: 0.44706523418426514The modified gen p mean: 0.4464477300643921, gen p mean: -0.23178035020828247, mean p set: 0.4470199644565582
loss_pred:0.014394092373549938, decouple_loss:0.001906280405819416
loss_pred:0.014575058594346046, decouple_loss:0.001879046787507832
Iteration: 3659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477500021457672, gen p mean: -0.23960019648075104, mean p set: 0.4483300447463989
loss_pred:0.014777551405131817, decouple_loss:0.0018713267054408789
The modified gen p mean: 0.4475679397583008, gen p mean: -0.23391562700271606, mean p set: 0.4480966627597809
The modified gen p mean: 0.4462490379810333, gen p mean: -0.23660825192928314, mean p set: 0.4468272626399994
loss_pred:0.015036341734230518, decouple_loss:0.0019022597698494792
loss_pred:0.014734771102666855, decouple_loss:0.0017627534689381719
Iteration: 3660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751331210136414, gen p mean: -0.24025222659111023, mean p set: 0.4480864405632019
loss_pred:0.014415700919926167, decouple_loss:0.001954480307176709
The modified gen p mean: 0.44589343667030334, gen p mean: -0.23913538455963135, mean p set: 0.4464685022830963
loss_pred:0.015116649679839611, decouple_loss:0.002101989695802331
The modified gen p mean: 0.44625821709632874, gen p mean: -0.23841704428195953, mean p set: 0.44678789377212524
loss_pred:0.014105292968451977, decouple_loss:0.0018677380867302418
2023-04-27 17:37:06 testing...
The modified gen p mean: 0.4482259154319763, gen p mean: -0.23560582101345062, mean p set: 0.44879910349845886
loss_pred:0.01591944880783558, decouple_loss:0.0018690364668145776
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23777486383914948, mean p set: 0.4499112665653229
loss_pred:0.016051722690463066, decouple_loss:0.0018502607708796859
The modified gen p mean: 0.4493029713630676, gen p mean: -0.23819342255592346, mean p set: 0.4498290419578552
loss_pred:0.015637818723917007, decouple_loss:0.001804834115318954
WV_1_PC_1_EH_0_PS_30, loss: 0.01596173271536827, avg_mse: 0.02374252863228321
current test mse: 0.023743
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 3661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846972823143005, gen p mean: -0.23747649788856506, mean p set: 0.44899824261665344
loss_pred:0.0143698425963521, decouple_loss:0.0021556783467531204
The modified gen p mean: 0.4474083185195923, gen p mean: -0.23721185326576233, mean p set: 0.44798544049263
loss_pred:0.015268813818693161, decouple_loss:0.0019064719090238214
The modified gen p mean: 0.44646865129470825, gen p mean: -0.24444980919361115, mean p set: 0.44703981280326843
loss_pred:0.014936107210814953, decouple_loss:0.0022723940201103687
Iteration: 3662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468637704849243, gen p mean: -0.23303574323654175, mean p set: 0.44738900661468506
loss_pred:0.014165631495416164, decouple_loss:0.0022838201839476824
The modified gen p mean: 0.4468497335910797, gen p mean: -0.23405779898166656, mean p set: 0.4474294185638428
loss_pred:0.013994989916682243, decouple_loss:0.0023173207882791758
The modified gen p mean: 0.446949303150177, gen p mean: -0.2336909919977188, mean p set: 0.44752857089042664
loss_pred:0.014418529346585274, decouple_loss:0.0025948365218937397
Iteration: 3663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466288387775421, gen p mean: -0.2350933998823166, mean p set: 0.4471592903137207
loss_pred:0.014186794869601727, decouple_loss:0.0020406446419656277
The modified gen p mean: 0.4474874436855316, gen p mean: -0.23742452263832092, mean p set: 0.4480628967285156
loss_pred:0.014593553729355335, decouple_loss:0.002144821919500828
The modified gen p mean: 0.44683638215065, gen p mean: -0.23679421842098236, mean p set: 0.4474082589149475
loss_pred:0.015483739785850048, decouple_loss:0.002010130323469639
Iteration: 3664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44623836874961853, gen p mean: -0.2415609061717987, mean p set: 0.44677209854125977
loss_pred:0.014792857691645622, decouple_loss:0.0025283172726631165
The modified gen p mean: 0.44766926765441895, gen p mean: -0.23964574933052063, mean p set: 0.4482457637786865
loss_pred:0.014235224574804306, decouple_loss:0.0023578184191137552
The modified gen p mean: 0.44657135009765625, gen p mean: -0.23243506252765656, mean p set: 0.44714486598968506
loss_pred:0.013838158920407295, decouple_loss:0.0021783695556223392
Iteration: 3665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686946272850037, gen p mean: -0.23326656222343445, mean p set: 0.44744372367858887
loss_pred:0.014662296511232853, decouple_loss:0.0020729410462081432
The modified gen p mean: 0.4479627311229706, gen p mean: -0.23578208684921265, mean p set: 0.4484971761703491The modified gen p mean: 0.4482242465019226, gen p mean: -0.2326817810535431, mean p set: 0.448797345161438
loss_pred:0.014763296581804752, decouple_loss:0.002097891643643379
loss_pred:0.014040294103324413, decouple_loss:0.0021575684659183025
Iteration: 3666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815587997436523, gen p mean: -0.23052896559238434, mean p set: 0.4487267732620239
loss_pred:0.014407865703105927, decouple_loss:0.002176891779527068
The modified gen p mean: 0.4493609070777893, gen p mean: -0.22785620391368866, mean p set: 0.44989389181137085The modified gen p mean: 0.44753456115722656, gen p mean: -0.2246994823217392, mean p set: 0.4481060206890106
loss_pred:0.014958328567445278, decouple_loss:0.0021466214675456285
loss_pred:0.014052024111151695, decouple_loss:0.0021713615860790014
Iteration: 3667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470677375793457, gen p mean: -0.2198178470134735, mean p set: 0.4476413428783417
loss_pred:0.014437445439398289, decouple_loss:0.0022922083735466003
The modified gen p mean: 0.44835788011550903, gen p mean: -0.22288082540035248, mean p set: 0.4489316940307617The modified gen p mean: 0.4476066827774048, gen p mean: -0.22876551747322083, mean p set: 0.44813334941864014
loss_pred:0.014156351797282696, decouple_loss:0.0023851818405091763
loss_pred:0.014272399246692657, decouple_loss:0.002134906593710184
Iteration: 3668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468221366405487, gen p mean: -0.2310255467891693, mean p set: 0.4473989009857178
loss_pred:0.01539588626474142, decouple_loss:0.001937356311827898
The modified gen p mean: 0.4479634165763855, gen p mean: -0.2261032611131668, mean p set: 0.4484897553920746The modified gen p mean: 0.44803866744041443, gen p mean: -0.22611305117607117, mean p set: 0.44861525297164917
loss_pred:0.015134593471884727, decouple_loss:0.0022508359979838133
loss_pred:0.014398246072232723, decouple_loss:0.0021240145433694124
Iteration: 3669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471856355667114, gen p mean: -0.22950956225395203, mean p set: 0.4477604627609253
loss_pred:0.014496805146336555, decouple_loss:0.002077233511954546
The modified gen p mean: 0.4463697075843811, gen p mean: -0.23810650408267975, mean p set: 0.4469473958015442
loss_pred:0.014747426845133305, decouple_loss:0.0021028483752161264
The modified gen p mean: 0.44749438762664795, gen p mean: -0.22989696264266968, mean p set: 0.44802284240722656
loss_pred:0.014117313548922539, decouple_loss:0.0022752592340111732
Iteration: 3670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469447731971741, gen p mean: -0.2300780862569809, mean p set: 0.44751542806625366
loss_pred:0.014035461470484734, decouple_loss:0.0019520251080393791
The modified gen p mean: 0.44738754630088806, gen p mean: -0.2325887233018875, mean p set: 0.4479648470878601
loss_pred:0.014549282379448414, decouple_loss:0.0018361967522650957
The modified gen p mean: 0.4464697241783142, gen p mean: -0.2391965687274933, mean p set: 0.44699788093566895
loss_pred:0.014848328195512295, decouple_loss:0.0018148362869396806
2023-04-27 17:41:10 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23231345415115356, mean p set: 0.4499112665653229
loss_pred:0.016123328357934952, decouple_loss:0.0023587490431964397
The modified gen p mean: 0.4493066072463989, gen p mean: -0.23255576193332672, mean p set: 0.4498290419578552
loss_pred:0.015699222683906555, decouple_loss:0.002413475187495351
The modified gen p mean: 0.448225200176239, gen p mean: -0.2297576665878296, mean p set: 0.44879910349845886
loss_pred:0.016044287011027336, decouple_loss:0.002380645601078868
WV_1_PC_1_EH_0_PS_30, loss: 0.016074826940894127, avg_mse: 0.023958958685398102
current test mse: 0.023959
Iteration: 3671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475022852420807, gen p mean: -0.2361513376235962, mean p set: 0.44807443022727966
loss_pred:0.01412247121334076, decouple_loss:0.0020502498373389244
The modified gen p mean: 0.4465518295764923, gen p mean: -0.2323118895292282, mean p set: 0.4470820426940918
loss_pred:0.014633123762905598, decouple_loss:0.001964340917766094
The modified gen p mean: 0.4489095211029053, gen p mean: -0.23389507830142975, mean p set: 0.4494958221912384
loss_pred:0.014502367004752159, decouple_loss:0.0019451465923339128
Iteration: 3672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733133912086487, gen p mean: -0.23046478629112244, mean p set: 0.4478605389595032
loss_pred:0.015105928294360638, decouple_loss:0.0019127273699268699
The modified gen p mean: 0.4476219117641449, gen p mean: -0.22853520512580872, mean p set: 0.44820234179496765
The modified gen p mean: 0.4472552239894867, gen p mean: -0.22844596207141876, mean p set: 0.4478318989276886
loss_pred:0.014717092737555504, decouple_loss:0.0019031176343560219
loss_pred:0.015159085392951965, decouple_loss:0.0019251367775723338
Iteration: 3673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680848717689514, gen p mean: -0.23189590871334076, mean p set: 0.44733917713165283
loss_pred:0.014512654393911362, decouple_loss:0.0019879965111613274
The modified gen p mean: 0.44680023193359375, gen p mean: -0.22823567688465118, mean p set: 0.44737815856933594
The modified gen p mean: 0.44820496439933777, gen p mean: -0.23435352742671967, mean p set: 0.4487859904766083
loss_pred:0.014478727243840694, decouple_loss:0.0022187181748449802
loss_pred:0.014476352371275425, decouple_loss:0.002100288402289152
Iteration: 3674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682690501213074, gen p mean: -0.22694726288318634, mean p set: 0.4473569989204407
loss_pred:0.01381917204707861, decouple_loss:0.002100202487781644
The modified gen p mean: 0.446955144405365, gen p mean: -0.23075026273727417, mean p set: 0.44753316044807434
The modified gen p mean: 0.4483342170715332, gen p mean: -0.23334896564483643, mean p set: 0.44890403747558594
loss_pred:0.015481514856219292, decouple_loss:0.0020812135189771652
loss_pred:0.014296891167759895, decouple_loss:0.0020043395925313234
Iteration: 3675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467035233974457, gen p mean: -0.23098702728748322, mean p set: 0.44728177785873413
loss_pred:0.01504447590559721, decouple_loss:0.0025561759248375893
The modified gen p mean: 0.44757992029190063, gen p mean: -0.22967389225959778, mean p set: 0.4481104910373688
The modified gen p mean: 0.44679152965545654, gen p mean: -0.230587437748909, mean p set: 0.44736534357070923
loss_pred:0.014980274252593517, decouple_loss:0.0024716921616345644
loss_pred:0.014103014953434467, decouple_loss:0.00213862513191998
Iteration: 3676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44637975096702576, gen p mean: -0.2257256805896759, mean p set: 0.4469609558582306
loss_pred:0.013802018016576767, decouple_loss:0.0021826012525707483
The modified gen p mean: 0.44630858302116394, gen p mean: -0.2309027910232544, mean p set: 0.4468388855457306The modified gen p mean: 0.44714200496673584, gen p mean: -0.22723223268985748, mean p set: 0.4477183520793915
loss_pred:0.015573635697364807, decouple_loss:0.001917762914672494
loss_pred:0.014773868024349213, decouple_loss:0.001994431484490633
Iteration: 3677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475378096103668, gen p mean: -0.2318287193775177, mean p set: 0.4481140077114105
loss_pred:0.014135689474642277, decouple_loss:0.0020981922280043364
The modified gen p mean: 0.44793733954429626, gen p mean: -0.22756437957286835, mean p set: 0.44846174120903015The modified gen p mean: 0.4467724561691284, gen p mean: -0.23578965663909912, mean p set: 0.4473494589328766
loss_pred:0.015315845608711243, decouple_loss:0.0021161974873393774
loss_pred:0.014425819739699364, decouple_loss:0.002039522398263216
Iteration: 3678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465710520744324, gen p mean: -0.22315376996994019, mean p set: 0.4471484422683716
loss_pred:0.01403558999300003, decouple_loss:0.002136444905772805
The modified gen p mean: 0.4491492509841919, gen p mean: -0.2267989069223404, mean p set: 0.4497283697128296
loss_pred:0.013996979221701622, decouple_loss:0.002096927259117365
The modified gen p mean: 0.44956061244010925, gen p mean: -0.2267037332057953, mean p set: 0.4500883221626282
loss_pred:0.01385484728962183, decouple_loss:0.0020554945804178715
Iteration: 3679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768044352531433, gen p mean: -0.2286732792854309, mean p set: 0.4482575058937073
loss_pred:0.014496510848402977, decouple_loss:0.0022052116692066193
The modified gen p mean: 0.4474562704563141, gen p mean: -0.22379203140735626, mean p set: 0.44803139567375183
loss_pred:0.01475918386131525, decouple_loss:0.0025777691043913364
The modified gen p mean: 0.44629043340682983, gen p mean: -0.22978655993938446, mean p set: 0.4468221068382263
loss_pred:0.01445883046835661, decouple_loss:0.002443247474730015
Iteration: 3680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485190212726593, gen p mean: -0.22273056209087372, mean p set: 0.449098140001297
loss_pred:0.014536399394273758, decouple_loss:0.0019109881250187755
The modified gen p mean: 0.44657236337661743, gen p mean: -0.2299422323703766, mean p set: 0.4471015930175781The modified gen p mean: 0.4483998715877533, gen p mean: -0.22808171808719635, mean p set: 0.44897395372390747
loss_pred:0.014444670639932156, decouple_loss:0.0019629138987511396
loss_pred:0.015450076200067997, decouple_loss:0.001829817658290267
2023-04-27 17:44:36 testing...
The modified gen p mean: 0.4482259750366211, gen p mean: -0.22165291011333466, mean p set: 0.44879910349845886
loss_pred:0.015962371602654457, decouple_loss:0.0023879329673945904
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22417837381362915, mean p set: 0.4499112665653229
loss_pred:0.016137560829520226, decouple_loss:0.002310563111677766
The modified gen p mean: 0.4492972195148468, gen p mean: -0.22431997954845428, mean p set: 0.4498290419578552
loss_pred:0.015720291063189507, decouple_loss:0.002348869340494275
WV_1_PC_1_EH_0_PS_30, loss: 0.016057532280683517, avg_mse: 0.02387191168963909
current test mse: 0.023872
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 3681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464907646179199, gen p mean: -0.22617509961128235, mean p set: 0.4470173120498657
loss_pred:0.014829840511083603, decouple_loss:0.002180985175073147
The modified gen p mean: 0.44573935866355896, gen p mean: -0.22988080978393555, mean p set: 0.44631776213645935
The modified gen p mean: 0.4479554295539856, gen p mean: -0.22522473335266113, mean p set: 0.448532372713089
loss_pred:0.01461621280759573, decouple_loss:0.002396812429651618
loss_pred:0.015266414731740952, decouple_loss:0.0019975355826318264
Iteration: 3682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455486238002777, gen p mean: -0.23070482909679413, mean p set: 0.4460800588130951
loss_pred:0.014732474461197853, decouple_loss:0.0022069436963647604
The modified gen p mean: 0.4475272297859192, gen p mean: -0.22770321369171143, mean p set: 0.44809842109680176
loss_pred:0.015193052589893341, decouple_loss:0.002246481366455555
The modified gen p mean: 0.44647082686424255, gen p mean: -0.22845590114593506, mean p set: 0.44704657793045044
loss_pred:0.01541188545525074, decouple_loss:0.001923142815940082
Iteration: 3683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665682315826416, gen p mean: -0.23594744503498077, mean p set: 0.4471801817417145
loss_pred:0.015636945143342018, decouple_loss:0.0017891689203679562
The modified gen p mean: 0.44755157828330994, gen p mean: -0.2285691201686859, mean p set: 0.44813206791877747
loss_pred:0.015307418070733547, decouple_loss:0.0020428986754268408
The modified gen p mean: 0.4470977187156677, gen p mean: -0.22970233857631683, mean p set: 0.44766902923583984
loss_pred:0.014862120151519775, decouple_loss:0.0022489435505121946
Iteration: 3684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642123579978943, gen p mean: -0.2370341569185257, mean p set: 0.44695183634757996
loss_pred:0.015170692466199398, decouple_loss:0.002285882830619812
The modified gen p mean: 0.44768962264060974, gen p mean: -0.23588159680366516, mean p set: 0.4482622444629669
loss_pred:0.015364402905106544, decouple_loss:0.0020631204824894667
The modified gen p mean: 0.4466798007488251, gen p mean: -0.23313988745212555, mean p set: 0.44725537300109863
loss_pred:0.014639837667346, decouple_loss:0.0020328215323388577
Iteration: 3685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464423358440399, gen p mean: -0.22876501083374023, mean p set: 0.4470142424106598
loss_pred:0.014698767103254795, decouple_loss:0.001707689487375319
The modified gen p mean: 0.4463600218296051, gen p mean: -0.23351599276065826, mean p set: 0.4469307065010071The modified gen p mean: 0.4469190835952759, gen p mean: -0.22737309336662292, mean p set: 0.44744786620140076
loss_pred:0.015861697494983673, decouple_loss:0.0017624656902626157loss_pred:0.015138098038733006, decouple_loss:0.001768752234056592
Iteration: 3686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459683895111084, gen p mean: -0.22915369272232056, mean p set: 0.44655176997184753
loss_pred:0.01535244844853878, decouple_loss:0.0018207243410870433
The modified gen p mean: 0.44655388593673706, gen p mean: -0.2298799753189087, mean p set: 0.44713470339775085The modified gen p mean: 0.4464099705219269, gen p mean: -0.22807247936725616, mean p set: 0.4469420909881592
loss_pred:0.015274936333298683, decouple_loss:0.001796119031496346
loss_pred:0.015417816117405891, decouple_loss:0.001948484918102622
Iteration: 3687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645121693611145, gen p mean: -0.22799797356128693, mean p set: 0.44702646136283875
loss_pred:0.014579670503735542, decouple_loss:0.0020348657853901386
The modified gen p mean: 0.44592931866645813, gen p mean: -0.23054710030555725, mean p set: 0.4465000033378601The modified gen p mean: 0.44614362716674805, gen p mean: -0.22719912230968475, mean p set: 0.44667407870292664
loss_pred:0.014524486847221851, decouple_loss:0.0018074017716571689
loss_pred:0.015439418144524097, decouple_loss:0.0019290635827928782
Iteration: 3688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477531313896179, gen p mean: -0.22854755818843842, mean p set: 0.448323518037796
loss_pred:0.015111253596842289, decouple_loss:0.0019431535620242357
The modified gen p mean: 0.4469463527202606, gen p mean: -0.23019663989543915, mean p set: 0.44751712679862976
loss_pred:0.01525199320167303, decouple_loss:0.0021088100038468838
The modified gen p mean: 0.4465215504169464, gen p mean: -0.22934815287590027, mean p set: 0.4470498263835907
loss_pred:0.014195896685123444, decouple_loss:0.0022220900282263756
Iteration: 3689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741734862327576, gen p mean: -0.2276637703180313, mean p set: 0.44799020886421204
loss_pred:0.014577727764844894, decouple_loss:0.0019479556940495968
The modified gen p mean: 0.4479239583015442, gen p mean: -0.22833426296710968, mean p set: 0.4484979510307312
loss_pred:0.015288114547729492, decouple_loss:0.0018341923132538795
The modified gen p mean: 0.4483628273010254, gen p mean: -0.22900554537773132, mean p set: 0.44888943433761597
loss_pred:0.014853296801447868, decouple_loss:0.0018097031861543655
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452002942562103, gen p mean: -0.22944077849388123, mean p set: 0.4457741975784302
loss_pred:0.014619127847254276, decouple_loss:0.0019546577241271734
The modified gen p mean: 0.44666945934295654, gen p mean: -0.22394877672195435, mean p set: 0.4472399353981018
loss_pred:0.015159785747528076, decouple_loss:0.0022859966848045588
The modified gen p mean: 0.44645851850509644, gen p mean: -0.23198190331459045, mean p set: 0.4469846189022064
loss_pred:0.01595313847064972, decouple_loss:0.0018569632666185498
2023-04-27 17:48:38 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22916413843631744, mean p set: 0.4499112665653229
loss_pred:0.01616889238357544, decouple_loss:0.0018665231764316559
The modified gen p mean: 0.44930076599121094, gen p mean: -0.22938776016235352, mean p set: 0.4498290419578552
loss_pred:0.01569473184645176, decouple_loss:0.0019759119022637606
The modified gen p mean: 0.44822555780410767, gen p mean: -0.22707387804985046, mean p set: 0.44879910349845886
loss_pred:0.0160354096442461, decouple_loss:0.0019159221556037664
WV_1_PC_1_EH_0_PS_30, loss: 0.016062317416071892, avg_mse: 0.023926014080643654
current test mse: 0.023926
Iteration: 3691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715583324432373, gen p mean: -0.23007410764694214, mean p set: 0.447732150554657
loss_pred:0.014734817668795586, decouple_loss:0.001933631836436689
The modified gen p mean: 0.44619542360305786, gen p mean: -0.22869741916656494, mean p set: 0.4467202425003052
loss_pred:0.014907280914485455, decouple_loss:0.001730599906295538
The modified gen p mean: 0.44596245884895325, gen p mean: -0.231419637799263, mean p set: 0.44653645157814026
loss_pred:0.014052421785891056, decouple_loss:0.0017844041576609015
Iteration: 3692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44616907835006714, gen p mean: -0.22966532409191132, mean p set: 0.44669607281684875
loss_pred:0.014536425471305847, decouple_loss:0.0018499731086194515
The modified gen p mean: 0.4458267092704773, gen p mean: -0.23378846049308777, mean p set: 0.44640329480171204
The modified gen p mean: 0.4471849799156189, gen p mean: -0.23351097106933594, mean p set: 0.44775912165641785
loss_pred:0.015071219764649868, decouple_loss:0.00189178844448179
loss_pred:0.015352541580796242, decouple_loss:0.0019520631758496165
Iteration: 3693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465813934803009, gen p mean: -0.23126356303691864, mean p set: 0.447105348110199
loss_pred:0.01509388629347086, decouple_loss:0.0017948204185813665
The modified gen p mean: 0.445802241563797, gen p mean: -0.23271948099136353, mean p set: 0.4463808834552765
The modified gen p mean: 0.4463535249233246, gen p mean: -0.23370055854320526, mean p set: 0.44692856073379517
loss_pred:0.014892369508743286, decouple_loss:0.0018218911718577147
loss_pred:0.01451826747506857, decouple_loss:0.00167780218180269
Iteration: 3694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473631680011749, gen p mean: -0.22895921766757965, mean p set: 0.44788745045661926
loss_pred:0.015158160589635372, decouple_loss:0.001900087925605476
The modified gen p mean: 0.44794219732284546, gen p mean: -0.2344384789466858, mean p set: 0.44851207733154297
The modified gen p mean: 0.4478532373905182, gen p mean: -0.23217524588108063, mean p set: 0.4484235644340515
loss_pred:0.014540914446115494, decouple_loss:0.002118355128914118
loss_pred:0.014498669654130936, decouple_loss:0.0019055824959650636
Iteration: 3695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473334550857544, gen p mean: -0.23116444051265717, mean p set: 0.447918564081192
loss_pred:0.014272780157625675, decouple_loss:0.0019348287023603916
The modified gen p mean: 0.4457849860191345, gen p mean: -0.2276754379272461, mean p set: 0.4463140368461609The modified gen p mean: 0.44673579931259155, gen p mean: -0.2301918864250183, mean p set: 0.4473114311695099
loss_pred:0.014218236319720745, decouple_loss:0.0019091736758127809
loss_pred:0.01476698461920023, decouple_loss:0.0020367647521197796
Iteration: 3696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461345672607422, gen p mean: -0.22702930867671967, mean p set: 0.44671353697776794
loss_pred:0.015020230785012245, decouple_loss:0.0023557275999337435
The modified gen p mean: 0.446268767118454, gen p mean: -0.23066706955432892, mean p set: 0.44679760932922363The modified gen p mean: 0.44687771797180176, gen p mean: -0.2299858033657074, mean p set: 0.4474559724330902
loss_pred:0.014389758929610252, decouple_loss:0.0021225286182016134
loss_pred:0.01554805226624012, decouple_loss:0.001853613997809589
Iteration: 3697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44613465666770935, gen p mean: -0.22951123118400574, mean p set: 0.4467087388038635
loss_pred:0.015040435828268528, decouple_loss:0.0018891848158091307
The modified gen p mean: 0.44685351848602295, gen p mean: -0.22954006493091583, mean p set: 0.44737792015075684The modified gen p mean: 0.44661998748779297, gen p mean: -0.23391760885715485, mean p set: 0.4471932351589203
loss_pred:0.01557808555662632, decouple_loss:0.0020151142962276936
loss_pred:0.014594404958188534, decouple_loss:0.0018793998751789331
Iteration: 3698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558045268058777, gen p mean: -0.22729361057281494, mean p set: 0.44616246223449707
loss_pred:0.014984681271016598, decouple_loss:0.0018080860609188676
The modified gen p mean: 0.44639867544174194, gen p mean: -0.23544199764728546, mean p set: 0.4469722807407379
loss_pred:0.014782440848648548, decouple_loss:0.0017944807186722755
The modified gen p mean: 0.44570842385292053, gen p mean: -0.2317928522825241, mean p set: 0.4462362825870514
loss_pred:0.014526540413498878, decouple_loss:0.0016948893899098039
Iteration: 3699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453876316547394, gen p mean: -0.23953601717948914, mean p set: 0.44596222043037415
loss_pred:0.014649001881480217, decouple_loss:0.0018397790845483541
The modified gen p mean: 0.4458271861076355, gen p mean: -0.23163190484046936, mean p set: 0.4464031159877777
loss_pred:0.014623282477259636, decouple_loss:0.0017342012142762542
The modified gen p mean: 0.44754597544670105, gen p mean: -0.23264150321483612, mean p set: 0.44807806611061096
loss_pred:0.015149403363466263, decouple_loss:0.002017084276303649
Iteration: 3700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475261867046356, gen p mean: -0.23927590250968933, mean p set: 0.4480991065502167
loss_pred:0.014817421324551105, decouple_loss:0.001790416892617941
The modified gen p mean: 0.44585445523262024, gen p mean: -0.2421623319387436, mean p set: 0.44643494486808777
loss_pred:0.014699794352054596, decouple_loss:0.0018116364954039454
The modified gen p mean: 0.4473503828048706, gen p mean: -0.23642650246620178, mean p set: 0.44787484407424927
loss_pred:0.014579911716282368, decouple_loss:0.0017840106738731265
2023-04-27 17:52:03 testing...
The modified gen p mean: 0.4482176601886749, gen p mean: -0.23432393372058868, mean p set: 0.44879910349845886
loss_pred:0.01593894325196743, decouple_loss:0.001793077914044261
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23651434481143951, mean p set: 0.4499112665653229
loss_pred:0.016074521467089653, decouple_loss:0.0017776727909222245
The modified gen p mean: 0.4492979347705841, gen p mean: -0.23668678104877472, mean p set: 0.4498290419578552
loss_pred:0.015613246709108353, decouple_loss:0.001751266187056899
WV_1_PC_1_EH_0_PS_30, loss: 0.015964271500706673, avg_mse: 0.023782264441251755
current test mse: 0.023782
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 3701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762060046195984, gen p mean: -0.2323974370956421, mean p set: 0.44814783334732056
loss_pred:0.014142175205051899, decouple_loss:0.002424493432044983
The modified gen p mean: 0.4475637972354889, gen p mean: -0.2358846217393875, mean p set: 0.44813597202301025
loss_pred:0.014544026926159859, decouple_loss:0.0021615938749164343
The modified gen p mean: 0.4471780061721802, gen p mean: -0.2383977323770523, mean p set: 0.44775503873825073
loss_pred:0.013977905735373497, decouple_loss:0.0018317397916689515
Iteration: 3702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464854300022125, gen p mean: -0.2278750091791153, mean p set: 0.44701725244522095
loss_pred:0.014471649192273617, decouple_loss:0.002088850364089012
The modified gen p mean: 0.44710320234298706, gen p mean: -0.23326215147972107, mean p set: 0.44768205285072327
loss_pred:0.015290063805878162, decouple_loss:0.0019387583015486598
The modified gen p mean: 0.447023868560791, gen p mean: -0.2294248789548874, mean p set: 0.4475933611392975
loss_pred:0.01457751914858818, decouple_loss:0.0019061760976910591
Iteration: 3703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783860445022583, gen p mean: -0.22722561657428741, mean p set: 0.44836780428886414
loss_pred:0.01544027030467987, decouple_loss:0.0019688380416482687
The modified gen p mean: 0.4470653235912323, gen p mean: -0.22599345445632935, mean p set: 0.4476364552974701
loss_pred:0.014338888227939606, decouple_loss:0.0020737468730658293
The modified gen p mean: 0.44758906960487366, gen p mean: -0.2340547740459442, mean p set: 0.44816869497299194
loss_pred:0.014569808728992939, decouple_loss:0.0023484830744564533
Iteration: 3704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485901892185211, gen p mean: -0.21957851946353912, mean p set: 0.4491144120693207
loss_pred:0.014291641302406788, decouple_loss:0.002480984665453434
The modified gen p mean: 0.44729742407798767, gen p mean: -0.2229522317647934, mean p set: 0.4478708505630493
loss_pred:0.013708040118217468, decouple_loss:0.0022123889066278934
The modified gen p mean: 0.44748786091804504, gen p mean: -0.2270505279302597, mean p set: 0.44805845618247986
loss_pred:0.014149723574519157, decouple_loss:0.0019199717789888382
Iteration: 3705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476454555988312, gen p mean: -0.21735568344593048, mean p set: 0.44822585582733154
loss_pred:0.014386738650500774, decouple_loss:0.0019114254973828793
The modified gen p mean: 0.4480215013027191, gen p mean: -0.22587168216705322, mean p set: 0.4485950767993927The modified gen p mean: 0.44877487421035767, gen p mean: -0.22537899017333984, mean p set: 0.449308842420578
loss_pred:0.013882467523217201, decouple_loss:0.00196890183724463
loss_pred:0.013433010317385197, decouple_loss:0.002088785171508789
Iteration: 3706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848570227622986, gen p mean: -0.21885520219802856, mean p set: 0.44905948638916016
loss_pred:0.014483332633972168, decouple_loss:0.002087552798911929
The modified gen p mean: 0.4470081627368927, gen p mean: -0.22828787565231323, mean p set: 0.44753962755203247The modified gen p mean: 0.4480131268501282, gen p mean: -0.22480429708957672, mean p set: 0.44859078526496887
loss_pred:0.013537600636482239, decouple_loss:0.0019520707428455353
loss_pred:0.014162931591272354, decouple_loss:0.0019198250956833363
Iteration: 3707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744130969047546, gen p mean: -0.22516180574893951, mean p set: 0.4480154812335968
loss_pred:0.01368226483464241, decouple_loss:0.0017649525543674827
The modified gen p mean: 0.4473741054534912, gen p mean: -0.219222292304039, mean p set: 0.4479523003101349
loss_pred:0.014395670965313911, decouple_loss:0.0020917439833283424
The modified gen p mean: 0.4495781362056732, gen p mean: -0.2219734489917755, mean p set: 0.45010778307914734
loss_pred:0.013518325984477997, decouple_loss:0.002440894953906536
Iteration: 3708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725456833839417, gen p mean: -0.22556768357753754, mean p set: 0.44783204793930054
loss_pred:0.014161603525280952, decouple_loss:0.0017421257216483355
The modified gen p mean: 0.4482017159461975, gen p mean: -0.221863254904747, mean p set: 0.4487749934196472The modified gen p mean: 0.4472736120223999, gen p mean: -0.23100340366363525, mean p set: 0.44780364632606506
loss_pred:0.014289377257227898, decouple_loss:0.00186801771633327
loss_pred:0.014404378831386566, decouple_loss:0.0016800380544736981
Iteration: 3709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44898465275764465, gen p mean: -0.2222122997045517, mean p set: 0.4495594799518585
loss_pred:0.013758283108472824, decouple_loss:0.002250931691378355
The modified gen p mean: 0.44710999727249146, gen p mean: -0.22605499625205994, mean p set: 0.4476836025714874
loss_pred:0.013316193595528603, decouple_loss:0.0020619379356503487
The modified gen p mean: 0.4481152892112732, gen p mean: -0.23035022616386414, mean p set: 0.4486410617828369
loss_pred:0.013739549554884434, decouple_loss:0.0021769478917121887
Iteration: 3710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447944313287735, gen p mean: -0.2284177988767624, mean p set: 0.4485217034816742
loss_pred:0.01394613366574049, decouple_loss:0.0017433685716241598
The modified gen p mean: 0.4470847547054291, gen p mean: -0.22620698809623718, mean p set: 0.4476158618927002The modified gen p mean: 0.44853878021240234, gen p mean: -0.22484411299228668, mean p set: 0.4491148293018341
loss_pred:0.013826617039740086, decouple_loss:0.0018452240619808435
loss_pred:0.014403311535716057, decouple_loss:0.0018538973527029157
2023-04-27 17:56:14 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22786220908164978, mean p set: 0.4499112665653229
loss_pred:0.016142237931489944, decouple_loss:0.0022446902003139257
The modified gen p mean: 0.4492955505847931, gen p mean: -0.22769294679164886, mean p set: 0.4498290419578552
loss_pred:0.015725182369351387, decouple_loss:0.0022516679018735886
The modified gen p mean: 0.44822609424591064, gen p mean: -0.2249961942434311, mean p set: 0.44879910349845886
loss_pred:0.016138684004545212, decouple_loss:0.0021956334821879864
WV_1_PC_1_EH_0_PS_30, loss: 0.01611356809735298, avg_mse: 0.024003731086850166
current test mse: 0.024004
Iteration: 3711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899529218673706, gen p mean: -0.21879906952381134, mean p set: 0.4495725929737091
loss_pred:0.013914160430431366, decouple_loss:0.0020599914714694023
The modified gen p mean: 0.449428528547287, gen p mean: -0.21911481022834778, mean p set: 0.4499603509902954
loss_pred:0.01369713619351387, decouple_loss:0.002169729443266988
The modified gen p mean: 0.4473170340061188, gen p mean: -0.22369572520256042, mean p set: 0.4478912055492401
loss_pred:0.014776371419429779, decouple_loss:0.0021918804850429296
Iteration: 3712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467868208885193, gen p mean: -0.23151463270187378, mean p set: 0.4473148286342621
loss_pred:0.01404617354273796, decouple_loss:0.0022006239742040634
The modified gen p mean: 0.4475960433483124, gen p mean: -0.22779734432697296, mean p set: 0.4481693506240845
The modified gen p mean: 0.44769635796546936, gen p mean: -0.22563667595386505, mean p set: 0.4482676684856415
loss_pred:0.013753106817603111, decouple_loss:0.002033423399552703
loss_pred:0.014031962491571903, decouple_loss:0.002598314546048641
Iteration: 3713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768503308296204, gen p mean: -0.23232202231884003, mean p set: 0.44821614027023315
loss_pred:0.014523055404424667, decouple_loss:0.0020530952606350183
The modified gen p mean: 0.4477942883968353, gen p mean: -0.23102734982967377, mean p set: 0.4483700692653656
The modified gen p mean: 0.4477587342262268, gen p mean: -0.23135551810264587, mean p set: 0.4483305513858795
loss_pred:0.013454187661409378, decouple_loss:0.001975148916244507
loss_pred:0.014647627249360085, decouple_loss:0.0021681999787688255
Iteration: 3714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698089361190796, gen p mean: -0.22621354460716248, mean p set: 0.4475088119506836
loss_pred:0.014142865315079689, decouple_loss:0.001988200703635812
The modified gen p mean: 0.446805477142334, gen p mean: -0.23507949709892273, mean p set: 0.4473792016506195
The modified gen p mean: 0.44670116901397705, gen p mean: -0.2309567779302597, mean p set: 0.4472792148590088
loss_pred:0.014061609283089638, decouple_loss:0.0017418689094483852
loss_pred:0.014156891033053398, decouple_loss:0.0018862106371670961
Iteration: 3715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480607509613037, gen p mean: -0.2310873568058014, mean p set: 0.44863179326057434
loss_pred:0.01372039970010519, decouple_loss:0.0018107765354216099
The modified gen p mean: 0.44748827815055847, gen p mean: -0.22623036801815033, mean p set: 0.4480615258216858The modified gen p mean: 0.4486568570137024, gen p mean: -0.22753407061100006, mean p set: 0.44918543100357056
loss_pred:0.013813242316246033, decouple_loss:0.001876066904515028
loss_pred:0.013697032816708088, decouple_loss:0.001987560885027051
Iteration: 3716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474049508571625, gen p mean: -0.22076962888240814, mean p set: 0.44798195362091064
loss_pred:0.013981355354189873, decouple_loss:0.0018496616976335645
The modified gen p mean: 0.4470840096473694, gen p mean: -0.22318735718727112, mean p set: 0.4476613700389862
The modified gen p mean: 0.4480833113193512, gen p mean: -0.22013592720031738, mean p set: 0.44860655069351196
loss_pred:0.01401791162788868, decouple_loss:0.0019355964614078403
loss_pred:0.013680572621524334, decouple_loss:0.0018097925931215286
Iteration: 3717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472180902957916, gen p mean: -0.221568301320076, mean p set: 0.4477936327457428
loss_pred:0.013768820092082024, decouple_loss:0.0023727104999125004
The modified gen p mean: 0.4478408694267273, gen p mean: -0.21688400208950043, mean p set: 0.44842052459716797The modified gen p mean: 0.44848328828811646, gen p mean: -0.21204976737499237, mean p set: 0.4490176737308502
loss_pred:0.01408839225769043, decouple_loss:0.002179481787607074
loss_pred:0.014173845760524273, decouple_loss:0.0017606455367058516
Iteration: 3718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447709321975708, gen p mean: -0.22006306052207947, mean p set: 0.4482842683792114
loss_pred:0.014481951482594013, decouple_loss:0.0022382617462426424
The modified gen p mean: 0.4469461143016815, gen p mean: -0.22148774564266205, mean p set: 0.4475235044956207
loss_pred:0.014097757637500763, decouple_loss:0.0019540234934538603
The modified gen p mean: 0.44764530658721924, gen p mean: -0.22574090957641602, mean p set: 0.4481755197048187
loss_pred:0.013817712664604187, decouple_loss:0.002006645780056715
Iteration: 3719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475521445274353, gen p mean: -0.22839021682739258, mean p set: 0.44812917709350586
loss_pred:0.014489062130451202, decouple_loss:0.002149151870980859
The modified gen p mean: 0.44798174500465393, gen p mean: -0.22239738702774048, mean p set: 0.44856393337249756
loss_pred:0.01458724681288004, decouple_loss:0.0026660668663680553
The modified gen p mean: 0.4466390907764435, gen p mean: -0.22786208987236023, mean p set: 0.4471684396266937
loss_pred:0.01426033303141594, decouple_loss:0.002507172292098403
Iteration: 3720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478783905506134, gen p mean: -0.23736365139484406, mean p set: 0.44845813512802124
loss_pred:0.013445987366139889, decouple_loss:0.0022114189341664314
The modified gen p mean: 0.4476655423641205, gen p mean: -0.2307921051979065, mean p set: 0.44824254512786865
loss_pred:0.014685556292533875, decouple_loss:0.002434180350974202
The modified gen p mean: 0.44792962074279785, gen p mean: -0.2317981868982315, mean p set: 0.44845467805862427
loss_pred:0.013524521142244339, decouple_loss:0.00211327918805182
2023-04-27 17:59:38 testing...
The modified gen p mean: 0.44822028279304504, gen p mean: -0.22988659143447876, mean p set: 0.44879910349845886
loss_pred:0.016263088211417198, decouple_loss:0.002619141945615411
The modified gen p mean: 0.4494309425354004, gen p mean: -0.232618510723114, mean p set: 0.4499112665653229
loss_pred:0.016178596764802933, decouple_loss:0.002733055502176285
The modified gen p mean: 0.4493027925491333, gen p mean: -0.23240454494953156, mean p set: 0.4498290419578552
loss_pred:0.01575333997607231, decouple_loss:0.002683026250451803
WV_1_PC_1_EH_0_PS_30, loss: 0.016198929399251938, avg_mse: 0.024052351713180542
current test mse: 0.024052
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 3721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778427481651306, gen p mean: -0.23479458689689636, mean p set: 0.4483092129230499
loss_pred:0.014863172546029091, decouple_loss:0.002503481926396489
The modified gen p mean: 0.44790220260620117, gen p mean: -0.2335934042930603, mean p set: 0.44847777485847473
loss_pred:0.015443824231624603, decouple_loss:0.002510424004867673
The modified gen p mean: 0.4485819935798645, gen p mean: -0.22647179663181305, mean p set: 0.4491572082042694
loss_pred:0.014033646322786808, decouple_loss:0.002336828038096428
Iteration: 3722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883662462234497, gen p mean: -0.2286052405834198, mean p set: 0.4493674635887146
loss_pred:0.014586302451789379, decouple_loss:0.0022186115384101868
The modified gen p mean: 0.4477252662181854, gen p mean: -0.23151089251041412, mean p set: 0.44830194115638733
loss_pred:0.01472384762018919, decouple_loss:0.002008985262364149
The modified gen p mean: 0.44704386591911316, gen p mean: -0.2310008555650711, mean p set: 0.44762104749679565
loss_pred:0.014950971119105816, decouple_loss:0.002140820724889636
Iteration: 3723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448315292596817, gen p mean: -0.22862577438354492, mean p set: 0.44884148240089417
loss_pred:0.013962962664663792, decouple_loss:0.0028653829358518124
The modified gen p mean: 0.4475553333759308, gen p mean: -0.22995233535766602, mean p set: 0.4481314718723297
loss_pred:0.015348539687693119, decouple_loss:0.0022446801885962486
The modified gen p mean: 0.4485988914966583, gen p mean: -0.23308628797531128, mean p set: 0.44917547702789307
loss_pred:0.014471652917563915, decouple_loss:0.002481770934537053
Iteration: 3724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448172390460968, gen p mean: -0.22186864912509918, mean p set: 0.44870755076408386
loss_pred:0.013822757638990879, decouple_loss:0.0024811585899442434
The modified gen p mean: 0.44875940680503845, gen p mean: -0.23459261655807495, mean p set: 0.44933804869651794
loss_pred:0.013918323442339897, decouple_loss:0.0022490702103823423
The modified gen p mean: 0.4497027099132538, gen p mean: -0.2303842455148697, mean p set: 0.4502778649330139
loss_pred:0.015056198462843895, decouple_loss:0.0025749863125383854
Iteration: 3725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801798462867737, gen p mean: -0.2352934628725052, mean p set: 0.4485989212989807
loss_pred:0.01519477553665638, decouple_loss:0.002503810217604041
The modified gen p mean: 0.4494055509567261, gen p mean: -0.24311627447605133, mean p set: 0.4499812126159668The modified gen p mean: 0.4471421539783478, gen p mean: -0.2361963540315628, mean p set: 0.44766971468925476
loss_pred:0.014350547455251217, decouple_loss:0.00262022134847939
loss_pred:0.015108124352991581, decouple_loss:0.0028121997602283955
Iteration: 3726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484378397464752, gen p mean: -0.24071460962295532, mean p set: 0.44901350140571594
loss_pred:0.01449449360370636, decouple_loss:0.002401477424427867
The modified gen p mean: 0.44783738255500793, gen p mean: -0.24182452261447906, mean p set: 0.44836223125457764The modified gen p mean: 0.44743800163269043, gen p mean: -0.23870061337947845, mean p set: 0.44801095128059387
loss_pred:0.01476049143821001, decouple_loss:0.0022202308755367994
loss_pred:0.015120887197554111, decouple_loss:0.0021994460839778185
Iteration: 3727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476017951965332, gen p mean: -0.2351708710193634, mean p set: 0.4481810927391052
loss_pred:0.015249038115143776, decouple_loss:0.0024509599898010492
The modified gen p mean: 0.4479120969772339, gen p mean: -0.23778800666332245, mean p set: 0.4484889805316925The modified gen p mean: 0.44751355051994324, gen p mean: -0.2263684719800949, mean p set: 0.44804272055625916
loss_pred:0.014613401144742966, decouple_loss:0.002297994215041399
loss_pred:0.013990644365549088, decouple_loss:0.003022874239832163
Iteration: 3728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487646520137787, gen p mean: -0.23147231340408325, mean p set: 0.44933751225471497
loss_pred:0.01447017677128315, decouple_loss:0.002198033733293414
The modified gen p mean: 0.4493679404258728, gen p mean: -0.23796093463897705, mean p set: 0.449893057346344The modified gen p mean: 0.4489108920097351, gen p mean: -0.23256218433380127, mean p set: 0.449482798576355
loss_pred:0.014523404650390148, decouple_loss:0.002261960646137595
loss_pred:0.014264793135225773, decouple_loss:0.00226975092664361
Iteration: 3729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854700565338135, gen p mean: -0.24181760847568512, mean p set: 0.4491303265094757
loss_pred:0.014083782210946083, decouple_loss:0.002196553163230419
The modified gen p mean: 0.4497566819190979, gen p mean: -0.236601784825325, mean p set: 0.45032650232315063
loss_pred:0.014395859092473984, decouple_loss:0.0020946732256561518
The modified gen p mean: 0.4473673701286316, gen p mean: -0.23822803795337677, mean p set: 0.44789305329322815
loss_pred:0.014834362082183361, decouple_loss:0.002497111214324832
Iteration: 3730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949913024902344, gen p mean: -0.23216480016708374, mean p set: 0.45008060336112976
loss_pred:0.014117018319666386, decouple_loss:0.002009222051128745
The modified gen p mean: 0.44834163784980774, gen p mean: -0.23928233981132507, mean p set: 0.44887539744377136The modified gen p mean: 0.4480350911617279, gen p mean: -0.23691712319850922, mean p set: 0.4486178159713745
loss_pred:0.01450763177126646, decouple_loss:0.002011597156524658
loss_pred:0.014371282421052456, decouple_loss:0.002167691243812442
2023-04-27 18:03:39 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2368927299976349, mean p set: 0.4499112665653229
loss_pred:0.016183283179998398, decouple_loss:0.0022607247810810804
The modified gen p mean: 0.4492992162704468, gen p mean: -0.23661033809185028, mean p set: 0.4498290419578552
loss_pred:0.015738286077976227, decouple_loss:0.002259340835735202
The modified gen p mean: 0.44822582602500916, gen p mean: -0.23406629264354706, mean p set: 0.44879910349845886
loss_pred:0.01612425595521927, decouple_loss:0.0022332165390253067
WV_1_PC_1_EH_0_PS_30, loss: 0.016127830371260643, avg_mse: 0.024001767858862877
current test mse: 0.024002
Iteration: 3731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489048421382904, gen p mean: -0.24014675617218018, mean p set: 0.44948384165763855
loss_pred:0.014790634624660015, decouple_loss:0.0019074807642027736
The modified gen p mean: 0.44867753982543945, gen p mean: -0.23863548040390015, mean p set: 0.4492034912109375
loss_pred:0.014568359591066837, decouple_loss:0.0019626449793577194
The modified gen p mean: 0.44752487540245056, gen p mean: -0.24150975048542023, mean p set: 0.44810163974761963
loss_pred:0.014288205653429031, decouple_loss:0.0023009036667644978
Iteration: 3732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467775821685791, gen p mean: -0.23233063519001007, mean p set: 0.44730639457702637
loss_pred:0.014468446373939514, decouple_loss:0.002134176902472973
The modified gen p mean: 0.4491916000843048, gen p mean: -0.23564526438713074, mean p set: 0.4497707486152649
The modified gen p mean: 0.44868481159210205, gen p mean: -0.2330322563648224, mean p set: 0.4492538273334503
loss_pred:0.014256547205150127, decouple_loss:0.002036159858107567
loss_pred:0.014620303176343441, decouple_loss:0.0020922585390508175
Iteration: 3733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484163224697113, gen p mean: -0.22882071137428284, mean p set: 0.448948472738266
loss_pred:0.01492911297827959, decouple_loss:0.0021365059074014425
The modified gen p mean: 0.44717884063720703, gen p mean: -0.22991204261779785, mean p set: 0.4477550983428955
The modified gen p mean: 0.4484480619430542, gen p mean: -0.22997638583183289, mean p set: 0.44901934266090393
loss_pred:0.014564801007509232, decouple_loss:0.0020635046530514956
loss_pred:0.013903423212468624, decouple_loss:0.0019286510068923235
Iteration: 3734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487888514995575, gen p mean: -0.22831162810325623, mean p set: 0.449317067861557
loss_pred:0.013937090523540974, decouple_loss:0.0020868813153356314
The modified gen p mean: 0.44813230633735657, gen p mean: -0.2228475660085678, mean p set: 0.4487088918685913
The modified gen p mean: 0.44750112295150757, gen p mean: -0.22631724178791046, mean p set: 0.4480784237384796
loss_pred:0.013920609839260578, decouple_loss:0.0023153508082032204
loss_pred:0.015093442983925343, decouple_loss:0.002082540886476636
Iteration: 3735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774019718170166, gen p mean: -0.2257602959871292, mean p set: 0.4483141601085663
loss_pred:0.01434350199997425, decouple_loss:0.001809525303542614
The modified gen p mean: 0.44911426305770874, gen p mean: -0.22602307796478271, mean p set: 0.4496924579143524The modified gen p mean: 0.44889095425605774, gen p mean: -0.22720837593078613, mean p set: 0.44941920042037964
loss_pred:0.014103897847235203, decouple_loss:0.0019865494687110186
loss_pred:0.014644932001829147, decouple_loss:0.0019688087049871683
Iteration: 3736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478689134120941, gen p mean: -0.23006373643875122, mean p set: 0.4484424889087677
loss_pred:0.0147821931168437, decouple_loss:0.0020979184191673994
The modified gen p mean: 0.44747859239578247, gen p mean: -0.22910864651203156, mean p set: 0.4480117857456207The modified gen p mean: 0.44828659296035767, gen p mean: -0.2302590310573578, mean p set: 0.4488602578639984
loss_pred:0.014275971800088882, decouple_loss:0.0018125463975593448
loss_pred:0.014361727982759476, decouple_loss:0.0021069052163511515
Iteration: 3737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485233724117279, gen p mean: -0.2319585233926773, mean p set: 0.44909700751304626
loss_pred:0.013687568716704845, decouple_loss:0.00206931633874774
The modified gen p mean: 0.44936320185661316, gen p mean: -0.2354535013437271, mean p set: 0.449893593788147The modified gen p mean: 0.44934937357902527, gen p mean: -0.23220938444137573, mean p set: 0.4499293565750122
loss_pred:0.014562532305717468, decouple_loss:0.00194148242007941
loss_pred:0.014355848543345928, decouple_loss:0.0019171210005879402
Iteration: 3738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447986364364624, gen p mean: -0.22627247869968414, mean p set: 0.4485621154308319
loss_pred:0.01399039477109909, decouple_loss:0.00216109910979867
The modified gen p mean: 0.44716429710388184, gen p mean: -0.23561647534370422, mean p set: 0.44773876667022705
loss_pred:0.014752562157809734, decouple_loss:0.0018724323017522693
The modified gen p mean: 0.4492742121219635, gen p mean: -0.2398684024810791, mean p set: 0.4497983753681183
loss_pred:0.01456751860678196, decouple_loss:0.0019272115314379334
Iteration: 3739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485393762588501, gen p mean: -0.23385266959667206, mean p set: 0.44912344217300415
loss_pred:0.013191199861466885, decouple_loss:0.0018273316090926528
The modified gen p mean: 0.44828253984451294, gen p mean: -0.2269846647977829, mean p set: 0.4488604962825775
loss_pred:0.013738851994276047, decouple_loss:0.0019053801661357284
The modified gen p mean: 0.44715696573257446, gen p mean: -0.2321568727493286, mean p set: 0.44768157601356506
loss_pred:0.014549072831869125, decouple_loss:0.0018991633551195264
Iteration: 3740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486643671989441, gen p mean: -0.22382141649723053, mean p set: 0.4492361843585968
loss_pred:0.013717660680413246, decouple_loss:0.002033955417573452
The modified gen p mean: 0.447786420583725, gen p mean: -0.23372651636600494, mean p set: 0.44836267828941345
loss_pred:0.014980361796915531, decouple_loss:0.001995579805225134
The modified gen p mean: 0.44887998700141907, gen p mean: -0.23237742483615875, mean p set: 0.4494136571884155
loss_pred:0.01367529109120369, decouple_loss:0.001796999480575323
2023-04-27 18:07:04 testing...
The modified gen p mean: 0.44822487235069275, gen p mean: -0.2270563542842865, mean p set: 0.44879910349845886
loss_pred:0.016098372638225555, decouple_loss:0.00187784677837044
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22953854501247406, mean p set: 0.4499112665653229
loss_pred:0.01618073135614395, decouple_loss:0.0019089658744633198
The modified gen p mean: 0.44929853081703186, gen p mean: -0.2296021729707718, mean p set: 0.4498290419578552
loss_pred:0.015688128769397736, decouple_loss:0.00187629961874336
WV_1_PC_1_EH_0_PS_30, loss: 0.01608346402645111, avg_mse: 0.023962482810020447
current test mse: 0.023962
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 3741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478778541088104, gen p mean: -0.23060816526412964, mean p set: 0.44841110706329346
loss_pred:0.015150345861911774, decouple_loss:0.0018192707793787122
The modified gen p mean: 0.4482577443122864, gen p mean: -0.22645778954029083, mean p set: 0.4488346576690674
loss_pred:0.01427642721682787, decouple_loss:0.0018245171522721648
The modified gen p mean: 0.4472910165786743, gen p mean: -0.22968488931655884, mean p set: 0.4478660821914673
loss_pred:0.01431607361882925, decouple_loss:0.0016654478386044502
Iteration: 3742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468230903148651, gen p mean: -0.23839907348155975, mean p set: 0.4473487436771393
loss_pred:0.014918597415089607, decouple_loss:0.0020676194690167904
The modified gen p mean: 0.448018878698349, gen p mean: -0.22909052670001984, mean p set: 0.44859424233436584
loss_pred:0.014480049721896648, decouple_loss:0.0018800878897309303
The modified gen p mean: 0.4485223889350891, gen p mean: -0.22871290147304535, mean p set: 0.4491024613380432
loss_pred:0.013940809294581413, decouple_loss:0.002301907166838646
Iteration: 3743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752851128578186, gen p mean: -0.23011288046836853, mean p set: 0.4480552673339844
loss_pred:0.014184512197971344, decouple_loss:0.0019574554171413183
The modified gen p mean: 0.4482268691062927, gen p mean: -0.22742381691932678, mean p set: 0.4488039016723633
loss_pred:0.013418933376669884, decouple_loss:0.002002821769565344
The modified gen p mean: 0.4463389217853546, gen p mean: -0.23746037483215332, mean p set: 0.44691917300224304
loss_pred:0.014875242486596107, decouple_loss:0.0017926190048456192
Iteration: 3744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477682411670685, gen p mean: -0.2311156839132309, mean p set: 0.44829997420310974
loss_pred:0.014549736864864826, decouple_loss:0.0022218888625502586
The modified gen p mean: 0.4481888711452484, gen p mean: -0.22961294651031494, mean p set: 0.44876906275749207
loss_pred:0.013609466142952442, decouple_loss:0.0021887992043048143
The modified gen p mean: 0.4478098154067993, gen p mean: -0.23150788247585297, mean p set: 0.4483831226825714
loss_pred:0.014036410488188267, decouple_loss:0.0023128327447921038
Iteration: 3745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488917887210846, gen p mean: -0.22786813974380493, mean p set: 0.4494676887989044
loss_pred:0.01432274840772152, decouple_loss:0.0019778874702751637
The modified gen p mean: 0.44706323742866516, gen p mean: -0.23277164995670319, mean p set: 0.4476391673088074The modified gen p mean: 0.4468255043029785, gen p mean: -0.23136936128139496, mean p set: 0.44735386967658997
loss_pred:0.014083245769143105, decouple_loss:0.002092896495014429
loss_pred:0.014664947055280209, decouple_loss:0.002050083363428712
Iteration: 3746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484208822250366, gen p mean: -0.22523298859596252, mean p set: 0.4489942789077759
loss_pred:0.013827918097376823, decouple_loss:0.0021080058068037033
The modified gen p mean: 0.44805511832237244, gen p mean: -0.22225482761859894, mean p set: 0.4485850930213928The modified gen p mean: 0.44727128744125366, gen p mean: -0.2242143452167511, mean p set: 0.4478446841239929
loss_pred:0.014697973616421223, decouple_loss:0.0020385964307934046
loss_pred:0.013831747695803642, decouple_loss:0.0022805409971624613
Iteration: 3747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460793137550354, gen p mean: -0.21875180304050446, mean p set: 0.44665467739105225
loss_pred:0.015136313624680042, decouple_loss:0.0019448731327429414
The modified gen p mean: 0.44829607009887695, gen p mean: -0.21968035399913788, mean p set: 0.448875367641449
The modified gen p mean: 0.44774577021598816, gen p mean: -0.2178751677274704, mean p set: 0.44827526807785034
loss_pred:0.014074343256652355, decouple_loss:0.002138103125616908
loss_pred:0.014467651024460793, decouple_loss:0.0018921347800642252
Iteration: 3748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468209147453308, gen p mean: -0.22556838393211365, mean p set: 0.4473954439163208
loss_pred:0.014735657721757889, decouple_loss:0.002062118612229824
The modified gen p mean: 0.4475237727165222, gen p mean: -0.23173154890537262, mean p set: 0.4481002688407898The modified gen p mean: 0.4485265016555786, gen p mean: -0.2302936315536499, mean p set: 0.44905540347099304
loss_pred:0.014593536034226418, decouple_loss:0.001966201700270176
loss_pred:0.014217972755432129, decouple_loss:0.0020280485041439533
Iteration: 3749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475620687007904, gen p mean: -0.2208581566810608, mean p set: 0.44813862442970276
loss_pred:0.014622352086007595, decouple_loss:0.002133929869160056
The modified gen p mean: 0.44688117504119873, gen p mean: -0.22030191123485565, mean p set: 0.4474572539329529
loss_pred:0.014178531244397163, decouple_loss:0.00214192271232605
The modified gen p mean: 0.44772955775260925, gen p mean: -0.22559157013893127, mean p set: 0.44826218485832214
loss_pred:0.013869854621589184, decouple_loss:0.0021435387898236513
Iteration: 3750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492586851119995, gen p mean: -0.22335508465766907, mean p set: 0.4498293101787567
loss_pred:0.014223114587366581, decouple_loss:0.0020231949165463448
The modified gen p mean: 0.44816285371780396, gen p mean: -0.22362782061100006, mean p set: 0.44874149560928345
loss_pred:0.013658805750310421, decouple_loss:0.0019549282733350992
The modified gen p mean: 0.4477021098136902, gen p mean: -0.22258175909519196, mean p set: 0.4482302665710449
loss_pred:0.013931971043348312, decouple_loss:0.0019250891637057066
2023-04-27 18:11:14 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.22961023449897766, mean p set: 0.4499112665653229
loss_pred:0.01600727066397667, decouple_loss:0.0020045822020620108
The modified gen p mean: 0.44930779933929443, gen p mean: -0.22948625683784485, mean p set: 0.4498290419578552
loss_pred:0.015598583966493607, decouple_loss:0.0019997272174805403
The modified gen p mean: 0.4482228457927704, gen p mean: -0.22648553550243378, mean p set: 0.44879910349845886
loss_pred:0.01598249562084675, decouple_loss:0.002025699708610773
WV_1_PC_1_EH_0_PS_30, loss: 0.01596328429877758, avg_mse: 0.023749571293592453
current test mse: 0.02375
Iteration: 3751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473399519920349, gen p mean: -0.23296642303466797, mean p set: 0.44791606068611145
loss_pred:0.014195048250257969, decouple_loss:0.0021838112734258175
The modified gen p mean: 0.44639909267425537, gen p mean: -0.22832682728767395, mean p set: 0.44693389534950256
loss_pred:0.014571968466043472, decouple_loss:0.002076606033369899
The modified gen p mean: 0.4489022493362427, gen p mean: -0.22775337100028992, mean p set: 0.449484258890152
loss_pred:0.014046382158994675, decouple_loss:0.002283843932673335
Iteration: 3752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792309403419495, gen p mean: -0.22896353900432587, mean p set: 0.4484524726867676
loss_pred:0.014237461611628532, decouple_loss:0.001856164075434208
The modified gen p mean: 0.4471147060394287, gen p mean: -0.226064994931221, mean p set: 0.4476827085018158
The modified gen p mean: 0.4480658173561096, gen p mean: -0.22739002108573914, mean p set: 0.4486396908760071
loss_pred:0.014331580139696598, decouple_loss:0.0018737042555585504
loss_pred:0.014454910531640053, decouple_loss:0.0020895833149552345
Iteration: 3753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479336738586426, gen p mean: -0.22516964375972748, mean p set: 0.44846025109291077
loss_pred:0.01411485392600298, decouple_loss:0.0022479183971881866
The modified gen p mean: 0.4490787386894226, gen p mean: -0.2277587652206421, mean p set: 0.4496593773365021
The modified gen p mean: 0.4479258060455322, gen p mean: -0.22668223083019257, mean p set: 0.44850608706474304
loss_pred:0.013420164585113525, decouple_loss:0.0024336515925824642
loss_pred:0.013473518192768097, decouple_loss:0.002243631985038519
Iteration: 3754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478699862957001, gen p mean: -0.22754134237766266, mean p set: 0.4483965039253235
loss_pred:0.014083082787692547, decouple_loss:0.0019142433302477002
The modified gen p mean: 0.44834014773368835, gen p mean: -0.22665686905384064, mean p set: 0.4489155113697052
The modified gen p mean: 0.4493854343891144, gen p mean: -0.22607122361660004, mean p set: 0.4499613046646118
loss_pred:0.01403859443962574, decouple_loss:0.0019777407869696617
loss_pred:0.013719038106501102, decouple_loss:0.002086274791508913
Iteration: 3755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752809405326843, gen p mean: -0.22399933636188507, mean p set: 0.44810861349105835
loss_pred:0.013906550593674183, decouple_loss:0.001849001389928162
The modified gen p mean: 0.4467405676841736, gen p mean: -0.22645452618598938, mean p set: 0.4472673535346985The modified gen p mean: 0.44717589020729065, gen p mean: -0.2241644412279129, mean p set: 0.4477500915527344
loss_pred:0.014026927761733532, decouple_loss:0.0018761485116556287
loss_pred:0.014830664731562138, decouple_loss:0.0017594661330804229
Iteration: 3756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703224301338196, gen p mean: -0.22852493822574615, mean p set: 0.44761136174201965
loss_pred:0.014330238103866577, decouple_loss:0.001977748004719615
The modified gen p mean: 0.44685256481170654, gen p mean: -0.22278887033462524, mean p set: 0.44738268852233887The modified gen p mean: 0.4465144872665405, gen p mean: -0.22235508263111115, mean p set: 0.4470857083797455
loss_pred:0.014819731935858727, decouple_loss:0.0020478114020079374
loss_pred:0.014699695631861687, decouple_loss:0.0021102502942085266
Iteration: 3757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474179148674011, gen p mean: -0.22821174561977386, mean p set: 0.4479939937591553
loss_pred:0.0140842841938138, decouple_loss:0.0018924642354249954
The modified gen p mean: 0.4468727111816406, gen p mean: -0.22405128180980682, mean p set: 0.44740498065948486The modified gen p mean: 0.44968292117118835, gen p mean: -0.22655680775642395, mean p set: 0.45025789737701416
loss_pred:0.01373753510415554, decouple_loss:0.002527771983295679
loss_pred:0.01435428112745285, decouple_loss:0.0018484961474314332
Iteration: 3758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478907883167267, gen p mean: -0.225149467587471, mean p set: 0.44846752285957336
loss_pred:0.013787292875349522, decouple_loss:0.0017774809384718537
The modified gen p mean: 0.44815918803215027, gen p mean: -0.22354096174240112, mean p set: 0.4486897885799408The modified gen p mean: 0.4465952217578888, gen p mean: -0.22478076815605164, mean p set: 0.44716405868530273
loss_pred:0.014339196495711803, decouple_loss:0.002050700131803751
loss_pred:0.013900194317102432, decouple_loss:0.001801061793230474
Iteration: 3759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471709430217743, gen p mean: -0.22056931257247925, mean p set: 0.447747141122818
loss_pred:0.01437639631330967, decouple_loss:0.0019957427866756916
The modified gen p mean: 0.44842779636383057, gen p mean: -0.22115744650363922, mean p set: 0.44895458221435547The modified gen p mean: 0.44765999913215637, gen p mean: -0.22461847960948944, mean p set: 0.4482366442680359
loss_pred:0.013735074549913406, decouple_loss:0.0018779716920107603
loss_pred:0.013675698079168797, decouple_loss:0.00199217745102942
Iteration: 3760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794824719429016, gen p mean: -0.22235636413097382, mean p set: 0.4485248327255249
loss_pred:0.014158478938043118, decouple_loss:0.0017806278774514794
The modified gen p mean: 0.44762662053108215, gen p mean: -0.2288837730884552, mean p set: 0.44815701246261597The modified gen p mean: 0.4478485584259033, gen p mean: -0.22692562639713287, mean p set: 0.4484281837940216
loss_pred:0.015212859027087688, decouple_loss:0.001882792916148901
loss_pred:0.014332770369946957, decouple_loss:0.0017862763488665223
2023-04-27 18:14:38 testing...
The modified gen p mean: 0.4482225775718689, gen p mean: -0.2249026596546173, mean p set: 0.44879910349845886
loss_pred:0.01588563807308674, decouple_loss:0.002305271802470088
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22790707647800446, mean p set: 0.4499112665653229
loss_pred:0.01599915511906147, decouple_loss:0.0023165573365986347
The modified gen p mean: 0.4492933750152588, gen p mean: -0.22798462212085724, mean p set: 0.4498290419578552
loss_pred:0.015558226965367794, decouple_loss:0.002333742333576083
WV_1_PC_1_EH_0_PS_30, loss: 0.01593026891350746, avg_mse: 0.02363421581685543
current test mse: 0.023634
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 3761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920381903648376, gen p mean: -0.2288506031036377, mean p set: 0.44973650574684143
loss_pred:0.015336212702095509, decouple_loss:0.0018776810029521585
The modified gen p mean: 0.4502810835838318, gen p mean: -0.22396567463874817, mean p set: 0.4508611261844635
loss_pred:0.015759533271193504, decouple_loss:0.0018412151839584112
The modified gen p mean: 0.4481237828731537, gen p mean: -0.22445917129516602, mean p set: 0.4486955404281616
loss_pred:0.015782427042722702, decouple_loss:0.0023164048325270414
Iteration: 3762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501884877681732, gen p mean: -0.22982178628444672, mean p set: 0.4507182538509369
loss_pred:0.015141037292778492, decouple_loss:0.0018254067981615663
The modified gen p mean: 0.44862860441207886, gen p mean: -0.22952699661254883, mean p set: 0.4492048919200897
loss_pred:0.015226787887513638, decouple_loss:0.0018117220606654882
The modified gen p mean: 0.449307382106781, gen p mean: -0.22709079086780548, mean p set: 0.44988352060317993
loss_pred:0.015025680884718895, decouple_loss:0.0017960781697183847
Iteration: 3763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497567117214203, gen p mean: -0.22519326210021973, mean p set: 0.4502823054790497
loss_pred:0.015363728627562523, decouple_loss:0.001858970383182168
The modified gen p mean: 0.4491502344608307, gen p mean: -0.22628004848957062, mean p set: 0.44972866773605347
loss_pred:0.016073079779744148, decouple_loss:0.002120429649949074
The modified gen p mean: 0.4488782584667206, gen p mean: -0.22807885706424713, mean p set: 0.44944941997528076
loss_pred:0.015708155930042267, decouple_loss:0.0018291405867785215
Iteration: 3764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506714344024658, gen p mean: -0.2245633900165558, mean p set: 0.4511975646018982
loss_pred:0.01493589673191309, decouple_loss:0.002085639163851738
The modified gen p mean: 0.45000407099723816, gen p mean: -0.2309609055519104, mean p set: 0.450583815574646
loss_pred:0.015811895951628685, decouple_loss:0.0020042816177010536
The modified gen p mean: 0.45009055733680725, gen p mean: -0.22232188284397125, mean p set: 0.45067691802978516
loss_pred:0.015755873173475266, decouple_loss:0.0020732651464641094
Iteration: 3765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904354214668274, gen p mean: -0.22810176014900208, mean p set: 0.4496159553527832
loss_pred:0.015388892963528633, decouple_loss:0.00193657202180475
The modified gen p mean: 0.4493753910064697, gen p mean: -0.2243911325931549, mean p set: 0.44995349645614624The modified gen p mean: 0.4493952989578247, gen p mean: -0.22547632455825806, mean p set: 0.4499199688434601
loss_pred:0.015374124981462955, decouple_loss:0.0019106423715129495
loss_pred:0.01523575745522976, decouple_loss:0.0018386163283139467
Iteration: 3766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072418451309204, gen p mean: -0.2271054983139038, mean p set: 0.4513084292411804
loss_pred:0.015491411089897156, decouple_loss:0.001978420652449131
The modified gen p mean: 0.4495624601840973, gen p mean: -0.22320440411567688, mean p set: 0.450135201215744The modified gen p mean: 0.44981327652931213, gen p mean: -0.22594556212425232, mean p set: 0.4503425657749176
loss_pred:0.014729449525475502, decouple_loss:0.001807269873097539
loss_pred:0.015032801777124405, decouple_loss:0.0019565788097679615
Iteration: 3767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960513710975647, gen p mean: -0.22090554237365723, mean p set: 0.45017993450164795
loss_pred:0.015392324887216091, decouple_loss:0.002224334981292486
The modified gen p mean: 0.4502323269844055, gen p mean: -0.21849308907985687, mean p set: 0.4507621228694916The modified gen p mean: 0.448617160320282, gen p mean: -0.22145597636699677, mean p set: 0.4491916298866272
loss_pred:0.015404891222715378, decouple_loss:0.0022366612683981657
loss_pred:0.015766168013215065, decouple_loss:0.002583159366622567
Iteration: 3768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491230547428131, gen p mean: -0.22033043205738068, mean p set: 0.4496990144252777
loss_pred:0.016075190156698227, decouple_loss:0.0022418033331632614
The modified gen p mean: 0.4485880732536316, gen p mean: -0.2194896936416626, mean p set: 0.4491656422615051
loss_pred:0.015276389196515083, decouple_loss:0.0020828114356845617
The modified gen p mean: 0.4492979347705841, gen p mean: -0.21682853996753693, mean p set: 0.4498307704925537
loss_pred:0.015571771189570427, decouple_loss:0.002413923153653741
Iteration: 3769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489435851573944, gen p mean: -0.22268609702587128, mean p set: 0.44952836632728577
loss_pred:0.015028121881186962, decouple_loss:0.0022295843809843063
The modified gen p mean: 0.4503529369831085, gen p mean: -0.21861186623573303, mean p set: 0.45092761516571045
loss_pred:0.01532658375799656, decouple_loss:0.0021548373624682426
The modified gen p mean: 0.4505727291107178, gen p mean: -0.2201390117406845, mean p set: 0.451102077960968
loss_pred:0.01493469625711441, decouple_loss:0.001990702236071229
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500516355037689, gen p mean: -0.2268926203250885, mean p set: 0.45062586665153503
loss_pred:0.015676788985729218, decouple_loss:0.0022078007459640503
The modified gen p mean: 0.4506911635398865, gen p mean: -0.22902680933475494, mean p set: 0.45127072930336
loss_pred:0.01534608006477356, decouple_loss:0.0023159896954894066
The modified gen p mean: 0.45053914189338684, gen p mean: -0.22236214578151703, mean p set: 0.4510757029056549
loss_pred:0.015666775405406952, decouple_loss:0.0022693623322993517
2023-04-27 18:18:42 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22633464634418488, mean p set: 0.4499112665653229
loss_pred:0.015488993376493454, decouple_loss:0.0019964815583080053
The modified gen p mean: 0.44930413365364075, gen p mean: -0.2266799360513687, mean p set: 0.4498290419578552
loss_pred:0.014841893687844276, decouple_loss:0.0019631662871688604
The modified gen p mean: 0.4482186436653137, gen p mean: -0.22407841682434082, mean p set: 0.44879910349845886
loss_pred:0.015455410815775394, decouple_loss:0.0018669990822672844
WV_1_PC_1_EH_0_PS_30, loss: 0.015359210781753063, avg_mse: 0.022651420906186104
current test mse: 0.022651
Iteration: 3771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450044721364975, gen p mean: -0.22829198837280273, mean p set: 0.4506154954433441
loss_pred:0.01563456282019615, decouple_loss:0.0019110386492684484
The modified gen p mean: 0.44901055097579956, gen p mean: -0.22324608266353607, mean p set: 0.4495888352394104
loss_pred:0.015295852907001972, decouple_loss:0.001977432519197464
The modified gen p mean: 0.448565274477005, gen p mean: -0.22387079894542694, mean p set: 0.4490925073623657
loss_pred:0.015791047364473343, decouple_loss:0.001912002800963819
Iteration: 3772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449287474155426, gen p mean: -0.2276095598936081, mean p set: 0.4498143792152405
loss_pred:0.015420638024806976, decouple_loss:0.002434019697830081
The modified gen p mean: 0.44880518317222595, gen p mean: -0.22518321871757507, mean p set: 0.4493815302848816
The modified gen p mean: 0.4486193060874939, gen p mean: -0.2300375998020172, mean p set: 0.4491928219795227
loss_pred:0.015566370449960232, decouple_loss:0.0023546875454485416
loss_pred:0.015204212628304958, decouple_loss:0.0022765875328332186
Iteration: 3773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936105608940125, gen p mean: -0.22687721252441406, mean p set: 0.44988662004470825
loss_pred:0.015427658334374428, decouple_loss:0.0019516178872436285
The modified gen p mean: 0.4496259391307831, gen p mean: -0.2269938439130783, mean p set: 0.4502067267894745
The modified gen p mean: 0.44980162382125854, gen p mean: -0.22671212255954742, mean p set: 0.45038241147994995
loss_pred:0.014948539435863495, decouple_loss:0.001960359513759613
loss_pred:0.014938747510313988, decouple_loss:0.0019364416366443038
Iteration: 3774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498925507068634, gen p mean: -0.2229519486427307, mean p set: 0.4504148066043854
loss_pred:0.01578938029706478, decouple_loss:0.002051043324172497
The modified gen p mean: 0.45000961422920227, gen p mean: -0.23102128505706787, mean p set: 0.45058757066726685
The modified gen p mean: 0.4494669437408447, gen p mean: -0.2270604372024536, mean p set: 0.4500381648540497
loss_pred:0.015397729352116585, decouple_loss:0.0021472794469445944
loss_pred:0.014914853498339653, decouple_loss:0.0020039654336869717
Iteration: 3775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957345724105835, gen p mean: -0.22477155923843384, mean p set: 0.45014673471450806
loss_pred:0.01519863773137331, decouple_loss:0.0017337790923193097
The modified gen p mean: 0.45041635632514954, gen p mean: -0.2279270440340042, mean p set: 0.4509483277797699The modified gen p mean: 0.44948887825012207, gen p mean: -0.22698409855365753, mean p set: 0.45006564259529114
loss_pred:0.015382125973701477, decouple_loss:0.0017414059257134795
loss_pred:0.01605374738574028, decouple_loss:0.002054576063528657
Iteration: 3776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504317343235016, gen p mean: -0.23349182307720184, mean p set: 0.4510018229484558
loss_pred:0.016283631324768066, decouple_loss:0.0020929097663611174
The modified gen p mean: 0.4511415660381317, gen p mean: -0.22828470170497894, mean p set: 0.4517151713371277The modified gen p mean: 0.449612557888031, gen p mean: -0.232646644115448, mean p set: 0.4501415491104126
loss_pred:0.015382612124085426, decouple_loss:0.0021971396636217833
loss_pred:0.01514933817088604, decouple_loss:0.0021774242632091045
Iteration: 3777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450104683637619, gen p mean: -0.22881290316581726, mean p set: 0.4506319463253021
loss_pred:0.015120298601686954, decouple_loss:0.002014875877648592
The modified gen p mean: 0.4497910737991333, gen p mean: -0.2303749918937683, mean p set: 0.45036831498146057
The modified gen p mean: 0.44925639033317566, gen p mean: -0.2320513129234314, mean p set: 0.4498307406902313
loss_pred:0.015077929012477398, decouple_loss:0.002188471145927906
loss_pred:0.01489083468914032, decouple_loss:0.002144354162737727
Iteration: 3778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45015671849250793, gen p mean: -0.2361903190612793, mean p set: 0.45073747634887695
loss_pred:0.01591518521308899, decouple_loss:0.001933713210746646
The modified gen p mean: 0.44803446531295776, gen p mean: -0.23398832976818085, mean p set: 0.448609322309494
loss_pred:0.015574649907648563, decouple_loss:0.0018684049136936665
The modified gen p mean: 0.4492737650871277, gen p mean: -0.23582853376865387, mean p set: 0.4498046338558197
loss_pred:0.015613170340657234, decouple_loss:0.001758365542627871
Iteration: 3779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505906105041504, gen p mean: -0.23537306487560272, mean p set: 0.45116761326789856
loss_pred:0.01574256457388401, decouple_loss:0.002153697656467557
The modified gen p mean: 0.4500763416290283, gen p mean: -0.23368211090564728, mean p set: 0.4506498873233795
loss_pred:0.015596682205796242, decouple_loss:0.0023786122910678387
The modified gen p mean: 0.4493054151535034, gen p mean: -0.23624680936336517, mean p set: 0.4498342275619507
loss_pred:0.015247197821736336, decouple_loss:0.0020713394042104483
Iteration: 3780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499835968017578, gen p mean: -0.23849928379058838, mean p set: 0.45056453347206116
loss_pred:0.0157924834638834, decouple_loss:0.002286904025822878
The modified gen p mean: 0.4496820271015167, gen p mean: -0.2327524721622467, mean p set: 0.4502556622028351
loss_pred:0.015409416519105434, decouple_loss:0.0018781495746225119
The modified gen p mean: 0.45029720664024353, gen p mean: -0.23612740635871887, mean p set: 0.4508230984210968
loss_pred:0.015210574492812157, decouple_loss:0.0020392334554344416
2023-04-27 18:22:07 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23554158210754395, mean p set: 0.4499112665653229
loss_pred:0.01506053376942873, decouple_loss:0.0020768246613442898
The modified gen p mean: 0.44930124282836914, gen p mean: -0.23601803183555603, mean p set: 0.4498290419578552
loss_pred:0.014554268680512905, decouple_loss:0.002254582243040204
The modified gen p mean: 0.4482210874557495, gen p mean: -0.23337844014167786, mean p set: 0.44879910349845886
loss_pred:0.014977403916418552, decouple_loss:0.002142838668078184
WV_1_PC_1_EH_0_PS_30, loss: 0.01497197337448597, avg_mse: 0.021868672221899033
current test mse: 0.021869
At step 3780, Best test: 0.021869
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 3781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793984293937683, gen p mean: -0.23687197268009186, mean p set: 0.448468953371048
loss_pred:0.01531260460615158, decouple_loss:0.0021205958910286427
The modified gen p mean: 0.44736894965171814, gen p mean: -0.23475924134254456, mean p set: 0.4479406476020813
loss_pred:0.014860372990369797, decouple_loss:0.002482540672644973
The modified gen p mean: 0.4482961893081665, gen p mean: -0.2308577597141266, mean p set: 0.4488692581653595
loss_pred:0.01500215195119381, decouple_loss:0.002667922293767333
Iteration: 3782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798633456230164, gen p mean: -0.23415887355804443, mean p set: 0.44850867986679077
loss_pred:0.014861860312521458, decouple_loss:0.0022076244931668043
The modified gen p mean: 0.44837686419487, gen p mean: -0.2364223450422287, mean p set: 0.4489506781101227
The modified gen p mean: 0.4483224153518677, gen p mean: -0.23661115765571594, mean p set: 0.44889581203460693
loss_pred:0.015230407938361168, decouple_loss:0.0021193623542785645
loss_pred:0.015332785435020924, decouple_loss:0.002251221099868417
Iteration: 3783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472752511501312, gen p mean: -0.22739259898662567, mean p set: 0.44780370593070984
loss_pred:0.015359925106167793, decouple_loss:0.002351850736886263
The modified gen p mean: 0.4483684003353119, gen p mean: -0.2338969111442566, mean p set: 0.4489421248435974
The modified gen p mean: 0.4479341506958008, gen p mean: -0.2332412153482437, mean p set: 0.4485113322734833
loss_pred:0.01468413881957531, decouple_loss:0.002186588943004608
loss_pred:0.01453268714249134, decouple_loss:0.0020426481496542692
Iteration: 3784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483064115047455, gen p mean: -0.23175139725208282, mean p set: 0.4488369822502136
loss_pred:0.014874272979795933, decouple_loss:0.002026424277573824
The modified gen p mean: 0.44708704948425293, gen p mean: -0.22783011198043823, mean p set: 0.4476655125617981
The modified gen p mean: 0.4473729133605957, gen p mean: -0.23166945576667786, mean p set: 0.4479483664035797
loss_pred:0.014142142608761787, decouple_loss:0.0022409921512007713
loss_pred:0.014405734837055206, decouple_loss:0.002295509446412325
Iteration: 3785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446210116147995, gen p mean: -0.2319038063287735, mean p set: 0.4467865526676178
loss_pred:0.015217622742056847, decouple_loss:0.0022700349800288677
The modified gen p mean: 0.44914573431015015, gen p mean: -0.2204018235206604, mean p set: 0.44967639446258545The modified gen p mean: 0.44893521070480347, gen p mean: -0.22902722656726837, mean p set: 0.44951605796813965
loss_pred:0.014555444940924644, decouple_loss:0.0022728119511157274
loss_pred:0.014544527977705002, decouple_loss:0.00224798615090549
Iteration: 3786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447522908449173, gen p mean: -0.22900134325027466, mean p set: 0.4481014013290405
loss_pred:0.015201061964035034, decouple_loss:0.002129956614226103
The modified gen p mean: 0.4476902186870575, gen p mean: -0.2283799797296524, mean p set: 0.44826918840408325The modified gen p mean: 0.4459075629711151, gen p mean: -0.23082208633422852, mean p set: 0.4464397132396698
loss_pred:0.014821210876107216, decouple_loss:0.0020853341557085514
loss_pred:0.015309751033782959, decouple_loss:0.0022851440589874983
Iteration: 3787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44586798548698425, gen p mean: -0.22799290716648102, mean p set: 0.44645413756370544
loss_pred:0.014659132808446884, decouple_loss:0.0022056519519537687
The modified gen p mean: 0.44789665937423706, gen p mean: -0.2260376662015915, mean p set: 0.44841864705085754The modified gen p mean: 0.4473188519477844, gen p mean: -0.23014520108699799, mean p set: 0.4478928744792938
loss_pred:0.014348353259265423, decouple_loss:0.002147966530174017
loss_pred:0.014526142738759518, decouple_loss:0.002067913766950369
Iteration: 3788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478687047958374, gen p mean: -0.23378004133701324, mean p set: 0.44844329357147217
loss_pred:0.014885279349982738, decouple_loss:0.0022541258949786425
The modified gen p mean: 0.44821205735206604, gen p mean: -0.2220926284790039, mean p set: 0.4487389624118805The modified gen p mean: 0.445867657661438, gen p mean: -0.23230262100696564, mean p set: 0.44645223021507263
loss_pred:0.014886449091136456, decouple_loss:0.002284015528857708
loss_pred:0.01510503888130188, decouple_loss:0.002423123922199011
Iteration: 3789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448161780834198, gen p mean: -0.2335885614156723, mean p set: 0.4486868679523468
loss_pred:0.014503216370940208, decouple_loss:0.002004307461902499
The modified gen p mean: 0.4487321078777313, gen p mean: -0.2264430820941925, mean p set: 0.44930681586265564The modified gen p mean: 0.4481836259365082, gen p mean: -0.23093894124031067, mean p set: 0.4487598240375519
loss_pred:0.015166009776294231, decouple_loss:0.0019518600311130285
loss_pred:0.014863941818475723, decouple_loss:0.001995356287807226
Iteration: 3790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474640488624573, gen p mean: -0.23196201026439667, mean p set: 0.4480399191379547
loss_pred:0.014084132388234138, decouple_loss:0.002249673707410693
The modified gen p mean: 0.4472452998161316, gen p mean: -0.23703856766223907, mean p set: 0.44777119159698486The modified gen p mean: 0.44746965169906616, gen p mean: -0.2380853146314621, mean p set: 0.4480428397655487
loss_pred:0.0139493178576231, decouple_loss:0.0020577923860400915
loss_pred:0.014872543513774872, decouple_loss:0.0020540764089673758
2023-04-27 18:26:09 testing...
The modified gen p mean: 0.4482242166996002, gen p mean: -0.23392949998378754, mean p set: 0.44879910349845886
loss_pred:0.015257984399795532, decouple_loss:0.0020786060485988855
The modified gen p mean: 0.44930410385131836, gen p mean: -0.23666244745254517, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23669424653053284, mean p set: 0.4499112665653229loss_pred:0.014816969633102417, decouple_loss:0.002152254804968834
loss_pred:0.01535172387957573, decouple_loss:0.0021598392631858587
WV_1_PC_1_EH_0_PS_30, loss: 0.01524873822927475, avg_mse: 0.02229105494916439
current test mse: 0.022291
Iteration: 3791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470471441745758, gen p mean: -0.2328646183013916, mean p set: 0.4475817382335663
loss_pred:0.01485102903097868, decouple_loss:0.0019812718965113163
The modified gen p mean: 0.447064071893692, gen p mean: -0.22985804080963135, mean p set: 0.44764280319213867
loss_pred:0.01493056956678629, decouple_loss:0.0018486345652490854
The modified gen p mean: 0.4488565921783447, gen p mean: -0.2335587441921234, mean p set: 0.4494354724884033
loss_pred:0.014679055660963058, decouple_loss:0.0020385170355439186
Iteration: 3792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476548731327057, gen p mean: -0.24246446788311005, mean p set: 0.448184072971344
loss_pred:0.014967480674386024, decouple_loss:0.002181494841352105
The modified gen p mean: 0.44556429982185364, gen p mean: -0.23955102264881134, mean p set: 0.4461473524570465
The modified gen p mean: 0.4476955831050873, gen p mean: -0.23686572909355164, mean p set: 0.44827160239219666
loss_pred:0.015048208646476269, decouple_loss:0.002107390435412526
loss_pred:0.015586581081151962, decouple_loss:0.001971717458218336
Iteration: 3793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470996856689453, gen p mean: -0.22978340089321136, mean p set: 0.4476326107978821
loss_pred:0.014386865310370922, decouple_loss:0.0018714580219238997
The modified gen p mean: 0.4463210105895996, gen p mean: -0.23205170035362244, mean p set: 0.44689464569091797
The modified gen p mean: 0.44789278507232666, gen p mean: -0.22593137621879578, mean p set: 0.44847002625465393
loss_pred:0.014961760491132736, decouple_loss:0.0021328122820705175
loss_pred:0.014944909140467644, decouple_loss:0.0020119950640946627
Iteration: 3794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846010208129883, gen p mean: -0.22769738733768463, mean p set: 0.4490351974964142
loss_pred:0.014463133178651333, decouple_loss:0.00232912739738822
The modified gen p mean: 0.44855913519859314, gen p mean: -0.2309958040714264, mean p set: 0.44908660650253296The modified gen p mean: 0.4489254653453827, gen p mean: -0.22419792413711548, mean p set: 0.4495036005973816
loss_pred:0.014537069946527481, decouple_loss:0.002171760890632868
loss_pred:0.01511693000793457, decouple_loss:0.0021942558232694864
Iteration: 3795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679999351501465, gen p mean: -0.22875338792800903, mean p set: 0.4473777115345001
loss_pred:0.015336873009800911, decouple_loss:0.002418756950646639
The modified gen p mean: 0.449275404214859, gen p mean: -0.22229677438735962, mean p set: 0.44985130429267883
loss_pred:0.014543835073709488, decouple_loss:0.0022382820025086403
The modified gen p mean: 0.4471450746059418, gen p mean: -0.23474763333797455, mean p set: 0.44767823815345764
loss_pred:0.014532296918332577, decouple_loss:0.002271373523399234
Iteration: 3796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847995042800903, gen p mean: -0.23010440170764923, mean p set: 0.4490565061569214
loss_pred:0.014454096555709839, decouple_loss:0.0020654264371842146
The modified gen p mean: 0.4474165737628937, gen p mean: -0.2321707010269165, mean p set: 0.44794782996177673The modified gen p mean: 0.447543203830719, gen p mean: -0.23513655364513397, mean p set: 0.44812238216400146
loss_pred:0.01500985398888588, decouple_loss:0.002081445185467601
loss_pred:0.015131101943552494, decouple_loss:0.0021239465568214655
Iteration: 3797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707128405570984, gen p mean: -0.2301945984363556, mean p set: 0.44764459133148193
loss_pred:0.014222875237464905, decouple_loss:0.002099663717672229
The modified gen p mean: 0.4488663673400879, gen p mean: -0.22297748923301697, mean p set: 0.44944167137145996
loss_pred:0.014666815288364887, decouple_loss:0.002169265877455473
The modified gen p mean: 0.44719600677490234, gen p mean: -0.23404167592525482, mean p set: 0.4477252662181854
loss_pred:0.01529138907790184, decouple_loss:0.0020566529128700495
Iteration: 3798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811877608299255, gen p mean: -0.2387436330318451, mean p set: 0.44869908690452576
loss_pred:0.014307591132819653, decouple_loss:0.0020836694166064262
The modified gen p mean: 0.4462660253047943, gen p mean: -0.23138462007045746, mean p set: 0.4468391239643097The modified gen p mean: 0.4483925998210907, gen p mean: -0.23377029597759247, mean p set: 0.448919415473938
loss_pred:0.01473984681069851, decouple_loss:0.00176029943395406
loss_pred:0.014848350547254086, decouple_loss:0.001720665255561471
Iteration: 3799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809436798095703, gen p mean: -0.2353655993938446, mean p set: 0.4486686885356903
loss_pred:0.015089672058820724, decouple_loss:0.0019493586150929332
The modified gen p mean: 0.4486424922943115, gen p mean: -0.23161709308624268, mean p set: 0.4492167532444
loss_pred:0.015098893083631992, decouple_loss:0.0019927143584936857
The modified gen p mean: 0.44531282782554626, gen p mean: -0.24001550674438477, mean p set: 0.44584187865257263
loss_pred:0.015025638975203037, decouple_loss:0.0020674392580986023
Iteration: 3800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742515683174133, gen p mean: -0.2337998002767563, mean p set: 0.4480014741420746
loss_pred:0.014622033573687077, decouple_loss:0.0022129120770841837
The modified gen p mean: 0.4480914771556854, gen p mean: -0.2365838587284088, mean p set: 0.4486646354198456
loss_pred:0.014327047392725945, decouple_loss:0.00197747559286654
The modified gen p mean: 0.4477025270462036, gen p mean: -0.24093197286128998, mean p set: 0.4482314884662628
loss_pred:0.014521284028887749, decouple_loss:0.0019983367528766394
2023-04-27 18:29:34 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23311233520507812, mean p set: 0.4499112665653229
loss_pred:0.015338154509663582, decouple_loss:0.002146832412108779
The modified gen p mean: 0.44930413365364075, gen p mean: -0.23294243216514587, mean p set: 0.4498290419578552
loss_pred:0.014832999557256699, decouple_loss:0.002200615592300892
The modified gen p mean: 0.4482223689556122, gen p mean: -0.23064452409744263, mean p set: 0.44879910349845886
loss_pred:0.015242869034409523, decouple_loss:0.0020906736608594656
WV_1_PC_1_EH_0_PS_30, loss: 0.01524531003087759, avg_mse: 0.022301416844129562
current test mse: 0.022301
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 3801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476143717765808, gen p mean: -0.22935469448566437, mean p set: 0.44814345240592957
loss_pred:0.014897490851581097, decouple_loss:0.001939574722200632
The modified gen p mean: 0.4471678137779236, gen p mean: -0.22560884058475494, mean p set: 0.4477371871471405
loss_pred:0.014236440882086754, decouple_loss:0.001894247136078775
The modified gen p mean: 0.4486657977104187, gen p mean: -0.23260599374771118, mean p set: 0.44923779368400574
loss_pred:0.014479466713964939, decouple_loss:0.001835780800320208
Iteration: 3802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879788160324097, gen p mean: -0.23915746808052063, mean p set: 0.4493279755115509
loss_pred:0.013098149560391903, decouple_loss:0.0021507441997528076
The modified gen p mean: 0.44746339321136475, gen p mean: -0.23416738212108612, mean p set: 0.44803765416145325
The modified gen p mean: 0.4467006325721741, gen p mean: -0.2353903353214264, mean p set: 0.4472704529762268
loss_pred:0.014446363784372807, decouple_loss:0.0019386272178962827
loss_pred:0.014236663468182087, decouple_loss:0.0018698136555030942
Iteration: 3803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974997639656067, gen p mean: -0.23287692666053772, mean p set: 0.4502794146537781
loss_pred:0.014114713296294212, decouple_loss:0.002157694660127163
The modified gen p mean: 0.4499438405036926, gen p mean: -0.2298833280801773, mean p set: 0.4505176842212677
The modified gen p mean: 0.4489099085330963, gen p mean: -0.24176453053951263, mean p set: 0.4494871497154236
loss_pred:0.013604339212179184, decouple_loss:0.002039796207100153
loss_pred:0.01273723877966404, decouple_loss:0.0024139410816133022
Iteration: 3804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733554124832153, gen p mean: -0.23425260186195374, mean p set: 0.44786569476127625
loss_pred:0.013877029530704021, decouple_loss:0.001843525329604745
The modified gen p mean: 0.44966116547584534, gen p mean: -0.23290853202342987, mean p set: 0.4502353370189667
The modified gen p mean: 0.4474530518054962, gen p mean: -0.23316916823387146, mean p set: 0.4480287730693817
loss_pred:0.013659526593983173, decouple_loss:0.0019835997372865677
loss_pred:0.01493487786501646, decouple_loss:0.0017693648114800453
Iteration: 3805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490726888179779, gen p mean: -0.24477112293243408, mean p set: 0.4496400058269501
loss_pred:0.013894014991819859, decouple_loss:0.002145793056115508
The modified gen p mean: 0.4488026201725006, gen p mean: -0.244431734085083, mean p set: 0.4493709206581116
The modified gen p mean: 0.44764813780784607, gen p mean: -0.23360398411750793, mean p set: 0.4481779932975769
loss_pred:0.014478839002549648, decouple_loss:0.0021389240864664316
loss_pred:0.01474035531282425, decouple_loss:0.0019128824351355433
Iteration: 3806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45156726241111755, gen p mean: -0.238809272646904, mean p set: 0.4521370232105255
loss_pred:0.013981514610350132, decouple_loss:0.0022092508152127266
The modified gen p mean: 0.448318749666214, gen p mean: -0.24273893237113953, mean p set: 0.44884639978408813The modified gen p mean: 0.44788843393325806, gen p mean: -0.2422599047422409, mean p set: 0.44846272468566895
loss_pred:0.013039899058640003, decouple_loss:0.001981375040486455
loss_pred:0.013995522633194923, decouple_loss:0.001944015733897686
Iteration: 3807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481457769870758, gen p mean: -0.24337609112262726, mean p set: 0.44867387413978577
loss_pred:0.014199396595358849, decouple_loss:0.002157545415684581
The modified gen p mean: 0.4485265910625458, gen p mean: -0.23643521964550018, mean p set: 0.44910773634910583The modified gen p mean: 0.44952329993247986, gen p mean: -0.24139362573623657, mean p set: 0.45009157061576843
loss_pred:0.01335952803492546, decouple_loss:0.0019073846051469445loss_pred:0.013303829357028008, decouple_loss:0.001939319772645831
Iteration: 3808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488062858581543, gen p mean: -0.2339877039194107, mean p set: 0.4493841528892517
loss_pred:0.013927992433309555, decouple_loss:0.00197772984392941
The modified gen p mean: 0.44798147678375244, gen p mean: -0.23270973563194275, mean p set: 0.4485572874546051
loss_pred:0.01441091950982809, decouple_loss:0.001873430097475648
The modified gen p mean: 0.4478153586387634, gen p mean: -0.23409216105937958, mean p set: 0.44833314418792725
loss_pred:0.01475061196833849, decouple_loss:0.00203660037368536
Iteration: 3809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448534220457077, gen p mean: -0.24480758607387543, mean p set: 0.44910797476768494
loss_pred:0.013558079488575459, decouple_loss:0.0021172878332436085
The modified gen p mean: 0.44785696268081665, gen p mean: -0.24346253275871277, mean p set: 0.44843384623527527
loss_pred:0.014106148853898048, decouple_loss:0.0020411915611475706
The modified gen p mean: 0.44888409972190857, gen p mean: -0.2432388812303543, mean p set: 0.4494149386882782
loss_pred:0.014275424182415009, decouple_loss:0.0020573651418089867
Iteration: 3810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716978073120117, gen p mean: -0.23650966584682465, mean p set: 0.447748064994812
loss_pred:0.013854957185685635, decouple_loss:0.0018669894197955728
The modified gen p mean: 0.4483684003353119, gen p mean: -0.24307961761951447, mean p set: 0.44889771938323975The modified gen p mean: 0.4496246874332428, gen p mean: -0.2493613213300705, mean p set: 0.45020073652267456
loss_pred:0.013122751377522945, decouple_loss:0.002208495745435357
loss_pred:0.015073939226567745, decouple_loss:0.0017581632127985358
2023-04-27 18:33:39 testing...
The modified gen p mean: 0.44822853803634644, gen p mean: -0.24188858270645142, mean p set: 0.44879910349845886
loss_pred:0.015244528651237488, decouple_loss:0.0021188617683947086
The modified gen p mean: 0.449301153421402, gen p mean: -0.24422484636306763, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.244389608502388, mean p set: 0.4499112665653229loss_pred:0.014906574040651321, decouple_loss:0.0023878407664597034
loss_pred:0.015370874665677547, decouple_loss:0.002007349394261837
WV_1_PC_1_EH_0_PS_30, loss: 0.015282560139894485, avg_mse: 0.022403178736567497
current test mse: 0.022403
Iteration: 3811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483526051044464, gen p mean: -0.24197037518024445, mean p set: 0.44887375831604004
loss_pred:0.014805556274950504, decouple_loss:0.0020755953155457973
The modified gen p mean: 0.4496592879295349, gen p mean: -0.24373836815357208, mean p set: 0.45023879408836365
loss_pred:0.01422015018761158, decouple_loss:0.0019587769638746977
The modified gen p mean: 0.44724640250205994, gen p mean: -0.23870739340782166, mean p set: 0.44782793521881104
loss_pred:0.01443333551287651, decouple_loss:0.0018045093165710568
Iteration: 3812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487546980381012, gen p mean: -0.2374902069568634, mean p set: 0.4492860734462738
loss_pred:0.013910670764744282, decouple_loss:0.002031362848356366
The modified gen p mean: 0.4475550055503845, gen p mean: -0.2440938651561737, mean p set: 0.4481402039527893
The modified gen p mean: 0.4486306607723236, gen p mean: -0.24528226256370544, mean p set: 0.44920656085014343
loss_pred:0.014124073088169098, decouple_loss:0.0018247402040287852
loss_pred:0.014103970490396023, decouple_loss:0.0019890840630978346
Iteration: 3813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480641186237335, gen p mean: -0.2411627173423767, mean p set: 0.44859644770622253
loss_pred:0.014018971472978592, decouple_loss:0.0019368218490853906
The modified gen p mean: 0.4492585361003876, gen p mean: -0.24093657732009888, mean p set: 0.4498351216316223
The modified gen p mean: 0.44733548164367676, gen p mean: -0.24323564767837524, mean p set: 0.4479064643383026
loss_pred:0.013665979728102684, decouple_loss:0.002028749557211995
loss_pred:0.014070626348257065, decouple_loss:0.0019041091436520219
Iteration: 3814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065703988075256, gen p mean: -0.23258985579013824, mean p set: 0.45123034715652466
loss_pred:0.013608310371637344, decouple_loss:0.0018749656155705452
The modified gen p mean: 0.44903066754341125, gen p mean: -0.2370804101228714, mean p set: 0.4495624303817749The modified gen p mean: 0.44681861996650696, gen p mean: -0.23352506756782532, mean p set: 0.447394996881485
loss_pred:0.013553486205637455, decouple_loss:0.00196662126109004
loss_pred:0.01380726508796215, decouple_loss:0.001792784663848579
Iteration: 3815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470151364803314, gen p mean: -0.2409895956516266, mean p set: 0.4475933015346527
loss_pred:0.014374789781868458, decouple_loss:0.002157263457775116
The modified gen p mean: 0.4474010169506073, gen p mean: -0.23630094528198242, mean p set: 0.4479774832725525The modified gen p mean: 0.44851574301719666, gen p mean: -0.23922239243984222, mean p set: 0.44904303550720215
loss_pred:0.013642522506415844, decouple_loss:0.002095736563205719
loss_pred:0.014492461457848549, decouple_loss:0.0020353158470243216
Iteration: 3816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733649492263794, gen p mean: -0.23297271132469177, mean p set: 0.4479128420352936
loss_pred:0.013787181116640568, decouple_loss:0.00206594611518085
The modified gen p mean: 0.44814127683639526, gen p mean: -0.2339724600315094, mean p set: 0.44867458939552307The modified gen p mean: 0.4477598965167999, gen p mean: -0.23846568167209625, mean p set: 0.4483363628387451
loss_pred:0.014523807913064957, decouple_loss:0.0019907827954739332
loss_pred:0.014650700613856316, decouple_loss:0.0018990796525031328
Iteration: 3817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471685588359833, gen p mean: -0.24318674206733704, mean p set: 0.4477499723434448
loss_pred:0.013952364213764668, decouple_loss:0.0019356232369318604
The modified gen p mean: 0.44830289483070374, gen p mean: -0.23933717608451843, mean p set: 0.4488815367221832
loss_pred:0.01497700810432434, decouple_loss:0.001963988645002246
The modified gen p mean: 0.44889867305755615, gen p mean: -0.24254842102527618, mean p set: 0.4494233727455139
loss_pred:0.014227010309696198, decouple_loss:0.001959677319973707
Iteration: 3818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465980529785156, gen p mean: -0.24816292524337769, mean p set: 0.447174608707428
loss_pred:0.014605349861085415, decouple_loss:0.0018862817669287324
The modified gen p mean: 0.4499051570892334, gen p mean: -0.236128032207489, mean p set: 0.4504365622997284The modified gen p mean: 0.4481038749217987, gen p mean: -0.24751058220863342, mean p set: 0.44867774844169617
loss_pred:0.014293095096945763, decouple_loss:0.0017842208035290241
loss_pred:0.013315639458596706, decouple_loss:0.0018657214241102338
Iteration: 3819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009613037109375, gen p mean: -0.23677478730678558, mean p set: 0.45067334175109863
loss_pred:0.013549288734793663, decouple_loss:0.001996265724301338
The modified gen p mean: 0.44732430577278137, gen p mean: -0.24119828641414642, mean p set: 0.4478965699672699
loss_pred:0.014148474670946598, decouple_loss:0.002082746708765626
The modified gen p mean: 0.4486501216888428, gen p mean: -0.239969402551651, mean p set: 0.449176549911499
loss_pred:0.014094081707298756, decouple_loss:0.002124019432812929
Iteration: 3820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902434945106506, gen p mean: -0.2484539896249771, mean p set: 0.4496042728424072
loss_pred:0.012785088270902634, decouple_loss:0.0021298089995980263
The modified gen p mean: 0.4489830434322357, gen p mean: -0.23679383099079132, mean p set: 0.449554443359375
loss_pred:0.01396010909229517, decouple_loss:0.0019087587716057897
The modified gen p mean: 0.44833844900131226, gen p mean: -0.24124731123447418, mean p set: 0.44885799288749695
loss_pred:0.013743855990469456, decouple_loss:0.0019968710839748383
2023-04-27 18:37:06 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24147455394268036, mean p set: 0.4499112665653229
loss_pred:0.015416562557220459, decouple_loss:0.0020265330094844103
The modified gen p mean: 0.449298620223999, gen p mean: -0.24142655730247498, mean p set: 0.4498290419578552
loss_pred:0.014924673363566399, decouple_loss:0.0019215126521885395
The modified gen p mean: 0.4482231140136719, gen p mean: -0.23887068033218384, mean p set: 0.44879910349845886
loss_pred:0.015245416201651096, decouple_loss:0.0020291812252253294
WV_1_PC_1_EH_0_PS_30, loss: 0.015295170247554779, avg_mse: 0.02246827632188797
current test mse: 0.022468
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 3821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476867616176605, gen p mean: -0.247921422123909, mean p set: 0.4482157230377197
loss_pred:0.014868516474962234, decouple_loss:0.0019610379822552204
The modified gen p mean: 0.4477808177471161, gen p mean: -0.24526867270469666, mean p set: 0.4483576714992523
loss_pred:0.01534762978553772, decouple_loss:0.0019145659171044827
The modified gen p mean: 0.4483499228954315, gen p mean: -0.23973898589611053, mean p set: 0.44892874360084534
loss_pred:0.014691967517137527, decouple_loss:0.00208003306761384
Iteration: 3822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774484634399414, gen p mean: -0.241928830742836, mean p set: 0.4482753276824951
loss_pred:0.01512568723410368, decouple_loss:0.002082855673506856
The modified gen p mean: 0.4480273425579071, gen p mean: -0.2379899024963379, mean p set: 0.44859760999679565
The modified gen p mean: 0.4474564790725708, gen p mean: -0.2444290667772293, mean p set: 0.44802939891815186
loss_pred:0.015555852092802525, decouple_loss:0.0019545042887330055
loss_pred:0.015078706666827202, decouple_loss:0.0019022183259949088
Iteration: 3823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447401225566864, gen p mean: -0.23800118267536163, mean p set: 0.44792643189430237
loss_pred:0.014886762946844101, decouple_loss:0.0017951935296878219
The modified gen p mean: 0.44776758551597595, gen p mean: -0.24273234605789185, mean p set: 0.448341965675354
The modified gen p mean: 0.4475371241569519, gen p mean: -0.2398536652326584, mean p set: 0.4481166899204254
loss_pred:0.015072272159159184, decouple_loss:0.0018119510496035218
loss_pred:0.015131634660065174, decouple_loss:0.0019078028853982687
Iteration: 3824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772061705589294, gen p mean: -0.24192707240581512, mean p set: 0.4482516348361969
loss_pred:0.015044555999338627, decouple_loss:0.0019340993603691459
The modified gen p mean: 0.44782498478889465, gen p mean: -0.24220936000347137, mean p set: 0.44839832186698914
The modified gen p mean: 0.44769087433815, gen p mean: -0.24139724671840668, mean p set: 0.44826412200927734
loss_pred:0.014260733500123024, decouple_loss:0.0019404649501666427
loss_pred:0.015005123801529408, decouple_loss:0.0018052947707474232
Iteration: 3825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732344150543213, gen p mean: -0.2429167628288269, mean p set: 0.4478999972343445
loss_pred:0.014829713851213455, decouple_loss:0.0017940823454409838
The modified gen p mean: 0.4471514821052551, gen p mean: -0.246877983212471, mean p set: 0.4476796090602875The modified gen p mean: 0.4474193751811981, gen p mean: -0.24197135865688324, mean p set: 0.44799885153770447
loss_pred:0.014352524653077126, decouple_loss:0.0017892499454319477
loss_pred:0.014891603030264378, decouple_loss:0.0017065599095076323
Iteration: 3826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475294053554535, gen p mean: -0.24582597613334656, mean p set: 0.44810721278190613
loss_pred:0.014589290134608746, decouple_loss:0.0018446273170411587
The modified gen p mean: 0.4479024112224579, gen p mean: -0.23886440694332123, mean p set: 0.4484822154045105The modified gen p mean: 0.4480140209197998, gen p mean: -0.2398815006017685, mean p set: 0.4485490918159485
loss_pred:0.014572187326848507, decouple_loss:0.0018299845978617668
loss_pred:0.01530427485704422, decouple_loss:0.0019960992503911257
Iteration: 3827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732165336608887, gen p mean: -0.23671641945838928, mean p set: 0.44789719581604004
loss_pred:0.014352891594171524, decouple_loss:0.0017708983505144715
The modified gen p mean: 0.44780561327934265, gen p mean: -0.23747991025447845, mean p set: 0.4483332633972168The modified gen p mean: 0.44778838753700256, gen p mean: -0.24097108840942383, mean p set: 0.44836533069610596
loss_pred:0.014871977269649506, decouple_loss:0.0017623985186219215
loss_pred:0.014604846946895123, decouple_loss:0.0017518941313028336
Iteration: 3828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820091128349304, gen p mean: -0.2385302186012268, mean p set: 0.448775053024292
loss_pred:0.015341825783252716, decouple_loss:0.0020030862651765347
The modified gen p mean: 0.44744250178337097, gen p mean: -0.23738572001457214, mean p set: 0.4480193257331848
loss_pred:0.014570887200534344, decouple_loss:0.001988306175917387
The modified gen p mean: 0.44794920086860657, gen p mean: -0.2424730658531189, mean p set: 0.44847962260246277
loss_pred:0.0151281226426363, decouple_loss:0.0020713878329843283
Iteration: 3829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480247497558594, gen p mean: -0.23881202936172485, mean p set: 0.44859370589256287
loss_pred:0.014602582901716232, decouple_loss:0.002033021068200469
The modified gen p mean: 0.44822463393211365, gen p mean: -0.23881332576274872, mean p set: 0.4488089084625244
loss_pred:0.014953465200960636, decouple_loss:0.0019895900040864944
The modified gen p mean: 0.4476665258407593, gen p mean: -0.24111436307430267, mean p set: 0.44819650053977966
loss_pred:0.014114772900938988, decouple_loss:0.0018622864736244082
Iteration: 3830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485897719860077, gen p mean: -0.23977257311344147, mean p set: 0.4491655230522156
loss_pred:0.01448533684015274, decouple_loss:0.002410757588222623
The modified gen p mean: 0.44741636514663696, gen p mean: -0.24241270124912262, mean p set: 0.4479960799217224
loss_pred:0.014839896000921726, decouple_loss:0.0024921433068811893
The modified gen p mean: 0.4474527835845947, gen p mean: -0.24513158202171326, mean p set: 0.4479837417602539
loss_pred:0.014807437546551228, decouple_loss:0.002530964557081461
2023-04-27 18:41:11 testing...
The modified gen p mean: 0.4482232630252838, gen p mean: -0.24088402092456818, mean p set: 0.44879910349845886
loss_pred:0.015193059109151363, decouple_loss:0.002068153116852045
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24334914982318878, mean p set: 0.4499112665653229
loss_pred:0.015359942801296711, decouple_loss:0.0020276466384530067
The modified gen p mean: 0.44930317997932434, gen p mean: -0.2432391345500946, mean p set: 0.4498290419578552
loss_pred:0.014867056161165237, decouple_loss:0.002378150587901473
WV_1_PC_1_EH_0_PS_30, loss: 0.015247918665409088, avg_mse: 0.02239835448563099
current test mse: 0.022398
Iteration: 3831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787970185279846, gen p mean: -0.24224191904067993, mean p set: 0.44846177101135254
loss_pred:0.014532890170812607, decouple_loss:0.0018838373944163322
The modified gen p mean: 0.4482519328594208, gen p mean: -0.24504292011260986, mean p set: 0.4488312005996704
loss_pred:0.013948318548500538, decouple_loss:0.0018060257425531745
The modified gen p mean: 0.44775524735450745, gen p mean: -0.24330563843250275, mean p set: 0.44828298687934875
loss_pred:0.014901027083396912, decouple_loss:0.0017637473065406084
Iteration: 3832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472275376319885, gen p mean: -0.2451806515455246, mean p set: 0.4477587640285492
loss_pred:0.014597924426198006, decouple_loss:0.002471734769642353
The modified gen p mean: 0.4476258456707001, gen p mean: -0.2443719506263733, mean p set: 0.448201984167099
loss_pred:0.014141787774860859, decouple_loss:0.002242900198325515
The modified gen p mean: 0.4478551149368286, gen p mean: -0.2457418292760849, mean p set: 0.44843557476997375
loss_pred:0.014723672531545162, decouple_loss:0.002201453549787402
Iteration: 3833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476676285266876, gen p mean: -0.24615378677845, mean p set: 0.44819343090057373
loss_pred:0.0145896440371871, decouple_loss:0.00191431341227144
The modified gen p mean: 0.44803357124328613, gen p mean: -0.24284887313842773, mean p set: 0.4486139416694641
loss_pred:0.014278743416070938, decouple_loss:0.002052112016826868
The modified gen p mean: 0.4490646421909332, gen p mean: -0.23955599963665009, mean p set: 0.4496433436870575
loss_pred:0.014525918290019035, decouple_loss:0.002066016895696521
Iteration: 3834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478607773780823, gen p mean: -0.24247127771377563, mean p set: 0.44838467240333557
loss_pred:0.014202997088432312, decouple_loss:0.002147227991372347
The modified gen p mean: 0.448684424161911, gen p mean: -0.24449194967746735, mean p set: 0.44926151633262634
loss_pred:0.014325853437185287, decouple_loss:0.002316279336810112
The modified gen p mean: 0.44796499609947205, gen p mean: -0.23939499258995056, mean p set: 0.44854387640953064
loss_pred:0.014622796326875687, decouple_loss:0.0020500572863966227
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870272278785706, gen p mean: -0.23794278502464294, mean p set: 0.44928398728370667
loss_pred:0.014906149357557297, decouple_loss:0.0018124731723219156
The modified gen p mean: 0.4478532373905182, gen p mean: -0.23676852881908417, mean p set: 0.44843021035194397
loss_pred:0.01426379568874836, decouple_loss:0.001981970388442278
The modified gen p mean: 0.44818344712257385, gen p mean: -0.23745030164718628, mean p set: 0.4487065374851227
loss_pred:0.014220621436834335, decouple_loss:0.001981134759262204
Iteration: 3836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789788126945496, gen p mean: -0.248475581407547, mean p set: 0.44847777485847473
loss_pred:0.014506573788821697, decouple_loss:0.0019129127031192183
The modified gen p mean: 0.4480162560939789, gen p mean: -0.2489408403635025, mean p set: 0.44859638810157776
loss_pred:0.015203138813376427, decouple_loss:0.00213650637306273
The modified gen p mean: 0.4477892816066742, gen p mean: -0.24175941944122314, mean p set: 0.4483139216899872
loss_pred:0.014287656173110008, decouple_loss:0.0021996241994202137
Iteration: 3837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740620255470276, gen p mean: -0.24241018295288086, mean p set: 0.44797900319099426
loss_pred:0.014786815270781517, decouple_loss:0.0019402212928980589
The modified gen p mean: 0.4483337700366974, gen p mean: -0.24581357836723328, mean p set: 0.4489077031612396
loss_pred:0.013872799463570118, decouple_loss:0.0020253534894436598
The modified gen p mean: 0.44708219170570374, gen p mean: -0.2453998327255249, mean p set: 0.4476061165332794
loss_pred:0.014624816365540028, decouple_loss:0.0017954774666577578
Iteration: 3838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480922222137451, gen p mean: -0.2428208291530609, mean p set: 0.4486706554889679
loss_pred:0.013970596715807915, decouple_loss:0.001969414297491312
The modified gen p mean: 0.44831955432891846, gen p mean: -0.2374921292066574, mean p set: 0.44889721274375916The modified gen p mean: 0.44871991872787476, gen p mean: -0.2369627207517624, mean p set: 0.4492427408695221
loss_pred:0.01428556814789772, decouple_loss:0.002094932598993182
loss_pred:0.014344826340675354, decouple_loss:0.0018130230018869042
Iteration: 3839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448014497756958, gen p mean: -0.24059580266475677, mean p set: 0.4485950171947479
loss_pred:0.015037424862384796, decouple_loss:0.002113940427079797
The modified gen p mean: 0.44796743988990784, gen p mean: -0.24196816980838776, mean p set: 0.44854554533958435
loss_pred:0.013782942667603493, decouple_loss:0.0017625178443267941
The modified gen p mean: 0.44756534695625305, gen p mean: -0.24316442012786865, mean p set: 0.448095440864563
loss_pred:0.014502989128232002, decouple_loss:0.002036366844549775
Iteration: 3840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471907615661621, gen p mean: -0.25089240074157715, mean p set: 0.44776955246925354
loss_pred:0.014581091701984406, decouple_loss:0.002252967795357108
The modified gen p mean: 0.4477130174636841, gen p mean: -0.24564318358898163, mean p set: 0.44828253984451294
loss_pred:0.014565086923539639, decouple_loss:0.00268522254191339
The modified gen p mean: 0.44785600900650024, gen p mean: -0.24356350302696228, mean p set: 0.44838589429855347
loss_pred:0.014920329675078392, decouple_loss:0.00219476199708879
2023-04-27 18:44:36 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2450544536113739, mean p set: 0.4499112665653229
loss_pred:0.015393384732306004, decouple_loss:0.0021227195393294096
The modified gen p mean: 0.4493023455142975, gen p mean: -0.24498240649700165, mean p set: 0.4498290419578552
loss_pred:0.014888649806380272, decouple_loss:0.0018365975702181458
The modified gen p mean: 0.44822773337364197, gen p mean: -0.24289990961551666, mean p set: 0.44879910349845886
loss_pred:0.015210560522973537, decouple_loss:0.002089534653350711
WV_1_PC_1_EH_0_PS_30, loss: 0.015265013091266155, avg_mse: 0.022394636645913124
current test mse: 0.022395
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 3841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478568434715271, gen p mean: -0.24933256208896637, mean p set: 0.4483872950077057
loss_pred:0.014367055147886276, decouple_loss:0.0024538314901292324
The modified gen p mean: 0.4472147524356842, gen p mean: -0.24596822261810303, mean p set: 0.44778627157211304
loss_pred:0.01454963255673647, decouple_loss:0.0019455909496173263
The modified gen p mean: 0.4480098485946655, gen p mean: -0.24334955215454102, mean p set: 0.44859448075294495
loss_pred:0.014897423796355724, decouple_loss:0.0021242268849164248
Iteration: 3842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463423192501068, gen p mean: -0.2460673451423645, mean p set: 0.44687342643737793
loss_pred:0.015323308296501637, decouple_loss:0.0024631586857140064
The modified gen p mean: 0.44794607162475586, gen p mean: -0.24502351880073547, mean p set: 0.4485243558883667
The modified gen p mean: 0.44756659865379333, gen p mean: -0.24536237120628357, mean p set: 0.4481431543827057
loss_pred:0.014246949926018715, decouple_loss:0.002462532836943865
loss_pred:0.014497997239232063, decouple_loss:0.002698486438021064
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777587056159973, gen p mean: -0.24198120832443237, mean p set: 0.4483067989349365
loss_pred:0.015015524812042713, decouple_loss:0.002341508399695158
The modified gen p mean: 0.4474663734436035, gen p mean: -0.24277907609939575, mean p set: 0.44803762435913086
The modified gen p mean: 0.4482554495334625, gen p mean: -0.2439524531364441, mean p set: 0.4488321542739868
loss_pred:0.01477783266454935, decouple_loss:0.0024558440782129765
loss_pred:0.01426452025771141, decouple_loss:0.0020969908218830824
Iteration: 3844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718608260154724, gen p mean: -0.24219778180122375, mean p set: 0.4477066397666931
loss_pred:0.014640054665505886, decouple_loss:0.0022440538741648197
The modified gen p mean: 0.4475772976875305, gen p mean: -0.24133029580116272, mean p set: 0.44815605878829956
The modified gen p mean: 0.4465019702911377, gen p mean: -0.2424214631319046, mean p set: 0.4470709264278412
loss_pred:0.014189760200679302, decouple_loss:0.002368821296840906
loss_pred:0.015431593172252178, decouple_loss:0.002017511986196041
Iteration: 3845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465678632259369, gen p mean: -0.23963193595409393, mean p set: 0.44714486598968506
loss_pred:0.014671425335109234, decouple_loss:0.0024136947467923164
The modified gen p mean: 0.44875186681747437, gen p mean: -0.2440357506275177, mean p set: 0.44927650690078735The modified gen p mean: 0.44634810090065, gen p mean: -0.23718537390232086, mean p set: 0.4469250440597534
loss_pred:0.015565922483801842, decouple_loss:0.0020187837071716785
loss_pred:0.014026393182575703, decouple_loss:0.002348592272028327
Iteration: 3846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790226221084595, gen p mean: -0.23516248166561127, mean p set: 0.44847849011421204
loss_pred:0.014293127693235874, decouple_loss:0.001977713080123067
The modified gen p mean: 0.44719651341438293, gen p mean: -0.2309568226337433, mean p set: 0.44772249460220337The modified gen p mean: 0.4489152431488037, gen p mean: -0.2381201684474945, mean p set: 0.44949212670326233
loss_pred:0.014124359004199505, decouple_loss:0.0018750232411548495
loss_pred:0.014763366430997849, decouple_loss:0.0017911947797983885
Iteration: 3847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652318954467773, gen p mean: -0.23492945730686188, mean p set: 0.44710099697113037
loss_pred:0.014193719252943993, decouple_loss:0.001656454405747354
The modified gen p mean: 0.44808274507522583, gen p mean: -0.23271048069000244, mean p set: 0.4486530125141144The modified gen p mean: 0.44682711362838745, gen p mean: -0.2305319458246231, mean p set: 0.4473552703857422
loss_pred:0.015133697539567947, decouple_loss:0.00217260024510324
loss_pred:0.014576731249690056, decouple_loss:0.002685711719095707
Iteration: 3848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684702157974243, gen p mean: -0.23721370100975037, mean p set: 0.44742488861083984
loss_pred:0.01516680046916008, decouple_loss:0.0017973172944039106
The modified gen p mean: 0.4451407194137573, gen p mean: -0.23974913358688354, mean p set: 0.44571492075920105
loss_pred:0.01412980630993843, decouple_loss:0.002176149282604456
The modified gen p mean: 0.44875043630599976, gen p mean: -0.23738200962543488, mean p set: 0.44928810000419617
loss_pred:0.014501761645078659, decouple_loss:0.0018820787081494927
Iteration: 3849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739869236946106, gen p mean: -0.23739944398403168, mean p set: 0.4479806125164032
loss_pred:0.014238298870623112, decouple_loss:0.0018816851079463959
The modified gen p mean: 0.4480496942996979, gen p mean: -0.23961681127548218, mean p set: 0.4486336410045624
loss_pred:0.014430140145123005, decouple_loss:0.0018458780832588673
The modified gen p mean: 0.4483838379383087, gen p mean: -0.2404489815235138, mean p set: 0.4489142596721649
loss_pred:0.014037419110536575, decouple_loss:0.0018525870982557535
Iteration: 3850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473502039909363, gen p mean: -0.23300448060035706, mean p set: 0.4479168951511383
loss_pred:0.014087400399148464, decouple_loss:0.002128859981894493
The modified gen p mean: 0.4469829201698303, gen p mean: -0.2318876087665558, mean p set: 0.4475656747817993
loss_pred:0.014551430009305477, decouple_loss:0.0018456019461154938
The modified gen p mean: 0.4469449520111084, gen p mean: -0.23518995940685272, mean p set: 0.44747447967529297
loss_pred:0.014248068444430828, decouple_loss:0.0018213808070868254
2023-04-27 18:48:37 testing...
The modified gen p mean: 0.44822078943252563, gen p mean: -0.22882243990898132, mean p set: 0.44879910349845886
loss_pred:0.015268854796886444, decouple_loss:0.0019583695102483034
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23095540702342987, mean p set: 0.4499112665653229
loss_pred:0.015434370376169682, decouple_loss:0.0020482761319726706
The modified gen p mean: 0.44929778575897217, gen p mean: -0.23083771765232086, mean p set: 0.4498290419578552
loss_pred:0.01493624597787857, decouple_loss:0.0023537499364465475
WV_1_PC_1_EH_0_PS_30, loss: 0.015319163911044598, avg_mse: 0.022495871409773827
current test mse: 0.022496
Iteration: 3851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644156098365784, gen p mean: -0.23302407562732697, mean p set: 0.44701406359672546
loss_pred:0.014914419502019882, decouple_loss:0.0022349124774336815
The modified gen p mean: 0.44591474533081055, gen p mean: -0.23027826845645905, mean p set: 0.44649171829223633
loss_pred:0.014855057932436466, decouple_loss:0.0022764215245842934
The modified gen p mean: 0.44598135352134705, gen p mean: -0.23568426072597504, mean p set: 0.44651445746421814
loss_pred:0.013784806244075298, decouple_loss:0.001872206456027925
Iteration: 3852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821789860725403, gen p mean: -0.23149241507053375, mean p set: 0.4487445652484894
loss_pred:0.014416635036468506, decouple_loss:0.0021035578101873398
The modified gen p mean: 0.4456425905227661, gen p mean: -0.2312002331018448, mean p set: 0.4462227523326874
loss_pred:0.013956274837255478, decouple_loss:0.0018495284020900726
The modified gen p mean: 0.44786596298217773, gen p mean: -0.2303529679775238, mean p set: 0.44843539595603943
loss_pred:0.014020824804902077, decouple_loss:0.0017466589342802763
Iteration: 3853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471586346626282, gen p mean: -0.22916990518569946, mean p set: 0.44768208265304565
loss_pred:0.013927038758993149, decouple_loss:0.0020091275218874216
The modified gen p mean: 0.4477746784687042, gen p mean: -0.2319951355457306, mean p set: 0.4483468234539032
loss_pred:0.013890735805034637, decouple_loss:0.0019794029649347067
The modified gen p mean: 0.4460557997226715, gen p mean: -0.22993189096450806, mean p set: 0.4466347098350525
loss_pred:0.014017285779118538, decouple_loss:0.002105955732986331
Iteration: 3854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470193088054657, gen p mean: -0.23127888143062592, mean p set: 0.44754740595817566
loss_pred:0.015238780528306961, decouple_loss:0.001808939385227859
The modified gen p mean: 0.4458746314048767, gen p mean: -0.23577994108200073, mean p set: 0.4464513063430786
loss_pred:0.015011696144938469, decouple_loss:0.0022555324248969555
The modified gen p mean: 0.44719940423965454, gen p mean: -0.23187001049518585, mean p set: 0.44777190685272217
loss_pred:0.013749071396887302, decouple_loss:0.00206323922611773
Iteration: 3855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461326003074646, gen p mean: -0.2391539365053177, mean p set: 0.4467092752456665
loss_pred:0.014994364231824875, decouple_loss:0.0021802799310535192
The modified gen p mean: 0.44793617725372314, gen p mean: -0.2382657378911972, mean p set: 0.4485151767730713
The modified gen p mean: 0.4463454484939575, gen p mean: -0.2370220422744751, mean p set: 0.44687098264694214
loss_pred:0.013940914534032345, decouple_loss:0.0020354187581688166
loss_pred:0.013806421309709549, decouple_loss:0.0019753873348236084
Iteration: 3856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447653591632843, gen p mean: -0.24053357541561127, mean p set: 0.44823282957077026
loss_pred:0.014842374250292778, decouple_loss:0.0019937921315431595
The modified gen p mean: 0.44765588641166687, gen p mean: -0.2421952486038208, mean p set: 0.44818755984306335The modified gen p mean: 0.4485756754875183, gen p mean: -0.24156492948532104, mean p set: 0.44913914799690247
loss_pred:0.014616268686950207, decouple_loss:0.0022534080781042576
loss_pred:0.01454070582985878, decouple_loss:0.0019219497917219996
Iteration: 3857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699448347091675, gen p mean: -0.23660127818584442, mean p set: 0.44757208228111267
loss_pred:0.014022160321474075, decouple_loss:0.0017465421697124839
The modified gen p mean: 0.4482041001319885, gen p mean: -0.23579919338226318, mean p set: 0.44873204827308655The modified gen p mean: 0.445481538772583, gen p mean: -0.2386826127767563, mean p set: 0.4460570514202118
loss_pred:0.013838112354278564, decouple_loss:0.0017629540525376797
loss_pred:0.013946468941867352, decouple_loss:0.0019473973661661148
Iteration: 3858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805046916007996, gen p mean: -0.233660027384758, mean p set: 0.4486321210861206
loss_pred:0.014110133983194828, decouple_loss:0.0018383922288194299
The modified gen p mean: 0.4467184841632843, gen p mean: -0.23043708503246307, mean p set: 0.4472406804561615The modified gen p mean: 0.44873079657554626, gen p mean: -0.23414596915245056, mean p set: 0.44929662346839905
loss_pred:0.014083395712077618, decouple_loss:0.0020496034994721413
loss_pred:0.014610427431762218, decouple_loss:0.0020449154544621706
Iteration: 3859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719794392585754, gen p mean: -0.22840343415737152, mean p set: 0.4477720260620117
loss_pred:0.014323090203106403, decouple_loss:0.0018590453546494246
The modified gen p mean: 0.4485161006450653, gen p mean: -0.23790781199932098, mean p set: 0.449090838432312
loss_pred:0.014137538149952888, decouple_loss:0.0018354634521529078
The modified gen p mean: 0.446424275636673, gen p mean: -0.2302909940481186, mean p set: 0.44696107506752014
loss_pred:0.014615942724049091, decouple_loss:0.0017822630470618606
Iteration: 3860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653385877609253, gen p mean: -0.23230309784412384, mean p set: 0.4471120834350586
loss_pred:0.01440609060227871, decouple_loss:0.0018530358793213964
The modified gen p mean: 0.44658759236335754, gen p mean: -0.23416820168495178, mean p set: 0.44717034697532654
loss_pred:0.015172075480222702, decouple_loss:0.001984484726563096
The modified gen p mean: 0.446975976228714, gen p mean: -0.23454074561595917, mean p set: 0.4475022256374359
loss_pred:0.014419784769415855, decouple_loss:0.0017521957634016871
2023-04-27 18:52:03 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.23419730365276337, mean p set: 0.4499112665653229
loss_pred:0.015418924391269684, decouple_loss:0.0017620886210352182
The modified gen p mean: 0.4482221007347107, gen p mean: -0.23200176656246185, mean p set: 0.44879910349845886
loss_pred:0.015287484973669052, decouple_loss:0.0017500645481050014
The modified gen p mean: 0.4492994546890259, gen p mean: -0.23408441245555878, mean p set: 0.4498290419578552
loss_pred:0.014940187335014343, decouple_loss:0.0018733460456132889
WV_1_PC_1_EH_0_PS_30, loss: 0.015305290929973125, avg_mse: 0.02253960445523262
current test mse: 0.02254
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 3861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890376925468445, gen p mean: -0.2338539958000183, mean p set: 0.449429988861084
loss_pred:0.014727934263646603, decouple_loss:0.001638116897083819
The modified gen p mean: 0.4470558762550354, gen p mean: -0.2359795868396759, mean p set: 0.4476362466812134
loss_pred:0.015117458067834377, decouple_loss:0.0019595257472246885
The modified gen p mean: 0.4478949308395386, gen p mean: -0.2411617785692215, mean p set: 0.448469340801239
loss_pred:0.013980318792164326, decouple_loss:0.00187020399607718
Iteration: 3862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871094822883606, gen p mean: -0.23525050282478333, mean p set: 0.4492400586605072
loss_pred:0.014774955809116364, decouple_loss:0.002052749739959836
The modified gen p mean: 0.44963082671165466, gen p mean: -0.23705920577049255, mean p set: 0.450207382440567
The modified gen p mean: 0.4491300582885742, gen p mean: -0.22787247598171234, mean p set: 0.44971105456352234
loss_pred:0.013859253376722336, decouple_loss:0.0018376398365944624
loss_pred:0.014173444360494614, decouple_loss:0.002019995590671897
Iteration: 3863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813403487205505, gen p mean: -0.23675118386745453, mean p set: 0.44866296648979187
loss_pred:0.01460452750325203, decouple_loss:0.002459260867908597
The modified gen p mean: 0.44782009720802307, gen p mean: -0.23187415301799774, mean p set: 0.44840162992477417
The modified gen p mean: 0.44908466935157776, gen p mean: -0.23636478185653687, mean p set: 0.44965940713882446
loss_pred:0.01384066417813301, decouple_loss:0.002145160688087344
loss_pred:0.0134908277541399, decouple_loss:0.002210154663771391
Iteration: 3864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483739733695984, gen p mean: -0.23452147841453552, mean p set: 0.4489034116268158
loss_pred:0.013927171938121319, decouple_loss:0.0019356637494638562
The modified gen p mean: 0.44777217507362366, gen p mean: -0.23784862458705902, mean p set: 0.44834965467453003
The modified gen p mean: 0.44842708110809326, gen p mean: -0.23577654361724854, mean p set: 0.44900044798851013
loss_pred:0.014776378870010376, decouple_loss:0.0019033922581002116
loss_pred:0.013716816902160645, decouple_loss:0.0019475030712783337
Iteration: 3865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886213541030884, gen p mean: -0.23468933999538422, mean p set: 0.44943690299987793
loss_pred:0.013931813649833202, decouple_loss:0.0019251691410318017
The modified gen p mean: 0.44845134019851685, gen p mean: -0.23339858651161194, mean p set: 0.44897738099098206The modified gen p mean: 0.4487554728984833, gen p mean: -0.2314559817314148, mean p set: 0.44932955503463745
loss_pred:0.014348575845360756, decouple_loss:0.0019484054064378142
loss_pred:0.013592989183962345, decouple_loss:0.002172868000343442
Iteration: 3866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476105868816376, gen p mean: -0.22634276747703552, mean p set: 0.4481886029243469
loss_pred:0.01408255286514759, decouple_loss:0.0018237204058095813
The modified gen p mean: 0.44806772470474243, gen p mean: -0.229919895529747, mean p set: 0.4486420452594757The modified gen p mean: 0.4475640058517456, gen p mean: -0.23007909953594208, mean p set: 0.4480898678302765
loss_pred:0.014875171706080437, decouple_loss:0.0019446472870185971
loss_pred:0.014296268112957478, decouple_loss:0.0019097093027085066
Iteration: 3867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500991702079773, gen p mean: -0.2273951917886734, mean p set: 0.4506753385066986
loss_pred:0.013861356303095818, decouple_loss:0.0023353113792836666
The modified gen p mean: 0.4481256604194641, gen p mean: -0.23099888861179352, mean p set: 0.4486553370952606The modified gen p mean: 0.448575496673584, gen p mean: -0.23286809027194977, mean p set: 0.449150025844574
loss_pred:0.013833755627274513, decouple_loss:0.0023103223647922277
loss_pred:0.014357482083141804, decouple_loss:0.002139126416295767
Iteration: 3868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490501582622528, gen p mean: -0.22070267796516418, mean p set: 0.4496217370033264
loss_pred:0.013621669262647629, decouple_loss:0.001962590729817748
The modified gen p mean: 0.4488808512687683, gen p mean: -0.22981102764606476, mean p set: 0.44945937395095825
loss_pred:0.013037866912782192, decouple_loss:0.0018817565869539976
The modified gen p mean: 0.4485320746898651, gen p mean: -0.2302248477935791, mean p set: 0.4490663409233093
loss_pred:0.013680612668395042, decouple_loss:0.0020504624117165804
Iteration: 3869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868484139442444, gen p mean: -0.22910328209400177, mean p set: 0.4492567181587219
loss_pred:0.014229850843548775, decouple_loss:0.002091120695695281
The modified gen p mean: 0.44855764508247375, gen p mean: -0.2268550544977188, mean p set: 0.44913092255592346
loss_pred:0.01400852482765913, decouple_loss:0.0019830132368952036
The modified gen p mean: 0.44853076338768005, gen p mean: -0.22761660814285278, mean p set: 0.44905519485473633
loss_pred:0.014124646782875061, decouple_loss:0.0022712023928761482
Iteration: 3870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477563798427582, gen p mean: -0.23108738660812378, mean p set: 0.44832542538642883
loss_pred:0.014310375787317753, decouple_loss:0.0019776111003011465
The modified gen p mean: 0.4486209750175476, gen p mean: -0.22431735694408417, mean p set: 0.44919553399086
loss_pred:0.0141969695687294, decouple_loss:0.0021164787467569113
The modified gen p mean: 0.4487222135066986, gen p mean: -0.23164241015911102, mean p set: 0.44925642013549805
loss_pred:0.014519101940095425, decouple_loss:0.00202625198289752
2023-04-27 18:56:03 testing...
The modified gen p mean: 0.4482208490371704, gen p mean: -0.22973476350307465, mean p set: 0.44879910349845886
loss_pred:0.015386849641799927, decouple_loss:0.002309228992089629
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23215846717357635, mean p set: 0.4499112665653229
loss_pred:0.015534253790974617, decouple_loss:0.002276141196489334
The modified gen p mean: 0.4493061304092407, gen p mean: -0.23153917491436005, mean p set: 0.4498290419578552
loss_pred:0.01506065297871828, decouple_loss:0.0025460210163146257
WV_1_PC_1_EH_0_PS_30, loss: 0.01544610969722271, avg_mse: 0.022733371704816818
current test mse: 0.022733
Iteration: 3871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934654235839844, gen p mean: -0.23282231390476227, mean p set: 0.4499247372150421
loss_pred:0.013492987491190434, decouple_loss:0.0022464499343186617
The modified gen p mean: 0.4482501149177551, gen p mean: -0.23483368754386902, mean p set: 0.4488309919834137
loss_pred:0.014558913186192513, decouple_loss:0.0019157446222379804
The modified gen p mean: 0.4494064450263977, gen p mean: -0.23177103698253632, mean p set: 0.44993188977241516
loss_pred:0.014152659103274345, decouple_loss:0.0020989670883864164
Iteration: 3872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864141941070557, gen p mean: -0.22836428880691528, mean p set: 0.44916436076164246
loss_pred:0.013827046379446983, decouple_loss:0.001899281982332468
The modified gen p mean: 0.4473506212234497, gen p mean: -0.23564709722995758, mean p set: 0.4479256868362427
loss_pred:0.013732075691223145, decouple_loss:0.0018469338538125157
The modified gen p mean: 0.44849342107772827, gen p mean: -0.22903841733932495, mean p set: 0.4490686058998108
loss_pred:0.014577755704522133, decouple_loss:0.0018706695409491658
Iteration: 3873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447783499956131, gen p mean: -0.22498829662799835, mean p set: 0.4483124613761902
loss_pred:0.013628294691443443, decouple_loss:0.0020942618139088154
The modified gen p mean: 0.4484417736530304, gen p mean: -0.2269323617219925, mean p set: 0.4490225911140442
loss_pred:0.014269806444644928, decouple_loss:0.001907801954075694
The modified gen p mean: 0.4475301504135132, gen p mean: -0.22384296357631683, mean p set: 0.4480970501899719
loss_pred:0.013893680647015572, decouple_loss:0.002108403015881777
Iteration: 3874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487718343734741, gen p mean: -0.22024133801460266, mean p set: 0.44930222630500793
loss_pred:0.013964100740849972, decouple_loss:0.0019944861996918917
The modified gen p mean: 0.44831952452659607, gen p mean: -0.22780779004096985, mean p set: 0.4488929510116577
loss_pred:0.014270897023379803, decouple_loss:0.001874921377748251
The modified gen p mean: 0.4483114778995514, gen p mean: -0.2265414148569107, mean p set: 0.4488871097564697
loss_pred:0.013794336467981339, decouple_loss:0.0021476715337485075
Iteration: 3875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799360632896423, gen p mean: -0.22962495684623718, mean p set: 0.4485659599304199
loss_pred:0.014202960766851902, decouple_loss:0.002016128972172737
The modified gen p mean: 0.44724300503730774, gen p mean: -0.2308008074760437, mean p set: 0.4478180706501007
loss_pred:0.014753877185285091, decouple_loss:0.0018186889356002212
The modified gen p mean: 0.4487723410129547, gen p mean: -0.2314573973417282, mean p set: 0.44930025935173035
loss_pred:0.013641700148582458, decouple_loss:0.0022638309746980667
Iteration: 3876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498730003833771, gen p mean: -0.2327258288860321, mean p set: 0.4504498541355133
loss_pred:0.013671211898326874, decouple_loss:0.002043018350377679
The modified gen p mean: 0.44961515069007874, gen p mean: -0.23457585275173187, mean p set: 0.45019209384918213
loss_pred:0.014631346799433231, decouple_loss:0.001980449538677931
The modified gen p mean: 0.4483528137207031, gen p mean: -0.23045316338539124, mean p set: 0.4488828480243683
loss_pred:0.014231005683541298, decouple_loss:0.002183816395699978
Iteration: 3877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491327702999115, gen p mean: -0.2344219833612442, mean p set: 0.4497077465057373
loss_pred:0.013966957107186317, decouple_loss:0.0018917785491794348
The modified gen p mean: 0.4475928843021393, gen p mean: -0.2269396185874939, mean p set: 0.4481671154499054
loss_pred:0.01367159467190504, decouple_loss:0.002087346278131008
The modified gen p mean: 0.4483088552951813, gen p mean: -0.23647534847259521, mean p set: 0.44883859157562256
loss_pred:0.013507729396224022, decouple_loss:0.0018440958810970187
Iteration: 3878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479091167449951, gen p mean: -0.23218517005443573, mean p set: 0.4484882652759552
loss_pred:0.013657168485224247, decouple_loss:0.0018245637184008956
The modified gen p mean: 0.44798460602760315, gen p mean: -0.23218265175819397, mean p set: 0.44856372475624084
loss_pred:0.013857083395123482, decouple_loss:0.0018900560680776834
The modified gen p mean: 0.4487582743167877, gen p mean: -0.23060740530490875, mean p set: 0.4492858350276947
loss_pred:0.01359421294182539, decouple_loss:0.0018338151276111603
Iteration: 3879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478546977043152, gen p mean: -0.23499688506126404, mean p set: 0.4484257698059082
loss_pred:0.014219424687325954, decouple_loss:0.0017383972881361842
The modified gen p mean: 0.44783708453178406, gen p mean: -0.22874879837036133, mean p set: 0.44841691851615906
loss_pred:0.013617326505482197, decouple_loss:0.001812949194572866
The modified gen p mean: 0.44912537932395935, gen p mean: -0.23737607896327972, mean p set: 0.4496510326862335
loss_pred:0.014114688150584698, decouple_loss:0.0019281965214759111
Iteration: 3880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473852217197418, gen p mean: -0.23723293840885162, mean p set: 0.4479579031467438
loss_pred:0.014005042612552643, decouple_loss:0.002001943066716194
The modified gen p mean: 0.44934049248695374, gen p mean: -0.2324957698583603, mean p set: 0.44992080330848694
loss_pred:0.014703460969030857, decouple_loss:0.0018060330767184496
The modified gen p mean: 0.44777676463127136, gen p mean: -0.23128700256347656, mean p set: 0.44830384850502014
loss_pred:0.01343925204128027, decouple_loss:0.0016577583737671375
2023-04-27 18:59:29 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2342919558286667, mean p set: 0.4499112665653229
loss_pred:0.015524035319685936, decouple_loss:0.0019270007032901049
The modified gen p mean: 0.4493003189563751, gen p mean: -0.23414164781570435, mean p set: 0.4498290419578552
loss_pred:0.015051128342747688, decouple_loss:0.0022537389304488897
The modified gen p mean: 0.4482279419898987, gen p mean: -0.23191386461257935, mean p set: 0.44879910349845886
loss_pred:0.01543457806110382, decouple_loss:0.00198571989312768
WV_1_PC_1_EH_0_PS_30, loss: 0.015439355745911598, avg_mse: 0.022717004641890526
current test mse: 0.022717
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 3881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477256238460541, gen p mean: -0.2353239357471466, mean p set: 0.4482552707195282
loss_pred:0.014959788881242275, decouple_loss:0.0023133771028369665
The modified gen p mean: 0.44753554463386536, gen p mean: -0.2353726625442505, mean p set: 0.4481090009212494
loss_pred:0.014689167961478233, decouple_loss:0.0021106195636093616
The modified gen p mean: 0.4483194351196289, gen p mean: -0.23256656527519226, mean p set: 0.4488926827907562
loss_pred:0.015025535598397255, decouple_loss:0.002014747355133295
Iteration: 3882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481790363788605, gen p mean: -0.23744046688079834, mean p set: 0.44871145486831665
loss_pred:0.015088312327861786, decouple_loss:0.0019157531205564737
The modified gen p mean: 0.4480307698249817, gen p mean: -0.23974835872650146, mean p set: 0.44860783219337463
The modified gen p mean: 0.4475078880786896, gen p mean: -0.2370600700378418, mean p set: 0.4480845034122467
loss_pred:0.014237221330404282, decouple_loss:0.0017408147687092423
loss_pred:0.015123932622373104, decouple_loss:0.001834729453548789
Iteration: 3883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486115276813507, gen p mean: -0.23852728307247162, mean p set: 0.4491422176361084
loss_pred:0.01477722730487585, decouple_loss:0.002176399575546384
The modified gen p mean: 0.4477594792842865, gen p mean: -0.23896019160747528, mean p set: 0.44833654165267944
The modified gen p mean: 0.447581022977829, gen p mean: -0.2421768754720688, mean p set: 0.44816285371780396
loss_pred:0.01466788537800312, decouple_loss:0.0019304363522678614
loss_pred:0.013954102993011475, decouple_loss:0.0019140943186357617
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798457622528076, gen p mean: -0.23606210947036743, mean p set: 0.4485079050064087
loss_pred:0.014387930743396282, decouple_loss:0.0020569206681102514
The modified gen p mean: 0.44746890664100647, gen p mean: -0.23467032611370087, mean p set: 0.44804567098617554
The modified gen p mean: 0.4481939375400543, gen p mean: -0.2314576655626297, mean p set: 0.44876912236213684
loss_pred:0.014177750796079636, decouple_loss:0.0019347270717844367
loss_pred:0.014891279861330986, decouple_loss:0.0022739970590919256
Iteration: 3885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731763005256653, gen p mean: -0.23428094387054443, mean p set: 0.44789400696754456
loss_pred:0.014831793494522572, decouple_loss:0.0017379794735461473
The modified gen p mean: 0.447345107793808, gen p mean: -0.23496198654174805, mean p set: 0.4478755593299866The modified gen p mean: 0.4472503066062927, gen p mean: -0.23609857261180878, mean p set: 0.4478192627429962
loss_pred:0.013715979643166065, decouple_loss:0.0018270864384248853
loss_pred:0.014313316904008389, decouple_loss:0.001886895508505404
Iteration: 3886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834622740745544, gen p mean: -0.22911635041236877, mean p set: 0.44892382621765137
loss_pred:0.014344404451549053, decouple_loss:0.0022671809419989586
The modified gen p mean: 0.44936123490333557, gen p mean: -0.22907404601573944, mean p set: 0.4499371349811554
The modified gen p mean: 0.4478919208049774, gen p mean: -0.23074135184288025, mean p set: 0.4484177529811859
loss_pred:0.014601984061300755, decouple_loss:0.002414683112874627
loss_pred:0.014644197188317776, decouple_loss:0.002226092852652073
Iteration: 3887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485088586807251, gen p mean: -0.2285330891609192, mean p set: 0.44908908009529114
loss_pred:0.014787768013775349, decouple_loss:0.002047609770670533
The modified gen p mean: 0.4475002586841583, gen p mean: -0.2319837510585785, mean p set: 0.4480244815349579The modified gen p mean: 0.44909217953681946, gen p mean: -0.23128439486026764, mean p set: 0.4496676027774811
loss_pred:0.014963691122829914, decouple_loss:0.0021325533743947744
loss_pred:0.014514586888253689, decouple_loss:0.0018697732593864202
Iteration: 3888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811946153640747, gen p mean: -0.23029345273971558, mean p set: 0.44869568943977356
loss_pred:0.014594470150768757, decouple_loss:0.0018881477881222963
The modified gen p mean: 0.44849324226379395, gen p mean: -0.2331753671169281, mean p set: 0.4490683674812317
loss_pred:0.014042160473763943, decouple_loss:0.0018732162425294518
The modified gen p mean: 0.44869303703308105, gen p mean: -0.23021230101585388, mean p set: 0.44922152161598206
loss_pred:0.014847710728645325, decouple_loss:0.0020408297423273325
Iteration: 3889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841915369033813, gen p mean: -0.23876461386680603, mean p set: 0.4489997327327728
loss_pred:0.014517453499138355, decouple_loss:0.0018534748815000057
The modified gen p mean: 0.44762060046195984, gen p mean: -0.23858414590358734, mean p set: 0.44819530844688416
loss_pred:0.014688816852867603, decouple_loss:0.0018965658964589238
The modified gen p mean: 0.44777557253837585, gen p mean: -0.23594877123832703, mean p set: 0.4483044445514679
loss_pred:0.014894855208694935, decouple_loss:0.001898544724099338
Iteration: 3890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960498809814453, gen p mean: -0.2419729381799698, mean p set: 0.4501863420009613
loss_pred:0.014658158645033836, decouple_loss:0.0020946681033819914
The modified gen p mean: 0.44990795850753784, gen p mean: -0.240199014544487, mean p set: 0.45043665170669556The modified gen p mean: 0.44727617502212524, gen p mean: -0.23635467886924744, mean p set: 0.44785773754119873
loss_pred:0.01439301110804081, decouple_loss:0.0021477616392076015
loss_pred:0.014768642373383045, decouple_loss:0.001864794292487204
2023-04-27 19:03:31 testing...
The modified gen p mean: 0.44822263717651367, gen p mean: -0.23688417673110962, mean p set: 0.44879910349845886
loss_pred:0.01533025223761797, decouple_loss:0.001908166566863656
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23905329406261444, mean p set: 0.4499112665653229
loss_pred:0.015469340607523918, decouple_loss:0.0019375814590603113
The modified gen p mean: 0.4492987096309662, gen p mean: -0.23901118338108063, mean p set: 0.4498290419578552
loss_pred:0.014956913888454437, decouple_loss:0.002019409090280533
WV_1_PC_1_EH_0_PS_30, loss: 0.015349920839071274, avg_mse: 0.022584235295653343
current test mse: 0.022584
Iteration: 3891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471103549003601, gen p mean: -0.2393297553062439, mean p set: 0.447688490152359
loss_pred:0.014466282911598682, decouple_loss:0.0020922874100506306
The modified gen p mean: 0.44795557856559753, gen p mean: -0.23869992792606354, mean p set: 0.4485322833061218
loss_pred:0.014230302534997463, decouple_loss:0.0019378772703930736
The modified gen p mean: 0.448222279548645, gen p mean: -0.23973214626312256, mean p set: 0.4487592875957489
loss_pred:0.015484827570617199, decouple_loss:0.002171645872294903
Iteration: 3892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715261459350586, gen p mean: -0.23816709220409393, mean p set: 0.4476771950721741
loss_pred:0.015620960853993893, decouple_loss:0.0018042359733954072
The modified gen p mean: 0.45028406381607056, gen p mean: -0.24262335896492004, mean p set: 0.4508599638938904
loss_pred:0.014386554248631, decouple_loss:0.002228016499429941
The modified gen p mean: 0.44763946533203125, gen p mean: -0.24067729711532593, mean p set: 0.44820985198020935
loss_pred:0.014833394438028336, decouple_loss:0.0019648841116577387
Iteration: 3893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710013270378113, gen p mean: -0.23681625723838806, mean p set: 0.44762876629829407
loss_pred:0.015735642984509468, decouple_loss:0.0022970957215875387
The modified gen p mean: 0.4490979015827179, gen p mean: -0.24168545007705688, mean p set: 0.4496730864048004
loss_pred:0.014786561019718647, decouple_loss:0.0022080105263739824
The modified gen p mean: 0.44742387533187866, gen p mean: -0.23882003128528595, mean p set: 0.44799840450286865
loss_pred:0.015016262419521809, decouple_loss:0.002480512484908104
Iteration: 3894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831421971321106, gen p mean: -0.23911704123020172, mean p set: 0.4488394856452942
loss_pred:0.014367807656526566, decouple_loss:0.001920434646308422
The modified gen p mean: 0.4483124017715454, gen p mean: -0.23744042217731476, mean p set: 0.4488913416862488
loss_pred:0.015248600393533707, decouple_loss:0.001818212098442018
The modified gen p mean: 0.447279691696167, gen p mean: -0.23794607818126678, mean p set: 0.4478580951690674
loss_pred:0.014004969969391823, decouple_loss:0.0017431792803108692
Iteration: 3895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799572229385376, gen p mean: -0.2390156388282776, mean p set: 0.44857507944107056
loss_pred:0.014117109589278698, decouple_loss:0.0019426541402935982
The modified gen p mean: 0.44700759649276733, gen p mean: -0.24013902246952057, mean p set: 0.44758591055870056The modified gen p mean: 0.44820499420166016, gen p mean: -0.23747655749320984, mean p set: 0.4487335979938507
loss_pred:0.013960333541035652, decouple_loss:0.00203218637034297
loss_pred:0.01455191895365715, decouple_loss:0.00190532801207155
Iteration: 3896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494148790836334, gen p mean: -0.23716048896312714, mean p set: 0.4499906599521637
loss_pred:0.014284326694905758, decouple_loss:0.0018293238244950771
The modified gen p mean: 0.4479987621307373, gen p mean: -0.2390565723180771, mean p set: 0.44852176308631897The modified gen p mean: 0.4486091434955597, gen p mean: -0.23759973049163818, mean p set: 0.44918495416641235
loss_pred:0.014373071491718292, decouple_loss:0.0016903651412576437
loss_pred:0.014931850135326385, decouple_loss:0.0018213774310424924
Iteration: 3897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483804702758789, gen p mean: -0.23427702486515045, mean p set: 0.44895321130752563
loss_pred:0.01408240757882595, decouple_loss:0.0023753049317747355
The modified gen p mean: 0.44823360443115234, gen p mean: -0.23618844151496887, mean p set: 0.44880983233451843The modified gen p mean: 0.44836634397506714, gen p mean: -0.2362593114376068, mean p set: 0.448894202709198
loss_pred:0.015372417867183685, decouple_loss:0.0021803216077387333
loss_pred:0.015166309662163258, decouple_loss:0.0020275304559618235
Iteration: 3898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473191797733307, gen p mean: -0.23331351578235626, mean p set: 0.44789284467697144
loss_pred:0.014254234731197357, decouple_loss:0.0018770016031339765
The modified gen p mean: 0.44719111919403076, gen p mean: -0.23642972111701965, mean p set: 0.4477599561214447The modified gen p mean: 0.44706472754478455, gen p mean: -0.23469597101211548, mean p set: 0.4475880563259125
loss_pred:0.014016041532158852, decouple_loss:0.0016533400630578399
loss_pred:0.014692897908389568, decouple_loss:0.0016882700147107244
Iteration: 3899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477621614933014, gen p mean: -0.23461288213729858, mean p set: 0.44832760095596313
loss_pred:0.014203796163201332, decouple_loss:0.002301599131897092
The modified gen p mean: 0.4476796090602875, gen p mean: -0.2346266657114029, mean p set: 0.44825538992881775
loss_pred:0.014285778626799583, decouple_loss:0.002468041144311428
The modified gen p mean: 0.44811782240867615, gen p mean: -0.23406575620174408, mean p set: 0.4486456513404846
loss_pred:0.01480824500322342, decouple_loss:0.002426411025226116
Iteration: 3900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814833998680115, gen p mean: -0.22971642017364502, mean p set: 0.44872695207595825
loss_pred:0.014687303453683853, decouple_loss:0.0017954976065084338
The modified gen p mean: 0.44851261377334595, gen p mean: -0.23273655772209167, mean p set: 0.4490887224674225
The modified gen p mean: 0.4480985701084137, gen p mean: -0.23556984961032867, mean p set: 0.44861847162246704
loss_pred:0.01390615850687027, decouple_loss:0.0023875883780419827
loss_pred:0.014101692475378513, decouple_loss:0.001786941778846085
2023-04-27 19:06:56 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23406857252120972, mean p set: 0.4499112665653229
loss_pred:0.01550978422164917, decouple_loss:0.0026450951118022203
The modified gen p mean: 0.4492991864681244, gen p mean: -0.23391567170619965, mean p set: 0.4498290419578552
loss_pred:0.014988475479185581, decouple_loss:0.0023727952502667904
The modified gen p mean: 0.44821789860725403, gen p mean: -0.23181211948394775, mean p set: 0.44879910349845886
loss_pred:0.01532742753624916, decouple_loss:0.0028508398681879044
WV_1_PC_1_EH_0_PS_30, loss: 0.015406373888254166, avg_mse: 0.022638419643044472
current test mse: 0.022638
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 3901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751518964767456, gen p mean: -0.23255585134029388, mean p set: 0.4480440020561218
loss_pred:0.014346564188599586, decouple_loss:0.0024098753929138184
The modified gen p mean: 0.44668683409690857, gen p mean: -0.2383127510547638, mean p set: 0.4472668468952179
loss_pred:0.014241355471313, decouple_loss:0.0021653384901583195
The modified gen p mean: 0.44672513008117676, gen p mean: -0.23137371242046356, mean p set: 0.44730156660079956
loss_pred:0.014582764357328415, decouple_loss:0.00273014884442091
Iteration: 3902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475361406803131, gen p mean: -0.22871312499046326, mean p set: 0.44806838035583496
loss_pred:0.013993671163916588, decouple_loss:0.002129096770659089
The modified gen p mean: 0.44674161076545715, gen p mean: -0.2325802594423294, mean p set: 0.4473183751106262
The modified gen p mean: 0.4466860890388489, gen p mean: -0.2332739681005478, mean p set: 0.44726231694221497
loss_pred:0.014938080683350563, decouple_loss:0.0019176335772499442
loss_pred:0.014219735749065876, decouple_loss:0.002129392232745886
Iteration: 3903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473624527454376, gen p mean: -0.23198167979717255, mean p set: 0.44788506627082825
loss_pred:0.01432021614164114, decouple_loss:0.0019119540229439735
The modified gen p mean: 0.4462690055370331, gen p mean: -0.2342507541179657, mean p set: 0.446846604347229
The modified gen p mean: 0.44600921869277954, gen p mean: -0.23475179076194763, mean p set: 0.44658660888671875
loss_pred:0.014330564998090267, decouple_loss:0.002474864711984992
loss_pred:0.014548281207680702, decouple_loss:0.00231920275837183
Iteration: 3904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708186388015747, gen p mean: -0.22960692644119263, mean p set: 0.44760966300964355
loss_pred:0.01466700341552496, decouple_loss:0.002161124488338828
The modified gen p mean: 0.44634589552879333, gen p mean: -0.2327415496110916, mean p set: 0.44691479206085205
The modified gen p mean: 0.4465780556201935, gen p mean: -0.23410800099372864, mean p set: 0.4471500515937805
loss_pred:0.014883453957736492, decouple_loss:0.0022889396641403437
loss_pred:0.014820653945207596, decouple_loss:0.0022851901594549417
Iteration: 3905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450797736644745, gen p mean: -0.23343227803707123, mean p set: 0.44565579295158386
loss_pred:0.014377683401107788, decouple_loss:0.0023423333186656237
The modified gen p mean: 0.44647377729415894, gen p mean: -0.23146793246269226, mean p set: 0.44704607129096985
loss_pred:0.014014439657330513, decouple_loss:0.0023987069725990295
The modified gen p mean: 0.4453306496143341, gen p mean: -0.23353494703769684, mean p set: 0.445857435464859
loss_pred:0.014880470000207424, decouple_loss:0.0020056020002812147
Iteration: 3906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467158913612366, gen p mean: -0.23211048543453217, mean p set: 0.44729331135749817
loss_pred:0.014608589000999928, decouple_loss:0.0018639009213075042
The modified gen p mean: 0.44691744446754456, gen p mean: -0.23131942749023438, mean p set: 0.44749704003334045
loss_pred:0.01512629073113203, decouple_loss:0.0019431756809353828
The modified gen p mean: 0.44595015048980713, gen p mean: -0.23147344589233398, mean p set: 0.44647684693336487
loss_pred:0.015139060094952583, decouple_loss:0.0019888440147042274
Iteration: 3907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835150241851807, gen p mean: -0.234055757522583, mean p set: 0.4489297568798065
loss_pred:0.01370235811918974, decouple_loss:0.0018198172328993678
The modified gen p mean: 0.4466705024242401, gen p mean: -0.2339838445186615, mean p set: 0.44719746708869934The modified gen p mean: 0.4465271234512329, gen p mean: -0.23011468350887299, mean p set: 0.4471038281917572
loss_pred:0.01467179786413908, decouple_loss:0.002053535543382168
loss_pred:0.014332872815430164, decouple_loss:0.0023113295901566744
Iteration: 3908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44602563977241516, gen p mean: -0.23647645115852356, mean p set: 0.44659578800201416
loss_pred:0.014740821905434132, decouple_loss:0.0017798962071537971
The modified gen p mean: 0.4467085301876068, gen p mean: -0.23344410955905914, mean p set: 0.44728413224220276
loss_pred:0.014258679002523422, decouple_loss:0.001884512254036963
The modified gen p mean: 0.4460547864437103, gen p mean: -0.2365242838859558, mean p set: 0.4465794563293457
loss_pred:0.0144533421844244, decouple_loss:0.0017962701385840774
Iteration: 3909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446429044008255, gen p mean: -0.23517732322216034, mean p set: 0.4470020830631256
loss_pred:0.014401732943952084, decouple_loss:0.002044385066255927
The modified gen p mean: 0.4471476078033447, gen p mean: -0.23017676174640656, mean p set: 0.4477251172065735
loss_pred:0.014410688541829586, decouple_loss:0.0021639864426106215
The modified gen p mean: 0.44720548391342163, gen p mean: -0.23116113245487213, mean p set: 0.4477333426475525
loss_pred:0.015237306244671345, decouple_loss:0.0021556357387453318
Iteration: 3910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760316610336304, gen p mean: -0.230093315243721, mean p set: 0.44818106293678284
loss_pred:0.013924451544880867, decouple_loss:0.0018418728141114116
The modified gen p mean: 0.44632917642593384, gen p mean: -0.23934906721115112, mean p set: 0.44691362977027893
loss_pred:0.014563377015292645, decouple_loss:0.0016595105407759547
The modified gen p mean: 0.4468187093734741, gen p mean: -0.23429632186889648, mean p set: 0.4473506212234497
loss_pred:0.014571492560207844, decouple_loss:0.0017952562775462866
2023-04-27 19:11:00 testing...
The modified gen p mean: 0.4482196569442749, gen p mean: -0.23351985216140747, mean p set: 0.44879910349845886
loss_pred:0.015314550139009953, decouple_loss:0.0018593065906316042
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23567251861095428, mean p set: 0.4499112665653229
loss_pred:0.015437494032084942, decouple_loss:0.0018567037768661976
The modified gen p mean: 0.449298232793808, gen p mean: -0.2361084669828415, mean p set: 0.4498290419578552
loss_pred:0.014994580298662186, decouple_loss:0.0020475902128964663
WV_1_PC_1_EH_0_PS_30, loss: 0.015344935469329357, avg_mse: 0.022601209580898285
current test mse: 0.022601
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465750753879547, gen p mean: -0.23525919020175934, mean p set: 0.4471467435359955
loss_pred:0.014109479263424873, decouple_loss:0.0018886917969211936
The modified gen p mean: 0.44558051228523254, gen p mean: -0.23848851025104523, mean p set: 0.4461512565612793
loss_pred:0.014260872267186642, decouple_loss:0.0020498193334788084
The modified gen p mean: 0.4478994309902191, gen p mean: -0.23937736451625824, mean p set: 0.44842633605003357
loss_pred:0.013864558190107346, decouple_loss:0.001887224381789565
Iteration: 3912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469511806964874, gen p mean: -0.2383640706539154, mean p set: 0.44748565554618835
loss_pred:0.014046890661120415, decouple_loss:0.0016609948361292481
The modified gen p mean: 0.44726434350013733, gen p mean: -0.24109818041324615, mean p set: 0.44782721996307373
loss_pred:0.014101590029895306, decouple_loss:0.001604174030944705
The modified gen p mean: 0.4459700882434845, gen p mean: -0.23323111236095428, mean p set: 0.4465474784374237
loss_pred:0.014266788959503174, decouple_loss:0.001766624511219561
Iteration: 3913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447007417678833, gen p mean: -0.23345142602920532, mean p set: 0.4475364685058594
loss_pred:0.01403793040663004, decouple_loss:0.0021388994064182043
The modified gen p mean: 0.4462421238422394, gen p mean: -0.23748624324798584, mean p set: 0.44682133197784424
loss_pred:0.014427969232201576, decouple_loss:0.001971351681277156
The modified gen p mean: 0.44660884141921997, gen p mean: -0.23504813015460968, mean p set: 0.447183758020401
loss_pred:0.014482354745268822, decouple_loss:0.0021322721149772406
Iteration: 3914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465276002883911, gen p mean: -0.2356860488653183, mean p set: 0.44706007838249207
loss_pred:0.013965798541903496, decouple_loss:0.0016435711877420545
The modified gen p mean: 0.4469556510448456, gen p mean: -0.23564188182353973, mean p set: 0.44753265380859375
loss_pred:0.014086608774960041, decouple_loss:0.0016590359155088663
The modified gen p mean: 0.44651371240615845, gen p mean: -0.24086908996105194, mean p set: 0.44709545373916626
loss_pred:0.014212734997272491, decouple_loss:0.00161697156727314
Iteration: 3915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750189781188965, gen p mean: -0.23768290877342224, mean p set: 0.44807347655296326
loss_pred:0.014156726188957691, decouple_loss:0.0019449886167421937
The modified gen p mean: 0.44521504640579224, gen p mean: -0.23937220871448517, mean p set: 0.44578808546066284The modified gen p mean: 0.44668859243392944, gen p mean: -0.23854553699493408, mean p set: 0.44722166657447815
loss_pred:0.014202638529241085, decouple_loss:0.00196835957467556
loss_pred:0.014679993502795696, decouple_loss:0.0018251028377562761
Iteration: 3916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685909152030945, gen p mean: -0.2381657063961029, mean p set: 0.4474301338195801
loss_pred:0.014328356832265854, decouple_loss:0.0017653696704655886
The modified gen p mean: 0.4467850625514984, gen p mean: -0.24055629968643188, mean p set: 0.4473608434200287The modified gen p mean: 0.44675788283348083, gen p mean: -0.24283507466316223, mean p set: 0.44728177785873413
loss_pred:0.014457380399107933, decouple_loss:0.001681251684203744
loss_pred:0.014192087575793266, decouple_loss:0.001601510215550661
Iteration: 3917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44511184096336365, gen p mean: -0.236920565366745, mean p set: 0.4456845819950104
loss_pred:0.014442045241594315, decouple_loss:0.0021935279946774244
The modified gen p mean: 0.4462898373603821, gen p mean: -0.23631402850151062, mean p set: 0.446819543838501The modified gen p mean: 0.44602906703948975, gen p mean: -0.23527826368808746, mean p set: 0.4466037154197693
loss_pred:0.014717001467943192, decouple_loss:0.0019175634952262044
loss_pred:0.014515982940793037, decouple_loss:0.0020022611133754253
Iteration: 3918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767045974731445, gen p mean: -0.23320704698562622, mean p set: 0.4482450783252716
loss_pred:0.014223280362784863, decouple_loss:0.0016726834001019597
The modified gen p mean: 0.4464695155620575, gen p mean: -0.2394227832555771, mean p set: 0.44699564576148987The modified gen p mean: 0.4464245140552521, gen p mean: -0.2349504977464676, mean p set: 0.4469999372959137
loss_pred:0.014451678842306137, decouple_loss:0.0017563836881890893
loss_pred:0.014468585141003132, decouple_loss:0.0017777696484699845
Iteration: 3919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470493197441101, gen p mean: -0.23218348622322083, mean p set: 0.4476316571235657
loss_pred:0.014685540460050106, decouple_loss:0.0021462582517415285
The modified gen p mean: 0.44689127802848816, gen p mean: -0.23612529039382935, mean p set: 0.44746461510658264
loss_pred:0.014361999928951263, decouple_loss:0.0019084949744865298
The modified gen p mean: 0.4460049569606781, gen p mean: -0.23421300947666168, mean p set: 0.44653791189193726
loss_pred:0.014496774412691593, decouple_loss:0.002214417327195406
Iteration: 3920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466991126537323, gen p mean: -0.22943851351737976, mean p set: 0.44727569818496704
loss_pred:0.014212611131370068, decouple_loss:0.001734602265059948
The modified gen p mean: 0.44659358263015747, gen p mean: -0.2238045334815979, mean p set: 0.4471670687198639
loss_pred:0.014148901216685772, decouple_loss:0.0017130805645138025
The modified gen p mean: 0.4462798833847046, gen p mean: -0.23347990214824677, mean p set: 0.44680705666542053
loss_pred:0.014382846653461456, decouple_loss:0.0017933361232280731
2023-04-27 19:14:26 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22810909152030945, mean p set: 0.4499112665653229
loss_pred:0.015397903509438038, decouple_loss:0.002028080867603421
The modified gen p mean: 0.44930076599121094, gen p mean: -0.22857344150543213, mean p set: 0.4498290419578552
loss_pred:0.01501389779150486, decouple_loss:0.0021465097088366747
The modified gen p mean: 0.4482261836528778, gen p mean: -0.22576181590557098, mean p set: 0.44879910349845886
loss_pred:0.015391161665320396, decouple_loss:0.002057294826954603
WV_1_PC_1_EH_0_PS_30, loss: 0.015371519140899181, avg_mse: 0.022675126791000366
current test mse: 0.022675
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 3921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467448592185974, gen p mean: -0.230443075299263, mean p set: 0.4472716748714447
loss_pred:0.015176179818809032, decouple_loss:0.0023370315320789814
The modified gen p mean: 0.4465809762477875, gen p mean: -0.2294417917728424, mean p set: 0.44715800881385803
loss_pred:0.013523071072995663, decouple_loss:0.0020872261375188828
The modified gen p mean: 0.4474569261074066, gen p mean: -0.23314668238162994, mean p set: 0.4480327367782593
loss_pred:0.01413971558213234, decouple_loss:0.002214125357568264
Iteration: 3922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483583867549896, gen p mean: -0.2235783189535141, mean p set: 0.44888240098953247
loss_pred:0.013773823156952858, decouple_loss:0.0021554064005613327
The modified gen p mean: 0.4475994110107422, gen p mean: -0.22904334962368011, mean p set: 0.44817930459976196
The modified gen p mean: 0.4477081298828125, gen p mean: -0.22995130717754364, mean p set: 0.4482881724834442
loss_pred:0.014314831234514713, decouple_loss:0.001842182595282793
loss_pred:0.014089035801589489, decouple_loss:0.001956371823325753
Iteration: 3923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44632548093795776, gen p mean: -0.23729656636714935, mean p set: 0.4468553960323334
loss_pred:0.014269545674324036, decouple_loss:0.002225741744041443
The modified gen p mean: 0.44707170128822327, gen p mean: -0.2263464778661728, mean p set: 0.4476470947265625
The modified gen p mean: 0.4472888112068176, gen p mean: -0.2317754328250885, mean p set: 0.44785767793655396
loss_pred:0.013924873434007168, decouple_loss:0.0024317007046192884
loss_pred:0.014741651713848114, decouple_loss:0.0021947012282907963
Iteration: 3924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658398628234863, gen p mean: -0.23874174058437347, mean p set: 0.4471111297607422
loss_pred:0.014088805764913559, decouple_loss:0.001957426080480218
The modified gen p mean: 0.4471012353897095, gen p mean: -0.23042996227741241, mean p set: 0.4476735293865204
The modified gen p mean: 0.4468556344509125, gen p mean: -0.23619143664836884, mean p set: 0.44743743538856506
loss_pred:0.014271073043346405, decouple_loss:0.0019318367121741176
loss_pred:0.014353269711136818, decouple_loss:0.0020627942867577076
Iteration: 3925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447083055973053, gen p mean: -0.23239335417747498, mean p set: 0.44765499234199524
loss_pred:0.01425638236105442, decouple_loss:0.002310080686584115
The modified gen p mean: 0.44665825366973877, gen p mean: -0.23364749550819397, mean p set: 0.4471876323223114The modified gen p mean: 0.4481164216995239, gen p mean: -0.2259128838777542, mean p set: 0.44869264960289
loss_pred:0.014466837048530579, decouple_loss:0.0022647122386842966
loss_pred:0.013882843777537346, decouple_loss:0.002477548783645034
Iteration: 3926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465109705924988, gen p mean: -0.230243518948555, mean p set: 0.44708362221717834
loss_pred:0.014216127805411816, decouple_loss:0.0018405701266601682
The modified gen p mean: 0.44657009840011597, gen p mean: -0.2292814403772354, mean p set: 0.4471038579940796The modified gen p mean: 0.4468216896057129, gen p mean: -0.22990627586841583, mean p set: 0.44739529490470886
loss_pred:0.013816168531775475, decouple_loss:0.0019062584033235908
loss_pred:0.015040027908980846, decouple_loss:0.0019555380567908287
Iteration: 3927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446759432554245, gen p mean: -0.23035188019275665, mean p set: 0.4473371207714081
loss_pred:0.01331632025539875, decouple_loss:0.002373065333813429
The modified gen p mean: 0.4471540153026581, gen p mean: -0.23019635677337646, mean p set: 0.4476839005947113The modified gen p mean: 0.44600367546081543, gen p mean: -0.22999237477779388, mean p set: 0.4465774595737457
loss_pred:0.014797067269682884, decouple_loss:0.0019901723135262728
loss_pred:0.013011460192501545, decouple_loss:0.0023904829286038876
Iteration: 3928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468347132205963, gen p mean: -0.22892127931118011, mean p set: 0.447416752576828
loss_pred:0.013746252283453941, decouple_loss:0.001881134114228189
The modified gen p mean: 0.4467989206314087, gen p mean: -0.22981752455234528, mean p set: 0.44732168316841125The modified gen p mean: 0.4477553069591522, gen p mean: -0.2293016016483307, mean p set: 0.44832831621170044
loss_pred:0.01457362063229084, decouple_loss:0.001962570706382394
loss_pred:0.01368944626301527, decouple_loss:0.0018944552866742015
Iteration: 3929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475674033164978, gen p mean: -0.2294519692659378, mean p set: 0.44814640283584595
loss_pred:0.014500629156827927, decouple_loss:0.0019375741248950362
The modified gen p mean: 0.44733962416648865, gen p mean: -0.23750706017017365, mean p set: 0.4478755593299866The modified gen p mean: 0.44709542393684387, gen p mean: -0.22893846035003662, mean p set: 0.4476739168167114
loss_pred:0.014421130530536175, decouple_loss:0.0019502583891153336
loss_pred:0.014490125700831413, decouple_loss:0.0019625164568424225
Iteration: 3930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466007649898529, gen p mean: -0.2358960211277008, mean p set: 0.44717565178871155
loss_pred:0.014442108571529388, decouple_loss:0.0019298478728160262
The modified gen p mean: 0.4481092095375061, gen p mean: -0.23205925524234772, mean p set: 0.4486280083656311The modified gen p mean: 0.4472223222255707, gen p mean: -0.23043130338191986, mean p set: 0.4477977156639099
loss_pred:0.013750342652201653, decouple_loss:0.001865807338617742
loss_pred:0.013646910898387432, decouple_loss:0.0018734814366325736
2023-04-27 19:18:39 testing...
The modified gen p mean: 0.4482247829437256, gen p mean: -0.22955043613910675, mean p set: 0.44879910349845886
loss_pred:0.01555914618074894, decouple_loss:0.002069043694064021
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23182782530784607, mean p set: 0.4499112665653229
loss_pred:0.015588603913784027, decouple_loss:0.0021809509489685297
The modified gen p mean: 0.44929876923561096, gen p mean: -0.23215806484222412, mean p set: 0.4498290419578552
loss_pred:0.01509888470172882, decouple_loss:0.002141913864761591
WV_1_PC_1_EH_0_PS_30, loss: 0.015522075816988945, avg_mse: 0.02290443517267704
current test mse: 0.022904
Iteration: 3931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480525255203247, gen p mean: -0.22615355253219604, mean p set: 0.44862768054008484
loss_pred:0.013591410592198372, decouple_loss:0.0021187325473874807
The modified gen p mean: 0.4464278817176819, gen p mean: -0.2346501350402832, mean p set: 0.4470026195049286
loss_pred:0.01416537631303072, decouple_loss:0.0020063926931470633
The modified gen p mean: 0.4471122920513153, gen p mean: -0.23255445063114166, mean p set: 0.44764021039009094
loss_pred:0.014528090134263039, decouple_loss:0.002107613254338503
Iteration: 3932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481291174888611, gen p mean: -0.23017525672912598, mean p set: 0.4486611485481262
loss_pred:0.014537601731717587, decouple_loss:0.002187195932492614
The modified gen p mean: 0.44630196690559387, gen p mean: -0.22598034143447876, mean p set: 0.44688504934310913
loss_pred:0.013701241463422775, decouple_loss:0.002054029842838645
The modified gen p mean: 0.4459734559059143, gen p mean: -0.23510274291038513, mean p set: 0.4465501010417938
loss_pred:0.014210239052772522, decouple_loss:0.0021825963631272316
Iteration: 3933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472333490848541, gen p mean: -0.22418591380119324, mean p set: 0.4477570950984955
loss_pred:0.013758083805441856, decouple_loss:0.0020439724903553724
The modified gen p mean: 0.4470730125904083, gen p mean: -0.22536617517471313, mean p set: 0.44764676690101624
loss_pred:0.014539883472025394, decouple_loss:0.0017571208300068974
The modified gen p mean: 0.44710952043533325, gen p mean: -0.224933922290802, mean p set: 0.44768741726875305
loss_pred:0.01393294706940651, decouple_loss:0.0018406716408208013
Iteration: 3934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733989238739014, gen p mean: -0.22757695615291595, mean p set: 0.44786933064460754
loss_pred:0.014225086197257042, decouple_loss:0.0018910442013293505
The modified gen p mean: 0.4471988379955292, gen p mean: -0.22703301906585693, mean p set: 0.4477759599685669
loss_pred:0.014653563499450684, decouple_loss:0.001947199460119009
The modified gen p mean: 0.44793879985809326, gen p mean: -0.2324896603822708, mean p set: 0.4485190510749817
loss_pred:0.014486522413790226, decouple_loss:0.001972270430997014
Iteration: 3935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737541675567627, gen p mean: -0.23475997149944305, mean p set: 0.4479525089263916
loss_pred:0.013971664011478424, decouple_loss:0.001910229679197073
The modified gen p mean: 0.4469893276691437, gen p mean: -0.23384787142276764, mean p set: 0.44751641154289246The modified gen p mean: 0.4468595087528229, gen p mean: -0.23590444028377533, mean p set: 0.4474334716796875
loss_pred:0.014312288723886013, decouple_loss:0.0018759076483547688
loss_pred:0.013989693485200405, decouple_loss:0.0018525985069572926
Iteration: 3936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472081959247589, gen p mean: -0.23512692749500275, mean p set: 0.4477759003639221
loss_pred:0.013820293359458447, decouple_loss:0.001978126121684909
The modified gen p mean: 0.4474835991859436, gen p mean: -0.23461416363716125, mean p set: 0.44801655411720276The modified gen p mean: 0.44604939222335815, gen p mean: -0.2413276880979538, mean p set: 0.44662564992904663
loss_pred:0.014473643153905869, decouple_loss:0.0021191684063524008
loss_pred:0.012984054163098335, decouple_loss:0.0019554959144443274
Iteration: 3937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465622305870056, gen p mean: -0.24098020792007446, mean p set: 0.44713205099105835
loss_pred:0.013941975310444832, decouple_loss:0.001970905577763915
The modified gen p mean: 0.44643667340278625, gen p mean: -0.2357833832502365, mean p set: 0.4470112919807434The modified gen p mean: 0.4481651484966278, gen p mean: -0.23122024536132812, mean p set: 0.4486927390098572
loss_pred:0.013148431666195393, decouple_loss:0.0019244687864556909
loss_pred:0.013397122733294964, decouple_loss:0.001954717095941305
Iteration: 3938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473661184310913, gen p mean: -0.23862846195697784, mean p set: 0.447934627532959
loss_pred:0.014353933744132519, decouple_loss:0.0024806407745927572
The modified gen p mean: 0.44726070761680603, gen p mean: -0.23729485273361206, mean p set: 0.4477875828742981The modified gen p mean: 0.44652435183525085, gen p mean: -0.2297694832086563, mean p set: 0.4471050798892975
loss_pred:0.013454673811793327, decouple_loss:0.0020839280914515257
loss_pred:0.01453492697328329, decouple_loss:0.0024493499659001827
Iteration: 3939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680383801460266, gen p mean: -0.23785841464996338, mean p set: 0.4473738372325897
loss_pred:0.01359530445188284, decouple_loss:0.001847637351602316
The modified gen p mean: 0.4486631751060486, gen p mean: -0.23247377574443817, mean p set: 0.44923636317253113
loss_pred:0.013470514677464962, decouple_loss:0.001959386980161071
The modified gen p mean: 0.4480702579021454, gen p mean: -0.22775353491306305, mean p set: 0.44860100746154785
loss_pred:0.013811095617711544, decouple_loss:0.0019416178110986948
Iteration: 3940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815167784690857, gen p mean: -0.22741006314754486, mean p set: 0.44872787594795227
loss_pred:0.013174629770219326, decouple_loss:0.0019321873551234603
The modified gen p mean: 0.44693273305892944, gen p mean: -0.2288847267627716, mean p set: 0.4475066065788269
loss_pred:0.013123122975230217, decouple_loss:0.0020687980577349663
The modified gen p mean: 0.4478926360607147, gen p mean: -0.23023566603660583, mean p set: 0.44842812418937683
loss_pred:0.014042290858924389, decouple_loss:0.001692037214525044
2023-04-27 19:22:04 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23008780181407928, mean p set: 0.4499112665653229
loss_pred:0.015596396289765835, decouple_loss:0.00217434368096292
The modified gen p mean: 0.449298232793808, gen p mean: -0.2300778031349182, mean p set: 0.4498290419578552
loss_pred:0.015066670253872871, decouple_loss:0.0020490274764597416
The modified gen p mean: 0.44822344183921814, gen p mean: -0.22750920057296753, mean p set: 0.44879910349845886
loss_pred:0.015499026514589787, decouple_loss:0.0020612338557839394
WV_1_PC_1_EH_0_PS_30, loss: 0.015492107719182968, avg_mse: 0.02283862791955471
current test mse: 0.022839
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 3941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013734698295593, gen p mean: -0.22382715344429016, mean p set: 0.45066767930984497
loss_pred:0.014741770923137665, decouple_loss:0.002284905407577753
The modified gen p mean: 0.44913750886917114, gen p mean: -0.22796839475631714, mean p set: 0.4497183561325073
loss_pred:0.014712505973875523, decouple_loss:0.0019408257212489843
The modified gen p mean: 0.4499732553958893, gen p mean: -0.22452804446220398, mean p set: 0.4505513906478882
loss_pred:0.014096928760409355, decouple_loss:0.002288077026605606
Iteration: 3942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008498430252075, gen p mean: -0.22348155081272125, mean p set: 0.4506189823150635
loss_pred:0.01422853022813797, decouple_loss:0.0020280068274587393
The modified gen p mean: 0.4491877257823944, gen p mean: -0.22905361652374268, mean p set: 0.4497673809528351
The modified gen p mean: 0.4479363262653351, gen p mean: -0.2255321443080902, mean p set: 0.44851261377334595
loss_pred:0.014636538922786713, decouple_loss:0.002147784223780036
loss_pred:0.013748927973210812, decouple_loss:0.002078190678730607
Iteration: 3943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888946413993835, gen p mean: -0.2270980328321457, mean p set: 0.4494198262691498
loss_pred:0.01502764318138361, decouple_loss:0.0020556324161589146
The modified gen p mean: 0.44828635454177856, gen p mean: -0.22534340620040894, mean p set: 0.44885316491127014
The modified gen p mean: 0.4490882456302643, gen p mean: -0.22407054901123047, mean p set: 0.4496645927429199
loss_pred:0.014728962443768978, decouple_loss:0.0018223208608105779
loss_pred:0.01427204068750143, decouple_loss:0.00189447239972651
Iteration: 3944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449628084897995, gen p mean: -0.22353346645832062, mean p set: 0.4501534700393677
loss_pred:0.014419608749449253, decouple_loss:0.0019782851450145245
The modified gen p mean: 0.4485085606575012, gen p mean: -0.22641980648040771, mean p set: 0.44908788800239563
The modified gen p mean: 0.44939228892326355, gen p mean: -0.22914248704910278, mean p set: 0.44996631145477295
loss_pred:0.01507494505494833, decouple_loss:0.001991279423236847
loss_pred:0.014029260724782944, decouple_loss:0.002048744121566415
Iteration: 3945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496925175189972, gen p mean: -0.22606907784938812, mean p set: 0.4502677023410797
loss_pred:0.014410952106118202, decouple_loss:0.0019886773079633713
The modified gen p mean: 0.44886672496795654, gen p mean: -0.22431239485740662, mean p set: 0.4493984878063202The modified gen p mean: 0.45013612508773804, gen p mean: -0.22049136459827423, mean p set: 0.45070981979370117
loss_pred:0.014610904268920422, decouple_loss:0.0019900149200111628
loss_pred:0.014038123190402985, decouple_loss:0.0018474688986316323
Iteration: 3946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501957595348358, gen p mean: -0.21598868072032928, mean p set: 0.4507763385772705
loss_pred:0.01385684497654438, decouple_loss:0.002121951198205352
The modified gen p mean: 0.449239045381546, gen p mean: -0.22362053394317627, mean p set: 0.4497663974761963The modified gen p mean: 0.4484202265739441, gen p mean: -0.22572186589241028, mean p set: 0.448993444442749
loss_pred:0.014586461707949638, decouple_loss:0.0020032322499901056
loss_pred:0.01397743821144104, decouple_loss:0.002010337309911847
Iteration: 3947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495578110218048, gen p mean: -0.22650034725666046, mean p set: 0.45013657212257385
loss_pred:0.014061760157346725, decouple_loss:0.0018296901835128665
The modified gen p mean: 0.4483213722705841, gen p mean: -0.2276505082845688, mean p set: 0.44884949922561646The modified gen p mean: 0.4496009051799774, gen p mean: -0.22738014161586761, mean p set: 0.45017269253730774
loss_pred:0.01434127427637577, decouple_loss:0.0018481763545423746
loss_pred:0.014611916616559029, decouple_loss:0.0018702676752582192
Iteration: 3948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44894078373908997, gen p mean: -0.22731316089630127, mean p set: 0.4495182931423187
loss_pred:0.014038993045687675, decouple_loss:0.002030368661507964
The modified gen p mean: 0.4481795132160187, gen p mean: -0.225677490234375, mean p set: 0.44870686531066895The modified gen p mean: 0.4479353129863739, gen p mean: -0.2285851687192917, mean p set: 0.44850999116897583
loss_pred:0.014460393227636814, decouple_loss:0.0020094362553209066
loss_pred:0.015416417270898819, decouple_loss:0.002004166366532445
Iteration: 3949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755247235298157, gen p mean: -0.22561463713645935, mean p set: 0.44813892245292664
loss_pred:0.01522149983793497, decouple_loss:0.0018123835325241089
The modified gen p mean: 0.44989970326423645, gen p mean: -0.22175584733486176, mean p set: 0.4504837691783905
loss_pred:0.01423136331140995, decouple_loss:0.00205108686350286
The modified gen p mean: 0.4507753252983093, gen p mean: -0.22017617523670197, mean p set: 0.45130491256713867
loss_pred:0.01408153772354126, decouple_loss:0.0023760944604873657
Iteration: 3950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484935700893402, gen p mean: -0.2224045693874359, mean p set: 0.44906798005104065
loss_pred:0.014256827533245087, decouple_loss:0.0019347612978890538
The modified gen p mean: 0.4508099853992462, gen p mean: -0.2223174273967743, mean p set: 0.45138660073280334
loss_pred:0.01398786623030901, decouple_loss:0.0019722783472388983
The modified gen p mean: 0.4492262005805969, gen p mean: -0.21553270518779755, mean p set: 0.4497552812099457
loss_pred:0.013922333717346191, decouple_loss:0.002204444957897067
2023-04-27 19:26:05 testing...
The modified gen p mean: 0.4482247233390808, gen p mean: -0.22234392166137695, mean p set: 0.44879910349845886
loss_pred:0.015508687123656273, decouple_loss:0.002419516444206238
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22502560913562775, mean p set: 0.4499112665653229
loss_pred:0.015543118119239807, decouple_loss:0.0024523683823645115
The modified gen p mean: 0.4493069648742676, gen p mean: -0.22507013380527496, mean p set: 0.4498290419578552
loss_pred:0.015061888843774796, decouple_loss:0.0025561912916600704
WV_1_PC_1_EH_0_PS_30, loss: 0.01549503207206726, avg_mse: 0.022769415751099586
current test mse: 0.022769
Iteration: 3951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500312805175781, gen p mean: -0.21905244886875153, mean p set: 0.4506046175956726
loss_pred:0.01435590535402298, decouple_loss:0.001976987114176154
The modified gen p mean: 0.4487622380256653, gen p mean: -0.2215126007795334, mean p set: 0.4493391215801239
loss_pred:0.014140316285192966, decouple_loss:0.002005384536460042
The modified gen p mean: 0.4491472542285919, gen p mean: -0.22297558188438416, mean p set: 0.4496765732765198
loss_pred:0.014738445170223713, decouple_loss:0.002210391452535987
Iteration: 3952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484103322029114, gen p mean: -0.23207637667655945, mean p set: 0.4489458501338959
loss_pred:0.01413106918334961, decouple_loss:0.002135679591447115
The modified gen p mean: 0.4491744339466095, gen p mean: -0.22825422883033752, mean p set: 0.4497511684894562
loss_pred:0.014613323844969273, decouple_loss:0.0020284848287701607
The modified gen p mean: 0.45048850774765015, gen p mean: -0.22532342374324799, mean p set: 0.45106619596481323
loss_pred:0.013628343120217323, decouple_loss:0.0020137913525104523
Iteration: 3953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931042194366455, gen p mean: -0.2325696051120758, mean p set: 0.4498424530029297
loss_pred:0.014375602826476097, decouple_loss:0.0020401296205818653
The modified gen p mean: 0.4487282931804657, gen p mean: -0.22852249443531036, mean p set: 0.4493071436882019
loss_pred:0.01500749122351408, decouple_loss:0.0019965744577348232
The modified gen p mean: 0.4487699270248413, gen p mean: -0.22424833476543427, mean p set: 0.44934147596359253
loss_pred:0.014306320808827877, decouple_loss:0.001996456179767847
Iteration: 3954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45075666904449463, gen p mean: -0.22624891996383667, mean p set: 0.45129016041755676
loss_pred:0.014264076948165894, decouple_loss:0.0025170641019940376
The modified gen p mean: 0.4486396014690399, gen p mean: -0.23582279682159424, mean p set: 0.449221134185791
loss_pred:0.013976240530610085, decouple_loss:0.002242505317553878
The modified gen p mean: 0.44891536235809326, gen p mean: -0.23198723793029785, mean p set: 0.44949063658714294
loss_pred:0.014095209538936615, decouple_loss:0.0024553549010306597
Iteration: 3955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955775141716003, gen p mean: -0.22601546347141266, mean p set: 0.45013123750686646
loss_pred:0.014149054884910583, decouple_loss:0.0023294968996196985
The modified gen p mean: 0.4489801824092865, gen p mean: -0.2285662442445755, mean p set: 0.4495089054107666The modified gen p mean: 0.4491046965122223, gen p mean: -0.23414677381515503, mean p set: 0.44967731833457947
loss_pred:0.014214620925486088, decouple_loss:0.0023061067331582308
loss_pred:0.014058736152946949, decouple_loss:0.002287562470883131
Iteration: 3956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490237832069397, gen p mean: -0.22680698335170746, mean p set: 0.44959837198257446
loss_pred:0.014534752815961838, decouple_loss:0.0027360350359231234
The modified gen p mean: 0.45061683654785156, gen p mean: -0.22792693972587585, mean p set: 0.451143354177475The modified gen p mean: 0.4496000111103058, gen p mean: -0.23024404048919678, mean p set: 0.4501734673976898
loss_pred:0.014228472486138344, decouple_loss:0.0022878479212522507
loss_pred:0.014193523675203323, decouple_loss:0.0023515867069363594
Iteration: 3957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853371381759644, gen p mean: -0.23065917193889618, mean p set: 0.4491119980812073
loss_pred:0.014875379391014576, decouple_loss:0.0019898300524801016
The modified gen p mean: 0.4479258060455322, gen p mean: -0.22782130539417267, mean p set: 0.44845327734947205The modified gen p mean: 0.4500104784965515, gen p mean: -0.22634851932525635, mean p set: 0.4505905210971832
loss_pred:0.014204555191099644, decouple_loss:0.0021923736203461885
loss_pred:0.013581898994743824, decouple_loss:0.002182598924264312
Iteration: 3958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937771558761597, gen p mean: -0.22590090334415436, mean p set: 0.44995465874671936
loss_pred:0.013967650942504406, decouple_loss:0.002939223777502775
The modified gen p mean: 0.4491695165634155, gen p mean: -0.2286115288734436, mean p set: 0.4497471749782562
loss_pred:0.013389412313699722, decouple_loss:0.0024078208953142166
The modified gen p mean: 0.44834673404693604, gen p mean: -0.2262265980243683, mean p set: 0.4488740861415863
loss_pred:0.014451039023697376, decouple_loss:0.002378871664404869
Iteration: 3959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45029187202453613, gen p mean: -0.22716203331947327, mean p set: 0.4508661925792694
loss_pred:0.013821304775774479, decouple_loss:0.0024433645885437727
The modified gen p mean: 0.44910576939582825, gen p mean: -0.23710685968399048, mean p set: 0.4496835172176361
loss_pred:0.014246456325054169, decouple_loss:0.0022060915362089872
The modified gen p mean: 0.44801080226898193, gen p mean: -0.2316036969423294, mean p set: 0.4485381245613098
loss_pred:0.015095862559974194, decouple_loss:0.00227486458607018
Iteration: 3960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497413635253906, gen p mean: -0.23620925843715668, mean p set: 0.4503171145915985
loss_pred:0.014124355278909206, decouple_loss:0.0022801619488745928
The modified gen p mean: 0.44968295097351074, gen p mean: -0.23365437984466553, mean p set: 0.45026013255119324
loss_pred:0.01430991105735302, decouple_loss:0.0024116989225149155
The modified gen p mean: 0.44939175248146057, gen p mean: -0.23163127899169922, mean p set: 0.44991418719291687
loss_pred:0.014273624867200851, decouple_loss:0.0023031961172819138
2023-04-27 19:29:31 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23251153528690338, mean p set: 0.4499112665653229
loss_pred:0.01560418400913477, decouple_loss:0.0026558078825473785
The modified gen p mean: 0.44930294156074524, gen p mean: -0.2327759712934494, mean p set: 0.4498290419578552
loss_pred:0.015006962232291698, decouple_loss:0.0025570134166628122
The modified gen p mean: 0.4482240378856659, gen p mean: -0.2300369292497635, mean p set: 0.44879910349845886
loss_pred:0.015467192977666855, decouple_loss:0.0025031277909874916
WV_1_PC_1_EH_0_PS_30, loss: 0.01548804622143507, avg_mse: 0.022794602438807487
current test mse: 0.022795
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 3961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446570485830307, gen p mean: -0.2331380844116211, mean p set: 0.44709280133247375
loss_pred:0.0142988171428442, decouple_loss:0.002399869030341506
The modified gen p mean: 0.44915255904197693, gen p mean: -0.2337578386068344, mean p set: 0.44973060488700867
loss_pred:0.014578721486032009, decouple_loss:0.002357777440920472
The modified gen p mean: 0.4468957483768463, gen p mean: -0.23736898601055145, mean p set: 0.4474697411060333
loss_pred:0.014264986850321293, decouple_loss:0.0025024288333952427
Iteration: 3962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454822540283203, gen p mean: -0.2285807728767395, mean p set: 0.4460061490535736
loss_pred:0.014468393288552761, decouple_loss:0.00226909969933331
The modified gen p mean: 0.4477662146091461, gen p mean: -0.23320893943309784, mean p set: 0.44834670424461365
The modified gen p mean: 0.4481905996799469, gen p mean: -0.23155011236667633, mean p set: 0.44875821471214294
loss_pred:0.01466636173427105, decouple_loss:0.002247028984129429
loss_pred:0.014868848025798798, decouple_loss:0.002348946640267968
Iteration: 3963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44646379351615906, gen p mean: -0.23147523403167725, mean p set: 0.4469926357269287
loss_pred:0.014623750932514668, decouple_loss:0.001987331546843052
The modified gen p mean: 0.4465482234954834, gen p mean: -0.23501674830913544, mean p set: 0.4471190571784973
The modified gen p mean: 0.4453626573085785, gen p mean: -0.23158977925777435, mean p set: 0.44594070315361023
loss_pred:0.014022895134985447, decouple_loss:0.0020338096655905247
loss_pred:0.014095672406256199, decouple_loss:0.0018952377140522003
Iteration: 3964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454843997955322, gen p mean: -0.23265516757965088, mean p set: 0.44600710272789
loss_pred:0.014923551119863987, decouple_loss:0.0019492408027872443
The modified gen p mean: 0.44660645723342896, gen p mean: -0.2361540049314499, mean p set: 0.44718244671821594
The modified gen p mean: 0.4474745988845825, gen p mean: -0.23558562994003296, mean p set: 0.448056697845459
loss_pred:0.014172090217471123, decouple_loss:0.0018457433907315135
loss_pred:0.014118272811174393, decouple_loss:0.0020888291765004396
Iteration: 3965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469296932220459, gen p mean: -0.2330675721168518, mean p set: 0.4475100040435791
loss_pred:0.01381625048816204, decouple_loss:0.0018955939449369907
The modified gen p mean: 0.44698283076286316, gen p mean: -0.2361830174922943, mean p set: 0.4475601017475128The modified gen p mean: 0.4474444091320038, gen p mean: -0.2370772361755371, mean p set: 0.447966605424881
loss_pred:0.014719541184604168, decouple_loss:0.0018131195101886988
loss_pred:0.014033091254532337, decouple_loss:0.0018117043655365705
Iteration: 3966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470500349998474, gen p mean: -0.23724563419818878, mean p set: 0.44762295484542847
loss_pred:0.014105771668255329, decouple_loss:0.0021706754341721535
The modified gen p mean: 0.44609108567237854, gen p mean: -0.2349490076303482, mean p set: 0.4466158449649811The modified gen p mean: 0.44868004322052, gen p mean: -0.23656997084617615, mean p set: 0.4492546021938324
loss_pred:0.014371995814144611, decouple_loss:0.0022425681818276644
loss_pred:0.014109962619841099, decouple_loss:0.0021911223884671926
Iteration: 3967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486645758152008, gen p mean: -0.2363569438457489, mean p set: 0.44924843311309814
loss_pred:0.014782886952161789, decouple_loss:0.0016604562988504767
The modified gen p mean: 0.44734519720077515, gen p mean: -0.23520898818969727, mean p set: 0.44787725806236267The modified gen p mean: 0.4465588927268982, gen p mean: -0.23894661664962769, mean p set: 0.4471312463283539
loss_pred:0.014003104530274868, decouple_loss:0.0016862406628206372
loss_pred:0.01494358666241169, decouple_loss:0.0017548848409205675
Iteration: 3968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694897532463074, gen p mean: -0.23245865106582642, mean p set: 0.447516530752182
loss_pred:0.014579271897673607, decouple_loss:0.0018224818632006645
The modified gen p mean: 0.4471930265426636, gen p mean: -0.23509538173675537, mean p set: 0.44771912693977356The modified gen p mean: 0.44725820422172546, gen p mean: -0.23421742022037506, mean p set: 0.44783279299736023
loss_pred:0.014349428936839104, decouple_loss:0.0018646284006536007
loss_pred:0.014298071153461933, decouple_loss:0.001997471321374178
Iteration: 3969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470856487751007, gen p mean: -0.23077592253684998, mean p set: 0.44765836000442505
loss_pred:0.015000839717686176, decouple_loss:0.002038131235167384
The modified gen p mean: 0.44665059447288513, gen p mean: -0.23027199506759644, mean p set: 0.4472208023071289
loss_pred:0.014336200430989265, decouple_loss:0.0018566488288342953
The modified gen p mean: 0.446409672498703, gen p mean: -0.23482993245124817, mean p set: 0.44693562388420105
loss_pred:0.014029240235686302, decouple_loss:0.001871065003797412
Iteration: 3970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457598030567169, gen p mean: -0.23583482205867767, mean p set: 0.4463326036930084
loss_pred:0.013827236369252205, decouple_loss:0.0018115504644811153
The modified gen p mean: 0.44757279753685, gen p mean: -0.23652823269367218, mean p set: 0.44815176725387573
loss_pred:0.014135344885289669, decouple_loss:0.001785743166692555
The modified gen p mean: 0.44651058316230774, gen p mean: -0.23105108737945557, mean p set: 0.4470318555831909
loss_pred:0.014139717444777489, decouple_loss:0.0018743802793323994
2023-04-27 19:33:35 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23312990367412567, mean p set: 0.4499112665653229
loss_pred:0.01558111235499382, decouple_loss:0.0018252040026709437
The modified gen p mean: 0.44822853803634644, gen p mean: -0.2305208295583725, mean p set: 0.44879910349845886
loss_pred:0.015458493493497372, decouple_loss:0.0018384576542302966
The modified gen p mean: 0.44929811358451843, gen p mean: -0.23310543596744537, mean p set: 0.4498290419578552
loss_pred:0.01499180868268013, decouple_loss:0.002068731701001525
WV_1_PC_1_EH_0_PS_30, loss: 0.015439344570040703, avg_mse: 0.022787900641560555
current test mse: 0.022788
Iteration: 3971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605326652526855, gen p mean: -0.23167338967323303, mean p set: 0.4466286599636078
loss_pred:0.014324987307190895, decouple_loss:0.0017277620499953628
The modified gen p mean: 0.4468236267566681, gen p mean: -0.23614509403705597, mean p set: 0.44739779829978943
loss_pred:0.014018640853464603, decouple_loss:0.0019011272815987468
The modified gen p mean: 0.4462822675704956, gen p mean: -0.23523835837841034, mean p set: 0.44681257009506226
loss_pred:0.013932336121797562, decouple_loss:0.0018256859621033072
Iteration: 3972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839516282081604, gen p mean: -0.2346770167350769, mean p set: 0.44892388582229614
loss_pred:0.014937615022063255, decouple_loss:0.0019413636764511466
The modified gen p mean: 0.44631433486938477, gen p mean: -0.23814018070697784, mean p set: 0.4468908905982971
The modified gen p mean: 0.44776633381843567, gen p mean: -0.23698534071445465, mean p set: 0.44834285974502563
loss_pred:0.014027632772922516, decouple_loss:0.0016029286198318005
loss_pred:0.014484897255897522, decouple_loss:0.0018988859374076128
Iteration: 3973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491233825683594, gen p mean: -0.23446810245513916, mean p set: 0.44964826107025146
loss_pred:0.014239106327295303, decouple_loss:0.0018743418622761965
The modified gen p mean: 0.4468744397163391, gen p mean: -0.23289985954761505, mean p set: 0.44745346903800964
The modified gen p mean: 0.44699880480766296, gen p mean: -0.23955322802066803, mean p set: 0.4475838840007782
loss_pred:0.014855697751045227, decouple_loss:0.002031205454841256
loss_pred:0.014270082116127014, decouple_loss:0.001957894302904606
Iteration: 3974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477745592594147, gen p mean: -0.23453561961650848, mean p set: 0.44829845428466797
loss_pred:0.013688593171536922, decouple_loss:0.0017434326000511646
The modified gen p mean: 0.4472671449184418, gen p mean: -0.23318378627300262, mean p set: 0.4478478729724884
The modified gen p mean: 0.4475862383842468, gen p mean: -0.2322167456150055, mean p set: 0.4481663107872009
loss_pred:0.013779263012111187, decouple_loss:0.0018558066803961992
loss_pred:0.014727529138326645, decouple_loss:0.0019160170340910554
Iteration: 3975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645440578460693, gen p mean: -0.2325463593006134, mean p set: 0.44703078269958496
loss_pred:0.014147195965051651, decouple_loss:0.002192665357142687
The modified gen p mean: 0.4479278028011322, gen p mean: -0.2333158701658249, mean p set: 0.44845691323280334The modified gen p mean: 0.44621631503105164, gen p mean: -0.2286023646593094, mean p set: 0.44678959250450134
loss_pred:0.013894383795559406, decouple_loss:0.002324923872947693
loss_pred:0.014372224919497967, decouple_loss:0.0019396774005144835
Iteration: 3976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471946060657501, gen p mean: -0.24019449949264526, mean p set: 0.44777220487594604
loss_pred:0.014103420078754425, decouple_loss:0.0018400171538814902
The modified gen p mean: 0.4467116594314575, gen p mean: -0.23746196925640106, mean p set: 0.4472857117652893
loss_pred:0.014039890840649605, decouple_loss:0.001803404069505632
The modified gen p mean: 0.44684070348739624, gen p mean: -0.23412172496318817, mean p set: 0.4473719894886017
loss_pred:0.014736909419298172, decouple_loss:0.0017935705836862326
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463423192501068, gen p mean: -0.23576776683330536, mean p set: 0.44692057371139526
loss_pred:0.014079143293201923, decouple_loss:0.0022849629167467356
The modified gen p mean: 0.4480673372745514, gen p mean: -0.2330678105354309, mean p set: 0.44864004850387573
loss_pred:0.014754313044250011, decouple_loss:0.0021144691854715347
The modified gen p mean: 0.4474889636039734, gen p mean: -0.23478886485099792, mean p set: 0.4480137526988983
loss_pred:0.014168588444590569, decouple_loss:0.0020824300590902567
Iteration: 3978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727757573127747, gen p mean: -0.23932519555091858, mean p set: 0.44785624742507935
loss_pred:0.013839655555784702, decouple_loss:0.001957285450771451
The modified gen p mean: 0.4464007318019867, gen p mean: -0.2395285665988922, mean p set: 0.4469849467277527
loss_pred:0.014070660807192326, decouple_loss:0.0018910557264462113
The modified gen p mean: 0.44835352897644043, gen p mean: -0.23811273276805878, mean p set: 0.44887736439704895
loss_pred:0.01460970751941204, decouple_loss:0.0018149912357330322
Iteration: 3979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758090376853943, gen p mean: -0.2397266924381256, mean p set: 0.4481556713581085
loss_pred:0.014165304601192474, decouple_loss:0.0018425792222842574
The modified gen p mean: 0.44691991806030273, gen p mean: -0.2381877601146698, mean p set: 0.44750016927719116
loss_pred:0.01559755951166153, decouple_loss:0.0018731768941506743
The modified gen p mean: 0.44822779297828674, gen p mean: -0.2375248372554779, mean p set: 0.44875115156173706
loss_pred:0.014736519195139408, decouple_loss:0.0017308159731328487
Iteration: 3980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479491412639618, gen p mean: -0.23677122592926025, mean p set: 0.4485260546207428
loss_pred:0.014390288852155209, decouple_loss:0.0017445944249629974
The modified gen p mean: 0.44682273268699646, gen p mean: -0.23949626088142395, mean p set: 0.44740432500839233
loss_pred:0.013951469212770462, decouple_loss:0.0015931094530969858
The modified gen p mean: 0.4473363757133484, gen p mean: -0.23996569216251373, mean p set: 0.44786328077316284
loss_pred:0.01352921687066555, decouple_loss:0.0016586193814873695
2023-04-27 19:37:00 testing...
The modified gen p mean: 0.44822192192077637, gen p mean: -0.23142226040363312, mean p set: 0.44879910349845886
loss_pred:0.015410260297358036, decouple_loss:0.0016520845238119364
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23383034765720367, mean p set: 0.4499112665653229
loss_pred:0.01553670596331358, decouple_loss:0.0017647127388045192
The modified gen p mean: 0.4493003189563751, gen p mean: -0.23428025841712952, mean p set: 0.4498290419578552
loss_pred:0.014955720864236355, decouple_loss:0.0018330290913581848
WV_1_PC_1_EH_0_PS_30, loss: 0.01538839377462864, avg_mse: 0.022738704457879066
current test mse: 0.022739
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 3981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789111614227295, gen p mean: -0.23420698940753937, mean p set: 0.4484219551086426
loss_pred:0.014929465018212795, decouple_loss:0.0018509887158870697
The modified gen p mean: 0.44889554381370544, gen p mean: -0.2343071848154068, mean p set: 0.44947290420532227
loss_pred:0.014665689319372177, decouple_loss:0.0017206205520778894
The modified gen p mean: 0.4477253258228302, gen p mean: -0.23358526825904846, mean p set: 0.4483001232147217
loss_pred:0.01518539059907198, decouple_loss:0.0017798596527427435
Iteration: 3982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901224970817566, gen p mean: -0.2406621277332306, mean p set: 0.4495360851287842
loss_pred:0.015194191597402096, decouple_loss:0.0022224585991352797
The modified gen p mean: 0.448797345161438, gen p mean: -0.23696796596050262, mean p set: 0.4493670165538788
loss_pred:0.014560305513441563, decouple_loss:0.0017022514948621392
The modified gen p mean: 0.4474541246891022, gen p mean: -0.2288772016763687, mean p set: 0.4480302929878235
loss_pred:0.01507670059800148, decouple_loss:0.0021376798395067453
Iteration: 3983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486398994922638, gen p mean: -0.23713776469230652, mean p set: 0.4491669833660126
loss_pred:0.014818999916315079, decouple_loss:0.0017476065549999475
The modified gen p mean: 0.4480694830417633, gen p mean: -0.23201623558998108, mean p set: 0.4486406445503235
loss_pred:0.015563730150461197, decouple_loss:0.0018266724655404687
The modified gen p mean: 0.44842642545700073, gen p mean: -0.23546463251113892, mean p set: 0.4490050673484802
loss_pred:0.015246476046741009, decouple_loss:0.0018496912671253085
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44942525029182434, gen p mean: -0.23891164362430573, mean p set: 0.4499538242816925
loss_pred:0.014830264262855053, decouple_loss:0.0020134577061980963
The modified gen p mean: 0.44915083050727844, gen p mean: -0.2396344244480133, mean p set: 0.44972550868988037
loss_pred:0.014531110413372517, decouple_loss:0.00198624050244689
The modified gen p mean: 0.4488782286643982, gen p mean: -0.23883293569087982, mean p set: 0.4494534134864807
loss_pred:0.014450548216700554, decouple_loss:0.0021691061556339264
Iteration: 3985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448080450296402, gen p mean: -0.23931023478507996, mean p set: 0.4486114978790283
loss_pred:0.015390226617455482, decouple_loss:0.001894102431833744
The modified gen p mean: 0.44894108176231384, gen p mean: -0.24185360968112946, mean p set: 0.44951972365379333
loss_pred:0.014828366227447987, decouple_loss:0.0019747649785131216
The modified gen p mean: 0.44928932189941406, gen p mean: -0.2422415018081665, mean p set: 0.4498666524887085
loss_pred:0.01516952458769083, decouple_loss:0.0019386248895898461
Iteration: 3986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474909007549286, gen p mean: -0.24233543872833252, mean p set: 0.4480241537094116
loss_pred:0.015200445428490639, decouple_loss:0.0017155901296064258
The modified gen p mean: 0.44829484820365906, gen p mean: -0.24498137831687927, mean p set: 0.4488653242588043
loss_pred:0.014954894781112671, decouple_loss:0.0018343457486480474
The modified gen p mean: 0.4493022561073303, gen p mean: -0.2462904006242752, mean p set: 0.4498789310455322
loss_pred:0.014834368601441383, decouple_loss:0.001965773059055209
Iteration: 3987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493294656276703, gen p mean: -0.24765712022781372, mean p set: 0.4498986005783081
loss_pred:0.01500971894711256, decouple_loss:0.0018932732054963708
The modified gen p mean: 0.44823184609413147, gen p mean: -0.24044841527938843, mean p set: 0.4487597644329071The modified gen p mean: 0.44803348183631897, gen p mean: -0.24371270835399628, mean p set: 0.44861117005348206
loss_pred:0.014910845085978508, decouple_loss:0.0018172209383919835
loss_pred:0.014659324660897255, decouple_loss:0.0018931602826341987
Iteration: 3988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920045137405396, gen p mean: -0.23979990184307098, mean p set: 0.4497752785682678
loss_pred:0.014417477883398533, decouple_loss:0.0020704870112240314
The modified gen p mean: 0.44769707322120667, gen p mean: -0.240467831492424, mean p set: 0.4482733905315399The modified gen p mean: 0.448903352022171, gen p mean: -0.24397672712802887, mean p set: 0.44942986965179443
loss_pred:0.014858407899737358, decouple_loss:0.0016667468007653952
loss_pred:0.014758340083062649, decouple_loss:0.001921605784446001
Iteration: 3989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488355815410614, gen p mean: -0.23982073366641998, mean p set: 0.4494089186191559
loss_pred:0.014671869575977325, decouple_loss:0.0020694094710052013
The modified gen p mean: 0.44890785217285156, gen p mean: -0.24297688901424408, mean p set: 0.4494372606277466
loss_pred:0.01454353891313076, decouple_loss:0.001992463832721114
The modified gen p mean: 0.44889745116233826, gen p mean: -0.23830066621303558, mean p set: 0.4494735598564148
loss_pred:0.014632759615778923, decouple_loss:0.0020313402637839317
Iteration: 3990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854873418807983, gen p mean: -0.2308976948261261, mean p set: 0.44911903142929077
loss_pred:0.014810553751885891, decouple_loss:0.001736367936246097
The modified gen p mean: 0.44934678077697754, gen p mean: -0.23729059100151062, mean p set: 0.449928879737854
loss_pred:0.014638946391642094, decouple_loss:0.001670443220064044
The modified gen p mean: 0.449115127325058, gen p mean: -0.23735171556472778, mean p set: 0.4496401250362396
loss_pred:0.014936763793230057, decouple_loss:0.0017640013247728348
2023-04-27 19:41:11 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23008404672145844, mean p set: 0.4499112665653229
loss_pred:0.015502812340855598, decouple_loss:0.0021235174499452114
The modified gen p mean: 0.44929811358451843, gen p mean: -0.23060350120067596, mean p set: 0.4498290419578552
loss_pred:0.014931662939488888, decouple_loss:0.002457259688526392
The modified gen p mean: 0.4482201635837555, gen p mean: -0.2278018593788147, mean p set: 0.44879910349845886
loss_pred:0.015446343459188938, decouple_loss:0.0022929462138563395
WV_1_PC_1_EH_0_PS_30, loss: 0.01540816854685545, avg_mse: 0.02269916795194149
current test mse: 0.022699
Iteration: 3991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483708143234253, gen p mean: -0.23156048357486725, mean p set: 0.4489397704601288
loss_pred:0.014357230626046658, decouple_loss:0.001982437213882804
The modified gen p mean: 0.4479277729988098, gen p mean: -0.2277403473854065, mean p set: 0.4484536051750183
loss_pred:0.015220949426293373, decouple_loss:0.0022072005085647106
The modified gen p mean: 0.44859960675239563, gen p mean: -0.2314378023147583, mean p set: 0.44917774200439453
loss_pred:0.015107042156159878, decouple_loss:0.001820861012674868
Iteration: 3992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489957094192505, gen p mean: -0.23252107203006744, mean p set: 0.44951876997947693
loss_pred:0.01463692169636488, decouple_loss:0.0015939781442284584
The modified gen p mean: 0.4480973482131958, gen p mean: -0.23146742582321167, mean p set: 0.4486786425113678
The modified gen p mean: 0.44901666045188904, gen p mean: -0.23392963409423828, mean p set: 0.4495936930179596
loss_pred:0.015489713288843632, decouple_loss:0.001808999921195209
loss_pred:0.014329589903354645, decouple_loss:0.0016508492408320308
Iteration: 3993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933652877807617, gen p mean: -0.2399061620235443, mean p set: 0.4498598277568817
loss_pred:0.0145720848813653, decouple_loss:0.0018953063990920782
The modified gen p mean: 0.4494238495826721, gen p mean: -0.24034982919692993, mean p set: 0.4500062167644501
The modified gen p mean: 0.44872143864631653, gen p mean: -0.24073541164398193, mean p set: 0.4493010640144348
loss_pred:0.014733622781932354, decouple_loss:0.0018241683719679713
loss_pred:0.014805895276367664, decouple_loss:0.001753919292241335
Iteration: 3994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485796093940735, gen p mean: -0.24145859479904175, mean p set: 0.4491029977798462
loss_pred:0.014943867921829224, decouple_loss:0.0018153946148231626
The modified gen p mean: 0.4474216103553772, gen p mean: -0.24026425182819366, mean p set: 0.4480001628398895
The modified gen p mean: 0.4487669765949249, gen p mean: -0.23771046102046967, mean p set: 0.44934189319610596
loss_pred:0.015501492656767368, decouple_loss:0.0018396155210211873
loss_pred:0.014776553027331829, decouple_loss:0.0019194440683349967
Iteration: 3995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905364513397217, gen p mean: -0.24234312772750854, mean p set: 0.4496358335018158
loss_pred:0.014779827557504177, decouple_loss:0.0019030520925298333
The modified gen p mean: 0.44851401448249817, gen p mean: -0.24362753331661224, mean p set: 0.4490435719490051The modified gen p mean: 0.44844281673431396, gen p mean: -0.23937135934829712, mean p set: 0.44901883602142334
loss_pred:0.013979865238070488, decouple_loss:0.0017663473263382912
loss_pred:0.014647223986685276, decouple_loss:0.001830606022849679
Iteration: 3996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783246517181396, gen p mean: -0.24261818826198578, mean p set: 0.44836896657943726
loss_pred:0.015228239819407463, decouple_loss:0.001800134894438088
The modified gen p mean: 0.4494800865650177, gen p mean: -0.2449297159910202, mean p set: 0.45005539059638977
The modified gen p mean: 0.4479142129421234, gen p mean: -0.23663097620010376, mean p set: 0.448492169380188
loss_pred:0.01444393489509821, decouple_loss:0.0017252395628020167
loss_pred:0.015131685882806778, decouple_loss:0.0018540031742304564
Iteration: 3997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829943776130676, gen p mean: -0.24586118757724762, mean p set: 0.4488733410835266
loss_pred:0.01490903552621603, decouple_loss:0.001890222541987896
The modified gen p mean: 0.44831323623657227, gen p mean: -0.24450796842575073, mean p set: 0.4488937258720398The modified gen p mean: 0.44804802536964417, gen p mean: -0.2440585345029831, mean p set: 0.448577344417572
loss_pred:0.015324428677558899, decouple_loss:0.0018149848328903317
loss_pred:0.014648386277258396, decouple_loss:0.0018213032744824886
Iteration: 3998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44898930191993713, gen p mean: -0.24334920942783356, mean p set: 0.44956550002098083
loss_pred:0.014825616031885147, decouple_loss:0.00155819917563349
The modified gen p mean: 0.44886356592178345, gen p mean: -0.23798693716526031, mean p set: 0.4494384229183197
loss_pred:0.014081191271543503, decouple_loss:0.0016584888799116015
The modified gen p mean: 0.4477844536304474, gen p mean: -0.23413509130477905, mean p set: 0.44830653071403503
loss_pred:0.014514246955513954, decouple_loss:0.0017631716327741742
Iteration: 3999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867342710494995, gen p mean: -0.2437472939491272, mean p set: 0.44925159215927124
loss_pred:0.014485761523246765, decouple_loss:0.0017508910968899727
The modified gen p mean: 0.44868138432502747, gen p mean: -0.24406397342681885, mean p set: 0.4492647647857666
loss_pred:0.014539118856191635, decouple_loss:0.001740423496812582
The modified gen p mean: 0.44815096259117126, gen p mean: -0.24586473405361176, mean p set: 0.4486761689186096
loss_pred:0.014888674952089787, decouple_loss:0.001866297097876668
Iteration: 4000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494341015815735, gen p mean: -0.24597802758216858, mean p set: 0.4499637186527252
loss_pred:0.01458541676402092, decouple_loss:0.001675030798651278
The modified gen p mean: 0.44906046986579895, gen p mean: -0.24992875754833221, mean p set: 0.4496367573738098
The modified gen p mean: 0.44787973165512085, gen p mean: -0.24503497779369354, mean p set: 0.44845834374427795
loss_pred:0.014531834051012993, decouple_loss:0.0017554891528561711
loss_pred:0.014506138861179352, decouple_loss:0.0017727311933413148
2023-04-27 19:44:36 itr: 4000
training loss: [0.01466917 0.01461961 0.01459478]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_4000.ckpt
2023-04-27 19:44:39 testing...
The modified gen p mean: 0.44821780920028687, gen p mean: -0.24026046693325043, mean p set: 0.44879910349845886
loss_pred:0.015430117957293987, decouple_loss:0.0017021163366734982
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24233034253120422, mean p set: 0.4499112665653229
loss_pred:0.015534035861492157, decouple_loss:0.0018286618869751692
The modified gen p mean: 0.4492950737476349, gen p mean: -0.24311864376068115, mean p set: 0.4498290419578552
loss_pred:0.014963537454605103, decouple_loss:0.0016890713013708591
WV_1_PC_1_EH_0_PS_30, loss: 0.015396228060126305, avg_mse: 0.02276172675192356
current test mse: 0.022762
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 4001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479137361049652, gen p mean: -0.23684552311897278, mean p set: 0.44844722747802734
loss_pred:0.014697880484163761, decouple_loss:0.0019375906558707356
The modified gen p mean: 0.4480033218860626, gen p mean: -0.23849034309387207, mean p set: 0.4485769271850586
loss_pred:0.014005331322550774, decouple_loss:0.002291880315169692
The modified gen p mean: 0.4490390419960022, gen p mean: -0.24544471502304077, mean p set: 0.4496126174926758
loss_pred:0.013718540780246258, decouple_loss:0.002067619003355503
Iteration: 4002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657713174819946, gen p mean: -0.24492114782333374, mean p set: 0.44710251688957214
loss_pred:0.014126500114798546, decouple_loss:0.0022829941008239985
The modified gen p mean: 0.448555588722229, gen p mean: -0.2447347491979599, mean p set: 0.449137419462204
loss_pred:0.014203180558979511, decouple_loss:0.0018902360461652279
The modified gen p mean: 0.44926419854164124, gen p mean: -0.24093948304653168, mean p set: 0.4498407244682312
loss_pred:0.014181835576891899, decouple_loss:0.0020882654935121536
Iteration: 4003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808438420295715, gen p mean: -0.23955105245113373, mean p set: 0.44861605763435364
loss_pred:0.014226909726858139, decouple_loss:0.0021025522146373987
The modified gen p mean: 0.4483046233654022, gen p mean: -0.2312651425600052, mean p set: 0.44888070225715637
loss_pred:0.013949657790362835, decouple_loss:0.0021330607123672962
The modified gen p mean: 0.4492860436439514, gen p mean: -0.23688095808029175, mean p set: 0.4498685300350189
loss_pred:0.0145884333178401, decouple_loss:0.0019801256712526083
Iteration: 4004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883424043655396, gen p mean: -0.24217158555984497, mean p set: 0.44936034083366394
loss_pred:0.014107576571404934, decouple_loss:0.001893365872092545
The modified gen p mean: 0.44762951135635376, gen p mean: -0.24161896109580994, mean p set: 0.44820713996887207
loss_pred:0.01477141585201025, decouple_loss:0.00204948871396482
The modified gen p mean: 0.44801321625709534, gen p mean: -0.23202812671661377, mean p set: 0.4485895335674286
loss_pred:0.013693355955183506, decouple_loss:0.0021505169570446014
Iteration: 4005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489195942878723, gen p mean: -0.23549026250839233, mean p set: 0.44949984550476074
loss_pred:0.01421359647065401, decouple_loss:0.0018871366046369076
The modified gen p mean: 0.45005691051483154, gen p mean: -0.23263342678546906, mean p set: 0.45063140988349915The modified gen p mean: 0.44942861795425415, gen p mean: -0.23503702878952026, mean p set: 0.4499533474445343
loss_pred:0.01420359406620264, decouple_loss:0.0021649121772497892
loss_pred:0.014102640561759472, decouple_loss:0.002146503422409296
Iteration: 4006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005661249160767, gen p mean: -0.22996821999549866, mean p set: 0.4506332576274872
loss_pred:0.013591775670647621, decouple_loss:0.00188250036444515
The modified gen p mean: 0.44752711057662964, gen p mean: -0.2326669991016388, mean p set: 0.448056697845459The modified gen p mean: 0.44969794154167175, gen p mean: -0.2354329228401184, mean p set: 0.4502703547477722
loss_pred:0.014494197443127632, decouple_loss:0.002162157092243433
loss_pred:0.01381292287260294, decouple_loss:0.0018199806800112128
Iteration: 4007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472925364971161, gen p mean: -0.23888282477855682, mean p set: 0.4478663504123688
loss_pred:0.01394280232489109, decouple_loss:0.0020634117536246777
The modified gen p mean: 0.44779330492019653, gen p mean: -0.23078469932079315, mean p set: 0.4483669102191925The modified gen p mean: 0.44845351576805115, gen p mean: -0.23710443079471588, mean p set: 0.44898566603660583
loss_pred:0.014118582010269165, decouple_loss:0.002054394455626607
loss_pred:0.014057447202503681, decouple_loss:0.0020295714493840933
Iteration: 4008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911348819732666, gen p mean: -0.23262979090213776, mean p set: 0.449687123298645
loss_pred:0.014675871469080448, decouple_loss:0.001974605955183506
The modified gen p mean: 0.449302613735199, gen p mean: -0.2339353710412979, mean p set: 0.44987955689430237
loss_pred:0.014173910953104496, decouple_loss:0.0020948052406311035
The modified gen p mean: 0.44912177324295044, gen p mean: -0.2326495349407196, mean p set: 0.44964301586151123
loss_pred:0.014563587494194508, decouple_loss:0.0021400663536041975
Iteration: 4009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828829169273376, gen p mean: -0.2382550835609436, mean p set: 0.4488680362701416
loss_pred:0.013670885935425758, decouple_loss:0.0018606374505907297
The modified gen p mean: 0.4501104950904846, gen p mean: -0.23151928186416626, mean p set: 0.450682133436203
loss_pred:0.014183109626173973, decouple_loss:0.0021195197477936745
The modified gen p mean: 0.44970008730888367, gen p mean: -0.2310091108083725, mean p set: 0.45022737979888916
loss_pred:0.014477133750915527, decouple_loss:0.0017937121447175741
Iteration: 4010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497223198413849, gen p mean: -0.2310863733291626, mean p set: 0.45029905438423157
loss_pred:0.014241802506148815, decouple_loss:0.0022292411886155605
The modified gen p mean: 0.4487697184085846, gen p mean: -0.24008804559707642, mean p set: 0.4493459463119507
loss_pred:0.01467086747288704, decouple_loss:0.002673157025128603
The modified gen p mean: 0.44947516918182373, gen p mean: -0.24054020643234253, mean p set: 0.4500042200088501
loss_pred:0.01429689209908247, decouple_loss:0.002538232831284404
2023-04-27 19:48:43 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23763450980186462, mean p set: 0.4499112665653229
loss_pred:0.015655675902962685, decouple_loss:0.0018707060953602195
The modified gen p mean: 0.4492951035499573, gen p mean: -0.23799733817577362, mean p set: 0.4498290419578552
loss_pred:0.015122040174901485, decouple_loss:0.0021298874635249376
The modified gen p mean: 0.44821515679359436, gen p mean: -0.23508580029010773, mean p set: 0.44879910349845886
loss_pred:0.015530477277934551, decouple_loss:0.0019294709200039506
WV_1_PC_1_EH_0_PS_30, loss: 0.015534898266196251, avg_mse: 0.022991372272372246
current test mse: 0.022991
Iteration: 4011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463900029659271, gen p mean: -0.2393740564584732, mean p set: 0.4469698667526245
loss_pred:0.013910580426454544, decouple_loss:0.002019501058384776
The modified gen p mean: 0.4484770894050598, gen p mean: -0.23423898220062256, mean p set: 0.44900989532470703
loss_pred:0.014218153432011604, decouple_loss:0.0019004170317202806
The modified gen p mean: 0.44897934794425964, gen p mean: -0.2397468537092209, mean p set: 0.4495595097541809
loss_pred:0.014025529846549034, decouple_loss:0.0019798269495368004
Iteration: 4012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487076997756958, gen p mean: -0.22957000136375427, mean p set: 0.4492368996143341
loss_pred:0.013982436619699001, decouple_loss:0.001956366468220949
The modified gen p mean: 0.4471510648727417, gen p mean: -0.23477903008460999, mean p set: 0.4477255642414093
The modified gen p mean: 0.4490238130092621, gen p mean: -0.2409336268901825, mean p set: 0.4495994448661804
loss_pred:0.01375577412545681, decouple_loss:0.0022374254185706377
loss_pred:0.014218665659427643, decouple_loss:0.0019750744104385376
Iteration: 4013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476788640022278, gen p mean: -0.2361421436071396, mean p set: 0.44820865988731384
loss_pred:0.014179554767906666, decouple_loss:0.0018671432044357061
The modified gen p mean: 0.4480586051940918, gen p mean: -0.2352471649646759, mean p set: 0.448634535074234
The modified gen p mean: 0.4492669999599457, gen p mean: -0.24158169329166412, mean p set: 0.44983842968940735
loss_pred:0.013971278443932533, decouple_loss:0.0018534711562097073
loss_pred:0.014504972845315933, decouple_loss:0.0021331103052943945
Iteration: 4014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484998881816864, gen p mean: -0.23932243883609772, mean p set: 0.44902855157852173
loss_pred:0.014496675692498684, decouple_loss:0.0016834710258990526
The modified gen p mean: 0.44777318835258484, gen p mean: -0.2321585863828659, mean p set: 0.4483490288257599
The modified gen p mean: 0.44838735461235046, gen p mean: -0.23833738267421722, mean p set: 0.44896194338798523
loss_pred:0.013979658484458923, decouple_loss:0.0018673138692975044
loss_pred:0.014524568803608418, decouple_loss:0.0017030863091349602
Iteration: 4015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498891234397888, gen p mean: -0.2347346544265747, mean p set: 0.45046207308769226
loss_pred:0.013765756040811539, decouple_loss:0.0021335757337510586
The modified gen p mean: 0.4475433826446533, gen p mean: -0.23884771764278412, mean p set: 0.4481198489665985The modified gen p mean: 0.4487919509410858, gen p mean: -0.23570634424686432, mean p set: 0.44932347536087036
loss_pred:0.013839230872690678, decouple_loss:0.001986637944355607
loss_pred:0.013834455981850624, decouple_loss:0.0019160270458087325
Iteration: 4016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030951499938965, gen p mean: -0.2339201718568802, mean p set: 0.4508882462978363
loss_pred:0.01396499015390873, decouple_loss:0.0018514140974730253
The modified gen p mean: 0.4480629563331604, gen p mean: -0.2366929054260254, mean p set: 0.4485909342765808The modified gen p mean: 0.44981104135513306, gen p mean: -0.23906321823596954, mean p set: 0.4503842294216156
loss_pred:0.014299673028290272, decouple_loss:0.001927621429786086
loss_pred:0.014647247269749641, decouple_loss:0.00159430131316185
Iteration: 4017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953104853630066, gen p mean: -0.23959174752235413, mean p set: 0.4500616788864136
loss_pred:0.014110061340034008, decouple_loss:0.0022952428553253412
The modified gen p mean: 0.44846993684768677, gen p mean: -0.24228103458881378, mean p set: 0.44904085993766785
The modified gen p mean: 0.44934388995170593, gen p mean: -0.2286144345998764, mean p set: 0.4499235153198242
loss_pred:0.013878269121050835, decouple_loss:0.002371077658608556
loss_pred:0.014364983886480331, decouple_loss:0.0024328106082975864
Iteration: 4018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449172705411911, gen p mean: -0.2351880669593811, mean p set: 0.44975459575653076
loss_pred:0.013965931721031666, decouple_loss:0.00217986898496747
The modified gen p mean: 0.4488864839076996, gen p mean: -0.23438136279582977, mean p set: 0.44945788383483887
loss_pred:0.013803432695567608, decouple_loss:0.0023185010068118572
The modified gen p mean: 0.44878268241882324, gen p mean: -0.2352062165737152, mean p set: 0.44930922985076904
loss_pred:0.013957563787698746, decouple_loss:0.002227600896731019
Iteration: 4019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486015737056732, gen p mean: -0.23543386161327362, mean p set: 0.44917967915534973
loss_pred:0.013930805958807468, decouple_loss:0.002136032795533538
The modified gen p mean: 0.4477948546409607, gen p mean: -0.22898495197296143, mean p set: 0.44837456941604614
loss_pred:0.01409674622118473, decouple_loss:0.0022994992323219776
The modified gen p mean: 0.4490548074245453, gen p mean: -0.23510700464248657, mean p set: 0.44958946108818054
loss_pred:0.014062682166695595, decouple_loss:0.0024324252735823393
Iteration: 4020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871771335601807, gen p mean: -0.23748232424259186, mean p set: 0.449288934469223
loss_pred:0.014183409512043, decouple_loss:0.002253439510241151
The modified gen p mean: 0.44837039709091187, gen p mean: -0.23333309590816498, mean p set: 0.448943167924881
loss_pred:0.014151410199701786, decouple_loss:0.002170536434277892
The modified gen p mean: 0.4486967921257019, gen p mean: -0.23817916214466095, mean p set: 0.4492279887199402
loss_pred:0.013674975372850895, decouple_loss:0.0022241815458983183
2023-04-27 19:52:08 testing...
The modified gen p mean: 0.44822409749031067, gen p mean: -0.23774400353431702, mean p set: 0.44879910349845886
loss_pred:0.015517735853791237, decouple_loss:0.002324084285646677
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24015679955482483, mean p set: 0.4499112665653229
loss_pred:0.015661953017115593, decouple_loss:0.002200361806899309
The modified gen p mean: 0.44930410385131836, gen p mean: -0.24061115086078644, mean p set: 0.4498290419578552
loss_pred:0.01515926979482174, decouple_loss:0.0026185503229498863
WV_1_PC_1_EH_0_PS_30, loss: 0.01556537114083767, avg_mse: 0.022963013499975204
current test mse: 0.022963
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 4021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754549860954285, gen p mean: -0.23983198404312134, mean p set: 0.44807714223861694
loss_pred:0.015156029723584652, decouple_loss:0.0026103644631803036
The modified gen p mean: 0.4473995268344879, gen p mean: -0.2398299127817154, mean p set: 0.4479702413082123
loss_pred:0.015137439593672752, decouple_loss:0.0025600993540138006
The modified gen p mean: 0.44745969772338867, gen p mean: -0.2385142594575882, mean p set: 0.4480361342430115
loss_pred:0.015287679620087147, decouple_loss:0.0022580642253160477
Iteration: 4022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471491873264313, gen p mean: -0.23896194994449615, mean p set: 0.44767072796821594
loss_pred:0.015557406470179558, decouple_loss:0.002307436428964138
The modified gen p mean: 0.4475266933441162, gen p mean: -0.23952807486057281, mean p set: 0.4481000304222107
loss_pred:0.015174304135143757, decouple_loss:0.0021850154735147953
The modified gen p mean: 0.44709035754203796, gen p mean: -0.23948480188846588, mean p set: 0.4476645588874817
loss_pred:0.015276591293513775, decouple_loss:0.0020319612231105566
Iteration: 4023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473068118095398, gen p mean: -0.23730789124965668, mean p set: 0.44783589243888855
loss_pred:0.014511899091303349, decouple_loss:0.001843231380917132
The modified gen p mean: 0.4472436308860779, gen p mean: -0.23449154198169708, mean p set: 0.44781771302223206
loss_pred:0.015486542135477066, decouple_loss:0.00198719697073102
The modified gen p mean: 0.44757282733917236, gen p mean: -0.24061834812164307, mean p set: 0.4481448233127594
loss_pred:0.015153123997151852, decouple_loss:0.001892519649118185
Iteration: 4024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474896788597107, gen p mean: -0.23086391389369965, mean p set: 0.4480176270008087
loss_pred:0.015435650944709778, decouple_loss:0.0019924589432775974
The modified gen p mean: 0.4479425251483917, gen p mean: -0.23341728746891022, mean p set: 0.4485156238079071
loss_pred:0.014391145668923855, decouple_loss:0.001978370128199458
The modified gen p mean: 0.4475332498550415, gen p mean: -0.22905799746513367, mean p set: 0.4481123387813568
loss_pred:0.014710888266563416, decouple_loss:0.0020066455472260714
Iteration: 4025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479091167449951, gen p mean: -0.2326476275920868, mean p set: 0.44848695397377014
loss_pred:0.014799728989601135, decouple_loss:0.0018297903006896377
The modified gen p mean: 0.4484899342060089, gen p mean: -0.2315729707479477, mean p set: 0.4490697383880615The modified gen p mean: 0.44718611240386963, gen p mean: -0.2309415638446808, mean p set: 0.44771143794059753
loss_pred:0.014633149839937687, decouple_loss:0.0018001089338213205
loss_pred:0.0153276352211833, decouple_loss:0.002024235436692834
Iteration: 4026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480346441268921, gen p mean: -0.22590862214565277, mean p set: 0.4486115872859955
loss_pred:0.015018653124570847, decouple_loss:0.0019573410972952843
The modified gen p mean: 0.44749414920806885, gen p mean: -0.22949115931987762, mean p set: 0.44806763529777527The modified gen p mean: 0.44721928238868713, gen p mean: -0.2288048267364502, mean p set: 0.44774720072746277
loss_pred:0.014834566973149776, decouple_loss:0.0018898973939940333
loss_pred:0.014524754136800766, decouple_loss:0.0018113135593011975
Iteration: 4027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667431712150574, gen p mean: -0.2295406609773636, mean p set: 0.44725102186203003
loss_pred:0.014516097493469715, decouple_loss:0.001785183441825211
The modified gen p mean: 0.4474121928215027, gen p mean: -0.23126226663589478, mean p set: 0.44793930649757385The modified gen p mean: 0.447695255279541, gen p mean: -0.2274341583251953, mean p set: 0.4482730031013489
loss_pred:0.014778023585677147, decouple_loss:0.0017258886946365237
loss_pred:0.015316047705709934, decouple_loss:0.0018300346564501524
Iteration: 4028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477596580982208, gen p mean: -0.23307864367961884, mean p set: 0.44833505153656006
loss_pred:0.015196711756289005, decouple_loss:0.002194453263655305
The modified gen p mean: 0.447063148021698, gen p mean: -0.23505312204360962, mean p set: 0.44763314723968506The modified gen p mean: 0.4474327862262726, gen p mean: -0.231160506606102, mean p set: 0.4479668438434601
loss_pred:0.015510648488998413, decouple_loss:0.0020794891752302647
loss_pred:0.015521115623414516, decouple_loss:0.0019506319658830762
Iteration: 4029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681984186172485, gen p mean: -0.23748260736465454, mean p set: 0.44739648699760437
loss_pred:0.015552017837762833, decouple_loss:0.0022206108551472425
The modified gen p mean: 0.44742801785469055, gen p mean: -0.2364967316389084, mean p set: 0.44800713658332825
loss_pred:0.01463101152330637, decouple_loss:0.00212529837153852
The modified gen p mean: 0.4477245509624481, gen p mean: -0.23946961760520935, mean p set: 0.4482428729534149
loss_pred:0.014736502431333065, decouple_loss:0.0018007383914664388
Iteration: 4030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476676285266876, gen p mean: -0.23583267629146576, mean p set: 0.44824355840682983
loss_pred:0.015254397876560688, decouple_loss:0.0018118112348020077
The modified gen p mean: 0.44692304730415344, gen p mean: -0.2297678142786026, mean p set: 0.44749921560287476The modified gen p mean: 0.44649219512939453, gen p mean: -0.23187847435474396, mean p set: 0.44702383875846863
loss_pred:0.015005089342594147, decouple_loss:0.0018468876369297504
loss_pred:0.014665963128209114, decouple_loss:0.0019371334929019213
2023-04-27 19:56:07 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2308732569217682, mean p set: 0.4499112665653229
loss_pred:0.015534847974777222, decouple_loss:0.002544205170124769
The modified gen p mean: 0.4493040442466736, gen p mean: -0.23114195466041565, mean p set: 0.4498290419578552
loss_pred:0.015073568560183048, decouple_loss:0.0020206859335303307
The modified gen p mean: 0.4482191801071167, gen p mean: -0.22849319875240326, mean p set: 0.44879910349845886
loss_pred:0.015404611825942993, decouple_loss:0.0022351969964802265
WV_1_PC_1_EH_0_PS_30, loss: 0.015451010316610336, avg_mse: 0.022802872583270073
current test mse: 0.022803
Iteration: 4031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709154963493347, gen p mean: -0.23086276650428772, mean p set: 0.4476606547832489
loss_pred:0.015053431503474712, decouple_loss:0.0025514494627714157
The modified gen p mean: 0.4474782347679138, gen p mean: -0.234490305185318, mean p set: 0.4480043649673462
loss_pred:0.015468702651560307, decouple_loss:0.002292918972671032
The modified gen p mean: 0.4470204710960388, gen p mean: -0.22816529870033264, mean p set: 0.4475988745689392
loss_pred:0.014707110822200775, decouple_loss:0.002149024745449424
Iteration: 4032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724857807159424, gen p mean: -0.23540273308753967, mean p set: 0.44777771830558777
loss_pred:0.015289169736206532, decouple_loss:0.0020401780493557453
The modified gen p mean: 0.4478117823600769, gen p mean: -0.23356039822101593, mean p set: 0.4483889639377594
The modified gen p mean: 0.44686782360076904, gen p mean: -0.236085906624794, mean p set: 0.447443425655365
loss_pred:0.015099395997822285, decouple_loss:0.0022024631034582853
loss_pred:0.014695103280246258, decouple_loss:0.001977322157472372
Iteration: 4033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769415259361267, gen p mean: -0.23892410099506378, mean p set: 0.4482216238975525
loss_pred:0.01557970605790615, decouple_loss:0.00239400751888752
The modified gen p mean: 0.44621792435646057, gen p mean: -0.24059072136878967, mean p set: 0.44678664207458496
The modified gen p mean: 0.44656431674957275, gen p mean: -0.24034389853477478, mean p set: 0.44713303446769714
loss_pred:0.014533815905451775, decouple_loss:0.002497767796739936
loss_pred:0.014347324147820473, decouple_loss:0.002277085091918707
Iteration: 4034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828513264656067, gen p mean: -0.24263113737106323, mean p set: 0.4488099217414856
loss_pred:0.015464694239199162, decouple_loss:0.0021054211538285017
The modified gen p mean: 0.447296142578125, gen p mean: -0.23646745085716248, mean p set: 0.4478713572025299
The modified gen p mean: 0.447574257850647, gen p mean: -0.2387334108352661, mean p set: 0.4481445848941803
loss_pred:0.015449299477040768, decouple_loss:0.002099948702380061
loss_pred:0.014559888280928135, decouple_loss:0.0024227965623140335
Iteration: 4035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467236399650574, gen p mean: -0.2444683164358139, mean p set: 0.44729599356651306
loss_pred:0.014213581569492817, decouple_loss:0.002237814012914896
The modified gen p mean: 0.4476786255836487, gen p mean: -0.24407151341438293, mean p set: 0.44820162653923035The modified gen p mean: 0.44804948568344116, gen p mean: -0.24825654923915863, mean p set: 0.4486217796802521
loss_pred:0.01473731268197298, decouple_loss:0.0020223886240273714
loss_pred:0.015447448939085007, decouple_loss:0.0021388933528214693
Iteration: 4036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719836115837097, gen p mean: -0.24057301878929138, mean p set: 0.4477778375148773
loss_pred:0.014421598054468632, decouple_loss:0.002150187036022544
The modified gen p mean: 0.44740167260169983, gen p mean: -0.24228596687316895, mean p set: 0.44792598485946655The modified gen p mean: 0.4468896985054016, gen p mean: -0.2382776439189911, mean p set: 0.4474641680717468
loss_pred:0.01560611929744482, decouple_loss:0.0019673428032547235
loss_pred:0.014897075481712818, decouple_loss:0.0019758795388042927
Iteration: 4037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700175523757935, gen p mean: -0.24218235909938812, mean p set: 0.44758090376853943
loss_pred:0.014686934649944305, decouple_loss:0.0018984893104061484
The modified gen p mean: 0.4477667808532715, gen p mean: -0.24363920092582703, mean p set: 0.4482952058315277The modified gen p mean: 0.44751134514808655, gen p mean: -0.23564469814300537, mean p set: 0.4480897784233093
loss_pred:0.014942596666514874, decouple_loss:0.002203922485932708
loss_pred:0.014943964779376984, decouple_loss:0.0019641194958239794
Iteration: 4038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848552346229553, gen p mean: -0.23676307499408722, mean p set: 0.4490669369697571
loss_pred:0.01473067793995142, decouple_loss:0.001814190181903541
The modified gen p mean: 0.447428435087204, gen p mean: -0.24142266809940338, mean p set: 0.4480067491531372
loss_pred:0.014989485032856464, decouple_loss:0.0018347948789596558
The modified gen p mean: 0.44727823138237, gen p mean: -0.2371916025876999, mean p set: 0.4478038251399994
loss_pred:0.014956440776586533, decouple_loss:0.0019390861270949244
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698455929756165, gen p mean: -0.2340376377105713, mean p set: 0.44755926728248596
loss_pred:0.015617075376212597, decouple_loss:0.0019789044745266438
The modified gen p mean: 0.4474813938140869, gen p mean: -0.2422480434179306, mean p set: 0.4480603337287903
loss_pred:0.014860119670629501, decouple_loss:0.0020309756509959698
The modified gen p mean: 0.44622522592544556, gen p mean: -0.23646461963653564, mean p set: 0.4467572569847107
loss_pred:0.014142443425953388, decouple_loss:0.002093701623380184
Iteration: 4040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44592034816741943, gen p mean: -0.2392858862876892, mean p set: 0.44649389386177063
loss_pred:0.01415297482162714, decouple_loss:0.0015588896349072456
The modified gen p mean: 0.4476926624774933, gen p mean: -0.2436886578798294, mean p set: 0.4482708275318146
loss_pred:0.015578673221170902, decouple_loss:0.0017225199844688177
The modified gen p mean: 0.44715026021003723, gen p mean: -0.2432088702917099, mean p set: 0.44768041372299194
loss_pred:0.014190911315381527, decouple_loss:0.0017120923148468137
2023-04-27 19:59:33 testing...
The modified gen p mean: 0.4482240378856659, gen p mean: -0.23766663670539856, mean p set: 0.44879910349845886
loss_pred:0.015406507067382336, decouple_loss:0.002297633094713092
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2400558888912201, mean p set: 0.4499112665653229
loss_pred:0.01557699590921402, decouple_loss:0.0022375902626663446
The modified gen p mean: 0.4493080973625183, gen p mean: -0.24052587151527405, mean p set: 0.4498290419578552
loss_pred:0.015051017515361309, decouple_loss:0.002550015226006508
WV_1_PC_1_EH_0_PS_30, loss: 0.015462927520275116, avg_mse: 0.02281503938138485
current test mse: 0.022815
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 4041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836461544036865, gen p mean: -0.2365715205669403, mean p set: 0.44889214634895325
loss_pred:0.014276151545345783, decouple_loss:0.0026732643600553274
The modified gen p mean: 0.448274165391922, gen p mean: -0.24493280053138733, mean p set: 0.44884857535362244
loss_pred:0.014411219395697117, decouple_loss:0.002542611677199602
The modified gen p mean: 0.4494911730289459, gen p mean: -0.2399221509695053, mean p set: 0.45007139444351196
loss_pred:0.014541487209498882, decouple_loss:0.002427202882245183
Iteration: 4042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965115189552307, gen p mean: -0.24087129533290863, mean p set: 0.45017769932746887
loss_pred:0.01383926160633564, decouple_loss:0.0018949974328279495
The modified gen p mean: 0.44710686802864075, gen p mean: -0.24106012284755707, mean p set: 0.4476839303970337
loss_pred:0.013971631415188313, decouple_loss:0.0019503171788528562
The modified gen p mean: 0.44955527782440186, gen p mean: -0.2370975762605667, mean p set: 0.4501335322856903
loss_pred:0.013717134483158588, decouple_loss:0.0020129974000155926
Iteration: 4043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499637186527252, gen p mean: -0.23504002392292023, mean p set: 0.4504936933517456
loss_pred:0.013118949718773365, decouple_loss:0.0019480463815853
The modified gen p mean: 0.4489807188510895, gen p mean: -0.24184496700763702, mean p set: 0.4495563805103302
loss_pred:0.014390979893505573, decouple_loss:0.0019914309959858656
The modified gen p mean: 0.4493435025215149, gen p mean: -0.23999175429344177, mean p set: 0.4499218463897705
loss_pred:0.01408848725259304, decouple_loss:0.0019858998712152243
Iteration: 4044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986411929130554, gen p mean: -0.23223768174648285, mean p set: 0.4503912329673767
loss_pred:0.012897728011012077, decouple_loss:0.0018722476670518517
The modified gen p mean: 0.44786226749420166, gen p mean: -0.2380179464817047, mean p set: 0.44843724370002747
loss_pred:0.013964320532977581, decouple_loss:0.0020247031934559345
The modified gen p mean: 0.4494626820087433, gen p mean: -0.23309795558452606, mean p set: 0.4500423073768616
loss_pred:0.01451854407787323, decouple_loss:0.001972849015146494
Iteration: 4045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035338401794434, gen p mean: -0.2322128862142563, mean p set: 0.45092666149139404
loss_pred:0.013813348487019539, decouple_loss:0.002281856257468462
The modified gen p mean: 0.45015010237693787, gen p mean: -0.22885407507419586, mean p set: 0.4507233798503876
loss_pred:0.01387169398367405, decouple_loss:0.0021732868626713753
The modified gen p mean: 0.4476920962333679, gen p mean: -0.23066748678684235, mean p set: 0.4482172131538391
loss_pred:0.013972870074212551, decouple_loss:0.002065173117443919
Iteration: 4046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493255019187927, gen p mean: -0.23207402229309082, mean p set: 0.4499005675315857
loss_pred:0.01398774515837431, decouple_loss:0.0018386982847005129
The modified gen p mean: 0.4494667947292328, gen p mean: -0.23010291159152985, mean p set: 0.4499913156032562The modified gen p mean: 0.44982919096946716, gen p mean: -0.23060014843940735, mean p set: 0.450408935546875
loss_pred:0.013520287349820137, decouple_loss:0.0019329446367919445
loss_pred:0.013578806072473526, decouple_loss:0.0019730981439352036
Iteration: 4047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934970140457153, gen p mean: -0.23638060688972473, mean p set: 0.4499257802963257
loss_pred:0.013996586203575134, decouple_loss:0.001942765200510621
The modified gen p mean: 0.44887569546699524, gen p mean: -0.2340490221977234, mean p set: 0.4494022727012634The modified gen p mean: 0.4489116370677948, gen p mean: -0.24249383807182312, mean p set: 0.4494844079017639
loss_pred:0.01447124220430851, decouple_loss:0.0018651047721505165
loss_pred:0.01473683025687933, decouple_loss:0.0018547027138993144
Iteration: 4048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868507981300354, gen p mean: -0.23351716995239258, mean p set: 0.4492511451244354
loss_pred:0.014989917166531086, decouple_loss:0.0019613581243902445
The modified gen p mean: 0.4492388665676117, gen p mean: -0.23887725174427032, mean p set: 0.4498126208782196
loss_pred:0.013745374977588654, decouple_loss:0.0018934388644993305
The modified gen p mean: 0.4502430558204651, gen p mean: -0.23383009433746338, mean p set: 0.4507656991481781
loss_pred:0.01371025014668703, decouple_loss:0.002144194906577468
Iteration: 4049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482181668281555, gen p mean: -0.23397117853164673, mean p set: 0.4487907588481903
loss_pred:0.014153649099171162, decouple_loss:0.0019288392504677176
The modified gen p mean: 0.4500192105770111, gen p mean: -0.23740154504776, mean p set: 0.4505973160266876
loss_pred:0.0137917660176754, decouple_loss:0.001893509179353714
The modified gen p mean: 0.4504925310611725, gen p mean: -0.2344161421060562, mean p set: 0.4510194957256317
loss_pred:0.01347173098474741, decouple_loss:0.002145475707948208
Iteration: 4050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489569664001465, gen p mean: -0.23133285343647003, mean p set: 0.44953563809394836
loss_pred:0.013607747852802277, decouple_loss:0.002011663978919387
The modified gen p mean: 0.44930678606033325, gen p mean: -0.2382403165102005, mean p set: 0.4498860538005829
loss_pred:0.014379779808223248, decouple_loss:0.0017418493516743183
The modified gen p mean: 0.4501524567604065, gen p mean: -0.23711887001991272, mean p set: 0.4506858289241791
loss_pred:0.01368136890232563, decouple_loss:0.0019380842568352818
2023-04-27 20:03:36 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23277172446250916, mean p set: 0.4499112665653229
loss_pred:0.01568588986992836, decouple_loss:0.0018727731658145785
The modified gen p mean: 0.44930556416511536, gen p mean: -0.23306693136692047, mean p set: 0.4498290419578552
loss_pred:0.015126948244869709, decouple_loss:0.0019987712148576975
The modified gen p mean: 0.44822099804878235, gen p mean: -0.2302972823381424, mean p set: 0.44879910349845886
loss_pred:0.015458659268915653, decouple_loss:0.00190135242883116
WV_1_PC_1_EH_0_PS_30, loss: 0.015520047396421432, avg_mse: 0.022983526811003685
current test mse: 0.022984
Iteration: 4051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742193818092346, gen p mean: -0.23128192126750946, mean p set: 0.4479977786540985
loss_pred:0.013767233118414879, decouple_loss:0.0017185332253575325
The modified gen p mean: 0.44840747117996216, gen p mean: -0.23068419098854065, mean p set: 0.4489321708679199
loss_pred:0.0135009391233325, decouple_loss:0.0017608244670554996
The modified gen p mean: 0.4474295377731323, gen p mean: -0.23103882372379303, mean p set: 0.448009192943573
loss_pred:0.013586742803454399, decouple_loss:0.0016720998100936413
Iteration: 4052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490602910518646, gen p mean: -0.23339398205280304, mean p set: 0.44958579540252686
loss_pred:0.014072936028242111, decouple_loss:0.0018237322801724076
The modified gen p mean: 0.4497588872909546, gen p mean: -0.23014779388904572, mean p set: 0.4503350555896759
The modified gen p mean: 0.4503241777420044, gen p mean: -0.23223233222961426, mean p set: 0.4508989155292511
loss_pred:0.01398248877376318, decouple_loss:0.0017565309535712004
loss_pred:0.013278716243803501, decouple_loss:0.001945239957422018
Iteration: 4053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487018287181854, gen p mean: -0.22877150774002075, mean p set: 0.4492337107658386
loss_pred:0.013452306389808655, decouple_loss:0.0019404592458158731
The modified gen p mean: 0.45024406909942627, gen p mean: -0.23016735911369324, mean p set: 0.4508228898048401
The modified gen p mean: 0.44997522234916687, gen p mean: -0.23058821260929108, mean p set: 0.4505492150783539
loss_pred:0.013279341161251068, decouple_loss:0.0018222036305814981
loss_pred:0.013375958427786827, decouple_loss:0.0019689754117280245
Iteration: 4054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936835765838623, gen p mean: -0.23227211833000183, mean p set: 0.4498968720436096
loss_pred:0.013272150419652462, decouple_loss:0.001971481367945671
The modified gen p mean: 0.44778114557266235, gen p mean: -0.22705808281898499, mean p set: 0.44835996627807617
The modified gen p mean: 0.44883468747138977, gen p mean: -0.2296072542667389, mean p set: 0.4494141638278961
loss_pred:0.01474445965141058, decouple_loss:0.0018748678267002106
loss_pred:0.01447380892932415, decouple_loss:0.0018056522822007537
Iteration: 4055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890284538269043, gen p mean: -0.2365742325782776, mean p set: 0.4494830369949341
loss_pred:0.013566260226070881, decouple_loss:0.001958815846592188
The modified gen p mean: 0.449651300907135, gen p mean: -0.23091550171375275, mean p set: 0.4501778185367584The modified gen p mean: 0.44904986023902893, gen p mean: -0.23746593296527863, mean p set: 0.4496326744556427
loss_pred:0.013811669312417507, decouple_loss:0.0020803518127650023
loss_pred:0.014016506262123585, decouple_loss:0.001888249535113573
Iteration: 4056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013150572776794, gen p mean: -0.23278164863586426, mean p set: 0.4507005214691162
loss_pred:0.01328477542847395, decouple_loss:0.0017954582581296563
The modified gen p mean: 0.44895878434181213, gen p mean: -0.22852681577205658, mean p set: 0.44949066638946533The modified gen p mean: 0.4504818618297577, gen p mean: -0.22996392846107483, mean p set: 0.45106109976768494
loss_pred:0.013133781962096691, decouple_loss:0.0018974852282553911
loss_pred:0.014139754697680473, decouple_loss:0.001742812804877758
Iteration: 4057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050203800201416, gen p mean: -0.23336254060268402, mean p set: 0.4510750472545624
loss_pred:0.013955158181488514, decouple_loss:0.0017633931711316109
The modified gen p mean: 0.4506729543209076, gen p mean: -0.22762304544448853, mean p set: 0.4512515664100647
loss_pred:0.013805137947201729, decouple_loss:0.0018488169880583882
The modified gen p mean: 0.45038655400276184, gen p mean: -0.22771871089935303, mean p set: 0.4509190618991852
loss_pred:0.013919837772846222, decouple_loss:0.0018375684740021825
Iteration: 4058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714227318763733, gen p mean: -0.22979480028152466, mean p set: 0.4477207064628601
loss_pred:0.013749807141721249, decouple_loss:0.0016674255020916462
The modified gen p mean: 0.4488111734390259, gen p mean: -0.22879116237163544, mean p set: 0.44939103722572327
loss_pred:0.014095980674028397, decouple_loss:0.0016743401065468788
The modified gen p mean: 0.45011410117149353, gen p mean: -0.22763590514659882, mean p set: 0.45064398646354675
loss_pred:0.01287691667675972, decouple_loss:0.0017622989835217595
Iteration: 4059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815078377723694, gen p mean: -0.22784453630447388, mean p set: 0.44873154163360596
loss_pred:0.013451581820845604, decouple_loss:0.0018115808488801122
The modified gen p mean: 0.44852718710899353, gen p mean: -0.22271743416786194, mean p set: 0.4491027593612671
loss_pred:0.014017310924828053, decouple_loss:0.0018653868464753032
The modified gen p mean: 0.4491802155971527, gen p mean: -0.2251596599817276, mean p set: 0.449707955121994
loss_pred:0.013958376832306385, decouple_loss:0.0016656925436109304
Iteration: 4060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487748146057129, gen p mean: -0.22798261046409607, mean p set: 0.4493516683578491
loss_pred:0.014718600548803806, decouple_loss:0.0017885605338960886
The modified gen p mean: 0.4492247998714447, gen p mean: -0.228205606341362, mean p set: 0.4497992694377899
loss_pred:0.0135468365624547, decouple_loss:0.0016874223947525024
The modified gen p mean: 0.45023423433303833, gen p mean: -0.2298801988363266, mean p set: 0.45076262950897217
loss_pred:0.01314541231840849, decouple_loss:0.0016321827424690127
2023-04-27 20:07:01 testing...
The modified gen p mean: 0.44822078943252563, gen p mean: -0.22828178107738495, mean p set: 0.44879910349845886
loss_pred:0.015574084594845772, decouple_loss:0.0017188062192872167
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2307080328464508, mean p set: 0.4499112665653229
loss_pred:0.015706742182374, decouple_loss:0.0017755830194801092
The modified gen p mean: 0.4493013322353363, gen p mean: -0.23088565468788147, mean p set: 0.4498290419578552
loss_pred:0.015176483429968357, decouple_loss:0.001784890191629529
WV_1_PC_1_EH_0_PS_30, loss: 0.015573758631944656, avg_mse: 0.023044878616929054
current test mse: 0.023045
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 4061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474659860134125, gen p mean: -0.22753964364528656, mean p set: 0.44799429178237915
loss_pred:0.014058195054531097, decouple_loss:0.0017588433111086488
The modified gen p mean: 0.44810062646865845, gen p mean: -0.2278529554605484, mean p set: 0.4486773908138275
The modified gen p mean: 0.44753536581993103, gen p mean: -0.23656046390533447, mean p set: 0.44811320304870605
loss_pred:0.014442932792007923, decouple_loss:0.0016140250954777002
loss_pred:0.014558550901710987, decouple_loss:0.0018000502604991198
Iteration: 4062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474852383136749, gen p mean: -0.23277463018894196, mean p set: 0.4480171501636505
loss_pred:0.0149468295276165, decouple_loss:0.002013786695897579
The modified gen p mean: 0.4459732174873352, gen p mean: -0.23814933001995087, mean p set: 0.4465450048446655
loss_pred:0.014447112567722797, decouple_loss:0.001677082502283156
The modified gen p mean: 0.4477406144142151, gen p mean: -0.2304467409849167, mean p set: 0.44832247495651245
loss_pred:0.015139280818402767, decouple_loss:0.0019854605197906494
Iteration: 4063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44638288021087646, gen p mean: -0.23138809204101562, mean p set: 0.4469052851200104
loss_pred:0.01439700834453106, decouple_loss:0.002123406156897545
The modified gen p mean: 0.44796764850616455, gen p mean: -0.2336256206035614, mean p set: 0.4485393166542053
loss_pred:0.013820242136716843, decouple_loss:0.002238042186945677
The modified gen p mean: 0.44759365916252136, gen p mean: -0.23377029597759247, mean p set: 0.44817250967025757
loss_pred:0.01437468733638525, decouple_loss:0.001852740882895887
Iteration: 4064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471496045589447, gen p mean: -0.2295868843793869, mean p set: 0.4476746618747711
loss_pred:0.0145344790071249, decouple_loss:0.0017206092597916722
The modified gen p mean: 0.4465964138507843, gen p mean: -0.2332947850227356, mean p set: 0.4471730887889862
loss_pred:0.014641732908785343, decouple_loss:0.0017922907136380672
The modified gen p mean: 0.4466029107570648, gen p mean: -0.23051267862319946, mean p set: 0.447177916765213
loss_pred:0.014170203357934952, decouple_loss:0.0018378441454842687
Iteration: 4065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482196569442749, gen p mean: -0.22696004807949066, mean p set: 0.4487995207309723
loss_pred:0.014850540086627007, decouple_loss:0.001821876154281199
The modified gen p mean: 0.44793900847435, gen p mean: -0.23273511230945587, mean p set: 0.4484725892543793The modified gen p mean: 0.4480213522911072, gen p mean: -0.23149481415748596, mean p set: 0.4485970735549927
loss_pred:0.013763940893113613, decouple_loss:0.0017092155758291483
loss_pred:0.013993198983371258, decouple_loss:0.0017220275476574898
Iteration: 4066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471870958805084, gen p mean: -0.2264592945575714, mean p set: 0.4477651119232178
loss_pred:0.014648578129708767, decouple_loss:0.00162001873832196
The modified gen p mean: 0.44724151492118835, gen p mean: -0.23005487024784088, mean p set: 0.44781988859176636
loss_pred:0.014919375069439411, decouple_loss:0.0017323974752798676
The modified gen p mean: 0.447822242975235, gen p mean: -0.22924448549747467, mean p set: 0.4483456313610077
loss_pred:0.014222153462469578, decouple_loss:0.0017804806120693684
Iteration: 4067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808584451675415, gen p mean: -0.2313203066587448, mean p set: 0.4486536979675293
loss_pred:0.014315311796963215, decouple_loss:0.002001857850700617
The modified gen p mean: 0.4471169114112854, gen p mean: -0.22485123574733734, mean p set: 0.44764673709869385The modified gen p mean: 0.4472428262233734, gen p mean: -0.23216520249843597, mean p set: 0.4478101134300232
loss_pred:0.014364940114319324, decouple_loss:0.002202893840149045
loss_pred:0.014522258192300797, decouple_loss:0.0019029797986149788
Iteration: 4068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478593170642853, gen p mean: -0.2358366847038269, mean p set: 0.44843369722366333
loss_pred:0.014205445535480976, decouple_loss:0.001631251652725041
The modified gen p mean: 0.4480437636375427, gen p mean: -0.23313787579536438, mean p set: 0.4485742151737213The modified gen p mean: 0.4477783739566803, gen p mean: -0.23076525330543518, mean p set: 0.44834527373313904
loss_pred:0.014821826480329037, decouple_loss:0.0016409101663157344
loss_pred:0.01410205289721489, decouple_loss:0.001639027614146471
Iteration: 4069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783368706703186, gen p mean: -0.2342185080051422, mean p set: 0.44840726256370544
loss_pred:0.014353142119944096, decouple_loss:0.0018299154471606016
The modified gen p mean: 0.4472264349460602, gen p mean: -0.23987653851509094, mean p set: 0.44780153036117554
loss_pred:0.015043911524116993, decouple_loss:0.0018162355991080403
The modified gen p mean: 0.4481127858161926, gen p mean: -0.23653273284435272, mean p set: 0.4486377537250519
loss_pred:0.014377998188138008, decouple_loss:0.0019051723647862673
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457593858242035, gen p mean: -0.23877163231372833, mean p set: 0.446336567401886
loss_pred:0.014143981970846653, decouple_loss:0.0017519008833914995
The modified gen p mean: 0.44735005497932434, gen p mean: -0.23354807496070862, mean p set: 0.44792816042900085The modified gen p mean: 0.4455270767211914, gen p mean: -0.23294366896152496, mean p set: 0.4460587203502655
loss_pred:0.014012064784765244, decouple_loss:0.001807785825803876
loss_pred:0.014036817476153374, decouple_loss:0.0017399010248482227
2023-04-27 20:11:03 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24021309614181519, mean p set: 0.4499112665653229
loss_pred:0.015611270442605019, decouple_loss:0.0017675162525847554
The modified gen p mean: 0.44929543137550354, gen p mean: -0.2406439632177353, mean p set: 0.4498290419578552
loss_pred:0.01517239585518837, decouple_loss:0.002059181919321418
The modified gen p mean: 0.4482157230377197, gen p mean: -0.23788735270500183, mean p set: 0.44879910349845886
loss_pred:0.01549024973064661, decouple_loss:0.0019109004642814398
WV_1_PC_1_EH_0_PS_30, loss: 0.015520265325903893, avg_mse: 0.022914737462997437
current test mse: 0.022915
Iteration: 4071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763070344924927, gen p mean: -0.23495104908943176, mean p set: 0.44820424914360046
loss_pred:0.01446380652487278, decouple_loss:0.0018060837173834443
The modified gen p mean: 0.4472050368785858, gen p mean: -0.24040263891220093, mean p set: 0.44773492217063904
loss_pred:0.014208239503204823, decouple_loss:0.001780241378583014
The modified gen p mean: 0.4481785297393799, gen p mean: -0.2435491979122162, mean p set: 0.44875964522361755
loss_pred:0.014307801611721516, decouple_loss:0.002016368554905057
Iteration: 4072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476073384284973, gen p mean: -0.24390549957752228, mean p set: 0.4481382668018341
loss_pred:0.01403967384248972, decouple_loss:0.001664268784224987
The modified gen p mean: 0.4477464258670807, gen p mean: -0.2382756471633911, mean p set: 0.44832614064216614
The modified gen p mean: 0.44653427600860596, gen p mean: -0.24345295131206512, mean p set: 0.4471103250980377
loss_pred:0.013487420044839382, decouple_loss:0.0016814937116578221
loss_pred:0.01482160110026598, decouple_loss:0.0015721755335107446
Iteration: 4073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678741693496704, gen p mean: -0.23914317786693573, mean p set: 0.4473235309123993
loss_pred:0.014621170237660408, decouple_loss:0.0018609920516610146
The modified gen p mean: 0.4480336010456085, gen p mean: -0.23873470723628998, mean p set: 0.44860827922821045
The modified gen p mean: 0.44655683636665344, gen p mean: -0.23892398178577423, mean p set: 0.44713273644447327
loss_pred:0.013997550122439861, decouple_loss:0.0018408761825412512
loss_pred:0.014262517914175987, decouple_loss:0.0017153775552287698
Iteration: 4074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485873281955719, gen p mean: -0.2384461611509323, mean p set: 0.449113667011261
loss_pred:0.014417717233300209, decouple_loss:0.0018857890972867608
The modified gen p mean: 0.4472205936908722, gen p mean: -0.24014611542224884, mean p set: 0.4477926790714264
The modified gen p mean: 0.4462263584136963, gen p mean: -0.2418634295463562, mean p set: 0.4468037486076355
loss_pred:0.014395973645150661, decouple_loss:0.0017760639311745763
loss_pred:0.014583521522581577, decouple_loss:0.0018593715503811836
Iteration: 4075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794681668281555, gen p mean: -0.23288202285766602, mean p set: 0.44852498173713684
loss_pred:0.014610971324145794, decouple_loss:0.0017716956790536642
The modified gen p mean: 0.4475173354148865, gen p mean: -0.2316330522298813, mean p set: 0.4480930268764496The modified gen p mean: 0.4461459219455719, gen p mean: -0.23903623223304749, mean p set: 0.44667288661003113
loss_pred:0.014517844654619694, decouple_loss:0.0017810105346143246
loss_pred:0.014126901514828205, decouple_loss:0.0017838741187006235
Iteration: 4076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477284848690033, gen p mean: -0.24150370061397552, mean p set: 0.44830334186553955
loss_pred:0.01413564383983612, decouple_loss:0.0018461976433172822
The modified gen p mean: 0.44692263007164, gen p mean: -0.23359188437461853, mean p set: 0.4474954903125763
loss_pred:0.014836425893008709, decouple_loss:0.001771026523783803
The modified gen p mean: 0.4475804567337036, gen p mean: -0.23790490627288818, mean p set: 0.44810402393341064
loss_pred:0.014047359116375446, decouple_loss:0.0017872484168037772
Iteration: 4077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479947090148926, gen p mean: -0.23429720103740692, mean p set: 0.44857946038246155
loss_pred:0.013935607858002186, decouple_loss:0.0017263652989640832
The modified gen p mean: 0.44666585326194763, gen p mean: -0.23735997080802917, mean p set: 0.447241872549057
loss_pred:0.01467969547957182, decouple_loss:0.0018331222236156464
The modified gen p mean: 0.44662293791770935, gen p mean: -0.23279863595962524, mean p set: 0.4471621811389923
loss_pred:0.01422745268791914, decouple_loss:0.0018194859148934484
Iteration: 4078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472437798976898, gen p mean: -0.2371743768453598, mean p set: 0.447822630405426
loss_pred:0.014044097624719143, decouple_loss:0.001736912876367569
The modified gen p mean: 0.4473739266395569, gen p mean: -0.23174141347408295, mean p set: 0.4479508101940155
loss_pred:0.014534533955156803, decouple_loss:0.0017330738482996821
The modified gen p mean: 0.4482872188091278, gen p mean: -0.2327231466770172, mean p set: 0.4488171935081482
loss_pred:0.013971077278256416, decouple_loss:0.0017740405164659023
Iteration: 4079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459439516067505, gen p mean: -0.2319626361131668, mean p set: 0.44651728868484497
loss_pred:0.014106125570833683, decouple_loss:0.0017482609255239367
The modified gen p mean: 0.4465831220149994, gen p mean: -0.23433738946914673, mean p set: 0.44715774059295654
loss_pred:0.014100239612162113, decouple_loss:0.0017989989137277007
The modified gen p mean: 0.4472299814224243, gen p mean: -0.23988007009029388, mean p set: 0.44775745272636414
loss_pred:0.014232220128178596, decouple_loss:0.0018140549072995782
Iteration: 4080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855332374572754, gen p mean: -0.23243939876556396, mean p set: 0.4491317868232727
loss_pred:0.013832244090735912, decouple_loss:0.001724620582535863
The modified gen p mean: 0.4461670219898224, gen p mean: -0.2335885763168335, mean p set: 0.4467467665672302
loss_pred:0.01396901998668909, decouple_loss:0.0017411321168765426
The modified gen p mean: 0.4472971260547638, gen p mean: -0.23959937691688538, mean p set: 0.44781628251075745
loss_pred:0.014676805585622787, decouple_loss:0.0017577699618414044
2023-04-27 20:14:28 testing...
The modified gen p mean: 0.44822463393211365, gen p mean: -0.2290889322757721, mean p set: 0.44879910349845886
loss_pred:0.01549579855054617, decouple_loss:0.0017693804111331701
The modified gen p mean: 0.4492965340614319, gen p mean: -0.23208332061767578, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23136073350906372, mean p set: 0.4499112665653229
loss_pred:0.015146833844482899, decouple_loss:0.0018307098653167486
loss_pred:0.015562628395855427, decouple_loss:0.0018672270234674215
WV_1_PC_1_EH_0_PS_30, loss: 0.015492875128984451, avg_mse: 0.022890448570251465
current test mse: 0.02289
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 4081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481772184371948, gen p mean: -0.2295571267604828, mean p set: 0.44870471954345703
loss_pred:0.015143182128667831, decouple_loss:0.0017558535328134894
The modified gen p mean: 0.447523832321167, gen p mean: -0.23343873023986816, mean p set: 0.44810402393341064
The modified gen p mean: 0.4479350745677948, gen p mean: -0.2333524078130722, mean p set: 0.44850432872772217
loss_pred:0.014415976591408253, decouple_loss:0.0018213052535429597
loss_pred:0.014436183497309685, decouple_loss:0.0016856436850503087
Iteration: 4082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448198527097702, gen p mean: -0.22743262350559235, mean p set: 0.44872552156448364
loss_pred:0.014888114295899868, decouple_loss:0.0018294744659215212
The modified gen p mean: 0.44881296157836914, gen p mean: -0.2256394326686859, mean p set: 0.44938814640045166
The modified gen p mean: 0.4473675787448883, gen p mean: -0.22633391618728638, mean p set: 0.4479440450668335
loss_pred:0.01511916983872652, decouple_loss:0.0018052508821710944
loss_pred:0.014868655242025852, decouple_loss:0.001708956784568727
Iteration: 4083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816941022872925, gen p mean: -0.22915151715278625, mean p set: 0.44869464635849
loss_pred:0.014706436544656754, decouple_loss:0.0017395778559148312
The modified gen p mean: 0.4479641318321228, gen p mean: -0.22734872996807098, mean p set: 0.4485422670841217
The modified gen p mean: 0.44771361351013184, gen p mean: -0.22993050515651703, mean p set: 0.44829073548316956
loss_pred:0.01466282643377781, decouple_loss:0.0018501413287594914
loss_pred:0.015136122703552246, decouple_loss:0.0017959706019610167
Iteration: 4084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772058725357056, gen p mean: -0.23142895102500916, mean p set: 0.4482938349246979
loss_pred:0.014492608606815338, decouple_loss:0.0017627169145271182
The modified gen p mean: 0.44823312759399414, gen p mean: -0.22632060945034027, mean p set: 0.4487583637237549The modified gen p mean: 0.44788482785224915, gen p mean: -0.22588418424129486, mean p set: 0.44845762848854065
loss_pred:0.015010111033916473, decouple_loss:0.0017943760612979531
loss_pred:0.014199811033904552, decouple_loss:0.0017740617040544748
Iteration: 4085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781720638275146, gen p mean: -0.22599013149738312, mean p set: 0.44839873909950256
loss_pred:0.01498033944517374, decouple_loss:0.0016188427107408643
The modified gen p mean: 0.44731318950653076, gen p mean: -0.2247067093849182, mean p set: 0.4478871822357178
loss_pred:0.015307334251701832, decouple_loss:0.0016764448955655098
The modified gen p mean: 0.4482751488685608, gen p mean: -0.22865517437458038, mean p set: 0.4488029479980469
loss_pred:0.014425989240407944, decouple_loss:0.001726723974570632
Iteration: 4086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769299030303955, gen p mean: -0.22963811457157135, mean p set: 0.4482678174972534
loss_pred:0.014582310803234577, decouple_loss:0.001587756909430027
The modified gen p mean: 0.44687288999557495, gen p mean: -0.23184743523597717, mean p set: 0.44740280508995056The modified gen p mean: 0.4486284554004669, gen p mean: -0.2309497445821762, mean p set: 0.44920313358306885
loss_pred:0.014337945729494095, decouple_loss:0.0017477835062891245
loss_pred:0.014521936886012554, decouple_loss:0.0017483390402048826
Iteration: 4087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471415579319, gen p mean: -0.2332097291946411, mean p set: 0.447712779045105
loss_pred:0.014609609730541706, decouple_loss:0.0017086317529901862
The modified gen p mean: 0.446471631526947, gen p mean: -0.23304644227027893, mean p set: 0.4470512866973877
loss_pred:0.014569555409252644, decouple_loss:0.001536093303002417
The modified gen p mean: 0.44612327218055725, gen p mean: -0.23199407756328583, mean p set: 0.44664737582206726
loss_pred:0.014920319430530071, decouple_loss:0.0015537526924163103
Iteration: 4088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854217767715454, gen p mean: -0.22826632857322693, mean p set: 0.44911372661590576
loss_pred:0.014727214351296425, decouple_loss:0.0016482456121593714
The modified gen p mean: 0.4479711949825287, gen p mean: -0.22756370902061462, mean p set: 0.4485013484954834The modified gen p mean: 0.4481126666069031, gen p mean: -0.22602297365665436, mean p set: 0.4486865699291229
loss_pred:0.014581394381821156, decouple_loss:0.0015628451947122812
loss_pred:0.01489933766424656, decouple_loss:0.0017350625712424517
Iteration: 4089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466630220413208, gen p mean: -0.22524261474609375, mean p set: 0.44724538922309875
loss_pred:0.015111441724002361, decouple_loss:0.001743607921525836
The modified gen p mean: 0.44869527220726013, gen p mean: -0.22506266832351685, mean p set: 0.44927188754081726
loss_pred:0.01429379265755415, decouple_loss:0.0017621445003896952
The modified gen p mean: 0.44757595658302307, gen p mean: -0.22651515901088715, mean p set: 0.4481017291545868
loss_pred:0.014356306754052639, decouple_loss:0.0017449817387387156
Iteration: 4090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772112369537354, gen p mean: -0.22238034009933472, mean p set: 0.4483031630516052
loss_pred:0.014893470332026482, decouple_loss:0.0015721279196441174
The modified gen p mean: 0.4472678303718567, gen p mean: -0.22860999405384064, mean p set: 0.4478394687175751
loss_pred:0.01476895809173584, decouple_loss:0.001556970295496285
The modified gen p mean: 0.44786393642425537, gen p mean: -0.22745324671268463, mean p set: 0.4483935534954071
loss_pred:0.014278917573392391, decouple_loss:0.00157830654643476
2023-04-27 20:18:30 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22641824185848236, mean p set: 0.4499112665653229
loss_pred:0.015557423233985901, decouple_loss:0.0020463455002754927
The modified gen p mean: 0.4493040442466736, gen p mean: -0.22682827711105347, mean p set: 0.4498290419578552
loss_pred:0.0151223698630929, decouple_loss:0.0017333889845758677
The modified gen p mean: 0.4482190012931824, gen p mean: -0.2243124097585678, mean p set: 0.44879910349845886
loss_pred:0.01544005237519741, decouple_loss:0.0017925672000274062
WV_1_PC_1_EH_0_PS_30, loss: 0.015466153621673584, avg_mse: 0.022837752476334572
current test mse: 0.022838
Iteration: 4091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473170340061188, gen p mean: -0.2258797585964203, mean p set: 0.447892427444458
loss_pred:0.015004048123955727, decouple_loss:0.001647063298150897
The modified gen p mean: 0.44725802540779114, gen p mean: -0.22993981838226318, mean p set: 0.4477825164794922
loss_pred:0.0149989640340209, decouple_loss:0.0017312531126663089
The modified gen p mean: 0.44802847504615784, gen p mean: -0.22909727692604065, mean p set: 0.448603093624115
loss_pred:0.014732067473232746, decouple_loss:0.0018313700566068292
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480721950531006, gen p mean: -0.2292780727148056, mean p set: 0.4485968351364136
loss_pred:0.014844569377601147, decouple_loss:0.0017082963604480028
The modified gen p mean: 0.4481429159641266, gen p mean: -0.22928066551685333, mean p set: 0.44871973991394043
The modified gen p mean: 0.44691067934036255, gen p mean: -0.2309456765651703, mean p set: 0.44748347997665405
loss_pred:0.014860489405691624, decouple_loss:0.0017193600069731474
loss_pred:0.014588553458452225, decouple_loss:0.0016586208948865533
Iteration: 4093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728219509124756, gen p mean: -0.22508032619953156, mean p set: 0.44781461358070374
loss_pred:0.015087260864675045, decouple_loss:0.0017384564271196723
The modified gen p mean: 0.447860449552536, gen p mean: -0.22873201966285706, mean p set: 0.4484356641769409
The modified gen p mean: 0.4479115903377533, gen p mean: -0.22579003870487213, mean p set: 0.44848933815956116
loss_pred:0.014748399145901203, decouple_loss:0.001774193486198783
loss_pred:0.014145015738904476, decouple_loss:0.0018216079333797097
Iteration: 4094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448038250207901, gen p mean: -0.22655785083770752, mean p set: 0.44857192039489746
loss_pred:0.015049922280013561, decouple_loss:0.0017095390940085053
The modified gen p mean: 0.4477561116218567, gen p mean: -0.23026596009731293, mean p set: 0.4483374059200287
The modified gen p mean: 0.4476515054702759, gen p mean: -0.22562389075756073, mean p set: 0.44823122024536133
loss_pred:0.014327332377433777, decouple_loss:0.0017659289296716452
loss_pred:0.014772937633097172, decouple_loss:0.0016529358690604568
Iteration: 4095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742801785469055, gen p mean: -0.22739861905574799, mean p set: 0.44800689816474915
loss_pred:0.014603419229388237, decouple_loss:0.0017146676545962691
The modified gen p mean: 0.44774389266967773, gen p mean: -0.22690562903881073, mean p set: 0.44831034541130066
loss_pred:0.014931072480976582, decouple_loss:0.0017408693674951792
The modified gen p mean: 0.44873902201652527, gen p mean: -0.23106838762760162, mean p set: 0.4492678940296173
loss_pred:0.01422229502350092, decouple_loss:0.0017272792756557465
Iteration: 4096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478716254234314, gen p mean: -0.22566594183444977, mean p set: 0.4484493136405945
loss_pred:0.01419880986213684, decouple_loss:0.0018023971933871508
The modified gen p mean: 0.44811996817588806, gen p mean: -0.22744962573051453, mean p set: 0.44864511489868164The modified gen p mean: 0.4480697810649872, gen p mean: -0.22763606905937195, mean p set: 0.44864311814308167
loss_pred:0.01450733095407486, decouple_loss:0.0016158940270543098
loss_pred:0.014348767697811127, decouple_loss:0.0016835924470797181
Iteration: 4097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477393627166748, gen p mean: -0.23051416873931885, mean p set: 0.44831880927085876
loss_pred:0.014868457801640034, decouple_loss:0.0016831979155540466
The modified gen p mean: 0.4480566382408142, gen p mean: -0.23106598854064941, mean p set: 0.44858577847480774The modified gen p mean: 0.4473542273044586, gen p mean: -0.23161974549293518, mean p set: 0.4479339122772217
loss_pred:0.01475305575877428, decouple_loss:0.001608999096788466
loss_pred:0.014360652305185795, decouple_loss:0.0016956627368927002
Iteration: 4098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44627830386161804, gen p mean: -0.23546166718006134, mean p set: 0.44685330986976624
loss_pred:0.014565788209438324, decouple_loss:0.001611519604921341
The modified gen p mean: 0.4470517039299011, gen p mean: -0.22507555782794952, mean p set: 0.4476318955421448
loss_pred:0.015177007764577866, decouple_loss:0.001789222122170031
The modified gen p mean: 0.4484765827655792, gen p mean: -0.22853440046310425, mean p set: 0.4490111172199249
loss_pred:0.01405415590852499, decouple_loss:0.0016802824102342129
Iteration: 4099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477584958076477, gen p mean: -0.23008663952350616, mean p set: 0.4483359158039093
loss_pred:0.014459493570029736, decouple_loss:0.0016625637654215097
The modified gen p mean: 0.44826069474220276, gen p mean: -0.23248106241226196, mean p set: 0.44878846406936646The modified gen p mean: 0.44866201281547546, gen p mean: -0.23304219543933868, mean p set: 0.4492388963699341
loss_pred:0.014419835060834885, decouple_loss:0.0019531792495399714
loss_pred:0.01400348637253046, decouple_loss:0.0016627333825454116
Iteration: 4100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487861394882202, gen p mean: -0.2354368418455124, mean p set: 0.44936102628707886
loss_pred:0.013946554623544216, decouple_loss:0.0016728803748264909
The modified gen p mean: 0.4477645754814148, gen p mean: -0.23464930057525635, mean p set: 0.448335200548172
loss_pred:0.014226395636796951, decouple_loss:0.0016392217949032784
The modified gen p mean: 0.44698312878608704, gen p mean: -0.23744282126426697, mean p set: 0.4475124180316925
loss_pred:0.014690903946757317, decouple_loss:0.0015125410864129663
2023-04-27 20:21:54 testing...
The modified gen p mean: 0.44822967052459717, gen p mean: -0.2296905517578125, mean p set: 0.44879910349845886
loss_pred:0.015507085248827934, decouple_loss:0.0017610363429412246
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23206910490989685, mean p set: 0.4499112665653229
loss_pred:0.01550524216145277, decouple_loss:0.001759757986292243
The modified gen p mean: 0.4492938220500946, gen p mean: -0.2324943095445633, mean p set: 0.4498290419578552
loss_pred:0.015106981620192528, decouple_loss:0.0019228067249059677
WV_1_PC_1_EH_0_PS_30, loss: 0.015463830903172493, avg_mse: 0.022854086011648178
current test mse: 0.022854
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 4101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772225618362427, gen p mean: -0.2308776080608368, mean p set: 0.4482528567314148
loss_pred:0.013468245044350624, decouple_loss:0.0020124753937125206
The modified gen p mean: 0.4474025368690491, gen p mean: -0.23006890714168549, mean p set: 0.44798383116722107
The modified gen p mean: 0.44798004627227783, gen p mean: -0.23140282928943634, mean p set: 0.44856035709381104
loss_pred:0.015043793246150017, decouple_loss:0.0017755734734237194
loss_pred:0.013641715981066227, decouple_loss:0.0021038984414190054
Iteration: 4102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479786455631256, gen p mean: -0.2347385585308075, mean p set: 0.4485073983669281
loss_pred:0.01383720152080059, decouple_loss:0.0017809908604249358
The modified gen p mean: 0.44827428460121155, gen p mean: -0.22701241075992584, mean p set: 0.4488582909107208
loss_pred:0.014301900751888752, decouple_loss:0.0019502070499584079
The modified gen p mean: 0.4484994411468506, gen p mean: -0.22957371175289154, mean p set: 0.4490780532360077
loss_pred:0.013935452327132225, decouple_loss:0.0019594416953623295
Iteration: 4103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487267732620239, gen p mean: -0.22876109182834625, mean p set: 0.4492571949958801
loss_pred:0.013439418748021126, decouple_loss:0.0022603156976401806
The modified gen p mean: 0.4478662312030792, gen p mean: -0.2377166897058487, mean p set: 0.44844159483909607
loss_pred:0.013568779453635216, decouple_loss:0.0019695302471518517
The modified gen p mean: 0.4486285150051117, gen p mean: -0.23115259408950806, mean p set: 0.44921019673347473
loss_pred:0.01411941647529602, decouple_loss:0.0018491953378543258
Iteration: 4104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742557406425476, gen p mean: -0.22962583601474762, mean p set: 0.4479498863220215
loss_pred:0.013515324331820011, decouple_loss:0.0018861579010263085
The modified gen p mean: 0.44808319211006165, gen p mean: -0.23020553588867188, mean p set: 0.44865697622299194
loss_pred:0.013952399604022503, decouple_loss:0.0019154200563207269
The modified gen p mean: 0.4484274983406067, gen p mean: -0.22785869240760803, mean p set: 0.4489966928958893
loss_pred:0.014069082215428352, decouple_loss:0.001986887538805604
Iteration: 4105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841182231903076, gen p mean: -0.23786692321300507, mean p set: 0.4489799737930298
loss_pred:0.014065779745578766, decouple_loss:0.0017974594375118613
The modified gen p mean: 0.4472217559814453, gen p mean: -0.22448770701885223, mean p set: 0.4477945566177368
loss_pred:0.01401845645159483, decouple_loss:0.001897997921332717
The modified gen p mean: 0.44810909032821655, gen p mean: -0.23210172355175018, mean p set: 0.4486351013183594
loss_pred:0.013537091203033924, decouple_loss:0.0019113586749881506
Iteration: 4106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489681124687195, gen p mean: -0.22832518815994263, mean p set: 0.4495420455932617
loss_pred:0.013414793647825718, decouple_loss:0.0018452666699886322
The modified gen p mean: 0.447172075510025, gen p mean: -0.2239025980234146, mean p set: 0.4477514326572418The modified gen p mean: 0.44805237650871277, gen p mean: -0.23465874791145325, mean p set: 0.4485870599746704
loss_pred:0.014566995203495026, decouple_loss:0.0017064285930246115
loss_pred:0.013426605612039566, decouple_loss:0.0017080106772482395
Iteration: 4107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483996629714966, gen p mean: -0.2356196641921997, mean p set: 0.4489794969558716
loss_pred:0.013869195245206356, decouple_loss:0.0017051567556336522
The modified gen p mean: 0.4475768804550171, gen p mean: -0.2321406751871109, mean p set: 0.4481014907360077The modified gen p mean: 0.44726693630218506, gen p mean: -0.22945040464401245, mean p set: 0.44784215092658997
loss_pred:0.013535724021494389, decouple_loss:0.0017654226394370198
loss_pred:0.013655256479978561, decouple_loss:0.0018825113074854016
Iteration: 4108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485570192337036, gen p mean: -0.23600570857524872, mean p set: 0.449133038520813
loss_pred:0.014058469794690609, decouple_loss:0.0016963145462796092
The modified gen p mean: 0.4474222660064697, gen p mean: -0.23479461669921875, mean p set: 0.4479990005493164
loss_pred:0.013478696346282959, decouple_loss:0.0016145202098414302
The modified gen p mean: 0.4472506642341614, gen p mean: -0.23444810509681702, mean p set: 0.4477807283401489
loss_pred:0.014411254785954952, decouple_loss:0.0015860507264733315
Iteration: 4109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746455550193787, gen p mean: -0.23035219311714172, mean p set: 0.44803711771965027
loss_pred:0.014459153637290001, decouple_loss:0.0016694534569978714
The modified gen p mean: 0.44851940870285034, gen p mean: -0.2355528026819229, mean p set: 0.44905373454093933The modified gen p mean: 0.4482264220714569, gen p mean: -0.2386474758386612, mean p set: 0.4488038718700409
loss_pred:0.013429283164441586, decouple_loss:0.001558049931190908
loss_pred:0.014063009060919285, decouple_loss:0.001657161395996809
Iteration: 4110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763749837875366, gen p mean: -0.23734848201274872, mean p set: 0.4482114315032959
loss_pred:0.013441820628941059, decouple_loss:0.001588106737472117
The modified gen p mean: 0.44833654165267944, gen p mean: -0.2386644184589386, mean p set: 0.4489099383354187
loss_pred:0.01336456649005413, decouple_loss:0.0016386444913223386
The modified gen p mean: 0.4480744004249573, gen p mean: -0.23280702531337738, mean p set: 0.4486044645309448
loss_pred:0.013567092828452587, decouple_loss:0.0017485452117398381
2023-04-27 20:25:57 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23081247508525848, mean p set: 0.4499112665653229
loss_pred:0.015661606565117836, decouple_loss:0.001682029920630157
The modified gen p mean: 0.44929414987564087, gen p mean: -0.2310497760772705, mean p set: 0.4498290419578552
loss_pred:0.015237526968121529, decouple_loss:0.002115495502948761
The modified gen p mean: 0.448215514421463, gen p mean: -0.228551983833313, mean p set: 0.44879910349845886
loss_pred:0.015588236041367054, decouple_loss:0.001792581402696669
WV_1_PC_1_EH_0_PS_30, loss: 0.01558895967900753, avg_mse: 0.02308880165219307
current test mse: 0.023089
Iteration: 4111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480552077293396, gen p mean: -0.23168687522411346, mean p set: 0.4486263692378998
loss_pred:0.014170382171869278, decouple_loss:0.0017479084199294448
The modified gen p mean: 0.44704845547676086, gen p mean: -0.2355557084083557, mean p set: 0.4475710391998291
loss_pred:0.013437029905617237, decouple_loss:0.0016592927277088165
The modified gen p mean: 0.4478490948677063, gen p mean: -0.23726174235343933, mean p set: 0.44843214750289917
loss_pred:0.013612874783575535, decouple_loss:0.0015748419100418687
Iteration: 4112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481740891933441, gen p mean: -0.2326822429895401, mean p set: 0.4487045109272003
loss_pred:0.01364035252481699, decouple_loss:0.0017460506642237306
The modified gen p mean: 0.4478585720062256, gen p mean: -0.2292012721300125, mean p set: 0.4484385848045349
The modified gen p mean: 0.44651827216148376, gen p mean: -0.2340887486934662, mean p set: 0.4470933675765991
loss_pred:0.013329043053090572, decouple_loss:0.0018016641261056066
loss_pred:0.013916516676545143, decouple_loss:0.0016279843403026462
Iteration: 4113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472402036190033, gen p mean: -0.23542527854442596, mean p set: 0.44776979088783264
loss_pred:0.013460034504532814, decouple_loss:0.0015653336886316538
The modified gen p mean: 0.44736313819885254, gen p mean: -0.22959353029727936, mean p set: 0.44793590903282166
The modified gen p mean: 0.4475570321083069, gen p mean: -0.23261848092079163, mean p set: 0.44812890887260437
loss_pred:0.013721699826419353, decouple_loss:0.0015464802272617817
loss_pred:0.01402905024588108, decouple_loss:0.0017282068729400635
Iteration: 4114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731149077415466, gen p mean: -0.23444250226020813, mean p set: 0.44784268736839294
loss_pred:0.014706906862556934, decouple_loss:0.0017100755358114839
The modified gen p mean: 0.4482824206352234, gen p mean: -0.23479542136192322, mean p set: 0.4488556683063507
The modified gen p mean: 0.44715261459350586, gen p mean: -0.23631183803081512, mean p set: 0.44773516058921814
loss_pred:0.014012138359248638, decouple_loss:0.0017854300094768405
loss_pred:0.014367325231432915, decouple_loss:0.0016591146122664213
Iteration: 4115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447013258934021, gen p mean: -0.22891345620155334, mean p set: 0.44759488105773926
loss_pred:0.014190693385899067, decouple_loss:0.001718748826533556
The modified gen p mean: 0.449221134185791, gen p mean: -0.2281750738620758, mean p set: 0.4497953951358795The modified gen p mean: 0.44688791036605835, gen p mean: -0.23164965212345123, mean p set: 0.4474125802516937
loss_pred:0.013717704452574253, decouple_loss:0.0018980924505740404
loss_pred:0.013607818633317947, decouple_loss:0.001782438950613141
Iteration: 4116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893184304237366, gen p mean: -0.22622470557689667, mean p set: 0.4495067000389099
loss_pred:0.01276886835694313, decouple_loss:0.001958694774657488
The modified gen p mean: 0.4471081495285034, gen p mean: -0.22612875699996948, mean p set: 0.44763508439064026The modified gen p mean: 0.4482518434524536, gen p mean: -0.2331816405057907, mean p set: 0.4488280117511749
loss_pred:0.014047287404537201, decouple_loss:0.0016849790699779987
loss_pred:0.01346135139465332, decouple_loss:0.0017278959276154637
Iteration: 4117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482872188091278, gen p mean: -0.2375725358724594, mean p set: 0.4488692879676819
loss_pred:0.014058992266654968, decouple_loss:0.001636574394069612
The modified gen p mean: 0.44929075241088867, gen p mean: -0.22225964069366455, mean p set: 0.4498658776283264
loss_pred:0.013686778023838997, decouple_loss:0.0019437160808593035
The modified gen p mean: 0.44725531339645386, gen p mean: -0.22737959027290344, mean p set: 0.44777724146842957
loss_pred:0.014563496224582195, decouple_loss:0.0016660066321492195
Iteration: 4118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473625123500824, gen p mean: -0.23312120139598846, mean p set: 0.4479329288005829
loss_pred:0.013328124769032001, decouple_loss:0.0018062760354951024
The modified gen p mean: 0.44793251156806946, gen p mean: -0.2319459468126297, mean p set: 0.4485081434249878
loss_pred:0.013990562409162521, decouple_loss:0.001717357779853046
The modified gen p mean: 0.44841310381889343, gen p mean: -0.2359497994184494, mean p set: 0.44894084334373474
loss_pred:0.013717464171350002, decouple_loss:0.0017104782164096832
Iteration: 4119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802528619766235, gen p mean: -0.24008052051067352, mean p set: 0.44860297441482544
loss_pred:0.01336854137480259, decouple_loss:0.0016133927274495363
The modified gen p mean: 0.4482813775539398, gen p mean: -0.23385342955589294, mean p set: 0.4488586187362671
loss_pred:0.01365065947175026, decouple_loss:0.0016558212228119373
The modified gen p mean: 0.44772952795028687, gen p mean: -0.23363721370697021, mean p set: 0.44825834035873413
loss_pred:0.013773065991699696, decouple_loss:0.0016685305163264275
Iteration: 4120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475473463535309, gen p mean: -0.23743794858455658, mean p set: 0.44811877608299255
loss_pred:0.013532605953514576, decouple_loss:0.0019547624979168177
The modified gen p mean: 0.4471431076526642, gen p mean: -0.2329469919204712, mean p set: 0.44771671295166016
loss_pred:0.014169109053909779, decouple_loss:0.0020048171281814575
The modified gen p mean: 0.4476325809955597, gen p mean: -0.23313525319099426, mean p set: 0.44816192984580994
loss_pred:0.013325336389243603, decouple_loss:0.0019197501242160797
2023-04-27 20:29:22 testing...
The modified gen p mean: 0.44822463393211365, gen p mean: -0.2341640740633011, mean p set: 0.44879910349845886
loss_pred:0.015576941892504692, decouple_loss:0.0017984537407755852
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23637117445468903, mean p set: 0.4499112665653229
loss_pred:0.015724830329418182, decouple_loss:0.0018983616027981043
The modified gen p mean: 0.44930458068847656, gen p mean: -0.23680898547172546, mean p set: 0.4498290419578552
loss_pred:0.01526691298931837, decouple_loss:0.0019843413028866053
WV_1_PC_1_EH_0_PS_30, loss: 0.015617582015693188, avg_mse: 0.02311694622039795
current test mse: 0.023117
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 4121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706183671951294, gen p mean: -0.2345942109823227, mean p set: 0.44758522510528564
loss_pred:0.015050157904624939, decouple_loss:0.0017027216963469982
The modified gen p mean: 0.44737347960472107, gen p mean: -0.24006903171539307, mean p set: 0.447951078414917
loss_pred:0.014697419479489326, decouple_loss:0.0016399206360802054
The modified gen p mean: 0.445680171251297, gen p mean: -0.23642951250076294, mean p set: 0.44625577330589294
loss_pred:0.014662180095911026, decouple_loss:0.0017933889757841825
Iteration: 4122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457761347293854, gen p mean: -0.23529888689517975, mean p set: 0.44630563259124756
loss_pred:0.014217302203178406, decouple_loss:0.0019546321127563715
The modified gen p mean: 0.4472324252128601, gen p mean: -0.2451489120721817, mean p set: 0.4478095471858978The modified gen p mean: 0.44800883531570435, gen p mean: -0.2377525269985199, mean p set: 0.44858697056770325
loss_pred:0.014539520256221294, decouple_loss:0.0020232542883604765
loss_pred:0.014587721787393093, decouple_loss:0.002249167999252677
Iteration: 4123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44659093022346497, gen p mean: -0.23240482807159424, mean p set: 0.44712045788764954
loss_pred:0.014421180821955204, decouple_loss:0.0017075013602152467
The modified gen p mean: 0.44615450501441956, gen p mean: -0.23258498311042786, mean p set: 0.44673389196395874
The modified gen p mean: 0.4474988579750061, gen p mean: -0.23557694256305695, mean p set: 0.448073148727417
loss_pred:0.014263716526329517, decouple_loss:0.0018949257209897041
loss_pred:0.01458286214619875, decouple_loss:0.0018951109377667308
Iteration: 4124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755443930625916, gen p mean: -0.23353245854377747, mean p set: 0.44808098673820496
loss_pred:0.014786197803914547, decouple_loss:0.0021359191741794348
The modified gen p mean: 0.4463115334510803, gen p mean: -0.23520004749298096, mean p set: 0.44689324498176575The modified gen p mean: 0.44559216499328613, gen p mean: -0.2376084178686142, mean p set: 0.4461652636528015
loss_pred:0.015100887045264244, decouple_loss:0.0023210446815937757
loss_pred:0.014735588803887367, decouple_loss:0.0020849029533565044
Iteration: 4125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461668133735657, gen p mean: -0.23156459629535675, mean p set: 0.4467402696609497
loss_pred:0.015120546333491802, decouple_loss:0.001726922462694347
The modified gen p mean: 0.44810807704925537, gen p mean: -0.23377348482608795, mean p set: 0.44868341088294983
loss_pred:0.014511693269014359, decouple_loss:0.00176587188616395
The modified gen p mean: 0.44657137989997864, gen p mean: -0.23915687203407288, mean p set: 0.4471011161804199
loss_pred:0.014720086939632893, decouple_loss:0.0017428359715268016
Iteration: 4126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44618409872055054, gen p mean: -0.2347630113363266, mean p set: 0.44675159454345703
loss_pred:0.014434201642870903, decouple_loss:0.0018964126938953996
The modified gen p mean: 0.4469541907310486, gen p mean: -0.23755478858947754, mean p set: 0.44752782583236694
loss_pred:0.014733913354575634, decouple_loss:0.0018746526911854744
The modified gen p mean: 0.4468686878681183, gen p mean: -0.2356591820716858, mean p set: 0.4473998546600342
loss_pred:0.014014994725584984, decouple_loss:0.0018674921011552215
Iteration: 4127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479064643383026, gen p mean: -0.24006585776805878, mean p set: 0.448486864566803
loss_pred:0.01471701730042696, decouple_loss:0.0016331995138898492
The modified gen p mean: 0.4467869699001312, gen p mean: -0.2394229769706726, mean p set: 0.4473665952682495
loss_pred:0.014594651758670807, decouple_loss:0.0016258545219898224
The modified gen p mean: 0.44854536652565, gen p mean: -0.24130627512931824, mean p set: 0.44907623529434204
loss_pred:0.015016158111393452, decouple_loss:0.0019072259310632944
Iteration: 4128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667744636535645, gen p mean: -0.23829197883605957, mean p set: 0.44725558161735535
loss_pred:0.014447731897234917, decouple_loss:0.0018615333829075098
The modified gen p mean: 0.4461614489555359, gen p mean: -0.23676782846450806, mean p set: 0.44668781757354736
loss_pred:0.015000497922301292, decouple_loss:0.0018685690592974424
The modified gen p mean: 0.4459363520145416, gen p mean: -0.23544606566429138, mean p set: 0.44651132822036743
loss_pred:0.015242265537381172, decouple_loss:0.0019624209962785244
Iteration: 4129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473690986633301, gen p mean: -0.24421535432338715, mean p set: 0.44794052839279175
loss_pred:0.014247697778046131, decouple_loss:0.001639162190258503
The modified gen p mean: 0.4463551342487335, gen p mean: -0.23591205477714539, mean p set: 0.4469289183616638
loss_pred:0.01428342517465353, decouple_loss:0.0018011867068707943
The modified gen p mean: 0.4459480345249176, gen p mean: -0.23065657913684845, mean p set: 0.44647401571273804
loss_pred:0.014577317982912064, decouple_loss:0.001911665196530521
Iteration: 4130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484787583351135, gen p mean: -0.23691290616989136, mean p set: 0.4490543007850647The modified gen p mean: 0.4472486674785614, gen p mean: -0.23260529339313507, mean p set: 0.44782623648643494
loss_pred:0.01475743018090725, decouple_loss:0.0019417940638959408
loss_pred:0.014270843006670475, decouple_loss:0.0017285015201196074
The modified gen p mean: 0.4479166865348816, gen p mean: -0.236466184258461, mean p set: 0.4484470784664154
loss_pred:0.01446794718503952, decouple_loss:0.0016826374921947718
2023-04-27 20:33:24 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23725058138370514, mean p set: 0.4499112665653229
loss_pred:0.01563630811870098, decouple_loss:0.0017762304050847888
The modified gen p mean: 0.44930312037467957, gen p mean: -0.23764240741729736, mean p set: 0.4498290419578552
loss_pred:0.015114842914044857, decouple_loss:0.0017052368493750691
The modified gen p mean: 0.4482201933860779, gen p mean: -0.23486757278442383, mean p set: 0.44879910349845886
loss_pred:0.015470544807612896, decouple_loss:0.0017700649332255125
WV_1_PC_1_EH_0_PS_30, loss: 0.015494758263230324, avg_mse: 0.02291259914636612
current test mse: 0.022913
Iteration: 4131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808852672576904, gen p mean: -0.24091194570064545, mean p set: 0.4486584961414337
loss_pred:0.014321847818791866, decouple_loss:0.001741103595122695
The modified gen p mean: 0.4466681480407715, gen p mean: -0.23881039023399353, mean p set: 0.4471926689147949
loss_pred:0.01451640110462904, decouple_loss:0.0019034427823498845
The modified gen p mean: 0.4460464417934418, gen p mean: -0.23359417915344238, mean p set: 0.4466271698474884
loss_pred:0.014308933168649673, decouple_loss:0.001781099010258913
Iteration: 4132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44520115852355957, gen p mean: -0.25180912017822266, mean p set: 0.44573795795440674
loss_pred:0.014378460124135017, decouple_loss:0.0017250479431822896
The modified gen p mean: 0.4462308883666992, gen p mean: -0.24252618849277496, mean p set: 0.44680535793304443The modified gen p mean: 0.4452008306980133, gen p mean: -0.2511023283004761, mean p set: 0.4457697868347168
loss_pred:0.014050586149096489, decouple_loss:0.0017041924875229597
loss_pred:0.014517237432301044, decouple_loss:0.0018109348602592945
Iteration: 4133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457818865776062, gen p mean: -0.23957912623882294, mean p set: 0.44630685448646545
loss_pred:0.0146463792771101, decouple_loss:0.0018929546931758523
The modified gen p mean: 0.4477103054523468, gen p mean: -0.24491041898727417, mean p set: 0.4482913017272949
The modified gen p mean: 0.4486978054046631, gen p mean: -0.2475498765707016, mean p set: 0.44927704334259033
loss_pred:0.014188011176884174, decouple_loss:0.0018266080878674984
loss_pred:0.014414704404771328, decouple_loss:0.0019759300630539656
Iteration: 4134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473961889743805, gen p mean: -0.24963247776031494, mean p set: 0.4479255974292755
loss_pred:0.01469545066356659, decouple_loss:0.0018032259540632367
The modified gen p mean: 0.4462156891822815, gen p mean: -0.24675971269607544, mean p set: 0.4467838406562805
The modified gen p mean: 0.4458460807800293, gen p mean: -0.24635092914104462, mean p set: 0.4464118480682373
loss_pred:0.014225587248802185, decouple_loss:0.0017852167366072536
loss_pred:0.015042654238641262, decouple_loss:0.0017675727140158415
Iteration: 4135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463827610015869, gen p mean: -0.24906310439109802, mean p set: 0.44695523381233215
loss_pred:0.014643864706158638, decouple_loss:0.0020059561356902122
The modified gen p mean: 0.44873902201652527, gen p mean: -0.25209301710128784, mean p set: 0.44931700825691223
loss_pred:0.014936632476747036, decouple_loss:0.0019771656952798367
The modified gen p mean: 0.4472154378890991, gen p mean: -0.2531617283821106, mean p set: 0.4477439522743225
loss_pred:0.014450310729444027, decouple_loss:0.001744018867611885
Iteration: 4136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472520351409912, gen p mean: -0.24740076065063477, mean p set: 0.4478280544281006
loss_pred:0.015258939936757088, decouple_loss:0.0021331196185201406
The modified gen p mean: 0.4482617676258087, gen p mean: -0.24522997438907623, mean p set: 0.4487825632095337The modified gen p mean: 0.44741711020469666, gen p mean: -0.25062644481658936, mean p set: 0.44799599051475525
loss_pred:0.014765636064112186, decouple_loss:0.0017054843483492732
loss_pred:0.015288930386304855, decouple_loss:0.002024751389399171
Iteration: 4137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460122585296631, gen p mean: -0.24488301575183868, mean p set: 0.4465752840042114
loss_pred:0.01602211408317089, decouple_loss:0.002014074707403779
The modified gen p mean: 0.44673028588294983, gen p mean: -0.25325727462768555, mean p set: 0.4473038911819458
loss_pred:0.015268916264176369, decouple_loss:0.0019468821119517088
The modified gen p mean: 0.4464240074157715, gen p mean: -0.24727928638458252, mean p set: 0.44694921374320984
loss_pred:0.015646617859601974, decouple_loss:0.0020234216935932636
Iteration: 4138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44659650325775146, gen p mean: -0.2511921525001526, mean p set: 0.4471711814403534
loss_pred:0.014959922060370445, decouple_loss:0.002213244093582034
The modified gen p mean: 0.44712188839912415, gen p mean: -0.24817726016044617, mean p set: 0.4476941227912903
loss_pred:0.01510903425514698, decouple_loss:0.0021801323164254427
The modified gen p mean: 0.44682708382606506, gen p mean: -0.24859900772571564, mean p set: 0.4473566710948944
loss_pred:0.014639165252447128, decouple_loss:0.002240101108327508
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466678202152252, gen p mean: -0.239700049161911, mean p set: 0.447246253490448
loss_pred:0.014434881508350372, decouple_loss:0.0020427186973392963
The modified gen p mean: 0.44807666540145874, gen p mean: -0.24453382194042206, mean p set: 0.44865259528160095
loss_pred:0.014706569723784924, decouple_loss:0.002099432051181793
The modified gen p mean: 0.44562992453575134, gen p mean: -0.24833032488822937, mean p set: 0.4461599588394165
loss_pred:0.015345384366810322, decouple_loss:0.0022211994510143995
Iteration: 4140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489497244358063, gen p mean: -0.2438919097185135, mean p set: 0.44952791929244995
loss_pred:0.014622300863265991, decouple_loss:0.002018412807956338
The modified gen p mean: 0.4465892016887665, gen p mean: -0.2424456924200058, mean p set: 0.44715940952301025
loss_pred:0.01511931512504816, decouple_loss:0.0018700442742556334
The modified gen p mean: 0.4473433196544647, gen p mean: -0.2361735999584198, mean p set: 0.44787678122520447
loss_pred:0.015107731334865093, decouple_loss:0.002026034751906991
2023-04-27 20:36:49 testing...
The modified gen p mean: 0.4482227563858032, gen p mean: -0.24411147832870483, mean p set: 0.44879910349845886
loss_pred:0.015866700559854507, decouple_loss:0.002162637421861291
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24631741642951965, mean p set: 0.4499112665653229
loss_pred:0.016066256910562515, decouple_loss:0.0022103607188910246
The modified gen p mean: 0.4493009150028229, gen p mean: -0.24663735926151276, mean p set: 0.4498290419578552
loss_pred:0.0155619652941823, decouple_loss:0.002231801627203822
WV_1_PC_1_EH_0_PS_30, loss: 0.015941722318530083, avg_mse: 0.02361515909433365
current test mse: 0.023615
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 4141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471299648284912, gen p mean: -0.24334415793418884, mean p set: 0.4476620554924011
loss_pred:0.014702127315104008, decouple_loss:0.0024905672762542963
The modified gen p mean: 0.4476839005947113, gen p mean: -0.24387021362781525, mean p set: 0.4482576549053192
loss_pred:0.0146721713244915, decouple_loss:0.0026041753590106964
The modified gen p mean: 0.44823339581489563, gen p mean: -0.2507927119731903, mean p set: 0.44880568981170654
loss_pred:0.014391092583537102, decouple_loss:0.0025330085773020983
Iteration: 4142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464041590690613, gen p mean: -0.2508421242237091, mean p set: 0.4469318985939026
loss_pred:0.015407564118504524, decouple_loss:0.0022561252117156982
The modified gen p mean: 0.44802820682525635, gen p mean: -0.2483084797859192, mean p set: 0.4486024081707001
loss_pred:0.014347169548273087, decouple_loss:0.00202234648168087
The modified gen p mean: 0.447426438331604, gen p mean: -0.24839605391025543, mean p set: 0.44800183176994324
loss_pred:0.014542090706527233, decouple_loss:0.002070234389975667
Iteration: 4143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479854702949524, gen p mean: -0.24690859019756317, mean p set: 0.4485197067260742
loss_pred:0.014145798981189728, decouple_loss:0.0028503891080617905
The modified gen p mean: 0.4476616382598877, gen p mean: -0.2486017644405365, mean p set: 0.4482389986515045
loss_pred:0.014358306303620338, decouple_loss:0.0026789929252117872
The modified gen p mean: 0.44732001423835754, gen p mean: -0.24935638904571533, mean p set: 0.44789108633995056
loss_pred:0.014801028184592724, decouple_loss:0.003028381383046508
Iteration: 4144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471759498119354, gen p mean: -0.2452763170003891, mean p set: 0.4477013349533081
loss_pred:0.014674507081508636, decouple_loss:0.002218464855104685
The modified gen p mean: 0.44657617807388306, gen p mean: -0.23745834827423096, mean p set: 0.4471501410007477
loss_pred:0.014519722200930119, decouple_loss:0.002071826718747616
The modified gen p mean: 0.4471293091773987, gen p mean: -0.2383749932050705, mean p set: 0.4477090537548065
loss_pred:0.014204191043972969, decouple_loss:0.001957662170752883
Iteration: 4145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712403416633606, gen p mean: -0.23709899187088013, mean p set: 0.44770386815071106
loss_pred:0.014420178718864918, decouple_loss:0.002241954207420349
The modified gen p mean: 0.4483316242694855, gen p mean: -0.23941905796527863, mean p set: 0.448910653591156
loss_pred:0.013678940013051033, decouple_loss:0.0022276081144809723
The modified gen p mean: 0.448082834482193, gen p mean: -0.2397809475660324, mean p set: 0.44860947132110596
loss_pred:0.01409421768039465, decouple_loss:0.002428222680464387
Iteration: 4146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663599133491516, gen p mean: -0.24106056988239288, mean p set: 0.4472118318080902
loss_pred:0.014251094311475754, decouple_loss:0.002249140990898013
The modified gen p mean: 0.4479149580001831, gen p mean: -0.24012382328510284, mean p set: 0.448486864566803
loss_pred:0.014056588523089886, decouple_loss:0.0021119206212460995
The modified gen p mean: 0.44722995162010193, gen p mean: -0.2375800907611847, mean p set: 0.4477570950984955
loss_pred:0.014477046206593513, decouple_loss:0.002380211604759097
Iteration: 4147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680869579315186, gen p mean: -0.23993369936943054, mean p set: 0.4473787844181061
loss_pred:0.014428144320845604, decouple_loss:0.002142135286703706
The modified gen p mean: 0.448173850774765, gen p mean: -0.2486015260219574, mean p set: 0.4487426280975342
loss_pred:0.014394016936421394, decouple_loss:0.002068399917334318
The modified gen p mean: 0.4479067623615265, gen p mean: -0.24615341424942017, mean p set: 0.448443204164505
loss_pred:0.013937626965343952, decouple_loss:0.0019994634203612804
Iteration: 4148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465503692626953, gen p mean: -0.2471892088651657, mean p set: 0.4471273422241211
loss_pred:0.014720396138727665, decouple_loss:0.0022598684299737215
The modified gen p mean: 0.4477233588695526, gen p mean: -0.2457272857427597, mean p set: 0.448304146528244
loss_pred:0.014246031641960144, decouple_loss:0.0022739421110600233
The modified gen p mean: 0.4473026692867279, gen p mean: -0.24739216268062592, mean p set: 0.44783034920692444
loss_pred:0.014239909127354622, decouple_loss:0.002157077193260193
Iteration: 4149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477252662181854, gen p mean: -0.2380570024251938, mean p set: 0.44830429553985596
loss_pred:0.013854635879397392, decouple_loss:0.002041056053712964
The modified gen p mean: 0.44684627652168274, gen p mean: -0.2382311075925827, mean p set: 0.447422593832016
loss_pred:0.014224590733647346, decouple_loss:0.0020596429239958525
The modified gen p mean: 0.4471573531627655, gen p mean: -0.24001021683216095, mean p set: 0.44768473505973816
loss_pred:0.014367188327014446, decouple_loss:0.0020434523466974497
Iteration: 4150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480300545692444, gen p mean: -0.23685182631015778, mean p set: 0.4486064314842224
loss_pred:0.013791270554065704, decouple_loss:0.002076604636386037
The modified gen p mean: 0.4470769464969635, gen p mean: -0.239511638879776, mean p set: 0.4476523995399475
loss_pred:0.014466207474470139, decouple_loss:0.002154269255697727
The modified gen p mean: 0.4468066394329071, gen p mean: -0.23949208855628967, mean p set: 0.4473388195037842
loss_pred:0.014011693187057972, decouple_loss:0.0021506305783987045
2023-04-27 20:40:52 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2339470386505127, mean p set: 0.4499112665653229
loss_pred:0.01603223942220211, decouple_loss:0.0020016608759760857
The modified gen p mean: 0.44930383563041687, gen p mean: -0.23369741439819336, mean p set: 0.4498290419578552
loss_pred:0.015405070036649704, decouple_loss:0.002213762141764164
The modified gen p mean: 0.4482184946537018, gen p mean: -0.23131872713565826, mean p set: 0.44879910349845886
loss_pred:0.015798622742295265, decouple_loss:0.002033298835158348
WV_1_PC_1_EH_0_PS_30, loss: 0.015849456191062927, avg_mse: 0.02348615601658821
current test mse: 0.023486
Iteration: 4151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446805477142334, gen p mean: -0.23677195608615875, mean p set: 0.44737890362739563
loss_pred:0.014205592684447765, decouple_loss:0.002003215719014406
The modified gen p mean: 0.44839900732040405, gen p mean: -0.23339112102985382, mean p set: 0.44897186756134033
loss_pred:0.013861235231161118, decouple_loss:0.00226842169649899
The modified gen p mean: 0.448790967464447, gen p mean: -0.2310912013053894, mean p set: 0.449325829744339
loss_pred:0.013164558447897434, decouple_loss:0.0020897546783089638
Iteration: 4152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871780276298523, gen p mean: -0.23472782969474792, mean p set: 0.44924864172935486
loss_pred:0.013192325830459595, decouple_loss:0.0020168395712971687
The modified gen p mean: 0.4479861259460449, gen p mean: -0.23774132132530212, mean p set: 0.4485662877559662The modified gen p mean: 0.44808322191238403, gen p mean: -0.2303033322095871, mean p set: 0.44866064190864563
loss_pred:0.013906811363995075, decouple_loss:0.001934519037604332
loss_pred:0.01415121741592884, decouple_loss:0.0020711554680019617
Iteration: 4153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758784770965576, gen p mean: -0.23922836780548096, mean p set: 0.4481172263622284
loss_pred:0.014379789121448994, decouple_loss:0.00201006093993783
The modified gen p mean: 0.4483935236930847, gen p mean: -0.23615126311779022, mean p set: 0.44896969199180603The modified gen p mean: 0.44848158955574036, gen p mean: -0.23661896586418152, mean p set: 0.4490576982498169
loss_pred:0.014006942510604858, decouple_loss:0.0019508484983816743
loss_pred:0.013438568450510502, decouple_loss:0.0018496268894523382
Iteration: 4154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653069972991943, gen p mean: -0.23633809387683868, mean p set: 0.4470519721508026
loss_pred:0.014140024781227112, decouple_loss:0.001735558151267469
The modified gen p mean: 0.44737154245376587, gen p mean: -0.23611558973789215, mean p set: 0.44794946908950806The modified gen p mean: 0.4483078122138977, gen p mean: -0.23225784301757812, mean p set: 0.44888588786125183
loss_pred:0.013903563842177391, decouple_loss:0.0019291355274617672
loss_pred:0.01368886698037386, decouple_loss:0.0018663761438801885
Iteration: 4155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713613390922546, gen p mean: -0.23847359418869019, mean p set: 0.4477039873600006
loss_pred:0.013481128960847855, decouple_loss:0.002040382707491517
The modified gen p mean: 0.4474197328090668, gen p mean: -0.23841197788715363, mean p set: 0.4479982852935791
loss_pred:0.013658321462571621, decouple_loss:0.0019529372220858932
The modified gen p mean: 0.44705930352211, gen p mean: -0.24134255945682526, mean p set: 0.44758692383766174
loss_pred:0.01480779703706503, decouple_loss:0.0020272370893508196
Iteration: 4156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472595751285553, gen p mean: -0.23435208201408386, mean p set: 0.4478378891944885
loss_pred:0.013818608596920967, decouple_loss:0.0020313740242272615
The modified gen p mean: 0.44701576232910156, gen p mean: -0.238054558634758, mean p set: 0.44759440422058105
loss_pred:0.013841004110872746, decouple_loss:0.001971942139789462
The modified gen p mean: 0.4470983147621155, gen p mean: -0.23304571211338043, mean p set: 0.44762441515922546
loss_pred:0.013825788162648678, decouple_loss:0.002133798785507679
Iteration: 4157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476211667060852, gen p mean: -0.23248369991779327, mean p set: 0.4481918513774872
loss_pred:0.013775276020169258, decouple_loss:0.001867783721536398
The modified gen p mean: 0.4490807354450226, gen p mean: -0.22906513512134552, mean p set: 0.44966015219688416
loss_pred:0.013403569348156452, decouple_loss:0.0021944278851151466
The modified gen p mean: 0.44785720109939575, gen p mean: -0.23756055533885956, mean p set: 0.4483886957168579
loss_pred:0.0139344222843647, decouple_loss:0.0019098770571872592
Iteration: 4158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742774963378906, gen p mean: -0.23753327131271362, mean p set: 0.44800394773483276
loss_pred:0.014152832329273224, decouple_loss:0.0019453949062153697
The modified gen p mean: 0.44706347584724426, gen p mean: -0.2358524352312088, mean p set: 0.4476398825645447
loss_pred:0.014210838824510574, decouple_loss:0.001810939167626202
The modified gen p mean: 0.4481634199619293, gen p mean: -0.23479877412319183, mean p set: 0.44869139790534973
loss_pred:0.013580894097685814, decouple_loss:0.0019024524372071028
Iteration: 4159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447734534740448, gen p mean: -0.23471811413764954, mean p set: 0.44830334186553955
loss_pred:0.014364739879965782, decouple_loss:0.001954037928953767
The modified gen p mean: 0.44856736063957214, gen p mean: -0.23527905344963074, mean p set: 0.4491487443447113
loss_pred:0.013467014767229557, decouple_loss:0.001846094848588109
The modified gen p mean: 0.4480060040950775, gen p mean: -0.23976801335811615, mean p set: 0.44853144884109497
loss_pred:0.013817030936479568, decouple_loss:0.0019077033502981067
Iteration: 4160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469001293182373, gen p mean: -0.23109404742717743, mean p set: 0.4474763870239258
loss_pred:0.014127570204436779, decouple_loss:0.002005210844799876
The modified gen p mean: 0.44751209020614624, gen p mean: -0.2334900051355362, mean p set: 0.448081910610199
loss_pred:0.01450157817453146, decouple_loss:0.0018688314594328403
The modified gen p mean: 0.44888749718666077, gen p mean: -0.23247644305229187, mean p set: 0.44941452145576477
loss_pred:0.013956613838672638, decouple_loss:0.0019069481641054153
2023-04-27 20:44:16 testing...
The modified gen p mean: 0.44822508096694946, gen p mean: -0.22853533923625946, mean p set: 0.44879910349845886
loss_pred:0.015729282051324844, decouple_loss:0.0018576191505417228
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2312697321176529, mean p set: 0.4499112665653229
loss_pred:0.015962259843945503, decouple_loss:0.0018542647594586015
The modified gen p mean: 0.44930002093315125, gen p mean: -0.23106667399406433, mean p set: 0.4498290419578552
loss_pred:0.015306117944419384, decouple_loss:0.0020448241848498583
WV_1_PC_1_EH_0_PS_30, loss: 0.015761833637952805, avg_mse: 0.023337481543421745
current test mse: 0.023337
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 4161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672849774360657, gen p mean: -0.23226909339427948, mean p set: 0.44725507497787476
loss_pred:0.014627073891460896, decouple_loss:0.00208537676371634
The modified gen p mean: 0.4472901225090027, gen p mean: -0.2279006391763687, mean p set: 0.4478640854358673
loss_pred:0.013935761526226997, decouple_loss:0.0017811639700084925
The modified gen p mean: 0.4480639398097992, gen p mean: -0.2331707924604416, mean p set: 0.4486413896083832
loss_pred:0.014138523489236832, decouple_loss:0.0019113661255687475
Iteration: 4162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458526372909546, gen p mean: -0.2349054515361786, mean p set: 0.44638389348983765
loss_pred:0.013691283762454987, decouple_loss:0.0019039858598262072
The modified gen p mean: 0.4474009871482849, gen p mean: -0.23103581368923187, mean p set: 0.44797828793525696The modified gen p mean: 0.446664959192276, gen p mean: -0.23167730867862701, mean p set: 0.44724181294441223
loss_pred:0.014914029277861118, decouple_loss:0.0020091524347662926
loss_pred:0.014225098304450512, decouple_loss:0.0020940720569342375
Iteration: 4163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751182198524475, gen p mean: -0.22705811262130737, mean p set: 0.44803258776664734
loss_pred:0.01422917377203703, decouple_loss:0.002188917715102434
The modified gen p mean: 0.4475475549697876, gen p mean: -0.2342870980501175, mean p set: 0.44812464714050293
loss_pred:0.014521591365337372, decouple_loss:0.0018935305997729301
The modified gen p mean: 0.4481343626976013, gen p mean: -0.22873666882514954, mean p set: 0.4487118422985077
loss_pred:0.014109747484326363, decouple_loss:0.001816177275031805
Iteration: 4164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789719581604004, gen p mean: -0.2337689995765686, mean p set: 0.44841933250427246
loss_pred:0.015174592845141888, decouple_loss:0.0019284812733530998
The modified gen p mean: 0.4476401209831238, gen p mean: -0.23303009569644928, mean p set: 0.4482135772705078
loss_pred:0.014382881112396717, decouple_loss:0.0019631516188383102
The modified gen p mean: 0.4465276002883911, gen p mean: -0.2333778589963913, mean p set: 0.44709837436676025
loss_pred:0.015051190741360188, decouple_loss:0.0021947429049760103
Iteration: 4165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477037489414215, gen p mean: -0.22705020010471344, mean p set: 0.4482816159725189
loss_pred:0.014507206156849861, decouple_loss:0.0019286333117634058
The modified gen p mean: 0.4472580552101135, gen p mean: -0.23396249115467072, mean p set: 0.4477818012237549The modified gen p mean: 0.4468870759010315, gen p mean: -0.23408813774585724, mean p set: 0.44746458530426025
loss_pred:0.014389216899871826, decouple_loss:0.0018738873768597841
loss_pred:0.014173927716910839, decouple_loss:0.0018913624808192253
Iteration: 4166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715189933776855, gen p mean: -0.23008520901203156, mean p set: 0.4477280378341675
loss_pred:0.0145265506580472, decouple_loss:0.0017660764278843999
The modified gen p mean: 0.44797956943511963, gen p mean: -0.23685091733932495, mean p set: 0.4485515058040619
loss_pred:0.015023279003798962, decouple_loss:0.0016792085953056812
The modified gen p mean: 0.44763651490211487, gen p mean: -0.23245100677013397, mean p set: 0.44816744327545166
loss_pred:0.01477675512433052, decouple_loss:0.0018026866018772125
Iteration: 4167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44585731625556946, gen p mean: -0.23646579682826996, mean p set: 0.44642776250839233
loss_pred:0.01437502820044756, decouple_loss:0.0020716588478535414
The modified gen p mean: 0.4462546110153198, gen p mean: -0.23512528836727142, mean p set: 0.4468306601047516
loss_pred:0.013501649722456932, decouple_loss:0.002021056367084384
The modified gen p mean: 0.4472847878932953, gen p mean: -0.23481139540672302, mean p set: 0.4478125274181366
loss_pred:0.014090899378061295, decouple_loss:0.001941566588357091
Iteration: 4168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740036129951477, gen p mean: -0.2369295209646225, mean p set: 0.44797375798225403
loss_pred:0.015331592410802841, decouple_loss:0.0017443842953070998
The modified gen p mean: 0.44762200117111206, gen p mean: -0.23462119698524475, mean p set: 0.4481956660747528
loss_pred:0.014545982703566551, decouple_loss:0.0016600051894783974
The modified gen p mean: 0.447030246257782, gen p mean: -0.23915903270244598, mean p set: 0.44756636023521423
loss_pred:0.014453446492552757, decouple_loss:0.0017567129107192159
Iteration: 4169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737350940704346, gen p mean: -0.23443128168582916, mean p set: 0.4479471743106842
loss_pred:0.014710645191371441, decouple_loss:0.00178429763764143
The modified gen p mean: 0.4483087956905365, gen p mean: -0.2341436743736267, mean p set: 0.44888749718666077
loss_pred:0.013832860626280308, decouple_loss:0.00169901002664119
The modified gen p mean: 0.44804710149765015, gen p mean: -0.232868492603302, mean p set: 0.4485739767551422
loss_pred:0.014174473471939564, decouple_loss:0.0016289232298731804
Iteration: 4170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476919174194336, gen p mean: -0.23137527704238892, mean p set: 0.44827502965927124
loss_pred:0.014427326619625092, decouple_loss:0.0017655958654358983
The modified gen p mean: 0.4476329982280731, gen p mean: -0.23711968958377838, mean p set: 0.44820475578308105
loss_pred:0.01468910463154316, decouple_loss:0.001801375998184085
The modified gen p mean: 0.4475599229335785, gen p mean: -0.22956839203834534, mean p set: 0.44809025526046753
loss_pred:0.01429469883441925, decouple_loss:0.0015685466350987554
2023-04-27 20:48:21 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22991831600666046, mean p set: 0.4499112665653229
loss_pred:0.01576455682516098, decouple_loss:0.0019305358873680234
The modified gen p mean: 0.44930407404899597, gen p mean: -0.2301873117685318, mean p set: 0.4498290419578552
loss_pred:0.015189182944595814, decouple_loss:0.002043730579316616
The modified gen p mean: 0.448222279548645, gen p mean: -0.2278227061033249, mean p set: 0.44879910349845886
loss_pred:0.015675220638513565, decouple_loss:0.0019144462421536446
WV_1_PC_1_EH_0_PS_30, loss: 0.01564113423228264, avg_mse: 0.023108825087547302
current test mse: 0.023109
Iteration: 4171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482766389846802, gen p mean: -0.23189973831176758, mean p set: 0.44884711503982544
loss_pred:0.014860530383884907, decouple_loss:0.001709155854769051
The modified gen p mean: 0.44759121537208557, gen p mean: -0.23140759766101837, mean p set: 0.4481656849384308
loss_pred:0.014542536810040474, decouple_loss:0.0016892472049221396
The modified gen p mean: 0.448543906211853, gen p mean: -0.22845259308815002, mean p set: 0.4490656852722168
loss_pred:0.01417277380824089, decouple_loss:0.0017843099776655436
Iteration: 4172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757500290870667, gen p mean: -0.2284832000732422, mean p set: 0.44809815287590027
loss_pred:0.013664476573467255, decouple_loss:0.001619663555175066
The modified gen p mean: 0.4470171332359314, gen p mean: -0.23193220794200897, mean p set: 0.44759562611579895The modified gen p mean: 0.4459557831287384, gen p mean: -0.23734067380428314, mean p set: 0.4465283155441284
loss_pred:0.014274035580456257, decouple_loss:0.0017282735789194703
loss_pred:0.014776105061173439, decouple_loss:0.0017366004176437855
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471297562122345, gen p mean: -0.23253761231899261, mean p set: 0.44765913486480713
loss_pred:0.014380063861608505, decouple_loss:0.001746429014019668
The modified gen p mean: 0.4461825489997864, gen p mean: -0.2385784387588501, mean p set: 0.4467509686946869The modified gen p mean: 0.44604364037513733, gen p mean: -0.2364599108695984, mean p set: 0.44661951065063477
loss_pred:0.014699023216962814, decouple_loss:0.0017057227669283748
loss_pred:0.014651800505816936, decouple_loss:0.0017378919292241335
Iteration: 4174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833481311798096, gen p mean: -0.24080677330493927, mean p set: 0.4488631784915924
loss_pred:0.014174164272844791, decouple_loss:0.0016514967428520322
The modified gen p mean: 0.4471287727355957, gen p mean: -0.23544949293136597, mean p set: 0.4477040469646454
loss_pred:0.014239311218261719, decouple_loss:0.0016454665455967188
The modified gen p mean: 0.4474407434463501, gen p mean: -0.23528330028057098, mean p set: 0.44802215695381165
loss_pred:0.014092347584664822, decouple_loss:0.0016747451154515147
Iteration: 4175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474272131919861, gen p mean: -0.23713810741901398, mean p set: 0.4480046033859253
loss_pred:0.014052783139050007, decouple_loss:0.0016234307549893856
The modified gen p mean: 0.44799625873565674, gen p mean: -0.23365089297294617, mean p set: 0.4485728442668915The modified gen p mean: 0.4481501281261444, gen p mean: -0.23993615806102753, mean p set: 0.4486749470233917
loss_pred:0.014391918666660786, decouple_loss:0.001636920846067369
loss_pred:0.014525162056088448, decouple_loss:0.0015506439376622438
Iteration: 4176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471633732318878, gen p mean: -0.2299114465713501, mean p set: 0.4477352201938629
loss_pred:0.014829828403890133, decouple_loss:0.001697656000033021
The modified gen p mean: 0.446621835231781, gen p mean: -0.2295537292957306, mean p set: 0.44719401001930237
loss_pred:0.015043242834508419, decouple_loss:0.0016627954319119453
The modified gen p mean: 0.44638684391975403, gen p mean: -0.23239581286907196, mean p set: 0.44691428542137146
loss_pred:0.014708640985190868, decouple_loss:0.0018996703438460827
Iteration: 4177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715484976768494, gen p mean: -0.2285245656967163, mean p set: 0.447729229927063The modified gen p mean: 0.44720470905303955, gen p mean: -0.22443819046020508, mean p set: 0.44779056310653687
loss_pred:0.013941138051450253, decouple_loss:0.001682872767560184loss_pred:0.014312989078462124, decouple_loss:0.001782532432116568
The modified gen p mean: 0.4478505551815033, gen p mean: -0.22404390573501587, mean p set: 0.44838324189186096
loss_pred:0.014685427770018578, decouple_loss:0.0017581487772986293
Iteration: 4178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478922188282013, gen p mean: -0.22231358289718628, mean p set: 0.4484681785106659
loss_pred:0.014692992903292179, decouple_loss:0.0016866354271769524
The modified gen p mean: 0.4464273154735565, gen p mean: -0.2257714569568634, mean p set: 0.4470071494579315
loss_pred:0.014209588058292866, decouple_loss:0.0015998976305127144
The modified gen p mean: 0.44727823138237, gen p mean: -0.22754456102848053, mean p set: 0.4478060305118561
loss_pred:0.014420130290091038, decouple_loss:0.001620204420760274
Iteration: 4179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446041464805603, gen p mean: -0.22340063750743866, mean p set: 0.4466179311275482
loss_pred:0.01427512802183628, decouple_loss:0.00182580784894526
The modified gen p mean: 0.44784337282180786, gen p mean: -0.2229916900396347, mean p set: 0.4484192430973053
loss_pred:0.014908364042639732, decouple_loss:0.0017258614534512162
The modified gen p mean: 0.44731590151786804, gen p mean: -0.22375598549842834, mean p set: 0.44784313440322876
loss_pred:0.014789236709475517, decouple_loss:0.0017903945408761501
Iteration: 4180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779306650161743, gen p mean: -0.2256380170583725, mean p set: 0.44837021827697754
loss_pred:0.014354027807712555, decouple_loss:0.0017154017696157098
The modified gen p mean: 0.4467356204986572, gen p mean: -0.22927416861057281, mean p set: 0.4473138451576233
loss_pred:0.014565572142601013, decouple_loss:0.0017763487994670868
The modified gen p mean: 0.44841739535331726, gen p mean: -0.22083429992198944, mean p set: 0.448952317237854
loss_pred:0.014120661653578281, decouple_loss:0.0016874794382601976
2023-04-27 20:51:46 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22825023531913757, mean p set: 0.4499112665653229
loss_pred:0.01573353447020054, decouple_loss:0.001702922279946506
The modified gen p mean: 0.44929951429367065, gen p mean: -0.22846665978431702, mean p set: 0.4498290419578552
loss_pred:0.015175146982073784, decouple_loss:0.0017605216708034277
The modified gen p mean: 0.4482235908508301, gen p mean: -0.22602634131908417, mean p set: 0.44879910349845886
loss_pred:0.01561878714710474, decouple_loss:0.0016479953192174435
WV_1_PC_1_EH_0_PS_30, loss: 0.015594346448779106, avg_mse: 0.02310500107705593
current test mse: 0.023105
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 4181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446879118680954, gen p mean: -0.2345779985189438, mean p set: 0.44740915298461914
loss_pred:0.014914260245859623, decouple_loss:0.0017344211228191853
The modified gen p mean: 0.4477529227733612, gen p mean: -0.22721819579601288, mean p set: 0.44832706451416016
loss_pred:0.014611472375690937, decouple_loss:0.0017185704782605171
The modified gen p mean: 0.44822120666503906, gen p mean: -0.22625918686389923, mean p set: 0.4487912356853485
loss_pred:0.014921370893716812, decouple_loss:0.0017479570815339684
Iteration: 4182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768527150154114, gen p mean: -0.2312934845685959, mean p set: 0.44821611046791077
loss_pred:0.014934935607016087, decouple_loss:0.0018128675874322653
The modified gen p mean: 0.4467340409755707, gen p mean: -0.2306627780199051, mean p set: 0.4473150670528412The modified gen p mean: 0.4467073082923889, gen p mean: -0.23354066908359528, mean p set: 0.4472885727882385
loss_pred:0.014904644340276718, decouple_loss:0.0020576592069119215loss_pred:0.0152448620647192, decouple_loss:0.0021330660674721003
Iteration: 4183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476226568222046, gen p mean: -0.23517869412899017, mean p set: 0.4481530487537384
loss_pred:0.014413632452487946, decouple_loss:0.0019283160800114274
The modified gen p mean: 0.44845089316368103, gen p mean: -0.2323419749736786, mean p set: 0.44902777671813965
The modified gen p mean: 0.4484167993068695, gen p mean: -0.2355240285396576, mean p set: 0.4489942789077759
loss_pred:0.014460889622569084, decouple_loss:0.0020405282266438007
loss_pred:0.014384014531970024, decouple_loss:0.0019122149096801877
Iteration: 4184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723406434059143, gen p mean: -0.23748892545700073, mean p set: 0.44775891304016113
loss_pred:0.014922470785677433, decouple_loss:0.0023576884996145964
The modified gen p mean: 0.44928988814353943, gen p mean: -0.2331005185842514, mean p set: 0.449869304895401
The modified gen p mean: 0.4486941993236542, gen p mean: -0.22958050668239594, mean p set: 0.4492754638195038
loss_pred:0.014507069252431393, decouple_loss:0.0018665139796212316
loss_pred:0.014888658188283443, decouple_loss:0.0019293419318273664
Iteration: 4185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688141345977783, gen p mean: -0.23778054118156433, mean p set: 0.44745954871177673
loss_pred:0.014514265581965446, decouple_loss:0.001908777398057282
The modified gen p mean: 0.44756224751472473, gen p mean: -0.23417800664901733, mean p set: 0.448087215423584The modified gen p mean: 0.44811248779296875, gen p mean: -0.2366398125886917, mean p set: 0.44869065284729004
loss_pred:0.014469184912741184, decouple_loss:0.0018098934087902308
loss_pred:0.014386629685759544, decouple_loss:0.0018879753770306706
Iteration: 4186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461376368999481, gen p mean: -0.23762726783752441, mean p set: 0.44671642780303955
loss_pred:0.014827138744294643, decouple_loss:0.0019129682332277298
The modified gen p mean: 0.44899654388427734, gen p mean: -0.23764236271381378, mean p set: 0.44957879185676575
loss_pred:0.014181154780089855, decouple_loss:0.0020321293268352747
The modified gen p mean: 0.4469348192214966, gen p mean: -0.23331739008426666, mean p set: 0.4474617540836334
loss_pred:0.014756147749722004, decouple_loss:0.001762036932632327
Iteration: 4187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743767380714417, gen p mean: -0.22580629587173462, mean p set: 0.44801437854766846
loss_pred:0.014408094808459282, decouple_loss:0.0017944234423339367
The modified gen p mean: 0.4473634660243988, gen p mean: -0.2281535416841507, mean p set: 0.44789430499076843The modified gen p mean: 0.4467947483062744, gen p mean: -0.22971631586551666, mean p set: 0.44736772775650024
loss_pred:0.014312033541500568, decouple_loss:0.0017704905476421118
loss_pred:0.014527922496199608, decouple_loss:0.0017783381044864655
Iteration: 4188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606056809425354, gen p mean: -0.23451466858386993, mean p set: 0.4466356933116913
loss_pred:0.014527406543493271, decouple_loss:0.0018827372696250677
The modified gen p mean: 0.4497382342815399, gen p mean: -0.23106466233730316, mean p set: 0.45031026005744934
loss_pred:0.01452722493559122, decouple_loss:0.002032099524512887
The modified gen p mean: 0.44703763723373413, gen p mean: -0.23328857123851776, mean p set: 0.447562575340271
loss_pred:0.014533785171806812, decouple_loss:0.0018057534471154213
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851747155189514, gen p mean: -0.22985965013504028, mean p set: 0.44909462332725525
loss_pred:0.014234564267098904, decouple_loss:0.0017524798167869449
The modified gen p mean: 0.4483030438423157, gen p mean: -0.23363541066646576, mean p set: 0.44887441396713257
loss_pred:0.01435666624456644, decouple_loss:0.001692566554993391
The modified gen p mean: 0.44798383116722107, gen p mean: -0.23220424354076385, mean p set: 0.44851356744766235
loss_pred:0.014591176062822342, decouple_loss:0.001714076497592032
Iteration: 4190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476993680000305, gen p mean: -0.230031818151474, mean p set: 0.44827497005462646
loss_pred:0.013981102965772152, decouple_loss:0.001888143946416676
The modified gen p mean: 0.4459911584854126, gen p mean: -0.23589269816875458, mean p set: 0.44656795263290405
loss_pred:0.014775090850889683, decouple_loss:0.001968919299542904
The modified gen p mean: 0.44722676277160645, gen p mean: -0.23161274194717407, mean p set: 0.44775715470314026
loss_pred:0.01454963069409132, decouple_loss:0.0021924804896116257
2023-04-27 20:56:05 testing...
The modified gen p mean: 0.44821903109550476, gen p mean: -0.22849632799625397, mean p set: 0.44879910349845886
loss_pred:0.015562624670565128, decouple_loss:0.0018569849198684096
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23081304132938385, mean p set: 0.4499112665653229
loss_pred:0.01568240486085415, decouple_loss:0.0019027326488867402
The modified gen p mean: 0.44929710030555725, gen p mean: -0.231143519282341, mean p set: 0.4498290419578552
loss_pred:0.015127496793866158, decouple_loss:0.00195775437168777
WV_1_PC_1_EH_0_PS_30, loss: 0.01555280014872551, avg_mse: 0.02303750440478325
current test mse: 0.023038
Iteration: 4191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657596945762634, gen p mean: -0.23742003738880157, mean p set: 0.44709834456443787
loss_pred:0.014481115154922009, decouple_loss:0.0018268018029630184
The modified gen p mean: 0.4479222595691681, gen p mean: -0.23495744168758392, mean p set: 0.4484986364841461
loss_pred:0.014149065129458904, decouple_loss:0.0018324103439226747
The modified gen p mean: 0.4486117959022522, gen p mean: -0.23609215021133423, mean p set: 0.449184387922287
loss_pred:0.014175212942063808, decouple_loss:0.0018361287657171488
Iteration: 4192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44553229212760925, gen p mean: -0.2378772348165512, mean p set: 0.44606801867485046
loss_pred:0.014707594178617, decouple_loss:0.002034259494394064
The modified gen p mean: 0.44920849800109863, gen p mean: -0.23447482287883759, mean p set: 0.449787974357605
loss_pred:0.01416733581572771, decouple_loss:0.0017158976988866925
The modified gen p mean: 0.44750723242759705, gen p mean: -0.23435640335083008, mean p set: 0.44808489084243774
loss_pred:0.014443189837038517, decouple_loss:0.0016885707154870033
Iteration: 4193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470933973789215, gen p mean: -0.24390339851379395, mean p set: 0.44761988520622253
loss_pred:0.014498356729745865, decouple_loss:0.0018252490554004908
The modified gen p mean: 0.4460533857345581, gen p mean: -0.24110104143619537, mean p set: 0.4466274678707123
loss_pred:0.014830823987722397, decouple_loss:0.0018336966168135405
The modified gen p mean: 0.4471988379955292, gen p mean: -0.2346031814813614, mean p set: 0.4477689266204834
loss_pred:0.01449703797698021, decouple_loss:0.001682738191448152
Iteration: 4194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447479248046875, gen p mean: -0.2441709339618683, mean p set: 0.44801008701324463
loss_pred:0.014376887120306492, decouple_loss:0.0016955840401351452
The modified gen p mean: 0.44707366824150085, gen p mean: -0.23719128966331482, mean p set: 0.447646826505661
loss_pred:0.014484355226159096, decouple_loss:0.0019397861324250698
The modified gen p mean: 0.4475158452987671, gen p mean: -0.2441307157278061, mean p set: 0.4480946362018585
loss_pred:0.014500017277896404, decouple_loss:0.001785961794666946
Iteration: 4195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768422842025757, gen p mean: -0.24250806868076324, mean p set: 0.44826194643974304
loss_pred:0.014580443501472473, decouple_loss:0.0017050673486664891
The modified gen p mean: 0.4454402029514313, gen p mean: -0.24545890092849731, mean p set: 0.445966511964798The modified gen p mean: 0.446333646774292, gen p mean: -0.2449982762336731, mean p set: 0.4469049572944641
loss_pred:0.014667562209069729, decouple_loss:0.0017090800683945417
loss_pred:0.014488792046904564, decouple_loss:0.001709653646685183
Iteration: 4196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473351538181305, gen p mean: -0.24166814982891083, mean p set: 0.4479130506515503
loss_pred:0.014150325208902359, decouple_loss:0.0018599698087200522
The modified gen p mean: 0.4472815692424774, gen p mean: -0.24073301255702972, mean p set: 0.44780421257019043The modified gen p mean: 0.44934242963790894, gen p mean: -0.24112814664840698, mean p set: 0.4499136209487915
loss_pred:0.01452327985316515, decouple_loss:0.0019937283359467983
loss_pred:0.013996316120028496, decouple_loss:0.0018865072634071112
Iteration: 4197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669654965400696, gen p mean: -0.24836070835590363, mean p set: 0.44727712869644165
loss_pred:0.014091960154473782, decouple_loss:0.0019002693006768823
The modified gen p mean: 0.4472649097442627, gen p mean: -0.24513688683509827, mean p set: 0.44784191250801086
loss_pred:0.014392313547432423, decouple_loss:0.0018938834546133876
The modified gen p mean: 0.44779396057128906, gen p mean: -0.2395663857460022, mean p set: 0.4483223557472229
loss_pred:0.014102703891694546, decouple_loss:0.001778047881089151
Iteration: 4198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729363918304443, gen p mean: -0.24616430699825287, mean p set: 0.4478735327720642
loss_pred:0.014632520265877247, decouple_loss:0.0021266352850943804
The modified gen p mean: 0.44740527868270874, gen p mean: -0.2411414533853531, mean p set: 0.4479758143424988
loss_pred:0.013788670301437378, decouple_loss:0.0019547720439732075
The modified gen p mean: 0.44777074456214905, gen p mean: -0.2420651763677597, mean p set: 0.4482978880405426
loss_pred:0.014649320393800735, decouple_loss:0.002210266888141632
Iteration: 4199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448425829410553, gen p mean: -0.24164262413978577, mean p set: 0.44900041818618774
loss_pred:0.01406482420861721, decouple_loss:0.001772166695445776
The modified gen p mean: 0.44605982303619385, gen p mean: -0.24462594091892242, mean p set: 0.4466353952884674
loss_pred:0.014367259107530117, decouple_loss:0.001660326961427927
The modified gen p mean: 0.44715479016304016, gen p mean: -0.24386583268642426, mean p set: 0.44767752289772034
loss_pred:0.014348107390105724, decouple_loss:0.0018204228254035115
Iteration: 4200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479387104511261, gen p mean: -0.23499104380607605, mean p set: 0.4485120475292206
loss_pred:0.014882611110806465, decouple_loss:0.0021115525159984827
The modified gen p mean: 0.4483184218406677, gen p mean: -0.24126067757606506, mean p set: 0.4488462209701538The modified gen p mean: 0.44703367352485657, gen p mean: -0.23888282477855682, mean p set: 0.4476076066493988
loss_pred:0.01432011928409338, decouple_loss:0.001932469429448247
loss_pred:0.01439740601927042, decouple_loss:0.001948238001205027
2023-04-27 20:59:29 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.23562557995319366, mean p set: 0.4499112665653229
loss_pred:0.015690598636865616, decouple_loss:0.001726204645819962
The modified gen p mean: 0.44930246472358704, gen p mean: -0.2359313666820526, mean p set: 0.4498290419578552
loss_pred:0.015121089294552803, decouple_loss:0.0018464927561581135
The modified gen p mean: 0.4482195973396301, gen p mean: -0.2330186814069748, mean p set: 0.44879910349845886
loss_pred:0.015555405989289284, decouple_loss:0.0017419751966372132
WV_1_PC_1_EH_0_PS_30, loss: 0.015544275753200054, avg_mse: 0.023031454533338547
current test mse: 0.023031
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 4201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473115801811218, gen p mean: -0.23708005249500275, mean p set: 0.4478406012058258
loss_pred:0.014611826278269291, decouple_loss:0.002140662632882595
The modified gen p mean: 0.44671380519866943, gen p mean: -0.23666906356811523, mean p set: 0.4472944438457489
loss_pred:0.014417575672268867, decouple_loss:0.0021560746245086193
The modified gen p mean: 0.44716838002204895, gen p mean: -0.23559190332889557, mean p set: 0.4477413594722748
loss_pred:0.014361008070409298, decouple_loss:0.0018416368402540684
Iteration: 4202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477168917655945, gen p mean: -0.24056218564510345, mean p set: 0.4482399523258209
loss_pred:0.014522936195135117, decouple_loss:0.0019265750888735056
The modified gen p mean: 0.44703367352485657, gen p mean: -0.2398991882801056, mean p set: 0.4476131498813629
The modified gen p mean: 0.4476420283317566, gen p mean: -0.2376430779695511, mean p set: 0.4482089579105377
loss_pred:0.01361287571489811, decouple_loss:0.002097458578646183
loss_pred:0.014482935890555382, decouple_loss:0.0019322163425385952
Iteration: 4203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461260735988617, gen p mean: -0.23760870099067688, mean p set: 0.44665300846099854
loss_pred:0.014551389031112194, decouple_loss:0.0017438980285078287
The modified gen p mean: 0.4473251402378082, gen p mean: -0.24085858464241028, mean p set: 0.4479069411754608
The modified gen p mean: 0.44725358486175537, gen p mean: -0.24098056554794312, mean p set: 0.4478244483470917
loss_pred:0.014694120734930038, decouple_loss:0.0017496453365311027
loss_pred:0.014280309900641441, decouple_loss:0.0019472120329737663
Iteration: 4204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476976692676544, gen p mean: -0.24351216852664948, mean p set: 0.4482249617576599
loss_pred:0.013979719020426273, decouple_loss:0.002031300449743867
The modified gen p mean: 0.4477452039718628, gen p mean: -0.23865225911140442, mean p set: 0.44831904768943787
The modified gen p mean: 0.44752243161201477, gen p mean: -0.239838108420372, mean p set: 0.4480917155742645
loss_pred:0.014364398084580898, decouple_loss:0.001996677601709962
loss_pred:0.01470397599041462, decouple_loss:0.0021169697865843773
Iteration: 4205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474639892578125, gen p mean: -0.2360612154006958, mean p set: 0.4480433166027069
loss_pred:0.0135662155225873, decouple_loss:0.0019502105424180627
The modified gen p mean: 0.4471461772918701, gen p mean: -0.23698192834854126, mean p set: 0.44771865010261536The modified gen p mean: 0.44749337434768677, gen p mean: -0.2363308221101761, mean p set: 0.44802039861679077
loss_pred:0.013593056239187717, decouple_loss:0.0019975502509623766
loss_pred:0.013751042075455189, decouple_loss:0.0017978608375415206
Iteration: 4206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473561942577362, gen p mean: -0.23452003300189972, mean p set: 0.44792893528938293
loss_pred:0.014697043225169182, decouple_loss:0.001978592947125435
The modified gen p mean: 0.4470897614955902, gen p mean: -0.23722413182258606, mean p set: 0.44761648774147034The modified gen p mean: 0.44816771149635315, gen p mean: -0.23347094655036926, mean p set: 0.4487457573413849
loss_pred:0.01435753982514143, decouple_loss:0.001820623641833663
loss_pred:0.013866417109966278, decouple_loss:0.002193060703575611
Iteration: 4207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685259461402893, gen p mean: -0.235091894865036, mean p set: 0.44742754101753235
loss_pred:0.013629798777401447, decouple_loss:0.001903076539747417
The modified gen p mean: 0.44660142064094543, gen p mean: -0.23126479983329773, mean p set: 0.4471800923347473
loss_pred:0.014539270661771297, decouple_loss:0.001852068118751049
The modified gen p mean: 0.4476132094860077, gen p mean: -0.23448902368545532, mean p set: 0.4481387734413147
loss_pred:0.014085523784160614, decouple_loss:0.001979478867724538
Iteration: 4208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717273116111755, gen p mean: -0.2337779998779297, mean p set: 0.4477456510066986
loss_pred:0.014486714266240597, decouple_loss:0.0017048311419785023
The modified gen p mean: 0.44803011417388916, gen p mean: -0.23290982842445374, mean p set: 0.44855615496635437The modified gen p mean: 0.44743672013282776, gen p mean: -0.2365768998861313, mean p set: 0.4480080008506775
loss_pred:0.014493802562355995, decouple_loss:0.0017401541117578745
loss_pred:0.014105411246418953, decouple_loss:0.0018422779394313693
Iteration: 4209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446968674659729, gen p mean: -0.23664480447769165, mean p set: 0.44754406809806824
loss_pred:0.013925280421972275, decouple_loss:0.0017434373730793595
The modified gen p mean: 0.4479300081729889, gen p mean: -0.23608513176441193, mean p set: 0.44846081733703613The modified gen p mean: 0.4481971561908722, gen p mean: -0.23459884524345398, mean p set: 0.44877755641937256
loss_pred:0.014364594593644142, decouple_loss:0.0016918336041271687
loss_pred:0.013778336346149445, decouple_loss:0.0019426974467933178
Iteration: 4210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770175218582153, gen p mean: -0.2425353229045868, mean p set: 0.44828295707702637
loss_pred:0.014493015594780445, decouple_loss:0.0017749980324879289
The modified gen p mean: 0.44819310307502747, gen p mean: -0.23927976191043854, mean p set: 0.4487678110599518
loss_pred:0.013853386975824833, decouple_loss:0.0017547787865623832
The modified gen p mean: 0.447663813829422, gen p mean: -0.23928970098495483, mean p set: 0.44819164276123047
loss_pred:0.013700595125555992, decouple_loss:0.0019369404762983322
2023-04-27 21:03:30 testing...
The modified gen p mean: 0.4482221007347107, gen p mean: -0.2371094673871994, mean p set: 0.44879910349845886
loss_pred:0.015736764296889305, decouple_loss:0.0017207039054483175
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2395789474248886, mean p set: 0.4499112665653229
loss_pred:0.015873009338974953, decouple_loss:0.0017026277491822839
The modified gen p mean: 0.44931015372276306, gen p mean: -0.2400449961423874, mean p set: 0.4498290419578552
loss_pred:0.015351983718574047, decouple_loss:0.001856081304140389
WV_1_PC_1_EH_0_PS_30, loss: 0.01574191078543663, avg_mse: 0.02337506040930748
current test mse: 0.023375
Iteration: 4211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481276273727417, gen p mean: -0.23774543404579163, mean p set: 0.44870179891586304
loss_pred:0.014349878765642643, decouple_loss:0.00175477284938097
The modified gen p mean: 0.44703400135040283, gen p mean: -0.23496370017528534, mean p set: 0.44760891795158386
loss_pred:0.014571641571819782, decouple_loss:0.0018159616738557816
The modified gen p mean: 0.44768789410591125, gen p mean: -0.2388824075460434, mean p set: 0.44821682572364807
loss_pred:0.014291361905634403, decouple_loss:0.0016645774012431502
Iteration: 4212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476238787174225, gen p mean: -0.2415481060743332, mean p set: 0.44814959168434143
loss_pred:0.013742253184318542, decouple_loss:0.0018338416703045368
The modified gen p mean: 0.4473537802696228, gen p mean: -0.24304166436195374, mean p set: 0.4479289650917053
loss_pred:0.014625949785113335, decouple_loss:0.0016255073715001345
The modified gen p mean: 0.44674089550971985, gen p mean: -0.23571224510669708, mean p set: 0.44731831550598145
loss_pred:0.014375421218574047, decouple_loss:0.0017685580532997847
Iteration: 4213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447831392288208, gen p mean: -0.2402777224779129, mean p set: 0.4483511745929718
loss_pred:0.013907132670283318, decouple_loss:0.001847379026003182
The modified gen p mean: 0.4476592242717743, gen p mean: -0.24112048745155334, mean p set: 0.4482308626174927
loss_pred:0.01411138940602541, decouple_loss:0.001692802645266056
The modified gen p mean: 0.44881314039230347, gen p mean: -0.23774558305740356, mean p set: 0.4493890404701233
loss_pred:0.014127498492598534, decouple_loss:0.0017894381890073419
Iteration: 4214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486783444881439, gen p mean: -0.23427343368530273, mean p set: 0.4492107927799225
loss_pred:0.014308053068816662, decouple_loss:0.0018790068570524454
The modified gen p mean: 0.44602683186531067, gen p mean: -0.2350851148366928, mean p set: 0.44660380482673645
loss_pred:0.01441179495304823, decouple_loss:0.0020104378927499056
The modified gen p mean: 0.44748982787132263, gen p mean: -0.24227376282215118, mean p set: 0.44806867837905884
loss_pred:0.014141082763671875, decouple_loss:0.001795062329620123
Iteration: 4215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489132761955261, gen p mean: -0.2372448593378067, mean p set: 0.4494889974594116
loss_pred:0.013516174629330635, decouple_loss:0.001842494704760611
The modified gen p mean: 0.4474489688873291, gen p mean: -0.23763538897037506, mean p set: 0.4480248689651489
loss_pred:0.013799389824271202, decouple_loss:0.0016160206869244576
The modified gen p mean: 0.4471685588359833, gen p mean: -0.23965688049793243, mean p set: 0.44770246744155884
loss_pred:0.013845792971551418, decouple_loss:0.001756001147441566
Iteration: 4216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472721517086029, gen p mean: -0.2350967824459076, mean p set: 0.44785353541374207
loss_pred:0.014013079926371574, decouple_loss:0.0019197583897039294
The modified gen p mean: 0.4469195008277893, gen p mean: -0.23800128698349, mean p set: 0.44745007157325745The modified gen p mean: 0.4472905397415161, gen p mean: -0.24023109674453735, mean p set: 0.4478645324707031
loss_pred:0.013740552589297295, decouple_loss:0.0021836908999830484
loss_pred:0.013556888327002525, decouple_loss:0.0020166810136288404
Iteration: 4217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846296310424805, gen p mean: -0.23526720702648163, mean p set: 0.44904205203056335
loss_pred:0.013791978359222412, decouple_loss:0.0025653589982539415
The modified gen p mean: 0.4477849304676056, gen p mean: -0.2295035421848297, mean p set: 0.4483618438243866
loss_pred:0.013905939646065235, decouple_loss:0.002430352382361889
The modified gen p mean: 0.4477580487728119, gen p mean: -0.23517780005931854, mean p set: 0.4482864737510681
loss_pred:0.013994625769555569, decouple_loss:0.002319654682651162
Iteration: 4218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766250252723694, gen p mean: -0.23234401643276215, mean p set: 0.44823944568634033
loss_pred:0.014072631485760212, decouple_loss:0.0019155784975737333
The modified gen p mean: 0.44717055559158325, gen p mean: -0.23007932305335999, mean p set: 0.4477475583553314
loss_pred:0.013602359220385551, decouple_loss:0.0020606457255780697
The modified gen p mean: 0.44653329253196716, gen p mean: -0.23116689920425415, mean p set: 0.44706112146377563
loss_pred:0.014333182945847511, decouple_loss:0.0019230940379202366
Iteration: 4219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480639100074768, gen p mean: -0.22701215744018555, mean p set: 0.4486466944217682
loss_pred:0.014142045751214027, decouple_loss:0.001966039417311549
The modified gen p mean: 0.4487551152706146, gen p mean: -0.23253878951072693, mean p set: 0.4493274986743927
loss_pred:0.01408146321773529, decouple_loss:0.0020281500183045864
The modified gen p mean: 0.44828352332115173, gen p mean: -0.22792789340019226, mean p set: 0.4488186836242676
loss_pred:0.01410619542002678, decouple_loss:0.001949354656971991
Iteration: 4220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482848346233368, gen p mean: -0.23091016709804535, mean p set: 0.4488621652126312
loss_pred:0.014545554295182228, decouple_loss:0.0019235077779740095
The modified gen p mean: 0.44724276661872864, gen p mean: -0.23171813786029816, mean p set: 0.4478210508823395
loss_pred:0.014291709288954735, decouple_loss:0.001961481524631381
The modified gen p mean: 0.4482637345790863, gen p mean: -0.23374038934707642, mean p set: 0.44879069924354553
loss_pred:0.013544485904276371, decouple_loss:0.0021037422120571136
2023-04-27 21:06:56 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23422378301620483, mean p set: 0.4499112665653229
loss_pred:0.01586339622735977, decouple_loss:0.0021215935703366995
The modified gen p mean: 0.44929710030555725, gen p mean: -0.2346191108226776, mean p set: 0.4498290419578552
loss_pred:0.015295542776584625, decouple_loss:0.002052512252703309
The modified gen p mean: 0.44822409749031067, gen p mean: -0.23158374428749084, mean p set: 0.44879910349845886
loss_pred:0.015665654093027115, decouple_loss:0.001988708972930908
WV_1_PC_1_EH_0_PS_30, loss: 0.01571091264486313, avg_mse: 0.023323578760027885
current test mse: 0.023324
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 4221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759729504585266, gen p mean: -0.23401619493961334, mean p set: 0.44812965393066406
loss_pred:0.01531233824789524, decouple_loss:0.0021368698216974735
The modified gen p mean: 0.4472901225090027, gen p mean: -0.23545625805854797, mean p set: 0.4478660225868225
loss_pred:0.01557336188852787, decouple_loss:0.002216220134869218
The modified gen p mean: 0.4475191533565521, gen p mean: -0.23768185079097748, mean p set: 0.4481041729450226
loss_pred:0.015433397144079208, decouple_loss:0.001975396880879998
Iteration: 4222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461311399936676, gen p mean: -0.23481616377830505, mean p set: 0.4466569721698761
loss_pred:0.014975219033658504, decouple_loss:0.0018538914155215025
The modified gen p mean: 0.4469490647315979, gen p mean: -0.23834377527236938, mean p set: 0.44752374291419983
The modified gen p mean: 0.4453699290752411, gen p mean: -0.23503471910953522, mean p set: 0.4459480941295624
loss_pred:0.015174463391304016, decouple_loss:0.0018082152819260955
loss_pred:0.014785951934754848, decouple_loss:0.0018715040059760213
Iteration: 4223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467402398586273, gen p mean: -0.2394801527261734, mean p set: 0.4472745358943939
loss_pred:0.014207404106855392, decouple_loss:0.001986857270821929
The modified gen p mean: 0.444825142621994, gen p mean: -0.2364307940006256, mean p set: 0.4453986883163452
The modified gen p mean: 0.4465719163417816, gen p mean: -0.23890335857868195, mean p set: 0.44714006781578064
loss_pred:0.01542145386338234, decouple_loss:0.0023229331709444523
loss_pred:0.015004855580627918, decouple_loss:0.0020473734475672245
Iteration: 4224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651350378990173, gen p mean: -0.23966994881629944, mean p set: 0.4470418095588684
loss_pred:0.01452889759093523, decouple_loss:0.0018477708799764514
The modified gen p mean: 0.44695407152175903, gen p mean: -0.242130309343338, mean p set: 0.4475320279598236
The modified gen p mean: 0.4450799524784088, gen p mean: -0.2371687889099121, mean p set: 0.4456527829170227
loss_pred:0.014623682014644146, decouple_loss:0.0016762202139943838
loss_pred:0.014859148301184177, decouple_loss:0.001798971788957715
Iteration: 4225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673627614974976, gen p mean: -0.23831216990947723, mean p set: 0.44731536507606506
loss_pred:0.014856074005365372, decouple_loss:0.001878360053524375
The modified gen p mean: 0.4467203617095947, gen p mean: -0.23641516268253326, mean p set: 0.44729533791542053The modified gen p mean: 0.4463215172290802, gen p mean: -0.2398516982793808, mean p set: 0.4468485414981842
loss_pred:0.014352750033140182, decouple_loss:0.0019308594055473804loss_pred:0.014655343256890774, decouple_loss:0.0018750233575701714
Iteration: 4226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643881916999817, gen p mean: -0.23723258078098297, mean p set: 0.4470106363296509
loss_pred:0.014689963310956955, decouple_loss:0.0018846218008548021
The modified gen p mean: 0.4470060169696808, gen p mean: -0.23734962940216064, mean p set: 0.4475346803665161The modified gen p mean: 0.446424275636673, gen p mean: -0.23619934916496277, mean p set: 0.447003036737442
loss_pred:0.014841161668300629, decouple_loss:0.001894128043204546
loss_pred:0.015358437784016132, decouple_loss:0.00192350335419178
Iteration: 4227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464586675167084, gen p mean: -0.24159780144691467, mean p set: 0.4470359981060028
loss_pred:0.014426547102630138, decouple_loss:0.0020693859551101923
The modified gen p mean: 0.44641780853271484, gen p mean: -0.23828963935375214, mean p set: 0.44695156812667847The modified gen p mean: 0.4463827908039093, gen p mean: -0.2409753054380417, mean p set: 0.44695594906806946
loss_pred:0.014150581322610378, decouple_loss:0.0023630685172975063
loss_pred:0.014503180980682373, decouple_loss:0.002243410563096404
Iteration: 4228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465641677379608, gen p mean: -0.2396010011434555, mean p set: 0.44713932275772095
loss_pred:0.01456526666879654, decouple_loss:0.0018678985070437193
The modified gen p mean: 0.4470123052597046, gen p mean: -0.2342853844165802, mean p set: 0.4475449025630951The modified gen p mean: 0.44622907042503357, gen p mean: -0.23415601253509521, mean p set: 0.4468083381652832
loss_pred:0.014684497378766537, decouple_loss:0.0018620791379362345
loss_pred:0.015010319650173187, decouple_loss:0.0018957527354359627
Iteration: 4229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44555315375328064, gen p mean: -0.23149514198303223, mean p set: 0.44613370299339294
loss_pred:0.014507676474750042, decouple_loss:0.0019648890011012554
The modified gen p mean: 0.4466674327850342, gen p mean: -0.2363026738166809, mean p set: 0.44719311594963074The modified gen p mean: 0.44537752866744995, gen p mean: -0.23288264870643616, mean p set: 0.44595643877983093
loss_pred:0.0146424425765872, decouple_loss:0.0019450281979516149
loss_pred:0.01430563721805811, decouple_loss:0.0021754091139882803
Iteration: 4230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458194375038147, gen p mean: -0.23343569040298462, mean p set: 0.44639402627944946
loss_pred:0.014650614932179451, decouple_loss:0.0017011710442602634
The modified gen p mean: 0.44588300585746765, gen p mean: -0.2327909767627716, mean p set: 0.44640541076660156The modified gen p mean: 0.44559767842292786, gen p mean: -0.23590335249900818, mean p set: 0.446174293756485
loss_pred:0.014595728367567062, decouple_loss:0.001802946557290852
loss_pred:0.014693386852741241, decouple_loss:0.0018165170913562179
2023-04-27 21:10:59 testing...
The modified gen p mean: 0.4482220411300659, gen p mean: -0.2299433946609497, mean p set: 0.44879910349845886
loss_pred:0.015558216720819473, decouple_loss:0.0021476910915225744
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23245927691459656, mean p set: 0.4499112665653229
loss_pred:0.015795037150382996, decouple_loss:0.002293304307386279
The modified gen p mean: 0.4493056833744049, gen p mean: -0.2328997403383255, mean p set: 0.4498290419578552
loss_pred:0.015193339437246323, decouple_loss:0.002121035708114505
WV_1_PC_1_EH_0_PS_30, loss: 0.015624898485839367, avg_mse: 0.023149995133280754
current test mse: 0.02315
Iteration: 4231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697466492652893, gen p mean: -0.23378276824951172, mean p set: 0.44754984974861145
loss_pred:0.014573846012353897, decouple_loss:0.001933503895998001
The modified gen p mean: 0.44572925567626953, gen p mean: -0.23353461921215057, mean p set: 0.44631072878837585
loss_pred:0.014389622025191784, decouple_loss:0.002124885795637965
The modified gen p mean: 0.44712862372398376, gen p mean: -0.23616915941238403, mean p set: 0.44765836000442505
loss_pred:0.0145114129409194, decouple_loss:0.0020830179564654827
Iteration: 4232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471099376678467, gen p mean: -0.23095422983169556, mean p set: 0.44763532280921936
loss_pred:0.014913707971572876, decouple_loss:0.0018146253423765302
The modified gen p mean: 0.44554051756858826, gen p mean: -0.23203757405281067, mean p set: 0.44611749053001404
loss_pred:0.014562374912202358, decouple_loss:0.0018824832513928413
The modified gen p mean: 0.44706207513809204, gen p mean: -0.24014218151569366, mean p set: 0.4476405084133148
loss_pred:0.014746400527656078, decouple_loss:0.0018246100516989827
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469137489795685, gen p mean: -0.23740221560001373, mean p set: 0.44744303822517395
loss_pred:0.014761495403945446, decouple_loss:0.0017455669585615396
The modified gen p mean: 0.4457882046699524, gen p mean: -0.2382732629776001, mean p set: 0.4463599622249603
loss_pred:0.014706814661622047, decouple_loss:0.001694460865110159
The modified gen p mean: 0.44786807894706726, gen p mean: -0.23668357729911804, mean p set: 0.4484444558620453
loss_pred:0.015354795381426811, decouple_loss:0.0018520005978643894
Iteration: 4234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669926166534424, gen p mean: -0.23756055533885956, mean p set: 0.44723621010780334
loss_pred:0.014512032270431519, decouple_loss:0.0016095407772809267
The modified gen p mean: 0.4460929036140442, gen p mean: -0.2372909039258957, mean p set: 0.44666188955307007
loss_pred:0.014777772128582, decouple_loss:0.0016312794759869576
The modified gen p mean: 0.4465042054653168, gen p mean: -0.2410774528980255, mean p set: 0.4470827281475067
loss_pred:0.01440746895968914, decouple_loss:0.001788123743608594
Iteration: 4235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446005642414093, gen p mean: -0.24017421901226044, mean p set: 0.4465799629688263
loss_pred:0.014227215200662613, decouple_loss:0.0017776729073375463
The modified gen p mean: 0.44712725281715393, gen p mean: -0.24334613978862762, mean p set: 0.44770827889442444
loss_pred:0.01491239108145237, decouple_loss:0.001955424202606082
The modified gen p mean: 0.44625452160835266, gen p mean: -0.2401941865682602, mean p set: 0.44678211212158203
loss_pred:0.014390810392796993, decouple_loss:0.001839810167439282
Iteration: 4236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471607804298401, gen p mean: -0.24092227220535278, mean p set: 0.44773659110069275
loss_pred:0.01428435929119587, decouple_loss:0.0016779332654550672
The modified gen p mean: 0.4470512568950653, gen p mean: -0.23845858871936798, mean p set: 0.4476243555545807
loss_pred:0.014406755566596985, decouple_loss:0.0016560686053708196
The modified gen p mean: 0.4464573264122009, gen p mean: -0.24022820591926575, mean p set: 0.446982741355896
loss_pred:0.014556413516402245, decouple_loss:0.0015609905822202563
Iteration: 4237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469206631183624, gen p mean: -0.2445877641439438, mean p set: 0.44749611616134644
loss_pred:0.01435211580246687, decouple_loss:0.0014754488365724683
The modified gen p mean: 0.44683167338371277, gen p mean: -0.2395758032798767, mean p set: 0.447405070066452
loss_pred:0.014459745027124882, decouple_loss:0.001656896318309009
The modified gen p mean: 0.44639644026756287, gen p mean: -0.2391422688961029, mean p set: 0.4469238221645355
loss_pred:0.01500166580080986, decouple_loss:0.0017058514058589935
Iteration: 4238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459027051925659, gen p mean: -0.2360219657421112, mean p set: 0.44647544622421265
loss_pred:0.01532142423093319, decouple_loss:0.0017821623478084803
The modified gen p mean: 0.4465014338493347, gen p mean: -0.24001315236091614, mean p set: 0.44707778096199036
loss_pred:0.014571776613593102, decouple_loss:0.0017473106272518635
The modified gen p mean: 0.44552063941955566, gen p mean: -0.23980793356895447, mean p set: 0.44604605436325073
loss_pred:0.01424339134246111, decouple_loss:0.0018133249832317233
Iteration: 4239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463222622871399, gen p mean: -0.23492248356342316, mean p set: 0.4468989372253418
loss_pred:0.014632773585617542, decouple_loss:0.0019557999912649393
The modified gen p mean: 0.44548311829566956, gen p mean: -0.23495393991470337, mean p set: 0.44606199860572815
loss_pred:0.014600833877921104, decouple_loss:0.0017241069581359625
The modified gen p mean: 0.44590893387794495, gen p mean: -0.23509836196899414, mean p set: 0.4464392364025116
loss_pred:0.014740637503564358, decouple_loss:0.001704716356471181
Iteration: 4240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447064071893692, gen p mean: -0.23552416265010834, mean p set: 0.4476345181465149
loss_pred:0.014534988440573215, decouple_loss:0.002024746499955654
The modified gen p mean: 0.44576144218444824, gen p mean: -0.23459374904632568, mean p set: 0.4463409185409546
loss_pred:0.014435981400310993, decouple_loss:0.0017317209858447313
The modified gen p mean: 0.4441310465335846, gen p mean: -0.23322603106498718, mean p set: 0.44466984272003174
loss_pred:0.014848587103188038, decouple_loss:0.0019431931432336569
2023-04-27 21:14:24 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23491747677326202, mean p set: 0.4499112665653229
loss_pred:0.01573711633682251, decouple_loss:0.0022939778864383698
The modified gen p mean: 0.4492998719215393, gen p mean: -0.2349035143852234, mean p set: 0.4498290419578552
loss_pred:0.01521211676299572, decouple_loss:0.001950434991158545
The modified gen p mean: 0.44822317361831665, gen p mean: -0.23208865523338318, mean p set: 0.44879910349845886
loss_pred:0.015558931976556778, decouple_loss:0.0020382432267069817
WV_1_PC_1_EH_0_PS_30, loss: 0.015607433393597603, avg_mse: 0.023153213784098625
current test mse: 0.023153
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 4241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841858744621277, gen p mean: -0.23289597034454346, mean p set: 0.44899484515190125
loss_pred:0.015448980033397675, decouple_loss:0.0022789016366004944
The modified gen p mean: 0.44923239946365356, gen p mean: -0.23169374465942383, mean p set: 0.4497624933719635
loss_pred:0.014767874032258987, decouple_loss:0.002222457667812705
The modified gen p mean: 0.4477466940879822, gen p mean: -0.2388722002506256, mean p set: 0.44832560420036316
loss_pred:0.014515930786728859, decouple_loss:0.0021170300897210836
Iteration: 4242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792020320892334, gen p mean: -0.23580816388130188, mean p set: 0.4484458863735199
loss_pred:0.014730948023498058, decouple_loss:0.0020306608639657497
The modified gen p mean: 0.44813621044158936, gen p mean: -0.23179790377616882, mean p set: 0.4487136900424957
loss_pred:0.014874512329697609, decouple_loss:0.0020199534483253956
The modified gen p mean: 0.4493926167488098, gen p mean: -0.22776654362678528, mean p set: 0.44996556639671326
loss_pred:0.014239962212741375, decouple_loss:0.0021073147654533386
Iteration: 4243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482910633087158, gen p mean: -0.22557087242603302, mean p set: 0.4488248825073242
loss_pred:0.01468589436262846, decouple_loss:0.0019953595474362373
The modified gen p mean: 0.44877889752388, gen p mean: -0.2287927269935608, mean p set: 0.4493550956249237
loss_pred:0.014435946010053158, decouple_loss:0.002009981544688344
The modified gen p mean: 0.448942095041275, gen p mean: -0.2210245430469513, mean p set: 0.4495154023170471
loss_pred:0.014067990705370903, decouple_loss:0.002009928459301591
Iteration: 4244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489656388759613, gen p mean: -0.21979305148124695, mean p set: 0.4494929015636444
loss_pred:0.014760100282728672, decouple_loss:0.001943593262694776
The modified gen p mean: 0.44994595646858215, gen p mean: -0.21999123692512512, mean p set: 0.450520396232605
loss_pred:0.014461646787822247, decouple_loss:0.0021833209320902824
The modified gen p mean: 0.4488396942615509, gen p mean: -0.22285349667072296, mean p set: 0.44941237568855286
loss_pred:0.014684254303574562, decouple_loss:0.0021084174513816833
Iteration: 4245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492829144001007, gen p mean: -0.22174736857414246, mean p set: 0.44986000657081604
loss_pred:0.014283652417361736, decouple_loss:0.0019062921637669206
The modified gen p mean: 0.4489535093307495, gen p mean: -0.2267867922782898, mean p set: 0.4494836926460266The modified gen p mean: 0.44972994923591614, gen p mean: -0.22390680015087128, mean p set: 0.4503089487552643
loss_pred:0.014344990253448486, decouple_loss:0.0019317766418680549
loss_pred:0.01388747151941061, decouple_loss:0.0018583156634122133
Iteration: 4246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934192299842834, gen p mean: -0.2320055216550827, mean p set: 0.44991445541381836
loss_pred:0.01459136139601469, decouple_loss:0.0018666436662897468
The modified gen p mean: 0.448660671710968, gen p mean: -0.22988079488277435, mean p set: 0.449236124753952
loss_pred:0.014312207698822021, decouple_loss:0.001860552467405796
The modified gen p mean: 0.44987648725509644, gen p mean: -0.2299155443906784, mean p set: 0.4504038989543915
loss_pred:0.014281676150858402, decouple_loss:0.0018840859411284328
Iteration: 4247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487020671367645, gen p mean: -0.22798553109169006, mean p set: 0.4492739737033844
loss_pred:0.014895469881594181, decouple_loss:0.0022780403960496187
The modified gen p mean: 0.4490281343460083, gen p mean: -0.2322421371936798, mean p set: 0.4495515525341034The modified gen p mean: 0.4479301869869232, gen p mean: -0.23610270023345947, mean p set: 0.44850850105285645
loss_pred:0.013856111094355583, decouple_loss:0.00188533088658005
loss_pred:0.014530963264405727, decouple_loss:0.0017670042579993606
Iteration: 4248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479132294654846, gen p mean: -0.2380775809288025, mean p set: 0.44848892092704773
loss_pred:0.014997853897511959, decouple_loss:0.0018459500279277563
The modified gen p mean: 0.4485231339931488, gen p mean: -0.2296813577413559, mean p set: 0.44910016655921936
loss_pred:0.014841455034911633, decouple_loss:0.0018645378295332193
The modified gen p mean: 0.44776836037635803, gen p mean: -0.2407323271036148, mean p set: 0.44829061627388
loss_pred:0.014267374761402607, decouple_loss:0.0018693762831389904
Iteration: 4249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450966477394104, gen p mean: -0.2326003611087799, mean p set: 0.4515393376350403
loss_pred:0.01437307521700859, decouple_loss:0.0017720647156238556
The modified gen p mean: 0.4487643837928772, gen p mean: -0.23969458043575287, mean p set: 0.44933852553367615
loss_pred:0.014245487749576569, decouple_loss:0.0018947685603052378
The modified gen p mean: 0.4506417214870453, gen p mean: -0.23330342769622803, mean p set: 0.451172411441803
loss_pred:0.014485063962638378, decouple_loss:0.0017044225241988897
Iteration: 4250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448696494102478, gen p mean: -0.2375614196062088, mean p set: 0.44927287101745605
loss_pred:0.01449628546833992, decouple_loss:0.0019757957197725773
The modified gen p mean: 0.4492035508155823, gen p mean: -0.2373521625995636, mean p set: 0.44977647066116333
loss_pred:0.01420320849865675, decouple_loss:0.0017619985155761242
The modified gen p mean: 0.4494034945964813, gen p mean: -0.23902110755443573, mean p set: 0.4499305486679077
loss_pred:0.013953355140984058, decouple_loss:0.0017987812170758843
2023-04-27 21:18:23 testing...
The modified gen p mean: 0.44822415709495544, gen p mean: -0.23446804285049438, mean p set: 0.44879910349845886
loss_pred:0.015662159770727158, decouple_loss:0.00210670568048954
The modified gen p mean: 0.44930747151374817, gen p mean: -0.23777687549591064, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23780281841754913, mean p set: 0.4499112665653229loss_pred:0.015302569605410099, decouple_loss:0.0021198829635977745
loss_pred:0.015818597748875618, decouple_loss:0.002165446523576975
WV_1_PC_1_EH_0_PS_30, loss: 0.01570097729563713, avg_mse: 0.023269178345799446
current test mse: 0.023269
Iteration: 4251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489618241786957, gen p mean: -0.23416611552238464, mean p set: 0.4494885504245758
loss_pred:0.015155913308262825, decouple_loss:0.0020651877857744694
The modified gen p mean: 0.4485906958580017, gen p mean: -0.23188729584217072, mean p set: 0.4491713047027588
loss_pred:0.014775090850889683, decouple_loss:0.0017380567733198404
The modified gen p mean: 0.44778338074684143, gen p mean: -0.24031999707221985, mean p set: 0.4483579099178314
loss_pred:0.013585996814072132, decouple_loss:0.0017568978946655989
Iteration: 4252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804367423057556, gen p mean: -0.23327790200710297, mean p set: 0.4485754370689392
loss_pred:0.014743934385478497, decouple_loss:0.0018280500080436468
The modified gen p mean: 0.44946280121803284, gen p mean: -0.23254886269569397, mean p set: 0.45003435015678406
The modified gen p mean: 0.4483959674835205, gen p mean: -0.22986054420471191, mean p set: 0.44897210597991943
loss_pred:0.014140399172902107, decouple_loss:0.0015911335358396173
loss_pred:0.014513297937810421, decouple_loss:0.0018958791624754667
Iteration: 4253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500235617160797, gen p mean: -0.22679662704467773, mean p set: 0.45054665207862854
loss_pred:0.014131603762507439, decouple_loss:0.0020640362054109573
The modified gen p mean: 0.4490625262260437, gen p mean: -0.22557909786701202, mean p set: 0.44964277744293213
The modified gen p mean: 0.4497305154800415, gen p mean: -0.2277960628271103, mean p set: 0.450310081243515
loss_pred:0.01448731403797865, decouple_loss:0.0019035472068935633
loss_pred:0.014527153223752975, decouple_loss:0.0019028499955311418
Iteration: 4254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474661946296692, gen p mean: -0.23616914451122284, mean p set: 0.4480412006378174
loss_pred:0.014532539993524551, decouple_loss:0.0018650739220902324
The modified gen p mean: 0.44777360558509827, gen p mean: -0.23322434723377228, mean p set: 0.44834738969802856The modified gen p mean: 0.448228120803833, gen p mean: -0.23471008241176605, mean p set: 0.4487546384334564
loss_pred:0.014084411785006523, decouple_loss:0.0019305131863802671loss_pred:0.014608941040933132, decouple_loss:0.0019979055505245924
Iteration: 4255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829878211021423, gen p mean: -0.22595052421092987, mean p set: 0.4488753378391266
loss_pred:0.014573287218809128, decouple_loss:0.0019041090272367
The modified gen p mean: 0.4484817683696747, gen p mean: -0.23137536644935608, mean p set: 0.4490082263946533The modified gen p mean: 0.4481378495693207, gen p mean: -0.2338082641363144, mean p set: 0.44871246814727783
loss_pred:0.014015763066709042, decouple_loss:0.0020106679294258356loss_pred:0.014685245230793953, decouple_loss:0.0017252587713301182
Iteration: 4256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782906770706177, gen p mean: -0.22046995162963867, mean p set: 0.4484051764011383
loss_pred:0.014234011992812157, decouple_loss:0.0020511255133897066
The modified gen p mean: 0.44900214672088623, gen p mean: -0.22678309679031372, mean p set: 0.4495806396007538
loss_pred:0.013722811825573444, decouple_loss:0.0019488261314108968
The modified gen p mean: 0.4484885036945343, gen p mean: -0.22092406451702118, mean p set: 0.44901344180107117
loss_pred:0.014381290413439274, decouple_loss:0.0020939575042575598
Iteration: 4257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001354813575745, gen p mean: -0.22827576100826263, mean p set: 0.45059165358543396
loss_pred:0.014586525037884712, decouple_loss:0.0018404913134872913
The modified gen p mean: 0.44952189922332764, gen p mean: -0.22323957085609436, mean p set: 0.4500974118709564
loss_pred:0.014044089242815971, decouple_loss:0.0017915925709530711
The modified gen p mean: 0.4491712749004364, gen p mean: -0.22447329759597778, mean p set: 0.4496983587741852
loss_pred:0.014628508128225803, decouple_loss:0.0020373445004224777
Iteration: 4258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785240292549133, gen p mean: -0.22695225477218628, mean p set: 0.44842392206192017
loss_pred:0.014154363423585892, decouple_loss:0.001696316059678793
The modified gen p mean: 0.44948574900627136, gen p mean: -0.2197810560464859, mean p set: 0.4500153958797455The modified gen p mean: 0.4492136836051941, gen p mean: -0.22550266981124878, mean p set: 0.4497894048690796
loss_pred:0.014082534238696098, decouple_loss:0.0017659544246271253
loss_pred:0.013722645118832588, decouple_loss:0.0021917964331805706
Iteration: 4259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493577480316162, gen p mean: -0.22738109529018402, mean p set: 0.4499303698539734
loss_pred:0.014797751791775227, decouple_loss:0.001912177773192525
The modified gen p mean: 0.44914308190345764, gen p mean: -0.22602802515029907, mean p set: 0.44971972703933716
loss_pred:0.014172794297337532, decouple_loss:0.0016406853683292866
The modified gen p mean: 0.4488458037376404, gen p mean: -0.22234970331192017, mean p set: 0.4493807256221771
loss_pred:0.01410351600497961, decouple_loss:0.0018461375730112195
Iteration: 4260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842350482940674, gen p mean: -0.22282715141773224, mean p set: 0.4489958584308624
loss_pred:0.014416525140404701, decouple_loss:0.002001199871301651
The modified gen p mean: 0.4494628310203552, gen p mean: -0.22574563324451447, mean p set: 0.45004376769065857
loss_pred:0.013306550681591034, decouple_loss:0.0018931191880255938
The modified gen p mean: 0.4485715627670288, gen p mean: -0.22776049375534058, mean p set: 0.44910159707069397
loss_pred:0.014230011031031609, decouple_loss:0.0019411254907026887
2023-04-27 21:21:49 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23015587031841278, mean p set: 0.4499112665653229
loss_pred:0.015843309462070465, decouple_loss:0.001968413358554244
The modified gen p mean: 0.4482225477695465, gen p mean: -0.2271781861782074, mean p set: 0.44879910349845886
loss_pred:0.01570121757686138, decouple_loss:0.0018679248169064522
The modified gen p mean: 0.44930002093315125, gen p mean: -0.2299472987651825, mean p set: 0.4498290419578552
loss_pred:0.015359355136752129, decouple_loss:0.0019166253041476011
WV_1_PC_1_EH_0_PS_30, loss: 0.015730511397123337, avg_mse: 0.023383837193250656
current test mse: 0.023384
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 4261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766348600387573, gen p mean: -0.22868524491786957, mean p set: 0.4481982886791229
loss_pred:0.01408349722623825, decouple_loss:0.0019567166455090046
The modified gen p mean: 0.4471045136451721, gen p mean: -0.2334018349647522, mean p set: 0.4476828873157501
loss_pred:0.013865474611520767, decouple_loss:0.001782938139513135
The modified gen p mean: 0.44760170578956604, gen p mean: -0.23308582603931427, mean p set: 0.44817450642585754
loss_pred:0.014315079897642136, decouple_loss:0.002030463656410575
Iteration: 4262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862326979637146, gen p mean: -0.2287733554840088, mean p set: 0.4491502642631531
loss_pred:0.014308780431747437, decouple_loss:0.002404258819296956
The modified gen p mean: 0.44780126214027405, gen p mean: -0.2293076515197754, mean p set: 0.44837847352027893
loss_pred:0.013963320292532444, decouple_loss:0.0020032336469739676
The modified gen p mean: 0.44760632514953613, gen p mean: -0.22746622562408447, mean p set: 0.4481825828552246
loss_pred:0.013732103630900383, decouple_loss:0.002097463235259056
Iteration: 4263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558167457580566, gen p mean: -0.22894181311130524, mean p set: 0.4461096227169037
loss_pred:0.014151616021990776, decouple_loss:0.0017917038640007377
The modified gen p mean: 0.446187824010849, gen p mean: -0.2272460162639618, mean p set: 0.44676437973976135
loss_pred:0.013946997933089733, decouple_loss:0.0018660466885194182
The modified gen p mean: 0.44761115312576294, gen p mean: -0.2275400161743164, mean p set: 0.4481835961341858
loss_pred:0.014132855460047722, decouple_loss:0.0019706240855157375
Iteration: 4264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472387433052063, gen p mean: -0.23489084839820862, mean p set: 0.4477669298648834
loss_pred:0.014204875566065311, decouple_loss:0.0020658248104155064
The modified gen p mean: 0.44859373569488525, gen p mean: -0.22593826055526733, mean p set: 0.44917070865631104
loss_pred:0.014220683835446835, decouple_loss:0.00222375919111073
The modified gen p mean: 0.44733405113220215, gen p mean: -0.22762158513069153, mean p set: 0.4479072690010071
loss_pred:0.014274726621806622, decouple_loss:0.0020766831003129482
Iteration: 4265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768938422203064, gen p mean: -0.22929708659648895, mean p set: 0.4482652246952057
loss_pred:0.013909520581364632, decouple_loss:0.0018158231396228075
The modified gen p mean: 0.44751182198524475, gen p mean: -0.22948957979679108, mean p set: 0.4480895698070526The modified gen p mean: 0.44727247953414917, gen p mean: -0.23506684601306915, mean p set: 0.44780340790748596
loss_pred:0.013790751807391644, decouple_loss:0.0018361207330599427
loss_pred:0.01416504755616188, decouple_loss:0.0021407457534223795
Iteration: 4266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476824998855591, gen p mean: -0.2329028993844986, mean p set: 0.4482133686542511
loss_pred:0.014109906740486622, decouple_loss:0.0019170186715200543
The modified gen p mean: 0.4474582374095917, gen p mean: -0.23225577175617218, mean p set: 0.4480327069759369
loss_pred:0.013624165207147598, decouple_loss:0.0019311981741338968
The modified gen p mean: 0.44802597165107727, gen p mean: -0.2303018867969513, mean p set: 0.44860079884529114
loss_pred:0.01402471773326397, decouple_loss:0.002127928426489234
Iteration: 4267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475550055503845, gen p mean: -0.23846907913684845, mean p set: 0.44813501834869385
loss_pred:0.014501453377306461, decouple_loss:0.0017223581671714783
The modified gen p mean: 0.4477308392524719, gen p mean: -0.23591670393943787, mean p set: 0.4483039677143097The modified gen p mean: 0.44685986638069153, gen p mean: -0.23988744616508484, mean p set: 0.4473881721496582
loss_pred:0.013595301657915115, decouple_loss:0.001832306501455605
loss_pred:0.014041410759091377, decouple_loss:0.0017529367469251156
Iteration: 4268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474268853664398, gen p mean: -0.23598836362361908, mean p set: 0.44800058007240295
loss_pred:0.013491897843778133, decouple_loss:0.0018929210491478443
The modified gen p mean: 0.4467654228210449, gen p mean: -0.23852607607841492, mean p set: 0.4473342299461365The modified gen p mean: 0.4486057758331299, gen p mean: -0.2310546189546585, mean p set: 0.44913291931152344
loss_pred:0.014102068729698658, decouple_loss:0.0018286120612174273
loss_pred:0.014484909363090992, decouple_loss:0.002114439383149147
Iteration: 4269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828730821609497, gen p mean: -0.23356421291828156, mean p set: 0.44886934757232666
loss_pred:0.013601514510810375, decouple_loss:0.0018524406477808952
The modified gen p mean: 0.44807371497154236, gen p mean: -0.22954493761062622, mean p set: 0.4486541748046875
loss_pred:0.01417978573590517, decouple_loss:0.00197035470046103
The modified gen p mean: 0.44718629121780396, gen p mean: -0.2320948988199234, mean p set: 0.4477144777774811
loss_pred:0.013708419166505337, decouple_loss:0.001663666102103889
Iteration: 4270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467802941799164, gen p mean: -0.2289121001958847, mean p set: 0.4473542869091034
loss_pred:0.013813149183988571, decouple_loss:0.0017684692284092307
The modified gen p mean: 0.44725269079208374, gen p mean: -0.2347753494977951, mean p set: 0.44778600335121155The modified gen p mean: 0.4486745297908783, gen p mean: -0.22732968628406525, mean p set: 0.44924822449684143
loss_pred:0.013606628403067589, decouple_loss:0.00189938023686409
loss_pred:0.013979132287204266, decouple_loss:0.0018443561857566237
2023-04-27 21:25:46 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23363447189331055, mean p set: 0.4499112665653229
loss_pred:0.015838025137782097, decouple_loss:0.0018227308755740523
The modified gen p mean: 0.44822320342063904, gen p mean: -0.23091106116771698, mean p set: 0.44879910349845886
loss_pred:0.015648076310753822, decouple_loss:0.001824353588744998
The modified gen p mean: 0.4492988884449005, gen p mean: -0.2337826043367386, mean p set: 0.4498290419578552
loss_pred:0.015334269031882286, decouple_loss:0.0018395278602838516
WV_1_PC_1_EH_0_PS_30, loss: 0.015698235481977463, avg_mse: 0.02330685220658779
current test mse: 0.023307
Iteration: 4271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469331204891205, gen p mean: -0.23684284090995789, mean p set: 0.4475003480911255
loss_pred:0.013868164271116257, decouple_loss:0.0017951468471437693
The modified gen p mean: 0.4479893147945404, gen p mean: -0.23523858189582825, mean p set: 0.44852009415626526
loss_pred:0.01367773674428463, decouple_loss:0.0018896919209510088
The modified gen p mean: 0.44732165336608887, gen p mean: -0.23379528522491455, mean p set: 0.44789940118789673
loss_pred:0.014408317394554615, decouple_loss:0.001902479212731123
Iteration: 4272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643527269363403, gen p mean: -0.2390870898962021, mean p set: 0.44695839285850525
loss_pred:0.013930771499872208, decouple_loss:0.0016687300521880388
The modified gen p mean: 0.4485466182231903, gen p mean: -0.23046213388442993, mean p set: 0.4491216838359833
loss_pred:0.013641982339322567, decouple_loss:0.0018681997898966074
The modified gen p mean: 0.44628801941871643, gen p mean: -0.23828978836536407, mean p set: 0.4468632936477661
loss_pred:0.013994124718010426, decouple_loss:0.001796453958377242
Iteration: 4273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757285714149475, gen p mean: -0.24221505224704742, mean p set: 0.4481063485145569
loss_pred:0.014350504614412785, decouple_loss:0.0018879079725593328
The modified gen p mean: 0.4470948874950409, gen p mean: -0.2457234114408493, mean p set: 0.4476650059223175
loss_pred:0.014161759056150913, decouple_loss:0.0018488640198484063
The modified gen p mean: 0.4478163719177246, gen p mean: -0.24229107797145844, mean p set: 0.44838836789131165
loss_pred:0.013557316735386848, decouple_loss:0.0018535176059231162
Iteration: 4274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467240273952484, gen p mean: -0.24278734624385834, mean p set: 0.4472596049308777
loss_pred:0.014148922637104988, decouple_loss:0.0015948220388963819
The modified gen p mean: 0.44780218601226807, gen p mean: -0.24320530891418457, mean p set: 0.4483788311481476
loss_pred:0.014299033209681511, decouple_loss:0.0016784691251814365
The modified gen p mean: 0.44835934042930603, gen p mean: -0.24568521976470947, mean p set: 0.448940247297287
loss_pred:0.014025731943547726, decouple_loss:0.0019228416495025158
Iteration: 4275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718801975250244, gen p mean: -0.2460515946149826, mean p set: 0.4477671980857849
loss_pred:0.013929513283073902, decouple_loss:0.0019461724441498518
The modified gen p mean: 0.44689393043518066, gen p mean: -0.24610093235969543, mean p set: 0.4474206268787384The modified gen p mean: 0.4480321407318115, gen p mean: -0.24378329515457153, mean p set: 0.44860121607780457
loss_pred:0.01404871977865696, decouple_loss:0.0019197473302483559
loss_pred:0.013329665176570415, decouple_loss:0.0018553945701569319
Iteration: 4276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734156131744385, gen p mean: -0.2390098124742508, mean p set: 0.44791606068611145
loss_pred:0.014284174889326096, decouple_loss:0.0017769457772374153
The modified gen p mean: 0.4479197859764099, gen p mean: -0.23421184718608856, mean p set: 0.4484962224960327The modified gen p mean: 0.4467419385910034, gen p mean: -0.2411048710346222, mean p set: 0.44727250933647156
loss_pred:0.014014954678714275, decouple_loss:0.0018720029620453715
loss_pred:0.014058119617402554, decouple_loss:0.0016704737208783627
Iteration: 4277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804269075393677, gen p mean: -0.23853141069412231, mean p set: 0.44862261414527893
loss_pred:0.01363359484821558, decouple_loss:0.0017011967720463872
The modified gen p mean: 0.4477734863758087, gen p mean: -0.23915383219718933, mean p set: 0.4483005702495575The modified gen p mean: 0.44737595319747925, gen p mean: -0.24121281504631042, mean p set: 0.4479547441005707
loss_pred:0.013553372584283352, decouple_loss:0.0015854709781706333
loss_pred:0.014512025751173496, decouple_loss:0.0015889467904344201
Iteration: 4278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476419687271118, gen p mean: -0.23535259068012238, mean p set: 0.44821637868881226
loss_pred:0.014072136022150517, decouple_loss:0.0017876316560432315
The modified gen p mean: 0.4464527368545532, gen p mean: -0.2405441701412201, mean p set: 0.4470282196998596
loss_pred:0.013880901038646698, decouple_loss:0.0016632647020742297
The modified gen p mean: 0.44698721170425415, gen p mean: -0.23787087202072144, mean p set: 0.4475173056125641
loss_pred:0.014043554663658142, decouple_loss:0.0017097380477935076
Iteration: 4279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458785653114319, gen p mean: -0.23791129887104034, mean p set: 0.44645851850509644
loss_pred:0.013767997734248638, decouple_loss:0.0015686022816225886
The modified gen p mean: 0.44879236817359924, gen p mean: -0.23523959517478943, mean p set: 0.44937047362327576
loss_pred:0.014238603413105011, decouple_loss:0.0018481715815141797
The modified gen p mean: 0.4473917484283447, gen p mean: -0.2404232770204544, mean p set: 0.4479212760925293
loss_pred:0.013745439238846302, decouple_loss:0.0016841702163219452
Iteration: 4280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739001989364624, gen p mean: -0.2426903247833252, mean p set: 0.4479711353778839
loss_pred:0.013984995894134045, decouple_loss:0.0018553892150521278
The modified gen p mean: 0.4469100534915924, gen p mean: -0.24471089243888855, mean p set: 0.4474402070045471The modified gen p mean: 0.448403000831604, gen p mean: -0.24297426640987396, mean p set: 0.44897761940956116
loss_pred:0.013736320659518242, decouple_loss:0.0017174488166347146
loss_pred:0.014254191890358925, decouple_loss:0.0018186499364674091
2023-04-27 21:29:11 testing...
The modified gen p mean: 0.4482252299785614, gen p mean: -0.23998256027698517, mean p set: 0.44879910349845886
loss_pred:0.01566401869058609, decouple_loss:0.0016723442822694778
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24269315600395203, mean p set: 0.4499112665653229
loss_pred:0.015808705240488052, decouple_loss:0.0017669922672212124
The modified gen p mean: 0.449307382106781, gen p mean: -0.24313569068908691, mean p set: 0.4498290419578552
loss_pred:0.015264799818396568, decouple_loss:0.0016587924910709262
WV_1_PC_1_EH_0_PS_30, loss: 0.01566414348781109, avg_mse: 0.023283204063773155
current test mse: 0.023283
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 4281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833698868751526, gen p mean: -0.24019579589366913, mean p set: 0.4488748610019684
loss_pred:0.014954470098018646, decouple_loss:0.001845248625613749
The modified gen p mean: 0.4481196701526642, gen p mean: -0.24137356877326965, mean p set: 0.44869574904441833
The modified gen p mean: 0.4460870325565338, gen p mean: -0.24069616198539734, mean p set: 0.44665804505348206
loss_pred:0.014388415031135082, decouple_loss:0.0020861895754933357
loss_pred:0.014106309972703457, decouple_loss:0.0016844611382111907
Iteration: 4282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480751156806946, gen p mean: -0.24342504143714905, mean p set: 0.44860541820526123
loss_pred:0.014565645717084408, decouple_loss:0.0017291093245148659
The modified gen p mean: 0.44715526700019836, gen p mean: -0.24480222165584564, mean p set: 0.4477330446243286
loss_pred:0.014308406040072441, decouple_loss:0.0017373524606227875
The modified gen p mean: 0.44871029257774353, gen p mean: -0.2441992163658142, mean p set: 0.44929543137550354
loss_pred:0.01398029737174511, decouple_loss:0.0018729458097368479
Iteration: 4283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468095004558563, gen p mean: -0.24859338998794556, mean p set: 0.4473358392715454
loss_pred:0.014080850407481194, decouple_loss:0.00168863614089787
The modified gen p mean: 0.4491514563560486, gen p mean: -0.24746352434158325, mean p set: 0.4497232735157013
loss_pred:0.013797909021377563, decouple_loss:0.0017243039328604937
The modified gen p mean: 0.4469597339630127, gen p mean: -0.24991263449192047, mean p set: 0.4475356340408325
loss_pred:0.013931866735219955, decouple_loss:0.001631850260309875
Iteration: 4284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482876658439636, gen p mean: -0.24559712409973145, mean p set: 0.4488097131252289
loss_pred:0.014268383383750916, decouple_loss:0.0017863619141280651
The modified gen p mean: 0.4481440484523773, gen p mean: -0.24548611044883728, mean p set: 0.44871997833251953
loss_pred:0.013792158104479313, decouple_loss:0.001732569420710206
The modified gen p mean: 0.4463199973106384, gen p mean: -0.2474404275417328, mean p set: 0.4468948543071747
loss_pred:0.01386742852628231, decouple_loss:0.001663694274611771
Iteration: 4285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847190380096436, gen p mean: -0.24613814055919647, mean p set: 0.44904476404190063
loss_pred:0.014380192384123802, decouple_loss:0.0017606233013793826
The modified gen p mean: 0.45010730624198914, gen p mean: -0.2455766499042511, mean p set: 0.4506426155567169The modified gen p mean: 0.44749632477760315, gen p mean: -0.25151461362838745, mean p set: 0.4480707347393036
loss_pred:0.01491604559123516, decouple_loss:0.0020995086524635553
loss_pred:0.014131762087345123, decouple_loss:0.0022337790578603745
Iteration: 4286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475376009941101, gen p mean: -0.2450023889541626, mean p set: 0.4481089115142822
loss_pred:0.014906002208590508, decouple_loss:0.0019027820089831948
The modified gen p mean: 0.44789668917655945, gen p mean: -0.24412977695465088, mean p set: 0.44843170046806335The modified gen p mean: 0.44653621315956116, gen p mean: -0.24242931604385376, mean p set: 0.447110116481781
loss_pred:0.014893717132508755, decouple_loss:0.0018694736063480377
loss_pred:0.013822226785123348, decouple_loss:0.0018744005355983973
Iteration: 4287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790953397750854, gen p mean: -0.2428925782442093, mean p set: 0.4484834671020508
loss_pred:0.014018815942108631, decouple_loss:0.00183983298484236
The modified gen p mean: 0.4489520788192749, gen p mean: -0.24789530038833618, mean p set: 0.44952166080474854The modified gen p mean: 0.44673579931259155, gen p mean: -0.2426619976758957, mean p set: 0.44726231694221497
loss_pred:0.013878215104341507, decouple_loss:0.0018642236245796084
loss_pred:0.015122617594897747, decouple_loss:0.0020749352406710386
Iteration: 4288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481205940246582, gen p mean: -0.24090516567230225, mean p set: 0.4486992359161377
loss_pred:0.014636252075433731, decouple_loss:0.001953128958120942
The modified gen p mean: 0.4470638930797577, gen p mean: -0.2446012645959854, mean p set: 0.4476448595523834
loss_pred:0.014282390475273132, decouple_loss:0.0017668132204562426
The modified gen p mean: 0.44686615467071533, gen p mean: -0.24629166722297668, mean p set: 0.4473958909511566
loss_pred:0.014063525013625622, decouple_loss:0.0018095773411914706
Iteration: 4289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481534957885742, gen p mean: -0.24366571009159088, mean p set: 0.4487282633781433
loss_pred:0.01417835894972086, decouple_loss:0.002466342179104686
The modified gen p mean: 0.4475820064544678, gen p mean: -0.23975107073783875, mean p set: 0.4481564164161682
loss_pred:0.013896040618419647, decouple_loss:0.002209530910477042
The modified gen p mean: 0.4469735026359558, gen p mean: -0.2453012615442276, mean p set: 0.44750893115997314
loss_pred:0.01372616458684206, decouple_loss:0.002394425682723522
Iteration: 4290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730865955352783, gen p mean: -0.24278141558170319, mean p set: 0.4478845000267029
loss_pred:0.01369207352399826, decouple_loss:0.0019234721548855305
The modified gen p mean: 0.4477420151233673, gen p mean: -0.24659591913223267, mean p set: 0.4483180344104767
loss_pred:0.014788882806897163, decouple_loss:0.0019267771858721972
The modified gen p mean: 0.4484982192516327, gen p mean: -0.24464310705661774, mean p set: 0.4490198791027069
loss_pred:0.01426820270717144, decouple_loss:0.0018276687478646636
2023-04-27 21:33:13 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23890239000320435, mean p set: 0.4499112665653229
loss_pred:0.015704574063420296, decouple_loss:0.0026142331771552563
The modified gen p mean: 0.4493045210838318, gen p mean: -0.23903115093708038, mean p set: 0.4498290419578552
loss_pred:0.015196039341390133, decouple_loss:0.002370665082708001
The modified gen p mean: 0.44822245836257935, gen p mean: -0.2362971305847168, mean p set: 0.44879910349845886
loss_pred:0.015535427257418633, decouple_loss:0.002308206632733345
WV_1_PC_1_EH_0_PS_30, loss: 0.015600232407450676, avg_mse: 0.02308042161166668
current test mse: 0.02308
Iteration: 4291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481416642665863, gen p mean: -0.24121986329555511, mean p set: 0.4487214982509613
loss_pred:0.014376525767147541, decouple_loss:0.0024538361467421055
The modified gen p mean: 0.4483124911785126, gen p mean: -0.23887957632541656, mean p set: 0.4488431215286255
loss_pred:0.013719686307013035, decouple_loss:0.0029771295376122
The modified gen p mean: 0.44761332869529724, gen p mean: -0.23469161987304688, mean p set: 0.4481905400753021
loss_pred:0.014277919195592403, decouple_loss:0.002596060046926141
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695380330085754, gen p mean: -0.24392612278461456, mean p set: 0.4474853575229645
loss_pred:0.013630257919430733, decouple_loss:0.0019222364062443376
The modified gen p mean: 0.447033554315567, gen p mean: -0.24091048538684845, mean p set: 0.4476125240325928
The modified gen p mean: 0.4484313428401947, gen p mean: -0.24080705642700195, mean p set: 0.44900330901145935
loss_pred:0.014130772091448307, decouple_loss:0.0020058632362633944
loss_pred:0.01369068119674921, decouple_loss:0.0018945456249639392
Iteration: 4293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737565517425537, gen p mean: -0.24458767473697662, mean p set: 0.4479025602340698
loss_pred:0.01386525109410286, decouple_loss:0.0017784328665584326
The modified gen p mean: 0.44945934414863586, gen p mean: -0.2403324395418167, mean p set: 0.4500364065170288
The modified gen p mean: 0.4480014741420746, gen p mean: -0.24145901203155518, mean p set: 0.4485693573951721
loss_pred:0.013843147084116936, decouple_loss:0.001918636029586196
loss_pred:0.013609041459858418, decouple_loss:0.0019515396561473608
Iteration: 4294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749221205711365, gen p mean: -0.23905867338180542, mean p set: 0.4480155408382416
loss_pred:0.015302412211894989, decouple_loss:0.0020221490412950516
The modified gen p mean: 0.4490893483161926, gen p mean: -0.2427920401096344, mean p set: 0.449665904045105
The modified gen p mean: 0.4469798803329468, gen p mean: -0.23923660814762115, mean p set: 0.44755110144615173
loss_pred:0.013436454348266125, decouple_loss:0.0017069396562874317
loss_pred:0.014401421882212162, decouple_loss:0.0018227632390335202
Iteration: 4295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467911124229431, gen p mean: -0.2399059236049652, mean p set: 0.447368323802948
loss_pred:0.01435468066483736, decouple_loss:0.00217234599404037
The modified gen p mean: 0.4476946294307709, gen p mean: -0.24074068665504456, mean p set: 0.4482649564743042The modified gen p mean: 0.4479447603225708, gen p mean: -0.23839165270328522, mean p set: 0.448472261428833
loss_pred:0.014093236066401005, decouple_loss:0.0020857946947216988
loss_pred:0.013741481117904186, decouple_loss:0.002151076914742589
Iteration: 4296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465533196926117, gen p mean: -0.24214127659797668, mean p set: 0.4471263289451599
loss_pred:0.013506049290299416, decouple_loss:0.0017338936449959874
The modified gen p mean: 0.44673022627830505, gen p mean: -0.24438154697418213, mean p set: 0.447309285402298
loss_pred:0.013623378239572048, decouple_loss:0.0017506153089925647
The modified gen p mean: 0.4460981488227844, gen p mean: -0.24095116555690765, mean p set: 0.4466237425804138
loss_pred:0.014193655923008919, decouple_loss:0.001780046382918954
Iteration: 4297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775184988975525, gen p mean: -0.2401038110256195, mean p set: 0.44832107424736023
loss_pred:0.01486553717404604, decouple_loss:0.002308162394911051
The modified gen p mean: 0.4483427107334137, gen p mean: -0.23384439945220947, mean p set: 0.4489106833934784The modified gen p mean: 0.448869913816452, gen p mean: -0.23887130618095398, mean p set: 0.44939976930618286
loss_pred:0.014270667918026447, decouple_loss:0.002401910023763776
loss_pred:0.014132381416857243, decouple_loss:0.0029688472859561443
Iteration: 4298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478386640548706, gen p mean: -0.2330242097377777, mean p set: 0.44841471314430237
loss_pred:0.014341093599796295, decouple_loss:0.001869673258624971
The modified gen p mean: 0.4476756751537323, gen p mean: -0.23944289982318878, mean p set: 0.4482479691505432
loss_pred:0.014358432963490486, decouple_loss:0.002150492509827018
The modified gen p mean: 0.44939127564430237, gen p mean: -0.2377973198890686, mean p set: 0.4499242305755615
loss_pred:0.013967635110020638, decouple_loss:0.002048338996246457
Iteration: 4299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797414541244507, gen p mean: -0.23862510919570923, mean p set: 0.4485537111759186
loss_pred:0.015096547082066536, decouple_loss:0.0023467536084353924
The modified gen p mean: 0.4476202428340912, gen p mean: -0.23874521255493164, mean p set: 0.44819900393486023
loss_pred:0.014032663777470589, decouple_loss:0.0022717989049851894
The modified gen p mean: 0.4479805529117584, gen p mean: -0.23658326268196106, mean p set: 0.4485156238079071
loss_pred:0.013505307026207447, decouple_loss:0.001973764505237341
Iteration: 4300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961175322532654, gen p mean: -0.242714524269104, mean p set: 0.45018208026885986
loss_pred:0.012998073361814022, decouple_loss:0.0020867970306426287
The modified gen p mean: 0.44998955726623535, gen p mean: -0.24029406905174255, mean p set: 0.4505683481693268
loss_pred:0.013575238175690174, decouple_loss:0.0020685046911239624
The modified gen p mean: 0.4458354711532593, gen p mean: -0.23716861009597778, mean p set: 0.44636374711990356
loss_pred:0.014025505632162094, decouple_loss:0.002381271915510297
2023-04-27 21:36:37 testing...
The modified gen p mean: 0.44821929931640625, gen p mean: -0.2393118441104889, mean p set: 0.44879910349845886
loss_pred:0.015574171207845211, decouple_loss:0.0026503368280828
The modified gen p mean: 0.4493057429790497, gen p mean: -0.24224591255187988, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24193623661994934, mean p set: 0.4499112665653229loss_pred:0.015194013714790344, decouple_loss:0.002698728581890464
loss_pred:0.0157335102558136, decouple_loss:0.0025815328117460012
WV_1_PC_1_EH_0_PS_30, loss: 0.015632741153240204, avg_mse: 0.023094352334737778
current test mse: 0.023094
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 4301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808655977249146, gen p mean: -0.24036556482315063, mean p set: 0.44861549139022827
loss_pred:0.014454100281000137, decouple_loss:0.002344514476135373
The modified gen p mean: 0.4457588195800781, gen p mean: -0.24199655652046204, mean p set: 0.4463306665420532
The modified gen p mean: 0.44578319787979126, gen p mean: -0.24299092590808868, mean p set: 0.44635844230651855
loss_pred:0.014489575289189816, decouple_loss:0.0027088522911071777
loss_pred:0.014477168209850788, decouple_loss:0.002605266170576215
Iteration: 4302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477894604206085, gen p mean: -0.24286921322345734, mean p set: 0.44831427931785583
loss_pred:0.014456343837082386, decouple_loss:0.00203096610493958
The modified gen p mean: 0.4477614462375641, gen p mean: -0.24716566503047943, mean p set: 0.4483422338962555
The modified gen p mean: 0.44717392325401306, gen p mean: -0.24691443145275116, mean p set: 0.44775307178497314
loss_pred:0.014248467050492764, decouple_loss:0.0020526275038719177
loss_pred:0.01341010071337223, decouple_loss:0.0020185436587780714
Iteration: 4303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478292465209961, gen p mean: -0.24701851606369019, mean p set: 0.4483581483364105
loss_pred:0.013685287907719612, decouple_loss:0.002070464426651597
The modified gen p mean: 0.446639746427536, gen p mean: -0.24450774490833282, mean p set: 0.44721704721450806The modified gen p mean: 0.4470260441303253, gen p mean: -0.24776606261730194, mean p set: 0.4476129114627838
loss_pred:0.014115736819803715, decouple_loss:0.002224583877250552
loss_pred:0.014959551393985748, decouple_loss:0.002264623763039708
Iteration: 4304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639670848846436, gen p mean: -0.2531728148460388, mean p set: 0.44696754217147827
loss_pred:0.013623167760670185, decouple_loss:0.002152383327484131
The modified gen p mean: 0.44693103432655334, gen p mean: -0.24901340901851654, mean p set: 0.4474574029445648The modified gen p mean: 0.44762519001960754, gen p mean: -0.25277066230773926, mean p set: 0.4481981694698334
loss_pred:0.014260134659707546, decouple_loss:0.002077300101518631
loss_pred:0.014926793985068798, decouple_loss:0.0022238921374082565
Iteration: 4305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44635146856307983, gen p mean: -0.2537601888179779, mean p set: 0.44692835211753845
loss_pred:0.014371713623404503, decouple_loss:0.0020123780705034733
The modified gen p mean: 0.44717562198638916, gen p mean: -0.24331171810626984, mean p set: 0.4477542042732239
loss_pred:0.014848843216896057, decouple_loss:0.002106362022459507
The modified gen p mean: 0.44628047943115234, gen p mean: -0.2474326342344284, mean p set: 0.44680383801460266
loss_pred:0.014321902766823769, decouple_loss:0.0021798352245241404
Iteration: 4306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471340775489807, gen p mean: -0.24817784130573273, mean p set: 0.44771286845207214
loss_pred:0.014056449756026268, decouple_loss:0.0018890176434069872
The modified gen p mean: 0.44650349020957947, gen p mean: -0.25205302238464355, mean p set: 0.44708412885665894The modified gen p mean: 0.4455256760120392, gen p mean: -0.24793541431427002, mean p set: 0.4460590183734894
loss_pred:0.01444762572646141, decouple_loss:0.0019479298498481512
loss_pred:0.014429883100092411, decouple_loss:0.0021905088797211647
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743236899375916, gen p mean: -0.23812778294086456, mean p set: 0.448009192943573
loss_pred:0.014691869728267193, decouple_loss:0.0020959312096238136
The modified gen p mean: 0.44850170612335205, gen p mean: -0.24686309695243835, mean p set: 0.44907715916633606
loss_pred:0.013885557651519775, decouple_loss:0.001750542433001101
The modified gen p mean: 0.4489809274673462, gen p mean: -0.24578754603862762, mean p set: 0.4495137631893158
loss_pred:0.014137174002826214, decouple_loss:0.0020725452341139317
Iteration: 4308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658106565475464, gen p mean: -0.24377955496311188, mean p set: 0.44716206192970276
loss_pred:0.01460630539804697, decouple_loss:0.0019776613917201757
The modified gen p mean: 0.44791150093078613, gen p mean: -0.24355167150497437, mean p set: 0.44844114780426025The modified gen p mean: 0.446873277425766, gen p mean: -0.23792286217212677, mean p set: 0.44744551181793213
loss_pred:0.014089669100940228, decouple_loss:0.0017096319934353232
loss_pred:0.014222808182239532, decouple_loss:0.0018960611196234822
Iteration: 4309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44587811827659607, gen p mean: -0.2476055771112442, mean p set: 0.446456640958786
loss_pred:0.014186755754053593, decouple_loss:0.0024122088216245174
The modified gen p mean: 0.4469207227230072, gen p mean: -0.24363738298416138, mean p set: 0.4474954903125763
loss_pred:0.014337669126689434, decouple_loss:0.002005940768867731
The modified gen p mean: 0.447143018245697, gen p mean: -0.24196843802928925, mean p set: 0.4476804733276367
loss_pred:0.014833660796284676, decouple_loss:0.0019772385712713003
Iteration: 4310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473641514778137, gen p mean: -0.24796593189239502, mean p set: 0.4479331374168396
loss_pred:0.014246581122279167, decouple_loss:0.0017623704625293612
The modified gen p mean: 0.4473537504673004, gen p mean: -0.24664217233657837, mean p set: 0.44793781638145447
loss_pred:0.014781295321881771, decouple_loss:0.0018739236984401941
The modified gen p mean: 0.44492900371551514, gen p mean: -0.25109589099884033, mean p set: 0.4454576373100281
loss_pred:0.014345643110573292, decouple_loss:0.0017225834308192134
2023-04-27 21:40:43 testing...
The modified gen p mean: 0.449430912733078, gen p mean: -0.2465522736310959, mean p set: 0.4499112665653229
loss_pred:0.015748165547847748, decouple_loss:0.0024028318002820015
The modified gen p mean: 0.44930315017700195, gen p mean: -0.24652639031410217, mean p set: 0.4498290419578552
loss_pred:0.015239591710269451, decouple_loss:0.0025829016231000423
The modified gen p mean: 0.44822317361831665, gen p mean: -0.24383626878261566, mean p set: 0.44879910349845886
loss_pred:0.015663085505366325, decouple_loss:0.0024264538660645485
WV_1_PC_1_EH_0_PS_30, loss: 0.015673818066716194, avg_mse: 0.02320292219519615
current test mse: 0.023203
Iteration: 4311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468385577201843, gen p mean: -0.24586816132068634, mean p set: 0.44741740822792053
loss_pred:0.01500837691128254, decouple_loss:0.001935933600179851
The modified gen p mean: 0.4482337236404419, gen p mean: -0.24428987503051758, mean p set: 0.44876447319984436
loss_pred:0.013750467449426651, decouple_loss:0.002515575150027871
The modified gen p mean: 0.4471219778060913, gen p mean: -0.2506937086582184, mean p set: 0.44769522547721863
loss_pred:0.014364332892000675, decouple_loss:0.0019331697840243578
Iteration: 4312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464121460914612, gen p mean: -0.24365223944187164, mean p set: 0.44694095849990845
loss_pred:0.01486567035317421, decouple_loss:0.001695512211881578
The modified gen p mean: 0.4473186135292053, gen p mean: -0.2454734891653061, mean p set: 0.4478902518749237
The modified gen p mean: 0.44780823588371277, gen p mean: -0.24954529106616974, mean p set: 0.44838783144950867
loss_pred:0.01454932987689972, decouple_loss:0.0018222188809886575
loss_pred:0.014298932626843452, decouple_loss:0.001602920820005238
Iteration: 4313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781333208084106, gen p mean: -0.2414095103740692, mean p set: 0.44834378361701965
loss_pred:0.01404529344290495, decouple_loss:0.0017332225106656551
The modified gen p mean: 0.44635698199272156, gen p mean: -0.2422674149274826, mean p set: 0.4469318985939026
The modified gen p mean: 0.4449162483215332, gen p mean: -0.25064602494239807, mean p set: 0.44549062848091125
loss_pred:0.014411015436053276, decouple_loss:0.0020841718651354313
loss_pred:0.013943335972726345, decouple_loss:0.0020957174710929394
Iteration: 4314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466477930545807, gen p mean: -0.2414514422416687, mean p set: 0.44717955589294434
loss_pred:0.01403591874986887, decouple_loss:0.0017507376614958048
The modified gen p mean: 0.44570645689964294, gen p mean: -0.24035897850990295, mean p set: 0.4462839961051941
The modified gen p mean: 0.4465878903865814, gen p mean: -0.2404966503381729, mean p set: 0.44716131687164307
loss_pred:0.01409393921494484, decouple_loss:0.0016170284943655133
loss_pred:0.014494135975837708, decouple_loss:0.0015413863584399223
Iteration: 4315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470120966434479, gen p mean: -0.2395254224538803, mean p set: 0.44758957624435425
loss_pred:0.014341811649501324, decouple_loss:0.0020097082015126944
The modified gen p mean: 0.44755205512046814, gen p mean: -0.24256186187267303, mean p set: 0.44808200001716614The modified gen p mean: 0.44800516963005066, gen p mean: -0.24110297858715057, mean p set: 0.44858217239379883
loss_pred:0.013909907080233097, decouple_loss:0.0022779495920985937
loss_pred:0.013154923915863037, decouple_loss:0.0020510265603661537
Iteration: 4316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711947441101074, gen p mean: -0.24021190404891968, mean p set: 0.4477007985115051
loss_pred:0.014279089868068695, decouple_loss:0.0021040919236838818
The modified gen p mean: 0.4467676877975464, gen p mean: -0.2359856218099594, mean p set: 0.44729292392730713The modified gen p mean: 0.44845831394195557, gen p mean: -0.23465053737163544, mean p set: 0.4490286707878113
loss_pred:0.0147118354216218, decouple_loss:0.001941403141245246
loss_pred:0.014622174203395844, decouple_loss:0.001923750969581306
Iteration: 4317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454554319381714, gen p mean: -0.2483590692281723, mean p set: 0.44598105549812317
loss_pred:0.013912097550928593, decouple_loss:0.0017822823720052838
The modified gen p mean: 0.44682419300079346, gen p mean: -0.2418746054172516, mean p set: 0.44739776849746704
The modified gen p mean: 0.446134477853775, gen p mean: -0.2434556782245636, mean p set: 0.4467063546180725
loss_pred:0.014103587716817856, decouple_loss:0.0018795834621414542
loss_pred:0.014589586295187473, decouple_loss:0.0018839952535927296
Iteration: 4318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446450799703598, gen p mean: -0.24509337544441223, mean p set: 0.4470267593860626
loss_pred:0.014204212464392185, decouple_loss:0.0020150907803326845
The modified gen p mean: 0.44601762294769287, gen p mean: -0.24877458810806274, mean p set: 0.4465861916542053
loss_pred:0.01404570322483778, decouple_loss:0.002039902377873659
The modified gen p mean: 0.44622695446014404, gen p mean: -0.24611705541610718, mean p set: 0.446748286485672
loss_pred:0.014607609249651432, decouple_loss:0.0020388085395097733
Iteration: 4319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44619935750961304, gen p mean: -0.24848626554012299, mean p set: 0.4467789828777313
loss_pred:0.014371116645634174, decouple_loss:0.0018630068516358733
The modified gen p mean: 0.44830527901649475, gen p mean: -0.24902485311031342, mean p set: 0.448881059885025
loss_pred:0.014150755479931831, decouple_loss:0.0018069050274789333
The modified gen p mean: 0.44638052582740784, gen p mean: -0.24397441744804382, mean p set: 0.44690370559692383
loss_pred:0.014203513972461224, decouple_loss:0.0019775794353336096
Iteration: 4320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744616746902466, gen p mean: -0.2537011504173279, mean p set: 0.44802701473236084
loss_pred:0.012868458405137062, decouple_loss:0.0021522159222513437
The modified gen p mean: 0.44651803374290466, gen p mean: -0.25337958335876465, mean p set: 0.4470905363559723The modified gen p mean: 0.4476856589317322, gen p mean: -0.24894703924655914, mean p set: 0.448209285736084
loss_pred:0.014170235022902489, decouple_loss:0.002039751736447215
loss_pred:0.01381564699113369, decouple_loss:0.002037020167335868
2023-04-27 21:44:07 testing...
The modified gen p mean: 0.4482164978981018, gen p mean: -0.2425035983324051, mean p set: 0.44879910349845886
loss_pred:0.015646319836378098, decouple_loss:0.001993160927668214
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24524405598640442, mean p set: 0.4499112665653229
loss_pred:0.01577438786625862, decouple_loss:0.002115244511514902
The modified gen p mean: 0.44930118322372437, gen p mean: -0.24546460807323456, mean p set: 0.4498290419578552
loss_pred:0.015193955041468143, decouple_loss:0.002035043202340603
WV_1_PC_1_EH_0_PS_30, loss: 0.015640612691640854, avg_mse: 0.023221168667078018
current test mse: 0.023221
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 4321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858673214912415, gen p mean: -0.24443791806697845, mean p set: 0.44911760091781616
loss_pred:0.014196322299540043, decouple_loss:0.002199755050241947
The modified gen p mean: 0.4473312497138977, gen p mean: -0.24491195380687714, mean p set: 0.4479115903377533
loss_pred:0.014383100904524326, decouple_loss:0.0020295714493840933
The modified gen p mean: 0.4471549987792969, gen p mean: -0.2456837296485901, mean p set: 0.4477364122867584
loss_pred:0.014373953454196453, decouple_loss:0.00185448641423136
Iteration: 4322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893956184387207, gen p mean: -0.24166007339954376, mean p set: 0.4494645595550537
loss_pred:0.014263029210269451, decouple_loss:0.0019978112541139126
The modified gen p mean: 0.44945037364959717, gen p mean: -0.2464415282011032, mean p set: 0.450029194355011
loss_pred:0.014372332952916622, decouple_loss:0.0017192978411912918
The modified gen p mean: 0.4491139054298401, gen p mean: -0.2454751878976822, mean p set: 0.449685275554657
loss_pred:0.014194875955581665, decouple_loss:0.0017848144052550197
Iteration: 4323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492899179458618, gen p mean: -0.24004922807216644, mean p set: 0.44981372356414795
loss_pred:0.013735915534198284, decouple_loss:0.0018091258825734258
The modified gen p mean: 0.44777777791023254, gen p mean: -0.23830464482307434, mean p set: 0.4483604431152344
loss_pred:0.014223377220332623, decouple_loss:0.0018591711996123195
The modified gen p mean: 0.4479612410068512, gen p mean: -0.24184992909431458, mean p set: 0.44853806495666504
loss_pred:0.01383548229932785, decouple_loss:0.0017756727756932378
Iteration: 4324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486575722694397, gen p mean: -0.24384282529354095, mean p set: 0.4491857588291168
loss_pred:0.013981099240481853, decouple_loss:0.0017835497856140137
The modified gen p mean: 0.44863319396972656, gen p mean: -0.2422180324792862, mean p set: 0.4492073655128479
loss_pred:0.013697107322514057, decouple_loss:0.0017015578923746943
The modified gen p mean: 0.44746068120002747, gen p mean: -0.24391776323318481, mean p set: 0.44804278016090393
loss_pred:0.014560741372406483, decouple_loss:0.0016518671764060855
Iteration: 4325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487304091453552, gen p mean: -0.2505870759487152, mean p set: 0.44930675625801086
loss_pred:0.01409759372472763, decouple_loss:0.001968447817489505
The modified gen p mean: 0.44794338941574097, gen p mean: -0.24511206150054932, mean p set: 0.4484765827655792The modified gen p mean: 0.44829028844833374, gen p mean: -0.24689969420433044, mean p set: 0.44887199997901917
loss_pred:0.014258944429457188, decouple_loss:0.001922976109199226
loss_pred:0.014278238639235497, decouple_loss:0.0016127205453813076
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862812757492065, gen p mean: -0.24587567150592804, mean p set: 0.4492001235485077
loss_pred:0.013769195415079594, decouple_loss:0.00212326692417264
The modified gen p mean: 0.4479817748069763, gen p mean: -0.247076153755188, mean p set: 0.44855865836143494The modified gen p mean: 0.44800084829330444, gen p mean: -0.24939607083797455, mean p set: 0.4485251009464264
loss_pred:0.01421995647251606, decouple_loss:0.0018036660039797425
loss_pred:0.014497754164040089, decouple_loss:0.0017471573082730174
Iteration: 4327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809529185295105, gen p mean: -0.24857023358345032, mean p set: 0.4486764669418335
loss_pred:0.013637904077768326, decouple_loss:0.0023633698001503944
The modified gen p mean: 0.4480433762073517, gen p mean: -0.24870947003364563, mean p set: 0.44861912727355957
loss_pred:0.014190129935741425, decouple_loss:0.0019315009703859687
The modified gen p mean: 0.4495079815387726, gen p mean: -0.2537361681461334, mean p set: 0.45003825426101685
loss_pred:0.014158162288367748, decouple_loss:0.001838176161982119
Iteration: 4328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474961459636688, gen p mean: -0.2435348480939865, mean p set: 0.4480650722980499
loss_pred:0.013768887147307396, decouple_loss:0.0017106719315052032
The modified gen p mean: 0.4493732154369354, gen p mean: -0.24319341778755188, mean p set: 0.44995051622390747
loss_pred:0.014233045279979706, decouple_loss:0.0016006730729714036
The modified gen p mean: 0.4488387405872345, gen p mean: -0.24809585511684418, mean p set: 0.44937053322792053
loss_pred:0.014246250502765179, decouple_loss:0.001865409780293703
Iteration: 4329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448696494102478, gen p mean: -0.2453349083662033, mean p set: 0.44926580786705017
loss_pred:0.013964422047138214, decouple_loss:0.001933160237967968
The modified gen p mean: 0.44854164123535156, gen p mean: -0.24774105846881866, mean p set: 0.4491156041622162
loss_pred:0.014269168488681316, decouple_loss:0.0018208744004368782
The modified gen p mean: 0.44842585921287537, gen p mean: -0.25020137429237366, mean p set: 0.44895440340042114
loss_pred:0.013717166148126125, decouple_loss:0.0021592213306576014
Iteration: 4330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853347539901733, gen p mean: -0.2430098056793213, mean p set: 0.44910916686058044
loss_pred:0.014096446335315704, decouple_loss:0.0018160301260650158
The modified gen p mean: 0.44803136587142944, gen p mean: -0.24500080943107605, mean p set: 0.44856706261634827The modified gen p mean: 0.44792497158050537, gen p mean: -0.2439330369234085, mean p set: 0.4484924077987671
loss_pred:0.014230477623641491, decouple_loss:0.0018050571670755744
loss_pred:0.014093578793108463, decouple_loss:0.0019433090928941965
2023-04-27 21:48:15 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24186645448207855, mean p set: 0.4499112665653229
loss_pred:0.015811316668987274, decouple_loss:0.0018045076867565513
The modified gen p mean: 0.4493023455142975, gen p mean: -0.24232815206050873, mean p set: 0.4498290419578552
loss_pred:0.01523860264569521, decouple_loss:0.0018625275697559118
The modified gen p mean: 0.44821980595588684, gen p mean: -0.23915401101112366, mean p set: 0.44879910349845886
loss_pred:0.015628982335329056, decouple_loss:0.001720722415484488
WV_1_PC_1_EH_0_PS_30, loss: 0.015649430453777313, avg_mse: 0.02323550544679165
current test mse: 0.023236
Iteration: 4331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841715693473816, gen p mean: -0.24708351492881775, mean p set: 0.44898921251296997
loss_pred:0.013677889481186867, decouple_loss:0.0020437906496226788
The modified gen p mean: 0.4478038251399994, gen p mean: -0.24027305841445923, mean p set: 0.4483354985713959
loss_pred:0.014255792833864689, decouple_loss:0.0018639116315171123
The modified gen p mean: 0.44764968752861023, gen p mean: -0.24091090261936188, mean p set: 0.4482291042804718
loss_pred:0.014122015796601772, decouple_loss:0.00181834667455405
Iteration: 4332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486488103866577, gen p mean: -0.24280709028244019, mean p set: 0.44917428493499756
loss_pred:0.013755775056779385, decouple_loss:0.0016048320103436708
The modified gen p mean: 0.4484795928001404, gen p mean: -0.24236176908016205, mean p set: 0.4490547776222229
The modified gen p mean: 0.44785845279693604, gen p mean: -0.24477002024650574, mean p set: 0.4484313726425171
loss_pred:0.013932565227150917, decouple_loss:0.0017081663245335221
loss_pred:0.014193614944815636, decouple_loss:0.0015607880195602775
Iteration: 4333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482918977737427, gen p mean: -0.23523648083209991, mean p set: 0.4488137364387512
loss_pred:0.01429357472807169, decouple_loss:0.0019030090188607574
The modified gen p mean: 0.44730278849601746, gen p mean: -0.2320963591337204, mean p set: 0.447873055934906
The modified gen p mean: 0.44867539405822754, gen p mean: -0.24115873873233795, mean p set: 0.4492553174495697
loss_pred:0.014050387777388096, decouple_loss:0.001735733007080853
loss_pred:0.013980500400066376, decouple_loss:0.001653854502364993
Iteration: 4334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835296273231506, gen p mean: -0.23778268694877625, mean p set: 0.4488835632801056
loss_pred:0.013409877195954323, decouple_loss:0.0018366954755038023
The modified gen p mean: 0.4484899640083313, gen p mean: -0.24089080095291138, mean p set: 0.44906941056251526
The modified gen p mean: 0.4486776888370514, gen p mean: -0.23682300746440887, mean p set: 0.44925105571746826
loss_pred:0.013912154361605644, decouple_loss:0.0016489386325702071
loss_pred:0.014207269996404648, decouple_loss:0.0016635989304631948
Iteration: 4335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485282301902771, gen p mean: -0.23595845699310303, mean p set: 0.44910410046577454
loss_pred:0.014229523949325085, decouple_loss:0.0016259899130091071
The modified gen p mean: 0.4476751983165741, gen p mean: -0.22886642813682556, mean p set: 0.4482038617134094The modified gen p mean: 0.44811517000198364, gen p mean: -0.2380603551864624, mean p set: 0.4486883282661438
loss_pred:0.013955628499388695, decouple_loss:0.001857491792179644
loss_pred:0.014208944514393806, decouple_loss:0.0018594906432554126
Iteration: 4336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885262846946716, gen p mean: -0.23174411058425903, mean p set: 0.4494262933731079
loss_pred:0.014419610612094402, decouple_loss:0.001693802303634584
The modified gen p mean: 0.4474699795246124, gen p mean: -0.23715774714946747, mean p set: 0.4479973018169403The modified gen p mean: 0.4462539851665497, gen p mean: -0.23826493322849274, mean p set: 0.44683340191841125
loss_pred:0.014314161613583565, decouple_loss:0.0015715801855549216
loss_pred:0.013995412737131119, decouple_loss:0.0015451292274519801
Iteration: 4337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485946595668793, gen p mean: -0.23561836779117584, mean p set: 0.44916975498199463
loss_pred:0.014386042952537537, decouple_loss:0.001783136511221528
The modified gen p mean: 0.4487130641937256, gen p mean: -0.23763589560985565, mean p set: 0.44924765825271606The modified gen p mean: 0.4490460455417633, gen p mean: -0.23822444677352905, mean p set: 0.4496248662471771
loss_pred:0.013980289921164513, decouple_loss:0.0017685049679130316
loss_pred:0.014008072204887867, decouple_loss:0.0019122036173939705
Iteration: 4338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471002221107483, gen p mean: -0.23209702968597412, mean p set: 0.4476754069328308
loss_pred:0.014029798097908497, decouple_loss:0.0015366463921964169
The modified gen p mean: 0.44865119457244873, gen p mean: -0.2342934012413025, mean p set: 0.4492258131504059
loss_pred:0.013994409702718258, decouple_loss:0.0014685874339193106
The modified gen p mean: 0.44771361351013184, gen p mean: -0.22964389622211456, mean p set: 0.4482443630695343
loss_pred:0.014409342780709267, decouple_loss:0.0014959487598389387
Iteration: 4339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465688467025757, gen p mean: -0.23769250512123108, mean p set: 0.44714176654815674
loss_pred:0.01405077800154686, decouple_loss:0.001865276601165533
The modified gen p mean: 0.4482012987136841, gen p mean: -0.2383543848991394, mean p set: 0.4487766921520233
loss_pred:0.014072603546082973, decouple_loss:0.0017942992271855474
The modified gen p mean: 0.4481750726699829, gen p mean: -0.22975631058216095, mean p set: 0.44871124625205994
loss_pred:0.014173829928040504, decouple_loss:0.0019472980638965964
Iteration: 4340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472793638706207, gen p mean: -0.2399851679801941, mean p set: 0.44785305857658386
loss_pred:0.014102108776569366, decouple_loss:0.0014747412642464042
The modified gen p mean: 0.4481143355369568, gen p mean: -0.23916669189929962, mean p set: 0.4486922323703766
loss_pred:0.014354821294546127, decouple_loss:0.0016985076945275068
The modified gen p mean: 0.44851288199424744, gen p mean: -0.24093781411647797, mean p set: 0.4490397274494171
loss_pred:0.014127844013273716, decouple_loss:0.0016508284024894238
2023-04-27 21:51:40 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2439964860677719, mean p set: 0.4499112665653229
loss_pred:0.01580510102212429, decouple_loss:0.001707557588815689
The modified gen p mean: 0.44930052757263184, gen p mean: -0.24448364973068237, mean p set: 0.4498290419578552
loss_pred:0.015250961296260357, decouple_loss:0.0017323329811915755
The modified gen p mean: 0.4482259750366211, gen p mean: -0.241584911942482, mean p set: 0.44879910349845886
loss_pred:0.015575814992189407, decouple_loss:0.0017004719702526927
WV_1_PC_1_EH_0_PS_30, loss: 0.015629632398486137, avg_mse: 0.02321602776646614
current test mse: 0.023216
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 4341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477040469646454, gen p mean: -0.23588372766971588, mean p set: 0.44823071360588074
loss_pred:0.013750651851296425, decouple_loss:0.0017246630741283298
The modified gen p mean: 0.4480631947517395, gen p mean: -0.23747935891151428, mean p set: 0.44864022731781006
loss_pred:0.01416401844471693, decouple_loss:0.0016831025714054704
The modified gen p mean: 0.4478624165058136, gen p mean: -0.24111992120742798, mean p set: 0.44843941926956177
loss_pred:0.013840897008776665, decouple_loss:0.0016166510758921504
Iteration: 4342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849449396133423, gen p mean: -0.23910264670848846, mean p set: 0.44902175664901733
loss_pred:0.014030257239937782, decouple_loss:0.0018712468445301056
The modified gen p mean: 0.4489558935165405, gen p mean: -0.24408993124961853, mean p set: 0.449531614780426
The modified gen p mean: 0.44822967052459717, gen p mean: -0.24116970598697662, mean p set: 0.44880932569503784
loss_pred:0.014119883067905903, decouple_loss:0.001816463191062212
loss_pred:0.01400027796626091, decouple_loss:0.0019392595859244466
Iteration: 4343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448170006275177, gen p mean: -0.2461349368095398, mean p set: 0.4486970603466034
loss_pred:0.014094660058617592, decouple_loss:0.0017632400849834085
The modified gen p mean: 0.44792962074279785, gen p mean: -0.24504606425762177, mean p set: 0.448505699634552
The modified gen p mean: 0.4503995180130005, gen p mean: -0.24981990456581116, mean p set: 0.45098060369491577
loss_pred:0.013731759041547775, decouple_loss:0.0016561582451686263
loss_pred:0.013676729053258896, decouple_loss:0.0019375858828425407
Iteration: 4344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473854899406433, gen p mean: -0.2349352240562439, mean p set: 0.4479077458381653
loss_pred:0.013477232307195663, decouple_loss:0.002178475260734558
The modified gen p mean: 0.44885385036468506, gen p mean: -0.23677900433540344, mean p set: 0.4494239091873169
The modified gen p mean: 0.44797080755233765, gen p mean: -0.23633304238319397, mean p set: 0.4485420286655426
loss_pred:0.013023956678807735, decouple_loss:0.002173957647755742
loss_pred:0.014101959764957428, decouple_loss:0.0022799177095294
Iteration: 4345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44907549023628235, gen p mean: -0.23874326050281525, mean p set: 0.4496456980705261
loss_pred:0.013287102803587914, decouple_loss:0.001893807202577591
The modified gen p mean: 0.4475685954093933, gen p mean: -0.23784130811691284, mean p set: 0.4480955898761749The modified gen p mean: 0.4488356411457062, gen p mean: -0.24366503953933716, mean p set: 0.4494134187698364
loss_pred:0.014125311747193336, decouple_loss:0.0019099802011623979loss_pred:0.013253144919872284, decouple_loss:0.0017220278969034553
Iteration: 4346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492751955986023, gen p mean: -0.23945902287960052, mean p set: 0.44984567165374756
loss_pred:0.013862984254956245, decouple_loss:0.002013830468058586
The modified gen p mean: 0.44806280732154846, gen p mean: -0.2395588457584381, mean p set: 0.44863688945770264
loss_pred:0.013453414663672447, decouple_loss:0.0021704186219722033
The modified gen p mean: 0.45052775740623474, gen p mean: -0.2405945062637329, mean p set: 0.4510541558265686
loss_pred:0.013504120521247387, decouple_loss:0.0020334587898105383
Iteration: 4347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763901829719543, gen p mean: -0.23383721709251404, mean p set: 0.4482152760028839
loss_pred:0.013882298953831196, decouple_loss:0.0020137212704867125
The modified gen p mean: 0.44929149746894836, gen p mean: -0.243611142039299, mean p set: 0.4498688280582428
loss_pred:0.013440730050206184, decouple_loss:0.0019229621393606067
The modified gen p mean: 0.4481177031993866, gen p mean: -0.24232859909534454, mean p set: 0.4486437141895294
loss_pred:0.013796563260257244, decouple_loss:0.001838834723457694
Iteration: 4348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834160804748535, gen p mean: -0.24386924505233765, mean p set: 0.44891637563705444
loss_pred:0.013741896487772465, decouple_loss:0.001577023766003549
The modified gen p mean: 0.4484901428222656, gen p mean: -0.2344389110803604, mean p set: 0.44901901483535767The modified gen p mean: 0.44892534613609314, gen p mean: -0.23653481900691986, mean p set: 0.4495035707950592
loss_pred:0.013274205848574638, decouple_loss:0.0018706099363043904
loss_pred:0.014128213748335838, decouple_loss:0.001829167129471898
Iteration: 4349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828131794929504, gen p mean: -0.24249310791492462, mean p set: 0.4488562345504761
loss_pred:0.013671394437551498, decouple_loss:0.0017417104681953788
The modified gen p mean: 0.44755491614341736, gen p mean: -0.2389795184135437, mean p set: 0.4480842351913452The modified gen p mean: 0.44754892587661743, gen p mean: -0.23719735443592072, mean p set: 0.4481230676174164
loss_pred:0.013679515570402145, decouple_loss:0.0018111409153789282
loss_pred:0.0135663952678442, decouple_loss:0.0018150899559259415
Iteration: 4350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467022120952606, gen p mean: -0.23941251635551453, mean p set: 0.44727620482444763
loss_pred:0.01415928266942501, decouple_loss:0.0018857872346416116
The modified gen p mean: 0.44836121797561646, gen p mean: -0.246907040476799, mean p set: 0.44889357686042786The modified gen p mean: 0.44889605045318604, gen p mean: -0.23704810440540314, mean p set: 0.4494667053222656
loss_pred:0.013084490783512592, decouple_loss:0.0019083248917013407
loss_pred:0.013537774793803692, decouple_loss:0.0017994202207773924
2023-04-27 21:55:41 testing...
The modified gen p mean: 0.4482213258743286, gen p mean: -0.23890860378742218, mean p set: 0.44879910349845886
loss_pred:0.015716344118118286, decouple_loss:0.0020176891703158617
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24152131378650665, mean p set: 0.4499112665653229
loss_pred:0.015829889103770256, decouple_loss:0.0019011070253327489
The modified gen p mean: 0.44929173588752747, gen p mean: -0.24196016788482666, mean p set: 0.4498290419578552
loss_pred:0.015348588116466999, decouple_loss:0.0021176410373300314
WV_1_PC_1_EH_0_PS_30, loss: 0.015732213854789734, avg_mse: 0.023382488638162613
current test mse: 0.023382
Iteration: 4351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681647419929504, gen p mean: -0.24023529887199402, mean p set: 0.44738414883613586
loss_pred:0.0143278231844306, decouple_loss:0.0016395390266552567
The modified gen p mean: 0.44837087392807007, gen p mean: -0.23838897049427032, mean p set: 0.4489465653896332
loss_pred:0.013544587418437004, decouple_loss:0.0018313716864213347
The modified gen p mean: 0.44761624932289124, gen p mean: -0.2424759715795517, mean p set: 0.4481446146965027
loss_pred:0.014625548385083675, decouple_loss:0.0016784603940322995
Iteration: 4352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474003314971924, gen p mean: -0.240435391664505, mean p set: 0.4479316174983978
loss_pred:0.014348541386425495, decouple_loss:0.0016021663323044777
The modified gen p mean: 0.44824665784835815, gen p mean: -0.2394990772008896, mean p set: 0.44881969690322876
loss_pred:0.014184914529323578, decouple_loss:0.001722203567624092
The modified gen p mean: 0.44814327359199524, gen p mean: -0.24143292009830475, mean p set: 0.44872117042541504
loss_pred:0.014032463543117046, decouple_loss:0.0018604947254061699
Iteration: 4353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815710186958313, gen p mean: -0.24115703999996185, mean p set: 0.44869375228881836
loss_pred:0.013666637241840363, decouple_loss:0.0017607257468625903
The modified gen p mean: 0.44863229990005493, gen p mean: -0.2447780966758728, mean p set: 0.4492042660713196
loss_pred:0.013112267479300499, decouple_loss:0.0019170690793544054
The modified gen p mean: 0.4487050175666809, gen p mean: -0.2457699179649353, mean p set: 0.4492855668067932
loss_pred:0.013302717357873917, decouple_loss:0.0017963619902729988
Iteration: 4354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448421835899353, gen p mean: -0.23422573506832123, mean p set: 0.44894805550575256
loss_pred:0.013854466378688812, decouple_loss:0.0016665689181536436
The modified gen p mean: 0.447764128446579, gen p mean: -0.24096933007240295, mean p set: 0.4483504593372345
loss_pred:0.013411182910203934, decouple_loss:0.0017332988791167736
The modified gen p mean: 0.44714656472206116, gen p mean: -0.23755967617034912, mean p set: 0.4477311074733734
loss_pred:0.01387083064764738, decouple_loss:0.0017383855301886797
Iteration: 4355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732072949409485, gen p mean: -0.24141421914100647, mean p set: 0.4478953182697296
loss_pred:0.013643577694892883, decouple_loss:0.0017154678935185075
The modified gen p mean: 0.4480753540992737, gen p mean: -0.23885001242160797, mean p set: 0.448650062084198The modified gen p mean: 0.44770219922065735, gen p mean: -0.23818708956241608, mean p set: 0.448231041431427
loss_pred:0.013711689971387386, decouple_loss:0.0018393105128780007
loss_pred:0.013801016844809055, decouple_loss:0.001734823570586741
Iteration: 4356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496392011642456, gen p mean: -0.24195735156536102, mean p set: 0.4502216577529907
loss_pred:0.014061801135540009, decouple_loss:0.0017752464627847075
The modified gen p mean: 0.44884514808654785, gen p mean: -0.2506895065307617, mean p set: 0.44937342405319214The modified gen p mean: 0.4481523931026459, gen p mean: -0.24653038382530212, mean p set: 0.44871968030929565
loss_pred:0.013183267787098885, decouple_loss:0.0019174284534528852
loss_pred:0.013348731212317944, decouple_loss:0.0017818015767261386
Iteration: 4357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485391080379486, gen p mean: -0.24386563897132874, mean p set: 0.4491152763366699
loss_pred:0.013419918715953827, decouple_loss:0.0017213164828717709
The modified gen p mean: 0.4479246735572815, gen p mean: -0.2465265840291977, mean p set: 0.4484964609146118
loss_pred:0.013254335150122643, decouple_loss:0.0017363858642056584
The modified gen p mean: 0.4485686421394348, gen p mean: -0.23908543586730957, mean p set: 0.44909510016441345
loss_pred:0.013722718693315983, decouple_loss:0.002179081318899989
Iteration: 4358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471628963947296, gen p mean: -0.2414245903491974, mean p set: 0.4477364122867584
loss_pred:0.013681471347808838, decouple_loss:0.0018353710183873773
The modified gen p mean: 0.4487721920013428, gen p mean: -0.24250033497810364, mean p set: 0.44935348629951477
loss_pred:0.013820775784552097, decouple_loss:0.0019688697066158056
The modified gen p mean: 0.44809308648109436, gen p mean: -0.23853781819343567, mean p set: 0.448621928691864
loss_pred:0.013928893022239208, decouple_loss:0.0017723862547427416
Iteration: 4359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487473964691162, gen p mean: -0.25026771426200867, mean p set: 0.44932815432548523
loss_pred:0.013413599692285061, decouple_loss:0.0018904630560427904
The modified gen p mean: 0.4492637813091278, gen p mean: -0.23944935202598572, mean p set: 0.44984006881713867
loss_pred:0.0139657286927104, decouple_loss:0.0018686812836676836
The modified gen p mean: 0.44698208570480347, gen p mean: -0.2431740164756775, mean p set: 0.4475100636482239
loss_pred:0.013423650525510311, decouple_loss:0.001768146175891161
Iteration: 4360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483535885810852, gen p mean: -0.24508769810199738, mean p set: 0.44892609119415283
loss_pred:0.013281651772558689, decouple_loss:0.001964348601177335
The modified gen p mean: 0.4467724561691284, gen p mean: -0.24565525352954865, mean p set: 0.44730088114738464The modified gen p mean: 0.4483635425567627, gen p mean: -0.25040754675865173, mean p set: 0.4489334523677826
loss_pred:0.013329443521797657, decouple_loss:0.001891950611025095
loss_pred:0.013851611874997616, decouple_loss:0.0020430905278772116
2023-04-27 21:59:09 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24694786965847015, mean p set: 0.4499112665653229
loss_pred:0.015854649245738983, decouple_loss:0.0017503526760265231
The modified gen p mean: 0.44930195808410645, gen p mean: -0.24739883840084076, mean p set: 0.4498290419578552
loss_pred:0.015311704948544502, decouple_loss:0.0018096630228683352
The modified gen p mean: 0.4482187032699585, gen p mean: -0.24433165788650513, mean p set: 0.44879910349845886
loss_pred:0.015669459477066994, decouple_loss:0.001858129515312612
WV_1_PC_1_EH_0_PS_30, loss: 0.01570224016904831, avg_mse: 0.02336404100060463
current test mse: 0.023364
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 4361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813272356987, gen p mean: -0.2510908544063568, mean p set: 0.4486563205718994
loss_pred:0.013255085796117783, decouple_loss:0.0016943792579695582
The modified gen p mean: 0.4478245675563812, gen p mean: -0.2473999261856079, mean p set: 0.448408842086792
loss_pred:0.013775302097201347, decouple_loss:0.00165660516358912
The modified gen p mean: 0.44866660237312317, gen p mean: -0.23872946202754974, mean p set: 0.4492424428462982
loss_pred:0.013608940877020359, decouple_loss:0.002157695358619094
Iteration: 4362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447703093290329, gen p mean: -0.24654781818389893, mean p set: 0.4482307732105255
loss_pred:0.013408413156867027, decouple_loss:0.0022022377233952284
The modified gen p mean: 0.44744837284088135, gen p mean: -0.24490031599998474, mean p set: 0.4480225145816803
The modified gen p mean: 0.44796988368034363, gen p mean: -0.23976637423038483, mean p set: 0.44854292273521423
loss_pred:0.014195794239640236, decouple_loss:0.001998547464609146
loss_pred:0.013509186916053295, decouple_loss:0.0019556405022740364
Iteration: 4363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487200975418091, gen p mean: -0.2397235482931137, mean p set: 0.4492388665676117
loss_pred:0.013266118243336678, decouple_loss:0.0018865460297092795
The modified gen p mean: 0.4480951428413391, gen p mean: -0.24152128398418427, mean p set: 0.44866693019866943
The modified gen p mean: 0.4477359354496002, gen p mean: -0.24195215106010437, mean p set: 0.44830387830734253
loss_pred:0.013659533113241196, decouple_loss:0.0016987245762720704
loss_pred:0.014424929395318031, decouple_loss:0.0016111097065731883
Iteration: 4364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475094676017761, gen p mean: -0.2445986419916153, mean p set: 0.44804564118385315
loss_pred:0.013644392602145672, decouple_loss:0.0017046763096004725
The modified gen p mean: 0.4482770264148712, gen p mean: -0.23534181714057922, mean p set: 0.44885557889938354
The modified gen p mean: 0.4485262632369995, gen p mean: -0.24326151609420776, mean p set: 0.4490965008735657
loss_pred:0.013339339755475521, decouple_loss:0.0017566106980666518
loss_pred:0.01394590549170971, decouple_loss:0.001876944676041603
Iteration: 4365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925615191459656, gen p mean: -0.23060883581638336, mean p set: 0.44983553886413574
loss_pred:0.01346374861896038, decouple_loss:0.002074793679639697
The modified gen p mean: 0.44821053743362427, gen p mean: -0.24137724936008453, mean p set: 0.4487411379814148The modified gen p mean: 0.44749343395233154, gen p mean: -0.23903527855873108, mean p set: 0.4480714499950409
loss_pred:0.013147715479135513, decouple_loss:0.0022098938934504986
loss_pred:0.013116307556629181, decouple_loss:0.0019253354985266924
Iteration: 4366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801071286201477, gen p mean: -0.24096569418907166, mean p set: 0.4485855996608734
loss_pred:0.01373388059437275, decouple_loss:0.0017255537677556276
The modified gen p mean: 0.44651252031326294, gen p mean: -0.24108384549617767, mean p set: 0.44704070687294006The modified gen p mean: 0.44862663745880127, gen p mean: -0.23328153789043427, mean p set: 0.44920095801353455
loss_pred:0.013403947465121746, decouple_loss:0.001959623536095023
loss_pred:0.013206738978624344, decouple_loss:0.001979187596589327
Iteration: 4367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466928541660309, gen p mean: -0.2407538741827011, mean p set: 0.4472724497318268
loss_pred:0.013502078130841255, decouple_loss:0.0023480961099267006
The modified gen p mean: 0.44845837354660034, gen p mean: -0.23371396958827972, mean p set: 0.44898515939712524The modified gen p mean: 0.4469754099845886, gen p mean: -0.2464321106672287, mean p set: 0.44755133986473083
loss_pred:0.012921438552439213, decouple_loss:0.0019887248054146767
loss_pred:0.013374600559473038, decouple_loss:0.0022249529138207436
Iteration: 4368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493139386177063, gen p mean: -0.2368377298116684, mean p set: 0.44988885521888733
loss_pred:0.013731486164033413, decouple_loss:0.002122308360412717
The modified gen p mean: 0.4464316666126251, gen p mean: -0.2450447678565979, mean p set: 0.44696733355522156The modified gen p mean: 0.4486495852470398, gen p mean: -0.2362462878227234, mean p set: 0.4492274820804596
loss_pred:0.013267675414681435, decouple_loss:0.001993788406252861
loss_pred:0.013470644131302834, decouple_loss:0.001926887664012611
Iteration: 4369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473864436149597, gen p mean: -0.2395658642053604, mean p set: 0.44796544313430786
loss_pred:0.013594765216112137, decouple_loss:0.002012216718867421
The modified gen p mean: 0.44805845618247986, gen p mean: -0.2378290593624115, mean p set: 0.4485826790332794The modified gen p mean: 0.44868919253349304, gen p mean: -0.24238421022891998, mean p set: 0.4492718279361725
loss_pred:0.013877134770154953, decouple_loss:0.002134187612682581
loss_pred:0.013416151516139507, decouple_loss:0.0020527339074760675
Iteration: 4370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482478201389313, gen p mean: -0.2444865107536316, mean p set: 0.4488264322280884
loss_pred:0.013370150700211525, decouple_loss:0.0017212189268320799
The modified gen p mean: 0.4478226900100708, gen p mean: -0.23941276967525482, mean p set: 0.4483499228954315The modified gen p mean: 0.446297824382782, gen p mean: -0.2446211278438568, mean p set: 0.4468747675418854
loss_pred:0.013874741271138191, decouple_loss:0.0017925889696925879
loss_pred:0.013531669043004513, decouple_loss:0.0016244214493781328
2023-04-27 22:03:19 testing...
The modified gen p mean: 0.44821953773498535, gen p mean: -0.23629365861415863, mean p set: 0.44879910349845886
loss_pred:0.015636377036571503, decouple_loss:0.002260154578834772
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23905698955059052, mean p set: 0.4499112665653229
loss_pred:0.0158081091940403, decouple_loss:0.0026084929704666138
The modified gen p mean: 0.44929978251457214, gen p mean: -0.23933076858520508, mean p set: 0.4498290419578552
loss_pred:0.01528226863592863, decouple_loss:0.0023260144516825676
WV_1_PC_1_EH_0_PS_30, loss: 0.015695497393608093, avg_mse: 0.02329503372311592
current test mse: 0.023295
Iteration: 4371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481630325317383, gen p mean: -0.24119515717029572, mean p set: 0.4487343728542328
loss_pred:0.01431048009544611, decouple_loss:0.0020389084238559008
The modified gen p mean: 0.4461093246936798, gen p mean: -0.24216991662979126, mean p set: 0.44663533568382263
loss_pred:0.013440222479403019, decouple_loss:0.0020316930022090673
The modified gen p mean: 0.44853806495666504, gen p mean: -0.2389080673456192, mean p set: 0.4491168260574341
loss_pred:0.013839424587786198, decouple_loss:0.002189329592511058
Iteration: 4372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013660192489624, gen p mean: -0.24185916781425476, mean p set: 0.45066288113594055
loss_pred:0.0133702103048563, decouple_loss:0.0019176306668668985
The modified gen p mean: 0.4487422704696655, gen p mean: -0.2347516566514969, mean p set: 0.449319064617157
loss_pred:0.01364530622959137, decouple_loss:0.0018652385333552957
The modified gen p mean: 0.4483100473880768, gen p mean: -0.23534716665744781, mean p set: 0.4488862454891205
loss_pred:0.01368540246039629, decouple_loss:0.0018584562931209803
Iteration: 4373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478391110897064, gen p mean: -0.24445967376232147, mean p set: 0.44836726784706116
loss_pred:0.012921457178890705, decouple_loss:0.002218976616859436
The modified gen p mean: 0.44856420159339905, gen p mean: -0.23080773651599884, mean p set: 0.44913890957832336
loss_pred:0.013487051241099834, decouple_loss:0.002196633256971836
The modified gen p mean: 0.447292298078537, gen p mean: -0.2440536767244339, mean p set: 0.4478631317615509
loss_pred:0.013722067698836327, decouple_loss:0.0020324792712926865
Iteration: 4374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482854902744293, gen p mean: -0.23772534728050232, mean p set: 0.4488143026828766
loss_pred:0.01351931318640709, decouple_loss:0.001748252660036087
The modified gen p mean: 0.4475712776184082, gen p mean: -0.23815903067588806, mean p set: 0.4481477439403534
loss_pred:0.013506883755326271, decouple_loss:0.0020563360303640366
The modified gen p mean: 0.4482235610485077, gen p mean: -0.2396228015422821, mean p set: 0.44879457354545593
loss_pred:0.013469183817505836, decouple_loss:0.0020820291247218847
Iteration: 4375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826555252075195, gen p mean: -0.23614268004894257, mean p set: 0.44883567094802856
loss_pred:0.013829253613948822, decouple_loss:0.0020118539687246084
The modified gen p mean: 0.44718095660209656, gen p mean: -0.245091512799263, mean p set: 0.44775673747062683
loss_pred:0.01306995004415512, decouple_loss:0.0021299219224601984
The modified gen p mean: 0.44756948947906494, gen p mean: -0.23774734139442444, mean p set: 0.44809263944625854
loss_pred:0.013190865516662598, decouple_loss:0.0021555498242378235
Iteration: 4376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818970561027527, gen p mean: -0.23970521986484528, mean p set: 0.44876742362976074
loss_pred:0.013665134087204933, decouple_loss:0.0021061759907752275
The modified gen p mean: 0.45083367824554443, gen p mean: -0.24248333275318146, mean p set: 0.4513660967350006The modified gen p mean: 0.448984295129776, gen p mean: -0.24678625166416168, mean p set: 0.4495646357536316
loss_pred:0.01343463733792305, decouple_loss:0.0021712786983698606
loss_pred:0.013469350524246693, decouple_loss:0.002083605621010065
Iteration: 4377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862499833106995, gen p mean: -0.23574580252170563, mean p set: 0.44919851422309875
loss_pred:0.013498770073056221, decouple_loss:0.0026056761853396893
The modified gen p mean: 0.4495765268802643, gen p mean: -0.24573855102062225, mean p set: 0.4501021206378937The modified gen p mean: 0.44914111495018005, gen p mean: -0.24448056519031525, mean p set: 0.44971415400505066
loss_pred:0.013883466832339764, decouple_loss:0.0020957922097295523
loss_pred:0.013257039710879326, decouple_loss:0.0020133033394813538
Iteration: 4378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819051027297974, gen p mean: -0.24694250524044037, mean p set: 0.4487667679786682
loss_pred:0.013518912717700005, decouple_loss:0.0019000549800693989
The modified gen p mean: 0.4476790726184845, gen p mean: -0.23752036690711975, mean p set: 0.4482579529285431The modified gen p mean: 0.44727155566215515, gen p mean: -0.24057821929454803, mean p set: 0.44780102372169495
loss_pred:0.01349315233528614, decouple_loss:0.0020089680328965187
loss_pred:0.014141316525638103, decouple_loss:0.0018946320051327348
Iteration: 4379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479491114616394, gen p mean: -0.24323348701000214, mean p set: 0.4485265016555786
loss_pred:0.013020637445151806, decouple_loss:0.0018724644323810935
The modified gen p mean: 0.45015087723731995, gen p mean: -0.24371524155139923, mean p set: 0.450685054063797The modified gen p mean: 0.44786739349365234, gen p mean: -0.24358054995536804, mean p set: 0.44844454526901245
loss_pred:0.012982474640011787, decouple_loss:0.0018736048368737102
loss_pred:0.013681796379387379, decouple_loss:0.002496743807569146
Iteration: 4380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464092552661896, gen p mean: -0.25048771500587463, mean p set: 0.446990966796875
loss_pred:0.013744420371949673, decouple_loss:0.0019191084429621696
The modified gen p mean: 0.44769373536109924, gen p mean: -0.24441121518611908, mean p set: 0.4482734203338623
loss_pred:0.013298185542225838, decouple_loss:0.0018828811589628458
The modified gen p mean: 0.4484286606311798, gen p mean: -0.24525460600852966, mean p set: 0.44895556569099426
loss_pred:0.013862071558833122, decouple_loss:0.0019398718141019344
2023-04-27 22:06:44 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2414572834968567, mean p set: 0.4499112665653229
loss_pred:0.015816273167729378, decouple_loss:0.0019024324137717485
The modified gen p mean: 0.4493018388748169, gen p mean: -0.24169234931468964, mean p set: 0.4498290419578552
loss_pred:0.015190365724265575, decouple_loss:0.0018757614307105541
The modified gen p mean: 0.4482172727584839, gen p mean: -0.23872330784797668, mean p set: 0.44879910349845886
loss_pred:0.015626566484570503, decouple_loss:0.0019698054529726505
WV_1_PC_1_EH_0_PS_30, loss: 0.015640202909708023, avg_mse: 0.02321927435696125
current test mse: 0.023219
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 4381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483528733253479, gen p mean: -0.24297833442687988, mean p set: 0.4488847255706787
loss_pred:0.014401121065020561, decouple_loss:0.0018685773247852921
The modified gen p mean: 0.4467843174934387, gen p mean: -0.24376820027828217, mean p set: 0.44736161828041077
loss_pred:0.014208185486495495, decouple_loss:0.0016773507231846452
The modified gen p mean: 0.4477362036705017, gen p mean: -0.2431931495666504, mean p set: 0.4483122229576111
loss_pred:0.014293186366558075, decouple_loss:0.0017636383417993784
Iteration: 4382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818878173828125, gen p mean: -0.2394859343767166, mean p set: 0.44871804118156433
loss_pred:0.014426052570343018, decouple_loss:0.002378622069954872
The modified gen p mean: 0.4470002055168152, gen p mean: -0.24112962186336517, mean p set: 0.4475705623626709
The modified gen p mean: 0.44678422808647156, gen p mean: -0.23859669268131256, mean p set: 0.44736430048942566
loss_pred:0.013989036902785301, decouple_loss:0.0021217933390289545
loss_pred:0.014416621066629887, decouple_loss:0.002032109536230564
Iteration: 4383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467703402042389, gen p mean: -0.24378477036952972, mean p set: 0.4472969174385071
loss_pred:0.014082599431276321, decouple_loss:0.001786599401384592
The modified gen p mean: 0.44724082946777344, gen p mean: -0.23950956761837006, mean p set: 0.4478200376033783
The modified gen p mean: 0.4467276632785797, gen p mean: -0.23903557658195496, mean p set: 0.4473079442977905
loss_pred:0.014710390008985996, decouple_loss:0.0016709755873307586
loss_pred:0.014529010280966759, decouple_loss:0.00182405358646065
Iteration: 4384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713786244392395, gen p mean: -0.24340614676475525, mean p set: 0.4476657211780548
loss_pred:0.013990579172968864, decouple_loss:0.001706889714114368
The modified gen p mean: 0.4482225775718689, gen p mean: -0.24328415095806122, mean p set: 0.44880321621894836
The modified gen p mean: 0.44764694571495056, gen p mean: -0.2426808476448059, mean p set: 0.44822028279304504
loss_pred:0.014421234838664532, decouple_loss:0.0016868343809619546
loss_pred:0.014300061389803886, decouple_loss:0.0018975664861500263
Iteration: 4385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473274350166321, gen p mean: -0.2436854988336563, mean p set: 0.4478473961353302
loss_pred:0.014782781712710857, decouple_loss:0.001677216263487935
The modified gen p mean: 0.4464372396469116, gen p mean: -0.2462373673915863, mean p set: 0.44701075553894043
The modified gen p mean: 0.4473699629306793, gen p mean: -0.23881733417510986, mean p set: 0.4479510188102722
loss_pred:0.014525234699249268, decouple_loss:0.0016722228610888124
loss_pred:0.014805737882852554, decouple_loss:0.0014963472494855523
Iteration: 4386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472053349018097, gen p mean: -0.2382059246301651, mean p set: 0.4477764964103699
loss_pred:0.01462000235915184, decouple_loss:0.001802189159207046
The modified gen p mean: 0.447170615196228, gen p mean: -0.2418353259563446, mean p set: 0.4476999342441559
The modified gen p mean: 0.4466497600078583, gen p mean: -0.24608217179775238, mean p set: 0.44723477959632874
loss_pred:0.015078922733664513, decouple_loss:0.001710540964268148
loss_pred:0.01418732013553381, decouple_loss:0.001895951572805643
Iteration: 4387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487262964248657, gen p mean: -0.24284633994102478, mean p set: 0.44930416345596313
loss_pred:0.014262974262237549, decouple_loss:0.0019525883253663778
The modified gen p mean: 0.4476108253002167, gen p mean: -0.2398599237203598, mean p set: 0.4481441080570221The modified gen p mean: 0.44766542315483093, gen p mean: -0.24221870303153992, mean p set: 0.4482421875
loss_pred:0.014141214080154896, decouple_loss:0.0016329459613189101
loss_pred:0.014160540886223316, decouple_loss:0.0016147339483723044
Iteration: 4388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732922315597534, gen p mean: -0.24209260940551758, mean p set: 0.4479072690010071
loss_pred:0.013937611132860184, decouple_loss:0.001864782883785665
The modified gen p mean: 0.4467947483062744, gen p mean: -0.24010193347930908, mean p set: 0.44737330079078674
loss_pred:0.01417507603764534, decouple_loss:0.001926496042869985
The modified gen p mean: 0.44849875569343567, gen p mean: -0.24485477805137634, mean p set: 0.4490325152873993
loss_pred:0.013903495855629444, decouple_loss:0.0017376303439959884
Iteration: 4389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472455382347107, gen p mean: -0.23668408393859863, mean p set: 0.44782111048698425
loss_pred:0.014648251235485077, decouple_loss:0.001953118946403265
The modified gen p mean: 0.4465562701225281, gen p mean: -0.24136410653591156, mean p set: 0.4471310079097748
loss_pred:0.013886013999581337, decouple_loss:0.002035803161561489
The modified gen p mean: 0.4472840428352356, gen p mean: -0.24047723412513733, mean p set: 0.44780635833740234
loss_pred:0.014743770472705364, decouple_loss:0.001804787083528936
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804564118385315, gen p mean: -0.23879823088645935, mean p set: 0.44862401485443115
loss_pred:0.014604746364057064, decouple_loss:0.0016277601243928075
The modified gen p mean: 0.44684502482414246, gen p mean: -0.23878732323646545, mean p set: 0.44742023944854736
loss_pred:0.014180359430611134, decouple_loss:0.0016044650692492723
The modified gen p mean: 0.44676104187965393, gen p mean: -0.24348540604114532, mean p set: 0.4472888708114624
loss_pred:0.014347379095852375, decouple_loss:0.0015189916593953967
2023-04-27 22:10:51 testing...
The modified gen p mean: 0.44823601841926575, gen p mean: -0.23687584698200226, mean p set: 0.44879910349845886
loss_pred:0.015595358796417713, decouple_loss:0.0019500353373587132
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23934999108314514, mean p set: 0.4499112665653229
loss_pred:0.015768280252814293, decouple_loss:0.002086867578327656
The modified gen p mean: 0.44930002093315125, gen p mean: -0.24020078778266907, mean p set: 0.4498290419578552
loss_pred:0.015152293257415295, decouple_loss:0.002063891850411892
WV_1_PC_1_EH_0_PS_30, loss: 0.01560699101537466, avg_mse: 0.023141436278820038
current test mse: 0.023141
Iteration: 4391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475652277469635, gen p mean: -0.23528657853603363, mean p set: 0.4481446444988251
loss_pred:0.015067040920257568, decouple_loss:0.0021652807481586933
The modified gen p mean: 0.44667160511016846, gen p mean: -0.2442086786031723, mean p set: 0.4472491443157196
loss_pred:0.014192418195307255, decouple_loss:0.001979085151106119
The modified gen p mean: 0.4472416937351227, gen p mean: -0.24473465979099274, mean p set: 0.4477703869342804
loss_pred:0.014574343338608742, decouple_loss:0.001935203094035387
Iteration: 4392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480682909488678, gen p mean: -0.24125202000141144, mean p set: 0.4485948383808136
loss_pred:0.014295969158411026, decouple_loss:0.0017676112474873662
The modified gen p mean: 0.4481836259365082, gen p mean: -0.24738992750644684, mean p set: 0.4487501382827759
loss_pred:0.013942655175924301, decouple_loss:0.0019802660681307316
The modified gen p mean: 0.44612184166908264, gen p mean: -0.24063977599143982, mean p set: 0.44670602679252625
loss_pred:0.014822701923549175, decouple_loss:0.001717708189971745
Iteration: 4393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726598262786865, gen p mean: -0.24356688559055328, mean p set: 0.4477914571762085
loss_pred:0.013836103491485119, decouple_loss:0.0017849378054961562
The modified gen p mean: 0.4473404288291931, gen p mean: -0.24040761590003967, mean p set: 0.4479181170463562
loss_pred:0.014150192029774189, decouple_loss:0.0017424434190616012
The modified gen p mean: 0.44725900888442993, gen p mean: -0.24422705173492432, mean p set: 0.4478357136249542
loss_pred:0.014270877465605736, decouple_loss:0.0018189861439168453
Iteration: 4394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722780585289, gen p mean: -0.24222460389137268, mean p set: 0.4477572739124298
loss_pred:0.014969365671277046, decouple_loss:0.002354829106479883
The modified gen p mean: 0.4468941390514374, gen p mean: -0.24168364703655243, mean p set: 0.44747352600097656
loss_pred:0.014119897037744522, decouple_loss:0.002024299232289195
The modified gen p mean: 0.44702187180519104, gen p mean: -0.24264372885227203, mean p set: 0.4476010799407959
loss_pred:0.01432047039270401, decouple_loss:0.0016285072779282928
Iteration: 4395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480663537979126, gen p mean: -0.24012243747711182, mean p set: 0.44864028692245483
loss_pred:0.01452054176479578, decouple_loss:0.0016234929207712412
The modified gen p mean: 0.4475594460964203, gen p mean: -0.23754166066646576, mean p set: 0.4480918347835541The modified gen p mean: 0.4474511742591858, gen p mean: -0.24100187420845032, mean p set: 0.44802361726760864
loss_pred:0.01485329121351242, decouple_loss:0.0017342184437438846loss_pred:0.014103533700108528, decouple_loss:0.0016246330924332142
Iteration: 4396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784632325172424, gen p mean: -0.24033454060554504, mean p set: 0.4484269320964813
loss_pred:0.013884021900594234, decouple_loss:0.0021447313483804464
The modified gen p mean: 0.44815003871917725, gen p mean: -0.2389906495809555, mean p set: 0.44868743419647217The modified gen p mean: 0.4477095901966095, gen p mean: -0.24106402695178986, mean p set: 0.4482831358909607
loss_pred:0.014276023954153061, decouple_loss:0.001898586400784552
loss_pred:0.014120258390903473, decouple_loss:0.0020931914914399385
Iteration: 4397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465100169181824, gen p mean: -0.24733613431453705, mean p set: 0.44708749651908875
loss_pred:0.014745114371180534, decouple_loss:0.0016086985124275088
The modified gen p mean: 0.44720491766929626, gen p mean: -0.24193237721920013, mean p set: 0.4477294087409973
loss_pred:0.014888721518218517, decouple_loss:0.0016942968359217048
The modified gen p mean: 0.44785889983177185, gen p mean: -0.2441081702709198, mean p set: 0.44843074679374695
loss_pred:0.014175055548548698, decouple_loss:0.0015555304707959294
Iteration: 4398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448067843914032, gen p mean: -0.24114100635051727, mean p set: 0.4486437737941742
loss_pred:0.01435837335884571, decouple_loss:0.0017992578214034438
The modified gen p mean: 0.44790682196617126, gen p mean: -0.24151648581027985, mean p set: 0.4484843611717224
loss_pred:0.01427361648529768, decouple_loss:0.001806961721740663
The modified gen p mean: 0.4492548406124115, gen p mean: -0.24492350220680237, mean p set: 0.4497888684272766
loss_pred:0.01405094563961029, decouple_loss:0.0016212095506489277
Iteration: 4399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759875535964966, gen p mean: -0.24488797783851624, mean p set: 0.44817429780960083
loss_pred:0.014418038539588451, decouple_loss:0.0017084520077332854
The modified gen p mean: 0.44714856147766113, gen p mean: -0.24057665467262268, mean p set: 0.44771599769592285
loss_pred:0.014067662879824638, decouple_loss:0.0017497360240668058
The modified gen p mean: 0.4474090337753296, gen p mean: -0.24205805361270905, mean p set: 0.44793686270713806
loss_pred:0.014316806569695473, decouple_loss:0.0017293819691985846
Iteration: 4400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485371708869934, gen p mean: -0.2431478202342987, mean p set: 0.44910916686058044
loss_pred:0.014427234418690205, decouple_loss:0.001790774753317237
The modified gen p mean: 0.4467043876647949, gen p mean: -0.2467840015888214, mean p set: 0.44728556275367737The modified gen p mean: 0.4478975236415863, gen p mean: -0.24198579788208008, mean p set: 0.44842514395713806
loss_pred:0.01493771467357874, decouple_loss:0.0016492888098582625
loss_pred:0.01438593864440918, decouple_loss:0.0016551211010664701
2023-04-27 22:14:17 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24218663573265076, mean p set: 0.4499112665653229
loss_pred:0.01574200950562954, decouple_loss:0.001956020249053836
The modified gen p mean: 0.4492974877357483, gen p mean: -0.24280060827732086, mean p set: 0.4498290419578552
loss_pred:0.01511575747281313, decouple_loss:0.0020333079155534506
The modified gen p mean: 0.4482235014438629, gen p mean: -0.2397262454032898, mean p set: 0.44879910349845886
loss_pred:0.015534603968262672, decouple_loss:0.001963571645319462
WV_1_PC_1_EH_0_PS_30, loss: 0.015563338994979858, avg_mse: 0.0230860598385334
current test mse: 0.023086
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471498429775238, gen p mean: -0.24611100554466248, mean p set: 0.4476762115955353
loss_pred:0.013854995369911194, decouple_loss:0.0021214205771684647
The modified gen p mean: 0.447102814912796, gen p mean: -0.24654166400432587, mean p set: 0.44767507910728455
loss_pred:0.013746371492743492, decouple_loss:0.0018738145008683205
The modified gen p mean: 0.44723016023635864, gen p mean: -0.24679164588451385, mean p set: 0.4478035867214203
loss_pred:0.014479516074061394, decouple_loss:0.002050113631412387
Iteration: 4402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728586077690125, gen p mean: -0.24137146770954132, mean p set: 0.44781920313835144
loss_pred:0.01472519151866436, decouple_loss:0.0017554647056385875
The modified gen p mean: 0.4464948773384094, gen p mean: -0.23812668025493622, mean p set: 0.4470658302307129
The modified gen p mean: 0.44712889194488525, gen p mean: -0.24023176729679108, mean p set: 0.4477064609527588
loss_pred:0.014489812776446342, decouple_loss:0.0017472003819420934
loss_pred:0.013841676525771618, decouple_loss:0.0017805473180487752
Iteration: 4403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464768171310425, gen p mean: -0.24454551935195923, mean p set: 0.44700121879577637
loss_pred:0.01445213332772255, decouple_loss:0.0018443544395267963
The modified gen p mean: 0.4460003972053528, gen p mean: -0.23447632789611816, mean p set: 0.44658011198043823
The modified gen p mean: 0.4479970932006836, gen p mean: -0.23828351497650146, mean p set: 0.44856566190719604
loss_pred:0.014810020104050636, decouple_loss:0.0017658413853496313
loss_pred:0.014135384932160378, decouple_loss:0.0017106268787756562
Iteration: 4404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464902877807617, gen p mean: -0.24111294746398926, mean p set: 0.44701918959617615
loss_pred:0.01463589258491993, decouple_loss:0.0017279768362641335
The modified gen p mean: 0.44725728034973145, gen p mean: -0.2446652203798294, mean p set: 0.4478381872177124
The modified gen p mean: 0.4462065100669861, gen p mean: -0.243204265832901, mean p set: 0.4467797577381134
loss_pred:0.014051636680960655, decouple_loss:0.0021131066605448723
loss_pred:0.014419682323932648, decouple_loss:0.0016621870454400778
Iteration: 4405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792336225509644, gen p mean: -0.24952642619609833, mean p set: 0.44850221276283264
loss_pred:0.013922196812927723, decouple_loss:0.001787393121048808
The modified gen p mean: 0.44612836837768555, gen p mean: -0.2389094978570938, mean p set: 0.4466512203216553The modified gen p mean: 0.44699591398239136, gen p mean: -0.2406897097826004, mean p set: 0.4475724399089813
loss_pred:0.01480934303253889, decouple_loss:0.001836466952227056
loss_pred:0.01399174053221941, decouple_loss:0.0017699034651741385
Iteration: 4406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478866457939148, gen p mean: -0.24073682725429535, mean p set: 0.44846251606941223
loss_pred:0.014043377712368965, decouple_loss:0.002012073528021574
The modified gen p mean: 0.4461990296840668, gen p mean: -0.24198882281780243, mean p set: 0.44673141837120056The modified gen p mean: 0.44698017835617065, gen p mean: -0.24543866515159607, mean p set: 0.4475627839565277
loss_pred:0.013149977661669254, decouple_loss:0.0019664985593408346
loss_pred:0.014732596464455128, decouple_loss:0.0017215830739587545
Iteration: 4407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447011798620224, gen p mean: -0.24181243777275085, mean p set: 0.447585791349411
loss_pred:0.01424043346196413, decouple_loss:0.0018060054862871766
The modified gen p mean: 0.4459965229034424, gen p mean: -0.23782160878181458, mean p set: 0.4465225338935852The modified gen p mean: 0.4477343261241913, gen p mean: -0.23988662660121918, mean p set: 0.4483036994934082
loss_pred:0.01378028653562069, decouple_loss:0.0016892721178010106
loss_pred:0.0141876470297575, decouple_loss:0.001742775202728808
Iteration: 4408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468882381916046, gen p mean: -0.2438325732946396, mean p set: 0.4474670886993408
loss_pred:0.01400778442621231, decouple_loss:0.0022007485385984182
The modified gen p mean: 0.44609174132347107, gen p mean: -0.23742124438285828, mean p set: 0.4466211497783661The modified gen p mean: 0.4477604627609253, gen p mean: -0.2423616647720337, mean p set: 0.44833290576934814
loss_pred:0.014267942868173122, decouple_loss:0.0016944825183600187
loss_pred:0.01409468986093998, decouple_loss:0.0018380479887127876
Iteration: 4409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44596588611602783, gen p mean: -0.23591355979442596, mean p set: 0.4465442895889282
loss_pred:0.014227223582565784, decouple_loss:0.0018650118727236986
The modified gen p mean: 0.4466557502746582, gen p mean: -0.23932285606861115, mean p set: 0.4471836984157562The modified gen p mean: 0.44681990146636963, gen p mean: -0.24165990948677063, mean p set: 0.44738972187042236
loss_pred:0.014294924214482307, decouple_loss:0.0017675249837338924
loss_pred:0.01451856829226017, decouple_loss:0.0019189598970115185
Iteration: 4410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686880707740784, gen p mean: -0.24371160566806793, mean p set: 0.4474417567253113
loss_pred:0.014255989342927933, decouple_loss:0.0019362688763067126
The modified gen p mean: 0.448779821395874, gen p mean: -0.2523460388183594, mean p set: 0.44930580258369446The modified gen p mean: 0.44685956835746765, gen p mean: -0.24226166307926178, mean p set: 0.4474363923072815
loss_pred:0.014208462089300156, decouple_loss:0.002138367388397455
loss_pred:0.013936575502157211, decouple_loss:0.0020055603235960007
2023-04-27 22:18:22 testing...
The modified gen p mean: 0.4482191503047943, gen p mean: -0.2392209768295288, mean p set: 0.44879910349845886
loss_pred:0.015535185113549232, decouple_loss:0.001784746302291751
The modified gen p mean: 0.4494309425354004, gen p mean: -0.241758331656456, mean p set: 0.4499112665653229
loss_pred:0.015737036243081093, decouple_loss:0.001791937043890357
The modified gen p mean: 0.44930124282836914, gen p mean: -0.2422313541173935, mean p set: 0.4498290419578552
loss_pred:0.015116947703063488, decouple_loss:0.0018680072389543056
WV_1_PC_1_EH_0_PS_30, loss: 0.015553801320493221, avg_mse: 0.023088837042450905
current test mse: 0.023089
Iteration: 4411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44593119621276855, gen p mean: -0.24385851621627808, mean p set: 0.446504145860672
loss_pred:0.014349101111292839, decouple_loss:0.0016852632397785783
The modified gen p mean: 0.44677355885505676, gen p mean: -0.24368444085121155, mean p set: 0.44735097885131836
loss_pred:0.014061135239899158, decouple_loss:0.0017827495466917753
The modified gen p mean: 0.4470651149749756, gen p mean: -0.24454554915428162, mean p set: 0.447593629360199
loss_pred:0.014005888253450394, decouple_loss:0.0017195381224155426
Iteration: 4412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447671502828598, gen p mean: -0.2425149530172348, mean p set: 0.44819772243499756
loss_pred:0.014583704993128777, decouple_loss:0.0019428008235991001
The modified gen p mean: 0.44740626215934753, gen p mean: -0.24144001305103302, mean p set: 0.4479915201663971
loss_pred:0.013842151500284672, decouple_loss:0.001931827049702406
The modified gen p mean: 0.4458858072757721, gen p mean: -0.24087494611740112, mean p set: 0.4464643895626068
loss_pred:0.014138364233076572, decouple_loss:0.0018801656551659107
Iteration: 4413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776153564453125, gen p mean: -0.24367766082286835, mean p set: 0.44829118251800537
loss_pred:0.013824970461428165, decouple_loss:0.0016070455312728882
The modified gen p mean: 0.4468769133090973, gen p mean: -0.23895107209682465, mean p set: 0.4474518895149231
loss_pred:0.014297331683337688, decouple_loss:0.0017489902675151825
The modified gen p mean: 0.44575926661491394, gen p mean: -0.2432686984539032, mean p set: 0.4463328719139099
loss_pred:0.013962133787572384, decouple_loss:0.0017033935291692615
Iteration: 4414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471231698989868, gen p mean: -0.24445323646068573, mean p set: 0.4476585388183594
loss_pred:0.014199904166162014, decouple_loss:0.0016594902845099568
The modified gen p mean: 0.4467424154281616, gen p mean: -0.24362611770629883, mean p set: 0.44731974601745605
loss_pred:0.013918410055339336, decouple_loss:0.0016562137752771378
The modified gen p mean: 0.44696009159088135, gen p mean: -0.2439408153295517, mean p set: 0.4475339949131012
loss_pred:0.014948881231248379, decouple_loss:0.0017311109695583582
Iteration: 4415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463406503200531, gen p mean: -0.240593820810318, mean p set: 0.44692397117614746
loss_pred:0.014487180858850479, decouple_loss:0.00179056148044765
The modified gen p mean: 0.44671958684921265, gen p mean: -0.24186456203460693, mean p set: 0.44724246859550476The modified gen p mean: 0.4468195140361786, gen p mean: -0.24228383600711823, mean p set: 0.447394996881485
loss_pred:0.014268208295106888, decouple_loss:0.0016335343243554235
loss_pred:0.013984371908009052, decouple_loss:0.0016774036921560764
Iteration: 4416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464496076107025, gen p mean: -0.24229519069194794, mean p set: 0.44702303409576416
loss_pred:0.01436028815805912, decouple_loss:0.0015910016372799873
The modified gen p mean: 0.44676896929740906, gen p mean: -0.24121010303497314, mean p set: 0.4473433792591095The modified gen p mean: 0.44598105549812317, gen p mean: -0.23998281359672546, mean p set: 0.44651639461517334
loss_pred:0.014240172691643238, decouple_loss:0.001651852042414248
loss_pred:0.014405139721930027, decouple_loss:0.0016032831044867635
Iteration: 4417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467102587223053, gen p mean: -0.24218733608722687, mean p set: 0.4472809433937073
loss_pred:0.0143811060115695, decouple_loss:0.0015257637714967132
The modified gen p mean: 0.4474923312664032, gen p mean: -0.24300824105739594, mean p set: 0.44806966185569763
loss_pred:0.013867591507732868, decouple_loss:0.0016018070746213198
The modified gen p mean: 0.44684192538261414, gen p mean: -0.23838885128498077, mean p set: 0.447368860244751
loss_pred:0.014400223270058632, decouple_loss:0.0015548159135505557
Iteration: 4418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725704193115234, gen p mean: -0.23761267960071564, mean p set: 0.44783177971839905
loss_pred:0.014163278043270111, decouple_loss:0.0016250190092250705
The modified gen p mean: 0.4475511610507965, gen p mean: -0.23932306468486786, mean p set: 0.4481275677680969
loss_pred:0.013962894678115845, decouple_loss:0.0016771338414400816
The modified gen p mean: 0.44681254029273987, gen p mean: -0.23804813623428345, mean p set: 0.4473459720611572
loss_pred:0.014481988735496998, decouple_loss:0.0017607830232009292
Iteration: 4419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715508818626404, gen p mean: -0.2402147799730301, mean p set: 0.44772762060165405
loss_pred:0.013456130400300026, decouple_loss:0.0016152383759617805
The modified gen p mean: 0.44799482822418213, gen p mean: -0.2405732274055481, mean p set: 0.448570191860199
loss_pred:0.014056762680411339, decouple_loss:0.001643078401684761
The modified gen p mean: 0.4467140734195709, gen p mean: -0.2399117797613144, mean p set: 0.44724223017692566
loss_pred:0.014745842665433884, decouple_loss:0.0017734762514010072
Iteration: 4420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483272433280945, gen p mean: -0.24438297748565674, mean p set: 0.4489026963710785
loss_pred:0.013878017663955688, decouple_loss:0.0019005484646186233
The modified gen p mean: 0.44691142439842224, gen p mean: -0.23938676714897156, mean p set: 0.4474965035915375
loss_pred:0.01381080411374569, decouple_loss:0.001499986625276506
The modified gen p mean: 0.4470368027687073, gen p mean: -0.24322538077831268, mean p set: 0.4475582242012024
loss_pred:0.01368253119289875, decouple_loss:0.0015648923581466079
2023-04-27 22:21:48 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23764562606811523, mean p set: 0.4499112665653229
loss_pred:0.015681006014347076, decouple_loss:0.001977472798898816
The modified gen p mean: 0.44930389523506165, gen p mean: -0.23837944865226746, mean p set: 0.4498290419578552
loss_pred:0.01516288984566927, decouple_loss:0.002024854766204953
The modified gen p mean: 0.4482216238975525, gen p mean: -0.2352260798215866, mean p set: 0.44879910349845886
loss_pred:0.015549796633422375, decouple_loss:0.0020066017750650644
WV_1_PC_1_EH_0_PS_30, loss: 0.015564712695777416, avg_mse: 0.023128366097807884
current test mse: 0.023128
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 4421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44624027609825134, gen p mean: -0.23469027876853943, mean p set: 0.44676467776298523
loss_pred:0.013778803870081902, decouple_loss:0.0021746645215898752
The modified gen p mean: 0.44809845089912415, gen p mean: -0.234113872051239, mean p set: 0.4486709535121918
loss_pred:0.01350979320704937, decouple_loss:0.002330440329387784
The modified gen p mean: 0.4469887316226959, gen p mean: -0.24156813323497772, mean p set: 0.44756677746772766
loss_pred:0.014280303381383419, decouple_loss:0.001911626779474318
Iteration: 4422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886672496795654, gen p mean: -0.2332489937543869, mean p set: 0.4493965804576874
loss_pred:0.013532295823097229, decouple_loss:0.0020685726776719093
The modified gen p mean: 0.4482002854347229, gen p mean: -0.23368225991725922, mean p set: 0.44877946376800537
The modified gen p mean: 0.4486764669418335, gen p mean: -0.2415822297334671, mean p set: 0.44926023483276367
loss_pred:0.01341632753610611, decouple_loss:0.002032881136983633
loss_pred:0.013768206350505352, decouple_loss:0.0019191718893125653
Iteration: 4423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487142264842987, gen p mean: -0.22484706342220306, mean p set: 0.44924309849739075
loss_pred:0.014078856445848942, decouple_loss:0.0022583657409995794
The modified gen p mean: 0.4473245143890381, gen p mean: -0.23673313856124878, mean p set: 0.44790735840797424
The modified gen p mean: 0.44642728567123413, gen p mean: -0.23965921998023987, mean p set: 0.44700247049331665
loss_pred:0.013882038183510303, decouple_loss:0.0020262731704860926
loss_pred:0.014431615360081196, decouple_loss:0.0022032351698726416
Iteration: 4424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474126696586609, gen p mean: -0.23458005487918854, mean p set: 0.4479469656944275
loss_pred:0.014046689495444298, decouple_loss:0.001964628230780363
The modified gen p mean: 0.4473470151424408, gen p mean: -0.23460613191127777, mean p set: 0.4479270875453949
The modified gen p mean: 0.44754061102867126, gen p mean: -0.23004502058029175, mean p set: 0.4481112062931061
loss_pred:0.013502986170351505, decouple_loss:0.002037705620750785
loss_pred:0.014573788270354271, decouple_loss:0.0018862627912312746
Iteration: 4425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480678141117096, gen p mean: -0.22563236951828003, mean p set: 0.4486429989337921
loss_pred:0.01382498536258936, decouple_loss:0.002508381847292185
The modified gen p mean: 0.4488484263420105, gen p mean: -0.22639606893062592, mean p set: 0.44937291741371155The modified gen p mean: 0.4477507174015045, gen p mean: -0.22901922464370728, mean p set: 0.44832685589790344
loss_pred:0.013718027621507645, decouple_loss:0.00212093535810709
loss_pred:0.013772309757769108, decouple_loss:0.002497471868991852
Iteration: 4426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469960927963257, gen p mean: -0.2327582985162735, mean p set: 0.4475743770599365
loss_pred:0.014780346304178238, decouple_loss:0.0017910755705088377
The modified gen p mean: 0.4470692276954651, gen p mean: -0.23811419308185577, mean p set: 0.44759422540664673The modified gen p mean: 0.44731515645980835, gen p mean: -0.23100276291370392, mean p set: 0.4478895962238312
loss_pred:0.013302014209330082, decouple_loss:0.0018564906204119325
loss_pred:0.013747011311352253, decouple_loss:0.0018332505133002996
Iteration: 4427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466789662837982, gen p mean: -0.24078084528446198, mean p set: 0.44725939631462097
loss_pred:0.01415306143462658, decouple_loss:0.0019972205627709627
The modified gen p mean: 0.4480372667312622, gen p mean: -0.24014194309711456, mean p set: 0.4486168920993805The modified gen p mean: 0.44686728715896606, gen p mean: -0.23341774940490723, mean p set: 0.44739410281181335
loss_pred:0.013721003197133541, decouple_loss:0.0019914209842681885
loss_pred:0.014697456732392311, decouple_loss:0.0020058215595781803
Iteration: 4428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672679901123047, gen p mean: -0.2430845946073532, mean p set: 0.44729676842689514
loss_pred:0.013896821066737175, decouple_loss:0.0016681697452440858
The modified gen p mean: 0.44789567589759827, gen p mean: -0.2471574991941452, mean p set: 0.4484758675098419
loss_pred:0.0137960659340024, decouple_loss:0.0019369323272258043
The modified gen p mean: 0.4484892785549164, gen p mean: -0.2392192929983139, mean p set: 0.4490176737308502
loss_pred:0.013557951897382736, decouple_loss:0.0018394445069134235
Iteration: 4429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471169114112854, gen p mean: -0.2418888658285141, mean p set: 0.4476914703845978
loss_pred:0.014075594022870064, decouple_loss:0.0018726347479969263
The modified gen p mean: 0.4464220702648163, gen p mean: -0.23998428881168365, mean p set: 0.4469953179359436
loss_pred:0.013662625104188919, decouple_loss:0.001818945398554206
The modified gen p mean: 0.44843438267707825, gen p mean: -0.24490386247634888, mean p set: 0.4489628076553345
loss_pred:0.013498373329639435, decouple_loss:0.0017995613161474466
Iteration: 4430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479006826877594, gen p mean: -0.24702392518520355, mean p set: 0.4484791159629822
loss_pred:0.013730959966778755, decouple_loss:0.0018652058206498623
The modified gen p mean: 0.44741514325141907, gen p mean: -0.23934055864810944, mean p set: 0.44798827171325684
loss_pred:0.013214494101703167, decouple_loss:0.0017941846745088696
The modified gen p mean: 0.44624558091163635, gen p mean: -0.24458862841129303, mean p set: 0.44677630066871643
loss_pred:0.014340333640575409, decouple_loss:0.001673253602348268
2023-04-27 22:25:53 testing...
The modified gen p mean: 0.44822296500205994, gen p mean: -0.23820357024669647, mean p set: 0.44879910349845886
loss_pred:0.015684036538004875, decouple_loss:0.0020219155121594667
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24096199870109558, mean p set: 0.4499112665653229
loss_pred:0.01586310751736164, decouple_loss:0.002113420981913805
The modified gen p mean: 0.449304461479187, gen p mean: -0.24138978123664856, mean p set: 0.4498290419578552
loss_pred:0.015251225791871548, decouple_loss:0.0019905027002096176
WV_1_PC_1_EH_0_PS_30, loss: 0.015701554715633392, avg_mse: 0.02333618327975273
current test mse: 0.023336
Iteration: 4431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486061632633209, gen p mean: -0.2391737997531891, mean p set: 0.449184387922287
loss_pred:0.013503541238605976, decouple_loss:0.002261955291032791
The modified gen p mean: 0.44798991084098816, gen p mean: -0.23840714991092682, mean p set: 0.4485653042793274
loss_pred:0.013089830987155437, decouple_loss:0.0020596415270119905
The modified gen p mean: 0.4465811550617218, gen p mean: -0.23630020022392273, mean p set: 0.447108656167984
loss_pred:0.013237148523330688, decouple_loss:0.002194221829995513
Iteration: 4432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468764066696167, gen p mean: -0.23629212379455566, mean p set: 0.4474049210548401
loss_pred:0.013827120885252953, decouple_loss:0.002027608221396804
The modified gen p mean: 0.44780299067497253, gen p mean: -0.23295661807060242, mean p set: 0.4483778774738312
loss_pred:0.013612739741802216, decouple_loss:0.0018784120911732316
The modified gen p mean: 0.44682425260543823, gen p mean: -0.23642843961715698, mean p set: 0.4474024176597595
loss_pred:0.013736632652580738, decouple_loss:0.0021270110737532377
Iteration: 4433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667309522628784, gen p mean: -0.2391861230134964, mean p set: 0.4471994936466217
loss_pred:0.014197500422596931, decouple_loss:0.0019361816812306643
The modified gen p mean: 0.44715091586112976, gen p mean: -0.23872244358062744, mean p set: 0.44772061705589294
loss_pred:0.013829032890498638, decouple_loss:0.002125241095200181
The modified gen p mean: 0.44736719131469727, gen p mean: -0.241206094622612, mean p set: 0.44793838262557983
loss_pred:0.01376042328774929, decouple_loss:0.0024081417359411716
Iteration: 4434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771572947502136, gen p mean: -0.24090628325939178, mean p set: 0.44824886322021484
loss_pred:0.013501493260264397, decouple_loss:0.002026441739872098
The modified gen p mean: 0.44743624329566956, gen p mean: -0.23469190299510956, mean p set: 0.44800853729248047
loss_pred:0.013885722495615482, decouple_loss:0.0021213183645159006
The modified gen p mean: 0.4466020464897156, gen p mean: -0.23310352861881256, mean p set: 0.4471812844276428
loss_pred:0.014023490250110626, decouple_loss:0.0023612328805029392
Iteration: 4435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795164465904236, gen p mean: -0.24075071513652802, mean p set: 0.4485274851322174
loss_pred:0.01385173574090004, decouple_loss:0.002052868250757456
The modified gen p mean: 0.4470771849155426, gen p mean: -0.24049575626850128, mean p set: 0.44765228033065796
The modified gen p mean: 0.4464985430240631, gen p mean: -0.23573927581310272, mean p set: 0.4470299780368805
loss_pred:0.014097481034696102, decouple_loss:0.0018411318305879831
loss_pred:0.014264863915741444, decouple_loss:0.0017945229774340987
Iteration: 4436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482985734939575, gen p mean: -0.23561212420463562, mean p set: 0.4488696753978729
loss_pred:0.01327598188072443, decouple_loss:0.001899158931337297
The modified gen p mean: 0.44722050428390503, gen p mean: -0.244729682803154, mean p set: 0.4478025436401367The modified gen p mean: 0.4462287127971649, gen p mean: -0.23686261475086212, mean p set: 0.44675159454345703
loss_pred:0.013621234335005283, decouple_loss:0.0020795746240764856
loss_pred:0.01443548034876585, decouple_loss:0.0020406495314091444
Iteration: 4437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470004737377167, gen p mean: -0.23696738481521606, mean p set: 0.44756919145584106
loss_pred:0.014530425891280174, decouple_loss:0.0018423714209347963
The modified gen p mean: 0.4477906823158264, gen p mean: -0.24471250176429749, mean p set: 0.44836175441741943The modified gen p mean: 0.44699588418006897, gen p mean: -0.24079576134681702, mean p set: 0.4475267231464386
loss_pred:0.013544832356274128, decouple_loss:0.0021676369942724705
loss_pred:0.013822093605995178, decouple_loss:0.0018463762244209647
Iteration: 4438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769081473350525, gen p mean: -0.24618639051914215, mean p set: 0.44827136397361755
loss_pred:0.013421889394521713, decouple_loss:0.0017418625066056848
The modified gen p mean: 0.446788489818573, gen p mean: -0.24684123694896698, mean p set: 0.4473215639591217
The modified gen p mean: 0.44780611991882324, gen p mean: -0.2361355721950531, mean p set: 0.4483802020549774
loss_pred:0.013410178013145924, decouple_loss:0.0020836915355175734
loss_pred:0.01397462747991085, decouple_loss:0.001890081912279129
Iteration: 4439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790318608283997, gen p mean: -0.23603378236293793, mean p set: 0.44847285747528076
loss_pred:0.013431146740913391, decouple_loss:0.0020379777997732162
The modified gen p mean: 0.44721490144729614, gen p mean: -0.2398184835910797, mean p set: 0.44779151678085327
loss_pred:0.013750696554780006, decouple_loss:0.002161707729101181
The modified gen p mean: 0.4474208950996399, gen p mean: -0.2428567260503769, mean p set: 0.44795170426368713
loss_pred:0.013745489530265331, decouple_loss:0.002002537250518799
Iteration: 4440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717299938201904, gen p mean: -0.23989354074001312, mean p set: 0.4477514624595642
loss_pred:0.013356427662074566, decouple_loss:0.0016871762927621603
The modified gen p mean: 0.4471619129180908, gen p mean: -0.2429620623588562, mean p set: 0.4477385878562927
loss_pred:0.013968373648822308, decouple_loss:0.0016673387726768851
The modified gen p mean: 0.4477032721042633, gen p mean: -0.24179966747760773, mean p set: 0.4482361972332001
loss_pred:0.013539336621761322, decouple_loss:0.0017547293100506067
2023-04-27 22:29:18 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23970909416675568, mean p set: 0.4499112665653229
loss_pred:0.015795690938830376, decouple_loss:0.0019208501325920224
The modified gen p mean: 0.44930240511894226, gen p mean: -0.24041900038719177, mean p set: 0.4498290419578552
loss_pred:0.015298263169825077, decouple_loss:0.0017872708849608898
The modified gen p mean: 0.44822031259536743, gen p mean: -0.2373940646648407, mean p set: 0.44879910349845886
loss_pred:0.015695638954639435, decouple_loss:0.0017898851074278355
WV_1_PC_1_EH_0_PS_30, loss: 0.01568816415965557, avg_mse: 0.023381642997264862
current test mse: 0.023382
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 4441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463551938533783, gen p mean: -0.23661604523658752, mean p set: 0.4468816816806793
loss_pred:0.014192530885338783, decouple_loss:0.002309615956619382
The modified gen p mean: 0.44805511832237244, gen p mean: -0.24178394675254822, mean p set: 0.44863414764404297
loss_pred:0.013095208443701267, decouple_loss:0.0021389429457485676
The modified gen p mean: 0.4484996795654297, gen p mean: -0.23697301745414734, mean p set: 0.449078768491745
loss_pred:0.013424147851765156, decouple_loss:0.002063627587631345
Iteration: 4442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721657037734985, gen p mean: -0.24138636887073517, mean p set: 0.4477404057979584
loss_pred:0.013864425010979176, decouple_loss:0.002082300605252385
The modified gen p mean: 0.44683659076690674, gen p mean: -0.24396812915802002, mean p set: 0.44741183519363403
The modified gen p mean: 0.44961947202682495, gen p mean: -0.23867537081241608, mean p set: 0.45020049810409546
loss_pred:0.013613074086606503, decouple_loss:0.0017261848552152514
loss_pred:0.013457062654197216, decouple_loss:0.001921208226121962
Iteration: 4443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482579827308655, gen p mean: -0.24458108842372894, mean p set: 0.44878509640693665
loss_pred:0.01362569723278284, decouple_loss:0.0019978235941380262
The modified gen p mean: 0.4476574659347534, gen p mean: -0.23887428641319275, mean p set: 0.44823670387268066
The modified gen p mean: 0.44691598415374756, gen p mean: -0.24058763682842255, mean p set: 0.44749414920806885
loss_pred:0.013524754904210567, decouple_loss:0.001924634911119938
loss_pred:0.013781639747321606, decouple_loss:0.0019125031540170312
Iteration: 4444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723495841026306, gen p mean: -0.23854543268680573, mean p set: 0.447760671377182
loss_pred:0.013496859930455685, decouple_loss:0.0019445396028459072
The modified gen p mean: 0.4491930305957794, gen p mean: -0.23512718081474304, mean p set: 0.44976967573165894
The modified gen p mean: 0.4490041434764862, gen p mean: -0.23557786643505096, mean p set: 0.4495809078216553
loss_pred:0.013207322917878628, decouple_loss:0.002104742918163538
loss_pred:0.013589487411081791, decouple_loss:0.0019840653985738754
Iteration: 4445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472476840019226, gen p mean: -0.2321276068687439, mean p set: 0.44782590866088867
loss_pred:0.013767729513347149, decouple_loss:0.0017689913511276245
The modified gen p mean: 0.4491048753261566, gen p mean: -0.23986420035362244, mean p set: 0.4496791362762451The modified gen p mean: 0.4473162293434143, gen p mean: -0.23280057311058044, mean p set: 0.44784975051879883
loss_pred:0.013514467515051365, decouple_loss:0.0019729421474039555
loss_pred:0.013042767532169819, decouple_loss:0.0019935087766498327
Iteration: 4446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448905348777771, gen p mean: -0.23195192217826843, mean p set: 0.44948315620422363
loss_pred:0.01355748437345028, decouple_loss:0.002111196517944336
The modified gen p mean: 0.44744083285331726, gen p mean: -0.2388843148946762, mean p set: 0.4479677379131317The modified gen p mean: 0.44695085287094116, gen p mean: -0.23762519657611847, mean p set: 0.44752633571624756
loss_pred:0.012867951765656471, decouple_loss:0.0018812129274010658
loss_pred:0.01312785129994154, decouple_loss:0.0020102744456380606
Iteration: 4447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468308985233307, gen p mean: -0.2348446249961853, mean p set: 0.44741132855415344
loss_pred:0.013984241522848606, decouple_loss:0.0021880129352211952
The modified gen p mean: 0.4476108253002167, gen p mean: -0.2353108525276184, mean p set: 0.4481406807899475The modified gen p mean: 0.448140025138855, gen p mean: -0.2400660514831543, mean p set: 0.4487130343914032
loss_pred:0.013369740918278694, decouple_loss:0.001806030166335404
loss_pred:0.013519863598048687, decouple_loss:0.002340881619602442
Iteration: 4448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832083582878113, gen p mean: -0.23571443557739258, mean p set: 0.4488963484764099
loss_pred:0.013502421788871288, decouple_loss:0.002107830485329032
The modified gen p mean: 0.4486255645751953, gen p mean: -0.24487347900867462, mean p set: 0.4491964280605316
loss_pred:0.013229243457317352, decouple_loss:0.0018108757212758064
The modified gen p mean: 0.4489750862121582, gen p mean: -0.23692794144153595, mean p set: 0.44950512051582336
loss_pred:0.013255063444375992, decouple_loss:0.0019205870339646935
Iteration: 4449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478519558906555, gen p mean: -0.24289636313915253, mean p set: 0.44842419028282166
loss_pred:0.013630693778395653, decouple_loss:0.0019338703714311123
The modified gen p mean: 0.44875460863113403, gen p mean: -0.24318327009677887, mean p set: 0.4493320882320404
loss_pred:0.013300563208758831, decouple_loss:0.0019655346404761076
The modified gen p mean: 0.44884905219078064, gen p mean: -0.24058763682842255, mean p set: 0.4493766129016876
loss_pred:0.013341164216399193, decouple_loss:0.002056756056845188
Iteration: 4450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479382336139679, gen p mean: -0.24488107860088348, mean p set: 0.4485096037387848
loss_pred:0.01362574938684702, decouple_loss:0.0024270955473184586
The modified gen p mean: 0.44932320713996887, gen p mean: -0.24162247776985168, mean p set: 0.44985491037368774The modified gen p mean: 0.44993868470191956, gen p mean: -0.2398795336484909, mean p set: 0.4505167305469513
loss_pred:0.013770566321909428, decouple_loss:0.0018768750596791506
loss_pred:0.01349045243114233, decouple_loss:0.001923506846651435
2023-04-27 22:33:26 testing...
The modified gen p mean: 0.4482329189777374, gen p mean: -0.24441082775592804, mean p set: 0.44879910349845886
loss_pred:0.015689382329583168, decouple_loss:0.002218224573880434
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2464214563369751, mean p set: 0.4499112665653229
loss_pred:0.015856755897402763, decouple_loss:0.002141889650374651
The modified gen p mean: 0.4493015706539154, gen p mean: -0.24722091853618622, mean p set: 0.4498290419578552
loss_pred:0.015316910110414028, decouple_loss:0.0021945652551949024
WV_1_PC_1_EH_0_PS_30, loss: 0.01573026180267334, avg_mse: 0.023424992337822914
current test mse: 0.023425
Iteration: 4451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484814405441284, gen p mean: -0.23998722434043884, mean p set: 0.44906049966812134
loss_pred:0.013304365798830986, decouple_loss:0.0021033785305917263
The modified gen p mean: 0.4478394389152527, gen p mean: -0.23954711854457855, mean p set: 0.44841745495796204
loss_pred:0.01310714241117239, decouple_loss:0.0023082331754267216
The modified gen p mean: 0.4478490352630615, gen p mean: -0.24002160131931305, mean p set: 0.44838523864746094
loss_pred:0.013886976055800915, decouple_loss:0.002026434289291501
Iteration: 4452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45014259219169617, gen p mean: -0.23806270956993103, mean p set: 0.4506722390651703
loss_pred:0.013371925801038742, decouple_loss:0.0019384979968890548
The modified gen p mean: 0.4473142623901367, gen p mean: -0.24057871103286743, mean p set: 0.4478890001773834
loss_pred:0.013612940907478333, decouple_loss:0.001712105586193502
The modified gen p mean: 0.44818243384361267, gen p mean: -0.24555589258670807, mean p set: 0.4487580358982086
loss_pred:0.01275701355189085, decouple_loss:0.0017949967877939343
Iteration: 4453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492816925048828, gen p mean: -0.23751428723335266, mean p set: 0.4498105049133301
loss_pred:0.013648612424731255, decouple_loss:0.001771855168044567
The modified gen p mean: 0.44677501916885376, gen p mean: -0.24382829666137695, mean p set: 0.4473493695259094
loss_pred:0.013642574660480022, decouple_loss:0.002010925905779004
The modified gen p mean: 0.44755685329437256, gen p mean: -0.2388954907655716, mean p set: 0.4481384754180908
loss_pred:0.012876691296696663, decouple_loss:0.0020471105817705393
Iteration: 4454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491746723651886, gen p mean: -0.2369161695241928, mean p set: 0.44969815015792847
loss_pred:0.013476956635713577, decouple_loss:0.0017578265396878123
The modified gen p mean: 0.44780203700065613, gen p mean: -0.24027661979198456, mean p set: 0.4483746588230133
loss_pred:0.013652610592544079, decouple_loss:0.0022821808233857155
The modified gen p mean: 0.4482231140136719, gen p mean: -0.24390436708927155, mean p set: 0.44880014657974243
loss_pred:0.012904356233775616, decouple_loss:0.0019352462841197848
Iteration: 4455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721871614456177, gen p mean: -0.2446899265050888, mean p set: 0.4477921724319458
loss_pred:0.013656223192811012, decouple_loss:0.0017933776834979653
The modified gen p mean: 0.44746479392051697, gen p mean: -0.24495643377304077, mean p set: 0.44798991084098816The modified gen p mean: 0.4469658136367798, gen p mean: -0.24065907299518585, mean p set: 0.44753846526145935
loss_pred:0.012853467836976051, decouple_loss:0.002019323408603668
loss_pred:0.013752986676990986, decouple_loss:0.002441059099510312
Iteration: 4456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866710901260376, gen p mean: -0.24098975956439972, mean p set: 0.44924888014793396
loss_pred:0.013196446932852268, decouple_loss:0.0022502816282212734
The modified gen p mean: 0.4480951428413391, gen p mean: -0.24002306163311005, mean p set: 0.44866541028022766
loss_pred:0.013457962311804295, decouple_loss:0.0019299675477668643
The modified gen p mean: 0.44877883791923523, gen p mean: -0.241910919547081, mean p set: 0.4493098258972168
loss_pred:0.01311260275542736, decouple_loss:0.0020057703368365765
Iteration: 4457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772595167160034, gen p mean: -0.23547187447547913, mean p set: 0.4483111500740051
loss_pred:0.013679598458111286, decouple_loss:0.00224098889157176
The modified gen p mean: 0.4472881555557251, gen p mean: -0.24513539671897888, mean p set: 0.44786572456359863
loss_pred:0.013163827359676361, decouple_loss:0.0018950874218717217
The modified gen p mean: 0.44819191098213196, gen p mean: -0.2419167309999466, mean p set: 0.4487197697162628
loss_pred:0.013579215854406357, decouple_loss:0.002525985473766923
Iteration: 4458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459210932254791, gen p mean: -0.24008919298648834, mean p set: 0.4464992880821228
loss_pred:0.013871286995708942, decouple_loss:0.0021373515482991934
The modified gen p mean: 0.4471449553966522, gen p mean: -0.2411372810602188, mean p set: 0.4476757347583771
loss_pred:0.013570886105298996, decouple_loss:0.002282924484461546
The modified gen p mean: 0.4463575482368469, gen p mean: -0.2399897426366806, mean p set: 0.4469376802444458
loss_pred:0.013802477158606052, decouple_loss:0.0020800302736461163
Iteration: 4459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706854224205017, gen p mean: -0.2413358837366104, mean p set: 0.4476434886455536
loss_pred:0.013227527029812336, decouple_loss:0.0017258157022297382
The modified gen p mean: 0.44867444038391113, gen p mean: -0.23498184978961945, mean p set: 0.44924619793891907
loss_pred:0.013328008353710175, decouple_loss:0.001681840163655579
The modified gen p mean: 0.4488278329372406, gen p mean: -0.24249102175235748, mean p set: 0.4493577182292938
loss_pred:0.012936268001794815, decouple_loss:0.0020074655767530203
Iteration: 4460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491336941719055, gen p mean: -0.24347463250160217, mean p set: 0.4497106075286865
loss_pred:0.013344192877411842, decouple_loss:0.002144334837794304
The modified gen p mean: 0.44651851058006287, gen p mean: -0.23898328840732574, mean p set: 0.44709157943725586
loss_pred:0.013462156988680363, decouple_loss:0.002022319473326206
The modified gen p mean: 0.4461393654346466, gen p mean: -0.23822061717510223, mean p set: 0.4466628134250641
loss_pred:0.013819964602589607, decouple_loss:0.0022152012679725885
2023-04-27 22:36:52 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23942063748836517, mean p set: 0.4499112665653229
loss_pred:0.01576796919107437, decouple_loss:0.0020287863444536924
The modified gen p mean: 0.44930100440979004, gen p mean: -0.24024450778961182, mean p set: 0.4498290419578552
loss_pred:0.015239781700074673, decouple_loss:0.001938208588398993
The modified gen p mean: 0.44822341203689575, gen p mean: -0.23730245232582092, mean p set: 0.44879910349845886
loss_pred:0.015612822026014328, decouple_loss:0.001906624180264771
WV_1_PC_1_EH_0_PS_30, loss: 0.015638086944818497, avg_mse: 0.023270849138498306
current test mse: 0.023271
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 4461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475405514240265, gen p mean: -0.24238139390945435, mean p set: 0.4480704963207245
loss_pred:0.014661469496786594, decouple_loss:0.0023734942078590393
The modified gen p mean: 0.446878045797348, gen p mean: -0.2371886968612671, mean p set: 0.44745591282844543
loss_pred:0.014546726830303669, decouple_loss:0.0019880104809999466
The modified gen p mean: 0.44690078496932983, gen p mean: -0.24499574303627014, mean p set: 0.4474724233150482
loss_pred:0.014823838137090206, decouple_loss:0.0021483516320586205
Iteration: 4462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474853277206421, gen p mean: -0.24228931963443756, mean p set: 0.4480128884315491
loss_pred:0.01527140662074089, decouple_loss:0.0018898745765909553
The modified gen p mean: 0.4460223913192749, gen p mean: -0.24146564304828644, mean p set: 0.44659891724586487
The modified gen p mean: 0.44713038206100464, gen p mean: -0.24347664415836334, mean p set: 0.4476989209651947
loss_pred:0.014757752418518066, decouple_loss:0.0018197348108515143
loss_pred:0.014608296565711498, decouple_loss:0.001837051589973271
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469297528266907, gen p mean: -0.24128282070159912, mean p set: 0.44745174050331116
loss_pred:0.01466166041791439, decouple_loss:0.0022816737182438374
The modified gen p mean: 0.4475058913230896, gen p mean: -0.24399541318416595, mean p set: 0.4480864405632019
The modified gen p mean: 0.446620374917984, gen p mean: -0.23911087214946747, mean p set: 0.4472024440765381
loss_pred:0.014267023652791977, decouple_loss:0.0021423455327749252
loss_pred:0.014424431137740612, decouple_loss:0.0019020593026652932
Iteration: 4464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467330873012543, gen p mean: -0.24621106684207916, mean p set: 0.44726207852363586
loss_pred:0.014406641013920307, decouple_loss:0.0018813638016581535
The modified gen p mean: 0.4464235305786133, gen p mean: -0.24297335743904114, mean p set: 0.4469989240169525
The modified gen p mean: 0.4465523660182953, gen p mean: -0.24735280871391296, mean p set: 0.4471304714679718
loss_pred:0.014284172095358372, decouple_loss:0.001932788989506662
loss_pred:0.014608824625611305, decouple_loss:0.0017628456698730588
Iteration: 4465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736844301223755, gen p mean: -0.24264965951442719, mean p set: 0.4479503035545349
loss_pred:0.013526364229619503, decouple_loss:0.0018425493035465479
The modified gen p mean: 0.4476698637008667, gen p mean: -0.23858197033405304, mean p set: 0.44819650053977966The modified gen p mean: 0.446506530046463, gen p mean: -0.23887938261032104, mean p set: 0.4470832645893097
loss_pred:0.014122921042144299, decouple_loss:0.0018972204998135567
loss_pred:0.014107543043792248, decouple_loss:0.0018250285647809505
Iteration: 4466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474697709083557, gen p mean: -0.24352692067623138, mean p set: 0.4480500817298889
loss_pred:0.013546171598136425, decouple_loss:0.0016638538800179958
The modified gen p mean: 0.4463939964771271, gen p mean: -0.23720557987689972, mean p set: 0.44696730375289917The modified gen p mean: 0.4469279646873474, gen p mean: -0.24613535404205322, mean p set: 0.44745466113090515
loss_pred:0.014039082452654839, decouple_loss:0.0017566611059010029
loss_pred:0.01422093529254198, decouple_loss:0.0017820418579503894
Iteration: 4467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469887316226959, gen p mean: -0.23846317827701569, mean p set: 0.44756782054901123
loss_pred:0.013817445375025272, decouple_loss:0.0018910578219220042
The modified gen p mean: 0.4470614194869995, gen p mean: -0.23668542504310608, mean p set: 0.4475901126861572The modified gen p mean: 0.4464398920536041, gen p mean: -0.23243184387683868, mean p set: 0.4470199644565582
loss_pred:0.014233937487006187, decouple_loss:0.0017486694268882275
loss_pred:0.014494094997644424, decouple_loss:0.0019306606845930219
Iteration: 4468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465252459049225, gen p mean: -0.23668032884597778, mean p set: 0.44709739089012146
loss_pred:0.014913485385477543, decouple_loss:0.0017405312974005938
The modified gen p mean: 0.44603264331817627, gen p mean: -0.23529571294784546, mean p set: 0.4465586841106415The modified gen p mean: 0.44735637307167053, gen p mean: -0.2356676310300827, mean p set: 0.4479365348815918
loss_pred:0.014923135749995708, decouple_loss:0.0017850829754024744
loss_pred:0.014722762629389763, decouple_loss:0.0017605797620490193
Iteration: 4469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640225172042847, gen p mean: -0.23809149861335754, mean p set: 0.44698208570480347
loss_pred:0.015326205641031265, decouple_loss:0.0016303493175655603
The modified gen p mean: 0.4462921619415283, gen p mean: -0.23943330347537994, mean p set: 0.4468272626399994The modified gen p mean: 0.44731253385543823, gen p mean: -0.23928233981132507, mean p set: 0.447883665561676
loss_pred:0.014968750067055225, decouple_loss:0.0017065088031813502
loss_pred:0.01479491125792265, decouple_loss:0.0020299588795751333
Iteration: 4470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44616687297821045, gen p mean: -0.24316368997097015, mean p set: 0.4467359483242035
loss_pred:0.01444749254733324, decouple_loss:0.0017712267581373453
The modified gen p mean: 0.447146475315094, gen p mean: -0.24084514379501343, mean p set: 0.44772863388061523
loss_pred:0.01453170832246542, decouple_loss:0.0016696348320692778
The modified gen p mean: 0.44645392894744873, gen p mean: -0.24310725927352905, mean p set: 0.4469858705997467
loss_pred:0.014508461579680443, decouple_loss:0.0018364695133641362
2023-04-27 22:40:54 testing...
The modified gen p mean: 0.44822487235069275, gen p mean: -0.23905695974826813, mean p set: 0.44879910349845886
loss_pred:0.01561551634222269, decouple_loss:0.0017880412051454186
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24122589826583862, mean p set: 0.4499112665653229
loss_pred:0.0157155878841877, decouple_loss:0.0018843469442799687
The modified gen p mean: 0.44930288195610046, gen p mean: -0.24192872643470764, mean p set: 0.4498290419578552
loss_pred:0.015218297019600868, decouple_loss:0.0018894333625212312
WV_1_PC_1_EH_0_PS_30, loss: 0.015609165653586388, avg_mse: 0.023180240765213966
current test mse: 0.02318
Iteration: 4471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642892479896545, gen p mean: -0.2437625527381897, mean p set: 0.44700896739959717
loss_pred:0.014257121831178665, decouple_loss:0.0019284153822809458
The modified gen p mean: 0.4462593197822571, gen p mean: -0.24132829904556274, mean p set: 0.44678789377212524
loss_pred:0.013787985779345036, decouple_loss:0.0017138043185696006
The modified gen p mean: 0.44775742292404175, gen p mean: -0.24369028210639954, mean p set: 0.4483300447463989
loss_pred:0.014552782289683819, decouple_loss:0.001741560292430222
Iteration: 4472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466971755027771, gen p mean: -0.24414490163326263, mean p set: 0.44722431898117065
loss_pred:0.014139189384877682, decouple_loss:0.0017642270540818572
The modified gen p mean: 0.44656988978385925, gen p mean: -0.24208751320838928, mean p set: 0.44714680314064026
loss_pred:0.01446203887462616, decouple_loss:0.0017704176716506481
The modified gen p mean: 0.44715017080307007, gen p mean: -0.24590414762496948, mean p set: 0.4477214217185974
loss_pred:0.014313316904008389, decouple_loss:0.0017280232859775424
Iteration: 4473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463397264480591, gen p mean: -0.2350948303937912, mean p set: 0.4468649923801422
loss_pred:0.014555390924215317, decouple_loss:0.0019033981952816248
The modified gen p mean: 0.44615158438682556, gen p mean: -0.23719331622123718, mean p set: 0.44672611355781555
loss_pred:0.014879684895277023, decouple_loss:0.001934453728608787
The modified gen p mean: 0.4475243091583252, gen p mean: -0.23330315947532654, mean p set: 0.4480966627597809
loss_pred:0.014447673223912716, decouple_loss:0.001794243697077036
Iteration: 4474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790199398994446, gen p mean: -0.23439550399780273, mean p set: 0.4484312832355499
loss_pred:0.014408305287361145, decouple_loss:0.002168943639844656
The modified gen p mean: 0.4469476044178009, gen p mean: -0.2374163269996643, mean p set: 0.44752398133277893
loss_pred:0.014010936953127384, decouple_loss:0.002061617560684681
The modified gen p mean: 0.4455655813217163, gen p mean: -0.23361730575561523, mean p set: 0.4461430609226227
loss_pred:0.014909542165696621, decouple_loss:0.0019781312439590693
Iteration: 4475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471052587032318, gen p mean: -0.23317068815231323, mean p set: 0.44768035411834717
loss_pred:0.014075102284550667, decouple_loss:0.001656688516959548
The modified gen p mean: 0.4474678039550781, gen p mean: -0.2330571413040161, mean p set: 0.4479900598526001The modified gen p mean: 0.4468590021133423, gen p mean: -0.24086643755435944, mean p set: 0.44743674993515015
loss_pred:0.014279328286647797, decouple_loss:0.0017130121123045683
loss_pred:0.014835705980658531, decouple_loss:0.001582579337991774
Iteration: 4476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469597637653351, gen p mean: -0.23437407612800598, mean p set: 0.4475388824939728
loss_pred:0.013477149419486523, decouple_loss:0.0019333832897245884
The modified gen p mean: 0.44654381275177, gen p mean: -0.2403949499130249, mean p set: 0.44706523418426514The modified gen p mean: 0.44644951820373535, gen p mean: -0.23401300609111786, mean p set: 0.44702792167663574
loss_pred:0.014258172363042831, decouple_loss:0.0019065518863499165
loss_pred:0.014360888861119747, decouple_loss:0.00203492259606719
Iteration: 4477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44580766558647156, gen p mean: -0.2382727563381195, mean p set: 0.44638508558273315
loss_pred:0.014121001586318016, decouple_loss:0.0016681026900187135
The modified gen p mean: 0.4469242990016937, gen p mean: -0.2381007820367813, mean p set: 0.44749605655670166The modified gen p mean: 0.4456975758075714, gen p mean: -0.2392299473285675, mean p set: 0.44622352719306946
loss_pred:0.014566813595592976, decouple_loss:0.00221048342064023
loss_pred:0.014548929408192635, decouple_loss:0.001870066043920815
Iteration: 4478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667935371398926, gen p mean: -0.24791355431079865, mean p set: 0.44725584983825684
loss_pred:0.014014513231813908, decouple_loss:0.0017360784113407135
The modified gen p mean: 0.447265625, gen p mean: -0.247345432639122, mean p set: 0.4478432536125183The modified gen p mean: 0.445770263671875, gen p mean: -0.2424619048833847, mean p set: 0.4462953209877014
loss_pred:0.01449519395828247, decouple_loss:0.0019192579202353954
loss_pred:0.01373332180082798, decouple_loss:0.001872240798547864
Iteration: 4479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471583664417267, gen p mean: -0.24417832493782043, mean p set: 0.44773682951927185
loss_pred:0.01386928278952837, decouple_loss:0.002029935596510768
The modified gen p mean: 0.44549253582954407, gen p mean: -0.24331483244895935, mean p set: 0.4460710883140564
loss_pred:0.01393493078649044, decouple_loss:0.001691505080088973
The modified gen p mean: 0.44594424962997437, gen p mean: -0.24496148526668549, mean p set: 0.4464685022830963
loss_pred:0.01483840774744749, decouple_loss:0.0016510013956576586
Iteration: 4480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764259457588196, gen p mean: -0.24054059386253357, mean p set: 0.44821488857269287
loss_pred:0.014332152903079987, decouple_loss:0.0016570595325902104
The modified gen p mean: 0.44664275646209717, gen p mean: -0.24533745646476746, mean p set: 0.44716861844062805The modified gen p mean: 0.4461710751056671, gen p mean: -0.24493862688541412, mean p set: 0.44674646854400635
loss_pred:0.01375511009246111, decouple_loss:0.0016204881248995662
loss_pred:0.014129875227808952, decouple_loss:0.001720178290270269
2023-04-27 22:44:19 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24448375403881073, mean p set: 0.4499112665653229
loss_pred:0.015629669651389122, decouple_loss:0.0018474201206117868
The modified gen p mean: 0.4493020176887512, gen p mean: -0.24530978500843048, mean p set: 0.4498290419578552
loss_pred:0.015170805156230927, decouple_loss:0.0017229801742359996
The modified gen p mean: 0.44822847843170166, gen p mean: -0.2428516149520874, mean p set: 0.44879910349845886
loss_pred:0.015606825239956379, decouple_loss:0.001732110744342208
WV_1_PC_1_EH_0_PS_30, loss: 0.01555747538805008, avg_mse: 0.023095814511179924
current test mse: 0.023096
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 4481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675299525260925, gen p mean: -0.24854372441768646, mean p set: 0.44728177785873413
loss_pred:0.01499866135418415, decouple_loss:0.0018792834598571062
The modified gen p mean: 0.44745904207229614, gen p mean: -0.24243132770061493, mean p set: 0.44803139567375183
loss_pred:0.014780612662434578, decouple_loss:0.0018858610419556499
The modified gen p mean: 0.44915515184402466, gen p mean: -0.2436547726392746, mean p set: 0.4497283697128296
loss_pred:0.013953086920082569, decouple_loss:0.002471325686201453
Iteration: 4482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767099618911743, gen p mean: -0.2417832762002945, mean p set: 0.44820234179496765
loss_pred:0.014587058685719967, decouple_loss:0.0017405666876584291
The modified gen p mean: 0.4474114775657654, gen p mean: -0.24478815495967865, mean p set: 0.44798544049263
The modified gen p mean: 0.44624730944633484, gen p mean: -0.2509065866470337, mean p set: 0.4468221068382263
loss_pred:0.014832347631454468, decouple_loss:0.0016356242122128606
loss_pred:0.014475230127573013, decouple_loss:0.001741901971399784
Iteration: 4483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743582606315613, gen p mean: -0.2408933788537979, mean p set: 0.4479648470878601
loss_pred:0.014432056806981564, decouple_loss:0.0017550879856571555
The modified gen p mean: 0.4463893175125122, gen p mean: -0.2425834685564041, mean p set: 0.4469609558582306
The modified gen p mean: 0.44620463252067566, gen p mean: -0.2515135407447815, mean p set: 0.44677209854125977
loss_pred:0.01381593942642212, decouple_loss:0.001878522103652358
loss_pred:0.014376922510564327, decouple_loss:0.0019412795081734657
Iteration: 4484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468381702899933, gen p mean: -0.24516142904758453, mean p set: 0.44736534357070923
loss_pred:0.014811488799750805, decouple_loss:0.0018211235292255878
The modified gen p mean: 0.4483533203601837, gen p mean: -0.2384885549545288, mean p set: 0.4489316940307617
The modified gen p mean: 0.44932034611701965, gen p mean: -0.24263183772563934, mean p set: 0.44989389181137085
loss_pred:0.01375439390540123, decouple_loss:0.00208108639344573
loss_pred:0.013640515506267548, decouple_loss:0.002002312336117029
Iteration: 4485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687357544898987, gen p mean: -0.24395735561847687, mean p set: 0.44744372367858887
loss_pred:0.014336413703858852, decouple_loss:0.0016475071897730231
The modified gen p mean: 0.44650834798812866, gen p mean: -0.2491505742073059, mean p set: 0.44703981280326843The modified gen p mean: 0.4467765986919403, gen p mean: -0.25068429112434387, mean p set: 0.4473494589328766
loss_pred:0.014534393325448036, decouple_loss:0.001656612497754395
loss_pred:0.01510330568999052, decouple_loss:0.0016435682773590088
Iteration: 4486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464174807071686, gen p mean: -0.24743233621120453, mean p set: 0.44699788093566895
loss_pred:0.014574827626347542, decouple_loss:0.001748560811392963
The modified gen p mean: 0.44630879163742065, gen p mean: -0.24688398838043213, mean p set: 0.4468388855457306The modified gen p mean: 0.4467651844024658, gen p mean: -0.24258890748023987, mean p set: 0.44733917713165283
loss_pred:0.014272226020693779, decouple_loss:0.0018967298092320561
loss_pred:0.014570964500308037, decouple_loss:0.0018158303573727608
Iteration: 4487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468088448047638, gen p mean: -0.23989741504192352, mean p set: 0.44738900661468506
loss_pred:0.013699708506464958, decouple_loss:0.0018194239819422364
The modified gen p mean: 0.4471905827522278, gen p mean: -0.2442203015089035, mean p set: 0.4477183520793915The modified gen p mean: 0.4476676285266876, gen p mean: -0.2474820911884308, mean p set: 0.4482457637786865
loss_pred:0.013884393498301506, decouple_loss:0.0019465028308331966
loss_pred:0.015345433726906776, decouple_loss:0.0017513915663585067
Iteration: 4488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465717077255249, gen p mean: -0.23599451780319214, mean p set: 0.4471484422683716
loss_pred:0.01378151960670948, decouple_loss:0.0018579846946522593
The modified gen p mean: 0.44793733954429626, gen p mean: -0.24032257497310638, mean p set: 0.44846174120903015The modified gen p mean: 0.44950902462005615, gen p mean: -0.24023497104644775, mean p set: 0.4500883221626282
loss_pred:0.013656598515808582, decouple_loss:0.0019551769364625216
loss_pred:0.014058202505111694, decouple_loss:0.0016830237582325935
Iteration: 4489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472847878932953, gen p mean: -0.23545639216899872, mean p set: 0.4478605389595032
loss_pred:0.014737124554812908, decouple_loss:0.0018814790528267622
The modified gen p mean: 0.4468301832675934, gen p mean: -0.23261772096157074, mean p set: 0.4473569989204407The modified gen p mean: 0.4472508132457733, gen p mean: -0.23245461285114288, mean p set: 0.4478318989276886
loss_pred:0.014728798530995846, decouple_loss:0.001991722034290433
loss_pred:0.013565640896558762, decouple_loss:0.001789481146261096
Iteration: 4490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489192068576813, gen p mean: -0.23504246771335602, mean p set: 0.4494958221912384
loss_pred:0.013955862261354923, decouple_loss:0.0019069516565650702
The modified gen p mean: 0.4468686580657959, gen p mean: -0.23505528271198273, mean p set: 0.4473989009857178The modified gen p mean: 0.44685855507850647, gen p mean: -0.2307613343000412, mean p set: 0.4474294185638428
loss_pred:0.01343000028282404, decouple_loss:0.0018658218905329704
loss_pred:0.014996460638940334, decouple_loss:0.0017850690055638552
2023-04-27 22:48:21 testing...
The modified gen p mean: 0.4482213258743286, gen p mean: -0.22576187551021576, mean p set: 0.44879910349845886
loss_pred:0.015580696053802967, decouple_loss:0.0019816826097667217
The modified gen p mean: 0.4493057429790497, gen p mean: -0.22832641005516052, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22771917283535004, mean p set: 0.4499112665653229loss_pred:0.015204302035272121, decouple_loss:0.0020934934727847576
loss_pred:0.01575586013495922, decouple_loss:0.002194548025727272
WV_1_PC_1_EH_0_PS_30, loss: 0.015618114732205868, avg_mse: 0.023191198706626892
current test mse: 0.023191
Iteration: 4491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711729884147644, gen p mean: -0.22230888903141022, mean p set: 0.4476413428783417
loss_pred:0.014130929484963417, decouple_loss:0.002059211488813162
The modified gen p mean: 0.4482095539569855, gen p mean: -0.23112048208713531, mean p set: 0.4487859904766083
loss_pred:0.01418251171708107, decouple_loss:0.0019605790730565786
The modified gen p mean: 0.44650590419769287, gen p mean: -0.2313569337129593, mean p set: 0.4470820426940918
loss_pred:0.01419597677886486, decouple_loss:0.0017299684695899487
Iteration: 4492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466301500797272, gen p mean: -0.22694987058639526, mean p set: 0.4471592903137207
loss_pred:0.013900762423872948, decouple_loss:0.0017710946267470717
The modified gen p mean: 0.4474867284297943, gen p mean: -0.2288828194141388, mean p set: 0.4480628967285156
The modified gen p mean: 0.447498083114624, gen p mean: -0.23068122565746307, mean p set: 0.44807443022727966
loss_pred:0.014175710268318653, decouple_loss:0.0018184194341301918
loss_pred:0.013753759674727917, decouple_loss:0.001914224703796208
Iteration: 4493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749727845191956, gen p mean: -0.22412629425525665, mean p set: 0.44802284240722656
loss_pred:0.013813422061502934, decouple_loss:0.0019664480350911617
The modified gen p mean: 0.4476807713508606, gen p mean: -0.23232914507389069, mean p set: 0.4482575058937073
The modified gen p mean: 0.4475376605987549, gen p mean: -0.23307545483112335, mean p set: 0.4481140077114105
loss_pred:0.014226793311536312, decouple_loss:0.001675861538387835
loss_pred:0.013840636238455772, decouple_loss:0.0019646508153527975
Iteration: 4494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682785868644714, gen p mean: -0.2367514818906784, mean p set: 0.4474082589149475
loss_pred:0.015276920050382614, decouple_loss:0.0016917010070756078
The modified gen p mean: 0.4476042091846466, gen p mean: -0.23603467643260956, mean p set: 0.44813334941864014The modified gen p mean: 0.44652777910232544, gen p mean: -0.24032185971736908, mean p set: 0.4471015930175781
loss_pred:0.013806543312966824, decouple_loss:0.001783766900189221
loss_pred:0.015101713128387928, decouple_loss:0.001932685263454914
Iteration: 4495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483311176300049, gen p mean: -0.23948250710964203, mean p set: 0.44890403747558594
loss_pred:0.01400702353566885, decouple_loss:0.002138498006388545
The modified gen p mean: 0.4463654160499573, gen p mean: -0.24291804432868958, mean p set: 0.4469473958015442
loss_pred:0.01439078152179718, decouple_loss:0.0018421376589685678
The modified gen p mean: 0.4481965899467468, gen p mean: -0.24016119539737701, mean p set: 0.4487267732620239
loss_pred:0.014106332324445248, decouple_loss:0.002248796634376049
Iteration: 4496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804269075393677, gen p mean: -0.2340148240327835, mean p set: 0.44861525297164917
loss_pred:0.014716172590851784, decouple_loss:0.002033099066466093
The modified gen p mean: 0.44857218861579895, gen p mean: -0.23499687016010284, mean p set: 0.449098140001297The modified gen p mean: 0.4471879303455353, gen p mean: -0.23194408416748047, mean p set: 0.4477604627609253
loss_pred:0.014211687259376049, decouple_loss:0.0019306534668430686
loss_pred:0.014236417599022388, decouple_loss:0.0020605784375220537
Iteration: 4497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469410181045532, gen p mean: -0.23293821513652802, mean p set: 0.44751542806625366
loss_pred:0.01370074599981308, decouple_loss:0.0019108119886368513
The modified gen p mean: 0.44791144132614136, gen p mean: -0.23575657606124878, mean p set: 0.4484897553920746
loss_pred:0.014056667685508728, decouple_loss:0.002101306803524494
The modified gen p mean: 0.4482705593109131, gen p mean: -0.2394159585237503, mean p set: 0.448797345161438
loss_pred:0.014418874867260456, decouple_loss:0.0017277105944231153
Iteration: 4498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752901792526245, gen p mean: -0.23816972970962524, mean p set: 0.4481104910373688
loss_pred:0.013779585249722004, decouple_loss:0.0017742021009325981
The modified gen p mean: 0.44758307933807373, gen p mean: -0.23488372564315796, mean p set: 0.4481060206890106The modified gen p mean: 0.44791996479034424, gen p mean: -0.24048057198524475, mean p set: 0.4484971761703491
loss_pred:0.013605155050754547, decouple_loss:0.0018191039562225342
loss_pred:0.014581647701561451, decouple_loss:0.0019019331084564328
Iteration: 4499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839972257614136, gen p mean: -0.2371986359357834, mean p set: 0.44897395372390747
loss_pred:0.014088169671595097, decouple_loss:0.0016966918483376503
The modified gen p mean: 0.4469524323940277, gen p mean: -0.23220351338386536, mean p set: 0.44752857089042664
loss_pred:0.014117970131337643, decouple_loss:0.0019655292853713036
The modified gen p mean: 0.44685226678848267, gen p mean: -0.22975367307662964, mean p set: 0.44737815856933594
loss_pred:0.014200815930962563, decouple_loss:0.0018123127520084381
Iteration: 4500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465751647949219, gen p mean: -0.23125340044498444, mean p set: 0.44714486598968506
loss_pred:0.01333131454885006, decouple_loss:0.001746624824590981
The modified gen p mean: 0.4469619393348694, gen p mean: -0.23372314870357513, mean p set: 0.44753316044807434
loss_pred:0.015115758404135704, decouple_loss:0.0019008648814633489
The modified gen p mean: 0.4484768807888031, gen p mean: -0.23264080286026, mean p set: 0.44899824261665344
loss_pred:0.013836946338415146, decouple_loss:0.001860815449617803
2023-04-27 22:51:46 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23451639711856842, mean p set: 0.4499112665653229
loss_pred:0.01581607572734356, decouple_loss:0.0019610861781984568
The modified gen p mean: 0.4492984414100647, gen p mean: -0.23524512350559235, mean p set: 0.4498290419578552
loss_pred:0.015296024270355701, decouple_loss:0.0021268976852297783
The modified gen p mean: 0.44822368025779724, gen p mean: -0.23205727338790894, mean p set: 0.44879910349845886
loss_pred:0.01563490927219391, decouple_loss:0.0019961949437856674
WV_1_PC_1_EH_0_PS_30, loss: 0.015683740377426147, avg_mse: 0.02331824041903019
current test mse: 0.023318
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 4501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754934310913086, gen p mean: -0.23295652866363525, mean p set: 0.44807806611061096
loss_pred:0.015064663253724575, decouple_loss:0.0018196391174569726
The modified gen p mean: 0.44792237877845764, gen p mean: -0.23550322651863098, mean p set: 0.4484979510307312
loss_pred:0.015279006212949753, decouple_loss:0.0018116114661097527
The modified gen p mean: 0.44715794920921326, gen p mean: -0.23529575765132904, mean p set: 0.447732150554657
loss_pred:0.014775291085243225, decouple_loss:0.0018750308081507683
Iteration: 4502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452461004257202, gen p mean: -0.23998785018920898, mean p set: 0.4457741975784302
loss_pred:0.014637514017522335, decouple_loss:0.0017383283702656627
The modified gen p mean: 0.4455086290836334, gen p mean: -0.24397589266300201, mean p set: 0.4460800588130951
The modified gen p mean: 0.44652897119522095, gen p mean: -0.23766985535621643, mean p set: 0.447105348110199
loss_pred:0.014402939938008785, decouple_loss:0.0018355135107412934
loss_pred:0.014914100989699364, decouple_loss:0.001867068698629737
Iteration: 4503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714081287384033, gen p mean: -0.2415696531534195, mean p set: 0.44766902923583984
loss_pred:0.014531059190630913, decouple_loss:0.001749110291711986
The modified gen p mean: 0.44768962264060974, gen p mean: -0.24462983012199402, mean p set: 0.4482622444629669
The modified gen p mean: 0.4464116394519806, gen p mean: -0.24558837711811066, mean p set: 0.4469846189022064
loss_pred:0.014991477131843567, decouple_loss:0.002045496366918087
loss_pred:0.015507867559790611, decouple_loss:0.002185472985729575
Iteration: 4504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639745354652405, gen p mean: -0.24013906717300415, mean p set: 0.44692856073379517
loss_pred:0.014347909018397331, decouple_loss:0.001947054173797369
The modified gen p mean: 0.44831299781799316, gen p mean: -0.24011258780956268, mean p set: 0.44888943433761597
The modified gen p mean: 0.4464481770992279, gen p mean: -0.23911955952644348, mean p set: 0.44702646136283875
loss_pred:0.014638544991612434, decouple_loss:0.002316292142495513
loss_pred:0.014278431423008442, decouple_loss:0.0020903190597891808
Iteration: 4505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466184973716736, gen p mean: -0.24130895733833313, mean p set: 0.4471932351589203
loss_pred:0.015380915254354477, decouple_loss:0.0017500239191576838
The modified gen p mean: 0.44611382484436035, gen p mean: -0.2346494495868683, mean p set: 0.44669607281684875
loss_pred:0.014353295788168907, decouple_loss:0.0020801983773708344
The modified gen p mean: 0.44626519083976746, gen p mean: -0.23915477097034454, mean p set: 0.44679760932922363
loss_pred:0.015312808565795422, decouple_loss:0.0020876710768789053
Iteration: 4506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458087980747223, gen p mean: -0.23696403205394745, mean p set: 0.4463808834552765
loss_pred:0.014688262715935707, decouple_loss:0.0021449183113873005
The modified gen p mean: 0.4475246071815491, gen p mean: -0.23848669230937958, mean p set: 0.44809842109680176The modified gen p mean: 0.4480028748512268, gen p mean: -0.23690685629844666, mean p set: 0.448532372713089
loss_pred:0.014755822718143463, decouple_loss:0.002505082171410322
loss_pred:0.014857973903417587, decouple_loss:0.0023440171498805285
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44614240527153015, gen p mean: -0.23213282227516174, mean p set: 0.4467202425003052
loss_pred:0.014706794172525406, decouple_loss:0.0019379876321181655
The modified gen p mean: 0.447931170463562, gen p mean: -0.236538365483284, mean p set: 0.44851207733154297
loss_pred:0.014309759251773357, decouple_loss:0.0019892866257578135
The modified gen p mean: 0.4467128813266754, gen p mean: -0.2285751849412918, mean p set: 0.4472399353981018
loss_pred:0.0148364482447505, decouple_loss:0.0020638362038880587
Iteration: 4508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458558261394501, gen p mean: -0.23659905791282654, mean p set: 0.44643494486808777
loss_pred:0.014521600678563118, decouple_loss:0.002036610385403037
The modified gen p mean: 0.4478493630886078, gen p mean: -0.2345878779888153, mean p set: 0.4484235644340515
loss_pred:0.014182183891534805, decouple_loss:0.001749203773215413
The modified gen p mean: 0.44746533036231995, gen p mean: -0.23258131742477417, mean p set: 0.44799020886421204
loss_pred:0.014161926694214344, decouple_loss:0.0022034714929759502
Iteration: 4509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44582870602607727, gen p mean: -0.23135149478912354, mean p set: 0.4464031159877777
loss_pred:0.014413404278457165, decouple_loss:0.00180510722566396
The modified gen p mean: 0.44718417525291443, gen p mean: -0.23703698813915253, mean p set: 0.44775912165641785
loss_pred:0.015079090371727943, decouple_loss:0.0018426952883601189
The modified gen p mean: 0.4454384446144104, gen p mean: -0.23923993110656738, mean p set: 0.44596222043037415
loss_pred:0.014389392919838428, decouple_loss:0.001861525815911591
Iteration: 4510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647300243377686, gen p mean: -0.23993448913097382, mean p set: 0.4470498263835907
loss_pred:0.013920145109295845, decouple_loss:0.0020087147131562233
The modified gen p mean: 0.4473901391029358, gen p mean: -0.23983128368854523, mean p set: 0.447918564081192
The modified gen p mean: 0.44774168729782104, gen p mean: -0.23981302976608276, mean p set: 0.448323518037796
loss_pred:0.014767930842936039, decouple_loss:0.0020254773553460836
loss_pred:0.01390046812593937, decouple_loss:0.001939657493494451
2023-04-27 22:55:50 testing...
The modified gen p mean: 0.4482206702232361, gen p mean: -0.23829205334186554, mean p set: 0.44879910349845886
loss_pred:0.015599962323904037, decouple_loss:0.0018581474432721734
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24049295485019684, mean p set: 0.4499112665653229
loss_pred:0.015714772045612335, decouple_loss:0.0019689828623086214
The modified gen p mean: 0.449298620223999, gen p mean: -0.24108076095581055, mean p set: 0.4498290419578552
loss_pred:0.015239088796079159, decouple_loss:0.0017605890752747655
WV_1_PC_1_EH_0_PS_30, loss: 0.015611070208251476, avg_mse: 0.02322710119187832
current test mse: 0.023227
Iteration: 4511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466775953769684, gen p mean: -0.24133461713790894, mean p set: 0.44725537300109863
loss_pred:0.014309808611869812, decouple_loss:0.001928526908159256
The modified gen p mean: 0.446098655462265, gen p mean: -0.2400955706834793, mean p set: 0.44667407870292664
loss_pred:0.015033426694571972, decouple_loss:0.001926161115989089
The modified gen p mean: 0.4457918107509613, gen p mean: -0.24605092406272888, mean p set: 0.44631776213645935
loss_pred:0.014233529567718506, decouple_loss:0.001648855279199779
Iteration: 4512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44600582122802734, gen p mean: -0.24275395274162292, mean p set: 0.44653645157814026
loss_pred:0.013822394423186779, decouple_loss:0.002071244176477194
The modified gen p mean: 0.44583064317703247, gen p mean: -0.2424391359090805, mean p set: 0.44640329480171204
loss_pred:0.014807697385549545, decouple_loss:0.0019153025932610035
The modified gen p mean: 0.44659605622291565, gen p mean: -0.24648801982402802, mean p set: 0.4471801817417145
loss_pred:0.015094920992851257, decouple_loss:0.0020885986741632223
Iteration: 4513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447569876909256, gen p mean: -0.24055898189544678, mean p set: 0.4480991065502167
loss_pred:0.014417199417948723, decouple_loss:0.0018621019553393126
The modified gen p mean: 0.44635435938835144, gen p mean: -0.24256066977977753, mean p set: 0.4469307065010071
loss_pred:0.015429804101586342, decouple_loss:0.002100305398926139
The modified gen p mean: 0.44573459029197693, gen p mean: -0.2383386492729187, mean p set: 0.4463140368461609
loss_pred:0.014419764280319214, decouple_loss:0.001902989810332656
Iteration: 4514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734326004981995, gen p mean: -0.23881101608276367, mean p set: 0.44787484407424927
loss_pred:0.014227783307433128, decouple_loss:0.0017531124176457524
The modified gen p mean: 0.446372389793396, gen p mean: -0.24579960107803345, mean p set: 0.44695183634757996
loss_pred:0.014616215601563454, decouple_loss:0.0017485168064013124
The modified gen p mean: 0.4459300935268402, gen p mean: -0.24448911845684052, mean p set: 0.4465000033378601
loss_pred:0.014184117317199707, decouple_loss:0.0019953057635575533
Iteration: 4515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731080532073975, gen p mean: -0.24053844809532166, mean p set: 0.44788745045661926
loss_pred:0.014694289304316044, decouple_loss:0.0017845680704340339
The modified gen p mean: 0.4469171166419983, gen p mean: -0.2386142909526825, mean p set: 0.44744786620140076The modified gen p mean: 0.4468725919723511, gen p mean: -0.24190416932106018, mean p set: 0.4474559724330902
loss_pred:0.014685181900858879, decouple_loss:0.0018955138511955738
loss_pred:0.014077460393309593, decouple_loss:0.0017719375900924206
Iteration: 4516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673866033554077, gen p mean: -0.2408324033021927, mean p set: 0.4473114311695099
loss_pred:0.013918310403823853, decouple_loss:0.0018871964421123266
The modified gen p mean: 0.4469374716281891, gen p mean: -0.24340108036994934, mean p set: 0.44751712679862976The modified gen p mean: 0.4461832344532013, gen p mean: -0.240971639752388, mean p set: 0.4467087388038635
loss_pred:0.014869843609631062, decouple_loss:0.002054310869425535
loss_pred:0.014720160514116287, decouple_loss:0.0019751598592847586
Iteration: 4517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656050205230713, gen p mean: -0.24019283056259155, mean p set: 0.44713470339775085
loss_pred:0.014857201837003231, decouple_loss:0.0016532678855583072
The modified gen p mean: 0.4468507170677185, gen p mean: -0.2391688972711563, mean p set: 0.44737792015075684The modified gen p mean: 0.44644424319267273, gen p mean: -0.24168166518211365, mean p set: 0.4470173120498657
loss_pred:0.014503835700452328, decouple_loss:0.001743587083183229
loss_pred:0.014271823689341545, decouple_loss:0.001724658883176744
Iteration: 4518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456685185432434, gen p mean: -0.23921121656894684, mean p set: 0.4462362825870514
loss_pred:0.01419797446578741, decouple_loss:0.0021002984140068293
The modified gen p mean: 0.4461445212364197, gen p mean: -0.23631776869297028, mean p set: 0.44671353697776794
loss_pred:0.01465153880417347, decouple_loss:0.0022695770021528006
The modified gen p mean: 0.44644275307655334, gen p mean: -0.24302427470684052, mean p set: 0.4469722807407379
loss_pred:0.014475938864052296, decouple_loss:0.0018247762927785516
Iteration: 4519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44598445296287537, gen p mean: -0.23873655498027802, mean p set: 0.44655176997184753
loss_pred:0.014798201620578766, decouple_loss:0.0015903087332844734
The modified gen p mean: 0.44647255539894104, gen p mean: -0.24128781259059906, mean p set: 0.44704657793045044
loss_pred:0.014998307451605797, decouple_loss:0.0014869183069095016
The modified gen p mean: 0.4464874863624573, gen p mean: -0.23562373220920563, mean p set: 0.4470142424106598
loss_pred:0.01427634246647358, decouple_loss:0.0015797227388247848
Iteration: 4520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463619291782379, gen p mean: -0.23760734498500824, mean p set: 0.4469420909881592
loss_pred:0.014959306456148624, decouple_loss:0.0017097883392125368
The modified gen p mean: 0.44558215141296387, gen p mean: -0.23481431603431702, mean p set: 0.44616246223449707
loss_pred:0.01473810151219368, decouple_loss:0.0017077259253710508
The modified gen p mean: 0.4475996792316437, gen p mean: -0.2361246794462204, mean p set: 0.44813206791877747
loss_pred:0.014807485975325108, decouple_loss:0.0016889600083231926
2023-04-27 22:59:16 testing...
The modified gen p mean: 0.449430912733078, gen p mean: -0.2337585687637329, mean p set: 0.4499112665653229
loss_pred:0.015671784058213234, decouple_loss:0.0018143296474590898
The modified gen p mean: 0.449303537607193, gen p mean: -0.2342015504837036, mean p set: 0.4498290419578552
loss_pred:0.015187039040029049, decouple_loss:0.0019340480212122202
The modified gen p mean: 0.44822418689727783, gen p mean: -0.23170331120491028, mean p set: 0.44879910349845886
loss_pred:0.015551552176475525, decouple_loss:0.0016983553068712354
WV_1_PC_1_EH_0_PS_30, loss: 0.015560904517769814, avg_mse: 0.023106832057237625
current test mse: 0.023107
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 4521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475255012512207, gen p mean: -0.23631688952445984, mean p set: 0.44805845618247986
loss_pred:0.013954775407910347, decouple_loss:0.0018491399241611362
The modified gen p mean: 0.44760003685951233, gen p mean: -0.23807725310325623, mean p set: 0.4481755197048187
loss_pred:0.013565465807914734, decouple_loss:0.0018133219564333558
The modified gen p mean: 0.44702017307281494, gen p mean: -0.23168522119522095, mean p set: 0.4475933611392975
loss_pred:0.0143265500664711, decouple_loss:0.0018745961133390665
Iteration: 4522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486589729785919, gen p mean: -0.23188266158103943, mean p set: 0.44918543100357056
loss_pred:0.013479620218276978, decouple_loss:0.00195111648645252
The modified gen p mean: 0.44766196608543396, gen p mean: -0.23082761466503143, mean p set: 0.44824254512786865
The modified gen p mean: 0.4493846893310547, gen p mean: -0.22548748552799225, mean p set: 0.4499603509902954
loss_pred:0.014486794359982014, decouple_loss:0.0020403049420565367
loss_pred:0.01363970898091793, decouple_loss:0.002066134475171566
Iteration: 4523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476401209831238, gen p mean: -0.23572541773319244, mean p set: 0.4481693506240845
loss_pred:0.013670883141458035, decouple_loss:0.0018731767777353525
The modified gen p mean: 0.44710418581962585, gen p mean: -0.23640668392181396, mean p set: 0.44768205285072327
The modified gen p mean: 0.44659149646759033, gen p mean: -0.23446683585643768, mean p set: 0.4471684396266937
loss_pred:0.014944086782634258, decouple_loss:0.0017588227055966854
loss_pred:0.01417932566255331, decouple_loss:0.0020302068442106247
Iteration: 4524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470019042491913, gen p mean: -0.23684532940387726, mean p set: 0.4475235044956207
loss_pred:0.013848883099853992, decouple_loss:0.0018369758035987616
The modified gen p mean: 0.44764235615730286, gen p mean: -0.23782837390899658, mean p set: 0.44821614027023315
The modified gen p mean: 0.4480668902397156, gen p mean: -0.23991641402244568, mean p set: 0.4486410617828369
loss_pred:0.014240951277315617, decouple_loss:0.0019604740664362907
loss_pred:0.013565897941589355, decouple_loss:0.0018089240184053779
Iteration: 4525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475644826889038, gen p mean: -0.23569275438785553, mean p set: 0.44813597202301025
loss_pred:0.014094849117100239, decouple_loss:0.0018964982591569424
The modified gen p mean: 0.44769811630249023, gen p mean: -0.23197923600673676, mean p set: 0.44822585582733154The modified gen p mean: 0.44853949546813965, gen p mean: -0.23193873465061188, mean p set: 0.4491144120693207
loss_pred:0.013804181478917599, decouple_loss:0.002033042022958398
loss_pred:0.014066540636122227, decouple_loss:0.00205375999212265
Iteration: 4526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710174202919006, gen p mean: -0.23455722630023956, mean p set: 0.4476836025714874
loss_pred:0.013123908080160618, decouple_loss:0.0018786982400342822
The modified gen p mean: 0.4473606050014496, gen p mean: -0.2315092235803604, mean p set: 0.4478912055492401The modified gen p mean: 0.4484398066997528, gen p mean: -0.22979310154914856, mean p set: 0.4490176737308502
loss_pred:0.013821475207805634, decouple_loss:0.001969713717699051
loss_pred:0.014642440713942051, decouple_loss:0.0018536344869062304
Iteration: 4527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477940499782562, gen p mean: -0.23451505601406097, mean p set: 0.44836780428886414
loss_pred:0.014782127924263477, decouple_loss:0.001963026588782668
The modified gen p mean: 0.4479217231273651, gen p mean: -0.23124679923057556, mean p set: 0.44845467805862427The modified gen p mean: 0.44708555936813354, gen p mean: -0.23412470519542694, mean p set: 0.4476613700389862
loss_pred:0.013631553389132023, decouple_loss:0.0022580137010663748
loss_pred:0.013178742490708828, decouple_loss:0.0019565559923648834
Iteration: 4528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475895166397095, gen p mean: -0.23905149102210999, mean p set: 0.44816869497299194
loss_pred:0.014122662134468555, decouple_loss:0.0017922574188560247
The modified gen p mean: 0.44853782653808594, gen p mean: -0.2270655483007431, mean p set: 0.4491148293018341
loss_pred:0.013559972867369652, decouple_loss:0.0017949234461411834
The modified gen p mean: 0.44730010628700256, gen p mean: -0.23257550597190857, mean p set: 0.44783204793930054
loss_pred:0.013814565725624561, decouple_loss:0.001961549511179328
Iteration: 4529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487364590167999, gen p mean: -0.23501275479793549, mean p set: 0.449308842420578
loss_pred:0.013035852462053299, decouple_loss:0.002387215616181493
The modified gen p mean: 0.44819939136505127, gen p mean: -0.2286910116672516, mean p set: 0.4487749934196472
loss_pred:0.013897338882088661, decouple_loss:0.0017481687245890498
The modified gen p mean: 0.447457492351532, gen p mean: -0.22909501194953918, mean p set: 0.44798195362091064
loss_pred:0.013561411760747433, decouple_loss:0.0018807236338034272
Iteration: 4530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704189896583557, gen p mean: -0.22714458405971527, mean p set: 0.4476158618927002
loss_pred:0.014109349809587002, decouple_loss:0.0018003997392952442
The modified gen p mean: 0.44794073700904846, gen p mean: -0.22878572344779968, mean p set: 0.4485217034816742
loss_pred:0.013657847419381142, decouple_loss:0.0019021452171728015
The modified gen p mean: 0.44774043560028076, gen p mean: -0.23006659746170044, mean p set: 0.4482676684856415
loss_pred:0.013662192970514297, decouple_loss:0.0019999572541564703
2023-04-27 23:03:25 testing...
The modified gen p mean: 0.44826728105545044, gen p mean: -0.228520005941391, mean p set: 0.44879910349845886
loss_pred:0.015719642862677574, decouple_loss:0.002090771682560444
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23113347589969635, mean p set: 0.4499112665653229
loss_pred:0.015860941261053085, decouple_loss:0.0020071661565452814
The modified gen p mean: 0.449304461479187, gen p mean: -0.2313843071460724, mean p set: 0.4498290419578552
loss_pred:0.015384124591946602, decouple_loss:0.0022933988366276026
WV_1_PC_1_EH_0_PS_30, loss: 0.015761425718665123, avg_mse: 0.023389382287859917
current test mse: 0.023389
Iteration: 4531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447792112827301, gen p mean: -0.23003193736076355, mean p set: 0.4483700692653656
loss_pred:0.013152487576007843, decouple_loss:0.001819223165512085
The modified gen p mean: 0.44900259375572205, gen p mean: -0.2234562486410141, mean p set: 0.4495725929737091
loss_pred:0.013633372262120247, decouple_loss:0.002766210585832596
The modified gen p mean: 0.4467897415161133, gen p mean: -0.23486760258674622, mean p set: 0.4473148286342621
loss_pred:0.013683251105248928, decouple_loss:0.0017951891059055924
Iteration: 4532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760364294052124, gen p mean: -0.2342805564403534, mean p set: 0.44812917709350586
loss_pred:0.01408605556935072, decouple_loss:0.0019288950134068727
The modified gen p mean: 0.448028564453125, gen p mean: -0.23143288493156433, mean p set: 0.44860655069351196
loss_pred:0.013297785073518753, decouple_loss:0.0018227790715172887
The modified gen p mean: 0.4480123817920685, gen p mean: -0.23763306438922882, mean p set: 0.44859078526496887
loss_pred:0.0131694246083498, decouple_loss:0.0020332387648522854
Iteration: 4533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473438858985901, gen p mean: -0.23506666719913483, mean p set: 0.4478708505630493
loss_pred:0.01327874232083559, decouple_loss:0.0017514415085315704
The modified gen p mean: 0.44788435101509094, gen p mean: -0.23996314406394958, mean p set: 0.44845813512802124
loss_pred:0.013092161156237125, decouple_loss:0.002024867571890354
The modified gen p mean: 0.44723406434059143, gen p mean: -0.24300023913383484, mean p set: 0.44780364632606506
loss_pred:0.014158937148749828, decouple_loss:0.0017783112125471234
Iteration: 4534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700607657432556, gen p mean: -0.24478307366371155, mean p set: 0.44753962755203247
loss_pred:0.013627355918288231, decouple_loss:0.00179799715988338
The modified gen p mean: 0.4471808671951294, gen p mean: -0.24122729897499084, mean p set: 0.44775503873825073
loss_pred:0.013580773025751114, decouple_loss:0.0019863282795995474
The modified gen p mean: 0.44748634099960327, gen p mean: -0.2349531352519989, mean p set: 0.4480615258216858
loss_pred:0.013388341292738914, decouple_loss:0.0019962850492447615
Iteration: 4535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847822189331055, gen p mean: -0.23335427045822144, mean p set: 0.44905948638916016
loss_pred:0.0142755638808012, decouple_loss:0.0020927051082253456
The modified gen p mean: 0.4495393931865692, gen p mean: -0.2345101237297058, mean p set: 0.45010778307914734The modified gen p mean: 0.4471074044704437, gen p mean: -0.23497046530246735, mean p set: 0.4476364552974701
loss_pred:0.013198217377066612, decouple_loss:0.0021887917537242174
loss_pred:0.014045772142708302, decouple_loss:0.0018615912413224578
Iteration: 4536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779887795448303, gen p mean: -0.23405250906944275, mean p set: 0.4483305513858795
loss_pred:0.014359858818352222, decouple_loss:0.0022680049296468496
The modified gen p mean: 0.4480200707912445, gen p mean: -0.23839819431304932, mean p set: 0.4485950767993927
loss_pred:0.013649745844304562, decouple_loss:0.0021619570907205343
The modified gen p mean: 0.44898107647895813, gen p mean: -0.2289491593837738, mean p set: 0.4495594799518585
loss_pred:0.013422191143035889, decouple_loss:0.0019072814611718059
Iteration: 4537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469321370124817, gen p mean: -0.23145167529582977, mean p set: 0.4475088119506836
loss_pred:0.013852369971573353, decouple_loss:0.0017358018085360527
The modified gen p mean: 0.4472239315509796, gen p mean: -0.23901131749153137, mean p set: 0.4477936327457428The modified gen p mean: 0.4468532204627991, gen p mean: -0.23981672525405884, mean p set: 0.4473792016506195
loss_pred:0.013268417678773403, decouple_loss:0.0020544470753520727
loss_pred:0.013773119077086449, decouple_loss:0.0020310075487941504
Iteration: 4538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674378633499146, gen p mean: -0.23489105701446533, mean p set: 0.4472792148590088
loss_pred:0.013722159899771214, decouple_loss:0.002295553917065263
The modified gen p mean: 0.447991281747818, gen p mean: -0.22788123786449432, mean p set: 0.44856393337249756
loss_pred:0.014106369577348232, decouple_loss:0.0026443114038556814
The modified gen p mean: 0.447374552488327, gen p mean: -0.22951866686344147, mean p set: 0.4479523003101349
loss_pred:0.013982091099023819, decouple_loss:0.002506737830117345
Iteration: 4539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783714413642883, gen p mean: -0.23343053460121155, mean p set: 0.44842052459716797
loss_pred:0.013726213946938515, decouple_loss:0.0022191975731402636
The modified gen p mean: 0.44749048352241516, gen p mean: -0.23641638457775116, mean p set: 0.4480154812335968
loss_pred:0.01336886826902628, decouple_loss:0.002406107494607568
The modified gen p mean: 0.44644299149513245, gen p mean: -0.23121459782123566, mean p set: 0.44701725244522095
loss_pred:0.013993008993566036, decouple_loss:0.0020270345266908407
Iteration: 4540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805797934532166, gen p mean: -0.23613561689853668, mean p set: 0.44863179326057434
loss_pred:0.013353399001061916, decouple_loss:0.001966936979442835
The modified gen p mean: 0.44775307178497314, gen p mean: -0.2334815412759781, mean p set: 0.4482842683792114The modified gen p mean: 0.447569876909256, gen p mean: -0.2319825440645218, mean p set: 0.44814783334732056
loss_pred:0.013556498102843761, decouple_loss:0.00190992362331599
loss_pred:0.014101888053119183, decouple_loss:0.0020593833178281784
2023-04-27 23:06:50 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23712828755378723, mean p set: 0.4499112665653229
loss_pred:0.015845488756895065, decouple_loss:0.0018307918217033148
The modified gen p mean: 0.44827598333358765, gen p mean: -0.2340797632932663, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930270314216614, gen p mean: -0.23710915446281433, mean p set: 0.4498290419578552
loss_pred:0.015708202496170998, decouple_loss:0.001809438457712531
loss_pred:0.01529915351420641, decouple_loss:0.0017053034389391541
WV_1_PC_1_EH_0_PS_30, loss: 0.015706708654761314, avg_mse: 0.02336893044412136
current test mse: 0.023369
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 4541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859015941619873, gen p mean: -0.23944896459579468, mean p set: 0.44912344217300415
loss_pred:0.013096822425723076, decouple_loss:0.002082154620438814
The modified gen p mean: 0.4491931200027466, gen p mean: -0.24068515002727509, mean p set: 0.4497707486152649
loss_pred:0.014184019528329372, decouple_loss:0.0017512849299237132
The modified gen p mean: 0.44844210147857666, gen p mean: -0.2390994131565094, mean p set: 0.44901934266090393
loss_pred:0.013701041229069233, decouple_loss:0.002068600617349148
Iteration: 4542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486428201198578, gen p mean: -0.24262291193008423, mean p set: 0.44917547702789307
loss_pred:0.014145711436867714, decouple_loss:0.001938196481205523
The modified gen p mean: 0.44867202639579773, gen p mean: -0.2404749095439911, mean p set: 0.4492538273334503
loss_pred:0.014373967424035072, decouple_loss:0.002233130158856511
The modified gen p mean: 0.4487624168395996, gen p mean: -0.2327681928873062, mean p set: 0.44933751225471497
loss_pred:0.014227631501853466, decouple_loss:0.00197369372472167
Iteration: 4543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479617476463318, gen p mean: -0.2419700175523758, mean p set: 0.4484889805316925
loss_pred:0.014455967582762241, decouple_loss:0.0017207844648510218
The modified gen p mean: 0.4487709403038025, gen p mean: -0.2437801957130432, mean p set: 0.44933804869651794
loss_pred:0.013366518542170525, decouple_loss:0.0016331031220033765
The modified gen p mean: 0.4484386742115021, gen p mean: -0.2437998652458191, mean p set: 0.44901350140571594
loss_pred:0.014121913351118565, decouple_loss:0.0017853020690381527
Iteration: 4544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945454597473145, gen p mean: -0.250602662563324, mean p set: 0.4499812126159668
loss_pred:0.01397007703781128, decouple_loss:0.0019245358416810632
The modified gen p mean: 0.44931042194366455, gen p mean: -0.24479468166828156, mean p set: 0.449893057346344
loss_pred:0.01392662338912487, decouple_loss:0.0019009507959708571
The modified gen p mean: 0.44970598816871643, gen p mean: -0.24380162358283997, mean p set: 0.4502778649330139
loss_pred:0.014678388833999634, decouple_loss:0.002025614259764552
Iteration: 4545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749772548675537, gen p mean: -0.24517671763896942, mean p set: 0.4480784237384796
loss_pred:0.014758002012968063, decouple_loss:0.0018967422656714916
The modified gen p mean: 0.44765162467956543, gen p mean: -0.2424633502960205, mean p set: 0.4481810927391052The modified gen p mean: 0.44708752632141113, gen p mean: -0.24386094510555267, mean p set: 0.44766971468925476
loss_pred:0.014635033905506134, decouple_loss:0.0017209891229867935
loss_pred:0.014793170616030693, decouple_loss:0.0016735236858949065
Iteration: 4546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832825660705566, gen p mean: -0.2363247275352478, mean p set: 0.4488604962825775
loss_pred:0.01355557981878519, decouple_loss:0.0025338917039334774
The modified gen p mean: 0.448127806186676, gen p mean: -0.24019783735275269, mean p set: 0.4487088918685913
loss_pred:0.013659069314599037, decouple_loss:0.002386239590123296
The modified gen p mean: 0.4486561417579651, gen p mean: -0.2358691543340683, mean p set: 0.4492361843585968
loss_pred:0.013537012040615082, decouple_loss:0.002455922542139888
Iteration: 4547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489075839519501, gen p mean: -0.23300746083259583, mean p set: 0.449482798576355
loss_pred:0.014070934616029263, decouple_loss:0.0018974383128806949
The modified gen p mean: 0.44774168729782104, gen p mean: -0.2405320107936859, mean p set: 0.4483141601085663The modified gen p mean: 0.4485967457294464, gen p mean: -0.2406766265630722, mean p set: 0.4491303265094757
loss_pred:0.013935014605522156, decouple_loss:0.0018121970351785421
loss_pred:0.013655554503202438, decouple_loss:0.0020146085880696774
Iteration: 4548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479045867919922, gen p mean: -0.2386016696691513, mean p set: 0.44847777485847473
loss_pred:0.014811459928750992, decouple_loss:0.002057738834992051
The modified gen p mean: 0.44852206110954285, gen p mean: -0.2371385246515274, mean p set: 0.44909700751304626The modified gen p mean: 0.4483306109905243, gen p mean: -0.24047784507274628, mean p set: 0.4488602578639984
loss_pred:0.013337662443518639, decouple_loss:0.0019241340924054384
loss_pred:0.01389448530972004, decouple_loss:0.0021883512381464243
Iteration: 4549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474310278892517, gen p mean: -0.24062155187129974, mean p set: 0.4480117857456207
loss_pred:0.014096210710704327, decouple_loss:0.0018973072292283177
The modified gen p mean: 0.4492204785346985, gen p mean: -0.2448660135269165, mean p set: 0.4497983753681183
loss_pred:0.014272913336753845, decouple_loss:0.0019232265185564756
The modified gen p mean: 0.4491637945175171, gen p mean: -0.241237610578537, mean p set: 0.4496924579143524
loss_pred:0.013860533945262432, decouple_loss:0.002123447833582759
Iteration: 4550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773218035697937, gen p mean: -0.24164290726184845, mean p set: 0.44830194115638733
loss_pred:0.014383383095264435, decouple_loss:0.001920437323860824
The modified gen p mean: 0.44704198837280273, gen p mean: -0.24132327735424042, mean p set: 0.44762104749679565
loss_pred:0.014600318856537342, decouple_loss:0.0021949438378214836
The modified gen p mean: 0.44818243384361267, gen p mean: -0.23169676959514618, mean p set: 0.44870755076408386
loss_pred:0.013380873017013073, decouple_loss:0.0018901852890849113
2023-04-27 23:10:52 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2389066070318222, mean p set: 0.4499112665653229
loss_pred:0.015819819644093513, decouple_loss:0.002194260014221072
The modified gen p mean: 0.4482680559158325, gen p mean: -0.23602837324142456, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930458068847656, gen p mean: -0.23900456726551056, mean p set: 0.4498290419578552
loss_pred:0.015679698437452316, decouple_loss:0.002175444271415472
loss_pred:0.015352770686149597, decouple_loss:0.0023349514231085777
WV_1_PC_1_EH_0_PS_30, loss: 0.01572917401790619, avg_mse: 0.02335462160408497
current test mse: 0.023355
Iteration: 4551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743552803993225, gen p mean: -0.23903405666351318, mean p set: 0.44801095128059387
loss_pred:0.014316114597022533, decouple_loss:0.001758482540026307
The modified gen p mean: 0.4477821886539459, gen p mean: -0.24191121757030487, mean p set: 0.44836223125457764
loss_pred:0.014681600965559483, decouple_loss:0.0018992297118529677
The modified gen p mean: 0.4475706219673157, gen p mean: -0.24389487504959106, mean p set: 0.44810163974761963
loss_pred:0.013815737329423428, decouple_loss:0.0019622971303761005
Iteration: 4552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778189063072205, gen p mean: -0.23888899385929108, mean p set: 0.4483092129230499
loss_pred:0.013995678164064884, decouple_loss:0.0019478995818644762
The modified gen p mean: 0.4480412006378174, gen p mean: -0.2343803346157074, mean p set: 0.4486178159713745
loss_pred:0.014089135453104973, decouple_loss:0.0019558188505470753
The modified gen p mean: 0.44883838295936584, gen p mean: -0.23773391544818878, mean p set: 0.44941920042037964
loss_pred:0.01425210665911436, decouple_loss:0.0017563635483384132
Iteration: 4553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791242480278015, gen p mean: -0.23562395572662354, mean p set: 0.4484424889087677
loss_pred:0.014328325167298317, decouple_loss:0.0017338864272460341
The modified gen p mean: 0.4473199248313904, gen p mean: -0.2310156375169754, mean p set: 0.44789305329322815
loss_pred:0.014571482315659523, decouple_loss:0.0017948142485693097
The modified gen p mean: 0.44673094153404236, gen p mean: -0.232732355594635, mean p set: 0.44730639457702637
loss_pred:0.014072942547500134, decouple_loss:0.0018593595596030354
Iteration: 4554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476083815097809, gen p mean: -0.23310084640979767, mean p set: 0.4481314718723297
loss_pred:0.0148152532055974, decouple_loss:0.00180386274587363
The modified gen p mean: 0.4493519365787506, gen p mean: -0.23231902718544006, mean p set: 0.4499293565750122
loss_pred:0.014165847562253475, decouple_loss:0.0017961520934477448
The modified gen p mean: 0.44857680797576904, gen p mean: -0.22714801132678986, mean p set: 0.4491572082042694
loss_pred:0.013386154547333717, decouple_loss:0.0018014691304415464
Iteration: 4555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931846857070923, gen p mean: -0.23730435967445374, mean p set: 0.449893593788147
loss_pred:0.01394935604184866, decouple_loss:0.0019693737849593163
The modified gen p mean: 0.44950568675994873, gen p mean: -0.22939786314964294, mean p set: 0.45008060336112976The modified gen p mean: 0.44715049862861633, gen p mean: -0.23474012315273285, mean p set: 0.44768157601356506
loss_pred:0.013833031058311462, decouple_loss:0.001729855895973742
loss_pred:0.014225568622350693, decouple_loss:0.0017150724306702614
Iteration: 4556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486296474933624, gen p mean: -0.23844102025032043, mean p set: 0.4492034912109375
loss_pred:0.014171869494020939, decouple_loss:0.0016106599941849709
The modified gen p mean: 0.4479893743991852, gen p mean: -0.22633464634418488, mean p set: 0.4485621154308319The modified gen p mean: 0.4487861394882202, gen p mean: -0.23973263800144196, mean p set: 0.449317067861557
loss_pred:0.013685936108231544, decouple_loss:0.0023359290789812803
loss_pred:0.013547178357839584, decouple_loss:0.0017025652341544628
Iteration: 4557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975289702415466, gen p mean: -0.23467274010181427, mean p set: 0.45032650232315063
loss_pred:0.013904186896979809, decouple_loss:0.0016005940269678831
The modified gen p mean: 0.4480217397212982, gen p mean: -0.2365597039461136, mean p set: 0.4485989212989807The modified gen p mean: 0.4483496844768524, gen p mean: -0.2385888397693634, mean p set: 0.44887539744377136
loss_pred:0.014623545110225677, decouple_loss:0.0016376684652641416
loss_pred:0.014184228144586086, decouple_loss:0.0017948150634765625
Iteration: 4558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746312499046326, gen p mean: -0.2264762967824936, mean p set: 0.44804272055625916
loss_pred:0.013581876643002033, decouple_loss:0.0018791495822370052
The modified gen p mean: 0.4483721852302551, gen p mean: -0.2379213273525238, mean p set: 0.448948472738266
loss_pred:0.01463409885764122, decouple_loss:0.0015876536490395665
The modified gen p mean: 0.44783902168273926, gen p mean: -0.24074162542819977, mean p set: 0.44836267828941345
loss_pred:0.014549784362316132, decouple_loss:0.0014492992777377367
Iteration: 4559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891366362571716, gen p mean: -0.23818059265613556, mean p set: 0.44948384165763855
loss_pred:0.014299292117357254, decouple_loss:0.0018952508689835668
The modified gen p mean: 0.4488447904586792, gen p mean: -0.2321208119392395, mean p set: 0.4493674635887146The modified gen p mean: 0.4471832811832428, gen p mean: -0.23618760704994202, mean p set: 0.4477550983428955
loss_pred:0.014149805530905724, decouple_loss:0.0019245250150561333
loss_pred:0.014010129496455193, decouple_loss:0.001937279594130814
Iteration: 4560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488371014595032, gen p mean: -0.23237840831279755, mean p set: 0.4494136571884155
loss_pred:0.013386017642915249, decouple_loss:0.001691320794634521
The modified gen p mean: 0.44716593623161316, gen p mean: -0.22925570607185364, mean p set: 0.44773876667022705
loss_pred:0.014385300688445568, decouple_loss:0.0014705054927617311
The modified gen p mean: 0.44830700755119324, gen p mean: -0.22850722074508667, mean p set: 0.44884148240089417
loss_pred:0.013327461667358875, decouple_loss:0.0016222377307713032
2023-04-27 23:14:16 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2282840609550476, mean p set: 0.4499112665653229
loss_pred:0.01575125753879547, decouple_loss:0.0017836253391578794
The modified gen p mean: 0.44827431440353394, gen p mean: -0.22559291124343872, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492976665496826, gen p mean: -0.22831061482429504, mean p set: 0.4498290419578552
loss_pred:0.015665413811802864, decouple_loss:0.0017530819168314338
loss_pred:0.015272281132638454, decouple_loss:0.0017969899345189333
WV_1_PC_1_EH_0_PS_30, loss: 0.015651879832148552, avg_mse: 0.02324553392827511
current test mse: 0.023246
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 4561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693058729171753, gen p mean: -0.22547516226768494, mean p set: 0.4474572539329529
loss_pred:0.014019017107784748, decouple_loss:0.0017341250786557794
The modified gen p mean: 0.44727247953414917, gen p mean: -0.22705680131912231, mean p set: 0.4478446841239929
loss_pred:0.014478317461907864, decouple_loss:0.0015877204714342952
The modified gen p mean: 0.44838225841522217, gen p mean: -0.22758705914020538, mean p set: 0.44895458221435547
loss_pred:0.013610241934657097, decouple_loss:0.001710228738375008
Iteration: 4562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448162704706192, gen p mean: -0.23034508526325226, mean p set: 0.4486897885799408
loss_pred:0.013844085857272148, decouple_loss:0.0014773467555642128
The modified gen p mean: 0.4482971131801605, gen p mean: -0.22918306291103363, mean p set: 0.448875367641449The modified gen p mean: 0.44780758023262024, gen p mean: -0.23117561638355255, mean p set: 0.4483831226825714
loss_pred:0.013965890742838383, decouple_loss:0.0018046783516183496
loss_pred:0.013648099265992641, decouple_loss:0.00149677658919245
Iteration: 4563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682133197784424, gen p mean: -0.24069693684577942, mean p set: 0.4473487436771393
loss_pred:0.014357298612594604, decouple_loss:0.0019236445659771562
The modified gen p mean: 0.4475840628147125, gen p mean: -0.2361816167831421, mean p set: 0.44815701246261597The modified gen p mean: 0.4471048414707184, gen p mean: -0.23090612888336182, mean p set: 0.4476827085018158
loss_pred:0.014108309522271156, decouple_loss:0.0019166130805388093
loss_pred:0.01394687034189701, decouple_loss:0.0018398626707494259
Iteration: 4564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838792085647583, gen p mean: -0.23490279912948608, mean p set: 0.4489155113697052
loss_pred:0.013966101221740246, decouple_loss:0.002039913786575198
The modified gen p mean: 0.4473411738872528, gen p mean: -0.23764653503894806, mean p set: 0.44791606068611145The modified gen p mean: 0.44752106070518494, gen p mean: -0.2438579499721527, mean p set: 0.4481002688407898
loss_pred:0.01388673298060894, decouple_loss:0.0016763447783887386
loss_pred:0.014313200488686562, decouple_loss:0.001626799232326448
Iteration: 4565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772472977638245, gen p mean: -0.23492185771465302, mean p set: 0.44829997420310974
loss_pred:0.01416734978556633, decouple_loss:0.00182775454595685
The modified gen p mean: 0.4474168121814728, gen p mean: -0.23724567890167236, mean p set: 0.4479939937591553
loss_pred:0.0139436861500144, decouple_loss:0.0017653931863605976
The modified gen p mean: 0.4468562602996826, gen p mean: -0.22891822457313538, mean p set: 0.44738268852233887
loss_pred:0.014606579206883907, decouple_loss:0.001738960389047861
Iteration: 4566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768524169921875, gen p mean: -0.23775550723075867, mean p set: 0.44826218485832214
loss_pred:0.013577121309936047, decouple_loss:0.0018695748876780272
The modified gen p mean: 0.44728904962539673, gen p mean: -0.23518654704093933, mean p set: 0.4478660821914673
loss_pred:0.013774476014077663, decouple_loss:0.0019746809266507626
The modified gen p mean: 0.4478815197944641, gen p mean: -0.23609380424022675, mean p set: 0.44841110706329346
loss_pred:0.014604306779801846, decouple_loss:0.0017251943936571479
Iteration: 4567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811519980430603, gen p mean: -0.23042349517345428, mean p set: 0.4486396908760071
loss_pred:0.014111178927123547, decouple_loss:0.001723076100461185
The modified gen p mean: 0.44706305861473083, gen p mean: -0.23587782680988312, mean p set: 0.4476391673088074
loss_pred:0.013646012172102928, decouple_loss:0.0017995578236877918
The modified gen p mean: 0.4479319155216217, gen p mean: -0.230661541223526, mean p set: 0.44850608706474304
loss_pred:0.013274903409183025, decouple_loss:0.0018687975825741887
Iteration: 4568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466325342655182, gen p mean: -0.23241952061653137, mean p set: 0.44716405868530273
loss_pred:0.014160615392029285, decouple_loss:0.001614157110452652
The modified gen p mean: 0.4468268156051636, gen p mean: -0.22944284975528717, mean p set: 0.44740498065948486
The modified gen p mean: 0.4478886127471924, gen p mean: -0.22732721269130707, mean p set: 0.44846025109291077
loss_pred:0.01404858659952879, decouple_loss:0.0015535742277279496
loss_pred:0.013752615079283714, decouple_loss:0.0016107441624626517
Iteration: 4569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802790880203247, gen p mean: -0.23228226602077484, mean p set: 0.44859424233436584
loss_pred:0.01414551679044962, decouple_loss:0.0016250094631686807
The modified gen p mean: 0.4492523670196533, gen p mean: -0.23039448261260986, mean p set: 0.4498293101787567
loss_pred:0.01388523168861866, decouple_loss:0.0017732075648382306
The modified gen p mean: 0.4489402174949646, gen p mean: -0.23288197815418243, mean p set: 0.4494676887989044
loss_pred:0.013932702131569386, decouple_loss:0.0018162000924348831
Iteration: 4570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470808804035187, gen p mean: -0.23869097232818604, mean p set: 0.44761136174201965
loss_pred:0.014484847895801067, decouple_loss:0.0015682014636695385
The modified gen p mean: 0.44752824306488037, gen p mean: -0.23629480600357056, mean p set: 0.44810861349105835The modified gen p mean: 0.446516215801239, gen p mean: -0.2319948673248291, mean p set: 0.4470857083797455
loss_pred:0.013925495557487011, decouple_loss:0.0015661884099245071loss_pred:0.015060468576848507, decouple_loss:0.0016577070346102118
2023-04-27 23:18:22 testing...
The modified gen p mean: 0.448272705078125, gen p mean: -0.23699739575386047, mean p set: 0.44879910349845886
loss_pred:0.01655973307788372, decouple_loss:0.0016607647994533181
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23949562013149261, mean p set: 0.4499112665653229
loss_pred:0.016662567853927612, decouple_loss:0.0017205371987074614
The modified gen p mean: 0.4492969214916229, gen p mean: -0.2398499995470047, mean p set: 0.4498290419578552
loss_pred:0.016242727637290955, decouple_loss:0.0016716363606974483
WV_1_PC_1_EH_0_PS_30, loss: 0.016572559252381325, avg_mse: 0.024968765676021576
current test mse: 0.024969
Iteration: 4571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852563738822937, gen p mean: -0.2369936853647232, mean p set: 0.4491024613380432
loss_pred:0.014341694302856922, decouple_loss:0.0016212092014029622
The modified gen p mean: 0.4482722878456116, gen p mean: -0.23660314083099365, mean p set: 0.4488039016723633
loss_pred:0.013935004360973835, decouple_loss:0.0016271461499854922
The modified gen p mean: 0.4468201696872711, gen p mean: -0.24099330604076385, mean p set: 0.4473954439163208
loss_pred:0.015261316671967506, decouple_loss:0.0017524512950330973
Iteration: 4572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682666659355164, gen p mean: -0.24432560801506042, mean p set: 0.44735386967658997
loss_pred:0.0154692018404603, decouple_loss:0.0015493308892473578
The modified gen p mean: 0.44769808650016785, gen p mean: -0.23912791907787323, mean p set: 0.44827526807785034
loss_pred:0.015251796692609787, decouple_loss:0.001549115520901978
The modified gen p mean: 0.44717633724212646, gen p mean: -0.2413937747478485, mean p set: 0.4477500915527344
loss_pred:0.014850722625851631, decouple_loss:0.0015460258582606912
Iteration: 4573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640955328941345, gen p mean: -0.24362556636333466, mean p set: 0.44693389534950256
loss_pred:0.014886257238686085, decouple_loss:0.001907102414406836
The modified gen p mean: 0.4480137825012207, gen p mean: -0.23986773192882538, mean p set: 0.4485850930213928
loss_pred:0.014131268486380577, decouple_loss:0.0019202518742531538
The modified gen p mean: 0.4478873312473297, gen p mean: -0.2457893192768097, mean p set: 0.44846752285957336
loss_pred:0.0139703880995512, decouple_loss:0.0018195902230218053
Iteration: 4574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478984475135803, gen p mean: -0.2397351711988449, mean p set: 0.4484281837940216
loss_pred:0.015329621732234955, decouple_loss:0.0021468265913426876
The modified gen p mean: 0.44633612036705017, gen p mean: -0.24293728172779083, mean p set: 0.44691917300224304
loss_pred:0.01487848162651062, decouple_loss:0.002179028932005167
The modified gen p mean: 0.4476567208766937, gen p mean: -0.23420937359333038, mean p set: 0.4482302665710449
loss_pred:0.014016808941960335, decouple_loss:0.001965967705473304
Iteration: 4575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474785029888153, gen p mean: -0.221577450633049, mean p set: 0.4480552673339844
loss_pred:0.01445018406957388, decouple_loss:0.002054042648524046
The modified gen p mean: 0.447877436876297, gen p mean: -0.22228024899959564, mean p set: 0.4484524726867676The modified gen p mean: 0.44972461462020874, gen p mean: -0.22061516344547272, mean p set: 0.45025789737701416
loss_pred:0.01476169005036354, decouple_loss:0.00207332381978631
loss_pred:0.014219658449292183, decouple_loss:0.0020994904916733503
Iteration: 4576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44607508182525635, gen p mean: -0.2455642968416214, mean p set: 0.44665467739105225
loss_pred:0.01526075229048729, decouple_loss:0.0020559141412377357
The modified gen p mean: 0.44908592104911804, gen p mean: -0.24751318991184235, mean p set: 0.4496593773365021The modified gen p mean: 0.44943946599960327, gen p mean: -0.24865661561489105, mean p set: 0.4499613046646118
loss_pred:0.0136724803596735, decouple_loss:0.002352084033191204
loss_pred:0.013874636963009834, decouple_loss:0.002331164199858904
Iteration: 4577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448160320520401, gen p mean: -0.255708783864975, mean p set: 0.44874149560928345
loss_pred:0.014120173640549183, decouple_loss:0.0021942814346402884
The modified gen p mean: 0.44846221804618835, gen p mean: -0.25986239314079285, mean p set: 0.4489942789077759The modified gen p mean: 0.44781801104545593, gen p mean: -0.2590451240539551, mean p set: 0.4483965039253235
loss_pred:0.014584330841898918, decouple_loss:0.0023489552550017834
loss_pred:0.014289156533777714, decouple_loss:0.0025226236321032047
Iteration: 4578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826221466064453, gen p mean: -0.2558487057685852, mean p set: 0.4488346576690674
loss_pred:0.014637880027294159, decouple_loss:0.002159672323614359
The modified gen p mean: 0.4489081799983978, gen p mean: -0.25595831871032715, mean p set: 0.449484258890152
loss_pred:0.014540119096636772, decouple_loss:0.002107278211042285
The modified gen p mean: 0.4476015865802765, gen p mean: -0.2550466060638428, mean p set: 0.44813862442970276
loss_pred:0.01522858627140522, decouple_loss:0.002113646361976862
Iteration: 4579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447664350271225, gen p mean: -0.2508281171321869, mean p set: 0.4482366442680359
loss_pred:0.014262404292821884, decouple_loss:0.0021602530032396317
The modified gen p mean: 0.4471759498119354, gen p mean: -0.24717389047145844, mean p set: 0.447747141122818
loss_pred:0.014702240005135536, decouple_loss:0.002070826943963766
The modified gen p mean: 0.44674208760261536, gen p mean: -0.24976615607738495, mean p set: 0.4472673535346985
loss_pred:0.015113319270312786, decouple_loss:0.002178685273975134
Iteration: 4580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479483962059021, gen p mean: -0.23438093066215515, mean p set: 0.4485248327255249
loss_pred:0.014296206645667553, decouple_loss:0.0022294067312031984
The modified gen p mean: 0.448193222284317, gen p mean: -0.2350747436285019, mean p set: 0.44876906275749207
loss_pred:0.013513785786926746, decouple_loss:0.002215452492237091
The modified gen p mean: 0.44852709770202637, gen p mean: -0.24381119012832642, mean p set: 0.44905540347099304
loss_pred:0.014455595053732395, decouple_loss:0.002323782304301858
2023-04-27 23:21:47 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22970491647720337, mean p set: 0.4499112665653229
loss_pred:0.01609518937766552, decouple_loss:0.0022408992517739534
The modified gen p mean: 0.4482659697532654, gen p mean: -0.2266770601272583, mean p set: 0.44879910349845886
The modified gen p mean: 0.4493049681186676, gen p mean: -0.2293718010187149, mean p set: 0.4498290419578552
loss_pred:0.015904108062386513, decouple_loss:0.002221564995124936
loss_pred:0.015588661655783653, decouple_loss:0.0021610488183796406
WV_1_PC_1_EH_0_PS_30, loss: 0.0159730464220047, avg_mse: 0.023601915687322617
current test mse: 0.023602
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 4581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506694972515106, gen p mean: -0.2284424901008606, mean p set: 0.4511975646018982
loss_pred:0.015063511207699776, decouple_loss:0.0022190145682543516
The modified gen p mean: 0.44931650161743164, gen p mean: -0.22970718145370483, mean p set: 0.44988662004470825
loss_pred:0.015387567691504955, decouple_loss:0.00218262430280447
The modified gen p mean: 0.4492327570915222, gen p mean: -0.23065541684627533, mean p set: 0.4498046338558197
loss_pred:0.01607244834303856, decouple_loss:0.002261993708088994
Iteration: 4582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489173889160156, gen p mean: -0.22748807072639465, mean p set: 0.44944941997528076
loss_pred:0.01576625183224678, decouple_loss:0.002354324096813798
The modified gen p mean: 0.4500751495361328, gen p mean: -0.22511732578277588, mean p set: 0.4506498873233795
The modified gen p mean: 0.44924354553222656, gen p mean: -0.22844892740249634, mean p set: 0.4498143792152405
loss_pred:0.015853390097618103, decouple_loss:0.002436859766021371
loss_pred:0.01553866732865572, decouple_loss:0.002251209458336234
Iteration: 4583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500349462032318, gen p mean: -0.2290738970041275, mean p set: 0.45056453347206116
loss_pred:0.01606709510087967, decouple_loss:0.002250466262921691
The modified gen p mean: 0.44979262351989746, gen p mean: -0.22459274530410767, mean p set: 0.45036831498146057
The modified gen p mean: 0.4503699243068695, gen p mean: -0.22639429569244385, mean p set: 0.4509483277797699
loss_pred:0.015210582874715328, decouple_loss:0.002306627342477441
loss_pred:0.016406996175646782, decouple_loss:0.002445443067699671
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507383704185486, gen p mean: -0.22736889123916626, mean p set: 0.45127072930336
loss_pred:0.015518227592110634, decouple_loss:0.0023957425728440285
The modified gen p mean: 0.4489573538303375, gen p mean: -0.22395159304141998, mean p set: 0.44952836632728577The modified gen p mean: 0.4502483308315277, gen p mean: -0.22343546152114868, mean p set: 0.4508230984210968
loss_pred:0.015199078246951103, decouple_loss:0.0020604985766112804
loss_pred:0.015397585928440094, decouple_loss:0.0022429313976317644
Iteration: 4585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955873489379883, gen p mean: -0.22139771282672882, mean p set: 0.4501415491104126
loss_pred:0.015242919325828552, decouple_loss:0.0022559380158782005
The modified gen p mean: 0.44925034046173096, gen p mean: -0.21888551115989685, mean p set: 0.4498307406902313
loss_pred:0.014962077140808105, decouple_loss:0.0021635033190250397
The modified gen p mean: 0.4498525559902191, gen p mean: -0.21903276443481445, mean p set: 0.45038241147994995
loss_pred:0.015170320868492126, decouple_loss:0.002219413174316287
Iteration: 4586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44946494698524475, gen p mean: -0.2161019891500473, mean p set: 0.4500381648540497
loss_pred:0.014944079332053661, decouple_loss:0.002082421677187085
The modified gen p mean: 0.44880691170692444, gen p mean: -0.2160303145647049, mean p set: 0.4493815302848816
loss_pred:0.015601174905896187, decouple_loss:0.002092790324240923
The modified gen p mean: 0.451188862323761, gen p mean: -0.2154795229434967, mean p set: 0.4517151713371277
loss_pred:0.015394684858620167, decouple_loss:0.0023990573827177286
Iteration: 4587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44967660307884216, gen p mean: -0.2143891453742981, mean p set: 0.4502556622028351
loss_pred:0.015394999645650387, decouple_loss:0.0022349117789417505
The modified gen p mean: 0.450189471244812, gen p mean: -0.2172154039144516, mean p set: 0.4507182538509369The modified gen p mean: 0.4485938847064972, gen p mean: -0.21572528779506683, mean p set: 0.4491656422615051
loss_pred:0.015188629738986492, decouple_loss:0.0022389583755284548
loss_pred:0.014752096496522427, decouple_loss:0.0021216704044491053
Iteration: 4588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934388995170593, gen p mean: -0.21325735747814178, mean p set: 0.4499199688434601
loss_pred:0.015078098513185978, decouple_loss:0.0021151681430637836
The modified gen p mean: 0.4493091106414795, gen p mean: -0.21340928971767426, mean p set: 0.44988352060317993
loss_pred:0.014792357571423054, decouple_loss:0.0021394439972937107
The modified gen p mean: 0.44964703917503357, gen p mean: -0.21307042241096497, mean p set: 0.45017993450164795
loss_pred:0.015245484188199043, decouple_loss:0.002019906882196665
Iteration: 4589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009949803352356, gen p mean: -0.2125411033630371, mean p set: 0.45067691802978516
loss_pred:0.015593796037137508, decouple_loss:0.0021881889551877975
The modified gen p mean: 0.4494847357273102, gen p mean: -0.21461163461208344, mean p set: 0.45006564259529114
loss_pred:0.015301452949643135, decouple_loss:0.0021970367524772882
The modified gen p mean: 0.4493095874786377, gen p mean: -0.21400143206119537, mean p set: 0.4498342275619507
loss_pred:0.015049987472593784, decouple_loss:0.0022177607752382755
Iteration: 4590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500487744808197, gen p mean: -0.22125111520290375, mean p set: 0.45062586665153503
loss_pred:0.015432572923600674, decouple_loss:0.0019299340201541781
The modified gen p mean: 0.45035520195961, gen p mean: -0.21679306030273438, mean p set: 0.45092761516571045
loss_pred:0.015254746191203594, decouple_loss:0.0020671505481004715
The modified gen p mean: 0.4490821361541748, gen p mean: -0.22248387336730957, mean p set: 0.4496159553527832
loss_pred:0.015236766077578068, decouple_loss:0.0019215111387893558
2023-04-27 23:25:49 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2248459756374359, mean p set: 0.4499112665653229
loss_pred:0.015368959866464138, decouple_loss:0.0020958587992936373
The modified gen p mean: 0.44827866554260254, gen p mean: -0.22201912105083466, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492954611778259, gen p mean: -0.22472460567951202, mean p set: 0.4498290419578552
loss_pred:0.01545786950737238, decouple_loss:0.0021343438420444727
loss_pred:0.0145160723477602, decouple_loss:0.002109951339662075
WV_1_PC_1_EH_0_PS_30, loss: 0.015219970606267452, avg_mse: 0.022313367575407028
current test mse: 0.022313
Iteration: 4591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501631259918213, gen p mean: -0.22533923387527466, mean p set: 0.45073747634887695
loss_pred:0.015804655849933624, decouple_loss:0.002125913742929697
The modified gen p mean: 0.45024004578590393, gen p mean: -0.22060807049274445, mean p set: 0.4507621228694916
loss_pred:0.015627501532435417, decouple_loss:0.0022633045446127653
The modified gen p mean: 0.44901585578918457, gen p mean: -0.22077736258506775, mean p set: 0.4495888352394104
loss_pred:0.015046556480228901, decouple_loss:0.0020231246016919613
Iteration: 4592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497590959072113, gen p mean: -0.22267986834049225, mean p set: 0.4502823054790497
loss_pred:0.015277579426765442, decouple_loss:0.0022068843245506287
The modified gen p mean: 0.45052313804626465, gen p mean: -0.22265325486660004, mean p set: 0.451102077960968
loss_pred:0.014769425615668297, decouple_loss:0.0023065663408488035
The modified gen p mean: 0.4497687816619873, gen p mean: -0.22579677402973175, mean p set: 0.4503425657749176
loss_pred:0.0148091409355402, decouple_loss:0.002230448881164193
Iteration: 4593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492129385471344, gen p mean: -0.22245749831199646, mean p set: 0.44973650574684143
loss_pred:0.014809445478022099, decouple_loss:0.002049368340522051
The modified gen p mean: 0.45042210817337036, gen p mean: -0.22543181478977203, mean p set: 0.4510018229484558
loss_pred:0.01608281582593918, decouple_loss:0.00224200077354908
The modified gen p mean: 0.44803348183631897, gen p mean: -0.2206191122531891, mean p set: 0.448609322309494
loss_pred:0.015298761427402496, decouple_loss:0.0020601481664925814
Iteration: 4594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033591985702515, gen p mean: -0.2144896239042282, mean p set: 0.4508611261844635
loss_pred:0.015445845201611519, decouple_loss:0.0023081174585968256
The modified gen p mean: 0.4496289789676666, gen p mean: -0.21801404654979706, mean p set: 0.4502067267894745
loss_pred:0.01465619821101427, decouple_loss:0.0022121071815490723
The modified gen p mean: 0.44955873489379883, gen p mean: -0.21689410507678986, mean p set: 0.450135201215744
loss_pred:0.014557849615812302, decouple_loss:0.002083767903968692
Iteration: 4595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449250727891922, gen p mean: -0.21281515061855316, mean p set: 0.4498307704925537
loss_pred:0.015201221220195293, decouple_loss:0.0019330622162669897
The modified gen p mean: 0.4481142461299896, gen p mean: -0.21362486481666565, mean p set: 0.4486955404281616The modified gen p mean: 0.44920313358306885, gen p mean: -0.2152353823184967, mean p set: 0.44972866773605347
loss_pred:0.015328016132116318, decouple_loss:0.0019380170851945877
loss_pred:0.015483926050364971, decouple_loss:0.001960177905857563
Iteration: 4596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861850142478943, gen p mean: -0.2209904044866562, mean p set: 0.4491928219795227
loss_pred:0.014909145422279835, decouple_loss:0.0020042508840560913
The modified gen p mean: 0.45005255937576294, gen p mean: -0.22190450131893158, mean p set: 0.450583815574646
The modified gen p mean: 0.4504970908164978, gen p mean: -0.2144319862127304, mean p set: 0.4510757029056549
loss_pred:0.01531274989247322, decouple_loss:0.002042836509644985
loss_pred:0.01547787245362997, decouple_loss:0.002063506282866001
Iteration: 4597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485200047492981, gen p mean: -0.21495221555233002, mean p set: 0.4490925073623657
loss_pred:0.015468032099306583, decouple_loss:0.001739931060001254
The modified gen p mean: 0.44988924264907837, gen p mean: -0.21323688328266144, mean p set: 0.4504148066043854The modified gen p mean: 0.45067939162254333, gen p mean: -0.21799510717391968, mean p set: 0.4512575566768646
loss_pred:0.015614715404808521, decouple_loss:0.0017458716174587607
loss_pred:0.015497155487537384, decouple_loss:0.0018199145561084151
Iteration: 4598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45073625445365906, gen p mean: -0.222081258893013, mean p set: 0.4513084292411804
loss_pred:0.014936733059585094, decouple_loss:0.001837136223912239
The modified gen p mean: 0.4505935311317444, gen p mean: -0.2183038294315338, mean p set: 0.45116761326789856
loss_pred:0.015383364632725716, decouple_loss:0.00199532276019454
The modified gen p mean: 0.4496196210384369, gen p mean: -0.21696287393569946, mean p set: 0.45014673471450806
loss_pred:0.014901015907526016, decouple_loss:0.0018859972478821874
Iteration: 4599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862881302833557, gen p mean: -0.22578959167003632, mean p set: 0.4492048919200897
loss_pred:0.014786196872591972, decouple_loss:0.001895819790661335
The modified gen p mean: 0.44937756657600403, gen p mean: -0.22352494299411774, mean p set: 0.44995349645614624
loss_pred:0.014862041920423508, decouple_loss:0.0017603787127882242
The modified gen p mean: 0.44916945695877075, gen p mean: -0.2259257286787033, mean p set: 0.4496990144252777
loss_pred:0.015760671347379684, decouple_loss:0.001960055436939001
Iteration: 4600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45006296038627625, gen p mean: -0.2290269136428833, mean p set: 0.4506319463253021
loss_pred:0.014948813244700432, decouple_loss:0.0016993718454614282
The modified gen p mean: 0.4500392973423004, gen p mean: -0.23312833905220032, mean p set: 0.4506154954433441
loss_pred:0.01522776111960411, decouple_loss:0.0017281206091865897
The modified gen p mean: 0.4486565589904785, gen p mean: -0.23061716556549072, mean p set: 0.4491916298866272
loss_pred:0.014994196593761444, decouple_loss:0.0018045403994619846
2023-04-27 23:29:14 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23533689975738525, mean p set: 0.4499112665653229
loss_pred:0.014938870444893837, decouple_loss:0.0018701392691582441
The modified gen p mean: 0.4482719600200653, gen p mean: -0.2325802445411682, mean p set: 0.44879910349845886
The modified gen p mean: 0.44929954409599304, gen p mean: -0.2351619005203247, mean p set: 0.4498290419578552
loss_pred:0.014577088877558708, decouple_loss:0.001929262769408524
loss_pred:0.01442713849246502, decouple_loss:0.001948114950209856
WV_1_PC_1_EH_0_PS_30, loss: 0.014743492007255554, avg_mse: 0.021474504843354225
current test mse: 0.021475
At step 4600, Best test: 0.021475
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 4601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630491733551025, gen p mean: -0.23147837817668915, mean p set: 0.4468391239643097
loss_pred:0.014905494637787342, decouple_loss:0.0021923803724348545
The modified gen p mean: 0.4480975270271301, gen p mean: -0.23605148494243622, mean p set: 0.4486686885356903
loss_pred:0.015184792689979076, decouple_loss:0.002245469018816948
The modified gen p mean: 0.4483184814453125, gen p mean: -0.23677055537700653, mean p set: 0.44889581203460693
loss_pred:0.015144957229495049, decouple_loss:0.0023959511891007423
Iteration: 4602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751405715942383, gen p mean: -0.2314525842666626, mean p set: 0.4480399191379547
loss_pred:0.014318715780973434, decouple_loss:0.0019484548829495907
The modified gen p mean: 0.4473617374897003, gen p mean: -0.234258234500885, mean p set: 0.4479406476020813The modified gen p mean: 0.44886741042137146, gen p mean: -0.22576963901519775, mean p set: 0.44944167137145996
loss_pred:0.014477335847914219, decouple_loss:0.0019239947432652116loss_pred:0.014861087314784527, decouple_loss:0.0021964048501104116
Iteration: 4603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475751221179962, gen p mean: -0.23575864732265472, mean p set: 0.4481014013290405
loss_pred:0.014950111508369446, decouple_loss:0.0023351784329861403
The modified gen p mean: 0.4481855034828186, gen p mean: -0.2312384992837906, mean p set: 0.4487598240375519The modified gen p mean: 0.4488578736782074, gen p mean: -0.2315194010734558, mean p set: 0.4494354724884033
loss_pred:0.014828051440417767, decouple_loss:0.0023135999217629433
loss_pred:0.014849078841507435, decouple_loss:0.002162427408620715
Iteration: 4604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479871988296509, gen p mean: -0.22860519587993622, mean p set: 0.4485113322734833
loss_pred:0.014176701195538044, decouple_loss:0.0022474550642073154
The modified gen p mean: 0.44746869802474976, gen p mean: -0.23168115317821503, mean p set: 0.4480428397655487The modified gen p mean: 0.4462110996246338, gen p mean: -0.23187954723834991, mean p set: 0.4467865526676178
loss_pred:0.013867292553186417, decouple_loss:0.002078185323625803
loss_pred:0.014867322519421577, decouple_loss:0.002390027977526188
Iteration: 4605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470558166503906, gen p mean: -0.2240700125694275, mean p set: 0.4476326107978821
loss_pred:0.014340878464281559, decouple_loss:0.002163269557058811
The modified gen p mean: 0.4481547176837921, gen p mean: -0.22598056495189667, mean p set: 0.4486868679523468The modified gen p mean: 0.44826260209083557, gen p mean: -0.22606106102466583, mean p set: 0.4488369822502136
loss_pred:0.014560098759829998, decouple_loss:0.0020328001119196415
loss_pred:0.014366102404892445, decouple_loss:0.0021173928398638964
Iteration: 4606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476531147956848, gen p mean: -0.23305803537368774, mean p set: 0.448184072971344
loss_pred:0.014650852419435978, decouple_loss:0.00209394795820117
The modified gen p mean: 0.4483642578125, gen p mean: -0.2263411432504654, mean p set: 0.4489421248435974The modified gen p mean: 0.4471963047981262, gen p mean: -0.2264702320098877, mean p set: 0.44777119159698486
loss_pred:0.014358911663293839, decouple_loss:0.0019062606152147055
loss_pred:0.014705429784953594, decouple_loss:0.0020569858606904745
Iteration: 4607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869598746299744, gen p mean: -0.22555622458457947, mean p set: 0.4492167532444
loss_pred:0.014964723959565163, decouple_loss:0.002115935552865267
The modified gen p mean: 0.44737327098846436, gen p mean: -0.23202039301395416, mean p set: 0.44794782996177673
The modified gen p mean: 0.4472328722476959, gen p mean: -0.22290457785129547, mean p set: 0.44780370593070984
loss_pred:0.015086901374161243, decouple_loss:0.0021283309906721115
loss_pred:0.015031336806714535, decouple_loss:0.0019398170989006758
Iteration: 4608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44557562470436096, gen p mean: -0.2385568916797638, mean p set: 0.4461473524570465
loss_pred:0.014837965369224548, decouple_loss:0.0020844966638833284
The modified gen p mean: 0.4474247097969055, gen p mean: -0.2345999926328659, mean p set: 0.4480014741420746
loss_pred:0.014420684427022934, decouple_loss:0.0018984456546604633
The modified gen p mean: 0.4453159272670746, gen p mean: -0.2382936030626297, mean p set: 0.44584187865257263
loss_pred:0.014977888204157352, decouple_loss:0.0020666143391281366
Iteration: 4609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481203258037567, gen p mean: -0.23841720819473267, mean p set: 0.44869908690452576
loss_pred:0.014166769571602345, decouple_loss:0.002077920828014612
The modified gen p mean: 0.447063148021698, gen p mean: -0.23364505171775818, mean p set: 0.44764459133148193
loss_pred:0.014025705866515636, decouple_loss:0.001818247837945819
The modified gen p mean: 0.4493180513381958, gen p mean: -0.22820143401622772, mean p set: 0.44985130429267883
loss_pred:0.014304447919130325, decouple_loss:0.002061479724943638
Iteration: 4610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487294852733612, gen p mean: -0.22721529006958008, mean p set: 0.44930681586265564
loss_pred:0.014926135540008545, decouple_loss:0.0021094854455441236
The modified gen p mean: 0.4475487172603607, gen p mean: -0.23914439976215363, mean p set: 0.44812238216400146
loss_pred:0.014652520418167114, decouple_loss:0.0022262418642640114
The modified gen p mean: 0.4459305703639984, gen p mean: -0.23711664974689484, mean p set: 0.44645223021507263
loss_pred:0.01459328830242157, decouple_loss:0.002257756656035781
2023-04-27 23:33:22 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2345597892999649, mean p set: 0.4499112665653229
loss_pred:0.01522199995815754, decouple_loss:0.0019787303172051907
The modified gen p mean: 0.44826745986938477, gen p mean: -0.23169437050819397, mean p set: 0.44879910349845886
loss_pred:0.014972175471484661, decouple_loss:0.0019454112043604255
The modified gen p mean: 0.4492951035499573, gen p mean: -0.23423229157924652, mean p set: 0.4498290419578552
loss_pred:0.014764610677957535, decouple_loss:0.002029974013566971
WV_1_PC_1_EH_0_PS_30, loss: 0.015085496008396149, avg_mse: 0.022038234397768974
current test mse: 0.022038
Iteration: 4611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446319580078125, gen p mean: -0.23455651104450226, mean p set: 0.44689464569091797
loss_pred:0.014674004167318344, decouple_loss:0.00202314299531281
The modified gen p mean: 0.44784605503082275, gen p mean: -0.2334369421005249, mean p set: 0.44841864705085754
loss_pred:0.014257865957915783, decouple_loss:0.001969284377992153
The modified gen p mean: 0.4479126036167145, gen p mean: -0.23748883605003357, mean p set: 0.44844329357147217
loss_pred:0.014526236802339554, decouple_loss:0.0020855567418038845
Iteration: 4612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473608732223511, gen p mean: -0.23845915496349335, mean p set: 0.4478928744792938
loss_pred:0.01404317282140255, decouple_loss:0.002004776382818818
The modified gen p mean: 0.4484606981277466, gen p mean: -0.23475126922130585, mean p set: 0.4490351974964142
loss_pred:0.014249073341488838, decouple_loss:0.0019233180209994316
The modified gen p mean: 0.4478949308395386, gen p mean: -0.23026950657367706, mean p set: 0.44847002625465393
loss_pred:0.014676515012979507, decouple_loss:0.0018655707826837897
Iteration: 4613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471370279788971, gen p mean: -0.23423033952713013, mean p set: 0.4476655125617981
loss_pred:0.013757778331637383, decouple_loss:0.001792984432540834
The modified gen p mean: 0.4471435844898224, gen p mean: -0.23954299092292786, mean p set: 0.4477252662181854
loss_pred:0.015024179592728615, decouple_loss:0.00172626122366637
The modified gen p mean: 0.4458751976490021, gen p mean: -0.23810841143131256, mean p set: 0.44645413756370544
loss_pred:0.014175360091030598, decouple_loss:0.0018138282466679811
Iteration: 4614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481368064880371, gen p mean: -0.23946605622768402, mean p set: 0.4486646354198456
loss_pred:0.014280843548476696, decouple_loss:0.0017031591851264238
The modified gen p mean: 0.4476918578147888, gen p mean: -0.2385430932044983, mean p set: 0.44827160239219666
loss_pred:0.015265588648617268, decouple_loss:0.001682367641478777
The modified gen p mean: 0.4483731687068939, gen p mean: -0.23841017484664917, mean p set: 0.4489506781101227
loss_pred:0.014786126092076302, decouple_loss:0.0017403076635673642
Iteration: 4615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447693407535553, gen p mean: -0.23768532276153564, mean p set: 0.44826918840408325
loss_pred:0.014431011863052845, decouple_loss:0.0018991015385836363
The modified gen p mean: 0.44851452112197876, gen p mean: -0.237505704164505, mean p set: 0.44908660650253296The modified gen p mean: 0.4482171833515167, gen p mean: -0.22909192740917206, mean p set: 0.4487389624118805
loss_pred:0.014277564361691475, decouple_loss:0.0019128626445308328
loss_pred:0.014766836538910866, decouple_loss:0.0020203504245728254
Iteration: 4616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468041658401489, gen p mean: -0.23544526100158691, mean p set: 0.4473777115345001
loss_pred:0.014889555983245373, decouple_loss:0.0017009126022458076
The modified gen p mean: 0.448945552110672, gen p mean: -0.23509643971920013, mean p set: 0.44951605796813965The modified gen p mean: 0.44742536544799805, gen p mean: -0.23652240633964539, mean p set: 0.4479483664035797
loss_pred:0.014209973625838757, decouple_loss:0.0017005472909659147
loss_pred:0.01422843337059021, decouple_loss:0.0016941787907853723
Iteration: 4617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848528504371643, gen p mean: -0.2365284115076065, mean p set: 0.4490565061569214
loss_pred:0.014040990732610226, decouple_loss:0.001817860291339457
The modified gen p mean: 0.4477004408836365, gen p mean: -0.24284733831882477, mean p set: 0.4482314884662628The modified gen p mean: 0.44910597801208496, gen p mean: -0.2272951751947403, mean p set: 0.44967639446258545
loss_pred:0.014153179712593555, decouple_loss:0.002044589491561055
loss_pred:0.014142366126179695, decouple_loss:0.0018437738763168454
Iteration: 4618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482949376106262, gen p mean: -0.2302321493625641, mean p set: 0.4488692581653595
loss_pred:0.01437563356012106, decouple_loss:0.0020261909812688828
The modified gen p mean: 0.44893020391464233, gen p mean: -0.22997890412807465, mean p set: 0.4495036005973816
loss_pred:0.014786350540816784, decouple_loss:0.0019509757403284311
The modified gen p mean: 0.44798144698143005, gen p mean: -0.23411989212036133, mean p set: 0.44850867986679077
loss_pred:0.014237601310014725, decouple_loss:0.0019876654259860516
Iteration: 4619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44586220383644104, gen p mean: -0.23697388172149658, mean p set: 0.4464397132396698
loss_pred:0.014829982072114944, decouple_loss:0.001811535214073956
The modified gen p mean: 0.44706636667251587, gen p mean: -0.22765403985977173, mean p set: 0.44764280319213867
loss_pred:0.014605284668505192, decouple_loss:0.0018093774560838938
The modified gen p mean: 0.4470536410808563, gen p mean: -0.23074571788311005, mean p set: 0.4475817382335663
loss_pred:0.014540485106408596, decouple_loss:0.0018115011043846607
Iteration: 4620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483461380004883, gen p mean: -0.23210862278938293, mean p set: 0.448919415473938
loss_pred:0.014563025906682014, decouple_loss:0.0018407813040539622
The modified gen p mean: 0.44789206981658936, gen p mean: -0.23503243923187256, mean p set: 0.448468953371048
loss_pred:0.014533661305904388, decouple_loss:0.0017791708232834935
The modified gen p mean: 0.4471498429775238, gen p mean: -0.23864087462425232, mean p set: 0.44767823815345764
loss_pred:0.014333643950521946, decouple_loss:0.0019244566792622209
2023-04-27 23:36:46 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23340997099876404, mean p set: 0.4499112665653229
loss_pred:0.015107117593288422, decouple_loss:0.0019241418922320008
The modified gen p mean: 0.44827190041542053, gen p mean: -0.23048117756843567, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492947459220886, gen p mean: -0.2330508530139923, mean p set: 0.4498290419578552
loss_pred:0.014966713264584541, decouple_loss:0.0018522307509556413
loss_pred:0.01474168710410595, decouple_loss:0.001865947968326509
WV_1_PC_1_EH_0_PS_30, loss: 0.015032544732093811, avg_mse: 0.022002900019288063
current test mse: 0.022003
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 4621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45070093870162964, gen p mean: -0.22777952253818512, mean p set: 0.45123034715652466
loss_pred:0.013646690174937248, decouple_loss:0.002095947740599513
The modified gen p mean: 0.44871193170547485, gen p mean: -0.2268657386302948, mean p set: 0.4492860734462738
loss_pred:0.01394915021955967, decouple_loss:0.0021106223575770855
The modified gen p mean: 0.44809964299201965, gen p mean: -0.22825680673122406, mean p set: 0.44867458939552307
loss_pred:0.014488892629742622, decouple_loss:0.0019439503084868193
Iteration: 4622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476136565208435, gen p mean: -0.23227384686470032, mean p set: 0.44814345240592957
loss_pred:0.014539550989866257, decouple_loss:0.0022393320687115192
The modified gen p mean: 0.448974072933197, gen p mean: -0.22932863235473633, mean p set: 0.449554443359375
loss_pred:0.013793700374662876, decouple_loss:0.002163477009162307
The modified gen p mean: 0.44829875230789185, gen p mean: -0.23223933577537537, mean p set: 0.44887375831604004
loss_pred:0.014686742797493935, decouple_loss:0.0021382689010351896
Iteration: 4623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720762968063354, gen p mean: -0.23079651594161987, mean p set: 0.4477371871471405
loss_pred:0.013894539326429367, decouple_loss:0.0020532298367470503
The modified gen p mean: 0.4488023519515991, gen p mean: -0.23418346047401428, mean p set: 0.4493841528892517
loss_pred:0.013722335919737816, decouple_loss:0.0021783867850899696
The modified gen p mean: 0.4495101273059845, gen p mean: -0.24059680104255676, mean p set: 0.45009157061576843
loss_pred:0.013216733001172543, decouple_loss:0.0022550742141902447
Iteration: 4624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497528076171875, gen p mean: -0.23467032611370087, mean p set: 0.4502794146537781
loss_pred:0.01373328361660242, decouple_loss:0.0022290199995040894
The modified gen p mean: 0.44830042123794556, gen p mean: -0.23629461228847504, mean p set: 0.4488815367221832
loss_pred:0.014893347397446632, decouple_loss:0.0021091655362397432
The modified gen p mean: 0.4480170011520386, gen p mean: -0.23834539949893951, mean p set: 0.44859644770622253
loss_pred:0.013793928548693657, decouple_loss:0.0020552375353872776
Iteration: 4625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810524582862854, gen p mean: -0.24034731090068817, mean p set: 0.44867774844169617
loss_pred:0.014195326715707779, decouple_loss:0.0019073860021308064
The modified gen p mean: 0.44717937707901, gen p mean: -0.23954015970230103, mean p set: 0.4477499723434448The modified gen p mean: 0.4496746361255646, gen p mean: -0.24261780083179474, mean p set: 0.45020073652267456
loss_pred:0.013778666034340858, decouple_loss:0.001778183737769723
loss_pred:0.012941354885697365, decouple_loss:0.00203563435934484
Iteration: 4626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487505853176117, gen p mean: -0.24174630641937256, mean p set: 0.4493279755115509
loss_pred:0.01274670846760273, decouple_loss:0.002082331106066704
The modified gen p mean: 0.44906407594680786, gen p mean: -0.24087835848331451, mean p set: 0.4496400058269501The modified gen p mean: 0.44852226972579956, gen p mean: -0.2390759438276291, mean p set: 0.44904303550720215
loss_pred:0.013626757077872753, decouple_loss:0.002326984191313386
loss_pred:0.014345142990350723, decouple_loss:0.0018927543424069881
Iteration: 4627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44964778423309326, gen p mean: -0.2325206845998764, mean p set: 0.4502353370189667
loss_pred:0.013334098272025585, decouple_loss:0.0019723912701010704
The modified gen p mean: 0.44902873039245605, gen p mean: -0.24354520440101624, mean p set: 0.4496042728424072
loss_pred:0.012628994882106781, decouple_loss:0.0019931213464587927
The modified gen p mean: 0.44888266921043396, gen p mean: -0.23827633261680603, mean p set: 0.4494149386882782
loss_pred:0.014052482321858406, decouple_loss:0.0019813021644949913
Iteration: 4628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483238756656647, gen p mean: -0.2376221865415573, mean p set: 0.44889771938323975
loss_pred:0.014687556773424149, decouple_loss:0.0018102503381669521
The modified gen p mean: 0.4472869336605072, gen p mean: -0.2345457375049591, mean p set: 0.44786569476127625
loss_pred:0.013488734140992165, decouple_loss:0.0018364612478762865
The modified gen p mean: 0.44990891218185425, gen p mean: -0.23160982131958008, mean p set: 0.4504365622997284
loss_pred:0.013029389083385468, decouple_loss:0.001965489936992526
Iteration: 4629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466046094894409, gen p mean: -0.24425603449344635, mean p set: 0.447174608707428
loss_pred:0.014391041360795498, decouple_loss:0.001772908610291779
The modified gen p mean: 0.44759827852249146, gen p mean: -0.23441609740257263, mean p set: 0.4481779932975769
loss_pred:0.014490976929664612, decouple_loss:0.0016963841626420617
The modified gen p mean: 0.4481532871723175, gen p mean: -0.24459823966026306, mean p set: 0.44867387413978577
loss_pred:0.013913330622017384, decouple_loss:0.0016411015531048179
Iteration: 4630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884636998176575, gen p mean: -0.24289470911026, mean p set: 0.4494233727455139
loss_pred:0.013958513736724854, decouple_loss:0.001794123207218945
The modified gen p mean: 0.4482842683792114, gen p mean: -0.24223314225673676, mean p set: 0.44885799288749695
loss_pred:0.013618768192827702, decouple_loss:0.0019626051653176546
The modified gen p mean: 0.4470648765563965, gen p mean: -0.2468244433403015, mean p set: 0.4475933015346527
loss_pred:0.01420842669904232, decouple_loss:0.0018350714817643166
2023-04-27 23:40:57 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24455909430980682, mean p set: 0.4499112665653229
loss_pred:0.01518217846751213, decouple_loss:0.0018825900042429566
The modified gen p mean: 0.4482741951942444, gen p mean: -0.2414746731519699, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930118322372437, gen p mean: -0.24409307539463043, mean p set: 0.4498290419578552
loss_pred:0.01509165670722723, decouple_loss:0.001922928960993886
loss_pred:0.014746574684977531, decouple_loss:0.0019028083188459277
WV_1_PC_1_EH_0_PS_30, loss: 0.015101942233741283, avg_mse: 0.02212846837937832
current test mse: 0.022128
Iteration: 4631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155489444732666, gen p mean: -0.24147248268127441, mean p set: 0.4521370232105255
loss_pred:0.013656909577548504, decouple_loss:0.002054777229204774
The modified gen p mean: 0.44733330607414246, gen p mean: -0.23943635821342468, mean p set: 0.4479128420352936
loss_pred:0.013717074878513813, decouple_loss:0.0018917162669822574
The modified gen p mean: 0.4493086040019989, gen p mean: -0.24399198591709137, mean p set: 0.4498351216316223
loss_pred:0.013528796844184399, decouple_loss:0.002254469320178032
Iteration: 4632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970935583114624, gen p mean: -0.24268236756324768, mean p set: 0.45023879408836365
loss_pred:0.013888340443372726, decouple_loss:0.0018361423863098025
The modified gen p mean: 0.4474499523639679, gen p mean: -0.23833200335502625, mean p set: 0.4480287730693817
loss_pred:0.014465078711509705, decouple_loss:0.001753995311446488
The modified gen p mean: 0.4486328661441803, gen p mean: -0.24516308307647705, mean p set: 0.44920656085014343
loss_pred:0.01382225938141346, decouple_loss:0.0019070786656811833
Iteration: 4633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448648065328598, gen p mean: -0.2383231818675995, mean p set: 0.449176549911499
loss_pred:0.013809479773044586, decouple_loss:0.002017935970798135
The modified gen p mean: 0.44733279943466187, gen p mean: -0.24395917356014252, mean p set: 0.4479064643383026
loss_pred:0.013797538354992867, decouple_loss:0.0020702958572655916
The modified gen p mean: 0.44731631875038147, gen p mean: -0.23942936956882477, mean p set: 0.4478965699672699
loss_pred:0.013881583698093891, decouple_loss:0.0019207950681447983
Iteration: 4634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476102590560913, gen p mean: -0.2400594800710678, mean p set: 0.4481402039527893
loss_pred:0.013736739754676819, decouple_loss:0.0018514374969527125
The modified gen p mean: 0.44865864515304565, gen p mean: -0.23947802186012268, mean p set: 0.44923779368400574
loss_pred:0.014103047549724579, decouple_loss:0.001923016388900578
The modified gen p mean: 0.4479907155036926, gen p mean: -0.2341245859861374, mean p set: 0.4485572874546051
loss_pred:0.014053653925657272, decouple_loss:0.0019509149715304375
Iteration: 4635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477594792842865, gen p mean: -0.23570801317691803, mean p set: 0.44833314418792725
loss_pred:0.014305355958640575, decouple_loss:0.0018401178531348705
The modified gen p mean: 0.44858551025390625, gen p mean: -0.2418692260980606, mean p set: 0.44910797476768494The modified gen p mean: 0.4474581480026245, gen p mean: -0.23877191543579102, mean p set: 0.44803765416145325
loss_pred:0.013818570412695408, decouple_loss:0.001957481261342764
loss_pred:0.013280728831887245, decouple_loss:0.0021104903426021338
Iteration: 4636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489091634750366, gen p mean: -0.24616625905036926, mean p set: 0.4494871497154236
loss_pred:0.012366995215415955, decouple_loss:0.0023269085213541985
The modified gen p mean: 0.44788363575935364, gen p mean: -0.24260473251342773, mean p set: 0.44846272468566895The modified gen p mean: 0.44998711347579956, gen p mean: -0.2351752668619156, mean p set: 0.4505176842212677
loss_pred:0.012752529233694077, decouple_loss:0.0022042901255190372
loss_pred:0.013065771199762821, decouple_loss:0.0019378603901714087
Iteration: 4637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485287666320801, gen p mean: -0.2435077279806137, mean p set: 0.44910773634910583
loss_pred:0.013042483478784561, decouple_loss:0.002193840453401208
The modified gen p mean: 0.4472968578338623, gen p mean: -0.2395171821117401, mean p set: 0.44782793521881104The modified gen p mean: 0.45009925961494446, gen p mean: -0.23849764466285706, mean p set: 0.45067334175109863
loss_pred:0.013180186972022057, decouple_loss:0.002318068640306592
loss_pred:0.01410802360624075, decouple_loss:0.0021702118683606386
Iteration: 4638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468191862106323, gen p mean: -0.24669912457466125, mean p set: 0.447394996881485
loss_pred:0.013471832498908043, decouple_loss:0.002130284206941724
The modified gen p mean: 0.4466956853866577, gen p mean: -0.2490176260471344, mean p set: 0.4472704529762268
loss_pred:0.01377313956618309, decouple_loss:0.002250219462439418
The modified gen p mean: 0.44781389832496643, gen p mean: -0.24986854195594788, mean p set: 0.4483363628387451
loss_pred:0.014116737060248852, decouple_loss:0.0022086966782808304
Iteration: 4639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482730031013489, gen p mean: -0.25396907329559326, mean p set: 0.44884639978408813
loss_pred:0.01365167647600174, decouple_loss:0.002021052408963442
The modified gen p mean: 0.44785481691360474, gen p mean: -0.25284087657928467, mean p set: 0.44843384623527527
loss_pred:0.013830437324941158, decouple_loss:0.0019748532213270664
The modified gen p mean: 0.4472123086452484, gen p mean: -0.24481314420700073, mean p set: 0.447748064994812
loss_pred:0.01351255550980568, decouple_loss:0.0019815347623080015
Iteration: 4640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739919900894165, gen p mean: -0.250139057636261, mean p set: 0.4479774832725525
loss_pred:0.01348600909113884, decouple_loss:0.0018464423483237624
The modified gen p mean: 0.44878965616226196, gen p mean: -0.25430724024772644, mean p set: 0.4493709206581116The modified gen p mean: 0.4490352272987366, gen p mean: -0.25077250599861145, mean p set: 0.4495624303817749
loss_pred:0.0140261584892869, decouple_loss:0.001820359262637794
loss_pred:0.013375003822147846, decouple_loss:0.002109760884195566
2023-04-27 23:44:20 testing...
The modified gen p mean: 0.4482651948928833, gen p mean: -0.2444126009941101, mean p set: 0.44879910349845886
loss_pred:0.015038940124213696, decouple_loss:0.0021539507433772087
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24721433222293854, mean p set: 0.4499112665653229
loss_pred:0.015214726328849792, decouple_loss:0.002269666874781251
The modified gen p mean: 0.4493001401424408, gen p mean: -0.2468547374010086, mean p set: 0.4498290419578552
loss_pred:0.014692557044327259, decouple_loss:0.0023119908291846514
WV_1_PC_1_EH_0_PS_30, loss: 0.015094335190951824, avg_mse: 0.022141696885228157
current test mse: 0.022142
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 4641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477533996105194, gen p mean: -0.2468353509902954, mean p set: 0.44828298687934875
loss_pred:0.014793653972446918, decouple_loss:0.002007759176194668
The modified gen p mean: 0.44796881079673767, gen p mean: -0.24640756845474243, mean p set: 0.44854387640953064
loss_pred:0.014562849886715412, decouple_loss:0.0020725696813315153
The modified gen p mean: 0.44773995876312256, gen p mean: -0.24492783844470978, mean p set: 0.4483139216899872
loss_pred:0.014242341741919518, decouple_loss:0.0022378135472536087
Iteration: 4642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476855397224426, gen p mean: -0.24864478409290314, mean p set: 0.4482157230377197
loss_pred:0.014461795799434185, decouple_loss:0.0020157117396593094
The modified gen p mean: 0.44769859313964844, gen p mean: -0.24409006536006927, mean p set: 0.4482753276824951
loss_pred:0.014838697388768196, decouple_loss:0.001874785404652357
The modified gen p mean: 0.44767487049102783, gen p mean: -0.2436130791902542, mean p set: 0.4482516348361969
loss_pred:0.014707183465361595, decouple_loss:0.0019335236866027117
Iteration: 4643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481824040412903, gen p mean: -0.23834063112735748, mean p set: 0.4487065374851227
loss_pred:0.014218032360076904, decouple_loss:0.0021462407894432545
The modified gen p mean: 0.4473465085029602, gen p mean: -0.2400321513414383, mean p set: 0.44792643189430237
loss_pred:0.014574523083865643, decouple_loss:0.002346027409657836
The modified gen p mean: 0.44717684388160706, gen p mean: -0.24386660754680634, mean p set: 0.4477587640285492
loss_pred:0.01454437430948019, decouple_loss:0.002047137590125203
Iteration: 4644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873613119125366, gen p mean: -0.2465049773454666, mean p set: 0.44926151633262634
loss_pred:0.014170286245644093, decouple_loss:0.001679952722042799
The modified gen p mean: 0.44832053780555725, gen p mean: -0.24069075286388397, mean p set: 0.44889721274375916
loss_pred:0.014066291972994804, decouple_loss:0.001915748231112957
The modified gen p mean: 0.4478074312210083, gen p mean: -0.24434831738471985, mean p set: 0.44838467240333557
loss_pred:0.014086362905800343, decouple_loss:0.0019697733223438263
Iteration: 4645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797471165657043, gen p mean: -0.2384420931339264, mean p set: 0.4485490918159485
loss_pred:0.015081935562193394, decouple_loss:0.0024790517054498196
The modified gen p mean: 0.44826188683509827, gen p mean: -0.24218134582042694, mean p set: 0.4488312005996704
loss_pred:0.013803948648273945, decouple_loss:0.002114924369379878
The modified gen p mean: 0.44795140624046326, gen p mean: -0.23779843747615814, mean p set: 0.4484822154045105
loss_pred:0.014193895272910595, decouple_loss:0.0023137014359235764
Iteration: 4646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823142886161804, gen p mean: -0.23669570684432983, mean p set: 0.4488089084625244
loss_pred:0.014661547727882862, decouple_loss:0.001919315429404378
The modified gen p mean: 0.4486672580242157, gen p mean: -0.23615284264087677, mean p set: 0.4492427408695221
loss_pred:0.014297937043011189, decouple_loss:0.001860397751443088
The modified gen p mean: 0.44807329773902893, gen p mean: -0.2362421303987503, mean p set: 0.44859760999679565
loss_pred:0.014930429868400097, decouple_loss:0.0020043211989104748
Iteration: 4647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789138436317444, gen p mean: -0.23786808550357819, mean p set: 0.44846177101135254
loss_pred:0.014184621162712574, decouple_loss:0.001998717663809657
The modified gen p mean: 0.44910648465156555, gen p mean: -0.23853322863578796, mean p set: 0.4496433436870575The modified gen p mean: 0.4481961131095886, gen p mean: -0.23846647143363953, mean p set: 0.448775053024292
loss_pred:0.01494737807661295, decouple_loss:0.001971285557374358
loss_pred:0.014307503588497639, decouple_loss:0.0020276352297514677
Iteration: 4648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752463698387146, gen p mean: -0.24106617271900177, mean p set: 0.448095440864563
loss_pred:0.014154192991554737, decouple_loss:0.0019493859726935625
The modified gen p mean: 0.44803833961486816, gen p mean: -0.24101731181144714, mean p set: 0.4486139416694641
loss_pred:0.014140432700514793, decouple_loss:0.0019201606046408415
The modified gen p mean: 0.44767358899116516, gen p mean: -0.24026396870613098, mean p set: 0.448201984167099
loss_pred:0.013950468972325325, decouple_loss:0.0019628305453807116
Iteration: 4649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480179250240326, gen p mean: -0.23706212639808655, mean p set: 0.44859370589256287
loss_pred:0.014293136075139046, decouple_loss:0.0019071451388299465
The modified gen p mean: 0.4471931755542755, gen p mean: -0.24683892726898193, mean p set: 0.44776955246925354
loss_pred:0.014361158944666386, decouple_loss:0.002115037525072694
The modified gen p mean: 0.4483729898929596, gen p mean: -0.24306799471378326, mean p set: 0.4489077031612396
loss_pred:0.013609844259917736, decouple_loss:0.0021181898191571236
Iteration: 4650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471063017845154, gen p mean: -0.24365219473838806, mean p set: 0.4476796090602875
loss_pred:0.014622336253523827, decouple_loss:0.0018772989278659225
The modified gen p mean: 0.44776177406311035, gen p mean: -0.24232642352581024, mean p set: 0.448341965675354
loss_pred:0.014514617621898651, decouple_loss:0.0019130760338157415
The modified gen p mean: 0.44780439138412476, gen p mean: -0.2389707863330841, mean p set: 0.4483332633972168
loss_pred:0.01430343184620142, decouple_loss:0.002248522359877825
2023-04-27 23:48:26 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24093197286128998, mean p set: 0.4499112665653229
loss_pred:0.015051199123263359, decouple_loss:0.0023895015474408865
The modified gen p mean: 0.4482742249965668, gen p mean: -0.23823881149291992, mean p set: 0.44879910349845886
loss_pred:0.015018392354249954, decouple_loss:0.0021941992454230785
The modified gen p mean: 0.4493005871772766, gen p mean: -0.24065278470516205, mean p set: 0.4498290419578552
loss_pred:0.014681968837976456, decouple_loss:0.0021036749240010977
WV_1_PC_1_EH_0_PS_30, loss: 0.015028643421828747, avg_mse: 0.022033456712961197
current test mse: 0.022033
Iteration: 4651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474497437477112, gen p mean: -0.2441452443599701, mean p set: 0.44802939891815186
loss_pred:0.01458886731415987, decouple_loss:0.0021415778901427984
The modified gen p mean: 0.44743233919143677, gen p mean: -0.23976945877075195, mean p set: 0.44799885153770447
loss_pred:0.013780390843749046, decouple_loss:0.0024693498853594065
The modified gen p mean: 0.4480710029602051, gen p mean: -0.24553251266479492, mean p set: 0.44859638810157776
loss_pred:0.014801349490880966, decouple_loss:0.002162057673558593
Iteration: 4652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473690986633301, gen p mean: -0.24199621379375458, mean p set: 0.44789719581604004
loss_pred:0.013987324200570583, decouple_loss:0.002168942941352725
The modified gen p mean: 0.4475421607494354, gen p mean: -0.24394840002059937, mean p set: 0.4481166899204254
loss_pred:0.01480782125145197, decouple_loss:0.0018419305561110377
The modified gen p mean: 0.44770294427871704, gen p mean: -0.24563033878803253, mean p set: 0.44828253984451294
loss_pred:0.014304415322840214, decouple_loss:0.0017948331078514457
Iteration: 4653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480135440826416, gen p mean: -0.24918517470359802, mean p set: 0.44854554533958435
loss_pred:0.013586287386715412, decouple_loss:0.0019691656343638897
The modified gen p mean: 0.4476209282875061, gen p mean: -0.2530844509601593, mean p set: 0.44819343090057373
loss_pred:0.014287319034337997, decouple_loss:0.002182487165555358
The modified gen p mean: 0.4476182162761688, gen p mean: -0.2480657398700714, mean p set: 0.44819650053977966
loss_pred:0.013703517615795135, decouple_loss:0.0019986778497695923
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744956493377686, gen p mean: -0.2527405023574829, mean p set: 0.4479837417602539
loss_pred:0.0145719600841403, decouple_loss:0.0020895206835120916
The modified gen p mean: 0.4478197395801544, gen p mean: -0.25070837140083313, mean p set: 0.44839832186698914
loss_pred:0.013848518021404743, decouple_loss:0.0016966108232736588
The modified gen p mean: 0.44870519638061523, gen p mean: -0.24588215351104736, mean p set: 0.44928398728370667
loss_pred:0.014665019698441029, decouple_loss:0.0019379019504413009
Iteration: 4655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447817862033844, gen p mean: -0.2488945871591568, mean p set: 0.44838589429855347
loss_pred:0.014607470482587814, decouple_loss:0.001821243902668357
The modified gen p mean: 0.44835013151168823, gen p mean: -0.24693261086940765, mean p set: 0.44892874360084534
loss_pred:0.014292953535914421, decouple_loss:0.0017852255841717124
The modified gen p mean: 0.4478977918624878, gen p mean: -0.24569876492023468, mean p set: 0.44843021035194397
loss_pred:0.013998840935528278, decouple_loss:0.0020456360653042793
Iteration: 4656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778239727020264, gen p mean: -0.2508106827735901, mean p set: 0.44836533069610596
loss_pred:0.014509706757962704, decouple_loss:0.0019649977330118418
The modified gen p mean: 0.44707587361335754, gen p mean: -0.2508919835090637, mean p set: 0.4476061165332794The modified gen p mean: 0.44732657074928284, gen p mean: -0.24915115535259247, mean p set: 0.4478999972343445
loss_pred:0.014417098835110664, decouple_loss:0.002061073202639818
loss_pred:0.014275770634412766, decouple_loss:0.0019669532775878906
Iteration: 4657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752800464630127, gen p mean: -0.2501656413078308, mean p set: 0.44810721278190613
loss_pred:0.014170121401548386, decouple_loss:0.0020294287241995335
The modified gen p mean: 0.44740545749664307, gen p mean: -0.24544548988342285, mean p set: 0.44797900319099426
The modified gen p mean: 0.44814348220825195, gen p mean: -0.24830412864685059, mean p set: 0.4486706554889679
loss_pred:0.014431733638048172, decouple_loss:0.0019142341334372759
loss_pred:0.013707847334444523, decouple_loss:0.0018110038945451379
Iteration: 4658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474470615386963, gen p mean: -0.24041756987571716, mean p set: 0.4480193257331848
loss_pred:0.014209525659680367, decouple_loss:0.001956028863787651
The modified gen p mean: 0.44746553897857666, gen p mean: -0.24131503701210022, mean p set: 0.4479960799217224The modified gen p mean: 0.44777825474739075, gen p mean: -0.24603307247161865, mean p set: 0.4483576714992523
loss_pred:0.014715134166181087, decouple_loss:0.0019532206933945417
loss_pred:0.014450877904891968, decouple_loss:0.001970784505829215
Iteration: 4659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801485538482666, gen p mean: -0.24254252016544342, mean p set: 0.4485950171947479
loss_pred:0.014662057161331177, decouple_loss:0.0017626129556447268
The modified gen p mean: 0.4479564428329468, gen p mean: -0.24722354114055634, mean p set: 0.44847777485847473
loss_pred:0.014204001054167747, decouple_loss:0.0018936843844130635
The modified gen p mean: 0.44858986139297485, gen p mean: -0.2389584183692932, mean p set: 0.4491655230522156
loss_pred:0.014068270102143288, decouple_loss:0.0019904859364032745
Iteration: 4660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479092061519623, gen p mean: -0.24862298369407654, mean p set: 0.44847962260246277
loss_pred:0.0147295743227005, decouple_loss:0.001877260161563754
The modified gen p mean: 0.4479098618030548, gen p mean: -0.2486097812652588, mean p set: 0.44843557476997375The modified gen p mean: 0.44846493005752563, gen p mean: -0.2461324781179428, mean p set: 0.44904080033302307
loss_pred:0.014054197818040848, decouple_loss:0.0022146087139844894
loss_pred:0.014300432056188583, decouple_loss:0.0017673856345936656
2023-04-27 23:51:50 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24807336926460266, mean p set: 0.4499112665653229
loss_pred:0.015066278167068958, decouple_loss:0.0021087045315653086
The modified gen p mean: 0.44827231764793396, gen p mean: -0.2454647570848465, mean p set: 0.44879910349845886
The modified gen p mean: 0.44929376244544983, gen p mean: -0.24797233939170837, mean p set: 0.4498290419578552
loss_pred:0.015055780299007893, decouple_loss:0.002006050432100892
loss_pred:0.014657956548035145, decouple_loss:0.002233378356322646
WV_1_PC_1_EH_0_PS_30, loss: 0.01503247395157814, avg_mse: 0.0220740158110857
current test mse: 0.022074
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 4661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799524545669556, gen p mean: -0.24807408452033997, mean p set: 0.4485243558883667
loss_pred:0.013743177056312561, decouple_loss:0.0020095191430300474
The modified gen p mean: 0.44776949286460876, gen p mean: -0.24950914084911346, mean p set: 0.4483468234539032
loss_pred:0.01384213101118803, decouple_loss:0.0017822004156187177
The modified gen p mean: 0.44547849893569946, gen p mean: -0.2517010569572449, mean p set: 0.4460570514202118
loss_pred:0.013848825357854366, decouple_loss:0.0018168938113376498
Iteration: 4662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633713364601135, gen p mean: -0.2457747757434845, mean p set: 0.44687342643737793
loss_pred:0.014892632141709328, decouple_loss:0.002117618452757597
The modified gen p mean: 0.44734659790992737, gen p mean: -0.2433931529521942, mean p set: 0.4479168951511383
loss_pred:0.013907082378864288, decouple_loss:0.0022139244247227907
The modified gen p mean: 0.4466624855995178, gen p mean: -0.24341076612472534, mean p set: 0.4472406804561615
loss_pred:0.014502596110105515, decouple_loss:0.002332412637770176
Iteration: 4663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794952869415283, gen p mean: -0.24102959036827087, mean p set: 0.44847849011421204
loss_pred:0.013963381759822369, decouple_loss:0.0020873777102679014
The modified gen p mean: 0.4469262361526489, gen p mean: -0.2423258125782013, mean p set: 0.4475022256374359The modified gen p mean: 0.44757890701293945, gen p mean: -0.2388947606086731, mean p set: 0.44815605878829956
loss_pred:0.014286276884377003, decouple_loss:0.002114217961207032
loss_pred:0.013892154209315777, decouple_loss:0.0018671228317543864
Iteration: 4664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44662711024284363, gen p mean: -0.23749004304409027, mean p set: 0.44714486598968506
loss_pred:0.014333496801555157, decouple_loss:0.001905709388665855
The modified gen p mean: 0.4476587176322937, gen p mean: -0.24042001366615295, mean p set: 0.44823282957077026
loss_pred:0.014772062189877033, decouple_loss:0.0017651331145316362
The modified gen p mean: 0.44815176725387573, gen p mean: -0.2381211221218109, mean p set: 0.44873204827308655
loss_pred:0.013730127364397049, decouple_loss:0.0017953206552192569
Iteration: 4665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44635164737701416, gen p mean: -0.2342928797006607, mean p set: 0.4469250440597534
loss_pred:0.015192484483122826, decouple_loss:0.0024671333376318216
The modified gen p mean: 0.4456441104412079, gen p mean: -0.2368762195110321, mean p set: 0.4462227523326874
loss_pred:0.013696791604161263, decouple_loss:0.0020551288034766912
The modified gen p mean: 0.44896548986434937, gen p mean: -0.23928862810134888, mean p set: 0.44949212670326233
loss_pred:0.01389292348176241, decouple_loss:0.0025214171037077904
Iteration: 4666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471428692340851, gen p mean: -0.23371562361717224, mean p set: 0.44772249460220337
loss_pred:0.014533815905451775, decouple_loss:0.0017338079633191228
The modified gen p mean: 0.44817253947257996, gen p mean: -0.23806580901145935, mean p set: 0.4487445652484894
loss_pred:0.014270894229412079, decouple_loss:0.0016400179592892528
The modified gen p mean: 0.44790592789649963, gen p mean: -0.23663505911827087, mean p set: 0.44843539595603943
loss_pred:0.01368330605328083, decouple_loss:0.0015847643371671438
Iteration: 4667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699472188949585, gen p mean: -0.24120502173900604, mean p set: 0.44757208228111267
loss_pred:0.01384851522743702, decouple_loss:0.0024636229500174522
The modified gen p mean: 0.44875001907348633, gen p mean: -0.2447969615459442, mean p set: 0.44927650690078735The modified gen p mean: 0.4485645890235901, gen p mean: -0.24350450932979584, mean p set: 0.44913914799690247
loss_pred:0.014383728615939617, decouple_loss:0.002780341077595949
loss_pred:0.013754745945334435, decouple_loss:0.0023625504691153765
Iteration: 4668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459421932697296, gen p mean: -0.2457447201013565, mean p set: 0.44651445746421814
loss_pred:0.013551668263971806, decouple_loss:0.0017262110486626625
The modified gen p mean: 0.4461374878883362, gen p mean: -0.24318456649780273, mean p set: 0.4467092752456665
loss_pred:0.01479187048971653, decouple_loss:0.001664484036155045
The modified gen p mean: 0.4468255937099457, gen p mean: -0.23883026838302612, mean p set: 0.4473552703857422
loss_pred:0.014258976094424725, decouple_loss:0.001791016780771315
Iteration: 4669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606253504753113, gen p mean: -0.2412632554769516, mean p set: 0.4466347098350525
loss_pred:0.013789039105176926, decouple_loss:0.0018391298362985253
The modified gen p mean: 0.4471970498561859, gen p mean: -0.24030949175357819, mean p set: 0.4477720260620117
loss_pred:0.014046017080545425, decouple_loss:0.0019652550108730793
The modified gen p mean: 0.44750797748565674, gen p mean: -0.24132579565048218, mean p set: 0.44803762435913086
loss_pred:0.014293321408331394, decouple_loss:0.0018795642536133528
Iteration: 4670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808077812194824, gen p mean: -0.24202753603458405, mean p set: 0.4486530125141144
loss_pred:0.014891469851136208, decouple_loss:0.0019677341915667057
The modified gen p mean: 0.44643548130989075, gen p mean: -0.24337157607078552, mean p set: 0.44701406359672546
loss_pred:0.014636997133493423, decouple_loss:0.002136955736204982
The modified gen p mean: 0.4487697184085846, gen p mean: -0.24453705549240112, mean p set: 0.44929662346839905
loss_pred:0.013784557580947876, decouple_loss:0.0019747784826904535
2023-04-27 23:55:54 testing...
The modified gen p mean: 0.44827476143836975, gen p mean: -0.24018985033035278, mean p set: 0.44879910349845886
loss_pred:0.015016987919807434, decouple_loss:0.0018753947224467993
The modified gen p mean: 0.44929933547973633, gen p mean: -0.24209114909172058, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24225877225399017, mean p set: 0.4499112665653229loss_pred:0.014682128094136715, decouple_loss:0.0017270358512178063
loss_pred:0.0151085015386343, decouple_loss:0.0018694723257794976
WV_1_PC_1_EH_0_PS_30, loss: 0.015027071349322796, avg_mse: 0.022122755646705627
current test mse: 0.022123
Iteration: 4671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657477736473083, gen p mean: -0.2451494187116623, mean p set: 0.44710099697113037
loss_pred:0.013848521746695042, decouple_loss:0.001798562123440206
The modified gen p mean: 0.44871118664741516, gen p mean: -0.244635671377182, mean p set: 0.44928810000419617
loss_pred:0.01408257894217968, decouple_loss:0.0018127390649169683
The modified gen p mean: 0.4480600953102112, gen p mean: -0.24613265693187714, mean p set: 0.4486336410045624
loss_pred:0.01407592836767435, decouple_loss:0.0018551979446783662
Iteration: 4672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483063519001007, gen p mean: -0.2416086494922638, mean p set: 0.4488321542739868
loss_pred:0.013865442015230656, decouple_loss:0.0018726882990449667
The modified gen p mean: 0.4458749294281006, gen p mean: -0.24176639318466187, mean p set: 0.4464513063430786
The modified gen p mean: 0.44653430581092834, gen p mean: -0.23945800960063934, mean p set: 0.4471120834350586
loss_pred:0.014779125340282917, decouple_loss:0.001809862907975912
loss_pred:0.014209363609552383, decouple_loss:0.0022162403911352158
Iteration: 4673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451902210712433, gen p mean: -0.24385733902454376, mean p set: 0.44571492075920105
loss_pred:0.013753769919276237, decouple_loss:0.002111758105456829
The modified gen p mean: 0.4462912678718567, gen p mean: -0.23912352323532104, mean p set: 0.44687098264694214
The modified gen p mean: 0.4476161599159241, gen p mean: -0.24306099116802216, mean p set: 0.44818755984306335
loss_pred:0.013573900796473026, decouple_loss:0.0021162822376936674
loss_pred:0.014197804033756256, decouple_loss:0.002193342661485076
Iteration: 4674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475615918636322, gen p mean: -0.24014167487621307, mean p set: 0.4481431543827057
loss_pred:0.013917624019086361, decouple_loss:0.0019826344214379787
The modified gen p mean: 0.44718635082244873, gen p mean: -0.2370167076587677, mean p set: 0.4477138817310333The modified gen p mean: 0.44805482029914856, gen p mean: -0.24110279977321625, mean p set: 0.4486321210861206
loss_pred:0.014360347762703896, decouple_loss:0.0017600166611373425
loss_pred:0.013837623409926891, decouple_loss:0.001795856631360948
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477357566356659, gen p mean: -0.2374754250049591, mean p set: 0.4483067989349365
loss_pred:0.014670063741505146, decouple_loss:0.002278633415699005
The modified gen p mean: 0.44659125804901123, gen p mean: -0.24032068252563477, mean p set: 0.44717034697532654
loss_pred:0.014863659627735615, decouple_loss:0.0023133838549256325
The modified gen p mean: 0.4471783936023712, gen p mean: -0.23920278251171112, mean p set: 0.4477066397666931
loss_pred:0.014251512475311756, decouple_loss:0.0022576707415282726
Iteration: 4676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740262627601624, gen p mean: -0.24310331046581268, mean p set: 0.4479806125164032
loss_pred:0.013886852189898491, decouple_loss:0.0017928385641425848
The modified gen p mean: 0.4470360577106476, gen p mean: -0.2394770234823227, mean p set: 0.4475656747817993The modified gen p mean: 0.44649216532707214, gen p mean: -0.24120983481407166, mean p set: 0.4470709264278412
loss_pred:0.01501399278640747, decouple_loss:0.0019397079013288021
loss_pred:0.01424101460725069, decouple_loss:0.0017591852229088545
Iteration: 4677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801801443099976, gen p mean: -0.24032285809516907, mean p set: 0.44859448075294495
loss_pred:0.01452384889125824, decouple_loss:0.0020932131446897984
The modified gen p mean: 0.4478127062320709, gen p mean: -0.24725063145160675, mean p set: 0.4483872950077057
loss_pred:0.013892797753214836, decouple_loss:0.0017234999686479568
The modified gen p mean: 0.4471670687198639, gen p mean: -0.24242544174194336, mean p set: 0.44768208265304565
loss_pred:0.013712490908801556, decouple_loss:0.002158696996048093
Iteration: 4678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719547033309937, gen p mean: -0.23888714611530304, mean p set: 0.44777190685272217
loss_pred:0.013555990532040596, decouple_loss:0.0019688988104462624
The modified gen p mean: 0.44694188237190247, gen p mean: -0.24194270372390747, mean p set: 0.44747447967529297The modified gen p mean: 0.44592028856277466, gen p mean: -0.2389644831418991, mean p set: 0.44649171829223633
loss_pred:0.014466853812336922, decouple_loss:0.0018687903648242354
loss_pred:0.01391565427184105, decouple_loss:0.0017784620868042111
Iteration: 4679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721078872680664, gen p mean: -0.2368759661912918, mean p set: 0.44778627157211304
loss_pred:0.01408908050507307, decouple_loss:0.0020526698790490627
The modified gen p mean: 0.44794565439224243, gen p mean: -0.23782940208911896, mean p set: 0.4485151767730713
loss_pred:0.013726606033742428, decouple_loss:0.0016469492111355066
The modified gen p mean: 0.44642913341522217, gen p mean: -0.23665563762187958, mean p set: 0.44696107506752014
loss_pred:0.014242719858884811, decouple_loss:0.0018883771263062954
Iteration: 4680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851306080818176, gen p mean: -0.23983874917030334, mean p set: 0.449090838432312
loss_pred:0.013764589093625546, decouple_loss:0.0020587663166224957
The modified gen p mean: 0.44685494899749756, gen p mean: -0.23564453423023224, mean p set: 0.44742488861083984
loss_pred:0.014951135963201523, decouple_loss:0.0016402569599449635
The modified gen p mean: 0.4483852982521057, gen p mean: -0.238515242934227, mean p set: 0.4489142596721649
loss_pred:0.013796208426356316, decouple_loss:0.0018438379047438502
2023-04-27 23:59:18 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2344156801700592, mean p set: 0.4499112665653229
loss_pred:0.015142785385251045, decouple_loss:0.0017625385662540793
The modified gen p mean: 0.44826555252075195, gen p mean: -0.23225291073322296, mean p set: 0.44879910349845886
loss_pred:0.01504785381257534, decouple_loss:0.0018823964055627584
The modified gen p mean: 0.44929778575897217, gen p mean: -0.23434460163116455, mean p set: 0.4498290419578552
loss_pred:0.014717604964971542, decouple_loss:0.0018076953710988164
WV_1_PC_1_EH_0_PS_30, loss: 0.015060292556881905, avg_mse: 0.022173983976244926
current test mse: 0.022174
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 4681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939708709716797, gen p mean: -0.23516908288002014, mean p set: 0.4499247372150421
loss_pred:0.013542938977479935, decouple_loss:0.002416221657767892
The modified gen p mean: 0.4484904706478119, gen p mean: -0.23359361290931702, mean p set: 0.4490686058998108
loss_pred:0.01460191234946251, decouple_loss:0.0026734923012554646
The modified gen p mean: 0.44885164499282837, gen p mean: -0.2334289699792862, mean p set: 0.449429988861084
loss_pred:0.014310399070382118, decouple_loss:0.0017965113511309028
Iteration: 4682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486139118671417, gen p mean: -0.2403232604265213, mean p set: 0.449150025844574
loss_pred:0.013725816272199154, decouple_loss:0.002423409605398774
The modified gen p mean: 0.44935834407806396, gen p mean: -0.23622585833072662, mean p set: 0.44993188977241516
loss_pred:0.014066002331674099, decouple_loss:0.002234839368611574
The modified gen p mean: 0.449628621339798, gen p mean: -0.23804648220539093, mean p set: 0.450207382440567
loss_pred:0.01342784520238638, decouple_loss:0.0019775032997131348
Iteration: 4683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449129194021225, gen p mean: -0.2449813336133957, mean p set: 0.4496510326862335
loss_pred:0.014096109196543694, decouple_loss:0.002108651213347912
The modified gen p mean: 0.4486836791038513, gen p mean: -0.24108059704303741, mean p set: 0.44925642013549805
loss_pred:0.014323966577649117, decouple_loss:0.0024168542586266994
The modified gen p mean: 0.4484385848045349, gen p mean: -0.24124182760715485, mean p set: 0.4490225911140442
loss_pred:0.01413729228079319, decouple_loss:0.0021277880296111107
Iteration: 4684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487133324146271, gen p mean: -0.24060101807117462, mean p set: 0.4492400586605072
loss_pred:0.014416053891181946, decouple_loss:0.002211821498349309
The modified gen p mean: 0.4496169984340668, gen p mean: -0.24287770688533783, mean p set: 0.45019209384918213
loss_pred:0.014442738145589828, decouple_loss:0.001886043231934309
The modified gen p mean: 0.448403000831604, gen p mean: -0.2406993806362152, mean p set: 0.44897738099098206
loss_pred:0.013361513614654541, decouple_loss:0.002324187196791172
Iteration: 4685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706225395202637, gen p mean: -0.24017386138439178, mean p set: 0.4476362466812134
loss_pred:0.014634150080382824, decouple_loss:0.0022607282735407352
The modified gen p mean: 0.44934558868408203, gen p mean: -0.2399095892906189, mean p set: 0.44992080330848694
loss_pred:0.014565300196409225, decouple_loss:0.0017436302732676268
The modified gen p mean: 0.4477804899215698, gen p mean: -0.23824751377105713, mean p set: 0.44830384850502014
loss_pred:0.013264652341604233, decouple_loss:0.0019902060739696026
Iteration: 4686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808003306388855, gen p mean: -0.23965446650981903, mean p set: 0.4486553370952606
loss_pred:0.014056386426091194, decouple_loss:0.0018962337635457516
The modified gen p mean: 0.4486234486103058, gen p mean: -0.23045653104782104, mean p set: 0.44919553399086The modified gen p mean: 0.4483111798763275, gen p mean: -0.24120567739009857, mean p set: 0.44883859157562256
loss_pred:0.013891419395804405, decouple_loss:0.0019244566792622209
loss_pred:0.013397444039583206, decouple_loss:0.0020060779061168432
Iteration: 4687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498741626739502, gen p mean: -0.23536565899848938, mean p set: 0.4504498541355133
loss_pred:0.013490618206560612, decouple_loss:0.0017633667448535562
The modified gen p mean: 0.4488013982772827, gen p mean: -0.23162488639354706, mean p set: 0.44932955503463745
The modified gen p mean: 0.44761213660240173, gen p mean: -0.2300557792186737, mean p set: 0.4481886029243469
loss_pred:0.014022738672792912, decouple_loss:0.0018428711919113994
loss_pred:0.013749666512012482, decouple_loss:0.0017796343890950084
Iteration: 4688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479876756668091, gen p mean: -0.23223720490932465, mean p set: 0.4485659599304199
loss_pred:0.014061043038964272, decouple_loss:0.0021548261865973473
The modified gen p mean: 0.4476408362388611, gen p mean: -0.2282874435186386, mean p set: 0.4481671154499054The modified gen p mean: 0.4479009211063385, gen p mean: -0.24059954285621643, mean p set: 0.448469340801239
loss_pred:0.013568555936217308, decouple_loss:0.002178316470235586
loss_pred:0.013521929271519184, decouple_loss:0.0020243520848453045
Iteration: 4689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475116729736328, gen p mean: -0.23237501084804535, mean p set: 0.4480898678302765
loss_pred:0.013926654122769833, decouple_loss:0.00179114262573421
The modified gen p mean: 0.44909295439720154, gen p mean: -0.22550703585147858, mean p set: 0.4496217370033264The modified gen p mean: 0.44825273752212524, gen p mean: -0.23482370376586914, mean p set: 0.4488309919834137
loss_pred:0.014221417717635632, decouple_loss:0.001837576157413423
loss_pred:0.013372926041483879, decouple_loss:0.0018008965998888016
Iteration: 4690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473811089992523, gen p mean: -0.23999834060668945, mean p set: 0.4479579031467438
loss_pred:0.013787037692964077, decouple_loss:0.0018078500870615244
The modified gen p mean: 0.44836440682411194, gen p mean: -0.23312249779701233, mean p set: 0.4488828480243683The modified gen p mean: 0.44791075587272644, gen p mean: -0.2358623445034027, mean p set: 0.4484882652759552
loss_pred:0.013364532962441444, decouple_loss:0.001836438081227243
loss_pred:0.014113168232142925, decouple_loss:0.00197446602396667
2023-04-28 00:03:19 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23759883642196655, mean p set: 0.4499112665653229
loss_pred:0.015172800049185753, decouple_loss:0.0018820660188794136
The modified gen p mean: 0.44827353954315186, gen p mean: -0.2352459579706192, mean p set: 0.44879910349845886
loss_pred:0.015153621323406696, decouple_loss:0.0018312600441277027
The modified gen p mean: 0.44929933547973633, gen p mean: -0.23739217221736908, mean p set: 0.4498290419578552
loss_pred:0.014753344468772411, decouple_loss:0.0018485388718545437
WV_1_PC_1_EH_0_PS_30, loss: 0.015119287185370922, avg_mse: 0.022337209433317184
current test mse: 0.022337
Iteration: 4691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447984516620636, gen p mean: -0.23768748342990875, mean p set: 0.44856372475624084
loss_pred:0.013591580092906952, decouple_loss:0.0016944385133683681
The modified gen p mean: 0.44872426986694336, gen p mean: -0.2392764538526535, mean p set: 0.44930025935173035
loss_pred:0.013397264294326305, decouple_loss:0.0018314874032512307
The modified gen p mean: 0.44810745120048523, gen p mean: -0.23682615160942078, mean p set: 0.4486420452594757
loss_pred:0.014322771690785885, decouple_loss:0.001773477764800191
Iteration: 4692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478760361671448, gen p mean: -0.2338797152042389, mean p set: 0.44840162992477417
loss_pred:0.013291795738041401, decouple_loss:0.0018070257501676679
The modified gen p mean: 0.4483262002468109, gen p mean: -0.236563578248024, mean p set: 0.4489034116268158
loss_pred:0.013672424480319023, decouple_loss:0.0017995277885347605
The modified gen p mean: 0.44774606823921204, gen p mean: -0.23744477331638336, mean p set: 0.44832542538642883
loss_pred:0.014142179861664772, decouple_loss:0.0017783514922484756
Iteration: 4693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448467880487442, gen p mean: -0.23848024010658264, mean p set: 0.44900044798851013
loss_pred:0.013377218507230282, decouple_loss:0.0017201477894559503
The modified gen p mean: 0.4472375810146332, gen p mean: -0.23886319994926453, mean p set: 0.4478180706501007The modified gen p mean: 0.44847312569618225, gen p mean: -0.23584936559200287, mean p set: 0.44905519485473633
loss_pred:0.014417815022170544, decouple_loss:0.0017301919870078564
loss_pred:0.01378609798848629, decouple_loss:0.001812051865272224
Iteration: 4694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501454830169678, gen p mean: -0.23555351793766022, mean p set: 0.4506753385066986
loss_pred:0.013499196618795395, decouple_loss:0.0017685936763882637
The modified gen p mean: 0.4491299092769623, gen p mean: -0.23868177831172943, mean p set: 0.4497077465057373
loss_pred:0.013743543066084385, decouple_loss:0.0017391322180628777
The modified gen p mean: 0.448090136051178, gen p mean: -0.23551523685455322, mean p set: 0.44866296648979187
loss_pred:0.014173071831464767, decouple_loss:0.0017351534916087985
Iteration: 4695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478551149368286, gen p mean: -0.23573772609233856, mean p set: 0.4484257698059082
loss_pred:0.013988794758915901, decouple_loss:0.0016701623098924756
The modified gen p mean: 0.4477401077747345, gen p mean: -0.23137547075748444, mean p set: 0.4483124613761902
loss_pred:0.013362475670874119, decouple_loss:0.0015940957237035036
The modified gen p mean: 0.44877225160598755, gen p mean: -0.22866252064704895, mean p set: 0.44930222630500793
loss_pred:0.013642910867929459, decouple_loss:0.0017403807723894715
Iteration: 4696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473514258861542, gen p mean: -0.23913493752479553, mean p set: 0.4479256868362427
loss_pred:0.013511267490684986, decouple_loss:0.0016739430138841271
The modified gen p mean: 0.44831106066703796, gen p mean: -0.23332694172859192, mean p set: 0.4488871097564697
loss_pred:0.013493037782609463, decouple_loss:0.0020320622716099024
The modified gen p mean: 0.44918516278266907, gen p mean: -0.22545425593852997, mean p set: 0.44971105456352234
loss_pred:0.013705115765333176, decouple_loss:0.001755465636961162
Iteration: 4697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448323130607605, gen p mean: -0.23727458715438843, mean p set: 0.4488929510116577
loss_pred:0.013912352733314037, decouple_loss:0.0019030419643968344
The modified gen p mean: 0.4488624334335327, gen p mean: -0.23559948801994324, mean p set: 0.44943690299987793
loss_pred:0.013591733761131763, decouple_loss:0.0018572077387943864
The modified gen p mean: 0.44860008358955383, gen p mean: -0.2329813688993454, mean p set: 0.44913092255592346
loss_pred:0.01368738990277052, decouple_loss:0.001954256556928158
Iteration: 4698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867420196533203, gen p mean: -0.23812782764434814, mean p set: 0.4492567181587219
loss_pred:0.013732018880546093, decouple_loss:0.0016337729757651687
The modified gen p mean: 0.4477693736553192, gen p mean: -0.23952177166938782, mean p set: 0.44834965467453003
loss_pred:0.014274334535002708, decouple_loss:0.0016797580756247044
The modified gen p mean: 0.448932409286499, gen p mean: -0.24038098752498627, mean p set: 0.44945937395095825
loss_pred:0.012695208191871643, decouple_loss:0.0016697861719876528
Iteration: 4699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487050175666809, gen p mean: -0.2394835203886032, mean p set: 0.4492858350276947
loss_pred:0.013255203142762184, decouple_loss:0.0017576995305716991
The modified gen p mean: 0.4484914541244507, gen p mean: -0.24085797369480133, mean p set: 0.4490663409233093
loss_pred:0.013259282335639, decouple_loss:0.0017074780771508813
The modified gen p mean: 0.44864141941070557, gen p mean: -0.23775187134742737, mean p set: 0.44916436076164246
loss_pred:0.013458285480737686, decouple_loss:0.0016784953186288476
Iteration: 4700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788646697998047, gen p mean: -0.23656873404979706, mean p set: 0.44841691851615906
loss_pred:0.013357407413423061, decouple_loss:0.0015771492617204785
The modified gen p mean: 0.4490843415260315, gen p mean: -0.23962998390197754, mean p set: 0.44965940713882446
loss_pred:0.013094021938741207, decouple_loss:0.0018095087725669146
The modified gen p mean: 0.4475207030773163, gen p mean: -0.23698730766773224, mean p set: 0.4480970501899719
loss_pred:0.013516221195459366, decouple_loss:0.0016361166490241885
2023-04-28 00:06:43 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23805566132068634, mean p set: 0.4499112665653229
loss_pred:0.015241631306707859, decouple_loss:0.0018110359087586403
The modified gen p mean: 0.4482705891132355, gen p mean: -0.23557327687740326, mean p set: 0.44879910349845886
The modified gen p mean: 0.449296772480011, gen p mean: -0.2382621020078659, mean p set: 0.4498290419578552
loss_pred:0.015123626217246056, decouple_loss:0.0017502297414466739
loss_pred:0.014714830555021763, decouple_loss:0.001744079403579235
WV_1_PC_1_EH_0_PS_30, loss: 0.015115118585526943, avg_mse: 0.022327231243252754
current test mse: 0.022327
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 4701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789427518844604, gen p mean: -0.24153393507003784, mean p set: 0.4484177529811859
loss_pred:0.014581054449081421, decouple_loss:0.0016983634559437633
The modified gen p mean: 0.447750449180603, gen p mean: -0.24002638459205627, mean p set: 0.44832760095596313
loss_pred:0.014409346505999565, decouple_loss:0.0016049545956775546
The modified gen p mean: 0.44831791520118713, gen p mean: -0.2357473075389862, mean p set: 0.4488926827907562
loss_pred:0.014716322533786297, decouple_loss:0.0017101580742746592
Iteration: 4702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448232501745224, gen p mean: -0.23794043064117432, mean p set: 0.4487592875957489
loss_pred:0.015429961495101452, decouple_loss:0.0018879887647926807
The modified gen p mean: 0.4472971260547638, gen p mean: -0.24180330336093903, mean p set: 0.4478755593299866
loss_pred:0.014063134789466858, decouple_loss:0.0016605755081400275
The modified gen p mean: 0.4483145475387573, gen p mean: -0.23722590506076813, mean p set: 0.4488913416862488
loss_pred:0.015259387902915478, decouple_loss:0.0016712178476154804
Iteration: 4703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482799470424652, gen p mean: -0.23761072754859924, mean p set: 0.44880983233451843
loss_pred:0.015359725803136826, decouple_loss:0.0019179789815098047
The modified gen p mean: 0.4481540322303772, gen p mean: -0.23336239159107208, mean p set: 0.44872695207595825
loss_pred:0.014608722180128098, decouple_loss:0.001848331419751048
The modified gen p mean: 0.4490998089313507, gen p mean: -0.23915454745292664, mean p set: 0.4496730864048004
loss_pred:0.014746362343430519, decouple_loss:0.001928625162690878
Iteration: 4704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736719131469727, gen p mean: -0.23697876930236816, mean p set: 0.44789284467697144
loss_pred:0.014185531064867973, decouple_loss:0.0017933743074536324
The modified gen p mean: 0.44864052534103394, gen p mean: -0.23687396943569183, mean p set: 0.44922152161598206
loss_pred:0.014687415212392807, decouple_loss:0.0016756374388933182
The modified gen p mean: 0.4479454457759857, gen p mean: -0.23882542550563812, mean p set: 0.44852176308631897
loss_pred:0.014781540259718895, decouple_loss:0.0017451754538342357
Iteration: 4705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861555099487305, gen p mean: -0.23973731696605682, mean p set: 0.4491422176361084
loss_pred:0.014414968900382519, decouple_loss:0.002017965540289879
The modified gen p mean: 0.44768211245536804, gen p mean: -0.24057255685329437, mean p set: 0.44825538992881775The modified gen p mean: 0.44700950384140015, gen p mean: -0.23999501764774323, mean p set: 0.4475880563259125
loss_pred:0.01426265761256218, decouple_loss:0.0018861338030546904
loss_pred:0.014585709199309349, decouple_loss:0.001991851953789592
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448159396648407, gen p mean: -0.23955194652080536, mean p set: 0.4487335979938507
loss_pred:0.014344465918838978, decouple_loss:0.0017921137623488903
The modified gen p mean: 0.4473242163658142, gen p mean: -0.24333563446998596, mean p set: 0.44789400696754456The modified gen p mean: 0.4475143253803253, gen p mean: -0.23911751806735992, mean p set: 0.44804567098617554
loss_pred:0.014624303206801414, decouple_loss:0.0019198744557797909
loss_pred:0.013880638405680656, decouple_loss:0.0018648653058335185
Iteration: 4707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479341506958008, gen p mean: -0.24003300070762634, mean p set: 0.4485079050064087
loss_pred:0.014014961197972298, decouple_loss:0.0018058916321024299
The modified gen p mean: 0.44985875487327576, gen p mean: -0.24113580584526062, mean p set: 0.45043665170669556
loss_pred:0.014548789709806442, decouple_loss:0.0018704066751524806
The modified gen p mean: 0.44714775681495667, gen p mean: -0.23843926191329956, mean p set: 0.4476771950721741
loss_pred:0.015430286526679993, decouple_loss:0.0019384317565709352
Iteration: 4708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494146704673767, gen p mean: -0.23629958927631378, mean p set: 0.4499906599521637
loss_pred:0.01416775118559599, decouple_loss:0.0017820445355027914
The modified gen p mean: 0.44763150811195374, gen p mean: -0.23764650523662567, mean p set: 0.44820985198020935
loss_pred:0.014536963775753975, decouple_loss:0.001690945471636951
The modified gen p mean: 0.44781169295310974, gen p mean: -0.2381841242313385, mean p set: 0.44833654165267944
loss_pred:0.014376658946275711, decouple_loss:0.001713909674435854
Iteration: 4709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841983914375305, gen p mean: -0.23867866396903992, mean p set: 0.4489997327327728
loss_pred:0.01427114475518465, decouple_loss:0.0018007663311436772
The modified gen p mean: 0.44804367423057556, gen p mean: -0.23858413100242615, mean p set: 0.44861847162246704
loss_pred:0.01406847033649683, decouple_loss:0.0017613869858905673
The modified gen p mean: 0.44746002554893494, gen p mean: -0.23869436979293823, mean p set: 0.44798803329467773
loss_pred:0.014309515245258808, decouple_loss:0.0020078588277101517
Iteration: 4710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447422593832016, gen p mean: -0.2352868914604187, mean p set: 0.44799840450286865
loss_pred:0.014800522476434708, decouple_loss:0.0017078756354749203
The modified gen p mean: 0.44800496101379395, gen p mean: -0.2359233796596527, mean p set: 0.4485322833061218The modified gen p mean: 0.44807231426239014, gen p mean: -0.23838523030281067, mean p set: 0.4486456513404846
loss_pred:0.014514124020934105, decouple_loss:0.0018026805482804775
loss_pred:0.013918904587626457, decouple_loss:0.0017473422922194004
2023-04-28 00:10:46 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23930343985557556, mean p set: 0.4499112665653229
loss_pred:0.01517889928072691, decouple_loss:0.00200210721231997
The modified gen p mean: 0.4482657015323639, gen p mean: -0.23681867122650146, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930025935173035, gen p mean: -0.23950877785682678, mean p set: 0.4498290419578552
loss_pred:0.015084980055689812, decouple_loss:0.0019346179906278849
loss_pred:0.014748663641512394, decouple_loss:0.001881732721813023
WV_1_PC_1_EH_0_PS_30, loss: 0.015101155266165733, avg_mse: 0.022271130234003067
current test mse: 0.022271
Iteration: 4711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855383038520813, gen p mean: -0.23996157944202423, mean p set: 0.4490887224674225
loss_pred:0.013746568001806736, decouple_loss:0.002040076069533825
The modified gen p mean: 0.447532594203949, gen p mean: -0.24070137739181519, mean p set: 0.4481090009212494
loss_pred:0.014230451546609402, decouple_loss:0.0017725365469232202
The modified gen p mean: 0.44834819436073303, gen p mean: -0.2409704029560089, mean p set: 0.44892382621765137
loss_pred:0.01411852054297924, decouple_loss:0.0018713341560214758
Iteration: 4712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817081093788147, gen p mean: -0.23288652300834656, mean p set: 0.44869568943977356
loss_pred:0.014307067729532719, decouple_loss:0.001750306342728436
The modified gen p mean: 0.4502776265144348, gen p mean: -0.23873387277126312, mean p set: 0.4508599638938904
loss_pred:0.014230770990252495, decouple_loss:0.0015992260305210948
The modified gen p mean: 0.4471122920513153, gen p mean: -0.23451577126979828, mean p set: 0.447688490152359
loss_pred:0.014128422364592552, decouple_loss:0.0015682368539273739
Iteration: 4713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480801820755005, gen p mean: -0.24128468334674835, mean p set: 0.44860783219337463
loss_pred:0.013955861330032349, decouple_loss:0.0016899951733648777
The modified gen p mean: 0.44724735617637634, gen p mean: -0.2436862289905548, mean p set: 0.4478192627429962
loss_pred:0.013455239124596119, decouple_loss:0.001735032070428133
The modified gen p mean: 0.44705450534820557, gen p mean: -0.23623248934745789, mean p set: 0.44762876629829407
loss_pred:0.015554089099168777, decouple_loss:0.001815008814446628
Iteration: 4714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470638930797577, gen p mean: -0.242381289601326, mean p set: 0.44758591055870056
loss_pred:0.013864242471754551, decouple_loss:0.001534888637252152
The modified gen p mean: 0.4475116431713104, gen p mean: -0.2403610646724701, mean p set: 0.4480845034122467
loss_pred:0.014925242401659489, decouple_loss:0.0016177635407075286
The modified gen p mean: 0.44719037413597107, gen p mean: -0.24323706328868866, mean p set: 0.4477599561214447
loss_pred:0.014022110030055046, decouple_loss:0.0015301480889320374
Iteration: 4715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728100299835205, gen p mean: -0.23929071426391602, mean p set: 0.44785773754119873
loss_pred:0.01418779231607914, decouple_loss:0.0019519395427778363
The modified gen p mean: 0.44860637187957764, gen p mean: -0.24112507700920105, mean p set: 0.44918495416641235
loss_pred:0.014164374209940434, decouple_loss:0.0020074748899787664
The modified gen p mean: 0.44856902956962585, gen p mean: -0.24008551239967346, mean p set: 0.44908908009529114
loss_pred:0.01472367625683546, decouple_loss:0.0021298322826623917
Iteration: 4716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799721240997314, gen p mean: -0.23548464477062225, mean p set: 0.44857507944107056
loss_pred:0.01404845342040062, decouple_loss:0.0015899171121418476
The modified gen p mean: 0.44842734932899475, gen p mean: -0.2330620437860489, mean p set: 0.44895321130752563The modified gen p mean: 0.4475894570350647, gen p mean: -0.23847250640392303, mean p set: 0.44816285371780396
loss_pred:0.013679096475243568, decouple_loss:0.0015157840680330992
loss_pred:0.014020550064742565, decouple_loss:0.0016432796837761998
Iteration: 4717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477730989456177, gen p mean: -0.22874799370765686, mean p set: 0.4483044445514679
loss_pred:0.01467033103108406, decouple_loss:0.0021385729778558016
The modified gen p mean: 0.44813159108161926, gen p mean: -0.22980165481567383, mean p set: 0.44871145486831665
loss_pred:0.014746186323463917, decouple_loss:0.0021469101775437593
The modified gen p mean: 0.44727960228919983, gen p mean: -0.22888430953025818, mean p set: 0.4478580951690674
loss_pred:0.013774766586720943, decouple_loss:0.001903014606796205
Iteration: 4718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474940896034241, gen p mean: -0.2348245531320572, mean p set: 0.4480244815349579
loss_pred:0.014159989543259144, decouple_loss:0.0016368544893339276
The modified gen p mean: 0.4476204216480255, gen p mean: -0.23358716070652008, mean p set: 0.44819530844688416
loss_pred:0.01451993640512228, decouple_loss:0.001769739086739719
The modified gen p mean: 0.4482569992542267, gen p mean: -0.2321222573518753, mean p set: 0.4488394856452942
loss_pred:0.014231123961508274, decouple_loss:0.001836532261222601
Iteration: 4719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490869641304016, gen p mean: -0.2375222146511078, mean p set: 0.4496676027774811
loss_pred:0.014850644394755363, decouple_loss:0.001795444288291037
The modified gen p mean: 0.4476807713508606, gen p mean: -0.23599903285503387, mean p set: 0.4482552707195282The modified gen p mean: 0.44965484738349915, gen p mean: -0.2382829636335373, mean p set: 0.4501863420009613
loss_pred:0.014722251333296299, decouple_loss:0.0020991081837564707
loss_pred:0.0144386887550354, decouple_loss:0.0017230149824172258
Iteration: 4720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485428035259247, gen p mean: -0.24212953448295593, mean p set: 0.4490683674812317
loss_pred:0.013789165765047073, decouple_loss:0.0018958147848024964
The modified gen p mean: 0.4493609070777893, gen p mean: -0.24010229110717773, mean p set: 0.4499371349811554
loss_pred:0.014281334355473518, decouple_loss:0.0017120956908911467
The modified gen p mean: 0.4481930136680603, gen p mean: -0.23807914555072784, mean p set: 0.44876912236213684
loss_pred:0.014543245546519756, decouple_loss:0.0018879272975027561
2023-04-28 00:14:10 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2404748499393463, mean p set: 0.4499112665653229
loss_pred:0.01522158645093441, decouple_loss:0.002029386116191745
The modified gen p mean: 0.44827330112457275, gen p mean: -0.2383885681629181, mean p set: 0.44879910349845886
The modified gen p mean: 0.4493001401424408, gen p mean: -0.24057495594024658, mean p set: 0.4498290419578552
loss_pred:0.015133587643504143, decouple_loss:0.0018920523580163717
loss_pred:0.014750286936759949, decouple_loss:0.002046595560386777
WV_1_PC_1_EH_0_PS_30, loss: 0.015134621411561966, avg_mse: 0.022349907085299492
current test mse: 0.02235
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 4721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44601452350616455, gen p mean: -0.23741094768047333, mean p set: 0.4465474784374237
loss_pred:0.014275803230702877, decouple_loss:0.0017488687299191952
The modified gen p mean: 0.4464244544506073, gen p mean: -0.2414882928133011, mean p set: 0.4470020830631256
loss_pred:0.01438482291996479, decouple_loss:0.002025067340582609
The modified gen p mean: 0.4471481144428253, gen p mean: -0.2369275689125061, mean p set: 0.4477251172065735
loss_pred:0.014314737170934677, decouple_loss:0.0016892412677407265
Iteration: 4722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467701017856598, gen p mean: -0.2380475550889969, mean p set: 0.44730156660079956
loss_pred:0.014173334464430809, decouple_loss:0.0016274520894512534
The modified gen p mean: 0.4467407166957855, gen p mean: -0.24004210531711578, mean p set: 0.4473183751106262
loss_pred:0.01456145104020834, decouple_loss:0.001636877073906362
The modified gen p mean: 0.44692566990852356, gen p mean: -0.23827655613422394, mean p set: 0.44749704003334045
loss_pred:0.015076784417033195, decouple_loss:0.0018485111650079489
Iteration: 4723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653353095054626, gen p mean: -0.23728497326374054, mean p set: 0.44706007838249207
loss_pred:0.013919931836426258, decouple_loss:0.0020769378170371056
The modified gen p mean: 0.44642576575279236, gen p mean: -0.2392130047082901, mean p set: 0.44699564576148987
loss_pred:0.014468244276940823, decouple_loss:0.002123867394402623
The modified gen p mean: 0.44695138931274414, gen p mean: -0.23686416447162628, mean p set: 0.44753265380859375
loss_pred:0.013999979943037033, decouple_loss:0.0019467006204649806
Iteration: 4724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466596245765686, gen p mean: -0.22946152091026306, mean p set: 0.447183758020401
loss_pred:0.014450534246861935, decouple_loss:0.001828825450502336
The modified gen p mean: 0.4465904235839844, gen p mean: -0.22512903809547424, mean p set: 0.4471670687198639
loss_pred:0.013979451730847359, decouple_loss:0.001696955761872232
The modified gen p mean: 0.4466233253479004, gen p mean: -0.2316703051328659, mean p set: 0.44719746708869934
loss_pred:0.014210138469934464, decouple_loss:0.00197811471298337
Iteration: 4725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466186463832855, gen p mean: -0.23035436868667603, mean p set: 0.4471467435359955
loss_pred:0.014057973399758339, decouple_loss:0.001623031566850841
The modified gen p mean: 0.4465199112892151, gen p mean: -0.2336699366569519, mean p set: 0.44709545373916626
loss_pred:0.014179174788296223, decouple_loss:0.0016912544379010797
The modified gen p mean: 0.44695842266082764, gen p mean: -0.2286664843559265, mean p set: 0.4475364685058594
loss_pred:0.01390918530523777, decouple_loss:0.0016135999467223883
Iteration: 4726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451262652873993, gen p mean: -0.23167815804481506, mean p set: 0.44565579295158386
loss_pred:0.014049159362912178, decouple_loss:0.0018002305878326297
The modified gen p mean: 0.4468541145324707, gen p mean: -0.2307293862104416, mean p set: 0.4474301338195801
loss_pred:0.014072992838919163, decouple_loss:0.0015280861407518387
The modified gen p mean: 0.4463421106338501, gen p mean: -0.23548264801502228, mean p set: 0.44691362977027893
loss_pred:0.014316254295408726, decouple_loss:0.0015622822102159262
Iteration: 4727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452225863933563, gen p mean: -0.23375675082206726, mean p set: 0.44578808546066284
loss_pred:0.014095820486545563, decouple_loss:0.001714234473183751
The modified gen p mean: 0.4483504891395569, gen p mean: -0.23298881947994232, mean p set: 0.4489297568798065
loss_pred:0.013629923574626446, decouple_loss:0.0018141459440812469
The modified gen p mean: 0.44515347480773926, gen p mean: -0.23192985355854034, mean p set: 0.4456845819950104
loss_pred:0.014248060062527657, decouple_loss:0.00173218606505543
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460248649120331, gen p mean: -0.2301672250032425, mean p set: 0.4466037154197693
loss_pred:0.014520445838570595, decouple_loss:0.001647790428251028
The modified gen p mean: 0.4478473961353302, gen p mean: -0.23583228886127472, mean p set: 0.44842633605003357
loss_pred:0.013571886345744133, decouple_loss:0.0019158603390678763
The modified gen p mean: 0.44771355390548706, gen p mean: -0.22866469621658325, mean p set: 0.4482450783252716
loss_pred:0.01401292160153389, decouple_loss:0.001811453839763999
Iteration: 4729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467814266681671, gen p mean: -0.23436245322227478, mean p set: 0.4473608434200287
loss_pred:0.01427421160042286, decouple_loss:0.0017366738757118583
The modified gen p mean: 0.4460197687149048, gen p mean: -0.23681814968585968, mean p set: 0.44659578800201416
loss_pred:0.01427796483039856, decouple_loss:0.0017514409264549613
The modified gen p mean: 0.4471099376678467, gen p mean: -0.23085220158100128, mean p set: 0.4476316571235657
loss_pred:0.014475969597697258, decouple_loss:0.0015543700428679585
Iteration: 4730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753605127334595, gen p mean: -0.2316083461046219, mean p set: 0.44806838035583496
loss_pred:0.013658687472343445, decouple_loss:0.001782643492333591
The modified gen p mean: 0.44600117206573486, gen p mean: -0.23854483664035797, mean p set: 0.4465794563293457
loss_pred:0.014164978638291359, decouple_loss:0.0017858750652521849
The modified gen p mean: 0.4472496211528778, gen p mean: -0.2395225167274475, mean p set: 0.44782721996307373
loss_pred:0.013846397399902344, decouple_loss:0.0017176676774397492
2023-04-28 00:18:25 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23631168901920319, mean p set: 0.4499112665653229
loss_pred:0.015173051506280899, decouple_loss:0.0018581325421109796
The modified gen p mean: 0.448272705078125, gen p mean: -0.23417755961418152, mean p set: 0.44879910349845886
loss_pred:0.015120175667107105, decouple_loss:0.0018444466404616833
The modified gen p mean: 0.4493059515953064, gen p mean: -0.23661743104457855, mean p set: 0.4498290419578552
loss_pred:0.014702778309583664, decouple_loss:0.00165691995061934
WV_1_PC_1_EH_0_PS_30, loss: 0.015087993815541267, avg_mse: 0.022215139120817184
current test mse: 0.022215
Iteration: 4731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669827818870544, gen p mean: -0.23556238412857056, mean p set: 0.44727569818496704
loss_pred:0.014012881554663181, decouple_loss:0.0017383985687047243
The modified gen p mean: 0.4465748369693756, gen p mean: -0.23663942515850067, mean p set: 0.4471500515937805
loss_pred:0.014650392346084118, decouple_loss:0.0019104727543890476
The modified gen p mean: 0.44708311557769775, gen p mean: -0.2327800989151001, mean p set: 0.44760966300964355
loss_pred:0.0144480736926198, decouple_loss:0.0018444341840222478
Iteration: 4732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456178843975067, gen p mean: -0.2403031587600708, mean p set: 0.4461512565612793
loss_pred:0.013966700062155724, decouple_loss:0.002162169897928834
The modified gen p mean: 0.44589999318122864, gen p mean: -0.23580749332904816, mean p set: 0.44647684693336487The modified gen p mean: 0.4467178285121918, gen p mean: -0.23577849566936493, mean p set: 0.44729331135749817
loss_pred:0.014827343635261059, decouple_loss:0.002134111011400819
loss_pred:0.014235458336770535, decouple_loss:0.0022384291514754295
Iteration: 4733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462796449661255, gen p mean: -0.23960770666599274, mean p set: 0.44680705666542053
loss_pred:0.014188084751367569, decouple_loss:0.0017196297412738204
The modified gen p mean: 0.44687509536743164, gen p mean: -0.23407824337482452, mean p set: 0.4474572241306305The modified gen p mean: 0.4468894898891449, gen p mean: -0.2370530515909195, mean p set: 0.44746461510658264
loss_pred:0.014093778096139431, decouple_loss:0.0019432133994996548
loss_pred:0.014156881719827652, decouple_loss:0.0016336750704795122
Iteration: 4734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476446509361267, gen p mean: -0.23018144071102142, mean p set: 0.44818106293678284
loss_pred:0.013739808462560177, decouple_loss:0.0022363844327628613
The modified gen p mean: 0.44670453667640686, gen p mean: -0.23823298513889313, mean p set: 0.44728177785873413The modified gen p mean: 0.4460083544254303, gen p mean: -0.2378753423690796, mean p set: 0.44658660888671875
loss_pred:0.013937023468315601, decouple_loss:0.0021812592167407274
loss_pred:0.014262205921113491, decouple_loss:0.0020064623095095158
Iteration: 4735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44600793719291687, gen p mean: -0.23446159064769745, mean p set: 0.44653791189193726
loss_pred:0.014348671771585941, decouple_loss:0.0016727374168112874
The modified gen p mean: 0.44668933749198914, gen p mean: -0.23600776493549347, mean p set: 0.44726231694221497The modified gen p mean: 0.44624459743499756, gen p mean: -0.2369995415210724, mean p set: 0.44682133197784424
loss_pred:0.013843654654920101, decouple_loss:0.0017439050134271383
loss_pred:0.014069181866943836, decouple_loss:0.0017540680710226297
Iteration: 4736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44528287649154663, gen p mean: -0.23710405826568604, mean p set: 0.445857435464859
The modified gen p mean: 0.4474632441997528, gen p mean: -0.23663291335105896, mean p set: 0.4480440020561218
loss_pred:0.014461446553468704, decouple_loss:0.0024123312905430794
loss_pred:0.013850085437297821, decouple_loss:0.0021570799872279167
The modified gen p mean: 0.44647181034088135, gen p mean: -0.23516814410686493, mean p set: 0.4469999372959137
loss_pred:0.014123039320111275, decouple_loss:0.0024941666051745415
Iteration: 4737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730597734451294, gen p mean: -0.23638862371444702, mean p set: 0.44788506627082825
loss_pred:0.013964623212814331, decouple_loss:0.0018888716585934162
The modified gen p mean: 0.44647255539894104, gen p mean: -0.23444929718971252, mean p set: 0.44704607129096985
loss_pred:0.013710965402424335, decouple_loss:0.0017951728077605367
The modified gen p mean: 0.4467521607875824, gen p mean: -0.23653995990753174, mean p set: 0.44728413224220276
loss_pred:0.013881144113838673, decouple_loss:0.0017427194397896528
Iteration: 4738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44624385237693787, gen p mean: -0.23384153842926025, mean p set: 0.446819543838501
The modified gen p mean: 0.44663992524147034, gen p mean: -0.23519927263259888, mean p set: 0.44722166657447815loss_pred:0.014268162660300732, decouple_loss:0.002425674581900239
loss_pred:0.014309411868453026, decouple_loss:0.0023704683408141136
The modified gen p mean: 0.44657638669013977, gen p mean: -0.2316996157169342, mean p set: 0.4471038281917572
loss_pred:0.014384197071194649, decouple_loss:0.00241103651933372
Iteration: 4739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469040334224701, gen p mean: -0.236044779419899, mean p set: 0.44748565554618835
The modified gen p mean: 0.44715914130210876, gen p mean: -0.231205552816391, mean p set: 0.4477333426475525
loss_pred:0.014962729997932911, decouple_loss:0.0019423975609242916
loss_pred:0.0137552535161376, decouple_loss:0.0017496863147243857
The modified gen p mean: 0.4463176429271698, gen p mean: -0.23511864244937897, mean p set: 0.446846604347229
loss_pred:0.0141420504078269, decouple_loss:0.0022567645646631718
Iteration: 4740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468195140361786, gen p mean: -0.2332025170326233, mean p set: 0.4473506212234497
loss_pred:0.014243540354073048, decouple_loss:0.0018219532212242484
The modified gen p mean: 0.4466922879219055, gen p mean: -0.23938129842281342, mean p set: 0.4472668468952179The modified gen p mean: 0.44633471965789795, gen p mean: -0.23420526087284088, mean p set: 0.44691479206085205
loss_pred:0.013836816884577274, decouple_loss:0.0019494160078465939
loss_pred:0.01466770377010107, decouple_loss:0.0017632899107411504
2023-04-28 00:21:48 testing...
The modified gen p mean: 0.44827255606651306, gen p mean: -0.2344200164079666, mean p set: 0.44879910349845886
loss_pred:0.015151675790548325, decouple_loss:0.0018501078011468053
The modified gen p mean: 0.4493037462234497, gen p mean: -0.23694370687007904, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2364550232887268, mean p set: 0.4499112665653229loss_pred:0.01473794225603342, decouple_loss:0.0019955337047576904
loss_pred:0.015171406790614128, decouple_loss:0.0018745876150205731
WV_1_PC_1_EH_0_PS_30, loss: 0.015115678310394287, avg_mse: 0.02225198782980442
current test mse: 0.022252
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 4741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473476707935333, gen p mean: -0.23334579169750214, mean p set: 0.44786933064460754
loss_pred:0.014322072267532349, decouple_loss:0.002025546273216605
The modified gen p mean: 0.4480229914188385, gen p mean: -0.23235787451267242, mean p set: 0.44860100746154785
The modified gen p mean: 0.44674208760261536, gen p mean: -0.2340421825647354, mean p set: 0.44732168316841125
loss_pred:0.013888075016438961, decouple_loss:0.0023511936888098717
loss_pred:0.013709397055208683, decouple_loss:0.0026190560311079025
Iteration: 4742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633373618125916, gen p mean: -0.24579931795597076, mean p set: 0.4468553960323334
loss_pred:0.014062754809856415, decouple_loss:0.0017984886653721333
The modified gen p mean: 0.4470956325531006, gen p mean: -0.23819614946842194, mean p set: 0.4476735293865204
The modified gen p mean: 0.4465557932853699, gen p mean: -0.24304693937301636, mean p set: 0.44713205099105835
loss_pred:0.01393196452409029, decouple_loss:0.0017014197073876858
loss_pred:0.013918595388531685, decouple_loss:0.001688683871179819
Iteration: 4743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466589689254761, gen p mean: -0.24151113629341125, mean p set: 0.4471876323223114
loss_pred:0.014258635230362415, decouple_loss:0.001967906253412366
The modified gen p mean: 0.4465238153934479, gen p mean: -0.23687034845352173, mean p set: 0.4471038579940796
The modified gen p mean: 0.4465399384498596, gen p mean: -0.24584032595157623, mean p set: 0.4471111297607422
loss_pred:0.014992800541222095, decouple_loss:0.00198348518460989
loss_pred:0.013661949895322323, decouple_loss:0.0019335229881107807
Iteration: 4744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44650664925575256, gen p mean: -0.23720259964466095, mean p set: 0.44708362221717834
loss_pred:0.013863935135304928, decouple_loss:0.0018139338353648782
The modified gen p mean: 0.4472031593322754, gen p mean: -0.23275427520275116, mean p set: 0.4477759599685669
loss_pred:0.014521321281790733, decouple_loss:0.0016617444343864918
The modified gen p mean: 0.4472326934337616, gen p mean: -0.23175957798957825, mean p set: 0.4477570950984955
loss_pred:0.013610205613076687, decouple_loss:0.001885266974568367
Iteration: 4745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481649398803711, gen p mean: -0.2309938669204712, mean p set: 0.4486927390098572
loss_pred:0.013352351263165474, decouple_loss:0.0023518959060311317
The modified gen p mean: 0.44682034850120544, gen p mean: -0.237562358379364, mean p set: 0.44739529490470886
The modified gen p mean: 0.44745978713035583, gen p mean: -0.24190539121627808, mean p set: 0.4480327367782593
loss_pred:0.0135824428871274, decouple_loss:0.00189194455742836
loss_pred:0.013918551616370678, decouple_loss:0.0019957120530307293
Iteration: 4746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472012221813202, gen p mean: -0.23280476033687592, mean p set: 0.4477759003639221
loss_pred:0.013785628601908684, decouple_loss:0.0020685060881078243
The modified gen p mean: 0.44662734866142273, gen p mean: -0.2364688217639923, mean p set: 0.44715800881385803The modified gen p mean: 0.44692957401275635, gen p mean: -0.23352977633476257, mean p set: 0.4475066065788269
loss_pred:0.0129889827221632, decouple_loss:0.001943992218002677
loss_pred:0.01306995376944542, decouple_loss:0.001927266945131123
Iteration: 4747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727715849876404, gen p mean: -0.2319246530532837, mean p set: 0.44785767793655396
loss_pred:0.014446507208049297, decouple_loss:0.001830959809012711
The modified gen p mean: 0.44722312688827515, gen p mean: -0.22825412452220917, mean p set: 0.4477977156639099
loss_pred:0.013650628738105297, decouple_loss:0.0022594789043068886
The modified gen p mean: 0.44690293073654175, gen p mean: -0.2317950576543808, mean p set: 0.4474334716796875
loss_pred:0.014198063872754574, decouple_loss:0.001920758979395032
Iteration: 4748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676467776298523, gen p mean: -0.2289099544286728, mean p set: 0.4473371207714081
loss_pred:0.012949762865900993, decouple_loss:0.0018753110198304057
The modified gen p mean: 0.4470962882041931, gen p mean: -0.22712771594524384, mean p set: 0.4476739168167114
loss_pred:0.014119097962975502, decouple_loss:0.0019869471434503794
The modified gen p mean: 0.4481661319732666, gen p mean: -0.2266768366098404, mean p set: 0.44869264960289
loss_pred:0.013587766326963902, decouple_loss:0.0019112558802589774
Iteration: 4749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446842223405838, gen p mean: -0.2315106838941574, mean p set: 0.447416752576828
loss_pred:0.013395561836659908, decouple_loss:0.0019316583639010787
The modified gen p mean: 0.44805043935775757, gen p mean: -0.22758714854717255, mean p set: 0.44862768054008484
The modified gen p mean: 0.44711625576019287, gen p mean: -0.23412014544010162, mean p set: 0.44764021039009094
loss_pred:0.013431071303784847, decouple_loss:0.0019553815945982933
loss_pred:0.014163045212626457, decouple_loss:0.0021844226866960526
Iteration: 4750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447075217962265, gen p mean: -0.2347128540277481, mean p set: 0.44764676690101624
loss_pred:0.014214104041457176, decouple_loss:0.0017978129908442497
The modified gen p mean: 0.44711437821388245, gen p mean: -0.23428627848625183, mean p set: 0.44768741726875305
loss_pred:0.013608011417090893, decouple_loss:0.0018511534435674548
The modified gen p mean: 0.4476552903652191, gen p mean: -0.238334521651268, mean p set: 0.44817930459976196
loss_pred:0.013937903568148613, decouple_loss:0.0017121594864875078
2023-04-28 00:25:51 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23928654193878174, mean p set: 0.4499112665653229
loss_pred:0.015262795612215996, decouple_loss:0.0018941432936117053
The modified gen p mean: 0.44827577471733093, gen p mean: -0.23728018999099731, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930097460746765, gen p mean: -0.23998567461967468, mean p set: 0.4498290419578552
loss_pred:0.015221400186419487, decouple_loss:0.0018134692218154669
loss_pred:0.014851471409201622, decouple_loss:0.001908059581182897
WV_1_PC_1_EH_0_PS_30, loss: 0.015205482952296734, avg_mse: 0.022464603185653687
current test mse: 0.022465
Iteration: 4751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482062757015228, gen p mean: -0.23574186861515045, mean p set: 0.44872787594795227
loss_pred:0.012958956882357597, decouple_loss:0.002057872712612152
The modified gen p mean: 0.4470817446708679, gen p mean: -0.24207650125026703, mean p set: 0.44765499234199524
loss_pred:0.01393948495388031, decouple_loss:0.0017907809233292937
The modified gen p mean: 0.4480849504470825, gen p mean: -0.23938725888729095, mean p set: 0.4486611485481262
loss_pred:0.014278659597039223, decouple_loss:0.0018949517980217934
Iteration: 4752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464774429798126, gen p mean: -0.23966404795646667, mean p set: 0.4470026195049286
loss_pred:0.013841426931321621, decouple_loss:0.001726181828416884
The modified gen p mean: 0.4463120698928833, gen p mean: -0.23301512002944946, mean p set: 0.44688504934310913
loss_pred:0.013485550880432129, decouple_loss:0.0017047910951077938
The modified gen p mean: 0.44865676760673523, gen p mean: -0.23756128549575806, mean p set: 0.44923636317253113
loss_pred:0.013140115886926651, decouple_loss:0.0016674677608534694
Iteration: 4753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699108600616455, gen p mean: -0.23693327605724335, mean p set: 0.44751641154289246
loss_pred:0.01364885549992323, decouple_loss:0.001904263743199408
The modified gen p mean: 0.4471067488193512, gen p mean: -0.2346566915512085, mean p set: 0.4476839005947113
loss_pred:0.012775201350450516, decouple_loss:0.0018517165444791317
The modified gen p mean: 0.4466954469680786, gen p mean: -0.23862749338150024, mean p set: 0.4472716748714447
loss_pred:0.014396256767213345, decouple_loss:0.0020171150099486113
Iteration: 4754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44602280855178833, gen p mean: -0.2395845353603363, mean p set: 0.4465501010417938
loss_pred:0.01404604408890009, decouple_loss:0.00177601701579988
The modified gen p mean: 0.4465985894203186, gen p mean: -0.23922421038150787, mean p set: 0.44717565178871155The modified gen p mean: 0.4470694065093994, gen p mean: -0.23282542824745178, mean p set: 0.4476470947265625
loss_pred:0.014162207022309303, decouple_loss:0.0018073410028591752
loss_pred:0.013430283404886723, decouple_loss:0.0018447887850925326
Iteration: 4755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609901309013367, gen p mean: -0.2371976226568222, mean p set: 0.44662564992904663
loss_pred:0.014126593247056007, decouple_loss:0.0019260060507804155
The modified gen p mean: 0.44643494486808777, gen p mean: -0.23154887557029724, mean p set: 0.4470112919807434
loss_pred:0.012909048236906528, decouple_loss:0.0017959022661671042
The modified gen p mean: 0.4473530054092407, gen p mean: -0.23535440862178802, mean p set: 0.447934627532959
loss_pred:0.014136981219053268, decouple_loss:0.0018650059355422854
Iteration: 4756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790443778038025, gen p mean: -0.2310960441827774, mean p set: 0.44842812418937683
loss_pred:0.013823292218148708, decouple_loss:0.0018977858126163483
The modified gen p mean: 0.44793060421943665, gen p mean: -0.23288396000862122, mean p set: 0.4485190510749817The modified gen p mean: 0.44721341133117676, gen p mean: -0.23275169730186462, mean p set: 0.4477875828742981
loss_pred:0.014172792434692383, decouple_loss:0.0017642949242144823
loss_pred:0.014208240434527397, decouple_loss:0.00194523052778095
Iteration: 4757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483099579811096, gen p mean: -0.2260531485080719, mean p set: 0.44888240098953247
loss_pred:0.013379772193729877, decouple_loss:0.0020579397678375244
The modified gen p mean: 0.44809678196907043, gen p mean: -0.23114845156669617, mean p set: 0.4486280083656311The modified gen p mean: 0.44770997762680054, gen p mean: -0.2333253175020218, mean p set: 0.4482881724834442
loss_pred:0.013827631250023842, decouple_loss:0.0016880782786756754
loss_pred:0.013210988603532314, decouple_loss:0.0016938481712713838
Iteration: 4758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684481620788574, gen p mean: -0.23939520120620728, mean p set: 0.4473738372325897
loss_pred:0.013274767436087132, decouple_loss:0.0022176136262714863
The modified gen p mean: 0.44744130969047546, gen p mean: -0.2317802608013153, mean p set: 0.44801655411720276
loss_pred:0.012727690860629082, decouple_loss:0.0020721943583339453
The modified gen p mean: 0.44600343704223633, gen p mean: -0.23298126459121704, mean p set: 0.4465774595737457
loss_pred:0.014523358084261417, decouple_loss:0.0020478861406445503
Iteration: 4759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468599557876587, gen p mean: -0.24108834564685822, mean p set: 0.44743743538856506
loss_pred:0.013923680409789085, decouple_loss:0.0017071360489353538
The modified gen p mean: 0.4472995698451996, gen p mean: -0.24139581620693207, mean p set: 0.4478755593299866
loss_pred:0.014115255326032639, decouple_loss:0.0017253303667530417
The modified gen p mean: 0.44762009382247925, gen p mean: -0.2338504046201706, mean p set: 0.44814640283584595
loss_pred:0.014069550670683384, decouple_loss:0.0017628431087359786
Iteration: 4760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653382897377014, gen p mean: -0.22964641451835632, mean p set: 0.4471050798892975
loss_pred:0.013109603896737099, decouple_loss:0.002138708718121052
The modified gen p mean: 0.44775187969207764, gen p mean: -0.2332482635974884, mean p set: 0.44832831621170044
loss_pred:0.01430978998541832, decouple_loss:0.0016418081941083074
The modified gen p mean: 0.4474281966686249, gen p mean: -0.2371579110622406, mean p set: 0.4479525089263916
loss_pred:0.013692126609385014, decouple_loss:0.0016307123005390167
2023-04-28 00:29:14 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23470520973205566, mean p set: 0.4499112665653229
loss_pred:0.015187125653028488, decouple_loss:0.001631384831853211
The modified gen p mean: 0.4482713043689728, gen p mean: -0.23244145512580872, mean p set: 0.44879910349845886
loss_pred:0.015189926140010357, decouple_loss:0.001646327436901629
The modified gen p mean: 0.4493083357810974, gen p mean: -0.23550046980381012, mean p set: 0.4498290419578552
loss_pred:0.014774522744119167, decouple_loss:0.0017944909632205963
WV_1_PC_1_EH_0_PS_30, loss: 0.015135062858462334, avg_mse: 0.02238105982542038
current test mse: 0.022381
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 4761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450248122215271, gen p mean: -0.22567996382713318, mean p set: 0.4507763385772705
loss_pred:0.013673550449311733, decouple_loss:0.0016915058949962258
The modified gen p mean: 0.4493887722492218, gen p mean: -0.23738786578178406, mean p set: 0.44996631145477295
loss_pred:0.013726577162742615, decouple_loss:0.0018653783481568098
The modified gen p mean: 0.44837135076522827, gen p mean: -0.23879693448543549, mean p set: 0.4489458501338959
loss_pred:0.014062009751796722, decouple_loss:0.0019877783488482237
Iteration: 4762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492245614528656, gen p mean: -0.22497214376926422, mean p set: 0.4497552812099457
loss_pred:0.013874128460884094, decouple_loss:0.0018212436698377132
The modified gen p mean: 0.45002448558807373, gen p mean: -0.2271241843700409, mean p set: 0.4506046175956726
loss_pred:0.014270556159317493, decouple_loss:0.0017050412716343999
The modified gen p mean: 0.4488491415977478, gen p mean: -0.2330043762922287, mean p set: 0.4494198262691498
loss_pred:0.01486634835600853, decouple_loss:0.0016980182845145464
Iteration: 4763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481804072856903, gen p mean: -0.2316196709871292, mean p set: 0.44870686531066895
loss_pred:0.01520377118140459, decouple_loss:0.0019064393127337098
The modified gen p mean: 0.4487360715866089, gen p mean: -0.23049946129322052, mean p set: 0.4493071436882019
loss_pred:0.014926414005458355, decouple_loss:0.0016697836108505726
The modified gen p mean: 0.4507273733615875, gen p mean: -0.2265961617231369, mean p set: 0.45130491256713867
loss_pred:0.01379263587296009, decouple_loss:0.0017415162874385715
Iteration: 4764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45002514123916626, gen p mean: -0.22292162477970123, mean p set: 0.4505513906478882
loss_pred:0.013506567105650902, decouple_loss:0.0020247772336006165
The modified gen p mean: 0.44851016998291016, gen p mean: -0.22778792679309845, mean p set: 0.44908788800239563
loss_pred:0.014804205857217312, decouple_loss:0.0016395347192883492
The modified gen p mean: 0.44864487648010254, gen p mean: -0.23284539580345154, mean p set: 0.449221134185791
loss_pred:0.013843730092048645, decouple_loss:0.0017875558696687222
Iteration: 4765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496767520904541, gen p mean: -0.22651083767414093, mean p set: 0.45026013255119324
loss_pred:0.014246531762182713, decouple_loss:0.001747174421325326
The modified gen p mean: 0.44937682151794434, gen p mean: -0.22158558666706085, mean p set: 0.44995465874671936The modified gen p mean: 0.4483243227005005, gen p mean: -0.2251519411802292, mean p set: 0.44885316491127014
loss_pred:0.013750889338552952, decouple_loss:0.002099437639117241
loss_pred:0.014320584945380688, decouple_loss:0.0018658206099644303
Iteration: 4766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45029374957084656, gen p mean: -0.22027593851089478, mean p set: 0.4508661925792694
loss_pred:0.013870632275938988, decouple_loss:0.0018026711186394095
The modified gen p mean: 0.4484671354293823, gen p mean: -0.2282281517982483, mean p set: 0.448993444442749
The modified gen p mean: 0.4487713575363159, gen p mean: -0.22388051450252533, mean p set: 0.4493391215801239
loss_pred:0.01424211822450161, decouple_loss:0.0017517349915578961
loss_pred:0.013935929164290428, decouple_loss:0.0016356045380234718
Iteration: 4767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505658447742462, gen p mean: -0.2253934144973755, mean p set: 0.451143354177475
loss_pred:0.01419813372194767, decouple_loss:0.001850562752224505
The modified gen p mean: 0.44795525074005127, gen p mean: -0.22704380750656128, mean p set: 0.4485381245613098The modified gen p mean: 0.44896069169044495, gen p mean: -0.22976237535476685, mean p set: 0.44949063658714294
loss_pred:0.014858880080282688, decouple_loss:0.0019183858530595899
loss_pred:0.013790056109428406, decouple_loss:0.001909542828798294
Iteration: 4768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490238428115845, gen p mean: -0.22458194196224213, mean p set: 0.44959837198257446
loss_pred:0.014337931759655476, decouple_loss:0.001795250573195517
The modified gen p mean: 0.44917526841163635, gen p mean: -0.22896218299865723, mean p set: 0.4497511684894562
loss_pred:0.014344941824674606, decouple_loss:0.00173049361910671
The modified gen p mean: 0.44798219203948975, gen p mean: -0.23056671023368835, mean p set: 0.44850999116897583
loss_pred:0.014229469001293182, decouple_loss:0.001859311363659799
Iteration: 4769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756969809532166, gen p mean: -0.22941073775291443, mean p set: 0.44813892245292664
loss_pred:0.01494557410478592, decouple_loss:0.0018271055305376649
The modified gen p mean: 0.4495973289012909, gen p mean: -0.22977091372013092, mean p set: 0.45017269253730774
loss_pred:0.013927805237472057, decouple_loss:0.0017569208284839988
The modified gen p mean: 0.4505291283130646, gen p mean: -0.22560738027095795, mean p set: 0.45106619596481323
loss_pred:0.013384915888309479, decouple_loss:0.001980272587388754
Iteration: 4770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910764694213867, gen p mean: -0.23153111338615417, mean p set: 0.4496835172176361
loss_pred:0.014191955327987671, decouple_loss:0.0016704401932656765
The modified gen p mean: 0.45081081986427307, gen p mean: -0.22568468749523163, mean p set: 0.45138660073280334
loss_pred:0.013769161887466908, decouple_loss:0.001724262605421245
The modified gen p mean: 0.44930967688560486, gen p mean: -0.23089481890201569, mean p set: 0.4498424530029297
loss_pred:0.014139427803456783, decouple_loss:0.0017420763615518808
2023-04-28 00:33:18 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22953960299491882, mean p set: 0.4499112665653229
loss_pred:0.015197958797216415, decouple_loss:0.001905682380311191
The modified gen p mean: 0.44827190041542053, gen p mean: -0.2267933040857315, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930195808410645, gen p mean: -0.229959636926651, mean p set: 0.4498290419578552
loss_pred:0.015205125324428082, decouple_loss:0.001792698516510427
loss_pred:0.014793318696320057, decouple_loss:0.0019857208244502544
WV_1_PC_1_EH_0_PS_30, loss: 0.015160202980041504, avg_mse: 0.02238217368721962
current test mse: 0.022382
Iteration: 4771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495907723903656, gen p mean: -0.22783349454402924, mean p set: 0.4501734673976898
loss_pred:0.013868268579244614, decouple_loss:0.0019561811350286007
The modified gen p mean: 0.44918686151504517, gen p mean: -0.2276923507452011, mean p set: 0.4497663974761963
loss_pred:0.013629401102662086, decouple_loss:0.0017486819997429848
The modified gen p mean: 0.4496213495731354, gen p mean: -0.22591739892959595, mean p set: 0.4501534700393677
loss_pred:0.013904412277042866, decouple_loss:0.001690269447863102
Iteration: 4772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448985755443573, gen p mean: -0.231476292014122, mean p set: 0.4495182931423187
loss_pred:0.013788864016532898, decouple_loss:0.002093385672196746
The modified gen p mean: 0.4500173032283783, gen p mean: -0.22595471143722534, mean p set: 0.4505905210971832
loss_pred:0.013925966806709766, decouple_loss:0.001985866343602538
The modified gen p mean: 0.4500943422317505, gen p mean: -0.22462235391139984, mean p set: 0.45066767930984497
loss_pred:0.014206606894731522, decouple_loss:0.001821580808609724
Iteration: 4773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915300607681274, gen p mean: -0.2305169552564621, mean p set: 0.4496765732765198
loss_pred:0.014508519321680069, decouple_loss:0.0019386251224204898
The modified gen p mean: 0.4507187604904175, gen p mean: -0.22756099700927734, mean p set: 0.45129016041755676
loss_pred:0.013943387195467949, decouple_loss:0.0019532323349267244
The modified gen p mean: 0.44919219613075256, gen p mean: -0.2327016443014145, mean p set: 0.4497673809528351
loss_pred:0.014258847571909428, decouple_loss:0.00179372972343117
Iteration: 4774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798946380615234, gen p mean: -0.23083297908306122, mean p set: 0.44851261377334595
loss_pred:0.013311023823916912, decouple_loss:0.0017532287165522575
The modified gen p mean: 0.44876375794410706, gen p mean: -0.22886104881763458, mean p set: 0.44934147596359253
loss_pred:0.01404056791216135, decouple_loss:0.0017090033506974578
The modified gen p mean: 0.44830167293548584, gen p mean: -0.22822105884552002, mean p set: 0.4488740861415863
loss_pred:0.014093427918851376, decouple_loss:0.0018050346989184618
Iteration: 4775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969072937965393, gen p mean: -0.23535698652267456, mean p set: 0.4502677023410797
loss_pred:0.013982613570988178, decouple_loss:0.0019085368840023875
The modified gen p mean: 0.44909995794296265, gen p mean: -0.23786473274230957, mean p set: 0.44967731833457947
loss_pred:0.013662717305123806, decouple_loss:0.0018496392294764519
The modified gen p mean: 0.45009124279022217, gen p mean: -0.2308429330587387, mean p set: 0.4506189823150635
loss_pred:0.01377930212765932, decouple_loss:0.002135841641575098
Iteration: 4776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914376735687256, gen p mean: -0.23640410602092743, mean p set: 0.4497183561325073
loss_pred:0.014205878600478172, decouple_loss:0.0018183114007115364
The modified gen p mean: 0.4484916925430298, gen p mean: -0.23545923829078674, mean p set: 0.44906798005104065The modified gen p mean: 0.44979339838027954, gen p mean: -0.24084211885929108, mean p set: 0.4503171145915985
loss_pred:0.013931721448898315, decouple_loss:0.002064208500087261
loss_pred:0.013829514384269714, decouple_loss:0.0019968629349023104
Iteration: 4777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448821097612381, gen p mean: -0.23478183150291443, mean p set: 0.4493984878063202
loss_pred:0.014240991324186325, decouple_loss:0.001830439199693501
The modified gen p mean: 0.4499056935310364, gen p mean: -0.23484493792057037, mean p set: 0.4504837691783905
loss_pred:0.013956818729639053, decouple_loss:0.001864478923380375
The modified gen p mean: 0.4491303265094757, gen p mean: -0.23519086837768555, mean p set: 0.4496645927429199
loss_pred:0.013733694329857826, decouple_loss:0.0021709268912672997
Iteration: 4778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501303732395172, gen p mean: -0.23117542266845703, mean p set: 0.45070981979370117
loss_pred:0.013677195645868778, decouple_loss:0.002097993390634656
The modified gen p mean: 0.4491715729236603, gen p mean: -0.2334364801645279, mean p set: 0.4497471749782562
loss_pred:0.013171883299946785, decouple_loss:0.0016373826656490564
The modified gen p mean: 0.4483192265033722, gen p mean: -0.2373635470867157, mean p set: 0.44884949922561646
loss_pred:0.014295069500803947, decouple_loss:0.001648034667596221
Iteration: 4779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493429958820343, gen p mean: -0.23070277273654938, mean p set: 0.44991418719291687
loss_pred:0.013962929137051105, decouple_loss:0.0020591344218701124
The modified gen p mean: 0.4485397934913635, gen p mean: -0.23230700194835663, mean p set: 0.4491119980812073
loss_pred:0.014513940550386906, decouple_loss:0.0018987376242876053
The modified gen p mean: 0.4479192793369293, gen p mean: -0.22999902069568634, mean p set: 0.44845327734947205
loss_pred:0.013294132426381111, decouple_loss:0.00210729637183249
Iteration: 4780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495652914047241, gen p mean: -0.23240220546722412, mean p set: 0.45013657212257385
loss_pred:0.013773616403341293, decouple_loss:0.0017866442212834954
The modified gen p mean: 0.4489276111125946, gen p mean: -0.22952109575271606, mean p set: 0.4495089054107666
loss_pred:0.013906711712479591, decouple_loss:0.0016298623522743583
The modified gen p mean: 0.44959911704063416, gen p mean: -0.22713224589824677, mean p set: 0.45013123750686646
loss_pred:0.013879168778657913, decouple_loss:0.0016793193062767386
2023-04-28 00:36:42 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23316417634487152, mean p set: 0.4499112665653229
loss_pred:0.015249431133270264, decouple_loss:0.0023555313237011433
The modified gen p mean: 0.4482734501361847, gen p mean: -0.23049311339855194, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492999315261841, gen p mean: -0.23353958129882812, mean p set: 0.4498290419578552
loss_pred:0.015185955911874771, decouple_loss:0.002028498100116849
loss_pred:0.014777936041355133, decouple_loss:0.0022666596341878176
WV_1_PC_1_EH_0_PS_30, loss: 0.015181953087449074, avg_mse: 0.022382818162441254
current test mse: 0.022383
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 4781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469408392906189, gen p mean: -0.2374606430530548, mean p set: 0.4474697411060333
loss_pred:0.013851446099579334, decouple_loss:0.0023722578771412373
The modified gen p mean: 0.4479500353336334, gen p mean: -0.2347838282585144, mean p set: 0.4485260546207428
loss_pred:0.014487635344266891, decouple_loss:0.00217612087726593
The modified gen p mean: 0.44631579518318176, gen p mean: -0.2354707270860672, mean p set: 0.4468908905982971
loss_pred:0.013978777453303337, decouple_loss:0.002097790827974677
Iteration: 4782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675713777542114, gen p mean: -0.23733577132225037, mean p set: 0.4472857117652893
loss_pred:0.01390367653220892, decouple_loss:0.0020073975902050734
The modified gen p mean: 0.4491559565067291, gen p mean: -0.23588335514068604, mean p set: 0.44973060488700867
loss_pred:0.014142134226858616, decouple_loss:0.002025936497375369
The modified gen p mean: 0.44739222526550293, gen p mean: -0.23796497285366058, mean p set: 0.447966605424881
loss_pred:0.01376771368086338, decouple_loss:0.0019481603521853685
Iteration: 4783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469861686229706, gen p mean: -0.2342938929796219, mean p set: 0.447516530752182
loss_pred:0.014489424414932728, decouple_loss:0.0018383723217993975
The modified gen p mean: 0.4463559091091156, gen p mean: -0.23891040682792664, mean p set: 0.44693562388420105
loss_pred:0.013946949504315853, decouple_loss:0.0016449923859909177
The modified gen p mean: 0.4481795132160187, gen p mean: -0.2351224720478058, mean p set: 0.44875821471214294
loss_pred:0.01448564138263464, decouple_loss:0.0017210438381880522
Iteration: 4784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687017798423767, gen p mean: -0.24176733195781708, mean p set: 0.44739779829978943
loss_pred:0.013883227482438087, decouple_loss:0.0022446231450885534
The modified gen p mean: 0.44788599014282227, gen p mean: -0.24192863702774048, mean p set: 0.44845691323280334
loss_pred:0.014203473925590515, decouple_loss:0.0020350427366793156
The modified gen p mean: 0.448180228471756, gen p mean: -0.2394014596939087, mean p set: 0.44875115156173706
loss_pred:0.014682373963296413, decouple_loss:0.0020120549015700817
Iteration: 4785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44575461745262146, gen p mean: -0.2440638542175293, mean p set: 0.4463326036930084
loss_pred:0.013644878752529621, decouple_loss:0.001759353675879538
The modified gen p mean: 0.4473403990268707, gen p mean: -0.24513736367225647, mean p set: 0.44786328077316284The modified gen p mean: 0.4483450949192047, gen p mean: -0.23903781175613403, mean p set: 0.44892388582229614
loss_pred:0.014586025848984718, decouple_loss:0.0021403918508440256
loss_pred:0.013593727722764015, decouple_loss:0.0017417779890820384
Iteration: 4786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664573669433594, gen p mean: -0.23908066749572754, mean p set: 0.4472208023071289
loss_pred:0.01401272788643837, decouple_loss:0.0022320731077343225
The modified gen p mean: 0.4476233124732971, gen p mean: -0.24389393627643585, mean p set: 0.4481556713581085The modified gen p mean: 0.44701048731803894, gen p mean: -0.24674548208713531, mean p set: 0.4475838840007782
loss_pred:0.014078372158110142, decouple_loss:0.0018106373026967049
loss_pred:0.013956748880445957, decouple_loss:0.001868927851319313
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806089997291565, gen p mean: -0.23840934038162231, mean p set: 0.44864004850387573
loss_pred:0.01461963914334774, decouple_loss:0.0019646277651190758
The modified gen p mean: 0.446348637342453, gen p mean: -0.24021543562412262, mean p set: 0.44692057371139526The modified gen p mean: 0.4466114044189453, gen p mean: -0.24550001323223114, mean p set: 0.4471312463283539
loss_pred:0.013943536207079887, decouple_loss:0.002175509463995695
loss_pred:0.013759910129010677, decouple_loss:0.001818725373595953
Iteration: 4788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475914239883423, gen p mean: -0.24138754606246948, mean p set: 0.4481663107872009
loss_pred:0.014517853036522865, decouple_loss:0.0017745145596563816
The modified gen p mean: 0.4466557204723358, gen p mean: -0.24392642080783844, mean p set: 0.44718244671821594The modified gen p mean: 0.4464540481567383, gen p mean: -0.2412431687116623, mean p set: 0.44703078269958496
loss_pred:0.01392388716340065, decouple_loss:0.0018399122636765242
loss_pred:0.013675213791429996, decouple_loss:0.0017571349162608385
Iteration: 4789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447721928358078, gen p mean: -0.24130907654762268, mean p set: 0.44829845428466797
loss_pred:0.013416951522231102, decouple_loss:0.001671385020017624
The modified gen p mean: 0.44621172547340393, gen p mean: -0.23448507487773895, mean p set: 0.44678959250450134
loss_pred:0.013757732696831226, decouple_loss:0.0017782713985070586
The modified gen p mean: 0.44540831446647644, gen p mean: -0.2384166568517685, mean p set: 0.44594070315361023
loss_pred:0.013801260851323605, decouple_loss:0.0017462034011259675
Iteration: 4790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660183787345886, gen p mean: -0.23586714267730713, mean p set: 0.4471677839756012
loss_pred:0.01395465899258852, decouple_loss:0.0017319823382422328
The modified gen p mean: 0.4472389817237854, gen p mean: -0.24303007125854492, mean p set: 0.44777220487594604The modified gen p mean: 0.4462328553199768, gen p mean: -0.23830287158489227, mean p set: 0.44681257009506226
loss_pred:0.013612151145935059, decouple_loss:0.001845681807026267
loss_pred:0.013854221440851688, decouple_loss:0.001989646814763546
2023-04-28 00:40:46 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.23898592591285706, mean p set: 0.4499112665653229
loss_pred:0.015197906643152237, decouple_loss:0.001671636593528092
The modified gen p mean: 0.4482751786708832, gen p mean: -0.23620544373989105, mean p set: 0.44879910349845886
The modified gen p mean: 0.44929665327072144, gen p mean: -0.239340677857399, mean p set: 0.4498290419578552
loss_pred:0.015109243802726269, decouple_loss:0.0015634024748578668
loss_pred:0.014715376310050488, decouple_loss:0.001605129218660295
WV_1_PC_1_EH_0_PS_30, loss: 0.015088178217411041, avg_mse: 0.022324196994304657
current test mse: 0.022324
Iteration: 4791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777074456214905, gen p mean: -0.24038326740264893, mean p set: 0.44834670424461365
loss_pred:0.014337540604174137, decouple_loss:0.0015481405425816774
The modified gen p mean: 0.44698697328567505, gen p mean: -0.24171771109104156, mean p set: 0.4475601017475128
loss_pred:0.014269472099840641, decouple_loss:0.001488379668444395
The modified gen p mean: 0.44697532057762146, gen p mean: -0.23810988664627075, mean p set: 0.4475100040435791
loss_pred:0.01353579293936491, decouple_loss:0.0014599313726648688
Iteration: 4792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683513045310974, gen p mean: -0.24175818264484406, mean p set: 0.4473719894886017
loss_pred:0.014379258267581463, decouple_loss:0.0016427318332716823
The modified gen p mean: 0.4469294250011444, gen p mean: -0.2432522028684616, mean p set: 0.44750016927719116The modified gen p mean: 0.4486653804779053, gen p mean: -0.24305762350559235, mean p set: 0.44924843311309814
loss_pred:0.015202509239315987, decouple_loss:0.0017217561835423112
loss_pred:0.014394295401871204, decouple_loss:0.0018146643415093422
Iteration: 4793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447323203086853, gen p mean: -0.24374471604824066, mean p set: 0.44785624742507935
loss_pred:0.013528331182897091, decouple_loss:0.0017356997122988105
The modified gen p mean: 0.4475681483745575, gen p mean: -0.2458386868238449, mean p set: 0.44815176725387573
The modified gen p mean: 0.4460482597351074, gen p mean: -0.24063080549240112, mean p set: 0.4466286599636078
loss_pred:0.013790969736874104, decouple_loss:0.0018715696642175317
loss_pred:0.013941505923867226, decouple_loss:0.0016335720429196954
Iteration: 4794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656169414520264, gen p mean: -0.24154618382453918, mean p set: 0.44709280133247375
loss_pred:0.013819191604852676, decouple_loss:0.001616861904039979
The modified gen p mean: 0.44830867648124695, gen p mean: -0.24260112643241882, mean p set: 0.44887736439704895
The modified gen p mean: 0.4472596347332001, gen p mean: -0.2418581247329712, mean p set: 0.44783279299736023
loss_pred:0.014234750531613827, decouple_loss:0.0015552991535514593
loss_pred:0.014062223955988884, decouple_loss:0.0016333631938323379
Iteration: 4795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44542834162712097, gen p mean: -0.2379724383354187, mean p set: 0.4460061490535736
loss_pred:0.014034239575266838, decouple_loss:0.0015931598609313369
The modified gen p mean: 0.44743812084198, gen p mean: -0.240669384598732, mean p set: 0.4480137526988983
loss_pred:0.013921822421252728, decouple_loss:0.0017009798903018236
The modified gen p mean: 0.4487234950065613, gen p mean: -0.2433021366596222, mean p set: 0.4492546021938324
loss_pred:0.013962586410343647, decouple_loss:0.0018205285305157304
Iteration: 4796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727805256843567, gen p mean: -0.24371187388896942, mean p set: 0.4478478729724884
loss_pred:0.01347118616104126, decouple_loss:0.0014550149207934737
The modified gen p mean: 0.44542935490608215, gen p mean: -0.2407218962907791, mean p set: 0.44600710272789The modified gen p mean: 0.446465402841568, gen p mean: -0.24064451456069946, mean p set: 0.4469926357269287
loss_pred:0.014329138211905956, decouple_loss:0.0014961898559704423
loss_pred:0.014132305979728699, decouple_loss:0.001470025978051126
Iteration: 4797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468804597854614, gen p mean: -0.24022160470485687, mean p set: 0.44745346903800964
loss_pred:0.014606716111302376, decouple_loss:0.0015182706993073225
The modified gen p mean: 0.44604143500328064, gen p mean: -0.24082927405834198, mean p set: 0.4466158449649811The modified gen p mean: 0.446460485458374, gen p mean: -0.2425253540277481, mean p set: 0.4469849467277527
loss_pred:0.013659689575433731, decouple_loss:0.0016802673926576972
loss_pred:0.013797438703477383, decouple_loss:0.0015874095261096954
Iteration: 4798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654154777526855, gen p mean: -0.24717527627944946, mean p set: 0.4471190571784973
loss_pred:0.013422711752355099, decouple_loss:0.0017084941500797868
The modified gen p mean: 0.44747674465179443, gen p mean: -0.24700233340263367, mean p set: 0.448056697845459The modified gen p mean: 0.4468757212162018, gen p mean: -0.24756097793579102, mean p set: 0.44740432500839233
loss_pred:0.013734700158238411, decouple_loss:0.0017649029614403844
loss_pred:0.01370924524962902, decouple_loss:0.0017048718873411417
Iteration: 4799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472961127758026, gen p mean: -0.2436518520116806, mean p set: 0.44787725806236267
loss_pred:0.014649925753474236, decouple_loss:0.001623006071895361
The modified gen p mean: 0.4464661180973053, gen p mean: -0.24191908538341522, mean p set: 0.4470318555831909
loss_pred:0.013852227479219437, decouple_loss:0.0015385174192488194
The modified gen p mean: 0.4491220712661743, gen p mean: -0.24452626705169678, mean p set: 0.44964826107025146
loss_pred:0.014008003287017345, decouple_loss:0.0015110335079953074
Iteration: 4800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704246520996094, gen p mean: -0.2430139183998108, mean p set: 0.44762295484542847
loss_pred:0.013716642744839191, decouple_loss:0.0016350579680874944
The modified gen p mean: 0.4470822513103485, gen p mean: -0.23863738775253296, mean p set: 0.44765836000442505
loss_pred:0.014535997994244099, decouple_loss:0.0017220360459759831
The modified gen p mean: 0.4471912384033203, gen p mean: -0.24140378832817078, mean p set: 0.44771912693977356
loss_pred:0.013826228678226471, decouple_loss:0.0016011830884963274
2023-04-28 00:44:09 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2372771054506302, mean p set: 0.4499112665653229
loss_pred:0.015234313905239105, decouple_loss:0.0016073723090812564
The modified gen p mean: 0.4482687711715698, gen p mean: -0.23486177623271942, mean p set: 0.44879910349845886
loss_pred:0.015139461494982243, decouple_loss:0.0015636016614735126
The modified gen p mean: 0.4492952525615692, gen p mean: -0.23782764375209808, mean p set: 0.4498290419578552
loss_pred:0.014694461598992348, decouple_loss:0.0015599417965859175
WV_1_PC_1_EH_0_PS_30, loss: 0.015101594850420952, avg_mse: 0.022317936643958092
current test mse: 0.022318
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 4801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487714469432831, gen p mean: -0.2429351508617401, mean p set: 0.4493010640144348
loss_pred:0.014737432822585106, decouple_loss:0.0016281562857329845
The modified gen p mean: 0.44935721158981323, gen p mean: -0.2411375790834427, mean p set: 0.449928879737854
loss_pred:0.014706475660204887, decouple_loss:0.0015680278884246945
The modified gen p mean: 0.44844117760658264, gen p mean: -0.2365596443414688, mean p set: 0.44901883602142334
loss_pred:0.013904490508139133, decouple_loss:0.0016414935234934092
Iteration: 4802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490118622779846, gen p mean: -0.2403520792722702, mean p set: 0.4495360851287842
loss_pred:0.014865185134112835, decouple_loss:0.001577823655679822
The modified gen p mean: 0.4472269117832184, gen p mean: -0.23491661250591278, mean p set: 0.4478098452091217
loss_pred:0.01561068370938301, decouple_loss:0.0016270439373329282
The modified gen p mean: 0.44784361124038696, gen p mean: -0.23491983115673065, mean p set: 0.4484219551086426
loss_pred:0.014551098458468914, decouple_loss:0.0014715935103595257
Iteration: 4803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488412141799927, gen p mean: -0.2379877269268036, mean p set: 0.4493670165538788
loss_pred:0.014389030635356903, decouple_loss:0.001729064155369997
The modified gen p mean: 0.44829657673835754, gen p mean: -0.24150048196315765, mean p set: 0.4488733410835266
loss_pred:0.014781510457396507, decouple_loss:0.0018095847917720675
The modified gen p mean: 0.44888412952423096, gen p mean: -0.2376822680234909, mean p set: 0.4494534134864807
loss_pred:0.01423175074160099, decouple_loss:0.0018348476151004434
Iteration: 4804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449041485786438, gen p mean: -0.2407943159341812, mean p set: 0.44956550002098083
loss_pred:0.014673789031803608, decouple_loss:0.0018017229158431292
The modified gen p mean: 0.44893959164619446, gen p mean: -0.2417207956314087, mean p set: 0.44951972365379333
loss_pred:0.01444108597934246, decouple_loss:0.0016306017059832811
The modified gen p mean: 0.44831782579421997, gen p mean: -0.24107670783996582, mean p set: 0.4488937258720398
loss_pred:0.015239724889397621, decouple_loss:0.0016908481484279037
Iteration: 4805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478839635848999, gen p mean: -0.24119991064071655, mean p set: 0.44845834374427795
loss_pred:0.014390354044735432, decouple_loss:0.0022491218987852335
The modified gen p mean: 0.44783762097358704, gen p mean: -0.2398546189069748, mean p set: 0.44836896657943726The modified gen p mean: 0.4484666585922241, gen p mean: -0.24350835382938385, mean p set: 0.4490435719490051
loss_pred:0.014362282119691372, decouple_loss:0.0021698118653148413
loss_pred:0.015070782043039799, decouple_loss:0.002390957437455654
Iteration: 4806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859257340431213, gen p mean: -0.24078749120235443, mean p set: 0.4491669833660126
loss_pred:0.014293930493295193, decouple_loss:0.0017321896739304066
The modified gen p mean: 0.4477797746658325, gen p mean: -0.23391856253147125, mean p set: 0.44830653071403503The modified gen p mean: 0.4493895471096039, gen p mean: -0.24395087361335754, mean p set: 0.4499637186527252
loss_pred:0.014333488419651985, decouple_loss:0.0018831458874046803
loss_pred:0.014322842471301556, decouple_loss:0.0017707381630316377
Iteration: 4807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488581717014313, gen p mean: -0.24478545784950256, mean p set: 0.4494372606277466
loss_pred:0.01423315517604351, decouple_loss:0.0018603955395519733
The modified gen p mean: 0.4485892057418823, gen p mean: -0.23726172745227814, mean p set: 0.44911903142929077The modified gen p mean: 0.449061781167984, gen p mean: -0.24338299036026, mean p set: 0.4496401250362396
loss_pred:0.014733277261257172, decouple_loss:0.002007915638387203
loss_pred:0.014428234659135342, decouple_loss:0.0019446943188086152
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937410950660706, gen p mean: -0.23891305923461914, mean p set: 0.4499538242816925
loss_pred:0.014410516247153282, decouple_loss:0.0018718537176027894
The modified gen p mean: 0.4488926827907562, gen p mean: -0.23982581496238708, mean p set: 0.4494735598564148
loss_pred:0.014353073202073574, decouple_loss:0.0018617998575791717
The modified gen p mean: 0.44746631383895874, gen p mean: -0.2407035082578659, mean p set: 0.4480001628398895
loss_pred:0.015208573080599308, decouple_loss:0.0018469609785825014
Iteration: 4809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906020164489746, gen p mean: -0.24391262233257294, mean p set: 0.4496367573738098
loss_pred:0.014297735877335072, decouple_loss:0.002122230362147093
The modified gen p mean: 0.4486023485660553, gen p mean: -0.23846057057380676, mean p set: 0.44917774200439453
loss_pred:0.014762591570615768, decouple_loss:0.0017835117178037763
The modified gen p mean: 0.4491059482097626, gen p mean: -0.23874402046203613, mean p set: 0.4496358335018158
loss_pred:0.014532288536429405, decouple_loss:0.0018625068478286266
Iteration: 4810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915255904197693, gen p mean: -0.24071753025054932, mean p set: 0.44972550868988037
loss_pred:0.014280437491834164, decouple_loss:0.0017036760691553354
The modified gen p mean: 0.44886186718940735, gen p mean: -0.2359810173511505, mean p set: 0.4494384229183197
loss_pred:0.013873840682208538, decouple_loss:0.0017433689208701253
The modified gen p mean: 0.44815313816070557, gen p mean: -0.23832832276821136, mean p set: 0.4486786425113678
loss_pred:0.0152139188721776, decouple_loss:0.0016383744077757
2023-04-28 00:48:18 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2409527748823166, mean p set: 0.4499112665653229
loss_pred:0.015192870050668716, decouple_loss:0.001881869975477457
The modified gen p mean: 0.4482675790786743, gen p mean: -0.23849494755268097, mean p set: 0.44879910349845886
The modified gen p mean: 0.4493080973625183, gen p mean: -0.2413184493780136, mean p set: 0.4498290419578552
loss_pred:0.01505565457046032, decouple_loss:0.0018288500141352415
loss_pred:0.014687970280647278, decouple_loss:0.0018639755435287952
WV_1_PC_1_EH_0_PS_30, loss: 0.015071744099259377, avg_mse: 0.02224094048142433
current test mse: 0.022241
Iteration: 4811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486701488494873, gen p mean: -0.24101579189300537, mean p set: 0.44925159215927124
loss_pred:0.014275680296123028, decouple_loss:0.001739118597470224
The modified gen p mean: 0.44744735956192017, gen p mean: -0.24348211288452148, mean p set: 0.4480241537094116
loss_pred:0.014915489591658115, decouple_loss:0.0016728154150769114
The modified gen p mean: 0.44898995757102966, gen p mean: -0.24166399240493774, mean p set: 0.44951876997947693
loss_pred:0.014427060261368752, decouple_loss:0.0016611474566161633
Iteration: 4812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488975703716278, gen p mean: -0.24600467085838318, mean p set: 0.44942986965179443
loss_pred:0.014338387176394463, decouple_loss:0.001521859783679247
The modified gen p mean: 0.4481019079685211, gen p mean: -0.24418918788433075, mean p set: 0.4486761689186096
loss_pred:0.014613972045481205, decouple_loss:0.001474679564125836
The modified gen p mean: 0.44769611954689026, gen p mean: -0.2420826107263565, mean p set: 0.4482733905315399
loss_pred:0.014694145880639553, decouple_loss:0.0014640577137470245
Iteration: 4813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856753945350647, gen p mean: -0.2452523559331894, mean p set: 0.4491029977798462
loss_pred:0.014660390093922615, decouple_loss:0.0018413674551993608
The modified gen p mean: 0.4482910633087158, gen p mean: -0.24693626165390015, mean p set: 0.4488653242588043
loss_pred:0.014585341326892376, decouple_loss:0.0018920500297099352
The modified gen p mean: 0.4494752883911133, gen p mean: -0.2450585961341858, mean p set: 0.45005539059638977
loss_pred:0.0141347236931324, decouple_loss:0.00169960071798414
Iteration: 4814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475004971027374, gen p mean: -0.23380859196186066, mean p set: 0.4480302929878235
loss_pred:0.014691597782075405, decouple_loss:0.0016510281711816788
The modified gen p mean: 0.44868919253349304, gen p mean: -0.24197621643543243, mean p set: 0.4492647647857666
loss_pred:0.014288104139268398, decouple_loss:0.0016865187790244818
The modified gen p mean: 0.4481848478317261, gen p mean: -0.2409786731004715, mean p set: 0.4487597644329071
loss_pred:0.014383756555616856, decouple_loss:0.0015225340612232685
Iteration: 4815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44942712783813477, gen p mean: -0.24773024022579193, mean p set: 0.4500062167644501
loss_pred:0.014367359690368176, decouple_loss:0.0016503308434039354
The modified gen p mean: 0.4493754208087921, gen p mean: -0.24790562689304352, mean p set: 0.4498986005783081The modified gen p mean: 0.4491935670375824, gen p mean: -0.24106207489967346, mean p set: 0.4497752785682678
loss_pred:0.01393434964120388, decouple_loss:0.0016812625108286738
loss_pred:0.014671931974589825, decouple_loss:0.001496979151852429
Iteration: 4816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800278544425964, gen p mean: -0.24286431074142456, mean p set: 0.448577344417572
loss_pred:0.014341042377054691, decouple_loss:0.0017410528380423784
The modified gen p mean: 0.44811713695526123, gen p mean: -0.2352592498064041, mean p set: 0.4486406445503235The modified gen p mean: 0.44929391145706177, gen p mean: -0.24382464587688446, mean p set: 0.4498666524887085
loss_pred:0.014662490226328373, decouple_loss:0.0016296782996505499
loss_pred:0.015069677494466305, decouple_loss:0.0017321752384305
Iteration: 4817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928061962127686, gen p mean: -0.2442689836025238, mean p set: 0.4498598277568817
loss_pred:0.014208326116204262, decouple_loss:0.001696932129561901
The modified gen p mean: 0.44934678077697754, gen p mean: -0.24610044062137604, mean p set: 0.4498789310455322The modified gen p mean: 0.44889596104621887, gen p mean: -0.24023288488388062, mean p set: 0.44947290420532227
loss_pred:0.014165010303258896, decouple_loss:0.0015453895321115851
loss_pred:0.014379122294485569, decouple_loss:0.001809766748920083
Iteration: 4818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490198791027069, gen p mean: -0.24410587549209595, mean p set: 0.4495936930179596
loss_pred:0.01410332228988409, decouple_loss:0.0017855283804237843
The modified gen p mean: 0.4488108456134796, gen p mean: -0.24208681285381317, mean p set: 0.44934189319610596The modified gen p mean: 0.4483637511730194, gen p mean: -0.24359694123268127, mean p set: 0.4489397704601288
loss_pred:0.014040198177099228, decouple_loss:0.0019292475190013647
loss_pred:0.014388029463589191, decouple_loss:0.0017164127202704549
Iteration: 4819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480353891849518, gen p mean: -0.24609023332595825, mean p set: 0.44861117005348206
loss_pred:0.014529225416481495, decouple_loss:0.0018407761817798018
The modified gen p mean: 0.4479144513607025, gen p mean: -0.23767034709453583, mean p set: 0.448492169380188
loss_pred:0.014834372326731682, decouple_loss:0.0018669584533199668
The modified gen p mean: 0.4484795331954956, gen p mean: -0.24053551256656647, mean p set: 0.4490050673484802
loss_pred:0.01485165674239397, decouple_loss:0.0020453711040318012
Iteration: 4820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480833411216736, gen p mean: -0.24264921247959137, mean p set: 0.4486114978790283
loss_pred:0.014949651435017586, decouple_loss:0.0018726370763033628
The modified gen p mean: 0.4478785991668701, gen p mean: -0.239924356341362, mean p set: 0.4484536051750183The modified gen p mean: 0.44772204756736755, gen p mean: -0.24166586995124817, mean p set: 0.4483001232147217
loss_pred:0.014815730042755604, decouple_loss:0.0020063952542841434
loss_pred:0.014646136201918125, decouple_loss:0.001912074745632708
2023-04-28 00:51:42 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2410924732685089, mean p set: 0.4499112665653229
loss_pred:0.01517420168966055, decouple_loss:0.0017531440826132894
The modified gen p mean: 0.44827231764793396, gen p mean: -0.23859566450119019, mean p set: 0.44879910349845886
The modified gen p mean: 0.44929343461990356, gen p mean: -0.24110519886016846, mean p set: 0.4498290419578552
loss_pred:0.015067643485963345, decouple_loss:0.0018247559200972319
loss_pred:0.014674961566925049, decouple_loss:0.0018580291653051972
WV_1_PC_1_EH_0_PS_30, loss: 0.015062867663800716, avg_mse: 0.022212157025933266
current test mse: 0.022212
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 4821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806480407714844, gen p mean: -0.2316078543663025, mean p set: 0.4485895335674286
loss_pred:0.01361332181841135, decouple_loss:0.0020063291303813457
The modified gen p mean: 0.4476304352283478, gen p mean: -0.24063348770141602, mean p set: 0.44820713996887207
loss_pred:0.01449671946465969, decouple_loss:0.0017785154050216079
The modified gen p mean: 0.4485621750354767, gen p mean: -0.24331414699554443, mean p set: 0.449137419462204
loss_pred:0.013968068175017834, decouple_loss:0.0018557790899649262
Iteration: 4822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495340883731842, gen p mean: -0.24447020888328552, mean p set: 0.4500616788864136
loss_pred:0.014052876271307468, decouple_loss:0.0017781793139874935
The modified gen p mean: 0.4496926963329315, gen p mean: -0.24138224124908447, mean p set: 0.4502703547477722
loss_pred:0.014312881976366043, decouple_loss:0.0017525621224194765
The modified gen p mean: 0.4490244388580322, gen p mean: -0.24432498216629028, mean p set: 0.4495994448661804
loss_pred:0.014236671850085258, decouple_loss:0.0018570300890132785
Iteration: 4823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487958252429962, gen p mean: -0.24275365471839905, mean p set: 0.44932347536087036
loss_pred:0.013851466588675976, decouple_loss:0.001657955814152956
The modified gen p mean: 0.44888606667518616, gen p mean: -0.24395236372947693, mean p set: 0.44945788383483887
loss_pred:0.013755664229393005, decouple_loss:0.0016948074335232377
The modified gen p mean: 0.44843053817749023, gen p mean: -0.24054816365242004, mean p set: 0.44900989532470703
loss_pred:0.014168714173138142, decouple_loss:0.0018997308798134327
Iteration: 4824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480891525745392, gen p mean: -0.24544957280158997, mean p set: 0.44861605763435364
loss_pred:0.013927399180829525, decouple_loss:0.0018111031968146563
The modified gen p mean: 0.4483813941478729, gen p mean: -0.24766755104064941, mean p set: 0.44896194338798523
loss_pred:0.014428095892071724, decouple_loss:0.0016980767250061035
The modified gen p mean: 0.4493027925491333, gen p mean: -0.24587857723236084, mean p set: 0.44987955689430237
loss_pred:0.013976250775158405, decouple_loss:0.00167534698266536
Iteration: 4825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45015621185302734, gen p mean: -0.24089907109737396, mean p set: 0.450682133436203
loss_pred:0.013907723128795624, decouple_loss:0.002001591259613633
The modified gen p mean: 0.4491097927093506, gen p mean: -0.24155832827091217, mean p set: 0.449687123298645
loss_pred:0.014610100537538528, decouple_loss:0.001739395665936172
The modified gen p mean: 0.4487304091453552, gen p mean: -0.24368777871131897, mean p set: 0.44930922985076904
loss_pred:0.013793712481856346, decouple_loss:0.0020525429863482714
Iteration: 4826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969382882118225, gen p mean: -0.2347480058670044, mean p set: 0.45022737979888916
loss_pred:0.01412801630795002, decouple_loss:0.0019136897753924131
The modified gen p mean: 0.44926396012306213, gen p mean: -0.241388738155365, mean p set: 0.44983842968940735
loss_pred:0.014218274503946304, decouple_loss:0.001843779580667615
The modified gen p mean: 0.44938191771507263, gen p mean: -0.2356870323419571, mean p set: 0.4499533474445343
loss_pred:0.013786339201033115, decouple_loss:0.0019618654623627663
Iteration: 4827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972431659698486, gen p mean: -0.2305145263671875, mean p set: 0.45029905438423157
loss_pred:0.013958454132080078, decouple_loss:0.001683595241047442
The modified gen p mean: 0.44752955436706543, gen p mean: -0.2324582040309906, mean p set: 0.448056697845459The modified gen p mean: 0.44844892621040344, gen p mean: -0.2381211221218109, mean p set: 0.44902855157852173
loss_pred:0.014328244142234325, decouple_loss:0.0016563715180382133
loss_pred:0.013581651262938976, decouple_loss:0.0017340312479063869
Iteration: 4828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830191135406494, gen p mean: -0.2277887612581253, mean p set: 0.44888070225715637
loss_pred:0.013571765273809433, decouple_loss:0.001901746029034257
The modified gen p mean: 0.44988444447517395, gen p mean: -0.23409004509449005, mean p set: 0.45046207308769226
loss_pred:0.013540648855268955, decouple_loss:0.0020048385486006737
The modified gen p mean: 0.4487070143222809, gen p mean: -0.22790513932704926, mean p set: 0.4492368996143341
loss_pred:0.013737567700445652, decouple_loss:0.0019353909883648157
Iteration: 4829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487851560115814, gen p mean: -0.24153806269168854, mean p set: 0.44936034083366394
loss_pred:0.013765042647719383, decouple_loss:0.0020347093231976032
The modified gen p mean: 0.4475455582141876, gen p mean: -0.24133813381195068, mean p set: 0.4481198489665985
loss_pred:0.013674558140337467, decouple_loss:0.0016473188297823071
The modified gen p mean: 0.4492262601852417, gen p mean: -0.2406695932149887, mean p set: 0.44975459575653076
loss_pred:0.013648944906890392, decouple_loss:0.0018876517424359918
Iteration: 4830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480152726173401, gen p mean: -0.23979339003562927, mean p set: 0.4485909342765808
loss_pred:0.014426079578697681, decouple_loss:0.001910078921355307
The modified gen p mean: 0.44929128885269165, gen p mean: -0.23745323717594147, mean p set: 0.4498685300350189
loss_pred:0.014132199808955193, decouple_loss:0.002146631944924593
The modified gen p mean: 0.44810277223587036, gen p mean: -0.23842641711235046, mean p set: 0.448634535074234
loss_pred:0.013791592791676521, decouple_loss:0.0020867965649813414
2023-04-28 00:55:45 testing...
The modified gen p mean: 0.44827353954315186, gen p mean: -0.23896905779838562, mean p set: 0.44879910349845886
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2418368011713028, mean p set: 0.4499112665653229
loss_pred:0.015236138366162777, decouple_loss:0.0018554225098341703
loss_pred:0.01534314826130867, decouple_loss:0.0019214802887290716
The modified gen p mean: 0.4493027925491333, gen p mean: -0.24189406633377075, mean p set: 0.4498290419578552
loss_pred:0.014808764681220055, decouple_loss:0.001925332355313003
WV_1_PC_1_EH_0_PS_30, loss: 0.015224387869238853, avg_mse: 0.022543102502822876
current test mse: 0.022543
Iteration: 4831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656985998153687, gen p mean: -0.24285739660263062, mean p set: 0.44710251688957214
loss_pred:0.013765941374003887, decouple_loss:0.001778334379196167
The modified gen p mean: 0.44787079095840454, gen p mean: -0.23623475432395935, mean p set: 0.44844722747802734
loss_pred:0.014336145482957363, decouple_loss:0.0016488871769979596
The modified gen p mean: 0.4493468999862671, gen p mean: -0.23314706981182098, mean p set: 0.4499235153198242
loss_pred:0.014076345600187778, decouple_loss:0.0017906043212860823
Iteration: 4832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903016090393066, gen p mean: -0.24274368584156036, mean p set: 0.4495595097541809
loss_pred:0.013811848126351833, decouple_loss:0.0023766958620399237
The modified gen p mean: 0.4498056471347809, gen p mean: -0.24099673330783844, mean p set: 0.4503842294216156
The modified gen p mean: 0.4503006041049957, gen p mean: -0.23636820912361145, mean p set: 0.4508882462978363
loss_pred:0.013960047625005245, decouple_loss:0.002124811289831996
loss_pred:0.013717662543058395, decouple_loss:0.0022634149063378572
Iteration: 4833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881629943847656, gen p mean: -0.24625277519226074, mean p set: 0.4493459463119507
loss_pred:0.014333456754684448, decouple_loss:0.0019517602631822228
The modified gen p mean: 0.44906505942344666, gen p mean: -0.23924623429775238, mean p set: 0.44964301586151123
The modified gen p mean: 0.45006245374679565, gen p mean: -0.2370356172323227, mean p set: 0.4506332576274872
loss_pred:0.014259823597967625, decouple_loss:0.0017727123340591788
loss_pred:0.013368510641157627, decouple_loss:0.0019480402115732431
Iteration: 4834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477991461753845, gen p mean: -0.2354496270418167, mean p set: 0.44837456941604614
loss_pred:0.013947811909019947, decouple_loss:0.0019664024002850056
The modified gen p mean: 0.4490147829055786, gen p mean: -0.2416037768125534, mean p set: 0.44958946108818054The modified gen p mean: 0.44865307211875916, gen p mean: -0.24175786972045898, mean p set: 0.44917967915534973
loss_pred:0.013719890266656876, decouple_loss:0.0019230773905292153
loss_pred:0.013652684167027473, decouple_loss:0.0019415959250181913
Iteration: 4835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476304352283478, gen p mean: -0.2393459528684616, mean p set: 0.44820865988731384
loss_pred:0.014030401594936848, decouple_loss:0.0018722325330600142
The modified gen p mean: 0.4483599364757538, gen p mean: -0.23825675249099731, mean p set: 0.448943167924881
loss_pred:0.013843872584402561, decouple_loss:0.001880462164990604
The modified gen p mean: 0.44834089279174805, gen p mean: -0.2459755539894104, mean p set: 0.4488680362701416
loss_pred:0.013426538556814194, decouple_loss:0.0022656831424683332
Iteration: 4836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477940499782562, gen p mean: -0.23768062889575958, mean p set: 0.4483669102191925
loss_pred:0.013757696375250816, decouple_loss:0.0017423524986952543
The modified gen p mean: 0.4484565258026123, gen p mean: -0.24408818781375885, mean p set: 0.44898566603660583The modified gen p mean: 0.4471513032913208, gen p mean: -0.23881882429122925, mean p set: 0.4477255642414093
loss_pred:0.013512049801647663, decouple_loss:0.0018933884566649795
loss_pred:0.013718914240598679, decouple_loss:0.0017876951023936272
Iteration: 4837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448924720287323, gen p mean: -0.24166598916053772, mean p set: 0.44949984550476074
loss_pred:0.01393824815750122, decouple_loss:0.00185681926086545
The modified gen p mean: 0.4486495554447174, gen p mean: -0.24200661480426788, mean p set: 0.4492279887199402
loss_pred:0.013446703553199768, decouple_loss:0.0019833033438771963
The modified gen p mean: 0.44931378960609436, gen p mean: -0.24174483120441437, mean p set: 0.4498407244682312
loss_pred:0.013723433017730713, decouple_loss:0.0019070322159677744
Iteration: 4838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639652967453003, gen p mean: -0.2448691874742508, mean p set: 0.4469698667526245
loss_pred:0.013576537370681763, decouple_loss:0.001720809144899249
The modified gen p mean: 0.44805335998535156, gen p mean: -0.23826365172863007, mean p set: 0.4485769271850586The modified gen p mean: 0.4472896158695221, gen p mean: -0.24646711349487305, mean p set: 0.4478663504123688
loss_pred:0.013619874604046345, decouple_loss:0.001786780427210033
loss_pred:0.01356715988367796, decouple_loss:0.0017588863847777247
Iteration: 4839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005500316619873, gen p mean: -0.23630192875862122, mean p set: 0.45063140988349915
loss_pred:0.01376327220350504, decouple_loss:0.0017310522962361574
The modified gen p mean: 0.4484635293483734, gen p mean: -0.24622689187526703, mean p set: 0.44904085993766785
loss_pred:0.013455451466143131, decouple_loss:0.001612271647900343
The modified gen p mean: 0.44782060384750366, gen p mean: -0.2367023080587387, mean p set: 0.4483490288257599
loss_pred:0.013632255606353283, decouple_loss:0.0016314174281433225
Iteration: 4840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44942763447761536, gen p mean: -0.24468468129634857, mean p set: 0.4500042200088501
loss_pred:0.014031043276190758, decouple_loss:0.0016175571363419294
The modified gen p mean: 0.44904330372810364, gen p mean: -0.24156194925308228, mean p set: 0.4496126174926758
loss_pred:0.013425984419882298, decouple_loss:0.0016702435677871108
The modified gen p mean: 0.44876331090927124, gen p mean: -0.24003556370735168, mean p set: 0.449288934469223
loss_pred:0.013937805779278278, decouple_loss:0.0015143612399697304
2023-04-28 00:59:09 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23912085592746735, mean p set: 0.4499112665653229
loss_pred:0.015331532806158066, decouple_loss:0.0019183901604264975
The modified gen p mean: 0.4482710063457489, gen p mean: -0.23607642948627472, mean p set: 0.44879910349845886
The modified gen p mean: 0.44929805397987366, gen p mean: -0.23907916247844696, mean p set: 0.4498290419578552
loss_pred:0.01522876787930727, decouple_loss:0.0019774953834712505
loss_pred:0.01483540702611208, decouple_loss:0.0019512707367539406
WV_1_PC_1_EH_0_PS_30, loss: 0.015229355543851852, avg_mse: 0.022534413263201714
current test mse: 0.022534
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 4841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471532106399536, gen p mean: -0.2417171448469162, mean p set: 0.44768041372299194
loss_pred:0.014177825301885605, decouple_loss:0.0019437327282503247
The modified gen p mean: 0.4475065767765045, gen p mean: -0.23778901994228363, mean p set: 0.44807714223861694
loss_pred:0.014882727526128292, decouple_loss:0.0019602435640990734
The modified gen p mean: 0.44714221358299255, gen p mean: -0.24080170691013336, mean p set: 0.44771143794059753
loss_pred:0.014939661137759686, decouple_loss:0.0018729671137407422
Iteration: 4842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477183520793915, gen p mean: -0.24616749584674835, mean p set: 0.4482428729534149
loss_pred:0.014628930948674679, decouple_loss:0.0020348047837615013
The modified gen p mean: 0.4475230872631073, gen p mean: -0.23933234810829163, mean p set: 0.4481000304222107The modified gen p mean: 0.4470881521701813, gen p mean: -0.2385438084602356, mean p set: 0.4476645588874817
loss_pred:0.014932792633771896, decouple_loss:0.0017862009117379785
loss_pred:0.014904404990375042, decouple_loss:0.00167754793073982
Iteration: 4843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769448041915894, gen p mean: -0.24091264605522156, mean p set: 0.4482216238975525
loss_pred:0.015359053388237953, decouple_loss:0.0015820403350517154
The modified gen p mean: 0.4470794200897217, gen p mean: -0.2399834841489792, mean p set: 0.4476606547832489The modified gen p mean: 0.4480398893356323, gen p mean: -0.2467322200536728, mean p set: 0.4486217796802521
loss_pred:0.015025230124592781, decouple_loss:0.0015254118479788303
loss_pred:0.014453583396971226, decouple_loss:0.0017172786174342036
Iteration: 4844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761785864830017, gen p mean: -0.2436944842338562, mean p set: 0.4481448233127594
loss_pred:0.014795340597629547, decouple_loss:0.0017149655614048243
The modified gen p mean: 0.4474382996559143, gen p mean: -0.24064598977565765, mean p set: 0.4480176270008087
loss_pred:0.014917315915226936, decouple_loss:0.001845514983870089
The modified gen p mean: 0.4472227692604065, gen p mean: -0.24128881096839905, mean p set: 0.4478038251399994
loss_pred:0.014735549688339233, decouple_loss:0.001853588386438787
Iteration: 4845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477168917655945, gen p mean: -0.24699589610099792, mean p set: 0.44824355840682983
loss_pred:0.014995290897786617, decouple_loss:0.0016543039819225669
The modified gen p mean: 0.44667381048202515, gen p mean: -0.24164758622646332, mean p set: 0.44725102186203003The modified gen p mean: 0.44671934843063354, gen p mean: -0.24394269287586212, mean p set: 0.44729599356651306
loss_pred:0.01420709677040577, decouple_loss:0.0018764210399240255loss_pred:0.014001388102769852, decouple_loss:0.0017270924290642142
Iteration: 4846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791677594184875, gen p mean: -0.24830925464630127, mean p set: 0.44848695397377014
loss_pred:0.014526822604238987, decouple_loss:0.0016594799235463142
The modified gen p mean: 0.4471006989479065, gen p mean: -0.24863436818122864, mean p set: 0.44767072796821594The modified gen p mean: 0.4474426507949829, gen p mean: -0.2434595674276352, mean p set: 0.4479702413082123
loss_pred:0.015482407063245773, decouple_loss:0.0017650412628427148
loss_pred:0.014674725942313671, decouple_loss:0.0018895501270890236
Iteration: 4847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475679099559784, gen p mean: -0.24170254170894623, mean p set: 0.4481445848941803
The modified gen p mean: 0.44749075174331665, gen p mean: -0.24692004919052124, mean p set: 0.44806763529777527
loss_pred:0.014407848007977009, decouple_loss:0.001806482090614736
loss_pred:0.014364281669259071, decouple_loss:0.0018094447441399097
The modified gen p mean: 0.4464971721172333, gen p mean: -0.24450215697288513, mean p set: 0.44702383875846863
loss_pred:0.014537892304360867, decouple_loss:0.0017192733939737082
Iteration: 4848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752025604248047, gen p mean: -0.2417551875114441, mean p set: 0.4480897784233093
loss_pred:0.014669038355350494, decouple_loss:0.0017366920365020633
The modified gen p mean: 0.44724711775779724, gen p mean: -0.23992450535297394, mean p set: 0.44781771302223206
loss_pred:0.015135116875171661, decouple_loss:0.001730610034428537
The modified gen p mean: 0.44747957587242126, gen p mean: -0.247463658452034, mean p set: 0.4480067491531372
loss_pred:0.014848779886960983, decouple_loss:0.0016178779769688845
Iteration: 4849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473458528518677, gen p mean: -0.24540847539901733, mean p set: 0.44792598485946655
loss_pred:0.014756633900105953, decouple_loss:0.0015676775947213173
The modified gen p mean: 0.44725751876831055, gen p mean: -0.24282917380332947, mean p set: 0.44783589243888855
loss_pred:0.01415977906435728, decouple_loss:0.0015392773784697056
The modified gen p mean: 0.4468713700771332, gen p mean: -0.2458861917257309, mean p set: 0.44739648699760437
loss_pred:0.015249012038111687, decouple_loss:0.0017553875222802162
Iteration: 4850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762516021728516, gen p mean: -0.2423567771911621, mean p set: 0.44820162653923035
The modified gen p mean: 0.44591790437698364, gen p mean: -0.23966163396835327, mean p set: 0.44649389386177063
loss_pred:0.015050554648041725, decouple_loss:0.0019120504148304462
loss_pred:0.013968173414468765, decouple_loss:0.0017407442210242152
The modified gen p mean: 0.4472467005252838, gen p mean: -0.24166367948055267, mean p set: 0.4477778375148773
loss_pred:0.014261242002248764, decouple_loss:0.001682506175711751
2023-04-28 01:03:22 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24130688607692719, mean p set: 0.4499112665653229
loss_pred:0.015247500501573086, decouple_loss:0.0016309017082676291
The modified gen p mean: 0.4482697546482086, gen p mean: -0.23846223950386047, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930413365364075, gen p mean: -0.24153921008110046, mean p set: 0.4498290419578552
loss_pred:0.015116735361516476, decouple_loss:0.0016680487897247076
loss_pred:0.014765267260372639, decouple_loss:0.0016366099007427692
WV_1_PC_1_EH_0_PS_30, loss: 0.015125427395105362, avg_mse: 0.022353410720825195
current test mse: 0.022353
Iteration: 4851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472919702529907, gen p mean: -0.23585477471351624, mean p set: 0.4478713572025299
loss_pred:0.015146495774388313, decouple_loss:0.001590056112036109
The modified gen p mean: 0.4471713900566101, gen p mean: -0.24351586401462555, mean p set: 0.44774720072746277
loss_pred:0.014092992059886456, decouple_loss:0.0015579366590827703
The modified gen p mean: 0.44697654247283936, gen p mean: -0.23921158909797668, mean p set: 0.44749921560287476
loss_pred:0.014698881655931473, decouple_loss:0.0016390727832913399
Iteration: 4852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774770736694336, gen p mean: -0.24566303193569183, mean p set: 0.4482708275318146
loss_pred:0.015215902589261532, decouple_loss:0.0016322719166055322
The modified gen p mean: 0.4474560022354126, gen p mean: -0.2396460473537445, mean p set: 0.4480361342430115
loss_pred:0.014744522981345654, decouple_loss:0.0016350126825273037
The modified gen p mean: 0.44709715247154236, gen p mean: -0.24038518965244293, mean p set: 0.44767072796821594
loss_pred:0.015003317967057228, decouple_loss:0.0016631648177281022
Iteration: 4853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470527172088623, gen p mean: -0.24841317534446716, mean p set: 0.44758090376853943
loss_pred:0.014520781114697456, decouple_loss:0.001617617323063314
The modified gen p mean: 0.44618475437164307, gen p mean: -0.24103419482707977, mean p set: 0.4467572569847107
loss_pred:0.013932980597019196, decouple_loss:0.0014439235674217343
The modified gen p mean: 0.4479408264160156, gen p mean: -0.2458367943763733, mean p set: 0.4485156238079071
loss_pred:0.013991323299705982, decouple_loss:0.001631521387025714
Iteration: 4854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471051096916199, gen p mean: -0.24265605211257935, mean p set: 0.44763314723968506
loss_pred:0.015176469460129738, decouple_loss:0.0018267770064994693
The modified gen p mean: 0.4477580189704895, gen p mean: -0.24097628891468048, mean p set: 0.44833505153656006
loss_pred:0.014926954172551632, decouple_loss:0.001768547692336142
The modified gen p mean: 0.4480380117893219, gen p mean: -0.2407243698835373, mean p set: 0.4486115872859955
loss_pred:0.01473762933164835, decouple_loss:0.00179948634468019
Iteration: 4855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485015273094177, gen p mean: -0.24161477386951447, mean p set: 0.4490697383880615
loss_pred:0.014139480888843536, decouple_loss:0.001980811357498169
The modified gen p mean: 0.44849398732185364, gen p mean: -0.23894721269607544, mean p set: 0.4490669369697571The modified gen p mean: 0.44660434126853943, gen p mean: -0.2392260730266571, mean p set: 0.44713303446769714
loss_pred:0.014417346566915512, decouple_loss:0.0020143152214586735
loss_pred:0.013987202197313309, decouple_loss:0.001868569408543408
Iteration: 4856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739091396331787, gen p mean: -0.232567697763443, mean p set: 0.4479668438434601
loss_pred:0.01520630531013012, decouple_loss:0.0016801712336018682
The modified gen p mean: 0.44736409187316895, gen p mean: -0.23627138137817383, mean p set: 0.44793930649757385The modified gen p mean: 0.4482780992984772, gen p mean: -0.2361169308423996, mean p set: 0.4488099217414856
loss_pred:0.0150334183126688, decouple_loss:0.001678310101851821
loss_pred:0.01501880306750536, decouple_loss:0.0016480993945151567
Iteration: 4857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781118631362915, gen p mean: -0.23414328694343567, mean p set: 0.4483889639377594
loss_pred:0.014780520461499691, decouple_loss:0.0015307863941416144
The modified gen p mean: 0.4462652802467346, gen p mean: -0.23688115179538727, mean p set: 0.44678664207458496
loss_pred:0.014262228272855282, decouple_loss:0.0014997479738667607
The modified gen p mean: 0.44719839096069336, gen p mean: -0.2352907806634903, mean p set: 0.44777771830558777
loss_pred:0.014909964054822922, decouple_loss:0.0015902533195912838
Iteration: 4858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474329948425293, gen p mean: -0.2430313676595688, mean p set: 0.4480043649673462
loss_pred:0.015221861191093922, decouple_loss:0.0018421526765450835
The modified gen p mean: 0.4470263123512268, gen p mean: -0.23604334890842438, mean p set: 0.4475988745689392
loss_pred:0.014429934322834015, decouple_loss:0.0016683719586580992
The modified gen p mean: 0.44692540168762207, gen p mean: -0.24013152718544006, mean p set: 0.447443425655365
loss_pred:0.01437334343791008, decouple_loss:0.0015950041124597192
Iteration: 4859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475400447845459, gen p mean: -0.23954220116138458, mean p set: 0.4481123387813568
loss_pred:0.014215906150639057, decouple_loss:0.0016082715010270476
The modified gen p mean: 0.4469812214374542, gen p mean: -0.23654775321483612, mean p set: 0.44755926728248596
loss_pred:0.015335708856582642, decouple_loss:0.0015810448676347733
The modified gen p mean: 0.44748276472091675, gen p mean: -0.24513840675354004, mean p set: 0.44800713658332825
loss_pred:0.014299758709967136, decouple_loss:0.001590031199157238
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771677255630493, gen p mean: -0.24883396923542023, mean p set: 0.4482952058315277
loss_pred:0.01448404137045145, decouple_loss:0.0016480636550113559
The modified gen p mean: 0.44688042998313904, gen p mean: -0.24051181972026825, mean p set: 0.4474641680717468
loss_pred:0.015295693650841713, decouple_loss:0.0015987447695806623
The modified gen p mean: 0.44753432273864746, gen p mean: -0.24629338085651398, mean p set: 0.4480603337287903
loss_pred:0.014639011584222317, decouple_loss:0.0017228771466761827
2023-04-28 01:06:46 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23977607488632202, mean p set: 0.4499112665653229
loss_pred:0.015207753516733646, decouple_loss:0.0017107445746660233
The modified gen p mean: 0.44826725125312805, gen p mean: -0.2373165637254715, mean p set: 0.44879910349845886
loss_pred:0.015106191858649254, decouple_loss:0.0015794530045241117
The modified gen p mean: 0.4493029713630676, gen p mean: -0.24037110805511475, mean p set: 0.4498290419578552
loss_pred:0.014796842820942402, decouple_loss:0.0015995892463251948
WV_1_PC_1_EH_0_PS_30, loss: 0.015118425711989403, avg_mse: 0.022382192313671112
current test mse: 0.022382
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 4861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496493339538574, gen p mean: -0.23734699189662933, mean p set: 0.4501778185367584
loss_pred:0.013955225236713886, decouple_loss:0.0017545523587614298
The modified gen p mean: 0.4489823281764984, gen p mean: -0.24672606587409973, mean p set: 0.4495563805103302
loss_pred:0.014087626710534096, decouple_loss:0.0017707337392494082
The modified gen p mean: 0.45031774044036865, gen p mean: -0.24040549993515015, mean p set: 0.4508989155292511
loss_pred:0.01320503931492567, decouple_loss:0.0022218788508325815
Iteration: 4862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503949284553528, gen p mean: -0.24005663394927979, mean p set: 0.45092666149139404
loss_pred:0.013550621457397938, decouple_loss:0.0017082345439121127
The modified gen p mean: 0.4498175084590912, gen p mean: -0.23828263580799103, mean p set: 0.4503912329673767
loss_pred:0.012719186954200268, decouple_loss:0.001960640773177147
The modified gen p mean: 0.44877520203590393, gen p mean: -0.23982784152030945, mean p set: 0.4493516683578491
loss_pred:0.01449374109506607, decouple_loss:0.0019027863163501024
Iteration: 4863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471912384033203, gen p mean: -0.24193574488162994, mean p set: 0.4477207064628601
loss_pred:0.013700860552489758, decouple_loss:0.0021334285847842693
The modified gen p mean: 0.449219286441803, gen p mean: -0.24215802550315857, mean p set: 0.4497992694377899
loss_pred:0.013444369658827782, decouple_loss:0.0019156316993758082
The modified gen p mean: 0.44835516810417175, gen p mean: -0.23812881112098694, mean p set: 0.4489321708679199
loss_pred:0.013477316126227379, decouple_loss:0.0021390856709331274
Iteration: 4864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45054349303245544, gen p mean: -0.24272151291370392, mean p set: 0.4510750472545624
loss_pred:0.01372479647397995, decouple_loss:0.001975718652829528
The modified gen p mean: 0.44826775789260864, gen p mean: -0.24423877894878387, mean p set: 0.44884857535362244
loss_pred:0.013908077962696552, decouple_loss:0.001853880356065929
The modified gen p mean: 0.4482124447822571, gen p mean: -0.23692844808101654, mean p set: 0.4487907588481903
loss_pred:0.0139120202511549, decouple_loss:0.0018126274226233363
Iteration: 4865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482060372829437, gen p mean: -0.24079930782318115, mean p set: 0.44873154163360596
loss_pred:0.01335525419563055, decouple_loss:0.0017390253487974405
The modified gen p mean: 0.4486579895019531, gen p mean: -0.2370743602514267, mean p set: 0.4492337107658386
loss_pred:0.013230504468083382, decouple_loss:0.0018260322976857424
The modified gen p mean: 0.44831734895706177, gen p mean: -0.23627756536006927, mean p set: 0.44889214634895325
loss_pred:0.01386159099638462, decouple_loss:0.0017927230801433325
Iteration: 4866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024874806404114, gen p mean: -0.23951895534992218, mean p set: 0.4508228898048401
loss_pred:0.013152269646525383, decouple_loss:0.001956208609044552
The modified gen p mean: 0.4489222764968872, gen p mean: -0.23699435591697693, mean p set: 0.44949066638946533The modified gen p mean: 0.4498085081577301, gen p mean: -0.2393702119588852, mean p set: 0.4503350555896759
loss_pred:0.013900477439165115, decouple_loss:0.001739325001835823
loss_pred:0.013827367685735226, decouple_loss:0.0016886605881154537
Iteration: 4867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496065080165863, gen p mean: -0.24182870984077454, mean p set: 0.45017769932746887
loss_pred:0.0133981229737401, decouple_loss:0.002025064779445529
The modified gen p mean: 0.44931286573410034, gen p mean: -0.2426002323627472, mean p set: 0.4498860538005829The modified gen p mean: 0.4500187337398529, gen p mean: -0.23806466162204742, mean p set: 0.4505492150783539
loss_pred:0.014042488299310207, decouple_loss:0.00222885818220675
loss_pred:0.013066256418824196, decouple_loss:0.001953242812305689
Iteration: 4868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499225318431854, gen p mean: -0.23877979815006256, mean p set: 0.4504936933517456
loss_pred:0.012735293246805668, decouple_loss:0.0017284407513216138
The modified gen p mean: 0.4494958519935608, gen p mean: -0.2392144799232483, mean p set: 0.45007139444351196
loss_pred:0.014108918607234955, decouple_loss:0.0017928439192473888
The modified gen p mean: 0.4487271010875702, gen p mean: -0.2363199144601822, mean p set: 0.4492511451244354
loss_pred:0.014708008617162704, decouple_loss:0.0017879465594887733
Iteration: 4869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495515823364258, gen p mean: -0.23834387958049774, mean p set: 0.4501335322856903
loss_pred:0.01319312583655119, decouple_loss:0.0022055574227124453
The modified gen p mean: 0.45044171810150146, gen p mean: -0.23724119365215302, mean p set: 0.4510194957256317
loss_pred:0.013196847401559353, decouple_loss:0.002231454011052847
The modified gen p mean: 0.44951239228248596, gen p mean: -0.23951369524002075, mean p set: 0.4500423073768616
loss_pred:0.01416644174605608, decouple_loss:0.0019033823627978563
Iteration: 4870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988682866096497, gen p mean: -0.23761481046676636, mean p set: 0.450408935546875
loss_pred:0.013208338059484959, decouple_loss:0.0019891010597348213
The modified gen p mean: 0.45002254843711853, gen p mean: -0.2399459183216095, mean p set: 0.4505973160266876
loss_pred:0.013530553318560123, decouple_loss:0.0020216130651533604
The modified gen p mean: 0.44891098141670227, gen p mean: -0.247335746884346, mean p set: 0.4494844079017639
loss_pred:0.014024000614881516, decouple_loss:0.001734026474878192
2023-04-28 01:10:49 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23932300508022308, mean p set: 0.4499112665653229
loss_pred:0.015348494984209538, decouple_loss:0.0023139610420912504
The modified gen p mean: 0.4482671022415161, gen p mean: -0.23674893379211426, mean p set: 0.44879910349845886
The modified gen p mean: 0.44929736852645874, gen p mean: -0.23939821124076843, mean p set: 0.4498290419578552
loss_pred:0.015234028920531273, decouple_loss:0.0021411702036857605
loss_pred:0.01492271013557911, decouple_loss:0.0021955822594463825
WV_1_PC_1_EH_0_PS_30, loss: 0.015279257670044899, avg_mse: 0.022614264860749245
current test mse: 0.022614
Iteration: 4871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474199712276459, gen p mean: -0.23849423229694366, mean p set: 0.4479977786540985
loss_pred:0.013447786681354046, decouple_loss:0.0019462632481008768
The modified gen p mean: 0.4494083523750305, gen p mean: -0.2370261698961258, mean p set: 0.4499913156032562
loss_pred:0.013235417194664478, decouple_loss:0.0020425766706466675
The modified gen p mean: 0.4474843442440033, gen p mean: -0.23764953017234802, mean p set: 0.448009192943573
loss_pred:0.013340102508664131, decouple_loss:0.0019944224040955305
Iteration: 4872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019349455833435, gen p mean: -0.2356451004743576, mean p set: 0.4507233798503876
loss_pred:0.013598962686955929, decouple_loss:0.0016634962521493435
The modified gen p mean: 0.4485231637954712, gen p mean: -0.23567627370357513, mean p set: 0.4491027593612671
loss_pred:0.013841071166098118, decouple_loss:0.0017473592888563871
The modified gen p mean: 0.4501882493495941, gen p mean: -0.24199411273002625, mean p set: 0.45076262950897217
loss_pred:0.01294860802590847, decouple_loss:0.0017157907132059336
Iteration: 4873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023801922798157, gen p mean: -0.23505599796772003, mean p set: 0.4507656991481781
loss_pred:0.013407088816165924, decouple_loss:0.0019214072963222861
The modified gen p mean: 0.450067400932312, gen p mean: -0.23749512434005737, mean p set: 0.45064398646354675
loss_pred:0.012618042528629303, decouple_loss:0.0018474063836038113
The modified gen p mean: 0.4503440260887146, gen p mean: -0.23474065959453583, mean p set: 0.4509190618991852
loss_pred:0.013602478429675102, decouple_loss:0.0017814987804740667
Iteration: 4874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939666986465454, gen p mean: -0.23872849345207214, mean p set: 0.4499257802963257
loss_pred:0.013704675249755383, decouple_loss:0.00163360929582268
The modified gen p mean: 0.44883719086647034, gen p mean: -0.23590929806232452, mean p set: 0.4494141638278961
loss_pred:0.01415006909519434, decouple_loss:0.0015418741386383772
The modified gen p mean: 0.4492303729057312, gen p mean: -0.2392853945493698, mean p set: 0.4498126208782196
loss_pred:0.013320024125277996, decouple_loss:0.0016717684920877218
Iteration: 4875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778722524642944, gen p mean: -0.2315499186515808, mean p set: 0.44835996627807617
loss_pred:0.01443745382130146, decouple_loss:0.0017527899472042918
The modified gen p mean: 0.44906049966812134, gen p mean: -0.23713712394237518, mean p set: 0.44958579540252686The modified gen p mean: 0.4504859149456024, gen p mean: -0.23267556726932526, mean p set: 0.45106109976768494
loss_pred:0.013753742910921574, decouple_loss:0.0016493166331201792
loss_pred:0.012811859138309956, decouple_loss:0.0017066305736079812
Iteration: 4876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489566683769226, gen p mean: -0.22995175421237946, mean p set: 0.44953563809394836
loss_pred:0.013269549235701561, decouple_loss:0.0020352061837911606
The modified gen p mean: 0.4491821229457855, gen p mean: -0.23429596424102783, mean p set: 0.449707955121994
The modified gen p mean: 0.44882819056510925, gen p mean: -0.23317886888980865, mean p set: 0.4494022727012634
loss_pred:0.013706469908356667, decouple_loss:0.0017190065700560808
loss_pred:0.014300578273832798, decouple_loss:0.0016926360549405217
Iteration: 4877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936639070510864, gen p mean: -0.23390963673591614, mean p set: 0.4498968720436096
loss_pred:0.0129386680200696, decouple_loss:0.0017216595588251948
The modified gen p mean: 0.4476378262042999, gen p mean: -0.2315831184387207, mean p set: 0.4482172131538391
loss_pred:0.013626252301037312, decouple_loss:0.001531583839096129
The modified gen p mean: 0.45067155361175537, gen p mean: -0.2291133552789688, mean p set: 0.4512515664100647
loss_pred:0.013494446873664856, decouple_loss:0.0018654463347047567
Iteration: 4878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881370663642883, gen p mean: -0.23246890306472778, mean p set: 0.44939103722572327
loss_pred:0.013850286602973938, decouple_loss:0.0017979011172428727
The modified gen p mean: 0.4501628279685974, gen p mean: -0.2333180010318756, mean p set: 0.4506858289241791The modified gen p mean: 0.44710516929626465, gen p mean: -0.23427964746952057, mean p set: 0.4476839303970337
loss_pred:0.013516454957425594, decouple_loss:0.0018827805761247873
loss_pred:0.013308643363416195, decouple_loss:0.001693860860541463
Iteration: 4879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905877113342285, gen p mean: -0.23385480046272278, mean p set: 0.4496326744556427
loss_pred:0.013607645407319069, decouple_loss:0.0016005435027182102
The modified gen p mean: 0.4479120969772339, gen p mean: -0.2339695543050766, mean p set: 0.44843724370002747The modified gen p mean: 0.4493441581726074, gen p mean: -0.23419071733951569, mean p set: 0.4499218463897705
loss_pred:0.013831086456775665, decouple_loss:0.0016758464043959975
loss_pred:0.013593725860118866, decouple_loss:0.001566070830449462
Iteration: 4880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895482063293457, gen p mean: -0.2322760820388794, mean p set: 0.4494830369949341
loss_pred:0.013215097598731518, decouple_loss:0.0018825827864930034
The modified gen p mean: 0.44932547211647034, gen p mean: -0.22882913053035736, mean p set: 0.4499005675315857
loss_pred:0.013577433302998543, decouple_loss:0.0020481948740780354
The modified gen p mean: 0.4501228928565979, gen p mean: -0.22862869501113892, mean p set: 0.4507005214691162
loss_pred:0.012863590382039547, decouple_loss:0.002050390001386404
2023-04-28 01:14:13 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23003309965133667, mean p set: 0.4499112665653229
loss_pred:0.0153069281950593, decouple_loss:0.001747838337905705
The modified gen p mean: 0.44826555252075195, gen p mean: -0.2275877147912979, mean p set: 0.44879910349845886
loss_pred:0.015220067463815212, decouple_loss:0.0016993952449411154
The modified gen p mean: 0.4493015706539154, gen p mean: -0.23029538989067078, mean p set: 0.4498290419578552
loss_pred:0.014875768683850765, decouple_loss:0.0016524925595149398
WV_1_PC_1_EH_0_PS_30, loss: 0.015219250693917274, avg_mse: 0.022575270384550095
current test mse: 0.022575
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 4881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777607917785645, gen p mean: -0.23674310743808746, mean p set: 0.44830334186553955
loss_pred:0.014132245443761349, decouple_loss:0.0018536372808739543
The modified gen p mean: 0.44805869460105896, gen p mean: -0.2309439778327942, mean p set: 0.4486377537250519
loss_pred:0.014264937490224838, decouple_loss:0.0017960796831175685
The modified gen p mean: 0.4475420415401459, gen p mean: -0.23562562465667725, mean p set: 0.44811320304870605
loss_pred:0.014033207669854164, decouple_loss:0.001964487601071596
Iteration: 4882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765031337738037, gen p mean: -0.2310006469488144, mean p set: 0.44817250967025757
loss_pred:0.01404876634478569, decouple_loss:0.00212637591175735
The modified gen p mean: 0.44767892360687256, gen p mean: -0.23501941561698914, mean p set: 0.4482541084289551
loss_pred:0.014706818386912346, decouple_loss:0.002182602183893323
The modified gen p mean: 0.4472438395023346, gen p mean: -0.23145374655723572, mean p set: 0.44781988859176636
loss_pred:0.014776185154914856, decouple_loss:0.002239524619653821
Iteration: 4883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44598445296287537, gen p mean: -0.23148252069950104, mean p set: 0.44651728868484497
loss_pred:0.014172286726534367, decouple_loss:0.0020471990574151278
The modified gen p mean: 0.4478299021720886, gen p mean: -0.23173481225967407, mean p set: 0.44840726256370544
loss_pred:0.014234714210033417, decouple_loss:0.0021771800238639116
The modified gen p mean: 0.44710108637809753, gen p mean: -0.2282036691904068, mean p set: 0.4476746618747711
loss_pred:0.014261027798056602, decouple_loss:0.002089274348691106
Iteration: 4884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801682233810425, gen p mean: -0.23257267475128174, mean p set: 0.4485393166542053
loss_pred:0.013448166660964489, decouple_loss:0.001999805448576808
The modified gen p mean: 0.4472370445728302, gen p mean: -0.23475201427936554, mean p set: 0.4478101134300232
loss_pred:0.014194467104971409, decouple_loss:0.001815242227166891
The modified gen p mean: 0.4479953944683075, gen p mean: -0.2336418181657791, mean p set: 0.4485742151737213
loss_pred:0.013952701352536678, decouple_loss:0.0020141524728387594
Iteration: 4885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465557038784027, gen p mean: -0.234761044383049, mean p set: 0.44713273644447327
loss_pred:0.01412979420274496, decouple_loss:0.0018502137390896678
The modified gen p mean: 0.4472520649433136, gen p mean: -0.23617689311504364, mean p set: 0.4477926790714264The modified gen p mean: 0.44719013571739197, gen p mean: -0.22992917895317078, mean p set: 0.4477651119232178
loss_pred:0.014354735612869263, decouple_loss:0.001743685337714851
loss_pred:0.014285116456449032, decouple_loss:0.0017935069045051932
Iteration: 4886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473530948162079, gen p mean: -0.2297215759754181, mean p set: 0.44792816042900085
loss_pred:0.013794091530144215, decouple_loss:0.0016735292738303542
The modified gen p mean: 0.44741538166999817, gen p mean: -0.2303609549999237, mean p set: 0.44799429178237915The modified gen p mean: 0.4465804994106293, gen p mean: -0.23504920303821564, mean p set: 0.4471103250980377
loss_pred:0.013508664444088936, decouple_loss:0.0017957242671400309
loss_pred:0.014579975046217442, decouple_loss:0.0017336485907435417
Iteration: 4887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855210185050964, gen p mean: -0.23374101519584656, mean p set: 0.4491317868232727
loss_pred:0.013623525388538837, decouple_loss:0.0016229867469519377
The modified gen p mean: 0.4474441111087799, gen p mean: -0.2328861802816391, mean p set: 0.4480171501636505The modified gen p mean: 0.44711849093437195, gen p mean: -0.22956262528896332, mean p set: 0.44764673709869385
loss_pred:0.014428520575165749, decouple_loss:0.0017149831401184201
loss_pred:0.014234923757612705, decouple_loss:0.001675315317697823
Iteration: 4888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475167691707611, gen p mean: -0.23440863192081451, mean p set: 0.4480930268764496
loss_pred:0.014404790475964546, decouple_loss:0.001976771280169487
The modified gen p mean: 0.44675007462501526, gen p mean: -0.23805983364582062, mean p set: 0.4473235309123993
loss_pred:0.014248094521462917, decouple_loss:0.0019701917190104723
The modified gen p mean: 0.448131263256073, gen p mean: -0.23876585066318512, mean p set: 0.4486536979675293
loss_pred:0.01399842370301485, decouple_loss:0.0022089784033596516
Iteration: 4889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715961813926697, gen p mean: -0.2405497431755066, mean p set: 0.44773492217063904
loss_pred:0.013918365351855755, decouple_loss:0.001609387225471437
The modified gen p mean: 0.447627991437912, gen p mean: -0.23463401198387146, mean p set: 0.44820424914360046
loss_pred:0.014179984107613564, decouple_loss:0.0015987390652298927
The modified gen p mean: 0.44829124212265015, gen p mean: -0.23751956224441528, mean p set: 0.4488171935081482
loss_pred:0.013683014549314976, decouple_loss:0.001572503475472331
Iteration: 4890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475207030773163, gen p mean: -0.24054914712905884, mean p set: 0.44810402393341064
loss_pred:0.01382460631430149, decouple_loss:0.002138771815225482
The modified gen p mean: 0.4481789171695709, gen p mean: -0.24102915823459625, mean p set: 0.44875964522361755The modified gen p mean: 0.4461464285850525, gen p mean: -0.24126628041267395, mean p set: 0.44667288661003113
loss_pred:0.014033664017915726, decouple_loss:0.002250085351988673
loss_pred:0.013829782605171204, decouple_loss:0.0022050822153687477
2023-04-28 01:18:31 testing...
The modified gen p mean: 0.44827085733413696, gen p mean: -0.23709391057491302, mean p set: 0.44879910349845886
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23964446783065796, mean p set: 0.4499112665653229loss_pred:0.015185096301138401, decouple_loss:0.0019159825751557946
loss_pred:0.015281478874385357, decouple_loss:0.0021064176689833403
The modified gen p mean: 0.4493045210838318, gen p mean: -0.2397674322128296, mean p set: 0.4498290419578552
loss_pred:0.014789177104830742, decouple_loss:0.0020481219980865717
WV_1_PC_1_EH_0_PS_30, loss: 0.015186427161097527, avg_mse: 0.022487521171569824
current test mse: 0.022488
Iteration: 4891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827115535736084, gen p mean: -0.2337031215429306, mean p set: 0.4487995207309723
loss_pred:0.014483015052974224, decouple_loss:0.002054609591141343
The modified gen p mean: 0.4485407769680023, gen p mean: -0.23987877368927002, mean p set: 0.449113667011261The modified gen p mean: 0.44723790884017944, gen p mean: -0.2453489899635315, mean p set: 0.44781628251075745
loss_pred:0.014184951782226562, decouple_loss:0.0019166703568771482
loss_pred:0.014420641586184502, decouple_loss:0.0018594866851344705
Iteration: 4892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741320610046387, gen p mean: -0.23740741610527039, mean p set: 0.4479508101940155
loss_pred:0.014341584406793118, decouple_loss:0.0022439840249717236
The modified gen p mean: 0.44785284996032715, gen p mean: -0.24192751944065094, mean p set: 0.44843369722366333
The modified gen p mean: 0.44802823662757874, gen p mean: -0.24010460078716278, mean p set: 0.44860827922821045
loss_pred:0.013845006003975868, decouple_loss:0.002034201519563794
loss_pred:0.013646413572132587, decouple_loss:0.0021260594949126244
Iteration: 4893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460158944129944, gen p mean: -0.2415512651205063, mean p set: 0.4465450048446655
loss_pred:0.013958483934402466, decouple_loss:0.0019072761060670018
The modified gen p mean: 0.4477483928203583, gen p mean: -0.2360026240348816, mean p set: 0.44832614064216614
The modified gen p mean: 0.448020875453949, gen p mean: -0.23772168159484863, mean p set: 0.4485970735549927
loss_pred:0.013156330212950706, decouple_loss:0.0018445737659931183
loss_pred:0.013418001122772694, decouple_loss:0.0018575688591226935
Iteration: 4894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466647803783417, gen p mean: -0.23787319660186768, mean p set: 0.447241872549057
loss_pred:0.014375791884958744, decouple_loss:0.002468003425747156
The modified gen p mean: 0.4479523003101349, gen p mean: -0.23228931427001953, mean p set: 0.44852498173713684
loss_pred:0.014194563962519169, decouple_loss:0.0019968135748058558
The modified gen p mean: 0.44580671191215515, gen p mean: -0.23598414659500122, mean p set: 0.446336567401886
loss_pred:0.013756729662418365, decouple_loss:0.002154785208404064
Iteration: 4895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475642144680023, gen p mean: -0.2350771427154541, mean p set: 0.4481382668018341
loss_pred:0.01363283023238182, decouple_loss:0.0018722323002293706
The modified gen p mean: 0.44617417454719543, gen p mean: -0.23238931596279144, mean p set: 0.4467467665672302
loss_pred:0.013863862492144108, decouple_loss:0.0018775946227833629
The modified gen p mean: 0.44781407713890076, gen p mean: -0.22904488444328308, mean p set: 0.44834527373313904
loss_pred:0.014510281383991241, decouple_loss:0.0019716646056622267
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44548556208610535, gen p mean: -0.227047398686409, mean p set: 0.4460587203502655
loss_pred:0.013718177564442158, decouple_loss:0.0018332861363887787
The modified gen p mean: 0.4480975866317749, gen p mean: -0.22890973091125488, mean p set: 0.4486773908138275The modified gen p mean: 0.4466329514980316, gen p mean: -0.229742631316185, mean p set: 0.4471621811389923
loss_pred:0.013743022456765175, decouple_loss:0.001783672603778541
loss_pred:0.013828881084918976, decouple_loss:0.0017916407668963075
Iteration: 4897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462270438671112, gen p mean: -0.23680436611175537, mean p set: 0.4468037486076355
loss_pred:0.014248567633330822, decouple_loss:0.0018954041879624128
The modified gen p mean: 0.446607381105423, gen p mean: -0.23005367815494537, mean p set: 0.447177916765213
loss_pred:0.013757549226284027, decouple_loss:0.0018564049387350678
The modified gen p mean: 0.4478006660938263, gen p mean: -0.2284311056137085, mean p set: 0.44832247495651245
loss_pred:0.014551730826497078, decouple_loss:0.0017790257697924972
Iteration: 4898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469161927700043, gen p mean: -0.23487840592861176, mean p set: 0.4474954903125763
loss_pred:0.014462905935943127, decouple_loss:0.001964358612895012
The modified gen p mean: 0.4472493529319763, gen p mean: -0.23775361478328705, mean p set: 0.447822630405426The modified gen p mean: 0.4472748637199402, gen p mean: -0.24010470509529114, mean p set: 0.44780153036117554
loss_pred:0.013796274550259113, decouple_loss:0.0017781532369554043
loss_pred:0.014693041332066059, decouple_loss:0.0018722168169915676
Iteration: 4899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44659870862960815, gen p mean: -0.2369711548089981, mean p set: 0.4471730887889862
loss_pred:0.014164243824779987, decouple_loss:0.0018423526780679822
The modified gen p mean: 0.44718340039253235, gen p mean: -0.2431531846523285, mean p set: 0.44775745272636414
loss_pred:0.014005417004227638, decouple_loss:0.001799270510673523
The modified gen p mean: 0.4466346204280853, gen p mean: -0.23707067966461182, mean p set: 0.44715774059295654
loss_pred:0.013886666856706142, decouple_loss:0.0017469045706093311
Iteration: 4900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789764285087585, gen p mean: -0.24067099392414093, mean p set: 0.4484725892543793
loss_pred:0.013584677129983902, decouple_loss:0.0017302505439147353
The modified gen p mean: 0.44633135199546814, gen p mean: -0.23599299788475037, mean p set: 0.4469052851200104
loss_pred:0.013886647298932076, decouple_loss:0.0017295029247179627
The modified gen p mean: 0.4478127658367157, gen p mean: -0.23844534158706665, mean p set: 0.4483456313610077
loss_pred:0.013912715949118137, decouple_loss:0.0016205518040806055
2023-04-28 01:21:55 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2423996925354004, mean p set: 0.4499112665653229
loss_pred:0.015273545868694782, decouple_loss:0.002407520543783903
The modified gen p mean: 0.4482724070549011, gen p mean: -0.24004344642162323, mean p set: 0.44879910349845886
loss_pred:0.015177435241639614, decouple_loss:0.0022893468849360943
The modified gen p mean: 0.44930118322372437, gen p mean: -0.2425006479024887, mean p set: 0.4498290419578552
loss_pred:0.014837815426290035, decouple_loss:0.0022930835839360952
WV_1_PC_1_EH_0_PS_30, loss: 0.015212764963507652, avg_mse: 0.022509079426527023
current test mse: 0.022509
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 4901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482589066028595, gen p mean: -0.24083136022090912, mean p set: 0.44878846406936646
loss_pred:0.014011478051543236, decouple_loss:0.0017931765178218484
The modified gen p mean: 0.44835665822029114, gen p mean: -0.23787249624729156, mean p set: 0.4489271342754364
loss_pred:0.014259765855967999, decouple_loss:0.0019712653011083603
The modified gen p mean: 0.4477255940437317, gen p mean: -0.23867882788181305, mean p set: 0.4483031630516052
loss_pred:0.014830442145466805, decouple_loss:0.0019144837278872728
Iteration: 4902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469571113586426, gen p mean: -0.2389586716890335, mean p set: 0.44748347997665405
loss_pred:0.014394071884453297, decouple_loss:0.001989779993891716
The modified gen p mean: 0.4477427303791046, gen p mean: -0.2376980036497116, mean p set: 0.44831880927085876
loss_pred:0.014835742302238941, decouple_loss:0.0018205001251772046
The modified gen p mean: 0.4478605389595032, gen p mean: -0.2374856173992157, mean p set: 0.4484356641769409
loss_pred:0.0145126823335886, decouple_loss:0.0019796499982476234
Iteration: 4903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481925666332245, gen p mean: -0.22945013642311096, mean p set: 0.44872552156448364
loss_pred:0.014589531347155571, decouple_loss:0.0019076354801654816
The modified gen p mean: 0.4478780925273895, gen p mean: -0.22893588244915009, mean p set: 0.44845762848854065
loss_pred:0.013933878391981125, decouple_loss:0.0019093723967671394
The modified gen p mean: 0.4464782476425171, gen p mean: -0.23568101227283478, mean p set: 0.4470512866973877
loss_pred:0.014352516271173954, decouple_loss:0.0016162878600880504
Iteration: 4904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469860792160034, gen p mean: -0.23404549062252045, mean p set: 0.4475124180316925
loss_pred:0.01454327255487442, decouple_loss:0.0015558234881609678
The modified gen p mean: 0.4480253756046295, gen p mean: -0.2328716516494751, mean p set: 0.448603093624115
loss_pred:0.014465906657278538, decouple_loss:0.001706619281321764
The modified gen p mean: 0.4478171169757843, gen p mean: -0.23287709057331085, mean p set: 0.4483935534954071
loss_pred:0.014036900363862514, decouple_loss:0.0015814744401723146
Iteration: 4905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478261470794678, gen p mean: -0.23202885687351227, mean p set: 0.44839873909950256
loss_pred:0.01467831339687109, decouple_loss:0.001575828529894352
The modified gen p mean: 0.44796642661094666, gen p mean: -0.23555277287960052, mean p set: 0.4485013484954834The modified gen p mean: 0.4477614462375641, gen p mean: -0.23203808069229126, mean p set: 0.4483359158039093
loss_pred:0.01438592467457056, decouple_loss:0.0016070917481556535
loss_pred:0.014289294369518757, decouple_loss:0.0017522991402074695
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481489062309265, gen p mean: -0.24064844846725464, mean p set: 0.44871973991394043
loss_pred:0.014611358754336834, decouple_loss:0.002072487259283662
The modified gen p mean: 0.44632336497306824, gen p mean: -0.24377863109111786, mean p set: 0.44685330986976624The modified gen p mean: 0.44771450757980347, gen p mean: -0.2401796579360962, mean p set: 0.44829073548316956
loss_pred:0.014704338274896145, decouple_loss:0.00184203393291682
loss_pred:0.01432240940630436, decouple_loss:0.001824791426770389
Iteration: 4907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720688462257385, gen p mean: -0.2408922016620636, mean p set: 0.4477825164794922
loss_pred:0.014568467624485493, decouple_loss:0.0016238668467849493
The modified gen p mean: 0.4484829902648926, gen p mean: -0.23700526356697083, mean p set: 0.4490111172199249The modified gen p mean: 0.44742944836616516, gen p mean: -0.23787780106067657, mean p set: 0.44800689816474915
loss_pred:0.014245674945414066, decouple_loss:0.001782373758032918
loss_pred:0.013724802061915398, decouple_loss:0.0016893093707039952
Iteration: 4908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817277789115906, gen p mean: -0.23177661001682281, mean p set: 0.44870471954345703
loss_pred:0.014693628065288067, decouple_loss:0.0017989034531638026
The modified gen p mean: 0.44802629947662354, gen p mean: -0.23517820239067078, mean p set: 0.4485968351364136
loss_pred:0.014310517348349094, decouple_loss:0.0021053608506917953
The modified gen p mean: 0.447532057762146, gen p mean: -0.2357356697320938, mean p set: 0.44810402393341064
loss_pred:0.013943444006145, decouple_loss:0.0016918386099860072
Iteration: 4909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806861877441406, gen p mean: -0.22651782631874084, mean p set: 0.44864511489868164
loss_pred:0.014035364612936974, decouple_loss:0.00192517030518502
The modified gen p mean: 0.44806697964668274, gen p mean: -0.22625601291656494, mean p set: 0.44864311814308167The modified gen p mean: 0.4474038779735565, gen p mean: -0.2291426956653595, mean p set: 0.4479339122772217
loss_pred:0.0140986992046237, decouple_loss:0.001973575446754694
loss_pred:0.014396472834050655, decouple_loss:0.002140793716534972
Iteration: 4910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771745800971985, gen p mean: -0.22874905169010162, mean p set: 0.4482938349246979
loss_pred:0.014002786949276924, decouple_loss:0.0017985311569646
The modified gen p mean: 0.44800832867622375, gen p mean: -0.2272925227880478, mean p set: 0.44858577847480774The modified gen p mean: 0.44874635338783264, gen p mean: -0.22874198853969574, mean p set: 0.4492678940296173
loss_pred:0.014102146960794926, decouple_loss:0.0017606079345569015
loss_pred:0.013912527821958065, decouple_loss:0.0019025608198717237
2023-04-28 01:26:08 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22828997671604156, mean p set: 0.4499112665653229
loss_pred:0.015235652215778828, decouple_loss:0.00242814514786005
The modified gen p mean: 0.4482724964618683, gen p mean: -0.22600680589675903, mean p set: 0.44879910349845886
loss_pred:0.01518222875893116, decouple_loss:0.0022039327304810286
The modified gen p mean: 0.4492987394332886, gen p mean: -0.2284935861825943, mean p set: 0.4498290419578552
loss_pred:0.01481585018336773, decouple_loss:0.002410972723737359
WV_1_PC_1_EH_0_PS_30, loss: 0.01519529428333044, avg_mse: 0.02243606187403202
current test mse: 0.022436
Iteration: 4911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792547821998596, gen p mean: -0.22918182611465454, mean p set: 0.44850432872772217
loss_pred:0.013890566304326057, decouple_loss:0.0020813695155084133
The modified gen p mean: 0.4476929008960724, gen p mean: -0.22817960381507874, mean p set: 0.4482678174972534
loss_pred:0.01422659307718277, decouple_loss:0.002073683775961399
The modified gen p mean: 0.4473594129085541, gen p mean: -0.2237984985113144, mean p set: 0.4478871822357178
loss_pred:0.014880456030368805, decouple_loss:0.0017365040257573128
Iteration: 4912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866976141929626, gen p mean: -0.23366600275039673, mean p set: 0.44920313358306885
loss_pred:0.014120846055448055, decouple_loss:0.0017089217435568571
The modified gen p mean: 0.44817352294921875, gen p mean: -0.22969527542591095, mean p set: 0.4487583637237549
loss_pred:0.01442321203649044, decouple_loss:0.0016456573503091931
The modified gen p mean: 0.44731318950653076, gen p mean: -0.2311863899230957, mean p set: 0.447892427444458
loss_pred:0.014669482596218586, decouple_loss:0.0015902880113571882
Iteration: 4913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671913981437683, gen p mean: -0.23562471568584442, mean p set: 0.44724538922309875
loss_pred:0.014768710359930992, decouple_loss:0.0017304978100582957
The modified gen p mean: 0.44723692536354065, gen p mean: -0.23298244178295135, mean p set: 0.44781461358070374
loss_pred:0.01470983773469925, decouple_loss:0.0016012400155887008
The modified gen p mean: 0.44726282358169556, gen p mean: -0.23710748553276062, mean p set: 0.4478394687175751
loss_pred:0.01436819788068533, decouple_loss:0.0015231174184009433
Iteration: 4914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687458872795105, gen p mean: -0.23823778331279755, mean p set: 0.44740280508995056
loss_pred:0.01416151225566864, decouple_loss:0.0015674796886742115
The modified gen p mean: 0.44869908690452576, gen p mean: -0.23601046204566956, mean p set: 0.44927188754081726
loss_pred:0.014032780192792416, decouple_loss:0.0016191477188840508
The modified gen p mean: 0.4487859308719635, gen p mean: -0.23682928085327148, mean p set: 0.44936102628707886
loss_pred:0.013605235144495964, decouple_loss:0.0017861515516415238
Iteration: 4915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44607171416282654, gen p mean: -0.23846463859081268, mean p set: 0.44664737582206726
loss_pred:0.014438347890973091, decouple_loss:0.001484778942540288
The modified gen p mean: 0.44815194606781006, gen p mean: -0.23488521575927734, mean p set: 0.4486865699291229The modified gen p mean: 0.44811496138572693, gen p mean: -0.23459026217460632, mean p set: 0.44869464635849
loss_pred:0.014201594516634941, decouple_loss:0.0013675575610250235loss_pred:0.014222119003534317, decouple_loss:0.0015581331681460142
Iteration: 4916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478682577610016, gen p mean: -0.23107658326625824, mean p set: 0.4484493136405945
loss_pred:0.013877392746508121, decouple_loss:0.0014946225564926863
The modified gen p mean: 0.4477825462818146, gen p mean: -0.23227711021900177, mean p set: 0.44831034541130066The modified gen p mean: 0.4477635622024536, gen p mean: -0.23681917786598206, mean p set: 0.4483374059200287
loss_pred:0.01397593505680561, decouple_loss:0.0016633918276056647
loss_pred:0.01455965917557478, decouple_loss:0.0015201200731098652
Iteration: 4917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486692547798157, gen p mean: -0.23458677530288696, mean p set: 0.4492388963699341
loss_pred:0.014046614989638329, decouple_loss:0.0016415498685091734
The modified gen p mean: 0.44799795746803284, gen p mean: -0.23252412676811218, mean p set: 0.44857192039489746The modified gen p mean: 0.44780322909355164, gen p mean: -0.23509861528873444, mean p set: 0.448335200548172
loss_pred:0.014516850933432579, decouple_loss:0.0015465234173461795
loss_pred:0.013982619158923626, decouple_loss:0.00155736249871552
Iteration: 4918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479656517505646, gen p mean: -0.23157739639282227, mean p set: 0.4485422670841217
loss_pred:0.014256940223276615, decouple_loss:0.001455647754482925
The modified gen p mean: 0.4475744664669037, gen p mean: -0.23508478701114655, mean p set: 0.4481017291545868
loss_pred:0.013949227519333363, decouple_loss:0.0014382308581843972
The modified gen p mean: 0.4482221305370331, gen p mean: -0.23391906917095184, mean p set: 0.4488029479980469
loss_pred:0.013921018689870834, decouple_loss:0.0014842530945315957
Iteration: 4919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705313444137573, gen p mean: -0.22723548114299774, mean p set: 0.4476318955421448
loss_pred:0.014725972898304462, decouple_loss:0.0018483453895896673
The modified gen p mean: 0.4476609528064728, gen p mean: -0.23087671399116516, mean p set: 0.44823122024536133
loss_pred:0.014504432678222656, decouple_loss:0.0017275779973715544
The modified gen p mean: 0.447965145111084, gen p mean: -0.23132970929145813, mean p set: 0.44848933815956116
loss_pred:0.013782719150185585, decouple_loss:0.001581336255185306
Iteration: 4920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880837202072144, gen p mean: -0.2313065379858017, mean p set: 0.44938814640045166
loss_pred:0.014569757506251335, decouple_loss:0.0015490297228097916
The modified gen p mean: 0.4485379159450531, gen p mean: -0.23719370365142822, mean p set: 0.44911372661590576
loss_pred:0.014362543821334839, decouple_loss:0.001450702198781073
The modified gen p mean: 0.44741952419281006, gen p mean: -0.23254182934761047, mean p set: 0.4479440450668335
loss_pred:0.014474851079285145, decouple_loss:0.0016214613569900393
2023-04-28 01:29:32 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23541715741157532, mean p set: 0.4499112665653229
loss_pred:0.01527308952063322, decouple_loss:0.0019880507607012987
The modified gen p mean: 0.4482686519622803, gen p mean: -0.2329544872045517, mean p set: 0.44879910349845886
loss_pred:0.015250257216393948, decouple_loss:0.001911201048642397
The modified gen p mean: 0.4492984116077423, gen p mean: -0.23535794019699097, mean p set: 0.4498290419578552
loss_pred:0.014853553846478462, decouple_loss:0.0020494426134973764
WV_1_PC_1_EH_0_PS_30, loss: 0.015224779956042767, avg_mse: 0.0225070733577013
current test mse: 0.022507
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 4921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487234055995941, gen p mean: -0.23343107104301453, mean p set: 0.4492571949958801
loss_pred:0.013201064430177212, decouple_loss:0.0020643011666834354
The modified gen p mean: 0.4470597207546234, gen p mean: -0.23152923583984375, mean p set: 0.44763508439064026
The modified gen p mean: 0.44836342334747314, gen p mean: -0.2394578754901886, mean p set: 0.44894084334373474
loss_pred:0.013386023230850697, decouple_loss:0.0019394924165681005
loss_pred:0.013703846372663975, decouple_loss:0.0019073786679655313
Iteration: 4922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481724202632904, gen p mean: -0.23468972742557526, mean p set: 0.4487045109272003
loss_pred:0.01352676097303629, decouple_loss:0.0017232303507626057
The modified gen p mean: 0.4479352831840515, gen p mean: -0.23359450697898865, mean p set: 0.4485081434249878
loss_pred:0.013969018124043941, decouple_loss:0.0017596459947526455
The modified gen p mean: 0.44850337505340576, gen p mean: -0.23167730867862701, mean p set: 0.4490780532360077
loss_pred:0.013557652942836285, decouple_loss:0.0018204646185040474
Iteration: 4923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490082561969757, gen p mean: -0.22743748128414154, mean p set: 0.4495420455932617
loss_pred:0.013109796680510044, decouple_loss:0.0022132492158561945
The modified gen p mean: 0.4471924901008606, gen p mean: -0.23339655995368958, mean p set: 0.44776979088783264
loss_pred:0.01345864124596119, decouple_loss:0.0021068856585770845
The modified gen p mean: 0.447140634059906, gen p mean: -0.22831301391124725, mean p set: 0.44771671295166016
loss_pred:0.01410247478634119, decouple_loss:0.0021917831618338823
Iteration: 4924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476833939552307, gen p mean: -0.2348405420780182, mean p set: 0.4482114315032959
loss_pred:0.013245930895209312, decouple_loss:0.0016099776839837432
The modified gen p mean: 0.44802626967430115, gen p mean: -0.2350531816482544, mean p set: 0.44860297441482544
loss_pred:0.013303514569997787, decouple_loss:0.001704852911643684
The modified gen p mean: 0.44805383682250977, gen p mean: -0.23300273716449738, mean p set: 0.4486351013183594
loss_pred:0.013240513391792774, decouple_loss:0.0017368120606988668
Iteration: 4925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480840563774109, gen p mean: -0.233144611120224, mean p set: 0.44865697622299194
loss_pred:0.013630088418722153, decouple_loss:0.0018760069506242871
The modified gen p mean: 0.4478535056114197, gen p mean: -0.23804520070552826, mean p set: 0.44843214750289917
loss_pred:0.013387320563197136, decouple_loss:0.0018385802395641804
The modified gen p mean: 0.448466032743454, gen p mean: -0.2301672250032425, mean p set: 0.4489966928958893
loss_pred:0.013613108545541763, decouple_loss:0.001826026476919651
Iteration: 4926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792836904525757, gen p mean: -0.23555661737918854, mean p set: 0.4485073983669281
loss_pred:0.013348941691219807, decouple_loss:0.0015871631912887096
The modified gen p mean: 0.4474245309829712, gen p mean: -0.2319842278957367, mean p set: 0.4479498863220215The modified gen p mean: 0.44752249121665955, gen p mean: -0.23091843724250793, mean p set: 0.4481014907360077
loss_pred:0.013389934785664082, decouple_loss:0.0019424038473516703
loss_pred:0.013164942152798176, decouple_loss:0.0018008978804573417
Iteration: 4927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893091917037964, gen p mean: -0.2288322001695633, mean p set: 0.4495067000389099
loss_pred:0.012596793472766876, decouple_loss:0.0017482070252299309
The modified gen p mean: 0.4475856423377991, gen p mean: -0.2309446483850479, mean p set: 0.44816192984580994
loss_pred:0.013022083789110184, decouple_loss:0.001867746701464057
The modified gen p mean: 0.4483445882797241, gen p mean: -0.24118362367153168, mean p set: 0.4488692879676819
loss_pred:0.013875778764486313, decouple_loss:0.002247839467599988
Iteration: 4928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478662312030792, gen p mean: -0.23982684314250946, mean p set: 0.44844159483909607
loss_pred:0.013016441836953163, decouple_loss:0.0017072402406483889
The modified gen p mean: 0.4480128884315491, gen p mean: -0.23630794882774353, mean p set: 0.4485870599746704
loss_pred:0.01311753410845995, decouple_loss:0.0020029712468385696
The modified gen p mean: 0.44751060009002686, gen p mean: -0.22764691710472107, mean p set: 0.44803711771965027
loss_pred:0.01421928871423006, decouple_loss:0.0017661643214523792
Iteration: 4929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471784830093384, gen p mean: -0.22444644570350647, mean p set: 0.4477514326572418
loss_pred:0.01432798895984888, decouple_loss:0.001830579829402268
The modified gen p mean: 0.4486824572086334, gen p mean: -0.23161408305168152, mean p set: 0.44921019673347473The modified gen p mean: 0.4470125138759613, gen p mean: -0.22643756866455078, mean p set: 0.44759488105773926
loss_pred:0.014021223410964012, decouple_loss:0.0016646473668515682
loss_pred:0.013674787245690823, decouple_loss:0.0017051571048796177
Iteration: 4930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480510652065277, gen p mean: -0.23062701523303986, mean p set: 0.4486263692378998
loss_pred:0.01393298339098692, decouple_loss:0.001536190160550177
The modified gen p mean: 0.4482807219028473, gen p mean: -0.22947998344898224, mean p set: 0.4488586187362671
loss_pred:0.013385875150561333, decouple_loss:0.0018869672203436494
The modified gen p mean: 0.44731059670448303, gen p mean: -0.22723178565502167, mean p set: 0.44784215092658997
loss_pred:0.013273127377033234, decouple_loss:0.0022606546990573406
2023-04-28 01:33:38 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.230983704328537, mean p set: 0.4499112665653229
loss_pred:0.015291097573935986, decouple_loss:0.0018956817220896482
The modified gen p mean: 0.4482688903808594, gen p mean: -0.2282879799604416, mean p set: 0.44879910349845886
loss_pred:0.015261325053870678, decouple_loss:0.001906174817122519
The modified gen p mean: 0.4492934048175812, gen p mean: -0.2308899611234665, mean p set: 0.4498290419578552
loss_pred:0.014860785566270351, decouple_loss:0.0020339805632829666
WV_1_PC_1_EH_0_PS_30, loss: 0.015235001221299171, avg_mse: 0.02261340245604515
current test mse: 0.022613
Iteration: 4931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834041595458984, gen p mean: -0.23640501499176025, mean p set: 0.4489099383354187
loss_pred:0.013043084181845188, decouple_loss:0.001844599493779242
The modified gen p mean: 0.4474179148674011, gen p mean: -0.2310449779033661, mean p set: 0.4479990005493164
loss_pred:0.013087198138237, decouple_loss:0.0017278514569625258
The modified gen p mean: 0.44861671328544617, gen p mean: -0.2319120168685913, mean p set: 0.449133038520813
loss_pred:0.013660929165780544, decouple_loss:0.00205854419618845
Iteration: 4932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472481608390808, gen p mean: -0.23361006379127502, mean p set: 0.4477807283401489
loss_pred:0.014052672311663628, decouple_loss:0.0019246643641963601
The modified gen p mean: 0.4482809901237488, gen p mean: -0.23329754173755646, mean p set: 0.4488556683063507
loss_pred:0.013668864034116268, decouple_loss:0.0017590681090950966
The modified gen p mean: 0.4484786093235016, gen p mean: -0.23398761451244354, mean p set: 0.44905373454093933
loss_pred:0.013779742643237114, decouple_loss:0.001954714534804225
Iteration: 4933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472709596157074, gen p mean: -0.23436468839645386, mean p set: 0.4477945566177368
loss_pred:0.013742959126830101, decouple_loss:0.0018601437332108617
The modified gen p mean: 0.44798120856285095, gen p mean: -0.23736713826656342, mean p set: 0.44856035709381104
loss_pred:0.012957888655364513, decouple_loss:0.002354929456487298
The modified gen p mean: 0.44741541147232056, gen p mean: -0.23586708307266235, mean p set: 0.44798383116722107
loss_pred:0.014557071961462498, decouple_loss:0.001833856338635087
Iteration: 4934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472103416919708, gen p mean: -0.24231228232383728, mean p set: 0.44773516058921814
loss_pred:0.0140491658821702, decouple_loss:0.0019033766584470868
The modified gen p mean: 0.4484071135520935, gen p mean: -0.24352867901325226, mean p set: 0.4489794969558716
loss_pred:0.013566954992711544, decouple_loss:0.0017608397174626589
The modified gen p mean: 0.4492180645465851, gen p mean: -0.2360439896583557, mean p set: 0.4497953951358795
loss_pred:0.013385629281401634, decouple_loss:0.001915473840199411
Iteration: 4935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446995347738266, gen p mean: -0.24406485259532928, mean p set: 0.4475710391998291
loss_pred:0.013122291304171085, decouple_loss:0.001939020468853414
The modified gen p mean: 0.4492865204811096, gen p mean: -0.23173250257968903, mean p set: 0.4498658776283264The modified gen p mean: 0.4468815326690674, gen p mean: -0.23806892335414886, mean p set: 0.4474125802516937
loss_pred:0.013385138474404812, decouple_loss:0.002021252177655697
loss_pred:0.013236147351562977, decouple_loss:0.0020586694590747356
Iteration: 4936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822821021080017, gen p mean: -0.2370331734418869, mean p set: 0.4488038718700409
loss_pred:0.013025065883994102, decouple_loss:0.0019124160753563046
The modified gen p mean: 0.44768133759498596, gen p mean: -0.23311007022857666, mean p set: 0.44825834035873413
loss_pred:0.013503189198672771, decouple_loss:0.002057732082903385
The modified gen p mean: 0.44844916462898254, gen p mean: -0.24350926280021667, mean p set: 0.4489799737930298
loss_pred:0.013781295157968998, decouple_loss:0.001869223895482719
Iteration: 4937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478600025177002, gen p mean: -0.22990261018276215, mean p set: 0.4484385848045349
loss_pred:0.012928523123264313, decouple_loss:0.0016005736542865634
The modified gen p mean: 0.447266161441803, gen p mean: -0.23115205764770508, mean p set: 0.44784268736839294
loss_pred:0.014395344071090221, decouple_loss:0.0016574212349951267
The modified gen p mean: 0.4475996792316437, gen p mean: -0.23180530965328217, mean p set: 0.44812890887260437
loss_pred:0.013669618405401707, decouple_loss:0.0016930954298004508
Iteration: 4938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476785957813263, gen p mean: -0.23201483488082886, mean p set: 0.4482528567314148
loss_pred:0.012933834455907345, decouple_loss:0.0020559877157211304
The modified gen p mean: 0.4465186893939972, gen p mean: -0.23759326338768005, mean p set: 0.4470933675765991
loss_pred:0.013552043586969376, decouple_loss:0.0020563702564686537
The modified gen p mean: 0.4474039673805237, gen p mean: -0.23599441349506378, mean p set: 0.4479329288005829
loss_pred:0.013107672333717346, decouple_loss:0.001980673987418413
Iteration: 4939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471999406814575, gen p mean: -0.23420895636081696, mean p set: 0.44777724146842957
loss_pred:0.014307820238173008, decouple_loss:0.0016333945095539093
The modified gen p mean: 0.44803473353385925, gen p mean: -0.23608091473579407, mean p set: 0.4486044645309448
loss_pred:0.013203207403421402, decouple_loss:0.0016959614586085081
The modified gen p mean: 0.4474090337753296, gen p mean: -0.23314137756824493, mean p set: 0.44793590903282166
loss_pred:0.013425827026367188, decouple_loss:0.0018313576001673937
Iteration: 4940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482504427433014, gen p mean: -0.2418888658285141, mean p set: 0.4488280117511749
loss_pred:0.013651234097778797, decouple_loss:0.001775685348547995
The modified gen p mean: 0.44828253984451294, gen p mean: -0.23483845591545105, mean p set: 0.4488582909107208
loss_pred:0.01388881541788578, decouple_loss:0.0018364625284448266
The modified gen p mean: 0.4475887417793274, gen p mean: -0.2404790222644806, mean p set: 0.44811877608299255
loss_pred:0.013220326974987984, decouple_loss:0.0018466124311089516
2023-04-28 01:37:02 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24100086092948914, mean p set: 0.4499112665653229
loss_pred:0.015345625579357147, decouple_loss:0.0017989987973123789
The modified gen p mean: 0.44827067852020264, gen p mean: -0.2384193241596222, mean p set: 0.44879910349845886The modified gen p mean: 0.4493027925491333, gen p mean: -0.24088367819786072, mean p set: 0.4498290419578552
loss_pred:0.015240049920976162, decouple_loss:0.0017987124156206846
loss_pred:0.014830943197011948, decouple_loss:0.001868783263489604
WV_1_PC_1_EH_0_PS_30, loss: 0.015229981392621994, avg_mse: 0.02262030728161335
current test mse: 0.02262
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 4941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738978147506714, gen p mean: -0.24331913888454437, mean p set: 0.4479255974292755
loss_pred:0.014734353870153427, decouple_loss:0.001910416642203927
The modified gen p mean: 0.4461573660373688, gen p mean: -0.2413882464170456, mean p set: 0.44673389196395874
The modified gen p mean: 0.4485088586807251, gen p mean: -0.24571841955184937, mean p set: 0.44907623529434204
loss_pred:0.013996443711221218, decouple_loss:0.0017694433918222785
loss_pred:0.01486539002507925, decouple_loss:0.0019530773861333728
Iteration: 4942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795921444892883, gen p mean: -0.24709054827690125, mean p set: 0.448486864566803
loss_pred:0.014536170288920403, decouple_loss:0.0019524901872500777
The modified gen p mean: 0.4463752806186676, gen p mean: -0.24472935497760773, mean p set: 0.44694921374320984
loss_pred:0.014456663280725479, decouple_loss:0.002082361141219735
The modified gen p mean: 0.4484803080558777, gen p mean: -0.2480168342590332, mean p set: 0.4490543007850647
loss_pred:0.014589879661798477, decouple_loss:0.0020325167570263147
Iteration: 4943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445945143699646, gen p mean: -0.24111485481262207, mean p set: 0.44647401571273804
loss_pred:0.014475305564701557, decouple_loss:0.001867783023044467
The modified gen p mean: 0.4472510814666748, gen p mean: -0.24481092393398285, mean p set: 0.44782623648643494
loss_pred:0.014165935106575489, decouple_loss:0.0019166722195222974
The modified gen p mean: 0.44800877571105957, gen p mean: -0.24713176488876343, mean p set: 0.44858697056770325
loss_pred:0.014300188049674034, decouple_loss:0.0016670514596626163
Iteration: 4944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490010738372803, gen p mean: -0.25147566199302673, mean p set: 0.44952791929244995
loss_pred:0.014100844971835613, decouple_loss:0.002346671186387539
The modified gen p mean: 0.44750288128852844, gen p mean: -0.24673490226268768, mean p set: 0.44808098673820496
loss_pred:0.01448958832770586, decouple_loss:0.0017537787789478898
The modified gen p mean: 0.44749927520751953, gen p mean: -0.2505683898925781, mean p set: 0.448073148727417
loss_pred:0.014170849695801735, decouple_loss:0.0018192435381934047
Iteration: 4945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466736912727356, gen p mean: -0.245029017329216, mean p set: 0.44725558161735535
loss_pred:0.014292657375335693, decouple_loss:0.0016679262043908238
The modified gen p mean: 0.4456801414489746, gen p mean: -0.24366053938865662, mean p set: 0.44625577330589294
loss_pred:0.014258190989494324, decouple_loss:0.0017323493957519531
The modified gen p mean: 0.4470554292201996, gen p mean: -0.24242530763149261, mean p set: 0.44758522510528564
loss_pred:0.014382750727236271, decouple_loss:0.0015436223475262523
Iteration: 4946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653043150901794, gen p mean: -0.25254198908805847, mean p set: 0.4471011161804199
loss_pred:0.014351698569953442, decouple_loss:0.0017836826154962182
The modified gen p mean: 0.4455980062484741, gen p mean: -0.2503635585308075, mean p set: 0.4461652636528015
loss_pred:0.014357680454850197, decouple_loss:0.0018975205020979047
The modified gen p mean: 0.4468308389186859, gen p mean: -0.24585305154323578, mean p set: 0.4473566710948944
loss_pred:0.014012484811246395, decouple_loss:0.0016782628372311592
Iteration: 4947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661498069763184, gen p mean: -0.24796533584594727, mean p set: 0.4471926689147949
loss_pred:0.014254420064389706, decouple_loss:0.0019643097184598446
The modified gen p mean: 0.4459340572357178, gen p mean: -0.24396583437919617, mean p set: 0.44651132822036743
loss_pred:0.014916673302650452, decouple_loss:0.0021608793176710606
The modified gen p mean: 0.44621339440345764, gen p mean: -0.24513797461986542, mean p set: 0.4467402696609497
loss_pred:0.01477007195353508, decouple_loss:0.002262766007333994
Iteration: 4948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471261203289032, gen p mean: -0.24864766001701355, mean p set: 0.4476941227912903
loss_pred:0.014412968419492245, decouple_loss:0.0016590454615652561
The modified gen p mean: 0.44658780097961426, gen p mean: -0.251922070980072, mean p set: 0.44715940952301025
loss_pred:0.01445036195218563, decouple_loss:0.0017310453113168478
The modified gen p mean: 0.44812649488449097, gen p mean: -0.2518135607242584, mean p set: 0.44865259528160095
loss_pred:0.014047904871404171, decouple_loss:0.0017152748769149184
Iteration: 4949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716697931289673, gen p mean: -0.25168314576148987, mean p set: 0.4477439522743225
loss_pred:0.01373108010739088, decouple_loss:0.0019122236408293247
The modified gen p mean: 0.44572892785072327, gen p mean: -0.2431858479976654, mean p set: 0.44630685448646545
loss_pred:0.014477655291557312, decouple_loss:0.0017964827129617333
The modified gen p mean: 0.44637206196784973, gen p mean: -0.24877627193927765, mean p set: 0.44689324498176575
loss_pred:0.014667228795588017, decouple_loss:0.0019238190725445747
Iteration: 4950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480791389942169, gen p mean: -0.24624596536159515, mean p set: 0.4486584961414337
loss_pred:0.01394854485988617, decouple_loss:0.0016145121771842241
The modified gen p mean: 0.44519832730293274, gen p mean: -0.2497035413980484, mean p set: 0.4457697868347168
loss_pred:0.014234116300940514, decouple_loss:0.0016575496410951018
The modified gen p mean: 0.44642025232315063, gen p mean: -0.2424113154411316, mean p set: 0.44695523381233215
loss_pred:0.013922853395342827, decouple_loss:0.0017464658012613654
2023-04-28 01:41:06 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2419036477804184, mean p set: 0.4499112665653229
loss_pred:0.0151986014097929, decouple_loss:0.0018910960061475635
The modified gen p mean: 0.4482762813568115, gen p mean: -0.23941515386104584, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930949807167053, gen p mean: -0.24211953580379486, mean p set: 0.4498290419578552
loss_pred:0.0151451351121068, decouple_loss:0.0018908318597823381
loss_pred:0.01474679820239544, decouple_loss:0.001813862705603242
WV_1_PC_1_EH_0_PS_30, loss: 0.015123441815376282, avg_mse: 0.022415949031710625
current test mse: 0.022416
Iteration: 4951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487047791481018, gen p mean: -0.2463604211807251, mean p set: 0.44927704334259033
loss_pred:0.014148000627756119, decouple_loss:0.0021318644285202026
The modified gen p mean: 0.4461123049259186, gen p mean: -0.24028582870960236, mean p set: 0.44668781757354736
loss_pred:0.014667278155684471, decouple_loss:0.001833842834457755
The modified gen p mean: 0.44521063566207886, gen p mean: -0.2494625300168991, mean p set: 0.44573795795440674
loss_pred:0.014025582000613213, decouple_loss:0.0017122933641076088
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 4952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473494291305542, gen p mean: -0.2407776117324829, mean p set: 0.44787678122520447
loss_pred:0.014383000321686268, decouple_loss:0.0017476740758866072
The modified gen p mean: 0.4466719329357147, gen p mean: -0.24205264449119568, mean p set: 0.447246253490448
The modified gen p mean: 0.44811052083969116, gen p mean: -0.24561020731925964, mean p set: 0.44868341088294983
loss_pred:0.013707071542739868, decouple_loss:0.0016899957554414868
loss_pred:0.014101124368607998, decouple_loss:0.0017765802331268787
Iteration: 4953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791755080223083, gen p mean: -0.24893197417259216, mean p set: 0.4484470784664154
loss_pred:0.01422697864472866, decouple_loss:0.0014719889732077718
The modified gen p mean: 0.44600120186805725, gen p mean: -0.2429095059633255, mean p set: 0.4465752840042114
The modified gen p mean: 0.44771429896354675, gen p mean: -0.24775603413581848, mean p set: 0.4482913017272949
loss_pred:0.014444437809288502, decouple_loss:0.0016135338228195906
loss_pred:0.013956238515675068, decouple_loss:0.0015725622652098536
Iteration: 4954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588232040405273, gen p mean: -0.24433855712413788, mean p set: 0.4464118480682373
loss_pred:0.014739357866346836, decouple_loss:0.001838122378103435
The modified gen p mean: 0.44604218006134033, gen p mean: -0.24251513183116913, mean p set: 0.4466271698474884The modified gen p mean: 0.4465467631816864, gen p mean: -0.24614307284355164, mean p set: 0.44712045788764954
loss_pred:0.01406556461006403, decouple_loss:0.001960695954039693
loss_pred:0.013922346755862236, decouple_loss:0.0018111888784915209
Iteration: 4955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467955529689789, gen p mean: -0.24715708196163177, mean p set: 0.4473665952682495
loss_pred:0.014306554570794106, decouple_loss:0.001939602312631905
The modified gen p mean: 0.44659343361854553, gen p mean: -0.24721287190914154, mean p set: 0.4471711814403534
loss_pred:0.014188854955136776, decouple_loss:0.0019412195542827249
The modified gen p mean: 0.4472814202308655, gen p mean: -0.25397124886512756, mean p set: 0.4478095471858978
loss_pred:0.013997738249599934, decouple_loss:0.001807315624319017
Iteration: 4956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487365186214447, gen p mean: -0.24882380664348602, mean p set: 0.44931700825691223
loss_pred:0.014104250818490982, decouple_loss:0.002028718590736389
The modified gen p mean: 0.4487549066543579, gen p mean: -0.24887293577194214, mean p set: 0.44933852553367615
loss_pred:0.014771012589335442, decouple_loss:0.001936700544320047
The modified gen p mean: 0.44678032398223877, gen p mean: -0.2502899765968323, mean p set: 0.4473038911819458
loss_pred:0.01408255286514759, decouple_loss:0.0016168177826330066
Iteration: 4957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738107919692993, gen p mean: -0.24888238310813904, mean p set: 0.447951078414917
loss_pred:0.013992014341056347, decouple_loss:0.0016470701666548848
The modified gen p mean: 0.4457240104675293, gen p mean: -0.24390524625778198, mean p set: 0.44630563259124756
loss_pred:0.013812839984893799, decouple_loss:0.0018458239501342177
The modified gen p mean: 0.44686925411224365, gen p mean: -0.24667951464653015, mean p set: 0.4473998546600342
loss_pred:0.013774799183011055, decouple_loss:0.0015490412479266524
Iteration: 4958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461785852909088, gen p mean: -0.2466849982738495, mean p set: 0.44675159454345703
loss_pred:0.014163576997816563, decouple_loss:0.0016986987320706248
The modified gen p mean: 0.4474189877510071, gen p mean: -0.25315389037132263, mean p set: 0.44799599051475525
loss_pred:0.013645580969750881, decouple_loss:0.0017248690128326416
The modified gen p mean: 0.4474113881587982, gen p mean: -0.256064772605896, mean p set: 0.44794052839279175
loss_pred:0.013965563848614693, decouple_loss:0.001713113160803914
Iteration: 4959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472534656524658, gen p mean: -0.251696914434433, mean p set: 0.4478280544281006
The modified gen p mean: 0.44623005390167236, gen p mean: -0.24677947163581848, mean p set: 0.44680535793304443
loss_pred:0.014149501919746399, decouple_loss:0.0026352889835834503
loss_pred:0.013625514693558216, decouple_loss:0.002261119894683361
The modified gen p mean: 0.44625383615493774, gen p mean: -0.2482973039150238, mean p set: 0.4467838406562805
loss_pred:0.01377141010016203, decouple_loss:0.0021879002451896667
Iteration: 4960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820618629455566, gen p mean: -0.2505236864089966, mean p set: 0.4487825632095337
loss_pred:0.014157493598759174, decouple_loss:0.0018031978979706764
The modified gen p mean: 0.4455786347389221, gen p mean: -0.25715988874435425, mean p set: 0.4461599588394165
loss_pred:0.014484832994639874, decouple_loss:0.002065494190901518
The modified gen p mean: 0.44699981808662415, gen p mean: -0.25314590334892273, mean p set: 0.44752782583236694
loss_pred:0.014436643570661545, decouple_loss:0.0019875895231962204
2023-04-28 01:44:31 testing...
The modified gen p mean: 0.4482722282409668, gen p mean: -0.24853019416332245, mean p set: 0.44879910349845886
loss_pred:0.01517583429813385, decouple_loss:0.0017605253960937262
The modified gen p mean: 0.4493054747581482, gen p mean: -0.2513250410556793, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25074106454849243, mean p set: 0.4499112665653229loss_pred:0.014757047407329082, decouple_loss:0.0018591077532619238
loss_pred:0.01523775327950716, decouple_loss:0.00190540065523237
WV_1_PC_1_EH_0_PS_30, loss: 0.015148961916565895, avg_mse: 0.022451480850577354
current test mse: 0.022451
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 4961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491342604160309, gen p mean: -0.24602288007736206, mean p set: 0.44966015219688416
loss_pred:0.01333705149590969, decouple_loss:0.0023605553433299065
The modified gen p mean: 0.44712644815444946, gen p mean: -0.25464242696762085, mean p set: 0.4477013349533081
loss_pred:0.014251600950956345, decouple_loss:0.0020775096490979195
The modified gen p mean: 0.44711241126060486, gen p mean: -0.2518312633037567, mean p set: 0.44768473505973816
loss_pred:0.013921959325671196, decouple_loss:0.0023974941577762365
Iteration: 4962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447311133146286, gen p mean: -0.2553722560405731, mean p set: 0.44783034920692444
loss_pred:0.013911261223256588, decouple_loss:0.0019262197893112898
The modified gen p mean: 0.44780704379081726, gen p mean: -0.255254864692688, mean p set: 0.4483886957168579
The modified gen p mean: 0.44708847999572754, gen p mean: -0.2477509081363678, mean p set: 0.4476620554924011
loss_pred:0.013848057016730309, decouple_loss:0.0022259168326854706
loss_pred:0.013944020494818687, decouple_loss:0.0019746371544897556
Iteration: 4963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807231426239014, gen p mean: -0.24888421595096588, mean p set: 0.4486064314842224
loss_pred:0.013470721431076527, decouple_loss:0.001954813953489065
The modified gen p mean: 0.44704681634902954, gen p mean: -0.24715682864189148, mean p set: 0.44762441515922546
The modified gen p mean: 0.4468042850494385, gen p mean: -0.2520627975463867, mean p set: 0.44737890362739563
loss_pred:0.013579893857240677, decouple_loss:0.0022973150480538607
loss_pred:0.013862677849829197, decouple_loss:0.0018640641355887055
Iteration: 4964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465496242046356, gen p mean: -0.24792590737342834, mean p set: 0.4471273422241211
loss_pred:0.014236547984182835, decouple_loss:0.001970278099179268
The modified gen p mean: 0.44835853576660156, gen p mean: -0.23887254297733307, mean p set: 0.44888588786125183The modified gen p mean: 0.4481225609779358, gen p mean: -0.2437291443347931, mean p set: 0.44869139790534973
loss_pred:0.013424528762698174, decouple_loss:0.0022101521026343107
loss_pred:0.013479920104146004, decouple_loss:0.0018859460251405835
Iteration: 4965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483942985534668, gen p mean: -0.2413988709449768, mean p set: 0.44896969199180603
loss_pred:0.013687376864254475, decouple_loss:0.0020382190123200417
The modified gen p mean: 0.44712454080581665, gen p mean: -0.24450631439685822, mean p set: 0.4476523995399475The modified gen p mean: 0.44647541642189026, gen p mean: -0.24130956828594208, mean p set: 0.4470519721508026
loss_pred:0.014016034081578255, decouple_loss:0.0020302217453718185
loss_pred:0.01381602417677641, decouple_loss:0.00175097503233701
Iteration: 4966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471765160560608, gen p mean: -0.23700544238090515, mean p set: 0.4477570950984955
loss_pred:0.013804205693304539, decouple_loss:0.001983304973691702
The modified gen p mean: 0.4481315314769745, gen p mean: -0.23703068494796753, mean p set: 0.44866064190864563The modified gen p mean: 0.44815686345100403, gen p mean: -0.24658077955245972, mean p set: 0.4487426280975342
loss_pred:0.01383594423532486, decouple_loss:0.002070013200864196
loss_pred:0.013693999499082565, decouple_loss:0.0020098229870200157
Iteration: 4967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485713243484497, gen p mean: -0.24209171533584595, mean p set: 0.4491487443447113
loss_pred:0.013310312293469906, decouple_loss:0.0018833132926374674
The modified gen p mean: 0.4483935832977295, gen p mean: -0.24017925560474396, mean p set: 0.44897186756134033
loss_pred:0.013411852531135082, decouple_loss:0.001781107042916119
The modified gen p mean: 0.4470709562301636, gen p mean: -0.245338574051857, mean p set: 0.44759440422058105
loss_pred:0.013587170280516148, decouple_loss:0.0018686987459659576
Iteration: 4968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883668422698975, gen p mean: -0.24300026893615723, mean p set: 0.44941452145576477
loss_pred:0.013552719727158546, decouple_loss:0.0016717028338462114
The modified gen p mean: 0.44766488671302795, gen p mean: -0.2415623962879181, mean p set: 0.4481918513774872The modified gen p mean: 0.44773125648498535, gen p mean: -0.2413860559463501, mean p set: 0.44830429553985596
loss_pred:0.013330139219760895, decouple_loss:0.0017762234201654792
loss_pred:0.013440818525850773, decouple_loss:0.0018708751304075122
Iteration: 4969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866588711738586, gen p mean: -0.24449215829372406, mean p set: 0.44924864172935486
loss_pred:0.012759475037455559, decouple_loss:0.002131101442500949
The modified gen p mean: 0.447541207075119, gen p mean: -0.24771098792552948, mean p set: 0.4481172263622284
loss_pred:0.014056401327252388, decouple_loss:0.0018672706792131066
The modified gen p mean: 0.44803908467292786, gen p mean: -0.24779744446277618, mean p set: 0.4485662877559662
loss_pred:0.013506775721907616, decouple_loss:0.002030281350016594
Iteration: 4970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477299749851227, gen p mean: -0.24663342535495758, mean p set: 0.448304146528244
loss_pred:0.01354125700891018, decouple_loss:0.0017828824929893017
The modified gen p mean: 0.4473743140697479, gen p mean: -0.24396854639053345, mean p set: 0.44794946908950806
loss_pred:0.013561057858169079, decouple_loss:0.0019531301222741604
The modified gen p mean: 0.4470573663711548, gen p mean: -0.2500089108943939, mean p set: 0.44758692383766174
loss_pred:0.014467121101915836, decouple_loss:0.0020787925459444523
2023-04-28 01:48:35 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24318040907382965, mean p set: 0.4499112665653229
loss_pred:0.015423383563756943, decouple_loss:0.0021859081462025642
The modified gen p mean: 0.44929948449134827, gen p mean: -0.2439175248146057, mean p set: 0.4498290419578552
The modified gen p mean: 0.4482665956020355, gen p mean: -0.24123623967170715, mean p set: 0.44879910349845886
loss_pred:0.014924679882824421, decouple_loss:0.0022360999137163162
loss_pred:0.015344761312007904, decouple_loss:0.0020225094631314278
WV_1_PC_1_EH_0_PS_30, loss: 0.015338350087404251, avg_mse: 0.022738676518201828
current test mse: 0.022739
Iteration: 4971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794410467147827, gen p mean: -0.24336782097816467, mean p set: 0.4485197067260742
loss_pred:0.013311577029526234, decouple_loss:0.0017485767602920532
The modified gen p mean: 0.44808104634284973, gen p mean: -0.24379198253154755, mean p set: 0.4486024081707001
loss_pred:0.013505272567272186, decouple_loss:0.0017380003118887544
The modified gen p mean: 0.44790661334991455, gen p mean: -0.24132119119167328, mean p set: 0.448486864566803
loss_pred:0.013466114178299904, decouple_loss:0.001853056950494647
Iteration: 4972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791266322135925, gen p mean: -0.24565012753009796, mean p set: 0.448443204164505
loss_pred:0.013426094315946102, decouple_loss:0.0018228713888674974
The modified gen p mean: 0.4474196434020996, gen p mean: -0.24346520006656647, mean p set: 0.4479982852935791
The modified gen p mean: 0.44822606444358826, gen p mean: -0.24810580909252167, mean p set: 0.44880568981170654
loss_pred:0.013240741565823555, decouple_loss:0.0019557939376682043
loss_pred:0.013443266972899437, decouple_loss:0.0017685251077637076
Iteration: 4973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640499353408813, gen p mean: -0.24441812932491302, mean p set: 0.4469318985939026
loss_pred:0.014417021535336971, decouple_loss:0.0017238702857866883
The modified gen p mean: 0.44833284616470337, gen p mean: -0.24138996005058289, mean p set: 0.448910653591156
The modified gen p mean: 0.4475049674510956, gen p mean: -0.24373215436935425, mean p set: 0.448081910610199
loss_pred:0.0129934037104249, decouple_loss:0.0018659471534192562
loss_pred:0.014160854741930962, decouple_loss:0.0017803088994696736
Iteration: 4974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477115571498871, gen p mean: -0.24550685286521912, mean p set: 0.4482389986515045
loss_pred:0.013392351567745209, decouple_loss:0.0016322559677064419
The modified gen p mean: 0.4484821557998657, gen p mean: -0.24259087443351746, mean p set: 0.4490576982498169
The modified gen p mean: 0.44743362069129944, gen p mean: -0.24513083696365356, mean p set: 0.44800394773483276
loss_pred:0.01289824303239584, decouple_loss:0.001843487611040473
loss_pred:0.0137708755210042, decouple_loss:0.002009973395615816
Iteration: 4975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768455624580383, gen p mean: -0.2401532679796219, mean p set: 0.4482576549053192
loss_pred:0.013826820999383926, decouple_loss:0.001690011820755899
The modified gen p mean: 0.44747915863990784, gen p mean: -0.24275918304920197, mean p set: 0.44800183176994324The modified gen p mean: 0.4477325677871704, gen p mean: -0.24311277270317078, mean p set: 0.44830334186553955
loss_pred:0.013992663472890854, decouple_loss:0.0016316913533955812
loss_pred:0.013872337527573109, decouple_loss:0.001808889675885439
Iteration: 4976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802749156951904, gen p mean: -0.243907630443573, mean p set: 0.44860947132110596
loss_pred:0.013485003262758255, decouple_loss:0.0019422902259975672
The modified gen p mean: 0.447167307138443, gen p mean: -0.2437930405139923, mean p set: 0.4477039873600006The modified gen p mean: 0.44726553559303284, gen p mean: -0.24216783046722412, mean p set: 0.4478378891944885
loss_pred:0.013300535269081593, decouple_loss:0.0019527710974216461
loss_pred:0.013051248155534267, decouple_loss:0.0017586381873115897
Iteration: 4977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689133763313293, gen p mean: -0.24229465425014496, mean p set: 0.447422593832016
loss_pred:0.013758435845375061, decouple_loss:0.0017621899023652077
The modified gen p mean: 0.44680264592170715, gen p mean: -0.24199634790420532, mean p set: 0.4473787844181061The modified gen p mean: 0.4465711712837219, gen p mean: -0.24207095801830292, mean p set: 0.4471501410007477
loss_pred:0.013854584656655788, decouple_loss:0.0018940389854833484
loss_pred:0.013828410767018795, decouple_loss:0.0017917185323312879
Iteration: 4978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473193287849426, gen p mean: -0.24743658304214478, mean p set: 0.44789108633995056
loss_pred:0.014159080572426319, decouple_loss:0.002457177732139826
The modified gen p mean: 0.44796034693717957, gen p mean: -0.2500341534614563, mean p set: 0.44853144884109497
loss_pred:0.013481758534908295, decouple_loss:0.001953579019755125
The modified gen p mean: 0.4487951099872589, gen p mean: -0.24215646088123322, mean p set: 0.449325829744339
loss_pred:0.012623612768948078, decouple_loss:0.0019932796712964773
Iteration: 4979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470638930797577, gen p mean: -0.24523119628429413, mean p set: 0.4476398825645447
loss_pred:0.013759401626884937, decouple_loss:0.0019440599717199802
The modified gen p mean: 0.4467698633670807, gen p mean: -0.24697451293468475, mean p set: 0.4473388195037842
loss_pred:0.013462120667099953, decouple_loss:0.001941458322107792
The modified gen p mean: 0.4471769332885742, gen p mean: -0.24104344844818115, mean p set: 0.4477090537548065
loss_pred:0.013446008786559105, decouple_loss:0.0018995587015524507
Iteration: 4980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689998030662537, gen p mean: -0.24027064442634583, mean p set: 0.4474763870239258
loss_pred:0.013808299787342548, decouple_loss:0.0017916600918397307
The modified gen p mean: 0.4466378688812256, gen p mean: -0.2421707659959793, mean p set: 0.4472118318080902
loss_pred:0.01354983076453209, decouple_loss:0.001755160978063941
The modified gen p mean: 0.4471801817417145, gen p mean: -0.24048489332199097, mean p set: 0.44770386815071106
loss_pred:0.013804810121655464, decouple_loss:0.0017629520734772086
2023-04-28 01:51:59 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24109870195388794, mean p set: 0.4499112665653229
loss_pred:0.015392964705824852, decouple_loss:0.002278185449540615
The modified gen p mean: 0.4482707977294922, gen p mean: -0.23946960270404816, mean p set: 0.44879910349845886The modified gen p mean: 0.44930222630500793, gen p mean: -0.24167995154857635, mean p set: 0.4498290419578552
loss_pred:0.015363002195954323, decouple_loss:0.0022338523995131254
loss_pred:0.01493021659553051, decouple_loss:0.002344835316762328
WV_1_PC_1_EH_0_PS_30, loss: 0.015343009494245052, avg_mse: 0.022704901173710823
current test mse: 0.022705
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 4981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672396779060364, gen p mean: -0.24405089020729065, mean p set: 0.44725507497787476
loss_pred:0.014117429032921791, decouple_loss:0.0021397476084530354
The modified gen p mean: 0.44754770398139954, gen p mean: -0.24505789577960968, mean p set: 0.44812464714050293
loss_pred:0.014276625588536263, decouple_loss:0.002172138774767518
The modified gen p mean: 0.44848692417144775, gen p mean: -0.24046093225479126, mean p set: 0.4490656852722168
loss_pred:0.01409467589110136, decouple_loss:0.0018747407011687756
Iteration: 4982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475700259208679, gen p mean: -0.23661699891090393, mean p set: 0.44809815287590027
loss_pred:0.013553583063185215, decouple_loss:0.0018093527760356665
The modified gen p mean: 0.44799745082855225, gen p mean: -0.2424052506685257, mean p set: 0.4485728442668915
loss_pred:0.014352402649819851, decouple_loss:0.0017727833474054933
The modified gen p mean: 0.4474300742149353, gen p mean: -0.24511857330799103, mean p set: 0.4480046033859253
loss_pred:0.014133981429040432, decouple_loss:0.0016382383182644844
Iteration: 4983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459015130996704, gen p mean: -0.2454935610294342, mean p set: 0.44642776250839233
loss_pred:0.014104669913649559, decouple_loss:0.0018864392768591642
The modified gen p mean: 0.4482886791229248, gen p mean: -0.24700625240802765, mean p set: 0.4488631784915924The modified gen p mean: 0.44721001386642456, gen p mean: -0.24448856711387634, mean p set: 0.4477818012237549
loss_pred:0.014101116918027401, decouple_loss:0.0018156991573050618
loss_pred:0.013906699605286121, decouple_loss:0.00200717244297266
Iteration: 4984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475065767765045, gen p mean: -0.23752053081989288, mean p set: 0.44803258776664734
loss_pred:0.013838594779372215, decouple_loss:0.0019686443265527487
The modified gen p mean: 0.44666367769241333, gen p mean: -0.24429570138454437, mean p set: 0.44724181294441223
loss_pred:0.013720178976655006, decouple_loss:0.0019049453549087048
The modified gen p mean: 0.4478382170200348, gen p mean: -0.24397441744804382, mean p set: 0.44841933250427246
loss_pred:0.014864281751215458, decouple_loss:0.0019889166578650475
Iteration: 4985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462597072124481, gen p mean: -0.24874992668628693, mean p set: 0.4468306601047516
loss_pred:0.013200401328504086, decouple_loss:0.001766000292263925
The modified gen p mean: 0.44831398129463196, gen p mean: -0.2461821734905243, mean p set: 0.44888749718666077The modified gen p mean: 0.44637855887413025, gen p mean: -0.2489771842956543, mean p set: 0.44691428542137146
loss_pred:0.013627496547996998, decouple_loss:0.0016436990117654204
loss_pred:0.014414849691092968, decouple_loss:0.0017518529202789068
Iteration: 4986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480989873409271, gen p mean: -0.25100162625312805, mean p set: 0.4486749470233917
loss_pred:0.014277846552431583, decouple_loss:0.001999805448576808
The modified gen p mean: 0.44744738936424255, gen p mean: -0.24444951117038727, mean p set: 0.44802215695381165The modified gen p mean: 0.44720396399497986, gen p mean: -0.2448783963918686, mean p set: 0.4477352201938629
loss_pred:0.01386367529630661, decouple_loss:0.0019440220203250647
loss_pred:0.0145375095307827, decouple_loss:0.0020593118388205767
Iteration: 4987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447997123003006, gen p mean: -0.24235957860946655, mean p set: 0.4485739767551422
loss_pred:0.01381466444581747, decouple_loss:0.0019354010000824928
The modified gen p mean: 0.44744962453842163, gen p mean: -0.24273070693016052, mean p set: 0.44797828793525696The modified gen p mean: 0.44689229130744934, gen p mean: -0.24611933529376984, mean p set: 0.44746458530426025
loss_pred:0.014015743508934975, decouple_loss:0.0018789744935929775
loss_pred:0.014343236573040485, decouple_loss:0.0019862635526806116
Iteration: 4988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762855768203735, gen p mean: -0.24649763107299805, mean p set: 0.44820475578308105
loss_pred:0.014440257102251053, decouple_loss:0.0018066019983962178
The modified gen p mean: 0.44812706112861633, gen p mean: -0.23824548721313477, mean p set: 0.4487118422985077
loss_pred:0.013820593245327473, decouple_loss:0.0016005212673917413
The modified gen p mean: 0.4477485716342926, gen p mean: -0.2362237572669983, mean p set: 0.4482816159725189
loss_pred:0.014138748869299889, decouple_loss:0.001636562985368073
Iteration: 4989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478050768375397, gen p mean: -0.23682920634746552, mean p set: 0.44838324189186096
loss_pred:0.014312355779111385, decouple_loss:0.0017061727121472359
The modified gen p mean: 0.4479730725288391, gen p mean: -0.2447413057088852, mean p set: 0.4485515058040619The modified gen p mean: 0.44745010137557983, gen p mean: -0.24214118719100952, mean p set: 0.44797375798225403
loss_pred:0.014772647060453892, decouple_loss:0.0019173723412677646
loss_pred:0.015003099106252193, decouple_loss:0.001747730653733015
Iteration: 4990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729816913604736, gen p mean: -0.2332969754934311, mean p set: 0.4478640854358673
loss_pred:0.01346479170024395, decouple_loss:0.0016231603221967816
The modified gen p mean: 0.44661086797714233, gen p mean: -0.23814527690410614, mean p set: 0.44719401001930237
loss_pred:0.014628699980676174, decouple_loss:0.0017122641438618302
The modified gen p mean: 0.4477517008781433, gen p mean: -0.2376946657896042, mean p set: 0.44827502965927124
loss_pred:0.014130583964288235, decouple_loss:0.0016870767576619983
2023-04-28 01:56:05 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2411225587129593, mean p set: 0.4499112665653229
loss_pred:0.01530995313078165, decouple_loss:0.0019558256026357412
The modified gen p mean: 0.44827112555503845, gen p mean: -0.23933298885822296, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930338859558105, gen p mean: -0.24177613854408264, mean p set: 0.4498290419578552
loss_pred:0.01531622651964426, decouple_loss:0.0019191440660506487
loss_pred:0.01489091757684946, decouple_loss:0.0020305111538618803
WV_1_PC_1_EH_0_PS_30, loss: 0.015270790085196495, avg_mse: 0.0225946344435215
current test mse: 0.022595
Iteration: 4991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447150319814682, gen p mean: -0.23974236845970154, mean p set: 0.4477280378341675
loss_pred:0.01411416195333004, decouple_loss:0.0016525359824299812
The modified gen p mean: 0.4483775496482849, gen p mean: -0.2385796159505844, mean p set: 0.448952317237854
loss_pred:0.013903790153563023, decouple_loss:0.0015789609169587493
The modified gen p mean: 0.4465562403202057, gen p mean: -0.24162907898426056, mean p set: 0.4470813572406769
loss_pred:0.014193028211593628, decouple_loss:0.0017571175703778863
Iteration: 4992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727623462677, gen p mean: -0.2458297312259674, mean p set: 0.4478125274181366
loss_pred:0.013726872391998768, decouple_loss:0.0017318811733275652
The modified gen p mean: 0.44827502965927124, gen p mean: -0.24494649469852448, mean p set: 0.44884711503982544
loss_pred:0.014560849405825138, decouple_loss:0.0018032712396234274
The modified gen p mean: 0.44758766889572144, gen p mean: -0.24446724355220795, mean p set: 0.4481656849384308
loss_pred:0.014152701944112778, decouple_loss:0.001633401494473219
Iteration: 4993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44608739018440247, gen p mean: -0.246279776096344, mean p set: 0.44661951065063477
loss_pred:0.014364566653966904, decouple_loss:0.0018159528262913227
The modified gen p mean: 0.44751855731010437, gen p mean: -0.2432737648487091, mean p set: 0.44809025526046753
loss_pred:0.013890594244003296, decouple_loss:0.0016187798464670777
The modified gen p mean: 0.4475896656513214, gen p mean: -0.24440917372703552, mean p set: 0.44816744327545166
loss_pred:0.014390493743121624, decouple_loss:0.0015585182700306177
Iteration: 4994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794270396232605, gen p mean: -0.2394857108592987, mean p set: 0.4484681785106659
loss_pred:0.014326364733278751, decouple_loss:0.00165995629504323
The modified gen p mean: 0.4471496641635895, gen p mean: -0.2439776211977005, mean p set: 0.447729229927063
loss_pred:0.014009441249072552, decouple_loss:0.0017283017514273524
The modified gen p mean: 0.4464336335659027, gen p mean: -0.24473759531974792, mean p set: 0.4470071494579315
loss_pred:0.013983034528791904, decouple_loss:0.001525336061604321
Iteration: 4995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652271270751953, gen p mean: -0.23790910840034485, mean p set: 0.44709837436676025
loss_pred:0.014546139165759087, decouple_loss:0.0017437151400372386
The modified gen p mean: 0.44761571288108826, gen p mean: -0.23727929592132568, mean p set: 0.4481956660747528
loss_pred:0.014186849817633629, decouple_loss:0.001778280595317483
The modified gen p mean: 0.44622623920440674, gen p mean: -0.24161386489868164, mean p set: 0.4467509686946869
loss_pred:0.014318419620394707, decouple_loss:0.002231061924248934
Iteration: 4996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471302628517151, gen p mean: -0.23566097021102905, mean p set: 0.4477040469646454
loss_pred:0.013876793906092644, decouple_loss:0.0018994467100128531
The modified gen p mean: 0.4472205936908722, gen p mean: -0.24051395058631897, mean p set: 0.4478060305118561
loss_pred:0.01406711433082819, decouple_loss:0.001701094675809145
The modified gen p mean: 0.4478456676006317, gen p mean: -0.2352903038263321, mean p set: 0.44837021827697754
loss_pred:0.014060377143323421, decouple_loss:0.0021328357979655266
Iteration: 4997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702208042144775, gen p mean: -0.2343796342611313, mean p set: 0.44759562611579895
loss_pred:0.013859577476978302, decouple_loss:0.001883761608041823
The modified gen p mean: 0.4472666382789612, gen p mean: -0.23633478581905365, mean p set: 0.44784313440322876
loss_pred:0.014404010958969593, decouple_loss:0.0016572738531976938
The modified gen p mean: 0.4476843774318695, gen p mean: -0.23548287153244019, mean p set: 0.4482135772705078
loss_pred:0.013865998946130276, decouple_loss:0.0016168064903467894
Iteration: 4998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478425681591034, gen p mean: -0.23720048367977142, mean p set: 0.4484192430973053
loss_pred:0.014532153494656086, decouple_loss:0.001555208582431078
The modified gen p mean: 0.4460410177707672, gen p mean: -0.2372060865163803, mean p set: 0.4466179311275482
loss_pred:0.013980298303067684, decouple_loss:0.002162122167646885
The modified gen p mean: 0.4481141269207001, gen p mean: -0.23711083829402924, mean p set: 0.4486413896083832
loss_pred:0.013548151589930058, decouple_loss:0.001866307808086276
Iteration: 4999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469911754131317, gen p mean: -0.24325479567050934, mean p set: 0.44756636023521423
loss_pred:0.013992760330438614, decouple_loss:0.0016223426209762692
The modified gen p mean: 0.44595685601234436, gen p mean: -0.24203115701675415, mean p set: 0.4465283155441284
loss_pred:0.014453351497650146, decouple_loss:0.0018344956915825605
The modified gen p mean: 0.44741788506507874, gen p mean: -0.23941029608249664, mean p set: 0.4479471743106842
loss_pred:0.014311791397631168, decouple_loss:0.0018224709201604128
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673746824264526, gen p mean: -0.24195072054862976, mean p set: 0.4473138451576233
loss_pred:0.014197330921888351, decouple_loss:0.0016559342620894313
The modified gen p mean: 0.44708284735679626, gen p mean: -0.23571906983852386, mean p set: 0.44765913486480713
loss_pred:0.014043517410755157, decouple_loss:0.0019580351654440165
The modified gen p mean: 0.44726115465164185, gen p mean: -0.23710039258003235, mean p set: 0.44779056310653687
loss_pred:0.013568577356636524, decouple_loss:0.001821727491915226
2023-04-28 01:59:30 itr: 5000
training loss: [0.01365966 0.01428013 0.01414142]
2023-04-28 01:59:30 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23681652545928955, mean p set: 0.4499112665653229
loss_pred:0.015319183468818665, decouple_loss:0.001661611138843
The modified gen p mean: 0.44827181100845337, gen p mean: -0.23459576070308685, mean p set: 0.44879910349845886
loss_pred:0.015273024328052998, decouple_loss:0.001768014277331531
The modified gen p mean: 0.4492986798286438, gen p mean: -0.23731672763824463, mean p set: 0.4498290419578552
loss_pred:0.014868021942675114, decouple_loss:0.001863375073298812
WV_1_PC_1_EH_0_PS_30, loss: 0.015241626650094986, avg_mse: 0.022634197026491165
current test mse: 0.022634
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 5001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904807209968567, gen p mean: -0.24232618510723114, mean p set: 0.44957879185676575
loss_pred:0.013959004543721676, decouple_loss:0.0017123622819781303
The modified gen p mean: 0.44973284006118774, gen p mean: -0.2368113100528717, mean p set: 0.45031026005744934
loss_pred:0.014300922863185406, decouple_loss:0.0015685738762840629
The modified gen p mean: 0.44687899947166443, gen p mean: -0.240027517080307, mean p set: 0.44745954871177673
loss_pred:0.014325260184705257, decouple_loss:0.0017159368144348264
Iteration: 5002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687509536743164, gen p mean: -0.24153055250644684, mean p set: 0.44740915298461914
loss_pred:0.014497091062366962, decouple_loss:0.001723802532069385
The modified gen p mean: 0.44842249155044556, gen p mean: -0.2373654693365097, mean p set: 0.4489942789077759
loss_pred:0.014028275385499, decouple_loss:0.001667323987931013
The modified gen p mean: 0.44679078459739685, gen p mean: -0.23572896420955658, mean p set: 0.44736772775650024
loss_pred:0.014019571244716644, decouple_loss:0.001828791224397719
Iteration: 5003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479840397834778, gen p mean: -0.2344835251569748, mean p set: 0.44851356744766235
loss_pred:0.014345887117087841, decouple_loss:0.0017944558057934046
The modified gen p mean: 0.44743451476097107, gen p mean: -0.23974408209323883, mean p set: 0.44801008701324463
loss_pred:0.014224216341972351, decouple_loss:0.001903196214698255
The modified gen p mean: 0.4475087523460388, gen p mean: -0.23560580611228943, mean p set: 0.448087215423584
loss_pred:0.014147443696856499, decouple_loss:0.0020584184676408768
Iteration: 5004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757020473480225, gen p mean: -0.23908795416355133, mean p set: 0.4480946362018585
loss_pred:0.014421481639146805, decouple_loss:0.0016508796252310276
The modified gen p mean: 0.4471856951713562, gen p mean: -0.23730865120887756, mean p set: 0.44775891304016113
loss_pred:0.014504864811897278, decouple_loss:0.0019663365092128515
The modified gen p mean: 0.44757798314094543, gen p mean: -0.23512941598892212, mean p set: 0.4481530487537384
loss_pred:0.013917457312345505, decouple_loss:0.0015855617821216583
Iteration: 5005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484516680240631, gen p mean: -0.23032543063163757, mean p set: 0.44902777671813965
loss_pred:0.014016593806445599, decouple_loss:0.002039195504039526
The modified gen p mean: 0.44708824157714844, gen p mean: -0.23993337154388428, mean p set: 0.44761988520622253The modified gen p mean: 0.44792282581329346, gen p mean: -0.2358454316854477, mean p set: 0.4484986364841461
loss_pred:0.013976932503283024, decouple_loss:0.0020239297300577164
loss_pred:0.014411740936338902, decouple_loss:0.0021249866113066673
Iteration: 5006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453902542591095, gen p mean: -0.2374550700187683, mean p set: 0.445966511964798
loss_pred:0.014539503492414951, decouple_loss:0.0019441931508481503
The modified gen p mean: 0.4473417401313782, gen p mean: -0.2377239316701889, mean p set: 0.4478735327720642The modified gen p mean: 0.44733572006225586, gen p mean: -0.23196884989738464, mean p set: 0.4479130506515503
loss_pred:0.01398536004126072, decouple_loss:0.0017485881689935923
loss_pred:0.014427931979298592, decouple_loss:0.0016369610093533993
Iteration: 5007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484296441078186, gen p mean: -0.23711124062538147, mean p set: 0.44900041818618774
loss_pred:0.013871531933546066, decouple_loss:0.002459574257954955
The modified gen p mean: 0.4477507472038269, gen p mean: -0.23314650356769562, mean p set: 0.44827497005462646The modified gen p mean: 0.4482998549938202, gen p mean: -0.23636288940906525, mean p set: 0.44887441396713257
loss_pred:0.014061097986996174, decouple_loss:0.002051685703918338
loss_pred:0.013719730079174042, decouple_loss:0.002231293823570013
Iteration: 5008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44614091515541077, gen p mean: -0.24237443506717682, mean p set: 0.44671642780303955
loss_pred:0.01440453715622425, decouple_loss:0.0016852039843797684
The modified gen p mean: 0.44821563363075256, gen p mean: -0.24013163149356842, mean p set: 0.4488007128238678
loss_pred:0.014174013398587704, decouple_loss:0.0016586348647251725
The modified gen p mean: 0.44604331254959106, gen p mean: -0.2404763549566269, mean p set: 0.44656795263290405
loss_pred:0.014451014809310436, decouple_loss:0.001636475557461381
Iteration: 5009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475119113922119, gen p mean: -0.24086253345012665, mean p set: 0.44808489084243774
loss_pred:0.014080939814448357, decouple_loss:0.0017765809316188097
The modified gen p mean: 0.4465236961841583, gen p mean: -0.24430759251117706, mean p set: 0.44709834456443787
loss_pred:0.014093433506786823, decouple_loss:0.0017599574057385325
The modified gen p mean: 0.44731417298316956, gen p mean: -0.24140627682209015, mean p set: 0.44784191250801086
loss_pred:0.014149317517876625, decouple_loss:0.001785664469935
Iteration: 5010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934606552124023, gen p mean: -0.23821045458316803, mean p set: 0.4499136209487915
loss_pred:0.014277246780693531, decouple_loss:0.0018540131859481335
The modified gen p mean: 0.4469836950302124, gen p mean: -0.24127981066703796, mean p set: 0.447562575340271
loss_pred:0.01429336704313755, decouple_loss:0.002015941310673952
The modified gen p mean: 0.4481644928455353, gen p mean: -0.24220547080039978, mean p set: 0.44869065284729004
loss_pred:0.014019441790878773, decouple_loss:0.001833462854847312
2023-04-28 02:03:35 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.237855464220047, mean p set: 0.4499112665653229
loss_pred:0.015276639722287655, decouple_loss:0.0017428856808692217
The modified gen p mean: 0.4493007957935333, gen p mean: -0.23840966820716858, mean p set: 0.4498290419578552The modified gen p mean: 0.44826629757881165, gen p mean: -0.235688716173172, mean p set: 0.44879910349845886
loss_pred:0.014842253178358078, decouple_loss:0.001634983578696847loss_pred:0.01523953303694725, decouple_loss:0.0016181974206119776
WV_1_PC_1_EH_0_PS_30, loss: 0.01520274393260479, avg_mse: 0.022555619478225708
current test mse: 0.022556
Iteration: 5011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466998875141144, gen p mean: -0.24391581118106842, mean p set: 0.44727712869644165
loss_pred:0.013801364228129387, decouple_loss:0.001637659384869039
The modified gen p mean: 0.4486057162284851, gen p mean: -0.24242152273654938, mean p set: 0.449184387922287
loss_pred:0.013846345245838165, decouple_loss:0.0017913234187290072
The modified gen p mean: 0.44678816199302673, gen p mean: -0.23703370988368988, mean p set: 0.4473150670528412
loss_pred:0.014573747292160988, decouple_loss:0.0017649004003033042
Iteration: 5012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469425678253174, gen p mean: -0.23891545832157135, mean p set: 0.4474617540836334
loss_pred:0.014463906176388264, decouple_loss:0.001601466559804976
The modified gen p mean: 0.44709935784339905, gen p mean: -0.24215275049209595, mean p set: 0.44767752289772034
loss_pred:0.014098326675593853, decouple_loss:0.0017395415343344212
The modified gen p mean: 0.4470369815826416, gen p mean: -0.23970921337604523, mean p set: 0.4476076066493988
loss_pred:0.014082344248890877, decouple_loss:0.0017216259147971869
Iteration: 5013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487456679344177, gen p mean: -0.23152565956115723, mean p set: 0.4492754638195038
loss_pred:0.014350651763379574, decouple_loss:0.0017163250595331192
The modified gen p mean: 0.4473974406719208, gen p mean: -0.2372489869594574, mean p set: 0.4479758143424988The modified gen p mean: 0.44920992851257324, gen p mean: -0.23893359303474426, mean p set: 0.449787974357605
loss_pred:0.013563958927989006, decouple_loss:0.001844806014560163
loss_pred:0.013867909088730812, decouple_loss:0.0017976288218051195
Iteration: 5014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723933935165405, gen p mean: -0.23525570333003998, mean p set: 0.4477689266204834
loss_pred:0.014184714294970036, decouple_loss:0.0016922582872211933
The modified gen p mean: 0.4479319453239441, gen p mean: -0.23506487905979156, mean p set: 0.4485120475292206The modified gen p mean: 0.4476849138736725, gen p mean: -0.23876145482063293, mean p set: 0.44826194643974304
loss_pred:0.014637003652751446, decouple_loss:0.00183931365609169
loss_pred:0.014333543367683887, decouple_loss:0.0016358749708160758
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476322531700134, gen p mean: -0.24005791544914246, mean p set: 0.44821611046791077
loss_pred:0.014480870217084885, decouple_loss:0.0019136150367558002
The modified gen p mean: 0.44743672013282776, gen p mean: -0.23577050864696503, mean p set: 0.44801437854766846
loss_pred:0.014005775563418865, decouple_loss:0.0019870453979820013
The modified gen p mean: 0.4485695958137512, gen p mean: -0.23820389807224274, mean p set: 0.44909462332725525
loss_pred:0.01386673841625452, decouple_loss:0.002020235639065504
Iteration: 5016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827505946159363, gen p mean: -0.2488485425710678, mean p set: 0.4488462209701538
loss_pred:0.014143286272883415, decouple_loss:0.0018795315409079194
The modified gen p mean: 0.4460897445678711, gen p mean: -0.24962449073791504, mean p set: 0.4466274678707123The modified gen p mean: 0.44772064685821533, gen p mean: -0.2457701861858368, mean p set: 0.4482978880405426
loss_pred:0.014350864104926586, decouple_loss:0.001732962322421372
loss_pred:0.014514327049255371, decouple_loss:0.001671015052124858
Iteration: 5017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482216238975525, gen p mean: -0.24210526049137115, mean p set: 0.4487912356853485
loss_pred:0.014388667419552803, decouple_loss:0.0018651417922228575
The modified gen p mean: 0.44774970412254333, gen p mean: -0.24052420258522034, mean p set: 0.4483223557472229
loss_pred:0.013886146247386932, decouple_loss:0.0017609763890504837
The modified gen p mean: 0.44676151871681213, gen p mean: -0.24528293311595917, mean p set: 0.4472885727882385
loss_pred:0.014866886660456657, decouple_loss:0.002028444316238165
Iteration: 5018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44548898935317993, gen p mean: -0.248280867934227, mean p set: 0.44606801867485046
loss_pred:0.014257230795919895, decouple_loss:0.0017247078940272331
The modified gen p mean: 0.4460649788379669, gen p mean: -0.2472904473543167, mean p set: 0.4466353952884674
loss_pred:0.014038526453077793, decouple_loss:0.0015614423900842667
The modified gen p mean: 0.44723013043403625, gen p mean: -0.24275659024715424, mean p set: 0.44775715470314026
loss_pred:0.014245071448385715, decouple_loss:0.0015949355438351631
Iteration: 5019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463292956352234, gen p mean: -0.24577972292900085, mean p set: 0.4469049572944641
The modified gen p mean: 0.44731318950653076, gen p mean: -0.2399710714817047, mean p set: 0.44789430499076843
loss_pred:0.01409317459911108, decouple_loss:0.0019010764081031084
loss_pred:0.014152556657791138, decouple_loss:0.0018773175543174148
The modified gen p mean: 0.4471154510974884, gen p mean: -0.24034668505191803, mean p set: 0.447646826505661
loss_pred:0.014119956642389297, decouple_loss:0.001741992891766131
Iteration: 5020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472246468067169, gen p mean: -0.24326810240745544, mean p set: 0.44780421257019043
loss_pred:0.013738456182181835, decouple_loss:0.0014912578044459224
The modified gen p mean: 0.4492985010147095, gen p mean: -0.24323606491088867, mean p set: 0.449869304895401
loss_pred:0.014151263050734997, decouple_loss:0.001609752420336008
The modified gen p mean: 0.4461085796356201, gen p mean: -0.2474597543478012, mean p set: 0.4466356933116913
loss_pred:0.014105726964771748, decouple_loss:0.0016831007087603211
2023-04-28 02:06:58 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24676920473575592, mean p set: 0.4499112665653229
loss_pred:0.01533230859786272, decouple_loss:0.0019621283281594515
The modified gen p mean: 0.44827544689178467, gen p mean: -0.2446458786725998, mean p set: 0.44879910349845886
loss_pred:0.015275313518941402, decouple_loss:0.002042364561930299
The modified gen p mean: 0.44929563999176025, gen p mean: -0.2471153438091278, mean p set: 0.4498290419578552
loss_pred:0.014886914752423763, decouple_loss:0.0021020506974309683
WV_1_PC_1_EH_0_PS_30, loss: 0.01526662241667509, avg_mse: 0.022577393800020218
current test mse: 0.022577
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 5021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749805331230164, gen p mean: -0.24565951526165009, mean p set: 0.4480248689651489
loss_pred:0.013861129060387611, decouple_loss:0.0017889486625790596
The modified gen p mean: 0.44747042655944824, gen p mean: -0.24586500227451324, mean p set: 0.4480433166027069
loss_pred:0.01348799653351307, decouple_loss:0.0024082078598439693
The modified gen p mean: 0.4476650357246399, gen p mean: -0.24722719192504883, mean p set: 0.44823944568634033
loss_pred:0.014248897321522236, decouple_loss:0.0025099427439272404
Iteration: 5022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722387194633484, gen p mean: -0.24710991978645325, mean p set: 0.4477475583553314
loss_pred:0.013593249022960663, decouple_loss:0.002236439846456051
The modified gen p mean: 0.44749417901039124, gen p mean: -0.2516288459300995, mean p set: 0.44806867837905884
loss_pred:0.014059009961783886, decouple_loss:0.0017431238666176796
The modified gen p mean: 0.44788435101509094, gen p mean: -0.2507989704608917, mean p set: 0.44846081733703613
loss_pred:0.013689719140529633, decouple_loss:0.0022488718386739492
Iteration: 5023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470934569835663, gen p mean: -0.2536028027534485, mean p set: 0.44761648774147034
loss_pred:0.013639877550303936, decouple_loss:0.0017974580405279994
The modified gen p mean: 0.44817546010017395, gen p mean: -0.2489955872297287, mean p set: 0.4487457573413849
loss_pred:0.014186165295541286, decouple_loss:0.0018685561371967196
The modified gen p mean: 0.4471263587474823, gen p mean: -0.25032493472099304, mean p set: 0.44770246744155884
loss_pred:0.013714511878788471, decouple_loss:0.001927818637341261
Iteration: 5024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879889488220215, gen p mean: -0.24907585978507996, mean p set: 0.4493274986743927
loss_pred:0.014121480286121368, decouple_loss:0.0022144699469208717
The modified gen p mean: 0.4480685293674469, gen p mean: -0.24294091761112213, mean p set: 0.4486466944217682
loss_pred:0.013958783820271492, decouple_loss:0.0019126698607578874
The modified gen p mean: 0.4471415579319, gen p mean: -0.24992087483406067, mean p set: 0.44771865010261536
loss_pred:0.013437299989163876, decouple_loss:0.0018987340154126287
Iteration: 5025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460754990577698, gen p mean: -0.24495862424373627, mean p set: 0.44665300846099854
loss_pred:0.014108049683272839, decouple_loss:0.0017290308605879545
The modified gen p mean: 0.4469674825668335, gen p mean: -0.24877499043941498, mean p set: 0.44754406809806824The modified gen p mean: 0.44653600454330444, gen p mean: -0.24611987173557281, mean p set: 0.44706112146377563
loss_pred:0.013715171255171299, decouple_loss:0.0019729759078472853
loss_pred:0.01408166904002428, decouple_loss:0.001676016952842474
Iteration: 5026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671469926834106, gen p mean: -0.2447647601366043, mean p set: 0.4472944438457489
loss_pred:0.013841535896062851, decouple_loss:0.0019066020613536239
The modified gen p mean: 0.4476719796657562, gen p mean: -0.24312430620193481, mean p set: 0.4482089579105377The modified gen p mean: 0.44756293296813965, gen p mean: -0.24687743186950684, mean p set: 0.4481387734413147
loss_pred:0.013758079148828983, decouple_loss:0.0022105108946561813
loss_pred:0.013975693844258785, decouple_loss:0.0018709527794271708
Iteration: 5027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674384593963623, gen p mean: -0.23721662163734436, mean p set: 0.44731831550598145
loss_pred:0.014136362820863724, decouple_loss:0.0016949163982644677
The modified gen p mean: 0.44716575741767883, gen p mean: -0.24205735325813293, mean p set: 0.4477413594722748The modified gen p mean: 0.4478333294391632, gen p mean: -0.23736344277858734, mean p set: 0.4483618438243866
loss_pred:0.013914942741394043, decouple_loss:0.0019047358073294163
loss_pred:0.013662264682352543, decouple_loss:0.0017678153235465288
Iteration: 5028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771623611450195, gen p mean: -0.2442992925643921, mean p set: 0.4482864737510681
loss_pred:0.013837413862347603, decouple_loss:0.001977769425138831
The modified gen p mean: 0.44691696763038635, gen p mean: -0.24592643976211548, mean p set: 0.44745007157325745
loss_pred:0.013400835916399956, decouple_loss:0.0021812047343701124
The modified gen p mean: 0.4477403461933136, gen p mean: -0.24394568800926208, mean p set: 0.44831904768943787
loss_pred:0.014047009870409966, decouple_loss:0.0019267742754891515
Iteration: 5029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724613428115845, gen p mean: -0.24661694467067719, mean p set: 0.4478244483470917
loss_pred:0.01374813262373209, decouple_loss:0.0017820538487285376
The modified gen p mean: 0.4476664066314697, gen p mean: -0.24848099052906036, mean p set: 0.4482399523258209
loss_pred:0.014124929904937744, decouple_loss:0.0018855637172237039
The modified gen p mean: 0.4474809765815735, gen p mean: -0.24968743324279785, mean p set: 0.4480080008506775
loss_pred:0.014178558252751827, decouple_loss:0.0018005205783993006
Iteration: 5030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735631346702576, gen p mean: -0.25074782967567444, mean p set: 0.4479289650917053
loss_pred:0.014291515573859215, decouple_loss:0.0017585704335942864
The modified gen p mean: 0.4489099085330963, gen p mean: -0.24729041755199432, mean p set: 0.4494889974594116
loss_pred:0.013317838311195374, decouple_loss:0.001727511640638113
The modified gen p mean: 0.4478294551372528, gen p mean: -0.24763070046901703, mean p set: 0.4483511745929718
loss_pred:0.013651796616613865, decouple_loss:0.0017012432217597961
2023-04-28 02:11:02 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2501908838748932, mean p set: 0.4499112665653229
loss_pred:0.01544165425002575, decouple_loss:0.0019411534303799272
The modified gen p mean: 0.4482634365558624, gen p mean: -0.24777020514011383, mean p set: 0.44879910349845886
loss_pred:0.015391705557703972, decouple_loss:0.0019409183878451586
The modified gen p mean: 0.44929757714271545, gen p mean: -0.2507360279560089, mean p set: 0.4498290419578552
loss_pred:0.014980606734752655, decouple_loss:0.001819552038796246
WV_1_PC_1_EH_0_PS_30, loss: 0.01536634936928749, avg_mse: 0.02279410883784294
current test mse: 0.022794
Iteration: 5031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863688945770264, gen p mean: -0.2435341477394104, mean p set: 0.4492107927799225
loss_pred:0.01397294458001852, decouple_loss:0.0018618764588609338
The modified gen p mean: 0.44685277342796326, gen p mean: -0.25371742248535156, mean p set: 0.44742754101753235
loss_pred:0.013248114846646786, decouple_loss:0.0018999844323843718
The modified gen p mean: 0.44739460945129395, gen p mean: -0.25126296281814575, mean p set: 0.44792893528938293
loss_pred:0.014291131868958473, decouple_loss:0.0016870260005816817
Iteration: 5032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664672017097473, gen p mean: -0.24676285684108734, mean p set: 0.4471800923347473
loss_pred:0.014333552680909634, decouple_loss:0.0015542752807959914
The modified gen p mean: 0.4474429786205292, gen p mean: -0.24708984792232513, mean p set: 0.44802039861679077
loss_pred:0.013509468175470829, decouple_loss:0.001601083786226809
The modified gen p mean: 0.4471674859523773, gen p mean: -0.2482195645570755, mean p set: 0.4477456510066986
loss_pred:0.014139099046587944, decouple_loss:0.0015292827738448977
Iteration: 5033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476872384548187, gen p mean: -0.2420017272233963, mean p set: 0.44821682572364807
loss_pred:0.014061535708606243, decouple_loss:0.0016392555553466082
The modified gen p mean: 0.4481983482837677, gen p mean: -0.24198824167251587, mean p set: 0.44877755641937256
loss_pred:0.014085181057453156, decouple_loss:0.0016865632496774197
The modified gen p mean: 0.44702813029289246, gen p mean: -0.23850661516189575, mean p set: 0.44760891795158386
loss_pred:0.014321456663310528, decouple_loss:0.0017186480108648539
Iteration: 5034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817841053009033, gen p mean: -0.23833614587783813, mean p set: 0.44870179891586304
loss_pred:0.013894306495785713, decouple_loss:0.0017325843218713999
The modified gen p mean: 0.4476519525051117, gen p mean: -0.24024347960948944, mean p set: 0.4482308626174927
loss_pred:0.013777429237961769, decouple_loss:0.0019220724934712052
The modified gen p mean: 0.44846799969673157, gen p mean: -0.24107201397418976, mean p set: 0.44904205203056335
loss_pred:0.013604221865534782, decouple_loss:0.0016087886178866029
Iteration: 5035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476427733898163, gen p mean: -0.24530737102031708, mean p set: 0.4482249617576599
loss_pred:0.013619824312627316, decouple_loss:0.0017657909775152802
The modified gen p mean: 0.4475700259208679, gen p mean: -0.24186910688877106, mean p set: 0.44814959168434143The modified gen p mean: 0.4475650191307068, gen p mean: -0.24195460975170135, mean p set: 0.4480917155742645
loss_pred:0.01345046702772379, decouple_loss:0.001702874549664557
loss_pred:0.01427202858030796, decouple_loss:0.001719162450172007
Iteration: 5036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881293177604675, gen p mean: -0.23860765993595123, mean p set: 0.4493890404701233
loss_pred:0.013674707151949406, decouple_loss:0.0018398793181404471
The modified gen p mean: 0.44703415036201477, gen p mean: -0.244199737906456, mean p set: 0.4476131498813629
loss_pred:0.013177811168134212, decouple_loss:0.0016796775162220001
The modified gen p mean: 0.4472937285900116, gen p mean: -0.24177013337612152, mean p set: 0.4478210508823395
loss_pred:0.013998215086758137, decouple_loss:0.00178685097489506
Iteration: 5037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472618103027344, gen p mean: -0.2458818405866623, mean p set: 0.4478406012058258
loss_pred:0.013995503075420856, decouple_loss:0.0019674585200846195
The modified gen p mean: 0.44733330607414246, gen p mean: -0.24433685839176178, mean p set: 0.4479069411754608
loss_pred:0.014265352860093117, decouple_loss:0.001551971072331071
The modified gen p mean: 0.4482923746109009, gen p mean: -0.2416663020849228, mean p set: 0.4488186836242676
loss_pred:0.013843958266079426, decouple_loss:0.0018846530001610518
Iteration: 5038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477091133594513, gen p mean: -0.24906350672245026, mean p set: 0.44828295707702637
loss_pred:0.014089039526879787, decouple_loss:0.0018510323716327548
The modified gen p mean: 0.44819387793540955, gen p mean: -0.24672818183898926, mean p set: 0.4487678110599518
loss_pred:0.01343163289129734, decouple_loss:0.0020087414886802435
The modified gen p mean: 0.4476625323295593, gen p mean: -0.24576435983181, mean p set: 0.44819164276123047
loss_pred:0.013330173678696156, decouple_loss:0.0019919408950954676
Iteration: 5039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482190012931824, gen p mean: -0.24608203768730164, mean p set: 0.44879069924354553
loss_pred:0.013199872337281704, decouple_loss:0.0017784445080906153
The modified gen p mean: 0.4460242688655853, gen p mean: -0.24193716049194336, mean p set: 0.44660380482673645
loss_pred:0.01405274122953415, decouple_loss:0.001827099360525608
The modified gen p mean: 0.4480239152908325, gen p mean: -0.2456158548593521, mean p set: 0.44855615496635437
loss_pred:0.01379283145070076, decouple_loss:0.0016180092934519053
Iteration: 5040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828712940216064, gen p mean: -0.24278071522712708, mean p set: 0.4488621652126312
loss_pred:0.014212440699338913, decouple_loss:0.002092421054840088
The modified gen p mean: 0.44727468490600586, gen p mean: -0.2426460236310959, mean p set: 0.44785353541374207
loss_pred:0.013741998933255672, decouple_loss:0.002195289358496666
The modified gen p mean: 0.4473359286785126, gen p mean: -0.24748142063617706, mean p set: 0.4478645324707031
loss_pred:0.013444274663925171, decouple_loss:0.0020872349850833416
2023-04-28 02:14:27 testing...
The modified gen p mean: 0.4482696056365967, gen p mean: -0.238804891705513, mean p set: 0.44879910349845886
loss_pred:0.015337995253503323, decouple_loss:0.0018544900231063366
The modified gen p mean: 0.4493027627468109, gen p mean: -0.24156063795089722, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2413996160030365, mean p set: 0.4499112665653229
loss_pred:0.014942714013159275, decouple_loss:0.001981873996555805
loss_pred:0.015426802448928356, decouple_loss:0.002016347134485841
WV_1_PC_1_EH_0_PS_30, loss: 0.015333382412791252, avg_mse: 0.022755049169063568
current test mse: 0.022755
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 5041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463135898113251, gen p mean: -0.24397923052310944, mean p set: 0.4468485414981842
loss_pred:0.014599326997995377, decouple_loss:0.0018937172135338187
The modified gen p mean: 0.44729578495025635, gen p mean: -0.24215421080589294, mean p set: 0.4478660225868225
The modified gen p mean: 0.4469536542892456, gen p mean: -0.2459128051996231, mean p set: 0.4475320279598236
loss_pred:0.01512278150767088, decouple_loss:0.002095706993713975
loss_pred:0.014310337603092194, decouple_loss:0.0018943592440336943
Iteration: 5042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454229176044464, gen p mean: -0.24164770543575287, mean p set: 0.44595643877983093
loss_pred:0.014473945833742619, decouple_loss:0.0016744676977396011
The modified gen p mean: 0.44582095742225647, gen p mean: -0.2424430102109909, mean p set: 0.44639402627944946
The modified gen p mean: 0.446717768907547, gen p mean: -0.2403571903705597, mean p set: 0.44729533791542053
loss_pred:0.014632944017648697, decouple_loss:0.0016996547346934676
loss_pred:0.014199730008840561, decouple_loss:0.0017263421323150396
Iteration: 5043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467124044895172, gen p mean: -0.24170592427253723, mean p set: 0.44723621010780334
loss_pred:0.014389309100806713, decouple_loss:0.001865733414888382
The modified gen p mean: 0.4448215067386627, gen p mean: -0.24049434065818787, mean p set: 0.4453986883163452
The modified gen p mean: 0.44548317790031433, gen p mean: -0.2418614625930786, mean p set: 0.44606199860572815
loss_pred:0.015077643096446991, decouple_loss:0.0021559596061706543
loss_pred:0.014585760422050953, decouple_loss:0.0018538514850661159
Iteration: 5044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446315735578537, gen p mean: -0.24357207119464874, mean p set: 0.4468989372253418
loss_pred:0.014307758770883083, decouple_loss:0.001648235134780407
The modified gen p mean: 0.44706207513809204, gen p mean: -0.24413861334323883, mean p set: 0.4476345181465149The modified gen p mean: 0.44700658321380615, gen p mean: -0.24264347553253174, mean p set: 0.4475346803665161
loss_pred:0.014438801445066929, decouple_loss:0.001831957371905446
loss_pred:0.0150610888376832, decouple_loss:0.0017000968800857663
Iteration: 5045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463806450366974, gen p mean: -0.245271235704422, mean p set: 0.44695156812667847
loss_pred:0.014304627664387226, decouple_loss:0.0019514627056196332
The modified gen p mean: 0.4459053874015808, gen p mean: -0.2450416535139084, mean p set: 0.44647544622421265
loss_pred:0.014971603639423847, decouple_loss:0.001884288853034377
The modified gen p mean: 0.4464845061302185, gen p mean: -0.24509340524673462, mean p set: 0.4470106363296509
loss_pred:0.01441232394427061, decouple_loss:0.0018628857797011733
Iteration: 5046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457358419895172, gen p mean: -0.24529507756233215, mean p set: 0.44631072878837585
loss_pred:0.014242700301110744, decouple_loss:0.0016778595745563507
The modified gen p mean: 0.44702211022377014, gen p mean: -0.24375462532043457, mean p set: 0.4475449025630951The modified gen p mean: 0.44661977887153625, gen p mean: -0.24908892810344696, mean p set: 0.44719311594963074
loss_pred:0.01424507424235344, decouple_loss:0.0015437823021784425
loss_pred:0.014870385639369488, decouple_loss:0.0016471395501866937
Iteration: 5047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457860291004181, gen p mean: -0.24695566296577454, mean p set: 0.4463599622249603
loss_pred:0.014523363672196865, decouple_loss:0.0018873471999540925
The modified gen p mean: 0.4466971755027771, gen p mean: -0.24640397727489471, mean p set: 0.4472745358943939
loss_pred:0.013852162286639214, decouple_loss:0.001792099792510271
The modified gen p mean: 0.4465046525001526, gen p mean: -0.2479531615972519, mean p set: 0.4470359981060028
loss_pred:0.01413990929722786, decouple_loss:0.0017747069941833615
Iteration: 5048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454745650291443, gen p mean: -0.2502869963645935, mean p set: 0.44604605436325073
loss_pred:0.014134891331195831, decouple_loss:0.0018853017827495933
The modified gen p mean: 0.44560369849205017, gen p mean: -0.24501623213291168, mean p set: 0.44613370299339294The modified gen p mean: 0.4469543397426605, gen p mean: -0.2479115128517151, mean p set: 0.44752374291419983
loss_pred:0.014931990765035152, decouple_loss:0.0018144388450309634
loss_pred:0.014269154518842697, decouple_loss:0.001689228811301291
Iteration: 5049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460798501968384, gen p mean: -0.23538659512996674, mean p set: 0.4466569721698761
loss_pred:0.014807318337261677, decouple_loss:0.0017989426851272583
The modified gen p mean: 0.44553837180137634, gen p mean: -0.23540791869163513, mean p set: 0.44611749053001404
loss_pred:0.01465622615069151, decouple_loss:0.001715059974230826
The modified gen p mean: 0.44590696692466736, gen p mean: -0.23774024844169617, mean p set: 0.4464392364025116
loss_pred:0.014860890805721283, decouple_loss:0.0017653858521953225
Iteration: 5050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470784366130829, gen p mean: -0.2246750146150589, mean p set: 0.44765836000442505
loss_pred:0.014762078411877155, decouple_loss:0.0018391787307336926
The modified gen p mean: 0.4455967843532562, gen p mean: -0.225306436419487, mean p set: 0.446174293756485
loss_pred:0.015041975304484367, decouple_loss:0.0017091818153858185
The modified gen p mean: 0.44678595662117004, gen p mean: -0.22299949824810028, mean p set: 0.44731536507606506
loss_pred:0.015194167383015156, decouple_loss:0.0017633169190958142
2023-04-28 02:18:32 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22867871820926666, mean p set: 0.4499112665653229
loss_pred:0.01605907827615738, decouple_loss:0.0024479578714817762
The modified gen p mean: 0.44930145144462585, gen p mean: -0.22915877401828766, mean p set: 0.4498290419578552
loss_pred:0.015529144555330276, decouple_loss:0.002284134505316615
The modified gen p mean: 0.44826972484588623, gen p mean: -0.22680288553237915, mean p set: 0.44879910349845886
loss_pred:0.015958668664097786, decouple_loss:0.002252681413665414
WV_1_PC_1_EH_0_PS_30, loss: 0.015965377911925316, avg_mse: 0.02376602590084076
current test mse: 0.023766
Iteration: 5051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44637808203697205, gen p mean: -0.2330407351255417, mean p set: 0.44695594906806946
loss_pred:0.014389310963451862, decouple_loss:0.002087710425257683
The modified gen p mean: 0.4471145272254944, gen p mean: -0.2266281396150589, mean p set: 0.44763532280921936
loss_pred:0.015483897179365158, decouple_loss:0.0022312989458441734
The modified gen p mean: 0.44682931900024414, gen p mean: -0.23111040890216827, mean p set: 0.447405070066452
loss_pred:0.014844431541860104, decouple_loss:0.0021662074141204357
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479188024997711, gen p mean: -0.2392587959766388, mean p set: 0.4484444558620453
loss_pred:0.015670543536543846, decouple_loss:0.002058380050584674
The modified gen p mean: 0.4468674659729004, gen p mean: -0.24088744819164276, mean p set: 0.44744303822517395
The modified gen p mean: 0.4457024335861206, gen p mean: -0.23733659088611603, mean p set: 0.446274995803833
loss_pred:0.015237378887832165, decouple_loss:0.002145678037777543
loss_pred:0.015628444030880928, decouple_loss:0.0020967749878764153
Iteration: 5053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465119540691376, gen p mean: -0.24409548938274384, mean p set: 0.4470418095588684
loss_pred:0.01463936734944582, decouple_loss:0.002216417109593749
The modified gen p mean: 0.4460057318210602, gen p mean: -0.2421754002571106, mean p set: 0.4465799629688263
The modified gen p mean: 0.44697073101997375, gen p mean: -0.24214796721935272, mean p set: 0.44754984974861145
loss_pred:0.014510441571474075, decouple_loss:0.00229508220218122
loss_pred:0.014866536483168602, decouple_loss:0.0021209130063652992
Iteration: 5054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758135080337524, gen p mean: -0.24662238359451294, mean p set: 0.4481041729450226
loss_pred:0.015395848080515862, decouple_loss:0.002084173494949937
The modified gen p mean: 0.44642525911331177, gen p mean: -0.24156038463115692, mean p set: 0.447003036737442
The modified gen p mean: 0.4464085102081299, gen p mean: -0.24543720483779907, mean p set: 0.446982741355896
loss_pred:0.014894206076860428, decouple_loss:0.0019119466887786984
loss_pred:0.014830625616014004, decouple_loss:0.0021513227839022875
Iteration: 5055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716116786003113, gen p mean: -0.24513572454452515, mean p set: 0.44773659110069275
loss_pred:0.01447477750480175, decouple_loss:0.0022706622257828712
The modified gen p mean: 0.4465606212615967, gen p mean: -0.24505166709423065, mean p set: 0.4470827281475067The modified gen p mean: 0.4458329379558563, gen p mean: -0.2437063455581665, mean p set: 0.44640541076660156
loss_pred:0.014561912976205349, decouple_loss:0.0020926278084516525
loss_pred:0.01473035104572773, decouple_loss:0.0020658429712057114
Iteration: 5056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4440923035144806, gen p mean: -0.24095672369003296, mean p set: 0.44466984272003174
loss_pred:0.01511114090681076, decouple_loss:0.002169713843613863
The modified gen p mean: 0.44581371545791626, gen p mean: -0.2419854700565338, mean p set: 0.4463409185409546The modified gen p mean: 0.4465627670288086, gen p mean: -0.24334494769573212, mean p set: 0.44714006781578064
loss_pred:0.014918075874447823, decouple_loss:0.002174790482968092
loss_pred:0.014634753577411175, decouple_loss:0.0021126798819750547
Iteration: 5057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470435082912445, gen p mean: -0.24397246539592743, mean p set: 0.4476243555545807
loss_pred:0.014488876797258854, decouple_loss:0.0021396668162196875
The modified gen p mean: 0.4471793472766876, gen p mean: -0.24677418172359467, mean p set: 0.44770827889442444The modified gen p mean: 0.44691571593284607, gen p mean: -0.2501671612262726, mean p set: 0.44749611616134644
loss_pred:0.014490703120827675, decouple_loss:0.0021094714757055044
loss_pred:0.01493288204073906, decouple_loss:0.0023625188041478395
Iteration: 5058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44608789682388306, gen p mean: -0.24156415462493896, mean p set: 0.44666188955307007
loss_pred:0.014804999344050884, decouple_loss:0.0019892272539436817
The modified gen p mean: 0.4462587535381317, gen p mean: -0.24290069937705994, mean p set: 0.44678211212158203The modified gen p mean: 0.44650834798812866, gen p mean: -0.24689535796642303, mean p set: 0.44707778096199036
loss_pred:0.014614767394959927, decouple_loss:0.0021472182124853134
loss_pred:0.014462110586464405, decouple_loss:0.001975350547581911
Iteration: 5059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453694522380829, gen p mean: -0.23911379277706146, mean p set: 0.4459480941295624
loss_pred:0.01457802765071392, decouple_loss:0.002159107243642211
The modified gen p mean: 0.4462898373603821, gen p mean: -0.24149027466773987, mean p set: 0.4468083381652832The modified gen p mean: 0.4475519061088562, gen p mean: -0.24137341976165771, mean p set: 0.44812965393066406
loss_pred:0.01493739616125822, decouple_loss:0.0018927917117252946
loss_pred:0.014670515432953835, decouple_loss:0.0019498479086905718
Iteration: 5060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450838565826416, gen p mean: -0.23835965991020203, mean p set: 0.4456527829170227
loss_pred:0.014536736533045769, decouple_loss:0.002126425039023161
The modified gen p mean: 0.4463907480239868, gen p mean: -0.24127142131328583, mean p set: 0.4469238221645355The modified gen p mean: 0.4465635120868683, gen p mean: -0.24348855018615723, mean p set: 0.44713932275772095
loss_pred:0.014460640959441662, decouple_loss:0.002081568818539381
loss_pred:0.014997662976384163, decouple_loss:0.001975925173610449
2023-04-28 02:21:56 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23569466173648834, mean p set: 0.4499112665653229
loss_pred:0.015599179081618786, decouple_loss:0.0021221472416073084
The modified gen p mean: 0.4482699930667877, gen p mean: -0.23271699249744415, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930219650268555, gen p mean: -0.23534223437309265, mean p set: 0.4498290419578552
loss_pred:0.015470492653548717, decouple_loss:0.0018971961690112948
loss_pred:0.01515296008437872, decouple_loss:0.002011501230299473
WV_1_PC_1_EH_0_PS_30, loss: 0.015508058480918407, avg_mse: 0.023011954501271248
current test mse: 0.023012
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 5061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857725501060486, gen p mean: -0.22815446555614471, mean p set: 0.44910016655921936
loss_pred:0.01492032129317522, decouple_loss:0.0021718330681324005
The modified gen p mean: 0.4482496976852417, gen p mean: -0.23260168731212616, mean p set: 0.4488248825073242
loss_pred:0.014615552499890327, decouple_loss:0.002105951774865389
The modified gen p mean: 0.4495188593864441, gen p mean: -0.23351117968559265, mean p set: 0.4500974118709564
loss_pred:0.014312580227851868, decouple_loss:0.00214078975841403
Iteration: 5062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477653205394745, gen p mean: -0.23324041068553925, mean p set: 0.44829061627388
loss_pred:0.014421905390918255, decouple_loss:0.0020056648645550013
The modified gen p mean: 0.4477810859680176, gen p mean: -0.23261728882789612, mean p set: 0.4483579099178314
loss_pred:0.013844293542206287, decouple_loss:0.0020354038570076227
The modified gen p mean: 0.44947364926338196, gen p mean: -0.2249133288860321, mean p set: 0.45004376769065857
loss_pred:0.013656586408615112, decouple_loss:0.0022370582446455956
Iteration: 5063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44950687885284424, gen p mean: -0.22361640632152557, mean p set: 0.45003435015678406
loss_pred:0.014183016493916512, decouple_loss:0.0018667001277208328
The modified gen p mean: 0.4484432637691498, gen p mean: -0.2196432650089264, mean p set: 0.44901344180107117
loss_pred:0.014449096284806728, decouple_loss:0.0023931602481752634
The modified gen p mean: 0.448417991399765, gen p mean: -0.21912547945976257, mean p set: 0.4489958584308624
loss_pred:0.014546730555593967, decouple_loss:0.002185045275837183
Iteration: 5064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475128948688507, gen p mean: -0.230734184384346, mean p set: 0.4480412006378174
loss_pred:0.0146093238145113, decouple_loss:0.0023478399962186813
The modified gen p mean: 0.4500119090080261, gen p mean: -0.22756953537464142, mean p set: 0.45059165358543396
loss_pred:0.014513161033391953, decouple_loss:0.002030082745477557
The modified gen p mean: 0.4484337270259857, gen p mean: -0.22747787833213806, mean p set: 0.4490082263946533
loss_pred:0.014160818420350552, decouple_loss:0.002353955525904894
Iteration: 5065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885504245758057, gen p mean: -0.21989168226718903, mean p set: 0.4493807256221771
loss_pred:0.014016346074640751, decouple_loss:0.0022129113785922527
The modified gen p mean: 0.44973644614219666, gen p mean: -0.2238503247499466, mean p set: 0.4503089487552643
loss_pred:0.01381692010909319, decouple_loss:0.0021272427402436733
The modified gen p mean: 0.44852888584136963, gen p mean: -0.22438091039657593, mean p set: 0.44910159707069397
loss_pred:0.014287463389337063, decouple_loss:0.002213095547631383
Iteration: 5066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449327290058136, gen p mean: -0.22465947270393372, mean p set: 0.44986000657081604
loss_pred:0.01418307051062584, decouple_loss:0.0018217103788629174
The modified gen p mean: 0.4481832981109619, gen p mean: -0.23303677141666412, mean p set: 0.4487546384334564
loss_pred:0.014712091535329819, decouple_loss:0.0019829480443149805
The modified gen p mean: 0.44813817739486694, gen p mean: -0.2342647761106491, mean p set: 0.44871246814727783
loss_pred:0.014658837579190731, decouple_loss:0.001810911693610251
Iteration: 5067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494387209415436, gen p mean: -0.22978264093399048, mean p set: 0.44996556639671326
loss_pred:0.014091329649090767, decouple_loss:0.002383819781243801
The modified gen p mean: 0.4498296082019806, gen p mean: -0.23542626202106476, mean p set: 0.4504038989543915
loss_pred:0.014033151790499687, decouple_loss:0.0021578462328761816
The modified gen p mean: 0.4499474763870239, gen p mean: -0.22956319153308868, mean p set: 0.450520396232605
loss_pred:0.014080979861319065, decouple_loss:0.0021029708441346884
Iteration: 5068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483906030654907, gen p mean: -0.2311352640390396, mean p set: 0.44897210597991943
loss_pred:0.0143001489341259, decouple_loss:0.0019299122504889965
The modified gen p mean: 0.44890978932380676, gen p mean: -0.23799015581607819, mean p set: 0.4494836926460266
loss_pred:0.014108615927398205, decouple_loss:0.0020151417702436447
The modified gen p mean: 0.4478985369205475, gen p mean: -0.23768959939479828, mean p set: 0.44842392206192017
loss_pred:0.014031370170414448, decouple_loss:0.0019013290293514729
Iteration: 5069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45100754499435425, gen p mean: -0.2288692146539688, mean p set: 0.4515393376350403
loss_pred:0.014223972335457802, decouple_loss:0.0023054915945976973
The modified gen p mean: 0.4489402174949646, gen p mean: -0.2303394228219986, mean p set: 0.4495154023170471
loss_pred:0.013706729747354984, decouple_loss:0.0023602405562996864
The modified gen p mean: 0.44918757677078247, gen p mean: -0.2333230972290039, mean p set: 0.4497624933719635
loss_pred:0.014241978526115417, decouple_loss:0.0022299352567642927
Iteration: 5070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489210844039917, gen p mean: -0.23174232244491577, mean p set: 0.4494929015636444
loss_pred:0.014395421370863914, decouple_loss:0.0021357466466724873
The modified gen p mean: 0.4482942819595337, gen p mean: -0.23301050066947937, mean p set: 0.4488753378391266
loss_pred:0.014463037252426147, decouple_loss:0.002137509873136878
The modified gen p mean: 0.4493933320045471, gen p mean: -0.2402397096157074, mean p set: 0.44991445541381836
loss_pred:0.014294549822807312, decouple_loss:0.001830617431551218
2023-04-28 02:26:01 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23784849047660828, mean p set: 0.4499112665653229
loss_pred:0.015483596362173557, decouple_loss:0.0020831709261983633
The modified gen p mean: 0.44826990365982056, gen p mean: -0.23543260991573334, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492979049682617, gen p mean: -0.23830628395080566, mean p set: 0.4498290419578552
loss_pred:0.015394697897136211, decouple_loss:0.001963165355846286
loss_pred:0.015105200000107288, decouple_loss:0.0020514032803475857
WV_1_PC_1_EH_0_PS_30, loss: 0.015429461374878883, avg_mse: 0.022890402004122734
current test mse: 0.02289
Iteration: 5071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484198987483978, gen p mean: -0.23441237211227417, mean p set: 0.44899484515190125
loss_pred:0.014949772506952286, decouple_loss:0.0020497601944953203
The modified gen p mean: 0.44943830370903015, gen p mean: -0.23058326542377472, mean p set: 0.4500153958797455
loss_pred:0.013547145761549473, decouple_loss:0.0018754996126517653
The modified gen p mean: 0.4481877386569977, gen p mean: -0.23621419072151184, mean p set: 0.4487136900424957
loss_pred:0.014582173898816109, decouple_loss:0.0018249292625114322
Iteration: 5072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787368178367615, gen p mean: -0.23091499507427216, mean p set: 0.4484051764011383
loss_pred:0.01409152802079916, decouple_loss:0.0019700326956808567
The modified gen p mean: 0.4492126405239105, gen p mean: -0.23700405657291412, mean p set: 0.4497894048690796
loss_pred:0.013867119327187538, decouple_loss:0.0019878291059285402
The modified gen p mean: 0.44877585768699646, gen p mean: -0.23869089782238007, mean p set: 0.4493550956249237
loss_pred:0.014176654629409313, decouple_loss:0.0020721678156405687
Iteration: 5073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781890511512756, gen p mean: -0.2404114007949829, mean p set: 0.44834738969802856
loss_pred:0.013841365464031696, decouple_loss:0.00204587634652853
The modified gen p mean: 0.4491369128227234, gen p mean: -0.2363056093454361, mean p set: 0.44971972703933716The modified gen p mean: 0.44973406195640564, gen p mean: -0.23393431305885315, mean p set: 0.450310081243515
loss_pred:0.014105886220932007, decouple_loss:0.0017571982461959124
loss_pred:0.014254411682486534, decouple_loss:0.002007507486268878
Iteration: 5074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939881563186646, gen p mean: -0.23835794627666473, mean p set: 0.4499305486679077
loss_pred:0.01373614463955164, decouple_loss:0.0017136730020865798
The modified gen p mean: 0.4479998052120209, gen p mean: -0.23768354952335358, mean p set: 0.4485754370689392
loss_pred:0.014492829330265522, decouple_loss:0.0020344366785138845
The modified gen p mean: 0.44912055134773254, gen p mean: -0.23845143616199493, mean p set: 0.4496983587741852
loss_pred:0.014406103640794754, decouple_loss:0.0018787680892273784
Iteration: 5075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865724444389343, gen p mean: -0.23865656554698944, mean p set: 0.449236124753952
loss_pred:0.014039285480976105, decouple_loss:0.0018779555102810264
The modified gen p mean: 0.4493555724620819, gen p mean: -0.2362174093723297, mean p set: 0.4499303698539734
loss_pred:0.014744134619832039, decouple_loss:0.0020479331724345684
The modified gen p mean: 0.44797807931900024, gen p mean: -0.24174928665161133, mean p set: 0.44850850105285645
loss_pred:0.013596074655652046, decouple_loss:0.00200496893376112
Iteration: 5076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478708803653717, gen p mean: -0.23787987232208252, mean p set: 0.4484458863735199
loss_pred:0.014228764921426773, decouple_loss:0.0015964033082127571
The modified gen p mean: 0.44906875491142273, gen p mean: -0.22685688734054565, mean p set: 0.44964277744293213The modified gen p mean: 0.45001766085624695, gen p mean: -0.2271539717912674, mean p set: 0.45054665207862854
loss_pred:0.014254153706133366, decouple_loss:0.0019380735466256738
loss_pred:0.013924331404268742, decouple_loss:0.0018248343840241432
Iteration: 5077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485917091369629, gen p mean: -0.22642475366592407, mean p set: 0.4491713047027588
loss_pred:0.014499097131192684, decouple_loss:0.001876221620477736
The modified gen p mean: 0.44919583201408386, gen p mean: -0.22948189079761505, mean p set: 0.44977647066116333
loss_pred:0.013860803097486496, decouple_loss:0.0017906088614836335
The modified gen p mean: 0.44874316453933716, gen p mean: -0.22807104885578156, mean p set: 0.4492739737033844
loss_pred:0.01466049812734127, decouple_loss:0.001978144282475114
Iteration: 5078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775107502937317, gen p mean: -0.23547320067882538, mean p set: 0.44832560420036316
loss_pred:0.014058437198400497, decouple_loss:0.0021242841612547636
The modified gen p mean: 0.4489753842353821, gen p mean: -0.2314566671848297, mean p set: 0.4495515525341034
loss_pred:0.01423462200909853, decouple_loss:0.001728581846691668
The modified gen p mean: 0.4479629695415497, gen p mean: -0.2314421534538269, mean p set: 0.44848892092704773
loss_pred:0.014426964335143566, decouple_loss:0.0017342416103929281
Iteration: 5079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487585425376892, gen p mean: -0.2288113385438919, mean p set: 0.44933852553367615
loss_pred:0.013930028304457664, decouple_loss:0.001645479816943407
The modified gen p mean: 0.4489120543003082, gen p mean: -0.2254488617181778, mean p set: 0.4494885504245758
loss_pred:0.014808950945734978, decouple_loss:0.0017786964308470488
The modified gen p mean: 0.44874468445777893, gen p mean: -0.2259235680103302, mean p set: 0.44927287101745605
loss_pred:0.014314992353320122, decouple_loss:0.001732775941491127
Iteration: 5080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488387405872345, gen p mean: -0.22548829019069672, mean p set: 0.44941237568855286
loss_pred:0.014523250982165337, decouple_loss:0.0020217669662088156
The modified gen p mean: 0.4505910575389862, gen p mean: -0.22149665653705597, mean p set: 0.451172411441803
loss_pred:0.014173481613397598, decouple_loss:0.0018435175297781825
The modified gen p mean: 0.4490475058555603, gen p mean: -0.22925646603107452, mean p set: 0.4495806396007538
loss_pred:0.013521227985620499, decouple_loss:0.0022565266117453575
2023-04-28 02:29:25 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23298177123069763, mean p set: 0.4499112665653229
loss_pred:0.015428642742335796, decouple_loss:0.001740293693728745
The modified gen p mean: 0.44827258586883545, gen p mean: -0.2303193211555481, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492988586425781, gen p mean: -0.2330847531557083, mean p set: 0.4498290419578552
loss_pred:0.015325022861361504, decouple_loss:0.001781007624231279
loss_pred:0.015046521089971066, decouple_loss:0.001817844226025045
WV_1_PC_1_EH_0_PS_30, loss: 0.015355715528130531, avg_mse: 0.02284291572868824
current test mse: 0.022843
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 5081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468291699886322, gen p mean: -0.2306506335735321, mean p set: 0.4473542869091034
loss_pred:0.013897310011088848, decouple_loss:0.0016557613853365183
The modified gen p mean: 0.44751060009002686, gen p mean: -0.22958683967590332, mean p set: 0.4480895698070526
The modified gen p mean: 0.4476096034049988, gen p mean: -0.23151937127113342, mean p set: 0.4481835961341858
loss_pred:0.013621329329907894, decouple_loss:0.0017761926865205169
loss_pred:0.013916576281189919, decouple_loss:0.0017423640238121152
Iteration: 5082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467344880104065, gen p mean: -0.2357845902442932, mean p set: 0.4472596049308777
loss_pred:0.014079367741942406, decouple_loss:0.0017154228407889605
The modified gen p mean: 0.44836360216140747, gen p mean: -0.23735485970973969, mean p set: 0.448940247297287
loss_pred:0.014149077236652374, decouple_loss:0.0018229559063911438
The modified gen p mean: 0.44739076495170593, gen p mean: -0.2380780726671219, mean p set: 0.4479711353778839
loss_pred:0.014211835339665413, decouple_loss:0.0017616001423448324
Iteration: 5083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757935404777527, gen p mean: -0.23914405703544617, mean p set: 0.4481063485145569
loss_pred:0.014292380772531033, decouple_loss:0.001690309843979776
The modified gen p mean: 0.4485763907432556, gen p mean: -0.23736533522605896, mean p set: 0.4491502642631531
loss_pred:0.014085850678384304, decouple_loss:0.0018364342395216227
The modified gen p mean: 0.4477933347225189, gen p mean: -0.23760047554969788, mean p set: 0.44837847352027893
loss_pred:0.013639296405017376, decouple_loss:0.0021276306360960007
Iteration: 5084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738978147506714, gen p mean: -0.23537981510162354, mean p set: 0.44791606068611145
loss_pred:0.014214631170034409, decouple_loss:0.0015876978868618608
The modified gen p mean: 0.44733986258506775, gen p mean: -0.24009869992733002, mean p set: 0.4479212760925293
loss_pred:0.013669117353856564, decouple_loss:0.001559084397740662
The modified gen p mean: 0.44807782769203186, gen p mean: -0.23426322638988495, mean p set: 0.4486541748046875
loss_pred:0.014093209058046341, decouple_loss:0.001861400087364018
Iteration: 5085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804224371910095, gen p mean: -0.23522412776947021, mean p set: 0.44862261414527893
loss_pred:0.013441885821521282, decouple_loss:0.001712934346869588
The modified gen p mean: 0.44878950715065, gen p mean: -0.23253700137138367, mean p set: 0.44937047362327576The modified gen p mean: 0.4476827383041382, gen p mean: -0.23305293917655945, mean p set: 0.4482133686542511
loss_pred:0.014066972769796848, decouple_loss:0.002181348856538534
loss_pred:0.013868319801986217, decouple_loss:0.0018678654450923204
Iteration: 5086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447806179523468, gen p mean: -0.23237405717372894, mean p set: 0.4483788311481476
loss_pred:0.014163368381559849, decouple_loss:0.001782383187673986
The modified gen p mean: 0.4487219452857971, gen p mean: -0.2290349006652832, mean p set: 0.44924822449684143The modified gen p mean: 0.4477228820323944, gen p mean: -0.23343072831630707, mean p set: 0.4483005702495575
loss_pred:0.01445414125919342, decouple_loss:0.001821534358896315
loss_pred:0.01347687654197216, decouple_loss:0.0017802806105464697
Iteration: 5087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467596709728241, gen p mean: -0.23548583686351776, mean p set: 0.4473342299461365
loss_pred:0.013836603611707687, decouple_loss:0.0020524533465504646
The modified gen p mean: 0.4480299651622772, gen p mean: -0.23284004628658295, mean p set: 0.44860121607780457
loss_pred:0.013243542984127998, decouple_loss:0.0021311065647751093
The modified gen p mean: 0.44623836874961853, gen p mean: -0.23131009936332703, mean p set: 0.44676437973976135
loss_pred:0.0136244622990489, decouple_loss:0.0024006899911910295
Iteration: 5088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455333948135376, gen p mean: -0.23551079630851746, mean p set: 0.4461096227169037
loss_pred:0.013655049726366997, decouple_loss:0.0016452826093882322
The modified gen p mean: 0.448565810918808, gen p mean: -0.23011243343353271, mean p set: 0.44913291931152344
loss_pred:0.014150699600577354, decouple_loss:0.001944196643307805
The modified gen p mean: 0.44767218828201294, gen p mean: -0.23253977298736572, mean p set: 0.4481982886791229
loss_pred:0.013615826144814491, decouple_loss:0.0016964987153187394
Iteration: 5089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722840189933777, gen p mean: -0.23844966292381287, mean p set: 0.44780340790748596
loss_pred:0.01388491876423359, decouple_loss:0.0026850788854062557
The modified gen p mean: 0.4484013020992279, gen p mean: -0.23789897561073303, mean p set: 0.44897761940956116
loss_pred:0.01351748127490282, decouple_loss:0.002458837116137147
The modified gen p mean: 0.44834476709365845, gen p mean: -0.23683293163776398, mean p set: 0.44886934757232666
loss_pred:0.013386784121394157, decouple_loss:0.0024645186495035887
Iteration: 5090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480229914188385, gen p mean: -0.23057842254638672, mean p set: 0.44860079884529114
loss_pred:0.013669323176145554, decouple_loss:0.002081155078485608
The modified gen p mean: 0.44760268926620483, gen p mean: -0.239511176943779, mean p set: 0.44817450642585754
loss_pred:0.013849128969013691, decouple_loss:0.002039564773440361
The modified gen p mean: 0.4469163119792938, gen p mean: -0.23979206383228302, mean p set: 0.4474402070045471
loss_pred:0.014117395505309105, decouple_loss:0.002078296383842826
2023-04-28 02:33:25 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2355307638645172, mean p set: 0.4499112665653229
loss_pred:0.015427992679178715, decouple_loss:0.0022905177902430296
The modified gen p mean: 0.4482753872871399, gen p mean: -0.23284955322742462, mean p set: 0.44879910349845886
The modified gen p mean: 0.44929665327072144, gen p mean: -0.23601557314395905, mean p set: 0.4498290419578552
loss_pred:0.01533797662705183, decouple_loss:0.002142994897440076
loss_pred:0.015035398304462433, decouple_loss:0.002223097952082753
WV_1_PC_1_EH_0_PS_30, loss: 0.015378065407276154, avg_mse: 0.022835928946733475
current test mse: 0.022836
Iteration: 5091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681763648986816, gen p mean: -0.2412327229976654, mean p set: 0.4473881721496582
loss_pred:0.013713174499571323, decouple_loss:0.0020665780175477266
The modified gen p mean: 0.4478141665458679, gen p mean: -0.2357262820005417, mean p set: 0.44838836789131165
loss_pred:0.013274035416543484, decouple_loss:0.002456003800034523
The modified gen p mean: 0.4469669461250305, gen p mean: -0.23862497508525848, mean p set: 0.4475003480911255
loss_pred:0.013664383441209793, decouple_loss:0.0020053039770573378
Iteration: 5092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472379982471466, gen p mean: -0.2389424443244934, mean p set: 0.4477671980857849
loss_pred:0.0137134725227952, decouple_loss:0.0023310924880206585
The modified gen p mean: 0.44732317328453064, gen p mean: -0.23574376106262207, mean p set: 0.44789940118789673
loss_pred:0.0140439597889781, decouple_loss:0.0020868133287876844
The modified gen p mean: 0.446286141872406, gen p mean: -0.2371264398097992, mean p set: 0.4468632936477661
loss_pred:0.013675262220203876, decouple_loss:0.0023069579619914293
Iteration: 5093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714823365211487, gen p mean: -0.24230626225471497, mean p set: 0.4476828873157501
loss_pred:0.013506898656487465, decouple_loss:0.0016847954830154777
The modified gen p mean: 0.44737786054611206, gen p mean: -0.2395976185798645, mean p set: 0.4479547441005707
loss_pred:0.013346816413104534, decouple_loss:0.001769432332366705
The modified gen p mean: 0.44742682576179504, gen p mean: -0.23741018772125244, mean p set: 0.44800058007240295
loss_pred:0.013158157467842102, decouple_loss:0.0016286482568830252
Iteration: 5094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486427307128906, gen p mean: -0.23424199223518372, mean p set: 0.44917070865631104
loss_pred:0.013913205824792385, decouple_loss:0.0019946519751101732
The modified gen p mean: 0.44772547483444214, gen p mean: -0.24003243446350098, mean p set: 0.4483039677143097
loss_pred:0.013256504200398922, decouple_loss:0.0018331273458898067
The modified gen p mean: 0.44746023416519165, gen p mean: -0.2360038012266159, mean p set: 0.4480327069759369
loss_pred:0.013304741121828556, decouple_loss:0.002082719234749675
Iteration: 5095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768771529197693, gen p mean: -0.23832878470420837, mean p set: 0.4482652246952057
loss_pred:0.013597655110061169, decouple_loss:0.0016815450508147478
The modified gen p mean: 0.4485495686531067, gen p mean: -0.23545677959918976, mean p set: 0.4491216838359833
loss_pred:0.013385860249400139, decouple_loss:0.0018498044228181243
The modified gen p mean: 0.4468901455402374, gen p mean: -0.244249626994133, mean p set: 0.4474206268787384
loss_pred:0.01382155530154705, decouple_loss:0.001712365192361176
Iteration: 5096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694745540618896, gen p mean: -0.24737191200256348, mean p set: 0.4475173056125641
loss_pred:0.013905201107263565, decouple_loss:0.0017015382181853056
The modified gen p mean: 0.44737476110458374, gen p mean: -0.24269646406173706, mean p set: 0.4479072690010071The modified gen p mean: 0.4479484558105469, gen p mean: -0.24729976058006287, mean p set: 0.44852009415626526
loss_pred:0.013389063067734241, decouple_loss:0.001737521612085402
loss_pred:0.013790943659842014, decouple_loss:0.0016269973712041974
Iteration: 5097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479232132434845, gen p mean: -0.2401743084192276, mean p set: 0.4484962224960327
loss_pred:0.013632864691317081, decouple_loss:0.0016149564180523157
The modified gen p mean: 0.4472055733203888, gen p mean: -0.2514984607696533, mean p set: 0.44778600335121155
loss_pred:0.013610928319394588, decouple_loss:0.0016543915262445807
The modified gen p mean: 0.44643667340278625, gen p mean: -0.24862493574619293, mean p set: 0.44695839285850525
loss_pred:0.013579887337982655, decouple_loss:0.0014814099995419383
Iteration: 5098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470948278903961, gen p mean: -0.25036129355430603, mean p set: 0.4476650059223175
loss_pred:0.013795685954391956, decouple_loss:0.001848252839408815
The modified gen p mean: 0.4475618302822113, gen p mean: -0.24994739890098572, mean p set: 0.44813501834869385
loss_pred:0.013902001082897186, decouple_loss:0.001782733597792685
The modified gen p mean: 0.446744829416275, gen p mean: -0.24689996242523193, mean p set: 0.44727250933647156
loss_pred:0.013674696907401085, decouple_loss:0.0016756044933572412
Iteration: 5099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471927583217621, gen p mean: -0.24784700572490692, mean p set: 0.4477669298648834
loss_pred:0.013935750350356102, decouple_loss:0.0015737843932583928
The modified gen p mean: 0.4476913511753082, gen p mean: -0.24194078147411346, mean p set: 0.44821637868881226The modified gen p mean: 0.4471392333507538, gen p mean: -0.2425888478755951, mean p set: 0.4477144777774811
loss_pred:0.013476422987878323, decouple_loss:0.0016776855336502194
loss_pred:0.013790814206004143, decouple_loss:0.0016342318849638104
Iteration: 5100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458793103694916, gen p mean: -0.24098701775074005, mean p set: 0.44645851850509644
loss_pred:0.013410457409918308, decouple_loss:0.0017905647400766611
The modified gen p mean: 0.44760212302207947, gen p mean: -0.23817051947116852, mean p set: 0.4481825828552246
loss_pred:0.01332477480173111, decouple_loss:0.0018968788208439946
The modified gen p mean: 0.4465009570121765, gen p mean: -0.2440773844718933, mean p set: 0.4470282196998596
loss_pred:0.01350756362080574, decouple_loss:0.00169393140822649
2023-04-28 02:36:49 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23848053812980652, mean p set: 0.4499112665653229
loss_pred:0.015425573103129864, decouple_loss:0.0017747341189533472
The modified gen p mean: 0.44826823472976685, gen p mean: -0.23581404983997345, mean p set: 0.44879910349845886
The modified gen p mean: 0.44929981231689453, gen p mean: -0.23877111077308655, mean p set: 0.4498290419578552
loss_pred:0.015335625037550926, decouple_loss:0.0018475735560059547
loss_pred:0.014998766593635082, decouple_loss:0.0018806355074048042
WV_1_PC_1_EH_0_PS_30, loss: 0.01534503698348999, avg_mse: 0.02277771383523941
current test mse: 0.022778
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 5101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489968717098236, gen p mean: -0.2409522831439972, mean p set: 0.44952166080474854
loss_pred:0.013857321813702583, decouple_loss:0.0016490116249769926
The modified gen p mean: 0.4479401707649231, gen p mean: -0.23759309947490692, mean p set: 0.4485156238079071
loss_pred:0.013513632118701935, decouple_loss:0.0017785467207431793
The modified gen p mean: 0.4478982985019684, gen p mean: -0.23638083040714264, mean p set: 0.4484834671020508
loss_pred:0.013872921466827393, decouple_loss:0.0016867038793861866
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473690986633301, gen p mean: -0.24347984790802002, mean p set: 0.4479025602340698
loss_pred:0.013745574280619621, decouple_loss:0.00181219179648906
The modified gen p mean: 0.4484263062477112, gen p mean: -0.23873241245746613, mean p set: 0.44900330901145935
loss_pred:0.013516250997781754, decouple_loss:0.001893080654554069
The modified gen p mean: 0.44703254103660583, gen p mean: -0.24018554389476776, mean p set: 0.4476125240325928
loss_pred:0.014129741117358208, decouple_loss:0.001751712872646749
Iteration: 5103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469836950302124, gen p mean: -0.24604462087154388, mean p set: 0.44750893115997314
loss_pred:0.013734595850110054, decouple_loss:0.0017063115956261754
The modified gen p mean: 0.44843751192092896, gen p mean: -0.24690310657024384, mean p set: 0.4490198791027069
loss_pred:0.014037245884537697, decouple_loss:0.0017390383873134851
The modified gen p mean: 0.4473091661930084, gen p mean: -0.24451203644275665, mean p set: 0.4478845000267029
loss_pred:0.013569172471761703, decouple_loss:0.0016382772009819746
Iteration: 5104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752803444862366, gen p mean: -0.2482800930738449, mean p set: 0.4480571746826172
loss_pred:0.014268954284489155, decouple_loss:0.0016831200337037444
The modified gen p mean: 0.4478902220726013, gen p mean: -0.2421901375055313, mean p set: 0.448472261428833
loss_pred:0.013510140590369701, decouple_loss:0.0020432232413440943
The modified gen p mean: 0.4487209618091583, gen p mean: -0.2426845133304596, mean p set: 0.44929543137550354
loss_pred:0.013772481121122837, decouple_loss:0.002180463168770075
Iteration: 5105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769158959388733, gen p mean: -0.24379876255989075, mean p set: 0.4482649564743042
loss_pred:0.01393069513142109, decouple_loss:0.0020272776018828154
The modified gen p mean: 0.4474438726902008, gen p mean: -0.2440704107284546, mean p set: 0.4480155408382416
loss_pred:0.015153438784182072, decouple_loss:0.0020770833361893892
The modified gen p mean: 0.4478866755962372, gen p mean: -0.2403789609670639, mean p set: 0.44841471314430237
loss_pred:0.014346667565405369, decouple_loss:0.0018467046320438385
Iteration: 5106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482673406600952, gen p mean: -0.24337735772132874, mean p set: 0.4488431215286255
loss_pred:0.013494600541889668, decouple_loss:0.0018786140717566013
The modified gen p mean: 0.4483478367328644, gen p mean: -0.24081093072891235, mean p set: 0.4488748610019684The modified gen p mean: 0.4481470584869385, gen p mean: -0.24517618119716644, mean p set: 0.4487282633781433
loss_pred:0.014022767543792725, decouple_loss:0.002112395130097866
loss_pred:0.01445611473172903, decouple_loss:0.0017724513309076428
Iteration: 5107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471580386161804, gen p mean: -0.24228018522262573, mean p set: 0.4477330446243286
loss_pred:0.013898883014917374, decouple_loss:0.0016966668190434575
The modified gen p mean: 0.44761550426483154, gen p mean: -0.23845864832401276, mean p set: 0.4481905400753021
loss_pred:0.013983921147882938, decouple_loss:0.0017608408816158772
The modified gen p mean: 0.44838395714759827, gen p mean: -0.2398214489221573, mean p set: 0.4489106833934784
loss_pred:0.014066408388316631, decouple_loss:0.001873898203484714
Iteration: 5108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467639625072479, gen p mean: -0.24345505237579346, mean p set: 0.4473358392715454
loss_pred:0.01368720456957817, decouple_loss:0.0016034806612879038
The modified gen p mean: 0.4469142556190491, gen p mean: -0.2450801432132721, mean p set: 0.4474853575229645
loss_pred:0.013406485319137573, decouple_loss:0.001572344684973359
The modified gen p mean: 0.4468417763710022, gen p mean: -0.241461843252182, mean p set: 0.447368323802948
loss_pred:0.014086253009736538, decouple_loss:0.0017572389915585518
Iteration: 5109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681960344314575, gen p mean: -0.24267792701721191, mean p set: 0.4473958909511566
loss_pred:0.013799597509205341, decouple_loss:0.001573361223563552
The modified gen p mean: 0.4457864463329315, gen p mean: -0.23877382278442383, mean p set: 0.44636374711990356
loss_pred:0.013876133598387241, decouple_loss:0.0019842677284032106
The modified gen p mean: 0.44919878244400024, gen p mean: -0.2424411028623581, mean p set: 0.4497232735157013
loss_pred:0.013495663180947304, decouple_loss:0.001768153510056436
Iteration: 5110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481200873851776, gen p mean: -0.23735474050045013, mean p set: 0.4486992359161377
loss_pred:0.014336302876472473, decouple_loss:0.0018323551630601287
The modified gen p mean: 0.44749513268470764, gen p mean: -0.24863100051879883, mean p set: 0.4480707347393036
loss_pred:0.014646373689174652, decouple_loss:0.0017156866379082203
The modified gen p mean: 0.44818904995918274, gen p mean: -0.2404056191444397, mean p set: 0.44871997833251953
loss_pred:0.013462165370583534, decouple_loss:0.0016627260483801365
2023-04-28 02:41:00 testing...
The modified gen p mean: 0.448269784450531, gen p mean: -0.24023544788360596, mean p set: 0.44879910349845886
loss_pred:0.01517519075423479, decouple_loss:0.0019041841151192784
The modified gen p mean: 0.44930025935173035, gen p mean: -0.24299775063991547, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24283558130264282, mean p set: 0.4499112665653229
loss_pred:0.014870107173919678, decouple_loss:0.0018882345175370574
loss_pred:0.015322326682507992, decouple_loss:0.0017657395219430327
WV_1_PC_1_EH_0_PS_30, loss: 0.015215177088975906, avg_mse: 0.022579727694392204
current test mse: 0.02258
Iteration: 5111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939127564430237, gen p mean: -0.24491743743419647, mean p set: 0.4499242305755615
loss_pred:0.013642671518027782, decouple_loss:0.0017238055588677526
The modified gen p mean: 0.4477424919605255, gen p mean: -0.2496282458305359, mean p set: 0.4483180344104767
loss_pred:0.014414377510547638, decouple_loss:0.0017445986159145832
The modified gen p mean: 0.4476182162761688, gen p mean: -0.24464094638824463, mean p set: 0.44819900393486023
loss_pred:0.013765819370746613, decouple_loss:0.00175872549880296
Iteration: 5112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816774129867554, gen p mean: -0.24359504878520966, mean p set: 0.44869574904441833
loss_pred:0.01389331091195345, decouple_loss:0.0019348332425579429
The modified gen p mean: 0.44814544916152954, gen p mean: -0.24794338643550873, mean p set: 0.4487214982509613
The modified gen p mean: 0.4460802674293518, gen p mean: -0.24362416565418243, mean p set: 0.44665804505348206
loss_pred:0.014013448730111122, decouple_loss:0.0016645316500216722
loss_pred:0.013628903776407242, decouple_loss:0.0022277773823589087
Iteration: 5113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010894536972046, gen p mean: -0.2496403306722641, mean p set: 0.4506426155567169
loss_pred:0.013691671192646027, decouple_loss:0.0020930683240294456
The modified gen p mean: 0.44673702120780945, gen p mean: -0.25162503123283386, mean p set: 0.447309285402298
The modified gen p mean: 0.44752517342567444, gen p mean: -0.24895985424518585, mean p set: 0.4481089115142822
loss_pred:0.013439804315567017, decouple_loss:0.0018061960581690073
loss_pred:0.014447095803916454, decouple_loss:0.001980188302695751
Iteration: 5114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668638706207275, gen p mean: -0.2432974874973297, mean p set: 0.44726231694221497
loss_pred:0.014635839499533176, decouple_loss:0.0017125586746260524
The modified gen p mean: 0.44802603125572205, gen p mean: -0.24761247634887695, mean p set: 0.4485537111759186The modified gen p mean: 0.44800081849098206, gen p mean: -0.24723993241786957, mean p set: 0.4485693573951721
loss_pred:0.014756490476429462, decouple_loss:0.001779482001438737
loss_pred:0.013286489993333817, decouple_loss:0.0017630666261538863
Iteration: 5115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695940613746643, gen p mean: -0.24913665652275085, mean p set: 0.4475356340408325
loss_pred:0.013527989387512207, decouple_loss:0.002208531368523836
The modified gen p mean: 0.447020024061203, gen p mean: -0.24574242532253265, mean p set: 0.44755110144615173The modified gen p mean: 0.44632330536842346, gen p mean: -0.24710175395011902, mean p set: 0.4468948543071747
loss_pred:0.014123672619462013, decouple_loss:0.0017798381159082055
loss_pred:0.013605457730591297, decouple_loss:0.0020061954855918884
Iteration: 5116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846850633621216, gen p mean: -0.2488446682691574, mean p set: 0.44904476404190063
loss_pred:0.013899502344429493, decouple_loss:0.0015374221839010715
The modified gen p mean: 0.44999179244041443, gen p mean: -0.24581453204154968, mean p set: 0.4505683481693268
loss_pred:0.013357475399971008, decouple_loss:0.001836762297898531
The modified gen p mean: 0.4496578872203827, gen p mean: -0.24797216057777405, mean p set: 0.45018208026885986
loss_pred:0.012773199938237667, decouple_loss:0.001765859080478549
Iteration: 5117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475836455821991, gen p mean: -0.24376580119132996, mean p set: 0.4481564164161682
loss_pred:0.013671052642166615, decouple_loss:0.0017659430159255862
The modified gen p mean: 0.447674036026001, gen p mean: -0.24914805591106415, mean p set: 0.4482479691505432
loss_pred:0.014049151912331581, decouple_loss:0.0019191147293895483
The modified gen p mean: 0.448864609003067, gen p mean: -0.2481672167778015, mean p set: 0.44939976930618286
loss_pred:0.013916805386543274, decouple_loss:0.0022007368970662355
Iteration: 5118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446551114320755, gen p mean: -0.24847553670406342, mean p set: 0.4471263289451599
loss_pred:0.013182436116039753, decouple_loss:0.0018665235256776214
The modified gen p mean: 0.4482826292514801, gen p mean: -0.24663002789020538, mean p set: 0.4488097131252289The modified gen p mean: 0.44945815205574036, gen p mean: -0.24686692655086517, mean p set: 0.4500364065170288
loss_pred:0.013459003530442715, decouple_loss:0.001718550338409841
loss_pred:0.013845141045749187, decouple_loss:0.0019461981719359756
Iteration: 5119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446530282497406, gen p mean: -0.24527595937252045, mean p set: 0.447110116481781
loss_pred:0.014445243403315544, decouple_loss:0.0017986027523875237
The modified gen p mean: 0.44774746894836426, gen p mean: -0.25063836574554443, mean p set: 0.44832107424736023
loss_pred:0.01453643199056387, decouple_loss:0.0023403570521622896
The modified gen p mean: 0.44913938641548157, gen p mean: -0.250871479511261, mean p set: 0.449665904045105
loss_pred:0.013018130324780941, decouple_loss:0.0018280944786965847
Iteration: 5120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478552043437958, gen p mean: -0.24919955432415009, mean p set: 0.44843170046806335
loss_pred:0.0135042704641819, decouple_loss:0.0014548206236213446
The modified gen p mean: 0.447073757648468, gen p mean: -0.24945153295993805, mean p set: 0.4476448595523834
loss_pred:0.01385367102921009, decouple_loss:0.0015208686236292124
The modified gen p mean: 0.44609585404396057, gen p mean: -0.2498452067375183, mean p set: 0.4466237425804138
loss_pred:0.013654548674821854, decouple_loss:0.0015700807562097907
2023-04-28 02:44:24 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24748659133911133, mean p set: 0.4499112665653229
loss_pred:0.015300963073968887, decouple_loss:0.001576260314323008
The modified gen p mean: 0.4482751190662384, gen p mean: -0.2447858452796936, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930127263069153, gen p mean: -0.2473575621843338, mean p set: 0.4498290419578552
loss_pred:0.015197452157735825, decouple_loss:0.0014782550279051065
loss_pred:0.014864949509501457, decouple_loss:0.0014763822546228766
WV_1_PC_1_EH_0_PS_30, loss: 0.015196636319160461, avg_mse: 0.022556087002158165
current test mse: 0.022556
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 5121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477872848510742, gen p mean: -0.2458922117948532, mean p set: 0.44831427931785583
loss_pred:0.01403917744755745, decouple_loss:0.001553888781927526
The modified gen p mean: 0.44762474298477173, gen p mean: -0.2482227236032486, mean p set: 0.448209285736084
loss_pred:0.0138516491279006, decouple_loss:0.0015257983468472958
The modified gen p mean: 0.4477701485157013, gen p mean: -0.25020354986190796, mean p set: 0.4483422338962555
loss_pred:0.013914539478719234, decouple_loss:0.0016004351200535893
Iteration: 5122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446868360042572, gen p mean: -0.24684500694274902, mean p set: 0.44739776849746704
loss_pred:0.014134403318166733, decouple_loss:0.0016207881271839142
The modified gen p mean: 0.4473671317100525, gen p mean: -0.24997353553771973, mean p set: 0.4479331374168396The modified gen p mean: 0.4466407895088196, gen p mean: -0.2435021996498108, mean p set: 0.44721704721450806
loss_pred:0.014157479628920555, decouple_loss:0.0015385155566036701
loss_pred:0.01382968295365572, decouple_loss:0.0015629716217517853
Iteration: 5123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693484902381897, gen p mean: -0.24691686034202576, mean p set: 0.4474574029445648
loss_pred:0.013991523534059525, decouple_loss:0.0014866885030642152
The modified gen p mean: 0.4458790421485901, gen p mean: -0.2519295811653137, mean p set: 0.446456640958786
loss_pred:0.014096692204475403, decouple_loss:0.0015630729030817747
The modified gen p mean: 0.4463348090648651, gen p mean: -0.2424115240573883, mean p set: 0.44690370559692383
loss_pred:0.014131274074316025, decouple_loss:0.0015504067996516824
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489813446998596, gen p mean: -0.24659472703933716, mean p set: 0.4495137631893158
loss_pred:0.013889320194721222, decouple_loss:0.0018432112410664558
The modified gen p mean: 0.4478610157966614, gen p mean: -0.2480175644159317, mean p set: 0.44844114780426025
loss_pred:0.01409849338233471, decouple_loss:0.001600688905455172
The modified gen p mean: 0.44818115234375, gen p mean: -0.2435935139656067, mean p set: 0.44876447319984436
loss_pred:0.013551807031035423, decouple_loss:0.0016931071877479553
Iteration: 5125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478268027305603, gen p mean: -0.24403288960456848, mean p set: 0.4483581483364105
loss_pred:0.013315442949533463, decouple_loss:0.0015402256976813078
The modified gen p mean: 0.44645777344703674, gen p mean: -0.24504663050174713, mean p set: 0.4470267593860626The modified gen p mean: 0.4476182162761688, gen p mean: -0.2496693730354309, mean p set: 0.4481981694698334
loss_pred:0.014066102914512157, decouple_loss:0.0014590806094929576
loss_pred:0.014469847083091736, decouple_loss:0.001577946706674993
Iteration: 5126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639235734939575, gen p mean: -0.2475283145904541, mean p set: 0.44696754217147827
loss_pred:0.013148363679647446, decouple_loss:0.0017018708167597651
The modified gen p mean: 0.44850435853004456, gen p mean: -0.24558427929878235, mean p set: 0.44907715916633606The modified gen p mean: 0.44625264406204224, gen p mean: -0.24396124482154846, mean p set: 0.4467789828777313
loss_pred:0.013668665662407875, decouple_loss:0.0018368575256317854
loss_pred:0.014217742718756199, decouple_loss:0.001907137455418706
Iteration: 5127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468678832054138, gen p mean: -0.23854632675647736, mean p set: 0.44744551181793213
loss_pred:0.013828537426888943, decouple_loss:0.001462361542508006
The modified gen p mean: 0.4470832645893097, gen p mean: -0.24347861111164093, mean p set: 0.4476129114627838The modified gen p mean: 0.4454786479473114, gen p mean: -0.2427043616771698, mean p set: 0.4460590183734894
loss_pred:0.014136023819446564, decouple_loss:0.0015829515177756548
loss_pred:0.014517723582684994, decouple_loss:0.0016571644227951765
Iteration: 5128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457096755504608, gen p mean: -0.24196812510490417, mean p set: 0.4462839961051941
loss_pred:0.01396934874355793, decouple_loss:0.002063450636342168
The modified gen p mean: 0.44635310769081116, gen p mean: -0.2477949559688568, mean p set: 0.44692835211753845
loss_pred:0.013863597996532917, decouple_loss:0.00221663317643106
The modified gen p mean: 0.4472220242023468, gen p mean: -0.23696176707744598, mean p set: 0.4477542042732239
loss_pred:0.014483543112874031, decouple_loss:0.001772498246282339
Iteration: 5129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465874135494232, gen p mean: -0.24412864446640015, mean p set: 0.44716206192970276
loss_pred:0.014263191260397434, decouple_loss:0.0017003207467496395
The modified gen p mean: 0.44671913981437683, gen p mean: -0.2387959063053131, mean p set: 0.44729292392730713
loss_pred:0.01437349896878004, decouple_loss:0.0016005829675123096
The modified gen p mean: 0.4454568922519684, gen p mean: -0.24909250438213348, mean p set: 0.44598105549812317
loss_pred:0.013669849373400211, decouple_loss:0.0017672099638730288
Iteration: 5130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447770357131958, gen p mean: -0.24068208038806915, mean p set: 0.44834378361701965
loss_pred:0.013725602999329567, decouple_loss:0.002050562296062708
The modified gen p mean: 0.44845786690711975, gen p mean: -0.23795993626117706, mean p set: 0.4490286707878113
loss_pred:0.014518527314066887, decouple_loss:0.0020437417551875114
The modified gen p mean: 0.44657352566719055, gen p mean: -0.24175728857517242, mean p set: 0.44710773229599
loss_pred:0.01442210003733635, decouple_loss:0.001946540898643434
2023-04-28 02:48:39 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24506698548793793, mean p set: 0.4499112665653229
loss_pred:0.015307208523154259, decouple_loss:0.00162090256344527
The modified gen p mean: 0.4482835531234741, gen p mean: -0.24238093197345734, mean p set: 0.44879910349845886
loss_pred:0.01528973039239645, decouple_loss:0.0015086664352566004
The modified gen p mean: 0.4493020176887512, gen p mean: -0.24512766301631927, mean p set: 0.4498290419578552
loss_pred:0.014846148900687695, decouple_loss:0.0016702195862308145
WV_1_PC_1_EH_0_PS_30, loss: 0.015227693133056164, avg_mse: 0.022648628801107407
current test mse: 0.022649
Iteration: 5131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465863108634949, gen p mean: -0.24500499665737152, mean p set: 0.44716131687164307
loss_pred:0.014168430119752884, decouple_loss:0.001524775754660368
The modified gen p mean: 0.4461352527141571, gen p mean: -0.246202751994133, mean p set: 0.4467063546180725
loss_pred:0.014319845475256443, decouple_loss:0.0014603539602831006
The modified gen p mean: 0.44627758860588074, gen p mean: -0.24368098378181458, mean p set: 0.44680383801460266
loss_pred:0.01398920826613903, decouple_loss:0.0015459288842976093
Iteration: 5132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754642248153687, gen p mean: -0.25101909041404724, mean p set: 0.44808200001716614
loss_pred:0.013019775040447712, decouple_loss:0.0018794252537190914
The modified gen p mean: 0.447140097618103, gen p mean: -0.24699930846691132, mean p set: 0.44771286845207214
loss_pred:0.013691527768969536, decouple_loss:0.00187695084605366
The modified gen p mean: 0.4474335312843323, gen p mean: -0.23962393403053284, mean p set: 0.448009192943573
loss_pred:0.014308870770037174, decouple_loss:0.0018418115796521306
Iteration: 5133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474959969520569, gen p mean: -0.2529887855052948, mean p set: 0.44802701473236084
loss_pred:0.012752522714436054, decouple_loss:0.0016383163165301085
The modified gen p mean: 0.4470992684364319, gen p mean: -0.24717940390110016, mean p set: 0.4476804733276367
loss_pred:0.014610245823860168, decouple_loss:0.0018299700459465384
The modified gen p mean: 0.4483080208301544, gen p mean: -0.24826276302337646, mean p set: 0.448881059885025
loss_pred:0.013901561498641968, decouple_loss:0.0017027163412421942
Iteration: 5134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740527868270874, gen p mean: -0.24896229803562164, mean p set: 0.44793781638145447
loss_pred:0.01448169443756342, decouple_loss:0.0018121006432920694
The modified gen p mean: 0.4461727738380432, gen p mean: -0.2480098158121109, mean p set: 0.446748286485672
loss_pred:0.01436140201985836, decouple_loss:0.0016346602933481336
The modified gen p mean: 0.4473150074481964, gen p mean: -0.24616479873657227, mean p set: 0.4478902518749237
loss_pred:0.014230345375835896, decouple_loss:0.0015410827472805977
Iteration: 5135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44575831294059753, gen p mean: -0.24640940129756927, mean p set: 0.4463306665420532
loss_pred:0.014151261188089848, decouple_loss:0.0017329043475911021
The modified gen p mean: 0.44717150926589966, gen p mean: -0.2469451129436493, mean p set: 0.4477007985115051The modified gen p mean: 0.4465181827545166, gen p mean: -0.251162052154541, mean p set: 0.4470905363559723
loss_pred:0.013967837207019329, decouple_loss:0.001656716107390821
loss_pred:0.013838795013725758, decouple_loss:0.0018088910728693008
Iteration: 5136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711142778396606, gen p mean: -0.2509323060512543, mean p set: 0.44769522547721863
loss_pred:0.014122442342340946, decouple_loss:0.0014923480339348316
The modified gen p mean: 0.4469161927700043, gen p mean: -0.248118594288826, mean p set: 0.4474954903125763The modified gen p mean: 0.44655343890190125, gen p mean: -0.2501087486743927, mean p set: 0.44708412885665894
loss_pred:0.014023982919752598, decouple_loss:0.0014908678131178021
loss_pred:0.014091885648667812, decouple_loss:0.0015178171452134848
Iteration: 5137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44600191712379456, gen p mean: -0.2486596554517746, mean p set: 0.4465861916542053
loss_pred:0.013729778118431568, decouple_loss:0.0015617746394127607
The modified gen p mean: 0.4463742971420288, gen p mean: -0.2428462654352188, mean p set: 0.44694095849990845The modified gen p mean: 0.4480573832988739, gen p mean: -0.24787910282611847, mean p set: 0.44858217239379883
loss_pred:0.014553953893482685, decouple_loss:0.0016486733220517635
loss_pred:0.01368159893900156, decouple_loss:0.0016681189881637692
Iteration: 5138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781309366226196, gen p mean: -0.24727566540241241, mean p set: 0.44838783144950867
loss_pred:0.013869835995137691, decouple_loss:0.0014383929083123803
The modified gen p mean: 0.4480932056903839, gen p mean: -0.24122308194637299, mean p set: 0.44861549139022827
loss_pred:0.014076718129217625, decouple_loss:0.00152556539978832
The modified gen p mean: 0.4463597536087036, gen p mean: -0.24185790121555328, mean p set: 0.4469318985939026
loss_pred:0.014085795730352402, decouple_loss:0.0015971019165590405
Iteration: 5139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466092586517334, gen p mean: -0.24227425456047058, mean p set: 0.44717955589294434
loss_pred:0.013772568665444851, decouple_loss:0.0017765633529052138
The modified gen p mean: 0.44684693217277527, gen p mean: -0.24171561002731323, mean p set: 0.44741740822792053The modified gen p mean: 0.4458295702934265, gen p mean: -0.24337244033813477, mean p set: 0.44635844230651855
loss_pred:0.014490238390862942, decouple_loss:0.0017880790401250124
loss_pred:0.014125604182481766, decouple_loss:0.0018868400948122144
Iteration: 5140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717463850975037, gen p mean: -0.24243484437465668, mean p set: 0.44775307178497314
loss_pred:0.01300580520182848, decouple_loss:0.0016467416426166892
The modified gen p mean: 0.4448834955692291, gen p mean: -0.24689289927482605, mean p set: 0.4454576373100281
loss_pred:0.014047568663954735, decouple_loss:0.0016861081821843982
The modified gen p mean: 0.44706782698631287, gen p mean: -0.24259495735168457, mean p set: 0.44758957624435425
loss_pred:0.01413474977016449, decouple_loss:0.0015459974529221654
2023-04-28 02:52:02 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2411108762025833, mean p set: 0.4499112665653229
loss_pred:0.015337138436734676, decouple_loss:0.0019357057753950357
The modified gen p mean: 0.4482731223106384, gen p mean: -0.23847022652626038, mean p set: 0.44879910349845886
loss_pred:0.015296906232833862, decouple_loss:0.0019249414326623082
The modified gen p mean: 0.4493091404438019, gen p mean: -0.24093136191368103, mean p set: 0.4498290419578552
loss_pred:0.014881381765007973, decouple_loss:0.002105468651279807
WV_1_PC_1_EH_0_PS_30, loss: 0.015271244570612907, avg_mse: 0.022675028070807457
current test mse: 0.022675
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 5141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863829016685486, gen p mean: -0.24191267788410187, mean p set: 0.44916975498199463
loss_pred:0.01449507474899292, decouple_loss:0.0018712898017838597
The modified gen p mean: 0.44829171895980835, gen p mean: -0.24210703372955322, mean p set: 0.44887199997901917
loss_pred:0.0139461699873209, decouple_loss:0.001796404249034822
The modified gen p mean: 0.44885164499282837, gen p mean: -0.2359628975391388, mean p set: 0.4494262933731079
loss_pred:0.014382370747625828, decouple_loss:0.0019639343954622746
Iteration: 5142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893163442611694, gen p mean: -0.2405281960964203, mean p set: 0.4494645595550537
loss_pred:0.013829213567078114, decouple_loss:0.0016938317567110062
The modified gen p mean: 0.44763538241386414, gen p mean: -0.2327195703983307, mean p set: 0.4482038617134094
loss_pred:0.013876451179385185, decouple_loss:0.0016987001290544868
The modified gen p mean: 0.44709762930870056, gen p mean: -0.23982374370098114, mean p set: 0.4476754069328308
loss_pred:0.014015225693583488, decouple_loss:0.001708213472738862
Iteration: 5143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487180709838867, gen p mean: -0.2450471967458725, mean p set: 0.44924765825271606
loss_pred:0.013815291225910187, decouple_loss:0.0016919478075578809
The modified gen p mean: 0.4481191039085388, gen p mean: -0.24137166142463684, mean p set: 0.4486922323703766
loss_pred:0.014200436882674694, decouple_loss:0.001790604437701404
The modified gen p mean: 0.44796085357666016, gen p mean: -0.24369826912879944, mean p set: 0.44853806495666504
loss_pred:0.013516093604266644, decouple_loss:0.0015896998811513186
Iteration: 5144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802889227867126, gen p mean: -0.24529819190502167, mean p set: 0.44856706261634827
loss_pred:0.014051423408091068, decouple_loss:0.0017558110412210226
The modified gen p mean: 0.44792118668556213, gen p mean: -0.24419449269771576, mean p set: 0.4484924077987671
loss_pred:0.014155864715576172, decouple_loss:0.0018602462951093912
The modified gen p mean: 0.44626161456108093, gen p mean: -0.24425776302814484, mean p set: 0.44683340191841125
loss_pred:0.014247751794755459, decouple_loss:0.0017069659661501646
Iteration: 5145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493788778781891, gen p mean: -0.23884354531764984, mean p set: 0.44995051622390747
loss_pred:0.013991408981382847, decouple_loss:0.001725858310237527
The modified gen p mean: 0.4479540288448334, gen p mean: -0.24295201897621155, mean p set: 0.4484765827655792The modified gen p mean: 0.4485298693180084, gen p mean: -0.2420147806406021, mean p set: 0.44910410046577454
loss_pred:0.013859089463949203, decouple_loss:0.0017267774092033505
loss_pred:0.014104761183261871, decouple_loss:0.0016939088236540556
Iteration: 5146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861313700675964, gen p mean: -0.244559183716774, mean p set: 0.4491857588291168
loss_pred:0.013716277666389942, decouple_loss:0.0017352792201563716
The modified gen p mean: 0.44752269983291626, gen p mean: -0.24361439049243927, mean p set: 0.44804278016090393The modified gen p mean: 0.4472949206829071, gen p mean: -0.23471711575984955, mean p set: 0.447873055934906
loss_pred:0.013857157900929451, decouple_loss:0.0018676876788958907
loss_pred:0.014226334169507027, decouple_loss:0.0018788289744406939
Iteration: 5147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854608178138733, gen p mean: -0.24302761256694794, mean p set: 0.44911760091781616
loss_pred:0.013854963704943657, decouple_loss:0.001752251642756164
The modified gen p mean: 0.44804880023002625, gen p mean: -0.24491171538829803, mean p set: 0.44861912727355957
loss_pred:0.013956948183476925, decouple_loss:0.0018722634995356202
The modified gen p mean: 0.448728084564209, gen p mean: -0.24475924670696259, mean p set: 0.4492553174495697
loss_pred:0.013701599091291428, decouple_loss:0.001730838674120605
Iteration: 5148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476550221443176, gen p mean: -0.24387262761592865, mean p set: 0.4482291042804718
loss_pred:0.013838733546435833, decouple_loss:0.0018363150302320719
The modified gen p mean: 0.4481333792209625, gen p mean: -0.23972968757152557, mean p set: 0.44871124625205994
loss_pred:0.013941562734544277, decouple_loss:0.0018587942468002439
The modified gen p mean: 0.4474720358848572, gen p mean: -0.2457866221666336, mean p set: 0.4479973018169403
loss_pred:0.013880427926778793, decouple_loss:0.0017922776751220226
Iteration: 5149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465630054473877, gen p mean: -0.24891236424446106, mean p set: 0.44714176654815674
loss_pred:0.013816406019032001, decouple_loss:0.00170580530539155
The modified gen p mean: 0.44819775223731995, gen p mean: -0.2500031888484955, mean p set: 0.4487766921520233The modified gen p mean: 0.448697030544281, gen p mean: -0.24787260591983795, mean p set: 0.4492258131504059
loss_pred:0.013791489414870739, decouple_loss:0.0017374026356264949
loss_pred:0.013953793793916702, decouple_loss:0.0017918008379638195
Iteration: 5150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904467463493347, gen p mean: -0.25068944692611694, mean p set: 0.4496248662471771
loss_pred:0.013776294887065887, decouple_loss:0.0017097368836402893
The modified gen p mean: 0.4479851722717285, gen p mean: -0.24859492480754852, mean p set: 0.44855865836143494
loss_pred:0.013937427662312984, decouple_loss:0.0015079416334629059
The modified gen p mean: 0.44781219959259033, gen p mean: -0.2459721565246582, mean p set: 0.4483354985713959
loss_pred:0.013986676931381226, decouple_loss:0.001577193383127451
2023-04-28 02:56:06 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24748870730400085, mean p set: 0.4499112665653229
loss_pred:0.015354574657976627, decouple_loss:0.0017157377442345023
The modified gen p mean: 0.44826453924179077, gen p mean: -0.244991272687912, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930484890937805, gen p mean: -0.2471691071987152, mean p set: 0.4498290419578552
loss_pred:0.015289398841559887, decouple_loss:0.0015880813589319587
loss_pred:0.014899710193276405, decouple_loss:0.0015405646990984678
WV_1_PC_1_EH_0_PS_30, loss: 0.015261968597769737, avg_mse: 0.022708116099238396
current test mse: 0.022708
Iteration: 5151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471619427204132, gen p mean: -0.2484281063079834, mean p set: 0.4477364122867584
loss_pred:0.013976849615573883, decouple_loss:0.001707162125967443
The modified gen p mean: 0.44794631004333496, gen p mean: -0.25064194202423096, mean p set: 0.4485251009464264
loss_pred:0.014177084900438786, decouple_loss:0.0016996256308630109
The modified gen p mean: 0.44845467805862427, gen p mean: -0.2514512538909912, mean p set: 0.44898921251296997
loss_pred:0.013418949209153652, decouple_loss:0.0015801482368260622
Iteration: 5152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478982090950012, gen p mean: -0.2493523806333542, mean p set: 0.4484313726425171
loss_pred:0.013887536711990833, decouple_loss:0.0016228340100497007
The modified gen p mean: 0.44867581129074097, gen p mean: -0.24717721343040466, mean p set: 0.44925105571746826
loss_pred:0.013913662172853947, decouple_loss:0.00162000663112849
The modified gen p mean: 0.4489327669143677, gen p mean: -0.2449982762336731, mean p set: 0.44951245188713074
loss_pred:0.013654445298016071, decouple_loss:0.0015726732090115547
Iteration: 5153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814732670783997, gen p mean: -0.24709390103816986, mean p set: 0.4486764669418335
loss_pred:0.013422669842839241, decouple_loss:0.0015498414868488908
The modified gen p mean: 0.44863161444664, gen p mean: -0.2454712837934494, mean p set: 0.4492073655128479
loss_pred:0.013364320620894432, decouple_loss:0.0015853439690545201
The modified gen p mean: 0.4476642608642578, gen p mean: -0.2420637011528015, mean p set: 0.4482443630695343
loss_pred:0.01422476302832365, decouple_loss:0.001454839133657515
Iteration: 5154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44929182529449463, gen p mean: -0.24276292324066162, mean p set: 0.44981372356414795
loss_pred:0.013318324461579323, decouple_loss:0.0016147088026627898
The modified gen p mean: 0.44846174120903015, gen p mean: -0.24460217356681824, mean p set: 0.4490397274494171
loss_pred:0.01395060122013092, decouple_loss:0.0015239594504237175
The modified gen p mean: 0.4481107294559479, gen p mean: -0.2451397180557251, mean p set: 0.4486883282661438
loss_pred:0.013883243314921856, decouple_loss:0.0015302133979275823
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910159707069397, gen p mean: -0.2450452744960785, mean p set: 0.449685275554657
loss_pred:0.013777453452348709, decouple_loss:0.0016140241641551256
The modified gen p mean: 0.4486255645751953, gen p mean: -0.24123015999794006, mean p set: 0.4492001235485077The modified gen p mean: 0.4482863247394562, gen p mean: -0.2382124960422516, mean p set: 0.4488137364387512
loss_pred:0.013465951196849346, decouple_loss:0.0014783022925257683
loss_pred:0.013920668512582779, decouple_loss:0.0017742621712386608
Iteration: 5156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483751356601715, gen p mean: -0.24548931419849396, mean p set: 0.44895440340042114
loss_pred:0.01337515003979206, decouple_loss:0.0015555639984086156
The modified gen p mean: 0.448587566614151, gen p mean: -0.24143332242965698, mean p set: 0.44910916686058044
The modified gen p mean: 0.44728198647499084, gen p mean: -0.24097618460655212, mean p set: 0.44785305857658386
loss_pred:0.013938382267951965, decouple_loss:0.0015064588515087962
loss_pred:0.0138405067846179, decouple_loss:0.0014416485792025924
Iteration: 5157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486936330795288, gen p mean: -0.24209697544574738, mean p set: 0.44926580786705017
loss_pred:0.013600519858300686, decouple_loss:0.0017301753396168351
The modified gen p mean: 0.4484928250312805, gen p mean: -0.24616259336471558, mean p set: 0.44906941056251526The modified gen p mean: 0.44858911633491516, gen p mean: -0.24467869102954865, mean p set: 0.4491156041622162
loss_pred:0.013587994500994682, decouple_loss:0.0017027058638632298
loss_pred:0.013906647451221943, decouple_loss:0.0015998377930372953
Iteration: 5158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748762249946594, gen p mean: -0.24123799800872803, mean p set: 0.4480650722980499
loss_pred:0.013553259894251823, decouple_loss:0.0015894214157015085
The modified gen p mean: 0.448309063911438, gen p mean: -0.245806023478508, mean p set: 0.4488835632801056
loss_pred:0.013188249431550503, decouple_loss:0.0016091865254566073
The modified gen p mean: 0.44877561926841736, gen p mean: -0.251399427652359, mean p set: 0.44930675625801086
loss_pred:0.013660317286849022, decouple_loss:0.0014818526105955243
Iteration: 5159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945940375328064, gen p mean: -0.25089460611343384, mean p set: 0.450029194355011
loss_pred:0.01401589810848236, decouple_loss:0.001766733592376113
The modified gen p mean: 0.44951295852661133, gen p mean: -0.253042072057724, mean p set: 0.45003825426101685The modified gen p mean: 0.447786808013916, gen p mean: -0.24474820494651794, mean p set: 0.4483604431152344
loss_pred:0.013855449855327606, decouple_loss:0.0017788175027817488
loss_pred:0.013679453171789646, decouple_loss:0.0018575841095298529
Iteration: 5160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485992193222046, gen p mean: -0.24423269927501678, mean p set: 0.44917428493499756
loss_pred:0.013374351896345615, decouple_loss:0.0016087242402136326
The modified gen p mean: 0.4487975835800171, gen p mean: -0.2447153627872467, mean p set: 0.44937053322792053
loss_pred:0.013921353965997696, decouple_loss:0.0018856106325984001
The modified gen p mean: 0.44852524995803833, gen p mean: -0.24394896626472473, mean p set: 0.4490547776222229
loss_pred:0.013560059480369091, decouple_loss:0.0015007253969088197
2023-04-28 02:59:30 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24006497859954834, mean p set: 0.4499112665653229
loss_pred:0.01536484807729721, decouple_loss:0.001997515792027116
The modified gen p mean: 0.4482685327529907, gen p mean: -0.23770463466644287, mean p set: 0.44879910349845886
loss_pred:0.015232359059154987, decouple_loss:0.001895307213999331
The modified gen p mean: 0.4493091106414795, gen p mean: -0.24017059803009033, mean p set: 0.4498290419578552
loss_pred:0.014854129403829575, decouple_loss:0.0020849655847996473
WV_1_PC_1_EH_0_PS_30, loss: 0.015250075608491898, avg_mse: 0.022625721991062164
current test mse: 0.022626
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 5161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475572407245636, gen p mean: -0.23800864815711975, mean p set: 0.4480842351913452
loss_pred:0.013523849658668041, decouple_loss:0.0016973677556961775
The modified gen p mean: 0.44823870062828064, gen p mean: -0.23660723865032196, mean p set: 0.44881969690322876
loss_pred:0.014041915535926819, decouple_loss:0.0018167304806411266
The modified gen p mean: 0.44836974143981934, gen p mean: -0.23699449002742767, mean p set: 0.4489465653896332
loss_pred:0.013616759330034256, decouple_loss:0.0018500821897760034
Iteration: 5162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856417179107666, gen p mean: -0.23477803170681, mean p set: 0.44909510016441345
loss_pred:0.013753918930888176, decouple_loss:0.0017349972622469068
The modified gen p mean: 0.4481492340564728, gen p mean: -0.2382953017950058, mean p set: 0.44872117042541504
loss_pred:0.013971075415611267, decouple_loss:0.0016517238691449165
The modified gen p mean: 0.4475165903568268, gen p mean: -0.2362741380929947, mean p set: 0.4480955898761749
loss_pred:0.013907363638281822, decouple_loss:0.0016941745998337865
Iteration: 5163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44894567131996155, gen p mean: -0.23586589097976685, mean p set: 0.4494667053222656
loss_pred:0.012975705787539482, decouple_loss:0.0019751200452446938
The modified gen p mean: 0.44693493843078613, gen p mean: -0.23876410722732544, mean p set: 0.4475100636482239
loss_pred:0.013395038433372974, decouple_loss:0.0017465156270191073
The modified gen p mean: 0.44796961545944214, gen p mean: -0.23469427227973938, mean p set: 0.4485420286655426
loss_pred:0.013936588540673256, decouple_loss:0.001653784536756575
Iteration: 5164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493153393268585, gen p mean: -0.24137431383132935, mean p set: 0.44984567165374756
loss_pred:0.013602865859866142, decouple_loss:0.0016211229376494884
The modified gen p mean: 0.44834548234939575, gen p mean: -0.24519889056682587, mean p set: 0.44891637563705444
loss_pred:0.013628548011183739, decouple_loss:0.0018800835823640227
The modified gen p mean: 0.4487089216709137, gen p mean: -0.244892418384552, mean p set: 0.4492855668067932
loss_pred:0.013204476796090603, decouple_loss:0.0016476777382194996
Iteration: 5165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475463926792145, gen p mean: -0.23798586428165436, mean p set: 0.4481230676174164
loss_pred:0.013522720895707607, decouple_loss:0.0020026257261633873
The modified gen p mean: 0.44889235496520996, gen p mean: -0.23682567477226257, mean p set: 0.4494239091873169
The modified gen p mean: 0.44763660430908203, gen p mean: -0.2373649626970291, mean p set: 0.4482152760028839
loss_pred:0.012725708074867725, decouple_loss:0.0019491479033604264
loss_pred:0.013781975023448467, decouple_loss:0.0018597532762214541
Iteration: 5166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926050305366516, gen p mean: -0.23839472234249115, mean p set: 0.44984006881713867
loss_pred:0.013906915672123432, decouple_loss:0.0018404216971248388
The modified gen p mean: 0.4483463168144226, gen p mean: -0.24733035266399384, mean p set: 0.4489334523677826The modified gen p mean: 0.4505249559879303, gen p mean: -0.2452297955751419, mean p set: 0.4510541558265686
loss_pred:0.013339994475245476, decouple_loss:0.0018695681355893612
loss_pred:0.01335057895630598, decouple_loss:0.0020694625563919544
Iteration: 5167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480653405189514, gen p mean: -0.24229903519153595, mean p set: 0.44863688945770264
loss_pred:0.013071303255856037, decouple_loss:0.001998567720875144
The modified gen p mean: 0.44811856746673584, gen p mean: -0.24318863451480865, mean p set: 0.4486970603466034The modified gen p mean: 0.4473932683467865, gen p mean: -0.2397707849740982, mean p set: 0.4479316174983978
loss_pred:0.013814249075949192, decouple_loss:0.002117990516126156
loss_pred:0.014099052175879478, decouple_loss:0.0023162022698670626
Iteration: 5168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483257234096527, gen p mean: -0.2424783557653427, mean p set: 0.44889357686042786
loss_pred:0.013368668034672737, decouple_loss:0.001819036086089909
The modified gen p mean: 0.448070764541626, gen p mean: -0.23318089544773102, mean p set: 0.448650062084198
loss_pred:0.013537747785449028, decouple_loss:0.002203086158260703
The modified gen p mean: 0.44737422466278076, gen p mean: -0.2302958369255066, mean p set: 0.4479077458381653
loss_pred:0.013020534999668598, decouple_loss:0.002095054602250457
Iteration: 5169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481137692928314, gen p mean: -0.23292839527130127, mean p set: 0.44869375228881836
loss_pred:0.013527403585612774, decouple_loss:0.0019026217050850391
The modified gen p mean: 0.44811221957206726, gen p mean: -0.23784638941287994, mean p set: 0.4486437141895294
loss_pred:0.01349466759711504, decouple_loss:0.0019839119631797075
The modified gen p mean: 0.44875380396842957, gen p mean: -0.23941713571548462, mean p set: 0.44932815432548523
loss_pred:0.013195440173149109, decouple_loss:0.002030267845839262
Iteration: 5170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823017716407776, gen p mean: -0.22756290435791016, mean p set: 0.44880932569503784
loss_pred:0.013688978739082813, decouple_loss:0.0019043688662350178
The modified gen p mean: 0.44883599877357483, gen p mean: -0.23624280095100403, mean p set: 0.4494134187698364
loss_pred:0.012906859628856182, decouple_loss:0.0018796897493302822
The modified gen p mean: 0.4483974874019623, gen p mean: -0.23139052093029022, mean p set: 0.44892609119415283
loss_pred:0.013114245608448982, decouple_loss:0.0021094789262861013
2023-04-28 03:03:38 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23521846532821655, mean p set: 0.4499112665653229
loss_pred:0.015462362207472324, decouple_loss:0.0017137064132839441
The modified gen p mean: 0.44826674461364746, gen p mean: -0.23321640491485596, mean p set: 0.44879910349845886
loss_pred:0.015433678403496742, decouple_loss:0.001744808629155159
The modified gen p mean: 0.44929611682891846, gen p mean: -0.23577527701854706, mean p set: 0.4498290419578552
loss_pred:0.014958323910832405, decouple_loss:0.0016805360792204738
WV_1_PC_1_EH_0_PS_30, loss: 0.015370438806712627, avg_mse: 0.022853175178170204
current test mse: 0.022853
Iteration: 5171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496380090713501, gen p mean: -0.23386451601982117, mean p set: 0.4502216577529907
loss_pred:0.013746166601777077, decouple_loss:0.0020717279985547066
The modified gen p mean: 0.44862714409828186, gen p mean: -0.23872298002243042, mean p set: 0.4492042660713196
loss_pred:0.012785645201802254, decouple_loss:0.002052538562566042
The modified gen p mean: 0.44676876068115234, gen p mean: -0.2346719354391098, mean p set: 0.44730088114738464
loss_pred:0.01363882701843977, decouple_loss:0.0017881355015560985
Iteration: 5172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484919011592865, gen p mean: -0.23447449505329132, mean p set: 0.44902175664901733
loss_pred:0.013726671226322651, decouple_loss:0.0018049826612696052
The modified gen p mean: 0.44814544916152954, gen p mean: -0.24248535931110382, mean p set: 0.44871968030929565
loss_pred:0.012944715097546577, decouple_loss:0.0018936169799417257
The modified gen p mean: 0.44837093353271484, gen p mean: -0.2336096167564392, mean p set: 0.44894805550575256
loss_pred:0.013634699396789074, decouple_loss:0.0017057572258636355
Iteration: 5173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809311628341675, gen p mean: -0.24023203551769257, mean p set: 0.448621928691864
loss_pred:0.013714679516851902, decouple_loss:0.001778123201802373
The modified gen p mean: 0.4485345482826233, gen p mean: -0.24418489634990692, mean p set: 0.4491152763366699
loss_pred:0.013230396434664726, decouple_loss:0.0015538011211901903
The modified gen p mean: 0.4471627175807953, gen p mean: -0.24324454367160797, mean p set: 0.4477364122867584
loss_pred:0.013499913737177849, decouple_loss:0.0015506137860938907
Iteration: 5174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488288164138794, gen p mean: -0.2474474459886551, mean p set: 0.44935348629951477
loss_pred:0.013562359847128391, decouple_loss:0.0018115458078682423
The modified gen p mean: 0.45040827989578247, gen p mean: -0.2517029941082001, mean p set: 0.45098060369491577
loss_pred:0.01335140597075224, decouple_loss:0.0017635805997997522
The modified gen p mean: 0.44715678691864014, gen p mean: -0.24314069747924805, mean p set: 0.4477311074733734
loss_pred:0.013732073828577995, decouple_loss:0.0016170312883332372
Iteration: 5175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492962062358856, gen p mean: -0.2538142204284668, mean p set: 0.4498688280582428
loss_pred:0.013240979984402657, decouple_loss:0.0019483945798128843
The modified gen p mean: 0.44911688566207886, gen p mean: -0.24726419150829315, mean p set: 0.4496456980705261The modified gen p mean: 0.4480607509613037, gen p mean: -0.24204061925411224, mean p set: 0.44864022731781006
loss_pred:0.012883522547781467, decouple_loss:0.0018016839167103171
loss_pred:0.01389289740473032, decouple_loss:0.0015418573748320341
Iteration: 5176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447654664516449, gen p mean: -0.24493566155433655, mean p set: 0.448231041431427
loss_pred:0.013528654351830482, decouple_loss:0.001570977852679789
The modified gen p mean: 0.4479638934135437, gen p mean: -0.25339365005493164, mean p set: 0.4484964609146118The modified gen p mean: 0.44892555475234985, gen p mean: -0.24656237661838531, mean p set: 0.4495035707950592
loss_pred:0.012884178198873997, decouple_loss:0.001693558762781322
loss_pred:0.013028586283326149, decouple_loss:0.0016557478811591864
Iteration: 5177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895341992378235, gen p mean: -0.24854063987731934, mean p set: 0.449531614780426
loss_pred:0.013764461502432823, decouple_loss:0.0017888126894831657
The modified gen p mean: 0.4468591809272766, gen p mean: -0.248185396194458, mean p set: 0.44738414883613586The modified gen p mean: 0.4475709795951843, gen p mean: -0.2508683204650879, mean p set: 0.4481446146965027
loss_pred:0.01430325023829937, decouple_loss:0.0015515091363340616
loss_pred:0.01405695453286171, decouple_loss:0.001558900810778141
Iteration: 5178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478645920753479, gen p mean: -0.24398942291736603, mean p set: 0.44843941926956177
loss_pred:0.013261020183563232, decouple_loss:0.0015393405919894576
The modified gen p mean: 0.44879573583602905, gen p mean: -0.2513911724090576, mean p set: 0.44937342405319214
loss_pred:0.013028023764491081, decouple_loss:0.0018335659988224506
The modified gen p mean: 0.4477058947086334, gen p mean: -0.23780450224876404, mean p set: 0.44823071360588074
loss_pred:0.013256635516881943, decouple_loss:0.0017801843350753188
Iteration: 5179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827502965927124, gen p mean: -0.24305479228496552, mean p set: 0.4488562345504761
loss_pred:0.013439210131764412, decouple_loss:0.001497352379374206
The modified gen p mean: 0.4473204016685486, gen p mean: -0.23980635404586792, mean p set: 0.4478953182697296
loss_pred:0.013459905050694942, decouple_loss:0.0015343211125582457
The modified gen p mean: 0.44849473237991333, gen p mean: -0.23618151247501373, mean p set: 0.44901901483535767
loss_pred:0.013776717707514763, decouple_loss:0.0014837351627647877
Iteration: 5180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792789220809937, gen p mean: -0.23913291096687317, mean p set: 0.448505699634552
loss_pred:0.013492471538484097, decouple_loss:0.0015680151991546154
The modified gen p mean: 0.4477759897708893, gen p mean: -0.23845773935317993, mean p set: 0.4483504593372345
loss_pred:0.013128330931067467, decouple_loss:0.0018394322833046317
The modified gen p mean: 0.4467504918575287, gen p mean: -0.23706404864788055, mean p set: 0.44727620482444763
loss_pred:0.013822526670992374, decouple_loss:0.0015638895565643907
2023-04-28 03:07:02 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23816177248954773, mean p set: 0.4499112665653229
loss_pred:0.015383584424853325, decouple_loss:0.001608353923074901
The modified gen p mean: 0.44827544689178467, gen p mean: -0.23603592813014984, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492996633052826, gen p mean: -0.23834243416786194, mean p set: 0.4498290419578552
loss_pred:0.015380009077489376, decouple_loss:0.0015017916448414326
loss_pred:0.014865770004689693, decouple_loss:0.0016131086740642786
WV_1_PC_1_EH_0_PS_30, loss: 0.01528850942850113, avg_mse: 0.022716939449310303
current test mse: 0.022717
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 5181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473351836204529, gen p mean: -0.24146386981010437, mean p set: 0.4478631317615509
loss_pred:0.013636937364935875, decouple_loss:0.0014574350789189339
The modified gen p mean: 0.4485645294189453, gen p mean: -0.22844791412353516, mean p set: 0.44913890957832336
loss_pred:0.013380054384469986, decouple_loss:0.0017218015855178237
The modified gen p mean: 0.44865742325782776, gen p mean: -0.23448224365711212, mean p set: 0.4492388665676117
loss_pred:0.012969613075256348, decouple_loss:0.0017050516325980425
Iteration: 5182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447274774312973, gen p mean: -0.2363767772912979, mean p set: 0.44780102372169495
loss_pred:0.014038906432688236, decouple_loss:0.0017100258264690638
The modified gen p mean: 0.44718286395072937, gen p mean: -0.24254156649112701, mean p set: 0.44775673747062683
loss_pred:0.013082943856716156, decouple_loss:0.0017924243584275246
The modified gen p mean: 0.44641682505607605, gen p mean: -0.2448025345802307, mean p set: 0.446990966796875
loss_pred:0.013645957224071026, decouple_loss:0.0018898831913247705
Iteration: 5183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673964381217957, gen p mean: -0.23908334970474243, mean p set: 0.4472724497318268
loss_pred:0.013363444246351719, decouple_loss:0.0016725113382562995
The modified gen p mean: 0.44629859924316406, gen p mean: -0.24529750645160675, mean p set: 0.4468747675418854
loss_pred:0.013720550574362278, decouple_loss:0.0015188571996986866
The modified gen p mean: 0.45078712701797485, gen p mean: -0.23932825028896332, mean p set: 0.4513660967350006
loss_pred:0.013422933407127857, decouple_loss:0.001690734177827835
Iteration: 5184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486996531486511, gen p mean: -0.23483318090438843, mean p set: 0.4492274820804596
loss_pred:0.012993876822292805, decouple_loss:0.0019439731258898973
The modified gen p mean: 0.4474678337574005, gen p mean: -0.24539822340011597, mean p set: 0.44804564118385315
loss_pred:0.013395311310887337, decouple_loss:0.0014671775279566646
The modified gen p mean: 0.44779208302497864, gen p mean: -0.2448173612356186, mean p set: 0.44836726784706116
loss_pred:0.012797899544239044, decouple_loss:0.0014480085810646415
Iteration: 5185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486161768436432, gen p mean: -0.23569585382938385, mean p set: 0.44919851422309875
loss_pred:0.013382942415773869, decouple_loss:0.0016532257432118058
The modified gen p mean: 0.44812771677970886, gen p mean: -0.24556079506874084, mean p set: 0.4486563205718994The modified gen p mean: 0.44854360818862915, gen p mean: -0.24183619022369385, mean p set: 0.4491168260574341
loss_pred:0.013679823838174343, decouple_loss:0.0016536670736968517
loss_pred:0.012916377745568752, decouple_loss:0.0017194398678839207
Iteration: 5186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44913962483406067, gen p mean: -0.24408280849456787, mean p set: 0.44971415400505066
loss_pred:0.013739845715463161, decouple_loss:0.0018898111302405596
The modified gen p mean: 0.4477701187133789, gen p mean: -0.2401135116815567, mean p set: 0.44830387830734253The modified gen p mean: 0.44825610518455505, gen p mean: -0.24674595892429352, mean p set: 0.4488264322280884
loss_pred:0.013255275785923004, decouple_loss:0.001762746716849506
loss_pred:0.014084171503782272, decouple_loss:0.0015964352060109377
Iteration: 5187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478687345981598, gen p mean: -0.2380954623222351, mean p set: 0.44844454526901245
loss_pred:0.01275864988565445, decouple_loss:0.0019272200297564268
The modified gen p mean: 0.44925615191459656, gen p mean: -0.23103217780590057, mean p set: 0.44983553886413574The modified gen p mean: 0.44957423210144043, gen p mean: -0.24302394688129425, mean p set: 0.4501021206378937
loss_pred:0.013155277818441391, decouple_loss:0.0017656023846939206
loss_pred:0.013124806806445122, decouple_loss:0.0018440482672303915
Iteration: 5188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756725430488586, gen p mean: -0.23509803414344788, mean p set: 0.4481477439403534
loss_pred:0.013277929276227951, decouple_loss:0.0016339631984010339
The modified gen p mean: 0.448662132024765, gen p mean: -0.2293761819601059, mean p set: 0.4492424428462982The modified gen p mean: 0.4477035105228424, gen p mean: -0.23942409455776215, mean p set: 0.4482307732105255
loss_pred:0.01322601456195116, decouple_loss:0.0016069848788902164
loss_pred:0.013079878874123096, decouple_loss:0.0015212350990623236
Iteration: 5189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821974635124207, gen p mean: -0.2401835024356842, mean p set: 0.44879457354545593
loss_pred:0.013261489570140839, decouple_loss:0.001686256262473762
The modified gen p mean: 0.44826000928878784, gen p mean: -0.23721882700920105, mean p set: 0.44883567094802856
loss_pred:0.013617298565804958, decouple_loss:0.0016572510357946157
The modified gen p mean: 0.44743379950523376, gen p mean: -0.2420540750026703, mean p set: 0.44796544313430786
loss_pred:0.013365352526307106, decouple_loss:0.0016551344888284802
Iteration: 5190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931459426879883, gen p mean: -0.24049429595470428, mean p set: 0.44988885521888733
loss_pred:0.013515929691493511, decouple_loss:0.0015137309674173594
The modified gen p mean: 0.44794976711273193, gen p mean: -0.2443118393421173, mean p set: 0.4485265016555786
loss_pred:0.012774554081261158, decouple_loss:0.0016021664487197995
The modified gen p mean: 0.44829225540161133, gen p mean: -0.24234864115715027, mean p set: 0.4488143026828766
loss_pred:0.013348362408578396, decouple_loss:0.0015017164405435324
2023-04-28 03:11:04 testing...
The modified gen p mean: 0.4482681155204773, gen p mean: -0.24669480323791504, mean p set: 0.44879910349845886
loss_pred:0.015419766306877136, decouple_loss:0.0017976145027205348
The modified gen p mean: 0.4493076503276825, gen p mean: -0.24906288087368011, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24891439080238342, mean p set: 0.4499112665653229loss_pred:0.014937176369130611, decouple_loss:0.001987126423045993
loss_pred:0.01542886346578598, decouple_loss:0.001978709828108549
WV_1_PC_1_EH_0_PS_30, loss: 0.015357992611825466, avg_mse: 0.022811859846115112
current test mse: 0.022812
Iteration: 5191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481348693370819, gen p mean: -0.24718350172042847, mean p set: 0.44866693019866943
loss_pred:0.013379650190472603, decouple_loss:0.0016140271909534931
The modified gen p mean: 0.44840630888938904, gen p mean: -0.24230745434761047, mean p set: 0.44898515939712524
loss_pred:0.01301068440079689, decouple_loss:0.001983131980523467
The modified gen p mean: 0.44869381189346313, gen p mean: -0.2517625093460083, mean p set: 0.4492718279361725
loss_pred:0.013614396564662457, decouple_loss:0.0016614646883681417
Iteration: 5192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478274881839752, gen p mean: -0.2482738345861435, mean p set: 0.4483499228954315
loss_pred:0.013163899071514606, decouple_loss:0.0015167796518653631
The modified gen p mean: 0.4483075439929962, gen p mean: -0.242637038230896, mean p set: 0.4488862454891205
The modified gen p mean: 0.44827592372894287, gen p mean: -0.24264101684093475, mean p set: 0.44885557889938354
loss_pred:0.013429302722215652, decouple_loss:0.0015396050876006484
loss_pred:0.013069515116512775, decouple_loss:0.0015717004425823689
Iteration: 5193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474923014640808, gen p mean: -0.244973823428154, mean p set: 0.4480225145816803
loss_pred:0.013765670359134674, decouple_loss:0.0015586103545501828
The modified gen p mean: 0.4463915228843689, gen p mean: -0.2494877129793167, mean p set: 0.44696733355522156
The modified gen p mean: 0.44769516587257385, gen p mean: -0.24618278443813324, mean p set: 0.4482734203338623
loss_pred:0.013119693845510483, decouple_loss:0.0015268601709976792
loss_pred:0.013068226166069508, decouple_loss:0.0015655484749004245
Iteration: 5194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478350877761841, gen p mean: -0.24179919064044952, mean p set: 0.448408842086792
loss_pred:0.01344829611480236, decouple_loss:0.0015981505857780576
The modified gen p mean: 0.4501606523990631, gen p mean: -0.24066510796546936, mean p set: 0.450685054063797The modified gen p mean: 0.44819051027297974, gen p mean: -0.2400495558977127, mean p set: 0.44876742362976074
loss_pred:0.013341400772333145, decouple_loss:0.0015171596314758062
loss_pred:0.013494888320565224, decouple_loss:0.0015164944343268871
Iteration: 5195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487456977367401, gen p mean: -0.2352888286113739, mean p set: 0.449319064617157
loss_pred:0.013263529166579247, decouple_loss:0.001516386168077588
The modified gen p mean: 0.4460636079311371, gen p mean: -0.24415794014930725, mean p set: 0.44663533568382263
loss_pred:0.01320863887667656, decouple_loss:0.0015442355070263147
The modified gen p mean: 0.4501400589942932, gen p mean: -0.24235302209854126, mean p set: 0.45066288113594055
loss_pred:0.012985540553927422, decouple_loss:0.0015824873698875308
Iteration: 5196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475131332874298, gen p mean: -0.2370115965604782, mean p set: 0.44809263944625854
loss_pred:0.012989554554224014, decouple_loss:0.001651968341320753
The modified gen p mean: 0.4486735165119171, gen p mean: -0.23599527776241302, mean p set: 0.44920095801353455The modified gen p mean: 0.4485214948654175, gen p mean: -0.24298052489757538, mean p set: 0.4490965008735657
loss_pred:0.013415190391242504, decouple_loss:0.0015765504213050008
loss_pred:0.013168024830520153, decouple_loss:0.001445111120119691
Iteration: 5197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464665651321411, gen p mean: -0.24412745237350464, mean p set: 0.44704070687294006
loss_pred:0.012822051532566547, decouple_loss:0.0016511650756001472
The modified gen p mean: 0.4479667544364929, gen p mean: -0.23570594191551208, mean p set: 0.44854292273521423
loss_pred:0.013044404797255993, decouple_loss:0.0015311760362237692
The modified gen p mean: 0.4475441873073578, gen p mean: -0.2423541247844696, mean p set: 0.4480714499950409
loss_pred:0.012845778837800026, decouple_loss:0.001599546754732728
Iteration: 5198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480123519897461, gen p mean: -0.2400810271501541, mean p set: 0.4485826790332794
loss_pred:0.013242744840681553, decouple_loss:0.0013670448679476976
The modified gen p mean: 0.44816794991493225, gen p mean: -0.24525104463100433, mean p set: 0.4487411379814148The modified gen p mean: 0.4480566382408142, gen p mean: -0.24323059618473053, mean p set: 0.4485855996608734
loss_pred:0.01280901301652193, decouple_loss:0.0015273033641278744
loss_pred:0.013589355163276196, decouple_loss:0.0014363700756803155
Iteration: 5199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446975439786911, gen p mean: -0.24733299016952515, mean p set: 0.44755133986473083
loss_pred:0.012626000680029392, decouple_loss:0.0016767496708780527
The modified gen p mean: 0.44838136434555054, gen p mean: -0.24317821860313416, mean p set: 0.44895556569099426
loss_pred:0.013583017513155937, decouple_loss:0.0017594735836610198
The modified gen p mean: 0.4482446014881134, gen p mean: -0.2461995631456375, mean p set: 0.4487667679786682
loss_pred:0.013284945860505104, decouple_loss:0.0016746552428230643
Iteration: 5200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476805329322815, gen p mean: -0.2373477965593338, mean p set: 0.4482579529285431
loss_pred:0.013219643384218216, decouple_loss:0.0016232760390266776
The modified gen p mean: 0.4489902853965759, gen p mean: -0.24720872938632965, mean p set: 0.4495646357536316
loss_pred:0.013141111470758915, decouple_loss:0.0014600944705307484
The modified gen p mean: 0.44820332527160645, gen p mean: -0.24454185366630554, mean p set: 0.4487343728542328
loss_pred:0.013995090499520302, decouple_loss:0.0015106794890016317
2023-04-28 03:14:29 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2434305101633072, mean p set: 0.4499112665653229
loss_pred:0.015446648932993412, decouple_loss:0.0019037763122469187
The modified gen p mean: 0.4482688903808594, gen p mean: -0.24107027053833008, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930344820022583, gen p mean: -0.24366889894008636, mean p set: 0.4498290419578552
loss_pred:0.015415028668940067, decouple_loss:0.0018191804410889745
loss_pred:0.014933560974895954, decouple_loss:0.0017285007052123547
WV_1_PC_1_EH_0_PS_30, loss: 0.01535593718290329, avg_mse: 0.022793566808104515
current test mse: 0.022794
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 5201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672316312789917, gen p mean: -0.24825933575630188, mean p set: 0.4472491443157196
loss_pred:0.01426070835441351, decouple_loss:0.0017268843948841095
The modified gen p mean: 0.4467887878417969, gen p mean: -0.24087348580360413, mean p set: 0.44736430048942566
loss_pred:0.014139157719910145, decouple_loss:0.0018749285954982042
The modified gen p mean: 0.4481121301651001, gen p mean: -0.24249228835105896, mean p set: 0.44868743419647217
loss_pred:0.01415356807410717, decouple_loss:0.0018075562547892332
Iteration: 5202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485771954059601, gen p mean: -0.24408896267414093, mean p set: 0.44910916686058044
loss_pred:0.014252716675400734, decouple_loss:0.0017360774800181389
The modified gen p mean: 0.44744330644607544, gen p mean: -0.24541537463665009, mean p set: 0.44802361726760864
loss_pred:0.013977691531181335, decouple_loss:0.0018228421686217189
The modified gen p mean: 0.4472382962703705, gen p mean: -0.24197310209274292, mean p set: 0.4478200376033783
loss_pred:0.014424741268157959, decouple_loss:0.0017371495487168431
Iteration: 5203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44617167115211487, gen p mean: -0.24201475083827972, mean p set: 0.44670602679252625
loss_pred:0.014652431011199951, decouple_loss:0.001738578313961625
The modified gen p mean: 0.44724875688552856, gen p mean: -0.24285981059074402, mean p set: 0.44782111048698425
loss_pred:0.014569904655218124, decouple_loss:0.0017835868056863546
The modified gen p mean: 0.44655507802963257, gen p mean: -0.24715273082256317, mean p set: 0.4471310079097748
loss_pred:0.013826067559421062, decouple_loss:0.0017098571406677365
Iteration: 5204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764596223831177, gen p mean: -0.24389947950839996, mean p set: 0.44817429780960083
loss_pred:0.01418888196349144, decouple_loss:0.0020478270016610622
The modified gen p mean: 0.44831421971321106, gen p mean: -0.24256370961666107, mean p set: 0.4488847255706787
loss_pred:0.013950703665614128, decouple_loss:0.0020037759095430374
The modified gen p mean: 0.4465087056159973, gen p mean: -0.24814671277999878, mean p set: 0.44708749651908875
loss_pred:0.014667377807199955, decouple_loss:0.0017708452651277184
Iteration: 5205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479033946990967, gen p mean: -0.24180981516838074, mean p set: 0.4484269320964813
loss_pred:0.013765109702944756, decouple_loss:0.0016607866855338216
The modified gen p mean: 0.4477008879184723, gen p mean: -0.2430036962032318, mean p set: 0.4482831358909607
loss_pred:0.014113195240497589, decouple_loss:0.0017189874779433012
The modified gen p mean: 0.4466635584831238, gen p mean: -0.2445327192544937, mean p set: 0.44723477959632874
loss_pred:0.01474944781512022, decouple_loss:0.0017938686069101095
Iteration: 5206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481678903102875, gen p mean: -0.24788817763328552, mean p set: 0.4487501382827759
loss_pred:0.013735542073845863, decouple_loss:0.0018360858084633946
The modified gen p mean: 0.4467228651046753, gen p mean: -0.2447957694530487, mean p set: 0.4472969174385071The modified gen p mean: 0.44819289445877075, gen p mean: -0.24138222634792328, mean p set: 0.44871804118156433
loss_pred:0.013744667172431946, decouple_loss:0.0020349295809865
loss_pred:0.013982189819216728, decouple_loss:0.0018560093594715
Iteration: 5207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478926360607147, gen p mean: -0.24233607947826385, mean p set: 0.44842514395713806
loss_pred:0.014218107797205448, decouple_loss:0.0016645628493279219
The modified gen p mean: 0.44710013270378113, gen p mean: -0.2447328418493271, mean p set: 0.4476657211780548The modified gen p mean: 0.4464312493801117, gen p mean: -0.24776865541934967, mean p set: 0.44701075553894043
loss_pred:0.013718927279114723, decouple_loss:0.001702053821645677
loss_pred:0.014135994017124176, decouple_loss:0.0016841070028021932
Iteration: 5208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480222165584564, gen p mean: -0.24095559120178223, mean p set: 0.4485948383808136
loss_pred:0.014079566113650799, decouple_loss:0.0017845224356278777
The modified gen p mean: 0.44718122482299805, gen p mean: -0.2406647652387619, mean p set: 0.4477572739124298
loss_pred:0.014661891385912895, decouple_loss:0.0018680922221392393
The modified gen p mean: 0.44693756103515625, gen p mean: -0.24121488630771637, mean p set: 0.44747352600097656
loss_pred:0.013981025665998459, decouple_loss:0.0016791452653706074
Iteration: 5209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447194904088974, gen p mean: -0.24705126881599426, mean p set: 0.4477703869342804
loss_pred:0.014320085756480694, decouple_loss:0.0016136894701048732
The modified gen p mean: 0.4472593367099762, gen p mean: -0.24352867901325226, mean p set: 0.4478357136249542The modified gen p mean: 0.44707030057907104, gen p mean: -0.24255867302417755, mean p set: 0.4476010799407959
loss_pred:0.014019262045621872, decouple_loss:0.001513020135462284
loss_pred:0.014072032645344734, decouple_loss:0.0016031916020438075
Iteration: 5210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479125738143921, gen p mean: -0.24375368654727936, mean p set: 0.4484843611717224
loss_pred:0.013939287513494492, decouple_loss:0.0016067392425611615
The modified gen p mean: 0.44684693217277527, gen p mean: -0.24370522797107697, mean p set: 0.44742023944854736
loss_pred:0.013867620378732681, decouple_loss:0.0015513323014602065
The modified gen p mean: 0.44769522547721863, gen p mean: -0.24357126653194427, mean p set: 0.44822028279304504
loss_pred:0.013997863046824932, decouple_loss:0.0017636322882026434
2023-04-28 03:18:36 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2472052425146103, mean p set: 0.4499112665653229
loss_pred:0.015324966050684452, decouple_loss:0.0016899846959859133
The modified gen p mean: 0.4482690095901489, gen p mean: -0.2447671741247177, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492996633052826, gen p mean: -0.24764668941497803, mean p set: 0.4498290419578552
loss_pred:0.015229860320687294, decouple_loss:0.0018058900022879243
loss_pred:0.014823376201093197, decouple_loss:0.0016590090235695243
WV_1_PC_1_EH_0_PS_30, loss: 0.015211982652544975, avg_mse: 0.0225919671356678
current test mse: 0.022592
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484557807445526, gen p mean: -0.2513759136199951, mean p set: 0.4490325152873993
loss_pred:0.013568094931542873, decouple_loss:0.0017261308385059237
The modified gen p mean: 0.4480467438697815, gen p mean: -0.24780814349651337, mean p set: 0.44862401485443115
loss_pred:0.014274835586547852, decouple_loss:0.002015030710026622
The modified gen p mean: 0.4478973150253296, gen p mean: -0.2507566511631012, mean p set: 0.44843074679374695
loss_pred:0.014017886482179165, decouple_loss:0.0015808953903615475
Iteration: 5212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683822989463806, gen p mean: -0.2481176257133484, mean p set: 0.44737330079078674
loss_pred:0.013865179382264614, decouple_loss:0.0017095035873353481
The modified gen p mean: 0.44766369462013245, gen p mean: -0.2495638132095337, mean p set: 0.4482421875
loss_pred:0.013848545029759407, decouple_loss:0.0016189434099942446
The modified gen p mean: 0.44737836718559265, gen p mean: -0.24530768394470215, mean p set: 0.4479510188102722
loss_pred:0.014426016248762608, decouple_loss:0.001486302586272359
Iteration: 5213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476194381713867, gen p mean: -0.24594636261463165, mean p set: 0.4481441080570221
loss_pred:0.01380757987499237, decouple_loss:0.001587699051015079
The modified gen p mean: 0.4472031593322754, gen p mean: -0.24506761133670807, mean p set: 0.4477764964103699
loss_pred:0.014195299707353115, decouple_loss:0.0017912127077579498
The modified gen p mean: 0.44723331928253174, gen p mean: -0.25084930658340454, mean p set: 0.44780635833740234
loss_pred:0.014503913931548595, decouple_loss:0.0017238340806216002
Iteration: 5214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476204812526703, gen p mean: -0.24263127148151398, mean p set: 0.4481446444988251
loss_pred:0.014701718464493752, decouple_loss:0.0014931581681594253
The modified gen p mean: 0.446713387966156, gen p mean: -0.25314751267433167, mean p set: 0.4472888708114624
loss_pred:0.01396112609654665, decouple_loss:0.001581833465024829
The modified gen p mean: 0.44806089997291565, gen p mean: -0.2470565289258957, mean p set: 0.44864028692245483
loss_pred:0.014194671995937824, decouple_loss:0.0016155687626451254
Iteration: 5215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471546709537506, gen p mean: -0.2459089756011963, mean p set: 0.4477294087409973
loss_pred:0.014502917416393757, decouple_loss:0.001836815383285284
The modified gen p mean: 0.4473594129085541, gen p mean: -0.2435513138771057, mean p set: 0.44793686270713806The modified gen p mean: 0.4472607374191284, gen p mean: -0.24485556781291962, mean p set: 0.4477914571762085
loss_pred:0.014041322283446789, decouple_loss:0.001684732036665082
loss_pred:0.013590903021395206, decouple_loss:0.0015492948004975915
Iteration: 5216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473327100276947, gen p mean: -0.24374353885650635, mean p set: 0.4479072690010071
loss_pred:0.013524951413273811, decouple_loss:0.001544535392895341
The modified gen p mean: 0.44872957468032837, gen p mean: -0.2434401512145996, mean p set: 0.44930416345596313The modified gen p mean: 0.4481094181537628, gen p mean: -0.2419106662273407, mean p set: 0.4486437737941742
loss_pred:0.013815176673233509, decouple_loss:0.0016939084744080901
loss_pred:0.014020060189068317, decouple_loss:0.0014959630789235234
Iteration: 5217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477319121360779, gen p mean: -0.24434171617031097, mean p set: 0.4483122229576111
loss_pred:0.013807632960379124, decouple_loss:0.001611656742170453
The modified gen p mean: 0.4469979405403137, gen p mean: -0.2428179383277893, mean p set: 0.4475705623626709
loss_pred:0.013659548945724964, decouple_loss:0.001763929845765233
The modified gen p mean: 0.4492676556110382, gen p mean: -0.2458011507987976, mean p set: 0.4497888684272766
loss_pred:0.013664085417985916, decouple_loss:0.0016441363841295242
Iteration: 5218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482269585132599, gen p mean: -0.2441399097442627, mean p set: 0.44880321621894836
loss_pred:0.014034870080649853, decouple_loss:0.0015819690888747573
The modified gen p mean: 0.4467092752456665, gen p mean: -0.24747700989246368, mean p set: 0.44728556275367737
loss_pred:0.014585240744054317, decouple_loss:0.0016955911414697766
The modified gen p mean: 0.4473211169242859, gen p mean: -0.24524903297424316, mean p set: 0.4478473961353302
loss_pred:0.014420974999666214, decouple_loss:0.0016279384726658463
Iteration: 5219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467320144176483, gen p mean: -0.2401544749736786, mean p set: 0.4473079442977905
loss_pred:0.01402383390814066, decouple_loss:0.001509621855802834
The modified gen p mean: 0.4473923146724701, gen p mean: -0.24127283692359924, mean p set: 0.4479181170463562
loss_pred:0.013782938942313194, decouple_loss:0.001312843058258295
The modified gen p mean: 0.4467868506908417, gen p mean: -0.245738223195076, mean p set: 0.44736161828041077
loss_pred:0.013646978884935379, decouple_loss:0.0014123190194368362
Iteration: 5220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713693857192993, gen p mean: -0.2387867569923401, mean p set: 0.44771599769592285
loss_pred:0.013733429834246635, decouple_loss:0.0017846215050667524
The modified gen p mean: 0.44656234979629517, gen p mean: -0.23990656435489655, mean p set: 0.4470870792865753The modified gen p mean: 0.4475161135196686, gen p mean: -0.23805347084999084, mean p set: 0.4480918347835541
loss_pred:0.014487276785075665, decouple_loss:0.0015417562099173665
loss_pred:0.014626110903918743, decouple_loss:0.0016018670285120606
2023-04-28 03:22:00 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2403699904680252, mean p set: 0.4499112665653229
loss_pred:0.015329660847783089, decouple_loss:0.0015483235474675894
The modified gen p mean: 0.44827431440353394, gen p mean: -0.2381524294614792, mean p set: 0.44879910349845886
loss_pred:0.015230672433972359, decouple_loss:0.0015247475821524858
The modified gen p mean: 0.44929730892181396, gen p mean: -0.24080826342105865, mean p set: 0.4498290419578552
loss_pred:0.014859394170343876, decouple_loss:0.0015872345538809896
WV_1_PC_1_EH_0_PS_30, loss: 0.015217581763863564, avg_mse: 0.022635366767644882
current test mse: 0.022635
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 5221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470360577106476, gen p mean: -0.23935049772262573, mean p set: 0.4475724399089813
loss_pred:0.013694394379854202, decouple_loss:0.0015362893464043736
The modified gen p mean: 0.4466029107570648, gen p mean: -0.2389007806777954, mean p set: 0.4471836984157562
loss_pred:0.014452872797846794, decouple_loss:0.0015536787686869502
The modified gen p mean: 0.44698813557624817, gen p mean: -0.24319139122962952, mean p set: 0.4475627839565277
loss_pred:0.012988739646971226, decouple_loss:0.001612969907000661
Iteration: 5222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459337890148163, gen p mean: -0.23810605704784393, mean p set: 0.4464643895626068
loss_pred:0.014063172973692417, decouple_loss:0.0015617855824530125
The modified gen p mean: 0.44649332761764526, gen p mean: -0.2373383790254593, mean p set: 0.4470658302307129The modified gen p mean: 0.4472373425960541, gen p mean: -0.23990033566951752, mean p set: 0.44781920313835144
loss_pred:0.014247190207242966, decouple_loss:0.0015449156053364277loss_pred:0.014355850405991077, decouple_loss:0.001383376307785511
Iteration: 5223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468652904033661, gen p mean: -0.24044331908226013, mean p set: 0.447394996881485
loss_pred:0.014264659024775028, decouple_loss:0.0016083529917523265
The modified gen p mean: 0.44701457023620605, gen p mean: -0.2419983446598053, mean p set: 0.447593629360199The modified gen p mean: 0.44642552733421326, gen p mean: -0.24499422311782837, mean p set: 0.44700121879577637
loss_pred:0.013871213421225548, decouple_loss:0.0017473322805017233loss_pred:0.014134450815618038, decouple_loss:0.0015994630521163344
Iteration: 5224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479321837425232, gen p mean: -0.24100519716739655, mean p set: 0.44846251606941223
loss_pred:0.013720656745135784, decouple_loss:0.001669862074777484
The modified gen p mean: 0.44686222076416016, gen p mean: -0.24154402315616608, mean p set: 0.4474363923072815The modified gen p mean: 0.44594690203666687, gen p mean: -0.24098296463489532, mean p set: 0.4465225338935852
loss_pred:0.014037066139280796, decouple_loss:0.0017079669050872326
loss_pred:0.013973907567560673, decouple_loss:0.0016135115874931216
Iteration: 5225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460484981536865, gen p mean: -0.24213361740112305, mean p set: 0.4466211497783661
loss_pred:0.013842752203345299, decouple_loss:0.0018795296782627702
The modified gen p mean: 0.44799667596817017, gen p mean: -0.24620935320854187, mean p set: 0.448570191860199
loss_pred:0.014001215808093548, decouple_loss:0.0016717540565878153
The modified gen p mean: 0.446246474981308, gen p mean: -0.24666047096252441, mean p set: 0.4467797577381134
loss_pred:0.014168228954076767, decouple_loss:0.001798657001927495
Iteration: 5226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677266478538513, gen p mean: -0.24357010424137115, mean p set: 0.4473433792591095
loss_pred:0.01407588180154562, decouple_loss:0.0016580373048782349
The modified gen p mean: 0.4470847547054291, gen p mean: -0.24569815397262573, mean p set: 0.4476585388183594The modified gen p mean: 0.44754311442375183, gen p mean: -0.2453574240207672, mean p set: 0.44806966185569763
loss_pred:0.014139554463326931, decouple_loss:0.0016447078669443727
loss_pred:0.013711544685065746, decouple_loss:0.0015572390984743834
Iteration: 5227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695907831192017, gen p mean: -0.2444322258234024, mean p set: 0.4475339949131012
The modified gen p mean: 0.4477606415748596, gen p mean: -0.24501213431358337, mean p set: 0.44833290576934814
loss_pred:0.014716348610818386, decouple_loss:0.001720614149235189
loss_pred:0.013905244879424572, decouple_loss:0.0018451536307111382
The modified gen p mean: 0.4480416476726532, gen p mean: -0.24097232520580292, mean p set: 0.44856566190719604
loss_pred:0.013752526603639126, decouple_loss:0.0018533425172790885
Iteration: 5228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459620714187622, gen p mean: -0.2366204559803009, mean p set: 0.4465442895889282
loss_pred:0.014090098440647125, decouple_loss:0.0017706801882013679
The modified gen p mean: 0.44722142815589905, gen p mean: -0.24627459049224854, mean p set: 0.4478035867214203
loss_pred:0.014011639170348644, decouple_loss:0.001799978781491518
The modified gen p mean: 0.4474756419658661, gen p mean: -0.2403571903705597, mean p set: 0.4479915201663971
loss_pred:0.013710047118365765, decouple_loss:0.001737750368192792
Iteration: 5229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755324721336365, gen p mean: -0.241060271859169, mean p set: 0.4481275677680969
The modified gen p mean: 0.4483244717121124, gen p mean: -0.2504221796989441, mean p set: 0.4489026963710785
loss_pred:0.013711069710552692, decouple_loss:0.0017090109176933765loss_pred:0.013767050579190254, decouple_loss:0.001556157018058002
The modified gen p mean: 0.44620653986930847, gen p mean: -0.24144259095191956, mean p set: 0.44673141837120056
loss_pred:0.014399109408259392, decouple_loss:0.0014701469335705042
Iteration: 5230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468189477920532, gen p mean: -0.24458539485931396, mean p set: 0.44738972187042236
The modified gen p mean: 0.4467722475528717, gen p mean: -0.24225914478302002, mean p set: 0.4473459720611572
loss_pred:0.014021885581314564, decouple_loss:0.001629355363547802loss_pred:0.014368683099746704, decouple_loss:0.0017409900901839137
The modified gen p mean: 0.44714343547821045, gen p mean: -0.24830521643161774, mean p set: 0.44767507910728455
loss_pred:0.013338477350771427, decouple_loss:0.0017707771621644497
2023-04-28 03:26:02 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24453933537006378, mean p set: 0.4499112665653229
loss_pred:0.015311486087739468, decouple_loss:0.0016588163562119007
The modified gen p mean: 0.4482729732990265, gen p mean: -0.24210543930530548, mean p set: 0.44879910349845886
The modified gen p mean: 0.44931143522262573, gen p mean: -0.2448815256357193, mean p set: 0.4498290419578552
loss_pred:0.015222685411572456, decouple_loss:0.0017015032935887575
loss_pred:0.014809385873377323, decouple_loss:0.0017023535910993814
WV_1_PC_1_EH_0_PS_30, loss: 0.015198897570371628, avg_mse: 0.022617587819695473
current test mse: 0.022618
Iteration: 5231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670164585113525, gen p mean: -0.2465122491121292, mean p set: 0.4472809433937073
loss_pred:0.014074397273361683, decouple_loss:0.0016388553194701672
The modified gen p mean: 0.4469865560531616, gen p mean: -0.25046494603157043, mean p set: 0.4475582242012024
loss_pred:0.013538682833313942, decouple_loss:0.0016955742612481117
The modified gen p mean: 0.44877833127975464, gen p mean: -0.2542683482170105, mean p set: 0.44930580258369446
loss_pred:0.013642500154674053, decouple_loss:0.0017509905155748129
Iteration: 5232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469423294067383, gen p mean: -0.2476806789636612, mean p set: 0.4474670886993408
loss_pred:0.013545357622206211, decouple_loss:0.0017094039358198643
The modified gen p mean: 0.44687098264694214, gen p mean: -0.24007166922092438, mean p set: 0.4474518895149231
loss_pred:0.013948551379144192, decouple_loss:0.0015920206205919385
The modified gen p mean: 0.4460061490535736, gen p mean: -0.2379748523235321, mean p set: 0.44658011198043823
loss_pred:0.014379184693098068, decouple_loss:0.0017931783804669976
Iteration: 5233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463948905467987, gen p mean: -0.23941446840763092, mean p set: 0.44692397117614746
loss_pred:0.014198784716427326, decouple_loss:0.0015586718218401074
The modified gen p mean: 0.44793227314949036, gen p mean: -0.24823212623596191, mean p set: 0.44850221276283264
loss_pred:0.013589362613856792, decouple_loss:0.0016132391756400466
The modified gen p mean: 0.44701024889945984, gen p mean: -0.2432904690504074, mean p set: 0.447585791349411
loss_pred:0.01383293978869915, decouple_loss:0.0013912171125411987
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471549987792969, gen p mean: -0.24304528534412384, mean p set: 0.4476762115955353
loss_pred:0.013536232523620129, decouple_loss:0.0016355799743905663
The modified gen p mean: 0.4469250440597534, gen p mean: -0.24070069193840027, mean p set: 0.4474965035915375
loss_pred:0.013588326051831245, decouple_loss:0.0016262871213257313
The modified gen p mean: 0.4464433193206787, gen p mean: -0.23991312086582184, mean p set: 0.44701918959617615
loss_pred:0.01433851383626461, decouple_loss:0.001706319279037416
Iteration: 5235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726306200027466, gen p mean: -0.24044902622699738, mean p set: 0.4478381872177124
loss_pred:0.013664716854691505, decouple_loss:0.001751843374222517
The modified gen p mean: 0.4471510350704193, gen p mean: -0.2387392222881317, mean p set: 0.44772762060165405The modified gen p mean: 0.44649937748908997, gen p mean: -0.236787348985672, mean p set: 0.44702303409576416
loss_pred:0.013285882771015167, decouple_loss:0.0017303002532571554
loss_pred:0.014153138734400272, decouple_loss:0.0016209437744691968
Iteration: 5236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467470943927765, gen p mean: -0.23795582354068756, mean p set: 0.44731974601745605
loss_pred:0.013629041612148285, decouple_loss:0.0015413117362186313
The modified gen p mean: 0.44670721888542175, gen p mean: -0.2357219010591507, mean p set: 0.44724246859550476
The modified gen p mean: 0.4477135241031647, gen p mean: -0.23704776167869568, mean p set: 0.44829118251800537
loss_pred:0.013713683933019638, decouple_loss:0.0016627120785415173
loss_pred:0.013542304746806622, decouple_loss:0.001541396020911634
Iteration: 5237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725117087364197, gen p mean: -0.234688401222229, mean p set: 0.44783177971839905
loss_pred:0.014043670147657394, decouple_loss:0.0014253007248044014
The modified gen p mean: 0.44660601019859314, gen p mean: -0.2364945262670517, mean p set: 0.44718724489212036
loss_pred:0.01442431379109621, decouple_loss:0.001564301666803658
The modified gen p mean: 0.4471750259399414, gen p mean: -0.23592868447303772, mean p set: 0.4477064609527588
loss_pred:0.01358028408139944, decouple_loss:0.001477921730838716
Iteration: 5238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44607365131378174, gen p mean: -0.23356905579566956, mean p set: 0.4466512203216553
loss_pred:0.014584344811737537, decouple_loss:0.0016024288488551974
The modified gen p mean: 0.44679006934165955, gen p mean: -0.2326444387435913, mean p set: 0.447368860244751
loss_pred:0.014206169173121452, decouple_loss:0.00159017916303128
The modified gen p mean: 0.44777557253837585, gen p mean: -0.23618410527706146, mean p set: 0.4483036994934082
loss_pred:0.013500027358531952, decouple_loss:0.0017782517243176699
Iteration: 5239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761568307876587, gen p mean: -0.23895861208438873, mean p set: 0.44819772243499756
loss_pred:0.01428233366459608, decouple_loss:0.0014810829889029264
The modified gen p mean: 0.44686341285705566, gen p mean: -0.23947514593601227, mean p set: 0.4474417567253113The modified gen p mean: 0.446717232465744, gen p mean: -0.24036039412021637, mean p set: 0.44724223017692566
loss_pred:0.01397930458188057, decouple_loss:0.0015217927284538746
loss_pred:0.01436245534569025, decouple_loss:0.0015380578115582466
Iteration: 5240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459398090839386, gen p mean: -0.23781093955039978, mean p set: 0.44651639461517334
loss_pred:0.014021914452314377, decouple_loss:0.0016946789110079408
The modified gen p mean: 0.44593167304992676, gen p mean: -0.24051862955093384, mean p set: 0.446504145860672The modified gen p mean: 0.4457986354827881, gen p mean: -0.24043133854866028, mean p set: 0.4463328719139099
loss_pred:0.013973329216241837, decouple_loss:0.0017368248663842678
loss_pred:0.013708009384572506, decouple_loss:0.0015147653175517917
2023-04-28 03:29:25 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24110902845859528, mean p set: 0.4499112665653229
loss_pred:0.01533576287329197, decouple_loss:0.0016260298434644938
The modified gen p mean: 0.44826576113700867, gen p mean: -0.2385118156671524, mean p set: 0.44879910349845886
loss_pred:0.015193338505923748, decouple_loss:0.0014936794759705663
The modified gen p mean: 0.44929930567741394, gen p mean: -0.24127799272537231, mean p set: 0.4498290419578552
loss_pred:0.014843645505607128, decouple_loss:0.0015566656365990639
WV_1_PC_1_EH_0_PS_30, loss: 0.015202189795672894, avg_mse: 0.022573860362172127
current test mse: 0.022574
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 5241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474123418331146, gen p mean: -0.2457731068134308, mean p set: 0.44793838262557983
loss_pred:0.013650113716721535, decouple_loss:0.001782998675480485
The modified gen p mean: 0.4477877914905548, gen p mean: -0.24534167349338531, mean p set: 0.44836175441741943
The modified gen p mean: 0.4482905864715576, gen p mean: -0.23693625628948212, mean p set: 0.4488696753978729
loss_pred:0.013763939961791039, decouple_loss:0.0017977269599214196
loss_pred:0.01335863210260868, decouple_loss:0.001732096541672945
Iteration: 5242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481196403503418, gen p mean: -0.23647108674049377, mean p set: 0.4486429989337921
loss_pred:0.013832014985382557, decouple_loss:0.0018513075774535537
The modified gen p mean: 0.44653525948524475, gen p mean: -0.23766669631004333, mean p set: 0.447108656167984
loss_pred:0.013215648010373116, decouple_loss:0.0018043284071609378
The modified gen p mean: 0.44779840111732483, gen p mean: -0.23731429874897003, mean p set: 0.4483778774738312
loss_pred:0.013654096983373165, decouple_loss:0.0017601558938622475
Iteration: 5243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462326467037201, gen p mean: -0.23942865431308746, mean p set: 0.44676467776298523
loss_pred:0.013323872350156307, decouple_loss:0.0018359263194724917
The modified gen p mean: 0.44662055373191833, gen p mean: -0.24666722118854523, mean p set: 0.4471994936466217
loss_pred:0.013990778475999832, decouple_loss:0.0018730282317847013
The modified gen p mean: 0.4470004141330719, gen p mean: -0.24088941514492035, mean p set: 0.4475743770599365
loss_pred:0.014628998935222626, decouple_loss:0.001920210779644549
Iteration: 5244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809308648109436, gen p mean: -0.24096789956092834, mean p set: 0.4486168920993805
loss_pred:0.013616717420518398, decouple_loss:0.0017785080708563328
The modified gen p mean: 0.4476947486400604, gen p mean: -0.24367475509643555, mean p set: 0.44827136397361755
loss_pred:0.013299420475959778, decouple_loss:0.0017383490921929479
The modified gen p mean: 0.44707512855529785, gen p mean: -0.24202154576778412, mean p set: 0.44765228033065796
loss_pred:0.014178338460624218, decouple_loss:0.0017185588367283344
Iteration: 5245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471549689769745, gen p mean: -0.23955188691616058, mean p set: 0.4477385878562927
loss_pred:0.013768061064183712, decouple_loss:0.0019514671294018626
The modified gen p mean: 0.4477229714393616, gen p mean: -0.2403211146593094, mean p set: 0.44824886322021484The modified gen p mean: 0.4461725354194641, gen p mean: -0.23236232995986938, mean p set: 0.44675159454345703
loss_pred:0.013299062848091125, decouple_loss:0.0019823366310447454
loss_pred:0.014396747574210167, decouple_loss:0.001911548781208694
Iteration: 5246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879409670829773, gen p mean: -0.2278156876564026, mean p set: 0.44937291741371155
loss_pred:0.013525315560400486, decouple_loss:0.0019333219388499856
The modified gen p mean: 0.4468243718147278, gen p mean: -0.233668252825737, mean p set: 0.4474049210548401The modified gen p mean: 0.4471900463104248, gen p mean: -0.2378331422805786, mean p set: 0.44772061705589294
loss_pred:0.01373539213091135, decouple_loss:0.0018942870665341616
loss_pred:0.013636728748679161, decouple_loss:0.0018427217146381736
Iteration: 5247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695064425468445, gen p mean: -0.23646080493927002, mean p set: 0.4475267231464386
loss_pred:0.013719122856855392, decouple_loss:0.0016441259067505598
The modified gen p mean: 0.44620469212532043, gen p mean: -0.2391343116760254, mean p set: 0.44677630066871643
loss_pred:0.014099759981036186, decouple_loss:0.001604543998837471
The modified gen p mean: 0.44825196266174316, gen p mean: -0.2314128875732422, mean p set: 0.44877946376800537
loss_pred:0.013053164817392826, decouple_loss:0.0018171427072957158
Iteration: 5248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702088832855225, gen p mean: -0.2412814050912857, mean p set: 0.44759422540664673
loss_pred:0.013456284068524837, decouple_loss:0.0018203739309683442
The modified gen p mean: 0.4474128484725952, gen p mean: -0.2345457226037979, mean p set: 0.44798827171325684
loss_pred:0.013047824613749981, decouple_loss:0.001766797387972474
The modified gen p mean: 0.44794490933418274, gen p mean: -0.2346467524766922, mean p set: 0.44847285747528076
loss_pred:0.013347942382097244, decouple_loss:0.0019606321584433317
Iteration: 5249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466816186904907, gen p mean: -0.24205631017684937, mean p set: 0.44725939631462097
loss_pred:0.013763693161308765, decouple_loss:0.001743194181472063
The modified gen p mean: 0.4468260109424591, gen p mean: -0.236483633518219, mean p set: 0.4474024176597595
loss_pred:0.013465335592627525, decouple_loss:0.0020316224545240402
The modified gen p mean: 0.4473813474178314, gen p mean: -0.24025283753871918, mean p set: 0.44790735840797424
loss_pred:0.01347547397017479, decouple_loss:0.0017174851382151246
Iteration: 5250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484403729438782, gen p mean: -0.236766517162323, mean p set: 0.4490176737308502
loss_pred:0.013264636509120464, decouple_loss:0.002066686050966382
The modified gen p mean: 0.4467427730560303, gen p mean: -0.2438463568687439, mean p set: 0.4473215639591217The modified gen p mean: 0.4468669593334198, gen p mean: -0.23525793850421906, mean p set: 0.44739410281181335
loss_pred:0.013728303834795952, decouple_loss:0.0017431647283956409
loss_pred:0.014428547583520412, decouple_loss:0.0017230177763849497
2023-04-28 03:33:36 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23957249522209167, mean p set: 0.4499112665653229
loss_pred:0.015444665215909481, decouple_loss:0.0019481986528262496
The modified gen p mean: 0.4482743740081787, gen p mean: -0.23710376024246216, mean p set: 0.44879910349845886
The modified gen p mean: 0.4493018388748169, gen p mean: -0.23983173072338104, mean p set: 0.4498290419578552
loss_pred:0.015378070995211601, decouple_loss:0.0017048950539901853
loss_pred:0.014995092526078224, decouple_loss:0.001848425716161728
WV_1_PC_1_EH_0_PS_30, loss: 0.015364302322268486, avg_mse: 0.022824373096227646
current test mse: 0.022824
Iteration: 5251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472138583660126, gen p mean: -0.2388465255498886, mean p set: 0.44779151678085327
loss_pred:0.013499618507921696, decouple_loss:0.001777263474650681
The modified gen p mean: 0.4475296437740326, gen p mean: -0.23507636785507202, mean p set: 0.4481112062931061
loss_pred:0.014131701551377773, decouple_loss:0.001985006732866168
The modified gen p mean: 0.44716325402259827, gen p mean: -0.23878148198127747, mean p set: 0.4476914703845978
loss_pred:0.013724992983043194, decouple_loss:0.0018415203085169196
Iteration: 5252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474189579486847, gen p mean: -0.24251660704612732, mean p set: 0.44795170426368713
loss_pred:0.013555570505559444, decouple_loss:0.001799340476281941
The modified gen p mean: 0.4471690356731415, gen p mean: -0.2405574470758438, mean p set: 0.4477514624595642The modified gen p mean: 0.4479530453681946, gen p mean: -0.24279001355171204, mean p set: 0.4485274851322174
loss_pred:0.013131129555404186, decouple_loss:0.0016967786941677332loss_pred:0.013613341376185417, decouple_loss:0.0017926194705069065
Iteration: 5253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727540016174316, gen p mean: -0.24191488325595856, mean p set: 0.4478025436401367
loss_pred:0.013458531349897385, decouple_loss:0.0017825639806687832
The modified gen p mean: 0.44645556807518005, gen p mean: -0.23573385179042816, mean p set: 0.4470299780368805The modified gen p mean: 0.44731801748275757, gen p mean: -0.23425820469856262, mean p set: 0.4478895962238312
loss_pred:0.014043677598237991, decouple_loss:0.0018995917635038495
loss_pred:0.013052773661911488, decouple_loss:0.002011003205552697
Iteration: 5254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785547256469727, gen p mean: -0.2334945946931839, mean p set: 0.4483802020549774
loss_pred:0.013194561004638672, decouple_loss:0.0019363266183063388
The modified gen p mean: 0.44809049367904663, gen p mean: -0.23447869718074799, mean p set: 0.4486709535121918
loss_pred:0.012975211255252361, decouple_loss:0.0020000063814222813
The modified gen p mean: 0.4479916989803314, gen p mean: -0.2358262985944748, mean p set: 0.4485653042793274
loss_pred:0.012841620482504368, decouple_loss:0.00179526477586478
Iteration: 5255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867146015167236, gen p mean: -0.23205815255641937, mean p set: 0.44924309849739075
loss_pred:0.01358872652053833, decouple_loss:0.0021159679163247347
The modified gen p mean: 0.4488213360309601, gen p mean: -0.23731930553913116, mean p set: 0.4493965804576874
loss_pred:0.013169283978641033, decouple_loss:0.0019456233130767941
The modified gen p mean: 0.44794750213623047, gen p mean: -0.24675218760967255, mean p set: 0.4484791159629822
loss_pred:0.01350766234099865, decouple_loss:0.0022597606293857098
Iteration: 5256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486101269721985, gen p mean: -0.24155482649803162, mean p set: 0.449184387922287
loss_pred:0.013157326728105545, decouple_loss:0.0020790526177734137
The modified gen p mean: 0.4483947455883026, gen p mean: -0.24619044363498688, mean p set: 0.4489628076553345
loss_pred:0.013191699050366879, decouple_loss:0.0020060341339558363
The modified gen p mean: 0.4473917782306671, gen p mean: -0.24354897439479828, mean p set: 0.4479270875453949
loss_pred:0.013052458874881268, decouple_loss:0.0020474926568567753
Iteration: 5257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474378824234009, gen p mean: -0.24454933404922485, mean p set: 0.44800853729248047
loss_pred:0.01360192522406578, decouple_loss:0.001936048036441207
The modified gen p mean: 0.4477542042732239, gen p mean: -0.2421599179506302, mean p set: 0.44832685589790344
loss_pred:0.01345741841942072, decouple_loss:0.001900298404507339
The modified gen p mean: 0.4466569125652313, gen p mean: -0.24210135638713837, mean p set: 0.4471812844276428
loss_pred:0.01372636016458273, decouple_loss:0.0017226111376658082
Iteration: 5258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789624214172363, gen p mean: -0.25004497170448303, mean p set: 0.4484758675098419
loss_pred:0.01346244290471077, decouple_loss:0.002571167191490531
The modified gen p mean: 0.4467177093029022, gen p mean: -0.24612507224082947, mean p set: 0.44729676842689514
loss_pred:0.013556393794715405, decouple_loss:0.0025052321143448353
The modified gen p mean: 0.4470345973968506, gen p mean: -0.24850116670131683, mean p set: 0.44756677746772766
loss_pred:0.013636684976518154, decouple_loss:0.002714138012379408
Iteration: 5259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869181513786316, gen p mean: -0.24695375561714172, mean p set: 0.44926023483276367
loss_pred:0.013309814967215061, decouple_loss:0.002565645845606923
The modified gen p mean: 0.4469909965991974, gen p mean: -0.24009284377098083, mean p set: 0.44756919145584106
loss_pred:0.014204347506165504, decouple_loss:0.0022220269311219454
The modified gen p mean: 0.4474208354949951, gen p mean: -0.24453827738761902, mean p set: 0.4479469656944275
loss_pred:0.013489560224115849, decouple_loss:0.0023807091638445854
Iteration: 5260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765573740005493, gen p mean: -0.24676387012004852, mean p set: 0.4482361972332001
loss_pred:0.013253509066998959, decouple_loss:0.001884688506834209
The modified gen p mean: 0.4464276432991028, gen p mean: -0.24800512194633484, mean p set: 0.44700247049331665
loss_pred:0.01385782565921545, decouple_loss:0.0018722816603258252
The modified gen p mean: 0.4464693069458008, gen p mean: -0.24120979011058807, mean p set: 0.4469953179359436
loss_pred:0.01327656488865614, decouple_loss:0.0019333038944751024
2023-04-28 03:37:00 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24504216015338898, mean p set: 0.4499112665653229
loss_pred:0.015440745279192924, decouple_loss:0.002269173739477992
The modified gen p mean: 0.4482692778110504, gen p mean: -0.2426420897245407, mean p set: 0.44879910349845886
loss_pred:0.015372712165117264, decouple_loss:0.0023442967794835567
The modified gen p mean: 0.4493022561073303, gen p mean: -0.24548418819904327, mean p set: 0.4498290419578552
loss_pred:0.014934534206986427, decouple_loss:0.0023621756117790937
WV_1_PC_1_EH_0_PS_30, loss: 0.015365591272711754, avg_mse: 0.022795340046286583
current test mse: 0.022795
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 5261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472620487213135, gen p mean: -0.24670973420143127, mean p set: 0.4477921724319458
loss_pred:0.013374438509345055, decouple_loss:0.002035259734839201
The modified gen p mean: 0.44784554839134216, gen p mean: -0.23690742254257202, mean p set: 0.44841745495796204
loss_pred:0.013049248605966568, decouple_loss:0.0022244839929044247
The modified gen p mean: 0.44785061478614807, gen p mean: -0.24152050912380219, mean p set: 0.44842419028282166
loss_pred:0.013510015793144703, decouple_loss:0.002262396039441228
Iteration: 5262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44898149371147156, gen p mean: -0.23978275060653687, mean p set: 0.44950512051582336
loss_pred:0.013028604909777641, decouple_loss:0.001695699174888432
The modified gen p mean: 0.44822457432746887, gen p mean: -0.24758262932300568, mean p set: 0.44880014657974243
loss_pred:0.01275076437741518, decouple_loss:0.0017967676976695657
The modified gen p mean: 0.44608503580093384, gen p mean: -0.2432282716035843, mean p set: 0.4466628134250641
loss_pred:0.013778714463114738, decouple_loss:0.0018598249880596995
Iteration: 5263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473606050014496, gen p mean: -0.24132943153381348, mean p set: 0.4478890001773834
loss_pred:0.013290227390825748, decouple_loss:0.001881313044577837
The modified gen p mean: 0.4480549097061157, gen p mean: -0.2479894906282425, mean p set: 0.44863414764404297
loss_pred:0.01283236127346754, decouple_loss:0.0018009103368967772
The modified gen p mean: 0.4470696747303009, gen p mean: -0.2463395893573761, mean p set: 0.4476434886455536
loss_pred:0.013346984051167965, decouple_loss:0.0018617244204506278
Iteration: 5264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492744207382202, gen p mean: -0.24114204943180084, mean p set: 0.4498105049133301
loss_pred:0.013536382466554642, decouple_loss:0.0017269667005166411
The modified gen p mean: 0.4487564265727997, gen p mean: -0.24430838227272034, mean p set: 0.4493320882320404
loss_pred:0.013115274719893932, decouple_loss:0.0019487373065203428
The modified gen p mean: 0.44913506507873535, gen p mean: -0.25001850724220276, mean p set: 0.4497106075286865
loss_pred:0.013369549997150898, decouple_loss:0.0017890242161229253
Iteration: 5265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44631078839302063, gen p mean: -0.23508258163928986, mean p set: 0.4468816816806793
loss_pred:0.013784567825496197, decouple_loss:0.0018802807899191976
The modified gen p mean: 0.4474116861820221, gen p mean: -0.24017250537872314, mean p set: 0.44798991084098816The modified gen p mean: 0.44967159628868103, gen p mean: -0.23406675457954407, mean p set: 0.45020049810409546
loss_pred:0.012746062129735947, decouple_loss:0.0014791962457820773
loss_pred:0.013021120801568031, decouple_loss:0.0017883278196677566
Iteration: 5266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472682774066925, gen p mean: -0.22623363137245178, mean p set: 0.44784975051879883
loss_pred:0.012794161215424538, decouple_loss:0.00175096548628062
The modified gen p mean: 0.4465671181678772, gen p mean: -0.23321625590324402, mean p set: 0.44709157943725586The modified gen p mean: 0.449124813079834, gen p mean: -0.22959378361701965, mean p set: 0.44969815015792847
loss_pred:0.013246454298496246, decouple_loss:0.001646625460125506
loss_pred:0.013370311819016933, decouple_loss:0.0017979592084884644
Iteration: 5267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009347796440125, gen p mean: -0.22818545997142792, mean p set: 0.4506722390651703
loss_pred:0.013118895702064037, decouple_loss:0.0019435910508036613
The modified gen p mean: 0.44813838601112366, gen p mean: -0.23384422063827515, mean p set: 0.44866541028022766
The modified gen p mean: 0.4479358196258545, gen p mean: -0.2354346066713333, mean p set: 0.4485096037387848
loss_pred:0.013289430178701878, decouple_loss:0.001672898419201374
loss_pred:0.013452366925776005, decouple_loss:0.0026049762964248657
Iteration: 5268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491937756538391, gen p mean: -0.23458336293697357, mean p set: 0.44976967573165894
loss_pred:0.012888663448393345, decouple_loss:0.0018467301269993186
The modified gen p mean: 0.44780734181404114, gen p mean: -0.23420655727386475, mean p set: 0.44838523864746094
loss_pred:0.013672135770320892, decouple_loss:0.0019476301968097687
The modified gen p mean: 0.4471478760242462, gen p mean: -0.2403986155986786, mean p set: 0.4476757347583771
loss_pred:0.013266334310173988, decouple_loss:0.002024362562224269
Iteration: 5269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485026001930237, gen p mean: -0.24350717663764954, mean p set: 0.449078768491745
loss_pred:0.012989506125450134, decouple_loss:0.0016831591492518783
The modified gen p mean: 0.44725409150123596, gen p mean: -0.2392297387123108, mean p set: 0.44782590866088867
loss_pred:0.013453220948576927, decouple_loss:0.0015450897626578808
The modified gen p mean: 0.44915083050727844, gen p mean: -0.24625259637832642, mean p set: 0.4496791362762451
loss_pred:0.013094419613480568, decouple_loss:0.001726016984321177
Iteration: 5270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44927483797073364, gen p mean: -0.24192683398723602, mean p set: 0.44985491037368774
loss_pred:0.013282505795359612, decouple_loss:0.0015322681283578277
The modified gen p mean: 0.4475676417350769, gen p mean: -0.24547673761844635, mean p set: 0.4481406807899475
loss_pred:0.01328655332326889, decouple_loss:0.0019041879568248987
The modified gen p mean: 0.4481922388076782, gen p mean: -0.24818184971809387, mean p set: 0.4487197697162628
loss_pred:0.0133645785972476, decouple_loss:0.002096511423587799
2023-04-28 03:41:01 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2489839792251587, mean p set: 0.4499112665653229
loss_pred:0.015519589185714722, decouple_loss:0.00172315607778728
The modified gen p mean: 0.44827142357826233, gen p mean: -0.24697045981884003, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492968022823334, gen p mean: -0.249537393450737, mean p set: 0.4498290419578552
loss_pred:0.015415063127875328, decouple_loss:0.0017918451922014356
loss_pred:0.014988102950155735, decouple_loss:0.0018229481065645814
WV_1_PC_1_EH_0_PS_30, loss: 0.015396550297737122, avg_mse: 0.02291509509086609
current test mse: 0.022915
Iteration: 5271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847896695137024, gen p mean: -0.2417297214269638, mean p set: 0.44906049966812134
loss_pred:0.013011956587433815, decouple_loss:0.0020741878543049097
The modified gen p mean: 0.4475654661655426, gen p mean: -0.24472109973430634, mean p set: 0.4481384754180908
loss_pred:0.012590127065777779, decouple_loss:0.002167275408282876
The modified gen p mean: 0.4487760066986084, gen p mean: -0.24951396882534027, mean p set: 0.4493098258972168
loss_pred:0.012793486006557941, decouple_loss:0.0018112107645720243
Iteration: 5272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687870144844055, gen p mean: -0.24968069791793823, mean p set: 0.44741183519363403
loss_pred:0.013285666704177856, decouple_loss:0.001563992234878242
The modified gen p mean: 0.44820094108581543, gen p mean: -0.2490672618150711, mean p set: 0.44878509640693665
loss_pred:0.013336426578462124, decouple_loss:0.0020774928852915764
The modified gen p mean: 0.44862377643585205, gen p mean: -0.2516312599182129, mean p set: 0.4491964280605316
loss_pred:0.012813177891075611, decouple_loss:0.001757752033881843
Iteration: 5273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681698083877563, gen p mean: -0.248091459274292, mean p set: 0.4473493695259094
loss_pred:0.013311799615621567, decouple_loss:0.0017992750508710742
The modified gen p mean: 0.4473954737186432, gen p mean: -0.2493346482515335, mean p set: 0.4479677379131317
loss_pred:0.012850972823798656, decouple_loss:0.0016935175517573953
The modified gen p mean: 0.44716116786003113, gen p mean: -0.2458299994468689, mean p set: 0.4477404057979584
loss_pred:0.013392064720392227, decouple_loss:0.0022835657000541687
Iteration: 5274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777971506118774, gen p mean: -0.2409924417734146, mean p set: 0.4483111500740051
loss_pred:0.013423671014606953, decouple_loss:0.0019355141557753086
The modified gen p mean: 0.44813817739486694, gen p mean: -0.24955803155899048, mean p set: 0.4487130343914032
loss_pred:0.013080920092761517, decouple_loss:0.0015669488348066807
The modified gen p mean: 0.44867047667503357, gen p mean: -0.24651439487934113, mean p set: 0.44924888014793396
loss_pred:0.012858974747359753, decouple_loss:0.0018483869498595595
Iteration: 5275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831717014312744, gen p mean: -0.24174225330352783, mean p set: 0.4488963484764099
loss_pred:0.01301412284374237, decouple_loss:0.0020508677698671818
The modified gen p mean: 0.4463607370853424, gen p mean: -0.24412690103054047, mean p set: 0.4469376802444458The modified gen p mean: 0.44596612453460693, gen p mean: -0.2447894811630249, mean p set: 0.4464992880821228
loss_pred:0.013478120788931847, decouple_loss:0.0020692795515060425
loss_pred:0.013564178720116615, decouple_loss:0.002031350741162896
Iteration: 5276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880038499832153, gen p mean: -0.24345451593399048, mean p set: 0.4493766129016876
loss_pred:0.013058263808488846, decouple_loss:0.0017824859824031591
The modified gen p mean: 0.4490586221218109, gen p mean: -0.24215465784072876, mean p set: 0.4495809078216553The modified gen p mean: 0.4486699402332306, gen p mean: -0.24161048233509064, mean p set: 0.44924619793891907
loss_pred:0.013080908916890621, decouple_loss:0.0018709180876612663
loss_pred:0.013231731951236725, decouple_loss:0.0017299376195296645
Iteration: 5277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471910297870636, gen p mean: -0.24737712740898132, mean p set: 0.447760671377182
loss_pred:0.013215356506407261, decouple_loss:0.0019527862314134836
The modified gen p mean: 0.44684290885925293, gen p mean: -0.24677415192127228, mean p set: 0.44741132855415344The modified gen p mean: 0.44784870743751526, gen p mean: -0.2495582401752472, mean p set: 0.4483746588230133
loss_pred:0.013569027185440063, decouple_loss:0.0020819753408432007
loss_pred:0.013331153430044651, decouple_loss:0.002120058285072446
Iteration: 5278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489024579524994, gen p mean: -0.2458191215991974, mean p set: 0.44948315620422363
loss_pred:0.01316799409687519, decouple_loss:0.0020076760556548834
The modified gen p mean: 0.4469112157821655, gen p mean: -0.24913793802261353, mean p set: 0.44749414920806885The modified gen p mean: 0.4482351839542389, gen p mean: -0.25211676955223083, mean p set: 0.4487580358982086
loss_pred:0.013415266759693623, decouple_loss:0.0018870832864195108
loss_pred:0.012367038987576962, decouple_loss:0.0021597137674689293
Iteration: 5279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487767815589905, gen p mean: -0.25263550877571106, mean p set: 0.4493577182292938
loss_pred:0.01264411211013794, decouple_loss:0.002379312179982662
The modified gen p mean: 0.44700151681900024, gen p mean: -0.2523850202560425, mean p set: 0.44752633571624756The modified gen p mean: 0.44765958189964294, gen p mean: -0.246453657746315, mean p set: 0.44823670387268066
loss_pred:0.01307838037610054, decouple_loss:0.002043739892542362
loss_pred:0.012548494152724743, decouple_loss:0.0020197925623506308
Iteration: 5280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472963511943817, gen p mean: -0.2512003779411316, mean p set: 0.44786572456359863
loss_pred:0.012914787046611309, decouple_loss:0.0019990350119769573
The modified gen p mean: 0.4499439597129822, gen p mean: -0.2414824366569519, mean p set: 0.4505167305469513
loss_pred:0.013409825973212719, decouple_loss:0.00176900380756706
The modified gen p mean: 0.44700872898101807, gen p mean: -0.24583405256271362, mean p set: 0.44753846526145935
loss_pred:0.013350996188819408, decouple_loss:0.0017687231302261353
2023-04-28 03:44:25 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24580061435699463, mean p set: 0.4499112665653229
loss_pred:0.015423410572111607, decouple_loss:0.002051684772595763
The modified gen p mean: 0.4482704997062683, gen p mean: -0.24372224509716034, mean p set: 0.44879910349845886
loss_pred:0.015281782485544682, decouple_loss:0.0017812789883464575
The modified gen p mean: 0.4492986798286438, gen p mean: -0.24617429077625275, mean p set: 0.4498290419578552
loss_pred:0.014876393601298332, decouple_loss:0.0018780601676553488
WV_1_PC_1_EH_0_PS_30, loss: 0.015289045870304108, avg_mse: 0.02274218387901783
current test mse: 0.022742
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 5281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44576579332351685, gen p mean: -0.24685341119766235, mean p set: 0.4462953209877014
loss_pred:0.013728193938732147, decouple_loss:0.0017995203379541636
The modified gen p mean: 0.446171373128891, gen p mean: -0.24622413516044617, mean p set: 0.44674646854400635
loss_pred:0.01386941596865654, decouple_loss:0.0018707033013924956
The modified gen p mean: 0.4474361836910248, gen p mean: -0.2474173754453659, mean p set: 0.4480128884315491
loss_pred:0.014924311079084873, decouple_loss:0.0019746783655136824
Iteration: 5282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469955265522003, gen p mean: -0.2502748370170593, mean p set: 0.44752398133277893
loss_pred:0.01382021326571703, decouple_loss:0.0018664689268916845
The modified gen p mean: 0.4461333751678467, gen p mean: -0.24207879602909088, mean p set: 0.446708619594574
loss_pred:0.014487980864942074, decouple_loss:0.002113042864948511
The modified gen p mean: 0.44641968607902527, gen p mean: -0.24524179100990295, mean p set: 0.4469989240169525
loss_pred:0.01401302870362997, decouple_loss:0.0018695436883717775
Iteration: 5283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756290316581726, gen p mean: -0.2442256361246109, mean p set: 0.4480966627597809
loss_pred:0.014332311227917671, decouple_loss:0.0018190142000094056
The modified gen p mean: 0.44750288128852844, gen p mean: -0.24915948510169983, mean p set: 0.4480704963207245
loss_pred:0.0143017852678895, decouple_loss:0.002501397393643856
The modified gen p mean: 0.44598767161369324, gen p mean: -0.24644863605499268, mean p set: 0.4465586841106415
loss_pred:0.014499792829155922, decouple_loss:0.0019152684835717082
Iteration: 5284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779840111732483, gen p mean: -0.24850864708423615, mean p set: 0.4483300447463989
loss_pred:0.014312858693301678, decouple_loss:0.0018825638107955456
The modified gen p mean: 0.44615817070007324, gen p mean: -0.24776630103588104, mean p set: 0.4467359483242035
loss_pred:0.014398663304746151, decouple_loss:0.0017407129053026438
The modified gen p mean: 0.446209579706192, gen p mean: -0.2457856386899948, mean p set: 0.44678789377212524
loss_pred:0.013522221706807613, decouple_loss:0.0016261321725323796
Iteration: 5285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447146475315094, gen p mean: -0.2525642216205597, mean p set: 0.4477214217185974
loss_pred:0.014073445461690426, decouple_loss:0.0020022387616336346
The modified gen p mean: 0.44648322463035583, gen p mean: -0.24925698339939117, mean p set: 0.44706523418426514The modified gen p mean: 0.4458538591861725, gen p mean: -0.2447449266910553, mean p set: 0.44638508558273315
loss_pred:0.014189299196004868, decouple_loss:0.002035942394286394
loss_pred:0.013851159252226353, decouple_loss:0.0019631197210401297
Iteration: 5286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472660720348358, gen p mean: -0.24746045470237732, mean p set: 0.4478432536125183
loss_pred:0.01439488586038351, decouple_loss:0.0020704795606434345
The modified gen p mean: 0.4465892016887665, gen p mean: -0.2428254783153534, mean p set: 0.44716861844062805The modified gen p mean: 0.44715064764022827, gen p mean: -0.24179956316947937, mean p set: 0.44768035411834717
loss_pred:0.013960453681647778, decouple_loss:0.0017634215764701366
loss_pred:0.013884134590625763, decouple_loss:0.002225116826593876
Iteration: 5287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464454650878906, gen p mean: -0.23816928267478943, mean p set: 0.4470199644565582
loss_pred:0.01386500895023346, decouple_loss:0.0015916548436507583
The modified gen p mean: 0.4464168846607208, gen p mean: -0.24336077272891998, mean p set: 0.4469858705997467The modified gen p mean: 0.44693225622177124, gen p mean: -0.24910283088684082, mean p set: 0.44745466113090515
loss_pred:0.014185579493641853, decouple_loss:0.0018097852589562535
loss_pred:0.01385705079883337, decouple_loss:0.0016359667060896754
Iteration: 5288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463967978954315, gen p mean: -0.2392185628414154, mean p set: 0.44696730375289917
loss_pred:0.01366423349827528, decouple_loss:0.0016682781279087067
The modified gen p mean: 0.44685855507850647, gen p mean: -0.24692314863204956, mean p set: 0.44743674993515015
loss_pred:0.0139584606513381, decouple_loss:0.0017880593659356236
The modified gen p mean: 0.44791367650032043, gen p mean: -0.2425311803817749, mean p set: 0.4484312832355499
loss_pred:0.014262387529015541, decouple_loss:0.0018150587566196918
Iteration: 5289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714826345443726, gen p mean: -0.2391037493944168, mean p set: 0.44772863388061523
loss_pred:0.014064118266105652, decouple_loss:0.001608501304872334
The modified gen p mean: 0.44650736451148987, gen p mean: -0.23803067207336426, mean p set: 0.4470832645893097
loss_pred:0.013736569322645664, decouple_loss:0.0016312102088704705
The modified gen p mean: 0.44720789790153503, gen p mean: -0.23862864077091217, mean p set: 0.44773682951927185
loss_pred:0.013632593676447868, decouple_loss:0.0016527660191059113
Iteration: 5290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468939006328583, gen p mean: -0.24847570061683655, mean p set: 0.4474724233150482
loss_pred:0.014221925288438797, decouple_loss:0.001731197233311832
The modified gen p mean: 0.4466857314109802, gen p mean: -0.24528318643569946, mean p set: 0.44726207852363586
loss_pred:0.013993719592690468, decouple_loss:0.0015430478379130363
The modified gen p mean: 0.4456132650375366, gen p mean: -0.24404487013816833, mean p set: 0.4461430609226227
loss_pred:0.01456343475729227, decouple_loss:0.0016672986093908548
2023-04-28 03:48:27 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24666114151477814, mean p set: 0.4499112665653229
loss_pred:0.015365309081971645, decouple_loss:0.0017049805028364062
The modified gen p mean: 0.44930046796798706, gen p mean: -0.24716201424598694, mean p set: 0.4498290419578552
The modified gen p mean: 0.44826799631118774, gen p mean: -0.24487440288066864, mean p set: 0.44879910349845886
loss_pred:0.014859996736049652, decouple_loss:0.0016977060586214066
loss_pred:0.015319566242396832, decouple_loss:0.0016097858315333724
WV_1_PC_1_EH_0_PS_30, loss: 0.015265165828168392, avg_mse: 0.022674908861517906
current test mse: 0.022675
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663307070732117, gen p mean: -0.24435573816299438, mean p set: 0.4472024440765381
loss_pred:0.01407118234783411, decouple_loss:0.0015783518319949508
The modified gen p mean: 0.44701144099235535, gen p mean: -0.24511827528476715, mean p set: 0.4475388824939728
loss_pred:0.013109738007187843, decouple_loss:0.0015182532370090485
The modified gen p mean: 0.4460279643535614, gen p mean: -0.24710018932819366, mean p set: 0.44659891724586487
loss_pred:0.014296665787696838, decouple_loss:0.0017570644849911332
Iteration: 5292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692665338516235, gen p mean: -0.24714091420173645, mean p set: 0.44745174050331116
loss_pred:0.014139611274003983, decouple_loss:0.0018635870655998588
The modified gen p mean: 0.4474123418331146, gen p mean: -0.2476205676794052, mean p set: 0.4479900598526001
The modified gen p mean: 0.446679949760437, gen p mean: -0.2540576457977295, mean p set: 0.44725584983825684
loss_pred:0.014468098990619183, decouple_loss:0.0018628648249432445
loss_pred:0.013782446272671223, decouple_loss:0.0017652036622166634
Iteration: 5293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469679892063141, gen p mean: -0.2496321201324463, mean p set: 0.44749605655670166
loss_pred:0.014284692704677582, decouple_loss:0.001692738733254373
The modified gen p mean: 0.447508841753006, gen p mean: -0.25103190541267395, mean p set: 0.4480864405632019
The modified gen p mean: 0.44624975323677063, gen p mean: -0.24953024089336395, mean p set: 0.4468272626399994
loss_pred:0.013803984969854355, decouple_loss:0.00168740248773247
loss_pred:0.014282331801950932, decouple_loss:0.0015859896084293723
Iteration: 5294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464820623397827, gen p mean: -0.2507631480693817, mean p set: 0.44700896739959717
loss_pred:0.013917705044150352, decouple_loss:0.001596220419742167
The modified gen p mean: 0.4464070796966553, gen p mean: -0.24847280979156494, mean p set: 0.44698208570480347
The modified gen p mean: 0.44761842489242554, gen p mean: -0.24529756605625153, mean p set: 0.44819650053977966
loss_pred:0.014852802269160748, decouple_loss:0.0016016996232792735
loss_pred:0.013696333393454552, decouple_loss:0.0016597873764112592
Iteration: 5295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445498526096344, gen p mean: -0.24618957936763763, mean p set: 0.4460710883140564
loss_pred:0.013615882955491543, decouple_loss:0.001596118789166212
The modified gen p mean: 0.44699057936668396, gen p mean: -0.24954505264759064, mean p set: 0.44756782054901123The modified gen p mean: 0.4465677738189697, gen p mean: -0.24721360206604004, mean p set: 0.44709739089012146
loss_pred:0.01353776827454567, decouple_loss:0.0015422498108819127
loss_pred:0.014563771896064281, decouple_loss:0.0015343966661021113
Iteration: 5296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462897777557373, gen p mean: -0.246306374669075, mean p set: 0.4468649923801422
loss_pred:0.01422297116369009, decouple_loss:0.0016345453914254904
The modified gen p mean: 0.4465041160583496, gen p mean: -0.24507996439933777, mean p set: 0.44702792167663574The modified gen p mean: 0.44730663299560547, gen p mean: -0.24780035018920898, mean p set: 0.447883665561676
loss_pred:0.014595028012990952, decouple_loss:0.0016836244612932205
loss_pred:0.013923476450145245, decouple_loss:0.0015987686347216368
Iteration: 5297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474753439426422, gen p mean: -0.25051313638687134, mean p set: 0.4480500817298889
loss_pred:0.01318172737956047, decouple_loss:0.0015630635898560286
The modified gen p mean: 0.44693395495414734, gen p mean: -0.2427207976579666, mean p set: 0.44745591282844543The modified gen p mean: 0.44737792015075684, gen p mean: -0.24710315465927124, mean p set: 0.4479503035545349
loss_pred:0.013154945336282253, decouple_loss:0.0016126902773976326
loss_pred:0.01415728498250246, decouple_loss:0.001428966992534697
Iteration: 5298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656693935394287, gen p mean: -0.24654453992843628, mean p set: 0.44714680314064026
loss_pred:0.014125386252999306, decouple_loss:0.0015840100822970271
The modified gen p mean: 0.44619762897491455, gen p mean: -0.24556390941143036, mean p set: 0.44672611355781555The modified gen p mean: 0.4456394612789154, gen p mean: -0.245357483625412, mean p set: 0.44622352719306946
loss_pred:0.014295230619609356, decouple_loss:0.0018571302061900496
loss_pred:0.014509241096675396, decouple_loss:0.0017042441759258509
Iteration: 5299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466455578804016, gen p mean: -0.24807757139205933, mean p set: 0.44722431898117065
loss_pred:0.013894827105104923, decouple_loss:0.0015330570749938488
The modified gen p mean: 0.44716838002204895, gen p mean: -0.24509893357753754, mean p set: 0.4476989209651947The modified gen p mean: 0.4458886682987213, gen p mean: -0.24381734430789948, mean p set: 0.4464685022830963
loss_pred:0.014477788470685482, decouple_loss:0.0018201862694695592
loss_pred:0.01407563779503107, decouple_loss:0.0017891302704811096
Iteration: 5300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763603806495667, gen p mean: -0.23898035287857056, mean p set: 0.44821488857269287
loss_pred:0.014020002447068691, decouple_loss:0.0017069324385374784
The modified gen p mean: 0.44706815481185913, gen p mean: -0.24460558593273163, mean p set: 0.4475901126861572The modified gen p mean: 0.44735631346702576, gen p mean: -0.24333137273788452, mean p set: 0.4479365348815918
loss_pred:0.014547634869813919, decouple_loss:0.001613577944226563
loss_pred:0.014241660945117474, decouple_loss:0.0018348766025155783
2023-04-28 03:51:50 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24497784674167633, mean p set: 0.4499112665653229
loss_pred:0.015358149074018002, decouple_loss:0.001664707437157631
The modified gen p mean: 0.4482710659503937, gen p mean: -0.24337907135486603, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930174946784973, gen p mean: -0.245427206158638, mean p set: 0.4498290419578552
loss_pred:0.015284276567399502, decouple_loss:0.0016074173618108034
loss_pred:0.014828215353190899, decouple_loss:0.001529545639641583
WV_1_PC_1_EH_0_PS_30, loss: 0.015236908569931984, avg_mse: 0.02261660061776638
current test mse: 0.022617
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 5301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466240108013153, gen p mean: -0.2403457909822464, mean p set: 0.4471484422683716
loss_pred:0.01384639460593462, decouple_loss:0.0020684327464550734
The modified gen p mean: 0.4485262632369995, gen p mean: -0.24258656799793243, mean p set: 0.449098140001297
loss_pred:0.014240003190934658, decouple_loss:0.0018218704499304295
The modified gen p mean: 0.4465804994106293, gen p mean: -0.24650783836841583, mean p set: 0.4471592903137207
loss_pred:0.013846155256032944, decouple_loss:0.002137768780812621
Iteration: 5302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473055601119995, gen p mean: -0.24406149983406067, mean p set: 0.4478318989276886
loss_pred:0.014697483740746975, decouple_loss:0.001902989810332656
The modified gen p mean: 0.44646376371383667, gen p mean: -0.2547048032283783, mean p set: 0.44703981280326843
loss_pred:0.014259531162679195, decouple_loss:0.0018472305964678526
The modified gen p mean: 0.4467824697494507, gen p mean: -0.2429240494966507, mean p set: 0.4473569989204407
loss_pred:0.013562090694904327, decouple_loss:0.00173170433845371
Iteration: 5303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470009207725525, gen p mean: -0.24659547209739685, mean p set: 0.44752857089042664
loss_pred:0.013830292969942093, decouple_loss:0.0022713099606335163
The modified gen p mean: 0.4463716745376587, gen p mean: -0.25570183992385864, mean p set: 0.4469473958015442
loss_pred:0.01427692174911499, decouple_loss:0.001943432493135333
The modified gen p mean: 0.44686704874038696, gen p mean: -0.25280407071113586, mean p set: 0.44744372367858887
loss_pred:0.014209158718585968, decouple_loss:0.0020243641920387745
Iteration: 5304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489651918411255, gen p mean: -0.2508012354373932, mean p set: 0.4494958221912384
loss_pred:0.013866146095097065, decouple_loss:0.002001434564590454
The modified gen p mean: 0.4475454092025757, gen p mean: -0.2504103481769562, mean p set: 0.4481104910373688
loss_pred:0.013670692220330238, decouple_loss:0.0017768916441127658
The modified gen p mean: 0.449152410030365, gen p mean: -0.24739493429660797, mean p set: 0.4497283697128296
loss_pred:0.013536314480006695, decouple_loss:0.001967523479834199
Iteration: 5305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740915298461914, gen p mean: -0.24716350436210632, mean p set: 0.44798544049263
loss_pred:0.014522713609039783, decouple_loss:0.001781220082193613
The modified gen p mean: 0.4468192458152771, gen p mean: -0.24352851510047913, mean p set: 0.44738900661468506The modified gen p mean: 0.4468700885772705, gen p mean: -0.24984228610992432, mean p set: 0.4473989009857178
loss_pred:0.013366554863750935, decouple_loss:0.0020248275250196457
loss_pred:0.014809534884989262, decouple_loss:0.0019657337106764317
Iteration: 5306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652315974235535, gen p mean: -0.24794670939445496, mean p set: 0.4471015930175781
loss_pred:0.015033156611025333, decouple_loss:0.0021425997838377953
The modified gen p mean: 0.44619321823120117, gen p mean: -0.24944919347763062, mean p set: 0.44677209854125977The modified gen p mean: 0.44820019602775574, gen p mean: -0.2447124570608139, mean p set: 0.4487267732620239
loss_pred:0.014078580774366856, decouple_loss:0.0022102559451013803
loss_pred:0.013872219249606133, decouple_loss:0.0019453054992482066
Iteration: 5307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463895559310913, gen p mean: -0.24107258021831512, mean p set: 0.4469609558582306
loss_pred:0.013453547842800617, decouple_loss:0.0018073712708428502
The modified gen p mean: 0.44728773832321167, gen p mean: -0.24097129702568054, mean p set: 0.4478605389595032
loss_pred:0.014643379487097263, decouple_loss:0.0017656816635280848
The modified gen p mean: 0.4480830132961273, gen p mean: -0.2381640374660492, mean p set: 0.44861525297164917
loss_pred:0.014677049592137337, decouple_loss:0.0016988604329526424
Iteration: 5308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753095507621765, gen p mean: -0.23776835203170776, mean p set: 0.4481060206890106
loss_pred:0.015697281807661057, decouple_loss:0.0016957304906100035
The modified gen p mean: 0.44693970680236816, gen p mean: -0.23327848315238953, mean p set: 0.44751542806625366
loss_pred:0.014700356870889664, decouple_loss:0.0017466045683249831
The modified gen p mean: 0.4468104839324951, gen p mean: -0.2423248440027237, mean p set: 0.44733917713165283
loss_pred:0.014982292428612709, decouple_loss:0.0017983843572437763
Iteration: 5309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476824104785919, gen p mean: -0.24448862671852112, mean p set: 0.4482575058937073
loss_pred:0.016766950488090515, decouple_loss:0.0017590823117643595
The modified gen p mean: 0.4468553960323334, gen p mean: -0.24219676852226257, mean p set: 0.4474294185638428
loss_pred:0.015545996837317944, decouple_loss:0.0017700048629194498
The modified gen p mean: 0.4470010995864868, gen p mean: -0.24441596865653992, mean p set: 0.44753316044807434
loss_pred:0.017608990892767906, decouple_loss:0.0015232317382469773
Iteration: 5310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747990369796753, gen p mean: -0.24836745858192444, mean p set: 0.4480628967285156
loss_pred:0.01632441021502018, decouple_loss:0.0018942139577120543
The modified gen p mean: 0.44931337237358093, gen p mean: -0.24665126204490662, mean p set: 0.44989389181137085
loss_pred:0.01606629230082035, decouple_loss:0.00214916723780334
The modified gen p mean: 0.4479348361492157, gen p mean: -0.24409985542297363, mean p set: 0.44846174120903015
loss_pred:0.016622601076960564, decouple_loss:0.0019437086302787066
2023-04-28 03:56:03 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.25095826387405396, mean p set: 0.4499112665653229
loss_pred:0.018014179542660713, decouple_loss:0.0021312774624675512
The modified gen p mean: 0.44929128885269165, gen p mean: -0.2517067492008209, mean p set: 0.4498290419578552The modified gen p mean: 0.4482651650905609, gen p mean: -0.24888689815998077, mean p set: 0.44879910349845886
loss_pred:0.01719522289931774, decouple_loss:0.0020685165654867887
loss_pred:0.01771577261388302, decouple_loss:0.0020185967441648245
WV_1_PC_1_EH_0_PS_30, loss: 0.01774536445736885, avg_mse: 0.026679057627916336
current test mse: 0.026679
Iteration: 5311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755828380584717, gen p mean: -0.254957914352417, mean p set: 0.44813334941864014
loss_pred:0.016411887481808662, decouple_loss:0.0024522622115910053
The modified gen p mean: 0.44718751311302185, gen p mean: -0.25214800238609314, mean p set: 0.4477183520793915
loss_pred:0.017574096098542213, decouple_loss:0.002124291844666004
The modified gen p mean: 0.44624418020248413, gen p mean: -0.25699087977409363, mean p set: 0.4468221068382263
loss_pred:0.016448937356472015, decouple_loss:0.002597106620669365
Iteration: 5312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464721381664276, gen p mean: -0.2546074688434601, mean p set: 0.44699788093566895
loss_pred:0.015774546191096306, decouple_loss:0.002307423623278737
The modified gen p mean: 0.4475400745868683, gen p mean: -0.25212427973747253, mean p set: 0.4481140077114105
The modified gen p mean: 0.4484230577945709, gen p mean: -0.24724635481834412, mean p set: 0.44899824261665344
loss_pred:0.014970632269978523, decouple_loss:0.0022386619821190834
loss_pred:0.015135534107685089, decouple_loss:0.002604528795927763
Iteration: 5313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826701283454895, gen p mean: -0.2576659619808197, mean p set: 0.448797345161438
loss_pred:0.015969857573509216, decouple_loss:0.0026405630633234978
The modified gen p mean: 0.4479115903377533, gen p mean: -0.2548831105232239, mean p set: 0.4484897553920746
The modified gen p mean: 0.4474586546421051, gen p mean: -0.25543129444122314, mean p set: 0.44803139567375183
loss_pred:0.01612798497080803, decouple_loss:0.0026828956324607134
loss_pred:0.01655718870460987, decouple_loss:0.0026070422027260065
Iteration: 5314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675180315971375, gen p mean: -0.2500455975532532, mean p set: 0.44728177785873413
loss_pred:0.015684528276324272, decouple_loss:0.002489267848432064
The modified gen p mean: 0.447063148021698, gen p mean: -0.23979996144771576, mean p set: 0.4476413428783417
The modified gen p mean: 0.4462634027004242, gen p mean: -0.250958651304245, mean p set: 0.4468388855457306
loss_pred:0.015073679387569427, decouple_loss:0.0026696142740547657
loss_pred:0.0154159776866436, decouple_loss:0.0025621838867664337
Iteration: 5315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467889070510864, gen p mean: -0.2429865151643753, mean p set: 0.44736534357070923
loss_pred:0.01644863188266754, decouple_loss:0.0022523249499499798
The modified gen p mean: 0.4476301968097687, gen p mean: -0.2360999435186386, mean p set: 0.44820234179496765The modified gen p mean: 0.44685572385787964, gen p mean: -0.236459419131279, mean p set: 0.44737815856933594
loss_pred:0.015940090641379356, decouple_loss:0.002182929078117013
loss_pred:0.01555180735886097, decouple_loss:0.0022163428366184235
Iteration: 5316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468309283256531, gen p mean: -0.236916184425354, mean p set: 0.4474082589149475
loss_pred:0.01608688198029995, decouple_loss:0.002191220410168171
The modified gen p mean: 0.44839927554130554, gen p mean: -0.23707696795463562, mean p set: 0.44897395372390747The modified gen p mean: 0.4472268223762512, gen p mean: -0.22868315875530243, mean p set: 0.4477604627609253
loss_pred:0.015306535176932812, decouple_loss:0.0022078726906329393
loss_pred:0.015277253463864326, decouple_loss:0.002207451965659857
Iteration: 5317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767439365386963, gen p mean: -0.23809854686260223, mean p set: 0.4482457637786865
loss_pred:0.014917145483195782, decouple_loss:0.002359135542064905
The modified gen p mean: 0.44662025570869446, gen p mean: -0.23054268956184387, mean p set: 0.44714486598968506
The modified gen p mean: 0.448212593793869, gen p mean: -0.23617397248744965, mean p set: 0.4487859904766083
loss_pred:0.015117079950869083, decouple_loss:0.002178537892177701
loss_pred:0.01440166775137186, decouple_loss:0.002286435104906559
Iteration: 5318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447389155626297, gen p mean: -0.23077474534511566, mean p set: 0.4479648470878601
loss_pred:0.015094363130629063, decouple_loss:0.0022264146246016026
The modified gen p mean: 0.44655099511146545, gen p mean: -0.23581433296203613, mean p set: 0.4470820426940918The modified gen p mean: 0.4479163587093353, gen p mean: -0.23828385770320892, mean p set: 0.4484971761703491
loss_pred:0.014588124118745327, decouple_loss:0.002392388880252838
loss_pred:0.015068117529153824, decouple_loss:0.002464751247316599
Iteration: 5319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744718074798584, gen p mean: -0.22949108481407166, mean p set: 0.44802284240722656
loss_pred:0.014607245102524757, decouple_loss:0.002412826055660844
The modified gen p mean: 0.4475429356098175, gen p mean: -0.2375519871711731, mean p set: 0.44807443022727966The modified gen p mean: 0.4483257830142975, gen p mean: -0.23706337809562683, mean p set: 0.44890403747558594
loss_pred:0.014760834164917469, decouple_loss:0.0024049882777035236
loss_pred:0.01458650454878807, decouple_loss:0.0023022389505058527
Iteration: 5320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835764169692993, gen p mean: -0.22745907306671143, mean p set: 0.4489316940307617
loss_pred:0.0144705381244421, decouple_loss:0.0024304911494255066
The modified gen p mean: 0.44682496786117554, gen p mean: -0.23634997010231018, mean p set: 0.4473494589328766The modified gen p mean: 0.4495115578174591, gen p mean: -0.22938889265060425, mean p set: 0.4500883221626282
loss_pred:0.014357615262269974, decouple_loss:0.00255137262865901
loss_pred:0.015793506056070328, decouple_loss:0.0022157346829771996
2023-04-28 03:59:25 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22116418182849884, mean p set: 0.4499112665653229
loss_pred:0.01617368683218956, decouple_loss:0.0024377971421927214
The modified gen p mean: 0.448273628950119, gen p mean: -0.21944917738437653, mean p set: 0.44879910349845886
loss_pred:0.016094474121928215, decouple_loss:0.0025630483869463205
The modified gen p mean: 0.4493056535720825, gen p mean: -0.22147031128406525, mean p set: 0.4498290419578552
loss_pred:0.015678904950618744, decouple_loss:0.0026257222052663565
WV_1_PC_1_EH_0_PS_30, loss: 0.016109464690089226, avg_mse: 0.023845504969358444
current test mse: 0.023846
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 5321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745707511901855, gen p mean: -0.22315648198127747, mean p set: 0.4479850232601166
loss_pred:0.016090253368020058, decouple_loss:0.0026208669878542423
The modified gen p mean: 0.445860356092453, gen p mean: -0.22436726093292236, mean p set: 0.44643494486808777
loss_pred:0.01518271490931511, decouple_loss:0.0024573281407356262
The modified gen p mean: 0.44582703709602356, gen p mean: -0.2196223884820938, mean p set: 0.4464031159877777
loss_pred:0.015378616750240326, decouple_loss:0.0024964322801679373
Iteration: 5322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44554924964904785, gen p mean: -0.21822038292884827, mean p set: 0.4460800588130951
loss_pred:0.014781201258301735, decouple_loss:0.0024193066637963057
The modified gen p mean: 0.446444034576416, gen p mean: -0.21707306802272797, mean p set: 0.4470173120498657
loss_pred:0.015054360032081604, decouple_loss:0.0023518770467489958
The modified gen p mean: 0.44694584608078003, gen p mean: -0.2160017490386963, mean p set: 0.44751712679862976
loss_pred:0.015426804311573505, decouple_loss:0.002215177984908223
Iteration: 5323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721007347106934, gen p mean: -0.21177183091640472, mean p set: 0.447732150554657
loss_pred:0.014990262687206268, decouple_loss:0.002473704284057021
The modified gen p mean: 0.44579949975013733, gen p mean: -0.21051278710365295, mean p set: 0.4463808834552765
loss_pred:0.015200597234070301, decouple_loss:0.002470934996381402
The modified gen p mean: 0.4464590847492218, gen p mean: -0.2114146500825882, mean p set: 0.44702646136283875
loss_pred:0.014703448861837387, decouple_loss:0.002416156232357025
Iteration: 5324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473889470100403, gen p mean: -0.20979438722133636, mean p set: 0.447918564081192
loss_pred:0.014310916885733604, decouple_loss:0.0025094198063015938
The modified gen p mean: 0.44661641120910645, gen p mean: -0.2115468531847, mean p set: 0.4471932351589203
loss_pred:0.015683699399232864, decouple_loss:0.0024843825958669186
The modified gen p mean: 0.4463481903076172, gen p mean: -0.2092018723487854, mean p set: 0.44692856073379517
loss_pred:0.014569519087672234, decouple_loss:0.002476627239957452
Iteration: 5325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479586184024811, gen p mean: -0.21139487624168396, mean p set: 0.448532372713089
loss_pred:0.015046418644487858, decouple_loss:0.0023350578267127275
The modified gen p mean: 0.44543349742889404, gen p mean: -0.21328963339328766, mean p set: 0.44596222043037415The modified gen p mean: 0.44756215810775757, gen p mean: -0.2096204310655594, mean p set: 0.44813206791877747
loss_pred:0.015212407335639, decouple_loss:0.0023162062279880047
loss_pred:0.01476871594786644, decouple_loss:0.0023784025106579065
Iteration: 5326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750088453292847, gen p mean: -0.21374334394931793, mean p set: 0.44807806611061096
loss_pred:0.015235291793942451, decouple_loss:0.002453995170071721
The modified gen p mean: 0.446363627910614, gen p mean: -0.2147599458694458, mean p set: 0.4469420909881592The modified gen p mean: 0.44665688276290894, gen p mean: -0.22023238241672516, mean p set: 0.4471801817417145
loss_pred:0.015377573668956757, decouple_loss:0.0025755499955266714
loss_pred:0.015445590019226074, decouple_loss:0.0024589672684669495
Iteration: 5327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731083512306213, gen p mean: -0.21906250715255737, mean p set: 0.44788745045661926
loss_pred:0.01522756926715374, decouple_loss:0.0022004474885761738
The modified gen p mean: 0.4479353129863739, gen p mean: -0.22504793107509613, mean p set: 0.44851207733154297
loss_pred:0.014444231055676937, decouple_loss:0.0022066226229071617
The modified gen p mean: 0.44587594270706177, gen p mean: -0.22191672027111053, mean p set: 0.44640329480171204
loss_pred:0.014983530156314373, decouple_loss:0.002118406817317009
Iteration: 5328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464759826660156, gen p mean: -0.22550010681152344, mean p set: 0.4470498263835907
loss_pred:0.01409960724413395, decouple_loss:0.002354762051254511
The modified gen p mean: 0.4465586841106415, gen p mean: -0.22430658340454102, mean p set: 0.44713470339775085
loss_pred:0.015056278556585312, decouple_loss:0.002301086438819766
The modified gen p mean: 0.44684475660324097, gen p mean: -0.22376742959022522, mean p set: 0.44737792015075684
loss_pred:0.014777219854295254, decouple_loss:0.00222332077100873
Iteration: 5329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474175274372101, gen p mean: -0.22312574088573456, mean p set: 0.44799020886421204
loss_pred:0.014388845302164555, decouple_loss:0.001986616989597678
The modified gen p mean: 0.44667690992355347, gen p mean: -0.2237861603498459, mean p set: 0.44725537300109863
loss_pred:0.01438093837350607, decouple_loss:0.0019938936457037926
The modified gen p mean: 0.44626766443252563, gen p mean: -0.22537794709205627, mean p set: 0.44679760932922363
loss_pred:0.015267832204699516, decouple_loss:0.001981312409043312
Iteration: 5330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483109414577484, gen p mean: -0.22327393293380737, mean p set: 0.44888943433761597
loss_pred:0.01467422116547823, decouple_loss:0.0022366915363818407
The modified gen p mean: 0.44785431027412415, gen p mean: -0.22321943938732147, mean p set: 0.4484235644340515
loss_pred:0.014346369542181492, decouple_loss:0.002131199464201927
The modified gen p mean: 0.4465222656726837, gen p mean: -0.2250281274318695, mean p set: 0.44704657793045044
loss_pred:0.01509641669690609, decouple_loss:0.0019980138167738914
2023-04-28 04:03:30 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22086676955223083, mean p set: 0.4499112665653229
loss_pred:0.015699412673711777, decouple_loss:0.0020697694271802902
The modified gen p mean: 0.44827306270599365, gen p mean: -0.21886952221393585, mean p set: 0.44879910349845886
The modified gen p mean: 0.4493010938167572, gen p mean: -0.2210770547389984, mean p set: 0.4498290419578552
loss_pred:0.015595565550029278, decouple_loss:0.002047222573310137
loss_pred:0.0151941804215312, decouple_loss:0.00206508650444448
WV_1_PC_1_EH_0_PS_30, loss: 0.015599421225488186, avg_mse: 0.02314983867108822
current test mse: 0.02315
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44637319445610046, gen p mean: -0.22535189986228943, mean p set: 0.44695183634757996
loss_pred:0.014825602993369102, decouple_loss:0.002066963352262974
The modified gen p mean: 0.4467107653617859, gen p mean: -0.21774999797344208, mean p set: 0.4472399353981018
loss_pred:0.014844996854662895, decouple_loss:0.002028948161751032
The modified gen p mean: 0.44566309452056885, gen p mean: -0.22141459584236145, mean p set: 0.4462362825870514
loss_pred:0.01431235857307911, decouple_loss:0.0019378782017156482
Iteration: 5332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457833468914032, gen p mean: -0.2209550142288208, mean p set: 0.4463140368461609
loss_pred:0.014457247219979763, decouple_loss:0.0020394623279571533
The modified gen p mean: 0.4463976323604584, gen p mean: -0.22697322070598602, mean p set: 0.4469722807407379
loss_pred:0.0145375095307827, decouple_loss:0.0020245739724487066
The modified gen p mean: 0.4457451105117798, gen p mean: -0.2275048792362213, mean p set: 0.44631776213645935
loss_pred:0.014358976855874062, decouple_loss:0.0020094297360628843
Iteration: 5333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477362632751465, gen p mean: -0.22870202362537384, mean p set: 0.4482622444629669
loss_pred:0.015075597912073135, decouple_loss:0.0020001207012683153
The modified gen p mean: 0.44774338603019714, gen p mean: -0.22616611421108246, mean p set: 0.448323518037796
loss_pred:0.014841116964817047, decouple_loss:0.0018988450756296515
The modified gen p mean: 0.4455951750278473, gen p mean: -0.22326961159706116, mean p set: 0.44616246223449707
loss_pred:0.014884892851114273, decouple_loss:0.0018796207150444388
Iteration: 5334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463997483253479, gen p mean: -0.2297987937927246, mean p set: 0.4469307065010071
loss_pred:0.015319344587624073, decouple_loss:0.0018642384093254805
The modified gen p mean: 0.44718438386917114, gen p mean: -0.2292054444551468, mean p set: 0.44775912165641785
loss_pred:0.014960750006139278, decouple_loss:0.0018688804702833295
The modified gen p mean: 0.4468671381473541, gen p mean: -0.2239292562007904, mean p set: 0.44744786620140076
loss_pred:0.014726960100233555, decouple_loss:0.0018768975278362632
Iteration: 5335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461332857608795, gen p mean: -0.22696642577648163, mean p set: 0.4467087388038635
loss_pred:0.014658359810709953, decouple_loss:0.0019058195175603032
The modified gen p mean: 0.44756871461868286, gen p mean: -0.23001183569431305, mean p set: 0.44809842109680176The modified gen p mean: 0.44673627614974976, gen p mean: -0.2273731380701065, mean p set: 0.4473114311695099
loss_pred:0.013940209522843361, decouple_loss:0.0019707148894667625
loss_pred:0.01465637981891632, decouple_loss:0.0018131663091480732
Iteration: 5336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470939338207245, gen p mean: -0.22621683776378632, mean p set: 0.44766902923583984
loss_pred:0.014443726278841496, decouple_loss:0.0018062746385112405
The modified gen p mean: 0.4459536075592041, gen p mean: -0.2277880609035492, mean p set: 0.44653645157814026The modified gen p mean: 0.4460228681564331, gen p mean: -0.22601349651813507, mean p set: 0.44655176997184753
loss_pred:0.013821465894579887, decouple_loss:0.001973325852304697
loss_pred:0.014857158064842224, decouple_loss:0.001784638618119061
Iteration: 5337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460936486721039, gen p mean: -0.224954754114151, mean p set: 0.44667407870292664
loss_pred:0.01498501282185316, decouple_loss:0.002052959520369768
The modified gen p mean: 0.44597142934799194, gen p mean: -0.22834022343158722, mean p set: 0.4465000033378601The modified gen p mean: 0.4451981782913208, gen p mean: -0.22676676511764526, mean p set: 0.4457741975784302
loss_pred:0.014260374009609222, decouple_loss:0.0019444369245320559
loss_pred:0.014076103456318378, decouple_loss:0.0020141853019595146
Iteration: 5338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446533203125, gen p mean: -0.22708024084568024, mean p set: 0.447105348110199
loss_pred:0.014693619683384895, decouple_loss:0.00173623685259372
The modified gen p mean: 0.4464424252510071, gen p mean: -0.22565339505672455, mean p set: 0.4470142424106598The modified gen p mean: 0.44645702838897705, gen p mean: -0.23088939487934113, mean p set: 0.4469846189022064
loss_pred:0.014287713915109634, decouple_loss:0.001750015770085156
loss_pred:0.015303888358175755, decouple_loss:0.0017704535275697708
Iteration: 5339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461379647254944, gen p mean: -0.228714719414711, mean p set: 0.44671353697776794
loss_pred:0.014612063765525818, decouple_loss:0.0020230640657246113
The modified gen p mean: 0.44791996479034424, gen p mean: -0.23084093630313873, mean p set: 0.4484979510307312
loss_pred:0.014851829037070274, decouple_loss:0.001915216213092208
The modified gen p mean: 0.4461909532546997, gen p mean: -0.23131507635116577, mean p set: 0.4467202425003052
loss_pred:0.014576287940144539, decouple_loss:0.0018326550489291549
Iteration: 5340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475318491458893, gen p mean: -0.23505041003227234, mean p set: 0.4480991065502167
loss_pred:0.014343968592584133, decouple_loss:0.001809175475500524
The modified gen p mean: 0.4469227194786072, gen p mean: -0.23570199310779572, mean p set: 0.4474559724330902
The modified gen p mean: 0.44729524850845337, gen p mean: -0.23264651000499725, mean p set: 0.44787484407424927
loss_pred:0.01402800902724266, decouple_loss:0.001849228166975081
loss_pred:0.014121894724667072, decouple_loss:0.0016859018942341208
2023-04-28 04:06:53 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23352999985218048, mean p set: 0.4499112665653229
loss_pred:0.01548931747674942, decouple_loss:0.0018100256565958261
The modified gen p mean: 0.4482728838920593, gen p mean: -0.23150305449962616, mean p set: 0.44879910349845886
loss_pred:0.015408335253596306, decouple_loss:0.0017423987155780196
The modified gen p mean: 0.4493007957935333, gen p mean: -0.23330046236515045, mean p set: 0.4498290419578552
loss_pred:0.015086844563484192, decouple_loss:0.0017936695367097855
WV_1_PC_1_EH_0_PS_30, loss: 0.015417268499732018, avg_mse: 0.022917065769433975
current test mse: 0.022917
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 5341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764137268066406, gen p mean: -0.23410561680793762, mean p set: 0.4481693506240845
loss_pred:0.013463898561894894, decouple_loss:0.0017442089738324285
The modified gen p mean: 0.4470270276069641, gen p mean: -0.23184864223003387, mean p set: 0.4475933611392975
loss_pred:0.014235438778996468, decouple_loss:0.0018304918194189668
The modified gen p mean: 0.44803717732429504, gen p mean: -0.22895266115665436, mean p set: 0.44860655069351196
loss_pred:0.013550378382205963, decouple_loss:0.0019415263086557388
Iteration: 5342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763392210006714, gen p mean: -0.23446691036224365, mean p set: 0.44816869497299194
loss_pred:0.014250432141125202, decouple_loss:0.0018934017280116677
The modified gen p mean: 0.4477617144584656, gen p mean: -0.2292485535144806, mean p set: 0.4483305513858795
loss_pred:0.014503611251711845, decouple_loss:0.0020705668721348047
The modified gen p mean: 0.4479902982711792, gen p mean: -0.2216888964176178, mean p set: 0.44856393337249756
loss_pred:0.014313600026071072, decouple_loss:0.002041649306192994
Iteration: 5343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467509686946869, gen p mean: -0.22584402561187744, mean p set: 0.4472792148590088
loss_pred:0.013892019167542458, decouple_loss:0.0021424994338303804
The modified gen p mean: 0.4469653069972992, gen p mean: -0.23130793869495392, mean p set: 0.44753962755203247
loss_pred:0.013683130033314228, decouple_loss:0.001888141967356205
The modified gen p mean: 0.44766470789909363, gen p mean: -0.2205144315958023, mean p set: 0.44824254512786865
loss_pred:0.014280627481639385, decouple_loss:0.0018807768356055021
Iteration: 5344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806838035583496, gen p mean: -0.22641128301620483, mean p set: 0.4485950767993927
loss_pred:0.01366021391004324, decouple_loss:0.0018998219165951014
The modified gen p mean: 0.448985755443573, gen p mean: -0.21640808880329132, mean p set: 0.4495594799518585
loss_pred:0.01349204033613205, decouple_loss:0.0020566016901284456
The modified gen p mean: 0.44755181670188904, gen p mean: -0.22390225529670715, mean p set: 0.44812917709350586
loss_pred:0.01410804782062769, decouple_loss:0.001834708615206182
Iteration: 5345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485374093055725, gen p mean: -0.21636009216308594, mean p set: 0.4491148293018341
loss_pred:0.013517837040126324, decouple_loss:0.0021937121637165546
The modified gen p mean: 0.44716453552246094, gen p mean: -0.22006985545158386, mean p set: 0.4476836025714874The modified gen p mean: 0.4473215639591217, gen p mean: -0.21813568472862244, mean p set: 0.4478912055492401
loss_pred:0.012970874086022377, decouple_loss:0.0022040025796741247
loss_pred:0.014417652040719986, decouple_loss:0.0018517959397286177
Iteration: 5346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806554913520813, gen p mean: -0.22566546499729156, mean p set: 0.4486410617828369
loss_pred:0.013373086228966713, decouple_loss:0.0020701989997178316
The modified gen p mean: 0.44714972376823425, gen p mean: -0.22414395213127136, mean p set: 0.44768205285072327The modified gen p mean: 0.4467984735965729, gen p mean: -0.2277032732963562, mean p set: 0.4473792016506195
loss_pred:0.013853266835212708, decouple_loss:0.002109139459207654
loss_pred:0.014721627347171307, decouple_loss:0.0021081033628433943
Iteration: 5347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873782992362976, gen p mean: -0.2264450490474701, mean p set: 0.449308842420578
loss_pred:0.013041354715824127, decouple_loss:0.0021251575089991093
The modified gen p mean: 0.4474368989467621, gen p mean: -0.22561322152614594, mean p set: 0.4480154812335968
loss_pred:0.013318607583642006, decouple_loss:0.0021476440597325563
The modified gen p mean: 0.44957834482192993, gen p mean: -0.22176946699619293, mean p set: 0.45010778307914734
loss_pred:0.01308093685656786, decouple_loss:0.002008349634706974
Iteration: 5348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708797335624695, gen p mean: -0.2233617603778839, mean p set: 0.4476613700389862
loss_pred:0.01353944931179285, decouple_loss:0.002057309029623866
The modified gen p mean: 0.4478749930858612, gen p mean: -0.2200794219970703, mean p set: 0.44845467805862427
loss_pred:0.012972063384950161, decouple_loss:0.002187891863286495
The modified gen p mean: 0.44711190462112427, gen p mean: -0.22175179421901703, mean p set: 0.4476364552974701
loss_pred:0.013873815536499023, decouple_loss:0.0021149273961782455
Iteration: 5349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722476601600647, gen p mean: -0.22899824380874634, mean p set: 0.44780364632606506
loss_pred:0.013932539150118828, decouple_loss:0.0022000267636030912
The modified gen p mean: 0.4465939998626709, gen p mean: -0.22286489605903625, mean p set: 0.4471684396266937
loss_pred:0.013834746554493904, decouple_loss:0.0020511390175670385
The modified gen p mean: 0.4484880864620209, gen p mean: -0.2175750881433487, mean p set: 0.4490176737308502
loss_pred:0.013592567294836044, decouple_loss:0.001998889958485961
Iteration: 5350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482020437717438, gen p mean: -0.22044342756271362, mean p set: 0.4487749934196472
loss_pred:0.013784082606434822, decouple_loss:0.0019639316014945507
The modified gen p mean: 0.4479975700378418, gen p mean: -0.2210661768913269, mean p set: 0.4485217034816742The modified gen p mean: 0.44748470187187195, gen p mean: -0.21996153891086578, mean p set: 0.4480615258216858
loss_pred:0.013210522942245007, decouple_loss:0.0019736920949071646
loss_pred:0.01349511556327343, decouple_loss:0.0018522964091971517
2023-04-28 04:11:03 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.22316992282867432, mean p set: 0.4499112665653229
loss_pred:0.015521381050348282, decouple_loss:0.00201993016526103
The modified gen p mean: 0.44826918840408325, gen p mean: -0.22090643644332886, mean p set: 0.44879910349845886
The modified gen p mean: 0.4493005871772766, gen p mean: -0.2226761132478714, mean p set: 0.4498290419578552
loss_pred:0.015133530832827091, decouple_loss:0.002026038011536002
loss_pred:0.015521102584898472, decouple_loss:0.002060151193290949
WV_1_PC_1_EH_0_PS_30, loss: 0.01549377292394638, avg_mse: 0.023042798042297363
current test mse: 0.023043
Iteration: 5351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447796106338501, gen p mean: -0.22212079167366028, mean p set: 0.4483700692653656
loss_pred:0.012987633235752583, decouple_loss:0.0017957071540877223
The modified gen p mean: 0.446786105632782, gen p mean: -0.22523260116577148, mean p set: 0.4473148286342621
loss_pred:0.013439706526696682, decouple_loss:0.001846979488618672
The modified gen p mean: 0.4475592076778412, gen p mean: -0.223525732755661, mean p set: 0.44813597202301025
loss_pred:0.013894613832235336, decouple_loss:0.0020576175302267075
Iteration: 5352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486551284790039, gen p mean: -0.22392679750919342, mean p set: 0.44918543100357056
loss_pred:0.013182956725358963, decouple_loss:0.0018352814950048923
The modified gen p mean: 0.446946382522583, gen p mean: -0.2255101501941681, mean p set: 0.4475235044956207
The modified gen p mean: 0.44769424200057983, gen p mean: -0.22339725494384766, mean p set: 0.4482676684856415
loss_pred:0.013542469590902328, decouple_loss:0.001868784660473466
loss_pred:0.013442540541291237, decouple_loss:0.0020440807566046715
Iteration: 5353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472278952598572, gen p mean: -0.2300022393465042, mean p set: 0.44775503873825073
loss_pred:0.01335300225764513, decouple_loss:0.001940779504366219
The modified gen p mean: 0.4489961564540863, gen p mean: -0.21865390241146088, mean p set: 0.4495725929737091
The modified gen p mean: 0.4476412534713745, gen p mean: -0.22777171432971954, mean p set: 0.44821614027023315
loss_pred:0.013456041924655437, decouple_loss:0.001766391796991229
loss_pred:0.013958197087049484, decouple_loss:0.0018603182397782803
Iteration: 5354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477539360523224, gen p mean: -0.2291446030139923, mean p set: 0.4482842683792114
loss_pred:0.013914715498685837, decouple_loss:0.0020330811385065317
The modified gen p mean: 0.44938012957572937, gen p mean: -0.22170303761959076, mean p set: 0.4499603509902954
The modified gen p mean: 0.4472482204437256, gen p mean: -0.2311207503080368, mean p set: 0.44783204793930054
loss_pred:0.013238701038062572, decouple_loss:0.0020666380878537893
loss_pred:0.013650476932525635, decouple_loss:0.0018491511000320315
Iteration: 5355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478367269039154, gen p mean: -0.23155254125595093, mean p set: 0.44842052459716797
loss_pred:0.01355800498276949, decouple_loss:0.00175407191272825
The modified gen p mean: 0.44759395718574524, gen p mean: -0.23627108335494995, mean p set: 0.4481755197048187The modified gen p mean: 0.4480612277984619, gen p mean: -0.23503687977790833, mean p set: 0.44859078526496887
loss_pred:0.01320941373705864, decouple_loss:0.0018358324887230992
loss_pred:0.012922697700560093, decouple_loss:0.0016295893583446741
Iteration: 5356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484783113002777, gen p mean: -0.22776056826114655, mean p set: 0.44905948638916016
loss_pred:0.01405418012291193, decouple_loss:0.0022796853445470333
The modified gen p mean: 0.446491003036499, gen p mean: -0.2282945066690445, mean p set: 0.44701725244522095The modified gen p mean: 0.44805410504341125, gen p mean: -0.23206588625907898, mean p set: 0.44863179326057434
loss_pred:0.01313831191509962, decouple_loss:0.0017658218275755644
loss_pred:0.013827159069478512, decouple_loss:0.001842841156758368
Iteration: 5357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741424918174744, gen p mean: -0.22720104455947876, mean p set: 0.44798195362091064
loss_pred:0.013301480561494827, decouple_loss:0.0019069446716457605
The modified gen p mean: 0.4469810724258423, gen p mean: -0.22731363773345947, mean p set: 0.4475088119506836The modified gen p mean: 0.4472178816795349, gen p mean: -0.23516742885112762, mean p set: 0.4477936327457428
loss_pred:0.01309240236878395, decouple_loss:0.0018659199122339487
loss_pred:0.013686378486454487, decouple_loss:0.0019501124043017626
Iteration: 5358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472939670085907, gen p mean: -0.22890742123126984, mean p set: 0.4478708505630493
loss_pred:0.013098151423037052, decouple_loss:0.0016501916106790304
The modified gen p mean: 0.4485400915145874, gen p mean: -0.22552840411663055, mean p set: 0.4491144120693207The modified gen p mean: 0.44742676615715027, gen p mean: -0.22721624374389648, mean p set: 0.4479523003101349
loss_pred:0.013525592163205147, decouple_loss:0.0016227877931669354
loss_pred:0.013793475925922394, decouple_loss:0.0018310052109882236
Iteration: 5359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476470351219177, gen p mean: -0.2255644053220749, mean p set: 0.44822585582733154
loss_pred:0.013704359531402588, decouple_loss:0.00191044295206666
The modified gen p mean: 0.4476171135902405, gen p mean: -0.22630254924297333, mean p set: 0.44814783334732056The modified gen p mean: 0.44703763723373413, gen p mean: -0.22685669362545013, mean p set: 0.4476158618927002
loss_pred:0.01388020720332861, decouple_loss:0.0020715987775474787
loss_pred:0.013384876772761345, decouple_loss:0.0020597665570676327
Iteration: 5360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779452681541443, gen p mean: -0.2330748289823532, mean p set: 0.44836780428886414
loss_pred:0.014507903717458248, decouple_loss:0.001806099433451891
The modified gen p mean: 0.44792863726615906, gen p mean: -0.2349170595407486, mean p set: 0.44845813512802124The modified gen p mean: 0.44748401641845703, gen p mean: -0.2351440191268921, mean p set: 0.44805845618247986
loss_pred:0.013559120707213879, decouple_loss:0.0017239951994270086
loss_pred:0.012941014021635056, decouple_loss:0.0017460850067436695
2023-04-28 04:14:26 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2343006283044815, mean p set: 0.4499112665653229
loss_pred:0.015512844547629356, decouple_loss:0.0018648867262527347
The modified gen p mean: 0.4482690691947937, gen p mean: -0.23177334666252136, mean p set: 0.44879910349845886
loss_pred:0.015525341965258121, decouple_loss:0.0019521424546837807
The modified gen p mean: 0.44929975271224976, gen p mean: -0.23350808024406433, mean p set: 0.4498290419578552
loss_pred:0.015058588236570358, decouple_loss:0.0018584027420729399
WV_1_PC_1_EH_0_PS_30, loss: 0.01546018198132515, avg_mse: 0.02301752381026745
current test mse: 0.023018
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 5361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493621587753296, gen p mean: -0.23608288168907166, mean p set: 0.449893593788147
loss_pred:0.01402257476001978, decouple_loss:0.0020130465272814035
The modified gen p mean: 0.44828787446022034, gen p mean: -0.23536784946918488, mean p set: 0.44887539744377136
loss_pred:0.013936355710029602, decouple_loss:0.0019503304501995444
The modified gen p mean: 0.4489053189754486, gen p mean: -0.2384084314107895, mean p set: 0.44948384165763855
loss_pred:0.01431265939027071, decouple_loss:0.002192790387198329
Iteration: 5362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484822154045105, gen p mean: -0.2361057698726654, mean p set: 0.44901350140571594
loss_pred:0.013770632445812225, decouple_loss:0.001801296486519277
The modified gen p mean: 0.44828709959983826, gen p mean: -0.23691125214099884, mean p set: 0.4488602578639984
loss_pred:0.013764603063464165, decouple_loss:0.001998837338760495
The modified gen p mean: 0.4488343298435211, gen p mean: -0.23620852828025818, mean p set: 0.4494136571884155
loss_pred:0.013316306285560131, decouple_loss:0.0018505811458453536
Iteration: 5363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479169249534607, gen p mean: -0.23891668021678925, mean p set: 0.4484424889087677
loss_pred:0.014266060665249825, decouple_loss:0.0017264109337702394
The modified gen p mean: 0.4488382637500763, gen p mean: -0.23772069811820984, mean p set: 0.44941920042037964
loss_pred:0.01420029066503048, decouple_loss:0.0016658895183354616
The modified gen p mean: 0.4487632215023041, gen p mean: -0.23774322867393494, mean p set: 0.44933804869651794
loss_pred:0.013114078901708126, decouple_loss:0.0017103562131524086
Iteration: 5364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448329359292984, gen p mean: -0.23201417922973633, mean p set: 0.4488604962825775
loss_pred:0.013238907791674137, decouple_loss:0.0018388570751994848
The modified gen p mean: 0.44951292872428894, gen p mean: -0.23058992624282837, mean p set: 0.45008060336112976
loss_pred:0.01364696491509676, decouple_loss:0.0018508151406422257
The modified gen p mean: 0.4497050940990448, gen p mean: -0.23562073707580566, mean p set: 0.4502778649330139
loss_pred:0.014289019629359245, decouple_loss:0.0018112205434590578
Iteration: 5365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672101736068726, gen p mean: -0.23545654118061066, mean p set: 0.44730639457702637
loss_pred:0.013878406956791878, decouple_loss:0.0018445724854245782
The modified gen p mean: 0.4491579830646515, gen p mean: -0.23778894543647766, mean p set: 0.4496924579143524The modified gen p mean: 0.44852325320243835, gen p mean: -0.23479726910591125, mean p set: 0.44909700751304626
loss_pred:0.013643218204379082, decouple_loss:0.0020822486840188503
loss_pred:0.013219159096479416, decouple_loss:0.0020087575539946556
Iteration: 5366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890785217285156, gen p mean: -0.22825591266155243, mean p set: 0.449482798576355
loss_pred:0.01380839105695486, decouple_loss:0.0019912368152290583
The modified gen p mean: 0.4481295347213745, gen p mean: -0.22520796954631805, mean p set: 0.44870755076408386
loss_pred:0.013180346228182316, decouple_loss:0.0018830139888450503
The modified gen p mean: 0.44878989458084106, gen p mean: -0.237326517701149, mean p set: 0.449317067861557
loss_pred:0.01339254342019558, decouple_loss:0.002097941003739834
Iteration: 5367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790539145469666, gen p mean: -0.23554864525794983, mean p set: 0.44847777485847473
loss_pred:0.014604419469833374, decouple_loss:0.0016747507033869624
The modified gen p mean: 0.44931498169898987, gen p mean: -0.23362751305103302, mean p set: 0.449893057346344
loss_pred:0.01355853583663702, decouple_loss:0.0018196628661826253
The modified gen p mean: 0.4486728608608246, gen p mean: -0.2362966686487198, mean p set: 0.4492034912109375
loss_pred:0.014009232632815838, decouple_loss:0.001722501590847969
Iteration: 5368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477286636829376, gen p mean: -0.23802679777145386, mean p set: 0.4483092129230499
loss_pred:0.013826919719576836, decouple_loss:0.0017814476741477847
The modified gen p mean: 0.4473158121109009, gen p mean: -0.2327931970357895, mean p set: 0.44789305329322815
loss_pred:0.014349197968840599, decouple_loss:0.0017489928286522627
The modified gen p mean: 0.44783616065979004, gen p mean: -0.23790989816188812, mean p set: 0.44836267828941345
loss_pred:0.014400391839444637, decouple_loss:0.0017117977840825915
Iteration: 5369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447049617767334, gen p mean: -0.2366226464509964, mean p set: 0.44762104749679565
loss_pred:0.014079784974455833, decouple_loss:0.0018222525250166655
The modified gen p mean: 0.44855013489723206, gen p mean: -0.23868827521800995, mean p set: 0.4491303265094757
loss_pred:0.013343731872737408, decouple_loss:0.0017770968843251467
The modified gen p mean: 0.44848397374153137, gen p mean: -0.23780885338783264, mean p set: 0.44901934266090393
loss_pred:0.013268861919641495, decouple_loss:0.0017282591434195638
Iteration: 5370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716116786003113, gen p mean: -0.23736827075481415, mean p set: 0.44773876667022705
loss_pred:0.01422035600990057, decouple_loss:0.0016681741690263152
The modified gen p mean: 0.44750601053237915, gen p mean: -0.23934665322303772, mean p set: 0.4480784237384796The modified gen p mean: 0.4494003355503082, gen p mean: -0.23626255989074707, mean p set: 0.4499293565750122
loss_pred:0.014375814236700535, decouple_loss:0.0017312902491539717
loss_pred:0.013921367935836315, decouple_loss:0.0016618621302768588
2023-04-28 04:18:44 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23760327696800232, mean p set: 0.4499112665653229
loss_pred:0.015440302900969982, decouple_loss:0.0020817317999899387
The modified gen p mean: 0.44827330112457275, gen p mean: -0.2349861115217209, mean p set: 0.44879910349845886
The modified gen p mean: 0.44929683208465576, gen p mean: -0.23730289936065674, mean p set: 0.4498290419578552
loss_pred:0.015407162718474865, decouple_loss:0.0019491221755743027
loss_pred:0.014929444529116154, decouple_loss:0.00184790906496346
WV_1_PC_1_EH_0_PS_30, loss: 0.015356950461864471, avg_mse: 0.02281075343489647
current test mse: 0.022811
Iteration: 5371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878876209259033, gen p mean: -0.2343994677066803, mean p set: 0.4493674635887146
loss_pred:0.013698876835405827, decouple_loss:0.001764688640832901
The modified gen p mean: 0.4494081735610962, gen p mean: -0.24370117485523224, mean p set: 0.4499812126159668The modified gen p mean: 0.44714030623435974, gen p mean: -0.23753632605075836, mean p set: 0.44766971468925476
loss_pred:0.013460124842822552, decouple_loss:0.002024933695793152
loss_pred:0.014221185818314552, decouple_loss:0.0019048782996833324
Iteration: 5372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481775462627411, gen p mean: -0.2331247627735138, mean p set: 0.4487088918685913
loss_pred:0.01328926533460617, decouple_loss:0.0017835671314969659
The modified gen p mean: 0.44751855731010437, gen p mean: -0.23868712782859802, mean p set: 0.44810163974761963
loss_pred:0.013493217527866364, decouple_loss:0.001745036686770618
The modified gen p mean: 0.44836822152137756, gen p mean: -0.23669055104255676, mean p set: 0.448948472738266
loss_pred:0.014287772588431835, decouple_loss:0.0016644621500745416
Iteration: 5373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471498727798462, gen p mean: -0.23293010890483856, mean p set: 0.44768157601356506
loss_pred:0.013978489674627781, decouple_loss:0.0017940113320946693
The modified gen p mean: 0.44826963543891907, gen p mean: -0.23135019838809967, mean p set: 0.44884148240089417
loss_pred:0.013144567608833313, decouple_loss:0.0017399601638317108
The modified gen p mean: 0.4471832811832428, gen p mean: -0.23487618565559387, mean p set: 0.4477550983428955
loss_pred:0.01384380180388689, decouple_loss:0.0017040378879755735
Iteration: 5374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751113653182983, gen p mean: -0.22030754387378693, mean p set: 0.44804272055625916
loss_pred:0.013234232552349567, decouple_loss:0.0019236457301303744
The modified gen p mean: 0.44854700565338135, gen p mean: -0.2325669825077057, mean p set: 0.44912344217300415
loss_pred:0.012698028236627579, decouple_loss:0.0019374930998310447
The modified gen p mean: 0.4479847848415375, gen p mean: -0.22092628479003906, mean p set: 0.4485621154308319
loss_pred:0.01327498722821474, decouple_loss:0.0019183979602530599
Iteration: 5375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479137361049652, gen p mean: -0.2322300225496292, mean p set: 0.4484889805316925
loss_pred:0.013904246501624584, decouple_loss:0.001821753103286028
The modified gen p mean: 0.44862720370292664, gen p mean: -0.2255188673734665, mean p set: 0.4491572082042694The modified gen p mean: 0.44865307211875916, gen p mean: -0.22588321566581726, mean p set: 0.4492361843585968
loss_pred:0.013025057502090931, decouple_loss:0.001833006739616394
loss_pred:0.013095163740217686, decouple_loss:0.0018290861044079065
Iteration: 5376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919517636299133, gen p mean: -0.2343127429485321, mean p set: 0.4497707486152649
loss_pred:0.013581342063844204, decouple_loss:0.0016961414366960526
The modified gen p mean: 0.4476025402545929, gen p mean: -0.2320326715707779, mean p set: 0.4481314718723297The modified gen p mean: 0.4487636387348175, gen p mean: -0.2251119315624237, mean p set: 0.44933751225471497
loss_pred:0.01372581347823143, decouple_loss:0.0015640562633052468
loss_pred:0.014471873641014099, decouple_loss:0.001638766610994935
Iteration: 5377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975537061691284, gen p mean: -0.22874408960342407, mean p set: 0.45032650232315063
loss_pred:0.013584248721599579, decouple_loss:0.0015927348285913467
The modified gen p mean: 0.4477182924747467, gen p mean: -0.2326156497001648, mean p set: 0.44830194115638733
loss_pred:0.014023987576365471, decouple_loss:0.0016531135188415647
The modified gen p mean: 0.44783368706703186, gen p mean: -0.23442336916923523, mean p set: 0.44836223125457764
loss_pred:0.014337100088596344, decouple_loss:0.0017508669989183545
Iteration: 5378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480382204055786, gen p mean: -0.2312810719013214, mean p set: 0.4486178159713745
loss_pred:0.013774226419627666, decouple_loss:0.0016210080357268453
The modified gen p mean: 0.44922152161598206, gen p mean: -0.23829865455627441, mean p set: 0.4497983753681183
loss_pred:0.0137849822640419, decouple_loss:0.0018331763567402959
The modified gen p mean: 0.44807547330856323, gen p mean: -0.23146682977676392, mean p set: 0.4485989212989807
loss_pred:0.014292915351688862, decouple_loss:0.0016295027453452349
Iteration: 5379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474373757839203, gen p mean: -0.23378285765647888, mean p set: 0.44801095128059387
loss_pred:0.01387349609285593, decouple_loss:0.001471185591071844
The modified gen p mean: 0.4486757218837738, gen p mean: -0.2347097396850586, mean p set: 0.4492538273334503
loss_pred:0.01381305605173111, decouple_loss:0.001570737804286182
The modified gen p mean: 0.44748884439468384, gen p mean: -0.23519855737686157, mean p set: 0.4480117857456207
loss_pred:0.01370538305491209, decouple_loss:0.0015576714649796486
Iteration: 5380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475982189178467, gen p mean: -0.2336389720439911, mean p set: 0.4481810927391052
loss_pred:0.01444923970848322, decouple_loss:0.0017386918189004064
The modified gen p mean: 0.4486507773399353, gen p mean: -0.23864398896694183, mean p set: 0.44917547702789307The modified gen p mean: 0.44774216413497925, gen p mean: -0.2374696433544159, mean p set: 0.4483141601085663
loss_pred:0.013579889200627804, decouple_loss:0.0015846502501517534
loss_pred:0.01382621843367815, decouple_loss:0.0017900533275678754
2023-04-28 04:22:09 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23595188558101654, mean p set: 0.4499112665653229
loss_pred:0.015364150516688824, decouple_loss:0.0018308815779164433
The modified gen p mean: 0.4482690989971161, gen p mean: -0.23333914577960968, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492953419685364, gen p mean: -0.2355724275112152, mean p set: 0.4498290419578552
loss_pred:0.015325206331908703, decouple_loss:0.001578334136866033loss_pred:0.014894429594278336, decouple_loss:0.0016079298220574856
WV_1_PC_1_EH_0_PS_30, loss: 0.015278215520083904, avg_mse: 0.022720547392964363
current test mse: 0.022721
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 5381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485709071159363, gen p mean: -0.23350724577903748, mean p set: 0.4491024613380432
loss_pred:0.013164705596864223, decouple_loss:0.0015462582232430577
The modified gen p mean: 0.4467785656452179, gen p mean: -0.2373296022415161, mean p set: 0.44735386967658997
loss_pred:0.014301667921245098, decouple_loss:0.0015641110949218273
The modified gen p mean: 0.44782400131225586, gen p mean: -0.23671801388263702, mean p set: 0.4483965039253235
loss_pred:0.013733383268117905, decouple_loss:0.0017405757680535316
Iteration: 5382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447384774684906, gen p mean: -0.23904436826705933, mean p set: 0.44791606068611145
loss_pred:0.013745971024036407, decouple_loss:0.0016030805418267846
The modified gen p mean: 0.4475294351577759, gen p mean: -0.2339020073413849, mean p set: 0.44810861349105835
The modified gen p mean: 0.4468212425708771, gen p mean: -0.23780062794685364, mean p set: 0.4473954439163208
loss_pred:0.013652291148900986, decouple_loss:0.0016744044842198491
loss_pred:0.014262623153626919, decouple_loss:0.0015369944740086794
Iteration: 5383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674327969551086, gen p mean: -0.23578476905822754, mean p set: 0.4472673535346985
loss_pred:0.014355125837028027, decouple_loss:0.001572734909132123
The modified gen p mean: 0.44848865270614624, gen p mean: -0.24346117675304413, mean p set: 0.44905540347099304
The modified gen p mean: 0.44650405645370483, gen p mean: -0.2293737828731537, mean p set: 0.4470857083797455
loss_pred:0.013761842623353004, decouple_loss:0.001831540954299271
loss_pred:0.014315293170511723, decouple_loss:0.0016287219477817416
Iteration: 5384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479786455631256, gen p mean: -0.23248964548110962, mean p set: 0.44850608706474304
loss_pred:0.013034983538091183, decouple_loss:0.0016539058415219188
The modified gen p mean: 0.44801363348960876, gen p mean: -0.23401208221912384, mean p set: 0.44859424233436584
The modified gen p mean: 0.44784095883369446, gen p mean: -0.23596666753292084, mean p set: 0.44841110706329346
loss_pred:0.013884796760976315, decouple_loss:0.0016844019992277026
loss_pred:0.014373213052749634, decouple_loss:0.0015420453855767846
Iteration: 5385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476562738418579, gen p mean: -0.22816255688667297, mean p set: 0.4482302665710449
loss_pred:0.013441788963973522, decouple_loss:0.0016486895037814975
The modified gen p mean: 0.44925883412361145, gen p mean: -0.22937090694904327, mean p set: 0.4498293101787567The modified gen p mean: 0.4468812942504883, gen p mean: -0.23071454465389252, mean p set: 0.44740498065948486
loss_pred:0.013570629991590977, decouple_loss:0.0017113524954766035
loss_pred:0.013795082457363605, decouple_loss:0.0016559099312871695
Iteration: 5386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481920003890991, gen p mean: -0.22764651477336884, mean p set: 0.44876906275749207
loss_pred:0.01300761941820383, decouple_loss:0.0018357358640059829
The modified gen p mean: 0.4481178820133209, gen p mean: -0.229973703622818, mean p set: 0.4486897885799408The modified gen p mean: 0.44799941778182983, gen p mean: -0.22582755982875824, mean p set: 0.4485248327255249
loss_pred:0.013438394293189049, decouple_loss:0.0017308401875197887
loss_pred:0.013646514154970646, decouple_loss:0.0016248805914074183
Iteration: 5387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706183671951294, gen p mean: -0.2299051433801651, mean p set: 0.4476391673088074
loss_pred:0.013246452435851097, decouple_loss:0.0017250721575692296
The modified gen p mean: 0.4475255310535431, gen p mean: -0.23675242066383362, mean p set: 0.4481002688407898
loss_pred:0.013777220621705055, decouple_loss:0.0018761567771434784
The modified gen p mean: 0.446817547082901, gen p mean: -0.23514997959136963, mean p set: 0.4473487436771393
loss_pred:0.014006526209414005, decouple_loss:0.001929810969159007
Iteration: 5388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747763872146606, gen p mean: -0.2260063737630844, mean p set: 0.4480552673339844
loss_pred:0.013551045209169388, decouple_loss:0.0020114313811063766
The modified gen p mean: 0.4460775554180145, gen p mean: -0.22361545264720917, mean p set: 0.44665467739105225The modified gen p mean: 0.4471581280231476, gen p mean: -0.22457243502140045, mean p set: 0.4476827085018158
loss_pred:0.014484266750514507, decouple_loss:0.0018342011608183384
loss_pred:0.01365005224943161, decouple_loss:0.0017678049625828862
Iteration: 5389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482981860637665, gen p mean: -0.2302027940750122, mean p set: 0.448875367641449
loss_pred:0.013554345816373825, decouple_loss:0.0020548433531075716
The modified gen p mean: 0.44768619537353516, gen p mean: -0.23368500173091888, mean p set: 0.44826218485832214
loss_pred:0.01327918004244566, decouple_loss:0.0017875961493700743
The modified gen p mean: 0.448942095041275, gen p mean: -0.23024669289588928, mean p set: 0.4494676887989044
loss_pred:0.013497669249773026, decouple_loss:0.0020179941784590483
Iteration: 5390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817206263542175, gen p mean: -0.23258616030216217, mean p set: 0.44874149560928345
loss_pred:0.013118701986968517, decouple_loss:0.0016986344708129764
The modified gen p mean: 0.44757962226867676, gen p mean: -0.23910115659236908, mean p set: 0.44815701246261597
loss_pred:0.013671474531292915, decouple_loss:0.0018554433481767774
The modified gen p mean: 0.447316437959671, gen p mean: -0.23475007712841034, mean p set: 0.4478446841239929
loss_pred:0.013780242763459682, decouple_loss:0.0018734131008386612
2023-04-28 04:26:21 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23780852556228638, mean p set: 0.4499112665653229
loss_pred:0.015350088477134705, decouple_loss:0.0018401501001790166
The modified gen p mean: 0.4482698142528534, gen p mean: -0.23494331538677216, mean p set: 0.44879910349845886
loss_pred:0.015305470675230026, decouple_loss:0.001729484531097114
The modified gen p mean: 0.44930416345596313, gen p mean: -0.2374432235956192, mean p set: 0.4498290419578552
loss_pred:0.0148397758603096, decouple_loss:0.0017459813971072435
WV_1_PC_1_EH_0_PS_30, loss: 0.015253705903887749, avg_mse: 0.022650310769677162
current test mse: 0.02265
Iteration: 5391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633808732032776, gen p mean: -0.24292443692684174, mean p set: 0.44691917300224304
loss_pred:0.014066312462091446, decouple_loss:0.0017647657077759504
The modified gen p mean: 0.44913503527641296, gen p mean: -0.23605157434940338, mean p set: 0.4496593773365021The modified gen p mean: 0.4483405351638794, gen p mean: -0.2366028130054474, mean p set: 0.4489155113697052
loss_pred:0.012779463082551956, decouple_loss:0.0016542145749554038
loss_pred:0.013434913009405136, decouple_loss:0.0017155259847640991
Iteration: 5392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777733087539673, gen p mean: -0.23666580021381378, mean p set: 0.44829997420310974
loss_pred:0.013949853368103504, decouple_loss:0.0016306816833093762
The modified gen p mean: 0.44785019755363464, gen p mean: -0.23793356120586395, mean p set: 0.4484281837940216
loss_pred:0.01450374536216259, decouple_loss:0.001798932789824903
The modified gen p mean: 0.4484175741672516, gen p mean: -0.2358887940645218, mean p set: 0.4489942789077759
loss_pred:0.013221009634435177, decouple_loss:0.00173021643422544
Iteration: 5393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464089870452881, gen p mean: -0.23466315865516663, mean p set: 0.44693389534950256
loss_pred:0.014005457982420921, decouple_loss:0.0015962662873789668
The modified gen p mean: 0.4478035569190979, gen p mean: -0.23632752895355225, mean p set: 0.4483831226825714
loss_pred:0.013308555819094181, decouple_loss:0.0016338106943294406
The modified gen p mean: 0.4471724033355713, gen p mean: -0.23505470156669617, mean p set: 0.4477500915527344
loss_pred:0.013557296246290207, decouple_loss:0.0016424531349912286
Iteration: 5394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470863342285156, gen p mean: -0.23596833646297455, mean p set: 0.44761136174201965
loss_pred:0.013805435970425606, decouple_loss:0.0015815187944099307
The modified gen p mean: 0.44822782278060913, gen p mean: -0.23118597269058228, mean p set: 0.4488039016723633
loss_pred:0.012766904197633266, decouple_loss:0.0016069841803982854
The modified gen p mean: 0.44766369462013245, gen p mean: -0.23639889061450958, mean p set: 0.4482366442680359
loss_pred:0.013196933083236217, decouple_loss:0.0015983153134584427
Iteration: 5395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788262248039246, gen p mean: -0.2288113385438919, mean p set: 0.44846025109291077
loss_pred:0.01338827982544899, decouple_loss:0.001731743454001844
The modified gen p mean: 0.4473338723182678, gen p mean: -0.23344182968139648, mean p set: 0.4478660821914673The modified gen p mean: 0.449386328458786, gen p mean: -0.23216910660266876, mean p set: 0.4499613046646118
loss_pred:0.0135447783395648, decouple_loss:0.0016546398401260376
loss_pred:0.013080958276987076, decouple_loss:0.0016982494853436947
Iteration: 5396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480017125606537, gen p mean: -0.22788241505622864, mean p set: 0.4485850930213928
loss_pred:0.013177032582461834, decouple_loss:0.0015905372565612197
The modified gen p mean: 0.44663646817207336, gen p mean: -0.23293964564800262, mean p set: 0.44716405868530273The modified gen p mean: 0.4475644826889038, gen p mean: -0.22933074831962585, mean p set: 0.44813862442970276
loss_pred:0.013958865776658058, decouple_loss:0.0016619429225102067
loss_pred:0.013687762431800365, decouple_loss:0.0015902778832241893
Iteration: 5397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478951394557953, gen p mean: -0.23272301256656647, mean p set: 0.44846752285957336
loss_pred:0.013264862820506096, decouple_loss:0.0016993299359455705
The modified gen p mean: 0.44769808650016785, gen p mean: -0.22825810313224792, mean p set: 0.44827526807785034
loss_pred:0.013885238207876682, decouple_loss:0.0017042065737769008
The modified gen p mean: 0.44810760021209717, gen p mean: -0.23004645109176636, mean p set: 0.4486396908760071
loss_pred:0.013733422383666039, decouple_loss:0.001717427046969533
Iteration: 5398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468068778514862, gen p mean: -0.2269820123910904, mean p set: 0.44738268852233887
loss_pred:0.014084933325648308, decouple_loss:0.0014662957983091474
The modified gen p mean: 0.4468842148780823, gen p mean: -0.22997871041297913, mean p set: 0.4474572539329529
loss_pred:0.013507738709449768, decouple_loss:0.0015228907577693462
The modified gen p mean: 0.44746148586273193, gen p mean: -0.2354045957326889, mean p set: 0.4479939937591553
loss_pred:0.013520652428269386, decouple_loss:0.0016282910946756601
Iteration: 5399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825759530067444, gen p mean: -0.2341011017560959, mean p set: 0.4488346576690674
loss_pred:0.013519481755793095, decouple_loss:0.0016011189436540008
The modified gen p mean: 0.44968339800834656, gen p mean: -0.23514403402805328, mean p set: 0.45025789737701416
loss_pred:0.013056290335953236, decouple_loss:0.0016884003998711705
The modified gen p mean: 0.448962539434433, gen p mean: -0.23449300229549408, mean p set: 0.449484258890152
loss_pred:0.013426381163299084, decouple_loss:0.0015562623739242554
Iteration: 5400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837990403175354, gen p mean: -0.23477186262607574, mean p set: 0.44895458221435547
loss_pred:0.013043812476098537, decouple_loss:0.0014801837969571352
The modified gen p mean: 0.4472218155860901, gen p mean: -0.23479491472244263, mean p set: 0.447747141122818The modified gen p mean: 0.44787925481796265, gen p mean: -0.23696358501911163, mean p set: 0.4484524726867676
loss_pred:0.013678069226443768, decouple_loss:0.0015814980724826455
loss_pred:0.013716748915612698, decouple_loss:0.0014939417596906424
2023-04-28 04:29:45 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23357106745243073, mean p set: 0.4499112665653229
loss_pred:0.015235031954944134, decouple_loss:0.00198289449326694
The modified gen p mean: 0.4482746422290802, gen p mean: -0.23066624999046326, mean p set: 0.44879910349845886
The modified gen p mean: 0.4493018388748169, gen p mean: -0.23326173424720764, mean p set: 0.4498290419578552
loss_pred:0.015216558240354061, decouple_loss:0.0018105608178302646loss_pred:0.014812777750194073, decouple_loss:0.0019388358341529965
WV_1_PC_1_EH_0_PS_30, loss: 0.015183661133050919, avg_mse: 0.022479159757494926
current test mse: 0.022479
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 5401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501475989818573, gen p mean: -0.22973936796188354, mean p set: 0.45067691802978516
loss_pred:0.01504386868327856, decouple_loss:0.0019333354430273175
The modified gen p mean: 0.4498336613178253, gen p mean: -0.22927610576152802, mean p set: 0.4504148066043854
loss_pred:0.015219011344015598, decouple_loss:0.001873633242212236
The modified gen p mean: 0.448514461517334, gen p mean: -0.23034502565860748, mean p set: 0.4490925073623657
loss_pred:0.01526198536157608, decouple_loss:0.001772927469573915
Iteration: 5402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497285485267639, gen p mean: -0.22769632935523987, mean p set: 0.4502556622028351
loss_pred:0.01488177664577961, decouple_loss:0.0017836099723353982
The modified gen p mean: 0.44949856400489807, gen p mean: -0.22780156135559082, mean p set: 0.45006564259529114
loss_pred:0.01483146008104086, decouple_loss:0.0020260780584067106
The modified gen p mean: 0.4492577910423279, gen p mean: -0.23015524446964264, mean p set: 0.4498307406902313
loss_pred:0.014515060931444168, decouple_loss:0.0017787710530683398
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507378041744232, gen p mean: -0.2306620180606842, mean p set: 0.45127072930336
loss_pred:0.014751633629202843, decouple_loss:0.0016079021152108908
The modified gen p mean: 0.44980400800704956, gen p mean: -0.22831255197525024, mean p set: 0.45038241147994995
loss_pred:0.014526368118822575, decouple_loss:0.0016874292632564902
The modified gen p mean: 0.4493449032306671, gen p mean: -0.22540979087352753, mean p set: 0.4499199688434601
loss_pred:0.014590087346732616, decouple_loss:0.0017299066530540586
Iteration: 5404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500899314880371, gen p mean: -0.22937558591365814, mean p set: 0.4506154954433441
loss_pred:0.014901799149811268, decouple_loss:0.001919749192893505
The modified gen p mean: 0.44901129603385925, gen p mean: -0.22465161979198456, mean p set: 0.4495888352394104The modified gen p mean: 0.45004987716674805, gen p mean: -0.22834189236164093, mean p set: 0.45062586665153503
loss_pred:0.014707440510392189, decouple_loss:0.001741772866807878
loss_pred:0.014925667084753513, decouple_loss:0.0017530495533719659
Iteration: 5405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502870738506317, gen p mean: -0.22716966271400452, mean p set: 0.4508611261844635
loss_pred:0.014958437532186508, decouple_loss:0.001969678793102503
The modified gen p mean: 0.4505910575389862, gen p mean: -0.22868601977825165, mean p set: 0.45116761326789856The modified gen p mean: 0.4507327973842621, gen p mean: -0.23107734322547913, mean p set: 0.4512575566768646
loss_pred:0.015038940124213696, decouple_loss:0.0019125450635328889
loss_pred:0.014972089789807796, decouple_loss:0.0017836762126535177
Iteration: 5406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937649369239807, gen p mean: -0.231110081076622, mean p set: 0.44995349645614624
loss_pred:0.014563544653356075, decouple_loss:0.0015235214959830046
The modified gen p mean: 0.4485924243927002, gen p mean: -0.23216955363750458, mean p set: 0.4491656422615051The modified gen p mean: 0.448917955160141, gen p mean: -0.234227254986763, mean p set: 0.44944941997528076
loss_pred:0.014610996469855309, decouple_loss:0.0015673252055421472
loss_pred:0.014753182418644428, decouple_loss:0.0017122001154348254
Iteration: 5407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049959421157837, gen p mean: -0.2301756590604782, mean p set: 0.4510757029056549
loss_pred:0.014954439364373684, decouple_loss:0.0018589546671137214
The modified gen p mean: 0.44957152009010315, gen p mean: -0.23061928153038025, mean p set: 0.45014673471450806
loss_pred:0.01443959679454565, decouple_loss:0.0017202893504872918
The modified gen p mean: 0.44868203997612, gen p mean: -0.233346626162529, mean p set: 0.4492048919200897
loss_pred:0.014384175650775433, decouple_loss:0.0018236134201288223
Iteration: 5408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493129551410675, gen p mean: -0.23272129893302917, mean p set: 0.44988662004470825
loss_pred:0.014479382894933224, decouple_loss:0.001608789199963212
The modified gen p mean: 0.44946378469467163, gen p mean: -0.23047298192977905, mean p set: 0.4500381648540497
loss_pred:0.014255733229219913, decouple_loss:0.0016271915519610047
The modified gen p mean: 0.4498194754123688, gen p mean: -0.23244747519493103, mean p set: 0.4503425657749176
loss_pred:0.014262739568948746, decouple_loss:0.0016416767612099648
Iteration: 5409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500570595264435, gen p mean: -0.22576268017292023, mean p set: 0.4506319463253021
loss_pred:0.014501203782856464, decouple_loss:0.0018367605516687036
The modified gen p mean: 0.449129194021225, gen p mean: -0.22763316333293915, mean p set: 0.4496990144252777
loss_pred:0.015273603610694408, decouple_loss:0.0020482237450778484
The modified gen p mean: 0.4486638307571411, gen p mean: -0.22764793038368225, mean p set: 0.4491916298866272
loss_pred:0.014713874086737633, decouple_loss:0.0017183057498186827
Iteration: 5410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491592049598694, gen p mean: -0.2330653965473175, mean p set: 0.44973650574684143
loss_pred:0.014409818686544895, decouple_loss:0.0020413801539689302
The modified gen p mean: 0.4495640993118286, gen p mean: -0.23557160794734955, mean p set: 0.4501415491104126
loss_pred:0.014445190317928791, decouple_loss:0.0018355684587731957
The modified gen p mean: 0.4501207768917084, gen p mean: -0.2307015061378479, mean p set: 0.4506498873233795
loss_pred:0.014903724193572998, decouple_loss:0.0017925271531566978
2023-04-28 04:34:02 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23716895282268524, mean p set: 0.4499112665653229
loss_pred:0.014765825122594833, decouple_loss:0.0020062399562448263
The modified gen p mean: 0.44826728105545044, gen p mean: -0.23430971801280975, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930535554885864, gen p mean: -0.2369956076145172, mean p set: 0.4498290419578552
loss_pred:0.014662309549748898, decouple_loss:0.0017898449441418052
loss_pred:0.014187628403306007, decouple_loss:0.0017871358431875706
WV_1_PC_1_EH_0_PS_30, loss: 0.014631642028689384, avg_mse: 0.021483061835169792
current test mse: 0.021483
Iteration: 5411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492635726928711, gen p mean: -0.23490329086780548, mean p set: 0.4498342275619507
loss_pred:0.014426290057599545, decouple_loss:0.0015561542240902781
The modified gen p mean: 0.4491478502750397, gen p mean: -0.23495978116989136, mean p set: 0.44972866773605347
loss_pred:0.014987253583967686, decouple_loss:0.0015827055322006345
The modified gen p mean: 0.4488540291786194, gen p mean: -0.23463790118694305, mean p set: 0.4493815302848816
loss_pred:0.01489025168120861, decouple_loss:0.0016569484723731875
Iteration: 5412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021340250968933, gen p mean: -0.2400042712688446, mean p set: 0.45073747634887695
loss_pred:0.015161962248384953, decouple_loss:0.0019986003171652555
The modified gen p mean: 0.4490443468093872, gen p mean: -0.23979420959949493, mean p set: 0.4496159553527832
loss_pred:0.014630861580371857, decouple_loss:0.00174911436624825
The modified gen p mean: 0.44960084557533264, gen p mean: -0.23818232119083405, mean p set: 0.45017993450164795
loss_pred:0.014453624375164509, decouple_loss:0.0018527285428717732
Iteration: 5413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492747187614441, gen p mean: -0.23996847867965698, mean p set: 0.4498046338558197
loss_pred:0.015008106827735901, decouple_loss:0.0016371257370337844
The modified gen p mean: 0.45053356885910034, gen p mean: -0.23633107542991638, mean p set: 0.451102077960968
loss_pred:0.014088722877204418, decouple_loss:0.0018996504368260503
The modified gen p mean: 0.4503501057624817, gen p mean: -0.23441478610038757, mean p set: 0.45092761516571045
loss_pred:0.014656858518719673, decouple_loss:0.0019496000604704022
Iteration: 5414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496157765388489, gen p mean: -0.23541037738323212, mean p set: 0.450135201215744
loss_pred:0.013979502022266388, decouple_loss:0.0020192067604511976
The modified gen p mean: 0.4481185972690582, gen p mean: -0.23419633507728577, mean p set: 0.4486955404281616
loss_pred:0.014827622100710869, decouple_loss:0.0019412590190768242
The modified gen p mean: 0.4486195743083954, gen p mean: -0.2400905042886734, mean p set: 0.4491928219795227
loss_pred:0.014352526515722275, decouple_loss:0.0019304815214127302
Iteration: 5415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037513971328735, gen p mean: -0.2365274727344513, mean p set: 0.4509483277797699
loss_pred:0.015202386304736137, decouple_loss:0.002198663307353854
The modified gen p mean: 0.4507322311401367, gen p mean: -0.23692025244235992, mean p set: 0.4513084292411804The modified gen p mean: 0.4493517279624939, gen p mean: -0.23360149562358856, mean p set: 0.44988352060317993
loss_pred:0.014584165066480637, decouple_loss:0.0019893290009349585
loss_pred:0.013997575268149376, decouple_loss:0.002328106202185154
Iteration: 5416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024070143699646, gen p mean: -0.2360113561153412, mean p set: 0.4508230984210968
loss_pred:0.01446076761931181, decouple_loss:0.0018564437050372362
The modified gen p mean: 0.44928619265556335, gen p mean: -0.23717467486858368, mean p set: 0.4498143792152405The modified gen p mean: 0.45001131296157837, gen p mean: -0.24081933498382568, mean p set: 0.450583815574646
loss_pred:0.014922591857612133, decouple_loss:0.001991698984056711
loss_pred:0.014568009413778782, decouple_loss:0.001773865893483162
Iteration: 5417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492502510547638, gen p mean: -0.23452891409397125, mean p set: 0.4498307704925537
loss_pred:0.014687527902424335, decouple_loss:0.0021812189370393753
The modified gen p mean: 0.449983686208725, gen p mean: -0.24095842242240906, mean p set: 0.45056453347206116
loss_pred:0.015116889961063862, decouple_loss:0.001981616485863924
The modified gen p mean: 0.45047733187675476, gen p mean: -0.24292409420013428, mean p set: 0.4510018229484558
loss_pred:0.015454430133104324, decouple_loss:0.0019220480462536216
Iteration: 5418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450142502784729, gen p mean: -0.24319057166576385, mean p set: 0.4507182538509369
loss_pred:0.01409637089818716, decouple_loss:0.001880578463897109
The modified gen p mean: 0.4506309926509857, gen p mean: -0.24124746024608612, mean p set: 0.4511975646018982
loss_pred:0.014011740684509277, decouple_loss:0.001837435644119978
The modified gen p mean: 0.4496755003929138, gen p mean: -0.24367287755012512, mean p set: 0.4502067267894745
loss_pred:0.01413242518901825, decouple_loss:0.0018501457525417209
Iteration: 5419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802725315093994, gen p mean: -0.24269111454486847, mean p set: 0.448609322309494
loss_pred:0.01476849801838398, decouple_loss:0.001563949161209166
The modified gen p mean: 0.4489494860172272, gen p mean: -0.243752121925354, mean p set: 0.44952836632728577
loss_pred:0.01435123197734356, decouple_loss:0.0016571293817833066
The modified gen p mean: 0.4511849880218506, gen p mean: -0.24319876730442047, mean p set: 0.4517151713371277
loss_pred:0.01455232035368681, decouple_loss:0.0018268442945554852
Iteration: 5420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497942328453064, gen p mean: -0.23999764025211334, mean p set: 0.45036831498146057
loss_pred:0.014283774420619011, decouple_loss:0.001955510815605521
The modified gen p mean: 0.4501834809780121, gen p mean: -0.23795956373214722, mean p set: 0.4507621228694916
loss_pred:0.015006567351520061, decouple_loss:0.001936093089170754
The modified gen p mean: 0.45005789399147034, gen p mean: -0.24428924918174744, mean p set: 0.45058757066726685
loss_pred:0.015014628879725933, decouple_loss:0.00177195412106812
2023-04-28 04:37:26 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23676766455173492, mean p set: 0.4499112665653229
loss_pred:0.014398964121937752, decouple_loss:0.0015418766997754574
The modified gen p mean: 0.44826531410217285, gen p mean: -0.23393356800079346, mean p set: 0.44879910349845886
The modified gen p mean: 0.449294775724411, gen p mean: -0.2365213930606842, mean p set: 0.4498290419578552
loss_pred:0.0142598208039999, decouple_loss:0.001688329386524856
loss_pred:0.013995046727359295, decouple_loss:0.001597490394487977
WV_1_PC_1_EH_0_PS_30, loss: 0.01429840549826622, avg_mse: 0.020785965025424957
current test mse: 0.020786
At step 5420, Best test: 0.020786
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_30/model_model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 5421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855424761772156, gen p mean: -0.23768191039562225, mean p set: 0.44908660650253296
loss_pred:0.014330619014799595, decouple_loss:0.002303133253008127
The modified gen p mean: 0.44746431708335876, gen p mean: -0.23221711814403534, mean p set: 0.4480399191379547
loss_pred:0.013899968937039375, decouple_loss:0.002277990337461233
The modified gen p mean: 0.4474266767501831, gen p mean: -0.23741944134235382, mean p set: 0.4480014741420746
loss_pred:0.014343970455229282, decouple_loss:0.0018984470516443253
Iteration: 5422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476541578769684, gen p mean: -0.24261607229709625, mean p set: 0.448184072971344
loss_pred:0.014344247058033943, decouple_loss:0.0018216234166175127
The modified gen p mean: 0.4483659267425537, gen p mean: -0.23469990491867065, mean p set: 0.4489421248435974
loss_pred:0.014028098434209824, decouple_loss:0.0019679535180330276
The modified gen p mean: 0.44832202792167664, gen p mean: -0.23581555485725403, mean p set: 0.44889581203460693
loss_pred:0.014639009721577168, decouple_loss:0.0018196847522631288
Iteration: 5423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737112522125244, gen p mean: -0.23788605630397797, mean p set: 0.4478928744792938
loss_pred:0.013764474540948868, decouple_loss:0.0017686510691419244
The modified gen p mean: 0.4476545751094818, gen p mean: -0.24306990206241608, mean p set: 0.4482314884662628
loss_pred:0.01409180648624897, decouple_loss:0.0017842322122305632
The modified gen p mean: 0.4486349821090698, gen p mean: -0.2314612716436386, mean p set: 0.4492167532444
loss_pred:0.014734504744410515, decouple_loss:0.002025415888056159
Iteration: 5424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470542371273041, gen p mean: -0.23418623208999634, mean p set: 0.4475817382335663
loss_pred:0.014290794730186462, decouple_loss:0.0019203306874260306
The modified gen p mean: 0.44706836342811584, gen p mean: -0.23622684180736542, mean p set: 0.44764459133148193
loss_pred:0.013870781287550926, decouple_loss:0.0018787261797115207
The modified gen p mean: 0.44927695393562317, gen p mean: -0.22943530976772308, mean p set: 0.44985130429267883
loss_pred:0.014102359302341938, decouple_loss:0.0018247097032144666
Iteration: 5425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896984100341797, gen p mean: -0.2349863201379776, mean p set: 0.4495036005973816
loss_pred:0.014645703136920929, decouple_loss:0.0018706388073042035
The modified gen p mean: 0.4471961259841919, gen p mean: -0.2414580136537552, mean p set: 0.44777119159698486
loss_pred:0.01421872153878212, decouple_loss:0.0017550989286974072
The modified gen p mean: 0.4484628736972809, gen p mean: -0.23904167115688324, mean p set: 0.4490351974964142
loss_pred:0.013916261494159698, decouple_loss:0.001730342279188335
Iteration: 5426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788941740989685, gen p mean: -0.24358710646629333, mean p set: 0.448468953371048
loss_pred:0.014349052682518959, decouple_loss:0.0017741848714649677
The modified gen p mean: 0.4479140043258667, gen p mean: -0.24698682129383087, mean p set: 0.44844329357147217The modified gen p mean: 0.4478894770145416, gen p mean: -0.2353288233280182, mean p set: 0.44847002625465393
loss_pred:0.014417140744626522, decouple_loss:0.0017930262256413698
loss_pred:0.014358282089233398, decouple_loss:0.0019954515155404806
Iteration: 5427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488586187362671, gen p mean: -0.23762032389640808, mean p set: 0.4494354724884033
loss_pred:0.014176171272993088, decouple_loss:0.0017477732617408037
The modified gen p mean: 0.44909897446632385, gen p mean: -0.23131272196769714, mean p set: 0.44967639446258545
loss_pred:0.01384105533361435, decouple_loss:0.001906711608171463
The modified gen p mean: 0.44823184609413147, gen p mean: -0.2375536859035492, mean p set: 0.4487598240375519
loss_pred:0.014256027527153492, decouple_loss:0.0017872578464448452
Iteration: 5428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625985622406006, gen p mean: -0.23736384510993958, mean p set: 0.4468391239643097
loss_pred:0.014286566525697708, decouple_loss:0.0019487002864480019
The modified gen p mean: 0.44714638590812683, gen p mean: -0.24381916224956512, mean p set: 0.4477252662181854
loss_pred:0.014800176955759525, decouple_loss:0.0017856067279353738
The modified gen p mean: 0.4479794204235077, gen p mean: -0.2397306263446808, mean p set: 0.44850867986679077
loss_pred:0.01396084949374199, decouple_loss:0.0017092592315748334
Iteration: 5429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44557321071624756, gen p mean: -0.2469869703054428, mean p set: 0.4461473524570465
loss_pred:0.014552798122167587, decouple_loss:0.0020956641528755426
The modified gen p mean: 0.4480876624584198, gen p mean: -0.24582502245903015, mean p set: 0.4486646354198456
loss_pred:0.01392336655408144, decouple_loss:0.0018287450075149536
The modified gen p mean: 0.4481733739376068, gen p mean: -0.2473105937242508, mean p set: 0.44869908690452576
loss_pred:0.013746908865869045, decouple_loss:0.0018486303742974997
Iteration: 5430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621220231056213, gen p mean: -0.24444378912448883, mean p set: 0.4467865526676178
loss_pred:0.01442350260913372, decouple_loss:0.0017469074809923768
The modified gen p mean: 0.44788500666618347, gen p mean: -0.24226251244544983, mean p set: 0.44841864705085754The modified gen p mean: 0.44769513607025146, gen p mean: -0.2445373684167862, mean p set: 0.44826918840408325
loss_pred:0.014151030220091343, decouple_loss:0.0017580646090209484
loss_pred:0.013949853368103504, decouple_loss:0.0017318923491984606
2023-04-28 04:41:47 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24199578166007996, mean p set: 0.4499112665653229
loss_pred:0.014812334440648556, decouple_loss:0.0019608107395470142
The modified gen p mean: 0.4482751786708832, gen p mean: -0.23887842893600464, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930848479270935, gen p mean: -0.24181614816188812, mean p set: 0.4498290419578552
loss_pred:0.01455700397491455, decouple_loss:0.001993827521800995
loss_pred:0.014394287951290607, decouple_loss:0.0018667562399059534
WV_1_PC_1_EH_0_PS_30, loss: 0.01468489971011877, avg_mse: 0.021399734541773796
current test mse: 0.0214
Iteration: 5431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473610520362854, gen p mean: -0.24075330793857574, mean p set: 0.4479406476020813
loss_pred:0.014044337905943394, decouple_loss:0.001706617884337902
The modified gen p mean: 0.4468507170677185, gen p mean: -0.24193435907363892, mean p set: 0.4473777115345001
loss_pred:0.014557960443198681, decouple_loss:0.001735306461341679
The modified gen p mean: 0.44886845350265503, gen p mean: -0.23244783282279968, mean p set: 0.44944167137145996
loss_pred:0.014142906293272972, decouple_loss:0.001744796521961689
Iteration: 5432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479880928993225, gen p mean: -0.2404734194278717, mean p set: 0.4485113322734833
loss_pred:0.013800480403006077, decouple_loss:0.001626175595447421
The modified gen p mean: 0.44708970189094543, gen p mean: -0.23834529519081116, mean p set: 0.4476655125617981
loss_pred:0.013299157842993736, decouple_loss:0.0015415932284668088
The modified gen p mean: 0.4482681155204773, gen p mean: -0.24211245775222778, mean p set: 0.4488369822502136
loss_pred:0.014135362580418587, decouple_loss:0.0016591082094237208
Iteration: 5433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727468490600586, gen p mean: -0.23403145372867584, mean p set: 0.44780370593070984
loss_pred:0.014558020979166031, decouple_loss:0.001655923668295145
The modified gen p mean: 0.44834378361701965, gen p mean: -0.23960015177726746, mean p set: 0.448919415473938
loss_pred:0.014274961315095425, decouple_loss:0.0015624294755980372
The modified gen p mean: 0.44736969470977783, gen p mean: -0.24151591956615448, mean p set: 0.4479483664035797
loss_pred:0.013786213472485542, decouple_loss:0.001597371301613748
Iteration: 5434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471047818660736, gen p mean: -0.2378827929496765, mean p set: 0.4476326107978821
loss_pred:0.013820375315845013, decouple_loss:0.0017991033382713795
The modified gen p mean: 0.4481644928455353, gen p mean: -0.23288217186927795, mean p set: 0.4487389624118805
loss_pred:0.014447962865233421, decouple_loss:0.0019645546562969685
The modified gen p mean: 0.44706088304519653, gen p mean: -0.2333788424730301, mean p set: 0.44764280319213867
loss_pred:0.014338497072458267, decouple_loss:0.0017006153939291835
Iteration: 5435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476946294307709, gen p mean: -0.2413795292377472, mean p set: 0.44827160239219666
loss_pred:0.014883079566061497, decouple_loss:0.0016326847253367305
The modified gen p mean: 0.4463169276714325, gen p mean: -0.23939016461372375, mean p set: 0.44689464569091797
loss_pred:0.014352132566273212, decouple_loss:0.0017765953671187162
The modified gen p mean: 0.4475977420806885, gen p mean: -0.24507923424243927, mean p set: 0.44812238216400146
loss_pred:0.014320596121251583, decouple_loss:0.0016389371594414115
Iteration: 5436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44586679339408875, gen p mean: -0.24217607080936432, mean p set: 0.4464397132396698
loss_pred:0.014533162117004395, decouple_loss:0.0017465697601437569
The modified gen p mean: 0.44751203060150146, gen p mean: -0.24041828513145447, mean p set: 0.4480428397655487The modified gen p mean: 0.4458819329738617, gen p mean: -0.2406674176454544, mean p set: 0.44645223021507263
loss_pred:0.014272734522819519, decouple_loss:0.0019498377805575728
loss_pred:0.013396533206105232, decouple_loss:0.0017544189468026161
Iteration: 5437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481131136417389, gen p mean: -0.23891086876392365, mean p set: 0.4486868679523468
loss_pred:0.013874064199626446, decouple_loss:0.001824050908908248
The modified gen p mean: 0.4480935335159302, gen p mean: -0.23917318880558014, mean p set: 0.4486686885356903
loss_pred:0.014492702670395374, decouple_loss:0.0018428153125569224
The modified gen p mean: 0.4474228620529175, gen p mean: -0.24116449058055878, mean p set: 0.44794782996177673
loss_pred:0.014495158568024635, decouple_loss:0.0018507790518924594
Iteration: 5438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484834372997284, gen p mean: -0.23722442984580994, mean p set: 0.4490565061569214
loss_pred:0.013793683610856533, decouple_loss:0.0017470518359914422
The modified gen p mean: 0.4489443898200989, gen p mean: -0.23656195402145386, mean p set: 0.44951605796813965
loss_pred:0.013843856751918793, decouple_loss:0.0017546811141073704
The modified gen p mean: 0.4453098773956299, gen p mean: -0.2409164011478424, mean p set: 0.44584187865257263
loss_pred:0.014523116871714592, decouple_loss:0.0017495641950517893
Iteration: 5439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710439443588257, gen p mean: -0.24319323897361755, mean p set: 0.44767823815345764
loss_pred:0.01390886027365923, decouple_loss:0.0018313457258045673
The modified gen p mean: 0.4484192132949829, gen p mean: -0.23902033269405365, mean p set: 0.4489506781101227The modified gen p mean: 0.4482918083667755, gen p mean: -0.23173990845680237, mean p set: 0.4488692581653595
loss_pred:0.013986957259476185, decouple_loss:0.0018373349448665977
loss_pred:0.014242919161915779, decouple_loss:0.001577480579726398
Iteration: 5440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44587644934654236, gen p mean: -0.23928861320018768, mean p set: 0.44645413756370544
loss_pred:0.013835061341524124, decouple_loss:0.001661305082961917
The modified gen p mean: 0.4487766623497009, gen p mean: -0.229829341173172, mean p set: 0.44930681586265564The modified gen p mean: 0.44752225279808044, gen p mean: -0.24023237824440002, mean p set: 0.4481014013290405
loss_pred:0.014409760013222694, decouple_loss:0.001784635940566659
loss_pred:0.014424189925193787, decouple_loss:0.0016537870978936553
2023-04-28 04:45:11 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23757603764533997, mean p set: 0.4499112665653229
loss_pred:0.014870437793433666, decouple_loss:0.0017972633941099048
The modified gen p mean: 0.44826942682266235, gen p mean: -0.23470178246498108, mean p set: 0.44879910349845886
The modified gen p mean: 0.44929632544517517, gen p mean: -0.23739372193813324, mean p set: 0.4498290419578552
loss_pred:0.014635704457759857, decouple_loss:0.0018664556555449963
loss_pred:0.014391805045306683, decouple_loss:0.001796942437067628
WV_1_PC_1_EH_0_PS_30, loss: 0.014723660424351692, avg_mse: 0.021488003432750702
current test mse: 0.021488
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 5441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486788511276245, gen p mean: -0.23868797719478607, mean p set: 0.44920656085014343
loss_pred:0.013858985155820847, decouple_loss:0.0017448109574615955
The modified gen p mean: 0.44966116547584534, gen p mean: -0.23184219002723694, mean p set: 0.4502353370189667
loss_pred:0.013167799450457096, decouple_loss:0.001700833672657609
The modified gen p mean: 0.44785910844802856, gen p mean: -0.23825013637542725, mean p set: 0.44843384623527527
loss_pred:0.01381935179233551, decouple_loss:0.0016828904626891017
Iteration: 5442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493069648742676, gen p mean: -0.23712019622325897, mean p set: 0.4498351216316223
loss_pred:0.013414911925792694, decouple_loss:0.0018063363386318088
The modified gen p mean: 0.44890883564949036, gen p mean: -0.24305957555770874, mean p set: 0.4494871497154236
loss_pred:0.01222638227045536, decouple_loss:0.0021295417100191116
The modified gen p mean: 0.44829776883125305, gen p mean: -0.2354983240365982, mean p set: 0.44887375831604004
loss_pred:0.014266900718212128, decouple_loss:0.0015675144968554378
Iteration: 5443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835829734802246, gen p mean: -0.23923733830451965, mean p set: 0.4488815367221832
loss_pred:0.014443066902458668, decouple_loss:0.0016142420936375856
The modified gen p mean: 0.4496540129184723, gen p mean: -0.24100632965564728, mean p set: 0.45023879408836365
loss_pred:0.013860548846423626, decouple_loss:0.001597004127688706
The modified gen p mean: 0.446601003408432, gen p mean: -0.2460974156856537, mean p set: 0.447174608707428
loss_pred:0.0141487717628479, decouple_loss:0.0016696490347385406
Iteration: 5444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476151764392853, gen p mean: -0.24729833006858826, mean p set: 0.4481402039527893
loss_pred:0.013602355495095253, decouple_loss:0.0015835536178201437
The modified gen p mean: 0.4484650194644928, gen p mean: -0.24879178404808044, mean p set: 0.44904303550720215
loss_pred:0.01409037783741951, decouple_loss:0.0015525477938354015
The modified gen p mean: 0.4472930431365967, gen p mean: -0.24262911081314087, mean p set: 0.44786569476127625
loss_pred:0.013296229764819145, decouple_loss:0.0016914578154683113
Iteration: 5445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482773244380951, gen p mean: -0.24959874153137207, mean p set: 0.44885799288749695
loss_pred:0.013295641168951988, decouple_loss:0.001567032653838396
The modified gen p mean: 0.4472213387489319, gen p mean: -0.25213882327079773, mean p set: 0.4477499723434448The modified gen p mean: 0.448602557182312, gen p mean: -0.24653194844722748, mean p set: 0.449176549911499
loss_pred:0.013560270890593529, decouple_loss:0.0018804246792569757
loss_pred:0.013404999859631062, decouple_loss:0.0016486418899148703
Iteration: 5446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731712341308594, gen p mean: -0.24786995351314545, mean p set: 0.4478965699672699
loss_pred:0.013705294579267502, decouple_loss:0.0016446925001218915
The modified gen p mean: 0.4486545920372009, gen p mean: -0.24947607517242432, mean p set: 0.44923779368400574The modified gen p mean: 0.45162203907966614, gen p mean: -0.24729003012180328, mean p set: 0.4521370232105255
loss_pred:0.013694394379854202, decouple_loss:0.0015915584517642856
loss_pred:0.013360470533370972, decouple_loss:0.0018429147312417626
Iteration: 5447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809389114379883, gen p mean: -0.2422112077474594, mean p set: 0.44867458939552307
loss_pred:0.014046854339540005, decouple_loss:0.0017799170454964042
The modified gen p mean: 0.447982519865036, gen p mean: -0.24032330513000488, mean p set: 0.4485572874546051
loss_pred:0.013658015988767147, decouple_loss:0.001790332025848329
The modified gen p mean: 0.44765445590019226, gen p mean: -0.23869600892066956, mean p set: 0.4481779932975769
loss_pred:0.014169115573167801, decouple_loss:0.0018115084385499358
Iteration: 5448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488547146320343, gen p mean: -0.24401012063026428, mean p set: 0.4494233727455139
loss_pred:0.013678379356861115, decouple_loss:0.0017703947378322482
The modified gen p mean: 0.448531836271286, gen p mean: -0.24169772863388062, mean p set: 0.44910773634910583
loss_pred:0.012840976007282734, decouple_loss:0.0018004048615694046
The modified gen p mean: 0.4478083550930023, gen p mean: -0.23937609791755676, mean p set: 0.44833314418792725
loss_pred:0.014140084385871887, decouple_loss:0.0017166387988254428
Iteration: 5449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740089774131775, gen p mean: -0.24175763130187988, mean p set: 0.4479774832725525
loss_pred:0.013207712210714817, decouple_loss:0.0017911257455125451
The modified gen p mean: 0.4466974139213562, gen p mean: -0.2431168556213379, mean p set: 0.4472704529762268
loss_pred:0.01350940577685833, decouple_loss:0.0018812317866832018
The modified gen p mean: 0.44884467124938965, gen p mean: -0.2455892413854599, mean p set: 0.4493709206581116
loss_pred:0.013658757321536541, decouple_loss:0.0017313852440565825
Iteration: 5450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906169176101685, gen p mean: -0.24587060511112213, mean p set: 0.4496400058269501
loss_pred:0.013144353404641151, decouple_loss:0.0018793951021507382
The modified gen p mean: 0.4485357701778412, gen p mean: -0.24391883611679077, mean p set: 0.44910797476768494
loss_pred:0.012967202812433243, decouple_loss:0.0019020535983145237
The modified gen p mean: 0.44903814792633057, gen p mean: -0.24185650050640106, mean p set: 0.4495624303817749
loss_pred:0.013123242184519768, decouple_loss:0.0019194551277905703
2023-04-28 04:49:25 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2427762895822525, mean p set: 0.4499112665653229
loss_pred:0.01490978803485632, decouple_loss:0.002061801962554455
The modified gen p mean: 0.448270708322525, gen p mean: -0.24004119634628296, mean p set: 0.44879910349845886
loss_pred:0.01467851921916008, decouple_loss:0.0020862948149442673
The modified gen p mean: 0.4492985010147095, gen p mean: -0.24250133335590363, mean p set: 0.4498290419578552
loss_pred:0.014416852034628391, decouple_loss:0.0020491869654506445
WV_1_PC_1_EH_0_PS_30, loss: 0.014771675691008568, avg_mse: 0.02160966768860817
current test mse: 0.02161
Iteration: 5451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482634961605072, gen p mean: -0.24419471621513367, mean p set: 0.44884639978408813
loss_pred:0.0134191969409585, decouple_loss:0.0017110916087403893
The modified gen p mean: 0.448753297328949, gen p mean: -0.23706384003162384, mean p set: 0.4492860734462738
loss_pred:0.013416852802038193, decouple_loss:0.0019258585525676608
The modified gen p mean: 0.44897377490997314, gen p mean: -0.23729097843170166, mean p set: 0.449554443359375
loss_pred:0.013288580812513828, decouple_loss:0.0018821732373908162
Iteration: 5452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706636667251587, gen p mean: -0.24598297476768494, mean p set: 0.4475933015346527
loss_pred:0.013830608688294888, decouple_loss:0.002335770521312952
The modified gen p mean: 0.4487488269805908, gen p mean: -0.24518519639968872, mean p set: 0.4493279755115509
loss_pred:0.01234930194914341, decouple_loss:0.0021981766913086176
The modified gen p mean: 0.4506587088108063, gen p mean: -0.23675400018692017, mean p set: 0.45123034715652466
loss_pred:0.01303844153881073, decouple_loss:0.0021608334500342607
Iteration: 5453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974485039711, gen p mean: -0.23740865290164948, mean p set: 0.4502794146537781
loss_pred:0.013476049527525902, decouple_loss:0.0020404651295393705
The modified gen p mean: 0.449628084897995, gen p mean: -0.2464294135570526, mean p set: 0.45020073652267456
loss_pred:0.012548749335110188, decouple_loss:0.0021719541400671005
The modified gen p mean: 0.4490220546722412, gen p mean: -0.2471453994512558, mean p set: 0.4496042728424072
loss_pred:0.012231286615133286, decouple_loss:0.0019190028542652726
Iteration: 5454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479313790798187, gen p mean: -0.2437380999326706, mean p set: 0.44846272468566895
loss_pred:0.01245292741805315, decouple_loss:0.0025315016973763704
The modified gen p mean: 0.4498550593852997, gen p mean: -0.23530204594135284, mean p set: 0.4504365622997284
loss_pred:0.0127872284501791, decouple_loss:0.0020821159705519676
The modified gen p mean: 0.4468229413032532, gen p mean: -0.2383735328912735, mean p set: 0.447394996881485
loss_pred:0.013207798823714256, decouple_loss:0.0022047082893550396
Iteration: 5455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884341955184937, gen p mean: -0.24772122502326965, mean p set: 0.4494149386882782
loss_pred:0.013526161201298237, decouple_loss:0.002128656255081296
The modified gen p mean: 0.4488588273525238, gen p mean: -0.24325382709503174, mean p set: 0.4493841528892517The modified gen p mean: 0.44733747839927673, gen p mean: -0.24125169217586517, mean p set: 0.4479128420352936
loss_pred:0.013250851072371006, decouple_loss:0.0021219493355602026
loss_pred:0.013286672532558441, decouple_loss:0.0020001092925667763
Iteration: 5456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480985701084137, gen p mean: -0.25484853982925415, mean p set: 0.44867387413978577
loss_pred:0.013612139038741589, decouple_loss:0.0015727273421362042
The modified gen p mean: 0.45014575123786926, gen p mean: -0.24450035393238068, mean p set: 0.45067334175109863The modified gen p mean: 0.4480220675468445, gen p mean: -0.25077974796295166, mean p set: 0.44859644770622253
loss_pred:0.013402534648776054, decouple_loss:0.001605370664037764
loss_pred:0.012931952252984047, decouple_loss:0.001845323946326971
Iteration: 5457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471784830093384, gen p mean: -0.24602723121643066, mean p set: 0.447748064994812
loss_pred:0.013187761418521404, decouple_loss:0.002069831360131502
The modified gen p mean: 0.4495115280151367, gen p mean: -0.25559717416763306, mean p set: 0.45009157061576843
loss_pred:0.012701036408543587, decouple_loss:0.0020098150707781315
The modified gen p mean: 0.4475092887878418, gen p mean: -0.2521775960922241, mean p set: 0.44803765416145325
loss_pred:0.013525567948818207, decouple_loss:0.0019072042778134346
Iteration: 5458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716429710388184, gen p mean: -0.2470206469297409, mean p set: 0.4477371871471405
loss_pred:0.013510266318917274, decouple_loss:0.0015093627152964473
The modified gen p mean: 0.44744986295700073, gen p mean: -0.24888765811920166, mean p set: 0.4480287730693817
loss_pred:0.014138970524072647, decouple_loss:0.001587594859302044
The modified gen p mean: 0.44837167859077454, gen p mean: -0.2533222436904907, mean p set: 0.44889771938323975
loss_pred:0.014311501756310463, decouple_loss:0.0015055780531838536
Iteration: 5459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756749272346497, gen p mean: -0.24963340163230896, mean p set: 0.44814345240592957
loss_pred:0.014138218946754932, decouple_loss:0.0018764907727017999
The modified gen p mean: 0.44780755043029785, gen p mean: -0.25258803367614746, mean p set: 0.4483363628387451
loss_pred:0.013731668703258038, decouple_loss:0.0019391889218240976
The modified gen p mean: 0.44733336567878723, gen p mean: -0.255359023809433, mean p set: 0.4479064643383026
loss_pred:0.01349492184817791, decouple_loss:0.002039314480498433
Iteration: 5460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472542405128479, gen p mean: -0.24310439825057983, mean p set: 0.44782793521881104
loss_pred:0.013841462321579456, decouple_loss:0.001505815889686346
The modified gen p mean: 0.44994181394577026, gen p mean: -0.2429298311471939, mean p set: 0.4505176842212677The modified gen p mean: 0.4481475055217743, gen p mean: -0.2514679729938507, mean p set: 0.44867774844169617
loss_pred:0.012754794210195541, decouple_loss:0.0017290993127971888
loss_pred:0.013738523237407207, decouple_loss:0.0015639838529750705
2023-04-28 04:52:49 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24615412950515747, mean p set: 0.4499112665653229
loss_pred:0.01488631684333086, decouple_loss:0.0017377677140757442
The modified gen p mean: 0.44827598333358765, gen p mean: -0.24368421733379364, mean p set: 0.44879910349845886The modified gen p mean: 0.4493009150028229, gen p mean: -0.24610018730163574, mean p set: 0.4498290419578552
loss_pred:0.014676231890916824, decouple_loss:0.001897345413453877loss_pred:0.014401019550859928, decouple_loss:0.001744131906889379
WV_1_PC_1_EH_0_PS_30, loss: 0.014744177460670471, avg_mse: 0.021603763103485107
current test mse: 0.021604
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 5461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479154944419861, gen p mean: -0.24976220726966858, mean p set: 0.44843557476997375
loss_pred:0.014341088943183422, decouple_loss:0.0016103301895782351
The modified gen p mean: 0.4483269453048706, gen p mean: -0.24858595430850983, mean p set: 0.4489077031612396
The modified gen p mean: 0.44802039861679077, gen p mean: -0.24650639295578003, mean p set: 0.4485950171947479
loss_pred:0.01362673845142126, decouple_loss:0.0016966275870800018
loss_pred:0.014749201945960522, decouple_loss:0.00169804273173213
Iteration: 5462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478250741958618, gen p mean: -0.24851207435131073, mean p set: 0.4483576714992523
loss_pred:0.014721248298883438, decouple_loss:0.0016756681725382805
The modified gen p mean: 0.4475169777870178, gen p mean: -0.2465393990278244, mean p set: 0.448095440864563
The modified gen p mean: 0.4482417404651642, gen p mean: -0.24194353818893433, mean p set: 0.4488089084625244
loss_pred:0.013939827680587769, decouple_loss:0.001548072905279696
loss_pred:0.014494886621832848, decouple_loss:0.0016961948713287711
Iteration: 5463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481460750102997, gen p mean: -0.24660857021808624, mean p set: 0.4486706554889679
loss_pred:0.013617629185318947, decouple_loss:0.0015616222517564893
The modified gen p mean: 0.4474099576473236, gen p mean: -0.2467002421617508, mean p set: 0.4479837417602539
The modified gen p mean: 0.44790682196617126, gen p mean: -0.2470390945672989, mean p set: 0.44847962260246277
loss_pred:0.01447212789207697, decouple_loss:0.001596934045664966
loss_pred:0.014671390876173973, decouple_loss:0.0015334421768784523
Iteration: 5464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786936044692993, gen p mean: -0.24509453773498535, mean p set: 0.44839832186698914
loss_pred:0.013727611862123013, decouple_loss:0.0017241250025108457
The modified gen p mean: 0.44770681858062744, gen p mean: -0.24664269387722015, mean p set: 0.44828253984451294
The modified gen p mean: 0.4473210573196411, gen p mean: -0.24258796870708466, mean p set: 0.44789719581604004
loss_pred:0.014171618968248367, decouple_loss:0.0017789130797609687
loss_pred:0.01390306930989027, decouple_loss:0.001764543354511261
Iteration: 5465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764217734336853, gen p mean: -0.25008663535118103, mean p set: 0.4482157230377197
loss_pred:0.014003551565110683, decouple_loss:0.0015415928792208433
The modified gen p mean: 0.4476841390132904, gen p mean: -0.24571052193641663, mean p set: 0.4482516348361969
loss_pred:0.014364883303642273, decouple_loss:0.00165689701680094
The modified gen p mean: 0.4479546844959259, gen p mean: -0.24161554872989655, mean p set: 0.4484822154045105
loss_pred:0.013948182575404644, decouple_loss:0.0015697033377364278
Iteration: 5466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770142436027527, gen p mean: -0.24196486175060272, mean p set: 0.44828298687934875
loss_pred:0.014326502569019794, decouple_loss:0.0016353748505935073
The modified gen p mean: 0.44739067554473877, gen p mean: -0.24030329287052155, mean p set: 0.44792643189430237The modified gen p mean: 0.4473190903663635, gen p mean: -0.24309244751930237, mean p set: 0.4478999972343445
loss_pred:0.014139466919004917, decouple_loss:0.0015042349696159363
loss_pred:0.01424406748265028, decouple_loss:0.0013971882872283459
Iteration: 5467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476921856403351, gen p mean: -0.24239549040794373, mean p set: 0.4482753276824951
loss_pred:0.014533507637679577, decouple_loss:0.0016124886460602283
The modified gen p mean: 0.44707533717155457, gen p mean: -0.24324238300323486, mean p set: 0.4476061165332794The modified gen p mean: 0.4474243223667145, gen p mean: -0.2405068576335907, mean p set: 0.44799885153770447
loss_pred:0.01365100871771574, decouple_loss:0.0018016041722148657
loss_pred:0.014099675230681896, decouple_loss:0.001766370958648622
Iteration: 5468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718432426452637, gen p mean: -0.2443998157978058, mean p set: 0.4477587640285492
loss_pred:0.014020309783518314, decouple_loss:0.0015669014537706971
The modified gen p mean: 0.44793376326560974, gen p mean: -0.2398967444896698, mean p set: 0.44846177101135254
The modified gen p mean: 0.44753527641296387, gen p mean: -0.2423008531332016, mean p set: 0.4481166899204254
loss_pred:0.014450368471443653, decouple_loss:0.0015838481485843658
loss_pred:0.013837159611284733, decouple_loss:0.0015848410548642278
Iteration: 5469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477900564670563, gen p mean: -0.24552106857299805, mean p set: 0.44836533069610596
loss_pred:0.014188000001013279, decouple_loss:0.0020417801570147276
The modified gen p mean: 0.4476715624332428, gen p mean: -0.24525517225265503, mean p set: 0.448201984167099The modified gen p mean: 0.4471057057380676, gen p mean: -0.2473377138376236, mean p set: 0.4476796090602875
loss_pred:0.01430344209074974, decouple_loss:0.001877631526440382
loss_pred:0.013588209636509418, decouple_loss:0.001547143911011517
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474026560783386, gen p mean: -0.24388988316059113, mean p set: 0.44797900319099426
loss_pred:0.014167455025017262, decouple_loss:0.0017088502645492554
The modified gen p mean: 0.4487561583518982, gen p mean: -0.24023716151714325, mean p set: 0.44928398728370667The modified gen p mean: 0.4474211633205414, gen p mean: -0.2437502145767212, mean p set: 0.4479960799217224
loss_pred:0.014197491109371185, decouple_loss:0.001689100987277925
loss_pred:0.014331381767988205, decouple_loss:0.0017296297010034323
2023-04-28 04:57:00 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2470579892396927, mean p set: 0.4499112665653229
loss_pred:0.014778017066419125, decouple_loss:0.001681652618572116
The modified gen p mean: 0.4482675790786743, gen p mean: -0.24481816589832306, mean p set: 0.44879910349845886
The modified gen p mean: 0.44929972290992737, gen p mean: -0.24707183241844177, mean p set: 0.4498290419578552
loss_pred:0.01457017008215189, decouple_loss:0.0016893030842766166
loss_pred:0.01433645747601986, decouple_loss:0.0017007091082632542
WV_1_PC_1_EH_0_PS_30, loss: 0.014646075665950775, avg_mse: 0.02145487256348133
current test mse: 0.021455
Iteration: 5471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780561327934265, gen p mean: -0.2497856169939041, mean p set: 0.44838467240333557
loss_pred:0.013673277571797371, decouple_loss:0.0015040211146697402
The modified gen p mean: 0.447804719209671, gen p mean: -0.24690712988376617, mean p set: 0.44838589429855347
loss_pred:0.01432910468429327, decouple_loss:0.0014697228325530887
The modified gen p mean: 0.4481753408908844, gen p mean: -0.24390941858291626, mean p set: 0.4487065374851227
loss_pred:0.013659141957759857, decouple_loss:0.0016298843547701836
Iteration: 5472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836685061454773, gen p mean: -0.24809479713439941, mean p set: 0.44889721274375916
loss_pred:0.013610866852104664, decouple_loss:0.0015936034033074975
The modified gen p mean: 0.4484696090221405, gen p mean: -0.2506546378135681, mean p set: 0.44904080033302307
loss_pred:0.013742349110543728, decouple_loss:0.0016186559805646539
The modified gen p mean: 0.44866877794265747, gen p mean: -0.24757318198680878, mean p set: 0.4492427408695221
loss_pred:0.013874049298465252, decouple_loss:0.0017324605723842978
Iteration: 5473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830167293548584, gen p mean: -0.2519488036632538, mean p set: 0.4488312005996704
loss_pred:0.013391923159360886, decouple_loss:0.0015953922411426902
The modified gen p mean: 0.44775718450546265, gen p mean: -0.24824626743793488, mean p set: 0.4483332633972168
loss_pred:0.013944313861429691, decouple_loss:0.0014691650867462158
The modified gen p mean: 0.44785717129707336, gen p mean: -0.24611105024814606, mean p set: 0.44843021035194397
loss_pred:0.013635579496622086, decouple_loss:0.0015199697809293866
Iteration: 5474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479477107524872, gen p mean: -0.2521546185016632, mean p set: 0.44847777485847473
loss_pred:0.013832774944603443, decouple_loss:0.0016970932483673096
The modified gen p mean: 0.44768667221069336, gen p mean: -0.24737130105495453, mean p set: 0.44826412200927734
loss_pred:0.01453383918851614, decouple_loss:0.0016882031923159957
The modified gen p mean: 0.4485931396484375, gen p mean: -0.24342016875743866, mean p set: 0.4491655230522156
loss_pred:0.013785689137876034, decouple_loss:0.001966099487617612
Iteration: 5475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480336606502533, gen p mean: -0.24600781500339508, mean p set: 0.4486139416694641
loss_pred:0.01375424675643444, decouple_loss:0.0016046861419454217
The modified gen p mean: 0.4479670524597168, gen p mean: -0.2435031533241272, mean p set: 0.44854387640953064
loss_pred:0.01399383507668972, decouple_loss:0.001577051356434822
The modified gen p mean: 0.44750159978866577, gen p mean: -0.24766379594802856, mean p set: 0.44802939891815186
loss_pred:0.014192173257470131, decouple_loss:0.0015372224152088165
Iteration: 5476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486859142780304, gen p mean: -0.2456074357032776, mean p set: 0.44926151633262634
loss_pred:0.013763909228146076, decouple_loss:0.001524667371995747
The modified gen p mean: 0.44906193017959595, gen p mean: -0.24109847843647003, mean p set: 0.4496433436870575
loss_pred:0.013895255513489246, decouple_loss:0.001544741215184331
The modified gen p mean: 0.44749510288238525, gen p mean: -0.23965488374233246, mean p set: 0.4480193257331848
loss_pred:0.013941488228738308, decouple_loss:0.0015757606597617269
Iteration: 5477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819045066833496, gen p mean: -0.24142763018608093, mean p set: 0.448775053024292
loss_pred:0.014614100567996502, decouple_loss:0.0015975305577740073
The modified gen p mean: 0.447194904088974, gen p mean: -0.2490176260471344, mean p set: 0.44776955246925354
loss_pred:0.014074698090553284, decouple_loss:0.001547217951156199
The modified gen p mean: 0.44778570532798767, gen p mean: -0.23993925750255585, mean p set: 0.4483139216899872
loss_pred:0.013747306540608406, decouple_loss:0.0016200551763176918
Iteration: 5478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480153024196625, gen p mean: -0.24815936386585236, mean p set: 0.44859638810157776
loss_pred:0.014417530968785286, decouple_loss:0.0015264333924278617
The modified gen p mean: 0.44802358746528625, gen p mean: -0.24043291807174683, mean p set: 0.44859370589256287
loss_pred:0.013930980116128922, decouple_loss:0.00179406872484833
The modified gen p mean: 0.4480668604373932, gen p mean: -0.2403193712234497, mean p set: 0.44859760999679565
loss_pred:0.014613264240324497, decouple_loss:0.0016141439555212855
Iteration: 5479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835078716278076, gen p mean: -0.24184323847293854, mean p set: 0.44892874360084534
loss_pred:0.013922364450991154, decouple_loss:0.0016302017029374838
The modified gen p mean: 0.447611540555954, gen p mean: -0.24980862438678741, mean p set: 0.44819343090057373
loss_pred:0.014028096571564674, decouple_loss:0.0014940204564481974
The modified gen p mean: 0.4476648271083832, gen p mean: -0.2438969910144806, mean p set: 0.44819650053977966
loss_pred:0.013438292779028416, decouple_loss:0.0015290022129192948
Iteration: 5480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475327730178833, gen p mean: -0.24949878454208374, mean p set: 0.44810721278190613
loss_pred:0.0139031196013093, decouple_loss:0.0015085573541000485
The modified gen p mean: 0.447770893573761, gen p mean: -0.24813362956047058, mean p set: 0.448341965675354The modified gen p mean: 0.44802194833755493, gen p mean: -0.24482180178165436, mean p set: 0.4485490918159485
loss_pred:0.014151260256767273, decouple_loss:0.0015082093887031078
loss_pred:0.014694192446768284, decouple_loss:0.0017701925244182348
2023-04-28 05:00:25 testing...
The modified gen p mean: 0.4482743442058563, gen p mean: -0.24232997000217438, mean p set: 0.44879910349845886
loss_pred:0.014607911929488182, decouple_loss:0.001693729660473764
The modified gen p mean: 0.44930413365364075, gen p mean: -0.24465729296207428, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24463903903961182, mean p set: 0.4499112665653229loss_pred:0.014321516267955303, decouple_loss:0.0015953003894537687
loss_pred:0.014807341620326042, decouple_loss:0.0017526494339108467
WV_1_PC_1_EH_0_PS_30, loss: 0.014662951231002808, avg_mse: 0.02156181074678898
current test mse: 0.021562
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 5481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469723701477051, gen p mean: -0.2473667711019516, mean p set: 0.4475022256374359
loss_pred:0.01397612038999796, decouple_loss:0.0016276841051876545
The modified gen p mean: 0.44677990674972534, gen p mean: -0.24284443259239197, mean p set: 0.4473552703857422
loss_pred:0.014148102141916752, decouple_loss:0.001615854911506176
The modified gen p mean: 0.4478521943092346, gen p mean: -0.24459561705589294, mean p set: 0.44843539595603943
loss_pred:0.013588124886155128, decouple_loss:0.0014470112510025501
Iteration: 5482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459685981273651, gen p mean: -0.24177992343902588, mean p set: 0.44649171829223633
loss_pred:0.014316629618406296, decouple_loss:0.0017374421004205942
The modified gen p mean: 0.44690102338790894, gen p mean: -0.24518132209777832, mean p set: 0.44747447967529297
The modified gen p mean: 0.44666439294815063, gen p mean: -0.24219457805156708, mean p set: 0.4472406804561615
loss_pred:0.013757101260125637, decouple_loss:0.0013723601587116718
loss_pred:0.013947091065347195, decouple_loss:0.0014046782162040472
Iteration: 5483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717666506767273, gen p mean: -0.2406095415353775, mean p set: 0.4477066397666931
loss_pred:0.014141907915472984, decouple_loss:0.001569997752085328
The modified gen p mean: 0.44851207733154297, gen p mean: -0.24786962568759918, mean p set: 0.449090838432312
The modified gen p mean: 0.4472016394138336, gen p mean: -0.23876865208148956, mean p set: 0.44777190685272217
loss_pred:0.013739493675529957, decouple_loss:0.0018031029030680656
loss_pred:0.013446270488202572, decouple_loss:0.0015161089831963181
Iteration: 5484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478135406970978, gen p mean: -0.2435726374387741, mean p set: 0.4483872950077057
loss_pred:0.013643589802086353, decouple_loss:0.0017700025346130133
The modified gen p mean: 0.4483894109725952, gen p mean: -0.24457882344722748, mean p set: 0.4489142596721649The modified gen p mean: 0.44630345702171326, gen p mean: -0.23926597833633423, mean p set: 0.44687342643737793
loss_pred:0.013687025755643845, decouple_loss:0.0017104899743571877
loss_pred:0.014482732862234116, decouple_loss:0.0018378726672381163
Iteration: 5485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469935894012451, gen p mean: -0.23893623054027557, mean p set: 0.44757208228111267
loss_pred:0.013548765331506729, decouple_loss:0.0019642263650894165
The modified gen p mean: 0.4464873969554901, gen p mean: -0.2401072084903717, mean p set: 0.44701406359672546The modified gen p mean: 0.4456429183483124, gen p mean: -0.23945149779319763, mean p set: 0.4462227523326874
loss_pred:0.014386683702468872, decouple_loss:0.0017534021753817797
loss_pred:0.013353681191802025, decouple_loss:0.001953322673216462
Iteration: 5486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446982204914093, gen p mean: -0.23782627284526825, mean p set: 0.44754740595817566
loss_pred:0.014950322918593884, decouple_loss:0.001591618056409061
The modified gen p mean: 0.44741159677505493, gen p mean: -0.24164749681949615, mean p set: 0.4479806125164032
loss_pred:0.013658757321536541, decouple_loss:0.0014492659829556942
The modified gen p mean: 0.4466174244880676, gen p mean: -0.2409542053937912, mean p set: 0.44714486598968506
loss_pred:0.013980763033032417, decouple_loss:0.0015848367474973202
Iteration: 5487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733941555023193, gen p mean: -0.24216049909591675, mean p set: 0.4479168951511383
loss_pred:0.013513019308447838, decouple_loss:0.0016660250257700682
The modified gen p mean: 0.44872939586639404, gen p mean: -0.24591577053070068, mean p set: 0.44929662346839905
loss_pred:0.013596028089523315, decouple_loss:0.001617541303858161
The modified gen p mean: 0.4476161301136017, gen p mean: -0.24384726583957672, mean p set: 0.4481431543827057
loss_pred:0.013641505502164364, decouple_loss:0.0017614950193092227
Iteration: 5488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815969467163086, gen p mean: -0.24570238590240479, mean p set: 0.44873204827308655
loss_pred:0.013271268457174301, decouple_loss:0.001817898591980338
The modified gen p mean: 0.44609931111335754, gen p mean: -0.24475717544555664, mean p set: 0.4466347098350525The modified gen p mean: 0.4471403658390045, gen p mean: -0.2429763227701187, mean p set: 0.4477138817310333
loss_pred:0.013913532719016075, decouple_loss:0.0015296455239877105
loss_pred:0.013434119522571564, decouple_loss:0.0015686695696786046
Iteration: 5489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652509689331055, gen p mean: -0.24844413995742798, mean p set: 0.44710099697113037
loss_pred:0.013530083000659943, decouple_loss:0.0016282416181638837
The modified gen p mean: 0.4461343586444855, gen p mean: -0.2493101954460144, mean p set: 0.4467092752456665
loss_pred:0.014345302246510983, decouple_loss:0.0014265398494899273
The modified gen p mean: 0.4472632110118866, gen p mean: -0.2470928132534027, mean p set: 0.44778627157211304
loss_pred:0.01378299668431282, decouple_loss:0.0015445345779880881
Iteration: 5490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451410472393036, gen p mean: -0.25284892320632935, mean p set: 0.44571492075920105
loss_pred:0.01350014191120863, decouple_loss:0.0017557109240442514
The modified gen p mean: 0.4475841820240021, gen p mean: -0.24631787836551666, mean p set: 0.44815605878829956
loss_pred:0.013508757576346397, decouple_loss:0.0016971686854958534
The modified gen p mean: 0.44592225551605225, gen p mean: -0.24959798157215118, mean p set: 0.4464513063430786
loss_pred:0.014397182501852512, decouple_loss:0.0016590979648754
2023-04-28 05:04:40 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2464272826910019, mean p set: 0.4499112665653229
loss_pred:0.01479318831115961, decouple_loss:0.0016430031973868608
The modified gen p mean: 0.44827067852020264, gen p mean: -0.24402426183223724, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492981731891632, gen p mean: -0.24634313583374023, mean p set: 0.4498290419578552
loss_pred:0.014649936929345131, decouple_loss:0.0014997712569311261
loss_pred:0.014291076920926571, decouple_loss:0.0014274963177740574
WV_1_PC_1_EH_0_PS_30, loss: 0.014654239639639854, avg_mse: 0.021539242938160896
current test mse: 0.021539
Iteration: 5491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761624932289124, gen p mean: -0.25131338834762573, mean p set: 0.44818755984306335
loss_pred:0.013898471370339394, decouple_loss:0.001577510149218142
The modified gen p mean: 0.44855794310569763, gen p mean: -0.25181299448013306, mean p set: 0.44913914799690247
loss_pred:0.014001472853124142, decouple_loss:0.0014518429525196552
The modified gen p mean: 0.4470358192920685, gen p mean: -0.24439238011837006, mean p set: 0.4475656747817993
loss_pred:0.013893356546759605, decouple_loss:0.001516002113930881
Iteration: 5492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654470682144165, gen p mean: -0.24439013004302979, mean p set: 0.4470709264278412
loss_pred:0.014696143567562103, decouple_loss:0.0018011105712503195
The modified gen p mean: 0.4465346932411194, gen p mean: -0.24346701800823212, mean p set: 0.4471120834350586
loss_pred:0.013819229789078236, decouple_loss:0.0016940062632784247
The modified gen p mean: 0.4477704167366028, gen p mean: -0.24521151185035706, mean p set: 0.4483468234539032
loss_pred:0.01335696130990982, decouple_loss:0.0016140848165377975
Iteration: 5493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464249312877655, gen p mean: -0.24346201121807098, mean p set: 0.44696107506752014
loss_pred:0.013946305960416794, decouple_loss:0.0016797592397779226
The modified gen p mean: 0.44805043935775757, gen p mean: -0.24642561376094818, mean p set: 0.4486336410045624
loss_pred:0.013748743571341038, decouple_loss:0.0016480437479913235
The modified gen p mean: 0.447660356760025, gen p mean: -0.24622991681098938, mean p set: 0.44823282957077026
loss_pred:0.01422481331974268, decouple_loss:0.0016162358224391937
Iteration: 5494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463951289653778, gen p mean: -0.2423555999994278, mean p set: 0.4469250440597534
loss_pred:0.014731371775269508, decouple_loss:0.0018162650521844625
The modified gen p mean: 0.44593578577041626, gen p mean: -0.24762019515037537, mean p set: 0.44651445746421814
loss_pred:0.01320714969187975, decouple_loss:0.001650662743486464
The modified gen p mean: 0.4468505084514618, gen p mean: -0.24592554569244385, mean p set: 0.44742488861083984
loss_pred:0.014462471008300781, decouple_loss:0.0017256117425858974
Iteration: 5495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480568766593933, gen p mean: -0.2439125031232834, mean p set: 0.4486321210861206
loss_pred:0.013490840792655945, decouple_loss:0.0016612327890470624
The modified gen p mean: 0.44806796312332153, gen p mean: -0.24032852053642273, mean p set: 0.44859448075294495The modified gen p mean: 0.4479064345359802, gen p mean: -0.24350740015506744, mean p set: 0.44847849011421204
loss_pred:0.013552957214415073, decouple_loss:0.001624588156118989
loss_pred:0.014153800904750824, decouple_loss:0.001760061364620924
Iteration: 5496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870397448539734, gen p mean: -0.24571630358695984, mean p set: 0.44927650690078735
loss_pred:0.013367518782615662, decouple_loss:0.0016718588303774595
The modified gen p mean: 0.44663843512535095, gen p mean: -0.24283936619758606, mean p set: 0.44717034697532654The modified gen p mean: 0.44746133685112, gen p mean: -0.2405606061220169, mean p set: 0.44803762435913086
loss_pred:0.013968851417303085, decouple_loss:0.001492490409873426
loss_pred:0.014496661722660065, decouple_loss:0.0017583782318979502
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481729567050934, gen p mean: -0.24007630348205566, mean p set: 0.4487445652484894
loss_pred:0.013733720406889915, decouple_loss:0.0017214138060808182
The modified gen p mean: 0.44710099697113037, gen p mean: -0.23747386038303375, mean p set: 0.44768208265304565The modified gen p mean: 0.4477783739566803, gen p mean: -0.2369922250509262, mean p set: 0.4483067989349365
loss_pred:0.013352599926292896, decouple_loss:0.0018647863762453198
loss_pred:0.014283948577940464, decouple_loss:0.0018120601307600737
Iteration: 5498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482565224170685, gen p mean: -0.23623479902744293, mean p set: 0.4488321542739868
loss_pred:0.013486751355230808, decouple_loss:0.00148009171243757
The modified gen p mean: 0.44895654916763306, gen p mean: -0.24074184894561768, mean p set: 0.44949212670326233The modified gen p mean: 0.44808056950569153, gen p mean: -0.23537099361419678, mean p set: 0.4486530125141144
loss_pred:0.014605428092181683, decouple_loss:0.0016008139355108142
loss_pred:0.013518845662474632, decouple_loss:0.0015051782829687
Iteration: 5499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719797372817993, gen p mean: -0.23315171897411346, mean p set: 0.4477720260620117
loss_pred:0.013638903386890888, decouple_loss:0.002165560843423009
The modified gen p mean: 0.44548094272613525, gen p mean: -0.2372833788394928, mean p set: 0.4460570514202118
loss_pred:0.013283713720738888, decouple_loss:0.0018797427183017135
The modified gen p mean: 0.4487617611885071, gen p mean: -0.23729097843170166, mean p set: 0.44928810000419617
loss_pred:0.013711869716644287, decouple_loss:0.0020298371091485023
Iteration: 5500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44629088044166565, gen p mean: -0.23563355207443237, mean p set: 0.44687098264694214
loss_pred:0.013259829953312874, decouple_loss:0.0015698018250986934
The modified gen p mean: 0.44793638586997986, gen p mean: -0.23672740161418915, mean p set: 0.4485151767730713
loss_pred:0.013379891403019428, decouple_loss:0.0017347109969705343
The modified gen p mean: 0.44800350069999695, gen p mean: -0.23408560454845428, mean p set: 0.4485243558883667
loss_pred:0.013403834775090218, decouple_loss:0.0014857028145343065
2023-04-28 05:08:04 testing...
The modified gen p mean: 0.4482739269733429, gen p mean: -0.23549945652484894, mean p set: 0.44879910349845886
The modified gen p mean: 0.4494309425354004, gen p mean: -0.238013356924057, mean p set: 0.4499112665653229
loss_pred:0.01468073483556509, decouple_loss:0.0017165521858260036
loss_pred:0.014845471829175949, decouple_loss:0.0017829324351623654
The modified gen p mean: 0.44929999113082886, gen p mean: -0.23787936568260193, mean p set: 0.4498290419578552
loss_pred:0.014341452158987522, decouple_loss:0.0017536405939608812
WV_1_PC_1_EH_0_PS_30, loss: 0.014710105024278164, avg_mse: 0.02161625772714615
current test mse: 0.021616
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 5501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482942819595337, gen p mean: -0.24110446870326996, mean p set: 0.4488309919834137
loss_pred:0.014247700572013855, decouple_loss:0.0018020839197561145
The modified gen p mean: 0.4478521943092346, gen p mean: -0.24098046123981476, mean p set: 0.4484257698059082
The modified gen p mean: 0.44775187969207764, gen p mean: -0.23850128054618835, mean p set: 0.44832542538642883
loss_pred:0.01397430058568716, decouple_loss:0.0016451160190626979
loss_pred:0.014095074497163296, decouple_loss:0.0021141106262803078
Iteration: 5502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873008131980896, gen p mean: -0.2391417771577835, mean p set: 0.4492567181587219
loss_pred:0.013690480031073093, decouple_loss:0.002003285801038146
The modified gen p mean: 0.44889169931411743, gen p mean: -0.24192990362644196, mean p set: 0.44945937395095825
The modified gen p mean: 0.4477749466896057, gen p mean: -0.2422122061252594, mean p set: 0.44834965467453003
loss_pred:0.012818210758268833, decouple_loss:0.0019698655232787132
loss_pred:0.014211202040314674, decouple_loss:0.0017077646916732192
Iteration: 5503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940173625946045, gen p mean: -0.24047529697418213, mean p set: 0.44993188977241516
loss_pred:0.01358199492096901, decouple_loss:0.0016341531882062554
The modified gen p mean: 0.44759222865104675, gen p mean: -0.23565484583377838, mean p set: 0.4481671154499054The modified gen p mean: 0.4476175904273987, gen p mean: -0.23706094920635223, mean p set: 0.4481886029243469
loss_pred:0.013423370197415352, decouple_loss:0.001919853501021862
loss_pred:0.013520291075110435, decouple_loss:0.0018399667460471392
Iteration: 5504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486629068851471, gen p mean: -0.23318397998809814, mean p set: 0.44919553399086
loss_pred:0.013638654723763466, decouple_loss:0.0020774134900420904
The modified gen p mean: 0.44806307554244995, gen p mean: -0.23972027003765106, mean p set: 0.4486420452594757The modified gen p mean: 0.4479135274887085, gen p mean: -0.24089142680168152, mean p set: 0.4484882652759552
loss_pred:0.014118988998234272, decouple_loss:0.0020015204790979624
loss_pred:0.013275095261633396, decouple_loss:0.0017879883525893092
Iteration: 5505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484466314315796, gen p mean: -0.2402304708957672, mean p set: 0.4490225911140442
loss_pred:0.01374723855406046, decouple_loss:0.001680205576121807
The modified gen p mean: 0.44706544280052185, gen p mean: -0.24227751791477203, mean p set: 0.4476362466812134
loss_pred:0.014223916456103325, decouple_loss:0.001976981060579419
The modified gen p mean: 0.4488053321838379, gen p mean: -0.23650677502155304, mean p set: 0.44932955503463745
loss_pred:0.013808702118694782, decouple_loss:0.0016604505944997072
Iteration: 5506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855716824531555, gen p mean: -0.23592522740364075, mean p set: 0.44913092255592346
loss_pred:0.013561745174229145, decouple_loss:0.002015823032706976
The modified gen p mean: 0.4474301040172577, gen p mean: -0.24348674714565277, mean p set: 0.4479579031467438The modified gen p mean: 0.44963669776916504, gen p mean: -0.23903080821037292, mean p set: 0.450207382440567
loss_pred:0.013156132772564888, decouple_loss:0.0019871850963681936
loss_pred:0.01347093004733324, decouple_loss:0.0016132553573697805
Iteration: 5507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448712021112442, gen p mean: -0.23649002611637115, mean p set: 0.4492858350276947
loss_pred:0.013118520379066467, decouple_loss:0.0018851292552426457
The modified gen p mean: 0.44830429553985596, gen p mean: -0.23581013083457947, mean p set: 0.4488828480243683
loss_pred:0.013814439065754414, decouple_loss:0.002162689110264182
The modified gen p mean: 0.4501456320285797, gen p mean: -0.23654811084270477, mean p set: 0.4506753385066986
loss_pred:0.013331984169781208, decouple_loss:0.0018718327628448606
Iteration: 5508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484785497188568, gen p mean: -0.23662322759628296, mean p set: 0.44905519485473633
loss_pred:0.01357452105730772, decouple_loss:0.0017199334688484669
The modified gen p mean: 0.4487718343734741, gen p mean: -0.232732892036438, mean p set: 0.44930222630500793The modified gen p mean: 0.44872623682022095, gen p mean: -0.2402295619249344, mean p set: 0.44930025935173035
loss_pred:0.0131576769053936, decouple_loss:0.0016830104868859053
loss_pred:0.013427953235805035, decouple_loss:0.001788256922736764
Iteration: 5509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44913536310195923, gen p mean: -0.24069322645664215, mean p set: 0.4497077465057373
loss_pred:0.013524189591407776, decouple_loss:0.0017329133115708828
The modified gen p mean: 0.4490801692008972, gen p mean: -0.2376672774553299, mean p set: 0.44965940713882446
loss_pred:0.012797316536307335, decouple_loss:0.0020467201247811317
The modified gen p mean: 0.44803521037101746, gen p mean: -0.23901206254959106, mean p set: 0.44856372475624084
loss_pred:0.013319039717316628, decouple_loss:0.001648484030738473
Iteration: 5510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448419451713562, gen p mean: -0.236453115940094, mean p set: 0.44900044798851013
loss_pred:0.013028942979872227, decouple_loss:0.0018740238156169653
The modified gen p mean: 0.4472445547580719, gen p mean: -0.23803304135799408, mean p set: 0.4478180706501007
loss_pred:0.01417476311326027, decouple_loss:0.0017496699001640081
The modified gen p mean: 0.4487094581127167, gen p mean: -0.2354024201631546, mean p set: 0.4492400586605072
loss_pred:0.014105498790740967, decouple_loss:0.0018304088152945042
2023-04-28 05:12:23 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2363644540309906, mean p set: 0.4499112665653229
loss_pred:0.014996363781392574, decouple_loss:0.0020252212416380644
The modified gen p mean: 0.44826915860176086, gen p mean: -0.23407943546772003, mean p set: 0.44879910349845886
The modified gen p mean: 0.4492994546890259, gen p mean: -0.23606009781360626, mean p set: 0.4498290419578552
loss_pred:0.01478694286197424, decouple_loss:0.0018593078712001443
loss_pred:0.014477012678980827, decouple_loss:0.0019154009642079473
WV_1_PC_1_EH_0_PS_30, loss: 0.014850105158984661, avg_mse: 0.021843232214450836
current test mse: 0.021843
Iteration: 5511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484879970550537, gen p mean: -0.23856276273727417, mean p set: 0.4490663409233093
loss_pred:0.013091184198856354, decouple_loss:0.0018927135970443487
The modified gen p mean: 0.4488527774810791, gen p mean: -0.23570367693901062, mean p set: 0.449429988861084
loss_pred:0.014077233150601387, decouple_loss:0.0015879928832873702
The modified gen p mean: 0.44992634654045105, gen p mean: -0.23766963183879852, mean p set: 0.4504498541355133
loss_pred:0.013094069436192513, decouple_loss:0.0020138730760663748
Iteration: 5512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44918736815452576, gen p mean: -0.23107556998729706, mean p set: 0.44971105456352234
loss_pred:0.013433093205094337, decouple_loss:0.0019275561207905412
The modified gen p mean: 0.4483064115047455, gen p mean: -0.23938845098018646, mean p set: 0.4488871097564697
loss_pred:0.013170135207474232, decouple_loss:0.0018539003795012832
The modified gen p mean: 0.44825783371925354, gen p mean: -0.24219678342342377, mean p set: 0.44883859157562256
loss_pred:0.013070314191281796, decouple_loss:0.0019338239217177033
Iteration: 5513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777175784111023, gen p mean: -0.23844261467456818, mean p set: 0.44830384850502014
loss_pred:0.012968167662620544, decouple_loss:0.0018058025743812323
The modified gen p mean: 0.4488592743873596, gen p mean: -0.23996151983737946, mean p set: 0.44943690299987793
loss_pred:0.013247029855847359, decouple_loss:0.0017735461005941033
The modified gen p mean: 0.4475058317184448, gen p mean: -0.24007177352905273, mean p set: 0.4480898678302765
loss_pred:0.01357510220259428, decouple_loss:0.0017930081812664866
Iteration: 5514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813501834869385, gen p mean: -0.2394893616437912, mean p set: 0.44866296648979187
loss_pred:0.01383247971534729, decouple_loss:0.0018368794117122889
The modified gen p mean: 0.4490450322628021, gen p mean: -0.23302634060382843, mean p set: 0.4496217370033264
loss_pred:0.01301573496311903, decouple_loss:0.0020169701892882586
The modified gen p mean: 0.44800013303756714, gen p mean: -0.23941558599472046, mean p set: 0.4485659599304199
loss_pred:0.013585986569523811, decouple_loss:0.0020797362085431814
Iteration: 5515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773760437965393, gen p mean: -0.23580554127693176, mean p set: 0.4483124613761902
loss_pred:0.013074963353574276, decouple_loss:0.0016342231538146734
The modified gen p mean: 0.44862163066864014, gen p mean: -0.24272848665714264, mean p set: 0.449150025844574
The modified gen p mean: 0.44839900732040405, gen p mean: -0.23664309084415436, mean p set: 0.44897738099098206
loss_pred:0.013234090991318226, decouple_loss:0.001673380727879703
loss_pred:0.012963610701262951, decouple_loss:0.0016824726480990648
Iteration: 5516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496140778064728, gen p mean: -0.23623177409172058, mean p set: 0.45019209384918213
loss_pred:0.013935988768935204, decouple_loss:0.0016919809859246016
The modified gen p mean: 0.4473992586135864, gen p mean: -0.2410310059785843, mean p set: 0.4479256868362427The modified gen p mean: 0.4490755796432495, gen p mean: -0.23956738412380219, mean p set: 0.4496510326862335
loss_pred:0.013501585461199284, decouple_loss:0.001805533654987812
loss_pred:0.013286532834172249, decouple_loss:0.0018693461315706372
Iteration: 5517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480845034122467, gen p mean: -0.23382452130317688, mean p set: 0.4486553370952606
loss_pred:0.013708076439797878, decouple_loss:0.001711956923827529
The modified gen p mean: 0.44782450795173645, gen p mean: -0.2268369346857071, mean p set: 0.44840162992477417
loss_pred:0.013026370666921139, decouple_loss:0.0015444988384842873
The modified gen p mean: 0.44794192910194397, gen p mean: -0.2393486052751541, mean p set: 0.448469340801239
loss_pred:0.01324258092790842, decouple_loss:0.0016684138681739569
Iteration: 5518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493502974510193, gen p mean: -0.2348048835992813, mean p set: 0.4499247372150421
loss_pred:0.012929998338222504, decouple_loss:0.0015550233656540513
The modified gen p mean: 0.4485858380794525, gen p mean: -0.232585608959198, mean p set: 0.44916436076164246
loss_pred:0.013207430019974709, decouple_loss:0.0016478056786581874
The modified gen p mean: 0.4487330913543701, gen p mean: -0.23522932827472687, mean p set: 0.44925642013549805
loss_pred:0.013850261457264423, decouple_loss:0.001755180419422686
Iteration: 5519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484914541244507, gen p mean: -0.23510347306728363, mean p set: 0.4490686058998108
loss_pred:0.013889128342270851, decouple_loss:0.0017051765462383628
The modified gen p mean: 0.44934093952178955, gen p mean: -0.23601405322551727, mean p set: 0.44992080330848694
loss_pred:0.014154119417071342, decouple_loss:0.0016149425646290183
The modified gen p mean: 0.4475778341293335, gen p mean: -0.23278619349002838, mean p set: 0.4480970501899719
loss_pred:0.01321372389793396, decouple_loss:0.0014894921332597733
Iteration: 5520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483204483985901, gen p mean: -0.2388186752796173, mean p set: 0.4488929510116577
loss_pred:0.01361178234219551, decouple_loss:0.0018579401075839996
The modified gen p mean: 0.4483785033226013, gen p mean: -0.23416100442409515, mean p set: 0.4489034116268158The modified gen p mean: 0.44783762097358704, gen p mean: -0.23199284076690674, mean p set: 0.44841691851615906
loss_pred:0.013059210032224655, decouple_loss:0.0015727293211966753
loss_pred:0.013395942747592926, decouple_loss:0.0017416996415704489
2023-04-28 05:15:47 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23536700010299683, mean p set: 0.4499112665653229
loss_pred:0.01492525264620781, decouple_loss:0.0017048902809619904
The modified gen p mean: 0.448271781206131, gen p mean: -0.23298653960227966, mean p set: 0.44879910349845886
The modified gen p mean: 0.4493047595024109, gen p mean: -0.2351684272289276, mean p set: 0.4498290419578552
loss_pred:0.014725526794791222, decouple_loss:0.0015488716308027506
loss_pred:0.014434406533837318, decouple_loss:0.001637891517020762
WV_1_PC_1_EH_0_PS_30, loss: 0.014776590280234814, avg_mse: 0.02176639437675476
current test mse: 0.021766
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 5521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842660427093506, gen p mean: -0.23446455597877502, mean p set: 0.44895321130752563
loss_pred:0.014035984873771667, decouple_loss:0.0014926082221791148
The modified gen p mean: 0.44732165336608887, gen p mean: -0.2385532259941101, mean p set: 0.44789400696754456
The modified gen p mean: 0.44813773036003113, gen p mean: -0.23580503463745117, mean p set: 0.44871145486831665
loss_pred:0.014329317957162857, decouple_loss:0.0014993377262726426
loss_pred:0.014595631510019302, decouple_loss:0.0014477878576144576
Iteration: 5522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471587538719177, gen p mean: -0.2365361452102661, mean p set: 0.447688490152359
loss_pred:0.014021842740476131, decouple_loss:0.0015256301267072558
The modified gen p mean: 0.4473143219947815, gen p mean: -0.23562337458133698, mean p set: 0.44789284467697144
loss_pred:0.013901513069868088, decouple_loss:0.0018147954251617193
The modified gen p mean: 0.4472862482070923, gen p mean: -0.2360031008720398, mean p set: 0.4478580951690674
loss_pred:0.01367795281112194, decouple_loss:0.001515928073786199
Iteration: 5523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472322463989258, gen p mean: -0.23997826874256134, mean p set: 0.4477599561214447
loss_pred:0.013938287273049355, decouple_loss:0.001439294428564608
The modified gen p mean: 0.4472421705722809, gen p mean: -0.24249184131622314, mean p set: 0.4478192627429962
loss_pred:0.013294823467731476, decouple_loss:0.0013896619202569127
The modified gen p mean: 0.4486387372016907, gen p mean: -0.2363436222076416, mean p set: 0.44922152161598206
loss_pred:0.014307769015431404, decouple_loss:0.0014941698173061013
Iteration: 5524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480459690093994, gen p mean: -0.23924210667610168, mean p set: 0.44857507944107056
loss_pred:0.013670623302459717, decouple_loss:0.0015364392893388867
The modified gen p mean: 0.4481508731842041, gen p mean: -0.23457759618759155, mean p set: 0.44872695207595825
loss_pred:0.014210588298738003, decouple_loss:0.0015114897396415472
The modified gen p mean: 0.4502819776535034, gen p mean: -0.24125909805297852, mean p set: 0.4508599638938904
loss_pred:0.01388160977512598, decouple_loss:0.001780799007974565
Iteration: 5525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831767678260803, gen p mean: -0.2373904436826706, mean p set: 0.4488926827907562
loss_pred:0.01437484472990036, decouple_loss:0.0016375695122405887
The modified gen p mean: 0.4480469524860382, gen p mean: -0.241649329662323, mean p set: 0.44861847162246704The modified gen p mean: 0.44705814123153687, gen p mean: -0.23984888195991516, mean p set: 0.4475880563259125
loss_pred:0.013691152445971966, decouple_loss:0.0016769979847595096
loss_pred:0.014238625764846802, decouple_loss:0.0016709133051335812
Iteration: 5526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471012353897095, gen p mean: -0.24183189868927002, mean p set: 0.4476771950721741
loss_pred:0.015120907686650753, decouple_loss:0.0013946318067610264
The modified gen p mean: 0.4486532211303711, gen p mean: -0.24251386523246765, mean p set: 0.44918495416641235The modified gen p mean: 0.44763848185539246, gen p mean: -0.2432601898908615, mean p set: 0.44820985198020935
loss_pred:0.01423087902367115, decouple_loss:0.0015030321665108204
loss_pred:0.013878822326660156, decouple_loss:0.0014241435565054417
Iteration: 5527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483429491519928, gen p mean: -0.24388836324214935, mean p set: 0.44892382621765137
loss_pred:0.013825756497681141, decouple_loss:0.0016850571846589446
The modified gen p mean: 0.44745028018951416, gen p mean: -0.2465737909078598, mean p set: 0.4480244815349579
loss_pred:0.013929957523941994, decouple_loss:0.0017023676773533225
The modified gen p mean: 0.4481179416179657, gen p mean: -0.24413849413394928, mean p set: 0.4486456513404846
loss_pred:0.014220958575606346, decouple_loss:0.00174224644433707
Iteration: 5528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727808237075806, gen p mean: -0.23958386480808258, mean p set: 0.44785773754119873
loss_pred:0.013779734261333942, decouple_loss:0.0017493487102910876
The modified gen p mean: 0.4479418098926544, gen p mean: -0.2417079508304596, mean p set: 0.44852176308631897
loss_pred:0.01442502811551094, decouple_loss:0.0017315295990556479
The modified gen p mean: 0.44855886697769165, gen p mean: -0.24062176048755646, mean p set: 0.44908908009529114
loss_pred:0.014339867979288101, decouple_loss:0.0017231781966984272
Iteration: 5529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985875487327576, gen p mean: -0.2418959140777588, mean p set: 0.45043665170669556
loss_pred:0.014203823171555996, decouple_loss:0.0017886265413835645
The modified gen p mean: 0.44752514362335205, gen p mean: -0.2399442493915558, mean p set: 0.4481090009212494
loss_pred:0.013889473862946033, decouple_loss:0.0017112863715738058
The modified gen p mean: 0.4485500454902649, gen p mean: -0.23862633109092712, mean p set: 0.4490887224674225
loss_pred:0.013471635989844799, decouple_loss:0.0018724104156717658
Iteration: 5530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849875569343567, gen p mean: -0.24032557010650635, mean p set: 0.4490683674812317
loss_pred:0.013501662760972977, decouple_loss:0.0016964880051091313
The modified gen p mean: 0.4483625292778015, gen p mean: -0.23797015845775604, mean p set: 0.4488913416862488
loss_pred:0.014734504744410515, decouple_loss:0.0017688514199107885
The modified gen p mean: 0.4475933313369751, gen p mean: -0.2437594085931778, mean p set: 0.44816285371780396
loss_pred:0.013233712874352932, decouple_loss:0.0016272309003397822
2023-04-28 05:20:05 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.239031121134758, mean p set: 0.4499112665653229
loss_pred:0.014856829307973385, decouple_loss:0.0017433942994102836
The modified gen p mean: 0.44827577471733093, gen p mean: -0.23653404414653778, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930583238601685, gen p mean: -0.23875792324543, mean p set: 0.4498290419578552
loss_pred:0.014706501737236977, decouple_loss:0.0016111356671899557
loss_pred:0.014362935908138752, decouple_loss:0.0017410680884495378
WV_1_PC_1_EH_0_PS_30, loss: 0.014727016910910606, avg_mse: 0.021656079217791557
current test mse: 0.021656
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479573965072632, gen p mean: -0.23916548490524292, mean p set: 0.4485322833061218
loss_pred:0.013518797233700752, decouple_loss:0.0016394815174862742
The modified gen p mean: 0.44752028584480286, gen p mean: -0.2402038276195526, mean p set: 0.44804567098617554
loss_pred:0.013593444600701332, decouple_loss:0.001728344359435141
The modified gen p mean: 0.449098140001297, gen p mean: -0.24276821315288544, mean p set: 0.4496676027774811
loss_pred:0.014345868490636349, decouple_loss:0.001565203070640564
Iteration: 5532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481702148914337, gen p mean: -0.23770509660243988, mean p set: 0.44869568943977356
loss_pred:0.013952838256955147, decouple_loss:0.0017217197455465794
The modified gen p mean: 0.44701626896858215, gen p mean: -0.2408188283443451, mean p set: 0.44758591055870056
loss_pred:0.01339980959892273, decouple_loss:0.0016791489906609058
The modified gen p mean: 0.4475097358226776, gen p mean: -0.23835232853889465, mean p set: 0.4480845034122467
loss_pred:0.014360635541379452, decouple_loss:0.0017346935346722603
Iteration: 5533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798555970191956, gen p mean: -0.2423599660396576, mean p set: 0.4485079050064087
loss_pred:0.013576551340520382, decouple_loss:0.0018541919998824596
The modified gen p mean: 0.44826480746269226, gen p mean: -0.24185289442539215, mean p set: 0.4488394856452942
loss_pred:0.01377443689852953, decouple_loss:0.0017470845486968756
The modified gen p mean: 0.4473000466823578, gen p mean: -0.2443343549966812, mean p set: 0.4478755593299866
loss_pred:0.013526392169296741, decouple_loss:0.0015139157185330987
Iteration: 5534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835999608039856, gen p mean: -0.24289628863334656, mean p set: 0.448894202709198
loss_pred:0.014904447831213474, decouple_loss:0.001546324696391821
The modified gen p mean: 0.4474216103553772, gen p mean: -0.24218593537807465, mean p set: 0.44799840450286865
loss_pred:0.014489191584289074, decouple_loss:0.00167495955247432
The modified gen p mean: 0.4477630853652954, gen p mean: -0.24325335025787354, mean p set: 0.44833654165267944
loss_pred:0.014024319127202034, decouple_loss:0.0016541910590603948
Iteration: 5535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481600522994995, gen p mean: -0.2423122674226761, mean p set: 0.4487335979938507
loss_pred:0.013972179032862186, decouple_loss:0.0015876066172495484
The modified gen p mean: 0.44946345686912537, gen p mean: -0.2421921342611313, mean p set: 0.4499906599521637The modified gen p mean: 0.447411447763443, gen p mean: -0.24517598748207092, mean p set: 0.44798803329467773
loss_pred:0.013791664503514767, decouple_loss:0.0017018986400216818
loss_pred:0.013696568086743355, decouple_loss:0.00143206468783319
Iteration: 5536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476136565208435, gen p mean: -0.24355626106262207, mean p set: 0.44819530844688416
loss_pred:0.014048290438950062, decouple_loss:0.0013320472789928317
The modified gen p mean: 0.4484251141548157, gen p mean: -0.24433518946170807, mean p set: 0.4489997327327728The modified gen p mean: 0.4486151337623596, gen p mean: -0.24243347346782684, mean p set: 0.4491422176361084
loss_pred:0.013887373730540276, decouple_loss:0.0013720854185521603
loss_pred:0.014098194427788258, decouple_loss:0.0013902535429224372
Iteration: 5537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490987956523895, gen p mean: -0.241900235414505, mean p set: 0.4496730864048004
loss_pred:0.014281170442700386, decouple_loss:0.0018001670250669122
The modified gen p mean: 0.4470529854297638, gen p mean: -0.23751035332679749, mean p set: 0.44762876629829407
loss_pred:0.015134830959141254, decouple_loss:0.0016052898718044162
The modified gen p mean: 0.44965749979019165, gen p mean: -0.2438303828239441, mean p set: 0.4501863420009613
loss_pred:0.013972721062600613, decouple_loss:0.001894599525257945
Iteration: 5538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775447249412537, gen p mean: -0.2406042516231537, mean p set: 0.44832760095596313
loss_pred:0.013698563911020756, decouple_loss:0.0013993068132549524
The modified gen p mean: 0.4480786621570587, gen p mean: -0.24218004941940308, mean p set: 0.44860783219337463
loss_pred:0.013548498973250389, decouple_loss:0.0013476393651217222
The modified gen p mean: 0.44767704606056213, gen p mean: -0.23972894251346588, mean p set: 0.4482552707195282
loss_pred:0.014210277236998081, decouple_loss:0.0014214451657608151
Iteration: 5539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481889605522156, gen p mean: -0.2385236769914627, mean p set: 0.44876912236213684
loss_pred:0.014152116142213345, decouple_loss:0.0015878024278208613
The modified gen p mean: 0.44784075021743774, gen p mean: -0.2435130625963211, mean p set: 0.4484177529811859
loss_pred:0.014048190787434578, decouple_loss:0.001598776550963521
The modified gen p mean: 0.4494043290615082, gen p mean: -0.24138879776000977, mean p set: 0.4499371349811554
loss_pred:0.013894336298108101, decouple_loss:0.001864812569692731
Iteration: 5540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823771715164185, gen p mean: -0.24276146292686462, mean p set: 0.44880983233451843
loss_pred:0.014836951158940792, decouple_loss:0.0016826005885377526
The modified gen p mean: 0.44768282771110535, gen p mean: -0.24285319447517395, mean p set: 0.44825538992881775
loss_pred:0.013764584437012672, decouple_loss:0.001593184657394886
The modified gen p mean: 0.4482365548610687, gen p mean: -0.24255990982055664, mean p set: 0.4487592875957489
loss_pred:0.014931837096810341, decouple_loss:0.0015152015257626772
2023-04-28 05:23:29 testing...
The modified gen p mean: 0.44826817512512207, gen p mean: -0.23856130242347717, mean p set: 0.44879910349845886
loss_pred:0.014642513357102871, decouple_loss:0.0015742823015898466
The modified gen p mean: 0.4492988884449005, gen p mean: -0.2408219277858734, mean p set: 0.4498290419578552
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24051488935947418, mean p set: 0.4499112665653229loss_pred:0.014304805546998978, decouple_loss:0.0015150716062635183
loss_pred:0.014821432530879974, decouple_loss:0.0016899027395993471
WV_1_PC_1_EH_0_PS_30, loss: 0.014669238589704037, avg_mse: 0.021620722487568855
current test mse: 0.021621
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 5541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471958577632904, gen p mean: -0.2372996211051941, mean p set: 0.4477251172065735
loss_pred:0.0138909462839365, decouple_loss:0.0015772789483889937
The modified gen p mean: 0.4464781582355499, gen p mean: -0.23995907604694366, mean p set: 0.44706007838249207
The modified gen p mean: 0.44695648550987244, gen p mean: -0.23950645327568054, mean p set: 0.44753265380859375
loss_pred:0.01359892264008522, decouple_loss:0.0016702470602467656
loss_pred:0.013634229078888893, decouple_loss:0.0018764425767585635
Iteration: 5542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473588168621063, gen p mean: -0.2402576059103012, mean p set: 0.44788506627082825
loss_pred:0.013805530034005642, decouple_loss:0.0016960938228294253
The modified gen p mean: 0.44766491651535034, gen p mean: -0.23652713000774384, mean p set: 0.4482450783252716
The modified gen p mean: 0.44661957025527954, gen p mean: -0.24156554043293, mean p set: 0.44719746708869934
loss_pred:0.013739500194787979, decouple_loss:0.0018006700556725264
loss_pred:0.013904402032494545, decouple_loss:0.0016672201454639435
Iteration: 5543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475453197956085, gen p mean: -0.23543518781661987, mean p set: 0.44806838035583496
loss_pred:0.013408067636191845, decouple_loss:0.0016536220209673047
The modified gen p mean: 0.44670340418815613, gen p mean: -0.24273093044757843, mean p set: 0.44728177785873413
The modified gen p mean: 0.44746872782707214, gen p mean: -0.23807737231254578, mean p set: 0.4480440020561218
loss_pred:0.013811917044222355, decouple_loss:0.0017573103541508317
loss_pred:0.013640186749398708, decouple_loss:0.0017398425843566656
Iteration: 5544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465711712837219, gen p mean: -0.23803573846817017, mean p set: 0.4471500515937805
loss_pred:0.014330889098346233, decouple_loss:0.0015774540370330215
The modified gen p mean: 0.446690171957016, gen p mean: -0.23735961318016052, mean p set: 0.44722166657447815The modified gen p mean: 0.44673267006874084, gen p mean: -0.23685388267040253, mean p set: 0.4473183751106262
loss_pred:0.014170689508318901, decouple_loss:0.0015615186421200633
loss_pred:0.014109901152551174, decouple_loss:0.001622423529624939
Iteration: 5545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643306732177734, gen p mean: -0.23673781752586365, mean p set: 0.4469999372959137
loss_pred:0.013853175565600395, decouple_loss:0.0017105311853811145
The modified gen p mean: 0.4463365375995636, gen p mean: -0.23729535937309265, mean p set: 0.44691479206085205
loss_pred:0.014361517503857613, decouple_loss:0.001731462893076241
The modified gen p mean: 0.44656237959861755, gen p mean: -0.24215559661388397, mean p set: 0.44709545373916626
loss_pred:0.0137861929833889, decouple_loss:0.0018119028536602855
Iteration: 5546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44513627886772156, gen p mean: -0.23892976343631744, mean p set: 0.44565579295158386
loss_pred:0.013730786740779877, decouple_loss:0.0014805649407207966
The modified gen p mean: 0.44677215814590454, gen p mean: -0.23915192484855652, mean p set: 0.4473506212234497
The modified gen p mean: 0.44691532850265503, gen p mean: -0.24161666631698608, mean p set: 0.44748565554618835
loss_pred:0.014012016355991364, decouple_loss:0.0014258426381275058
loss_pred:0.013547292910516262, decouple_loss:0.0014536126982420683
Iteration: 5547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464672803878784, gen p mean: -0.2349628210067749, mean p set: 0.44704607129096985
loss_pred:0.01347390003502369, decouple_loss:0.0018431480275467038
The modified gen p mean: 0.44705939292907715, gen p mean: -0.2353215217590332, mean p set: 0.4476316571235657
loss_pred:0.014141637831926346, decouple_loss:0.0015679530333727598
The modified gen p mean: 0.44677168130874634, gen p mean: -0.23619979619979858, mean p set: 0.44730156660079956
loss_pred:0.01379906851798296, decouple_loss:0.0016284026205539703
Iteration: 5548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44627732038497925, gen p mean: -0.2400851845741272, mean p set: 0.446846604347229
loss_pred:0.013852374628186226, decouple_loss:0.0016470277914777398
The modified gen p mean: 0.44646450877189636, gen p mean: -0.24147216975688934, mean p set: 0.44699564576148987The modified gen p mean: 0.4483446776866913, gen p mean: -0.23962360620498657, mean p set: 0.4489297568798065
loss_pred:0.013209802098572254, decouple_loss:0.001681069377809763
loss_pred:0.013884383253753185, decouple_loss:0.0015988732920959592
Iteration: 5549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44624632596969604, gen p mean: -0.23867091536521912, mean p set: 0.446819543838501
loss_pred:0.01396604161709547, decouple_loss:0.0017271431861445308
The modified gen p mean: 0.44633349776268005, gen p mean: -0.24450252950191498, mean p set: 0.44691362977027893
loss_pred:0.013964950107038021, decouple_loss:0.001603798009455204
The modified gen p mean: 0.44526728987693787, gen p mean: -0.2413543313741684, mean p set: 0.44578808546066284
loss_pred:0.013671878725290298, decouple_loss:0.0015750154852867126
Iteration: 5550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459008276462555, gen p mean: -0.23944272100925446, mean p set: 0.44647684693336487
loss_pred:0.014515154995024204, decouple_loss:0.0016356221167370677
The modified gen p mean: 0.4459669888019562, gen p mean: -0.23797667026519775, mean p set: 0.4465474784374237
loss_pred:0.013699101284146309, decouple_loss:0.0015705295372754335
The modified gen p mean: 0.4460589587688446, gen p mean: -0.24426166713237762, mean p set: 0.44658660888671875
loss_pred:0.013855697587132454, decouple_loss:0.0017963738646358252
2023-04-28 05:27:50 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24183392524719238, mean p set: 0.4499112665653229
loss_pred:0.01484768558293581, decouple_loss:0.001603283453732729
The modified gen p mean: 0.4482702612876892, gen p mean: -0.2397857904434204, mean p set: 0.44879910349845886
loss_pred:0.014671004377305508, decouple_loss:0.0015465897740796208
The modified gen p mean: 0.4493047297000885, gen p mean: -0.24213378131389618, mean p set: 0.4498290419578552
loss_pred:0.01442638412117958, decouple_loss:0.0017263416666537523
WV_1_PC_1_EH_0_PS_30, loss: 0.014729629270732403, avg_mse: 0.021708481013774872
current test mse: 0.021708
Iteration: 5551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466971755027771, gen p mean: -0.24737651646137238, mean p set: 0.4472668468952179
loss_pred:0.01359911821782589, decouple_loss:0.0016199435340240598
The modified gen p mean: 0.4470332860946655, gen p mean: -0.23838992416858673, mean p set: 0.44760966300964355
loss_pred:0.014052563346922398, decouple_loss:0.0017161834985017776
The modified gen p mean: 0.4466617703437805, gen p mean: -0.2415628731250763, mean p set: 0.447183758020401
loss_pred:0.013989015482366085, decouple_loss:0.0015545650385320187
Iteration: 5552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469311237335205, gen p mean: -0.24042481184005737, mean p set: 0.4474572241306305
loss_pred:0.01370694488286972, decouple_loss:0.0018720702501013875
The modified gen p mean: 0.44686007499694824, gen p mean: -0.24136897921562195, mean p set: 0.4474301338195801
loss_pred:0.013657348230481148, decouple_loss:0.0016950825229287148
The modified gen p mean: 0.44672060012817383, gen p mean: -0.24187099933624268, mean p set: 0.44729331135749817
loss_pred:0.013863583095371723, decouple_loss:0.0016651175683364272
Iteration: 5553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451592266559601, gen p mean: -0.24140383303165436, mean p set: 0.4456845819950104
loss_pred:0.013730252161622047, decouple_loss:0.0016705479938536882
The modified gen p mean: 0.4472489655017853, gen p mean: -0.2464059740304947, mean p set: 0.44782721996307373
loss_pred:0.013451091013848782, decouple_loss:0.0015611061826348305
The modified gen p mean: 0.4468887746334076, gen p mean: -0.2416880875825882, mean p set: 0.44746461510658264
loss_pred:0.013751907274127007, decouple_loss:0.0016158240614458919
Iteration: 5554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719868898391724, gen p mean: -0.237065851688385, mean p set: 0.4477333426475525
loss_pred:0.014618730172514915, decouple_loss:0.0017078685341402888
The modified gen p mean: 0.4466991722583771, gen p mean: -0.23960384726524353, mean p set: 0.44727569818496704
loss_pred:0.013575667515397072, decouple_loss:0.0018375619547441602
The modified gen p mean: 0.44659239053726196, gen p mean: -0.23313657939434052, mean p set: 0.4471670687198639
loss_pred:0.013573340140283108, decouple_loss:0.0017494156491011381
Iteration: 5555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465262293815613, gen p mean: -0.2369881272315979, mean p set: 0.4471038281917572
loss_pred:0.014108305796980858, decouple_loss:0.0017168223857879639
The modified gen p mean: 0.44606584310531616, gen p mean: -0.24428032338619232, mean p set: 0.44659578800201416The modified gen p mean: 0.44670534133911133, gen p mean: -0.24001473188400269, mean p set: 0.44728413224220276
loss_pred:0.013485906645655632, decouple_loss:0.0017507867887616158
loss_pred:0.013653910718858242, decouple_loss:0.0016396447317674756
Iteration: 5556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643011689186096, gen p mean: -0.24135832488536835, mean p set: 0.4470020830631256
loss_pred:0.013798697851598263, decouple_loss:0.0015749719459563494
The modified gen p mean: 0.4475423991680145, gen p mean: -0.2404332011938095, mean p set: 0.44807347655296326The modified gen p mean: 0.4469575583934784, gen p mean: -0.23834195733070374, mean p set: 0.4475364685058594
loss_pred:0.013588852249085903, decouple_loss:0.0014347584219649434
loss_pred:0.014015941880643368, decouple_loss:0.0014517620438709855
Iteration: 5557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459630846977234, gen p mean: -0.23821890354156494, mean p set: 0.44653791189193726
loss_pred:0.013972069136798382, decouple_loss:0.0015966938808560371
The modified gen p mean: 0.4466288387775421, gen p mean: -0.23830439150333405, mean p set: 0.4471467435359955
The modified gen p mean: 0.44760245084762573, gen p mean: -0.23349207639694214, mean p set: 0.44818106293678284
loss_pred:0.013531463220715523, decouple_loss:0.0015471373917534947
loss_pred:0.013309046626091003, decouple_loss:0.0016869994578883052
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478563368320465, gen p mean: -0.24143892526626587, mean p set: 0.44842633605003357
loss_pred:0.013100472278892994, decouple_loss:0.0014642534079030156
The modified gen p mean: 0.4469722807407379, gen p mean: -0.23576141893863678, mean p set: 0.44749704003334045The modified gen p mean: 0.44622570276260376, gen p mean: -0.24225886166095734, mean p set: 0.44680705666542053
loss_pred:0.013786213472485542, decouple_loss:0.0014466776046901941
loss_pred:0.01447380892932415, decouple_loss:0.001578145776875317
Iteration: 5559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44624319672584534, gen p mean: -0.23957087099552155, mean p set: 0.44682133197784424
loss_pred:0.0137123828753829, decouple_loss:0.0014873314648866653
The modified gen p mean: 0.44602155685424805, gen p mean: -0.2346697598695755, mean p set: 0.4466037154197693
loss_pred:0.014049721881747246, decouple_loss:0.0016107804840430617
The modified gen p mean: 0.44532638788223267, gen p mean: -0.2370270937681198, mean p set: 0.445857435464859
loss_pred:0.013975564390420914, decouple_loss:0.0016478420002385974
Iteration: 5560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668638706207275, gen p mean: -0.23811672627925873, mean p set: 0.44726231694221497
loss_pred:0.01344431284815073, decouple_loss:0.0016357704298570752
The modified gen p mean: 0.44557470083236694, gen p mean: -0.2411492019891739, mean p set: 0.4461512565612793
loss_pred:0.013663135468959808, decouple_loss:0.001603536307811737
The modified gen p mean: 0.4468364417552948, gen p mean: -0.2384738028049469, mean p set: 0.4473608434200287
loss_pred:0.013837565667927265, decouple_loss:0.0017072808695957065
2023-04-28 05:31:14 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23787567019462585, mean p set: 0.4499112665653229
loss_pred:0.014857430011034012, decouple_loss:0.0018565533682703972
The modified gen p mean: 0.4482678771018982, gen p mean: -0.23587048053741455, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930222630500793, gen p mean: -0.2383154332637787, mean p set: 0.4498290419578552
loss_pred:0.014695868827402592, decouple_loss:0.0018138964660465717
loss_pred:0.014372232370078564, decouple_loss:0.0016742899315431714
WV_1_PC_1_EH_0_PS_30, loss: 0.014730922877788544, avg_mse: 0.02170567959547043
current test mse: 0.021706
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 5561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789963960647583, gen p mean: -0.2372695803642273, mean p set: 0.44842812418937683
loss_pred:0.013845185749232769, decouple_loss:0.001794626354239881
The modified gen p mean: 0.44707465171813965, gen p mean: -0.24164430797100067, mean p set: 0.44765499234199524
loss_pred:0.013905894942581654, decouple_loss:0.0019411088433116674
The modified gen p mean: 0.4475959837436676, gen p mean: -0.2384018898010254, mean p set: 0.44817930459976196
loss_pred:0.013763125985860825, decouple_loss:0.0017941625555977225
Iteration: 5562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465772807598114, gen p mean: -0.2400326281785965, mean p set: 0.4471038579940796
loss_pred:0.014580963179469109, decouple_loss:0.0016323972959071398
The modified gen p mean: 0.44795238971710205, gen p mean: -0.2427080124616623, mean p set: 0.4485190510749817The modified gen p mean: 0.446857213973999, gen p mean: -0.2435278445482254, mean p set: 0.4474334716796875
loss_pred:0.014110876247286797, decouple_loss:0.0015529276570305228
loss_pred:0.013998718932271004, decouple_loss:0.001756938174366951
Iteration: 5563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483523964881897, gen p mean: -0.2397080659866333, mean p set: 0.44888240098953247
loss_pred:0.013161328621208668, decouple_loss:0.0021170959807932377
The modified gen p mean: 0.4471149444580078, gen p mean: -0.24358521401882172, mean p set: 0.4476839005947113The modified gen p mean: 0.4468141794204712, gen p mean: -0.2455817013978958, mean p set: 0.44739529490470886
loss_pred:0.012742739170789719, decouple_loss:0.0020579216070473194
loss_pred:0.013232138007879257, decouple_loss:0.0021077319979667664
Iteration: 5564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699230790138245, gen p mean: -0.2429204285144806, mean p set: 0.44751641154289246
loss_pred:0.013439173810184002, decouple_loss:0.0016956334002315998
The modified gen p mean: 0.446539044380188, gen p mean: -0.2514095604419708, mean p set: 0.4471111297607422
loss_pred:0.013312581926584244, decouple_loss:0.0016799526056274772
The modified gen p mean: 0.4473600685596466, gen p mean: -0.24569468200206757, mean p set: 0.447934627532959
loss_pred:0.013961000367999077, decouple_loss:0.001607273006811738
Iteration: 5565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816604256629944, gen p mean: -0.23594363033771515, mean p set: 0.44869264960289
loss_pred:0.013285890221595764, decouple_loss:0.0018769375747069716
The modified gen p mean: 0.4460528492927551, gen p mean: -0.2445293515920639, mean p set: 0.44662564992904663The modified gen p mean: 0.44718053936958313, gen p mean: -0.23412169516086578, mean p set: 0.4477570950984955
loss_pred:0.014112948440015316, decouple_loss:0.001636085333302617
loss_pred:0.013272494077682495, decouple_loss:0.001664999290369451
Iteration: 5566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472814202308655, gen p mean: -0.23918797075748444, mean p set: 0.44785767793655396
loss_pred:0.014062161557376385, decouple_loss:0.001762814586982131
The modified gen p mean: 0.4477524161338806, gen p mean: -0.2346847504377365, mean p set: 0.44832831621170044The modified gen p mean: 0.4468449354171753, gen p mean: -0.24179714918136597, mean p set: 0.4473738372325897
loss_pred:0.014072614721953869, decouple_loss:0.0019008837407454848
loss_pred:0.012886950746178627, decouple_loss:0.0017541090492159128
Iteration: 5567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661733508110046, gen p mean: -0.24049031734466553, mean p set: 0.4471876323223114
loss_pred:0.013796055689454079, decouple_loss:0.0017913815099745989
The modified gen p mean: 0.4467445909976959, gen p mean: -0.2340490221977234, mean p set: 0.44732168316841125
loss_pred:0.01308309193700552, decouple_loss:0.0017084017163142562
The modified gen p mean: 0.447114497423172, gen p mean: -0.232854425907135, mean p set: 0.4476470947265625
loss_pred:0.013128452003002167, decouple_loss:0.0018106559291481972
Iteration: 5568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757142663002014, gen p mean: -0.2340877503156662, mean p set: 0.44814640283584595
The modified gen p mean: 0.4481469690799713, gen p mean: -0.23346419632434845, mean p set: 0.44872787594795227loss_pred:0.013784337788820267, decouple_loss:0.0018641126807779074
loss_pred:0.012668644078075886, decouple_loss:0.0019782946910709143
The modified gen p mean: 0.44870397448539734, gen p mean: -0.23734444379806519, mean p set: 0.44923636317253113
loss_pred:0.012877780012786388, decouple_loss:0.0019892584532499313
Iteration: 5569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466942548751831, gen p mean: -0.23925502598285675, mean p set: 0.4472716748714447
loss_pred:0.014091044664382935, decouple_loss:0.0022411176469177008
The modified gen p mean: 0.4466005563735962, gen p mean: -0.2416360080242157, mean p set: 0.44713205099105835The modified gen p mean: 0.44729527831077576, gen p mean: -0.2340644747018814, mean p set: 0.44786933064460754
loss_pred:0.01367805153131485, decouple_loss:0.0017310690600425005
loss_pred:0.013392346911132336, decouple_loss:0.002089482033625245
Iteration: 5570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729527831077576, gen p mean: -0.23979659378528595, mean p set: 0.4478755593299866
loss_pred:0.013796297833323479, decouple_loss:0.0018741060048341751
The modified gen p mean: 0.4462818205356598, gen p mean: -0.2424096316099167, mean p set: 0.4468553960323334
loss_pred:0.01352616772055626, decouple_loss:0.0015934220282360911
The modified gen p mean: 0.44664639234542847, gen p mean: -0.2378028780221939, mean p set: 0.44717565178871155
loss_pred:0.013814088888466358, decouple_loss:0.0018392036436125636
2023-04-28 05:35:28 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2317921221256256, mean p set: 0.4499112665653229
loss_pred:0.014971989206969738, decouple_loss:0.002113002585247159
The modified gen p mean: 0.44929736852645874, gen p mean: -0.23228003084659576, mean p set: 0.4498290419578552
The modified gen p mean: 0.4482685625553131, gen p mean: -0.22968243062496185, mean p set: 0.44879910349845886
loss_pred:0.014472358860075474, decouple_loss:0.00209075678139925
loss_pred:0.014854881912469864, decouple_loss:0.0020832172594964504
WV_1_PC_1_EH_0_PS_30, loss: 0.01487119309604168, avg_mse: 0.021884914487600327
current test mse: 0.021885
Iteration: 5571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686228036880493, gen p mean: -0.23781435191631317, mean p set: 0.44743743538856506
loss_pred:0.01362842507660389, decouple_loss:0.002078494755551219
The modified gen p mean: 0.44657737016677856, gen p mean: -0.22602368891239166, mean p set: 0.4471050798892975
loss_pred:0.012945287860929966, decouple_loss:0.0020294873975217342
The modified gen p mean: 0.44675397872924805, gen p mean: -0.2301381677389145, mean p set: 0.4473371207714081
loss_pred:0.012731707654893398, decouple_loss:0.001773308147676289
Iteration: 5572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447418749332428, gen p mean: -0.23583786189556122, mean p set: 0.4479525089263916
loss_pred:0.013506096787750721, decouple_loss:0.0021910821087658405
The modified gen p mean: 0.4468435049057007, gen p mean: -0.23080597817897797, mean p set: 0.447416752576828
The modified gen p mean: 0.44710248708724976, gen p mean: -0.23381544649600983, mean p set: 0.4476735293865204
loss_pred:0.013103500939905643, decouple_loss:0.001875176909379661
loss_pred:0.013483620248734951, decouple_loss:0.002294708276167512
Iteration: 5573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716086983680725, gen p mean: -0.23174625635147095, mean p set: 0.44768741726875305
loss_pred:0.013240729458630085, decouple_loss:0.001470379182137549
The modified gen p mean: 0.4464358985424042, gen p mean: -0.23478963971138, mean p set: 0.4470112919807434
The modified gen p mean: 0.4471038579940796, gen p mean: -0.23223644495010376, mean p set: 0.4476739168167114
loss_pred:0.012634535320103168, decouple_loss:0.0019292847719043493
loss_pred:0.013837490230798721, decouple_loss:0.0015948464861139655
Iteration: 5574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477640688419342, gen p mean: -0.23843128979206085, mean p set: 0.4482881724834442
loss_pred:0.013469375669956207, decouple_loss:0.0015802278649061918
The modified gen p mean: 0.44692787528038025, gen p mean: -0.23577864468097687, mean p set: 0.4475066065788269
The modified gen p mean: 0.44597724080085754, gen p mean: -0.24167950451374054, mean p set: 0.4465501010417938
loss_pred:0.012629278004169464, decouple_loss:0.002222631825134158
loss_pred:0.013623183593153954, decouple_loss:0.002281465567648411
Iteration: 5575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805416464805603, gen p mean: -0.2351553589105606, mean p set: 0.4486280083656311
loss_pred:0.012952528893947601, decouple_loss:0.0016879120375961065
The modified gen p mean: 0.4471212327480316, gen p mean: -0.23213286697864532, mean p set: 0.44764676690101624The modified gen p mean: 0.4472184479236603, gen p mean: -0.23809975385665894, mean p set: 0.4477875828742981
loss_pred:0.013844378292560577, decouple_loss:0.0015949927037581801
loss_pred:0.013909547589719296, decouple_loss:0.0015236723702400923
Iteration: 5576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44600430130958557, gen p mean: -0.23471559584140778, mean p set: 0.4465774595737457
loss_pred:0.014177875593304634, decouple_loss:0.0015721183735877275
The modified gen p mean: 0.44663697481155396, gen p mean: -0.23709076642990112, mean p set: 0.44715800881385803The modified gen p mean: 0.4474605619907379, gen p mean: -0.24183495342731476, mean p set: 0.4480327367782593
loss_pred:0.013456271030008793, decouple_loss:0.0017812703736126423
loss_pred:0.012616642750799656, decouple_loss:0.0017849431606009603
Iteration: 5577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811660051345825, gen p mean: -0.23047901690006256, mean p set: 0.4486927390098572
loss_pred:0.012828723527491093, decouple_loss:0.0018641253700479865
The modified gen p mean: 0.44711387157440186, gen p mean: -0.23690129816532135, mean p set: 0.44764021039009094The modified gen p mean: 0.44719547033309937, gen p mean: -0.23129265010356903, mean p set: 0.4477759599685669
loss_pred:0.01397295854985714, decouple_loss:0.0016390284290537238
loss_pred:0.013796724379062653, decouple_loss:0.001755264587700367
Iteration: 5578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480786621570587, gen p mean: -0.23483490943908691, mean p set: 0.4486611485481262
loss_pred:0.013854312710464, decouple_loss:0.0015363224083557725
The modified gen p mean: 0.44802215695381165, gen p mean: -0.229874387383461, mean p set: 0.44860100746154785
loss_pred:0.013327307067811489, decouple_loss:0.0016646203584969044
The modified gen p mean: 0.4464794397354126, gen p mean: -0.2376118302345276, mean p set: 0.4470026195049286
loss_pred:0.013568930327892303, decouple_loss:0.0015713858883827925
Iteration: 5579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720205664634705, gen p mean: -0.23423932492733002, mean p set: 0.4477759003639221
loss_pred:0.01324729435145855, decouple_loss:0.0018319830996915698
The modified gen p mean: 0.4480510652065277, gen p mean: -0.22947373986244202, mean p set: 0.44862768054008484
loss_pred:0.013030338101089, decouple_loss:0.0016939217457547784
The modified gen p mean: 0.44635331630706787, gen p mean: -0.23006480932235718, mean p set: 0.44688504934310913
loss_pred:0.01314367726445198, decouple_loss:0.0015460677677765489
Iteration: 5580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465157389640808, gen p mean: -0.23895703256130219, mean p set: 0.44708362221717834
loss_pred:0.013395641930401325, decouple_loss:0.0014181147562339902
The modified gen p mean: 0.447217732667923, gen p mean: -0.2365822046995163, mean p set: 0.4477977156639099
loss_pred:0.013125874102115631, decouple_loss:0.0014436469646170735
The modified gen p mean: 0.4474905729293823, gen p mean: -0.2361108362674713, mean p set: 0.44801655411720276
loss_pred:0.01240045577287674, decouple_loss:0.0014383986126631498
2023-04-28 05:38:52 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.240035742521286, mean p set: 0.4499112665653229
loss_pred:0.014984340406954288, decouple_loss:0.0017496882937848568
The modified gen p mean: 0.4492979645729065, gen p mean: -0.2408493012189865, mean p set: 0.4498290419578552
The modified gen p mean: 0.4482671022415161, gen p mean: -0.23808825016021729, mean p set: 0.44879910349845886
loss_pred:0.014541187323629856, decouple_loss:0.0015828462783247232
loss_pred:0.014848584309220314, decouple_loss:0.0015981628093868494
WV_1_PC_1_EH_0_PS_30, loss: 0.014873549342155457, avg_mse: 0.02196992188692093
current test mse: 0.02197
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 5581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490700662136078, gen p mean: -0.2358292192220688, mean p set: 0.44959837198257446
loss_pred:0.014257022179663181, decouple_loss:0.0016695380909368396
The modified gen p mean: 0.44853904843330383, gen p mean: -0.23950695991516113, mean p set: 0.4491119980812073
loss_pred:0.014615822583436966, decouple_loss:0.001628722995519638
The modified gen p mean: 0.4502805471420288, gen p mean: -0.2320777326822281, mean p set: 0.4508661925792694
loss_pred:0.013605993241071701, decouple_loss:0.0018870029598474503
Iteration: 5582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834643602371216, gen p mean: -0.2358725666999817, mean p set: 0.4488740861415863
loss_pred:0.01401347853243351, decouple_loss:0.001604947610758245
The modified gen p mean: 0.4491446912288666, gen p mean: -0.23885352909564972, mean p set: 0.4497183561325073
The modified gen p mean: 0.4479585886001587, gen p mean: -0.23856614530086517, mean p set: 0.4485381245613098
loss_pred:0.014050581492483616, decouple_loss:0.00166406505741179
loss_pred:0.014728736132383347, decouple_loss:0.0015018549747765064
Iteration: 5583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938522577285767, gen p mean: -0.23554062843322754, mean p set: 0.44991418719291687
loss_pred:0.013843236491084099, decouple_loss:0.001559215015731752
The modified gen p mean: 0.4491831064224243, gen p mean: -0.2290288507938385, mean p set: 0.4497552812099457
The modified gen p mean: 0.4489095211029053, gen p mean: -0.23913727700710297, mean p set: 0.44949063658714294
loss_pred:0.01342893484979868, decouple_loss:0.0017818481428548694
loss_pred:0.01363037247210741, decouple_loss:0.0016827575163915753
Iteration: 5584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497857689857483, gen p mean: -0.23956789076328278, mean p set: 0.4503171145915985
loss_pred:0.013660186901688576, decouple_loss:0.0016885091317817569
The modified gen p mean: 0.44967785477638245, gen p mean: -0.2362847924232483, mean p set: 0.45026013255119324
The modified gen p mean: 0.4489419162273407, gen p mean: -0.23802462220191956, mean p set: 0.4495182931423187
loss_pred:0.0138862831518054, decouple_loss:0.0014236402930691838
loss_pred:0.013508603908121586, decouple_loss:0.001518926816061139
Iteration: 5585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487646222114563, gen p mean: -0.2289382368326187, mean p set: 0.4493391215801239
loss_pred:0.013673214241862297, decouple_loss:0.001646616030484438
The modified gen p mean: 0.4507756531238556, gen p mean: -0.2269524782896042, mean p set: 0.45130491256713867The modified gen p mean: 0.4491943418979645, gen p mean: -0.23101955652236938, mean p set: 0.4497663974761963
loss_pred:0.01336686871945858, decouple_loss:0.0020607297774404287
loss_pred:0.013407204300165176, decouple_loss:0.002211807295680046
Iteration: 5586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056554675102234, gen p mean: -0.22802521288394928, mean p set: 0.451143354177475
loss_pred:0.013807387091219425, decouple_loss:0.0015427444595843554
The modified gen p mean: 0.44832509756088257, gen p mean: -0.2298172265291214, mean p set: 0.44885316491127014The modified gen p mean: 0.449165940284729, gen p mean: -0.22800767421722412, mean p set: 0.4497471749782562
loss_pred:0.013014552183449268, decouple_loss:0.0018938274588435888
loss_pred:0.013931361958384514, decouple_loss:0.0016302622389048338
Iteration: 5587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490995407104492, gen p mean: -0.23517319560050964, mean p set: 0.44967731833457947
loss_pred:0.013553326949477196, decouple_loss:0.0016978192143142223
The modified gen p mean: 0.44924458861351013, gen p mean: -0.2333395928144455, mean p set: 0.4497673809528351The modified gen p mean: 0.4504874050617218, gen p mean: -0.22961704432964325, mean p set: 0.45106619596481323
loss_pred:0.013130409643054008, decouple_loss:0.0017279858002439141
loss_pred:0.013964354991912842, decouple_loss:0.0017004350665956736
Iteration: 5588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969040155410767, gen p mean: -0.2341165840625763, mean p set: 0.4502677023410797
loss_pred:0.01376788318157196, decouple_loss:0.001739302184432745
The modified gen p mean: 0.45001479983329773, gen p mean: -0.2290395051240921, mean p set: 0.4505905210971832
loss_pred:0.013733331114053726, decouple_loss:0.0015740313101559877
The modified gen p mean: 0.4501817524433136, gen p mean: -0.2283991277217865, mean p set: 0.45070981979370117
loss_pred:0.013425148092210293, decouple_loss:0.0018694809405133128
Iteration: 5589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475671648979187, gen p mean: -0.23617514967918396, mean p set: 0.44813892245292664
loss_pred:0.014557708986103535, decouple_loss:0.0014996823156252503
The modified gen p mean: 0.4495599865913391, gen p mean: -0.23583190143108368, mean p set: 0.45013657212257385
loss_pred:0.013542281463742256, decouple_loss:0.0016198537778109312
The modified gen p mean: 0.4496269226074219, gen p mean: -0.23222766816616058, mean p set: 0.4501534700393677
loss_pred:0.013719283975660801, decouple_loss:0.0016402462497353554
Iteration: 5590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997259974479675, gen p mean: -0.230276420712471, mean p set: 0.4505513906478882
loss_pred:0.013217305764555931, decouple_loss:0.0020076970104128122
The modified gen p mean: 0.44794318079948425, gen p mean: -0.23311926424503326, mean p set: 0.44851261377334595
loss_pred:0.01293894276022911, decouple_loss:0.0016971863806247711
The modified gen p mean: 0.4501400887966156, gen p mean: -0.22900129854679108, mean p set: 0.45066767930984497
loss_pred:0.01396271027624607, decouple_loss:0.0019028965616598725
2023-04-28 05:43:03 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23735857009887695, mean p set: 0.4499112665653229
loss_pred:0.014981023035943508, decouple_loss:0.0016212096670642495
The modified gen p mean: 0.4482698142528534, gen p mean: -0.23521605134010315, mean p set: 0.44879910349845886
loss_pred:0.01481432281434536, decouple_loss:0.0015865628374740481
The modified gen p mean: 0.4493017792701721, gen p mean: -0.23780134320259094, mean p set: 0.4498290419578552
loss_pred:0.014522239565849304, decouple_loss:0.0016679310938343406
WV_1_PC_1_EH_0_PS_30, loss: 0.014853790402412415, avg_mse: 0.021880805492401123
current test mse: 0.021881
Iteration: 5591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492664933204651, gen p mean: -0.24049699306488037, mean p set: 0.4498424530029297
loss_pred:0.013773160986602306, decouple_loss:0.0016498371260240674
The modified gen p mean: 0.448546439409256, gen p mean: -0.23465776443481445, mean p set: 0.44906798005104065
loss_pred:0.01370328851044178, decouple_loss:0.0015246040420606732
The modified gen p mean: 0.45019862055778503, gen p mean: -0.22829444706439972, mean p set: 0.4507763385772705
loss_pred:0.013380163349211216, decouple_loss:0.0016293711960315704
Iteration: 5592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508548676967621, gen p mean: -0.2335878610610962, mean p set: 0.45138660073280334
loss_pred:0.013382093980908394, decouple_loss:0.001528973109088838
The modified gen p mean: 0.4491099715232849, gen p mean: -0.24058949947357178, mean p set: 0.4496835172176361
loss_pred:0.013700336217880249, decouple_loss:0.001470108050853014
The modified gen p mean: 0.44917163252830505, gen p mean: -0.23676413297653198, mean p set: 0.4497511684894562
loss_pred:0.0140119269490242, decouple_loss:0.0016617396613582969
Iteration: 5593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889506697654724, gen p mean: -0.23455582559108734, mean p set: 0.4494198262691498
loss_pred:0.014282151125371456, decouple_loss:0.0017668502405285835
The modified gen p mean: 0.44960084557533264, gen p mean: -0.23594439029693604, mean p set: 0.45017269253730774
loss_pred:0.013770733959972858, decouple_loss:0.0015346907312050462
The modified gen p mean: 0.44864413142204285, gen p mean: -0.23913565278053284, mean p set: 0.449221134185791
loss_pred:0.013314580544829369, decouple_loss:0.0017010392621159554
Iteration: 5594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007601380348206, gen p mean: -0.2282436639070511, mean p set: 0.4506046175956726
loss_pred:0.013868049718439579, decouple_loss:0.001626542187295854
The modified gen p mean: 0.4490990936756134, gen p mean: -0.23209451138973236, mean p set: 0.4496765732765198
loss_pred:0.014158889651298523, decouple_loss:0.0016598597867414355
The modified gen p mean: 0.4490876793861389, gen p mean: -0.23047131299972534, mean p set: 0.4496645927429199
loss_pred:0.01345618162304163, decouple_loss:0.0014802287332713604
Iteration: 5595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500412344932556, gen p mean: -0.22900651395320892, mean p set: 0.4506189823150635
loss_pred:0.013444257900118828, decouple_loss:0.0015775255160406232
The modified gen p mean: 0.4485619068145752, gen p mean: -0.23407623171806335, mean p set: 0.44908788800239563The modified gen p mean: 0.44873785972595215, gen p mean: -0.2338188737630844, mean p set: 0.4493071436882019
loss_pred:0.014306486584246159, decouple_loss:0.0015793968923389912
loss_pred:0.014497964642941952, decouple_loss:0.0018290502484887838
Iteration: 5596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893503189086914, gen p mean: -0.23099924623966217, mean p set: 0.4495089054107666
loss_pred:0.013572621159255505, decouple_loss:0.00157171452883631
The modified gen p mean: 0.447931706905365, gen p mean: -0.2370326817035675, mean p set: 0.44850999116897583The modified gen p mean: 0.44846534729003906, gen p mean: -0.23565255105495453, mean p set: 0.448993444442749
loss_pred:0.013709462247788906, decouple_loss:0.001979011343792081
loss_pred:0.013835841789841652, decouple_loss:0.0017846832051873207
Iteration: 5597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495996832847595, gen p mean: -0.2334275096654892, mean p set: 0.4501734673976898
loss_pred:0.013567554764449596, decouple_loss:0.0014616097323596478
The modified gen p mean: 0.4481804072856903, gen p mean: -0.23442846536636353, mean p set: 0.44870686531066895The modified gen p mean: 0.4487716853618622, gen p mean: -0.23014850914478302, mean p set: 0.44934147596359253
loss_pred:0.01373971439898014, decouple_loss:0.001429376075975597
loss_pred:0.014689436182379723, decouple_loss:0.0014641506131738424
Iteration: 5598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482761025428772, gen p mean: -0.23663067817687988, mean p set: 0.44884949922561646
loss_pred:0.014007085002958775, decouple_loss:0.0017108686733990908
The modified gen p mean: 0.4493861794471741, gen p mean: -0.2380540817975998, mean p set: 0.44996631145477295The modified gen p mean: 0.44942614436149597, gen p mean: -0.22866201400756836, mean p set: 0.44995465874671936
loss_pred:0.013392498716711998, decouple_loss:0.001663405797444284
loss_pred:0.013354967348277569, decouple_loss:0.0019846586510539055
Iteration: 5599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507145583629608, gen p mean: -0.2286657691001892, mean p set: 0.45129016041755676
loss_pred:0.0136392368003726, decouple_loss:0.0016684761503711343
The modified gen p mean: 0.44787687063217163, gen p mean: -0.22974179685115814, mean p set: 0.44845327734947205
loss_pred:0.013034974224865437, decouple_loss:0.0015193196013569832
The modified gen p mean: 0.4496017396450043, gen p mean: -0.22824521362781525, mean p set: 0.45013123750686646
loss_pred:0.013550471514463425, decouple_loss:0.0016263643046841025
Iteration: 5600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990891218185425, gen p mean: -0.2296241670846939, mean p set: 0.4504837691783905
loss_pred:0.013607676140964031, decouple_loss:0.0017221366288140416
The modified gen p mean: 0.44836774468421936, gen p mean: -0.2370382845401764, mean p set: 0.4489458501338959
loss_pred:0.013534026220440865, decouple_loss:0.0021584692876785994
The modified gen p mean: 0.4488683044910431, gen p mean: -0.23022648692131042, mean p set: 0.4493984878063202
loss_pred:0.014012448489665985, decouple_loss:0.001715035759843886
2023-04-28 05:46:28 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23273946344852448, mean p set: 0.4499112665653229
loss_pred:0.014989729039371014, decouple_loss:0.001890836050733924
The modified gen p mean: 0.4493007957935333, gen p mean: -0.2332863062620163, mean p set: 0.4498290419578552
The modified gen p mean: 0.4482673406600952, gen p mean: -0.2304963618516922, mean p set: 0.44879910349845886
loss_pred:0.014491320587694645, decouple_loss:0.0018080491572618484
loss_pred:0.014814482070505619, decouple_loss:0.0017488517332822084
WV_1_PC_1_EH_0_PS_30, loss: 0.014855973422527313, avg_mse: 0.021884728223085403
current test mse: 0.021885
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 5601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479927718639374, gen p mean: -0.23471271991729736, mean p set: 0.4485260546207428
loss_pred:0.01392161101102829, decouple_loss:0.0016723443986847997
The modified gen p mean: 0.44652459025382996, gen p mean: -0.23379328846931458, mean p set: 0.44709280133247375
loss_pred:0.01364674512296915, decouple_loss:0.001768113812431693
The modified gen p mean: 0.44536522030830383, gen p mean: -0.23294785618782043, mean p set: 0.44594070315361023
loss_pred:0.013628458604216576, decouple_loss:0.0017756314482539892
Iteration: 5602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469683766365051, gen p mean: -0.2386791855096817, mean p set: 0.44750016927719116
loss_pred:0.015105467289686203, decouple_loss:0.0017939488170668483
The modified gen p mean: 0.4472496509552002, gen p mean: -0.23744460940361023, mean p set: 0.44783279299736023
The modified gen p mean: 0.44645291566848755, gen p mean: -0.23517248034477234, mean p set: 0.4470318555831909
loss_pred:0.013899406418204308, decouple_loss:0.0017224622424691916
loss_pred:0.013840606436133385, decouple_loss:0.001884513651020825
Iteration: 5603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731995463371277, gen p mean: -0.2434847354888916, mean p set: 0.4478478729724884
loss_pred:0.013411850668489933, decouple_loss:0.0016801252495497465
The modified gen p mean: 0.4483017027378082, gen p mean: -0.24109286069869995, mean p set: 0.44887736439704895
The modified gen p mean: 0.44689562916755676, gen p mean: -0.24438747763633728, mean p set: 0.4474697411060333
loss_pred:0.014274422079324722, decouple_loss:0.0017222592141479254
loss_pred:0.013573029078543186, decouple_loss:0.001835033530369401
Iteration: 5604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446842223405838, gen p mean: -0.24337062239646912, mean p set: 0.4473719894886017
loss_pred:0.014141261577606201, decouple_loss:0.0016408064402639866
The modified gen p mean: 0.445760041475296, gen p mean: -0.24524971842765808, mean p set: 0.4463326036930084
The modified gen p mean: 0.447078675031662, gen p mean: -0.24139024317264557, mean p set: 0.44765836000442505
loss_pred:0.013260292820632458, decouple_loss:0.0014775160234421492
loss_pred:0.014412852004170418, decouple_loss:0.0016636964865028858
Iteration: 5605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486742615699768, gen p mean: -0.24499066174030304, mean p set: 0.4492546021938324
loss_pred:0.013800298795104027, decouple_loss:0.0015043204184621572
The modified gen p mean: 0.44628602266311646, gen p mean: -0.24423006176948547, mean p set: 0.44681257009506226The modified gen p mean: 0.447395920753479, gen p mean: -0.24682682752609253, mean p set: 0.447966605424881
loss_pred:0.013377800583839417, decouple_loss:0.0015119294403120875
loss_pred:0.013417478650808334, decouple_loss:0.0014675325946882367
Iteration: 5606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474366307258606, gen p mean: -0.23996886610984802, mean p set: 0.4480137526988983
loss_pred:0.013781161978840828, decouple_loss:0.0018648704281076789
The modified gen p mean: 0.44658222794532776, gen p mean: -0.2445792853832245, mean p set: 0.4471190571784973The modified gen p mean: 0.4466129243373871, gen p mean: -0.24556474387645721, mean p set: 0.44718244671821594
loss_pred:0.013425170443952084, decouple_loss:0.001579575939103961
loss_pred:0.01322835125029087, decouple_loss:0.0015766237629577518
Iteration: 5607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469456076622009, gen p mean: -0.2378704994916916, mean p set: 0.447516530752182
loss_pred:0.01400240883231163, decouple_loss:0.0015090557280927896
The modified gen p mean: 0.4465932846069336, gen p mean: -0.2379998415708542, mean p set: 0.4471677839756012The modified gen p mean: 0.4482201039791107, gen p mean: -0.2389269471168518, mean p set: 0.44875115156173706
loss_pred:0.013523122295737267, decouple_loss:0.0014432246098294854
loss_pred:0.014213085174560547, decouple_loss:0.0016352998791262507
Iteration: 5608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483488202095032, gen p mean: -0.2362840473651886, mean p set: 0.44892388582229614
loss_pred:0.014173992909491062, decouple_loss:0.0017397782066836953
The modified gen p mean: 0.4469301700592041, gen p mean: -0.23737432062625885, mean p set: 0.4475100040435791
loss_pred:0.013253562152385712, decouple_loss:0.0018233653390780091
The modified gen p mean: 0.44669008255004883, gen p mean: -0.23612883687019348, mean p set: 0.4472208023071289
loss_pred:0.013701782561838627, decouple_loss:0.001968851312994957
Iteration: 5609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447884738445282, gen p mean: -0.24011264741420746, mean p set: 0.44845691323280334
loss_pred:0.013742639683187008, decouple_loss:0.0016426792135462165
The modified gen p mean: 0.4481838345527649, gen p mean: -0.23648601770401, mean p set: 0.44875821471214294
loss_pred:0.014043360948562622, decouple_loss:0.0015926291234791279
The modified gen p mean: 0.4461040794849396, gen p mean: -0.23630639910697937, mean p set: 0.4466286599636078
loss_pred:0.013670414686203003, decouple_loss:0.0015543188201263547
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44543030858039856, gen p mean: -0.23844994604587555, mean p set: 0.44600710272789
loss_pred:0.013995388522744179, decouple_loss:0.001524526858702302
The modified gen p mean: 0.44867464900016785, gen p mean: -0.23937128484249115, mean p set: 0.44924843311309814
loss_pred:0.013885879889130592, decouple_loss:0.0017107099993154407
The modified gen p mean: 0.4463847279548645, gen p mean: -0.23779389262199402, mean p set: 0.44692057371139526
loss_pred:0.013522527180612087, decouple_loss:0.0017309347167611122
2023-04-28 05:50:40 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24028901755809784, mean p set: 0.4499112665653229
loss_pred:0.01489782240241766, decouple_loss:0.0020839760545641184
The modified gen p mean: 0.44929811358451843, gen p mean: -0.2408369928598404, mean p set: 0.4498290419578552
The modified gen p mean: 0.4482681155204773, gen p mean: -0.2383841723203659, mean p set: 0.44879910349845886
loss_pred:0.014354695565998554, decouple_loss:0.0020203397143632174
loss_pred:0.014691805467009544, decouple_loss:0.001850801520049572
WV_1_PC_1_EH_0_PS_30, loss: 0.014747358858585358, avg_mse: 0.021766740828752518
current test mse: 0.021767
Iteration: 5611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475880563259125, gen p mean: -0.24418608844280243, mean p set: 0.44815176725387573
loss_pred:0.013418526388704777, decouple_loss:0.0017130797496065497
The modified gen p mean: 0.44735389947891235, gen p mean: -0.24166299402713776, mean p set: 0.44787725806236267
loss_pred:0.014335691928863525, decouple_loss:0.0021195171866565943
The modified gen p mean: 0.44687619805336, gen p mean: -0.24035494029521942, mean p set: 0.44745346903800964
loss_pred:0.014320905320346355, decouple_loss:0.001674362109042704
Iteration: 5612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708937406539917, gen p mean: -0.24687454104423523, mean p set: 0.44762295484542847
loss_pred:0.013577239587903023, decouple_loss:0.001734292833134532
The modified gen p mean: 0.4464138448238373, gen p mean: -0.24515171349048615, mean p set: 0.4469849467277527
The modified gen p mean: 0.4467165768146515, gen p mean: -0.24727346003055573, mean p set: 0.4472857117652893
loss_pred:0.013504084199666977, decouple_loss:0.0015345279825851321
loss_pred:0.013425059616565704, decouple_loss:0.0014750887639820576
Iteration: 5613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636595249176025, gen p mean: -0.24652887880802155, mean p set: 0.4468908905982971
loss_pred:0.013388908468186855, decouple_loss:0.0017242158064618707
The modified gen p mean: 0.44772541522979736, gen p mean: -0.24828094244003296, mean p set: 0.44829845428466797
The modified gen p mean: 0.4465499520301819, gen p mean: -0.24878138303756714, mean p set: 0.4471312463283539
loss_pred:0.013092143461108208, decouple_loss:0.0016196032520383596
loss_pred:0.013340077362954617, decouple_loss:0.0016150686424225569
Iteration: 5614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492032825946808, gen p mean: -0.2429945170879364, mean p set: 0.44973060488700867
loss_pred:0.013643253594636917, decouple_loss:0.001463028253056109
The modified gen p mean: 0.4472769796848297, gen p mean: -0.24406518042087555, mean p set: 0.44785624742507935
The modified gen p mean: 0.4490707218647003, gen p mean: -0.24291948974132538, mean p set: 0.44964826107025146
loss_pred:0.013215708546340466, decouple_loss:0.0014121379936113954
loss_pred:0.013630627654492855, decouple_loss:0.00159194425214082
Iteration: 5615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475807547569275, gen p mean: -0.24319596588611603, mean p set: 0.4481556713581085
loss_pred:0.01360691525042057, decouple_loss:0.0015206574462354183
The modified gen p mean: 0.44733336567878723, gen p mean: -0.24514976143836975, mean p set: 0.44786328077316284The modified gen p mean: 0.44621121883392334, gen p mean: -0.23659954965114594, mean p set: 0.44678959250450134
loss_pred:0.013308338820934296, decouple_loss:0.0014986401656642556
loss_pred:0.013051936402916908, decouple_loss:0.0014124615117907524
Iteration: 5616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460463523864746, gen p mean: -0.24117852747440338, mean p set: 0.4466158449649811
loss_pred:0.01331101544201374, decouple_loss:0.001839535660110414
The modified gen p mean: 0.44635656476020813, gen p mean: -0.2423253059387207, mean p set: 0.44693562388420105The modified gen p mean: 0.4478202760219574, gen p mean: -0.24148225784301758, mean p set: 0.44834670424461365
loss_pred:0.013388598337769508, decouple_loss:0.0015573650598526
loss_pred:0.013952372595667839, decouple_loss:0.0015654730377718806
Iteration: 5617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468282163143158, gen p mean: -0.24479909241199493, mean p set: 0.44739779829978943
loss_pred:0.013566934503614902, decouple_loss:0.0014579812996089458
The modified gen p mean: 0.4471947252750397, gen p mean: -0.2428552806377411, mean p set: 0.44771912693977356The modified gen p mean: 0.4471958577632904, gen p mean: -0.24760645627975464, mean p set: 0.44777220487594604
loss_pred:0.013474000617861748, decouple_loss:0.0014563925797119737
loss_pred:0.013537261635065079, decouple_loss:0.0013159526279196143
Iteration: 5618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454357922077179, gen p mean: -0.23862464725971222, mean p set: 0.4460061490535736
loss_pred:0.013691384345293045, decouple_loss:0.001473484793677926
The modified gen p mean: 0.44700825214385986, gen p mean: -0.24720826745033264, mean p set: 0.4475838840007782
loss_pred:0.013678191229701042, decouple_loss:0.0014897853834554553
The modified gen p mean: 0.4470382034778595, gen p mean: -0.24399255216121674, mean p set: 0.4475601017475128
loss_pred:0.013850105926394463, decouple_loss:0.001577995135448873
Iteration: 5619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474738836288452, gen p mean: -0.2466071993112564, mean p set: 0.448056697845459
loss_pred:0.01337425410747528, decouple_loss:0.0013727840268984437
The modified gen p mean: 0.44641852378845215, gen p mean: -0.24328358471393585, mean p set: 0.4469926357269287
loss_pred:0.013812229968607426, decouple_loss:0.001269556931219995
The modified gen p mean: 0.44811713695526123, gen p mean: -0.23997753858566284, mean p set: 0.44864004850387573
loss_pred:0.014157953672111034, decouple_loss:0.0013269943883642554
Iteration: 5620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468362629413605, gen p mean: -0.24788953363895416, mean p set: 0.44740432500839233
loss_pred:0.013341395184397697, decouple_loss:0.0014681261964142323
The modified gen p mean: 0.44759228825569153, gen p mean: -0.2451447993516922, mean p set: 0.4481663107872009
loss_pred:0.014069649390876293, decouple_loss:0.0013907481916248798
The modified gen p mean: 0.44650688767433167, gen p mean: -0.24519193172454834, mean p set: 0.44703078269958496
loss_pred:0.013480983674526215, decouple_loss:0.0015582282794639468
2023-04-28 05:54:04 testing...
The modified gen p mean: 0.4494309723377228, gen p mean: -0.2427091896533966, mean p set: 0.4499112665653229
loss_pred:0.014923899434506893, decouple_loss:0.0015824135625734925
The modified gen p mean: 0.4482671916484833, gen p mean: -0.24070580303668976, mean p set: 0.44879910349845886
loss_pred:0.014741955325007439, decouple_loss:0.0013880478218197823
The modified gen p mean: 0.44930320978164673, gen p mean: -0.24323268234729767, mean p set: 0.4498290419578552
loss_pred:0.01435619592666626, decouple_loss:0.0015763015253469348
WV_1_PC_1_EH_0_PS_30, loss: 0.014749795198440552, avg_mse: 0.021789414808154106
current test mse: 0.021789
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 5621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448588103055954, gen p mean: -0.24089989066123962, mean p set: 0.44911903142929077
loss_pred:0.014268236234784126, decouple_loss:0.0013750804355368018
The modified gen p mean: 0.4489004909992218, gen p mean: -0.24311897158622742, mean p set: 0.44947290420532227
loss_pred:0.013987471349537373, decouple_loss:0.0014205833431333303
The modified gen p mean: 0.44791379570961, gen p mean: -0.23817898333072662, mean p set: 0.448492169380188
loss_pred:0.014787759631872177, decouple_loss:0.001330132014118135
Iteration: 5622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953131675720215, gen p mean: -0.2440338432788849, mean p set: 0.45005539059638977
loss_pred:0.014168818481266499, decouple_loss:0.0013503762893378735
The modified gen p mean: 0.44722646474838257, gen p mean: -0.2401386797428131, mean p set: 0.4478098452091217
loss_pred:0.015013035386800766, decouple_loss:0.0013841689797118306
The modified gen p mean: 0.4488316774368286, gen p mean: -0.24315480887889862, mean p set: 0.4494089186191559
loss_pred:0.014497287571430206, decouple_loss:0.0013689843472093344
Iteration: 5623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449248731136322, gen p mean: -0.23834380507469177, mean p set: 0.4497752785682678
loss_pred:0.01370527595281601, decouple_loss:0.0013836451107636094
The modified gen p mean: 0.4493550658226013, gen p mean: -0.243263840675354, mean p set: 0.449928879737854
loss_pred:0.014285622164607048, decouple_loss:0.0013653163332492113
The modified gen p mean: 0.44899097084999084, gen p mean: -0.24116192758083344, mean p set: 0.44956550002098083
loss_pred:0.014347221702337265, decouple_loss:0.0012447033077478409
Iteration: 5624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749176502227783, gen p mean: -0.24276825785636902, mean p set: 0.4480241537094116
loss_pred:0.014616219326853752, decouple_loss:0.0014998974511399865
The modified gen p mean: 0.4488554894924164, gen p mean: -0.23761926591396332, mean p set: 0.4494384229183197
loss_pred:0.013736870139837265, decouple_loss:0.0013674440560862422
The modified gen p mean: 0.4490625858306885, gen p mean: -0.24740514159202576, mean p set: 0.4496367573738098
loss_pred:0.01410611066967249, decouple_loss:0.0013409135863184929
Iteration: 5625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810760021209717, gen p mean: -0.24118098616600037, mean p set: 0.4486786425113678
loss_pred:0.014950656332075596, decouple_loss:0.0015498518478125334
The modified gen p mean: 0.4482927620410919, gen p mean: -0.2465016096830368, mean p set: 0.4488653242588043The modified gen p mean: 0.44890671968460083, gen p mean: -0.24682778120040894, mean p set: 0.4494372606277466
loss_pred:0.014356343075633049, decouple_loss:0.001516929012723267
loss_pred:0.013826428912580013, decouple_loss:0.0014839015202596784
Iteration: 5626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869205355644226, gen p mean: -0.24151675403118134, mean p set: 0.4492647647857666
loss_pred:0.014010300859808922, decouple_loss:0.0012995654251426458
The modified gen p mean: 0.44779109954833984, gen p mean: -0.2409714013338089, mean p set: 0.44836896657943726The modified gen p mean: 0.4483404755592346, gen p mean: -0.24516691267490387, mean p set: 0.4488733410835266
loss_pred:0.01474593486636877, decouple_loss:0.001381806330755353
loss_pred:0.01437495555728674, decouple_loss:0.0013411054387688637
Iteration: 5627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788414239883423, gen p mean: -0.23643219470977783, mean p set: 0.4484536051750183
loss_pred:0.014699810184538364, decouple_loss:0.0015890317736193538
The modified gen p mean: 0.44844162464141846, gen p mean: -0.23857064545154572, mean p set: 0.44901883602142334
loss_pred:0.013489619828760624, decouple_loss:0.0014875647611916065
The modified gen p mean: 0.4480791687965393, gen p mean: -0.24269093573093414, mean p set: 0.44861117005348206
loss_pred:0.014288090169429779, decouple_loss:0.001567848608829081
Iteration: 5628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489617943763733, gen p mean: -0.2417035698890686, mean p set: 0.4495360851287842
loss_pred:0.01437784917652607, decouple_loss:0.0014467971632257104
The modified gen p mean: 0.4481050670146942, gen p mean: -0.2402271032333374, mean p set: 0.4486761689186096
loss_pred:0.014263292774558067, decouple_loss:0.0014370257267728448
The modified gen p mean: 0.44808152318000793, gen p mean: -0.23756998777389526, mean p set: 0.4486114978790283
loss_pred:0.014636978507041931, decouple_loss:0.0014788644621148705
Iteration: 5629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859281182289124, gen p mean: -0.23486566543579102, mean p set: 0.4491669833660126
loss_pred:0.01401285920292139, decouple_loss:0.001605734694749117
The modified gen p mean: 0.44806328415870667, gen p mean: -0.23020626604557037, mean p set: 0.4486406445503235
loss_pred:0.01483179535716772, decouple_loss:0.0015153693966567516
The modified gen p mean: 0.4477376639842987, gen p mean: -0.23549969494342804, mean p set: 0.4482733905315399
loss_pred:0.014421628788113594, decouple_loss:0.0016604008851572871
Iteration: 5630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843271374702454, gen p mean: -0.23280566930770874, mean p set: 0.4490050673484802
loss_pred:0.014580813236534595, decouple_loss:0.001613294123671949
The modified gen p mean: 0.4494304955005646, gen p mean: -0.24160033464431763, mean p set: 0.4500062167644501
loss_pred:0.014115598052740097, decouple_loss:0.0020123706199228764
The modified gen p mean: 0.4477744698524475, gen p mean: -0.23527061939239502, mean p set: 0.4483001232147217
loss_pred:0.014353684149682522, decouple_loss:0.0015437500551342964
2023-04-28 05:58:26 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23866006731987, mean p set: 0.4499112665653229
loss_pred:0.014878550544381142, decouple_loss:0.0014774256851524115
The modified gen p mean: 0.44827863574028015, gen p mean: -0.23676836490631104, mean p set: 0.44879910349845886
loss_pred:0.014726315625011921, decouple_loss:0.0014307330129668117
The modified gen p mean: 0.4493023157119751, gen p mean: -0.23905275762081146, mean p set: 0.4498290419578552
loss_pred:0.014359826222062111, decouple_loss:0.0016095363534986973
WV_1_PC_1_EH_0_PS_30, loss: 0.014730192720890045, avg_mse: 0.021728599444031715
current test mse: 0.021729
Iteration: 5631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938772916793823, gen p mean: -0.24132463335990906, mean p set: 0.4499637186527252
loss_pred:0.01392632257193327, decouple_loss:0.0014866816345602274
The modified gen p mean: 0.4486072361469269, gen p mean: -0.24006980657577515, mean p set: 0.44917774200439453
loss_pred:0.014472702518105507, decouple_loss:0.0013422841439023614
The modified gen p mean: 0.44898679852485657, gen p mean: -0.23907524347305298, mean p set: 0.44951876997947693
loss_pred:0.014101581647992134, decouple_loss:0.0013640003744512796
Iteration: 5632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911134243011475, gen p mean: -0.24627430737018585, mean p set: 0.4496401250362396
loss_pred:0.01438457053154707, decouple_loss:0.001347073120996356
The modified gen p mean: 0.44846731424331665, gen p mean: -0.24623776972293854, mean p set: 0.4490435719490051
loss_pred:0.013940648175776005, decouple_loss:0.0013956509064882994
The modified gen p mean: 0.4487873911857605, gen p mean: -0.24412472546100616, mean p set: 0.4493670165538788
loss_pred:0.013937202282249928, decouple_loss:0.0013404719065874815
Iteration: 5633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448047935962677, gen p mean: -0.247341588139534, mean p set: 0.448577344417572
loss_pred:0.014069708995521069, decouple_loss:0.0014353767037391663
The modified gen p mean: 0.4489430785179138, gen p mean: -0.24727706611156464, mean p set: 0.44951972365379333
loss_pred:0.014019587077200413, decouple_loss:0.0013399756280705333
The modified gen p mean: 0.4491553008556366, gen p mean: -0.24540986120700836, mean p set: 0.44972550868988037
loss_pred:0.013965909369289875, decouple_loss:0.001396375591866672
Iteration: 5634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877439737319946, gen p mean: -0.25081902742385864, mean p set: 0.4493010640144348
loss_pred:0.014233062975108624, decouple_loss:0.0014776421012356877
The modified gen p mean: 0.44742801785469055, gen p mean: -0.24751979112625122, mean p set: 0.4480001628398895
loss_pred:0.014684206806123257, decouple_loss:0.0015341306570917368
The modified gen p mean: 0.449306458234787, gen p mean: -0.251640260219574, mean p set: 0.4498789310455322
loss_pred:0.014018280431628227, decouple_loss:0.0015500050503760576
Iteration: 5635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928184151649475, gen p mean: -0.25008425116539, mean p set: 0.4498598277568817
loss_pred:0.013947560451924801, decouple_loss:0.001444267458282411
The modified gen p mean: 0.4478950500488281, gen p mean: -0.24481578171253204, mean p set: 0.4484219551086426The modified gen p mean: 0.44744953513145447, gen p mean: -0.23798738420009613, mean p set: 0.4480302929878235
loss_pred:0.014360443688929081, decouple_loss:0.001748291659168899
loss_pred:0.013983015902340412, decouple_loss:0.0014327955432236195
Iteration: 5636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852587580680847, gen p mean: -0.24866320192813873, mean p set: 0.4491029977798462
loss_pred:0.014282885007560253, decouple_loss:0.0013540848158299923
The modified gen p mean: 0.44910499453544617, gen p mean: -0.24642448127269745, mean p set: 0.4496358335018158The modified gen p mean: 0.4488750994205475, gen p mean: -0.24696144461631775, mean p set: 0.4494534134864807
loss_pred:0.013917560689151287, decouple_loss:0.0013907771790400147
loss_pred:0.014188317582011223, decouple_loss:0.0013405787758529186
Iteration: 5637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932687282562256, gen p mean: -0.25192949175834656, mean p set: 0.4498986005783081
loss_pred:0.014271718449890614, decouple_loss:0.0013964195968583226
The modified gen p mean: 0.44872719049453735, gen p mean: -0.24550341069698334, mean p set: 0.44925159215927124The modified gen p mean: 0.4483627378940582, gen p mean: -0.24600203335285187, mean p set: 0.4489397704601288
loss_pred:0.013707613572478294, decouple_loss:0.0015595846343785524
loss_pred:0.01394291315227747, decouple_loss:0.0014829080319032073
Iteration: 5638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818273186683655, gen p mean: -0.24551235139369965, mean p set: 0.4487597644329071
loss_pred:0.01404028944671154, decouple_loss:0.0013153934851288795
The modified gen p mean: 0.44772592186927795, gen p mean: -0.23879127204418182, mean p set: 0.44830653071403503
loss_pred:0.014017232693731785, decouple_loss:0.001451089745387435
The modified gen p mean: 0.4483656585216522, gen p mean: -0.24931444227695465, mean p set: 0.4488937258720398
loss_pred:0.014742138795554638, decouple_loss:0.0015276247868314385
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901585578918457, gen p mean: -0.2508414685726166, mean p set: 0.4495936930179596
loss_pred:0.013764343224465847, decouple_loss:0.0016902800416573882
The modified gen p mean: 0.44876429438591003, gen p mean: -0.24896152317523956, mean p set: 0.44934189319610596
loss_pred:0.01407970767468214, decouple_loss:0.0016586751444265246
The modified gen p mean: 0.44942739605903625, gen p mean: -0.2495691329240799, mean p set: 0.4499538242816925
loss_pred:0.013980037532746792, decouple_loss:0.0014254865236580372
Iteration: 5640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787952303886414, gen p mean: -0.2516532838344574, mean p set: 0.44845834374427795
loss_pred:0.013852989301085472, decouple_loss:0.0014907991280779243
The modified gen p mean: 0.44890403747558594, gen p mean: -0.2510085105895996, mean p set: 0.4494735598564148The modified gen p mean: 0.4493400752544403, gen p mean: -0.2532421052455902, mean p set: 0.4498666524887085
loss_pred:0.014085916802287102, decouple_loss:0.0014325095107778907
loss_pred:0.014329307712614536, decouple_loss:0.001491303090006113
2023-04-28 06:01:50 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2470315843820572, mean p set: 0.4499112665653229
loss_pred:0.014885911718010902, decouple_loss:0.0016138778300955892
The modified gen p mean: 0.44827303290367126, gen p mean: -0.2451307475566864, mean p set: 0.44879910349845886
loss_pred:0.014776395633816719, decouple_loss:0.0015227349940687418
The modified gen p mean: 0.449299156665802, gen p mean: -0.24767152965068817, mean p set: 0.4498290419578552
loss_pred:0.014349076896905899, decouple_loss:0.00152870814781636
WV_1_PC_1_EH_0_PS_30, loss: 0.014748217537999153, avg_mse: 0.021736549213528633
current test mse: 0.021737
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 5641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483499228954315, gen p mean: -0.23844335973262787, mean p set: 0.44888070225715637
loss_pred:0.013398903422057629, decouple_loss:0.0018729696748778224
The modified gen p mean: 0.4482888877391815, gen p mean: -0.2516208291053772, mean p set: 0.4488680362701416
loss_pred:0.013299673795700073, decouple_loss:0.001630503567866981
The modified gen p mean: 0.4487704634666443, gen p mean: -0.25193309783935547, mean p set: 0.4493459463119507
loss_pred:0.014279709197580814, decouple_loss:0.0017852461896836758
Iteration: 5642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906437397003174, gen p mean: -0.2487586885690689, mean p set: 0.44958946108818054
loss_pred:0.013553386554121971, decouple_loss:0.0015045402105897665
The modified gen p mean: 0.4484134912490845, gen p mean: -0.2492072582244873, mean p set: 0.44898566603660583
loss_pred:0.013681802898645401, decouple_loss:0.001562714227475226
The modified gen p mean: 0.4491080343723297, gen p mean: -0.24564985930919647, mean p set: 0.449687123298645
loss_pred:0.014254812151193619, decouple_loss:0.0016296826070174575
Iteration: 5643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497687518596649, gen p mean: -0.24380169808864594, mean p set: 0.45029905438423157
loss_pred:0.013714039698243141, decouple_loss:0.0017988175386562943
The modified gen p mean: 0.4475436806678772, gen p mean: -0.2501039206981659, mean p set: 0.4481198489665985
loss_pred:0.01348305493593216, decouple_loss:0.001610328909009695
The modified gen p mean: 0.4498841166496277, gen p mean: -0.24486325681209564, mean p set: 0.45046207308769226
loss_pred:0.013364049606025219, decouple_loss:0.0019256965024396777
Iteration: 5644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449034720659256, gen p mean: -0.2499002367258072, mean p set: 0.4495595097541809
loss_pred:0.013566873967647552, decouple_loss:0.0015692926244810224
The modified gen p mean: 0.44873911142349243, gen p mean: -0.24615325033664703, mean p set: 0.44932347536087036
loss_pred:0.013445652090013027, decouple_loss:0.0015266648260876536
The modified gen p mean: 0.44714245200157166, gen p mean: -0.24484188854694366, mean p set: 0.4477255642414093
loss_pred:0.013400168158113956, decouple_loss:0.0016273538349196315
Iteration: 5645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779908657073975, gen p mean: -0.24058163166046143, mean p set: 0.44837456941604614
loss_pred:0.01373621542006731, decouple_loss:0.0018663933733478189
The modified gen p mean: 0.4496552646160126, gen p mean: -0.24393881857395172, mean p set: 0.45022737979888916The modified gen p mean: 0.4493119716644287, gen p mean: -0.25009894371032715, mean p set: 0.44983842968940735
loss_pred:0.01386417169123888, decouple_loss:0.0017692443216219544
loss_pred:0.014013657346367836, decouple_loss:0.0018027668120339513
Iteration: 5646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450058251619339, gen p mean: -0.23993633687496185, mean p set: 0.4506332576274872
loss_pred:0.013156631030142307, decouple_loss:0.0015529650263488293
The modified gen p mean: 0.44800999760627747, gen p mean: -0.24236458539962769, mean p set: 0.4485909342765808The modified gen p mean: 0.4489302337169647, gen p mean: -0.24347883462905884, mean p set: 0.44945788383483887
loss_pred:0.014092591591179371, decouple_loss:0.0018195284064859152
loss_pred:0.013304670341312885, decouple_loss:0.0015500977169722319
Iteration: 5647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838178157806396, gen p mean: -0.24708229303359985, mean p set: 0.44896194338798523
loss_pred:0.01395855750888586, decouple_loss:0.0017064980929717422
The modified gen p mean: 0.4489724934101105, gen p mean: -0.24421711266040802, mean p set: 0.44949984550476074The modified gen p mean: 0.4484657645225525, gen p mean: -0.2512609660625458, mean p set: 0.44904085993766785
loss_pred:0.01329308282583952, decouple_loss:0.0019981826189905405
loss_pred:0.013656598515808582, decouple_loss:0.0017634507967159152
Iteration: 5648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480426013469696, gen p mean: -0.2474663406610489, mean p set: 0.44861605763435364
loss_pred:0.013640141114592552, decouple_loss:0.001540477736853063
The modified gen p mean: 0.44845107197761536, gen p mean: -0.251791387796402, mean p set: 0.44902855157852173The modified gen p mean: 0.44657739996910095, gen p mean: -0.25026649236679077, mean p set: 0.44710251688957214
loss_pred:0.013983254320919514, decouple_loss:0.001375850522890687
loss_pred:0.013308191671967506, decouple_loss:0.0014803101075813174
Iteration: 5649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498065412044525, gen p mean: -0.2512193024158478, mean p set: 0.4503842294216156
loss_pred:0.01365665439516306, decouple_loss:0.0020690083038061857
The modified gen p mean: 0.4486449956893921, gen p mean: -0.2497808337211609, mean p set: 0.4492279887199402
loss_pred:0.013160583563148975, decouple_loss:0.0019973735325038433
The modified gen p mean: 0.44953927397727966, gen p mean: -0.25322070717811584, mean p set: 0.4500616788864136
loss_pred:0.013632969930768013, decouple_loss:0.0017876371275633574
Iteration: 5650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855859875679016, gen p mean: -0.2509843111038208, mean p set: 0.449137419462204
loss_pred:0.013591338880360126, decouple_loss:0.0016064827796071768
The modified gen p mean: 0.4484371542930603, gen p mean: -0.24417468905448914, mean p set: 0.44900989532470703
loss_pred:0.013617677614092827, decouple_loss:0.0016723284497857094
The modified gen p mean: 0.448661208152771, gen p mean: -0.24846699833869934, mean p set: 0.44917967915534973
loss_pred:0.013372561894357204, decouple_loss:0.0021972209215164185
2023-04-28 06:06:05 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24348846077919006, mean p set: 0.4499112665653229
loss_pred:0.015112005174160004, decouple_loss:0.0017732289852574468
The modified gen p mean: 0.4482674300670624, gen p mean: -0.24150295555591583, mean p set: 0.44879910349845886
The modified gen p mean: 0.44930142164230347, gen p mean: -0.244089275598526, mean p set: 0.4498290419578552
loss_pred:0.01485653966665268, decouple_loss:0.0017387904226779938
loss_pred:0.01449406985193491, decouple_loss:0.0018014725064858794
WV_1_PC_1_EH_0_PS_30, loss: 0.014909430406987667, avg_mse: 0.022009385749697685
current test mse: 0.022009
Iteration: 5651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472889006137848, gen p mean: -0.2462000697851181, mean p set: 0.4478663504123688
loss_pred:0.013307465240359306, decouple_loss:0.0017266971990466118
The modified gen p mean: 0.44873151183128357, gen p mean: -0.24358023703098297, mean p set: 0.44930922985076904
loss_pred:0.013430668041110039, decouple_loss:0.001925668097101152
The modified gen p mean: 0.4503619968891144, gen p mean: -0.23881790041923523, mean p set: 0.4508882462978363
loss_pred:0.013412793166935444, decouple_loss:0.0015408056788146496
Iteration: 5652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943010807037354, gen p mean: -0.23870034515857697, mean p set: 0.4499533474445343
loss_pred:0.01343394536525011, decouple_loss:0.0017362752696499228
The modified gen p mean: 0.449431449174881, gen p mean: -0.2470468282699585, mean p set: 0.4500042200088501The modified gen p mean: 0.448710173368454, gen p mean: -0.24092401564121246, mean p set: 0.449288934469223
loss_pred:0.013781906105577946, decouple_loss:0.002040639752522111
loss_pred:0.013783695176243782, decouple_loss:0.0017877364298328757
Iteration: 5653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45016172528266907, gen p mean: -0.2372429370880127, mean p set: 0.450682133436203
loss_pred:0.01349207665771246, decouple_loss:0.001880745287053287
The modified gen p mean: 0.44929736852645874, gen p mean: -0.23625953495502472, mean p set: 0.4498685300350189The modified gen p mean: 0.4480110704898834, gen p mean: -0.23055291175842285, mean p set: 0.4485895335674286
loss_pred:0.013823935762047768, decouple_loss:0.001498962170444429
loss_pred:0.013294041156768799, decouple_loss:0.0018035550601780415
Iteration: 5654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484180510044098, gen p mean: -0.23851367831230164, mean p set: 0.448943167924881
loss_pred:0.013571158982813358, decouple_loss:0.001951641053892672
The modified gen p mean: 0.448062926530838, gen p mean: -0.2390325516462326, mean p set: 0.448634535074234The modified gen p mean: 0.44929811358451843, gen p mean: -0.24131792783737183, mean p set: 0.44987955689430237
loss_pred:0.013461972586810589, decouple_loss:0.001947922632098198
loss_pred:0.013532194308936596, decouple_loss:0.002362474799156189
Iteration: 5655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931280612945557, gen p mean: -0.243686243891716, mean p set: 0.4498407244682312
loss_pred:0.013386017642915249, decouple_loss:0.0017763719661161304
The modified gen p mean: 0.44800540804862976, gen p mean: -0.23958297073841095, mean p set: 0.4485769271850586The modified gen p mean: 0.4463857114315033, gen p mean: -0.24639058113098145, mean p set: 0.4469698667526245
loss_pred:0.013208968564867973, decouple_loss:0.0018526571802794933
loss_pred:0.013312923721969128, decouple_loss:0.0016414574347436428
Iteration: 5656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497387409210205, gen p mean: -0.24574775993824005, mean p set: 0.4502703547477722
loss_pred:0.013847501017153263, decouple_loss:0.0017408112762495875
The modified gen p mean: 0.44777852296829224, gen p mean: -0.24121208488941193, mean p set: 0.4483490288257599
loss_pred:0.013368023559451103, decouple_loss:0.0017510856268927455
The modified gen p mean: 0.4477914869785309, gen p mean: -0.2407347410917282, mean p set: 0.4483669102191925
loss_pred:0.013458631932735443, decouple_loss:0.0018083300674334168
Iteration: 5657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44918161630630493, gen p mean: -0.24378754198551178, mean p set: 0.44975459575653076
loss_pred:0.013247489929199219, decouple_loss:0.001666375552304089
The modified gen p mean: 0.4493465721607208, gen p mean: -0.23562510311603546, mean p set: 0.4499235153198242
loss_pred:0.01373147964477539, decouple_loss:0.001714917249046266
The modified gen p mean: 0.4476778209209442, gen p mean: -0.24406798183918, mean p set: 0.44820713996887207
loss_pred:0.013951396569609642, decouple_loss:0.0016622416442260146
Iteration: 5658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791799783706665, gen p mean: -0.23713865876197815, mean p set: 0.44844722747802734
loss_pred:0.01389128528535366, decouple_loss:0.001548519590869546
The modified gen p mean: 0.4476276934146881, gen p mean: -0.23977605998516083, mean p set: 0.44820865988731384
loss_pred:0.013614309951663017, decouple_loss:0.001727077760733664
The modified gen p mean: 0.44903436303138733, gen p mean: -0.2439597100019455, mean p set: 0.4496126174926758
loss_pred:0.013053377158939838, decouple_loss:0.001752231502905488
Iteration: 5659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490662217140198, gen p mean: -0.2393607348203659, mean p set: 0.44964301586151123
loss_pred:0.013921108096837997, decouple_loss:0.0015018192352727056
The modified gen p mean: 0.4474808871746063, gen p mean: -0.23836077749729156, mean p set: 0.448056697845459
loss_pred:0.013149878941476345, decouple_loss:0.0016239966498687863
The modified gen p mean: 0.44906580448150635, gen p mean: -0.24336674809455872, mean p set: 0.4495994448661804
loss_pred:0.013629360124468803, decouple_loss:0.0014818399213254452
Iteration: 5660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878679513931274, gen p mean: -0.24242845177650452, mean p set: 0.44936034083366394
loss_pred:0.013389809057116508, decouple_loss:0.0016857993323355913
The modified gen p mean: 0.44865646958351135, gen p mean: -0.23204490542411804, mean p set: 0.4492368996143341
loss_pred:0.013362039811909199, decouple_loss:0.001646628719754517
The modified gen p mean: 0.4501058757305145, gen p mean: -0.2354700267314911, mean p set: 0.45063140988349915
loss_pred:0.013456948101520538, decouple_loss:0.0016165579436346889
2023-04-28 06:09:29 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2402321994304657, mean p set: 0.4499112665653229
loss_pred:0.015058041550219059, decouple_loss:0.0018208042019978166
The modified gen p mean: 0.44929778575897217, gen p mean: -0.2404215931892395, mean p set: 0.4498290419578552
loss_pred:0.014495272189378738, decouple_loss:0.0018789742607623339
The modified gen p mean: 0.4482690095901489, gen p mean: -0.23817798495292664, mean p set: 0.44879910349845886
loss_pred:0.014845476485788822, decouple_loss:0.0017997629474848509
WV_1_PC_1_EH_0_PS_30, loss: 0.014891255646944046, avg_mse: 0.02199956215918064
current test mse: 0.022
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 5661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472886919975281, gen p mean: -0.23770782351493835, mean p set: 0.44781771302223206
loss_pred:0.014937902800738811, decouple_loss:0.001954598119482398
The modified gen p mean: 0.4475719928741455, gen p mean: -0.23768052458763123, mean p set: 0.4481445848941803
loss_pred:0.014324329793453217, decouple_loss:0.001819475321099162
The modified gen p mean: 0.447809636592865, gen p mean: -0.23888714611530304, mean p set: 0.4483889639377594
loss_pred:0.014594625681638718, decouple_loss:0.0019672177731990814
Iteration: 5662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471362233161926, gen p mean: -0.24137330055236816, mean p set: 0.4476606547832489
loss_pred:0.014645987190306187, decouple_loss:0.0017298313323408365
The modified gen p mean: 0.4472566843032837, gen p mean: -0.24195024371147156, mean p set: 0.44783589243888855
The modified gen p mean: 0.447671502828598, gen p mean: -0.24655906856060028, mean p set: 0.44824355840682983
loss_pred:0.013953701592981815, decouple_loss:0.001542750746011734
loss_pred:0.014815212227404118, decouple_loss:0.0020147934556007385
Iteration: 5663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474133253097534, gen p mean: -0.24402256309986115, mean p set: 0.44793930649757385
loss_pred:0.014875244349241257, decouple_loss:0.0015820086700841784
The modified gen p mean: 0.4480327367782593, gen p mean: -0.2420566827058792, mean p set: 0.4486115872859955
The modified gen p mean: 0.4473939538002014, gen p mean: -0.24075454473495483, mean p set: 0.4479668438434601
loss_pred:0.014563407748937607, decouple_loss:0.0016129337018355727
loss_pred:0.01508400496095419, decouple_loss:0.0016964810201898217
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475308656692505, gen p mean: -0.24628064036369324, mean p set: 0.4480603337287903
loss_pred:0.014428626745939255, decouple_loss:0.0017599280690774322
The modified gen p mean: 0.4467258155345917, gen p mean: -0.24366828799247742, mean p set: 0.44729599356651306
The modified gen p mean: 0.4468865990638733, gen p mean: -0.23962831497192383, mean p set: 0.4474641680717468
loss_pred:0.013754886575043201, decouple_loss:0.0018708509160205722
loss_pred:0.01520391646772623, decouple_loss:0.001842839876189828
Iteration: 5665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446216344833374, gen p mean: -0.24397747218608856, mean p set: 0.44678664207458496
loss_pred:0.014034644700586796, decouple_loss:0.0015250332653522491
The modified gen p mean: 0.4473438858985901, gen p mean: -0.23629184067249298, mean p set: 0.4478713572025299The modified gen p mean: 0.4470953345298767, gen p mean: -0.24106132984161377, mean p set: 0.44767072796821594
loss_pred:0.014754991978406906, decouple_loss:0.0015571280382573605
loss_pred:0.015123222954571247, decouple_loss:0.0015352517366409302
Iteration: 5666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469708800315857, gen p mean: -0.2419096827507019, mean p set: 0.44749921560287476
loss_pred:0.014497242867946625, decouple_loss:0.0017502624541521072
The modified gen p mean: 0.4480467140674591, gen p mean: -0.2490691840648651, mean p set: 0.4486217796802521
The modified gen p mean: 0.4477527439594269, gen p mean: -0.2435673326253891, mean p set: 0.44833505153656006
loss_pred:0.014120671898126602, decouple_loss:0.0016545094549655914
loss_pred:0.014605719596147537, decouple_loss:0.0017048243898898363
Iteration: 5667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769102334976196, gen p mean: -0.24450841546058655, mean p set: 0.4482216238975525
loss_pred:0.014951246790587902, decouple_loss:0.001515677897259593
The modified gen p mean: 0.44686681032180786, gen p mean: -0.24481017887592316, mean p set: 0.447443425655365
The modified gen p mean: 0.44655364751815796, gen p mean: -0.2453688532114029, mean p set: 0.44713303446769714
loss_pred:0.014182551763951778, decouple_loss:0.001550316228531301
loss_pred:0.013752410188317299, decouple_loss:0.0013974953908473253
Iteration: 5668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713127613067627, gen p mean: -0.24661336839199066, mean p set: 0.44771143794059753
loss_pred:0.014451771043241024, decouple_loss:0.001689233584329486
The modified gen p mean: 0.4473936855792999, gen p mean: -0.2453107386827469, mean p set: 0.44792598485946655The modified gen p mean: 0.4475260376930237, gen p mean: -0.24344007670879364, mean p set: 0.4481000304222107
loss_pred:0.014582017436623573, decouple_loss:0.0016277548857033253
loss_pred:0.014323164708912373, decouple_loss:0.0018823279533535242
Iteration: 5669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474860727787018, gen p mean: -0.2463749498128891, mean p set: 0.44806763529777527
loss_pred:0.01409228891134262, decouple_loss:0.0016348902136087418
The modified gen p mean: 0.44710642099380493, gen p mean: -0.2454695701599121, mean p set: 0.44768041372299194
loss_pred:0.013690263964235783, decouple_loss:0.0014271315885707736
The modified gen p mean: 0.44707489013671875, gen p mean: -0.23970186710357666, mean p set: 0.4475988745689392
loss_pred:0.014128187671303749, decouple_loss:0.0014517160598188639
Iteration: 5670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470069110393524, gen p mean: -0.2472730576992035, mean p set: 0.44758090376853943
loss_pred:0.014151674695312977, decouple_loss:0.0015609939582645893
The modified gen p mean: 0.4471994936466217, gen p mean: -0.24292202293872833, mean p set: 0.44777771830558777
loss_pred:0.014531291089951992, decouple_loss:0.001610719133168459
The modified gen p mean: 0.44853675365448, gen p mean: -0.2427939623594284, mean p set: 0.4490669369697571
loss_pred:0.01412263698875904, decouple_loss:0.0016422462649643421
2023-04-28 06:13:44 testing...
The modified gen p mean: 0.44826701283454895, gen p mean: -0.2402191013097763, mean p set: 0.44879910349845886
loss_pred:0.014775563962757587, decouple_loss:0.0016250095795840025
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24223606288433075, mean p set: 0.4499112665653229
loss_pred:0.014937927946448326, decouple_loss:0.0016276715323328972
The modified gen p mean: 0.4492984414100647, gen p mean: -0.242521271109581, mean p set: 0.4498290419578552
loss_pred:0.014442556537687778, decouple_loss:0.0016136119375005364
WV_1_PC_1_EH_0_PS_30, loss: 0.014799787662923336, avg_mse: 0.02190569043159485
current test mse: 0.021906
Iteration: 5671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484966993331909, gen p mean: -0.24570263922214508, mean p set: 0.4490697383880615
loss_pred:0.01390412449836731, decouple_loss:0.0016211243346333504
The modified gen p mean: 0.4466726779937744, gen p mean: -0.24210944771766663, mean p set: 0.44725102186203003
loss_pred:0.01385258138179779, decouple_loss:0.0016306039178743958
The modified gen p mean: 0.44758331775665283, gen p mean: -0.24031616747379303, mean p set: 0.4481123387813568
loss_pred:0.013890615664422512, decouple_loss:0.0017070150934159756
Iteration: 5672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475114345550537, gen p mean: -0.2398383915424347, mean p set: 0.4480361342430115
loss_pred:0.01444246806204319, decouple_loss:0.001541041536256671
The modified gen p mean: 0.44756197929382324, gen p mean: -0.24575869739055634, mean p set: 0.4481448233127594The modified gen p mean: 0.44771942496299744, gen p mean: -0.24831925332546234, mean p set: 0.4482952058315277
loss_pred:0.014418350532650948, decouple_loss:0.0017151131760329008
loss_pred:0.01414184458553791, decouple_loss:0.0015822631539776921
Iteration: 5673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714123010635376, gen p mean: -0.24506862461566925, mean p set: 0.44767072796821594
loss_pred:0.014830104075372219, decouple_loss:0.0016436181031167507
The modified gen p mean: 0.4482317268848419, gen p mean: -0.24193905293941498, mean p set: 0.4488099217414856The modified gen p mean: 0.44742825627326965, gen p mean: -0.24374976754188538, mean p set: 0.4480043649673462
loss_pred:0.014827528037130833, decouple_loss:0.0015316630015149713
loss_pred:0.014850454404950142, decouple_loss:0.0017029165755957365
Iteration: 5674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479522109031677, gen p mean: -0.2425551414489746, mean p set: 0.44848695397377014
loss_pred:0.014165165834128857, decouple_loss:0.0015869769267737865
The modified gen p mean: 0.4474305212497711, gen p mean: -0.24070030450820923, mean p set: 0.44800713658332825
loss_pred:0.014049525372684002, decouple_loss:0.0015489968936890364
The modified gen p mean: 0.44720232486724854, gen p mean: -0.23786243796348572, mean p set: 0.4477778375148773
loss_pred:0.01388668455183506, decouple_loss:0.001556657487526536
Iteration: 5675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468153417110443, gen p mean: -0.24031753838062286, mean p set: 0.44739648699760437
loss_pred:0.014939923770725727, decouple_loss:0.0017384039238095284
The modified gen p mean: 0.4476698935031891, gen p mean: -0.23764431476593018, mean p set: 0.44820162653923035The modified gen p mean: 0.44709113240242004, gen p mean: -0.2345888614654541, mean p set: 0.4476645588874817
loss_pred:0.014451607130467892, decouple_loss:0.0016356452833861113
loss_pred:0.014685677364468575, decouple_loss:0.0016762121813371778
Iteration: 5676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766372442245483, gen p mean: -0.2438456267118454, mean p set: 0.4482428729534149
loss_pred:0.014133485965430737, decouple_loss:0.0017591576324775815
The modified gen p mean: 0.4474954903125763, gen p mean: -0.23605361580848694, mean p set: 0.44807714223861694
loss_pred:0.014547450467944145, decouple_loss:0.0018075028201565146
The modified gen p mean: 0.4474434554576874, gen p mean: -0.2367999255657196, mean p set: 0.4479702413082123
loss_pred:0.0143441092222929, decouple_loss:0.001716069527901709
Iteration: 5677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44592368602752686, gen p mean: -0.23703838884830475, mean p set: 0.44649389386177063
loss_pred:0.01359550841152668, decouple_loss:0.0015164145734161139
The modified gen p mean: 0.44621923565864563, gen p mean: -0.23618286848068237, mean p set: 0.4467572569847107The modified gen p mean: 0.4470645785331726, gen p mean: -0.24020376801490784, mean p set: 0.44763314723968506
loss_pred:0.014803022146224976, decouple_loss:0.00148961937520653
loss_pred:0.013531318865716457, decouple_loss:0.0014847912825644016
Iteration: 5678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769546389579773, gen p mean: -0.24649475514888763, mean p set: 0.4482708275318146
loss_pred:0.014871316030621529, decouple_loss:0.00147827691398561
The modified gen p mean: 0.44720908999443054, gen p mean: -0.24500547349452972, mean p set: 0.44774720072746277The modified gen p mean: 0.44751301407814026, gen p mean: -0.24168874323368073, mean p set: 0.4480897784233093
loss_pred:0.01432174351066351, decouple_loss:0.0016348595963791013
loss_pred:0.013939505442976952, decouple_loss:0.001595758367329836
Iteration: 5679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645175337791443, gen p mean: -0.2476319521665573, mean p set: 0.44702383875846863
loss_pred:0.014122064225375652, decouple_loss:0.0015102865872904658
The modified gen p mean: 0.4469820559024811, gen p mean: -0.24224865436553955, mean p set: 0.44755926728248596
loss_pred:0.015048506669700146, decouple_loss:0.0015896515687927604
The modified gen p mean: 0.44748973846435547, gen p mean: -0.2473490983247757, mean p set: 0.4480176270008087
loss_pred:0.014663784764707088, decouple_loss:0.0015437620459124446
Iteration: 5680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447695255279541, gen p mean: -0.24241377413272858, mean p set: 0.4482730031013489
loss_pred:0.0144311198964715, decouple_loss:0.0014182724989950657
The modified gen p mean: 0.4472232162952423, gen p mean: -0.24577949941158295, mean p set: 0.4478038251399994
loss_pred:0.014273094944655895, decouple_loss:0.0014944304712116718
The modified gen p mean: 0.44798800349235535, gen p mean: -0.24748238921165466, mean p set: 0.4485156238079071
loss_pred:0.013741753995418549, decouple_loss:0.0014984162990003824
2023-04-28 06:17:08 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24076054990291595, mean p set: 0.4499112665653229
loss_pred:0.015001888386905193, decouple_loss:0.0016543379751965404
The modified gen p mean: 0.448268860578537, gen p mean: -0.23906317353248596, mean p set: 0.44879910349845886
loss_pred:0.014850405976176262, decouple_loss:0.0015410005580633879
The modified gen p mean: 0.4492940902709961, gen p mean: -0.24142245948314667, mean p set: 0.4498290419578552
loss_pred:0.01447870209813118, decouple_loss:0.0015860070707276464
WV_1_PC_1_EH_0_PS_30, loss: 0.014856688678264618, avg_mse: 0.021930484101176262
current test mse: 0.02193
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 5681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831833243370056, gen p mean: -0.24590106308460236, mean p set: 0.44884857535362244
loss_pred:0.01373053714632988, decouple_loss:0.0016381873283535242
The modified gen p mean: 0.4501897990703583, gen p mean: -0.23891383409500122, mean p set: 0.4507656991481781
loss_pred:0.01332036592066288, decouple_loss:0.0015980787575244904
The modified gen p mean: 0.4488288462162018, gen p mean: -0.2409842610359192, mean p set: 0.4494022727012634
loss_pred:0.014356871135532856, decouple_loss:0.0014575431123375893
Iteration: 5682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825994968414307, gen p mean: -0.232400581240654, mean p set: 0.4487907588481903
loss_pred:0.01371039729565382, decouple_loss:0.001611312385648489
The modified gen p mean: 0.45047545433044434, gen p mean: -0.2333061695098877, mean p set: 0.45106109976768494
loss_pred:0.012820899486541748, decouple_loss:0.0019169667502865195
The modified gen p mean: 0.4504376947879791, gen p mean: -0.23282456398010254, mean p set: 0.4510194957256317
loss_pred:0.013031033799052238, decouple_loss:0.0018114488339051604
Iteration: 5683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44980522990226746, gen p mean: -0.23022311925888062, mean p set: 0.4503350555896759
loss_pred:0.01360552478581667, decouple_loss:0.001592503977008164
The modified gen p mean: 0.4500206708908081, gen p mean: -0.23359592258930206, mean p set: 0.4505973160266876
loss_pred:0.013442068360745907, decouple_loss:0.0019484440563246608
The modified gen p mean: 0.45012593269348145, gen p mean: -0.23182056844234467, mean p set: 0.4507005214691162
loss_pred:0.012776121497154236, decouple_loss:0.0017371209105476737
Iteration: 5684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488845467567444, gen p mean: -0.2325173020362854, mean p set: 0.4494141638278961
loss_pred:0.014099465683102608, decouple_loss:0.0018366435542702675
The modified gen p mean: 0.4506811499595642, gen p mean: -0.23093384504318237, mean p set: 0.4512515664100647The modified gen p mean: 0.4493236839771271, gen p mean: -0.23426112532615662, mean p set: 0.4499005675315857
loss_pred:0.013331390917301178, decouple_loss:0.0020232265815138817loss_pred:0.013486934825778008, decouple_loss:0.0018471466610208154
Iteration: 5685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500653147697449, gen p mean: -0.23676510155200958, mean p set: 0.45064398646354675
loss_pred:0.012456653639674187, decouple_loss:0.001843681326135993
The modified gen p mean: 0.4474712908267975, gen p mean: -0.23584052920341492, mean p set: 0.4479977786540985The modified gen p mean: 0.4489046633243561, gen p mean: -0.2403949350118637, mean p set: 0.4494830369949341
loss_pred:0.01323571614921093, decouple_loss:0.0016883367206901312
loss_pred:0.013354171067476273, decouple_loss:0.0015755309723317623
Iteration: 5686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474284052848816, gen p mean: -0.23610948026180267, mean p set: 0.448009192943573
loss_pred:0.013130620121955872, decouple_loss:0.0019320347346365452
The modified gen p mean: 0.44820547103881836, gen p mean: -0.23871125280857086, mean p set: 0.44873154163360596
The modified gen p mean: 0.447858065366745, gen p mean: -0.24184724688529968, mean p set: 0.44843724370002747
loss_pred:0.013439546339213848, decouple_loss:0.001939911744557321
loss_pred:0.012955719605088234, decouple_loss:0.0018631704151630402
Iteration: 5687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503767192363739, gen p mean: -0.23805390298366547, mean p set: 0.4508989155292511
loss_pred:0.012816322967410088, decouple_loss:0.0018802548293024302
The modified gen p mean: 0.4503406584262848, gen p mean: -0.23538412153720856, mean p set: 0.4509190618991852
loss_pred:0.013359004631638527, decouple_loss:0.001920190523378551
The modified gen p mean: 0.4476394057273865, gen p mean: -0.23663511872291565, mean p set: 0.4482172131538391
loss_pred:0.013415787369012833, decouple_loss:0.0016314218519255519
Iteration: 5688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961076974868774, gen p mean: -0.23850888013839722, mean p set: 0.4501778185367584
loss_pred:0.013494119048118591, decouple_loss:0.0019054367439821362
The modified gen p mean: 0.44936683773994446, gen p mean: -0.24269206821918488, mean p set: 0.4498968720436096The modified gen p mean: 0.44960328936576843, gen p mean: -0.24314512312412262, mean p set: 0.45017769932746887
loss_pred:0.013156226836144924, decouple_loss:0.001910701277665794
loss_pred:0.01277957670390606, decouple_loss:0.0018192455172538757
Iteration: 5689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983527064323425, gen p mean: -0.2422206550836563, mean p set: 0.450408935546875
loss_pred:0.012887842953205109, decouple_loss:0.0019324177410453558
The modified gen p mean: 0.4483156204223633, gen p mean: -0.23991979658603668, mean p set: 0.44889214634895325
loss_pred:0.013471756130456924, decouple_loss:0.0018868898041546345
The modified gen p mean: 0.44938814640045166, gen p mean: -0.24772900342941284, mean p set: 0.4499218463897705
loss_pred:0.013460737653076649, decouple_loss:0.002083819592371583
Iteration: 5690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449348121881485, gen p mean: -0.24805766344070435, mean p set: 0.4499257802963257
loss_pred:0.013532256707549095, decouple_loss:0.001757354475557804
The modified gen p mean: 0.4488156735897064, gen p mean: -0.24616988003253937, mean p set: 0.44939103722572327
loss_pred:0.013767024502158165, decouple_loss:0.0017644627951085567
The modified gen p mean: 0.4502392113208771, gen p mean: -0.2492058426141739, mean p set: 0.45076262950897217
loss_pred:0.012813514098525047, decouple_loss:0.0020089473109692335
2023-04-28 06:21:31 testing...
The modified gen p mean: 0.4482746422290802, gen p mean: -0.23817649483680725, mean p set: 0.44879910349845886
loss_pred:0.015035608783364296, decouple_loss:0.002043688204139471
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23985131084918976, mean p set: 0.4499112665653229
loss_pred:0.015170043334364891, decouple_loss:0.0020963142160326242
The modified gen p mean: 0.44929975271224976, gen p mean: -0.2402244508266449, mean p set: 0.4498290419578552
loss_pred:0.01460361573845148, decouple_loss:0.002297816099599004
WV_1_PC_1_EH_0_PS_30, loss: 0.015043720602989197, avg_mse: 0.022244492545723915
current test mse: 0.022244
Iteration: 5691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483562111854553, gen p mean: -0.2384309619665146, mean p set: 0.4489321708679199
loss_pred:0.01312546618282795, decouple_loss:0.0018607910024002194
The modified gen p mean: 0.4489603638648987, gen p mean: -0.24828723073005676, mean p set: 0.4494844079017639
loss_pred:0.013796319253742695, decouple_loss:0.0019989367574453354
The modified gen p mean: 0.44930845499038696, gen p mean: -0.2440408617258072, mean p set: 0.4498860538005829
loss_pred:0.013859247788786888, decouple_loss:0.0020836638286709785
Iteration: 5692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783467054367065, gen p mean: -0.23525090515613556, mean p set: 0.44835996627807617
loss_pred:0.01412974949926138, decouple_loss:0.0020459110382944345
The modified gen p mean: 0.44912973046302795, gen p mean: -0.23847855627536774, mean p set: 0.449707955121994
loss_pred:0.01344907097518444, decouple_loss:0.0020273986738175154
The modified gen p mean: 0.4471483528614044, gen p mean: -0.2414170503616333, mean p set: 0.4477207064628601
loss_pred:0.013254539109766483, decouple_loss:0.001739578670822084
Iteration: 5693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45029670000076294, gen p mean: -0.24177467823028564, mean p set: 0.4508228898048401
loss_pred:0.012864821590483189, decouple_loss:0.0018325861310586333
The modified gen p mean: 0.4490560293197632, gen p mean: -0.24787504971027374, mean p set: 0.4496326744556427
loss_pred:0.013471147045493126, decouple_loss:0.0018258667550981045
The modified gen p mean: 0.4495640993118286, gen p mean: -0.2420288771390915, mean p set: 0.4501335322856903
loss_pred:0.013009249232709408, decouple_loss:0.0016916164895519614
Iteration: 5694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490208923816681, gen p mean: -0.2524942457675934, mean p set: 0.4495563805103302
loss_pred:0.013669743202626705, decouple_loss:0.0020270789973437786
The modified gen p mean: 0.44949817657470703, gen p mean: -0.24628916382789612, mean p set: 0.45007139444351196
loss_pred:0.013767940923571587, decouple_loss:0.0021958451252430677
The modified gen p mean: 0.45010343194007874, gen p mean: -0.24922071397304535, mean p set: 0.4506858289241791
loss_pred:0.013210872188210487, decouple_loss:0.0024078909773379564
Iteration: 5695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498105049133301, gen p mean: -0.2440304011106491, mean p set: 0.4503912329673767
loss_pred:0.01230864878743887, decouple_loss:0.0018991735996678472
The modified gen p mean: 0.4489622116088867, gen p mean: -0.24186909198760986, mean p set: 0.44949066638946533The modified gen p mean: 0.45014727115631104, gen p mean: -0.2435106635093689, mean p set: 0.4507233798503876
loss_pred:0.013426573947072029, decouple_loss:0.0019809806253761053
loss_pred:0.013267173431813717, decouple_loss:0.0018527732463553548
Iteration: 5696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947245717048645, gen p mean: -0.24439725279808044, mean p set: 0.4500423073768616
loss_pred:0.013818451203405857, decouple_loss:0.0017582025611773133
The modified gen p mean: 0.44905561208724976, gen p mean: -0.2463531196117401, mean p set: 0.44958579540252686The modified gen p mean: 0.44923561811447144, gen p mean: -0.24794362485408783, mean p set: 0.4498126208782196
loss_pred:0.01309569738805294, decouple_loss:0.0018867491744458675
loss_pred:0.01341927982866764, decouple_loss:0.0018198611214756966
Iteration: 5697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499770998954773, gen p mean: -0.24010862410068512, mean p set: 0.4505492150783539
loss_pred:0.012690967880189419, decouple_loss:0.0017210273072123528
The modified gen p mean: 0.4486563205718994, gen p mean: -0.23914608359336853, mean p set: 0.4492337107658386The modified gen p mean: 0.44857218861579895, gen p mean: -0.23857440054416656, mean p set: 0.4491027593612671
loss_pred:0.012976939789950848, decouple_loss:0.0016687019960954785
loss_pred:0.01358031015843153, decouple_loss:0.0016979905776679516
Iteration: 5698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448780357837677, gen p mean: -0.2380070984363556, mean p set: 0.4493516683578491
loss_pred:0.013992004096508026, decouple_loss:0.0014511877670884132
The modified gen p mean: 0.45035529136657715, gen p mean: -0.23720480501651764, mean p set: 0.45092666149139404
loss_pred:0.013160724192857742, decouple_loss:0.0015955977141857147
The modified gen p mean: 0.44927674531936646, gen p mean: -0.23909133672714233, mean p set: 0.4497992694377899
loss_pred:0.013149144127964973, decouple_loss:0.0015475914115086198
Iteration: 5699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471086263656616, gen p mean: -0.23702314496040344, mean p set: 0.4476839303970337
loss_pred:0.013344641774892807, decouple_loss:0.0016029129037633538
The modified gen p mean: 0.4489620327949524, gen p mean: -0.23047462105751038, mean p set: 0.44953563809394836
loss_pred:0.013049120083451271, decouple_loss:0.0017358929617330432
The modified gen p mean: 0.4487230181694031, gen p mean: -0.23209282755851746, mean p set: 0.4492511451244354
loss_pred:0.014211505651473999, decouple_loss:0.001633020699955523
Iteration: 5700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499165713787079, gen p mean: -0.233984112739563, mean p set: 0.4504936933517456
loss_pred:0.012562844902276993, decouple_loss:0.0015240602660924196
The modified gen p mean: 0.45049384236335754, gen p mean: -0.23876389861106873, mean p set: 0.4510750472545624
loss_pred:0.013514932245016098, decouple_loss:0.0016212371410802007
The modified gen p mean: 0.44946515560150146, gen p mean: -0.23333188891410828, mean p set: 0.4499913156032562
loss_pred:0.012880069203674793, decouple_loss:0.0015767788281664252
2023-04-28 06:24:56 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23958927392959595, mean p set: 0.4499112665653229
loss_pred:0.015032848343253136, decouple_loss:0.0017127955798059702
The modified gen p mean: 0.448274701833725, gen p mean: -0.2375039905309677, mean p set: 0.44879910349845886The modified gen p mean: 0.44930851459503174, gen p mean: -0.2398187816143036, mean p set: 0.4498290419578552
loss_pred:0.014958692714571953, decouple_loss:0.0016436557052657008
loss_pred:0.014570903964340687, decouple_loss:0.0016913298750296235
WV_1_PC_1_EH_0_PS_30, loss: 0.014938278123736382, avg_mse: 0.022090362384915352
current test mse: 0.02209
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 5701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480600953102112, gen p mean: -0.23974403738975525, mean p set: 0.44857946038246155
loss_pred:0.013951078988611698, decouple_loss:0.0017251010285690427
The modified gen p mean: 0.4481029212474823, gen p mean: -0.23687298595905304, mean p set: 0.4486773908138275
loss_pred:0.013785780407488346, decouple_loss:0.0018260427750647068
The modified gen p mean: 0.44692352414131165, gen p mean: -0.2383948564529419, mean p set: 0.4474954903125763
loss_pred:0.014554712921380997, decouple_loss:0.0015890590148046613
Iteration: 5702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480692446231842, gen p mean: -0.24154725670814514, mean p set: 0.4485970735549927
loss_pred:0.013497484847903252, decouple_loss:0.0016861455515027046
The modified gen p mean: 0.44594326615333557, gen p mean: -0.24026833474636078, mean p set: 0.44651728868484497
loss_pred:0.013911901041865349, decouple_loss:0.0019750299397855997
The modified gen p mean: 0.44776374101638794, gen p mean: -0.2397102564573288, mean p set: 0.44834527373313904
loss_pred:0.014461101032793522, decouple_loss:0.0019257597159594297
Iteration: 5703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472433626651764, gen p mean: -0.23388321697711945, mean p set: 0.4477651119232178
loss_pred:0.014091353863477707, decouple_loss:0.0016479992773383856
The modified gen p mean: 0.44794970750808716, gen p mean: -0.23511071503162384, mean p set: 0.44852498173713684
loss_pred:0.014220118522644043, decouple_loss:0.0016318942653015256
The modified gen p mean: 0.44706806540489197, gen p mean: -0.2325395792722702, mean p set: 0.44764673709869385
loss_pred:0.0142463194206357, decouple_loss:0.0016875662840902805
Iteration: 5704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458072781562805, gen p mean: -0.23394158482551575, mean p set: 0.446336567401886
loss_pred:0.0135970339179039, decouple_loss:0.0014785889070481062
The modified gen p mean: 0.44802966713905334, gen p mean: -0.23204994201660156, mean p set: 0.44860827922821045
loss_pred:0.013523928821086884, decouple_loss:0.0017924447311088443
The modified gen p mean: 0.44777122139930725, gen p mean: -0.23070909082889557, mean p set: 0.4483456313610077
loss_pred:0.013842271640896797, decouple_loss:0.001745310495607555
Iteration: 5705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482252299785614, gen p mean: -0.22663645446300507, mean p set: 0.4487995207309723
loss_pred:0.014182992279529572, decouple_loss:0.0016607064753770828
The modified gen p mean: 0.4472980797290802, gen p mean: -0.23418332636356354, mean p set: 0.447822630405426The modified gen p mean: 0.44753918051719666, gen p mean: -0.2377804070711136, mean p set: 0.44811320304870605
loss_pred:0.013801825232803822, decouple_loss:0.0016674103680998087
loss_pred:0.013683071359992027, decouple_loss:0.0015612648567184806
Iteration: 5706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789502024650574, gen p mean: -0.2351820021867752, mean p set: 0.4484725892543793
loss_pred:0.013453001156449318, decouple_loss:0.0013750841608271003
The modified gen p mean: 0.4475162625312805, gen p mean: -0.23003579676151276, mean p set: 0.4480930268764496The modified gen p mean: 0.44760870933532715, gen p mean: -0.23674379289150238, mean p set: 0.4481382668018341
loss_pred:0.014088650234043598, decouple_loss:0.0014255597488954663
loss_pred:0.013600694946944714, decouple_loss:0.0014672836987301707
Iteration: 5707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666537642478943, gen p mean: -0.24101664125919342, mean p set: 0.447241872549057
loss_pred:0.014307200908660889, decouple_loss:0.00162664451636374
The modified gen p mean: 0.44774770736694336, gen p mean: -0.23514066636562347, mean p set: 0.44832614064216614
loss_pred:0.013085373677313328, decouple_loss:0.0015386409359052777
The modified gen p mean: 0.4462178349494934, gen p mean: -0.23745018243789673, mean p set: 0.4467467665672302
loss_pred:0.01366085559129715, decouple_loss:0.001635397900827229
Iteration: 5708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472414553165436, gen p mean: -0.2403818666934967, mean p set: 0.4478101134300232
loss_pred:0.013898150995373726, decouple_loss:0.00143547507468611
The modified gen p mean: 0.44655799865722656, gen p mean: -0.23889219760894775, mean p set: 0.44713273644447327
loss_pred:0.013706859201192856, decouple_loss:0.001507262815721333
The modified gen p mean: 0.446148544549942, gen p mean: -0.2423904836177826, mean p set: 0.44667288661003113
loss_pred:0.013519380241632462, decouple_loss:0.0015354916686192155
Iteration: 5709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807881116867065, gen p mean: -0.23859398066997528, mean p set: 0.4486536979675293
loss_pred:0.013598733581602573, decouple_loss:0.0015228742267936468
The modified gen p mean: 0.44749343395233154, gen p mean: -0.23569737374782562, mean p set: 0.4480171501636505
loss_pred:0.014158030971884727, decouple_loss:0.0016533239977434278
The modified gen p mean: 0.44721296429634094, gen p mean: -0.2406654953956604, mean p set: 0.4477926790714264
loss_pred:0.013907437212765217, decouple_loss:0.0014308576937764883
Iteration: 5710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774284958839417, gen p mean: -0.2342832237482071, mean p set: 0.44832247495651245
loss_pred:0.014385579153895378, decouple_loss:0.0015652052825316787
The modified gen p mean: 0.4465333819389343, gen p mean: -0.24103683233261108, mean p set: 0.4471103250980377
loss_pred:0.014228294603526592, decouple_loss:0.0015144157223403454
The modified gen p mean: 0.44777196645736694, gen p mean: -0.24613185226917267, mean p set: 0.44830334186553955
loss_pred:0.013639280572533607, decouple_loss:0.0015259685460478067
2023-04-28 06:29:19 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24041952192783356, mean p set: 0.4499112665653229
loss_pred:0.014991873875260353, decouple_loss:0.0015705330297350883
The modified gen p mean: 0.4482696056365967, gen p mean: -0.2381265014410019, mean p set: 0.44879910349845886
loss_pred:0.014891637489199638, decouple_loss:0.001473141135647893
The modified gen p mean: 0.44929757714271545, gen p mean: -0.24023544788360596, mean p set: 0.4498290419578552
loss_pred:0.01454932615160942, decouple_loss:0.0015285926638171077
WV_1_PC_1_EH_0_PS_30, loss: 0.014887150377035141, avg_mse: 0.022041181102395058
current test mse: 0.022041
Iteration: 5711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664204120635986, gen p mean: -0.2398456484079361, mean p set: 0.4471730887889862
loss_pred:0.014053390361368656, decouple_loss:0.0015807108720764518
The modified gen p mean: 0.44718676805496216, gen p mean: -0.24553008377552032, mean p set: 0.44775745272636414
loss_pred:0.013916709460318089, decouple_loss:0.0014331614365801215
The modified gen p mean: 0.4478502869606018, gen p mean: -0.24242940545082092, mean p set: 0.44843369722366333
loss_pred:0.013540788553655148, decouple_loss:0.0015181752387434244
Iteration: 5712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477357566356659, gen p mean: -0.2459363490343094, mean p set: 0.4482541084289551
loss_pred:0.014125199988484383, decouple_loss:0.0013999331276863813
The modified gen p mean: 0.4481755793094635, gen p mean: -0.2456015646457672, mean p set: 0.44875964522361755
loss_pred:0.013781581073999405, decouple_loss:0.0014680486638098955
The modified gen p mean: 0.44737547636032104, gen p mean: -0.24008028209209442, mean p set: 0.4479508101940155
loss_pred:0.01407362800091505, decouple_loss:0.001724209520034492
Iteration: 5713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764718413352966, gen p mean: -0.24499692022800446, mean p set: 0.44817250967025757
loss_pred:0.013817735016345978, decouple_loss:0.0016090859426185489
The modified gen p mean: 0.4474143981933594, gen p mean: -0.2421674281358719, mean p set: 0.44799429178237915
loss_pred:0.013331369496881962, decouple_loss:0.0013981639640405774
The modified gen p mean: 0.44674232602119446, gen p mean: -0.24515272676944733, mean p set: 0.4473235309123993
loss_pred:0.013911821879446507, decouple_loss:0.0017096532974392176
Iteration: 5714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474029839038849, gen p mean: -0.24279345571994781, mean p set: 0.44792816042900085
loss_pred:0.01350029744207859, decouple_loss:0.0014167443150654435
The modified gen p mean: 0.4470999240875244, gen p mean: -0.24217194318771362, mean p set: 0.4476746618747711
loss_pred:0.013927627354860306, decouple_loss:0.001310257357545197
The modified gen p mean: 0.4475294053554535, gen p mean: -0.24958433210849762, mean p set: 0.44810402393341064
loss_pred:0.013576476834714413, decouple_loss:0.0014575386885553598
Iteration: 5715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795769453048706, gen p mean: -0.24428604543209076, mean p set: 0.4485393166542053
loss_pred:0.013220463879406452, decouple_loss:0.0014847841812297702
The modified gen p mean: 0.4465794563293457, gen p mean: -0.24592424929141998, mean p set: 0.44715774059295654The modified gen p mean: 0.4476749897003174, gen p mean: -0.24096839129924774, mean p set: 0.44820424914360046
loss_pred:0.013684825971722603, decouple_loss:0.001579398405738175
loss_pred:0.013919269666075706, decouple_loss:0.0014208494685590267
Iteration: 5716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485405385494232, gen p mean: -0.2438940554857254, mean p set: 0.449113667011261
loss_pred:0.013803866691887379, decouple_loss:0.0016690926859155297
The modified gen p mean: 0.447243332862854, gen p mean: -0.24798716604709625, mean p set: 0.44781628251075745The modified gen p mean: 0.44601988792419434, gen p mean: -0.24574439227581024, mean p set: 0.4465450048446655
loss_pred:0.014124619774520397, decouple_loss:0.0014583010924980044
loss_pred:0.013757176697254181, decouple_loss:0.0016261861892417073
Iteration: 5717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716042280197144, gen p mean: -0.23981298506259918, mean p set: 0.44773492217063904
loss_pred:0.013578358106315136, decouple_loss:0.0016536455368623137
The modified gen p mean: 0.44637495279312134, gen p mean: -0.23536820709705353, mean p set: 0.4469052851200104The modified gen p mean: 0.4480680525302887, gen p mean: -0.24085275828838348, mean p set: 0.4486377537250519
loss_pred:0.01368401013314724, decouple_loss:0.0015713482862338424
loss_pred:0.013861495070159435, decouple_loss:0.001749933697283268
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658365845680237, gen p mean: -0.2357291877269745, mean p set: 0.4471621811389923
loss_pred:0.013577182777225971, decouple_loss:0.001673834747634828
The modified gen p mean: 0.44552865624427795, gen p mean: -0.23230424523353577, mean p set: 0.4460587203502655The modified gen p mean: 0.44622373580932617, gen p mean: -0.2408115416765213, mean p set: 0.4468037486076355
loss_pred:0.014120770618319511, decouple_loss:0.0015878283884376287
loss_pred:0.01346421055495739, decouple_loss:0.001622634008526802
Iteration: 5719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479922354221344, gen p mean: -0.2353452891111374, mean p set: 0.4485742151737213
loss_pred:0.013597520999610424, decouple_loss:0.0016810356173664331
The modified gen p mean: 0.44727420806884766, gen p mean: -0.2400801181793213, mean p set: 0.44780153036117554
loss_pred:0.01427567470818758, decouple_loss:0.001833538175560534
The modified gen p mean: 0.44724538922309875, gen p mean: -0.23507238924503326, mean p set: 0.44781988859176636
loss_pred:0.014282457530498505, decouple_loss:0.0017920475220307708
Iteration: 5720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784027338027954, gen p mean: -0.2351565808057785, mean p set: 0.44840726256370544
loss_pred:0.013779056258499622, decouple_loss:0.0015073275426402688
The modified gen p mean: 0.4466513991355896, gen p mean: -0.23314358294010162, mean p set: 0.447177916765213The modified gen p mean: 0.4485509693622589, gen p mean: -0.23467227816581726, mean p set: 0.4491317868232727
loss_pred:0.013230766169726849, decouple_loss:0.0017082525882869959
loss_pred:0.013426484540104866, decouple_loss:0.0016282262513414025
2023-04-28 06:32:43 testing...
The modified gen p mean: 0.44826459884643555, gen p mean: -0.23452694714069366, mean p set: 0.44879910349845886
loss_pred:0.014887346886098385, decouple_loss:0.001463240128941834
The modified gen p mean: 0.44929802417755127, gen p mean: -0.23658402264118195, mean p set: 0.4498290419578552
loss_pred:0.014519295655190945, decouple_loss:0.0014228239888325334
The modified gen p mean: 0.4494309425354004, gen p mean: -0.2363688051700592, mean p set: 0.4499112665653229
loss_pred:0.014983899891376495, decouple_loss:0.0015706951962783933
WV_1_PC_1_EH_0_PS_30, loss: 0.014871126972138882, avg_mse: 0.022021714597940445
current test mse: 0.022022
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 5721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472467005252838, gen p mean: -0.23904970288276672, mean p set: 0.4477825164794922
loss_pred:0.01448219083249569, decouple_loss:0.0015600974438712
The modified gen p mean: 0.4478261470794678, gen p mean: -0.23385325074195862, mean p set: 0.44839873909950256
The modified gen p mean: 0.44773000478744507, gen p mean: -0.2326521873474121, mean p set: 0.4483031630516052
loss_pred:0.014436631463468075, decouple_loss:0.0014429469592869282
loss_pred:0.014430541545152664, decouple_loss:0.0014871556777507067
Iteration: 5722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710347056388855, gen p mean: -0.23124103248119354, mean p set: 0.4476318955421448
loss_pred:0.01471894234418869, decouple_loss:0.0013824637280777097
The modified gen p mean: 0.44735410809516907, gen p mean: -0.23900772631168365, mean p set: 0.4479339122772217
The modified gen p mean: 0.44818535447120667, gen p mean: -0.23527713119983673, mean p set: 0.4487583637237549
loss_pred:0.014392238110303879, decouple_loss:0.0013979123905301094
loss_pred:0.014259982854127884, decouple_loss:0.0014961109263822436
Iteration: 5723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482609033584595, gen p mean: -0.23672614991664886, mean p set: 0.44878846406936646
loss_pred:0.013582739047706127, decouple_loss:0.0013565211556851864
The modified gen p mean: 0.4477643370628357, gen p mean: -0.23866526782512665, mean p set: 0.448335200548172
The modified gen p mean: 0.44802772998809814, gen p mean: -0.2396550476551056, mean p set: 0.448603093624115
loss_pred:0.013862570747733116, decouple_loss:0.0014657023129984736
loss_pred:0.014137308113276958, decouple_loss:0.0013300778809934855
Iteration: 5724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681882858276367, gen p mean: -0.23957766592502594, mean p set: 0.44740280508995056
loss_pred:0.014058615081012249, decouple_loss:0.00143709487747401
The modified gen p mean: 0.4477914869785309, gen p mean: -0.23858152329921722, mean p set: 0.44831880927085876The modified gen p mean: 0.4473158121109009, gen p mean: -0.2359030395746231, mean p set: 0.447892427444458
loss_pred:0.014243646524846554, decouple_loss:0.001547688734717667
loss_pred:0.014480440877377987, decouple_loss:0.0015414230292662978
Iteration: 5725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853830337524414, gen p mean: -0.23759132623672485, mean p set: 0.44911372661590576
loss_pred:0.013986415229737759, decouple_loss:0.0014343863585963845
The modified gen p mean: 0.44843313097953796, gen p mean: -0.23321355879306793, mean p set: 0.4490111172199249
loss_pred:0.013481976464390755, decouple_loss:0.0015037154080346227
The modified gen p mean: 0.44818115234375, gen p mean: -0.23403595387935638, mean p set: 0.44870471954345703
loss_pred:0.014354619197547436, decouple_loss:0.001440079533495009
Iteration: 5726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730865955352783, gen p mean: -0.2297145277261734, mean p set: 0.4478871822357178
loss_pred:0.014639374800026417, decouple_loss:0.0013847996015101671
The modified gen p mean: 0.4477161169052124, gen p mean: -0.23624196648597717, mean p set: 0.4482938349246979The modified gen p mean: 0.44827547669410706, gen p mean: -0.23411302268505096, mean p set: 0.4488029479980469
loss_pred:0.013783802278339863, decouple_loss:0.0014518668176606297
loss_pred:0.013785498216748238, decouple_loss:0.0013953285524621606
Iteration: 5727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771966338157654, gen p mean: -0.2352130264043808, mean p set: 0.44829073548316956
loss_pred:0.014322314411401749, decouple_loss:0.0014671477256342769
The modified gen p mean: 0.4472522735595703, gen p mean: -0.2371923327445984, mean p set: 0.4478394687175751
loss_pred:0.014121883548796177, decouple_loss:0.0015963834011927247
The modified gen p mean: 0.4481554627418518, gen p mean: -0.2344021201133728, mean p set: 0.4486865699291229
loss_pred:0.013995231129229069, decouple_loss:0.0015930453082546592
Iteration: 5728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483487010002136, gen p mean: -0.23121079802513123, mean p set: 0.4489271342754364
loss_pred:0.013719866052269936, decouple_loss:0.0015257599297910929
The modified gen p mean: 0.44792529940605164, gen p mean: -0.23263154923915863, mean p set: 0.44845762848854065The modified gen p mean: 0.44815802574157715, gen p mean: -0.23279131948947906, mean p set: 0.44872552156448364
loss_pred:0.014201050624251366, decouple_loss:0.00140691502019763
loss_pred:0.013532230630517006, decouple_loss:0.0015670948196202517
Iteration: 5729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781988859176636, gen p mean: -0.2370063215494156, mean p set: 0.4483935534954071
loss_pred:0.013649754226207733, decouple_loss:0.002114067319780588
The modified gen p mean: 0.44752955436706543, gen p mean: -0.23774822056293488, mean p set: 0.44810402393341064
loss_pred:0.013559913262724876, decouple_loss:0.0020783727522939444
The modified gen p mean: 0.44780421257019043, gen p mean: -0.2332005798816681, mean p set: 0.4483359158039093
loss_pred:0.013862935826182365, decouple_loss:0.0017623334424570203
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 5730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479905068874359, gen p mean: -0.23722471296787262, mean p set: 0.44857192039489746
loss_pred:0.014481513760983944, decouple_loss:0.001497881137765944
The modified gen p mean: 0.4481421411037445, gen p mean: -0.23851177096366882, mean p set: 0.44871973991394043
loss_pred:0.014145338907837868, decouple_loss:0.0015375949442386627
The modified gen p mean: 0.4472917914390564, gen p mean: -0.23543326556682587, mean p set: 0.44781461358070374
loss_pred:0.01446261815726757, decouple_loss:0.0015129558742046356
2023-04-28 06:36:58 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.24083435535430908, mean p set: 0.4499112665653229
loss_pred:0.014963570050895214, decouple_loss:0.001970882760360837
The modified gen p mean: 0.44929933547973633, gen p mean: -0.2411605715751648, mean p set: 0.4498290419578552
The modified gen p mean: 0.4482666254043579, gen p mean: -0.23906952142715454, mean p set: 0.44879910349845886
loss_pred:0.01454140618443489, decouple_loss:0.0019441008334979415
loss_pred:0.01483964268118143, decouple_loss:0.0019594489131122828
WV_1_PC_1_EH_0_PS_30, loss: 0.014879448339343071, avg_mse: 0.021968046203255653
current test mse: 0.021968
Iteration: 5731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476909041404724, gen p mean: -0.24148012697696686, mean p set: 0.4482678174972534
loss_pred:0.014000188559293747, decouple_loss:0.0017139220144599676
The modified gen p mean: 0.4474131762981415, gen p mean: -0.23857152462005615, mean p set: 0.4479440450668335
loss_pred:0.01412985473871231, decouple_loss:0.0017177988775074482
The modified gen p mean: 0.4479224383831024, gen p mean: -0.24258480966091156, mean p set: 0.4485013484954834
loss_pred:0.014033794403076172, decouple_loss:0.0019017626764252782
Iteration: 5732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718024134635925, gen p mean: -0.24465154111385345, mean p set: 0.447712779045105
loss_pred:0.014308936893939972, decouple_loss:0.0016519714845344424
The modified gen p mean: 0.4480099380016327, gen p mean: -0.24266168475151062, mean p set: 0.44858577847480774
The modified gen p mean: 0.44765448570251465, gen p mean: -0.23932678997516632, mean p set: 0.44823122024536133
loss_pred:0.013773186132311821, decouple_loss:0.0016966804396361113
loss_pred:0.014219156466424465, decouple_loss:0.0016187755391001701
Iteration: 5733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486769437789917, gen p mean: -0.2379535287618637, mean p set: 0.44920313358306885
loss_pred:0.01377619244158268, decouple_loss:0.001889048027805984
The modified gen p mean: 0.4464702606201172, gen p mean: -0.2410440742969513, mean p set: 0.4470512866973877
The modified gen p mean: 0.44802194833755493, gen p mean: -0.2383783608675003, mean p set: 0.4485968351364136loss_pred:0.01393632311373949, decouple_loss:0.0018019943963736296
loss_pred:0.013800007291138172, decouple_loss:0.0018038642592728138
Iteration: 5734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781017303466797, gen p mean: -0.2344483882188797, mean p set: 0.4483374059200287
loss_pred:0.013764222152531147, decouple_loss:0.001516258460469544
The modified gen p mean: 0.44811853766441345, gen p mean: -0.23143815994262695, mean p set: 0.44869464635849
The modified gen p mean: 0.4478738307952881, gen p mean: -0.22864942252635956, mean p set: 0.4484493136405945
loss_pred:0.013992863707244396, decouple_loss:0.0016716544050723314
loss_pred:0.01368203666061163, decouple_loss:0.001727566821500659
Iteration: 5735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878727197647095, gen p mean: -0.23196637630462646, mean p set: 0.44936102628707886
loss_pred:0.013403390534222126, decouple_loss:0.001972475089132786
The modified gen p mean: 0.4479074776172638, gen p mean: -0.23173147439956665, mean p set: 0.4484356641769409The modified gen p mean: 0.44742724299430847, gen p mean: -0.23025886714458466, mean p set: 0.44800689816474915
loss_pred:0.014126596972346306, decouple_loss:0.0018511632224544883loss_pred:0.014020256698131561, decouple_loss:0.0015976406866684556
Iteration: 5736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469121992588043, gen p mean: -0.23618283867835999, mean p set: 0.44748347997665405
loss_pred:0.014007443562150002, decouple_loss:0.0015557111473754048
The modified gen p mean: 0.44810962677001953, gen p mean: -0.2329622507095337, mean p set: 0.44864311814308167The modified gen p mean: 0.4486886262893677, gen p mean: -0.23647873103618622, mean p set: 0.4492678940296173
loss_pred:0.013616259209811687, decouple_loss:0.0013725332682952285
loss_pred:0.013779808767139912, decouple_loss:0.0015655383467674255
Iteration: 5737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466741979122162, gen p mean: -0.2375994622707367, mean p set: 0.44724538922309875
loss_pred:0.014452059753239155, decouple_loss:0.0014426651177927852
The modified gen p mean: 0.4475744664669037, gen p mean: -0.23955819010734558, mean p set: 0.4481017291545868The modified gen p mean: 0.4480712115764618, gen p mean: -0.23673734068870544, mean p set: 0.44864511489868164
loss_pred:0.01371470931917429, decouple_loss:0.0016842485638335347
loss_pred:0.013678177259862423, decouple_loss:0.001437049126252532
Iteration: 5738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469324052333832, gen p mean: -0.2440098226070404, mean p set: 0.4475124180316925
loss_pred:0.014171061106026173, decouple_loss:0.0014323050854727626
The modified gen p mean: 0.44801250100135803, gen p mean: -0.23900747299194336, mean p set: 0.4485422670841217The modified gen p mean: 0.4462793171405792, gen p mean: -0.2446521371603012, mean p set: 0.44685330986976624
loss_pred:0.013997900299727917, decouple_loss:0.0015017957193776965
loss_pred:0.013875618577003479, decouple_loss:0.001590911066159606
Iteration: 5739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486630856990814, gen p mean: -0.24255160987377167, mean p set: 0.4492388963699341
loss_pred:0.013750294223427773, decouple_loss:0.0015528742223978043
The modified gen p mean: 0.4460756778717041, gen p mean: -0.245279461145401, mean p set: 0.44664737582206726The modified gen p mean: 0.44778385758399963, gen p mean: -0.23982098698616028, mean p set: 0.44831034541130066
loss_pred:0.014227297157049179, decouple_loss:0.0016741702565923333
loss_pred:0.014361897483468056, decouple_loss:0.001644361182115972
Iteration: 5740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791069626808167, gen p mean: -0.23703962564468384, mean p set: 0.44848933815956116
loss_pred:0.013483867049217224, decouple_loss:0.0015176237793639302
The modified gen p mean: 0.4487520754337311, gen p mean: -0.24062354862689972, mean p set: 0.44927188754081726The modified gen p mean: 0.44881486892700195, gen p mean: -0.23551762104034424, mean p set: 0.44938814640045166
loss_pred:0.014267689548432827, decouple_loss:0.0017041451064869761
loss_pred:0.013619783334434032, decouple_loss:0.0016125544207170606
2023-04-28 06:40:21 testing...
The modified gen p mean: 0.4494309425354004, gen p mean: -0.23394745588302612, mean p set: 0.4499112665653229
loss_pred:0.014996841549873352, decouple_loss:0.0017976025119423866
The modified gen p mean: 0.4482693672180176, gen p mean: -0.23219694197177887, mean p set: 0.44879910349845886
loss_pred:0.014882117509841919, decouple_loss:0.0019424532074481249
The modified gen p mean: 0.4493003487586975, gen p mean: -0.2342739850282669, mean p set: 0.4498290419578552
loss_pred:0.014585776254534721, decouple_loss:0.0018873176304623485
WV_1_PC_1_EH_0_PS_30, loss: 0.014915368519723415, avg_mse: 0.022037804126739502
current test mse: 0.022038
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 5741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485510289669037, gen p mean: -0.23339250683784485, mean p set: 0.4490780532360077
loss_pred:0.013355867005884647, decouple_loss:0.0018689882708713412
The modified gen p mean: 0.44868040084838867, gen p mean: -0.23307444155216217, mean p set: 0.4492571949958801
loss_pred:0.012901696376502514, decouple_loss:0.0022880262695252895
The modified gen p mean: 0.4472104012966156, gen p mean: -0.2344825565814972, mean p set: 0.4477807283401489
loss_pred:0.014073123224079609, decouple_loss:0.0017473145853728056
Iteration: 5742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791340827941895, gen p mean: -0.2383352816104889, mean p set: 0.44844159483909607
loss_pred:0.012956598773598671, decouple_loss:0.001846218015998602
The modified gen p mean: 0.4481319785118103, gen p mean: -0.2334054708480835, mean p set: 0.4487045109272003
loss_pred:0.013201245106756687, decouple_loss:0.0016952799633145332
The modified gen p mean: 0.4471912384033203, gen p mean: -0.23426523804664612, mean p set: 0.44776979088783264
loss_pred:0.013131910003721714, decouple_loss:0.0016602827236056328
Iteration: 5743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475766122341156, gen p mean: -0.2311306893825531, mean p set: 0.4481014907360077
loss_pred:0.0132575873285532, decouple_loss:0.0017917180666700006
The modified gen p mean: 0.4479343295097351, gen p mean: -0.23141397535800934, mean p set: 0.4485081434249878
loss_pred:0.013520504347980022, decouple_loss:0.0018601027550175786
The modified gen p mean: 0.4480280578136444, gen p mean: -0.23645251989364624, mean p set: 0.44860297441482544
loss_pred:0.013003380037844181, decouple_loss:0.0017138405237346888
Iteration: 5744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479871988296509, gen p mean: -0.23868371546268463, mean p set: 0.4485073983669281
loss_pred:0.013189285062253475, decouple_loss:0.0017511365003883839
The modified gen p mean: 0.44740331172943115, gen p mean: -0.23189716041088104, mean p set: 0.44798383116722107
loss_pred:0.014368697069585323, decouple_loss:0.0018751522293314338
The modified gen p mean: 0.44807273149490356, gen p mean: -0.2366950958967209, mean p set: 0.44865697622299194
loss_pred:0.013385511003434658, decouple_loss:0.001810499932616949
Iteration: 5745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767895340919495, gen p mean: -0.23596425354480743, mean p set: 0.4482528567314148
loss_pred:0.012763611041009426, decouple_loss:0.0019778688438236713
The modified gen p mean: 0.4485575258731842, gen p mean: -0.23917149007320404, mean p set: 0.449133038520813The modified gen p mean: 0.44746890664100647, gen p mean: -0.23790214955806732, mean p set: 0.4479990005493164
loss_pred:0.01360435038805008, decouple_loss:0.001826381660066545loss_pred:0.013140750117599964, decouple_loss:0.0017795226303860545
