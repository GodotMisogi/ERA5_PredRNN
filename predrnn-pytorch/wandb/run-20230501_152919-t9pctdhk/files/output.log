/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 125
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486444890499115, gen p mean: -0.0005436890642158687, mean p set: 0.4491247832775116
loss_pred:0.1622544527053833, decouple_loss:0.07153792679309845
The modified gen p mean: 0.4488782286643982, gen p mean: -0.0005033519701100886, mean p set: 0.4493584930896759
loss_pred:0.16636668145656586, decouple_loss:0.0697764903306961
The modified gen p mean: 0.4492141306400299, gen p mean: -0.0004203704302199185, mean p set: 0.44969442486763
loss_pred:0.1728825718164444, decouple_loss:0.07003632932901382
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922593235969543, gen p mean: 0.0013578851940110326, mean p set: 0.4497062563896179
The modified gen p mean: 0.4501723051071167, gen p mean: 0.0010922806104645133, mean p set: 0.4506526291370392
The modified gen p mean: 0.4497392773628235, gen p mean: 0.0012088767252862453, mean p set: 0.4502195417881012
loss_pred:0.16481739282608032, decouple_loss:0.22358804941177368
loss_pred:0.16375914216041565, decouple_loss:0.22301220893859863
loss_pred:0.1687035858631134, decouple_loss:0.21978327631950378
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488111734390259, gen p mean: 0.00149542058352381, mean p set: 0.44929149746894836
The modified gen p mean: 0.4479087293148041, gen p mean: 0.0016592246247455478, mean p set: 0.4483890235424042
loss_pred:0.1599208265542984, decouple_loss:0.34566837549209595
loss_pred:0.1580459177494049, decouple_loss:0.3459291458129883
The modified gen p mean: 0.4489961862564087, gen p mean: 0.0016458557220175862, mean p set: 0.4494764804840088
loss_pred:0.1638117879629135, decouple_loss:0.344283789396286
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486680030822754, gen p mean: -0.00028676577494479716, mean p set: 0.4491483271121979
The modified gen p mean: 0.4495718479156494, gen p mean: -0.0002577480918262154, mean p set: 0.4500521421432495
loss_pred:0.14756953716278076, decouple_loss:0.5521240830421448
loss_pred:0.14834026992321014, decouple_loss:0.5554907321929932
The modified gen p mean: 0.44877374172210693, gen p mean: -0.00027759195654653013, mean p set: 0.44925400614738464
loss_pred:0.14738768339157104, decouple_loss:0.5535023212432861
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502822160720825, gen p mean: -0.005290469620376825, mean p set: 0.4507625102996826
The modified gen p mean: 0.44872575998306274, gen p mean: -0.005262854974716902, mean p set: 0.44920605421066284
loss_pred:0.1382538229227066, decouple_loss:0.5823034048080444
loss_pred:0.13633182644844055, decouple_loss:0.5833828449249268
The modified gen p mean: 0.4482547640800476, gen p mean: -0.005270970985293388, mean p set: 0.4487350583076477
loss_pred:0.136269673705101, decouple_loss:0.5810511708259583
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947925209999084, gen p mean: -0.0010109867434948683, mean p set: 0.44995957612991333
The modified gen p mean: 0.4496627151966095, gen p mean: -0.0010235594818368554, mean p set: 0.4501429796218872
loss_pred:0.13503484427928925, decouple_loss:0.5609617829322815
loss_pred:0.14225728809833527, decouple_loss:0.5586356520652771
The modified gen p mean: 0.4492074251174927, gen p mean: -0.0009974613785743713, mean p set: 0.4496876895427704
loss_pred:0.14066658914089203, decouple_loss:0.5569348931312561
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013242959976196, gen p mean: -0.000695380789693445, mean p set: 0.45061272382736206
The modified gen p mean: 0.44819748401641846, gen p mean: -0.0006964491913095117, mean p set: 0.44867777824401855
loss_pred:0.13233797252178192, decouple_loss:0.5657675862312317
loss_pred:0.1292175054550171, decouple_loss:0.5665193200111389
The modified gen p mean: 0.44904962182044983, gen p mean: -0.0006974879652261734, mean p set: 0.4495299160480499
loss_pred:0.131763756275177, decouple_loss:0.5680901408195496
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492981731891632, gen p mean: -0.002322086598724127, mean p set: 0.4497784972190857
loss_pred:0.1395626962184906, decouple_loss:0.44917795062065125
The modified gen p mean: 0.4487052857875824, gen p mean: -0.0023644808679819107, mean p set: 0.4491855800151825The modified gen p mean: 0.4484509229660034, gen p mean: -0.002373297233134508, mean p set: 0.4489312171936035
loss_pred:0.13630641996860504, decouple_loss:0.45218563079833984
loss_pred:0.13721437752246857, decouple_loss:0.44508096575737
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877657294273376, gen p mean: -0.0013509688433259726, mean p set: 0.44925686717033386
loss_pred:0.13065992295742035, decouple_loss:0.5393993258476257
The modified gen p mean: 0.44972896575927734, gen p mean: -0.0013487270334735513, mean p set: 0.45020923018455505The modified gen p mean: 0.449749231338501, gen p mean: -0.00134603853803128, mean p set: 0.4502294957637787
loss_pred:0.1328819990158081, decouple_loss:0.5459405183792114
loss_pred:0.13086563348770142, decouple_loss:0.5439826250076294
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895657896995544, gen p mean: 0.00029186790925450623, mean p set: 0.44943687319755554
loss_pred:0.12384705990552902, decouple_loss:0.42908141016960144
The modified gen p mean: 0.4494568109512329, gen p mean: 0.0003011215594597161, mean p set: 0.4499370753765106The modified gen p mean: 0.44919371604919434, gen p mean: 0.0003052571846637875, mean p set: 0.44967401027679443
loss_pred:0.12580913305282593, decouple_loss:0.42855554819107056
loss_pred:0.1226668581366539, decouple_loss:0.4322443902492523
2023-05-01 15:32:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: 0.00040542494389228523, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: 0.00039105743053369224, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: 0.00040292306221090257, mean p set: 0.4500633478164673
loss_pred:0.12684309482574463, decouple_loss:0.38534748554229736
loss_pred:0.12645992636680603, decouple_loss:0.3839259147644043
loss_pred:0.12559480965137482, decouple_loss:0.3837658762931824
WV_0_PC_1_EH_0_PS_40_5, loss: 0.14551660418510437, avg_mse: 0.12615488469600677
current test mse: 0.126155
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481431543827057, gen p mean: 0.0004069002461619675, mean p set: 0.4486234188079834
The modified gen p mean: 0.44987934827804565, gen p mean: 0.00042088277405127883, mean p set: 0.45035961270332336
loss_pred:0.12615792453289032, decouple_loss:0.381496399641037
The modified gen p mean: 0.4485275149345398, gen p mean: 0.0004129052103962749, mean p set: 0.4490078091621399
loss_pred:0.13280777633190155, decouple_loss:0.38432765007019043
loss_pred:0.12087829411029816, decouple_loss:0.3841995298862457
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854292273521423, gen p mean: -0.0002555190585553646, mean p set: 0.44902318716049194
loss_pred:0.11899878084659576, decouple_loss:0.3514472246170044
The modified gen p mean: 0.44935736060142517, gen p mean: -0.00040332041680812836, mean p set: 0.44983765482902527The modified gen p mean: 0.45037806034088135, gen p mean: -0.00039683253271505237, mean p set: 0.45085832476615906
loss_pred:0.128714457154274, decouple_loss:0.3427368700504303
loss_pred:0.12251453101634979, decouple_loss:0.3448953926563263
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985103607177734, gen p mean: -0.0016771906521171331, mean p set: 0.45033130049705505
The modified gen p mean: 0.44969406723976135, gen p mean: -0.0016714626690372825, mean p set: 0.45017439126968384
loss_pred:0.11857902258634567, decouple_loss:0.4296087324619293
loss_pred:0.12091024965047836, decouple_loss:0.42698755860328674
The modified gen p mean: 0.4489402174949646, gen p mean: -0.0017329086549580097, mean p set: 0.4494204819202423
loss_pred:0.12258118391036987, decouple_loss:0.42820584774017334
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827064871788025, gen p mean: -0.0023290454410016537, mean p set: 0.44875091314315796
loss_pred:0.11879397183656693, decouple_loss:0.2895262539386749
The modified gen p mean: 0.44816696643829346, gen p mean: -0.002351328730583191, mean p set: 0.44864723086357117The modified gen p mean: 0.4497009813785553, gen p mean: -0.002144626108929515, mean p set: 0.4501812756061554
loss_pred:0.12121900171041489, decouple_loss:0.2875238060951233
loss_pred:0.11810138821601868, decouple_loss:0.2912465035915375
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489441514015198, gen p mean: -0.0005644148332066834, mean p set: 0.4494244158267975
The modified gen p mean: 0.44971853494644165, gen p mean: -0.0005652025574818254, mean p set: 0.45019885897636414
loss_pred:0.12414535880088806, decouple_loss:0.377780020236969
loss_pred:0.11825579404830933, decouple_loss:0.37680569291114807
The modified gen p mean: 0.44917985796928406, gen p mean: -0.0005536717944778502, mean p set: 0.44966015219688416
loss_pred:0.12355302274227142, decouple_loss:0.38177838921546936
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494662582874298, gen p mean: -0.0019423136254772544, mean p set: 0.4499465525150299
The modified gen p mean: 0.4496510326862335, gen p mean: -0.0018232123693451285, mean p set: 0.4501313269138336
loss_pred:0.1206333190202713, decouple_loss:0.25603166222572327
loss_pred:0.11547400802373886, decouple_loss:0.25533327460289
The modified gen p mean: 0.4486953318119049, gen p mean: -0.002040436491370201, mean p set: 0.449175626039505
loss_pred:0.11342301219701767, decouple_loss:0.26001518964767456
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498935341835022, gen p mean: -0.006362943910062313, mean p set: 0.4503738284111023
loss_pred:0.11329863220453262, decouple_loss:0.2645248770713806
The modified gen p mean: 0.4496336579322815, gen p mean: -0.0064477697014808655, mean p set: 0.450113981962204The modified gen p mean: 0.4490707218647003, gen p mean: -0.0065434155985713005, mean p set: 0.4495510160923004
loss_pred:0.11991161108016968, decouple_loss:0.2646377682685852
loss_pred:0.11457018554210663, decouple_loss:0.2611299157142639
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497183859348297, gen p mean: -0.0024668225087225437, mean p set: 0.4501986801624298
The modified gen p mean: 0.44948074221611023, gen p mean: -0.0026439472567290068, mean p set: 0.4499610364437103
loss_pred:0.11255431920289993, decouple_loss:0.25031501054763794
loss_pred:0.11642402410507202, decouple_loss:0.24578629434108734
The modified gen p mean: 0.4499937891960144, gen p mean: -0.002493936335667968, mean p set: 0.4504740536212921
loss_pred:0.11067178100347519, decouple_loss:0.2500520646572113
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495932459831238, gen p mean: -0.004379690624773502, mean p set: 0.4500735104084015
The modified gen p mean: 0.44877198338508606, gen p mean: -0.004680518060922623, mean p set: 0.44925227761268616
loss_pred:0.10751405358314514, decouple_loss:0.2411939799785614
loss_pred:0.1098933219909668, decouple_loss:0.24662858247756958
The modified gen p mean: 0.44961875677108765, gen p mean: -0.004597523715347052, mean p set: 0.45009905099868774
loss_pred:0.11103647202253342, decouple_loss:0.24005787074565887
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499054551124573, gen p mean: -0.00603472488000989, mean p set: 0.450385719537735
The modified gen p mean: 0.44849124550819397, gen p mean: -0.006001895293593407, mean p set: 0.44897153973579407
loss_pred:0.106270931661129, decouple_loss:0.23275315761566162
loss_pred:0.10703443735837936, decouple_loss:0.22666628658771515
The modified gen p mean: 0.44995805621147156, gen p mean: -0.006037539336830378, mean p set: 0.45043838024139404
loss_pred:0.10731250047683716, decouple_loss:0.22998283803462982
2023-05-01 15:34:47 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.010799060575664043, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.011699942871928215, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.011143992654979229, mean p set: 0.4500633478164673
loss_pred:0.10840997099876404, decouple_loss:0.23072730004787445
loss_pred:0.10911427438259125, decouple_loss:0.23082637786865234
loss_pred:0.10833051800727844, decouple_loss:0.22965408861637115
WV_0_PC_1_EH_0_PS_40_5, loss: 0.12013839185237885, avg_mse: 0.10829225182533264
current test mse: 0.108292
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480019211769104, gen p mean: -0.011273548938333988, mean p set: 0.4484822154045105
loss_pred:0.10761707276105881, decouple_loss:0.2339038848876953
The modified gen p mean: 0.4481147527694702, gen p mean: -0.01168075017631054, mean p set: 0.4485950171947479The modified gen p mean: 0.44806358218193054, gen p mean: -0.011464248411357403, mean p set: 0.44854387640953064
loss_pred:0.10611645132303238, decouple_loss:0.23220473527908325
loss_pred:0.10722585767507553, decouple_loss:0.23095406591892242
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475157856941223, gen p mean: -0.007169597316533327, mean p set: 0.4479960799217224
The modified gen p mean: 0.44778385758399963, gen p mean: -0.007150827441364527, mean p set: 0.44826412200927734
loss_pred:0.10179395973682404, decouple_loss:0.21141858398914337
loss_pred:0.10183952748775482, decouple_loss:0.2127033770084381
The modified gen p mean: 0.4475034475326538, gen p mean: -0.0072235227562487125, mean p set: 0.4479837417602539
loss_pred:0.10686018317937851, decouple_loss:0.20900440216064453
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771313667297363, gen p mean: -0.00906442105770111, mean p set: 0.44819343090057373
The modified gen p mean: 0.448133647441864, gen p mean: -0.00926344096660614, mean p set: 0.4486139416694641
The modified gen p mean: 0.4483509063720703, gen p mean: -0.009194992482662201, mean p set: 0.4488312005996704
loss_pred:0.10465829074382782, decouple_loss:0.18952280282974243
loss_pred:0.10649242997169495, decouple_loss:0.19218458235263824
loss_pred:0.10654176026582718, decouple_loss:0.193375825881958
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477161765098572, gen p mean: -0.011013519018888474, mean p set: 0.44819650053977966
The modified gen p mean: 0.44880369305610657, gen p mean: -0.011156002059578896, mean p set: 0.44928398728370667
The modified gen p mean: 0.4482947289943695, gen p mean: -0.01078745722770691, mean p set: 0.448775053024292
loss_pred:0.1015530675649643, decouple_loss:0.17680543661117554
loss_pred:0.09953111410140991, decouple_loss:0.17565317451953888loss_pred:0.10183686763048172, decouple_loss:0.17964905500411987
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799745082855225, gen p mean: -0.017828339710831642, mean p set: 0.44847777485847473
The modified gen p mean: 0.44753900170326233, gen p mean: -0.017161250114440918, mean p set: 0.4480193257331848
loss_pred:0.10166756808757782, decouple_loss:0.16768436133861542
loss_pred:0.09712709486484528, decouple_loss:0.1670227348804474
The modified gen p mean: 0.4476363956928253, gen p mean: -0.017498625442385674, mean p set: 0.4481166899204254
loss_pred:0.09656186401844025, decouple_loss:0.16541758179664612
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811728596687317, gen p mean: -0.013866734690964222, mean p set: 0.44859760999679565
The modified gen p mean: 0.44754910469055176, gen p mean: -0.014308754354715347, mean p set: 0.44802939891815186
loss_pred:0.09570669382810593, decouple_loss:0.1610027700662613
loss_pred:0.10201612114906311, decouple_loss:0.16047586500644684
The modified gen p mean: 0.4491630792617798, gen p mean: -0.014235034584999084, mean p set: 0.4496433436870575
loss_pred:0.09768258780241013, decouple_loss:0.16488097608089447
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878119230270386, gen p mean: -0.017127808183431625, mean p set: 0.44926151633262634
The modified gen p mean: 0.447795033454895, gen p mean: -0.016834964975714684, mean p set: 0.4482753276824951
The modified gen p mean: 0.4478529691696167, gen p mean: -0.017175523564219475, mean p set: 0.4483332633972168
loss_pred:0.09883582592010498, decouple_loss:0.1425378918647766
loss_pred:0.09367573261260986, decouple_loss:0.1431887000799179loss_pred:0.0915353074669838, decouple_loss:0.14387103915214539
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479043781757355, gen p mean: -0.024421190842986107, mean p set: 0.44838467240333557
The modified gen p mean: 0.4476151466369629, gen p mean: -0.02426563948392868, mean p set: 0.448095440864563
loss_pred:0.09536772221326828, decouple_loss:0.14618661999702454
loss_pred:0.09488175064325333, decouple_loss:0.14533181488513947
The modified gen p mean: 0.448560506105423, gen p mean: -0.023999327793717384, mean p set: 0.44904080033302307
loss_pred:0.0921967402100563, decouple_loss:0.14403095841407776
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788503646850586, gen p mean: -0.021263903006911278, mean p set: 0.44836533069610596The modified gen p mean: 0.4474197030067444, gen p mean: -0.02110876701772213, mean p set: 0.4478999972343445
loss_pred:0.09081614762544632, decouple_loss:0.14081348478794098loss_pred:0.09125526994466782, decouple_loss:0.13920380175113678
The modified gen p mean: 0.44719934463500977, gen p mean: -0.021657153964042664, mean p set: 0.4476796090602875
loss_pred:0.09482128173112869, decouple_loss:0.13604561984539032
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791802763938904, gen p mean: -0.023876531049609184, mean p set: 0.44839832186698914
The modified gen p mean: 0.44780269265174866, gen p mean: -0.02323574386537075, mean p set: 0.44828298687934875
loss_pred:0.08927804976701736, decouple_loss:0.12539133429527283
loss_pred:0.09023991972208023, decouple_loss:0.1255468726158142
The modified gen p mean: 0.4484274089336395, gen p mean: -0.023606006056070328, mean p set: 0.4489077031612396
loss_pred:0.09124847501516342, decouple_loss:0.12885741889476776
2023-05-01 15:37:37 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.02619756944477558, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.026210013777017593, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.026491239666938782, mean p set: 0.45035696029663086
loss_pred:0.08853519707918167, decouple_loss:0.11841794848442078
loss_pred:0.08925823122262955, decouple_loss:0.11825215071439743
loss_pred:0.08919572830200195, decouple_loss:0.11936357617378235
WV_0_PC_1_EH_0_PS_40_5, loss: 0.09493027627468109, avg_mse: 0.0884406641125679
current test mse: 0.088441
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822627305984497, gen p mean: -0.026333196088671684, mean p set: 0.4487065374851227
The modified gen p mean: 0.4472784698009491, gen p mean: -0.02656688168644905, mean p set: 0.4477587640285492
loss_pred:0.08959975093603134, decouple_loss:0.11574595421552658
The modified gen p mean: 0.4477713406085968, gen p mean: -0.02637695148587227, mean p set: 0.4482516348361969
loss_pred:0.08556777983903885, decouple_loss:0.11833177506923676
loss_pred:0.08588729053735733, decouple_loss:0.1178610771894455
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471258223056793, gen p mean: -0.026694560423493385, mean p set: 0.4476061165332794
The modified gen p mean: 0.4481903612613678, gen p mean: -0.026567624881863594, mean p set: 0.4486706554889679loss_pred:0.08758046478033066, decouple_loss:0.10859116911888123
The modified gen p mean: 0.44806525111198425, gen p mean: -0.02685222588479519, mean p set: 0.44854554533958435
loss_pred:0.08822992444038391, decouple_loss:0.11083206534385681
loss_pred:0.08340020477771759, decouple_loss:0.1102861762046814
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868525862693787, gen p mean: -0.028632862493395805, mean p set: 0.4491655230522156
The modified gen p mean: 0.4481160640716553, gen p mean: -0.028264092281460762, mean p set: 0.44859638810157776
loss_pred:0.08313598483800888, decouple_loss:0.10401350259780884
loss_pred:0.08475884795188904, decouple_loss:0.104873888194561
The modified gen p mean: 0.44799932837486267, gen p mean: -0.02827903814613819, mean p set: 0.44847962260246277
loss_pred:0.08536529541015625, decouple_loss:0.10440972447395325
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762691855430603, gen p mean: -0.031126003712415695, mean p set: 0.44810721278190613
The modified gen p mean: 0.44841691851615906, gen p mean: -0.031528402119874954, mean p set: 0.44889721274375916
loss_pred:0.08554595708847046, decouple_loss:0.09656257182359695
loss_pred:0.08033137023448944, decouple_loss:0.09876438975334167
The modified gen p mean: 0.4478616714477539, gen p mean: -0.030961748212575912, mean p set: 0.448341965675354
loss_pred:0.08481711894273758, decouple_loss:0.09677084535360336
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487624764442444, gen p mean: -0.03238379955291748, mean p set: 0.4492427408695221
loss_pred:0.08034555613994598, decouple_loss:0.09446562081575394
The modified gen p mean: 0.44790560007095337, gen p mean: -0.031880561262369156, mean p set: 0.44838589429855347The modified gen p mean: 0.44811344146728516, gen p mean: -0.03223207965493202, mean p set: 0.44859370589256287
loss_pred:0.07878970354795456, decouple_loss:0.09478834271430969
loss_pred:0.08041522651910782, decouple_loss:0.0953577533364296
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780224561691284, gen p mean: -0.03305967524647713, mean p set: 0.44828253984451294
The modified gen p mean: 0.44787734746932983, gen p mean: -0.033397287130355835, mean p set: 0.4483576714992523
loss_pred:0.08060470223426819, decouple_loss:0.0889105498790741
The modified gen p mean: 0.4478335976600647, gen p mean: -0.033119648694992065, mean p set: 0.4483139216899872
loss_pred:0.07917986810207367, decouple_loss:0.08940411359071732
loss_pred:0.0807448998093605, decouple_loss:0.08980969339609146
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484484791755676, gen p mean: -0.0344102717936039, mean p set: 0.44892874360084534
The modified gen p mean: 0.4480687975883484, gen p mean: -0.03411001339554787, mean p set: 0.4485490918159485
The modified gen p mean: 0.44773542881011963, gen p mean: -0.03469672426581383, mean p set: 0.4482157230377197
loss_pred:0.07985525578260422, decouple_loss:0.08625731617212296
loss_pred:0.08149154484272003, decouple_loss:0.08508540689945221
loss_pred:0.07848754525184631, decouple_loss:0.08486787229776382
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744613766670227, gen p mean: -0.03788990154862404, mean p set: 0.44792643189430237
The modified gen p mean: 0.4483286142349243, gen p mean: -0.037921540439128876, mean p set: 0.4488089084625244
The modified gen p mean: 0.44741690158843994, gen p mean: -0.037744201719760895, mean p set: 0.44789719581604004
loss_pred:0.0799073725938797, decouple_loss:0.08390707522630692
loss_pred:0.07784972339868546, decouple_loss:0.08279810845851898
loss_pred:0.07953739166259766, decouple_loss:0.08306221663951874
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728925824165344, gen p mean: -0.038414813578128815, mean p set: 0.44776955246925354
The modified gen p mean: 0.44794991612434387, gen p mean: -0.03844188153743744, mean p set: 0.44843021035194397
loss_pred:0.07959232479333878, decouple_loss:0.0796264111995697
loss_pred:0.07536424696445465, decouple_loss:0.08162615448236465
The modified gen p mean: 0.44751855731010437, gen p mean: -0.03845508024096489, mean p set: 0.44799885153770447
loss_pred:0.07772196829319, decouple_loss:0.07966206222772598
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795525074005127, gen p mean: -0.040593188256025314, mean p set: 0.44843557476997375
The modified gen p mean: 0.44798144698143005, gen p mean: -0.04066948592662811, mean p set: 0.44846177101135254
loss_pred:0.07821562141180038, decouple_loss:0.07755465805530548
loss_pred:0.07660549134016037, decouple_loss:0.0774061530828476
The modified gen p mean: 0.4477216303348541, gen p mean: -0.04041760414838791, mean p set: 0.448201984167099
loss_pred:0.07732681930065155, decouple_loss:0.07926280051469803
2023-05-01 15:39:46 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.043645747005939484, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04395386949181557, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.043286748230457306, mean p set: 0.4500633478164673
loss_pred:0.07720602303743362, decouple_loss:0.07631687819957733
loss_pred:0.07745339721441269, decouple_loss:0.0755753368139267
loss_pred:0.07789992541074753, decouple_loss:0.07657808065414429
WV_0_PC_1_EH_0_PS_40_5, loss: 0.08132762461900711, avg_mse: 0.07701092958450317
current test mse: 0.077011
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812050461769104, gen p mean: -0.04306564852595329, mean p set: 0.44860079884529114
loss_pred:0.07793862372636795, decouple_loss:0.08097821474075317
The modified gen p mean: 0.44849732518196106, gen p mean: -0.04390913248062134, mean p set: 0.44897761940956116The modified gen p mean: 0.4468739926815033, gen p mean: -0.043228667229413986, mean p set: 0.4473542869091034
loss_pred:0.07918429374694824, decouple_loss:0.07770322263240814
loss_pred:0.0778420940041542, decouple_loss:0.07512754946947098
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803979992866516, gen p mean: -0.04341411963105202, mean p set: 0.44852009415626526
The modified gen p mean: 0.4472026228904724, gen p mean: -0.04412136971950531, mean p set: 0.4476828873157501
The modified gen p mean: 0.4477033019065857, gen p mean: -0.04404522851109505, mean p set: 0.4481835961341858
loss_pred:0.07866176217794418, decouple_loss:0.0802132785320282
loss_pred:0.07555898278951645, decouple_loss:0.0758448988199234loss_pred:0.07784426957368851, decouple_loss:0.0783524215221405
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889020919799805, gen p mean: -0.04602693393826485, mean p set: 0.44937047362327576
The modified gen p mean: 0.44752028584480286, gen p mean: -0.045692332088947296, mean p set: 0.44800058007240295
loss_pred:0.07767857611179352, decouple_loss:0.08193747699260712
loss_pred:0.07483454048633575, decouple_loss:0.0765061005949974
The modified gen p mean: 0.44790807366371155, gen p mean: -0.0456673838198185, mean p set: 0.44838836789131165
loss_pred:0.07294067740440369, decouple_loss:0.07811877131462097
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472866356372833, gen p mean: -0.05049153417348862, mean p set: 0.4477669298648834
The modified gen p mean: 0.44864141941070557, gen p mean: -0.04928583279252052, mean p set: 0.4491216838359833
loss_pred:0.07736963778734207, decouple_loss:0.07221781462430954
loss_pred:0.07581610232591629, decouple_loss:0.0737442597746849
The modified gen p mean: 0.4477849304676056, gen p mean: -0.04880949482321739, mean p set: 0.4482652246952057
loss_pred:0.07644800841808319, decouple_loss:0.07327819615602493
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481739103794098, gen p mean: -0.05102923512458801, mean p set: 0.4486541748046875
The modified gen p mean: 0.4470200538635254, gen p mean: -0.052004456520080566, mean p set: 0.4475003480911255loss_pred:0.07612770795822144, decouple_loss:0.07201939076185226
The modified gen p mean: 0.4469078779220581, gen p mean: -0.05228668078780174, mean p set: 0.4473881721496582
loss_pred:0.07742588222026825, decouple_loss:0.07046530395746231
loss_pred:0.07923933863639832, decouple_loss:0.07143289595842361
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478982090950012, gen p mean: -0.052933644503355026, mean p set: 0.44837847352027893
loss_pred:0.07283425331115723, decouple_loss:0.0683407410979271
The modified gen p mean: 0.44597822427749634, gen p mean: -0.05284804478287697, mean p set: 0.44645851850509644
The modified gen p mean: 0.44647809863090515, gen p mean: -0.052801962941884995, mean p set: 0.44695839285850525
loss_pred:0.07524643838405609, decouple_loss:0.0706627294421196
loss_pred:0.07549948990345001, decouple_loss:0.06896369904279709
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476260542869568, gen p mean: -0.05390766263008118, mean p set: 0.4481063485145569
The modified gen p mean: 0.4476092755794525, gen p mean: -0.054714497178792953, mean p set: 0.4480895698070526
loss_pred:0.07735148072242737, decouple_loss:0.06909958273172379
loss_pred:0.07507030665874481, decouple_loss:0.06584911048412323
The modified gen p mean: 0.44769424200057983, gen p mean: -0.05532703921198845, mean p set: 0.44817450642585754
loss_pred:0.07776021212339401, decouple_loss:0.06741739064455032
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685396552085876, gen p mean: -0.06021711602807045, mean p set: 0.4473342299461365
The modified gen p mean: 0.4478985369205475, gen p mean: -0.05971740558743477, mean p set: 0.4483788311481476
loss_pred:0.07400534301996231, decouple_loss:0.0638490542769432
loss_pred:0.07416211813688278, decouple_loss:0.0657481849193573
The modified gen p mean: 0.4474744498729706, gen p mean: -0.05918840318918228, mean p set: 0.4479547441005707
loss_pred:0.07425670325756073, decouple_loss:0.06414715945720673
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487679600715637, gen p mean: -0.062400538474321365, mean p set: 0.44924822449684143
The modified gen p mean: 0.4474409818649292, gen p mean: -0.06342282891273499, mean p set: 0.4479212760925293
loss_pred:0.0748075470328331, decouple_loss:0.06622550636529922
loss_pred:0.0716184675693512, decouple_loss:0.06543219089508057
The modified gen p mean: 0.44865262508392334, gen p mean: -0.062095776200294495, mean p set: 0.44913291931152344
loss_pred:0.07483694702386856, decouple_loss:0.06494611501693726
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474908113479614, gen p mean: -0.0654074102640152, mean p set: 0.4479711353778839
The modified gen p mean: 0.44730570912361145, gen p mean: -0.06567107886075974, mean p set: 0.44778600335121155
The modified gen p mean: 0.4480159282684326, gen p mean: -0.0635281652212143, mean p set: 0.4484962224960327
loss_pred:0.07288452237844467, decouple_loss:0.06199852004647255
loss_pred:0.07364469766616821, decouple_loss:0.06206075847148895
loss_pred:0.07782861590385437, decouple_loss:0.061643168330192566
2023-05-01 15:42:32 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06812214851379395, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.06884050369262695, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.06775108724832535, mean p set: 0.4500633478164673
loss_pred:0.07301446050405502, decouple_loss:0.06076996028423309
loss_pred:0.07284088432788849, decouple_loss:0.06059829890727997
loss_pred:0.07350236177444458, decouple_loss:0.06002741679549217
WV_0_PC_1_EH_0_PS_40_5, loss: 0.07614248991012573, avg_mse: 0.07276269793510437
current test mse: 0.072763
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765469431877136, gen p mean: -0.06872060894966125, mean p set: 0.44813501834869385
The modified gen p mean: 0.4469403624534607, gen p mean: -0.06899350881576538, mean p set: 0.4474206268787384
loss_pred:0.07324129343032837, decouple_loss:0.05982465296983719
The modified gen p mean: 0.44679224491119385, gen p mean: -0.0675053596496582, mean p set: 0.44727250933647156
loss_pred:0.07658637315034866, decouple_loss:0.0610782653093338
loss_pred:0.07483135908842087, decouple_loss:0.059444647282361984
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467793107032776, gen p mean: -0.06939981877803802, mean p set: 0.4472596049308777
loss_pred:0.07452446967363358, decouple_loss:0.05878550559282303
The modified gen p mean: 0.448669970035553, gen p mean: -0.0698385238647461, mean p set: 0.4491502642631531The modified gen p mean: 0.44723421335220337, gen p mean: -0.07087969779968262, mean p set: 0.4477144777774811
loss_pred:0.07382478564977646, decouple_loss:0.061133094131946564
loss_pred:0.07223852723836899, decouple_loss:0.05877787619829178
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456293284893036, gen p mean: -0.0723663717508316, mean p set: 0.4461096227169037
loss_pred:0.07324989885091782, decouple_loss:0.05812538042664528
The modified gen p mean: 0.4471847116947174, gen p mean: -0.07426980137825012, mean p set: 0.4476650059223175The modified gen p mean: 0.4484599530696869, gen p mean: -0.07225645333528519, mean p set: 0.448940247297287
loss_pred:0.07561805099248886, decouple_loss:0.05797092244029045
loss_pred:0.07368450611829758, decouple_loss:0.05998096987605095
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814231991767883, gen p mean: -0.07637400925159454, mean p set: 0.44862261414527893
The modified gen p mean: 0.4477330446243286, gen p mean: -0.0765700489282608, mean p set: 0.4482133686542511
loss_pred:0.07071028649806976, decouple_loss:0.05668782815337181
loss_pred:0.07039991766214371, decouple_loss:0.057972170412540436
The modified gen p mean: 0.4469599425792694, gen p mean: -0.07692386209964752, mean p set: 0.4474402070045471
loss_pred:0.07218918949365616, decouple_loss:0.05624951422214508
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478236734867096, gen p mean: -0.07774879038333893, mean p set: 0.4483039677143097
loss_pred:0.0705033615231514, decouple_loss:0.05566130951046944
The modified gen p mean: 0.4474269449710846, gen p mean: -0.076041579246521, mean p set: 0.4479072690010071The modified gen p mean: 0.447037011384964, gen p mean: -0.077300064265728, mean p set: 0.4475173056125641
loss_pred:0.07294073700904846, decouple_loss:0.05806607007980347
loss_pred:0.0748467892408371, decouple_loss:0.05572986602783203
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869041442871094, gen p mean: -0.07860478013753891, mean p set: 0.44917070865631104
The modified gen p mean: 0.4475523829460144, gen p mean: -0.07874264568090439, mean p set: 0.4480327069759369
loss_pred:0.07317429780960083, decouple_loss:0.05682970955967903
loss_pred:0.07133866846561432, decouple_loss:0.054047275334596634
The modified gen p mean: 0.4472869336605072, gen p mean: -0.0803387463092804, mean p set: 0.4477671980857849
loss_pred:0.07389838993549347, decouple_loss:0.05322219058871269
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838908314704895, gen p mean: -0.08160389959812164, mean p set: 0.44886934757232666
loss_pred:0.07386022061109543, decouple_loss:0.05415613204240799
The modified gen p mean: 0.446382999420166, gen p mean: -0.08322551846504211, mean p set: 0.4468632936477661The modified gen p mean: 0.4477022588253021, gen p mean: -0.08165791630744934, mean p set: 0.4481825828552246
loss_pred:0.0706622451543808, decouple_loss:0.05266103148460388
loss_pred:0.07143668085336685, decouple_loss:0.0517176054418087
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773608446121216, gen p mean: -0.08550974726676941, mean p set: 0.44821637868881226
loss_pred:0.07090548425912857, decouple_loss:0.052315592765808105
The modified gen p mean: 0.44628408551216125, gen p mean: -0.08514916151762009, mean p set: 0.44676437973976135The modified gen p mean: 0.44812092185020447, gen p mean: -0.08614996075630188, mean p set: 0.44860121607780457
loss_pred:0.07274641841650009, decouple_loss:0.053440336138010025
loss_pred:0.0692857950925827, decouple_loss:0.05120748281478882
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478202760219574, gen p mean: -0.08693990111351013, mean p set: 0.4483005702495575
loss_pred:0.0718735009431839, decouple_loss:0.051812201738357544
The modified gen p mean: 0.44741907715797424, gen p mean: -0.08676455914974213, mean p set: 0.44789940118789673The modified gen p mean: 0.4465479552745819, gen p mean: -0.08737222105264664, mean p set: 0.4470282196998596
loss_pred:0.07325491309165955, decouple_loss:0.05229206755757332
loss_pred:0.0700887069106102, decouple_loss:0.04997585341334343
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732311367988586, gen p mean: -0.09112858027219772, mean p set: 0.44780340790748596
The modified gen p mean: 0.4477179944515228, gen p mean: -0.08898016810417175, mean p set: 0.4481982886791229loss_pred:0.07336626201868057, decouple_loss:0.051362164318561554
The modified gen p mean: 0.44743573665618896, gen p mean: -0.08877144008874893, mean p set: 0.44791606068611145
loss_pred:0.06909406185150146, decouple_loss:0.050469327718019485
loss_pred:0.07183266431093216, decouple_loss:0.05021766200661659
2023-05-01 15:44:41 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.09074042737483978, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.09247086942195892, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.09074310213327408, mean p set: 0.4500633478164673
loss_pred:0.07087395340204239, decouple_loss:0.051600344479084015
loss_pred:0.07028727233409882, decouple_loss:0.050554562360048294
loss_pred:0.07116387039422989, decouple_loss:0.05044955387711525
WV_0_PC_1_EH_0_PS_40_5, loss: 0.07331843674182892, avg_mse: 0.07049480080604553
current test mse: 0.070495
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540480673313141, gen p mean: -0.08862993121147156, mean p set: 0.4545283913612366
loss_pred:0.07074696570634842, decouple_loss:0.06366019695997238
The modified gen p mean: 0.45300745964050293, gen p mean: -0.09152207523584366, mean p set: 0.453487753868103The modified gen p mean: 0.45349952578544617, gen p mean: -0.08959450572729111, mean p set: 0.45397984981536865
loss_pred:0.07040081918239594, decouple_loss:0.06134219840168953
loss_pred:0.07103628665208817, decouple_loss:0.06336703896522522
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525775909423828, gen p mean: -0.10278023034334183, mean p set: 0.4530578553676605
The modified gen p mean: 0.45239850878715515, gen p mean: -0.10191003978252411, mean p set: 0.45287883281707764
loss_pred:0.07140061259269714, decouple_loss:0.05959855020046234
loss_pred:0.06982031464576721, decouple_loss:0.059031322598457336
The modified gen p mean: 0.45042166113853455, gen p mean: -0.09955564141273499, mean p set: 0.45090195536613464
loss_pred:0.07144461572170258, decouple_loss:0.05859261751174927
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519538879394531, gen p mean: -0.10401662439107895, mean p set: 0.4524341821670532
The modified gen p mean: 0.45190176367759705, gen p mean: -0.10436852276325226, mean p set: 0.45238202810287476
loss_pred:0.07223169505596161, decouple_loss:0.05762362480163574
loss_pred:0.06882113218307495, decouple_loss:0.058740921318531036
The modified gen p mean: 0.4496065676212311, gen p mean: -0.1057085171341896, mean p set: 0.4500868618488312
loss_pred:0.0694056898355484, decouple_loss:0.05862467736005783
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454966276884079, gen p mean: -0.10386321693658829, mean p set: 0.45544660091400146
The modified gen p mean: 0.45307889580726624, gen p mean: -0.09986238926649094, mean p set: 0.45355919003486633
The modified gen p mean: 0.4534457325935364, gen p mean: -0.10112642496824265, mean p set: 0.4539260268211365loss_pred:0.07104869931936264, decouple_loss:0.05959586426615715
loss_pred:0.0698976218700409, decouple_loss:0.059673700481653214
loss_pred:0.07182373851537704, decouple_loss:0.05943145602941513
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502507448196411, gen p mean: -0.10703307390213013, mean p set: 0.4507310390472412The modified gen p mean: 0.4541676640510559, gen p mean: -0.10985755920410156, mean p set: 0.454647958278656
The modified gen p mean: 0.4508812725543976, gen p mean: -0.1065944954752922, mean p set: 0.45136159658432007
loss_pred:0.07144705951213837, decouple_loss:0.059800680726766586loss_pred:0.07038057595491409, decouple_loss:0.05784346163272858
loss_pred:0.0697639212012291, decouple_loss:0.06196611002087593
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537576138973236, gen p mean: -0.11572536826133728, mean p set: 0.4542378783226013
The modified gen p mean: 0.45211803913116455, gen p mean: -0.1118723452091217, mean p set: 0.45259830355644226
The modified gen p mean: 0.4514559805393219, gen p mean: -0.112419493496418, mean p set: 0.451936274766922
loss_pred:0.06997042149305344, decouple_loss:0.055926769971847534
loss_pred:0.06969995051622391, decouple_loss:0.05978751555085182loss_pred:0.07195447385311127, decouple_loss:0.05876488983631134
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519626498222351, gen p mean: -0.11322131007909775, mean p set: 0.4524429440498352
The modified gen p mean: 0.4514514207839966, gen p mean: -0.11140907555818558, mean p set: 0.4519317150115967
loss_pred:0.06932003796100616, decouple_loss:0.055292483419179916
loss_pred:0.07032417505979538, decouple_loss:0.05764086917042732
The modified gen p mean: 0.4518965482711792, gen p mean: -0.11468632519245148, mean p set: 0.4523768723011017
loss_pred:0.06847196072340012, decouple_loss:0.057001981884241104
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515368342399597, gen p mean: -0.11219552159309387, mean p set: 0.4520170986652374
The modified gen p mean: 0.4548651874065399, gen p mean: -0.11552679538726807, mean p set: 0.45534548163414
loss_pred:0.06929828971624374, decouple_loss:0.05651938542723656
loss_pred:0.06906386464834213, decouple_loss:0.05685153603553772
The modified gen p mean: 0.45127904415130615, gen p mean: -0.11497481912374496, mean p set: 0.45175933837890625
loss_pred:0.0679120123386383, decouple_loss:0.05381522327661514
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450214147567749, gen p mean: -0.11742093414068222, mean p set: 0.4506944417953491The modified gen p mean: 0.4504041075706482, gen p mean: -0.1189015731215477, mean p set: 0.4508844316005707
loss_pred:0.07030904293060303, decouple_loss:0.05341268330812454
loss_pred:0.06724558770656586, decouple_loss:0.05163091793656349
The modified gen p mean: 0.4521728754043579, gen p mean: -0.1171613335609436, mean p set: 0.452653169631958
loss_pred:0.06998623162508011, decouple_loss:0.05458782985806465
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45308905839920044, gen p mean: -0.12072715908288956, mean p set: 0.4535693824291229
The modified gen p mean: 0.45315924286842346, gen p mean: -0.12260373681783676, mean p set: 0.45363950729370117
loss_pred:0.06961453706026077, decouple_loss:0.05358966067433357
loss_pred:0.06868690252304077, decouple_loss:0.055976107716560364
The modified gen p mean: 0.452873170375824, gen p mean: -0.12115681916475296, mean p set: 0.4533534646034241
loss_pred:0.07075561583042145, decouple_loss:0.05350832641124725
2023-05-01 15:47:26 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.11769630014896393, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.11869114637374878, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.11713868379592896, mean p set: 0.4500633478164673
loss_pred:0.07115408033132553, decouple_loss:0.05750768259167671
loss_pred:0.0695602148771286, decouple_loss:0.05758829042315483
loss_pred:0.07085966318845749, decouple_loss:0.056962478905916214
WV_0_PC_1_EH_0_PS_40_5, loss: 0.07339229434728622, avg_mse: 0.07051745802164078
current test mse: 0.070517
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498823881149292, gen p mean: -0.12087443470954895, mean p set: 0.4503626525402069
The modified gen p mean: 0.4521256983280182, gen p mean: -0.12019101530313492, mean p set: 0.4526059925556183
loss_pred:0.07072965800762177, decouple_loss:0.0523407869040966
The modified gen p mean: 0.4507195055484772, gen p mean: -0.12084735184907913, mean p set: 0.4511997699737549
loss_pred:0.06958025693893433, decouple_loss:0.05325000733137131
loss_pred:0.06970969587564468, decouple_loss:0.052944548428058624
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501402974128723, gen p mean: -0.12135317921638489, mean p set: 0.4506206214427948
The modified gen p mean: 0.45206934213638306, gen p mean: -0.1187838688492775, mean p set: 0.45254963636398315
loss_pred:0.06694803386926651, decouple_loss:0.05058099329471588
loss_pred:0.0684484913945198, decouple_loss:0.05372511222958565The modified gen p mean: 0.4533480405807495, gen p mean: -0.11755627393722534, mean p set: 0.4538283348083496
loss_pred:0.06744290888309479, decouple_loss:0.052422892302274704
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495961666107178, gen p mean: -0.1222979724407196, mean p set: 0.4500764310359955
The modified gen p mean: 0.4527311623096466, gen p mean: -0.11984366178512573, mean p set: 0.4532114863395691
loss_pred:0.07025835663080215, decouple_loss:0.05170857533812523
The modified gen p mean: 0.45060786604881287, gen p mean: -0.12159395962953568, mean p set: 0.4510881304740906loss_pred:0.06804873049259186, decouple_loss:0.05238700285553932
loss_pred:0.07007574290037155, decouple_loss:0.05198841914534569
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45329105854034424, gen p mean: -0.12729740142822266, mean p set: 0.4537713825702667
The modified gen p mean: 0.4537471532821655, gen p mean: -0.12700271606445312, mean p set: 0.45422741770744324
loss_pred:0.06797885149717331, decouple_loss:0.051903728395700455
loss_pred:0.06946861743927002, decouple_loss:0.05052873119711876
The modified gen p mean: 0.45238861441612244, gen p mean: -0.1210714802145958, mean p set: 0.45286890864372253
loss_pred:0.06899941712617874, decouple_loss:0.052637770771980286
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499392807483673, gen p mean: -0.1267218440771103, mean p set: 0.4504196047782898
The modified gen p mean: 0.45320290327072144, gen p mean: -0.12055565416812897, mean p set: 0.4536832273006439
loss_pred:0.06545363366603851, decouple_loss:0.04846879467368126
loss_pred:0.0683366060256958, decouple_loss:0.05362299084663391
The modified gen p mean: 0.4529379904270172, gen p mean: -0.12006813287734985, mean p set: 0.4534182846546173
loss_pred:0.06805237382650375, decouple_loss:0.05233624950051308
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529207944869995, gen p mean: -0.12464560568332672, mean p set: 0.4534010887145996
The modified gen p mean: 0.4533970057964325, gen p mean: -0.12681525945663452, mean p set: 0.4538773000240326
loss_pred:0.06733717024326324, decouple_loss:0.050467170774936676
loss_pred:0.06698273867368698, decouple_loss:0.05046358332037926The modified gen p mean: 0.45099908113479614, gen p mean: -0.12656858563423157, mean p set: 0.45147937536239624
loss_pred:0.0701461136341095, decouple_loss:0.04756341874599457
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530723989009857, gen p mean: -0.13273480534553528, mean p set: 0.4535527229309082
The modified gen p mean: 0.451791375875473, gen p mean: -0.13019606471061707, mean p set: 0.45227164030075073
loss_pred:0.06766405701637268, decouple_loss:0.04936761036515236
loss_pred:0.0671389028429985, decouple_loss:0.048419803380966187
The modified gen p mean: 0.4531858265399933, gen p mean: -0.13099825382232666, mean p set: 0.45366615056991577
loss_pred:0.06687017530202866, decouple_loss:0.05148645117878914
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518018662929535, gen p mean: -0.1285712569952011, mean p set: 0.452282190322876
The modified gen p mean: 0.4504154622554779, gen p mean: -0.13132385909557343, mean p set: 0.4508957266807556
loss_pred:0.06721092015504837, decouple_loss:0.04895044490695
loss_pred:0.06756392121315002, decouple_loss:0.04917791113257408
The modified gen p mean: 0.4508505165576935, gen p mean: -0.13000336289405823, mean p set: 0.4513308107852936
loss_pred:0.06770000606775284, decouple_loss:0.04948366805911064
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113590359687805, gen p mean: -0.13047339022159576, mean p set: 0.45161619782447815
The modified gen p mean: 0.45120471715927124, gen p mean: -0.12991100549697876, mean p set: 0.45168498158454895
loss_pred:0.06686589866876602, decouple_loss:0.04714784026145935
loss_pred:0.06553030014038086, decouple_loss:0.047094739973545074
The modified gen p mean: 0.44963768124580383, gen p mean: -0.1342991590499878, mean p set: 0.45011797547340393
loss_pred:0.06569438427686691, decouple_loss:0.04725579544901848
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481566250324249, gen p mean: -0.13249137997627258, mean p set: 0.44863688945770264
loss_pred:0.07018726319074631, decouple_loss:0.05258336663246155
The modified gen p mean: 0.4478701651096344, gen p mean: -0.13322830200195312, mean p set: 0.4483504593372345The modified gen p mean: 0.44824087619781494, gen p mean: -0.1325966864824295, mean p set: 0.44872117042541504
loss_pred:0.07048666477203369, decouple_loss:0.053306639194488525
loss_pred:0.06991420686244965, decouple_loss:0.05095165595412254
2023-05-01 15:50:12 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.13091258704662323, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.13198541104793549, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.1314375400543213, mean p set: 0.4500633478164673
loss_pred:0.06908082216978073, decouple_loss:0.051018644124269485
loss_pred:0.06758301705121994, decouple_loss:0.05217323452234268
loss_pred:0.06873098760843277, decouple_loss:0.05089031904935837
WV_0_PC_1_EH_0_PS_40_5, loss: 0.07103298604488373, avg_mse: 0.06849094480276108
current test mse: 0.068491
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844579696655273, gen p mean: -0.12890972197055817, mean p set: 0.44892609119415283
The modified gen p mean: 0.44916537404060364, gen p mean: -0.12515152990818024, mean p set: 0.4496456980705261
loss_pred:0.07015024125576019, decouple_loss:0.05108457803726196
The modified gen p mean: 0.4480254054069519, gen p mean: -0.13246716558933258, mean p set: 0.448505699634552
loss_pred:0.06924266368150711, decouple_loss:0.05146088823676109
loss_pred:0.06790540367364883, decouple_loss:0.051680248230695724
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872400164604187, gen p mean: -0.12999223172664642, mean p set: 0.4492042660713196
loss_pred:0.06655290722846985, decouple_loss:0.049432966858148575
The modified gen p mean: 0.4474274516105652, gen p mean: -0.12184606492519379, mean p set: 0.4479077458381653
The modified gen p mean: 0.44853872060775757, gen p mean: -0.12213556468486786, mean p set: 0.44901901483535767
loss_pred:0.06842806935310364, decouple_loss:0.05142434313893318
loss_pred:0.06704478710889816, decouple_loss:0.05602644756436348
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505738615989685, gen p mean: -0.12055408954620361, mean p set: 0.4510541558265686
loss_pred:0.0677768886089325, decouple_loss:0.053284477442502975
The modified gen p mean: 0.4484531581401825, gen p mean: -0.12656070291996002, mean p set: 0.4489334523677826The modified gen p mean: 0.4482167959213257, gen p mean: -0.12548626959323883, mean p set: 0.4486970603466034
loss_pred:0.06803181767463684, decouple_loss:0.04988095909357071
loss_pred:0.06757515668869019, decouple_loss:0.05532662943005562
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893309473991394, gen p mean: -0.13346050679683685, mean p set: 0.4494134187698364
The modified gen p mean: 0.44884786009788513, gen p mean: -0.13107585906982422, mean p set: 0.44932815432548523
The modified gen p mean: 0.44702979922294617, gen p mean: -0.13229325413703918, mean p set: 0.4475100636482239
loss_pred:0.06566409021615982, decouple_loss:0.048944998532533646
loss_pred:0.06973059475421906, decouple_loss:0.05088053643703461loss_pred:0.06851018220186234, decouple_loss:0.050338566303253174
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936537742614746, gen p mean: -0.12351353466510773, mean p set: 0.44984567165374756
The modified gen p mean: 0.44846779108047485, gen p mean: -0.11789718270301819, mean p set: 0.44894805550575256
The modified gen p mean: 0.44795912504196167, gen p mean: -0.12509898841381073, mean p set: 0.44843941926956177
loss_pred:0.06845773756504059, decouple_loss:0.04799932613968849
loss_pred:0.06501621752977371, decouple_loss:0.05366392806172371
loss_pred:0.06750587373971939, decouple_loss:0.04703686758875847
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841331243515015, gen p mean: -0.12026370316743851, mean p set: 0.44889357686042786
The modified gen p mean: 0.4481697976589203, gen p mean: -0.11491784453392029, mean p set: 0.448650062084198
The modified gen p mean: 0.4472508132457733, gen p mean: -0.11822517216205597, mean p set: 0.4477311074733734
loss_pred:0.06758685410022736, decouple_loss:0.04940885677933693
loss_pred:0.06650858372449875, decouple_loss:0.050475213676691055loss_pred:0.06821375340223312, decouple_loss:0.052024684846401215
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889312982559204, gen p mean: -0.12666405737400055, mean p set: 0.44937342405319214
The modified gen p mean: 0.44854146242141724, gen p mean: -0.12239989638328552, mean p set: 0.44902175664901733
The modified gen p mean: 0.44815993309020996, gen p mean: -0.12367857992649078, mean p set: 0.44864022731781006
loss_pred:0.06899690628051758, decouple_loss:0.04682230204343796
loss_pred:0.0666690319776535, decouple_loss:0.04932082071900368loss_pred:0.06680535525083542, decouple_loss:0.04870712384581566
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480617344379425, gen p mean: -0.13172702491283417, mean p set: 0.4485420286655426
The modified gen p mean: 0.44682058691978455, gen p mean: -0.13576313853263855, mean p set: 0.44730088114738464
loss_pred:0.06532522290945053, decouple_loss:0.048565324395895004
loss_pred:0.06577961891889572, decouple_loss:0.04795326665043831
The modified gen p mean: 0.44832903146743774, gen p mean: -0.13365121185779572, mean p set: 0.44880932569503784
loss_pred:0.06719974428415298, decouple_loss:0.0480252280831337
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477507770061493, gen p mean: -0.12167780846357346, mean p set: 0.448231041431427
The modified gen p mean: 0.44833943247795105, gen p mean: -0.12185849249362946, mean p set: 0.44881969690322876
The modified gen p mean: 0.4493597745895386, gen p mean: -0.12293691188097, mean p set: 0.44984006881713867loss_pred:0.06779422610998154, decouple_loss:0.047352854162454605
loss_pred:0.06681001931428909, decouple_loss:0.04605357348918915
loss_pred:0.06699308753013611, decouple_loss:0.046110063791275024
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490513503551483, gen p mean: -0.11771655082702637, mean p set: 0.449531614780426
The modified gen p mean: 0.4489864110946655, gen p mean: -0.11489449441432953, mean p set: 0.4494667053222656
The modified gen p mean: 0.44843608140945435, gen p mean: -0.1217680349946022, mean p set: 0.44891637563705444
loss_pred:0.06633909791707993, decouple_loss:0.046689361333847046
loss_pred:0.06885459274053574, decouple_loss:0.049641579389572144loss_pred:0.06622618436813354, decouple_loss:0.0454285554587841
2023-05-01 15:52:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.12528890371322632, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.12688271701335907, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.12542758882045746, mean p set: 0.4500633478164673
loss_pred:0.06712961196899414, decouple_loss:0.046846117824316025
loss_pred:0.06524886935949326, decouple_loss:0.046138714998960495
loss_pred:0.0666239932179451, decouple_loss:0.04486890882253647
WV_0_PC_1_EH_0_PS_40_5, loss: 0.06863172352313995, avg_mse: 0.06643316149711609
current test mse: 0.066433
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488731920719147, gen p mean: -0.12285231798887253, mean p set: 0.44935348629951477
The modified gen p mean: 0.4472561478614807, gen p mean: -0.12539897859096527, mean p set: 0.4477364122867584
loss_pred:0.06662487238645554, decouple_loss:0.0490313321352005
The modified gen p mean: 0.4493885636329651, gen p mean: -0.12849406898021698, mean p set: 0.4498688280582428
loss_pred:0.06679557263851166, decouple_loss:0.04492097720503807
loss_pred:0.06752576678991318, decouple_loss:0.046430084854364395
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497413635253906, gen p mean: -0.1295163333415985, mean p set: 0.4502216577529907
The modified gen p mean: 0.448375940322876, gen p mean: -0.13284514844417572, mean p set: 0.4488562345504761
loss_pred:0.06571053713560104, decouple_loss:0.04620400816202164
loss_pred:0.06410940736532211, decouple_loss:0.04689619690179825
The modified gen p mean: 0.4481634199619293, gen p mean: -0.13453218340873718, mean p set: 0.4486437141895294
loss_pred:0.06590738892555237, decouple_loss:0.04679461568593979
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477349817752838, gen p mean: -0.13464249670505524, mean p set: 0.4482152760028839
The modified gen p mean: 0.4489436149597168, gen p mean: -0.13537681102752686, mean p set: 0.4494239091873169
loss_pred:0.06689025461673737, decouple_loss:0.047792285680770874
loss_pred:0.06689707189798355, decouple_loss:0.04746202379465103
The modified gen p mean: 0.447750449180603, gen p mean: -0.13608244061470032, mean p set: 0.44823071360588074
loss_pred:0.06720633059740067, decouple_loss:0.04747115075588226
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476427733898163, gen p mean: -0.12281713634729385, mean p set: 0.4481230676174164
The modified gen p mean: 0.44745129346847534, gen p mean: -0.1257772445678711, mean p set: 0.4479316174983978
loss_pred:0.06628625839948654, decouple_loss:0.04467107355594635
loss_pred:0.06537049263715744, decouple_loss:0.04492299258708954
The modified gen p mean: 0.4486350119113922, gen p mean: -0.12268985062837601, mean p set: 0.4491152763366699
loss_pred:0.0642726793885231, decouple_loss:0.048100847750902176
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679591059684753, gen p mean: -0.11957822740077972, mean p set: 0.44727620482444763
The modified gen p mean: 0.4484662413597107, gen p mean: -0.11591710895299911, mean p set: 0.4489465653896332
loss_pred:0.06352157145738602, decouple_loss:0.04573483765125275
loss_pred:0.06456631422042847, decouple_loss:0.04758591577410698
The modified gen p mean: 0.4481416344642639, gen p mean: -0.11407297104597092, mean p set: 0.448621928691864
loss_pred:0.06586334109306335, decouple_loss:0.04707223176956177
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476643204689026, gen p mean: -0.12406327575445175, mean p set: 0.4481446146965027
The modified gen p mean: 0.44823938608169556, gen p mean: -0.1250845044851303, mean p set: 0.44871968030929565loss_pred:0.06599602103233337, decouple_loss:0.04603123292326927
The modified gen p mean: 0.4476039409637451, gen p mean: -0.12031469494104385, mean p set: 0.4480842351913452
loss_pred:0.06426101177930832, decouple_loss:0.045876018702983856
loss_pred:0.06563787907361984, decouple_loss:0.04873024672269821
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474150538444519, gen p mean: -0.12858521938323975, mean p set: 0.4478953182697296
loss_pred:0.06463059037923813, decouple_loss:0.04395095631480217
The modified gen p mean: 0.44861480593681335, gen p mean: -0.12778794765472412, mean p set: 0.44909510016441345The modified gen p mean: 0.4490232765674591, gen p mean: -0.12483608722686768, mean p set: 0.4495035707950592
loss_pred:0.06769924610853195, decouple_loss:0.044350411742925644
loss_pred:0.06508304178714752, decouple_loss:0.0440017469227314
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821345806121826, gen p mean: -0.1275530904531479, mean p set: 0.44869375228881836
The modified gen p mean: 0.44690385460853577, gen p mean: -0.1319413185119629, mean p set: 0.44738414883613586
loss_pred:0.06348536908626556, decouple_loss:0.04390355572104454
loss_pred:0.06418061256408691, decouple_loss:0.04441433399915695
The modified gen p mean: 0.4488052427768707, gen p mean: -0.13341806828975677, mean p set: 0.4492855668067932
loss_pred:0.06270003318786621, decouple_loss:0.04498275741934776
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761529564857483, gen p mean: -0.1245824471116066, mean p set: 0.4480955898761749
The modified gen p mean: 0.4480161666870117, gen p mean: -0.12685316801071167, mean p set: 0.4484964609146118
loss_pred:0.06555822491645813, decouple_loss:0.045815713703632355
loss_pred:0.06535002589225769, decouple_loss:0.044063203036785126
The modified gen p mean: 0.45050033926963806, gen p mean: -0.12626874446868896, mean p set: 0.45098060369491577
loss_pred:0.06513220071792603, decouple_loss:0.0447377935051918
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486353397369385, gen p mean: -0.1257142722606659, mean p set: 0.4491156041622162
loss_pred:0.0653979554772377, decouple_loss:0.04673141613602638
The modified gen p mean: 0.4481388330459595, gen p mean: -0.1272006630897522, mean p set: 0.44861912727355957The modified gen p mean: 0.4475848078727722, gen p mean: -0.1252690553665161, mean p set: 0.4480650722980499
loss_pred:0.06374882906675339, decouple_loss:0.04642438516020775
loss_pred:0.0646587684750557, decouple_loss:0.04506721720099449
2023-05-01 15:55:08 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.12397938221693039, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.1269122213125229, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.1252802312374115, mean p set: 0.4500633478164673
loss_pred:0.06465567648410797, decouple_loss:0.04209502041339874
loss_pred:0.06280133873224258, decouple_loss:0.04233541712164879
loss_pred:0.06435709446668625, decouple_loss:0.041580140590667725
WV_0_PC_1_EH_0_PS_40_5, loss: 0.06603821367025375, avg_mse: 0.0640600323677063
current test mse: 0.06406
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823095202445984, gen p mean: -0.118655264377594, mean p set: 0.44871124625205994
The modified gen p mean: 0.44877079129219055, gen p mean: -0.11891243606805801, mean p set: 0.44925105571746826
loss_pred:0.06359859555959702, decouple_loss:0.04732707142829895
The modified gen p mean: 0.448012113571167, gen p mean: -0.12430662661790848, mean p set: 0.4484924077987671
loss_pred:0.06354383379220963, decouple_loss:0.044916655868291855
loss_pred:0.06411880999803543, decouple_loss:0.04396771267056465
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666150212287903, gen p mean: -0.11814013868570328, mean p set: 0.44714176654815674
The modified gen p mean: 0.4482963979244232, gen p mean: -0.12033037841320038, mean p set: 0.4487766921520233
loss_pred:0.06338611990213394, decouple_loss:0.04477108269929886
loss_pred:0.06382543593645096, decouple_loss:0.04423961788415909The modified gen p mean: 0.4478801488876343, gen p mean: -0.1176004409790039, mean p set: 0.4483604431152344
loss_pred:0.06059880182147026, decouple_loss:0.041976094245910645
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756248593330383, gen p mean: -0.1188417449593544, mean p set: 0.44804278016090393
The modified gen p mean: 0.4485744833946228, gen p mean: -0.119420625269413, mean p set: 0.4490547776222229
loss_pred:0.061388153582811356, decouple_loss:0.045408982783555984
loss_pred:0.061514630913734436, decouple_loss:0.044664736837148666
The modified gen p mean: 0.44847413897514343, gen p mean: -0.11965940147638321, mean p set: 0.44895440340042114
loss_pred:0.06357691437005997, decouple_loss:0.045207321643829346
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449032187461853, gen p mean: -0.11395253241062164, mean p set: 0.44951245188713074
The modified gen p mean: 0.4482080340385437, gen p mean: -0.11854665726423264, mean p set: 0.4486883282661438
loss_pred:0.05913233011960983, decouple_loss:0.04497165232896805
loss_pred:0.06254983693361282, decouple_loss:0.04272589832544327
The modified gen p mean: 0.4487197995185852, gen p mean: -0.11833775788545609, mean p set: 0.4492001235485077
loss_pred:0.06193222850561142, decouple_loss:0.043114446103572845
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487855136394501, gen p mean: -0.11892383545637131, mean p set: 0.44926580786705017
The modified gen p mean: 0.44863730669021606, gen p mean: -0.11345567554235458, mean p set: 0.44911760091781616loss_pred:0.061759889125823975, decouple_loss:0.04116539657115936
The modified gen p mean: 0.4473727345466614, gen p mean: -0.12008942663669586, mean p set: 0.44785305857658386
loss_pred:0.06235792487859726, decouple_loss:0.04292568564414978
loss_pred:0.06178632378578186, decouple_loss:0.040481261909008026
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955793023109436, gen p mean: -0.11957358568906784, mean p set: 0.45003825426101685
The modified gen p mean: 0.44855940341949463, gen p mean: -0.11557154357433319, mean p set: 0.4490397274494171
The modified gen p mean: 0.4475170075893402, gen p mean: -0.10992634296417236, mean p set: 0.4479973018169403
loss_pred:0.060569703578948975, decouple_loss:0.04096445068717003
loss_pred:0.06141533702611923, decouple_loss:0.041713159531354904
loss_pred:0.06398133188486099, decouple_loss:0.04329802840948105
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484032988548279, gen p mean: -0.11030185967683792, mean p set: 0.4488835632801056
The modified gen p mean: 0.4487271010875702, gen p mean: -0.10863495618104935, mean p set: 0.4492073655128479
The modified gen p mean: 0.44869399070739746, gen p mean: -0.11117267608642578, mean p set: 0.44917428493499756
loss_pred:0.0620034784078598, decouple_loss:0.04096643999218941
loss_pred:0.058062534779310226, decouple_loss:0.0430913046002388loss_pred:0.06261014193296432, decouple_loss:0.0403764508664608
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489459991455078, gen p mean: -0.10621808469295502, mean p set: 0.4494262933731079
The modified gen p mean: 0.44805780053138733, gen p mean: -0.1156361848115921, mean p set: 0.44853806495666504
loss_pred:0.058889806270599365, decouple_loss:0.042762547731399536
loss_pred:0.0606604628264904, decouple_loss:0.04184846580028534
The modified gen p mean: 0.4487054944038391, gen p mean: -0.11217692494392395, mean p set: 0.4491857588291168
loss_pred:0.06302149593830109, decouple_loss:0.041672468185424805
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839170575141907, gen p mean: -0.11972001194953918, mean p set: 0.44887199997901917
The modified gen p mean: 0.4479963183403015, gen p mean: -0.11640013754367828, mean p set: 0.4484765827655792
loss_pred:0.05963541194796562, decouple_loss:0.0395335853099823
loss_pred:0.06147157773375511, decouple_loss:0.04053260758519173
The modified gen p mean: 0.44862884283065796, gen p mean: -0.1173158660531044, mean p set: 0.44910916686058044
loss_pred:0.06084432825446129, decouple_loss:0.0404394194483757
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858911633491516, gen p mean: -0.12309164553880692, mean p set: 0.44906941056251526
The modified gen p mean: 0.4478552043437958, gen p mean: -0.11937616020441055, mean p set: 0.4483354985713959
The modified gen p mean: 0.4487673342227936, gen p mean: -0.1212996318936348, mean p set: 0.44924765825271606
loss_pred:0.06094982847571373, decouple_loss:0.04144258424639702
loss_pred:0.062051307410001755, decouple_loss:0.041043102741241455loss_pred:0.05857980251312256, decouple_loss:0.039754096418619156
2023-05-01 15:57:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.12182191014289856, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.12554100155830383, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.1226593628525734, mean p set: 0.4500633478164673
loss_pred:0.06208761781454086, decouple_loss:0.040022820234298706
loss_pred:0.06019206345081329, decouple_loss:0.04044225811958313
loss_pred:0.06172281503677368, decouple_loss:0.03947564586997032
WV_0_PC_1_EH_0_PS_40_5, loss: 0.0633331835269928, avg_mse: 0.06149035319685936
current test mse: 0.06149
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472561478614807, gen p mean: -0.12241410464048386, mean p set: 0.4477364122867584
The modified gen p mean: 0.44807833433151245, gen p mean: -0.12059807032346725, mean p set: 0.44855865836143494
loss_pred:0.06224730238318443, decouple_loss:0.0406121090054512
The modified gen p mean: 0.4481961727142334, gen p mean: -0.1220967248082161, mean p set: 0.4486764669418335
loss_pred:0.060598473995923996, decouple_loss:0.03992418944835663
loss_pred:0.060780562460422516, decouple_loss:0.039120230823755264
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482119381427765, gen p mean: -0.12046955525875092, mean p set: 0.4486922323703766
The modified gen p mean: 0.4477488100528717, gen p mean: -0.11594700068235397, mean p set: 0.4482291042804718
loss_pred:0.058487094938755035, decouple_loss:0.039945088326931
loss_pred:0.06311751157045364, decouple_loss:0.04142966493964195
The modified gen p mean: 0.4487454891204834, gen p mean: -0.1212390884757042, mean p set: 0.4492258131504059
loss_pred:0.0594678558409214, decouple_loss:0.04068285599350929
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477640688419342, gen p mean: -0.11273970454931259, mean p set: 0.4482443630695343
The modified gen p mean: 0.449470192193985, gen p mean: -0.11034935712814331, mean p set: 0.44995051622390747
loss_pred:0.06041823327541351, decouple_loss:0.03904948756098747
loss_pred:0.057330917567014694, decouple_loss:0.04186876118183136The modified gen p mean: 0.4474312961101532, gen p mean: -0.12226428836584091, mean p set: 0.4479115903377533
loss_pred:0.05885549634695053, decouple_loss:0.03898768499493599
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480448067188263, gen p mean: -0.1133694276213646, mean p set: 0.4485251009464264
The modified gen p mean: 0.44882646203041077, gen p mean: -0.11356526613235474, mean p set: 0.44930675625801086
loss_pred:0.05969654396176338, decouple_loss:0.03957558050751686
loss_pred:0.06019904464483261, decouple_loss:0.040691670030355453
The modified gen p mean: 0.44889020919799805, gen p mean: -0.11058244854211807, mean p set: 0.44937053322792053
loss_pred:0.06157112121582031, decouple_loss:0.03883587196469307
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862377643585205, gen p mean: -0.11181166768074036, mean p set: 0.44910410046577454
loss_pred:0.059917327016592026, decouple_loss:0.03884361311793327
The modified gen p mean: 0.447951078414917, gen p mean: -0.11538500338792801, mean p set: 0.4484313726425171The modified gen p mean: 0.4485089182853699, gen p mean: -0.11774491518735886, mean p set: 0.44898921251296997
loss_pred:0.057316429913043976, decouple_loss:0.038808926939964294
loss_pred:0.05806206911802292, decouple_loss:0.038977138698101044
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448775053024292, gen p mean: -0.11826825141906738, mean p set: 0.4492553174495697
The modified gen p mean: 0.4486894905567169, gen p mean: -0.11022193729877472, mean p set: 0.44916975498199463
loss_pred:0.05768483132123947, decouple_loss:0.03774363175034523
loss_pred:0.060321614146232605, decouple_loss:0.03784075006842613
The modified gen p mean: 0.448984295129776, gen p mean: -0.10797159373760223, mean p set: 0.4494645595550537
loss_pred:0.06083778291940689, decouple_loss:0.03936834633350372
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492049813270569, gen p mean: -0.10819365829229355, mean p set: 0.449685275554657
The modified gen p mean: 0.4483334422111511, gen p mean: -0.10750369727611542, mean p set: 0.4488137364387512
loss_pred:0.05724049359560013, decouple_loss:0.0377853699028492
loss_pred:0.0558992475271225, decouple_loss:0.038941070437431335
The modified gen p mean: 0.4471951127052307, gen p mean: -0.11008720844984055, mean p set: 0.4476754069328308
loss_pred:0.05713316425681114, decouple_loss:0.03652648255228996
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449144572019577, gen p mean: -0.11367923021316528, mean p set: 0.4496248662471771
The modified gen p mean: 0.44772353768348694, gen p mean: -0.10419011116027832, mean p set: 0.4482038617134094
loss_pred:0.058558784425258636, decouple_loss:0.036780886352062225
loss_pred:0.05891377478837967, decouple_loss:0.03933459892868996
The modified gen p mean: 0.4473927617073059, gen p mean: -0.10183931887149811, mean p set: 0.447873055934906
loss_pred:0.05928298458456993, decouple_loss:0.04130885377526283
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808676838874817, gen p mean: -0.11129721999168396, mean p set: 0.44856706261634827
The modified gen p mean: 0.44933339953422546, gen p mean: -0.10955306887626648, mean p set: 0.44981372356414795
loss_pred:0.05908582732081413, decouple_loss:0.038458529859781265
loss_pred:0.05900851637125015, decouple_loss:0.03812563046813011
The modified gen p mean: 0.4495489001274109, gen p mean: -0.11061275750398636, mean p set: 0.450029194355011
loss_pred:0.056680623441934586, decouple_loss:0.03638577461242676
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
NaN value num: 0
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490898847579956, gen p mean: -0.10764392465353012, mean p set: 0.4495701789855957
loss_pred:0.06322254985570908, decouple_loss:0.042567502707242966
The modified gen p mean: 0.44974350929260254, gen p mean: -0.110271155834198, mean p set: 0.45022377371788025The modified gen p mean: 0.4511817693710327, gen p mean: -0.11210914701223373, mean p set: 0.4516620337963104
loss_pred:0.0634191706776619, decouple_loss:0.04175640270113945
loss_pred:0.06361448019742966, decouple_loss:0.0469401590526104
2023-05-01 16:00:01 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.1156667098402977, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.11928674578666687, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.11666017770767212, mean p set: 0.4500633478164673
loss_pred:0.06139717996120453, decouple_loss:0.04219359531998634
loss_pred:0.0591026246547699, decouple_loss:0.04118794575333595
loss_pred:0.060840386897325516, decouple_loss:0.041492290794849396
WV_0_PC_1_EH_0_PS_40_5, loss: 0.06252796947956085, avg_mse: 0.06110291928052902
current test mse: 0.061103
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145177841186523, gen p mean: -0.11154402047395706, mean p set: 0.4519321024417877
The modified gen p mean: 0.4493885636329651, gen p mean: -0.11244432628154755, mean p set: 0.4498688280582428
loss_pred:0.06050878390669823, decouple_loss:0.047805752605199814
The modified gen p mean: 0.4511222839355469, gen p mean: -0.11733204871416092, mean p set: 0.4516025483608246
loss_pred:0.06369389593601227, decouple_loss:0.04899905249476433
loss_pred:0.0606793574988842, decouple_loss:0.047962188720703125
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512248635292053, gen p mean: -0.12284712493419647, mean p set: 0.4517051577568054The modified gen p mean: 0.44950807094573975, gen p mean: -0.11843553930521011, mean p set: 0.44998836517333984
loss_pred:0.06026950106024742, decouple_loss:0.05186471343040466loss_pred:0.060350000858306885, decouple_loss:0.04771808534860611
The modified gen p mean: 0.4512796401977539, gen p mean: -0.11563005298376083, mean p set: 0.4517599642276764
loss_pred:0.05960116162896156, decouple_loss:0.047581806778907776
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493926763534546, gen p mean: -0.1159277930855751, mean p set: 0.4498729407787323
The modified gen p mean: 0.4516649544239044, gen p mean: -0.11903326958417892, mean p set: 0.4521452486515045
The modified gen p mean: 0.4476621448993683, gen p mean: -0.1221596896648407, mean p set: 0.448142409324646
loss_pred:0.060724887996912, decouple_loss:0.045650456100702286
loss_pred:0.058494932949543, decouple_loss:0.045334361493587494loss_pred:0.05945543199777603, decouple_loss:0.0482063926756382
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498673677444458, gen p mean: -0.11873602867126465, mean p set: 0.4503476321697235
The modified gen p mean: 0.4512780010700226, gen p mean: -0.11730001866817474, mean p set: 0.45175832509994507
loss_pred:0.059974391013383865, decouple_loss:0.04398472607135773
loss_pred:0.059087298810482025, decouple_loss:0.04435260221362114
The modified gen p mean: 0.44969499111175537, gen p mean: -0.1187271699309349, mean p set: 0.4501752555370331
loss_pred:0.060223035514354706, decouple_loss:0.045073166489601135
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45277976989746094, gen p mean: -0.11275562644004822, mean p set: 0.45326003432273865
The modified gen p mean: 0.45082300901412964, gen p mean: -0.10776876658201218, mean p set: 0.45130327343940735
loss_pred:0.05924028530716896, decouple_loss:0.04453759640455246
loss_pred:0.06167873367667198, decouple_loss:0.04717164486646652
The modified gen p mean: 0.45214930176734924, gen p mean: -0.11123093962669373, mean p set: 0.45262959599494934
loss_pred:0.058607857674360275, decouple_loss:0.04512076452374458
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981178641319275, gen p mean: -0.11353558301925659, mean p set: 0.45029211044311523
The modified gen p mean: 0.4494360387325287, gen p mean: -0.11154670268297195, mean p set: 0.4499163329601288
loss_pred:0.06028638407588005, decouple_loss:0.045162614434957504
loss_pred:0.06091269850730896, decouple_loss:0.04376135393977165
The modified gen p mean: 0.44974252581596375, gen p mean: -0.11011753231287003, mean p set: 0.45022279024124146
loss_pred:0.057774029672145844, decouple_loss:0.044048141688108444
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509528577327728, gen p mean: -0.12278924882411957, mean p set: 0.4514331519603729
The modified gen p mean: 0.448850154876709, gen p mean: -0.12065327912569046, mean p set: 0.4493304491043091
loss_pred:0.057752400636672974, decouple_loss:0.04362571984529495
loss_pred:0.05903109908103943, decouple_loss:0.04471658915281296
The modified gen p mean: 0.44903847575187683, gen p mean: -0.12044904381036758, mean p set: 0.44951876997947693
loss_pred:0.05691373720765114, decouple_loss:0.04489865526556969
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504871964454651, gen p mean: -0.12031946331262589, mean p set: 0.4509674608707428
The modified gen p mean: 0.4515511989593506, gen p mean: -0.12278607487678528, mean p set: 0.4520314931869507
loss_pred:0.058858729898929596, decouple_loss:0.04397670179605484
loss_pred:0.05874067172408104, decouple_loss:0.04544706642627716
The modified gen p mean: 0.4499928653240204, gen p mean: -0.11945082247257233, mean p set: 0.4504731595516205
loss_pred:0.05640073120594025, decouple_loss:0.045464541763067245
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147401094436646, gen p mean: -0.11106988042593002, mean p set: 0.45195427536964417
The modified gen p mean: 0.45160701870918274, gen p mean: -0.1105358824133873, mean p set: 0.45208731293678284
loss_pred:0.05797124281525612, decouple_loss:0.04420698434114456
loss_pred:0.05927121266722679, decouple_loss:0.045304860919713974
The modified gen p mean: 0.44905152916908264, gen p mean: -0.10865246504545212, mean p set: 0.44953182339668274
loss_pred:0.05717569962143898, decouple_loss:0.04382843151688576
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44980132579803467, gen p mean: -0.11089245229959488, mean p set: 0.45028162002563477
The modified gen p mean: 0.45149606466293335, gen p mean: -0.1119309663772583, mean p set: 0.45197638869285583
The modified gen p mean: 0.44892239570617676, gen p mean: -0.11110500991344452, mean p set: 0.44940266013145447
loss_pred:0.05726606398820877, decouple_loss:0.044458143413066864
loss_pred:0.057792868465185165, decouple_loss:0.042694807052612305loss_pred:0.056532349437475204, decouple_loss:0.04401988163590431
2023-05-01 16:02:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.11872915178537369, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.12217503041028976, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.1197594627737999, mean p set: 0.4500633478164673
loss_pred:0.062038298696279526, decouple_loss:0.045961279422044754
loss_pred:0.059241876006126404, decouple_loss:0.04669598117470741
loss_pred:0.060910969972610474, decouple_loss:0.045193109661340714
WV_0_PC_1_EH_0_PS_40_5, loss: 0.06302788853645325, avg_mse: 0.06168651208281517
current test mse: 0.061687
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039647817611694, gen p mean: -0.11837036907672882, mean p set: 0.45087674260139465
The modified gen p mean: 0.45058420300483704, gen p mean: -0.12125948071479797, mean p set: 0.4510645270347595
loss_pred:0.056567832827568054, decouple_loss:0.04406999796628952
The modified gen p mean: 0.4513486921787262, gen p mean: -0.12059129029512405, mean p set: 0.4518289566040039
loss_pred:0.057822085916996, decouple_loss:0.04529692977666855
loss_pred:0.056101974099874496, decouple_loss:0.04216555878520012
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518389105796814, gen p mean: -0.12444161623716354, mean p set: 0.4523191750049591
The modified gen p mean: 0.44978782534599304, gen p mean: -0.12487861514091492, mean p set: 0.45026808977127075
loss_pred:0.05950555205345154, decouple_loss:0.04283628985285759
loss_pred:0.05471666902303696, decouple_loss:0.0423913449048996
The modified gen p mean: 0.4507521092891693, gen p mean: -0.1327434778213501, mean p set: 0.4512324035167694
loss_pred:0.05737652629613876, decouple_loss:0.042833708226680756
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496873617172241, gen p mean: -0.1167609915137291, mean p set: 0.4501676559448242
The modified gen p mean: 0.45285388827323914, gen p mean: -0.12834088504314423, mean p set: 0.45333418250083923
loss_pred:0.05851873382925987, decouple_loss:0.04291446506977081
loss_pred:0.058150552213191986, decouple_loss:0.04284752160310745
The modified gen p mean: 0.451978862285614, gen p mean: -0.12669889628887177, mean p set: 0.4524591267108917
loss_pred:0.056254372000694275, decouple_loss:0.04090472683310509
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996708631515503, gen p mean: -0.1200505718588829, mean p set: 0.4504474103450775
The modified gen p mean: 0.451507031917572, gen p mean: -0.1139223724603653, mean p set: 0.4519873261451721
loss_pred:0.058954861015081406, decouple_loss:0.04137440025806427
loss_pred:0.0570559985935688, decouple_loss:0.04262598976492882
The modified gen p mean: 0.4512357711791992, gen p mean: -0.11915415525436401, mean p set: 0.4517160654067993
loss_pred:0.056757815182209015, decouple_loss:0.04229295626282692
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448747456073761, gen p mean: -0.11804436892271042, mean p set: 0.44922778010368347
The modified gen p mean: 0.4501604437828064, gen p mean: -0.11586955934762955, mean p set: 0.4506407380104065
loss_pred:0.05851944908499718, decouple_loss:0.04003600776195526
loss_pred:0.05558265745639801, decouple_loss:0.04100663959980011
The modified gen p mean: 0.4513408839702606, gen p mean: -0.11657258123159409, mean p set: 0.4518211781978607
loss_pred:0.06014849618077278, decouple_loss:0.041013531386852264
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493529200553894, gen p mean: -0.12255918979644775, mean p set: 0.4498332440853119
The modified gen p mean: 0.4494718313217163, gen p mean: -0.12576760351657867, mean p set: 0.449952095746994
loss_pred:0.055679239332675934, decouple_loss:0.04347038269042969
loss_pred:0.05781897157430649, decouple_loss:0.04220288619399071
The modified gen p mean: 0.44991931319236755, gen p mean: -0.11901503801345825, mean p set: 0.45039960741996765
loss_pred:0.057099778205156326, decouple_loss:0.039582252502441406
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514136016368866, gen p mean: -0.12277797609567642, mean p set: 0.4518939256668091
The modified gen p mean: 0.4511454105377197, gen p mean: -0.12342177331447601, mean p set: 0.45162567496299744
loss_pred:0.058587074279785156, decouple_loss:0.0405811183154583
loss_pred:0.0566173754632473, decouple_loss:0.04141419753432274
The modified gen p mean: 0.4492553472518921, gen p mean: -0.1228695884346962, mean p set: 0.4497356712818146
loss_pred:0.05509396269917488, decouple_loss:0.04200218990445137
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511565864086151, gen p mean: -0.1198837161064148, mean p set: 0.4516368806362152
The modified gen p mean: 0.45150044560432434, gen p mean: -0.12075863778591156, mean p set: 0.45198073983192444
loss_pred:0.056314125657081604, decouple_loss:0.04249996319413185
loss_pred:0.059579167515039444, decouple_loss:0.041181232780218124
The modified gen p mean: 0.4528367221355438, gen p mean: -0.12552791833877563, mean p set: 0.4533170461654663
loss_pred:0.05605466663837433, decouple_loss:0.041335903108119965
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528837502002716, gen p mean: -0.12491251528263092, mean p set: 0.4533640444278717
The modified gen p mean: 0.45027345418930054, gen p mean: -0.11534882336854935, mean p set: 0.45075374841690063loss_pred:0.055690255016088486, decouple_loss:0.039252880960702896
The modified gen p mean: 0.44813981652259827, gen p mean: -0.11897488683462143, mean p set: 0.44862014055252075
loss_pred:0.054640404880046844, decouple_loss:0.03971388563513756
loss_pred:0.055752944201231, decouple_loss:0.0406162329018116
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
NaN value num: 0
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478349983692169, gen p mean: -0.1229529157280922, mean p set: 0.4483153223991394
loss_pred:0.05948304012417793, decouple_loss:0.039858054369688034
The modified gen p mean: 0.4485129415988922, gen p mean: -0.12360160797834396, mean p set: 0.4489932656288147The modified gen p mean: 0.44732797145843506, gen p mean: -0.12673336267471313, mean p set: 0.4478082060813904
loss_pred:0.05899405479431152, decouple_loss:0.04069432243704796
loss_pred:0.0588219091296196, decouple_loss:0.04143084958195686
2023-05-01 16:04:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.12709543108940125, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.12706102430820465, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.12967731058597565, mean p set: 0.45035696029663086
loss_pred:0.05913713201880455, decouple_loss:0.04175908863544464
loss_pred:0.05862540379166603, decouple_loss:0.04124398157000542
loss_pred:0.05692591145634651, decouple_loss:0.04198337346315384
WV_0_PC_1_EH_0_PS_40_5, loss: 0.06031259149312973, avg_mse: 0.059003982692956924
current test mse: 0.059004
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846928119659424, gen p mean: -0.1290760636329651, mean p set: 0.44894954562187195
The modified gen p mean: 0.4477674961090088, gen p mean: -0.11934221535921097, mean p set: 0.4482477605342865
loss_pred:0.059532251209020615, decouple_loss:0.03983188420534134
The modified gen p mean: 0.44807130098342896, gen p mean: -0.12913846969604492, mean p set: 0.44855156540870667
loss_pred:0.05957367643713951, decouple_loss:0.04326384887099266
loss_pred:0.058340612798929214, decouple_loss:0.04092124477028847
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472518265247345, gen p mean: -0.12318265438079834, mean p set: 0.4477321207523346
The modified gen p mean: 0.44795748591423035, gen p mean: -0.12095794826745987, mean p set: 0.44843775033950806
loss_pred:0.05868605896830559, decouple_loss:0.039642445743083954
loss_pred:0.05810737982392311, decouple_loss:0.0433679036796093
The modified gen p mean: 0.44891196489334106, gen p mean: -0.12698769569396973, mean p set: 0.4493922293186188
loss_pred:0.05857424810528755, decouple_loss:0.04200227931141853
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447937935590744, gen p mean: -0.1241246834397316, mean p set: 0.44841820001602173
The modified gen p mean: 0.4488667845726013, gen p mean: -0.12037864327430725, mean p set: 0.4493470788002014
The modified gen p mean: 0.44774752855300903, gen p mean: -0.11991041898727417, mean p set: 0.4482278525829315
loss_pred:0.05563266575336456, decouple_loss:0.04127659648656845
loss_pred:0.05850761756300926, decouple_loss:0.04138994961977005
loss_pred:0.05789072811603546, decouple_loss:0.03999459743499756
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850581884384155, gen p mean: -0.116773821413517, mean p set: 0.44898611307144165
The modified gen p mean: 0.44846969842910767, gen p mean: -0.11617771536111832, mean p set: 0.44895002245903015loss_pred:0.05844671651721001, decouple_loss:0.0420440249145031
The modified gen p mean: 0.4476569592952728, gen p mean: -0.11478285491466522, mean p set: 0.4481372833251953
loss_pred:0.05888264626264572, decouple_loss:0.04048299416899681
loss_pred:0.05927989259362221, decouple_loss:0.043431270867586136
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476771950721741, gen p mean: -0.11802170425653458, mean p set: 0.44815748929977417
The modified gen p mean: 0.4486573338508606, gen p mean: -0.11536532640457153, mean p set: 0.4491376578807831The modified gen p mean: 0.44793984293937683, gen p mean: -0.11902996152639389, mean p set: 0.44842007756233215
loss_pred:0.05764760449528694, decouple_loss:0.041930876672267914
loss_pred:0.056852489709854126, decouple_loss:0.03950263187289238loss_pred:0.057639218866825104, decouple_loss:0.04231572523713112
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846218824386597, gen p mean: -0.11817125976085663, mean p set: 0.44894248247146606
The modified gen p mean: 0.44726303219795227, gen p mean: -0.11065621674060822, mean p set: 0.44774329662323
The modified gen p mean: 0.44797033071517944, gen p mean: -0.11619554460048676, mean p set: 0.44845062494277954
loss_pred:0.05676744505763054, decouple_loss:0.041749656200408936loss_pred:0.057288266718387604, decouple_loss:0.041321102529764175
loss_pred:0.05679501220583916, decouple_loss:0.0410616509616375
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901150465011597, gen p mean: -0.1275206208229065, mean p set: 0.44949179887771606
The modified gen p mean: 0.44819241762161255, gen p mean: -0.1199335902929306, mean p set: 0.44867268204689026
The modified gen p mean: 0.44765704870224, gen p mean: -0.12880459427833557, mean p set: 0.4481373429298401
loss_pred:0.05695521831512451, decouple_loss:0.04178472235798836
loss_pred:0.055859506130218506, decouple_loss:0.04115944728255272
loss_pred:0.05615710839629173, decouple_loss:0.04153953120112419
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760873913764954, gen p mean: -0.12474431842565536, mean p set: 0.44808903336524963
The modified gen p mean: 0.4470137655735016, gen p mean: -0.11556118726730347, mean p set: 0.4474940896034241
The modified gen p mean: 0.44836103916168213, gen p mean: -0.11758188903331757, mean p set: 0.4488413631916046
loss_pred:0.05709320679306984, decouple_loss:0.04087117314338684
loss_pred:0.05575134605169296, decouple_loss:0.03889763727784157loss_pred:0.05635226145386696, decouple_loss:0.04062119126319885
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482339322566986, gen p mean: -0.1174880862236023, mean p set: 0.4487142562866211
The modified gen p mean: 0.4476783871650696, gen p mean: -0.12182427197694778, mean p set: 0.44815871119499207
The modified gen p mean: 0.4474272131919861, gen p mean: -0.11693613976240158, mean p set: 0.4479075074195862loss_pred:0.05853351578116417, decouple_loss:0.04235504940152168
loss_pred:0.05665294826030731, decouple_loss:0.0399373322725296
loss_pred:0.056926704943180084, decouple_loss:0.040596313774585724
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489613473415375, gen p mean: -0.12601226568222046, mean p set: 0.4494416415691376
The modified gen p mean: 0.4477936625480652, gen p mean: -0.11919786036014557, mean p set: 0.4482739567756653
loss_pred:0.058243315666913986, decouple_loss:0.04134628549218178
loss_pred:0.056671321392059326, decouple_loss:0.039094988256692886
The modified gen p mean: 0.44839394092559814, gen p mean: -0.12641453742980957, mean p set: 0.44887417554855347
loss_pred:0.05628809332847595, decouple_loss:0.042470622807741165
2023-05-01 16:07:03 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.1308836042881012, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.13499853014945984, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.1317431777715683, mean p set: 0.4500633478164673
loss_pred:0.057537905871868134, decouple_loss:0.04068772867321968
loss_pred:0.0553659126162529, decouple_loss:0.04128619655966759
loss_pred:0.056670043617486954, decouple_loss:0.040445342659950256
WV_0_PC_1_EH_0_PS_40_5, loss: 0.058564942330121994, avg_mse: 0.05750805139541626
current test mse: 0.057508
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849756360054016, gen p mean: -0.12756244838237762, mean p set: 0.44897785782814026
The modified gen p mean: 0.44755542278289795, gen p mean: -0.13542750477790833, mean p set: 0.44803571701049805
loss_pred:0.054112937301397324, decouple_loss:0.03931989520788193
The modified gen p mean: 0.4484626352787018, gen p mean: -0.12767334282398224, mean p set: 0.44894295930862427
loss_pred:0.05680191516876221, decouple_loss:0.03996141999959946
loss_pred:0.054938752204179764, decouple_loss:0.04067361354827881
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836854934692383, gen p mean: -0.142174631357193, mean p set: 0.4488488733768463
The modified gen p mean: 0.447672039270401, gen p mean: -0.13691961765289307, mean p set: 0.4481523036956787
loss_pred:0.05834362283349037, decouple_loss:0.0406813807785511
The modified gen p mean: 0.44835129380226135, gen p mean: -0.13819831609725952, mean p set: 0.44883155822753906
loss_pred:0.0564361996948719, decouple_loss:0.03903650864958763
loss_pred:0.05821401625871658, decouple_loss:0.04058009013533592
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475019872188568, gen p mean: -0.13516521453857422, mean p set: 0.4479822516441345
The modified gen p mean: 0.4478950798511505, gen p mean: -0.1422104388475418, mean p set: 0.4483753740787506
loss_pred:0.05624581500887871, decouple_loss:0.038646019995212555
loss_pred:0.053332146257162094, decouple_loss:0.04034295305609703
The modified gen p mean: 0.4475162625312805, gen p mean: -0.13885672390460968, mean p set: 0.447996586561203
loss_pred:0.0552988275885582, decouple_loss:0.03863873332738876
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474294185638428, gen p mean: -0.12754559516906738, mean p set: 0.4479096829891205
loss_pred:0.055962566286325455, decouple_loss:0.039693500846624374
The modified gen p mean: 0.44756460189819336, gen p mean: -0.12442418932914734, mean p set: 0.44804492592811584The modified gen p mean: 0.44744303822517395, gen p mean: -0.12387493252754211, mean p set: 0.44792336225509644
loss_pred:0.05593855679035187, decouple_loss:0.0414704829454422
loss_pred:0.055314335972070694, decouple_loss:0.040598101913928986
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800907373428345, gen p mean: -0.12518362700939178, mean p set: 0.44848933815956116
The modified gen p mean: 0.4488697052001953, gen p mean: -0.12952153384685516, mean p set: 0.449349969625473
loss_pred:0.05631082504987717, decouple_loss:0.04133297875523567
loss_pred:0.054010093212127686, decouple_loss:0.039409369230270386
The modified gen p mean: 0.4475323259830475, gen p mean: -0.12082415819168091, mean p set: 0.4480125904083252
loss_pred:0.05492454767227173, decouple_loss:0.03968178480863571
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838833808898926, gen p mean: -0.12290333211421967, mean p set: 0.44886863231658936
loss_pred:0.0540168359875679, decouple_loss:0.039911091327667236
The modified gen p mean: 0.4482515752315521, gen p mean: -0.12359236180782318, mean p set: 0.4487318992614746The modified gen p mean: 0.4473387598991394, gen p mean: -0.12128756195306778, mean p set: 0.4478190541267395
loss_pred:0.05522965267300606, decouple_loss:0.039069559425115585
loss_pred:0.054284028708934784, decouple_loss:0.03865325450897217
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469981789588928, gen p mean: -0.13543763756752014, mean p set: 0.4474784731864929
The modified gen p mean: 0.44823214411735535, gen p mean: -0.13549070060253143, mean p set: 0.44871240854263306
loss_pred:0.055440597236156464, decouple_loss:0.0374532975256443
loss_pred:0.05634080246090889, decouple_loss:0.038185108453035355
The modified gen p mean: 0.4479680359363556, gen p mean: -0.13586130738258362, mean p set: 0.4484483003616333
loss_pred:0.05640691518783569, decouple_loss:0.038152847439050674
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737720489501953, gen p mean: -0.14024512469768524, mean p set: 0.44785749912261963
The modified gen p mean: 0.4480227828025818, gen p mean: -0.12947022914886475, mean p set: 0.4485030770301819
loss_pred:0.055398374795913696, decouple_loss:0.038197506219148636
loss_pred:0.054782986640930176, decouple_loss:0.038136184215545654
The modified gen p mean: 0.44805869460105896, gen p mean: -0.13987986743450165, mean p set: 0.44853898882865906
loss_pred:0.0560491643846035, decouple_loss:0.03828698396682739
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729772210121155, gen p mean: -0.1368476301431656, mean p set: 0.44777801632881165
loss_pred:0.05370121821761131, decouple_loss:0.036520738154649734
The modified gen p mean: 0.447792649269104, gen p mean: -0.1306094229221344, mean p set: 0.4482729434967041The modified gen p mean: 0.44815874099731445, gen p mean: -0.1340632289648056, mean p set: 0.44863903522491455
loss_pred:0.05529648810625076, decouple_loss:0.03852016106247902
loss_pred:0.05521648749709129, decouple_loss:0.03902347758412361
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753527641296387, gen p mean: -0.13299235701560974, mean p set: 0.4480155408382416
loss_pred:0.05567658320069313, decouple_loss:0.040712323039770126
The modified gen p mean: 0.4475768804550171, gen p mean: -0.13481605052947998, mean p set: 0.4480571746826172The modified gen p mean: 0.4461434781551361, gen p mean: -0.1335112303495407, mean p set: 0.4466237425804138
loss_pred:0.05689862743020058, decouple_loss:0.03878842666745186
loss_pred:0.05378272011876106, decouple_loss:0.03886028379201889
2023-05-01 16:09:49 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.1330965906381607, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.13249875605106354, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.13061252236366272, mean p set: 0.4500633478164673
loss_pred:0.05647800490260124, decouple_loss:0.03927138075232506
loss_pred:0.05436297506093979, decouple_loss:0.03965085372328758
loss_pred:0.05546579137444496, decouple_loss:0.03944344073534012
WV_0_PC_1_EH_0_PS_40_5, loss: 0.05740835517644882, avg_mse: 0.05661460757255554
current test mse: 0.056615
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447005033493042, gen p mean: -0.12997719645500183, mean p set: 0.4474853575229645
The modified gen p mean: 0.44588345289230347, gen p mean: -0.1304621696472168, mean p set: 0.44636374711990356
loss_pred:0.054768964648246765, decouple_loss:0.03933340311050415
The modified gen p mean: 0.4494439363479614, gen p mean: -0.13022275269031525, mean p set: 0.4499242305755615
loss_pred:0.05279233679175377, decouple_loss:0.03909905254840851
loss_pred:0.053772129118442535, decouple_loss:0.04269861802458763
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970178604125977, gen p mean: -0.13846063613891602, mean p set: 0.45018208026885986
The modified gen p mean: 0.4485644996166229, gen p mean: -0.13418321311473846, mean p set: 0.44904476404190063
loss_pred:0.05185046046972275, decouple_loss:0.039956606924533844
loss_pred:0.05297359451651573, decouple_loss:0.03842254728078842
The modified gen p mean: 0.44795140624046326, gen p mean: -0.13220074772834778, mean p set: 0.44843170046806335
loss_pred:0.05217178910970688, decouple_loss:0.03924855589866638
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500880539417267, gen p mean: -0.1460910439491272, mean p set: 0.4505683481693268
The modified gen p mean: 0.4469155967235565, gen p mean: -0.14540424942970276, mean p set: 0.4473958909511566
loss_pred:0.051097918301820755, decouple_loss:0.03981788828969002
loss_pred:0.0545300617814064, decouple_loss:0.04058563709259033
The modified gen p mean: 0.4477846920490265, gen p mean: -0.14568503201007843, mean p set: 0.4482649564743042
loss_pred:0.054649658501148224, decouple_loss:0.0405297577381134
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482189118862152, gen p mean: -0.13269932568073273, mean p set: 0.4486992359161377
The modified gen p mean: 0.4468880295753479, gen p mean: -0.1363358497619629, mean p set: 0.447368323802948
loss_pred:0.05457199364900589, decouple_loss:0.04208238795399666
loss_pred:0.05467107146978378, decouple_loss:0.037806037813425064
The modified gen p mean: 0.448089063167572, gen p mean: -0.13615983724594116, mean p set: 0.4485693573951721
loss_pred:0.052230894565582275, decouple_loss:0.03720514848828316
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784075021743774, gen p mean: -0.12801212072372437, mean p set: 0.44832107424736023
The modified gen p mean: 0.4495560824871063, gen p mean: -0.13052044808864594, mean p set: 0.4500364065170288
loss_pred:0.05526824668049812, decouple_loss:0.041113078594207764
loss_pred:0.051061615347862244, decouple_loss:0.03813832998275757
The modified gen p mean: 0.44812509417533875, gen p mean: -0.1294483244419098, mean p set: 0.44860541820526123
loss_pred:0.05245061218738556, decouple_loss:0.03857066482305527
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491856098175049, gen p mean: -0.1406347155570984, mean p set: 0.449665904045105
The modified gen p mean: 0.4470553696155548, gen p mean: -0.1348908394575119, mean p set: 0.4475356340408325
loss_pred:0.050992995500564575, decouple_loss:0.038042861968278885
loss_pred:0.05493418127298355, decouple_loss:0.03904331475496292
The modified gen p mean: 0.44821542501449585, gen p mean: -0.1313944160938263, mean p set: 0.44869574904441833
loss_pred:0.054493993520736694, decouple_loss:0.0422966443002224
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446414589881897, gen p mean: -0.14849859476089478, mean p set: 0.4468948543071747
The modified gen p mean: 0.4501623511314392, gen p mean: -0.14538231492042542, mean p set: 0.4506426155567169
loss_pred:0.05300022289156914, decouple_loss:0.04020765796303749
loss_pred:0.05253518745303154, decouple_loss:0.04068462923169136
The modified gen p mean: 0.4492429792881012, gen p mean: -0.14371268451213837, mean p set: 0.4497232735157013
loss_pred:0.05155648663640022, decouple_loss:0.039080824702978134
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476286470890045, gen p mean: -0.15156476199626923, mean p set: 0.4481089115142822
The modified gen p mean: 0.44852301478385925, gen p mean: -0.15283255279064178, mean p set: 0.44900330901145935
loss_pred:0.0553252249956131, decouple_loss:0.04011674225330353
loss_pred:0.05103391781449318, decouple_loss:0.04048225283622742
The modified gen p mean: 0.4480031430721283, gen p mean: -0.15008363127708435, mean p set: 0.4484834671020508
loss_pred:0.051264625042676926, decouple_loss:0.039293572306632996
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474222660064697, gen p mean: -0.14858049154281616, mean p set: 0.4479025602340698
The modified gen p mean: 0.4466460347175598, gen p mean: -0.14655344188213348, mean p set: 0.4471263289451599
loss_pred:0.053464651107788086, decouple_loss:0.03861060366034508
loss_pred:0.05329449474811554, decouple_loss:0.03895850479602814
The modified gen p mean: 0.4482479691505432, gen p mean: -0.1501239538192749, mean p set: 0.4487282633781433
loss_pred:0.052237264811992645, decouple_loss:0.04064817354083061
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881513714790344, gen p mean: -0.14270944893360138, mean p set: 0.44929543137550354
The modified gen p mean: 0.44678202271461487, gen p mean: -0.13778406381607056, mean p set: 0.44726231694221497
loss_pred:0.0527823232114315, decouple_loss:0.04101653769612312
The modified gen p mean: 0.4478377103805542, gen p mean: -0.14268560707569122, mean p set: 0.4483180344104767
loss_pred:0.05463366582989693, decouple_loss:0.03915298730134964
loss_pred:0.0545019768178463, decouple_loss:0.04050778970122337
2023-05-01 16:11:58 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.13698671758174896, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.13575707376003265, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.1352860927581787, mean p set: 0.4500633478164673
loss_pred:0.05481152981519699, decouple_loss:0.03924834728240967
loss_pred:0.05286866053938866, decouple_loss:0.04010043665766716
loss_pred:0.054055869579315186, decouple_loss:0.03901800885796547
WV_0_PC_1_EH_0_PS_40_5, loss: 0.05588480085134506, avg_mse: 0.055132199078798294
current test mse: 0.055132
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471322298049927, gen p mean: -0.13330596685409546, mean p set: 0.4476125240325928
The modified gen p mean: 0.4476760923862457, gen p mean: -0.13482491672039032, mean p set: 0.4481564164161682
The modified gen p mean: 0.4475904405117035, gen p mean: -0.13793440163135529, mean p set: 0.4480707347393036
loss_pred:0.05265326797962189, decouple_loss:0.0406685508787632
loss_pred:0.052614085376262665, decouple_loss:0.04060503467917442
loss_pred:0.05433926731348038, decouple_loss:0.04192084074020386
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480733871459961, gen p mean: -0.14460285007953644, mean p set: 0.4485537111759186
The modified gen p mean: 0.44617778062820435, gen p mean: -0.13841505348682404, mean p set: 0.44665804505348206
loss_pred:0.05381077155470848, decouple_loss:0.042192231863737106
loss_pred:0.051760442554950714, decouple_loss:0.03967129439115524
The modified gen p mean: 0.4479919672012329, gen p mean: -0.1470068395137787, mean p set: 0.448472261428833
loss_pred:0.051211174577474594, decouple_loss:0.03879477083683014
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483628273010254, gen p mean: -0.15252044796943665, mean p set: 0.4488431215286255
The modified gen p mean: 0.44904133677482605, gen p mean: -0.14994104206562042, mean p set: 0.44952166080474854
loss_pred:0.05192890763282776, decouple_loss:0.038541581481695175
loss_pred:0.05110464617609978, decouple_loss:0.03931189700961113
The modified gen p mean: 0.4484303593635559, gen p mean: -0.14992864429950714, mean p set: 0.4489106833934784
loss_pred:0.05341773107647896, decouple_loss:0.0411246195435524
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474041759967804, gen p mean: -0.145236536860466, mean p set: 0.4478845000267029
The modified gen p mean: 0.44823968410491943, gen p mean: -0.1483284831047058, mean p set: 0.44871997833251953
loss_pred:0.05356914550065994, decouple_loss:0.03906218335032463
loss_pred:0.05099279060959816, decouple_loss:0.03905997797846794
The modified gen p mean: 0.4483294188976288, gen p mean: -0.14498475193977356, mean p set: 0.4488097131252289
loss_pred:0.05129959434270859, decouple_loss:0.03985634818673134
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482411742210388, gen p mean: -0.14227700233459473, mean p set: 0.4487214982509613
The modified gen p mean: 0.4468555450439453, gen p mean: -0.14373871684074402, mean p set: 0.4473358392715454
loss_pred:0.05242830142378807, decouple_loss:0.03774089366197586
loss_pred:0.05249917507171631, decouple_loss:0.03877030685544014
The modified gen p mean: 0.4485395848751068, gen p mean: -0.1449970304965973, mean p set: 0.4490198791027069
loss_pred:0.05140003189444542, decouple_loss:0.039277687668800354
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483945369720459, gen p mean: -0.1459435671567917, mean p set: 0.4488748610019684
The modified gen p mean: 0.4477677047252655, gen p mean: -0.13989880681037903, mean p set: 0.4482479691505432
loss_pred:0.05280502140522003, decouple_loss:0.0386422760784626
loss_pred:0.05180858448147774, decouple_loss:0.03760325536131859
The modified gen p mean: 0.44793441891670227, gen p mean: -0.14320442080497742, mean p set: 0.44841471314430237
loss_pred:0.05304653197526932, decouple_loss:0.03727634251117706
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466298222541809, gen p mean: -0.14696814119815826, mean p set: 0.447110116481781
The modified gen p mean: 0.44702863693237305, gen p mean: -0.15224963426589966, mean p set: 0.44750893115997314
loss_pred:0.054028984159231186, decouple_loss:0.036627475172281265
loss_pred:0.05325557291507721, decouple_loss:0.03635290265083313
The modified gen p mean: 0.4477187395095825, gen p mean: -0.14911769330501556, mean p set: 0.44819900393486023
loss_pred:0.05197262763977051, decouple_loss:0.03644505888223648
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468289613723755, gen p mean: -0.1502862274646759, mean p set: 0.447309285402298
The modified gen p mean: 0.4471645653247833, gen p mean: -0.14883701503276825, mean p set: 0.4476448595523834
loss_pred:0.051466893404722214, decouple_loss:0.03757411986589432
loss_pred:0.050182923674583435, decouple_loss:0.03580418601632118
The modified gen p mean: 0.447710245847702, gen p mean: -0.1491985023021698, mean p set: 0.4481905400753021
loss_pred:0.05201846361160278, decouple_loss:0.03773064911365509
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891953468322754, gen p mean: -0.15192584693431854, mean p set: 0.44939976930618286
The modified gen p mean: 0.448035329580307, gen p mean: -0.15018120408058167, mean p set: 0.4485156238079071
loss_pred:0.05123177543282509, decouple_loss:0.04002465307712555
loss_pred:0.05051296949386597, decouple_loss:0.037043023854494095
The modified gen p mean: 0.44725272059440613, gen p mean: -0.1512339860200882, mean p set: 0.4477330446243286
loss_pred:0.051398344337940216, decouple_loss:0.0363326221704483
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
NaN value num: 0
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44916775822639465, gen p mean: -0.15139882266521454, mean p set: 0.44964808225631714
loss_pred:0.056945979595184326, decouple_loss:0.0406162403523922
The modified gen p mean: 0.4523581564426422, gen p mean: -0.15369924902915955, mean p set: 0.4528384804725647The modified gen p mean: 0.4490417540073395, gen p mean: -0.1492728590965271, mean p set: 0.4495220482349396
loss_pred:0.05646757781505585, decouple_loss:0.04141312465071678
loss_pred:0.05685547739267349, decouple_loss:0.04541189968585968
2023-05-01 16:14:45 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.15473000705242157, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.15466520190238953, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.15404507517814636, mean p set: 0.45035696029663086
loss_pred:0.05481599271297455, decouple_loss:0.03888802230358124
loss_pred:0.05418002977967262, decouple_loss:0.039120934903621674
loss_pred:0.05272433161735535, decouple_loss:0.03997797146439552
WV_0_PC_1_EH_0_PS_40_5, loss: 0.05587323009967804, avg_mse: 0.05557706207036972
current test mse: 0.055577
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147180557250977, gen p mean: -0.15491828322410583, mean p set: 0.45195209980010986
loss_pred:0.05687937140464783, decouple_loss:0.04666603356599808
The modified gen p mean: 0.4511649012565613, gen p mean: -0.15490669012069702, mean p set: 0.45164522528648376The modified gen p mean: 0.45109039545059204, gen p mean: -0.15867134928703308, mean p set: 0.45157068967819214
loss_pred:0.055488381534814835, decouple_loss:0.0439278744161129
loss_pred:0.055443134158849716, decouple_loss:0.044378552585840225
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263224840164185, gen p mean: -0.1552400290966034, mean p set: 0.45311251282691956
The modified gen p mean: 0.4496529996395111, gen p mean: -0.1510620266199112, mean p set: 0.4501332640647888
loss_pred:0.05309511721134186, decouple_loss:0.045915331691503525
loss_pred:0.054077569395303726, decouple_loss:0.04269978031516075
The modified gen p mean: 0.45214828848838806, gen p mean: -0.1540520042181015, mean p set: 0.45262858271598816
loss_pred:0.056113556027412415, decouple_loss:0.04872096702456474
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502812325954437, gen p mean: -0.1534656286239624, mean p set: 0.4507615268230438
The modified gen p mean: 0.4519825577735901, gen p mean: -0.15728238224983215, mean p set: 0.4524628818035126
loss_pred:0.053844332695007324, decouple_loss:0.04293035343289375
loss_pred:0.0548706129193306, decouple_loss:0.04596681147813797
The modified gen p mean: 0.4536886215209961, gen p mean: -0.1471216231584549, mean p set: 0.4541688859462738
loss_pred:0.054868172854185104, decouple_loss:0.04699834808707237
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835197925567627, gen p mean: -0.14832362532615662, mean p set: 0.44883227348327637
The modified gen p mean: 0.4511868357658386, gen p mean: -0.1556239277124405, mean p set: 0.4516671597957611
loss_pred:0.05464409291744232, decouple_loss:0.04253757372498512
loss_pred:0.055373698472976685, decouple_loss:0.043690092861652374
The modified gen p mean: 0.4534391462802887, gen p mean: -0.14870432019233704, mean p set: 0.4539194405078888
loss_pred:0.054189037531614304, decouple_loss:0.045277759432792664
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138779282569885, gen p mean: -0.15695635974407196, mean p set: 0.45186808705329895
loss_pred:0.05138443410396576, decouple_loss:0.04411013796925545
The modified gen p mean: 0.4527747631072998, gen p mean: -0.15467672049999237, mean p set: 0.4532550275325775The modified gen p mean: 0.449347585439682, gen p mean: -0.15408386290073395, mean p set: 0.4498278796672821
loss_pred:0.05372219532728195, decouple_loss:0.04274744912981987
loss_pred:0.053478412330150604, decouple_loss:0.04123685881495476
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795286655426025, gen p mean: -0.14988264441490173, mean p set: 0.44843316078186035
The modified gen p mean: 0.4494574964046478, gen p mean: -0.1515074074268341, mean p set: 0.4499378204345703
loss_pred:0.053399618715047836, decouple_loss:0.040956512093544006
loss_pred:0.054600607603788376, decouple_loss:0.04226665198802948
The modified gen p mean: 0.4522474408149719, gen p mean: -0.15415942668914795, mean p set: 0.452727735042572
loss_pred:0.05261141061782837, decouple_loss:0.043669357895851135
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45353665947914124, gen p mean: -0.14970716834068298, mean p set: 0.4540169835090637
The modified gen p mean: 0.4521077275276184, gen p mean: -0.14878302812576294, mean p set: 0.4525880217552185
loss_pred:0.05317331850528717, decouple_loss:0.042640700936317444
loss_pred:0.05211881548166275, decouple_loss:0.04293366149067879
The modified gen p mean: 0.44904929399490356, gen p mean: -0.14799757301807404, mean p set: 0.44952961802482605
loss_pred:0.052983082830905914, decouple_loss:0.04171287640929222
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808679819107056, gen p mean: -0.14413674175739288, mean p set: 0.44856709241867065
The modified gen p mean: 0.4529041349887848, gen p mean: -0.14646016061306, mean p set: 0.4533843994140625
loss_pred:0.05459185317158699, decouple_loss:0.04161233454942703
loss_pred:0.05562601611018181, decouple_loss:0.041550710797309875
The modified gen p mean: 0.4502754211425781, gen p mean: -0.14243967831134796, mean p set: 0.45075568556785583
loss_pred:0.05375298857688904, decouple_loss:0.042292267084121704
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214441418647766, gen p mean: -0.15038998425006866, mean p set: 0.45262470841407776
loss_pred:0.05259363725781441, decouple_loss:0.04218556731939316
The modified gen p mean: 0.4527755677700043, gen p mean: -0.14982753992080688, mean p set: 0.45325586199760437
The modified gen p mean: 0.45065250992774963, gen p mean: -0.152537003159523, mean p set: 0.45113280415534973
loss_pred:0.05418006703257561, decouple_loss:0.04285646229982376
loss_pred:0.050639525055885315, decouple_loss:0.041671134531497955
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496348202228546, gen p mean: -0.1563989371061325, mean p set: 0.4501151144504547
loss_pred:0.05331919342279434, decouple_loss:0.041645802557468414
The modified gen p mean: 0.4515826106071472, gen p mean: -0.15736664831638336, mean p set: 0.4520629048347473The modified gen p mean: 0.4527861773967743, gen p mean: -0.15323276817798615, mean p set: 0.4532664716243744
loss_pred:0.05196526274085045, decouple_loss:0.0420135073363781
loss_pred:0.053754162043333054, decouple_loss:0.0428658202290535
2023-05-01 16:16:53 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.15451736748218536, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.15289954841136932, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.15305964648723602, mean p set: 0.4500633478164673
loss_pred:0.05610964447259903, decouple_loss:0.04479521885514259
loss_pred:0.053635548800230026, decouple_loss:0.04583713039755821
loss_pred:0.05448548495769501, decouple_loss:0.044552870094776154
WV_0_PC_1_EH_0_PS_40_5, loss: 0.05699664354324341, avg_mse: 0.05656096339225769
current test mse: 0.056561
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45189160108566284, gen p mean: -0.1527300775051117, mean p set: 0.45237189531326294
The modified gen p mean: 0.4505113959312439, gen p mean: -0.14163507521152496, mean p set: 0.4509917199611664
loss_pred:0.05141545087099075, decouple_loss:0.0435740128159523
The modified gen p mean: 0.4503602981567383, gen p mean: -0.15244416892528534, mean p set: 0.4508405923843384
loss_pred:0.0528913252055645, decouple_loss:0.0436452180147171
loss_pred:0.050259433686733246, decouple_loss:0.04256797954440117
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947129487991333, gen p mean: -0.14716745913028717, mean p set: 0.4499515891075134
The modified gen p mean: 0.4536969065666199, gen p mean: -0.14991292357444763, mean p set: 0.45417720079421997
loss_pred:0.05391664430499077, decouple_loss:0.04297661408782005
loss_pred:0.05549143999814987, decouple_loss:0.044015415012836456
The modified gen p mean: 0.4513629972934723, gen p mean: -0.1535426676273346, mean p set: 0.4518432915210724
loss_pred:0.0523674413561821, decouple_loss:0.04185143858194351
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128703117370605, gen p mean: -0.15908369421958923, mean p set: 0.45176732540130615
The modified gen p mean: 0.44893988966941833, gen p mean: -0.1576763540506363, mean p set: 0.44942015409469604
loss_pred:0.054725322872400284, decouple_loss:0.04366032034158707
loss_pred:0.0537017323076725, decouple_loss:0.041986893862485886
The modified gen p mean: 0.45162874460220337, gen p mean: -0.156334787607193, mean p set: 0.45210903882980347
loss_pred:0.053616441786289215, decouple_loss:0.04271037131547928
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514996409416199, gen p mean: -0.15814155340194702, mean p set: 0.45197993516921997
The modified gen p mean: 0.45114830136299133, gen p mean: -0.16052910685539246, mean p set: 0.45162856578826904
loss_pred:0.053338587284088135, decouple_loss:0.042247530072927475
loss_pred:0.0502459742128849, decouple_loss:0.04158002883195877
The modified gen p mean: 0.45334023237228394, gen p mean: -0.15699465572834015, mean p set: 0.4538205564022064
loss_pred:0.054926030337810516, decouple_loss:0.042486656457185745
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039981603622437, gen p mean: -0.1637369990348816, mean p set: 0.45088011026382446
The modified gen p mean: 0.44802626967430115, gen p mean: -0.16059908270835876, mean p set: 0.44850653409957886
loss_pred:0.052508991211652756, decouple_loss:0.041506119072437286
loss_pred:0.05356891080737114, decouple_loss:0.04071374237537384
The modified gen p mean: 0.4518738090991974, gen p mean: -0.16693098843097687, mean p set: 0.4523541033267975
loss_pred:0.05242981016635895, decouple_loss:0.04173444211483002
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490574598312378, gen p mean: -0.16428013145923615, mean p set: 0.4495377540588379
loss_pred:0.05330759659409523, decouple_loss:0.04014183580875397
The modified gen p mean: 0.4484826624393463, gen p mean: -0.17139340937137604, mean p set: 0.4489629566669464
The modified gen p mean: 0.4505225718021393, gen p mean: -0.16916701197624207, mean p set: 0.4510028660297394
loss_pred:0.05247937887907028, decouple_loss:0.04014652967453003
loss_pred:0.049676619470119476, decouple_loss:0.041003644466400146
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479731619358063, gen p mean: -0.1646437793970108, mean p set: 0.448453426361084
The modified gen p mean: 0.44961437582969666, gen p mean: -0.16719071567058563, mean p set: 0.45009464025497437
loss_pred:0.052820224314928055, decouple_loss:0.03970707207918167
loss_pred:0.05152841657400131, decouple_loss:0.03971051052212715
The modified gen p mean: 0.44970130920410156, gen p mean: -0.16852636635303497, mean p set: 0.45018160343170166
loss_pred:0.05184315890073776, decouple_loss:0.04101745784282684
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490250051021576, gen p mean: -0.158151313662529, mean p set: 0.4495052993297577
The modified gen p mean: 0.4502444267272949, gen p mean: -0.15980905294418335, mean p set: 0.450724720954895
loss_pred:0.05231962352991104, decouple_loss:0.039628054946660995
loss_pred:0.05142771452665329, decouple_loss:0.0422111339867115
The modified gen p mean: 0.4501210153102875, gen p mean: -0.16299360990524292, mean p set: 0.45060133934020996
loss_pred:0.04899143427610397, decouple_loss:0.03968222066760063
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776785373687744, gen p mean: -0.15356703102588654, mean p set: 0.4482481777667999
The modified gen p mean: 0.4525482952594757, gen p mean: -0.15428970754146576, mean p set: 0.4530285596847534
loss_pred:0.05181197449564934, decouple_loss:0.03984649479389191
loss_pred:0.05197756737470627, decouple_loss:0.03995484486222267
The modified gen p mean: 0.4538688063621521, gen p mean: -0.15270929038524628, mean p set: 0.4543490707874298
loss_pred:0.05182158574461937, decouple_loss:0.04078056663274765
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
NaN value num: 0
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513419568538666, gen p mean: -0.1572103053331375, mean p set: 0.4518222510814667
loss_pred:0.054253555834293365, decouple_loss:0.04295819252729416
The modified gen p mean: 0.4524059295654297, gen p mean: -0.15799836814403534, mean p set: 0.4528862237930298The modified gen p mean: 0.4518902897834778, gen p mean: -0.1568727195262909, mean p set: 0.4523705840110779
loss_pred:0.05452350899577141, decouple_loss:0.04321272671222687
loss_pred:0.053238242864608765, decouple_loss:0.04242735728621483
2023-05-01 16:19:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.17686551809310913, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.1741034835577011, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.17390957474708557, mean p set: 0.4500633478164673
loss_pred:0.05555156245827675, decouple_loss:0.04287788271903992
loss_pred:0.052658915519714355, decouple_loss:0.04368593543767929
loss_pred:0.05394358187913895, decouple_loss:0.04304925352334976
WV_0_PC_1_EH_0_PS_40_5, loss: 0.056211572140455246, avg_mse: 0.05598634108901024
current test mse: 0.055986
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524298310279846, gen p mean: -0.1742655485868454, mean p set: 0.4529101252555847
The modified gen p mean: 0.4527721405029297, gen p mean: -0.17085802555084229, mean p set: 0.4532524347305298
loss_pred:0.05196846276521683, decouple_loss:0.0475275032222271
The modified gen p mean: 0.45301079750061035, gen p mean: -0.17569348216056824, mean p set: 0.45349109172821045
loss_pred:0.05246041715145111, decouple_loss:0.04734980687499046
loss_pred:0.054180651903152466, decouple_loss:0.044649507850408554
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522419273853302, gen p mean: -0.18803992867469788, mean p set: 0.4527222514152527
The modified gen p mean: 0.45214611291885376, gen p mean: -0.18333515524864197, mean p set: 0.45262637734413147
loss_pred:0.05486288294196129, decouple_loss:0.0469837486743927
loss_pred:0.05386893078684807, decouple_loss:0.04603700339794159
The modified gen p mean: 0.45190414786338806, gen p mean: -0.1816568672657013, mean p set: 0.45238441228866577
loss_pred:0.0512944832444191, decouple_loss:0.044461995363235474
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45320218801498413, gen p mean: -0.1758057326078415, mean p set: 0.45368245244026184
The modified gen p mean: 0.4520016610622406, gen p mean: -0.17635975778102875, mean p set: 0.4524819552898407
loss_pred:0.052132606506347656, decouple_loss:0.044411011040210724
loss_pred:0.05422031879425049, decouple_loss:0.04549194872379303
The modified gen p mean: 0.453250527381897, gen p mean: -0.1881958693265915, mean p set: 0.45373082160949707
loss_pred:0.050803620368242264, decouple_loss:0.043067850172519684
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525059759616852, gen p mean: -0.1891356110572815, mean p set: 0.4529862403869629
loss_pred:0.05022237077355385, decouple_loss:0.042399559170007706
The modified gen p mean: 0.4542931020259857, gen p mean: -0.18276698887348175, mean p set: 0.4547733962535858
The modified gen p mean: 0.4526849389076233, gen p mean: -0.18524150550365448, mean p set: 0.4531652331352234
loss_pred:0.054300155490636826, decouple_loss:0.044365473091602325
loss_pred:0.05351787433028221, decouple_loss:0.04383396357297897
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210444927215576, gen p mean: -0.19580528140068054, mean p set: 0.45258474349975586
The modified gen p mean: 0.45377805829048157, gen p mean: -0.19758696854114532, mean p set: 0.45425835251808167
loss_pred:0.05295976996421814, decouple_loss:0.04346119984984398
The modified gen p mean: 0.4515909254550934, gen p mean: -0.19880123436450958, mean p set: 0.4520712196826935loss_pred:0.05455494299530983, decouple_loss:0.04337240383028984
loss_pred:0.051834315061569214, decouple_loss:0.04188241437077522
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527815580368042, gen p mean: -0.20576255023479462, mean p set: 0.4532618522644043
loss_pred:0.05324079096317291, decouple_loss:0.04440028965473175
The modified gen p mean: 0.4535497725009918, gen p mean: -0.20849891006946564, mean p set: 0.4540300667285919The modified gen p mean: 0.4519527554512024, gen p mean: -0.21072132885456085, mean p set: 0.4524330198764801
loss_pred:0.05214559659361839, decouple_loss:0.04543156176805496
loss_pred:0.052462220191955566, decouple_loss:0.042453546077013016
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513481557369232, gen p mean: -0.20557451248168945, mean p set: 0.4518284201622009
The modified gen p mean: 0.45258501172065735, gen p mean: -0.20904874801635742, mean p set: 0.45306530594825745
loss_pred:0.05213497206568718, decouple_loss:0.04389026015996933
loss_pred:0.04991121590137482, decouple_loss:0.042289942502975464
The modified gen p mean: 0.45363762974739075, gen p mean: -0.21329286694526672, mean p set: 0.45411795377731323
loss_pred:0.04976993426680565, decouple_loss:0.042190033942461014
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272377133369446, gen p mean: -0.20266719162464142, mean p set: 0.45320409536361694
The modified gen p mean: 0.4533917009830475, gen p mean: -0.19731831550598145, mean p set: 0.4538719952106476
loss_pred:0.051536012440919876, decouple_loss:0.04270368441939354
loss_pred:0.0535862036049366, decouple_loss:0.0425763800740242
The modified gen p mean: 0.45179280638694763, gen p mean: -0.20149363577365875, mean p set: 0.45227310061454773
loss_pred:0.05602596327662468, decouple_loss:0.0437411330640316
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516843557357788, gen p mean: -0.1899925321340561, mean p set: 0.4521646797657013
The modified gen p mean: 0.45305269956588745, gen p mean: -0.19313234090805054, mean p set: 0.45353299379348755loss_pred:0.0512719452381134, decouple_loss:0.04209877923130989
The modified gen p mean: 0.4527265727519989, gen p mean: -0.2016015350818634, mean p set: 0.453206866979599
loss_pred:0.05398847535252571, decouple_loss:0.04248170554637909
loss_pred:0.049117814749479294, decouple_loss:0.04211528226733208
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525115191936493, gen p mean: -0.18593649566173553, mean p set: 0.4529918134212494
loss_pred:0.05181189253926277, decouple_loss:0.041489217430353165
The modified gen p mean: 0.45258545875549316, gen p mean: -0.19445852935314178, mean p set: 0.4530657231807709The modified gen p mean: 0.4513065814971924, gen p mean: -0.19163161516189575, mean p set: 0.4517868459224701
loss_pred:0.05032970756292343, decouple_loss:0.04436498507857323
loss_pred:0.049643199890851974, decouple_loss:0.041414063423871994
2023-05-01 16:21:46 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.19934874773025513, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.19717632234096527, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.1962028443813324, mean p set: 0.4500633478164673
loss_pred:0.05559324100613594, decouple_loss:0.04610417038202286
loss_pred:0.05242174491286278, decouple_loss:0.046195268630981445
loss_pred:0.05369189754128456, decouple_loss:0.044959116727113724
WV_0_PC_1_EH_0_PS_40_5, loss: 0.05618993565440178, avg_mse: 0.0561629943549633
current test mse: 0.056163
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525388479232788, gen p mean: -0.19275203347206116, mean p set: 0.4530191123485565
The modified gen p mean: 0.45311427116394043, gen p mean: -0.19823206961154938, mean p set: 0.4535945653915405
loss_pred:0.049258869141340256, decouple_loss:0.04152080416679382
The modified gen p mean: 0.45484495162963867, gen p mean: -0.19082924723625183, mean p set: 0.4553252160549164
loss_pred:0.05313095822930336, decouple_loss:0.04330477491021156
loss_pred:0.052667923271656036, decouple_loss:0.0428755022585392
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529833197593689, gen p mean: -0.20006568729877472, mean p set: 0.4534636437892914
The modified gen p mean: 0.4527427554130554, gen p mean: -0.20375584065914154, mean p set: 0.45322301983833313
loss_pred:0.053771719336509705, decouple_loss:0.04242148622870445
loss_pred:0.05033563822507858, decouple_loss:0.04179620370268822
The modified gen p mean: 0.4518020749092102, gen p mean: -0.19686034321784973, mean p set: 0.4522823691368103
loss_pred:0.0496612973511219, decouple_loss:0.042886946350336075
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519331455230713, gen p mean: -0.2098667025566101, mean p set: 0.4524134397506714
The modified gen p mean: 0.4531158208847046, gen p mean: -0.20946994423866272, mean p set: 0.4535960853099823
loss_pred:0.05039976164698601, decouple_loss:0.04208355396986008
loss_pred:0.05408575385808945, decouple_loss:0.04257751628756523
The modified gen p mean: 0.45237550139427185, gen p mean: -0.2031228095293045, mean p set: 0.45285579562187195
loss_pred:0.05370384082198143, decouple_loss:0.04336661472916603
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45313456654548645, gen p mean: -0.2223392128944397, mean p set: 0.45361486077308655
The modified gen p mean: 0.45231375098228455, gen p mean: -0.21584253013134003, mean p set: 0.45279404520988464
loss_pred:0.04950952157378197, decouple_loss:0.04326552152633667
loss_pred:0.053926028311252594, decouple_loss:0.04317035153508186
The modified gen p mean: 0.45199093222618103, gen p mean: -0.21404625475406647, mean p set: 0.45247119665145874
loss_pred:0.05279041826725006, decouple_loss:0.04285543039441109
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45120999217033386, gen p mean: -0.21721215546131134, mean p set: 0.45169031620025635
The modified gen p mean: 0.4533199667930603, gen p mean: -0.21816878020763397, mean p set: 0.4538002610206604
loss_pred:0.05159551277756691, decouple_loss:0.041009221225976944
loss_pred:0.053058821707963943, decouple_loss:0.04318288341164589
The modified gen p mean: 0.4541069567203522, gen p mean: -0.21439172327518463, mean p set: 0.45458728075027466
loss_pred:0.051064711064100266, decouple_loss:0.04287949204444885
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45416387915611267, gen p mean: -0.21391431987285614, mean p set: 0.45464417338371277
The modified gen p mean: 0.4516180455684662, gen p mean: -0.2166009396314621, mean p set: 0.4520983099937439
The modified gen p mean: 0.452451229095459, gen p mean: -0.2175050675868988, mean p set: 0.4529314935207367
loss_pred:0.05253834277391434, decouple_loss:0.042676057666540146
loss_pred:0.04911750555038452, decouple_loss:0.04185822606086731
loss_pred:0.053981080651283264, decouple_loss:0.04321921989321709
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45290908217430115, gen p mean: -0.21275858581066132, mean p set: 0.45338940620422363
The modified gen p mean: 0.452231764793396, gen p mean: -0.2073763906955719, mean p set: 0.4527120590209961loss_pred:0.05274876952171326, decouple_loss:0.04163457825779915
The modified gen p mean: 0.4525592029094696, gen p mean: -0.20712338387966156, mean p set: 0.4530394971370697
loss_pred:0.05007249861955643, decouple_loss:0.041114240884780884
loss_pred:0.050702374428510666, decouple_loss:0.04066280648112297
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45320364832878113, gen p mean: -0.20751892030239105, mean p set: 0.4536839425563812
The modified gen p mean: 0.452522873878479, gen p mean: -0.2108474224805832, mean p set: 0.4530031979084015
loss_pred:0.05225382745265961, decouple_loss:0.040229786187410355
loss_pred:0.05115928873419762, decouple_loss:0.04107167571783066
The modified gen p mean: 0.4520867168903351, gen p mean: -0.20766764879226685, mean p set: 0.4525669813156128
loss_pred:0.051496729254722595, decouple_loss:0.040845293551683426
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44418954849243164, gen p mean: -0.21908414363861084, mean p set: 0.44466984272003174
loss_pred:0.05644674599170685, decouple_loss:0.04677584022283554
The modified gen p mean: 0.44583043456077576, gen p mean: -0.22167742252349854, mean p set: 0.44631072878837585The modified gen p mean: 0.4459589421749115, gen p mean: -0.22319155931472778, mean p set: 0.4464392364025116
loss_pred:0.05275115743279457, decouple_loss:0.04666163772344589
loss_pred:0.05202372744679451, decouple_loss:0.04402961954474449
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630181789398193, gen p mean: -0.21504908800125122, mean p set: 0.44678211212158203
The modified gen p mean: 0.4460996687412262, gen p mean: -0.21583274006843567, mean p set: 0.4465799629688263
loss_pred:0.054232239723205566, decouple_loss:0.045757390558719635
loss_pred:0.05155275762081146, decouple_loss:0.0441286675632
The modified gen p mean: 0.44722798466682434, gen p mean: -0.2114095389842987, mean p set: 0.44770827889442444
loss_pred:0.05435919016599655, decouple_loss:0.046242181211709976
2023-05-01 16:24:32 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.1962539553642273, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.1941891312599182, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.19301050901412964, mean p set: 0.45035696029663086
loss_pred:0.05421952158212662, decouple_loss:0.04422599822282791
loss_pred:0.05130496993660927, decouple_loss:0.044438473880290985
loss_pred:0.05253174901008606, decouple_loss:0.04358963668346405
WV_0_PC_1_EH_0_PS_40_5, loss: 0.05488964915275574, avg_mse: 0.054941367357969284
current test mse: 0.054941
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717806577682495, gen p mean: -0.19542843103408813, mean p set: 0.44765836000442505
The modified gen p mean: 0.44665905833244324, gen p mean: -0.19304023683071136, mean p set: 0.44713932275772095
loss_pred:0.053614094853401184, decouple_loss:0.044646281749010086
The modified gen p mean: 0.44563719630241394, gen p mean: -0.19123061001300812, mean p set: 0.44611749053001404
loss_pred:0.05270003154873848, decouple_loss:0.04500218853354454
loss_pred:0.050506073981523514, decouple_loss:0.043602269142866135
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44587963819503784, gen p mean: -0.16749009490013123, mean p set: 0.4463599622249603
The modified gen p mean: 0.4476238787174225, gen p mean: -0.1738453507423401, mean p set: 0.4481041729450226
loss_pred:0.05214809998869896, decouple_loss:0.046899765729904175
loss_pred:0.053552571684122086, decouple_loss:0.04508088156580925
The modified gen p mean: 0.44671282172203064, gen p mean: -0.16972920298576355, mean p set: 0.44719311594963074
loss_pred:0.050917576998472214, decouple_loss:0.043802082538604736
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44547614455223083, gen p mean: -0.18560828268527985, mean p set: 0.44595643877983093
loss_pred:0.05200707167387009, decouple_loss:0.04488787427544594
The modified gen p mean: 0.4469248056411743, gen p mean: -0.18638628721237183, mean p set: 0.447405070066452The modified gen p mean: 0.4465024173259735, gen p mean: -0.18277646601200104, mean p set: 0.446982741355896
loss_pred:0.051058441400527954, decouple_loss:0.044109757989645004
loss_pred:0.052455272525548935, decouple_loss:0.044103268533945084
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464435279369354, gen p mean: -0.18844790756702423, mean p set: 0.4469238221645355
The modified gen p mean: 0.4456939697265625, gen p mean: -0.189749613404274, mean p set: 0.446174293756485
loss_pred:0.05247454717755318, decouple_loss:0.04321641847491264
loss_pred:0.05163446068763733, decouple_loss:0.0428459495306015
The modified gen p mean: 0.44681504368782043, gen p mean: -0.19107195734977722, mean p set: 0.44729533791542053
loss_pred:0.05174396559596062, decouple_loss:0.04354652389883995
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660240411758423, gen p mean: -0.20030774176120758, mean p set: 0.4470827281475067
The modified gen p mean: 0.44675591588020325, gen p mean: -0.19356952607631683, mean p set: 0.44723621010780334
loss_pred:0.05068923532962799, decouple_loss:0.04238606616854668
loss_pred:0.05132851004600525, decouple_loss:0.04309047758579254
The modified gen p mean: 0.4465557038784027, gen p mean: -0.1969841569662094, mean p set: 0.4470359981060028
loss_pred:0.050102341920137405, decouple_loss:0.04246159642934799
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446176677942276, gen p mean: -0.1975288987159729, mean p set: 0.4466569721698761
The modified gen p mean: 0.4464186728000641, gen p mean: -0.19700556993484497, mean p set: 0.4468989372253418
loss_pred:0.05305105075240135, decouple_loss:0.0427544042468071
loss_pred:0.053298648446798325, decouple_loss:0.04200959578156471
The modified gen p mean: 0.4465227723121643, gen p mean: -0.19213469326496124, mean p set: 0.447003036737442
loss_pred:0.05099113658070564, decouple_loss:0.04339415952563286
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764935970306396, gen p mean: -0.189065620303154, mean p set: 0.44812965393066406
The modified gen p mean: 0.4470158815383911, gen p mean: -0.18730872869491577, mean p set: 0.44749611616134644
loss_pred:0.054425615817308426, decouple_loss:0.04215795174241066
loss_pred:0.0517224445939064, decouple_loss:0.041405949741601944
The modified gen p mean: 0.4473857581615448, gen p mean: -0.18522123992443085, mean p set: 0.4478660225868225
loss_pred:0.05352684482932091, decouple_loss:0.041484933346509933
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725629687309265, gen p mean: -0.18790780007839203, mean p set: 0.44773659110069275
The modified gen p mean: 0.4465615153312683, gen p mean: -0.18044394254684448, mean p set: 0.4470418095588684
loss_pred:0.05009378492832184, decouple_loss:0.04121730104088783
loss_pred:0.05026048794388771, decouple_loss:0.04127240926027298
The modified gen p mean: 0.4449184238910675, gen p mean: -0.18148593604564667, mean p set: 0.4453986883163452
loss_pred:0.054237667471170425, decouple_loss:0.04253072291612625
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465303421020508, gen p mean: -0.1845855861902237, mean p set: 0.4470106363296509
loss_pred:0.051103778183460236, decouple_loss:0.04015156626701355
The modified gen p mean: 0.447144091129303, gen p mean: -0.1887112259864807, mean p set: 0.4476243555545807The modified gen p mean: 0.44647565484046936, gen p mean: -0.1884092092514038, mean p set: 0.44695594906806946
loss_pred:0.0502486526966095, decouple_loss:0.04115360230207443
loss_pred:0.05031425505876541, decouple_loss:0.04197509214282036
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44556576013565063, gen p mean: -0.19280441105365753, mean p set: 0.44604605436325073
The modified gen p mean: 0.4451724886894226, gen p mean: -0.20035532116889954, mean p set: 0.4456527829170227
loss_pred:0.05003504455089569, decouple_loss:0.04101157188415527
loss_pred:0.05020687356591225, decouple_loss:0.04147522896528244
The modified gen p mean: 0.4479641318321228, gen p mean: -0.194918692111969, mean p set: 0.4484444558620453
loss_pred:0.054031793028116226, decouple_loss:0.043402716517448425
2023-05-01 16:26:40 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.1964016556739807, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.19458751380443573, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.19328084588050842, mean p set: 0.45035696029663086
loss_pred:0.052479758858680725, decouple_loss:0.041162971407175064
loss_pred:0.0511130690574646, decouple_loss:0.04118485003709793
loss_pred:0.04948537051677704, decouple_loss:0.041718512773513794
WV_0_PC_1_EH_0_PS_40_5, loss: 0.053093843162059784, avg_mse: 0.05320906639099121
current test mse: 0.053209
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463280439376831, gen p mean: -0.1947363168001175, mean p set: 0.4468083381652832
The modified gen p mean: 0.44565340876579285, gen p mean: -0.19265116751194, mean p set: 0.44613370299339294
loss_pred:0.04834092780947685, decouple_loss:0.04007244110107422
The modified gen p mean: 0.4471542239189148, gen p mean: -0.1929250955581665, mean p set: 0.4476345181465149
loss_pred:0.04954591765999794, decouple_loss:0.04101881384849548
loss_pred:0.050891198217868805, decouple_loss:0.040906377136707306
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44618162512779236, gen p mean: -0.1813632696866989, mean p set: 0.44666188955307007
The modified gen p mean: 0.4470646381378174, gen p mean: -0.18475154042243958, mean p set: 0.4475449025630951
loss_pred:0.05008523911237717, decouple_loss:0.03839881718158722
loss_pred:0.05220954492688179, decouple_loss:0.040103375911712646
The modified gen p mean: 0.44558170437812805, gen p mean: -0.19537948071956635, mean p set: 0.44606199860572815
loss_pred:0.04958264157176018, decouple_loss:0.03962671011686325
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471549987792969, gen p mean: -0.1800345778465271, mean p set: 0.44763532280921936
The modified gen p mean: 0.4457947313785553, gen p mean: -0.17841756343841553, mean p set: 0.446274995803833
loss_pred:0.051361486315727234, decouple_loss:0.03889760002493858
loss_pred:0.05089251697063446, decouple_loss:0.04001873731613159
The modified gen p mean: 0.4463683068752289, gen p mean: -0.18751077353954315, mean p set: 0.4468485414981842
loss_pred:0.05079517513513565, decouple_loss:0.0375351719558239
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468350410461426, gen p mean: -0.17977403104305267, mean p set: 0.44731536507606506
The modified gen p mean: 0.4470544159412384, gen p mean: -0.1837133765220642, mean p set: 0.4475346803665161
loss_pred:0.051239974796772, decouple_loss:0.03927576541900635
loss_pred:0.05327260494232178, decouple_loss:0.03941760212182999
The modified gen p mean: 0.4471602141857147, gen p mean: -0.18976916372776031, mean p set: 0.4476405084133148
loss_pred:0.05063764378428459, decouple_loss:0.0366576723754406
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44599515199661255, gen p mean: -0.19432584941387177, mean p set: 0.44647544622421265
The modified gen p mean: 0.44592511653900146, gen p mean: -0.19497989118099213, mean p set: 0.44640541076660156
loss_pred:0.05297531187534332, decouple_loss:0.0388311930000782
loss_pred:0.04885594919323921, decouple_loss:0.038195833563804626
The modified gen p mean: 0.4458606541156769, gen p mean: -0.1968604028224945, mean p set: 0.4463409185409546
loss_pred:0.04893304407596588, decouple_loss:0.03910842165350914
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44546782970428467, gen p mean: -0.20099245011806488, mean p set: 0.4459480941295624
The modified gen p mean: 0.445913702249527, gen p mean: -0.20154081284999847, mean p set: 0.44639402627944946
loss_pred:0.04771139472723007, decouple_loss:0.038083143532276154
loss_pred:0.04846406355500221, decouple_loss:0.037744518369436264
The modified gen p mean: 0.44659748673439026, gen p mean: -0.2017606943845749, mean p set: 0.44707778096199036
loss_pred:0.04918386787176132, decouple_loss:0.03663013130426407
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696277379989624, gen p mean: -0.20522460341453552, mean p set: 0.44744303822517395
The modified gen p mean: 0.4467942416667938, gen p mean: -0.20930416882038116, mean p set: 0.4472745358943939
loss_pred:0.05225318297743797, decouple_loss:0.038125425577163696
loss_pred:0.05004417151212692, decouple_loss:0.038392383605241776
The modified gen p mean: 0.4470517337322235, gen p mean: -0.20993277430534363, mean p set: 0.4475320279598236
loss_pred:0.0483957976102829, decouple_loss:0.03792763501405716
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665977358818054, gen p mean: -0.20812945067882538, mean p set: 0.44714006781578064
The modified gen p mean: 0.44704344868659973, gen p mean: -0.206030011177063, mean p set: 0.44752374291419983
loss_pred:0.04979721084237099, decouple_loss:0.03752006217837334
loss_pred:0.05159430950880051, decouple_loss:0.03723801299929619
The modified gen p mean: 0.44706955552101135, gen p mean: -0.2062968760728836, mean p set: 0.44754984974861145
loss_pred:0.05041981488466263, decouple_loss:0.037680190056562424
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
NaN value num: 0
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479564130306244, gen p mean: -0.19231544435024261, mean p set: 0.4484367072582245
loss_pred:0.051437970250844955, decouple_loss:0.03812777251005173
The modified gen p mean: 0.44812846183776855, gen p mean: -0.18964482843875885, mean p set: 0.44860872626304626The modified gen p mean: 0.4486970007419586, gen p mean: -0.19630561769008636, mean p set: 0.44917726516723633
loss_pred:0.0497916117310524, decouple_loss:0.037714287638664246
loss_pred:0.05177527293562889, decouple_loss:0.038523007184267044
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478062689304352, gen p mean: -0.18620958924293518, mean p set: 0.4482865631580353
The modified gen p mean: 0.45032182335853577, gen p mean: -0.18780815601348877, mean p set: 0.45080211758613586
loss_pred:0.052564460784196854, decouple_loss:0.0388760045170784
loss_pred:0.052164021879434586, decouple_loss:0.04360665753483772
The modified gen p mean: 0.44855383038520813, gen p mean: -0.18582986295223236, mean p set: 0.4490341246128082
loss_pred:0.049559611827135086, decouple_loss:0.03800448775291443
2023-05-01 16:29:24 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.1905297338962555, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.19026218354701996, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.1887568086385727, mean p set: 0.45035696029663086
loss_pred:0.05149296671152115, decouple_loss:0.038452982902526855
loss_pred:0.05040140450000763, decouple_loss:0.038392987102270126
loss_pred:0.04902472347021103, decouple_loss:0.038189101964235306
WV_0_PC_1_EH_0_PS_40_5, loss: 0.05222361534833908, avg_mse: 0.052608586847782135
current test mse: 0.052609
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877147674560547, gen p mean: -0.19208106398582458, mean p set: 0.44925177097320557
The modified gen p mean: 0.44785863161087036, gen p mean: -0.18609113991260529, mean p set: 0.44833892583847046
loss_pred:0.05244220793247223, decouple_loss:0.037702348083257675
The modified gen p mean: 0.45018404722213745, gen p mean: -0.1924145221710205, mean p set: 0.45066434144973755
loss_pred:0.051516786217689514, decouple_loss:0.039510514587163925
loss_pred:0.05177643522620201, decouple_loss:0.04200083389878273
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730862975120544, gen p mean: -0.19089655578136444, mean p set: 0.44778892397880554
The modified gen p mean: 0.449787974357605, gen p mean: -0.1959138810634613, mean p set: 0.4502682387828827
loss_pred:0.05143054574728012, decouple_loss:0.03855512663722038
loss_pred:0.05035238713026047, decouple_loss:0.04154660552740097
The modified gen p mean: 0.44915780425071716, gen p mean: -0.19061700999736786, mean p set: 0.44963809847831726
loss_pred:0.05202946439385414, decouple_loss:0.041550226509571075
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44954657554626465, gen p mean: -0.1986704170703888, mean p set: 0.45002689957618713
The modified gen p mean: 0.44981130957603455, gen p mean: -0.20324675738811493, mean p set: 0.45029157400131226
loss_pred:0.05293302610516548, decouple_loss:0.04137473180890083
loss_pred:0.052865125238895416, decouple_loss:0.03930952399969101
The modified gen p mean: 0.4493086040019989, gen p mean: -0.2018391191959381, mean p set: 0.449788898229599
loss_pred:0.05404660850763321, decouple_loss:0.039542827755212784
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493502378463745, gen p mean: -0.21413792669773102, mean p set: 0.449830561876297
The modified gen p mean: 0.4484054744243622, gen p mean: -0.21234194934368134, mean p set: 0.4488857388496399
loss_pred:0.05114394426345825, decouple_loss:0.038843922317028046
loss_pred:0.052345938980579376, decouple_loss:0.03821859136223793The modified gen p mean: 0.4491023123264313, gen p mean: -0.21294057369232178, mean p set: 0.44958263635635376
loss_pred:0.051535241305828094, decouple_loss:0.0408465601503849
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486750662326813, gen p mean: -0.21525102853775024, mean p set: 0.44915536046028137
The modified gen p mean: 0.4491044580936432, gen p mean: -0.21542373299598694, mean p set: 0.4495847821235657
loss_pred:0.05205642431974411, decouple_loss:0.04084884747862816
loss_pred:0.05007965862751007, decouple_loss:0.039672281593084335
The modified gen p mean: 0.4489491581916809, gen p mean: -0.21047711372375488, mean p set: 0.4494294226169586
loss_pred:0.05237763375043869, decouple_loss:0.04057544842362404
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948768615722656, gen p mean: -0.21896666288375854, mean p set: 0.44996798038482666
The modified gen p mean: 0.44943660497665405, gen p mean: -0.21192963421344757, mean p set: 0.44991692900657654
loss_pred:0.051454927772283554, decouple_loss:0.0383254736661911
loss_pred:0.05469279736280441, decouple_loss:0.03841318562626839
The modified gen p mean: 0.4495446979999542, gen p mean: -0.21102167665958405, mean p set: 0.45002496242523193
loss_pred:0.05131395533680916, decouple_loss:0.03834737464785576
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487400949001312, gen p mean: -0.20333606004714966, mean p set: 0.4492203891277313
The modified gen p mean: 0.4500197470188141, gen p mean: -0.19881294667720795, mean p set: 0.4505000710487366
loss_pred:0.04905962198972702, decouple_loss:0.041167132556438446
loss_pred:0.05104228854179382, decouple_loss:0.04019666463136673
The modified gen p mean: 0.4487094581127167, gen p mean: -0.20197640359401703, mean p set: 0.4491897523403168
loss_pred:0.05088372156023979, decouple_loss:0.03980480507016182
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469609260559082, gen p mean: -0.2006102353334427, mean p set: 0.4474412202835083
The modified gen p mean: 0.4475889801979065, gen p mean: -0.2012588381767273, mean p set: 0.4480692446231842
loss_pred:0.05066587030887604, decouple_loss:0.04023059085011482
loss_pred:0.05067410320043564, decouple_loss:0.03977465629577637
The modified gen p mean: 0.4503835141658783, gen p mean: -0.19724604487419128, mean p set: 0.4508638381958008
loss_pred:0.04915396124124527, decouple_loss:0.03871674835681915
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447001188993454, gen p mean: -0.19800463318824768, mean p set: 0.4474814832210541
The modified gen p mean: 0.4490108788013458, gen p mean: -0.1989535540342331, mean p set: 0.44949114322662354
loss_pred:0.05008646473288536, decouple_loss:0.03975248709321022
loss_pred:0.05057913437485695, decouple_loss:0.03806762024760246
The modified gen p mean: 0.44789645075798035, gen p mean: -0.1954866647720337, mean p set: 0.44837674498558044
loss_pred:0.0489661805331707, decouple_loss:0.03797907382249832
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495875835418701, gen p mean: -0.20560874044895172, mean p set: 0.4500678777694702
loss_pred:0.05013865604996681, decouple_loss:0.037349388003349304
The modified gen p mean: 0.44938158988952637, gen p mean: -0.20574429631233215, mean p set: 0.4498618543148041The modified gen p mean: 0.4501849114894867, gen p mean: -0.20617888867855072, mean p set: 0.4506652057170868
loss_pred:0.049004171043634415, decouple_loss:0.03768749535083771
loss_pred:0.048567160964012146, decouple_loss:0.03780635818839073
2023-05-01 16:31:32 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.2161896824836731, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.21535851061344147, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.21375617384910583, mean p set: 0.45035696029663086
loss_pred:0.050965603440999985, decouple_loss:0.04104312136769295
loss_pred:0.04967549070715904, decouple_loss:0.03937447443604469loss_pred:0.048461370170116425, decouple_loss:0.04019060358405113
WV_0_PC_1_EH_0_PS_40_5, loss: 0.051710955798625946, avg_mse: 0.05194118246436119
current test mse: 0.051941
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899827241897583, gen p mean: -0.21414726972579956, mean p set: 0.4494785666465759
loss_pred:0.052317533642053604, decouple_loss:0.036444664001464844
The modified gen p mean: 0.44962507486343384, gen p mean: -0.2133614718914032, mean p set: 0.45010536909103394
The modified gen p mean: 0.44869571924209595, gen p mean: -0.20956765115261078, mean p set: 0.44917601346969604
loss_pred:0.052241016179323196, decouple_loss:0.037762533873319626
loss_pred:0.052556175738573074, decouple_loss:0.03741629421710968
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485195279121399, gen p mean: -0.21820345520973206, mean p set: 0.4489997923374176
loss_pred:0.0506293848156929, decouple_loss:0.03608882054686546
The modified gen p mean: 0.4494367837905884, gen p mean: -0.21254494786262512, mean p set: 0.4499170780181885The modified gen p mean: 0.44958382844924927, gen p mean: -0.20794619619846344, mean p set: 0.45006415247917175
loss_pred:0.053258318454027176, decouple_loss:0.037857670336961746
loss_pred:0.048370443284511566, decouple_loss:0.03602735698223114
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856560230255127, gen p mean: -0.20773817598819733, mean p set: 0.44904592633247375
loss_pred:0.05125036463141441, decouple_loss:0.03805885463953018
The modified gen p mean: 0.44840848445892334, gen p mean: -0.21501536667346954, mean p set: 0.44888877868652344The modified gen p mean: 0.4507370591163635, gen p mean: -0.21576006710529327, mean p set: 0.451217383146286
loss_pred:0.04888297989964485, decouple_loss:0.03618365898728371
loss_pred:0.04913252219557762, decouple_loss:0.03933834657073021
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44989821314811707, gen p mean: -0.20675106346607208, mean p set: 0.45037850737571716
loss_pred:0.0500887855887413, decouple_loss:0.037706054747104645
The modified gen p mean: 0.4476543366909027, gen p mean: -0.20926405489444733, mean p set: 0.4481346309185028The modified gen p mean: 0.45017313957214355, gen p mean: -0.21472710371017456, mean p set: 0.45065340399742126
loss_pred:0.05186602845788002, decouple_loss:0.03696852922439575
loss_pred:0.04851754754781723, decouple_loss:0.038898345082998276
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479981064796448, gen p mean: -0.21842904388904572, mean p set: 0.44847843050956726
loss_pred:0.04966577887535095, decouple_loss:0.037051860243082047
The modified gen p mean: 0.4491068422794342, gen p mean: -0.21242332458496094, mean p set: 0.4495871365070343The modified gen p mean: 0.447456419467926, gen p mean: -0.213551864027977, mean p set: 0.4479367434978485
loss_pred:0.0511690191924572, decouple_loss:0.037703998386859894
loss_pred:0.04859490692615509, decouple_loss:0.0379677452147007
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484270215034485, gen p mean: -0.22291316092014313, mean p set: 0.4489073157310486
The modified gen p mean: 0.44905567169189453, gen p mean: -0.2174004465341568, mean p set: 0.44953596591949463
loss_pred:0.05085060000419617, decouple_loss:0.03723743557929993
loss_pred:0.04984695464372635, decouple_loss:0.03817250579595566
The modified gen p mean: 0.4490993618965149, gen p mean: -0.2148793339729309, mean p set: 0.449579656124115
loss_pred:0.05059542506933212, decouple_loss:0.037776608020067215
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482823312282562, gen p mean: -0.2242480218410492, mean p set: 0.4487626254558563
The modified gen p mean: 0.4475134611129761, gen p mean: -0.2240094393491745, mean p set: 0.4479937255382538
loss_pred:0.048387136310338974, decouple_loss:0.03628935664892197
loss_pred:0.04873398318886757, decouple_loss:0.036230869591236115
The modified gen p mean: 0.44922003149986267, gen p mean: -0.2190602570772171, mean p set: 0.44970032572746277
loss_pred:0.04877427592873573, decouple_loss:0.03732448071241379
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487517476081848, gen p mean: -0.22086752951145172, mean p set: 0.4492320418357849
loss_pred:0.04931197687983513, decouple_loss:0.03683280199766159
The modified gen p mean: 0.44697052240371704, gen p mean: -0.22027529776096344, mean p set: 0.44745081663131714The modified gen p mean: 0.4474480152130127, gen p mean: -0.21676082909107208, mean p set: 0.4479283094406128
loss_pred:0.04922792688012123, decouple_loss:0.03601427003741264
loss_pred:0.04878899082541466, decouple_loss:0.037232473492622375
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754984974861145, gen p mean: -0.20617307722568512, mean p set: 0.44803011417388916
loss_pred:0.05149778351187706, decouple_loss:0.03949388861656189
The modified gen p mean: 0.44729548692703247, gen p mean: -0.2144767791032791, mean p set: 0.44777578115463257The modified gen p mean: 0.4470890462398529, gen p mean: -0.2172357141971588, mean p set: 0.447569340467453
loss_pred:0.047726910561323166, decouple_loss:0.039551615715026855
loss_pred:0.04911712929606438, decouple_loss:0.040960174053907394
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732069969177246, gen p mean: -0.2137788087129593, mean p set: 0.44780099391937256
The modified gen p mean: 0.4463948905467987, gen p mean: -0.21159577369689941, mean p set: 0.4468752145767212
loss_pred:0.04665369167923927, decouple_loss:0.039744794368743896
loss_pred:0.04673672094941139, decouple_loss:0.03844239190220833
The modified gen p mean: 0.44760647416114807, gen p mean: -0.21279706060886383, mean p set: 0.44808676838874817
loss_pred:0.04727630689740181, decouple_loss:0.039519596844911575
2023-05-01 16:34:18 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.21372398734092712, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.20910650491714478, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.20974628627300262, mean p set: 0.4500633478164673
loss_pred:0.04817966744303703, decouple_loss:0.03899551182985306
loss_pred:0.050581760704517365, decouple_loss:0.03935078904032707
loss_pred:0.04931030794978142, decouple_loss:0.038669247180223465
WV_0_PC_1_EH_0_PS_40_5, loss: 0.05130750685930252, avg_mse: 0.051827311515808105
current test mse: 0.051827
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461573660373688, gen p mean: -0.2122170776128769, mean p set: 0.44663766026496887
The modified gen p mean: 0.44671186804771423, gen p mean: -0.21429619193077087, mean p set: 0.44719216227531433
loss_pred:0.047610748559236526, decouple_loss:0.03957458585500717
The modified gen p mean: 0.4475298523902893, gen p mean: -0.20854434370994568, mean p set: 0.4480101466178894
loss_pred:0.04667263478040695, decouple_loss:0.037517476826906204
loss_pred:0.04730204865336418, decouple_loss:0.0397176519036293
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446159690618515, gen p mean: -0.20932619273662567, mean p set: 0.4466399550437927
The modified gen p mean: 0.4463563859462738, gen p mean: -0.21037018299102783, mean p set: 0.4468367099761963
loss_pred:0.04740700498223305, decouple_loss:0.03813357651233673
loss_pred:0.04813506454229355, decouple_loss:0.03721233829855919
The modified gen p mean: 0.4469947814941406, gen p mean: -0.21640077233314514, mean p set: 0.4474751055240631
loss_pred:0.046950649470090866, decouple_loss:0.037162989377975464
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472357928752899, gen p mean: -0.21037991344928741, mean p set: 0.4477160573005676
The modified gen p mean: 0.4473946988582611, gen p mean: -0.20905591547489166, mean p set: 0.4478749930858612
loss_pred:0.04761765897274017, decouple_loss:0.03907478228211403
loss_pred:0.047833871096372604, decouple_loss:0.039642829447984695
The modified gen p mean: 0.4470658600330353, gen p mean: -0.20420245826244354, mean p set: 0.447546124458313
loss_pred:0.049864087253808975, decouple_loss:0.03940557315945625
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472377598285675, gen p mean: -0.21455414593219757, mean p set: 0.4477180242538452
loss_pred:0.04966995492577553, decouple_loss:0.03953208029270172
The modified gen p mean: 0.4462231397628784, gen p mean: -0.2223469465970993, mean p set: 0.44670340418815613The modified gen p mean: 0.44653427600860596, gen p mean: -0.2198805809020996, mean p set: 0.44701457023620605
loss_pred:0.046979326754808426, decouple_loss:0.03851666301488876
loss_pred:0.04780245199799538, decouple_loss:0.03935595601797104
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661179184913635, gen p mean: -0.2253015786409378, mean p set: 0.44709208607673645
The modified gen p mean: 0.44848689436912537, gen p mean: -0.22643117606639862, mean p set: 0.44896718859672546
loss_pred:0.0489305816590786, decouple_loss:0.03805917501449585
loss_pred:0.0493389368057251, decouple_loss:0.04076223820447922
The modified gen p mean: 0.4471486806869507, gen p mean: -0.21815474331378937, mean p set: 0.44762900471687317
loss_pred:0.04727216809988022, decouple_loss:0.03869263455271721
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471409320831299, gen p mean: -0.21421311795711517, mean p set: 0.44762122631073
The modified gen p mean: 0.44558024406433105, gen p mean: -0.22082598507404327, mean p set: 0.44606053829193115
loss_pred:0.047564953565597534, decouple_loss:0.038744330406188965
loss_pred:0.04569978266954422, decouple_loss:0.03768136724829674The modified gen p mean: 0.44717586040496826, gen p mean: -0.21741017699241638, mean p set: 0.44765612483024597
loss_pred:0.046809837222099304, decouple_loss:0.03800734505057335
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472602307796478, gen p mean: -0.21613048017024994, mean p set: 0.4477405250072479
The modified gen p mean: 0.4469406008720398, gen p mean: -0.22213634848594666, mean p set: 0.4474208950996399loss_pred:0.047737967222929, decouple_loss:0.04035421460866928
The modified gen p mean: 0.44758978486061096, gen p mean: -0.21229714155197144, mean p set: 0.44807007908821106
loss_pred:0.047587111592292786, decouple_loss:0.03941173851490021
loss_pred:0.04657406359910965, decouple_loss:0.039267975836992264
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694966077804565, gen p mean: -0.20837655663490295, mean p set: 0.44742998480796814
The modified gen p mean: 0.447578489780426, gen p mean: -0.2132081538438797, mean p set: 0.44805875420570374
loss_pred:0.04971395060420036, decouple_loss:0.03700084611773491
The modified gen p mean: 0.44698771834373474, gen p mean: -0.21984992921352386, mean p set: 0.44746798276901245
loss_pred:0.04797304421663284, decouple_loss:0.03898458927869797
loss_pred:0.04663834720849991, decouple_loss:0.03697163611650467
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474044740200043, gen p mean: -0.22306641936302185, mean p set: 0.44788476824760437
The modified gen p mean: 0.4480491578578949, gen p mean: -0.2151654213666916, mean p set: 0.4485294818878174
loss_pred:0.04578069597482681, decouple_loss:0.03915472701191902
The modified gen p mean: 0.44739392399787903, gen p mean: -0.21653594076633453, mean p set: 0.4478742182254791
loss_pred:0.04931386932730675, decouple_loss:0.039186228066682816
loss_pred:0.050469789654016495, decouple_loss:0.0391475148499012
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484092891216278, gen p mean: -0.21965646743774414, mean p set: 0.4488895833492279
The modified gen p mean: 0.4484701454639435, gen p mean: -0.21675729751586914, mean p set: 0.4489504396915436
loss_pred:0.049476876854896545, decouple_loss:0.040991753339767456
loss_pred:0.04749288409948349, decouple_loss:0.03826792165637016
The modified gen p mean: 0.4474177360534668, gen p mean: -0.21607621014118195, mean p set: 0.4478980302810669
loss_pred:0.04675557091832161, decouple_loss:0.03804093971848488
2023-05-01 16:36:26 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.2219029814004898, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.21678495407104492, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.21574284136295319, mean p set: 0.45035696029663086
loss_pred:0.04996258765459061, decouple_loss:0.0388147234916687
loss_pred:0.048358749598264694, decouple_loss:0.037184808403253555
loss_pred:0.0470120944082737, decouple_loss:0.038368333131074905
WV_0_PC_1_EH_0_PS_40_5, loss: 0.0503506064414978, avg_mse: 0.05071837827563286
current test mse: 0.050718
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786348938941956, gen p mean: -0.21355502307415009, mean p set: 0.44834375381469727
loss_pred:0.04965351149439812, decouple_loss:0.03804156556725502
The modified gen p mean: 0.4476805627346039, gen p mean: -0.2196016013622284, mean p set: 0.448160856962204The modified gen p mean: 0.44905388355255127, gen p mean: -0.21919499337673187, mean p set: 0.44953420758247375
loss_pred:0.047738514840602875, decouple_loss:0.037738047540187836
loss_pred:0.04849773645401001, decouple_loss:0.04121558740735054
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478931128978729, gen p mean: -0.22275130450725555, mean p set: 0.448373407125473
The modified gen p mean: 0.44731464982032776, gen p mean: -0.21908143162727356, mean p set: 0.44779494404792786
loss_pred:0.048827026039361954, decouple_loss:0.038434501737356186
loss_pred:0.047166645526885986, decouple_loss:0.03638291731476784
The modified gen p mean: 0.44595327973365784, gen p mean: -0.22044134140014648, mean p set: 0.4464336037635803
loss_pred:0.04643970727920532, decouple_loss:0.03633761778473854
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675564765930176, gen p mean: -0.227864608168602, mean p set: 0.44723597168922424
loss_pred:0.04704589769244194, decouple_loss:0.03695276007056236
The modified gen p mean: 0.4494279623031616, gen p mean: -0.23156483471393585, mean p set: 0.44990822672843933The modified gen p mean: 0.4464568793773651, gen p mean: -0.2246067374944687, mean p set: 0.4469371736049652
loss_pred:0.046304862946271896, decouple_loss:0.03715803846716881
loss_pred:0.048056721687316895, decouple_loss:0.04069294407963753
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694894552230835, gen p mean: -0.23038524389266968, mean p set: 0.44742920994758606
The modified gen p mean: 0.4477144181728363, gen p mean: -0.2268640398979187, mean p set: 0.4481947124004364loss_pred:0.04722413048148155, decouple_loss:0.03838132321834564
The modified gen p mean: 0.4473946690559387, gen p mean: -0.2319587618112564, mean p set: 0.4478749632835388
loss_pred:0.04731263220310211, decouple_loss:0.037315499037504196
loss_pred:0.046223822981119156, decouple_loss:0.03844807669520378
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476718306541443, gen p mean: -0.23210851848125458, mean p set: 0.448152095079422
loss_pred:0.046125151216983795, decouple_loss:0.037358351051807404
The modified gen p mean: 0.44735077023506165, gen p mean: -0.2271365076303482, mean p set: 0.44783106446266174The modified gen p mean: 0.44772329926490784, gen p mean: -0.2308298647403717, mean p set: 0.44820359349250793
loss_pred:0.046552032232284546, decouple_loss:0.03689024969935417
loss_pred:0.047706104815006256, decouple_loss:0.038268789649009705
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471362829208374, gen p mean: -0.2343025803565979, mean p set: 0.4476166069507599
loss_pred:0.046747397631406784, decouple_loss:0.03802959993481636
The modified gen p mean: 0.4472832679748535, gen p mean: -0.22933854162693024, mean p set: 0.4477635622024536The modified gen p mean: 0.44681090116500854, gen p mean: -0.23523736000061035, mean p set: 0.44729119539260864
loss_pred:0.04721278324723244, decouple_loss:0.037425342947244644
loss_pred:0.04666391760110855, decouple_loss:0.037938084453344345
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456823468208313, gen p mean: -0.23375478386878967, mean p set: 0.4461626410484314
loss_pred:0.04504333436489105, decouple_loss:0.0388459712266922
The modified gen p mean: 0.446189284324646, gen p mean: -0.22981444001197815, mean p set: 0.4466695487499237The modified gen p mean: 0.44721198081970215, gen p mean: -0.23263278603553772, mean p set: 0.44769227504730225
loss_pred:0.04729275405406952, decouple_loss:0.03674880415201187
loss_pred:0.04614672437310219, decouple_loss:0.03970722481608391
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772690534591675, gen p mean: -0.22354285418987274, mean p set: 0.44820722937583923
The modified gen p mean: 0.4465195834636688, gen p mean: -0.2267731875181198, mean p set: 0.44699984788894653
loss_pred:0.04843864589929581, decouple_loss:0.036704178899526596
loss_pred:0.046266697347164154, decouple_loss:0.03594851866364479
The modified gen p mean: 0.4470345973968506, gen p mean: -0.22852227091789246, mean p set: 0.4475148916244507
loss_pred:0.046391990035772324, decouple_loss:0.036127153784036636
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
NaN value num: 0
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510818123817444, gen p mean: -0.22461257874965668, mean p set: 0.45156213641166687
loss_pred:0.0497891791164875, decouple_loss:0.041442569345235825
The modified gen p mean: 0.44976598024368286, gen p mean: -0.21954628825187683, mean p set: 0.45024624466896057The modified gen p mean: 0.4490277171134949, gen p mean: -0.21913699805736542, mean p set: 0.4495079815387726
loss_pred:0.04868847504258156, decouple_loss:0.03720712289214134
loss_pred:0.04881245642900467, decouple_loss:0.040635593235492706
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485863745212555, gen p mean: -0.22590118646621704, mean p set: 0.4490666687488556
The modified gen p mean: 0.4497821629047394, gen p mean: -0.22862251102924347, mean p set: 0.45026248693466187
loss_pred:0.04852328076958656, decouple_loss:0.03861936554312706
loss_pred:0.04968925938010216, decouple_loss:0.03905709832906723
The modified gen p mean: 0.4504455626010895, gen p mean: -0.22426868975162506, mean p set: 0.4509258568286896
loss_pred:0.04926515743136406, decouple_loss:0.041759368032217026
2023-05-01 16:39:07 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.23034687340259552, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.22305837273597717, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.22439998388290405, mean p set: 0.4500633478164673
loss_pred:0.04934515058994293, decouple_loss:0.039163004606962204
loss_pred:0.046854499727487564, decouple_loss:0.03888021409511566
loss_pred:0.04794558137655258, decouple_loss:0.03737599402666092
WV_0_PC_1_EH_0_PS_40_5, loss: 0.04997206851840019, avg_mse: 0.05043067783117294
current test mse: 0.050431
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513724744319916, gen p mean: -0.22606121003627777, mean p set: 0.4518527686595917
The modified gen p mean: 0.4493010938167572, gen p mean: -0.2212524712085724, mean p set: 0.4497814178466797
loss_pred:0.04850630462169647, decouple_loss:0.03786025941371918
The modified gen p mean: 0.45092499256134033, gen p mean: -0.22387449443340302, mean p set: 0.45140528678894043
loss_pred:0.046710506081581116, decouple_loss:0.04075392335653305
loss_pred:0.04712366685271263, decouple_loss:0.04082886129617691
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863754510879517, gen p mean: -0.2350100576877594, mean p set: 0.44911783933639526
The modified gen p mean: 0.45181918144226074, gen p mean: -0.2342510223388672, mean p set: 0.4522995054721832
loss_pred:0.04726090654730797, decouple_loss:0.04072360694408417
loss_pred:0.0469994843006134, decouple_loss:0.039771366864442825
The modified gen p mean: 0.4505431652069092, gen p mean: -0.23061853647232056, mean p set: 0.4510234594345093
loss_pred:0.049397729337215424, decouple_loss:0.04182904213666916
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500461518764496, gen p mean: -0.24403129518032074, mean p set: 0.4505264163017273
The modified gen p mean: 0.4490024149417877, gen p mean: -0.2439705729484558, mean p set: 0.4494827091693878
loss_pred:0.04587817192077637, decouple_loss:0.040742844343185425
loss_pred:0.04810187965631485, decouple_loss:0.038950201123952866
The modified gen p mean: 0.4478793740272522, gen p mean: -0.2394304871559143, mean p set: 0.4483596682548523
loss_pred:0.047609806060791016, decouple_loss:0.04179280251264572
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45140236616134644, gen p mean: -0.24666623771190643, mean p set: 0.4518826901912689
The modified gen p mean: 0.44982659816741943, gen p mean: -0.24020947515964508, mean p set: 0.45030689239501953
loss_pred:0.04839777573943138, decouple_loss:0.038583092391490936
loss_pred:0.045366063714027405, decouple_loss:0.03762141987681389
The modified gen p mean: 0.4517676532268524, gen p mean: -0.2482067346572876, mean p set: 0.4522479474544525
loss_pred:0.047067999839782715, decouple_loss:0.03843091428279877
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477841854095459, gen p mean: -0.237698033452034, mean p set: 0.4482645094394684
loss_pred:0.04713762551546097, decouple_loss:0.040570348501205444
The modified gen p mean: 0.4500269293785095, gen p mean: -0.23683510720729828, mean p set: 0.4505072236061096The modified gen p mean: 0.4502885043621063, gen p mean: -0.23834726214408875, mean p set: 0.4507688283920288
loss_pred:0.0454748310148716, decouple_loss:0.037979353219270706
loss_pred:0.0475761778652668, decouple_loss:0.03969684988260269
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141148567199707, gen p mean: -0.24229253828525543, mean p set: 0.4518917500972748
The modified gen p mean: 0.4504621624946594, gen p mean: -0.23985451459884644, mean p set: 0.4509424567222595
loss_pred:0.04591405391693115, decouple_loss:0.03941365331411362
loss_pred:0.046473074704408646, decouple_loss:0.040499065071344376
The modified gen p mean: 0.44893309473991394, gen p mean: -0.24311475455760956, mean p set: 0.44941338896751404
loss_pred:0.04660671949386597, decouple_loss:0.040571194142103195
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503028392791748, gen p mean: -0.2417038530111313, mean p set: 0.4507831633090973
The modified gen p mean: 0.45104700326919556, gen p mean: -0.24616792798042297, mean p set: 0.45152729749679565
loss_pred:0.046735845506191254, decouple_loss:0.03943328559398651
loss_pred:0.04644310101866722, decouple_loss:0.039924412965774536
The modified gen p mean: 0.4500935971736908, gen p mean: -0.2463226467370987, mean p set: 0.4505738615989685
loss_pred:0.04732624813914299, decouple_loss:0.039125554263591766
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969335198402405, gen p mean: -0.23860810697078705, mean p set: 0.45017367601394653
The modified gen p mean: 0.45199522376060486, gen p mean: -0.2422354370355606, mean p set: 0.45247551798820496
loss_pred:0.047421082854270935, decouple_loss:0.04070891812443733
loss_pred:0.04567446559667587, decouple_loss:0.03914232179522514
The modified gen p mean: 0.448527067899704, gen p mean: -0.23751384019851685, mean p set: 0.44900739192962646
loss_pred:0.046875908970832825, decouple_loss:0.03851933404803276
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499203860759735, gen p mean: -0.2332168072462082, mean p set: 0.4504006803035736
The modified gen p mean: 0.4513234794139862, gen p mean: -0.23819464445114136, mean p set: 0.4518038034439087
loss_pred:0.04640769213438034, decouple_loss:0.03756587207317352
loss_pred:0.0447700098156929, decouple_loss:0.037924572825431824
The modified gen p mean: 0.44910693168640137, gen p mean: -0.23183795809745789, mean p set: 0.44958722591400146
loss_pred:0.046675436198711395, decouple_loss:0.0389707051217556
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949978590011597, gen p mean: -0.23655052483081818, mean p set: 0.4499800503253937
The modified gen p mean: 0.4514055550098419, gen p mean: -0.24026384949684143, mean p set: 0.451885849237442
loss_pred:0.04701057821512222, decouple_loss:0.037133410573005676
loss_pred:0.04692477360367775, decouple_loss:0.03619029000401497The modified gen p mean: 0.44904351234436035, gen p mean: -0.2403969019651413, mean p set: 0.44952380657196045
loss_pred:0.045557212084531784, decouple_loss:0.03768891468644142
2023-05-01 16:41:14 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.2482161968946457, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.24199466407299042, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.2441762238740921, mean p set: 0.4500633478164673
loss_pred:0.0489368662238121, decouple_loss:0.04147030785679817
loss_pred:0.046534787863492966, decouple_loss:0.041792966425418854loss_pred:0.04768086224794388, decouple_loss:0.04026506841182709
WV_0_PC_1_EH_0_PS_40_5, loss: 0.049776311963796616, avg_mse: 0.05015522614121437
current test mse: 0.050155
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975748658180237, gen p mean: -0.24691830575466156, mean p set: 0.45023781061172485
loss_pred:0.047868214547634125, decouple_loss:0.037798941135406494
The modified gen p mean: 0.4501246511936188, gen p mean: -0.23873725533485413, mean p set: 0.45060494542121887The modified gen p mean: 0.45145851373672485, gen p mean: -0.25078946352005005, mean p set: 0.45193883776664734
loss_pred:0.04577311873435974, decouple_loss:0.03854052722454071
loss_pred:0.048335809260606766, decouple_loss:0.03838525712490082
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528353810310364, gen p mean: -0.23942938446998596, mean p set: 0.4533156752586365
loss_pred:0.04766013100743294, decouple_loss:0.03867118060588837
The modified gen p mean: 0.4500126242637634, gen p mean: -0.25039952993392944, mean p set: 0.4504929184913635The modified gen p mean: 0.44915926456451416, gen p mean: -0.24410541355609894, mean p set: 0.44963955879211426
loss_pred:0.04721761494874954, decouple_loss:0.03825606405735016
loss_pred:0.046140704303979874, decouple_loss:0.03949251398444176
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497230648994446, gen p mean: -0.23940452933311462, mean p set: 0.4502033293247223
The modified gen p mean: 0.44860783219337463, gen p mean: -0.24895629286766052, mean p set: 0.44908812642097473
loss_pred:0.046713750809431076, decouple_loss:0.037963394075632095
The modified gen p mean: 0.4505285620689392, gen p mean: -0.2392653077840805, mean p set: 0.4510088264942169
loss_pred:0.04521423205733299, decouple_loss:0.037107013165950775
loss_pred:0.044359881430864334, decouple_loss:0.03676803782582283
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501555562019348, gen p mean: -0.2425272911787033, mean p set: 0.4506358802318573
The modified gen p mean: 0.4485812485218048, gen p mean: -0.2377733737230301, mean p set: 0.4490615427494049
loss_pred:0.04678468778729439, decouple_loss:0.0366814024746418
loss_pred:0.04729487746953964, decouple_loss:0.03842078894376755
The modified gen p mean: 0.4514411985874176, gen p mean: -0.24068625271320343, mean p set: 0.4519214332103729
loss_pred:0.043965697288513184, decouple_loss:0.03708420321345329
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489016532897949, gen p mean: -0.24757108092308044, mean p set: 0.449381947517395
The modified gen p mean: 0.4476179778575897, gen p mean: -0.2539891302585602, mean p set: 0.44809824228286743
loss_pred:0.046495407819747925, decouple_loss:0.03719789907336235
loss_pred:0.04416633024811745, decouple_loss:0.03576909378170967
The modified gen p mean: 0.44937124848365784, gen p mean: -0.24755579233169556, mean p set: 0.4498515725135803
loss_pred:0.04637812823057175, decouple_loss:0.037608642131090164
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490102529525757, gen p mean: -0.25094354152679443, mean p set: 0.4494905471801758
loss_pred:0.046365365386009216, decouple_loss:0.03874719515442848
The modified gen p mean: 0.44928374886512756, gen p mean: -0.25771600008010864, mean p set: 0.44976404309272766The modified gen p mean: 0.44945916533470154, gen p mean: -0.25879865884780884, mean p set: 0.44993945956230164
loss_pred:0.04576755315065384, decouple_loss:0.036530885845422745
loss_pred:0.045538872480392456, decouple_loss:0.036179617047309875
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017823576927185, gen p mean: -0.2498001903295517, mean p set: 0.45065850019454956
The modified gen p mean: 0.44997966289520264, gen p mean: -0.25086259841918945, mean p set: 0.45045995712280273
loss_pred:0.04451697692275047, decouple_loss:0.0375269278883934
loss_pred:0.04461066424846649, decouple_loss:0.03810413181781769
The modified gen p mean: 0.45216304063796997, gen p mean: -0.2474486529827118, mean p set: 0.45264333486557007
loss_pred:0.04539220407605171, decouple_loss:0.03809494525194168
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45248979330062866, gen p mean: -0.24916063249111176, mean p set: 0.45297008752822876
The modified gen p mean: 0.4521656036376953, gen p mean: -0.24955475330352783, mean p set: 0.4526459276676178
loss_pred:0.04462546482682228, decouple_loss:0.03721329942345619
loss_pred:0.04477497562766075, decouple_loss:0.037320952862501144
The modified gen p mean: 0.45227617025375366, gen p mean: -0.24402064085006714, mean p set: 0.45275649428367615
loss_pred:0.045277465134859085, decouple_loss:0.03839629888534546
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
NaN value num: 0
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521706998348236, gen p mean: -0.25362929701805115, mean p set: 0.4526509940624237
loss_pred:0.048943135887384415, decouple_loss:0.040637921541929245
The modified gen p mean: 0.44973817467689514, gen p mean: -0.2586475908756256, mean p set: 0.4502184987068176The modified gen p mean: 0.45017921924591064, gen p mean: -0.25691962242126465, mean p set: 0.45065951347351074
loss_pred:0.046296507120132446, decouple_loss:0.04249818995594978
loss_pred:0.047972287982702255, decouple_loss:0.04179178550839424
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45075225830078125, gen p mean: -0.25305166840553284, mean p set: 0.45123252272605896
The modified gen p mean: 0.4502878487110138, gen p mean: -0.25609302520751953, mean p set: 0.4507681429386139
loss_pred:0.04729245603084564, decouple_loss:0.04359612986445427
loss_pred:0.046820346266031265, decouple_loss:0.04155462980270386
The modified gen p mean: 0.4499695599079132, gen p mean: -0.2574208676815033, mean p set: 0.4504498541355133
loss_pred:0.047498174011707306, decouple_loss:0.04272652417421341
2023-05-01 16:44:09 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.2625040113925934, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.25715306401252747, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.25428155064582825, mean p set: 0.45035696029663086
loss_pred:0.04848981648683548, decouple_loss:0.04030027240514755
loss_pred:0.04721197485923767, decouple_loss:0.0393095538020134
loss_pred:0.0464605838060379, decouple_loss:0.04098266363143921
WV_0_PC_1_EH_0_PS_40_5, loss: 0.04939733445644379, avg_mse: 0.04993218928575516
current test mse: 0.049932
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449016273021698, gen p mean: -0.251611590385437, mean p set: 0.4494965374469757
The modified gen p mean: 0.45085054636001587, gen p mean: -0.25240060687065125, mean p set: 0.45133084058761597
loss_pred:0.04692228138446808, decouple_loss:0.040575046092271805
The modified gen p mean: 0.45027199387550354, gen p mean: -0.254597544670105, mean p set: 0.450752317905426
loss_pred:0.047972019761800766, decouple_loss:0.0406956672668457
loss_pred:0.045392751693725586, decouple_loss:0.04031403735280037
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510863423347473, gen p mean: -0.2554919719696045, mean p set: 0.451566606760025
The modified gen p mean: 0.45089730620384216, gen p mean: -0.2611379325389862, mean p set: 0.4513775408267975
loss_pred:0.04837043583393097, decouple_loss:0.03938498720526695
loss_pred:0.04552707448601723, decouple_loss:0.03932242467999458
The modified gen p mean: 0.4499717652797699, gen p mean: -0.2577185332775116, mean p set: 0.45045205950737
loss_pred:0.046343401074409485, decouple_loss:0.0405159629881382
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502183198928833, gen p mean: -0.26166683435440063, mean p set: 0.4506986141204834
The modified gen p mean: 0.45037972927093506, gen p mean: -0.2601861357688904, mean p set: 0.45086002349853516
loss_pred:0.04730549454689026, decouple_loss:0.03968578204512596
loss_pred:0.04750676825642586, decouple_loss:0.03941407427191734
The modified gen p mean: 0.4505920112133026, gen p mean: -0.2637585401535034, mean p set: 0.4510722756385803
loss_pred:0.04693438112735748, decouple_loss:0.041505228728055954
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059311389923096, gen p mean: -0.2553252577781677, mean p set: 0.45107343792915344
The modified gen p mean: 0.4501606523990631, gen p mean: -0.2535059452056885, mean p set: 0.4506409764289856
loss_pred:0.04663951322436333, decouple_loss:0.04036227986216545
loss_pred:0.04635469987988472, decouple_loss:0.0421174056828022
The modified gen p mean: 0.45066073536872864, gen p mean: -0.2537393569946289, mean p set: 0.45114099979400635
loss_pred:0.04514644667506218, decouple_loss:0.041283395141363144
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068255066871643, gen p mean: -0.2613299787044525, mean p set: 0.45116284489631653
The modified gen p mean: 0.4526808559894562, gen p mean: -0.25536900758743286, mean p set: 0.4531611502170563
loss_pred:0.046668458729982376, decouple_loss:0.040127430111169815
loss_pred:0.047295451164245605, decouple_loss:0.04202285036444664
The modified gen p mean: 0.4520878493785858, gen p mean: -0.2611079216003418, mean p set: 0.4525681734085083
loss_pred:0.04584363475441933, decouple_loss:0.04147544875741005
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959020614624023, gen p mean: -0.27348124980926514, mean p set: 0.4500705301761627
The modified gen p mean: 0.45046618580818176, gen p mean: -0.271395206451416, mean p set: 0.4509464502334595
loss_pred:0.04541904851794243, decouple_loss:0.04276531934738159
loss_pred:0.04535868763923645, decouple_loss:0.041223276406526566
The modified gen p mean: 0.45147356390953064, gen p mean: -0.26898008584976196, mean p set: 0.45195385813713074
loss_pred:0.044210225343704224, decouple_loss:0.04201711714267731
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504055976867676, gen p mean: -0.27570730447769165, mean p set: 0.4508858919143677
The modified gen p mean: 0.4518769085407257, gen p mean: -0.270330548286438, mean p set: 0.4523571729660034
loss_pred:0.04507249593734741, decouple_loss:0.040021561086177826
loss_pred:0.04495425522327423, decouple_loss:0.042031705379486084
The modified gen p mean: 0.45253220200538635, gen p mean: -0.2750452160835266, mean p set: 0.45301249623298645
loss_pred:0.04507557302713394, decouple_loss:0.04127370938658714
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506599009037018, gen p mean: -0.2764531672000885, mean p set: 0.4511401653289795
The modified gen p mean: 0.4510114789009094, gen p mean: -0.2763444781303406, mean p set: 0.45149174332618713
loss_pred:0.045791082084178925, decouple_loss:0.03930782899260521
loss_pred:0.04598018527030945, decouple_loss:0.04034791514277458
The modified gen p mean: 0.4501114785671234, gen p mean: -0.2727262079715729, mean p set: 0.4505917727947235
loss_pred:0.04537039250135422, decouple_loss:0.0395364910364151
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093464851379395, gen p mean: -0.2780556380748749, mean p set: 0.45141491293907166
The modified gen p mean: 0.45085400342941284, gen p mean: -0.27033916115760803, mean p set: 0.45133426785469055
loss_pred:0.04497656971216202, decouple_loss:0.0406775139272213
loss_pred:0.04653242975473404, decouple_loss:0.040969524532556534
The modified gen p mean: 0.4519071877002716, gen p mean: -0.2716139554977417, mean p set: 0.4523874819278717
loss_pred:0.0446663498878479, decouple_loss:0.04127725586295128
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521578848361969, gen p mean: -0.27362260222435, mean p set: 0.452638179063797
The modified gen p mean: 0.452505886554718, gen p mean: -0.2763326168060303, mean p set: 0.4529861509799957
loss_pred:0.04675397649407387, decouple_loss:0.039537038654088974loss_pred:0.04536356404423714, decouple_loss:0.041471924632787704
The modified gen p mean: 0.4522593319416046, gen p mean: -0.2784140408039093, mean p set: 0.4527396559715271
loss_pred:0.044473957270383835, decouple_loss:0.03938295692205429
2023-05-01 16:46:16 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.28578078746795654, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.2799743115901947, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.27591946721076965, mean p set: 0.45035696029663086
loss_pred:0.04812689125537872, decouple_loss:0.04365984722971916
loss_pred:0.0466386079788208, decouple_loss:0.0417780876159668
loss_pred:0.045881081372499466, decouple_loss:0.04315878078341484
WV_0_PC_1_EH_0_PS_40_5, loss: 0.04902547225356102, avg_mse: 0.049572426825761795
current test mse: 0.049572
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511641561985016, gen p mean: -0.2733222544193268, mean p set: 0.4516444504261017
loss_pred:0.04779791086912155, decouple_loss:0.039545707404613495
The modified gen p mean: 0.4523758292198181, gen p mean: -0.2758621871471405, mean p set: 0.4528560936450958The modified gen p mean: 0.4535161554813385, gen p mean: -0.28083616495132446, mean p set: 0.453996479511261
loss_pred:0.04525182023644447, decouple_loss:0.04034414887428284
loss_pred:0.045084308832883835, decouple_loss:0.03986101970076561
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123782753944397, gen p mean: -0.276164174079895, mean p set: 0.45171812176704407
The modified gen p mean: 0.44997653365135193, gen p mean: -0.2814278304576874, mean p set: 0.450456827878952
loss_pred:0.047065768390893936, decouple_loss:0.03938071057200432
loss_pred:0.046625688672065735, decouple_loss:0.040117669850587845
The modified gen p mean: 0.45031094551086426, gen p mean: -0.28222230076789856, mean p set: 0.45079126954078674
loss_pred:0.046559613198041916, decouple_loss:0.03994547948241234
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500679075717926, gen p mean: -0.2851828336715698, mean p set: 0.4505482017993927
loss_pred:0.04481275752186775, decouple_loss:0.03835674002766609
The modified gen p mean: 0.45389434695243835, gen p mean: -0.29284560680389404, mean p set: 0.45437467098236084The modified gen p mean: 0.45007598400115967, gen p mean: -0.2874131500720978, mean p set: 0.45055627822875977
loss_pred:0.04392851144075394, decouple_loss:0.03940531983971596
loss_pred:0.04478665441274643, decouple_loss:0.03885294124484062
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522206485271454, gen p mean: -0.29407891631126404, mean p set: 0.4527009129524231
loss_pred:0.043710920959711075, decouple_loss:0.037264347076416016
The modified gen p mean: 0.45057153701782227, gen p mean: -0.2954546809196472, mean p set: 0.45105183124542236The modified gen p mean: 0.45092833042144775, gen p mean: -0.2896895706653595, mean p set: 0.45140859484672546
loss_pred:0.04671317711472511, decouple_loss:0.038587626069784164
loss_pred:0.04757973179221153, decouple_loss:0.038771916180849075
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096904039382935, gen p mean: -0.2856515347957611, mean p set: 0.45144933462142944
The modified gen p mean: 0.4499722421169281, gen p mean: -0.28765177726745605, mean p set: 0.4504525363445282
loss_pred:0.04326978698372841, decouple_loss:0.038095951080322266
loss_pred:0.04492366686463356, decouple_loss:0.037446990609169006
The modified gen p mean: 0.45233258605003357, gen p mean: -0.28600940108299255, mean p set: 0.45281288027763367
loss_pred:0.04793664440512657, decouple_loss:0.038031790405511856
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505867660045624, gen p mean: -0.28563520312309265, mean p set: 0.4510670304298401
The modified gen p mean: 0.4515415132045746, gen p mean: -0.28580978512763977, mean p set: 0.4520217776298523
loss_pred:0.04430138319730759, decouple_loss:0.03729487583041191
loss_pred:0.0442642867565155, decouple_loss:0.03837011009454727
The modified gen p mean: 0.4500938355922699, gen p mean: -0.2867841124534607, mean p set: 0.4505741000175476
loss_pred:0.04547407850623131, decouple_loss:0.03932725638151169
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996288418769836, gen p mean: -0.2800710201263428, mean p set: 0.45044317841529846
loss_pred:0.04441908746957779, decouple_loss:0.03711026906967163
The modified gen p mean: 0.45372727513313293, gen p mean: -0.2854606807231903, mean p set: 0.45420756936073303The modified gen p mean: 0.45030415058135986, gen p mean: -0.2834816873073578, mean p set: 0.45078444480895996
loss_pred:0.045738525688648224, decouple_loss:0.038150399923324585
loss_pred:0.044596701860427856, decouple_loss:0.03902357444167137
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522046744823456, gen p mean: -0.2843064069747925, mean p set: 0.4526849389076233
The modified gen p mean: 0.4508111774921417, gen p mean: -0.28242990374565125, mean p set: 0.4512914717197418
loss_pred:0.04582711681723595, decouple_loss:0.039083853363990784
loss_pred:0.04382314905524254, decouple_loss:0.039122506976127625
The modified gen p mean: 0.45219236612319946, gen p mean: -0.2848416864871979, mean p set: 0.45267269015312195
loss_pred:0.04266555607318878, decouple_loss:0.03831886127591133
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
NaN value num: 0
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839194416999817, gen p mean: -0.2939566969871521, mean p set: 0.4488722085952759
loss_pred:0.045057494193315506, decouple_loss:0.039072394371032715
The modified gen p mean: 0.45000436902046204, gen p mean: -0.2916046977043152, mean p set: 0.45048466324806213The modified gen p mean: 0.449989914894104, gen p mean: -0.28948238492012024, mean p set: 0.4504702091217041
loss_pred:0.046730831265449524, decouple_loss:0.039101630449295044
loss_pred:0.045283593237400055, decouple_loss:0.038441937416791916
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951292872428894, gen p mean: -0.28252899646759033, mean p set: 0.44999319314956665The modified gen p mean: 0.45088979601860046, gen p mean: -0.2867863178253174, mean p set: 0.45137009024620056
loss_pred:0.0451589860022068, decouple_loss:0.03596438094973564loss_pred:0.04325614869594574, decouple_loss:0.03718194738030434
The modified gen p mean: 0.4501005709171295, gen p mean: -0.28138086199760437, mean p set: 0.4505808651447296
loss_pred:0.04376138374209404, decouple_loss:0.03716587647795677
2023-05-01 16:49:05 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.27801671624183655, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2710036635398865, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.2730305790901184, mean p set: 0.4500633478164673
loss_pred:0.047856155782938004, decouple_loss:0.041936371475458145
loss_pred:0.045740339905023575, decouple_loss:0.04085797816514969
loss_pred:0.04681403934955597, decouple_loss:0.03975142538547516
WV_0_PC_1_EH_0_PS_40_5, loss: 0.04884594306349754, avg_mse: 0.049600496888160706
current test mse: 0.0496
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45038244128227234, gen p mean: -0.2752603590488434, mean p set: 0.45086273550987244
The modified gen p mean: 0.4493372142314911, gen p mean: -0.2735123932361603, mean p set: 0.4498175084590912
loss_pred:0.046312425285577774, decouple_loss:0.039113640785217285
The modified gen p mean: 0.44936704635620117, gen p mean: -0.2733894884586334, mean p set: 0.44984734058380127
loss_pred:0.045014385133981705, decouple_loss:0.03836105763912201
loss_pred:0.046045731753110886, decouple_loss:0.03751679137349129
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44946932792663574, gen p mean: -0.2794611155986786, mean p set: 0.44994959235191345
The modified gen p mean: 0.4489796757698059, gen p mean: -0.2810012102127075, mean p set: 0.4494599997997284
loss_pred:0.044529009610414505, decouple_loss:0.0361938402056694
loss_pred:0.04453529417514801, decouple_loss:0.037704337388277054
The modified gen p mean: 0.4485119581222534, gen p mean: -0.2797742486000061, mean p set: 0.44899222254753113
loss_pred:0.042740028351545334, decouple_loss:0.038334913551807404
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501960873603821, gen p mean: -0.29189783334732056, mean p set: 0.4506763517856598
loss_pred:0.04470191150903702, decouple_loss:0.036562252789735794
The modified gen p mean: 0.4494897723197937, gen p mean: -0.28528210520744324, mean p set: 0.4499700367450714The modified gen p mean: 0.448742538690567, gen p mean: -0.28663837909698486, mean p set: 0.4492228329181671
loss_pred:0.04406348615884781, decouple_loss:0.03671715781092644
loss_pred:0.04486073926091194, decouple_loss:0.03762136399745941
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448661208152771, gen p mean: -0.2937636971473694, mean p set: 0.4491414725780487
The modified gen p mean: 0.44935426115989685, gen p mean: -0.2909661829471588, mean p set: 0.44983452558517456
loss_pred:0.043511949479579926, decouple_loss:0.03887224569916725
loss_pred:0.04351576045155525, decouple_loss:0.03750630468130112
The modified gen p mean: 0.4498671889305115, gen p mean: -0.29136815667152405, mean p set: 0.45034751296043396
loss_pred:0.045541997998952866, decouple_loss:0.03837063908576965
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500592052936554, gen p mean: -0.2823965549468994, mean p set: 0.4505395293235779
The modified gen p mean: 0.4504282474517822, gen p mean: -0.2804458439350128, mean p set: 0.4509085714817047
loss_pred:0.046216659247875214, decouple_loss:0.038168538361787796
loss_pred:0.04368986561894417, decouple_loss:0.036945004016160965
The modified gen p mean: 0.4509582817554474, gen p mean: -0.28204259276390076, mean p set: 0.4514385461807251
loss_pred:0.04626504331827164, decouple_loss:0.03638911619782448
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497455358505249, gen p mean: -0.280153751373291, mean p set: 0.450225830078125
The modified gen p mean: 0.4492523670196533, gen p mean: -0.2811443507671356, mean p set: 0.4497326612472534
loss_pred:0.04740651324391365, decouple_loss:0.037368711084127426
loss_pred:0.04562889412045479, decouple_loss:0.03807862475514412
The modified gen p mean: 0.45050185918807983, gen p mean: -0.2763965129852295, mean p set: 0.45098215341567993
loss_pred:0.04461168125271797, decouple_loss:0.037138570100069046
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779273867607117, gen p mean: -0.2739482820034027, mean p set: 0.44827306270599365
The modified gen p mean: 0.4500219225883484, gen p mean: -0.2757687270641327, mean p set: 0.4505022168159485
loss_pred:0.04484152793884277, decouple_loss:0.0363909974694252
loss_pred:0.043915268033742905, decouple_loss:0.0372936874628067
The modified gen p mean: 0.4504678249359131, gen p mean: -0.27747243642807007, mean p set: 0.4509481191635132
loss_pred:0.04443679749965668, decouple_loss:0.03601435571908951
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045509934425354, gen p mean: -0.2989877164363861, mean p set: 0.45093539357185364
The modified gen p mean: 0.44828465580940247, gen p mean: -0.29854947328567505, mean p set: 0.44876495003700256
loss_pred:0.045908115804195404, decouple_loss:0.03788740932941437
The modified gen p mean: 0.44732362031936646, gen p mean: -0.29242342710494995, mean p set: 0.44780394434928894
loss_pred:0.04428592324256897, decouple_loss:0.038789816200733185
loss_pred:0.0448567159473896, decouple_loss:0.03796866908669472
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44907504320144653, gen p mean: -0.30416640639305115, mean p set: 0.44955530762672424
The modified gen p mean: 0.4485502243041992, gen p mean: -0.309571236371994, mean p set: 0.44903048872947693
loss_pred:0.044122569262981415, decouple_loss:0.036255694925785065
loss_pred:0.04550635442137718, decouple_loss:0.03730820119380951
The modified gen p mean: 0.4487535357475281, gen p mean: -0.30729007720947266, mean p set: 0.4492338001728058
loss_pred:0.0449233315885067, decouple_loss:0.037856146693229675
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030295848846436, gen p mean: -0.2907131016254425, mean p set: 0.45078325271606445
The modified gen p mean: 0.44839420914649963, gen p mean: -0.28901371359825134, mean p set: 0.44887450337409973
loss_pred:0.043976664543151855, decouple_loss:0.03559340164065361
loss_pred:0.04227021709084511, decouple_loss:0.03900914266705513
The modified gen p mean: 0.4490981698036194, gen p mean: -0.29205888509750366, mean p set: 0.4495784640312195
loss_pred:0.04437868297100067, decouple_loss:0.038451116532087326
2023-05-01 16:51:12 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.288530558347702, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.28221452236175537, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.2842457592487335, mean p set: 0.4500633478164673
loss_pred:0.04690093919634819, decouple_loss:0.043583065271377563
loss_pred:0.04447701573371887, decouple_loss:0.04318111762404442
loss_pred:0.04573126509785652, decouple_loss:0.04156968370079994
WV_0_PC_1_EH_0_PS_40_5, loss: 0.04784197360277176, avg_mse: 0.04840703681111336
current test mse: 0.048407
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501855969429016, gen p mean: -0.28279349207878113, mean p set: 0.4506658911705017
The modified gen p mean: 0.44951075315475464, gen p mean: -0.2823548913002014, mean p set: 0.44999101758003235
loss_pred:0.04439958557486534, decouple_loss:0.036895085126161575
The modified gen p mean: 0.4483434557914734, gen p mean: -0.2846137285232544, mean p set: 0.4488237500190735
loss_pred:0.04367095232009888, decouple_loss:0.038183148950338364
loss_pred:0.044515691697597504, decouple_loss:0.03803456947207451
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812923669815063, gen p mean: -0.301620215177536, mean p set: 0.44860953092575073
The modified gen p mean: 0.45119160413742065, gen p mean: -0.30334335565567017, mean p set: 0.45167189836502075
loss_pred:0.04402059689164162, decouple_loss:0.03673404082655907
loss_pred:0.0427253432571888, decouple_loss:0.03941518813371658
The modified gen p mean: 0.4501650929450989, gen p mean: -0.3035006821155548, mean p set: 0.45064541697502136
loss_pred:0.04396284371614456, decouple_loss:0.03716437146067619
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45073339343070984, gen p mean: -0.3125913143157959, mean p set: 0.45121368765830994
The modified gen p mean: 0.44841963052749634, gen p mean: -0.3109170198440552, mean p set: 0.44889989495277405
loss_pred:0.04224894195795059, decouple_loss:0.03708862140774727
loss_pred:0.044444236904382706, decouple_loss:0.038252875208854675The modified gen p mean: 0.44930654764175415, gen p mean: -0.31121382117271423, mean p set: 0.44978684186935425
loss_pred:0.043692950159311295, decouple_loss:0.037624292075634
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856709241867065, gen p mean: -0.30603522062301636, mean p set: 0.44904738664627075
The modified gen p mean: 0.44945529103279114, gen p mean: -0.30202051997184753, mean p set: 0.4499356150627136
loss_pred:0.04358017444610596, decouple_loss:0.03882191702723503
loss_pred:0.04404395818710327, decouple_loss:0.03742801398038864
The modified gen p mean: 0.4486050605773926, gen p mean: -0.3081575930118561, mean p set: 0.4490853548049927
loss_pred:0.04438202083110809, decouple_loss:0.03695662319660187
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491819441318512, gen p mean: -0.30222541093826294, mean p set: 0.4496622681617737
loss_pred:0.04316425696015358, decouple_loss:0.03579762950539589
The modified gen p mean: 0.447963684797287, gen p mean: -0.30086255073547363, mean p set: 0.4484439492225647The modified gen p mean: 0.44813019037246704, gen p mean: -0.29688936471939087, mean p set: 0.44861045479774475
loss_pred:0.04404650256037712, decouple_loss:0.03647683188319206
loss_pred:0.04447927325963974, decouple_loss:0.036807816475629807
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488302171230316, gen p mean: -0.30043768882751465, mean p set: 0.4493105113506317
The modified gen p mean: 0.448365181684494, gen p mean: -0.30092334747314453, mean p set: 0.4488454759120941
loss_pred:0.04449726641178131, decouple_loss:0.03700258955359459
loss_pred:0.04434220492839813, decouple_loss:0.03707155957818031
The modified gen p mean: 0.4476589858531952, gen p mean: -0.30017828941345215, mean p set: 0.4481392800807953
loss_pred:0.04455335810780525, decouple_loss:0.03698822483420372
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487841725349426, gen p mean: -0.3012905418872833, mean p set: 0.4492644667625427
loss_pred:0.04348185658454895, decouple_loss:0.03824155405163765
The modified gen p mean: 0.4502352178096771, gen p mean: -0.2990780770778656, mean p set: 0.4507155418395996
The modified gen p mean: 0.4492669999599457, gen p mean: -0.30202269554138184, mean p set: 0.4497472941875458
loss_pred:0.04215844348073006, decouple_loss:0.037247732281684875
loss_pred:0.04382915422320366, decouple_loss:0.036854714155197144
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873544573783875, gen p mean: -0.3052951693534851, mean p set: 0.44921573996543884
The modified gen p mean: 0.44888585805892944, gen p mean: -0.30881401896476746, mean p set: 0.44936615228652954
loss_pred:0.04234974458813667, decouple_loss:0.036122050136327744
loss_pred:0.04272079840302467, decouple_loss:0.03580775856971741
The modified gen p mean: 0.4500577747821808, gen p mean: -0.30694395303726196, mean p set: 0.4505380690097809
loss_pred:0.04243345558643341, decouple_loss:0.03688409551978111
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
NaN value num: 0
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486375153064728, gen p mean: -0.3119862377643585, mean p set: 0.44911783933639526
loss_pred:0.04533446580171585, decouple_loss:0.04108020290732384
The modified gen p mean: 0.4514411389827728, gen p mean: -0.30955371260643005, mean p set: 0.4519214332103729The modified gen p mean: 0.4521630108356476, gen p mean: -0.3082083463668823, mean p set: 0.45264333486557007
loss_pred:0.04266376793384552, decouple_loss:0.037148650735616684
loss_pred:0.043589454144239426, decouple_loss:0.03719168156385422
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500126540660858, gen p mean: -0.3005659878253937, mean p set: 0.4504929184913635
The modified gen p mean: 0.4501246511936188, gen p mean: -0.29441002011299133, mean p set: 0.45060494542121887
loss_pred:0.04400576651096344, decouple_loss:0.039793290197849274
loss_pred:0.04568721726536751, decouple_loss:0.040431439876556396
The modified gen p mean: 0.45181918144226074, gen p mean: -0.2999548614025116, mean p set: 0.4522995054721832
loss_pred:0.04370543733239174, decouple_loss:0.039687905460596085
2023-05-01 16:53:58 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.29091978073120117, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.28426384925842285, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.2859654724597931, mean p set: 0.4500633478164673
loss_pred:0.04664827138185501, decouple_loss:0.04076768457889557
loss_pred:0.04444584622979164, decouple_loss:0.040724243968725204
loss_pred:0.045687925070524216, decouple_loss:0.03858616575598717
WV_0_PC_1_EH_0_PS_40_5, loss: 0.0475953184068203, avg_mse: 0.048336442559957504
current test mse: 0.048336
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497659504413605, gen p mean: -0.28551629185676575, mean p set: 0.45024624466896057
The modified gen p mean: 0.45017823576927185, gen p mean: -0.28489401936531067, mean p set: 0.45065850019454956
loss_pred:0.04238738492131233, decouple_loss:0.038983553647994995
The modified gen p mean: 0.4514055550098419, gen p mean: -0.2894538342952728, mean p set: 0.451885849237442
loss_pred:0.04490615800023079, decouple_loss:0.0386422798037529
loss_pred:0.044799432158470154, decouple_loss:0.03900064527988434
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500935971736908, gen p mean: -0.2969053387641907, mean p set: 0.4505738615989685
The modified gen p mean: 0.45141148567199707, gen p mean: -0.29139596223831177, mean p set: 0.4518917500972748
loss_pred:0.04405966401100159, decouple_loss:0.039721760898828506
loss_pred:0.04283673316240311, decouple_loss:0.03853471577167511
The modified gen p mean: 0.4504621624946594, gen p mean: -0.28667303919792175, mean p set: 0.4509424567222595
loss_pred:0.042842380702495575, decouple_loss:0.037620894610881805
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521656334400177, gen p mean: -0.3079739809036255, mean p set: 0.4526459276676178
The modified gen p mean: 0.44975754618644714, gen p mean: -0.30849751830101013, mean p set: 0.45023781061172485
loss_pred:0.04267001524567604, decouple_loss:0.037500131875276566
The modified gen p mean: 0.45227617025375366, gen p mean: -0.30179673433303833, mean p set: 0.45275649428367615
loss_pred:0.045037899166345596, decouple_loss:0.03891991823911667
loss_pred:0.04308799281716347, decouple_loss:0.03803166374564171
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969335198402405, gen p mean: -0.3119916617870331, mean p set: 0.45017367601394653
The modified gen p mean: 0.4513724744319916, gen p mean: -0.3120530843734741, mean p set: 0.4518527686595917
loss_pred:0.04381617531180382, decouple_loss:0.04002893716096878
loss_pred:0.041933853179216385, decouple_loss:0.03807428851723671
The modified gen p mean: 0.44890162348747253, gen p mean: -0.30971503257751465, mean p set: 0.449381947517395
loss_pred:0.044069357216358185, decouple_loss:0.03884615749120712
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485863745212555, gen p mean: -0.30966824293136597, mean p set: 0.4490666687488556
The modified gen p mean: 0.44860783219337463, gen p mean: -0.31271302700042725, mean p set: 0.44908812642097473
loss_pred:0.04404650256037712, decouple_loss:0.03753596916794777
loss_pred:0.042610786855220795, decouple_loss:0.03932546079158783
The modified gen p mean: 0.4497230648994446, gen p mean: -0.3033452332019806, mean p set: 0.4502033293247223
loss_pred:0.0437140129506588, decouple_loss:0.0394725538790226
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904348254203796, gen p mean: -0.2942827045917511, mean p set: 0.44952380657196045
The modified gen p mean: 0.4504455327987671, gen p mean: -0.29555612802505493, mean p set: 0.4509258568286896
loss_pred:0.04255244880914688, decouple_loss:0.03860444948077202
loss_pred:0.04457590728998184, decouple_loss:0.04086173698306084
The modified gen p mean: 0.4490102529525757, gen p mean: -0.287826806306839, mean p set: 0.4494905471801758
loss_pred:0.043943554162979126, decouple_loss:0.03960529342293739
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513235092163086, gen p mean: -0.28843048214912415, mean p set: 0.4518038034439087
The modified gen p mean: 0.4478793442249298, gen p mean: -0.2806848883628845, mean p set: 0.4483596682548523
loss_pred:0.04162866622209549, decouple_loss:0.03804128244519234
loss_pred:0.0445864200592041, decouple_loss:0.03881290555000305
The modified gen p mean: 0.4500460922718048, gen p mean: -0.28618279099464417, mean p set: 0.4505264163017273
loss_pred:0.04196816682815552, decouple_loss:0.038303762674331665
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949978590011597, gen p mean: -0.2882598340511322, mean p set: 0.4499800503253937
The modified gen p mean: 0.45104700326919556, gen p mean: -0.2931734025478363, mean p set: 0.45152729749679565
loss_pred:0.04355868697166443, decouple_loss:0.03749888390302658
loss_pred:0.04253892973065376, decouple_loss:0.03816178813576698
The modified gen p mean: 0.4499203860759735, gen p mean: -0.2845252454280853, mean p set: 0.4504006803035736
loss_pred:0.04360072687268257, decouple_loss:0.038256656378507614
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910693168640137, gen p mean: -0.29118460416793823, mean p set: 0.44958722591400146
The modified gen p mean: 0.4493011236190796, gen p mean: -0.29325735569000244, mean p set: 0.4497814178466797
loss_pred:0.04278595373034477, decouple_loss:0.03794216737151146
loss_pred:0.04435305669903755, decouple_loss:0.03807990998029709
The modified gen p mean: 0.44928377866744995, gen p mean: -0.29724496603012085, mean p set: 0.44976404309272766
loss_pred:0.042973436415195465, decouple_loss:0.03769965469837189
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503028690814972, gen p mean: -0.29579031467437744, mean p set: 0.4507831633090973
The modified gen p mean: 0.4502885341644287, gen p mean: -0.28896862268447876, mean p set: 0.4507688283920288
loss_pred:0.042924027889966965, decouple_loss:0.03639684617519379
loss_pred:0.043579425662755966, decouple_loss:0.03943198546767235
The modified gen p mean: 0.45092499256134033, gen p mean: -0.29618993401527405, mean p set: 0.45140528678894043
loss_pred:0.041826032102108, decouple_loss:0.03756501153111458
2023-05-01 16:56:07 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.2917628586292267, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.2852824628353119, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.28717049956321716, mean p set: 0.4500633478164673
loss_pred:0.04625476151704788, decouple_loss:0.04122729226946831
loss_pred:0.04419543594121933, decouple_loss:0.04123774543404579
loss_pred:0.04525851458311081, decouple_loss:0.039219148457050323
WV_0_PC_1_EH_0_PS_40_5, loss: 0.047264307737350464, avg_mse: 0.048148807138204575
current test mse: 0.048149
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915929436683655, gen p mean: -0.28458482027053833, mean p set: 0.44963955879211426
The modified gen p mean: 0.44761791825294495, gen p mean: -0.2924100160598755, mean p set: 0.44809824228286743
loss_pred:0.041625481098890305, decouple_loss:0.03667609393596649
The modified gen p mean: 0.4514023959636688, gen p mean: -0.2905736267566681, mean p set: 0.4518826901912689
loss_pred:0.04347514361143112, decouple_loss:0.037943389266729355
loss_pred:0.04365089163184166, decouple_loss:0.03704753518104553
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517676532268524, gen p mean: -0.29381856322288513, mean p set: 0.4522479474544525
The modified gen p mean: 0.45248979330062866, gen p mean: -0.2913930416107178, mean p set: 0.45297008752822876
The modified gen p mean: 0.4477842450141907, gen p mean: -0.29050686955451965, mean p set: 0.4482645094394684
loss_pred:0.042601194232702255, decouple_loss:0.0377904511988163
loss_pred:0.041289325803518295, decouple_loss:0.038421276956796646
loss_pred:0.043363746255636215, decouple_loss:0.039872974157333374
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199522376060486, gen p mean: -0.3076165020465851, mean p set: 0.45247551798820496
The modified gen p mean: 0.4505431652069092, gen p mean: -0.2974386513233185, mean p set: 0.4510234594345093
loss_pred:0.04179079085588455, decouple_loss:0.0387376993894577
loss_pred:0.044128626585006714, decouple_loss:0.03780430927872658
The modified gen p mean: 0.44997966289520264, gen p mean: -0.301588773727417, mean p set: 0.45045995712280273
loss_pred:0.04145681485533714, decouple_loss:0.03760926052927971
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497821629047394, gen p mean: -0.3143300414085388, mean p set: 0.45026248693466187
The modified gen p mean: 0.4510818123817444, gen p mean: -0.3160964846611023, mean p set: 0.45156213641166687
loss_pred:0.04343291372060776, decouple_loss:0.03607119992375374
loss_pred:0.04392537102103233, decouple_loss:0.03640018031001091
The modified gen p mean: 0.448527067899704, gen p mean: -0.30995744466781616, mean p set: 0.44900739192962646
loss_pred:0.04316180571913719, decouple_loss:0.03736541420221329
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485812485218048, gen p mean: -0.306440532207489, mean p set: 0.4490615427494049
The modified gen p mean: 0.4490024149417877, gen p mean: -0.3092455565929413, mean p set: 0.4494827091693878
loss_pred:0.04371724650263786, decouple_loss:0.03696756437420845
loss_pred:0.043081946671009064, decouple_loss:0.03753482177853584
The modified gen p mean: 0.45145854353904724, gen p mean: -0.3181779980659485, mean p set: 0.45193883776664734
loss_pred:0.04189431294798851, decouple_loss:0.036619845777750015
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505285620689392, gen p mean: -0.29879170656204224, mean p set: 0.4510088264942169
The modified gen p mean: 0.44937124848365784, gen p mean: -0.3017137348651886, mean p set: 0.4498515725135803
loss_pred:0.04136037081480026, decouple_loss:0.03590722382068634
loss_pred:0.042448125779628754, decouple_loss:0.03661610931158066
The modified gen p mean: 0.4490277171134949, gen p mean: -0.29875582456588745, mean p set: 0.4495079815387726
loss_pred:0.043508004397153854, decouple_loss:0.035512108355760574
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893309473991394, gen p mean: -0.30650660395622253, mean p set: 0.44941338896751404
loss_pred:0.04206918552517891, decouple_loss:0.036194898188114166
The modified gen p mean: 0.4501555562019348, gen p mean: -0.30667638778686523, mean p set: 0.4506358802318573The modified gen p mean: 0.44945916533470154, gen p mean: -0.3083491325378418, mean p set: 0.44993945956230164
loss_pred:0.043341707438230515, decouple_loss:0.03525190055370331
loss_pred:0.04216605797410011, decouple_loss:0.03463181480765343
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982659816741943, gen p mean: -0.3041456937789917, mean p set: 0.45030689239501953
The modified gen p mean: 0.4500269293785095, gen p mean: -0.3057607114315033, mean p set: 0.4505072236061096
loss_pred:0.04128628224134445, decouple_loss:0.0348670668900013
loss_pred:0.041338060051202774, decouple_loss:0.035603348165750504
The modified gen p mean: 0.45283541083335876, gen p mean: -0.3037905991077423, mean p set: 0.4533156752586365
loss_pred:0.04333927482366562, decouple_loss:0.03685828670859337
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
NaN value num: 0
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478659927845001, gen p mean: -0.31405216455459595, mean p set: 0.4483462870121002
loss_pred:0.04341261461377144, decouple_loss:0.03998278081417084
The modified gen p mean: 0.4486565887928009, gen p mean: -0.31048116087913513, mean p set: 0.449136883020401The modified gen p mean: 0.44929370284080505, gen p mean: -0.3146103620529175, mean p set: 0.44977399706840515
loss_pred:0.045832715928554535, decouple_loss:0.03696615993976593
loss_pred:0.044979337602853775, decouple_loss:0.03959232196211815
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508529603481293, gen p mean: -0.3166828155517578, mean p set: 0.45133325457572937
The modified gen p mean: 0.4498324692249298, gen p mean: -0.3197133243083954, mean p set: 0.4503127932548523
loss_pred:0.045706603676080704, decouple_loss:0.040651991963386536
loss_pred:0.04183725267648697, decouple_loss:0.03785333037376404
The modified gen p mean: 0.4506557881832123, gen p mean: -0.31634700298309326, mean p set: 0.45113611221313477
loss_pred:0.04614757373929024, decouple_loss:0.04116697609424591
2023-05-01 16:58:59 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.3196351230144501, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.31166061758995056, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.3142959475517273, mean p set: 0.4500633478164673
loss_pred:0.04561995342373848, decouple_loss:0.04132178798317909
loss_pred:0.04376388341188431, decouple_loss:0.04071132093667984
loss_pred:0.044733691960573196, decouple_loss:0.039714265614748
WV_0_PC_1_EH_0_PS_40_5, loss: 0.04673496633768082, avg_mse: 0.04771990701556206
current test mse: 0.04772
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450407475233078, gen p mean: -0.31802240014076233, mean p set: 0.4508877694606781
The modified gen p mean: 0.45137128233909607, gen p mean: -0.31081801652908325, mean p set: 0.45185160636901855
loss_pred:0.044725656509399414, decouple_loss:0.04070934280753136
The modified gen p mean: 0.44969040155410767, gen p mean: -0.3072127401828766, mean p set: 0.45017069578170776
loss_pred:0.044908639043569565, decouple_loss:0.04235414043068886
loss_pred:0.04353688284754753, decouple_loss:0.04039011895656586
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44999951124191284, gen p mean: -0.30462098121643066, mean p set: 0.45047977566719055
The modified gen p mean: 0.44757893681526184, gen p mean: -0.3010568618774414, mean p set: 0.44805923104286194
loss_pred:0.041670866310596466, decouple_loss:0.038343559950590134
loss_pred:0.04426543787121773, decouple_loss:0.03997252136468887
The modified gen p mean: 0.44807860255241394, gen p mean: -0.30047544836997986, mean p set: 0.44855889678001404
loss_pred:0.04457662254571915, decouple_loss:0.04096612334251404
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45136386156082153, gen p mean: -0.3215245008468628, mean p set: 0.45184415578842163
The modified gen p mean: 0.448749303817749, gen p mean: -0.30731767416000366, mean p set: 0.4492295980453491
loss_pred:0.04214904457330704, decouple_loss:0.04180376976728439
loss_pred:0.043547194451093674, decouple_loss:0.038585685193538666
The modified gen p mean: 0.4522785544395447, gen p mean: -0.3206144869327545, mean p set: 0.4527588486671448
loss_pred:0.04247892275452614, decouple_loss:0.04041729494929314
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025697350502014, gen p mean: -0.3228095471858978, mean p set: 0.45073726773262024
The modified gen p mean: 0.44861117005348206, gen p mean: -0.31907421350479126, mean p set: 0.44909143447875977
loss_pred:0.04374537616968155, decouple_loss:0.03989338502287865
loss_pred:0.043185487389564514, decouple_loss:0.04113207384943962
The modified gen p mean: 0.4500812888145447, gen p mean: -0.3156585097312927, mean p set: 0.4505615830421448
loss_pred:0.04212774708867073, decouple_loss:0.03853500634431839
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510563313961029, gen p mean: -0.31790077686309814, mean p set: 0.451536625623703
The modified gen p mean: 0.4502078890800476, gen p mean: -0.3158831298351288, mean p set: 0.4506881833076477
The modified gen p mean: 0.4491357207298279, gen p mean: -0.31700581312179565, mean p set: 0.44961604475975037loss_pred:0.0434376522898674, decouple_loss:0.03957849740982056
loss_pred:0.043638844043016434, decouple_loss:0.03788957744836807
loss_pred:0.042667463421821594, decouple_loss:0.03866615146398544
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747841358184814, gen p mean: -0.3219682574272156, mean p set: 0.44795873761177063
The modified gen p mean: 0.44730284810066223, gen p mean: -0.32105782628059387, mean p set: 0.44778314232826233
loss_pred:0.04442359134554863, decouple_loss:0.039914570748806
loss_pred:0.0453089103102684, decouple_loss:0.04164610430598259
The modified gen p mean: 0.44971993565559387, gen p mean: -0.31941744685173035, mean p set: 0.4502002000808716
loss_pred:0.042783256620168686, decouple_loss:0.03749379515647888
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502193331718445, gen p mean: -0.32782912254333496, mean p set: 0.45069968700408936
loss_pred:0.04296373575925827, decouple_loss:0.039435725659132004
The modified gen p mean: 0.44837361574172974, gen p mean: -0.3227807283401489, mean p set: 0.44885390996932983The modified gen p mean: 0.4496040344238281, gen p mean: -0.3254854083061218, mean p set: 0.4500843286514282
loss_pred:0.0424356535077095, decouple_loss:0.04056268185377121
loss_pred:0.04508553817868233, decouple_loss:0.03878294676542282
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448701411485672, gen p mean: -0.32175150513648987, mean p set: 0.4491817057132721
The modified gen p mean: 0.45168885588645935, gen p mean: -0.3269205391407013, mean p set: 0.45216912031173706
loss_pred:0.042470429092645645, decouple_loss:0.04092758893966675
loss_pred:0.0439019650220871, decouple_loss:0.038579776883125305
The modified gen p mean: 0.4521802067756653, gen p mean: -0.33160200715065, mean p set: 0.4526605010032654
loss_pred:0.041973989456892014, decouple_loss:0.04097725450992584
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515320658683777, gen p mean: -0.32234713435173035, mean p set: 0.4520123302936554
The modified gen p mean: 0.44977709650993347, gen p mean: -0.3303082287311554, mean p set: 0.45025739073753357
loss_pred:0.041311442852020264, decouple_loss:0.03794051334261894
loss_pred:0.044845420867204666, decouple_loss:0.04212047904729843
The modified gen p mean: 0.4471801221370697, gen p mean: -0.32103410363197327, mean p set: 0.4476604163646698
loss_pred:0.044767871499061584, decouple_loss:0.03842473775148392
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515502452850342, gen p mean: -0.3290894031524658, mean p set: 0.4520305097103119
The modified gen p mean: 0.4473363757133484, gen p mean: -0.3251256048679352, mean p set: 0.4478166699409485
loss_pred:0.041432738304138184, decouple_loss:0.03822148218750954
loss_pred:0.04424025118350983, decouple_loss:0.03616393357515335
The modified gen p mean: 0.4499530494213104, gen p mean: -0.3194211423397064, mean p set: 0.4504333436489105
loss_pred:0.04093651473522186, decouple_loss:0.036124300211668015
2023-05-01 17:01:08 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.33893993496894836, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.33258453011512756, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.33465465903282166, mean p set: 0.4500633478164673
loss_pred:0.0452556312084198, decouple_loss:0.041239604353904724
loss_pred:0.04346855729818344, decouple_loss:0.04183685779571533
loss_pred:0.04435043781995773, decouple_loss:0.03974216431379318
WV_0_PC_1_EH_0_PS_40_5, loss: 0.046405188739299774, avg_mse: 0.047464195638895035
current test mse: 0.047464
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956454634666443, gen p mean: -0.33734866976737976, mean p set: 0.4500448405742645
The modified gen p mean: 0.44821226596832275, gen p mean: -0.3336770832538605, mean p set: 0.44869256019592285
loss_pred:0.04258649796247482, decouple_loss:0.038592804223299026
The modified gen p mean: 0.4475676119327545, gen p mean: -0.3294559419155121, mean p set: 0.4480479061603546
loss_pred:0.04299825429916382, decouple_loss:0.03661499544978142
loss_pred:0.04291023686528206, decouple_loss:0.03834449127316475
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450541615486145, gen p mean: -0.34349524974823, mean p set: 0.45102187991142273
The modified gen p mean: 0.44873663783073425, gen p mean: -0.331211119890213, mean p set: 0.44921693205833435
loss_pred:0.041534073650836945, decouple_loss:0.03811348229646683
loss_pred:0.042620718479156494, decouple_loss:0.036430343985557556
The modified gen p mean: 0.449433296918869, gen p mean: -0.3325468599796295, mean p set: 0.44991356134414673
loss_pred:0.04283355176448822, decouple_loss:0.03842784836888313
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491461515426636, gen p mean: -0.33175957202911377, mean p set: 0.44962644577026367
The modified gen p mean: 0.4499646723270416, gen p mean: -0.33985596895217896, mean p set: 0.4504449665546417
loss_pred:0.04308255761861801, decouple_loss:0.03669155761599541
loss_pred:0.0428694412112236, decouple_loss:0.037153128534555435
The modified gen p mean: 0.45128291845321655, gen p mean: -0.33943602442741394, mean p set: 0.45176324248313904
loss_pred:0.04164683446288109, decouple_loss:0.03625025600194931
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778576493263245, gen p mean: -0.327197402715683, mean p set: 0.44826605916023254
loss_pred:0.04373164102435112, decouple_loss:0.0369739830493927
The modified gen p mean: 0.44835227727890015, gen p mean: -0.32859766483306885, mean p set: 0.44883257150650024The modified gen p mean: 0.4501053988933563, gen p mean: -0.3330309987068176, mean p set: 0.4505856931209564
loss_pred:0.040812548249959946, decouple_loss:0.03745502606034279
loss_pred:0.04194881021976471, decouple_loss:0.038448601961135864
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45162808895111084, gen p mean: -0.3346766531467438, mean p set: 0.4521084129810333
loss_pred:0.042254362255334854, decouple_loss:0.03659673035144806
The modified gen p mean: 0.45136773586273193, gen p mean: -0.32957008481025696, mean p set: 0.4518480598926544The modified gen p mean: 0.44725048542022705, gen p mean: -0.3251793384552002, mean p set: 0.44773074984550476
loss_pred:0.04090961441397667, decouple_loss:0.03677106648683548
loss_pred:0.04239145666360855, decouple_loss:0.035540517419576645
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492734372615814, gen p mean: -0.32833564281463623, mean p set: 0.4497537314891815
loss_pred:0.041955918073654175, decouple_loss:0.03632763773202896
The modified gen p mean: 0.4481247365474701, gen p mean: -0.31890609860420227, mean p set: 0.4486050307750702The modified gen p mean: 0.44755303859710693, gen p mean: -0.32069796323776245, mean p set: 0.44803333282470703
loss_pred:0.043012410402297974, decouple_loss:0.035402167588472366
loss_pred:0.040087245404720306, decouple_loss:0.037583108991384506
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491610527038574, gen p mean: -0.3308810591697693, mean p set: 0.4496413469314575
loss_pred:0.04439401626586914, decouple_loss:0.03744672238826752
The modified gen p mean: 0.45009297132492065, gen p mean: -0.3278557360172272, mean p set: 0.45057329535484314The modified gen p mean: 0.44841107726097107, gen p mean: -0.32743242383003235, mean p set: 0.44889137148857117
loss_pred:0.04458046704530716, decouple_loss:0.03734571486711502
loss_pred:0.04269490763545036, decouple_loss:0.03503028675913811
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008373260498047, gen p mean: -0.3412245810031891, mean p set: 0.45056405663490295
loss_pred:0.04359428584575653, decouple_loss:0.0386480875313282
The modified gen p mean: 0.4492855370044708, gen p mean: -0.3297208249568939, mean p set: 0.44976580142974854
The modified gen p mean: 0.44727784395217896, gen p mean: -0.33355948328971863, mean p set: 0.44775813817977905
loss_pred:0.04252079129219055, decouple_loss:0.03642895072698593
loss_pred:0.040062788873910904, decouple_loss:0.03538773953914642
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794782996177673, gen p mean: -0.3246384859085083, mean p set: 0.44842812418937683
loss_pred:0.043313853442668915, decouple_loss:0.03771005943417549
The modified gen p mean: 0.446893572807312, gen p mean: -0.32526886463165283, mean p set: 0.4473738372325897The modified gen p mean: 0.4482124447822571, gen p mean: -0.32374057173728943, mean p set: 0.4486927390098572
loss_pred:0.043565213680267334, decouple_loss:0.03804365172982216
loss_pred:0.04369402304291725, decouple_loss:0.03672459349036217
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472768306732178, gen p mean: -0.3043312728404999, mean p set: 0.4477570950984955
loss_pred:0.04322594776749611, decouple_loss:0.0390416719019413
The modified gen p mean: 0.44609716534614563, gen p mean: -0.3076860010623932, mean p set: 0.4465774595737457The modified gen p mean: 0.44665172696113586, gen p mean: -0.30284667015075684, mean p set: 0.44713205099105835
loss_pred:0.04504351317882538, decouple_loss:0.03889927268028259
loss_pred:0.04367966204881668, decouple_loss:0.0400829091668129
2023-05-01 17:03:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.312820702791214, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3062811493873596, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.30837884545326233, mean p set: 0.4500633478164673
loss_pred:0.04430466145277023, decouple_loss:0.03969071805477142
loss_pred:0.042269546538591385, decouple_loss:0.03920818865299225
loss_pred:0.04340434819459915, decouple_loss:0.03813796862959862
WV_0_PC_1_EH_0_PS_40_5, loss: 0.04527680203318596, avg_mse: 0.04625706747174263
current test mse: 0.046257
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469364583492279, gen p mean: -0.30202192068099976, mean p set: 0.447416752576828
The modified gen p mean: 0.4465223252773285, gen p mean: -0.3035067319869995, mean p set: 0.4470026195049286
loss_pred:0.04299638047814369, decouple_loss:0.037459395825862885
The modified gen p mean: 0.4482123553752899, gen p mean: -0.3056134581565857, mean p set: 0.44869264960289
loss_pred:0.04310845956206322, decouple_loss:0.03602417930960655
loss_pred:0.042996566742658615, decouple_loss:0.035442057996988297
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737738370895386, gen p mean: -0.3199199140071869, mean p set: 0.44785767793655396The modified gen p mean: 0.447307288646698, gen p mean: -0.3226180374622345, mean p set: 0.4477875828742981
loss_pred:0.04623553156852722, decouple_loss:0.03750847280025482loss_pred:0.043505292385816574, decouple_loss:0.03667270392179489
The modified gen p mean: 0.44812071323394775, gen p mean: -0.32094937562942505, mean p set: 0.44860100746154785
loss_pred:0.04344954714179039, decouple_loss:0.03531984984874725
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660329818725586, gen p mean: -0.33255937695503235, mean p set: 0.44708362221717834
The modified gen p mean: 0.44716647267341614, gen p mean: -0.3294409215450287, mean p set: 0.44764676690101624
loss_pred:0.04253658652305603, decouple_loss:0.03616199269890785
loss_pred:0.04244406521320343, decouple_loss:0.036649178713560104
The modified gen p mean: 0.4466247856616974, gen p mean: -0.33114999532699585, mean p set: 0.4471050798892975
loss_pred:0.042649369686841965, decouple_loss:0.03549600765109062
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475524127483368, gen p mean: -0.33396631479263306, mean p set: 0.4480327367782593
The modified gen p mean: 0.4467073082923889, gen p mean: -0.3361539840698242, mean p set: 0.4471876323223114
loss_pred:0.04291360452771187, decouple_loss:0.038873810321092606
loss_pred:0.043557874858379364, decouple_loss:0.03633749857544899
The modified gen p mean: 0.4466308057308197, gen p mean: -0.33215832710266113, mean p set: 0.4471111297607422
loss_pred:0.04306238889694214, decouple_loss:0.0357067845761776
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470263123512268, gen p mean: -0.31419986486434937, mean p set: 0.4475066065788269
The modified gen p mean: 0.4478078782558441, gen p mean: -0.3171137571334839, mean p set: 0.4482881724834442
loss_pred:0.041032616049051285, decouple_loss:0.03547016531229019
loss_pred:0.042853765189647675, decouple_loss:0.036922745406627655
The modified gen p mean: 0.4487560987472534, gen p mean: -0.3136671185493469, mean p set: 0.44923636317253113
loss_pred:0.04234180226922035, decouple_loss:0.03539269417524338
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719362258911133, gen p mean: -0.29466602206230164, mean p set: 0.4476739168167114
The modified gen p mean: 0.4467913806438446, gen p mean: -0.2988450527191162, mean p set: 0.4472716748714447
loss_pred:0.04226375371217728, decouple_loss:0.03637147694826126
loss_pred:0.0439421646296978, decouple_loss:0.03666038066148758
The modified gen p mean: 0.4473952651023865, gen p mean: -0.30263060331344604, mean p set: 0.4478755593299866
loss_pred:0.04314928501844406, decouple_loss:0.035757336765527725
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465309977531433, gen p mean: -0.29284578561782837, mean p set: 0.4470112919807434
The modified gen p mean: 0.4476989805698395, gen p mean: -0.29039376974105835, mean p set: 0.44817930459976196
loss_pred:0.041724033653736115, decouple_loss:0.03698861971497536
The modified gen p mean: 0.44715994596481323, gen p mean: -0.2937704026699066, mean p set: 0.44764021039009094loss_pred:0.04250509664416313, decouple_loss:0.035274699330329895
loss_pred:0.044586315751075745, decouple_loss:0.03651906177401543
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691500067710876, gen p mean: -0.3002972900867462, mean p set: 0.44739529490470886
loss_pred:0.04162096604704857, decouple_loss:0.03590112924575806
The modified gen p mean: 0.44717469811439514, gen p mean: -0.3047202527523041, mean p set: 0.44765499234199524The modified gen p mean: 0.447295606136322, gen p mean: -0.3004086911678314, mean p set: 0.4477759003639221
loss_pred:0.043227579444646835, decouple_loss:0.0370493084192276
loss_pred:0.042432405054569244, decouple_loss:0.03466082364320755
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482475817203522, gen p mean: -0.31262466311454773, mean p set: 0.44872787594795227
The modified gen p mean: 0.44667771458625793, gen p mean: -0.3108258545398712, mean p set: 0.44715800881385803
loss_pred:0.041683755815029144, decouple_loss:0.03519342839717865
loss_pred:0.04095306247472763, decouple_loss:0.03515755385160446
The modified gen p mean: 0.44766607880592346, gen p mean: -0.3121243119239807, mean p set: 0.44814640283584595
loss_pred:0.04189709573984146, decouple_loss:0.033482812345027924
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818082451820374, gen p mean: -0.32325369119644165, mean p set: 0.4486611485481262
loss_pred:0.041486576199531555, decouple_loss:0.03701815754175186
The modified gen p mean: 0.44720712304115295, gen p mean: -0.31679338216781616, mean p set: 0.44768741726875305The modified gen p mean: 0.447295606136322, gen p mean: -0.322867214679718, mean p set: 0.4477759599685669
loss_pred:0.04203566536307335, decouple_loss:0.03612872585654259
loss_pred:0.04262152314186096, decouple_loss:0.0361686646938324
2023-05-01 17:06:05 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.32897183299064636, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.32320091128349304, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3215404450893402, mean p set: 0.45035696029663086
loss_pred:0.04338254779577255, decouple_loss:0.03668089583516121
loss_pred:0.041613996028900146, decouple_loss:0.036447230726480484loss_pred:0.042558155953884125, decouple_loss:0.03530111163854599
WV_0_PC_1_EH_0_PS_40_5, loss: 0.044325392693281174, avg_mse: 0.04547363892197609
current test mse: 0.045474
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753625988960266, gen p mean: -0.3224113881587982, mean p set: 0.44801655411720276
loss_pred:0.04094002768397331, decouple_loss:0.03473275527358055
The modified gen p mean: 0.4466235935688019, gen p mean: -0.3233266770839691, mean p set: 0.4471038579940796The modified gen p mean: 0.4463751018047333, gen p mean: -0.32657691836357117, mean p set: 0.4468553960323334
loss_pred:0.04472581669688225, decouple_loss:0.03412538021802902
loss_pred:0.042514316737651825, decouple_loss:0.03504123538732529
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640475511550903, gen p mean: -0.3189575672149658, mean p set: 0.44688504934310913
loss_pred:0.04187612980604172, decouple_loss:0.0352725088596344
The modified gen p mean: 0.446856826543808, gen p mean: -0.3184167146682739, mean p set: 0.4473371207714081The modified gen p mean: 0.446953147649765, gen p mean: -0.31775420904159546, mean p set: 0.4474334716796875
loss_pred:0.04081319645047188, decouple_loss:0.03438873961567879
loss_pred:0.04188867658376694, decouple_loss:0.033876724541187286
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471932649612427, gen p mean: -0.30692604184150696, mean p set: 0.4476735293865204
loss_pred:0.04138697311282158, decouple_loss:0.03445899859070778
The modified gen p mean: 0.44703614711761475, gen p mean: -0.31013572216033936, mean p set: 0.44751641154289246The modified gen p mean: 0.4480387568473816, gen p mean: -0.31587639451026917, mean p set: 0.4485190510749817
loss_pred:0.04127046838402748, decouple_loss:0.03393278270959854
loss_pred:0.042994581162929535, decouple_loss:0.036249347031116486
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448147714138031, gen p mean: -0.31047141551971436, mean p set: 0.4486280083656311
loss_pred:0.04171296954154968, decouple_loss:0.03433351218700409
The modified gen p mean: 0.4460698366165161, gen p mean: -0.3089272081851959, mean p set: 0.4465501010417938The modified gen p mean: 0.4474722146987915, gen p mean: -0.31572476029396057, mean p set: 0.4479525089263916
loss_pred:0.04289581999182701, decouple_loss:0.035719115287065506
loss_pred:0.04185912013053894, decouple_loss:0.034818168729543686
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472036063671112, gen p mean: -0.3194141983985901, mean p set: 0.4476839005947113
The modified gen p mean: 0.4471668004989624, gen p mean: -0.31818944215774536, mean p set: 0.4476470947265625
loss_pred:0.04057836905121803, decouple_loss:0.03455984964966774
loss_pred:0.04117205739021301, decouple_loss:0.03535572066903114
The modified gen p mean: 0.44669532775878906, gen p mean: -0.3212297856807709, mean p set: 0.44717565178871155
loss_pred:0.04342931881546974, decouple_loss:0.033312294632196426
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784805178642273, gen p mean: -0.3277378976345062, mean p set: 0.44832831621170044
loss_pred:0.04131544381380081, decouple_loss:0.03414059802889824
The modified gen p mean: 0.44814738631248474, gen p mean: -0.32650741934776306, mean p set: 0.44862768054008484The modified gen p mean: 0.4469571113586426, gen p mean: -0.3191901445388794, mean p set: 0.44743743538856506
loss_pred:0.041190557181835175, decouple_loss:0.034655556082725525
loss_pred:0.042376164346933365, decouple_loss:0.0357966274023056
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684138894081116, gen p mean: -0.3351057171821594, mean p set: 0.44732168316841125
loss_pred:0.041274718940258026, decouple_loss:0.03359123319387436
The modified gen p mean: 0.44840213656425476, gen p mean: -0.32814350724220276, mean p set: 0.44888240098953247The modified gen p mean: 0.4474543631076813, gen p mean: -0.33589968085289, mean p set: 0.447934627532959
loss_pred:0.042232148349285126, decouple_loss:0.03501666337251663
loss_pred:0.042779721319675446, decouple_loss:0.035238638520240784
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738903641700745, gen p mean: -0.32450827956199646, mean p set: 0.44786933064460754
loss_pred:0.04130869358778, decouple_loss:0.03441348299384117
The modified gen p mean: 0.4473174512386322, gen p mean: -0.3293403685092926, mean p set: 0.4477977156639099The modified gen p mean: 0.44614535570144653, gen p mean: -0.3312568664550781, mean p set: 0.44662564992904663
loss_pred:0.04129922017455101, decouple_loss:0.033656757324934006
loss_pred:0.04246567562222481, decouple_loss:0.0337207205593586
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814372062683105, gen p mean: -0.3271699845790863, mean p set: 0.44862401485443115
loss_pred:0.043353043496608734, decouple_loss:0.034889090806245804
The modified gen p mean: 0.44820713996887207, gen p mean: -0.3279424011707306, mean p set: 0.44868743419647217The modified gen p mean: 0.44747069478034973, gen p mean: -0.3256426453590393, mean p set: 0.4479510188102722
loss_pred:0.04120667651295662, decouple_loss:0.0376790389418602
loss_pred:0.04183173179626465, decouple_loss:0.03657340258359909
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769397377967834, gen p mean: -0.3236677050590515, mean p set: 0.44817429780960083
The modified gen p mean: 0.447831928730011, gen p mean: -0.3205935060977936, mean p set: 0.4483122229576111
loss_pred:0.04212440550327301, decouple_loss:0.037272874265909195
loss_pred:0.04250647500157356, decouple_loss:0.034965962171554565
The modified gen p mean: 0.44794484972953796, gen p mean: -0.318530410528183, mean p set: 0.44842514395713806
loss_pred:0.04274570941925049, decouple_loss:0.03519565239548683
2023-05-01 17:09:03 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.313275009393692, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.308978796005249, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.30730515718460083, mean p set: 0.45035696029663086
loss_pred:0.04276769980788231, decouple_loss:0.035287875682115555
loss_pred:0.04187394678592682, decouple_loss:0.03454544395208359
loss_pred:0.04068438708782196, decouple_loss:0.0351184718310833
WV_0_PC_1_EH_0_PS_40_5, loss: 0.04352454096078873, avg_mse: 0.044638603925704956
current test mse: 0.044639
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481634795665741, gen p mean: -0.3070123791694641, mean p set: 0.4486437737941742
loss_pred:0.04112015664577484, decouple_loss:0.03447110578417778
The modified gen p mean: 0.4473554193973541, gen p mean: -0.31173548102378845, mean p set: 0.4478357136249542The modified gen p mean: 0.4468085765838623, gen p mean: -0.3106482923030853, mean p set: 0.4472888708114624
loss_pred:0.04140134155750275, decouple_loss:0.035675667226314545
loss_pred:0.04167604446411133, decouple_loss:0.03685713931918144
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481145441532135, gen p mean: -0.31492409110069275, mean p set: 0.4485948383808136
The modified gen p mean: 0.44823771715164185, gen p mean: -0.31659120321273804, mean p set: 0.44871804118156433
loss_pred:0.042082928121089935, decouple_loss:0.034403130412101746
loss_pred:0.04310134798288345, decouple_loss:0.03416569158434868
The modified gen p mean: 0.4474269449710846, gen p mean: -0.31899839639663696, mean p set: 0.4479072690010071
loss_pred:0.04191628471016884, decouple_loss:0.03762100636959076
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754332304000854, gen p mean: -0.32576802372932434, mean p set: 0.44802361726760864
loss_pred:0.042253509163856506, decouple_loss:0.03488314896821976
The modified gen p mean: 0.447663813829422, gen p mean: -0.32518890500068665, mean p set: 0.4481441080570221The modified gen p mean: 0.447664350271225, gen p mean: -0.32236447930336, mean p set: 0.4481446444988251
loss_pred:0.04237618297338486, decouple_loss:0.03409387916326523
loss_pred:0.04120738431811333, decouple_loss:0.033608805388212204
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688132405281067, gen p mean: -0.32673346996307373, mean p set: 0.44736161828041077
The modified gen p mean: 0.44653046131134033, gen p mean: -0.3250483572483063, mean p set: 0.44701075553894043
loss_pred:0.040724508464336395, decouple_loss:0.03451027348637581
loss_pred:0.041464559733867645, decouple_loss:0.03486316278576851
The modified gen p mean: 0.4482698142528534, gen p mean: -0.32808366417884827, mean p set: 0.4487501382827759
loss_pred:0.04112321510910988, decouple_loss:0.0357217974960804
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795045256614685, gen p mean: -0.32682621479034424, mean p set: 0.44843074679374695
loss_pred:0.04352724924683571, decouple_loss:0.034754104912281036
The modified gen p mean: 0.4473671317100525, gen p mean: -0.3234380781650543, mean p set: 0.4478473961353302
The modified gen p mean: 0.44622570276260376, gen p mean: -0.31927093863487244, mean p set: 0.44670602679252625
loss_pred:0.043362874537706375, decouple_loss:0.0366283655166626
loss_pred:0.04175009950995445, decouple_loss:0.03585559129714966
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660675525665283, gen p mean: -0.321622759103775, mean p set: 0.4470870792865753
The modified gen p mean: 0.446754515171051, gen p mean: -0.32845771312713623, mean p set: 0.44723477959632874
loss_pred:0.0420093908905983, decouple_loss:0.035277023911476135
loss_pred:0.04197239875793457, decouple_loss:0.03508596867322922The modified gen p mean: 0.4477618634700775, gen p mean: -0.32215893268585205, mean p set: 0.4482421875
loss_pred:0.04163038358092308, decouple_loss:0.035904660820961
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734081625938416, gen p mean: -0.3151335120201111, mean p set: 0.44782111048698425
The modified gen p mean: 0.4481600224971771, gen p mean: -0.3176778256893158, mean p set: 0.44864028692245483
loss_pred:0.04193940386176109, decouple_loss:0.03409729525446892
loss_pred:0.0420924536883831, decouple_loss:0.03422889858484268
The modified gen p mean: 0.44681665301322937, gen p mean: -0.32087236642837524, mean p set: 0.4472969174385071
loss_pred:0.040743015706539154, decouple_loss:0.034271806478500366
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474377930164337, gen p mean: -0.3169817328453064, mean p set: 0.4479181170463562
The modified gen p mean: 0.44774001836776733, gen p mean: -0.32153961062431335, mean p set: 0.44822028279304504
loss_pred:0.04075402021408081, decouple_loss:0.0341293066740036
loss_pred:0.0411837175488472, decouple_loss:0.036601196974515915
The modified gen p mean: 0.4471207857131958, gen p mean: -0.3168424069881439, mean p set: 0.4476010799407959
loss_pred:0.04183543846011162, decouple_loss:0.03388269245624542
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472900927066803, gen p mean: -0.33639413118362427, mean p set: 0.4477703869342804
The modified gen p mean: 0.4493086040019989, gen p mean: -0.3399406373500824, mean p set: 0.4497888684272766
loss_pred:0.042528267949819565, decouple_loss:0.03432919830083847
loss_pred:0.03954607620835304, decouple_loss:0.036430299282073975The modified gen p mean: 0.4479466378688812, gen p mean: -0.33583107590675354, mean p set: 0.4484269320964813
loss_pred:0.04049013927578926, decouple_loss:0.03639909252524376
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472962021827698, gen p mean: -0.3350021243095398, mean p set: 0.4477764964103699
The modified gen p mean: 0.4472196102142334, gen p mean: -0.3336903154850006, mean p set: 0.4476999342441559
loss_pred:0.04110395535826683, decouple_loss:0.0349142923951149
loss_pred:0.04236534237861633, decouple_loss:0.03316463530063629
The modified gen p mean: 0.44689297676086426, gen p mean: -0.3362123370170593, mean p set: 0.44737330079078674
loss_pred:0.040819715708494186, decouple_loss:0.034333281219005585
2023-05-01 17:11:11 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.32406893372535706, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3168336749076843, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.31895139813423157, mean p set: 0.4500633478164673
loss_pred:0.04250426962971687, decouple_loss:0.035046134144067764
loss_pred:0.040528856217861176, decouple_loss:0.0354258269071579
loss_pred:0.04150232672691345, decouple_loss:0.0343179926276207
WV_0_PC_1_EH_0_PS_40_5, loss: 0.043258316814899445, avg_mse: 0.044347189366817474
current test mse: 0.044347
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732606410980225, gen p mean: -0.3207133710384369, mean p set: 0.44780635833740234
The modified gen p mean: 0.447802871465683, gen p mean: -0.3225691616535187, mean p set: 0.4482831358909607
loss_pred:0.04063785821199417, decouple_loss:0.03436695784330368
The modified gen p mean: 0.44660720229148865, gen p mean: -0.32196807861328125, mean p set: 0.44708749651908875
loss_pred:0.04292672872543335, decouple_loss:0.03473920375108719
loss_pred:0.0422571524977684, decouple_loss:0.03477288410067558
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484044313430786, gen p mean: -0.3264762759208679, mean p set: 0.4488847255706787The modified gen p mean: 0.4485522210597992, gen p mean: -0.328603059053421, mean p set: 0.4490325152873993
loss_pred:0.03981124609708786, decouple_loss:0.03341817483305931loss_pred:0.03920067101716995, decouple_loss:0.03432302922010422
The modified gen p mean: 0.4474565386772156, gen p mean: -0.31905850768089294, mean p set: 0.44793686270713806
loss_pred:0.040918320417404175, decouple_loss:0.03373606875538826
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472769796848297, gen p mean: -0.3307758867740631, mean p set: 0.4477572739124298
The modified gen p mean: 0.44723570346832275, gen p mean: -0.3338293731212616, mean p set: 0.44771599769592285
loss_pred:0.041558392345905304, decouple_loss:0.03504921868443489
loss_pred:0.04053717851638794, decouple_loss:0.035157475620508194
The modified gen p mean: 0.44724908471107483, gen p mean: -0.3311384320259094, mean p set: 0.4477294087409973
loss_pred:0.04250853881239891, decouple_loss:0.03444606438279152
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688400626182556, gen p mean: -0.3379398584365845, mean p set: 0.44736430048942566
loss_pred:0.04070286080241203, decouple_loss:0.03396226838231087
The modified gen p mean: 0.447311133146286, gen p mean: -0.33911386132240295, mean p set: 0.4477914571762085The modified gen p mean: 0.44832292199134827, gen p mean: -0.33668529987335205, mean p set: 0.44880321621894836
loss_pred:0.040456317365169525, decouple_loss:0.033818427473306656
loss_pred:0.04020082205533981, decouple_loss:0.0324796624481678
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699323177337646, gen p mean: -0.3314337134361267, mean p set: 0.44747352600097656
The modified gen p mean: 0.44665074348449707, gen p mean: -0.34077927470207214, mean p set: 0.4471310079097748
loss_pred:0.04143134877085686, decouple_loss:0.033136095851659775
loss_pred:0.03963248059153557, decouple_loss:0.03289609029889107
The modified gen p mean: 0.4467688798904419, gen p mean: -0.33493751287460327, mean p set: 0.4472491443157196
loss_pred:0.04069758206605911, decouple_loss:0.03396207466721535
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468052387237549, gen p mean: -0.3402760922908783, mean p set: 0.44728556275367737
The modified gen p mean: 0.44761157035827637, gen p mean: -0.32990458607673645, mean p set: 0.4480918347835541
loss_pred:0.041745223104953766, decouple_loss:0.03402497246861458
loss_pred:0.04206018149852753, decouple_loss:0.03254197537899017
The modified gen p mean: 0.4470902979373932, gen p mean: -0.3329125940799713, mean p set: 0.4475705623626709
loss_pred:0.0404229462146759, decouple_loss:0.032930802553892136
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682765007019043, gen p mean: -0.33947980403900146, mean p set: 0.4473079442977905
The modified gen p mean: 0.4473397135734558, gen p mean: -0.33232641220092773, mean p set: 0.4478200376033783
loss_pred:0.03996512293815613, decouple_loss:0.0318027138710022
loss_pred:0.041194163262844086, decouple_loss:0.03228004276752472
The modified gen p mean: 0.4488238990306854, gen p mean: -0.33980828523635864, mean p set: 0.44930416345596313
loss_pred:0.03994238004088402, decouple_loss:0.03266416862607002
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471854567527771, gen p mean: -0.3356853425502777, mean p set: 0.4476657211780548
loss_pred:0.04036051034927368, decouple_loss:0.032083261758089066
The modified gen p mean: 0.44862884283065796, gen p mean: -0.33635127544403076, mean p set: 0.44910916686058044The modified gen p mean: 0.4480040669441223, gen p mean: -0.3415279984474182, mean p set: 0.4484843611717224
loss_pred:0.04187595844268799, decouple_loss:0.03272588923573494
loss_pred:0.039989229291677475, decouple_loss:0.03319178894162178
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812625646591187, gen p mean: -0.33436256647109985, mean p set: 0.44860655069351196
loss_pred:0.040425654500722885, decouple_loss:0.03614071011543274
The modified gen p mean: 0.446834534406662, gen p mean: -0.342414528131485, mean p set: 0.4473148286342621The modified gen p mean: 0.4482946991920471, gen p mean: -0.3355386555194855, mean p set: 0.4487749934196472
loss_pred:0.0405634269118309, decouple_loss:0.03411688283085823
loss_pred:0.04136253893375397, decouple_loss:0.03436277434229851
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778740406036377, gen p mean: -0.3365338146686554, mean p set: 0.4482676684856415
The modified gen p mean: 0.4470285177230835, gen p mean: -0.3368838429450989, mean p set: 0.4475088119506836
loss_pred:0.04239188879728317, decouple_loss:0.0366692952811718
loss_pred:0.042180005460977554, decouple_loss:0.035960160195827484
The modified gen p mean: 0.44653695821762085, gen p mean: -0.3422885239124298, mean p set: 0.44701725244522095
loss_pred:0.04125537723302841, decouple_loss:0.03592947870492935
2023-05-01 17:14:03 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.3486907482147217, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.3422023057937622, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.34037354588508606, mean p set: 0.45035696029663086
loss_pred:0.04201311618089676, decouple_loss:0.0332585871219635
loss_pred:0.04081490635871887, decouple_loss:0.03249279409646988
loss_pred:0.03997616842389107, decouple_loss:0.03346630558371544
WV_0_PC_1_EH_0_PS_40_5, loss: 0.042588360607624054, avg_mse: 0.04383308067917824
current test mse: 0.043833
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481607973575592, gen p mean: -0.3465057909488678, mean p set: 0.4486410617828369
loss_pred:0.03977961465716362, decouple_loss:0.03376394510269165
The modified gen p mean: 0.44780397415161133, gen p mean: -0.33878979086875916, mean p set: 0.4482842683792114The modified gen p mean: 0.44769522547721863, gen p mean: -0.3478130102157593, mean p set: 0.4481755197048187
loss_pred:0.039656106382608414, decouple_loss:0.03372268006205559
loss_pred:0.04215574637055397, decouple_loss:0.03512904793024063
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478897452354431, gen p mean: -0.3420999348163605, mean p set: 0.4483700692653656
The modified gen p mean: 0.4480413794517517, gen p mean: -0.34154534339904785, mean p set: 0.4485217034816742
loss_pred:0.03809808939695358, decouple_loss:0.03353063017129898
loss_pred:0.038714710623025894, decouple_loss:0.03454621508717537
The modified gen p mean: 0.4470593333244324, gen p mean: -0.3429107069969177, mean p set: 0.44753962755203247
loss_pred:0.03991394117474556, decouple_loss:0.031917504966259
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447689026594162, gen p mean: -0.3298508822917938, mean p set: 0.4481693506240845
The modified gen p mean: 0.4494800567626953, gen p mean: -0.32507506012916565, mean p set: 0.4499603509902954loss_pred:0.0393742173910141, decouple_loss:0.033294569700956345
The modified gen p mean: 0.4481104910373688, gen p mean: -0.3325309455394745, mean p set: 0.44859078526496887
loss_pred:0.040947917848825455, decouple_loss:0.03541896864771843
loss_pred:0.039285678416490555, decouple_loss:0.03375336900353432
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449092298746109, gen p mean: -0.32448557019233704, mean p set: 0.4495725929737091
The modified gen p mean: 0.44715616106987, gen p mean: -0.33239078521728516, mean p set: 0.4476364552974701
loss_pred:0.04082442820072174, decouple_loss:0.034225113689899445
loss_pred:0.041263923048973083, decouple_loss:0.03379513695836067
The modified gen p mean: 0.44735175371170044, gen p mean: -0.3301575481891632, mean p set: 0.44783204793930054
loss_pred:0.04174351319670677, decouple_loss:0.03385490924119949
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768840074539185, gen p mean: -0.3310718238353729, mean p set: 0.44816869497299194
The modified gen p mean: 0.4473233222961426, gen p mean: -0.33023518323898315, mean p set: 0.44780364632606506loss_pred:0.040419843047857285, decouple_loss:0.0337352491915226
The modified gen p mean: 0.4485373795032501, gen p mean: -0.32004374265670776, mean p set: 0.4490176737308502
loss_pred:0.03988977149128914, decouple_loss:0.03346960246562958
loss_pred:0.040307994931936264, decouple_loss:0.03579716756939888
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785022735595703, gen p mean: -0.332407683134079, mean p set: 0.4483305513858795
The modified gen p mean: 0.44764888286590576, gen p mean: -0.3325504660606384, mean p set: 0.44812917709350586
loss_pred:0.04177858307957649, decouple_loss:0.033963046967983246
loss_pred:0.040488678961992264, decouple_loss:0.033046141266822815
The modified gen p mean: 0.44794023036956787, gen p mean: -0.3340398073196411, mean p set: 0.44842052459716797
loss_pred:0.04081830382347107, decouple_loss:0.03264353796839714
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488285779953003, gen p mean: -0.3351761996746063, mean p set: 0.449308842420578
The modified gen p mean: 0.44720175862312317, gen p mean: -0.32882729172706604, mean p set: 0.44768205285072327
loss_pred:0.038776371628046036, decouple_loss:0.03365129604935646
loss_pred:0.04250138998031616, decouple_loss:0.03334137424826622
The modified gen p mean: 0.44788751006126404, gen p mean: -0.33014076948165894, mean p set: 0.44836780428886414
loss_pred:0.04247913137078285, decouple_loss:0.033327482640743256
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447274774312973, gen p mean: -0.3357115685939789, mean p set: 0.44775503873825073
The modified gen p mean: 0.4473905563354492, gen p mean: -0.32888221740722656, mean p set: 0.4478708505630493
loss_pred:0.04044072702527046, decouple_loss:0.033056486397981644
The modified gen p mean: 0.4473133385181427, gen p mean: -0.33912375569343567, mean p set: 0.4477936327457428loss_pred:0.04063377529382706, decouple_loss:0.03461044281721115
loss_pred:0.03914395719766617, decouple_loss:0.033845141530036926
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471130669116974, gen p mean: -0.3360479772090912, mean p set: 0.4475933611392975
loss_pred:0.041686926037073135, decouple_loss:0.03312646225094795
The modified gen p mean: 0.44808363914489746, gen p mean: -0.3290356993675232, mean p set: 0.44856393337249756The modified gen p mean: 0.4474720358848572, gen p mean: -0.33461520075798035, mean p set: 0.4479523003101349
loss_pred:0.0426282174885273, decouple_loss:0.03567039966583252
loss_pred:0.040988434106111526, decouple_loss:0.035898081958293915
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467989206314087, gen p mean: -0.3410874009132385, mean p set: 0.4472792148590088
The modified gen p mean: 0.4486341178417206, gen p mean: -0.3332529067993164, mean p set: 0.4491144120693207
loss_pred:0.040737587958574295, decouple_loss:0.032470159232616425
loss_pred:0.040740966796875, decouple_loss:0.035183269530534744The modified gen p mean: 0.44773584604263306, gen p mean: -0.335986465215683, mean p set: 0.44821614027023315
loss_pred:0.04103512689471245, decouple_loss:0.03253405541181564
2023-05-01 17:16:10 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.34849393367767334, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.339610755443573, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.34220123291015625, mean p set: 0.4500633478164673
loss_pred:0.04157615825533867, decouple_loss:0.03411441296339035
loss_pred:0.03963359072804451, decouple_loss:0.034443166106939316
loss_pred:0.04043169692158699, decouple_loss:0.033826157450675964
WV_0_PC_1_EH_0_PS_40_5, loss: 0.04225354641675949, avg_mse: 0.04350416362285614
current test mse: 0.043504
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797784090042114, gen p mean: -0.34531453251838684, mean p set: 0.44845813512802124
The modified gen p mean: 0.44765567779541016, gen p mean: -0.34603118896484375, mean p set: 0.44813597202301025
loss_pred:0.04076029732823372, decouple_loss:0.0324724055826664
The modified gen p mean: 0.44741091132164, gen p mean: -0.3406597971916199, mean p set: 0.4478912055492401
loss_pred:0.038325659930706024, decouple_loss:0.033595625311136246
loss_pred:0.04128025472164154, decouple_loss:0.0317721962928772
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766753911972046, gen p mean: -0.34725674986839294, mean p set: 0.44814783334732056
loss_pred:0.040990881621837616, decouple_loss:0.03441929444670677
The modified gen p mean: 0.4486345052719116, gen p mean: -0.3454931378364563, mean p set: 0.4491148293018341The modified gen p mean: 0.44776228070259094, gen p mean: -0.34110623598098755, mean p set: 0.44824254512786865
loss_pred:0.04234868288040161, decouple_loss:0.03482925146818161
loss_pred:0.03938310965895653, decouple_loss:0.03223169595003128
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468989074230194, gen p mean: -0.35355180501937866, mean p set: 0.4473792016506195
loss_pred:0.039990901947021484, decouple_loss:0.032470524311065674
The modified gen p mean: 0.4490791857242584, gen p mean: -0.34488487243652344, mean p set: 0.4495594799518585The modified gen p mean: 0.4471355676651001, gen p mean: -0.34467846155166626, mean p set: 0.4476158618927002
loss_pred:0.039681483060121536, decouple_loss:0.035226453095674515
loss_pred:0.04137037321925163, decouple_loss:0.03353068605065346
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797438383102417, gen p mean: -0.3437686264514923, mean p set: 0.44845467805862427
The modified gen p mean: 0.44757816195487976, gen p mean: -0.35247567296028137, mean p set: 0.44805845618247986
loss_pred:0.03912869095802307, decouple_loss:0.03243609517812729
loss_pred:0.039756327867507935, decouple_loss:0.033596284687519073The modified gen p mean: 0.44962751865386963, gen p mean: -0.34583428502082825, mean p set: 0.45010778307914734
loss_pred:0.039575353264808655, decouple_loss:0.033716943114995956
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704321026802063, gen p mean: -0.34102070331573486, mean p set: 0.4475235044956207
The modified gen p mean: 0.4475351870059967, gen p mean: -0.34333711862564087, mean p set: 0.4480154812335968
loss_pred:0.03897957503795624, decouple_loss:0.03295576572418213
loss_pred:0.038524653762578964, decouple_loss:0.03251370042562485
The modified gen p mean: 0.44668814539909363, gen p mean: -0.3401128649711609, mean p set: 0.4471684396266937
loss_pred:0.041820552200078964, decouple_loss:0.03347277641296387
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870510697364807, gen p mean: -0.33819282054901123, mean p set: 0.44918543100357056
The modified gen p mean: 0.44815152883529663, gen p mean: -0.33918532729148865, mean p set: 0.44863179326057434
loss_pred:0.038436777889728546, decouple_loss:0.03460777550935745
loss_pred:0.03799551725387573, decouple_loss:0.03409694880247116
The modified gen p mean: 0.4481147825717926, gen p mean: -0.33819112181663513, mean p set: 0.4485950767993927
loss_pred:0.039385899901390076, decouple_loss:0.03325744718313217
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774553179740906, gen p mean: -0.33893629908561707, mean p set: 0.44822585582733154
loss_pred:0.041207995265722275, decouple_loss:0.032307881861925125
The modified gen p mean: 0.4471811056137085, gen p mean: -0.3410434126853943, mean p set: 0.4476613700389862The modified gen p mean: 0.44750165939331055, gen p mean: -0.3401238024234772, mean p set: 0.44798195362091064
loss_pred:0.04132906347513199, decouple_loss:0.03261829540133476
loss_pred:0.03964776545763016, decouple_loss:0.03216235339641571
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475812315940857, gen p mean: -0.3431681990623474, mean p set: 0.4480615258216858
loss_pred:0.039514537900686264, decouple_loss:0.03194311633706093
The modified gen p mean: 0.44857919216156006, gen p mean: -0.34380972385406494, mean p set: 0.44905948638916016The modified gen p mean: 0.44720327854156494, gen p mean: -0.3449954390525818, mean p set: 0.4476836025714874
loss_pred:0.04101026430726051, decouple_loss:0.033221032470464706
loss_pred:0.03980199247598648, decouple_loss:0.032312966883182526
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
NaN value num: 0
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160409808158875, gen p mean: -0.355055570602417, mean p set: 0.45208439230918884
loss_pred:0.0422859787940979, decouple_loss:0.040344081819057465
The modified gen p mean: 0.4523484706878662, gen p mean: -0.3483421802520752, mean p set: 0.4528287649154663The modified gen p mean: 0.4512999355792999, gen p mean: -0.355470210313797, mean p set: 0.4517802298069
loss_pred:0.041478563100099564, decouple_loss:0.03616859391331673
loss_pred:0.04130659997463226, decouple_loss:0.03909941390156746
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513068199157715, gen p mean: -0.35149094462394714, mean p set: 0.4517871141433716
loss_pred:0.04192498326301575, decouple_loss:0.03796360269188881
The modified gen p mean: 0.4515686333179474, gen p mean: -0.34854745864868164, mean p set: 0.4520488977432251The modified gen p mean: 0.4497564733028412, gen p mean: -0.35233762860298157, mean p set: 0.45023679733276367
loss_pred:0.04163528233766556, decouple_loss:0.03512539714574814
loss_pred:0.04086708649992943, decouple_loss:0.03708144277334213
2023-05-01 17:19:01 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.3411472737789154, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3319017291069031, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.33663785457611084, mean p set: 0.4500633478164673
loss_pred:0.041648972779512405, decouple_loss:0.03567902743816376
loss_pred:0.039684902876615524, decouple_loss:0.03605825453996658
loss_pred:0.04047517105937004, decouple_loss:0.034879956394433975
WV_0_PC_1_EH_0_PS_40_5, loss: 0.04237997159361839, avg_mse: 0.043802253901958466
current test mse: 0.043802
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896623492240906, gen p mean: -0.33902114629745483, mean p set: 0.44944655895233154
The modified gen p mean: 0.4513000547885895, gen p mean: -0.34026914834976196, mean p set: 0.4517803192138672
loss_pred:0.04358489438891411, decouple_loss:0.03702829033136368
The modified gen p mean: 0.45040133595466614, gen p mean: -0.33099886775016785, mean p set: 0.4508816599845886
loss_pred:0.04053781181573868, decouple_loss:0.03585226833820343
loss_pred:0.04000486060976982, decouple_loss:0.03870691359043121
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841817021369934, gen p mean: -0.3409177362918854, mean p set: 0.44889846444129944
The modified gen p mean: 0.4498480260372162, gen p mean: -0.3331708014011383, mean p set: 0.4503283202648163
loss_pred:0.043645717203617096, decouple_loss:0.03671872615814209
loss_pred:0.04006192088127136, decouple_loss:0.036578718572854996
The modified gen p mean: 0.45121562480926514, gen p mean: -0.3311123549938202, mean p set: 0.4516959488391876
loss_pred:0.040428277105093, decouple_loss:0.035606469959020615
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502875506877899, gen p mean: -0.3527778089046478, mean p set: 0.4507678747177124
The modified gen p mean: 0.4511454701423645, gen p mean: -0.351141095161438, mean p set: 0.451625794172287
loss_pred:0.0407765656709671, decouple_loss:0.03588405251502991
loss_pred:0.04019149765372276, decouple_loss:0.03540391847491264
The modified gen p mean: 0.4502315819263458, gen p mean: -0.35176417231559753, mean p set: 0.4507118761539459
loss_pred:0.04162818193435669, decouple_loss:0.036500483751297
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880664348602295, gen p mean: -0.35707613825798035, mean p set: 0.44928696751594543
The modified gen p mean: 0.44930869340896606, gen p mean: -0.3556845188140869, mean p set: 0.44978898763656616
loss_pred:0.039129044860601425, decouple_loss:0.03514081984758377
loss_pred:0.03977447375655174, decouple_loss:0.03511269763112068
The modified gen p mean: 0.45008283853530884, gen p mean: -0.3550799787044525, mean p set: 0.4505631625652313
loss_pred:0.03987766057252884, decouple_loss:0.034432511776685715
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44989413022994995, gen p mean: -0.35744914412498474, mean p set: 0.45037439465522766
The modified gen p mean: 0.4518994688987732, gen p mean: -0.34562644362449646, mean p set: 0.4523797929286957
loss_pred:0.04019860923290253, decouple_loss:0.03617965430021286
loss_pred:0.040317896753549576, decouple_loss:0.03550366312265396
The modified gen p mean: 0.45013299584388733, gen p mean: -0.3570941388607025, mean p set: 0.4506132900714874
loss_pred:0.04242710396647453, decouple_loss:0.0355619415640831
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507538080215454, gen p mean: -0.3612833023071289, mean p set: 0.4512340724468231
The modified gen p mean: 0.45015671849250793, gen p mean: -0.36341917514801025, mean p set: 0.4506370425224304
loss_pred:0.04242516681551933, decouple_loss:0.03612258657813072
loss_pred:0.04493798688054085, decouple_loss:0.03794880211353302
The modified gen p mean: 0.45012643933296204, gen p mean: -0.35984185338020325, mean p set: 0.45060670375823975
loss_pred:0.04167065769433975, decouple_loss:0.03515341877937317
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933953881263733, gen p mean: -0.3583502173423767, mean p set: 0.4498198330402374
The modified gen p mean: 0.4510978162288666, gen p mean: -0.34762388467788696, mean p set: 0.4515781104564667loss_pred:0.04087160527706146, decouple_loss:0.03528447076678276
The modified gen p mean: 0.44856712222099304, gen p mean: -0.3532784879207611, mean p set: 0.44904741644859314
loss_pred:0.03916080668568611, decouple_loss:0.037138503044843674
loss_pred:0.042985208332538605, decouple_loss:0.03498862683773041
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169180631637573, gen p mean: -0.35943272709846497, mean p set: 0.45217210054397583
loss_pred:0.04203851521015167, decouple_loss:0.0370483472943306
The modified gen p mean: 0.45015203952789307, gen p mean: -0.3562590777873993, mean p set: 0.4506323039531708The modified gen p mean: 0.4489753246307373, gen p mean: -0.3534349799156189, mean p set: 0.4494556486606598
loss_pred:0.04015728086233139, decouple_loss:0.034643493592739105
loss_pred:0.041866764426231384, decouple_loss:0.0349506214261055
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497143030166626, gen p mean: -0.36310264468193054, mean p set: 0.4501945972442627
The modified gen p mean: 0.4523080587387085, gen p mean: -0.3655301630496979, mean p set: 0.452788382768631
loss_pred:0.04183674603700638, decouple_loss:0.033381085842847824
loss_pred:0.04228118807077408, decouple_loss:0.03426176682114601
The modified gen p mean: 0.4504311978816986, gen p mean: -0.35585817694664, mean p set: 0.4509114921092987
loss_pred:0.039008162915706635, decouple_loss:0.03395550325512886
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884514808654785, gen p mean: -0.35963940620422363, mean p set: 0.44932547211647034
loss_pred:0.04137365147471428, decouple_loss:0.033124279230833054
The modified gen p mean: 0.4499150514602661, gen p mean: -0.3646426796913147, mean p set: 0.4503953158855438The modified gen p mean: 0.4495391845703125, gen p mean: -0.35803496837615967, mean p set: 0.4500194787979126
loss_pred:0.04028205946087837, decouple_loss:0.033723872154951096
loss_pred:0.04127445071935654, decouple_loss:0.03340790048241615
2023-05-01 17:21:10 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.3515606224536896, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.34541818499565125, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.34210148453712463, mean p set: 0.45035696029663086
loss_pred:0.04209063947200775, decouple_loss:0.037118732929229736
loss_pred:0.04098234698176384, decouple_loss:0.03614552319049835
loss_pred:0.03999284282326698, decouple_loss:0.03746596351265907
WV_0_PC_1_EH_0_PS_40_5, loss: 0.042867448180913925, avg_mse: 0.044503677636384964
current test mse: 0.044504
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487839937210083, gen p mean: -0.34689658880233765, mean p set: 0.4492642879486084
loss_pred:0.03964400663971901, decouple_loss:0.034036166965961456
The modified gen p mean: 0.4505697786808014, gen p mean: -0.34749990701675415, mean p set: 0.4510500431060791The modified gen p mean: 0.4519163966178894, gen p mean: -0.34318870306015015, mean p set: 0.4523966908454895
loss_pred:0.03942948207259178, decouple_loss:0.03387206420302391
loss_pred:0.0409407801926136, decouple_loss:0.03428924083709717
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514380693435669, gen p mean: -0.35276782512664795, mean p set: 0.4519183933734894
loss_pred:0.03904274106025696, decouple_loss:0.033515430986881256
The modified gen p mean: 0.4499926269054413, gen p mean: -0.3597979247570038, mean p set: 0.4504729211330414The modified gen p mean: 0.45228272676467896, gen p mean: -0.3585563600063324, mean p set: 0.45276302099227905
loss_pred:0.04197746515274048, decouple_loss:0.03473949059844017
loss_pred:0.040943510830402374, decouple_loss:0.032250434160232544
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510286748409271, gen p mean: -0.3708688020706177, mean p set: 0.4515089690685272
The modified gen p mean: 0.4493047595024109, gen p mean: -0.37246406078338623, mean p set: 0.449785053730011
loss_pred:0.041167251765728, decouple_loss:0.03224676474928856
loss_pred:0.04097355157136917, decouple_loss:0.0327816903591156
The modified gen p mean: 0.4498899281024933, gen p mean: -0.36815306544303894, mean p set: 0.45037025213241577
loss_pred:0.04129047319293022, decouple_loss:0.0343463160097599
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519050717353821, gen p mean: -0.37442252039909363, mean p set: 0.4523853361606598
The modified gen p mean: 0.45040571689605713, gen p mean: -0.3740379214286804, mean p set: 0.4508860111236572
loss_pred:0.04127610847353935, decouple_loss:0.033202823251485825
loss_pred:0.04040686413645744, decouple_loss:0.03361720219254494
The modified gen p mean: 0.4513561427593231, gen p mean: -0.3597380220890045, mean p set: 0.4518364667892456
loss_pred:0.039828866720199585, decouple_loss:0.03357984125614166
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45132601261138916, gen p mean: -0.37533965706825256, mean p set: 0.45180633664131165
loss_pred:0.04166276380419731, decouple_loss:0.03347960487008095
The modified gen p mean: 0.45046737790107727, gen p mean: -0.3777995705604553, mean p set: 0.45094767212867737The modified gen p mean: 0.44992178678512573, gen p mean: -0.37497052550315857, mean p set: 0.4504021108150482
loss_pred:0.04506240785121918, decouple_loss:0.03610340505838394
loss_pred:0.04362162575125694, decouple_loss:0.03371632471680641
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001593232154846, gen p mean: -0.36524698138237, mean p set: 0.45049622654914856
The modified gen p mean: 0.4513264298439026, gen p mean: -0.3644022047519684, mean p set: 0.4518067240715027
loss_pred:0.04128876328468323, decouple_loss:0.0335819348692894
loss_pred:0.038526393473148346, decouple_loss:0.03506597876548767
The modified gen p mean: 0.449628621339798, gen p mean: -0.37141144275665283, mean p set: 0.45010891556739807
loss_pred:0.03992852568626404, decouple_loss:0.03364620730280876
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915157556533813, gen p mean: -0.35495415329933167, mean p set: 0.44963186979293823
loss_pred:0.043257735669612885, decouple_loss:0.03515009209513664
The modified gen p mean: 0.4495828449726105, gen p mean: -0.3551410734653473, mean p set: 0.45006316900253296The modified gen p mean: 0.4519311189651489, gen p mean: -0.3546222448348999, mean p set: 0.452411413192749
loss_pred:0.040357477962970734, decouple_loss:0.03441629931330681
loss_pred:0.04125392809510231, decouple_loss:0.036004114896059036
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45094335079193115, gen p mean: -0.3635194003582001, mean p set: 0.45142364501953125
loss_pred:0.039915651082992554, decouple_loss:0.033313773572444916
The modified gen p mean: 0.451698362827301, gen p mean: -0.3561042547225952, mean p set: 0.4521786570549011The modified gen p mean: 0.450145959854126, gen p mean: -0.35418203473091125, mean p set: 0.4506262540817261
loss_pred:0.03820674121379852, decouple_loss:0.03307688608765602
loss_pred:0.038470882922410965, decouple_loss:0.03339383751153946
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
NaN value num: 0
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45176172256469727, gen p mean: -0.3725803792476654, mean p set: 0.45224204659461975
loss_pred:0.040922895073890686, decouple_loss:0.036460183560848236
The modified gen p mean: 0.4501146972179413, gen p mean: -0.36744925379753113, mean p set: 0.4505949914455414The modified gen p mean: 0.45087891817092896, gen p mean: -0.3727622330188751, mean p set: 0.45135921239852905
loss_pred:0.04189334064722061, decouple_loss:0.03534013032913208
loss_pred:0.03961975872516632, decouple_loss:0.035418521612882614
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512881934642792, gen p mean: -0.3783702850341797, mean p set: 0.4517684876918793
The modified gen p mean: 0.45067211985588074, gen p mean: -0.3730451464653015, mean p set: 0.4511524438858032
loss_pred:0.03937327116727829, decouple_loss:0.03676874563097954
loss_pred:0.04170350730419159, decouple_loss:0.03532988205552101
The modified gen p mean: 0.45097026228904724, gen p mean: -0.37560316920280457, mean p set: 0.4514505863189697
loss_pred:0.04004516825079918, decouple_loss:0.03500274568796158
2023-05-01 17:24:03 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.3749397099018097, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.36470797657966614, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.36825236678123474, mean p set: 0.4500633478164673
loss_pred:0.04177732393145561, decouple_loss:0.036263834685087204
loss_pred:0.039917394518852234, decouple_loss:0.03672656789422035
loss_pred:0.04075167328119278, decouple_loss:0.03522332385182381
WV_0_PC_1_EH_0_PS_40_5, loss: 0.04261902719736099, avg_mse: 0.0443149171769619
current test mse: 0.044315
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503439962863922, gen p mean: -0.3631711006164551, mean p set: 0.4508242905139923
The modified gen p mean: 0.4505423903465271, gen p mean: -0.369389146566391, mean p set: 0.4510226845741272
loss_pred:0.0394565723836422, decouple_loss:0.035201095044612885
The modified gen p mean: 0.4504566490650177, gen p mean: -0.3702884018421173, mean p set: 0.4509369432926178
loss_pred:0.03961922228336334, decouple_loss:0.03463629260659218
loss_pred:0.03951724246144295, decouple_loss:0.03442133590579033
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451802521944046, gen p mean: -0.35819190740585327, mean p set: 0.45228278636932373
The modified gen p mean: 0.45009326934814453, gen p mean: -0.35860997438430786, mean p set: 0.45057356357574463
loss_pred:0.038498055189847946, decouple_loss:0.036155082285404205
loss_pred:0.04233350604772568, decouple_loss:0.03525194898247719
The modified gen p mean: 0.45204994082450867, gen p mean: -0.3635876774787903, mean p set: 0.45253023505210876
loss_pred:0.040470682084560394, decouple_loss:0.03654422238469124
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077645778656006, gen p mean: -0.3618848919868469, mean p set: 0.45125675201416016
The modified gen p mean: 0.44994574785232544, gen p mean: -0.3649938702583313, mean p set: 0.4504260718822479
loss_pred:0.03992113843560219, decouple_loss:0.03604975715279579
loss_pred:0.040988076478242874, decouple_loss:0.036298610270023346
The modified gen p mean: 0.4505452811717987, gen p mean: -0.3638686537742615, mean p set: 0.4510255753993988
loss_pred:0.0399344339966774, decouple_loss:0.033895235508680344
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510155916213989, gen p mean: -0.37191641330718994, mean p set: 0.45149585604667664
The modified gen p mean: 0.45099037885665894, gen p mean: -0.3751157820224762, mean p set: 0.45147067308425903
loss_pred:0.03935152292251587, decouple_loss:0.032493893057107925
loss_pred:0.04027220234274864, decouple_loss:0.03442798927426338
The modified gen p mean: 0.45157966017723083, gen p mean: -0.37718281149864197, mean p set: 0.45205995440483093
loss_pred:0.03992585092782974, decouple_loss:0.0339445099234581
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490741193294525, gen p mean: -0.3757723867893219, mean p set: 0.449554443359375
loss_pred:0.04248048737645149, decouple_loss:0.03399203345179558
The modified gen p mean: 0.45169195532798767, gen p mean: -0.37918606400489807, mean p set: 0.45217224955558777The modified gen p mean: 0.45051661133766174, gen p mean: -0.3778010606765747, mean p set: 0.45099693536758423
loss_pred:0.03866664692759514, decouple_loss:0.03378782421350479
loss_pred:0.03933560475707054, decouple_loss:0.03508983924984932
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056188106536865, gen p mean: -0.37514442205429077, mean p set: 0.45104217529296875
The modified gen p mean: 0.4503180980682373, gen p mean: -0.37359946966171265, mean p set: 0.4507984220981598
loss_pred:0.03936896100640297, decouple_loss:0.03370596840977669
loss_pred:0.04110753536224365, decouple_loss:0.034452956169843674
The modified gen p mean: 0.44941446185112, gen p mean: -0.37387165427207947, mean p set: 0.4498947560787201
loss_pred:0.0402316115796566, decouple_loss:0.034682903438806534
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45200175046920776, gen p mean: -0.3830249309539795, mean p set: 0.45248204469680786
The modified gen p mean: 0.4513819217681885, gen p mean: -0.382457435131073, mean p set: 0.4518622159957886
loss_pred:0.03855004906654358, decouple_loss:0.0345662496984005
loss_pred:0.04035869985818863, decouple_loss:0.03348058462142944
The modified gen p mean: 0.4517207741737366, gen p mean: -0.38484370708465576, mean p set: 0.45220106840133667
loss_pred:0.03965156152844429, decouple_loss:0.034475911408662796
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509980082511902, gen p mean: -0.3945584297180176, mean p set: 0.4514783024787903
The modified gen p mean: 0.449474036693573, gen p mean: -0.3911970257759094, mean p set: 0.4499543607234955
loss_pred:0.041141316294670105, decouple_loss:0.03527091071009636
loss_pred:0.03816145285964012, decouple_loss:0.03296542167663574
The modified gen p mean: 0.45126044750213623, gen p mean: -0.39455723762512207, mean p set: 0.45174074172973633
loss_pred:0.03844654560089111, decouple_loss:0.033106978982686996
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45196449756622314, gen p mean: -0.40371909737586975, mean p set: 0.45244479179382324
The modified gen p mean: 0.45139259099960327, gen p mean: -0.4007202088832855, mean p set: 0.45187288522720337
The modified gen p mean: 0.4509517252445221, gen p mean: -0.39632654190063477, mean p set: 0.4514320194721222
loss_pred:0.03918641805648804, decouple_loss:0.033317361027002335
loss_pred:0.04000505805015564, decouple_loss:0.03367570787668228
loss_pred:0.04017771780490875, decouple_loss:0.033716507256031036
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494269788265228, gen p mean: -0.38925787806510925, mean p set: 0.4499072730541229
The modified gen p mean: 0.4500580132007599, gen p mean: -0.3887454867362976, mean p set: 0.45053830742836
The modified gen p mean: 0.450878381729126, gen p mean: -0.3959044814109802, mean p set: 0.4513586759567261
loss_pred:0.037078969180583954, decouple_loss:0.03297819569706917
loss_pred:0.03833170607686043, decouple_loss:0.032578155398368835
loss_pred:0.038426756858825684, decouple_loss:0.0322064645588398
2023-05-01 17:26:11 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.4028235673904419, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3929823935031891, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.39582929015159607, mean p set: 0.4500633478164673
loss_pred:0.04148675501346588, decouple_loss:0.037861526012420654
loss_pred:0.03951061889529228, decouple_loss:0.03895892575383186
loss_pred:0.04031553491950035, decouple_loss:0.03694283217191696
WV_0_PC_1_EH_0_PS_40_5, loss: 0.0423336923122406, avg_mse: 0.04402879253029823
current test mse: 0.044029
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514044225215912, gen p mean: -0.3973717987537384, mean p set: 0.4518847167491913
The modified gen p mean: 0.45314085483551025, gen p mean: -0.4042512774467468, mean p set: 0.45362117886543274
loss_pred:0.040937453508377075, decouple_loss:0.03362521529197693
The modified gen p mean: 0.45169538259506226, gen p mean: -0.3981085419654846, mean p set: 0.45217567682266235
loss_pred:0.03875434398651123, decouple_loss:0.03366513177752495
loss_pred:0.03891691565513611, decouple_loss:0.03111415170133114
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492076337337494, gen p mean: -0.4025576412677765, mean p set: 0.4496879279613495
The modified gen p mean: 0.45081281661987305, gen p mean: -0.404995858669281, mean p set: 0.45129311084747314
loss_pred:0.04200611263513565, decouple_loss:0.03447709605097771
loss_pred:0.038177140057086945, decouple_loss:0.03212562948465347
The modified gen p mean: 0.4506039619445801, gen p mean: -0.4024599492549896, mean p set: 0.4510842561721802
loss_pred:0.03837460279464722, decouple_loss:0.03139551728963852
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518599510192871, gen p mean: -0.4039532244205475, mean p set: 0.4523402452468872
The modified gen p mean: 0.4483369290828705, gen p mean: -0.39182567596435547, mean p set: 0.4488172233104706
loss_pred:0.03864872083067894, decouple_loss:0.03205200284719467
loss_pred:0.03999929502606392, decouple_loss:0.03552014008164406
The modified gen p mean: 0.45096805691719055, gen p mean: -0.3973295986652374, mean p set: 0.45144835114479065
loss_pred:0.03859806805849075, decouple_loss:0.033300988376140594
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521511495113373, gen p mean: -0.3931933641433716, mean p set: 0.4526314437389374
loss_pred:0.039146967232227325, decouple_loss:0.03409295156598091
The modified gen p mean: 0.4518822729587555, gen p mean: -0.3903872072696686, mean p set: 0.4523625671863556The modified gen p mean: 0.45023053884506226, gen p mean: -0.3884734511375427, mean p set: 0.45071083307266235
loss_pred:0.04102091118693352, decouple_loss:0.03380989283323288
loss_pred:0.03833309933543205, decouple_loss:0.03188805654644966
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503093957901001, gen p mean: -0.39516085386276245, mean p set: 0.4507897198200226
loss_pred:0.03761844336986542, decouple_loss:0.03093569166958332
The modified gen p mean: 0.4508303999900818, gen p mean: -0.39316225051879883, mean p set: 0.4513106644153595The modified gen p mean: 0.45119035243988037, gen p mean: -0.40102389454841614, mean p set: 0.45167064666748047
loss_pred:0.037885453552007675, decouple_loss:0.030477799475193024
loss_pred:0.038014695048332214, decouple_loss:0.03278855234384537
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912153482437134, gen p mean: -0.401812344789505, mean p set: 0.44960182905197144
The modified gen p mean: 0.452678382396698, gen p mean: -0.4087725281715393, mean p set: 0.4531586468219757
loss_pred:0.04085085168480873, decouple_loss:0.03354544937610626
loss_pred:0.039252158254384995, decouple_loss:0.034004632383584976
The modified gen p mean: 0.45236876606941223, gen p mean: -0.409278005361557, mean p set: 0.45284903049468994
loss_pred:0.04030932858586311, decouple_loss:0.03348911181092262
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449690043926239, gen p mean: -0.39347201585769653, mean p set: 0.4501703083515167
loss_pred:0.03676349297165871, decouple_loss:0.030361909419298172
The modified gen p mean: 0.4514085352420807, gen p mean: -0.39778608083724976, mean p set: 0.4518887996673584The modified gen p mean: 0.450955867767334, gen p mean: -0.39999380707740784, mean p set: 0.4514361619949341
loss_pred:0.03762578219175339, decouple_loss:0.03252671658992767
loss_pred:0.03781624510884285, decouple_loss:0.03197472169995308
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504815340042114, gen p mean: -0.38302358984947205, mean p set: 0.45096179842948914
loss_pred:0.04007577896118164, decouple_loss:0.03267689049243927
The modified gen p mean: 0.45327427983283997, gen p mean: -0.3938177227973938, mean p set: 0.45375457406044006The modified gen p mean: 0.44972294569015503, gen p mean: -0.38358014822006226, mean p set: 0.4502032399177551
loss_pred:0.04031269997358322, decouple_loss:0.030964339151978493
loss_pred:0.040783610194921494, decouple_loss:0.033498067408800125
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453771114349365, gen p mean: -0.3821445405483246, mean p set: 0.445857435464859
loss_pred:0.04175986722111702, decouple_loss:0.03961177542805672
The modified gen p mean: 0.44734692573547363, gen p mean: -0.39185649156570435, mean p set: 0.44782721996307373The modified gen p mean: 0.44634103775024414, gen p mean: -0.388148695230484, mean p set: 0.44682133197784424
loss_pred:0.03935837373137474, decouple_loss:0.038108427077531815
loss_pred:0.04008956998586655, decouple_loss:0.03845309838652611
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461154639720917, gen p mean: -0.3751365840435028, mean p set: 0.44659578800201416
loss_pred:0.039906054735183716, decouple_loss:0.03912699595093727
The modified gen p mean: 0.4463392496109009, gen p mean: -0.3765251636505127, mean p set: 0.446819543838501The modified gen p mean: 0.4460991322994232, gen p mean: -0.3769078552722931, mean p set: 0.4465794563293457
loss_pred:0.04147931933403015, decouple_loss:0.038283444941043854
loss_pred:0.04040882736444473, decouple_loss:0.03794302046298981
2023-05-01 17:28:56 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.3704199492931366, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3614795207977295, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.3634268343448639, mean p set: 0.4500633478164673
loss_pred:0.04099899157881737, decouple_loss:0.03648419305682182
loss_pred:0.03886089473962784, decouple_loss:0.037351254373788834
loss_pred:0.040046654641628265, decouple_loss:0.03535496070981026
WV_0_PC_1_EH_0_PS_40_5, loss: 0.04178868979215622, avg_mse: 0.043288759887218475
current test mse: 0.043289
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759321212768555, gen p mean: -0.363789439201355, mean p set: 0.44807347655296326
The modified gen p mean: 0.446067214012146, gen p mean: -0.3632715046405792, mean p set: 0.4465474784374237
loss_pred:0.03933729603886604, decouple_loss:0.03749890252947807
The modified gen p mean: 0.4465217888355255, gen p mean: -0.3722883462905884, mean p set: 0.4470020830631256
loss_pred:0.03907757252454758, decouple_loss:0.03686271607875824
loss_pred:0.03843948617577553, decouple_loss:0.03630606457591057
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661515951156616, gen p mean: -0.37029755115509033, mean p set: 0.44709545373916626
The modified gen p mean: 0.4463662803173065, gen p mean: -0.3659193813800812, mean p set: 0.446846604347229
loss_pred:0.03835105895996094, decouple_loss:0.03380850329995155
loss_pred:0.04061300307512283, decouple_loss:0.03451370447874069
The modified gen p mean: 0.44700536131858826, gen p mean: -0.3663327097892761, mean p set: 0.44748565554618835
loss_pred:0.03957553207874298, decouple_loss:0.035036034882068634
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679540395736694, gen p mean: -0.3664426803588867, mean p set: 0.44727569818496704
The modified gen p mean: 0.44698435068130493, gen p mean: -0.37419936060905457, mean p set: 0.44746461510658264
loss_pred:0.039237864315509796, decouple_loss:0.036041103303432465
loss_pred:0.038399022072553635, decouple_loss:0.03401527553796768The modified gen p mean: 0.44674137234687805, gen p mean: -0.36643746495246887, mean p set: 0.44722166657447815
loss_pred:0.04006640985608101, decouple_loss:0.035751357674598694
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484494626522064, gen p mean: -0.37610071897506714, mean p set: 0.4489297568798065
The modified gen p mean: 0.44681304693222046, gen p mean: -0.3780770003795624, mean p set: 0.44729331135749817
loss_pred:0.03858685865998268, decouple_loss:0.036136478185653687
loss_pred:0.04017939791083336, decouple_loss:0.03476068377494812
The modified gen p mean: 0.44605761766433716, gen p mean: -0.37610524892807007, mean p set: 0.44653791189193726
loss_pred:0.03920876234769821, decouple_loss:0.03551016375422478
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467034935951233, gen p mean: -0.3774409890174866, mean p set: 0.447183758020401
The modified gen p mean: 0.44758808612823486, gen p mean: -0.3789593577384949, mean p set: 0.44806838035583496
loss_pred:0.03963637351989746, decouple_loss:0.03403492644429207
loss_pred:0.037672560662031174, decouple_loss:0.03438342735171318
The modified gen p mean: 0.44756367802619934, gen p mean: -0.3783503472805023, mean p set: 0.4480440020561218
loss_pred:0.0373067632317543, decouple_loss:0.03447740152478218
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44610628485679626, gen p mean: -0.3756365478038788, mean p set: 0.44658660888671875
The modified gen p mean: 0.4477647840976715, gen p mean: -0.3755004405975342, mean p set: 0.4482450783252716
loss_pred:0.03933094069361687, decouple_loss:0.03369224816560745
loss_pred:0.03839816153049469, decouple_loss:0.03344542905688286
The modified gen p mean: 0.44530779123306274, gen p mean: -0.3741002082824707, mean p set: 0.44578808546066284
loss_pred:0.03894303739070892, decouple_loss:0.03481854125857353
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472530484199524, gen p mean: -0.3729936480522156, mean p set: 0.4477333426475525
The modified gen p mean: 0.4468380808830261, gen p mean: -0.37298375368118286, mean p set: 0.4473183751106262
loss_pred:0.04019622132182121, decouple_loss:0.0336078517138958
loss_pred:0.03860614076256752, decouple_loss:0.03306320309638977
The modified gen p mean: 0.44715139269828796, gen p mean: -0.3723469078540802, mean p set: 0.4476316571235657
loss_pred:0.03948485851287842, decouple_loss:0.03351225703954697
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680145382881165, gen p mean: -0.37848326563835144, mean p set: 0.44728177785873413
The modified gen p mean: 0.44643330574035645, gen p mean: -0.3737107515335083, mean p set: 0.44691362977027893
loss_pred:0.03814348950982094, decouple_loss:0.03421169891953468
loss_pred:0.03909258916974068, decouple_loss:0.03411560505628586
The modified gen p mean: 0.4468703269958496, gen p mean: -0.3692290782928467, mean p set: 0.4473506212234497
loss_pred:0.03886737674474716, decouple_loss:0.033338528126478195
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452042877674103, gen p mean: -0.36942294239997864, mean p set: 0.4456845819950104
The modified gen p mean: 0.44705235958099365, gen p mean: -0.3679411709308624, mean p set: 0.44753265380859375
loss_pred:0.03944544494152069, decouple_loss:0.0327487513422966
loss_pred:0.037520863115787506, decouple_loss:0.03388722240924835
The modified gen p mean: 0.4468212425708771, gen p mean: -0.3684275150299072, mean p set: 0.44730156660079956
loss_pred:0.038278479129076004, decouple_loss:0.0338066965341568
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465196132659912, gen p mean: -0.3754483461380005, mean p set: 0.4469999372959137The modified gen p mean: 0.44701677560806274, gen p mean: -0.3782547414302826, mean p set: 0.44749704003334045
loss_pred:0.03960242494940758, decouple_loss:0.0327468179166317loss_pred:0.038209740072488785, decouple_loss:0.03172173723578453
The modified gen p mean: 0.4467865526676178, gen p mean: -0.38223496079444885, mean p set: 0.4472668468952179
loss_pred:0.037396520376205444, decouple_loss:0.03233196213841438
2023-05-01 17:31:04 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.3814959228038788, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.3729899525642395, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.37524542212486267, mean p set: 0.4500633478164673
loss_pred:0.040206823498010635, decouple_loss:0.03359248861670494
loss_pred:0.038284286856651306, decouple_loss:0.03310825303196907
loss_pred:0.03919154405593872, decouple_loss:0.032553404569625854
WV_0_PC_1_EH_0_PS_40_5, loss: 0.04088179022073746, avg_mse: 0.04244234040379524
current test mse: 0.042442
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44657978415489197, gen p mean: -0.3768303394317627, mean p set: 0.44706007838249207
The modified gen p mean: 0.44643452763557434, gen p mean: -0.3825816512107849, mean p set: 0.44691479206085205
loss_pred:0.038249462842941284, decouple_loss:0.032440297305583954
The modified gen p mean: 0.44740480184555054, gen p mean: -0.37529700994491577, mean p set: 0.44788506627082825
loss_pred:0.037485696375370026, decouple_loss:0.031463198363780975
loss_pred:0.038688089698553085, decouple_loss:0.031784702092409134
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666972756385803, gen p mean: -0.3798137605190277, mean p set: 0.4471500515937805
loss_pred:0.03829815238714218, decouple_loss:0.030692188069224358
The modified gen p mean: 0.44671717286109924, gen p mean: -0.3816239535808563, mean p set: 0.44719746708869934The modified gen p mean: 0.4466235041618347, gen p mean: -0.37560200691223145, mean p set: 0.4471038281917572
loss_pred:0.03999697417020798, decouple_loss:0.033005256205797195
loss_pred:0.038068272173404694, decouple_loss:0.03095191717147827
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688060879707336, gen p mean: -0.3779207468032837, mean p set: 0.4473608434200287
The modified gen p mean: 0.44517549872398376, gen p mean: -0.37384337186813354, mean p set: 0.44565579295158386
loss_pred:0.038728099316358566, decouple_loss:0.0316338911652565
loss_pred:0.03775785118341446, decouple_loss:0.031454361975193024
The modified gen p mean: 0.4459965229034424, gen p mean: -0.37594810128211975, mean p set: 0.44647684693336487
loss_pred:0.04082784801721573, decouple_loss:0.03126450255513191
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469769597053528, gen p mean: -0.37530338764190674, mean p set: 0.4474572241306305
loss_pred:0.03771105408668518, decouple_loss:0.031199360266327858
The modified gen p mean: 0.4461234509944916, gen p mean: -0.3763273358345032, mean p set: 0.4466037154197693
The modified gen p mean: 0.44678202271461487, gen p mean: -0.38080132007598877, mean p set: 0.44726231694221497
loss_pred:0.03868270292878151, decouple_loss:0.030567103996872902
loss_pred:0.03826846182346344, decouple_loss:0.03265124931931496
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479460120201111, gen p mean: -0.3753315508365631, mean p set: 0.44842633605003357
The modified gen p mean: 0.44680383801460266, gen p mean: -0.37647902965545654, mean p set: 0.44728413224220276
loss_pred:0.03858691826462746, decouple_loss:0.032508961856365204
loss_pred:0.03791673108935356, decouple_loss:0.03066510334610939
The modified gen p mean: 0.44712939858436584, gen p mean: -0.3694131672382355, mean p set: 0.44760966300964355
loss_pred:0.039872076362371445, decouple_loss:0.030785303562879562
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44632676243782043, gen p mean: -0.376724511384964, mean p set: 0.44680705666542053
The modified gen p mean: 0.4466868042945862, gen p mean: -0.3740794360637665, mean p set: 0.4471670687198639
loss_pred:0.0391119047999382, decouple_loss:0.030961696058511734
loss_pred:0.0383891798555851, decouple_loss:0.031860657036304474
The modified gen p mean: 0.4456709921360016, gen p mean: -0.3764394223690033, mean p set: 0.4461512565612793
loss_pred:0.03868286311626434, decouple_loss:0.031227976083755493
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446666419506073, gen p mean: -0.372565358877182, mean p set: 0.4471467435359955
The modified gen p mean: 0.4472448229789734, gen p mean: -0.36976903676986694, mean p set: 0.4477251172065735
loss_pred:0.0374939888715744, decouple_loss:0.030041584745049477
loss_pred:0.03931155428290367, decouple_loss:0.02903997339308262
The modified gen p mean: 0.4470561742782593, gen p mean: -0.37062016129493713, mean p set: 0.4475364685058594
loss_pred:0.03716341778635979, decouple_loss:0.0295950286090374
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694983959198, gen p mean: -0.36952874064445496, mean p set: 0.4474301338195801
The modified gen p mean: 0.4477007985115051, gen p mean: -0.3640405535697937, mean p set: 0.44818106293678284
loss_pred:0.03955254703760147, decouple_loss:0.03132309019565582
loss_pred:0.0375836119055748, decouple_loss:0.03107568435370922
The modified gen p mean: 0.44656580686569214, gen p mean: -0.3632696866989136, mean p set: 0.44704607129096985
loss_pred:0.03773007541894913, decouple_loss:0.02967151440680027
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
NaN value num: 0
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45307406783103943, gen p mean: -0.37782660126686096, mean p set: 0.4535543620586395
loss_pred:0.03913727402687073, decouple_loss:0.03817930817604065
The modified gen p mean: 0.45237088203430176, gen p mean: -0.37898489832878113, mean p set: 0.45285114645957947The modified gen p mean: 0.4516751766204834, gen p mean: -0.373256117105484, mean p set: 0.4521554708480835
loss_pred:0.039906036108732224, decouple_loss:0.03705260157585144
loss_pred:0.03986270725727081, decouple_loss:0.03731478750705719
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511029124259949, gen p mean: -0.3850184381008148, mean p set: 0.45158323645591736
The modified gen p mean: 0.4517216682434082, gen p mean: -0.38487669825553894, mean p set: 0.4522019624710083
loss_pred:0.04096395522356033, decouple_loss:0.03852821886539459
loss_pred:0.04016740992665291, decouple_loss:0.03682854771614075
The modified gen p mean: 0.4502018690109253, gen p mean: -0.38370293378829956, mean p set: 0.450682133436203
loss_pred:0.04047699645161629, decouple_loss:0.034878481179475784
2023-05-01 17:33:48 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.3861691653728485, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.37451350688934326, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.3786914646625519, mean p set: 0.4500633478164673
loss_pred:0.04024195298552513, decouple_loss:0.035949040204286575
loss_pred:0.03821076080203056, decouple_loss:0.03641625493764877
loss_pred:0.03916053846478462, decouple_loss:0.0349215492606163
WV_0_PC_1_EH_0_PS_40_5, loss: 0.040992531925439835, avg_mse: 0.042421359568834305
current test mse: 0.042421
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107710361480713, gen p mean: -0.3769510090351105, mean p set: 0.4515573978424072
The modified gen p mean: 0.45111164450645447, gen p mean: -0.37560659646987915, mean p set: 0.45159196853637695
loss_pred:0.03871845453977585, decouple_loss:0.03716285899281502
The modified gen p mean: 0.45010125637054443, gen p mean: -0.3765755891799927, mean p set: 0.45058155059814453
loss_pred:0.04011263698339462, decouple_loss:0.03658254072070122
loss_pred:0.03945646435022354, decouple_loss:0.03670487925410271
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518786370754242, gen p mean: -0.3901749849319458, mean p set: 0.4523589313030243
loss_pred:0.03895624727010727, decouple_loss:0.03604470565915108
The modified gen p mean: 0.4511336088180542, gen p mean: -0.3819553852081299, mean p set: 0.4516139328479767The modified gen p mean: 0.4510782063007355, gen p mean: -0.3827168047428131, mean p set: 0.4515584707260132
loss_pred:0.041121337562799454, decouple_loss:0.0355975441634655
loss_pred:0.04023607075214386, decouple_loss:0.03553451970219612
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517934322357178, gen p mean: -0.3849000930786133, mean p set: 0.4522736966609955
The modified gen p mean: 0.45015791058540344, gen p mean: -0.38327425718307495, mean p set: 0.45063820481300354
loss_pred:0.038615498691797256, decouple_loss:0.034191884100437164
loss_pred:0.03903939574956894, decouple_loss:0.03435682877898216
The modified gen p mean: 0.45152682065963745, gen p mean: -0.38320061564445496, mean p set: 0.45200711488723755
loss_pred:0.040877796709537506, decouple_loss:0.03620529919862747
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502286911010742, gen p mean: -0.3634900748729706, mean p set: 0.4507089853286743
The modified gen p mean: 0.451174259185791, gen p mean: -0.3717576861381531, mean p set: 0.4516545534133911
loss_pred:0.03847964480519295, decouple_loss:0.03385182470083237
loss_pred:0.039604511111974716, decouple_loss:0.035023584961891174
The modified gen p mean: 0.45018839836120605, gen p mean: -0.3702103793621063, mean p set: 0.45066869258880615
loss_pred:0.039259761571884155, decouple_loss:0.033493492752313614
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099154114723206, gen p mean: -0.3790877163410187, mean p set: 0.45147183537483215
The modified gen p mean: 0.4516814649105072, gen p mean: -0.3724706470966339, mean p set: 0.4521616995334625
loss_pred:0.03792798891663551, decouple_loss:0.03225639462471008
loss_pred:0.039615534245967865, decouple_loss:0.03463376685976982
The modified gen p mean: 0.45104271173477173, gen p mean: -0.38303133845329285, mean p set: 0.4515230059623718
loss_pred:0.03821844235062599, decouple_loss:0.03315068408846855
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45158693194389343, gen p mean: -0.39543503522872925, mean p set: 0.45206722617149353
The modified gen p mean: 0.4524185061454773, gen p mean: -0.38219770789146423, mean p set: 0.452898770570755
loss_pred:0.03989100456237793, decouple_loss:0.03441290184855461
loss_pred:0.039179809391498566, decouple_loss:0.03550771251320839
The modified gen p mean: 0.45102861523628235, gen p mean: -0.3954683244228363, mean p set: 0.45150890946388245
loss_pred:0.0375785231590271, decouple_loss:0.03483281284570694
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504019320011139, gen p mean: -0.4122315049171448, mean p set: 0.450882226228714
The modified gen p mean: 0.4505321681499481, gen p mean: -0.4036502242088318, mean p set: 0.4510124921798706
loss_pred:0.038195881992578506, decouple_loss:0.03346303850412369
loss_pred:0.03808606415987015, decouple_loss:0.03338608145713806
The modified gen p mean: 0.4529097080230713, gen p mean: -0.4076066017150879, mean p set: 0.4533900320529938
loss_pred:0.036895375698804855, decouple_loss:0.03309860825538635
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512689709663391, gen p mean: -0.41455528140068054, mean p set: 0.4517492651939392
The modified gen p mean: 0.45073387026786804, gen p mean: -0.40968552231788635, mean p set: 0.45121413469314575
loss_pred:0.038424450904130936, decouple_loss:0.03323096036911011
loss_pred:0.03844376653432846, decouple_loss:0.03395302593708038
The modified gen p mean: 0.44992557168006897, gen p mean: -0.41103625297546387, mean p set: 0.45040586590766907
loss_pred:0.03768916428089142, decouple_loss:0.03379839286208153
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45063239336013794, gen p mean: -0.41402435302734375, mean p set: 0.45111268758773804
The modified gen p mean: 0.45098817348480225, gen p mean: -0.4084641635417938, mean p set: 0.45146840810775757
loss_pred:0.03788626194000244, decouple_loss:0.031637389212846756
loss_pred:0.038986947387456894, decouple_loss:0.033062081784009933
The modified gen p mean: 0.452144593000412, gen p mean: -0.4124857485294342, mean p set: 0.4526248872280121
loss_pred:0.039032116532325745, decouple_loss:0.03241667151451111
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519047439098358, gen p mean: -0.4054114520549774, mean p set: 0.4523850381374359
The modified gen p mean: 0.45241662859916687, gen p mean: -0.40942585468292236, mean p set: 0.4528968930244446
loss_pred:0.039567239582538605, decouple_loss:0.03281804546713829
loss_pred:0.03692629188299179, decouple_loss:0.03381330147385597
The modified gen p mean: 0.450790673494339, gen p mean: -0.4079408347606659, mean p set: 0.4512709379196167
loss_pred:0.038469914346933365, decouple_loss:0.032342907041311264
2023-05-01 17:35:56 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4178787171840668, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4057078957557678, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4104931056499481, mean p set: 0.4500633478164673
loss_pred:0.04018464684486389, decouple_loss:0.03592648357152939
loss_pred:0.038278236985206604, decouple_loss:0.03704708442091942
loss_pred:0.03920944407582283, decouple_loss:0.0353214405477047
WV_0_PC_1_EH_0_PS_40_5, loss: 0.041029028594493866, avg_mse: 0.042755842208862305
current test mse: 0.042756
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104217529296875, gen p mean: -0.40540507435798645, mean p set: 0.45152246952056885
The modified gen p mean: 0.4505290687084198, gen p mean: -0.4146191477775574, mean p set: 0.4510093629360199
loss_pred:0.038234200328588486, decouple_loss:0.03114638850092888
The modified gen p mean: 0.4509287178516388, gen p mean: -0.4057028293609619, mean p set: 0.4514089822769165
loss_pred:0.04025423154234886, decouple_loss:0.03434053808450699
loss_pred:0.03796311467885971, decouple_loss:0.03303072229027748
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45135343074798584, gen p mean: -0.4020653963088989, mean p set: 0.4518337547779083
The modified gen p mean: 0.45139825344085693, gen p mean: -0.4063025414943695, mean p set: 0.45187854766845703
loss_pred:0.03903676196932793, decouple_loss:0.03189471364021301
loss_pred:0.040035180747509, decouple_loss:0.031866371631622314
The modified gen p mean: 0.45027273893356323, gen p mean: -0.4038603901863098, mean p set: 0.45075303316116333
loss_pred:0.03717770054936409, decouple_loss:0.03287480026483536
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514961838722229, gen p mean: -0.40228477120399475, mean p set: 0.451976478099823
The modified gen p mean: 0.45177724957466125, gen p mean: -0.40507715940475464, mean p set: 0.45225754380226135
loss_pred:0.03843531385064125, decouple_loss:0.03362984210252762
loss_pred:0.038927141577005386, decouple_loss:0.03275247663259506
The modified gen p mean: 0.4515930414199829, gen p mean: -0.40082040429115295, mean p set: 0.452073335647583
loss_pred:0.03838059678673744, decouple_loss:0.03100493736565113
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501418471336365, gen p mean: -0.40816354751586914, mean p set: 0.4506221413612366
The modified gen p mean: 0.4506165683269501, gen p mean: -0.41058799624443054, mean p set: 0.4510968327522278
loss_pred:0.038646046072244644, decouple_loss:0.03201857954263687
loss_pred:0.038841910660266876, decouple_loss:0.03130028024315834
The modified gen p mean: 0.4507963955402374, gen p mean: -0.4088200330734253, mean p set: 0.4512766897678375
loss_pred:0.03843452036380768, decouple_loss:0.031649284064769745
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451937735080719, gen p mean: -0.4150153398513794, mean p set: 0.4524179995059967
loss_pred:0.03819498047232628, decouple_loss:0.03309657797217369
The modified gen p mean: 0.4504564106464386, gen p mean: -0.41721099615097046, mean p set: 0.4509367048740387
The modified gen p mean: 0.4507935345172882, gen p mean: -0.41448184847831726, mean p set: 0.4512738585472107
loss_pred:0.037123460322618484, decouple_loss:0.03271257132291794
loss_pred:0.03888154402375221, decouple_loss:0.03257458284497261
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508490264415741, gen p mean: -0.41406479477882385, mean p set: 0.4513293206691742
loss_pred:0.03821805119514465, decouple_loss:0.031574614346027374
The modified gen p mean: 0.45081135630607605, gen p mean: -0.4123583734035492, mean p set: 0.45129165053367615The modified gen p mean: 0.4497269093990326, gen p mean: -0.40894702076911926, mean p set: 0.4502072036266327
loss_pred:0.038715995848178864, decouple_loss:0.03212955221533775
loss_pred:0.037690017372369766, decouple_loss:0.031094025820493698
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051705837249756, gen p mean: -0.4072468876838684, mean p set: 0.45099735260009766
The modified gen p mean: 0.4509282410144806, gen p mean: -0.411968469619751, mean p set: 0.4514085352420807
loss_pred:0.03686770796775818, decouple_loss:0.031432561576366425
The modified gen p mean: 0.45123547315597534, gen p mean: -0.41155457496643066, mean p set: 0.4517157971858978
loss_pred:0.03758207708597183, decouple_loss:0.030251923948526382
loss_pred:0.03943592682480812, decouple_loss:0.031335070729255676
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505757689476013, gen p mean: -0.40422511100769043, mean p set: 0.4510560631752014
The modified gen p mean: 0.4496847987174988, gen p mean: -0.40478387475013733, mean p set: 0.45016512274742126
loss_pred:0.03754599764943123, decouple_loss:0.03059329465031624
loss_pred:0.038231369107961655, decouple_loss:0.030625317245721817
The modified gen p mean: 0.45146703720092773, gen p mean: -0.4064626693725586, mean p set: 0.4519473612308502
loss_pred:0.03945697098970413, decouple_loss:0.03180330619215965
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
NaN value num: 0
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476509988307953, gen p mean: -0.4053057134151459, mean p set: 0.4481312930583954
loss_pred:0.03952065482735634, decouple_loss:0.0335024930536747
The modified gen p mean: 0.4501236379146576, gen p mean: -0.4155617952346802, mean p set: 0.4506039321422577The modified gen p mean: 0.4501817524433136, gen p mean: -0.4157569706439972, mean p set: 0.4506619870662689
loss_pred:0.03801475465297699, decouple_loss:0.0333506278693676
loss_pred:0.03884288668632507, decouple_loss:0.034128040075302124
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477916359901428, gen p mean: -0.4038524925708771, mean p set: 0.44827190041542053
loss_pred:0.0378277413547039, decouple_loss:0.03246951848268509
The modified gen p mean: 0.44882693886756897, gen p mean: -0.405834436416626, mean p set: 0.44930723309516907The modified gen p mean: 0.4480643570423126, gen p mean: -0.40385666489601135, mean p set: 0.4485446512699127
loss_pred:0.03888317942619324, decouple_loss:0.03559698536992073
loss_pred:0.03836161270737648, decouple_loss:0.032443735748529434
2023-05-01 17:38:42 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.4197894036769867, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.40905481576919556, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.41323012113571167, mean p set: 0.4500633478164673
loss_pred:0.03986072912812233, decouple_loss:0.03589931130409241
loss_pred:0.03813539817929268, decouple_loss:0.036956872791051865
loss_pred:0.03924572095274925, decouple_loss:0.03463306650519371
WV_0_PC_1_EH_0_PS_40_5, loss: 0.040872104465961456, avg_mse: 0.04274718835949898
current test mse: 0.042747
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478349983692169, gen p mean: -0.4029979109764099, mean p set: 0.44831526279449463
The modified gen p mean: 0.4505389928817749, gen p mean: -0.4100348949432373, mean p set: 0.451019287109375
loss_pred:0.037334367632865906, decouple_loss:0.03225797414779663
The modified gen p mean: 0.44756880402565, gen p mean: -0.40710610151290894, mean p set: 0.4480490982532501
loss_pred:0.04029414802789688, decouple_loss:0.033252958208322525
loss_pred:0.03835291415452957, decouple_loss:0.03275137394666672
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021122694015503, gen p mean: -0.40738123655319214, mean p set: 0.45069149136543274
The modified gen p mean: 0.45100706815719604, gen p mean: -0.40788745880126953, mean p set: 0.45148739218711853
loss_pred:0.03987125679850578, decouple_loss:0.033391401171684265
loss_pred:0.039769284427165985, decouple_loss:0.03545098379254341
The modified gen p mean: 0.45052462816238403, gen p mean: -0.40980297327041626, mean p set: 0.45100489258766174
loss_pred:0.03875201940536499, decouple_loss:0.034322142601013184
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018360018730164, gen p mean: -0.39209234714508057, mean p set: 0.45066389441490173
The modified gen p mean: 0.447966068983078, gen p mean: -0.3911614716053009, mean p set: 0.4484463632106781
loss_pred:0.03903284668922424, decouple_loss:0.033937662839889526
The modified gen p mean: 0.4473233222961426, gen p mean: -0.38859933614730835, mean p set: 0.44780364632606506
loss_pred:0.03774374723434448, decouple_loss:0.030578769743442535
loss_pred:0.03994416072964668, decouple_loss:0.030881857499480247
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480859339237213, gen p mean: -0.40006235241889954, mean p set: 0.4485662281513214
The modified gen p mean: 0.447935551404953, gen p mean: -0.3969108462333679, mean p set: 0.4484158456325531
loss_pred:0.03899073228240013, decouple_loss:0.03249407932162285
loss_pred:0.03820903226733208, decouple_loss:0.031210895627737045
The modified gen p mean: 0.4500119984149933, gen p mean: -0.4085664451122284, mean p set: 0.45049232244491577
loss_pred:0.03705773875117302, decouple_loss:0.03432945907115936
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823694229125977, gen p mean: -0.4129577577114105, mean p set: 0.44871723651885986
The modified gen p mean: 0.4502337872982025, gen p mean: -0.4120331406593323, mean p set: 0.450714111328125
loss_pred:0.03855229541659355, decouple_loss:0.03209216892719269
loss_pred:0.03667131066322327, decouple_loss:0.03188219666481018
The modified gen p mean: 0.44973328709602356, gen p mean: -0.4174143075942993, mean p set: 0.45021358132362366
loss_pred:0.036409638822078705, decouple_loss:0.03235408291220665
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751405715942383, gen p mean: -0.41429194808006287, mean p set: 0.44799432158470154
The modified gen p mean: 0.4512284994125366, gen p mean: -0.4166276752948761, mean p set: 0.4517087936401367loss_pred:0.037646010518074036, decouple_loss:0.0302859116345644
The modified gen p mean: 0.4474199414253235, gen p mean: -0.4130377471446991, mean p set: 0.44790026545524597
loss_pred:0.039821356534957886, decouple_loss:0.03353006765246391
loss_pred:0.03833338990807533, decouple_loss:0.03191008046269417
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880279898643494, gen p mean: -0.41468194127082825, mean p set: 0.4492831230163574
The modified gen p mean: 0.4500649571418762, gen p mean: -0.4100354313850403, mean p set: 0.45054522156715393
loss_pred:0.0384698323905468, decouple_loss:0.0328962616622448
loss_pred:0.039617735892534256, decouple_loss:0.03282466158270836
The modified gen p mean: 0.449690580368042, gen p mean: -0.4151025116443634, mean p set: 0.4501708745956421
loss_pred:0.0381505973637104, decouple_loss:0.03204827755689621
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448210209608078, gen p mean: -0.4159766435623169, mean p set: 0.4486904740333557
loss_pred:0.03719453886151314, decouple_loss:0.03128557279706001
The modified gen p mean: 0.44751742482185364, gen p mean: -0.41679632663726807, mean p set: 0.44799768924713135The modified gen p mean: 0.449078768491745, gen p mean: -0.41840654611587524, mean p set: 0.4495590925216675
loss_pred:0.03774363547563553, decouple_loss:0.03064495325088501
loss_pred:0.03803426772356033, decouple_loss:0.032388944178819656
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836822152137756, gen p mean: -0.4061254560947418, mean p set: 0.44884851574897766
The modified gen p mean: 0.4475097954273224, gen p mean: -0.40406322479248047, mean p set: 0.4479900598526001
loss_pred:0.03847150504589081, decouple_loss:0.032316904515028
loss_pred:0.0393371544778347, decouple_loss:0.0333944633603096
The modified gen p mean: 0.4495709240436554, gen p mean: -0.4087478816509247, mean p set: 0.4500511884689331
loss_pred:0.037839967757463455, decouple_loss:0.030826566740870476
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505366086959839, gen p mean: -0.3981780409812927, mean p set: 0.45101693272590637
loss_pred:0.03675274923443794, decouple_loss:0.03144583851099014
The modified gen p mean: 0.44767817854881287, gen p mean: -0.399908185005188, mean p set: 0.44815847277641296The modified gen p mean: 0.4502367079257965, gen p mean: -0.398589551448822, mean p set: 0.4507170021533966
loss_pred:0.038408778607845306, decouple_loss:0.03244640305638313
loss_pred:0.037456922233104706, decouple_loss:0.03151724115014076
2023-05-01 17:40:50 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4203404188156128, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.41381359100341797, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.41033098101615906, mean p set: 0.45035696029663086
loss_pred:0.03910161554813385, decouple_loss:0.03483850136399269
loss_pred:0.04011986404657364, decouple_loss:0.03661670908331871loss_pred:0.037972886115312576, decouple_loss:0.03610118851065636
WV_0_PC_1_EH_0_PS_40_5, loss: 0.04085739701986313, avg_mse: 0.042855557054281235
current test mse: 0.042856
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033854246139526, gen p mean: -0.41128647327423096, mean p set: 0.450818806886673
loss_pred:0.03918972611427307, decouple_loss:0.03153916820883751
The modified gen p mean: 0.44922035932540894, gen p mean: -0.41011980175971985, mean p set: 0.4497006833553314The modified gen p mean: 0.45021921396255493, gen p mean: -0.41115811467170715, mean p set: 0.45069950819015503
loss_pred:0.039609577506780624, decouple_loss:0.03173090144991875
loss_pred:0.037001412361860275, decouple_loss:0.031973253935575485
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963377714157104, gen p mean: -0.4123602509498596, mean p set: 0.45011407136917114
The modified gen p mean: 0.45038384199142456, gen p mean: -0.4147875905036926, mean p set: 0.45086413621902466
loss_pred:0.040057774633169174, decouple_loss:0.0322691835463047
loss_pred:0.037332430481910706, decouple_loss:0.0318327397108078
The modified gen p mean: 0.44820454716682434, gen p mean: -0.4131220877170563, mean p set: 0.44868484139442444
loss_pred:0.03742315247654915, decouple_loss:0.03083963505923748
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491611123085022, gen p mean: -0.4221765100955963, mean p set: 0.4496413767337799
The modified gen p mean: 0.4509035348892212, gen p mean: -0.4235484302043915, mean p set: 0.4513837993144989
loss_pred:0.038892146199941635, decouple_loss:0.032170191407203674
loss_pred:0.03805172070860863, decouple_loss:0.03102508932352066
The modified gen p mean: 0.4479018747806549, gen p mean: -0.4188237190246582, mean p set: 0.448382169008255
loss_pred:0.038419533520936966, decouple_loss:0.030864007771015167
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032650232315063, gen p mean: -0.435485303401947, mean p set: 0.45080679655075073
The modified gen p mean: 0.4497472047805786, gen p mean: -0.438161700963974, mean p set: 0.4502274990081787
loss_pred:0.03828264772891998, decouple_loss:0.03224407136440277
loss_pred:0.03586779534816742, decouple_loss:0.031380705535411835
The modified gen p mean: 0.44768667221069336, gen p mean: -0.4289270341396332, mean p set: 0.44816699624061584
loss_pred:0.03822799399495125, decouple_loss:0.0311899334192276
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475920796394348, gen p mean: -0.429332435131073, mean p set: 0.4480723738670349
The modified gen p mean: 0.44960716366767883, gen p mean: -0.42798978090286255, mean p set: 0.45008742809295654loss_pred:0.03778505697846413, decouple_loss:0.02956351451575756
The modified gen p mean: 0.4493815302848816, gen p mean: -0.4304755926132202, mean p set: 0.4498618245124817
loss_pred:0.03821754828095436, decouple_loss:0.03032013401389122
loss_pred:0.037415627390146255, decouple_loss:0.03182867541909218
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502882659435272, gen p mean: -0.4195219576358795, mean p set: 0.4507685601711273
The modified gen p mean: 0.44733551144599915, gen p mean: -0.4072832763195038, mean p set: 0.44781580567359924
loss_pred:0.03680810332298279, decouple_loss:0.032109424471855164
loss_pred:0.038300007581710815, decouple_loss:0.03056960180401802
The modified gen p mean: 0.45034468173980713, gen p mean: -0.4079025685787201, mean p set: 0.4508250057697296
loss_pred:0.038731373846530914, decouple_loss:0.03052399680018425
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992679357528687, gen p mean: -0.4088853895664215, mean p set: 0.4504070580005646
The modified gen p mean: 0.4492908716201782, gen p mean: -0.403712660074234, mean p set: 0.4497711658477783
loss_pred:0.0383976548910141, decouple_loss:0.030979277566075325
loss_pred:0.03928977623581886, decouple_loss:0.031053490936756134
The modified gen p mean: 0.4497394859790802, gen p mean: -0.4058060646057129, mean p set: 0.4502197206020355
loss_pred:0.03843223303556442, decouple_loss:0.030707547441124916
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969460368156433, gen p mean: -0.4223014712333679, mean p set: 0.45017489790916443
The modified gen p mean: 0.44863617420196533, gen p mean: -0.41940808296203613, mean p set: 0.44911646842956543
loss_pred:0.037927690893411636, decouple_loss:0.029665179550647736
loss_pred:0.0377572700381279, decouple_loss:0.029636576771736145
The modified gen p mean: 0.4480181336402893, gen p mean: -0.4183812439441681, mean p set: 0.4484984576702118
loss_pred:0.037673503160476685, decouple_loss:0.029808124527335167
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44952392578125, gen p mean: -0.43636250495910645, mean p set: 0.4500042200088501
loss_pred:0.03984953090548515, decouple_loss:0.03561163693666458
The modified gen p mean: 0.44927430152893066, gen p mean: -0.43363192677497864, mean p set: 0.44975459575653076The modified gen p mean: 0.4478687345981598, gen p mean: -0.43297165632247925, mean p set: 0.4483490288257599
loss_pred:0.039298031479120255, decouple_loss:0.03148973733186722
loss_pred:0.03959384188055992, decouple_loss:0.03443818911910057
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489775598049164, gen p mean: -0.4387857913970947, mean p set: 0.44945788383483887
The modified gen p mean: 0.4478866457939148, gen p mean: -0.43362173438072205, mean p set: 0.4483669102191925
loss_pred:0.03851022571325302, decouple_loss:0.0330345518887043
loss_pred:0.03874212130904198, decouple_loss:0.029752053320407867
The modified gen p mean: 0.44772836565971375, gen p mean: -0.4353111684322357, mean p set: 0.44820865988731384
loss_pred:0.03925919160246849, decouple_loss:0.03060435876250267
2023-05-01 17:43:36 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4350772798061371, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4246841371059418, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.42910972237586975, mean p set: 0.4500633478164673
loss_pred:0.039393533021211624, decouple_loss:0.03402017429471016
loss_pred:0.03739673271775246, decouple_loss:0.03444695100188255
loss_pred:0.038558632135391235, decouple_loss:0.032526567578315735
WV_0_PC_1_EH_0_PS_40_5, loss: 0.04013286158442497, avg_mse: 0.04203057289123535
current test mse: 0.042031
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481542408466339, gen p mean: -0.4265522062778473, mean p set: 0.448634535074234The modified gen p mean: 0.4488656222820282, gen p mean: -0.43002647161483765, mean p set: 0.4493459463119507
loss_pred:0.039425965398550034, decouple_loss:0.03434918820858002
The modified gen p mean: 0.4499039351940155, gen p mean: -0.43196073174476624, mean p set: 0.4503842294216156
loss_pred:0.03852931410074234, decouple_loss:0.030935849994421005
loss_pred:0.03974379971623421, decouple_loss:0.03133320435881615
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869935512542725, gen p mean: -0.42787015438079834, mean p set: 0.44917967915534973
loss_pred:0.038557764142751694, decouple_loss:0.031242426484823227
The modified gen p mean: 0.4481106400489807, gen p mean: -0.42633214592933655, mean p set: 0.4485909342765808The modified gen p mean: 0.4502018094062805, gen p mean: -0.42636391520500183, mean p set: 0.450682133436203
loss_pred:0.03915689140558243, decouple_loss:0.03119882196187973
loss_pred:0.03894531726837158, decouple_loss:0.03264133259654045
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491323232650757, gen p mean: -0.4346366822719574, mean p set: 0.4496126174926758
loss_pred:0.03818352892994881, decouple_loss:0.031447116285562515
The modified gen p mean: 0.4475764334201813, gen p mean: -0.4337286651134491, mean p set: 0.448056697845459The modified gen p mean: 0.4490791857242584, gen p mean: -0.43591153621673584, mean p set: 0.4495595097541809
loss_pred:0.038614269345998764, decouple_loss:0.030027834698557854
loss_pred:0.03728419914841652, decouple_loss:0.029738642275333405
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487565755844116, gen p mean: -0.43182939291000366, mean p set: 0.4492368996143341
loss_pred:0.03948970139026642, decouple_loss:0.031542111188173294
The modified gen p mean: 0.44880861043930054, gen p mean: -0.44311535358428955, mean p set: 0.449288934469223
The modified gen p mean: 0.4464895725250244, gen p mean: -0.44240862131118774, mean p set: 0.4469698667526245
loss_pred:0.03861069679260254, decouple_loss:0.030246181413531303
loss_pred:0.038555361330509186, decouple_loss:0.030766887590289116
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939926266670227, gen p mean: -0.4351653456687927, mean p set: 0.44987955689430237
loss_pred:0.03776144981384277, decouple_loss:0.0341869592666626
The modified gen p mean: 0.4494730532169342, gen p mean: -0.43248575925827026, mean p set: 0.4499533474445343The modified gen p mean: 0.4501529335975647, gen p mean: -0.4342813491821289, mean p set: 0.4506332576274872
loss_pred:0.038506362587213516, decouple_loss:0.03250478208065033
loss_pred:0.03721712902188301, decouple_loss:0.03228818252682686
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476395547389984, gen p mean: -0.42877086997032166, mean p set: 0.4481198489665985
The modified gen p mean: 0.4480966031551361, gen p mean: -0.4266619384288788, mean p set: 0.4485769271850586
loss_pred:0.038201235234737396, decouple_loss:0.02925287000834942
loss_pred:0.038639720529317856, decouple_loss:0.03191686049103737
The modified gen p mean: 0.4504079520702362, gen p mean: -0.43005260825157166, mean p set: 0.4508882462978363
loss_pred:0.03760072588920593, decouple_loss:0.030783457681536674
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910913705825806, gen p mean: -0.4249764084815979, mean p set: 0.44958946108818054
loss_pred:0.03867129236459732, decouple_loss:0.03103031776845455
The modified gen p mean: 0.44979003071784973, gen p mean: -0.43126562237739563, mean p set: 0.4502703547477722The modified gen p mean: 0.4491191506385803, gen p mean: -0.42536360025405884, mean p set: 0.4495994448661804
loss_pred:0.038704656064510345, decouple_loss:0.03190498426556587
loss_pred:0.03986353427171707, decouple_loss:0.03144029527902603
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901958107948303, gen p mean: -0.4177331328392029, mean p set: 0.44949984550476074
The modified gen p mean: 0.447726845741272, gen p mean: -0.41926535964012146, mean p set: 0.44820713996887207
loss_pred:0.03885532170534134, decouple_loss:0.03108568675816059
loss_pred:0.03915800526738167, decouple_loss:0.030445972457528114
The modified gen p mean: 0.44888004660606384, gen p mean: -0.41932523250579834, mean p set: 0.44936034083366394
loss_pred:0.03808826208114624, decouple_loss:0.03130669146776199
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484004080295563, gen p mean: -0.406704306602478, mean p set: 0.44888070225715637
The modified gen p mean: 0.44662219285964966, gen p mean: -0.41976720094680786, mean p set: 0.44710251688957214
loss_pred:0.03876147419214249, decouple_loss:0.03214200586080551
loss_pred:0.0383472703397274, decouple_loss:0.03227594494819641
The modified gen p mean: 0.4494432210922241, gen p mean: -0.41237205266952515, mean p set: 0.4499235153198242
loss_pred:0.03964589163661003, decouple_loss:0.032269276678562164
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487477242946625, gen p mean: -0.4278188645839691, mean p set: 0.4492279887199402
The modified gen p mean: 0.44981876015663147, gen p mean: -0.4286796450614929, mean p set: 0.45029905438423157
loss_pred:0.038017064332962036, decouple_loss:0.032243434339761734
loss_pred:0.03776288777589798, decouple_loss:0.03148795664310455
The modified gen p mean: 0.4485054016113281, gen p mean: -0.4281200170516968, mean p set: 0.44898566603660583
loss_pred:0.03863132372498512, decouple_loss:0.029928306117653847
2023-05-01 17:45:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.4385843276977539, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4302069842815399, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.433209091424942, mean p set: 0.4500633478164673
loss_pred:0.039143938571214676, decouple_loss:0.032954324036836624
loss_pred:0.037027325481176376, decouple_loss:0.03194117173552513
loss_pred:0.03814714029431343, decouple_loss:0.03128492459654808
WV_0_PC_1_EH_0_PS_40_5, loss: 0.039709143340587616, avg_mse: 0.0416048988699913
current test mse: 0.041605
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935813546180725, gen p mean: -0.438189297914505, mean p set: 0.44983842968940735
The modified gen p mean: 0.4483877718448639, gen p mean: -0.43549227714538574, mean p set: 0.4488680362701416
loss_pred:0.03934146463871002, decouple_loss:0.031380683183670044
The modified gen p mean: 0.44998177886009216, gen p mean: -0.43490028381347656, mean p set: 0.45046207308769226
loss_pred:0.03915145620703697, decouple_loss:0.031941007822752
loss_pred:0.03708023950457573, decouple_loss:0.03281505033373833
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796696305274963, gen p mean: -0.4267149567604065, mean p set: 0.44844722747802734
The modified gen p mean: 0.44974711537361145, gen p mean: -0.4302193224430084, mean p set: 0.45022737979888916
loss_pred:0.03779088705778122, decouple_loss:0.030032820999622345
loss_pred:0.0394475944340229, decouple_loss:0.030320413410663605
The modified gen p mean: 0.44813576340675354, gen p mean: -0.4259328246116638, mean p set: 0.44861605763435364
loss_pred:0.038610946387052536, decouple_loss:0.030898794531822205
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493882358074188, gen p mean: -0.42761489748954773, mean p set: 0.4498685300350189
The modified gen p mean: 0.44854825735092163, gen p mean: -0.42644384503364563, mean p set: 0.44902855157852173
loss_pred:0.03867156058549881, decouple_loss:0.03023373708128929
loss_pred:0.038273341953754425, decouple_loss:0.03148995339870453
The modified gen p mean: 0.4484628736972809, gen p mean: -0.4268689453601837, mean p set: 0.448943167924881
loss_pred:0.037383146584033966, decouple_loss:0.03031971864402294
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492068290710449, gen p mean: -0.42274245619773865, mean p set: 0.449687123298645
The modified gen p mean: 0.4484816789627075, gen p mean: -0.4271146059036255, mean p set: 0.44896194338798523
loss_pred:0.03986731544137001, decouple_loss:0.02952088601887226
loss_pred:0.039245765656232834, decouple_loss:0.03040383756160736
The modified gen p mean: 0.44852960109710693, gen p mean: -0.4220213294029236, mean p set: 0.44900989532470703
loss_pred:0.03855379670858383, decouple_loss:0.03097343258559704
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789427518844604, gen p mean: -0.4231416583061218, mean p set: 0.44837456941604614
The modified gen p mean: 0.44865718483924866, gen p mean: -0.42874500155448914, mean p set: 0.449137419462204
loss_pred:0.03807830065488815, decouple_loss:0.0288007240742445
loss_pred:0.039676815271377563, decouple_loss:0.030521947890520096
The modified gen p mean: 0.4491627514362335, gen p mean: -0.429562509059906, mean p set: 0.44964301586151123
loss_pred:0.03936707600951195, decouple_loss:0.028626510873436928
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45015114545822144, gen p mean: -0.4289109408855438, mean p set: 0.45063140988349915
loss_pred:0.03834366425871849, decouple_loss:0.030982669442892075
The modified gen p mean: 0.44882893562316895, gen p mean: -0.4299873411655426, mean p set: 0.44930922985076904
The modified gen p mean: 0.44884318113327026, gen p mean: -0.4317444860935211, mean p set: 0.44932347536087036
loss_pred:0.038580600172281265, decouple_loss:0.030589211732149124
loss_pred:0.0375993587076664, decouple_loss:0.028934789821505547
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495813846588135, gen p mean: -0.4277496933937073, mean p set: 0.4500616788864136
The modified gen p mean: 0.44856056571006775, gen p mean: -0.4285322427749634, mean p set: 0.44904085993766785
loss_pred:0.039531584829092026, decouple_loss:0.030319131910800934
loss_pred:0.03889711946249008, decouple_loss:0.029848093166947365
The modified gen p mean: 0.4481092393398285, gen p mean: -0.4142216145992279, mean p set: 0.4485895335674286
loss_pred:0.03818466141819954, decouple_loss:0.030292898416519165
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472452998161316, gen p mean: -0.4265000522136688, mean p set: 0.4477255642414093
The modified gen p mean: 0.4473860263824463, gen p mean: -0.4293562173843384, mean p set: 0.4478663504123688
loss_pred:0.03733000159263611, decouple_loss:0.029576443135738373
loss_pred:0.03806838393211365, decouple_loss:0.03189866617321968
The modified gen p mean: 0.4493604004383087, gen p mean: -0.4241296350955963, mean p set: 0.4498407244682312
loss_pred:0.03885841742157936, decouple_loss:0.030893361195921898
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745904207229614, gen p mean: -0.4306630790233612, mean p set: 0.44793930649757385
loss_pred:0.03893687576055527, decouple_loss:0.03183795139193535
The modified gen p mean: 0.44719043374061584, gen p mean: -0.43884649872779846, mean p set: 0.44767072796821594The modified gen p mean: 0.4478148818016052, gen p mean: -0.43930861353874207, mean p set: 0.4482952058315277
loss_pred:0.03962140902876854, decouple_loss:0.032760296016931534
loss_pred:0.03888498246669769, decouple_loss:0.03331742435693741
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475800395011902, gen p mean: -0.42498478293418884, mean p set: 0.4480603337287903
The modified gen p mean: 0.4475264549255371, gen p mean: -0.4283358156681061, mean p set: 0.4480067491531372
loss_pred:0.03845953941345215, decouple_loss:0.03212433680891991
loss_pred:0.03982991352677345, decouple_loss:0.0331975594162941
The modified gen p mean: 0.4471803605556488, gen p mean: -0.4271708130836487, mean p set: 0.4476606547832489
loss_pred:0.03969978541135788, decouple_loss:0.031810104846954346
2023-05-01 17:48:38 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4268205761909485, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4186180531978607, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.4216344654560089, mean p set: 0.4500633478164673
loss_pred:0.0384729728102684, decouple_loss:0.03211778402328491
loss_pred:0.03656592220067978, decouple_loss:0.03207072615623474loss_pred:0.037675902247428894, decouple_loss:0.03095637820661068
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03915734589099884, avg_mse: 0.04095454141497612
current test mse: 0.040955
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471185505390167, gen p mean: -0.41979122161865234, mean p set: 0.4475988745689392
loss_pred:0.038861632347106934, decouple_loss:0.0334688164293766
The modified gen p mean: 0.4474899172782898, gen p mean: -0.427627295255661, mean p set: 0.4479702413082123The modified gen p mean: 0.44719043374061584, gen p mean: -0.42184218764305115, mean p set: 0.44767072796821594
loss_pred:0.04027840867638588, decouple_loss:0.032427169382572174
loss_pred:0.03795310854911804, decouple_loss:0.03561732545495033
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463063180446625, gen p mean: -0.42358291149139404, mean p set: 0.44678664207458496
The modified gen p mean: 0.4476642608642578, gen p mean: -0.42507094144821167, mean p set: 0.4481445848941803
loss_pred:0.03756136819720268, decouple_loss:0.032086167484521866
loss_pred:0.03713805601000786, decouple_loss:0.031397368758916855
The modified gen p mean: 0.44759684801101685, gen p mean: -0.4261699616909027, mean p set: 0.44807714223861694
loss_pred:0.03774590417742729, decouple_loss:0.032337773591279984
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665277004241943, gen p mean: -0.43643900752067566, mean p set: 0.44713303446769714
The modified gen p mean: 0.44858667254447937, gen p mean: -0.4387320876121521, mean p set: 0.4490669369697571
loss_pred:0.036759261041879654, decouple_loss:0.03103111870586872
loss_pred:0.03705041855573654, decouple_loss:0.03148720785975456
The modified gen p mean: 0.4480352997779846, gen p mean: -0.4359276294708252, mean p set: 0.4485156238079071
loss_pred:0.03618542477488518, decouple_loss:0.031000370159745216
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715288281440735, gen p mean: -0.4429766833782196, mean p set: 0.44763314723968506
The modified gen p mean: 0.4476644992828369, gen p mean: -0.4376217722892761, mean p set: 0.4481448233127594
loss_pred:0.03907535597681999, decouple_loss:0.03248853236436844
loss_pred:0.03934607282280922, decouple_loss:0.030853085219860077
The modified gen p mean: 0.446276992559433, gen p mean: -0.4404163360595703, mean p set: 0.4467572569847107
loss_pred:0.03649480268359184, decouple_loss:0.030713682994246483
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483295977115631, gen p mean: -0.442711740732193, mean p set: 0.4488099217414856
loss_pred:0.03994736447930336, decouple_loss:0.030773861333727837
The modified gen p mean: 0.4477413594722748, gen p mean: -0.4389588534832001, mean p set: 0.4482216238975525The modified gen p mean: 0.44701892137527466, gen p mean: -0.4341503083705902, mean p set: 0.44749921560287476
loss_pred:0.03927670046687126, decouple_loss:0.030882107093930244
loss_pred:0.03963249549269676, decouple_loss:0.03254904970526695
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475373327732086, gen p mean: -0.43342965841293335, mean p set: 0.4480176270008087
The modified gen p mean: 0.4472975432872772, gen p mean: -0.4338828921318054, mean p set: 0.4477778375148773
loss_pred:0.038690321147441864, decouple_loss:0.03061482310295105
loss_pred:0.036944590508937836, decouple_loss:0.030846625566482544
The modified gen p mean: 0.44744572043418884, gen p mean: -0.4342065751552582, mean p set: 0.44792598485946655
loss_pred:0.03838623687624931, decouple_loss:0.03155854344367981
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654354453086853, gen p mean: -0.42589616775512695, mean p set: 0.44702383875846863
The modified gen p mean: 0.44733744859695435, gen p mean: -0.42661625146865845, mean p set: 0.44781771302223206
loss_pred:0.037312984466552734, decouple_loss:0.029648568481206894
loss_pred:0.03885836899280548, decouple_loss:0.03197657689452171
The modified gen p mean: 0.4476320445537567, gen p mean: -0.427446186542511, mean p set: 0.4481123387813568
loss_pred:0.035924408584833145, decouple_loss:0.030111035332083702
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723114371299744, gen p mean: -0.4229443073272705, mean p set: 0.44771143794059753
loss_pred:0.03881186619400978, decouple_loss:0.03127266839146614
The modified gen p mean: 0.4477626085281372, gen p mean: -0.4260833263397217, mean p set: 0.4482428729534149The modified gen p mean: 0.4471842646598816, gen p mean: -0.42838504910469055, mean p set: 0.4476645588874817
loss_pred:0.03842348977923393, decouple_loss:0.0319099985063076
loss_pred:0.03867265582084656, decouple_loss:0.02978629805147648
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814151525497437, gen p mean: -0.42930907011032104, mean p set: 0.4486217796802521
The modified gen p mean: 0.4467707574367523, gen p mean: -0.42625588178634644, mean p set: 0.44725102186203003
loss_pred:0.0381573922932148, decouple_loss:0.03053944557905197
loss_pred:0.03659263253211975, decouple_loss:0.02972809225320816
The modified gen p mean: 0.44681569933891296, gen p mean: -0.42946356534957886, mean p set: 0.44729599356651306
loss_pred:0.03680949658155441, decouple_loss:0.030370136722922325
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477905035018921, gen p mean: -0.4254596531391144, mean p set: 0.4482708275318146
The modified gen p mean: 0.4473235309123993, gen p mean: -0.42643868923187256, mean p set: 0.4478038251399994
loss_pred:0.03939426690340042, decouple_loss:0.028765089809894562
loss_pred:0.03784455731511116, decouple_loss:0.031305208802223206
The modified gen p mean: 0.44800665974617004, gen p mean: -0.42634719610214233, mean p set: 0.44848695397377014
loss_pred:0.03870321437716484, decouple_loss:0.029411867260932922
2023-05-01 17:50:46 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.42729490995407104, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.41974395513534546, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4224499464035034, mean p set: 0.4500633478164673
loss_pred:0.03821132332086563, decouple_loss:0.031094638630747795
loss_pred:0.036348022520542145, decouple_loss:0.030704330652952194
loss_pred:0.03725282847881317, decouple_loss:0.030147159472107887
WV_0_PC_1_EH_0_PS_40_5, loss: 0.038803160190582275, avg_mse: 0.0406782440841198
current test mse: 0.040678
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473910331726074, gen p mean: -0.42102494835853577, mean p set: 0.4478713572025299
The modified gen p mean: 0.4477926790714264, gen p mean: -0.4235876500606537, mean p set: 0.4482730031013489
loss_pred:0.036949969828128815, decouple_loss:0.029882069677114487
The modified gen p mean: 0.44726693630218506, gen p mean: -0.4282144010066986, mean p set: 0.44774720072746277
loss_pred:0.039476700127124786, decouple_loss:0.03139108046889305
loss_pred:0.03678010404109955, decouple_loss:0.029992779716849327
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720011949539185, gen p mean: -0.4350825548171997, mean p set: 0.44768041372299194
loss_pred:0.03713541105389595, decouple_loss:0.02934255637228489
The modified gen p mean: 0.4469631314277649, gen p mean: -0.4303904175758362, mean p set: 0.447443425655365The modified gen p mean: 0.44601359963417053, gen p mean: -0.43112489581108093, mean p set: 0.44649389386177063
loss_pred:0.0359012596309185, decouple_loss:0.02885677106678486
loss_pred:0.036555808037519455, decouple_loss:0.02809802070260048
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470789432525635, gen p mean: -0.4269242584705353, mean p set: 0.44755926728248596
The modified gen p mean: 0.4471006393432617, gen p mean: -0.4332621395587921, mean p set: 0.44758090376853943
loss_pred:0.0390961617231369, decouple_loss:0.028995724394917488
loss_pred:0.038013309240341187, decouple_loss:0.028316626325249672
The modified gen p mean: 0.44698387384414673, gen p mean: -0.4252856373786926, mean p set: 0.4474641680717468
loss_pred:0.039728742092847824, decouple_loss:0.029777929186820984
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479086399078369, gen p mean: -0.42842382192611694, mean p set: 0.4483889639377594
The modified gen p mean: 0.4481313228607178, gen p mean: -0.4293467104434967, mean p set: 0.4486115872859955
loss_pred:0.03720053285360336, decouple_loss:0.028884055092930794
loss_pred:0.038338251411914825, decouple_loss:0.029579682275652885
The modified gen p mean: 0.4476095139980316, gen p mean: -0.4271508455276489, mean p set: 0.4480897784233093
loss_pred:0.037797149270772934, decouple_loss:0.030216818675398827
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748654961586, gen p mean: -0.43010592460632324, mean p set: 0.4479668438434601
loss_pred:0.03981345146894455, decouple_loss:0.029136257246136665
The modified gen p mean: 0.4475240707397461, gen p mean: -0.43651413917541504, mean p set: 0.4480043649673462
The modified gen p mean: 0.44735562801361084, gen p mean: -0.43463724851608276, mean p set: 0.44783589243888855
loss_pred:0.03893609344959259, decouple_loss:0.02890182100236416
loss_pred:0.03626083582639694, decouple_loss:0.028582863509655
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785475730895996, gen p mean: -0.4391305148601532, mean p set: 0.44833505153656006
loss_pred:0.03791385516524315, decouple_loss:0.029089467599987984
The modified gen p mean: 0.44691622257232666, gen p mean: -0.43399110436439514, mean p set: 0.44739648699760437The modified gen p mean: 0.44772130250930786, gen p mean: -0.4405209720134735, mean p set: 0.44820162653923035
loss_pred:0.038691263645887375, decouple_loss:0.0271037295460701
loss_pred:0.039430681616067886, decouple_loss:0.02941984497010708
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729742407798767, gen p mean: -0.43162477016448975, mean p set: 0.44777771830558777
The modified gen p mean: 0.4485894441604614, gen p mean: -0.4386744797229767, mean p set: 0.4490697383880615
loss_pred:0.038489919155836105, decouple_loss:0.02832658961415291
loss_pred:0.03564438223838806, decouple_loss:0.027782024815678596
The modified gen p mean: 0.44752684235572815, gen p mean: -0.43931248784065247, mean p set: 0.44800713658332825
loss_pred:0.037589460611343384, decouple_loss:0.028490770608186722
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475873112678528, gen p mean: -0.42246919870376587, mean p set: 0.44806763529777527The modified gen p mean: 0.44776326417922974, gen p mean: -0.428838849067688, mean p set: 0.44824355840682983
loss_pred:0.038378678262233734, decouple_loss:0.03058013506233692loss_pred:0.03807155787944794, decouple_loss:0.028043638914823532
The modified gen p mean: 0.4475558400154114, gen p mean: -0.4257906973361969, mean p set: 0.4480361342430115
loss_pred:0.03830071911215782, decouple_loss:0.028469188138842583
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
NaN value num: 0
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033180713653564, gen p mean: -0.4225638210773468, mean p set: 0.45081210136413574
loss_pred:0.037276044487953186, decouple_loss:0.03394319489598274
The modified gen p mean: 0.45013561844825745, gen p mean: -0.4265337586402893, mean p set: 0.45061591267585754The modified gen p mean: 0.45051419734954834, gen p mean: -0.42988356947898865, mean p set: 0.4509945213794708
loss_pred:0.0381271094083786, decouple_loss:0.036159634590148926
loss_pred:0.03732674568891525, decouple_loss:0.03598899021744728
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982004165649414, gen p mean: -0.4350329041481018, mean p set: 0.4503003656864166
The modified gen p mean: 0.4505615532398224, gen p mean: -0.43198513984680176, mean p set: 0.4510418474674225
loss_pred:0.038697898387908936, decouple_loss:0.03551360219717026
loss_pred:0.03744535893201828, decouple_loss:0.033877842128276825
The modified gen p mean: 0.45076221227645874, gen p mean: -0.4329036772251129, mean p set: 0.4512425363063812
loss_pred:0.0372629314661026, decouple_loss:0.035066310316324234
2023-05-01 17:53:29 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.4454118609428406, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4353174567222595, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.43910229206085205, mean p set: 0.4500633478164673
loss_pred:0.038206957280635834, decouple_loss:0.03180830925703049
loss_pred:0.03651939705014229, decouple_loss:0.03132914751768112
loss_pred:0.03735540062189102, decouple_loss:0.030563633888959885
WV_0_PC_1_EH_0_PS_40_5, loss: 0.0389222726225853, avg_mse: 0.04095806926488876
current test mse: 0.040958
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45032623410224915, gen p mean: -0.440522700548172, mean p set: 0.45080649852752686
The modified gen p mean: 0.4505538046360016, gen p mean: -0.4373207092285156, mean p set: 0.4510340988636017
loss_pred:0.03838964179158211, decouple_loss:0.034636832773685455
The modified gen p mean: 0.4505400061607361, gen p mean: -0.4418318569660187, mean p set: 0.45102033019065857
loss_pred:0.03828751668334007, decouple_loss:0.03455845266580582
loss_pred:0.03861629590392113, decouple_loss:0.03357170522212982
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507042169570923, gen p mean: -0.43612396717071533, mean p set: 0.4511845111846924
The modified gen p mean: 0.45042115449905396, gen p mean: -0.43600064516067505, mean p set: 0.45090147852897644
The modified gen p mean: 0.450418084859848, gen p mean: -0.4426954686641693, mean p set: 0.4508983790874481
loss_pred:0.03682088479399681, decouple_loss:0.031585052609443665
loss_pred:0.036893330514431, decouple_loss:0.03200804069638252loss_pred:0.03851217031478882, decouple_loss:0.03305299952626228
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079559087753296, gen p mean: -0.4420395493507385, mean p set: 0.45127591490745544
The modified gen p mean: 0.44938963651657104, gen p mean: -0.43405336141586304, mean p set: 0.44986993074417114
The modified gen p mean: 0.4500710070133209, gen p mean: -0.43747347593307495, mean p set: 0.4505513310432434
loss_pred:0.03858134150505066, decouple_loss:0.03281523659825325
loss_pred:0.038538262248039246, decouple_loss:0.031590696424245834
loss_pred:0.0366792194545269, decouple_loss:0.03128787875175476
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508623778820038, gen p mean: -0.4294474422931671, mean p set: 0.4513426423072815
The modified gen p mean: 0.4509621262550354, gen p mean: -0.42848071455955505, mean p set: 0.4514424204826355
The modified gen p mean: 0.4498096704483032, gen p mean: -0.426065057516098, mean p set: 0.45028993487358093
loss_pred:0.0389586016535759, decouple_loss:0.03214864060282707
loss_pred:0.03614940494298935, decouple_loss:0.031160609796643257loss_pred:0.03712402656674385, decouple_loss:0.031165819615125656
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932088255882263, gen p mean: -0.4252578914165497, mean p set: 0.44980117678642273
The modified gen p mean: 0.4488238990306854, gen p mean: -0.42201536893844604, mean p set: 0.44930416345596313
loss_pred:0.03856157511472702, decouple_loss:0.03142950311303139
loss_pred:0.03725274279713631, decouple_loss:0.030761919915676117
The modified gen p mean: 0.4490700662136078, gen p mean: -0.42948177456855774, mean p set: 0.4495503306388855
loss_pred:0.03824343904852867, decouple_loss:0.03214216232299805
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499472379684448, gen p mean: -0.44083327054977417, mean p set: 0.45042750239372253
The modified gen p mean: 0.4504280090332031, gen p mean: -0.4351556897163391, mean p set: 0.45090827345848083
loss_pred:0.03723124414682388, decouple_loss:0.031551964581012726
loss_pred:0.037943173199892044, decouple_loss:0.031730327755212784
The modified gen p mean: 0.44986680150032043, gen p mean: -0.4377521574497223, mean p set: 0.45034709572792053
loss_pred:0.038657087832689285, decouple_loss:0.03244908154010773
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508325159549713, gen p mean: -0.4603748619556427, mean p set: 0.4513128101825714
The modified gen p mean: 0.4497341811656952, gen p mean: -0.44912755489349365, mean p set: 0.4502144455909729
loss_pred:0.03741509094834328, decouple_loss:0.03314700350165367
loss_pred:0.03731397166848183, decouple_loss:0.030697423964738846
The modified gen p mean: 0.4493100941181183, gen p mean: -0.4519680440425873, mean p set: 0.4497903883457184
loss_pred:0.03836831450462341, decouple_loss:0.03062029741704464
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065775513648987, gen p mean: -0.4619825482368469, mean p set: 0.45113804936408997
The modified gen p mean: 0.44932761788368225, gen p mean: -0.45155999064445496, mean p set: 0.44980788230895996
loss_pred:0.03753045201301575, decouple_loss:0.0330340713262558
loss_pred:0.03865702450275421, decouple_loss:0.031271353363990784
The modified gen p mean: 0.4498710632324219, gen p mean: -0.4581772983074188, mean p set: 0.450351357460022
loss_pred:0.03745640814304352, decouple_loss:0.03221211954951286
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44989699125289917, gen p mean: -0.4432843327522278, mean p set: 0.45037728548049927
The modified gen p mean: 0.4497908651828766, gen p mean: -0.442157119512558, mean p set: 0.4502711296081543
The modified gen p mean: 0.4506174623966217, gen p mean: -0.45321401953697205, mean p set: 0.4510977864265442
loss_pred:0.03817456215620041, decouple_loss:0.030656883493065834
loss_pred:0.03641707822680473, decouple_loss:0.0320979468524456loss_pred:0.03732854500412941, decouple_loss:0.03390464186668396
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490688443183899, gen p mean: -0.4355655014514923, mean p set: 0.4495491087436676
The modified gen p mean: 0.45097872614860535, gen p mean: -0.43341928720474243, mean p set: 0.45145899057388306
loss_pred:0.037343576550483704, decouple_loss:0.03045882284641266
loss_pred:0.037865836173295975, decouple_loss:0.03288278356194496
The modified gen p mean: 0.45081645250320435, gen p mean: -0.44198688864707947, mean p set: 0.45129671692848206
loss_pred:0.037161003798246384, decouple_loss:0.03215637430548668
2023-05-01 17:55:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.44240525364875793, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.43198367953300476, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4364664554595947, mean p set: 0.4500633478164673
loss_pred:0.03876250609755516, decouple_loss:0.035959649831056595
loss_pred:0.03654378652572632, decouple_loss:0.03486277535557747
loss_pred:0.0376037061214447, decouple_loss:0.03413968160748482
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03938603401184082, avg_mse: 0.04158797115087509
current test mse: 0.041588
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45088905096054077, gen p mean: -0.4371676743030548, mean p set: 0.45136934518814087
The modified gen p mean: 0.45057016611099243, gen p mean: -0.43577325344085693, mean p set: 0.45105046033859253
loss_pred:0.037393927574157715, decouple_loss:0.032498184591531754
The modified gen p mean: 0.4506491422653198, gen p mean: -0.43348363041877747, mean p set: 0.4511294364929199
loss_pred:0.03823550045490265, decouple_loss:0.031315818428993225
loss_pred:0.038438569754362106, decouple_loss:0.030449964106082916
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508225619792938, gen p mean: -0.44553375244140625, mean p set: 0.4513028562068939
The modified gen p mean: 0.45072463154792786, gen p mean: -0.4370579421520233, mean p set: 0.45120492577552795
loss_pred:0.03690943121910095, decouple_loss:0.030412472784519196
loss_pred:0.03781161457300186, decouple_loss:0.031490955501794815
The modified gen p mean: 0.45182010531425476, gen p mean: -0.438102662563324, mean p set: 0.45230039954185486
loss_pred:0.03794039785861969, decouple_loss:0.030525177717208862
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500060975551605, gen p mean: -0.4439111053943634, mean p set: 0.4504863917827606
loss_pred:0.037881482392549515, decouple_loss:0.030249107629060745
The modified gen p mean: 0.4497520625591278, gen p mean: -0.45250383019447327, mean p set: 0.4502323865890503The modified gen p mean: 0.44991546869277954, gen p mean: -0.44800660014152527, mean p set: 0.450395792722702
loss_pred:0.03696275129914284, decouple_loss:0.032103605568408966
loss_pred:0.03731818497180939, decouple_loss:0.031686440110206604
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503765106201172, gen p mean: -0.4581437110900879, mean p set: 0.4508568048477173
The modified gen p mean: 0.44957202672958374, gen p mean: -0.45258527994155884, mean p set: 0.45005232095718384
loss_pred:0.037035003304481506, decouple_loss:0.03130631521344185
loss_pred:0.03805932030081749, decouple_loss:0.030918903648853302
The modified gen p mean: 0.4500775933265686, gen p mean: -0.45787274837493896, mean p set: 0.4505578577518463
loss_pred:0.03696988523006439, decouple_loss:0.030770525336265564
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491346776485443, gen p mean: -0.447611927986145, mean p set: 0.4496149718761444
The modified gen p mean: 0.4507591128349304, gen p mean: -0.45154687762260437, mean p set: 0.4512394070625305
loss_pred:0.03743833675980568, decouple_loss:0.0299692340195179
loss_pred:0.037684421986341476, decouple_loss:0.030278366059064865
The modified gen p mean: 0.4488142728805542, gen p mean: -0.4505072236061096, mean p set: 0.4492945969104767
loss_pred:0.03692580386996269, decouple_loss:0.028977172449231148
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502016603946686, gen p mean: -0.4414011538028717, mean p set: 0.4506819546222687
The modified gen p mean: 0.4498754143714905, gen p mean: -0.44649460911750793, mean p set: 0.4503557085990906
loss_pred:0.035811204463243484, decouple_loss:0.03074328415095806
loss_pred:0.036782704293727875, decouple_loss:0.03189777582883835
The modified gen p mean: 0.4491664469242096, gen p mean: -0.4437424838542938, mean p set: 0.4496467411518097
loss_pred:0.038346584886312485, decouple_loss:0.029017096385359764
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482329487800598, gen p mean: -0.44406113028526306, mean p set: 0.4487132728099823
The modified gen p mean: 0.45001962780952454, gen p mean: -0.4535893499851227, mean p set: 0.45049992203712463
The modified gen p mean: 0.44912439584732056, gen p mean: -0.4471889138221741, mean p set: 0.44960469007492065
loss_pred:0.03742817044258118, decouple_loss:0.03053656965494156
loss_pred:0.03727935999631882, decouple_loss:0.030281778424978256
loss_pred:0.03744157403707504, decouple_loss:0.030752843245863914
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488774240016937, gen p mean: -0.4699111878871918, mean p set: 0.4493577182292938
loss_pred:0.036447830498218536, decouple_loss:0.03764278069138527
The modified gen p mean: 0.44790494441986084, gen p mean: -0.45591259002685547, mean p set: 0.44838523864746094The modified gen p mean: 0.4481850862503052, gen p mean: -0.4590223729610443, mean p set: 0.44866541028022766
loss_pred:0.037909381091594696, decouple_loss:0.032734714448451996
loss_pred:0.03716210648417473, decouple_loss:0.03209798038005829
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793716073036194, gen p mean: -0.4585497975349426, mean p set: 0.44841745495796204
The modified gen p mean: 0.44937461614608765, gen p mean: -0.46301063895225525, mean p set: 0.44985491037368774
loss_pred:0.03624263405799866, decouple_loss:0.03270474448800087
loss_pred:0.03770031780004501, decouple_loss:0.030414406210184097
The modified gen p mean: 0.4484160840511322, gen p mean: -0.463572233915329, mean p set: 0.4488963484764099
loss_pred:0.03790809586644173, decouple_loss:0.03131112456321716
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701382517814636, gen p mean: -0.4692033529281616, mean p set: 0.44749414920806885
The modified gen p mean: 0.4473456144332886, gen p mean: -0.46110743284225464, mean p set: 0.44782590866088867
loss_pred:0.03743063658475876, decouple_loss:0.03592138737440109
loss_pred:0.0377328023314476, decouple_loss:0.03098158910870552
The modified gen p mean: 0.4474874436855316, gen p mean: -0.4643271565437317, mean p set: 0.4479677379131317
loss_pred:0.03567681834101677, decouple_loss:0.031296923756599426
2023-05-01 17:58:22 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.46425342559814453, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.45400702953338623, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.45775654911994934, mean p set: 0.4500633478164673
loss_pred:0.03811495378613472, decouple_loss:0.031787991523742676
loss_pred:0.03611337020993233, decouple_loss:0.03129339963197708
loss_pred:0.03689482435584068, decouple_loss:0.03074835054576397
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03860487788915634, avg_mse: 0.04070531204342842
current test mse: 0.040705
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478943943977356, gen p mean: -0.4645825922489166, mean p set: 0.4483746588230133
The modified gen p mean: 0.4472601115703583, gen p mean: -0.4614672064781189, mean p set: 0.4477404057979584
The modified gen p mean: 0.4472804069519043, gen p mean: -0.4550677537918091, mean p set: 0.447760671377182loss_pred:0.036734502762556076, decouple_loss:0.03420637547969818
loss_pred:0.036799509078264236, decouple_loss:0.03407856822013855
loss_pred:0.03754584863781929, decouple_loss:0.02987748757004738
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469315707683563, gen p mean: -0.45533618330955505, mean p set: 0.44741183519363403
The modified gen p mean: 0.4501919746398926, gen p mean: -0.4514712691307068, mean p set: 0.4506722390651703
The modified gen p mean: 0.44923028349876404, gen p mean: -0.45808911323547363, mean p set: 0.4497106075286865
loss_pred:0.035767536610364914, decouple_loss:0.03094298765063286
loss_pred:0.0374007523059845, decouple_loss:0.03071146085858345loss_pred:0.037087082862854004, decouple_loss:0.03231753408908844
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473118782043457, gen p mean: -0.4619278013706207, mean p set: 0.4477921724319458
The modified gen p mean: 0.44775640964508057, gen p mean: -0.454336553812027, mean p set: 0.44823670387268066
loss_pred:0.03618241474032402, decouple_loss:0.03183022886514664
The modified gen p mean: 0.44830477237701416, gen p mean: -0.46495041251182556, mean p set: 0.44878509640693665
loss_pred:0.0356273353099823, decouple_loss:0.03181410953402519
loss_pred:0.03641436621546745, decouple_loss:0.033745914697647095
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483198821544647, gen p mean: -0.45850834250450134, mean p set: 0.44880014657974243
The modified gen p mean: 0.44902482628822327, gen p mean: -0.454812616109848, mean p set: 0.44950512051582336
loss_pred:0.03535570576786995, decouple_loss:0.02937411144375801
loss_pred:0.03650188818573952, decouple_loss:0.029898833483457565
The modified gen p mean: 0.4476581811904907, gen p mean: -0.45268523693084717, mean p set: 0.4481384754180908
loss_pred:0.03537343069911003, decouple_loss:0.030682872980833054
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460190236568451, gen p mean: -0.45258545875549316, mean p set: 0.4464992880821228
The modified gen p mean: 0.449217826128006, gen p mean: -0.45370811223983765, mean p set: 0.44969815015792847
loss_pred:0.03810259327292442, decouple_loss:0.02964852750301361
loss_pred:0.03688094764947891, decouple_loss:0.02951904758810997
The modified gen p mean: 0.449720174074173, gen p mean: -0.45676159858703613, mean p set: 0.45020049810409546
loss_pred:0.03675366938114166, decouple_loss:0.029232630506157875
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482395350933075, gen p mean: -0.46975356340408325, mean p set: 0.4487197697162628
The modified gen p mean: 0.4482327401638031, gen p mean: -0.46721234917640686, mean p set: 0.4487130343914032
loss_pred:0.036776505410671234, decouple_loss:0.03383718803524971
loss_pred:0.03620053082704544, decouple_loss:0.031480852514505386
The modified gen p mean: 0.44704604148864746, gen p mean: -0.4612104892730713, mean p set: 0.44752633571624756
loss_pred:0.03459858521819115, decouple_loss:0.029184425249695778
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447660356760025, gen p mean: -0.4559587836265564, mean p set: 0.4481406807899475
The modified gen p mean: 0.4461825489997864, gen p mean: -0.4472472667694092, mean p set: 0.4466628134250641
loss_pred:0.03666742518544197, decouple_loss:0.032211486250162125
loss_pred:0.03690945357084274, decouple_loss:0.029524367302656174
The modified gen p mean: 0.44900283217430115, gen p mean: -0.44697991013526917, mean p set: 0.44948315620422363
loss_pred:0.036798976361751556, decouple_loss:0.028488796204328537
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738543033599854, gen p mean: -0.4471965432167053, mean p set: 0.44786572456359863
The modified gen p mean: 0.44910064339637756, gen p mean: -0.44580185413360596, mean p set: 0.4495809078216553
loss_pred:0.034959886223077774, decouple_loss:0.02959214709699154
loss_pred:0.03691176697611809, decouple_loss:0.029495229944586754
The modified gen p mean: 0.44871610403060913, gen p mean: -0.44889500737190247, mean p set: 0.4491964280605316
loss_pred:0.035923685878515244, decouple_loss:0.029833711683750153
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750961661338806, gen p mean: -0.45038902759552, mean p set: 0.44798991084098816
The modified gen p mean: 0.44876861572265625, gen p mean: -0.45132023096084595, mean p set: 0.44924888014793396
loss_pred:0.034503765404224396, decouple_loss:0.02793348953127861
loss_pred:0.03789731487631798, decouple_loss:0.029594620689749718
The modified gen p mean: 0.44661128520965576, gen p mean: -0.44988757371902466, mean p set: 0.44709157943725586
loss_pred:0.0358504094183445, decouple_loss:0.02892489917576313
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482777714729309, gen p mean: -0.44598984718322754, mean p set: 0.4487580358982086
The modified gen p mean: 0.44794389605522156, gen p mean: -0.44471123814582825, mean p set: 0.44842419028282166
loss_pred:0.03532635420560837, decouple_loss:0.028769411146640778
loss_pred:0.03570448234677315, decouple_loss:0.03067910112440586
The modified gen p mean: 0.44705820083618164, gen p mean: -0.44395723938941956, mean p set: 0.44753846526145935
loss_pred:0.036196209490299225, decouple_loss:0.029831919819116592
2023-05-01 18:00:31 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.45232200622558594, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4421347677707672, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4454960525035858, mean p set: 0.4500633478164673
loss_pred:0.03741971403360367, decouple_loss:0.030417436733841896
loss_pred:0.03556989133358002, decouple_loss:0.0299169160425663
loss_pred:0.036577627062797546, decouple_loss:0.029443636536598206
WV_0_PC_1_EH_0_PS_40_5, loss: 0.038018710911273956, avg_mse: 0.03999783471226692
current test mse: 0.039998
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693103432655334, gen p mean: -0.450874388217926, mean p set: 0.44741132855415344
The modified gen p mean: 0.4485984742641449, gen p mean: -0.4475853145122528, mean p set: 0.449078768491745
loss_pred:0.036353059113025665, decouple_loss:0.029004259034991264
The modified gen p mean: 0.4464013874530792, gen p mean: -0.44779691100120544, mean p set: 0.4468816816806793
loss_pred:0.0364655964076519, decouple_loss:0.033168938010931015
loss_pred:0.03683680295944214, decouple_loss:0.03449279069900513
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474087357521057, gen p mean: -0.4439404606819153, mean p set: 0.4478890001773834
The modified gen p mean: 0.4493301808834076, gen p mean: -0.4483245611190796, mean p set: 0.4498105049133301
loss_pred:0.03582467511296272, decouple_loss:0.029926881194114685
loss_pred:0.03610670194029808, decouple_loss:0.0287176501005888
The modified gen p mean: 0.44858020544052124, gen p mean: -0.44310542941093445, mean p set: 0.44906049966812134
loss_pred:0.036266252398490906, decouple_loss:0.029624471440911293
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464574158191681, gen p mean: -0.44712427258491516, mean p set: 0.4469376802444458
The modified gen p mean: 0.4500364661216736, gen p mean: -0.4466850757598877, mean p set: 0.4505167305469513
The modified gen p mean: 0.4492894113063812, gen p mean: -0.445322722196579, mean p set: 0.44976967573165894
loss_pred:0.0373317152261734, decouple_loss:0.027745217084884644
loss_pred:0.035777557641267776, decouple_loss:0.02833535149693489loss_pred:0.03685220703482628, decouple_loss:0.028527336195111275
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815385341644287, gen p mean: -0.45288631319999695, mean p set: 0.44863414764404297
The modified gen p mean: 0.4491988718509674, gen p mean: -0.4558635652065277, mean p set: 0.4496791362762451
loss_pred:0.03540388494729996, decouple_loss:0.02882670797407627
loss_pred:0.03621456027030945, decouple_loss:0.029011795297265053The modified gen p mean: 0.4468690752983093, gen p mean: -0.45456892251968384, mean p set: 0.4473493695259094
loss_pred:0.03580615669488907, decouple_loss:0.028844166547060013
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488517940044403, gen p mean: -0.4536612629890442, mean p set: 0.4493320882320404
The modified gen p mean: 0.44736945629119873, gen p mean: -0.4447789490222931, mean p set: 0.44784975051879883
loss_pred:0.037010591477155685, decouple_loss:0.030290793627500534
loss_pred:0.035719335079193115, decouple_loss:0.029346436262130737
The modified gen p mean: 0.4488963186740875, gen p mean: -0.45207130908966064, mean p set: 0.4493766129016876
loss_pred:0.03736869618296623, decouple_loss:0.02859916165471077
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719547033309937, gen p mean: -0.4519789218902588, mean p set: 0.4476757347583771
The modified gen p mean: 0.44876593351364136, gen p mean: -0.449584424495697, mean p set: 0.44924619793891907loss_pred:0.035509467124938965, decouple_loss:0.029278114438056946
The modified gen p mean: 0.4488295614719391, gen p mean: -0.46265536546707153, mean p set: 0.4493098258972168
loss_pred:0.03632024675607681, decouple_loss:0.028154635801911354
loss_pred:0.03566954284906387, decouple_loss:0.0316450335085392
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783085584640503, gen p mean: -0.4589673578739166, mean p set: 0.4483111500740051
The modified gen p mean: 0.4471632242202759, gen p mean: -0.4628760516643524, mean p set: 0.4476434886455536
loss_pred:0.03667222708463669, decouple_loss:0.030602648854255676
loss_pred:0.03524734452366829, decouple_loss:0.029538774862885475
The modified gen p mean: 0.4480293393135071, gen p mean: -0.47252345085144043, mean p set: 0.4485096037387848
loss_pred:0.03662479668855667, decouple_loss:0.03352358564734459
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
NaN value num: 0
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503896236419678, gen p mean: -0.4652439057826996, mean p set: 0.45086991786956787
loss_pred:0.03652842715382576, decouple_loss:0.032392870634794235
The modified gen p mean: 0.4493984878063202, gen p mean: -0.46363192796707153, mean p set: 0.4498787522315979The modified gen p mean: 0.45038139820098877, gen p mean: -0.4558233916759491, mean p set: 0.45086169242858887
loss_pred:0.034063875675201416, decouple_loss:0.028961574658751488
loss_pred:0.03776463121175766, decouple_loss:0.031609516590833664
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527290463447571, gen p mean: -0.45501455664634705, mean p set: 0.4532093107700348
The modified gen p mean: 0.450423002243042, gen p mean: -0.45578041672706604, mean p set: 0.4509033262729645
loss_pred:0.03580058738589287, decouple_loss:0.03296571969985962
loss_pred:0.03543325886130333, decouple_loss:0.02827467769384384
The modified gen p mean: 0.4512365162372589, gen p mean: -0.45051029324531555, mean p set: 0.451716810464859
loss_pred:0.03594117984175682, decouple_loss:0.032327860593795776
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534416198730469, gen p mean: -0.46471792459487915, mean p set: 0.453921914100647
The modified gen p mean: 0.4515925645828247, gen p mean: -0.4613521099090576, mean p set: 0.4520728290081024
loss_pred:0.03734531253576279, decouple_loss:0.03216369077563286
loss_pred:0.034822653979063034, decouple_loss:0.032804206013679504
The modified gen p mean: 0.4541001617908478, gen p mean: -0.4771372973918915, mean p set: 0.4545804262161255
loss_pred:0.03744567558169365, decouple_loss:0.034225936979055405
2023-05-01 18:03:16 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.48552224040031433, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4742109775543213, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4774197041988373, mean p set: 0.4500633478164673
loss_pred:0.03778047859668732, decouple_loss:0.03183896094560623
loss_pred:0.03617255389690399, decouple_loss:0.031813230365514755
loss_pred:0.036937784403562546, decouple_loss:0.030546056106686592
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03853357583284378, avg_mse: 0.040853988379240036
current test mse: 0.040854
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540459215641022, gen p mean: -0.4851698577404022, mean p set: 0.45452621579170227
The modified gen p mean: 0.45383355021476746, gen p mean: -0.47927066683769226, mean p set: 0.45431381464004517
loss_pred:0.03629499673843384, decouple_loss:0.03121075965464115
The modified gen p mean: 0.45183470845222473, gen p mean: -0.4745578169822693, mean p set: 0.45231500267982483
loss_pred:0.03519003465771675, decouple_loss:0.03175586089491844
loss_pred:0.03520488739013672, decouple_loss:0.030956830829381943
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45042431354522705, gen p mean: -0.47235339879989624, mean p set: 0.45090457797050476
The modified gen p mean: 0.44958361983299255, gen p mean: -0.47375863790512085, mean p set: 0.45006391406059265
The modified gen p mean: 0.45198854804039, gen p mean: -0.4853990972042084, mean p set: 0.4524688422679901loss_pred:0.03554180637001991, decouple_loss:0.03154614195227623
loss_pred:0.03377043455839157, decouple_loss:0.03221346065402031
loss_pred:0.03624829649925232, decouple_loss:0.032988615334033966
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494636654853821, gen p mean: -0.46418115496635437, mean p set: 0.4499439597129822
The modified gen p mean: 0.4525851309299469, gen p mean: -0.46789681911468506, mean p set: 0.453065425157547
The modified gen p mean: 0.4548639953136444, gen p mean: -0.4761989116668701, mean p set: 0.4553443193435669
loss_pred:0.03583725541830063, decouple_loss:0.03077230602502823
loss_pred:0.036512039601802826, decouple_loss:0.030808433890342712
loss_pred:0.035455990582704544, decouple_loss:0.03134541213512421
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531160593032837, gen p mean: -0.4752385914325714, mean p set: 0.4535963535308838
The modified gen p mean: 0.4505912661552429, gen p mean: -0.45864278078079224, mean p set: 0.451071560382843
loss_pred:0.03597689047455788, decouple_loss:0.03143208473920822
loss_pred:0.036753538995981216, decouple_loss:0.03163445368409157
The modified gen p mean: 0.4511702358722687, gen p mean: -0.46460092067718506, mean p set: 0.4516505002975464
loss_pred:0.03551362454891205, decouple_loss:0.031306199729442596
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532493054866791, gen p mean: -0.46760302782058716, mean p set: 0.4537295699119568
The modified gen p mean: 0.45228126645088196, gen p mean: -0.47322580218315125, mean p set: 0.45276156067848206
loss_pred:0.03522862121462822, decouple_loss:0.030913345515727997
The modified gen p mean: 0.4512014091014862, gen p mean: -0.46197399497032166, mean p set: 0.4516817331314087loss_pred:0.035586439073085785, decouple_loss:0.031010136008262634
loss_pred:0.03529481589794159, decouple_loss:0.03171759471297264
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519462585449219, gen p mean: -0.4864467978477478, mean p set: 0.45242658257484436
The modified gen p mean: 0.4519652724266052, gen p mean: -0.4887953996658325, mean p set: 0.4524455666542053
The modified gen p mean: 0.45290035009384155, gen p mean: -0.4814082980155945, mean p set: 0.45338064432144165loss_pred:0.03630765900015831, decouple_loss:0.030576709657907486
loss_pred:0.0358545184135437, decouple_loss:0.030233873054385185
loss_pred:0.0370316356420517, decouple_loss:0.0314650759100914
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523015320301056, gen p mean: -0.4909489154815674, mean p set: 0.4527818560600281
The modified gen p mean: 0.4510310888290405, gen p mean: -0.4813442826271057, mean p set: 0.4515113830566406
loss_pred:0.03551655262708664, decouple_loss:0.030050743371248245
loss_pred:0.03549928590655327, decouple_loss:0.02997436746954918
The modified gen p mean: 0.4507405161857605, gen p mean: -0.4847990572452545, mean p set: 0.4512208104133606
loss_pred:0.03512333706021309, decouple_loss:0.032314643263816833
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45273318886756897, gen p mean: -0.4829287827014923, mean p set: 0.45321348309516907
The modified gen p mean: 0.45334434509277344, gen p mean: -0.47555026412010193, mean p set: 0.45382463932037354
The modified gen p mean: 0.4514361321926117, gen p mean: -0.4767864942550659, mean p set: 0.4519164264202118
loss_pred:0.035387057811021805, decouple_loss:0.03015357069671154
loss_pred:0.03662236034870148, decouple_loss:0.029623014852404594
loss_pred:0.03676806390285492, decouple_loss:0.02933034673333168
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530911147594452, gen p mean: -0.48127275705337524, mean p set: 0.4535713791847229
The modified gen p mean: 0.45282450318336487, gen p mean: -0.4795219302177429, mean p set: 0.4533047676086426
loss_pred:0.03518008813261986, decouple_loss:0.030287761241197586
loss_pred:0.036085426807403564, decouple_loss:0.02974660135805607
The modified gen p mean: 0.4499375522136688, gen p mean: -0.4695991575717926, mean p set: 0.4504178762435913
loss_pred:0.03631345555186272, decouple_loss:0.030236320570111275
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060399174690247, gen p mean: -0.47223061323165894, mean p set: 0.45108428597450256
The modified gen p mean: 0.45161470770835876, gen p mean: -0.48250603675842285, mean p set: 0.45209503173828125
The modified gen p mean: 0.45204100012779236, gen p mean: -0.4808231294155121, mean p set: 0.45252126455307007
loss_pred:0.036345239728689194, decouple_loss:0.030339719727635384
loss_pred:0.03485937789082527, decouple_loss:0.02999512106180191loss_pred:0.035018209367990494, decouple_loss:0.03103983961045742
2023-05-01 18:05:25 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.49159860610961914, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4798986315727234, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.48340386152267456, mean p set: 0.4500633478164673
loss_pred:0.037890516221523285, decouple_loss:0.03297105059027672
loss_pred:0.03590947762131691, decouple_loss:0.03302759677171707
loss_pred:0.03673671558499336, decouple_loss:0.03193286061286926
WV_0_PC_1_EH_0_PS_40_5, loss: 0.038477763533592224, avg_mse: 0.04068872332572937
current test mse: 0.040689
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501190483570099, gen p mean: -0.47965705394744873, mean p set: 0.4505993127822876
The modified gen p mean: 0.45040592551231384, gen p mean: -0.485421746969223, mean p set: 0.45088624954223633
loss_pred:0.03590944781899452, decouple_loss:0.03063119947910309
The modified gen p mean: 0.4513079524040222, gen p mean: -0.4855130612850189, mean p set: 0.4517882466316223
loss_pred:0.03571869432926178, decouple_loss:0.029809044674038887
loss_pred:0.03582990542054176, decouple_loss:0.030467651784420013
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45404502749443054, gen p mean: -0.49540096521377563, mean p set: 0.45452532172203064
The modified gen p mean: 0.45117464661598206, gen p mean: -0.4797954857349396, mean p set: 0.45165497064590454
loss_pred:0.03640022128820419, decouple_loss:0.031424928456544876
loss_pred:0.036859698593616486, decouple_loss:0.028563791885972023
The modified gen p mean: 0.45201167464256287, gen p mean: -0.4834619462490082, mean p set: 0.45249199867248535
loss_pred:0.036069098860025406, decouple_loss:0.029639994725584984
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977107644081116, gen p mean: -0.4763735234737396, mean p set: 0.45025137066841125
The modified gen p mean: 0.45217084884643555, gen p mean: -0.47889846563339233, mean p set: 0.45265111327171326
loss_pred:0.035014424473047256, decouple_loss:0.030642302706837654
loss_pred:0.03588753193616867, decouple_loss:0.030190186575055122
The modified gen p mean: 0.450573205947876, gen p mean: -0.47357526421546936, mean p set: 0.45105352997779846
loss_pred:0.03677009046077728, decouple_loss:0.028611788526177406
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058473944664, gen p mean: -0.47921815514564514, mean p set: 0.4510650634765625
The modified gen p mean: 0.4519380033016205, gen p mean: -0.48744070529937744, mean p set: 0.4524182975292206loss_pred:0.035202015191316605, decouple_loss:0.02843824215233326
The modified gen p mean: 0.4505559802055359, gen p mean: -0.4810051918029785, mean p set: 0.4510363042354584
loss_pred:0.035272758454084396, decouple_loss:0.029344631358981133
loss_pred:0.034785956144332886, decouple_loss:0.02952851541340351
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024576783180237, gen p mean: -0.4884771704673767, mean p set: 0.4507260322570801
The modified gen p mean: 0.45240917801856995, gen p mean: -0.4912739396095276, mean p set: 0.45288947224617004
loss_pred:0.03562659025192261, decouple_loss:0.02948739007115364
loss_pred:0.035385068506002426, decouple_loss:0.02804557979106903
The modified gen p mean: 0.451864093542099, gen p mean: -0.48792582750320435, mean p set: 0.4523443579673767
loss_pred:0.034980807453393936, decouple_loss:0.030033504590392113
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45310527086257935, gen p mean: -0.4972524344921112, mean p set: 0.45358556509017944
The modified gen p mean: 0.45258834958076477, gen p mean: -0.4838148057460785, mean p set: 0.45306864380836487
loss_pred:0.03529452905058861, decouple_loss:0.029350673779845238
loss_pred:0.03605946898460388, decouple_loss:0.029160553589463234
The modified gen p mean: 0.45174407958984375, gen p mean: -0.48935964703559875, mean p set: 0.45222437381744385
loss_pred:0.03544706478714943, decouple_loss:0.0287458598613739
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523387849330902, gen p mean: -0.48937779664993286, mean p set: 0.4528190791606903
loss_pred:0.034900423139333725, decouple_loss:0.029277803376317024
The modified gen p mean: 0.4497024118900299, gen p mean: -0.4811408221721649, mean p set: 0.45018270611763The modified gen p mean: 0.4507555365562439, gen p mean: -0.48150771856307983, mean p set: 0.451235830783844
loss_pred:0.03424641117453575, decouple_loss:0.028849942609667778
loss_pred:0.034081265330314636, decouple_loss:0.027897950261831284
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475573003292084, gen p mean: -0.49814045429229736, mean p set: 0.44803762435913086
loss_pred:0.036806631833314896, decouple_loss:0.033132705837488174
The modified gen p mean: 0.44653376936912537, gen p mean: -0.5019524097442627, mean p set: 0.44701406359672546The modified gen p mean: 0.4476628601551056, gen p mean: -0.49114805459976196, mean p set: 0.4481431543827057
loss_pred:0.038031186908483505, decouple_loss:0.0349930040538311
loss_pred:0.035675425082445145, decouple_loss:0.033496540039777756
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644472002983093, gen p mean: -0.49576976895332336, mean p set: 0.4469250440597534
The modified gen p mean: 0.4470219612121582, gen p mean: -0.48772647976875305, mean p set: 0.4475022256374359
The modified gen p mean: 0.44799819588661194, gen p mean: -0.48552340269088745, mean p set: 0.44847849011421204loss_pred:0.03801135718822479, decouple_loss:0.03584185987710953
loss_pred:0.0360967181622982, decouple_loss:0.03321258723735809
loss_pred:0.0363052599132061, decouple_loss:0.03322600945830345
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770723581314087, gen p mean: -0.4801952540874481, mean p set: 0.44818755984306335
The modified gen p mean: 0.4469941556453705, gen p mean: -0.47570645809173584, mean p set: 0.44747447967529297
loss_pred:0.0357978455722332, decouple_loss:0.030781446024775505
loss_pred:0.03596360981464386, decouple_loss:0.03180551901459694
The modified gen p mean: 0.4481533467769623, gen p mean: -0.48003581166267395, mean p set: 0.4486336410045624
loss_pred:0.03667381778359413, decouple_loss:0.030813662335276604
2023-05-01 18:08:15 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.48312509059906006, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.472426176071167, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4761355519294739, mean p set: 0.4500633478164673
loss_pred:0.03752511367201805, decouple_loss:0.030646899715065956
loss_pred:0.035746585577726364, decouple_loss:0.031419944018125534
loss_pred:0.03647426888346672, decouple_loss:0.03043580986559391
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03812370076775551, avg_mse: 0.04036719724535942
current test mse: 0.040367
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466207027435303, gen p mean: -0.4785263240337372, mean p set: 0.44710099697113037
The modified gen p mean: 0.4461544156074524, gen p mean: -0.479079008102417, mean p set: 0.4466347098350525
loss_pred:0.03689834848046303, decouple_loss:0.03028915636241436
The modified gen p mean: 0.44694459438323975, gen p mean: -0.4818945825099945, mean p set: 0.44742488861083984
loss_pred:0.03518075495958328, decouple_loss:0.03032282553613186
loss_pred:0.03816528990864754, decouple_loss:0.03073381818830967
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44523462653160095, gen p mean: -0.47956421971321106, mean p set: 0.44571492075920105
The modified gen p mean: 0.4470917880535126, gen p mean: -0.4841272830963135, mean p set: 0.44757208228111267
The modified gen p mean: 0.44574248790740967, gen p mean: -0.4821532070636749, mean p set: 0.4462227523326874
loss_pred:0.034604452550411224, decouple_loss:0.030219996348023415
loss_pred:0.0340389646589756, decouple_loss:0.030969399958848953
loss_pred:0.03458629921078682, decouple_loss:0.02911980263888836
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470854103565216, gen p mean: -0.49623528122901917, mean p set: 0.4475656747817993
The modified gen p mean: 0.4468749761581421, gen p mean: -0.49779826402664185, mean p set: 0.4473552703857422
The modified gen p mean: 0.44879624247550964, gen p mean: -0.4928307831287384, mean p set: 0.44927650690078735
loss_pred:0.03494399040937424, decouple_loss:0.03199292719364166
loss_pred:0.03503018245100975, decouple_loss:0.03328679874539375loss_pred:0.03525979444384575, decouple_loss:0.03131483867764473
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811418652534485, gen p mean: -0.48834648728370667, mean p set: 0.44859448075294495
The modified gen p mean: 0.4465906322002411, gen p mean: -0.49509936571121216, mean p set: 0.4470709264278412
The modified gen p mean: 0.44881632924079895, gen p mean: -0.4913420081138611, mean p set: 0.44929662346839905
loss_pred:0.03825279325246811, decouple_loss:0.03185417875647545
loss_pred:0.0367487296462059, decouple_loss:0.033129144459962845
loss_pred:0.036283329129219055, decouple_loss:0.030986234545707703
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448044091463089, gen p mean: -0.48701244592666626, mean p set: 0.4485243558883667
The modified gen p mean: 0.4480348825454712, gen p mean: -0.48007866740226746, mean p set: 0.4485151767730713
loss_pred:0.03405836224555969, decouple_loss:0.029966747388243675
loss_pred:0.03460384160280228, decouple_loss:0.029703687876462936
The modified gen p mean: 0.4460342228412628, gen p mean: -0.47992339730262756, mean p set: 0.44651445746421814
loss_pred:0.034606385976076126, decouple_loss:0.0293352622538805
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729161262512207, gen p mean: -0.46607816219329834, mean p set: 0.44777190685272217
The modified gen p mean: 0.4466317892074585, gen p mean: -0.4732893109321594, mean p set: 0.4471120834350586
The modified gen p mean: 0.4455767571926117, gen p mean: -0.46950915455818176, mean p set: 0.4460570514202118
loss_pred:0.03455101326107979, decouple_loss:0.029287798330187798
loss_pred:0.03392857313156128, decouple_loss:0.029682420194149017loss_pred:0.037645675241947174, decouple_loss:0.029295826330780983
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479070007801056, gen p mean: -0.4684963822364807, mean p set: 0.4483872950077057
The modified gen p mean: 0.4478265643119812, gen p mean: -0.46739545464515686, mean p set: 0.4483067989349365
The modified gen p mean: 0.4472263753414154, gen p mean: -0.47011226415634155, mean p set: 0.4477066397666931
loss_pred:0.03534785658121109, decouple_loss:0.029393348842859268
loss_pred:0.037018753588199615, decouple_loss:0.02958924137055874loss_pred:0.03697904944419861, decouple_loss:0.02949225902557373
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446011483669281, gen p mean: -0.47775158286094666, mean p set: 0.44649171829223633
The modified gen p mean: 0.4486105442047119, gen p mean: -0.48187005519866943, mean p set: 0.449090838432312
loss_pred:0.036940690129995346, decouple_loss:0.029041003435850143
loss_pred:0.03535483777523041, decouple_loss:0.02962864749133587
The modified gen p mean: 0.4466645419597626, gen p mean: -0.47900235652923584, mean p set: 0.44714486598968506
loss_pred:0.03737109899520874, decouple_loss:0.028238466009497643
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475003480911255, gen p mean: -0.4738141596317291, mean p set: 0.4479806125164032
The modified gen p mean: 0.4484339952468872, gen p mean: -0.47877418994903564, mean p set: 0.4489142596721649
loss_pred:0.03515664115548134, decouple_loss:0.027877014130353928
loss_pred:0.03557179495692253, decouple_loss:0.028059903532266617
The modified gen p mean: 0.4459710121154785, gen p mean: -0.4790201187133789, mean p set: 0.4464513063430786
loss_pred:0.03689008206129074, decouple_loss:0.02926069125533104
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648081064224243, gen p mean: -0.47469064593315125, mean p set: 0.44696107506752014
The modified gen p mean: 0.44795510172843933, gen p mean: -0.47784414887428284, mean p set: 0.44843539595603943
The modified gen p mean: 0.447291761636734, gen p mean: -0.4741833209991455, mean p set: 0.4477720260620117loss_pred:0.03573164716362953, decouple_loss:0.028019214048981667
loss_pred:0.03356783464550972, decouple_loss:0.029833290725946426
loss_pred:0.03616848215460777, decouple_loss:0.027957910671830177
2023-05-01 18:10:23 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.4796839654445648, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4697205126285553, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4729671776294708, mean p set: 0.4500633478164673
loss_pred:0.03686487302184105, decouple_loss:0.029229355975985527
loss_pred:0.03514072671532631, decouple_loss:0.02868078090250492
loss_pred:0.03597024828195572, decouple_loss:0.028345655649900436
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03742954879999161, avg_mse: 0.039641205221414566
current test mse: 0.039641
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481518566608429, gen p mean: -0.47237324714660645, mean p set: 0.4486321210861206
The modified gen p mean: 0.44880780577659607, gen p mean: -0.4782085120677948, mean p set: 0.44928810000419617
loss_pred:0.03624793142080307, decouple_loss:0.027714526280760765
The modified gen p mean: 0.4472421705722809, gen p mean: -0.4785144329071045, mean p set: 0.44772249460220337
loss_pred:0.034956954419612885, decouple_loss:0.027324361726641655
loss_pred:0.03465316444635391, decouple_loss:0.028275899589061737
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767576456069946, gen p mean: -0.472538560628891, mean p set: 0.44815605878829956
The modified gen p mean: 0.4467603862285614, gen p mean: -0.4723576307296753, mean p set: 0.4472406804561615
loss_pred:0.0342443622648716, decouple_loss:0.027257483452558517
loss_pred:0.03577978163957596, decouple_loss:0.026224832981824875
The modified gen p mean: 0.44669002294540405, gen p mean: -0.47885841131210327, mean p set: 0.44717034697532654
loss_pred:0.03653964027762413, decouple_loss:0.02910982444882393
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639065861701965, gen p mean: -0.4678995609283447, mean p set: 0.44687098264694214
The modified gen p mean: 0.4478665292263031, gen p mean: -0.46625569462776184, mean p set: 0.4483468234539032
loss_pred:0.03497304767370224, decouple_loss:0.026305343955755234
loss_pred:0.03508305177092552, decouple_loss:0.027342859655618668
The modified gen p mean: 0.4462290108203888, gen p mean: -0.47236180305480957, mean p set: 0.4467092752456665
loss_pred:0.03693857043981552, decouple_loss:0.027507370337843895
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477525055408478, gen p mean: -0.47629809379577637, mean p set: 0.44823282957077026
The modified gen p mean: 0.44639313220977783, gen p mean: -0.4743306040763855, mean p set: 0.44687342643737793
loss_pred:0.03552430495619774, decouple_loss:0.02758890949189663
loss_pred:0.036613963544368744, decouple_loss:0.026778142899274826
The modified gen p mean: 0.44730597734451294, gen p mean: -0.47133415937423706, mean p set: 0.44778627157211304
loss_pred:0.03509334474802017, decouple_loss:0.025735322386026382
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483518600463867, gen p mean: -0.4703945219516754, mean p set: 0.4488321542739868
The modified gen p mean: 0.44865885376930237, gen p mean: -0.4752429127693176, mean p set: 0.44913914799690247
loss_pred:0.03425506502389908, decouple_loss:0.02677048370242119
loss_pred:0.03629685565829277, decouple_loss:0.027699148282408714
The modified gen p mean: 0.44720178842544556, gen p mean: -0.4659366011619568, mean p set: 0.44768208265304565
loss_pred:0.03404120355844498, decouple_loss:0.02728523500263691
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723355770111084, gen p mean: -0.46792322397232056, mean p set: 0.4477138817310333
The modified gen p mean: 0.44825175404548645, gen p mean: -0.471465528011322, mean p set: 0.44873204827308655
loss_pred:0.03458781540393829, decouple_loss:0.025928784161806107
loss_pred:0.03340604528784752, decouple_loss:0.02678673528134823
The modified gen p mean: 0.4482642710208893, gen p mean: -0.47130611538887024, mean p set: 0.4487445652484894
loss_pred:0.03475423902273178, decouple_loss:0.025931844487786293
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481727182865143, gen p mean: -0.4585762023925781, mean p set: 0.4486530125141144
The modified gen p mean: 0.4474366009235382, gen p mean: -0.45328909158706665, mean p set: 0.4479168951511383
The modified gen p mean: 0.4490118622779846, gen p mean: -0.4632694721221924, mean p set: 0.44949212670326233
loss_pred:0.03808438777923584, decouple_loss:0.027423718944191933
loss_pred:0.03395821154117584, decouple_loss:0.02561669796705246
loss_pred:0.035164397209882736, decouple_loss:0.028420329093933105
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641295075416565, gen p mean: -0.46752694249153137, mean p set: 0.44689324498176575
loss_pred:0.03737420588731766, decouple_loss:0.025993587449193
The modified gen p mean: 0.4481782019138336, gen p mean: -0.47149673104286194, mean p set: 0.4486584961414337The modified gen p mean: 0.445679634809494, gen p mean: -0.46692898869514465, mean p set: 0.4461599588394165
loss_pred:0.035052426159381866, decouple_loss:0.027960726991295815
loss_pred:0.03549382463097572, decouple_loss:0.028469303622841835
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710493087768555, gen p mean: -0.4680292010307312, mean p set: 0.44758522510528564
The modified gen p mean: 0.44760072231292725, gen p mean: -0.4703418016433716, mean p set: 0.44808098673820496
loss_pred:0.035682763904333115, decouple_loss:0.026054907590150833
loss_pred:0.035820428282022476, decouple_loss:0.025978757068514824
The modified gen p mean: 0.44817230105400085, gen p mean: -0.4759238064289093, mean p set: 0.44865259528160095
loss_pred:0.03557214513421059, decouple_loss:0.02820083498954773
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44577547907829285, gen p mean: -0.4637031853199005, mean p set: 0.44625577330589294
The modified gen p mean: 0.4472636878490448, gen p mean: -0.4657667279243469, mean p set: 0.4477439522743225
The modified gen p mean: 0.4468764066696167, gen p mean: -0.46831053495407104, mean p set: 0.4473566710948944
loss_pred:0.03623998537659645, decouple_loss:0.028760362416505814
loss_pred:0.035135652869939804, decouple_loss:0.027766365557909012loss_pred:0.035731397569179535, decouple_loss:0.02808140031993389
2023-05-01 18:13:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.47561269998550415, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4655044972896576, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.4693284034729004, mean p set: 0.4500633478164673
loss_pred:0.03672812134027481, decouple_loss:0.02749616652727127
loss_pred:0.03487678989768028, decouple_loss:0.02838655188679695
loss_pred:0.035839490592479706, decouple_loss:0.027291692793369293
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03720104321837425, avg_mse: 0.03949207440018654
current test mse: 0.039492
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667908549308777, gen p mean: -0.47198426723480225, mean p set: 0.44715940952301025
The modified gen p mean: 0.44904762506484985, gen p mean: -0.4828363358974457, mean p set: 0.44952791929244995
loss_pred:0.0352647490799427, decouple_loss:0.029101524502038956
The modified gen p mean: 0.4459315538406372, gen p mean: -0.4728463292121887, mean p set: 0.4464118480682373
loss_pred:0.03563050925731659, decouple_loss:0.02661256678402424
loss_pred:0.03643442317843437, decouple_loss:0.027383804321289062
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746023416519165, gen p mean: -0.4769176244735718, mean p set: 0.44794052839279175
The modified gen p mean: 0.4482031464576721, gen p mean: -0.4809156656265259, mean p set: 0.44868341088294983
loss_pred:0.034271471202373505, decouple_loss:0.027871601283550262
loss_pred:0.03523474559187889, decouple_loss:0.02882223203778267
The modified gen p mean: 0.44627130031585693, gen p mean: -0.47821101546287537, mean p set: 0.44675159454345703
loss_pred:0.03514545038342476, decouple_loss:0.027246981859207153
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751569628715515, gen p mean: -0.4655526280403137, mean p set: 0.44799599051475525
The modified gen p mean: 0.44620752334594727, gen p mean: -0.4678075909614563, mean p set: 0.44668781757354736
loss_pred:0.034696198999881744, decouple_loss:0.026449840515851974
loss_pred:0.03601708635687828, decouple_loss:0.02636188641190529
The modified gen p mean: 0.4473292827606201, gen p mean: -0.468240350484848, mean p set: 0.4478095471858978
loss_pred:0.03440218046307564, decouple_loss:0.026732591912150383
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883668422698975, gen p mean: -0.4757402837276459, mean p set: 0.44931700825691223
The modified gen p mean: 0.4479667544364929, gen p mean: -0.4720097780227661, mean p set: 0.4484470784664154
loss_pred:0.03511418402194977, decouple_loss:0.02833070419728756
loss_pred:0.03475506976246834, decouple_loss:0.027346521615982056
The modified gen p mean: 0.4461468756198883, gen p mean: -0.4637955129146576, mean p set: 0.4466271698474884
loss_pred:0.03576858341693878, decouple_loss:0.025561468675732613
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458253085613251, gen p mean: -0.47552919387817383, mean p set: 0.44630563259124756
The modified gen p mean: 0.4452894926071167, gen p mean: -0.4780590534210205, mean p set: 0.4457697868347168
loss_pred:0.03483739122748375, decouple_loss:0.025345468893647194
loss_pred:0.034525904804468155, decouple_loss:0.027953345328569412
The modified gen p mean: 0.44582659006118774, gen p mean: -0.4738253057003021, mean p set: 0.44630685448646545
loss_pred:0.03649044781923294, decouple_loss:0.02874721586704254
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810667634010315, gen p mean: -0.48431479930877686, mean p set: 0.44858697056770325
The modified gen p mean: 0.4478110074996948, gen p mean: -0.4833703339099884, mean p set: 0.4482913017272949
loss_pred:0.03487217426300049, decouple_loss:0.026763835921883583
loss_pred:0.03502697870135307, decouple_loss:0.02741291932761669
The modified gen p mean: 0.44734594225883484, gen p mean: -0.47975364327430725, mean p set: 0.44782623648643494
loss_pred:0.03519861772656441, decouple_loss:0.027538325637578964
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44525769352912903, gen p mean: -0.4853517413139343, mean p set: 0.44573795795440674
The modified gen p mean: 0.4468236267566681, gen p mean: -0.48151895403862, mean p set: 0.4473038911819458
loss_pred:0.034848038107156754, decouple_loss:0.027928268536925316
loss_pred:0.033981747925281525, decouple_loss:0.02685481496155262
The modified gen p mean: 0.4464486241340637, gen p mean: -0.4841993451118469, mean p set: 0.4469289183616638
loss_pred:0.03454769402742386, decouple_loss:0.0271444208920002
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704756140708923, gen p mean: -0.47881320118904114, mean p set: 0.44752782583236694
The modified gen p mean: 0.4459937512874603, gen p mean: -0.47623416781425476, mean p set: 0.44647401571273804
loss_pred:0.03669082745909691, decouple_loss:0.026667386293411255
loss_pred:0.03668128699064255, decouple_loss:0.0279861968010664
The modified gen p mean: 0.44691959023475647, gen p mean: -0.47974488139152527, mean p set: 0.4473998546600342
loss_pred:0.03552998974919319, decouple_loss:0.026750432327389717
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480065703392029, gen p mean: -0.48714685440063477, mean p set: 0.448486864566803
The modified gen p mean: 0.44739651679992676, gen p mean: -0.4780466854572296, mean p set: 0.44787678122520447
loss_pred:0.03627685829997063, decouple_loss:0.02590845711529255
loss_pred:0.03573201224207878, decouple_loss:0.024955416098237038
The modified gen p mean: 0.4468863010406494, gen p mean: -0.48127123713493347, mean p set: 0.4473665952682495
loss_pred:0.03592804819345474, decouple_loss:0.026402026414871216
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44646894931793213, gen p mean: -0.48326605558395386, mean p set: 0.44694921374320984
The modified gen p mean: 0.4463035464286804, gen p mean: -0.478241890668869, mean p set: 0.4467838406562805The modified gen p mean: 0.44647493958473206, gen p mean: -0.4805082678794861, mean p set: 0.44695523381233215
loss_pred:0.03541049361228943, decouple_loss:0.02675861492753029
loss_pred:0.03560526296496391, decouple_loss:0.026538332924246788loss_pred:0.03454035520553589, decouple_loss:0.026782622560858727
2023-05-01 18:15:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.48169243335723877, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4758308231830597, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.47177913784980774, mean p set: 0.45035696029663086
loss_pred:0.0365341491997242, decouple_loss:0.02732977643609047
loss_pred:0.03558999300003052, decouple_loss:0.02708122693002224
loss_pred:0.034717075526714325, decouple_loss:0.028249241411685944
WV_0_PC_1_EH_0_PS_40_5, loss: 0.036991409957408905, avg_mse: 0.03924363851547241
current test mse: 0.039244
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44632503390312195, gen p mean: -0.47844475507736206, mean p set: 0.44680535793304443
loss_pred:0.034950222820043564, decouple_loss:0.02588907815515995
The modified gen p mean: 0.4462599754333496, gen p mean: -0.48101404309272766, mean p set: 0.4467402696609497
The modified gen p mean: 0.4460950493812561, gen p mean: -0.48259133100509644, mean p set: 0.4465752840042114
loss_pred:0.03660869598388672, decouple_loss:0.025889554992318153
loss_pred:0.036326948553323746, decouple_loss:0.025772182270884514
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456849694252014, gen p mean: -0.4789672791957855, mean p set: 0.4461652636528015
The modified gen p mean: 0.448574036359787, gen p mean: -0.48521414399147034, mean p set: 0.4490543007850647
loss_pred:0.03563113138079643, decouple_loss:0.02725008688867092
loss_pred:0.03613391891121864, decouple_loss:0.02796686813235283
The modified gen p mean: 0.4475928544998169, gen p mean: -0.48295438289642334, mean p set: 0.448073148727417
loss_pred:0.03570524603128433, decouple_loss:0.027539825066924095
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885823130607605, gen p mean: -0.48366779088974, mean p set: 0.44933852553367615
The modified gen p mean: 0.44664016366004944, gen p mean: -0.47227051854133606, mean p set: 0.44712045788764954
loss_pred:0.03583983704447746, decouple_loss:0.02689128927886486
loss_pred:0.035181473940610886, decouple_loss:0.02629265934228897
The modified gen p mean: 0.4472138285636902, gen p mean: -0.47578534483909607, mean p set: 0.4476941227912903
loss_pred:0.03646538779139519, decouple_loss:0.026754433289170265
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483022689819336, gen p mean: -0.4822681248188019, mean p set: 0.4487825632095337
The modified gen p mean: 0.44859594106674194, gen p mean: -0.4851336181163788, mean p set: 0.44907623529434204
loss_pred:0.035068802535533905, decouple_loss:0.0273421760648489
loss_pred:0.036060135811567307, decouple_loss:0.027157828211784363
The modified gen p mean: 0.4467659592628479, gen p mean: -0.47208699584007263, mean p set: 0.447246253490448
loss_pred:0.035077258944511414, decouple_loss:0.025861244648694992
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466208219528198, gen p mean: -0.486125111579895, mean p set: 0.4471011161804199
The modified gen p mean: 0.4474707841873169, gen p mean: -0.47787782549858093, mean p set: 0.447951078414917
loss_pred:0.03530782833695412, decouple_loss:0.026694415137171745
loss_pred:0.03544832393527031, decouple_loss:0.025728244334459305
The modified gen p mean: 0.4473477303981781, gen p mean: -0.48462826013565063, mean p set: 0.4478280544281006
loss_pred:0.0343596413731575, decouple_loss:0.026103416457772255
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466908872127533, gen p mean: -0.4739220142364502, mean p set: 0.4471711814403534
The modified gen p mean: 0.44677528738975525, gen p mean: -0.47236454486846924, mean p set: 0.44725558161735535
loss_pred:0.03525572270154953, decouple_loss:0.02547432854771614
loss_pred:0.034910354763269424, decouple_loss:0.026314491406083107
The modified gen p mean: 0.44625359773635864, gen p mean: -0.4721473753452301, mean p set: 0.44673389196395874
loss_pred:0.03505526855587959, decouple_loss:0.02685639262199402
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44603100419044495, gen p mean: -0.4706350564956665, mean p set: 0.44651132822036743
The modified gen p mean: 0.4467124044895172, gen p mean: -0.46696174144744873, mean p set: 0.4471926689147949
loss_pred:0.03608633205294609, decouple_loss:0.02629449963569641
loss_pred:0.03601529821753502, decouple_loss:0.027314351871609688
The modified gen p mean: 0.44879671931266785, gen p mean: -0.4778331518173218, mean p set: 0.44927704334259033
loss_pred:0.03500620648264885, decouple_loss:0.026176873594522476
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
NaN value num: 0
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512425363063812, gen p mean: -0.48310139775276184, mean p set: 0.4517228305339813
loss_pred:0.037886492908000946, decouple_loss:0.03364389017224312
The modified gen p mean: 0.45175787806510925, gen p mean: -0.4805058538913727, mean p set: 0.45223820209503174The modified gen p mean: 0.45156583189964294, gen p mean: -0.48226842284202576, mean p set: 0.45204612612724304
loss_pred:0.03623431548476219, decouple_loss:0.031850993633270264
loss_pred:0.03561672195792198, decouple_loss:0.03168323636054993
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514380693435669, gen p mean: -0.4852461516857147, mean p set: 0.451918363571167
The modified gen p mean: 0.451314777135849, gen p mean: -0.48122844099998474, mean p set: 0.4517951011657715
loss_pred:0.03699244558811188, decouple_loss:0.03148740157485008
loss_pred:0.037668902426958084, decouple_loss:0.0335552841424942
The modified gen p mean: 0.4532906711101532, gen p mean: -0.4810543358325958, mean p set: 0.4537709653377533
loss_pred:0.03612217307090759, decouple_loss:0.0320085845887661
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511440396308899, gen p mean: -0.4777286946773529, mean p set: 0.45162433385849
The modified gen p mean: 0.450717568397522, gen p mean: -0.46532732248306274, mean p set: 0.45119786262512207
loss_pred:0.038561321794986725, decouple_loss:0.03273705020546913
loss_pred:0.03713206946849823, decouple_loss:0.03222259506583214
The modified gen p mean: 0.45226433873176575, gen p mean: -0.4725598096847534, mean p set: 0.45274466276168823
loss_pred:0.03763566538691521, decouple_loss:0.031323906034231186
2023-05-01 18:18:01 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.479316771030426, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.47048860788345337, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.4739493429660797, mean p set: 0.4500633478164673
loss_pred:0.03670327365398407, decouple_loss:0.029524417594075203
loss_pred:0.03501352295279503, decouple_loss:0.029435567557811737
loss_pred:0.03581423684954643, decouple_loss:0.028322715312242508
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03729838877916336, avg_mse: 0.03976570442318916
current test mse: 0.039766
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506503641605377, gen p mean: -0.47459888458251953, mean p set: 0.4511306881904602
The modified gen p mean: 0.45154112577438354, gen p mean: -0.4692775011062622, mean p set: 0.45202142000198364
loss_pred:0.037307146936655045, decouple_loss:0.030715230852365494
The modified gen p mean: 0.45206692814826965, gen p mean: -0.47277262806892395, mean p set: 0.45254722237586975
loss_pred:0.03540455922484398, decouple_loss:0.029595281928777695
loss_pred:0.03551306203007698, decouple_loss:0.030719203874468803
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501608610153198, gen p mean: -0.4846356511116028, mean p set: 0.45064112544059753
The modified gen p mean: 0.45160067081451416, gen p mean: -0.47571220993995667, mean p set: 0.45208099484443665
loss_pred:0.037410467863082886, decouple_loss:0.028978101909160614
loss_pred:0.03708687797188759, decouple_loss:0.02989543229341507
The modified gen p mean: 0.4522475302219391, gen p mean: -0.47762390971183777, mean p set: 0.4527277946472168
loss_pred:0.03792668879032135, decouple_loss:0.030405940487980843
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45239225029945374, gen p mean: -0.4950563907623291, mean p set: 0.45287254452705383
loss_pred:0.03730408847332001, decouple_loss:0.031056005507707596The modified gen p mean: 0.4514700770378113, gen p mean: -0.49181482195854187, mean p set: 0.45195040106773376
The modified gen p mean: 0.4511578679084778, gen p mean: -0.4918312132358551, mean p set: 0.4516381621360779
loss_pred:0.03677469119429588, decouple_loss:0.02941717952489853
loss_pred:0.03576982766389847, decouple_loss:0.029902780428528786
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510784447193146, gen p mean: -0.49372386932373047, mean p set: 0.4515587389469147
The modified gen p mean: 0.4506472051143646, gen p mean: -0.48625925183296204, mean p set: 0.4511275291442871
The modified gen p mean: 0.4527044892311096, gen p mean: -0.49550577998161316, mean p set: 0.45318475365638733
loss_pred:0.0361352376639843, decouple_loss:0.02941828779876232
loss_pred:0.03431311622262001, decouple_loss:0.029253080487251282loss_pred:0.03657624498009682, decouple_loss:0.029563719406723976
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507308900356293, gen p mean: -0.4793533384799957, mean p set: 0.45121118426322937
The modified gen p mean: 0.45397210121154785, gen p mean: -0.4898632764816284, mean p set: 0.45445236563682556
The modified gen p mean: 0.45111456513404846, gen p mean: -0.4873707890510559, mean p set: 0.45159485936164856
loss_pred:0.036409892141819, decouple_loss:0.030661191791296005
loss_pred:0.03571333736181259, decouple_loss:0.0299445278942585
loss_pred:0.034961845725774765, decouple_loss:0.029642879962921143
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45255428552627563, gen p mean: -0.487582266330719, mean p set: 0.4530346095561981
The modified gen p mean: 0.4505658447742462, gen p mean: -0.4872201383113861, mean p set: 0.4510461390018463
The modified gen p mean: 0.4506746232509613, gen p mean: -0.4839964807033539, mean p set: 0.4511549472808838loss_pred:0.03555154800415039, decouple_loss:0.030115893110632896
loss_pred:0.03690124675631523, decouple_loss:0.03018134832382202
loss_pred:0.036411989480257034, decouple_loss:0.0290424432605505
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538593888282776, gen p mean: -0.4911714792251587, mean p set: 0.4543396830558777
The modified gen p mean: 0.45117104053497314, gen p mean: -0.49046653509140015, mean p set: 0.45165136456489563
loss_pred:0.0358569473028183, decouple_loss:0.029503971338272095
loss_pred:0.036143939942121506, decouple_loss:0.02869758941233158
The modified gen p mean: 0.4502146244049072, gen p mean: -0.4853318929672241, mean p set: 0.4506949186325073
loss_pred:0.037632472813129425, decouple_loss:0.029059603810310364
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513789713382721, gen p mean: -0.49205321073532104, mean p set: 0.4518592655658722
The modified gen p mean: 0.4522682726383209, gen p mean: -0.49617189168930054, mean p set: 0.4527485966682434
loss_pred:0.03733547776937485, decouple_loss:0.029339509084820747
loss_pred:0.03531081601977348, decouple_loss:0.028182536363601685
The modified gen p mean: 0.4514193832874298, gen p mean: -0.49045559763908386, mean p set: 0.4518997073173523
loss_pred:0.037152621895074844, decouple_loss:0.029860474169254303
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532765746116638, gen p mean: -0.5006235241889954, mean p set: 0.4537568688392639
The modified gen p mean: 0.45178964734077454, gen p mean: -0.4983487129211426, mean p set: 0.45226994156837463
The modified gen p mean: 0.4511788487434387, gen p mean: -0.4954197108745575, mean p set: 0.4516591429710388
loss_pred:0.035140104591846466, decouple_loss:0.02832016348838806
loss_pred:0.03459850698709488, decouple_loss:0.027422962710261345
loss_pred:0.03574593737721443, decouple_loss:0.029466934502124786
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451603502035141, gen p mean: -0.49159765243530273, mean p set: 0.4520838260650635
The modified gen p mean: 0.4534396529197693, gen p mean: -0.4924219250679016, mean p set: 0.4539199471473694
loss_pred:0.036136072129011154, decouple_loss:0.02918424643576145
loss_pred:0.0344972126185894, decouple_loss:0.028626639395952225
The modified gen p mean: 0.4516028165817261, gen p mean: -0.4840214252471924, mean p set: 0.4520830810070038
loss_pred:0.037275806069374084, decouple_loss:0.03090815804898739
2023-05-01 18:20:10 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.49538177251815796, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4854843020439148, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.48968443274497986, mean p set: 0.4500633478164673
loss_pred:0.03659241646528244, decouple_loss:0.03154231980443001
loss_pred:0.034805502742528915, decouple_loss:0.031231189146637917
loss_pred:0.03581221029162407, decouple_loss:0.030233005061745644
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03728681802749634, avg_mse: 0.039775699377059937
current test mse: 0.039776
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45244091749191284, gen p mean: -0.4809306263923645, mean p set: 0.45292118191719055
The modified gen p mean: 0.4512234926223755, gen p mean: -0.49286502599716187, mean p set: 0.4517037868499756
loss_pred:0.03714772313833237, decouple_loss:0.02999402955174446
The modified gen p mean: 0.45174500346183777, gen p mean: -0.48428642749786377, mean p set: 0.45222529768943787
loss_pred:0.03724003583192825, decouple_loss:0.028151702135801315
loss_pred:0.037085454910993576, decouple_loss:0.02899634838104248
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201635360717773, gen p mean: -0.4898236393928528, mean p set: 0.4524966776371002
The modified gen p mean: 0.45226389169692993, gen p mean: -0.4984576404094696, mean p set: 0.45274418592453003
loss_pred:0.036978162825107574, decouple_loss:0.029260991141200066
loss_pred:0.03489627316594124, decouple_loss:0.02950906939804554
The modified gen p mean: 0.45021769404411316, gen p mean: -0.49718448519706726, mean p set: 0.45069798827171326
loss_pred:0.03429928421974182, decouple_loss:0.028374070301651955
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505062401294708, gen p mean: -0.5036303997039795, mean p set: 0.45098650455474854
The modified gen p mean: 0.45079344511032104, gen p mean: -0.4986657202243805, mean p set: 0.45127376914024353
loss_pred:0.03439865633845329, decouple_loss:0.027759909629821777The modified gen p mean: 0.45070749521255493, gen p mean: -0.5040351748466492, mean p set: 0.45118778944015503
loss_pred:0.0365622416138649, decouple_loss:0.029322445392608643
loss_pred:0.03557079657912254, decouple_loss:0.02888285554945469
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514395594596863, gen p mean: -0.4964660406112671, mean p set: 0.4519197940826416
The modified gen p mean: 0.4525368809700012, gen p mean: -0.5048367381095886, mean p set: 0.45301714539527893
loss_pred:0.03615197911858559, decouple_loss:0.029416825622320175
loss_pred:0.03718696907162666, decouple_loss:0.029550930485129356
The modified gen p mean: 0.4519716203212738, gen p mean: -0.49410760402679443, mean p set: 0.4524519443511963
loss_pred:0.03727361559867859, decouple_loss:0.0290107149630785
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507941007614136, gen p mean: -0.505583643913269, mean p set: 0.45127442479133606
The modified gen p mean: 0.45161208510398865, gen p mean: -0.5068197250366211, mean p set: 0.45209240913391113
loss_pred:0.03557521477341652, decouple_loss:0.028736434876918793
loss_pred:0.03461936488747597, decouple_loss:0.028312304988503456
The modified gen p mean: 0.44989460706710815, gen p mean: -0.5042109489440918, mean p set: 0.45037490129470825
loss_pred:0.03692644089460373, decouple_loss:0.028920315206050873
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45112621784210205, gen p mean: -0.5070496797561646, mean p set: 0.45160651206970215
loss_pred:0.03683255612850189, decouple_loss:0.02819393016397953
The modified gen p mean: 0.4532153904438019, gen p mean: -0.509211003780365, mean p set: 0.453695684671402The modified gen p mean: 0.45145928859710693, gen p mean: -0.5022498369216919, mean p set: 0.45193958282470703
loss_pred:0.034584708511829376, decouple_loss:0.029043927788734436
loss_pred:0.034828994423151016, decouple_loss:0.027362536638975143
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475595951080322, gen p mean: -0.4967573583126068, mean p set: 0.4480399191379547
loss_pred:0.03539111837744713, decouple_loss:0.03037458285689354
The modified gen p mean: 0.4474680721759796, gen p mean: -0.4991067349910736, mean p set: 0.4479483664035797The modified gen p mean: 0.44919610023498535, gen p mean: -0.49324193596839905, mean p set: 0.44967639446258545
loss_pred:0.035974569618701935, decouple_loss:0.030134670436382294
loss_pred:0.03666596859693527, decouple_loss:0.030259618535637856
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448258638381958, gen p mean: -0.49003440141677856, mean p set: 0.4487389624118805
The modified gen p mean: 0.4482795000076294, gen p mean: -0.49425575137138367, mean p set: 0.4487598240375519
The modified gen p mean: 0.4480283856391907, gen p mean: -0.49530917406082153, mean p set: 0.44850867986679077
loss_pred:0.03797060251235962, decouple_loss:0.028704658150672913
loss_pred:0.03686128929257393, decouple_loss:0.03042144700884819loss_pred:0.036387789994478226, decouple_loss:0.031237680464982986
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732344150543213, gen p mean: -0.4932953417301178, mean p set: 0.44780370593070984
The modified gen p mean: 0.44719794392585754, gen p mean: -0.5044206380844116, mean p set: 0.44767823815345764
loss_pred:0.037079740315675735, decouple_loss:0.03186262026429176
loss_pred:0.03593737632036209, decouple_loss:0.031143827363848686
The modified gen p mean: 0.4459594190120697, gen p mean: -0.5029534697532654, mean p set: 0.4464397132396698
loss_pred:0.03684404864907265, decouple_loss:0.030840031802654266
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471522867679596, gen p mean: -0.49931663274765015, mean p set: 0.4476326107978821
The modified gen p mean: 0.4472908675670624, gen p mean: -0.4995088577270508, mean p set: 0.44777119159698486
loss_pred:0.0351066067814827, decouple_loss:0.029050488024950027
loss_pred:0.036815743893384933, decouple_loss:0.03047339618206024
The modified gen p mean: 0.44798973202705383, gen p mean: -0.4953668415546417, mean p set: 0.44847002625465393
loss_pred:0.03666609898209572, decouple_loss:0.029842250049114227
2023-05-01 18:22:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5103174448013306, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5010170340538025, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5049129724502563, mean p set: 0.4500633478164673
loss_pred:0.03612576425075531, decouple_loss:0.03096703626215458
loss_pred:0.03434621915221214, decouple_loss:0.030308375135064125
loss_pred:0.035310301929712296, decouple_loss:0.029497912153601646
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03677365183830261, avg_mse: 0.039073552936315536
current test mse: 0.039074
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716256856918335, gen p mean: -0.4994913339614868, mean p set: 0.44764280319213867
The modified gen p mean: 0.4468974173069, gen p mean: -0.4988696277141571, mean p set: 0.4473777115345001
loss_pred:0.03778637573122978, decouple_loss:0.030576076358556747
The modified gen p mean: 0.44835665822029114, gen p mean: -0.5016656517982483, mean p set: 0.4488369822502136
loss_pred:0.036833252757787704, decouple_loss:0.030456900596618652
loss_pred:0.035316839814186096, decouple_loss:0.03033660538494587
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793835282325745, gen p mean: -0.5085989236831665, mean p set: 0.44841864705085754
The modified gen p mean: 0.4463588297367096, gen p mean: -0.5075968503952026, mean p set: 0.4468391239643097
loss_pred:0.035835228860378265, decouple_loss:0.029026955366134644
loss_pred:0.03692789375782013, decouple_loss:0.028413325548171997
The modified gen p mean: 0.4484391510486603, gen p mean: -0.5034266114234924, mean p set: 0.448919415473938
loss_pred:0.03570850193500519, decouple_loss:0.028049692511558533
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463062286376953, gen p mean: -0.49434787034988403, mean p set: 0.4467865526676178The modified gen p mean: 0.44762107729911804, gen p mean: -0.5054121017456055, mean p set: 0.4481014013290405
The modified gen p mean: 0.44779133796691895, gen p mean: -0.5028108358383179, mean p set: 0.44827160239219666
loss_pred:0.03791180998086929, decouple_loss:0.028704790398478508
loss_pred:0.03604739531874657, decouple_loss:0.028832199051976204
loss_pred:0.037795569747686386, decouple_loss:0.028331778943538666
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860631227493286, gen p mean: -0.49339723587036133, mean p set: 0.44908660650253296
The modified gen p mean: 0.44746750593185425, gen p mean: -0.4999559223651886, mean p set: 0.44794782996177673
loss_pred:0.03715380281209946, decouple_loss:0.03058154508471489
loss_pred:0.03696279972791672, decouple_loss:0.0289338119328022
The modified gen p mean: 0.44641435146331787, gen p mean: -0.49469831585884094, mean p set: 0.44689464569091797
loss_pred:0.03713244944810867, decouple_loss:0.02815200202167034
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447185218334198, gen p mean: -0.49453994631767273, mean p set: 0.4476655125617981
The modified gen p mean: 0.4482066035270691, gen p mean: -0.49522820115089417, mean p set: 0.4486868679523468
loss_pred:0.03433293104171753, decouple_loss:0.029911544173955917
loss_pred:0.035408370196819305, decouple_loss:0.02970712259411812
The modified gen p mean: 0.44536155462265015, gen p mean: -0.49867677688598633, mean p set: 0.44584187865257263
loss_pred:0.036900196224451065, decouple_loss:0.02838931418955326
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841551780700684, gen p mean: -0.49295443296432495, mean p set: 0.44889581203460693
The modified gen p mean: 0.44821879267692566, gen p mean: -0.4961434006690979, mean p set: 0.44869908690452576
loss_pred:0.037396177649497986, decouple_loss:0.029885903000831604
loss_pred:0.037259798496961594, decouple_loss:0.030150897800922394
The modified gen p mean: 0.4481883943080902, gen p mean: -0.493009090423584, mean p set: 0.4486686885356903
loss_pred:0.037042614072561264, decouple_loss:0.029180893674492836
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493710398674011, gen p mean: -0.4910995364189148, mean p set: 0.44985130429267883
The modified gen p mean: 0.4487364590167999, gen p mean: -0.490628719329834, mean p set: 0.4492167532444
loss_pred:0.036414746195077896, decouple_loss:0.030842605978250504
loss_pred:0.03771214559674263, decouple_loss:0.02937990054488182
The modified gen p mean: 0.4483889937400818, gen p mean: -0.492063045501709, mean p set: 0.4488692581653595
loss_pred:0.03651026636362076, decouple_loss:0.02871779538691044
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485762417316437, gen p mean: -0.49586376547813416, mean p set: 0.4490565061569214
The modified gen p mean: 0.4471014440059662, gen p mean: -0.49516162276268005, mean p set: 0.4475817382335663
loss_pred:0.035361409187316895, decouple_loss:0.028309082612395287
loss_pred:0.03656943142414093, decouple_loss:0.02799188159406185
The modified gen p mean: 0.4474603533744812, gen p mean: -0.4945497512817383, mean p set: 0.4479406476020813
loss_pred:0.035732828080654144, decouple_loss:0.026930460706353188
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472449719905853, gen p mean: -0.5066468119621277, mean p set: 0.4477252662181854
The modified gen p mean: 0.44597193598747253, gen p mean: -0.5026835799217224, mean p set: 0.44645223021507263
loss_pred:0.036622826009988785, decouple_loss:0.02777528390288353
loss_pred:0.03640691190958023, decouple_loss:0.028879109770059586
The modified gen p mean: 0.4485549032688141, gen p mean: -0.5001937747001648, mean p set: 0.4490351974964142
loss_pred:0.03434515744447708, decouple_loss:0.028064029291272163
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895514845848083, gen p mean: -0.49578773975372314, mean p set: 0.4494354724884033
loss_pred:0.03550369665026665, decouple_loss:0.026331596076488495
The modified gen p mean: 0.44882652163505554, gen p mean: -0.496253103017807, mean p set: 0.44930681586265564The modified gen p mean: 0.44716429710388184, gen p mean: -0.4994288384914398, mean p set: 0.44764459133148193
loss_pred:0.0372290313243866, decouple_loss:0.027477985247969627
loss_pred:0.03575220704078674, decouple_loss:0.026667561382055283
2023-05-01 18:25:03 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5079138278961182, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.49784594774246216, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5019032955169678, mean p set: 0.4500633478164673
loss_pred:0.036114536225795746, decouple_loss:0.028604311868548393
loss_pred:0.03436582162976265, decouple_loss:0.027520840987563133
loss_pred:0.03510340675711632, decouple_loss:0.02706652693450451
WV_0_PC_1_EH_0_PS_40_5, loss: 0.036581117659807205, avg_mse: 0.03911740332841873
current test mse: 0.039117
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474125802516937, gen p mean: -0.49998074769973755, mean p set: 0.4478928744792938
The modified gen p mean: 0.4477511942386627, gen p mean: -0.5047035217285156, mean p set: 0.4482314884662628
The modified gen p mean: 0.4477037787437439, gen p mean: -0.501702606678009, mean p set: 0.448184072971344loss_pred:0.03500880300998688, decouple_loss:0.028590453788638115
loss_pred:0.035271745175123215, decouple_loss:0.027415715157985687
loss_pred:0.036356888711452484, decouple_loss:0.028347350656986237
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480310380458832, gen p mean: -0.4983295500278473, mean p set: 0.4485113322734833
The modified gen p mean: 0.4479886591434479, gen p mean: -0.49689409136772156, mean p set: 0.448468953371048
loss_pred:0.03496027737855911, decouple_loss:0.027411289513111115
loss_pred:0.03583627939224243, decouple_loss:0.02766312099993229
The modified gen p mean: 0.44597384333610535, gen p mean: -0.49771758913993835, mean p set: 0.44645413756370544
loss_pred:0.03569892421364784, decouple_loss:0.028729623183608055
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903579354286194, gen p mean: -0.4951125383377075, mean p set: 0.44951605796813965
The modified gen p mean: 0.447562575340271, gen p mean: -0.4938223958015442, mean p set: 0.4480428397655487
loss_pred:0.034699875861406326, decouple_loss:0.027503063902258873
loss_pred:0.0347142368555069, decouple_loss:0.026302140206098557
The modified gen p mean: 0.4484703540802002, gen p mean: -0.4920942783355713, mean p set: 0.4489506781101227
loss_pred:0.036412596702575684, decouple_loss:0.026682937517762184
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818437099456787, gen p mean: -0.49274638295173645, mean p set: 0.4486646354198456
The modified gen p mean: 0.44778892397880554, gen p mean: -0.4909263253211975, mean p set: 0.44826918840408325
The modified gen p mean: 0.4490233063697815, gen p mean: -0.48667609691619873, mean p set: 0.4495036005973816
loss_pred:0.03532591462135315, decouple_loss:0.026171348989009857
loss_pred:0.03530178964138031, decouple_loss:0.02634575590491295loss_pred:0.03752053529024124, decouple_loss:0.027831340208649635
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445667028427124, gen p mean: -0.49459269642829895, mean p set: 0.4461473524570465
The modified gen p mean: 0.4475211501121521, gen p mean: -0.49778905510902405, mean p set: 0.4480014741420746
loss_pred:0.03722306713461876, decouple_loss:0.027906307950615883
loss_pred:0.03539061173796654, decouple_loss:0.026819607242941856
The modified gen p mean: 0.4484618604183197, gen p mean: -0.4995492398738861, mean p set: 0.4489421248435974
loss_pred:0.03561617061495781, decouple_loss:0.027544952929019928
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764211773872375, gen p mean: -0.4926583170890808, mean p set: 0.44812238216400146The modified gen p mean: 0.44896137714385986, gen p mean: -0.4819859266281128, mean p set: 0.44944167137145996
The modified gen p mean: 0.44796302914619446, gen p mean: -0.48973190784454346, mean p set: 0.44844329357147217
loss_pred:0.03603659197688103, decouple_loss:0.027398042380809784
loss_pred:0.03670227900147438, decouple_loss:0.027708303183317184
loss_pred:0.03693616762757301, decouple_loss:0.027776192873716354
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485279321670532, gen p mean: -0.49378862977027893, mean p set: 0.4490082263946533
loss_pred:0.03508114442229271, decouple_loss:0.030376983806490898
The modified gen p mean: 0.4492822289466858, gen p mean: -0.4870486855506897, mean p set: 0.4497624933719635The modified gen p mean: 0.448900431394577, gen p mean: -0.4915127158164978, mean p set: 0.4493807256221771
loss_pred:0.03691697120666504, decouple_loss:0.027425695210695267
loss_pred:0.03615984693169594, decouple_loss:0.027426885440945625
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861990213394165, gen p mean: -0.49944302439689636, mean p set: 0.44910016655921936
The modified gen p mean: 0.4478102922439575, gen p mean: -0.5068274140357971, mean p set: 0.44829061627388
The modified gen p mean: 0.4496171176433563, gen p mean: -0.5042843818664551, mean p set: 0.4500974118709564
loss_pred:0.036242321133613586, decouple_loss:0.027195287868380547
loss_pred:0.03554599732160568, decouple_loss:0.027021493762731552
loss_pred:0.03644770383834839, decouple_loss:0.025977039709687233
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786709547042847, gen p mean: -0.49309712648391724, mean p set: 0.44834738969802856
The modified gen p mean: 0.449035108089447, gen p mean: -0.49193304777145386, mean p set: 0.4495154023170471
The modified gen p mean: 0.4506921172142029, gen p mean: -0.4906198978424072, mean p set: 0.451172411441803
loss_pred:0.03511887788772583, decouple_loss:0.025973206385970116
loss_pred:0.03671801835298538, decouple_loss:0.026589779183268547loss_pred:0.035762231796979904, decouple_loss:0.02652696520090103
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823339581489563, gen p mean: -0.4817293584346771, mean p set: 0.4487136900424957
The modified gen p mean: 0.44955408573150635, gen p mean: -0.48821789026260376, mean p set: 0.45003435015678406
loss_pred:0.03785163536667824, decouple_loss:0.026964036747813225
loss_pred:0.034694477915763855, decouple_loss:0.02700711414217949
The modified gen p mean: 0.44879257678985596, gen p mean: -0.4797952473163605, mean p set: 0.44927287101745605
loss_pred:0.03687695786356926, decouple_loss:0.02693469263613224
2023-05-01 18:27:48 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.498672217130661, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.4889276325702667, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.493074893951416, mean p set: 0.4500633478164673
loss_pred:0.03589992970228195, decouple_loss:0.02889668382704258
loss_pred:0.034258294850587845, decouple_loss:0.02748539298772812
loss_pred:0.03499564528465271, decouple_loss:0.02732083946466446
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03644634038209915, avg_mse: 0.038835957646369934
current test mse: 0.038836
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448874831199646, gen p mean: -0.4925908148288727, mean p set: 0.4493550956249237
The modified gen p mean: 0.4492180645465851, gen p mean: -0.48344630002975464, mean p set: 0.4496983587741852
loss_pred:0.03722767531871796, decouple_loss:0.02739066258072853
The modified gen p mean: 0.44862130284309387, gen p mean: -0.4912334978580475, mean p set: 0.44910159707069397
loss_pred:0.03635318949818611, decouple_loss:0.02844073437154293
loss_pred:0.03658374771475792, decouple_loss:0.02680959738790989
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982975721359253, gen p mean: -0.489849716424942, mean p set: 0.450310081243515
The modified gen p mean: 0.44875583052635193, gen p mean: -0.49703019857406616, mean p set: 0.449236124753952
loss_pred:0.03677565976977348, decouple_loss:0.027784248813986778
loss_pred:0.03429243341088295, decouple_loss:0.026140861213207245
The modified gen p mean: 0.44956347346305847, gen p mean: -0.4915086328983307, mean p set: 0.45004376769065857
loss_pred:0.03402762487530708, decouple_loss:0.02675427496433258
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851556420326233, gen p mean: -0.49302423000335693, mean p set: 0.4489958584308624
The modified gen p mean: 0.4494500756263733, gen p mean: -0.5011696219444275, mean p set: 0.4499303698539734
loss_pred:0.03671793267130852, decouple_loss:0.02599719725549221
loss_pred:0.0373370535671711, decouple_loss:0.0276425052434206
The modified gen p mean: 0.4483445882797241, gen p mean: -0.49269816279411316, mean p set: 0.4488248825073242
loss_pred:0.03621767461299896, decouple_loss:0.026725463569164276
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492962062358856, gen p mean: -0.49193546175956726, mean p set: 0.44977647066116333
The modified gen p mean: 0.4492394030094147, gen p mean: -0.4986203610897064, mean p set: 0.44971972703933716
loss_pred:0.03575286269187927, decouple_loss:0.027556581422686577
loss_pred:0.034969478845596313, decouple_loss:0.026308419182896614
The modified gen p mean: 0.44823217391967773, gen p mean: -0.4993950426578522, mean p set: 0.44871246814727783
loss_pred:0.03568299487233162, decouple_loss:0.029213737696409225
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885820150375366, gen p mean: -0.5004271268844604, mean p set: 0.44933852553367615
The modified gen p mean: 0.4491003453731537, gen p mean: -0.5021407008171082, mean p set: 0.4495806396007538
loss_pred:0.03431108966469765, decouple_loss:0.02797003835439682
loss_pred:0.0347641296684742, decouple_loss:0.026184769347310066
The modified gen p mean: 0.44800862669944763, gen p mean: -0.4994078576564789, mean p set: 0.44848892092704773
loss_pred:0.03677651286125183, decouple_loss:0.02674655243754387
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479248821735382, gen p mean: -0.49302563071250916, mean p set: 0.4484051764011383
The modified gen p mean: 0.4499236047267914, gen p mean: -0.4996805787086487, mean p set: 0.4504038989543915
loss_pred:0.03690126910805702, decouple_loss:0.027102608233690262
loss_pred:0.03533914312720299, decouple_loss:0.02510594204068184
The modified gen p mean: 0.44802823662757874, gen p mean: -0.4995972514152527, mean p set: 0.44850850105285645
loss_pred:0.035155054181814194, decouple_loss:0.02586548589169979
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937968254089355, gen p mean: -0.4935828447341919, mean p set: 0.44986000657081604
The modified gen p mean: 0.449535071849823, gen p mean: -0.5005196928977966, mean p set: 0.4500153958797455
loss_pred:0.036507852375507355, decouple_loss:0.02550440840423107
loss_pred:0.03448928892612457, decouple_loss:0.02547101303935051
The modified gen p mean: 0.4482743740081787, gen p mean: -0.5001791715621948, mean p set: 0.4487546384334564
loss_pred:0.037305835634469986, decouple_loss:0.026241857558488846
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479435980319977, gen p mean: -0.5088143348693848, mean p set: 0.44842392206192017
The modified gen p mean: 0.4498286545276642, gen p mean: -0.5087570548057556, mean p set: 0.4503089487552643
loss_pred:0.03470482677221298, decouple_loss:0.02567552961409092
loss_pred:0.034193482249975204, decouple_loss:0.026250028982758522
The modified gen p mean: 0.44945028424263, gen p mean: -0.508074164390564, mean p set: 0.4499305486679077
loss_pred:0.03418800234794617, decouple_loss:0.02609117142856121
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490712583065033, gen p mean: -0.5035796761512756, mean p set: 0.4495515525341034
The modified gen p mean: 0.4486909806728363, gen p mean: -0.4976184666156769, mean p set: 0.4491713047027588
loss_pred:0.034258194267749786, decouple_loss:0.02638867124915123
loss_pred:0.03662823885679245, decouple_loss:0.026878217235207558
The modified gen p mean: 0.4484918415546417, gen p mean: -0.49995794892311096, mean p set: 0.44897210597991943
loss_pred:0.03728863224387169, decouple_loss:0.02655039168894291
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500400722026825, gen p mean: -0.4920247495174408, mean p set: 0.450520396232605
The modified gen p mean: 0.44943419098854065, gen p mean: -0.499191552400589, mean p set: 0.44991445541381836
loss_pred:0.03646066039800644, decouple_loss:0.025961043313145638
loss_pred:0.03443881496787071, decouple_loss:0.024393778294324875
The modified gen p mean: 0.45006632804870605, gen p mean: -0.4893958866596222, mean p set: 0.45054665207862854
loss_pred:0.035765308886766434, decouple_loss:0.0248559582978487
2023-05-01 18:29:57 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5052686929702759, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.49519726634025574, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.4991157054901123, mean p set: 0.4500633478164673
loss_pred:0.0355747789144516, decouple_loss:0.026738202199339867
loss_pred:0.03383583948016167, decouple_loss:0.026079241186380386
loss_pred:0.03483430668711662, decouple_loss:0.025585675612092018
WV_0_PC_1_EH_0_PS_40_5, loss: 0.036055028438568115, avg_mse: 0.03864797204732895
current test mse: 0.038648
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948524236679077, gen p mean: -0.4905630052089691, mean p set: 0.44996556639671326
The modified gen p mean: 0.4487936794757843, gen p mean: -0.49227094650268555, mean p set: 0.4492739737033844
loss_pred:0.035996753722429276, decouple_loss:0.026127468794584274
The modified gen p mean: 0.4490082561969757, gen p mean: -0.4956158399581909, mean p set: 0.4494885504245758
loss_pred:0.03637108951807022, decouple_loss:0.027477020397782326
loss_pred:0.03747599199414253, decouple_loss:0.02617853321135044
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784533977508545, gen p mean: -0.49041056632995605, mean p set: 0.44832560420036316
The modified gen p mean: 0.44851455092430115, gen p mean: -0.492397665977478, mean p set: 0.44899484515190125
loss_pred:0.03435663506388664, decouple_loss:0.027293087914586067
loss_pred:0.03684251755475998, decouple_loss:0.025207551196217537
The modified gen p mean: 0.4490126073360443, gen p mean: -0.4880555272102356, mean p set: 0.4494929015636444
loss_pred:0.035299837589263916, decouple_loss:0.02502567507326603
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893208146095276, gen p mean: -0.48569750785827637, mean p set: 0.44941237568855286
loss_pred:0.035856690257787704, decouple_loss:0.026397541165351868
The modified gen p mean: 0.45011135935783386, gen p mean: -0.49664074182510376, mean p set: 0.45059165358543396The modified gen p mean: 0.4479655921459198, gen p mean: -0.49177122116088867, mean p set: 0.4484458863735199
loss_pred:0.03527279943227768, decouple_loss:0.024539683014154434
loss_pred:0.03510883450508118, decouple_loss:0.02557937055826187
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480951428413391, gen p mean: -0.4904223680496216, mean p set: 0.4485754370689392
The modified gen p mean: 0.4490033984184265, gen p mean: -0.49399682879447937, mean p set: 0.4494836926460266
loss_pred:0.03693321347236633, decouple_loss:0.02575903944671154
loss_pred:0.03408867493271828, decouple_loss:0.026035547256469727
The modified gen p mean: 0.4510590434074402, gen p mean: -0.48929592967033386, mean p set: 0.4515393376350403
loss_pred:0.03645728901028633, decouple_loss:0.025792449712753296
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853314757347107, gen p mean: -0.48195531964302063, mean p set: 0.44901344180107117
loss_pred:0.036344658583402634, decouple_loss:0.026252537965774536The modified gen p mean: 0.4483950436115265, gen p mean: -0.4788469076156616, mean p set: 0.4488753378391266
The modified gen p mean: 0.4493091106414795, gen p mean: -0.49005183577537537, mean p set: 0.4497894048690796
loss_pred:0.035928837954998016, decouple_loss:0.026114434003829956
loss_pred:0.034545909613370895, decouple_loss:0.025445854291319847
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475609362125397, gen p mean: -0.48906826972961426, mean p set: 0.4480412006378174
The modified gen p mean: 0.44916248321533203, gen p mean: -0.486831396818161, mean p set: 0.44964277744293213
loss_pred:0.034709807485342026, decouple_loss:0.02557329274713993
loss_pred:0.036714669317007065, decouple_loss:0.025778302922844887
The modified gen p mean: 0.4478776156902313, gen p mean: -0.48944970965385437, mean p set: 0.4483579099178314
loss_pred:0.0341220386326313, decouple_loss:0.024303609505295753
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
NaN value num: 0
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477894604206085, gen p mean: -0.5112157464027405, mean p set: 0.44826972484588623
loss_pred:0.035708773881196976, decouple_loss:0.027867399156093597
The modified gen p mean: 0.44600510597229004, gen p mean: -0.5076329112052917, mean p set: 0.44648540019989014The modified gen p mean: 0.4469245970249176, gen p mean: -0.5111734867095947, mean p set: 0.4474048614501953
loss_pred:0.03654499724507332, decouple_loss:0.027804814279079437
loss_pred:0.03709719702601433, decouple_loss:0.02756616286933422
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834718108177185, gen p mean: -0.512975811958313, mean p set: 0.44882747530937195
The modified gen p mean: 0.44622448086738586, gen p mean: -0.5154727101325989, mean p set: 0.44670480489730835
loss_pred:0.03780161216855049, decouple_loss:0.028307000175118446
loss_pred:0.03534465655684471, decouple_loss:0.026890816166996956
The modified gen p mean: 0.4461723566055298, gen p mean: -0.5179646015167236, mean p set: 0.4466526508331299
loss_pred:0.03566907346248627, decouple_loss:0.02674771472811699
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487491250038147, gen p mean: -0.5082618594169617, mean p set: 0.4492294192314148
The modified gen p mean: 0.4480167329311371, gen p mean: -0.5120970010757446, mean p set: 0.4484969973564148
loss_pred:0.03766758739948273, decouple_loss:0.027182765305042267
loss_pred:0.038906991481781006, decouple_loss:0.02696092426776886
The modified gen p mean: 0.4477671682834625, gen p mean: -0.5137593746185303, mean p set: 0.44824743270874023
loss_pred:0.038111574947834015, decouple_loss:0.026842573657631874
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487219750881195, gen p mean: -0.5122942328453064, mean p set: 0.4492022693157196
loss_pred:0.037147972732782364, decouple_loss:0.028158925473690033
The modified gen p mean: 0.44592970609664917, gen p mean: -0.5118368864059448, mean p set: 0.44641000032424927The modified gen p mean: 0.44636473059654236, gen p mean: -0.5143583416938782, mean p set: 0.44684502482414246
loss_pred:0.03574506938457489, decouple_loss:0.026491308584809303
loss_pred:0.03570886328816414, decouple_loss:0.026834705844521523
2023-05-01 18:32:51 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5105798244476318, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5038813352584839, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5001042485237122, mean p set: 0.45035696029663086
loss_pred:0.03573121502995491, decouple_loss:0.02754848450422287
loss_pred:0.03475816920399666, decouple_loss:0.026211973279714584
loss_pred:0.033866558223962784, decouple_loss:0.026982707902789116
WV_0_PC_1_EH_0_PS_40_5, loss: 0.036131035536527634, avg_mse: 0.03877799212932587
current test mse: 0.038778
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44626274704933167, gen p mean: -0.5078437924385071, mean p set: 0.446742981672287
loss_pred:0.03632846102118492, decouple_loss:0.026829509064555168
The modified gen p mean: 0.44731980562210083, gen p mean: -0.5104725360870361, mean p set: 0.44780007004737854The modified gen p mean: 0.44673365354537964, gen p mean: -0.5070868730545044, mean p set: 0.4472139775753021
loss_pred:0.03626792132854462, decouple_loss:0.026314333081245422
loss_pred:0.035206135362386703, decouple_loss:0.026535306125879288
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469447135925293, gen p mean: -0.4972290098667145, mean p set: 0.4474250078201294
loss_pred:0.037030335515737534, decouple_loss:0.027265898883342743
The modified gen p mean: 0.4482387900352478, gen p mean: -0.5020196437835693, mean p set: 0.4487190544605255The modified gen p mean: 0.4484891891479492, gen p mean: -0.5051870346069336, mean p set: 0.4489694833755493
loss_pred:0.03745201975107193, decouple_loss:0.026389019563794136
loss_pred:0.03742094710469246, decouple_loss:0.026669684797525406
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708576798439026, gen p mean: -0.5111725926399231, mean p set: 0.44756606221199036
loss_pred:0.035067010670900345, decouple_loss:0.026888234540820122
The modified gen p mean: 0.44628268480300903, gen p mean: -0.5091133713722229, mean p set: 0.4467630088329315
The modified gen p mean: 0.4477706551551819, gen p mean: -0.5107614994049072, mean p set: 0.448250949382782
loss_pred:0.03579704463481903, decouple_loss:0.026837486773729324
loss_pred:0.03753138706088066, decouple_loss:0.026660209521651268
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481840431690216, gen p mean: -0.5085883736610413, mean p set: 0.4486643373966217
The modified gen p mean: 0.4463682472705841, gen p mean: -0.513620138168335, mean p set: 0.4468485414981842
loss_pred:0.038166917860507965, decouple_loss:0.027057034894824028
loss_pred:0.03491833806037903, decouple_loss:0.025981776416301727
The modified gen p mean: 0.4473279118537903, gen p mean: -0.5047242045402527, mean p set: 0.4478082060813904
loss_pred:0.036217451095581055, decouple_loss:0.02774866670370102
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44614875316619873, gen p mean: -0.507875382900238, mean p set: 0.44662904739379883
The modified gen p mean: 0.44618138670921326, gen p mean: -0.5075673460960388, mean p set: 0.44666171073913574
loss_pred:0.03538141027092934, decouple_loss:0.026833899319171906
loss_pred:0.034992966800928116, decouple_loss:0.02551843598484993
The modified gen p mean: 0.4468817412853241, gen p mean: -0.5061779022216797, mean p set: 0.4473620653152466
loss_pred:0.036515869200229645, decouple_loss:0.026057299226522446
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886305928230286, gen p mean: -0.49512922763824463, mean p set: 0.44934335350990295The modified gen p mean: 0.4475215971469879, gen p mean: -0.4948166608810425, mean p set: 0.448001891374588
loss_pred:0.03764326870441437, decouple_loss:0.027847036719322205loss_pred:0.037471044808626175, decouple_loss:0.026307430118322372
The modified gen p mean: 0.44689828157424927, gen p mean: -0.49158012866973877, mean p set: 0.44737857580184937
loss_pred:0.03740532323718071, decouple_loss:0.02678648941218853
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466865360736847, gen p mean: -0.4954192340373993, mean p set: 0.4471668004989624
The modified gen p mean: 0.44714465737342834, gen p mean: -0.5052540898323059, mean p set: 0.44762495160102844
loss_pred:0.036352917551994324, decouple_loss:0.027526291087269783
loss_pred:0.03520462289452553, decouple_loss:0.0268744844943285
The modified gen p mean: 0.4462904930114746, gen p mean: -0.5037656426429749, mean p set: 0.4467707574367523
loss_pred:0.03586158528923988, decouple_loss:0.026338698342442513
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753193855285645, gen p mean: -0.5214946269989014, mean p set: 0.44801223278045654
The modified gen p mean: 0.4468212425708771, gen p mean: -0.519625723361969, mean p set: 0.44730156660079956
loss_pred:0.036936867982149124, decouple_loss:0.025609955191612244
loss_pred:0.03647209331393242, decouple_loss:0.025305628776550293
The modified gen p mean: 0.4473405182361603, gen p mean: -0.5200743675231934, mean p set: 0.4478208124637604
loss_pred:0.03762515261769295, decouple_loss:0.025885730981826782
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858789443969727, gen p mean: -0.5027028322219849, mean p set: 0.44906821846961975
The modified gen p mean: 0.4470100998878479, gen p mean: -0.5092471837997437, mean p set: 0.4474903643131256
loss_pred:0.03601233288645744, decouple_loss:0.027400795370340347
loss_pred:0.034895531833171844, decouple_loss:0.02675570361316204
The modified gen p mean: 0.44763389229774475, gen p mean: -0.5120189189910889, mean p set: 0.44811415672302246
loss_pred:0.03643002361059189, decouple_loss:0.026168830692768097
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469219148159027, gen p mean: -0.49907734990119934, mean p set: 0.4474022090435028
The modified gen p mean: 0.4477754533290863, gen p mean: -0.5085033774375916, mean p set: 0.4482557475566864
loss_pred:0.03655898571014404, decouple_loss:0.026763087138533592
loss_pred:0.03695954382419586, decouple_loss:0.026498382911086082
The modified gen p mean: 0.44659125804901123, gen p mean: -0.5072859525680542, mean p set: 0.44707152247428894
loss_pred:0.034660786390304565, decouple_loss:0.02528700791299343
2023-05-01 18:34:59 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5127468109130859, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5021292567253113, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5061043500900269, mean p set: 0.4500633478164673
loss_pred:0.03545380383729935, decouple_loss:0.027127902954816818
loss_pred:0.03375733643770218, decouple_loss:0.02627076953649521
loss_pred:0.0345793180167675, decouple_loss:0.025836391374468803
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03591740131378174, avg_mse: 0.03858410567045212
current test mse: 0.038584
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780921936035156, gen p mean: -0.5028979778289795, mean p set: 0.44828951358795166
The modified gen p mean: 0.4461558759212494, gen p mean: -0.5105291604995728, mean p set: 0.4466361403465271
loss_pred:0.03510778769850731, decouple_loss:0.02546079456806183
The modified gen p mean: 0.44634953141212463, gen p mean: -0.5085824728012085, mean p set: 0.44682982563972473
loss_pred:0.035081520676612854, decouple_loss:0.02605966478586197
loss_pred:0.035492200404405594, decouple_loss:0.025806767866015434
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829297065734863, gen p mean: -0.5066536068916321, mean p set: 0.44877323508262634
The modified gen p mean: 0.4462825059890747, gen p mean: -0.5100078582763672, mean p set: 0.4467627704143524
loss_pred:0.037028808146715164, decouple_loss:0.0262962207198143
loss_pred:0.03517324849963188, decouple_loss:0.02565847709774971
The modified gen p mean: 0.4460732042789459, gen p mean: -0.5093894600868225, mean p set: 0.446553498506546
loss_pred:0.03539327159523964, decouple_loss:0.025663066655397415
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469979405403137, gen p mean: -0.50876784324646, mean p set: 0.4474782347679138
loss_pred:0.03497257083654404, decouple_loss:0.025394044816493988
The modified gen p mean: 0.4468585252761841, gen p mean: -0.5109538435935974, mean p set: 0.4473387897014618The modified gen p mean: 0.4463445842266083, gen p mean: -0.5104283690452576, mean p set: 0.4468248784542084
loss_pred:0.034936752170324326, decouple_loss:0.02481590211391449
loss_pred:0.03453855216503143, decouple_loss:0.02531295083463192
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467674791812897, gen p mean: -0.5099714398384094, mean p set: 0.44724777340888977
The modified gen p mean: 0.44678714871406555, gen p mean: -0.5120379328727722, mean p set: 0.44726744294166565
loss_pred:0.03414125740528107, decouple_loss:0.025069909170269966
loss_pred:0.034924671053886414, decouple_loss:0.025076881051063538
The modified gen p mean: 0.4462166130542755, gen p mean: -0.507648766040802, mean p set: 0.4466968774795532
loss_pred:0.03553878888487816, decouple_loss:0.025478629395365715
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445794939994812, gen p mean: -0.5220595002174377, mean p set: 0.4462752044200897
The modified gen p mean: 0.44708535075187683, gen p mean: -0.5223276019096375, mean p set: 0.44756564497947693
loss_pred:0.03524580970406532, decouple_loss:0.02455775998532772
loss_pred:0.03439351171255112, decouple_loss:0.02455906569957733
The modified gen p mean: 0.44751158356666565, gen p mean: -0.5216059684753418, mean p set: 0.44799190759658813
loss_pred:0.034178588539361954, decouple_loss:0.025296427309513092
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828104972839355, gen p mean: -0.509495198726654, mean p set: 0.44876134395599365
The modified gen p mean: 0.4489080309867859, gen p mean: -0.5111852884292603, mean p set: 0.449388325214386
loss_pred:0.03776770830154419, decouple_loss:0.026742443442344666
loss_pred:0.03700533136725426, decouple_loss:0.026216842234134674
The modified gen p mean: 0.4483528137207031, gen p mean: -0.5088188648223877, mean p set: 0.44883307814598083
loss_pred:0.03731248900294304, decouple_loss:0.026739545166492462
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497798681259155, gen p mean: -0.5050309896469116, mean p set: 0.45026013255119324
loss_pred:0.03523010388016701, decouple_loss:0.028122270479798317
The modified gen p mean: 0.44969236850738525, gen p mean: -0.503686249256134, mean p set: 0.45017269253730774The modified gen p mean: 0.4494338631629944, gen p mean: -0.5023989677429199, mean p set: 0.44991418719291687
loss_pred:0.03421664237976074, decouple_loss:0.027409132570028305
loss_pred:0.035173382610082626, decouple_loss:0.026737073436379433
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449287086725235, gen p mean: -0.5008800625801086, mean p set: 0.4497673809528351
The modified gen p mean: 0.4483937621116638, gen p mean: -0.4984978437423706, mean p set: 0.4488740861415863
loss_pred:0.03445564955472946, decouple_loss:0.026879601180553436
loss_pred:0.03466178476810455, decouple_loss:0.027204439043998718
The modified gen p mean: 0.44893956184387207, gen p mean: -0.5011637806892395, mean p set: 0.4494198262691498
loss_pred:0.03547288849949837, decouple_loss:0.027064476162195206
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765859842300415, gen p mean: -0.5018736124038696, mean p set: 0.44813892245292664
The modified gen p mean: 0.4497874081134796, gen p mean: -0.5059583783149719, mean p set: 0.4502677023410797
loss_pred:0.0361558273434639, decouple_loss:0.026401083916425705
loss_pred:0.0352657176554203, decouple_loss:0.027311578392982483
The modified gen p mean: 0.4480297267436981, gen p mean: -0.5019140839576721, mean p set: 0.44850999116897583
loss_pred:0.035266876220703125, decouple_loss:0.027135316282510757
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492749869823456, gen p mean: -0.5063692927360535, mean p set: 0.4497552812099457
The modified gen p mean: 0.44803234934806824, gen p mean: -0.5022779107093811, mean p set: 0.44851261377334595
loss_pred:0.03465787321329117, decouple_loss:0.027155792340636253
loss_pred:0.03369287773966789, decouple_loss:0.026669710874557495The modified gen p mean: 0.4500710964202881, gen p mean: -0.5099226832389832, mean p set: 0.4505513906478882
loss_pred:0.03514041006565094, decouple_loss:0.02823207527399063
2023-05-01 18:37:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5174931287765503, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5061971545219421, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5104554891586304, mean p set: 0.4500633478164673
loss_pred:0.03535570204257965, decouple_loss:0.02726125903427601
loss_pred:0.03367180377244949, decouple_loss:0.026712071150541306
loss_pred:0.034462008625268936, decouple_loss:0.026228273287415504
WV_0_PC_1_EH_0_PS_40_5, loss: 0.0358332023024559, avg_mse: 0.03850996866822243
current test mse: 0.03851
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490286111831665, gen p mean: -0.5071209669113159, mean p set: 0.4495089054107666
The modified gen p mean: 0.4501386880874634, gen p mean: -0.5092520713806152, mean p set: 0.4506189823150635
loss_pred:0.03507358953356743, decouple_loss:0.027411920949816704
The modified gen p mean: 0.44965624809265137, gen p mean: -0.5068930387496948, mean p set: 0.45013657212257385
loss_pred:0.03498515859246254, decouple_loss:0.02591833658516407
loss_pred:0.03497863933444023, decouple_loss:0.025947419926524162
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903799891471863, gen p mean: -0.5116043090820312, mean p set: 0.4495182931423187
The modified gen p mean: 0.45011022686958313, gen p mean: -0.5039557218551636, mean p set: 0.4505905210971832
loss_pred:0.03504004701972008, decouple_loss:0.026502862572669983
loss_pred:0.03470443934202194, decouple_loss:0.026789702475070953
The modified gen p mean: 0.449203222990036, gen p mean: -0.5076475739479065, mean p set: 0.4496835172176361
loss_pred:0.03453077748417854, decouple_loss:0.025505749508738518
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822654128074646, gen p mean: -0.5088686347007751, mean p set: 0.44870686531066895
The modified gen p mean: 0.45080986618995667, gen p mean: -0.5063818693161011, mean p set: 0.45129016041755676
loss_pred:0.03606898710131645, decouple_loss:0.026827115565538406
loss_pred:0.03517967090010643, decouple_loss:0.026488782837986946
The modified gen p mean: 0.45058590173721313, gen p mean: -0.5102940797805786, mean p set: 0.45106619596481323
loss_pred:0.03384570777416229, decouple_loss:0.026735913008451462
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797298312187195, gen p mean: -0.5040667057037354, mean p set: 0.44845327734947205
The modified gen p mean: 0.4492861032485962, gen p mean: -0.5057291984558105, mean p set: 0.4497663974761963
loss_pred:0.034107476472854614, decouple_loss:0.026163527742028236
loss_pred:0.03405056521296501, decouple_loss:0.026875540614128113
The modified gen p mean: 0.4503858983516693, gen p mean: -0.5110191702842712, mean p set: 0.4508661925792694
loss_pred:0.03452690690755844, decouple_loss:0.0267453845590353
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488268494606018, gen p mean: -0.5095292329788208, mean p set: 0.4493071436882019
The modified gen p mean: 0.45066308975219727, gen p mean: -0.5057094693183899, mean p set: 0.451143354177475
loss_pred:0.035384565591812134, decouple_loss:0.026704048737883568
loss_pred:0.03519585728645325, decouple_loss:0.0256515983492136
The modified gen p mean: 0.4498368203639984, gen p mean: -0.5103968381881714, mean p set: 0.4503171145915985
loss_pred:0.03413046896457672, decouple_loss:0.026157034561038017
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860759377479553, gen p mean: -0.5083177089691162, mean p set: 0.44908788800239563
The modified gen p mean: 0.4491962790489197, gen p mean: -0.5131925344467163, mean p set: 0.4496765732765198
loss_pred:0.035861071199178696, decouple_loss:0.02609959803521633
loss_pred:0.034931741654872894, decouple_loss:0.026027390733361244
The modified gen p mean: 0.44837287068367004, gen p mean: -0.5093430876731873, mean p set: 0.44885316491127014
loss_pred:0.03501811996102333, decouple_loss:0.025482071563601494
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836920499801636, gen p mean: -0.511313796043396, mean p set: 0.44884949922561646
The modified gen p mean: 0.4508246183395386, gen p mean: -0.5149922966957092, mean p set: 0.45130491256713867
loss_pred:0.03544940799474716, decouple_loss:0.025046929717063904
loss_pred:0.034739647060632706, decouple_loss:0.026232289150357246
The modified gen p mean: 0.4480578303337097, gen p mean: -0.5084865093231201, mean p set: 0.4485381245613098
loss_pred:0.03592170774936676, decouple_loss:0.025588275864720345
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489181935787201, gen p mean: -0.5189977288246155, mean p set: 0.4493984878063202
The modified gen p mean: 0.45090633630752563, gen p mean: -0.5167526006698608, mean p set: 0.45138660073280334
loss_pred:0.0352385975420475, decouple_loss:0.026543380692601204
loss_pred:0.033973224461078644, decouple_loss:0.026109350845217705
The modified gen p mean: 0.4484655559062958, gen p mean: -0.5195844769477844, mean p set: 0.4489458501338959
loss_pred:0.034556448459625244, decouple_loss:0.02722259610891342
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44911807775497437, gen p mean: -0.5175653100013733, mean p set: 0.44959837198257446
loss_pred:0.03486831486225128, decouple_loss:0.025216616690158844
The modified gen p mean: 0.450296014547348, gen p mean: -0.5195875763893127, mean p set: 0.4507763385772705
The modified gen p mean: 0.4496931731700897, gen p mean: -0.5193464756011963, mean p set: 0.4501734673976898
loss_pred:0.034664809703826904, decouple_loss:0.025303304195404053
loss_pred:0.034668006002902985, decouple_loss:0.02535300888121128
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491843283176422, gen p mean: -0.5089043378829956, mean p set: 0.4496645927429199
The modified gen p mean: 0.44948604702949524, gen p mean: -0.510328471660614, mean p set: 0.44996631145477295
loss_pred:0.034900963306427, decouple_loss:0.025503186509013176
loss_pred:0.03405298665165901, decouple_loss:0.02572566270828247
The modified gen p mean: 0.4488612115383148, gen p mean: -0.5081278085708618, mean p set: 0.44934147596359253
loss_pred:0.03498323634266853, decouple_loss:0.025586005300283432
2023-05-01 18:39:50 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5128995180130005, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5019537806510925, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5056103467941284, mean p set: 0.4500633478164673
loss_pred:0.034952934831380844, decouple_loss:0.026695972308516502
loss_pred:0.03335384652018547, decouple_loss:0.026197202503681183
loss_pred:0.03398551791906357, decouple_loss:0.025902159512043
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03541068732738495, avg_mse: 0.037981122732162476
current test mse: 0.037981
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500034749507904, gen p mean: -0.501442015171051, mean p set: 0.4504837691783905
The modified gen p mean: 0.44901034235954285, gen p mean: -0.5034997463226318, mean p set: 0.44949063658714294
loss_pred:0.03478552773594856, decouple_loss:0.02577858231961727
The modified gen p mean: 0.4494743347167969, gen p mean: -0.5065202116966248, mean p set: 0.44995465874671936
loss_pred:0.03367273882031441, decouple_loss:0.025455523282289505
loss_pred:0.03427762910723686, decouple_loss:0.02616790495812893
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501243233680725, gen p mean: -0.5016697645187378, mean p set: 0.4506046175956726
The modified gen p mean: 0.4493621587753296, gen p mean: -0.505224347114563, mean p set: 0.4498424530029297
loss_pred:0.03462917357683182, decouple_loss:0.02507970668375492
loss_pred:0.034782201051712036, decouple_loss:0.02488359808921814
The modified gen p mean: 0.4502295255661011, gen p mean: -0.5097349882125854, mean p set: 0.45070981979370117
loss_pred:0.03456510975956917, decouple_loss:0.02619670145213604
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485132098197937, gen p mean: -0.5151420831680298, mean p set: 0.448993444442749
The modified gen p mean: 0.44863173365592957, gen p mean: -0.5137287378311157, mean p set: 0.4491119980812073
loss_pred:0.034304428845644, decouple_loss:0.0253143347799778
loss_pred:0.0351204052567482, decouple_loss:0.027099551633000374The modified gen p mean: 0.4488588273525238, gen p mean: -0.5147047638893127, mean p set: 0.4493391215801239
loss_pred:0.03394012525677681, decouple_loss:0.024603895843029022
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492708742618561, gen p mean: -0.514346718788147, mean p set: 0.4497511684894562
The modified gen p mean: 0.4496731758117676, gen p mean: -0.5131670832633972, mean p set: 0.4501534700393677
loss_pred:0.034966155886650085, decouple_loss:0.02639048546552658
loss_pred:0.03429603576660156, decouple_loss:0.025398164987564087
The modified gen p mean: 0.45018741488456726, gen p mean: -0.5185400247573853, mean p set: 0.45066767930984497
loss_pred:0.03517927974462509, decouple_loss:0.02586505562067032
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487408697605133, gen p mean: -0.5137888789176941, mean p set: 0.449221134185791
The modified gen p mean: 0.44926688075065613, gen p mean: -0.5098595023155212, mean p set: 0.4497471749782562
loss_pred:0.034429825842380524, decouple_loss:0.025163700804114342
loss_pred:0.03266967833042145, decouple_loss:0.02502831071615219
The modified gen p mean: 0.4492380917072296, gen p mean: -0.5097711086273193, mean p set: 0.4497183561325073
loss_pred:0.03496198728680611, decouple_loss:0.025272512808442116
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965094327926636, gen p mean: -0.5036590099334717, mean p set: 0.45013123750686646
The modified gen p mean: 0.44919705390930176, gen p mean: -0.5065393447875977, mean p set: 0.44967731833457947
loss_pred:0.03489900007843971, decouple_loss:0.024478012695908546
loss_pred:0.033588629215955734, decouple_loss:0.02509469725191593
The modified gen p mean: 0.44858765602111816, gen p mean: -0.5028307437896729, mean p set: 0.44906798005104065
loss_pred:0.03436676412820816, decouple_loss:0.02542293630540371
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
NaN value num: 0
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134761929512024, gen p mean: -0.5111911296844482, mean p set: 0.45182791352272034
loss_pred:0.03450138494372368, decouple_loss:0.02828373946249485
The modified gen p mean: 0.4485553801059723, gen p mean: -0.5027628540992737, mean p set: 0.4490357041358948The modified gen p mean: 0.4531627595424652, gen p mean: -0.5138770341873169, mean p set: 0.4536430835723877
loss_pred:0.03566204383969307, decouple_loss:0.03079039789736271
loss_pred:0.033097632229328156, decouple_loss:0.026904547587037086
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45236364006996155, gen p mean: -0.5152117609977722, mean p set: 0.45284390449523926
loss_pred:0.03559742122888565, decouple_loss:0.028010692447423935
The modified gen p mean: 0.4496880769729614, gen p mean: -0.511975109577179, mean p set: 0.4501683712005615
The modified gen p mean: 0.45225515961647034, gen p mean: -0.5176053047180176, mean p set: 0.45273545384407043
loss_pred:0.03515484184026718, decouple_loss:0.026328621432185173
loss_pred:0.03454384207725525, decouple_loss:0.03073100559413433
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45158591866493225, gen p mean: -0.5162228941917419, mean p set: 0.45206621289253235
loss_pred:0.03453264757990837, decouple_loss:0.026388274505734444
The modified gen p mean: 0.45059874653816223, gen p mean: -0.5175022482872009, mean p set: 0.45107904076576233The modified gen p mean: 0.4488845467567444, gen p mean: -0.5108131170272827, mean p set: 0.4493648409843445
loss_pred:0.0340522900223732, decouple_loss:0.026987586170434952
loss_pred:0.033597130328416824, decouple_loss:0.02670629881322384
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974738359451294, gen p mean: -0.5131099820137024, mean p set: 0.45022767782211304
loss_pred:0.03520956262946129, decouple_loss:0.02597125805914402
The modified gen p mean: 0.45052701234817505, gen p mean: -0.5155752301216125, mean p set: 0.45100730657577515The modified gen p mean: 0.45084869861602783, gen p mean: -0.5147829651832581, mean p set: 0.45132896304130554
loss_pred:0.03536819666624069, decouple_loss:0.026530597358942032
loss_pred:0.03502553701400757, decouple_loss:0.025535868480801582
2023-05-01 18:42:38 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5279350280761719, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5165413618087769, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5206766128540039, mean p set: 0.4500633478164673
loss_pred:0.03529311344027519, decouple_loss:0.028042828664183617
loss_pred:0.033577512949705124, decouple_loss:0.027382107451558113
loss_pred:0.034250836819410324, decouple_loss:0.026840878650546074
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03574491664767265, avg_mse: 0.03855425491929054
current test mse: 0.038554
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489477574825287, gen p mean: -0.5136029720306396, mean p set: 0.4494280517101288
The modified gen p mean: 0.45130518078804016, gen p mean: -0.5253453850746155, mean p set: 0.45178547501564026
loss_pred:0.03341953456401825, decouple_loss:0.026436835527420044
The modified gen p mean: 0.4537126123905182, gen p mean: -0.5160579681396484, mean p set: 0.4541929364204407
loss_pred:0.03325482830405235, decouple_loss:0.025796784088015556
loss_pred:0.034239742904901505, decouple_loss:0.02758738398551941
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051953196525574, gen p mean: -0.5122939944267273, mean p set: 0.45099982619285583The modified gen p mean: 0.45272067189216614, gen p mean: -0.5113640427589417, mean p set: 0.45320096611976624
loss_pred:0.034776367247104645, decouple_loss:0.025445397943258286loss_pred:0.03500537946820259, decouple_loss:0.02715575136244297
The modified gen p mean: 0.45221543312072754, gen p mean: -0.517353355884552, mean p set: 0.45269572734832764
loss_pred:0.03248167783021927, decouple_loss:0.026847314089536667
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45004647970199585, gen p mean: -0.5091613531112671, mean p set: 0.45052674412727356
The modified gen p mean: 0.4512578845024109, gen p mean: -0.5159574151039124, mean p set: 0.451738178730011
loss_pred:0.03423576429486275, decouple_loss:0.027317563071846962
loss_pred:0.03416411578655243, decouple_loss:0.025983568280935287
The modified gen p mean: 0.44960206747055054, gen p mean: -0.5042911767959595, mean p set: 0.450082391500473
loss_pred:0.03368708863854408, decouple_loss:0.026627657935023308
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499387741088867, gen p mean: -0.5125269293785095, mean p set: 0.4504190683364868
The modified gen p mean: 0.4514947235584259, gen p mean: -0.5187404751777649, mean p set: 0.451975017786026
loss_pred:0.03522278368473053, decouple_loss:0.025766635313630104
loss_pred:0.033560268580913544, decouple_loss:0.026061898097395897
The modified gen p mean: 0.4520755410194397, gen p mean: -0.5158939361572266, mean p set: 0.4525558054447174
loss_pred:0.03340228646993637, decouple_loss:0.026666289195418358
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504566490650177, gen p mean: -0.5197776556015015, mean p set: 0.4509369134902954
The modified gen p mean: 0.4497767388820648, gen p mean: -0.5201663970947266, mean p set: 0.4502570331096649
loss_pred:0.035484783351421356, decouple_loss:0.026358796283602715
loss_pred:0.03506527468562126, decouple_loss:0.026385731995105743
The modified gen p mean: 0.44925418496131897, gen p mean: -0.5198408961296082, mean p set: 0.4497344493865967
loss_pred:0.03360026329755783, decouple_loss:0.026190225034952164
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449407160282135, gen p mean: -0.5200912356376648, mean p set: 0.4498874545097351
The modified gen p mean: 0.45051440596580505, gen p mean: -0.5244854688644409, mean p set: 0.45099470019340515
loss_pred:0.033261433243751526, decouple_loss:0.026273449882864952
loss_pred:0.0350804328918457, decouple_loss:0.025553349405527115
The modified gen p mean: 0.4514922797679901, gen p mean: -0.5240586996078491, mean p set: 0.4519725739955902
loss_pred:0.03461366519331932, decouple_loss:0.02529270015656948
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173242688179016, gen p mean: -0.5319910049438477, mean p set: 0.45221275091171265
The modified gen p mean: 0.45270460844039917, gen p mean: -0.525794506072998, mean p set: 0.45318490266799927
loss_pred:0.03454391285777092, decouple_loss:0.026201652362942696
loss_pred:0.035170778632164, decouple_loss:0.02707752026617527
The modified gen p mean: 0.45076581835746765, gen p mean: -0.5347093343734741, mean p set: 0.45124614238739014
loss_pred:0.034138087183237076, decouple_loss:0.024925831705331802
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487006366252899, gen p mean: -0.5276994109153748, mean p set: 0.44918093085289
The modified gen p mean: 0.4491153657436371, gen p mean: -0.5313610434532166, mean p set: 0.44959568977355957
loss_pred:0.03365742042660713, decouple_loss:0.026136944070458412
loss_pred:0.034137725830078125, decouple_loss:0.024887770414352417
The modified gen p mean: 0.4497973918914795, gen p mean: -0.534485399723053, mean p set: 0.4502776563167572
loss_pred:0.03339303284883499, decouple_loss:0.02663290500640869
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521658420562744, gen p mean: -0.5386235117912292, mean p set: 0.4526461362838745
The modified gen p mean: 0.4516095221042633, gen p mean: -0.5392976999282837, mean p set: 0.452089786529541
loss_pred:0.032725028693675995, decouple_loss:0.02641047164797783
loss_pred:0.0325017124414444, decouple_loss:0.026464903727173805
The modified gen p mean: 0.4496833384037018, gen p mean: -0.529104471206665, mean p set: 0.4501636028289795
loss_pred:0.03405249863862991, decouple_loss:0.02578682266175747
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45182403922080994, gen p mean: -0.5305973291397095, mean p set: 0.4523043632507324
The modified gen p mean: 0.4515613615512848, gen p mean: -0.5310992002487183, mean p set: 0.4520416855812073
loss_pred:0.03295573964715004, decouple_loss:0.02672983519732952
loss_pred:0.03378158062696457, decouple_loss:0.02576344832777977
The modified gen p mean: 0.45213818550109863, gen p mean: -0.5309321284294128, mean p set: 0.45261847972869873
loss_pred:0.03436516970396042, decouple_loss:0.025446869432926178
2023-05-01 18:44:46 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5376431345939636, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5305833220481873, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5263210535049438, mean p set: 0.45035696029663086
loss_pred:0.034208837896585464, decouple_loss:0.026726190000772476
loss_pred:0.03532564267516136, decouple_loss:0.027838217094540596
loss_pred:0.03353216126561165, decouple_loss:0.027332382276654243
WV_0_PC_1_EH_0_PS_40_5, loss: 0.035720497369766235, avg_mse: 0.03846967965364456
current test mse: 0.03847
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493904411792755, gen p mean: -0.5264328718185425, mean p set: 0.4498707354068756
loss_pred:0.03349989652633667, decouple_loss:0.024697022512555122
The modified gen p mean: 0.4512452185153961, gen p mean: -0.5291675329208374, mean p set: 0.4517255127429962The modified gen p mean: 0.45085665583610535, gen p mean: -0.5238497257232666, mean p set: 0.45133697986602783
loss_pred:0.033057801425457, decouple_loss:0.024769987910985947
loss_pred:0.034492235630750656, decouple_loss:0.024691039696335793
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129385590553284, gen p mean: -0.5335635542869568, mean p set: 0.45177412033081055
The modified gen p mean: 0.4532161355018616, gen p mean: -0.5304418802261353, mean p set: 0.4536963999271393
loss_pred:0.03301215544342995, decouple_loss:0.025960734114050865
loss_pred:0.03391483426094055, decouple_loss:0.025865588337183
The modified gen p mean: 0.451339989900589, gen p mean: -0.5291293263435364, mean p set: 0.4518203139305115
loss_pred:0.03375306352972984, decouple_loss:0.025040816515684128
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080551505088806, gen p mean: -0.5381976962089539, mean p set: 0.45128580927848816
The modified gen p mean: 0.4512546956539154, gen p mean: -0.5398080945014954, mean p set: 0.4517350196838379
loss_pred:0.03305406495928764, decouple_loss:0.02381751500070095
loss_pred:0.033228799700737, decouple_loss:0.023688284680247307
The modified gen p mean: 0.45077329874038696, gen p mean: -0.540221631526947, mean p set: 0.45125362277030945
loss_pred:0.0333293192088604, decouple_loss:0.023998437449336052
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505396783351898, gen p mean: -0.5428202748298645, mean p set: 0.4510199725627899
The modified gen p mean: 0.44923752546310425, gen p mean: -0.5390031337738037, mean p set: 0.44971778988838196
loss_pred:0.034473564475774765, decouple_loss:0.02505859173834324
loss_pred:0.03354371339082718, decouple_loss:0.02545766904950142The modified gen p mean: 0.4509755074977875, gen p mean: -0.5401109457015991, mean p set: 0.4514558017253876
loss_pred:0.03473487123847008, decouple_loss:0.024043941870331764
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45043182373046875, gen p mean: -0.5373225212097168, mean p set: 0.45091211795806885
The modified gen p mean: 0.45142248272895813, gen p mean: -0.5428776144981384, mean p set: 0.4519027769565582
loss_pred:0.03461525961756706, decouple_loss:0.02622230164706707
loss_pred:0.032061003148555756, decouple_loss:0.023212149739265442
The modified gen p mean: 0.4526613652706146, gen p mean: -0.5434898734092712, mean p set: 0.45314162969589233
loss_pred:0.03442404046654701, decouple_loss:0.026386400684714317
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854339957237244, gen p mean: -0.5367754697799683, mean p set: 0.44902369379997253
loss_pred:0.033627986907958984, decouple_loss:0.026086529716849327
The modified gen p mean: 0.4515460133552551, gen p mean: -0.5512663722038269, mean p set: 0.4520263373851776The modified gen p mean: 0.4491100311279297, gen p mean: -0.5398752689361572, mean p set: 0.4495902955532074
loss_pred:0.03310248628258705, decouple_loss:0.024245020002126694
loss_pred:0.03268403559923172, decouple_loss:0.02477453462779522
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127686858177185, gen p mean: -0.5552660822868347, mean p set: 0.45175716280937195
loss_pred:0.033770445734262466, decouple_loss:0.025539102032780647
The modified gen p mean: 0.44987753033638, gen p mean: -0.5642280578613281, mean p set: 0.4503578245639801The modified gen p mean: 0.4509466290473938, gen p mean: -0.5547902584075928, mean p set: 0.4514269232749939
loss_pred:0.03505442291498184, decouple_loss:0.029208896681666374
loss_pred:0.034294236451387405, decouple_loss:0.026289019733667374
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482896029949188, gen p mean: -0.5458126068115234, mean p set: 0.4487698972225189
loss_pred:0.03461329638957977, decouple_loss:0.02624625340104103
The modified gen p mean: 0.44983842968940735, gen p mean: -0.5488236546516418, mean p set: 0.45031872391700745The modified gen p mean: 0.4508385956287384, gen p mean: -0.5513984560966492, mean p set: 0.4513188898563385
loss_pred:0.03324190527200699, decouple_loss:0.02556733414530754
loss_pred:0.03455428034067154, decouple_loss:0.025294208899140358
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503362476825714, gen p mean: -0.53167325258255, mean p set: 0.4508165121078491
The modified gen p mean: 0.4501728117465973, gen p mean: -0.5384319424629211, mean p set: 0.4506531357765198loss_pred:0.03334610536694527, decouple_loss:0.02512609027326107
The modified gen p mean: 0.4501637816429138, gen p mean: -0.5431817173957825, mean p set: 0.45064401626586914
loss_pred:0.03288071230053902, decouple_loss:0.024885427206754684
loss_pred:0.03367350995540619, decouple_loss:0.02581845410168171
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501436948776245, gen p mean: -0.5441128015518188, mean p set: 0.4506239891052246
loss_pred:0.0331929475069046, decouple_loss:0.024447323754429817
The modified gen p mean: 0.450148344039917, gen p mean: -0.5417956113815308, mean p set: 0.4506286382675171The modified gen p mean: 0.44860315322875977, gen p mean: -0.5392452478408813, mean p set: 0.44908347725868225
loss_pred:0.03272520378232002, decouple_loss:0.024142596870660782
loss_pred:0.03288104385137558, decouple_loss:0.02457367442548275
2023-05-01 18:47:30 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5549079775810242, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5439241528511047, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5478905439376831, mean p set: 0.4500633478164673
loss_pred:0.035249076783657074, decouple_loss:0.02960621379315853
loss_pred:0.03333839774131775, decouple_loss:0.028127068653702736
loss_pred:0.03415467590093613, decouple_loss:0.028238318860530853
WV_0_PC_1_EH_0_PS_40_5, loss: 0.035680241882801056, avg_mse: 0.03849659487605095
current test mse: 0.038497
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824227690696716, gen p mean: -0.547046422958374, mean p set: 0.4487225413322449
The modified gen p mean: 0.4504992961883545, gen p mean: -0.5515521168708801, mean p set: 0.4509795904159546
loss_pred:0.03293326124548912, decouple_loss:0.024780921638011932
The modified gen p mean: 0.44860726594924927, gen p mean: -0.5429466366767883, mean p set: 0.44908758997917175
loss_pred:0.0339016318321228, decouple_loss:0.025707056745886803
loss_pred:0.035421907901763916, decouple_loss:0.026320084929466248
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45103394985198975, gen p mean: -0.5442618131637573, mean p set: 0.45151427388191223
The modified gen p mean: 0.45033565163612366, gen p mean: -0.5449625253677368, mean p set: 0.45081597566604614
loss_pred:0.03525018319487572, decouple_loss:0.024667663499712944
loss_pred:0.03325588256120682, decouple_loss:0.02534135989844799
The modified gen p mean: 0.451181560754776, gen p mean: -0.5453449487686157, mean p set: 0.4516618549823761
loss_pred:0.03434295207262039, decouple_loss:0.024985790252685547
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997742772102356, gen p mean: -0.5357216000556946, mean p set: 0.45045775175094604
loss_pred:0.03231394663453102, decouple_loss:0.024486467242240906
The modified gen p mean: 0.4485201835632324, gen p mean: -0.5314750671386719, mean p set: 0.4490005075931549The modified gen p mean: 0.45013922452926636, gen p mean: -0.5372459292411804, mean p set: 0.45061951875686646
loss_pred:0.03342882916331291, decouple_loss:0.025278914719820023
loss_pred:0.03278495743870735, decouple_loss:0.024769376963377
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511813223361969, gen p mean: -0.5423866510391235, mean p set: 0.451661616563797
The modified gen p mean: 0.4502236843109131, gen p mean: -0.5497016906738281, mean p set: 0.4507039785385132
loss_pred:0.03383687138557434, decouple_loss:0.02384178526699543
loss_pred:0.03351892530918121, decouple_loss:0.02371024154126644
The modified gen p mean: 0.4485991299152374, gen p mean: -0.5406923890113831, mean p set: 0.4490794241428375
loss_pred:0.03348091244697571, decouple_loss:0.024307765066623688
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501018822193146, gen p mean: -0.5544177889823914, mean p set: 0.45058220624923706
The modified gen p mean: 0.45004984736442566, gen p mean: -0.5537981986999512, mean p set: 0.45053014159202576
loss_pred:0.03397779539227486, decouple_loss:0.022923627868294716
loss_pred:0.03291373699903488, decouple_loss:0.023919636383652687
The modified gen p mean: 0.44882988929748535, gen p mean: -0.540829598903656, mean p set: 0.44931018352508545
loss_pred:0.03427448496222496, decouple_loss:0.02471163310110569
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883403182029724, gen p mean: -0.5302461385726929, mean p set: 0.44931429624557495
The modified gen p mean: 0.44897350668907166, gen p mean: -0.5339778065681458, mean p set: 0.44945380091667175
loss_pred:0.03477532044053078, decouple_loss:0.024035412818193436
loss_pred:0.03358862176537514, decouple_loss:0.023512879386544228
The modified gen p mean: 0.4495946764945984, gen p mean: -0.5402523279190063, mean p set: 0.4500750005245209
loss_pred:0.03395563364028931, decouple_loss:0.022678589448332787
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861555099487305, gen p mean: -0.528144896030426, mean p set: 0.44909584522247314
The modified gen p mean: 0.44945964217185974, gen p mean: -0.5339751243591309, mean p set: 0.44993993639945984loss_pred:0.032777149230241776, decouple_loss:0.02384362183511257
The modified gen p mean: 0.44940176606178284, gen p mean: -0.5323868989944458, mean p set: 0.4498820900917053
loss_pred:0.03433350846171379, decouple_loss:0.023646922782063484
loss_pred:0.03293909132480621, decouple_loss:0.022495433688163757
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031073689460754, gen p mean: -0.5419732928276062, mean p set: 0.45079106092453003
The modified gen p mean: 0.4498046040534973, gen p mean: -0.5274990200996399, mean p set: 0.4502848982810974
loss_pred:0.032646168023347855, decouple_loss:0.02521178312599659
loss_pred:0.03392156958580017, decouple_loss:0.027375828474760056
The modified gen p mean: 0.4493566155433655, gen p mean: -0.5333154797554016, mean p set: 0.44983693957328796
loss_pred:0.03406820818781853, decouple_loss:0.026064442470669746
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490130841732025, gen p mean: -0.5430306196212769, mean p set: 0.449493408203125
loss_pred:0.03381950035691261, decouple_loss:0.02323783002793789
The modified gen p mean: 0.4502759575843811, gen p mean: -0.538489818572998, mean p set: 0.4507562518119812The modified gen p mean: 0.4509267508983612, gen p mean: -0.5462675094604492, mean p set: 0.4514070451259613
loss_pred:0.03369759023189545, decouple_loss:0.026116227731108665
loss_pred:0.033225398510694504, decouple_loss:0.02592908963561058
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499850869178772, gen p mean: -0.5454450249671936, mean p set: 0.4504653811454773
loss_pred:0.03224973753094673, decouple_loss:0.02365497685968876
The modified gen p mean: 0.45019635558128357, gen p mean: -0.5517106652259827, mean p set: 0.45067667961120605The modified gen p mean: 0.44822803139686584, gen p mean: -0.5342184901237488, mean p set: 0.44870832562446594
loss_pred:0.034683916717767715, decouple_loss:0.024328136816620827
loss_pred:0.03270907327532768, decouple_loss:0.024380875751376152
2023-05-01 18:49:38 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5427225232124329, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5329578518867493, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5365301966667175, mean p set: 0.4500633478164673
loss_pred:0.035061467438936234, decouple_loss:0.028063355013728142
loss_pred:0.033192213624715805, decouple_loss:0.026670299470424652
loss_pred:0.03393997624516487, decouple_loss:0.02647414058446884
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03541801869869232, avg_mse: 0.03835468366742134
current test mse: 0.038355
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051079988479614, gen p mean: -0.5407018661499023, mean p set: 0.45099109411239624
loss_pred:0.033423736691474915, decouple_loss:0.02404710091650486
The modified gen p mean: 0.44998276233673096, gen p mean: -0.5417250990867615, mean p set: 0.45046308636665344The modified gen p mean: 0.44957005977630615, gen p mean: -0.535757839679718, mean p set: 0.45005032420158386
loss_pred:0.03279566019773483, decouple_loss:0.02478199265897274
loss_pred:0.032102979719638824, decouple_loss:0.02358884923160076
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498642385005951, gen p mean: -0.5434330105781555, mean p set: 0.4503445625305176
loss_pred:0.0343744195997715, decouple_loss:0.024083605036139488
The modified gen p mean: 0.44992148876190186, gen p mean: -0.5395544171333313, mean p set: 0.45040175318717957The modified gen p mean: 0.4483577609062195, gen p mean: -0.5323893427848816, mean p set: 0.4488380551338196
loss_pred:0.03321358561515808, decouple_loss:0.024169348180294037
loss_pred:0.033579397946596146, decouple_loss:0.025018909946084023
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019403100013733, gen p mean: -0.5391064882278442, mean p set: 0.45067429542541504
The modified gen p mean: 0.4495129883289337, gen p mean: -0.5423789024353027, mean p set: 0.4499933123588562
loss_pred:0.03370291739702225, decouple_loss:0.02331145666539669
loss_pred:0.03317124769091606, decouple_loss:0.025010986253619194
The modified gen p mean: 0.450810045003891, gen p mean: -0.5402312278747559, mean p set: 0.4512903094291687
loss_pred:0.03449832275509834, decouple_loss:0.024152453988790512
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501136541366577, gen p mean: -0.5332136154174805, mean p set: 0.4505939483642578
loss_pred:0.03336833417415619, decouple_loss:0.024570655077695847
The modified gen p mean: 0.4508129358291626, gen p mean: -0.5490067601203918, mean p set: 0.4512932300567627The modified gen p mean: 0.44889262318611145, gen p mean: -0.5442232489585876, mean p set: 0.44937294721603394
loss_pred:0.03294016048312187, decouple_loss:0.023154588416218758
loss_pred:0.03184260427951813, decouple_loss:0.02304050140082836
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056432485580444, gen p mean: -0.5550091862678528, mean p set: 0.45104461908340454
The modified gen p mean: 0.4507596492767334, gen p mean: -0.5509182810783386, mean p set: 0.4512398838996887
loss_pred:0.033348213881254196, decouple_loss:0.023391272872686386
loss_pred:0.03420805558562279, decouple_loss:0.023371685296297073
The modified gen p mean: 0.45036405324935913, gen p mean: -0.5486501455307007, mean p set: 0.4508443772792816
loss_pred:0.03315737098455429, decouple_loss:0.023187004029750824
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498552083969116, gen p mean: -0.559585690498352, mean p set: 0.45033547282218933
loss_pred:0.033876482397317886, decouple_loss:0.024381164461374283
The modified gen p mean: 0.4488689601421356, gen p mean: -0.5501729249954224, mean p set: 0.4493492543697357The modified gen p mean: 0.4488946199417114, gen p mean: -0.551345705986023, mean p set: 0.44937488436698914
loss_pred:0.03394531086087227, decouple_loss:0.02377859316766262
loss_pred:0.03318805620074272, decouple_loss:0.023636721074581146
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471943974494934, gen p mean: -0.54890376329422, mean p set: 0.4476746618747711
loss_pred:0.034465890377759933, decouple_loss:0.028899842873215675
The modified gen p mean: 0.4481734037399292, gen p mean: -0.5477949976921082, mean p set: 0.4486536979675293The modified gen p mean: 0.4468432366847992, gen p mean: -0.551998496055603, mean p set: 0.4473235309123993
loss_pred:0.03323798626661301, decouple_loss:0.027425948530435562
loss_pred:0.034616511315107346, decouple_loss:0.02735750563442707
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478653073310852, gen p mean: -0.5491327047348022, mean p set: 0.4483456313610077
loss_pred:0.0342540517449379, decouple_loss:0.02752426639199257
The modified gen p mean: 0.44804465770721436, gen p mean: -0.5529646873474121, mean p set: 0.44852498173713684The modified gen p mean: 0.447773814201355, gen p mean: -0.555425226688385, mean p set: 0.4482541084289551
loss_pred:0.034340593963861465, decouple_loss:0.027461407706141472
loss_pred:0.034158855676651, decouple_loss:0.02826671674847603
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483368694782257, gen p mean: -0.5479875206947327, mean p set: 0.4488171935081482
loss_pred:0.0333557054400444, decouple_loss:0.02519797720015049
The modified gen p mean: 0.4466976225376129, gen p mean: -0.5482565760612488, mean p set: 0.447177916765213The modified gen p mean: 0.44827932119369507, gen p mean: -0.5558804869651794, mean p set: 0.44875964522361755
loss_pred:0.0333489365875721, decouple_loss:0.025766465812921524
loss_pred:0.03266274183988571, decouple_loss:0.026423634961247444
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667744636535645, gen p mean: -0.5478023290634155, mean p set: 0.44715774059295654
loss_pred:0.03423099219799042, decouple_loss:0.023783991113305092
The modified gen p mean: 0.44744789600372314, gen p mean: -0.5466932654380798, mean p set: 0.44792816042900085The modified gen p mean: 0.44784218072891235, gen p mean: -0.5445414185523987, mean p set: 0.44832247495651245
loss_pred:0.033310480415821075, decouple_loss:0.026528896763920784
loss_pred:0.0345124825835228, decouple_loss:0.025917883962392807
2023-05-01 18:52:26 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5515777468681335, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.544516384601593, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5406088829040527, mean p set: 0.45035696029663086
loss_pred:0.0349644273519516, decouple_loss:0.026316771283745766
loss_pred:0.03396165370941162, decouple_loss:0.02589176595211029
loss_pred:0.03310997784137726, decouple_loss:0.02667107991874218
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03532668203115463, avg_mse: 0.038084305822849274
current test mse: 0.038084
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751396775245667, gen p mean: -0.5417627692222595, mean p set: 0.44799429178237915
loss_pred:0.03315756842494011, decouple_loss:0.024777710437774658
The modified gen p mean: 0.4473123550415039, gen p mean: -0.550994873046875, mean p set: 0.4477926790714264The modified gen p mean: 0.44812795519828796, gen p mean: -0.5466700792312622, mean p set: 0.44860827922821045
loss_pred:0.03361382335424423, decouple_loss:0.025286700576543808
loss_pred:0.033737607300281525, decouple_loss:0.02526506595313549
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769221544265747, gen p mean: -0.5420508980751038, mean p set: 0.44817250967025757
The modified gen p mean: 0.4479922950267792, gen p mean: -0.5385391712188721, mean p set: 0.4484725892543793
loss_pred:0.03485424444079399, decouple_loss:0.025251111015677452
loss_pred:0.032593365758657455, decouple_loss:0.02492406778037548
The modified gen p mean: 0.44763290882110596, gen p mean: -0.5464559197425842, mean p set: 0.44811320304870605
loss_pred:0.03324936702847481, decouple_loss:0.025373287498950958
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762372970581055, gen p mean: -0.5471450686454773, mean p set: 0.44810402393341064
The modified gen p mean: 0.4460369944572449, gen p mean: -0.5379738807678223, mean p set: 0.44651728868484497
loss_pred:0.032360997051000595, decouple_loss:0.024260180070996284
loss_pred:0.03322838619351387, decouple_loss:0.02514241263270378
The modified gen p mean: 0.4473298192024231, gen p mean: -0.5409789085388184, mean p set: 0.4478101134300232
loss_pred:0.033484045416116714, decouple_loss:0.024304503574967384
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44795340299606323, gen p mean: -0.529944121837616, mean p set: 0.44843369722366333
The modified gen p mean: 0.4476127028465271, gen p mean: -0.5263200402259827, mean p set: 0.4480930268764496
loss_pred:0.032601844519376755, decouple_loss:0.023113347589969635
loss_pred:0.03471303731203079, decouple_loss:0.024902302771806717
The modified gen p mean: 0.4466927945613861, gen p mean: -0.5309197902679443, mean p set: 0.4471730887889862
loss_pred:0.03425220400094986, decouple_loss:0.02511797845363617
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716647267341614, gen p mean: -0.5261068940162659, mean p set: 0.44764673709869385
The modified gen p mean: 0.4473423361778259, gen p mean: -0.525991678237915, mean p set: 0.447822630405426
loss_pred:0.03384699299931526, decouple_loss:0.024606719613075256
loss_pred:0.03290341794490814, decouple_loss:0.024398989975452423
The modified gen p mean: 0.4483192265033722, gen p mean: -0.5215372443199158, mean p set: 0.4487995207309723
loss_pred:0.03451470285654068, decouple_loss:0.02481948956847191
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462664723396301, gen p mean: -0.5265361070632935, mean p set: 0.4467467665672302
The modified gen p mean: 0.4481970965862274, gen p mean: -0.5271694660186768, mean p set: 0.4486773908138275
loss_pred:0.03336428478360176, decouple_loss:0.024508792906999588
The modified gen p mean: 0.44784584641456604, gen p mean: -0.5311281085014343, mean p set: 0.44832614064216614
loss_pred:0.03309446573257446, decouple_loss:0.024024859070777893
loss_pred:0.03264515474438667, decouple_loss:0.02419792301952839
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481167495250702, gen p mean: -0.5308862328529358, mean p set: 0.4485970735549927
The modified gen p mean: 0.44809389114379883, gen p mean: -0.5308059453964233, mean p set: 0.4485742151737213
loss_pred:0.03270474448800087, decouple_loss:0.02414833754301071
loss_pred:0.032506655901670456, decouple_loss:0.023899227380752563
The modified gen p mean: 0.44642502069473267, gen p mean: -0.5277644991874695, mean p set: 0.4469052851200104
loss_pred:0.033214546740055084, decouple_loss:0.02518651820719242
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472848176956177, gen p mean: -0.5359969139099121, mean p set: 0.4477651119232178
The modified gen p mean: 0.44725462794303894, gen p mean: -0.5355415940284729, mean p set: 0.44773492217063904
loss_pred:0.03343355655670166, decouple_loss:0.02479444071650505
loss_pred:0.03363936394453049, decouple_loss:0.023335127159953117
The modified gen p mean: 0.4481574296951294, gen p mean: -0.5367293357849121, mean p set: 0.4486377537250519
loss_pred:0.034004002809524536, decouple_loss:0.024602249264717102
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792696833610535, gen p mean: -0.5305219292640686, mean p set: 0.44840726256370544
The modified gen p mean: 0.4470152258872986, gen p mean: -0.529753565788269, mean p set: 0.4474954903125763
loss_pred:0.03350292146205902, decouple_loss:0.02301512286067009
loss_pred:0.034670207649469376, decouple_loss:0.02414526417851448
The modified gen p mean: 0.4475368559360504, gen p mean: -0.5276516079902649, mean p set: 0.4480171501636505
loss_pred:0.033533405512571335, decouple_loss:0.02385059930384159
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733956456184387, gen p mean: -0.5314375758171082, mean p set: 0.44781988859176636
The modified gen p mean: 0.4455784261226654, gen p mean: -0.5197955369949341, mean p set: 0.4460587203502655
loss_pred:0.03424505144357681, decouple_loss:0.023313922807574272
loss_pred:0.03303880989551544, decouple_loss:0.02475651726126671
The modified gen p mean: 0.44663006067276, gen p mean: -0.5293964743614197, mean p set: 0.4471103250980377
loss_pred:0.0346478596329689, decouple_loss:0.023487351834774017
2023-05-01 18:54:33 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5371710658073425, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5273762941360474, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5310531854629517, mean p set: 0.4500633478164673
loss_pred:0.03472147881984711, decouple_loss:0.02526703290641308
loss_pred:0.03304271399974823, decouple_loss:0.024978913366794586
loss_pred:0.033781036734580994, decouple_loss:0.024289479479193687
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03509066626429558, avg_mse: 0.038016531616449356
current test mse: 0.038017
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733601808547974, gen p mean: -0.53684002161026, mean p set: 0.44781628251075745
The modified gen p mean: 0.44786500930786133, gen p mean: -0.5320488214492798, mean p set: 0.44834527373313904
loss_pred:0.03388642519712448, decouple_loss:0.02441069483757019
The modified gen p mean: 0.448651522397995, gen p mean: -0.5285638570785522, mean p set: 0.4491317868232727
loss_pred:0.03420482203364372, decouple_loss:0.02399754337966442
loss_pred:0.03296990692615509, decouple_loss:0.023768743500113487
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809916615486145, gen p mean: -0.5319263935089111, mean p set: 0.44857946038246155
The modified gen p mean: 0.4467615783214569, gen p mean: -0.5394245386123657, mean p set: 0.447241872549057
loss_pred:0.03260766714811325, decouple_loss:0.023326244205236435
loss_pred:0.03364574536681175, decouple_loss:0.023940669372677803
The modified gen p mean: 0.4476580023765564, gen p mean: -0.5303388237953186, mean p set: 0.4481382668018341
loss_pred:0.03288639336824417, decouple_loss:0.023460110649466515
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466819167137146, gen p mean: -0.5347036123275757, mean p set: 0.4471621811389923
The modified gen p mean: 0.4480590224266052, gen p mean: -0.5354033708572388, mean p set: 0.4485393166542053
loss_pred:0.033937741070985794, decouple_loss:0.024200012907385826
loss_pred:0.03351259604096413, decouple_loss:0.024209098890423775
The modified gen p mean: 0.44606471061706543, gen p mean: -0.5362080931663513, mean p set: 0.4465450048446655
loss_pred:0.033454105257987976, decouple_loss:0.023092640563845634
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727715849876404, gen p mean: -0.5366511344909668, mean p set: 0.44775745272636414
The modified gen p mean: 0.44772395491600037, gen p mean: -0.5278709530830383, mean p set: 0.44820424914360046
loss_pred:0.03285260498523712, decouple_loss:0.023380614817142487
loss_pred:0.03348461166024208, decouple_loss:0.023952016606926918
The modified gen p mean: 0.44782301783561707, gen p mean: -0.5385593771934509, mean p set: 0.44830334186553955
loss_pred:0.03310079127550125, decouple_loss:0.023517591878771782
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665244221687317, gen p mean: -0.531635046005249, mean p set: 0.44713273644447327
The modified gen p mean: 0.4474705457687378, gen p mean: -0.5327408909797668, mean p set: 0.4479508101940155
loss_pred:0.03363119065761566, decouple_loss:0.023899681866168976
loss_pred:0.03337443247437477, decouple_loss:0.02327534556388855
The modified gen p mean: 0.44732123613357544, gen p mean: -0.5379937887191772, mean p set: 0.44780153036117554
loss_pred:0.034493375569581985, decouple_loss:0.022469324991106987
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486333727836609, gen p mean: -0.534386396408081, mean p set: 0.449113667011261
The modified gen p mean: 0.44619259238243103, gen p mean: -0.5350327491760254, mean p set: 0.44667288661003113
loss_pred:0.03394652158021927, decouple_loss:0.02348826266825199
loss_pred:0.03308271989226341, decouple_loss:0.02273070439696312
The modified gen p mean: 0.4458562433719635, gen p mean: -0.5331975817680359, mean p set: 0.446336567401886
loss_pred:0.032748304307460785, decouple_loss:0.022197211161255836
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
NaN value num: 0
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44995635747909546, gen p mean: -0.5316802859306335, mean p set: 0.4504365921020508
loss_pred:0.03392034024000168, decouple_loss:0.02813899517059326
The modified gen p mean: 0.45034050941467285, gen p mean: -0.5260017514228821, mean p set: 0.45082080364227295The modified gen p mean: 0.44928795099258423, gen p mean: -0.5245327353477478, mean p set: 0.4497682452201843
loss_pred:0.033244743943214417, decouple_loss:0.029198136180639267
loss_pred:0.03428785875439644, decouple_loss:0.027540920302271843
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45043936371803284, gen p mean: -0.5265666246414185, mean p set: 0.4509196877479553
The modified gen p mean: 0.4493584632873535, gen p mean: -0.5265791416168213, mean p set: 0.4498387575149536
loss_pred:0.03445083275437355, decouple_loss:0.026536863297224045
loss_pred:0.03447118401527405, decouple_loss:0.02646874636411667
The modified gen p mean: 0.4508695900440216, gen p mean: -0.52992844581604, mean p set: 0.4513498842716217
loss_pred:0.03287699818611145, decouple_loss:0.02800523303449154
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516625702381134, gen p mean: -0.5366151928901672, mean p set: 0.4521428644657135
The modified gen p mean: 0.4515420198440552, gen p mean: -0.5366043448448181, mean p set: 0.4520223140716553
loss_pred:0.032763585448265076, decouple_loss:0.02596375346183777
loss_pred:0.034206535667181015, decouple_loss:0.027437761425971985
The modified gen p mean: 0.44962507486343384, gen p mean: -0.5374360084533691, mean p set: 0.45010536909103394
loss_pred:0.03348909690976143, decouple_loss:0.025413554161787033
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45151445269584656, gen p mean: -0.5418197512626648, mean p set: 0.45199474692344666
The modified gen p mean: 0.45246824622154236, gen p mean: -0.5366144776344299, mean p set: 0.45294854044914246
loss_pred:0.03323601931333542, decouple_loss:0.02565973810851574
loss_pred:0.03320761397480965, decouple_loss:0.027128122746944427
The modified gen p mean: 0.4500633776187897, gen p mean: -0.5368910431861877, mean p set: 0.45054367184638977
loss_pred:0.032626084983348846, decouple_loss:0.024572070688009262
2023-05-01 18:57:17 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5371724367141724, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5310068130493164, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5268381834030151, mean p set: 0.45035696029663086
loss_pred:0.03479117527604103, decouple_loss:0.028841659426689148
loss_pred:0.033758241683244705, decouple_loss:0.027908502146601677
loss_pred:0.032977622002363205, decouple_loss:0.028421252965927124
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03526186943054199, avg_mse: 0.038212526589632034
current test mse: 0.038213
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510924220085144, gen p mean: -0.5412968397140503, mean p set: 0.4515727162361145
loss_pred:0.03337322920560837, decouple_loss:0.025054287165403366
The modified gen p mean: 0.45053040981292725, gen p mean: -0.5351842641830444, mean p set: 0.45101073384284973The modified gen p mean: 0.4495964050292969, gen p mean: -0.5328403115272522, mean p set: 0.45007672905921936
loss_pred:0.033384885638952255, decouple_loss:0.024581165984272957
loss_pred:0.03446478769183159, decouple_loss:0.027067644521594048
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513101875782013, gen p mean: -0.5413023233413696, mean p set: 0.4517904818058014
loss_pred:0.0350286141037941, decouple_loss:0.026494206860661507
The modified gen p mean: 0.4494033455848694, gen p mean: -0.5352479219436646, mean p set: 0.4498836398124695The modified gen p mean: 0.45086970925331116, gen p mean: -0.5364607572555542, mean p set: 0.45135000348091125
loss_pred:0.03301823139190674, decouple_loss:0.026881877332925797
loss_pred:0.0342496819794178, decouple_loss:0.027160964906215668
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493976831436157, gen p mean: -0.5307398438453674, mean p set: 0.44987794756889343
loss_pred:0.03425293415784836, decouple_loss:0.025540737435221672
The modified gen p mean: 0.45203572511672974, gen p mean: -0.5369027853012085, mean p set: 0.45251601934432983The modified gen p mean: 0.4502943754196167, gen p mean: -0.5372777581214905, mean p set: 0.4507746696472168
loss_pred:0.03381575271487236, decouple_loss:0.024552959948778152
loss_pred:0.034952301532030106, decouple_loss:0.0253484845161438
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180270075798035, gen p mean: -0.5523208379745483, mean p set: 0.45228299498558044
loss_pred:0.033265892416238785, decouple_loss:0.024724354967474937
The modified gen p mean: 0.45124033093452454, gen p mean: -0.555377185344696, mean p set: 0.45172062516212463
The modified gen p mean: 0.45050284266471863, gen p mean: -0.5471160411834717, mean p set: 0.4509831368923187
loss_pred:0.034835007041692734, decouple_loss:0.025647900998592377
loss_pred:0.034761492162942886, decouple_loss:0.025137150660157204
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517233073711395, gen p mean: -0.5531370639801025, mean p set: 0.452203631401062
The modified gen p mean: 0.4497741162776947, gen p mean: -0.549999475479126, mean p set: 0.4502543807029724
loss_pred:0.033950988203287125, decouple_loss:0.02441835030913353
loss_pred:0.03519080951809883, decouple_loss:0.024138133972883224
The modified gen p mean: 0.4527937173843384, gen p mean: -0.5463026165962219, mean p set: 0.4532740116119385
loss_pred:0.033113136887550354, decouple_loss:0.025775786489248276
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533882737159729, gen p mean: -0.5424718260765076, mean p set: 0.453868567943573
The modified gen p mean: 0.4508477449417114, gen p mean: -0.5421578884124756, mean p set: 0.4513280689716339loss_pred:0.0330972820520401, decouple_loss:0.02684582583606243
The modified gen p mean: 0.4502983093261719, gen p mean: -0.5374628901481628, mean p set: 0.450778603553772
loss_pred:0.03271222487092018, decouple_loss:0.026044419035315514
loss_pred:0.03431860730051994, decouple_loss:0.025262629613280296
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968274235725403, gen p mean: -0.5502869486808777, mean p set: 0.4501630365848541
The modified gen p mean: 0.45099061727523804, gen p mean: -0.5493834614753723, mean p set: 0.45147088170051575loss_pred:0.03287332132458687, decouple_loss:0.026169585064053535
The modified gen p mean: 0.4494931399822235, gen p mean: -0.5456405878067017, mean p set: 0.449973464012146
loss_pred:0.03323235362768173, decouple_loss:0.02619641087949276
loss_pred:0.033774059265851974, decouple_loss:0.025553273037075996
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451815128326416, gen p mean: -0.5530011653900146, mean p set: 0.4522954225540161
loss_pred:0.03285108506679535, decouple_loss:0.02495541237294674
The modified gen p mean: 0.4510711431503296, gen p mean: -0.5532826781272888, mean p set: 0.4515514075756073The modified gen p mean: 0.4517621397972107, gen p mean: -0.5600766539573669, mean p set: 0.4522424042224884
loss_pred:0.03414410725235939, decouple_loss:0.024113183841109276
loss_pred:0.03286290913820267, decouple_loss:0.024362046271562576
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945886731147766, gen p mean: -0.554447591304779, mean p set: 0.44993916153907776
loss_pred:0.03275438770651817, decouple_loss:0.024617375805974007
The modified gen p mean: 0.4498800039291382, gen p mean: -0.5561529397964478, mean p set: 0.4503602981567383The modified gen p mean: 0.45251035690307617, gen p mean: -0.5560977458953857, mean p set: 0.4529906213283539
loss_pred:0.03328676521778107, decouple_loss:0.024034617468714714
loss_pred:0.032922010868787766, decouple_loss:0.02456742338836193
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452109694480896, gen p mean: -0.5587164163589478, mean p set: 0.4525899887084961
loss_pred:0.0327642597258091, decouple_loss:0.024303145706653595
The modified gen p mean: 0.45172128081321716, gen p mean: -0.5603494644165039, mean p set: 0.45220157504081726
The modified gen p mean: 0.4511820077896118, gen p mean: -0.5563151240348816, mean p set: 0.4516623318195343
loss_pred:0.03333534672856331, decouple_loss:0.024749118834733963
loss_pred:0.03301139175891876, decouple_loss:0.023548847064375877
2023-05-01 18:59:25 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5511415004730225, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5443825125694275, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5398638248443604, mean p set: 0.45035696029663086
loss_pred:0.03488042205572128, decouple_loss:0.02661747671663761
loss_pred:0.033865660429000854, decouple_loss:0.025659529492259026
loss_pred:0.03310641273856163, decouple_loss:0.02617550641298294
WV_0_PC_1_EH_0_PS_40_5, loss: 0.035258375108242035, avg_mse: 0.038474954664707184
current test mse: 0.038475
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45193731784820557, gen p mean: -0.5477548241615295, mean p set: 0.45241761207580566
loss_pred:0.03364938497543335, decouple_loss:0.023828746750950813
The modified gen p mean: 0.45031842589378357, gen p mean: -0.5513362884521484, mean p set: 0.45079872012138367The modified gen p mean: 0.45118770003318787, gen p mean: -0.5459057092666626, mean p set: 0.45166799426078796
loss_pred:0.03492620587348938, decouple_loss:0.024280572310090065
loss_pred:0.033546943217515945, decouple_loss:0.025287078693509102
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498148560523987, gen p mean: -0.548199474811554, mean p set: 0.4502951502799988
The modified gen p mean: 0.4516680836677551, gen p mean: -0.5558359622955322, mean p set: 0.4521483778953552
loss_pred:0.032485321164131165, decouple_loss:0.02396436594426632
loss_pred:0.03462104871869087, decouple_loss:0.02441599778831005
The modified gen p mean: 0.4517834186553955, gen p mean: -0.5461236834526062, mean p set: 0.452263742685318
loss_pred:0.03281748667359352, decouple_loss:0.023958923295140266
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453704297542572, gen p mean: -0.5422113537788391, mean p set: 0.45418456196784973
The modified gen p mean: 0.45142197608947754, gen p mean: -0.555986225605011, mean p set: 0.45190224051475525
loss_pred:0.03339517116546631, decouple_loss:0.0268059354275465
loss_pred:0.03426502272486687, decouple_loss:0.02515537664294243
The modified gen p mean: 0.4510827362537384, gen p mean: -0.5498055219650269, mean p set: 0.4515630006790161
loss_pred:0.03266485407948494, decouple_loss:0.02437686175107956
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44981101155281067, gen p mean: -0.5360267758369446, mean p set: 0.45029133558273315
The modified gen p mean: 0.45179039239883423, gen p mean: -0.5438750982284546, mean p set: 0.4522706866264343
loss_pred:0.034902799874544144, decouple_loss:0.023267092183232307
loss_pred:0.03427230194211006, decouple_loss:0.023505492135882378
The modified gen p mean: 0.4499293267726898, gen p mean: -0.5357502102851868, mean p set: 0.4504096210002899
loss_pred:0.03415939211845398, decouple_loss:0.0237794928252697
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520491063594818, gen p mean: -0.5515945553779602, mean p set: 0.4525294005870819
The modified gen p mean: 0.4514254331588745, gen p mean: -0.5551010966300964, mean p set: 0.451905757188797
loss_pred:0.033092282712459564, decouple_loss:0.023794598877429962
loss_pred:0.033047642558813095, decouple_loss:0.024222705513238907
The modified gen p mean: 0.4508407413959503, gen p mean: -0.5536704659461975, mean p set: 0.4513210654258728
loss_pred:0.03405563905835152, decouple_loss:0.024610495194792747
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45117947459220886, gen p mean: -0.5572205781936646, mean p set: 0.4516597390174866
The modified gen p mean: 0.45050323009490967, gen p mean: -0.554770290851593, mean p set: 0.4509834945201874
loss_pred:0.03278014808893204, decouple_loss:0.025366801768541336
loss_pred:0.033231720328330994, decouple_loss:0.02410174161195755
The modified gen p mean: 0.45313552021980286, gen p mean: -0.5574173927307129, mean p set: 0.45361581444740295
loss_pred:0.03340433910489082, decouple_loss:0.02560761384665966
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
NaN value num: 0
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017534494400024, gen p mean: -0.5431591868400574, mean p set: 0.45065566897392273
loss_pred:0.0340617299079895, decouple_loss:0.026842264458537102
The modified gen p mean: 0.4518599212169647, gen p mean: -0.5406842231750488, mean p set: 0.4523402154445648The modified gen p mean: 0.44930359721183777, gen p mean: -0.5379677414894104, mean p set: 0.44978389143943787
loss_pred:0.03520705923438072, decouple_loss:0.027879219502210617
loss_pred:0.03181872516870499, decouple_loss:0.028163937851786613
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506269693374634, gen p mean: -0.5349389314651489, mean p set: 0.4511072635650635
The modified gen p mean: 0.44900307059288025, gen p mean: -0.5271996855735779, mean p set: 0.44948339462280273loss_pred:0.033754441887140274, decouple_loss:0.027156807482242584
The modified gen p mean: 0.44909465312957764, gen p mean: -0.5294327139854431, mean p set: 0.44957494735717773
loss_pred:0.03276228532195091, decouple_loss:0.027797672897577286
loss_pred:0.030470537021756172, decouple_loss:0.02742663584649563
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504595994949341, gen p mean: -0.541732132434845, mean p set: 0.45093992352485657
The modified gen p mean: 0.44978171586990356, gen p mean: -0.5443534851074219, mean p set: 0.4502619802951813
loss_pred:0.03440334275364876, decouple_loss:0.026541169732809067
loss_pred:0.03277326002717018, decouple_loss:0.025886116549372673
The modified gen p mean: 0.4504971206188202, gen p mean: -0.5381665825843811, mean p set: 0.4509774148464203
loss_pred:0.03394158557057381, decouple_loss:0.02636176161468029
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511968195438385, gen p mean: -0.5497974753379822, mean p set: 0.451677143573761
The modified gen p mean: 0.4493029713630676, gen p mean: -0.5473824739456177, mean p set: 0.4497832953929901
loss_pred:0.03324385732412338, decouple_loss:0.02565033547580242
loss_pred:0.03371439129114151, decouple_loss:0.025225987657904625
The modified gen p mean: 0.4491126239299774, gen p mean: -0.5412194728851318, mean p set: 0.4495929181575775
loss_pred:0.03268936276435852, decouple_loss:0.025464806705713272
2023-05-01 19:02:08 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5593438148498535, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5481005907058716, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5525345206260681, mean p set: 0.4500633478164673
loss_pred:0.034921858459711075, decouple_loss:0.029579484835267067
loss_pred:0.03302491456270218, decouple_loss:0.029100928455591202
loss_pred:0.033804815262556076, decouple_loss:0.02824639342725277
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03536597639322281, avg_mse: 0.038414787501096725
current test mse: 0.038415
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023706555366516, gen p mean: -0.5519967675209045, mean p set: 0.45071735978126526
The modified gen p mean: 0.450796902179718, gen p mean: -0.5518561601638794, mean p set: 0.4512771964073181
loss_pred:0.03351709619164467, decouple_loss:0.0272988211363554
The modified gen p mean: 0.44958746433258057, gen p mean: -0.545238196849823, mean p set: 0.45006775856018066
loss_pred:0.03164248540997505, decouple_loss:0.02524375356733799
loss_pred:0.031848154962062836, decouple_loss:0.024583620950579643
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492533504962921, gen p mean: -0.5511934757232666, mean p set: 0.4497336745262146
loss_pred:0.03287894278764725, decouple_loss:0.02678806707262993
The modified gen p mean: 0.45185157656669617, gen p mean: -0.5602006316184998, mean p set: 0.45233187079429626The modified gen p mean: 0.4490774869918823, gen p mean: -0.5649718642234802, mean p set: 0.4495577812194824
loss_pred:0.03367144614458084, decouple_loss:0.027504663914442062
loss_pred:0.0324847586452961, decouple_loss:0.027064014226198196
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449188768863678, gen p mean: -0.5641193389892578, mean p set: 0.4496690630912781
loss_pred:0.03178206458687782, decouple_loss:0.026636922731995583
The modified gen p mean: 0.4499051570892334, gen p mean: -0.5531959533691406, mean p set: 0.4503854513168335
The modified gen p mean: 0.452171266078949, gen p mean: -0.5556862950325012, mean p set: 0.45265159010887146
loss_pred:0.030620746314525604, decouple_loss:0.026662899181246758
loss_pred:0.03389575332403183, decouple_loss:0.028716111555695534
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489581882953644, gen p mean: -0.548776388168335, mean p set: 0.4494384825229645
The modified gen p mean: 0.45127204060554504, gen p mean: -0.5478749871253967, mean p set: 0.45175236463546753
loss_pred:0.03069213405251503, decouple_loss:0.025388460606336594
loss_pred:0.03448436036705971, decouple_loss:0.027060244232416153
The modified gen p mean: 0.4498801827430725, gen p mean: -0.5525848269462585, mean p set: 0.4503604471683502
loss_pred:0.03142961114645004, decouple_loss:0.02561289258301258
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45126527547836304, gen p mean: -0.5544490218162537, mean p set: 0.45174553990364075
The modified gen p mean: 0.4497600495815277, gen p mean: -0.5525826811790466, mean p set: 0.4502403438091278
loss_pred:0.034099165350198746, decouple_loss:0.027676653116941452
loss_pred:0.03213569521903992, decouple_loss:0.025110313668847084
The modified gen p mean: 0.45159292221069336, gen p mean: -0.5496740937232971, mean p set: 0.45207321643829346
loss_pred:0.03408313915133476, decouple_loss:0.02648766152560711
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139554142951965, gen p mean: -0.5687233209609985, mean p set: 0.45187583565711975
The modified gen p mean: 0.4493320882320404, gen p mean: -0.5716025233268738, mean p set: 0.4498123526573181
loss_pred:0.0335521399974823, decouple_loss:0.02602209709584713
loss_pred:0.03229658305644989, decouple_loss:0.0248690377920866
The modified gen p mean: 0.4491424560546875, gen p mean: -0.5680979490280151, mean p set: 0.4496227502822876
loss_pred:0.030846957117319107, decouple_loss:0.025886308401823044
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121854543685913, gen p mean: -0.5614922642707825, mean p set: 0.45169880986213684
The modified gen p mean: 0.4498962461948395, gen p mean: -0.5601862668991089, mean p set: 0.4503765404224396
loss_pred:0.03263671696186066, decouple_loss:0.025838643312454224
loss_pred:0.03268519416451454, decouple_loss:0.0251963809132576
The modified gen p mean: 0.452597975730896, gen p mean: -0.5547584295272827, mean p set: 0.4530782699584961
loss_pred:0.03372187167406082, decouple_loss:0.026028627529740334
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495282769203186, gen p mean: -0.5510766506195068, mean p set: 0.4500085711479187
loss_pred:0.03296755999326706, decouple_loss:0.02451600506901741
The modified gen p mean: 0.44946157932281494, gen p mean: -0.5608546137809753, mean p set: 0.44994187355041504The modified gen p mean: 0.4497954547405243, gen p mean: -0.5580050945281982, mean p set: 0.450275719165802
loss_pred:0.030239185318350792, decouple_loss:0.025752771645784378
loss_pred:0.03180262818932533, decouple_loss:0.02400575578212738
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922783970832825, gen p mean: -0.5628722310066223, mean p set: 0.44970813393592834
The modified gen p mean: 0.44972312450408936, gen p mean: -0.5605006217956543, mean p set: 0.45020341873168945
loss_pred:0.03224873170256615, decouple_loss:0.02451348304748535
loss_pred:0.033221375197172165, decouple_loss:0.026330407708883286
The modified gen p mean: 0.44964835047721863, gen p mean: -0.5629430413246155, mean p set: 0.4501286447048187
loss_pred:0.031129349023103714, decouple_loss:0.026010029017925262
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902923703193665, gen p mean: -0.5467997193336487, mean p set: 0.44950950145721436
The modified gen p mean: 0.45032092928886414, gen p mean: -0.5566117763519287, mean p set: 0.45080122351646423
loss_pred:0.03311009332537651, decouple_loss:0.02572748437523842
loss_pred:0.0328148789703846, decouple_loss:0.02433311752974987
The modified gen p mean: 0.4511414170265198, gen p mean: -0.5595179200172424, mean p set: 0.4516216814517975
loss_pred:0.03329838067293167, decouple_loss:0.0245363786816597
2023-05-01 19:04:15 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5725044012069702, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5650297403335571, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5612469911575317, mean p set: 0.45035696029663086
loss_pred:0.034642934799194336, decouple_loss:0.028224002569913864
loss_pred:0.033622659742832184, decouple_loss:0.027206597849726677
loss_pred:0.032803311944007874, decouple_loss:0.027950061485171318
WV_0_PC_1_EH_0_PS_40_5, loss: 0.035079315304756165, avg_mse: 0.0381762869656086
current test mse: 0.038176
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44913119077682495, gen p mean: -0.564714789390564, mean p set: 0.44961148500442505
loss_pred:0.031500350683927536, decouple_loss:0.02412818744778633
The modified gen p mean: 0.44988110661506653, gen p mean: -0.5699740648269653, mean p set: 0.4503614008426666The modified gen p mean: 0.45019733905792236, gen p mean: -0.5643616318702698, mean p set: 0.45067763328552246
loss_pred:0.03263808414340019, decouple_loss:0.02443995326757431
loss_pred:0.03217929229140282, decouple_loss:0.02426917292177677
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45158401131629944, gen p mean: -0.5695018768310547, mean p set: 0.45206427574157715
loss_pred:0.033077869564294815, decouple_loss:0.02537580393254757
The modified gen p mean: 0.4495278596878052, gen p mean: -0.5683279633522034, mean p set: 0.4500081539154053The modified gen p mean: 0.4496802091598511, gen p mean: -0.5738573670387268, mean p set: 0.4501604735851288
loss_pred:0.030669303610920906, decouple_loss:0.024707883596420288
loss_pred:0.032335273921489716, decouple_loss:0.025483213365077972
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948169589042664, gen p mean: -0.5547896027565002, mean p set: 0.44996196031570435
The modified gen p mean: 0.4500953257083893, gen p mean: -0.5580599904060364, mean p set: 0.4505756199359894
loss_pred:0.03327357769012451, decouple_loss:0.024628330022096634
loss_pred:0.03452973812818527, decouple_loss:0.02537618950009346
The modified gen p mean: 0.44990983605384827, gen p mean: -0.5621867179870605, mean p set: 0.45039013028144836
loss_pred:0.03298209235072136, decouple_loss:0.024069972336292267
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493807554244995, gen p mean: -0.5603283643722534, mean p set: 0.4498610198497772
loss_pred:0.033005040138959885, decouple_loss:0.024493789300322533
The modified gen p mean: 0.4514003098011017, gen p mean: -0.5574913620948792, mean p set: 0.4518806040287018The modified gen p mean: 0.45152056217193604, gen p mean: -0.5613406896591187, mean p set: 0.45200085639953613
loss_pred:0.03203819319605827, decouple_loss:0.023968366906046867
loss_pred:0.03267467021942139, decouple_loss:0.025340881198644638
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909989833831787, gen p mean: -0.56742262840271, mean p set: 0.44958019256591797
The modified gen p mean: 0.44943132996559143, gen p mean: -0.5574939846992493, mean p set: 0.44991159439086914
loss_pred:0.030815189704298973, decouple_loss:0.02497723326086998
loss_pred:0.030559660866856575, decouple_loss:0.023396480828523636
The modified gen p mean: 0.44934189319610596, gen p mean: -0.5505528450012207, mean p set: 0.44982221722602844
loss_pred:0.03330126032233238, decouple_loss:0.02393934689462185
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972214102745056, gen p mean: -0.5637214779853821, mean p set: 0.45020246505737305
loss_pred:0.03303132206201553, decouple_loss:0.022566424682736397
The modified gen p mean: 0.4511229395866394, gen p mean: -0.5617247223854065, mean p set: 0.4516032636165619
The modified gen p mean: 0.45003464818000793, gen p mean: -0.5682297945022583, mean p set: 0.45051491260528564
loss_pred:0.03166676685214043, decouple_loss:0.023484006524086
loss_pred:0.03152942657470703, decouple_loss:0.023515610024333
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
NaN value num: 0
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497902989387512, gen p mean: -0.5657949447631836, mean p set: 0.4502705931663513
loss_pred:0.03223440796136856, decouple_loss:0.024157704785466194
The modified gen p mean: 0.45139604806900024, gen p mean: -0.570364236831665, mean p set: 0.45187634229660034The modified gen p mean: 0.45062196254730225, gen p mean: -0.5641649961471558, mean p set: 0.45110225677490234
loss_pred:0.03192954510450363, decouple_loss:0.0246917475014925
loss_pred:0.032485444098711014, decouple_loss:0.02468886971473694
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503708779811859, gen p mean: -0.5627976655960083, mean p set: 0.4508511424064636
The modified gen p mean: 0.45292118191719055, gen p mean: -0.5668442845344543, mean p set: 0.45340150594711304
loss_pred:0.03266359865665436, decouple_loss:0.02403022162616253
loss_pred:0.032972972840070724, decouple_loss:0.025892652571201324The modified gen p mean: 0.4504399001598358, gen p mean: -0.5673049688339233, mean p set: 0.4509201943874359
loss_pred:0.03312630578875542, decouple_loss:0.024546707049012184
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507702589035034, gen p mean: -0.5565806031227112, mean p set: 0.4512505531311035
The modified gen p mean: 0.4517693817615509, gen p mean: -0.5591866374015808, mean p set: 0.4522497057914734
loss_pred:0.034545354545116425, decouple_loss:0.025351349264383316
loss_pred:0.03364398330450058, decouple_loss:0.02445097453892231
The modified gen p mean: 0.450194776058197, gen p mean: -0.5583447217941284, mean p set: 0.45067504048347473
loss_pred:0.03227033093571663, decouple_loss:0.023022426292300224
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525906443595886, gen p mean: -0.5640988945960999, mean p set: 0.4530709385871887The modified gen p mean: 0.45024290680885315, gen p mean: -0.557883620262146, mean p set: 0.45072323083877563
loss_pred:0.03326065465807915, decouple_loss:0.02529270388185978
loss_pred:0.03187647834420204, decouple_loss:0.024543190374970436
The modified gen p mean: 0.44935160875320435, gen p mean: -0.5584874749183655, mean p set: 0.44983193278312683
loss_pred:0.03411002829670906, decouple_loss:0.02432335540652275
2023-05-01 19:06:57 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5606437921524048, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.550290048122406, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5541291832923889, mean p set: 0.4500633478164673
loss_pred:0.03449849411845207, decouple_loss:0.02723075821995735
loss_pred:0.03278663381934166, decouple_loss:0.02739759348332882
loss_pred:0.033480964601039886, decouple_loss:0.026257850229740143
WV_0_PC_1_EH_0_PS_40_5, loss: 0.034936800599098206, avg_mse: 0.03815310075879097
current test mse: 0.038153
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492180347442627, gen p mean: -0.5584722757339478, mean p set: 0.4496982991695404
The modified gen p mean: 0.450580358505249, gen p mean: -0.5549201369285583, mean p set: 0.4510606527328491
loss_pred:0.03232156112790108, decouple_loss:0.023928673937916756
The modified gen p mean: 0.4500598609447479, gen p mean: -0.5552345514297485, mean p set: 0.45054012537002563
loss_pred:0.032016221433877945, decouple_loss:0.024832671508193016
loss_pred:0.0332498662173748, decouple_loss:0.023447006940841675
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45261844992637634, gen p mean: -0.5602285265922546, mean p set: 0.45309871435165405
The modified gen p mean: 0.4499615430831909, gen p mean: -0.5599336624145508, mean p set: 0.450441837310791
loss_pred:0.0331418551504612, decouple_loss:0.024261707440018654
loss_pred:0.032979682087898254, decouple_loss:0.0236185472458601
The modified gen p mean: 0.45142999291419983, gen p mean: -0.5590636730194092, mean p set: 0.45191025733947754
loss_pred:0.03181789815425873, decouple_loss:0.023165393620729446
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920673966407776, gen p mean: -0.5681777000427246, mean p set: 0.44968703389167786
The modified gen p mean: 0.4518848955631256, gen p mean: -0.5632560849189758, mean p set: 0.4523652195930481
loss_pred:0.0327427014708519, decouple_loss:0.02380286529660225
loss_pred:0.03416532650589943, decouple_loss:0.02514013834297657
The modified gen p mean: 0.44915419816970825, gen p mean: -0.5662839412689209, mean p set: 0.44963446259498596
loss_pred:0.03232476860284805, decouple_loss:0.023607077077031136
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513232707977295, gen p mean: -0.5730279088020325, mean p set: 0.4518035352230072
The modified gen p mean: 0.4494049847126007, gen p mean: -0.5633909702301025, mean p set: 0.4498852789402008
loss_pred:0.03347945958375931, decouple_loss:0.024090783670544624
loss_pred:0.03389154002070427, decouple_loss:0.02336766943335533
The modified gen p mean: 0.4519236981868744, gen p mean: -0.5715760588645935, mean p set: 0.4524039626121521
loss_pred:0.032173704355955124, decouple_loss:0.022962167859077454
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499700665473938, gen p mean: -0.562915027141571, mean p set: 0.4504503011703491
The modified gen p mean: 0.45299434661865234, gen p mean: -0.5665625929832458, mean p set: 0.45347464084625244
loss_pred:0.033599719405174255, decouple_loss:0.023426035419106483
loss_pred:0.03268658369779587, decouple_loss:0.02459111250936985
The modified gen p mean: 0.4494568407535553, gen p mean: -0.5577835440635681, mean p set: 0.449937105178833
loss_pred:0.031787656247615814, decouple_loss:0.024350157007575035
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520683288574219, gen p mean: -0.5746744275093079, mean p set: 0.4525485932826996
The modified gen p mean: 0.45049917697906494, gen p mean: -0.57181715965271, mean p set: 0.45097947120666504
loss_pred:0.03284820169210434, decouple_loss:0.02330378256738186
loss_pred:0.03238190710544586, decouple_loss:0.022866180166602135
The modified gen p mean: 0.4500267803668976, gen p mean: -0.5685425400733948, mean p set: 0.4505070447921753
loss_pred:0.033970508724451065, decouple_loss:0.023854952305555344
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041683316230774, gen p mean: -0.5828649997711182, mean p set: 0.4508971571922302
The modified gen p mean: 0.45020055770874023, gen p mean: -0.5816907286643982, mean p set: 0.45068085193634033
loss_pred:0.03195071965456009, decouple_loss:0.023838236927986145
loss_pred:0.031202329322695732, decouple_loss:0.024400388821959496
The modified gen p mean: 0.4500761032104492, gen p mean: -0.5854740142822266, mean p set: 0.4505563974380493
loss_pred:0.03423740342259407, decouple_loss:0.023204144090414047
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138290524482727, gen p mean: -0.5821283459663391, mean p set: 0.45186319947242737
The modified gen p mean: 0.4502231180667877, gen p mean: -0.5820360779762268, mean p set: 0.4507034122943878
loss_pred:0.03309793025255203, decouple_loss:0.023672882467508316
loss_pred:0.032185256481170654, decouple_loss:0.02253943681716919
The modified gen p mean: 0.45007872581481934, gen p mean: -0.5866216421127319, mean p set: 0.45055902004241943
loss_pred:0.03349956497550011, decouple_loss:0.022768940776586533
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068982243537903, gen p mean: -0.5727468132972717, mean p set: 0.4511701166629791
The modified gen p mean: 0.4500027298927307, gen p mean: -0.5710654258728027, mean p set: 0.4504829943180084
loss_pred:0.031899772584438324, decouple_loss:0.022124217823147774
loss_pred:0.03108982741832733, decouple_loss:0.02243145741522312
The modified gen p mean: 0.4496538043022156, gen p mean: -0.5804309248924255, mean p set: 0.4501340985298157
loss_pred:0.03283162787556648, decouple_loss:0.023302430287003517
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108312368392944, gen p mean: -0.5714710354804993, mean p set: 0.45156341791152954
The modified gen p mean: 0.45214036107063293, gen p mean: -0.5774194002151489, mean p set: 0.45262065529823303
loss_pred:0.032514072954654694, decouple_loss:0.023435110226273537
loss_pred:0.03218919783830643, decouple_loss:0.024363404139876366
The modified gen p mean: 0.450313001871109, gen p mean: -0.5645756125450134, mean p set: 0.4507932960987091
loss_pred:0.031592559069395065, decouple_loss:0.022149113938212395
2023-05-01 19:09:06 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.566460907459259, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5559270977973938, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5597708821296692, mean p set: 0.4500633478164673
loss_pred:0.03430663049221039, decouple_loss:0.027081958949565887
loss_pred:0.03259158879518509, decouple_loss:0.02706039883196354
loss_pred:0.03327682614326477, decouple_loss:0.02599618211388588
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03472732752561569, avg_mse: 0.03796863555908203
current test mse: 0.037969
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449516624212265, gen p mean: -0.5533885359764099, mean p set: 0.44999685883522034
loss_pred:0.031876109540462494, decouple_loss:0.023025760427117348
The modified gen p mean: 0.4526252746582031, gen p mean: -0.5634472966194153, mean p set: 0.4531055688858032The modified gen p mean: 0.4514337480068207, gen p mean: -0.5620598196983337, mean p set: 0.4519140422344208
loss_pred:0.03285955265164375, decouple_loss:0.02347405068576336
loss_pred:0.03326857462525368, decouple_loss:0.023621946573257446
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501752555370331, gen p mean: -0.5691998600959778, mean p set: 0.4506555497646332
loss_pred:0.03271840885281563, decouple_loss:0.024075312539935112
The modified gen p mean: 0.45270371437072754, gen p mean: -0.5685392022132874, mean p set: 0.45318400859832764The modified gen p mean: 0.45077091455459595, gen p mean: -0.5639181733131409, mean p set: 0.45125120878219604
loss_pred:0.03243632987141609, decouple_loss:0.024215154349803925
loss_pred:0.03279295936226845, decouple_loss:0.023199953138828278
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960248470306396, gen p mean: -0.570260763168335, mean p set: 0.45008277893066406
The modified gen p mean: 0.45090562105178833, gen p mean: -0.5743144154548645, mean p set: 0.4513859152793884
loss_pred:0.03303015977144241, decouple_loss:0.02316123992204666
loss_pred:0.03338522091507912, decouple_loss:0.022113803774118423
The modified gen p mean: 0.45159539580345154, gen p mean: -0.57033771276474, mean p set: 0.45207569003105164
loss_pred:0.03219356760382652, decouple_loss:0.022737059742212296
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532533288002014, gen p mean: -0.5800142884254456, mean p set: 0.4537335932254791
loss_pred:0.03263416141271591, decouple_loss:0.023532332852482796
The modified gen p mean: 0.4504378139972687, gen p mean: -0.5784790515899658, mean p set: 0.4509181082248688The modified gen p mean: 0.45054343342781067, gen p mean: -0.5699450373649597, mean p set: 0.4510236978530884
loss_pred:0.03240548446774483, decouple_loss:0.021627375856041908
loss_pred:0.03223248943686485, decouple_loss:0.022269271314144135
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263898372650146, gen p mean: -0.5688364505767822, mean p set: 0.45311927795410156
loss_pred:0.03255327790975571, decouple_loss:0.02261205203831196
The modified gen p mean: 0.453255295753479, gen p mean: -0.5702844262123108, mean p set: 0.4537356197834015The modified gen p mean: 0.4504302740097046, gen p mean: -0.5718414187431335, mean p set: 0.4509105384349823
loss_pred:0.03229376673698425, decouple_loss:0.022370515391230583
loss_pred:0.03261968120932579, decouple_loss:0.023082418367266655
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
NaN value num: 0
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44749295711517334, gen p mean: -0.57500821352005, mean p set: 0.44797322154045105
loss_pred:0.03507033735513687, decouple_loss:0.026269786059856415
The modified gen p mean: 0.4477537274360657, gen p mean: -0.5674598813056946, mean p set: 0.4482339918613434The modified gen p mean: 0.44786718487739563, gen p mean: -0.5673115253448486, mean p set: 0.44834744930267334
loss_pred:0.034556254744529724, decouple_loss:0.02733430080115795
loss_pred:0.033449605107307434, decouple_loss:0.02526106685400009
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475327730178833, gen p mean: -0.5925057530403137, mean p set: 0.4480130672454834
loss_pred:0.03416115418076515, decouple_loss:0.026477498933672905
The modified gen p mean: 0.44786781072616577, gen p mean: -0.5940951108932495, mean p set: 0.44834810495376587The modified gen p mean: 0.4470180869102478, gen p mean: -0.5824589133262634, mean p set: 0.4474983811378479
loss_pred:0.03364650905132294, decouple_loss:0.027233265340328217
loss_pred:0.03418181091547012, decouple_loss:0.026100173592567444
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687744975090027, gen p mean: -0.5747846364974976, mean p set: 0.44735774397850037
loss_pred:0.0334613211452961, decouple_loss:0.02609449252486229
The modified gen p mean: 0.44846656918525696, gen p mean: -0.5745038390159607, mean p set: 0.44894686341285706The modified gen p mean: 0.44700634479522705, gen p mean: -0.5788803696632385, mean p set: 0.44748660922050476
loss_pred:0.03343989700078964, decouple_loss:0.023964211344718933
loss_pred:0.03277142718434334, decouple_loss:0.026507703587412834
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464336335659027, gen p mean: -0.5771414637565613, mean p set: 0.4469138979911804
loss_pred:0.03684255853295326, decouple_loss:0.023905551061034203
The modified gen p mean: 0.44816645979881287, gen p mean: -0.576654314994812, mean p set: 0.4486467242240906The modified gen p mean: 0.4475497603416443, gen p mean: -0.5794402956962585, mean p set: 0.4480300843715668
loss_pred:0.034098297357559204, decouple_loss:0.02453661896288395
loss_pred:0.032605480402708054, decouple_loss:0.02450644224882126
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696488976478577, gen p mean: -0.5858643651008606, mean p set: 0.44744521379470825
loss_pred:0.033835701644420624, decouple_loss:0.02427135594189167
The modified gen p mean: 0.4480271637439728, gen p mean: -0.5776510834693909, mean p set: 0.4485074579715729The modified gen p mean: 0.44753509759902954, gen p mean: -0.590314507484436, mean p set: 0.448015421628952
loss_pred:0.03224710375070572, decouple_loss:0.023705724626779556
loss_pred:0.03380101919174194, decouple_loss:0.02440922148525715
2023-05-01 19:11:51 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5861273407936096, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5759910345077515, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5800464749336243, mean p set: 0.4500633478164673
loss_pred:0.03426866605877876, decouple_loss:0.02582891657948494
loss_pred:0.032651133835315704, decouple_loss:0.02601422742009163
loss_pred:0.03336148336529732, decouple_loss:0.02504386380314827
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03470854461193085, avg_mse: 0.03787745162844658
current test mse: 0.037877
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710034132003784, gen p mean: -0.582797110080719, mean p set: 0.4475806653499603
loss_pred:0.03363879397511482, decouple_loss:0.024304745718836784
The modified gen p mean: 0.4478825628757477, gen p mean: -0.5851746797561646, mean p set: 0.4483628571033478The modified gen p mean: 0.4468432068824768, gen p mean: -0.5882046222686768, mean p set: 0.4473235011100769
loss_pred:0.036355070769786835, decouple_loss:0.023501204326748848
loss_pred:0.03566092625260353, decouple_loss:0.02369934506714344
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471080005168915, gen p mean: -0.5846625566482544, mean p set: 0.44758832454681396
loss_pred:0.036099206656217575, decouple_loss:0.023802826181054115
The modified gen p mean: 0.4455285668373108, gen p mean: -0.5796540975570679, mean p set: 0.4460088610649109The modified gen p mean: 0.44760170578956604, gen p mean: -0.5892996191978455, mean p set: 0.4480820298194885
loss_pred:0.03401321545243263, decouple_loss:0.025710688903927803
loss_pred:0.03401690348982811, decouple_loss:0.025638023391366005
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461074769496918, gen p mean: -0.5803996324539185, mean p set: 0.4465877413749695
loss_pred:0.03331511840224266, decouple_loss:0.026100166141986847
The modified gen p mean: 0.447560578584671, gen p mean: -0.5857840180397034, mean p set: 0.4480408728122711The modified gen p mean: 0.44747117161750793, gen p mean: -0.5825839042663574, mean p set: 0.44795146584510803
loss_pred:0.034564852714538574, decouple_loss:0.025409871712327003
loss_pred:0.03363851085305214, decouple_loss:0.02545025758445263
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839930534362793, gen p mean: -0.5767622590065002, mean p set: 0.448879599571228
The modified gen p mean: 0.4474649131298065, gen p mean: -0.5865527987480164, mean p set: 0.4479452073574066
loss_pred:0.03261316940188408, decouple_loss:0.02491033263504505
loss_pred:0.032265253365039825, decouple_loss:0.025347331538796425
The modified gen p mean: 0.44763243198394775, gen p mean: -0.5752130150794983, mean p set: 0.44811269640922546
loss_pred:0.033815328031778336, decouple_loss:0.024688897654414177
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472469389438629, gen p mean: -0.57670658826828, mean p set: 0.4477272629737854
The modified gen p mean: 0.4475606679916382, gen p mean: -0.5695058107376099, mean p set: 0.44804099202156067
loss_pred:0.033294618129730225, decouple_loss:0.02426495961844921
loss_pred:0.03394024446606636, decouple_loss:0.025636430829763412
The modified gen p mean: 0.4481637179851532, gen p mean: -0.5712990760803223, mean p set: 0.4486440122127533
loss_pred:0.03396576642990112, decouple_loss:0.025752468034625053
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843438267707825, gen p mean: -0.5649940371513367, mean p set: 0.44891470670700073
loss_pred:0.03220091015100479, decouple_loss:0.02340768463909626
The modified gen p mean: 0.4476946294307709, gen p mean: -0.5745823979377747, mean p set: 0.44817492365837097The modified gen p mean: 0.4490186870098114, gen p mean: -0.5671883821487427, mean p set: 0.4494989514350891
loss_pred:0.03345976024866104, decouple_loss:0.024476338177919388
loss_pred:0.03162344545125961, decouple_loss:0.02481318823993206
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796356558799744, gen p mean: -0.5465245842933655, mean p set: 0.44844383001327515
loss_pred:0.03226860985159874, decouple_loss:0.02354332059621811
The modified gen p mean: 0.4468827247619629, gen p mean: -0.5499343872070312, mean p set: 0.4473629891872406The modified gen p mean: 0.4488181471824646, gen p mean: -0.5490162968635559, mean p set: 0.4492984712123871
loss_pred:0.032416123896837234, decouple_loss:0.023050352931022644
loss_pred:0.03156234323978424, decouple_loss:0.023621177300810814
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835206866264343, gen p mean: -0.5522299408912659, mean p set: 0.44883236289024353
The modified gen p mean: 0.4477567672729492, gen p mean: -0.5578771233558655, mean p set: 0.44823703169822693
loss_pred:0.033420074731111526, decouple_loss:0.02400471642613411
loss_pred:0.03534402698278427, decouple_loss:0.024018684402108192
The modified gen p mean: 0.4482695758342743, gen p mean: -0.5568099021911621, mean p set: 0.4487498700618744
loss_pred:0.032165829092264175, decouple_loss:0.022882120683789253
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728732109069824, gen p mean: -0.5641556978225708, mean p set: 0.44776758551597595
loss_pred:0.03353232145309448, decouple_loss:0.023380465805530548
The modified gen p mean: 0.4484109878540039, gen p mean: -0.5637624263763428, mean p set: 0.4488913118839264The modified gen p mean: 0.44791361689567566, gen p mean: -0.5707197785377502, mean p set: 0.44839391112327576
loss_pred:0.03291429206728935, decouple_loss:0.022619526833295822
loss_pred:0.03187389671802521, decouple_loss:0.02387586422264576
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475783109664917, gen p mean: -0.5740774869918823, mean p set: 0.4480586349964142
The modified gen p mean: 0.44699928164482117, gen p mean: -0.5705274939537048, mean p set: 0.44747960567474365
loss_pred:0.033495064824819565, decouple_loss:0.02362261340022087
loss_pred:0.031994860619306564, decouple_loss:0.022578252479434013
The modified gen p mean: 0.4475826621055603, gen p mean: -0.5716806054115295, mean p set: 0.4480629861354828
loss_pred:0.03338024765253067, decouple_loss:0.022970518097281456
2023-05-01 19:13:59 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.571245014667511, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5614296197891235, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5651895999908447, mean p set: 0.4500633478164673
loss_pred:0.033951930701732635, decouple_loss:0.024543652310967445
loss_pred:0.03242361918091774, decouple_loss:0.02482668124139309
loss_pred:0.0330289825797081, decouple_loss:0.024061864241957664
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03435871750116348, avg_mse: 0.037575796246528625
current test mse: 0.037576
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478951394557953, gen p mean: -0.5641621351242065, mean p set: 0.4483754336833954
loss_pred:0.033857401460409164, decouple_loss:0.022943736985325813
The modified gen p mean: 0.44651171565055847, gen p mean: -0.569269061088562, mean p set: 0.4469919800758362The modified gen p mean: 0.4484841525554657, gen p mean: -0.5722385048866272, mean p set: 0.4489644169807434
loss_pred:0.03222200274467468, decouple_loss:0.021606845781207085
loss_pred:0.035370517522096634, decouple_loss:0.022490564733743668
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479266107082367, gen p mean: -0.565893828868866, mean p set: 0.4484068751335144
loss_pred:0.032843463122844696, decouple_loss:0.022095736116170883
The modified gen p mean: 0.44960349798202515, gen p mean: -0.5712419152259827, mean p set: 0.45008379220962524The modified gen p mean: 0.44752395153045654, gen p mean: -0.573974072933197, mean p set: 0.44800424575805664
loss_pred:0.03164596110582352, decouple_loss:0.022306902334094048
loss_pred:0.03175917640328407, decouple_loss:0.02227345108985901
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469090700149536, gen p mean: -0.5690234303474426, mean p set: 0.4473893940448761
loss_pred:0.03323319926857948, decouple_loss:0.022213879972696304
The modified gen p mean: 0.4458010792732239, gen p mean: -0.5666046738624573, mean p set: 0.44628140330314636The modified gen p mean: 0.44798776507377625, gen p mean: -0.567875325679779, mean p set: 0.44846805930137634
loss_pred:0.03352221101522446, decouple_loss:0.02352929301559925
loss_pred:0.03337480127811432, decouple_loss:0.022128518670797348
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449051171541214, gen p mean: -0.5614007115364075, mean p set: 0.4495314955711365
The modified gen p mean: 0.44762560725212097, gen p mean: -0.5595325231552124, mean p set: 0.4481058716773987
loss_pred:0.03312796354293823, decouple_loss:0.021857060492038727
loss_pred:0.03219068422913551, decouple_loss:0.02216200903058052
The modified gen p mean: 0.44840705394744873, gen p mean: -0.559639573097229, mean p set: 0.4488873779773712
loss_pred:0.032921165227890015, decouple_loss:0.02181549370288849
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828546047210693, gen p mean: -0.5628771781921387, mean p set: 0.44876575469970703
The modified gen p mean: 0.4478885233402252, gen p mean: -0.5584854483604431, mean p set: 0.44836878776550293
loss_pred:0.032546184957027435, decouple_loss:0.02311040088534355
loss_pred:0.032142285257577896, decouple_loss:0.022262917831540108
The modified gen p mean: 0.44946858286857605, gen p mean: -0.564481794834137, mean p set: 0.44994887709617615
loss_pred:0.03255017474293709, decouple_loss:0.022297922521829605
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
NaN value num: 0
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520135819911957, gen p mean: -0.554950475692749, mean p set: 0.4524938464164734
loss_pred:0.0333043709397316, decouple_loss:0.028488755226135254
The modified gen p mean: 0.4520209729671478, gen p mean: -0.5632358193397522, mean p set: 0.45250123739242554The modified gen p mean: 0.45024070143699646, gen p mean: -0.5531076788902283, mean p set: 0.45072096586227417
loss_pred:0.03436068072915077, decouple_loss:0.026063324883580208
loss_pred:0.03257150948047638, decouple_loss:0.02628559246659279
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45066696405410767, gen p mean: -0.5551742911338806, mean p set: 0.45114725828170776
loss_pred:0.033082541078329086, decouple_loss:0.02767295390367508
The modified gen p mean: 0.4506235420703888, gen p mean: -0.557694673538208, mean p set: 0.4511038064956665The modified gen p mean: 0.4534585177898407, gen p mean: -0.567635715007782, mean p set: 0.4539388418197632
loss_pred:0.032522473484277725, decouple_loss:0.02763567864894867
loss_pred:0.03249841555953026, decouple_loss:0.02753852866590023
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516531229019165, gen p mean: -0.5502844452857971, mean p set: 0.4521334171295166
loss_pred:0.03288140520453453, decouple_loss:0.02634773962199688
The modified gen p mean: 0.4505973160266876, gen p mean: -0.5521243214607239, mean p set: 0.45107758045196533The modified gen p mean: 0.45126327872276306, gen p mean: -0.5602961778640747, mean p set: 0.45174357295036316
loss_pred:0.03224877640604973, decouple_loss:0.02638172172009945
loss_pred:0.03352286294102669, decouple_loss:0.025974243879318237
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494536221027374, gen p mean: -0.5473681092262268, mean p set: 0.4499339163303375
loss_pred:0.03372161462903023, decouple_loss:0.025198467075824738
The modified gen p mean: 0.4505334794521332, gen p mean: -0.5482085943222046, mean p set: 0.45101380348205566
The modified gen p mean: 0.4522361159324646, gen p mean: -0.562777042388916, mean p set: 0.4527163803577423
loss_pred:0.03317480906844139, decouple_loss:0.026121363043785095
loss_pred:0.03237350657582283, decouple_loss:0.0267720315605402
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517292380332947, gen p mean: -0.5705510973930359, mean p set: 0.4522095024585724
loss_pred:0.03292718157172203, decouple_loss:0.025662146508693695
The modified gen p mean: 0.4518354833126068, gen p mean: -0.5623371601104736, mean p set: 0.4523157775402069
The modified gen p mean: 0.45292171835899353, gen p mean: -0.5699998140335083, mean p set: 0.45340198278427124
loss_pred:0.03281978890299797, decouple_loss:0.025241343304514885
loss_pred:0.030704829841852188, decouple_loss:0.026179280132055283
2023-05-01 19:16:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.574680507183075, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5644625425338745, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5686255097389221, mean p set: 0.4500633478164673
loss_pred:0.034211158752441406, decouple_loss:0.0284897293895483
loss_pred:0.0324043333530426, decouple_loss:0.02750556915998459
loss_pred:0.03319275751709938, decouple_loss:0.02714308351278305
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03465505689382553, avg_mse: 0.037969689816236496
current test mse: 0.03797
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523312449455261, gen p mean: -0.56593918800354, mean p set: 0.4528115391731262
The modified gen p mean: 0.4521905779838562, gen p mean: -0.5584752559661865, mean p set: 0.4526708722114563
loss_pred:0.03346864879131317, decouple_loss:0.025169426575303078
The modified gen p mean: 0.4517481029033661, gen p mean: -0.569184422492981, mean p set: 0.4522283971309662
loss_pred:0.03231422230601311, decouple_loss:0.024663617834448814
loss_pred:0.03138064593076706, decouple_loss:0.02539193443953991
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500223398208618, gen p mean: -0.5580030083656311, mean p set: 0.4505026042461395
loss_pred:0.03305312246084213, decouple_loss:0.02543158270418644
The modified gen p mean: 0.45201683044433594, gen p mean: -0.5605419874191284, mean p set: 0.45249712467193604The modified gen p mean: 0.45081716775894165, gen p mean: -0.559674084186554, mean p set: 0.45129746198654175
loss_pred:0.033197738230228424, decouple_loss:0.025046702474355698
loss_pred:0.033894166350364685, decouple_loss:0.024556420743465424
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033159852027893, gen p mean: -0.5658578872680664, mean p set: 0.45081186294555664
loss_pred:0.03288249671459198, decouple_loss:0.025824712589383125
The modified gen p mean: 0.45040634274482727, gen p mean: -0.5632758140563965, mean p set: 0.450886607170105The modified gen p mean: 0.4515725374221802, gen p mean: -0.5727720856666565, mean p set: 0.4520528018474579
loss_pred:0.0339466817677021, decouple_loss:0.025673439726233482
loss_pred:0.03218616917729378, decouple_loss:0.024912724271416664
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508422911167145, gen p mean: -0.5665262937545776, mean p set: 0.4513225853443146
loss_pred:0.03184133395552635, decouple_loss:0.0245022252202034
The modified gen p mean: 0.45328283309936523, gen p mean: -0.5764806866645813, mean p set: 0.45376312732696533The modified gen p mean: 0.45291367173194885, gen p mean: -0.5777977108955383, mean p set: 0.45339396595954895
loss_pred:0.03173108771443367, decouple_loss:0.025159794837236404
loss_pred:0.03167504444718361, decouple_loss:0.025340266525745392
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503253102302551, gen p mean: -0.5616742372512817, mean p set: 0.4508056044578552
The modified gen p mean: 0.4527319073677063, gen p mean: -0.5686581134796143, mean p set: 0.453212171792984
loss_pred:0.03322484344244003, decouple_loss:0.02264525555074215
loss_pred:0.03234431520104408, decouple_loss:0.02466030791401863
The modified gen p mean: 0.45361804962158203, gen p mean: -0.5714802145957947, mean p set: 0.45409834384918213
loss_pred:0.03155689314007759, decouple_loss:0.02425374649465084
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45178914070129395, gen p mean: -0.557415783405304, mean p set: 0.45226943492889404The modified gen p mean: 0.4524119794368744, gen p mean: -0.562931478023529, mean p set: 0.4528922438621521
loss_pred:0.03259116783738136, decouple_loss:0.02385598048567772loss_pred:0.03216748684644699, decouple_loss:0.024107947945594788
The modified gen p mean: 0.4521346390247345, gen p mean: -0.5581102967262268, mean p set: 0.452614963054657
loss_pred:0.03289131447672844, decouple_loss:0.023605074733495712
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513704478740692, gen p mean: -0.5713011622428894, mean p set: 0.4518507122993469
The modified gen p mean: 0.45171672105789185, gen p mean: -0.5794818997383118, mean p set: 0.45219701528549194
loss_pred:0.032833121716976166, decouple_loss:0.02285543456673622
The modified gen p mean: 0.45199596881866455, gen p mean: -0.5752145648002625, mean p set: 0.45247623324394226loss_pred:0.030998749658465385, decouple_loss:0.02436291240155697
loss_pred:0.03258724510669708, decouple_loss:0.02360421046614647
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940945506095886, gen p mean: -0.5748979449272156, mean p set: 0.44988977909088135
The modified gen p mean: 0.45054686069488525, gen p mean: -0.5761245489120483, mean p set: 0.45102712512016296
loss_pred:0.033263325691223145, decouple_loss:0.0247055497020483
loss_pred:0.032329630106687546, decouple_loss:0.02501866966485977
The modified gen p mean: 0.4491191804409027, gen p mean: -0.5756480097770691, mean p set: 0.4495995044708252
loss_pred:0.03291928395628929, decouple_loss:0.025057628750801086
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45275965332984924, gen p mean: -0.5783054232597351, mean p set: 0.45323994755744934
loss_pred:0.0321868397295475, decouple_loss:0.023242967203259468
The modified gen p mean: 0.4503832757472992, gen p mean: -0.5739556550979614, mean p set: 0.4508635997772217The modified gen p mean: 0.45205560326576233, gen p mean: -0.5802245140075684, mean p set: 0.4525359272956848
loss_pred:0.032221607863903046, decouple_loss:0.024390334263443947
loss_pred:0.03160814568400383, decouple_loss:0.024099089205265045
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495322108268738, gen p mean: -0.5627294182777405, mean p set: 0.4500125050544739
The modified gen p mean: 0.4535072147846222, gen p mean: -0.5798978805541992, mean p set: 0.4539874494075775
loss_pred:0.032945677638053894, decouple_loss:0.022746549919247627
loss_pred:0.03063780628144741, decouple_loss:0.02390095591545105
The modified gen p mean: 0.4521675705909729, gen p mean: -0.5743768215179443, mean p set: 0.452647864818573
loss_pred:0.030963128432631493, decouple_loss:0.023513715714216232
2023-05-01 19:18:51 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5830133557319641, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5725727081298828, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5762028098106384, mean p set: 0.4500633478164673
loss_pred:0.034145817160606384, decouple_loss:0.026794403791427612
loss_pred:0.032265547662973404, decouple_loss:0.026146026328206062
loss_pred:0.03311888501048088, decouple_loss:0.02561449445784092
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03448600322008133, avg_mse: 0.03789394348859787
current test mse: 0.037894
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484759569168091, gen p mean: -0.5629067420959473, mean p set: 0.44895628094673157
The modified gen p mean: 0.45337003469467163, gen p mean: -0.5813083648681641, mean p set: 0.4538503587245941
loss_pred:0.03277074173092842, decouple_loss:0.022924372926354408
The modified gen p mean: 0.45062869787216187, gen p mean: -0.5750207901000977, mean p set: 0.45110899209976196
loss_pred:0.029572170227766037, decouple_loss:0.022174647077918053
loss_pred:0.032898254692554474, decouple_loss:0.022522887215018272
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529750347137451, gen p mean: -0.5846673846244812, mean p set: 0.4534553289413452
loss_pred:0.031448449939489365, decouple_loss:0.022270241752266884
The modified gen p mean: 0.44965651631355286, gen p mean: -0.5685558915138245, mean p set: 0.45013684034347534The modified gen p mean: 0.45201101899147034, gen p mean: -0.5796120762825012, mean p set: 0.4524913430213928
loss_pred:0.03289589285850525, decouple_loss:0.0224602110683918
loss_pred:0.0323895700275898, decouple_loss:0.02236536517739296
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500981867313385, gen p mean: -0.5692159533500671, mean p set: 0.4505784809589386
The modified gen p mean: 0.4502582848072052, gen p mean: -0.569191038608551, mean p set: 0.4507386088371277
loss_pred:0.03141928091645241, decouple_loss:0.02387932315468788
loss_pred:0.03232894092798233, decouple_loss:0.022815730422735214
The modified gen p mean: 0.4508916735649109, gen p mean: -0.5686876773834229, mean p set: 0.4513719379901886
loss_pred:0.03216461464762688, decouple_loss:0.02393103949725628
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45130977034568787, gen p mean: -0.561396062374115, mean p set: 0.4517900347709656
loss_pred:0.03197062760591507, decouple_loss:0.02300385758280754
The modified gen p mean: 0.45031100511550903, gen p mean: -0.5630772709846497, mean p set: 0.45079126954078674The modified gen p mean: 0.45068544149398804, gen p mean: -0.5661575198173523, mean p set: 0.45116573572158813
loss_pred:0.031796928495168686, decouple_loss:0.023169873282313347
loss_pred:0.03246893733739853, decouple_loss:0.022401921451091766
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515621066093445, gen p mean: -0.5690081119537354, mean p set: 0.4520423710346222
loss_pred:0.03140554949641228, decouple_loss:0.021736809983849525
The modified gen p mean: 0.4532754719257355, gen p mean: -0.5828456878662109, mean p set: 0.45375579595565796The modified gen p mean: 0.4506949186325073, gen p mean: -0.5697620511054993, mean p set: 0.45117518305778503
loss_pred:0.03090927004814148, decouple_loss:0.02193526178598404
loss_pred:0.031314123421907425, decouple_loss:0.023421883583068848
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652092456817627, gen p mean: -0.5781204700469971, mean p set: 0.44700121879577637
loss_pred:0.03248278424143791, decouple_loss:0.027325669303536415
The modified gen p mean: 0.44670698046684265, gen p mean: -0.5819188952445984, mean p set: 0.44718724489212036The modified gen p mean: 0.4469147324562073, gen p mean: -0.579644501209259, mean p set: 0.447394996881485
loss_pred:0.03236890211701393, decouple_loss:0.02664639800786972
loss_pred:0.03355218097567558, decouple_loss:0.02621549554169178
Iteration: 937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446443647146225, gen p mean: -0.5780486464500427, mean p set: 0.44692397117614746
loss_pred:0.032713718712329865, decouple_loss:0.025059374049305916
The modified gen p mean: 0.4461408257484436, gen p mean: -0.5766496062278748, mean p set: 0.4466211497783661The modified gen p mean: 0.44676217436790466, gen p mean: -0.5797548890113831, mean p set: 0.44724246859550476
loss_pred:0.03273658826947212, decouple_loss:0.025160806253552437
loss_pred:0.03269950672984123, decouple_loss:0.025295468047261238
Iteration: 938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717827439308167, gen p mean: -0.5851141810417175, mean p set: 0.4476585388183594
loss_pred:0.03244628384709358, decouple_loss:0.024009719491004944
The modified gen p mean: 0.44654273986816406, gen p mean: -0.5795982480049133, mean p set: 0.44702303409576416The modified gen p mean: 0.4469868242740631, gen p mean: -0.5853179097175598, mean p set: 0.4474670886993408
loss_pred:0.03237185999751091, decouple_loss:0.02384655922651291
loss_pred:0.031614940613508224, decouple_loss:0.024238478392362595
Iteration: 939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475893974304199, gen p mean: -0.5882531404495239, mean p set: 0.44806966185569763
loss_pred:0.03232115879654884, decouple_loss:0.023467063903808594
The modified gen p mean: 0.4476472735404968, gen p mean: -0.5860064029693604, mean p set: 0.4481275677680969The modified gen p mean: 0.4459840655326843, gen p mean: -0.5851698517799377, mean p set: 0.4464643895626068
loss_pred:0.033468782901763916, decouple_loss:0.02227364294230938
loss_pred:0.03278820216655731, decouple_loss:0.023089736700057983
Iteration: 940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465855360031128, gen p mean: -0.5904588103294373, mean p set: 0.4470658302307129
The modified gen p mean: 0.4460238814353943, gen p mean: -0.5891971588134766, mean p set: 0.446504145860672
loss_pred:0.0334499217569828, decouple_loss:0.021813279017806053
The modified gen p mean: 0.4478234350681305, gen p mean: -0.6024087071418762, mean p set: 0.4483036994934082loss_pred:0.032757796347141266, decouple_loss:0.023883458226919174
loss_pred:0.03168578818440437, decouple_loss:0.024418549612164497
2023-05-01 19:21:36 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5925266146659851, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5817139744758606, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5859556794166565, mean p set: 0.4500633478164673
loss_pred:0.033472612500190735, decouple_loss:0.025015387684106827
loss_pred:0.031932830810546875, decouple_loss:0.024769524112343788
loss_pred:0.032556626945734024, decouple_loss:0.02421577461063862
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03388737142086029, avg_mse: 0.03704925626516342
current test mse: 0.037049
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735148549079895, gen p mean: -0.5865520238876343, mean p set: 0.44783177971839905
loss_pred:0.0328817144036293, decouple_loss:0.02327471226453781
The modified gen p mean: 0.4471133053302765, gen p mean: -0.5875585675239563, mean p set: 0.447593629360199The modified gen p mean: 0.4471959173679352, gen p mean: -0.5862400531768799, mean p set: 0.4476762115955353
loss_pred:0.031212741509079933, decouple_loss:0.022122813388705254
loss_pred:0.03160184621810913, decouple_loss:0.02345851995050907
Iteration: 942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609978795051575, gen p mean: -0.5787113308906555, mean p set: 0.44658011198043823
loss_pred:0.03335217386484146, decouple_loss:0.02328629046678543
The modified gen p mean: 0.4470537006855011, gen p mean: -0.5838037133216858, mean p set: 0.4475339949131012The modified gen p mean: 0.44683948159217834, gen p mean: -0.583450973033905, mean p set: 0.44731974601745605
loss_pred:0.03204428032040596, decouple_loss:0.02347089722752571
loss_pred:0.03171659633517265, decouple_loss:0.023130245506763458
Iteration: 943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467619061470032, gen p mean: -0.5805477499961853, mean p set: 0.44724223017692566
The modified gen p mean: 0.4475112557411194, gen p mean: -0.5926070213317871, mean p set: 0.4479915201663971
loss_pred:0.03178771585226059, decouple_loss:0.02232673577964306
loss_pred:0.03202352672815323, decouple_loss:0.023462627083063126The modified gen p mean: 0.44603610038757324, gen p mean: -0.5788687467575073, mean p set: 0.44651639461517334
loss_pred:0.03277979791164398, decouple_loss:0.023272451013326645
Iteration: 944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733890891075134, gen p mean: -0.5837505459785461, mean p set: 0.44781920313835144
The modified gen p mean: 0.4468706548213959, gen p mean: -0.5761403441429138, mean p set: 0.44735097885131836loss_pred:0.03210194781422615, decouple_loss:0.02202461287379265
The modified gen p mean: 0.4461709260940552, gen p mean: -0.5729566216468811, mean p set: 0.4466512203216553
loss_pred:0.03195740282535553, decouple_loss:0.02139296755194664
loss_pred:0.03378307819366455, decouple_loss:0.022214194759726524
Iteration: 945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458526074886322, gen p mean: -0.5790178179740906, mean p set: 0.4463328719139099
The modified gen p mean: 0.4470162093639374, gen p mean: -0.5746683478355408, mean p set: 0.4474965035915375
loss_pred:0.03243061155080795, decouple_loss:0.02168990857899189
loss_pred:0.031521666795015335, decouple_loss:0.022279813885688782
The modified gen p mean: 0.4484224021434784, gen p mean: -0.587460458278656, mean p set: 0.4489026963710785
loss_pred:0.0317617766559124, decouple_loss:0.02291475608944893
Iteration: 946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470779299736023, gen p mean: -0.5779182314872742, mean p set: 0.4475582242012024
The modified gen p mean: 0.44798222184181213, gen p mean: -0.5881133079528809, mean p set: 0.44846251606941223loss_pred:0.030901910737156868, decouple_loss:0.022852085530757904
The modified gen p mean: 0.44686564803123474, gen p mean: -0.5863465070724487, mean p set: 0.4473459720611572
loss_pred:0.03129182383418083, decouple_loss:0.022119497880339622
loss_pred:0.031943537294864655, decouple_loss:0.023529473692178726
Iteration: 947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724732637405396, gen p mean: -0.5824562311172485, mean p set: 0.44772762060165405
The modified gen p mean: 0.4473232924938202, gen p mean: -0.5835893154144287, mean p set: 0.4478035867214203
loss_pred:0.030838094651699066, decouple_loss:0.021692326292395592
loss_pred:0.032223790884017944, decouple_loss:0.021717041730880737
The modified gen p mean: 0.44771742820739746, gen p mean: -0.5834904909133911, mean p set: 0.44819772243499756
loss_pred:0.03328528627753258, decouple_loss:0.021835792809724808
Iteration: 948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469561278820038, gen p mean: -0.588864803314209, mean p set: 0.4474363923072815
loss_pred:0.03203932195901871, decouple_loss:0.02159867063164711
The modified gen p mean: 0.44670340418815613, gen p mean: -0.5768768191337585, mean p set: 0.4471836984157562The modified gen p mean: 0.44719481468200684, gen p mean: -0.5785732269287109, mean p set: 0.44767507910728455
loss_pred:0.03229769691824913, decouple_loss:0.021281138062477112
loss_pred:0.030774647369980812, decouple_loss:0.021534865722060204
Iteration: 949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708243012428284, gen p mean: -0.5856946110725403, mean p set: 0.4475627839565277
The modified gen p mean: 0.44808992743492126, gen p mean: -0.5879822373390198, mean p set: 0.448570191860199
The modified gen p mean: 0.44785264134407043, gen p mean: -0.5880841612815857, mean p set: 0.44833290576934814
loss_pred:0.030278483405709267, decouple_loss:0.020590659230947495
loss_pred:0.03276779130101204, decouple_loss:0.02114424668252468
loss_pred:0.031875018030405045, decouple_loss:0.02093053236603737
Iteration: 950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882553815841675, gen p mean: -0.5937926173210144, mean p set: 0.44930580258369446
The modified gen p mean: 0.4471054971218109, gen p mean: -0.5858403444290161, mean p set: 0.447585791349411
loss_pred:0.031569402664899826, decouple_loss:0.021386807784438133
loss_pred:0.03167184069752693, decouple_loss:0.020693551748991013
The modified gen p mean: 0.4462994635105133, gen p mean: -0.5817952752113342, mean p set: 0.4467797577381134
loss_pred:0.03163366764783859, decouple_loss:0.0209902785718441
2023-05-01 19:23:46 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5908203125, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5798040628433228, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5841594934463501, mean p set: 0.4500633478164673
loss_pred:0.03329356759786606, decouple_loss:0.022901955991983414
loss_pred:0.03177763521671295, decouple_loss:0.02284500002861023
loss_pred:0.03234165161848068, decouple_loss:0.022538991644978523
WV_0_PC_1_EH_0_PS_40_5, loss: 0.0336090549826622, avg_mse: 0.03684571385383606
current test mse: 0.036846
Iteration: 951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468631148338318, gen p mean: -0.5805861353874207, mean p set: 0.4473433792591095
The modified gen p mean: 0.4473578929901123, gen p mean: -0.5896525382995605, mean p set: 0.4478381872177124
loss_pred:0.03166959062218666, decouple_loss:0.022025208920240402
The modified gen p mean: 0.4469716250896454, gen p mean: -0.5805769562721252, mean p set: 0.4474518895149231
loss_pred:0.032047610729932785, decouple_loss:0.02079957164824009
loss_pred:0.03221573680639267, decouple_loss:0.021823635324835777
Iteration: 952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478108584880829, gen p mean: -0.5839326977729797, mean p set: 0.44829118251800537
The modified gen p mean: 0.4472261667251587, gen p mean: -0.5784725546836853, mean p set: 0.4477064609527588
loss_pred:0.03230680897831917, decouple_loss:0.020094402134418488
loss_pred:0.031124670058488846, decouple_loss:0.020253246650099754
The modified gen p mean: 0.44690945744514465, gen p mean: -0.5827640295028687, mean p set: 0.44738972187042236
loss_pred:0.03236044943332672, decouple_loss:0.02116982825100422
Iteration: 953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625112414360046, gen p mean: -0.5781149864196777, mean p set: 0.44673141837120056
The modified gen p mean: 0.4468885660171509, gen p mean: -0.5796300172805786, mean p set: 0.447368860244751
loss_pred:0.032683223485946655, decouple_loss:0.02100902982056141
loss_pred:0.032241422683000565, decouple_loss:0.02022230252623558
The modified gen p mean: 0.44808536767959595, gen p mean: -0.5919162034988403, mean p set: 0.44856566190719604
loss_pred:0.031235888600349426, decouple_loss:0.022295618429780006
Iteration: 954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696149230003357, gen p mean: -0.5804407000541687, mean p set: 0.4474417567253113
The modified gen p mean: 0.4460639953613281, gen p mean: -0.5784693360328674, mean p set: 0.4465442895889282
loss_pred:0.031744979321956635, decouple_loss:0.02024737000465393
loss_pred:0.03200601041316986, decouple_loss:0.02076161466538906
The modified gen p mean: 0.4468006491661072, gen p mean: -0.5776546001434326, mean p set: 0.4472809433937073
loss_pred:0.03215241804718971, decouple_loss:0.019864706322550774
Iteration: 955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802191853523254, gen p mean: -0.5849185585975647, mean p set: 0.44850221276283264
The modified gen p mean: 0.4460422694683075, gen p mean: -0.5748186707496643, mean p set: 0.4465225338935852
loss_pred:0.03155038133263588, decouple_loss:0.020288223400712013
loss_pred:0.03171925246715546, decouple_loss:0.02070477046072483
The modified gen p mean: 0.44653892517089844, gen p mean: -0.5784829258918762, mean p set: 0.44701918959617615
loss_pred:0.03169199824333191, decouple_loss:0.021121514961123466
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
NaN value num: 0
Iteration: 956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507615566253662, gen p mean: -0.5710862874984741, mean p set: 0.4512418508529663
loss_pred:0.033294275403022766, decouple_loss:0.02508016861975193
The modified gen p mean: 0.4519759714603424, gen p mean: -0.5736197233200073, mean p set: 0.4524562954902649The modified gen p mean: 0.45210570096969604, gen p mean: -0.5762939453125, mean p set: 0.45258599519729614
loss_pred:0.03231414407491684, decouple_loss:0.025024181231856346
loss_pred:0.03502020239830017, decouple_loss:0.025450656190514565
Iteration: 957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944486021995544, gen p mean: -0.5821548700332642, mean p set: 0.44992515444755554
The modified gen p mean: 0.4497206211090088, gen p mean: -0.5908964276313782, mean p set: 0.4502009153366089
loss_pred:0.03416138142347336, decouple_loss:0.023477276787161827
loss_pred:0.03401520475745201, decouple_loss:0.024190537631511688
The modified gen p mean: 0.45004430413246155, gen p mean: -0.5872231125831604, mean p set: 0.45052459836006165
loss_pred:0.033246979117393494, decouple_loss:0.024088958278298378
Iteration: 958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983214139938354, gen p mean: -0.5897295475006104, mean p set: 0.45031243562698364
The modified gen p mean: 0.45038220286369324, gen p mean: -0.5917805433273315, mean p set: 0.45086249709129333
loss_pred:0.03285657614469528, decouple_loss:0.02301810495555401
loss_pred:0.03331392630934715, decouple_loss:0.02328779734671116
The modified gen p mean: 0.45073339343070984, gen p mean: -0.5889458656311035, mean p set: 0.4512137174606323
loss_pred:0.03467991203069687, decouple_loss:0.023205820471048355
Iteration: 959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965270161628723, gen p mean: -0.5887612700462341, mean p set: 0.45013299584388733
The modified gen p mean: 0.4512808918952942, gen p mean: -0.5857018828392029, mean p set: 0.4517611861228943
loss_pred:0.03373457118868828, decouple_loss:0.021906975656747818
loss_pred:0.033155638724565506, decouple_loss:0.02413884550333023
The modified gen p mean: 0.45010024309158325, gen p mean: -0.5935994386672974, mean p set: 0.45058050751686096
loss_pred:0.03437000885605812, decouple_loss:0.023767707869410515
Iteration: 960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514906108379364, gen p mean: -0.5861533880233765, mean p set: 0.4519709050655365
loss_pred:0.03308629244565964, decouple_loss:0.022460294887423515
The modified gen p mean: 0.4496115744113922, gen p mean: -0.5871983766555786, mean p set: 0.4500918984413147The modified gen p mean: 0.4511503577232361, gen p mean: -0.5817840695381165, mean p set: 0.45163068175315857
loss_pred:0.0331769734621048, decouple_loss:0.022809883579611778
loss_pred:0.032996952533721924, decouple_loss:0.024315224960446358
2023-05-01 19:26:30 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5907012820243835, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5802087783813477, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5841540098190308, mean p set: 0.4500633478164673
loss_pred:0.03325437381863594, decouple_loss:0.02534421905875206
loss_pred:0.03174491226673126, decouple_loss:0.02560902200639248
loss_pred:0.03238131105899811, decouple_loss:0.02480788342654705
WV_0_PC_1_EH_0_PS_40_5, loss: 0.033722884953022, avg_mse: 0.03699617087841034
current test mse: 0.036996
Iteration: 961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451535165309906, gen p mean: -0.5754867792129517, mean p set: 0.4520154595375061
loss_pred:0.0340568982064724, decouple_loss:0.02307984232902527
The modified gen p mean: 0.4497329890727997, gen p mean: -0.5861881971359253, mean p set: 0.4502132534980774The modified gen p mean: 0.45121505856513977, gen p mean: -0.5823961496353149, mean p set: 0.4516952931880951
loss_pred:0.032513413578271866, decouple_loss:0.02224091812968254
loss_pred:0.03296176344156265, decouple_loss:0.023494211956858635
Iteration: 962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523179829120636, gen p mean: -0.5833357572555542, mean p set: 0.4527982771396637
loss_pred:0.035001080483198166, decouple_loss:0.02262011542916298
The modified gen p mean: 0.4505957067012787, gen p mean: -0.5856599807739258, mean p set: 0.4510760009288788The modified gen p mean: 0.45183250308036804, gen p mean: -0.584368109703064, mean p set: 0.45231279730796814
loss_pred:0.03365980088710785, decouple_loss:0.02231752872467041
loss_pred:0.034947820007801056, decouple_loss:0.02229277789592743
Iteration: 963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45083531737327576, gen p mean: -0.5773378014564514, mean p set: 0.45131561160087585
loss_pred:0.0323185995221138, decouple_loss:0.022436363622546196
The modified gen p mean: 0.4493287205696106, gen p mean: -0.5868358016014099, mean p set: 0.4498090147972107The modified gen p mean: 0.4506399631500244, gen p mean: -0.5880412459373474, mean p set: 0.4511202275753021
loss_pred:0.034100767225027084, decouple_loss:0.022958088666200638
loss_pred:0.032923467457294464, decouple_loss:0.02290085330605507
Iteration: 964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503616690635681, gen p mean: -0.5905619263648987, mean p set: 0.4508419334888458
The modified gen p mean: 0.4517273008823395, gen p mean: -0.5852764248847961, mean p set: 0.4522075653076172
loss_pred:0.03370242938399315, decouple_loss:0.022080518305301666
loss_pred:0.03191033750772476, decouple_loss:0.02192804403603077
The modified gen p mean: 0.4509640336036682, gen p mean: -0.5803540349006653, mean p set: 0.4514442980289459
loss_pred:0.03266662731766701, decouple_loss:0.021900691092014313
Iteration: 965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508418142795563, gen p mean: -0.5823664665222168, mean p set: 0.45132210850715637
loss_pred:0.03432103618979454, decouple_loss:0.022132674232125282
The modified gen p mean: 0.4514372944831848, gen p mean: -0.5843693017959595, mean p set: 0.4519175887107849The modified gen p mean: 0.45255059003829956, gen p mean: -0.5867066383361816, mean p set: 0.45303085446357727
loss_pred:0.03263399749994278, decouple_loss:0.022805538028478622
loss_pred:0.032625339925289154, decouple_loss:0.02211538888514042
Iteration: 966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45078352093696594, gen p mean: -0.5854162573814392, mean p set: 0.4512638449668884
The modified gen p mean: 0.4494194984436035, gen p mean: -0.591015636920929, mean p set: 0.449899822473526
loss_pred:0.033175256103277206, decouple_loss:0.02189020998775959
loss_pred:0.03295873478055, decouple_loss:0.02196531370282173
The modified gen p mean: 0.4496927261352539, gen p mean: -0.5939085483551025, mean p set: 0.450173020362854
loss_pred:0.03322487324476242, decouple_loss:0.022168152034282684
Iteration: 967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517497420310974, gen p mean: -0.5835526585578918, mean p set: 0.4522300362586975
The modified gen p mean: 0.45153141021728516, gen p mean: -0.5880021452903748, mean p set: 0.45201170444488525loss_pred:0.03478139638900757, decouple_loss:0.02120119147002697
The modified gen p mean: 0.45026731491088867, gen p mean: -0.5947706699371338, mean p set: 0.45074760913848877
loss_pred:0.03174054995179176, decouple_loss:0.02174682915210724
loss_pred:0.03333929181098938, decouple_loss:0.0221251230686903
Iteration: 968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518752694129944, gen p mean: -0.5843555331230164, mean p set: 0.4523555636405945
loss_pred:0.031570203602313995, decouple_loss:0.023237664252519608
The modified gen p mean: 0.4509578347206116, gen p mean: -0.5819975733757019, mean p set: 0.45143812894821167The modified gen p mean: 0.45012742280960083, gen p mean: -0.5905857682228088, mean p set: 0.45060768723487854
loss_pred:0.03372540324926376, decouple_loss:0.022612588480114937
loss_pred:0.034207046031951904, decouple_loss:0.021549873054027557
Iteration: 969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508119225502014, gen p mean: -0.5893329977989197, mean p set: 0.4512922167778015
loss_pred:0.03426139056682587, decouple_loss:0.023359229788184166
The modified gen p mean: 0.45269033312797546, gen p mean: -0.585603654384613, mean p set: 0.45317062735557556The modified gen p mean: 0.4503265619277954, gen p mean: -0.5901758670806885, mean p set: 0.4508068561553955
loss_pred:0.033691342920064926, decouple_loss:0.02139555662870407
loss_pred:0.033967409282922745, decouple_loss:0.021391604095697403
Iteration: 970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449715793132782, gen p mean: -0.5948711633682251, mean p set: 0.4501960873603821
loss_pred:0.033302366733551025, decouple_loss:0.021159524098038673
The modified gen p mean: 0.4519239068031311, gen p mean: -0.5873234868049622, mean p set: 0.4524042010307312The modified gen p mean: 0.4518773853778839, gen p mean: -0.5889522433280945, mean p set: 0.452357679605484
loss_pred:0.031701359897851944, decouple_loss:0.02161705307662487
loss_pred:0.031472641974687576, decouple_loss:0.021409763023257256
2023-05-01 19:28:39 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.5984748601913452, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5870615243911743, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5916265845298767, mean p set: 0.4500633478164673
loss_pred:0.03367021679878235, decouple_loss:0.02465244196355343
loss_pred:0.03199651464819908, decouple_loss:0.02458375133574009
loss_pred:0.03283805772662163, decouple_loss:0.02409619837999344
WV_0_PC_1_EH_0_PS_40_5, loss: 0.0340571366250515, avg_mse: 0.03764321655035019
current test mse: 0.037643
Iteration: 971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508517384529114, gen p mean: -0.5816500186920166, mean p set: 0.45133206248283386
loss_pred:0.03333999589085579, decouple_loss:0.020763888955116272
The modified gen p mean: 0.4508074223995209, gen p mean: -0.5944351553916931, mean p set: 0.4512876868247986The modified gen p mean: 0.4512348175048828, gen p mean: -0.5818933844566345, mean p set: 0.4517151117324829
loss_pred:0.032522961497306824, decouple_loss:0.021224958822131157
loss_pred:0.034394100308418274, decouple_loss:0.02143980748951435
Iteration: 972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45233821868896484, gen p mean: -0.5885637402534485, mean p set: 0.45281848311424255
The modified gen p mean: 0.44982582330703735, gen p mean: -0.594299852848053, mean p set: 0.45030614733695984
loss_pred:0.0312667079269886, decouple_loss:0.021215982735157013
The modified gen p mean: 0.45082083344459534, gen p mean: -0.5827353596687317, mean p set: 0.45130112767219543
loss_pred:0.03369244560599327, decouple_loss:0.021068518981337547
loss_pred:0.032607849687337875, decouple_loss:0.021814020350575447
Iteration: 973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141705870628357, gen p mean: -0.5876272916793823, mean p set: 0.45189735293388367
loss_pred:0.03489912301301956, decouple_loss:0.021601911634206772
The modified gen p mean: 0.4508407413959503, gen p mean: -0.5873438715934753, mean p set: 0.451321005821228The modified gen p mean: 0.4513067305088043, gen p mean: -0.5860835909843445, mean p set: 0.45178699493408203
loss_pred:0.032463185489177704, decouple_loss:0.02193816564977169
loss_pred:0.03463398665189743, decouple_loss:0.021297849714756012
Iteration: 974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986769556999207, gen p mean: -0.5991498231887817, mean p set: 0.45034801959991455
loss_pred:0.03335896506905556, decouple_loss:0.02236863411962986
The modified gen p mean: 0.45096662640571594, gen p mean: -0.5967007875442505, mean p set: 0.45144689083099365The modified gen p mean: 0.45010125637054443, gen p mean: -0.5917137265205383, mean p set: 0.45058155059814453
loss_pred:0.03440609574317932, decouple_loss:0.021268794313073158
loss_pred:0.03376562520861626, decouple_loss:0.020663965493440628
Iteration: 975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943225383758545, gen p mean: -0.5943187475204468, mean p set: 0.44991254806518555
loss_pred:0.0327174998819828, decouple_loss:0.021939516067504883
The modified gen p mean: 0.4520964026451111, gen p mean: -0.5911239385604858, mean p set: 0.45257672667503357The modified gen p mean: 0.45006632804870605, gen p mean: -0.5923053622245789, mean p set: 0.4505466818809509
loss_pred:0.03403141722083092, decouple_loss:0.021395700052380562
loss_pred:0.03150174394249916, decouple_loss:0.020624561235308647
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
NaN value num: 0
Iteration: 976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474598467350006, gen p mean: -0.5961493253707886, mean p set: 0.4479401111602783
loss_pred:0.036001697182655334, decouple_loss:0.022370101884007454
The modified gen p mean: 0.44564110040664673, gen p mean: -0.5907561182975769, mean p set: 0.44612136483192444The modified gen p mean: 0.446166068315506, gen p mean: -0.5902785062789917, mean p set: 0.4466463625431061
loss_pred:0.03502584621310234, decouple_loss:0.02357211709022522
loss_pred:0.035044025629758835, decouple_loss:0.024273036047816277
Iteration: 977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484826326370239, gen p mean: -0.5882163047790527, mean p set: 0.448962926864624
The modified gen p mean: 0.44696423411369324, gen p mean: -0.5879954099655151, mean p set: 0.44744452834129333loss_pred:0.03480822220444679, decouple_loss:0.02260090969502926
The modified gen p mean: 0.44908756017684937, gen p mean: -0.587042510509491, mean p set: 0.44956785440444946
loss_pred:0.03397134318947792, decouple_loss:0.02274002693593502
loss_pred:0.03390760347247124, decouple_loss:0.022793298587203026
Iteration: 978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771137833595276, gen p mean: -0.5878404974937439, mean p set: 0.44819167256355286
loss_pred:0.03540175035595894, decouple_loss:0.022764047607779503
The modified gen p mean: 0.4478066861629486, gen p mean: -0.5867979526519775, mean p set: 0.4482869803905487The modified gen p mean: 0.4488821029663086, gen p mean: -0.585884153842926, mean p set: 0.4493623375892639
loss_pred:0.03422102332115173, decouple_loss:0.02398410625755787
loss_pred:0.0335211455821991, decouple_loss:0.022518761456012726
Iteration: 979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483150541782379, gen p mean: -0.5913070440292358, mean p set: 0.448795348405838
The modified gen p mean: 0.44814085960388184, gen p mean: -0.5884734988212585, mean p set: 0.44862115383148193
loss_pred:0.03363640233874321, decouple_loss:0.02124522440135479
loss_pred:0.03406725451350212, decouple_loss:0.02238074690103531
The modified gen p mean: 0.4470826983451843, gen p mean: -0.5947967767715454, mean p set: 0.4475629925727844
loss_pred:0.033502716571092606, decouple_loss:0.02291538566350937
Iteration: 980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467078745365143, gen p mean: -0.5873556733131409, mean p set: 0.4471881687641144
loss_pred:0.0341881588101387, decouple_loss:0.02215729095041752
The modified gen p mean: 0.44720691442489624, gen p mean: -0.5876604914665222, mean p set: 0.4476872384548187The modified gen p mean: 0.4465455710887909, gen p mean: -0.5862367749214172, mean p set: 0.447025865316391
loss_pred:0.03409771993756294, decouple_loss:0.023061731830239296
loss_pred:0.03244439885020256, decouple_loss:0.022326728329062462
2023-05-01 19:31:22 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5869763493537903, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5759519934654236, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5799272060394287, mean p set: 0.4500633478164673
loss_pred:0.03324541449546814, decouple_loss:0.024144869297742844
loss_pred:0.03152589499950409, decouple_loss:0.02338108979165554
loss_pred:0.03244015946984291, decouple_loss:0.02341233566403389
WV_0_PC_1_EH_0_PS_40_5, loss: 0.033586129546165466, avg_mse: 0.03705926239490509
current test mse: 0.037059
Iteration: 981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44587671756744385, gen p mean: -0.5802702903747559, mean p set: 0.44635701179504395
loss_pred:0.034645926207304, decouple_loss:0.023542635142803192
The modified gen p mean: 0.4464946985244751, gen p mean: -0.5798011422157288, mean p set: 0.4469749927520752The modified gen p mean: 0.44829297065734863, gen p mean: -0.579280436038971, mean p set: 0.44877323508262634
loss_pred:0.03544459864497185, decouple_loss:0.02335638366639614
loss_pred:0.03438733518123627, decouple_loss:0.022315289825201035
Iteration: 982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44929271936416626, gen p mean: -0.5907946825027466, mean p set: 0.44977301359176636
loss_pred:0.033405836671590805, decouple_loss:0.023348219692707062
The modified gen p mean: 0.4471679627895355, gen p mean: -0.5901315808296204, mean p set: 0.44764822721481323The modified gen p mean: 0.44806668162345886, gen p mean: -0.5930389761924744, mean p set: 0.44854697585105896
loss_pred:0.033128488808870316, decouple_loss:0.021474404260516167
loss_pred:0.03403481841087341, decouple_loss:0.023344188928604126
Iteration: 983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873499870300293, gen p mean: -0.599260687828064, mean p set: 0.4492153227329254
loss_pred:0.0354284793138504, decouple_loss:0.022445496171712875
The modified gen p mean: 0.4476057291030884, gen p mean: -0.6034323573112488, mean p set: 0.44808605313301086The modified gen p mean: 0.44831228256225586, gen p mean: -0.5978896617889404, mean p set: 0.44879260659217834
loss_pred:0.03520845249295235, decouple_loss:0.023739352822303772
loss_pred:0.03464081510901451, decouple_loss:0.022746291011571884
Iteration: 984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474543333053589, gen p mean: -0.5924813747406006, mean p set: 0.4479345977306366
loss_pred:0.034379422664642334, decouple_loss:0.022029150277376175
The modified gen p mean: 0.4475901424884796, gen p mean: -0.5923835039138794, mean p set: 0.4480704367160797The modified gen p mean: 0.44838374853134155, gen p mean: -0.5909005999565125, mean p set: 0.44886404275894165
loss_pred:0.03328487649559975, decouple_loss:0.02292710915207863
loss_pred:0.03432513773441315, decouple_loss:0.022667929530143738
Iteration: 985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815248250961304, gen p mean: -0.5823707580566406, mean p set: 0.44863274693489075
loss_pred:0.034244436770677567, decouple_loss:0.022600773721933365
The modified gen p mean: 0.44809791445732117, gen p mean: -0.5799250602722168, mean p set: 0.44857820868492126The modified gen p mean: 0.4472391605377197, gen p mean: -0.5772225856781006, mean p set: 0.4477194845676422
loss_pred:0.0341922789812088, decouple_loss:0.02205640822649002
loss_pred:0.03304757550358772, decouple_loss:0.023439764976501465
Iteration: 986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467546343803406, gen p mean: -0.5743685364723206, mean p set: 0.4472349286079407
loss_pred:0.034270115196704865, decouple_loss:0.02176699787378311
The modified gen p mean: 0.447444349527359, gen p mean: -0.5790364146232605, mean p set: 0.4479246735572815The modified gen p mean: 0.4466773569583893, gen p mean: -0.5732677578926086, mean p set: 0.4471576511859894
loss_pred:0.03515852615237236, decouple_loss:0.02192705310881138
loss_pred:0.03353642672300339, decouple_loss:0.02175561524927616
Iteration: 987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766533374786377, gen p mean: -0.5825389623641968, mean p set: 0.4481455683708191
loss_pred:0.03515693172812462, decouple_loss:0.02206314168870449
The modified gen p mean: 0.4455741345882416, gen p mean: -0.5781924724578857, mean p set: 0.4460543990135193The modified gen p mean: 0.4475862383842468, gen p mean: -0.5747190117835999, mean p set: 0.4480665326118469
loss_pred:0.03420575335621834, decouple_loss:0.022012678906321526
loss_pred:0.031922101974487305, decouple_loss:0.02196991816163063
Iteration: 988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698086380958557, gen p mean: -0.5767825841903687, mean p set: 0.4474611282348633
The modified gen p mean: 0.4470619559288025, gen p mean: -0.5786722898483276, mean p set: 0.4475422501564026
loss_pred:0.032963305711746216, decouple_loss:0.021677443757653236
The modified gen p mean: 0.44833511114120483, gen p mean: -0.5845271944999695, mean p set: 0.44881540536880493
loss_pred:0.03361164405941963, decouple_loss:0.022786138579249382
loss_pred:0.03343525156378746, decouple_loss:0.021413356065750122
Iteration: 989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712480902671814, gen p mean: -0.5752575397491455, mean p set: 0.44760507345199585
loss_pred:0.032260216772556305, decouple_loss:0.02109028398990631
The modified gen p mean: 0.44723373651504517, gen p mean: -0.5742335319519043, mean p set: 0.44771403074264526The modified gen p mean: 0.44649913907051086, gen p mean: -0.5800379514694214, mean p set: 0.44697946310043335
loss_pred:0.03367186337709427, decouple_loss:0.022104768082499504
loss_pred:0.03387339040637016, decouple_loss:0.021071545779705048
Iteration: 990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470779597759247, gen p mean: -0.5803614258766174, mean p set: 0.4475582540035248
loss_pred:0.034596871584653854, decouple_loss:0.021168185397982597
The modified gen p mean: 0.448380708694458, gen p mean: -0.5768648386001587, mean p set: 0.4488610029220581The modified gen p mean: 0.4474761188030243, gen p mean: -0.5800211429595947, mean p set: 0.4479564428329468
loss_pred:0.035330191254615784, decouple_loss:0.02189626358449459
loss_pred:0.0345742367208004, decouple_loss:0.02155415154993534
2023-05-01 19:33:31 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.589826762676239, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5790081024169922, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.5834181904792786, mean p set: 0.4500633478164673
loss_pred:0.03314117714762688, decouple_loss:0.023514917120337486
loss_pred:0.031692638993263245, decouple_loss:0.022892363369464874
loss_pred:0.03219250217080116, decouple_loss:0.022423991933465004
WV_0_PC_1_EH_0_PS_40_5, loss: 0.033489298075437546, avg_mse: 0.036990635097026825
current test mse: 0.036991
Iteration: 991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669753313064575, gen p mean: -0.5825919508934021, mean p set: 0.44717782735824585
loss_pred:0.033145226538181305, decouple_loss:0.020895732566714287
The modified gen p mean: 0.4475538730621338, gen p mean: -0.5880979299545288, mean p set: 0.4480341970920563The modified gen p mean: 0.4470864534378052, gen p mean: -0.5852579474449158, mean p set: 0.44756677746772766
loss_pred:0.03431060537695885, decouple_loss:0.021565156057476997
loss_pred:0.03543129190802574, decouple_loss:0.02256322279572487
Iteration: 992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686082005500793, gen p mean: -0.5786879658699036, mean p set: 0.4473411440849304
loss_pred:0.03328840434551239, decouple_loss:0.021706102415919304
The modified gen p mean: 0.4472741186618805, gen p mean: -0.5834252238273621, mean p set: 0.4477544128894806The modified gen p mean: 0.44618886709213257, gen p mean: -0.5813348293304443, mean p set: 0.4466691315174103
loss_pred:0.033629875630140305, decouple_loss:0.021815022453665733
loss_pred:0.034401021897792816, decouple_loss:0.021918198093771935
Iteration: 993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465150833129883, gen p mean: -0.580848217010498, mean p set: 0.4469953775405884
loss_pred:0.03470433130860329, decouple_loss:0.020704040303826332
The modified gen p mean: 0.44613581895828247, gen p mean: -0.5806850790977478, mean p set: 0.44661614298820496The modified gen p mean: 0.4473735988140106, gen p mean: -0.5822103023529053, mean p set: 0.4478538930416107
loss_pred:0.03448719158768654, decouple_loss:0.02101546712219715
loss_pred:0.03296392410993576, decouple_loss:0.020492203533649445
Iteration: 994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818711280822754, gen p mean: -0.5843027234077454, mean p set: 0.44866740703582764
loss_pred:0.03327227011322975, decouple_loss:0.02139899879693985
The modified gen p mean: 0.44742992520332336, gen p mean: -0.5768258571624756, mean p set: 0.4479101598262787The modified gen p mean: 0.44731447100639343, gen p mean: -0.5747947692871094, mean p set: 0.44779476523399353
loss_pred:0.035133909434080124, decouple_loss:0.020629240199923515
loss_pred:0.030990736559033394, decouple_loss:0.02028551697731018
Iteration: 995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470103681087494, gen p mean: -0.5729461312294006, mean p set: 0.4474906623363495
loss_pred:0.03142240643501282, decouple_loss:0.02060037851333618
The modified gen p mean: 0.44718053936958313, gen p mean: -0.573006808757782, mean p set: 0.4476608335971832The modified gen p mean: 0.44743454456329346, gen p mean: -0.5801641941070557, mean p set: 0.44791483879089355
loss_pred:0.03114316053688526, decouple_loss:0.020329128950834274
loss_pred:0.03524523973464966, decouple_loss:0.020993856713175774
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
NaN value num: 0
Iteration: 996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532047510147095, gen p mean: -0.5776382684707642, mean p set: 0.45368504524230957
loss_pred:0.03362181782722473, decouple_loss:0.027038877829909325
The modified gen p mean: 0.4526360332965851, gen p mean: -0.5766571164131165, mean p set: 0.4531163275241852The modified gen p mean: 0.4511502683162689, gen p mean: -0.5714225172996521, mean p set: 0.4516305923461914
loss_pred:0.03233768790960312, decouple_loss:0.027101850137114525
loss_pred:0.033975180238485336, decouple_loss:0.02544712834060192
Iteration: 997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45371973514556885, gen p mean: -0.5725966095924377, mean p set: 0.45420005917549133
loss_pred:0.031213561072945595, decouple_loss:0.025434257462620735
The modified gen p mean: 0.4542848765850067, gen p mean: -0.5717177391052246, mean p set: 0.4547651410102844The modified gen p mean: 0.45327383279800415, gen p mean: -0.5776582360267639, mean p set: 0.45375412702560425
loss_pred:0.031944118440151215, decouple_loss:0.02350074239075184
loss_pred:0.03171272948384285, decouple_loss:0.0257272906601429
Iteration: 998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45457717776298523, gen p mean: -0.5732114315032959, mean p set: 0.4550575017929077
The modified gen p mean: 0.45416200160980225, gen p mean: -0.5696414709091187, mean p set: 0.45464229583740234
loss_pred:0.03188001364469528, decouple_loss:0.024846617132425308
loss_pred:0.03217736631631851, decouple_loss:0.022754311561584473
The modified gen p mean: 0.452735036611557, gen p mean: -0.5695427060127258, mean p set: 0.4532153010368347
loss_pred:0.03299170359969139, decouple_loss:0.02499624341726303
Iteration: 999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45215287804603577, gen p mean: -0.5679808855056763, mean p set: 0.45263317227363586
The modified gen p mean: 0.4529957175254822, gen p mean: -0.5675621032714844, mean p set: 0.4534760117530823
loss_pred:0.03243333473801613, decouple_loss:0.02383205108344555The modified gen p mean: 0.45242056250572205, gen p mean: -0.5632871985435486, mean p set: 0.45290088653564453
loss_pred:0.03190591558814049, decouple_loss:0.02324708364903927
loss_pred:0.03303295001387596, decouple_loss:0.02359026111662388
Iteration: 1000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533783197402954, gen p mean: -0.5794989466667175, mean p set: 0.4538586437702179
loss_pred:0.03210890293121338, decouple_loss:0.022984972223639488
The modified gen p mean: 0.45392748713493347, gen p mean: -0.5795140862464905, mean p set: 0.45440778136253357The modified gen p mean: 0.4528195261955261, gen p mean: -0.5817800164222717, mean p set: 0.4532998204231262
loss_pred:0.0313958041369915, decouple_loss:0.02292667329311371
loss_pred:0.03200150281190872, decouple_loss:0.023172054439783096
2023-05-01 19:36:26 itr: 1000
training loss: [0.03325815 0.03316011 0.03254214]
2023-05-01 19:36:26 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.5941060781478882, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5833666324615479, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.5880289673805237, mean p set: 0.4500633478164673
loss_pred:0.033125802874565125, decouple_loss:0.026459863409399986
loss_pred:0.03154156357049942, decouple_loss:0.025776442140340805
loss_pred:0.03221007063984871, decouple_loss:0.02526026777923107
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03358408808708191, avg_mse: 0.03703000023961067
current test mse: 0.03703
Iteration: 1001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45212578773498535, gen p mean: -0.5795766115188599, mean p set: 0.45260608196258545
The modified gen p mean: 0.45294082164764404, gen p mean: -0.5814754962921143, mean p set: 0.45342111587524414
loss_pred:0.032799750566482544, decouple_loss:0.022294480353593826
The modified gen p mean: 0.4523431360721588, gen p mean: -0.5734221339225769, mean p set: 0.4528234302997589
loss_pred:0.031160404905676842, decouple_loss:0.021973831579089165
loss_pred:0.03267684951424599, decouple_loss:0.022641586139798164
Iteration: 1002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526059925556183, gen p mean: -0.5833852291107178, mean p set: 0.453086256980896
loss_pred:0.032154083251953125, decouple_loss:0.022916357964277267
The modified gen p mean: 0.45172128081321716, gen p mean: -0.5874289274215698, mean p set: 0.4522015452384949The modified gen p mean: 0.45258280634880066, gen p mean: -0.5818511843681335, mean p set: 0.45306307077407837
loss_pred:0.03260859474539757, decouple_loss:0.02323084883391857
loss_pred:0.032136090099811554, decouple_loss:0.024203374981880188
Iteration: 1003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514142572879791, gen p mean: -0.5842029452323914, mean p set: 0.4518945813179016
loss_pred:0.032782893627882004, decouple_loss:0.023072343319654465
The modified gen p mean: 0.45453310012817383, gen p mean: -0.5914623141288757, mean p set: 0.45501336455345154The modified gen p mean: 0.4510023295879364, gen p mean: -0.5841150283813477, mean p set: 0.4514826238155365
loss_pred:0.03189118579030037, decouple_loss:0.02354617416858673
loss_pred:0.03263655677437782, decouple_loss:0.02304009720683098
Iteration: 1004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533019959926605, gen p mean: -0.5938786864280701, mean p set: 0.45378226041793823
loss_pred:0.03162100166082382, decouple_loss:0.02181793749332428
The modified gen p mean: 0.4518083333969116, gen p mean: -0.591535210609436, mean p set: 0.45228859782218933The modified gen p mean: 0.4537821114063263, gen p mean: -0.5917426943778992, mean p set: 0.4542624056339264
loss_pred:0.03286758437752724, decouple_loss:0.022729404270648956
loss_pred:0.0329664871096611, decouple_loss:0.02261817455291748
Iteration: 1005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45208877325057983, gen p mean: -0.5811499953269958, mean p set: 0.45256906747817993
loss_pred:0.03222164884209633, decouple_loss:0.022364042699337006
The modified gen p mean: 0.4530980587005615, gen p mean: -0.5802651643753052, mean p set: 0.4535783529281616The modified gen p mean: 0.4522591829299927, gen p mean: -0.5884796380996704, mean p set: 0.4527394771575928
loss_pred:0.03135083615779877, decouple_loss:0.022549491375684738
loss_pred:0.032317209988832474, decouple_loss:0.022325728088617325
Iteration: 1006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45377692580223083, gen p mean: -0.5830009579658508, mean p set: 0.45425722002983093
loss_pred:0.03216736763715744, decouple_loss:0.022153545171022415
The modified gen p mean: 0.4520069658756256, gen p mean: -0.5837140679359436, mean p set: 0.4524872601032257The modified gen p mean: 0.45213913917541504, gen p mean: -0.5851501226425171, mean p set: 0.45261943340301514
loss_pred:0.03152071312069893, decouple_loss:0.022260790690779686
loss_pred:0.03225524723529816, decouple_loss:0.021345889195799828
Iteration: 1007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45374631881713867, gen p mean: -0.5817509889602661, mean p set: 0.4542265832424164
loss_pred:0.031568143516778946, decouple_loss:0.023106465116143227
The modified gen p mean: 0.45306912064552307, gen p mean: -0.5910138487815857, mean p set: 0.4535493850708008The modified gen p mean: 0.452199250459671, gen p mean: -0.5893455147743225, mean p set: 0.4526795446872711
loss_pred:0.031081903725862503, decouple_loss:0.021928153932094574
loss_pred:0.032537661492824554, decouple_loss:0.02168074995279312
Iteration: 1008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521203637123108, gen p mean: -0.5872817039489746, mean p set: 0.4526006579399109
loss_pred:0.032486461102962494, decouple_loss:0.021807491779327393
The modified gen p mean: 0.45216551423072815, gen p mean: -0.5870537757873535, mean p set: 0.45264583826065063The modified gen p mean: 0.453517884016037, gen p mean: -0.5858669281005859, mean p set: 0.4539981782436371
loss_pred:0.03144494444131851, decouple_loss:0.020954780280590057
loss_pred:0.030959131196141243, decouple_loss:0.020848941057920456
Iteration: 1009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452231228351593, gen p mean: -0.5923019051551819, mean p set: 0.4527115225791931
loss_pred:0.0319807194173336, decouple_loss:0.020992714911699295
The modified gen p mean: 0.45379146933555603, gen p mean: -0.591034471988678, mean p set: 0.45427173376083374The modified gen p mean: 0.45269808173179626, gen p mean: -0.5915961265563965, mean p set: 0.45317837595939636
loss_pred:0.031213952228426933, decouple_loss:0.021221119910478592
loss_pred:0.03160111606121063, decouple_loss:0.021456807851791382
Iteration: 1010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45428934693336487, gen p mean: -0.5930303931236267, mean p set: 0.45476964116096497
loss_pred:0.031615644693374634, decouple_loss:0.020984970033168793
The modified gen p mean: 0.4539887309074402, gen p mean: -0.5957192778587341, mean p set: 0.4544689953327179The modified gen p mean: 0.45353007316589355, gen p mean: -0.594131350517273, mean p set: 0.45401036739349365
loss_pred:0.030969182029366493, decouple_loss:0.021190695464611053
loss_pred:0.031561143696308136, decouple_loss:0.020982200279831886
2023-05-01 19:38:35 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6116566061973572, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6005322337150574, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6052982211112976, mean p set: 0.4500633478164673
loss_pred:0.033297620713710785, decouple_loss:0.025686828419566154
loss_pred:0.031575292348861694, decouple_loss:0.0252834539860487
loss_pred:0.03229144588112831, decouple_loss:0.02465295046567917
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03364850580692291, avg_mse: 0.03726569563150406
current test mse: 0.037266
Iteration: 1011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509071409702301, gen p mean: -0.5948910117149353, mean p set: 0.4513874351978302
loss_pred:0.032347388565540314, decouple_loss:0.021973805502057076
The modified gen p mean: 0.4526561498641968, gen p mean: -0.5975382328033447, mean p set: 0.4531364440917969The modified gen p mean: 0.45358502864837646, gen p mean: -0.6014858484268188, mean p set: 0.45406532287597656
loss_pred:0.03271942958235741, decouple_loss:0.022735757753252983
loss_pred:0.030555443838238716, decouple_loss:0.021789545193314552
Iteration: 1012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45391637086868286, gen p mean: -0.6031749844551086, mean p set: 0.45439663529396057
loss_pred:0.03094993717968464, decouple_loss:0.021331388503313065
The modified gen p mean: 0.45335814356803894, gen p mean: -0.6051542162895203, mean p set: 0.45383843779563904The modified gen p mean: 0.4533141255378723, gen p mean: -0.6060816049575806, mean p set: 0.4537944197654724
loss_pred:0.03195841982960701, decouple_loss:0.020382970571517944
loss_pred:0.03197364881634712, decouple_loss:0.020279059186577797
Iteration: 1013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45424720644950867, gen p mean: -0.6044376492500305, mean p set: 0.45472750067710876
loss_pred:0.030415991321206093, decouple_loss:0.020086539909243584
The modified gen p mean: 0.45261460542678833, gen p mean: -0.6019331216812134, mean p set: 0.4530949294567108The modified gen p mean: 0.4515268802642822, gen p mean: -0.5983461141586304, mean p set: 0.45200714468955994
loss_pred:0.032595567405223846, decouple_loss:0.021453747525811195
loss_pred:0.03190695121884346, decouple_loss:0.021111998707056046
Iteration: 1014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45162105560302734, gen p mean: -0.591458261013031, mean p set: 0.45210132002830505
loss_pred:0.03220941126346588, decouple_loss:0.02108568325638771
The modified gen p mean: 0.4529549181461334, gen p mean: -0.6002203226089478, mean p set: 0.4534352123737335The modified gen p mean: 0.4531184434890747, gen p mean: -0.5984938144683838, mean p set: 0.4535987377166748
loss_pred:0.032707396894693375, decouple_loss:0.021732868626713753
loss_pred:0.0311106089502573, decouple_loss:0.02070368453860283
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
NaN value num: 0
Iteration: 1015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973355531692505, gen p mean: -0.6059837341308594, mean p set: 0.45021387934684753
loss_pred:0.033170223236083984, decouple_loss:0.023492835462093353
The modified gen p mean: 0.4498441219329834, gen p mean: -0.6093522310256958, mean p set: 0.4503243863582611The modified gen p mean: 0.4489936828613281, gen p mean: -0.6097311973571777, mean p set: 0.4494739770889282
loss_pred:0.03200927749276161, decouple_loss:0.02368420921266079
loss_pred:0.032662078738212585, decouple_loss:0.022877808660268784
Iteration: 1016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498606324195862, gen p mean: -0.6131352782249451, mean p set: 0.45034095644950867
loss_pred:0.033479589968919754, decouple_loss:0.0229814276099205
The modified gen p mean: 0.45026251673698425, gen p mean: -0.6175129413604736, mean p set: 0.45074281096458435The modified gen p mean: 0.4523078501224518, gen p mean: -0.6047765612602234, mean p set: 0.4527881443500519
loss_pred:0.033330488950014114, decouple_loss:0.023257452994585037
loss_pred:0.032603614032268524, decouple_loss:0.022336415946483612
Iteration: 1017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169976353645325, gen p mean: -0.617925763130188, mean p set: 0.45218008756637573
loss_pred:0.033160675317049026, decouple_loss:0.0225265771150589
The modified gen p mean: 0.44949042797088623, gen p mean: -0.6143494248390198, mean p set: 0.44997072219848633The modified gen p mean: 0.45140278339385986, gen p mean: -0.6042231321334839, mean p set: 0.45188307762145996
loss_pred:0.03279309347271919, decouple_loss:0.022060267627239227
loss_pred:0.03369089961051941, decouple_loss:0.02171470783650875
Iteration: 1018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944971799850464, gen p mean: -0.6094826459884644, mean p set: 0.44993001222610474
loss_pred:0.03146796673536301, decouple_loss:0.02182733826339245
The modified gen p mean: 0.45227012038230896, gen p mean: -0.6118174195289612, mean p set: 0.45275044441223145The modified gen p mean: 0.45170989632606506, gen p mean: -0.6059266328811646, mean p set: 0.45219019055366516
loss_pred:0.032355912029743195, decouple_loss:0.022794028744101524
loss_pred:0.032360777258872986, decouple_loss:0.022313063964247704
Iteration: 1019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45240646600723267, gen p mean: -0.5993664860725403, mean p set: 0.45288676023483276
loss_pred:0.03273455426096916, decouple_loss:0.02205723710358143
The modified gen p mean: 0.45226559042930603, gen p mean: -0.5937890410423279, mean p set: 0.45274588465690613The modified gen p mean: 0.4489927887916565, gen p mean: -0.6072855591773987, mean p set: 0.4494730830192566
loss_pred:0.030978143215179443, decouple_loss:0.021839214488863945
loss_pred:0.03241918236017227, decouple_loss:0.021138332784175873
Iteration: 1020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497663080692291, gen p mean: -0.6071848273277283, mean p set: 0.4502466022968292
loss_pred:0.03357258811593056, decouple_loss:0.020847661420702934
The modified gen p mean: 0.4518701732158661, gen p mean: -0.6154561638832092, mean p set: 0.4523504674434662The modified gen p mean: 0.4516439735889435, gen p mean: -0.5997835397720337, mean p set: 0.4521242678165436
loss_pred:0.03250904008746147, decouple_loss:0.02231295220553875
loss_pred:0.03354399651288986, decouple_loss:0.021471191197633743
2023-05-01 19:41:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6153049468994141, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.608879566192627, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6044642925262451, mean p set: 0.45035696029663086
loss_pred:0.03301670029759407, decouple_loss:0.024435492232441902
loss_pred:0.03218655660748482, decouple_loss:0.02395426295697689
loss_pred:0.031531717628240585, decouple_loss:0.02421611174941063
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03345509245991707, avg_mse: 0.03715706244111061
current test mse: 0.037157
Iteration: 1021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504345655441284, gen p mean: -0.6037256717681885, mean p set: 0.4509148597717285
loss_pred:0.031053125858306885, decouple_loss:0.021180951967835426
The modified gen p mean: 0.4502570331096649, gen p mean: -0.6139718294143677, mean p set: 0.450737327337265The modified gen p mean: 0.45142990350723267, gen p mean: -0.608588695526123, mean p set: 0.45191019773483276
loss_pred:0.03209193795919418, decouple_loss:0.022246716544032097
loss_pred:0.032663945108652115, decouple_loss:0.02119719609618187
Iteration: 1022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45233818888664246, gen p mean: -0.6160245537757874, mean p set: 0.45281848311424255
loss_pred:0.03158429265022278, decouple_loss:0.021833309903740883
The modified gen p mean: 0.451952189207077, gen p mean: -0.6061833500862122, mean p set: 0.4524324834346771The modified gen p mean: 0.4493335485458374, gen p mean: -0.6089492440223694, mean p set: 0.4498138427734375
loss_pred:0.03177241235971451, decouple_loss:0.02131112478673458
loss_pred:0.030700040981173515, decouple_loss:0.021557334810495377
Iteration: 1023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500156044960022, gen p mean: -0.6114150285720825, mean p set: 0.4504959285259247
loss_pred:0.033122844994068146, decouple_loss:0.02097666636109352
The modified gen p mean: 0.4492368698120117, gen p mean: -0.6077448725700378, mean p set: 0.4497171640396118The modified gen p mean: 0.45204418897628784, gen p mean: -0.5993609428405762, mean p set: 0.4525245130062103
loss_pred:0.031142372637987137, decouple_loss:0.02113349549472332
loss_pred:0.03134144842624664, decouple_loss:0.021087000146508217
Iteration: 1024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030316710472107, gen p mean: -0.6022726893424988, mean p set: 0.4507834315299988
loss_pred:0.030841432511806488, decouple_loss:0.019828209653496742
The modified gen p mean: 0.4499061107635498, gen p mean: -0.6129852533340454, mean p set: 0.4503864049911499The modified gen p mean: 0.4522644281387329, gen p mean: -0.6033206582069397, mean p set: 0.452744722366333
loss_pred:0.034101054072380066, decouple_loss:0.02031485177576542
loss_pred:0.031054528430104256, decouple_loss:0.020538723096251488
Iteration: 1025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45171207189559937, gen p mean: -0.6105366349220276, mean p set: 0.4521923363208771
loss_pred:0.0322854146361351, decouple_loss:0.020066410303115845
The modified gen p mean: 0.4487507939338684, gen p mean: -0.614308774471283, mean p set: 0.4492310881614685The modified gen p mean: 0.44988295435905457, gen p mean: -0.606036365032196, mean p set: 0.45036324858665466
loss_pred:0.03244581073522568, decouple_loss:0.020317256450653076
loss_pred:0.030631503090262413, decouple_loss:0.02004845067858696
Iteration: 1026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498410224914551, gen p mean: -0.6080023646354675, mean p set: 0.4503213167190552
loss_pred:0.031073154881596565, decouple_loss:0.020520981401205063
The modified gen p mean: 0.4494214653968811, gen p mean: -0.6189714074134827, mean p set: 0.4499017596244812The modified gen p mean: 0.45176199078559875, gen p mean: -0.6089740991592407, mean p set: 0.4522422254085541
loss_pred:0.03287234902381897, decouple_loss:0.02077103778719902
loss_pred:0.03135436028242111, decouple_loss:0.02018285170197487
Iteration: 1027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45222026109695435, gen p mean: -0.6132346987724304, mean p set: 0.45270055532455444
loss_pred:0.031727712601423264, decouple_loss:0.021611647680401802
The modified gen p mean: 0.4502771496772766, gen p mean: -0.6119969487190247, mean p set: 0.4507574439048767The modified gen p mean: 0.45021700859069824, gen p mean: -0.6055652499198914, mean p set: 0.4506973326206207
loss_pred:0.03337613120675087, decouple_loss:0.021552689373493195
loss_pred:0.03146519511938095, decouple_loss:0.020901557058095932
Iteration: 1028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521124064922333, gen p mean: -0.5955724120140076, mean p set: 0.4525927007198334
loss_pred:0.03105281852185726, decouple_loss:0.020469624549150467
The modified gen p mean: 0.4520311951637268, gen p mean: -0.607541024684906, mean p set: 0.4525114893913269The modified gen p mean: 0.4519214630126953, gen p mean: -0.5920484066009521, mean p set: 0.4524017870426178
loss_pred:0.03244101256132126, decouple_loss:0.020710721611976624
loss_pred:0.030863067135214806, decouple_loss:0.020338840782642365
Iteration: 1029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486709535121918, gen p mean: -0.5974733829498291, mean p set: 0.44915124773979187
loss_pred:0.031013431027531624, decouple_loss:0.01955411769449711
The modified gen p mean: 0.4514210820198059, gen p mean: -0.5951184630393982, mean p set: 0.4519013464450836The modified gen p mean: 0.4516895115375519, gen p mean: -0.5957049131393433, mean p set: 0.4521697759628296
loss_pred:0.031108953058719635, decouple_loss:0.018864363431930542
loss_pred:0.03147977963089943, decouple_loss:0.019896017387509346
Iteration: 1030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501321017742157, gen p mean: -0.6027078628540039, mean p set: 0.4506123960018158
loss_pred:0.03182050213217735, decouple_loss:0.01964440569281578
The modified gen p mean: 0.4491058588027954, gen p mean: -0.603888988494873, mean p set: 0.4495861530303955The modified gen p mean: 0.45147886872291565, gen p mean: -0.599102258682251, mean p set: 0.45195919275283813
loss_pred:0.032315175980329514, decouple_loss:0.020717941224575043
loss_pred:0.031796783208847046, decouple_loss:0.02091413177549839
2023-05-01 19:43:29 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6118744015693665, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6014567017555237, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6058179140090942, mean p set: 0.4500633478164673
loss_pred:0.03298670053482056, decouple_loss:0.023075943812727928
loss_pred:0.031269967555999756, decouple_loss:0.022331321612000465
loss_pred:0.03196832537651062, decouple_loss:0.021970249712467194
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03319795802235603, avg_mse: 0.03703829273581505
current test mse: 0.037038
Iteration: 1031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44941064715385437, gen p mean: -0.6055571436882019, mean p set: 0.44989094138145447
The modified gen p mean: 0.4488823413848877, gen p mean: -0.6014636754989624, mean p set: 0.4493626356124878
loss_pred:0.030925782397389412, decouple_loss:0.01958782784640789
The modified gen p mean: 0.4528787434101105, gen p mean: -0.6079049706459045, mean p set: 0.45335903763771057
loss_pred:0.030895616859197617, decouple_loss:0.018950579687952995
loss_pred:0.03173236921429634, decouple_loss:0.020978933200240135
Iteration: 1032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519834518432617, gen p mean: -0.5925900340080261, mean p set: 0.4524637460708618
loss_pred:0.032432883977890015, decouple_loss:0.01954439841210842
The modified gen p mean: 0.4499744772911072, gen p mean: -0.606132984161377, mean p set: 0.4504547715187073The modified gen p mean: 0.450868159532547, gen p mean: -0.5948505401611328, mean p set: 0.4513484537601471
loss_pred:0.03404144570231438, decouple_loss:0.02003379352390766
loss_pred:0.031212422996759415, decouple_loss:0.018797362223267555
Iteration: 1033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522947669029236, gen p mean: -0.6041324734687805, mean p set: 0.4527750313282013
loss_pred:0.031297534704208374, decouple_loss:0.020201707258820534
The modified gen p mean: 0.4494694173336029, gen p mean: -0.6015374660491943, mean p set: 0.449949711561203The modified gen p mean: 0.4499351978302002, gen p mean: -0.6075400114059448, mean p set: 0.4504155218601227
loss_pred:0.03034777007997036, decouple_loss:0.019068675115704536
loss_pred:0.034273844212293625, decouple_loss:0.02019394561648369
Iteration: 1034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881126284599304, gen p mean: -0.605830729007721, mean p set: 0.44929152727127075
loss_pred:0.03199094533920288, decouple_loss:0.01965874433517456
The modified gen p mean: 0.45123687386512756, gen p mean: -0.599145233631134, mean p set: 0.45171716809272766The modified gen p mean: 0.4520352780818939, gen p mean: -0.5975167751312256, mean p set: 0.452515572309494
loss_pred:0.03299683704972267, decouple_loss:0.02024485357105732
loss_pred:0.03185207024216652, decouple_loss:0.02012106031179428
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
NaN value num: 0
Iteration: 1035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496941566467285, gen p mean: -0.6084535717964172, mean p set: 0.4501744508743286
loss_pred:0.031220391392707825, decouple_loss:0.021033773198723793
The modified gen p mean: 0.45089441537857056, gen p mean: -0.6113260984420776, mean p set: 0.45137470960617065The modified gen p mean: 0.44927510619163513, gen p mean: -0.6100090742111206, mean p set: 0.4497554302215576
loss_pred:0.033550143241882324, decouple_loss:0.021009370684623718
loss_pred:0.03124495968222618, decouple_loss:0.02013084851205349
Iteration: 1036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833651185035706, gen p mean: -0.6002950668334961, mean p set: 0.44881677627563477
The modified gen p mean: 0.4513542950153351, gen p mean: -0.6089795231819153, mean p set: 0.4518345892429352
loss_pred:0.03216621279716492, decouple_loss:0.020379817113280296
loss_pred:0.03202854096889496, decouple_loss:0.020597591996192932
The modified gen p mean: 0.45017117261886597, gen p mean: -0.6075434684753418, mean p set: 0.4506514370441437
loss_pred:0.031407106667757034, decouple_loss:0.020948171615600586
Iteration: 1037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45143282413482666, gen p mean: -0.6121976375579834, mean p set: 0.45191308856010437
The modified gen p mean: 0.4495660960674286, gen p mean: -0.609390914440155, mean p set: 0.4500464200973511
loss_pred:0.030633794143795967, decouple_loss:0.019902260974049568
loss_pred:0.030760422348976135, decouple_loss:0.01960863173007965
The modified gen p mean: 0.4517655074596405, gen p mean: -0.6072765588760376, mean p set: 0.4522458016872406
loss_pred:0.03305425867438316, decouple_loss:0.02034074254333973
Iteration: 1038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077523589134216, gen p mean: -0.6151809692382812, mean p set: 0.4512555003166199
loss_pred:0.03265860304236412, decouple_loss:0.020768696442246437
The modified gen p mean: 0.45149004459381104, gen p mean: -0.6124758720397949, mean p set: 0.45197030901908875The modified gen p mean: 0.4497639834880829, gen p mean: -0.6152052879333496, mean p set: 0.4502442479133606
loss_pred:0.031512968242168427, decouple_loss:0.019598012790083885
loss_pred:0.031927816569805145, decouple_loss:0.019798656925559044
Iteration: 1039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500799775123596, gen p mean: -0.6010479927062988, mean p set: 0.45056024193763733
loss_pred:0.032097432762384415, decouple_loss:0.020107455551624298
The modified gen p mean: 0.45324620604515076, gen p mean: -0.6109949946403503, mean p set: 0.45372650027275085The modified gen p mean: 0.4512278437614441, gen p mean: -0.6127742528915405, mean p set: 0.4517081081867218
loss_pred:0.032837919890880585, decouple_loss:0.022388705983757973
loss_pred:0.02975892275571823, decouple_loss:0.02153974398970604
Iteration: 1040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44935181736946106, gen p mean: -0.5927401185035706, mean p set: 0.44983211159706116
The modified gen p mean: 0.45285534858703613, gen p mean: -0.6088482737541199, mean p set: 0.45333564281463623
loss_pred:0.031009575352072716, decouple_loss:0.020128460600972176
loss_pred:0.030081504955887794, decouple_loss:0.020619716495275497
The modified gen p mean: 0.4501558840274811, gen p mean: -0.5985963344573975, mean p set: 0.4506361782550812
loss_pred:0.03176877647638321, decouple_loss:0.021119484677910805
2023-05-01 19:46:14 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6090050935745239, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5981594920158386, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6027499437332153, mean p set: 0.4500633478164673
loss_pred:0.0329870730638504, decouple_loss:0.022981742396950722
loss_pred:0.03142814338207245, decouple_loss:0.023028718307614326
loss_pred:0.03198491409420967, decouple_loss:0.02238255739212036
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03327326104044914, avg_mse: 0.037143997848033905
current test mse: 0.037144
Iteration: 1041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499867856502533, gen p mean: -0.6044397354125977, mean p set: 0.4504671096801758
The modified gen p mean: 0.44968530535697937, gen p mean: -0.6020134091377258, mean p set: 0.45016559958457947
loss_pred:0.03137630969285965, decouple_loss:0.01988738775253296
The modified gen p mean: 0.45070233941078186, gen p mean: -0.607626736164093, mean p set: 0.45118266344070435
loss_pred:0.03035554848611355, decouple_loss:0.020201735198497772
loss_pred:0.03229711204767227, decouple_loss:0.020575638860464096
Iteration: 1042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804272055625916, gen p mean: -0.602971076965332, mean p set: 0.44852298498153687
loss_pred:0.03229125961661339, decouple_loss:0.020619744434952736
The modified gen p mean: 0.4506523609161377, gen p mean: -0.6160601377487183, mean p set: 0.4511326253414154The modified gen p mean: 0.4501718282699585, gen p mean: -0.6083336472511292, mean p set: 0.4506521224975586
loss_pred:0.032677821815013885, decouple_loss:0.020638402551412582
loss_pred:0.03096812590956688, decouple_loss:0.02092885412275791
Iteration: 1043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513772428035736, gen p mean: -0.6191922426223755, mean p set: 0.4518575668334961
The modified gen p mean: 0.44905751943588257, gen p mean: -0.6162445545196533, mean p set: 0.4495377540588379
loss_pred:0.03215602785348892, decouple_loss:0.020398005843162537
loss_pred:0.03131694346666336, decouple_loss:0.020370561629533768
The modified gen p mean: 0.4511845111846924, gen p mean: -0.6223083138465881, mean p set: 0.4516648054122925
loss_pred:0.030059978365898132, decouple_loss:0.019818615168333054
Iteration: 1044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507392644882202, gen p mean: -0.6119943261146545, mean p set: 0.4512195587158203
loss_pred:0.0322844423353672, decouple_loss:0.02009124681353569
The modified gen p mean: 0.4508698880672455, gen p mean: -0.6190739274024963, mean p set: 0.4513501822948456The modified gen p mean: 0.4512171745300293, gen p mean: -0.6123314499855042, mean p set: 0.451697438955307
loss_pred:0.03215939179062843, decouple_loss:0.020501326769590378
loss_pred:0.032397229224443436, decouple_loss:0.020798372104763985
Iteration: 1045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448230504989624, gen p mean: -0.5938158631324768, mean p set: 0.4487107992172241
loss_pred:0.03196896240115166, decouple_loss:0.020419463515281677
The modified gen p mean: 0.4518306851387024, gen p mean: -0.6114148497581482, mean p set: 0.4523109793663025The modified gen p mean: 0.4508529305458069, gen p mean: -0.6102105379104614, mean p set: 0.451333224773407
loss_pred:0.030211152508854866, decouple_loss:0.019902940839529037
loss_pred:0.0322151854634285, decouple_loss:0.022424809634685516
Iteration: 1046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526841342449188, gen p mean: -0.6082372665405273, mean p set: 0.4531644284725189
loss_pred:0.029693596065044403, decouple_loss:0.020874598994851112
The modified gen p mean: 0.45035213232040405, gen p mean: -0.5976811647415161, mean p set: 0.45083242654800415The modified gen p mean: 0.44978848099708557, gen p mean: -0.5979095697402954, mean p set: 0.45026880502700806
loss_pred:0.03181733191013336, decouple_loss:0.02019435726106167
loss_pred:0.030919790267944336, decouple_loss:0.019474215805530548
Iteration: 1047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503033757209778, gen p mean: -0.5988333821296692, mean p set: 0.4507836401462555
The modified gen p mean: 0.45093390345573425, gen p mean: -0.6044509410858154, mean p set: 0.45141419768333435
loss_pred:0.03252324461936951, decouple_loss:0.02041521854698658
loss_pred:0.03203336521983147, decouple_loss:0.020638663321733475
The modified gen p mean: 0.45195168256759644, gen p mean: -0.6108216643333435, mean p set: 0.45243194699287415
loss_pred:0.0328742079436779, decouple_loss:0.020885953679680824
Iteration: 1048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503582715988159, gen p mean: -0.6044548153877258, mean p set: 0.450838565826416
loss_pred:0.03273218125104904, decouple_loss:0.01992872543632984
The modified gen p mean: 0.4515188932418823, gen p mean: -0.6161509156227112, mean p set: 0.4519991874694824The modified gen p mean: 0.44866201281547546, gen p mean: -0.5980635285377502, mean p set: 0.44914230704307556
loss_pred:0.031108269467949867, decouple_loss:0.01953977160155773
loss_pred:0.0324002243578434, decouple_loss:0.020459426566958427
Iteration: 1049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008787512779236, gen p mean: -0.6095353960990906, mean p set: 0.45056816935539246
The modified gen p mean: 0.4486974775791168, gen p mean: -0.6123009920120239, mean p set: 0.4491777718067169
loss_pred:0.03141646832227707, decouple_loss:0.020157847553491592
loss_pred:0.03110196627676487, decouple_loss:0.01969684660434723
The modified gen p mean: 0.4509353041648865, gen p mean: -0.6098098754882812, mean p set: 0.4514155387878418
loss_pred:0.03144960477948189, decouple_loss:0.020401528105139732
Iteration: 1050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496780037879944, gen p mean: -0.6056058406829834, mean p set: 0.4501582682132721
The modified gen p mean: 0.45249879360198975, gen p mean: -0.6151914000511169, mean p set: 0.45297905802726746
loss_pred:0.030610881745815277, decouple_loss:0.01957058347761631
loss_pred:0.03267988562583923, decouple_loss:0.02025064267218113
The modified gen p mean: 0.452468603849411, gen p mean: -0.6188468933105469, mean p set: 0.4529488980770111
loss_pred:0.031157361343503, decouple_loss:0.02131718397140503
2023-05-01 19:48:24 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.611664354801178, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6054737567901611, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6010091304779053, mean p set: 0.45035696029663086
loss_pred:0.032629162073135376, decouple_loss:0.022596850991249084
loss_pred:0.0317242369055748, decouple_loss:0.021630413830280304
loss_pred:0.03107793815433979, decouple_loss:0.022228052839636803
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03291803598403931, avg_mse: 0.03678023815155029
current test mse: 0.03678
Iteration: 1051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840550422668457, gen p mean: -0.6007962822914124, mean p set: 0.4488857686519623
loss_pred:0.03230015188455582, decouple_loss:0.019715936854481697
The modified gen p mean: 0.45244041085243225, gen p mean: -0.6111146211624146, mean p set: 0.45292070508003235The modified gen p mean: 0.45277729630470276, gen p mean: -0.6180170774459839, mean p set: 0.45325756072998047
loss_pred:0.030524739995598793, decouple_loss:0.020407315343618393
loss_pred:0.032826513051986694, decouple_loss:0.0189503263682127
Iteration: 1052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451749712228775, gen p mean: -0.6228722929954529, mean p set: 0.45222997665405273
loss_pred:0.03184410184621811, decouple_loss:0.020830214023590088
The modified gen p mean: 0.45090603828430176, gen p mean: -0.6214701533317566, mean p set: 0.45138633251190186The modified gen p mean: 0.4502318501472473, gen p mean: -0.6094490885734558, mean p set: 0.4507121443748474
loss_pred:0.030576467514038086, decouple_loss:0.020393647253513336
loss_pred:0.030740365386009216, decouple_loss:0.020228225737810135
Iteration: 1053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514182209968567, gen p mean: -0.6165100932121277, mean p set: 0.4518985152244568
The modified gen p mean: 0.4507479667663574, gen p mean: -0.6049589514732361, mean p set: 0.45122823119163513
loss_pred:0.030423590913414955, decouple_loss:0.01982966810464859
loss_pred:0.032923247665166855, decouple_loss:0.019928280264139175
The modified gen p mean: 0.4498998820781708, gen p mean: -0.6076590418815613, mean p set: 0.4503801465034485
loss_pred:0.030790988355875015, decouple_loss:0.020055163651704788
Iteration: 1054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487243592739105, gen p mean: -0.5955497622489929, mean p set: 0.4492046535015106
loss_pred:0.032596439123153687, decouple_loss:0.020350376144051552
The modified gen p mean: 0.4507633149623871, gen p mean: -0.6028441786766052, mean p set: 0.4512436091899872The modified gen p mean: 0.44949018955230713, gen p mean: -0.5970385074615479, mean p set: 0.4499705135822296
loss_pred:0.030784087255597115, decouple_loss:0.01952802762389183
loss_pred:0.03154115006327629, decouple_loss:0.020503193140029907
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
NaN value num: 0
Iteration: 1055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968751072883606, gen p mean: -0.6056604981422424, mean p set: 0.45016783475875854
loss_pred:0.030509553849697113, decouple_loss:0.02337423339486122
The modified gen p mean: 0.45040223002433777, gen p mean: -0.6128770112991333, mean p set: 0.45088252425193787The modified gen p mean: 0.4478347897529602, gen p mean: -0.6034934520721436, mean p set: 0.4483151137828827
loss_pred:0.03280787542462349, decouple_loss:0.021424025297164917
loss_pred:0.032552044838666916, decouple_loss:0.022820379585027695
Iteration: 1056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031341910362244, gen p mean: -0.6160879135131836, mean p set: 0.4507937431335449
loss_pred:0.0311807282269001, decouple_loss:0.023158695548772812
The modified gen p mean: 0.45033779740333557, gen p mean: -0.6237651705741882, mean p set: 0.45081809163093567The modified gen p mean: 0.4473850131034851, gen p mean: -0.6074124574661255, mean p set: 0.4478653073310852
loss_pred:0.032910991460084915, decouple_loss:0.023062769323587418
loss_pred:0.03124157339334488, decouple_loss:0.022354185581207275
Iteration: 1057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497023820877075, gen p mean: -0.6042277812957764, mean p set: 0.4501826763153076
loss_pred:0.02943398617208004, decouple_loss:0.022756453603506088
The modified gen p mean: 0.45063212513923645, gen p mean: -0.6149948239326477, mean p set: 0.45111238956451416The modified gen p mean: 0.44847986102104187, gen p mean: -0.6061980128288269, mean p set: 0.44896015524864197
loss_pred:0.032263558357954025, decouple_loss:0.022883767262101173
loss_pred:0.03317282348871231, decouple_loss:0.021844113245606422
Iteration: 1058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471459686756134, gen p mean: -0.5914467573165894, mean p set: 0.4476262331008911
loss_pred:0.030705872923135757, decouple_loss:0.021823683753609657
The modified gen p mean: 0.4481813609600067, gen p mean: -0.5994996428489685, mean p set: 0.4486616849899292The modified gen p mean: 0.4498848617076874, gen p mean: -0.6014374494552612, mean p set: 0.4503651261329651
loss_pred:0.03311234712600708, decouple_loss:0.021990707144141197
loss_pred:0.03196601942181587, decouple_loss:0.021553494036197662
Iteration: 1059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498419165611267, gen p mean: -0.6048333048820496, mean p set: 0.4503222107887268
loss_pred:0.032295893877744675, decouple_loss:0.021180180832743645
The modified gen p mean: 0.4477819502353668, gen p mean: -0.5960594415664673, mean p set: 0.44826221466064453The modified gen p mean: 0.44942229986190796, gen p mean: -0.6067066192626953, mean p set: 0.44990259408950806
loss_pred:0.033302467316389084, decouple_loss:0.02184009924530983
loss_pred:0.03180057182908058, decouple_loss:0.021701136603951454
Iteration: 1060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839757680892944, gen p mean: -0.6035107374191284, mean p set: 0.44887787103652954
loss_pred:0.03275680169463158, decouple_loss:0.021239614114165306
The modified gen p mean: 0.45067402720451355, gen p mean: -0.6071585416793823, mean p set: 0.45115435123443604The modified gen p mean: 0.4489588439464569, gen p mean: -0.6055052280426025, mean p set: 0.449439138174057
loss_pred:0.032264187932014465, decouple_loss:0.020909471437335014
loss_pred:0.03250718489289284, decouple_loss:0.020582474768161774
2023-05-01 19:51:08 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6234266757965088, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.613037109375, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6177023649215698, mean p set: 0.4500633478164673
loss_pred:0.032892920076847076, decouple_loss:0.024130865931510925
loss_pred:0.03108040802180767, decouple_loss:0.023422138765454292
loss_pred:0.03185749426484108, decouple_loss:0.02292206697165966
WV_0_PC_1_EH_0_PS_40_5, loss: 0.033118195831775665, avg_mse: 0.0369635671377182
current test mse: 0.036964
Iteration: 1061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507506787776947, gen p mean: -0.6146504878997803, mean p set: 0.4512310028076172
The modified gen p mean: 0.4486122727394104, gen p mean: -0.6087642908096313, mean p set: 0.4490925371646881
loss_pred:0.02974640764296055, decouple_loss:0.020771950483322144
The modified gen p mean: 0.44791412353515625, gen p mean: -0.6113836169242859, mean p set: 0.44839444756507874
loss_pred:0.032084591686725616, decouple_loss:0.021039949730038643
loss_pred:0.030910594388842583, decouple_loss:0.02072256989777088
Iteration: 1062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734182953834534, gen p mean: -0.6138332486152649, mean p set: 0.44782212376594543
loss_pred:0.03187578171491623, decouple_loss:0.020968906581401825
The modified gen p mean: 0.4483886659145355, gen p mean: -0.6106685400009155, mean p set: 0.44886893033981323The modified gen p mean: 0.44774141907691956, gen p mean: -0.6082104444503784, mean p set: 0.44822174310684204
loss_pred:0.03235850855708122, decouple_loss:0.020969239994883537
loss_pred:0.03337941691279411, decouple_loss:0.020496249198913574
Iteration: 1063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478376805782318, gen p mean: -0.6066730618476868, mean p set: 0.4483179748058319
loss_pred:0.03168640285730362, decouple_loss:0.02016211673617363
The modified gen p mean: 0.4502808153629303, gen p mean: -0.6240240931510925, mean p set: 0.4507611393928528The modified gen p mean: 0.4502868950366974, gen p mean: -0.6189468502998352, mean p set: 0.4507671892642975
loss_pred:0.03152933716773987, decouple_loss:0.022465769201517105
loss_pred:0.03093092329800129, decouple_loss:0.021783770993351936
Iteration: 1064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505457878112793, gen p mean: -0.6152243614196777, mean p set: 0.4510261118412018
loss_pred:0.02967016026377678, decouple_loss:0.020298989489674568
The modified gen p mean: 0.4500276744365692, gen p mean: -0.620308518409729, mean p set: 0.4505079984664917The modified gen p mean: 0.4481842517852783, gen p mean: -0.6164418458938599, mean p set: 0.44866451621055603
loss_pred:0.030664777383208275, decouple_loss:0.02168041653931141
loss_pred:0.031235532835125923, decouple_loss:0.019977755844593048
Iteration: 1065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44985494017601013, gen p mean: -0.6035208702087402, mean p set: 0.45033523440361023
The modified gen p mean: 0.4501774311065674, gen p mean: -0.6112818121910095, mean p set: 0.4506576955318451
loss_pred:0.03076779656112194, decouple_loss:0.021441873162984848
loss_pred:0.030576201155781746, decouple_loss:0.02064967155456543
The modified gen p mean: 0.4481179416179657, gen p mean: -0.603711724281311, mean p set: 0.4485982656478882
loss_pred:0.03254716098308563, decouple_loss:0.02042640745639801
Iteration: 1066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747990369796753, gen p mean: -0.6023588180541992, mean p set: 0.4479601979255676
loss_pred:0.030409444123506546, decouple_loss:0.021083494648337364
The modified gen p mean: 0.44989433884620667, gen p mean: -0.6079265475273132, mean p set: 0.4503746032714844The modified gen p mean: 0.4491213262081146, gen p mean: -0.6120798587799072, mean p set: 0.4496016502380371
loss_pred:0.0326961874961853, decouple_loss:0.020563427358865738
loss_pred:0.03097924403846264, decouple_loss:0.020581966266036034
Iteration: 1067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744107127189636, gen p mean: -0.6005141735076904, mean p set: 0.4479213356971741
loss_pred:0.030872242525219917, decouple_loss:0.020882902666926384
The modified gen p mean: 0.4500086009502411, gen p mean: -0.607539176940918, mean p set: 0.4504888951778412The modified gen p mean: 0.45012199878692627, gen p mean: -0.6167528033256531, mean p set: 0.45060229301452637
loss_pred:0.029754100367426872, decouple_loss:0.020672818645834923
loss_pred:0.03118896298110485, decouple_loss:0.021585747599601746
Iteration: 1068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850990176200867, gen p mean: -0.6035342216491699, mean p set: 0.44899022579193115
The modified gen p mean: 0.45013856887817383, gen p mean: -0.6105712652206421, mean p set: 0.4506188929080963
loss_pred:0.03107638657093048, decouple_loss:0.019977083429694176
loss_pred:0.03115074522793293, decouple_loss:0.020713163539767265
The modified gen p mean: 0.45001155138015747, gen p mean: -0.6174857020378113, mean p set: 0.45049184560775757
loss_pred:0.03185749799013138, decouple_loss:0.020225979387760162
Iteration: 1069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506209194660187, gen p mean: -0.6053988337516785, mean p set: 0.4511011838912964
loss_pred:0.030645601451396942, decouple_loss:0.020122600719332695
The modified gen p mean: 0.44752299785614014, gen p mean: -0.595207691192627, mean p set: 0.44800323247909546The modified gen p mean: 0.45007219910621643, gen p mean: -0.6018296480178833, mean p set: 0.45055249333381653
loss_pred:0.031558480113744736, decouple_loss:0.019807877019047737
loss_pred:0.02978905476629734, decouple_loss:0.02028752490878105
Iteration: 1070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833803176879883, gen p mean: -0.6011664867401123, mean p set: 0.44881829619407654
The modified gen p mean: 0.4484219253063202, gen p mean: -0.5992481112480164, mean p set: 0.4489021897315979
loss_pred:0.0327608697116375, decouple_loss:0.020021406933665276
loss_pred:0.031774505972862244, decouple_loss:0.020440828055143356
The modified gen p mean: 0.44778764247894287, gen p mean: -0.6026845574378967, mean p set: 0.4482679069042206
loss_pred:0.030954644083976746, decouple_loss:0.01978992111980915
2023-05-01 19:53:17 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6275484561920166, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6170864105224609, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6212984323501587, mean p set: 0.4500633478164673
loss_pred:0.03276631981134415, decouple_loss:0.023152220994234085
loss_pred:0.03100692667067051, decouple_loss:0.0225359033793211
loss_pred:0.03166912868618965, decouple_loss:0.021991409361362457
WV_0_PC_1_EH_0_PS_40_5, loss: 0.032942116260528564, avg_mse: 0.036820005625486374
current test mse: 0.03682
Iteration: 1071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010942220687866, gen p mean: -0.6198155879974365, mean p set: 0.45058971643447876
The modified gen p mean: 0.44900307059288025, gen p mean: -0.6139428019523621, mean p set: 0.44948336482048035
loss_pred:0.032381463795900345, decouple_loss:0.020009182393550873
The modified gen p mean: 0.4483879804611206, gen p mean: -0.6097782850265503, mean p set: 0.4488682746887207
loss_pred:0.029358167201280594, decouple_loss:0.019392648711800575
loss_pred:0.030533796176314354, decouple_loss:0.019711581990122795
Iteration: 1072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474698603153229, gen p mean: -0.6054880619049072, mean p set: 0.447950154542923
loss_pred:0.03176656737923622, decouple_loss:0.019362566992640495
The modified gen p mean: 0.4481774568557739, gen p mean: -0.6074877381324768, mean p set: 0.44865772128105164The modified gen p mean: 0.4497668147087097, gen p mean: -0.611290454864502, mean p set: 0.4502470791339874
loss_pred:0.03128066286444664, decouple_loss:0.01915891282260418
loss_pred:0.0322696752846241, decouple_loss:0.020021481439471245
Iteration: 1073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859281182289124, gen p mean: -0.6052340865135193, mean p set: 0.44907310605049133
loss_pred:0.03201737254858017, decouple_loss:0.020629802718758583
The modified gen p mean: 0.45023879408836365, gen p mean: -0.6188745498657227, mean p set: 0.45071908831596375The modified gen p mean: 0.44740962982177734, gen p mean: -0.6041991114616394, mean p set: 0.44788995385169983
loss_pred:0.030814290046691895, decouple_loss:0.020582465454936028
loss_pred:0.030451711267232895, decouple_loss:0.019583595916628838
Iteration: 1074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726619124412537, gen p mean: -0.6068053245544434, mean p set: 0.44774648547172546
The modified gen p mean: 0.4485941231250763, gen p mean: -0.6152293682098389, mean p set: 0.4490744471549988
loss_pred:0.030059171840548515, decouple_loss:0.020347002893686295
loss_pred:0.03179875761270523, decouple_loss:0.019368106499314308
The modified gen p mean: 0.44965460896492004, gen p mean: -0.611091136932373, mean p set: 0.45013487339019775
loss_pred:0.031014764681458473, decouple_loss:0.02015623264014721
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
NaN value num: 0
Iteration: 1075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449925035238266, gen p mean: -0.6148606538772583, mean p set: 0.4504052996635437
loss_pred:0.030166661366820335, decouple_loss:0.019880756735801697
The modified gen p mean: 0.4506820738315582, gen p mean: -0.6164888739585876, mean p set: 0.45116233825683594The modified gen p mean: 0.4505167305469513, gen p mean: -0.6167497038841248, mean p set: 0.450996994972229
loss_pred:0.029927050694823265, decouple_loss:0.020057884976267815
loss_pred:0.02982795611023903, decouple_loss:0.02031475119292736
Iteration: 1076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45037171244621277, gen p mean: -0.6232457756996155, mean p set: 0.4508519768714905
loss_pred:0.028648054227232933, decouple_loss:0.018995681777596474
The modified gen p mean: 0.45020654797554016, gen p mean: -0.6250414252281189, mean p set: 0.45068684220314026The modified gen p mean: 0.4492405652999878, gen p mean: -0.6221937537193298, mean p set: 0.4497208595275879
loss_pred:0.029851878061890602, decouple_loss:0.0201707873493433
loss_pred:0.031085306778550148, decouple_loss:0.019374867901206017
Iteration: 1077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45067375898361206, gen p mean: -0.6162601113319397, mean p set: 0.45115405321121216
loss_pred:0.029050331562757492, decouple_loss:0.01933341659605503
The modified gen p mean: 0.4498765468597412, gen p mean: -0.6105901002883911, mean p set: 0.4503568708896637The modified gen p mean: 0.4503304064273834, gen p mean: -0.6114746332168579, mean p set: 0.45081067085266113
loss_pred:0.030446484684944153, decouple_loss:0.019699374213814735
loss_pred:0.02991102635860443, decouple_loss:0.02064182609319687
Iteration: 1078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45062196254730225, gen p mean: -0.5945934057235718, mean p set: 0.45110228657722473
loss_pred:0.03252503648400307, decouple_loss:0.021505586802959442
The modified gen p mean: 0.45027074217796326, gen p mean: -0.5932499170303345, mean p set: 0.45075103640556335The modified gen p mean: 0.4510660171508789, gen p mean: -0.5931394100189209, mean p set: 0.4515463411808014
loss_pred:0.03009622171521187, decouple_loss:0.019337572157382965
loss_pred:0.03052954189479351, decouple_loss:0.01925734430551529
Iteration: 1079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500886797904968, gen p mean: -0.6076260209083557, mean p set: 0.4505689740180969
loss_pred:0.03043542429804802, decouple_loss:0.02035849168896675
The modified gen p mean: 0.4502076208591461, gen p mean: -0.6065261960029602, mean p set: 0.4506879150867462The modified gen p mean: 0.44974014163017273, gen p mean: -0.6022436022758484, mean p set: 0.4502204656600952
loss_pred:0.03135604411363602, decouple_loss:0.020845899358391762
loss_pred:0.030434073880314827, decouple_loss:0.019911186769604683
Iteration: 1080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214927196502686, gen p mean: -0.6192768216133118, mean p set: 0.45262953639030457
The modified gen p mean: 0.44990256428718567, gen p mean: -0.6120163202285767, mean p set: 0.45038288831710815
loss_pred:0.030299032106995583, decouple_loss:0.02062852308154106
loss_pred:0.03082352504134178, decouple_loss:0.021105019375681877
The modified gen p mean: 0.45159173011779785, gen p mean: -0.6184965968132019, mean p set: 0.45207199454307556
loss_pred:0.030746234580874443, decouple_loss:0.020771948620676994
2023-05-01 19:56:02 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6274370551109314, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6178566813468933, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6215629577636719, mean p set: 0.4500633478164673
loss_pred:0.032758865505456924, decouple_loss:0.023311691358685493
loss_pred:0.030908141285181046, decouple_loss:0.022905847057700157
loss_pred:0.031705111265182495, decouple_loss:0.02255277708172798
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03293687850236893, avg_mse: 0.036933332681655884
current test mse: 0.036933
Iteration: 1081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45135101675987244, gen p mean: -0.6222140192985535, mean p set: 0.45183131098747253
The modified gen p mean: 0.4494132697582245, gen p mean: -0.6188305616378784, mean p set: 0.4498935639858246
loss_pred:0.030444474890828133, decouple_loss:0.021814880892634392
The modified gen p mean: 0.4509523808956146, gen p mean: -0.6164306402206421, mean p set: 0.4514326751232147
loss_pred:0.028354071080684662, decouple_loss:0.018744613975286484
loss_pred:0.029109131544828415, decouple_loss:0.01998242177069187
Iteration: 1082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033106207847595, gen p mean: -0.6197218894958496, mean p set: 0.45081138610839844
The modified gen p mean: 0.4491123855113983, gen p mean: -0.6122334599494934, mean p set: 0.449592649936676
loss_pred:0.031047072261571884, decouple_loss:0.022479746490716934
loss_pred:0.02994193136692047, decouple_loss:0.02095956541597843
The modified gen p mean: 0.4491015374660492, gen p mean: -0.6062290668487549, mean p set: 0.4495818316936493
loss_pred:0.031166642904281616, decouple_loss:0.019739530980587006
Iteration: 1083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507567882537842, gen p mean: -0.6112747192382812, mean p set: 0.45123711228370667
The modified gen p mean: 0.4490228593349457, gen p mean: -0.6017289161682129, mean p set: 0.4495031237602234
loss_pred:0.03165537118911743, decouple_loss:0.022298870608210564
loss_pred:0.029841097071766853, decouple_loss:0.019232165068387985
The modified gen p mean: 0.449672669172287, gen p mean: -0.6033415198326111, mean p set: 0.4501529335975647
loss_pred:0.03020305372774601, decouple_loss:0.019171271473169327
Iteration: 1084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500882923603058, gen p mean: -0.6055053472518921, mean p set: 0.4505685865879059
The modified gen p mean: 0.45050111413002014, gen p mean: -0.6027327179908752, mean p set: 0.45098140835762024
loss_pred:0.031808771193027496, decouple_loss:0.021228352561593056
loss_pred:0.03041888400912285, decouple_loss:0.019178198650479317
The modified gen p mean: 0.45003724098205566, gen p mean: -0.6093448400497437, mean p set: 0.45051753520965576
loss_pred:0.030574142932891846, decouple_loss:0.01911928877234459
Iteration: 1085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838547706604004, gen p mean: -0.6034981608390808, mean p set: 0.4488658010959625
The modified gen p mean: 0.4491910934448242, gen p mean: -0.607107937335968, mean p set: 0.4496713876724243
loss_pred:0.030389079824090004, decouple_loss:0.02000228315591812
loss_pred:0.030815139412879944, decouple_loss:0.020601605996489525
The modified gen p mean: 0.4501641094684601, gen p mean: -0.6090846061706543, mean p set: 0.4506444036960602
loss_pred:0.029690241441130638, decouple_loss:0.02104453556239605
Iteration: 1086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451831579208374, gen p mean: -0.6215394139289856, mean p set: 0.4523118734359741
The modified gen p mean: 0.45185530185699463, gen p mean: -0.6179282665252686, mean p set: 0.4523356258869171
loss_pred:0.03069637529551983, decouple_loss:0.020156119018793106
loss_pred:0.029468130320310593, decouple_loss:0.020680272951722145
The modified gen p mean: 0.44981467723846436, gen p mean: -0.6192508935928345, mean p set: 0.45029497146606445
loss_pred:0.02981453202664852, decouple_loss:0.020171526819467545
Iteration: 1087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490172863006592, gen p mean: -0.6184262037277222, mean p set: 0.4494975507259369
The modified gen p mean: 0.450730562210083, gen p mean: -0.6184993386268616, mean p set: 0.4512108564376831
loss_pred:0.030184337869286537, decouple_loss:0.019804401323199272
loss_pred:0.029947267845273018, decouple_loss:0.019888553768396378
The modified gen p mean: 0.4502185583114624, gen p mean: -0.6192895770072937, mean p set: 0.4506988525390625
loss_pred:0.029710525646805763, decouple_loss:0.02054540626704693
Iteration: 1088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44895103573799133, gen p mean: -0.6031090021133423, mean p set: 0.44943130016326904
The modified gen p mean: 0.4500146210193634, gen p mean: -0.61298668384552, mean p set: 0.4504949152469635
loss_pred:0.030204951763153076, decouple_loss:0.01897037960588932
loss_pred:0.030300317332148552, decouple_loss:0.019510377198457718
The modified gen p mean: 0.4513145685195923, gen p mean: -0.6036670207977295, mean p set: 0.45179483294487
loss_pred:0.029836148023605347, decouple_loss:0.019994908943772316
Iteration: 1089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499324858188629, gen p mean: -0.5980575680732727, mean p set: 0.4504128098487854
The modified gen p mean: 0.4511227011680603, gen p mean: -0.6018675565719604, mean p set: 0.4516029953956604
loss_pred:0.030058354139328003, decouple_loss:0.01814187504351139
loss_pred:0.03011455573141575, decouple_loss:0.018338145688176155The modified gen p mean: 0.44838088750839233, gen p mean: -0.5950902104377747, mean p set: 0.44886115193367004
loss_pred:0.03011237271130085, decouple_loss:0.018862245604395866
Iteration: 1090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45193353295326233, gen p mean: -0.5947763919830322, mean p set: 0.45241379737854004
The modified gen p mean: 0.449524462223053, gen p mean: -0.5963099002838135, mean p set: 0.4500047266483307
loss_pred:0.029781585559248924, decouple_loss:0.018885396420955658
loss_pred:0.030493656173348427, decouple_loss:0.019926894456148148
The modified gen p mean: 0.4504881501197815, gen p mean: -0.5905221700668335, mean p set: 0.4509684145450592
loss_pred:0.030425792559981346, decouple_loss:0.018547849729657173
2023-05-01 19:58:11 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6069340705871582, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.5982183814048767, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.601348876953125, mean p set: 0.4500633478164673
loss_pred:0.032618068158626556, decouple_loss:0.0231814943253994
loss_pred:0.03086923249065876, decouple_loss:0.0223077479749918
loss_pred:0.03161986172199249, decouple_loss:0.02210901491343975
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03282902389764786, avg_mse: 0.03683944046497345
current test mse: 0.036839
Iteration: 1091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492666721343994, gen p mean: -0.5981653332710266, mean p set: 0.4497469365596771
loss_pred:0.030133089050650597, decouple_loss:0.0184865090996027
The modified gen p mean: 0.44981926679611206, gen p mean: -0.6020698547363281, mean p set: 0.45029953122138977The modified gen p mean: 0.44908952713012695, gen p mean: -0.6015969514846802, mean p set: 0.44956985116004944
loss_pred:0.030006378889083862, decouple_loss:0.020234249532222748
loss_pred:0.03060557320713997, decouple_loss:0.02042371779680252
Iteration: 1092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930392503738403, gen p mean: -0.6016594767570496, mean p set: 0.4497842490673065
loss_pred:0.029780326411128044, decouple_loss:0.01845209114253521
The modified gen p mean: 0.4501987397670746, gen p mean: -0.6009384393692017, mean p set: 0.4506790041923523The modified gen p mean: 0.45103469491004944, gen p mean: -0.6147399544715881, mean p set: 0.45151498913764954
loss_pred:0.02969495765864849, decouple_loss:0.01911437138915062
loss_pred:0.03103679046034813, decouple_loss:0.02110825665295124
Iteration: 1093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495488703250885, gen p mean: -0.6151539087295532, mean p set: 0.4500291645526886
The modified gen p mean: 0.44988730549812317, gen p mean: -0.6172577738761902, mean p set: 0.45036759972572327
loss_pred:0.02999873459339142, decouple_loss:0.019059021025896072
loss_pred:0.030612504109740257, decouple_loss:0.019495058804750443
The modified gen p mean: 0.44896265864372253, gen p mean: -0.605873167514801, mean p set: 0.44944292306900024
loss_pred:0.030102375894784927, decouple_loss:0.019655819982290268
Iteration: 1094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979918003082275, gen p mean: -0.620130717754364, mean p set: 0.45027947425842285
loss_pred:0.029948826879262924, decouple_loss:0.018289756029844284
The modified gen p mean: 0.45027145743370056, gen p mean: -0.6207478642463684, mean p set: 0.45075175166130066The modified gen p mean: 0.4499701261520386, gen p mean: -0.6256201863288879, mean p set: 0.45045042037963867
loss_pred:0.03170354291796684, decouple_loss:0.020466284826397896
loss_pred:0.03012130968272686, decouple_loss:0.01869548112154007
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 1095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962185621261597, gen p mean: -0.6250874996185303, mean p set: 0.4501021206378937
loss_pred:0.03050149977207184, decouple_loss:0.020775217562913895
The modified gen p mean: 0.447750449180603, gen p mean: -0.6248262524604797, mean p set: 0.4482307732105255The modified gen p mean: 0.4486162066459656, gen p mean: -0.6267363429069519, mean p set: 0.4490965008735657
loss_pred:0.03161031752824783, decouple_loss:0.020259598270058632
loss_pred:0.030013972893357277, decouple_loss:0.020188400521874428
Iteration: 1096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508858025074005, gen p mean: -0.6211183071136475, mean p set: 0.4513660967350006
loss_pred:0.03131222724914551, decouple_loss:0.019394997507333755
The modified gen p mean: 0.44756534695625305, gen p mean: -0.6202194690704346, mean p set: 0.44804564118385315The modified gen p mean: 0.4487621486186981, gen p mean: -0.6166902184486389, mean p set: 0.4492424428462982
loss_pred:0.030216850340366364, decouple_loss:0.018951328471302986
loss_pred:0.03089754655957222, decouple_loss:0.02164274826645851
Iteration: 1097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465106725692749, gen p mean: -0.6162906885147095, mean p set: 0.446990966796875
loss_pred:0.030546363443136215, decouple_loss:0.021016927435994148
The modified gen p mean: 0.4473828077316284, gen p mean: -0.6136265993118286, mean p set: 0.4478631317615509The modified gen p mean: 0.4477930963039398, gen p mean: -0.6157546043395996, mean p set: 0.4482734203338623
loss_pred:0.030393946915864944, decouple_loss:0.019748209044337273
loss_pred:0.029925884678959846, decouple_loss:0.01938309334218502
Iteration: 1098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835537672042847, gen p mean: -0.616751492023468, mean p set: 0.44883567094802856
loss_pred:0.03179972246289253, decouple_loss:0.019085003063082695
The modified gen p mean: 0.4476674199104309, gen p mean: -0.6196259260177612, mean p set: 0.4481477439403534The modified gen p mean: 0.4475911557674408, gen p mean: -0.6167593598365784, mean p set: 0.4480714499950409
loss_pred:0.03197329863905907, decouple_loss:0.01920044794678688
loss_pred:0.02917393296957016, decouple_loss:0.018578821793198586
Iteration: 1099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482864737510681, gen p mean: -0.630893349647522, mean p set: 0.4487667679786682
loss_pred:0.03016059473156929, decouple_loss:0.019111283123493195
The modified gen p mean: 0.44847527146339417, gen p mean: -0.6295039057731628, mean p set: 0.44895556569099426The modified gen p mean: 0.4494085907936096, gen p mean: -0.6283655166625977, mean p set: 0.44988885521888733
loss_pred:0.031204193830490112, decouple_loss:0.01960696280002594
loss_pred:0.03163713216781616, decouple_loss:0.020120952278375626
Iteration: 1100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727641344070435, gen p mean: -0.6313392519950867, mean p set: 0.44775673747062683
loss_pred:0.030310112982988358, decouple_loss:0.019583435729146004
The modified gen p mean: 0.44935524463653564, gen p mean: -0.6238318681716919, mean p set: 0.44983553886413574The modified gen p mean: 0.44810235500335693, gen p mean: -0.6297849416732788, mean p set: 0.4485826790332794
loss_pred:0.0304082203656435, decouple_loss:0.019593356177210808
loss_pred:0.03060380555689335, decouple_loss:0.01992158591747284
2023-05-01 20:00:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6311613321304321, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.62196284532547, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6254942417144775, mean p set: 0.4500633478164673
loss_pred:0.0322612039744854, decouple_loss:0.020159345120191574
loss_pred:0.030565481632947922, decouple_loss:0.019749125465750694
loss_pred:0.031304746866226196, decouple_loss:0.019641365855932236
WV_0_PC_1_EH_0_PS_40_5, loss: 0.032369643449783325, avg_mse: 0.03639598190784454
current test mse: 0.036396
Iteration: 1101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761237502098083, gen p mean: -0.6256958246231079, mean p set: 0.44809263944625854
loss_pred:0.030977824702858925, decouple_loss:0.0199657641351223
The modified gen p mean: 0.44865861535072327, gen p mean: -0.6176242828369141, mean p set: 0.44913890957832336The modified gen p mean: 0.4481760263442993, gen p mean: -0.6266463398933411, mean p set: 0.4486563205718994
loss_pred:0.03000551089644432, decouple_loss:0.01979335956275463
loss_pred:0.030702995136380196, decouple_loss:0.018552618101239204
Iteration: 1102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475422203540802, gen p mean: -0.6185793876647949, mean p set: 0.4480225145816803
loss_pred:0.031019320711493492, decouple_loss:0.01975986547768116
The modified gen p mean: 0.4487472176551819, gen p mean: -0.6210713982582092, mean p set: 0.4492274820804596The modified gen p mean: 0.44796422123908997, gen p mean: -0.6248422861099243, mean p set: 0.44844454526901245
loss_pred:0.03067896142601967, decouple_loss:0.019823240116238594
loss_pred:0.030214693397283554, decouple_loss:0.019880298525094986
Iteration: 1103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465603828430176, gen p mean: -0.6136386394500732, mean p set: 0.44704070687294006
The modified gen p mean: 0.4484059512615204, gen p mean: -0.6157414317131042, mean p set: 0.4488862454891205
loss_pred:0.029664557427167892, decouple_loss:0.019925948232412338
loss_pred:0.031386248767375946, decouple_loss:0.018890267238020897
The modified gen p mean: 0.44923391938209534, gen p mean: -0.6188541650772095, mean p set: 0.44971415400505066
loss_pred:0.03103005327284336, decouple_loss:0.020691480487585068
Iteration: 1104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467921555042267, gen p mean: -0.616083562374115, mean p set: 0.4472724497318268
loss_pred:0.0307770986109972, decouple_loss:0.018545400351285934
The modified gen p mean: 0.44837528467178345, gen p mean: -0.6141204833984375, mean p set: 0.44885557889938354The modified gen p mean: 0.4487915635108948, gen p mean: -0.616492509841919, mean p set: 0.4492718279361725
loss_pred:0.03020130842924118, decouple_loss:0.01817389205098152
loss_pred:0.03051755018532276, decouple_loss:0.01932171918451786
Iteration: 1105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482608735561371, gen p mean: -0.6185156106948853, mean p set: 0.4487411379814148
loss_pred:0.029103053733706474, decouple_loss:0.018912464380264282
The modified gen p mean: 0.44818660616874695, gen p mean: -0.6174765825271606, mean p set: 0.44866693019866943The modified gen p mean: 0.4502047300338745, gen p mean: -0.6145631074905396, mean p set: 0.450685054063797
loss_pred:0.03082815557718277, decouple_loss:0.018641460686922073
loss_pred:0.030359037220478058, decouple_loss:0.01840592361986637
Iteration: 1106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828712940216064, gen p mean: -0.6106157302856445, mean p set: 0.44876742362976074
loss_pred:0.03080766834318638, decouple_loss:0.0189146026968956
The modified gen p mean: 0.44732072949409485, gen p mean: -0.609613299369812, mean p set: 0.44780102372169495The modified gen p mean: 0.4487207233905792, gen p mean: -0.6136153340339661, mean p set: 0.44920095801353455
loss_pred:0.030430840328335762, decouple_loss:0.018020926043391228
loss_pred:0.031023746356368065, decouple_loss:0.018893685191869736
Iteration: 1107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707104563713074, gen p mean: -0.6178479790687561, mean p set: 0.44755133986473083
loss_pred:0.029457909986376762, decouple_loss:0.017925770953297615
The modified gen p mean: 0.4477776288986206, gen p mean: -0.6146142482757568, mean p set: 0.4482579529285431The modified gen p mean: 0.4483461380004883, gen p mean: -0.6200153231620789, mean p set: 0.4488264322280884
loss_pred:0.030457567423582077, decouple_loss:0.017834564670920372
loss_pred:0.029971174895763397, decouple_loss:0.017902348190546036
Iteration: 1108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748514890670776, gen p mean: -0.6200479865074158, mean p set: 0.44796544313430786
loss_pred:0.03082559071481228, decouple_loss:0.018526868894696236
The modified gen p mean: 0.44648703932762146, gen p mean: -0.6137873530387878, mean p set: 0.44696733355522156The modified gen p mean: 0.448636531829834, gen p mean: -0.6179713010787964, mean p set: 0.4491168260574341
loss_pred:0.029441695660352707, decouple_loss:0.018233558163046837
loss_pred:0.031128011643886566, decouple_loss:0.018506450578570366
Iteration: 1109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788697361946106, gen p mean: -0.6293855309486389, mean p set: 0.44836726784706116
loss_pred:0.029255956411361694, decouple_loss:0.017576705664396286
The modified gen p mean: 0.4481053054332733, gen p mean: -0.6263163089752197, mean p set: 0.4485855996608734The modified gen p mean: 0.4488387405872345, gen p mean: -0.6258372068405151, mean p set: 0.449319064617157
loss_pred:0.031027568504214287, decouple_loss:0.018166566267609596
loss_pred:0.03079705312848091, decouple_loss:0.018800556659698486
Iteration: 1110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483340084552765, gen p mean: -0.6267832517623901, mean p set: 0.4488143026828766
loss_pred:0.03048618696630001, decouple_loss:0.01842867024242878
The modified gen p mean: 0.4479285776615143, gen p mean: -0.6306639313697815, mean p set: 0.448408842086792
The modified gen p mean: 0.4463944733142853, gen p mean: -0.6260355710983276, mean p set: 0.4468747675418854
loss_pred:0.031150471419095993, decouple_loss:0.01809103414416313
loss_pred:0.03068084642291069, decouple_loss:0.01857607811689377
2023-05-01 20:03:03 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6301299333572388, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.619672417640686, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6233578324317932, mean p set: 0.4500633478164673
loss_pred:0.03185777738690376, decouple_loss:0.019141029566526413
loss_pred:0.030165398493409157, decouple_loss:0.019049931317567825
loss_pred:0.030835067853331566, decouple_loss:0.01880037412047386
WV_0_PC_1_EH_0_PS_40_5, loss: 0.031902603805065155, avg_mse: 0.03576388210058212
current test mse: 0.035764
Iteration: 1111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448758602142334, gen p mean: -0.620112419128418, mean p set: 0.4492388665676117
loss_pred:0.02944761887192726, decouple_loss:0.018129738047719002
The modified gen p mean: 0.44871824979782104, gen p mean: -0.6217209100723267, mean p set: 0.44919851422309875The modified gen p mean: 0.44850486516952515, gen p mean: -0.6160048842430115, mean p set: 0.44898515939712524
loss_pred:0.030922170728445053, decouple_loss:0.018176591023802757
loss_pred:0.029773786664009094, decouple_loss:0.018442222848534584
Iteration: 1112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480462074279785, gen p mean: -0.6236766576766968, mean p set: 0.4485265016555786
loss_pred:0.029726848006248474, decouple_loss:0.01901727356016636
The modified gen p mean: 0.4483143091201782, gen p mean: -0.6225345134735107, mean p set: 0.44879457354545593The modified gen p mean: 0.44806262850761414, gen p mean: -0.6208417415618896, mean p set: 0.44854292273521423
loss_pred:0.03053446114063263, decouple_loss:0.018385520204901695
loss_pred:0.029961448162794113, decouple_loss:0.01779191568493843
Iteration: 1113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478696584701538, gen p mean: -0.6368967294692993, mean p set: 0.4483499228954315
The modified gen p mean: 0.4482540488243103, gen p mean: -0.632632851600647, mean p set: 0.4487343728542328
loss_pred:0.029395543038845062, decouple_loss:0.018178613856434822
loss_pred:0.031649112701416016, decouple_loss:0.018817007541656494
The modified gen p mean: 0.44782358407974243, gen p mean: -0.6308725476264954, mean p set: 0.44830387830734253
loss_pred:0.0318642295897007, decouple_loss:0.01875101774930954
Iteration: 1114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018261671066284, gen p mean: -0.6334720849990845, mean p set: 0.45066288113594055
loss_pred:0.030536523088812828, decouple_loss:0.01805996708571911
The modified gen p mean: 0.44615504145622253, gen p mean: -0.6289774179458618, mean p set: 0.44663533568382263The modified gen p mean: 0.4490843415260315, gen p mean: -0.6351365447044373, mean p set: 0.4495646357536316
loss_pred:0.029854491353034973, decouple_loss:0.018355589359998703
loss_pred:0.030283592641353607, decouple_loss:0.017711594700813293
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
NaN value num: 0
Iteration: 1115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498252868652344, gen p mean: -0.6176955103874207, mean p set: 0.4503055810928345
loss_pred:0.03170493245124817, decouple_loss:0.01991976983845234
The modified gen p mean: 0.450557142496109, gen p mean: -0.6182318925857544, mean p set: 0.4510374367237091The modified gen p mean: 0.44871675968170166, gen p mean: -0.6177976727485657, mean p set: 0.44919705390930176
loss_pred:0.030557792633771896, decouple_loss:0.021156053990125656
loss_pred:0.03098199889063835, decouple_loss:0.01948537677526474
Iteration: 1116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997620582580566, gen p mean: -0.6211124062538147, mean p set: 0.45045650005340576
loss_pred:0.030507434159517288, decouple_loss:0.020267484709620476
The modified gen p mean: 0.45013532042503357, gen p mean: -0.6208351254463196, mean p set: 0.45061561465263367The modified gen p mean: 0.45012331008911133, gen p mean: -0.6166115403175354, mean p set: 0.4506036043167114
loss_pred:0.03149620071053505, decouple_loss:0.019386405125260353
loss_pred:0.030334964394569397, decouple_loss:0.01852162554860115
Iteration: 1117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485177993774414, gen p mean: -0.622875452041626, mean p set: 0.4489981234073639
loss_pred:0.03040708415210247, decouple_loss:0.020470647141337395
The modified gen p mean: 0.4519200921058655, gen p mean: -0.6272388696670532, mean p set: 0.4524003565311432The modified gen p mean: 0.44959649443626404, gen p mean: -0.6317731142044067, mean p set: 0.45007678866386414
loss_pred:0.030861927196383476, decouple_loss:0.019628243520855904
loss_pred:0.031692564487457275, decouple_loss:0.018903881311416626
Iteration: 1118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097795128822327, gen p mean: -0.6237438917160034, mean p set: 0.451458215713501
loss_pred:0.03089543804526329, decouple_loss:0.018881918862462044
The modified gen p mean: 0.44792625308036804, gen p mean: -0.6184099912643433, mean p set: 0.44840651750564575The modified gen p mean: 0.45057055354118347, gen p mean: -0.6198804974555969, mean p set: 0.45105084776878357
loss_pred:0.031675275415182114, decouple_loss:0.020406067371368408
loss_pred:0.03106781281530857, decouple_loss:0.020881598815321922
Iteration: 1119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496047794818878, gen p mean: -0.6197881698608398, mean p set: 0.4500850439071655
loss_pred:0.031406860798597336, decouple_loss:0.0182622279971838
The modified gen p mean: 0.44886693358421326, gen p mean: -0.6181490421295166, mean p set: 0.44934722781181335
The modified gen p mean: 0.449876070022583, gen p mean: -0.6247211694717407, mean p set: 0.4503563344478607
loss_pred:0.030913593247532845, decouple_loss:0.01842871680855751
loss_pred:0.029842106625437737, decouple_loss:0.01902516558766365
Iteration: 1120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044204592704773, gen p mean: -0.6128864288330078, mean p set: 0.4509223401546478
loss_pred:0.03017302416265011, decouple_loss:0.01911189965903759
The modified gen p mean: 0.44952043890953064, gen p mean: -0.6161563396453857, mean p set: 0.45000073313713074The modified gen p mean: 0.44996973872184753, gen p mean: -0.6224484443664551, mean p set: 0.45045000314712524
loss_pred:0.031331777572631836, decouple_loss:0.01845642924308777
loss_pred:0.030788276344537735, decouple_loss:0.01824617013335228
2023-05-01 20:05:47 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6351123452186584, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6249305605888367, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6292585134506226, mean p set: 0.4500633478164673
loss_pred:0.03223400563001633, decouple_loss:0.022395964711904526
loss_pred:0.03043983317911625, decouple_loss:0.02200900949537754
loss_pred:0.031126363202929497, decouple_loss:0.02120286598801613
WV_0_PC_1_EH_0_PS_40_5, loss: 0.032360199838876724, avg_mse: 0.036330439150333405
current test mse: 0.03633
Iteration: 1121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506303369998932, gen p mean: -0.6211164593696594, mean p set: 0.4511106312274933
loss_pred:0.031060943379998207, decouple_loss:0.01894390396773815
The modified gen p mean: 0.4496050179004669, gen p mean: -0.6265525817871094, mean p set: 0.450085312128067The modified gen p mean: 0.4523296058177948, gen p mean: -0.6261557936668396, mean p set: 0.4528099000453949
loss_pred:0.029816871508955956, decouple_loss:0.018532298505306244
loss_pred:0.030360780656337738, decouple_loss:0.01866154745221138
Iteration: 1122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477386474609375, gen p mean: -0.6281978487968445, mean p set: 0.4482189118862152
The modified gen p mean: 0.4488801956176758, gen p mean: -0.6334588527679443, mean p set: 0.44936051964759827
loss_pred:0.03155415505170822, decouple_loss:0.019456548616290092
loss_pred:0.030193740501999855, decouple_loss:0.018746448680758476
The modified gen p mean: 0.44888386130332947, gen p mean: -0.6263189315795898, mean p set: 0.4493641257286072
loss_pred:0.029908088967204094, decouple_loss:0.01901322603225708
Iteration: 1123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502688944339752, gen p mean: -0.6240384578704834, mean p set: 0.4507491886615753
loss_pred:0.030812866985797882, decouple_loss:0.02020569145679474
The modified gen p mean: 0.451249897480011, gen p mean: -0.6305192112922668, mean p set: 0.4517301619052887The modified gen p mean: 0.4484577775001526, gen p mean: -0.6402042508125305, mean p set: 0.4489381015300751
loss_pred:0.030701162293553352, decouple_loss:0.020090065896511078
loss_pred:0.030231628566980362, decouple_loss:0.019078388810157776
Iteration: 1124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855111837387085, gen p mean: -0.6301212310791016, mean p set: 0.44903138279914856
loss_pred:0.03072000853717327, decouple_loss:0.018981626257300377
The modified gen p mean: 0.45041823387145996, gen p mean: -0.6198476552963257, mean p set: 0.45089852809906006The modified gen p mean: 0.44812336564064026, gen p mean: -0.6243435144424438, mean p set: 0.44860365986824036
loss_pred:0.030631715431809425, decouple_loss:0.01886570081114769
loss_pred:0.030870936810970306, decouple_loss:0.019247736781835556
Iteration: 1125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817909598350525, gen p mean: -0.6334340572357178, mean p set: 0.44865939021110535
loss_pred:0.030615471303462982, decouple_loss:0.018556760624051094
The modified gen p mean: 0.4503604471683502, gen p mean: -0.634635329246521, mean p set: 0.45084071159362793The modified gen p mean: 0.44906988739967346, gen p mean: -0.6316092610359192, mean p set: 0.44955018162727356
loss_pred:0.030624644830822945, decouple_loss:0.01813298836350441
loss_pred:0.029330028221011162, decouple_loss:0.01889580488204956
Iteration: 1126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449848473072052, gen p mean: -0.6393935680389404, mean p set: 0.4503287672996521
The modified gen p mean: 0.4481624364852905, gen p mean: -0.633464515209198, mean p set: 0.448642760515213
loss_pred:0.0314825214445591, decouple_loss:0.018100447952747345
loss_pred:0.031456947326660156, decouple_loss:0.017948755994439125
The modified gen p mean: 0.45000165700912476, gen p mean: -0.6390405297279358, mean p set: 0.45048198103904724
loss_pred:0.030182473361492157, decouple_loss:0.01832422986626625
Iteration: 1127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065709948539734, gen p mean: -0.6455822587013245, mean p set: 0.45113739371299744
loss_pred:0.03037591278553009, decouple_loss:0.019237549975514412
The modified gen p mean: 0.45015621185302734, gen p mean: -0.6458356976509094, mean p set: 0.45063650608062744The modified gen p mean: 0.44977954030036926, gen p mean: -0.6472855806350708, mean p set: 0.45025986433029175
loss_pred:0.030322091653943062, decouple_loss:0.01779462955892086
loss_pred:0.0308043472468853, decouple_loss:0.01826978661119938
Iteration: 1128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471310079097748, gen p mean: -0.6484038829803467, mean p set: 0.4476113021373749
loss_pred:0.031546492129564285, decouple_loss:0.018815219402313232
The modified gen p mean: 0.44882023334503174, gen p mean: -0.6572151184082031, mean p set: 0.44930049777030945The modified gen p mean: 0.44890162348747253, gen p mean: -0.6493438482284546, mean p set: 0.44938188791275024
loss_pred:0.030254743993282318, decouple_loss:0.018877701833844185
loss_pred:0.029655596241354942, decouple_loss:0.017746025696396828
Iteration: 1129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028096437454224, gen p mean: -0.6502646207809448, mean p set: 0.45076125860214233
loss_pred:0.03004503808915615, decouple_loss:0.017613068222999573
The modified gen p mean: 0.4481627643108368, gen p mean: -0.6432949304580688, mean p set: 0.4486430585384369The modified gen p mean: 0.44763854146003723, gen p mean: -0.6510223150253296, mean p set: 0.44811883568763733
loss_pred:0.030461331829428673, decouple_loss:0.01851171813905239
loss_pred:0.03020700067281723, decouple_loss:0.01901840791106224
Iteration: 1130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497251510620117, gen p mean: -0.6359250545501709, mean p set: 0.4502054452896118
loss_pred:0.03069474920630455, decouple_loss:0.01818481832742691
The modified gen p mean: 0.44958481192588806, gen p mean: -0.6343460083007812, mean p set: 0.45006507635116577The modified gen p mean: 0.4492427706718445, gen p mean: -0.6297611594200134, mean p set: 0.4497230648994446
loss_pred:0.030788255855441093, decouple_loss:0.01782286912202835
loss_pred:0.03156496584415436, decouple_loss:0.017953814938664436
2023-05-01 20:07:56 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6359765529632568, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6258607506752014, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6298450231552124, mean p set: 0.4500633478164673
loss_pred:0.03222959488630295, decouple_loss:0.02063537761569023
loss_pred:0.03049028106033802, decouple_loss:0.020456312224268913
loss_pred:0.031101863831281662, decouple_loss:0.01981736719608307
WV_0_PC_1_EH_0_PS_40_5, loss: 0.032289065420627594, avg_mse: 0.036395587027072906
current test mse: 0.036396
Iteration: 1131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481503665447235, gen p mean: -0.6309133172035217, mean p set: 0.448630690574646
The modified gen p mean: 0.4494689106941223, gen p mean: -0.6319011449813843, mean p set: 0.4499492049217224
loss_pred:0.029665222391486168, decouple_loss:0.017436940222978592
The modified gen p mean: 0.4495719373226166, gen p mean: -0.6268853545188904, mean p set: 0.45005226135253906
loss_pred:0.029610902070999146, decouple_loss:0.018329231068491936
loss_pred:0.031152961775660515, decouple_loss:0.017256757244467735
Iteration: 1132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779255986213684, gen p mean: -0.6375858187675476, mean p set: 0.44827285408973694
loss_pred:0.03094886615872383, decouple_loss:0.017969772219657898
The modified gen p mean: 0.450179785490036, gen p mean: -0.6376954317092896, mean p set: 0.4506600499153137The modified gen p mean: 0.44883424043655396, gen p mean: -0.6345502734184265, mean p set: 0.44931453466415405
loss_pred:0.03093470260500908, decouple_loss:0.017850788310170174
loss_pred:0.0311269611120224, decouple_loss:0.01784660667181015
Iteration: 1133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793641567230225, gen p mean: -0.640533983707428, mean p set: 0.44841670989990234
loss_pred:0.03015691041946411, decouple_loss:0.017942726612091064
The modified gen p mean: 0.4504495859146118, gen p mean: -0.6373936533927917, mean p set: 0.4509299099445343The modified gen p mean: 0.4503643810749054, gen p mean: -0.6334952712059021, mean p set: 0.4508446753025055
loss_pred:0.030359545722603798, decouple_loss:0.018352901563048363
loss_pred:0.030241988599300385, decouple_loss:0.018962454050779343
Iteration: 1134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891878962516785, gen p mean: -0.6387900114059448, mean p set: 0.44939908385276794
The modified gen p mean: 0.4479113817214966, gen p mean: -0.6334125995635986, mean p set: 0.4483916759490967
loss_pred:0.02973639965057373, decouple_loss:0.017930567264556885
loss_pred:0.031157517805695534, decouple_loss:0.01870882883667946
The modified gen p mean: 0.4493057429790497, gen p mean: -0.6436065435409546, mean p set: 0.4497860372066498
loss_pred:0.031162114813923836, decouple_loss:0.017817916348576546
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
NaN value num: 0
Iteration: 1135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033878087997437, gen p mean: -0.6503536105155945, mean p set: 0.45081907510757446
loss_pred:0.03141125291585922, decouple_loss:0.022672776132822037
The modified gen p mean: 0.4498160183429718, gen p mean: -0.6397321224212646, mean p set: 0.4502963423728943The modified gen p mean: 0.4491064250469208, gen p mean: -0.6466411352157593, mean p set: 0.44958674907684326
loss_pred:0.03110414929687977, decouple_loss:0.020308464765548706
loss_pred:0.031837210059165955, decouple_loss:0.021597618237137794
Iteration: 1136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019635558128357, gen p mean: -0.6509914398193359, mean p set: 0.4506766200065613
The modified gen p mean: 0.4486198127269745, gen p mean: -0.6447823643684387, mean p set: 0.4491001069545746
loss_pred:0.03158154338598251, decouple_loss:0.02412034012377262
loss_pred:0.031177375465631485, decouple_loss:0.021440763026475906
The modified gen p mean: 0.4498403072357178, gen p mean: -0.6458854675292969, mean p set: 0.4503205716609955
loss_pred:0.031332988291978836, decouple_loss:0.02208021469414234
Iteration: 1137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45064085721969604, gen p mean: -0.6440545320510864, mean p set: 0.45112112164497375
The modified gen p mean: 0.45036378502845764, gen p mean: -0.6333072781562805, mean p set: 0.45084407925605774
loss_pred:0.03062860667705536, decouple_loss:0.021608296781778336
loss_pred:0.03201615437865257, decouple_loss:0.02063431777060032
The modified gen p mean: 0.4474261403083801, gen p mean: -0.6364578604698181, mean p set: 0.4479064345359802
loss_pred:0.031483929604291916, decouple_loss:0.02040513977408409
Iteration: 1138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506102502346039, gen p mean: -0.6513196229934692, mean p set: 0.451090544462204
loss_pred:0.030055200681090355, decouple_loss:0.02075488492846489
The modified gen p mean: 0.4509217441082001, gen p mean: -0.6533651947975159, mean p set: 0.4514020085334778The modified gen p mean: 0.45072245597839355, gen p mean: -0.6541144251823425, mean p set: 0.45120275020599365
loss_pred:0.03155845031142235, decouple_loss:0.020519645884633064
loss_pred:0.030282899737358093, decouple_loss:0.020490342751145363
Iteration: 1139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509749412536621, gen p mean: -0.6521844267845154, mean p set: 0.4514552056789398
The modified gen p mean: 0.44902825355529785, gen p mean: -0.6454830169677734, mean p set: 0.4495084881782532
loss_pred:0.03157900646328926, decouple_loss:0.019359663128852844
loss_pred:0.03113517351448536, decouple_loss:0.01986643485724926
The modified gen p mean: 0.4503541588783264, gen p mean: -0.652867317199707, mean p set: 0.4508344829082489
loss_pred:0.030688928440213203, decouple_loss:0.019213173538446426
Iteration: 1140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488906264305115, gen p mean: -0.6452009677886963, mean p set: 0.4493708908557892
The modified gen p mean: 0.4493255913257599, gen p mean: -0.6442380547523499, mean p set: 0.4498059153556824
loss_pred:0.03245113417506218, decouple_loss:0.019036661833524704
loss_pred:0.03230879455804825, decouple_loss:0.019489318132400513
The modified gen p mean: 0.4502987563610077, gen p mean: -0.646070122718811, mean p set: 0.4507790505886078
loss_pred:0.03155381232500076, decouple_loss:0.01991213485598564
2023-05-01 20:10:42 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6429716944694519, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6330972909927368, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6368792057037354, mean p set: 0.4500633478164673
loss_pred:0.03241235017776489, decouple_loss:0.022161176428198814
loss_pred:0.030803972855210304, decouple_loss:0.02178347110748291
loss_pred:0.03132466971874237, decouple_loss:0.021413711830973625
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03260296955704689, avg_mse: 0.03660459816455841
current test mse: 0.036605
Iteration: 1141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862785935401917, gen p mean: -0.6388946771621704, mean p set: 0.44910821318626404
loss_pred:0.03194211423397064, decouple_loss:0.019749483093619347
The modified gen p mean: 0.4507967233657837, gen p mean: -0.6477439999580383, mean p set: 0.4512770175933838The modified gen p mean: 0.4503313899040222, gen p mean: -0.637356162071228, mean p set: 0.4508116841316223
loss_pred:0.03152560442686081, decouple_loss:0.019949257373809814
loss_pred:0.031437039375305176, decouple_loss:0.019985906779766083
Iteration: 1142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507297873497009, gen p mean: -0.640938937664032, mean p set: 0.451210081577301
loss_pred:0.031488288193941116, decouple_loss:0.019332414492964745
The modified gen p mean: 0.44987475872039795, gen p mean: -0.6440008878707886, mean p set: 0.45035505294799805The modified gen p mean: 0.45121094584465027, gen p mean: -0.6363630890846252, mean p set: 0.451691210269928
loss_pred:0.03146415576338768, decouple_loss:0.02032622881233692
loss_pred:0.031098531559109688, decouple_loss:0.019251631572842598
Iteration: 1143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450836181640625, gen p mean: -0.6249588131904602, mean p set: 0.4513164758682251
loss_pred:0.031215935945510864, decouple_loss:0.019260436296463013
The modified gen p mean: 0.45086777210235596, gen p mean: -0.6338292956352234, mean p set: 0.45134806632995605The modified gen p mean: 0.4506271183490753, gen p mean: -0.6364771127700806, mean p set: 0.451107382774353
loss_pred:0.030652232468128204, decouple_loss:0.019966328516602516
loss_pred:0.029943019151687622, decouple_loss:0.020213039591908455
Iteration: 1144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493718445301056, gen p mean: -0.6306127905845642, mean p set: 0.4498521387577057
loss_pred:0.03278946131467819, decouple_loss:0.020491190254688263
The modified gen p mean: 0.4491533041000366, gen p mean: -0.6254960298538208, mean p set: 0.4496335983276367The modified gen p mean: 0.4504632353782654, gen p mean: -0.6332410573959351, mean p set: 0.4509435296058655
loss_pred:0.029983043670654297, decouple_loss:0.02000584453344345
loss_pred:0.031205585226416588, decouple_loss:0.019501619040966034
Iteration: 1145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914960861206055, gen p mean: -0.6342803835868835, mean p set: 0.44962990283966064
loss_pred:0.032568931579589844, decouple_loss:0.01929166540503502
The modified gen p mean: 0.4492439329624176, gen p mean: -0.6346959471702576, mean p set: 0.4497242569923401The modified gen p mean: 0.44861987233161926, gen p mean: -0.6363173723220825, mean p set: 0.44910016655921936
loss_pred:0.032186031341552734, decouple_loss:0.01896386779844761
loss_pred:0.03118273802101612, decouple_loss:0.019168725237250328
Iteration: 1146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492305517196655, gen p mean: -0.637264609336853, mean p set: 0.449710875749588
loss_pred:0.0319574698805809, decouple_loss:0.01858603209257126
The modified gen p mean: 0.44876593351364136, gen p mean: -0.6421585083007812, mean p set: 0.44924622774124146The modified gen p mean: 0.4504499137401581, gen p mean: -0.6557613611221313, mean p set: 0.4509302079677582
loss_pred:0.031028904020786285, decouple_loss:0.019031530246138573
loss_pred:0.03069712594151497, decouple_loss:0.020807983353734016
Iteration: 1147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502499997615814, gen p mean: -0.639022946357727, mean p set: 0.4507302939891815
loss_pred:0.0313262976706028, decouple_loss:0.020764395594596863
The modified gen p mean: 0.45089563727378845, gen p mean: -0.6446924805641174, mean p set: 0.45137593150138855The modified gen p mean: 0.4498802423477173, gen p mean: -0.6318163871765137, mean p set: 0.4503605365753174
loss_pred:0.030882548540830612, decouple_loss:0.019423801451921463
loss_pred:0.031671956181526184, decouple_loss:0.020094862207770348
Iteration: 1148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509281516075134, gen p mean: -0.6332502365112305, mean p set: 0.45140841603279114
loss_pred:0.03112681768834591, decouple_loss:0.01922052539885044
The modified gen p mean: 0.4498560428619385, gen p mean: -0.6291085481643677, mean p set: 0.4503363370895386The modified gen p mean: 0.45071253180503845, gen p mean: -0.633859395980835, mean p set: 0.45119279623031616
loss_pred:0.031622264534235, decouple_loss:0.018578238785266876
loss_pred:0.030119305476546288, decouple_loss:0.018944120034575462
Iteration: 1149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505431056022644, gen p mean: -0.6376361846923828, mean p set: 0.4510233402252197
loss_pred:0.031072018668055534, decouple_loss:0.0180056132376194
The modified gen p mean: 0.4486290216445923, gen p mean: -0.6276875734329224, mean p set: 0.4491093158721924The modified gen p mean: 0.4475768506526947, gen p mean: -0.6273806095123291, mean p set: 0.4480571150779724
loss_pred:0.03170488029718399, decouple_loss:0.019187312573194504
loss_pred:0.030964165925979614, decouple_loss:0.01886538602411747
Iteration: 1150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930556416511536, gen p mean: -0.638488233089447, mean p set: 0.44978588819503784
loss_pred:0.032256126403808594, decouple_loss:0.01846862956881523
The modified gen p mean: 0.450664222240448, gen p mean: -0.6440420746803284, mean p set: 0.4511445164680481The modified gen p mean: 0.4501218795776367, gen p mean: -0.6452623009681702, mean p set: 0.45060214400291443
loss_pred:0.031237298622727394, decouple_loss:0.01910727471113205
loss_pred:0.031157469376921654, decouple_loss:0.01921609602868557
2023-05-01 20:12:50 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6432086825370789, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6329218745231628, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6373526453971863, mean p set: 0.4500633478164673
loss_pred:0.03196495398879051, decouple_loss:0.021137645468115807
loss_pred:0.030289964750409126, decouple_loss:0.02071450836956501loss_pred:0.03087247535586357, decouple_loss:0.020243998616933823
WV_0_PC_1_EH_0_PS_40_5, loss: 0.032077401876449585, avg_mse: 0.03617912903428078
current test mse: 0.036179
Iteration: 1151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018118619918823, gen p mean: -0.6482977271080017, mean p set: 0.45066148042678833
loss_pred:0.03030361607670784, decouple_loss:0.018982021138072014
The modified gen p mean: 0.45143356919288635, gen p mean: -0.6470204591751099, mean p set: 0.45191389322280884The modified gen p mean: 0.45021581649780273, gen p mean: -0.657260000705719, mean p set: 0.45069611072540283
loss_pred:0.030492432415485382, decouple_loss:0.01846865750849247
loss_pred:0.030399492010474205, decouple_loss:0.019004642963409424
Iteration: 1152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508408308029175, gen p mean: -0.641766369342804, mean p set: 0.4513210952281952
loss_pred:0.03026556223630905, decouple_loss:0.01824531890451908
The modified gen p mean: 0.4487893879413605, gen p mean: -0.6343713998794556, mean p set: 0.4492696523666382The modified gen p mean: 0.4502269923686981, gen p mean: -0.6454506516456604, mean p set: 0.4507073163986206
loss_pred:0.03083510510623455, decouple_loss:0.018052563071250916
loss_pred:0.031134458258748055, decouple_loss:0.019312484189867973
Iteration: 1153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977468252182007, gen p mean: -0.6287709474563599, mean p set: 0.45025497674942017
loss_pred:0.031062865629792213, decouple_loss:0.018346354365348816
The modified gen p mean: 0.45106905698776245, gen p mean: -0.6391491889953613, mean p set: 0.45154935121536255The modified gen p mean: 0.4497581422328949, gen p mean: -0.6271246671676636, mean p set: 0.450238436460495
loss_pred:0.03147691488265991, decouple_loss:0.018012652173638344
loss_pred:0.031152455136179924, decouple_loss:0.019861888140439987
Iteration: 1154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497682750225067, gen p mean: -0.6194271445274353, mean p set: 0.4502485692501068
loss_pred:0.031100157648324966, decouple_loss:0.01867690123617649
The modified gen p mean: 0.45052289962768555, gen p mean: -0.6252999901771545, mean p set: 0.45100319385528564The modified gen p mean: 0.45012760162353516, gen p mean: -0.6270027160644531, mean p set: 0.45060789585113525
loss_pred:0.030149849131703377, decouple_loss:0.018752260133624077
loss_pred:0.03121764212846756, decouple_loss:0.01893269084393978
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
NaN value num: 0
Iteration: 1155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846272468566895, gen p mean: -0.6396896839141846, mean p set: 0.44894298911094666
loss_pred:0.02987781912088394, decouple_loss:0.018126219511032104
The modified gen p mean: 0.4489035904407501, gen p mean: -0.6316757202148438, mean p set: 0.4493838846683502The modified gen p mean: 0.4496883749961853, gen p mean: -0.6239473819732666, mean p set: 0.4501686692237854
loss_pred:0.03168800100684166, decouple_loss:0.018616879358887672
loss_pred:0.031050672754645348, decouple_loss:0.018419139087200165
Iteration: 1156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45171695947647095, gen p mean: -0.6485100388526917, mean p set: 0.45219725370407104
loss_pred:0.030577145516872406, decouple_loss:0.020647238940000534
The modified gen p mean: 0.4503084421157837, gen p mean: -0.6443986296653748, mean p set: 0.4507887363433838The modified gen p mean: 0.4496876001358032, gen p mean: -0.6389158964157104, mean p set: 0.45016786456108093
loss_pred:0.029985759407281876, decouple_loss:0.018485737964510918
loss_pred:0.032079339027404785, decouple_loss:0.018819602206349373
Iteration: 1157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992244243621826, gen p mean: -0.6463350653648376, mean p set: 0.45040273666381836
loss_pred:0.0309432465583086, decouple_loss:0.017854727804660797
The modified gen p mean: 0.4512633979320526, gen p mean: -0.6462129950523376, mean p set: 0.4517436623573303The modified gen p mean: 0.449763685464859, gen p mean: -0.6559361219406128, mean p set: 0.4502440094947815
loss_pred:0.03175804764032364, decouple_loss:0.019798090681433678
loss_pred:0.032370228320360184, decouple_loss:0.018595747649669647
Iteration: 1158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039206743240356, gen p mean: -0.6399739384651184, mean p set: 0.45087239146232605
The modified gen p mean: 0.4526509642601013, gen p mean: -0.6491835117340088, mean p set: 0.4531312584877014
loss_pred:0.03105243481695652, decouple_loss:0.018805352970957756
loss_pred:0.031351786106824875, decouple_loss:0.01991075463593006
The modified gen p mean: 0.45271623134613037, gen p mean: -0.6430338621139526, mean p set: 0.4531964957714081
loss_pred:0.03149888291954994, decouple_loss:0.020321454852819443
Iteration: 1159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498523473739624, gen p mean: -0.6392704844474792, mean p set: 0.4503326416015625
loss_pred:0.032144054770469666, decouple_loss:0.01897396147251129
The modified gen p mean: 0.4497276842594147, gen p mean: -0.6419591903686523, mean p set: 0.45020797848701477The modified gen p mean: 0.4527396261692047, gen p mean: -0.6327102780342102, mean p set: 0.4532198905944824
loss_pred:0.031172143295407295, decouple_loss:0.019511060789227486
loss_pred:0.03147133067250252, decouple_loss:0.019212298095226288
Iteration: 1160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972240924835205, gen p mean: -0.6298591494560242, mean p set: 0.45020267367362976
loss_pred:0.03227359056472778, decouple_loss:0.01946406438946724
The modified gen p mean: 0.44983574748039246, gen p mean: -0.629466712474823, mean p set: 0.45031604170799255The modified gen p mean: 0.44970130920410156, gen p mean: -0.6226697564125061, mean p set: 0.45018163323402405
loss_pred:0.030760427936911583, decouple_loss:0.019764501601457596
loss_pred:0.03175286948680878, decouple_loss:0.018627868965268135
2023-05-01 20:15:37 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6481155157089233, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987669587135315, gen p mean: -0.6366106867790222, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6406787633895874, mean p set: 0.4500633478164673
loss_pred:0.03200328350067139, decouple_loss:0.021208370104432106
loss_pred:0.030171040445566177, decouple_loss:0.0207802914083004
loss_pred:0.030858028680086136, decouple_loss:0.02030959539115429
WV_0_PC_1_EH_0_PS_40_5, loss: 0.032049089670181274, avg_mse: 0.03618485480546951
current test mse: 0.036185
Iteration: 1161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997432827949524, gen p mean: -0.6400580406188965, mean p set: 0.45045459270477295
The modified gen p mean: 0.4498113691806793, gen p mean: -0.6395360827445984, mean p set: 0.4502916932106018
loss_pred:0.02998737432062626, decouple_loss:0.018252791836857796
The modified gen p mean: 0.45316675305366516, gen p mean: -0.6480817198753357, mean p set: 0.45364704728126526
loss_pred:0.031912192702293396, decouple_loss:0.01857367530465126
loss_pred:0.03038434311747551, decouple_loss:0.01914740912616253
Iteration: 1162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45358121395111084, gen p mean: -0.6460493803024292, mean p set: 0.45406150817871094
loss_pred:0.030100826174020767, decouple_loss:0.019195135682821274
The modified gen p mean: 0.4495389461517334, gen p mean: -0.6324297785758972, mean p set: 0.4500192403793335The modified gen p mean: 0.44984570145606995, gen p mean: -0.6300180554389954, mean p set: 0.45032599568367004
loss_pred:0.03145201504230499, decouple_loss:0.01805730350315571
loss_pred:0.030134156346321106, decouple_loss:0.01767205446958542
Iteration: 1163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934508204460144, gen p mean: -0.6271726489067078, mean p set: 0.44982537627220154
The modified gen p mean: 0.451625794172287, gen p mean: -0.6323054432868958, mean p set: 0.4521060883998871
loss_pred:0.03109218180179596, decouple_loss:0.018600674346089363
loss_pred:0.03068210929632187, decouple_loss:0.019061440601944923The modified gen p mean: 0.45282161235809326, gen p mean: -0.6423237919807434, mean p set: 0.45330190658569336
loss_pred:0.030221005901694298, decouple_loss:0.019056878983974457
Iteration: 1164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44918400049209595, gen p mean: -0.6338529586791992, mean p set: 0.44966429471969604
loss_pred:0.03181808441877365, decouple_loss:0.01816202886402607
The modified gen p mean: 0.44949871301651, gen p mean: -0.6258522272109985, mean p set: 0.4499790072441101The modified gen p mean: 0.4505920112133026, gen p mean: -0.6453467607498169, mean p set: 0.4510722756385803
loss_pred:0.03038894012570381, decouple_loss:0.01874535344541073
loss_pred:0.030989577993750572, decouple_loss:0.017953068017959595
Iteration: 1165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514254331588745, gen p mean: -0.6446628570556641, mean p set: 0.451905757188797
loss_pred:0.030577298253774643, decouple_loss:0.017200656235218048
The modified gen p mean: 0.44892454147338867, gen p mean: -0.6477702856063843, mean p set: 0.4494048058986664The modified gen p mean: 0.45048776268959045, gen p mean: -0.6446187496185303, mean p set: 0.45096808671951294
loss_pred:0.029757695272564888, decouple_loss:0.01782381720840931
loss_pred:0.030136778950691223, decouple_loss:0.017555691301822662
Iteration: 1166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507034122943878, gen p mean: -0.6412391066551208, mean p set: 0.4511836767196655
loss_pred:0.031530145555734634, decouple_loss:0.01827128976583481
The modified gen p mean: 0.44876691699028015, gen p mean: -0.6464105248451233, mean p set: 0.44924721121788025The modified gen p mean: 0.4506075978279114, gen p mean: -0.6426805853843689, mean p set: 0.4510878920555115
loss_pred:0.030924107879400253, decouple_loss:0.017781971022486687
loss_pred:0.031894784420728683, decouple_loss:0.018091943114995956
Iteration: 1167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44980502128601074, gen p mean: -0.6433153748512268, mean p set: 0.45028528571128845
loss_pred:0.03040778823196888, decouple_loss:0.01784449815750122
The modified gen p mean: 0.4530009925365448, gen p mean: -0.6436795592308044, mean p set: 0.4534813165664673The modified gen p mean: 0.45256519317626953, gen p mean: -0.6409516334533691, mean p set: 0.45304545760154724
loss_pred:0.03118680790066719, decouple_loss:0.01956534944474697
loss_pred:0.03047257848083973, decouple_loss:0.01889948360621929
Iteration: 1168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523540735244751, gen p mean: -0.6527054905891418, mean p set: 0.4528343677520752
loss_pred:0.030606234446167946, decouple_loss:0.01868952251970768
The modified gen p mean: 0.4491724371910095, gen p mean: -0.6329544186592102, mean p set: 0.4496527314186096The modified gen p mean: 0.44933873414993286, gen p mean: -0.6583547592163086, mean p set: 0.44981902837753296
loss_pred:0.030407501384615898, decouple_loss:0.017821267247200012
loss_pred:0.030272217467427254, decouple_loss:0.01795407570898533
Iteration: 1169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855958223342896, gen p mean: -0.6570711731910706, mean p set: 0.44903984665870667
loss_pred:0.03000609576702118, decouple_loss:0.01811952330172062
The modified gen p mean: 0.4502153992652893, gen p mean: -0.6366479396820068, mean p set: 0.450695663690567The modified gen p mean: 0.45217227935791016, gen p mean: -0.6531816124916077, mean p set: 0.45265257358551025
loss_pred:0.03049618750810623, decouple_loss:0.018946489319205284
loss_pred:0.031013280153274536, decouple_loss:0.017204735428094864
Iteration: 1170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45304596424102783, gen p mean: -0.6495516300201416, mean p set: 0.45352625846862793
loss_pred:0.030433980748057365, decouple_loss:0.018967321142554283
The modified gen p mean: 0.44869181513786316, gen p mean: -0.647820234298706, mean p set: 0.44917213916778564The modified gen p mean: 0.44953402876853943, gen p mean: -0.6399403214454651, mean p set: 0.4500143229961395
loss_pred:0.030360544100403786, decouple_loss:0.017875157296657562
loss_pred:0.030896209180355072, decouple_loss:0.01715419813990593
2023-05-01 20:17:45 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6494074463844299, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6378421187400818, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6420142650604248, mean p set: 0.4500633478164673
loss_pred:0.03189003840088844, decouple_loss:0.019660446792840958
loss_pred:0.03014531545341015, decouple_loss:0.0197462048381567
loss_pred:0.03080393373966217, decouple_loss:0.019379477947950363
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03192619979381561, avg_mse: 0.03623751550912857
current test mse: 0.036238
Iteration: 1171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515535533428192, gen p mean: -0.6495881676673889, mean p set: 0.4520338773727417
loss_pred:0.030600033700466156, decouple_loss:0.017668167129158974
The modified gen p mean: 0.44873303174972534, gen p mean: -0.639633059501648, mean p set: 0.44921332597732544The modified gen p mean: 0.4501267969608307, gen p mean: -0.648586630821228, mean p set: 0.4506070911884308
loss_pred:0.03171142563223839, decouple_loss:0.017644310370087624
loss_pred:0.03133077546954155, decouple_loss:0.0179843008518219
Iteration: 1172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529787003993988, gen p mean: -0.6462914943695068, mean p set: 0.4534589648246765
The modified gen p mean: 0.4472643733024597, gen p mean: -0.6481072902679443, mean p set: 0.4477446675300598
The modified gen p mean: 0.4488403797149658, gen p mean: -0.6414266228675842, mean p set: 0.4493206739425659
loss_pred:0.030231086537241936, decouple_loss:0.018059447407722473
loss_pred:0.02994951792061329, decouple_loss:0.017127981409430504
loss_pred:0.030160164460539818, decouple_loss:0.017105137929320335
Iteration: 1173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511922299861908, gen p mean: -0.6399616003036499, mean p set: 0.4516725242137909
The modified gen p mean: 0.4492345154285431, gen p mean: -0.6342681050300598, mean p set: 0.4497148096561432
loss_pred:0.031018778681755066, decouple_loss:0.01711908169090748
The modified gen p mean: 0.45013394951820374, gen p mean: -0.6310098171234131, mean p set: 0.45061424374580383
loss_pred:0.030823541805148125, decouple_loss:0.016882145777344704
loss_pred:0.029938751831650734, decouple_loss:0.0167559701949358
Iteration: 1174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500858783721924, gen p mean: -0.6441373229026794, mean p set: 0.4505661725997925
loss_pred:0.029551997780799866, decouple_loss:0.017125403508543968
The modified gen p mean: 0.45007792115211487, gen p mean: -0.6352643370628357, mean p set: 0.4505581855773926The modified gen p mean: 0.4502222537994385, gen p mean: -0.6369588375091553, mean p set: 0.4507025480270386
loss_pred:0.03140978142619133, decouple_loss:0.016945496201515198
loss_pred:0.030361568555235863, decouple_loss:0.01764199696481228
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
NaN value num: 0
Iteration: 1175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174381136894226, gen p mean: -0.6416599154472351, mean p set: 0.45222410559654236
loss_pred:0.031703367829322815, decouple_loss:0.020127160474658012
The modified gen p mean: 0.4497421085834503, gen p mean: -0.6488487124443054, mean p set: 0.450222373008728The modified gen p mean: 0.45049893856048584, gen p mean: -0.641707718372345, mean p set: 0.45097923278808594
loss_pred:0.029414575546979904, decouple_loss:0.019496215507388115
loss_pred:0.030638251453638077, decouple_loss:0.01896522007882595
Iteration: 1176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508938491344452, gen p mean: -0.637482225894928, mean p set: 0.4513741731643677
loss_pred:0.030585668981075287, decouple_loss:0.01951543800532818
The modified gen p mean: 0.44971194863319397, gen p mean: -0.6394060850143433, mean p set: 0.4501922130584717
The modified gen p mean: 0.4498249292373657, gen p mean: -0.6375340819358826, mean p set: 0.45030519366264343
loss_pred:0.030388446524739265, decouple_loss:0.018615813925862312
loss_pred:0.029880696907639503, decouple_loss:0.019648896530270576
Iteration: 1177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484226703643799, gen p mean: -0.6345313787460327, mean p set: 0.4489029347896576
The modified gen p mean: 0.44844138622283936, gen p mean: -0.6267605423927307, mean p set: 0.44892165064811707
loss_pred:0.02883940190076828, decouple_loss:0.019130626693367958
loss_pred:0.030998703092336655, decouple_loss:0.019474763423204422
The modified gen p mean: 0.44978469610214233, gen p mean: -0.6318409442901611, mean p set: 0.45026499032974243
loss_pred:0.02904513292014599, decouple_loss:0.018877746537327766
Iteration: 1178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449121356010437, gen p mean: -0.6308237910270691, mean p set: 0.4496016502380371
The modified gen p mean: 0.4528255760669708, gen p mean: -0.6254712343215942, mean p set: 0.45330584049224854
loss_pred:0.030334390699863434, decouple_loss:0.018230166286230087
loss_pred:0.03137734532356262, decouple_loss:0.0189631599932909
The modified gen p mean: 0.45077428221702576, gen p mean: -0.6260402202606201, mean p set: 0.45125457644462585
loss_pred:0.030148640275001526, decouple_loss:0.0183807872235775
Iteration: 1179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502503275871277, gen p mean: -0.6299360990524292, mean p set: 0.4507306218147278
The modified gen p mean: 0.4484596848487854, gen p mean: -0.6383237242698669, mean p set: 0.4489399194717407
loss_pred:0.03077583946287632, decouple_loss:0.01783912070095539
loss_pred:0.02869877964258194, decouple_loss:0.018578259274363518
The modified gen p mean: 0.4491286873817444, gen p mean: -0.6356146335601807, mean p set: 0.4496089518070221
loss_pred:0.03142363578081131, decouple_loss:0.019064508378505707
Iteration: 1180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520019292831421, gen p mean: -0.6357786059379578, mean p set: 0.4524822235107422
The modified gen p mean: 0.4490293562412262, gen p mean: -0.6373294591903687, mean p set: 0.4495096802711487
loss_pred:0.030265063047409058, decouple_loss:0.01918695494532585
loss_pred:0.0306696854531765, decouple_loss:0.017982104793190956
The modified gen p mean: 0.4491327106952667, gen p mean: -0.6362402439117432, mean p set: 0.44961294531822205
loss_pred:0.030604403465986252, decouple_loss:0.018878428265452385
2023-05-01 20:20:32 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6439235806465149, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6332436800003052, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6376405358314514, mean p set: 0.4500633478164673
loss_pred:0.03185568377375603, decouple_loss:0.02151239663362503
loss_pred:0.030158838257193565, decouple_loss:0.021022150292992592
loss_pred:0.03078910894691944, decouple_loss:0.020665546879172325
WV_0_PC_1_EH_0_PS_40_5, loss: 0.031987883150577545, avg_mse: 0.03627295419573784
current test mse: 0.036273
Iteration: 1181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504856467247009, gen p mean: -0.6355939507484436, mean p set: 0.450965940952301
The modified gen p mean: 0.45099177956581116, gen p mean: -0.6377776265144348, mean p set: 0.45147207379341125
loss_pred:0.03118772618472576, decouple_loss:0.019517807289958
The modified gen p mean: 0.44881466031074524, gen p mean: -0.6299545168876648, mean p set: 0.44929495453834534
loss_pred:0.03181341663002968, decouple_loss:0.019119800999760628
loss_pred:0.029897242784500122, decouple_loss:0.01849532499909401
Iteration: 1182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510059058666229, gen p mean: -0.6373974084854126, mean p set: 0.45148617029190063
The modified gen p mean: 0.45146024227142334, gen p mean: -0.6436803340911865, mean p set: 0.45194050669670105
loss_pred:0.030392061918973923, decouple_loss:0.0176102127879858
loss_pred:0.031029624864459038, decouple_loss:0.017980672419071198
The modified gen p mean: 0.4497857987880707, gen p mean: -0.6384686827659607, mean p set: 0.4502660930156708
loss_pred:0.029930898919701576, decouple_loss:0.01817365549504757
Iteration: 1183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448651522397995, gen p mean: -0.6521036028862, mean p set: 0.4491318166255951
The modified gen p mean: 0.45019111037254333, gen p mean: -0.6537534594535828, mean p set: 0.45067140460014343
loss_pred:0.02834760956466198, decouple_loss:0.017562121152877808
loss_pred:0.03027663566172123, decouple_loss:0.01885283924639225
The modified gen p mean: 0.4495984613895416, gen p mean: -0.6485108733177185, mean p set: 0.4500787556171417
loss_pred:0.030984576791524887, decouple_loss:0.01840399019420147
Iteration: 1184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524902403354645, gen p mean: -0.6410366296768188, mean p set: 0.4529705345630646
The modified gen p mean: 0.4489805996417999, gen p mean: -0.6409183144569397, mean p set: 0.4494609236717224
loss_pred:0.02991572581231594, decouple_loss:0.019085679203271866
loss_pred:0.030327580869197845, decouple_loss:0.019137879833579063
The modified gen p mean: 0.4490912854671478, gen p mean: -0.6423153877258301, mean p set: 0.4495715796947479
loss_pred:0.030752507969737053, decouple_loss:0.018773188814520836
Iteration: 1185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512256681919098, gen p mean: -0.6345294117927551, mean p set: 0.4517059326171875
The modified gen p mean: 0.4490957260131836, gen p mean: -0.6426398158073425, mean p set: 0.4495759904384613loss_pred:0.031087512150406837, decouple_loss:0.01922585256397724
The modified gen p mean: 0.4488903284072876, gen p mean: -0.6405762434005737, mean p set: 0.4493706524372101
loss_pred:0.030909284949302673, decouple_loss:0.017610423266887665
loss_pred:0.029613664373755455, decouple_loss:0.017572978511452675
Iteration: 1186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45325762033462524, gen p mean: -0.6343841552734375, mean p set: 0.45373791456222534
The modified gen p mean: 0.45101237297058105, gen p mean: -0.6402257084846497, mean p set: 0.45149263739585876
loss_pred:0.03165140375494957, decouple_loss:0.01823536865413189
loss_pred:0.029625417664647102, decouple_loss:0.017734093591570854
The modified gen p mean: 0.449856698513031, gen p mean: -0.6398625373840332, mean p set: 0.4503369629383087
loss_pred:0.02970624342560768, decouple_loss:0.01794692873954773
Iteration: 1187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510740637779236, gen p mean: -0.6354712247848511, mean p set: 0.4515543580055237
The modified gen p mean: 0.44957685470581055, gen p mean: -0.6389340758323669, mean p set: 0.45005717873573303
loss_pred:0.031369201838970184, decouple_loss:0.018991898745298386
loss_pred:0.030278900638222694, decouple_loss:0.01804402470588684
The modified gen p mean: 0.44866570830345154, gen p mean: -0.6327284574508667, mean p set: 0.44914600253105164
loss_pred:0.030317552387714386, decouple_loss:0.018458381295204163
Iteration: 1188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079654455184937, gen p mean: -0.6329010725021362, mean p set: 0.45127683877944946
The modified gen p mean: 0.45288676023483276, gen p mean: -0.6324548125267029, mean p set: 0.4533670246601105
loss_pred:0.029317863285541534, decouple_loss:0.017813008278608322
loss_pred:0.030496031045913696, decouple_loss:0.01774430088698864
The modified gen p mean: 0.4511186480522156, gen p mean: -0.6327621340751648, mean p set: 0.4515989124774933
loss_pred:0.03054790198802948, decouple_loss:0.017863735556602478
Iteration: 1189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499492049217224, gen p mean: -0.6366608738899231, mean p set: 0.45042943954467773
loss_pred:0.0300410445779562, decouple_loss:0.01833185739815235
The modified gen p mean: 0.45053189992904663, gen p mean: -0.6349591016769409, mean p set: 0.45101216435432434
The modified gen p mean: 0.45114290714263916, gen p mean: -0.6320198774337769, mean p set: 0.45162320137023926
loss_pred:0.029119744896888733, decouple_loss:0.01702018827199936
loss_pred:0.029801059514284134, decouple_loss:0.017987506464123726
Iteration: 1190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951194524765015, gen p mean: -0.6370562314987183, mean p set: 0.44999220967292786
The modified gen p mean: 0.4501085579395294, gen p mean: -0.6358927488327026, mean p set: 0.4505888819694519
loss_pred:0.03014484792947769, decouple_loss:0.017329897731542587
loss_pred:0.030837075784802437, decouple_loss:0.017669225111603737
The modified gen p mean: 0.4486089050769806, gen p mean: -0.6382911801338196, mean p set: 0.4490891993045807
loss_pred:0.030659258365631104, decouple_loss:0.016788555309176445
2023-05-01 20:22:41 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6555079221725464, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6453413963317871, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6491671204566956, mean p set: 0.4500633478164673
loss_pred:0.0317731611430645, decouple_loss:0.020175697281956673
loss_pred:0.030161559581756592, decouple_loss:0.01992497406899929
loss_pred:0.03064330853521824, decouple_loss:0.019678741693496704
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03185566887259483, avg_mse: 0.03624114766716957
current test mse: 0.036241
Iteration: 1191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517269432544708, gen p mean: -0.6450379490852356, mean p set: 0.45220720767974854
The modified gen p mean: 0.44890713691711426, gen p mean: -0.649161696434021, mean p set: 0.44938743114471436
loss_pred:0.030360408127307892, decouple_loss:0.017298055812716484
The modified gen p mean: 0.44956880807876587, gen p mean: -0.6444982886314392, mean p set: 0.45004913210868835
loss_pred:0.028964407742023468, decouple_loss:0.01754339039325714
loss_pred:0.030348772183060646, decouple_loss:0.01779988594353199
Iteration: 1192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502372443675995, gen p mean: -0.6458006501197815, mean p set: 0.4507175385951996
The modified gen p mean: 0.449260413646698, gen p mean: -0.6491284966468811, mean p set: 0.4497406780719757
loss_pred:0.030008893460035324, decouple_loss:0.01735072024166584
loss_pred:0.028780817985534668, decouple_loss:0.01693960838019848
The modified gen p mean: 0.45049571990966797, gen p mean: -0.6488317251205444, mean p set: 0.45097601413726807
loss_pred:0.030670400708913803, decouple_loss:0.015865596011281013
Iteration: 1193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491983652114868, gen p mean: -0.6378704905509949, mean p set: 0.4496786296367645
The modified gen p mean: 0.4482678472995758, gen p mean: -0.6353554725646973, mean p set: 0.4487481415271759
loss_pred:0.0289707500487566, decouple_loss:0.017184998840093613
loss_pred:0.03023434244096279, decouple_loss:0.017852172255516052The modified gen p mean: 0.4492291510105133, gen p mean: -0.6346659064292908, mean p set: 0.4497094452381134
loss_pred:0.02985730580985546, decouple_loss:0.017274323850870132
Iteration: 1194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058462023735046, gen p mean: -0.6426352262496948, mean p set: 0.45106494426727295
The modified gen p mean: 0.44832563400268555, gen p mean: -0.6322911381721497, mean p set: 0.44880592823028564
loss_pred:0.030313465744256973, decouple_loss:0.017753170803189278
loss_pred:0.029089445248246193, decouple_loss:0.016917964443564415
The modified gen p mean: 0.4493042826652527, gen p mean: -0.6361498236656189, mean p set: 0.4497845768928528
loss_pred:0.030922014266252518, decouple_loss:0.016735251992940903
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
NaN value num: 0
Iteration: 1195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793158769607544, gen p mean: -0.6507113575935364, mean p set: 0.44841188192367554
loss_pred:0.03081713616847992, decouple_loss:0.021268170326948166
The modified gen p mean: 0.44877079129219055, gen p mean: -0.6479969620704651, mean p set: 0.44925111532211304The modified gen p mean: 0.44572100043296814, gen p mean: -0.6401225924491882, mean p set: 0.44620129466056824
loss_pred:0.031146785244345665, decouple_loss:0.020367279648780823
loss_pred:0.030747735872864723, decouple_loss:0.020941831171512604
Iteration: 1196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478931725025177, gen p mean: -0.6532052755355835, mean p set: 0.4483734667301178
loss_pred:0.030730891972780228, decouple_loss:0.019675081595778465
The modified gen p mean: 0.44660159945487976, gen p mean: -0.6558995842933655, mean p set: 0.44708189368247986The modified gen p mean: 0.4486159682273865, gen p mean: -0.6603318452835083, mean p set: 0.44909629225730896
loss_pred:0.03142333775758743, decouple_loss:0.02103612758219242
loss_pred:0.03227512910962105, decouple_loss:0.022221596911549568
Iteration: 1197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472074508666992, gen p mean: -0.6621637344360352, mean p set: 0.4476877748966217
The modified gen p mean: 0.4464661478996277, gen p mean: -0.65215003490448, mean p set: 0.446946382522583
loss_pred:0.03091658279299736, decouple_loss:0.01952330209314823
loss_pred:0.03112034685909748, decouple_loss:0.020006729289889336
The modified gen p mean: 0.44563642144203186, gen p mean: -0.6515054106712341, mean p set: 0.44611674547195435
loss_pred:0.030516257509589195, decouple_loss:0.01960788108408451
Iteration: 1198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461632966995239, gen p mean: -0.6608808636665344, mean p set: 0.446643590927124
The modified gen p mean: 0.44767042994499207, gen p mean: -0.6745754480361938, mean p set: 0.44815075397491455
loss_pred:0.030702315270900726, decouple_loss:0.01928417943418026
loss_pred:0.030195901170372963, decouple_loss:0.01963122747838497
The modified gen p mean: 0.44572705030441284, gen p mean: -0.6662176847457886, mean p set: 0.44620731472969055
loss_pred:0.03179807588458061, decouple_loss:0.019815979525446892
Iteration: 1199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649529457092285, gen p mean: -0.6625021696090698, mean p set: 0.44697561860084534
The modified gen p mean: 0.44654715061187744, gen p mean: -0.6586904525756836, mean p set: 0.44702741503715515
loss_pred:0.030140291899442673, decouple_loss:0.019167164340615273
loss_pred:0.029548022896051407, decouple_loss:0.019159378483891487
The modified gen p mean: 0.44587406516075134, gen p mean: -0.6610159873962402, mean p set: 0.44635435938835144
loss_pred:0.029789794236421585, decouple_loss:0.018809663131833076
Iteration: 1200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694703817367554, gen p mean: -0.6545621156692505, mean p set: 0.44742733240127563
The modified gen p mean: 0.4462195634841919, gen p mean: -0.654742956161499, mean p set: 0.4466998875141144
loss_pred:0.03144730255007744, decouple_loss:0.019460611045360565
loss_pred:0.030913928523659706, decouple_loss:0.019103743135929108
The modified gen p mean: 0.4457029104232788, gen p mean: -0.648076593875885, mean p set: 0.4461832046508789
loss_pred:0.030356334522366524, decouple_loss:0.019629189744591713
2023-05-01 20:25:26 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6620062589645386, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6518281102180481, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6552278995513916, mean p set: 0.4500633478164673
loss_pred:0.03156786784529686, decouple_loss:0.020573806017637253
loss_pred:0.02997622825205326, decouple_loss:0.02062338963150978
loss_pred:0.030612904578447342, decouple_loss:0.02003983035683632
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03173961862921715, avg_mse: 0.03596235811710358
current test mse: 0.035962
Iteration: 1201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471961259841919, gen p mean: -0.6645065546035767, mean p set: 0.447676420211792
The modified gen p mean: 0.44690144062042236, gen p mean: -0.661156177520752, mean p set: 0.44738173484802246
loss_pred:0.031909454613924026, decouple_loss:0.0203902255743742
The modified gen p mean: 0.4473472535610199, gen p mean: -0.665509045124054, mean p set: 0.4478275179862976
loss_pred:0.031501635909080505, decouple_loss:0.018948189914226532
loss_pred:0.030973291024565697, decouple_loss:0.019102618098258972
Iteration: 1202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44695520401000977, gen p mean: -0.664249837398529, mean p set: 0.44743549823760986
The modified gen p mean: 0.44580018520355225, gen p mean: -0.6615272164344788, mean p set: 0.44628050923347473
loss_pred:0.03124299645423889, decouple_loss:0.018758444115519524
loss_pred:0.030192844569683075, decouple_loss:0.018939998000860214
The modified gen p mean: 0.4463766813278198, gen p mean: -0.6544370055198669, mean p set: 0.4468569755554199
loss_pred:0.030105452984571457, decouple_loss:0.018818708136677742
Iteration: 1203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953835010528564, gen p mean: -0.6668065786361694, mean p set: 0.45001867413520813
The modified gen p mean: 0.44585978984832764, gen p mean: -0.6617571115493774, mean p set: 0.44634005427360535
loss_pred:0.030740909278392792, decouple_loss:0.01986190304160118
loss_pred:0.03107660822570324, decouple_loss:0.018520638346672058The modified gen p mean: 0.44631367921829224, gen p mean: -0.6576636433601379, mean p set: 0.44679397344589233
loss_pred:0.032414790242910385, decouple_loss:0.018918205052614212
Iteration: 1204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469109773635864, gen p mean: -0.6617053747177124, mean p set: 0.44739121198654175The modified gen p mean: 0.4477980136871338, gen p mean: -0.6603851914405823, mean p set: 0.4482783079147339
loss_pred:0.03130966052412987, decouple_loss:0.018919380381703377loss_pred:0.029525306075811386, decouple_loss:0.01971885934472084
The modified gen p mean: 0.4465922713279724, gen p mean: -0.6575598120689392, mean p set: 0.4470725357532501
loss_pred:0.031770795583724976, decouple_loss:0.018583444878458977
Iteration: 1205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44619378447532654, gen p mean: -0.6565864682197571, mean p set: 0.446674108505249
The modified gen p mean: 0.44608253240585327, gen p mean: -0.65772545337677, mean p set: 0.446562796831131
loss_pred:0.03019918128848076, decouple_loss:0.018417097628116608
loss_pred:0.030939539894461632, decouple_loss:0.019057590514421463
The modified gen p mean: 0.4467082917690277, gen p mean: -0.6548362970352173, mean p set: 0.4471885859966278
loss_pred:0.030849039554595947, decouple_loss:0.019089069217443466
Iteration: 1206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876518845558167, gen p mean: -0.6575638055801392, mean p set: 0.4492454528808594
The modified gen p mean: 0.4457554519176483, gen p mean: -0.642814576625824, mean p set: 0.4462357461452484
loss_pred:0.030738413333892822, decouple_loss:0.01782899536192417
loss_pred:0.03057366982102394, decouple_loss:0.01830700971186161
The modified gen p mean: 0.44636204838752747, gen p mean: -0.6421141028404236, mean p set: 0.4468423128128052
loss_pred:0.030511263757944107, decouple_loss:0.01810837723314762
Iteration: 1207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476546347141266, gen p mean: -0.6629804968833923, mean p set: 0.4481349289417267The modified gen p mean: 0.44711971282958984, gen p mean: -0.6561840176582336, mean p set: 0.44760003685951233
loss_pred:0.029940133914351463, decouple_loss:0.0180656798183918
loss_pred:0.031086109578609467, decouple_loss:0.019737608730793
The modified gen p mean: 0.4496762752532959, gen p mean: -0.6570971012115479, mean p set: 0.4501565396785736
loss_pred:0.030661344528198242, decouple_loss:0.017794201150536537
Iteration: 1208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678986072540283, gen p mean: -0.660784900188446, mean p set: 0.44727015495300293
The modified gen p mean: 0.44681331515312195, gen p mean: -0.6603196263313293, mean p set: 0.44729360938072205
loss_pred:0.029828058555722237, decouple_loss:0.017790570855140686
loss_pred:0.030482804402709007, decouple_loss:0.01729184202849865
The modified gen p mean: 0.44883009791374207, gen p mean: -0.6653040647506714, mean p set: 0.4493103623390198
loss_pred:0.029960229992866516, decouple_loss:0.017949799075722694
Iteration: 1209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470807611942291, gen p mean: -0.6651928424835205, mean p set: 0.4475610554218292
loss_pred:0.029764559119939804, decouple_loss:0.018097905442118645
The modified gen p mean: 0.44630491733551025, gen p mean: -0.6575868725776672, mean p set: 0.44678524136543274The modified gen p mean: 0.44906169176101685, gen p mean: -0.6656213402748108, mean p set: 0.44954198598861694
loss_pred:0.02989983931183815, decouple_loss:0.017881304025650024
loss_pred:0.030682150274515152, decouple_loss:0.01790660060942173
Iteration: 1210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694721698760986, gen p mean: -0.6569765210151672, mean p set: 0.4474274814128876
The modified gen p mean: 0.44829386472702026, gen p mean: -0.6569629907608032, mean p set: 0.448774129152298
loss_pred:0.029845666140317917, decouple_loss:0.01877724379301071
loss_pred:0.03099442459642887, decouple_loss:0.018654324114322662
The modified gen p mean: 0.4463149309158325, gen p mean: -0.6536459922790527, mean p set: 0.44679519534111023
loss_pred:0.029749050736427307, decouple_loss:0.01746300421655178
2023-05-01 20:27:34 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6551831364631653, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6453942656517029, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6487492322921753, mean p set: 0.4500633478164673
loss_pred:0.03136410564184189, decouple_loss:0.018906768411397934
loss_pred:0.029861323535442352, decouple_loss:0.019312700256705284
loss_pred:0.030372321605682373, decouple_loss:0.01832537353038788
WV_0_PC_1_EH_0_PS_40_5, loss: 0.0314750000834465, avg_mse: 0.035730957984924316
current test mse: 0.035731
Iteration: 1211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663169980049133, gen p mean: -0.652855396270752, mean p set: 0.44711199402809143
The modified gen p mean: 0.447517454624176, gen p mean: -0.6579098701477051, mean p set: 0.4479977488517761
loss_pred:0.03104216791689396, decouple_loss:0.01797054335474968
The modified gen p mean: 0.44721418619155884, gen p mean: -0.6625787019729614, mean p set: 0.44769448041915894
loss_pred:0.029872648417949677, decouple_loss:0.017614226788282394
loss_pred:0.03041767328977585, decouple_loss:0.018473202362656593
Iteration: 1212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606515765190125, gen p mean: -0.6548851728439331, mean p set: 0.44654545187950134
The modified gen p mean: 0.44560834765434265, gen p mean: -0.6573570966720581, mean p set: 0.44608867168426514
loss_pred:0.03143739700317383, decouple_loss:0.01741243340075016
loss_pred:0.03127317130565643, decouple_loss:0.017653461545705795
The modified gen p mean: 0.44848331809043884, gen p mean: -0.662077784538269, mean p set: 0.44896358251571655
loss_pred:0.02994464710354805, decouple_loss:0.01732770726084709
Iteration: 1213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687435030937195, gen p mean: -0.6701430082321167, mean p set: 0.44735464453697205
The modified gen p mean: 0.44604259729385376, gen p mean: -0.6650668978691101, mean p set: 0.44652286171913147
loss_pred:0.029726946726441383, decouple_loss:0.016933221369981766
loss_pred:0.031100472435355186, decouple_loss:0.017284700646996498
The modified gen p mean: 0.44721871614456177, gen p mean: -0.6700047254562378, mean p set: 0.4476989805698395
loss_pred:0.0313870832324028, decouple_loss:0.017922377213835716
Iteration: 1214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467291831970215, gen p mean: -0.6613453030586243, mean p set: 0.4472094774246216
loss_pred:0.02906215935945511, decouple_loss:0.017109066247940063
The modified gen p mean: 0.4459374248981476, gen p mean: -0.6658543944358826, mean p set: 0.4464176893234253The modified gen p mean: 0.447806715965271, gen p mean: -0.6698116064071655, mean p set: 0.4482870399951935
loss_pred:0.029412779957056046, decouple_loss:0.017296116799116135
loss_pred:0.029172461479902267, decouple_loss:0.016767939552664757
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
NaN value num: 0
Iteration: 1215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495936930179596, gen p mean: -0.6449716687202454, mean p set: 0.4500739574432373
loss_pred:0.030099816620349884, decouple_loss:0.01923682913184166
The modified gen p mean: 0.45013418793678284, gen p mean: -0.6517564058303833, mean p set: 0.45061448216438293The modified gen p mean: 0.45096853375434875, gen p mean: -0.6558713316917419, mean p set: 0.45144885778427124
loss_pred:0.031507860869169235, decouple_loss:0.01930120214819908
loss_pred:0.0300148893147707, decouple_loss:0.018582209944725037
Iteration: 1216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488624334335327, gen p mean: -0.6454237699508667, mean p set: 0.4493427276611328
The modified gen p mean: 0.45071595907211304, gen p mean: -0.6479810476303101, mean p set: 0.45119625329971313
loss_pred:0.031075935810804367, decouple_loss:0.01717742346227169
loss_pred:0.030659807845950127, decouple_loss:0.018364472314715385
The modified gen p mean: 0.4503566026687622, gen p mean: -0.640280544757843, mean p set: 0.4508368670940399
loss_pred:0.02940356731414795, decouple_loss:0.01833111234009266
Iteration: 1217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533085525035858, gen p mean: -0.6440198421478271, mean p set: 0.4537888467311859
The modified gen p mean: 0.4505613446235657, gen p mean: -0.6403177976608276, mean p set: 0.45104163885116577
loss_pred:0.02922220528125763, decouple_loss:0.018211448565125465
loss_pred:0.03041640855371952, decouple_loss:0.01852063462138176The modified gen p mean: 0.44934824109077454, gen p mean: -0.6406694054603577, mean p set: 0.449828565120697
loss_pred:0.03064126707613468, decouple_loss:0.01808098331093788
Iteration: 1218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45196977257728577, gen p mean: -0.6346927881240845, mean p set: 0.45245006680488586
loss_pred:0.028880223631858826, decouple_loss:0.01848151721060276
The modified gen p mean: 0.4509352147579193, gen p mean: -0.6371102929115295, mean p set: 0.4514155089855194The modified gen p mean: 0.45041948556900024, gen p mean: -0.636182427406311, mean p set: 0.45089974999427795
loss_pred:0.02904919534921646, decouple_loss:0.017746269702911377
loss_pred:0.029150260612368584, decouple_loss:0.017481425777077675
Iteration: 1219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45110011100769043, gen p mean: -0.6402824521064758, mean p set: 0.4515804052352905
The modified gen p mean: 0.44856005907058716, gen p mean: -0.6451478600502014, mean p set: 0.44904032349586487
loss_pred:0.029269514605402946, decouple_loss:0.01715056039392948
loss_pred:0.030893461778759956, decouple_loss:0.017775224521756172
The modified gen p mean: 0.4525958001613617, gen p mean: -0.6454889178276062, mean p set: 0.4530760943889618
loss_pred:0.0280903372913599, decouple_loss:0.018450194969773293
Iteration: 1220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45188701152801514, gen p mean: -0.6478650569915771, mean p set: 0.45236724615097046
The modified gen p mean: 0.4498851001262665, gen p mean: -0.644778847694397, mean p set: 0.4503653943538666
loss_pred:0.029253441840410233, decouple_loss:0.016851186752319336
loss_pred:0.030151890590786934, decouple_loss:0.017087578773498535
The modified gen p mean: 0.4483599066734314, gen p mean: -0.6503781676292419, mean p set: 0.4488401710987091
loss_pred:0.03030811995267868, decouple_loss:0.017672445625066757
2023-05-01 20:30:18 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.654577374458313, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6440209150314331, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6480278968811035, mean p set: 0.4500633478164673
loss_pred:0.031494442373514175, decouple_loss:0.019059890881180763
loss_pred:0.029951436445116997, decouple_loss:0.018849695101380348
loss_pred:0.030489986762404442, decouple_loss:0.01860065385699272
WV_0_PC_1_EH_0_PS_40_5, loss: 0.031587131321430206, avg_mse: 0.035944223403930664
current test mse: 0.035944
Iteration: 1221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494932293891907, gen p mean: -0.6510456800460815, mean p set: 0.4499734938144684
The modified gen p mean: 0.449357271194458, gen p mean: -0.6526690721511841, mean p set: 0.4498375654220581
loss_pred:0.029893115162849426, decouple_loss:0.017855485901236534
The modified gen p mean: 0.449384868144989, gen p mean: -0.6523445248603821, mean p set: 0.4498651623725891
loss_pred:0.03099333681166172, decouple_loss:0.01706971600651741
loss_pred:0.030804531648755074, decouple_loss:0.01709038019180298
Iteration: 1222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808027148246765, gen p mean: -0.650735080242157, mean p set: 0.44856053590774536
The modified gen p mean: 0.4481806755065918, gen p mean: -0.6530830264091492, mean p set: 0.4486609697341919
loss_pred:0.031686931848526, decouple_loss:0.017094144597649574
loss_pred:0.03058559261262417, decouple_loss:0.017012299969792366
The modified gen p mean: 0.4496776759624481, gen p mean: -0.654151439666748, mean p set: 0.45015794038772583
loss_pred:0.030287040397524834, decouple_loss:0.01672731339931488
Iteration: 1223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972747564315796, gen p mean: -0.6485675573348999, mean p set: 0.45020779967308044
The modified gen p mean: 0.45197778940200806, gen p mean: -0.6462032794952393, mean p set: 0.45245808362960815
loss_pred:0.030153891071677208, decouple_loss:0.016825830563902855
loss_pred:0.027738070115447044, decouple_loss:0.017510900273919106The modified gen p mean: 0.45205241441726685, gen p mean: -0.6514386534690857, mean p set: 0.45253270864486694
loss_pred:0.02953971177339554, decouple_loss:0.017530230805277824
Iteration: 1224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510343670845032, gen p mean: -0.6474332213401794, mean p set: 0.45151469111442566
The modified gen p mean: 0.4501848816871643, gen p mean: -0.6455483436584473, mean p set: 0.450665146112442
loss_pred:0.030294308438897133, decouple_loss:0.01735328510403633
loss_pred:0.02970191463828087, decouple_loss:0.01722538284957409
The modified gen p mean: 0.44955775141716003, gen p mean: -0.6474987864494324, mean p set: 0.45003804564476013
loss_pred:0.029513390734791756, decouple_loss:0.017893007025122643
Iteration: 1225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504432678222656, gen p mean: -0.6467486023902893, mean p set: 0.4509235620498657
The modified gen p mean: 0.45283302664756775, gen p mean: -0.6451404690742493, mean p set: 0.45331335067749023
loss_pred:0.029936179518699646, decouple_loss:0.017274178564548492
loss_pred:0.02770591527223587, decouple_loss:0.017880015075206757
The modified gen p mean: 0.4529532790184021, gen p mean: -0.6512952446937561, mean p set: 0.4534335732460022
loss_pred:0.027888022363185883, decouple_loss:0.01789545826613903
Iteration: 1226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45251452922821045, gen p mean: -0.6457023620605469, mean p set: 0.45299485325813293
The modified gen p mean: 0.45049506425857544, gen p mean: -0.6487135291099548, mean p set: 0.45097532868385315
loss_pred:0.029421215876936913, decouple_loss:0.017416223883628845
loss_pred:0.029544200748205185, decouple_loss:0.01701832376420498
The modified gen p mean: 0.4485822319984436, gen p mean: -0.6515364050865173, mean p set: 0.4490624964237213
loss_pred:0.03026522696018219, decouple_loss:0.017219116911292076
Iteration: 1227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45101550221443176, gen p mean: -0.6475245356559753, mean p set: 0.45149579644203186
loss_pred:0.029513055458664894, decouple_loss:0.016365300863981247
The modified gen p mean: 0.45044654607772827, gen p mean: -0.6406006217002869, mean p set: 0.45092687010765076The modified gen p mean: 0.4506535828113556, gen p mean: -0.6405245065689087, mean p set: 0.4511338472366333
loss_pred:0.028905419632792473, decouple_loss:0.01644192636013031
loss_pred:0.028933636844158173, decouple_loss:0.016428673639893532
Iteration: 1228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495699405670166, gen p mean: -0.6366108059883118, mean p set: 0.4500502049922943
The modified gen p mean: 0.4498934745788574, gen p mean: -0.6438472867012024, mean p set: 0.45037373900413513
loss_pred:0.029534896835684776, decouple_loss:0.016861019656062126
loss_pred:0.029033169150352478, decouple_loss:0.016584156081080437
The modified gen p mean: 0.450252503156662, gen p mean: -0.6439127922058105, mean p set: 0.4507328271865845
loss_pred:0.02950580045580864, decouple_loss:0.016786307096481323
Iteration: 1229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500119090080261, gen p mean: -0.6527662873268127, mean p set: 0.4504922032356262
The modified gen p mean: 0.4487227201461792, gen p mean: -0.6584882140159607, mean p set: 0.4492030143737793
loss_pred:0.029553694650530815, decouple_loss:0.016017919406294823
loss_pred:0.030711015686392784, decouple_loss:0.01688011921942234The modified gen p mean: 0.4527561664581299, gen p mean: -0.6565536260604858, mean p set: 0.45323646068573
loss_pred:0.028033388778567314, decouple_loss:0.01628764718770981
Iteration: 1230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493951201438904, gen p mean: -0.6604305505752563, mean p set: 0.4498754143714905
The modified gen p mean: 0.45086923241615295, gen p mean: -0.6655176281929016, mean p set: 0.45134952664375305
loss_pred:0.030675025656819344, decouple_loss:0.016949797049164772
loss_pred:0.03098389320075512, decouple_loss:0.017278123646974564
The modified gen p mean: 0.44903984665870667, gen p mean: -0.6624297499656677, mean p set: 0.4495201110839844
loss_pred:0.029504504054784775, decouple_loss:0.017096299678087234
2023-05-01 20:32:26 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6614080667495728, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6504572629928589, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6549106240272522, mean p set: 0.4500633478164673
loss_pred:0.03142988681793213, decouple_loss:0.01887587644159794
loss_pred:0.029870642349123955, decouple_loss:0.018329307436943054
loss_pred:0.03037254512310028, decouple_loss:0.01840154081583023
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03148446977138519, avg_mse: 0.03595573455095291
current test mse: 0.035956
Iteration: 1231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982415437698364, gen p mean: -0.6593751311302185, mean p set: 0.45030441880226135
The modified gen p mean: 0.45028501749038696, gen p mean: -0.6577845215797424, mean p set: 0.4507652819156647
loss_pred:0.029364565387368202, decouple_loss:0.01567355915904045
The modified gen p mean: 0.45289772748947144, gen p mean: -0.654452383518219, mean p set: 0.45337799191474915
loss_pred:0.029826978221535683, decouple_loss:0.016595447435975075
loss_pred:0.028140375390648842, decouple_loss:0.017080938443541527
Iteration: 1232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500582218170166, gen p mean: -0.6507156491279602, mean p set: 0.4505384862422943
The modified gen p mean: 0.44985833764076233, gen p mean: -0.6519074440002441, mean p set: 0.4503386318683624
loss_pred:0.029141703620553017, decouple_loss:0.015814049169421196
loss_pred:0.03008602373301983, decouple_loss:0.01603679545223713
The modified gen p mean: 0.4493253827095032, gen p mean: -0.6533257961273193, mean p set: 0.44980570673942566
loss_pred:0.028855929151177406, decouple_loss:0.016178635880351067
Iteration: 1233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485224783420563, gen p mean: -0.6473904848098755, mean p set: 0.44900277256965637
The modified gen p mean: 0.4490213990211487, gen p mean: -0.6507911086082458, mean p set: 0.4495016634464264
loss_pred:0.031097950413823128, decouple_loss:0.016560202464461327
loss_pred:0.031260304152965546, decouple_loss:0.016590630635619164
The modified gen p mean: 0.4499675929546356, gen p mean: -0.647063672542572, mean p set: 0.4504478871822357
loss_pred:0.030518604442477226, decouple_loss:0.01691015250980854
Iteration: 1234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524904489517212, gen p mean: -0.6453608274459839, mean p set: 0.4529707729816437
The modified gen p mean: 0.4500754475593567, gen p mean: -0.6436667442321777, mean p set: 0.4505557417869568
loss_pred:0.02879880741238594, decouple_loss:0.016524311155080795
loss_pred:0.029846394434571266, decouple_loss:0.01608801633119583
The modified gen p mean: 0.45096173882484436, gen p mean: -0.6487211585044861, mean p set: 0.45144200325012207
loss_pred:0.029432661831378937, decouple_loss:0.015650173649191856
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 1235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841107726097107, gen p mean: -0.6455342769622803, mean p set: 0.4488913416862488
loss_pred:0.03166726976633072, decouple_loss:0.017646832391619682
The modified gen p mean: 0.44851943850517273, gen p mean: -0.6450392007827759, mean p set: 0.4489997327327728The modified gen p mean: 0.4476041793823242, gen p mean: -0.64510577917099, mean p set: 0.4480845034122467
loss_pred:0.029596837237477303, decouple_loss:0.018407808616757393
loss_pred:0.03195398300886154, decouple_loss:0.017803316935896873
Iteration: 1236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494568407535553, gen p mean: -0.6594482660293579, mean p set: 0.4499371349811554
The modified gen p mean: 0.4486088156700134, gen p mean: -0.6447083353996277, mean p set: 0.44908908009529114
loss_pred:0.02979293279349804, decouple_loss:0.019209669902920723
loss_pred:0.03107631392776966, decouple_loss:0.01786726340651512
The modified gen p mean: 0.44741374254226685, gen p mean: -0.647731363773346, mean p set: 0.44789400696754456
loss_pred:0.0308880265802145, decouple_loss:0.017670685425400734
Iteration: 1237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784730672836304, gen p mean: -0.6568748950958252, mean p set: 0.44832760095596313
The modified gen p mean: 0.44741255044937134, gen p mean: -0.6588135957717896, mean p set: 0.44789284467697144
loss_pred:0.03027191385626793, decouple_loss:0.0172526054084301
loss_pred:0.03011917509138584, decouple_loss:0.01717384345829487
The modified gen p mean: 0.4480414390563965, gen p mean: -0.6625455617904663, mean p set: 0.44852176308631897
loss_pred:0.03045358881354332, decouple_loss:0.01700810343027115
Iteration: 1238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473952651023865, gen p mean: -0.662670910358429, mean p set: 0.4478755593299866
loss_pred:0.028545919805765152, decouple_loss:0.016473494470119476
The modified gen p mean: 0.4483591914176941, gen p mean: -0.6582959294319153, mean p set: 0.4488394856452942The modified gen p mean: 0.44772955775260925, gen p mean: -0.6611537337303162, mean p set: 0.44820985198020935
loss_pred:0.030153080821037292, decouple_loss:0.017105204984545708
loss_pred:0.0304062869399786, decouple_loss:0.01609448902308941
Iteration: 1239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447377473115921, gen p mean: -0.6608997583389282, mean p set: 0.44785773754119873
The modified gen p mean: 0.44832953810691833, gen p mean: -0.6509228944778442, mean p set: 0.44880983233451843
loss_pred:0.029480069875717163, decouple_loss:0.01630188338458538
loss_pred:0.031077655032277107, decouple_loss:0.01688818447291851
The modified gen p mean: 0.44841238856315613, gen p mean: -0.6529663801193237, mean p set: 0.4488926827907562
loss_pred:0.030306747183203697, decouple_loss:0.01599261909723282
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484139084815979, gen p mean: -0.6596260070800781, mean p set: 0.448894202709198
The modified gen p mean: 0.44756534695625305, gen p mean: -0.6549060344696045, mean p set: 0.44804567098617554
loss_pred:0.030610205605626106, decouple_loss:0.016250327229499817
loss_pred:0.029457634314894676, decouple_loss:0.01634657382965088
The modified gen p mean: 0.44771504402160645, gen p mean: -0.659982442855835, mean p set: 0.44819530844688416
loss_pred:0.03039594180881977, decouple_loss:0.01596353016793728
2023-05-01 20:35:11 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6645733118057251, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6537114977836609, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6575911045074463, mean p set: 0.4500633478164673
loss_pred:0.030972642824053764, decouple_loss:0.01737954467535019
loss_pred:0.029475994408130646, decouple_loss:0.017197011038661003
loss_pred:0.029964325949549675, decouple_loss:0.016914399340748787
WV_0_PC_1_EH_0_PS_40_5, loss: 0.030995836481451988, avg_mse: 0.0353020578622818
current test mse: 0.035302
Iteration: 1241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870465993881226, gen p mean: -0.6553463339805603, mean p set: 0.44918495416641235
The modified gen p mean: 0.4480276107788086, gen p mean: -0.6576916575431824, mean p set: 0.4485079050064087
loss_pred:0.02963586151599884, decouple_loss:0.01616404391825199
The modified gen p mean: 0.4485880732536316, gen p mean: -0.6575720310211182, mean p set: 0.4490683674812317
loss_pred:0.02917034737765789, decouple_loss:0.01717289350926876
loss_pred:0.02954665943980217, decouple_loss:0.01616845838725567
Iteration: 1242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479374587535858, gen p mean: -0.6513669490814209, mean p set: 0.4484177529811859
The modified gen p mean: 0.4497060775756836, gen p mean: -0.6600589752197266, mean p set: 0.4501863420009613
loss_pred:0.030999906361103058, decouple_loss:0.015959028154611588
loss_pred:0.029720190912485123, decouple_loss:0.01704489439725876
The modified gen p mean: 0.4477750062942505, gen p mean: -0.649644672870636, mean p set: 0.4482552707195282
loss_pred:0.03139502927660942, decouple_loss:0.01691368781030178
Iteration: 1243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447196900844574, gen p mean: -0.6392041444778442, mean p set: 0.4476771950721741
The modified gen p mean: 0.44714847207069397, gen p mean: -0.639068067073822, mean p set: 0.44762876629829407
loss_pred:0.03177597373723984, decouple_loss:0.01578642427921295
loss_pred:0.03190821781754494, decouple_loss:0.016024814918637276
The modified gen p mean: 0.4475441873073578, gen p mean: -0.6443111896514893, mean p set: 0.4480244815349579
loss_pred:0.029104063287377357, decouple_loss:0.01589287631213665
Iteration: 1244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768252968788147, gen p mean: -0.6498315334320068, mean p set: 0.44816285371780396
The modified gen p mean: 0.4486084580421448, gen p mean: -0.6542943716049194, mean p set: 0.4490887224674225
loss_pred:0.028324687853455544, decouple_loss:0.015364966355264187
loss_pred:0.029138820245862007, decouple_loss:0.016670988872647285The modified gen p mean: 0.44847288727760315, gen p mean: -0.6435007452964783, mean p set: 0.44895321130752563
loss_pred:0.02887698821723461, decouple_loss:0.016021309420466423
Iteration: 1245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447279691696167, gen p mean: -0.6487438678741455, mean p set: 0.4477599561214447
The modified gen p mean: 0.4503796696662903, gen p mean: -0.6597157120704651, mean p set: 0.4508599638938904
loss_pred:0.02840220183134079, decouple_loss:0.015176570974290371
loss_pred:0.02932966873049736, decouple_loss:0.01699535734951496
The modified gen p mean: 0.44710564613342285, gen p mean: -0.6495757699012756, mean p set: 0.44758591055870056
loss_pred:0.029081596061587334, decouple_loss:0.015463072806596756
Iteration: 1246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874122738838196, gen p mean: -0.6421305537223816, mean p set: 0.44922152161598206
The modified gen p mean: 0.4473389983177185, gen p mean: -0.6500810384750366, mean p set: 0.4478192627429962
loss_pred:0.030249325558543205, decouple_loss:0.01588280312716961
loss_pred:0.027907337993383408, decouple_loss:0.015243558213114738
The modified gen p mean: 0.44777509570121765, gen p mean: -0.6496179699897766, mean p set: 0.44825538992881775
loss_pred:0.029350629076361656, decouple_loss:0.01600456051528454
Iteration: 1247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491927921772003, gen p mean: -0.6570045948028564, mean p set: 0.4496730864048004
The modified gen p mean: 0.44809475541114807, gen p mean: -0.6503300070762634, mean p set: 0.44857507944107056
loss_pred:0.02974468469619751, decouple_loss:0.015664104372262955
loss_pred:0.028389913961291313, decouple_loss:0.016538120806217194
The modified gen p mean: 0.4482532739639282, gen p mean: -0.6476053595542908, mean p set: 0.4487335979938507
loss_pred:0.029906874522566795, decouple_loss:0.016667837277054787
Iteration: 1248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785621762275696, gen p mean: -0.6493709087371826, mean p set: 0.44833654165267944
The modified gen p mean: 0.44828882813453674, gen p mean: -0.6463842988014221, mean p set: 0.44876912236213684
loss_pred:0.03005964308977127, decouple_loss:0.01647920347750187
loss_pred:0.030963610857725143, decouple_loss:0.015976829454302788
The modified gen p mean: 0.44751808047294617, gen p mean: -0.646087110042572, mean p set: 0.44799840450286865
loss_pred:0.030214466154575348, decouple_loss:0.016227634623646736
Iteration: 1249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495103657245636, gen p mean: -0.6492960453033447, mean p set: 0.4499906599521637
The modified gen p mean: 0.44750773906707764, gen p mean: -0.6511533260345459, mean p set: 0.44798803329467773
loss_pred:0.02995150536298752, decouple_loss:0.015380539931356907
loss_pred:0.02877197228372097, decouple_loss:0.015477045439183712
The modified gen p mean: 0.44918733835220337, gen p mean: -0.649096667766571, mean p set: 0.4496676027774811
loss_pred:0.03048013336956501, decouple_loss:0.01627708226442337
Iteration: 1250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824665784835815, gen p mean: -0.6452895402908325, mean p set: 0.44872695207595825
The modified gen p mean: 0.44813817739486694, gen p mean: -0.6482207179069519, mean p set: 0.44861847162246704
loss_pred:0.030485814437270164, decouple_loss:0.015903402119874954
loss_pred:0.028943674638867378, decouple_loss:0.015717679634690285
The modified gen p mean: 0.44823116064071655, gen p mean: -0.6461542844772339, mean p set: 0.44871145486831665
loss_pred:0.03116762824356556, decouple_loss:0.015614604577422142
2023-05-01 20:37:20 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.658319890499115, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6478441953659058, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6515546441078186, mean p set: 0.4500633478164673
loss_pred:0.030885564163327217, decouple_loss:0.016521262004971504
loss_pred:0.029346467927098274, decouple_loss:0.016186358407139778
loss_pred:0.029853587970137596, decouple_loss:0.01609349623322487
WV_0_PC_1_EH_0_PS_40_5, loss: 0.030841892585158348, avg_mse: 0.03511817753314972
current test mse: 0.035118
Iteration: 1251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486619234085083, gen p mean: -0.6497905850410461, mean p set: 0.4491422176361084
The modified gen p mean: 0.44812750816345215, gen p mean: -0.6525483727455139, mean p set: 0.44860783219337463
loss_pred:0.030164193361997604, decouple_loss:0.01573135517537594
The modified gen p mean: 0.4472081959247589, gen p mean: -0.6503458619117737, mean p set: 0.447688490152359
loss_pred:0.02874581515789032, decouple_loss:0.014808612875640392
loss_pred:0.029675468802452087, decouple_loss:0.015498259104788303
Iteration: 1252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482789933681488, gen p mean: -0.6506854891777039, mean p set: 0.4487592875957489
The modified gen p mean: 0.4481653869152069, gen p mean: -0.6525572538375854, mean p set: 0.4486456513404846
loss_pred:0.031217101961374283, decouple_loss:0.015431694686412811
loss_pred:0.03124590776860714, decouple_loss:0.016501622274518013
The modified gen p mean: 0.4484435021877289, gen p mean: -0.6536219120025635, mean p set: 0.44892382621765137
loss_pred:0.0300755612552166, decouple_loss:0.01575290970504284
Iteration: 1253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473778009414673, gen p mean: -0.6467687487602234, mean p set: 0.4478580951690674
The modified gen p mean: 0.44805195927619934, gen p mean: -0.6505959630012512, mean p set: 0.4485322833061218
loss_pred:0.02984059415757656, decouple_loss:0.015032842755317688
loss_pred:0.028774958103895187, decouple_loss:0.015509653836488724
The modified gen p mean: 0.4478241205215454, gen p mean: -0.6454079151153564, mean p set: 0.4483044445514679
loss_pred:0.030168665573000908, decouple_loss:0.015609726309776306
Iteration: 1254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44995635747909546, gen p mean: -0.6411515474319458, mean p set: 0.45043665170669556
loss_pred:0.02987128309905529, decouple_loss:0.015329764224588871
The modified gen p mean: 0.4476287364959717, gen p mean: -0.6458956003189087, mean p set: 0.4481090009212494The modified gen p mean: 0.44821539521217346, gen p mean: -0.6380481123924255, mean p set: 0.44869568943977356
loss_pred:0.030302615836262703, decouple_loss:0.015500270761549473
loss_pred:0.029382143169641495, decouple_loss:0.015232512727379799
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 1255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668179750442505, gen p mean: -0.6403852105140686, mean p set: 0.44716206192970276
loss_pred:0.030194547027349472, decouple_loss:0.01604754664003849
The modified gen p mean: 0.44721493124961853, gen p mean: -0.6394281983375549, mean p set: 0.44769522547721863The modified gen p mean: 0.4485968351364136, gen p mean: -0.638717532157898, mean p set: 0.44907715916633606
loss_pred:0.028869962319731712, decouple_loss:0.015132409520447254
loss_pred:0.029668159782886505, decouple_loss:0.015406457707285881
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828417897224426, gen p mean: -0.6427700519561768, mean p set: 0.44876447319984436The modified gen p mean: 0.4490334987640381, gen p mean: -0.6417202353477478, mean p set: 0.4495137631893158
loss_pred:0.029017774388194084, decouple_loss:0.015632936730980873loss_pred:0.030313383787870407, decouple_loss:0.015957407653331757
The modified gen p mean: 0.44610586762428284, gen p mean: -0.638822615146637, mean p set: 0.4465861916542053
loss_pred:0.02943452075123787, decouple_loss:0.01570368930697441
Iteration: 1257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484007954597473, gen p mean: -0.6527170538902283, mean p set: 0.448881059885025
The modified gen p mean: 0.44720014929771423, gen p mean: -0.6562702655792236, mean p set: 0.4476804733276367
loss_pred:0.02978173829615116, decouple_loss:0.015403843484818935
loss_pred:0.03158805891871452, decouple_loss:0.016451064497232437
The modified gen p mean: 0.44501036405563354, gen p mean: -0.6510580778121948, mean p set: 0.44549062848091125
loss_pred:0.029699813574552536, decouple_loss:0.015691464766860008
Iteration: 1258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669926166534424, gen p mean: -0.6551538109779358, mean p set: 0.44717955589294434
The modified gen p mean: 0.44713258743286133, gen p mean: -0.6597830057144165, mean p set: 0.4476129114627838loss_pred:0.02915750816464424, decouple_loss:0.015024795196950436
The modified gen p mean: 0.44557875394821167, gen p mean: -0.6547859311103821, mean p set: 0.4460590183734894
loss_pred:0.030538544058799744, decouple_loss:0.01625588722527027
loss_pred:0.029509970918297768, decouple_loss:0.015871310606598854
Iteration: 1259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44632357358932495, gen p mean: -0.6622353792190552, mean p set: 0.44680383801460266
The modified gen p mean: 0.44710928201675415, gen p mean: -0.6613883972167969, mean p set: 0.44758957624435425
loss_pred:0.02942381426692009, decouple_loss:0.0160447396337986
loss_pred:0.029772767797112465, decouple_loss:0.015272448770701885
The modified gen p mean: 0.4474528431892395, gen p mean: -0.6632168292999268, mean p set: 0.4479331374168396
loss_pred:0.02972080372273922, decouple_loss:0.015541009604930878
Iteration: 1260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478778541088104, gen p mean: -0.6573761105537415, mean p set: 0.4483581483364105
The modified gen p mean: 0.44810187816619873, gen p mean: -0.659532904624939, mean p set: 0.44858217239379883
loss_pred:0.028577860444784164, decouple_loss:0.015338736586272717
loss_pred:0.028702015057206154, decouple_loss:0.01514341402798891
The modified gen p mean: 0.4472739100456238, gen p mean: -0.6513584852218628, mean p set: 0.4477542042732239
loss_pred:0.030884267762303352, decouple_loss:0.015142294578254223
2023-05-01 20:40:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.6543483138084412, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6441709995269775, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.647797167301178, mean p set: 0.4500633478164673
loss_pred:0.030750693753361702, decouple_loss:0.016098327934741974
loss_pred:0.029295263811945915, decouple_loss:0.015694329515099525
loss_pred:0.029775656759738922, decouple_loss:0.015503231436014175
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03072880208492279, avg_mse: 0.035038843750953674
current test mse: 0.035039
Iteration: 1261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485483765602112, gen p mean: -0.6465293765068054, mean p set: 0.4490286707878113
The modified gen p mean: 0.44646069407463074, gen p mean: -0.6459779739379883, mean p set: 0.44694095849990845
loss_pred:0.03034871444106102, decouple_loss:0.015181542374193668
The modified gen p mean: 0.4477289915084839, gen p mean: -0.651208758354187, mean p set: 0.448209285736084
loss_pred:0.03082190454006195, decouple_loss:0.0146564319729805
loss_pred:0.02915145456790924, decouple_loss:0.014848029240965843
Iteration: 1262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445803701877594, gen p mean: -0.6481451988220215, mean p set: 0.4462839961051941
The modified gen p mean: 0.447457492351532, gen p mean: -0.6551501750946045, mean p set: 0.44793781638145447
loss_pred:0.02922787517309189, decouple_loss:0.015192650258541107
loss_pred:0.031197207048535347, decouple_loss:0.01663222908973694
The modified gen p mean: 0.44693711400032043, gen p mean: -0.6459435820579529, mean p set: 0.44741740822792053
loss_pred:0.030481377616524696, decouple_loss:0.014043781906366348
Iteration: 1263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796088337898254, gen p mean: -0.6611582636833191, mean p set: 0.44844114780426025
The modified gen p mean: 0.44585034251213074, gen p mean: -0.6568002104759216, mean p set: 0.4463306665420532
loss_pred:0.030041316524147987, decouple_loss:0.015680622309446335
loss_pred:0.029090115800499916, decouple_loss:0.015623011626303196The modified gen p mean: 0.44691750407218933, gen p mean: -0.6572614312171936, mean p set: 0.44739776849746704
loss_pred:0.02986856736242771, decouple_loss:0.015065718442201614
Iteration: 1264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455007314682007, gen p mean: -0.6544616222381592, mean p set: 0.44598105549812317
The modified gen p mean: 0.4475288987159729, gen p mean: -0.6498281955718994, mean p set: 0.448009192943573
loss_pred:0.029520483687520027, decouple_loss:0.015311125665903091
loss_pred:0.030231937766075134, decouple_loss:0.01464272104203701
The modified gen p mean: 0.4462260901927948, gen p mean: -0.6530289649963379, mean p set: 0.4467063546180725
loss_pred:0.02968360111117363, decouple_loss:0.014901397749781609
Iteration: 1265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722050428390503, gen p mean: -0.6595631837844849, mean p set: 0.4477007985115051
The modified gen p mean: 0.4462986886501312, gen p mean: -0.6538125276565552, mean p set: 0.4467789828777313
loss_pred:0.030180001631379128, decouple_loss:0.0152173126116395
loss_pred:0.029592951759696007, decouple_loss:0.014956866391003132
The modified gen p mean: 0.44642341136932373, gen p mean: -0.6494292616844177, mean p set: 0.44690370559692383
loss_pred:0.029703473672270775, decouple_loss:0.015157001093029976
Iteration: 1266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696521759033203, gen p mean: -0.6498152017593384, mean p set: 0.44744551181793213
The modified gen p mean: 0.4469771385192871, gen p mean: -0.6585778594017029, mean p set: 0.4474574029445648
loss_pred:0.02947012521326542, decouple_loss:0.014547782950103283
loss_pred:0.029537120833992958, decouple_loss:0.015062867663800716
The modified gen p mean: 0.4464872479438782, gen p mean: -0.6528837084770203, mean p set: 0.44696754217147827
loss_pred:0.028374873101711273, decouple_loss:0.015290189534425735
Iteration: 1267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668105244636536, gen p mean: -0.6537727117538452, mean p set: 0.44716131687164307
The modified gen p mean: 0.44727280735969543, gen p mean: -0.6523133516311646, mean p set: 0.44775307178497314
loss_pred:0.030697181820869446, decouple_loss:0.014863611198961735
loss_pred:0.027875710278749466, decouple_loss:0.014391048811376095
The modified gen p mean: 0.44754672050476074, gen p mean: -0.6511424779891968, mean p set: 0.44802701473236084
loss_pred:0.027709901332855225, decouple_loss:0.014468291774392128
Iteration: 1268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481351971626282, gen p mean: -0.6492680907249451, mean p set: 0.44861549139022827
The modified gen p mean: 0.4459763467311859, gen p mean: -0.652597963809967, mean p set: 0.446456640958786
loss_pred:0.02965025044977665, decouple_loss:0.01379090454429388
loss_pred:0.02841014601290226, decouple_loss:0.014967710711061954
The modified gen p mean: 0.44760170578956604, gen p mean: -0.6518676280975342, mean p set: 0.44808200001716614
loss_pred:0.02779746800661087, decouple_loss:0.01383548229932785
Iteration: 1269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465464651584625, gen p mean: -0.6578318476676941, mean p set: 0.4470267593860626
The modified gen p mean: 0.44681262969970703, gen p mean: -0.6504632234573364, mean p set: 0.44729292392730713
loss_pred:0.029933080077171326, decouple_loss:0.014462539926171303
loss_pred:0.030433891341090202, decouple_loss:0.014131875708699226The modified gen p mean: 0.4477178752422333, gen p mean: -0.6623967289924622, mean p set: 0.4481981694698334
loss_pred:0.030302466824650764, decouple_loss:0.01593475043773651
Iteration: 1270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783398509025574, gen p mean: -0.6560508012771606, mean p set: 0.44831427931785583
The modified gen p mean: 0.4466274380683899, gen p mean: -0.6570673584938049, mean p set: 0.44710773229599
loss_pred:0.02927347458899021, decouple_loss:0.01435136515647173
loss_pred:0.02952965348958969, decouple_loss:0.01457904651761055
The modified gen p mean: 0.44587817788124084, gen p mean: -0.6542761921882629, mean p set: 0.44635844230651855
loss_pred:0.029815759509801865, decouple_loss:0.01564181223511696
2023-05-01 20:42:15 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6647695899009705, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6544208526611328, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6581937074661255, mean p set: 0.4500633478164673
loss_pred:0.030824249610304832, decouple_loss:0.01528544444590807
loss_pred:0.02927403710782528, decouple_loss:0.015269411727786064
loss_pred:0.029644614085555077, decouple_loss:0.014763250946998596
WV_0_PC_1_EH_0_PS_40_5, loss: 0.030669603496789932, avg_mse: 0.03498946130275726
current test mse: 0.034989
Iteration: 1271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464516043663025, gen p mean: -0.6599703431129456, mean p set: 0.4469318985939026
The modified gen p mean: 0.4470151662826538, gen p mean: -0.6618430018424988, mean p set: 0.4474954903125763
loss_pred:0.029826030135154724, decouple_loss:0.014777685515582561
The modified gen p mean: 0.44660383462905884, gen p mean: -0.6586007475852966, mean p set: 0.44708412885665894
loss_pred:0.02970782481133938, decouple_loss:0.014625166542828083
loss_pred:0.029038654640316963, decouple_loss:0.014725458808243275
Iteration: 1272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786348938941956, gen p mean: -0.6597521901130676, mean p set: 0.44834378361701965
The modified gen p mean: 0.44644805788993835, gen p mean: -0.6583957672119141, mean p set: 0.44692835211753845
loss_pred:0.02854175679385662, decouple_loss:0.014777915552258492
loss_pred:0.029033197090029716, decouple_loss:0.015137014910578728The modified gen p mean: 0.4478619396686554, gen p mean: -0.6641200184822083, mean p set: 0.4483422338962555
loss_pred:0.028967829421162605, decouple_loss:0.014712667092680931
Iteration: 1273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474099576473236, gen p mean: -0.6674330234527588, mean p set: 0.4478902518749237
The modified gen p mean: 0.44661030173301697, gen p mean: -0.6634383201599121, mean p set: 0.4470905363559723
loss_pred:0.03001195192337036, decouple_loss:0.01536248717457056
loss_pred:0.028385013341903687, decouple_loss:0.014651009812951088
The modified gen p mean: 0.4462679922580719, gen p mean: -0.6669043898582458, mean p set: 0.446748286485672
loss_pred:0.02904387377202511, decouple_loss:0.015036632306873798
Iteration: 1274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790756702423096, gen p mean: -0.6691482067108154, mean p set: 0.44838783144950867
The modified gen p mean: 0.44497737288475037, gen p mean: -0.6662690043449402, mean p set: 0.4454576373100281
loss_pred:0.02900710701942444, decouple_loss:0.014131787233054638
loss_pred:0.02963210642337799, decouple_loss:0.014801526442170143
The modified gen p mean: 0.44673678278923035, gen p mean: -0.6606690883636475, mean p set: 0.44721704721450806
loss_pred:0.029121240600943565, decouple_loss:0.01445008348673582
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
NaN value num: 0
Iteration: 1275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489962160587311, gen p mean: -0.6602118015289307, mean p set: 0.4494765102863312
loss_pred:0.027543455362319946, decouple_loss:0.01427715364843607
The modified gen p mean: 0.4496716260910034, gen p mean: -0.6632400155067444, mean p set: 0.45015189051628113The modified gen p mean: 0.4493913948535919, gen p mean: -0.6625396609306335, mean p set: 0.4498717188835144
loss_pred:0.03071792796254158, decouple_loss:0.016733432188630104
loss_pred:0.030658718198537827, decouple_loss:0.01646699197590351
Iteration: 1276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485129117965698, gen p mean: -0.6556488275527954, mean p set: 0.44899317622184753
The modified gen p mean: 0.44792258739471436, gen p mean: -0.6542266607284546, mean p set: 0.44840285181999207
loss_pred:0.028310200199484825, decouple_loss:0.01434621773660183
loss_pred:0.03090355172753334, decouple_loss:0.01596810854971409
The modified gen p mean: 0.447347491979599, gen p mean: -0.6578169465065002, mean p set: 0.4478277862071991
loss_pred:0.03113587759435177, decouple_loss:0.014869493432343006
Iteration: 1277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447256863117218, gen p mean: -0.6560441255569458, mean p set: 0.4477371573448181
The modified gen p mean: 0.4470460116863251, gen p mean: -0.661465048789978, mean p set: 0.4475262761116028
loss_pred:0.029423072934150696, decouple_loss:0.014317979104816914
loss_pred:0.03113391064107418, decouple_loss:0.01553670596331358
The modified gen p mean: 0.4477471709251404, gen p mean: -0.6576606035232544, mean p set: 0.4482274651527405
loss_pred:0.03142354264855385, decouple_loss:0.014895998872816563
Iteration: 1278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471716582775116, gen p mean: -0.6647786498069763, mean p set: 0.4476519823074341
The modified gen p mean: 0.44807928800582886, gen p mean: -0.6625242233276367, mean p set: 0.44855955243110657
loss_pred:0.02901206538081169, decouple_loss:0.014336400665342808
loss_pred:0.030022628605365753, decouple_loss:0.015079690143465996
The modified gen p mean: 0.44879695773124695, gen p mean: -0.6616149544715881, mean p set: 0.44927728176116943
loss_pred:0.02893298678100109, decouple_loss:0.014945965260267258
Iteration: 1279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778746366500854, gen p mean: -0.6697040796279907, mean p set: 0.44826775789260864
The modified gen p mean: 0.4475036561489105, gen p mean: -0.6656991243362427, mean p set: 0.4479839503765106
loss_pred:0.031498197466135025, decouple_loss:0.015012803487479687
loss_pred:0.03147484362125397, decouple_loss:0.015582814812660217
The modified gen p mean: 0.4469103515148163, gen p mean: -0.6716827750205994, mean p set: 0.447390615940094
loss_pred:0.03154119849205017, decouple_loss:0.015777278691530228
Iteration: 1280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930100440979004, gen p mean: -0.6749753355979919, mean p set: 0.4497813284397125
The modified gen p mean: 0.4477228820323944, gen p mean: -0.6711778044700623, mean p set: 0.44820311665534973
loss_pred:0.030053846538066864, decouple_loss:0.015433792024850845
loss_pred:0.030484408140182495, decouple_loss:0.015539408661425114
The modified gen p mean: 0.44813403487205505, gen p mean: -0.6721064448356628, mean p set: 0.44861429929733276
loss_pred:0.02826712466776371, decouple_loss:0.015057515352964401
2023-05-01 20:45:00 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6714091300964355, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6615452766418457, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.665164589881897, mean p set: 0.4500633478164673
loss_pred:0.03074299916625023, decouple_loss:0.016582384705543518
loss_pred:0.02917902171611786, decouple_loss:0.01619058847427368
loss_pred:0.029670817777514458, decouple_loss:0.01598799042403698
WV_0_PC_1_EH_0_PS_40_5, loss: 0.030676960945129395, avg_mse: 0.03507206588983536
current test mse: 0.035072
Iteration: 1281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497276544570923, gen p mean: -0.6700924634933472, mean p set: 0.45020791888237
The modified gen p mean: 0.4498458504676819, gen p mean: -0.6681110858917236, mean p set: 0.45032617449760437
loss_pred:0.02980036847293377, decouple_loss:0.01642220839858055
The modified gen p mean: 0.44717302918434143, gen p mean: -0.6626642942428589, mean p set: 0.44765329360961914
loss_pred:0.029833689332008362, decouple_loss:0.015223141759634018
loss_pred:0.031000357121229172, decouple_loss:0.015313468873500824
Iteration: 1282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487018287181854, gen p mean: -0.6583517789840698, mean p set: 0.4491821527481079
The modified gen p mean: 0.4474138915538788, gen p mean: -0.6617375612258911, mean p set: 0.44789421558380127
loss_pred:0.027591263875365257, decouple_loss:0.014847835525870323
loss_pred:0.029710905626416206, decouple_loss:0.015379969030618668
The modified gen p mean: 0.4471295177936554, gen p mean: -0.6586291790008545, mean p set: 0.4476097822189331
loss_pred:0.03142862766981125, decouple_loss:0.01493438147008419
Iteration: 1283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447131872177124, gen p mean: -0.6512542366981506, mean p set: 0.44761213660240173
The modified gen p mean: 0.4485624432563782, gen p mean: -0.6545038819313049, mean p set: 0.44904273748397827
loss_pred:0.03134683892130852, decouple_loss:0.0148146478459239
loss_pred:0.02837212197482586, decouple_loss:0.015084306709468365
The modified gen p mean: 0.44697391986846924, gen p mean: -0.6545987129211426, mean p set: 0.44745421409606934
loss_pred:0.029606875032186508, decouple_loss:0.015331918373703957
Iteration: 1284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483039975166321, gen p mean: -0.6641491055488586, mean p set: 0.4487842917442322
The modified gen p mean: 0.44690948724746704, gen p mean: -0.6638532876968384, mean p set: 0.4473898112773895
loss_pred:0.030310945585370064, decouple_loss:0.01506850216537714
loss_pred:0.02878566086292267, decouple_loss:0.01465610321611166
The modified gen p mean: 0.4474733769893646, gen p mean: -0.6674227118492126, mean p set: 0.4479536712169647
loss_pred:0.030458545312285423, decouple_loss:0.015164471231400967
Iteration: 1285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787687063217163, gen p mean: -0.6660995483398438, mean p set: 0.44835713505744934
The modified gen p mean: 0.44916045665740967, gen p mean: -0.6701827049255371, mean p set: 0.44964075088500977
loss_pred:0.03018050640821457, decouple_loss:0.015101496130228043
loss_pred:0.0296974778175354, decouple_loss:0.014628078788518906
The modified gen p mean: 0.44647037982940674, gen p mean: -0.6715949773788452, mean p set: 0.44695067405700684
loss_pred:0.03054914064705372, decouple_loss:0.015320960432291031
Iteration: 1286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772812724113464, gen p mean: -0.6741994619369507, mean p set: 0.44820842146873474
The modified gen p mean: 0.4469853341579437, gen p mean: -0.6729996204376221, mean p set: 0.4474656283855438
loss_pred:0.03013291209936142, decouple_loss:0.015221442095935345
loss_pred:0.028331635519862175, decouple_loss:0.014960972592234612
The modified gen p mean: 0.44918811321258545, gen p mean: -0.6718898415565491, mean p set: 0.44966837763786316
loss_pred:0.02977185696363449, decouple_loss:0.015225084498524666
Iteration: 1287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491839110851288, gen p mean: -0.6700502634048462, mean p set: 0.4496642053127289
The modified gen p mean: 0.44914892315864563, gen p mean: -0.6683024764060974, mean p set: 0.4496292173862457
loss_pred:0.029081694781780243, decouple_loss:0.015110940672457218
loss_pred:0.029874010011553764, decouple_loss:0.014782237820327282
The modified gen p mean: 0.4469221830368042, gen p mean: -0.6625704169273376, mean p set: 0.4474024772644043
loss_pred:0.030388707295060158, decouple_loss:0.014337927103042603
Iteration: 1288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487006664276123, gen p mean: -0.6600388884544373, mean p set: 0.4491809606552124
The modified gen p mean: 0.447294145822525, gen p mean: -0.658750593662262, mean p set: 0.4477744400501251
loss_pred:0.029174240306019783, decouple_loss:0.014450022019445896
loss_pred:0.02903781272470951, decouple_loss:0.014983118511736393
The modified gen p mean: 0.44811558723449707, gen p mean: -0.665509045124054, mean p set: 0.44859588146209717
loss_pred:0.03007514961063862, decouple_loss:0.014692618511617184
Iteration: 1289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483188986778259, gen p mean: -0.6604573726654053, mean p set: 0.44879916310310364
The modified gen p mean: 0.4474940299987793, gen p mean: -0.6589627861976624, mean p set: 0.447974294424057
loss_pred:0.03011748008430004, decouple_loss:0.014119389466941357
loss_pred:0.029457757249474525, decouple_loss:0.01433537621051073
The modified gen p mean: 0.44698938727378845, gen p mean: -0.6573651432991028, mean p set: 0.44746968150138855
loss_pred:0.02935858443379402, decouple_loss:0.014211723580956459
Iteration: 1290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731876254081726, gen p mean: -0.6590067744255066, mean p set: 0.44779905676841736
The modified gen p mean: 0.4486241340637207, gen p mean: -0.6596924066543579, mean p set: 0.4491044282913208
loss_pred:0.030358167365193367, decouple_loss:0.01399089116603136
loss_pred:0.029172133654356003, decouple_loss:0.014257089234888554
The modified gen p mean: 0.4501868486404419, gen p mean: -0.659471869468689, mean p set: 0.450667142868042
loss_pred:0.029721388593316078, decouple_loss:0.015012074261903763
2023-05-01 20:47:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6766719818115234, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6657246947288513, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6695106029510498, mean p set: 0.4500633478164673
loss_pred:0.03082171268761158, decouple_loss:0.015766290947794914
loss_pred:0.029258213937282562, decouple_loss:0.015155050903558731
loss_pred:0.029696594923734665, decouple_loss:0.015140261501073837
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03069320134818554, avg_mse: 0.035220108926296234
current test mse: 0.03522
Iteration: 1291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835197925567627, gen p mean: -0.6707422733306885, mean p set: 0.448832243680954
The modified gen p mean: 0.447998970746994, gen p mean: -0.6718223690986633, mean p set: 0.4484792649745941
loss_pred:0.03158305212855339, decouple_loss:0.013998315669596195
The modified gen p mean: 0.44814759492874146, gen p mean: -0.6663798093795776, mean p set: 0.44862788915634155
loss_pred:0.030428508296608925, decouple_loss:0.013686937279999256
loss_pred:0.02906116098165512, decouple_loss:0.014214711263775826
Iteration: 1292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830429553985596, gen p mean: -0.6716639399528503, mean p set: 0.44878458976745605
loss_pred:0.027595674619078636, decouple_loss:0.014451064169406891
The modified gen p mean: 0.44909271597862244, gen p mean: -0.6738977432250977, mean p set: 0.44957301020622253The modified gen p mean: 0.4465521275997162, gen p mean: -0.6722548007965088, mean p set: 0.4470324218273163
loss_pred:0.029257256537675858, decouple_loss:0.0148437125608325
loss_pred:0.02934318594634533, decouple_loss:0.014863935299217701
Iteration: 1293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750964641571045, gen p mean: -0.6583108305931091, mean p set: 0.44798994064331055
The modified gen p mean: 0.44741854071617126, gen p mean: -0.6577948331832886, mean p set: 0.44789883494377136
loss_pred:0.030064944177865982, decouple_loss:0.015119412913918495
loss_pred:0.03156251087784767, decouple_loss:0.014668961986899376
The modified gen p mean: 0.44660404324531555, gen p mean: -0.6590640544891357, mean p set: 0.44708430767059326
loss_pred:0.02921413443982601, decouple_loss:0.014393910765647888
Iteration: 1294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786950945854187, gen p mean: -0.6525403261184692, mean p set: 0.44834980368614197
The modified gen p mean: 0.44690847396850586, gen p mean: -0.6590301394462585, mean p set: 0.44738876819610596
loss_pred:0.031718745827674866, decouple_loss:0.013981662690639496
loss_pred:0.03133077919483185, decouple_loss:0.0153590003028512
The modified gen p mean: 0.44832825660705566, gen p mean: -0.6545155644416809, mean p set: 0.44880858063697815
loss_pred:0.02866210602223873, decouple_loss:0.014364609494805336
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 1295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703683257102966, gen p mean: -0.6594524383544922, mean p set: 0.44751712679862976
loss_pred:0.030459633097052574, decouple_loss:0.01474413275718689
The modified gen p mean: 0.44761812686920166, gen p mean: -0.6590666174888611, mean p set: 0.44809842109680176The modified gen p mean: 0.4465370178222656, gen p mean: -0.6568604707717896, mean p set: 0.4470173120498657
loss_pred:0.030000802129507065, decouple_loss:0.015124738216400146
loss_pred:0.030084501951932907, decouple_loss:0.014268066734075546
Iteration: 1296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750478863716125, gen p mean: -0.6545035243034363, mean p set: 0.4479850232601166
loss_pred:0.030467486009001732, decouple_loss:0.014580993913114071
The modified gen p mean: 0.4459006190299988, gen p mean: -0.6574997901916504, mean p set: 0.4463808834552765The modified gen p mean: 0.44647157192230225, gen p mean: -0.6583013534545898, mean p set: 0.44695183634757996
loss_pred:0.029639001935720444, decouple_loss:0.014297659508883953
loss_pred:0.030648183077573776, decouple_loss:0.014470428228378296
Iteration: 1297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718873500823975, gen p mean: -0.654540479183197, mean p set: 0.44766902923583984
The modified gen p mean: 0.4474382996559143, gen p mean: -0.6558382511138916, mean p set: 0.447918564081192
loss_pred:0.030490824952721596, decouple_loss:0.014999691396951675
loss_pred:0.029508614912629128, decouple_loss:0.01507684588432312
The modified gen p mean: 0.4452938735485077, gen p mean: -0.6542511582374573, mean p set: 0.4457741975784302
loss_pred:0.029520606622099876, decouple_loss:0.01436815969645977
Iteration: 1298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621577858924866, gen p mean: -0.6537437438964844, mean p set: 0.44669607281684875
The modified gen p mean: 0.4475977420806885, gen p mean: -0.6540372371673584, mean p set: 0.44807806611061096
loss_pred:0.02967425063252449, decouple_loss:0.014683092013001442
loss_pred:0.03057248331606388, decouple_loss:0.014177341014146805
The modified gen p mean: 0.4457560181617737, gen p mean: -0.6532618403434753, mean p set: 0.4462362825870514
loss_pred:0.029573244974017143, decouple_loss:0.014470221474766731
Iteration: 1299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480317533016205, gen p mean: -0.6617726683616638, mean p set: 0.44851207733154297
The modified gen p mean: 0.44548192620277405, gen p mean: -0.6601396799087524, mean p set: 0.44596222043037415
loss_pred:0.029081206768751144, decouple_loss:0.014594114385545254
loss_pred:0.029670197516679764, decouple_loss:0.014313308522105217
The modified gen p mean: 0.4460197687149048, gen p mean: -0.6578612327575684, mean p set: 0.4465000033378601
loss_pred:0.029599687084555626, decouple_loss:0.013705446384847164
Iteration: 1300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750991463661194, gen p mean: -0.6585280299186707, mean p set: 0.44799020886421204
The modified gen p mean: 0.4473945200443268, gen p mean: -0.6596579551696777, mean p set: 0.44787484407424927
loss_pred:0.02945607714354992, decouple_loss:0.014750231057405472
loss_pred:0.02982381358742714, decouple_loss:0.015006614848971367
The modified gen p mean: 0.44665440917015076, gen p mean: -0.657908022403717, mean p set: 0.44713470339775085
loss_pred:0.030534736812114716, decouple_loss:0.01448058057576418
2023-05-01 20:49:50 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.666388213634491, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6559412479400635, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6595432758331299, mean p set: 0.4500633478164673
loss_pred:0.030512677505612373, decouple_loss:0.015195123851299286
loss_pred:0.02908320538699627, decouple_loss:0.01521958876401186
loss_pred:0.029540708288550377, decouple_loss:0.014702406711876392
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03046415001153946, avg_mse: 0.03486860916018486
current test mse: 0.034869
Iteration: 1301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462284743785858, gen p mean: -0.6601654291152954, mean p set: 0.4467087388038635
The modified gen p mean: 0.44656628370285034, gen p mean: -0.6599050164222717, mean p set: 0.44704657793045044
loss_pred:0.030159179121255875, decouple_loss:0.014470702968537807
The modified gen p mean: 0.44727882742881775, gen p mean: -0.665475606918335, mean p set: 0.44775912165641785
loss_pred:0.03087938390672207, decouple_loss:0.014584586955606937
loss_pred:0.030794767662882805, decouple_loss:0.014735962264239788
Iteration: 1302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44605615735054016, gen p mean: -0.6699227690696716, mean p set: 0.44653645157814026
The modified gen p mean: 0.4466998875141144, gen p mean: -0.664963960647583, mean p set: 0.4471801817417145
loss_pred:0.029328711330890656, decouple_loss:0.014345178380608559
loss_pred:0.03114093281328678, decouple_loss:0.014231995679438114
The modified gen p mean: 0.447651743888855, gen p mean: -0.6615479588508606, mean p set: 0.44813206791877747
loss_pred:0.03050624392926693, decouple_loss:0.01408014539629221
Iteration: 1303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477819800376892, gen p mean: -0.6594484448432922, mean p set: 0.4482622444629669
The modified gen p mean: 0.44623327255249023, gen p mean: -0.6537191867828369, mean p set: 0.44671353697776794
loss_pred:0.03060045652091503, decouple_loss:0.014253800734877586
loss_pred:0.030197838321328163, decouple_loss:0.014216369017958641
The modified gen p mean: 0.4468311369419098, gen p mean: -0.6580654978752136, mean p set: 0.4473114311695099
loss_pred:0.029316039755940437, decouple_loss:0.014199887402355671
Iteration: 1304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696757197380066, gen p mean: -0.6482800841331482, mean p set: 0.44744786620140076
The modified gen p mean: 0.44631731510162354, gen p mean: -0.6498012542724609, mean p set: 0.44679760932922363
loss_pred:0.03019709140062332, decouple_loss:0.014086950570344925
loss_pred:0.030229393392801285, decouple_loss:0.014157312922179699
The modified gen p mean: 0.446450412273407, gen p mean: -0.6494448781013489, mean p set: 0.4469307065010071
loss_pred:0.030310695990920067, decouple_loss:0.01410640124231577
Iteration: 1305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761884212493896, gen p mean: -0.6549708247184753, mean p set: 0.4480991065502167
The modified gen p mean: 0.44689762592315674, gen p mean: -0.655629575252533, mean p set: 0.44737792015075684
loss_pred:0.029903549700975418, decouple_loss:0.01425938494503498
loss_pred:0.02955217845737934, decouple_loss:0.014623662456870079
The modified gen p mean: 0.4465339481830597, gen p mean: -0.6538684964179993, mean p set: 0.4470142424106598
loss_pred:0.02935258112847805, decouple_loss:0.014280018396675587
Iteration: 1306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44619378447532654, gen p mean: -0.6573241949081421, mean p set: 0.44667407870292664
The modified gen p mean: 0.4459228217601776, gen p mean: -0.6521077752113342, mean p set: 0.4464031159877777
loss_pred:0.03046581707894802, decouple_loss:0.013828074559569359
loss_pred:0.030288172885775566, decouple_loss:0.013883361592888832
The modified gen p mean: 0.44595468044281006, gen p mean: -0.6567895412445068, mean p set: 0.44643494486808777
loss_pred:0.029513513669371605, decouple_loss:0.013784811832010746
Iteration: 1307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466250240802765, gen p mean: -0.6598151922225952, mean p set: 0.447105348110199
The modified gen p mean: 0.44649195671081543, gen p mean: -0.6600254774093628, mean p set: 0.4469722807407379
loss_pred:0.03035690262913704, decouple_loss:0.014093865640461445
loss_pred:0.029511865228414536, decouple_loss:0.013586139306426048
The modified gen p mean: 0.44677507877349854, gen p mean: -0.657558262348175, mean p set: 0.44725537300109863
loss_pred:0.029374679550528526, decouple_loss:0.014619964174926281
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456821382045746, gen p mean: -0.6538194417953491, mean p set: 0.44616246223449707
The modified gen p mean: 0.4467596411705017, gen p mean: -0.6568524241447449, mean p set: 0.4472399353981018
loss_pred:0.03108797036111355, decouple_loss:0.013764427974820137
loss_pred:0.030505843460559845, decouple_loss:0.014560701325535774
The modified gen p mean: 0.44740718603134155, gen p mean: -0.6600467562675476, mean p set: 0.44788745045661926
loss_pred:0.030414773151278496, decouple_loss:0.01397528313100338
Iteration: 1309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478432238101959, gen p mean: -0.6622413992881775, mean p set: 0.448323518037796
The modified gen p mean: 0.4462399482727051, gen p mean: -0.6603205800056458, mean p set: 0.4467202425003052
loss_pred:0.030407145619392395, decouple_loss:0.014475460164248943
loss_pred:0.029767677187919617, decouple_loss:0.01363156083971262
The modified gen p mean: 0.4467129707336426, gen p mean: -0.6602520942687988, mean p set: 0.4471932351589203
loss_pred:0.030919086188077927, decouple_loss:0.013613124378025532
Iteration: 1310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464482367038727, gen p mean: -0.6586261987686157, mean p set: 0.44692856073379517
The modified gen p mean: 0.4469756782054901, gen p mean: -0.6563696265220642, mean p set: 0.4474559724330902
The modified gen p mean: 0.4479432702064514, gen p mean: -0.6554697155952454, mean p set: 0.4484235644340515
loss_pred:0.02893195115029812, decouple_loss:0.01409818697720766
loss_pred:0.028997331857681274, decouple_loss:0.013684950768947601
loss_pred:0.02931981533765793, decouple_loss:0.014603130519390106
2023-05-01 20:51:59 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6629234552383423, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6524976491928101, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6567178964614868, mean p set: 0.4500633478164673
loss_pred:0.030480457469820976, decouple_loss:0.014517818577587605
loss_pred:0.028869325295090675, decouple_loss:0.014804486185312271
loss_pred:0.029369637370109558, decouple_loss:0.01436601486057043
WV_0_PC_1_EH_0_PS_40_5, loss: 0.030301280319690704, avg_mse: 0.03466738760471344
current test mse: 0.034667
Iteration: 1311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654616713523865, gen p mean: -0.6551654934883118, mean p set: 0.44702646136283875
The modified gen p mean: 0.445599764585495, gen p mean: -0.6607223749160767, mean p set: 0.4460800588130951
loss_pred:0.02947297692298889, decouple_loss:0.01407378539443016
The modified gen p mean: 0.4484091103076935, gen p mean: -0.6551079154014587, mean p set: 0.44888943433761597
loss_pred:0.029843857511878014, decouple_loss:0.014460252597928047
loss_pred:0.030330823734402657, decouple_loss:0.014202478341758251
Iteration: 1312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465695321559906, gen p mean: -0.6650975346565247, mean p set: 0.4470498263835907
The modified gen p mean: 0.4472518563270569, gen p mean: -0.6619054079055786, mean p set: 0.447732150554657
loss_pred:0.029102345928549767, decouple_loss:0.014165346510708332
loss_pred:0.029891012236475945, decouple_loss:0.01388622261583805
The modified gen p mean: 0.44607147574424744, gen p mean: -0.6600378155708313, mean p set: 0.44655176997184753
loss_pred:0.030355164781212807, decouple_loss:0.013553153723478317
Iteration: 1313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458337724208832, gen p mean: -0.6559354066848755, mean p set: 0.4463140368461609
The modified gen p mean: 0.44583743810653687, gen p mean: -0.665513813495636, mean p set: 0.44631776213645935
loss_pred:0.03012070059776306, decouple_loss:0.01362499501556158
loss_pred:0.02942553535103798, decouple_loss:0.013949466869235039
The modified gen p mean: 0.4480521082878113, gen p mean: -0.6610614657402039, mean p set: 0.448532372713089
loss_pred:0.029865682125091553, decouple_loss:0.013082115910947323
Iteration: 1314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480176568031311, gen p mean: -0.6647392511367798, mean p set: 0.4484979510307312
The modified gen p mean: 0.44592297077178955, gen p mean: -0.6665884852409363, mean p set: 0.44640329480171204
loss_pred:0.030196169391274452, decouple_loss:0.013892563059926033
loss_pred:0.029561998322606087, decouple_loss:0.013790179044008255
The modified gen p mean: 0.4464617967605591, gen p mean: -0.6601523160934448, mean p set: 0.4469420909881592
loss_pred:0.03103731758892536, decouple_loss:0.013468379154801369
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
NaN value num: 0
Iteration: 1315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108312368392944, gen p mean: -0.668269693851471, mean p set: 0.45156344771385193
loss_pred:0.029570091515779495, decouple_loss:0.018405070528388023
The modified gen p mean: 0.4490223824977875, gen p mean: -0.6616631746292114, mean p set: 0.4495026767253876The modified gen p mean: 0.44859984517097473, gen p mean: -0.667544960975647, mean p set: 0.44908010959625244
loss_pred:0.02846851944923401, decouple_loss:0.016791805624961853
loss_pred:0.03057718276977539, decouple_loss:0.0176059752702713
Iteration: 1316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046067237854004, gen p mean: -0.6694356799125671, mean p set: 0.45094096660614014
The modified gen p mean: 0.448866069316864, gen p mean: -0.6562011241912842, mean p set: 0.4493463933467865
loss_pred:0.02942572347819805, decouple_loss:0.017350677400827408
loss_pred:0.031779106706380844, decouple_loss:0.01706852950155735
The modified gen p mean: 0.45104214549064636, gen p mean: -0.6652060151100159, mean p set: 0.4515224099159241
loss_pred:0.030782492831349373, decouple_loss:0.017429804429411888
Iteration: 1317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500294327735901, gen p mean: -0.6552464365959167, mean p set: 0.4505097270011902
The modified gen p mean: 0.44965505599975586, gen p mean: -0.643395721912384, mean p set: 0.45013532042503357
loss_pred:0.029576551169157028, decouple_loss:0.016012810170650482
loss_pred:0.031217379495501518, decouple_loss:0.016509728506207466The modified gen p mean: 0.4514771103858948, gen p mean: -0.6501631736755371, mean p set: 0.4519574046134949
loss_pred:0.029866324737668037, decouple_loss:0.016713876277208328
Iteration: 1318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179909467697144, gen p mean: -0.642822265625, mean p set: 0.45227932929992676
loss_pred:0.030477138236165047, decouple_loss:0.016625013202428818
The modified gen p mean: 0.45184165239334106, gen p mean: -0.6415551900863647, mean p set: 0.45232194662094116
The modified gen p mean: 0.45180878043174744, gen p mean: -0.6405516266822815, mean p set: 0.45228907465934753
loss_pred:0.030146349221467972, decouple_loss:0.017357759177684784
loss_pred:0.030436160042881966, decouple_loss:0.016441259533166885
Iteration: 1319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499739110469818, gen p mean: -0.6471693515777588, mean p set: 0.4504542350769043
The modified gen p mean: 0.4485670328140259, gen p mean: -0.6368510127067566, mean p set: 0.44904735684394836
loss_pred:0.029567552730441093, decouple_loss:0.015459236688911915
loss_pred:0.028066430240869522, decouple_loss:0.01574614644050598
The modified gen p mean: 0.4515248239040375, gen p mean: -0.6440104246139526, mean p set: 0.45200514793395996
loss_pred:0.029714766889810562, decouple_loss:0.01521932240575552
Iteration: 1320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939979910850525, gen p mean: -0.6486157774925232, mean p set: 0.44988009333610535
The modified gen p mean: 0.44902458786964417, gen p mean: -0.6443743109703064, mean p set: 0.4495048522949219
loss_pred:0.02839861996471882, decouple_loss:0.01603209413588047
loss_pred:0.02980363555252552, decouple_loss:0.01611856371164322
The modified gen p mean: 0.4521111845970154, gen p mean: -0.6400609016418457, mean p set: 0.4525914490222931
loss_pred:0.03003321774303913, decouple_loss:0.016089623793959618
2023-05-01 20:54:44 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6557530164718628, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6454207897186279, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.6493716835975647, mean p set: 0.4500633478164673
loss_pred:0.030904680490493774, decouple_loss:0.017887385562062263
loss_pred:0.029281875118613243, decouple_loss:0.017585542052984238
loss_pred:0.029831159859895706, decouple_loss:0.017195478081703186
WV_0_PC_1_EH_0_PS_40_5, loss: 0.030883710831403732, avg_mse: 0.0353936105966568
current test mse: 0.035394
Iteration: 1321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493679106235504, gen p mean: -0.6468196511268616, mean p set: 0.4498482048511505
The modified gen p mean: 0.45179152488708496, gen p mean: -0.6439400911331177, mean p set: 0.45227181911468506
loss_pred:0.030388779938220978, decouple_loss:0.016186561435461044
The modified gen p mean: 0.44940486550331116, gen p mean: -0.6495487689971924, mean p set: 0.44988515973091125
loss_pred:0.030284777283668518, decouple_loss:0.015871595591306686
loss_pred:0.029663357883691788, decouple_loss:0.01602170802652836
Iteration: 1322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503987729549408, gen p mean: -0.645042896270752, mean p set: 0.4508790671825409
The modified gen p mean: 0.4519023597240448, gen p mean: -0.6475977897644043, mean p set: 0.4523826837539673The modified gen p mean: 0.4486233592033386, gen p mean: -0.6461915373802185, mean p set: 0.44910362362861633
loss_pred:0.02998924069106579, decouple_loss:0.015397208742797375
loss_pred:0.029280485585331917, decouple_loss:0.015725957229733467loss_pred:0.02899296022951603, decouple_loss:0.015679601579904556
Iteration: 1323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501669406890869, gen p mean: -0.6539194583892822, mean p set: 0.450647234916687
The modified gen p mean: 0.45234426856040955, gen p mean: -0.6470662355422974, mean p set: 0.45282456278800964
loss_pred:0.029663383960723877, decouple_loss:0.015622934326529503
loss_pred:0.030242949724197388, decouple_loss:0.015509769320487976
The modified gen p mean: 0.44924798607826233, gen p mean: -0.6471090912818909, mean p set: 0.4497282803058624
loss_pred:0.029280472546815872, decouple_loss:0.015309596434235573
Iteration: 1324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979164004325867, gen p mean: -0.6544021964073181, mean p set: 0.45027193427085876
The modified gen p mean: 0.4505055844783783, gen p mean: -0.6621710658073425, mean p set: 0.450985848903656
loss_pred:0.03008008934557438, decouple_loss:0.01547802984714508
loss_pred:0.02919500134885311, decouple_loss:0.015558418817818165
The modified gen p mean: 0.4522383213043213, gen p mean: -0.6638895869255066, mean p set: 0.4527186155319214
loss_pred:0.029445629566907883, decouple_loss:0.015860745683312416
Iteration: 1325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059144496917725, gen p mean: -0.6629295349121094, mean p set: 0.45107173919677734
The modified gen p mean: 0.44940727949142456, gen p mean: -0.6697471141815186, mean p set: 0.44988757371902466
loss_pred:0.029408005997538567, decouple_loss:0.014299360103905201
loss_pred:0.028210286051034927, decouple_loss:0.015687251463532448
The modified gen p mean: 0.4489685595035553, gen p mean: -0.6605100035667419, mean p set: 0.4494488537311554
loss_pred:0.028316929936408997, decouple_loss:0.014574612490832806
Iteration: 1326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975170493125916, gen p mean: -0.6690077185630798, mean p set: 0.45023199915885925
The modified gen p mean: 0.45205265283584595, gen p mean: -0.6659340858459473, mean p set: 0.45253291726112366
loss_pred:0.02879008650779724, decouple_loss:0.014769060537219048
loss_pred:0.029311705380678177, decouple_loss:0.015619887970387936
The modified gen p mean: 0.44886985421180725, gen p mean: -0.6594027280807495, mean p set: 0.44935014843940735
loss_pred:0.027608968317508698, decouple_loss:0.014503820799291134
Iteration: 1327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036736130714417, gen p mean: -0.6709781885147095, mean p set: 0.45084765553474426
The modified gen p mean: 0.45146384835243225, gen p mean: -0.6723199486732483, mean p set: 0.45194414258003235
loss_pred:0.028441259637475014, decouple_loss:0.014199670404195786
loss_pred:0.029666908085346222, decouple_loss:0.014952891506254673
The modified gen p mean: 0.45238858461380005, gen p mean: -0.6714444756507874, mean p set: 0.45286887884140015
loss_pred:0.028549062088131905, decouple_loss:0.01605040393769741
Iteration: 1328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874706864356995, gen p mean: -0.6761662364006042, mean p set: 0.44922736287117004
The modified gen p mean: 0.4505070447921753, gen p mean: -0.677871584892273, mean p set: 0.4509873688220978
loss_pred:0.029974132776260376, decouple_loss:0.015425927937030792
loss_pred:0.028879381716251373, decouple_loss:0.014191598631441593
The modified gen p mean: 0.4504108428955078, gen p mean: -0.6781121492385864, mean p set: 0.4508911669254303
loss_pred:0.029668908566236496, decouple_loss:0.015021836385130882
Iteration: 1329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520147144794464, gen p mean: -0.6630887389183044, mean p set: 0.4524949789047241
The modified gen p mean: 0.45041003823280334, gen p mean: -0.6543436646461487, mean p set: 0.45089030265808105
loss_pred:0.028882289305329323, decouple_loss:0.01603846251964569
loss_pred:0.030766120180487633, decouple_loss:0.014527001418173313
The modified gen p mean: 0.4496085047721863, gen p mean: -0.6561366319656372, mean p set: 0.4500887989997864
loss_pred:0.029505109414458275, decouple_loss:0.014211670495569706
Iteration: 1330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958770275115967, gen p mean: -0.6604423522949219, mean p set: 0.45006799697875977
The modified gen p mean: 0.44922390580177307, gen p mean: -0.6562901735305786, mean p set: 0.4497041702270508
loss_pred:0.028079375624656677, decouple_loss:0.014826559461653233
loss_pred:0.028492525219917297, decouple_loss:0.014873615466058254
The modified gen p mean: 0.45300352573394775, gen p mean: -0.6512332558631897, mean p set: 0.45348381996154785
loss_pred:0.03029615990817547, decouple_loss:0.01491022389382124
2023-05-01 20:56:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.6720510721206665, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6611284017562866, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6650503873825073, mean p set: 0.4500633478164673
loss_pred:0.030831018462777138, decouple_loss:0.017058059573173523
loss_pred:0.029262704774737358, decouple_loss:0.01634330116212368
loss_pred:0.029779674485325813, decouple_loss:0.016208866611123085
WV_0_PC_1_EH_0_PS_40_5, loss: 0.030784636735916138, avg_mse: 0.03552781045436859
current test mse: 0.035528
Iteration: 1331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141661167144775, gen p mean: -0.6629663109779358, mean p set: 0.45189690589904785
The modified gen p mean: 0.4496305584907532, gen p mean: -0.6619217991828918, mean p set: 0.45011085271835327
loss_pred:0.028503088280558586, decouple_loss:0.01517248060554266
The modified gen p mean: 0.4499431252479553, gen p mean: -0.6572983264923096, mean p set: 0.4504234194755554
loss_pred:0.029746240004897118, decouple_loss:0.01527475006878376
loss_pred:0.031039783731102943, decouple_loss:0.014300281181931496
Iteration: 1332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020562410354614, gen p mean: -0.6656880974769592, mean p set: 0.45068594813346863
The modified gen p mean: 0.45123109221458435, gen p mean: -0.6738370060920715, mean p set: 0.45171138644218445
loss_pred:0.029432782903313637, decouple_loss:0.014046977274119854
loss_pred:0.02948104590177536, decouple_loss:0.014988756738603115
The modified gen p mean: 0.450987309217453, gen p mean: -0.6676957607269287, mean p set: 0.4514676034450531
loss_pred:0.030006786808371544, decouple_loss:0.014272385276854038
Iteration: 1333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990274310112, gen p mean: -0.6825296878814697, mean p set: 0.4503830373287201
The modified gen p mean: 0.4495231807231903, gen p mean: -0.6789488196372986, mean p set: 0.4500034749507904
loss_pred:0.028602756559848785, decouple_loss:0.01541913766413927
loss_pred:0.03023364022374153, decouple_loss:0.014768312685191631
The modified gen p mean: 0.44960302114486694, gen p mean: -0.6710784435272217, mean p set: 0.45008331537246704
loss_pred:0.028953727334737778, decouple_loss:0.015294967219233513
Iteration: 1334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495670199394226, gen p mean: -0.658694326877594, mean p set: 0.4500472843647003
The modified gen p mean: 0.44906169176101685, gen p mean: -0.6648444533348083, mean p set: 0.44954198598861694
loss_pred:0.029652539640665054, decouple_loss:0.014788313768804073
loss_pred:0.029361145570874214, decouple_loss:0.01441727764904499
The modified gen p mean: 0.4526939392089844, gen p mean: -0.661239504814148, mean p set: 0.4531742036342621
loss_pred:0.030082371085882187, decouple_loss:0.015052356757223606
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 1335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475749433040619, gen p mean: -0.650191605091095, mean p set: 0.4480552673339844
loss_pred:0.029759708791971207, decouple_loss:0.015734044834971428
The modified gen p mean: 0.44847428798675537, gen p mean: -0.6487070322036743, mean p set: 0.44895458221435547The modified gen p mean: 0.44765833020210266, gen p mean: -0.6542361378669739, mean p set: 0.44813862442970276
loss_pred:0.029370315372943878, decouple_loss:0.016145044937729836
loss_pred:0.03071451559662819, decouple_loss:0.015833964571356773
Iteration: 1336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668376445770264, gen p mean: -0.6632099151611328, mean p set: 0.44716405868530273
The modified gen p mean: 0.4471588730812073, gen p mean: -0.6574240326881409, mean p set: 0.4476391673088074
loss_pred:0.02887922152876854, decouple_loss:0.01569456048309803
loss_pred:0.02937929332256317, decouple_loss:0.015380454249680042
The modified gen p mean: 0.44857507944107056, gen p mean: -0.6721802949905396, mean p set: 0.44905540347099304
loss_pred:0.029920877888798714, decouple_loss:0.01716218888759613
Iteration: 1337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476199746131897, gen p mean: -0.6739305853843689, mean p set: 0.4481002688407898
The modified gen p mean: 0.44617441296577454, gen p mean: -0.6671705842018127, mean p set: 0.44665467739105225
loss_pred:0.02964446134865284, decouple_loss:0.016494713723659515
loss_pred:0.029812965542078018, decouple_loss:0.014941777102649212
The modified gen p mean: 0.44645363092422485, gen p mean: -0.6670796871185303, mean p set: 0.44693389534950256
loss_pred:0.029082724824547768, decouple_loss:0.014883134514093399
Iteration: 1338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479162395000458, gen p mean: -0.6687644720077515, mean p set: 0.4483965039253235
The modified gen p mean: 0.44779494404792786, gen p mean: -0.6674457788467407, mean p set: 0.44827526807785034
loss_pred:0.02955033630132675, decouple_loss:0.015739742666482925
loss_pred:0.02981669083237648, decouple_loss:0.015493456274271011
The modified gen p mean: 0.44811391830444336, gen p mean: -0.6669072508811951, mean p set: 0.44859424233436584
loss_pred:0.03047078289091587, decouple_loss:0.01567043550312519
Iteration: 1339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44917911291122437, gen p mean: -0.6718472838401794, mean p set: 0.4496593773365021
The modified gen p mean: 0.44692468643188477, gen p mean: -0.6748905181884766, mean p set: 0.44740498065948486
loss_pred:0.02930646575987339, decouple_loss:0.015995098277926445
loss_pred:0.0289036575704813, decouple_loss:0.015346014872193336
The modified gen p mean: 0.44797995686531067, gen p mean: -0.6670785546302795, mean p set: 0.44846025109291077
loss_pred:0.028539320454001427, decouple_loss:0.015793778002262115
Iteration: 1340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484352171421051, gen p mean: -0.676882266998291, mean p set: 0.4489155113697052
The modified gen p mean: 0.44713103771209717, gen p mean: -0.6819517612457275, mean p set: 0.44761136174201965
loss_pred:0.029265625402331352, decouple_loss:0.016415858641266823
loss_pred:0.028322337195277214, decouple_loss:0.014608384110033512
The modified gen p mean: 0.4478197395801544, gen p mean: -0.6840731501579285, mean p set: 0.44829997420310974
loss_pred:0.029564043506979942, decouple_loss:0.015589194372296333
2023-05-01 20:59:38 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6844186782836914, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6731093525886536, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6770765781402588, mean p set: 0.4500633478164673
loss_pred:0.030525362119078636, decouple_loss:0.016834739595651627
loss_pred:0.028941288590431213, decouple_loss:0.015848195180296898
loss_pred:0.029408639296889305, decouple_loss:0.0159438643604517
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03043554536998272, avg_mse: 0.03485317900776863
current test mse: 0.034853
Iteration: 1341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479027986526489, gen p mean: -0.6750584840774536, mean p set: 0.4483831226825714
The modified gen p mean: 0.44767674803733826, gen p mean: -0.6741162538528442, mean p set: 0.44815701246261597
loss_pred:0.02889656461775303, decouple_loss:0.015260507352650166
The modified gen p mean: 0.4483543634414673, gen p mean: -0.6735964417457581, mean p set: 0.4488346576690674
loss_pred:0.029921503737568855, decouple_loss:0.015973325818777084
loss_pred:0.029675783589482307, decouple_loss:0.016086863353848457
Iteration: 1342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977763295173645, gen p mean: -0.6564019322395325, mean p set: 0.45025789737701416
The modified gen p mean: 0.4489873945713043, gen p mean: -0.655292809009552, mean p set: 0.4494676887989044
loss_pred:0.028865419328212738, decouple_loss:0.015666473656892776
loss_pred:0.029137004166841507, decouple_loss:0.0157461017370224
The modified gen p mean: 0.44643887877464294, gen p mean: -0.6676364541053772, mean p set: 0.44691917300224304
loss_pred:0.029784323647618294, decouple_loss:0.015856429934501648
Iteration: 1343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826120138168335, gen p mean: -0.6458597779273987, mean p set: 0.44874149560928345
The modified gen p mean: 0.4472024440765381, gen p mean: -0.6505699157714844, mean p set: 0.4476827085018158
loss_pred:0.02829507552087307, decouple_loss:0.014975651167333126
loss_pred:0.029540253803133965, decouple_loss:0.01540821511298418
The modified gen p mean: 0.4482094943523407, gen p mean: -0.6523349285125732, mean p set: 0.4486897885799408
loss_pred:0.0293548833578825, decouple_loss:0.01445898786187172
Iteration: 1344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483236074447632, gen p mean: -0.655936062335968, mean p set: 0.4488039016723633
The modified gen p mean: 0.44900399446487427, gen p mean: -0.6597230434417725, mean p set: 0.449484258890152
loss_pred:0.02768084593117237, decouple_loss:0.014510485343635082
loss_pred:0.0290250014513731, decouple_loss:0.01448022574186325
The modified gen p mean: 0.449349045753479, gen p mean: -0.6549754738807678, mean p set: 0.4498293101787567
loss_pred:0.028869111090898514, decouple_loss:0.014768801629543304
Iteration: 1345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483950734138489, gen p mean: -0.6645078659057617, mean p set: 0.448875367641449
loss_pred:0.029291553422808647, decouple_loss:0.014875433407723904
The modified gen p mean: 0.4473644196987152, gen p mean: -0.6686906218528748, mean p set: 0.4478446841239929The modified gen p mean: 0.4477499723434448, gen p mean: -0.6622775793075562, mean p set: 0.4482302665710449
loss_pred:0.029887953773140907, decouple_loss:0.0144698116928339
loss_pred:0.02855222299695015, decouple_loss:0.01431968342512846
Iteration: 1346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948098063468933, gen p mean: -0.6588467359542847, mean p set: 0.4499613046646118
The modified gen p mean: 0.44762831926345825, gen p mean: -0.6594847440719604, mean p set: 0.44810861349105835
loss_pred:0.029045017436146736, decouple_loss:0.014531930908560753
loss_pred:0.028960488736629486, decouple_loss:0.014813076704740524
The modified gen p mean: 0.4469769597053528, gen p mean: -0.6594141125679016, mean p set: 0.4474572539329529
loss_pred:0.029290521517395973, decouple_loss:0.01499838288873434
Iteration: 1347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466054439544678, gen p mean: -0.6616031527519226, mean p set: 0.4470857083797455
loss_pred:0.03013654425740242, decouple_loss:0.014928881078958511
The modified gen p mean: 0.4475136697292328, gen p mean: -0.6639925241470337, mean p set: 0.4479939937591553The modified gen p mean: 0.44738584756851196, gen p mean: -0.6583829522132874, mean p set: 0.4478660821914673
loss_pred:0.029293667525053024, decouple_loss:0.014708804897964
loss_pred:0.02934984862804413, decouple_loss:0.014675304293632507
Iteration: 1348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828876852989197, gen p mean: -0.6601148247718811, mean p set: 0.44876906275749207
The modified gen p mean: 0.44743579626083374, gen p mean: -0.6692896485328674, mean p set: 0.44791606068611145loss_pred:0.028038322925567627, decouple_loss:0.014638985507190228
The modified gen p mean: 0.446787029504776, gen p mean: -0.6681506037712097, mean p set: 0.4472673535346985
loss_pred:0.02941623516380787, decouple_loss:0.014789007604122162
loss_pred:0.02922775223851204, decouple_loss:0.015398185700178146
Iteration: 1349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472697675228119, gen p mean: -0.6615428924560547, mean p set: 0.4477500915527344
The modified gen p mean: 0.4469151496887207, gen p mean: -0.666064977645874, mean p set: 0.4473954439163208
loss_pred:0.02981949783861637, decouple_loss:0.01393064670264721
loss_pred:0.02999664843082428, decouple_loss:0.014354323036968708
The modified gen p mean: 0.44778189063072205, gen p mean: -0.6601190567016602, mean p set: 0.44826218485832214
loss_pred:0.02902655489742756, decouple_loss:0.014400835148990154
Iteration: 1350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798728823661804, gen p mean: -0.662559986114502, mean p set: 0.44846752285957336
The modified gen p mean: 0.448159396648407, gen p mean: -0.6615341305732727, mean p set: 0.4486396908760071
loss_pred:0.02808671072125435, decouple_loss:0.014498215168714523
loss_pred:0.029489342123270035, decouple_loss:0.014681639149785042
The modified gen p mean: 0.4468684494495392, gen p mean: -0.6716322898864746, mean p set: 0.4473487436771393
loss_pred:0.029133794829249382, decouple_loss:0.014652068726718426
2023-05-01 21:01:47 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6707973480224609, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6607909798622131, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6648685336112976, mean p set: 0.4500633478164673
loss_pred:0.030233070254325867, decouple_loss:0.01534246001392603
loss_pred:0.028779465705156326, decouple_loss:0.014434285461902618
loss_pred:0.029130155220627785, decouple_loss:0.014245427213609219
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03011460229754448, avg_mse: 0.03448285162448883
current test mse: 0.034483
Iteration: 1351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851401448249817, gen p mean: -0.660649299621582, mean p set: 0.4489942789077759
The modified gen p mean: 0.44793081283569336, gen p mean: -0.6661491394042969, mean p set: 0.44841110706329346
loss_pred:0.02875140681862831, decouple_loss:0.015080850571393967
The modified gen p mean: 0.4479478597640991, gen p mean: -0.6642262935638428, mean p set: 0.4484281837940216
loss_pred:0.030383918434381485, decouple_loss:0.013842212967574596
loss_pred:0.030195720493793488, decouple_loss:0.014498859643936157
Iteration: 1352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480445683002472, gen p mean: -0.6586726903915405, mean p set: 0.4485248327255249
The modified gen p mean: 0.4477563798427582, gen p mean: -0.6631775498390198, mean p set: 0.4482366442680359
loss_pred:0.02815181203186512, decouple_loss:0.0138844083994627
loss_pred:0.028160301968455315, decouple_loss:0.013984661549329758
The modified gen p mean: 0.4481048285961151, gen p mean: -0.6614879965782166, mean p set: 0.4485850930213928
loss_pred:0.027628669515252113, decouple_loss:0.01408021803945303
Iteration: 1353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472668766975403, gen p mean: -0.6659634113311768, mean p set: 0.447747141122818
The modified gen p mean: 0.4479721784591675, gen p mean: -0.6656141877174377, mean p set: 0.4484524726867676
loss_pred:0.02844439446926117, decouple_loss:0.013933643698692322
loss_pred:0.028937142342329025, decouple_loss:0.013946815393865108
The modified gen p mean: 0.44802576303482056, gen p mean: -0.6620849370956421, mean p set: 0.44850608706474304
loss_pred:0.02765883319079876, decouple_loss:0.013963787816464901
Iteration: 1354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690239429473877, gen p mean: -0.658760666847229, mean p set: 0.44738268852233887
The modified gen p mean: 0.4486221969127655, gen p mean: -0.6577318906784058, mean p set: 0.4491024613380432
loss_pred:0.02947242371737957, decouple_loss:0.014635463245213032
loss_pred:0.02827577479183674, decouple_loss:0.013699603267014027
The modified gen p mean: 0.44687360525131226, gen p mean: -0.6639481782913208, mean p set: 0.44735386967658997
loss_pred:0.02993755415081978, decouple_loss:0.014122062362730503
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
NaN value num: 0
Iteration: 1355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975900650024414, gen p mean: -0.6643099188804626, mean p set: 0.45023927092552185
loss_pred:0.029695477336645126, decouple_loss:0.01661917380988598
The modified gen p mean: 0.45153066515922546, gen p mean: -0.6778789162635803, mean p set: 0.4520109295845032The modified gen p mean: 0.4525910019874573, gen p mean: -0.6594023704528809, mean p set: 0.4530712962150574
loss_pred:0.028519731014966965, decouple_loss:0.017410440370440483
loss_pred:0.02787615917623043, decouple_loss:0.015829220414161682
Iteration: 1356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519859254360199, gen p mean: -0.6702126860618591, mean p set: 0.45246621966362
The modified gen p mean: 0.4500044584274292, gen p mean: -0.6713071465492249, mean p set: 0.4504847228527069
loss_pred:0.027448732405900955, decouple_loss:0.016244811937212944
loss_pred:0.028733672574162483, decouple_loss:0.01588496007025242
The modified gen p mean: 0.450872540473938, gen p mean: -0.6662933230400085, mean p set: 0.4513528347015381
loss_pred:0.02979225665330887, decouple_loss:0.016289792954921722
Iteration: 1357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45269447565078735, gen p mean: -0.6736487150192261, mean p set: 0.45317476987838745
The modified gen p mean: 0.4501611590385437, gen p mean: -0.6708693504333496, mean p set: 0.4506414532661438
loss_pred:0.028207596391439438, decouple_loss:0.015480021014809608
loss_pred:0.028727132827043533, decouple_loss:0.01550314761698246
The modified gen p mean: 0.4532754719257355, gen p mean: -0.6730427742004395, mean p set: 0.45375576615333557
loss_pred:0.02809915691614151, decouple_loss:0.015063662081956863
Iteration: 1358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526135325431824, gen p mean: -0.6648112535476685, mean p set: 0.4530937969684601
The modified gen p mean: 0.4511748254299164, gen p mean: -0.6753436923027039, mean p set: 0.4516550898551941
loss_pred:0.02822648547589779, decouple_loss:0.014604223892092705
loss_pred:0.02875937893986702, decouple_loss:0.015355485491454601
The modified gen p mean: 0.45123565196990967, gen p mean: -0.6660066843032837, mean p set: 0.4517159163951874
loss_pred:0.029883945360779762, decouple_loss:0.015339802950620651
Iteration: 1359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520549774169922, gen p mean: -0.6614835262298584, mean p set: 0.4525352716445923
The modified gen p mean: 0.4511377513408661, gen p mean: -0.6757669448852539, mean p set: 0.4516180753707886
loss_pred:0.029743356630206108, decouple_loss:0.015215137042105198
loss_pred:0.02802138403058052, decouple_loss:0.01622285507619381
The modified gen p mean: 0.4516717791557312, gen p mean: -0.6639055609703064, mean p set: 0.4521520435810089
loss_pred:0.027968620881438255, decouple_loss:0.01511977519840002
Iteration: 1360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516910910606384, gen p mean: -0.6729856729507446, mean p set: 0.4521713852882385
The modified gen p mean: 0.44911253452301025, gen p mean: -0.6637736558914185, mean p set: 0.44959282875061035
loss_pred:0.027803881093859673, decouple_loss:0.015235033817589283
loss_pred:0.0288205835968256, decouple_loss:0.015212113037705421
The modified gen p mean: 0.4506045877933502, gen p mean: -0.6674429774284363, mean p set: 0.45108485221862793
loss_pred:0.02807338535785675, decouple_loss:0.01534682884812355
2023-05-01 21:04:29 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.668347179889679, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6582593321800232, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6620291471481323, mean p set: 0.4500633478164673
loss_pred:0.030342502519488335, decouple_loss:0.016978736966848373
loss_pred:0.028806161135435104, decouple_loss:0.01672697439789772
loss_pred:0.029168106615543365, decouple_loss:0.016333695501089096
WV_0_PC_1_EH_0_PS_40_5, loss: 0.030272912234067917, avg_mse: 0.034734614193439484
current test mse: 0.034735
Iteration: 1361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118018984794617, gen p mean: -0.6620843410491943, mean p set: 0.45166051387786865
The modified gen p mean: 0.45255064964294434, gen p mean: -0.6498419642448425, mean p set: 0.4530309736728668
loss_pred:0.02781456708908081, decouple_loss:0.015493842773139477
The modified gen p mean: 0.4524647891521454, gen p mean: -0.6563884019851685, mean p set: 0.45294511318206787
loss_pred:0.028506990522146225, decouple_loss:0.016364173963665962
loss_pred:0.026869436725974083, decouple_loss:0.014597771689295769
Iteration: 1362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45263397693634033, gen p mean: -0.650823175907135, mean p set: 0.45311427116394043
The modified gen p mean: 0.452853798866272, gen p mean: -0.6618308424949646, mean p set: 0.4533340632915497
loss_pred:0.027621658518910408, decouple_loss:0.016101300716400146
loss_pred:0.02862490713596344, decouple_loss:0.014553572982549667
The modified gen p mean: 0.45209184288978577, gen p mean: -0.6557868719100952, mean p set: 0.45257216691970825
loss_pred:0.02819519117474556, decouple_loss:0.015084711834788322
Iteration: 1363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45247066020965576, gen p mean: -0.6552258729934692, mean p set: 0.45295095443725586
The modified gen p mean: 0.45114395022392273, gen p mean: -0.6658288240432739, mean p set: 0.4516242742538452loss_pred:0.02752571552991867, decouple_loss:0.015207106247544289
The modified gen p mean: 0.45204970240592957, gen p mean: -0.6604830622673035, mean p set: 0.45252999663352966
loss_pred:0.028335129842162132, decouple_loss:0.014657571911811829
loss_pred:0.028116265311837196, decouple_loss:0.014852660708129406
Iteration: 1364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496479034423828, gen p mean: -0.6632238626480103, mean p set: 0.4501282274723053
The modified gen p mean: 0.4495428800582886, gen p mean: -0.669821560382843, mean p set: 0.4500231444835663
loss_pred:0.029336461797356606, decouple_loss:0.014844926074147224
loss_pred:0.02936442196369171, decouple_loss:0.014793642796576023
The modified gen p mean: 0.45232534408569336, gen p mean: -0.6850279569625854, mean p set: 0.45280560851097107
loss_pred:0.02753565087914467, decouple_loss:0.015539026819169521
Iteration: 1365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45268040895462036, gen p mean: -0.6878849267959595, mean p set: 0.45316070318222046
The modified gen p mean: 0.4539457857608795, gen p mean: -0.6848089098930359, mean p set: 0.4544260501861572
loss_pred:0.02787347137928009, decouple_loss:0.015364605002105236
loss_pred:0.029013296589255333, decouple_loss:0.014919503591954708
The modified gen p mean: 0.4510084390640259, gen p mean: -0.6812302470207214, mean p set: 0.45148876309394836
loss_pred:0.028536807745695114, decouple_loss:0.014281503856182098
Iteration: 1366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522540867328644, gen p mean: -0.6708572506904602, mean p set: 0.4527343511581421
The modified gen p mean: 0.45129072666168213, gen p mean: -0.6708691120147705, mean p set: 0.45177099108695984loss_pred:0.027845608070492744, decouple_loss:0.014923857524991035
The modified gen p mean: 0.4516836702823639, gen p mean: -0.674676775932312, mean p set: 0.4521639347076416
loss_pred:0.028142888098955154, decouple_loss:0.015243614092469215
loss_pred:0.028539171442389488, decouple_loss:0.01493848953396082
Iteration: 1367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45280054211616516, gen p mean: -0.6785770654678345, mean p set: 0.45328083634376526
The modified gen p mean: 0.4500288963317871, gen p mean: -0.6800808906555176, mean p set: 0.4505091905593872
loss_pred:0.02819555439054966, decouple_loss:0.014018087647855282
loss_pred:0.02907034009695053, decouple_loss:0.014304871670901775
The modified gen p mean: 0.45276185870170593, gen p mean: -0.6757490038871765, mean p set: 0.45324212312698364
loss_pred:0.026845170184969902, decouple_loss:0.01449869479984045
Iteration: 1368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926100969314575, gen p mean: -0.690311074256897, mean p set: 0.44974127411842346
The modified gen p mean: 0.45258569717407227, gen p mean: -0.6776570081710815, mean p set: 0.45306602120399475
loss_pred:0.028480172157287598, decouple_loss:0.01473173312842846
loss_pred:0.028209736570715904, decouple_loss:0.0144011490046978
The modified gen p mean: 0.4509732723236084, gen p mean: -0.6828965544700623, mean p set: 0.4514535665512085
loss_pred:0.028413232415914536, decouple_loss:0.01388015877455473
Iteration: 1369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.455077588558197, gen p mean: -0.6851746439933777, mean p set: 0.4555578827857971
The modified gen p mean: 0.4508156180381775, gen p mean: -0.6964662075042725, mean p set: 0.4512959122657776
loss_pred:0.02892976813018322, decouple_loss:0.014271151274442673
loss_pred:0.027421943843364716, decouple_loss:0.01501516904681921
The modified gen p mean: 0.4519517719745636, gen p mean: -0.6756798028945923, mean p set: 0.4524320662021637
loss_pred:0.027711596339941025, decouple_loss:0.0138092627748847
Iteration: 1370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450425922870636, gen p mean: -0.6814418435096741, mean p set: 0.4509062170982361
The modified gen p mean: 0.4535921514034271, gen p mean: -0.6788517832756042, mean p set: 0.4540724456310272
loss_pred:0.028943223878741264, decouple_loss:0.014560427516698837
loss_pred:0.028292322531342506, decouple_loss:0.01418166235089302
The modified gen p mean: 0.45326367020606995, gen p mean: -0.6802857518196106, mean p set: 0.45374393463134766
loss_pred:0.027501128613948822, decouple_loss:0.014034994877874851
2023-05-01 21:06:39 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.684196949005127, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6775901913642883, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6732578873634338, mean p set: 0.45035696029663086
loss_pred:0.030457625165581703, decouple_loss:0.016825133934617043
loss_pred:0.029319144785404205, decouple_loss:0.01612178422510624
loss_pred:0.028963739052414894, decouple_loss:0.01647302322089672
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03040383756160736, avg_mse: 0.03502107784152031
current test mse: 0.035021
Iteration: 1371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206841826438904, gen p mean: -0.6764229536056519, mean p set: 0.45254871249198914
loss_pred:0.029124857857823372, decouple_loss:0.01443107146769762
The modified gen p mean: 0.4507342576980591, gen p mean: -0.6833443641662598, mean p set: 0.4512145519256592The modified gen p mean: 0.4494982361793518, gen p mean: -0.6798283457756042, mean p set: 0.44997847080230713
loss_pred:0.028852902352809906, decouple_loss:0.014699837192893028
loss_pred:0.028933171182870865, decouple_loss:0.014651641249656677
Iteration: 1372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509032368659973, gen p mean: -0.6936183571815491, mean p set: 0.4513835310935974
The modified gen p mean: 0.4514251947402954, gen p mean: -0.6791712045669556, mean p set: 0.4519054889678955loss_pred:0.02829587832093239, decouple_loss:0.014177260920405388
The modified gen p mean: 0.4517531096935272, gen p mean: -0.6786242127418518, mean p set: 0.4522334337234497
loss_pred:0.027732813730835915, decouple_loss:0.014200020581483841
loss_pred:0.028191065415740013, decouple_loss:0.014621096663177013
Iteration: 1373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513115882873535, gen p mean: -0.685863733291626, mean p set: 0.4517918825149536
The modified gen p mean: 0.45117953419685364, gen p mean: -0.6897802948951721, mean p set: 0.45165982842445374
loss_pred:0.027757108211517334, decouple_loss:0.013885878026485443
loss_pred:0.02847684733569622, decouple_loss:0.013528937473893166
The modified gen p mean: 0.45212826132774353, gen p mean: -0.7026787400245667, mean p set: 0.45260855555534363
loss_pred:0.02776367776095867, decouple_loss:0.014351146295666695
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
NaN value num: 0
Iteration: 1374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673311710357666, gen p mean: -0.6972089409828186, mean p set: 0.44721341133117676
loss_pred:0.03064100816845894, decouple_loss:0.0158875472843647
The modified gen p mean: 0.4463730454444885, gen p mean: -0.7014662623405457, mean p set: 0.446853369474411The modified gen p mean: 0.4464389681816101, gen p mean: -0.6933205723762512, mean p set: 0.4469192922115326
loss_pred:0.031040381640195847, decouple_loss:0.01823953539133072
loss_pred:0.03183266520500183, decouple_loss:0.017323320731520653
Iteration: 1375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479420483112335, gen p mean: -0.6860029697418213, mean p set: 0.44842231273651123
The modified gen p mean: 0.44826656579971313, gen p mean: -0.6895344853401184, mean p set: 0.44874683022499084
loss_pred:0.031632307916879654, decouple_loss:0.01567857898771763
loss_pred:0.030228687450289726, decouple_loss:0.015507504343986511
The modified gen p mean: 0.4461131691932678, gen p mean: -0.6842367649078369, mean p set: 0.4465934634208679
loss_pred:0.02992810681462288, decouple_loss:0.016365673393011093
Iteration: 1376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461911916732788, gen p mean: -0.6846152544021606, mean p set: 0.4466714859008789
The modified gen p mean: 0.4460814893245697, gen p mean: -0.6808221340179443, mean p set: 0.4465617835521698
loss_pred:0.03012995608150959, decouple_loss:0.01453994307667017
loss_pred:0.029813146218657494, decouple_loss:0.015463334508240223
The modified gen p mean: 0.4456440508365631, gen p mean: -0.6803382635116577, mean p set: 0.4461243748664856
loss_pred:0.029913051053881645, decouple_loss:0.015466234646737576
Iteration: 1377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801342487335205, gen p mean: -0.6880951523780823, mean p set: 0.44849371910095215
The modified gen p mean: 0.4479556679725647, gen p mean: -0.6840171813964844, mean p set: 0.4484359920024872
loss_pred:0.030526375398039818, decouple_loss:0.015153773128986359
loss_pred:0.0295448899269104, decouple_loss:0.015577473677694798
The modified gen p mean: 0.44809529185295105, gen p mean: -0.6837456822395325, mean p set: 0.44857561588287354
loss_pred:0.030042145401239395, decouple_loss:0.015934133902192116
Iteration: 1378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486715495586395, gen p mean: -0.6920501589775085, mean p set: 0.44915181398391724
The modified gen p mean: 0.44561800360679626, gen p mean: -0.6862993240356445, mean p set: 0.446098268032074The modified gen p mean: 0.4473837912082672, gen p mean: -0.6959058046340942, mean p set: 0.4478640854358673
loss_pred:0.030472513288259506, decouple_loss:0.015805106610059738
loss_pred:0.03055664151906967, decouple_loss:0.015223773196339607
loss_pred:0.029946090653538704, decouple_loss:0.015367346815764904
Iteration: 1379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781437516212463, gen p mean: -0.6986319422721863, mean p set: 0.44829463958740234
loss_pred:0.030849682167172432, decouple_loss:0.016606993973255157
The modified gen p mean: 0.4459565281867981, gen p mean: -0.6976006627082825, mean p set: 0.4464368224143982
The modified gen p mean: 0.4484342038631439, gen p mean: -0.6928444504737854, mean p set: 0.448914498090744
loss_pred:0.030180923640727997, decouple_loss:0.014803249388933182
loss_pred:0.03006521426141262, decouple_loss:0.01575346477329731
Iteration: 1380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464631974697113, gen p mean: -0.6981460452079773, mean p set: 0.4469434916973114
The modified gen p mean: 0.4470158815383911, gen p mean: -0.7017953395843506, mean p set: 0.4474962055683136
loss_pred:0.030271513387560844, decouple_loss:0.015340548008680344
loss_pred:0.030361173674464226, decouple_loss:0.014851825311779976
The modified gen p mean: 0.44737508893013, gen p mean: -0.7053468227386475, mean p set: 0.4478553533554077
loss_pred:0.031016618013381958, decouple_loss:0.016177603974938393
2023-05-01 21:09:25 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.6959035396575928, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6852313876152039, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6896621584892273, mean p set: 0.4500633478164673
loss_pred:0.0302110705524683, decouple_loss:0.01653978042304516
loss_pred:0.028816211968660355, decouple_loss:0.016093213111162186
loss_pred:0.0292759258300066, decouple_loss:0.01597200520336628
WV_0_PC_1_EH_0_PS_40_5, loss: 0.030244484543800354, avg_mse: 0.034845780581235886
current test mse: 0.034846
Iteration: 1381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469863176345825, gen p mean: -0.7014927864074707, mean p set: 0.44746658205986023
The modified gen p mean: 0.44728416204452515, gen p mean: -0.6933332085609436, mean p set: 0.44776445627212524
loss_pred:0.031116388738155365, decouple_loss:0.015154048800468445
The modified gen p mean: 0.44791150093078613, gen p mean: -0.6925565600395203, mean p set: 0.44839179515838623
loss_pred:0.030226796865463257, decouple_loss:0.01630502939224243
loss_pred:0.02976183034479618, decouple_loss:0.015607533976435661
Iteration: 1382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815319776535034, gen p mean: -0.6825643181800842, mean p set: 0.44863349199295044
The modified gen p mean: 0.447870135307312, gen p mean: -0.6851063966751099, mean p set: 0.4483503997325897
loss_pred:0.029490666463971138, decouple_loss:0.01533267367631197
loss_pred:0.029141627252101898, decouple_loss:0.01558011956512928
The modified gen p mean: 0.44770678877830505, gen p mean: -0.6804146766662598, mean p set: 0.44818708300590515
loss_pred:0.02980049140751362, decouple_loss:0.015517056919634342
Iteration: 1383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780197739601135, gen p mean: -0.6819339990615845, mean p set: 0.44828227162361145
The modified gen p mean: 0.44780203700065613, gen p mean: -0.6803442239761353, mean p set: 0.4482823610305786
loss_pred:0.03126084432005882, decouple_loss:0.015852170065045357
loss_pred:0.02953949011862278, decouple_loss:0.014651200734078884
The modified gen p mean: 0.445488303899765, gen p mean: -0.6810374855995178, mean p set: 0.4459685981273651
loss_pred:0.02923833578824997, decouple_loss:0.014989587478339672
Iteration: 1384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473395347595215, gen p mean: -0.6848329305648804, mean p set: 0.4478198289871216
The modified gen p mean: 0.4472610652446747, gen p mean: -0.6842756867408752, mean p set: 0.44774138927459717
loss_pred:0.028880996629595757, decouple_loss:0.014722141437232494
loss_pred:0.03027450293302536, decouple_loss:0.01577138900756836
The modified gen p mean: 0.4470379650592804, gen p mean: -0.6916121244430542, mean p set: 0.4475182592868805
loss_pred:0.030438119545578957, decouple_loss:0.015808451920747757
Iteration: 1385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477015435695648, gen p mean: -0.6931390762329102, mean p set: 0.4481818377971649
The modified gen p mean: 0.4469752311706543, gen p mean: -0.6868060231208801, mean p set: 0.4474555552005768
loss_pred:0.030213991180062294, decouple_loss:0.014992086216807365
loss_pred:0.030401460826396942, decouple_loss:0.014433502219617367
The modified gen p mean: 0.44699329137802124, gen p mean: -0.6968873739242554, mean p set: 0.44747358560562134
loss_pred:0.03017991967499256, decouple_loss:0.014727979898452759
Iteration: 1386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477238655090332, gen p mean: -0.6888801455497742, mean p set: 0.4482041299343109
The modified gen p mean: 0.4473097324371338, gen p mean: -0.6838421821594238, mean p set: 0.4477900266647339
loss_pred:0.02892448753118515, decouple_loss:0.014373053796589375
loss_pred:0.03003133088350296, decouple_loss:0.015235396102070808
The modified gen p mean: 0.4472595155239105, gen p mean: -0.6886239051818848, mean p set: 0.4477398097515106
loss_pred:0.03086492419242859, decouple_loss:0.014523719437420368
Iteration: 1387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741547107696533, gen p mean: -0.6889423131942749, mean p set: 0.44789573550224304
The modified gen p mean: 0.4462970495223999, gen p mean: -0.6827744841575623, mean p set: 0.44677734375
loss_pred:0.030443547293543816, decouple_loss:0.014452607370913029
loss_pred:0.02942940592765808, decouple_loss:0.014954688027501106
The modified gen p mean: 0.4471263885498047, gen p mean: -0.6824998259544373, mean p set: 0.4476066827774048
loss_pred:0.029372654855251312, decouple_loss:0.014345858246088028
Iteration: 1388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464641809463501, gen p mean: -0.6914103627204895, mean p set: 0.4469445049762726
The modified gen p mean: 0.4469386339187622, gen p mean: -0.6805130243301392, mean p set: 0.4474189281463623
loss_pred:0.02950943075120449, decouple_loss:0.014552376233041286
loss_pred:0.02980118989944458, decouple_loss:0.014052382670342922
The modified gen p mean: 0.44687533378601074, gen p mean: -0.6824281215667725, mean p set: 0.44735562801361084
loss_pred:0.02920052781701088, decouple_loss:0.013813444413244724
Iteration: 1389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476120173931122, gen p mean: -0.6865704655647278, mean p set: 0.4480923116207123
The modified gen p mean: 0.4464874863624573, gen p mean: -0.6836761832237244, mean p set: 0.4469677805900574
loss_pred:0.029945502057671547, decouple_loss:0.014629486948251724
loss_pred:0.02962026558816433, decouple_loss:0.014663413166999817
The modified gen p mean: 0.44642043113708496, gen p mean: -0.6856334805488586, mean p set: 0.44690072536468506
loss_pred:0.0299134012311697, decouple_loss:0.014496175572276115
Iteration: 1390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800689816474915, gen p mean: -0.6820453405380249, mean p set: 0.44848719239234924
The modified gen p mean: 0.4471037983894348, gen p mean: -0.6904118061065674, mean p set: 0.4475840926170349
loss_pred:0.02993735671043396, decouple_loss:0.014388445764780045
loss_pred:0.02896367385983467, decouple_loss:0.01383218728005886
The modified gen p mean: 0.4468676745891571, gen p mean: -0.6881193518638611, mean p set: 0.4473479390144348
loss_pred:0.03042900748550892, decouple_loss:0.01511609461158514
2023-05-01 21:11:33 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6800152063369751, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6702589392662048, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6741622686386108, mean p set: 0.4500633478164673
loss_pred:0.03005724400281906, decouple_loss:0.01491808332502842
loss_pred:0.028594890609383583, decouple_loss:0.014724730513989925
loss_pred:0.029063258320093155, decouple_loss:0.014485265128314495
WV_0_PC_1_EH_0_PS_40_5, loss: 0.029973935335874557, avg_mse: 0.034525297582149506
current test mse: 0.034525
Iteration: 1391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656896591186523, gen p mean: -0.6763917803764343, mean p set: 0.44704926013946533
The modified gen p mean: 0.44664090871810913, gen p mean: -0.6790898442268372, mean p set: 0.44712120294570923
loss_pred:0.030496738851070404, decouple_loss:0.013844366185367107
The modified gen p mean: 0.4460989236831665, gen p mean: -0.6711077094078064, mean p set: 0.4465792179107666
loss_pred:0.030292965471744537, decouple_loss:0.013875567354261875
loss_pred:0.02969471365213394, decouple_loss:0.014028126373887062
Iteration: 1392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478501081466675, gen p mean: -0.6776559352874756, mean p set: 0.4483303725719452
The modified gen p mean: 0.44679510593414307, gen p mean: -0.6730589270591736, mean p set: 0.44727540016174316
loss_pred:0.03004465252161026, decouple_loss:0.014064105227589607
loss_pred:0.029542528092861176, decouple_loss:0.014367741532623768
The modified gen p mean: 0.44695407152175903, gen p mean: -0.6671614646911621, mean p set: 0.44743436574935913
loss_pred:0.02855127491056919, decouple_loss:0.014001461677253246
Iteration: 1393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674113392829895, gen p mean: -0.6737234592437744, mean p set: 0.44722142815589905
The modified gen p mean: 0.44760680198669434, gen p mean: -0.6739133596420288, mean p set: 0.4480871260166168
loss_pred:0.030802469700574875, decouple_loss:0.014354187995195389
loss_pred:0.02965029887855053, decouple_loss:0.014132716692984104
The modified gen p mean: 0.446698933839798, gen p mean: -0.6751592755317688, mean p set: 0.44717922806739807
loss_pred:0.030247488990426064, decouple_loss:0.013406247831881046
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
NaN value num: 0
Iteration: 1394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490357041358948, gen p mean: -0.684719979763031, mean p set: 0.4495159983634949
loss_pred:0.03092922456562519, decouple_loss:0.014382774010300636
The modified gen p mean: 0.44984233379364014, gen p mean: -0.6723915934562683, mean p set: 0.45032259821891785The modified gen p mean: 0.45060786604881287, gen p mean: -0.6744799017906189, mean p set: 0.45108816027641296
loss_pred:0.030907899141311646, decouple_loss:0.015070204623043537
loss_pred:0.029556144028902054, decouple_loss:0.015173664316534996
Iteration: 1395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502841830253601, gen p mean: -0.6815929412841797, mean p set: 0.4507644772529602
The modified gen p mean: 0.44944414496421814, gen p mean: -0.685467541217804, mean p set: 0.44992440938949585
loss_pred:0.03141527995467186, decouple_loss:0.014977267943322659
loss_pred:0.02983972243964672, decouple_loss:0.014190584421157837The modified gen p mean: 0.4503733515739441, gen p mean: -0.6773937344551086, mean p set: 0.4508536458015442
loss_pred:0.03049401193857193, decouple_loss:0.014387615956366062
Iteration: 1396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505566358566284, gen p mean: -0.6735215187072754, mean p set: 0.4510369300842285
The modified gen p mean: 0.45022648572921753, gen p mean: -0.6723344326019287, mean p set: 0.45070680975914
loss_pred:0.03123430162668228, decouple_loss:0.01500158291310072
loss_pred:0.030872434377670288, decouple_loss:0.014544105157256126
The modified gen p mean: 0.44963276386260986, gen p mean: -0.6766477227210999, mean p set: 0.4501130282878876
loss_pred:0.030286801978945732, decouple_loss:0.014394099824130535
Iteration: 1397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497458040714264, gen p mean: -0.6698160171508789, mean p set: 0.4502260982990265
The modified gen p mean: 0.4489953815937042, gen p mean: -0.6827041506767273, mean p set: 0.4494756758213043
loss_pred:0.030854715034365654, decouple_loss:0.013539130799472332
loss_pred:0.030527010560035706, decouple_loss:0.01419516745954752
The modified gen p mean: 0.4495774507522583, gen p mean: -0.6762420535087585, mean p set: 0.4500577449798584
loss_pred:0.029805516824126244, decouple_loss:0.013558823615312576
Iteration: 1398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497734606266022, gen p mean: -0.673291802406311, mean p set: 0.4502537250518799
The modified gen p mean: 0.4498051106929779, gen p mean: -0.6800877451896667, mean p set: 0.450285404920578
loss_pred:0.030031470581889153, decouple_loss:0.013452213257551193
loss_pred:0.030256545171141624, decouple_loss:0.01428491435945034The modified gen p mean: 0.4502740204334259, gen p mean: -0.6621723175048828, mean p set: 0.450754314661026
loss_pred:0.031027179211378098, decouple_loss:0.01452094130218029
Iteration: 1399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480375647544861, gen p mean: -0.6768437623977661, mean p set: 0.4485178589820862
The modified gen p mean: 0.4489370584487915, gen p mean: -0.6766866445541382, mean p set: 0.4494173526763916
loss_pred:0.029667088761925697, decouple_loss:0.013556784018874168
loss_pred:0.030710339546203613, decouple_loss:0.01384194940328598
The modified gen p mean: 0.4492329955101013, gen p mean: -0.6839220523834229, mean p set: 0.4497132897377014
loss_pred:0.030306125059723854, decouple_loss:0.01415797509253025
Iteration: 1400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926226139068604, gen p mean: -0.674285352230072, mean p set: 0.4497425854206085
The modified gen p mean: 0.45003122091293335, gen p mean: -0.6712252497673035, mean p set: 0.45051151514053345
loss_pred:0.029991403222084045, decouple_loss:0.013528750278055668
loss_pred:0.029867935925722122, decouple_loss:0.014125781133770943
The modified gen p mean: 0.4490235149860382, gen p mean: -0.6855832934379578, mean p set: 0.4495038390159607
loss_pred:0.03023214265704155, decouple_loss:0.013358653523027897
2023-05-01 21:14:18 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.682424783706665, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6723907589912415, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6759589314460754, mean p set: 0.4500633478164673
loss_pred:0.030220115557312965, decouple_loss:0.015460674650967121
loss_pred:0.02875104919075966, decouple_loss:0.015489250421524048
loss_pred:0.029135847464203835, decouple_loss:0.015087775886058807
WV_0_PC_1_EH_0_PS_40_5, loss: 0.03013629838824272, avg_mse: 0.03484424948692322
current test mse: 0.034844
Iteration: 1401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940537214279175, gen p mean: -0.6660061478614807, mean p set: 0.44988563656806946
The modified gen p mean: 0.4498112201690674, gen p mean: -0.6695972681045532, mean p set: 0.4502915143966675
loss_pred:0.029933054000139236, decouple_loss:0.01409271638840437
The modified gen p mean: 0.44938376545906067, gen p mean: -0.6712819933891296, mean p set: 0.44986405968666077
loss_pred:0.029938584193587303, decouple_loss:0.014057747088372707
loss_pred:0.03000626713037491, decouple_loss:0.014077411033213139
Iteration: 1402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486215114593506, gen p mean: -0.6820604801177979, mean p set: 0.4491018056869507
The modified gen p mean: 0.4487699568271637, gen p mean: -0.6914926767349243, mean p set: 0.4492502808570862
loss_pred:0.030764713883399963, decouple_loss:0.01380025316029787
loss_pred:0.0307635348290205, decouple_loss:0.013720065355300903
The modified gen p mean: 0.4495851397514343, gen p mean: -0.6906841993331909, mean p set: 0.4500654339790344
loss_pred:0.02986202947795391, decouple_loss:0.014392880722880363
Iteration: 1403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977566599845886, gen p mean: -0.6669287085533142, mean p set: 0.45025599002838135
The modified gen p mean: 0.4490238428115845, gen p mean: -0.6789571642875671, mean p set: 0.44950413703918457
loss_pred:0.029820136725902557, decouple_loss:0.013823289424180984
loss_pred:0.03143182769417763, decouple_loss:0.013747040182352066
The modified gen p mean: 0.44978153705596924, gen p mean: -0.6755203604698181, mean p set: 0.45026183128356934
loss_pred:0.030447378754615784, decouple_loss:0.012795919552445412
Iteration: 1404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44964757561683655, gen p mean: -0.6826211214065552, mean p set: 0.45012786984443665
loss_pred:0.029635794460773468, decouple_loss:0.01304042898118496The modified gen p mean: 0.44864264130592346, gen p mean: -0.6752927899360657, mean p set: 0.44912293553352356
The modified gen p mean: 0.4492156505584717, gen p mean: -0.6700011491775513, mean p set: 0.4496959447860718
loss_pred:0.031750913709402084, decouple_loss:0.014056584797799587
loss_pred:0.030984772369265556, decouple_loss:0.013551639392971992
Iteration: 1405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968050718307495, gen p mean: -0.683758556842804, mean p set: 0.45016080141067505
loss_pred:0.029890963807702065, decouple_loss:0.013218564912676811
The modified gen p mean: 0.44959181547164917, gen p mean: -0.6694081425666809, mean p set: 0.45007210969924927The modified gen p mean: 0.44942376017570496, gen p mean: -0.6829145550727844, mean p set: 0.44990405440330505
loss_pred:0.029387330636382103, decouple_loss:0.01350216381251812
loss_pred:0.029924903064966202, decouple_loss:0.01312151551246643
Iteration: 1406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992658495903015, gen p mean: -0.6699728965759277, mean p set: 0.45040687918663025
loss_pred:0.03044644370675087, decouple_loss:0.013339034281671047
The modified gen p mean: 0.4506334364414215, gen p mean: -0.6763322353363037, mean p set: 0.4511137008666992The modified gen p mean: 0.45172709226608276, gen p mean: -0.6697904467582703, mean p set: 0.45220738649368286
loss_pred:0.029946019873023033, decouple_loss:0.013241022825241089
loss_pred:0.03046041913330555, decouple_loss:0.013353260233998299
Iteration: 1407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956380128860474, gen p mean: -0.677769660949707, mean p set: 0.4500441253185272
loss_pred:0.030482500791549683, decouple_loss:0.013131823390722275
The modified gen p mean: 0.4502299427986145, gen p mean: -0.671337902545929, mean p set: 0.4507102370262146The modified gen p mean: 0.4503208100795746, gen p mean: -0.6743800640106201, mean p set: 0.4508011043071747
loss_pred:0.030168186873197556, decouple_loss:0.012782711535692215
loss_pred:0.030634652823209763, decouple_loss:0.012891205959022045
Iteration: 1408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142218470573425, gen p mean: -0.6707961559295654, mean p set: 0.45190247893333435
loss_pred:0.03090290166437626, decouple_loss:0.013728342019021511
The modified gen p mean: 0.4496156871318817, gen p mean: -0.6601533889770508, mean p set: 0.4500959813594818The modified gen p mean: 0.44938400387763977, gen p mean: -0.672610878944397, mean p set: 0.44986429810523987
loss_pred:0.029750211164355278, decouple_loss:0.013606395572423935
loss_pred:0.030367905274033546, decouple_loss:0.013587878085672855
Iteration: 1409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44998836517333984, gen p mean: -0.6756948828697205, mean p set: 0.45046865940093994
loss_pred:0.029739584773778915, decouple_loss:0.013698972761631012
The modified gen p mean: 0.449506014585495, gen p mean: -0.6737717986106873, mean p set: 0.4499862790107727The modified gen p mean: 0.44960206747055054, gen p mean: -0.6628126502037048, mean p set: 0.45008236169815063
loss_pred:0.029959505423903465, decouple_loss:0.013056054711341858
loss_pred:0.030715694651007652, decouple_loss:0.013765896670520306
Iteration: 1410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810667634010315, gen p mean: -0.6810552477836609, mean p set: 0.44858694076538086
The modified gen p mean: 0.45045432448387146, gen p mean: -0.6878038644790649, mean p set: 0.45093461871147156
loss_pred:0.03141903504729271, decouple_loss:0.013593505136668682
loss_pred:0.030819982290267944, decouple_loss:0.014113710261881351
The modified gen p mean: 0.44862550497055054, gen p mean: -0.6819007396697998, mean p set: 0.44910579919815063
loss_pred:0.030834103003144264, decouple_loss:0.012980745173990726
2023-05-01 21:16:26 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6889818906784058, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.679273784160614, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6825188994407654, mean p set: 0.4500633478164673
loss_pred:0.030226722359657288, decouple_loss:0.015826351940631866
loss_pred:0.028803585097193718, decouple_loss:0.015545741654932499
loss_pred:0.029291467741131783, decouple_loss:0.015402276068925858
WV_0_PC_1_EH_0_PS_40_5, loss: 0.030220163986086845, avg_mse: 0.03498929738998413
current test mse: 0.034989
Iteration: 1411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489772617816925, gen p mean: -0.6770186424255371, mean p set: 0.449457585811615
The modified gen p mean: 0.4493388235569, gen p mean: -0.6800650954246521, mean p set: 0.44981908798217773
loss_pred:0.02977243810892105, decouple_loss:0.012829451821744442
The modified gen p mean: 0.45044076442718506, gen p mean: -0.691191554069519, mean p set: 0.45092108845710754
loss_pred:0.030490374192595482, decouple_loss:0.013621468096971512
loss_pred:0.031213494017720222, decouple_loss:0.014406335540115833
Iteration: 1412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45207497477531433, gen p mean: -0.6760373115539551, mean p set: 0.45255526900291443
The modified gen p mean: 0.4501861035823822, gen p mean: -0.6688111424446106, mean p set: 0.4506663978099823
loss_pred:0.030736152082681656, decouple_loss:0.013403703458607197
loss_pred:0.029931390658020973, decouple_loss:0.013310184702277184
The modified gen p mean: 0.44985243678092957, gen p mean: -0.6930304765701294, mean p set: 0.45033276081085205
loss_pred:0.02990751713514328, decouple_loss:0.01412280648946762
Iteration: 1413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487402141094208, gen p mean: -0.6826907992362976, mean p set: 0.4492204785346985
The modified gen p mean: 0.450111985206604, gen p mean: -0.6741051077842712, mean p set: 0.4505922794342041
loss_pred:0.030296066775918007, decouple_loss:0.01356893964111805
loss_pred:0.02944542095065117, decouple_loss:0.013175904750823975
The modified gen p mean: 0.44919729232788086, gen p mean: -0.6753860712051392, mean p set: 0.44967761635780334
loss_pred:0.03016686998307705, decouple_loss:0.013569362461566925
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 1414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510241150856018, gen p mean: -0.6855083703994751, mean p set: 0.4515043795108795
loss_pred:0.029346277937293053, decouple_loss:0.015222303569316864
The modified gen p mean: 0.45249706506729126, gen p mean: -0.6769336462020874, mean p set: 0.45297735929489136The modified gen p mean: 0.4522453546524048, gen p mean: -0.6866123676300049, mean p set: 0.4527256488800049
loss_pred:0.027373075485229492, decouple_loss:0.015659555792808533
loss_pred:0.02825864404439926, decouple_loss:0.013821601867675781
Iteration: 1415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539802670478821, gen p mean: -0.6768648624420166, mean p set: 0.45446059107780457
The modified gen p mean: 0.4509720802307129, gen p mean: -0.6800473928451538, mean p set: 0.451452374458313
loss_pred:0.0270979106426239, decouple_loss:0.016122227534651756
loss_pred:0.029249971732497215, decouple_loss:0.01362993847578764
The modified gen p mean: 0.450749009847641, gen p mean: -0.6695865988731384, mean p set: 0.4512292742729187
loss_pred:0.030867496505379677, decouple_loss:0.014683239161968231
Iteration: 1416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510827362537384, gen p mean: -0.680408239364624, mean p set: 0.4515630006790161
The modified gen p mean: 0.4513583779335022, gen p mean: -0.678754448890686, mean p set: 0.4518386423587799
loss_pred:0.029885761439800262, decouple_loss:0.014448623172938824
loss_pred:0.02936428226530552, decouple_loss:0.01472117006778717
The modified gen p mean: 0.4508156180381775, gen p mean: -0.6692162752151489, mean p set: 0.4512959122657776
loss_pred:0.027589237317442894, decouple_loss:0.016119545325636864
Iteration: 1417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048317313194275, gen p mean: -0.686333417892456, mean p set: 0.45096346735954285
The modified gen p mean: 0.45221826434135437, gen p mean: -0.6815874576568604, mean p set: 0.45269855856895447
loss_pred:0.029253613203763962, decouple_loss:0.014027218334376812
loss_pred:0.027226245030760765, decouple_loss:0.014381489716470242
The modified gen p mean: 0.4529424011707306, gen p mean: -0.68654865026474, mean p set: 0.4534226953983307
loss_pred:0.027416711673140526, decouple_loss:0.01417278777807951
Iteration: 1418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528367221355438, gen p mean: -0.6863197088241577, mean p set: 0.4533170461654663
The modified gen p mean: 0.45246726274490356, gen p mean: -0.6869168281555176, mean p set: 0.45294755697250366
loss_pred:0.027632849290966988, decouple_loss:0.014444098807871342
loss_pred:0.0275888592004776, decouple_loss:0.013927335850894451
The modified gen p mean: 0.4521137475967407, gen p mean: -0.681240975856781, mean p set: 0.4525940418243408
loss_pred:0.027750030159950256, decouple_loss:0.013856449164450169
Iteration: 1419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45233041048049927, gen p mean: -0.6779664158821106, mean p set: 0.45281070470809937
The modified gen p mean: 0.45227065682411194, gen p mean: -0.6671998500823975, mean p set: 0.45275095105171204
loss_pred:0.028461763635277748, decouple_loss:0.013703336007893085
loss_pred:0.02679906226694584, decouple_loss:0.014716231264173985
The modified gen p mean: 0.45276227593421936, gen p mean: -0.6738303899765015, mean p set: 0.45324259996414185
loss_pred:0.026390070095658302, decouple_loss:0.014528078027069569
Iteration: 1420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169728994369507, gen p mean: -0.670250654220581, mean p set: 0.4521775543689728
The modified gen p mean: 0.45097970962524414, gen p mean: -0.6588415503501892, mean p set: 0.45146000385284424
loss_pred:0.02960926666855812, decouple_loss:0.014467036351561546
loss_pred:0.02755405567586422, decouple_loss:0.015222800895571709
The modified gen p mean: 0.4511546194553375, gen p mean: -0.6773642301559448, mean p set: 0.4516349136829376
loss_pred:0.029245370998978615, decouple_loss:0.014880712144076824
2023-05-01 21:19:12 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6901584267616272, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6794455051422119, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6830061674118042, mean p set: 0.4500633478164673
loss_pred:0.030193941667675972, decouple_loss:0.015760289505124092
loss_pred:0.028625039383769035, decouple_loss:0.015840664505958557
loss_pred:0.029148640111088753, decouple_loss:0.015322861261665821
WV_0_PC_1_EH_0_PS_40_5, loss: 0.030104605481028557, avg_mse: 0.0348496213555336
current test mse: 0.03485
Iteration: 1421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272040367126465, gen p mean: -0.6879223585128784, mean p set: 0.45320072770118713
The modified gen p mean: 0.4536548852920532, gen p mean: -0.6822378039360046, mean p set: 0.4541351795196533
loss_pred:0.027440635487437248, decouple_loss:0.0139901889488101
The modified gen p mean: 0.4515138268470764, gen p mean: -0.6807172298431396, mean p set: 0.4519941210746765
loss_pred:0.02715885266661644, decouple_loss:0.014072127640247345
loss_pred:0.028360387310385704, decouple_loss:0.013899024575948715
Iteration: 1422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45270636677742004, gen p mean: -0.6954975128173828, mean p set: 0.45318663120269775
The modified gen p mean: 0.45082202553749084, gen p mean: -0.6807606816291809, mean p set: 0.45130228996276855
loss_pred:0.02732088975608349, decouple_loss:0.014713297598063946
loss_pred:0.02758387103676796, decouple_loss:0.014553765766322613
The modified gen p mean: 0.45134875178337097, gen p mean: -0.6846262812614441, mean p set: 0.45182904601097107
loss_pred:0.030365794897079468, decouple_loss:0.01462643127888441
Iteration: 1423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498565196990967, gen p mean: -0.6934651136398315, mean p set: 0.4503368139266968
The modified gen p mean: 0.45220547914505005, gen p mean: -0.6907939314842224, mean p set: 0.45268580317497253
loss_pred:0.029029790312051773, decouple_loss:0.013927481137216091
loss_pred:0.029463844373822212, decouple_loss:0.013866261579096317
The modified gen p mean: 0.4508441388607025, gen p mean: -0.6933926939964294, mean p set: 0.4513244330883026
loss_pred:0.02930181473493576, decouple_loss:0.014400499872863293
Iteration: 1424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521506130695343, gen p mean: -0.6875891089439392, mean p set: 0.4526309072971344
The modified gen p mean: 0.4543343782424927, gen p mean: -0.6861768364906311, mean p set: 0.4548146724700928
loss_pred:0.02857915312051773, decouple_loss:0.013699597679078579
loss_pred:0.027662238106131554, decouple_loss:0.014328185468912125
The modified gen p mean: 0.4530586898326874, gen p mean: -0.6927439570426941, mean p set: 0.4535389542579651
loss_pred:0.02806220017373562, decouple_loss:0.013878450728952885
Iteration: 1425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528239965438843, gen p mean: -0.6792250871658325, mean p set: 0.4533042907714844
The modified gen p mean: 0.45131009817123413, gen p mean: -0.6794775724411011, mean p set: 0.4517904222011566
loss_pred:0.027320947498083115, decouple_loss:0.01407166663557291
loss_pred:0.03067122958600521, decouple_loss:0.014450772665441036
The modified gen p mean: 0.4508700370788574, gen p mean: -0.6825636625289917, mean p set: 0.4513503611087799
loss_pred:0.029642200097441673, decouple_loss:0.014168469235301018
Iteration: 1426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505383372306824, gen p mean: -0.6909872889518738, mean p set: 0.4510186016559601
The modified gen p mean: 0.4520118534564972, gen p mean: -0.6961701512336731, mean p set: 0.4524921178817749
loss_pred:0.028688929975032806, decouple_loss:0.014274675399065018
loss_pred:0.02760224975645542, decouple_loss:0.014654958620667458
The modified gen p mean: 0.4524080753326416, gen p mean: -0.6942103505134583, mean p set: 0.4528883397579193
loss_pred:0.028028303757309914, decouple_loss:0.013976252637803555
Iteration: 1427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45056912302970886, gen p mean: -0.6821016669273376, mean p set: 0.4510493874549866
The modified gen p mean: 0.4527190923690796, gen p mean: -0.6982738971710205, mean p set: 0.4531993865966797
loss_pred:0.03069322183728218, decouple_loss:0.013850625604391098
loss_pred:0.02724311128258705, decouple_loss:0.013809209689497948
The modified gen p mean: 0.4506838619709015, gen p mean: -0.6803845763206482, mean p set: 0.4511641561985016
loss_pred:0.027452562004327774, decouple_loss:0.014406082220375538
Iteration: 1428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513258635997772, gen p mean: -0.6934977173805237, mean p set: 0.45180612802505493
The modified gen p mean: 0.45169582962989807, gen p mean: -0.6922293901443481, mean p set: 0.4521760940551758
loss_pred:0.029388176277279854, decouple_loss:0.013543368317186832
loss_pred:0.028504017740488052, decouple_loss:0.013807892799377441
The modified gen p mean: 0.4522281885147095, gen p mean: -0.6947264671325684, mean p set: 0.45270848274230957
loss_pred:0.0288211889564991, decouple_loss:0.013630511239171028
Iteration: 1429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513746201992035, gen p mean: -0.6937905550003052, mean p set: 0.4518548846244812
The modified gen p mean: 0.4521689713001251, gen p mean: -0.6947665810585022, mean p set: 0.45264923572540283
loss_pred:0.029097072780132294, decouple_loss:0.013881503604352474
loss_pred:0.027743995189666748, decouple_loss:0.013366788625717163
The modified gen p mean: 0.4522641897201538, gen p mean: -0.6929726004600525, mean p set: 0.4527444541454315
loss_pred:0.02826174721121788, decouple_loss:0.013325034640729427
Iteration: 1430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180991291999817, gen p mean: -0.6906498074531555, mean p set: 0.45229020714759827
The modified gen p mean: 0.45347917079925537, gen p mean: -0.6964237093925476, mean p set: 0.45395946502685547
loss_pred:0.02912106178700924, decouple_loss:0.013860385864973068
loss_pred:0.02753450721502304, decouple_loss:0.01375378668308258
The modified gen p mean: 0.4527140259742737, gen p mean: -0.6952757239341736, mean p set: 0.4531942903995514
loss_pred:0.028020625934004784, decouple_loss:0.013673428446054459
2023-05-01 21:21:21 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.6950922608375549, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6885111331939697, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6848474740982056, mean p set: 0.45035696029663086
loss_pred:0.03052709996700287, decouple_loss:0.01563267409801483
loss_pred:0.0293365940451622, decouple_loss:0.015295646153390408
loss_pred:0.028911275789141655, decouple_loss:0.015924077481031418
WV_0_PC_1_EH_0_PS_40_5, loss: 0.030372530221939087, avg_mse: 0.03525969758629799
current test mse: 0.03526
Iteration: 1431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514199197292328, gen p mean: -0.6808979511260986, mean p set: 0.4519002437591553
loss_pred:0.026841212064027786, decouple_loss:0.014447319321334362
The modified gen p mean: 0.4539129436016083, gen p mean: -0.685599148273468, mean p set: 0.45439326763153076The modified gen p mean: 0.45096468925476074, gen p mean: -0.6892510652542114, mean p set: 0.4514450132846832
loss_pred:0.027652980759739876, decouple_loss:0.01394990086555481
loss_pred:0.028984755277633667, decouple_loss:0.013900385238230228
Iteration: 1432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104166865348816, gen p mean: -0.6898654699325562, mean p set: 0.45152196288108826
The modified gen p mean: 0.4511820375919342, gen p mean: -0.6837762594223022, mean p set: 0.4516623318195343
loss_pred:0.028665846213698387, decouple_loss:0.014220740646123886
loss_pred:0.029312187805771828, decouple_loss:0.013762475922703743
The modified gen p mean: 0.45271334052085876, gen p mean: -0.6784988641738892, mean p set: 0.45319366455078125
loss_pred:0.02615400217473507, decouple_loss:0.013390634208917618
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 1433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822150468826294, gen p mean: -0.6911366581916809, mean p set: 0.44870179891586304
loss_pred:0.02949957363307476, decouple_loss:0.015786759555339813
The modified gen p mean: 0.4477596580982208, gen p mean: -0.6967601180076599, mean p set: 0.4482399523258209The modified gen p mean: 0.4483104348182678, gen p mean: -0.6927300691604614, mean p set: 0.44879069924354553
loss_pred:0.02914515696465969, decouple_loss:0.014628228731453419
loss_pred:0.030438296496868134, decouple_loss:0.01530540082603693
Iteration: 1434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722214341163635, gen p mean: -0.7005489468574524, mean p set: 0.44770246744155884
The modified gen p mean: 0.4477446675300598, gen p mean: -0.7009076476097107, mean p set: 0.4482249617576599
loss_pred:0.029330769553780556, decouple_loss:0.015559612773358822
The modified gen p mean: 0.44758841395378113, gen p mean: -0.7016810178756714, mean p set: 0.44806867837905884loss_pred:0.02898782305419445, decouple_loss:0.015522380359470844
loss_pred:0.02945305034518242, decouple_loss:0.015511833131313324
Iteration: 1435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694724678993225, gen p mean: -0.6990644335746765, mean p set: 0.44742754101753235
The modified gen p mean: 0.447806179523468, gen p mean: -0.6890363097190857, mean p set: 0.4482864737510681
loss_pred:0.028924008831381798, decouple_loss:0.015580112114548683
loss_pred:0.02926246076822281, decouple_loss:0.014453697949647903The modified gen p mean: 0.446699857711792, gen p mean: -0.6910386085510254, mean p set: 0.4471800923347473
loss_pred:0.03062581457197666, decouple_loss:0.014374765567481518
Iteration: 1436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477365016937256, gen p mean: -0.689013659954071, mean p set: 0.44821682572364807
The modified gen p mean: 0.44771137833595276, gen p mean: -0.6854186058044434, mean p set: 0.44819164276123047
loss_pred:0.03031458705663681, decouple_loss:0.014082515612244606
loss_pred:0.02886478416621685, decouple_loss:0.014266548678278923
The modified gen p mean: 0.4472672641277313, gen p mean: -0.6870152950286865, mean p set: 0.4477475583553314
loss_pred:0.029064690694212914, decouple_loss:0.014680828899145126
Iteration: 1437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766926765441895, gen p mean: -0.6892503499984741, mean p set: 0.44814959168434143
The modified gen p mean: 0.44775915145874023, gen p mean: -0.6919906139373779, mean p set: 0.44823944568634033
loss_pred:0.028802406042814255, decouple_loss:0.013918462209403515
loss_pred:0.029778745025396347, decouple_loss:0.01386885717511177
The modified gen p mean: 0.447527676820755, gen p mean: -0.690000057220459, mean p set: 0.4480080008506775
loss_pred:0.029122434556484222, decouple_loss:0.013948924839496613
Iteration: 1438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723832607269287, gen p mean: -0.6933028697967529, mean p set: 0.44771865010261536
The modified gen p mean: 0.44744864106178284, gen p mean: -0.6969505548477173, mean p set: 0.4479289650917053
loss_pred:0.028461089357733727, decouple_loss:0.01416347548365593
loss_pred:0.02999107725918293, decouple_loss:0.01425039954483509
The modified gen p mean: 0.44683799147605896, gen p mean: -0.6910683512687683, mean p set: 0.44731831550598145
loss_pred:0.02981775440275669, decouple_loss:0.014599458314478397
Iteration: 1439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481663703918457, gen p mean: -0.6950138211250305, mean p set: 0.4486466944217682
loss_pred:0.029238581657409668, decouple_loss:0.014266381040215492
The modified gen p mean: 0.44754457473754883, gen p mean: -0.6933349967002869, mean p set: 0.4480248689651489The modified gen p mean: 0.44617268443107605, gen p mean: -0.695576012134552, mean p set: 0.44665300846099854
loss_pred:0.028693757951259613, decouple_loss:0.013802440837025642
loss_pred:0.029422365128993988, decouple_loss:0.014011108316481113
Iteration: 1440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44612351059913635, gen p mean: -0.6987704634666443, mean p set: 0.44660380482673645
The modified gen p mean: 0.4478708803653717, gen p mean: -0.6942765712738037, mean p set: 0.4483511745929718
loss_pred:0.029927847906947136, decouple_loss:0.013538352213799953
loss_pred:0.029179058969020844, decouple_loss:0.013692536391317844
The modified gen p mean: 0.4488472044467926, gen p mean: -0.6939646005630493, mean p set: 0.4493274986743927
loss_pred:0.029402201995253563, decouple_loss:0.013648523017764091
2023-05-01 21:24:06 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.704866349697113, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6947019100189209, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.697388231754303, mean p set: 0.4500633478164673
loss_pred:0.0297897569835186, decouple_loss:0.013838615268468857
loss_pred:0.028312204405665398, decouple_loss:0.013807464390993118
loss_pred:0.028720837086439133, decouple_loss:0.013367719016969204
WV_0_PC_1_EH_0_PS_40_5, loss: 0.029624497517943382, avg_mse: 0.034253306686878204
current test mse: 0.034253
Iteration: 1441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780269265174866, gen p mean: -0.702295184135437, mean p set: 0.44828295707702637
The modified gen p mean: 0.4477505385875702, gen p mean: -0.6952032446861267, mean p set: 0.4482308626174927
loss_pred:0.029558954760432243, decouple_loss:0.01318871509283781
The modified gen p mean: 0.4476584792137146, gen p mean: -0.7016242742538452, mean p set: 0.4481387734413147
loss_pred:0.029782526195049286, decouple_loss:0.014201633632183075
loss_pred:0.029214544221758842, decouple_loss:0.01452506985515356
Iteration: 1442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873046875, gen p mean: -0.6883324980735779, mean p set: 0.4492107927799225
The modified gen p mean: 0.4483383595943451, gen p mean: -0.6835168600082397, mean p set: 0.4488186836242676
loss_pred:0.029951222240924835, decouple_loss:0.013933605514466763
loss_pred:0.029558667913079262, decouple_loss:0.013425908982753754
The modified gen p mean: 0.44838187098503113, gen p mean: -0.686103880405426, mean p set: 0.4488621652126312
loss_pred:0.02988569624722004, decouple_loss:0.013503143563866615
Iteration: 1443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472610652446747, gen p mean: -0.6885231137275696, mean p set: 0.4477413594722748
The modified gen p mean: 0.44744864106178284, gen p mean: -0.691582441329956, mean p set: 0.44792893528938293loss_pred:0.029342731460928917, decouple_loss:0.013520926237106323
The modified gen p mean: 0.4475400745868683, gen p mean: -0.6879982948303223, mean p set: 0.44802039861679077
loss_pred:0.029610861092805862, decouple_loss:0.014199676923453808
loss_pred:0.028276192024350166, decouple_loss:0.013596296310424805
Iteration: 1444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472653865814209, gen p mean: -0.6881483197212219, mean p set: 0.4477456510066986
The modified gen p mean: 0.4490087032318115, gen p mean: -0.6882516145706177, mean p set: 0.4494889974594116
loss_pred:0.0295712910592556, decouple_loss:0.013704306446015835
loss_pred:0.028840096667408943, decouple_loss:0.01380449440330267
The modified gen p mean: 0.4474266767501831, gen p mean: -0.6885573267936707, mean p set: 0.4479069411754608
loss_pred:0.029579389840364456, decouple_loss:0.013023467734456062
Iteration: 1445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829726219177246, gen p mean: -0.6843648552894592, mean p set: 0.44877755641937256
The modified gen p mean: 0.4477286636829376, gen p mean: -0.6803475618362427, mean p set: 0.4482089579105377
loss_pred:0.029876332730054855, decouple_loss:0.01327752135694027
loss_pred:0.02940969541668892, decouple_loss:0.013686046004295349
The modified gen p mean: 0.44712865352630615, gen p mean: -0.6796040534973145, mean p set: 0.44760891795158386
loss_pred:0.029763540253043175, decouple_loss:0.013445490971207619
Iteration: 1446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473603069782257, gen p mean: -0.6824641823768616, mean p set: 0.4478406012058258
The modified gen p mean: 0.44737327098846436, gen p mean: -0.6861494779586792, mean p set: 0.44785353541374207
loss_pred:0.029598567634820938, decouple_loss:0.013547246344387531
loss_pred:0.028909657150506973, decouple_loss:0.013636036776006222
The modified gen p mean: 0.4489087164402008, gen p mean: -0.6849805116653442, mean p set: 0.4493890404701233
loss_pred:0.029073158279061317, decouple_loss:0.01309902686625719
Iteration: 1447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783878326416016, gen p mean: -0.6868212819099426, mean p set: 0.44831904768943787The modified gen p mean: 0.4475630223751068, gen p mean: -0.6868150234222412, mean p set: 0.4480433166027069
loss_pred:0.029685523360967636, decouple_loss:0.013877580873668194
loss_pred:0.028694894164800644, decouple_loss:0.013209903612732887
The modified gen p mean: 0.4470638036727905, gen p mean: -0.688281238079071, mean p set: 0.44754406809806824
loss_pred:0.02966083399951458, decouple_loss:0.013174393214285374
Iteration: 1448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473407566547394, gen p mean: -0.6753713488578796, mean p set: 0.4478210508823395
The modified gen p mean: 0.4473842680454254, gen p mean: -0.6832531094551086, mean p set: 0.4478645324707031
loss_pred:0.029237432405352592, decouple_loss:0.013300089165568352
loss_pred:0.028534648939967155, decouple_loss:0.014239901676774025
The modified gen p mean: 0.4476114511489868, gen p mean: -0.6776594519615173, mean p set: 0.4480917155742645
loss_pred:0.029505018144845963, decouple_loss:0.013601110316812992
Iteration: 1449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479805529117584, gen p mean: -0.6744070053100586, mean p set: 0.44846081733703613
The modified gen p mean: 0.4478815495967865, gen p mean: -0.6722328066825867, mean p set: 0.4483618438243866
loss_pred:0.02900368720293045, decouple_loss:0.013166436925530434
loss_pred:0.02888866327702999, decouple_loss:0.013733056373894215
The modified gen p mean: 0.4471362233161926, gen p mean: -0.6752053499221802, mean p set: 0.44761648774147034
loss_pred:0.028768856078386307, decouple_loss:0.013201011344790459
Iteration: 1450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468141496181488, gen p mean: -0.6787286400794983, mean p set: 0.4472944438457489
The modified gen p mean: 0.4471328556537628, gen p mean: -0.6777427196502686, mean p set: 0.4476131498813629
loss_pred:0.02925926074385643, decouple_loss:0.012792116031050682
loss_pred:0.0284781102091074, decouple_loss:0.012903285212814808
The modified gen p mean: 0.44696977734565735, gen p mean: -0.6788486242294312, mean p set: 0.44745007157325745
loss_pred:0.02853383682668209, decouple_loss:0.012830748222768307
2023-05-01 21:26:14 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.693023145198822, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6831748485565186, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6864018440246582, mean p set: 0.4500633478164673
loss_pred:0.03000250831246376, decouple_loss:0.013406893238425255
loss_pred:0.02844993770122528, decouple_loss:0.01375728938728571
loss_pred:0.028896145522594452, decouple_loss:0.013384224846959114
WV_0_PC_1_EH_0_PS_40_5, loss: 0.029792003333568573, avg_mse: 0.03450664505362511
current test mse: 0.034507
Iteration: 1451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44658082723617554, gen p mean: -0.6861391663551331, mean p set: 0.44706112146377563
The modified gen p mean: 0.44734418392181396, gen p mean: -0.6829659342765808, mean p set: 0.4478244483470917
loss_pred:0.029288815334439278, decouple_loss:0.01286762859672308
The modified gen p mean: 0.4480758309364319, gen p mean: -0.6811925768852234, mean p set: 0.44855615496635437
loss_pred:0.029369672760367393, decouple_loss:0.01349764596670866
loss_pred:0.028945690020918846, decouple_loss:0.013669895939528942
Iteration: 1452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482875466346741, gen p mean: -0.6802961826324463, mean p set: 0.4487678110599518
The modified gen p mean: 0.4482654631137848, gen p mean: -0.6848863363265991, mean p set: 0.4487457573413849
loss_pred:0.028305185958743095, decouple_loss:0.012953835539519787
loss_pred:0.029762616381049156, decouple_loss:0.013091277331113815
The modified gen p mean: 0.44856175780296326, gen p mean: -0.6761429309844971, mean p set: 0.44904205203056335
loss_pred:0.028453337028622627, decouple_loss:0.013044191524386406
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 1453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468335509300232, gen p mean: -0.6778713464736938, mean p set: 0.4473138451576233
loss_pred:0.02918972261250019, decouple_loss:0.01571706123650074
The modified gen p mean: 0.446433961391449, gen p mean: -0.6748107671737671, mean p set: 0.44691428542137146The modified gen p mean: 0.4473322331905365, gen p mean: -0.67863529920578, mean p set: 0.4478125274181366
loss_pred:0.029342755675315857, decouple_loss:0.015972159802913666
loss_pred:0.02828044444322586, decouple_loss:0.013775579631328583
Iteration: 1454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44594743847846985, gen p mean: -0.6666721105575562, mean p set: 0.44642776250839233
The modified gen p mean: 0.44764435291290283, gen p mean: -0.6731123328208923, mean p set: 0.44812464714050293
loss_pred:0.029138997197151184, decouple_loss:0.014789003878831863
loss_pred:0.028853654861450195, decouple_loss:0.013898785226047039
The modified gen p mean: 0.4472549557685852, gen p mean: -0.6697949767112732, mean p set: 0.4477352201938629
loss_pred:0.029838966205716133, decouple_loss:0.014502723701298237
Iteration: 1455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677478075027466, gen p mean: -0.6639822721481323, mean p set: 0.44725507497787476
The modified gen p mean: 0.44816112518310547, gen p mean: -0.6655228734016418, mean p set: 0.4486413896083832
loss_pred:0.02869238331913948, decouple_loss:0.014298752881586552
loss_pred:0.028167109936475754, decouple_loss:0.013414224609732628
The modified gen p mean: 0.4479389190673828, gen p mean: -0.6688656210899353, mean p set: 0.4484192430973053
loss_pred:0.03022274747490883, decouple_loss:0.01375554595142603
Iteration: 1456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474668800830841, gen p mean: -0.6741658449172974, mean p set: 0.4479471743106842
The modified gen p mean: 0.44736284017562866, gen p mean: -0.6732525825500488, mean p set: 0.44784313440322876
loss_pred:0.029086893424391747, decouple_loss:0.013734160922467709
loss_pred:0.02986888214945793, decouple_loss:0.013563709333539009
The modified gen p mean: 0.44761788845062256, gen p mean: -0.6702224612236023, mean p set: 0.44809815287590027
loss_pred:0.02822754718363285, decouple_loss:0.01390195544809103
Iteration: 1457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836685061454773, gen p mean: -0.6761048436164856, mean p set: 0.44884711503982544
loss_pred:0.02865438722074032, decouple_loss:0.013429581187665462
The modified gen p mean: 0.4461376667022705, gen p mean: -0.6698921918869019, mean p set: 0.4466179311275482The modified gen p mean: 0.4480712115764618, gen p mean: -0.6788516640663147, mean p set: 0.4485515058040619
loss_pred:0.02918444573879242, decouple_loss:0.014089925214648247
loss_pred:0.030281350016593933, decouple_loss:0.014007109217345715
Iteration: 1458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671371579170227, gen p mean: -0.6749526262283325, mean p set: 0.44719401001930237
The modified gen p mean: 0.44809257984161377, gen p mean: -0.6736054420471191, mean p set: 0.4485728442668915
loss_pred:0.029521113261580467, decouple_loss:0.01328024547547102
loss_pred:0.028201095759868622, decouple_loss:0.013467494398355484
The modified gen p mean: 0.44772449135780334, gen p mean: -0.6753438711166382, mean p set: 0.44820475578308105
loss_pred:0.029586942866444588, decouple_loss:0.01349937729537487
Iteration: 1459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768717885017395, gen p mean: -0.6789467930793762, mean p set: 0.44816744327545166
The modified gen p mean: 0.44711536169052124, gen p mean: -0.6806507706642151, mean p set: 0.44759562611579895
loss_pred:0.02933240495622158, decouple_loss:0.012662654742598534
loss_pred:0.02821647934615612, decouple_loss:0.013820065185427666The modified gen p mean: 0.4479878842830658, gen p mean: -0.6720157861709595, mean p set: 0.4484681785106659
loss_pred:0.029019474983215332, decouple_loss:0.013353276997804642
Iteration: 1460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760993123054504, gen p mean: -0.678489089012146, mean p set: 0.44809025526046753The modified gen p mean: 0.4475243091583252, gen p mean: -0.6782441139221191, mean p set: 0.4480046033859253
loss_pred:0.028632763773202896, decouple_loss:0.012709375470876694
loss_pred:0.027942275628447533, decouple_loss:0.012698667123913765
The modified gen p mean: 0.4483828842639923, gen p mean: -0.6779365539550781, mean p set: 0.4488631784915924
loss_pred:0.02942594885826111, decouple_loss:0.012806577607989311
2023-05-01 21:28:58 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6805641055107117, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.671160101890564, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6742217540740967, mean p set: 0.4500633478164673
loss_pred:0.029615575447678566, decouple_loss:0.013601238839328289
loss_pred:0.028243519365787506, decouple_loss:0.01323646865785122
loss_pred:0.028622662648558617, decouple_loss:0.013295873068273067
WV_0_PC_1_EH_0_PS_40_5, loss: 0.029496146366000175, avg_mse: 0.03406691178679466
current test mse: 0.034067
Iteration: 1461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473015367984772, gen p mean: -0.6755807399749756, mean p set: 0.4477818012237549
loss_pred:0.028064340353012085, decouple_loss:0.012684375047683716
The modified gen p mean: 0.4484071731567383, gen p mean: -0.6697534918785095, mean p set: 0.44888749718666077The modified gen p mean: 0.44708606600761414, gen p mean: -0.6763135194778442, mean p set: 0.44756636023521423
loss_pred:0.0279129259288311, decouple_loss:0.012615935876965523
loss_pred:0.028400298207998276, decouple_loss:0.013259710744023323
Iteration: 1462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788992404937744, gen p mean: -0.6686150431632996, mean p set: 0.44837021827697754
loss_pred:0.02901504561305046, decouple_loss:0.012486682273447514
The modified gen p mean: 0.4465268552303314, gen p mean: -0.6737408638000488, mean p set: 0.4470071494579315The modified gen p mean: 0.4472237229347229, gen p mean: -0.6758069396018982, mean p set: 0.4477040469646454
loss_pred:0.0283777117729187, decouple_loss:0.012727596797049046
loss_pred:0.027966773137450218, decouple_loss:0.012177038006484509
Iteration: 1463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478013515472412, gen p mean: -0.669325590133667, mean p set: 0.4482816159725189
loss_pred:0.028638223186135292, decouple_loss:0.012464535422623158
The modified gen p mean: 0.44790297746658325, gen p mean: -0.6727489233016968, mean p set: 0.44838324189186096The modified gen p mean: 0.4477333128452301, gen p mean: -0.670637309551239, mean p set: 0.4482135772705078
loss_pred:0.028917862102389336, decouple_loss:0.013019479811191559
loss_pred:0.028499290347099304, decouple_loss:0.01192864403128624
Iteration: 1464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793903827667236, gen p mean: -0.677560031414032, mean p set: 0.44841933250427246
loss_pred:0.029971513897180557, decouple_loss:0.013075093738734722
The modified gen p mean: 0.4481946527957916, gen p mean: -0.6823901534080505, mean p set: 0.4486749470233917The modified gen p mean: 0.44749799370765686, gen p mean: -0.6771010160446167, mean p set: 0.44797828793525696
loss_pred:0.029640015214681625, decouple_loss:0.012897898443043232
loss_pred:0.02874082699418068, decouple_loss:0.012337259948253632
Iteration: 1465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463503658771515, gen p mean: -0.6793283224105835, mean p set: 0.4468306601047516
loss_pred:0.027239728718996048, decouple_loss:0.012507139705121517
The modified gen p mean: 0.4474934935569763, gen p mean: -0.6799288392066956, mean p set: 0.44797375798225403The modified gen p mean: 0.44779473543167114, gen p mean: -0.6730559468269348, mean p set: 0.44827502965927124
loss_pred:0.029701756313443184, decouple_loss:0.012681877240538597
loss_pred:0.028529426082968712, decouple_loss:0.012250454165041447
Iteration: 1466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462707042694092, gen p mean: -0.6721645593643188, mean p set: 0.4467509686946869
The modified gen p mean: 0.4482315480709076, gen p mean: -0.6687946319580078, mean p set: 0.4487118422985077
loss_pred:0.02880048006772995, decouple_loss:0.012527650222182274
loss_pred:0.028155287727713585, decouple_loss:0.012233009561896324
The modified gen p mean: 0.44731026887893677, gen p mean: -0.6787518858909607, mean p set: 0.44779056310653687
loss_pred:0.027783410623669624, decouple_loss:0.012490267865359783
Iteration: 1467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485853910446167, gen p mean: -0.6717454195022583, mean p set: 0.4490656852722168
The modified gen p mean: 0.44755229353904724, gen p mean: -0.6747490167617798, mean p set: 0.44803258776664734
loss_pred:0.02804248221218586, decouple_loss:0.012271666899323463
loss_pred:0.02834514155983925, decouple_loss:0.013057233765721321
The modified gen p mean: 0.44661808013916016, gen p mean: -0.6706585884094238, mean p set: 0.44709837436676025
loss_pred:0.02871532365679741, decouple_loss:0.012896696105599403
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676151871681213, gen p mean: -0.6825593113899231, mean p set: 0.44724181294441223
The modified gen p mean: 0.44717881083488464, gen p mean: -0.675295889377594, mean p set: 0.44765913486480713
loss_pred:0.027474815025925636, decouple_loss:0.012142789550125599
loss_pred:0.02894776314496994, decouple_loss:0.01201741024851799
The modified gen p mean: 0.447325736284256, gen p mean: -0.6797634959220886, mean p set: 0.4478060305118561
loss_pred:0.02864610031247139, decouple_loss:0.012366603128612041
Iteration: 1469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484720230102539, gen p mean: -0.67856764793396, mean p set: 0.448952317237854
The modified gen p mean: 0.4480937123298645, gen p mean: -0.6776576042175293, mean p set: 0.4485739767551422
loss_pred:0.028188908472657204, decouple_loss:0.012054660357534885
loss_pred:0.027713140472769737, decouple_loss:0.011733829975128174
The modified gen p mean: 0.4460480511188507, gen p mean: -0.6812443733215332, mean p set: 0.4465283155441284
loss_pred:0.029044359922409058, decouple_loss:0.012422277592122555
Iteration: 1470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472489655017853, gen p mean: -0.6808298826217651, mean p set: 0.447729229927063
The modified gen p mean: 0.44754186272621155, gen p mean: -0.6808589100837708, mean p set: 0.44802215695381165
loss_pred:0.028550973162055016, decouple_loss:0.011835713870823383
loss_pred:0.02780037187039852, decouple_loss:0.011549741961061954
The modified gen p mean: 0.44724777340888977, gen p mean: -0.6782760620117188, mean p set: 0.4477280378341675
loss_pred:0.028648218140006065, decouple_loss:0.011829237453639507
2023-05-01 21:31:06 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.6922558546066284, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6830060482025146, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6861709952354431, mean p set: 0.4500633478164673
loss_pred:0.02940695732831955, decouple_loss:0.012861928902566433
loss_pred:0.028137430548667908, decouple_loss:0.012552041560411453
loss_pred:0.028521766886115074, decouple_loss:0.01264816615730524
WV_0_PC_1_EH_0_PS_40_5, loss: 0.029323086142539978, avg_mse: 0.033945921808481216
current test mse: 0.033946
Iteration: 1471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660109281539917, gen p mean: -0.690744161605835, mean p set: 0.4470813572406769
loss_pred:0.028266433626413345, decouple_loss:0.011965982615947723
The modified gen p mean: 0.4473837912082672, gen p mean: -0.6807909607887268, mean p set: 0.4478640854358673The modified gen p mean: 0.4461391866207123, gen p mean: -0.681640088558197, mean p set: 0.44661951065063477
loss_pred:0.028308499604463577, decouple_loss:0.011954940855503082
loss_pred:0.027810096740722656, decouple_loss:0.011863070540130138
Iteration: 1472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476853907108307, gen p mean: -0.6835890412330627, mean p set: 0.4481656849384308
loss_pred:0.02870095521211624, decouple_loss:0.011668145656585693
The modified gen p mean: 0.44698426127433777, gen p mean: -0.6891037821769714, mean p set: 0.44746458530426025The modified gen p mean: 0.4477153718471527, gen p mean: -0.6856640577316284, mean p set: 0.4481956660747528
loss_pred:0.02785668335855007, decouple_loss:0.011946951039135456
loss_pred:0.0279373936355114, decouple_loss:0.01174524798989296
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
NaN value num: 0
Iteration: 1473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010796189308167, gen p mean: -0.6818522214889526, mean p set: 0.4505882263183594
loss_pred:0.030390216037631035, decouple_loss:0.014673723839223385
The modified gen p mean: 0.450736403465271, gen p mean: -0.6820836663246155, mean p set: 0.4512166678905487The modified gen p mean: 0.45086026191711426, gen p mean: -0.6744602918624878, mean p set: 0.45134055614471436
loss_pred:0.02894502878189087, decouple_loss:0.014781847596168518
loss_pred:0.03106580674648285, decouple_loss:0.014715082012116909
Iteration: 1474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493338465690613, gen p mean: -0.690553605556488, mean p set: 0.4498141407966614
loss_pred:0.030677830800414085, decouple_loss:0.014667312614619732
The modified gen p mean: 0.4487427771091461, gen p mean: -0.6906599998474121, mean p set: 0.4492231011390686The modified gen p mean: 0.45115989446640015, gen p mean: -0.6802272796630859, mean p set: 0.45164018869400024
loss_pred:0.029957329854369164, decouple_loss:0.014014805667102337
loss_pred:0.027818577364087105, decouple_loss:0.014541549608111382
Iteration: 1475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484102725982666, gen p mean: -0.6817569732666016, mean p set: 0.4488905668258667
loss_pred:0.02952868491411209, decouple_loss:0.013201146386563778
The modified gen p mean: 0.44963186979293823, gen p mean: -0.6844431757926941, mean p set: 0.45011213421821594The modified gen p mean: 0.4476175904273987, gen p mean: -0.6781888008117676, mean p set: 0.4480978846549988
loss_pred:0.030071165412664413, decouple_loss:0.01334169041365385
loss_pred:0.030181854963302612, decouple_loss:0.01345979142934084
Iteration: 1476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497939646244049, gen p mean: -0.6885857582092285, mean p set: 0.4502742886543274
The modified gen p mean: 0.44673827290534973, gen p mean: -0.6910368800163269, mean p set: 0.44721853733062744
loss_pred:0.029987510293722153, decouple_loss:0.01327244471758604
loss_pred:0.02854221686720848, decouple_loss:0.013045746833086014
The modified gen p mean: 0.4501286447048187, gen p mean: -0.6886623501777649, mean p set: 0.4506089687347412
loss_pred:0.02997305616736412, decouple_loss:0.013221951201558113
Iteration: 1477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517248272895813, gen p mean: -0.6862422823905945, mean p set: 0.4522051215171814
loss_pred:0.0279126837849617, decouple_loss:0.013537203893065453
The modified gen p mean: 0.4502513110637665, gen p mean: -0.6913002133369446, mean p set: 0.45073163509368896The modified gen p mean: 0.4505627155303955, gen p mean: -0.6857468485832214, mean p set: 0.4510430097579956
loss_pred:0.028584511950612068, decouple_loss:0.01366634201258421
loss_pred:0.029645346105098724, decouple_loss:0.012817987240850925
Iteration: 1478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479712247848511, gen p mean: -0.6778869032859802, mean p set: 0.44845154881477356
loss_pred:0.029948318377137184, decouple_loss:0.013255344703793526
The modified gen p mean: 0.4473506510257721, gen p mean: -0.681198239326477, mean p set: 0.4478309452533722The modified gen p mean: 0.44947007298469543, gen p mean: -0.678937554359436, mean p set: 0.44995033740997314
loss_pred:0.030245330184698105, decouple_loss:0.013021796010434628
loss_pred:0.030043430626392365, decouple_loss:0.013698922470211983
Iteration: 1479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026326179504395, gen p mean: -0.702700674533844, mean p set: 0.45074358582496643
The modified gen p mean: 0.4485870599746704, gen p mean: -0.6842398643493652, mean p set: 0.4490673840045929
The modified gen p mean: 0.44794586300849915, gen p mean: -0.699249804019928, mean p set: 0.44842615723609924
loss_pred:0.029237985610961914, decouple_loss:0.013590512797236443
loss_pred:0.02917127124965191, decouple_loss:0.01316980179399252loss_pred:0.029896199703216553, decouple_loss:0.01353572215884924
Iteration: 1480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507928490638733, gen p mean: -0.6948347687721252, mean p set: 0.4512731432914734
loss_pred:0.027934402227401733, decouple_loss:0.012950546108186245
The modified gen p mean: 0.4493923783302307, gen p mean: -0.7007669806480408, mean p set: 0.4498726725578308The modified gen p mean: 0.44914600253105164, gen p mean: -0.6872767806053162, mean p set: 0.44962626695632935
loss_pred:0.030638108029961586, decouple_loss:0.013107466511428356
loss_pred:0.030135085806250572, decouple_loss:0.012679683975875378
2023-05-01 21:33:50 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7052940130233765, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6944171786308289, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.6983753442764282, mean p set: 0.4500633478164673
loss_pred:0.029586702585220337, decouple_loss:0.015028522349894047
loss_pred:0.028167923912405968, decouple_loss:0.014458012767136097
loss_pred:0.028525013476610184, decouple_loss:0.01447448693215847
WV_0_PC_1_EH_0_PS_40_5, loss: 0.029492564499378204, avg_mse: 0.03417583554983139
current test mse: 0.034176
Iteration: 1481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44984108209609985, gen p mean: -0.704494833946228, mean p set: 0.45032137632369995
loss_pred:0.029837146401405334, decouple_loss:0.013189613819122314
The modified gen p mean: 0.4505573809146881, gen p mean: -0.6928107142448425, mean p set: 0.4510376751422882The modified gen p mean: 0.44911545515060425, gen p mean: -0.6872612237930298, mean p set: 0.44959574937820435
loss_pred:0.029526393860578537, decouple_loss:0.013007850386202335
loss_pred:0.02979821339249611, decouple_loss:0.013734869658946991
Iteration: 1482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477318227291107, gen p mean: -0.7109485864639282, mean p set: 0.4482121169567108
loss_pred:0.029068998992443085, decouple_loss:0.012864283286035061
The modified gen p mean: 0.44710466265678406, gen p mean: -0.7076165080070496, mean p set: 0.44758492708206177The modified gen p mean: 0.44841673970222473, gen p mean: -0.6943167448043823, mean p set: 0.44889700412750244
loss_pred:0.028382133692502975, decouple_loss:0.012838177382946014
loss_pred:0.0300931166857481, decouple_loss:0.012541504576802254
Iteration: 1483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496336281299591, gen p mean: -0.7117143869400024, mean p set: 0.4501139223575592
loss_pred:0.029488898813724518, decouple_loss:0.01282287947833538
The modified gen p mean: 0.4502987265586853, gen p mean: -0.7174811959266663, mean p set: 0.4507790505886078The modified gen p mean: 0.4507608711719513, gen p mean: -0.7041525840759277, mean p set: 0.4512411952018738
loss_pred:0.028514133766293526, decouple_loss:0.012791923247277737
loss_pred:0.027103133499622345, decouple_loss:0.013458836823701859
Iteration: 1484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819462299346924, gen p mean: -0.7146462798118591, mean p set: 0.44867488741874695
loss_pred:0.02908499911427498, decouple_loss:0.012721404433250427
The modified gen p mean: 0.4482898414134979, gen p mean: -0.704524576663971, mean p set: 0.448770135641098The modified gen p mean: 0.44995397329330444, gen p mean: -0.7049582004547119, mean p set: 0.45043426752090454
loss_pred:0.02945137396454811, decouple_loss:0.012416615150868893
loss_pred:0.029055390506982803, decouple_loss:0.012689482420682907
Iteration: 1485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45105382800102234, gen p mean: -0.6967012882232666, mean p set: 0.45153409242630005
The modified gen p mean: 0.45003268122673035, gen p mean: -0.6988300085067749, mean p set: 0.45051300525665283
loss_pred:0.0275819581001997, decouple_loss:0.013208437711000443
loss_pred:0.02893896959722042, decouple_loss:0.012560168281197548
The modified gen p mean: 0.44912129640579224, gen p mean: -0.6977373361587524, mean p set: 0.44960159063339233
loss_pred:0.028915800154209137, decouple_loss:0.012434585951268673
Iteration: 1486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786569476127625, gen p mean: -0.7056807279586792, mean p set: 0.44834598898887634
The modified gen p mean: 0.44674253463745117, gen p mean: -0.7026296257972717, mean p set: 0.44722285866737366
loss_pred:0.028681715950369835, decouple_loss:0.012377027422189713
loss_pred:0.027912002056837082, decouple_loss:0.012258266098797321
The modified gen p mean: 0.4507047235965729, gen p mean: -0.6957368850708008, mean p set: 0.4511849880218506
loss_pred:0.027897877618670464, decouple_loss:0.012770694680511951
Iteration: 1487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507257342338562, gen p mean: -0.7025748491287231, mean p set: 0.4512060284614563
loss_pred:0.028017105534672737, decouple_loss:0.01288358774036169
The modified gen p mean: 0.4486440122127533, gen p mean: -0.6950114965438843, mean p set: 0.449124276638031The modified gen p mean: 0.4485575258731842, gen p mean: -0.6961774230003357, mean p set: 0.4490378499031067
loss_pred:0.028612909838557243, decouple_loss:0.012500207871198654
loss_pred:0.029405919834971428, decouple_loss:0.013412903062999249
Iteration: 1488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476284086704254, gen p mean: -0.6917958855628967, mean p set: 0.4481086730957031
The modified gen p mean: 0.4480366110801697, gen p mean: -0.700413703918457, mean p set: 0.4485168755054474
The modified gen p mean: 0.4490819573402405, gen p mean: -0.7026912569999695, mean p set: 0.4495622515678406
loss_pred:0.0302883367985487, decouple_loss:0.012986051850020885
loss_pred:0.028977474197745323, decouple_loss:0.012574098072946072loss_pred:0.029961738735437393, decouple_loss:0.012676305137574673
Iteration: 1489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769155979156494, gen p mean: -0.6932081580162048, mean p set: 0.44817185401916504
The modified gen p mean: 0.4490266740322113, gen p mean: -0.6932007670402527, mean p set: 0.4495069682598114
loss_pred:0.030160225927829742, decouple_loss:0.012263144366443157
loss_pred:0.03080972470343113, decouple_loss:0.012647407129406929
The modified gen p mean: 0.44839614629745483, gen p mean: -0.7134249806404114, mean p set: 0.44887641072273254
loss_pred:0.028944483026862144, decouple_loss:0.012538980692625046
Iteration: 1490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494977295398712, gen p mean: -0.698756754398346, mean p set: 0.4499780237674713
The modified gen p mean: 0.4500325322151184, gen p mean: -0.6988003849983215, mean p set: 0.4505128264427185
loss_pred:0.030186370015144348, decouple_loss:0.012249804101884365
loss_pred:0.02845175936818123, decouple_loss:0.012555534951388836
The modified gen p mean: 0.44873711466789246, gen p mean: -0.7046634554862976, mean p set: 0.44921740889549255
loss_pred:0.029741749167442322, decouple_loss:0.012189911678433418
2023-05-01 21:35:59 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7084947824478149, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6985090970993042, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.702384352684021, mean p set: 0.4500633478164673
loss_pred:0.029567580670118332, decouple_loss:0.013804047368466854
loss_pred:0.028135722503066063, decouple_loss:0.013435677625238895
loss_pred:0.02856283262372017, decouple_loss:0.013291889801621437
WV_0_PC_1_EH_0_PS_40_5, loss: 0.02943090721964836, avg_mse: 0.03423528000712395
current test mse: 0.034235
Iteration: 1491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507276117801666, gen p mean: -0.6980456709861755, mean p set: 0.4512079358100891
loss_pred:0.027891842648386955, decouple_loss:0.012538215145468712
The modified gen p mean: 0.4471445083618164, gen p mean: -0.6926404237747192, mean p set: 0.4476247727870941The modified gen p mean: 0.44891273975372314, gen p mean: -0.6955145001411438, mean p set: 0.44939300417900085
loss_pred:0.028885845094919205, decouple_loss:0.012591622769832611
loss_pred:0.03008721023797989, decouple_loss:0.011893830262124538
Iteration: 1492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507743716239929, gen p mean: -0.69521564245224, mean p set: 0.45125463604927063
loss_pred:0.027375005185604095, decouple_loss:0.012376735918223858
The modified gen p mean: 0.44949010014533997, gen p mean: -0.7021020650863647, mean p set: 0.44997039437294006The modified gen p mean: 0.4480634927749634, gen p mean: -0.6940361261367798, mean p set: 0.4485437870025635
loss_pred:0.029497362673282623, decouple_loss:0.012435398995876312
loss_pred:0.029426520690321922, decouple_loss:0.012138264253735542
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
NaN value num: 0
Iteration: 1493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488983452320099, gen p mean: -0.7039454579353333, mean p set: 0.4493786096572876
loss_pred:0.02915729582309723, decouple_loss:0.012618027627468109
The modified gen p mean: 0.44825199246406555, gen p mean: -0.7045261859893799, mean p set: 0.44873231649398804The modified gen p mean: 0.44797283411026, gen p mean: -0.7096531391143799, mean p set: 0.4484530985355377
loss_pred:0.029244082048535347, decouple_loss:0.012719511985778809
loss_pred:0.029011238366365433, decouple_loss:0.012828806415200233
Iteration: 1494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801104068756104, gen p mean: -0.7106913924217224, mean p set: 0.44849130511283875
The modified gen p mean: 0.44797590374946594, gen p mean: -0.7115979790687561, mean p set: 0.44845619797706604loss_pred:0.0283576138317585, decouple_loss:0.012763197533786297
The modified gen p mean: 0.44762122631073, gen p mean: -0.7060511112213135, mean p set: 0.4481014907360077
loss_pred:0.028057893738150597, decouple_loss:0.012932497076690197
loss_pred:0.03052106685936451, decouple_loss:0.01252658013254404
Iteration: 1495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467930793762207, gen p mean: -0.712679386138916, mean p set: 0.4472734034061432
loss_pred:0.030467769131064415, decouple_loss:0.01310587115585804
The modified gen p mean: 0.4490949511528015, gen p mean: -0.7120702862739563, mean p set: 0.449575275182724The modified gen p mean: 0.4480680525302887, gen p mean: -0.7270426154136658, mean p set: 0.4485483467578888
loss_pred:0.029420144855976105, decouple_loss:0.012363994494080544
loss_pred:0.030098846182227135, decouple_loss:0.01388167031109333
Iteration: 1496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495515525341034, gen p mean: -0.71391361951828, mean p set: 0.4500318169593811
loss_pred:0.028606697916984558, decouple_loss:0.012398656457662582
The modified gen p mean: 0.4478619396686554, gen p mean: -0.7105251550674438, mean p set: 0.4483422338962555The modified gen p mean: 0.448026180267334, gen p mean: -0.7103301882743835, mean p set: 0.4485064744949341
loss_pred:0.02966860681772232, decouple_loss:0.012214776128530502
loss_pred:0.029630351811647415, decouple_loss:0.012030677869915962
Iteration: 1497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652047753334045, gen p mean: -0.7056521773338318, mean p set: 0.44700080156326294
loss_pred:0.030361291021108627, decouple_loss:0.012063016183674335
The modified gen p mean: 0.44672706723213196, gen p mean: -0.7094855308532715, mean p set: 0.44720733165740967The modified gen p mean: 0.4480954706668854, gen p mean: -0.7086743712425232, mean p set: 0.4485757648944855
loss_pred:0.029655443504452705, decouple_loss:0.012453348375856876
loss_pred:0.0287400484085083, decouple_loss:0.012706192210316658
Iteration: 1498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44583308696746826, gen p mean: -0.701399028301239, mean p set: 0.44631341099739075
loss_pred:0.03067116066813469, decouple_loss:0.012918672524392605
The modified gen p mean: 0.44757699966430664, gen p mean: -0.7067921161651611, mean p set: 0.44805729389190674The modified gen p mean: 0.44710925221443176, gen p mean: -0.7060832977294922, mean p set: 0.44758954644203186
loss_pred:0.03006383590400219, decouple_loss:0.012406108900904655
loss_pred:0.03034093603491783, decouple_loss:0.013056060299277306
Iteration: 1499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44624578952789307, gen p mean: -0.6972901821136475, mean p set: 0.44672608375549316
loss_pred:0.0302437674254179, decouple_loss:0.013247300870716572
The modified gen p mean: 0.4481285512447357, gen p mean: -0.69661945104599, mean p set: 0.4486088454723358The modified gen p mean: 0.44777607917785645, gen p mean: -0.6989111304283142, mean p set: 0.44825637340545654
loss_pred:0.029313255101442337, decouple_loss:0.012304686941206455
loss_pred:0.029364945366978645, decouple_loss:0.011596160009503365
Iteration: 1500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490673840045929, gen p mean: -0.701482355594635, mean p set: 0.4495477080345154
loss_pred:0.029012853279709816, decouple_loss:0.012870057485997677
The modified gen p mean: 0.4482826292514801, gen p mean: -0.7050297260284424, mean p set: 0.4487628936767578The modified gen p mean: 0.4461629092693329, gen p mean: -0.6984490752220154, mean p set: 0.4466431736946106
loss_pred:0.029963500797748566, decouple_loss:0.011784595437347889
loss_pred:0.030159825459122658, decouple_loss:0.012907136231660843
2023-05-01 21:38:44 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7067694067955017, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6963562369346619, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7000759243965149, mean p set: 0.4500633478164673
loss_pred:0.02951846644282341, decouple_loss:0.01310005970299244
loss_pred:0.028112249448895454, decouple_loss:0.013054384849965572
loss_pred:0.028570303693413734, decouple_loss:0.01269023772329092
WV_0_PC_1_EH_0_PS_40_5, loss: 0.02938108518719673, avg_mse: 0.034197866916656494
current test mse: 0.034198
Iteration: 1501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826894998550415, gen p mean: -0.7026136517524719, mean p set: 0.44874924421310425
loss_pred:0.028766492381691933, decouple_loss:0.012263595126569271
The modified gen p mean: 0.4475128650665283, gen p mean: -0.7020524740219116, mean p set: 0.4479931592941284The modified gen p mean: 0.44722896814346313, gen p mean: -0.7010413408279419, mean p set: 0.44770923256874084
loss_pred:0.029051583260297775, decouple_loss:0.012531772255897522
loss_pred:0.029735993593931198, decouple_loss:0.0121237738057971
Iteration: 1502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796857237815857, gen p mean: -0.715359628200531, mean p set: 0.4484488368034363
loss_pred:0.028877288103103638, decouple_loss:0.012461376376450062
The modified gen p mean: 0.44887351989746094, gen p mean: -0.7014894485473633, mean p set: 0.44935378432273865The modified gen p mean: 0.44812726974487305, gen p mean: -0.7117173075675964, mean p set: 0.44860756397247314
loss_pred:0.029796244576573372, decouple_loss:0.012044333852827549
loss_pred:0.028136689215898514, decouple_loss:0.012135690078139305
Iteration: 1503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483039677143097, gen p mean: -0.7146456837654114, mean p set: 0.4487842321395874
loss_pred:0.029064249247312546, decouple_loss:0.01225143950432539
The modified gen p mean: 0.4503830373287201, gen p mean: -0.7142888903617859, mean p set: 0.4508633017539978The modified gen p mean: 0.4483500123023987, gen p mean: -0.7192980051040649, mean p set: 0.4488303065299988
loss_pred:0.0285757128149271, decouple_loss:0.012247701175510883
loss_pred:0.02868550457060337, decouple_loss:0.011975844390690327
Iteration: 1504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474814534187317, gen p mean: -0.7096455097198486, mean p set: 0.4479617476463318
The modified gen p mean: 0.44650816917419434, gen p mean: -0.7054620981216431, mean p set: 0.4469884932041168
loss_pred:0.028244340792298317, decouple_loss:0.012147322297096252
loss_pred:0.02983878180384636, decouple_loss:0.012562963180243969
The modified gen p mean: 0.4481065571308136, gen p mean: -0.7053407430648804, mean p set: 0.4485867917537689
loss_pred:0.029937732964754105, decouple_loss:0.011762717738747597
Iteration: 1505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850054383277893, gen p mean: -0.7017800807952881, mean p set: 0.44898083806037903
The modified gen p mean: 0.45025894045829773, gen p mean: -0.7034469246864319, mean p set: 0.4507392346858978
loss_pred:0.02901257947087288, decouple_loss:0.01166940201073885
loss_pred:0.02826308086514473, decouple_loss:0.011430568993091583
The modified gen p mean: 0.4473099708557129, gen p mean: -0.7064370512962341, mean p set: 0.447790265083313
loss_pred:0.029344847425818443, decouple_loss:0.011870505288243294
Iteration: 1506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477001428604126, gen p mean: -0.7083819508552551, mean p set: 0.4481804668903351
The modified gen p mean: 0.44938087463378906, gen p mean: -0.7060595154762268, mean p set: 0.44986119866371155
loss_pred:0.029109152033925056, decouple_loss:0.011872933246195316
loss_pred:0.029674606397747993, decouple_loss:0.012060632929205894
The modified gen p mean: 0.44753506779670715, gen p mean: -0.7052550315856934, mean p set: 0.44801533222198486
loss_pred:0.02890866808593273, decouple_loss:0.011726608499884605
Iteration: 1507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760388135910034, gen p mean: -0.6996877789497375, mean p set: 0.44808417558670044
The modified gen p mean: 0.4470476806163788, gen p mean: -0.7082921862602234, mean p set: 0.4475279748439789
loss_pred:0.030389729887247086, decouple_loss:0.012002627365291119
loss_pred:0.029879458248615265, decouple_loss:0.012086153961718082
The modified gen p mean: 0.4472200274467468, gen p mean: -0.7057769894599915, mean p set: 0.44770026206970215
loss_pred:0.03015724942088127, decouple_loss:0.011949501931667328
Iteration: 1508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448306679725647, gen p mean: -0.6949349045753479, mean p set: 0.44878700375556946
loss_pred:0.030075712129473686, decouple_loss:0.011829842813313007
The modified gen p mean: 0.4461364150047302, gen p mean: -0.6993080973625183, mean p set: 0.4466167390346527The modified gen p mean: 0.4473567008972168, gen p mean: -0.7005041837692261, mean p set: 0.4478370249271393
loss_pred:0.029119228944182396, decouple_loss:0.011966429650783539
loss_pred:0.03076852485537529, decouple_loss:0.012285308912396431
Iteration: 1509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488906264305115, gen p mean: -0.693693995475769, mean p set: 0.44937095046043396
The modified gen p mean: 0.44820618629455566, gen p mean: -0.7055599093437195, mean p set: 0.44868648052215576
loss_pred:0.029489591717720032, decouple_loss:0.011655904352664948
loss_pred:0.028161639347672462, decouple_loss:0.011310976929962635
The modified gen p mean: 0.44676050543785095, gen p mean: -0.7009307146072388, mean p set: 0.44724079966545105
loss_pred:0.03032105788588524, decouple_loss:0.01157339382916689
Iteration: 1510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485817849636078, gen p mean: -0.7024819254875183, mean p set: 0.4490620791912079
The modified gen p mean: 0.44772714376449585, gen p mean: -0.7023690342903137, mean p set: 0.44820740818977356
loss_pred:0.02991739846765995, decouple_loss:0.011381836608052254
loss_pred:0.02983386255800724, decouple_loss:0.01173276174813509
The modified gen p mean: 0.4467003345489502, gen p mean: -0.7045623064041138, mean p set: 0.4471806287765503
loss_pred:0.029486021026968956, decouple_loss:0.011327238753437996
2023-05-01 21:40:52 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7071398496627808, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.697958767414093, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7010979652404785, mean p set: 0.4500633478164673
loss_pred:0.0295279398560524, decouple_loss:0.012647501192986965
loss_pred:0.028093982487916946, decouple_loss:0.012437795288860798
loss_pred:0.028506122529506683, decouple_loss:0.01208198256790638
WV_0_PC_1_EH_0_PS_40_5, loss: 0.029328804463148117, avg_mse: 0.034119073301553726
current test mse: 0.034119
Iteration: 1511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806066155433655, gen p mean: -0.7106325626373291, mean p set: 0.44854092597961426
loss_pred:0.02960050292313099, decouple_loss:0.012026318348944187
The modified gen p mean: 0.4492214024066925, gen p mean: -0.6961538791656494, mean p set: 0.4497016966342926The modified gen p mean: 0.4472379982471466, gen p mean: -0.6995048522949219, mean p set: 0.4477182924747467
loss_pred:0.030453817918896675, decouple_loss:0.011421293951570988
loss_pred:0.029591605067253113, decouple_loss:0.011491232551634312
Iteration: 1512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476563036441803, gen p mean: -0.7044991850852966, mean p set: 0.4481366276741028
loss_pred:0.028765035793185234, decouple_loss:0.011523581109941006
The modified gen p mean: 0.4491898715496063, gen p mean: -0.7020805478096008, mean p set: 0.44967013597488403The modified gen p mean: 0.44899240136146545, gen p mean: -0.693945050239563, mean p set: 0.44947269558906555
loss_pred:0.028924740850925446, decouple_loss:0.01127538364380598
loss_pred:0.02925659902393818, decouple_loss:0.011347388848662376
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
NaN value num: 0
Iteration: 1513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472513794898987, gen p mean: -0.7054176926612854, mean p set: 0.4477316439151764
loss_pred:0.028947992250323296, decouple_loss:0.011610071174800396
The modified gen p mean: 0.44939735531806946, gen p mean: -0.7081092596054077, mean p set: 0.44987761974334717The modified gen p mean: 0.446571409702301, gen p mean: -0.6976941227912903, mean p set: 0.4470517337322235
loss_pred:0.02794615551829338, decouple_loss:0.01195157878100872
loss_pred:0.028989365324378014, decouple_loss:0.011393455788493156
Iteration: 1514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464147090911865, gen p mean: -0.705398678779602, mean p set: 0.4468950033187866
loss_pred:0.02783496491611004, decouple_loss:0.011666877195239067
The modified gen p mean: 0.44633185863494873, gen p mean: -0.7035821676254272, mean p set: 0.44681212306022644The modified gen p mean: 0.4453831911087036, gen p mean: -0.703963577747345, mean p set: 0.4458634853363037
loss_pred:0.027979962527751923, decouple_loss:0.011342847719788551
loss_pred:0.02903490699827671, decouple_loss:0.01185073982924223
Iteration: 1515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456835389137268, gen p mean: -0.6995423436164856, mean p set: 0.4461638331413269
loss_pred:0.028522314503788948, decouple_loss:0.011482122354209423
The modified gen p mean: 0.4475783109664917, gen p mean: -0.7012917995452881, mean p set: 0.4480586051940918The modified gen p mean: 0.4482898414134979, gen p mean: -0.7063671350479126, mean p set: 0.4487701654434204
loss_pred:0.029010498896241188, decouple_loss:0.012171043083071709
loss_pred:0.028287366032600403, decouple_loss:0.012191951274871826
Iteration: 1516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459202289581299, gen p mean: -0.7012991905212402, mean p set: 0.44640052318573
loss_pred:0.0283355750143528, decouple_loss:0.011485083028674126
The modified gen p mean: 0.4477458596229553, gen p mean: -0.7101595401763916, mean p set: 0.4482261538505554The modified gen p mean: 0.4482974410057068, gen p mean: -0.6973810195922852, mean p set: 0.4487777352333069
loss_pred:0.027943577617406845, decouple_loss:0.011989451013505459
loss_pred:0.029036585241556168, decouple_loss:0.011665180325508118
Iteration: 1517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483083188533783, gen p mean: -0.7009358406066895, mean p set: 0.4487886130809784
loss_pred:0.028686316683888435, decouple_loss:0.011564575135707855
The modified gen p mean: 0.4479353427886963, gen p mean: -0.7080636024475098, mean p set: 0.4484156668186188The modified gen p mean: 0.446050226688385, gen p mean: -0.6997916102409363, mean p set: 0.4465305209159851
loss_pred:0.027667181566357613, decouple_loss:0.011945478618144989
loss_pred:0.029019959270954132, decouple_loss:0.011493446305394173
Iteration: 1518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44538143277168274, gen p mean: -0.7032760977745056, mean p set: 0.44586169719696045
The modified gen p mean: 0.44878455996513367, gen p mean: -0.7096338272094727, mean p set: 0.44926485419273376
loss_pred:0.02798234485089779, decouple_loss:0.011434906162321568
loss_pred:0.028913112357258797, decouple_loss:0.011869355104863644
The modified gen p mean: 0.44616615772247314, gen p mean: -0.703006386756897, mean p set: 0.44664642214775085
loss_pred:0.028529159724712372, decouple_loss:0.01152841281145811
Iteration: 1519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456712305545807, gen p mean: -0.6959037780761719, mean p set: 0.4461515247821808
The modified gen p mean: 0.44722527265548706, gen p mean: -0.7036380767822266, mean p set: 0.44770559668540955
loss_pred:0.027799883857369423, decouple_loss:0.011358038522303104
loss_pred:0.02827705815434456, decouple_loss:0.01125457976013422
The modified gen p mean: 0.4458862841129303, gen p mean: -0.7014271020889282, mean p set: 0.446366548538208
loss_pred:0.027704356238245964, decouple_loss:0.01106517668813467
Iteration: 1520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481053948402405, gen p mean: -0.7113389372825623, mean p set: 0.44858571887016296
loss_pred:0.029564693570137024, decouple_loss:0.012397406622767448
The modified gen p mean: 0.4488806128501892, gen p mean: -0.697507381439209, mean p set: 0.4493609070777893The modified gen p mean: 0.44729194045066833, gen p mean: -0.708254337310791, mean p set: 0.44777223467826843
loss_pred:0.029378360137343407, decouple_loss:0.012450061738491058
loss_pred:0.029058752581477165, decouple_loss:0.011146987788379192
2023-05-01 21:43:38 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.715094268321991, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7081640362739563, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987669587135315, gen p mean: -0.7042163610458374, mean p set: 0.45035696029663086
loss_pred:0.02936803363263607, decouple_loss:0.01241715345531702
loss_pred:0.027901051566004753, decouple_loss:0.012340370565652847
loss_pred:0.02821286953985691, decouple_loss:0.01202745083719492
WV_0_PC_1_EH_0_PS_40_5, loss: 0.029107067734003067, avg_mse: 0.03382454812526703
current test mse: 0.033825
Iteration: 1521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904494285583496, gen p mean: -0.7105781435966492, mean p set: 0.44952526688575745
The modified gen p mean: 0.4470728039741516, gen p mean: -0.7159309983253479, mean p set: 0.4475530982017517
loss_pred:0.029257813468575478, decouple_loss:0.011399881914258003
The modified gen p mean: 0.4456888437271118, gen p mean: -0.710399866104126, mean p set: 0.4461691081523895
loss_pred:0.027796238660812378, decouple_loss:0.011510000564157963
loss_pred:0.02811686135828495, decouple_loss:0.011217177845537663
Iteration: 1522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459381401538849, gen p mean: -0.7079832553863525, mean p set: 0.446418434381485
The modified gen p mean: 0.4471195936203003, gen p mean: -0.7152059078216553, mean p set: 0.4475998878479004
loss_pred:0.029100913554430008, decouple_loss:0.011108595877885818
loss_pred:0.029379555955529213, decouple_loss:0.011530216783285141
The modified gen p mean: 0.44680359959602356, gen p mean: -0.7164085507392883, mean p set: 0.44728389382362366
loss_pred:0.02853170782327652, decouple_loss:0.011874772608280182
Iteration: 1523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636714458465576, gen p mean: -0.7102410197257996, mean p set: 0.44684743881225586
The modified gen p mean: 0.44679054617881775, gen p mean: -0.7121545076370239, mean p set: 0.44727084040641785
loss_pred:0.028797630220651627, decouple_loss:0.011035212315618992
loss_pred:0.02818308025598526, decouple_loss:0.011127603240311146
The modified gen p mean: 0.44823578000068665, gen p mean: -0.7045950889587402, mean p set: 0.44871607422828674
loss_pred:0.02865736559033394, decouple_loss:0.010886495932936668
Iteration: 1524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463096559047699, gen p mean: -0.7129135131835938, mean p set: 0.44678995013237
The modified gen p mean: 0.44712579250335693, gen p mean: -0.717387318611145, mean p set: 0.44760608673095703
loss_pred:0.02876894176006317, decouple_loss:0.010887396521866322
loss_pred:0.028714461252093315, decouple_loss:0.01127548422664404
The modified gen p mean: 0.44609618186950684, gen p mean: -0.7106785774230957, mean p set: 0.44657647609710693
loss_pred:0.02761647291481495, decouple_loss:0.011065438389778137
Iteration: 1525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44540107250213623, gen p mean: -0.7107239365577698, mean p set: 0.44588136672973633
The modified gen p mean: 0.44666028022766113, gen p mean: -0.7172978520393372, mean p set: 0.44714057445526123
loss_pred:0.02909945324063301, decouple_loss:0.011023959144949913
loss_pred:0.028502745553851128, decouple_loss:0.011404214426875114The modified gen p mean: 0.44561290740966797, gen p mean: -0.7087399959564209, mean p set: 0.44609320163726807
loss_pred:0.02692635916173458, decouple_loss:0.011001170612871647
Iteration: 1526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707542657852173, gen p mean: -0.7142065763473511, mean p set: 0.4475557208061218
The modified gen p mean: 0.4473434090614319, gen p mean: -0.7136898040771484, mean p set: 0.4478236734867096
loss_pred:0.029195992276072502, decouple_loss:0.010888205841183662
loss_pred:0.028646675869822502, decouple_loss:0.011047753505408764
The modified gen p mean: 0.4464940130710602, gen p mean: -0.7155435085296631, mean p set: 0.4469743072986603
loss_pred:0.02876455709338188, decouple_loss:0.010783512145280838
Iteration: 1527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471910297870636, gen p mean: -0.722059428691864, mean p set: 0.4476713538169861
The modified gen p mean: 0.44714638590812683, gen p mean: -0.7145116329193115, mean p set: 0.4476267099380493
loss_pred:0.028104690834879875, decouple_loss:0.0108849061653018
loss_pred:0.028927093371748924, decouple_loss:0.010456928052008152
The modified gen p mean: 0.44915899634361267, gen p mean: -0.718154788017273, mean p set: 0.44963929057121277
loss_pred:0.028457382693886757, decouple_loss:0.011585680767893791
Iteration: 1528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648781418800354, gen p mean: -0.707903265953064, mean p set: 0.446968138217926
The modified gen p mean: 0.44593241810798645, gen p mean: -0.7064975500106812, mean p set: 0.44641271233558655
loss_pred:0.02894863486289978, decouple_loss:0.010614856146275997
loss_pred:0.027918463572859764, decouple_loss:0.01139796618372202
The modified gen p mean: 0.44632381200790405, gen p mean: -0.6997293829917908, mean p set: 0.44680410623550415
loss_pred:0.027705788612365723, decouple_loss:0.011315499432384968
Iteration: 1529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473308026790619, gen p mean: -0.7063032984733582, mean p set: 0.447811096906662
The modified gen p mean: 0.4460093677043915, gen p mean: -0.7036012411117554, mean p set: 0.4464896619319916
loss_pred:0.027857158333063126, decouple_loss:0.011616910807788372
loss_pred:0.027856022119522095, decouple_loss:0.011199000291526318
The modified gen p mean: 0.44680696725845337, gen p mean: -0.7030602693557739, mean p set: 0.44728726148605347
loss_pred:0.027728082612156868, decouple_loss:0.011342215351760387
Iteration: 1530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733691215515137, gen p mean: -0.7050624489784241, mean p set: 0.44781720638275146
The modified gen p mean: 0.44588378071784973, gen p mean: -0.6998149752616882, mean p set: 0.44636404514312744
loss_pred:0.028128057718276978, decouple_loss:0.011041365563869476
loss_pred:0.02780941314995289, decouple_loss:0.010870133526623249
The modified gen p mean: 0.4462382197380066, gen p mean: -0.6957844495773315, mean p set: 0.4467185139656067
loss_pred:0.029105855152010918, decouple_loss:0.010796841233968735
2023-05-01 21:45:49 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7081947326660156, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.6973989009857178, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7013269662857056, mean p set: 0.4500633478164673
loss_pred:0.02960614487528801, decouple_loss:0.012181333266198635
loss_pred:0.02814931608736515, decouple_loss:0.012223784811794758
loss_pred:0.02860959619283676, decouple_loss:0.011846198700368404
WV_0_PC_1_EH_0_PS_40_5, loss: 0.029392540454864502, avg_mse: 0.03433411195874214
current test mse: 0.034334
Iteration: 1531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870543479919434, gen p mean: -0.6982974410057068, mean p set: 0.44918572902679443
The modified gen p mean: 0.4464988112449646, gen p mean: -0.6991972923278809, mean p set: 0.4469790756702423
loss_pred:0.028294557705521584, decouple_loss:0.011265070177614689
The modified gen p mean: 0.446638286113739, gen p mean: -0.7076558470726013, mean p set: 0.4471185803413391
loss_pred:0.028736503794789314, decouple_loss:0.011750053614377975
loss_pred:0.028246713802218437, decouple_loss:0.011238167993724346
Iteration: 1532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758152961730957, gen p mean: -0.7104418873786926, mean p set: 0.4480617940425873
The modified gen p mean: 0.44807305932044983, gen p mean: -0.7112317681312561, mean p set: 0.4485533535480499
loss_pred:0.029125375673174858, decouple_loss:0.011180982924997807
loss_pred:0.029203947633504868, decouple_loss:0.011399190872907639
The modified gen p mean: 0.4475260376930237, gen p mean: -0.7107003331184387, mean p set: 0.4480063021183014
loss_pred:0.027589134871959686, decouple_loss:0.01119085680693388
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
NaN value num: 0
Iteration: 1533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45175936818122864, gen p mean: -0.6994445323944092, mean p set: 0.4522396922111511
loss_pred:0.02834060788154602, decouple_loss:0.01333921030163765
The modified gen p mean: 0.4503130614757538, gen p mean: -0.7060943245887756, mean p set: 0.4507933557033539The modified gen p mean: 0.45175155997276306, gen p mean: -0.7076267004013062, mean p set: 0.45223185420036316
loss_pred:0.028048207983374596, decouple_loss:0.014067227020859718
loss_pred:0.02790079452097416, decouple_loss:0.012275312095880508
Iteration: 1534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506767988204956, gen p mean: -0.6966995000839233, mean p set: 0.4511570930480957
The modified gen p mean: 0.45153576135635376, gen p mean: -0.6943200826644897, mean p set: 0.45201605558395386
The modified gen p mean: 0.44944626092910767, gen p mean: -0.7021863460540771, mean p set: 0.44992655515670776
loss_pred:0.029007675126194954, decouple_loss:0.013228939846158028
loss_pred:0.028829781338572502, decouple_loss:0.013286497443914413loss_pred:0.028611211106181145, decouple_loss:0.013705914840102196
Iteration: 1535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45241865515708923, gen p mean: -0.6960617899894714, mean p set: 0.45289894938468933
The modified gen p mean: 0.4504777491092682, gen p mean: -0.6901866793632507, mean p set: 0.4509580433368683
The modified gen p mean: 0.45014965534210205, gen p mean: -0.695623517036438, mean p set: 0.45062994956970215
loss_pred:0.02746773697435856, decouple_loss:0.013153989799320698
loss_pred:0.027852045372128487, decouple_loss:0.01250831875950098loss_pred:0.028996244072914124, decouple_loss:0.012665699236094952
Iteration: 1536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505440890789032, gen p mean: -0.7014943361282349, mean p set: 0.4510243833065033
The modified gen p mean: 0.4498281180858612, gen p mean: -0.6962222456932068, mean p set: 0.4503083825111389
The modified gen p mean: 0.45029667019844055, gen p mean: -0.6974220871925354, mean p set: 0.45077693462371826
loss_pred:0.029063602909445763, decouple_loss:0.013157956302165985
loss_pred:0.028956415131688118, decouple_loss:0.012313125655055046loss_pred:0.027892015874385834, decouple_loss:0.012822349555790424
Iteration: 1537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509449303150177, gen p mean: -0.690171480178833, mean p set: 0.4514252245426178
The modified gen p mean: 0.4530012309551239, gen p mean: -0.6962317228317261, mean p set: 0.453481525182724
loss_pred:0.028275206685066223, decouple_loss:0.011613940820097923
loss_pred:0.026946838945150375, decouple_loss:0.011871765367686749
The modified gen p mean: 0.4501487612724304, gen p mean: -0.6942312121391296, mean p set: 0.45062902569770813
loss_pred:0.02782006561756134, decouple_loss:0.011720282025635242
Iteration: 1538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504963755607605, gen p mean: -0.6938959360122681, mean p set: 0.4509766697883606
The modified gen p mean: 0.4510102868080139, gen p mean: -0.6904259920120239, mean p set: 0.451490581035614
The modified gen p mean: 0.4506543278694153, gen p mean: -0.695081353187561, mean p set: 0.4511346220970154
loss_pred:0.028831422328948975, decouple_loss:0.012582210823893547
loss_pred:0.02804465964436531, decouple_loss:0.012563414871692657
loss_pred:0.02848813682794571, decouple_loss:0.012586506083607674
Iteration: 1539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500151574611664, gen p mean: -0.691038966178894, mean p set: 0.4504954218864441
The modified gen p mean: 0.4516170918941498, gen p mean: -0.6940929293632507, mean p set: 0.4520973861217499
The modified gen p mean: 0.45134708285331726, gen p mean: -0.69333815574646, mean p set: 0.45182737708091736
loss_pred:0.02809491567313671, decouple_loss:0.01228620857000351
loss_pred:0.027434706687927246, decouple_loss:0.012695622630417347
loss_pred:0.02841731533408165, decouple_loss:0.01239488273859024
Iteration: 1540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45124179124832153, gen p mean: -0.70363849401474, mean p set: 0.451722115278244The modified gen p mean: 0.4517829120159149, gen p mean: -0.6958392858505249, mean p set: 0.452263206243515
The modified gen p mean: 0.45045387744903564, gen p mean: -0.6967571973800659, mean p set: 0.45093417167663574
loss_pred:0.028866494074463844, decouple_loss:0.013404829427599907
loss_pred:0.027824366465210915, decouple_loss:0.012056480161845684
loss_pred:0.028042027726769447, decouple_loss:0.011978251859545708
2023-05-01 21:48:33 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7022524476051331, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.691923975944519, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.6956272125244141, mean p set: 0.4500633478164673
loss_pred:0.02962343953549862, decouple_loss:0.014078103005886078
loss_pred:0.02858339436352253, decouple_loss:0.01352846622467041
loss_pred:0.028159188106656075, decouple_loss:0.013851814903318882
WV_0_PC_1_EH_0_PS_40_5, loss: 0.029479648917913437, avg_mse: 0.034476473927497864
current test mse: 0.034476
Iteration: 1541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033127069473267, gen p mean: -0.6958929896354675, mean p set: 0.4508115351200104
The modified gen p mean: 0.45170366764068604, gen p mean: -0.7073449492454529, mean p set: 0.45218396186828613
loss_pred:0.027424300089478493, decouple_loss:0.012282258830964565
The modified gen p mean: 0.45107388496398926, gen p mean: -0.6930689215660095, mean p set: 0.45155417919158936
loss_pred:0.029116513207554817, decouple_loss:0.013153377920389175
loss_pred:0.02861063741147518, decouple_loss:0.012539008632302284
Iteration: 1542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509936571121216, gen p mean: -0.699015736579895, mean p set: 0.4514739513397217
The modified gen p mean: 0.4522620439529419, gen p mean: -0.7082114815711975, mean p set: 0.452742338180542
loss_pred:0.027857467532157898, decouple_loss:0.012584645301103592
loss_pred:0.026653775945305824, decouple_loss:0.012618145905435085
The modified gen p mean: 0.4502072036266327, gen p mean: -0.6976597309112549, mean p set: 0.4506874978542328
loss_pred:0.029330244287848473, decouple_loss:0.01230752281844616
Iteration: 1543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108503103256226, gen p mean: -0.7012102603912354, mean p set: 0.45156532526016235
loss_pred:0.026620296761393547, decouple_loss:0.012483851052820683
The modified gen p mean: 0.4519435167312622, gen p mean: -0.7003775835037231, mean p set: 0.4524238109588623The modified gen p mean: 0.45239830017089844, gen p mean: -0.6959226131439209, mean p set: 0.4528786242008209
loss_pred:0.026927679777145386, decouple_loss:0.012181451544165611
loss_pred:0.027706151828169823, decouple_loss:0.011919645592570305
Iteration: 1544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500358998775482, gen p mean: -0.6934442520141602, mean p set: 0.4505161941051483
The modified gen p mean: 0.4508785307407379, gen p mean: -0.6996159553527832, mean p set: 0.451358824968338
loss_pred:0.027538519352674484, decouple_loss:0.011836783960461617
loss_pred:0.027247795835137367, decouple_loss:0.011813348159193993
The modified gen p mean: 0.4526062309741974, gen p mean: -0.694758951663971, mean p set: 0.4530864953994751
loss_pred:0.027809562161564827, decouple_loss:0.011687323451042175
Iteration: 1545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451369047164917, gen p mean: -0.6954870820045471, mean p set: 0.4518493115901947
The modified gen p mean: 0.45068854093551636, gen p mean: -0.7046523094177246, mean p set: 0.45116883516311646
loss_pred:0.028367994353175163, decouple_loss:0.011928115971386433
loss_pred:0.02877955138683319, decouple_loss:0.012619427405297756
The modified gen p mean: 0.45170968770980835, gen p mean: -0.6962399482727051, mean p set: 0.45218998193740845
loss_pred:0.028191430494189262, decouple_loss:0.011901004239916801
Iteration: 1546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494660496711731, gen p mean: -0.7088995575904846, mean p set: 0.4499463438987732
The modified gen p mean: 0.4517129063606262, gen p mean: -0.7086679935455322, mean p set: 0.4521932005882263
loss_pred:0.02879362925887108, decouple_loss:0.01204074826091528
loss_pred:0.027919283136725426, decouple_loss:0.011355631984770298
The modified gen p mean: 0.45127442479133606, gen p mean: -0.7071155309677124, mean p set: 0.45175471901893616
loss_pred:0.02747582271695137, decouple_loss:0.01201491616666317
Iteration: 1547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509691596031189, gen p mean: -0.7023076415061951, mean p set: 0.451449453830719
The modified gen p mean: 0.44963377714157104, gen p mean: -0.7159959077835083, mean p set: 0.45011407136917114
loss_pred:0.026932109147310257, decouple_loss:0.012197382748126984
loss_pred:0.027928097173571587, decouple_loss:0.012349769473075867
The modified gen p mean: 0.45027369260787964, gen p mean: -0.7087708115577698, mean p set: 0.4507540166378021
loss_pred:0.02816593088209629, decouple_loss:0.011471671983599663
Iteration: 1548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520995318889618, gen p mean: -0.7123831510543823, mean p set: 0.4525797963142395
The modified gen p mean: 0.45106467604637146, gen p mean: -0.7037868499755859, mean p set: 0.45154494047164917
loss_pred:0.027354517951607704, decouple_loss:0.012254456989467144
loss_pred:0.026611339300870895, decouple_loss:0.012303512543439865
The modified gen p mean: 0.45130977034568787, gen p mean: -0.7000007629394531, mean p set: 0.45179006457328796
loss_pred:0.027886897325515747, decouple_loss:0.011358559131622314
Iteration: 1549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499052166938782, gen p mean: -0.6997212171554565, mean p set: 0.45038551092147827
The modified gen p mean: 0.4530681371688843, gen p mean: -0.707671582698822, mean p set: 0.45354846119880676
loss_pred:0.02704203501343727, decouple_loss:0.01178530603647232
loss_pred:0.02622728981077671, decouple_loss:0.011778389103710651
The modified gen p mean: 0.45092010498046875, gen p mean: -0.7038878202438354, mean p set: 0.45140039920806885
loss_pred:0.02720871940255165, decouple_loss:0.011871070601046085
Iteration: 1550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512133300304413, gen p mean: -0.7142933011054993, mean p set: 0.4516936242580414
The modified gen p mean: 0.45238879323005676, gen p mean: -0.7075050473213196, mean p set: 0.45286911725997925
loss_pred:0.028417380526661873, decouple_loss:0.01186697743833065
loss_pred:0.027430854737758636, decouple_loss:0.011896801181137562
The modified gen p mean: 0.451595664024353, gen p mean: -0.7068831920623779, mean p set: 0.4520759880542755
loss_pred:0.026974845677614212, decouple_loss:0.011373921297490597
2023-05-01 21:50:42 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7124572396278381, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7051190733909607, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7012751698493958, mean p set: 0.45035696029663086
loss_pred:0.02946208417415619, decouple_loss:0.013943334110081196
loss_pred:0.028337553143501282, decouple_loss:0.01329838763922453
loss_pred:0.027926845476031303, decouple_loss:0.013674615882337093
WV_0_PC_1_EH_0_PS_40_5, loss: 0.029257435351610184, avg_mse: 0.03412839025259018
current test mse: 0.034128
Iteration: 1551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451000839471817, gen p mean: -0.7098211646080017, mean p set: 0.4514811336994171
loss_pred:0.028299732133746147, decouple_loss:0.011352536268532276
The modified gen p mean: 0.45241332054138184, gen p mean: -0.709013819694519, mean p set: 0.45289358496665955The modified gen p mean: 0.4513828754425049, gen p mean: -0.7164583802223206, mean p set: 0.4518631398677826
loss_pred:0.02688051387667656, decouple_loss:0.011154755018651485
loss_pred:0.028979213908314705, decouple_loss:0.012817982584238052
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
NaN value num: 0
Iteration: 1552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051509141921997, gen p mean: -0.699779748916626, mean p set: 0.45099538564682007
loss_pred:0.027451196685433388, decouple_loss:0.01267122570425272
The modified gen p mean: 0.4489710330963135, gen p mean: -0.7019057273864746, mean p set: 0.4494513273239136The modified gen p mean: 0.452470064163208, gen p mean: -0.704378068447113, mean p set: 0.4529503583908081
loss_pred:0.029741831123828888, decouple_loss:0.013409456238150597
loss_pred:0.028589211404323578, decouple_loss:0.012683380395174026
Iteration: 1553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506288766860962, gen p mean: -0.704015851020813, mean p set: 0.4511091411113739
The modified gen p mean: 0.44875380396842957, gen p mean: -0.7038078308105469, mean p set: 0.4492340683937073
loss_pred:0.02799008972942829, decouple_loss:0.012252912856638432
loss_pred:0.02990839257836342, decouple_loss:0.01248105801641941
The modified gen p mean: 0.4484437108039856, gen p mean: -0.6921733021736145, mean p set: 0.4489240050315857
loss_pred:0.028415421023964882, decouple_loss:0.01361804734915495
Iteration: 1554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449812114238739, gen p mean: -0.7076548933982849, mean p set: 0.4502924084663391
The modified gen p mean: 0.45023342967033386, gen p mean: -0.7047649025917053, mean p set: 0.45071372389793396
The modified gen p mean: 0.44902458786964417, gen p mean: -0.7029834985733032, mean p set: 0.4495048522949219
loss_pred:0.027679571881890297, decouple_loss:0.012405501678586006
loss_pred:0.027589190751314163, decouple_loss:0.012654919177293777
loss_pred:0.02959451824426651, decouple_loss:0.012788411229848862
Iteration: 1555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966378808021545, gen p mean: -0.7032678127288818, mean p set: 0.45014408230781555
The modified gen p mean: 0.4497763216495514, gen p mean: -0.7122478485107422, mean p set: 0.4502566158771515
The modified gen p mean: 0.4501833915710449, gen p mean: -0.7120577096939087, mean p set: 0.450663685798645loss_pred:0.02882249280810356, decouple_loss:0.0121192317456007loss_pred:0.029425032436847687, decouple_loss:0.01305337157100439
loss_pred:0.027220968157052994, decouple_loss:0.011551270261406898
Iteration: 1556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44875451922416687, gen p mean: -0.7048578262329102, mean p set: 0.4492347836494446
The modified gen p mean: 0.44761693477630615, gen p mean: -0.715941309928894, mean p set: 0.44809725880622864
loss_pred:0.028105778619647026, decouple_loss:0.012421352788805962
loss_pred:0.028567304834723473, decouple_loss:0.012268672697246075
The modified gen p mean: 0.45069873332977295, gen p mean: -0.7033640742301941, mean p set: 0.45117899775505066
loss_pred:0.027915293350815773, decouple_loss:0.012372022494673729
Iteration: 1557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523509740829468, gen p mean: -0.7149004340171814, mean p set: 0.4528312385082245
The modified gen p mean: 0.44789403676986694, gen p mean: -0.7249281406402588, mean p set: 0.44837433099746704
loss_pred:0.027188632637262344, decouple_loss:0.012224091216921806
loss_pred:0.028656745329499245, decouple_loss:0.012135634198784828
The modified gen p mean: 0.4522463381290436, gen p mean: -0.7174633741378784, mean p set: 0.4527266025543213
loss_pred:0.028905808925628662, decouple_loss:0.012364990077912807
Iteration: 1558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963744282722473, gen p mean: -0.7184585332870483, mean p set: 0.45011773705482483The modified gen p mean: 0.4490300416946411, gen p mean: -0.7098432183265686, mean p set: 0.4495103359222412
loss_pred:0.029403600841760635, decouple_loss:0.012345138005912304
loss_pred:0.030072102323174477, decouple_loss:0.012402244843542576
The modified gen p mean: 0.45149096846580505, gen p mean: -0.718779981136322, mean p set: 0.45197123289108276
loss_pred:0.029711997136473656, decouple_loss:0.012068434618413448
Iteration: 1559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484897255897522, gen p mean: -0.7047162652015686, mean p set: 0.4489700198173523
loss_pred:0.028391463682055473, decouple_loss:0.01184312254190445
The modified gen p mean: 0.4518488347530365, gen p mean: -0.715502142906189, mean p set: 0.4523291289806366The modified gen p mean: 0.4489746689796448, gen p mean: -0.7118090987205505, mean p set: 0.4494549334049225
loss_pred:0.027747830376029015, decouple_loss:0.011988471262156963
loss_pred:0.028926577419042587, decouple_loss:0.011572622694075108
Iteration: 1560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494486451148987, gen p mean: -0.7026042938232422, mean p set: 0.4499289393424988
The modified gen p mean: 0.450116902589798, gen p mean: -0.7035749554634094, mean p set: 0.45059719681739807
The modified gen p mean: 0.44898101687431335, gen p mean: -0.7039070129394531, mean p set: 0.4494612514972687
loss_pred:0.02862253226339817, decouple_loss:0.011514604091644287
loss_pred:0.02907080575823784, decouple_loss:0.011575071141123772
loss_pred:0.027370935305953026, decouple_loss:0.012102174572646618
2023-05-01 21:53:42 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7148568630218506, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7036027908325195, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7067899107933044, mean p set: 0.4500633478164673
loss_pred:0.029508598148822784, decouple_loss:0.013316821306943893
loss_pred:0.02804736979305744, decouple_loss:0.013065505772829056
loss_pred:0.0284518264234066, decouple_loss:0.013032200746238232
WV_0_PC_1_EH_0_PS_40_5, loss: 0.029326174408197403, avg_mse: 0.034364279359579086
current test mse: 0.034364
Iteration: 1561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510181248188019, gen p mean: -0.6997272372245789, mean p set: 0.45149844884872437
The modified gen p mean: 0.4509003162384033, gen p mean: -0.709664523601532, mean p set: 0.4513806104660034
loss_pred:0.027501370757818222, decouple_loss:0.011874467134475708
The modified gen p mean: 0.4482707977294922, gen p mean: -0.7067341804504395, mean p set: 0.4487510621547699
loss_pred:0.027932755649089813, decouple_loss:0.012081502936780453
loss_pred:0.029066940769553185, decouple_loss:0.011830245144665241
Iteration: 1562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494033455848694, gen p mean: -0.7115408778190613, mean p set: 0.4498836100101471
The modified gen p mean: 0.449733167886734, gen p mean: -0.7157816290855408, mean p set: 0.4502134323120117
loss_pred:0.02928241901099682, decouple_loss:0.011658205650746822
loss_pred:0.02791455388069153, decouple_loss:0.011767784133553505
The modified gen p mean: 0.448906809091568, gen p mean: -0.7199616432189941, mean p set: 0.4493871033191681
loss_pred:0.028201553970575333, decouple_loss:0.011650990694761276
Iteration: 1563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838157296180725, gen p mean: -0.7208688259124756, mean p set: 0.44886186718940735
The modified gen p mean: 0.45019152760505676, gen p mean: -0.7225863337516785, mean p set: 0.45067182183265686
loss_pred:0.028513282537460327, decouple_loss:0.011819601990282536
loss_pred:0.02766386605799198, decouple_loss:0.011738572269678116
The modified gen p mean: 0.45081618428230286, gen p mean: -0.7123622298240662, mean p set: 0.45129647850990295
loss_pred:0.0283115915954113, decouple_loss:0.01158254686743021
Iteration: 1564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500284194946289, gen p mean: -0.7241312861442566, mean p set: 0.450508713722229
The modified gen p mean: 0.45186713337898254, gen p mean: -0.7219229936599731, mean p set: 0.45234742760658264
loss_pred:0.02662602812051773, decouple_loss:0.011130143888294697
loss_pred:0.027263754978775978, decouple_loss:0.01150741521269083
The modified gen p mean: 0.4508686065673828, gen p mean: -0.715178906917572, mean p set: 0.4513488709926605
loss_pred:0.028243841603398323, decouple_loss:0.011337733827531338
Iteration: 1565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933462142944336, gen p mean: -0.7149409055709839, mean p set: 0.44981491565704346
loss_pred:0.029409363865852356, decouple_loss:0.01139228604733944
The modified gen p mean: 0.44825178384780884, gen p mean: -0.707040011882782, mean p set: 0.44873207807540894The modified gen p mean: 0.4490962028503418, gen p mean: -0.7162047624588013, mean p set: 0.4495765268802643
loss_pred:0.028034022077918053, decouple_loss:0.012149962596595287
loss_pred:0.028633009642362595, decouple_loss:0.011494112201035023
Iteration: 1566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45175960659980774, gen p mean: -0.7093082070350647, mean p set: 0.45223987102508545
loss_pred:0.027072248980402946, decouple_loss:0.011295397765934467
The modified gen p mean: 0.4490003287792206, gen p mean: -0.7146275639533997, mean p set: 0.44948065280914307The modified gen p mean: 0.4495542049407959, gen p mean: -0.7118231654167175, mean p set: 0.4500344693660736
loss_pred:0.028499653562903404, decouple_loss:0.01130201481282711
loss_pred:0.02934252843260765, decouple_loss:0.011558517813682556
Iteration: 1567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449428915977478, gen p mean: -0.7108304500579834, mean p set: 0.4499092102050781
loss_pred:0.026959914714097977, decouple_loss:0.011239694431424141
The modified gen p mean: 0.4490131735801697, gen p mean: -0.7090402841567993, mean p set: 0.4494934380054474The modified gen p mean: 0.44990232586860657, gen p mean: -0.7052533626556396, mean p set: 0.45038262009620667
loss_pred:0.027839263901114464, decouple_loss:0.011173543520271778
loss_pred:0.028295135125517845, decouple_loss:0.011415913701057434
Iteration: 1568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969621300697327, gen p mean: -0.7048320174217224, mean p set: 0.45017653703689575
loss_pred:0.02872833050787449, decouple_loss:0.011618290096521378
The modified gen p mean: 0.44906073808670044, gen p mean: -0.7103379964828491, mean p set: 0.44954103231430054The modified gen p mean: 0.44946563243865967, gen p mean: -0.7085002064704895, mean p set: 0.4499458968639374
loss_pred:0.02876407466828823, decouple_loss:0.01090469490736723
loss_pred:0.028179923072457314, decouple_loss:0.011849350295960903
Iteration: 1569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490867257118225, gen p mean: -0.7160714864730835, mean p set: 0.449567049741745
loss_pred:0.029251595959067345, decouple_loss:0.011203883215785027
The modified gen p mean: 0.4502730667591095, gen p mean: -0.7136979103088379, mean p set: 0.4507533609867096The modified gen p mean: 0.4483394920825958, gen p mean: -0.7152289152145386, mean p set: 0.4488198161125183
loss_pred:0.02731907181441784, decouple_loss:0.010976013727486134
loss_pred:0.030013052746653557, decouple_loss:0.011111736297607422
Iteration: 1570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513009190559387, gen p mean: -0.7180491089820862, mean p set: 0.4517812132835388
loss_pred:0.02839852124452591, decouple_loss:0.011421202681958675
The modified gen p mean: 0.4486936330795288, gen p mean: -0.7213813066482544, mean p set: 0.4491738975048065The modified gen p mean: 0.44814273715019226, gen p mean: -0.730812132358551, mean p set: 0.44862303137779236
loss_pred:0.029727907851338387, decouple_loss:0.010991825722157955
loss_pred:0.028171809390187263, decouple_loss:0.010968687012791634
2023-05-01 21:55:51 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7384324073791504, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7270162105560303, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7304353713989258, mean p set: 0.4500633478164673
loss_pred:0.02944524772465229, decouple_loss:0.012658673338592052
loss_pred:0.027862198650836945, decouple_loss:0.012568360194563866
loss_pred:0.028345400467514992, decouple_loss:0.012328867800533772
WV_0_PC_1_EH_0_PS_40_5, loss: 0.029176881536841393, avg_mse: 0.03419678658246994
current test mse: 0.034197
Iteration: 1571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812560081481934, gen p mean: -0.7378759980201721, mean p set: 0.44860586524009705
The modified gen p mean: 0.44875484704971313, gen p mean: -0.7191019058227539, mean p set: 0.44923514127731323
loss_pred:0.0292518250644207, decouple_loss:0.011461322195827961
The modified gen p mean: 0.4493236839771271, gen p mean: -0.726980447769165, mean p set: 0.4498039484024048
loss_pred:0.029544398188591003, decouple_loss:0.011390665546059608
loss_pred:0.028690632432699203, decouple_loss:0.010969715192914009
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
NaN value num: 0
Iteration: 1572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494178593158722, gen p mean: -0.7250170111656189, mean p set: 0.4498981535434723
loss_pred:0.027589023113250732, decouple_loss:0.012802138924598694
The modified gen p mean: 0.4518880248069763, gen p mean: -0.7288720607757568, mean p set: 0.45236828923225403The modified gen p mean: 0.4499053657054901, gen p mean: -0.7185989022254944, mean p set: 0.4503856897354126
loss_pred:0.030814239755272865, decouple_loss:0.013911111280322075
loss_pred:0.028826860710978508, decouple_loss:0.01302754133939743
Iteration: 1573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519680440425873, gen p mean: -0.7151086330413818, mean p set: 0.4524483382701874
loss_pred:0.029597705230116844, decouple_loss:0.012938415631651878
The modified gen p mean: 0.45307883620262146, gen p mean: -0.7255281805992126, mean p set: 0.45355916023254395
The modified gen p mean: 0.45069777965545654, gen p mean: -0.7099710702896118, mean p set: 0.45117807388305664
loss_pred:0.028710579499602318, decouple_loss:0.01312911044806242
loss_pred:0.028864694759249687, decouple_loss:0.012184305116534233
Iteration: 1574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45256802439689636, gen p mean: -0.7292551398277283, mean p set: 0.45304831862449646
The modified gen p mean: 0.45106908679008484, gen p mean: -0.7235596776008606, mean p set: 0.4515494108200073
loss_pred:0.028695441782474518, decouple_loss:0.013177766464650631
loss_pred:0.027406468987464905, decouple_loss:0.012723744846880436
The modified gen p mean: 0.45245257019996643, gen p mean: -0.7273281812667847, mean p set: 0.45293283462524414
loss_pred:0.028353122994303703, decouple_loss:0.012876401655375957
Iteration: 1575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45115208625793457, gen p mean: -0.7194137573242188, mean p set: 0.4516323506832123
The modified gen p mean: 0.4507061243057251, gen p mean: -0.7277103066444397, mean p set: 0.4511864483356476
loss_pred:0.028156599029898643, decouple_loss:0.013226751238107681
loss_pred:0.028163934126496315, decouple_loss:0.012734058313071728
The modified gen p mean: 0.45162835717201233, gen p mean: -0.727910041809082, mean p set: 0.45210859179496765
loss_pred:0.0282442606985569, decouple_loss:0.012702584266662598
Iteration: 1576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520045518875122, gen p mean: -0.7222176194190979, mean p set: 0.4524848163127899
loss_pred:0.027725720778107643, decouple_loss:0.013367599807679653
The modified gen p mean: 0.4483846127986908, gen p mean: -0.718804121017456, mean p set: 0.4488649070262909The modified gen p mean: 0.4501095116138458, gen p mean: -0.7340932488441467, mean p set: 0.4505898058414459
loss_pred:0.02834324911236763, decouple_loss:0.01311795599758625
loss_pred:0.027892086654901505, decouple_loss:0.012829133309423923
Iteration: 1577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511569142341614, gen p mean: -0.7298586964607239, mean p set: 0.45163723826408386
The modified gen p mean: 0.4502854347229004, gen p mean: -0.7326712608337402, mean p set: 0.4507656991481781
loss_pred:0.0281051117926836, decouple_loss:0.012407239526510239
loss_pred:0.02873264066874981, decouple_loss:0.012976586818695068
The modified gen p mean: 0.4514698088169098, gen p mean: -0.721625030040741, mean p set: 0.4519501030445099
loss_pred:0.027350718155503273, decouple_loss:0.012667304836213589
Iteration: 1578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45078417658805847, gen p mean: -0.7141900062561035, mean p set: 0.45126447081565857
loss_pred:0.028103847056627274, decouple_loss:0.01247696578502655
The modified gen p mean: 0.4519338011741638, gen p mean: -0.7157057523727417, mean p set: 0.4524140954017639The modified gen p mean: 0.45340850949287415, gen p mean: -0.7314673662185669, mean p set: 0.45388877391815186
loss_pred:0.02813163958489895, decouple_loss:0.013124433346092701
loss_pred:0.027945157140493393, decouple_loss:0.012943858280777931
Iteration: 1579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496452510356903, gen p mean: -0.7104160189628601, mean p set: 0.4501255452632904
loss_pred:0.027103567495942116, decouple_loss:0.012366507202386856
The modified gen p mean: 0.44933655858039856, gen p mean: -0.7111737728118896, mean p set: 0.44981685280799866The modified gen p mean: 0.4506705701351166, gen p mean: -0.7120631337165833, mean p set: 0.4511508643627167
loss_pred:0.026873663067817688, decouple_loss:0.012259816750884056
loss_pred:0.027809733524918556, decouple_loss:0.01275561936199665
Iteration: 1580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097991824150085, gen p mean: -0.7040270566940308, mean p set: 0.45146021246910095
loss_pred:0.028020337224006653, decouple_loss:0.012084861285984516
The modified gen p mean: 0.45125114917755127, gen p mean: -0.7223984599113464, mean p set: 0.451731413602829The modified gen p mean: 0.45034295320510864, gen p mean: -0.7103756666183472, mean p set: 0.45082327723503113
loss_pred:0.02994440123438835, decouple_loss:0.013165708631277084
loss_pred:0.02802320383489132, decouple_loss:0.012069444172084332
2023-05-01 21:58:37 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7260504364967346, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7178535461425781, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7145530581474304, mean p set: 0.45035696029663086
loss_pred:0.02933415025472641, decouple_loss:0.01305866427719593
loss_pred:0.02832707017660141, decouple_loss:0.012743109837174416
loss_pred:0.0277459267526865, decouple_loss:0.01324544008821249
WV_0_PC_1_EH_0_PS_40_5, loss: 0.029119834303855896, avg_mse: 0.03408226743340492
current test mse: 0.034082
Iteration: 1581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514826536178589, gen p mean: -0.7130964994430542, mean p set: 0.4519629180431366
loss_pred:0.027195893228054047, decouple_loss:0.012059938162565231
The modified gen p mean: 0.45144620537757874, gen p mean: -0.7319839000701904, mean p set: 0.4519265294075012The modified gen p mean: 0.4503227770328522, gen p mean: -0.714282751083374, mean p set: 0.45080307126045227
loss_pred:0.027757124975323677, decouple_loss:0.011754481121897697
loss_pred:0.02858002856373787, decouple_loss:0.012676582671701908
Iteration: 1582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071613788604736, gen p mean: -0.7317245602607727, mean p set: 0.4511964023113251
loss_pred:0.027495505288243294, decouple_loss:0.01198174525052309
The modified gen p mean: 0.4513959586620331, gen p mean: -0.7175416350364685, mean p set: 0.45187628269195557The modified gen p mean: 0.45151910185813904, gen p mean: -0.7311539649963379, mean p set: 0.45199936628341675
loss_pred:0.027798498049378395, decouple_loss:0.012768055312335491
loss_pred:0.02904645912349224, decouple_loss:0.012177697382867336
Iteration: 1583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503142237663269, gen p mean: -0.7159621119499207, mean p set: 0.450794517993927
loss_pred:0.02771293744444847, decouple_loss:0.012157115153968334
The modified gen p mean: 0.44991496205329895, gen p mean: -0.7204863429069519, mean p set: 0.45039525628089905The modified gen p mean: 0.45080244541168213, gen p mean: -0.7197657227516174, mean p set: 0.4512827396392822
loss_pred:0.028386235237121582, decouple_loss:0.011413849890232086
loss_pred:0.028348075225949287, decouple_loss:0.011449628509581089
Iteration: 1584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495601952075958, gen p mean: -0.7119930386543274, mean p set: 0.45004045963287354
loss_pred:0.02782369963824749, decouple_loss:0.011147578246891499
The modified gen p mean: 0.45242762565612793, gen p mean: -0.7266736626625061, mean p set: 0.452907919883728The modified gen p mean: 0.45052945613861084, gen p mean: -0.7143505215644836, mean p set: 0.4510097801685333
loss_pred:0.027717484161257744, decouple_loss:0.011289836838841438
loss_pred:0.02836490049958229, decouple_loss:0.012043721042573452
Iteration: 1585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912317395210266, gen p mean: -0.7146885991096497, mean p set: 0.44960349798202515
loss_pred:0.02712482027709484, decouple_loss:0.010919793508946896
The modified gen p mean: 0.4498218894004822, gen p mean: -0.7114036679267883, mean p set: 0.4503021836280823The modified gen p mean: 0.450695276260376, gen p mean: -0.7154200077056885, mean p set: 0.45117560029029846
loss_pred:0.027582740411162376, decouple_loss:0.01084678154438734
loss_pred:0.02686910517513752, decouple_loss:0.010942795313894749
Iteration: 1586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451077401638031, gen p mean: -0.7261248230934143, mean p set: 0.4515576958656311
loss_pred:0.02794460766017437, decouple_loss:0.011532935313880444
The modified gen p mean: 0.45107385516166687, gen p mean: -0.7183826565742493, mean p set: 0.4515541195869446
The modified gen p mean: 0.45201241970062256, gen p mean: -0.7330123782157898, mean p set: 0.45249274373054504
loss_pred:0.027428291738033295, decouple_loss:0.011509870178997517
loss_pred:0.02868884801864624, decouple_loss:0.011926816776394844
Iteration: 1587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093315839767456, gen p mean: -0.7180042266845703, mean p set: 0.45141345262527466
loss_pred:0.02885269746184349, decouple_loss:0.011342289857566357
The modified gen p mean: 0.44851183891296387, gen p mean: -0.7194840312004089, mean p set: 0.44899213314056396The modified gen p mean: 0.4515998661518097, gen p mean: -0.7269622087478638, mean p set: 0.4520801901817322
loss_pred:0.02729332260787487, decouple_loss:0.012113550677895546
loss_pred:0.027753446251153946, decouple_loss:0.012338164262473583
Iteration: 1588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45130401849746704, gen p mean: -0.7316962480545044, mean p set: 0.4517843425273895
The modified gen p mean: 0.4516259729862213, gen p mean: -0.7176908850669861, mean p set: 0.452106237411499
loss_pred:0.030428560450673103, decouple_loss:0.01181271392852068
loss_pred:0.027279289439320564, decouple_loss:0.01175802294164896
The modified gen p mean: 0.4511418342590332, gen p mean: -0.7187148928642273, mean p set: 0.4516221284866333
loss_pred:0.027551166713237762, decouple_loss:0.011732473969459534
Iteration: 1589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45186030864715576, gen p mean: -0.7230010628700256, mean p set: 0.45234063267707825
loss_pred:0.028838714584708214, decouple_loss:0.011444131843745708
The modified gen p mean: 0.44942522048950195, gen p mean: -0.7204770445823669, mean p set: 0.44990551471710205The modified gen p mean: 0.4515032470226288, gen p mean: -0.7180541753768921, mean p set: 0.4519835412502289
loss_pred:0.027296794578433037, decouple_loss:0.011516200378537178
loss_pred:0.027123071253299713, decouple_loss:0.010304797440767288
Iteration: 1590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45090213418006897, gen p mean: -0.7189931273460388, mean p set: 0.45138245820999146
The modified gen p mean: 0.45360514521598816, gen p mean: -0.7315841317176819, mean p set: 0.45408543944358826
loss_pred:0.02796601876616478, decouple_loss:0.010844321921467781
loss_pred:0.02765730954706669, decouple_loss:0.01159921195358038
The modified gen p mean: 0.4512985348701477, gen p mean: -0.7160476446151733, mean p set: 0.4517787992954254
loss_pred:0.027477670460939407, decouple_loss:0.011081003583967686
2023-05-01 22:00:46 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7316073775291443, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7210155129432678, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7248499989509583, mean p set: 0.4500633478164673
loss_pred:0.02929169498383999, decouple_loss:0.01293147262185812
loss_pred:0.02774341031908989, decouple_loss:0.012894393876194954
loss_pred:0.028346944600343704, decouple_loss:0.012392585165798664
WV_0_PC_1_EH_0_PS_40_5, loss: 0.0290976595133543, avg_mse: 0.034095603972673416
current test mse: 0.034096
Iteration: 1591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512023627758026, gen p mean: -0.7149494886398315, mean p set: 0.4516826570034027
loss_pred:0.028746262192726135, decouple_loss:0.01074247807264328
The modified gen p mean: 0.45230787992477417, gen p mean: -0.7284095883369446, mean p set: 0.45278817415237427The modified gen p mean: 0.4505951404571533, gen p mean: -0.720852255821228, mean p set: 0.4510754346847534
loss_pred:0.026731502264738083, decouple_loss:0.01064632274210453
loss_pred:0.029881367459893227, decouple_loss:0.011300858110189438
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
NaN value num: 0
Iteration: 1592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502906799316406, gen p mean: -0.739590585231781, mean p set: 0.4507710039615631
loss_pred:0.029485050588846207, decouple_loss:0.01299817394465208
The modified gen p mean: 0.45039990544319153, gen p mean: -0.7228628993034363, mean p set: 0.45088016986846924The modified gen p mean: 0.4515528380870819, gen p mean: -0.7263113856315613, mean p set: 0.4520331025123596
loss_pred:0.028470519930124283, decouple_loss:0.012243830598890781
loss_pred:0.029908448457717896, decouple_loss:0.01217767596244812
Iteration: 1593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149075984954834, gen p mean: -0.7290728688240051, mean p set: 0.45197105407714844
loss_pred:0.028687797486782074, decouple_loss:0.012171031907200813
The modified gen p mean: 0.452442467212677, gen p mean: -0.7333675622940063, mean p set: 0.4529227614402771The modified gen p mean: 0.4512058198451996, gen p mean: -0.7345942854881287, mean p set: 0.4516860842704773
loss_pred:0.02886141836643219, decouple_loss:0.012031910009682178
loss_pred:0.0291125625371933, decouple_loss:0.011748923920094967
Iteration: 1594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513143002986908, gen p mean: -0.732231616973877, mean p set: 0.4517945945262909
loss_pred:0.02692798525094986, decouple_loss:0.011624708771705627
The modified gen p mean: 0.4507334530353546, gen p mean: -0.7254648804664612, mean p set: 0.4512137174606323The modified gen p mean: 0.45118051767349243, gen p mean: -0.728693425655365, mean p set: 0.45166081190109253
loss_pred:0.02654077857732773, decouple_loss:0.01224274467676878
loss_pred:0.028072107583284378, decouple_loss:0.011744110845029354
Iteration: 1595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174577832221985, gen p mean: -0.7195195555686951, mean p set: 0.45222604274749756
loss_pred:0.030592646449804306, decouple_loss:0.01227202545851469
The modified gen p mean: 0.4509027898311615, gen p mean: -0.7447605133056641, mean p set: 0.4513830542564392The modified gen p mean: 0.4510195255279541, gen p mean: -0.726385772228241, mean p set: 0.4514998197555542
loss_pred:0.029786499217152596, decouple_loss:0.012678639031946659
loss_pred:0.030629171058535576, decouple_loss:0.012107894755899906
Iteration: 1596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139768719673157, gen p mean: -0.71457439661026, mean p set: 0.45187801122665405
loss_pred:0.02960173785686493, decouple_loss:0.01251272950321436
The modified gen p mean: 0.4508022367954254, gen p mean: -0.7093607783317566, mean p set: 0.4512825310230255The modified gen p mean: 0.4509143531322479, gen p mean: -0.7161071300506592, mean p set: 0.4513946771621704
loss_pred:0.027684375643730164, decouple_loss:0.01220263447612524
loss_pred:0.028361603617668152, decouple_loss:0.011825292371213436
Iteration: 1597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45149365067481995, gen p mean: -0.7159684300422668, mean p set: 0.45197397470474243
The modified gen p mean: 0.45110514760017395, gen p mean: -0.7163811922073364, mean p set: 0.45158541202545166
loss_pred:0.026456808671355247, decouple_loss:0.0119469054043293
loss_pred:0.029278522357344627, decouple_loss:0.012133607640862465
The modified gen p mean: 0.45155471563339233, gen p mean: -0.7164605259895325, mean p set: 0.45203498005867004
loss_pred:0.029829571023583412, decouple_loss:0.012510338798165321
Iteration: 1598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506426155567169, gen p mean: -0.7180200815200806, mean p set: 0.4511229395866394
loss_pred:0.02869562990963459, decouple_loss:0.012158364988863468
The modified gen p mean: 0.4500422775745392, gen p mean: -0.7143988013267517, mean p set: 0.45052260160446167The modified gen p mean: 0.45097115635871887, gen p mean: -0.7134913206100464, mean p set: 0.45145145058631897
loss_pred:0.02838587574660778, decouple_loss:0.011891808360815048
loss_pred:0.02782398834824562, decouple_loss:0.012130307033658028
Iteration: 1599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45209985971450806, gen p mean: -0.7166308164596558, mean p set: 0.45258012413978577
loss_pred:0.029013192281126976, decouple_loss:0.01192259881645441
The modified gen p mean: 0.4509257674217224, gen p mean: -0.7115716934204102, mean p set: 0.4514060616493225The modified gen p mean: 0.4514378607273102, gen p mean: -0.7171519994735718, mean p set: 0.4519181549549103
loss_pred:0.02651761844754219, decouple_loss:0.012371858581900597
loss_pred:0.030180983245372772, decouple_loss:0.012785159051418304
Iteration: 1600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510059058666229, gen p mean: -0.7088088989257812, mean p set: 0.45148617029190063
loss_pred:0.027915753424167633, decouple_loss:0.012190617620944977
The modified gen p mean: 0.4515439569950104, gen p mean: -0.7063246965408325, mean p set: 0.4520242512226105The modified gen p mean: 0.4524074196815491, gen p mean: -0.7038925290107727, mean p set: 0.45288771390914917
loss_pred:0.027212532237172127, decouple_loss:0.011710219085216522
loss_pred:0.030313458293676376, decouple_loss:0.011999677866697311
2023-05-01 22:03:31 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7160964012145996, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.70582515001297, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830237865448, gen p mean: -0.7088585495948792, mean p set: 0.4500633478164673
loss_pred:0.029448367655277252, decouple_loss:0.013069206848740578
loss_pred:0.02791217528283596, decouple_loss:0.013058598153293133
loss_pred:0.028423257172107697, decouple_loss:0.012854068540036678
WV_0_PC_1_EH_0_PS_40_5, loss: 0.029244299978017807, avg_mse: 0.034265533089637756
current test mse: 0.034266
Iteration: 1601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45289456844329834, gen p mean: -0.7146828770637512, mean p set: 0.45337486267089844
The modified gen p mean: 0.4503636956214905, gen p mean: -0.7099941372871399, mean p set: 0.4508439898490906
loss_pred:0.026400944218039513, decouple_loss:0.011656161397695541
The modified gen p mean: 0.4505358338356018, gen p mean: -0.7157099843025208, mean p set: 0.4510160982608795
loss_pred:0.027602409943938255, decouple_loss:0.011544152162969112
loss_pred:0.02924603410065174, decouple_loss:0.011829020455479622
Iteration: 1602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451057106256485, gen p mean: -0.7111961245536804, mean p set: 0.4515374004840851
The modified gen p mean: 0.4523830711841583, gen p mean: -0.7059339880943298, mean p set: 0.4528633952140808
loss_pred:0.029517624527215958, decouple_loss:0.011790606193244457
loss_pred:0.028307266533374786, decouple_loss:0.011932392604649067
The modified gen p mean: 0.45221850275993347, gen p mean: -0.7175213098526001, mean p set: 0.45269879698753357
loss_pred:0.027365822345018387, decouple_loss:0.011619482189416885
Iteration: 1603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513819217681885, gen p mean: -0.7113035917282104, mean p set: 0.4518622159957886
The modified gen p mean: 0.45290446281433105, gen p mean: -0.7180572152137756, mean p set: 0.45338475704193115
loss_pred:0.028122710064053535, decouple_loss:0.011496592313051224
loss_pred:0.028846416622400284, decouple_loss:0.012104583904147148
The modified gen p mean: 0.4510725438594818, gen p mean: -0.7094257473945618, mean p set: 0.4515528082847595
loss_pred:0.030146585777401924, decouple_loss:0.011615201830863953
Iteration: 1604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191705226898193, gen p mean: -0.719293475151062, mean p set: 0.45239734649658203
The modified gen p mean: 0.4506296217441559, gen p mean: -0.7196453213691711, mean p set: 0.4511098861694336
loss_pred:0.027133852243423462, decouple_loss:0.011095399037003517
loss_pred:0.029763584956526756, decouple_loss:0.011744259856641293
The modified gen p mean: 0.45060819387435913, gen p mean: -0.7165990471839905, mean p set: 0.45108845829963684
loss_pred:0.027913106605410576, decouple_loss:0.011453644372522831
Iteration: 1605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511990249156952, gen p mean: -0.7208820581436157, mean p set: 0.4516793489456177
The modified gen p mean: 0.45230168104171753, gen p mean: -0.7210756540298462, mean p set: 0.45278200507164
loss_pred:0.029282469302415848, decouple_loss:0.011839080601930618
loss_pred:0.02799019031226635, decouple_loss:0.011325661092996597
The modified gen p mean: 0.45093539357185364, gen p mean: -0.7265003323554993, mean p set: 0.45141565799713135
loss_pred:0.0294694434851408, decouple_loss:0.0117243193089962
Iteration: 1606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527597725391388, gen p mean: -0.7292017340660095, mean p set: 0.4532400667667389
The modified gen p mean: 0.450927734375, gen p mean: -0.7240450978279114, mean p set: 0.4514080286026001
loss_pred:0.02997513674199581, decouple_loss:0.011873616836965084
loss_pred:0.02977377362549305, decouple_loss:0.012100481428205967
The modified gen p mean: 0.45191532373428345, gen p mean: -0.7353683114051819, mean p set: 0.45239561796188354
loss_pred:0.027583027258515358, decouple_loss:0.011833908036351204
Iteration: 1607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494110643863678, gen p mean: -0.7260721921920776, mean p set: 0.4498913586139679
The modified gen p mean: 0.4510226249694824, gen p mean: -0.7253322005271912, mean p set: 0.4515029489994049
loss_pred:0.02643612027168274, decouple_loss:0.011524457484483719
loss_pred:0.026664413511753082, decouple_loss:0.011261115781962872
The modified gen p mean: 0.45133134722709656, gen p mean: -0.7273497581481934, mean p set: 0.45181164145469666
loss_pred:0.02943333052098751, decouple_loss:0.011558905243873596
Iteration: 1608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45133718848228455, gen p mean: -0.715737521648407, mean p set: 0.45181748270988464
loss_pred:0.029581163078546524, decouple_loss:0.011284003965556622
The modified gen p mean: 0.45028239488601685, gen p mean: -0.7233041524887085, mean p set: 0.45076268911361694The modified gen p mean: 0.45057255029678345, gen p mean: -0.7161867618560791, mean p set: 0.45105281472206116
loss_pred:0.026327071711421013, decouple_loss:0.011511954478919506
loss_pred:0.029495079070329666, decouple_loss:0.011162408627569675
Iteration: 1609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518134891986847, gen p mean: -0.7238003015518188, mean p set: 0.4522937834262848
The modified gen p mean: 0.45106038451194763, gen p mean: -0.7416358590126038, mean p set: 0.45154067873954773
loss_pred:0.025989139452576637, decouple_loss:0.01137444656342268
loss_pred:0.029567088931798935, decouple_loss:0.012458233162760735
The modified gen p mean: 0.4512471556663513, gen p mean: -0.7361760139465332, mean p set: 0.45172742009162903
loss_pred:0.029048703610897064, decouple_loss:0.012857337482273579
Iteration: 1610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45116761326789856, gen p mean: -0.720089852809906, mean p set: 0.45164790749549866
The modified gen p mean: 0.4523986279964447, gen p mean: -0.7245506048202515, mean p set: 0.4528789222240448
loss_pred:0.02837655320763588, decouple_loss:0.011199205182492733
loss_pred:0.026980485767126083, decouple_loss:0.011029461398720741
The modified gen p mean: 0.4510252773761749, gen p mean: -0.7241754531860352, mean p set: 0.451505571603775
loss_pred:0.02787824720144272, decouple_loss:0.010998607613146305
2023-05-01 22:05:40 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7227256894111633, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.71226567029953, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.715301513671875, mean p set: 0.4500633478164673
loss_pred:0.02929713763296604, decouple_loss:0.012613881379365921
loss_pred:0.02777065336704254, decouple_loss:0.012532750144600868
loss_pred:0.02824309468269348, decouple_loss:0.012270021252334118
WV_0_PC_1_EH_0_PS_40_5, loss: 0.029060572385787964, avg_mse: 0.03405430167913437
current test mse: 0.034054
Iteration: 1611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163244009017944, gen p mean: -0.7175560593605042, mean p set: 0.45211273431777954
The modified gen p mean: 0.45126789808273315, gen p mean: -0.7179763913154602, mean p set: 0.45174819231033325
loss_pred:0.028923314064741135, decouple_loss:0.011850039474666119
The modified gen p mean: 0.45060622692108154, gen p mean: -0.7109158635139465, mean p set: 0.45108652114868164
loss_pred:0.02955852821469307, decouple_loss:0.011794732883572578
loss_pred:0.03002084791660309, decouple_loss:0.011972901411354542
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
NaN value num: 0
Iteration: 1612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842782616615295, gen p mean: -0.7171267867088318, mean p set: 0.44890812039375305
loss_pred:0.02832564152777195, decouple_loss:0.012275242246687412
The modified gen p mean: 0.44678249955177307, gen p mean: -0.7156600952148438, mean p set: 0.44726279377937317The modified gen p mean: 0.44650033116340637, gen p mean: -0.7165371179580688, mean p set: 0.44698062539100647
loss_pred:0.031179064884781837, decouple_loss:0.012469966895878315
loss_pred:0.030662886798381805, decouple_loss:0.011944890953600407
Iteration: 1613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609692692756653, gen p mean: -0.7239991426467896, mean p set: 0.446577250957489
The modified gen p mean: 0.44688671827316284, gen p mean: -0.7271538376808167, mean p set: 0.44736701250076294
loss_pred:0.02920350432395935, decouple_loss:0.012060549110174179
loss_pred:0.030011208727955818, decouple_loss:0.01166323758661747
The modified gen p mean: 0.4479660093784332, gen p mean: -0.7258373498916626, mean p set: 0.44844627380371094
loss_pred:0.029488716274499893, decouple_loss:0.012007312849164009
Iteration: 1614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471818208694458, gen p mean: -0.7356491088867188, mean p set: 0.4476620852947235
The modified gen p mean: 0.44580337405204773, gen p mean: -0.7373833060264587, mean p set: 0.44628363847732544
loss_pred:0.029542872682213783, decouple_loss:0.011829256080091
loss_pred:0.02935051918029785, decouple_loss:0.011914622038602829
The modified gen p mean: 0.4482758045196533, gen p mean: -0.7319462299346924, mean p set: 0.44875606894493103
loss_pred:0.029059428721666336, decouple_loss:0.011960310861468315
Iteration: 1615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769012928009033, gen p mean: -0.7323166728019714, mean p set: 0.44817039370536804
The modified gen p mean: 0.4476662278175354, gen p mean: -0.7304523587226868, mean p set: 0.4481465220451355
loss_pred:0.028668604791164398, decouple_loss:0.011611762456595898
loss_pred:0.029016491025686264, decouple_loss:0.011798307299613953
The modified gen p mean: 0.4462997615337372, gen p mean: -0.7350608110427856, mean p set: 0.4467800557613373
loss_pred:0.030272135511040688, decouple_loss:0.011184878647327423
Iteration: 1616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676363468170166, gen p mean: -0.7276676297187805, mean p set: 0.44724392890930176
The modified gen p mean: 0.44786548614501953, gen p mean: -0.7271410226821899, mean p set: 0.44834578037261963
loss_pred:0.0299157053232193, decouple_loss:0.01132782269269228
loss_pred:0.028878228738904, decouple_loss:0.011126927100121975
The modified gen p mean: 0.4494776129722595, gen p mean: -0.7313275933265686, mean p set: 0.449957937002182
loss_pred:0.02892814762890339, decouple_loss:0.01162478793412447
Iteration: 1617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702568650245667, gen p mean: -0.7185301780700684, mean p set: 0.4475059509277344
The modified gen p mean: 0.44664105772972107, gen p mean: -0.7227639555931091, mean p set: 0.44712138175964355
loss_pred:0.030034832656383514, decouple_loss:0.011581359431147575
loss_pred:0.03011881373822689, decouple_loss:0.011972361244261265
The modified gen p mean: 0.4465080201625824, gen p mean: -0.7237088680267334, mean p set: 0.4469883143901825
loss_pred:0.029893863946199417, decouple_loss:0.011351274326443672
Iteration: 1618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474196434020996, gen p mean: -0.7203041911125183, mean p set: 0.4478999078273773
The modified gen p mean: 0.44827449321746826, gen p mean: -0.7202003598213196, mean p set: 0.44875475764274597
loss_pred:0.029979314655065536, decouple_loss:0.011242303997278214
loss_pred:0.029148684814572334, decouple_loss:0.011448771692812443
The modified gen p mean: 0.44661030173301697, gen p mean: -0.7218927145004272, mean p set: 0.4470905661582947
loss_pred:0.0296684168279171, decouple_loss:0.011642560362815857
Iteration: 1619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472569227218628, gen p mean: -0.7337653636932373, mean p set: 0.4477372169494629The modified gen p mean: 0.4469072222709656, gen p mean: -0.7257495522499084, mean p set: 0.4473875164985657
loss_pred:0.029616376385092735, decouple_loss:0.01079016923904419
loss_pred:0.0307504553347826, decouple_loss:0.011460206471383572
The modified gen p mean: 0.4480510652065277, gen p mean: -0.7264418005943298, mean p set: 0.4485313296318054
loss_pred:0.028797166422009468, decouple_loss:0.011209817603230476
Iteration: 1620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779494404792786, gen p mean: -0.7251803278923035, mean p set: 0.44827520847320557
The modified gen p mean: 0.44708749651908875, gen p mean: -0.7249603271484375, mean p set: 0.44756776094436646
loss_pred:0.02989146299660206, decouple_loss:0.011340800672769547
loss_pred:0.029244299978017807, decouple_loss:0.01108090952038765
The modified gen p mean: 0.44656434655189514, gen p mean: -0.7294328212738037, mean p set: 0.44704464077949524
loss_pred:0.028641192242503166, decouple_loss:0.011515103280544281
2023-05-01 22:08:30 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7245336174964905, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.715148389339447, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.718080461025238, mean p set: 0.4500633478164673
loss_pred:0.029156338423490524, decouple_loss:0.01208139955997467
loss_pred:0.02778603881597519, decouple_loss:0.012235669419169426
loss_pred:0.02816821075975895, decouple_loss:0.01192699559032917
WV_0_PC_1_EH_0_PS_40_5, loss: 0.028974264860153198, avg_mse: 0.03401412069797516
current test mse: 0.034014
Iteration: 1621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856974482536316, gen p mean: -0.7202461361885071, mean p set: 0.44905006885528564
The modified gen p mean: 0.4475695490837097, gen p mean: -0.7182554602622986, mean p set: 0.4480498135089874
loss_pred:0.029155263677239418, decouple_loss:0.010892920196056366
The modified gen p mean: 0.4485849440097809, gen p mean: -0.7349246144294739, mean p set: 0.449065238237381
loss_pred:0.02986644022166729, decouple_loss:0.010967396199703217
loss_pred:0.029669566079974174, decouple_loss:0.012235823087394238
Iteration: 1622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477561116218567, gen p mean: -0.7309768795967102, mean p set: 0.4482364058494568
The modified gen p mean: 0.44708481431007385, gen p mean: -0.7274244427680969, mean p set: 0.44756510853767395
loss_pred:0.02894371561706066, decouple_loss:0.011476621963083744
loss_pred:0.028534362092614174, decouple_loss:0.011011776514351368
The modified gen p mean: 0.4476235508918762, gen p mean: -0.7149275541305542, mean p set: 0.44810381531715393
loss_pred:0.030034087598323822, decouple_loss:0.011084787547588348
Iteration: 1623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491763710975647, gen p mean: -0.7217263579368591, mean p set: 0.4496566355228424
The modified gen p mean: 0.4475669860839844, gen p mean: -0.7138381600379944, mean p set: 0.4480472505092621
loss_pred:0.030205173417925835, decouple_loss:0.01128319650888443
loss_pred:0.029310261830687523, decouple_loss:0.011904546059668064
The modified gen p mean: 0.448119193315506, gen p mean: -0.7295048236846924, mean p set: 0.4485994875431061
loss_pred:0.029032383114099503, decouple_loss:0.012206625193357468
Iteration: 1624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010483264923096, gen p mean: -0.7148448824882507, mean p set: 0.45058512687683105
The modified gen p mean: 0.44640520215034485, gen p mean: -0.7063435912132263, mean p set: 0.44688549637794495
loss_pred:0.028905950486660004, decouple_loss:0.01114234235137701
loss_pred:0.031102793291211128, decouple_loss:0.011281144805252552
The modified gen p mean: 0.4474089741706848, gen p mean: -0.7068445682525635, mean p set: 0.4478892683982849
loss_pred:0.028677301481366158, decouple_loss:0.011415992863476276
Iteration: 1625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471374452114105, gen p mean: -0.7059939503669739, mean p set: 0.4476177394390106
The modified gen p mean: 0.4472668468952179, gen p mean: -0.7177221775054932, mean p set: 0.447747141122818
loss_pred:0.029326800256967545, decouple_loss:0.011067317798733711
loss_pred:0.028695065528154373, decouple_loss:0.010820743627846241
The modified gen p mean: 0.4492040276527405, gen p mean: -0.7104208469390869, mean p set: 0.4496842920780182
loss_pred:0.028256338089704514, decouple_loss:0.01123420987278223
Iteration: 1626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468706250190735, gen p mean: -0.7099423408508301, mean p set: 0.4473509192466736
loss_pred:0.03003864921629429, decouple_loss:0.0110346470028162
The modified gen p mean: 0.4470927119255066, gen p mean: -0.7111449837684631, mean p set: 0.4475730061531067The modified gen p mean: 0.4482971429824829, gen p mean: -0.7099160552024841, mean p set: 0.4487774670124054
loss_pred:0.02910948172211647, decouple_loss:0.011033949442207813
loss_pred:0.028025096282362938, decouple_loss:0.011085646227002144
Iteration: 1627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863221049308777, gen p mean: -0.7205343842506409, mean p set: 0.4491124749183655
The modified gen p mean: 0.4480069875717163, gen p mean: -0.7178238034248352, mean p set: 0.44848722219467163
loss_pred:0.02909861132502556, decouple_loss:0.010745974257588387
loss_pred:0.028231458738446236, decouple_loss:0.01115785539150238
The modified gen p mean: 0.4465142488479614, gen p mean: -0.7234044075012207, mean p set: 0.4469945430755615
loss_pred:0.02959511987864971, decouple_loss:0.011319540441036224
Iteration: 1628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473632574081421, gen p mean: -0.7199142575263977, mean p set: 0.4478435218334198
The modified gen p mean: 0.4475644826889038, gen p mean: -0.7169235348701477, mean p set: 0.4480447769165039
loss_pred:0.02923264354467392, decouple_loss:0.010933936573565006
loss_pred:0.02852649800479412, decouple_loss:0.011318317614495754
The modified gen p mean: 0.4488506615161896, gen p mean: -0.7331129908561707, mean p set: 0.4493309259414673
loss_pred:0.028990063816308975, decouple_loss:0.011782459914684296
Iteration: 1629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741904735565186, gen p mean: -0.7132088541984558, mean p set: 0.44789931178092957
The modified gen p mean: 0.44672462344169617, gen p mean: -0.7167298197746277, mean p set: 0.44720491766929626
loss_pred:0.028600119054317474, decouple_loss:0.010702581144869328
loss_pred:0.030028047040104866, decouple_loss:0.010861697606742382
The modified gen p mean: 0.44692349433898926, gen p mean: -0.7233723998069763, mean p set: 0.44740378856658936
loss_pred:0.029040642082691193, decouple_loss:0.011087324470281601
Iteration: 1630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457154870033264, gen p mean: -0.7173082828521729, mean p set: 0.4461957514286041
The modified gen p mean: 0.44652819633483887, gen p mean: -0.7170149683952332, mean p set: 0.44700849056243896
loss_pred:0.028720252215862274, decouple_loss:0.01103940699249506
loss_pred:0.029387176036834717, decouple_loss:0.01108531653881073
The modified gen p mean: 0.4481431245803833, gen p mean: -0.7169539332389832, mean p set: 0.4486234486103058
loss_pred:0.028923844918608665, decouple_loss:0.011057648807764053
2023-05-01 22:10:39 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7256461977958679, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7167718410491943, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.719497799873352, mean p set: 0.4500633478164673
loss_pred:0.0291623305529356, decouple_loss:0.011737283319234848
loss_pred:0.02770744077861309, decouple_loss:0.01187099888920784
loss_pred:0.028160016983747482, decouple_loss:0.011561115272343159
WV_0_PC_1_EH_0_PS_40_5, loss: 0.028929419815540314, avg_mse: 0.033959247171878815
current test mse: 0.033959
Iteration: 1631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468685984611511, gen p mean: -0.7180892825126648, mean p set: 0.44734886288642883
The modified gen p mean: 0.44732263684272766, gen p mean: -0.7278193235397339, mean p set: 0.44780290126800537
loss_pred:0.02972385101020336, decouple_loss:0.01082268450409174
The modified gen p mean: 0.4484081268310547, gen p mean: -0.734370768070221, mean p set: 0.4488883912563324
loss_pred:0.029278447851538658, decouple_loss:0.010878284461796284
loss_pred:0.029295941814780235, decouple_loss:0.01148520689457655
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
NaN value num: 0
Iteration: 1632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001885294914246, gen p mean: -0.730973482131958, mean p set: 0.45049911737442017
loss_pred:0.027475915849208832, decouple_loss:0.011392736807465553
The modified gen p mean: 0.4513186514377594, gen p mean: -0.7259131073951721, mean p set: 0.4517989158630371The modified gen p mean: 0.45081081986427307, gen p mean: -0.721396267414093, mean p set: 0.45129111409187317
loss_pred:0.02760433591902256, decouple_loss:0.01167999766767025
loss_pred:0.028209619224071503, decouple_loss:0.011233612895011902
Iteration: 1633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45196688175201416, gen p mean: -0.7240151762962341, mean p set: 0.45244714617729187
The modified gen p mean: 0.45031237602233887, gen p mean: -0.7206064462661743, mean p set: 0.45079267024993896
loss_pred:0.02751985937356949, decouple_loss:0.01170579344034195
loss_pred:0.027674464508891106, decouple_loss:0.01113145612180233
The modified gen p mean: 0.4497041702270508, gen p mean: -0.7080520391464233, mean p set: 0.4501844644546509
loss_pred:0.028485007584095, decouple_loss:0.011589914560317993
Iteration: 1634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846609234809875, gen p mean: -0.7099974155426025, mean p set: 0.4489463269710541
The modified gen p mean: 0.4534832239151001, gen p mean: -0.7175627946853638, mean p set: 0.4539635181427002
loss_pred:0.027751760557293892, decouple_loss:0.01102569792419672
loss_pred:0.02725500799715519, decouple_loss:0.01189749501645565
The modified gen p mean: 0.4500791132450104, gen p mean: -0.7166728973388672, mean p set: 0.4505594074726105
loss_pred:0.026850152760744095, decouple_loss:0.010972846299409866
Iteration: 1635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511910676956177, gen p mean: -0.7026050686836243, mean p set: 0.4516713619232178
The modified gen p mean: 0.45285338163375854, gen p mean: -0.7093333005905151, mean p set: 0.45333370566368103
loss_pred:0.027819210663437843, decouple_loss:0.011425281874835491
loss_pred:0.028030483052134514, decouple_loss:0.010998236946761608
The modified gen p mean: 0.4523911774158478, gen p mean: -0.7072658538818359, mean p set: 0.4528714418411255
loss_pred:0.027537502348423004, decouple_loss:0.01127965934574604
Iteration: 1636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046982169151306, gen p mean: -0.6981000304222107, mean p set: 0.45095011591911316
The modified gen p mean: 0.4499392807483673, gen p mean: -0.6936753988265991, mean p set: 0.450419545173645
loss_pred:0.027813144028186798, decouple_loss:0.011337600648403168
loss_pred:0.029335835948586464, decouple_loss:0.011061899363994598
The modified gen p mean: 0.4534813463687897, gen p mean: -0.7081259489059448, mean p set: 0.4539616107940674
loss_pred:0.02879558503627777, decouple_loss:0.010988151654601097
Iteration: 1637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048457384109497, gen p mean: -0.699511706829071, mean p set: 0.45096486806869507
The modified gen p mean: 0.45149412751197815, gen p mean: -0.7123016119003296, mean p set: 0.45197439193725586
The modified gen p mean: 0.4498804211616516, gen p mean: -0.6948898434638977, mean p set: 0.4503606855869293
loss_pred:0.028608223423361778, decouple_loss:0.01137497741729021
loss_pred:0.027639251202344894, decouple_loss:0.011093023233115673loss_pred:0.028633447363972664, decouple_loss:0.01116652600467205
Iteration: 1638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45101702213287354, gen p mean: -0.71061772108078, mean p set: 0.45149728655815125
The modified gen p mean: 0.44948065280914307, gen p mean: -0.7187356352806091, mean p set: 0.44996097683906555
loss_pred:0.028785964474081993, decouple_loss:0.010563625022768974
loss_pred:0.027836250141263008, decouple_loss:0.010594885796308517
The modified gen p mean: 0.45448148250579834, gen p mean: -0.7174620628356934, mean p set: 0.45496177673339844
loss_pred:0.02763092704117298, decouple_loss:0.01142526138573885
Iteration: 1639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123252272605896, gen p mean: -0.7220779061317444, mean p set: 0.45171278715133667
The modified gen p mean: 0.4496087431907654, gen p mean: -0.7194139957427979, mean p set: 0.4500890374183655
loss_pred:0.02848132699728012, decouple_loss:0.010789657942950726
loss_pred:0.027919961139559746, decouple_loss:0.010497898794710636
The modified gen p mean: 0.4518858790397644, gen p mean: -0.7212408185005188, mean p set: 0.4523661732673645
loss_pred:0.028222626075148582, decouple_loss:0.010664043016731739
Iteration: 1640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45125314593315125, gen p mean: -0.7016138434410095, mean p set: 0.45173338055610657
The modified gen p mean: 0.45218247175216675, gen p mean: -0.7103981375694275, mean p set: 0.45266276597976685
loss_pred:0.027845103293657303, decouple_loss:0.01171317882835865
loss_pred:0.02737617865204811, decouple_loss:0.011559429578483105
The modified gen p mean: 0.45053309202194214, gen p mean: -0.7092716097831726, mean p set: 0.45101335644721985
loss_pred:0.028035761788487434, decouple_loss:0.01101694256067276
2023-05-01 22:13:24 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.715913712978363, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987669587135315, gen p mean: -0.7048200964927673, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7087476253509521, mean p set: 0.4500633478164673
loss_pred:0.029128670692443848, decouple_loss:0.012041334994137287
loss_pred:0.02778586931526661, decouple_loss:0.0122470548376441
loss_pred:0.028205977752804756, decouple_loss:0.011960587464272976
WV_0_PC_1_EH_0_PS_40_5, loss: 0.028977658599615097, avg_mse: 0.03405952453613281
current test mse: 0.03406
Iteration: 1641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45146387815475464, gen p mean: -0.7071250677108765, mean p set: 0.45194417238235474
The modified gen p mean: 0.4517892897129059, gen p mean: -0.711638331413269, mean p set: 0.452269583940506
loss_pred:0.026972495019435883, decouple_loss:0.01141150388866663
The modified gen p mean: 0.45176780223846436, gen p mean: -0.7147343158721924, mean p set: 0.45224812626838684
loss_pred:0.02754691243171692, decouple_loss:0.011042032390832901
loss_pred:0.02640353888273239, decouple_loss:0.010955478996038437
Iteration: 1642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451825886964798, gen p mean: -0.72157883644104, mean p set: 0.45230618119239807
The modified gen p mean: 0.45170649886131287, gen p mean: -0.7174336910247803, mean p set: 0.4521867632865906
loss_pred:0.028639310970902443, decouple_loss:0.01049040723592043
loss_pred:0.02713942714035511, decouple_loss:0.011123721487820148
The modified gen p mean: 0.45065465569496155, gen p mean: -0.7124907374382019, mean p set: 0.45113492012023926
loss_pred:0.02801826223731041, decouple_loss:0.010671509429812431
Iteration: 1643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939470291137695, gen p mean: -0.7216918468475342, mean p set: 0.44987502694129944
The modified gen p mean: 0.4509778320789337, gen p mean: -0.7114794850349426, mean p set: 0.4514580965042114
loss_pred:0.02761986292898655, decouple_loss:0.010546516627073288
loss_pred:0.027436792850494385, decouple_loss:0.011005369015038013
The modified gen p mean: 0.4502141773700714, gen p mean: -0.7263993620872498, mean p set: 0.4506944417953491
loss_pred:0.027771875262260437, decouple_loss:0.010866958647966385
Iteration: 1644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513162672519684, gen p mean: -0.7122812271118164, mean p set: 0.45179659128189087
The modified gen p mean: 0.4514771103858948, gen p mean: -0.7251349687576294, mean p set: 0.4519573748111725
loss_pred:0.028010323643684387, decouple_loss:0.01123405247926712
loss_pred:0.026647737249732018, decouple_loss:0.010509248822927475
The modified gen p mean: 0.4517209827899933, gen p mean: -0.7178053259849548, mean p set: 0.452201247215271
loss_pred:0.02829509787261486, decouple_loss:0.010696003213524818
Iteration: 1645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518057405948639, gen p mean: -0.7230894565582275, mean p set: 0.4522860050201416
The modified gen p mean: 0.4494204521179199, gen p mean: -0.7231245636940002, mean p set: 0.44990074634552
loss_pred:0.02670172229409218, decouple_loss:0.010988227091729641
loss_pred:0.027626128867268562, decouple_loss:0.010481189005076885
The modified gen p mean: 0.4503884017467499, gen p mean: -0.7184171080589294, mean p set: 0.45086869597435
loss_pred:0.02862064726650715, decouple_loss:0.010504171252250671
Iteration: 1646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45251893997192383, gen p mean: -0.7291901707649231, mean p set: 0.45299920439720154
The modified gen p mean: 0.45036688446998596, gen p mean: -0.7149200439453125, mean p set: 0.45084720849990845
loss_pred:0.027217987924814224, decouple_loss:0.01162960845977068
loss_pred:0.027582742273807526, decouple_loss:0.011208290234208107
The modified gen p mean: 0.4531993865966797, gen p mean: -0.7230438590049744, mean p set: 0.4536796808242798
loss_pred:0.02729611098766327, decouple_loss:0.011638674885034561
Iteration: 1647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516116976737976, gen p mean: -0.7268993854522705, mean p set: 0.4520919919013977
The modified gen p mean: 0.44957563281059265, gen p mean: -0.7220076322555542, mean p set: 0.45005589723587036
loss_pred:0.0269162617623806, decouple_loss:0.011211137287318707
loss_pred:0.02773457020521164, decouple_loss:0.01022693607956171
The modified gen p mean: 0.45008569955825806, gen p mean: -0.7117299437522888, mean p set: 0.45056599378585815
loss_pred:0.028991196304559708, decouple_loss:0.011238545179367065
Iteration: 1648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450823038816452, gen p mean: -0.7211112976074219, mean p set: 0.4513033628463745
The modified gen p mean: 0.4516301453113556, gen p mean: -0.7207289338111877, mean p set: 0.4521104097366333
loss_pred:0.02728990651667118, decouple_loss:0.010524052195250988
loss_pred:0.026285262778401375, decouple_loss:0.010065050795674324
The modified gen p mean: 0.4500962197780609, gen p mean: -0.7257051467895508, mean p set: 0.450576514005661
loss_pred:0.02697717398405075, decouple_loss:0.010705448687076569
Iteration: 1649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173612236976624, gen p mean: -0.7331175208091736, mean p set: 0.45221641659736633
The modified gen p mean: 0.451246976852417, gen p mean: -0.7221719026565552, mean p set: 0.4517273008823395
loss_pred:0.02716103568673134, decouple_loss:0.010206217877566814
loss_pred:0.027096200734376907, decouple_loss:0.010927518829703331
The modified gen p mean: 0.45516249537467957, gen p mean: -0.7320245504379272, mean p set: 0.45564278960227966
loss_pred:0.026707543060183525, decouple_loss:0.010910938493907452
Iteration: 1650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4545753002166748, gen p mean: -0.7335295677185059, mean p set: 0.4550555646419525
The modified gen p mean: 0.4501040279865265, gen p mean: -0.7167344093322754, mean p set: 0.4505843222141266
loss_pred:0.026529734954237938, decouple_loss:0.010999612510204315
loss_pred:0.02877386100590229, decouple_loss:0.01070271898061037
The modified gen p mean: 0.4515712857246399, gen p mean: -0.724958598613739, mean p set: 0.4520516097545624
loss_pred:0.02622012235224247, decouple_loss:0.010028205811977386
2023-05-01 22:15:33 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7315557599067688, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.723943293094635, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7200604677200317, mean p set: 0.45035696029663086
loss_pred:0.028989063575863838, decouple_loss:0.011817550286650658
loss_pred:0.027959374710917473, decouple_loss:0.011613553389906883
loss_pred:0.027598293498158455, decouple_loss:0.011922527104616165
WV_0_PC_1_EH_0_PS_40_5, loss: 0.028771471232175827, avg_mse: 0.033864010125398636
current test mse: 0.033864
Iteration: 1651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45197048783302307, gen p mean: -0.7319386005401611, mean p set: 0.45245081186294556
The modified gen p mean: 0.44842663407325745, gen p mean: -0.719377875328064, mean p set: 0.44890692830085754
loss_pred:0.027778571471571922, decouple_loss:0.010871846228837967
The modified gen p mean: 0.4530189633369446, gen p mean: -0.7313569784164429, mean p set: 0.4534992575645447
loss_pred:0.027384502813220024, decouple_loss:0.01049666665494442
loss_pred:0.02771746553480625, decouple_loss:0.010664399713277817
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
NaN value num: 0
Iteration: 1652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45282161235809326, gen p mean: -0.730671226978302, mean p set: 0.45330190658569336
loss_pred:0.02747456543147564, decouple_loss:0.010808303952217102
The modified gen p mean: 0.45217227935791016, gen p mean: -0.734455406665802, mean p set: 0.45265257358551025The modified gen p mean: 0.44918400049209595, gen p mean: -0.7197585701942444, mean p set: 0.44966429471969604
loss_pred:0.027765465900301933, decouple_loss:0.01151280477643013
loss_pred:0.029080046340823174, decouple_loss:0.010936844162642956
Iteration: 1653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007792115211487, gen p mean: -0.7174762487411499, mean p set: 0.4505581855773926The modified gen p mean: 0.4502222537994385, gen p mean: -0.7183117866516113, mean p set: 0.4507025480270386
loss_pred:0.028690297156572342, decouple_loss:0.011428052559494972loss_pred:0.027735276147723198, decouple_loss:0.011553359217941761
The modified gen p mean: 0.4498523473739624, gen p mean: -0.7286418676376343, mean p set: 0.4503326416015625
loss_pred:0.028948914259672165, decouple_loss:0.011086051352322102
Iteration: 1654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45171698927879333, gen p mean: -0.7387770414352417, mean p set: 0.45219725370407104
The modified gen p mean: 0.44949871301651, gen p mean: -0.71957927942276, mean p set: 0.4499790072441101
loss_pred:0.027571696788072586, decouple_loss:0.011275233700871468
loss_pred:0.02827744372189045, decouple_loss:0.01133009884506464
The modified gen p mean: 0.4506075978279114, gen p mean: -0.726520836353302, mean p set: 0.4510878920555115
loss_pred:0.029042992740869522, decouple_loss:0.011127065867185593
Iteration: 1655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45273956656455994, gen p mean: -0.7259970307350159, mean p set: 0.4532198905944824
The modified gen p mean: 0.4514254629611969, gen p mean: -0.7371764183044434, mean p set: 0.451905757188797
loss_pred:0.028176475316286087, decouple_loss:0.011350241489708424
loss_pred:0.0279953982681036, decouple_loss:0.010376163758337498
The modified gen p mean: 0.45297864079475403, gen p mean: -0.742806613445282, mean p set: 0.4534589648246765
loss_pred:0.027630342170596123, decouple_loss:0.011210968717932701
Iteration: 1656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449763685464859, gen p mean: -0.7341938018798828, mean p set: 0.4502440094947815
The modified gen p mean: 0.44984570145606995, gen p mean: -0.7219281196594238, mean p set: 0.45032599568367004
loss_pred:0.029346099123358727, decouple_loss:0.010813096538186073
loss_pred:0.027162916958332062, decouple_loss:0.010782693512737751
The modified gen p mean: 0.4511922597885132, gen p mean: -0.7315571308135986, mean p set: 0.4516725242137909
loss_pred:0.028322286903858185, decouple_loss:0.010650466196238995
Iteration: 1657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45271623134613037, gen p mean: -0.7181902527809143, mean p set: 0.4531964957714081
The modified gen p mean: 0.44953402876853943, gen p mean: -0.720270574092865, mean p set: 0.4500143229961395
loss_pred:0.028509875759482384, decouple_loss:0.011644501239061356
loss_pred:0.02825106494128704, decouple_loss:0.011522073298692703
The modified gen p mean: 0.44726434350013733, gen p mean: -0.7391853332519531, mean p set: 0.4477446675300598
loss_pred:0.027469465509057045, decouple_loss:0.011668368242681026
Iteration: 1658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496876001358032, gen p mean: -0.7204906344413757, mean p set: 0.45016786456108093
The modified gen p mean: 0.4491724371910095, gen p mean: -0.7102519869804382, mean p set: 0.4496527314186096
loss_pred:0.028897538781166077, decouple_loss:0.01066491100937128
loss_pred:0.027998849749565125, decouple_loss:0.010931691154837608
The modified gen p mean: 0.4488403797149658, gen p mean: -0.7313132882118225, mean p set: 0.4493206739425659
loss_pred:0.027503278106451035, decouple_loss:0.010670800693333149
Iteration: 1659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505919814109802, gen p mean: -0.7330569624900818, mean p set: 0.4510722756385803
loss_pred:0.02772287093102932, decouple_loss:0.010788694955408573
The modified gen p mean: 0.451625794172287, gen p mean: -0.7192332148551941, mean p set: 0.4521060883998871The modified gen p mean: 0.45256516337394714, gen p mean: -0.7171880006790161, mean p set: 0.45304545760154724
loss_pred:0.02774522453546524, decouple_loss:0.011180650442838669
loss_pred:0.028021173551678658, decouple_loss:0.011265245266258717
Iteration: 1660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45316675305366516, gen p mean: -0.7333716154098511, mean p set: 0.45364704728126526
The modified gen p mean: 0.44892454147338867, gen p mean: -0.7349768877029419, mean p set: 0.4494048058986664
loss_pred:0.0278935544192791, decouple_loss:0.011060435324907303
loss_pred:0.027122732251882553, decouple_loss:0.01068846695125103
The modified gen p mean: 0.44970133900642395, gen p mean: -0.7146834135055542, mean p set: 0.45018163323402405
loss_pred:0.027735868468880653, decouple_loss:0.011175282299518585
2023-05-01 22:18:17 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.733850359916687, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7225668430328369, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7263159155845642, mean p set: 0.4500633478164673
loss_pred:0.029517199844121933, decouple_loss:0.011854062788188457
loss_pred:0.027898870408535004, decouple_loss:0.011968419887125492
loss_pred:0.028307566419243813, decouple_loss:0.011872128583490849
WV_0_PC_1_EH_0_PS_40_5, loss: 0.02916945517063141, avg_mse: 0.03428984060883522
current test mse: 0.03429
Iteration: 1661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530010521411896, gen p mean: -0.7217797636985779, mean p set: 0.4534813165664673
The modified gen p mean: 0.4496883451938629, gen p mean: -0.7178619503974915, mean p set: 0.4501686692237854
loss_pred:0.028483988717198372, decouple_loss:0.011542003601789474
The modified gen p mean: 0.44873303174972534, gen p mean: -0.7218197584152222, mean p set: 0.44921332597732544
loss_pred:0.0280544962733984, decouple_loss:0.010668502189218998
loss_pred:0.028673622757196426, decouple_loss:0.011088784784078598
Iteration: 1662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997432827949524, gen p mean: -0.7203916907310486, mean p set: 0.45045459270477295
The modified gen p mean: 0.45039212703704834, gen p mean: -0.7150455117225647, mean p set: 0.45087239146232605
loss_pred:0.02712174504995346, decouple_loss:0.010067850351333618
loss_pred:0.028014184907078743, decouple_loss:0.01023109070956707
The modified gen p mean: 0.45304596424102783, gen p mean: -0.7257140874862671, mean p set: 0.45352625846862793
loss_pred:0.027872269973158836, decouple_loss:0.011154728010296822
Iteration: 1663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523540735244751, gen p mean: -0.7213391661643982, mean p set: 0.4528343677520752
loss_pred:0.027733150869607925, decouple_loss:0.011201630346477032
The modified gen p mean: 0.4515535533428192, gen p mean: -0.7218274474143982, mean p set: 0.4520338773727417The modified gen p mean: 0.4507034122943878, gen p mean: -0.7096362709999084, mean p set: 0.4511836767196655
loss_pred:0.028597205877304077, decouple_loss:0.011249260045588017
loss_pred:0.027994224801659584, decouple_loss:0.011231476441025734
Iteration: 1664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048776268959045, gen p mean: -0.7139027714729309, mean p set: 0.45096808671951294
The modified gen p mean: 0.44876691699028015, gen p mean: -0.7115187644958496, mean p set: 0.44924721121788025
loss_pred:0.027570562437176704, decouple_loss:0.010794143192470074
loss_pred:0.028079813346266747, decouple_loss:0.010905750095844269
The modified gen p mean: 0.4500858783721924, gen p mean: -0.7091220617294312, mean p set: 0.4505661725997925
loss_pred:0.02687072567641735, decouple_loss:0.010653440840542316
Iteration: 1665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492345154285431, gen p mean: -0.7093459963798523, mean p set: 0.4497148096561432
The modified gen p mean: 0.44980499148368835, gen p mean: -0.7085345983505249, mean p set: 0.45028528571128845
loss_pred:0.028081586584448814, decouple_loss:0.010772211477160454
loss_pred:0.027251092717051506, decouple_loss:0.010582736693322659
The modified gen p mean: 0.4489035904407501, gen p mean: -0.7131984829902649, mean p set: 0.4493838846683502
loss_pred:0.02833859808743, decouple_loss:0.011238882318139076
Iteration: 1666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992244243621826, gen p mean: -0.7075735926628113, mean p set: 0.45040273666381836
The modified gen p mean: 0.4501268267631531, gen p mean: -0.7159453630447388, mean p set: 0.4506070911884308
loss_pred:0.028376474976539612, decouple_loss:0.010463234968483448
loss_pred:0.028701316565275192, decouple_loss:0.010927297174930573
The modified gen p mean: 0.4526509642601013, gen p mean: -0.7098329067230225, mean p set: 0.4531312584877014
loss_pred:0.028347859159111977, decouple_loss:0.011171575635671616
Iteration: 1667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512633979320526, gen p mean: -0.7047539353370667, mean p set: 0.4517436623573303
The modified gen p mean: 0.4503084123134613, gen p mean: -0.7114455103874207, mean p set: 0.4507887363433838
loss_pred:0.028342751786112785, decouple_loss:0.011361864395439625
loss_pred:0.026828663423657417, decouple_loss:0.010315055027604103
The modified gen p mean: 0.44933873414993286, gen p mean: -0.7211427092552185, mean p set: 0.44981902837753296
loss_pred:0.027438359335064888, decouple_loss:0.010995978489518166
Iteration: 1668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497276842594147, gen p mean: -0.7113508582115173, mean p set: 0.45020797848701477
The modified gen p mean: 0.44972240924835205, gen p mean: -0.7034953236579895, mean p set: 0.45020267367362976
loss_pred:0.028325282037258148, decouple_loss:0.01058968435972929
loss_pred:0.0291752927005291, decouple_loss:0.010665817186236382
The modified gen p mean: 0.4535812437534332, gen p mean: -0.7154740691184998, mean p set: 0.45406150817871094
loss_pred:0.027008092030882835, decouple_loss:0.010702449828386307
Iteration: 1669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495389461517334, gen p mean: -0.7026879191398621, mean p set: 0.4500192403793335
The modified gen p mean: 0.4498113691806793, gen p mean: -0.7051727175712585, mean p set: 0.4502916932106018
loss_pred:0.02842629700899124, decouple_loss:0.009978747926652431
loss_pred:0.02869713120162487, decouple_loss:0.010636183433234692
The modified gen p mean: 0.44934505224227905, gen p mean: -0.6999709010124207, mean p set: 0.44982537627220154
loss_pred:0.02812725119292736, decouple_loss:0.010729502886533737
Iteration: 1670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501339793205261, gen p mean: -0.7028067111968994, mean p set: 0.45061424374580383
The modified gen p mean: 0.44855958223342896, gen p mean: -0.7212886214256287, mean p set: 0.44903984665870667
loss_pred:0.02716449648141861, decouple_loss:0.01015265192836523
loss_pred:0.02741563692688942, decouple_loss:0.010690171271562576
The modified gen p mean: 0.44983574748039246, gen p mean: -0.7007243037223816, mean p set: 0.45031604170799255
loss_pred:0.028590543195605278, decouple_loss:0.010544159449636936
2023-05-01 22:20:25 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7185651063919067, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7081397771835327, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7111263275146484, mean p set: 0.4500633478164673
loss_pred:0.029232099652290344, decouple_loss:0.011646193452179432
loss_pred:0.027639640495181084, decouple_loss:0.011646735481917858
loss_pred:0.027990011498332024, decouple_loss:0.01152579765766859
WV_0_PC_1_EH_0_PS_40_5, loss: 0.028867563232779503, avg_mse: 0.03390473127365112
current test mse: 0.033905
Iteration: 1671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846272468566895, gen p mean: -0.7203140258789062, mean p set: 0.44894298911094666
The modified gen p mean: 0.4502153694629669, gen p mean: -0.7018798589706421, mean p set: 0.450695663690567
loss_pred:0.02826874703168869, decouple_loss:0.01023164764046669
The modified gen p mean: 0.44869181513786316, gen p mean: -0.7150194644927979, mean p set: 0.44917213916778564
loss_pred:0.026661869138479233, decouple_loss:0.010533679276704788
loss_pred:0.027473436668515205, decouple_loss:0.010280383750796318
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
NaN value num: 0
Iteration: 1672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468841552734375, gen p mean: -0.7096794247627258, mean p set: 0.44736447930336
loss_pred:0.029085826128721237, decouple_loss:0.011077110655605793
The modified gen p mean: 0.44805678725242615, gen p mean: -0.7166391611099243, mean p set: 0.44853708148002625The modified gen p mean: 0.44823142886161804, gen p mean: -0.7172086238861084, mean p set: 0.44871172308921814
loss_pred:0.029594803228974342, decouple_loss:0.011021357960999012
loss_pred:0.030001796782016754, decouple_loss:0.01127697341144085
Iteration: 1673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44754353165626526, gen p mean: -0.7200649976730347, mean p set: 0.44802385568618774
The modified gen p mean: 0.4483061730861664, gen p mean: -0.7235132455825806, mean p set: 0.4487864673137665loss_pred:0.029482677578926086, decouple_loss:0.011120138689875603
The modified gen p mean: 0.44782301783561707, gen p mean: -0.728508472442627, mean p set: 0.44830331206321716
loss_pred:0.028909608721733093, decouple_loss:0.010653115808963776
loss_pred:0.029613766819238663, decouple_loss:0.01181842666119337
Iteration: 1674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496183693408966, gen p mean: -0.7298616766929626, mean p set: 0.4500986337661743
The modified gen p mean: 0.4486355185508728, gen p mean: -0.7390931844711304, mean p set: 0.4491157829761505
loss_pred:0.028209242969751358, decouple_loss:0.010746819898486137
loss_pred:0.027408821508288383, decouple_loss:0.011312741786241531
The modified gen p mean: 0.44802042841911316, gen p mean: -0.7323846817016602, mean p set: 0.44850072264671326
loss_pred:0.028963258489966393, decouple_loss:0.010430112481117249
Iteration: 1675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487382471561432, gen p mean: -0.7341697216033936, mean p set: 0.4492185115814209
The modified gen p mean: 0.4483759105205536, gen p mean: -0.7346961498260498, mean p set: 0.4488562047481537
loss_pred:0.028375981375575066, decouple_loss:0.01136197429150343
loss_pred:0.02916788123548031, decouple_loss:0.010556137189269066
The modified gen p mean: 0.4476093649864197, gen p mean: -0.7341156601905823, mean p set: 0.4480896592140198
loss_pred:0.029137561097741127, decouple_loss:0.010929448530077934
Iteration: 1676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482074975967407, gen p mean: -0.7310722470283508, mean p set: 0.4486878216266632
loss_pred:0.02905789390206337, decouple_loss:0.011337409727275372
The modified gen p mean: 0.44801104068756104, gen p mean: -0.7334360480308533, mean p set: 0.44849133491516113
The modified gen p mean: 0.4486146867275238, gen p mean: -0.7269229888916016, mean p set: 0.4490949809551239
loss_pred:0.028882227838039398, decouple_loss:0.010630598291754723
loss_pred:0.027404405176639557, decouple_loss:0.011426334269344807
Iteration: 1677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767630100250244, gen p mean: -0.7284970879554749, mean p set: 0.44815659523010254
The modified gen p mean: 0.44844934344291687, gen p mean: -0.7254766821861267, mean p set: 0.44892963767051697
loss_pred:0.02920808270573616, decouple_loss:0.010747227817773819
loss_pred:0.02944466471672058, decouple_loss:0.011103667318820953
The modified gen p mean: 0.4494318962097168, gen p mean: -0.7275543212890625, mean p set: 0.4499121904373169
loss_pred:0.02820294164121151, decouple_loss:0.011151939630508423
Iteration: 1678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792941212654114, gen p mean: -0.7162588834762573, mean p set: 0.44840967655181885
The modified gen p mean: 0.44861719012260437, gen p mean: -0.7229952216148376, mean p set: 0.44909751415252686
loss_pred:0.027594348415732384, decouple_loss:0.01102229580283165
loss_pred:0.02896696701645851, decouple_loss:0.010710200294852257
The modified gen p mean: 0.44883784651756287, gen p mean: -0.7244483828544617, mean p set: 0.44931817054748535
loss_pred:0.028731774538755417, decouple_loss:0.0106471236795187
Iteration: 1679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449124813079834, gen p mean: -0.7287120223045349, mean p set: 0.4496051073074341
The modified gen p mean: 0.44803911447525024, gen p mean: -0.7267268896102905, mean p set: 0.44851937890052795
loss_pred:0.02759893238544464, decouple_loss:0.010578489862382412
loss_pred:0.02924412488937378, decouple_loss:0.011096414178609848
The modified gen p mean: 0.4492662847042084, gen p mean: -0.723583996295929, mean p set: 0.44974657893180847
loss_pred:0.029112333431839943, decouple_loss:0.011099845170974731
Iteration: 1680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447353333234787, gen p mean: -0.7248201966285706, mean p set: 0.4478336274623871
loss_pred:0.02960791252553463, decouple_loss:0.01096470095217228
The modified gen p mean: 0.4497392177581787, gen p mean: -0.7305076718330383, mean p set: 0.4502195119857788The modified gen p mean: 0.4481610059738159, gen p mean: -0.733688473701477, mean p set: 0.448641300201416
loss_pred:0.0274684876203537, decouple_loss:0.010860927402973175
loss_pred:0.02760401740670204, decouple_loss:0.011152374558150768
2023-05-01 22:23:10 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7266572713851929, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7166218757629395, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7198668122291565, mean p set: 0.4500633478164673
loss_pred:0.028906360268592834, decouple_loss:0.011368202976882458
loss_pred:0.027401352301239967, decouple_loss:0.011376405134797096
loss_pred:0.02779427357017994, decouple_loss:0.011193279176950455
WV_0_PC_1_EH_0_PS_40_5, loss: 0.028599627315998077, avg_mse: 0.033692482858896255
current test mse: 0.033692
Iteration: 1681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791701436042786, gen p mean: -0.7203970551490784, mean p set: 0.44839733839035034
The modified gen p mean: 0.4480516016483307, gen p mean: -0.7157840728759766, mean p set: 0.4485318660736084
loss_pred:0.02781262807548046, decouple_loss:0.011062980629503727
The modified gen p mean: 0.4480273425579071, gen p mean: -0.723845899105072, mean p set: 0.4485076069831848
loss_pred:0.028773145750164986, decouple_loss:0.011020269244909286
loss_pred:0.029348859563469887, decouple_loss:0.010456109419465065
Iteration: 1682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992712140083313, gen p mean: -0.7291877269744873, mean p set: 0.4504074156284332
The modified gen p mean: 0.448249876499176, gen p mean: -0.7221249341964722, mean p set: 0.4487301707267761
loss_pred:0.02786031924188137, decouple_loss:0.011311394162476063
loss_pred:0.028873102739453316, decouple_loss:0.010884958319365978
The modified gen p mean: 0.44786274433135986, gen p mean: -0.7250201106071472, mean p set: 0.44834303855895996
loss_pred:0.027849875390529633, decouple_loss:0.010731418617069721
Iteration: 1683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490705728530884, gen p mean: -0.7142407894134521, mean p set: 0.4495508372783661
The modified gen p mean: 0.44711536169052124, gen p mean: -0.7158251404762268, mean p set: 0.44759565591812134
loss_pred:0.02862830087542534, decouple_loss:0.010933616198599339
loss_pred:0.02852998487651348, decouple_loss:0.010358125902712345
The modified gen p mean: 0.4483935832977295, gen p mean: -0.7107492685317993, mean p set: 0.4488738775253296
loss_pred:0.02746472880244255, decouple_loss:0.010468031279742718
Iteration: 1684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775399565696716, gen p mean: -0.7163283824920654, mean p set: 0.4482342600822449
The modified gen p mean: 0.4479466378688812, gen p mean: -0.7129294872283936, mean p set: 0.44842690229415894
loss_pred:0.028658825904130936, decouple_loss:0.010578682646155357
loss_pred:0.027247406542301178, decouple_loss:0.010984597727656364
The modified gen p mean: 0.4485088884830475, gen p mean: -0.7205608487129211, mean p set: 0.4489891827106476
loss_pred:0.029053587466478348, decouple_loss:0.009862598031759262
Iteration: 1685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480580687522888, gen p mean: -0.7247721552848816, mean p set: 0.4485383629798889
loss_pred:0.02756468579173088, decouple_loss:0.01047853846102953
The modified gen p mean: 0.44758614897727966, gen p mean: -0.7171419858932495, mean p set: 0.44806647300720215The modified gen p mean: 0.4488072991371155, gen p mean: -0.731825053691864, mean p set: 0.4492875933647156
loss_pred:0.027232039719820023, decouple_loss:0.010767286643385887
loss_pred:0.027767369523644447, decouple_loss:0.01056089997291565
Iteration: 1686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949501752853394, gen p mean: -0.7380568385124207, mean p set: 0.4499753415584564
The modified gen p mean: 0.44936156272888184, gen p mean: -0.7304250001907349, mean p set: 0.44984182715415955
loss_pred:0.02737561985850334, decouple_loss:0.010261455550789833
loss_pred:0.028154954314231873, decouple_loss:0.010352150537073612The modified gen p mean: 0.44783344864845276, gen p mean: -0.730151355266571, mean p set: 0.44831374287605286
loss_pred:0.028115198016166687, decouple_loss:0.010481924749910831
Iteration: 1687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783735275268555, gen p mean: -0.7310988903045654, mean p set: 0.44831764698028564
loss_pred:0.028664590790867805, decouple_loss:0.01080775260925293
The modified gen p mean: 0.4479117691516876, gen p mean: -0.730993390083313, mean p set: 0.44839203357696533The modified gen p mean: 0.44802820682525635, gen p mean: -0.7289921045303345, mean p set: 0.44850850105285645
loss_pred:0.029065633192658424, decouple_loss:0.010517515242099762
loss_pred:0.028701921924948692, decouple_loss:0.010321925394237041
Iteration: 1688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859200716018677, gen p mean: -0.7279860377311707, mean p set: 0.4490722715854645
loss_pred:0.0280255526304245, decouple_loss:0.010441918857395649
The modified gen p mean: 0.4495101273059845, gen p mean: -0.7348747849464417, mean p set: 0.4499904215335846The modified gen p mean: 0.4478890895843506, gen p mean: -0.728623628616333, mean p set: 0.4483693838119507
loss_pred:0.026426464319229126, decouple_loss:0.009997700341045856
loss_pred:0.02831648290157318, decouple_loss:0.010039451532065868
Iteration: 1689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477972388267517, gen p mean: -0.7297499179840088, mean p set: 0.4482775628566742
loss_pred:0.028553033247590065, decouple_loss:0.00996341835707426
The modified gen p mean: 0.44820448756217957, gen p mean: -0.7326907515525818, mean p set: 0.44868478178977966The modified gen p mean: 0.4483537971973419, gen p mean: -0.7302041053771973, mean p set: 0.44883406162261963
loss_pred:0.029240213334560394, decouple_loss:0.009792915545403957
loss_pred:0.028136543929576874, decouple_loss:0.009992645122110844
Iteration: 1690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731348752975464, gen p mean: -0.728817343711853, mean p set: 0.44779375195503235
loss_pred:0.029164960607886314, decouple_loss:0.009651514701545238
The modified gen p mean: 0.4481784403324127, gen p mean: -0.7257787585258484, mean p set: 0.4486587643623352The modified gen p mean: 0.4467676877975464, gen p mean: -0.7254193425178528, mean p set: 0.4472479820251465
loss_pred:0.028195902705192566, decouple_loss:0.010317469947040081
loss_pred:0.028684763237833977, decouple_loss:0.009903043508529663
2023-05-01 22:25:19 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.732048511505127, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7217606902122498, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7251136898994446, mean p set: 0.4500633478164673
loss_pred:0.0288724172860384, decouple_loss:0.010765121318399906
loss_pred:0.027528366073966026, decouple_loss:0.011070096865296364
loss_pred:0.02777876891195774, decouple_loss:0.010756747797131538
WV_0_PC_1_EH_0_PS_40_5, loss: 0.028603052720427513, avg_mse: 0.03375662490725517
current test mse: 0.033757
Iteration: 1691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501098394393921, gen p mean: -0.7335535287857056, mean p set: 0.4505901634693146
loss_pred:0.02728569135069847, decouple_loss:0.010399735532701015
The modified gen p mean: 0.4493980407714844, gen p mean: -0.7247075438499451, mean p set: 0.4498783349990845The modified gen p mean: 0.4477604329586029, gen p mean: -0.7188116908073425, mean p set: 0.448240727186203
loss_pred:0.027399899438023567, decouple_loss:0.00999198667705059
loss_pred:0.027528658509254456, decouple_loss:0.010585587471723557
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 1692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688746333122253, gen p mean: -0.7222861051559448, mean p set: 0.44736772775650024
loss_pred:0.028143491595983505, decouple_loss:0.010665560141205788
The modified gen p mean: 0.44909846782684326, gen p mean: -0.7333138585090637, mean p set: 0.44957879185676575The modified gen p mean: 0.4476727545261383, gen p mean: -0.7291876673698425, mean p set: 0.4481530487537384
loss_pred:0.027415381744503975, decouple_loss:0.010987424291670322
loss_pred:0.027434593066573143, decouple_loss:0.010412435978651047
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861432909965515, gen p mean: -0.7186043858528137, mean p set: 0.44909462332725525
loss_pred:0.027748722583055496, decouple_loss:0.010861084796488285
The modified gen p mean: 0.4494333267211914, gen p mean: -0.7239072918891907, mean p set: 0.4499136209487915The modified gen p mean: 0.4472886323928833, gen p mean: -0.7242986559867859, mean p set: 0.4477689266204834
loss_pred:0.027867356315255165, decouple_loss:0.01068672351539135
loss_pred:0.028217116370797157, decouple_loss:0.01006330456584692
Iteration: 1694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44623613357543945, gen p mean: -0.7270597815513611, mean p set: 0.44671642780303955
loss_pred:0.02805284969508648, decouple_loss:0.010391414165496826
The modified gen p mean: 0.44727861881256104, gen p mean: -0.7392661571502686, mean p set: 0.44775891304016113The modified gen p mean: 0.4473932087421417, gen p mean: -0.7366129755973816, mean p set: 0.4478735327720642
loss_pred:0.02766347862780094, decouple_loss:0.010875478386878967
loss_pred:0.027739612385630608, decouple_loss:0.009755264036357403
Iteration: 1695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732388854026794, gen p mean: -0.7191728949546814, mean p set: 0.44780421257019043
loss_pred:0.02752704545855522, decouple_loss:0.010433478280901909
The modified gen p mean: 0.44679683446884155, gen p mean: -0.7288129925727844, mean p set: 0.44727712869644165The modified gen p mean: 0.4478175938129425, gen p mean: -0.728202223777771, mean p set: 0.4482978880405426
loss_pred:0.027492709457874298, decouple_loss:0.009935278445482254
loss_pred:0.027456892654299736, decouple_loss:0.010681078769266605
Iteration: 1696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773581624031067, gen p mean: -0.7262861728668213, mean p set: 0.44821611046791077
The modified gen p mean: 0.4476068913936615, gen p mean: -0.7257308959960938, mean p set: 0.448087215423584
loss_pred:0.027550896629691124, decouple_loss:0.010441143065690994
loss_pred:0.027632178738713264, decouple_loss:0.010214121080935001
The modified gen p mean: 0.44784674048423767, gen p mean: -0.7230563759803772, mean p set: 0.44832706451416016
loss_pred:0.027267906814813614, decouple_loss:0.010094070807099342
Iteration: 1697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475298225879669, gen p mean: -0.731534481048584, mean p set: 0.44801008701324463
loss_pred:0.027296511456370354, decouple_loss:0.009974674321711063
The modified gen p mean: 0.44982996582984924, gen p mean: -0.7267729640007019, mean p set: 0.45031026005744934
The modified gen p mean: 0.44753408432006836, gen p mean: -0.7167294025421143, mean p set: 0.44801437854766846
loss_pred:0.028067870065569878, decouple_loss:0.0104585075750947
loss_pred:0.027602680027484894, decouple_loss:0.010360710322856903
Iteration: 1698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821032881736755, gen p mean: -0.7372320294380188, mean p set: 0.44869065284729004
The modified gen p mean: 0.44803324341773987, gen p mean: -0.7264091372489929, mean p set: 0.44851356744766235
loss_pred:0.026981504634022713, decouple_loss:0.00961502268910408
loss_pred:0.02836810238659382, decouple_loss:0.010123745538294315The modified gen p mean: 0.44692885875701904, gen p mean: -0.738633394241333, mean p set: 0.44740915298461914
loss_pred:0.02767864428460598, decouple_loss:0.009783673100173473
Iteration: 1699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487951695919037, gen p mean: -0.7194280028343201, mean p set: 0.4492754638195038
loss_pred:0.02779836393892765, decouple_loss:0.010098789818584919
The modified gen p mean: 0.44697925448417664, gen p mean: -0.7323946356773376, mean p set: 0.44745954871177673The modified gen p mean: 0.4464246928691864, gen p mean: -0.7307571172714233, mean p set: 0.4469049572944641
loss_pred:0.02733783982694149, decouple_loss:0.009467706084251404
loss_pred:0.027512315660715103, decouple_loss:0.010114203207194805
Iteration: 1700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493890404701233, gen p mean: -0.7158817052841187, mean p set: 0.449869304895401
The modified gen p mean: 0.4485139846801758, gen p mean: -0.7181713581085205, mean p set: 0.4489942789077759
loss_pred:0.028680801391601562, decouple_loss:0.009656216017901897
loss_pred:0.028422091156244278, decouple_loss:0.009976728819310665
The modified gen p mean: 0.44854751229286194, gen p mean: -0.7109357118606567, mean p set: 0.44902777671813965
loss_pred:0.028129108250141144, decouple_loss:0.00988417025655508
2023-05-01 22:28:12 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7229107022285461, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7123609185218811, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7157957553863525, mean p set: 0.4500633478164673
loss_pred:0.02855386584997177, decouple_loss:0.010174497961997986
loss_pred:0.02719392627477646, decouple_loss:0.010259240865707397
loss_pred:0.02749013714492321, decouple_loss:0.010119794867932796
WV_0_PC_1_EH_0_PS_40_5, loss: 0.028255201876163483, avg_mse: 0.033294569700956345
current test mse: 0.033295
Iteration: 1701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487040936946869, gen p mean: -0.7236443758010864, mean p set: 0.449184387922287
loss_pred:0.02761954814195633, decouple_loss:0.01038100104779005
The modified gen p mean: 0.4461551308631897, gen p mean: -0.7241082191467285, mean p set: 0.4466353952884674The modified gen p mean: 0.44760459661483765, gen p mean: -0.7248987555503845, mean p set: 0.44808489084243774
loss_pred:0.02769545651972294, decouple_loss:0.00987417995929718
loss_pred:0.027178462594747543, decouple_loss:0.009456725791096687
Iteration: 1702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478420615196228, gen p mean: -0.7241340279579163, mean p set: 0.4483223557472229
loss_pred:0.02693934366106987, decouple_loss:0.00962142925709486
The modified gen p mean: 0.4483109414577484, gen p mean: -0.7215098142623901, mean p set: 0.4487912356853485The modified gen p mean: 0.4470822811126709, gen p mean: -0.7302098274230957, mean p set: 0.447562575340271
loss_pred:0.028559770435094833, decouple_loss:0.009452787227928638
loss_pred:0.027373194694519043, decouple_loss:0.00967410672456026
Iteration: 1703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779470562934875, gen p mean: -0.7257461547851562, mean p set: 0.44827497005462646
loss_pred:0.02700280025601387, decouple_loss:0.01032119058072567
The modified gen p mean: 0.448018342256546, gen p mean: -0.7305296659469604, mean p set: 0.4484986364841461The modified gen p mean: 0.4454862177371979, gen p mean: -0.729027509689331, mean p set: 0.445966511964798
loss_pred:0.027282312512397766, decouple_loss:0.009433668106794357
loss_pred:0.02791624329984188, decouple_loss:0.009791018441319466
Iteration: 1704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472768306732178, gen p mean: -0.7330796122550964, mean p set: 0.44775715470314026
The modified gen p mean: 0.44749554991722107, gen p mean: -0.7240242958068848, mean p set: 0.4479758143424988loss_pred:0.02737985923886299, decouple_loss:0.00979624968022108
The modified gen p mean: 0.44608765840530396, gen p mean: -0.7297487258911133, mean p set: 0.44656795263290405
loss_pred:0.026996375992894173, decouple_loss:0.009763200767338276
loss_pred:0.027428407222032547, decouple_loss:0.009665008634328842
Iteration: 1705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471273422241211, gen p mean: -0.7272102236747742, mean p set: 0.4476076066493988
The modified gen p mean: 0.44558775424957275, gen p mean: -0.7270799875259399, mean p set: 0.44606801867485046
loss_pred:0.027116544544696808, decouple_loss:0.009189999662339687
loss_pred:0.027794213965535164, decouple_loss:0.00977778434753418
The modified gen p mean: 0.4474327564239502, gen p mean: -0.7231665253639221, mean p set: 0.4479130506515503
loss_pred:0.0275284331291914, decouple_loss:0.009196068160235882
Iteration: 1706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719722867012024, gen p mean: -0.7239285707473755, mean p set: 0.44767752289772034
The modified gen p mean: 0.44930770993232727, gen p mean: -0.7248672246932983, mean p set: 0.449787974357605loss_pred:0.02686131000518799, decouple_loss:0.009610126726329327
The modified gen p mean: 0.4468348026275635, gen p mean: -0.73047935962677, mean p set: 0.4473150670528412
loss_pred:0.02754884585738182, decouple_loss:0.010407501831650734
loss_pred:0.027330469340085983, decouple_loss:0.010444112122058868
Iteration: 1707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469814896583557, gen p mean: -0.7240740060806274, mean p set: 0.4474617540836334
The modified gen p mean: 0.44713956117630005, gen p mean: -0.7179258465766907, mean p set: 0.44761988520622253
loss_pred:0.027316762134432793, decouple_loss:0.009638664312660694
loss_pred:0.027529079467058182, decouple_loss:0.009684482589364052
The modified gen p mean: 0.44778165221214294, gen p mean: -0.7180250883102417, mean p set: 0.44826194643974304
loss_pred:0.02810458280146122, decouple_loss:0.009685327298939228
Iteration: 1708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44741398096084595, gen p mean: -0.7126699090003967, mean p set: 0.44789430499076843
The modified gen p mean: 0.4480317533016205, gen p mean: -0.7100715637207031, mean p set: 0.4485120475292206
loss_pred:0.027219722047448158, decouple_loss:0.009106749668717384
loss_pred:0.02879447117447853, decouple_loss:0.009488332085311413
The modified gen p mean: 0.44852012395858765, gen p mean: -0.7167673110961914, mean p set: 0.44900041818618774
loss_pred:0.026526201516389847, decouple_loss:0.009636970236897469
Iteration: 1709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476143717765808, gen p mean: -0.7226424813270569, mean p set: 0.4480946362018585
The modified gen p mean: 0.4483204185962677, gen p mean: -0.7160934805870056, mean p set: 0.4488007128238678
loss_pred:0.027053577825427055, decouple_loss:0.008977756835520267
loss_pred:0.027597539126873016, decouple_loss:0.009509313851594925
The modified gen p mean: 0.44661805033683777, gen p mean: -0.7226587533950806, mean p set: 0.44709834456443787
loss_pred:0.02731001004576683, decouple_loss:0.009234365075826645
Iteration: 1710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461471736431122, gen p mean: -0.7287245392799377, mean p set: 0.4466274678707123
loss_pred:0.027726128697395325, decouple_loss:0.0096525177359581
The modified gen p mean: 0.4471665024757385, gen p mean: -0.730817973613739, mean p set: 0.447646826505661
The modified gen p mean: 0.4483659267425537, gen p mean: -0.730346143245697, mean p set: 0.4488462209701538
loss_pred:0.027283145114779472, decouple_loss:0.009821780025959015
loss_pred:0.027067460119724274, decouple_loss:0.009190711192786694
2023-05-01 22:30:20 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7298651337623596, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7197858691215515, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7232269048690796, mean p set: 0.4500633478164673
loss_pred:0.028358928859233856, decouple_loss:0.009844117797911167
loss_pred:0.027013171464204788, decouple_loss:0.010068115778267384
loss_pred:0.027341129258275032, decouple_loss:0.009837022982537746
WV_0_PC_1_EH_0_PS_40_5, loss: 0.02806689962744713, avg_mse: 0.03295018896460533
current test mse: 0.03295
Iteration: 1711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736161828041077, gen p mean: -0.7317569851875305, mean p set: 0.44784191250801086
The modified gen p mean: 0.4468082785606384, gen p mean: -0.734889566898346, mean p set: 0.4472885727882385
loss_pred:0.02731041982769966, decouple_loss:0.009508749470114708
The modified gen p mean: 0.44839411973953247, gen p mean: -0.7251497507095337, mean p set: 0.44887441396713257
loss_pred:0.02781320922076702, decouple_loss:0.010198133997619152
loss_pred:0.027910571545362473, decouple_loss:0.009434660896658897
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
NaN value num: 0
Iteration: 1712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465724527835846, gen p mean: -0.7259716987609863, mean p set: 0.4470527172088623
loss_pred:0.029678504914045334, decouple_loss:0.009914945811033249
The modified gen p mean: 0.4477159082889557, gen p mean: -0.7268610000610352, mean p set: 0.4481962025165558The modified gen p mean: 0.44680461287498474, gen p mean: -0.7280401587486267, mean p set: 0.44728490710258484
loss_pred:0.02850501984357834, decouple_loss:0.009767415933310986
loss_pred:0.026979617774486542, decouple_loss:0.009756353683769703
Iteration: 1713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842609763145447, gen p mean: -0.7321416735649109, mean p set: 0.4489063620567322
loss_pred:0.028107520192861557, decouple_loss:0.009952584281563759
The modified gen p mean: 0.4478079676628113, gen p mean: -0.7300180196762085, mean p set: 0.448288232088089The modified gen p mean: 0.44892945885658264, gen p mean: -0.7369759678840637, mean p set: 0.44940972328186035
loss_pred:0.02728521078824997, decouple_loss:0.010005536489188671
loss_pred:0.026879139244556427, decouple_loss:0.009959544986486435
Iteration: 1714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728296995162964, gen p mean: -0.7285069227218628, mean p set: 0.4477632939815521
loss_pred:0.028397521004080772, decouple_loss:0.010148787871003151
The modified gen p mean: 0.4473426938056946, gen p mean: -0.733798086643219, mean p set: 0.4478229880332947The modified gen p mean: 0.4468744695186615, gen p mean: -0.7306827306747437, mean p set: 0.4473547637462616
loss_pred:0.02705405279994011, decouple_loss:0.009914703667163849
loss_pred:0.02695649303495884, decouple_loss:0.009492767974734306
Iteration: 1715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891101121902466, gen p mean: -0.7329802513122559, mean p set: 0.44939130544662476
loss_pred:0.02775249443948269, decouple_loss:0.009364410303533077
The modified gen p mean: 0.44755280017852783, gen p mean: -0.7273910045623779, mean p set: 0.4480331242084503The modified gen p mean: 0.44781041145324707, gen p mean: -0.7319109439849854, mean p set: 0.44829070568084717
loss_pred:0.026863496750593185, decouple_loss:0.00942202564328909
loss_pred:0.028206756338477135, decouple_loss:0.009530886076390743
Iteration: 1716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645819067955017, gen p mean: -0.7212168574333191, mean p set: 0.44693848490715027
loss_pred:0.02851707860827446, decouple_loss:0.009468365460634232
The modified gen p mean: 0.44663500785827637, gen p mean: -0.721764862537384, mean p set: 0.4471152722835541The modified gen p mean: 0.4470949172973633, gen p mean: -0.7292155027389526, mean p set: 0.4475752115249634
loss_pred:0.028186004608869553, decouple_loss:0.009496568702161312
loss_pred:0.02700442634522915, decouple_loss:0.009049681946635246
Iteration: 1717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634735584259033, gen p mean: -0.7302819490432739, mean p set: 0.44682762026786804
loss_pred:0.026876304298639297, decouple_loss:0.01033679861575365
The modified gen p mean: 0.4462895691394806, gen p mean: -0.7310147285461426, mean p set: 0.4467698633670807The modified gen p mean: 0.44810453057289124, gen p mean: -0.7296470403671265, mean p set: 0.44858479499816895
loss_pred:0.028485139831900597, decouple_loss:0.009886795654892921
loss_pred:0.02754889987409115, decouple_loss:0.009725796990096569
Iteration: 1718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471752941608429, gen p mean: -0.7371723651885986, mean p set: 0.447655588388443
loss_pred:0.02844925969839096, decouple_loss:0.01012128870934248
The modified gen p mean: 0.4479794204235077, gen p mean: -0.7231484055519104, mean p set: 0.4484597444534302The modified gen p mean: 0.4471675753593445, gen p mean: -0.7243493795394897, mean p set: 0.4476478397846222
loss_pred:0.02819160372018814, decouple_loss:0.009868982248008251
loss_pred:0.02826988883316517, decouple_loss:0.010028827004134655
Iteration: 1719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477410912513733, gen p mean: -0.7353760600090027, mean p set: 0.4482213854789734
loss_pred:0.026488222181797028, decouple_loss:0.009816543199121952
The modified gen p mean: 0.44786643981933594, gen p mean: -0.7311099171638489, mean p set: 0.44834673404693604
The modified gen p mean: 0.4468745291233063, gen p mean: -0.7367745041847229, mean p set: 0.447354793548584
loss_pred:0.028875410556793213, decouple_loss:0.010010790079832077
loss_pred:0.027793917804956436, decouple_loss:0.010008728131651878
Iteration: 1720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653043150901794, gen p mean: -0.7385483384132385, mean p set: 0.44701069593429565
loss_pred:0.0270446315407753, decouple_loss:0.009850014932453632
The modified gen p mean: 0.448213666677475, gen p mean: -0.7279157042503357, mean p set: 0.4486939311027527The modified gen p mean: 0.4470505118370056, gen p mean: -0.7416258454322815, mean p set: 0.4475308060646057
loss_pred:0.02850240096449852, decouple_loss:0.009282778948545456
loss_pred:0.027494750916957855, decouple_loss:0.010323663242161274
2023-05-01 22:33:11 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.733135998249054, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7230860590934753, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7268378138542175, mean p set: 0.4500633478164673
loss_pred:0.0286235474050045, decouple_loss:0.010533218272030354
loss_pred:0.027171025052666664, decouple_loss:0.01051778718829155
loss_pred:0.027617337182164192, decouple_loss:0.010203864425420761
WV_0_PC_1_EH_0_PS_40_5, loss: 0.028324885293841362, avg_mse: 0.03332990035414696
current test mse: 0.03333
Iteration: 1721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479723274707794, gen p mean: -0.7329057455062866, mean p set: 0.4484526515007019
loss_pred:0.027938341721892357, decouple_loss:0.009768432006239891
The modified gen p mean: 0.4463687837123871, gen p mean: -0.7322255373001099, mean p set: 0.44684910774230957The modified gen p mean: 0.44723790884017944, gen p mean: -0.7331185340881348, mean p set: 0.44771823287010193
loss_pred:0.02812664769589901, decouple_loss:0.01003407221287489
loss_pred:0.028604870662093163, decouple_loss:0.010060022585093975
Iteration: 1722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490271806716919, gen p mean: -0.7394649386405945, mean p set: 0.4495074450969696
loss_pred:0.02779243513941765, decouple_loss:0.010165898129343987
The modified gen p mean: 0.4468402862548828, gen p mean: -0.7348105311393738, mean p set: 0.4473206102848053The modified gen p mean: 0.4477769434452057, gen p mean: -0.7324738502502441, mean p set: 0.4482572078704834
loss_pred:0.0288876723498106, decouple_loss:0.010044516995549202
loss_pred:0.02855287864804268, decouple_loss:0.009689584374427795
Iteration: 1723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447847843170166, gen p mean: -0.7455052733421326, mean p set: 0.4483281373977661
loss_pred:0.028273407369852066, decouple_loss:0.009982636198401451
The modified gen p mean: 0.4468744099140167, gen p mean: -0.7348537445068359, mean p set: 0.4473547041416168The modified gen p mean: 0.4470593333244324, gen p mean: -0.7354660034179688, mean p set: 0.44753962755203247
loss_pred:0.0278188306838274, decouple_loss:0.009430699981749058
loss_pred:0.027920104563236237, decouple_loss:0.009252526797354221
Iteration: 1724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702789187431335, gen p mean: -0.7413979768753052, mean p set: 0.44750818610191345
loss_pred:0.02728315442800522, decouple_loss:0.00980765838176012
The modified gen p mean: 0.44772493839263916, gen p mean: -0.7301391363143921, mean p set: 0.44820523262023926The modified gen p mean: 0.44762206077575684, gen p mean: -0.7347004413604736, mean p set: 0.4481023848056793
loss_pred:0.0285948496311903, decouple_loss:0.009222348220646381
loss_pred:0.0285135917365551, decouple_loss:0.009428735822439194
Iteration: 1725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669944047927856, gen p mean: -0.7342789769172668, mean p set: 0.44717973470687866
loss_pred:0.028657689690589905, decouple_loss:0.009700310416519642
The modified gen p mean: 0.4475628435611725, gen p mean: -0.7375736236572266, mean p set: 0.4480431377887726The modified gen p mean: 0.44702011346817017, gen p mean: -0.7294480800628662, mean p set: 0.44750040769577026
loss_pred:0.027922052890062332, decouple_loss:0.009985929355025291
loss_pred:0.02822115458548069, decouple_loss:0.009184514172375202
Iteration: 1726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811147451400757, gen p mean: -0.726860523223877, mean p set: 0.44859179854393005
loss_pred:0.02693747915327549, decouple_loss:0.009293384850025177
The modified gen p mean: 0.44741570949554443, gen p mean: -0.7272180318832397, mean p set: 0.44789600372314453The modified gen p mean: 0.44788864254951477, gen p mean: -0.7252979278564453, mean p set: 0.44836893677711487
loss_pred:0.02831076830625534, decouple_loss:0.009134141728281975
loss_pred:0.02749456651508808, decouple_loss:0.008956095203757286
Iteration: 1727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776391983032227, gen p mean: -0.7213189601898193, mean p set: 0.44824421405792236
loss_pred:0.02875744365155697, decouple_loss:0.008946594782173634
The modified gen p mean: 0.4471603333950043, gen p mean: -0.7307784557342529, mean p set: 0.44764068722724915The modified gen p mean: 0.4486711323261261, gen p mean: -0.737228274345398, mean p set: 0.4491514265537262
loss_pred:0.027220571413636208, decouple_loss:0.009676978923380375
loss_pred:0.02626706473529339, decouple_loss:0.009322523139417171
Iteration: 1728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468475878238678, gen p mean: -0.7306994199752808, mean p set: 0.4473278820514679
loss_pred:0.02800300158560276, decouple_loss:0.00938066840171814
The modified gen p mean: 0.4482361078262329, gen p mean: -0.7293089032173157, mean p set: 0.448716402053833The modified gen p mean: 0.44612574577331543, gen p mean: -0.7317148447036743, mean p set: 0.44660601019859314
loss_pred:0.026153743267059326, decouple_loss:0.009277352131903172
loss_pred:0.027028152719140053, decouple_loss:0.00928006786853075
Iteration: 1729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457228481769562, gen p mean: -0.735779345035553, mean p set: 0.44620317220687866
loss_pred:0.027496222406625748, decouple_loss:0.009179974906146526
The modified gen p mean: 0.4471132159233093, gen p mean: -0.7375764846801758, mean p set: 0.4475935399532318The modified gen p mean: 0.4458576738834381, gen p mean: -0.733549952507019, mean p set: 0.4463379681110382
loss_pred:0.027874784544110298, decouple_loss:0.009417170658707619
loss_pred:0.02711399644613266, decouple_loss:0.009504621848464012
Iteration: 1730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484494626522064, gen p mean: -0.741240382194519, mean p set: 0.4489297568798065
loss_pred:0.026942837983369827, decouple_loss:0.009153850376605988
The modified gen p mean: 0.4469485580921173, gen p mean: -0.7335407733917236, mean p set: 0.44742879271507263The modified gen p mean: 0.44801634550094604, gen p mean: -0.7343050837516785, mean p set: 0.44849663972854614
loss_pred:0.029101382941007614, decouple_loss:0.009253844618797302
loss_pred:0.0279378741979599, decouple_loss:0.008845570497214794
2023-05-01 22:35:19 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7383195161819458, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7277269959449768, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7313547134399414, mean p set: 0.4500633478164673
loss_pred:0.02863823063671589, decouple_loss:0.009891418740153313
loss_pred:0.027217261493206024, decouple_loss:0.010047920979559422
loss_pred:0.027634119614958763, decouple_loss:0.009827772155404091
WV_0_PC_1_EH_0_PS_40_5, loss: 0.028325989842414856, avg_mse: 0.03356705233454704
current test mse: 0.033567
Iteration: 1731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815143942832947, gen p mean: -0.7349609732627869, mean p set: 0.44863173365592957
loss_pred:0.02722281403839588, decouple_loss:0.009025790728628635
The modified gen p mean: 0.4478556215763092, gen p mean: -0.7343209981918335, mean p set: 0.4483358860015869The modified gen p mean: 0.4466511607170105, gen p mean: -0.7392858862876892, mean p set: 0.4471314251422882
loss_pred:0.027529705315828323, decouple_loss:0.009739123284816742
loss_pred:0.028137849643826485, decouple_loss:0.009186964482069016
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
NaN value num: 0
Iteration: 1732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45094922184944153, gen p mean: -0.7250354886054993, mean p set: 0.4514295160770416
loss_pred:0.028321905061602592, decouple_loss:0.011691303923726082
The modified gen p mean: 0.453296422958374, gen p mean: -0.7325631380081177, mean p set: 0.45377665758132935The modified gen p mean: 0.4525487720966339, gen p mean: -0.7266784310340881, mean p set: 0.4530290365219116
loss_pred:0.02740791067481041, decouple_loss:0.011870717629790306
loss_pred:0.027369173243641853, decouple_loss:0.011113464832305908
Iteration: 1733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45353958010673523, gen p mean: -0.7320388555526733, mean p set: 0.4540198743343353
loss_pred:0.027854563668370247, decouple_loss:0.011084136553108692
The modified gen p mean: 0.4524392783641815, gen p mean: -0.7289231419563293, mean p set: 0.4529195725917816The modified gen p mean: 0.45160800218582153, gen p mean: -0.7301401495933533, mean p set: 0.45208826661109924
loss_pred:0.028120022267103195, decouple_loss:0.010331767611205578
loss_pred:0.026753820478916168, decouple_loss:0.010728821158409119
Iteration: 1734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525858461856842, gen p mean: -0.7354166507720947, mean p set: 0.4530661106109619
loss_pred:0.0273673664778471, decouple_loss:0.010587110184133053
The modified gen p mean: 0.45178577303886414, gen p mean: -0.7198428511619568, mean p set: 0.4522660970687866The modified gen p mean: 0.4530549943447113, gen p mean: -0.7312722206115723, mean p set: 0.4535352885723114
loss_pred:0.02920212224125862, decouple_loss:0.011005837470293045
loss_pred:0.027849743142724037, decouple_loss:0.010784476064145565
Iteration: 1735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45336228609085083, gen p mean: -0.732437252998352, mean p set: 0.4538425803184509
loss_pred:0.0289680827409029, decouple_loss:0.01042939629405737
The modified gen p mean: 0.45184895396232605, gen p mean: -0.7292589545249939, mean p set: 0.45232921838760376The modified gen p mean: 0.45108649134635925, gen p mean: -0.7307305335998535, mean p set: 0.45156678557395935
loss_pred:0.027997853234410286, decouple_loss:0.010735560208559036
loss_pred:0.02833615243434906, decouple_loss:0.010662331245839596
Iteration: 1736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529039263725281, gen p mean: -0.729793131351471, mean p set: 0.4533842206001282
loss_pred:0.028768479824066162, decouple_loss:0.010368680581450462
The modified gen p mean: 0.4516642093658447, gen p mean: -0.7323707342147827, mean p set: 0.45214447379112244The modified gen p mean: 0.45224201679229736, gen p mean: -0.7324125170707703, mean p set: 0.45272231101989746
loss_pred:0.028585055842995644, decouple_loss:0.010574668645858765
loss_pred:0.02696525864303112, decouple_loss:0.010292432270944118
Iteration: 1737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453336626291275, gen p mean: -0.7262715697288513, mean p set: 0.4538169205188751
The modified gen p mean: 0.4527387320995331, gen p mean: -0.7300401926040649, mean p set: 0.4532190263271332
loss_pred:0.026363346725702286, decouple_loss:0.010303876362740993
loss_pred:0.0271194726228714, decouple_loss:0.010220967233181
The modified gen p mean: 0.45200395584106445, gen p mean: -0.7255227565765381, mean p set: 0.45248425006866455
loss_pred:0.02781258523464203, decouple_loss:0.010016468353569508
Iteration: 1738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525024890899658, gen p mean: -0.7137344479560852, mean p set: 0.45298275351524353
The modified gen p mean: 0.4518159031867981, gen p mean: -0.722176730632782, mean p set: 0.4522961974143982
loss_pred:0.02848063036799431, decouple_loss:0.01091128308326006
loss_pred:0.02841179259121418, decouple_loss:0.010049127973616123
The modified gen p mean: 0.45283907651901245, gen p mean: -0.7220504879951477, mean p set: 0.45331934094429016
loss_pred:0.02767200767993927, decouple_loss:0.01049019768834114
Iteration: 1739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519208073616028, gen p mean: -0.71699059009552, mean p set: 0.4524010717868805
loss_pred:0.028283223509788513, decouple_loss:0.010939315892755985
The modified gen p mean: 0.4519190490245819, gen p mean: -0.7207368612289429, mean p set: 0.452399343252182The modified gen p mean: 0.45225900411605835, gen p mean: -0.7296807765960693, mean p set: 0.45273926854133606
loss_pred:0.0278046652674675, decouple_loss:0.010600889101624489
loss_pred:0.027128916233778, decouple_loss:0.010294065810739994
Iteration: 1740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45171183347702026, gen p mean: -0.7293609976768494, mean p set: 0.45219212770462036
The modified gen p mean: 0.4535723030567169, gen p mean: -0.7341966032981873, mean p set: 0.45405256748199463
loss_pred:0.02710673399269581, decouple_loss:0.010110767558217049
loss_pred:0.02799735777080059, decouple_loss:0.010791875422000885
The modified gen p mean: 0.45230743288993835, gen p mean: -0.7195144295692444, mean p set: 0.45278772711753845
loss_pred:0.028729598969221115, decouple_loss:0.01053951308131218
2023-05-01 22:38:00 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7399156093597412, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7298636436462402, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7334698438644409, mean p set: 0.4500633478164673
loss_pred:0.028911009430885315, decouple_loss:0.011345654726028442
loss_pred:0.027296319603919983, decouple_loss:0.011556909419596195
loss_pred:0.027619721367955208, decouple_loss:0.011175538413226604
WV_0_PC_1_EH_0_PS_40_5, loss: 0.02851031720638275, avg_mse: 0.033707134425640106
current test mse: 0.033707
Iteration: 1741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543944001197815, gen p mean: -0.7237659096717834, mean p set: 0.4548746943473816
loss_pred:0.027941208332777023, decouple_loss:0.010490577667951584
The modified gen p mean: 0.45314478874206543, gen p mean: -0.7260347604751587, mean p set: 0.45362505316734314The modified gen p mean: 0.4518929421901703, gen p mean: -0.7211517691612244, mean p set: 0.4523732364177704
loss_pred:0.02871633879840374, decouple_loss:0.010588846169412136
loss_pred:0.028141193091869354, decouple_loss:0.010383494198322296
Iteration: 1742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539492726325989, gen p mean: -0.7353066802024841, mean p set: 0.454429566860199
loss_pred:0.027401553466916084, decouple_loss:0.010741330683231354
The modified gen p mean: 0.4538275897502899, gen p mean: -0.733035683631897, mean p set: 0.4543079137802124The modified gen p mean: 0.45128047466278076, gen p mean: -0.7335665822029114, mean p set: 0.45176076889038086
loss_pred:0.027943003922700882, decouple_loss:0.010137890465557575
loss_pred:0.02554769068956375, decouple_loss:0.009997782297432423
Iteration: 1743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173004269599915, gen p mean: -0.7327874302864075, mean p set: 0.45221033692359924
loss_pred:0.026683436706662178, decouple_loss:0.009612729772925377
The modified gen p mean: 0.45232123136520386, gen p mean: -0.7250308394432068, mean p set: 0.45280152559280396The modified gen p mean: 0.45474690198898315, gen p mean: -0.7312235236167908, mean p set: 0.45522719621658325
loss_pred:0.028131049126386642, decouple_loss:0.010335182771086693
loss_pred:0.028083376586437225, decouple_loss:0.010141308419406414
Iteration: 1744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451107382774353, gen p mean: -0.7248696684837341, mean p set: 0.45158764719963074
loss_pred:0.02803358994424343, decouple_loss:0.010001707822084427
The modified gen p mean: 0.4527120292186737, gen p mean: -0.7346590757369995, mean p set: 0.4531923532485962The modified gen p mean: 0.45458194613456726, gen p mean: -0.7242414951324463, mean p set: 0.45506227016448975
loss_pred:0.027946097776293755, decouple_loss:0.009949738159775734
loss_pred:0.027349654585123062, decouple_loss:0.010152839124202728
Iteration: 1745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45176437497138977, gen p mean: -0.7251681089401245, mean p set: 0.4522446393966675
loss_pred:0.028395652770996094, decouple_loss:0.010107232257723808
The modified gen p mean: 0.45436644554138184, gen p mean: -0.7302107810974121, mean p set: 0.45484670996665955The modified gen p mean: 0.4520331025123596, gen p mean: -0.7245100736618042, mean p set: 0.45251336693763733
loss_pred:0.02742408774793148, decouple_loss:0.010019185952842236
loss_pred:0.028843438252806664, decouple_loss:0.010372640565037727
Iteration: 1746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536791741847992, gen p mean: -0.7255072593688965, mean p set: 0.4541594386100769
loss_pred:0.027556955814361572, decouple_loss:0.01027643121778965
The modified gen p mean: 0.4519352614879608, gen p mean: -0.7273438572883606, mean p set: 0.4524155259132385The modified gen p mean: 0.45303648710250854, gen p mean: -0.7288262844085693, mean p set: 0.45351678133010864
loss_pred:0.027284614741802216, decouple_loss:0.00978744588792324
loss_pred:0.027467943727970123, decouple_loss:0.009988240897655487
Iteration: 1747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523218870162964, gen p mean: -0.7316566109657288, mean p set: 0.4528021812438965
loss_pred:0.028574064373970032, decouple_loss:0.010026989504694939
The modified gen p mean: 0.45156213641166687, gen p mean: -0.7228307127952576, mean p set: 0.4520424008369446The modified gen p mean: 0.4503503441810608, gen p mean: -0.7296934723854065, mean p set: 0.4508306682109833
loss_pred:0.02826724573969841, decouple_loss:0.010024074465036392
loss_pred:0.027549725025892258, decouple_loss:0.009444966912269592
Iteration: 1748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526750147342682, gen p mean: -0.7402333617210388, mean p set: 0.4531553387641907
loss_pred:0.02730579674243927, decouple_loss:0.009707076475024223
The modified gen p mean: 0.45258262753486633, gen p mean: -0.7466611266136169, mean p set: 0.45306292176246643The modified gen p mean: 0.45369771122932434, gen p mean: -0.7414317727088928, mean p set: 0.45417800545692444
loss_pred:0.028185425326228142, decouple_loss:0.009991114027798176
loss_pred:0.027737699449062347, decouple_loss:0.009979897178709507
Iteration: 1749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532589316368103, gen p mean: -0.740321695804596, mean p set: 0.4537392258644104
loss_pred:0.027828965336084366, decouple_loss:0.009491250850260258
The modified gen p mean: 0.4545176923274994, gen p mean: -0.7393067479133606, mean p set: 0.4549979567527771The modified gen p mean: 0.4526388645172119, gen p mean: -0.737643301486969, mean p set: 0.453119158744812
loss_pred:0.028018685057759285, decouple_loss:0.009383114986121655
loss_pred:0.028237536549568176, decouple_loss:0.010014674626290798
Iteration: 1750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531635046005249, gen p mean: -0.7206401824951172, mean p set: 0.4536438286304474
The modified gen p mean: 0.4515564441680908, gen p mean: -0.7253241539001465, mean p set: 0.45203670859336853
The modified gen p mean: 0.4519031345844269, gen p mean: -0.7275077700614929, mean p set: 0.452383428812027
loss_pred:0.0280766598880291, decouple_loss:0.010145006701350212
loss_pred:0.028107404708862305, decouple_loss:0.009687040001153946loss_pred:0.028057334944605827, decouple_loss:0.009729896672070026
2023-05-01 22:40:08 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7459743618965149, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7387968897819519, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7350318431854248, mean p set: 0.45035696029663086
loss_pred:0.028793038800358772, decouple_loss:0.01135484129190445
loss_pred:0.027182400226593018, decouple_loss:0.011379461735486984loss_pred:0.02755918726325035, decouple_loss:0.011091377586126328
WV_0_PC_1_EH_0_PS_40_5, loss: 0.028408637270331383, avg_mse: 0.03360634669661522
current test mse: 0.033606
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 1751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480619728565216, gen p mean: -0.7343152165412903, mean p set: 0.4485422670841217
loss_pred:0.02765498496592045, decouple_loss:0.011762643232941628
The modified gen p mean: 0.44637301564216614, gen p mean: -0.7376790642738342, mean p set: 0.44685330986976624The modified gen p mean: 0.44752660393714905, gen p mean: -0.7396836280822754, mean p set: 0.44800689816474915
loss_pred:0.027568859979510307, decouple_loss:0.011128613725304604
loss_pred:0.0283626988530159, decouple_loss:0.012143854983150959
Iteration: 1752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863346219062805, gen p mean: -0.7472298741340637, mean p set: 0.44911372661590576
The modified gen p mean: 0.44783854484558105, gen p mean: -0.7443727850914001, mean p set: 0.44831880927085876
loss_pred:0.027301831170916557, decouple_loss:0.011156116612255573
loss_pred:0.027728067710995674, decouple_loss:0.01067357137799263
The modified gen p mean: 0.4487875998020172, gen p mean: -0.7442142367362976, mean p set: 0.4492678940296173
loss_pred:0.0272106621414423, decouple_loss:0.010793386958539486
Iteration: 1753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465709626674652, gen p mean: -0.7393467426300049, mean p set: 0.4470512866973877
loss_pred:0.02852560207247734, decouple_loss:0.010555608198046684
The modified gen p mean: 0.4477509558200836, gen p mean: -0.7361347675323486, mean p set: 0.44823122024536133The modified gen p mean: 0.4482143223285675, gen p mean: -0.7387859225273132, mean p set: 0.44869464635849
loss_pred:0.028151080012321472, decouple_loss:0.010721072554588318
loss_pred:0.0275890976190567, decouple_loss:0.010568095371127129
Iteration: 1754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447463721036911, gen p mean: -0.7315526604652405, mean p set: 0.4479440450668335
loss_pred:0.027506597340106964, decouple_loss:0.010279068723320961
The modified gen p mean: 0.447913259267807, gen p mean: -0.7363387942314148, mean p set: 0.4483935534954071The modified gen p mean: 0.44700315594673157, gen p mean: -0.7372083067893982, mean p set: 0.44748347997665405
loss_pred:0.026668911799788475, decouple_loss:0.010494960471987724
loss_pred:0.02757720649242401, decouple_loss:0.010598897002637386
Iteration: 1755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745364785194397, gen p mean: -0.7379029989242554, mean p set: 0.4479339122772217
loss_pred:0.02783951722085476, decouple_loss:0.010576967149972916
The modified gen p mean: 0.44811657071113586, gen p mean: -0.7426795959472656, mean p set: 0.4485968351364136The modified gen p mean: 0.44872280955314636, gen p mean: -0.7434043884277344, mean p set: 0.44920313358306885
loss_pred:0.02655366063117981, decouple_loss:0.010609553195536137
loss_pred:0.026517074555158615, decouple_loss:0.010565162636339664
Iteration: 1756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485308527946472, gen p mean: -0.7299726009368896, mean p set: 0.4490111172199249
loss_pred:0.02678324468433857, decouple_loss:0.010208996944129467
The modified gen p mean: 0.4479690194129944, gen p mean: -0.7295512557029724, mean p set: 0.4484493136405945The modified gen p mean: 0.4477875232696533, gen p mean: -0.7357771396636963, mean p set: 0.4482678174972534
loss_pred:0.027624139562249184, decouple_loss:0.010512017644941807
loss_pred:0.02694578468799591, decouple_loss:0.010147114284336567
Iteration: 1757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482780694961548, gen p mean: -0.7262868285179138, mean p set: 0.4487583637237549
loss_pred:0.028095098212361336, decouple_loss:0.010117842815816402
The modified gen p mean: 0.44802403450012207, gen p mean: -0.7352033257484436, mean p set: 0.44850432872772217
The modified gen p mean: 0.44879162311553955, gen p mean: -0.7300302982330322, mean p set: 0.44927188754081726
loss_pred:0.026591407135128975, decouple_loss:0.010440477170050144
loss_pred:0.026892656460404396, decouple_loss:0.010191243141889572
Iteration: 1758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762372970581055, gen p mean: -0.7302371859550476, mean p set: 0.44810402393341064
loss_pred:0.026511680334806442, decouple_loss:0.010273400694131851
The modified gen p mean: 0.4482062757015228, gen p mean: -0.7280334234237671, mean p set: 0.4486865699291229The modified gen p mean: 0.44795534014701843, gen p mean: -0.7274700403213501, mean p set: 0.4484356641769409
loss_pred:0.02725648134946823, decouple_loss:0.01028489600867033
loss_pred:0.02823125571012497, decouple_loss:0.010249577462673187
Iteration: 1759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484468400478363, gen p mean: -0.7225257754325867, mean p set: 0.4489271342754364
loss_pred:0.026524581015110016, decouple_loss:0.010211979039013386
The modified gen p mean: 0.4472324848175049, gen p mean: -0.7325043678283691, mean p set: 0.447712779045105The modified gen p mean: 0.4473022222518921, gen p mean: -0.7305960059165955, mean p set: 0.4477825164794922
loss_pred:0.027649085968732834, decouple_loss:0.009900003671646118
loss_pred:0.027223143726587296, decouple_loss:0.0100119449198246
Iteration: 1760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692254066467285, gen p mean: -0.7290160059928894, mean p set: 0.44740280508995056
loss_pred:0.02713640034198761, decouple_loss:0.010119900107383728
The modified gen p mean: 0.4478570818901062, gen p mean: -0.7342931628227234, mean p set: 0.4483374059200287The modified gen p mean: 0.4471516013145447, gen p mean: -0.7239515781402588, mean p set: 0.4476318955421448
loss_pred:0.026114938780665398, decouple_loss:0.009753360413014889
loss_pred:0.028213169425725937, decouple_loss:0.009883797727525234
2023-05-01 22:42:52 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7406063079833984, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7296666502952576, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7335381507873535, mean p set: 0.4500633478164673
loss_pred:0.028252452611923218, decouple_loss:0.01032601110637188
loss_pred:0.026884205639362335, decouple_loss:0.010038982145488262
loss_pred:0.02713593654334545, decouple_loss:0.01000752579420805
WV_0_PC_1_EH_0_PS_40_5, loss: 0.027930406853556633, avg_mse: 0.032944075763225555
current test mse: 0.032944
Iteration: 1761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797733426094055, gen p mean: -0.7263128161430359, mean p set: 0.44845762848854065
loss_pred:0.026323692873120308, decouple_loss:0.010112372227013111
The modified gen p mean: 0.4476214647293091, gen p mean: -0.7346023321151733, mean p set: 0.4481017291545868The modified gen p mean: 0.44816482067108154, gen p mean: -0.73459392786026, mean p set: 0.44864511489868164
loss_pred:0.027017317712306976, decouple_loss:0.009742317721247673
loss_pred:0.026826201006770134, decouple_loss:0.009449532255530357
Iteration: 1762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480210542678833, gen p mean: -0.7360509037971497, mean p set: 0.4485013484954834
loss_pred:0.027199339121580124, decouple_loss:0.009926269762217999
The modified gen p mean: 0.4478556215763092, gen p mean: -0.7319668531417847, mean p set: 0.4483359158039093The modified gen p mean: 0.4478549659252167, gen p mean: -0.7347946166992188, mean p set: 0.448335200548172
loss_pred:0.02695995755493641, decouple_loss:0.009834282100200653
loss_pred:0.025994757190346718, decouple_loss:0.009497351944446564
Iteration: 1763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474068880081177, gen p mean: -0.7305399775505066, mean p set: 0.4478871822357178
The modified gen p mean: 0.448091596364975, gen p mean: -0.7320482730865479, mean p set: 0.44857192039489746
loss_pred:0.02820422686636448, decouple_loss:0.00926994252949953
loss_pred:0.0279645174741745, decouple_loss:0.009388426318764687
The modified gen p mean: 0.448758602142334, gen p mean: -0.7362945675849915, mean p set: 0.4492388963699341
loss_pred:0.026825210079550743, decouple_loss:0.009212106466293335
Iteration: 1764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810548424720764, gen p mean: -0.7384465336799622, mean p set: 0.44858577847480774
The modified gen p mean: 0.4470321238040924, gen p mean: -0.7361178994178772, mean p set: 0.4475124180316925
loss_pred:0.0268159881234169, decouple_loss:0.009137609042227268
loss_pred:0.027471978217363358, decouple_loss:0.009359444491565228
The modified gen p mean: 0.44616711139678955, gen p mean: -0.7371473908424377, mean p set: 0.44664737582206726
loss_pred:0.027757776901125908, decouple_loss:0.009604895487427711
Iteration: 1765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830819964408875, gen p mean: -0.729397714138031, mean p set: 0.44878846406936646
The modified gen p mean: 0.44800901412963867, gen p mean: -0.7287338376045227, mean p set: 0.44848933815956116
loss_pred:0.026443641632795334, decouple_loss:0.009215219877660275
loss_pred:0.02638409659266472, decouple_loss:0.009199137799441814
The modified gen p mean: 0.44676509499549866, gen p mean: -0.7337481379508972, mean p set: 0.44724538922309875
loss_pred:0.027912385761737823, decouple_loss:0.00910512637346983
Iteration: 1766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890785217285156, gen p mean: -0.7275907397270203, mean p set: 0.44938814640045166
The modified gen p mean: 0.44791847467422485, gen p mean: -0.7280001044273376, mean p set: 0.44839873909950256
loss_pred:0.02781819924712181, decouple_loss:0.00944270845502615
loss_pred:0.028069524094462395, decouple_loss:0.009113664738833904
The modified gen p mean: 0.44824522733688354, gen p mean: -0.7308810949325562, mean p set: 0.44872552156448364
loss_pred:0.027992788702249527, decouple_loss:0.009690777398645878
Iteration: 1767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481227993965149, gen p mean: -0.7316365242004395, mean p set: 0.448603093624115
The modified gen p mean: 0.4474121034145355, gen p mean: -0.7315999269485474, mean p set: 0.447892427444458
loss_pred:0.026976434513926506, decouple_loss:0.009371939115226269
loss_pred:0.027992019429802895, decouple_loss:0.00903289020061493
The modified gen p mean: 0.44781041145324707, gen p mean: -0.7287245988845825, mean p set: 0.44829073548316956
loss_pred:0.027700157836079597, decouple_loss:0.009180019609630108
Iteration: 1768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735920429229736, gen p mean: -0.7363854050636292, mean p set: 0.4478394687175751
loss_pred:0.027952993288636208, decouple_loss:0.009265413507819176
The modified gen p mean: 0.44733431935310364, gen p mean: -0.7316858768463135, mean p set: 0.44781461358070374The modified gen p mean: 0.44822442531585693, gen p mean: -0.7285493612289429, mean p set: 0.44870471954345703
loss_pred:0.0271700881421566, decouple_loss:0.009379252791404724
loss_pred:0.02796359173953533, decouple_loss:0.00897330604493618
Iteration: 1769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888076186180115, gen p mean: -0.7430101633071899, mean p set: 0.44936102628707886
loss_pred:0.026258140802383423, decouple_loss:0.009498176164925098
The modified gen p mean: 0.4478228688240051, gen p mean: -0.733220636844635, mean p set: 0.4483031630516052The modified gen p mean: 0.44816285371780396, gen p mean: -0.7346805334091187, mean p set: 0.44864311814308167
loss_pred:0.027392923831939697, decouple_loss:0.009238586761057377
loss_pred:0.026832295581698418, decouple_loss:0.009157774038612843
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783005118370056, gen p mean: -0.742367684841156, mean p set: 0.44831034541130066
loss_pred:0.02800605818629265, decouple_loss:0.009271771647036076
The modified gen p mean: 0.44823944568634033, gen p mean: -0.7346745729446411, mean p set: 0.44871973991394043The modified gen p mean: 0.4478135406970978, gen p mean: -0.7403362989425659, mean p set: 0.4482938349246979
loss_pred:0.02706991881132126, decouple_loss:0.00931106973439455
loss_pred:0.0273295808583498, decouple_loss:0.009249846450984478
2023-05-01 22:45:01 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7446911334991455, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7333731055259705, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7377454042434692, mean p set: 0.4500633478164673
loss_pred:0.02808517962694168, decouple_loss:0.009546135552227497
loss_pred:0.02672472782433033, decouple_loss:0.009375841356813908
loss_pred:0.027118446305394173, decouple_loss:0.009512364864349365
WV_0_PC_1_EH_0_PS_40_5, loss: 0.027783356606960297, avg_mse: 0.03277802839875221
current test mse: 0.032778
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 1771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971179962158203, gen p mean: -0.7313939929008484, mean p set: 0.45019209384918213
loss_pred:0.027824319899082184, decouple_loss:0.009397885762155056
The modified gen p mean: 0.44808343052864075, gen p mean: -0.7398150563240051, mean p set: 0.44856372475624084The modified gen p mean: 0.44897910952568054, gen p mean: -0.7408285737037659, mean p set: 0.44945937395095825
loss_pred:0.02740706503391266, decouple_loss:0.010054364800453186
loss_pred:0.0267738476395607, decouple_loss:0.010069530457258224
Iteration: 1772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474453926086426, gen p mean: -0.7323008179664612, mean p set: 0.4479256868362427
loss_pred:0.027758613228797913, decouple_loss:0.01061687059700489
The modified gen p mean: 0.44835829734802246, gen p mean: -0.7383903861045837, mean p set: 0.44883859157562256The modified gen p mean: 0.4481750428676605, gen p mean: -0.732671320438385, mean p set: 0.4486553370952606
loss_pred:0.027287814766168594, decouple_loss:0.009920375421643257
loss_pred:0.027216017246246338, decouple_loss:0.009752032347023487
Iteration: 1773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473377764225006, gen p mean: -0.7333804965019226, mean p set: 0.4478180706501007
loss_pred:0.027898544445633888, decouple_loss:0.010761507786810398
The modified gen p mean: 0.4485201835632324, gen p mean: -0.7370597124099731, mean p set: 0.44900044798851013The modified gen p mean: 0.4480079710483551, gen p mean: -0.7356177568435669, mean p set: 0.4484882652759552
loss_pred:0.02729736641049385, decouple_loss:0.010456142947077751
loss_pred:0.027371322736144066, decouple_loss:0.009718180634081364
Iteration: 1774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491414427757263, gen p mean: -0.734023928642273, mean p set: 0.4496217370033264
loss_pred:0.02711544558405876, decouple_loss:0.010187031701207161
The modified gen p mean: 0.44917911291122437, gen p mean: -0.7320423126220703, mean p set: 0.44965940713882446The modified gen p mean: 0.4484126567840576, gen p mean: -0.7343391180038452, mean p set: 0.4488929510116577
loss_pred:0.02691175602376461, decouple_loss:0.010081637650728226
loss_pred:0.027126286178827286, decouple_loss:0.00959799811244011
Iteration: 1775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489497244358063, gen p mean: -0.7271772027015686, mean p set: 0.449429988861084
loss_pred:0.027729125693440437, decouple_loss:0.010077415034174919
The modified gen p mean: 0.4491707384586334, gen p mean: -0.7358230352401733, mean p set: 0.4496510326862335The modified gen p mean: 0.4485749304294586, gen p mean: -0.7347321510314941, mean p set: 0.44905519485473633
loss_pred:0.028059590607881546, decouple_loss:0.009700409136712551
loss_pred:0.027945589274168015, decouple_loss:0.010666188783943653
Iteration: 1776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715598225593567, gen p mean: -0.7395268678665161, mean p set: 0.4476362466812134
loss_pred:0.028396394103765488, decouple_loss:0.010360394604504108
The modified gen p mean: 0.4477083086967468, gen p mean: -0.7338427305221558, mean p set: 0.4481886029243469The modified gen p mean: 0.4492274522781372, gen p mean: -0.7339780926704407, mean p set: 0.4497077465057373
loss_pred:0.027187172323465347, decouple_loss:0.009777951054275036
loss_pred:0.026910852640867233, decouple_loss:0.009601197205483913
Iteration: 1777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858604669570923, gen p mean: -0.7353987097740173, mean p set: 0.4490663409233093
loss_pred:0.027402102947235107, decouple_loss:0.009562475606799126
The modified gen p mean: 0.4479890763759613, gen p mean: -0.7311664819717407, mean p set: 0.448469340801239The modified gen p mean: 0.44840681552886963, gen p mean: -0.7345299124717712, mean p set: 0.4488871097564697
loss_pred:0.027341807261109352, decouple_loss:0.009799622930586338
loss_pred:0.027468685060739517, decouple_loss:0.009922419674694538
Iteration: 1778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792136549949646, gen p mean: -0.7226062417030334, mean p set: 0.44840162992477417
loss_pred:0.02748115174472332, decouple_loss:0.009740649722516537
The modified gen p mean: 0.44868406653404236, gen p mean: -0.7298370003700256, mean p set: 0.44916436076164246The modified gen p mean: 0.4487152397632599, gen p mean: -0.7229546904563904, mean p set: 0.44919553399086
loss_pred:0.026971623301506042, decouple_loss:0.009841328486800194
loss_pred:0.02823161706328392, decouple_loss:0.010045434348285198
Iteration: 1779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884926080703735, gen p mean: -0.7305278182029724, mean p set: 0.44932955503463745
The modified gen p mean: 0.4481826722621918, gen p mean: -0.7299082279205322, mean p set: 0.44866296648979187
loss_pred:0.028231138363480568, decouple_loss:0.009561538696289062
loss_pred:0.027945145964622498, decouple_loss:0.010373160243034363
The modified gen p mean: 0.44881996512413025, gen p mean: -0.7320414185523987, mean p set: 0.44930025935173035
loss_pred:0.026882514357566833, decouple_loss:0.00930690299719572
Iteration: 1780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488055408000946, gen p mean: -0.7349008917808533, mean p set: 0.4492858350276947
The modified gen p mean: 0.4478321671485901, gen p mean: -0.7324098944664001, mean p set: 0.4483124613761902
loss_pred:0.027526911348104477, decouple_loss:0.009363076649606228
loss_pred:0.026532525196671486, decouple_loss:0.00927013624459505
The modified gen p mean: 0.44782355427742004, gen p mean: -0.7329002022743225, mean p set: 0.44830384850502014
loss_pred:0.026418108493089676, decouple_loss:0.009202669374644756
2023-05-01 22:47:46 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7425339818000793, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.732861340045929, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7363946437835693, mean p set: 0.4500633478164673
loss_pred:0.028471490368247032, decouple_loss:0.00966646708548069
loss_pred:0.027006790041923523, decouple_loss:0.009840691462159157
loss_pred:0.027325395494699478, decouple_loss:0.009563355706632137
WV_0_PC_1_EH_0_PS_40_5, loss: 0.02808573469519615, avg_mse: 0.03320137411355972
current test mse: 0.033201
Iteration: 1781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786936044692993, gen p mean: -0.7334944605827332, mean p set: 0.44834965467453003
The modified gen p mean: 0.4476096034049988, gen p mean: -0.730531632900238, mean p set: 0.4480898678302765
loss_pred:0.027925049886107445, decouple_loss:0.009824804961681366
The modified gen p mean: 0.44877612590789795, gen p mean: -0.7342138886451721, mean p set: 0.44925642013549805
loss_pred:0.027456311509013176, decouple_loss:0.009751196019351482
loss_pred:0.02754073590040207, decouple_loss:0.009580180048942566
Iteration: 1782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501950442790985, gen p mean: -0.7321460843086243, mean p set: 0.4506753385066986
The modified gen p mean: 0.44895660877227783, gen p mean: -0.7340827584266663, mean p set: 0.44943690299987793loss_pred:0.02734730765223503, decouple_loss:0.009619513526558876
The modified gen p mean: 0.44877639412879944, gen p mean: -0.727737545967102, mean p set: 0.4492567181587219
loss_pred:0.026470964774489403, decouple_loss:0.009471291676163673
loss_pred:0.02714805118739605, decouple_loss:0.00969291478395462
Iteration: 1783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487597942352295, gen p mean: -0.7318710088729858, mean p set: 0.4492400586605072
The modified gen p mean: 0.4485883116722107, gen p mean: -0.7354463338851929, mean p set: 0.4490686058998108loss_pred:0.027839677408337593, decouple_loss:0.009465701878070831
The modified gen p mean: 0.4484230577945709, gen p mean: -0.7308944463729858, mean p set: 0.4489034116268158
loss_pred:0.027932947501540184, decouple_loss:0.009399665519595146
loss_pred:0.026687920093536377, decouple_loss:0.009404790587723255
Iteration: 1784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499695599079132, gen p mean: -0.7301704287528992, mean p set: 0.4504498541355133
loss_pred:0.027636293321847916, decouple_loss:0.009564940817654133
The modified gen p mean: 0.44882193207740784, gen p mean: -0.7274617552757263, mean p set: 0.44930222630500793The modified gen p mean: 0.4486697316169739, gen p mean: -0.7348986268043518, mean p set: 0.449150025844574
loss_pred:0.027507692575454712, decouple_loss:0.009723328053951263
loss_pred:0.027272578328847885, decouple_loss:0.009632034227252007
Iteration: 1785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494444727897644, gen p mean: -0.7380223870277405, mean p set: 0.4499247372150421
loss_pred:0.026396369561553, decouple_loss:0.009111533872783184
The modified gen p mean: 0.4480856657028198, gen p mean: -0.735309898853302, mean p set: 0.4485659599304199The modified gen p mean: 0.448161780834198, gen p mean: -0.7329788208007812, mean p set: 0.4486420452594757
loss_pred:0.027944456785917282, decouple_loss:0.009490517899394035
loss_pred:0.027146296575665474, decouple_loss:0.010261764749884605
Iteration: 1786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44923076033592224, gen p mean: -0.7458373308181763, mean p set: 0.44971105456352234
loss_pred:0.027516068890690804, decouple_loss:0.009612116031348705
The modified gen p mean: 0.4474776089191437, gen p mean: -0.742480993270874, mean p set: 0.4479579031467438The modified gen p mean: 0.44849705696105957, gen p mean: -0.7466467618942261, mean p set: 0.44897738099098206
loss_pred:0.0269774217158556, decouple_loss:0.009973154403269291
loss_pred:0.02704252302646637, decouple_loss:0.009307090193033218
Iteration: 1787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497270882129669, gen p mean: -0.7493017315864563, mean p set: 0.450207382440567
loss_pred:0.02684290148317814, decouple_loss:0.009407955221831799
The modified gen p mean: 0.4484025537967682, gen p mean: -0.7484405040740967, mean p set: 0.4488828480243683The modified gen p mean: 0.4479455053806305, gen p mean: -0.7500303387641907, mean p set: 0.4484257698059082
loss_pred:0.027306409552693367, decouple_loss:0.01008387841284275
loss_pred:0.026804212480783463, decouple_loss:0.009466866962611675
Iteration: 1788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761672616004944, gen p mean: -0.7462838292121887, mean p set: 0.4480970501899719
loss_pred:0.026625365018844604, decouple_loss:0.009506908245384693
The modified gen p mean: 0.44945159554481506, gen p mean: -0.7434983253479004, mean p set: 0.44993188977241516The modified gen p mean: 0.4476868510246277, gen p mean: -0.739657461643219, mean p set: 0.4481671154499054
loss_pred:0.026794755831360817, decouple_loss:0.009625634178519249
loss_pred:0.027272991836071014, decouple_loss:0.009295934811234474
Iteration: 1789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448650598526001, gen p mean: -0.7402970790863037, mean p set: 0.44913092255592346
loss_pred:0.026739943772554398, decouple_loss:0.009300312958657742
The modified gen p mean: 0.44944050908088684, gen p mean: -0.7397128939628601, mean p set: 0.44992080330848694The modified gen p mean: 0.44793662428855896, gen p mean: -0.7457616925239563, mean p set: 0.44841691851615906
loss_pred:0.026220936328172684, decouple_loss:0.00939873792231083
loss_pred:0.028096597641706467, decouple_loss:0.009570535272359848
Iteration: 1790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483506977558136, gen p mean: -0.7437949180603027, mean p set: 0.4488309919834137
loss_pred:0.027776222676038742, decouple_loss:0.009045103564858437
The modified gen p mean: 0.44784510135650635, gen p mean: -0.7429601550102234, mean p set: 0.44832542538642883The modified gen p mean: 0.4485422968864441, gen p mean: -0.7415381073951721, mean p set: 0.4490225911140442
loss_pred:0.026985546573996544, decouple_loss:0.009675942361354828
loss_pred:0.027036471292376518, decouple_loss:0.008987055160105228
2023-05-01 22:49:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.7504024505615234, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7402108907699585, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7437067627906799, mean p set: 0.4500633478164673
loss_pred:0.028180208057165146, decouple_loss:0.009533977136015892
loss_pred:0.026788584887981415, decouple_loss:0.009299002587795258
loss_pred:0.027114614844322205, decouple_loss:0.009289922192692757
WV_0_PC_1_EH_0_PS_40_5, loss: 0.0278298519551754, avg_mse: 0.032854657620191574
current test mse: 0.032855
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 1791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772204756736755, gen p mean: -0.7368276119232178, mean p set: 0.44820234179496765
loss_pred:0.027844011783599854, decouple_loss:0.009125697426497936
The modified gen p mean: 0.44680145382881165, gen p mean: -0.742293655872345, mean p set: 0.44728177785873413The modified gen p mean: 0.4490155577659607, gen p mean: -0.7474473118782043, mean p set: 0.4494958221912384
loss_pred:0.02801710180938244, decouple_loss:0.00982571765780449
loss_pred:0.027617253363132477, decouple_loss:0.010138574056327343
Iteration: 1792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480094313621521, gen p mean: -0.7338537573814392, mean p set: 0.4484897553920746
loss_pred:0.02786068432033062, decouple_loss:0.010076147504150867
The modified gen p mean: 0.44690871238708496, gen p mean: -0.7328453063964844, mean p set: 0.44738900661468506The modified gen p mean: 0.4468767046928406, gen p mean: -0.7317512035369873, mean p set: 0.4473569989204407
loss_pred:0.027207499369978905, decouple_loss:0.009587482549250126
loss_pred:0.027018986642360687, decouple_loss:0.00958806462585926
Iteration: 1793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477772116661072, gen p mean: -0.7355536222457886, mean p set: 0.4482575058937073
loss_pred:0.028230438008904457, decouple_loss:0.009987370111048222
The modified gen p mean: 0.4472801983356476, gen p mean: -0.7265753746032715, mean p set: 0.4477604627609253The modified gen p mean: 0.4484936594963074, gen p mean: -0.7346790432929993, mean p set: 0.44897395372390747
loss_pred:0.02770211361348629, decouple_loss:0.009521524421870708
loss_pred:0.02789132297039032, decouple_loss:0.009719537571072578
Iteration: 1794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474845826625824, gen p mean: -0.7265156507492065, mean p set: 0.4479648470878601
loss_pred:0.02777368202805519, decouple_loss:0.008843732997775078
The modified gen p mean: 0.4476257562637329, gen p mean: -0.7316993474960327, mean p set: 0.4481060206890106The modified gen p mean: 0.44629180431365967, gen p mean: -0.7330060005187988, mean p set: 0.44677209854125977
loss_pred:0.028437672182917595, decouple_loss:0.009284663014113903
loss_pred:0.027816208079457283, decouple_loss:0.010000561363995075
Iteration: 1795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842371344566345, gen p mean: -0.7372555732727051, mean p set: 0.44890403747558594
loss_pred:0.02723431959748268, decouple_loss:0.009475326165556908
The modified gen p mean: 0.4463586211204529, gen p mean: -0.7347392439842224, mean p set: 0.4468388855457306The modified gen p mean: 0.4468589127063751, gen p mean: -0.7316877841949463, mean p set: 0.44733917713165283
loss_pred:0.0277087539434433, decouple_loss:0.009979428723454475
loss_pred:0.027871113270521164, decouple_loss:0.00947447121143341
Iteration: 1796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44765305519104004, gen p mean: -0.733953058719635, mean p set: 0.44813334941864014
loss_pred:0.027571549639105797, decouple_loss:0.009661383926868439
The modified gen p mean: 0.44703513383865356, gen p mean: -0.7245122790336609, mean p set: 0.44751542806625366The modified gen p mean: 0.4475826323032379, gen p mean: -0.7344351410865784, mean p set: 0.4480628967285156
loss_pred:0.02779850736260414, decouple_loss:0.009263981133699417
loss_pred:0.02719341218471527, decouple_loss:0.009347574785351753
Iteration: 1797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44941359758377075, gen p mean: -0.7321251034736633, mean p set: 0.44989389181137085
loss_pred:0.027232211083173752, decouple_loss:0.009801570326089859
The modified gen p mean: 0.4469491243362427, gen p mean: -0.7232875227928162, mean p set: 0.4474294185638428The modified gen p mean: 0.4470483064651489, gen p mean: -0.727111279964447, mean p set: 0.44752857089042664
loss_pred:0.026567554101347923, decouple_loss:0.009200959466397762
loss_pred:0.028178445994853973, decouple_loss:0.009729164652526379
Iteration: 1798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466017484664917, gen p mean: -0.7287006378173828, mean p set: 0.4470820426940918
loss_pred:0.02682024985551834, decouple_loss:0.009649142622947693
The modified gen p mean: 0.44696342945098877, gen p mean: -0.7283924221992493, mean p set: 0.44744372367858887The modified gen p mean: 0.4468850791454315, gen p mean: -0.7321207523345947, mean p set: 0.44736534357070923
loss_pred:0.027986939996480942, decouple_loss:0.00978524424135685
loss_pred:0.027497561648488045, decouple_loss:0.009231321513652802
Iteration: 1799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801685214042664, gen p mean: -0.7425609230995178, mean p set: 0.4484971761703491
loss_pred:0.026894602924585342, decouple_loss:0.009390149265527725
The modified gen p mean: 0.4473516047000885, gen p mean: -0.7353898286819458, mean p set: 0.4478318989276886The modified gen p mean: 0.4466681480407715, gen p mean: -0.7343310117721558, mean p set: 0.4471484422683716
loss_pred:0.028867540881037712, decouple_loss:0.009357617236673832
loss_pred:0.02753586135804653, decouple_loss:0.009381200186908245
Iteration: 1800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481349587440491, gen p mean: -0.7326620817184448, mean p set: 0.44861525297164917
loss_pred:0.028269294649362564, decouple_loss:0.009065672755241394
The modified gen p mean: 0.4475051462650299, gen p mean: -0.727114200592041, mean p set: 0.44798544049263The modified gen p mean: 0.44755110144615173, gen p mean: -0.7254170775413513, mean p set: 0.44803139567375183
loss_pred:0.027867885306477547, decouple_loss:0.009161337278783321
loss_pred:0.02812454290688038, decouple_loss:0.008974043652415276
2023-05-01 22:52:40 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.743730902671814, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7375339269638062, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7343008518218994, mean p set: 0.45035696029663086
loss_pred:0.02818058244884014, decouple_loss:0.009466703981161118
loss_pred:0.027196750044822693, decouple_loss:0.009085575118660927
loss_pred:0.026767408475279808, decouple_loss:0.009116138331592083
WV_0_PC_1_EH_0_PS_40_5, loss: 0.027842720970511436, avg_mse: 0.03294036164879799
current test mse: 0.03294
Iteration: 1801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960805773735046, gen p mean: -0.7389028072357178, mean p set: 0.4500883221626282
loss_pred:0.026769835501909256, decouple_loss:0.009289951995015144
The modified gen p mean: 0.44759416580200195, gen p mean: -0.7399146556854248, mean p set: 0.44807443022727966
The modified gen p mean: 0.4476301968097687, gen p mean: -0.7403703927993774, mean p set: 0.4481104910373688
loss_pred:0.02675020508468151, decouple_loss:0.008936680853366852
loss_pred:0.027034591883420944, decouple_loss:0.008959600701928139
Iteration: 1802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466789960861206, gen p mean: -0.7342482805252075, mean p set: 0.4471592903137207
loss_pred:0.02705526351928711, decouple_loss:0.00946042686700821
The modified gen p mean: 0.4477654695510864, gen p mean: -0.7414790987968445, mean p set: 0.4482457637786865The modified gen p mean: 0.44798144698143005, gen p mean: -0.7353491187095642, mean p set: 0.44846174120903015
loss_pred:0.027126435190439224, decouple_loss:0.008909318596124649
loss_pred:0.02736387588083744, decouple_loss:0.009177369996905327
Iteration: 1803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666460156440735, gen p mean: -0.733880877494812, mean p set: 0.44714486598968506
loss_pred:0.026933033019304276, decouple_loss:0.009258442558348179
The modified gen p mean: 0.4469279646873474, gen p mean: -0.7304445505142212, mean p set: 0.4474082589149475The modified gen p mean: 0.4464671313762665, gen p mean: -0.7353684902191162, mean p set: 0.4469473958015442
loss_pred:0.027836687862873077, decouple_loss:0.009461578913033009
loss_pred:0.028743373230099678, decouple_loss:0.00931363645941019
Iteration: 1804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483056962490082, gen p mean: -0.7311538457870483, mean p set: 0.4487859904766083
loss_pred:0.027205826714634895, decouple_loss:0.009143039584159851
The modified gen p mean: 0.44754254817962646, gen p mean: -0.7256399989128113, mean p set: 0.44802284240722656The modified gen p mean: 0.44705286622047424, gen p mean: -0.7249563932418823, mean p set: 0.44753316044807434
loss_pred:0.028059668838977814, decouple_loss:0.009462825022637844
loss_pred:0.028454452753067017, decouple_loss:0.009579522535204887
Iteration: 1805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486178457736969, gen p mean: -0.7278182506561279, mean p set: 0.449098140001297
loss_pred:0.028121737763285637, decouple_loss:0.009341174736618996
The modified gen p mean: 0.44689783453941345, gen p mean: -0.7153714299201965, mean p set: 0.44737815856933594The modified gen p mean: 0.4483170211315155, gen p mean: -0.7290111184120178, mean p set: 0.448797345161438
loss_pred:0.027492010965943336, decouple_loss:0.008889727294445038
loss_pred:0.028120677918195724, decouple_loss:0.009338703006505966
Iteration: 1806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482465088367462, gen p mean: -0.7262668609619141, mean p set: 0.4487267732620239
loss_pred:0.027560563758015633, decouple_loss:0.008985606022179127
The modified gen p mean: 0.4476337432861328, gen p mean: -0.7305702567100525, mean p set: 0.4481140077114105The modified gen p mean: 0.4492481052875519, gen p mean: -0.7275677919387817, mean p set: 0.4497283697128296
loss_pred:0.026811998337507248, decouple_loss:0.00899439211934805
loss_pred:0.027024077251553535, decouple_loss:0.00896020419895649
Iteration: 1807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446621298789978, gen p mean: -0.7278711795806885, mean p set: 0.4471015930175781
loss_pred:0.029135318472981453, decouple_loss:0.010043459013104439
The modified gen p mean: 0.4473802447319031, gen p mean: -0.7240976095199585, mean p set: 0.4478605389595032The modified gen p mean: 0.44651758670806885, gen p mean: -0.7296819090843201, mean p set: 0.44699788093566895
loss_pred:0.028579354286193848, decouple_loss:0.00922284834086895
loss_pred:0.027529029175639153, decouple_loss:0.01020296011120081
Iteration: 1808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464806616306305, gen p mean: -0.7368101477622986, mean p set: 0.4469609558582306
loss_pred:0.026982402428984642, decouple_loss:0.008958038873970509
The modified gen p mean: 0.4469186067581177, gen p mean: -0.730440080165863, mean p set: 0.4473989009857178The modified gen p mean: 0.44723808765411377, gen p mean: -0.7281693816184998, mean p set: 0.4477183520793915
loss_pred:0.028790345415472984, decouple_loss:0.008731435984373093
loss_pred:0.028198624029755592, decouple_loss:0.008899255655705929
Iteration: 1809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471610486507416, gen p mean: -0.7283288240432739, mean p set: 0.4476413428783417
loss_pred:0.027722831815481186, decouple_loss:0.00890928041189909
The modified gen p mean: 0.44655951857566833, gen p mean: -0.7344161868095398, mean p set: 0.44703981280326843The modified gen p mean: 0.44851794838905334, gen p mean: -0.7308294773101807, mean p set: 0.44899824261665344
loss_pred:0.02739528752863407, decouple_loss:0.008722342550754547
loss_pred:0.028419168666005135, decouple_loss:0.009034753777086735
Iteration: 1810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463418126106262, gen p mean: -0.7305427193641663, mean p set: 0.4468221068382263
loss_pred:0.026974471285939217, decouple_loss:0.009856012649834156
The modified gen p mean: 0.4484513998031616, gen p mean: -0.7297422289848328, mean p set: 0.4489316940307617The modified gen p mean: 0.4468691945075989, gen p mean: -0.7305853366851807, mean p set: 0.4473494589328766
loss_pred:0.02731500379741192, decouple_loss:0.009021333418786526
loss_pred:0.029271647334098816, decouple_loss:0.0092907240614295
2023-05-01 22:54:49 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.739797830581665, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7293404936790466, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830833911896, gen p mean: -0.7333275675773621, mean p set: 0.4500633478164673
loss_pred:0.028130782768130302, decouple_loss:0.009617265313863754
loss_pred:0.026722494512796402, decouple_loss:0.0091305673122406
loss_pred:0.02698255516588688, decouple_loss:0.009362975135445595
WV_0_PC_1_EH_0_PS_40_5, loss: 0.027747124433517456, avg_mse: 0.03281118720769882
current test mse: 0.032811
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 1811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663873314857483, gen p mean: -0.7388421297073364, mean p set: 0.4471190571784973
loss_pred:0.026467101648449898, decouple_loss:0.00920548103749752
The modified gen p mean: 0.44735249876976013, gen p mean: -0.7384482026100159, mean p set: 0.44783279299736023The modified gen p mean: 0.448159784078598, gen p mean: -0.7360838055610657, mean p set: 0.44864004850387573
loss_pred:0.02772224135696888, decouple_loss:0.01010038610547781
loss_pred:0.026956379413604736, decouple_loss:0.009809774346649647
Iteration: 1812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844362139701843, gen p mean: -0.7374345064163208, mean p set: 0.44892388582229614
loss_pred:0.028451841324567795, decouple_loss:0.009622396901249886
The modified gen p mean: 0.4473969042301178, gen p mean: -0.7359944581985474, mean p set: 0.44787725806236267The modified gen p mean: 0.44630926847457886, gen p mean: -0.7344135046005249, mean p set: 0.44678959250450134
loss_pred:0.02756578102707863, decouple_loss:0.009246665984392166
loss_pred:0.026620235294103622, decouple_loss:0.009697784669697285
Iteration: 1813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461483955383301, gen p mean: -0.7340353727340698, mean p set: 0.4466286599636078
loss_pred:0.026325859129428864, decouple_loss:0.009892954491078854
The modified gen p mean: 0.44692403078079224, gen p mean: -0.7386276125907898, mean p set: 0.44740432500839233The modified gen p mean: 0.44655048847198486, gen p mean: -0.7360326647758484, mean p set: 0.44703078269958496
loss_pred:0.026369808241724968, decouple_loss:0.009089597500860691
loss_pred:0.02720264345407486, decouple_loss:0.009572475217282772
Iteration: 1814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661250710487366, gen p mean: -0.7388074398040771, mean p set: 0.44709280133247375
loss_pred:0.026870127767324448, decouple_loss:0.009314821101725101
The modified gen p mean: 0.4470798075199127, gen p mean: -0.741866946220398, mean p set: 0.4475601017475128The modified gen p mean: 0.446891725063324, gen p mean: -0.738647997379303, mean p set: 0.4473719894886017
loss_pred:0.027423491701483727, decouple_loss:0.009346879087388515
loss_pred:0.027094438672065735, decouple_loss:0.008866151794791222
Iteration: 1815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641056656837463, gen p mean: -0.747088611125946, mean p set: 0.4468908905982971
loss_pred:0.026464365422725677, decouple_loss:0.008700132369995117
The modified gen p mean: 0.44781818985939026, gen p mean: -0.7487461566925049, mean p set: 0.44829845428466797The modified gen p mean: 0.44768601655960083, gen p mean: -0.7423298358917236, mean p set: 0.4481663107872009
loss_pred:0.02624427154660225, decouple_loss:0.00873569492250681
loss_pred:0.027226192876696587, decouple_loss:0.009109037928283215
Iteration: 1816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458523094654083, gen p mean: -0.7464946508407593, mean p set: 0.4463326036930084
loss_pred:0.025777628645300865, decouple_loss:0.008933885022997856
The modified gen p mean: 0.44645535945892334, gen p mean: -0.7500380277633667, mean p set: 0.44693562388420105The modified gen p mean: 0.44925034046173096, gen p mean: -0.7475376129150391, mean p set: 0.44973060488700867
loss_pred:0.026295166462659836, decouple_loss:0.009852249175310135
loss_pred:0.026543481275439262, decouple_loss:0.009749106131494045
Iteration: 1817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839704036712646, gen p mean: -0.73871910572052, mean p set: 0.44887736439704895
loss_pred:0.027107231318950653, decouple_loss:0.008915204554796219
The modified gen p mean: 0.44876816868782043, gen p mean: -0.7405110597610474, mean p set: 0.44924843311309814The modified gen p mean: 0.44729194045066833, gen p mean: -0.7411760687828064, mean p set: 0.44777220487594604
loss_pred:0.02638573944568634, decouple_loss:0.0091580580919981
loss_pred:0.02660953253507614, decouple_loss:0.00940650049597025
Iteration: 1818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717806577682495, gen p mean: -0.7386910915374756, mean p set: 0.44765836000442505
loss_pred:0.026921087875962257, decouple_loss:0.009141531772911549
The modified gen p mean: 0.44827088713645935, gen p mean: -0.7388474345207214, mean p set: 0.44875115156173706The modified gen p mean: 0.4487743079662323, gen p mean: -0.7392430901527405, mean p set: 0.4492546021938324
loss_pred:0.026133866980671883, decouple_loss:0.00881857331842184
loss_pred:0.027471499517560005, decouple_loss:0.009379331953823566
Iteration: 1819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44697317481040955, gen p mean: -0.7395896911621094, mean p set: 0.44745346903800964
loss_pred:0.027497870847582817, decouple_loss:0.009188061580061913
The modified gen p mean: 0.44633227586746216, gen p mean: -0.7470843195915222, mean p set: 0.44681257009506226The modified gen p mean: 0.4469894468784332, gen p mean: -0.7501460909843445, mean p set: 0.4474697411060333
loss_pred:0.026309432461857796, decouple_loss:0.009309126064181328
loss_pred:0.026188792660832405, decouple_loss:0.009072402492165565
Iteration: 1820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670215249061584, gen p mean: -0.7567082643508911, mean p set: 0.44718244671821594
The modified gen p mean: 0.4466509521007538, gen p mean: -0.7563439011573792, mean p set: 0.4471312463283539
loss_pred:0.026213621720671654, decouple_loss:0.009066830389201641
loss_pred:0.02608145959675312, decouple_loss:0.009254264645278454
The modified gen p mean: 0.4466874897480011, gen p mean: -0.7516846060752869, mean p set: 0.4471677839756012
loss_pred:0.026454897597432137, decouple_loss:0.00935811921954155
2023-05-01 22:57:32 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7572829723358154, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7504739761352539, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7462693452835083, mean p set: 0.45035696029663086
loss_pred:0.028039095923304558, decouple_loss:0.009390248917043209
loss_pred:0.026937587186694145, decouple_loss:0.008972078561782837loss_pred:0.026700085029006004, decouple_loss:0.009159698151051998
WV_0_PC_1_EH_0_PS_40_5, loss: 0.0276842899620533, avg_mse: 0.032764922827482224
current test mse: 0.032765
Iteration: 1821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827795028686523, gen p mean: -0.7539437413215637, mean p set: 0.44875821471214294
loss_pred:0.027845928445458412, decouple_loss:0.008970491588115692
The modified gen p mean: 0.44691744446754456, gen p mean: -0.7581637501716614, mean p set: 0.44739779829978943The modified gen p mean: 0.4454604387283325, gen p mean: -0.753365159034729, mean p set: 0.44594070315361023
loss_pred:0.0257502980530262, decouple_loss:0.008893240243196487
loss_pred:0.02671484462916851, decouple_loss:0.009272858500480652
Iteration: 1822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737595319747925, gen p mean: -0.7440809607505798, mean p set: 0.44785624742507935
The modified gen p mean: 0.4471036195755005, gen p mean: -0.7505635023117065, mean p set: 0.4475838840007782
loss_pred:0.02591189369559288, decouple_loss:0.008586429059505463
loss_pred:0.026377493515610695, decouple_loss:0.008894471451640129
The modified gen p mean: 0.4473675787448883, gen p mean: -0.7480959296226501, mean p set: 0.4478478729724884
loss_pred:0.0262198057025671, decouple_loss:0.0085757402703166
Iteration: 1823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446512371301651, gen p mean: -0.7412458062171936, mean p set: 0.4469926357269287
The modified gen p mean: 0.4475764036178589, gen p mean: -0.747079610824585, mean p set: 0.448056697845459
loss_pred:0.027484595775604248, decouple_loss:0.008902675472199917
loss_pred:0.026295674964785576, decouple_loss:0.009211836382746696
The modified gen p mean: 0.446135550737381, gen p mean: -0.7389232516288757, mean p set: 0.4466158449649811
loss_pred:0.025993458926677704, decouple_loss:0.00887804850935936
Iteration: 1824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476753771305084, gen p mean: -0.7450234889984131, mean p set: 0.4481556713581085
The modified gen p mean: 0.4465046525001526, gen p mean: -0.7418867349624634, mean p set: 0.4469849467277527
loss_pred:0.02632961794734001, decouple_loss:0.0088733471930027
loss_pred:0.025840379297733307, decouple_loss:0.008635117672383785
The modified gen p mean: 0.44738298654556274, gen p mean: -0.7463005185127258, mean p set: 0.44786328077316284
loss_pred:0.025778062641620636, decouple_loss:0.008646395988762379
Iteration: 1825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786641001701355, gen p mean: -0.7436388731002808, mean p set: 0.44834670424461365
loss_pred:0.026833485811948776, decouple_loss:0.008691619150340557
The modified gen p mean: 0.4455268383026123, gen p mean: -0.7423200011253357, mean p set: 0.44600710272789The modified gen p mean: 0.4480457603931427, gen p mean: -0.7458871006965637, mean p set: 0.4485260546207428
loss_pred:0.027197163552045822, decouple_loss:0.008636226877570152
loss_pred:0.027343876659870148, decouple_loss:0.009193801321089268
Iteration: 1826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467405080795288, gen p mean: -0.7435107827186584, mean p set: 0.4472208023071289
loss_pred:0.02614735998213291, decouple_loss:0.008568262681365013
The modified gen p mean: 0.44714266061782837, gen p mean: -0.7467848062515259, mean p set: 0.44762295484542847The modified gen p mean: 0.447029709815979, gen p mean: -0.7448336482048035, mean p set: 0.4475100040435791
loss_pred:0.02656836248934269, decouple_loss:0.008630518801510334
loss_pred:0.02590751461684704, decouple_loss:0.00856295507401228
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644027948379517, gen p mean: -0.742604672908783, mean p set: 0.44692057371139526
The modified gen p mean: 0.4468054473400116, gen p mean: -0.7406731247901917, mean p set: 0.4472857117652893
loss_pred:0.02697071246802807, decouple_loss:0.008790092542767525
loss_pred:0.026029108092188835, decouple_loss:0.008502814918756485
The modified gen p mean: 0.44701990485191345, gen p mean: -0.7371142506599426, mean p set: 0.44750016927719116
loss_pred:0.027499372139573097, decouple_loss:0.008559421636164188
Iteration: 1828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797658920288086, gen p mean: -0.7392046451568604, mean p set: 0.44845691323280334
loss_pred:0.0272792037576437, decouple_loss:0.008563683368265629
The modified gen p mean: 0.44655150175094604, gen p mean: -0.7357559204101562, mean p set: 0.4470318555831909The modified gen p mean: 0.4470362365245819, gen p mean: -0.7347662448883057, mean p set: 0.447516530752182
loss_pred:0.02603781595826149, decouple_loss:0.008359119296073914
loss_pred:0.027461981400847435, decouple_loss:0.00885443389415741
Iteration: 1829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44916796684265137, gen p mean: -0.7457621097564697, mean p set: 0.44964826107025146
loss_pred:0.02591691166162491, decouple_loss:0.008629919029772282
The modified gen p mean: 0.4474863111972809, gen p mean: -0.7444886565208435, mean p set: 0.447966605424881
The modified gen p mean: 0.447533518075943, gen p mean: -0.7415890693664551, mean p set: 0.4480137526988983
loss_pred:0.026363961398601532, decouple_loss:0.008448834531009197
loss_pred:0.02576267160475254, decouple_loss:0.008664283901453018
Iteration: 1830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44767144322395325, gen p mean: -0.7480100989341736, mean p set: 0.44815176725387573
The modified gen p mean: 0.4478625953197479, gen p mean: -0.7507926821708679, mean p set: 0.44834285974502563
loss_pred:0.026107896119356155, decouple_loss:0.008523816242814064
loss_pred:0.026630964130163193, decouple_loss:0.008941760286688805
The modified gen p mean: 0.4455258548259735, gen p mean: -0.7463893294334412, mean p set: 0.4460061490535736
loss_pred:0.02633597142994404, decouple_loss:0.008732913061976433
2023-05-01 22:59:41 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.7482632994651794, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.7377052903175354, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.7418927550315857, mean p set: 0.4500633478164673
loss_pred:0.027863942086696625, decouple_loss:0.008938898332417011
loss_pred:0.02654077485203743, decouple_loss:0.008806644938886166
loss_pred:0.026766762137413025, decouple_loss:0.008689780719578266
WV_0_PC_1_EH_0_PS_40_5, loss: 0.027497749775648117, avg_mse: 0.03251533955335617
current test mse: 0.032515
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 349, in <module>
    train_wrapper(model)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 259, in train_wrapper
    train_input_handle = datasets_factory.data_provider(
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/datasets_factory.py", line 48, in data_provider
    train_input_handle = datasets_map[dataset_name].InputHandle(train_input_param)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 26, in __init__
    self.load()
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 31, in load
    self.data['clips'] = dat_1['clips']
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/numpy/lib/npyio.py", line 260, in __getitem__
    raise KeyError("%s is not a file in the archive" % key)
KeyError: 'clips is not a file in the archive'