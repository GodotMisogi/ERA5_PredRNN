/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 124
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: -0.0006798162939958274, gen p mean: 0.0, mean p set: 0.45071205496788025
loss_pred:0.22796630859375, decouple_loss:0.05103714019060135
The modified gen p mean: -0.0005473490455187857, gen p mean: 0.0, mean p set: 0.4537885785102844
loss_pred:0.2335502952337265, decouple_loss:0.05155783146619797
The modified gen p mean: -0.00043707643635571003, gen p mean: 0.0, mean p set: 0.4502233564853668
loss_pred:0.22805742919445038, decouple_loss:0.05105504021048546
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: -0.0020489240996539593, gen p mean: 0.0, mean p set: 0.4526490569114685
The modified gen p mean: -0.001901363953948021, gen p mean: 0.0, mean p set: 0.4490962028503418
The modified gen p mean: -0.001916292356327176, gen p mean: 0.0, mean p set: 0.4508603513240814
loss_pred:0.23580904304981232, decouple_loss:0.1623528152704239
loss_pred:0.2281723916530609, decouple_loss:0.16144636273384094
loss_pred:0.2316352128982544, decouple_loss:0.16196392476558685
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.01215472724288702, gen p mean: 0.0, mean p set: 0.44989991188049316
The modified gen p mean: 0.011888761073350906, gen p mean: 0.0, mean p set: 0.4519580006599426
loss_pred:0.223580464720726, decouple_loss:0.2802943289279938
loss_pred:0.225217804312706, decouple_loss:0.28316694498062134The modified gen p mean: 0.011986234225332737, gen p mean: 0.0, mean p set: 0.44979190826416016
loss_pred:0.22300909459590912, decouple_loss:0.28075459599494934
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.026929842308163643, gen p mean: 0.0, mean p set: 0.4499586224555969
The modified gen p mean: 0.026980537921190262, gen p mean: 0.0, mean p set: 0.4497922658920288
The modified gen p mean: 0.02689555287361145, gen p mean: 0.0, mean p set: 0.4503673017024994
loss_pred:0.21495816111564636, decouple_loss:0.4128302037715912
loss_pred:0.2130928337574005, decouple_loss:0.40848252177238464
loss_pred:0.2084411084651947, decouple_loss:0.4119625389575958
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.0327414944767952, gen p mean: 0.0, mean p set: 0.44957631826400757
The modified gen p mean: 0.03278104215860367, gen p mean: 0.0, mean p set: 0.4498359262943268
The modified gen p mean: 0.03268662095069885, gen p mean: 0.0, mean p set: 0.45193424820899963
loss_pred:0.20537790656089783, decouple_loss:0.3702433109283447
loss_pred:0.1993693709373474, decouple_loss:0.36931565403938293
loss_pred:0.20389972627162933, decouple_loss:0.3706568479537964
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.042156703770160675, gen p mean: 0.0, mean p set: 0.4530515968799591
The modified gen p mean: 0.0421585775911808, gen p mean: 0.0, mean p set: 0.4504907429218292
The modified gen p mean: 0.042196597903966904, gen p mean: 0.0, mean p set: 0.4503108859062195
loss_pred:0.19906330108642578, decouple_loss:0.4147409200668335
loss_pred:0.19676485657691956, decouple_loss:0.4122549593448639
loss_pred:0.1922277808189392, decouple_loss:0.41336941719055176
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.04989280924201012, gen p mean: 0.0, mean p set: 0.4508640468120575
The modified gen p mean: 0.049802329391241074, gen p mean: 0.0, mean p set: 0.45002463459968567
The modified gen p mean: 0.0497918576002121, gen p mean: 0.0, mean p set: 0.45169559121131897
loss_pred:0.1868228316307068, decouple_loss:0.3658367097377777
loss_pred:0.1887335628271103, decouple_loss:0.36309802532196045
loss_pred:0.19042302668094635, decouple_loss:0.36472514271736145
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.05895701050758362, gen p mean: 0.0, mean p set: 0.4501486122608185
The modified gen p mean: 0.05888991802930832, gen p mean: 0.0, mean p set: 0.44917601346969604
The modified gen p mean: 0.05893687531352043, gen p mean: 0.0, mean p set: 0.4514475464820862
loss_pred:0.18382273614406586, decouple_loss:0.32037606835365295
loss_pred:0.18254169821739197, decouple_loss:0.3239734172821045
loss_pred:0.18273793160915375, decouple_loss:0.32420629262924194
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.06968341767787933, gen p mean: 0.0, mean p set: 0.4505055248737335
The modified gen p mean: 0.06964831799268723, gen p mean: 0.0, mean p set: 0.4506552517414093
The modified gen p mean: 0.06961171329021454, gen p mean: 0.0, mean p set: 0.4507634937763214
loss_pred:0.1737910956144333, decouple_loss:0.34323665499687195
loss_pred:0.18177147209644318, decouple_loss:0.34158557653427124
loss_pred:0.17954662442207336, decouple_loss:0.3439619243144989
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.07763391733169556, gen p mean: 0.0, mean p set: 0.45137903094291687
The modified gen p mean: 0.07756422460079193, gen p mean: 0.0, mean p set: 0.45078805088996887
The modified gen p mean: 0.07767199724912643, gen p mean: 0.0, mean p set: 0.4490193724632263
loss_pred:0.1745932549238205, decouple_loss:0.31238609552383423
loss_pred:0.17626146972179413, decouple_loss:0.3122890591621399
loss_pred:0.18063361942768097, decouple_loss:0.31470754742622375
2023-05-02 14:23:44 testing...
The modified gen p mean: 0.08621326088905334, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.0862254947423935, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.0862053781747818, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.17496258020401, decouple_loss:0.2682254910469055
loss_pred:0.17620469629764557, decouple_loss:0.2697058618068695
loss_pred:0.17593884468078613, decouple_loss:0.26867586374282837
WV_0_PC_0_EH_0_PS_40_6, loss: 0.1891455054283142, avg_mse: 0.17495739459991455
current test mse: 0.174957
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.0863114446401596, gen p mean: 0.0, mean p set: 0.4486272633075714
The modified gen p mean: 0.08629659563302994, gen p mean: 0.0, mean p set: 0.4513118267059326
loss_pred:0.16789363324642181, decouple_loss:0.2682996690273285
loss_pred:0.17719484865665436, decouple_loss:0.2706318199634552
The modified gen p mean: 0.08637334406375885, gen p mean: 0.0, mean p set: 0.45221027731895447
loss_pred:0.1717984825372696, decouple_loss:0.27178147435188293
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.09927210956811905, gen p mean: 0.0, mean p set: 0.4524524509906769
The modified gen p mean: 0.09916648268699646, gen p mean: 0.0, mean p set: 0.4495299756526947
The modified gen p mean: 0.09935010969638824, gen p mean: 0.0, mean p set: 0.44998228549957275
loss_pred:0.17358262836933136, decouple_loss:0.2939930856227875
loss_pred:0.1677795946598053, decouple_loss:0.28748056292533875
loss_pred:0.16259686648845673, decouple_loss:0.2997167408466339
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.11033084988594055, gen p mean: 0.0, mean p set: 0.450061172246933
The modified gen p mean: 0.11041784286499023, gen p mean: 0.0, mean p set: 0.45067617297172546
The modified gen p mean: 0.11054786294698715, gen p mean: 0.0, mean p set: 0.45104068517684937
loss_pred:0.1664043813943863, decouple_loss:0.31491905450820923
loss_pred:0.16173100471496582, decouple_loss:0.31541910767555237
loss_pred:0.16465602815151215, decouple_loss:0.3119507133960724
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.12741604447364807, gen p mean: 0.0, mean p set: 0.45301464200019836
The modified gen p mean: 0.12740764021873474, gen p mean: 0.0, mean p set: 0.4503227472305298
The modified gen p mean: 0.12746253609657288, gen p mean: 0.0, mean p set: 0.45061564445495605
loss_pred:0.15915381908416748, decouple_loss:0.30507275462150574
loss_pred:0.15782050788402557, decouple_loss:0.3059433698654175
loss_pred:0.1586884707212448, decouple_loss:0.30348265171051025
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.14338377118110657, gen p mean: 0.0, mean p set: 0.4493563175201416
The modified gen p mean: 0.14332598447799683, gen p mean: 0.0, mean p set: 0.45068490505218506
The modified gen p mean: 0.14359748363494873, gen p mean: 0.0, mean p set: 0.45088836550712585
loss_pred:0.15239204466342926, decouple_loss:0.3145711421966553
loss_pred:0.15707524120807648, decouple_loss:0.30721962451934814
loss_pred:0.1591409295797348, decouple_loss:0.3131013512611389
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.1560157686471939, gen p mean: 0.0, mean p set: 0.44973790645599365
The modified gen p mean: 0.15607509016990662, gen p mean: 0.0, mean p set: 0.4529832601547241
The modified gen p mean: 0.15595784783363342, gen p mean: 0.0, mean p set: 0.4528670310974121
loss_pred:0.14647389948368073, decouple_loss:0.2736400365829468
loss_pred:0.1540716290473938, decouple_loss:0.27630236744880676
loss_pred:0.15065830945968628, decouple_loss:0.27475765347480774
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.1737312227487564, gen p mean: 0.0, mean p set: 0.44922199845314026
The modified gen p mean: 0.1739959716796875, gen p mean: 0.0, mean p set: 0.4507381319999695
The modified gen p mean: 0.17394475638866425, gen p mean: 0.0, mean p set: 0.44999533891677856
loss_pred:0.1478385329246521, decouple_loss:0.2537774443626404loss_pred:0.1482507884502411, decouple_loss:0.25451478362083435
loss_pred:0.14421507716178894, decouple_loss:0.2576467990875244
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.19215619564056396, gen p mean: 0.0, mean p set: 0.45085835456848145
The modified gen p mean: 0.19170358777046204, gen p mean: 0.0, mean p set: 0.4505075514316559
The modified gen p mean: 0.1921415627002716, gen p mean: 0.0, mean p set: 0.45213228464126587
loss_pred:0.14369964599609375, decouple_loss:0.24579043686389923
loss_pred:0.1422869712114334, decouple_loss:0.24236378073692322
loss_pred:0.14326901733875275, decouple_loss:0.24565094709396362
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.21579159796237946, gen p mean: 0.0, mean p set: 0.45047301054000854The modified gen p mean: 0.21532584726810455, gen p mean: 0.0, mean p set: 0.450395405292511
The modified gen p mean: 0.21530687808990479, gen p mean: 0.0, mean p set: 0.4502647817134857
loss_pred:0.14076688885688782, decouple_loss:0.23796692490577698
loss_pred:0.1417100876569748, decouple_loss:0.24096202850341797
loss_pred:0.1365918666124344, decouple_loss:0.24023647606372833
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.21994800865650177, gen p mean: 0.0, mean p set: 0.4496554732322693
The modified gen p mean: 0.2197754979133606, gen p mean: 0.0, mean p set: 0.44996383786201477
The modified gen p mean: 0.21983583271503448, gen p mean: 0.0, mean p set: 0.4527532756328583
loss_pred:0.13182246685028076, decouple_loss:0.23929129540920258
loss_pred:0.13412262499332428, decouple_loss:0.23451021313667297
loss_pred:0.13401354849338531, decouple_loss:0.23696552217006683
2023-05-02 14:27:26 testing...
The modified gen p mean: 0.236617773771286, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.23658818006515503, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.2365683615207672, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.13197332620620728, decouple_loss:0.21164321899414062
loss_pred:0.1325356364250183, decouple_loss:0.21320585906505585
loss_pred:0.1327093541622162, decouple_loss:0.21402324736118317
WV_0_PC_0_EH_0_PS_40_6, loss: 0.14305397868156433, avg_mse: 0.13149188458919525
current test mse: 0.131492
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.2364536076784134, gen p mean: 0.0, mean p set: 0.449592649936676
loss_pred:0.13417890667915344, decouple_loss:0.2133040726184845
The modified gen p mean: 0.23638446629047394, gen p mean: 0.0, mean p set: 0.45081067085266113
loss_pred:0.1320483684539795, decouple_loss:0.21197004616260529
The modified gen p mean: 0.2364729940891266, gen p mean: 0.0, mean p set: 0.44886115193367004
loss_pred:0.13216374814510345, decouple_loss:0.21350793540477753
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.2537643015384674, gen p mean: 0.0, mean p set: 0.4506988525390625
The modified gen p mean: 0.2536475956439972, gen p mean: 0.0, mean p set: 0.4500047266483307
The modified gen p mean: 0.2536063492298126, gen p mean: 0.0, mean p set: 0.4506444036960602
loss_pred:0.1260279417037964, decouple_loss:0.1936863362789154
loss_pred:0.12204724550247192, decouple_loss:0.1946672946214676
loss_pred:0.12478328496217728, decouple_loss:0.19548937678337097
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.26955026388168335, gen p mean: 0.0, mean p set: 0.45179483294487
The modified gen p mean: 0.2698928117752075, gen p mean: 0.0, mean p set: 0.45151498913764954
The modified gen p mean: 0.26936736702919006, gen p mean: 0.0, mean p set: 0.4523118734359741
loss_pred:0.12371449172496796, decouple_loss:0.17995209991931915
loss_pred:0.12176933139562607, decouple_loss:0.18111591041088104
loss_pred:0.1242968961596489, decouple_loss:0.18132731318473816
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.28929403424263, gen p mean: 0.0, mean p set: 0.45045042037963867
The modified gen p mean: 0.2894914448261261, gen p mean: 0.0, mean p set: 0.45110228657722473
The modified gen p mean: 0.2893839478492737, gen p mean: 0.0, mean p set: 0.4497842490673065
loss_pred:0.1175818145275116, decouple_loss:0.1744948923587799
loss_pred:0.11909274011850357, decouple_loss:0.17784547805786133
loss_pred:0.12250076979398727, decouple_loss:0.1729341298341751
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.30145499110221863, gen p mean: 0.0, mean p set: 0.4496713876724243
The modified gen p mean: 0.30174532532691956, gen p mean: 0.0, mean p set: 0.4502204656600952
The modified gen p mean: 0.3012457489967346, gen p mean: 0.0, mean p set: 0.4495818316936493
loss_pred:0.11357367038726807, decouple_loss:0.1691700667142868
loss_pred:0.11813674122095108, decouple_loss:0.17033781111240387
loss_pred:0.11923384666442871, decouple_loss:0.17052307724952698
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.32037919759750366, gen p mean: 0.0, mean p set: 0.45116233825683594
The modified gen p mean: 0.32058027386665344, gen p mean: 0.0, mean p set: 0.4508519768714905
The modified gen p mean: 0.3213276267051697, gen p mean: 0.0, mean p set: 0.45038288831710815
loss_pred:0.11253025382757187, decouple_loss:0.15676483511924744
loss_pred:0.11238023638725281, decouple_loss:0.15655149519443512
loss_pred:0.11200667917728424, decouple_loss:0.1568821668624878
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.32913967967033386, gen p mean: 0.0, mean p set: 0.45029953122138977
The modified gen p mean: 0.32999205589294434, gen p mean: 0.0, mean p set: 0.44943130016326904
The modified gen p mean: 0.3303840160369873, gen p mean: 0.0, mean p set: 0.45183131098747253
loss_pred:0.11146659404039383, decouple_loss:0.14546290040016174
loss_pred:0.10968491435050964, decouple_loss:0.14565981924533844
loss_pred:0.11184719204902649, decouple_loss:0.1466219425201416
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3521959185600281, gen p mean: 0.0, mean p set: 0.4497469365596771
The modified gen p mean: 0.3510468006134033, gen p mean: 0.0, mean p set: 0.44956985116004944
The modified gen p mean: 0.35329335927963257, gen p mean: 0.0, mean p set: 0.45115405321121216
loss_pred:0.11108149588108063, decouple_loss:0.14881980419158936
loss_pred:0.11056698113679886, decouple_loss:0.15027281641960144
loss_pred:0.11040753126144409, decouple_loss:0.1513211578130722
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3420262038707733, gen p mean: 0.0, mean p set: 0.4503568708896637
The modified gen p mean: 0.3420328199863434, gen p mean: 0.0, mean p set: 0.4512108564376831
The modified gen p mean: 0.3419898748397827, gen p mean: 0.0, mean p set: 0.4501529335975647
loss_pred:0.1047762855887413, decouple_loss:0.14513523876667023
loss_pred:0.10314080119132996, decouple_loss:0.14574843645095825
loss_pred:0.10499180853366852, decouple_loss:0.14432787895202637
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.35810720920562744, gen p mean: 0.0, mean p set: 0.4500291645526886
The modified gen p mean: 0.35775768756866455, gen p mean: 0.0, mean p set: 0.45081138610839844
The modified gen p mean: 0.3577844500541687, gen p mean: 0.0, mean p set: 0.4504052996635437
loss_pred:0.09724895656108856, decouple_loss:0.19735459983348846
loss_pred:0.10313216596841812, decouple_loss:0.1930397003889084
loss_pred:0.09996725618839264, decouple_loss:0.1953200250864029
2023-05-02 14:31:52 testing...
The modified gen p mean: 0.359016090631485, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.358781635761261, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.358674556016922, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.10147380828857422, decouple_loss:0.1757010519504547
loss_pred:0.1010189950466156, decouple_loss:0.17335385084152222
loss_pred:0.10080096125602722, decouple_loss:0.17272989451885223
WV_0_PC_0_EH_0_PS_40_6, loss: 0.10979434102773666, avg_mse: 0.10041793435811996
current test mse: 0.100418
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.36045169830322266, gen p mean: 0.0, mean p set: 0.45036759972572327
The modified gen p mean: 0.36064061522483826, gen p mean: 0.0, mean p set: 0.4506790041923523
loss_pred:0.09979560971260071, decouple_loss:0.17256353795528412
loss_pred:0.09895516186952591, decouple_loss:0.17159567773342133
The modified gen p mean: 0.35998186469078064, gen p mean: 0.0, mean p set: 0.4506879150867462
loss_pred:0.10062293708324432, decouple_loss:0.1729729175567627
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3671010732650757, gen p mean: 0.0, mean p set: 0.4515463411808014
The modified gen p mean: 0.36603477597236633, gen p mean: 0.0, mean p set: 0.45051753520965576
The modified gen p mean: 0.36598309874534607, gen p mean: 0.0, mean p set: 0.450996994972229
loss_pred:0.09715443849563599, decouple_loss:0.15842004120349884
loss_pred:0.09490885585546494, decouple_loss:0.158050537109375
loss_pred:0.09731607884168625, decouple_loss:0.15748098492622375
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3826806843280792, gen p mean: 0.0, mean p set: 0.45068684220314026
The modified gen p mean: 0.38272222876548767, gen p mean: 0.0, mean p set: 0.4494975507259369
The modified gen p mean: 0.3822380006313324, gen p mean: 0.0, mean p set: 0.4523356258869171
loss_pred:0.09716515988111496, decouple_loss:0.144539937376976
loss_pred:0.09402254223823547, decouple_loss:0.14520682394504547
loss_pred:0.0949033573269844, decouple_loss:0.14719000458717346
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.39237523078918457, gen p mean: 0.0, mean p set: 0.4495031237602234
The modified gen p mean: 0.3913573920726776, gen p mean: 0.0, mean p set: 0.45207199454307556
The modified gen p mean: 0.38952308893203735, gen p mean: 0.0, mean p set: 0.45098140835762024
loss_pred:0.09207027405500412, decouple_loss:0.13927175104618073
loss_pred:0.09545303136110306, decouple_loss:0.141553595662117
loss_pred:0.09506629407405853, decouple_loss:0.14249122142791748
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4267025887966156, gen p mean: 0.0, mean p set: 0.4505689740180969
The modified gen p mean: 0.4262949824333191, gen p mean: 0.0, mean p set: 0.45029497146606445
The modified gen p mean: 0.4274824559688568, gen p mean: 0.0, mean p set: 0.4497208595275879
loss_pred:0.09394177049398422, decouple_loss:0.15103521943092346
loss_pred:0.09404278546571732, decouple_loss:0.14894208312034607
loss_pred:0.09788686782121658, decouple_loss:0.1499386727809906
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.38899844884872437, gen p mean: 0.0, mean p set: 0.4509684145450592
The modified gen p mean: 0.38853904604911804, gen p mean: 0.0, mean p set: 0.4505685865879059
The modified gen p mean: 0.3887268602848053, gen p mean: 0.0, mean p set: 0.45241379737854004
loss_pred:0.0915827602148056, decouple_loss:0.14769457280635834
loss_pred:0.08951210975646973, decouple_loss:0.1511266976594925
loss_pred:0.0908685252070427, decouple_loss:0.14659389853477478
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3986101746559143, gen p mean: 0.0, mean p set: 0.4498935639858246
The modified gen p mean: 0.39943599700927734, gen p mean: 0.0, mean p set: 0.4488658010959625
The modified gen p mean: 0.40008947253227234, gen p mean: 0.0, mean p set: 0.4516029953956604
loss_pred:0.09129109978675842, decouple_loss:0.13420891761779785
loss_pred:0.08912678807973862, decouple_loss:0.1366359293460846
loss_pred:0.08970671147108078, decouple_loss:0.13491499423980713
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4135900139808655, gen p mean: 0.0, mean p set: 0.44944292306900024
The modified gen p mean: 0.41165634989738464, gen p mean: 0.0, mean p set: 0.45075175166130066
The modified gen p mean: 0.41365349292755127, gen p mean: 0.0, mean p set: 0.45027947425842285
loss_pred:0.0915270447731018, decouple_loss:0.12757939100265503
loss_pred:0.08872183412313461, decouple_loss:0.13096079230308533
loss_pred:0.09141575545072556, decouple_loss:0.128501757979393
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.41341444849967957, gen p mean: 0.0, mean p set: 0.45123711228370667
The modified gen p mean: 0.4155813455581665, gen p mean: 0.0, mean p set: 0.4504128098487854
The modified gen p mean: 0.41537466645240784, gen p mean: 0.0, mean p set: 0.45262953639030457
loss_pred:0.08672891557216644, decouple_loss:0.11922800540924072loss_pred:0.08514267206192017, decouple_loss:0.12240509688854218
loss_pred:0.08928518742322922, decouple_loss:0.12025667726993561
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42163407802581787, gen p mean: 0.0, mean p set: 0.4514326751232147
The modified gen p mean: 0.4196138083934784, gen p mean: 0.0, mean p set: 0.4504949152469635
The modified gen p mean: 0.421703040599823, gen p mean: 0.0, mean p set: 0.45075103640556335
loss_pred:0.08630664646625519, decouple_loss:0.11839169263839722
loss_pred:0.08469727635383606, decouple_loss:0.11677399277687073
loss_pred:0.08723637461662292, decouple_loss:0.11503440886735916
2023-05-02 14:35:34 testing...
The modified gen p mean: 0.4282710552215576, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.42899835109710693, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4288336932659149, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.0875077173113823, decouple_loss:0.1115294098854065
loss_pred:0.08769747614860535, decouple_loss:0.11150889843702316
loss_pred:0.08811529725790024, decouple_loss:0.1142745316028595
WV_0_PC_0_EH_0_PS_40_6, loss: 0.09339537471532822, avg_mse: 0.08742319047451019
current test mse: 0.087423
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4311022162437439, gen p mean: 0.0, mean p set: 0.4507540166378021
The modified gen p mean: 0.4278838336467743, gen p mean: 0.0, mean p set: 0.45140039920806885
loss_pred:0.08797889202833176, decouple_loss:0.11274538934230804
loss_pred:0.08578520268201828, decouple_loss:0.11117656528949738
The modified gen p mean: 0.42792561650276184, gen p mean: 0.0, mean p set: 0.45218998193740845
loss_pred:0.08277270197868347, decouple_loss:0.11345220357179642
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4154338240623474, gen p mean: 0.0, mean p set: 0.45077693462371826
The modified gen p mean: 0.4180281460285187, gen p mean: 0.0, mean p set: 0.45223185420036316
The modified gen p mean: 0.41685786843299866, gen p mean: 0.0, mean p set: 0.45286911725997925
loss_pred:0.08533268421888351, decouple_loss:0.11811967939138412
loss_pred:0.08573495596647263, decouple_loss:0.11600514501333237
loss_pred:0.08718155324459076, decouple_loss:0.11600199341773987
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654861092567444, gen p mean: 0.0, mean p set: 0.45289358496665955
The modified gen p mean: 0.44656994938850403, gen p mean: 0.0, mean p set: 0.4503083825111389
The modified gen p mean: 0.44570744037628174, gen p mean: 0.0, mean p set: 0.4525797963142395
loss_pred:0.0837770327925682, decouple_loss:0.11499428749084473
loss_pred:0.08786819875240326, decouple_loss:0.11282724887132645
loss_pred:0.08667777478694916, decouple_loss:0.1131909117102623
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42903345823287964, gen p mean: 0.0, mean p set: 0.45011407136917114
The modified gen p mean: 0.4318113923072815, gen p mean: 0.0, mean p set: 0.45201605558395386
The modified gen p mean: 0.42947667837142944, gen p mean: 0.0, mean p set: 0.45093417167663574
loss_pred:0.0842621922492981, decouple_loss:0.11054456979036331
loss_pred:0.08311153948307037, decouple_loss:0.11219434440135956
loss_pred:0.08636476844549179, decouple_loss:0.11148558557033539
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4278530776500702, gen p mean: 0.0, mean p set: 0.451449453830719The modified gen p mean: 0.42538294196128845, gen p mean: 0.0, mean p set: 0.45062994956970215
The modified gen p mean: 0.42847079038619995, gen p mean: 0.0, mean p set: 0.453481525182724
loss_pred:0.08527453243732452, decouple_loss:0.10741164535284042
loss_pred:0.07988494634628296, decouple_loss:0.10584475100040436
loss_pred:0.08311805129051208, decouple_loss:0.10738127678632736
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4384027421474457, gen p mean: 0.0, mean p set: 0.4499463438987732
The modified gen p mean: 0.4383033812046051, gen p mean: 0.0, mean p set: 0.4530864953994751
The modified gen p mean: 0.4342781603336334, gen p mean: 0.0, mean p set: 0.4516936242580414
loss_pred:0.08607328683137894, decouple_loss:0.10237620025873184
loss_pred:0.08266256749629974, decouple_loss:0.10379548370838165
loss_pred:0.08310391753911972, decouple_loss:0.10301004350185394
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4376783072948456, gen p mean: 0.0, mean p set: 0.4509766697883606
The modified gen p mean: 0.43489331007003784, gen p mean: 0.0, mean p set: 0.451722115278244
The modified gen p mean: 0.43948397040367126, gen p mean: 0.0, mean p set: 0.4528786242008209
loss_pred:0.08119355887174606, decouple_loss:0.09995497763156891
loss_pred:0.084849052131176, decouple_loss:0.099138543009758
loss_pred:0.08238384872674942, decouple_loss:0.09922061860561371
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4204765260219574, gen p mean: 0.0, mean p set: 0.4506874978542328
The modified gen p mean: 0.42294779419898987, gen p mean: 0.0, mean p set: 0.4507933557033539
The modified gen p mean: 0.42218127846717834, gen p mean: 0.0, mean p set: 0.45182737708091736
loss_pred:0.08262676000595093, decouple_loss:0.09587427228689194
loss_pred:0.0835525318980217, decouple_loss:0.09478338807821274
loss_pred:0.07973488420248032, decouple_loss:0.09494749456644058
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42945146560668945, gen p mean: 0.0, mean p set: 0.451490581035614
The modified gen p mean: 0.4300609230995178, gen p mean: 0.0, mean p set: 0.4509580433368683
The modified gen p mean: 0.42743927240371704, gen p mean: 0.0, mean p set: 0.45116883516311646
loss_pred:0.08073645085096359, decouple_loss:0.09200660139322281
loss_pred:0.08366163820028305, decouple_loss:0.09386906772851944
loss_pred:0.08340340107679367, decouple_loss:0.09345952421426773
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443839490413666, gen p mean: 0.0, mean p set: 0.452263206243515
The modified gen p mean: 0.4440717101097107, gen p mean: 0.0, mean p set: 0.4521932005882263
The modified gen p mean: 0.44365623593330383, gen p mean: 0.0, mean p set: 0.45156532526016235
loss_pred:0.08145799487829208, decouple_loss:0.09021136164665222
loss_pred:0.08086312562227249, decouple_loss:0.09151886403560638
loss_pred:0.08032920956611633, decouple_loss:0.09005719423294067
2023-05-02 14:40:05 testing...
The modified gen p mean: 0.4419263005256653, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4407210648059845, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44235658645629883, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.08361636102199554, decouple_loss:0.0911431834101677
loss_pred:0.08324067294597626, decouple_loss:0.09076232463121414
loss_pred:0.08385302871465683, decouple_loss:0.09181655198335648
WV_0_PC_0_EH_0_PS_40_6, loss: 0.08813206851482391, avg_mse: 0.08342915773391724
current test mse: 0.083429
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4430370032787323, gen p mean: 0.0, mean p set: 0.45354846119880676
loss_pred:0.08091112226247787, decouple_loss:0.08753598481416702
The modified gen p mean: 0.44153615832328796, gen p mean: 0.0, mean p set: 0.4520759880542755
loss_pred:0.08052338659763336, decouple_loss:0.08656301349401474
The modified gen p mean: 0.43971988558769226, gen p mean: 0.0, mean p set: 0.45289894938468933
loss_pred:0.08329850435256958, decouple_loss:0.08862444758415222
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43858686089515686, gen p mean: 0.0, mean p set: 0.451358824968338
The modified gen p mean: 0.44265732169151306, gen p mean: 0.0, mean p set: 0.45154494047164917
The modified gen p mean: 0.4400257468223572, gen p mean: 0.0, mean p set: 0.4510243833065033
loss_pred:0.07996005564928055, decouple_loss:0.08486524224281311
loss_pred:0.07904619723558426, decouple_loss:0.08476651459932327
loss_pred:0.08187330514192581, decouple_loss:0.08582080900669098
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44282588362693787, gen p mean: 0.0, mean p set: 0.4514811336994171
The modified gen p mean: 0.4426359534263611, gen p mean: 0.0, mean p set: 0.45062902569770813
The modified gen p mean: 0.4449155032634735, gen p mean: 0.0, mean p set: 0.45179006457328796
loss_pred:0.08069540560245514, decouple_loss:0.08510395884513855
loss_pred:0.0828603208065033, decouple_loss:0.0854770764708519
loss_pred:0.07915563881397247, decouple_loss:0.08430306613445282
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4408806264400482, gen p mean: 0.0, mean p set: 0.4508115351200104
The modified gen p mean: 0.44144487380981445, gen p mean: 0.0, mean p set: 0.45175471901893616
The modified gen p mean: 0.4380441904067993, gen p mean: 0.0, mean p set: 0.45218396186828613
loss_pred:0.08195960521697998, decouple_loss:0.08156784623861313
loss_pred:0.08080344647169113, decouple_loss:0.0818953663110733
loss_pred:0.08135963976383209, decouple_loss:0.08226034790277481
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4339927136898041, gen p mean: 0.0, mean p set: 0.4511346220970154
The modified gen p mean: 0.4350360631942749, gen p mean: 0.0, mean p set: 0.4504954218864441
The modified gen p mean: 0.43676722049713135, gen p mean: 0.0, mean p set: 0.4511570930480957
loss_pred:0.07967710494995117, decouple_loss:0.08120296895503998
loss_pred:0.08068028837442398, decouple_loss:0.08179483562707901
loss_pred:0.08172070235013962, decouple_loss:0.08285385370254517
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43096181750297546, gen p mean: 0.0, mean p set: 0.4505161941051483
The modified gen p mean: 0.4320487380027771, gen p mean: 0.0, mean p set: 0.4524238109588623
The modified gen p mean: 0.43304646015167236, gen p mean: 0.0, mean p set: 0.4514252245426178
loss_pred:0.08031078428030014, decouple_loss:0.08018119633197784
loss_pred:0.07955022901296616, decouple_loss:0.08068815618753433
loss_pred:0.08253232389688492, decouple_loss:0.08280807733535767
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4419415295124054, gen p mean: 0.0, mean p set: 0.45155417919158936
The modified gen p mean: 0.43796974420547485, gen p mean: 0.0, mean p set: 0.4518631398677826
The modified gen p mean: 0.4418970048427582, gen p mean: 0.0, mean p set: 0.4518493115901947
loss_pred:0.07992780953645706, decouple_loss:0.07980029284954071
loss_pred:0.08208628743886948, decouple_loss:0.07804814726114273
loss_pred:0.07777470350265503, decouple_loss:0.0807221531867981
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44499099254608154, gen p mean: 0.0, mean p set: 0.45038551092147827
The modified gen p mean: 0.444642037153244, gen p mean: 0.0, mean p set: 0.4522396922111511
The modified gen p mean: 0.44559428095817566, gen p mean: 0.0, mean p set: 0.4520973861217499
loss_pred:0.08112087100744247, decouple_loss:0.07779567688703537
loss_pred:0.07858885824680328, decouple_loss:0.07779098302125931
loss_pred:0.07766275107860565, decouple_loss:0.08125382661819458
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4387505054473877, gen p mean: 0.0, mean p set: 0.452742338180542
The modified gen p mean: 0.4354601800441742, gen p mean: 0.0, mean p set: 0.45134201645851135
The modified gen p mean: 0.43829795718193054, gen p mean: 0.0, mean p set: 0.4514739513397217
loss_pred:0.07912049442529678, decouple_loss:0.07756210118532181
loss_pred:0.07876879721879959, decouple_loss:0.07713821530342102
loss_pred:0.07992076128721237, decouple_loss:0.07713835686445236
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
NaN value num: 0
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4384562373161316, gen p mean: 0.0, mean p set: 0.44944655895233154
The modified gen p mean: 0.4371018707752228, gen p mean: 0.0, mean p set: 0.45208439230918884
The modified gen p mean: 0.4369499683380127, gen p mean: 0.0, mean p set: 0.4503953158855438
loss_pred:0.08166036009788513, decouple_loss:0.07854500412940979
loss_pred:0.0816834419965744, decouple_loss:0.07989731431007385
loss_pred:0.08071201294660568, decouple_loss:0.08050613105297089
2023-05-02 14:44:33 testing...
The modified gen p mean: 0.4404282569885254, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4409029483795166, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4401072859764099, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.08189612627029419, decouple_loss:0.0790666788816452
loss_pred:0.08199281990528107, decouple_loss:0.07925113290548325
loss_pred:0.0815669521689415, decouple_loss:0.07895442098379135
WV_0_PC_0_EH_0_PS_40_6, loss: 0.08577316999435425, avg_mse: 0.0817003846168518
current test mse: 0.0817
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.440189391374588, gen p mean: 0.0, mean p set: 0.4504729211330414
The modified gen p mean: 0.4423588812351227, gen p mean: 0.0, mean p set: 0.4515781104564667
loss_pred:0.08077473938465118, decouple_loss:0.0760238990187645
loss_pred:0.0839696004986763, decouple_loss:0.07516108453273773
The modified gen p mean: 0.4384017288684845, gen p mean: 0.0, mean p set: 0.4494556486606598
loss_pred:0.07842535525560379, decouple_loss:0.07765353471040726
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4395386874675751, gen p mean: 0.0, mean p set: 0.44963186979293823
The modified gen p mean: 0.4393223226070404, gen p mean: 0.0, mean p set: 0.4517803192138672
The modified gen p mean: 0.4394117593765259, gen p mean: 0.0, mean p set: 0.45037439465522766
loss_pred:0.08249007165431976, decouple_loss:0.07517732679843903
loss_pred:0.08264472335577011, decouple_loss:0.07580390572547913
loss_pred:0.07846490293741226, decouple_loss:0.07529451698064804
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483221769332886, gen p mean: 0.0, mean p set: 0.4521786570549011
The modified gen p mean: 0.44699543714523315, gen p mean: 0.0, mean p set: 0.4518364667892456
The modified gen p mean: 0.4431326389312744, gen p mean: 0.0, mean p set: 0.45180633664131165
loss_pred:0.08023056387901306, decouple_loss:0.07472441345453262
loss_pred:0.08091471344232559, decouple_loss:0.07491812855005264
loss_pred:0.08208165317773819, decouple_loss:0.07446426898241043
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4383998215198517, gen p mean: 0.0, mean p set: 0.44978898763656616
The modified gen p mean: 0.4401182234287262, gen p mean: 0.0, mean p set: 0.4506323039531708
The modified gen p mean: 0.4434516727924347, gen p mean: 0.0, mean p set: 0.4505631625652313
loss_pred:0.07998023927211761, decouple_loss:0.07211147993803024
loss_pred:0.08155558258295059, decouple_loss:0.07216234505176544
loss_pred:0.08120741695165634, decouple_loss:0.07348459213972092
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4353680908679962, gen p mean: 0.0, mean p set: 0.44928696751594543
The modified gen p mean: 0.43090009689331055, gen p mean: 0.0, mean p set: 0.4506370425224304
The modified gen p mean: 0.431995689868927, gen p mean: 0.0, mean p set: 0.4517802298069
loss_pred:0.08031909167766571, decouple_loss:0.07038888335227966
loss_pred:0.08219322562217712, decouple_loss:0.07284549623727798
loss_pred:0.07996613532304764, decouple_loss:0.0723559558391571
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4416294991970062, gen p mean: 0.0, mean p set: 0.4518067240715027
The modified gen p mean: 0.4365759789943695, gen p mean: 0.0, mean p set: 0.44932547211647034
The modified gen p mean: 0.43491488695144653, gen p mean: 0.0, mean p set: 0.4512340724468231
loss_pred:0.08132239431142807, decouple_loss:0.07152332365512848
loss_pred:0.0797312781214714, decouple_loss:0.070058174431324
loss_pred:0.0812644213438034, decouple_loss:0.07039877772331238
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4417422115802765, gen p mean: 0.0, mean p set: 0.4501945972442627
The modified gen p mean: 0.43730247020721436, gen p mean: 0.0, mean p set: 0.45049622654914856
The modified gen p mean: 0.4387826919555664, gen p mean: 0.0, mean p set: 0.4508860111236572
loss_pred:0.0799911767244339, decouple_loss:0.07071409374475479
loss_pred:0.07965119183063507, decouple_loss:0.07169713824987411
loss_pred:0.07918126881122589, decouple_loss:0.07072009891271591
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4388546347618103, gen p mean: 0.0, mean p set: 0.45023679733276367
The modified gen p mean: 0.43954890966415405, gen p mean: 0.0, mean p set: 0.4517871141433716
The modified gen p mean: 0.4446946084499359, gen p mean: 0.0, mean p set: 0.4523797929286957
loss_pred:0.0785466656088829, decouple_loss:0.0720200315117836
loss_pred:0.08103903383016586, decouple_loss:0.06896835565567017
loss_pred:0.08040141314268112, decouple_loss:0.07082083821296692
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44166654348373413, gen p mean: 0.0, mean p set: 0.4520488977432251
The modified gen p mean: 0.44570261240005493, gen p mean: 0.0, mean p set: 0.4506262540817261
The modified gen p mean: 0.43947064876556396, gen p mean: 0.0, mean p set: 0.45217210054397583
loss_pred:0.07952773571014404, decouple_loss:0.0673031136393547
loss_pred:0.07902620732784271, decouple_loss:0.06850367039442062
loss_pred:0.08208665996789932, decouple_loss:0.06795857846736908
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470156729221344, gen p mean: 0.0, mean p set: 0.4503283202648163
The modified gen p mean: 0.443308562040329, gen p mean: 0.0, mean p set: 0.452788382768631
The modified gen p mean: 0.4457573890686035, gen p mean: 0.0, mean p set: 0.45037025213241577
loss_pred:0.08171413093805313, decouple_loss:0.06824812293052673loss_pred:0.08277131617069244, decouple_loss:0.06684817373752594
loss_pred:0.07926362752914429, decouple_loss:0.06719192862510681
2023-05-02 14:48:15 testing...
The modified gen p mean: 0.44500911235809326, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4450099766254425, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44579455256462097, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.08067107945680618, decouple_loss:0.07005595415830612
loss_pred:0.08024399727582932, decouple_loss:0.06969805061817169
loss_pred:0.0807013213634491, decouple_loss:0.07038474828004837
WV_0_PC_0_EH_0_PS_40_6, loss: 0.08404111862182617, avg_mse: 0.08047665655612946
current test mse: 0.080477
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4422420859336853, gen p mean: 0.0, mean p set: 0.45006316900253296
The modified gen p mean: 0.4437999725341797, gen p mean: 0.0, mean p set: 0.4528287649154663
loss_pred:0.07981985062360764, decouple_loss:0.0667942613363266
loss_pred:0.08145205676555634, decouple_loss:0.0656355619430542
The modified gen p mean: 0.44207867980003357, gen p mean: 0.0, mean p set: 0.4507118761539459
loss_pred:0.08052954822778702, decouple_loss:0.0664067193865776
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43661823868751526, gen p mean: 0.0, mean p set: 0.4523853361606598
The modified gen p mean: 0.4425216019153595, gen p mean: 0.0, mean p set: 0.4509114921092987
The modified gen p mean: 0.43986010551452637, gen p mean: 0.0, mean p set: 0.449785053730011
loss_pred:0.08135449886322021, decouple_loss:0.06528406590223312
loss_pred:0.07906631380319595, decouple_loss:0.06508609652519226
loss_pred:0.07868746668100357, decouple_loss:0.06646762043237686
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4432998597621918, gen p mean: 0.0, mean p set: 0.4515089690685272
The modified gen p mean: 0.44162261486053467, gen p mean: 0.0, mean p set: 0.45010891556739807
The modified gen p mean: 0.44332587718963623, gen p mean: 0.0, mean p set: 0.44889846444129944
loss_pred:0.0808538943529129, decouple_loss:0.06345482170581818
loss_pred:0.07775181531906128, decouple_loss:0.0641532763838768
loss_pred:0.07946030050516129, decouple_loss:0.06398043781518936
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4442698359489441, gen p mean: 0.0, mean p set: 0.45142364501953125
The modified gen p mean: 0.4431784152984619, gen p mean: 0.0, mean p set: 0.45276302099227905
The modified gen p mean: 0.4445524513721466, gen p mean: 0.0, mean p set: 0.452411413192749
loss_pred:0.0785495936870575, decouple_loss:0.06243273243308067
loss_pred:0.08058244735002518, decouple_loss:0.06245262548327446
loss_pred:0.08020713180303574, decouple_loss:0.06253520399332047
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4389682114124298, gen p mean: 0.0, mean p set: 0.4498198330402374
The modified gen p mean: 0.4366360604763031, gen p mean: 0.0, mean p set: 0.4510500431060791
The modified gen p mean: 0.4422893822193146, gen p mean: 0.0, mean p set: 0.4519183933734894
loss_pred:0.0792292058467865, decouple_loss:0.06266758590936661
loss_pred:0.07986073940992355, decouple_loss:0.06236356124281883
loss_pred:0.07904957979917526, decouple_loss:0.06226774677634239
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4411586821079254, gen p mean: 0.0, mean p set: 0.4523966908454895
The modified gen p mean: 0.43747851252555847, gen p mean: 0.0, mean p set: 0.4504021108150482
The modified gen p mean: 0.43986719846725464, gen p mean: 0.0, mean p set: 0.45060670375823975
loss_pred:0.07853198051452637, decouple_loss:0.06131884828209877
loss_pred:0.08094457536935806, decouple_loss:0.06142043322324753
loss_pred:0.07947960495948792, decouple_loss:0.060725513845682144
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450460374355316, gen p mean: 0.0, mean p set: 0.44904741644859314
The modified gen p mean: 0.44583040475845337, gen p mean: 0.0, mean p set: 0.4500194787979126
The modified gen p mean: 0.44850924611091614, gen p mean: 0.0, mean p set: 0.4508816599845886
loss_pred:0.0776490569114685, decouple_loss:0.06082305312156677
loss_pred:0.07816075533628464, decouple_loss:0.06033210828900337
loss_pred:0.08135250210762024, decouple_loss:0.06119541823863983
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443677067756653, gen p mean: 0.0, mean p set: 0.4507678747177124
The modified gen p mean: 0.44498810172080994, gen p mean: 0.0, mean p set: 0.4492642879486084
The modified gen p mean: 0.44487208127975464, gen p mean: 0.0, mean p set: 0.4506132900714874
loss_pred:0.07745727896690369, decouple_loss:0.05881190299987793
loss_pred:0.07700059562921524, decouple_loss:0.059841107577085495
loss_pred:0.07996586710214615, decouple_loss:0.05838470533490181
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44055065512657166, gen p mean: 0.0, mean p set: 0.45094767212867737
The modified gen p mean: 0.44304078817367554, gen p mean: 0.0, mean p set: 0.4516959488391876
The modified gen p mean: 0.44560346007347107, gen p mean: 0.0, mean p set: 0.451625794172287
loss_pred:0.0800565630197525, decouple_loss:0.057791050523519516
loss_pred:0.07819407433271408, decouple_loss:0.05745911970734596
loss_pred:0.07915620505809784, decouple_loss:0.058022353798151016
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4436728060245514, gen p mean: 0.0, mean p set: 0.4475066065788269
The modified gen p mean: 0.4437789022922516, gen p mean: 0.0, mean p set: 0.44715800881385803
The modified gen p mean: 0.4457801580429077, gen p mean: 0.0, mean p set: 0.4468553960323334
loss_pred:0.07691607624292374, decouple_loss:0.0594647042453289
loss_pred:0.08231548964977264, decouple_loss:0.060341961681842804
loss_pred:0.07684352248907089, decouple_loss:0.06012517958879471
2023-05-02 14:52:35 testing...
The modified gen p mean: 0.44861337542533875, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4483957290649414, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4496564269065857, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.07832412421703339, decouple_loss:0.06077712029218674
loss_pred:0.07869688421487808, decouple_loss:0.060663945972919464
loss_pred:0.07858070731163025, decouple_loss:0.061414025723934174
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0815814882516861, avg_mse: 0.07840851694345474
current test mse: 0.078409
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699954986572266, gen p mean: 0.0, mean p set: 0.4486927390098572
The modified gen p mean: 0.4483000934123993, gen p mean: 0.0, mean p set: 0.4478755593299866
loss_pred:0.07965882867574692, decouple_loss:0.06138131022453308
loss_pred:0.07948402315378189, decouple_loss:0.06181858852505684
The modified gen p mean: 0.4511559307575226, gen p mean: 0.0, mean p set: 0.44662564992904663
loss_pred:0.08320209383964539, decouple_loss:0.06094840541481972
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44422245025634766, gen p mean: 0.0, mean p set: 0.4485190510749817
The modified gen p mean: 0.4456433951854706, gen p mean: 0.0, mean p set: 0.447934627532959
The modified gen p mean: 0.4455711543560028, gen p mean: 0.0, mean p set: 0.4472716748714447
loss_pred:0.07757530361413956, decouple_loss:0.0602160207927227
loss_pred:0.07887283712625504, decouple_loss:0.06110839918255806
loss_pred:0.07918915897607803, decouple_loss:0.06151561811566353
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44322067499160767, gen p mean: 0.0, mean p set: 0.44888240098953247
The modified gen p mean: 0.44306591153144836, gen p mean: 0.0, mean p set: 0.44860100746154785
The modified gen p mean: 0.44815051555633545, gen p mean: 0.0, mean p set: 0.44713205099105835
loss_pred:0.07772210985422134, decouple_loss:0.05987972021102905
loss_pred:0.07698777318000793, decouple_loss:0.06010272353887558
loss_pred:0.08119355142116547, decouple_loss:0.05982086434960365
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4436105191707611, gen p mean: 0.0, mean p set: 0.4473371207714081
The modified gen p mean: 0.4453096389770508, gen p mean: 0.0, mean p set: 0.44785767793655396
The modified gen p mean: 0.44698861241340637, gen p mean: 0.0, mean p set: 0.4471038579940796
loss_pred:0.07491730898618698, decouple_loss:0.05733725056052208
loss_pred:0.07857204228639603, decouple_loss:0.057960767298936844
loss_pred:0.07860464602708817, decouple_loss:0.05840373784303665
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.440189927816391, gen p mean: 0.0, mean p set: 0.44862768054008484
The modified gen p mean: 0.4420064389705658, gen p mean: 0.0, mean p set: 0.44732168316841125
The modified gen p mean: 0.44488805532455444, gen p mean: 0.0, mean p set: 0.4477875828742981
loss_pred:0.07690617442131042, decouple_loss:0.056941282004117966
loss_pred:0.07499425858259201, decouple_loss:0.05600787699222565
loss_pred:0.07646168023347855, decouple_loss:0.0570036955177784
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44427499175071716, gen p mean: 0.0, mean p set: 0.44708362221717834
The modified gen p mean: 0.4409797787666321, gen p mean: 0.0, mean p set: 0.4482881724834442
The modified gen p mean: 0.4436815679073334, gen p mean: 0.0, mean p set: 0.4471050798892975
loss_pred:0.07550786435604095, decouple_loss:0.055966854095458984
loss_pred:0.07584405690431595, decouple_loss:0.05606004223227501
loss_pred:0.0733586922287941, decouple_loss:0.05493555963039398
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44560956954956055, gen p mean: 0.0, mean p set: 0.4486611485481262
The modified gen p mean: 0.44692450761795044, gen p mean: 0.0, mean p set: 0.44817930459976196
The modified gen p mean: 0.44795066118240356, gen p mean: 0.0, mean p set: 0.44842812418937683
loss_pred:0.07329469174146652, decouple_loss:0.0570865236222744
loss_pred:0.07570209354162216, decouple_loss:0.05537421628832817
loss_pred:0.07431451976299286, decouple_loss:0.055950827896595
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45184892416000366, gen p mean: 0.0, mean p set: 0.4473738372325897
The modified gen p mean: 0.44629791378974915, gen p mean: 0.0, mean p set: 0.44923636317253113
The modified gen p mean: 0.4505540430545807, gen p mean: 0.0, mean p set: 0.4471876323223114
loss_pred:0.07627417147159576, decouple_loss:0.053945425897836685
loss_pred:0.07461978495121002, decouple_loss:0.054650478065013885
loss_pred:0.07703518867492676, decouple_loss:0.05416324734687805
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524952471256256, gen p mean: 0.0, mean p set: 0.44743743538856506
The modified gen p mean: 0.4496534466743469, gen p mean: 0.0, mean p set: 0.44814640283584595
The modified gen p mean: 0.4463936686515808, gen p mean: 0.0, mean p set: 0.44801655411720276
loss_pred:0.08083284646272659, decouple_loss:0.05422065779566765
loss_pred:0.0742078348994255, decouple_loss:0.05398417264223099
loss_pred:0.07486871629953384, decouple_loss:0.05457888916134834
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4381915032863617, gen p mean: 0.0, mean p set: 0.4476839005947113
The modified gen p mean: 0.43764156103134155, gen p mean: 0.0, mean p set: 0.4476470947265625
The modified gen p mean: 0.4405600130558014, gen p mean: 0.0, mean p set: 0.4477759599685669
loss_pred:0.07338760793209076, decouple_loss:0.0534222349524498
loss_pred:0.07426533848047256, decouple_loss:0.05539235100150108
loss_pred:0.07243386656045914, decouple_loss:0.056091248989105225
2023-05-02 14:56:14 testing...
The modified gen p mean: 0.4508993327617645, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4512188732624054, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4519544541835785, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.07503780722618103, decouple_loss:0.054140832275152206
loss_pred:0.07549342513084412, decouple_loss:0.05430259183049202
loss_pred:0.07486623525619507, decouple_loss:0.05497736856341362
WV_0_PC_0_EH_0_PS_40_6, loss: 0.07785617560148239, avg_mse: 0.07483678311109543
current test mse: 0.074837
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483751356601715, gen p mean: 0.0, mean p set: 0.4486280083656311
The modified gen p mean: 0.45194050669670105, gen p mean: 0.0, mean p set: 0.44832831621170044
loss_pred:0.07275283336639404, decouple_loss:0.053162023425102234
loss_pred:0.07100679725408554, decouple_loss:0.05401881784200668
The modified gen p mean: 0.45302003622055054, gen p mean: 0.0, mean p set: 0.4471111297607422
loss_pred:0.0772387683391571, decouple_loss:0.05271478742361069
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45514118671417236, gen p mean: 0.0, mean p set: 0.4477977156639099
The modified gen p mean: 0.4545176029205322, gen p mean: 0.0, mean p set: 0.4479525089263916
The modified gen p mean: 0.45000314712524414, gen p mean: 0.0, mean p set: 0.44872787594795227
loss_pred:0.07197728008031845, decouple_loss:0.055993881076574326
loss_pred:0.07450373470783234, decouple_loss:0.05380864441394806
loss_pred:0.07387357950210571, decouple_loss:0.055478647351264954
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4428653419017792, gen p mean: 0.0, mean p set: 0.4470026195049286
The modified gen p mean: 0.44171953201293945, gen p mean: 0.0, mean p set: 0.44739529490470886
The modified gen p mean: 0.4428732097148895, gen p mean: 0.0, mean p set: 0.4465501010417938
loss_pred:0.07436034828424454, decouple_loss:0.053823232650756836
loss_pred:0.07224966585636139, decouple_loss:0.051865722984075546
loss_pred:0.07959633320569992, decouple_loss:0.05395070090889931
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44492390751838684, gen p mean: 0.0, mean p set: 0.44717565178871155
The modified gen p mean: 0.445203959941864, gen p mean: 0.0, mean p set: 0.4480327367782593
The modified gen p mean: 0.4439181387424469, gen p mean: 0.0, mean p set: 0.4474334716796875
loss_pred:0.07565091550350189, decouple_loss:0.05319037660956383
loss_pred:0.07516935467720032, decouple_loss:0.05482562258839607
loss_pred:0.07340667396783829, decouple_loss:0.053079549223184586
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46052131056785583, gen p mean: 0.0, mean p set: 0.44764021039009094
The modified gen p mean: 0.4573625326156616, gen p mean: 0.0, mean p set: 0.447416752576828
The modified gen p mean: 0.45801451802253723, gen p mean: 0.0, mean p set: 0.44786933064460754
loss_pred:0.07590041309595108, decouple_loss:0.05332612991333008
loss_pred:0.07075736671686172, decouple_loss:0.05253850296139717
loss_pred:0.0724128857254982, decouple_loss:0.052779458463191986
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45183342695236206, gen p mean: 0.0, mean p set: 0.4470112919807434
The modified gen p mean: 0.45314642786979675, gen p mean: 0.0, mean p set: 0.4477759003639221
The modified gen p mean: 0.45211338996887207, gen p mean: 0.0, mean p set: 0.44768741726875305
loss_pred:0.07117690145969391, decouple_loss:0.05120306834578514
loss_pred:0.07366635650396347, decouple_loss:0.051630936563014984
loss_pred:0.0713256374001503, decouple_loss:0.05201469734311104
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459206163883209, gen p mean: 0.0, mean p set: 0.4476739168167114
The modified gen p mean: 0.44813454151153564, gen p mean: 0.0, mean p set: 0.44751641154289246
The modified gen p mean: 0.44461867213249207, gen p mean: 0.0, mean p set: 0.44688504934310913
loss_pred:0.07062440365552902, decouple_loss:0.05127212777733803
loss_pred:0.06986954808235168, decouple_loss:0.049251358956098557
loss_pred:0.0714605376124382, decouple_loss:0.05194229632616043
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4448866546154022, gen p mean: 0.0, mean p set: 0.44869264960289
The modified gen p mean: 0.4503953754901886, gen p mean: 0.0, mean p set: 0.44765499234199524
The modified gen p mean: 0.44691815972328186, gen p mean: 0.0, mean p set: 0.44764676690101624
loss_pred:0.07332023233175278, decouple_loss:0.05203224718570709
loss_pred:0.0730178952217102, decouple_loss:0.05371434986591339
loss_pred:0.07078991830348969, decouple_loss:0.05187035724520683
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4445493221282959, gen p mean: 0.0, mean p set: 0.4477570950984955
The modified gen p mean: 0.44527140259742737, gen p mean: 0.0, mean p set: 0.4476735293865204
The modified gen p mean: 0.44829246401786804, gen p mean: 0.0, mean p set: 0.4465774595737457
loss_pred:0.06997966766357422, decouple_loss:0.04976209998130798
loss_pred:0.07109596580266953, decouple_loss:0.049677859991788864
loss_pred:0.0715060830116272, decouple_loss:0.05014365166425705
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520162343978882, gen p mean: 0.0, mean p set: 0.4465752840042114
The modified gen p mean: 0.450575053691864, gen p mean: 0.0, mean p set: 0.44933852553367615
The modified gen p mean: 0.4520808756351471, gen p mean: 0.0, mean p set: 0.4466271698474884
loss_pred:0.07155396044254303, decouple_loss:0.05783938616514206
loss_pred:0.07058239728212357, decouple_loss:0.05593596771359444
loss_pred:0.06810951232910156, decouple_loss:0.05150938779115677
2023-05-02 15:00:33 testing...
The modified gen p mean: 0.4530484974384308, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45353150367736816, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45418107509613037, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.07100770622491837, decouple_loss:0.051267798990011215
loss_pred:0.07143581658601761, decouple_loss:0.05237666517496109
loss_pred:0.07038459926843643, decouple_loss:0.051682986319065094
WV_0_PC_0_EH_0_PS_40_6, loss: 0.07353150099515915, avg_mse: 0.07061735540628433
current test mse: 0.070617
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45319634675979614, gen p mean: 0.0, mean p set: 0.4478280544281006
The modified gen p mean: 0.45274341106414795, gen p mean: 0.0, mean p set: 0.44694921374320984
loss_pred:0.06871651113033295, decouple_loss:0.056202325969934464
loss_pred:0.06881379336118698, decouple_loss:0.05516332760453224
The modified gen p mean: 0.4552512466907501, gen p mean: 0.0, mean p set: 0.44715940952301025
loss_pred:0.06980907171964645, decouple_loss:0.050627440214157104
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513208568096161, gen p mean: 0.0, mean p set: 0.4476941227912903
The modified gen p mean: 0.4500112533569336, gen p mean: 0.0, mean p set: 0.4477439522743225
The modified gen p mean: 0.45181241631507874, gen p mean: 0.0, mean p set: 0.4461599588394165
loss_pred:0.070026695728302, decouple_loss:0.054742664098739624
loss_pred:0.07150892913341522, decouple_loss:0.05182860419154167
loss_pred:0.07074827700853348, decouple_loss:0.052687954157590866
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647684693336487, gen p mean: 0.0, mean p set: 0.44868341088294983
The modified gen p mean: 0.4454110562801361, gen p mean: 0.0, mean p set: 0.4471711814403534
The modified gen p mean: 0.44844895601272583, gen p mean: 0.0, mean p set: 0.44668781757354736
loss_pred:0.06790442764759064, decouple_loss:0.05429122969508171
loss_pred:0.0686769187450409, decouple_loss:0.051768552511930466
loss_pred:0.06688148528337479, decouple_loss:0.05259038880467415
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44631606340408325, gen p mean: 0.0, mean p set: 0.447246253490448
The modified gen p mean: 0.4438225030899048, gen p mean: 0.0, mean p set: 0.44865259528160095
The modified gen p mean: 0.4474905729293823, gen p mean: 0.0, mean p set: 0.44787678122520447
loss_pred:0.06683836877346039, decouple_loss:0.05175268277525902
loss_pred:0.06774557381868362, decouple_loss:0.05376815050840378
loss_pred:0.0677836462855339, decouple_loss:0.05222935229539871
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880223274230957, gen p mean: 0.0, mean p set: 0.44907623529434204
The modified gen p mean: 0.44596919417381287, gen p mean: 0.0, mean p set: 0.4486584961414337
The modified gen p mean: 0.44804513454437256, gen p mean: 0.0, mean p set: 0.4469289183616638
loss_pred:0.06836548447608948, decouple_loss:0.053951703011989594
loss_pred:0.0666186511516571, decouple_loss:0.0526120588183403
loss_pred:0.0664377436041832, decouple_loss:0.05202266946434975
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46082907915115356, gen p mean: 0.0, mean p set: 0.44725558161735535
The modified gen p mean: 0.461246520280838, gen p mean: 0.0, mean p set: 0.4473998546600342
The modified gen p mean: 0.4602847993373871, gen p mean: 0.0, mean p set: 0.44647401571273804
loss_pred:0.06642450392246246, decouple_loss:0.05121191218495369
loss_pred:0.06844640523195267, decouple_loss:0.050940919667482376
loss_pred:0.06682201474905014, decouple_loss:0.05124661698937416
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736427068710327, gen p mean: 0.0, mean p set: 0.4487825632095337
The modified gen p mean: 0.4505871832370758, gen p mean: 0.0, mean p set: 0.44794052839279175
The modified gen p mean: 0.4496898949146271, gen p mean: 0.0, mean p set: 0.4457697868347168
loss_pred:0.06600106507539749, decouple_loss:0.053412239998579025
loss_pred:0.06714601814746857, decouple_loss:0.05154309421777725
loss_pred:0.06755618751049042, decouple_loss:0.05284598097205162
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513742923736572, gen p mean: 0.0, mean p set: 0.4471926689147949
The modified gen p mean: 0.44957539439201355, gen p mean: 0.0, mean p set: 0.4484470784664154
The modified gen p mean: 0.45005008578300476, gen p mean: 0.0, mean p set: 0.44680535793304443
loss_pred:0.0675671324133873, decouple_loss:0.051169462502002716
loss_pred:0.06562827527523041, decouple_loss:0.05092036351561546
loss_pred:0.06419287621974945, decouple_loss:0.05104634165763855
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45425623655319214, gen p mean: 0.0, mean p set: 0.4473566710948944
The modified gen p mean: 0.45549196004867554, gen p mean: 0.0, mean p set: 0.44689324498176575
The modified gen p mean: 0.457101970911026, gen p mean: 0.0, mean p set: 0.44651132822036743
loss_pred:0.06472417712211609, decouple_loss:0.051476676017045975
loss_pred:0.0677737444639206, decouple_loss:0.052511584013700485
loss_pred:0.06437046080827713, decouple_loss:0.053401727229356766
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4400857090950012, gen p mean: 0.0, mean p set: 0.44931700825691223
The modified gen p mean: 0.4417746365070343, gen p mean: 0.0, mean p set: 0.4467838406562805
The modified gen p mean: 0.4437945485115051, gen p mean: 0.0, mean p set: 0.4478095471858978
loss_pred:0.06504002958536148, decouple_loss:0.051972076296806335
loss_pred:0.06383286416530609, decouple_loss:0.05307828262448311
loss_pred:0.06666755676269531, decouple_loss:0.05369838699698448
2023-05-02 15:04:12 testing...
The modified gen p mean: 0.4438038766384125, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4437205195426941, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44401854276657104, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.06731706112623215, decouple_loss:0.05194995552301407
loss_pred:0.06716432422399521, decouple_loss:0.051642391830682755
loss_pred:0.06677279621362686, decouple_loss:0.052923742681741714
WV_0_PC_0_EH_0_PS_40_6, loss: 0.06969332695007324, avg_mse: 0.06685792654752731
current test mse: 0.066858
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44317591190338135, gen p mean: 0.0, mean p set: 0.44712045788764954
The modified gen p mean: 0.44527506828308105, gen p mean: 0.0, mean p set: 0.4467402696609497
loss_pred:0.06325162947177887, decouple_loss:0.05158943682909012
loss_pred:0.06473099440336227, decouple_loss:0.05138404294848442
The modified gen p mean: 0.4439379870891571, gen p mean: 0.0, mean p set: 0.44927704334259033
loss_pred:0.06516367197036743, decouple_loss:0.051145486533641815
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543745219707489, gen p mean: 0.0, mean p set: 0.448486864566803
The modified gen p mean: 0.45692166686058044, gen p mean: 0.0, mean p set: 0.4473038911819458
The modified gen p mean: 0.45442286133766174, gen p mean: 0.0, mean p set: 0.448073148727417
loss_pred:0.06608598679304123, decouple_loss:0.051809970289468765
loss_pred:0.06412510573863983, decouple_loss:0.05089971423149109
loss_pred:0.06515111029148102, decouple_loss:0.05151627957820892
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4611739218235016, gen p mean: 0.0, mean p set: 0.44673389196395874
The modified gen p mean: 0.46111375093460083, gen p mean: 0.0, mean p set: 0.44952791929244995
The modified gen p mean: 0.4609985053539276, gen p mean: 0.0, mean p set: 0.44752782583236694
loss_pred:0.06418811529874802, decouple_loss:0.04919040948152542
loss_pred:0.06367740780115128, decouple_loss:0.05106477439403534
loss_pred:0.06597147136926651, decouple_loss:0.04937733709812164
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45190873742103577, gen p mean: 0.0, mean p set: 0.4471011161804199
The modified gen p mean: 0.4554540812969208, gen p mean: 0.0, mean p set: 0.44630563259124756
The modified gen p mean: 0.4533008933067322, gen p mean: 0.0, mean p set: 0.44782623648643494
loss_pred:0.06564497947692871, decouple_loss:0.04982816427946091
loss_pred:0.06147745996713638, decouple_loss:0.04908665642142296
loss_pred:0.06330309808254242, decouple_loss:0.05019400268793106
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4427274763584137, gen p mean: 0.0, mean p set: 0.4482913017272949
The modified gen p mean: 0.44181540608406067, gen p mean: 0.0, mean p set: 0.44630685448646545
The modified gen p mean: 0.4433397352695465, gen p mean: 0.0, mean p set: 0.44675159454345703
loss_pred:0.06262143701314926, decouple_loss:0.04904145002365112
loss_pred:0.06329833716154099, decouple_loss:0.048486776649951935
loss_pred:0.06120884418487549, decouple_loss:0.048602279275655746
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44623664021492004, gen p mean: 0.0, mean p set: 0.4479255974292755
The modified gen p mean: 0.4462708532810211, gen p mean: 0.0, mean p set: 0.44808098673820496
The modified gen p mean: 0.4488431513309479, gen p mean: 0.0, mean p set: 0.4473665952682495
loss_pred:0.06405537575483322, decouple_loss:0.048356059938669205
loss_pred:0.0624365508556366, decouple_loss:0.048130955547094345
loss_pred:0.06484566628932953, decouple_loss:0.04966079816222191
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45778539776802063, gen p mean: 0.0, mean p set: 0.447951078414917
The modified gen p mean: 0.45605096220970154, gen p mean: 0.0, mean p set: 0.44758522510528564
The modified gen p mean: 0.4554159343242645, gen p mean: 0.0, mean p set: 0.4490543007850647
loss_pred:0.06549295037984848, decouple_loss:0.04811418429017067
loss_pred:0.06157778948545456, decouple_loss:0.04805562272667885
loss_pred:0.0640195980668068, decouple_loss:0.04965421184897423
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472868740558624, gen p mean: 0.0, mean p set: 0.44695523381233215
The modified gen p mean: 0.4490776062011719, gen p mean: 0.0, mean p set: 0.4461652636528015
The modified gen p mean: 0.4484049677848816, gen p mean: 0.0, mean p set: 0.44799599051475525
loss_pred:0.061934471130371094, decouple_loss:0.047900378704071045
loss_pred:0.06542693078517914, decouple_loss:0.04798967391252518
loss_pred:0.06397664546966553, decouple_loss:0.0488920584321022
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44391000270843506, gen p mean: 0.0, mean p set: 0.44625577330589294
The modified gen p mean: 0.44095155596733093, gen p mean: 0.0, mean p set: 0.44858697056770325
loss_pred:0.0628458559513092, decouple_loss:0.04698551818728447
The modified gen p mean: 0.44218283891677856, gen p mean: 0.0, mean p set: 0.44573795795440674
loss_pred:0.062230050563812256, decouple_loss:0.046988289803266525
loss_pred:0.06383787095546722, decouple_loss:0.04782131686806679
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
NaN value num: 0
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154428482055664, gen p mean: 0.0, mean p set: 0.4504591226577759
The modified gen p mean: 0.45124250650405884, gen p mean: 0.0, mean p set: 0.44902974367141724
The modified gen p mean: 0.4508454203605652, gen p mean: 0.0, mean p set: 0.44988682866096497
loss_pred:0.0642184242606163, decouple_loss:0.04969432204961777
loss_pred:0.06898824870586395, decouple_loss:0.04928986728191376
loss_pred:0.064744733273983, decouple_loss:0.05052005127072334
2023-05-02 15:08:39 testing...
The modified gen p mean: 0.4576971232891083, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4577208161354065, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4577810764312744, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.06702805310487747, decouple_loss:0.04969051107764244
loss_pred:0.06736944615840912, decouple_loss:0.04970638081431389
loss_pred:0.06636251509189606, decouple_loss:0.049860723316669464
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0694076344370842, avg_mse: 0.06715642660856247
current test mse: 0.067156
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4579177796840668, gen p mean: 0.0, mean p set: 0.4515438675880432
The modified gen p mean: 0.45890694856643677, gen p mean: 0.0, mean p set: 0.4500705897808075
loss_pred:0.06943648308515549, decouple_loss:0.05445890128612518
loss_pred:0.06751176714897156, decouple_loss:0.05406838282942772
The modified gen p mean: 0.45732271671295166, gen p mean: 0.0, mean p set: 0.4505566358566284
loss_pred:0.06558242440223694, decouple_loss:0.0537329725921154
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44543129205703735, gen p mean: 0.0, mean p set: 0.4495418667793274
The modified gen p mean: 0.4467547535896301, gen p mean: 0.0, mean p set: 0.4505636692047119
The modified gen p mean: 0.44501039385795593, gen p mean: 0.0, mean p set: 0.45067599415779114
loss_pred:0.06250358372926712, decouple_loss:0.052780669182538986
loss_pred:0.06633969396352768, decouple_loss:0.05344843491911888
loss_pred:0.0638834610581398, decouple_loss:0.05328543484210968
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44096508622169495, gen p mean: 0.0, mean p set: 0.44983911514282227
The modified gen p mean: 0.4386608600616455, gen p mean: 0.0, mean p set: 0.44816452264785767
The modified gen p mean: 0.43956458568573, gen p mean: 0.0, mean p set: 0.449349045753479
loss_pred:0.06610107421875, decouple_loss:0.053527578711509705
loss_pred:0.06367732584476471, decouple_loss:0.053071774542331696
loss_pred:0.06398317962884903, decouple_loss:0.053472794592380524
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155513286590576, gen p mean: 0.0, mean p set: 0.44952985644340515
The modified gen p mean: 0.44842422008514404, gen p mean: 0.0, mean p set: 0.450813353061676
The modified gen p mean: 0.44869527220726013, gen p mean: 0.0, mean p set: 0.45070016384124756
loss_pred:0.06499093025922775, decouple_loss:0.052046146243810654
loss_pred:0.06485319882631302, decouple_loss:0.05280516296625137
loss_pred:0.06357883661985397, decouple_loss:0.052825912833213806
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45601385831832886, gen p mean: 0.0, mean p set: 0.45082634687423706
The modified gen p mean: 0.45652610063552856, gen p mean: 0.0, mean p set: 0.44911229610443115
The modified gen p mean: 0.45649561285972595, gen p mean: 0.0, mean p set: 0.4501173794269562
loss_pred:0.06531031429767609, decouple_loss:0.05295668914914131
loss_pred:0.06158997491002083, decouple_loss:0.05211567133665085
loss_pred:0.06308862566947937, decouple_loss:0.05352475121617317
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510069191455841, gen p mean: 0.0, mean p set: 0.4500848054885864
The modified gen p mean: 0.45143556594848633, gen p mean: 0.0, mean p set: 0.4488218426704407
The modified gen p mean: 0.4515150189399719, gen p mean: 0.0, mean p set: 0.4495590031147003
loss_pred:0.06172637268900871, decouple_loss:0.053566936403512955
loss_pred:0.06540216505527496, decouple_loss:0.054232485592365265
loss_pred:0.06293808668851852, decouple_loss:0.05312779173254967
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521638751029968, gen p mean: 0.0, mean p set: 0.4504770338535309
The modified gen p mean: 0.4513898193836212, gen p mean: 0.0, mean p set: 0.4497811496257782
The modified gen p mean: 0.4515804052352905, gen p mean: 0.0, mean p set: 0.44963738322257996
loss_pred:0.06260118633508682, decouple_loss:0.05253354832530022
loss_pred:0.061829593032598495, decouple_loss:0.05315279960632324
loss_pred:0.060827091336250305, decouple_loss:0.05397845432162285
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518999755382538, gen p mean: 0.0, mean p set: 0.44938161969184875
The modified gen p mean: 0.4501420259475708, gen p mean: 0.0, mean p set: 0.45015186071395874
The modified gen p mean: 0.45110389590263367, gen p mean: 0.0, mean p set: 0.44850265979766846
loss_pred:0.06063738837838173, decouple_loss:0.05122317746281624
loss_pred:0.06501992791891098, decouple_loss:0.05304281786084175
loss_pred:0.06117620691657066, decouple_loss:0.0528402142226696
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466957449913025, gen p mean: 0.0, mean p set: 0.44916728138923645
The modified gen p mean: 0.44729897379875183, gen p mean: 0.0, mean p set: 0.4490301311016083
The modified gen p mean: 0.4469684958457947, gen p mean: 0.0, mean p set: 0.44845086336135864
loss_pred:0.06303179264068604, decouple_loss:0.05228922516107559
loss_pred:0.06037158891558647, decouple_loss:0.05100785940885544
loss_pred:0.0624140165746212, decouple_loss:0.05110528692603111
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44196444749832153, gen p mean: 0.0, mean p set: 0.45041564106941223
The modified gen p mean: 0.4409163296222687, gen p mean: 0.0, mean p set: 0.4498702585697174
The modified gen p mean: 0.44159719347953796, gen p mean: 0.0, mean p set: 0.4500495493412018
loss_pred:0.06306091696023941, decouple_loss:0.050755951553583145
loss_pred:0.06093927472829819, decouple_loss:0.050750572234392166
loss_pred:0.061058223247528076, decouple_loss:0.0488935261964798
2023-05-02 15:12:18 testing...
The modified gen p mean: 0.4440141022205353, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.442940890789032, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44415196776390076, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.06645984202623367, decouple_loss:0.05177094042301178
loss_pred:0.06581398844718933, decouple_loss:0.05119362100958824
loss_pred:0.06525897979736328, decouple_loss:0.051911406219005585
WV_0_PC_0_EH_0_PS_40_6, loss: 0.06842553615570068, avg_mse: 0.06656727939844131
current test mse: 0.066567
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4419519007205963, gen p mean: 0.0, mean p set: 0.4493407607078552
loss_pred:0.060945115983486176, decouple_loss:0.05054983124136925
The modified gen p mean: 0.4443395137786865, gen p mean: 0.0, mean p set: 0.4496253430843353
loss_pred:0.061027687042951584, decouple_loss:0.04997335001826286
The modified gen p mean: 0.44421249628067017, gen p mean: 0.0, mean p set: 0.45058029890060425
loss_pred:0.06121239438652992, decouple_loss:0.051494985818862915
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903048872947693, gen p mean: 0.0, mean p set: 0.4484533667564392
The modified gen p mean: 0.44791245460510254, gen p mean: 0.0, mean p set: 0.4501064419746399
The modified gen p mean: 0.4484517276287079, gen p mean: 0.0, mean p set: 0.45010754466056824
loss_pred:0.06225357949733734, decouple_loss:0.04817996919155121
loss_pred:0.06256052851676941, decouple_loss:0.05167057365179062
loss_pred:0.060932569205760956, decouple_loss:0.0485013909637928
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4562107026576996, gen p mean: 0.0, mean p set: 0.45131051540374756
The modified gen p mean: 0.4559887647628784, gen p mean: 0.0, mean p set: 0.450359970331192
The modified gen p mean: 0.45719555020332336, gen p mean: 0.0, mean p set: 0.4485691785812378
loss_pred:0.06410425901412964, decouple_loss:0.05292762070894241
loss_pred:0.059264034032821655, decouple_loss:0.04864070191979408
loss_pred:0.06063155457377434, decouple_loss:0.04958731681108475
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4598047435283661, gen p mean: 0.0, mean p set: 0.4500916600227356
The modified gen p mean: 0.4623745083808899, gen p mean: 0.0, mean p set: 0.4507721960544586
The modified gen p mean: 0.46121060848236084, gen p mean: 0.0, mean p set: 0.4497474730014801
loss_pred:0.05941269174218178, decouple_loss:0.047705430537462234
loss_pred:0.06374358385801315, decouple_loss:0.04972662031650543
loss_pred:0.06013442575931549, decouple_loss:0.04821179434657097
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45748433470726013, gen p mean: 0.0, mean p set: 0.44821181893348694
The modified gen p mean: 0.4587336480617523, gen p mean: 0.0, mean p set: 0.44831863045692444
The modified gen p mean: 0.4550187289714813, gen p mean: 0.0, mean p set: 0.45079004764556885
loss_pred:0.05963124707341194, decouple_loss:0.047251373529434204
loss_pred:0.06220550090074539, decouple_loss:0.04696948081254959
loss_pred:0.06087976694107056, decouple_loss:0.04808223247528076
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450366348028183, gen p mean: 0.0, mean p set: 0.4487202763557434
The modified gen p mean: 0.44930002093315125, gen p mean: 0.0, mean p set: 0.4495586156845093
The modified gen p mean: 0.45232316851615906, gen p mean: 0.0, mean p set: 0.44967490434646606
loss_pred:0.05963844060897827, decouple_loss:0.04672854021191597
loss_pred:0.060608893632888794, decouple_loss:0.04689614102244377
loss_pred:0.06251423060894012, decouple_loss:0.04765944182872772
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961273670196533, gen p mean: 0.0, mean p set: 0.44972777366638184
The modified gen p mean: 0.4489833116531372, gen p mean: 0.0, mean p set: 0.45089972019195557
The modified gen p mean: 0.4511970579624176, gen p mean: 0.0, mean p set: 0.4511880874633789
loss_pred:0.05944131314754486, decouple_loss:0.04809558391571045
loss_pred:0.05870050936937332, decouple_loss:0.04624094069004059
loss_pred:0.06075943633913994, decouple_loss:0.0497417114675045
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527831971645355, gen p mean: 0.0, mean p set: 0.44948363304138184
The modified gen p mean: 0.44898802042007446, gen p mean: 0.0, mean p set: 0.450480192899704
The modified gen p mean: 0.4495747983455658, gen p mean: 0.0, mean p set: 0.4503614604473114
loss_pred:0.05932005122303963, decouple_loss:0.04795815050601959
loss_pred:0.05975303426384926, decouple_loss:0.047393690794706345
loss_pred:0.059746164828538895, decouple_loss:0.05067107826471329
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493759274482727, gen p mean: 0.0, mean p set: 0.4487801790237427
The modified gen p mean: 0.4472196102142334, gen p mean: 0.0, mean p set: 0.4498787224292755
The modified gen p mean: 0.44944265484809875, gen p mean: 0.0, mean p set: 0.4481101632118225
loss_pred:0.05894376337528229, decouple_loss:0.046569012105464935
loss_pred:0.05805438011884689, decouple_loss:0.04723833501338959
loss_pred:0.05814396217465401, decouple_loss:0.04662904888391495
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
NaN value num: 0
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538366496562958, gen p mean: 0.0, mean p set: 0.4497682452201843
The modified gen p mean: 0.4492052495479584, gen p mean: 0.0, mean p set: 0.451905757188797
The modified gen p mean: 0.4519259035587311, gen p mean: 0.0, mean p set: 0.4516597390174866
loss_pred:0.06103270873427391, decouple_loss:0.0469508059322834
loss_pred:0.06338856369256973, decouple_loss:0.047780849039554596
loss_pred:0.06061490625143051, decouple_loss:0.04604291915893555
2023-05-02 15:16:47 testing...
The modified gen p mean: 0.45369425415992737, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4561583697795868, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.45555827021598816, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.063700370490551, decouple_loss:0.04652704298496246
loss_pred:0.06291498243808746, decouple_loss:0.047235433012247086
loss_pred:0.06459806859493256, decouple_loss:0.04720647633075714
WV_0_PC_0_EH_0_PS_40_6, loss: 0.06608729064464569, avg_mse: 0.06455224752426147
current test mse: 0.064552
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45617565512657166, gen p mean: 0.0, mean p set: 0.4525294005870819
The modified gen p mean: 0.45640450716018677, gen p mean: 0.0, mean p set: 0.45418456196784973
loss_pred:0.0607389360666275, decouple_loss:0.045277852565050125
loss_pred:0.0618196502327919, decouple_loss:0.04634780064225197
The modified gen p mean: 0.4530247151851654, gen p mean: 0.0, mean p set: 0.4515514075756073
loss_pred:0.06254520267248154, decouple_loss:0.045533888041973114
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4562910497188568, gen p mean: 0.0, mean p set: 0.4515727162361145
The modified gen p mean: 0.4583451747894287, gen p mean: 0.0, mean p set: 0.4502951502799988
The modified gen p mean: 0.45674294233322144, gen p mean: 0.0, mean p set: 0.45007672905921936
loss_pred:0.060339249670505524, decouple_loss:0.044871680438518524
loss_pred:0.059957824647426605, decouple_loss:0.04491960629820824
loss_pred:0.058078259229660034, decouple_loss:0.04374320060014725
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473314881324768, gen p mean: 0.0, mean p set: 0.44987794756889343
The modified gen p mean: 0.44856950640678406, gen p mean: 0.0, mean p set: 0.44993916153907776
The modified gen p mean: 0.44769176840782166, gen p mean: 0.0, mean p set: 0.452263742685318
loss_pred:0.062131766229867935, decouple_loss:0.0465686097741127
loss_pred:0.05989200994372368, decouple_loss:0.046465445309877396
loss_pred:0.05960404872894287, decouple_loss:0.044765815138816833
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526597559452057, gen p mean: 0.0, mean p set: 0.4513280689716339
The modified gen p mean: 0.44851118326187134, gen p mean: 0.0, mean p set: 0.452203631401062
The modified gen p mean: 0.44880855083465576, gen p mean: 0.0, mean p set: 0.4521483778953552
loss_pred:0.060784097760915756, decouple_loss:0.04490484297275543
loss_pred:0.06043378263711929, decouple_loss:0.043997786939144135
loss_pred:0.06257852911949158, decouple_loss:0.04568636789917946
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46596407890319824, gen p mean: 0.0, mean p set: 0.4525899887084961
The modified gen p mean: 0.4696636199951172, gen p mean: 0.0, mean p set: 0.45029133558273315
The modified gen p mean: 0.46820858120918274, gen p mean: 0.0, mean p set: 0.4498836398124695
loss_pred:0.06066787242889404, decouple_loss:0.04481988400220871
loss_pred:0.06262979656457901, decouple_loss:0.04665439575910568
loss_pred:0.06174058839678764, decouple_loss:0.04559130594134331
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4546922445297241, gen p mean: 0.0, mean p set: 0.45172062516212463
The modified gen p mean: 0.45581093430519104, gen p mean: 0.0, mean p set: 0.45147088170051575
The modified gen p mean: 0.4587618410587311, gen p mean: 0.0, mean p set: 0.4504096210002899
loss_pred:0.06192381680011749, decouple_loss:0.044519778341054916
loss_pred:0.06076653301715851, decouple_loss:0.044883597642183304
loss_pred:0.06156416982412338, decouple_loss:0.045182790607213974
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43854907155036926, gen p mean: 0.0, mean p set: 0.4502543807029724
The modified gen p mean: 0.4378487169742584, gen p mean: 0.0, mean p set: 0.4513498842716217
The modified gen p mean: 0.4411592185497284, gen p mean: 0.0, mean p set: 0.45082080364227295
loss_pred:0.0625644400715828, decouple_loss:0.04397948831319809
loss_pred:0.059062931686639786, decouple_loss:0.044456709176301956
loss_pred:0.060208745300769806, decouple_loss:0.04403753951191902
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664937257766724, gen p mean: 0.0, mean p set: 0.45054367184638977
The modified gen p mean: 0.4483487010002136, gen p mean: 0.0, mean p set: 0.4509834945201874
The modified gen p mean: 0.4471864402294159, gen p mean: 0.0, mean p set: 0.45135000348091125
loss_pred:0.05737956240773201, decouple_loss:0.04417134076356888
loss_pred:0.05771109089255333, decouple_loss:0.0442313477396965
loss_pred:0.06014109402894974, decouple_loss:0.04397513344883919
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46405914425849915, gen p mean: 0.0, mean p set: 0.4498387575149536
The modified gen p mean: 0.46566301584243774, gen p mean: 0.0, mean p set: 0.4503602981567383
The modified gen p mean: 0.46345359086990356, gen p mean: 0.0, mean p set: 0.45251601934432983
loss_pred:0.06092919781804085, decouple_loss:0.045147381722927094
loss_pred:0.058190781623125076, decouple_loss:0.044051866978406906
loss_pred:0.058946944773197174, decouple_loss:0.04489171877503395
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4586793780326843, gen p mean: 0.0, mean p set: 0.4521428644657135
The modified gen p mean: 0.45763522386550903, gen p mean: 0.0, mean p set: 0.45241761207580566
loss_pred:0.05715395510196686, decouple_loss:0.04233299940824509
The modified gen p mean: 0.4572764039039612, gen p mean: 0.0, mean p set: 0.4509196877479553
loss_pred:0.059505388140678406, decouple_loss:0.042382411658763885
loss_pred:0.0624975748360157, decouple_loss:0.04221591353416443
2023-05-02 15:20:30 testing...
The modified gen p mean: 0.4424656927585602, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4444429576396942, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.442546546459198, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.06303446739912033, decouple_loss:0.04728702828288078
loss_pred:0.061291392892599106, decouple_loss:0.04740007594227791
loss_pred:0.06202235072851181, decouple_loss:0.047135818749666214
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0644797831773758, avg_mse: 0.06292448937892914
current test mse: 0.062924
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44299736618995667, gen p mean: 0.0, mean p set: 0.4515630006790161
The modified gen p mean: 0.444685697555542, gen p mean: 0.0, mean p set: 0.4516623318195343
loss_pred:0.05732930079102516, decouple_loss:0.04393814131617546
loss_pred:0.056746240705251694, decouple_loss:0.042753469198942184
The modified gen p mean: 0.4473002851009369, gen p mean: 0.0, mean p set: 0.4520223140716553
loss_pred:0.059797804802656174, decouple_loss:0.04334060102701187
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.441192090511322, gen p mean: 0.0, mean p set: 0.4522706866264343
The modified gen p mean: 0.4432096779346466, gen p mean: 0.0, mean p set: 0.4504365921020508
The modified gen p mean: 0.4432012736797333, gen p mean: 0.0, mean p set: 0.4513210654258728
loss_pred:0.059303347021341324, decouple_loss:0.04576251655817032
loss_pred:0.05827922001481056, decouple_loss:0.043549906462430954
loss_pred:0.0595453716814518, decouple_loss:0.04477031156420708
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45691680908203125, gen p mean: 0.0, mean p set: 0.45010536909103394
The modified gen p mean: 0.456552118062973, gen p mean: 0.0, mean p set: 0.4507746696472168
The modified gen p mean: 0.4578956961631775, gen p mean: 0.0, mean p set: 0.449973464012146
loss_pred:0.056105487048625946, decouple_loss:0.042158134281635284
loss_pred:0.06012873351573944, decouple_loss:0.0438668467104435
loss_pred:0.06090233474969864, decouple_loss:0.043135520070791245
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4595351219177246, gen p mean: 0.0, mean p set: 0.4517904818058014
The modified gen p mean: 0.4611124098300934, gen p mean: 0.0, mean p set: 0.45166799426078796
The modified gen p mean: 0.4629957973957062, gen p mean: 0.0, mean p set: 0.45294854044914246
loss_pred:0.059646692126989365, decouple_loss:0.042886752635240555
loss_pred:0.05852820724248886, decouple_loss:0.042410362511873245
loss_pred:0.05970509722828865, decouple_loss:0.043699804693460464
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475604295730591, gen p mean: 0.0, mean p set: 0.45079872012138367
The modified gen p mean: 0.44848546385765076, gen p mean: 0.0, mean p set: 0.4509831368923187
The modified gen p mean: 0.4490486681461334, gen p mean: 0.0, mean p set: 0.4532740116119385
loss_pred:0.06094450131058693, decouple_loss:0.042935170233249664
loss_pred:0.061968810856342316, decouple_loss:0.04359697550535202
loss_pred:0.05930275097489357, decouple_loss:0.046051640063524246
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44417881965637207, gen p mean: 0.0, mean p set: 0.45220157504081726
The modified gen p mean: 0.447746604681015, gen p mean: 0.0, mean p set: 0.4529906213283539
The modified gen p mean: 0.44845154881477356, gen p mean: 0.0, mean p set: 0.45228299498558044
loss_pred:0.057035740464925766, decouple_loss:0.04173413664102554
loss_pred:0.05849187821149826, decouple_loss:0.04334556683897972
loss_pred:0.05818575248122215, decouple_loss:0.04152623936533928
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45476704835891724, gen p mean: 0.0, mean p set: 0.4501630365848541
The modified gen p mean: 0.45272961258888245, gen p mean: 0.0, mean p set: 0.453868567943573
The modified gen p mean: 0.4534578323364258, gen p mean: 0.0, mean p set: 0.45361581444740295
loss_pred:0.05688575282692909, decouple_loss:0.04251665621995926
loss_pred:0.05981216952204704, decouple_loss:0.04336989298462868
loss_pred:0.05966819077730179, decouple_loss:0.04303128644824028
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456607699394226, gen p mean: 0.0, mean p set: 0.450778603553772
The modified gen p mean: 0.4465108811855316, gen p mean: 0.0, mean p set: 0.4522954225540161
The modified gen p mean: 0.4479062557220459, gen p mean: 0.0, mean p set: 0.45199474692344666
loss_pred:0.05806620046496391, decouple_loss:0.04397790879011154
loss_pred:0.057898130267858505, decouple_loss:0.04294457659125328
loss_pred:0.0609654039144516, decouple_loss:0.04217006638646126
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45919039845466614, gen p mean: 0.0, mean p set: 0.4522424042224884
The modified gen p mean: 0.4588821828365326, gen p mean: 0.0, mean p set: 0.45101073384284973
The modified gen p mean: 0.4591214954853058, gen p mean: 0.0, mean p set: 0.45190224051475525
loss_pred:0.05764596909284592, decouple_loss:0.040857575833797455
loss_pred:0.058255635201931, decouple_loss:0.04209646210074425
loss_pred:0.060976192355155945, decouple_loss:0.04137709364295006
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
NaN value num: 0
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4603450894355774, gen p mean: 0.0, mean p set: 0.4505757987499237
The modified gen p mean: 0.45664727687835693, gen p mean: 0.0, mean p set: 0.4509296715259552
The modified gen p mean: 0.4566130042076111, gen p mean: 0.0, mean p set: 0.4512987732887268
loss_pred:0.06266198307275772, decouple_loss:0.042526476085186005
loss_pred:0.05852261930704117, decouple_loss:0.04135723039507866
loss_pred:0.060925230383872986, decouple_loss:0.044449880719184875
2023-05-02 15:24:51 testing...
The modified gen p mean: 0.44934359192848206, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44905707240104675, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4502173364162445, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.06115225329995155, decouple_loss:0.0444011464715004
loss_pred:0.06213271617889404, decouple_loss:0.04546857252717018
loss_pred:0.06025559455156326, decouple_loss:0.045484479516744614
WV_0_PC_0_EH_0_PS_40_6, loss: 0.06343609094619751, avg_mse: 0.06224546581506729
current test mse: 0.062245
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515635073184967, gen p mean: 0.0, mean p set: 0.45218974351882935
The modified gen p mean: 0.4545491933822632, gen p mean: 0.0, mean p set: 0.45208606123924255
loss_pred:0.057916395366191864, decouple_loss:0.041228242218494415
loss_pred:0.05933138728141785, decouple_loss:0.044436417520046234
The modified gen p mean: 0.4491455852985382, gen p mean: 0.0, mean p set: 0.45063063502311707
loss_pred:0.05934640020132065, decouple_loss:0.04327641427516937
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841501116752625, gen p mean: 0.0, mean p set: 0.4516315758228302
The modified gen p mean: 0.45515257120132446, gen p mean: 0.0, mean p set: 0.4511035680770874
The modified gen p mean: 0.45201316475868225, gen p mean: 0.0, mean p set: 0.4510705769062042
loss_pred:0.05933048576116562, decouple_loss:0.04476774111390114
loss_pred:0.06132474169135094, decouple_loss:0.04361973702907562
loss_pred:0.05954504385590553, decouple_loss:0.04451597481966019
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4563628137111664, gen p mean: 0.0, mean p set: 0.4505743086338043
The modified gen p mean: 0.45385292172431946, gen p mean: 0.0, mean p set: 0.4523037374019623
The modified gen p mean: 0.4508226215839386, gen p mean: 0.0, mean p set: 0.45083388686180115
loss_pred:0.05816404148936272, decouple_loss:0.0439702570438385
loss_pred:0.05777180194854736, decouple_loss:0.04426175728440285
loss_pred:0.05691886693239212, decouple_loss:0.04559492692351341
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509464502334595, gen p mean: 0.0, mean p set: 0.45144134759902954
The modified gen p mean: 0.4553030729293823, gen p mean: 0.0, mean p set: 0.4507865309715271
loss_pred:0.05821160227060318, decouple_loss:0.041082799434661865
The modified gen p mean: 0.45285314321517944, gen p mean: 0.0, mean p set: 0.4518546462059021
loss_pred:0.05779251456260681, decouple_loss:0.04359815642237663
loss_pred:0.061157744377851486, decouple_loss:0.042154472321271896
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842568039894104, gen p mean: 0.0, mean p set: 0.4516811966896057
The modified gen p mean: 0.4438071548938751, gen p mean: 0.0, mean p set: 0.4492678940296173
The modified gen p mean: 0.4453525245189667, gen p mean: 0.0, mean p set: 0.45139408111572266
loss_pred:0.06123087555170059, decouple_loss:0.04360727220773697
loss_pred:0.05776645243167877, decouple_loss:0.04277415946125984
loss_pred:0.05764662101864815, decouple_loss:0.04112269729375839
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489656388759613, gen p mean: 0.0, mean p set: 0.45229944586753845
The modified gen p mean: 0.44910019636154175, gen p mean: 0.0, mean p set: 0.4513244926929474
loss_pred:0.05623061954975128, decouple_loss:0.04138711094856262
The modified gen p mean: 0.4486076831817627, gen p mean: 0.0, mean p set: 0.45150595903396606
loss_pred:0.058153606951236725, decouple_loss:0.043401408940553665
loss_pred:0.05908270180225372, decouple_loss:0.042959365993738174
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45456668734550476, gen p mean: 0.0, mean p set: 0.45300063490867615
The modified gen p mean: 0.45521146059036255, gen p mean: 0.0, mean p set: 0.45152872800827026
The modified gen p mean: 0.4577459394931793, gen p mean: 0.0, mean p set: 0.4505924582481384
loss_pred:0.05827378109097481, decouple_loss:0.04248141869902611
loss_pred:0.05814199522137642, decouple_loss:0.04358399659395218
loss_pred:0.05646700784564018, decouple_loss:0.041011787950992584
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45495542883872986, gen p mean: 0.0, mean p set: 0.4508259892463684
The modified gen p mean: 0.45599809288978577, gen p mean: 0.0, mean p set: 0.45161738991737366
The modified gen p mean: 0.4561914801597595, gen p mean: 0.0, mean p set: 0.4505697786808014
loss_pred:0.056102875620126724, decouple_loss:0.04124157503247261
loss_pred:0.05906770005822182, decouple_loss:0.04347247630357742
loss_pred:0.0614614263176918, decouple_loss:0.04281776398420334
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542059898376465, gen p mean: 0.0, mean p set: 0.45078244805336
The modified gen p mean: 0.45405906438827515, gen p mean: 0.0, mean p set: 0.450858473777771
The modified gen p mean: 0.4498019516468048, gen p mean: 0.0, mean p set: 0.45265302062034607
loss_pred:0.056807611137628555, decouple_loss:0.041635628789663315
loss_pred:0.05640338733792305, decouple_loss:0.04411992058157921
loss_pred:0.057696226984262466, decouple_loss:0.041676051914691925
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501284658908844, gen p mean: 0.0, mean p set: 0.4511551260948181
The modified gen p mean: 0.45317238569259644, gen p mean: 0.0, mean p set: 0.4503689110279083
The modified gen p mean: 0.45317351818084717, gen p mean: 0.0, mean p set: 0.4519176781177521
loss_pred:0.061651792377233505, decouple_loss:0.04348868876695633
loss_pred:0.06113746389746666, decouple_loss:0.04458606243133545
loss_pred:0.06047574803233147, decouple_loss:0.043809205293655396
2023-05-02 15:28:32 testing...
The modified gen p mean: 0.4591542184352875, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4573858082294464, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4581438899040222, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05923936888575554, decouple_loss:0.04640042036771774
loss_pred:0.061374444514513016, decouple_loss:0.0460226871073246
loss_pred:0.060660116374492645, decouple_loss:0.046322617679834366
WV_0_PC_0_EH_0_PS_40_6, loss: 0.06273707747459412, avg_mse: 0.06173952296376228
current test mse: 0.06174
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534677565097809, gen p mean: 0.0, mean p set: 0.4507925808429718
The modified gen p mean: 0.45928049087524414, gen p mean: 0.0, mean p set: 0.4513612687587738
loss_pred:0.057003531605005264, decouple_loss:0.04216593876481056
loss_pred:0.05891219526529312, decouple_loss:0.04304329305887222
The modified gen p mean: 0.4573911130428314, gen p mean: 0.0, mean p set: 0.45048442482948303
loss_pred:0.05531851574778557, decouple_loss:0.042896661907434464
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4631027579307556, gen p mean: 0.0, mean p set: 0.4513457417488098
The modified gen p mean: 0.4572230577468872, gen p mean: 0.0, mean p set: 0.4495851993560791
The modified gen p mean: 0.4575149118900299, gen p mean: 0.0, mean p set: 0.4511867165565491
loss_pred:0.06081536412239075, decouple_loss:0.04483311250805855
loss_pred:0.057520441710948944, decouple_loss:0.04205095395445824
loss_pred:0.058339301496744156, decouple_loss:0.04267793893814087
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521019458770752, gen p mean: 0.0, mean p set: 0.4502687156200409
The modified gen p mean: 0.4560156464576721, gen p mean: 0.0, mean p set: 0.4513053894042969
The modified gen p mean: 0.45168712735176086, gen p mean: 0.0, mean p set: 0.4511536657810211
loss_pred:0.055962659418582916, decouple_loss:0.04212101176381111
loss_pred:0.054957836866378784, decouple_loss:0.04297356680035591
loss_pred:0.05923490226268768, decouple_loss:0.04214967414736748
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496820271015167, gen p mean: 0.0, mean p set: 0.45199018716812134
The modified gen p mean: 0.45360103249549866, gen p mean: 0.0, mean p set: 0.45176616311073303
The modified gen p mean: 0.4472765624523163, gen p mean: 0.0, mean p set: 0.4520775377750397
loss_pred:0.05937561020255089, decouple_loss:0.04208814352750778
loss_pred:0.056326162070035934, decouple_loss:0.04382011294364929
loss_pred:0.057885441929101944, decouple_loss:0.04216694459319115
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4430294930934906, gen p mean: 0.0, mean p set: 0.4510516822338104
The modified gen p mean: 0.4419238865375519, gen p mean: 0.0, mean p set: 0.4518486559391022
The modified gen p mean: 0.44577234983444214, gen p mean: 0.0, mean p set: 0.4505978226661682
loss_pred:0.05628875270485878, decouple_loss:0.04199977591633797
loss_pred:0.05752262845635414, decouple_loss:0.04196086525917053
loss_pred:0.055174749344587326, decouple_loss:0.043564025312662125
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541968107223511, gen p mean: 0.0, mean p set: 0.45141053199768066
The modified gen p mean: 0.4512004256248474, gen p mean: 0.0, mean p set: 0.45139649510383606
The modified gen p mean: 0.4457486867904663, gen p mean: 0.0, mean p set: 0.45259371399879456
loss_pred:0.05907664820551872, decouple_loss:0.04607206955552101
loss_pred:0.05848405137658119, decouple_loss:0.0459132120013237
loss_pred:0.05699151009321213, decouple_loss:0.041296977549791336
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4576541781425476, gen p mean: 0.0, mean p set: 0.44927823543548584
The modified gen p mean: 0.4556088447570801, gen p mean: 0.0, mean p set: 0.450283020734787
The modified gen p mean: 0.46058574318885803, gen p mean: 0.0, mean p set: 0.4508335292339325
loss_pred:0.05692508444190025, decouple_loss:0.04317460581660271
loss_pred:0.05528828501701355, decouple_loss:0.04176203906536102
loss_pred:0.0582319051027298, decouple_loss:0.04261470586061478
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503319561481476, gen p mean: 0.0, mean p set: 0.4509739875793457
The modified gen p mean: 0.45047324895858765, gen p mean: 0.0, mean p set: 0.4510355293750763
The modified gen p mean: 0.45444387197494507, gen p mean: 0.0, mean p set: 0.45174556970596313
loss_pred:0.055057939141988754, decouple_loss:0.04368852823972702
loss_pred:0.05838566645979881, decouple_loss:0.04392629116773605
loss_pred:0.059958316385746, decouple_loss:0.042735505849123
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4547452926635742, gen p mean: 0.0, mean p set: 0.45135459303855896
The modified gen p mean: 0.45625150203704834, gen p mean: 0.0, mean p set: 0.45139533281326294
The modified gen p mean: 0.4555402100086212, gen p mean: 0.0, mean p set: 0.45128458738327026
loss_pred:0.054026566445827484, decouple_loss:0.04204985126852989
loss_pred:0.055066224187612534, decouple_loss:0.04323489964008331
loss_pred:0.06085978075861931, decouple_loss:0.042616333812475204
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45153748989105225, gen p mean: 0.0, mean p set: 0.4490198791027069
The modified gen p mean: 0.4517514407634735, gen p mean: 0.0, mean p set: 0.44832107424736023
The modified gen p mean: 0.45075708627700806, gen p mean: 0.0, mean p set: 0.4473958909511566
loss_pred:0.05959906056523323, decouple_loss:0.04858178645372391
loss_pred:0.05818522348999977, decouple_loss:0.04825204238295555
loss_pred:0.05753291770815849, decouple_loss:0.04717434570193291
2023-05-02 15:33:04 testing...
The modified gen p mean: 0.45466873049736023, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45394837856292725, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.45247527956962585, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.058335404843091965, decouple_loss:0.04725697264075279
loss_pred:0.056904811412096024, decouple_loss:0.04797638952732086
loss_pred:0.05886724218726158, decouple_loss:0.047643695026636124
WV_0_PC_0_EH_0_PS_40_6, loss: 0.06041710823774338, avg_mse: 0.05877561494708061
current test mse: 0.058776
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450700044631958, gen p mean: 0.0, mean p set: 0.44755110144615173
The modified gen p mean: 0.4512764811515808, gen p mean: 0.0, mean p set: 0.44900330901145935
loss_pred:0.05610128864645958, decouple_loss:0.04872246831655502
loss_pred:0.05511283129453659, decouple_loss:0.04821602627635002
The modified gen p mean: 0.44827577471733093, gen p mean: 0.0, mean p set: 0.4487282633781433
loss_pred:0.056337621062994, decouple_loss:0.04923789203166962
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4549875259399414, gen p mean: 0.0, mean p set: 0.4505683481693268
The modified gen p mean: 0.4531201720237732, gen p mean: 0.0, mean p set: 0.45018208026885986
The modified gen p mean: 0.44989439845085144, gen p mean: 0.0, mean p set: 0.4506426155567169
loss_pred:0.05476013943552971, decouple_loss:0.05032426118850708
loss_pred:0.05469761788845062, decouple_loss:0.04976082593202591
loss_pred:0.057093676179647446, decouple_loss:0.05374645069241524
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42815181612968445, gen p mean: 0.0, mean p set: 0.4486992359161377
The modified gen p mean: 0.43784114718437195, gen p mean: 0.0, mean p set: 0.4484834671020508
The modified gen p mean: 0.43054595589637756, gen p mean: 0.0, mean p set: 0.448472261428833
loss_pred:0.05694585293531418, decouple_loss:0.05365731194615364
loss_pred:0.05540066957473755, decouple_loss:0.05018448457121849
loss_pred:0.05532415211200714, decouple_loss:0.05028558149933815
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.463226318359375, gen p mean: 0.0, mean p set: 0.4480707347393036
The modified gen p mean: 0.46786871552467346, gen p mean: 0.0, mean p set: 0.44860541820526123
The modified gen p mean: 0.46468910574913025, gen p mean: 0.0, mean p set: 0.4480571746826172
loss_pred:0.05834324657917023, decouple_loss:0.0500209741294384
loss_pred:0.054786860942840576, decouple_loss:0.04912658408284187
loss_pred:0.05877426639199257, decouple_loss:0.04779352247714996
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46503740549087524, gen p mean: 0.0, mean p set: 0.4485693573951721
The modified gen p mean: 0.4620625376701355, gen p mean: 0.0, mean p set: 0.4478845000267029
The modified gen p mean: 0.45926517248153687, gen p mean: 0.0, mean p set: 0.44939976930618286
loss_pred:0.05485988035798073, decouple_loss:0.04904714971780777
loss_pred:0.0579976886510849, decouple_loss:0.04881961643695831
loss_pred:0.0550052747130394, decouple_loss:0.050856783986091614
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4300699532032013, gen p mean: 0.0, mean p set: 0.4485537111759186
The modified gen p mean: 0.43266889452934265, gen p mean: 0.0, mean p set: 0.447368323802948
The modified gen p mean: 0.43231016397476196, gen p mean: 0.0, mean p set: 0.44871997833251953
loss_pred:0.058149587363004684, decouple_loss:0.0524461567401886
loss_pred:0.056916967034339905, decouple_loss:0.05046309158205986
loss_pred:0.05423189327120781, decouple_loss:0.04871125519275665
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4416651129722595, gen p mean: 0.0, mean p set: 0.44929543137550354
The modified gen p mean: 0.44430047273635864, gen p mean: 0.0, mean p set: 0.4473358392715454
The modified gen p mean: 0.4473058879375458, gen p mean: 0.0, mean p set: 0.4482479691505432
loss_pred:0.0552508570253849, decouple_loss:0.049097269773483276
loss_pred:0.05660562962293625, decouple_loss:0.04931001365184784
loss_pred:0.054584819823503494, decouple_loss:0.04931534081697464
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45176905393600464, gen p mean: 0.0, mean p set: 0.4476448595523834
The modified gen p mean: 0.44615188241004944, gen p mean: 0.0, mean p set: 0.4475356340408325
The modified gen p mean: 0.44809308648109436, gen p mean: 0.0, mean p set: 0.4500364065170288
loss_pred:0.05304424464702606, decouple_loss:0.04771878197789192
loss_pred:0.05735267698764801, decouple_loss:0.04730626195669174
loss_pred:0.05236915126442909, decouple_loss:0.0479617677628994
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479205310344696, gen p mean: 0.0, mean p set: 0.4482649564743042
The modified gen p mean: 0.45098721981048584, gen p mean: 0.0, mean p set: 0.4481905400753021
The modified gen p mean: 0.45361658930778503, gen p mean: 0.0, mean p set: 0.4488097131252289
loss_pred:0.0559963658452034, decouple_loss:0.04806431010365486
loss_pred:0.0554710254073143, decouple_loss:0.04747319221496582
loss_pred:0.0539630651473999, decouple_loss:0.047624971717596054
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670218229293823, gen p mean: 0.0, mean p set: 0.4489106833934784
The modified gen p mean: 0.4517802894115448, gen p mean: 0.0, mean p set: 0.4481089115142822
The modified gen p mean: 0.4529738128185272, gen p mean: 0.0, mean p set: 0.44841471314430237
loss_pred:0.05582747608423233, decouple_loss:0.04736718162894249
loss_pred:0.05711563676595688, decouple_loss:0.04796658828854561
loss_pred:0.05481157451868057, decouple_loss:0.04540366679430008
2023-05-02 15:36:47 testing...
The modified gen p mean: 0.45304790139198303, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45218995213508606, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4547984004020691, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.0569109171628952, decouple_loss:0.04648688808083534
loss_pred:0.05728287994861603, decouple_loss:0.04645726829767227
loss_pred:0.05557028576731682, decouple_loss:0.04717866703867912
WV_0_PC_0_EH_0_PS_40_6, loss: 0.05892340838909149, avg_mse: 0.057436250150203705
current test mse: 0.057436
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45554301142692566, gen p mean: 0.0, mean p set: 0.4487214982509613
The modified gen p mean: 0.45807263255119324, gen p mean: 0.0, mean p set: 0.4476125240325928
loss_pred:0.05445938557386398, decouple_loss:0.04689403995871544
loss_pred:0.05535252019762993, decouple_loss:0.04851917177438736
The modified gen p mean: 0.4541686475276947, gen p mean: 0.0, mean p set: 0.4477330446243286
loss_pred:0.054545801132917404, decouple_loss:0.04754498228430748
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4430343210697174, gen p mean: 0.0, mean p set: 0.4485156238079071
The modified gen p mean: 0.44289907813072205, gen p mean: 0.0, mean p set: 0.44952166080474854
The modified gen p mean: 0.44803497195243835, gen p mean: 0.0, mean p set: 0.44904476404190063
loss_pred:0.05429866909980774, decouple_loss:0.04437992349267006
loss_pred:0.05396657437086105, decouple_loss:0.04526305943727493
loss_pred:0.054751500487327576, decouple_loss:0.04738762974739075
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4387873709201813, gen p mean: 0.0, mean p set: 0.4481564164161682
The modified gen p mean: 0.44153615832328796, gen p mean: 0.0, mean p set: 0.447110116481781
The modified gen p mean: 0.4365076422691345, gen p mean: 0.0, mean p set: 0.44750893115997314
loss_pred:0.05453341454267502, decouple_loss:0.044824182987213135
loss_pred:0.05663001537322998, decouple_loss:0.04688270762562752
loss_pred:0.05656290426850319, decouple_loss:0.04528258740901947
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45165830850601196, gen p mean: 0.0, mean p set: 0.447309285402298
The modified gen p mean: 0.44779419898986816, gen p mean: 0.0, mean p set: 0.4497232735157013
The modified gen p mean: 0.4452422857284546, gen p mean: 0.0, mean p set: 0.4488431215286255
loss_pred:0.05525384470820427, decouple_loss:0.04569510743021965
loss_pred:0.05246143788099289, decouple_loss:0.04637842997908592
loss_pred:0.0537569597363472, decouple_loss:0.04638215899467468
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45919057726860046, gen p mean: 0.0, mean p set: 0.4471263289451599
The modified gen p mean: 0.4553174674510956, gen p mean: 0.0, mean p set: 0.449665904045105
The modified gen p mean: 0.4582265615463257, gen p mean: 0.0, mean p set: 0.4480155408382416
loss_pred:0.055438995361328125, decouple_loss:0.04554568976163864
loss_pred:0.05224132165312767, decouple_loss:0.04506517946720123
loss_pred:0.05595695227384567, decouple_loss:0.0464918427169323
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4576151669025421, gen p mean: 0.0, mean p set: 0.44726231694221497
The modified gen p mean: 0.45755377411842346, gen p mean: 0.0, mean p set: 0.4479025602340698
The modified gen p mean: 0.46029022336006165, gen p mean: 0.0, mean p set: 0.4466237425804138
loss_pred:0.05572161078453064, decouple_loss:0.04514962062239647
loss_pred:0.055217891931533813, decouple_loss:0.04382534697651863
loss_pred:0.05450848117470741, decouple_loss:0.04481653869152069
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45581334829330444, gen p mean: 0.0, mean p set: 0.44665804505348206
The modified gen p mean: 0.4517380893230438, gen p mean: 0.0, mean p set: 0.44843170046806335
The modified gen p mean: 0.45221439003944397, gen p mean: 0.0, mean p set: 0.4474853575229645
loss_pred:0.053521882742643356, decouple_loss:0.04534769430756569
loss_pred:0.05243892967700958, decouple_loss:0.044444482773542404
loss_pred:0.05475252494215965, decouple_loss:0.04431242495775223
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4293411076068878, gen p mean: 0.0, mean p set: 0.44869574904441833
The modified gen p mean: 0.4312734007835388, gen p mean: 0.0, mean p set: 0.4483180344104767
The modified gen p mean: 0.4370359778404236, gen p mean: 0.0, mean p set: 0.44819900393486023
loss_pred:0.054481856524944305, decouple_loss:0.0446542426943779
loss_pred:0.05543522536754608, decouple_loss:0.04440769925713539
loss_pred:0.05373914912343025, decouple_loss:0.04270997643470764
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4449763000011444, gen p mean: 0.0, mean p set: 0.4488748610019684
The modified gen p mean: 0.44671210646629333, gen p mean: 0.0, mean p set: 0.4499242305755615
The modified gen p mean: 0.45363378524780273, gen p mean: 0.0, mean p set: 0.44636374711990356
loss_pred:0.054208844900131226, decouple_loss:0.045296479016542435
loss_pred:0.052739355713129044, decouple_loss:0.0440380796790123
loss_pred:0.05246768519282341, decouple_loss:0.044189199805259705
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
NaN value num: 0
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4593072533607483, gen p mean: 0.0, mean p set: 0.4495026767253876
The modified gen p mean: 0.45614296197891235, gen p mean: 0.0, mean p set: 0.44988009333610535
The modified gen p mean: 0.45422348380088806, gen p mean: 0.0, mean p set: 0.45023199915885925
loss_pred:0.058151405304670334, decouple_loss:0.048291951417922974
loss_pred:0.056750573217868805, decouple_loss:0.047926414757966995
loss_pred:0.05595732480287552, decouple_loss:0.045470353215932846
2023-05-02 15:41:09 testing...
The modified gen p mean: 0.447420597076416, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44940635561943054, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45122194290161133, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.056637126952409744, decouple_loss:0.04357356205582619
loss_pred:0.05591599643230438, decouple_loss:0.04338078573346138
loss_pred:0.054472777992486954, decouple_loss:0.044015370309352875
WV_0_PC_0_EH_0_PS_40_6, loss: 0.05785813182592392, avg_mse: 0.05674760788679123
current test mse: 0.056748
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45276957750320435, gen p mean: 0.0, mean p set: 0.4493463933467865
The modified gen p mean: 0.444437712430954, gen p mean: 0.0, mean p set: 0.44988757371902466
loss_pred:0.06134781986474991, decouple_loss:0.048368584364652634
loss_pred:0.05840659141540527, decouple_loss:0.04842662066221237
The modified gen p mean: 0.44638681411743164, gen p mean: 0.0, mean p set: 0.4503830373287201
loss_pred:0.05694469437003136, decouple_loss:0.048330601304769516
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4596712589263916, gen p mean: 0.0, mean p set: 0.45089030265808105
The modified gen p mean: 0.4550475478172302, gen p mean: 0.0, mean p set: 0.4509873688220978
The modified gen p mean: 0.4537839889526367, gen p mean: 0.0, mean p set: 0.4497041702270508
loss_pred:0.059673696756362915, decouple_loss:0.05048636347055435
loss_pred:0.05667663738131523, decouple_loss:0.047794442623853683
loss_pred:0.05457589775323868, decouple_loss:0.04938979819417
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4571007192134857, gen p mean: 0.0, mean p set: 0.4515224099159241
The modified gen p mean: 0.4562217891216278, gen p mean: 0.0, mean p set: 0.4508911669254303
The modified gen p mean: 0.45417520403862, gen p mean: 0.0, mean p set: 0.45006799697875977
loss_pred:0.05755218118429184, decouple_loss:0.05251481011509895
loss_pred:0.058545634150505066, decouple_loss:0.05090973898768425
loss_pred:0.053795043379068375, decouple_loss:0.04917862266302109
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4546738862991333, gen p mean: 0.0, mean p set: 0.4500887989997864
The modified gen p mean: 0.44915199279785156, gen p mean: 0.0, mean p set: 0.45286887884140015
The modified gen p mean: 0.4514819383621216, gen p mean: 0.0, mean p set: 0.45107173919677734
loss_pred:0.05597272515296936, decouple_loss:0.047729767858982086
loss_pred:0.05596989020705223, decouple_loss:0.05082916095852852
loss_pred:0.05578727275133133, decouple_loss:0.047937288880348206
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44360435009002686, gen p mean: 0.0, mean p set: 0.45227932929992676
The modified gen p mean: 0.44596919417381287, gen p mean: 0.0, mean p set: 0.45011085271835327
The modified gen p mean: 0.4457876980304718, gen p mean: 0.0, mean p set: 0.45200514793395996
loss_pred:0.060904256999492645, decouple_loss:0.050148483365774155
loss_pred:0.0566861554980278, decouple_loss:0.05079897120594978
loss_pred:0.05664898455142975, decouple_loss:0.05049311742186546
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523640275001526, gen p mean: 0.0, mean p set: 0.450985848903656
The modified gen p mean: 0.45184674859046936, gen p mean: 0.0, mean p set: 0.4524949789047241
The modified gen p mean: 0.45697328448295593, gen p mean: 0.0, mean p set: 0.4500472843647003
loss_pred:0.055715788155794144, decouple_loss:0.04841625317931175
loss_pred:0.05637713149189949, decouple_loss:0.04971463605761528
loss_pred:0.057189226150512695, decouple_loss:0.05067257583141327
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4586159586906433, gen p mean: 0.0, mean p set: 0.45027193427085876
The modified gen p mean: 0.454295814037323, gen p mean: 0.0, mean p set: 0.4523826837539673
The modified gen p mean: 0.4568304717540741, gen p mean: 0.0, mean p set: 0.44908010959625244
loss_pred:0.05644340068101883, decouple_loss:0.04861120134592056
loss_pred:0.05779688432812691, decouple_loss:0.04796919971704483
loss_pred:0.05722609907388687, decouple_loss:0.04790998622775078
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675949215888977, gen p mean: 0.0, mean p set: 0.45189690589904785
The modified gen p mean: 0.4445846676826477, gen p mean: 0.0, mean p set: 0.44922736287117004
The modified gen p mean: 0.44531136751174927, gen p mean: 0.0, mean p set: 0.45228907465934753
loss_pred:0.05524503067135811, decouple_loss:0.04719198867678642
loss_pred:0.05686494708061218, decouple_loss:0.0474250353872776
loss_pred:0.057006023824214935, decouple_loss:0.04817356541752815
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484061300754547, gen p mean: 0.0, mean p set: 0.45232194662094116
The modified gen p mean: 0.44720038771629333, gen p mean: 0.0, mean p set: 0.45171138644218445
loss_pred:0.056498777121305466, decouple_loss:0.04805280640721321
The modified gen p mean: 0.4436776041984558, gen p mean: 0.0, mean p set: 0.45094096660614014
loss_pred:0.05566226691007614, decouple_loss:0.04728635028004646
loss_pred:0.0548873096704483, decouple_loss:0.045886389911174774
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4697003960609436, gen p mean: 0.0, mean p set: 0.45013532042503357
The modified gen p mean: 0.47185564041137695, gen p mean: 0.0, mean p set: 0.4504234194755554
The modified gen p mean: 0.46534645557403564, gen p mean: 0.0, mean p set: 0.44988515973091125
loss_pred:0.0575287863612175, decouple_loss:0.046979159116744995
loss_pred:0.058018844574689865, decouple_loss:0.0471852570772171
loss_pred:0.054464057087898254, decouple_loss:0.04743318632245064
2023-05-02 15:44:49 testing...
The modified gen p mean: 0.4559917747974396, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4574497938156128, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4568183720111847, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.05885091423988342, decouple_loss:0.04937107861042023
loss_pred:0.05713415518403053, decouple_loss:0.0486263707280159
loss_pred:0.0566946417093277, decouple_loss:0.048796772956848145
WV_0_PC_0_EH_0_PS_40_6, loss: 0.06000647693872452, avg_mse: 0.05931935831904411
current test mse: 0.059319
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4623603820800781, gen p mean: 0.0, mean p set: 0.4497282803058624
The modified gen p mean: 0.45588621497154236, gen p mean: 0.0, mean p set: 0.4527186155319214
loss_pred:0.05644106864929199, decouple_loss:0.048437848687171936
loss_pred:0.055247027426958084, decouple_loss:0.04813573509454727
The modified gen p mean: 0.4536610245704651, gen p mean: 0.0, mean p set: 0.4514676034450531
loss_pred:0.05618703365325928, decouple_loss:0.046849243342876434
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43733158707618713, gen p mean: 0.0, mean p set: 0.4531742036342621
The modified gen p mean: 0.4359280467033386, gen p mean: 0.0, mean p set: 0.44935014843940735
The modified gen p mean: 0.437954843044281, gen p mean: 0.0, mean p set: 0.45227181911468506
loss_pred:0.05959077179431915, decouple_loss:0.047239817678928375
loss_pred:0.05132708698511124, decouple_loss:0.047582123428583145
loss_pred:0.056081708520650864, decouple_loss:0.04725692793726921
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43975400924682617, gen p mean: 0.0, mean p set: 0.44954198598861694
The modified gen p mean: 0.4428434669971466, gen p mean: 0.0, mean p set: 0.45348381996154785
The modified gen p mean: 0.43895259499549866, gen p mean: 0.0, mean p set: 0.44904735684394836
loss_pred:0.056244879961013794, decouple_loss:0.04567033052444458
loss_pred:0.05734795704483986, decouple_loss:0.046540241688489914
loss_pred:0.05087863281369209, decouple_loss:0.046518079936504364
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45569124817848206, gen p mean: 0.0, mean p set: 0.4500034749507904
The modified gen p mean: 0.45386165380477905, gen p mean: 0.0, mean p set: 0.4505097270011902
The modified gen p mean: 0.45381370186805725, gen p mean: 0.0, mean p set: 0.44910362362861633
loss_pred:0.05778332054615021, decouple_loss:0.04513351246714592
loss_pred:0.05595298483967781, decouple_loss:0.04610848054289818
loss_pred:0.05247624218463898, decouple_loss:0.04490480199456215
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45958754420280457, gen p mean: 0.0, mean p set: 0.45253291726112366
The modified gen p mean: 0.46327948570251465, gen p mean: 0.0, mean p set: 0.4495048522949219
The modified gen p mean: 0.46077051758766174, gen p mean: 0.0, mean p set: 0.4498482048511505
loss_pred:0.053575798869132996, decouple_loss:0.04585101455450058
loss_pred:0.054584525525569916, decouple_loss:0.04535067453980446
loss_pred:0.05651255324482918, decouple_loss:0.04444678872823715
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4434451460838318, gen p mean: 0.0, mean p set: 0.4504542350769043
The modified gen p mean: 0.44823676347732544, gen p mean: 0.0, mean p set: 0.45068594813346863
The modified gen p mean: 0.4438720643520355, gen p mean: 0.0, mean p set: 0.4508790671825409
loss_pred:0.05537326633930206, decouple_loss:0.04316297546029091
loss_pred:0.054788000881671906, decouple_loss:0.04392610117793083
loss_pred:0.05481826141476631, decouple_loss:0.043468914926052094
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4406609535217285, gen p mean: 0.0, mean p set: 0.45084765553474426
The modified gen p mean: 0.44382765889167786, gen p mean: 0.0, mean p set: 0.4494488537311554
The modified gen p mean: 0.445578396320343, gen p mean: 0.0, mean p set: 0.4525914490222931
loss_pred:0.052814316004514694, decouple_loss:0.0429329089820385
loss_pred:0.05151575431227684, decouple_loss:0.04347226023674011
loss_pred:0.05563163012266159, decouple_loss:0.0448845736682415
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4559979736804962, gen p mean: 0.0, mean p set: 0.45008331537246704
The modified gen p mean: 0.45602455735206604, gen p mean: 0.0, mean p set: 0.45282456278800964
The modified gen p mean: 0.45532655715942383, gen p mean: 0.0, mean p set: 0.4519574046134949
loss_pred:0.055249981582164764, decouple_loss:0.04442822188138962
loss_pred:0.05507710203528404, decouple_loss:0.045062050223350525
loss_pred:0.054433293640613556, decouple_loss:0.04440926015377045
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4567341208457947, gen p mean: 0.0, mean p set: 0.45194414258003235
The modified gen p mean: 0.45914870500564575, gen p mean: 0.0, mean p set: 0.450647234916687
The modified gen p mean: 0.4644986689090729, gen p mean: 0.0, mean p set: 0.45156344771385193
loss_pred:0.05441773310303688, decouple_loss:0.042831797152757645
loss_pred:0.05404951050877571, decouple_loss:0.04141540080308914
loss_pred:0.05393166467547417, decouple_loss:0.0437394343316555
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4580451548099518, gen p mean: 0.0, mean p set: 0.44805875420570374
The modified gen p mean: 0.44859519600868225, gen p mean: 0.0, mean p set: 0.44719216227531433
The modified gen p mean: 0.4562954604625702, gen p mean: 0.0, mean p set: 0.4489504396915436
loss_pred:0.05562220513820648, decouple_loss:0.047185018658638
loss_pred:0.05568160489201546, decouple_loss:0.044463276863098145
loss_pred:0.05513748899102211, decouple_loss:0.04534515365958214
2023-05-02 15:49:08 testing...
The modified gen p mean: 0.44444340467453003, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44272953271865845, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4450463652610779, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.05578579753637314, decouple_loss:0.04415765032172203
loss_pred:0.05712762475013733, decouple_loss:0.04540001228451729
loss_pred:0.055130042135715485, decouple_loss:0.04488556459546089
WV_0_PC_0_EH_0_PS_40_6, loss: 0.058255210518836975, avg_mse: 0.057780876755714417
current test mse: 0.057781
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44544991850852966, gen p mean: 0.0, mean p set: 0.44780099391937256
The modified gen p mean: 0.44227781891822815, gen p mean: 0.0, mean p set: 0.44953420758247375
loss_pred:0.05445585772395134, decouple_loss:0.04920393228530884
loss_pred:0.05774249508976936, decouple_loss:0.04951074346899986
The modified gen p mean: 0.44595712423324585, gen p mean: 0.0, mean p set: 0.44709208607673645
loss_pred:0.057539574801921844, decouple_loss:0.04674060270190239
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46046942472457886, gen p mean: 0.0, mean p set: 0.448152095079422
The modified gen p mean: 0.4558575749397278, gen p mean: 0.0, mean p set: 0.4468752145767212
The modified gen p mean: 0.45526358485221863, gen p mean: 0.0, mean p set: 0.4466695487499237
loss_pred:0.0550643689930439, decouple_loss:0.047719985246658325
loss_pred:0.05457925796508789, decouple_loss:0.04615127295255661
loss_pred:0.05571889504790306, decouple_loss:0.04765299707651138
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46307283639907837, gen p mean: 0.0, mean p set: 0.44742920994758606
The modified gen p mean: 0.46049588918685913, gen p mean: 0.0, mean p set: 0.44834375381469727
The modified gen p mean: 0.4560135304927826, gen p mean: 0.0, mean p set: 0.4476166069507599
loss_pred:0.05553944781422615, decouple_loss:0.0473344549536705
loss_pred:0.05839727818965912, decouple_loss:0.04845575615763664
loss_pred:0.055369783192873, decouple_loss:0.04722876474261284
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4379737675189972, gen p mean: 0.0, mean p set: 0.44723597168922424
The modified gen p mean: 0.43855202198028564, gen p mean: 0.0, mean p set: 0.448160856962204
The modified gen p mean: 0.4395606219768524, gen p mean: 0.0, mean p set: 0.44820722937583923
loss_pred:0.053817279636859894, decouple_loss:0.04667423292994499
loss_pred:0.05523179844021797, decouple_loss:0.047425609081983566
loss_pred:0.05736437067389488, decouple_loss:0.045738764107227325
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43205052614212036, gen p mean: 0.0, mean p set: 0.44729119539260864
The modified gen p mean: 0.43219369649887085, gen p mean: 0.0, mean p set: 0.44783106446266174
The modified gen p mean: 0.43901851773262024, gen p mean: 0.0, mean p set: 0.447546124458313
loss_pred:0.054488830268383026, decouple_loss:0.04744984954595566
loss_pred:0.05405443161725998, decouple_loss:0.04708429425954819
loss_pred:0.05592109262943268, decouple_loss:0.04573619365692139
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45888522267341614, gen p mean: 0.0, mean p set: 0.44742998480796814
The modified gen p mean: 0.4539530873298645, gen p mean: 0.0, mean p set: 0.4480101466178894
The modified gen p mean: 0.45127856731414795, gen p mean: 0.0, mean p set: 0.4466399550437927
loss_pred:0.055474914610385895, decouple_loss:0.045731764286756516
loss_pred:0.052676860243082047, decouple_loss:0.045219797641038895
loss_pred:0.05298539996147156, decouple_loss:0.045582644641399384
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46467798948287964, gen p mean: 0.0, mean p set: 0.4477180242538452
The modified gen p mean: 0.46043941378593445, gen p mean: 0.0, mean p set: 0.44777578115463257
The modified gen p mean: 0.4615684151649475, gen p mean: 0.0, mean p set: 0.44663766026496887
loss_pred:0.054848555475473404, decouple_loss:0.045789554715156555
loss_pred:0.053199365735054016, decouple_loss:0.047454606741666794
loss_pred:0.05262039974331856, decouple_loss:0.045567065477371216
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44459229707717896, gen p mean: 0.0, mean p set: 0.44788476824760437
The modified gen p mean: 0.4490281939506531, gen p mean: 0.0, mean p set: 0.44762122631073
The modified gen p mean: 0.44936877489089966, gen p mean: 0.0, mean p set: 0.4485294818878174
loss_pred:0.051980651915073395, decouple_loss:0.04709501564502716
loss_pred:0.05329083651304245, decouple_loss:0.04657767713069916
loss_pred:0.05512405186891556, decouple_loss:0.04508943483233452
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44305548071861267, gen p mean: 0.0, mean p set: 0.44990822672843933
The modified gen p mean: 0.44720837473869324, gen p mean: 0.0, mean p set: 0.4478980302810669
The modified gen p mean: 0.45017531514167786, gen p mean: 0.0, mean p set: 0.4477405250072479
loss_pred:0.054739050567150116, decouple_loss:0.047585658729076385
loss_pred:0.05333738401532173, decouple_loss:0.04437768831849098
loss_pred:0.05391161888837814, decouple_loss:0.04570648446679115
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.444031685590744, gen p mean: 0.0, mean p set: 0.44765612483024597
The modified gen p mean: 0.4484846293926239, gen p mean: 0.0, mean p set: 0.4481947124004364
The modified gen p mean: 0.4466276466846466, gen p mean: 0.0, mean p set: 0.4475148916244507
loss_pred:0.053401149809360504, decouple_loss:0.044892095029354095loss_pred:0.05354239419102669, decouple_loss:0.04387267306447029
loss_pred:0.05416744947433472, decouple_loss:0.04511265456676483
2023-05-02 15:52:47 testing...
The modified gen p mean: 0.4463489055633545, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4489240348339081, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44858846068382263, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.05526777729392052, decouple_loss:0.04457354545593262
loss_pred:0.05429660156369209, decouple_loss:0.04352797195315361
loss_pred:0.053215596824884415, decouple_loss:0.044576067477464676
WV_0_PC_0_EH_0_PS_40_6, loss: 0.056471288204193115, avg_mse: 0.05568407475948334
current test mse: 0.055684
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925427436828613, gen p mean: 0.0, mean p set: 0.448373407125473
The modified gen p mean: 0.4524343013763428, gen p mean: 0.0, mean p set: 0.44820359349250793
loss_pred:0.054774634540081024, decouple_loss:0.04495611786842346
loss_pred:0.05453360825777054, decouple_loss:0.044257424771785736
The modified gen p mean: 0.44796642661094666, gen p mean: 0.0, mean p set: 0.44746798276901245
loss_pred:0.05272188410162926, decouple_loss:0.04387134313583374
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997915625572205, gen p mean: 0.0, mean p set: 0.447569340467453
The modified gen p mean: 0.4532364308834076, gen p mean: 0.0, mean p set: 0.4468367099761963
The modified gen p mean: 0.4516623318195343, gen p mean: 0.0, mean p set: 0.4477160573005676
loss_pred:0.053445003926754, decouple_loss:0.045647431164979935
loss_pred:0.0529334731400013, decouple_loss:0.04413959011435509
loss_pred:0.05310580134391785, decouple_loss:0.04302722588181496
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512878656387329, gen p mean: 0.0, mean p set: 0.4478749632835388
The modified gen p mean: 0.4482998847961426, gen p mean: 0.0, mean p set: 0.44896718859672546
The modified gen p mean: 0.4490354359149933, gen p mean: 0.0, mean p set: 0.44670340418815613
loss_pred:0.05167350918054581, decouple_loss:0.04345639795064926
loss_pred:0.05384692922234535, decouple_loss:0.046866029500961304
loss_pred:0.051527127623558044, decouple_loss:0.04435449838638306
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45073726773262024, gen p mean: 0.0, mean p set: 0.44769227504730225
The modified gen p mean: 0.4531908333301544, gen p mean: 0.0, mean p set: 0.4478749930858612
The modified gen p mean: 0.4534653127193451, gen p mean: 0.0, mean p set: 0.44803011417388916
loss_pred:0.05186305567622185, decouple_loss:0.04384375363588333
loss_pred:0.0522909015417099, decouple_loss:0.0431281253695488
loss_pred:0.055254727602005005, decouple_loss:0.044433340430259705
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4405459761619568, gen p mean: 0.0, mean p set: 0.44699984788894653
The modified gen p mean: 0.44203072786331177, gen p mean: 0.0, mean p set: 0.4464336037635803
loss_pred:0.052115924656391144, decouple_loss:0.042807597666978836
The modified gen p mean: 0.4368826448917389, gen p mean: 0.0, mean p set: 0.4474208950996399
loss_pred:0.05142407864332199, decouple_loss:0.042479224503040314
loss_pred:0.052065182477235794, decouple_loss:0.042579710483551025
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458520710468292, gen p mean: 0.0, mean p set: 0.44808676838874817
The modified gen p mean: 0.4476025104522705, gen p mean: 0.0, mean p set: 0.4478742182254791
The modified gen p mean: 0.44910216331481934, gen p mean: 0.0, mean p set: 0.44807007908821106
loss_pred:0.051395971328020096, decouple_loss:0.04243755713105202
loss_pred:0.0562337264418602, decouple_loss:0.04401461035013199
loss_pred:0.05140194296836853, decouple_loss:0.04254250228404999
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45062899589538574, gen p mean: 0.0, mean p set: 0.4488895833492279
The modified gen p mean: 0.4511067867279053, gen p mean: 0.0, mean p set: 0.4469371736049652
The modified gen p mean: 0.44621971249580383, gen p mean: 0.0, mean p set: 0.4474751055240631
loss_pred:0.05538858100771904, decouple_loss:0.04336691275238991
loss_pred:0.05108184367418289, decouple_loss:0.04298552870750427
loss_pred:0.050951410084962845, decouple_loss:0.042631663382053375
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938403367996216, gen p mean: 0.0, mean p set: 0.4477635622024536
The modified gen p mean: 0.4401741027832031, gen p mean: 0.0, mean p set: 0.44606053829193115
The modified gen p mean: 0.4515376389026642, gen p mean: 0.0, mean p set: 0.44762900471687317
loss_pred:0.052655450999736786, decouple_loss:0.043035656213760376
loss_pred:0.05021260678768158, decouple_loss:0.04266746714711189
loss_pred:0.051868464797735214, decouple_loss:0.04175962507724762
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498407542705536, gen p mean: 0.0, mean p set: 0.44701457023620605
The modified gen p mean: 0.4538474380970001, gen p mean: 0.0, mean p set: 0.44779494404792786
The modified gen p mean: 0.4444343149662018, gen p mean: 0.0, mean p set: 0.4461626410484314
loss_pred:0.05192101001739502, decouple_loss:0.04155842587351799
loss_pred:0.05169716849923134, decouple_loss:0.04050751030445099
loss_pred:0.04955090209841728, decouple_loss:0.04214279726147652
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
NaN value num: 0
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498794376850128, gen p mean: 0.0, mean p set: 0.447386234998703
The modified gen p mean: 0.4546715021133423, gen p mean: 0.0, mean p set: 0.44908249378204346
The modified gen p mean: 0.4508945941925049, gen p mean: 0.0, mean p set: 0.44709256291389465
loss_pred:0.05398384854197502, decouple_loss:0.044376347213983536
loss_pred:0.052990831434726715, decouple_loss:0.04052243381738663
loss_pred:0.05131691321730614, decouple_loss:0.042218539863824844
2023-05-02 15:57:08 testing...
The modified gen p mean: 0.4490065574645996, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4522630572319031, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.45068415999412537, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.054666247218847275, decouple_loss:0.04195786640048027
loss_pred:0.05260869115591049, decouple_loss:0.04237474128603935
loss_pred:0.05372580140829086, decouple_loss:0.04161858931183815
WV_0_PC_0_EH_0_PS_40_6, loss: 0.05576610192656517, avg_mse: 0.05536520481109619
current test mse: 0.055365
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526022970676422, gen p mean: 0.0, mean p set: 0.4478928744792938
The modified gen p mean: 0.4503117799758911, gen p mean: 0.0, mean p set: 0.4477509558200836
loss_pred:0.055209700018167496, decouple_loss:0.041799578815698624
loss_pred:0.05723508447408676, decouple_loss:0.04205580800771713
The modified gen p mean: 0.45771467685699463, gen p mean: 0.0, mean p set: 0.4474692642688751
loss_pred:0.056944590061903, decouple_loss:0.04332748427987099
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4445394277572632, gen p mean: 0.0, mean p set: 0.44743403792381287
The modified gen p mean: 0.4415850043296814, gen p mean: 0.0, mean p set: 0.4468069076538086
The modified gen p mean: 0.4481343626976013, gen p mean: 0.0, mean p set: 0.44843971729278564
loss_pred:0.057263609021902084, decouple_loss:0.04069957882165909
loss_pred:0.05120942369103432, decouple_loss:0.04069693014025688
loss_pred:0.05464523285627365, decouple_loss:0.04105835035443306
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44308874011039734, gen p mean: 0.0, mean p set: 0.447992742061615
The modified gen p mean: 0.44351616501808167, gen p mean: 0.0, mean p set: 0.4479442238807678
The modified gen p mean: 0.444813996553421, gen p mean: 0.0, mean p set: 0.4485495090484619
loss_pred:0.05640222132205963, decouple_loss:0.04216369241476059
loss_pred:0.05193879455327988, decouple_loss:0.04072215408086777
loss_pred:0.0567636638879776, decouple_loss:0.04153965041041374
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025742053985596, gen p mean: 0.0, mean p set: 0.446774959564209
The modified gen p mean: 0.45307305455207825, gen p mean: 0.0, mean p set: 0.448116660118103
The modified gen p mean: 0.455853134393692, gen p mean: 0.0, mean p set: 0.4480714499950409
loss_pred:0.0520843006670475, decouple_loss:0.04157467186450958
loss_pred:0.05465787649154663, decouple_loss:0.04119876027107239
loss_pred:0.05442703887820244, decouple_loss:0.041902199387550354
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488432705402374, gen p mean: 0.0, mean p set: 0.44732505083084106
The modified gen p mean: 0.4537692964076996, gen p mean: 0.0, mean p set: 0.4483780562877655
The modified gen p mean: 0.4514932334423065, gen p mean: 0.0, mean p set: 0.4469875395298004
loss_pred:0.05187683552503586, decouple_loss:0.04121645167469978
loss_pred:0.05261892452836037, decouple_loss:0.041506435722112656
loss_pred:0.054077740758657455, decouple_loss:0.041680045425891876
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457918405532837, gen p mean: 0.0, mean p set: 0.44778236746788025
The modified gen p mean: 0.4475884735584259, gen p mean: 0.0, mean p set: 0.44841399788856506
The modified gen p mean: 0.441634863615036, gen p mean: 0.0, mean p set: 0.447104811668396
loss_pred:0.053652115166187286, decouple_loss:0.0400749035179615
loss_pred:0.05520520731806755, decouple_loss:0.04182955250144005
loss_pred:0.052573226392269135, decouple_loss:0.04080762714147568
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4428407847881317, gen p mean: 0.0, mean p set: 0.44914042949676514
The modified gen p mean: 0.4414786994457245, gen p mean: 0.0, mean p set: 0.4482417702674866
The modified gen p mean: 0.4384582042694092, gen p mean: 0.0, mean p set: 0.4473590552806854
loss_pred:0.05477769300341606, decouple_loss:0.040409550070762634
loss_pred:0.054776668548583984, decouple_loss:0.04198189824819565
loss_pred:0.05225767195224762, decouple_loss:0.040506571531295776
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4553844928741455, gen p mean: 0.0, mean p set: 0.44974398612976074
The modified gen p mean: 0.4565987288951874, gen p mean: 0.0, mean p set: 0.4470786452293396
The modified gen p mean: 0.45575371384620667, gen p mean: 0.0, mean p set: 0.4474305510520935
loss_pred:0.054033178836107254, decouple_loss:0.04360445588827133
loss_pred:0.05305326357483864, decouple_loss:0.03981926664710045
loss_pred:0.053140029311180115, decouple_loss:0.03967846930027008
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4561850130558014, gen p mean: 0.0, mean p set: 0.4484540522098541
The modified gen p mean: 0.4558478891849518, gen p mean: 0.0, mean p set: 0.44907209277153015
The modified gen p mean: 0.45414233207702637, gen p mean: 0.0, mean p set: 0.4470323920249939
loss_pred:0.05294632911682129, decouple_loss:0.04148450493812561
loss_pred:0.05407404899597168, decouple_loss:0.04049588367342949
loss_pred:0.05253978818655014, decouple_loss:0.03966159746050835
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44205549359321594, gen p mean: 0.0, mean p set: 0.4473554790019989
The modified gen p mean: 0.44325822591781616, gen p mean: 0.0, mean p set: 0.4484054148197174
The modified gen p mean: 0.44114166498184204, gen p mean: 0.0, mean p set: 0.44816598296165466
loss_pred:0.050230082124471664, decouple_loss:0.039974771440029144
loss_pred:0.0552278496325016, decouple_loss:0.04006463289260864
loss_pred:0.055471956729888916, decouple_loss:0.039471015334129333
2023-05-02 16:00:50 testing...
The modified gen p mean: 0.4381326735019684, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44397464394569397, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44070619344711304, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.054282933473587036, decouple_loss:0.04121376946568489
loss_pred:0.05211656540632248, decouple_loss:0.04083346575498581
loss_pred:0.053206201642751694, decouple_loss:0.03999730572104454
WV_0_PC_0_EH_0_PS_40_6, loss: 0.055235978215932846, avg_mse: 0.055002059787511826
current test mse: 0.055002
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470577836036682, gen p mean: 0.0, mean p set: 0.4482615292072296
loss_pred:0.05356425791978836, decouple_loss:0.03881925344467163
The modified gen p mean: 0.44400012493133545, gen p mean: 0.0, mean p set: 0.44682982563972473
loss_pred:0.049708783626556396, decouple_loss:0.039110951125621796
The modified gen p mean: 0.43812090158462524, gen p mean: 0.0, mean p set: 0.44934606552124023
loss_pred:0.05376105010509491, decouple_loss:0.04158627241849899
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4581722617149353, gen p mean: 0.0, mean p set: 0.44837686419487
The modified gen p mean: 0.45365357398986816, gen p mean: 0.0, mean p set: 0.44819125533103943
The modified gen p mean: 0.4525507390499115, gen p mean: 0.0, mean p set: 0.4474595785140991
loss_pred:0.054465536028146744, decouple_loss:0.03948559984564781
loss_pred:0.05017342418432236, decouple_loss:0.040193334221839905
loss_pred:0.05041878670454025, decouple_loss:0.04083304852247238
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45649993419647217, gen p mean: 0.0, mean p set: 0.4482884109020233
The modified gen p mean: 0.4565935730934143, gen p mean: 0.0, mean p set: 0.4481232166290283
The modified gen p mean: 0.4600362181663513, gen p mean: 0.0, mean p set: 0.44811463356018066
loss_pred:0.05129527300596237, decouple_loss:0.04095584899187088
loss_pred:0.05078575760126114, decouple_loss:0.038606319576501846
loss_pred:0.05382342264056206, decouple_loss:0.038691580295562744
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44256722927093506, gen p mean: 0.0, mean p set: 0.4500185549259186
The modified gen p mean: 0.4416217803955078, gen p mean: 0.0, mean p set: 0.44754326343536377
The modified gen p mean: 0.4406742751598358, gen p mean: 0.0, mean p set: 0.45040658116340637
loss_pred:0.05398941412568092, decouple_loss:0.040554944425821304
loss_pred:0.052573755383491516, decouple_loss:0.03818834573030472
loss_pred:0.05396326631307602, decouple_loss:0.040772680193185806
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479236900806427, gen p mean: 0.0, mean p set: 0.4473304748535156
The modified gen p mean: 0.45191192626953125, gen p mean: 0.0, mean p set: 0.4479750096797943
The modified gen p mean: 0.4503497779369354, gen p mean: 0.0, mean p set: 0.44805458188056946
loss_pred:0.052013467997312546, decouple_loss:0.03808589652180672
loss_pred:0.05289292335510254, decouple_loss:0.038282737135887146
loss_pred:0.04930474981665611, decouple_loss:0.038181353360414505
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45526745915412903, gen p mean: 0.0, mean p set: 0.4484272003173828
The modified gen p mean: 0.4543062150478363, gen p mean: 0.0, mean p set: 0.4485093653202057
The modified gen p mean: 0.45686888694763184, gen p mean: 0.0, mean p set: 0.4489823877811432
loss_pred:0.05562683567404747, decouple_loss:0.039534445852041245
loss_pred:0.054430682212114334, decouple_loss:0.038099080324172974
loss_pred:0.05265935882925987, decouple_loss:0.0389028936624527
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4423777759075165, gen p mean: 0.0, mean p set: 0.4495777189731598
The modified gen p mean: 0.44631078839302063, gen p mean: 0.0, mean p set: 0.448391854763031
The modified gen p mean: 0.4415828585624695, gen p mean: 0.0, mean p set: 0.44910722970962524
loss_pred:0.05412276089191437, decouple_loss:0.040464743971824646
loss_pred:0.05342433601617813, decouple_loss:0.03899127244949341
loss_pred:0.052541933953762054, decouple_loss:0.03970175236463547
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446755588054657, gen p mean: 0.0, mean p set: 0.4467964172363281
The modified gen p mean: 0.4476180672645569, gen p mean: 0.0, mean p set: 0.4472576081752777
The modified gen p mean: 0.44686412811279297, gen p mean: 0.0, mean p set: 0.44786348938941956
loss_pred:0.05185803025960922, decouple_loss:0.040251150727272034
loss_pred:0.05004313588142395, decouple_loss:0.039063308387994766
loss_pred:0.051309362053871155, decouple_loss:0.039142906665802
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4565022587776184, gen p mean: 0.0, mean p set: 0.44745010137557983
The modified gen p mean: 0.44993409514427185, gen p mean: 0.0, mean p set: 0.44770732522010803
The modified gen p mean: 0.44972142577171326, gen p mean: 0.0, mean p set: 0.44717806577682495
loss_pred:0.05566810443997383, decouple_loss:0.03930937871336937
loss_pred:0.049522463232278824, decouple_loss:0.03772010654211044
loss_pred:0.051435090601444244, decouple_loss:0.03723863139748573
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
NaN value num: 0
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057108998298645, gen p mean: 0.0, mean p set: 0.44826775789260864
The modified gen p mean: 0.44813138246536255, gen p mean: 0.0, mean p set: 0.447974294424057
The modified gen p mean: 0.4485357403755188, gen p mean: 0.0, mean p set: 0.44855955243110657
loss_pred:0.05154762044548988, decouple_loss:0.03962916508316994
loss_pred:0.052321575582027435, decouple_loss:0.039430078119039536
loss_pred:0.05097227916121483, decouple_loss:0.03977387398481369
2023-05-02 16:05:21 testing...
The modified gen p mean: 0.4485834836959839, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44387370347976685, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4513165056705475, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.05241701379418373, decouple_loss:0.03909924626350403
loss_pred:0.05353410914540291, decouple_loss:0.03944544121623039
loss_pred:0.05159714072942734, decouple_loss:0.03907766193151474
WV_0_PC_0_EH_0_PS_40_6, loss: 0.05447646230459213, avg_mse: 0.054532624781131744
current test mse: 0.054533
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512459635734558, gen p mean: 0.0, mean p set: 0.4470324218273163
loss_pred:0.05134217068552971, decouple_loss:0.03939010575413704
The modified gen p mean: 0.448610782623291, gen p mean: 0.0, mean p set: 0.4494765102863312
loss_pred:0.04833638295531273, decouple_loss:0.03917341306805611
The modified gen p mean: 0.4485211670398712, gen p mean: 0.0, mean p set: 0.4491044282913208
loss_pred:0.051526788622140884, decouple_loss:0.038763727992773056
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500553011894226, gen p mean: 0.0, mean p set: 0.4478277862071991
The modified gen p mean: 0.45265403389930725, gen p mean: 0.0, mean p set: 0.44964075088500977
The modified gen p mean: 0.45018306374549866, gen p mean: 0.0, mean p set: 0.44899317622184753
loss_pred:0.0534539520740509, decouple_loss:0.0382392555475235
loss_pred:0.0522753931581974, decouple_loss:0.039206795394420624
loss_pred:0.04945971444249153, decouple_loss:0.03812260925769806
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010098814964294, gen p mean: 0.0, mean p set: 0.4477371573448181
The modified gen p mean: 0.4499680697917938, gen p mean: 0.0, mean p set: 0.4498717188835144
The modified gen p mean: 0.45290741324424744, gen p mean: 0.0, mean p set: 0.44789421558380127
loss_pred:0.05017346888780594, decouple_loss:0.037625230848789215
loss_pred:0.054019417613744736, decouple_loss:0.03967398777604103
loss_pred:0.051851604133844376, decouple_loss:0.039502643048763275
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45029592514038086, gen p mean: 0.0, mean p set: 0.44746968150138855
The modified gen p mean: 0.4466606080532074, gen p mean: 0.0, mean p set: 0.44798994064331055
The modified gen p mean: 0.4463197886943817, gen p mean: 0.0, mean p set: 0.4491821527481079
loss_pred:0.05093494802713394, decouple_loss:0.03800894692540169
loss_pred:0.050755780190229416, decouple_loss:0.03989238291978836
loss_pred:0.047654543071985245, decouple_loss:0.03724221885204315
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43496158719062805, gen p mean: 0.0, mean p set: 0.44862788915634155
The modified gen p mean: 0.44034814834594727, gen p mean: 0.0, mean p set: 0.44966837763786316
The modified gen p mean: 0.4413376748561859, gen p mean: 0.0, mean p set: 0.44840285181999207
loss_pred:0.04944761469960213, decouple_loss:0.03872089460492134
loss_pred:0.05239705368876457, decouple_loss:0.03907106816768646
loss_pred:0.052768632769584656, decouple_loss:0.03896251320838928
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472138285636902, gen p mean: 0.0, mean p set: 0.4484792649745941
The modified gen p mean: 0.45469921827316284, gen p mean: 0.0, mean p set: 0.4496642053127289
The modified gen p mean: 0.4488159418106079, gen p mean: 0.0, mean p set: 0.4475262761116028
loss_pred:0.05244980752468109, decouple_loss:0.039474163204431534
loss_pred:0.05107194930315018, decouple_loss:0.03942641243338585
loss_pred:0.05378232151269913, decouple_loss:0.03907136246562004
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4633397161960602, gen p mean: 0.0, mean p set: 0.44820842146873474
The modified gen p mean: 0.4654071629047394, gen p mean: 0.0, mean p set: 0.44834980368614197
The modified gen p mean: 0.4668801426887512, gen p mean: 0.0, mean p set: 0.448832243680954
loss_pred:0.05145888775587082, decouple_loss:0.039712093770504loss_pred:0.0541573241353035, decouple_loss:0.03837841749191284
loss_pred:0.05343875288963318, decouple_loss:0.03871065750718117
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43961477279663086, gen p mean: 0.0, mean p set: 0.44761213660240173
The modified gen p mean: 0.4403705596923828, gen p mean: 0.0, mean p set: 0.45032617449760437
The modified gen p mean: 0.43860509991645813, gen p mean: 0.0, mean p set: 0.44927728176116943
loss_pred:0.05360822752118111, decouple_loss:0.03766116499900818
loss_pred:0.05052442103624344, decouple_loss:0.03802697733044624
loss_pred:0.0488993264734745, decouple_loss:0.03743930533528328
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4303112030029297, gen p mean: 0.0, mean p set: 0.44878458976745605
The modified gen p mean: 0.43466734886169434, gen p mean: 0.0, mean p set: 0.450667142868042
The modified gen p mean: 0.43250271677970886, gen p mean: 0.0, mean p set: 0.44957301020622253
loss_pred:0.04754119738936424, decouple_loss:0.037565480917692184
loss_pred:0.05196274816989899, decouple_loss:0.037468072026968
loss_pred:0.05054805800318718, decouple_loss:0.038032978773117065
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45646294951438904, gen p mean: 0.0, mean p set: 0.4476097822189331
The modified gen p mean: 0.4600066542625427, gen p mean: 0.0, mean p set: 0.4479839503765106
The modified gen p mean: 0.45674434304237366, gen p mean: 0.0, mean p set: 0.4476519823074341
loss_pred:0.053877249360084534, decouple_loss:0.03832042217254639
loss_pred:0.052795205265283585, decouple_loss:0.037646982818841934
loss_pred:0.049972254782915115, decouple_loss:0.0370415560901165
2023-05-02 16:09:00 testing...
The modified gen p mean: 0.46237027645111084, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.46677738428115845, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4675128161907196, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.05342639237642288, decouple_loss:0.03833646699786186
loss_pred:0.052030049264431, decouple_loss:0.03783714398741722
loss_pred:0.05083472281694412, decouple_loss:0.03843320533633232
WV_0_PC_0_EH_0_PS_40_6, loss: 0.05400716885924339, avg_mse: 0.05417153239250183
current test mse: 0.054172
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4669824242591858, gen p mean: 0.0, mean p set: 0.45020791888237
loss_pred:0.05204487964510918, decouple_loss:0.037558939307928085
The modified gen p mean: 0.4625512361526489, gen p mean: 0.0, mean p set: 0.44765329360961914
loss_pred:0.053484994918107986, decouple_loss:0.038055405020713806
The modified gen p mean: 0.4677216410636902, gen p mean: 0.0, mean p set: 0.4497813284397125
loss_pred:0.052151184529066086, decouple_loss:0.03731406852602959
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664910435676575, gen p mean: 0.0, mean p set: 0.4491809606552124
The modified gen p mean: 0.4444541931152344, gen p mean: 0.0, mean p set: 0.44745421409606934
The modified gen p mean: 0.4375706613063812, gen p mean: 0.0, mean p set: 0.44738876819610596
loss_pred:0.0497068390250206, decouple_loss:0.03787432238459587
loss_pred:0.050861723721027374, decouple_loss:0.03783781826496124
loss_pred:0.0536702498793602, decouple_loss:0.03906575217843056
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4408666789531708, gen p mean: 0.0, mean p set: 0.44835713505744934
The modified gen p mean: 0.4396408498287201, gen p mean: 0.0, mean p set: 0.4474024772644043
The modified gen p mean: 0.43776819109916687, gen p mean: 0.0, mean p set: 0.44695067405700684
loss_pred:0.0509067177772522, decouple_loss:0.03730608895421028
loss_pred:0.05256965011358261, decouple_loss:0.03713250532746315
loss_pred:0.05229249969124794, decouple_loss:0.039197444915771484
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45189571380615234, gen p mean: 0.0, mean p set: 0.44861429929733276
The modified gen p mean: 0.4520978033542633, gen p mean: 0.0, mean p set: 0.44879916310310364
The modified gen p mean: 0.45212119817733765, gen p mean: 0.0, mean p set: 0.4496292173862457
loss_pred:0.048561397939920425, decouple_loss:0.03761708736419678
loss_pred:0.05239050090312958, decouple_loss:0.03767536208033562
loss_pred:0.05189843103289604, decouple_loss:0.0369010791182518
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030486583709717, gen p mean: 0.0, mean p set: 0.44789883494377136
The modified gen p mean: 0.4490910470485687, gen p mean: 0.0, mean p set: 0.44859588146209717
The modified gen p mean: 0.4486049711704254, gen p mean: 0.0, mean p set: 0.4473898112773895
loss_pred:0.05222548916935921, decouple_loss:0.03694697842001915
loss_pred:0.0517553985118866, decouple_loss:0.03665266931056976
loss_pred:0.04966840147972107, decouple_loss:0.03648980334401131
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481985569000244, gen p mean: 0.0, mean p set: 0.44904273748397827
The modified gen p mean: 0.44729357957839966, gen p mean: 0.0, mean p set: 0.4477744400501251
The modified gen p mean: 0.4479268491268158, gen p mean: 0.0, mean p set: 0.45015189051628113
loss_pred:0.04797402396798134, decouple_loss:0.03728453814983368
loss_pred:0.04965425282716751, decouple_loss:0.03874536603689194
loss_pred:0.051152557134628296, decouple_loss:0.03811012580990791
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774335622787476, gen p mean: 0.0, mean p set: 0.44779905676841736
The modified gen p mean: 0.44787514209747314, gen p mean: 0.0, mean p set: 0.4482274651527405
The modified gen p mean: 0.4522869884967804, gen p mean: 0.0, mean p set: 0.44880858063697815
loss_pred:0.052351437509059906, decouple_loss:0.03727719932794571
loss_pred:0.0523504801094532, decouple_loss:0.037251513451337814
loss_pred:0.04744616150856018, decouple_loss:0.03671858087182045
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445750892162323, gen p mean: 0.0, mean p set: 0.4479536712169647
The modified gen p mean: 0.4432365596294403, gen p mean: 0.0, mean p set: 0.4474656283855438
The modified gen p mean: 0.447384238243103, gen p mean: 0.0, mean p set: 0.4487842917442322
loss_pred:0.05094732716679573, decouple_loss:0.03824413940310478
loss_pred:0.047579653561115265, decouple_loss:0.03754304349422455
loss_pred:0.05142983794212341, decouple_loss:0.03765800595283508
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4448842704296112, gen p mean: 0.0, mean p set: 0.44820311665534973
The modified gen p mean: 0.4462156891822815, gen p mean: 0.0, mean p set: 0.447390615940094
The modified gen p mean: 0.44779539108276367, gen p mean: 0.0, mean p set: 0.44708430767059326
loss_pred:0.0508175864815712, decouple_loss:0.03739190846681595
loss_pred:0.05224920064210892, decouple_loss:0.038329217582941055
loss_pred:0.04958558455109596, decouple_loss:0.03707195073366165
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
NaN value num: 0
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46247127652168274, gen p mean: 0.0, mean p set: 0.45125463604927063
The modified gen p mean: 0.46320080757141113, gen p mean: 0.0, mean p set: 0.44845154881477356
The modified gen p mean: 0.4572717845439911, gen p mean: 0.0, mean p set: 0.4512060284614563
loss_pred:0.05470427870750427, decouple_loss:0.03818612918257713
loss_pred:0.052615176886320114, decouple_loss:0.04070437699556351
loss_pred:0.05391378328204155, decouple_loss:0.04095819965004921
2023-05-02 16:13:23 testing...
The modified gen p mean: 0.4432045817375183, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4484187960624695, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44903507828712463, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05316709354519844, decouple_loss:0.03861776366829872
loss_pred:0.050622839480638504, decouple_loss:0.03783261775970459
loss_pred:0.05166804417967796, decouple_loss:0.037388432770967484
WV_0_PC_0_EH_0_PS_40_6, loss: 0.053716640919446945, avg_mse: 0.05403891205787659
current test mse: 0.054039
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468887150287628, gen p mean: 0.0, mean p set: 0.4505128264427185
The modified gen p mean: 0.4449717700481415, gen p mean: 0.0, mean p set: 0.4499780237674713
loss_pred:0.0541020892560482, decouple_loss:0.03941980376839638
loss_pred:0.055195391178131104, decouple_loss:0.039871521294116974
The modified gen p mean: 0.4479230046272278, gen p mean: 0.0, mean p set: 0.4498141407966614
loss_pred:0.05440807342529297, decouple_loss:0.03991297259926796
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527297616004944, gen p mean: 0.0, mean p set: 0.44962626695632935
The modified gen p mean: 0.4512560963630676, gen p mean: 0.0, mean p set: 0.4512411952018738
The modified gen p mean: 0.45083877444267273, gen p mean: 0.0, mean p set: 0.4511849880218506
loss_pred:0.053833771497011185, decouple_loss:0.03970082849264145
loss_pred:0.05101136490702629, decouple_loss:0.04167674854397774
loss_pred:0.05237465724349022, decouple_loss:0.04118700698018074
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44425639510154724, gen p mean: 0.0, mean p set: 0.44960159063339233
The modified gen p mean: 0.4320560395717621, gen p mean: 0.0, mean p set: 0.4492231011390686
The modified gen p mean: 0.43882688879966736, gen p mean: 0.0, mean p set: 0.448770135641098
loss_pred:0.05171964690089226, decouple_loss:0.03962894156575203
loss_pred:0.051122188568115234, decouple_loss:0.039375271648168564
loss_pred:0.05234069377183914, decouple_loss:0.03924863412976265
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606465101242065, gen p mean: 0.0, mean p set: 0.44867488741874695
The modified gen p mean: 0.4539760649204254, gen p mean: 0.0, mean p set: 0.44959574937820435
The modified gen p mean: 0.4499739408493042, gen p mean: 0.0, mean p set: 0.44722285866737366
loss_pred:0.05188284441828728, decouple_loss:0.03963024541735649
loss_pred:0.052711036056280136, decouple_loss:0.03917143866419792
loss_pred:0.04934106767177582, decouple_loss:0.03947668522596359
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46371686458587646, gen p mean: 0.0, mean p set: 0.45032137632369995
The modified gen p mean: 0.4571751058101654, gen p mean: 0.0, mean p set: 0.44758492708206177
The modified gen p mean: 0.45880699157714844, gen p mean: 0.0, mean p set: 0.45164018869400024
loss_pred:0.052830956876277924, decouple_loss:0.041138581931591034
loss_pred:0.04957173392176628, decouple_loss:0.03927752375602722
loss_pred:0.051690615713596344, decouple_loss:0.03960922360420227
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478827118873596, gen p mean: 0.0, mean p set: 0.4502742886543274
The modified gen p mean: 0.44528403878211975, gen p mean: 0.0, mean p set: 0.4495069682598114
The modified gen p mean: 0.4419533312320709, gen p mean: 0.0, mean p set: 0.44921740889549255
loss_pred:0.054078925400972366, decouple_loss:0.04054855927824974
loss_pred:0.054762911051511765, decouple_loss:0.04069466143846512
loss_pred:0.05391509458422661, decouple_loss:0.038787178695201874
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44894570112228394, gen p mean: 0.0, mean p set: 0.44889700412750244
The modified gen p mean: 0.4476640224456787, gen p mean: 0.0, mean p set: 0.4485437870025635
The modified gen p mean: 0.44717520475387573, gen p mean: 0.0, mean p set: 0.449124276638031
loss_pred:0.05260691046714783, decouple_loss:0.04090789705514908
loss_pred:0.05159097909927368, decouple_loss:0.039972785860300064
loss_pred:0.0504600889980793, decouple_loss:0.03871329128742218
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44485044479370117, gen p mean: 0.0, mean p set: 0.4495622515678406
The modified gen p mean: 0.4439072608947754, gen p mean: 0.0, mean p set: 0.44939300417900085
The modified gen p mean: 0.4393799901008606, gen p mean: 0.0, mean p set: 0.4510430097579956
loss_pred:0.05343107506632805, decouple_loss:0.04017914831638336
loss_pred:0.05464974045753479, decouple_loss:0.03944860026240349
loss_pred:0.05120295286178589, decouple_loss:0.039703190326690674
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45401355624198914, gen p mean: 0.0, mean p set: 0.4505882263183594
The modified gen p mean: 0.45271289348602295, gen p mean: 0.0, mean p set: 0.45011213421821594
The modified gen p mean: 0.45468658208847046, gen p mean: 0.0, mean p set: 0.4490378499031067
loss_pred:0.052066583186388016, decouple_loss:0.04108085483312607
loss_pred:0.051267944276332855, decouple_loss:0.039765361696481705
loss_pred:0.05374862998723984, decouple_loss:0.03973923623561859
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524242579936981, gen p mean: 0.0, mean p set: 0.4476247727870941
The modified gen p mean: 0.45362794399261475, gen p mean: 0.0, mean p set: 0.44995033740997314
The modified gen p mean: 0.45314693450927734, gen p mean: 0.0, mean p set: 0.4501139223575592
loss_pred:0.052756886929273605, decouple_loss:0.04035438224673271
loss_pred:0.05346701666712761, decouple_loss:0.0397251732647419
loss_pred:0.05265257880091667, decouple_loss:0.04024562984704971
2023-05-02 16:17:06 testing...
The modified gen p mean: 0.44122087955474854, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4468265771865845, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4463745653629303, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05341338738799095, decouple_loss:0.04208004102110863
loss_pred:0.05075426772236824, decouple_loss:0.040874652564525604
loss_pred:0.0516120009124279, decouple_loss:0.040659788995981216
WV_0_PC_0_EH_0_PS_40_6, loss: 0.053986795246601105, avg_mse: 0.054474957287311554
current test mse: 0.054475
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785910844802856, gen p mean: 0.0, mean p set: 0.44997039437294006
The modified gen p mean: 0.44356951117515564, gen p mean: 0.0, mean p set: 0.44834598898887634
loss_pred:0.05177506059408188, decouple_loss:0.04049382731318474
loss_pred:0.04999655485153198, decouple_loss:0.039414048194885254
The modified gen p mean: 0.4541531503200531, gen p mean: 0.0, mean p set: 0.4510376751422882
loss_pred:0.05254772678017616, decouple_loss:0.03927641734480858
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521830379962921, gen p mean: 0.0, mean p set: 0.45153409242630005
The modified gen p mean: 0.45227929949760437, gen p mean: 0.0, mean p set: 0.44817185401916504
The modified gen p mean: 0.4512185752391815, gen p mean: 0.0, mean p set: 0.4478309452533722
loss_pred:0.04974568635225296, decouple_loss:0.04012571647763252
loss_pred:0.05289709195494652, decouple_loss:0.03932296112179756
loss_pred:0.052603885531425476, decouple_loss:0.039392564445734024
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937509298324585, gen p mean: 0.0, mean p set: 0.4498726725578308
The modified gen p mean: 0.4419039785861969, gen p mean: 0.0, mean p set: 0.4512731432914734
The modified gen p mean: 0.4470566213130951, gen p mean: 0.0, mean p set: 0.4485168755054474
loss_pred:0.0538456030189991, decouple_loss:0.041286271065473557
loss_pred:0.051603153347969055, decouple_loss:0.039535123854875565
loss_pred:0.05168559029698372, decouple_loss:0.03967126086354256
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45652270317077637, gen p mean: 0.0, mean p set: 0.4481086730957031
The modified gen p mean: 0.44549334049224854, gen p mean: 0.0, mean p set: 0.4512166678905487
The modified gen p mean: 0.44788679480552673, gen p mean: 0.0, mean p set: 0.4482121169567108
loss_pred:0.05310438573360443, decouple_loss:0.040825650095939636
loss_pred:0.05125684291124344, decouple_loss:0.03972362354397774
loss_pred:0.05027708783745766, decouple_loss:0.0402262806892395
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529571533203125, gen p mean: 0.0, mean p set: 0.45073163509368896
The modified gen p mean: 0.45161905884742737, gen p mean: 0.0, mean p set: 0.4488905668258667
The modified gen p mean: 0.4501185417175293, gen p mean: 0.0, mean p set: 0.45043426752090454
loss_pred:0.05009468272328377, decouple_loss:0.04024561122059822
loss_pred:0.05029786005616188, decouple_loss:0.03953811153769493
loss_pred:0.05214099586009979, decouple_loss:0.039832085371017456
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45151737332344055, gen p mean: 0.0, mean p set: 0.4490673840045929
The modified gen p mean: 0.4492938220500946, gen p mean: 0.0, mean p set: 0.44842615723609924
The modified gen p mean: 0.45149874687194824, gen p mean: 0.0, mean p set: 0.4480978846549988
loss_pred:0.053136032074689865, decouple_loss:0.039485715329647064
loss_pred:0.05087624490261078, decouple_loss:0.038878075778484344
loss_pred:0.05134589970111847, decouple_loss:0.038907308131456375
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45766696333885193, gen p mean: 0.0, mean p set: 0.45051300525665283
The modified gen p mean: 0.4499335289001465, gen p mean: 0.0, mean p set: 0.44721853733062744
The modified gen p mean: 0.45603814721107483, gen p mean: 0.0, mean p set: 0.4506089687347412
loss_pred:0.04979346692562103, decouple_loss:0.038955140858888626
loss_pred:0.04846771061420441, decouple_loss:0.0402892604470253
loss_pred:0.05180790647864342, decouple_loss:0.03941066935658455
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4325961470603943, gen p mean: 0.0, mean p set: 0.4522051215171814
The modified gen p mean: 0.43406152725219727, gen p mean: 0.0, mean p set: 0.4512079358100891
The modified gen p mean: 0.4391587972640991, gen p mean: 0.0, mean p set: 0.45134055614471436
loss_pred:0.05211540311574936, decouple_loss:0.04013358801603317
loss_pred:0.05017624795436859, decouple_loss:0.039513878524303436
loss_pred:0.052934397011995316, decouple_loss:0.03937917575240135
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482821226119995, gen p mean: 0.0, mean p set: 0.44887641072273254
The modified gen p mean: 0.45502570271492004, gen p mean: 0.0, mean p set: 0.45074358582496643
The modified gen p mean: 0.45705658197402954, gen p mean: 0.0, mean p set: 0.4507790505886078
loss_pred:0.049372006207704544, decouple_loss:0.0387425534427166
loss_pred:0.05120750516653061, decouple_loss:0.040585603564977646
loss_pred:0.05016152560710907, decouple_loss:0.040164630860090256
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45394110679626465, gen p mean: 0.0, mean p set: 0.4477352201938629
The modified gen p mean: 0.45192950963974, gen p mean: 0.0, mean p set: 0.44724181294441223
The modified gen p mean: 0.45040392875671387, gen p mean: 0.0, mean p set: 0.44759562611579895
loss_pred:0.049233902245759964, decouple_loss:0.04182019829750061
loss_pred:0.04935877397656441, decouple_loss:0.04110073670744896
loss_pred:0.051961734890937805, decouple_loss:0.04155350103974342
2023-05-02 16:21:24 testing...
The modified gen p mean: 0.4531300961971283, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4474552273750305, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4530130922794342, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.05095431208610535, decouple_loss:0.040770482271909714
loss_pred:0.05265267938375473, decouple_loss:0.04145307466387749
loss_pred:0.049993179738521576, decouple_loss:0.0415409579873085
WV_0_PC_0_EH_0_PS_40_6, loss: 0.053262799978256226, avg_mse: 0.05369816720485687
current test mse: 0.053698
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4546568989753723, gen p mean: 0.0, mean p set: 0.44691428542137146
loss_pred:0.05087092146277428, decouple_loss:0.042804401367902756
The modified gen p mean: 0.45103758573532104, gen p mean: 0.0, mean p set: 0.44746458530426025
loss_pred:0.05025201290845871, decouple_loss:0.04175800085067749
The modified gen p mean: 0.45173418521881104, gen p mean: 0.0, mean p set: 0.4480046033859253
loss_pred:0.05061344802379608, decouple_loss:0.04201009124517441
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504321813583374, gen p mean: 0.0, mean p set: 0.4486413896083832
The modified gen p mean: 0.4514980912208557, gen p mean: 0.0, mean p set: 0.4478640854358673
The modified gen p mean: 0.44422054290771484, gen p mean: 0.0, mean p set: 0.44779056310653687
loss_pred:0.048668671399354935, decouple_loss:0.043404314666986465
loss_pred:0.049755215644836426, decouple_loss:0.04405564069747925
loss_pred:0.047801222652196884, decouple_loss:0.04230809584259987
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818517565727234, gen p mean: 0.0, mean p set: 0.447729229927063
The modified gen p mean: 0.4476644992828369, gen p mean: 0.0, mean p set: 0.44803258776664734
The modified gen p mean: 0.4505881667137146, gen p mean: 0.0, mean p set: 0.4468306601047516
loss_pred:0.05036056414246559, decouple_loss:0.04285874590277672
loss_pred:0.04996902123093605, decouple_loss:0.04299548640847206
loss_pred:0.04765787348151207, decouple_loss:0.04226795211434364
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44623783230781555, gen p mean: 0.0, mean p set: 0.44837021827697754
The modified gen p mean: 0.4430461823940277, gen p mean: 0.0, mean p set: 0.44816744327545166
The modified gen p mean: 0.4443502128124237, gen p mean: 0.0, mean p set: 0.44784313440322876
loss_pred:0.05057224631309509, decouple_loss:0.04119664058089256
loss_pred:0.049892257899045944, decouple_loss:0.0417182520031929
loss_pred:0.051754917949438095, decouple_loss:0.04223189875483513
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517971873283386, gen p mean: 0.0, mean p set: 0.4478060305118561
The modified gen p mean: 0.4519403278827667, gen p mean: 0.0, mean p set: 0.4487118422985077
The modified gen p mean: 0.44775325059890747, gen p mean: 0.0, mean p set: 0.4477040469646454
loss_pred:0.049244996160268784, decouple_loss:0.04100451618432999
loss_pred:0.048973698168992996, decouple_loss:0.04166309908032417
loss_pred:0.048912569880485535, decouple_loss:0.04093722626566887
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45324066281318665, gen p mean: 0.0, mean p set: 0.4484192430973053
The modified gen p mean: 0.452426016330719, gen p mean: 0.0, mean p set: 0.4470071494579315
The modified gen p mean: 0.4511980414390564, gen p mean: 0.0, mean p set: 0.4465283155441284
loss_pred:0.05073275789618492, decouple_loss:0.04078706353902817
loss_pred:0.04854288697242737, decouple_loss:0.04148641973733902
loss_pred:0.050424616783857346, decouple_loss:0.03959780931472778
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447916179895401, gen p mean: 0.0, mean p set: 0.44642776250839233
The modified gen p mean: 0.45099201798439026, gen p mean: 0.0, mean p set: 0.4485728442668915
The modified gen p mean: 0.44837120175361633, gen p mean: 0.0, mean p set: 0.44841933250427246
loss_pred:0.048749763518571854, decouple_loss:0.040449902415275574
loss_pred:0.048196401447057724, decouple_loss:0.040249377489089966
loss_pred:0.051305826753377914, decouple_loss:0.04001045599579811
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44281160831451416, gen p mean: 0.0, mean p set: 0.44809025526046753
The modified gen p mean: 0.4484320878982544, gen p mean: 0.0, mean p set: 0.4481956660747528
The modified gen p mean: 0.4417574405670166, gen p mean: 0.0, mean p set: 0.4481656849384308
loss_pred:0.048489563167095184, decouple_loss:0.03876461833715439
loss_pred:0.04768482595682144, decouple_loss:0.03930532559752464
loss_pred:0.049207814037799835, decouple_loss:0.039652761071920395
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052239298820496, gen p mean: 0.0, mean p set: 0.44838324189186096
The modified gen p mean: 0.451786607503891, gen p mean: 0.0, mean p set: 0.44797375798225403
The modified gen p mean: 0.45571574568748474, gen p mean: 0.0, mean p set: 0.44797828793525696
loss_pred:0.04903266951441765, decouple_loss:0.03964865580201149
loss_pred:0.05126894265413284, decouple_loss:0.03897404298186302
loss_pred:0.05015994980931282, decouple_loss:0.03961195796728134
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45737043023109436, gen p mean: 0.0, mean p set: 0.4478125274181366
The modified gen p mean: 0.4550105631351471, gen p mean: 0.0, mean p set: 0.44884711503982544
The modified gen p mean: 0.4548113942146301, gen p mean: 0.0, mean p set: 0.44820475578308105
loss_pred:0.047110676765441895, decouple_loss:0.0383765883743763
loss_pred:0.04901256784796715, decouple_loss:0.03979242965579033
loss_pred:0.049703992903232574, decouple_loss:0.03844521939754486
2023-05-02 16:25:05 testing...
The modified gen p mean: 0.44209587574005127, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44657468795776367, gen p mean: 0.0, mean p set: 0.4500633478164673The modified gen p mean: 0.4470926523208618, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.05104231461882591, decouple_loss:0.04008818417787552
loss_pred:0.050045162439346313, decouple_loss:0.03934849053621292
loss_pred:0.0487336665391922, decouple_loss:0.03941336274147034
WV_0_PC_0_EH_0_PS_40_6, loss: 0.05192121863365173, avg_mse: 0.05219471827149391
current test mse: 0.052195
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44443371891975403, gen p mean: 0.0, mean p set: 0.44756636023521423
The modified gen p mean: 0.4474388659000397, gen p mean: 0.0, mean p set: 0.44827502965927124
loss_pred:0.047821421176195145, decouple_loss:0.038562968373298645
loss_pred:0.0485948882997036, decouple_loss:0.037672318518161774
The modified gen p mean: 0.44548964500427246, gen p mean: 0.0, mean p set: 0.44802215695381165
loss_pred:0.0484318807721138, decouple_loss:0.03832712024450302
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470282793045044, gen p mean: 0.0, mean p set: 0.4482816159725189
The modified gen p mean: 0.4446220099925995, gen p mean: 0.0, mean p set: 0.4470813572406769
The modified gen p mean: 0.4481421411037445, gen p mean: 0.0, mean p set: 0.44725507497787476
loss_pred:0.04860448092222214, decouple_loss:0.03847520053386688
loss_pred:0.04716486483812332, decouple_loss:0.03853197023272514
loss_pred:0.048943858593702316, decouple_loss:0.03736100345849991
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4555501937866211, gen p mean: 0.0, mean p set: 0.4466179311275482
The modified gen p mean: 0.45596402883529663, gen p mean: 0.0, mean p set: 0.44888749718666077
The modified gen p mean: 0.45060431957244873, gen p mean: 0.0, mean p set: 0.4485515058040619
loss_pred:0.04972512274980545, decouple_loss:0.03771958500146866
loss_pred:0.04716851934790611, decouple_loss:0.038031529635190964
loss_pred:0.05137014016509056, decouple_loss:0.03801766037940979
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972386956214905, gen p mean: 0.0, mean p set: 0.4488631784915924
The modified gen p mean: 0.45014119148254395, gen p mean: 0.0, mean p set: 0.44765913486480713
The modified gen p mean: 0.4537810981273651, gen p mean: 0.0, mean p set: 0.4484681785106659
loss_pred:0.05032505467534065, decouple_loss:0.03808732330799103
loss_pred:0.050402719527482986, decouple_loss:0.037940286099910736
loss_pred:0.04856418818235397, decouple_loss:0.0380408801138401
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44169676303863525, gen p mean: 0.0, mean p set: 0.4486749470233917
The modified gen p mean: 0.4479585886001587, gen p mean: 0.0, mean p set: 0.44661951065063477
The modified gen p mean: 0.44596078991889954, gen p mean: 0.0, mean p set: 0.4473138451576233
loss_pred:0.050158899277448654, decouple_loss:0.03832360357046127
loss_pred:0.04784778505563736, decouple_loss:0.037172582000494
loss_pred:0.04766581580042839, decouple_loss:0.03733291104435921
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973742961883545, gen p mean: 0.0, mean p set: 0.4477818012237549
The modified gen p mean: 0.4523034989833832, gen p mean: 0.0, mean p set: 0.4477280378341675
The modified gen p mean: 0.4505676329135895, gen p mean: 0.0, mean p set: 0.4479471743106842
loss_pred:0.04826165735721588, decouple_loss:0.0362418070435524
loss_pred:0.04790119826793671, decouple_loss:0.0371023453772068
loss_pred:0.04898843914270401, decouple_loss:0.03695136681199074
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46024855971336365, gen p mean: 0.0, mean p set: 0.4485739767551422
The modified gen p mean: 0.457185298204422, gen p mean: 0.0, mean p set: 0.44812464714050293
The modified gen p mean: 0.4564015567302704, gen p mean: 0.0, mean p set: 0.44638389348983765
loss_pred:0.04724658280611038, decouple_loss:0.036801911890506744
loss_pred:0.048119496554136276, decouple_loss:0.036789074540138245
loss_pred:0.04650450497865677, decouple_loss:0.03642144426703453
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539603292942047, gen p mean: 0.0, mean p set: 0.44719401001930237
The modified gen p mean: 0.45542898774147034, gen p mean: 0.0, mean p set: 0.448952317237854
The modified gen p mean: 0.4589662253856659, gen p mean: 0.0, mean p set: 0.44709837436676025
loss_pred:0.04867752268910408, decouple_loss:0.0373632051050663
loss_pred:0.047786157578229904, decouple_loss:0.03720289468765259
loss_pred:0.04823319613933563, decouple_loss:0.036371033638715744
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4396345615386963, gen p mean: 0.0, mean p set: 0.4490656852722168
The modified gen p mean: 0.43719983100891113, gen p mean: 0.0, mean p set: 0.4467509686946869
The modified gen p mean: 0.44012629985809326, gen p mean: 0.0, mean p set: 0.44809815287590027
loss_pred:0.04707017168402672, decouple_loss:0.03629644587635994
loss_pred:0.04802868887782097, decouple_loss:0.03707697615027428
loss_pred:0.047065749764442444, decouple_loss:0.037502240389585495
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4405181407928467, gen p mean: 0.0, mean p set: 0.44757208228111267
The modified gen p mean: 0.44133424758911133, gen p mean: 0.0, mean p set: 0.44687342643737793
The modified gen p mean: 0.4404466152191162, gen p mean: 0.0, mean p set: 0.4485243558883667
loss_pred:0.05056742578744888, decouple_loss:0.03644483536481857loss_pred:0.046966131776571274, decouple_loss:0.03609008342027664
loss_pred:0.04589603468775749, decouple_loss:0.03586292266845703
2023-05-02 16:29:28 testing...
The modified gen p mean: 0.4484834671020508, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4441964328289032, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4484218955039978, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.04926479235291481, decouple_loss:0.036565568298101425
loss_pred:0.05060802400112152, decouple_loss:0.03773697465658188
loss_pred:0.04837903007864952, decouple_loss:0.03685280680656433
WV_0_PC_0_EH_0_PS_40_6, loss: 0.05126987025141716, avg_mse: 0.051778122782707214
current test mse: 0.051778
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460389018058777, gen p mean: 0.0, mean p set: 0.44823282957077026
loss_pred:0.04922078177332878, decouple_loss:0.03740578517317772
The modified gen p mean: 0.44507119059562683, gen p mean: 0.0, mean p set: 0.44847849011421204
loss_pred:0.048676054924726486, decouple_loss:0.03588293120265007
The modified gen p mean: 0.4430784583091736, gen p mean: 0.0, mean p set: 0.4470709264278412
loss_pred:0.05050667002797127, decouple_loss:0.03935772925615311
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45521271228790283, gen p mean: 0.0, mean p set: 0.4481431543827057
The modified gen p mean: 0.4558636248111725, gen p mean: 0.0, mean p set: 0.4462227523326874
The modified gen p mean: 0.459824800491333, gen p mean: 0.0, mean p set: 0.4477720260620117
loss_pred:0.04680292680859566, decouple_loss:0.03569906949996948
loss_pred:0.046239085495471954, decouple_loss:0.037284646183252335
loss_pred:0.05069100484251976, decouple_loss:0.03641844913363457
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45441338419914246, gen p mean: 0.0, mean p set: 0.4487445652484894
The modified gen p mean: 0.4544691741466522, gen p mean: 0.0, mean p set: 0.44651445746421814
The modified gen p mean: 0.45833051204681396, gen p mean: 0.0, mean p set: 0.44649171829223633
loss_pred:0.04803691804409027, decouple_loss:0.03715677931904793
loss_pred:0.04704294353723526, decouple_loss:0.03654986619949341
loss_pred:0.05080685019493103, decouple_loss:0.037383586168289185
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4327852725982666, gen p mean: 0.0, mean p set: 0.4485151767730713
The modified gen p mean: 0.4303135871887207, gen p mean: 0.0, mean p set: 0.4472406804561615
The modified gen p mean: 0.43168818950653076, gen p mean: 0.0, mean p set: 0.4488321542739868
loss_pred:0.04674447700381279, decouple_loss:0.0362296886742115
loss_pred:0.049242377281188965, decouple_loss:0.03588714823126793
loss_pred:0.045623552054166794, decouple_loss:0.035686179995536804
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454764723777771, gen p mean: 0.0, mean p set: 0.44571492075920105
The modified gen p mean: 0.44251713156700134, gen p mean: 0.0, mean p set: 0.4460570514202118
The modified gen p mean: 0.4389939606189728, gen p mean: 0.0, mean p set: 0.44754740595817566
loss_pred:0.046783749014139175, decouple_loss:0.03729434683918953
loss_pred:0.04567965120077133, decouple_loss:0.03762410581111908
loss_pred:0.04983207583427429, decouple_loss:0.038594529032707214
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4563068449497223, gen p mean: 0.0, mean p set: 0.44927650690078735
The modified gen p mean: 0.4651379883289337, gen p mean: 0.0, mean p set: 0.44777190685272217
The modified gen p mean: 0.4597839117050171, gen p mean: 0.0, mean p set: 0.4486336410045624
loss_pred:0.04784034937620163, decouple_loss:0.03712812438607216
loss_pred:0.04565601050853729, decouple_loss:0.0362931564450264
loss_pred:0.05040517449378967, decouple_loss:0.036488696932792664
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529876410961151, gen p mean: 0.0, mean p set: 0.4466347098350525
The modified gen p mean: 0.45277607440948486, gen p mean: 0.0, mean p set: 0.4469250440597534
The modified gen p mean: 0.45355525612831116, gen p mean: 0.0, mean p set: 0.44701406359672546
loss_pred:0.05026496946811676, decouple_loss:0.035932574421167374
loss_pred:0.049558091908693314, decouple_loss:0.037883106619119644
loss_pred:0.05003737285733223, decouple_loss:0.0380379781126976
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44016510248184204, gen p mean: 0.0, mean p set: 0.4477066397666931
The modified gen p mean: 0.4402744770050049, gen p mean: 0.0, mean p set: 0.4471120834350586
The modified gen p mean: 0.435310959815979, gen p mean: 0.0, mean p set: 0.44913914799690247
loss_pred:0.05093948543071747, decouple_loss:0.036710258573293686
loss_pred:0.05055046081542969, decouple_loss:0.0362766869366169
loss_pred:0.05143022537231445, decouple_loss:0.03659482300281525
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684866070747375, gen p mean: 0.0, mean p set: 0.44815605878829956
The modified gen p mean: 0.44761574268341064, gen p mean: 0.0, mean p set: 0.44859448075294495
The modified gen p mean: 0.44387930631637573, gen p mean: 0.0, mean p set: 0.4464513063430786
loss_pred:0.046234190464019775, decouple_loss:0.036510709673166275
loss_pred:0.05210983380675316, decouple_loss:0.03813493251800537
loss_pred:0.0494317002594471, decouple_loss:0.03728202357888222
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45212653279304504, gen p mean: 0.0, mean p set: 0.44696107506752014
The modified gen p mean: 0.45051732659339905, gen p mean: 0.0, mean p set: 0.4486321210861206
The modified gen p mean: 0.4461336135864258, gen p mean: 0.0, mean p set: 0.44949212670326233
loss_pred:0.04850691184401512, decouple_loss:0.03684060648083687
loss_pred:0.046336930245161057, decouple_loss:0.03497476875782013
loss_pred:0.04948520287871361, decouple_loss:0.03769072890281677
2023-05-02 16:33:08 testing...
The modified gen p mean: 0.4468669295310974, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.453885018825531, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4515133500099182, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.0503985770046711, decouple_loss:0.03722167760133743
loss_pred:0.04802548512816429, decouple_loss:0.036915648728609085
loss_pred:0.049727704375982285, decouple_loss:0.03626728802919388
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0512240007519722, avg_mse: 0.05184715613722801
current test mse: 0.051847
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480677545070648, gen p mean: 0.0, mean p set: 0.44778627157211304
The modified gen p mean: 0.44862130284309387, gen p mean: 0.0, mean p set: 0.4486530125141144
loss_pred:0.04784931614995003, decouple_loss:0.03589348495006561
loss_pred:0.05193137377500534, decouple_loss:0.037660058587789536
The modified gen p mean: 0.44752633571624756, gen p mean: 0.0, mean p set: 0.44710099697113037
loss_pred:0.04506974667310715, decouple_loss:0.036169975996017456
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4445643723011017, gen p mean: 0.0, mean p set: 0.44772249460220337
The modified gen p mean: 0.4435633420944214, gen p mean: 0.0, mean p set: 0.44717034697532654
The modified gen p mean: 0.4419865608215332, gen p mean: 0.0, mean p set: 0.44928810000419617
loss_pred:0.04707906395196915, decouple_loss:0.036313727498054504
loss_pred:0.049006856977939606, decouple_loss:0.03779829293489456
loss_pred:0.050085607916116714, decouple_loss:0.035733986645936966
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4404357373714447, gen p mean: 0.0, mean p set: 0.44714486598968506
The modified gen p mean: 0.44723743200302124, gen p mean: 0.0, mean p set: 0.44768208265304565
The modified gen p mean: 0.4432592988014221, gen p mean: 0.0, mean p set: 0.4483468234539032
loss_pred:0.050136748701334, decouple_loss:0.035488311201334
loss_pred:0.04569521173834801, decouple_loss:0.03613712638616562
loss_pred:0.04773595556616783, decouple_loss:0.03610151633620262
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519157409667969, gen p mean: 0.0, mean p set: 0.44747447967529297
The modified gen p mean: 0.4499519169330597, gen p mean: 0.0, mean p set: 0.44843539595603943
The modified gen p mean: 0.44801822304725647, gen p mean: 0.0, mean p set: 0.4483872950077057
loss_pred:0.047797948122024536, decouple_loss:0.03639521449804306
loss_pred:0.04477844014763832, decouple_loss:0.0363783985376358
loss_pred:0.047804828733205795, decouple_loss:0.03623625636100769
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46839889883995056, gen p mean: 0.0, mean p set: 0.44873204827308655
The modified gen p mean: 0.47367429733276367, gen p mean: 0.0, mean p set: 0.4479168951511383
The modified gen p mean: 0.46869632601737976, gen p mean: 0.0, mean p set: 0.44929662346839905
loss_pred:0.04629208520054817, decouple_loss:0.036418452858924866
loss_pred:0.04556320235133171, decouple_loss:0.03579697385430336
loss_pred:0.04919387400150299, decouple_loss:0.035545092076063156
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451126754283905, gen p mean: 0.0, mean p set: 0.4473552703857422
The modified gen p mean: 0.4455261528491974, gen p mean: 0.0, mean p set: 0.44818755984306335
The modified gen p mean: 0.4469468295574188, gen p mean: 0.0, mean p set: 0.4477138817310333
loss_pred:0.04699048772454262, decouple_loss:0.03697340562939644
loss_pred:0.047315437346696854, decouple_loss:0.035809680819511414
loss_pred:0.045440200716257095, decouple_loss:0.03495010733604431
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42347079515457153, gen p mean: 0.0, mean p set: 0.4475022256374359
The modified gen p mean: 0.42039310932159424, gen p mean: 0.0, mean p set: 0.44742488861083984
The modified gen p mean: 0.424782931804657, gen p mean: 0.0, mean p set: 0.44687098264694214
loss_pred:0.046427011489868164, decouple_loss:0.03537944704294205
loss_pred:0.04936579242348671, decouple_loss:0.036305319517850876
loss_pred:0.04775230959057808, decouple_loss:0.03566008806228638
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44450643658638, gen p mean: 0.0, mean p set: 0.449090838432312
The modified gen p mean: 0.44942423701286316, gen p mean: 0.0, mean p set: 0.4483067989349365
The modified gen p mean: 0.45017826557159424, gen p mean: 0.0, mean p set: 0.4479806125164032
loss_pred:0.04649694263935089, decouple_loss:0.03576831519603729loss_pred:0.04944374039769173, decouple_loss:0.03648582473397255
loss_pred:0.04764996096491814, decouple_loss:0.03474869579076767
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4637906551361084, gen p mean: 0.0, mean p set: 0.4475656747817993
The modified gen p mean: 0.4635578393936157, gen p mean: 0.0, mean p set: 0.4467092752456665
The modified gen p mean: 0.4609217047691345, gen p mean: 0.0, mean p set: 0.4489142596721649
loss_pred:0.04616226255893707, decouple_loss:0.03515973687171936
loss_pred:0.04912160336971283, decouple_loss:0.03595145419239998
loss_pred:0.04892891272902489, decouple_loss:0.035106755793094635
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
NaN value num: 0
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4552460312843323, gen p mean: 0.0, mean p set: 0.45243212580680847
The modified gen p mean: 0.45363980531692505, gen p mean: 0.0, mean p set: 0.4520227611064911
The modified gen p mean: 0.454204797744751, gen p mean: 0.0, mean p set: 0.4516755938529968
loss_pred:0.053691014647483826, decouple_loss:0.04008576646447182
loss_pred:0.05060764402151108, decouple_loss:0.04099318012595177
loss_pred:0.05368954688310623, decouple_loss:0.04042462259531021
2023-05-02 16:37:22 testing...
The modified gen p mean: 0.445637971162796, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4400041103363037, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4487361013889313, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.04912467673420906, decouple_loss:0.03594931215047836
loss_pred:0.050100501626729965, decouple_loss:0.03639107942581177
loss_pred:0.0478309690952301, decouple_loss:0.03703675419092178
WV_0_PC_0_EH_0_PS_40_6, loss: 0.050841670483350754, avg_mse: 0.051463935524225235
current test mse: 0.051464
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44117531180381775, gen p mean: 0.0, mean p set: 0.4534855782985687
loss_pred:0.0521063506603241, decouple_loss:0.04226801544427872
The modified gen p mean: 0.4425026476383209, gen p mean: 0.0, mean p set: 0.45209604501724243
loss_pred:0.052680835127830505, decouple_loss:0.04236467555165291
The modified gen p mean: 0.44537729024887085, gen p mean: 0.0, mean p set: 0.4527874290943146
loss_pred:0.053183794021606445, decouple_loss:0.04220109432935715
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4563220143318176, gen p mean: 0.0, mean p set: 0.4526340067386627
The modified gen p mean: 0.45901793241500854, gen p mean: 0.0, mean p set: 0.4518716335296631
The modified gen p mean: 0.4578682482242584, gen p mean: 0.0, mean p set: 0.45211732387542725
loss_pred:0.05187877267599106, decouple_loss:0.04468972235918045
loss_pred:0.052129652351140976, decouple_loss:0.04175557941198349
loss_pred:0.05275094509124756, decouple_loss:0.04458910599350929
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4348427355289459, gen p mean: 0.0, mean p set: 0.45134681463241577
The modified gen p mean: 0.4402541518211365, gen p mean: 0.0, mean p set: 0.45172441005706787
The modified gen p mean: 0.4387531876564026, gen p mean: 0.0, mean p set: 0.45261338353157043
loss_pred:0.05150463059544563, decouple_loss:0.04279264435172081loss_pred:0.05094524472951889, decouple_loss:0.043227504938840866
loss_pred:0.051785871386528015, decouple_loss:0.04207368195056915
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44299548864364624, gen p mean: 0.0, mean p set: 0.452627569437027
The modified gen p mean: 0.4388003349304199, gen p mean: 0.0, mean p set: 0.45186206698417664
The modified gen p mean: 0.44271016120910645, gen p mean: 0.0, mean p set: 0.45184382796287537
loss_pred:0.05184138938784599, decouple_loss:0.04466899484395981
loss_pred:0.051019489765167236, decouple_loss:0.04091588407754898
loss_pred:0.050240784883499146, decouple_loss:0.04192325845360756
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46411266922950745, gen p mean: 0.0, mean p set: 0.4518454968929291
The modified gen p mean: 0.4627173840999603, gen p mean: 0.0, mean p set: 0.451729416847229
The modified gen p mean: 0.46244460344314575, gen p mean: 0.0, mean p set: 0.4504854083061218
loss_pred:0.05197730287909508, decouple_loss:0.04051048681139946
loss_pred:0.05140059068799019, decouple_loss:0.040886275470256805
loss_pred:0.051491428166627884, decouple_loss:0.040767278522253036
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45892131328582764, gen p mean: 0.0, mean p set: 0.4531855285167694
The modified gen p mean: 0.45780298113822937, gen p mean: 0.0, mean p set: 0.4515799880027771
The modified gen p mean: 0.4587629735469818, gen p mean: 0.0, mean p set: 0.4510330855846405
loss_pred:0.05128064379096031, decouple_loss:0.04138687998056412
loss_pred:0.051246970891952515, decouple_loss:0.04112584516406059
loss_pred:0.05082036554813385, decouple_loss:0.04064537584781647
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44650834798812866, gen p mean: 0.0, mean p set: 0.45208823680877686
The modified gen p mean: 0.44478803873062134, gen p mean: 0.0, mean p set: 0.4510248601436615
The modified gen p mean: 0.44590234756469727, gen p mean: 0.0, mean p set: 0.4525144100189209
loss_pred:0.04843265190720558, decouple_loss:0.0420600026845932
loss_pred:0.05191847309470177, decouple_loss:0.041940201073884964
loss_pred:0.050682589411735535, decouple_loss:0.040763676166534424
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44442808628082275, gen p mean: 0.0, mean p set: 0.4525282084941864
The modified gen p mean: 0.44641515612602234, gen p mean: 0.0, mean p set: 0.45164716243743896
The modified gen p mean: 0.4463108479976654, gen p mean: 0.0, mean p set: 0.45219916105270386
loss_pred:0.04891713336110115, decouple_loss:0.040710318833589554
loss_pred:0.05056125298142433, decouple_loss:0.040581416338682175
loss_pred:0.05091702193021774, decouple_loss:0.03984909504652023
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493725597858429, gen p mean: 0.0, mean p set: 0.4510296881198883
The modified gen p mean: 0.4506177008152008, gen p mean: 0.0, mean p set: 0.4529881477355957
The modified gen p mean: 0.4538179934024811, gen p mean: 0.0, mean p set: 0.4499078094959259
loss_pred:0.05037757381796837, decouple_loss:0.03959772735834122
loss_pred:0.049495499581098557, decouple_loss:0.041661933064460754
loss_pred:0.051619306206703186, decouple_loss:0.039952464401721954
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4593685567378998, gen p mean: 0.0, mean p set: 0.45249855518341064The modified gen p mean: 0.459994912147522, gen p mean: 0.0, mean p set: 0.45208021998405457
The modified gen p mean: 0.45877307653427124, gen p mean: 0.0, mean p set: 0.4525078237056732
loss_pred:0.04896089434623718, decouple_loss:0.03902718424797058
loss_pred:0.04933781176805496, decouple_loss:0.03908323869109154
loss_pred:0.04956874996423721, decouple_loss:0.039617154747247696
2023-05-02 16:41:02 testing...
The modified gen p mean: 0.442393958568573, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4531703293323517, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.449574738740921, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05193663015961647, decouple_loss:0.040022239089012146
loss_pred:0.04972197115421295, decouple_loss:0.04032214730978012
loss_pred:0.05059271305799484, decouple_loss:0.039332929998636246
WV_0_PC_0_EH_0_PS_40_6, loss: 0.05274505913257599, avg_mse: 0.053956713527441025
current test mse: 0.053957
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483243227005005, gen p mean: 0.0, mean p set: 0.4523273706436157
The modified gen p mean: 0.44754984974861145, gen p mean: 0.0, mean p set: 0.45157474279403687
loss_pred:0.04968182370066643, decouple_loss:0.03964868560433388
loss_pred:0.04876241087913513, decouple_loss:0.03866706043481827
The modified gen p mean: 0.4513871669769287, gen p mean: 0.0, mean p set: 0.45205479860305786
loss_pred:0.048018962144851685, decouple_loss:0.03886822611093521
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45160794258117676, gen p mean: 0.0, mean p set: 0.45199981331825256
The modified gen p mean: 0.4481145143508911, gen p mean: 0.0, mean p set: 0.4519910514354706
The modified gen p mean: 0.4466429650783539, gen p mean: 0.0, mean p set: 0.4526216387748718
loss_pred:0.048756662756204605, decouple_loss:0.03889371082186699
loss_pred:0.04802662134170532, decouple_loss:0.0393310971558094
loss_pred:0.05019962787628174, decouple_loss:0.03953493386507034
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018666982650757, gen p mean: 0.0, mean p set: 0.4526708424091339
The modified gen p mean: 0.45619213581085205, gen p mean: 0.0, mean p set: 0.4524872899055481
The modified gen p mean: 0.4560491442680359, gen p mean: 0.0, mean p set: 0.4520479440689087
loss_pred:0.050277773290872574, decouple_loss:0.03866524621844292
loss_pred:0.04968734085559845, decouple_loss:0.040427111089229584
loss_pred:0.04679611697793007, decouple_loss:0.038996897637844086
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465455710887909, gen p mean: 0.0, mean p set: 0.4523274898529053
The modified gen p mean: 0.4483494460582733, gen p mean: 0.0, mean p set: 0.4519905745983124
The modified gen p mean: 0.44907647371292114, gen p mean: 0.0, mean p set: 0.45244550704956055
loss_pred:0.04899677261710167, decouple_loss:0.04007357731461525
loss_pred:0.04836379364132881, decouple_loss:0.03888741508126259
loss_pred:0.048286519944667816, decouple_loss:0.040053047239780426
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44022706151008606, gen p mean: 0.0, mean p set: 0.4521573483943939
The modified gen p mean: 0.43465456366539, gen p mean: 0.0, mean p set: 0.4530870020389557
The modified gen p mean: 0.43982842564582825, gen p mean: 0.0, mean p set: 0.4520612061023712
loss_pred:0.0504942387342453, decouple_loss:0.039391666650772095
loss_pred:0.04999354109168053, decouple_loss:0.03968911990523338
loss_pred:0.048712678253650665, decouple_loss:0.039835549890995026
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4647877514362335, gen p mean: 0.0, mean p set: 0.4515860676765442
The modified gen p mean: 0.4638201594352722, gen p mean: 0.0, mean p set: 0.4527184069156647
The modified gen p mean: 0.4666600227355957, gen p mean: 0.0, mean p set: 0.452579140663147
loss_pred:0.0482158437371254, decouple_loss:0.039006177335977554
loss_pred:0.04931279271841049, decouple_loss:0.03896409273147583
loss_pred:0.05028143152594566, decouple_loss:0.04041258990764618
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4614218473434448, gen p mean: 0.0, mean p set: 0.45262742042541504
The modified gen p mean: 0.464895099401474, gen p mean: 0.0, mean p set: 0.4501059055328369
The modified gen p mean: 0.46151548624038696, gen p mean: 0.0, mean p set: 0.45053553581237793
loss_pred:0.04959022253751755, decouple_loss:0.039375271648168564
loss_pred:0.04975719749927521, decouple_loss:0.039801549166440964
loss_pred:0.050129421055316925, decouple_loss:0.03987479582428932
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4358532130718231, gen p mean: 0.0, mean p set: 0.45204487442970276
The modified gen p mean: 0.43427684903144836, gen p mean: 0.0, mean p set: 0.45061367750167847
The modified gen p mean: 0.43753883242607117, gen p mean: 0.0, mean p set: 0.45021140575408936
loss_pred:0.04749223217368126, decouple_loss:0.038848306983709335
loss_pred:0.04898977652192116, decouple_loss:0.03913271427154541
loss_pred:0.050270624458789825, decouple_loss:0.039428725838661194
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
NaN value num: 0
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4416511654853821, gen p mean: 0.0, mean p set: 0.4479075074195862
The modified gen p mean: 0.4362563490867615, gen p mean: 0.0, mean p set: 0.44871240854263306
The modified gen p mean: 0.44167473912239075, gen p mean: 0.0, mean p set: 0.4494416415691376
loss_pred:0.05320729687809944, decouple_loss:0.0415618009865284
loss_pred:0.052715811878442764, decouple_loss:0.04107072204351425
loss_pred:0.05187658965587616, decouple_loss:0.040865276008844376
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45771995186805725, gen p mean: 0.0, mean p set: 0.4479822516441345
The modified gen p mean: 0.4546690583229065, gen p mean: 0.0, mean p set: 0.4487318992614746
The modified gen p mean: 0.45494017004966736, gen p mean: 0.0, mean p set: 0.44792336225509644
loss_pred:0.05141148716211319, decouple_loss:0.0411328449845314
loss_pred:0.05049888417124748, decouple_loss:0.04177290201187134
loss_pred:0.050033971667289734, decouple_loss:0.041625846177339554
2023-05-02 16:45:21 testing...
The modified gen p mean: 0.44486376643180847, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4528450071811676, gen p mean: 0.0, mean p set: 0.45035696029663086The modified gen p mean: 0.4503798186779022, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05070681497454643, decouple_loss:0.04345288500189781
loss_pred:0.04801275581121445, decouple_loss:0.04398684576153755
loss_pred:0.04933743551373482, decouple_loss:0.04259301349520683
WV_0_PC_0_EH_0_PS_40_6, loss: 0.05151955038309097, avg_mse: 0.05205860361456871
current test mse: 0.052059
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451104074716568, gen p mean: 0.0, mean p set: 0.44886863231658936
The modified gen p mean: 0.4476851224899292, gen p mean: 0.0, mean p set: 0.44895002245903015
loss_pred:0.048559483140707016, decouple_loss:0.04367508366703987
loss_pred:0.05201706290245056, decouple_loss:0.042828142642974854
The modified gen p mean: 0.44947564601898193, gen p mean: 0.0, mean p set: 0.4478190541267395
loss_pred:0.04931989684700966, decouple_loss:0.04370953515172005
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.47550854086875916, gen p mean: 0.0, mean p set: 0.4482278525829315
The modified gen p mean: 0.4665358364582062, gen p mean: 0.0, mean p set: 0.44785749912261963
The modified gen p mean: 0.46605736017227173, gen p mean: 0.0, mean p set: 0.4483753740787506
loss_pred:0.04989055544137955, decouple_loss:0.045039102435112
loss_pred:0.05017661675810814, decouple_loss:0.04350769892334938
loss_pred:0.04781856760382652, decouple_loss:0.04504316672682762
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45653000473976135, gen p mean: 0.0, mean p set: 0.4493470788002014
The modified gen p mean: 0.45773839950561523, gen p mean: 0.0, mean p set: 0.44949179887771606
The modified gen p mean: 0.4506787061691284, gen p mean: 0.0, mean p set: 0.44894248247146606
loss_pred:0.05002295598387718, decouple_loss:0.0438542515039444
loss_pred:0.0499148927628994, decouple_loss:0.04431347921490669
loss_pred:0.05036361515522003, decouple_loss:0.04341219365596771
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4306005537509918, gen p mean: 0.0, mean p set: 0.4482729434967041
The modified gen p mean: 0.4303382933139801, gen p mean: 0.0, mean p set: 0.44863903522491455
The modified gen p mean: 0.43128588795661926, gen p mean: 0.0, mean p set: 0.4474784731864929
loss_pred:0.049656204879283905, decouple_loss:0.04332258924841881
loss_pred:0.04922356829047203, decouple_loss:0.0417754091322422
loss_pred:0.04908649995923042, decouple_loss:0.042335812002420425
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456677734851837, gen p mean: 0.0, mean p set: 0.4482739567756653
The modified gen p mean: 0.4399036467075348, gen p mean: 0.0, mean p set: 0.44843775033950806
The modified gen p mean: 0.44234561920166016, gen p mean: 0.0, mean p set: 0.44867268204689026
loss_pred:0.04903489723801613, decouple_loss:0.04090576991438866
loss_pred:0.04835037887096405, decouple_loss:0.04136978089809418
loss_pred:0.04773028939962387, decouple_loss:0.0420970618724823
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45942196249961853, gen p mean: 0.0, mean p set: 0.4481523036956787
The modified gen p mean: 0.4586312770843506, gen p mean: 0.0, mean p set: 0.44815748929977417
The modified gen p mean: 0.4614507555961609, gen p mean: 0.0, mean p set: 0.449349969625473
loss_pred:0.048392701894044876, decouple_loss:0.040772318840026855
loss_pred:0.0491594634950161, decouple_loss:0.040927086025476456
loss_pred:0.04718688502907753, decouple_loss:0.041144151240587234
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4567970335483551, gen p mean: 0.0, mean p set: 0.44853898882865906
The modified gen p mean: 0.45871683955192566, gen p mean: 0.0, mean p set: 0.44842007756233215
The modified gen p mean: 0.45736417174339294, gen p mean: 0.0, mean p set: 0.4481373429298401
loss_pred:0.049244288355112076, decouple_loss:0.04186806455254555
loss_pred:0.04896426573395729, decouple_loss:0.040578585118055344
loss_pred:0.04757469892501831, decouple_loss:0.04183073714375496
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44013512134552, gen p mean: 0.0, mean p set: 0.44803571701049805
The modified gen p mean: 0.4440103769302368, gen p mean: 0.0, mean p set: 0.4487142562866211
The modified gen p mean: 0.4439487159252167, gen p mean: 0.0, mean p set: 0.44887417554855347
loss_pred:0.04650067165493965, decouple_loss:0.03983544185757637
loss_pred:0.0496373251080513, decouple_loss:0.040022868663072586
loss_pred:0.047972843050956726, decouple_loss:0.04008733481168747
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464297890663147, gen p mean: 0.0, mean p set: 0.4482477605342865
The modified gen p mean: 0.44405898451805115, gen p mean: 0.0, mean p set: 0.4489932656288147
The modified gen p mean: 0.44973137974739075, gen p mean: 0.0, mean p set: 0.44845062494277954
loss_pred:0.04906075820326805, decouple_loss:0.03897087648510933
loss_pred:0.0477101095020771, decouple_loss:0.039052583277225494
loss_pred:0.04781603813171387, decouple_loss:0.039103370159864426
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469117820262909, gen p mean: 0.0, mean p set: 0.44841820001602173
The modified gen p mean: 0.44718578457832336, gen p mean: 0.0, mean p set: 0.4491376578807831
The modified gen p mean: 0.4464428424835205, gen p mean: 0.0, mean p set: 0.44855156540870667
loss_pred:0.04614032059907913, decouple_loss:0.039001140743494034
loss_pred:0.0485047847032547, decouple_loss:0.03864284232258797
loss_pred:0.0469597652554512, decouple_loss:0.039885181933641434
2023-05-02 16:49:03 testing...
The modified gen p mean: 0.4512229561805725, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45482537150382996, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45453473925590515, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.050108663737773895, decouple_loss:0.03920114040374756
loss_pred:0.04878148436546326, decouple_loss:0.039040740579366684
loss_pred:0.047621142119169235, decouple_loss:0.04002252593636513
WV_0_PC_0_EH_0_PS_40_6, loss: 0.050808172672986984, avg_mse: 0.051675502210855484
current test mse: 0.051676
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4576241374015808, gen p mean: 0.0, mean p set: 0.4474940896034241
loss_pred:0.04775770753622055, decouple_loss:0.03826575353741646
The modified gen p mean: 0.45360198616981506, gen p mean: 0.0, mean p set: 0.4484483003616333
loss_pred:0.048998769372701645, decouple_loss:0.03802501782774925
The modified gen p mean: 0.45415154099464417, gen p mean: 0.0, mean p set: 0.44894954562187195
loss_pred:0.049067869782447815, decouple_loss:0.03889770805835724
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992679357528687, gen p mean: 0.0, mean p set: 0.44897785782814026
The modified gen p mean: 0.4487421214580536, gen p mean: 0.0, mean p set: 0.4480125904083252
The modified gen p mean: 0.44826242327690125, gen p mean: 0.0, mean p set: 0.44777801632881165
loss_pred:0.04863732308149338, decouple_loss:0.03814833238720894
loss_pred:0.04752039536833763, decouple_loss:0.037618763744831085
loss_pred:0.04774797707796097, decouple_loss:0.03713943436741829
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155274868011475, gen p mean: 0.0, mean p set: 0.4481372833251953
The modified gen p mean: 0.4559665024280548, gen p mean: 0.0, mean p set: 0.44774329662323
The modified gen p mean: 0.453050822019577, gen p mean: 0.0, mean p set: 0.44883155822753906
loss_pred:0.05106399580836296, decouple_loss:0.038891226053237915
loss_pred:0.0473405085504055, decouple_loss:0.039570633322000504
loss_pred:0.05085500702261925, decouple_loss:0.03886670991778374
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43503981828689575, gen p mean: 0.0, mean p set: 0.4488488733768463
The modified gen p mean: 0.4323582053184509, gen p mean: 0.0, mean p set: 0.44898611307144165
The modified gen p mean: 0.43793490529060364, gen p mean: 0.0, mean p set: 0.4477321207523346
loss_pred:0.049889884889125824, decouple_loss:0.03859638050198555
loss_pred:0.05026068910956383, decouple_loss:0.038629621267318726
loss_pred:0.049677882343530655, decouple_loss:0.03747744858264923
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44887223839759827, gen p mean: 0.0, mean p set: 0.44894295930862427
The modified gen p mean: 0.4520348310470581, gen p mean: 0.0, mean p set: 0.44804492592811584
The modified gen p mean: 0.45071497559547424, gen p mean: 0.0, mean p set: 0.4483153223991394
loss_pred:0.04580213129520416, decouple_loss:0.03868649899959564
loss_pred:0.04776547849178314, decouple_loss:0.03843563795089722
loss_pred:0.048553626984357834, decouple_loss:0.03753361850976944
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4552791118621826, gen p mean: 0.0, mean p set: 0.4488413631916046
The modified gen p mean: 0.4547044634819031, gen p mean: 0.0, mean p set: 0.4493922293186188
The modified gen p mean: 0.46065226197242737, gen p mean: 0.0, mean p set: 0.4479096829891205
loss_pred:0.04810016229748726, decouple_loss:0.03787677735090256
loss_pred:0.048628564924001694, decouple_loss:0.03842967376112938
loss_pred:0.04749732092022896, decouple_loss:0.03728678077459335
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4393497407436371, gen p mean: 0.0, mean p set: 0.44815871119499207
The modified gen p mean: 0.44270259141921997, gen p mean: 0.0, mean p set: 0.4478082060813904
The modified gen p mean: 0.43929120898246765, gen p mean: 0.0, mean p set: 0.44808903336524963
loss_pred:0.048004042357206345, decouple_loss:0.03842030093073845
loss_pred:0.04755926877260208, decouple_loss:0.03759681060910225
loss_pred:0.04756610468029976, decouple_loss:0.03834425285458565
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4357503652572632, gen p mean: 0.0, mean p set: 0.44848933815956116
The modified gen p mean: 0.437957227230072, gen p mean: 0.0, mean p set: 0.4485030770301819
The modified gen p mean: 0.4352787733078003, gen p mean: 0.0, mean p set: 0.447996586561203
loss_pred:0.04838450253009796, decouple_loss:0.03808686137199402
loss_pred:0.0470481812953949, decouple_loss:0.03878119960427284
loss_pred:0.04761584848165512, decouple_loss:0.037355490028858185
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
NaN value num: 0
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45848241448402405, gen p mean: 0.0, mean p set: 0.45018163323402405
The modified gen p mean: 0.4606797695159912, gen p mean: 0.0, mean p set: 0.45040273666381836
The modified gen p mean: 0.45637068152427673, gen p mean: 0.0, mean p set: 0.4493206739425659
loss_pred:0.04941607639193535, decouple_loss:0.038860686123371124
loss_pred:0.048779360949993134, decouple_loss:0.03926330432295799
loss_pred:0.047791432589292526, decouple_loss:0.03797122836112976
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4663878381252289, gen p mean: 0.0, mean p set: 0.4517436623573303
The modified gen p mean: 0.46637794375419617, gen p mean: 0.0, mean p set: 0.45352625846862793
The modified gen p mean: 0.46989133954048157, gen p mean: 0.0, mean p set: 0.44917213916778564
loss_pred:0.05086507648229599, decouple_loss:0.039718080312013626
loss_pred:0.05041908472776413, decouple_loss:0.04078405722975731
loss_pred:0.04759335145354271, decouple_loss:0.03706201910972595
2023-05-02 16:53:29 testing...
The modified gen p mean: 0.44976770877838135, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44343599677085876, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44843944907188416, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.04675271362066269, decouple_loss:0.03825115039944649
loss_pred:0.04905346408486366, decouple_loss:0.038430772721767426
loss_pred:0.047835301607847214, decouple_loss:0.037424132227897644
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04978226125240326, avg_mse: 0.05064799636602402
current test mse: 0.050648
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519745111465454, gen p mean: 0.0, mean p set: 0.451905757188797
The modified gen p mean: 0.4510240852832794, gen p mean: 0.0, mean p set: 0.4516725242137909
loss_pred:0.049325376749038696, decouple_loss:0.039185233414173126
loss_pred:0.05119436979293823, decouple_loss:0.038726165890693665
The modified gen p mean: 0.45277541875839233, gen p mean: 0.0, mean p set: 0.45087239146232605
loss_pred:0.04781359061598778, decouple_loss:0.03879924491047859
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4412327706813812, gen p mean: 0.0, mean p set: 0.4507025480270386
The modified gen p mean: 0.436314195394516, gen p mean: 0.0, mean p set: 0.45045459270477295
The modified gen p mean: 0.43682026863098145, gen p mean: 0.0, mean p set: 0.4532198905944824
loss_pred:0.05014307051897049, decouple_loss:0.038418009877204895
loss_pred:0.04730353504419327, decouple_loss:0.03884763643145561
loss_pred:0.050588786602020264, decouple_loss:0.040944654494524
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4444650113582611, gen p mean: 0.0, mean p set: 0.4494048058986664
The modified gen p mean: 0.44380074739456177, gen p mean: 0.0, mean p set: 0.45096808671951294
The modified gen p mean: 0.44806838035583496, gen p mean: 0.0, mean p set: 0.45304545760154724
loss_pred:0.04639410972595215, decouple_loss:0.038088418543338776
loss_pred:0.047116540372371674, decouple_loss:0.038303062319755554
loss_pred:0.04925207793712616, decouple_loss:0.040379203855991364
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4562685787677765, gen p mean: 0.0, mean p set: 0.44981902837753296
The modified gen p mean: 0.4568697512149811, gen p mean: 0.0, mean p set: 0.4510878920555115
The modified gen p mean: 0.45888271927833557, gen p mean: 0.0, mean p set: 0.4534813165664673
loss_pred:0.04745986685156822, decouple_loss:0.04001171141862869
loss_pred:0.050553176552057266, decouple_loss:0.03910455480217934
loss_pred:0.04967845231294632, decouple_loss:0.04154635965824127
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497529864311218, gen p mean: 0.0, mean p set: 0.4505661725997925
The modified gen p mean: 0.44990184903144836, gen p mean: 0.0, mean p set: 0.45020797848701477
The modified gen p mean: 0.4520178437232971, gen p mean: 0.0, mean p set: 0.45364704728126526
loss_pred:0.046792902052402496, decouple_loss:0.03888273984193802
loss_pred:0.050149623304605484, decouple_loss:0.03943963348865509
loss_pred:0.048441119492053986, decouple_loss:0.040045108646154404
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460660517215729, gen p mean: 0.0, mean p set: 0.44921332597732544
The modified gen p mean: 0.44843465089797974, gen p mean: 0.0, mean p set: 0.4500192403793335
The modified gen p mean: 0.44796863198280334, gen p mean: 0.0, mean p set: 0.4502916932106018
loss_pred:0.04890061542391777, decouple_loss:0.04030395299196243
loss_pred:0.04848052188754082, decouple_loss:0.039561573415994644
loss_pred:0.04962267354130745, decouple_loss:0.038695327937603
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450531303882599, gen p mean: 0.0, mean p set: 0.450695663690567
The modified gen p mean: 0.44972947239875793, gen p mean: 0.0, mean p set: 0.4496527314186096
The modified gen p mean: 0.44353795051574707, gen p mean: 0.0, mean p set: 0.44894298911094666
loss_pred:0.049078185111284256, decouple_loss:0.03913164883852005
loss_pred:0.04814963415265083, decouple_loss:0.03974996879696846
loss_pred:0.04583553224802017, decouple_loss:0.03917672485113144
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4646911323070526, gen p mean: 0.0, mean p set: 0.4501686692237854
The modified gen p mean: 0.4641111195087433, gen p mean: 0.0, mean p set: 0.4507887363433838
The modified gen p mean: 0.4631223976612091, gen p mean: 0.0, mean p set: 0.45330190658569336
loss_pred:0.0473984032869339, decouple_loss:0.03887230530381203
loss_pred:0.04660160467028618, decouple_loss:0.03877226263284683
loss_pred:0.04754257574677467, decouple_loss:0.03966500610113144
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4557300806045532, gen p mean: 0.0, mean p set: 0.4493838846683502
The modified gen p mean: 0.4640437960624695, gen p mean: 0.0, mean p set: 0.4497148096561432
The modified gen p mean: 0.4605746865272522, gen p mean: 0.0, mean p set: 0.45016786456108093
loss_pred:0.048817332834005356, decouple_loss:0.039019521325826645
loss_pred:0.048591047525405884, decouple_loss:0.03946417197585106
loss_pred:0.04933910444378853, decouple_loss:0.03883802145719528
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.424262672662735, gen p mean: 0.0, mean p set: 0.4499790072441101
The modified gen p mean: 0.42511141300201416, gen p mean: 0.0, mean p set: 0.45032599568367004
The modified gen p mean: 0.42255160212516785, gen p mean: 0.0, mean p set: 0.45219725370407104
loss_pred:0.04815565422177315, decouple_loss:0.03926747292280197
loss_pred:0.04642929136753082, decouple_loss:0.03896085545420647
loss_pred:0.04900289699435234, decouple_loss:0.040909238159656525
2023-05-02 16:57:10 testing...
The modified gen p mean: 0.44679686427116394, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4540170431137085, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4525008201599121, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.04885244369506836, decouple_loss:0.04141399264335632
loss_pred:0.0465497151017189, decouple_loss:0.041274990886449814
loss_pred:0.04765892028808594, decouple_loss:0.04015285521745682
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04973439499735832, avg_mse: 0.05047593265771866
current test mse: 0.050476
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45761364698410034, gen p mean: 0.0, mean p set: 0.45061424374580383
loss_pred:0.045900799334049225, decouple_loss:0.03954540193080902
The modified gen p mean: 0.4514613151550293, gen p mean: 0.0, mean p set: 0.4521060883998871
loss_pred:0.04733949527144432, decouple_loss:0.0413021445274353
The modified gen p mean: 0.4550274610519409, gen p mean: 0.0, mean p set: 0.4511836767196655
loss_pred:0.04963110014796257, decouple_loss:0.039892472326755524
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4688679575920105, gen p mean: 0.0, mean p set: 0.44982537627220154
The modified gen p mean: 0.46258744597435, gen p mean: 0.0, mean p set: 0.4531312584877014
The modified gen p mean: 0.4626065194606781, gen p mean: 0.0, mean p set: 0.4528343677520752
loss_pred:0.04778226092457771, decouple_loss:0.03980398178100586
loss_pred:0.04798070341348648, decouple_loss:0.04171563684940338
loss_pred:0.04916969686746597, decouple_loss:0.041404835879802704
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45184364914894104, gen p mean: 0.0, mean p set: 0.4531964957714081
The modified gen p mean: 0.45214664936065674, gen p mean: 0.0, mean p set: 0.45020267367362976
The modified gen p mean: 0.44947147369384766, gen p mean: 0.0, mean p set: 0.45406150817871094
loss_pred:0.04887661337852478, decouple_loss:0.04091942310333252
loss_pred:0.049025919288396835, decouple_loss:0.0389966145157814
loss_pred:0.04782268777489662, decouple_loss:0.040066611021757126
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43467625975608826, gen p mean: 0.0, mean p set: 0.4506070911884308
The modified gen p mean: 0.43668046593666077, gen p mean: 0.0, mean p set: 0.44924721121788025
The modified gen p mean: 0.43139028549194336, gen p mean: 0.0, mean p set: 0.4510722756385803
loss_pred:0.05034031346440315, decouple_loss:0.04012642800807953
loss_pred:0.04734675958752632, decouple_loss:0.03986337035894394
loss_pred:0.046279143542051315, decouple_loss:0.039687011390924454
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452869713306427, gen p mean: 0.0, mean p set: 0.4500143229961395
The modified gen p mean: 0.45015785098075867, gen p mean: 0.0, mean p set: 0.4505581855773926
The modified gen p mean: 0.4506921172142029, gen p mean: 0.0, mean p set: 0.45265257358551025
loss_pred:0.048112694174051285, decouple_loss:0.03937987610697746
loss_pred:0.046024732291698456, decouple_loss:0.03903205692768097
loss_pred:0.04739532992243767, decouple_loss:0.0406327024102211
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46766287088394165, gen p mean: 0.0, mean p set: 0.44966429471969604
The modified gen p mean: 0.4676183760166168, gen p mean: 0.0, mean p set: 0.4503326416015625
The modified gen p mean: 0.4634174108505249, gen p mean: 0.0, mean p set: 0.4520338773727417
loss_pred:0.04912884905934334, decouple_loss:0.039825405925512314
loss_pred:0.05007815733551979, decouple_loss:0.04001230001449585
loss_pred:0.04803453013300896, decouple_loss:0.040037136524915695
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499385356903076, gen p mean: 0.0, mean p set: 0.4477446675300598
The modified gen p mean: 0.4530768394470215, gen p mean: 0.0, mean p set: 0.4502440094947815
The modified gen p mean: 0.4540449380874634, gen p mean: 0.0, mean p set: 0.4534589648246765
loss_pred:0.045616984367370605, decouple_loss:0.039469026029109955
loss_pred:0.04875218868255615, decouple_loss:0.03919890895485878
loss_pred:0.04705076292157173, decouple_loss:0.04114653542637825
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4373517632484436, gen p mean: 0.0, mean p set: 0.45031604170799255
The modified gen p mean: 0.4326450526714325, gen p mean: 0.0, mean p set: 0.44903984665870667
The modified gen p mean: 0.43839022517204285, gen p mean: 0.0, mean p set: 0.45028528571128845
loss_pred:0.0475991889834404, decouple_loss:0.03951577842235565
loss_pred:0.04584231600165367, decouple_loss:0.039678361266851425
loss_pred:0.04716811701655388, decouple_loss:0.03963949903845787
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44211846590042114, gen p mean: 0.0, mean p set: 0.45275095105171204
The modified gen p mean: 0.4440387189388275, gen p mean: 0.0, mean p set: 0.4517904222011566
The modified gen p mean: 0.44105103611946106, gen p mean: 0.0, mean p set: 0.4526892900466919
loss_pred:0.049453556537628174, decouple_loss:0.04187261685729027
loss_pred:0.045941803604364395, decouple_loss:0.042950332164764404
loss_pred:0.04677554965019226, decouple_loss:0.040938783437013626
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46485209465026855, gen p mean: 0.0, mean p set: 0.45281070470809937
The modified gen p mean: 0.46381044387817383, gen p mean: 0.0, mean p set: 0.4521775543689728
The modified gen p mean: 0.4591611921787262, gen p mean: 0.0, mean p set: 0.4511641561985016
loss_pred:0.048888999968767166, decouple_loss:0.03910912200808525
loss_pred:0.04685025289654732, decouple_loss:0.04040969908237457
loss_pred:0.04556445777416229, decouple_loss:0.04187600314617157
2023-05-02 17:01:31 testing...
The modified gen p mean: 0.45398640632629395, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45973318815231323, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4608040153980255, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.04868195578455925, decouple_loss:0.04145519807934761
loss_pred:0.04731648042798042, decouple_loss:0.04005444049835205loss_pred:0.04633418098092079, decouple_loss:0.041704416275024414
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04949777573347092, avg_mse: 0.05021991953253746
current test mse: 0.05022
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45643872022628784, gen p mean: 0.0, mean p set: 0.4533170461654663
loss_pred:0.04543798789381981, decouple_loss:0.04054927080869675
The modified gen p mean: 0.4621311128139496, gen p mean: 0.0, mean p set: 0.45320072770118713
loss_pred:0.04524410888552666, decouple_loss:0.04103224352002144
The modified gen p mean: 0.4603519141674042, gen p mean: 0.0, mean p set: 0.451452374458313
loss_pred:0.04711113125085831, decouple_loss:0.04018586128950119
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452560245990753, gen p mean: 0.0, mean p set: 0.45439326763153076
The modified gen p mean: 0.4452207386493683, gen p mean: 0.0, mean p set: 0.4527444541454315
The modified gen p mean: 0.44637417793273926, gen p mean: 0.0, mean p set: 0.4512959122657776
loss_pred:0.045533809810876846, decouple_loss:0.04165951907634735
loss_pred:0.04649878293275833, decouple_loss:0.03964598849415779
loss_pred:0.04538583382964134, decouple_loss:0.04243333265185356
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487321078777313, gen p mean: 0.0, mean p set: 0.45319366455078125
The modified gen p mean: 0.4480830132961273, gen p mean: 0.0, mean p set: 0.4519002437591553
The modified gen p mean: 0.44670674204826355, gen p mean: 0.0, mean p set: 0.45395946502685547
loss_pred:0.044331714510917664, decouple_loss:0.04141125828027725
loss_pred:0.044951651245355606, decouple_loss:0.04136805608868599
loss_pred:0.045560404658317566, decouple_loss:0.03953074291348457
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4394042491912842, gen p mean: 0.0, mean p set: 0.4524921178817749The modified gen p mean: 0.43749427795410156, gen p mean: 0.0, mean p set: 0.4518548846244812
The modified gen p mean: 0.43752923607826233, gen p mean: 0.0, mean p set: 0.45180612802505493
loss_pred:0.046523839235305786, decouple_loss:0.04065330699086189loss_pred:0.04830213636159897, decouple_loss:0.04090484231710434
loss_pred:0.04915403202176094, decouple_loss:0.041121143847703934
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4770006835460663, gen p mean: 0.0, mean p set: 0.4528883397579193The modified gen p mean: 0.47731298208236694, gen p mean: 0.0, mean p set: 0.4531942903995514
The modified gen p mean: 0.4839502274990082, gen p mean: 0.0, mean p set: 0.45264923572540283
loss_pred:0.04691228270530701, decouple_loss:0.042073268443346024
loss_pred:0.04684613645076752, decouple_loss:0.04272890090942383
loss_pred:0.04710801690816879, decouple_loss:0.044017061591148376
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.428616464138031, gen p mean: 0.0, mean p set: 0.4515630006790161
The modified gen p mean: 0.44116267561912537, gen p mean: 0.0, mean p set: 0.4512292742729187
The modified gen p mean: 0.4347841739654541, gen p mean: 0.0, mean p set: 0.4516349136829376
loss_pred:0.04973933845758438, decouple_loss:0.04287092015147209
loss_pred:0.05067448690533638, decouple_loss:0.04245700314640999
loss_pred:0.04830446466803551, decouple_loss:0.0428864061832428
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458480477333069, gen p mean: 0.0, mean p set: 0.4535389542579651
The modified gen p mean: 0.4556519687175751, gen p mean: 0.0, mean p set: 0.4534226953983307
The modified gen p mean: 0.45221054553985596, gen p mean: 0.0, mean p set: 0.4518386423587799
loss_pred:0.04570469260215759, decouple_loss:0.04130057245492935
loss_pred:0.04527509957551956, decouple_loss:0.04171286150813103
loss_pred:0.048107679933309555, decouple_loss:0.04092531278729439
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45408934354782104, gen p mean: 0.0, mean p set: 0.4531993865966797
The modified gen p mean: 0.45527464151382446, gen p mean: 0.0, mean p set: 0.45152196288108826
The modified gen p mean: 0.45419082045555115, gen p mean: 0.0, mean p set: 0.4521760940551758
loss_pred:0.04485708847641945, decouple_loss:0.04025609418749809
loss_pred:0.04717278853058815, decouple_loss:0.040971241891384125
loss_pred:0.046463437378406525, decouple_loss:0.040079038590192795
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45117834210395813, gen p mean: 0.0, mean p set: 0.4533042907714844
The modified gen p mean: 0.44688642024993896, gen p mean: 0.0, mean p set: 0.45268580317497253
The modified gen p mean: 0.446946918964386, gen p mean: 0.0, mean p set: 0.4519941210746765
loss_pred:0.0445985272526741, decouple_loss:0.04021650180220604
loss_pred:0.04820450022816658, decouple_loss:0.03939242660999298
loss_pred:0.04717531055212021, decouple_loss:0.04024660959839821
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.463422566652298, gen p mean: 0.0, mean p set: 0.45269855856895447
The modified gen p mean: 0.46244707703590393, gen p mean: 0.0, mean p set: 0.45270848274230957
The modified gen p mean: 0.462234228849411, gen p mean: 0.0, mean p set: 0.4527256488800049
loss_pred:0.04532071575522423, decouple_loss:0.0406230166554451
loss_pred:0.04791044071316719, decouple_loss:0.04058034345507622
loss_pred:0.046118441969156265, decouple_loss:0.04057041183114052
2023-05-02 17:05:10 testing...
The modified gen p mean: 0.4543442726135254, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.46096670627593994, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4635274112224579, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.04855835437774658, decouple_loss:0.04198145493865013
loss_pred:0.0471658855676651, decouple_loss:0.041071902960538864
loss_pred:0.04632919654250145, decouple_loss:0.04284169524908066
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04944939538836479, avg_mse: 0.05013757571578026
current test mse: 0.050138
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4615173637866974, gen p mean: 0.0, mean p set: 0.4513503611087799
The modified gen p mean: 0.45565980672836304, gen p mean: 0.0, mean p set: 0.4525940418243408
loss_pred:0.0463850311934948, decouple_loss:0.03957195207476616
loss_pred:0.0455017015337944, decouple_loss:0.03963068500161171
The modified gen p mean: 0.46168261766433716, gen p mean: 0.0, mean p set: 0.45229020714759827
loss_pred:0.046788718551397324, decouple_loss:0.040471434593200684
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44569018483161926, gen p mean: 0.0, mean p set: 0.4516623318195343
The modified gen p mean: 0.444620281457901, gen p mean: 0.0, mean p set: 0.45318663120269775
The modified gen p mean: 0.44693344831466675, gen p mean: 0.0, mean p set: 0.4503368139266968
loss_pred:0.047248318791389465, decouple_loss:0.040021512657403946
loss_pred:0.044014886021614075, decouple_loss:0.03897760808467865
loss_pred:0.04709390923380852, decouple_loss:0.03944764658808708
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4379301369190216, gen p mean: 0.0, mean p set: 0.45324259996414185
The modified gen p mean: 0.43488308787345886, gen p mean: 0.0, mean p set: 0.4526309072971344
The modified gen p mean: 0.43575894832611084, gen p mean: 0.0, mean p set: 0.45446059107780457
loss_pred:0.042723238468170166, decouple_loss:0.03937135636806488
loss_pred:0.04574386775493622, decouple_loss:0.040109530091285706
loss_pred:0.04324058070778847, decouple_loss:0.04144737124443054
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4617276191711426, gen p mean: 0.0, mean p set: 0.45297735929489136
The modified gen p mean: 0.4572712779045105, gen p mean: 0.0, mean p set: 0.4513244330883026
The modified gen p mean: 0.45939961075782776, gen p mean: 0.0, mean p set: 0.4510186016559601
loss_pred:0.04687701538205147, decouple_loss:0.03898412361741066loss_pred:0.04260323941707611, decouple_loss:0.039015259593725204
loss_pred:0.04642723128199577, decouple_loss:0.03883596509695053
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4659144878387451, gen p mean: 0.0, mean p set: 0.45294755697250366
The modified gen p mean: 0.4657376706600189, gen p mean: 0.0, mean p set: 0.45146000385284424
The modified gen p mean: 0.47564971446990967, gen p mean: 0.0, mean p set: 0.4510493874549866
loss_pred:0.04477794095873833, decouple_loss:0.03984232619404793
loss_pred:0.04528548941016197, decouple_loss:0.04052628204226494
loss_pred:0.04852426052093506, decouple_loss:0.0398431159555912
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4429818093776703, gen p mean: 0.0, mean p set: 0.45182904601097107
The modified gen p mean: 0.4387456178665161, gen p mean: 0.0, mean p set: 0.4515043795108795
The modified gen p mean: 0.437423437833786, gen p mean: 0.0, mean p set: 0.4548146724700928
loss_pred:0.047689639031887054, decouple_loss:0.03878769278526306
loss_pred:0.046045079827308655, decouple_loss:0.038591574877500534
loss_pred:0.04426473006606102, decouple_loss:0.039625633507966995
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4420246481895447, gen p mean: 0.0, mean p set: 0.45130228996276855
The modified gen p mean: 0.44028863310813904, gen p mean: 0.0, mean p set: 0.4514450132846832
The modified gen p mean: 0.4369964599609375, gen p mean: 0.0, mean p set: 0.45096346735954285
loss_pred:0.04418478161096573, decouple_loss:0.04015374928712845
loss_pred:0.045943547040224075, decouple_loss:0.03836233168840408
loss_pred:0.04627838358283043, decouple_loss:0.0389595553278923
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46070143580436707, gen p mean: 0.0, mean p set: 0.44596222043037415
The modified gen p mean: 0.4603205621242523, gen p mean: 0.0, mean p set: 0.447105348110199
The modified gen p mean: 0.4616221785545349, gen p mean: 0.0, mean p set: 0.4457741975784302
loss_pred:0.04911766201257706, decouple_loss:0.04229968786239624
loss_pred:0.04783542454242706, decouple_loss:0.04508550092577934
loss_pred:0.047182776033878326, decouple_loss:0.045212939381599426
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4565689265727997, gen p mean: 0.0, mean p set: 0.447918564081192
The modified gen p mean: 0.45758137106895447, gen p mean: 0.0, mean p set: 0.44713470339775085
loss_pred:0.04739249870181084, decouple_loss:0.044665563851594925
The modified gen p mean: 0.456769734621048, gen p mean: 0.0, mean p set: 0.4472399353981018
loss_pred:0.0476730614900589, decouple_loss:0.04391692578792572
loss_pred:0.04727068543434143, decouple_loss:0.04258902370929718
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4298411011695862, gen p mean: 0.0, mean p set: 0.4470498263835907
The modified gen p mean: 0.43423447012901306, gen p mean: 0.0, mean p set: 0.4467202425003052
The modified gen p mean: 0.43684279918670654, gen p mean: 0.0, mean p set: 0.4465000033378601
loss_pred:0.046653036028146744, decouple_loss:0.04236871376633644
loss_pred:0.04603841155767441, decouple_loss:0.04278194531798363
loss_pred:0.046521883457899094, decouple_loss:0.0434727817773819
2023-05-02 17:09:31 testing...
The modified gen p mean: 0.44580286741256714, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4359934628009796, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44308146834373474, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.04520796984434128, decouple_loss:0.042663875967264175
loss_pred:0.047472622245550156, decouple_loss:0.04248224198818207
loss_pred:0.046168919652700424, decouple_loss:0.04123271629214287
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0483894869685173, avg_mse: 0.048711489886045456
current test mse: 0.048711
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44091323018074036, gen p mean: 0.0, mean p set: 0.44704657793045044
loss_pred:0.04588115215301514, decouple_loss:0.04299483448266983
The modified gen p mean: 0.43837717175483704, gen p mean: 0.0, mean p set: 0.4460800588130951
loss_pred:0.04617733135819435, decouple_loss:0.04393535852432251
The modified gen p mean: 0.44279155135154724, gen p mean: 0.0, mean p set: 0.4484235644340515
loss_pred:0.04482043907046318, decouple_loss:0.04303298890590668
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45537933707237244, gen p mean: 0.0, mean p set: 0.4471932351589203
The modified gen p mean: 0.45944544672966003, gen p mean: 0.0, mean p set: 0.4469307065010071
The modified gen p mean: 0.45920026302337646, gen p mean: 0.0, mean p set: 0.44799020886421204
loss_pred:0.048047080636024475, decouple_loss:0.04211283102631569
loss_pred:0.046430591493844986, decouple_loss:0.04236083850264549
loss_pred:0.0467839278280735, decouple_loss:0.04227997362613678
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532419443130493, gen p mean: 0.0, mean p set: 0.44751712679862976
The modified gen p mean: 0.4566725194454193, gen p mean: 0.0, mean p set: 0.4484979510307312
The modified gen p mean: 0.4531679153442383, gen p mean: 0.0, mean p set: 0.4463808834552765
loss_pred:0.04718120023608208, decouple_loss:0.04059045389294624
loss_pred:0.045956239104270935, decouple_loss:0.041968222707509995
loss_pred:0.04545584321022034, decouple_loss:0.040403444319963455
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4434117078781128, gen p mean: 0.0, mean p set: 0.44788745045661926
The modified gen p mean: 0.4411775767803192, gen p mean: 0.0, mean p set: 0.4473114311695099
The modified gen p mean: 0.44037267565727234, gen p mean: 0.0, mean p set: 0.44809842109680176
loss_pred:0.045665234327316284, decouple_loss:0.04064998775720596
loss_pred:0.04526903107762337, decouple_loss:0.03946898132562637
loss_pred:0.046904243528842926, decouple_loss:0.04169921949505806
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643634557724, gen p mean: 0.0, mean p set: 0.44671353697776794
The modified gen p mean: 0.4420606195926666, gen p mean: 0.0, mean p set: 0.4470173120498657
The modified gen p mean: 0.44516414403915405, gen p mean: 0.0, mean p set: 0.44888943433761597
loss_pred:0.04637782275676727, decouple_loss:0.040245942771434784
loss_pred:0.045876435935497284, decouple_loss:0.03986038640141487
loss_pred:0.04660973325371742, decouple_loss:0.040108732879161835
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45899447798728943, gen p mean: 0.0, mean p set: 0.44744786620140076
The modified gen p mean: 0.4553857445716858, gen p mean: 0.0, mean p set: 0.44655176997184753
The modified gen p mean: 0.4629593789577484, gen p mean: 0.0, mean p set: 0.4463140368461609
loss_pred:0.04623245447874069, decouple_loss:0.03985487297177315
loss_pred:0.04665505513548851, decouple_loss:0.039046481251716614
loss_pred:0.04597429931163788, decouple_loss:0.03977776691317558
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45797571539878845, gen p mean: 0.0, mean p set: 0.4469722807407379
The modified gen p mean: 0.4583185017108917, gen p mean: 0.0, mean p set: 0.44669607281684875
The modified gen p mean: 0.4565841555595398, gen p mean: 0.0, mean p set: 0.4471801817417145
loss_pred:0.045495737344026566, decouple_loss:0.03956037387251854
loss_pred:0.04422255977988243, decouple_loss:0.03951217979192734
loss_pred:0.047478411346673965, decouple_loss:0.040039706975221634
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4405321776866913, gen p mean: 0.0, mean p set: 0.448532372713089
The modified gen p mean: 0.43912070989608765, gen p mean: 0.0, mean p set: 0.44653645157814026
The modified gen p mean: 0.43870818614959717, gen p mean: 0.0, mean p set: 0.44813206791877747
loss_pred:0.04504740238189697, decouple_loss:0.03948158025741577
loss_pred:0.04513430967926979, decouple_loss:0.03946099057793617
loss_pred:0.04671940207481384, decouple_loss:0.039482053369283676
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43764588236808777, gen p mean: 0.0, mean p set: 0.4480991065502167
The modified gen p mean: 0.4397415816783905, gen p mean: 0.0, mean p set: 0.44640329480171204
The modified gen p mean: 0.43868932127952576, gen p mean: 0.0, mean p set: 0.44695183634757996
loss_pred:0.045146066695451736, decouple_loss:0.04000910371541977
loss_pred:0.04533253610134125, decouple_loss:0.04002006724476814
loss_pred:0.04609239101409912, decouple_loss:0.03986411541700363
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45252153277397156, gen p mean: 0.0, mean p set: 0.4482622444629669
The modified gen p mean: 0.4553758502006531, gen p mean: 0.0, mean p set: 0.4470142424106598
The modified gen p mean: 0.4503020942211151, gen p mean: 0.0, mean p set: 0.44643494486808777
loss_pred:0.0461290068924427, decouple_loss:0.03924163430929184
loss_pred:0.04423028603196144, decouple_loss:0.039984144270420074
loss_pred:0.04485152289271355, decouple_loss:0.04022917523980141
2023-05-02 17:13:12 testing...
The modified gen p mean: 0.45703238248825073, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4626818001270294, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4635877013206482, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.0467439703643322, decouple_loss:0.03976985812187195
loss_pred:0.04575442150235176, decouple_loss:0.038860585540533066
loss_pred:0.04440423473715782, decouple_loss:0.0398193784058094
WV_0_PC_0_EH_0_PS_40_6, loss: 0.047608375549316406, avg_mse: 0.04817362129688263
current test mse: 0.048174
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4556519389152527, gen p mean: 0.0, mean p set: 0.44631776213645935
The modified gen p mean: 0.4615718424320221, gen p mean: 0.0, mean p set: 0.44766902923583984
loss_pred:0.0454573780298233, decouple_loss:0.039604801684617996
loss_pred:0.045999571681022644, decouple_loss:0.04075534641742706
The modified gen p mean: 0.46233493089675903, gen p mean: 0.0, mean p set: 0.448323518037796
loss_pred:0.04543028026819229, decouple_loss:0.03901951014995575
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465923607349396, gen p mean: 0.0, mean p set: 0.4464031159877777
The modified gen p mean: 0.4455110728740692, gen p mean: 0.0, mean p set: 0.44737792015075684
The modified gen p mean: 0.44797417521476746, gen p mean: 0.0, mean p set: 0.4479850232601166
loss_pred:0.04570412635803223, decouple_loss:0.03782477229833603
loss_pred:0.04462827369570732, decouple_loss:0.03845192492008209
loss_pred:0.04614894837141037, decouple_loss:0.03839162737131119
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4401310682296753, gen p mean: 0.0, mean p set: 0.44787484407424927
The modified gen p mean: 0.4393848776817322, gen p mean: 0.0, mean p set: 0.44725537300109863
The modified gen p mean: 0.4393080174922943, gen p mean: 0.0, mean p set: 0.4469420909881592
loss_pred:0.04457388445734978, decouple_loss:0.03950386121869087
loss_pred:0.043247923254966736, decouple_loss:0.03843136131763458
loss_pred:0.046389397233724594, decouple_loss:0.03783115744590759
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4413435161113739, gen p mean: 0.0, mean p set: 0.4469846189022064
The modified gen p mean: 0.44240817427635193, gen p mean: 0.0, mean p set: 0.44775912165641785
The modified gen p mean: 0.4424304962158203, gen p mean: 0.0, mean p set: 0.44679760932922363
loss_pred:0.045850470662117004, decouple_loss:0.037725385278463364
loss_pred:0.0454782210290432, decouple_loss:0.03782498463988304
loss_pred:0.04462886601686478, decouple_loss:0.03803841397166252
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4549655318260193, gen p mean: 0.0, mean p set: 0.44807806611061096
The modified gen p mean: 0.4543181359767914, gen p mean: 0.0, mean p set: 0.4474559724330902
The modified gen p mean: 0.4560326635837555, gen p mean: 0.0, mean p set: 0.44702646136283875
loss_pred:0.044901829212903976, decouple_loss:0.03669363260269165
loss_pred:0.04441680759191513, decouple_loss:0.038734350353479385
loss_pred:0.04374449700117111, decouple_loss:0.038168858736753464
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4589838683605194, gen p mean: 0.0, mean p set: 0.44692856073379517
The modified gen p mean: 0.45906391739845276, gen p mean: 0.0, mean p set: 0.44667407870292664
The modified gen p mean: 0.4593493342399597, gen p mean: 0.0, mean p set: 0.4467087388038635
loss_pred:0.0433158203959465, decouple_loss:0.03747924417257309
loss_pred:0.04530607908964157, decouple_loss:0.0376153364777565
loss_pred:0.04590675234794617, decouple_loss:0.03833787515759468
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4422132968902588, gen p mean: 0.0, mean p set: 0.447732150554657
The modified gen p mean: 0.44209566712379456, gen p mean: 0.0, mean p set: 0.44851207733154297
The modified gen p mean: 0.4503653645515442, gen p mean: 0.0, mean p set: 0.44616246223449707
loss_pred:0.044957369565963745, decouple_loss:0.038496244698762894
loss_pred:0.04448850825428963, decouple_loss:0.0389007143676281
loss_pred:0.045684799551963806, decouple_loss:0.03760888800024986
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
NaN value num: 0
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647738337516785, gen p mean: 0.0, mean p set: 0.45207884907722473
The modified gen p mean: 0.4408453404903412, gen p mean: 0.0, mean p set: 0.4519042372703552
The modified gen p mean: 0.4395819902420044, gen p mean: 0.0, mean p set: 0.4499944746494293
loss_pred:0.04569585621356964, decouple_loss:0.04241213575005531
loss_pred:0.04673944413661957, decouple_loss:0.04027644544839859
loss_pred:0.04356725886464119, decouple_loss:0.04353976249694824
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468443691730499, gen p mean: 0.0, mean p set: 0.4498288631439209
The modified gen p mean: 0.4499991536140442, gen p mean: 0.0, mean p set: 0.45235124230384827
The modified gen p mean: 0.4468448758125305, gen p mean: 0.0, mean p set: 0.4522576630115509
loss_pred:0.04590095952153206, decouple_loss:0.041772861033678055
loss_pred:0.04566396400332451, decouple_loss:0.04218380153179169
loss_pred:0.044861044734716415, decouple_loss:0.04142902418971062
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.455848753452301, gen p mean: 0.0, mean p set: 0.4514666199684143
The modified gen p mean: 0.45560818910598755, gen p mean: 0.0, mean p set: 0.4505823850631714
The modified gen p mean: 0.4521391987800598, gen p mean: 0.0, mean p set: 0.44983968138694763
loss_pred:0.047652941197156906, decouple_loss:0.04250884801149368
loss_pred:0.045929763466119766, decouple_loss:0.04078558459877968
loss_pred:0.04308870807290077, decouple_loss:0.04193338379263878
2023-05-02 17:17:28 testing...
The modified gen p mean: 0.45073357224464417, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4459320604801178, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4531868100166321, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.0453697107732296, decouple_loss:0.03980695456266403
loss_pred:0.04671734571456909, decouple_loss:0.0406632125377655
loss_pred:0.044388700276613235, decouple_loss:0.04011731594800949
WV_0_PC_0_EH_0_PS_40_6, loss: 0.047501709312200546, avg_mse: 0.04820972681045532
current test mse: 0.04821
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522578716278076, gen p mean: 0.0, mean p set: 0.4487546980381012
The modified gen p mean: 0.46057364344596863, gen p mean: 0.0, mean p set: 0.45038190484046936
loss_pred:0.04440625384449959, decouple_loss:0.04244893416762352
loss_pred:0.04527826979756355, decouple_loss:0.04171614721417427
The modified gen p mean: 0.46244698762893677, gen p mean: 0.0, mean p set: 0.45145851373672485
loss_pred:0.045823272317647934, decouple_loss:0.04230567440390587
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43209657073020935, gen p mean: 0.0, mean p set: 0.4515382945537567
The modified gen p mean: 0.4361758828163147, gen p mean: 0.0, mean p set: 0.4509679973125458
The modified gen p mean: 0.42722970247268677, gen p mean: 0.0, mean p set: 0.4497178792953491
loss_pred:0.043342914432287216, decouple_loss:0.04332360625267029
loss_pred:0.046762049198150635, decouple_loss:0.04339970275759697
loss_pred:0.045808400958776474, decouple_loss:0.04225241765379906
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4639352858066559, gen p mean: 0.0, mean p set: 0.44927680492401123
The modified gen p mean: 0.46414098143577576, gen p mean: 0.0, mean p set: 0.4521912932395935
The modified gen p mean: 0.47070106863975525, gen p mean: 0.0, mean p set: 0.4517684876918793
loss_pred:0.047168053686618805, decouple_loss:0.041486840695142746
loss_pred:0.04610287398099899, decouple_loss:0.04194992408156395
loss_pred:0.04468666762113571, decouple_loss:0.04128046706318855
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46199166774749756, gen p mean: 0.0, mean p set: 0.45044994354248047
The modified gen p mean: 0.4649016857147217, gen p mean: 0.0, mean p set: 0.45203638076782227
The modified gen p mean: 0.4686878025531769, gen p mean: 0.0, mean p set: 0.45078280568122864
loss_pred:0.04249775409698486, decouple_loss:0.04116661846637726
loss_pred:0.04382162168622017, decouple_loss:0.040535807609558105
loss_pred:0.04566660523414612, decouple_loss:0.04068958759307861
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42797404527664185, gen p mean: 0.0, mean p set: 0.45147234201431274
The modified gen p mean: 0.4264739453792572, gen p mean: 0.0, mean p set: 0.4515971541404724
The modified gen p mean: 0.43231698870658875, gen p mean: 0.0, mean p set: 0.45119374990463257
loss_pred:0.0425233356654644, decouple_loss:0.040747981518507004
loss_pred:0.04468044638633728, decouple_loss:0.04248813912272453
loss_pred:0.04521862417459488, decouple_loss:0.04012962803244591
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4440988004207611, gen p mean: 0.0, mean p set: 0.45111262798309326
The modified gen p mean: 0.4458043575286865, gen p mean: 0.0, mean p set: 0.452114462852478
The modified gen p mean: 0.4425208270549774, gen p mean: 0.0, mean p set: 0.4523736536502838
loss_pred:0.04329759255051613, decouple_loss:0.03995499387383461
loss_pred:0.04327242448925972, decouple_loss:0.03819745033979416
loss_pred:0.04258507117629051, decouple_loss:0.0401003323495388
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4747001528739929, gen p mean: 0.0, mean p set: 0.45218411087989807
The modified gen p mean: 0.47475916147232056, gen p mean: 0.0, mean p set: 0.4513375163078308
The modified gen p mean: 0.4692506194114685, gen p mean: 0.0, mean p set: 0.4497377276420593
loss_pred:0.04426461085677147, decouple_loss:0.03916111961007118
loss_pred:0.04591522365808487, decouple_loss:0.04018918052315712
loss_pred:0.044298600405454636, decouple_loss:0.04101557284593582
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45279598236083984, gen p mean: 0.0, mean p set: 0.4519319236278534
The modified gen p mean: 0.4583006799221039, gen p mean: 0.0, mean p set: 0.45148730278015137
The modified gen p mean: 0.45682263374328613, gen p mean: 0.0, mean p set: 0.4518391489982605
loss_pred:0.04390672966837883, decouple_loss:0.038073405623435974
loss_pred:0.04488296061754227, decouple_loss:0.04006773978471756
loss_pred:0.042366720736026764, decouple_loss:0.038643475621938705
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4260287880897522, gen p mean: 0.0, mean p set: 0.45198163390159607
The modified gen p mean: 0.4280521273612976, gen p mean: 0.0, mean p set: 0.4521304666996002
The modified gen p mean: 0.4219261109828949, gen p mean: 0.0, mean p set: 0.449951171875
loss_pred:0.045700013637542725, decouple_loss:0.038516320288181305
loss_pred:0.04422532394528389, decouple_loss:0.038636885583400726
loss_pred:0.045456890016794205, decouple_loss:0.04206639155745506
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449890673160553, gen p mean: 0.0, mean p set: 0.45246466994285583
The modified gen p mean: 0.453500896692276, gen p mean: 0.0, mean p set: 0.45161959528923035
The modified gen p mean: 0.45093807578086853, gen p mean: 0.0, mean p set: 0.4521169364452362
loss_pred:0.042608000338077545, decouple_loss:0.03925293684005737
loss_pred:0.04382039234042168, decouple_loss:0.03906748443841934
loss_pred:0.041683975607156754, decouple_loss:0.03828204795718193
2023-05-02 17:21:07 testing...
The modified gen p mean: 0.461627721786499, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4544169008731842, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45963019132614136, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.04428434371948242, decouple_loss:0.04343462362885475
loss_pred:0.046582452952861786, decouple_loss:0.04375198483467102
loss_pred:0.04523686319589615, decouple_loss:0.04228152334690094
WV_0_PC_0_EH_0_PS_40_6, loss: 0.047525689005851746, avg_mse: 0.04804243892431259
current test mse: 0.048042
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46191293001174927, gen p mean: 0.0, mean p set: 0.44848471879959106
The modified gen p mean: 0.46599358320236206, gen p mean: 0.0, mean p set: 0.45091530680656433
loss_pred:0.04371071606874466, decouple_loss:0.04118172824382782
loss_pred:0.043416451662778854, decouple_loss:0.03808737173676491
The modified gen p mean: 0.46503645181655884, gen p mean: 0.0, mean p set: 0.4521903395652771
loss_pred:0.043859537690877914, decouple_loss:0.04033145308494568
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517313539981842, gen p mean: 0.0, mean p set: 0.45218491554260254
The modified gen p mean: 0.4488788843154907, gen p mean: 0.0, mean p set: 0.4520106315612793
The modified gen p mean: 0.45125025510787964, gen p mean: 0.0, mean p set: 0.4495699107646942
loss_pred:0.04337351396679878, decouple_loss:0.038756806403398514
loss_pred:0.042506005614995956, decouple_loss:0.038313813507556915
loss_pred:0.04490378499031067, decouple_loss:0.041230279952287674
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.440784752368927, gen p mean: 0.0, mean p set: 0.4504970610141754
The modified gen p mean: 0.43622246384620667, gen p mean: 0.0, mean p set: 0.4513408839702606
The modified gen p mean: 0.43735119700431824, gen p mean: 0.0, mean p set: 0.45184803009033203
loss_pred:0.045563388615846634, decouple_loss:0.03923988714814186
loss_pred:0.04246457293629646, decouple_loss:0.039515938609838486
loss_pred:0.04267357289791107, decouple_loss:0.040109727531671524
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536408483982086, gen p mean: 0.0, mean p set: 0.45165911316871643
The modified gen p mean: 0.4566018879413605, gen p mean: 0.0, mean p set: 0.44999441504478455
The modified gen p mean: 0.4537765681743622, gen p mean: 0.0, mean p set: 0.4504610598087311
loss_pred:0.044987570494413376, decouple_loss:0.03987554460763931
loss_pred:0.04599616676568985, decouple_loss:0.039870735257864
loss_pred:0.04505949839949608, decouple_loss:0.039153292775154114
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527243673801422, gen p mean: 0.0, mean p set: 0.44855502247810364
The modified gen p mean: 0.45847922563552856, gen p mean: 0.0, mean p set: 0.451455295085907
The modified gen p mean: 0.45291730761528015, gen p mean: 0.0, mean p set: 0.44847941398620605
loss_pred:0.04278646036982536, decouple_loss:0.039796944707632065
loss_pred:0.04454370215535164, decouple_loss:0.038203608244657516
loss_pred:0.042444195598363876, decouple_loss:0.03901471197605133
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454836368560791, gen p mean: 0.0, mean p set: 0.4495277404785156
The modified gen p mean: 0.4564230442047119, gen p mean: 0.0, mean p set: 0.45028162002563477
The modified gen p mean: 0.4512888491153717, gen p mean: 0.0, mean p set: 0.4491320550441742
loss_pred:0.04434216022491455, decouple_loss:0.03723243251442909
loss_pred:0.04393850639462471, decouple_loss:0.040124718099832535
loss_pred:0.043613772839307785, decouple_loss:0.03859582170844078
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498071074485779, gen p mean: 0.0, mean p set: 0.4527328312397003
The modified gen p mean: 0.447502076625824, gen p mean: 0.0, mean p set: 0.44944530725479126
The modified gen p mean: 0.4505912661552429, gen p mean: 0.0, mean p set: 0.4498084783554077
loss_pred:0.042300187051296234, decouple_loss:0.03862524405121803
loss_pred:0.043232280761003494, decouple_loss:0.038811761885881424
loss_pred:0.04424698278307915, decouple_loss:0.03808058425784111
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
NaN value num: 0
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678840041160583, gen p mean: 0.0, mean p set: 0.4492295980453491
The modified gen p mean: 0.44452986121177673, gen p mean: 0.0, mean p set: 0.44855889678001404
The modified gen p mean: 0.4371715188026428, gen p mean: 0.0, mean p set: 0.4527588486671448
loss_pred:0.04593341797590256, decouple_loss:0.03988061845302582
loss_pred:0.04534340649843216, decouple_loss:0.03958606719970703
loss_pred:0.044573839753866196, decouple_loss:0.0394134446978569
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4593150019645691, gen p mean: 0.0, mean p set: 0.4491817057132721
The modified gen p mean: 0.45819100737571716, gen p mean: 0.0, mean p set: 0.4496413469314575
The modified gen p mean: 0.4570463299751282, gen p mean: 0.0, mean p set: 0.45133325457572937
loss_pred:0.043415214866399765, decouple_loss:0.040120646357536316
loss_pred:0.046693675220012665, decouple_loss:0.04030657559633255
loss_pred:0.04632963240146637, decouple_loss:0.04061733931303024
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4623816907405853, gen p mean: 0.0, mean p set: 0.4518480598926544
The modified gen p mean: 0.4641372859477997, gen p mean: 0.0, mean p set: 0.45073726773262024
The modified gen p mean: 0.4650018513202667, gen p mean: 0.0, mean p set: 0.44921693205833435
loss_pred:0.044106561690568924, decouple_loss:0.04058017581701279
loss_pred:0.04540378600358963, decouple_loss:0.04041063413023949
loss_pred:0.0449352040886879, decouple_loss:0.03874817118048668
2023-05-02 17:25:27 testing...
The modified gen p mean: 0.43064647912979126, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4356502890586853, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.43669983744621277, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.046353552490472794, decouple_loss:0.04134932905435562
loss_pred:0.04492573067545891, decouple_loss:0.039702095091342926
loss_pred:0.04374286159873009, decouple_loss:0.040575359016656876
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04703449457883835, avg_mse: 0.047816742211580276
current test mse: 0.047817
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4401000440120697, gen p mean: 0.0, mean p set: 0.44805923104286194
The modified gen p mean: 0.43808647990226746, gen p mean: 0.0, mean p set: 0.45184415578842163
loss_pred:0.04555749148130417, decouple_loss:0.038468461483716965
loss_pred:0.04250645637512207, decouple_loss:0.04070712625980377
The modified gen p mean: 0.4359419345855713, gen p mean: 0.0, mean p set: 0.44773074984550476
loss_pred:0.044235941022634506, decouple_loss:0.03800749033689499
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4227246344089508, gen p mean: 0.0, mean p set: 0.4504449665546417
The modified gen p mean: 0.428814172744751, gen p mean: 0.0, mean p set: 0.4502002000808716
The modified gen p mean: 0.43078991770744324, gen p mean: 0.0, mean p set: 0.44869256019592285
loss_pred:0.045389264822006226, decouple_loss:0.03960664942860603
loss_pred:0.04451948404312134, decouple_loss:0.03988776355981827
loss_pred:0.04413451626896858, decouple_loss:0.03982502594590187
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.459464967250824, gen p mean: 0.0, mean p set: 0.44826605916023254
The modified gen p mean: 0.45650792121887207, gen p mean: 0.0, mean p set: 0.44803333282470703
The modified gen p mean: 0.4616200625896454, gen p mean: 0.0, mean p set: 0.45017069578170776
loss_pred:0.04546768218278885, decouple_loss:0.03975348547101021
loss_pred:0.04200137406587601, decouple_loss:0.04026807099580765
loss_pred:0.043879635632038116, decouple_loss:0.040025532245635986
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4682772755622864, gen p mean: 0.0, mean p set: 0.44909143447875977
The modified gen p mean: 0.46211010217666626, gen p mean: 0.0, mean p set: 0.4526605010032654
The modified gen p mean: 0.46458011865615845, gen p mean: 0.0, mean p set: 0.45025739073753357
loss_pred:0.04451468214392662, decouple_loss:0.04093111306428909
loss_pred:0.04401090368628502, decouple_loss:0.04157271236181259
loss_pred:0.047177232801914215, decouple_loss:0.04300694912672043
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4418778121471405, gen p mean: 0.0, mean p set: 0.45185160636901855
The modified gen p mean: 0.4442603290081024, gen p mean: 0.0, mean p set: 0.44991356134414673
The modified gen p mean: 0.4441460371017456, gen p mean: 0.0, mean p set: 0.45057329535484314
loss_pred:0.045552778989076614, decouple_loss:0.04060174152255058
loss_pred:0.04510773718357086, decouple_loss:0.04072341322898865
loss_pred:0.0468754805624485, decouple_loss:0.04047643393278122
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4569617807865143, gen p mean: 0.0, mean p set: 0.4504333436489105
The modified gen p mean: 0.45177438855171204, gen p mean: 0.0, mean p set: 0.45069968700408936
The modified gen p mean: 0.45198267698287964, gen p mean: 0.0, mean p set: 0.44775813817977905
loss_pred:0.04240550845861435, decouple_loss:0.03896583244204521
loss_pred:0.043496593832969666, decouple_loss:0.040462374687194824
loss_pred:0.041537750512361526, decouple_loss:0.03927246853709221
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4557630717754364, gen p mean: 0.0, mean p set: 0.44885390996932983
The modified gen p mean: 0.4514744281768799, gen p mean: 0.0, mean p set: 0.451536625623703
The modified gen p mean: 0.4549468755722046, gen p mean: 0.0, mean p set: 0.4503127932548523
loss_pred:0.04317430779337883, decouple_loss:0.04047642648220062
loss_pred:0.04435072839260101, decouple_loss:0.03970474749803543
loss_pred:0.04177188500761986, decouple_loss:0.03827020525932312
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4405621290206909, gen p mean: 0.0, mean p set: 0.44962644577026367
The modified gen p mean: 0.43352141976356506, gen p mean: 0.0, mean p set: 0.4500843286514282
The modified gen p mean: 0.435038685798645, gen p mean: 0.0, mean p set: 0.4506881833076477
loss_pred:0.04479982703924179, decouple_loss:0.03946603089570999
loss_pred:0.04542114958167076, decouple_loss:0.040228839963674545
loss_pred:0.04415930062532425, decouple_loss:0.03881033509969711
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971391558647156, gen p mean: 0.0, mean p set: 0.44977399706840515
The modified gen p mean: 0.4520719051361084, gen p mean: 0.0, mean p set: 0.44889137148857117
The modified gen p mean: 0.44600746035575867, gen p mean: 0.0, mean p set: 0.4500448405742645
loss_pred:0.04297346994280815, decouple_loss:0.039078645408153534
loss_pred:0.04447970911860466, decouple_loss:0.03890454024076462
loss_pred:0.044036589562892914, decouple_loss:0.04014423489570618
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4577227234840393, gen p mean: 0.0, mean p set: 0.4505856931209564
The modified gen p mean: 0.4641292989253998, gen p mean: 0.0, mean p set: 0.4505615830421448
The modified gen p mean: 0.4558573067188263, gen p mean: 0.0, mean p set: 0.4520305097103119
loss_pred:0.04315211996436119, decouple_loss:0.04158569872379303
loss_pred:0.04235434904694557, decouple_loss:0.038793545216321945
loss_pred:0.04240569844841957, decouple_loss:0.041141245514154434
2023-05-02 17:29:06 testing...
The modified gen p mean: 0.43804192543029785, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44352543354034424, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44590723514556885, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.045532386749982834, decouple_loss:0.04432700574398041
loss_pred:0.04411358758807182, decouple_loss:0.04206028953194618
loss_pred:0.043077800422906876, decouple_loss:0.043670471757650375
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04640888795256615, avg_mse: 0.046952079981565475
current test mse: 0.046952
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44381099939346313, gen p mean: 0.0, mean p set: 0.45047977566719055
loss_pred:0.04152693226933479, decouple_loss:0.03873339295387268
The modified gen p mean: 0.445284366607666, gen p mean: 0.0, mean p set: 0.4476604163646698
loss_pred:0.045414675027132034, decouple_loss:0.04128970578312874
The modified gen p mean: 0.449857234954834, gen p mean: 0.0, mean p set: 0.449136883020401
loss_pred:0.04408709704875946, decouple_loss:0.038445230573415756
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44435736536979675, gen p mean: 0.0, mean p set: 0.44961604475975037
The modified gen p mean: 0.447757363319397, gen p mean: 0.0, mean p set: 0.44883257150650024
The modified gen p mean: 0.44292140007019043, gen p mean: 0.0, mean p set: 0.44795873761177063
loss_pred:0.04281872510910034, decouple_loss:0.040173523128032684
loss_pred:0.04226887971162796, decouple_loss:0.040959883481264114
loss_pred:0.04463697224855423, decouple_loss:0.040216222405433655
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45430585741996765, gen p mean: 0.0, mean p set: 0.44976580142974854
The modified gen p mean: 0.4509047269821167, gen p mean: 0.0, mean p set: 0.4497537314891815
The modified gen p mean: 0.451987087726593, gen p mean: 0.0, mean p set: 0.4478166699409485
loss_pred:0.04310649260878563, decouple_loss:0.03977195546030998
loss_pred:0.04382299259305, decouple_loss:0.03996453806757927
loss_pred:0.044823113828897476, decouple_loss:0.03985665738582611
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512108862400055, gen p mean: 0.0, mean p set: 0.4486050307750702
The modified gen p mean: 0.4441898763179779, gen p mean: 0.0, mean p set: 0.45216912031173706
The modified gen p mean: 0.44794049859046936, gen p mean: 0.0, mean p set: 0.44778314232826233
loss_pred:0.044030725955963135, decouple_loss:0.037987567484378815
loss_pred:0.044775545597076416, decouple_loss:0.0393926203250885
loss_pred:0.04564841091632843, decouple_loss:0.03972230479121208
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665825366973877, gen p mean: 0.0, mean p set: 0.4508877694606781
The modified gen p mean: 0.4471575915813446, gen p mean: 0.0, mean p set: 0.45056405663490295
The modified gen p mean: 0.455877423286438, gen p mean: 0.0, mean p set: 0.45113611221313477
loss_pred:0.04418986663222313, decouple_loss:0.039981331676244736
loss_pred:0.04458075761795044, decouple_loss:0.03974144905805588
loss_pred:0.04520104452967644, decouple_loss:0.03953870013356209
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535486698150635, gen p mean: 0.0, mean p set: 0.45176324248313904
The modified gen p mean: 0.4598935544490814, gen p mean: 0.0, mean p set: 0.4483462870121002
The modified gen p mean: 0.4543599486351013, gen p mean: 0.0, mean p set: 0.45102187991142273
loss_pred:0.041897326707839966, decouple_loss:0.039204854518175125
loss_pred:0.042647141963243484, decouple_loss:0.03919980674982071
loss_pred:0.0418727844953537, decouple_loss:0.03961697965860367
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517959654331207, gen p mean: 0.0, mean p set: 0.4520123302936554
The modified gen p mean: 0.45626699924468994, gen p mean: 0.0, mean p set: 0.4480479061603546
The modified gen p mean: 0.4445592164993286, gen p mean: 0.0, mean p set: 0.4521084129810333
loss_pred:0.041510820388793945, decouple_loss:0.03758998587727547
loss_pred:0.043545689433813095, decouple_loss:0.038193877786397934
loss_pred:0.04240785166621208, decouple_loss:0.039260134100914
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
NaN value num: 0
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4442063271999359, gen p mean: 0.0, mean p set: 0.4474896788597107
The modified gen p mean: 0.4440073072910309, gen p mean: 0.0, mean p set: 0.4467763900756836
The modified gen p mean: 0.44275546073913574, gen p mean: 0.0, mean p set: 0.4468361735343933
loss_pred:0.04759306088089943, decouple_loss:0.04327308386564255
loss_pred:0.0454249307513237, decouple_loss:0.042814623564481735
loss_pred:0.04428562894463539, decouple_loss:0.041135191917419434
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4419999420642853, gen p mean: 0.0, mean p set: 0.4466082453727722
The modified gen p mean: 0.4475778341293335, gen p mean: 0.0, mean p set: 0.44724923372268677
The modified gen p mean: 0.44400471448898315, gen p mean: 0.0, mean p set: 0.44589856266975403
loss_pred:0.045835450291633606, decouple_loss:0.04139989987015724
loss_pred:0.04681537300348282, decouple_loss:0.040211454033851624
loss_pred:0.0461592823266983, decouple_loss:0.04183238372206688
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44546011090278625, gen p mean: 0.0, mean p set: 0.4483163356781006
The modified gen p mean: 0.44939306378364563, gen p mean: 0.0, mean p set: 0.44682827591896057
The modified gen p mean: 0.44887813925743103, gen p mean: 0.0, mean p set: 0.44864365458488464
loss_pred:0.04477396979928017, decouple_loss:0.04236146807670593
loss_pred:0.045098185539245605, decouple_loss:0.040721237659454346
loss_pred:0.0449678972363472, decouple_loss:0.04042178764939308
2023-05-02 17:33:22 testing...
The modified gen p mean: 0.4493739604949951, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44993072748184204, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4434276223182678, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.04410403594374657, decouple_loss:0.04007759690284729
loss_pred:0.04286796972155571, decouple_loss:0.04145367443561554
loss_pred:0.045313358306884766, decouple_loss:0.04178816080093384
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04615044593811035, avg_mse: 0.0466819629073143
current test mse: 0.046682
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455508887767792, gen p mean: 0.0, mean p set: 0.4479012191295624
The modified gen p mean: 0.44704747200012207, gen p mean: 0.0, mean p set: 0.4459850490093231
loss_pred:0.045476071536540985, decouple_loss:0.0416419580578804
loss_pred:0.044824741780757904, decouple_loss:0.042472243309020996
The modified gen p mean: 0.45163729786872864, gen p mean: 0.0, mean p set: 0.44732820987701416
loss_pred:0.04764176160097122, decouple_loss:0.04220454394817352
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46132275462150574, gen p mean: 0.0, mean p set: 0.4459342360496521
The modified gen p mean: 0.46397665143013, gen p mean: 0.0, mean p set: 0.4466065764427185
The modified gen p mean: 0.46513891220092773, gen p mean: 0.0, mean p set: 0.4463336765766144
loss_pred:0.04465552046895027, decouple_loss:0.03985406830906868
loss_pred:0.04521756246685982, decouple_loss:0.040034983307123184
loss_pred:0.04597857967019081, decouple_loss:0.04051733762025833
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43014591932296753, gen p mean: 0.0, mean p set: 0.4480588138103485
The modified gen p mean: 0.4332360327243805, gen p mean: 0.0, mean p set: 0.4471641182899475
The modified gen p mean: 0.43322470784187317, gen p mean: 0.0, mean p set: 0.4478325843811035
loss_pred:0.0452638640999794, decouple_loss:0.03942681476473808
loss_pred:0.04655378684401512, decouple_loss:0.03961276262998581
loss_pred:0.046534303575754166, decouple_loss:0.040642742067575455
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4380897879600525, gen p mean: 0.0, mean p set: 0.4476500451564789
The modified gen p mean: 0.4404897391796112, gen p mean: 0.0, mean p set: 0.44745099544525146
The modified gen p mean: 0.4345335066318512, gen p mean: 0.0, mean p set: 0.4494474530220032
loss_pred:0.04741111025214195, decouple_loss:0.03921714425086975
loss_pred:0.04751845821738243, decouple_loss:0.03876081481575966
loss_pred:0.04459857568144798, decouple_loss:0.04089568555355072
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46739593148231506, gen p mean: 0.0, mean p set: 0.44761335849761963
The modified gen p mean: 0.46152007579803467, gen p mean: 0.0, mean p set: 0.4457412362098694
The modified gen p mean: 0.46131449937820435, gen p mean: 0.0, mean p set: 0.4468995928764343
loss_pred:0.04759795591235161, decouple_loss:0.038120195269584656
loss_pred:0.04361242800951004, decouple_loss:0.039200570434331894
loss_pred:0.04465962573885918, decouple_loss:0.03955656290054321
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46403223276138306, gen p mean: 0.0, mean p set: 0.44789019227027893
The modified gen p mean: 0.4650481045246124, gen p mean: 0.0, mean p set: 0.44814398884773254
The modified gen p mean: 0.4636070132255554, gen p mean: 0.0, mean p set: 0.44620171189308167
loss_pred:0.04490428790450096, decouple_loss:0.03876468539237976
loss_pred:0.044166449457407, decouple_loss:0.04033658653497696
loss_pred:0.04650051146745682, decouple_loss:0.03855767473578453
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43531641364097595, gen p mean: 0.0, mean p set: 0.4482518434524536
The modified gen p mean: 0.4300491511821747, gen p mean: 0.0, mean p set: 0.44921690225601196
The modified gen p mean: 0.43575331568717957, gen p mean: 0.0, mean p set: 0.4463099241256714
loss_pred:0.045214470475912094, decouple_loss:0.03806646540760994
loss_pred:0.044217828661203384, decouple_loss:0.04009410738945007
loss_pred:0.045694075524806976, decouple_loss:0.038017116487026215
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43260228633880615, gen p mean: 0.0, mean p set: 0.44793352484703064
The modified gen p mean: 0.43569567799568176, gen p mean: 0.0, mean p set: 0.4484466016292572
The modified gen p mean: 0.43681296706199646, gen p mean: 0.0, mean p set: 0.44609498977661133
loss_pred:0.043258991092443466, decouple_loss:0.038302645087242126
loss_pred:0.04541511833667755, decouple_loss:0.037706319242715836
loss_pred:0.04369660094380379, decouple_loss:0.037555135786533356
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4574631154537201, gen p mean: 0.0, mean p set: 0.44756653904914856
The modified gen p mean: 0.45932143926620483, gen p mean: 0.0, mean p set: 0.4485847055912018
The modified gen p mean: 0.4589090943336487, gen p mean: 0.0, mean p set: 0.4476702809333801
loss_pred:0.042799558490514755, decouple_loss:0.03737490996718407
loss_pred:0.04402541369199753, decouple_loss:0.03799155727028847
loss_pred:0.04421916604042053, decouple_loss:0.038702793419361115
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45373737812042236, gen p mean: 0.0, mean p set: 0.4466424882411957
The modified gen p mean: 0.4557643234729767, gen p mean: 0.0, mean p set: 0.4470962882041931
The modified gen p mean: 0.45675891637802124, gen p mean: 0.0, mean p set: 0.44587424397468567
loss_pred:0.04440056532621384, decouple_loss:0.03734835982322693
loss_pred:0.047025587409734726, decouple_loss:0.03656156733632088
loss_pred:0.04507581517100334, decouple_loss:0.03823848441243172
2023-05-02 17:37:01 testing...
The modified gen p mean: 0.4422334134578705, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4490584433078766, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44795677065849304, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.04513293504714966, decouple_loss:0.03919156268239021
loss_pred:0.042759306728839874, decouple_loss:0.038228150457143784
loss_pred:0.04396397992968559, decouple_loss:0.03730809688568115
WV_0_PC_0_EH_0_PS_40_6, loss: 0.045864205807447433, avg_mse: 0.04681648313999176
current test mse: 0.046816
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44898584485054016, gen p mean: 0.0, mean p set: 0.4475829601287842
The modified gen p mean: 0.45075371861457825, gen p mean: 0.0, mean p set: 0.4474199414253235
loss_pred:0.042464032769203186, decouple_loss:0.037891797721385956
loss_pred:0.046252332627773285, decouple_loss:0.03821087256073952
The modified gen p mean: 0.445227712392807, gen p mean: 0.0, mean p set: 0.44805923104286194
loss_pred:0.04421621188521385, decouple_loss:0.03785837069153786
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43659764528274536, gen p mean: 0.0, mean p set: 0.4479162395000458
The modified gen p mean: 0.44080206751823425, gen p mean: 0.0, mean p set: 0.4465598464012146
The modified gen p mean: 0.4402417540550232, gen p mean: 0.0, mean p set: 0.44859373569488525
loss_pred:0.044143177568912506, decouple_loss:0.03797248750925064
loss_pred:0.04490764066576958, decouple_loss:0.03727567940950394
loss_pred:0.044156670570373535, decouple_loss:0.03725700080394745
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44268807768821716, gen p mean: 0.0, mean p set: 0.4484492540359497
The modified gen p mean: 0.4421435594558716, gen p mean: 0.0, mean p set: 0.44635969400405884
The modified gen p mean: 0.4426409602165222, gen p mean: 0.0, mean p set: 0.4483919143676758
loss_pred:0.043630897998809814, decouple_loss:0.037321463227272034
loss_pred:0.04429775848984718, decouple_loss:0.03733428940176964
loss_pred:0.04270360618829727, decouple_loss:0.03845605626702309
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514124095439911, gen p mean: 0.0, mean p set: 0.4458599388599396
The modified gen p mean: 0.4504518210887909, gen p mean: 0.0, mean p set: 0.44818219542503357
The modified gen p mean: 0.4508418142795563, gen p mean: 0.0, mean p set: 0.44673120975494385
loss_pred:0.042652297765016556, decouple_loss:0.037423163652420044
loss_pred:0.04412808269262314, decouple_loss:0.03756069019436836
loss_pred:0.0442994125187397, decouple_loss:0.03703441098332405
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45423054695129395, gen p mean: 0.0, mean p set: 0.4485665559768677
The modified gen p mean: 0.45590877532958984, gen p mean: 0.0, mean p set: 0.44691455364227295
The modified gen p mean: 0.45572325587272644, gen p mean: 0.0, mean p set: 0.4483541250228882
loss_pred:0.04408200457692146, decouple_loss:0.0363038033246994
loss_pred:0.04272222891449928, decouple_loss:0.0360165610909462
loss_pred:0.04342111945152283, decouple_loss:0.03803170472383499
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44080060720443726, gen p mean: 0.0, mean p set: 0.44731420278549194
The modified gen p mean: 0.4457260072231293, gen p mean: 0.0, mean p set: 0.44733667373657227
The modified gen p mean: 0.44024863839149475, gen p mean: 0.0, mean p set: 0.44704747200012207
loss_pred:0.04326772689819336, decouple_loss:0.037589531391859055
loss_pred:0.046562086790800095, decouple_loss:0.036004167050123215
loss_pred:0.04350362718105316, decouple_loss:0.03672775626182556
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531403183937073, gen p mean: 0.0, mean p set: 0.4483678936958313
The modified gen p mean: 0.4525358974933624, gen p mean: 0.0, mean p set: 0.44832971692085266
The modified gen p mean: 0.45595958828926086, gen p mean: 0.0, mean p set: 0.4471109211444855
loss_pred:0.04299435392022133, decouple_loss:0.037799399346113205
loss_pred:0.04442125931382179, decouple_loss:0.0381837859749794
loss_pred:0.045317914336919785, decouple_loss:0.039279449731111526
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.444029837846756, gen p mean: 0.0, mean p set: 0.4475880563259125
The modified gen p mean: 0.4422152638435364, gen p mean: 0.0, mean p set: 0.4489997327327728
The modified gen p mean: 0.44135820865631104, gen p mean: 0.0, mean p set: 0.44918495416641235
loss_pred:0.041417643427848816, decouple_loss:0.037697359919548035
loss_pred:0.04162546247243881, decouple_loss:0.03754761815071106
loss_pred:0.041544001549482346, decouple_loss:0.037908460944890976
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43150052428245544, gen p mean: 0.0, mean p set: 0.4490683674812317
The modified gen p mean: 0.43279576301574707, gen p mean: 0.0, mean p set: 0.4480845034122467
The modified gen p mean: 0.4306633472442627, gen p mean: 0.0, mean p set: 0.4478755593299866
loss_pred:0.04248936474323273, decouple_loss:0.037924714386463165
loss_pred:0.04452316090464592, decouple_loss:0.037665724754333496
loss_pred:0.04121808335185051, decouple_loss:0.03725901246070862
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4739514887332916, gen p mean: 0.0, mean p set: 0.44762876629829407
The modified gen p mean: 0.4692910313606262, gen p mean: 0.0, mean p set: 0.44908908009529114
The modified gen p mean: 0.47422513365745544, gen p mean: 0.0, mean p set: 0.4488926827907562
loss_pred:0.04519940912723541, decouple_loss:0.03728441894054413
loss_pred:0.04394278675317764, decouple_loss:0.03767690062522888
loss_pred:0.04334685951471329, decouple_loss:0.03798322379589081
2023-05-02 17:41:32 testing...
The modified gen p mean: 0.45615875720977783, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4612043797969818, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.46241870522499084, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.04438755288720131, decouple_loss:0.037640832364559174
loss_pred:0.043280791491270065, decouple_loss:0.03680490329861641
loss_pred:0.04236353561282158, decouple_loss:0.03726056590676308
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0452057346701622, avg_mse: 0.04607100784778595
current test mse: 0.046071
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4604165256023407, gen p mean: 0.0, mean p set: 0.44798803329467773
The modified gen p mean: 0.4573877155780792, gen p mean: 0.0, mean p set: 0.4496730864048004
loss_pred:0.04078026860952377, decouple_loss:0.036003559827804565
loss_pred:0.04278383404016495, decouple_loss:0.03763864189386368
The modified gen p mean: 0.46029606461524963, gen p mean: 0.0, mean p set: 0.4488913416862488
loss_pred:0.043253105133771896, decouple_loss:0.03646598756313324
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4261833727359772, gen p mean: 0.0, mean p set: 0.44860783219337463
The modified gen p mean: 0.4333677291870117, gen p mean: 0.0, mean p set: 0.4486456513404846
The modified gen p mean: 0.4328489303588867, gen p mean: 0.0, mean p set: 0.4487335979938507
loss_pred:0.04136760160326958, decouple_loss:0.03656302019953728
loss_pred:0.04403677582740784, decouple_loss:0.03885755315423012
loss_pred:0.04214530810713768, decouple_loss:0.03737592697143555
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949349761009216, gen p mean: 0.0, mean p set: 0.44876912236213684
The modified gen p mean: 0.4434095323085785, gen p mean: 0.0, mean p set: 0.4478580951690674
The modified gen p mean: 0.44826391339302063, gen p mean: 0.0, mean p set: 0.44872695207595825
loss_pred:0.04353441670536995, decouple_loss:0.03604907914996147
loss_pred:0.04219011962413788, decouple_loss:0.03728654608130455
loss_pred:0.04280225932598114, decouple_loss:0.03690416365861893
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4608873724937439, gen p mean: 0.0, mean p set: 0.44820985198020935
The modified gen p mean: 0.45982590317726135, gen p mean: 0.0, mean p set: 0.44857507944107056
The modified gen p mean: 0.45946088433265686, gen p mean: 0.0, mean p set: 0.4499906599521637
loss_pred:0.04281250759959221, decouple_loss:0.03617822378873825
loss_pred:0.04002310335636139, decouple_loss:0.03632950037717819
loss_pred:0.042356815189123154, decouple_loss:0.03515520691871643
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462504982948303, gen p mean: 0.0, mean p set: 0.44895321130752563
The modified gen p mean: 0.4485854208469391, gen p mean: 0.0, mean p set: 0.4490887224674225
The modified gen p mean: 0.4494348466396332, gen p mean: 0.0, mean p set: 0.44880983233451843
loss_pred:0.04049990326166153, decouple_loss:0.03596979379653931
loss_pred:0.04144611209630966, decouple_loss:0.03712340071797371
loss_pred:0.04375869780778885, decouple_loss:0.03566088527441025
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4397110044956207, gen p mean: 0.0, mean p set: 0.4477599561214447
The modified gen p mean: 0.44073647260665894, gen p mean: 0.0, mean p set: 0.4485322833061218
The modified gen p mean: 0.4453474283218384, gen p mean: 0.0, mean p set: 0.4476771950721741
loss_pred:0.040338777005672455, decouple_loss:0.03564981743693352
loss_pred:0.04037649184465408, decouple_loss:0.0350162647664547
loss_pred:0.044394031167030334, decouple_loss:0.03524044156074524
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45727068185806274, gen p mean: 0.0, mean p set: 0.4480244815349579
The modified gen p mean: 0.45412442088127136, gen p mean: 0.0, mean p set: 0.4499371349811554
The modified gen p mean: 0.45864421129226685, gen p mean: 0.0, mean p set: 0.44785773754119873
loss_pred:0.04095958545804024, decouple_loss:0.034243013709783554
loss_pred:0.041461627930402756, decouple_loss:0.037341319024562836
loss_pred:0.041719648987054825, decouple_loss:0.03557683527469635
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498148262500763, gen p mean: 0.0, mean p set: 0.4481090009212494
The modified gen p mean: 0.4523061215877533, gen p mean: 0.0, mean p set: 0.447688490152359
The modified gen p mean: 0.45196932554244995, gen p mean: 0.0, mean p set: 0.45043665170669556
loss_pred:0.0415840670466423, decouple_loss:0.03546788915991783
loss_pred:0.041627418249845505, decouple_loss:0.03535054996609688
loss_pred:0.04248490557074547, decouple_loss:0.03600740060210228
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44040897488594055, gen p mean: 0.0, mean p set: 0.4478192627429962
The modified gen p mean: 0.44021913409233093, gen p mean: 0.0, mean p set: 0.44832760095596313
The modified gen p mean: 0.4390670359134674, gen p mean: 0.0, mean p set: 0.44869568943977356
loss_pred:0.0398997887969017, decouple_loss:0.034462105482816696
loss_pred:0.04182941094040871, decouple_loss:0.036090876907110214
loss_pred:0.042318567633628845, decouple_loss:0.03588147088885307
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4410373270511627, gen p mean: 0.0, mean p set: 0.44758591055870056
The modified gen p mean: 0.4443558156490326, gen p mean: 0.0, mean p set: 0.44833654165267944
The modified gen p mean: 0.44652438163757324, gen p mean: 0.0, mean p set: 0.4491422176361084
loss_pred:0.04038079082965851, decouple_loss:0.03517652302980423
loss_pred:0.04194389656186104, decouple_loss:0.035480305552482605
loss_pred:0.043092332780361176, decouple_loss:0.03588196635246277
2023-05-02 17:45:14 testing...
The modified gen p mean: 0.4533241093158722, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.461681991815567, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.45957130193710327, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.04372255876660347, decouple_loss:0.03630433604121208
loss_pred:0.04169836267828941, decouple_loss:0.036003850400447845
loss_pred:0.04259732738137245, decouple_loss:0.03547970578074455
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04446921870112419, avg_mse: 0.04538339748978615
current test mse: 0.045383
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4663591980934143, gen p mean: 0.0, mean p set: 0.4488394856452942
The modified gen p mean: 0.45896783471107483, gen p mean: 0.0, mean p set: 0.4485079050064087
loss_pred:0.0414125882089138, decouple_loss:0.03646440804004669
loss_pred:0.0418114960193634, decouple_loss:0.03583068773150444
The modified gen p mean: 0.4573782682418823, gen p mean: 0.0, mean p set: 0.44861847162246704
loss_pred:0.04009927809238434, decouple_loss:0.034564416855573654
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501539170742035, gen p mean: 0.0, mean p set: 0.44789284467697144
The modified gen p mean: 0.45244288444519043, gen p mean: 0.0, mean p set: 0.44922152161598206
The modified gen p mean: 0.45128005743026733, gen p mean: 0.0, mean p set: 0.4484177529811859
loss_pred:0.04197884723544121, decouple_loss:0.03536207228899002
loss_pred:0.042992718517780304, decouple_loss:0.033805277198553085
loss_pred:0.04390743747353554, decouple_loss:0.03513894975185394
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45165741443634033, gen p mean: 0.0, mean p set: 0.448894202709198
The modified gen p mean: 0.44967183470726013, gen p mean: 0.0, mean p set: 0.44892382621765137
The modified gen p mean: 0.45039990544319153, gen p mean: 0.0, mean p set: 0.4496676027774811
loss_pred:0.04249649867415428, decouple_loss:0.033904947340488434
loss_pred:0.04186509922146797, decouple_loss:0.03460913151502609
loss_pred:0.042518239468336105, decouple_loss:0.034181226044893265
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4406411945819855, gen p mean: 0.0, mean p set: 0.4487592875957489
The modified gen p mean: 0.4426848292350769, gen p mean: 0.0, mean p set: 0.44871145486831665
The modified gen p mean: 0.4425398111343384, gen p mean: 0.0, mean p set: 0.44799840450286865
loss_pred:0.042919088155031204, decouple_loss:0.03415556624531746
loss_pred:0.042770277708768845, decouple_loss:0.03357745334506035
loss_pred:0.04213549196720123, decouple_loss:0.033764444291591644
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4380251169204712, gen p mean: 0.0, mean p set: 0.4501863420009613
The modified gen p mean: 0.44262412190437317, gen p mean: 0.0, mean p set: 0.44825538992881775
The modified gen p mean: 0.4405022859573364, gen p mean: 0.0, mean p set: 0.44852176308631897
loss_pred:0.04151025786995888, decouple_loss:0.035754065960645676
loss_pred:0.040960535407066345, decouple_loss:0.034038472920656204
loss_pred:0.0415203720331192, decouple_loss:0.033477719873189926
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46456634998321533, gen p mean: 0.0, mean p set: 0.44804567098617554
The modified gen p mean: 0.4614017605781555, gen p mean: 0.0, mean p set: 0.44816285371780396
The modified gen p mean: 0.4568052291870117, gen p mean: 0.0, mean p set: 0.4508599638938904
loss_pred:0.04134117811918259, decouple_loss:0.03415079414844513
loss_pred:0.040017019957304, decouple_loss:0.034153833985328674
loss_pred:0.040975842624902725, decouple_loss:0.03654567897319794
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45459845662117004, gen p mean: 0.0, mean p set: 0.4483044445514679
The modified gen p mean: 0.4604829251766205, gen p mean: 0.0, mean p set: 0.4482552707195282
The modified gen p mean: 0.45298871397972107, gen p mean: 0.0, mean p set: 0.44819530844688416
loss_pred:0.042291004210710526, decouple_loss:0.03486931324005127
loss_pred:0.04276459664106369, decouple_loss:0.035483136773109436
loss_pred:0.04194291681051254, decouple_loss:0.033881861716508865
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
NaN value num: 0
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4359859824180603, gen p mean: 0.0, mean p set: 0.4529838562011719
The modified gen p mean: 0.44019025564193726, gen p mean: 0.0, mean p set: 0.4521334171295166
The modified gen p mean: 0.4394371509552002, gen p mean: 0.0, mean p set: 0.45280906558036804
loss_pred:0.04439224302768707, decouple_loss:0.040854595601558685
loss_pred:0.04373300448060036, decouple_loss:0.03999008610844612
loss_pred:0.044378653168678284, decouple_loss:0.04028080031275749
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45637133717536926, gen p mean: 0.0, mean p set: 0.45252567529678345
The modified gen p mean: 0.4585164785385132, gen p mean: 0.0, mean p set: 0.4529213011264801
The modified gen p mean: 0.453025758266449, gen p mean: 0.0, mean p set: 0.45248281955718994
loss_pred:0.04247817024588585, decouple_loss:0.03965137526392937
loss_pred:0.04326244071125984, decouple_loss:0.03928326070308685
loss_pred:0.04420405253767967, decouple_loss:0.03884328156709671
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169565081596375, gen p mean: 0.0, mean p set: 0.45463061332702637
The modified gen p mean: 0.44843152165412903, gen p mean: 0.0, mean p set: 0.45204824209213257
The modified gen p mean: 0.450102835893631, gen p mean: 0.0, mean p set: 0.45275866985321045
loss_pred:0.04271887615323067, decouple_loss:0.039731983095407486
loss_pred:0.04178282991051674, decouple_loss:0.03963169455528259
loss_pred:0.043296992778778076, decouple_loss:0.040244851261377335
2023-05-02 17:49:35 testing...
The modified gen p mean: 0.45158010721206665, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4452747106552124, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4540605843067169, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.04271942377090454, decouple_loss:0.03609728813171387
loss_pred:0.04369684308767319, decouple_loss:0.03757014498114586
loss_pred:0.04185715317726135, decouple_loss:0.037491846829652786
WV_0_PC_0_EH_0_PS_40_6, loss: 0.044610463082790375, avg_mse: 0.04557604342699051
current test mse: 0.045576
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495534300804138, gen p mean: 0.0, mean p set: 0.4538889527320862
The modified gen p mean: 0.4509892165660858, gen p mean: 0.0, mean p set: 0.45221248269081116
loss_pred:0.04153415560722351, decouple_loss:0.03909457102417946
loss_pred:0.04158611595630646, decouple_loss:0.04008015617728233
The modified gen p mean: 0.448672354221344, gen p mean: 0.0, mean p set: 0.4522179961204529
loss_pred:0.04499838873744011, decouple_loss:0.03895975276827812
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45911145210266113, gen p mean: 0.0, mean p set: 0.4523204565048218
The modified gen p mean: 0.46069982647895813, gen p mean: 0.0, mean p set: 0.45232388377189636
The modified gen p mean: 0.45631104707717896, gen p mean: 0.0, mean p set: 0.4520886242389679
loss_pred:0.04231887683272362, decouple_loss:0.038132041692733765
loss_pred:0.042469322681427, decouple_loss:0.03781793266534805
loss_pred:0.044627927243709564, decouple_loss:0.03858781233429909
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454382985830307, gen p mean: 0.0, mean p set: 0.45288369059562683
The modified gen p mean: 0.46573328971862793, gen p mean: 0.0, mean p set: 0.4514249265193939
The modified gen p mean: 0.4568203389644623, gen p mean: 0.0, mean p set: 0.45176082849502563
loss_pred:0.04321105405688286, decouple_loss:0.038542959839105606
loss_pred:0.04227891191840172, decouple_loss:0.0381358340382576
loss_pred:0.04216628149151802, decouple_loss:0.038632385432720184
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825732707977295, gen p mean: 0.0, mean p set: 0.45203545689582825
The modified gen p mean: 0.4435247778892517, gen p mean: 0.0, mean p set: 0.45403069257736206
The modified gen p mean: 0.447092741727829, gen p mean: 0.0, mean p set: 0.45330876111984253
loss_pred:0.04390513524413109, decouple_loss:0.036887891590595245
loss_pred:0.04247617721557617, decouple_loss:0.03813139349222183
loss_pred:0.04157264158129692, decouple_loss:0.037474360316991806
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4446312487125397, gen p mean: 0.0, mean p set: 0.45145612955093384
The modified gen p mean: 0.44547271728515625, gen p mean: 0.0, mean p set: 0.4515085816383362
The modified gen p mean: 0.4415668249130249, gen p mean: 0.0, mean p set: 0.4523581564426422
loss_pred:0.04271530732512474, decouple_loss:0.03635033592581749
loss_pred:0.04235188290476799, decouple_loss:0.03627945855259895
loss_pred:0.04188377037644386, decouple_loss:0.03756658732891083
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46025320887565613, gen p mean: 0.0, mean p set: 0.4519991874694824
The modified gen p mean: 0.4538722038269043, gen p mean: 0.0, mean p set: 0.4518720209598541
The modified gen p mean: 0.4531078636646271, gen p mean: 0.0, mean p set: 0.45209699869155884
loss_pred:0.04164509475231171, decouple_loss:0.038273852318525314
loss_pred:0.04455343633890152, decouple_loss:0.0370502732694149
loss_pred:0.044337186962366104, decouple_loss:0.03764398396015167
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528711140155792, gen p mean: 0.0, mean p set: 0.4515518248081207
The modified gen p mean: 0.4499005675315857, gen p mean: 0.0, mean p set: 0.4518350064754486
The modified gen p mean: 0.44922447204589844, gen p mean: 0.0, mean p set: 0.45283377170562744
loss_pred:0.04132521525025368, decouple_loss:0.037315767258405685
loss_pred:0.04247031360864639, decouple_loss:0.03678542375564575
loss_pred:0.04236230254173279, decouple_loss:0.03688843920826912
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4604567289352417, gen p mean: 0.0, mean p set: 0.4523428976535797
The modified gen p mean: 0.45378589630126953, gen p mean: 0.0, mean p set: 0.4522091746330261
The modified gen p mean: 0.4542895555496216, gen p mean: 0.0, mean p set: 0.4536357522010803
loss_pred:0.04253772646188736, decouple_loss:0.03630431368947029
loss_pred:0.04436495527625084, decouple_loss:0.03804491460323334
loss_pred:0.04232153668999672, decouple_loss:0.03690188378095627
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957244396209717, gen p mean: 0.0, mean p set: 0.4528285562992096
The modified gen p mean: 0.4460054337978363, gen p mean: 0.0, mean p set: 0.45085132122039795
The modified gen p mean: 0.45147204399108887, gen p mean: 0.0, mean p set: 0.45185646414756775
loss_pred:0.042512938380241394, decouple_loss:0.03639407083392143
loss_pred:0.04317319020628929, decouple_loss:0.03630152344703674
loss_pred:0.04225003346800804, decouple_loss:0.03575707972049713
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4388098120689392, gen p mean: 0.0, mean p set: 0.45207729935646057
The modified gen p mean: 0.437690794467926, gen p mean: 0.0, mean p set: 0.45439544320106506
The modified gen p mean: 0.4397018253803253, gen p mean: 0.0, mean p set: 0.45404139161109924
loss_pred:0.04291139543056488, decouple_loss:0.03571375086903572
loss_pred:0.041149985045194626, decouple_loss:0.036648228764534
loss_pred:0.042605724185705185, decouple_loss:0.0370466522872448
2023-05-02 17:53:16 testing...
The modified gen p mean: 0.4529496431350708, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4610941708087921, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4586602747440338, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.043825916945934296, decouple_loss:0.039419032633304596
loss_pred:0.04200458154082298, decouple_loss:0.039595287293195724
loss_pred:0.042780552059412, decouple_loss:0.03763744980096817
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04481454938650131, avg_mse: 0.04592246934771538
current test mse: 0.045922
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45659756660461426, gen p mean: 0.0, mean p set: 0.4530635178089142
The modified gen p mean: 0.4587453305721283, gen p mean: 0.0, mean p set: 0.45229360461235046
loss_pred:0.041497405618429184, decouple_loss:0.03667512163519859
loss_pred:0.040690794587135315, decouple_loss:0.03638926148414612
The modified gen p mean: 0.454176127910614, gen p mean: 0.0, mean p set: 0.4528692364692688
loss_pred:0.04257257655262947, decouple_loss:0.035871442407369614
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46831488609313965, gen p mean: 0.0, mean p set: 0.45403948426246643
The modified gen p mean: 0.4669695794582367, gen p mean: 0.0, mean p set: 0.45017948746681213
The modified gen p mean: 0.46808624267578125, gen p mean: 0.0, mean p set: 0.45435523986816406
loss_pred:0.04175512120127678, decouple_loss:0.037524156272411346
loss_pred:0.04238264635205269, decouple_loss:0.03804859146475792
loss_pred:0.043141286820173264, decouple_loss:0.0367760993540287
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866251945495605, gen p mean: 0.0, mean p set: 0.4525543749332428
The modified gen p mean: 0.44512659311294556, gen p mean: 0.0, mean p set: 0.4534013867378235
The modified gen p mean: 0.4477015733718872, gen p mean: 0.0, mean p set: 0.45264187455177307
loss_pred:0.042812529951334, decouple_loss:0.03509088233113289
loss_pred:0.041293833404779434, decouple_loss:0.03625490143895149
loss_pred:0.0409570187330246, decouple_loss:0.035839539021253586
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4335651695728302, gen p mean: 0.0, mean p set: 0.4520726501941681
The modified gen p mean: 0.4324403405189514, gen p mean: 0.0, mean p set: 0.45073869824409485
The modified gen p mean: 0.4397086799144745, gen p mean: 0.0, mean p set: 0.45217597484588623
loss_pred:0.04286005347967148, decouple_loss:0.03682427853345871
loss_pred:0.04140971228480339, decouple_loss:0.03712005168199539
loss_pred:0.04274773225188255, decouple_loss:0.03551774099469185
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4662286043167114, gen p mean: 0.0, mean p set: 0.45167189836502075
The modified gen p mean: 0.46472933888435364, gen p mean: 0.0, mean p set: 0.45135995745658875
The modified gen p mean: 0.4606805145740509, gen p mean: 0.0, mean p set: 0.4530721604824066
loss_pred:0.0418456569314003, decouple_loss:0.03540201112627983
loss_pred:0.042754046618938446, decouple_loss:0.03526819497346878
loss_pred:0.04267419874668121, decouple_loss:0.03715725988149643
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4578445255756378, gen p mean: 0.0, mean p set: 0.4522865414619446
The modified gen p mean: 0.45483699440956116, gen p mean: 0.0, mean p set: 0.45234808325767517
The modified gen p mean: 0.45866966247558594, gen p mean: 0.0, mean p set: 0.45178544521331787
loss_pred:0.0402069129049778, decouple_loss:0.03537563234567642
loss_pred:0.04215339571237564, decouple_loss:0.03496256470680237
loss_pred:0.04213235527276993, decouple_loss:0.03449048846960068
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4328891932964325, gen p mean: 0.0, mean p set: 0.4494844079017639
The modified gen p mean: 0.4388905167579651, gen p mean: 0.0, mean p set: 0.45076262950897217
The modified gen p mean: 0.4415973126888275, gen p mean: 0.0, mean p set: 0.450408935546875
loss_pred:0.041456762701272964, decouple_loss:0.04004976525902748
loss_pred:0.04211873561143875, decouple_loss:0.03886917233467102
loss_pred:0.04362716153264046, decouple_loss:0.0394970141351223
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474238455295563, gen p mean: 0.0, mean p set: 0.45092666149139404
The modified gen p mean: 0.4466930031776428, gen p mean: 0.0, mean p set: 0.44958579540252686
The modified gen p mean: 0.4517190456390381, gen p mean: 0.0, mean p set: 0.4512515664100647
loss_pred:0.04111015051603317, decouple_loss:0.03726246580481529
loss_pred:0.04321574792265892, decouple_loss:0.03885830193758011
loss_pred:0.041169434785842896, decouple_loss:0.04126489907503128
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4633939266204834, gen p mean: 0.0, mean p set: 0.4505492150783539
The modified gen p mean: 0.46548792719841003, gen p mean: 0.0, mean p set: 0.4510750472545624
The modified gen p mean: 0.46668654680252075, gen p mean: 0.0, mean p set: 0.4489321708679199
loss_pred:0.040506940335035324, decouple_loss:0.03749637305736542
loss_pred:0.04114851355552673, decouple_loss:0.038670193403959274
loss_pred:0.042192429304122925, decouple_loss:0.03820441663265228
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527207314968109, gen p mean: 0.0, mean p set: 0.4494830369949341
The modified gen p mean: 0.455197811126709, gen p mean: 0.0, mean p set: 0.45106109976768494
The modified gen p mean: 0.4560871422290802, gen p mean: 0.0, mean p set: 0.4494141638278961
loss_pred:0.042694803327322006, decouple_loss:0.03775770217180252
loss_pred:0.03941591456532478, decouple_loss:0.03819167613983154
loss_pred:0.04315444454550743, decouple_loss:0.03739392012357712
2023-05-02 17:57:39 testing...
The modified gen p mean: 0.44201022386550903, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4475589096546173, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4501221776008606, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.043142374604940414, decouple_loss:0.03911316394805908
loss_pred:0.042142998427152634, decouple_loss:0.03744789958000183
loss_pred:0.04136515036225319, decouple_loss:0.03873150795698166
WV_0_PC_0_EH_0_PS_40_6, loss: 0.044138383120298386, avg_mse: 0.04515092074871063
current test mse: 0.045151
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519122838973999, gen p mean: 0.0, mean p set: 0.44835996627807617
The modified gen p mean: 0.4497448801994324, gen p mean: 0.0, mean p set: 0.4503350555896759
loss_pred:0.04276842996478081, decouple_loss:0.037610072642564774
loss_pred:0.03989003971219063, decouple_loss:0.03862755745649338
The modified gen p mean: 0.44878605008125305, gen p mean: 0.0, mean p set: 0.4482172131538391
loss_pred:0.04139316827058792, decouple_loss:0.03780742362141609
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4280438721179962, gen p mean: 0.0, mean p set: 0.4508989155292511
The modified gen p mean: 0.4330842196941376, gen p mean: 0.0, mean p set: 0.45007139444351196
The modified gen p mean: 0.4333620071411133, gen p mean: 0.0, mean p set: 0.4499005675315857
loss_pred:0.04106801748275757, decouple_loss:0.03609108924865723
loss_pred:0.040583595633506775, decouple_loss:0.03845526650547981
loss_pred:0.03986971452832222, decouple_loss:0.03767741471529007
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4655573070049286, gen p mean: 0.0, mean p set: 0.4497992694377899
The modified gen p mean: 0.4651544988155365, gen p mean: 0.0, mean p set: 0.4487907588481903
The modified gen p mean: 0.4646470844745636, gen p mean: 0.0, mean p set: 0.4477207064628601
loss_pred:0.04175309091806412, decouple_loss:0.0369742251932621
loss_pred:0.04229305684566498, decouple_loss:0.03640490770339966
loss_pred:0.040971316397190094, decouple_loss:0.03633976727724075
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519258737564087, gen p mean: 0.0, mean p set: 0.4508228898048401
The modified gen p mean: 0.4541143774986267, gen p mean: 0.0, mean p set: 0.4501335322856903
The modified gen p mean: 0.45544517040252686, gen p mean: 0.0, mean p set: 0.44953563809394836
loss_pred:0.04073571413755417, decouple_loss:0.03588737174868584
loss_pred:0.0409371517598629, decouple_loss:0.036801714450120926
loss_pred:0.041724786162376404, decouple_loss:0.03603428602218628
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4398949444293976, gen p mean: 0.0, mean p set: 0.4507005214691162
The modified gen p mean: 0.44307559728622437, gen p mean: 0.0, mean p set: 0.4493516683578491
The modified gen p mean: 0.43685030937194824, gen p mean: 0.0, mean p set: 0.44884857535362244
loss_pred:0.04101040959358215, decouple_loss:0.03516295179724693
loss_pred:0.04269927740097046, decouple_loss:0.03605424240231514
loss_pred:0.041626911610364914, decouple_loss:0.03629956394433975
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071735978126526, gen p mean: 0.0, mean p set: 0.4500423073768616
The modified gen p mean: 0.4465104639530182, gen p mean: 0.0, mean p set: 0.4476839303970337
The modified gen p mean: 0.44965243339538574, gen p mean: 0.0, mean p set: 0.448009192943573
loss_pred:0.041703175753355026, decouple_loss:0.03716990351676941
loss_pred:0.040839098393917084, decouple_loss:0.03550972416996956
loss_pred:0.040074411779642105, decouple_loss:0.03541331738233566
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074862241744995, gen p mean: 0.0, mean p set: 0.4491027593612671
The modified gen p mean: 0.45463111996650696, gen p mean: 0.0, mean p set: 0.4492337107658386
The modified gen p mean: 0.4503987431526184, gen p mean: 0.0, mean p set: 0.4498968720436096
loss_pred:0.041085127741098404, decouple_loss:0.03519773855805397
loss_pred:0.04063931480050087, decouple_loss:0.035569705069065094
loss_pred:0.04016643762588501, decouple_loss:0.03576991334557533
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013824105262756, gen p mean: 0.0, mean p set: 0.4506858289241791
The modified gen p mean: 0.4501693844795227, gen p mean: 0.0, mean p set: 0.4509190618991852
The modified gen p mean: 0.4500419497489929, gen p mean: 0.0, mean p set: 0.449707955121994
loss_pred:0.040143806487321854, decouple_loss:0.03616299852728844
loss_pred:0.042215727269649506, decouple_loss:0.03660224378108978
loss_pred:0.04107198491692543, decouple_loss:0.03558498993515968
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4544709026813507, gen p mean: 0.0, mean p set: 0.4501778185367584
The modified gen p mean: 0.44800007343292236, gen p mean: 0.0, mean p set: 0.44873154163360596
The modified gen p mean: 0.4513123631477356, gen p mean: 0.0, mean p set: 0.44939103722572327
loss_pred:0.03886321559548378, decouple_loss:0.03529577702283859
loss_pred:0.04133572429418564, decouple_loss:0.03488045558333397
loss_pred:0.04118594527244568, decouple_loss:0.03528863936662674
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507211446762085, gen p mean: 0.0, mean p set: 0.4507233798503876
The modified gen p mean: 0.45041364431381226, gen p mean: 0.0, mean p set: 0.4479977786540985
The modified gen p mean: 0.44515106081962585, gen p mean: 0.0, mean p set: 0.4496326744556427
loss_pred:0.04064211994409561, decouple_loss:0.03609206900000572
loss_pred:0.040083665400743484, decouple_loss:0.033934108912944794
loss_pred:0.041967034339904785, decouple_loss:0.034992873668670654
2023-05-02 18:01:22 testing...
The modified gen p mean: 0.4467790722846985, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45136758685112, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4532950520515442, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.042788390070199966, decouple_loss:0.036622680723667145
loss_pred:0.041459113359451294, decouple_loss:0.034449074417352676
loss_pred:0.04063936695456505, decouple_loss:0.0352952741086483
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04340174049139023, avg_mse: 0.04447570815682411
current test mse: 0.044476
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523228704929352, gen p mean: 0.0, mean p set: 0.4494022727012634
The modified gen p mean: 0.4466151297092438, gen p mean: 0.0, mean p set: 0.4495563805103302
loss_pred:0.04281210899353027, decouple_loss:0.0339423343539238
loss_pred:0.04149968549609184, decouple_loss:0.03508736565709114
The modified gen p mean: 0.45026177167892456, gen p mean: 0.0, mean p set: 0.45064398646354675
loss_pred:0.03855664283037186, decouple_loss:0.03495468571782112
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4559164047241211, gen p mean: 0.0, mean p set: 0.4505973160266876
The modified gen p mean: 0.4583028256893158, gen p mean: 0.0, mean p set: 0.4499913156032562
The modified gen p mean: 0.4541763961315155, gen p mean: 0.0, mean p set: 0.44843724370002747
loss_pred:0.04213152453303337, decouple_loss:0.035432491451501846
loss_pred:0.03996054455637932, decouple_loss:0.03540915623307228
loss_pred:0.04053004831075668, decouple_loss:0.03432152047753334
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4582546353340149, gen p mean: 0.0, mean p set: 0.4503912329673767
The modified gen p mean: 0.46073517203330994, gen p mean: 0.0, mean p set: 0.4499257802963257
The modified gen p mean: 0.4645230174064636, gen p mean: 0.0, mean p set: 0.4492511451244354
loss_pred:0.03820253163576126, decouple_loss:0.03490140661597252
loss_pred:0.04253598302602768, decouple_loss:0.03402358293533325
loss_pred:0.04214739054441452, decouple_loss:0.035834942013025284
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4295550286769867, gen p mean: 0.0, mean p set: 0.4504936933517456
The modified gen p mean: 0.43025603890419006, gen p mean: 0.0, mean p set: 0.4510194957256317
The modified gen p mean: 0.4310379922389984, gen p mean: 0.0, mean p set: 0.4498860538005829
loss_pred:0.03895401209592819, decouple_loss:0.03500719368457794
loss_pred:0.0398956760764122, decouple_loss:0.03506820276379585
loss_pred:0.042947664856910706, decouple_loss:0.03439107909798622
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509902000427246, gen p mean: 0.0, mean p set: 0.4507656991481781
The modified gen p mean: 0.45343491435050964, gen p mean: 0.0, mean p set: 0.44889214634895325
The modified gen p mean: 0.4554409682750702, gen p mean: 0.0, mean p set: 0.45017769932746887
loss_pred:0.040439117699861526, decouple_loss:0.03441395238041878
loss_pred:0.04127424955368042, decouple_loss:0.03436261788010597
loss_pred:0.03883221745491028, decouple_loss:0.03478452190756798
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4592110216617584, gen p mean: 0.0, mean p set: 0.44949066638946533
The modified gen p mean: 0.45226967334747314, gen p mean: 0.0, mean p set: 0.4498126208782196
The modified gen p mean: 0.4547041058540344, gen p mean: 0.0, mean p set: 0.4499218463897705
loss_pred:0.04231531545519829, decouple_loss:0.03478405997157097
loss_pred:0.04135635495185852, decouple_loss:0.03452697768807411
loss_pred:0.04112574830651283, decouple_loss:0.034060265868902206
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
NaN value num: 0
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45494896173477173, gen p mean: 0.0, mean p set: 0.4538283348083496
The modified gen p mean: 0.4478842616081238, gen p mean: 0.0, mean p set: 0.45090195536613464
The modified gen p mean: 0.4500756561756134, gen p mean: 0.0, mean p set: 0.4511997699737549
loss_pred:0.04229428619146347, decouple_loss:0.03749743849039078
loss_pred:0.041414424777030945, decouple_loss:0.03815307840704918
loss_pred:0.04359517991542816, decouple_loss:0.03859196603298187
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46097108721733093, gen p mean: 0.0, mean p set: 0.45254963636398315
The modified gen p mean: 0.4569348692893982, gen p mean: 0.0, mean p set: 0.45422741770744324
The modified gen p mean: 0.458170086145401, gen p mean: 0.0, mean p set: 0.4510881304740906
loss_pred:0.04300205036997795, decouple_loss:0.038107335567474365
loss_pred:0.04242847487330437, decouple_loss:0.03834669291973114
loss_pred:0.04189904034137726, decouple_loss:0.03814657777547836
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531799256801605, gen p mean: 0.0, mean p set: 0.45011797547340393
The modified gen p mean: 0.4536021053791046, gen p mean: 0.0, mean p set: 0.4526059925556183
The modified gen p mean: 0.4536707103252411, gen p mean: 0.0, mean p set: 0.45363950729370117
loss_pred:0.03904388099908829, decouple_loss:0.038396965712308884
loss_pred:0.04332500323653221, decouple_loss:0.038246672600507736
loss_pred:0.04232272878289223, decouple_loss:0.03841133788228035
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4307078719139099, gen p mean: 0.0, mean p set: 0.45544660091400146
The modified gen p mean: 0.43699222803115845, gen p mean: 0.0, mean p set: 0.4513308107852936
The modified gen p mean: 0.4388059973716736, gen p mean: 0.0, mean p set: 0.45259830355644226
loss_pred:0.041656315326690674, decouple_loss:0.03803080692887306
loss_pred:0.04169538617134094, decouple_loss:0.03706171736121178
loss_pred:0.042611874639987946, decouple_loss:0.03817984461784363
2023-05-02 18:05:45 testing...
The modified gen p mean: 0.45933741331100464, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45446670055389404, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4612047076225281, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.0414309985935688, decouple_loss:0.03571820259094238
loss_pred:0.042637281119823456, decouple_loss:0.03738567605614662
loss_pred:0.04065348580479622, decouple_loss:0.03702966123819351
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04340948164463043, avg_mse: 0.04450366273522377
current test mse: 0.044504
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4612816274166107, gen p mean: 0.0, mean p set: 0.45161619782447815
loss_pred:0.04319718852639198, decouple_loss:0.035964734852313995
The modified gen p mean: 0.45479801297187805, gen p mean: 0.0, mean p set: 0.4530578553676605
loss_pred:0.043640196323394775, decouple_loss:0.03752092644572258
The modified gen p mean: 0.4600518047809601, gen p mean: 0.0, mean p set: 0.4536832273006439
loss_pred:0.04176280274987221, decouple_loss:0.03883292153477669
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4577786922454834, gen p mean: 0.0, mean p set: 0.453487753868103
The modified gen p mean: 0.452840656042099, gen p mean: 0.0, mean p set: 0.4506944417953491
The modified gen p mean: 0.4547279477119446, gen p mean: 0.0, mean p set: 0.45175933837890625
loss_pred:0.04154748469591141, decouple_loss:0.03686777129769325
loss_pred:0.041692256927490234, decouple_loss:0.03514128178358078
loss_pred:0.039288561791181564, decouple_loss:0.03660618141293526
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866546988487244, gen p mean: 0.0, mean p set: 0.4504196047782898
The modified gen p mean: 0.453794002532959, gen p mean: 0.0, mean p set: 0.4532114863395691
The modified gen p mean: 0.4479815363883972, gen p mean: 0.0, mean p set: 0.4508957266807556
loss_pred:0.03836434334516525, decouple_loss:0.036440618336200714
loss_pred:0.042061999440193176, decouple_loss:0.0351090170443058
loss_pred:0.04015091434121132, decouple_loss:0.03491148725152016
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484390616416931, gen p mean: 0.0, mean p set: 0.4539260268211365
The modified gen p mean: 0.4509446620941162, gen p mean: 0.0, mean p set: 0.4500764310359955
The modified gen p mean: 0.4482729434967041, gen p mean: 0.0, mean p set: 0.451936274766922
loss_pred:0.0406121201813221, decouple_loss:0.034418534487485886
loss_pred:0.041423652321100235, decouple_loss:0.034731145948171616
loss_pred:0.04257915914058685, decouple_loss:0.03495809808373451
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530136287212372, gen p mean: 0.0, mean p set: 0.4519317150115967
The modified gen p mean: 0.45192423462867737, gen p mean: 0.0, mean p set: 0.45397984981536865
The modified gen p mean: 0.4504498541355133, gen p mean: 0.0, mean p set: 0.4537713825702667
loss_pred:0.043397244065999985, decouple_loss:0.036525171250104904
loss_pred:0.03930766507983208, decouple_loss:0.03689960762858391
loss_pred:0.0413251630961895, decouple_loss:0.03605760633945465
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46091774106025696, gen p mean: 0.0, mean p set: 0.4503626525402069
The modified gen p mean: 0.46211281418800354, gen p mean: 0.0, mean p set: 0.45227164030075073
The modified gen p mean: 0.457839697599411, gen p mean: 0.0, mean p set: 0.4506206214427948
loss_pred:0.04045770689845085, decouple_loss:0.035163555294275284
loss_pred:0.043366190046072006, decouple_loss:0.035628676414489746
loss_pred:0.038896530866622925, decouple_loss:0.035586532205343246
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45677998661994934, gen p mean: 0.0, mean p set: 0.45366615056991577
The modified gen p mean: 0.4525795578956604, gen p mean: 0.0, mean p set: 0.4507310390472412
The modified gen p mean: 0.4511336088180542, gen p mean: 0.0, mean p set: 0.452653169631958
loss_pred:0.04405495896935463, decouple_loss:0.03642608970403671
loss_pred:0.041393112391233444, decouple_loss:0.03541848063468933
loss_pred:0.04250796139240265, decouple_loss:0.035749416798353195
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4371839165687561, gen p mean: 0.0, mean p set: 0.4524341821670532
The modified gen p mean: 0.43762528896331787, gen p mean: 0.0, mean p set: 0.4538773000240326
The modified gen p mean: 0.433771014213562, gen p mean: 0.0, mean p set: 0.4545283913612366
loss_pred:0.04044151306152344, decouple_loss:0.03587595373392105
loss_pred:0.043947987258434296, decouple_loss:0.03546296805143356
loss_pred:0.03919432312250137, decouple_loss:0.03611961752176285
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45405036211013794, gen p mean: 0.0, mean p set: 0.4524429440498352
The modified gen p mean: 0.45061299204826355, gen p mean: 0.0, mean p set: 0.45287883281707764
The modified gen p mean: 0.45334920287132263, gen p mean: 0.0, mean p set: 0.454647958278656
loss_pred:0.040030017495155334, decouple_loss:0.035958290100097656
loss_pred:0.03842039033770561, decouple_loss:0.0350395105779171
loss_pred:0.0404096357524395, decouple_loss:0.03468261659145355
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4666139781475067, gen p mean: 0.0, mean p set: 0.45147937536239624
The modified gen p mean: 0.46801888942718506, gen p mean: 0.0, mean p set: 0.45286890864372253
The modified gen p mean: 0.46897661685943604, gen p mean: 0.0, mean p set: 0.4535693824291229
loss_pred:0.04061799496412277, decouple_loss:0.03549151122570038
loss_pred:0.04339329153299332, decouple_loss:0.036621905863285065
loss_pred:0.04148634150624275, decouple_loss:0.03418606519699097
2023-05-02 18:09:28 testing...
The modified gen p mean: 0.44782620668411255, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4418849050998688, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4497779309749603, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.04150807484984398, decouple_loss:0.03765716031193733
loss_pred:0.042713671922683716, decouple_loss:0.03973802179098129
loss_pred:0.040670979768037796, decouple_loss:0.03918379917740822
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04357389360666275, avg_mse: 0.04473361372947693
current test mse: 0.044734
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716379046440125, gen p mean: 0.0, mean p set: 0.4523768723011017
The modified gen p mean: 0.44940710067749023, gen p mean: 0.0, mean p set: 0.45136159658432007
loss_pred:0.03849855810403824, decouple_loss:0.03520553931593895
loss_pred:0.04024270549416542, decouple_loss:0.036057256162166595
The modified gen p mean: 0.4470773935317993, gen p mean: 0.0, mean p set: 0.4542378783226013
loss_pred:0.04078790545463562, decouple_loss:0.03512623906135559
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44273674488067627, gen p mean: 0.0, mean p set: 0.4500868618488312
The modified gen p mean: 0.4445291757583618, gen p mean: 0.0, mean p set: 0.4508844316005707
The modified gen p mean: 0.4454074501991272, gen p mean: 0.0, mean p set: 0.4534010887145996
loss_pred:0.03765467554330826, decouple_loss:0.035903170704841614
loss_pred:0.03826024383306503, decouple_loss:0.03571891412138939
loss_pred:0.04101863503456116, decouple_loss:0.03696446120738983
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46028751134872437, gen p mean: 0.0, mean p set: 0.45355919003486633The modified gen p mean: 0.45984959602355957, gen p mean: 0.0, mean p set: 0.45238202810287476
The modified gen p mean: 0.4593054950237274, gen p mean: 0.0, mean p set: 0.4510316848754883
loss_pred:0.04293856769800186, decouple_loss:0.0359405055642128
loss_pred:0.03847653791308403, decouple_loss:0.035244207829236984
loss_pred:0.04018900543451309, decouple_loss:0.035048212856054306
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818904995918274, gen p mean: 0.0, mean p set: 0.452282190322876
The modified gen p mean: 0.44410577416419983, gen p mean: 0.0, mean p set: 0.4534182846546173
The modified gen p mean: 0.4500381350517273, gen p mean: 0.0, mean p set: 0.4520170986652374
loss_pred:0.04036657512187958, decouple_loss:0.035443175584077835
loss_pred:0.04331013187766075, decouple_loss:0.035540878772735596
loss_pred:0.04204987734556198, decouple_loss:0.03566710650920868
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46157053112983704, gen p mean: 0.0, mean p set: 0.45168498158454895
The modified gen p mean: 0.45776280760765076, gen p mean: 0.0, mean p set: 0.4533534646034241
The modified gen p mean: 0.45015060901641846, gen p mean: 0.0, mean p set: 0.4535527229309082
loss_pred:0.041890110820531845, decouple_loss:0.03508836776018143
loss_pred:0.041728440672159195, decouple_loss:0.03346056863665581
loss_pred:0.042785387486219406, decouple_loss:0.03542398288846016
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
NaN value num: 0
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45828285813331604, gen p mean: 0.0, mean p set: 0.45285579562187195
The modified gen p mean: 0.4550166428089142, gen p mean: 0.0, mean p set: 0.4529862403869629
The modified gen p mean: 0.4569258391857147, gen p mean: 0.0, mean p set: 0.4524134397506714
loss_pred:0.038332898169755936, decouple_loss:0.03610071539878845
loss_pred:0.0423273965716362, decouple_loss:0.035521168261766434
loss_pred:0.04010298475623131, decouple_loss:0.036377351731061935
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4312359094619751, gen p mean: 0.0, mean p set: 0.45258474349975586
The modified gen p mean: 0.42771652340888977, gen p mean: 0.0, mean p set: 0.4529101252555847
The modified gen p mean: 0.42669710516929626, gen p mean: 0.0, mean p set: 0.45279404520988464
loss_pred:0.043081022799015045, decouple_loss:0.036915574222803116
loss_pred:0.04035206139087677, decouple_loss:0.03612786531448364
loss_pred:0.042874954640865326, decouple_loss:0.03888790309429169
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.48281365633010864, gen p mean: 0.0, mean p set: 0.4553252160549164
The modified gen p mean: 0.47951391339302063, gen p mean: 0.0, mean p set: 0.4529314935207367
The modified gen p mean: 0.4796486794948578, gen p mean: 0.0, mean p set: 0.4524819552898407
loss_pred:0.04269041121006012, decouple_loss:0.03530029579997063
loss_pred:0.03983088955283165, decouple_loss:0.03524976596236229
loss_pred:0.04273966699838638, decouple_loss:0.037150099873542786
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45432248711586, gen p mean: 0.0, mean p set: 0.4522823691368103
The modified gen p mean: 0.44849884510040283, gen p mean: 0.0, mean p set: 0.45361486077308655
The modified gen p mean: 0.4468819200992584, gen p mean: 0.0, mean p set: 0.453206866979599
loss_pred:0.039335448294878006, decouple_loss:0.035847846418619156
loss_pred:0.03942312300205231, decouple_loss:0.034896936267614365
loss_pred:0.03793718293309212, decouple_loss:0.03457782790064812
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4258357286453247, gen p mean: 0.0, mean p set: 0.4518284201622009
The modified gen p mean: 0.42975175380706787, gen p mean: 0.0, mean p set: 0.4527120590209961
The modified gen p mean: 0.4287508726119995, gen p mean: 0.0, mean p set: 0.4530394971370697
loss_pred:0.04085865989327431, decouple_loss:0.03508013114333153
loss_pred:0.04140275716781616, decouple_loss:0.035604726523160934
loss_pred:0.041165728121995926, decouple_loss:0.03613720089197159
2023-05-02 18:14:05 testing...
The modified gen p mean: 0.46065932512283325, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4670402705669403, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.46964967250823975, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.04265163093805313, decouple_loss:0.03845464438199997
loss_pred:0.041646119207143784, decouple_loss:0.03662208467721939loss_pred:0.04060252755880356, decouple_loss:0.03800837695598602
WV_0_PC_0_EH_0_PS_40_6, loss: 0.043518178164958954, avg_mse: 0.044870276004076004
current test mse: 0.04487
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46906208992004395, gen p mean: 0.0, mean p set: 0.4532618522644043
The modified gen p mean: 0.4682331085205078, gen p mean: 0.0, mean p set: 0.45320409536361694
loss_pred:0.042521458119153976, decouple_loss:0.036655526608228683
loss_pred:0.040376801043748856, decouple_loss:0.03431198373436928
The modified gen p mean: 0.4692770838737488, gen p mean: 0.0, mean p set: 0.45262637734413147
loss_pred:0.041289325803518295, decouple_loss:0.035823315382003784
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4595903754234314, gen p mean: 0.0, mean p set: 0.45411795377731323
The modified gen p mean: 0.46807265281677246, gen p mean: 0.0, mean p set: 0.4521646797657013
The modified gen p mean: 0.4645138084888458, gen p mean: 0.0, mean p set: 0.4535945653915405
loss_pred:0.03866789862513542, decouple_loss:0.03529100865125656
loss_pred:0.0400945283472538, decouple_loss:0.035877879709005356
loss_pred:0.037925705313682556, decouple_loss:0.03495769202709198
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44246286153793335, gen p mean: 0.0, mean p set: 0.4520712196826935
The modified gen p mean: 0.43953466415405273, gen p mean: 0.0, mean p set: 0.4524330198764801
The modified gen p mean: 0.4414951205253601, gen p mean: 0.0, mean p set: 0.4528862237930298
loss_pred:0.03986804932355881, decouple_loss:0.03341611102223396
loss_pred:0.03990248963236809, decouple_loss:0.034333486109972
loss_pred:0.03937580808997154, decouple_loss:0.033583808690309525
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4400363266468048, gen p mean: 0.0, mean p set: 0.45464417338371277
The modified gen p mean: 0.4363657832145691, gen p mean: 0.0, mean p set: 0.4527222514152527
The modified gen p mean: 0.43794122338294983, gen p mean: 0.0, mean p set: 0.4530031979084015
loss_pred:0.04238169640302658, decouple_loss:0.03488898649811745
loss_pred:0.04085303097963333, decouple_loss:0.034331995993852615
loss_pred:0.04180290549993515, decouple_loss:0.03654969483613968
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4673992097377777, gen p mean: 0.0, mean p set: 0.45227310061454773
The modified gen p mean: 0.47197139263153076, gen p mean: 0.0, mean p set: 0.4540300667285919
The modified gen p mean: 0.4731060564517975, gen p mean: 0.0, mean p set: 0.4523705840110779
loss_pred:0.04314921796321869, decouple_loss:0.03558250144124031
loss_pred:0.03974560275673866, decouple_loss:0.034540653228759766
loss_pred:0.0395343080163002, decouple_loss:0.03362542763352394
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4612325429916382, gen p mean: 0.0, mean p set: 0.45353299379348755
The modified gen p mean: 0.46317631006240845, gen p mean: 0.0, mean p set: 0.4547733962535858
The modified gen p mean: 0.4647403061389923, gen p mean: 0.0, mean p set: 0.4531950354576111
loss_pred:0.041586317121982574, decouple_loss:0.0355452336370945
loss_pred:0.04169423505663872, decouple_loss:0.03548533841967583
loss_pred:0.04137660562992096, decouple_loss:0.03420284017920494
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43397602438926697, gen p mean: 0.0, mean p set: 0.45373082160949707
The modified gen p mean: 0.4460294544696808, gen p mean: 0.0, mean p set: 0.4518222510814667
The modified gen p mean: 0.44182708859443665, gen p mean: 0.0, mean p set: 0.45349109172821045
loss_pred:0.03761492297053337, decouple_loss:0.034301113337278366
loss_pred:0.04022926464676857, decouple_loss:0.0336323119699955
loss_pred:0.041264552623033524, decouple_loss:0.03463692218065262
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44602665305137634, gen p mean: 0.0, mean p set: 0.45247119665145874
The modified gen p mean: 0.43942007422447205, gen p mean: 0.0, mean p set: 0.45338940620422363
The modified gen p mean: 0.4450557231903076, gen p mean: 0.0, mean p set: 0.45238441228866577
loss_pred:0.041416365653276443, decouple_loss:0.034718722105026245
loss_pred:0.04128750041127205, decouple_loss:0.033942997455596924
loss_pred:0.03803866729140282, decouple_loss:0.03395424038171768
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4629977345466614, gen p mean: 0.0, mean p set: 0.45425835251808167
The modified gen p mean: 0.458252489566803, gen p mean: 0.0, mean p set: 0.4530657231807709
The modified gen p mean: 0.4616084098815918, gen p mean: 0.0, mean p set: 0.4532524347305298
loss_pred:0.04142313078045845, decouple_loss:0.03455245494842529
loss_pred:0.03844508156180382, decouple_loss:0.03376121446490288
loss_pred:0.0387464240193367, decouple_loss:0.03499250113964081
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46149539947509766, gen p mean: 0.0, mean p set: 0.45322301983833313
The modified gen p mean: 0.45908328890800476, gen p mean: 0.0, mean p set: 0.4535960853099823
The modified gen p mean: 0.4600375294685364, gen p mean: 0.0, mean p set: 0.4536839425563812
loss_pred:0.03853685036301613, decouple_loss:0.03453187644481659
loss_pred:0.04233154281973839, decouple_loss:0.03601761907339096
loss_pred:0.04229305312037468, decouple_loss:0.03595057502388954
2023-05-02 18:17:45 testing...
The modified gen p mean: 0.4466932713985443, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4527093470096588, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45531415939331055, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.04262606054544449, decouple_loss:0.03827381506562233
loss_pred:0.04134140908718109, decouple_loss:0.036292046308517456
loss_pred:0.04041020944714546, decouple_loss:0.03752124682068825
WV_0_PC_0_EH_0_PS_40_6, loss: 0.043327346444129944, avg_mse: 0.04478633403778076
current test mse: 0.044786
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527868330478668, gen p mean: 0.0, mean p set: 0.4530191123485565
loss_pred:0.04120496287941933, decouple_loss:0.034058406949043274
The modified gen p mean: 0.4491075873374939, gen p mean: 0.0, mean p set: 0.4534636437892914
loss_pred:0.042180679738521576, decouple_loss:0.03583279624581337
The modified gen p mean: 0.4496982991695404, gen p mean: 0.0, mean p set: 0.4525669813156128
loss_pred:0.04057629033923149, decouple_loss:0.03451463580131531
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4398246109485626, gen p mean: 0.0, mean p set: 0.45306530594825745
The modified gen p mean: 0.43644362688064575, gen p mean: 0.0, mean p set: 0.4520983099937439
The modified gen p mean: 0.4452381432056427, gen p mean: 0.0, mean p set: 0.4531652331352234
loss_pred:0.03747300058603287, decouple_loss:0.033588919788599014
loss_pred:0.042392548173666, decouple_loss:0.03531083092093468
loss_pred:0.04013977199792862, decouple_loss:0.03429466858506203
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536537826061249, gen p mean: 0.0, mean p set: 0.4538002610206604
The modified gen p mean: 0.4609741270542145, gen p mean: 0.0, mean p set: 0.4538719952106476
The modified gen p mean: 0.46148741245269775, gen p mean: 0.0, mean p set: 0.4529918134212494
loss_pred:0.040806520730257034, decouple_loss:0.0335724800825119
loss_pred:0.04125900939106941, decouple_loss:0.033040497452020645
loss_pred:0.04136156663298607, decouple_loss:0.0337165929377079
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46681883931159973, gen p mean: 0.0, mean p set: 0.4517868459224701
The modified gen p mean: 0.4646628201007843, gen p mean: 0.0, mean p set: 0.45368245244026184
The modified gen p mean: 0.4622073769569397, gen p mean: 0.0, mean p set: 0.45458728075027466
loss_pred:0.03875654190778732, decouple_loss:0.03445179760456085
loss_pred:0.03927845135331154, decouple_loss:0.03300272300839424
loss_pred:0.03972078859806061, decouple_loss:0.03287499397993088
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
NaN value num: 0
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44573384523391724, gen p mean: 0.0, mean p set: 0.4544958472251892
The modified gen p mean: 0.4424508512020111, gen p mean: 0.0, mean p set: 0.4530305862426758
The modified gen p mean: 0.454931378364563, gen p mean: 0.0, mean p set: 0.453988641500473
loss_pred:0.03912633657455444, decouple_loss:0.03403492644429207
loss_pred:0.03960493579506874, decouple_loss:0.03376154974102974
loss_pred:0.04157179594039917, decouple_loss:0.03485061973333359
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4444384276866913, gen p mean: 0.0, mean p set: 0.4507507383823395
The modified gen p mean: 0.4428345263004303, gen p mean: 0.0, mean p set: 0.4529087543487549
The modified gen p mean: 0.4434446692466736, gen p mean: 0.0, mean p set: 0.4541010856628418
loss_pred:0.0401318222284317, decouple_loss:0.03354983031749725
loss_pred:0.04082389548420906, decouple_loss:0.03419376164674759
loss_pred:0.03952747955918312, decouple_loss:0.034133803099393845
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543236196041107, gen p mean: 0.0, mean p set: 0.45383745431900024
The modified gen p mean: 0.4514840543270111, gen p mean: 0.0, mean p set: 0.45299461483955383
The modified gen p mean: 0.4498637616634369, gen p mean: 0.0, mean p set: 0.45351284742355347
loss_pred:0.04003094136714935, decouple_loss:0.034055355936288834
loss_pred:0.03983410447835922, decouple_loss:0.03495283052325249
loss_pred:0.040257953107357025, decouple_loss:0.033885855227708817
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4654037058353424, gen p mean: 0.0, mean p set: 0.4535074532032013
The modified gen p mean: 0.4625750780105591, gen p mean: 0.0, mean p set: 0.45230671763420105
The modified gen p mean: 0.464754581451416, gen p mean: 0.0, mean p set: 0.45325344800949097
loss_pred:0.03836611658334732, decouple_loss:0.03407209366559982
loss_pred:0.04032900556921959, decouple_loss:0.033664703369140625
loss_pred:0.03839346766471863, decouple_loss:0.034598492085933685
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514044225215912, gen p mean: 0.0, mean p set: 0.45295077562332153
The modified gen p mean: 0.4520411491394043, gen p mean: 0.0, mean p set: 0.4526754915714264
The modified gen p mean: 0.45172107219696045, gen p mean: 0.0, mean p set: 0.45074325799942017
loss_pred:0.03808154910802841, decouple_loss:0.03462083265185356
loss_pred:0.03972337767481804, decouple_loss:0.03476637974381447
loss_pred:0.03998012840747833, decouple_loss:0.034997303038835526
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450636088848114, gen p mean: 0.0, mean p set: 0.4544040560722351
The modified gen p mean: 0.4466525912284851, gen p mean: 0.0, mean p set: 0.45460760593414307
The modified gen p mean: 0.44548842310905457, gen p mean: 0.0, mean p set: 0.4538998007774353
loss_pred:0.04252643883228302, decouple_loss:0.036300282925367355loss_pred:0.04176824167370796, decouple_loss:0.03660747781395912
loss_pred:0.038287919014692307, decouple_loss:0.03522477298974991
2023-05-02 18:22:05 testing...
The modified gen p mean: 0.43974390625953674, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4482087194919586, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4463326930999756, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.04212738573551178, decouple_loss:0.03869817405939102
loss_pred:0.040100209414958954, decouple_loss:0.03749459236860275
loss_pred:0.041076116263866425, decouple_loss:0.036164019256830215
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04297385364770889, avg_mse: 0.04442557692527771
current test mse: 0.044426
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44487306475639343, gen p mean: 0.0, mean p set: 0.45396625995635986
The modified gen p mean: 0.4445056617259979, gen p mean: 0.0, mean p set: 0.453481525182724
loss_pred:0.0396672859787941, decouple_loss:0.034335892647504807
loss_pred:0.0401955172419548, decouple_loss:0.034068796783685684
The modified gen p mean: 0.44031497836112976, gen p mean: 0.0, mean p set: 0.45425495505332947
loss_pred:0.04155838489532471, decouple_loss:0.03450661152601242
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45183712244033813, gen p mean: 0.0, mean p set: 0.4547848105430603
The modified gen p mean: 0.4541568160057068, gen p mean: 0.0, mean p set: 0.4534422755241394
The modified gen p mean: 0.45376187562942505, gen p mean: 0.0, mean p set: 0.4534461498260498
loss_pred:0.04075668379664421, decouple_loss:0.03490153327584267
loss_pred:0.03907189890742302, decouple_loss:0.033840809017419815
loss_pred:0.039540890604257584, decouple_loss:0.033579956740140915
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46251216530799866, gen p mean: 0.0, mean p set: 0.4533441960811615The modified gen p mean: 0.46117210388183594, gen p mean: 0.0, mean p set: 0.4543784260749817
The modified gen p mean: 0.468048632144928, gen p mean: 0.0, mean p set: 0.4536985456943512
loss_pred:0.03909599781036377, decouple_loss:0.033694788813591
loss_pred:0.03988382965326309, decouple_loss:0.03374677896499634
loss_pred:0.04022940248250961, decouple_loss:0.03342015668749809
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45512253046035767, gen p mean: 0.0, mean p set: 0.45361828804016113
The modified gen p mean: 0.4570804834365845, gen p mean: 0.0, mean p set: 0.45392709970474243
The modified gen p mean: 0.45756083726882935, gen p mean: 0.0, mean p set: 0.4542456865310669
loss_pred:0.03959129750728607, decouple_loss:0.03277973458170891
loss_pred:0.03924058750271797, decouple_loss:0.03335298225283623
loss_pred:0.03897073492407799, decouple_loss:0.03355063125491142
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45381346344947815, gen p mean: 0.0, mean p set: 0.45435431599617004
The modified gen p mean: 0.4520365595817566, gen p mean: 0.0, mean p set: 0.45336446166038513
The modified gen p mean: 0.45159608125686646, gen p mean: 0.0, mean p set: 0.45507341623306274
loss_pred:0.03939085453748703, decouple_loss:0.03462424501776695
loss_pred:0.040136855095624924, decouple_loss:0.03323935717344284
loss_pred:0.03990360349416733, decouple_loss:0.03382689505815506
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538630545139313, gen p mean: 0.0, mean p set: 0.453529417514801
The modified gen p mean: 0.44634145498275757, gen p mean: 0.0, mean p set: 0.4542261064052582
The modified gen p mean: 0.4492153525352478, gen p mean: 0.0, mean p set: 0.4538280665874481
loss_pred:0.03975696861743927, decouple_loss:0.03306543454527855
loss_pred:0.04154222831130028, decouple_loss:0.0342300608754158
loss_pred:0.0398750826716423, decouple_loss:0.033363793045282364
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45244789123535156, gen p mean: 0.0, mean p set: 0.45345136523246765
The modified gen p mean: 0.4571078419685364, gen p mean: 0.0, mean p set: 0.45491892099380493
The modified gen p mean: 0.4540771543979645, gen p mean: 0.0, mean p set: 0.4539128243923187
loss_pred:0.03916354104876518, decouple_loss:0.03408925235271454
loss_pred:0.03953283280134201, decouple_loss:0.03325508162379265
loss_pred:0.039203085005283356, decouple_loss:0.03308991715312004
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489755928516388, gen p mean: 0.0, mean p set: 0.4528715908527374
The modified gen p mean: 0.4481619596481323, gen p mean: 0.0, mean p set: 0.4528396725654602
The modified gen p mean: 0.4522075951099396, gen p mean: 0.0, mean p set: 0.45323580503463745
loss_pred:0.037909477949142456, decouple_loss:0.0340675413608551
loss_pred:0.03816111758351326, decouple_loss:0.03328925743699074
loss_pred:0.038563188165426254, decouple_loss:0.03368447348475456
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454998254776001, gen p mean: 0.0, mean p set: 0.4528941214084625
The modified gen p mean: 0.4602380692958832, gen p mean: 0.0, mean p set: 0.45484453439712524
The modified gen p mean: 0.45567581057548523, gen p mean: 0.0, mean p set: 0.4533534049987793
loss_pred:0.03934164717793465, decouple_loss:0.03410404175519943
loss_pred:0.03856262192130089, decouple_loss:0.03380412235856056
loss_pred:0.03920495882630348, decouple_loss:0.033306460827589035
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46719491481781006, gen p mean: 0.0, mean p set: 0.4536536633968353
The modified gen p mean: 0.4648769795894623, gen p mean: 0.0, mean p set: 0.45293015241622925
The modified gen p mean: 0.46302852034568787, gen p mean: 0.0, mean p set: 0.453046590089798
loss_pred:0.03922777995467186, decouple_loss:0.033526040613651276
loss_pred:0.03800962120294571, decouple_loss:0.03377758711576462
loss_pred:0.04041018337011337, decouple_loss:0.03367341682314873
2023-05-02 18:25:49 testing...
The modified gen p mean: 0.4355548024177551, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44257572293281555, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4445873200893402, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.042224228382110596, decouple_loss:0.038622934371232986
loss_pred:0.040916528552770615, decouple_loss:0.036219123750925064
loss_pred:0.04005858302116394, decouple_loss:0.03742729872465134
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04293760284781456, avg_mse: 0.044464360922575
current test mse: 0.044464
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729381799697876, gen p mean: 0.0, mean p set: 0.4535035192966461
The modified gen p mean: 0.45175406336784363, gen p mean: 0.0, mean p set: 0.4540044963359833
loss_pred:0.03950925171375275, decouple_loss:0.032360807061195374
loss_pred:0.04194355756044388, decouple_loss:0.03482377529144287
The modified gen p mean: 0.4423969089984894, gen p mean: 0.0, mean p set: 0.4535713493824005
loss_pred:0.038405660539865494, decouple_loss:0.03238951787352562
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44138169288635254, gen p mean: 0.0, mean p set: 0.45369112491607666
The modified gen p mean: 0.4332597255706787, gen p mean: 0.0, mean p set: 0.451170951128006
The modified gen p mean: 0.43545231223106384, gen p mean: 0.0, mean p set: 0.4537711441516876
loss_pred:0.03987005725502968, decouple_loss:0.033884719014167786
loss_pred:0.03877127170562744, decouple_loss:0.0335683636367321
loss_pred:0.039884891360998154, decouple_loss:0.03282772749662399
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532800018787384, gen p mean: 0.0, mean p set: 0.45237207412719727
The modified gen p mean: 0.45670613646507263, gen p mean: 0.0, mean p set: 0.45264074206352234
The modified gen p mean: 0.45604774355888367, gen p mean: 0.0, mean p set: 0.4540416896343231
loss_pred:0.0392623171210289, decouple_loss:0.033017922192811966
loss_pred:0.03977891057729721, decouple_loss:0.03352497145533562
loss_pred:0.038229890167713165, decouple_loss:0.03366350010037422
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
NaN value num: 0
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46553266048431396, gen p mean: 0.0, mean p set: 0.4502403438091278
The modified gen p mean: 0.469801664352417, gen p mean: 0.0, mean p set: 0.4530782699584961
The modified gen p mean: 0.4648537039756775, gen p mean: 0.0, mean p set: 0.44970813393592834
loss_pred:0.041136085987091064, decouple_loss:0.035029321908950806
loss_pred:0.03909946605563164, decouple_loss:0.03483685478568077
loss_pred:0.039013516157865524, decouple_loss:0.034648243337869644
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45146656036376953, gen p mean: 0.0, mean p set: 0.44996196031570435
The modified gen p mean: 0.4391539692878723, gen p mean: 0.0, mean p set: 0.4503604471683502
The modified gen p mean: 0.4353364408016205, gen p mean: 0.0, mean p set: 0.4501286447048187
loss_pred:0.040622785687446594, decouple_loss:0.03491419181227684
loss_pred:0.03787866234779358, decouple_loss:0.03432534635066986
loss_pred:0.03795429691672325, decouple_loss:0.036756034940481186
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4428838789463043, gen p mean: 0.0, mean p set: 0.4516216814517975
The modified gen p mean: 0.4432651400566101, gen p mean: 0.0, mean p set: 0.4509774148464203
The modified gen p mean: 0.442882776260376, gen p mean: 0.0, mean p set: 0.4500081539154053
loss_pred:0.040392324328422546, decouple_loss:0.03411928936839104
loss_pred:0.03966953977942467, decouple_loss:0.03430107608437538
loss_pred:0.03952986001968384, decouple_loss:0.03498057648539543
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4611726999282837, gen p mean: 0.0, mean p set: 0.4498610198497772
The modified gen p mean: 0.45981818437576294, gen p mean: 0.0, mean p set: 0.45175236463546753
The modified gen p mean: 0.4558313488960266, gen p mean: 0.0, mean p set: 0.4498123526573181
loss_pred:0.040705617517232895, decouple_loss:0.034398119896650314
loss_pred:0.04115951061248779, decouple_loss:0.03474215045571327
loss_pred:0.03878139704465866, decouple_loss:0.03385043144226074
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524988532066345, gen p mean: 0.0, mean p set: 0.4494384825229645
The modified gen p mean: 0.44434571266174316, gen p mean: 0.0, mean p set: 0.4496227502822876
The modified gen p mean: 0.4506279230117798, gen p mean: 0.0, mean p set: 0.45065566897392273
loss_pred:0.037027757614851, decouple_loss:0.0354861281812191
loss_pred:0.03697613254189491, decouple_loss:0.03548909351229668
loss_pred:0.040095794945955276, decouple_loss:0.03464565798640251
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746899604797363, gen p mean: 0.0, mean p set: 0.44991159439086914
The modified gen p mean: 0.4436893165111542, gen p mean: 0.0, mean p set: 0.45071735978126526
The modified gen p mean: 0.43856877088546753, gen p mean: 0.0, mean p set: 0.4496690630912781
loss_pred:0.03706793859601021, decouple_loss:0.0335339792072773
loss_pred:0.03796673193573952, decouple_loss:0.033419132232666016
loss_pred:0.038082849234342575, decouple_loss:0.034588560461997986
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4648183584213257, gen p mean: 0.0, mean p set: 0.44978389143943787
The modified gen p mean: 0.46429210901260376, gen p mean: 0.0, mean p set: 0.45174553990364075
The modified gen p mean: 0.4651869535446167, gen p mean: 0.0, mean p set: 0.45020246505737305
loss_pred:0.037329621613025665, decouple_loss:0.03356429561972618
loss_pred:0.04073382541537285, decouple_loss:0.03618091717362404
loss_pred:0.039946332573890686, decouple_loss:0.033204443752765656
2023-05-02 18:30:06 testing...
The modified gen p mean: 0.44659334421157837, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45542970299720764, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4536292850971222, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.04171239957213402, decouple_loss:0.03835635632276535
loss_pred:0.0396512933075428, decouple_loss:0.03759722039103508
loss_pred:0.040558334439992905, decouple_loss:0.035633642226457596
WV_0_PC_0_EH_0_PS_40_6, loss: 0.042500466108322144, avg_mse: 0.04410885274410248
current test mse: 0.044109
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45090657472610474, gen p mean: 0.0, mean p set: 0.45080122351646423
The modified gen p mean: 0.44517049193382263, gen p mean: 0.0, mean p set: 0.44994187355041504
loss_pred:0.03985881432890892, decouple_loss:0.034585628658533096
loss_pred:0.037879277020692825, decouple_loss:0.0332898385822773
The modified gen p mean: 0.4518236219882965, gen p mean: 0.0, mean p set: 0.45233187079429626
loss_pred:0.039275769144296646, decouple_loss:0.03388453647494316
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533502459526062, gen p mean: 0.0, mean p set: 0.45020341873168945
The modified gen p mean: 0.45332857966423035, gen p mean: 0.0, mean p set: 0.4497832953929901
The modified gen p mean: 0.4561343491077423, gen p mean: 0.0, mean p set: 0.44948339462280273
loss_pred:0.040243782103061676, decouple_loss:0.03340267017483711
loss_pred:0.040259502828121185, decouple_loss:0.032824862748384476
loss_pred:0.03861621022224426, decouple_loss:0.03352316468954086
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4430713355541229, gen p mean: 0.0, mean p set: 0.45265159010887146
The modified gen p mean: 0.44309505820274353, gen p mean: 0.0, mean p set: 0.4523402154445648
The modified gen p mean: 0.4439059793949127, gen p mean: 0.0, mean p set: 0.45169880986213684
loss_pred:0.04008861258625984, decouple_loss:0.034975770860910416
loss_pred:0.040828410536050797, decouple_loss:0.03391269966959953
loss_pred:0.038603708148002625, decouple_loss:0.033196642994880676
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503079652786255, gen p mean: 0.0, mean p set: 0.45187583565711975
The modified gen p mean: 0.45315054059028625, gen p mean: 0.0, mean p set: 0.45207321643829346
The modified gen p mean: 0.4510587155818939, gen p mean: 0.0, mean p set: 0.45093992352485657
loss_pred:0.039856474846601486, decouple_loss:0.03306884691119194
loss_pred:0.040252868086099625, decouple_loss:0.033098652958869934
loss_pred:0.03991197049617767, decouple_loss:0.03370865434408188
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45297306776046753, gen p mean: 0.0, mean p set: 0.451677143573761
The modified gen p mean: 0.456222802400589, gen p mean: 0.0, mean p set: 0.45039013028144836
The modified gen p mean: 0.45249390602111816, gen p mean: 0.0, mean p set: 0.4511072635650635
loss_pred:0.03942732512950897, decouple_loss:0.03269287571310997
loss_pred:0.03989512845873833, decouple_loss:0.032155841588974
loss_pred:0.039351120591163635, decouple_loss:0.03275390341877937
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4389536678791046, gen p mean: 0.0, mean p set: 0.4501604735851288
The modified gen p mean: 0.4501204192638397, gen p mean: 0.0, mean p set: 0.44957494735717773
The modified gen p mean: 0.4463590979576111, gen p mean: 0.0, mean p set: 0.44961148500442505
loss_pred:0.036933645606040955, decouple_loss:0.03383469954133034loss_pred:0.03591570630669594, decouple_loss:0.033317681401968
loss_pred:0.037287741899490356, decouple_loss:0.03273575007915497
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44561681151390076, gen p mean: 0.0, mean p set: 0.450275719165802
The modified gen p mean: 0.4554709494113922, gen p mean: 0.0, mean p set: 0.4505756199359894
The modified gen p mean: 0.45392099022865295, gen p mean: 0.0, mean p set: 0.4500085711479187
loss_pred:0.0362650565803051, decouple_loss:0.03467288985848427
loss_pred:0.04068000614643097, decouple_loss:0.03348669782280922
loss_pred:0.039445627480745316, decouple_loss:0.03252379223704338
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.461421400308609, gen p mean: 0.0, mean p set: 0.4495929181575775
The modified gen p mean: 0.4572114944458008, gen p mean: 0.0, mean p set: 0.45206427574157715
The modified gen p mean: 0.45849141478538513, gen p mean: 0.0, mean p set: 0.45051491260528564
loss_pred:0.03806707262992859, decouple_loss:0.03322878107428551
loss_pred:0.03922221064567566, decouple_loss:0.033402375876903534
loss_pred:0.03760305792093277, decouple_loss:0.03300880268216133
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43969088792800903, gen p mean: 0.0, mean p set: 0.4502619802951813
The modified gen p mean: 0.44772788882255554, gen p mean: 0.0, mean p set: 0.44982221722602844
The modified gen p mean: 0.43817979097366333, gen p mean: 0.0, mean p set: 0.4495577812194824
loss_pred:0.03827399015426636, decouple_loss:0.032332643866539
loss_pred:0.04046241194009781, decouple_loss:0.03341774642467499
loss_pred:0.03770377114415169, decouple_loss:0.031735025346279144
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527301490306854, gen p mean: 0.0, mean p set: 0.45200085639953613
The modified gen p mean: 0.4461861550807953, gen p mean: 0.0, mean p set: 0.44958019256591797
The modified gen p mean: 0.45537805557250977, gen p mean: 0.0, mean p set: 0.4497336745262146
loss_pred:0.0381314717233181, decouple_loss:0.033278316259384155
loss_pred:0.0372769795358181, decouple_loss:0.03349453583359718
loss_pred:0.038318030536174774, decouple_loss:0.033403150737285614
2023-05-02 18:33:49 testing...
The modified gen p mean: 0.44687965512275696, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45595410466194153, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.45330190658569336, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.04169730469584465, decouple_loss:0.03886236250400543
loss_pred:0.039680223912000656, decouple_loss:0.037465911358594894
loss_pred:0.04051637277007103, decouple_loss:0.03615519404411316
WV_0_PC_0_EH_0_PS_40_6, loss: 0.042506031692028046, avg_mse: 0.04416576400399208
current test mse: 0.044166
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509832262992859, gen p mean: 0.0, mean p set: 0.45067763328552246
The modified gen p mean: 0.45460066199302673, gen p mean: 0.0, mean p set: 0.4503765404224396
loss_pred:0.038998525589704514, decouple_loss:0.03329306095838547
loss_pred:0.0385739803314209, decouple_loss:0.03161567822098732
The modified gen p mean: 0.45611199736595154, gen p mean: 0.0, mean p set: 0.4518806040287018
loss_pred:0.039133962243795395, decouple_loss:0.03268828243017197
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4621691405773163, gen p mean: 0.0, mean p set: 0.4503854513168335
The modified gen p mean: 0.46045026183128357, gen p mean: 0.0, mean p set: 0.4516032636165619
The modified gen p mean: 0.46033844351768494, gen p mean: 0.0, mean p set: 0.45006775856018066
loss_pred:0.035744450986385345, decouple_loss:0.032338447868824005
loss_pred:0.037645746022462845, decouple_loss:0.0321386381983757
loss_pred:0.037599120289087296, decouple_loss:0.032251108437776566
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43569672107696533, gen p mean: 0.0, mean p set: 0.4503614008426666
The modified gen p mean: 0.43698468804359436, gen p mean: 0.0, mean p set: 0.4512771964073181
The modified gen p mean: 0.4444267153739929, gen p mean: 0.0, mean p set: 0.44950950145721436
loss_pred:0.037766143679618835, decouple_loss:0.03245006129145622
loss_pred:0.039247043430805206, decouple_loss:0.035114586353302
loss_pred:0.038926322013139725, decouple_loss:0.03326570242643356
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
NaN value num: 0
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127832889556885, gen p mean: 0.0, mean p set: 0.4517611861228943
The modified gen p mean: 0.45056894421577454, gen p mean: 0.0, mean p set: 0.4519709050655365
The modified gen p mean: 0.45055902004241943, gen p mean: 0.0, mean p set: 0.45281848311424255
loss_pred:0.040776003152132034, decouple_loss:0.034269630908966064
loss_pred:0.038777101784944534, decouple_loss:0.03452271968126297
loss_pred:0.040775321424007416, decouple_loss:0.03453909233212471
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46032625436782837, gen p mean: 0.0, mean p set: 0.45058050751686096
The modified gen p mean: 0.4633016288280487, gen p mean: 0.0, mean p set: 0.45303085446357727
The modified gen p mean: 0.45898839831352234, gen p mean: 0.0, mean p set: 0.45231279730796814
loss_pred:0.04239673912525177, decouple_loss:0.038007620722055435
loss_pred:0.04063030332326889, decouple_loss:0.03693794086575508
loss_pred:0.04322738200426102, decouple_loss:0.03598658740520477
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43206989765167236, gen p mean: 0.0, mean p set: 0.45086249709129333
The modified gen p mean: 0.4367847144603729, gen p mean: 0.0, mean p set: 0.4527982771396637
The modified gen p mean: 0.4347899854183197, gen p mean: 0.0, mean p set: 0.4500918984413147
loss_pred:0.0408376045525074, decouple_loss:0.03550521656870842
loss_pred:0.042941004037857056, decouple_loss:0.03488362953066826
loss_pred:0.04117546230554581, decouple_loss:0.03557585924863815
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4571654200553894, gen p mean: 0.0, mean p set: 0.4520154595375061
The modified gen p mean: 0.45083409547805786, gen p mean: 0.0, mean p set: 0.45031243562698364
The modified gen p mean: 0.4501531720161438, gen p mean: 0.0, mean p set: 0.4508068561553955
loss_pred:0.04184052720665932, decouple_loss:0.03575662150979042
loss_pred:0.04023321717977524, decouple_loss:0.03653201833367348
loss_pred:0.041951414197683334, decouple_loss:0.035929638892412186
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4739772379398346, gen p mean: 0.0, mean p set: 0.45060768723487854
The modified gen p mean: 0.47250157594680786, gen p mean: 0.0, mean p set: 0.45144689083099365
The modified gen p mean: 0.47249460220336914, gen p mean: 0.0, mean p set: 0.45030614733695984
loss_pred:0.04182105138897896, decouple_loss:0.035601403564214706
loss_pred:0.043069783598184586, decouple_loss:0.03699640557169914
loss_pred:0.041675180196762085, decouple_loss:0.03579316288232803
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44271326065063477, gen p mean: 0.0, mean p set: 0.4514442980289459
The modified gen p mean: 0.4374994933605194, gen p mean: 0.0, mean p set: 0.45052459836006165
The modified gen p mean: 0.4332141578197479, gen p mean: 0.0, mean p set: 0.4508419334888458
loss_pred:0.04024240002036095, decouple_loss:0.035155195742845535
loss_pred:0.040373291820287704, decouple_loss:0.034472789615392685
loss_pred:0.04182329401373863, decouple_loss:0.03535979241132736
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497095048427582, gen p mean: 0.0, mean p set: 0.45163068175315857
The modified gen p mean: 0.44640111923217773, gen p mean: 0.0, mean p set: 0.4523555636405945
The modified gen p mean: 0.44434016942977905, gen p mean: 0.0, mean p set: 0.4512922167778015
loss_pred:0.04021956026554108, decouple_loss:0.034377068281173706
loss_pred:0.0396893136203289, decouple_loss:0.033983804285526276
loss_pred:0.041987672448158264, decouple_loss:0.03454092890024185
2023-05-02 18:38:14 testing...
The modified gen p mean: 0.4524089992046356, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4462336599826813, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45463666319847107, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.04002881422638893, decouple_loss:0.03488772362470627
loss_pred:0.04129268601536751, decouple_loss:0.03602323308587074
loss_pred:0.039141494780778885, decouple_loss:0.035932689905166626
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04193505644798279, avg_mse: 0.043438997119665146
current test mse: 0.043439
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454716295003891, gen p mean: 0.0, mean p set: 0.450173020362854
The modified gen p mean: 0.4575722813606262, gen p mean: 0.0, mean p set: 0.45178699493408203
loss_pred:0.04100392013788223, decouple_loss:0.0334196537733078
loss_pred:0.042296819388866425, decouple_loss:0.03299320116639137
The modified gen p mean: 0.45396679639816284, gen p mean: 0.0, mean p set: 0.45257672667503357
loss_pred:0.03880817070603371, decouple_loss:0.03322770819067955
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45849794149398804, gen p mean: 0.0, mean p set: 0.4517151117324829
The modified gen p mean: 0.4540066123008728, gen p mean: 0.0, mean p set: 0.45034801959991455
The modified gen p mean: 0.45394352078437805, gen p mean: 0.0, mean p set: 0.4524042010307312
loss_pred:0.039839886128902435, decouple_loss:0.0323527492582798
loss_pred:0.040966104716062546, decouple_loss:0.033457931131124496
loss_pred:0.039209116250276566, decouple_loss:0.03387898951768875
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522947669029236, gen p mean: 0.0, mean p set: 0.45013299584388733
The modified gen p mean: 0.4544287323951721, gen p mean: 0.0, mean p set: 0.4502009153366089
The modified gen p mean: 0.45314761996269226, gen p mean: 0.0, mean p set: 0.4512876868247986
loss_pred:0.040517695248126984, decouple_loss:0.03322775661945343
loss_pred:0.040626246482133865, decouple_loss:0.03487897291779518
loss_pred:0.041931625455617905, decouple_loss:0.03475808724761009
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4430708885192871, gen p mean: 0.0, mean p set: 0.45317062735557556
The modified gen p mean: 0.4449743926525116, gen p mean: 0.0, mean p set: 0.45201170444488525
The modified gen p mean: 0.44288966059684753, gen p mean: 0.0, mean p set: 0.4498090147972107
loss_pred:0.04098980873823166, decouple_loss:0.03299369290471077
loss_pred:0.03927008435130119, decouple_loss:0.03366914764046669
loss_pred:0.040845174342393875, decouple_loss:0.03469599783420563
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467833638191223, gen p mean: 0.0, mean p set: 0.45258599519729614
The modified gen p mean: 0.4460079073905945, gen p mean: 0.0, mean p set: 0.45058155059814453
The modified gen p mean: 0.4530034363269806, gen p mean: 0.0, mean p set: 0.451321005821228
loss_pred:0.04214999079704285, decouple_loss:0.03273579478263855
loss_pred:0.04107039421796799, decouple_loss:0.03284699097275734
loss_pred:0.039855536073446274, decouple_loss:0.03350495919585228
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45868462324142456, gen p mean: 0.0, mean p set: 0.4502132534980774
The modified gen p mean: 0.4625607430934906, gen p mean: 0.0, mean p set: 0.4522300362586975
The modified gen p mean: 0.45780959725379944, gen p mean: 0.0, mean p set: 0.452357679605484
loss_pred:0.039580363780260086, decouple_loss:0.034048762172460556
loss_pred:0.04228326678276062, decouple_loss:0.03349125757813454
loss_pred:0.03816474601626396, decouple_loss:0.033015165477991104
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456636905670166, gen p mean: 0.0, mean p set: 0.4505466818809509
The modified gen p mean: 0.45052051544189453, gen p mean: 0.0, mean p set: 0.4516952931880951
The modified gen p mean: 0.44874706864356995, gen p mean: 0.0, mean p set: 0.449899822473526
loss_pred:0.04205486923456192, decouple_loss:0.033983830362558365
loss_pred:0.039638977497816086, decouple_loss:0.033550240099430084
loss_pred:0.039817314594984055, decouple_loss:0.03269776329398155
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447051078081131, gen p mean: 0.0, mean p set: 0.4512638449668884
The modified gen p mean: 0.44704559445381165, gen p mean: 0.0, mean p set: 0.45189735293388367
The modified gen p mean: 0.45260515809059143, gen p mean: 0.0, mean p set: 0.45130112767219543
loss_pred:0.04041703790426254, decouple_loss:0.03254549950361252
loss_pred:0.04262319207191467, decouple_loss:0.03282107412815094
loss_pred:0.03981340676546097, decouple_loss:0.03267102688550949
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4556232988834381, gen p mean: 0.0, mean p set: 0.4501960873603821
The modified gen p mean: 0.4550243020057678, gen p mean: 0.0, mean p set: 0.45074760913848877
The modified gen p mean: 0.4531673789024353, gen p mean: 0.0, mean p set: 0.4511202275753021
loss_pred:0.04015851393342018, decouple_loss:0.03160762041807175
loss_pred:0.04046371579170227, decouple_loss:0.031992945820093155
loss_pred:0.040112026035785675, decouple_loss:0.03295966610312462
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4600421190261841, gen p mean: 0.0, mean p set: 0.4524562954902649
The modified gen p mean: 0.4546082317829132, gen p mean: 0.0, mean p set: 0.4512137174606323
The modified gen p mean: 0.46017757058143616, gen p mean: 0.0, mean p set: 0.45131561160087585
loss_pred:0.03883678466081619, decouple_loss:0.031840335577726364
loss_pred:0.04179507493972778, decouple_loss:0.03232473507523537
loss_pred:0.039443403482437134, decouple_loss:0.03268583491444588
2023-05-02 18:41:57 testing...
The modified gen p mean: 0.43651261925697327, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44311386346817017, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4448823034763336, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.04111744090914726, decouple_loss:0.036161888390779495
loss_pred:0.039953384548425674, decouple_loss:0.03477117419242859
loss_pred:0.03901636600494385, decouple_loss:0.03561918064951897
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04180493578314781, avg_mse: 0.043436262756586075
current test mse: 0.043436
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4439954161643982, gen p mean: 0.0, mean p set: 0.4522075653076172
The modified gen p mean: 0.44744443893432617, gen p mean: 0.0, mean p set: 0.45132210850715637
loss_pred:0.03889288380742073, decouple_loss:0.032550811767578125
loss_pred:0.04124588146805763, decouple_loss:0.03270476311445236
The modified gen p mean: 0.44291356205940247, gen p mean: 0.0, mean p set: 0.44992515444755554
loss_pred:0.040497489273548126, decouple_loss:0.032407961785793304
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43912938237190247, gen p mean: 0.0, mean p set: 0.4510760009288788
The modified gen p mean: 0.44706714153289795, gen p mean: 0.0, mean p set: 0.4519175887107849
The modified gen p mean: 0.4465530812740326, gen p mean: 0.0, mean p set: 0.45143812894821167
loss_pred:0.040329549461603165, decouple_loss:0.032220032066106796
loss_pred:0.03918725252151489, decouple_loss:0.03319289907813072
loss_pred:0.041099708527326584, decouple_loss:0.03229948878288269
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4657159745693207, gen p mean: 0.0, mean p set: 0.4512418508529663
The modified gen p mean: 0.46635520458221436, gen p mean: 0.0, mean p set: 0.45133206248283386
The modified gen p mean: 0.4605785012245178, gen p mean: 0.0, mean p set: 0.44991254806518555
loss_pred:0.03932172432541847, decouple_loss:0.031830813735723495
loss_pred:0.04023481905460358, decouple_loss:0.031755231320858
loss_pred:0.039823535829782486, decouple_loss:0.03303755074739456
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44297486543655396, gen p mean: 0.0, mean p set: 0.4477385878562927
The modified gen p mean: 0.44851434230804443, gen p mean: 0.0, mean p set: 0.44765228033065796
The modified gen p mean: 0.4527350962162018, gen p mean: 0.0, mean p set: 0.44739410281181335
loss_pred:0.04032298922538757, decouple_loss:0.035928331315517426
loss_pred:0.04056359454989433, decouple_loss:0.03678146377205849
loss_pred:0.041445378214120865, decouple_loss:0.0347561351954937
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4257601201534271, gen p mean: 0.0, mean p set: 0.4486168920993805
The modified gen p mean: 0.4245702624320984, gen p mean: 0.0, mean p set: 0.4471994936466217
The modified gen p mean: 0.42037808895111084, gen p mean: 0.0, mean p set: 0.44824886322021484
loss_pred:0.040465209633111954, decouple_loss:0.03502644598484039
loss_pred:0.040405791252851486, decouple_loss:0.03515114635229111
loss_pred:0.040103428065776825, decouple_loss:0.03579851612448692
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4579993784427643, gen p mean: 0.0, mean p set: 0.4490176737308502
The modified gen p mean: 0.45222124457359314, gen p mean: 0.0, mean p set: 0.4484791159629822
The modified gen p mean: 0.4645627439022064, gen p mean: 0.0, mean p set: 0.44675159454345703
loss_pred:0.040289800614118576, decouple_loss:0.03445090353488922
loss_pred:0.03893866762518883, decouple_loss:0.03678503632545471
loss_pred:0.04130687937140465, decouple_loss:0.03566104173660278
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46675148606300354, gen p mean: 0.0, mean p set: 0.44836175441741943
The modified gen p mean: 0.47370436787605286, gen p mean: 0.0, mean p set: 0.4485653042793274
The modified gen p mean: 0.4741648733615875, gen p mean: 0.0, mean p set: 0.4471812844276428
loss_pred:0.03925938159227371, decouple_loss:0.0377386212348938
loss_pred:0.03798309341073036, decouple_loss:0.03630004823207855
loss_pred:0.03964496776461601, decouple_loss:0.036308761686086655
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44119566679000854, gen p mean: 0.0, mean p set: 0.44798827171325684
The modified gen p mean: 0.44528311491012573, gen p mean: 0.0, mean p set: 0.4488696753978729
The modified gen p mean: 0.4407729208469391, gen p mean: 0.0, mean p set: 0.44779151678085327
loss_pred:0.038352467119693756, decouple_loss:0.034566670656204224
loss_pred:0.03900769352912903, decouple_loss:0.03487106412649155
loss_pred:0.04058631509542465, decouple_loss:0.03528203070163727
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42806366086006165, gen p mean: 0.0, mean p set: 0.4485274851322174
The modified gen p mean: 0.42223232984542847, gen p mean: 0.0, mean p set: 0.44772061705589294
The modified gen p mean: 0.4340376555919647, gen p mean: 0.0, mean p set: 0.44676467776298523
loss_pred:0.0410480834543705, decouple_loss:0.0336998850107193
loss_pred:0.04019675403833389, decouple_loss:0.03536904230713844
loss_pred:0.03896051645278931, decouple_loss:0.03470990061759949
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497207701206207, gen p mean: 0.0, mean p set: 0.4478895962238312
The modified gen p mean: 0.44930383563041687, gen p mean: 0.0, mean p set: 0.44790735840797424
The modified gen p mean: 0.4462796151638031, gen p mean: 0.0, mean p set: 0.44729676842689514
loss_pred:0.03825408220291138, decouple_loss:0.03304031118750572
loss_pred:0.039933398365974426, decouple_loss:0.033544477075338364
loss_pred:0.04022077098488808, decouple_loss:0.03453873097896576
2023-05-02 18:46:18 testing...
The modified gen p mean: 0.45483848452568054, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4480113983154297, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4567064940929413, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.039766959846019745, decouple_loss:0.03413822129368782
loss_pred:0.04080074653029442, decouple_loss:0.0358145609498024
loss_pred:0.03887951746582985, decouple_loss:0.035308837890625
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04157010465860367, avg_mse: 0.043089866638183594
current test mse: 0.04309
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4557916522026062, gen p mean: 0.0, mean p set: 0.4486429989337921
The modified gen p mean: 0.4577162265777588, gen p mean: 0.0, mean p set: 0.44937291741371155
loss_pred:0.040594432502985, decouple_loss:0.03461029753088951
loss_pred:0.03982411324977875, decouple_loss:0.03433259576559067
The modified gen p mean: 0.45323696732521057, gen p mean: 0.0, mean p set: 0.4479270875453949
loss_pred:0.03915592283010483, decouple_loss:0.033980704843997955
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4656299948692322, gen p mean: 0.0, mean p set: 0.4469953179359436
The modified gen p mean: 0.4652698338031769, gen p mean: 0.0, mean p set: 0.4486709535121918
The modified gen p mean: 0.4622723162174225, gen p mean: 0.0, mean p set: 0.4474049210548401
loss_pred:0.03856736049056053, decouple_loss:0.03374333679676056
loss_pred:0.03760600835084915, decouple_loss:0.03296933323144913
loss_pred:0.03995072469115257, decouple_loss:0.033520862460136414
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059481263160706, gen p mean: 0.0, mean p set: 0.44924309849739075
The modified gen p mean: 0.4504812955856323, gen p mean: 0.0, mean p set: 0.447108656167984
The modified gen p mean: 0.448623925447464, gen p mean: 0.0, mean p set: 0.4483802020549774
loss_pred:0.040171973407268524, decouple_loss:0.033905114978551865
loss_pred:0.03821078687906265, decouple_loss:0.033009279519319534
loss_pred:0.03920673951506615, decouple_loss:0.033025916665792465
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.421785444021225, gen p mean: 0.0, mean p set: 0.44756677746772766
The modified gen p mean: 0.42239436507225037, gen p mean: 0.0, mean p set: 0.44793838262557983
The modified gen p mean: 0.42859750986099243, gen p mean: 0.0, mean p set: 0.44877946376800537
loss_pred:0.040914759039878845, decouple_loss:0.037343837320804596
loss_pred:0.039746496826410294, decouple_loss:0.03780495375394821
loss_pred:0.03733130916953087, decouple_loss:0.03493712097406387
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44503116607666016, gen p mean: 0.0, mean p set: 0.4489628076553345
The modified gen p mean: 0.4457329511642456, gen p mean: 0.0, mean p set: 0.4477514624595642
The modified gen p mean: 0.4444993734359741, gen p mean: 0.0, mean p set: 0.44700247049331665
loss_pred:0.039500586688518524, decouple_loss:0.032982051372528076
loss_pred:0.03830479085445404, decouple_loss:0.03228795528411865
loss_pred:0.0399998240172863, decouple_loss:0.035163622349500656
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487185776233673, gen p mean: 0.0, mean p set: 0.4473215639591217
The modified gen p mean: 0.45434510707855225, gen p mean: 0.0, mean p set: 0.4476914703845978
The modified gen p mean: 0.4491886496543884, gen p mean: 0.0, mean p set: 0.44795170426368713
loss_pred:0.03912350535392761, decouple_loss:0.0349295511841774
loss_pred:0.03941897675395012, decouple_loss:0.032733671367168427
loss_pred:0.03958435356616974, decouple_loss:0.0355379618704319
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45884376764297485, gen p mean: 0.0, mean p set: 0.44756919145584106
The modified gen p mean: 0.4553840160369873, gen p mean: 0.0, mean p set: 0.44847285747528076
The modified gen p mean: 0.44983503222465515, gen p mean: 0.0, mean p set: 0.4484758675098419
loss_pred:0.04197102040052414, decouple_loss:0.03389327600598335
loss_pred:0.0394589938223362, decouple_loss:0.03231167420744896
loss_pred:0.038141101598739624, decouple_loss:0.034483861178159714
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4684128165245056, gen p mean: 0.0, mean p set: 0.44800853729248047
The modified gen p mean: 0.46594974398612976, gen p mean: 0.0, mean p set: 0.4479469656944275
The modified gen p mean: 0.46612539887428284, gen p mean: 0.0, mean p set: 0.4475267231464386
loss_pred:0.03913756459951401, decouple_loss:0.03455936908721924
loss_pred:0.03899878263473511, decouple_loss:0.0344829261302948
loss_pred:0.03996939957141876, decouple_loss:0.034271035343408585
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44957801699638367, gen p mean: 0.0, mean p set: 0.4481112062931061
The modified gen p mean: 0.44440874457359314, gen p mean: 0.0, mean p set: 0.44759422540664673
The modified gen p mean: 0.4496169984340668, gen p mean: 0.0, mean p set: 0.4470299780368805
loss_pred:0.0401163287460804, decouple_loss:0.034623295068740845
loss_pred:0.03913472220301628, decouple_loss:0.033983904868364334
loss_pred:0.03931191563606262, decouple_loss:0.03442362695932388
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4221355617046356, gen p mean: 0.0, mean p set: 0.44725939631462097
The modified gen p mean: 0.430288702249527, gen p mean: 0.0, mean p set: 0.4483778774738312
The modified gen p mean: 0.4267468750476837, gen p mean: 0.0, mean p set: 0.449184387922287
loss_pred:0.039194583892822266, decouple_loss:0.034254785627126694
loss_pred:0.03884830325841904, decouple_loss:0.03346799686551094
loss_pred:0.03921098634600639, decouple_loss:0.032679591327905655
2023-05-02 18:50:03 testing...
The modified gen p mean: 0.43601688742637634, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4438292384147644, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44178593158721924, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.04030513018369675, decouple_loss:0.03547011688351631
loss_pred:0.038321275264024734, decouple_loss:0.03496507555246353
loss_pred:0.039103634655475616, decouple_loss:0.034013040363788605
WV_0_PC_0_EH_0_PS_40_6, loss: 0.040984150022268295, avg_mse: 0.04242178797721863
current test mse: 0.042422
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4325464367866516, gen p mean: 0.0, mean p set: 0.44827136397361755
The modified gen p mean: 0.4409794509410858, gen p mean: 0.0, mean p set: 0.4475743770599365
loss_pred:0.03770367428660393, decouple_loss:0.03491866961121559
loss_pred:0.04067503288388252, decouple_loss:0.03418751433491707
The modified gen p mean: 0.43574294447898865, gen p mean: 0.0, mean p set: 0.44926023483276367
loss_pred:0.039392173290252686, decouple_loss:0.032945603132247925
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4636111557483673, gen p mean: 0.0, mean p set: 0.4474024176597595
The modified gen p mean: 0.46610429883003235, gen p mean: 0.0, mean p set: 0.4493965804576874
The modified gen p mean: 0.4558190703392029, gen p mean: 0.0, mean p set: 0.4478025436401367
loss_pred:0.038761287927627563, decouple_loss:0.033707860857248306
loss_pred:0.03808203712105751, decouple_loss:0.03371959179639816
loss_pred:0.03834144398570061, decouple_loss:0.03386134281754494
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4550727903842926, gen p mean: 0.0, mean p set: 0.4482361972332001
The modified gen p mean: 0.4542035758495331, gen p mean: 0.0, mean p set: 0.44677630066871643
The modified gen p mean: 0.4547421932220459, gen p mean: 0.0, mean p set: 0.44832685589790344
loss_pred:0.03897295147180557, decouple_loss:0.03324010968208313
loss_pred:0.03972894698381424, decouple_loss:0.03326968848705292
loss_pred:0.03847097232937813, decouple_loss:0.033372581005096436
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45383718609809875, gen p mean: 0.0, mean p set: 0.44860655069351196
The modified gen p mean: 0.4495384395122528, gen p mean: 0.0, mean p set: 0.4472792148590088
The modified gen p mean: 0.44953882694244385, gen p mean: 0.0, mean p set: 0.44812917709350586
loss_pred:0.0397757850587368, decouple_loss:0.033261124044656754
loss_pred:0.03883880749344826, decouple_loss:0.032977622002363205
loss_pred:0.038243867456912994, decouple_loss:0.03260635957121849
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45609012246131897, gen p mean: 0.0, mean p set: 0.4485950767993927
The modified gen p mean: 0.45669710636138916, gen p mean: 0.0, mean p set: 0.44805845618247986
The modified gen p mean: 0.45780330896377563, gen p mean: 0.0, mean p set: 0.4483700692653656
loss_pred:0.03828160837292671, decouple_loss:0.03316425904631615
loss_pred:0.03820299729704857, decouple_loss:0.033124543726444244
loss_pred:0.03677218034863472, decouple_loss:0.03379266709089279
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757142663002014, gen p mean: 0.0, mean p set: 0.44856393337249756
The modified gen p mean: 0.43806469440460205, gen p mean: 0.0, mean p set: 0.4477936327457428
The modified gen p mean: 0.44050490856170654, gen p mean: 0.0, mean p set: 0.44863179326057434
loss_pred:0.03961664438247681, decouple_loss:0.03569619730114937
loss_pred:0.03740629553794861, decouple_loss:0.03347667306661606
loss_pred:0.03684201464056969, decouple_loss:0.033733002841472626
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4340931177139282, gen p mean: 0.0, mean p set: 0.449308842420578
The modified gen p mean: 0.4454665184020996, gen p mean: 0.0, mean p set: 0.4499603509902954
The modified gen p mean: 0.4341178834438324, gen p mean: 0.0, mean p set: 0.4476364552974701
loss_pred:0.03687959909439087, decouple_loss:0.03353187069296837
loss_pred:0.03836841881275177, decouple_loss:0.03417836129665375
loss_pred:0.039513953030109406, decouple_loss:0.03387165814638138
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45499345660209656, gen p mean: 0.0, mean p set: 0.4495594799518585
The modified gen p mean: 0.45123976469039917, gen p mean: 0.0, mean p set: 0.4487749934196472
The modified gen p mean: 0.45021918416023254, gen p mean: 0.0, mean p set: 0.44775503873825073
loss_pred:0.03774133697152138, decouple_loss:0.0344163179397583
loss_pred:0.039220549166202545, decouple_loss:0.03306271880865097
loss_pred:0.038614485412836075, decouple_loss:0.03183313459157944
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531005024909973, gen p mean: 0.0, mean p set: 0.4480154812335968
The modified gen p mean: 0.45436081290245056, gen p mean: 0.0, mean p set: 0.45010778307914734
The modified gen p mean: 0.4610055088996887, gen p mean: 0.0, mean p set: 0.44824254512786865
loss_pred:0.037018563598394394, decouple_loss:0.03207707032561302
loss_pred:0.03749045729637146, decouple_loss:0.03281985968351364
loss_pred:0.040616992861032486, decouple_loss:0.035061489790678024
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4365353286266327, gen p mean: 0.0, mean p set: 0.44813597202301025
The modified gen p mean: 0.4415648877620697, gen p mean: 0.0, mean p set: 0.4482676684856415
The modified gen p mean: 0.4353340268135071, gen p mean: 0.0, mean p set: 0.44816869497299194
loss_pred:0.0391867458820343, decouple_loss:0.03164805471897125
loss_pred:0.04003564268350601, decouple_loss:0.03419595956802368
loss_pred:0.03876565769314766, decouple_loss:0.03276447579264641
2023-05-02 18:54:24 testing...
The modified gen p mean: 0.44321879744529724, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45117372274398804, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4490440785884857, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.039944399148225784, decouple_loss:0.03365999832749367
loss_pred:0.03800741210579872, decouple_loss:0.03303567320108414
loss_pred:0.03889695182442665, decouple_loss:0.032405514270067215
WV_0_PC_0_EH_0_PS_40_6, loss: 0.040601275861263275, avg_mse: 0.04220503196120262
current test mse: 0.042205
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839346408843994, gen p mean: 0.0, mean p set: 0.4475235044956207
The modified gen p mean: 0.45163771510124207, gen p mean: 0.0, mean p set: 0.4490176737308502
loss_pred:0.03776512295007706, decouple_loss:0.0325162298977375
loss_pred:0.03823836147785187, decouple_loss:0.033576276153326035
The modified gen p mean: 0.45108357071876526, gen p mean: 0.0, mean p set: 0.44814783334732056
loss_pred:0.039700400084257126, decouple_loss:0.03351842984557152
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4651561379432678, gen p mean: 0.0, mean p set: 0.4480615258216858
The modified gen p mean: 0.4638883173465729, gen p mean: 0.0, mean p set: 0.44836780428886414
The modified gen p mean: 0.4616963863372803, gen p mean: 0.0, mean p set: 0.4481693506240845
loss_pred:0.038153525441884995, decouple_loss:0.0325995497405529
loss_pred:0.04062721133232117, decouple_loss:0.03296737000346184
loss_pred:0.03707520663738251, decouple_loss:0.03196973726153374
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469374716281891, gen p mean: 0.0, mean p set: 0.44821614027023315
The modified gen p mean: 0.4508695900440216, gen p mean: 0.0, mean p set: 0.4478708505630493
The modified gen p mean: 0.44169893860816956, gen p mean: 0.0, mean p set: 0.44753962755203247
loss_pred:0.03953059762716293, decouple_loss:0.0330880731344223
loss_pred:0.038512371480464935, decouple_loss:0.03306470811367035
loss_pred:0.038065891712903976, decouple_loss:0.034047070890665054
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.432524710893631, gen p mean: 0.0, mean p set: 0.4476613700389862
The modified gen p mean: 0.43174317479133606, gen p mean: 0.0, mean p set: 0.44859078526496887
The modified gen p mean: 0.43551355600357056, gen p mean: 0.0, mean p set: 0.44798195362091064
loss_pred:0.040119949728250504, decouple_loss:0.033381618559360504
loss_pred:0.03667988255620003, decouple_loss:0.03189961612224579
loss_pred:0.03845532238483429, decouple_loss:0.03194865584373474
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4601776599884033, gen p mean: 0.0, mean p set: 0.4491148293018341
The modified gen p mean: 0.4544614851474762, gen p mean: 0.0, mean p set: 0.44845813512802124
The modified gen p mean: 0.4526325464248657, gen p mean: 0.0, mean p set: 0.4481755197048187
loss_pred:0.03748053312301636, decouple_loss:0.03208267316222191
loss_pred:0.03658849373459816, decouple_loss:0.03255559504032135
loss_pred:0.037210315465927124, decouple_loss:0.03205602243542671
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46224015951156616, gen p mean: 0.0, mean p set: 0.4482842683792114
The modified gen p mean: 0.4641559422016144, gen p mean: 0.0, mean p set: 0.44822585582733154
The modified gen p mean: 0.46278849244117737, gen p mean: 0.0, mean p set: 0.44768205285072327
loss_pred:0.03998105600476265, decouple_loss:0.03274359181523323
loss_pred:0.03996139392256737, decouple_loss:0.03270546719431877
loss_pred:0.04041886329650879, decouple_loss:0.03233186900615692
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43869566917419434, gen p mean: 0.0, mean p set: 0.4476836025714874
The modified gen p mean: 0.4356699287891388, gen p mean: 0.0, mean p set: 0.4479523003101349
The modified gen p mean: 0.4365251660346985, gen p mean: 0.0, mean p set: 0.4491144120693207
loss_pred:0.03822079673409462, decouple_loss:0.03134384751319885
loss_pred:0.04019763693213463, decouple_loss:0.032478466629981995
loss_pred:0.038675762712955475, decouple_loss:0.032589055597782135
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43756768107414246, gen p mean: 0.0, mean p set: 0.4475933611392975
The modified gen p mean: 0.43425437808036804, gen p mean: 0.0, mean p set: 0.44701725244522095
The modified gen p mean: 0.43940719962120056, gen p mean: 0.0, mean p set: 0.44905948638916016
loss_pred:0.039927348494529724, decouple_loss:0.03222016245126724
loss_pred:0.038955044001340866, decouple_loss:0.033443138003349304
loss_pred:0.039428167045116425, decouple_loss:0.033026281744241714
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4621961712837219, gen p mean: 0.0, mean p set: 0.4483305513858795
The modified gen p mean: 0.4583168625831604, gen p mean: 0.0, mean p set: 0.4486410617828369
The modified gen p mean: 0.4646736979484558, gen p mean: 0.0, mean p set: 0.4478912055492401
loss_pred:0.03705473616719246, decouple_loss:0.03312182426452637loss_pred:0.03934842720627785, decouple_loss:0.032016292214393616
loss_pred:0.039287641644477844, decouple_loss:0.032170239835977554
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536627531051636, gen p mean: 0.0, mean p set: 0.4485217034816742
The modified gen p mean: 0.4537939429283142, gen p mean: 0.0, mean p set: 0.4471684396266937
The modified gen p mean: 0.4546346962451935, gen p mean: 0.0, mean p set: 0.4476158618927002
loss_pred:0.03653838112950325, decouple_loss:0.03320853039622307
loss_pred:0.03990934416651726, decouple_loss:0.03166034817695618
loss_pred:0.03944230079650879, decouple_loss:0.032650090754032135
2023-05-02 18:58:07 testing...
The modified gen p mean: 0.4325810670852661, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44122374057769775, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.438385009765625, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03979328274726868, decouple_loss:0.03388815373182297
loss_pred:0.03783683851361275, decouple_loss:0.03289517015218735
loss_pred:0.038629353046417236, decouple_loss:0.0319950208067894
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0403994657099247, avg_mse: 0.0420110709965229
current test mse: 0.042011
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4366484582424164, gen p mean: 0.0, mean p set: 0.44918543100357056
The modified gen p mean: 0.43367764353752136, gen p mean: 0.0, mean p set: 0.44780364632606506
loss_pred:0.036832794547080994, decouple_loss:0.033092863857746124
loss_pred:0.03778868541121483, decouple_loss:0.0324559360742569
The modified gen p mean: 0.4365493059158325, gen p mean: 0.0, mean p set: 0.44783204793930054
loss_pred:0.039189551025629044, decouple_loss:0.031995657831430435
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4425113797187805, gen p mean: 0.0, mean p set: 0.4473148286342621
The modified gen p mean: 0.443324476480484, gen p mean: 0.0, mean p set: 0.4473792016506195
The modified gen p mean: 0.4518587589263916, gen p mean: 0.0, mean p set: 0.4495725929737091
loss_pred:0.03821789473295212, decouple_loss:0.03176245465874672
loss_pred:0.038159530609846115, decouple_loss:0.0320127010345459
loss_pred:0.03822983428835869, decouple_loss:0.03255242854356766
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4620976448059082, gen p mean: 0.0, mean p set: 0.4475088119506836
The modified gen p mean: 0.45901986956596375, gen p mean: 0.0, mean p set: 0.44842052459716797
The modified gen p mean: 0.4638078808784485, gen p mean: 0.0, mean p set: 0.44845467805862427
loss_pred:0.038992948830127716, decouple_loss:0.03335265442728996
loss_pred:0.03845126926898956, decouple_loss:0.031137317419052124
loss_pred:0.03704749792814255, decouple_loss:0.032052524387836456
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
NaN value num: 0
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45993927121162415, gen p mean: 0.0, mean p set: 0.4511275291442871
The modified gen p mean: 0.4512263834476471, gen p mean: 0.0, mean p set: 0.45204612612724304
The modified gen p mean: 0.46044400334358215, gen p mean: 0.0, mean p set: 0.45119786262512207
loss_pred:0.03831302002072334, decouple_loss:0.034586019814014435
loss_pred:0.03990865871310234, decouple_loss:0.03711957857012749
loss_pred:0.040264591574668884, decouple_loss:0.03729638829827309
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43371158838272095, gen p mean: 0.0, mean p set: 0.45318475365638733
The modified gen p mean: 0.44096148014068604, gen p mean: 0.0, mean p set: 0.45202142000198364
The modified gen p mean: 0.43944042921066284, gen p mean: 0.0, mean p set: 0.4537709653377533
loss_pred:0.03764805570244789, decouple_loss:0.035022251307964325
loss_pred:0.04036792367696762, decouple_loss:0.035576388239860535
loss_pred:0.03896208852529526, decouple_loss:0.03549323230981827
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071277022361755, gen p mean: 0.0, mean p set: 0.45165136456489563The modified gen p mean: 0.4465346932411194, gen p mean: 0.0, mean p set: 0.45226994156837463
The modified gen p mean: 0.4492267668247223, gen p mean: 0.0, mean p set: 0.45069798827171326
loss_pred:0.038656558841466904, decouple_loss:0.03392062708735466
loss_pred:0.03782990947365761, decouple_loss:0.03437738120555878
loss_pred:0.03738139197230339, decouple_loss:0.03420823812484741
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4567527770996094, gen p mean: 0.0, mean p set: 0.45226770639419556
The modified gen p mean: 0.45942968130111694, gen p mean: 0.0, mean p set: 0.45118778944015503
The modified gen p mean: 0.45759087800979614, gen p mean: 0.0, mean p set: 0.4543396830558777
loss_pred:0.038273103535175323, decouple_loss:0.03351549059152603
loss_pred:0.03893446549773216, decouple_loss:0.035005658864974976
loss_pred:0.03882576897740364, decouple_loss:0.034241437911987305
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45177745819091797, gen p mean: 0.0, mean p set: 0.4510461390018463
The modified gen p mean: 0.4530790448188782, gen p mean: 0.0, mean p set: 0.45037490129470825
The modified gen p mean: 0.4497310221195221, gen p mean: 0.0, mean p set: 0.4517037868499756
loss_pred:0.04014831781387329, decouple_loss:0.035249512642621994
loss_pred:0.04081939905881882, decouple_loss:0.03449048846960068
loss_pred:0.04070381820201874, decouple_loss:0.0349310003221035
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45919591188430786, gen p mean: 0.0, mean p set: 0.4516591429710388
The modified gen p mean: 0.4591486155986786, gen p mean: 0.0, mean p set: 0.4511306881904602
The modified gen p mean: 0.4653354287147522, gen p mean: 0.0, mean p set: 0.45121118426322937
loss_pred:0.03897184506058693, decouple_loss:0.034807562828063965
loss_pred:0.038067691028118134, decouple_loss:0.033154286444187164
loss_pred:0.03972974419593811, decouple_loss:0.03508251905441284
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4442766010761261, gen p mean: 0.0, mean p set: 0.45195040106773376
The modified gen p mean: 0.4424574077129364, gen p mean: 0.0, mean p set: 0.4517228305339813
The modified gen p mean: 0.44363299012184143, gen p mean: 0.0, mean p set: 0.45274466276168823
loss_pred:0.03808467835187912, decouple_loss:0.034088268876075745
loss_pred:0.04026173800230026, decouple_loss:0.03468739241361618
loss_pred:0.04062683507800102, decouple_loss:0.033775445073843
2023-05-02 19:02:44 testing...
The modified gen p mean: 0.4467710256576538, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44142183661460876, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4491739571094513, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03874348849058151, decouple_loss:0.03429223969578743
loss_pred:0.03972708433866501, decouple_loss:0.03611685708165169
loss_pred:0.03785181790590286, decouple_loss:0.0351969338953495
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04053422808647156, avg_mse: 0.04217880964279175
current test mse: 0.042179
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4442155957221985, gen p mean: 0.0, mean p set: 0.45159485936164856
loss_pred:0.037627212703228, decouple_loss:0.0316777341067791
The modified gen p mean: 0.44510364532470703, gen p mean: 0.0, mean p set: 0.45162433385849
loss_pred:0.04054778069257736, decouple_loss:0.03320895507931709
The modified gen p mean: 0.4517306387424469, gen p mean: 0.0, mean p set: 0.4527277946472168
loss_pred:0.04079287499189377, decouple_loss:0.032979849725961685
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4573972523212433, gen p mean: 0.0, mean p set: 0.45222529768943787
The modified gen p mean: 0.45783698558807373, gen p mean: 0.0, mean p set: 0.45208099484443665
The modified gen p mean: 0.45827776193618774, gen p mean: 0.0, mean p set: 0.4518592655658722
loss_pred:0.040350064635276794, decouple_loss:0.03303360193967819
loss_pred:0.03970806673169136, decouple_loss:0.03287094831466675
loss_pred:0.04022656008601189, decouple_loss:0.032753124833106995
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45580556988716125, gen p mean: 0.0, mean p set: 0.4524966776371002
The modified gen p mean: 0.4542844593524933, gen p mean: 0.0, mean p set: 0.45292118191719055
The modified gen p mean: 0.45296064019203186, gen p mean: 0.0, mean p set: 0.4515587389469147
loss_pred:0.04012082889676094, decouple_loss:0.03236815333366394
loss_pred:0.040033094584941864, decouple_loss:0.0335058867931366
loss_pred:0.03860436752438545, decouple_loss:0.03277023881673813
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44624829292297363, gen p mean: 0.0, mean p set: 0.45254722237586975
The modified gen p mean: 0.4458901584148407, gen p mean: 0.0, mean p set: 0.45209240913391113
The modified gen p mean: 0.4442870318889618, gen p mean: 0.0, mean p set: 0.45301714539527893
loss_pred:0.03748157247900963, decouple_loss:0.03303878754377365
loss_pred:0.03751632943749428, decouple_loss:0.03283971920609474
loss_pred:0.040168821811676025, decouple_loss:0.03385818004608154
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498407542705536, gen p mean: 0.0, mean p set: 0.45287254452705383
The modified gen p mean: 0.4525529146194458, gen p mean: 0.0, mean p set: 0.45098650455474854
The modified gen p mean: 0.4530302882194519, gen p mean: 0.0, mean p set: 0.4517951011657715
loss_pred:0.03931692615151405, decouple_loss:0.03440374508500099
loss_pred:0.03689084202051163, decouple_loss:0.031818896532058716
loss_pred:0.03964410349726677, decouple_loss:0.032450780272483826
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45271730422973633, gen p mean: 0.0, mean p set: 0.4516381621360779
The modified gen p mean: 0.453567236661911, gen p mean: 0.0, mean p set: 0.4518997073173523
The modified gen p mean: 0.4533523619174957, gen p mean: 0.0, mean p set: 0.4511549472808838
loss_pred:0.03956346958875656, decouple_loss:0.031780906021595
loss_pred:0.03991139680147171, decouple_loss:0.031176788732409477
loss_pred:0.0393068864941597, decouple_loss:0.03163100779056549
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494393765926361, gen p mean: 0.0, mean p set: 0.4530346095561981
The modified gen p mean: 0.4489542841911316, gen p mean: 0.0, mean p set: 0.4537568688392639
The modified gen p mean: 0.4492050111293793, gen p mean: 0.0, mean p set: 0.45445236563682556
loss_pred:0.03860735520720482, decouple_loss:0.03234916180372238
loss_pred:0.038222432136535645, decouple_loss:0.032415494322776794
loss_pred:0.03817638009786606, decouple_loss:0.03283551335334778
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44627299904823303, gen p mean: 0.0, mean p set: 0.45160651206970215
The modified gen p mean: 0.45120084285736084, gen p mean: 0.0, mean p set: 0.4524519443511963
The modified gen p mean: 0.44712790846824646, gen p mean: 0.0, mean p set: 0.45127442479133606
loss_pred:0.04001989588141441, decouple_loss:0.0320635549724102
loss_pred:0.04002248868346214, decouple_loss:0.033378615975379944
loss_pred:0.038705844432115555, decouple_loss:0.03470699116587639
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46151211857795715, gen p mean: 0.0, mean p set: 0.4519197940826416
The modified gen p mean: 0.45964744687080383, gen p mean: 0.0, mean p set: 0.4506949186325073
The modified gen p mean: 0.45538532733917236, gen p mean: 0.0, mean p set: 0.4539199471473694
loss_pred:0.03875875100493431, decouple_loss:0.03255061060190201
loss_pred:0.04026113077998161, decouple_loss:0.031305503100156784
loss_pred:0.03683733567595482, decouple_loss:0.031049855053424835
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46218612790107727, gen p mean: 0.0, mean p set: 0.453695684671402
The modified gen p mean: 0.4600405991077423, gen p mean: 0.0, mean p set: 0.45223820209503174
loss_pred:0.03741194307804108, decouple_loss:0.03323573246598244
The modified gen p mean: 0.46172773838043213, gen p mean: 0.0, mean p set: 0.451918363571167
loss_pred:0.038266561925411224, decouple_loss:0.03230147063732147
loss_pred:0.039297908544540405, decouple_loss:0.03217187896370888
2023-05-02 19:06:27 testing...
The modified gen p mean: 0.43500831723213196, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4399982988834381, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44329148530960083, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.040048953145742416, decouple_loss:0.036303453147411346
loss_pred:0.03900572657585144, decouple_loss:0.03539561480283737
loss_pred:0.03803768754005432, decouple_loss:0.03586530685424805
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04082353040575981, avg_mse: 0.04269978031516075
current test mse: 0.0427
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44270071387290955, gen p mean: 0.0, mean p set: 0.4520830810070038
The modified gen p mean: 0.4432746469974518, gen p mean: 0.0, mean p set: 0.45127376914024353
loss_pred:0.039699237793684006, decouple_loss:0.03201793506741524
loss_pred:0.03960191458463669, decouple_loss:0.031206758692860603
The modified gen p mean: 0.44277435541152954, gen p mean: 0.0, mean p set: 0.45193958282470703
loss_pred:0.037714920938014984, decouple_loss:0.030976947396993637
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4419834613800049, gen p mean: 0.0, mean p set: 0.4520838260650635
The modified gen p mean: 0.445546954870224, gen p mean: 0.0, mean p set: 0.45274418592453003
The modified gen p mean: 0.44353437423706055, gen p mean: 0.0, mean p set: 0.45064112544059753
loss_pred:0.03721053898334503, decouple_loss:0.03171933814883232loss_pred:0.03865855187177658, decouple_loss:0.03248107060790062
loss_pred:0.039282530546188354, decouple_loss:0.03152027726173401
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
NaN value num: 0
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4615212380886078, gen p mean: 0.0, mean p set: 0.44970032572746277
The modified gen p mean: 0.46172669529914856, gen p mean: 0.0, mean p set: 0.4499170780181885
The modified gen p mean: 0.4615710973739624, gen p mean: 0.0, mean p set: 0.44953596591949463
loss_pred:0.03974273428320885, decouple_loss:0.034799519926309586
loss_pred:0.04060160741209984, decouple_loss:0.03665737435221672
loss_pred:0.039837371557950974, decouple_loss:0.03636682778596878
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4544852674007416, gen p mean: 0.0, mean p set: 0.4489997923374176
The modified gen p mean: 0.45431965589523315, gen p mean: 0.0, mean p set: 0.44917601346969604
The modified gen p mean: 0.4519973695278168, gen p mean: 0.0, mean p set: 0.45010536909103394
loss_pred:0.04074336960911751, decouple_loss:0.03687456622719765
loss_pred:0.04158014804124832, decouple_loss:0.03505545109510422
loss_pred:0.04121437296271324, decouple_loss:0.03483656421303749
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4425026476383209, gen p mean: 0.0, mean p set: 0.4491897523403168
The modified gen p mean: 0.4454991817474365, gen p mean: 0.0, mean p set: 0.4490341246128082
The modified gen p mean: 0.4371790587902069, gen p mean: 0.0, mean p set: 0.4495847821235657
loss_pred:0.040305763483047485, decouple_loss:0.03617473319172859
loss_pred:0.03875017166137695, decouple_loss:0.03708117455244064
loss_pred:0.03880688175559044, decouple_loss:0.035807397216558456
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470256268978119, gen p mean: 0.0, mean p set: 0.4494785666465759
The modified gen p mean: 0.4496201276779175, gen p mean: 0.0, mean p set: 0.4494294226169586
The modified gen p mean: 0.4484925866127014, gen p mean: 0.0, mean p set: 0.44917726516723633
loss_pred:0.04150890186429024, decouple_loss:0.03514179214835167
loss_pred:0.04129767790436745, decouple_loss:0.03366655483841896
loss_pred:0.03991199657320976, decouple_loss:0.03492535650730133
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450143426656723, gen p mean: 0.0, mean p set: 0.4488857388496399
The modified gen p mean: 0.45182526111602783, gen p mean: 0.0, mean p set: 0.4480692446231842
The modified gen p mean: 0.4505361020565033, gen p mean: 0.0, mean p set: 0.449830561876297
loss_pred:0.04085845127701759, decouple_loss:0.03485545516014099
loss_pred:0.04000517725944519, decouple_loss:0.03488393872976303
loss_pred:0.04058410972356796, decouple_loss:0.034585800021886826
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4413377642631531, gen p mean: 0.0, mean p set: 0.44833892583847046
The modified gen p mean: 0.43556442856788635, gen p mean: 0.0, mean p set: 0.4500678777694702
The modified gen p mean: 0.4357694387435913, gen p mean: 0.0, mean p set: 0.45029157400131226
loss_pred:0.04085380956530571, decouple_loss:0.033220939338207245
loss_pred:0.0394124798476696, decouple_loss:0.03422439470887184
loss_pred:0.040333785116672516, decouple_loss:0.032980743795633316
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4559541344642639, gen p mean: 0.0, mean p set: 0.45006415247917175
The modified gen p mean: 0.45764219760894775, gen p mean: 0.0, mean p set: 0.4481346309185028
The modified gen p mean: 0.45401203632354736, gen p mean: 0.0, mean p set: 0.44996798038482666
loss_pred:0.04220098257064819, decouple_loss:0.03355909511446953
loss_pred:0.04096003994345665, decouple_loss:0.033164288848638535
loss_pred:0.04036202281713486, decouple_loss:0.03288126364350319
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46361061930656433, gen p mean: 0.0, mean p set: 0.44888877868652344
The modified gen p mean: 0.46690812706947327, gen p mean: 0.0, mean p set: 0.4495871365070343
The modified gen p mean: 0.46776285767555237, gen p mean: 0.0, mean p set: 0.44915536046028137
loss_pred:0.03923048824071884, decouple_loss:0.03348235413432121
loss_pred:0.04111972823739052, decouple_loss:0.03312581405043602
loss_pred:0.04065011814236641, decouple_loss:0.03341338410973549
2023-05-02 19:10:53 testing...
The modified gen p mean: 0.4437791109085083, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4489208161830902, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4515554904937744, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03949805721640587, decouple_loss:0.03535700589418411
loss_pred:0.03836281970143318, decouple_loss:0.033671386539936066
loss_pred:0.037342317402362823, decouple_loss:0.03421051427721977
WV_0_PC_0_EH_0_PS_40_6, loss: 0.040121715515851974, avg_mse: 0.041674353182315826
current test mse: 0.041674
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4413394033908844, gen p mean: 0.0, mean p set: 0.45065340399742126
The modified gen p mean: 0.4509514272212982, gen p mean: 0.0, mean p set: 0.44904592633247375
loss_pred:0.03952769935131073, decouple_loss:0.03638414293527603
loss_pred:0.04139196127653122, decouple_loss:0.03323056176304817
The modified gen p mean: 0.4455156624317169, gen p mean: 0.0, mean p set: 0.4502682387828827
loss_pred:0.039710696786642075, decouple_loss:0.03461170941591263
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484668970108032, gen p mean: 0.0, mean p set: 0.4489073157310486
The modified gen p mean: 0.45152580738067627, gen p mean: 0.0, mean p set: 0.44949114322662354
The modified gen p mean: 0.4496288597583771, gen p mean: 0.0, mean p set: 0.45080211758613586
loss_pred:0.040325574576854706, decouple_loss:0.0323532372713089
loss_pred:0.039387498050928116, decouple_loss:0.033759575337171555
loss_pred:0.040137309581041336, decouple_loss:0.035589758306741714
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44581338763237, gen p mean: 0.0, mean p set: 0.4479367434978485
The modified gen p mean: 0.44163942337036133, gen p mean: 0.0, mean p set: 0.44991692900657654
The modified gen p mean: 0.4417881965637207, gen p mean: 0.0, mean p set: 0.4474814832210541
loss_pred:0.03901216760277748, decouple_loss:0.03408556804060936
loss_pred:0.04166024550795555, decouple_loss:0.03393569588661194
loss_pred:0.039485860615968704, decouple_loss:0.0338832326233387
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44361621141433716, gen p mean: 0.0, mean p set: 0.449788898229599
The modified gen p mean: 0.4452419877052307, gen p mean: 0.0, mean p set: 0.44847843050956726
The modified gen p mean: 0.44765573740005493, gen p mean: 0.0, mean p set: 0.44778892397880554
loss_pred:0.040442321449518204, decouple_loss:0.033505406230688095
loss_pred:0.03951886668801308, decouple_loss:0.033295076340436935
loss_pred:0.03972969576716423, decouple_loss:0.033585112541913986
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45710790157318115, gen p mean: 0.0, mean p set: 0.4484367072582245
The modified gen p mean: 0.4515487253665924, gen p mean: 0.0, mean p set: 0.4474412202835083
The modified gen p mean: 0.45513710379600525, gen p mean: 0.0, mean p set: 0.4505000710487366
loss_pred:0.03966657444834709, decouple_loss:0.03289083391427994
loss_pred:0.03963996842503548, decouple_loss:0.03250085189938545
loss_pred:0.04013565182685852, decouple_loss:0.03342582657933235
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4557707607746124, gen p mean: 0.0, mean p set: 0.44745081663131714
The modified gen p mean: 0.45992034673690796, gen p mean: 0.0, mean p set: 0.4482865631580353
The modified gen p mean: 0.4518755078315735, gen p mean: 0.0, mean p set: 0.45066434144973755
loss_pred:0.039291489869356155, decouple_loss:0.0320182666182518
loss_pred:0.039935868233442307, decouple_loss:0.031500063836574554
loss_pred:0.03942527621984482, decouple_loss:0.03404107317328453
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4445528984069824, gen p mean: 0.0, mean p set: 0.4492320418357849
The modified gen p mean: 0.44975507259368896, gen p mean: 0.0, mean p set: 0.45002689957618713
The modified gen p mean: 0.4432510435581207, gen p mean: 0.0, mean p set: 0.4498618543148041
loss_pred:0.039246104657649994, decouple_loss:0.03141653537750244
loss_pred:0.040335383266210556, decouple_loss:0.032896738499403
loss_pred:0.037949033081531525, decouple_loss:0.03182568401098251
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44405463337898254, gen p mean: 0.0, mean p set: 0.4479937255382538
The modified gen p mean: 0.4437430500984192, gen p mean: 0.0, mean p set: 0.44925177097320557
The modified gen p mean: 0.4447830617427826, gen p mean: 0.0, mean p set: 0.45002496242523193
loss_pred:0.038661181926727295, decouple_loss:0.03155351057648659
loss_pred:0.03931643068790436, decouple_loss:0.032277584075927734
loss_pred:0.04012460634112358, decouple_loss:0.03228262811899185
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515632092952728, gen p mean: 0.0, mean p set: 0.44958263635635376
The modified gen p mean: 0.45127159357070923, gen p mean: 0.0, mean p set: 0.449579656124115
The modified gen p mean: 0.4471031427383423, gen p mean: 0.0, mean p set: 0.4487626254558563
loss_pred:0.03900861740112305, decouple_loss:0.03334130346775055
loss_pred:0.040039315819740295, decouple_loss:0.03163492679595947
loss_pred:0.03828063979744911, decouple_loss:0.031653113663196564
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539874792098999, gen p mean: 0.0, mean p set: 0.4508638381958008
The modified gen p mean: 0.4558904767036438, gen p mean: 0.0, mean p set: 0.4506652057170868
The modified gen p mean: 0.4547388553619385, gen p mean: 0.0, mean p set: 0.4479283094406128
loss_pred:0.037423793226480484, decouple_loss:0.031766172498464584
loss_pred:0.037413693964481354, decouple_loss:0.0312118548899889
loss_pred:0.038726624101400375, decouple_loss:0.03155640512704849
2023-05-02 19:14:32 testing...
The modified gen p mean: 0.44350776076316833, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44865307211875916, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45106926560401917, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03910605236887932, decouple_loss:0.03379376605153084
loss_pred:0.0380130372941494, decouple_loss:0.03284028172492981
loss_pred:0.037076402455568314, decouple_loss:0.03352437540888786
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03973447158932686, avg_mse: 0.04141557216644287
current test mse: 0.041416
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782280921936035, gen p mean: 0.0, mean p set: 0.44963809847831726
loss_pred:0.039104536175727844, decouple_loss:0.03159207105636597
The modified gen p mean: 0.4501562714576721, gen p mean: 0.0, mean p set: 0.44837674498558044
loss_pred:0.03750421479344368, decouple_loss:0.03179619461297989
The modified gen p mean: 0.4533035159111023, gen p mean: 0.0, mean p set: 0.4492203891277313
loss_pred:0.03824244439601898, decouple_loss:0.03216264396905899
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531777501106262, gen p mean: 0.0, mean p set: 0.44860872626304626
The modified gen p mean: 0.449076384305954, gen p mean: 0.0, mean p set: 0.45037850737571716
The modified gen p mean: 0.4428620934486389, gen p mean: 0.0, mean p set: 0.451217383146286
loss_pred:0.037053193897008896, decouple_loss:0.031829144805669785
loss_pred:0.0392787903547287, decouple_loss:0.031323209404945374
loss_pred:0.03848615288734436, decouple_loss:0.032539572566747665
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
NaN value num: 0
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4565577208995819, gen p mean: 0.0, mean p set: 0.450818806886673
The modified gen p mean: 0.45522722601890564, gen p mean: 0.0, mean p set: 0.4517087936401367
The modified gen p mean: 0.4599629044532776, gen p mean: 0.0, mean p set: 0.44781580567359924
loss_pred:0.040378667414188385, decouple_loss:0.036695778369903564
loss_pred:0.03973425552248955, decouple_loss:0.03613496944308281
loss_pred:0.03894020617008209, decouple_loss:0.03591663017868996
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.434943825006485, gen p mean: 0.0, mean p set: 0.450714111328125
The modified gen p mean: 0.43292656540870667, gen p mean: 0.0, mean p set: 0.4501708745956421
The modified gen p mean: 0.43370118737220764, gen p mean: 0.0, mean p set: 0.4484158456325531
loss_pred:0.03681635484099388, decouple_loss:0.036650400608778
loss_pred:0.03804679214954376, decouple_loss:0.03527659550309181
loss_pred:0.03825098276138306, decouple_loss:0.03397315740585327
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4448101222515106, gen p mean: 0.0, mean p set: 0.4508250057697296
The modified gen p mean: 0.45017290115356445, gen p mean: 0.0, mean p set: 0.44911646842956543
The modified gen p mean: 0.4472920000553131, gen p mean: 0.0, mean p set: 0.4500511884689331
loss_pred:0.03933055326342583, decouple_loss:0.034307803958654404
loss_pred:0.038253724575042725, decouple_loss:0.03567853942513466
loss_pred:0.038155846297740936, decouple_loss:0.03520723432302475
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4604308009147644, gen p mean: 0.0, mean p set: 0.4486904740333557
The modified gen p mean: 0.46147194504737854, gen p mean: 0.0, mean p set: 0.45069149136543274
The modified gen p mean: 0.461332231760025, gen p mean: 0.0, mean p set: 0.45021358132362366
loss_pred:0.037130240350961685, decouple_loss:0.03379109501838684
loss_pred:0.0390479676425457, decouple_loss:0.033944107592105865
loss_pred:0.036233872175216675, decouple_loss:0.033447783440351486
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454096257686615, gen p mean: 0.0, mean p set: 0.4507170021533966
The modified gen p mean: 0.4523163437843323, gen p mean: 0.0, mean p set: 0.44868484139442444
The modified gen p mean: 0.4547145664691925, gen p mean: 0.0, mean p set: 0.4480490982532501
loss_pred:0.0382976271212101, decouple_loss:0.03436135873198509
loss_pred:0.03721826896071434, decouple_loss:0.03324384614825249
loss_pred:0.03762955591082573, decouple_loss:0.032777994871139526
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.439792662858963, gen p mean: 0.0, mean p set: 0.4484463632106781
The modified gen p mean: 0.4398422837257385, gen p mean: 0.0, mean p set: 0.45066389441490173
The modified gen p mean: 0.43989601731300354, gen p mean: 0.0, mean p set: 0.4495590925216675
loss_pred:0.03741919621825218, decouple_loss:0.03243527188897133
loss_pred:0.038202401250600815, decouple_loss:0.03251178562641144
loss_pred:0.03792421147227287, decouple_loss:0.03334161639213562
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487045407295227, gen p mean: 0.0, mean p set: 0.4498618245124817
The modified gen p mean: 0.4513621926307678, gen p mean: 0.0, mean p set: 0.44815847277641296
The modified gen p mean: 0.44992318749427795, gen p mean: 0.0, mean p set: 0.4485446512699127
loss_pred:0.03756987676024437, decouple_loss:0.0331323966383934
loss_pred:0.03719611465930939, decouple_loss:0.03153328225016594
loss_pred:0.037866294384002686, decouple_loss:0.03201691806316376
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45464909076690674, gen p mean: 0.0, mean p set: 0.4506619870662689
The modified gen p mean: 0.45387592911720276, gen p mean: 0.0, mean p set: 0.4480723738670349
The modified gen p mean: 0.4544610381126404, gen p mean: 0.0, mean p set: 0.4506039321422577
loss_pred:0.037161219865083694, decouple_loss:0.034682366997003555
loss_pred:0.03798876702785492, decouple_loss:0.03227158635854721
loss_pred:0.0380055271089077, decouple_loss:0.034541986882686615
2023-05-02 19:18:52 testing...
The modified gen p mean: 0.4417094588279724, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44809606671333313, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45086196064949036, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.039038896560668945, decouple_loss:0.03494318202137947
loss_pred:0.03800492361187935, decouple_loss:0.03322891145944595
loss_pred:0.03699730709195137, decouple_loss:0.03439601510763168
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03972318023443222, avg_mse: 0.041414372622966766
current test mse: 0.041414
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4574436545372009, gen p mean: 0.0, mean p set: 0.44831526279449463
loss_pred:0.039163365960121155, decouple_loss:0.0324973426759243
The modified gen p mean: 0.45168522000312805, gen p mean: 0.0, mean p set: 0.44799432158470154
loss_pred:0.03692082315683365, decouple_loss:0.030852993950247765
The modified gen p mean: 0.4514063894748688, gen p mean: 0.0, mean p set: 0.4481312930583954
loss_pred:0.038253020495176315, decouple_loss:0.03172563761472702
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665542244911194, gen p mean: 0.0, mean p set: 0.45054522156715393
The modified gen p mean: 0.4401780664920807, gen p mean: 0.0, mean p set: 0.4496413767337799
The modified gen p mean: 0.44162842631340027, gen p mean: 0.0, mean p set: 0.45080679655075073
loss_pred:0.0395464189350605, decouple_loss:0.0325118787586689
loss_pred:0.03875645995140076, decouple_loss:0.03155885264277458
loss_pred:0.03829777613282204, decouple_loss:0.032075121998786926
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43758878111839294, gen p mean: 0.0, mean p set: 0.44871723651885986
The modified gen p mean: 0.4428267180919647, gen p mean: 0.0, mean p set: 0.4497711658477783
The modified gen p mean: 0.44215020537376404, gen p mean: 0.0, mean p set: 0.45086413621902466
loss_pred:0.03761763125658035, decouple_loss:0.032797642052173615
loss_pred:0.039393480867147446, decouple_loss:0.032927848398685455
loss_pred:0.03721372038125992, decouple_loss:0.03234304115176201
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4653862714767456, gen p mean: 0.0, mean p set: 0.4484984576702118
The modified gen p mean: 0.46575161814689636, gen p mean: 0.0, mean p set: 0.45017489790916443
The modified gen p mean: 0.4669594466686249, gen p mean: 0.0, mean p set: 0.45101693272590637
loss_pred:0.03783698007464409, decouple_loss:0.032386135309934616
loss_pred:0.038068320602178574, decouple_loss:0.03273151442408562
loss_pred:0.03657708317041397, decouple_loss:0.03297291323542595
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45244693756103516, gen p mean: 0.0, mean p set: 0.45011407136917114
The modified gen p mean: 0.45401766896247864, gen p mean: 0.0, mean p set: 0.44816699624061584
The modified gen p mean: 0.45182427763938904, gen p mean: 0.0, mean p set: 0.44827190041542053
loss_pred:0.03761155903339386, decouple_loss:0.03161199763417244
loss_pred:0.03942607715725899, decouple_loss:0.03196273744106293
loss_pred:0.03677782043814659, decouple_loss:0.031153572723269463
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.425920695066452, gen p mean: 0.0, mean p set: 0.44799768924713135
The modified gen p mean: 0.43152984976768494, gen p mean: 0.0, mean p set: 0.451019287109375
The modified gen p mean: 0.43242982029914856, gen p mean: 0.0, mean p set: 0.44930723309516907
loss_pred:0.037340544164180756, decouple_loss:0.0318429060280323
loss_pred:0.03639116883277893, decouple_loss:0.03177224099636078
loss_pred:0.03786692023277283, decouple_loss:0.0316421277821064
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609397649765015, gen p mean: 0.0, mean p set: 0.4513837993144989
The modified gen p mean: 0.4381750822067261, gen p mean: 0.0, mean p set: 0.45049232244491577
The modified gen p mean: 0.4473443031311035, gen p mean: 0.0, mean p set: 0.45069950819015503
loss_pred:0.03712334483861923, decouple_loss:0.030901731923222542
loss_pred:0.03639167919754982, decouple_loss:0.03321909159421921
loss_pred:0.03631853684782982, decouple_loss:0.0320197157561779
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4816019833087921, gen p mean: 0.0, mean p set: 0.4504070580005646
The modified gen p mean: 0.4824337661266327, gen p mean: 0.0, mean p set: 0.4497006833553314
The modified gen p mean: 0.48515745997428894, gen p mean: 0.0, mean p set: 0.4502197206020355
loss_pred:0.03891017660498619, decouple_loss:0.03382036089897156
loss_pred:0.03929192200303078, decouple_loss:0.033389944583177567
loss_pred:0.03914268687367439, decouple_loss:0.03312544897198677
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43403682112693787, gen p mean: 0.0, mean p set: 0.44780364632606506
The modified gen p mean: 0.43385109305381775, gen p mean: 0.0, mean p set: 0.448382169008255
The modified gen p mean: 0.43470609188079834, gen p mean: 0.0, mean p set: 0.45148739218711853
loss_pred:0.03909020498394966, decouple_loss:0.03157048672437668
loss_pred:0.038196880370378494, decouple_loss:0.03132675960659981
loss_pred:0.0385565385222435, decouple_loss:0.032994166016578674
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4291544556617737, gen p mean: 0.0, mean p set: 0.4485662281513214
The modified gen p mean: 0.4310971796512604, gen p mean: 0.0, mean p set: 0.44884851574897766
The modified gen p mean: 0.4229638874530792, gen p mean: 0.0, mean p set: 0.4507685601711273
loss_pred:0.03823864459991455, decouple_loss:0.03311732038855553
loss_pred:0.03810419887304306, decouple_loss:0.0319543331861496
loss_pred:0.03660181909799576, decouple_loss:0.03332166001200676
2023-05-02 19:22:32 testing...
The modified gen p mean: 0.45970454812049866, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4648037850856781, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4672134220600128, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03951260820031166, decouple_loss:0.03568866103887558
loss_pred:0.03847526013851166, decouple_loss:0.03380541875958443loss_pred:0.03732540085911751, decouple_loss:0.034666288644075394
WV_0_PC_0_EH_0_PS_40_6, loss: 0.040173765271902084, avg_mse: 0.042133379727602005
current test mse: 0.042133
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4687575697898865, gen p mean: 0.0, mean p set: 0.4479900598526001
The modified gen p mean: 0.46438175439834595, gen p mean: 0.0, mean p set: 0.4502274990081787
loss_pred:0.03853227570652962, decouple_loss:0.03139800950884819
loss_pred:0.03535807505249977, decouple_loss:0.03113042749464512
The modified gen p mean: 0.46881982684135437, gen p mean: 0.0, mean p set: 0.45008742809295654
loss_pred:0.03823211044073105, decouple_loss:0.03155522793531418
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4605637788772583, gen p mean: 0.0, mean p set: 0.4492831230163574
The modified gen p mean: 0.4602096676826477, gen p mean: 0.0, mean p set: 0.45100489258766174
The modified gen p mean: 0.4601183831691742, gen p mean: 0.0, mean p set: 0.44790026545524597
loss_pred:0.03758442401885986, decouple_loss:0.03239430487155914
loss_pred:0.037731073796749115, decouple_loss:0.03176957741379738
loss_pred:0.037658289074897766, decouple_loss:0.03227097541093826
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
NaN value num: 0
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4268167316913605, gen p mean: 0.0, mean p set: 0.4459638297557831
The modified gen p mean: 0.42512765526771545, gen p mean: 0.0, mean p set: 0.4475480318069458
The modified gen p mean: 0.4259730875492096, gen p mean: 0.0, mean p set: 0.44957417249679565
loss_pred:0.03916047513484955, decouple_loss:0.03510027006268501
loss_pred:0.03670135512948036, decouple_loss:0.035273902118206024
loss_pred:0.03963010385632515, decouple_loss:0.03532511740922928
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453313410282135, gen p mean: 0.0, mean p set: 0.4485023021697998
The modified gen p mean: 0.45520952343940735, gen p mean: 0.0, mean p set: 0.4481199383735657
The modified gen p mean: 0.45567530393600464, gen p mean: 0.0, mean p set: 0.449752539396286
loss_pred:0.039046961814165115, decouple_loss:0.03526483103632927
loss_pred:0.039177607744932175, decouple_loss:0.03500949963927269
loss_pred:0.037464823573827744, decouple_loss:0.034102946519851685
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45969605445861816, gen p mean: 0.0, mean p set: 0.4468673765659332
The modified gen p mean: 0.4629432260990143, gen p mean: 0.0, mean p set: 0.4486178159713745
The modified gen p mean: 0.4589087665081024, gen p mean: 0.0, mean p set: 0.4452323615550995
loss_pred:0.03901892900466919, decouple_loss:0.033971384167671204
loss_pred:0.040331512689590454, decouple_loss:0.03493165597319603
loss_pred:0.037798069417476654, decouple_loss:0.03369033709168434
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482637345790863, gen p mean: 0.0, mean p set: 0.4456256330013275
The modified gen p mean: 0.4512448310852051, gen p mean: 0.0, mean p set: 0.4463125169277191
The modified gen p mean: 0.45140179991722107, gen p mean: 0.0, mean p set: 0.44628193974494934
loss_pred:0.03917376697063446, decouple_loss:0.03348521888256073
loss_pred:0.03795364871621132, decouple_loss:0.03334623575210571
loss_pred:0.03762225806713104, decouple_loss:0.03372349217534065
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44036686420440674, gen p mean: 0.0, mean p set: 0.4486467242240906
The modified gen p mean: 0.44337302446365356, gen p mean: 0.0, mean p set: 0.4490150213241577
The modified gen p mean: 0.44687026739120483, gen p mean: 0.0, mean p set: 0.4470330774784088
loss_pred:0.03808305040001869, decouple_loss:0.03430737182497978
loss_pred:0.04101123288273811, decouple_loss:0.03404299169778824
loss_pred:0.03747985512018204, decouple_loss:0.03328414261341095
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43910396099090576, gen p mean: 0.0, mean p set: 0.44642698764801025
The modified gen p mean: 0.44068288803100586, gen p mean: 0.0, mean p set: 0.44674885272979736
The modified gen p mean: 0.4440937936306, gen p mean: 0.0, mean p set: 0.4462781846523285
loss_pred:0.038241297006607056, decouple_loss:0.0332089439034462
loss_pred:0.038651544600725174, decouple_loss:0.03235974535346031
loss_pred:0.03848377615213394, decouple_loss:0.031780268996953964
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43532776832580566, gen p mean: 0.0, mean p set: 0.4457470774650574
The modified gen p mean: 0.4398479163646698, gen p mean: 0.0, mean p set: 0.44750338792800903
The modified gen p mean: 0.4364963173866272, gen p mean: 0.0, mean p set: 0.44588083028793335
loss_pred:0.03793639689683914, decouple_loss:0.03254503384232521
loss_pred:0.03785524144768715, decouple_loss:0.033402930945158005
loss_pred:0.03770323842763901, decouple_loss:0.03407632187008858
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45705437660217285, gen p mean: 0.0, mean p set: 0.44770243763923645
The modified gen p mean: 0.45346173644065857, gen p mean: 0.0, mean p set: 0.4487939476966858
The modified gen p mean: 0.45663514733314514, gen p mean: 0.0, mean p set: 0.4486483037471771
loss_pred:0.040324579924345016, decouple_loss:0.033167921006679535
loss_pred:0.03938700258731842, decouple_loss:0.03364771977066994
loss_pred:0.039438650012016296, decouple_loss:0.03320535644888878
2023-05-02 19:26:58 testing...
The modified gen p mean: 0.47410014271736145, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4693560302257538, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.47562527656555176, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.038194023072719574, decouple_loss:0.033865123987197876
loss_pred:0.03931489214301109, decouple_loss:0.034879330545663834
loss_pred:0.03732847794890404, decouple_loss:0.03458715230226517
WV_0_PC_0_EH_0_PS_40_6, loss: 0.04000132530927658, avg_mse: 0.04176464304327965
current test mse: 0.041765
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.470880389213562, gen p mean: 0.0, mean p set: 0.4500530958175659
The modified gen p mean: 0.4682891070842743, gen p mean: 0.0, mean p set: 0.44659915566444397
loss_pred:0.0366278737783432, decouple_loss:0.03294120356440544
loss_pred:0.03819398581981659, decouple_loss:0.032584238797426224
The modified gen p mean: 0.4690413475036621, gen p mean: 0.0, mean p set: 0.44577544927597046
loss_pred:0.03715857118368149, decouple_loss:0.03296966478228569
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4290940463542938, gen p mean: 0.0, mean p set: 0.4488413631916046
The modified gen p mean: 0.43166404962539673, gen p mean: 0.0, mean p set: 0.4483906924724579
The modified gen p mean: 0.4298733174800873, gen p mean: 0.0, mean p set: 0.44727998971939087
loss_pred:0.038441285490989685, decouple_loss:0.03381955251097679
loss_pred:0.04018582031130791, decouple_loss:0.03266707807779312
loss_pred:0.040350425988435745, decouple_loss:0.032405972480773926
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4411226212978363, gen p mean: 0.0, mean p set: 0.4477825164794922The modified gen p mean: 0.43759557604789734, gen p mean: 0.0, mean p set: 0.4473304748535156
The modified gen p mean: 0.440179705619812, gen p mean: 0.0, mean p set: 0.4476630687713623
loss_pred:0.03731580078601837, decouple_loss:0.031519267708063126
loss_pred:0.03829493746161461, decouple_loss:0.03119792602956295
loss_pred:0.03697893023490906, decouple_loss:0.03215838223695755
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.464081734418869, gen p mean: 0.0, mean p set: 0.44635626673698425
The modified gen p mean: 0.4638873338699341, gen p mean: 0.0, mean p set: 0.4481523334980011
The modified gen p mean: 0.4630870223045349, gen p mean: 0.0, mean p set: 0.44811511039733887
loss_pred:0.0367405004799366, decouple_loss:0.03245985135436058
loss_pred:0.03831272944808006, decouple_loss:0.03101998008787632
loss_pred:0.04022505134344101, decouple_loss:0.032329052686691284
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45093056559562683, gen p mean: 0.0, mean p set: 0.4504740536212921
The modified gen p mean: 0.4508271813392639, gen p mean: 0.0, mean p set: 0.4480600357055664
The modified gen p mean: 0.4513651728630066, gen p mean: 0.0, mean p set: 0.4491027295589447
loss_pred:0.03702772036194801, decouple_loss:0.032542139291763306
loss_pred:0.04020048305392265, decouple_loss:0.032643985003232956
loss_pred:0.03919120877981186, decouple_loss:0.03278107941150665
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4322401285171509, gen p mean: 0.0, mean p set: 0.44912174344062805
The modified gen p mean: 0.4326605200767517, gen p mean: 0.0, mean p set: 0.447277694940567
The modified gen p mean: 0.4295072555541992, gen p mean: 0.0, mean p set: 0.44467902183532715
loss_pred:0.036918364465236664, decouple_loss:0.032773457467556
loss_pred:0.04012605547904968, decouple_loss:0.03182093799114227
loss_pred:0.03845660760998726, decouple_loss:0.0322301909327507
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534681439399719, gen p mean: 0.0, mean p set: 0.450869619846344
The modified gen p mean: 0.45762306451797485, gen p mean: 0.0, mean p set: 0.4470408260822296
The modified gen p mean: 0.45076578855514526, gen p mean: 0.0, mean p set: 0.44711804389953613
loss_pred:0.03697316348552704, decouple_loss:0.03185706213116646
loss_pred:0.03702259063720703, decouple_loss:0.031267765909433365
loss_pred:0.037894923239946365, decouple_loss:0.0319502130150795
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453534871339798, gen p mean: 0.0, mean p set: 0.4484868049621582
The modified gen p mean: 0.45056992769241333, gen p mean: 0.0, mean p set: 0.4449720084667206
The modified gen p mean: 0.45395636558532715, gen p mean: 0.0, mean p set: 0.44658976793289185
loss_pred:0.0396856814622879, decouple_loss:0.03151824697852135
loss_pred:0.03806480020284653, decouple_loss:0.03180510550737381
loss_pred:0.03713001683354378, decouple_loss:0.031664296984672546
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821032881736755, gen p mean: 0.0, mean p set: 0.4469718039035797
The modified gen p mean: 0.44640597701072693, gen p mean: 0.0, mean p set: 0.4471952021121979
The modified gen p mean: 0.44339510798454285, gen p mean: 0.0, mean p set: 0.4477749764919281
loss_pred:0.03673810511827469, decouple_loss:0.03120533563196659
loss_pred:0.0366891510784626, decouple_loss:0.03092711977660656
loss_pred:0.04050171375274658, decouple_loss:0.029584376141428947
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4446564018726349, gen p mean: 0.0, mean p set: 0.4474453032016754
The modified gen p mean: 0.4456402063369751, gen p mean: 0.0, mean p set: 0.4480111598968506
The modified gen p mean: 0.44029727578163147, gen p mean: 0.0, mean p set: 0.44718730449676514
loss_pred:0.036626700311899185, decouple_loss:0.029460269957780838
loss_pred:0.0392170324921608, decouple_loss:0.02993866614997387
loss_pred:0.037685781717300415, decouple_loss:0.030194196850061417
2023-05-02 19:30:39 testing...
The modified gen p mean: 0.45581430196762085, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44941017031669617, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4537515938282013, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.036798082292079926, decouple_loss:0.03171173483133316
loss_pred:0.03884153068065643, decouple_loss:0.032590825110673904
loss_pred:0.03772185742855072, decouple_loss:0.031322479248046875
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03938090801239014, avg_mse: 0.041334085166454315
current test mse: 0.041334
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525986909866333, gen p mean: 0.0, mean p set: 0.4497237801551819
The modified gen p mean: 0.45377981662750244, gen p mean: 0.0, mean p set: 0.4479677379131317
loss_pred:0.03793097287416458, decouple_loss:0.030541453510522842
loss_pred:0.03914499655365944, decouple_loss:0.03159945458173752
The modified gen p mean: 0.4545181691646576, gen p mean: 0.0, mean p set: 0.44841283559799194
loss_pred:0.03840417414903641, decouple_loss:0.030682025477290154
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43643343448638916, gen p mean: 0.0, mean p set: 0.44815483689308167
The modified gen p mean: 0.4387451708316803, gen p mean: 0.0, mean p set: 0.4502406716346741
The modified gen p mean: 0.4379270374774933, gen p mean: 0.0, mean p set: 0.4487829804420471
loss_pred:0.03803420066833496, decouple_loss:0.03081282414495945
loss_pred:0.03670937940478325, decouple_loss:0.030968692153692245
loss_pred:0.03670861944556236, decouple_loss:0.029841141775250435
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
NaN value num: 0
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450196772813797, gen p mean: 0.0, mean p set: 0.4517212510108948
The modified gen p mean: 0.45051059126853943, gen p mean: 0.0, mean p set: 0.44930416345596313
The modified gen p mean: 0.44977661967277527, gen p mean: 0.0, mean p set: 0.4510977864265442
loss_pred:0.03749549388885498, decouple_loss:0.03259376063942909
loss_pred:0.03742912784218788, decouple_loss:0.03453478589653969
loss_pred:0.03879465535283089, decouple_loss:0.03358902037143707
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4693561792373657, gen p mean: 0.0, mean p set: 0.4502323865890503
The modified gen p mean: 0.4714893400669098, gen p mean: 0.0, mean p set: 0.4497903883457184
The modified gen p mean: 0.47300729155540466, gen p mean: 0.0, mean p set: 0.44980788230895996
loss_pred:0.038106661289930344, decouple_loss:0.03445291891694069
loss_pred:0.03885133937001228, decouple_loss:0.03282349929213524
loss_pred:0.03940736502408981, decouple_loss:0.033659860491752625
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45562058687210083, gen p mean: 0.0, mean p set: 0.45049992203712463
The modified gen p mean: 0.4578996002674103, gen p mean: 0.0, mean p set: 0.45005232095718384
The modified gen p mean: 0.4579029679298401, gen p mean: 0.0, mean p set: 0.45105046033859253
loss_pred:0.03769154101610184, decouple_loss:0.03329573944211006
loss_pred:0.038469087332487106, decouple_loss:0.032402411103248596
loss_pred:0.0376226045191288, decouple_loss:0.032371748238801956
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4237111806869507, gen p mean: 0.0, mean p set: 0.4513028562068939
The modified gen p mean: 0.4278128445148468, gen p mean: 0.0, mean p set: 0.45090827345848083
The modified gen p mean: 0.42652517557144165, gen p mean: 0.0, mean p set: 0.4512394070625305
loss_pred:0.03734941408038139, decouple_loss:0.032504793256521225
loss_pred:0.03818231076002121, decouple_loss:0.03209003061056137
loss_pred:0.03841745853424072, decouple_loss:0.03233712166547775
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515075087547302, gen p mean: 0.0, mean p set: 0.4512425363063812
The modified gen p mean: 0.4552566111087799, gen p mean: 0.0, mean p set: 0.4503557085990906
The modified gen p mean: 0.4524221122264862, gen p mean: 0.0, mean p set: 0.45145899057388306
loss_pred:0.036953702569007874, decouple_loss:0.033333539962768555
loss_pred:0.037267886102199554, decouple_loss:0.033199138939380646
loss_pred:0.03787117823958397, decouple_loss:0.03222285583615303
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46275103092193604, gen p mean: 0.0, mean p set: 0.45080649852752686
The modified gen p mean: 0.4638804793357849, gen p mean: 0.0, mean p set: 0.44960469007492065
The modified gen p mean: 0.46769964694976807, gen p mean: 0.0, mean p set: 0.4505513310432434
loss_pred:0.037768084555864334, decouple_loss:0.03282932564616203
loss_pred:0.03788737580180168, decouple_loss:0.03205728158354759
loss_pred:0.03670111671090126, decouple_loss:0.03345899283885956
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4429660141468048, gen p mean: 0.0, mean p set: 0.4510340988636017
The modified gen p mean: 0.44389116764068604, gen p mean: 0.0, mean p set: 0.4505578577518463
The modified gen p mean: 0.44656819105148315, gen p mean: 0.0, mean p set: 0.4487132728099823
loss_pred:0.03831072151660919, decouple_loss:0.033549461513757706
loss_pred:0.03733845800161362, decouple_loss:0.032072678208351135
loss_pred:0.03778407722711563, decouple_loss:0.03230585902929306
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44268321990966797, gen p mean: 0.0, mean p set: 0.45129671692848206
The modified gen p mean: 0.44406235218048096, gen p mean: 0.0, mean p set: 0.4510418474674225
The modified gen p mean: 0.44489407539367676, gen p mean: 0.0, mean p set: 0.4513426423072815
loss_pred:0.037306301295757294, decouple_loss:0.032319843769073486
loss_pred:0.03671829774975777, decouple_loss:0.031627558171749115
loss_pred:0.03834323585033417, decouple_loss:0.03151969239115715
2023-05-02 19:35:04 testing...
The modified gen p mean: 0.44575488567352295, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44975796341896057, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45273149013519287, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.038989219814538956, decouple_loss:0.03545388579368591
loss_pred:0.037645045667886734, decouple_loss:0.03344811499118805
loss_pred:0.03659268841147423, decouple_loss:0.03432448208332062
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03946276009082794, avg_mse: 0.04141731187701225
current test mse: 0.041417
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537945091724396, gen p mean: 0.0, mean p set: 0.45037728548049927
The modified gen p mean: 0.4519362449645996, gen p mean: 0.0, mean p set: 0.4496467411518097
loss_pred:0.03808436915278435, decouple_loss:0.030889619141817093
loss_pred:0.03858230635523796, decouple_loss:0.031282395124435425
The modified gen p mean: 0.4536788761615753, gen p mean: 0.0, mean p set: 0.45230039954185486
loss_pred:0.03811604529619217, decouple_loss:0.03162507340312004
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45873403549194336, gen p mean: 0.0, mean p set: 0.45028993487358093
The modified gen p mean: 0.4548908472061157, gen p mean: 0.0, mean p set: 0.4502711296081543
The modified gen p mean: 0.4576071500778198, gen p mean: 0.0, mean p set: 0.45042750239372253
loss_pred:0.03704224154353142, decouple_loss:0.031567491590976715
loss_pred:0.036691490560770035, decouple_loss:0.03264358639717102
loss_pred:0.03702738508582115, decouple_loss:0.03195817396044731
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4364374279975891, gen p mean: 0.0, mean p set: 0.4513128101825714
The modified gen p mean: 0.436919629573822, gen p mean: 0.0, mean p set: 0.4492945969104767
The modified gen p mean: 0.4383155405521393, gen p mean: 0.0, mean p set: 0.4514424204826355
loss_pred:0.03720488399267197, decouple_loss:0.03242437541484833
loss_pred:0.03733086958527565, decouple_loss:0.029958635568618774
loss_pred:0.03596872091293335, decouple_loss:0.03174729272723198
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476855993270874, gen p mean: 0.0, mean p set: 0.4496149718761444
The modified gen p mean: 0.44414427876472473, gen p mean: 0.0, mean p set: 0.4495491087436676
The modified gen p mean: 0.4416405260562897, gen p mean: 0.0, mean p set: 0.4508568048477173
loss_pred:0.037422697991132736, decouple_loss:0.031175855547189713
loss_pred:0.03697947412729263, decouple_loss:0.031249627470970154
loss_pred:0.037359606474637985, decouple_loss:0.03262219950556755
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4669862389564514, gen p mean: 0.0, mean p set: 0.4511845111846924
The modified gen p mean: 0.46506109833717346, gen p mean: 0.0, mean p set: 0.45127591490745544
The modified gen p mean: 0.4675549566745758, gen p mean: 0.0, mean p set: 0.4503003656864166
loss_pred:0.03596023842692375, decouple_loss:0.031594615429639816
loss_pred:0.037783149629831314, decouple_loss:0.03158600628376007
loss_pred:0.03840401768684387, decouple_loss:0.03134116902947426
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45762985944747925, gen p mean: 0.0, mean p set: 0.45120492577552795
The modified gen p mean: 0.45662152767181396, gen p mean: 0.0, mean p set: 0.4511294364929199
The modified gen p mean: 0.4567193388938904, gen p mean: 0.0, mean p set: 0.44986993074417114
loss_pred:0.037767160683870316, decouple_loss:0.03184593841433525
loss_pred:0.03803316876292229, decouple_loss:0.03053855523467064
loss_pred:0.03753836080431938, decouple_loss:0.030510572716593742
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4335348606109619, gen p mean: 0.0, mean p set: 0.45136934518814087
The modified gen p mean: 0.4339834749698639, gen p mean: 0.0, mean p set: 0.4504863917827606
The modified gen p mean: 0.4339872896671295, gen p mean: 0.0, mean p set: 0.45061591267585754
loss_pred:0.03764428198337555, decouple_loss:0.03080715239048004loss_pred:0.03817079961299896, decouple_loss:0.030808715149760246
loss_pred:0.036623161286115646, decouple_loss:0.032331038266420364
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809383153915405, gen p mean: 0.0, mean p set: 0.45102033019065857
The modified gen p mean: 0.4485265016555786, gen p mean: 0.0, mean p set: 0.450395792722702
The modified gen p mean: 0.4469485580921173, gen p mean: 0.0, mean p set: 0.4509945213794708
loss_pred:0.0378117561340332, decouple_loss:0.030996551737189293
loss_pred:0.037267886102199554, decouple_loss:0.0307503379881382
loss_pred:0.035584595054388046, decouple_loss:0.03165378049015999
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46200031042099, gen p mean: 0.0, mean p set: 0.45081210136413574
The modified gen p mean: 0.4600711762905121, gen p mean: 0.0, mean p set: 0.4506819546222687
The modified gen p mean: 0.4612830579280853, gen p mean: 0.0, mean p set: 0.44980117678642273
loss_pred:0.03655161336064339, decouple_loss:0.030047213658690453
loss_pred:0.03600866720080376, decouple_loss:0.030089620500802994
loss_pred:0.03828679025173187, decouple_loss:0.03022507019340992
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537690579891205, gen p mean: 0.0, mean p set: 0.450351357460022
The modified gen p mean: 0.4529232978820801, gen p mean: 0.0, mean p set: 0.45034709572792053
The modified gen p mean: 0.4497758448123932, gen p mean: 0.0, mean p set: 0.4495503306388855
loss_pred:0.03694673627614975, decouple_loss:0.030398519709706306
loss_pred:0.038054727017879486, decouple_loss:0.0317249558866024
loss_pred:0.0370834544301033, decouple_loss:0.03046548366546631
2023-05-02 19:38:45 testing...
The modified gen p mean: 0.4401414394378662, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4474292993545532, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4443358778953552, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03883799538016319, decouple_loss:0.03536968305706978
loss_pred:0.036702465265989304, decouple_loss:0.03361375257372856
loss_pred:0.03770872578024864, decouple_loss:0.03294670581817627
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0394485667347908, avg_mse: 0.04160310700535774
current test mse: 0.041603
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499083161354065, gen p mean: 0.0, mean p set: 0.4502144455909729
The modified gen p mean: 0.4441670775413513, gen p mean: 0.0, mean p set: 0.45113804936408997
loss_pred:0.036640796810388565, decouple_loss:0.029505569487810135
loss_pred:0.036781296133995056, decouple_loss:0.030693519860506058
The modified gen p mean: 0.45047128200531006, gen p mean: 0.0, mean p set: 0.45090147852897644
loss_pred:0.0374283641576767, decouple_loss:0.03113848716020584
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459856152534485, gen p mean: 0.0, mean p set: 0.4491029977798462
The modified gen p mean: 0.4431004226207733, gen p mean: 0.0, mean p set: 0.4486761689186096
The modified gen p mean: 0.44926008582115173, gen p mean: 0.0, mean p set: 0.4487597644329071
loss_pred:0.038099680095911026, decouple_loss:0.034012872725725174
loss_pred:0.03871038928627968, decouple_loss:0.03402306139469147
loss_pred:0.03747617453336716, decouple_loss:0.03551154583692551
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4419572949409485, gen p mean: 0.0, mean p set: 0.4488937258720398
The modified gen p mean: 0.43728363513946533, gen p mean: 0.0, mean p set: 0.4498666524887085
The modified gen p mean: 0.44568970799446106, gen p mean: 0.0, mean p set: 0.4493670165538788
loss_pred:0.0387301929295063, decouple_loss:0.03620654717087746
loss_pred:0.038563378155231476, decouple_loss:0.03384716063737869
loss_pred:0.03614189848303795, decouple_loss:0.034709930419921875
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44382792711257935, gen p mean: 0.0, mean p set: 0.44911903142929077
The modified gen p mean: 0.44566789269447327, gen p mean: 0.0, mean p set: 0.4490050673484802
The modified gen p mean: 0.44553348422050476, gen p mean: 0.0, mean p set: 0.4480302929878235
loss_pred:0.03808886557817459, decouple_loss:0.03367362916469574
loss_pred:0.037942204624414444, decouple_loss:0.034452296793460846
loss_pred:0.03716287389397621, decouple_loss:0.034225963056087494
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45958811044692993, gen p mean: 0.0, mean p set: 0.4484219551086426
The modified gen p mean: 0.4498558044433594, gen p mean: 0.0, mean p set: 0.4490435719490051
The modified gen p mean: 0.45461535453796387, gen p mean: 0.0, mean p set: 0.4478098452091217
loss_pred:0.03856251388788223, decouple_loss:0.033094167709350586
loss_pred:0.03669896349310875, decouple_loss:0.03368399292230606
loss_pred:0.03886798024177551, decouple_loss:0.03312348946928978
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46149036288261414, gen p mean: 0.0, mean p set: 0.449928879737854
The modified gen p mean: 0.46538326144218445, gen p mean: 0.0, mean p set: 0.44901883602142334
The modified gen p mean: 0.4610016644001007, gen p mean: 0.0, mean p set: 0.4495936930179596
loss_pred:0.03743891790509224, decouple_loss:0.031174566596746445
loss_pred:0.03686833754181862, decouple_loss:0.03309767320752144
loss_pred:0.037221234291791916, decouple_loss:0.032372210174798965
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4356144368648529, gen p mean: 0.0, mean p set: 0.4496367573738098
The modified gen p mean: 0.4453214704990387, gen p mean: 0.0, mean p set: 0.448492169380188
The modified gen p mean: 0.4398598074913025, gen p mean: 0.0, mean p set: 0.44845834374427795
loss_pred:0.03620222583413124, decouple_loss:0.031804513186216354
loss_pred:0.03748707100749016, decouple_loss:0.031109416857361794
loss_pred:0.03755909577012062, decouple_loss:0.031562481075525284
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44230425357818604, gen p mean: 0.0, mean p set: 0.44830653071403503
The modified gen p mean: 0.4399700462818146, gen p mean: 0.0, mean p set: 0.4494384229183197
The modified gen p mean: 0.440544068813324, gen p mean: 0.0, mean p set: 0.44836896657943726
loss_pred:0.03702578321099281, decouple_loss:0.03090376779437065
loss_pred:0.03631875291466713, decouple_loss:0.03104105032980442
loss_pred:0.03866434097290039, decouple_loss:0.03120497055351734
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492640197277069, gen p mean: 0.0, mean p set: 0.4499637186527252
The modified gen p mean: 0.4482969045639038, gen p mean: 0.0, mean p set: 0.4495360851287842
The modified gen p mean: 0.451760470867157, gen p mean: 0.0, mean p set: 0.4492647647857666
loss_pred:0.036421313881874084, decouple_loss:0.031245460733771324
loss_pred:0.037724051624536514, decouple_loss:0.03242770582437515
loss_pred:0.03539005666971207, decouple_loss:0.031196612864732742
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526219666004181, gen p mean: 0.0, mean p set: 0.4480001628398895
The modified gen p mean: 0.45344671607017517, gen p mean: 0.0, mean p set: 0.44956550002098083
The modified gen p mean: 0.4525134861469269, gen p mean: 0.0, mean p set: 0.4480241537094116
loss_pred:0.037937063723802567, decouple_loss:0.03113536164164543
loss_pred:0.03716275095939636, decouple_loss:0.03120097517967224
loss_pred:0.037680309265851974, decouple_loss:0.0311586894094944
2023-05-02 19:43:08 testing...
The modified gen p mean: 0.44686850905418396, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4549313187599182, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4519575536251068, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03794711455702782, decouple_loss:0.032968152314424515
loss_pred:0.036027759313583374, decouple_loss:0.03283348307013512
loss_pred:0.036913543939590454, decouple_loss:0.032057806849479675
WV_0_PC_0_EH_0_PS_40_6, loss: 0.038593798875808716, avg_mse: 0.04039733484387398
current test mse: 0.040397
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529194235801697, gen p mean: 0.0, mean p set: 0.4494534134864807
loss_pred:0.03543601930141449, decouple_loss:0.031181663274765015
The modified gen p mean: 0.45065566897392273, gen p mean: 0.0, mean p set: 0.44925159215927124
loss_pred:0.03686605021357536, decouple_loss:0.030809881165623665
The modified gen p mean: 0.45276370644569397, gen p mean: 0.0, mean p set: 0.4482733905315399
loss_pred:0.038410257548093796, decouple_loss:0.03130827099084854
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45152369141578674, gen p mean: 0.0, mean p set: 0.4496358335018158
The modified gen p mean: 0.4538315236568451, gen p mean: 0.0, mean p set: 0.44951876997947693
The modified gen p mean: 0.4565300941467285, gen p mean: 0.0, mean p set: 0.4484536051750183
loss_pred:0.036262594163417816, decouple_loss:0.031525805592536926
loss_pred:0.03731707111001015, decouple_loss:0.030821701511740685
loss_pred:0.03768902271986008, decouple_loss:0.031443528831005096
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44486719369888306, gen p mean: 0.0, mean p set: 0.4500062167644501
The modified gen p mean: 0.4521123766899109, gen p mean: 0.0, mean p set: 0.448577344417572
The modified gen p mean: 0.45250239968299866, gen p mean: 0.0, mean p set: 0.44917774200439453
loss_pred:0.03753161057829857, decouple_loss:0.030511517077684402
loss_pred:0.03629300370812416, decouple_loss:0.029760437086224556
loss_pred:0.03705109283328056, decouple_loss:0.029821140691637993
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909659028053284, gen p mean: 0.0, mean p set: 0.4486114978790283
The modified gen p mean: 0.44223299622535706, gen p mean: 0.0, mean p set: 0.4493010640144348
The modified gen p mean: 0.4431658983230591, gen p mean: 0.0, mean p set: 0.4488733410835266
loss_pred:0.0368601530790329, decouple_loss:0.03048967383801937
loss_pred:0.03676104173064232, decouple_loss:0.030053570866584778
loss_pred:0.03727209195494652, decouple_loss:0.03027336858212948
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4382430911064148, gen p mean: 0.0, mean p set: 0.4498986005783081
The modified gen p mean: 0.44016870856285095, gen p mean: 0.0, mean p set: 0.44861117005348206
The modified gen p mean: 0.44158947467803955, gen p mean: 0.0, mean p set: 0.4483001232147217
loss_pred:0.03725142404437065, decouple_loss:0.031088199466466904
loss_pred:0.0362035296857357, decouple_loss:0.02941742166876793
loss_pred:0.037948258221149445, decouple_loss:0.029839497059583664
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4572203457355499, gen p mean: 0.0, mean p set: 0.4499538242816925
The modified gen p mean: 0.45706427097320557, gen p mean: 0.0, mean p set: 0.4488653242588043
The modified gen p mean: 0.458371639251709, gen p mean: 0.0, mean p set: 0.4494089186191559
loss_pred:0.03628623113036156, decouple_loss:0.02975151315331459
loss_pred:0.035756874829530716, decouple_loss:0.02995634637773037
loss_pred:0.036274462938308716, decouple_loss:0.029900671914219856
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45811593532562256, gen p mean: 0.0, mean p set: 0.44951972365379333
The modified gen p mean: 0.45429760217666626, gen p mean: 0.0, mean p set: 0.4498598277568817
The modified gen p mean: 0.45847728848457336, gen p mean: 0.0, mean p set: 0.4494735598564148
loss_pred:0.03574005886912346, decouple_loss:0.029397286474704742
loss_pred:0.035803791135549545, decouple_loss:0.030732059851288795
loss_pred:0.03605759143829346, decouple_loss:0.028872350230813026
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4345519542694092, gen p mean: 0.0, mean p set: 0.4494372606277466
The modified gen p mean: 0.43508434295654297, gen p mean: 0.0, mean p set: 0.44934189319610596
The modified gen p mean: 0.4411344826221466, gen p mean: 0.0, mean p set: 0.4491669833660126
loss_pred:0.03626932203769684, decouple_loss:0.029740920290350914
loss_pred:0.036705635488033295, decouple_loss:0.03016832284629345
loss_pred:0.03619140386581421, decouple_loss:0.029342511668801308
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664639234542847, gen p mean: 0.0, mean p set: 0.4496401250362396
The modified gen p mean: 0.4481576085090637, gen p mean: 0.0, mean p set: 0.44947290420532227
The modified gen p mean: 0.44502368569374084, gen p mean: 0.0, mean p set: 0.4498789310455322
loss_pred:0.037003736943006516, decouple_loss:0.0295625738799572
loss_pred:0.03542758896946907, decouple_loss:0.029147807508707047
loss_pred:0.03661179170012474, decouple_loss:0.02990175411105156
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4710066318511963, gen p mean: 0.0, mean p set: 0.4486406445503235
The modified gen p mean: 0.4687283933162689, gen p mean: 0.0, mean p set: 0.4486786425113678
The modified gen p mean: 0.46747687458992004, gen p mean: 0.0, mean p set: 0.4489397704601288
loss_pred:0.03762510046362877, decouple_loss:0.030419422313570976
loss_pred:0.03789416700601578, decouple_loss:0.030988428741693497
loss_pred:0.0360257625579834, decouple_loss:0.030298985540866852
2023-05-02 19:46:50 testing...
The modified gen p mean: 0.44869470596313477, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45432692766189575, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4568520784378052, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03763016685843468, decouple_loss:0.030781937763094902
loss_pred:0.036607272922992706, decouple_loss:0.029775306582450867
loss_pred:0.03557165339589119, decouple_loss:0.030879884958267212
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03812698647379875, avg_mse: 0.03996136039495468
current test mse: 0.039961
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518465995788574, gen p mean: 0.0, mean p set: 0.4497752785682678
The modified gen p mean: 0.4467443823814392, gen p mean: 0.0, mean p set: 0.45005539059638977
loss_pred:0.03584910184144974, decouple_loss:0.030148159712553024
loss_pred:0.03576918691396713, decouple_loss:0.02953275665640831
The modified gen p mean: 0.4524061977863312, gen p mean: 0.0, mean p set: 0.44972550868988037
loss_pred:0.036300353705883026, decouple_loss:0.029306640848517418
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
NaN value num: 0
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.440011590719223, gen p mean: 0.0, mean p set: 0.447950154542923
The modified gen p mean: 0.43593111634254456, gen p mean: 0.0, mean p set: 0.44948336482048035
The modified gen p mean: 0.43172070384025574, gen p mean: 0.0, mean p set: 0.45060229301452637
loss_pred:0.038689907640218735, decouple_loss:0.03381255269050598
loss_pred:0.0378790982067585, decouple_loss:0.033144231885671616
loss_pred:0.037754643708467484, decouple_loss:0.03461991995573044
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008334517478943, gen p mean: 0.0, mean p set: 0.44800323247909546
The modified gen p mean: 0.45003822445869446, gen p mean: 0.0, mean p set: 0.44881829619407654
The modified gen p mean: 0.44678109884262085, gen p mean: 0.0, mean p set: 0.45081809163093567
loss_pred:0.037418659776449203, decouple_loss:0.03391065448522568
loss_pred:0.0384911373257637, decouple_loss:0.03278740495443344
loss_pred:0.03575344383716583, decouple_loss:0.034810956567525864
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4649304747581482, gen p mean: 0.0, mean p set: 0.4496016502380371
The modified gen p mean: 0.4657420217990875, gen p mean: 0.0, mean p set: 0.4507671892642975
The modified gen p mean: 0.4717100262641907, gen p mean: 0.0, mean p set: 0.44822174310684204
loss_pred:0.0384456068277359, decouple_loss:0.03380882367491722
loss_pred:0.03626604378223419, decouple_loss:0.03542625904083252
loss_pred:0.038996919989585876, decouple_loss:0.03493510186672211
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461890161037445, gen p mean: 0.0, mean p set: 0.4505079984664917
The modified gen p mean: 0.4455723166465759, gen p mean: 0.0, mean p set: 0.44899022579193115
The modified gen p mean: 0.44506487250328064, gen p mean: 0.0, mean p set: 0.4482679069042206
loss_pred:0.03608773276209831, decouple_loss:0.03337264060974121
loss_pred:0.03659195825457573, decouple_loss:0.03189520537853241
loss_pred:0.036599986255168915, decouple_loss:0.03164937347173691
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43655914068222046, gen p mean: 0.0, mean p set: 0.4479213356971741
The modified gen p mean: 0.4319790303707123, gen p mean: 0.0, mean p set: 0.449439138174057
The modified gen p mean: 0.4327445328235626, gen p mean: 0.0, mean p set: 0.44886893033981323
loss_pred:0.036125198006629944, decouple_loss:0.032225072383880615
loss_pred:0.038122471421957016, decouple_loss:0.03176558017730713
loss_pred:0.038029544055461884, decouple_loss:0.03194611147046089
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804859161376953, gen p mean: 0.0, mean p set: 0.4510261118412018
The modified gen p mean: 0.4468826353549957, gen p mean: 0.0, mean p set: 0.45088252425193787
The modified gen p mean: 0.44510015845298767, gen p mean: 0.0, mean p set: 0.44866451621055603
loss_pred:0.035175200551748276, decouple_loss:0.03129871189594269
loss_pred:0.03722543641924858, decouple_loss:0.0316501259803772
loss_pred:0.03688047081232071, decouple_loss:0.03153574466705322
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46940121054649353, gen p mean: 0.0, mean p set: 0.4489021897315979
The modified gen p mean: 0.4634493291378021, gen p mean: 0.0, mean p set: 0.4506576955318451
The modified gen p mean: 0.4691271185874939, gen p mean: 0.0, mean p set: 0.4501826763153076
loss_pred:0.03784435614943504, decouple_loss:0.032121770083904266
loss_pred:0.03630530461668968, decouple_loss:0.03200417757034302
loss_pred:0.03507278487086296, decouple_loss:0.03324131667613983
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4571807086467743, gen p mean: 0.0, mean p set: 0.44896015524864197
The modified gen p mean: 0.4521087110042572, gen p mean: 0.0, mean p set: 0.44990259408950806
The modified gen p mean: 0.457965612411499, gen p mean: 0.0, mean p set: 0.44865772128105164
loss_pred:0.03797607868909836, decouple_loss:0.032004714012145996
loss_pred:0.03712641820311546, decouple_loss:0.03172237053513527
loss_pred:0.03675523027777672, decouple_loss:0.031134258955717087
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43075430393218994, gen p mean: 0.0, mean p set: 0.4490925371646881
The modified gen p mean: 0.43160831928253174, gen p mean: 0.0, mean p set: 0.44782212376594543
The modified gen p mean: 0.42966872453689575, gen p mean: 0.0, mean p set: 0.4512310028076172
loss_pred:0.036739785224199295, decouple_loss:0.03142951801419258
loss_pred:0.03711468726396561, decouple_loss:0.03192560002207756
loss_pred:0.03486925736069679, decouple_loss:0.031130829825997353
2023-05-02 19:51:11 testing...
The modified gen p mean: 0.4330698549747467, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4413779377937317, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4391085207462311, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03792209550738335, decouple_loss:0.03386582434177399
loss_pred:0.03591093420982361, decouple_loss:0.03345075622200966
loss_pred:0.03674498572945595, decouple_loss:0.03197862580418587
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03851425647735596, avg_mse: 0.04055260494351387
current test mse: 0.040553
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44069695472717285, gen p mean: 0.0, mean p set: 0.44788995385169983
loss_pred:0.03567258268594742, decouple_loss:0.030835406854748726
The modified gen p mean: 0.43984317779541016, gen p mean: 0.0, mean p set: 0.45111238956451416
loss_pred:0.037547897547483444, decouple_loss:0.03344011679291725
The modified gen p mean: 0.4410635232925415, gen p mean: 0.0, mean p set: 0.4503222107887268
loss_pred:0.03751177340745926, decouple_loss:0.0310999546200037
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.47217074036598206, gen p mean: 0.0, mean p set: 0.4488682746887207
The modified gen p mean: 0.4673081338405609, gen p mean: 0.0, mean p set: 0.4476262331008911
The modified gen p mean: 0.4690186679363251, gen p mean: 0.0, mean p set: 0.45055249333381653
loss_pred:0.036015983670949936, decouple_loss:0.030005745589733124
loss_pred:0.035862214863300323, decouple_loss:0.03036457672715187
loss_pred:0.035326436161994934, decouple_loss:0.03080819733440876
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4547882378101349, gen p mean: 0.0, mean p set: 0.4507937431335449
The modified gen p mean: 0.4520668387413025, gen p mean: 0.0, mean p set: 0.4479601979255676
The modified gen p mean: 0.45480629801750183, gen p mean: 0.0, mean p set: 0.4483179748058319
loss_pred:0.035080187022686005, decouple_loss:0.030580850318074226
loss_pred:0.03553534299135208, decouple_loss:0.030622927471995354
loss_pred:0.03715819492936134, decouple_loss:0.030326345935463905
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4363855719566345, gen p mean: 0.0, mean p set: 0.44774648547172546
The modified gen p mean: 0.441072553396225, gen p mean: 0.0, mean p set: 0.4478653073310852
The modified gen p mean: 0.43921852111816406, gen p mean: 0.0, mean p set: 0.4485982656478882
loss_pred:0.03513642027974129, decouple_loss:0.030797071754932404
loss_pred:0.03788253292441368, decouple_loss:0.03111838549375534
loss_pred:0.03846010938286781, decouple_loss:0.030199801549315453
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44601985812187195, gen p mean: 0.0, mean p set: 0.4506188929080963
The modified gen p mean: 0.4443231225013733, gen p mean: 0.0, mean p set: 0.4490744471549988
The modified gen p mean: 0.44185423851013184, gen p mean: 0.0, mean p set: 0.45071908831596375
loss_pred:0.03691443055868149, decouple_loss:0.031244290992617607
loss_pred:0.03743371739983559, decouple_loss:0.02910832315683365
loss_pred:0.03609846532344818, decouple_loss:0.03239794448018074
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46094202995300293, gen p mean: 0.0, mean p set: 0.45033523440361023
The modified gen p mean: 0.4584803283214569, gen p mean: 0.0, mean p set: 0.44907310605049133
The modified gen p mean: 0.456190288066864, gen p mean: 0.0, mean p set: 0.4502470791339874
loss_pred:0.036223385483026505, decouple_loss:0.032035987824201584
loss_pred:0.03764816001057625, decouple_loss:0.0315772108733654
loss_pred:0.037481486797332764, decouple_loss:0.031502775847911835
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44618168473243713, gen p mean: 0.0, mean p set: 0.45013487339019775
The modified gen p mean: 0.442263662815094, gen p mean: 0.0, mean p set: 0.45115435123443604
The modified gen p mean: 0.44229719042778015, gen p mean: 0.0, mean p set: 0.44839444756507874
loss_pred:0.036245185881853104, decouple_loss:0.03123869001865387
loss_pred:0.037142060697078705, decouple_loss:0.030883247032761574
loss_pred:0.03572104871273041, decouple_loss:0.0308521818369627
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44454333186149597, gen p mean: 0.0, mean p set: 0.4511011838912964
The modified gen p mean: 0.44323253631591797, gen p mean: 0.0, mean p set: 0.4503651261329651
The modified gen p mean: 0.4408675730228424, gen p mean: 0.0, mean p set: 0.45049184560775757
loss_pred:0.03571714460849762, decouple_loss:0.030304880812764168
loss_pred:0.03703556954860687, decouple_loss:0.02997925877571106
loss_pred:0.036934006959199905, decouple_loss:0.030626505613327026
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4566453695297241, gen p mean: 0.0, mean p set: 0.4503746032714844
The modified gen p mean: 0.45363056659698486, gen p mean: 0.0, mean p set: 0.4507611393928528
The modified gen p mean: 0.4598335325717926, gen p mean: 0.0, mean p set: 0.4483151137828827
loss_pred:0.03634558618068695, decouple_loss:0.029884373769164085
loss_pred:0.03659379109740257, decouple_loss:0.03146498650312424
loss_pred:0.03728185221552849, decouple_loss:0.029887033626437187
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4571021497249603, gen p mean: 0.0, mean p set: 0.44826221466064453
The modified gen p mean: 0.45371758937835693, gen p mean: 0.0, mean p set: 0.45058971643447876
The modified gen p mean: 0.46073800325393677, gen p mean: 0.0, mean p set: 0.45016783475875854
loss_pred:0.03782049939036369, decouple_loss:0.031571146100759506
loss_pred:0.0340760238468647, decouple_loss:0.03027292899787426
loss_pred:0.03440197929739952, decouple_loss:0.031588222831487656
2023-05-02 19:54:53 testing...
The modified gen p mean: 0.43597671389579773, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4454677104949951, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44217199087142944, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03805721178650856, decouple_loss:0.03392792493104935
loss_pred:0.03589913994073868, decouple_loss:0.03331862762570381
loss_pred:0.03691880777478218, decouple_loss:0.0322582982480526
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03861680254340172, avg_mse: 0.040772370994091034
current test mse: 0.040772
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462168514728546, gen p mean: 0.0, mean p set: 0.4486616849899292
The modified gen p mean: 0.44582119584083557, gen p mean: 0.0, mean p set: 0.44887787103652954
loss_pred:0.03806159645318985, decouple_loss:0.030027536675333977
loss_pred:0.037774864584207535, decouple_loss:0.030873224139213562
The modified gen p mean: 0.44902607798576355, gen p mean: 0.0, mean p set: 0.4504888951778412
loss_pred:0.034486379474401474, decouple_loss:0.030960511416196823
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4439307153224945, gen p mean: 0.0, mean p set: 0.44843941926956177
The modified gen p mean: 0.4421270489692688, gen p mean: 0.0, mean p set: 0.44738414883613586
The modified gen p mean: 0.4436592161655426, gen p mean: 0.0, mean p set: 0.4494239091873169
loss_pred:0.03731715679168701, decouple_loss:0.03264399617910385
loss_pred:0.037027209997177124, decouple_loss:0.030530760064721107
loss_pred:0.03693611919879913, decouple_loss:0.0313638374209404
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450037181377411, gen p mean: 0.0, mean p set: 0.45098060369491577
The modified gen p mean: 0.4463006258010864, gen p mean: 0.0, mean p set: 0.4484964609146118
The modified gen p mean: 0.4466572105884552, gen p mean: 0.0, mean p set: 0.4475100636482239
loss_pred:0.036633335053920746, decouple_loss:0.033591531217098236
loss_pred:0.03628992661833763, decouple_loss:0.032605189830064774
loss_pred:0.03659740090370178, decouple_loss:0.03186769038438797
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4435388147830963, gen p mean: 0.0, mean p set: 0.44880932569503784
The modified gen p mean: 0.4477370083332062, gen p mean: 0.0, mean p set: 0.44864022731781006
The modified gen p mean: 0.44154852628707886, gen p mean: 0.0, mean p set: 0.4485420286655426
loss_pred:0.036474402993917465, decouple_loss:0.032520610839128494
loss_pred:0.037594273686409, decouple_loss:0.03339924290776253
loss_pred:0.037151459604501724, decouple_loss:0.03373892605304718
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45312634110450745, gen p mean: 0.0, mean p set: 0.44889357686042786
The modified gen p mean: 0.4532337784767151, gen p mean: 0.0, mean p set: 0.4489334523677826
The modified gen p mean: 0.45748063921928406, gen p mean: 0.0, mean p set: 0.44730088114738464
loss_pred:0.03541799262166023, decouple_loss:0.03130015730857849
loss_pred:0.035993240773677826, decouple_loss:0.032782383263111115
loss_pred:0.03573116660118103, decouple_loss:0.03131622076034546
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46653586626052856, gen p mean: 0.0, mean p set: 0.44894805550575256
The modified gen p mean: 0.4676453769207001, gen p mean: 0.0, mean p set: 0.44823071360588074
The modified gen p mean: 0.46274906396865845, gen p mean: 0.0, mean p set: 0.4486970603466034
loss_pred:0.03664613142609596, decouple_loss:0.03226654231548309
loss_pred:0.03727801516652107, decouple_loss:0.03262033686041832
loss_pred:0.03668733686208725, decouple_loss:0.03257349133491516
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4429360628128052, gen p mean: 0.0, mean p set: 0.4478953182697296
The modified gen p mean: 0.4418903589248657, gen p mean: 0.0, mean p set: 0.4491152763366699
The modified gen p mean: 0.4437018632888794, gen p mean: 0.0, mean p set: 0.4494667053222656
loss_pred:0.03588803857564926, decouple_loss:0.0297717098146677
loss_pred:0.035442616790533066, decouple_loss:0.030983494594693184
loss_pred:0.03652767091989517, decouple_loss:0.029961420223116875
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42864593863487244, gen p mean: 0.0, mean p set: 0.4495035707950592
The modified gen p mean: 0.429127037525177, gen p mean: 0.0, mean p set: 0.4481446146965027
The modified gen p mean: 0.43102124333381653, gen p mean: 0.0, mean p set: 0.4480955898761749
loss_pred:0.03626736253499985, decouple_loss:0.030620435252785683
loss_pred:0.03732568025588989, decouple_loss:0.03097514435648918
loss_pred:0.03746074065566063, decouple_loss:0.03077319823205471
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45320355892181396, gen p mean: 0.0, mean p set: 0.448505699634552
The modified gen p mean: 0.4542868435382843, gen p mean: 0.0, mean p set: 0.4483504593372345
The modified gen p mean: 0.45369842648506165, gen p mean: 0.0, mean p set: 0.44892609119415283
loss_pred:0.035957761108875275, decouple_loss:0.03038671426475048
loss_pred:0.03640548884868622, decouple_loss:0.03115343488752842
loss_pred:0.035985901951789856, decouple_loss:0.030369115993380547
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46302175521850586, gen p mean: 0.0, mean p set: 0.44902175664901733
The modified gen p mean: 0.46366775035858154, gen p mean: 0.0, mean p set: 0.44901901483535767
The modified gen p mean: 0.45979005098342896, gen p mean: 0.0, mean p set: 0.4510541558265686
loss_pred:0.0373348705470562, decouple_loss:0.030096188187599182
loss_pred:0.036682743579149246, decouple_loss:0.030522869899868965
loss_pred:0.03606047108769417, decouple_loss:0.03135408088564873
2023-05-02 19:59:33 testing...
The modified gen p mean: 0.4451170563697815, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4537181556224823, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4508087635040283, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03718635067343712, decouple_loss:0.030926378443837166
loss_pred:0.03514103963971138, decouple_loss:0.030334671959280968
loss_pred:0.03624911233782768, decouple_loss:0.029602861031889915
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03770656883716583, avg_mse: 0.039689794182777405
current test mse: 0.03969
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478338956832886, gen p mean: 0.0, mean p set: 0.44869375228881836
The modified gen p mean: 0.4541737139225006, gen p mean: 0.0, mean p set: 0.44909510016441345
loss_pred:0.03519739583134651, decouple_loss:0.02943005971610546
loss_pred:0.03634028136730194, decouple_loss:0.02937275916337967
The modified gen p mean: 0.4490247666835785, gen p mean: 0.0, mean p set: 0.4488562345504761
loss_pred:0.03579556941986084, decouple_loss:0.030356287956237793
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44607558846473694, gen p mean: 0.0, mean p set: 0.4502216577529907
The modified gen p mean: 0.44031521677970886, gen p mean: 0.0, mean p set: 0.4481230676174164
The modified gen p mean: 0.43729516863822937, gen p mean: 0.0, mean p set: 0.44932815432548523
loss_pred:0.03715619072318077, decouple_loss:0.03022908791899681
loss_pred:0.03730873391032219, decouple_loss:0.031947843730449677
loss_pred:0.035091206431388855, decouple_loss:0.029951656237244606
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520149827003479, gen p mean: 0.0, mean p set: 0.44935348629951477
The modified gen p mean: 0.44782793521881104, gen p mean: 0.0, mean p set: 0.44937342405319214
The modified gen p mean: 0.4550851285457611, gen p mean: 0.0, mean p set: 0.448650062084198
loss_pred:0.03667150065302849, decouple_loss:0.030005579814314842
loss_pred:0.03558637574315071, decouple_loss:0.029783129692077637
loss_pred:0.037383802235126495, decouple_loss:0.03044896386563778
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44197630882263184, gen p mean: 0.0, mean p set: 0.4492042660713196
The modified gen p mean: 0.4469711482524872, gen p mean: 0.0, mean p set: 0.4479316174983978
The modified gen p mean: 0.44475284218788147, gen p mean: 0.0, mean p set: 0.4477364122867584
loss_pred:0.0344725102186203, decouple_loss:0.030800750479102135
loss_pred:0.03588201478123665, decouple_loss:0.02974274381995201
loss_pred:0.03693618252873421, decouple_loss:0.030833899974822998
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44573792815208435, gen p mean: 0.0, mean p set: 0.44871968030929565
The modified gen p mean: 0.4537816047668457, gen p mean: 0.0, mean p set: 0.44984006881713867
The modified gen p mean: 0.44495338201522827, gen p mean: 0.0, mean p set: 0.4486437141895294
loss_pred:0.035862237215042114, decouple_loss:0.029736977070569992
loss_pred:0.03723831847310066, decouple_loss:0.02920614928007126
loss_pred:0.03501999378204346, decouple_loss:0.031061584129929543
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4579562544822693, gen p mean: 0.0, mean p set: 0.44872117042541504
The modified gen p mean: 0.46148481965065, gen p mean: 0.0, mean p set: 0.4479077458381653
The modified gen p mean: 0.4554353952407837, gen p mean: 0.0, mean p set: 0.4492855668067932
loss_pred:0.037014786154031754, decouple_loss:0.02917967364192009
loss_pred:0.0363994836807251, decouple_loss:0.030615298077464104
loss_pred:0.03505059704184532, decouple_loss:0.030372994020581245
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4432675242424011, gen p mean: 0.0, mean p set: 0.4480842351913452
The modified gen p mean: 0.4483044445514679, gen p mean: 0.0, mean p set: 0.44727620482444763
The modified gen p mean: 0.44136136770248413, gen p mean: 0.0, mean p set: 0.4498688280582428
loss_pred:0.03521670028567314, decouple_loss:0.028896499425172806
loss_pred:0.03520176187157631, decouple_loss:0.029183007776737213
loss_pred:0.035832639783620834, decouple_loss:0.029328277334570885
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4442821443080902, gen p mean: 0.0, mean p set: 0.44881969690322876
The modified gen p mean: 0.44601985812187195, gen p mean: 0.0, mean p set: 0.448621928691864
The modified gen p mean: 0.44088083505630493, gen p mean: 0.0, mean p set: 0.44863688945770264
loss_pred:0.03694882243871689, decouple_loss:0.02886662818491459
loss_pred:0.037014350295066833, decouple_loss:0.03009294532239437
loss_pred:0.03505956009030342, decouple_loss:0.029444023966789246
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4561697840690613, gen p mean: 0.0, mean p set: 0.448231041431427
The modified gen p mean: 0.45171815156936646, gen p mean: 0.0, mean p set: 0.44984567165374756
The modified gen p mean: 0.4562705457210541, gen p mean: 0.0, mean p set: 0.4482152760028839
loss_pred:0.03642851859331131, decouple_loss:0.030125590041279793
loss_pred:0.03651898354291916, decouple_loss:0.028894782066345215
loss_pred:0.03699653968214989, decouple_loss:0.030335577204823494
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455774128437042, gen p mean: 0.0, mean p set: 0.4494134187698364
The modified gen p mean: 0.45061802864074707, gen p mean: 0.0, mean p set: 0.4489465653896332
The modified gen p mean: 0.4484105110168457, gen p mean: 0.0, mean p set: 0.449531614780426
loss_pred:0.03385215625166893, decouple_loss:0.029613176360726357
loss_pred:0.035507041960954666, decouple_loss:0.029219897463917732
loss_pred:0.036290984600782394, decouple_loss:0.029329907149076462
2023-05-02 20:03:16 testing...
The modified gen p mean: 0.4381089508533478, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4437578320503235, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4468855857849121, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03717084601521492, decouple_loss:0.030390901491045952
loss_pred:0.03615925833582878, decouple_loss:0.029449177905917168
loss_pred:0.035085298120975494, decouple_loss:0.030048362910747528
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03763660788536072, avg_mse: 0.03966866806149483
current test mse: 0.039669
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43865329027175903, gen p mean: 0.0, mean p set: 0.4496456980705261
The modified gen p mean: 0.44527000188827515, gen p mean: 0.0, mean p set: 0.4477311074733734
loss_pred:0.035667434334754944, decouple_loss:0.02998725324869156
loss_pred:0.03568727895617485, decouple_loss:0.028793614357709885
The modified gen p mean: 0.4412113130092621, gen p mean: 0.0, mean p set: 0.44891637563705444
loss_pred:0.03431007266044617, decouple_loss:0.029215829446911812
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
NaN value num: 0
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454121857881546, gen p mean: 0.0, mean p set: 0.4526461362838745
The modified gen p mean: 0.45839130878448486, gen p mean: 0.0, mean p set: 0.4519725739955902
The modified gen p mean: 0.4583105146884918, gen p mean: 0.0, mean p set: 0.4490357041358948
loss_pred:0.036623068153858185, decouple_loss:0.030992358922958374
loss_pred:0.03494371473789215, decouple_loss:0.03392115980386734
loss_pred:0.03498000279068947, decouple_loss:0.030425583943724632
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45461389422416687, gen p mean: 0.0, mean p set: 0.45091211795806885
The modified gen p mean: 0.45708999037742615, gen p mean: 0.0, mean p set: 0.45107904076576233
The modified gen p mean: 0.46142247319221497, gen p mean: 0.0, mean p set: 0.44971778988838196
loss_pred:0.03710811212658882, decouple_loss:0.029816430062055588
loss_pred:0.03553137555718422, decouple_loss:0.0317128524184227
loss_pred:0.03523833677172661, decouple_loss:0.029986076056957245
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490194320678711, gen p mean: 0.0, mean p set: 0.45124614238739014
The modified gen p mean: 0.44697391986846924, gen p mean: 0.0, mean p set: 0.4502776563167572
The modified gen p mean: 0.4483620822429657, gen p mean: 0.0, mean p set: 0.451975017786026
loss_pred:0.03616733476519585, decouple_loss:0.03185512498021126
loss_pred:0.03562626615166664, decouple_loss:0.031137356534600258
loss_pred:0.03542649745941162, decouple_loss:0.030504409223794937
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763168692588806, gen p mean: 0.0, mean p set: 0.4525558054447174
The modified gen p mean: 0.44583630561828613, gen p mean: 0.0, mean p set: 0.451738178730011
The modified gen p mean: 0.4489283859729767, gen p mean: 0.0, mean p set: 0.4517255127429962
loss_pred:0.0350114107131958, decouple_loss:0.03137955069541931
loss_pred:0.035702452063560486, decouple_loss:0.030803117901086807
loss_pred:0.0347234308719635, decouple_loss:0.030859442427754402
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515657126903534, gen p mean: 0.0, mean p set: 0.45128580927848816
The modified gen p mean: 0.4514010548591614, gen p mean: 0.0, mean p set: 0.45022767782211304
The modified gen p mean: 0.45247021317481995, gen p mean: 0.0, mean p set: 0.4501636028289795
loss_pred:0.034742359071969986, decouple_loss:0.02917267009615898
loss_pred:0.03701312839984894, decouple_loss:0.0289754718542099
loss_pred:0.03597882390022278, decouple_loss:0.03001539036631584
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497956931591034, gen p mean: 0.0, mean p set: 0.45261847972869873
The modified gen p mean: 0.447982519865036, gen p mean: 0.0, mean p set: 0.4510199725627899
The modified gen p mean: 0.45360296964645386, gen p mean: 0.0, mean p set: 0.4493648409843445
loss_pred:0.03629326820373535, decouple_loss:0.02973000518977642
loss_pred:0.036546770483255386, decouple_loss:0.029183248057961464
loss_pred:0.035235244780778885, decouple_loss:0.02973346784710884
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45192229747772217, gen p mean: 0.0, mean p set: 0.45132896304130554
The modified gen p mean: 0.4494904577732086, gen p mean: 0.0, mean p set: 0.4498707354068756
The modified gen p mean: 0.45599570870399475, gen p mean: 0.0, mean p set: 0.44918093085289
loss_pred:0.036622304469347, decouple_loss:0.029184766113758087
loss_pred:0.03551732003688812, decouple_loss:0.030280334874987602
loss_pred:0.0356789231300354, decouple_loss:0.03133659437298775
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670477509498596, gen p mean: 0.0, mean p set: 0.4520263373851776
The modified gen p mean: 0.4530714452266693, gen p mean: 0.0, mean p set: 0.45182791352272034
The modified gen p mean: 0.45368024706840515, gen p mean: 0.0, mean p set: 0.45133697986602783
loss_pred:0.035176265984773636, decouple_loss:0.02897598035633564
loss_pred:0.035885781049728394, decouple_loss:0.02887377329170704
loss_pred:0.036335453391075134, decouple_loss:0.028816763311624527
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044779777526855, gen p mean: 0.0, mean p set: 0.4520416855812073
The modified gen p mean: 0.45173266530036926, gen p mean: 0.0, mean p set: 0.45284390449523926
The modified gen p mean: 0.45226845145225525, gen p mean: 0.0, mean p set: 0.45099982619285583
loss_pred:0.03564548119902611, decouple_loss:0.028907814994454384
loss_pred:0.03663400933146477, decouple_loss:0.02858923375606537
loss_pred:0.036398746073246, decouple_loss:0.028173185884952545
2023-05-02 20:07:38 testing...
The modified gen p mean: 0.44250980019569397, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4519253075122833, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4486803412437439, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03710903972387314, decouple_loss:0.033043310046195984
loss_pred:0.035241734236478806, decouple_loss:0.032912470400333405
loss_pred:0.036164943128824234, decouple_loss:0.031550608575344086
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03779701143503189, avg_mse: 0.039952151477336884
current test mse: 0.039952
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853922724723816, gen p mean: 0.0, mean p set: 0.452089786529541
The modified gen p mean: 0.4533592760562897, gen p mean: 0.0, mean p set: 0.45320096611976624
loss_pred:0.03413956239819527, decouple_loss:0.029466701671481133
loss_pred:0.03627871721982956, decouple_loss:0.030538693070411682
The modified gen p mean: 0.4546546936035156, gen p mean: 0.0, mean p set: 0.45318490266799927
loss_pred:0.03692095726728439, decouple_loss:0.02959047071635723
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460287094116211, gen p mean: 0.0, mean p set: 0.4523043632507324The modified gen p mean: 0.4432699382305145, gen p mean: 0.0, mean p set: 0.45052674412727356
The modified gen p mean: 0.4393649697303772, gen p mean: 0.0, mean p set: 0.45178547501564026
loss_pred:0.03472934663295746, decouple_loss:0.030620120465755463
loss_pred:0.03570946678519249, decouple_loss:0.030604708939790726
loss_pred:0.034873057156801224, decouple_loss:0.028387153521180153
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46424105763435364, gen p mean: 0.0, mean p set: 0.44959568977355957
The modified gen p mean: 0.4636891484260559, gen p mean: 0.0, mean p set: 0.4494280517101288
The modified gen p mean: 0.4613453149795532, gen p mean: 0.0, mean p set: 0.45177412033081055
loss_pred:0.03555724024772644, decouple_loss:0.02832997590303421loss_pred:0.03455309942364693, decouple_loss:0.03078109584748745
loss_pred:0.0348384864628315, decouple_loss:0.02960553951561451
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.455157607793808, gen p mean: 0.0, mean p set: 0.4518203139305115
The modified gen p mean: 0.4541115462779999, gen p mean: 0.0, mean p set: 0.45206621289253235
The modified gen p mean: 0.4561462700366974, gen p mean: 0.0, mean p set: 0.44902369379997253
loss_pred:0.03549525886774063, decouple_loss:0.02838936075568199
loss_pred:0.03580746799707413, decouple_loss:0.027849484235048294
loss_pred:0.03537561744451523, decouple_loss:0.030185116454958916
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4364929497241974, gen p mean: 0.0, mean p set: 0.4504190683364868
The modified gen p mean: 0.4375323951244354, gen p mean: 0.0, mean p set: 0.45269572734832764
The modified gen p mean: 0.4348233938217163, gen p mean: 0.0, mean p set: 0.45099470019340515
loss_pred:0.03699047863483429, decouple_loss:0.029124867171049118
loss_pred:0.033775050193071365, decouple_loss:0.028925564140081406
loss_pred:0.03679760918021202, decouple_loss:0.02949175424873829
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45241579413414, gen p mean: 0.0, mean p set: 0.4498874545097351
The modified gen p mean: 0.44773411750793457, gen p mean: 0.0, mean p set: 0.45221275091171265
The modified gen p mean: 0.4451419413089752, gen p mean: 0.0, mean p set: 0.45100730657577515
loss_pred:0.034614838659763336, decouple_loss:0.029601095244288445
loss_pred:0.03580299764871597, decouple_loss:0.02881705015897751
loss_pred:0.03666745126247406, decouple_loss:0.028934789821505547
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46257084608078003, gen p mean: 0.0, mean p set: 0.4497344493865967
The modified gen p mean: 0.46074792742729187, gen p mean: 0.0, mean p set: 0.45314162969589233
The modified gen p mean: 0.4636891186237335, gen p mean: 0.0, mean p set: 0.45273545384407043
loss_pred:0.03511862829327583, decouple_loss:0.029035018756985664
loss_pred:0.03626234084367752, decouple_loss:0.030916351824998856
loss_pred:0.03545317426323891, decouple_loss:0.03045913204550743
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45712390542030334, gen p mean: 0.0, mean p set: 0.4495902955532074
The modified gen p mean: 0.4537437856197357, gen p mean: 0.0, mean p set: 0.4502570331096649
The modified gen p mean: 0.4560977518558502, gen p mean: 0.0, mean p set: 0.4541929364204407
loss_pred:0.0345471054315567, decouple_loss:0.0289118904620409
loss_pred:0.03649662807583809, decouple_loss:0.0290828924626112
loss_pred:0.035630322992801666, decouple_loss:0.029664725065231323
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44370371103286743, gen p mean: 0.0, mean p set: 0.4536430835723877
The modified gen p mean: 0.44670286774635315, gen p mean: 0.0, mean p set: 0.450082391500473
The modified gen p mean: 0.4432591497898102, gen p mean: 0.0, mean p set: 0.4517350196838379
loss_pred:0.036640312522649765, decouple_loss:0.028615819290280342
loss_pred:0.034979622811079025, decouple_loss:0.029101021587848663
loss_pred:0.03480781987309456, decouple_loss:0.029406871646642685
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512915015220642, gen p mean: 0.0, mean p set: 0.4514558017253876
The modified gen p mean: 0.453845351934433, gen p mean: 0.0, mean p set: 0.4509369134902954
The modified gen p mean: 0.44963526725769043, gen p mean: 0.0, mean p set: 0.45125362277030945
loss_pred:0.035981401801109314, decouple_loss:0.02860880456864834
loss_pred:0.03671591728925705, decouple_loss:0.02861703559756279
loss_pred:0.03475585952401161, decouple_loss:0.029755432158708572
2023-05-02 20:11:23 testing...
The modified gen p mean: 0.4439414441585541, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4504028260707855, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4533441960811615, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03717576712369919, decouple_loss:0.03309796378016472
loss_pred:0.035204898566007614, decouple_loss:0.032408807426691055loss_pred:0.03616942837834358, decouple_loss:0.03134719282388687
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03779760003089905, avg_mse: 0.04010797664523125
current test mse: 0.040108
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504263699054718, gen p mean: 0.0, mean p set: 0.4519027769565582
loss_pred:0.03363075107336044, decouple_loss:0.029500609263777733
The modified gen p mean: 0.45355817675590515, gen p mean: 0.0, mean p set: 0.4536963999271393
loss_pred:0.035514939576387405, decouple_loss:0.029918907210230827
The modified gen p mean: 0.4542800486087799, gen p mean: 0.0, mean p set: 0.4501683712005615
loss_pred:0.036416541785001755, decouple_loss:0.028655584901571274
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
NaN value num: 0
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530830681324005, gen p mean: 0.0, mean p set: 0.44864723086357117
The modified gen p mean: 0.44733279943466187, gen p mean: 0.0, mean p set: 0.4500735104084015
The modified gen p mean: 0.4527681767940521, gen p mean: 0.0, mean p set: 0.4500521421432495
loss_pred:0.03660554066300392, decouple_loss:0.0341605581343174
loss_pred:0.036578744649887085, decouple_loss:0.03391816467046738
loss_pred:0.03807857632637024, decouple_loss:0.03398444876074791
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508247971534729, gen p mean: 0.0, mean p set: 0.4507625102996826
The modified gen p mean: 0.4538911283016205, gen p mean: 0.0, mean p set: 0.44925227761268616
The modified gen p mean: 0.45304548740386963, gen p mean: 0.0, mean p set: 0.44983765482902527
loss_pred:0.03869401291012764, decouple_loss:0.03310360759496689
loss_pred:0.03780053183436394, decouple_loss:0.03295750543475151
loss_pred:0.03604409471154213, decouple_loss:0.0336252897977829
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517958462238312, gen p mean: 0.0, mean p set: 0.44925400614738464
The modified gen p mean: 0.4493551552295685, gen p mean: 0.0, mean p set: 0.4502195417881012
The modified gen p mean: 0.453174352645874, gen p mean: 0.0, mean p set: 0.44943687319755554
loss_pred:0.03697952255606651, decouple_loss:0.03384752199053764
loss_pred:0.03828037902712822, decouple_loss:0.03220698609948158
loss_pred:0.03742693364620209, decouple_loss:0.030950402840971947
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451863467693329, gen p mean: 0.0, mean p set: 0.44875091314315796
The modified gen p mean: 0.44492408633232117, gen p mean: 0.0, mean p set: 0.4504740536212921
The modified gen p mean: 0.443986177444458, gen p mean: 0.0, mean p set: 0.44967401027679443
loss_pred:0.037260133773088455, decouple_loss:0.031117863953113556
loss_pred:0.037530381232500076, decouple_loss:0.03144019842147827
loss_pred:0.037752773612737656, decouple_loss:0.031471461057662964
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510631859302521, gen p mean: 0.0, mean p set: 0.4499465525150299
The modified gen p mean: 0.44875937700271606, gen p mean: 0.0, mean p set: 0.45043838024139404
The modified gen p mean: 0.4436223804950714, gen p mean: 0.0, mean p set: 0.450113981962204
loss_pred:0.03591535985469818, decouple_loss:0.031132666394114494
loss_pred:0.03738424554467201, decouple_loss:0.031875062733888626
loss_pred:0.03794137388467789, decouple_loss:0.03234351426362991
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461876153945923, gen p mean: 0.0, mean p set: 0.4487350583076477
The modified gen p mean: 0.4495919644832611, gen p mean: 0.0, mean p set: 0.4493584930896759
The modified gen p mean: 0.44592684507369995, gen p mean: 0.0, mean p set: 0.4501986801624298
loss_pred:0.03707687929272652, decouple_loss:0.03121865540742874
loss_pred:0.03981075435876846, decouple_loss:0.03059266321361065
loss_pred:0.037003349512815475, decouple_loss:0.030358705669641495
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048788189888, gen p mean: 0.0, mean p set: 0.44925686717033386
The modified gen p mean: 0.44790518283843994, gen p mean: 0.0, mean p set: 0.4491483271121979
The modified gen p mean: 0.4473073482513428, gen p mean: 0.0, mean p set: 0.45020923018455505
loss_pred:0.03741041198372841, decouple_loss:0.03013630397617817
loss_pred:0.037222523242235184, decouple_loss:0.03064553253352642
loss_pred:0.03775705397129059, decouple_loss:0.030363373458385468
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45604458451271057, gen p mean: 0.0, mean p set: 0.450385719537735
The modified gen p mean: 0.45776134729385376, gen p mean: 0.0, mean p set: 0.4501313269138336
The modified gen p mean: 0.45842453837394714, gen p mean: 0.0, mean p set: 0.45061272382736206
loss_pred:0.036788210272789, decouple_loss:0.0307787898927927
loss_pred:0.03759817034006119, decouple_loss:0.031468916684389114
loss_pred:0.03872794285416603, decouple_loss:0.03133482113480568
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529094099998474, gen p mean: 0.0, mean p set: 0.4491247832775116
The modified gen p mean: 0.4561803936958313, gen p mean: 0.0, mean p set: 0.44902318716049194
The modified gen p mean: 0.4581204950809479, gen p mean: 0.0, mean p set: 0.449175626039505
loss_pred:0.037378739565610886, decouple_loss:0.03208406642079353
loss_pred:0.03688604012131691, decouple_loss:0.03175544738769531
loss_pred:0.036931563168764114, decouple_loss:0.02995995245873928
2023-05-02 20:15:45 testing...
The modified gen p mean: 0.43442031741142273, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.444047212600708, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.440687894821167, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.037081241607666016, decouple_loss:0.03334849327802658
loss_pred:0.0351150706410408, decouple_loss:0.032230012118816376
loss_pred:0.036050885915756226, decouple_loss:0.03156126290559769
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03770139813423157, avg_mse: 0.03976348415017128
current test mse: 0.039763
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4394664466381073, gen p mean: 0.0, mean p set: 0.4494764804840088
loss_pred:0.03679819032549858, decouple_loss:0.03157024830579758
The modified gen p mean: 0.43771129846572876, gen p mean: 0.0, mean p set: 0.44966015219688416
loss_pred:0.0368560329079628, decouple_loss:0.03171689808368683
The modified gen p mean: 0.4428708851337433, gen p mean: 0.0, mean p set: 0.4499370753765106
loss_pred:0.036962345242500305, decouple_loss:0.029957987368106842
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4546096920967102, gen p mean: 0.0, mean p set: 0.45019885897636414
The modified gen p mean: 0.45422816276550293, gen p mean: 0.0, mean p set: 0.4506526291370392
The modified gen p mean: 0.45426875352859497, gen p mean: 0.0, mean p set: 0.4499610364437103
loss_pred:0.03810571879148483, decouple_loss:0.031211888417601585
loss_pred:0.03809826448559761, decouple_loss:0.03125931695103645
loss_pred:0.03659145534038544, decouple_loss:0.03007064200937748
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.459028035402298, gen p mean: 0.0, mean p set: 0.4494244158267975
The modified gen p mean: 0.4613915681838989, gen p mean: 0.0, mean p set: 0.4495510160923004
The modified gen p mean: 0.46167054772377014, gen p mean: 0.0, mean p set: 0.4490078091621399
loss_pred:0.03572401776909828, decouple_loss:0.03112087771296501
loss_pred:0.03967445716261864, decouple_loss:0.03063759207725525
loss_pred:0.03658684715628624, decouple_loss:0.030697425827383995
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4365651309490204, gen p mean: 0.0, mean p set: 0.4494204819202423
The modified gen p mean: 0.433652400970459, gen p mean: 0.0, mean p set: 0.4483890235424042
The modified gen p mean: 0.43356508016586304, gen p mean: 0.0, mean p set: 0.4503738284111023
loss_pred:0.039046112447977066, decouple_loss:0.031061243265867233
loss_pred:0.03628258779644966, decouple_loss:0.030827263370156288
loss_pred:0.03650403767824173, decouple_loss:0.030693329870700836
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44099587202072144, gen p mean: 0.0, mean p set: 0.4497062563896179
The modified gen p mean: 0.44271573424339294, gen p mean: 0.0, mean p set: 0.45009905099868774
The modified gen p mean: 0.44402340054512024, gen p mean: 0.0, mean p set: 0.44867777824401855
loss_pred:0.036291856318712234, decouple_loss:0.029861770570278168
loss_pred:0.03714173287153244, decouple_loss:0.030100611969828606
loss_pred:0.0363362655043602, decouple_loss:0.030027320608496666
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46666279435157776, gen p mean: 0.0, mean p set: 0.4501812756061554
The modified gen p mean: 0.4739684760570526, gen p mean: 0.0, mean p set: 0.44929149746894836
The modified gen p mean: 0.4751366078853607, gen p mean: 0.0, mean p set: 0.4497784972190857
loss_pred:0.03737771511077881, decouple_loss:0.031116386875510216
loss_pred:0.038191258907318115, decouple_loss:0.030363764613866806
loss_pred:0.03943547233939171, decouple_loss:0.029231354594230652
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464779198169708, gen p mean: 0.0, mean p set: 0.45035961270332336The modified gen p mean: 0.4476780593395233, gen p mean: 0.0, mean p set: 0.4502294957637787
The modified gen p mean: 0.4510597288608551, gen p mean: 0.0, mean p set: 0.44995957612991333
loss_pred:0.038178421556949615, decouple_loss:0.028323743492364883
loss_pred:0.03787682205438614, decouple_loss:0.028585629537701607
loss_pred:0.03688545525074005, decouple_loss:0.028712455183267593
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.41895079612731934, gen p mean: 0.0, mean p set: 0.44920605421066284
The modified gen p mean: 0.42036280035972595, gen p mean: 0.0, mean p set: 0.45033130049705505
The modified gen p mean: 0.4276055693626404, gen p mean: 0.0, mean p set: 0.4486234188079834
loss_pred:0.03704703599214554, decouple_loss:0.031688522547483444
loss_pred:0.03755565360188484, decouple_loss:0.03074340522289276
loss_pred:0.037002548575401306, decouple_loss:0.03024502843618393
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46152180433273315, gen p mean: 0.0, mean p set: 0.4495299160480499
The modified gen p mean: 0.4652061462402344, gen p mean: 0.0, mean p set: 0.4491855800151825
The modified gen p mean: 0.46116751432418823, gen p mean: 0.0, mean p set: 0.45017439126968384
loss_pred:0.03693624213337898, decouple_loss:0.03021523915231228
loss_pred:0.03647994622588158, decouple_loss:0.030214687809348106
loss_pred:0.037625525146722794, decouple_loss:0.029522184282541275
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46870577335357666, gen p mean: 0.0, mean p set: 0.45085832476615906
The modified gen p mean: 0.4669850170612335, gen p mean: 0.0, mean p set: 0.4501429796218872
The modified gen p mean: 0.4712388515472412, gen p mean: 0.0, mean p set: 0.4489312171936035
loss_pred:0.03667088970541954, decouple_loss:0.029209909960627556
loss_pred:0.03618947044014931, decouple_loss:0.029203785583376884
loss_pred:0.03664568066596985, decouple_loss:0.029840528964996338
2023-05-02 20:19:30 testing...
The modified gen p mean: 0.4400736391544342, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4312343895435333, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.437136709690094, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.0349026657640934, decouple_loss:0.030629968270659447
loss_pred:0.03680619224905968, decouple_loss:0.030817819759249687
loss_pred:0.03580555319786072, decouple_loss:0.029774367809295654
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03735850751399994, avg_mse: 0.03950051590800285
current test mse: 0.039501
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43219268321990967, gen p mean: 0.0, mean p set: 0.44969442486763
The modified gen p mean: 0.4369703233242035, gen p mean: 0.0, mean p set: 0.4496876895427704
loss_pred:0.038367852568626404, decouple_loss:0.028034605085849762
loss_pred:0.037581540644168854, decouple_loss:0.02902996353805065
The modified gen p mean: 0.43736031651496887, gen p mean: 0.0, mean p set: 0.44897153973579407
loss_pred:0.03610842302441597, decouple_loss:0.027689790353178978
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43535494804382324, gen p mean: 0.0, mean p set: 0.4503842294216156
The modified gen p mean: 0.4379544258117676, gen p mean: 0.0, mean p set: 0.44900989532470703
The modified gen p mean: 0.4402067959308624, gen p mean: 0.0, mean p set: 0.4506332576274872
loss_pred:0.037055060267448425, decouple_loss:0.03185416758060455
loss_pred:0.03755301237106323, decouple_loss:0.03038901463150978
loss_pred:0.03519207239151001, decouple_loss:0.03189438581466675
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46363648772239685, gen p mean: 0.0, mean p set: 0.4498407244682312
The modified gen p mean: 0.4625413119792938, gen p mean: 0.0, mean p set: 0.4477255642414093
The modified gen p mean: 0.45921435952186584, gen p mean: 0.0, mean p set: 0.44930922985076904
loss_pred:0.03732220456004143, decouple_loss:0.030288364738225937
loss_pred:0.0359918586909771, decouple_loss:0.030903754755854607
loss_pred:0.03691812604665756, decouple_loss:0.031887445598840714
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4640989601612091, gen p mean: 0.0, mean p set: 0.450682133436203
The modified gen p mean: 0.46205854415893555, gen p mean: 0.0, mean p set: 0.4492279887199402
The modified gen p mean: 0.46956416964530945, gen p mean: 0.0, mean p set: 0.4492368996143341
loss_pred:0.036547403782606125, decouple_loss:0.030503569170832634
loss_pred:0.035975828766822815, decouple_loss:0.03082842007279396
loss_pred:0.03715410456061363, decouple_loss:0.03041858784854412
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4387320876121521, gen p mean: 0.0, mean p set: 0.44975459575653076
The modified gen p mean: 0.43498727679252625, gen p mean: 0.0, mean p set: 0.449288934469223
The modified gen p mean: 0.44074222445487976, gen p mean: 0.0, mean p set: 0.44861605763435364
loss_pred:0.03643178567290306, decouple_loss:0.03017348051071167
loss_pred:0.0364525206387043, decouple_loss:0.030367180705070496
loss_pred:0.03646860271692276, decouple_loss:0.03059929609298706
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4349364936351776, gen p mean: 0.0, mean p set: 0.45022737979888916
The modified gen p mean: 0.4388159215450287, gen p mean: 0.0, mean p set: 0.4499235153198242
The modified gen p mean: 0.44289812445640564, gen p mean: 0.0, mean p set: 0.4485895335674286
loss_pred:0.03743206337094307, decouple_loss:0.029034722596406937
loss_pred:0.037239380180835724, decouple_loss:0.029142189770936966
loss_pred:0.03621550649404526, decouple_loss:0.028631649911403656
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45527327060699463, gen p mean: 0.0, mean p set: 0.4500616788864136
The modified gen p mean: 0.45976099371910095, gen p mean: 0.0, mean p set: 0.44936034083366394
The modified gen p mean: 0.4575067460536957, gen p mean: 0.0, mean p set: 0.4481198489665985
loss_pred:0.037325769662857056, decouple_loss:0.029039690271019936
loss_pred:0.03630832955241203, decouple_loss:0.029091117903590202
loss_pred:0.03608742728829384, decouple_loss:0.029588894918560982
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4595213830471039, gen p mean: 0.0, mean p set: 0.44820713996887207
The modified gen p mean: 0.4579583704471588, gen p mean: 0.0, mean p set: 0.449687123298645
The modified gen p mean: 0.4551360011100769, gen p mean: 0.0, mean p set: 0.4502703547477722
loss_pred:0.03698540851473808, decouple_loss:0.02983596734702587
loss_pred:0.037532173097133636, decouple_loss:0.029452228918671608
loss_pred:0.03640352189540863, decouple_loss:0.030271170660853386
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4322067201137543, gen p mean: 0.0, mean p set: 0.44917967915534973
The modified gen p mean: 0.435538649559021, gen p mean: 0.0, mean p set: 0.44949984550476074
The modified gen p mean: 0.42972585558891296, gen p mean: 0.0, mean p set: 0.44904085993766785
loss_pred:0.03674212470650673, decouple_loss:0.029575474560260773
loss_pred:0.03627213090658188, decouple_loss:0.030271124094724655
loss_pred:0.03677850216627121, decouple_loss:0.030269574373960495
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44199883937835693, gen p mean: 0.0, mean p set: 0.44983842968940735
The modified gen p mean: 0.4413941502571106, gen p mean: 0.0, mean p set: 0.44945788383483887
The modified gen p mean: 0.4462762773036957, gen p mean: 0.0, mean p set: 0.4499533474445343
loss_pred:0.03658268228173256, decouple_loss:0.029911333695054054
loss_pred:0.036018725484609604, decouple_loss:0.02926724962890148
loss_pred:0.036006852984428406, decouple_loss:0.03040669672191143
2023-05-02 20:23:53 testing...
The modified gen p mean: 0.4672369658946991, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.47311609983444214, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.47508499026298523, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03664100542664528, decouple_loss:0.03054620511829853
loss_pred:0.035677265375852585, decouple_loss:0.02915186807513237
loss_pred:0.03470519557595253, decouple_loss:0.03028394654393196
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03717419132590294, avg_mse: 0.039284415543079376
current test mse: 0.039284
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46876707673072815, gen p mean: 0.0, mean p set: 0.449137419462204
The modified gen p mean: 0.47171643376350403, gen p mean: 0.0, mean p set: 0.45063140988349915
loss_pred:0.03766266256570816, decouple_loss:0.02943481132388115
loss_pred:0.03641436621546745, decouple_loss:0.029671557247638702
The modified gen p mean: 0.47057873010635376, gen p mean: 0.0, mean p set: 0.4495994448661804
loss_pred:0.03745628893375397, decouple_loss:0.029682563617825508
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4603205919265747, gen p mean: 0.0, mean p set: 0.44958946108818054
The modified gen p mean: 0.46172332763671875, gen p mean: 0.0, mean p set: 0.4483669102191925
The modified gen p mean: 0.45800673961639404, gen p mean: 0.0, mean p set: 0.44932347536087036
loss_pred:0.0363597571849823, decouple_loss:0.029762359336018562
loss_pred:0.03606168180704117, decouple_loss:0.028130296617746353
loss_pred:0.03527197986841202, decouple_loss:0.029444998130202293
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4282662868499756, gen p mean: 0.0, mean p set: 0.4498685300350189
The modified gen p mean: 0.43299543857574463, gen p mean: 0.0, mean p set: 0.44844722747802734
The modified gen p mean: 0.4295177161693573, gen p mean: 0.0, mean p set: 0.4508882462978363
loss_pred:0.03610951825976372, decouple_loss:0.02918373793363571
loss_pred:0.03555866330862045, decouple_loss:0.029681028798222542
loss_pred:0.034992046654224396, decouple_loss:0.02981249988079071
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4407053291797638, gen p mean: 0.0, mean p set: 0.4485909342765808
The modified gen p mean: 0.43819132447242737, gen p mean: 0.0, mean p set: 0.4496126174926758
The modified gen p mean: 0.43841657042503357, gen p mean: 0.0, mean p set: 0.45029905438423157
loss_pred:0.036088887602090836, decouple_loss:0.028966283425688744
loss_pred:0.03563704714179039, decouple_loss:0.028474343940615654
loss_pred:0.03546794503927231, decouple_loss:0.028502224013209343
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4667464792728424, gen p mean: 0.0, mean p set: 0.44837456941604614
The modified gen p mean: 0.4625612497329712, gen p mean: 0.0, mean p set: 0.44710251688957214
The modified gen p mean: 0.4615599811077118, gen p mean: 0.0, mean p set: 0.4485769271850586
loss_pred:0.03601397946476936, decouple_loss:0.030714210122823715
loss_pred:0.03601815924048424, decouple_loss:0.02854006551206112
loss_pred:0.03602756932377815, decouple_loss:0.03033026121556759
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45290371775627136, gen p mean: 0.0, mean p set: 0.4500042200088501
The modified gen p mean: 0.4555993974208832, gen p mean: 0.0, mean p set: 0.44964301586151123
The modified gen p mean: 0.45125797390937805, gen p mean: 0.0, mean p set: 0.4493459463119507
loss_pred:0.03592488914728165, decouple_loss:0.029609236866235733
loss_pred:0.03706999495625496, decouple_loss:0.029134070500731468
loss_pred:0.036572784185409546, decouple_loss:0.029960820451378822
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43881869316101074, gen p mean: 0.0, mean p set: 0.4495595097541809
The modified gen p mean: 0.440391480922699, gen p mean: 0.0, mean p set: 0.4469698667526245
The modified gen p mean: 0.44194552302360535, gen p mean: 0.0, mean p set: 0.448943167924881
loss_pred:0.035790763795375824, decouple_loss:0.028311237692832947
loss_pred:0.03562571480870247, decouple_loss:0.030045928433537483
loss_pred:0.034839823842048645, decouple_loss:0.02801985666155815
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089539885520935, gen p mean: 0.0, mean p set: 0.44896194338798523
The modified gen p mean: 0.44966185092926025, gen p mean: 0.0, mean p set: 0.44987955689430237
The modified gen p mean: 0.4499465823173523, gen p mean: 0.0, mean p set: 0.44902855157852173
loss_pred:0.03631971403956413, decouple_loss:0.029269622638821602
loss_pred:0.034922678023576736, decouple_loss:0.030597591772675514
loss_pred:0.03568267822265625, decouple_loss:0.028828345239162445
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4565107524394989, gen p mean: 0.0, mean p set: 0.4483490288257599
The modified gen p mean: 0.45606857538223267, gen p mean: 0.0, mean p set: 0.44820865988731384
The modified gen p mean: 0.45139509439468384, gen p mean: 0.0, mean p set: 0.4488680362701416
loss_pred:0.0362827368080616, decouple_loss:0.029515739530324936
loss_pred:0.03639538958668709, decouple_loss:0.02980203740298748
loss_pred:0.036313533782958984, decouple_loss:0.029271794483065605
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121443271636963, gen p mean: 0.0, mean p set: 0.45046207308769226
The modified gen p mean: 0.4491647779941559, gen p mean: 0.0, mean p set: 0.448056697845459
The modified gen p mean: 0.44937679171562195, gen p mean: 0.0, mean p set: 0.4478663504123688
loss_pred:0.03463080897927284, decouple_loss:0.029974956065416336
loss_pred:0.034759052097797394, decouple_loss:0.028922777622938156
loss_pred:0.03613986447453499, decouple_loss:0.029120732098817825
2023-05-02 20:27:33 testing...
The modified gen p mean: 0.439849317073822, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44559618830680847, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44756120443344116, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.0363154336810112, decouple_loss:0.029766643419861794
loss_pred:0.035277847200632095, decouple_loss:0.02865961752831936
loss_pred:0.03425469249486923, decouple_loss:0.029552990570664406
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0367489829659462, avg_mse: 0.03895235061645508
current test mse: 0.038952
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4440837800502777, gen p mean: 0.0, mean p set: 0.448634535074234
The modified gen p mean: 0.44304564595222473, gen p mean: 0.0, mean p set: 0.44898566603660583
loss_pred:0.03512367606163025, decouple_loss:0.02925715409219265
loss_pred:0.03572012856602669, decouple_loss:0.028260638937354088
The modified gen p mean: 0.4501909911632538, gen p mean: 0.0, mean p set: 0.44888070225715637
loss_pred:0.03566138446331024, decouple_loss:0.029058469459414482
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44999250769615173, gen p mean: 0.0, mean p set: 0.44821488857269287
The modified gen p mean: 0.44535282254219055, gen p mean: 0.0, mean p set: 0.44726207852363586
The modified gen p mean: 0.4471323490142822, gen p mean: 0.0, mean p set: 0.4469858705997467
loss_pred:0.03572217747569084, decouple_loss:0.030686188489198685
loss_pred:0.03586787357926369, decouple_loss:0.03177974745631218
loss_pred:0.03470524773001671, decouple_loss:0.029590293765068054
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848552346229553, gen p mean: 0.0, mean p set: 0.4460710883140564
The modified gen p mean: 0.44324904680252075, gen p mean: 0.0, mean p set: 0.44706523418426514
The modified gen p mean: 0.4448338747024536, gen p mean: 0.0, mean p set: 0.44716861844062805
loss_pred:0.03555389866232872, decouple_loss:0.030613522976636887
loss_pred:0.03528595343232155, decouple_loss:0.03120381385087967
loss_pred:0.03583389148116112, decouple_loss:0.030635960400104523
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540822505950928, gen p mean: 0.0, mean p set: 0.4483300447463989
The modified gen p mean: 0.45732545852661133, gen p mean: 0.0, mean p set: 0.4472024440765381
The modified gen p mean: 0.45749443769454956, gen p mean: 0.0, mean p set: 0.4479503035545349
loss_pred:0.03581400215625763, decouple_loss:0.03182321414351463
loss_pred:0.036286331713199615, decouple_loss:0.02915818616747856
loss_pred:0.03386494144797325, decouple_loss:0.029163170605897903
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45161643624305725, gen p mean: 0.0, mean p set: 0.4462953209877014
The modified gen p mean: 0.4509541690349579, gen p mean: 0.0, mean p set: 0.4468272626399994
The modified gen p mean: 0.4513789713382721, gen p mean: 0.0, mean p set: 0.44698208570480347
loss_pred:0.035013213753700256, decouple_loss:0.029196375980973244
loss_pred:0.03489406034350395, decouple_loss:0.030946368351578712
loss_pred:0.0366622619330883, decouple_loss:0.030128808692097664
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43253669142723083, gen p mean: 0.0, mean p set: 0.44702792167663574
The modified gen p mean: 0.4303123950958252, gen p mean: 0.0, mean p set: 0.44756782054901123
The modified gen p mean: 0.4263376295566559, gen p mean: 0.0, mean p set: 0.4474724233150482
loss_pred:0.03573162853717804, decouple_loss:0.028545547276735306
loss_pred:0.03460859879851341, decouple_loss:0.02950388938188553
loss_pred:0.03524750843644142, decouple_loss:0.02974875643849373
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4426749348640442, gen p mean: 0.0, mean p set: 0.44638508558273315
The modified gen p mean: 0.4420255124568939, gen p mean: 0.0, mean p set: 0.44714680314064026
The modified gen p mean: 0.4405202269554138, gen p mean: 0.0, mean p set: 0.44745466113090515
loss_pred:0.03508440777659416, decouple_loss:0.02817448042333126
loss_pred:0.03578174114227295, decouple_loss:0.029780671000480652
loss_pred:0.03457918390631676, decouple_loss:0.02941552922129631
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4697253108024597, gen p mean: 0.0, mean p set: 0.4470199644565582
The modified gen p mean: 0.47048237919807434, gen p mean: 0.0, mean p set: 0.44819650053977966
The modified gen p mean: 0.46397149562835693, gen p mean: 0.0, mean p set: 0.44743674993515015
loss_pred:0.03620079532265663, decouple_loss:0.029088100418448448
loss_pred:0.03420734405517578, decouple_loss:0.027864474803209305
loss_pred:0.03471830487251282, decouple_loss:0.028899280354380608
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45619821548461914, gen p mean: 0.0, mean p set: 0.44768035411834717
The modified gen p mean: 0.45972520112991333, gen p mean: 0.0, mean p set: 0.4480966627597809
The modified gen p mean: 0.454684317111969, gen p mean: 0.0, mean p set: 0.44722431898117065
loss_pred:0.03428051248192787, decouple_loss:0.02917005866765976
loss_pred:0.035043999552726746, decouple_loss:0.027811815962195396
loss_pred:0.0352795235812664, decouple_loss:0.02882201224565506
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43078094720840454, gen p mean: 0.0, mean p set: 0.446708619594574
The modified gen p mean: 0.426404744386673, gen p mean: 0.0, mean p set: 0.4480864405632019
The modified gen p mean: 0.4270601272583008, gen p mean: 0.0, mean p set: 0.4467359483242035
loss_pred:0.03664074093103409, decouple_loss:0.029061654582619667
loss_pred:0.036017220467329025, decouple_loss:0.030460044741630554
loss_pred:0.035589225590229034, decouple_loss:0.029811546206474304
2023-05-02 20:31:59 testing...
The modified gen p mean: 0.44295749068260193, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4508677124977112, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4488670825958252, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03613350912928581, decouple_loss:0.029455306008458138
loss_pred:0.0343220978975296, decouple_loss:0.02949468418955803
loss_pred:0.035250987857580185, decouple_loss:0.028599169105291367
WV_0_PC_0_EH_0_PS_40_6, loss: 0.036694686859846115, avg_mse: 0.03889573737978935
current test mse: 0.038896
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463145434856415, gen p mean: 0.0, mean p set: 0.44674646854400635
loss_pred:0.03465113043785095, decouple_loss:0.02761046588420868
The modified gen p mean: 0.44439923763275146, gen p mean: 0.0, mean p set: 0.44745174050331116
loss_pred:0.03559112176299095, decouple_loss:0.029408128932118416
The modified gen p mean: 0.44353413581848145, gen p mean: 0.0, mean p set: 0.4478432536125183
loss_pred:0.035364288836717606, decouple_loss:0.028140317648649216
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45435860753059387, gen p mean: 0.0, mean p set: 0.4475901126861572
The modified gen p mean: 0.45838111639022827, gen p mean: 0.0, mean p set: 0.4479900598526001
The modified gen p mean: 0.45613837242126465, gen p mean: 0.0, mean p set: 0.4480500817298889
loss_pred:0.035558320581912994, decouple_loss:0.02919100597500801
loss_pred:0.035724639892578125, decouple_loss:0.027787568047642708
loss_pred:0.03394007682800293, decouple_loss:0.02683357521891594
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44510138034820557, gen p mean: 0.0, mean p set: 0.44725584983825684
The modified gen p mean: 0.4475840628147125, gen p mean: 0.0, mean p set: 0.44672611355781555
The modified gen p mean: 0.4498159885406494, gen p mean: 0.0, mean p set: 0.44745591282844543
loss_pred:0.03502259403467178, decouple_loss:0.028453035280108452
loss_pred:0.03502977266907692, decouple_loss:0.028673941269516945
loss_pred:0.035227932035923004, decouple_loss:0.028175657615065575
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504256248474121, gen p mean: 0.0, mean p set: 0.4469989240169525
The modified gen p mean: 0.447061687707901, gen p mean: 0.0, mean p set: 0.44700896739959717
The modified gen p mean: 0.4474470615386963, gen p mean: 0.0, mean p set: 0.4476989209651947
loss_pred:0.03539114072918892, decouple_loss:0.028015682473778725
loss_pred:0.03343302011489868, decouple_loss:0.028612926602363586
loss_pred:0.03511853888630867, decouple_loss:0.0283474363386631
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501485824584961, gen p mean: 0.0, mean p set: 0.4465586841106415
The modified gen p mean: 0.4490726888179779, gen p mean: 0.0, mean p set: 0.4471304714679718
The modified gen p mean: 0.449624627828598, gen p mean: 0.0, mean p set: 0.44752398133277893
loss_pred:0.03418910503387451, decouple_loss:0.02825382724404335loss_pred:0.03485173359513283, decouple_loss:0.02839941531419754
loss_pred:0.03375447541475296, decouple_loss:0.0281410813331604
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44488394260406494, gen p mean: 0.0, mean p set: 0.4461430609226227
The modified gen p mean: 0.44260916113853455, gen p mean: 0.0, mean p set: 0.4477214217185974
The modified gen p mean: 0.44350963830947876, gen p mean: 0.0, mean p set: 0.4479365348815918
loss_pred:0.03520295023918152, decouple_loss:0.028248323127627373
loss_pred:0.03446982428431511, decouple_loss:0.027667563408613205
loss_pred:0.0354592427611351, decouple_loss:0.02806379832327366
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.443492591381073, gen p mean: 0.0, mean p set: 0.44772863388061523
The modified gen p mean: 0.44355523586273193, gen p mean: 0.0, mean p set: 0.44773682951927185
The modified gen p mean: 0.4441503584384918, gen p mean: 0.0, mean p set: 0.44696730375289917
loss_pred:0.0341527946293354, decouple_loss:0.027843475341796875
loss_pred:0.03450345993041992, decouple_loss:0.0282236747443676
loss_pred:0.034476909786462784, decouple_loss:0.027312342077493668
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45066970586776733, gen p mean: 0.0, mean p set: 0.4464685022830963
The modified gen p mean: 0.4479201138019562, gen p mean: 0.0, mean p set: 0.44749605655670166
The modified gen p mean: 0.45303842425346375, gen p mean: 0.0, mean p set: 0.4468649923801422
loss_pred:0.03506772965192795, decouple_loss:0.026906251907348633
loss_pred:0.03437450900673866, decouple_loss:0.029459767043590546
loss_pred:0.03438669070601463, decouple_loss:0.027396388351917267
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4447236657142639, gen p mean: 0.0, mean p set: 0.4480704963207245
The modified gen p mean: 0.45056238770484924, gen p mean: 0.0, mean p set: 0.44659891724586487
The modified gen p mean: 0.4481368064880371, gen p mean: 0.0, mean p set: 0.44709739089012146
loss_pred:0.03514577075839043, decouple_loss:0.030323008075356483
loss_pred:0.034916672855615616, decouple_loss:0.02764272876083851
loss_pred:0.035493459552526474, decouple_loss:0.027501244097948074
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44566047191619873, gen p mean: 0.0, mean p set: 0.44622352719306946
The modified gen p mean: 0.44277137517929077, gen p mean: 0.0, mean p set: 0.447883665561676
The modified gen p mean: 0.44199010729789734, gen p mean: 0.0, mean p set: 0.4484312832355499
loss_pred:0.034756336361169815, decouple_loss:0.027111152186989784
loss_pred:0.03597130626440048, decouple_loss:0.02726042829453945
loss_pred:0.035346679389476776, decouple_loss:0.029085073620080948
2023-05-02 20:35:38 testing...
The modified gen p mean: 0.4461444616317749, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45374542474746704, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.45195913314819336, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.035690128803253174, decouple_loss:0.02864687331020832
loss_pred:0.03392359986901283, decouple_loss:0.028689414262771606
loss_pred:0.03483876213431358, decouple_loss:0.027774740010499954
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03623601421713829, avg_mse: 0.038427699357271194
current test mse: 0.038428
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858333468437195, gen p mean: 0.0, mean p set: 0.4470832645893097
The modified gen p mean: 0.4481736123561859, gen p mean: 0.0, mean p set: 0.4480128884315491
loss_pred:0.03415975719690323, decouple_loss:0.028249071910977364
loss_pred:0.03566472977399826, decouple_loss:0.0284012109041214
The modified gen p mean: 0.4487012028694153, gen p mean: 0.0, mean p set: 0.4475388824939728
loss_pred:0.0335882268846035, decouple_loss:0.027969226241111755
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503394365310669, gen p mean: 0.0, mean p set: 0.4482314884662628
The modified gen p mean: 0.454559862613678, gen p mean: 0.0, mean p set: 0.44827160239219666
The modified gen p mean: 0.45675984025001526, gen p mean: 0.0, mean p set: 0.4487389624118805
loss_pred:0.03777262941002846, decouple_loss:0.02765912190079689
loss_pred:0.03793643042445183, decouple_loss:0.0310830045491457
loss_pred:0.03520384058356285, decouple_loss:0.03075074404478073
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509001672267914, gen p mean: 0.0, mean p set: 0.44869908690452576
The modified gen p mean: 0.453999400138855, gen p mean: 0.0, mean p set: 0.4486686885356903
The modified gen p mean: 0.45579707622528076, gen p mean: 0.0, mean p set: 0.4494354724884033
loss_pred:0.03705979511141777, decouple_loss:0.031530074775218964
loss_pred:0.0369173027575016, decouple_loss:0.03044489212334156
loss_pred:0.0355682373046875, decouple_loss:0.029712824150919914
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4378090798854828, gen p mean: 0.0, mean p set: 0.4489506781101227
The modified gen p mean: 0.43655648827552795, gen p mean: 0.0, mean p set: 0.44985130429267883
The modified gen p mean: 0.43605759739875793, gen p mean: 0.0, mean p set: 0.4479483664035797
loss_pred:0.03648503124713898, decouple_loss:0.029374128207564354
loss_pred:0.03637596219778061, decouple_loss:0.03143912926316261
loss_pred:0.03514348343014717, decouple_loss:0.028953980654478073
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488373100757599, gen p mean: 0.0, mean p set: 0.44645413756370544
The modified gen p mean: 0.4476483464241028, gen p mean: 0.0, mean p set: 0.44944167137145996
The modified gen p mean: 0.44706660509109497, gen p mean: 0.0, mean p set: 0.44951605796813965
loss_pred:0.03560543805360794, decouple_loss:0.03001434914767742
loss_pred:0.03680367022752762, decouple_loss:0.029514633119106293
loss_pred:0.034636612981557846, decouple_loss:0.029038069769740105
Iteration: 936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4626825451850891, gen p mean: 0.0, mean p set: 0.44889581203460693
The modified gen p mean: 0.4616565704345703, gen p mean: 0.0, mean p set: 0.4486868679523468
The modified gen p mean: 0.4645434021949768, gen p mean: 0.0, mean p set: 0.4485113322734833
loss_pred:0.037475086748600006, decouple_loss:0.029712175950407982
loss_pred:0.03525250405073166, decouple_loss:0.029708536341786385
loss_pred:0.03474203869700432, decouple_loss:0.029115047305822372
Iteration: 937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679924845695496, gen p mean: 0.0, mean p set: 0.4464397132396698
The modified gen p mean: 0.45057404041290283, gen p mean: 0.0, mean p set: 0.4467865526676178
The modified gen p mean: 0.4473848044872284, gen p mean: 0.0, mean p set: 0.4495036005973816
loss_pred:0.03609135374426842, decouple_loss:0.02828158251941204
loss_pred:0.03742005676031113, decouple_loss:0.029336892068386078
loss_pred:0.03773534297943115, decouple_loss:0.029036933556199074
Iteration: 938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43833351135253906, gen p mean: 0.0, mean p set: 0.4476655125617981
The modified gen p mean: 0.4343964755535126, gen p mean: 0.0, mean p set: 0.44764459133148193
The modified gen p mean: 0.43245166540145874, gen p mean: 0.0, mean p set: 0.44844329357147217
loss_pred:0.0343472920358181, decouple_loss:0.029236793518066406
loss_pred:0.03593241050839424, decouple_loss:0.028229767456650734
loss_pred:0.03670753911137581, decouple_loss:0.029511382803320885
Iteration: 939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.438925176858902, gen p mean: 0.0, mean p set: 0.44767823815345764
The modified gen p mean: 0.44417309761047363, gen p mean: 0.0, mean p set: 0.4490565061569214
The modified gen p mean: 0.4463183879852295, gen p mean: 0.0, mean p set: 0.4473777115345001
loss_pred:0.03509432449936867, decouple_loss:0.028767632320523262
loss_pred:0.03495655208826065, decouple_loss:0.029503898695111275
loss_pred:0.037258829921483994, decouple_loss:0.02840837463736534
Iteration: 940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46241214871406555, gen p mean: 0.0, mean p set: 0.4489421248435974
The modified gen p mean: 0.46305572986602783, gen p mean: 0.0, mean p set: 0.4480428397655487
The modified gen p mean: 0.4655354917049408, gen p mean: 0.0, mean p set: 0.448468953371048
loss_pred:0.035116102546453476, decouple_loss:0.029431970790028572
loss_pred:0.034645888954401016, decouple_loss:0.028300639241933823
loss_pred:0.035610076040029526, decouple_loss:0.02809247560799122
2023-05-02 20:39:57 testing...
The modified gen p mean: 0.45413121581077576, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4487000107765198, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4563731551170349, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03481503576040268, decouple_loss:0.028061067685484886
loss_pred:0.03562721982598305, decouple_loss:0.029410429298877716
loss_pred:0.03380625322461128, decouple_loss:0.028850527480244637
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03618820756673813, avg_mse: 0.03840973973274231
current test mse: 0.03841
Iteration: 941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4582984149456024, gen p mean: 0.0, mean p set: 0.4480399191379547
The modified gen p mean: 0.4567878246307373, gen p mean: 0.0, mean p set: 0.4476326107978821
loss_pred:0.03422090411186218, decouple_loss:0.02714325487613678
loss_pred:0.03448256850242615, decouple_loss:0.02805754356086254
The modified gen p mean: 0.4528866708278656, gen p mean: 0.0, mean p set: 0.4478928744792938
loss_pred:0.03493182361125946, decouple_loss:0.02827293984591961
Iteration: 942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.430986613035202, gen p mean: 0.0, mean p set: 0.4488369822502136
The modified gen p mean: 0.4324745535850525, gen p mean: 0.0, mean p set: 0.4487598240375519
The modified gen p mean: 0.43048006296157837, gen p mean: 0.0, mean p set: 0.44850867986679077
loss_pred:0.034799765795469284, decouple_loss:0.027361854910850525
loss_pred:0.03617017716169357, decouple_loss:0.02934175729751587
loss_pred:0.035926543176174164, decouple_loss:0.029661739245057106
Iteration: 943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497353434562683, gen p mean: 0.0, mean p set: 0.4461473524570465
The modified gen p mean: 0.44929957389831543, gen p mean: 0.0, mean p set: 0.44689464569091797
The modified gen p mean: 0.44740667939186096, gen p mean: 0.0, mean p set: 0.44777119159698486
loss_pred:0.03675973042845726, decouple_loss:0.028925133869051933
loss_pred:0.03714500367641449, decouple_loss:0.02802380360662937
loss_pred:0.0360742025077343, decouple_loss:0.027509715408086777
Iteration: 944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45693835616111755, gen p mean: 0.0, mean p set: 0.4477252662181854
The modified gen p mean: 0.4578070044517517, gen p mean: 0.0, mean p set: 0.44908660650253296
The modified gen p mean: 0.45711153745651245, gen p mean: 0.0, mean p set: 0.44584187865257263
loss_pred:0.03633493185043335, decouple_loss:0.027442296966910362loss_pred:0.036412566900253296, decouple_loss:0.028981102630496025
loss_pred:0.0362248420715332, decouple_loss:0.028749579563736916
Iteration: 945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494151473045349, gen p mean: 0.0, mean p set: 0.448919415473938
The modified gen p mean: 0.44678759574890137, gen p mean: 0.0, mean p set: 0.4492167532444
The modified gen p mean: 0.44854283332824707, gen p mean: 0.0, mean p set: 0.4475817382335663
loss_pred:0.03514742851257324, decouple_loss:0.028576316311955452
loss_pred:0.03743116557598114, decouple_loss:0.029487334191799164
loss_pred:0.036424849182367325, decouple_loss:0.028068065643310547
Iteration: 946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43924441933631897, gen p mean: 0.0, mean p set: 0.44930681586265564
The modified gen p mean: 0.4416523575782776, gen p mean: 0.0, mean p set: 0.44967639446258545
The modified gen p mean: 0.4413314163684845, gen p mean: 0.0, mean p set: 0.44645223021507263
loss_pred:0.036903250962495804, decouple_loss:0.029439732432365417
loss_pred:0.035600949078798294, decouple_loss:0.029755273833870888
loss_pred:0.03591075539588928, decouple_loss:0.029088079929351807
Iteration: 947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525041878223419, gen p mean: 0.0, mean p set: 0.4480014741420746
The modified gen p mean: 0.4487106204032898, gen p mean: 0.0, mean p set: 0.44794782996177673
The modified gen p mean: 0.4538838267326355, gen p mean: 0.0, mean p set: 0.4490351974964142
loss_pred:0.03480733558535576, decouple_loss:0.027788102626800537
loss_pred:0.036408085376024246, decouple_loss:0.02852267399430275
loss_pred:0.033727627247571945, decouple_loss:0.027260180562734604
Iteration: 948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45830896496772766, gen p mean: 0.0, mean p set: 0.44764280319213867
The modified gen p mean: 0.4570460915565491, gen p mean: 0.0, mean p set: 0.4468391239643097
The modified gen p mean: 0.4543271064758301, gen p mean: 0.0, mean p set: 0.44841864705085754
loss_pred:0.03644751384854317, decouple_loss:0.02937314845621586
loss_pred:0.03586101159453392, decouple_loss:0.027957241982221603
loss_pred:0.035462528467178345, decouple_loss:0.02865384705364704
Iteration: 949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4393487572669983, gen p mean: 0.0, mean p set: 0.4488692581653595
The modified gen p mean: 0.43239080905914307, gen p mean: 0.0, mean p set: 0.44812238216400146
The modified gen p mean: 0.437118798494339, gen p mean: 0.0, mean p set: 0.44826918840408325
loss_pred:0.03598732128739357, decouple_loss:0.027872761711478233
loss_pred:0.03621754050254822, decouple_loss:0.028704162687063217
loss_pred:0.03533940762281418, decouple_loss:0.028117652982473373
Iteration: 950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44426900148391724, gen p mean: 0.0, mean p set: 0.44780370593070984
The modified gen p mean: 0.43704867362976074, gen p mean: 0.0, mean p set: 0.448184072971344
The modified gen p mean: 0.44148263335227966, gen p mean: 0.0, mean p set: 0.4479406476020813
loss_pred:0.03628445044159889, decouple_loss:0.027079829946160316
loss_pred:0.03584553673863411, decouple_loss:0.029262680560350418
loss_pred:0.03518743813037872, decouple_loss:0.027361690998077393
2023-05-02 20:43:36 testing...
The modified gen p mean: 0.4496602416038513, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45757293701171875, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.45519325137138367, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03570268303155899, decouple_loss:0.02940693125128746
loss_pred:0.03410056233406067, decouple_loss:0.029042841866612434loss_pred:0.034807369112968445, decouple_loss:0.02825552597641945
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03631529211997986, avg_mse: 0.03864464908838272
current test mse: 0.038645
Iteration: 951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526841342449188, gen p mean: 0.0, mean p set: 0.4481014013290405
The modified gen p mean: 0.45336323976516724, gen p mean: 0.0, mean p set: 0.4486646354198456
loss_pred:0.03554673120379448, decouple_loss:0.028043249621987343
loss_pred:0.03490147367119789, decouple_loss:0.027675941586494446
The modified gen p mean: 0.45789992809295654, gen p mean: 0.0, mean p set: 0.44847002625465393
loss_pred:0.03660675510764122, decouple_loss:0.028333205729722977
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912004470825195, gen p mean: 0.0, mean p set: 0.4481530487537384
The modified gen p mean: 0.4503011107444763, gen p mean: 0.0, mean p set: 0.44767752289772034
The modified gen p mean: 0.44819512963294983, gen p mean: 0.0, mean p set: 0.4472885727882385
loss_pred:0.03469012677669525, decouple_loss:0.02929546684026718
loss_pred:0.035838667303323746, decouple_loss:0.03188876435160637
loss_pred:0.03431090712547302, decouple_loss:0.030553217977285385
Iteration: 953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483005106449127, gen p mean: 0.0, mean p set: 0.4484986364841461
The modified gen p mean: 0.4488254487514496, gen p mean: 0.0, mean p set: 0.44869065284729004
The modified gen p mean: 0.4531712830066681, gen p mean: 0.0, mean p set: 0.4483223557472229
loss_pred:0.034360725432634354, decouple_loss:0.029784252867102623
loss_pred:0.033799394965171814, decouple_loss:0.02947300300002098
loss_pred:0.03414742648601532, decouple_loss:0.029086781665682793
Iteration: 954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4449644684791565, gen p mean: 0.0, mean p set: 0.44709834456443787
The modified gen p mean: 0.44798317551612854, gen p mean: 0.0, mean p set: 0.44606801867485046
The modified gen p mean: 0.4527626037597656, gen p mean: 0.0, mean p set: 0.4492754638195038
loss_pred:0.03464490547776222, decouple_loss:0.02960941568017006
loss_pred:0.035236600786447525, decouple_loss:0.030343078076839447
loss_pred:0.03543033450841904, decouple_loss:0.030152631923556328
Iteration: 955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43777844309806824, gen p mean: 0.0, mean p set: 0.44727712869644165
The modified gen p mean: 0.4444189667701721, gen p mean: 0.0, mean p set: 0.4487912356853485
The modified gen p mean: 0.43873459100723267, gen p mean: 0.0, mean p set: 0.44740915298461914
loss_pred:0.034518081694841385, decouple_loss:0.02848290652036667
loss_pred:0.03640657290816307, decouple_loss:0.028991248458623886
loss_pred:0.03498155251145363, decouple_loss:0.028324123471975327
Iteration: 956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4580881893634796, gen p mean: 0.0, mean p set: 0.44801437854766846
The modified gen p mean: 0.45645830035209656, gen p mean: 0.0, mean p set: 0.44902777671813965
The modified gen p mean: 0.4489286243915558, gen p mean: 0.0, mean p set: 0.4473150670528412
loss_pred:0.03497365862131119, decouple_loss:0.027936497703194618
loss_pred:0.0355241596698761, decouple_loss:0.0277422945946455
loss_pred:0.0349607989192009, decouple_loss:0.029036415740847588
Iteration: 957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45186156034469604, gen p mean: 0.0, mean p set: 0.44784191250801086
The modified gen p mean: 0.449338436126709, gen p mean: 0.0, mean p set: 0.4478735327720642
The modified gen p mean: 0.4537670910358429, gen p mean: 0.0, mean p set: 0.449787974357605
loss_pred:0.035418447107076645, decouple_loss:0.028558216989040375
loss_pred:0.034522756934165955, decouple_loss:0.02779090404510498
loss_pred:0.034991148859262466, decouple_loss:0.02934935688972473
Iteration: 958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450438916683197, gen p mean: 0.0, mean p set: 0.4485120475292206
The modified gen p mean: 0.4456515312194824, gen p mean: 0.0, mean p set: 0.44827497005462646
The modified gen p mean: 0.4439551532268524, gen p mean: 0.0, mean p set: 0.44826194643974304
loss_pred:0.036213863641023636, decouple_loss:0.027778608724474907
loss_pred:0.034313373267650604, decouple_loss:0.028638601303100586
loss_pred:0.03574126213788986, decouple_loss:0.02796574868261814
Iteration: 959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43589240312576294, gen p mean: 0.0, mean p set: 0.44745954871177673
The modified gen p mean: 0.4375399351119995, gen p mean: 0.0, mean p set: 0.4466274678707123
The modified gen p mean: 0.43877747654914856, gen p mean: 0.0, mean p set: 0.44900041818618774
loss_pred:0.03424776718020439, decouple_loss:0.026847418397665024
loss_pred:0.03504015505313873, decouple_loss:0.028557222336530685
loss_pred:0.03353165090084076, decouple_loss:0.02821924351155758
Iteration: 960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.460340678691864, gen p mean: 0.0, mean p set: 0.4479130506515503
The modified gen p mean: 0.4555433690547943, gen p mean: 0.0, mean p set: 0.449184387922287
The modified gen p mean: 0.456127405166626, gen p mean: 0.0, mean p set: 0.448087215423584
loss_pred:0.035235658288002014, decouple_loss:0.027557242661714554
loss_pred:0.034205980598926544, decouple_loss:0.029015688225626945
loss_pred:0.03450759872794151, decouple_loss:0.02792026847600937
2023-05-02 20:48:00 testing...
The modified gen p mean: 0.4554382264614105, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4634423553943634, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.46134814620018005, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03571072220802307, decouple_loss:0.02988930605351925
loss_pred:0.033876683562994, decouple_loss:0.029971865937113762
loss_pred:0.03468698635697365, decouple_loss:0.029004640877246857
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03623922914266586, avg_mse: 0.03853931277990341
current test mse: 0.038539
Iteration: 961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4605482518672943, gen p mean: 0.0, mean p set: 0.4489942789077759
loss_pred:0.035441599786281586, decouple_loss:0.028428593650460243
The modified gen p mean: 0.45624420046806335, gen p mean: 0.0, mean p set: 0.44957879185676575
loss_pred:0.033618129789829254, decouple_loss:0.02925068885087967
The modified gen p mean: 0.45516225695610046, gen p mean: 0.0, mean p set: 0.4476076066493988
loss_pred:0.034047000110149384, decouple_loss:0.028667060658335686
Iteration: 962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43545377254486084, gen p mean: 0.0, mean p set: 0.44775715470314026
The modified gen p mean: 0.4354153573513031, gen p mean: 0.0, mean p set: 0.4469049572944641
The modified gen p mean: 0.43851861357688904, gen p mean: 0.0, mean p set: 0.44671642780303955
loss_pred:0.03419201076030731, decouple_loss:0.028238847851753235
loss_pred:0.03457053005695343, decouple_loss:0.029032083228230476
loss_pred:0.03496042266488075, decouple_loss:0.02875250205397606
Iteration: 963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494197368621826, gen p mean: 0.0, mean p set: 0.44736772775650024
The modified gen p mean: 0.4480469226837158, gen p mean: 0.0, mean p set: 0.44887441396713257
The modified gen p mean: 0.4415654242038727, gen p mean: 0.0, mean p set: 0.44775891304016113
loss_pred:0.034581609070301056, decouple_loss:0.028211791068315506
loss_pred:0.03534497693181038, decouple_loss:0.02816460095345974
loss_pred:0.03476423770189285, decouple_loss:0.02963346056640148
Iteration: 964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45889073610305786, gen p mean: 0.0, mean p set: 0.4477689266204834
The modified gen p mean: 0.4576990306377411, gen p mean: 0.0, mean p set: 0.45031026005744934
The modified gen p mean: 0.4548223912715912, gen p mean: 0.0, mean p set: 0.44821611046791077
loss_pred:0.034576740115880966, decouple_loss:0.02649519592523575
loss_pred:0.03479250520467758, decouple_loss:0.02794228307902813
loss_pred:0.03433333709836006, decouple_loss:0.027942251414060593
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791027903556824, gen p mean: 0.0, mean p set: 0.44909462332725525
The modified gen p mean: 0.44070616364479065, gen p mean: 0.0, mean p set: 0.4466356933116913
The modified gen p mean: 0.4461052119731903, gen p mean: 0.0, mean p set: 0.4479758143424988
loss_pred:0.0345119945704937, decouple_loss:0.02818513661623001
loss_pred:0.034616660326719284, decouple_loss:0.027383092790842056
loss_pred:0.03386939316987991, decouple_loss:0.0270753875374794
Iteration: 966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4346280097961426, gen p mean: 0.0, mean p set: 0.447646826505661
The modified gen p mean: 0.4364723563194275, gen p mean: 0.0, mean p set: 0.447562575340271
The modified gen p mean: 0.4365697503089905, gen p mean: 0.0, mean p set: 0.44801008701324463
loss_pred:0.03459153696894646, decouple_loss:0.02815050072968006
loss_pred:0.034477245062589645, decouple_loss:0.02674783766269684
loss_pred:0.033868350088596344, decouple_loss:0.02754267491400242
Iteration: 967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4590648114681244, gen p mean: 0.0, mean p set: 0.44851356744766235
The modified gen p mean: 0.45139235258102417, gen p mean: 0.0, mean p set: 0.4480946362018585
The modified gen p mean: 0.4559323489665985, gen p mean: 0.0, mean p set: 0.44832706451416016
loss_pred:0.03512950986623764, decouple_loss:0.027037719264626503
loss_pred:0.03404611721634865, decouple_loss:0.026819290593266487
loss_pred:0.033615365624427795, decouple_loss:0.027223948389291763
Iteration: 968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4637872278690338, gen p mean: 0.0, mean p set: 0.449869304895401
The modified gen p mean: 0.4621410667896271, gen p mean: 0.0, mean p set: 0.44761988520622253
The modified gen p mean: 0.45886287093162537, gen p mean: 0.0, mean p set: 0.4482978880405426
loss_pred:0.03568302467465401, decouple_loss:0.02609112113714218
loss_pred:0.03425672650337219, decouple_loss:0.026443064212799072
loss_pred:0.03446361422538757, decouple_loss:0.027032136917114258
Iteration: 969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44146376848220825, gen p mean: 0.0, mean p set: 0.4474617540836334
The modified gen p mean: 0.43944042921066284, gen p mean: 0.0, mean p set: 0.4488462209701538
The modified gen p mean: 0.4397934079170227, gen p mean: 0.0, mean p set: 0.44808489084243774
loss_pred:0.0338301919400692, decouple_loss:0.02596813440322876
loss_pred:0.033706337213516235, decouple_loss:0.026141822338104248
loss_pred:0.03359537944197655, decouple_loss:0.02623686008155346
Iteration: 970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4441465735435486, gen p mean: 0.0, mean p set: 0.4488007128238678
The modified gen p mean: 0.44069913029670715, gen p mean: 0.0, mean p set: 0.4466353952884674
The modified gen p mean: 0.4399562478065491, gen p mean: 0.0, mean p set: 0.44656795263290405
loss_pred:0.03482568636536598, decouple_loss:0.02611897513270378
loss_pred:0.03445492684841156, decouple_loss:0.02692554146051407
loss_pred:0.03460882231593132, decouple_loss:0.02687862329185009
2023-05-02 20:51:42 testing...
The modified gen p mean: 0.4460033178329468, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45143869519233704, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45407891273498535, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03535008430480957, decouple_loss:0.028102518990635872
loss_pred:0.03455772250890732, decouple_loss:0.02729581482708454
loss_pred:0.03370160236954689, decouple_loss:0.028171846643090248
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03592930734157562, avg_mse: 0.038214609026908875
current test mse: 0.038215
Iteration: 971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495046138763428, gen p mean: 0.0, mean p set: 0.4499136209487915
The modified gen p mean: 0.4498063623905182, gen p mean: 0.0, mean p set: 0.44789430499076843
loss_pred:0.03456251323223114, decouple_loss:0.027175841853022575
loss_pred:0.033726710826158524, decouple_loss:0.025527015328407288
The modified gen p mean: 0.44740864634513855, gen p mean: 0.0, mean p set: 0.445966511964798
loss_pred:0.034927546977996826, decouple_loss:0.026902254670858383
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
NaN value num: 0
Iteration: 972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45478272438049316, gen p mean: 0.0, mean p set: 0.4519474506378174
The modified gen p mean: 0.4621201157569885, gen p mean: 0.0, mean p set: 0.45097577571868896
The modified gen p mean: 0.4580041170120239, gen p mean: 0.0, mean p set: 0.44969022274017334
loss_pred:0.035117268562316895, decouple_loss:0.03059656359255314
loss_pred:0.0340120792388916, decouple_loss:0.03094463050365448
loss_pred:0.03276222199201584, decouple_loss:0.03169579803943634
Iteration: 973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539107382297516, gen p mean: 0.0, mean p set: 0.4503384232521057
The modified gen p mean: 0.4527955949306488, gen p mean: 0.0, mean p set: 0.4507162272930145
The modified gen p mean: 0.4492504894733429, gen p mean: 0.0, mean p set: 0.45173394680023193
loss_pred:0.03310496360063553, decouple_loss:0.031187063083052635
loss_pred:0.033088043332099915, decouple_loss:0.031479597091674805
loss_pred:0.033612433820962906, decouple_loss:0.031434282660484314
Iteration: 974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539944529533386, gen p mean: 0.0, mean p set: 0.4524841606616974
The modified gen p mean: 0.455075204372406, gen p mean: 0.0, mean p set: 0.44922199845314026
The modified gen p mean: 0.4516741633415222, gen p mean: 0.0, mean p set: 0.45272788405418396
loss_pred:0.033675506711006165, decouple_loss:0.030502835288643837
loss_pred:0.03570092096924782, decouple_loss:0.03254229575395584
loss_pred:0.03536472097039223, decouple_loss:0.03093307465314865
Iteration: 975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4431212842464447, gen p mean: 0.0, mean p set: 0.4513757526874542
The modified gen p mean: 0.4427148997783661, gen p mean: 0.0, mean p set: 0.45101502537727356
The modified gen p mean: 0.44395408034324646, gen p mean: 0.0, mean p set: 0.4523622393608093
loss_pred:0.03322320431470871, decouple_loss:0.029702333733439445
loss_pred:0.034229204058647156, decouple_loss:0.028883101418614388
loss_pred:0.0340585857629776, decouple_loss:0.02871495671570301
Iteration: 976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44572508335113525, gen p mean: 0.0, mean p set: 0.45094114542007446
The modified gen p mean: 0.44547513127326965, gen p mean: 0.0, mean p set: 0.4485994875431061
The modified gen p mean: 0.4480757713317871, gen p mean: 0.0, mean p set: 0.4514772295951843
loss_pred:0.03250662982463837, decouple_loss:0.029592499136924744
loss_pred:0.03472718223929405, decouple_loss:0.030047504231333733
loss_pred:0.033052146434783936, decouple_loss:0.028946300968527794
Iteration: 977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45208248496055603, gen p mean: 0.0, mean p set: 0.4524208605289459
The modified gen p mean: 0.45386016368865967, gen p mean: 0.0, mean p set: 0.450663298368454
The modified gen p mean: 0.45677894353866577, gen p mean: 0.0, mean p set: 0.4511450529098511
loss_pred:0.03518291190266609, decouple_loss:0.029724715277552605
loss_pred:0.03498981148004532, decouple_loss:0.028605913743376732
loss_pred:0.03195580840110779, decouple_loss:0.02912825718522072
Iteration: 978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46453696489334106, gen p mean: 0.0, mean p set: 0.44945064187049866
The modified gen p mean: 0.4608934819698334, gen p mean: 0.0, mean p set: 0.45163747668266296
The modified gen p mean: 0.46322372555732727, gen p mean: 0.0, mean p set: 0.44948139786720276
loss_pred:0.03459266200661659, decouple_loss:0.03183761239051819
loss_pred:0.03254569694399834, decouple_loss:0.028890499845147133
loss_pred:0.03473542630672455, decouple_loss:0.031271595507860184
Iteration: 979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4413420259952545, gen p mean: 0.0, mean p set: 0.451826274394989
The modified gen p mean: 0.44646626710891724, gen p mean: 0.0, mean p set: 0.4511634409427643
The modified gen p mean: 0.4440770149230957, gen p mean: 0.0, mean p set: 0.4510786831378937
loss_pred:0.03360992297530174, decouple_loss:0.02770351804792881
loss_pred:0.03401513397693634, decouple_loss:0.028517069295048714
loss_pred:0.03235402703285217, decouple_loss:0.02810276485979557
Iteration: 980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4441724121570587, gen p mean: 0.0, mean p set: 0.4509385824203491
The modified gen p mean: 0.4409354627132416, gen p mean: 0.0, mean p set: 0.45162826776504517
The modified gen p mean: 0.4447077214717865, gen p mean: 0.0, mean p set: 0.4486648738384247
loss_pred:0.03407740965485573, decouple_loss:0.0276864692568779
loss_pred:0.03149762004613876, decouple_loss:0.027727706357836723
loss_pred:0.034708421677351, decouple_loss:0.02832731045782566
2023-05-02 20:56:01 testing...
The modified gen p mean: 0.45084479451179504, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4426596164703369, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4482688903808594, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03377803415060043, decouple_loss:0.03142380341887474
loss_pred:0.035678375512361526, decouple_loss:0.0315820574760437
loss_pred:0.03479183465242386, decouple_loss:0.030597800388932228
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03630947694182396, avg_mse: 0.03873595595359802
current test mse: 0.038736
Iteration: 981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4548693895339966, gen p mean: 0.0, mean p set: 0.45071932673454285
The modified gen p mean: 0.45177727937698364, gen p mean: 0.0, mean p set: 0.4511736333370209
loss_pred:0.03427586331963539, decouple_loss:0.02737603895366192
loss_pred:0.0333094485104084, decouple_loss:0.02833305113017559
The modified gen p mean: 0.45069780945777893, gen p mean: 0.0, mean p set: 0.45032238960266113
loss_pred:0.03412654250860214, decouple_loss:0.028608091175556183
Iteration: 982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45528295636177063, gen p mean: 0.0, mean p set: 0.4513179361820221
The modified gen p mean: 0.4523763954639435, gen p mean: 0.0, mean p set: 0.4503360688686371
The modified gen p mean: 0.45249035954475403, gen p mean: 0.0, mean p set: 0.451659619808197
loss_pred:0.03176302835345268, decouple_loss:0.02776719070971012
loss_pred:0.034813687205314636, decouple_loss:0.030468324199318886
loss_pred:0.03289681673049927, decouple_loss:0.028198158368468285
Iteration: 983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464068114757538, gen p mean: 0.0, mean p set: 0.4516703188419342
The modified gen p mean: 0.4508751332759857, gen p mean: 0.0, mean p set: 0.4524308443069458
The modified gen p mean: 0.4481787085533142, gen p mean: 0.0, mean p set: 0.45174965262413025
loss_pred:0.034820232540369034, decouple_loss:0.029140762984752655
loss_pred:0.03311239182949066, decouple_loss:0.02747439593076706
loss_pred:0.03240629658102989, decouple_loss:0.02778029628098011
Iteration: 984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530707895755768, gen p mean: 0.0, mean p set: 0.44973814487457275
The modified gen p mean: 0.4529474675655365, gen p mean: 0.0, mean p set: 0.4516293406486511
The modified gen p mean: 0.4482666254043579, gen p mean: 0.0, mean p set: 0.4514824450016022
loss_pred:0.03565044701099396, decouple_loss:0.031025845557451248
loss_pred:0.03353160619735718, decouple_loss:0.026876352727413177
loss_pred:0.03360500559210777, decouple_loss:0.02846391126513481
Iteration: 985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543459415435791, gen p mean: 0.0, mean p set: 0.4508203864097595
The modified gen p mean: 0.4517779052257538, gen p mean: 0.0, mean p set: 0.44987818598747253
The modified gen p mean: 0.4525225758552551, gen p mean: 0.0, mean p set: 0.4486250877380371
loss_pred:0.0331709124147892, decouple_loss:0.02638409286737442
loss_pred:0.03494534641504288, decouple_loss:0.029379606246948242
loss_pred:0.034570761024951935, decouple_loss:0.02896420657634735
Iteration: 986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4575618803501129, gen p mean: 0.0, mean p set: 0.4507116973400116
The modified gen p mean: 0.4567468762397766, gen p mean: 0.0, mean p set: 0.45086607336997986
The modified gen p mean: 0.4582020938396454, gen p mean: 0.0, mean p set: 0.4517979323863983
loss_pred:0.0347108393907547, decouple_loss:0.02834353968501091
loss_pred:0.035269517451524734, decouple_loss:0.02790757268667221
loss_pred:0.03137405216693878, decouple_loss:0.027203278616070747
Iteration: 987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4406471848487854, gen p mean: 0.0, mean p set: 0.448832631111145
The modified gen p mean: 0.44340354204177856, gen p mean: 0.0, mean p set: 0.4496423602104187
The modified gen p mean: 0.44598710536956787, gen p mean: 0.0, mean p set: 0.4489688575267792
loss_pred:0.03433166444301605, decouple_loss:0.029035689309239388
loss_pred:0.03481860086321831, decouple_loss:0.030476020649075508
loss_pred:0.03501710668206215, decouple_loss:0.0287863127887249
Iteration: 988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43798282742500305, gen p mean: 0.0, mean p set: 0.4512156844139099
The modified gen p mean: 0.43818485736846924, gen p mean: 0.0, mean p set: 0.4503934979438782
The modified gen p mean: 0.4370656907558441, gen p mean: 0.0, mean p set: 0.45111945271492004
loss_pred:0.03305760771036148, decouple_loss:0.0276165921241045
loss_pred:0.03365003317594528, decouple_loss:0.0283109899610281
loss_pred:0.033203206956386566, decouple_loss:0.028678344562649727
Iteration: 989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46708381175994873, gen p mean: 0.0, mean p set: 0.4522624611854553
The modified gen p mean: 0.46154889464378357, gen p mean: 0.0, mean p set: 0.4511139988899231
The modified gen p mean: 0.46186405420303345, gen p mean: 0.0, mean p set: 0.45086219906806946
loss_pred:0.03304338455200195, decouple_loss:0.027898628264665604
loss_pred:0.034203168004751205, decouple_loss:0.027896778658032417
loss_pred:0.03415094316005707, decouple_loss:0.0278046652674675
Iteration: 990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4564549922943115, gen p mean: 0.0, mean p set: 0.45189934968948364
The modified gen p mean: 0.4603191614151001, gen p mean: 0.0, mean p set: 0.44994789361953735
The modified gen p mean: 0.45867761969566345, gen p mean: 0.0, mean p set: 0.45230305194854736
loss_pred:0.03144103288650513, decouple_loss:0.027261000126600266
loss_pred:0.03521083667874336, decouple_loss:0.029229825362563133
loss_pred:0.03299429267644882, decouple_loss:0.0270986370742321
2023-05-02 20:59:44 testing...
The modified gen p mean: 0.42778709530830383, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.43704402446746826, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4335760474205017, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.035879507660865784, decouple_loss:0.031078364700078964
loss_pred:0.03393793851137161, decouple_loss:0.031065352261066437
loss_pred:0.034816112369298935, decouple_loss:0.030079897493124008
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03641491383314133, avg_mse: 0.03891396522521973
current test mse: 0.038914
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
NaN value num: 0
Iteration: 991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43317344784736633, gen p mean: 0.0, mean p set: 0.4471806287765503
loss_pred:0.036608025431632996, decouple_loss:0.030263831838965416
The modified gen p mean: 0.4342953860759735, gen p mean: 0.0, mean p set: 0.4469884932041168
loss_pred:0.03686638921499252, decouple_loss:0.03087889403104782
The modified gen p mean: 0.4373910129070282, gen p mean: 0.0, mean p set: 0.44935378432273865
loss_pred:0.03684705123305321, decouple_loss:0.030156351625919342
Iteration: 992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538860023021698, gen p mean: 0.0, mean p set: 0.44874924421310425
The modified gen p mean: 0.4529600739479065, gen p mean: 0.0, mean p set: 0.4475279748439789
The modified gen p mean: 0.4513079524040222, gen p mean: 0.0, mean p set: 0.447790265083313
loss_pred:0.03537039831280708, decouple_loss:0.029722655192017555
loss_pred:0.036678023636341095, decouple_loss:0.029443737119436264
loss_pred:0.03589654341340065, decouple_loss:0.029818523675203323
Iteration: 993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44441935420036316, gen p mean: 0.0, mean p set: 0.44805729389190674
The modified gen p mean: 0.45162704586982727, gen p mean: 0.0, mean p set: 0.4493786096572876
The modified gen p mean: 0.4520801603794098, gen p mean: 0.0, mean p set: 0.44860756397247314
loss_pred:0.036703694611787796, decouple_loss:0.029911352321505547
loss_pred:0.03487342596054077, decouple_loss:0.028738809749484062
loss_pred:0.03387397900223732, decouple_loss:0.029606372117996216
Iteration: 994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44178903102874756, gen p mean: 0.0, mean p set: 0.4486088454723358
The modified gen p mean: 0.4400206208229065, gen p mean: 0.0, mean p set: 0.44868648052215576
The modified gen p mean: 0.4423867464065552, gen p mean: 0.0, mean p set: 0.44720733165740967
loss_pred:0.03609514236450195, decouple_loss:0.028742430731654167
loss_pred:0.03412742167711258, decouple_loss:0.02876119315624237
loss_pred:0.03586583584547043, decouple_loss:0.028611470013856888
Iteration: 995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45884227752685547, gen p mean: 0.0, mean p set: 0.44845619797706604
The modified gen p mean: 0.458753377199173, gen p mean: 0.0, mean p set: 0.44825637340545654
The modified gen p mean: 0.45687758922576904, gen p mean: 0.0, mean p set: 0.4488303065299988
loss_pred:0.033677615225315094, decouple_loss:0.027795834466814995
loss_pred:0.03560355678200722, decouple_loss:0.028401952236890793
loss_pred:0.034910447895526886, decouple_loss:0.02796543948352337
Iteration: 996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45294952392578125, gen p mean: 0.0, mean p set: 0.4485867917537689
The modified gen p mean: 0.4527524411678314, gen p mean: 0.0, mean p set: 0.4479617476463318
The modified gen p mean: 0.4517126977443695, gen p mean: 0.0, mean p set: 0.44820740818977356
loss_pred:0.036453727632761, decouple_loss:0.02728492207825184
loss_pred:0.03372772037982941, decouple_loss:0.02835070714354515
loss_pred:0.03648111969232559, decouple_loss:0.028014564886689186
Iteration: 997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44004836678504944, gen p mean: 0.0, mean p set: 0.4497016966342926
The modified gen p mean: 0.43338096141815186, gen p mean: 0.0, mean p set: 0.44758954644203186
The modified gen p mean: 0.43077152967453003, gen p mean: 0.0, mean p set: 0.4484488368034363
loss_pred:0.03617795184254646, decouple_loss:0.027269691228866577
loss_pred:0.036319147795438766, decouple_loss:0.02753412164747715
loss_pred:0.035138364881277084, decouple_loss:0.0276624895632267
Iteration: 998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526802599430084, gen p mean: 0.0, mean p set: 0.44770026206970215
The modified gen p mean: 0.45216432213783264, gen p mean: 0.0, mean p set: 0.44986119866371155
The modified gen p mean: 0.4536293148994446, gen p mean: 0.0, mean p set: 0.4481366276741028
loss_pred:0.036494117230176926, decouple_loss:0.02796267718076706
loss_pred:0.036219753324985504, decouple_loss:0.028123948723077774
loss_pred:0.034801751375198364, decouple_loss:0.027276121079921722
Iteration: 999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44805893301963806, gen p mean: 0.0, mean p set: 0.44854092597961426
The modified gen p mean: 0.4581436812877655, gen p mean: 0.0, mean p set: 0.4485064744949341
The modified gen p mean: 0.45773690938949585, gen p mean: 0.0, mean p set: 0.4483422338962555
loss_pred:0.03551134467124939, decouple_loss:0.02743632160127163
loss_pred:0.035559047013521194, decouple_loss:0.028236370533704758
loss_pred:0.03586827591061592, decouple_loss:0.02817879244685173
Iteration: 1000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44071242213249207, gen p mean: 0.0, mean p set: 0.4487842321395874
The modified gen p mean: 0.4417839050292969, gen p mean: 0.0, mean p set: 0.44724079966545105
The modified gen p mean: 0.4368091821670532, gen p mean: 0.0, mean p set: 0.4495477080345154
loss_pred:0.03499702364206314, decouple_loss:0.027310144156217575
loss_pred:0.03649856150150299, decouple_loss:0.028301825746893883
loss_pred:0.03505990281701088, decouple_loss:0.027279965579509735
2023-05-02 21:04:09 itr: 1000
training loss: [0.0364239  0.03636253 0.03791365]
2023-05-02 21:04:09 testing...
The modified gen p mean: 0.44494760036468506, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45023298263549805, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45316073298454285, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.035179298371076584, decouple_loss:0.028566420078277588
loss_pred:0.03432508930563927, decouple_loss:0.027653923258185387
loss_pred:0.033596593886613846, decouple_loss:0.028788605704903603
WV_0_PC_0_EH_0_PS_40_6, loss: 0.035783812403678894, avg_mse: 0.0382087342441082
current test mse: 0.038209
Iteration: 1001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504234790802002, gen p mean: 0.0, mean p set: 0.4485757648944855
The modified gen p mean: 0.45137912034988403, gen p mean: 0.0, mean p set: 0.44672608375549316
loss_pred:0.03455303981900215, decouple_loss:0.027910424396395683
loss_pred:0.03590863570570946, decouple_loss:0.02832914888858795
The modified gen p mean: 0.45284679532051086, gen p mean: 0.0, mean p set: 0.44808417558670044
loss_pred:0.036443229764699936, decouple_loss:0.027912292629480362
Iteration: 1002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4574681520462036, gen p mean: 0.0, mean p set: 0.44849130511283875
The modified gen p mean: 0.4571276307106018, gen p mean: 0.0, mean p set: 0.4500318169593811
The modified gen p mean: 0.457201212644577, gen p mean: 0.0, mean p set: 0.4478370249271393
loss_pred:0.034182291477918625, decouple_loss:0.02737279050052166
loss_pred:0.034809261560440063, decouple_loss:0.027340738102793694
loss_pred:0.03513306751847267, decouple_loss:0.0273854061961174
Iteration: 1003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4415115416049957, gen p mean: 0.0, mean p set: 0.44700080156326294
The modified gen p mean: 0.43090739846229553, gen p mean: 0.0, mean p set: 0.4487628936767578
The modified gen p mean: 0.4381043314933777, gen p mean: 0.0, mean p set: 0.4507392346858978
loss_pred:0.03618425130844116, decouple_loss:0.026936747133731842
loss_pred:0.03650515154004097, decouple_loss:0.02828300930559635
loss_pred:0.034532010555267334, decouple_loss:0.02678629755973816
Iteration: 1004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44583243131637573, gen p mean: 0.0, mean p set: 0.4466431736946106
The modified gen p mean: 0.4498880207538605, gen p mean: 0.0, mean p set: 0.44937095046043396
The modified gen p mean: 0.4450153708457947, gen p mean: 0.0, mean p set: 0.44631341099739075
loss_pred:0.03561349958181381, decouple_loss:0.026220323517918587
loss_pred:0.035208553075790405, decouple_loss:0.027578730136156082
loss_pred:0.036026328802108765, decouple_loss:0.027354124933481216
Iteration: 1005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45342323184013367, gen p mean: 0.0, mean p set: 0.4490620791912079
The modified gen p mean: 0.45520851016044617, gen p mean: 0.0, mean p set: 0.44898083806037903
The modified gen p mean: 0.4524492919445038, gen p mean: 0.0, mean p set: 0.44967013597488403
loss_pred:0.0359111949801445, decouple_loss:0.026422912254929543
loss_pred:0.03494487330317497, decouple_loss:0.026313139125704765
loss_pred:0.03492848947644234, decouple_loss:0.026305750012397766
Iteration: 1006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512900412082672, gen p mean: 0.0, mean p set: 0.449575275182724
The modified gen p mean: 0.4492376446723938, gen p mean: 0.0, mean p set: 0.44878700375556946
The modified gen p mean: 0.45046308636665344, gen p mean: 0.0, mean p set: 0.4472734034061432
loss_pred:0.03517383337020874, decouple_loss:0.026732077822089195
loss_pred:0.03603309765458107, decouple_loss:0.026079917326569557
loss_pred:0.03641601279377937, decouple_loss:0.026306144893169403
Iteration: 1007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.442335844039917, gen p mean: 0.0, mean p set: 0.4508633017539978
The modified gen p mean: 0.4421694576740265, gen p mean: 0.0, mean p set: 0.4484530985355377
The modified gen p mean: 0.44483715295791626, gen p mean: 0.0, mean p set: 0.44873231649398804
loss_pred:0.034220851957798004, decouple_loss:0.02578534558415413
loss_pred:0.03418281674385071, decouple_loss:0.02603502944111824
loss_pred:0.0346907339990139, decouple_loss:0.026145778596401215
Iteration: 1008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513428509235382, gen p mean: 0.0, mean p set: 0.44770923256874084
The modified gen p mean: 0.4583486020565033, gen p mean: 0.0, mean p set: 0.44947269558906555
The modified gen p mean: 0.4526008069515228, gen p mean: 0.0, mean p set: 0.44801533222198486
loss_pred:0.03571876510977745, decouple_loss:0.026738319545984268
loss_pred:0.035473041236400604, decouple_loss:0.026062633842229843
loss_pred:0.03427887707948685, decouple_loss:0.02620185911655426
Iteration: 1009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4396142065525055, gen p mean: 0.0, mean p set: 0.4485483467578888
The modified gen p mean: 0.45013442635536194, gen p mean: 0.0, mean p set: 0.4477182924747467
The modified gen p mean: 0.446725457906723, gen p mean: 0.0, mean p set: 0.4479931592941284
loss_pred:0.03547436743974686, decouple_loss:0.027058184146881104
loss_pred:0.035868991166353226, decouple_loss:0.02579537034034729
loss_pred:0.034498732537031174, decouple_loss:0.025891143828630447
Iteration: 1010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839754700660706, gen p mean: 0.0, mean p set: 0.4481014907360077
The modified gen p mean: 0.4468749463558197, gen p mean: 0.0, mean p set: 0.4481804668903351
The modified gen p mean: 0.4488607347011566, gen p mean: 0.0, mean p set: 0.4466167390346527
loss_pred:0.036456149071455, decouple_loss:0.026185622438788414
loss_pred:0.03461308777332306, decouple_loss:0.02643568068742752
loss_pred:0.036433544009923935, decouple_loss:0.026042954996228218
2023-05-02 21:07:49 testing...
The modified gen p mean: 0.44506174325942993, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4533374309539795, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4505058526992798, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03519366309046745, decouple_loss:0.02784900926053524
loss_pred:0.033533405512571335, decouple_loss:0.027703022584319115
loss_pred:0.0343373566865921, decouple_loss:0.02682831510901451
WV_0_PC_0_EH_0_PS_40_6, loss: 0.035727813839912415, avg_mse: 0.03823617473244667
current test mse: 0.038236
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
NaN value num: 0
Iteration: 1011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466738700866699, gen p mean: 0.0, mean p set: 0.44697561860084534
The modified gen p mean: 0.44916853308677673, gen p mean: 0.0, mean p set: 0.44708189368247986
loss_pred:0.033460039645433426, decouple_loss:0.027487149462103844
loss_pred:0.03467125818133354, decouple_loss:0.026700789108872414
The modified gen p mean: 0.44970959424972534, gen p mean: 0.0, mean p set: 0.4466998875141144
loss_pred:0.034531883895397186, decouple_loss:0.02681152895092964
Iteration: 1012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43951138854026794, gen p mean: 0.0, mean p set: 0.44769448041915894
The modified gen p mean: 0.4447563886642456, gen p mean: 0.0, mean p set: 0.4482783079147339
The modified gen p mean: 0.4443073272705078, gen p mean: 0.0, mean p set: 0.4464176893234253
loss_pred:0.03448047488927841, decouple_loss:0.02978912554681301
loss_pred:0.033808011561632156, decouple_loss:0.02821732498705387
loss_pred:0.03348734229803085, decouple_loss:0.027094410732388496
Iteration: 1013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4406731128692627, gen p mean: 0.0, mean p set: 0.4475610554218292
The modified gen p mean: 0.44867509603500366, gen p mean: 0.0, mean p set: 0.4462357461452484
The modified gen p mean: 0.44888076186180115, gen p mean: 0.0, mean p set: 0.44611674547195435
loss_pred:0.03339032456278801, decouple_loss:0.02692168578505516
loss_pred:0.03445084020495415, decouple_loss:0.027595318853855133
loss_pred:0.03391329571604729, decouple_loss:0.02720884419977665
Iteration: 1014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44396236538887024, gen p mean: 0.0, mean p set: 0.4483734667301178
The modified gen p mean: 0.4433523416519165, gen p mean: 0.0, mean p set: 0.4476989805698395
The modified gen p mean: 0.4495461583137512, gen p mean: 0.0, mean p set: 0.4468423128128052
loss_pred:0.03403719514608383, decouple_loss:0.027168046683073044
loss_pred:0.035358961671590805, decouple_loss:0.026991428807377815
loss_pred:0.033703867346048355, decouple_loss:0.026567794382572174
Iteration: 1015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535354971885681, gen p mean: 0.0, mean p set: 0.4471885859966278
The modified gen p mean: 0.45296964049339294, gen p mean: 0.0, mean p set: 0.4478275179862976
The modified gen p mean: 0.4538697302341461, gen p mean: 0.0, mean p set: 0.44620731472969055
loss_pred:0.0348452627658844, decouple_loss:0.026861034333705902
loss_pred:0.03459117189049721, decouple_loss:0.026829130947589874
loss_pred:0.03539644554257393, decouple_loss:0.026980917900800705
Iteration: 1016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44287022948265076, gen p mean: 0.0, mean p set: 0.44727015495300293
The modified gen p mean: 0.44919097423553467, gen p mean: 0.0, mean p set: 0.44620129466056824
The modified gen p mean: 0.4444449245929718, gen p mean: 0.0, mean p set: 0.44652286171913147
loss_pred:0.03360823914408684, decouple_loss:0.026142163202166557
loss_pred:0.03360385075211525, decouple_loss:0.026519417762756348
loss_pred:0.03507855162024498, decouple_loss:0.02755073457956314
Iteration: 1017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44227129220962524, gen p mean: 0.0, mean p set: 0.45001867413520813
The modified gen p mean: 0.43689054250717163, gen p mean: 0.0, mean p set: 0.448774129152298
The modified gen p mean: 0.44219186902046204, gen p mean: 0.0, mean p set: 0.4501565396785736
loss_pred:0.03477347269654274, decouple_loss:0.02805439755320549
loss_pred:0.03536057472229004, decouple_loss:0.02827562764286995
loss_pred:0.03482387959957123, decouple_loss:0.02742827497422695
Iteration: 1018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493439495563507, gen p mean: 0.0, mean p set: 0.44679519534111023
The modified gen p mean: 0.45057153701782227, gen p mean: 0.0, mean p set: 0.4493103623390198
The modified gen p mean: 0.452978253364563, gen p mean: 0.0, mean p set: 0.446562796831131
loss_pred:0.033176809549331665, decouple_loss:0.025823991745710373
loss_pred:0.03395358845591545, decouple_loss:0.027322957292199135
loss_pred:0.03491772338747978, decouple_loss:0.02539760246872902
Iteration: 1019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4572939872741699, gen p mean: 0.0, mean p set: 0.4470725357532501
The modified gen p mean: 0.4582001566886902, gen p mean: 0.0, mean p set: 0.4461832046508789
The modified gen p mean: 0.4578760862350464, gen p mean: 0.0, mean p set: 0.44654545187950134
loss_pred:0.03588048741221428, decouple_loss:0.026488909497857094
loss_pred:0.033936500549316406, decouple_loss:0.026956874877214432
loss_pred:0.0358591228723526, decouple_loss:0.026672011241316795
Iteration: 1020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454825818538666, gen p mean: 0.0, mean p set: 0.44634005427360535
The modified gen p mean: 0.4426756501197815, gen p mean: 0.0, mean p set: 0.447676420211792
The modified gen p mean: 0.44519567489624023, gen p mean: 0.0, mean p set: 0.44678524136543274
loss_pred:0.03448149189352989, decouple_loss:0.026111768558621407
loss_pred:0.03586828336119652, decouple_loss:0.027228664606809616
loss_pred:0.03302926942706108, decouple_loss:0.026494527235627174
2023-05-02 21:12:12 testing...
The modified gen p mean: 0.43709731101989746, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44306862354278564, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44606220722198486, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03512432426214218, decouple_loss:0.02839040942490101
loss_pred:0.0342123880982399, decouple_loss:0.027074065059423447
loss_pred:0.033257804811000824, decouple_loss:0.028107907623052597
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03559104725718498, avg_mse: 0.038107793778181076
current test mse: 0.038108
Iteration: 1021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4397265911102295, gen p mean: 0.0, mean p set: 0.44742733240127563
loss_pred:0.03469274938106537, decouple_loss:0.02653878927230835
The modified gen p mean: 0.43631938099861145, gen p mean: 0.0, mean p set: 0.4482870399951935
loss_pred:0.032769158482551575, decouple_loss:0.026235129684209824
The modified gen p mean: 0.4390380382537842, gen p mean: 0.0, mean p set: 0.44711199402809143
loss_pred:0.03514884412288666, decouple_loss:0.025942062959074974
Iteration: 1022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508099853992462, gen p mean: 0.0, mean p set: 0.44635435938835144
The modified gen p mean: 0.44939500093460083, gen p mean: 0.0, mean p set: 0.44738173484802246
The modified gen p mean: 0.4497338831424713, gen p mean: 0.0, mean p set: 0.44841188192367554
loss_pred:0.03322973847389221, decouple_loss:0.025141961872577667
loss_pred:0.035081300884485245, decouple_loss:0.025680167600512505
loss_pred:0.03363213315606117, decouple_loss:0.02666240744292736
Iteration: 1023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858378171920776, gen p mean: 0.0, mean p set: 0.44760003685951233
The modified gen p mean: 0.45402076840400696, gen p mean: 0.0, mean p set: 0.44743549823760986
The modified gen p mean: 0.4550842046737671, gen p mean: 0.0, mean p set: 0.4468569755554199
loss_pred:0.03323719650506973, decouple_loss:0.025460749864578247
loss_pred:0.03515707328915596, decouple_loss:0.02587544545531273
loss_pred:0.03339565172791481, decouple_loss:0.02677113562822342
Iteration: 1024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4413299560546875, gen p mean: 0.0, mean p set: 0.4479977488517761
The modified gen p mean: 0.4484025537967682, gen p mean: 0.0, mean p set: 0.4476877748966217
The modified gen p mean: 0.450309157371521, gen p mean: 0.0, mean p set: 0.446946382522583
loss_pred:0.03328286483883858, decouple_loss:0.025120001286268234
loss_pred:0.03444250300526619, decouple_loss:0.02621878683567047
loss_pred:0.0339621864259243, decouple_loss:0.027391470968723297
Iteration: 1025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465920329093933, gen p mean: 0.0, mean p set: 0.44679397344589233
The modified gen p mean: 0.4364531636238098, gen p mean: 0.0, mean p set: 0.4474274814128876
The modified gen p mean: 0.4416744112968445, gen p mean: 0.0, mean p set: 0.4472094774246216
loss_pred:0.03599897399544716, decouple_loss:0.026094377040863037
loss_pred:0.033483099192380905, decouple_loss:0.027331341058015823
loss_pred:0.03248102217912674, decouple_loss:0.02524547278881073
Iteration: 1026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4400751292705536, gen p mean: 0.0, mean p set: 0.44735464453697205
The modified gen p mean: 0.4446374773979187, gen p mean: 0.0, mean p set: 0.446674108505249
The modified gen p mean: 0.44455474615097046, gen p mean: 0.0, mean p set: 0.44729360938072205
loss_pred:0.03294956311583519, decouple_loss:0.02535826712846756
loss_pred:0.03393160551786423, decouple_loss:0.0249186921864748
loss_pred:0.03400392457842827, decouple_loss:0.025410238653421402
Iteration: 1027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488055109977722, gen p mean: 0.0, mean p set: 0.44702741503715515
The modified gen p mean: 0.44621720910072327, gen p mean: 0.0, mean p set: 0.44909629225730896
The modified gen p mean: 0.4449571669101715, gen p mean: 0.0, mean p set: 0.44815075397491455
loss_pred:0.032473690807819366, decouple_loss:0.024422571063041687
loss_pred:0.03572964668273926, decouple_loss:0.026353608816862106
loss_pred:0.03273336961865425, decouple_loss:0.024809250608086586
Iteration: 1028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4554632306098938, gen p mean: 0.0, mean p set: 0.446643590927124
The modified gen p mean: 0.45114830136299133, gen p mean: 0.0, mean p set: 0.4492454528808594
The modified gen p mean: 0.4511982500553131, gen p mean: 0.0, mean p set: 0.44608867168426514
loss_pred:0.03321247175335884, decouple_loss:0.026645751670002937
loss_pred:0.03442385420203209, decouple_loss:0.02589917555451393
loss_pred:0.034928951412439346, decouple_loss:0.026838887482881546
Iteration: 1029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843947887420654, gen p mean: 0.0, mean p set: 0.44739121198654175
The modified gen p mean: 0.4427524209022522, gen p mean: 0.0, mean p set: 0.4481349289417267
The modified gen p mean: 0.44874000549316406, gen p mean: 0.0, mean p set: 0.44925111532211304
loss_pred:0.03506733849644661, decouple_loss:0.026334170252084732
loss_pred:0.034678105264902115, decouple_loss:0.027871422469615936
loss_pred:0.034078843891620636, decouple_loss:0.026850517839193344
Iteration: 1030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529188573360443, gen p mean: 0.0, mean p set: 0.44896358251571655
The modified gen p mean: 0.45461317896842957, gen p mean: 0.0, mean p set: 0.44628050923347473
The modified gen p mean: 0.4506690800189972, gen p mean: 0.0, mean p set: 0.44954198598861694
loss_pred:0.03330029547214508, decouple_loss:0.026029495522379875
loss_pred:0.03304792195558548, decouple_loss:0.02615905925631523
loss_pred:0.03412233665585518, decouple_loss:0.0259418785572052
2023-05-02 21:15:54 testing...
The modified gen p mean: 0.44841673970222473, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44218549132347107, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4514869153499603, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03412016108632088, decouple_loss:0.02713312953710556
loss_pred:0.03501070290803909, decouple_loss:0.028117207810282707
loss_pred:0.033319681882858276, decouple_loss:0.02849547564983368
WV_0_PC_0_EH_0_PS_40_6, loss: 0.035545945167541504, avg_mse: 0.03810646012425423
current test mse: 0.038106
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
NaN value num: 0
Iteration: 1031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654855132102966, gen p mean: 0.0, mean p set: 0.45408543944358826
The modified gen p mean: 0.44656842947006226, gen p mean: 0.0, mean p set: 0.4511964023113251
loss_pred:0.03495588153600693, decouple_loss:0.03151039406657219
loss_pred:0.034538473933935165, decouple_loss:0.032002899795770645
The modified gen p mean: 0.4518141746520996, gen p mean: 0.0, mean p set: 0.45138245820999146
loss_pred:0.03516800329089165, decouple_loss:0.02929440513253212
Iteration: 1032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460480809211731, gen p mean: 0.0, mean p set: 0.4524140954017639
The modified gen p mean: 0.4516145586967468, gen p mean: 0.0, mean p set: 0.45146021246910095
The modified gen p mean: 0.44867199659347534, gen p mean: 0.0, mean p set: 0.45117560029029846
loss_pred:0.033991117030382156, decouple_loss:0.0311250202357769
loss_pred:0.03478512540459633, decouple_loss:0.029224252328276634
loss_pred:0.033373769372701645, decouple_loss:0.029239606112241745
Iteration: 1033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4555223286151886, gen p mean: 0.0, mean p set: 0.4503021836280823
The modified gen p mean: 0.44807517528533936, gen p mean: 0.0, mean p set: 0.4498981535434723
The modified gen p mean: 0.44416874647140503, gen p mean: 0.0, mean p set: 0.45388877391815186
loss_pred:0.03370862826704979, decouple_loss:0.028712965548038483
loss_pred:0.033427510410547256, decouple_loss:0.029590237885713577
loss_pred:0.034674271941185, decouple_loss:0.03184526786208153
Iteration: 1034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46139436960220337, gen p mean: 0.0, mean p set: 0.44960349798202515
The modified gen p mean: 0.45216113328933716, gen p mean: 0.0, mean p set: 0.4519265294075012
The modified gen p mean: 0.4598711431026459, gen p mean: 0.0, mean p set: 0.45039525628089905
loss_pred:0.03349386155605316, decouple_loss:0.027770763263106346
loss_pred:0.03520321100950241, decouple_loss:0.03176319599151611
loss_pred:0.034800510853528976, decouple_loss:0.027751484885811806
Iteration: 1035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542196989059448, gen p mean: 0.0, mean p set: 0.451731413602829
The modified gen p mean: 0.45209017395973206, gen p mean: 0.0, mean p set: 0.45082327723503113
The modified gen p mean: 0.4566988945007324, gen p mean: 0.0, mean p set: 0.44990551471710205
loss_pred:0.03646938130259514, decouple_loss:0.03025451861321926
loss_pred:0.03452066332101822, decouple_loss:0.028921937569975853
loss_pred:0.03339449316263199, decouple_loss:0.027050605043768883
Iteration: 1036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44485872983932495, gen p mean: 0.0, mean p set: 0.4510097801685333
The modified gen p mean: 0.4429020583629608, gen p mean: 0.0, mean p set: 0.45187628269195557
The modified gen p mean: 0.4436079263687134, gen p mean: 0.0, mean p set: 0.4519501030445099
loss_pred:0.03406048193573952, decouple_loss:0.02693605236709118
loss_pred:0.03395279869437218, decouple_loss:0.02901269681751728
loss_pred:0.03304869681596756, decouple_loss:0.028732355684041977
Iteration: 1037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068633556365967, gen p mean: 0.0, mean p set: 0.4501255452632904
The modified gen p mean: 0.4555193781852722, gen p mean: 0.0, mean p set: 0.4515576958656311
The modified gen p mean: 0.450905978679657, gen p mean: 0.0, mean p set: 0.45199936628341675
loss_pred:0.03344336152076721, decouple_loss:0.028137842193245888
loss_pred:0.03371696174144745, decouple_loss:0.028096091002225876
loss_pred:0.03544996678829193, decouple_loss:0.028946571052074432
Iteration: 1038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955018162727356, gen p mean: 0.0, mean p set: 0.45163723826408386
The modified gen p mean: 0.4505261778831482, gen p mean: 0.0, mean p set: 0.4515494108200073
The modified gen p mean: 0.4520673453807831, gen p mean: 0.0, mean p set: 0.4517843425273895
loss_pred:0.03427475318312645, decouple_loss:0.028497004881501198
loss_pred:0.03300463780760765, decouple_loss:0.027607670053839684
loss_pred:0.03694245591759682, decouple_loss:0.028564080595970154
Iteration: 1039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515218436717987, gen p mean: 0.0, mean p set: 0.4524848163127899
The modified gen p mean: 0.45508021116256714, gen p mean: 0.0, mean p set: 0.45126447081565857
The modified gen p mean: 0.4464924931526184, gen p mean: 0.0, mean p set: 0.452907919883728
loss_pred:0.03327852115035057, decouple_loss:0.028426947072148323
loss_pred:0.033871475607156754, decouple_loss:0.025668583810329437
loss_pred:0.034646034240722656, decouple_loss:0.02859780378639698
Iteration: 1040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525042474269867, gen p mean: 0.0, mean p set: 0.4520801901817322
The modified gen p mean: 0.4455312192440033, gen p mean: 0.0, mean p set: 0.4507656991481781
The modified gen p mean: 0.45177018642425537, gen p mean: 0.0, mean p set: 0.450794517993927
loss_pred:0.03470858931541443, decouple_loss:0.02858310006558895loss_pred:0.03313830494880676, decouple_loss:0.02710266225039959
loss_pred:0.03379122167825699, decouple_loss:0.028511973097920418
2023-05-02 21:20:21 testing...
The modified gen p mean: 0.4468096196651459, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.453107088804245, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45593202114105225, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.035163961350917816, decouple_loss:0.029965119436383247
loss_pred:0.034250177443027496, decouple_loss:0.02862553857266903
loss_pred:0.033288199454545975, decouple_loss:0.030243655666708946
WV_0_PC_0_EH_0_PS_40_6, loss: 0.035714685916900635, avg_mse: 0.0384160540997982
current test mse: 0.038416
Iteration: 1041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4569418728351593, gen p mean: 0.0, mean p set: 0.452106237411499
The modified gen p mean: 0.45141735672950745, gen p mean: 0.0, mean p set: 0.4511508643627167
loss_pred:0.0333707295358181, decouple_loss:0.02835521660745144
loss_pred:0.03365115448832512, decouple_loss:0.028175996616482735
The modified gen p mean: 0.45808348059654236, gen p mean: 0.0, mean p set: 0.4512827396392822
loss_pred:0.03421872854232788, decouple_loss:0.02641533687710762
Iteration: 1042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45650243759155273, gen p mean: 0.0, mean p set: 0.44981685280799866
The modified gen p mean: 0.45543333888053894, gen p mean: 0.0, mean p set: 0.4517787992954254
The modified gen p mean: 0.4555911421775818, gen p mean: 0.0, mean p set: 0.45293283462524414
loss_pred:0.03261531516909599, decouple_loss:0.02686608023941517
loss_pred:0.033436186611652374, decouple_loss:0.026854125782847404
loss_pred:0.033896565437316895, decouple_loss:0.027741674333810806
Iteration: 1043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530491232872009, gen p mean: 0.0, mean p set: 0.4516826570034027
The modified gen p mean: 0.4479559659957886, gen p mean: 0.0, mean p set: 0.4515541195869446
The modified gen p mean: 0.4504995346069336, gen p mean: 0.0, mean p set: 0.4516221284866333
loss_pred:0.03512020781636238, decouple_loss:0.02666684240102768
loss_pred:0.03337936848402023, decouple_loss:0.02629762515425682
loss_pred:0.03367610648274422, decouple_loss:0.027755016461014748
Iteration: 1044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43425247073173523, gen p mean: 0.0, mean p set: 0.45249274373054504
The modified gen p mean: 0.4346476197242737, gen p mean: 0.0, mean p set: 0.4516323506832123
The modified gen p mean: 0.44187793135643005, gen p mean: 0.0, mean p set: 0.45117807388305664
loss_pred:0.03499360382556915, decouple_loss:0.028534840792417526
loss_pred:0.033795736730098724, decouple_loss:0.028166428208351135
loss_pred:0.034792158752679825, decouple_loss:0.026025498285889626
Iteration: 1045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45284461975097656, gen p mean: 0.0, mean p set: 0.45236828923225403
The modified gen p mean: 0.450250506401062, gen p mean: 0.0, mean p set: 0.4503856897354126
The modified gen p mean: 0.4523126184940338, gen p mean: 0.0, mean p set: 0.45355916023254395
loss_pred:0.036674268543720245, decouple_loss:0.028033504262566566
loss_pred:0.03437754511833191, decouple_loss:0.027794206514954567
loss_pred:0.034067410975694656, decouple_loss:0.028039613738656044
Iteration: 1046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4597534239292145, gen p mean: 0.0, mean p set: 0.4505898058414459
The modified gen p mean: 0.46504244208335876, gen p mean: 0.0, mean p set: 0.4519629180431366
The modified gen p mean: 0.4659174978733063, gen p mean: 0.0, mean p set: 0.4510754346847534
loss_pred:0.034177590161561966, decouple_loss:0.027962282299995422
loss_pred:0.032936979085206985, decouple_loss:0.026157628744840622
loss_pred:0.03269350528717041, decouple_loss:0.025733374059200287
Iteration: 1047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491519033908844, gen p mean: 0.0, mean p set: 0.4524483382701874
The modified gen p mean: 0.45021796226501465, gen p mean: 0.0, mean p set: 0.4511864483356476
The modified gen p mean: 0.44477707147598267, gen p mean: 0.0, mean p set: 0.4519835412502289
loss_pred:0.036021359264850616, decouple_loss:0.027547968551516533
loss_pred:0.03385403752326965, decouple_loss:0.02777515910565853
loss_pred:0.0327749140560627, decouple_loss:0.028015349060297012
Iteration: 1048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467356204986572, gen p mean: 0.0, mean p set: 0.45080307126045227
The modified gen p mean: 0.4461281895637512, gen p mean: 0.0, mean p set: 0.45210859179496765
The modified gen p mean: 0.44218695163726807, gen p mean: 0.0, mean p set: 0.45304831862449646
loss_pred:0.03451250120997429, decouple_loss:0.026923036202788353loss_pred:0.03375775367021561, decouple_loss:0.027110246941447258
loss_pred:0.034680213779211044, decouple_loss:0.02744709514081478
Iteration: 1049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45707884430885315, gen p mean: 0.0, mean p set: 0.44899213314056396
The modified gen p mean: 0.4609617292881012, gen p mean: 0.0, mean p set: 0.45004045963287354
The modified gen p mean: 0.46218007802963257, gen p mean: 0.0, mean p set: 0.45141345262527466
loss_pred:0.03357987105846405, decouple_loss:0.027450067922472954
loss_pred:0.03344950079917908, decouple_loss:0.025467855855822563
loss_pred:0.03477928042411804, decouple_loss:0.02547028660774231
Iteration: 1050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778645038604736, gen p mean: 0.0, mean p set: 0.4488649070262909
The modified gen p mean: 0.45123013854026794, gen p mean: 0.0, mean p set: 0.45278817415237427
The modified gen p mean: 0.45225897431373596, gen p mean: 0.0, mean p set: 0.45234063267707825
loss_pred:0.03337160497903824, decouple_loss:0.02777767926454544
loss_pred:0.03623513504862785, decouple_loss:0.02652229368686676
loss_pred:0.035429541021585464, decouple_loss:0.0264828372746706
2023-05-02 21:24:04 testing...
The modified gen p mean: 0.43711093068122864, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44716888666152954, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44384655356407166, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03508777916431427, decouple_loss:0.03060620091855526
loss_pred:0.03323139250278473, decouple_loss:0.030272841453552246
loss_pred:0.03421853855252266, decouple_loss:0.028844954445958138
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03567463904619217, avg_mse: 0.03823394700884819
current test mse: 0.038234
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 1051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43844181299209595, gen p mean: 0.0, mean p set: 0.4477404057979584
The modified gen p mean: 0.434370756149292, gen p mean: 0.0, mean p set: 0.4493098258972168
loss_pred:0.03400425985455513, decouple_loss:0.031741805374622345
loss_pred:0.03337477892637253, decouple_loss:0.0317990705370903
The modified gen p mean: 0.4461097717285156, gen p mean: 0.0, mean p set: 0.4505167305469513
loss_pred:0.0346607007086277, decouple_loss:0.028533169999718666
Iteration: 1052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4585494101047516, gen p mean: 0.0, mean p set: 0.4476434886455536
The modified gen p mean: 0.46231892704963684, gen p mean: 0.0, mean p set: 0.44782590866088867
loss_pred:0.03301937133073807, decouple_loss:0.02929958887398243
The modified gen p mean: 0.45958954095840454, gen p mean: 0.0, mean p set: 0.44948315620422363
loss_pred:0.03475416079163551, decouple_loss:0.029375873506069183
loss_pred:0.03426722437143326, decouple_loss:0.027727322652935982
Iteration: 1053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450559139251709, gen p mean: 0.0, mean p set: 0.44752633571624756
The modified gen p mean: 0.45111533999443054, gen p mean: 0.0, mean p set: 0.44985491037368774
The modified gen p mean: 0.4543408155441284, gen p mean: 0.0, mean p set: 0.44838523864746094
loss_pred:0.032132018357515335, decouple_loss:0.028164034709334373
loss_pred:0.03425878658890724, decouple_loss:0.026638269424438477
loss_pred:0.0345478355884552, decouple_loss:0.027928084135055542
Iteration: 1054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43721798062324524, gen p mean: 0.0, mean p set: 0.44798991084098816
The modified gen p mean: 0.43324658274650574, gen p mean: 0.0, mean p set: 0.4468816816806793
The modified gen p mean: 0.4359632134437561, gen p mean: 0.0, mean p set: 0.44924888014793396
loss_pred:0.03221351280808449, decouple_loss:0.0266572255641222
loss_pred:0.03441770002245903, decouple_loss:0.031371623277664185
loss_pred:0.035089027136564255, decouple_loss:0.02739453688263893
Iteration: 1055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507949650287628, gen p mean: 0.0, mean p set: 0.44924619793891907
The modified gen p mean: 0.45479339361190796, gen p mean: 0.0, mean p set: 0.4483111500740051
The modified gen p mean: 0.44406411051750183, gen p mean: 0.0, mean p set: 0.4477921724319458
loss_pred:0.03400546684861183, decouple_loss:0.026957223191857338
loss_pred:0.03434198349714279, decouple_loss:0.027843985706567764
loss_pred:0.0330561101436615, decouple_loss:0.027698807418346405
Iteration: 1056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45752373337745667, gen p mean: 0.0, mean p set: 0.4479677379131317
The modified gen p mean: 0.4580131769180298, gen p mean: 0.0, mean p set: 0.44866541028022766
The modified gen p mean: 0.45754918456077576, gen p mean: 0.0, mean p set: 0.45020049810409546
loss_pred:0.03239339217543602, decouple_loss:0.026189560070633888
loss_pred:0.03364257887005806, decouple_loss:0.026584841310977936
loss_pred:0.03388906270265579, decouple_loss:0.02586536481976509
Iteration: 1057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45261362195014954, gen p mean: 0.0, mean p set: 0.447760671377182
The modified gen p mean: 0.45413270592689514, gen p mean: 0.0, mean p set: 0.44784975051879883
The modified gen p mean: 0.45150381326675415, gen p mean: 0.0, mean p set: 0.4488963484764099
loss_pred:0.03422736003994942, decouple_loss:0.025909166783094406
loss_pred:0.032839562743902206, decouple_loss:0.027354585006833076
loss_pred:0.03428061679005623, decouple_loss:0.027400387451052666
Iteration: 1058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4347628653049469, gen p mean: 0.0, mean p set: 0.4487197697162628
The modified gen p mean: 0.437904953956604, gen p mean: 0.0, mean p set: 0.4491964280605316
The modified gen p mean: 0.43548572063446045, gen p mean: 0.0, mean p set: 0.4483746588230133
loss_pred:0.03399794176220894, decouple_loss:0.029891766607761383
loss_pred:0.03305120766162872, decouple_loss:0.02740057185292244
loss_pred:0.033709388226270676, decouple_loss:0.02904440648853779
Iteration: 1059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44337767362594604, gen p mean: 0.0, mean p set: 0.4497106075286865
The modified gen p mean: 0.4442440867424011, gen p mean: 0.0, mean p set: 0.44863414764404297
The modified gen p mean: 0.45132631063461304, gen p mean: 0.0, mean p set: 0.4464992880821228
loss_pred:0.03335307911038399, decouple_loss:0.027320418506860733
loss_pred:0.03257574886083603, decouple_loss:0.025861799716949463
loss_pred:0.034780919551849365, decouple_loss:0.026974165812134743
Iteration: 1060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525870382785797, gen p mean: 0.0, mean p set: 0.44950512051582336
The modified gen p mean: 0.4520267844200134, gen p mean: 0.0, mean p set: 0.4498105049133301
The modified gen p mean: 0.4540982246398926, gen p mean: 0.0, mean p set: 0.4506722390651703
loss_pred:0.03338734060525894, decouple_loss:0.02607581950724125
loss_pred:0.03369579836726189, decouple_loss:0.027012167498469353
loss_pred:0.03388063609600067, decouple_loss:0.026634590700268745
2023-05-02 21:28:33 testing...
The modified gen p mean: 0.4556012749671936, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.46430206298828125, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.46184805035591125, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.034504882991313934, decouple_loss:0.027576254680752754
loss_pred:0.03282060846686363, decouple_loss:0.02715103141963482
loss_pred:0.03368576988577843, decouple_loss:0.02626778557896614
WV_0_PC_0_EH_0_PS_40_6, loss: 0.035020336508750916, avg_mse: 0.03751187399029732
current test mse: 0.037512
Iteration: 1061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45692846179008484, gen p mean: 0.0, mean p set: 0.4485096037387848
The modified gen p mean: 0.4612703025341034, gen p mean: 0.0, mean p set: 0.4473493695259094
loss_pred:0.033555060625076294, decouple_loss:0.028486886993050575
loss_pred:0.03307802602648735, decouple_loss:0.02661524899303913
The modified gen p mean: 0.45787912607192993, gen p mean: 0.0, mean p set: 0.44749414920806885
loss_pred:0.03365067392587662, decouple_loss:0.029148027300834656
Iteration: 1062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703710079193115, gen p mean: 0.0, mean p set: 0.44741132855415344
The modified gen p mean: 0.45402926206588745, gen p mean: 0.0, mean p set: 0.4478890001773834
The modified gen p mean: 0.4469839334487915, gen p mean: 0.0, mean p set: 0.44880014657974243
loss_pred:0.0335962176322937, decouple_loss:0.02882024273276329
loss_pred:0.03366941958665848, decouple_loss:0.027332507073879242
loss_pred:0.032217029482126236, decouple_loss:0.025125578045845032
Iteration: 1063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4251309931278229, gen p mean: 0.0, mean p set: 0.4481406807899475
The modified gen p mean: 0.42800286412239075, gen p mean: 0.0, mean p set: 0.449078768491745
The modified gen p mean: 0.4308571219444275, gen p mean: 0.0, mean p set: 0.44753846526145935
loss_pred:0.03342464193701744, decouple_loss:0.02765304036438465
loss_pred:0.03339763358235359, decouple_loss:0.02619212307035923
loss_pred:0.03338431194424629, decouple_loss:0.026336289942264557
Iteration: 1064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4580325782299042, gen p mean: 0.0, mean p set: 0.4487580358982086
The modified gen p mean: 0.45957431197166443, gen p mean: 0.0, mean p set: 0.4495809078216553
The modified gen p mean: 0.4610903561115265, gen p mean: 0.0, mean p set: 0.4466628134250641
loss_pred:0.03250473365187645, decouple_loss:0.02589254453778267
loss_pred:0.033798038959503174, decouple_loss:0.02558162808418274
loss_pred:0.03385075554251671, decouple_loss:0.025093281641602516
Iteration: 1065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4569436311721802, gen p mean: 0.0, mean p set: 0.44906049966812134
The modified gen p mean: 0.4557276666164398, gen p mean: 0.0, mean p set: 0.4481384754180908
The modified gen p mean: 0.44810202717781067, gen p mean: 0.0, mean p set: 0.4487130343914032
loss_pred:0.032995857298374176, decouple_loss:0.026083283126354218
loss_pred:0.032392192631959915, decouple_loss:0.025818008929491043
loss_pred:0.032622117549180984, decouple_loss:0.027297992259263992
Iteration: 1066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43735218048095703, gen p mean: 0.0, mean p set: 0.44969815015792847
The modified gen p mean: 0.4346250593662262, gen p mean: 0.0, mean p set: 0.4493766129016876
The modified gen p mean: 0.438400000333786, gen p mean: 0.0, mean p set: 0.4469376802444458
loss_pred:0.03388113155961037, decouple_loss:0.025126690044999123
loss_pred:0.03463228419423103, decouple_loss:0.026014957576990128
loss_pred:0.034363653510808945, decouple_loss:0.025638267397880554
Iteration: 1067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4562967121601105, gen p mean: 0.0, mean p set: 0.44709157943725586
The modified gen p mean: 0.4559907019138336, gen p mean: 0.0, mean p set: 0.4476757347583771
The modified gen p mean: 0.45913687348365784, gen p mean: 0.0, mean p set: 0.44842419028282166
loss_pred:0.032783329486846924, decouple_loss:0.025470808148384094
loss_pred:0.03270549327135086, decouple_loss:0.025834139436483383
loss_pred:0.03274322673678398, decouple_loss:0.026403050869703293
Iteration: 1068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528155028820038, gen p mean: 0.0, mean p set: 0.4496791362762451
The modified gen p mean: 0.4596865177154541, gen p mean: 0.0, mean p set: 0.44841745495796204
The modified gen p mean: 0.44692263007164, gen p mean: 0.0, mean p set: 0.4493577182292938
loss_pred:0.03333965316414833, decouple_loss:0.025740889832377434
loss_pred:0.03258524090051651, decouple_loss:0.026547769084572792
loss_pred:0.032088518142700195, decouple_loss:0.026360943913459778
Iteration: 1069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43768683075904846, gen p mean: 0.0, mean p set: 0.44823670387268066
The modified gen p mean: 0.4335990250110626, gen p mean: 0.0, mean p set: 0.4493320882320404
The modified gen p mean: 0.4375089704990387, gen p mean: 0.0, mean p set: 0.44976967573165894
loss_pred:0.03272503241896629, decouple_loss:0.02657472714781761
loss_pred:0.03406479209661484, decouple_loss:0.027235761284828186
loss_pred:0.03300207853317261, decouple_loss:0.025083431974053383
Iteration: 1070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44434818625450134, gen p mean: 0.0, mean p set: 0.44878509640693665
The modified gen p mean: 0.4478186368942261, gen p mean: 0.0, mean p set: 0.44786572456359863
The modified gen p mean: 0.4476827085018158, gen p mean: 0.0, mean p set: 0.44741183519363403
loss_pred:0.03311653807759285, decouple_loss:0.027781570330262184
loss_pred:0.03203967213630676, decouple_loss:0.026191767305135727
loss_pred:0.032041970640420914, decouple_loss:0.02561534382402897
2023-05-02 21:32:17 testing...
The modified gen p mean: 0.46382224559783936, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4574524462223053, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.46664291620254517, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.033466897904872894, decouple_loss:0.026030153036117554
loss_pred:0.03444511070847511, decouple_loss:0.026931440457701683
loss_pred:0.03279101103544235, decouple_loss:0.02686665765941143
WV_0_PC_0_EH_0_PS_40_6, loss: 0.034898143261671066, avg_mse: 0.03736930713057518
current test mse: 0.037369
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
NaN value num: 0
Iteration: 1071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4640979766845703, gen p mean: 0.0, mean p set: 0.45015794038772583
The modified gen p mean: 0.464968740940094, gen p mean: 0.0, mean p set: 0.44856053590774536
loss_pred:0.034208010882139206, decouple_loss:0.028644168749451637
loss_pred:0.03578389436006546, decouple_loss:0.028719792142510414
The modified gen p mean: 0.46313849091529846, gen p mean: 0.0, mean p set: 0.44904032349586487
loss_pred:0.03453649580478668, decouple_loss:0.02842637151479721
Iteration: 1072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683319330215454, gen p mean: 0.0, mean p set: 0.45104163885116577
The modified gen p mean: 0.4442353844642639, gen p mean: 0.0, mean p set: 0.45020779967308044
The modified gen p mean: 0.4469599723815918, gen p mean: 0.0, mean p set: 0.4493427276611328
loss_pred:0.03419435769319534, decouple_loss:0.029498262330889702
loss_pred:0.034254156053066254, decouple_loss:0.02941141650080681
loss_pred:0.03479863703250885, decouple_loss:0.028057748451828957
Iteration: 1073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4385434091091156, gen p mean: 0.0, mean p set: 0.44900277256965637
The modified gen p mean: 0.44110652804374695, gen p mean: 0.0, mean p set: 0.45245006680488586
The modified gen p mean: 0.4399571120738983, gen p mean: 0.0, mean p set: 0.45030441880226135
loss_pred:0.03512110561132431, decouple_loss:0.02728119306266308
loss_pred:0.03240659460425377, decouple_loss:0.028774859383702278
loss_pred:0.0334312841296196, decouple_loss:0.02755676582455635
Iteration: 1074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4573586583137512, gen p mean: 0.0, mean p set: 0.4508368670940399
The modified gen p mean: 0.4514980912208557, gen p mean: 0.0, mean p set: 0.45119625329971313
The modified gen p mean: 0.45292800664901733, gen p mean: 0.0, mean p set: 0.4486609697341919
loss_pred:0.03335399180650711, decouple_loss:0.028560200706124306
loss_pred:0.034178897738456726, decouple_loss:0.028610873967409134
loss_pred:0.034339528530836105, decouple_loss:0.028036780655384064
Iteration: 1075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45771512389183044, gen p mean: 0.0, mean p set: 0.45253270864486694
The modified gen p mean: 0.459305077791214, gen p mean: 0.0, mean p set: 0.4537888467311859
The modified gen p mean: 0.45620182156562805, gen p mean: 0.0, mean p set: 0.4498375654220581
loss_pred:0.033096861094236374, decouple_loss:0.028045307844877243
loss_pred:0.03242172300815582, decouple_loss:0.027744244784116745
loss_pred:0.03333375230431557, decouple_loss:0.026859888806939125
Iteration: 1076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44610902667045593, gen p mean: 0.0, mean p set: 0.4498651623725891
The modified gen p mean: 0.44796881079673767, gen p mean: 0.0, mean p set: 0.4503653943538666
The modified gen p mean: 0.45120173692703247, gen p mean: 0.0, mean p set: 0.449828565120697
loss_pred:0.034709904342889786, decouple_loss:0.0260247141122818
loss_pred:0.03432989865541458, decouple_loss:0.02763744443655014
loss_pred:0.034442730247974396, decouple_loss:0.02716243453323841
Iteration: 1077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4562010169029236, gen p mean: 0.0, mean p set: 0.45331335067749023
The modified gen p mean: 0.455181747674942, gen p mean: 0.0, mean p set: 0.4534335732460022
The modified gen p mean: 0.4564363360404968, gen p mean: 0.0, mean p set: 0.4509235620498657
loss_pred:0.03169292211532593, decouple_loss:0.02879905328154564
loss_pred:0.032098930329084396, decouple_loss:0.02788466587662697
loss_pred:0.03396869823336601, decouple_loss:0.026958556845784187
Iteration: 1078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4424988627433777, gen p mean: 0.0, mean p set: 0.4530760943889618
The modified gen p mean: 0.44419944286346436, gen p mean: 0.0, mean p set: 0.45097532868385315
The modified gen p mean: 0.4456409513950348, gen p mean: 0.0, mean p set: 0.4511338472366333
loss_pred:0.03147415071725845, decouple_loss:0.028163669630885124
loss_pred:0.033484023064374924, decouple_loss:0.0271032452583313
loss_pred:0.0323922373354435, decouple_loss:0.02679009921848774
Iteration: 1079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4416843354701996, gen p mean: 0.0, mean p set: 0.4495201110839844
The modified gen p mean: 0.4393270015716553, gen p mean: 0.0, mean p set: 0.4492030143737793
The modified gen p mean: 0.43981826305389404, gen p mean: 0.0, mean p set: 0.450665146112442
loss_pred:0.03334985300898552, decouple_loss:0.027256963774561882
loss_pred:0.035088177770376205, decouple_loss:0.028502125293016434
loss_pred:0.033306363970041275, decouple_loss:0.02646208181977272
Iteration: 1080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46841782331466675, gen p mean: 0.0, mean p set: 0.44980570673942566
The modified gen p mean: 0.4734163284301758, gen p mean: 0.0, mean p set: 0.45323646068573
The modified gen p mean: 0.4740792214870453, gen p mean: 0.0, mean p set: 0.4507652819156647
loss_pred:0.03285816311836243, decouple_loss:0.027260595932602882
loss_pred:0.03237614780664444, decouple_loss:0.026741186156868935
loss_pred:0.03368062525987625, decouple_loss:0.027438750490546227
2023-05-02 21:36:38 testing...
The modified gen p mean: 0.4377909302711487, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44661402702331543, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4442225396633148, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.034885432571172714, decouple_loss:0.02902096137404442
loss_pred:0.03293435648083687, decouple_loss:0.028769932687282562
loss_pred:0.03384261950850487, decouple_loss:0.02821453846991062
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03532089293003082, avg_mse: 0.0380144938826561
current test mse: 0.038014
Iteration: 1081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455077052116394, gen p mean: 0.0, mean p set: 0.45089974999427795
The modified gen p mean: 0.44441860914230347, gen p mean: 0.0, mean p set: 0.4529707729816437
loss_pred:0.032514072954654694, decouple_loss:0.026298582553863525
loss_pred:0.03277146443724632, decouple_loss:0.027323035523295403
The modified gen p mean: 0.44533655047416687, gen p mean: 0.0, mean p set: 0.4514155089855194
loss_pred:0.032379504293203354, decouple_loss:0.02655794844031334
Iteration: 1082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4408796429634094, gen p mean: 0.0, mean p set: 0.4500502049922943
The modified gen p mean: 0.4368788003921509, gen p mean: 0.0, mean p set: 0.4499734938144684
The modified gen p mean: 0.4347425103187561, gen p mean: 0.0, mean p set: 0.4503386318683624
loss_pred:0.033688854426145554, decouple_loss:0.026298079639673233
loss_pred:0.034872207790613174, decouple_loss:0.026528192684054375
loss_pred:0.033989131450653076, decouple_loss:0.026940882205963135
Iteration: 1083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4621937572956085, gen p mean: 0.0, mean p set: 0.45236724615097046
The modified gen p mean: 0.4623144268989563, gen p mean: 0.0, mean p set: 0.45061448216438293
The modified gen p mean: 0.46107617020606995, gen p mean: 0.0, mean p set: 0.4495016634464264
loss_pred:0.032935142517089844, decouple_loss:0.027225520461797714
loss_pred:0.03278918191790581, decouple_loss:0.02614886872470379
loss_pred:0.03529911860823631, decouple_loss:0.027827681973576546
Iteration: 1084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922250509262085, gen p mean: 0.0, mean p set: 0.45092687010765076
The modified gen p mean: 0.4506368637084961, gen p mean: 0.0, mean p set: 0.4498754143714905
The modified gen p mean: 0.45025038719177246, gen p mean: 0.0, mean p set: 0.45337799191474915
loss_pred:0.0323423333466053, decouple_loss:0.02606227435171604
loss_pred:0.03439035639166832, decouple_loss:0.025598283857107162
loss_pred:0.03169368579983711, decouple_loss:0.02630748227238655
Iteration: 1085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.436026006937027, gen p mean: 0.0, mean p set: 0.4507328271865845
The modified gen p mean: 0.43601441383361816, gen p mean: 0.0, mean p set: 0.45144200325012207
The modified gen p mean: 0.43749964237213135, gen p mean: 0.0, mean p set: 0.45245808362960815
loss_pred:0.03287997469305992, decouple_loss:0.02591542713344097
loss_pred:0.03326400741934776, decouple_loss:0.025308072566986084
loss_pred:0.031185412779450417, decouple_loss:0.02734490856528282
Iteration: 1086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4552631378173828, gen p mean: 0.0, mean p set: 0.45037373900413513
The modified gen p mean: 0.45930320024490356, gen p mean: 0.0, mean p set: 0.45299485325813293
The modified gen p mean: 0.4561923146247864, gen p mean: 0.0, mean p set: 0.45151469111442566
loss_pred:0.0325363390147686, decouple_loss:0.02546040527522564
loss_pred:0.03284075856208801, decouple_loss:0.026736488565802574
loss_pred:0.033688321709632874, decouple_loss:0.026622461155056953
Iteration: 1087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4606114625930786, gen p mean: 0.0, mean p set: 0.4488401710987091
The modified gen p mean: 0.4626505672931671, gen p mean: 0.0, mean p set: 0.4504478871822357
The modified gen p mean: 0.46799227595329285, gen p mean: 0.0, mean p set: 0.4500739574432373
loss_pred:0.03366515785455704, decouple_loss:0.026436371728777885
loss_pred:0.03470919281244278, decouple_loss:0.02621356025338173
loss_pred:0.03339197114109993, decouple_loss:0.02527361735701561
Iteration: 1088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481847286224365, gen p mean: 0.0, mean p set: 0.4504922032356262
The modified gen p mean: 0.442862331867218, gen p mean: 0.0, mean p set: 0.45134952664375305
The modified gen p mean: 0.44720056653022766, gen p mean: 0.0, mean p set: 0.4505384862422943
loss_pred:0.0331517830491066, decouple_loss:0.025281649082899094
loss_pred:0.03497793525457382, decouple_loss:0.026180103421211243
loss_pred:0.032746728509664536, decouple_loss:0.025697801262140274
Iteration: 1089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867244362831116, gen p mean: 0.0, mean p set: 0.4515804052352905
The modified gen p mean: 0.44380873441696167, gen p mean: 0.0, mean p set: 0.45149579644203186
The modified gen p mean: 0.44454288482666016, gen p mean: 0.0, mean p set: 0.4490624964237213
loss_pred:0.032405171543359756, decouple_loss:0.02534918487071991
loss_pred:0.03316071256995201, decouple_loss:0.02580755017697811
loss_pred:0.0337003618478775, decouple_loss:0.027063453570008278
Iteration: 1090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44667908549308777, gen p mean: 0.0, mean p set: 0.45003804564476013
The modified gen p mean: 0.4559277594089508, gen p mean: 0.0, mean p set: 0.4505557417869568
The modified gen p mean: 0.44839656352996826, gen p mean: 0.0, mean p set: 0.45144885778427124
loss_pred:0.03280913457274437, decouple_loss:0.026520270854234695
loss_pred:0.03325016796588898, decouple_loss:0.025122247636318207
loss_pred:0.03405454009771347, decouple_loss:0.025938451290130615
2023-05-02 21:40:20 testing...
The modified gen p mean: 0.44150984287261963, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4475511908531189, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4501742422580719, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.034563787281513214, decouple_loss:0.02795318327844143
loss_pred:0.03365955129265785, decouple_loss:0.027126947417855263
loss_pred:0.03292824327945709, decouple_loss:0.027675306424498558
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03509645164012909, avg_mse: 0.03781326115131378
current test mse: 0.037813
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 1091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476900100708008, gen p mean: 0.0, mean p set: 0.44727250933647156
The modified gen p mean: 0.4458397626876831, gen p mean: 0.0, mean p set: 0.4483039677143097
loss_pred:0.03393138200044632, decouple_loss:0.02701600268483162
loss_pred:0.032192230224609375, decouple_loss:0.02792847342789173
The modified gen p mean: 0.4450397491455078, gen p mean: 0.0, mean p set: 0.4473881721496582
loss_pred:0.034808214753866196, decouple_loss:0.027590487152338028
Iteration: 1092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764792919158936, gen p mean: 0.0, mean p set: 0.44937047362327576
The modified gen p mean: 0.4463922679424286, gen p mean: 0.0, mean p set: 0.4476828873157501
The modified gen p mean: 0.45296749472618103, gen p mean: 0.0, mean p set: 0.44917070865631104
loss_pred:0.03559030592441559, decouple_loss:0.028340045362710953
loss_pred:0.03323773294687271, decouple_loss:0.02614324539899826
loss_pred:0.03505396097898483, decouple_loss:0.028476109728217125
Iteration: 1093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4592892825603485, gen p mean: 0.0, mean p set: 0.4474402070045471
The modified gen p mean: 0.4581149220466614, gen p mean: 0.0, mean p set: 0.4482652246952057
The modified gen p mean: 0.4586462676525116, gen p mean: 0.0, mean p set: 0.44813501834869385
loss_pred:0.033862143754959106, decouple_loss:0.02726163901388645
loss_pred:0.034607984125614166, decouple_loss:0.0268783550709486
loss_pred:0.0344022735953331, decouple_loss:0.027248529717326164
Iteration: 1094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4437411427497864, gen p mean: 0.0, mean p set: 0.44778600335121155
The modified gen p mean: 0.4489893317222595, gen p mean: 0.0, mean p set: 0.4480895698070526
The modified gen p mean: 0.44397592544555664, gen p mean: 0.0, mean p set: 0.4479547441005707
loss_pred:0.03414032608270645, decouple_loss:0.02613985911011696
loss_pred:0.03347146883606911, decouple_loss:0.025963284075260162
loss_pred:0.032862115651369095, decouple_loss:0.026188094168901443
Iteration: 1095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43828868865966797, gen p mean: 0.0, mean p set: 0.44860079884529114The modified gen p mean: 0.4351910650730133, gen p mean: 0.0, mean p set: 0.44780340790748596
The modified gen p mean: 0.43823131918907166, gen p mean: 0.0, mean p set: 0.44789940118789673
loss_pred:0.03377028927206993, decouple_loss:0.026368439197540283loss_pred:0.034675806760787964, decouple_loss:0.02621758170425892
loss_pred:0.03489287197589874, decouple_loss:0.027209097519516945
Iteration: 1096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45217496156692505, gen p mean: 0.0, mean p set: 0.44913291931152344
The modified gen p mean: 0.4532051384449005, gen p mean: 0.0, mean p set: 0.4483788311481476
The modified gen p mean: 0.4529746472835541, gen p mean: 0.0, mean p set: 0.4481982886791229
loss_pred:0.034850120544433594, decouple_loss:0.027334408834576607
loss_pred:0.034174513071775436, decouple_loss:0.02605210430920124
loss_pred:0.032772261649370193, decouple_loss:0.025534944608807564
Iteration: 1097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4561092257499695, gen p mean: 0.0, mean p set: 0.44645851850509644
The modified gen p mean: 0.4506264925003052, gen p mean: 0.0, mean p set: 0.44821637868881226
The modified gen p mean: 0.4516403377056122, gen p mean: 0.0, mean p set: 0.44791606068611145
loss_pred:0.033444397151470184, decouple_loss:0.02582978829741478
loss_pred:0.034270089119672775, decouple_loss:0.02583625353872776
loss_pred:0.03470177203416824, decouple_loss:0.026314323768019676
Iteration: 1098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4417850077152252, gen p mean: 0.0, mean p set: 0.4479711353778839
The modified gen p mean: 0.44400110840797424, gen p mean: 0.0, mean p set: 0.4468632936477661
The modified gen p mean: 0.43856745958328247, gen p mean: 0.0, mean p set: 0.44838836789131165
loss_pred:0.033729199320077896, decouple_loss:0.027112746611237526
loss_pred:0.03290007635951042, decouple_loss:0.026499079540371895
loss_pred:0.03252171725034714, decouple_loss:0.027050277218222618
Iteration: 1099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450058341026306, gen p mean: 0.0, mean p set: 0.4479212760925293
The modified gen p mean: 0.4492546021938324, gen p mean: 0.0, mean p set: 0.44860121607780457
The modified gen p mean: 0.4523108899593353, gen p mean: 0.0, mean p set: 0.4475173056125641
loss_pred:0.032704681158065796, decouple_loss:0.026677245274186134
loss_pred:0.03199850395321846, decouple_loss:0.025936603546142578
loss_pred:0.03376946225762367, decouple_loss:0.026708338409662247
Iteration: 1100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45064106583595276, gen p mean: 0.0, mean p set: 0.4474206268787384
The modified gen p mean: 0.45679715275764465, gen p mean: 0.0, mean p set: 0.4461096227169037
The modified gen p mean: 0.4570952355861664, gen p mean: 0.0, mean p set: 0.44676437973976135
loss_pred:0.033574435859918594, decouple_loss:0.026824908331036568
loss_pred:0.033880386501550674, decouple_loss:0.026267120614647865
loss_pred:0.03368021175265312, decouple_loss:0.02654835768043995
2023-05-02 21:44:41 testing...
The modified gen p mean: 0.4328759014606476, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44251376390457153, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4391058683395386, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.034365519881248474, decouple_loss:0.02702978439629078
loss_pred:0.032576337456703186, decouple_loss:0.02658180706202984
loss_pred:0.03343932330608368, decouple_loss:0.026261551305651665
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03479161486029625, avg_mse: 0.037469279021024704
current test mse: 0.037469
Iteration: 1101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4412496089935303, gen p mean: 0.0, mean p set: 0.4484962224960327
The modified gen p mean: 0.4404693841934204, gen p mean: 0.0, mean p set: 0.4477671980857849
loss_pred:0.03431878983974457, decouple_loss:0.026889877393841743
loss_pred:0.033331748098134995, decouple_loss:0.025330469012260437
The modified gen p mean: 0.43902236223220825, gen p mean: 0.0, mean p set: 0.4477144777774811
loss_pred:0.033204276114702225, decouple_loss:0.025768062099814415
Iteration: 1102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493756592273712, gen p mean: 0.0, mean p set: 0.44837847352027893
The modified gen p mean: 0.44243714213371277, gen p mean: 0.0, mean p set: 0.44886934757232666
The modified gen p mean: 0.44441285729408264, gen p mean: 0.0, mean p set: 0.4486541748046875
loss_pred:0.032535750418901443, decouple_loss:0.025225449353456497
loss_pred:0.03400923311710358, decouple_loss:0.026560230180621147
loss_pred:0.03490729629993439, decouple_loss:0.026916127651929855
Iteration: 1103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.457110196352005, gen p mean: 0.0, mean p set: 0.4480327069759369
The modified gen p mean: 0.4546355605125427, gen p mean: 0.0, mean p set: 0.4482133686542511
The modified gen p mean: 0.4518128037452698, gen p mean: 0.0, mean p set: 0.4479072690010071
loss_pred:0.03344545513391495, decouple_loss:0.024588648229837418
loss_pred:0.033118776977062225, decouple_loss:0.024835586547851562
loss_pred:0.034308210015296936, decouple_loss:0.02556977979838848
Iteration: 1104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43964001536369324, gen p mean: 0.0, mean p set: 0.44852009415626526The modified gen p mean: 0.4470139741897583, gen p mean: 0.0, mean p set: 0.4475003480911255
The modified gen p mean: 0.4473588168621063, gen p mean: 0.0, mean p set: 0.4481835961341858
loss_pred:0.033711906522512436, decouple_loss:0.026339329779148102loss_pred:0.03286924585700035, decouple_loss:0.025001946836709976
loss_pred:0.03392843157052994, decouple_loss:0.02508835680782795
Iteration: 1105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44618910551071167, gen p mean: 0.0, mean p set: 0.44862261414527893
The modified gen p mean: 0.4467456340789795, gen p mean: 0.0, mean p set: 0.4481063485145569
The modified gen p mean: 0.4455392062664032, gen p mean: 0.0, mean p set: 0.4476650059223175
loss_pred:0.03230013698339462, decouple_loss:0.025236522778868675
loss_pred:0.03415825217962265, decouple_loss:0.026578523218631744
loss_pred:0.033569250255823135, decouple_loss:0.025938548147678375
Iteration: 1106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4617830812931061, gen p mean: 0.0, mean p set: 0.4481825828552246
The modified gen p mean: 0.45879441499710083, gen p mean: 0.0, mean p set: 0.44800058007240295
The modified gen p mean: 0.46012362837791443, gen p mean: 0.0, mean p set: 0.4491216838359833
loss_pred:0.03282754868268967, decouple_loss:0.02434638887643814
loss_pred:0.03183438256382942, decouple_loss:0.024739153683185577
loss_pred:0.033946700394153595, decouple_loss:0.02575785294175148
Iteration: 1107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473121464252472, gen p mean: 0.0, mean p set: 0.4470282196998596
The modified gen p mean: 0.44909077882766724, gen p mean: 0.0, mean p set: 0.44817450642585754
The modified gen p mean: 0.4465200901031494, gen p mean: 0.0, mean p set: 0.4491502642631531
loss_pred:0.032689645886421204, decouple_loss:0.025277312844991684
loss_pred:0.03375685214996338, decouple_loss:0.025486072525382042
loss_pred:0.03482712432742119, decouple_loss:0.02644312009215355
Iteration: 1108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4355012774467468, gen p mean: 0.0, mean p set: 0.448940247297287
The modified gen p mean: 0.44139471650123596, gen p mean: 0.0, mean p set: 0.44695839285850525
The modified gen p mean: 0.4420092701911926, gen p mean: 0.0, mean p set: 0.4483005702495575
loss_pred:0.03419632092118263, decouple_loss:0.025403430685400963
loss_pred:0.033281341195106506, decouple_loss:0.023889990523457527
loss_pred:0.03376154229044914, decouple_loss:0.024453964084386826
Iteration: 1109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44551944732666016, gen p mean: 0.0, mean p set: 0.44897761940956116
The modified gen p mean: 0.4477323293685913, gen p mean: 0.0, mean p set: 0.4472596049308777
The modified gen p mean: 0.44543856382369995, gen p mean: 0.0, mean p set: 0.4477669298648834
loss_pred:0.03274441137909889, decouple_loss:0.024838902056217194
loss_pred:0.03321802243590355, decouple_loss:0.02393551915884018
loss_pred:0.03274217247962952, decouple_loss:0.02472848631441593
Iteration: 1110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4578894376754761, gen p mean: 0.0, mean p set: 0.4473342299461365
The modified gen p mean: 0.4595339596271515, gen p mean: 0.0, mean p set: 0.44924822449684143
The modified gen p mean: 0.46245282888412476, gen p mean: 0.0, mean p set: 0.4473542869091034
loss_pred:0.0330548919737339, decouple_loss:0.02512415312230587
loss_pred:0.03382061794400215, decouple_loss:0.025374596938490868
loss_pred:0.0331970676779747, decouple_loss:0.02367580309510231
2023-05-02 21:48:23 testing...
The modified gen p mean: 0.44864827394485474, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4577030837535858, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4547576904296875, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03397519513964653, decouple_loss:0.025799578055739403
loss_pred:0.03240055963397026, decouple_loss:0.025035684928297997
loss_pred:0.033152107149362564, decouple_loss:0.024468660354614258
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03443101793527603, avg_mse: 0.037116244435310364
current test mse: 0.037116
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 1111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4553253948688507, gen p mean: 0.0, mean p set: 0.44843021035194397
loss_pred:0.03294171020388603, decouple_loss:0.026337994262576103
The modified gen p mean: 0.4514370560646057, gen p mean: 0.0, mean p set: 0.4476796090602875
loss_pred:0.03350461274385452, decouple_loss:0.026274241507053375
The modified gen p mean: 0.45055273175239563, gen p mean: 0.0, mean p set: 0.448775053024292
loss_pred:0.03471020981669426, decouple_loss:0.02625092677772045
Iteration: 1112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44149264693260193, gen p mean: 0.0, mean p set: 0.4483139216899872
The modified gen p mean: 0.4392186403274536, gen p mean: 0.0, mean p set: 0.44797900319099426
The modified gen p mean: 0.44480469822883606, gen p mean: 0.0, mean p set: 0.44889721274375916
loss_pred:0.033457763493061066, decouple_loss:0.02462691441178322
loss_pred:0.033488113433122635, decouple_loss:0.02563757263123989
loss_pred:0.0323975645005703, decouple_loss:0.026831312105059624
Iteration: 1113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.440817266702652, gen p mean: 0.0, mean p set: 0.44819343090057373
The modified gen p mean: 0.4430987536907196, gen p mean: 0.0, mean p set: 0.44854554533958435
The modified gen p mean: 0.44533491134643555, gen p mean: 0.0, mean p set: 0.4492427408695221
loss_pred:0.033152516931295395, decouple_loss:0.025060206651687622
loss_pred:0.03137834742665291, decouple_loss:0.02605898678302765
loss_pred:0.03316463530063629, decouple_loss:0.024862149730324745
Iteration: 1114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494148790836334, gen p mean: 0.0, mean p set: 0.4483576714992523
The modified gen p mean: 0.45256978273391724, gen p mean: 0.0, mean p set: 0.44854387640953064
The modified gen p mean: 0.4502459466457367, gen p mean: 0.0, mean p set: 0.44810721278190613
loss_pred:0.0335228368639946, decouple_loss:0.02590969018638134
loss_pred:0.032968681305646896, decouple_loss:0.02504292130470276
loss_pred:0.03317316994071007, decouple_loss:0.025628069415688515
Iteration: 1115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134466886520386, gen p mean: 0.0, mean p set: 0.44836533069610596
The modified gen p mean: 0.4539615213871002, gen p mean: 0.0, mean p set: 0.4483332633972168
The modified gen p mean: 0.4588316082954407, gen p mean: 0.0, mean p set: 0.4488312005996704
loss_pred:0.033520255237817764, decouple_loss:0.0255123283714056
loss_pred:0.03300777077674866, decouple_loss:0.02487497590482235
loss_pred:0.032045114785432816, decouple_loss:0.025761501863598824
Iteration: 1116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4440082907676697, gen p mean: 0.0, mean p set: 0.4477587640285492
The modified gen p mean: 0.44093960523605347, gen p mean: 0.0, mean p set: 0.4486139416694641
The modified gen p mean: 0.44087880849838257, gen p mean: 0.0, mean p set: 0.4479837417602539
loss_pred:0.03267120197415352, decouple_loss:0.025176402181386948
loss_pred:0.032913532108068466, decouple_loss:0.02551259659230709
loss_pred:0.033804409205913544, decouple_loss:0.024515610188245773
Iteration: 1117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788894057273865, gen p mean: 0.0, mean p set: 0.4476061165332794
The modified gen p mean: 0.4466095566749573, gen p mean: 0.0, mean p set: 0.4479960799217224
The modified gen p mean: 0.4495844542980194, gen p mean: 0.0, mean p set: 0.4491655230522156
loss_pred:0.03259604051709175, decouple_loss:0.024543752893805504
loss_pred:0.03308055177330971, decouple_loss:0.02439633011817932
loss_pred:0.03265109285712242, decouple_loss:0.024805650115013123
Iteration: 1118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494872987270355, gen p mean: 0.0, mean p set: 0.4482516348361969
The modified gen p mean: 0.4527049958705902, gen p mean: 0.0, mean p set: 0.44826412200927734
The modified gen p mean: 0.45211708545684814, gen p mean: 0.0, mean p set: 0.4481166899204254
loss_pred:0.033927757292985916, decouple_loss:0.02541734278202057
loss_pred:0.03239021822810173, decouple_loss:0.024509815499186516
loss_pred:0.03332223370671272, decouple_loss:0.0240457933396101
Iteration: 1119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702163338661194, gen p mean: 0.0, mean p set: 0.4482753276824951
The modified gen p mean: 0.45579180121421814, gen p mean: 0.0, mean p set: 0.44839832186698914
The modified gen p mean: 0.44963735342025757, gen p mean: 0.0, mean p set: 0.4485490918159485
loss_pred:0.034144263714551926, decouple_loss:0.024868542328476906
loss_pred:0.03192725405097008, decouple_loss:0.02487550489604473
loss_pred:0.03383864834904671, decouple_loss:0.024482611566781998
Iteration: 1120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44472548365592957, gen p mean: 0.0, mean p set: 0.4484822154045105
The modified gen p mean: 0.4415406882762909, gen p mean: 0.0, mean p set: 0.4478999972343445
The modified gen p mean: 0.44280222058296204, gen p mean: 0.0, mean p set: 0.4496433436870575
loss_pred:0.03329278901219368, decouple_loss:0.02532999776303768
loss_pred:0.033144205808639526, decouple_loss:0.024189382791519165
loss_pred:0.03300486132502556, decouple_loss:0.02449931763112545
2023-05-02 21:52:46 testing...
The modified gen p mean: 0.443190336227417, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4497324824333191, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45280125737190247, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.033886928111314774, decouple_loss:0.025911977514624596
loss_pred:0.03306208923459053, decouple_loss:0.02544763684272766loss_pred:0.03232204541563988, decouple_loss:0.02590721845626831
WV_0_PC_0_EH_0_PS_40_6, loss: 0.034378137439489365, avg_mse: 0.037064384669065475
current test mse: 0.037064
Iteration: 1121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44289928674697876, gen p mean: 0.0, mean p set: 0.44859638810157776
loss_pred:0.03400995582342148, decouple_loss:0.02466057613492012
The modified gen p mean: 0.4463043212890625, gen p mean: 0.0, mean p set: 0.44859760999679565
loss_pred:0.034117043018341064, decouple_loss:0.024428047239780426
The modified gen p mean: 0.44311073422431946, gen p mean: 0.0, mean p set: 0.4489077031612396
loss_pred:0.03220413625240326, decouple_loss:0.025626778602600098
Iteration: 1122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45809292793273926, gen p mean: 0.0, mean p set: 0.44904080033302307
The modified gen p mean: 0.45369645953178406, gen p mean: 0.0, mean p set: 0.44802939891815186
The modified gen p mean: 0.45366111397743225, gen p mean: 0.0, mean p set: 0.4485950171947479
loss_pred:0.03112158551812172, decouple_loss:0.025145580992102623
loss_pred:0.03319622203707695, decouple_loss:0.024308141320943832
loss_pred:0.033327341079711914, decouple_loss:0.02417057566344738
Iteration: 1123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4620665907859802, gen p mean: 0.0, mean p set: 0.44859370589256287
The modified gen p mean: 0.45652616024017334, gen p mean: 0.0, mean p set: 0.44792643189430237
The modified gen p mean: 0.45289134979248047, gen p mean: 0.0, mean p set: 0.44828253984451294
loss_pred:0.03335392847657204, decouple_loss:0.025181729346513748
loss_pred:0.03386244550347328, decouple_loss:0.023811308667063713
loss_pred:0.03296211361885071, decouple_loss:0.023269986733794212
Iteration: 1124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4411178529262543, gen p mean: 0.0, mean p set: 0.44819650053977966
The modified gen p mean: 0.4408503770828247, gen p mean: 0.0, mean p set: 0.448341965675354
The modified gen p mean: 0.44210925698280334, gen p mean: 0.0, mean p set: 0.4482157230377197
loss_pred:0.03209470957517624, decouple_loss:0.02447880245745182
loss_pred:0.03345462307333946, decouple_loss:0.023496918380260468
loss_pred:0.03242650628089905, decouple_loss:0.023766085505485535
Iteration: 1125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4401712417602539, gen p mean: 0.0, mean p set: 0.44838589429855347The modified gen p mean: 0.4433583915233612, gen p mean: 0.0, mean p set: 0.44799885153770447
The modified gen p mean: 0.4365132749080658, gen p mean: 0.0, mean p set: 0.44926151633262634
loss_pred:0.03240780532360077, decouple_loss:0.02352399192750454
loss_pred:0.032454416155815125, decouple_loss:0.02336924709379673
loss_pred:0.03230033442378044, decouple_loss:0.02446506917476654
Iteration: 1126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45589950680732727, gen p mean: 0.0, mean p set: 0.4486706554889679
The modified gen p mean: 0.44927623867988586, gen p mean: 0.0, mean p set: 0.44847962260246277
The modified gen p mean: 0.4521802067756653, gen p mean: 0.0, mean p set: 0.44776955246925354
loss_pred:0.03115779161453247, decouple_loss:0.02340339869260788
loss_pred:0.034236397594213486, decouple_loss:0.023232460021972656
loss_pred:0.03242532163858414, decouple_loss:0.02385440655052662
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45663902163505554, gen p mean: 0.0, mean p set: 0.44928398728370667
The modified gen p mean: 0.4582400619983673, gen p mean: 0.0, mean p set: 0.4488089084625244
The modified gen p mean: 0.45237064361572266, gen p mean: 0.0, mean p set: 0.44847777485847473
loss_pred:0.033658336848020554, decouple_loss:0.02366139553487301
loss_pred:0.033540990203619, decouple_loss:0.02382141724228859
loss_pred:0.032211728394031525, decouple_loss:0.02293345518410206
Iteration: 1128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463001787662506, gen p mean: 0.0, mean p set: 0.448201984167099
The modified gen p mean: 0.4495038092136383, gen p mean: 0.0, mean p set: 0.4487065374851227
The modified gen p mean: 0.44767019152641296, gen p mean: 0.0, mean p set: 0.44789719581604004
loss_pred:0.031117524951696396, decouple_loss:0.023228447884321213
loss_pred:0.032036636024713516, decouple_loss:0.023521143943071365
loss_pred:0.03280184045433998, decouple_loss:0.02238517999649048
Iteration: 1129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493439495563507, gen p mean: 0.0, mean p set: 0.44846177101135254
The modified gen p mean: 0.44707125425338745, gen p mean: 0.0, mean p set: 0.44892874360084534
The modified gen p mean: 0.44581782817840576, gen p mean: 0.0, mean p set: 0.44843557476997375
loss_pred:0.032597485929727554, decouple_loss:0.023846663534641266
loss_pred:0.03255319967865944, decouple_loss:0.02377147413790226
loss_pred:0.032981373369693756, decouple_loss:0.023327816277742386
Iteration: 1130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919952750205994, gen p mean: 0.0, mean p set: 0.4480193257331848
The modified gen p mean: 0.44811174273490906, gen p mean: 0.0, mean p set: 0.448095440864563
The modified gen p mean: 0.4487930238246918, gen p mean: 0.0, mean p set: 0.44828298687934875
loss_pred:0.032437510788440704, decouple_loss:0.023245973512530327
loss_pred:0.03131560608744621, decouple_loss:0.022300131618976593
loss_pred:0.03349142149090767, decouple_loss:0.02318171225488186
2023-05-02 21:56:29 testing...
The modified gen p mean: 0.44859176874160767, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44183358550071716, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.451389342546463, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03285973519086838, decouple_loss:0.024101734161376953
loss_pred:0.03373309597373009, decouple_loss:0.024902528151869774
loss_pred:0.03223813325166702, decouple_loss:0.02445991337299347
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0341680571436882, avg_mse: 0.036845315247774124
current test mse: 0.036845
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519042372703552, gen p mean: 0.0, mean p set: 0.44744303822517395
The modified gen p mean: 0.44746410846710205, gen p mean: 0.0, mean p set: 0.446982741355896
loss_pred:0.03499148413538933, decouple_loss:0.02461807057261467
loss_pred:0.034078020602464676, decouple_loss:0.02409115433692932
The modified gen p mean: 0.4503370225429535, gen p mean: 0.0, mean p set: 0.44723621010780334
loss_pred:0.03366902098059654, decouple_loss:0.024595463648438454
Iteration: 1132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4430572986602783, gen p mean: 0.0, mean p set: 0.44695594906806946
The modified gen p mean: 0.44606196880340576, gen p mean: 0.0, mean p set: 0.44613370299339294
The modified gen p mean: 0.44573792815208435, gen p mean: 0.0, mean p set: 0.446174293756485
loss_pred:0.03299263119697571, decouple_loss:0.02567376010119915
loss_pred:0.03258579969406128, decouple_loss:0.025185411795973778
loss_pred:0.034073784947395325, decouple_loss:0.025361062958836555
Iteration: 1133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960731267929077, gen p mean: 0.0, mean p set: 0.4466569721698761The modified gen p mean: 0.44966837763786316, gen p mean: 0.0, mean p set: 0.44611749053001404
The modified gen p mean: 0.4502297043800354, gen p mean: 0.0, mean p set: 0.4475346803665161
loss_pred:0.032477449625730515, decouple_loss:0.02453109249472618loss_pred:0.034993600100278854, decouple_loss:0.02487538382411003
loss_pred:0.03607094660401344, decouple_loss:0.02532612532377243
Iteration: 1134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448635995388031, gen p mean: 0.0, mean p set: 0.44631072878837585
The modified gen p mean: 0.44532814621925354, gen p mean: 0.0, mean p set: 0.44595643877983093
The modified gen p mean: 0.4513819217681885, gen p mean: 0.0, mean p set: 0.446274995803833
loss_pred:0.03277236968278885, decouple_loss:0.023662075400352478
loss_pred:0.03339656442403793, decouple_loss:0.023832978680729866
loss_pred:0.03498251736164093, decouple_loss:0.02462630532681942
Iteration: 1135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43802058696746826, gen p mean: 0.0, mean p set: 0.4468485414981842
The modified gen p mean: 0.44342416524887085, gen p mean: 0.0, mean p set: 0.447003036737442
The modified gen p mean: 0.4420502781867981, gen p mean: 0.0, mean p set: 0.4453986883163452
loss_pred:0.03382577374577522, decouple_loss:0.023362889885902405
loss_pred:0.033462997525930405, decouple_loss:0.023537257686257362
loss_pred:0.035737767815589905, decouple_loss:0.025106804445385933
Iteration: 1136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43865662813186646, gen p mean: 0.0, mean p set: 0.447405070066452
The modified gen p mean: 0.4447680413722992, gen p mean: 0.0, mean p set: 0.44639402627944946
The modified gen p mean: 0.4371074438095093, gen p mean: 0.0, mean p set: 0.44765836000442505
loss_pred:0.033026471734046936, decouple_loss:0.024876680225133896
loss_pred:0.032632071524858475, decouple_loss:0.02390347048640251
loss_pred:0.032759036868810654, decouple_loss:0.02484903298318386
Iteration: 1137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45858338475227356, gen p mean: 0.0, mean p set: 0.44754984974861145
The modified gen p mean: 0.457316130399704, gen p mean: 0.0, mean p set: 0.4468083381652832
The modified gen p mean: 0.4595864713191986, gen p mean: 0.0, mean p set: 0.4459480941295624
loss_pred:0.033495571464300156, decouple_loss:0.024295033887028694
loss_pred:0.033205218613147736, decouple_loss:0.024735530838370323
loss_pred:0.03212837129831314, decouple_loss:0.023830480873584747
Iteration: 1138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475118815898895, gen p mean: 0.0, mean p set: 0.44678211212158203
The modified gen p mean: 0.4485156536102295, gen p mean: 0.0, mean p set: 0.4475449025630951
The modified gen p mean: 0.4473598897457123, gen p mean: 0.0, mean p set: 0.4464392364025116
loss_pred:0.03333976864814758, decouple_loss:0.024022983387112617
loss_pred:0.03434491157531738, decouple_loss:0.024922547861933708
loss_pred:0.03293456882238388, decouple_loss:0.024056805297732353
Iteration: 1139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44453126192092896, gen p mean: 0.0, mean p set: 0.44640541076660156
The modified gen p mean: 0.4418104588985443, gen p mean: 0.0, mean p set: 0.44770827889442444
The modified gen p mean: 0.4454823136329651, gen p mean: 0.0, mean p set: 0.44647544622421265
loss_pred:0.03322763368487358, decouple_loss:0.02334251068532467
loss_pred:0.03477591276168823, decouple_loss:0.02404365874826908
loss_pred:0.035877421498298645, decouple_loss:0.02444516494870186
Iteration: 1140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493134021759033, gen p mean: 0.0, mean p set: 0.44731536507606506
The modified gen p mean: 0.4480559527873993, gen p mean: 0.0, mean p set: 0.4481041729450226
The modified gen p mean: 0.4507629871368408, gen p mean: 0.0, mean p set: 0.4476243555545807
loss_pred:0.034157413989305496, decouple_loss:0.02422686479985714
loss_pred:0.03467324376106262, decouple_loss:0.02427835576236248
loss_pred:0.033074937760829926, decouple_loss:0.02363862469792366
2023-05-02 22:01:06 testing...
The modified gen p mean: 0.4393545985221863, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4493767023086548, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4464239180088043, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.033881109207868576, decouple_loss:0.025058643892407417
loss_pred:0.03221215307712555, decouple_loss:0.025448396801948547
loss_pred:0.03304455429315567, decouple_loss:0.025007274001836777
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03430451080203056, avg_mse: 0.03699520602822304
current test mse: 0.036995
Iteration: 1141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450617730617523, gen p mean: 0.0, mean p set: 0.44707778096199036
The modified gen p mean: 0.44575852155685425, gen p mean: 0.0, mean p set: 0.4463599622249603
loss_pred:0.03366091102361679, decouple_loss:0.02348032221198082
loss_pred:0.03428392857313156, decouple_loss:0.02402356080710888
The modified gen p mean: 0.44728797674179077, gen p mean: 0.0, mean p set: 0.4469238221645355
loss_pred:0.034510012716054916, decouple_loss:0.023908736184239388
Iteration: 1142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43843159079551697, gen p mean: 0.0, mean p set: 0.4476345181465149
The modified gen p mean: 0.438010573387146, gen p mean: 0.0, mean p set: 0.44749611616134644
The modified gen p mean: 0.44470852613449097, gen p mean: 0.0, mean p set: 0.44763532280921936
loss_pred:0.033152803778648376, decouple_loss:0.02418436110019684
loss_pred:0.033270277082920074, decouple_loss:0.024041499942541122
loss_pred:0.034196093678474426, decouple_loss:0.02439623698592186
Iteration: 1143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45838794112205505, gen p mean: 0.0, mean p set: 0.4470106363296509
The modified gen p mean: 0.45573484897613525, gen p mean: 0.0, mean p set: 0.4484444558620453
The modified gen p mean: 0.45722857117652893, gen p mean: 0.0, mean p set: 0.44812965393066406
loss_pred:0.03410010039806366, decouple_loss:0.024414170533418655
loss_pred:0.03504759818315506, decouple_loss:0.02443835511803627
loss_pred:0.03480441868305206, decouple_loss:0.024192024022340775
Iteration: 1144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45609909296035767, gen p mean: 0.0, mean p set: 0.4470359981060028
The modified gen p mean: 0.4545341730117798, gen p mean: 0.0, mean p set: 0.4472745358943939
The modified gen p mean: 0.4603224992752075, gen p mean: 0.0, mean p set: 0.44666188955307007
loss_pred:0.03256677836179733, decouple_loss:0.023296575993299484
loss_pred:0.03313438594341278, decouple_loss:0.024996671825647354
loss_pred:0.033267661929130554, decouple_loss:0.0244777612388134
Iteration: 1145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43793120980262756, gen p mean: 0.0, mean p set: 0.44719311594963074
The modified gen p mean: 0.43816301226615906, gen p mean: 0.0, mean p set: 0.4478660225868225
The modified gen p mean: 0.43601882457733154, gen p mean: 0.0, mean p set: 0.44695156812667847
loss_pred:0.03336390480399132, decouple_loss:0.023614680394530296
loss_pred:0.035341061651706696, decouple_loss:0.024272792041301727
loss_pred:0.03310421109199524, decouple_loss:0.02455197647213936
Iteration: 1146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4413270056247711, gen p mean: 0.0, mean p set: 0.44606199860572815
The modified gen p mean: 0.4408489763736725, gen p mean: 0.0, mean p set: 0.4476405084133148
The modified gen p mean: 0.44593802094459534, gen p mean: 0.0, mean p set: 0.44714006781578064
loss_pred:0.0333595871925354, decouple_loss:0.02414655312895775
loss_pred:0.03329253941774368, decouple_loss:0.02348710037767887
loss_pred:0.033605899661779404, decouple_loss:0.023930193856358528
Iteration: 1147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453123539686203, gen p mean: 0.0, mean p set: 0.4470418095588684
The modified gen p mean: 0.45415806770324707, gen p mean: 0.0, mean p set: 0.44466984272003174
The modified gen p mean: 0.4507472515106201, gen p mean: 0.0, mean p set: 0.44729533791542053
loss_pred:0.03347797691822052, decouple_loss:0.023005835711956024
loss_pred:0.034647807478904724, decouple_loss:0.02525736764073372
loss_pred:0.032955896109342575, decouple_loss:0.0228883046656847
Iteration: 1148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498978853225708, gen p mean: 0.0, mean p set: 0.44604605436325073
The modified gen p mean: 0.4525562524795532, gen p mean: 0.0, mean p set: 0.4470827281475067
The modified gen p mean: 0.4462313950061798, gen p mean: 0.0, mean p set: 0.44773659110069275
loss_pred:0.03315134346485138, decouple_loss:0.02334790676832199loss_pred:0.032401423901319504, decouple_loss:0.022236328572034836
loss_pred:0.03278388828039169, decouple_loss:0.024078739807009697
Iteration: 1149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496059715747833, gen p mean: 0.0, mean p set: 0.4463409185409546
The modified gen p mean: 0.4482114911079407, gen p mean: 0.0, mean p set: 0.4456527829170227
The modified gen p mean: 0.44738805294036865, gen p mean: 0.0, mean p set: 0.44713932275772095
loss_pred:0.032662998884916306, decouple_loss:0.023201188072562218
loss_pred:0.032508037984371185, decouple_loss:0.023278167471289635
loss_pred:0.03369225561618805, decouple_loss:0.022581009194254875
Iteration: 1150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44295722246170044, gen p mean: 0.0, mean p set: 0.44752374291419983
The modified gen p mean: 0.44378194212913513, gen p mean: 0.0, mean p set: 0.4475320279598236
The modified gen p mean: 0.4416264593601227, gen p mean: 0.0, mean p set: 0.4465799629688263
loss_pred:0.03449026122689247, decouple_loss:0.023372497409582138
loss_pred:0.03209134563803673, decouple_loss:0.02292969450354576
loss_pred:0.03274354338645935, decouple_loss:0.023992842063307762
2023-05-02 22:04:49 testing...
The modified gen p mean: 0.44746941328048706, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4567340910434723, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4537743031978607, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.033619433641433716, decouple_loss:0.025029141455888748
loss_pred:0.03195607289671898, decouple_loss:0.02500215359032154
loss_pred:0.03271406143903732, decouple_loss:0.024860266596078873
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03401138633489609, avg_mse: 0.03670473024249077
current test mse: 0.036705
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
NaN value num: 0
Iteration: 1151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4565097391605377, gen p mean: 0.0, mean p set: 0.45039960741996765
loss_pred:0.035467956215143204, decouple_loss:0.028327686712145805
The modified gen p mean: 0.45676732063293457, gen p mean: 0.0, mean p set: 0.45155251026153564
loss_pred:0.034900322556495667, decouple_loss:0.028693564236164093
The modified gen p mean: 0.4612237513065338, gen p mean: 0.0, mean p set: 0.45182281732559204
loss_pred:0.03531789779663086, decouple_loss:0.029294446110725403
Iteration: 1152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45876073837280273, gen p mean: 0.0, mean p set: 0.45269373059272766
The modified gen p mean: 0.4535788595676422, gen p mean: 0.0, mean p set: 0.4511050879955292
The modified gen p mean: 0.45453622937202454, gen p mean: 0.0, mean p set: 0.4522883892059326
loss_pred:0.03515862300992012, decouple_loss:0.028009843081235886
loss_pred:0.0354841910302639, decouple_loss:0.02749960497021675
loss_pred:0.03514675796031952, decouple_loss:0.028801342472434044
Iteration: 1153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42970871925354004, gen p mean: 0.0, mean p set: 0.45157456398010254
The modified gen p mean: 0.4291394352912903, gen p mean: 0.0, mean p set: 0.450769305229187
The modified gen p mean: 0.433485209941864, gen p mean: 0.0, mean p set: 0.4535127878189087
loss_pred:0.03497082740068436, decouple_loss:0.02769438736140728
loss_pred:0.03455197438597679, decouple_loss:0.02762579172849655
loss_pred:0.03592789173126221, decouple_loss:0.02868933230638504
Iteration: 1154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4557883143424988, gen p mean: 0.0, mean p set: 0.45260950922966003
The modified gen p mean: 0.4501003921031952, gen p mean: 0.0, mean p set: 0.4502023756504059
The modified gen p mean: 0.4585048258304596, gen p mean: 0.0, mean p set: 0.4529035687446594
loss_pred:0.03614795580506325, decouple_loss:0.02784215845167637
loss_pred:0.03408077359199524, decouple_loss:0.02629358135163784
loss_pred:0.03594144806265831, decouple_loss:0.0265299454331398
Iteration: 1155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.47139453887939453, gen p mean: 0.0, mean p set: 0.45066869258880615
The modified gen p mean: 0.4755602180957794, gen p mean: 0.0, mean p set: 0.4533001780509949
The modified gen p mean: 0.4736979007720947, gen p mean: 0.0, mean p set: 0.4530024528503418
loss_pred:0.03633483871817589, decouple_loss:0.02657097950577736
loss_pred:0.03603314980864525, decouple_loss:0.027206961065530777
loss_pred:0.0353282205760479, decouple_loss:0.026867089793086052
Iteration: 1156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44519054889678955, gen p mean: 0.0, mean p set: 0.45271924138069153
The modified gen p mean: 0.44464245438575745, gen p mean: 0.0, mean p set: 0.45261165499687195
The modified gen p mean: 0.44927769899368286, gen p mean: 0.0, mean p set: 0.4518618583679199
loss_pred:0.03452862426638603, decouple_loss:0.026082118973135948
loss_pred:0.033002834767103195, decouple_loss:0.02762541174888611
loss_pred:0.0347672663629055, decouple_loss:0.027805587276816368
Iteration: 1157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4418175518512726, gen p mean: 0.0, mean p set: 0.4508230984210968
The modified gen p mean: 0.4405371844768524, gen p mean: 0.0, mean p set: 0.450334757566452
The modified gen p mean: 0.4336772561073303, gen p mean: 0.0, mean p set: 0.45240524411201477
loss_pred:0.03586835786700249, decouple_loss:0.02734266221523285
loss_pred:0.035282425582408905, decouple_loss:0.026435360312461853
loss_pred:0.03526556119322777, decouple_loss:0.027363205328583717
Iteration: 1158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522663950920105, gen p mean: 0.0, mean p set: 0.45307838916778564
The modified gen p mean: 0.46327322721481323, gen p mean: 0.0, mean p set: 0.4496026933193207
The modified gen p mean: 0.46178069710731506, gen p mean: 0.0, mean p set: 0.45274025201797485
loss_pred:0.034895602613687515, decouple_loss:0.026892947033047676
loss_pred:0.035979658365249634, decouple_loss:0.027519812807440758
loss_pred:0.03551613539457321, decouple_loss:0.02715027704834938
Iteration: 1159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4423856735229492, gen p mean: 0.0, mean p set: 0.4508522152900696
The modified gen p mean: 0.4442250430583954, gen p mean: 0.0, mean p set: 0.4520774781703949
The modified gen p mean: 0.4407596290111542, gen p mean: 0.0, mean p set: 0.4516104459762573
loss_pred:0.03513193503022194, decouple_loss:0.026008261367678642
loss_pred:0.034881025552749634, decouple_loss:0.026065630838274956
loss_pred:0.0351065956056118, decouple_loss:0.02550829015672207
Iteration: 1160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464802145957947, gen p mean: 0.0, mean p set: 0.4511813521385193
The modified gen p mean: 0.4493202567100525, gen p mean: 0.0, mean p set: 0.45171743631362915
The modified gen p mean: 0.45162105560302734, gen p mean: 0.0, mean p set: 0.4524257183074951
loss_pred:0.033545948565006256, decouple_loss:0.026118656620383263
loss_pred:0.03491935133934021, decouple_loss:0.026016974821686745
loss_pred:0.03666549175977707, decouple_loss:0.02626110427081585
2023-05-02 22:09:06 testing...
The modified gen p mean: 0.458100289106369, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4642519950866699, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4671080708503723, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03423217684030533, decouple_loss:0.028107954189181328
loss_pred:0.03330077603459358, decouple_loss:0.027413001284003258
loss_pred:0.03269720822572708, decouple_loss:0.027470121160149574
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03479323908686638, avg_mse: 0.03754927217960358
current test mse: 0.037549
Iteration: 1161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46939218044281006, gen p mean: 0.0, mean p set: 0.4514564573764801
The modified gen p mean: 0.47080597281455994, gen p mean: 0.0, mean p set: 0.4525289833545685
loss_pred:0.03496231511235237, decouple_loss:0.02586854062974453
loss_pred:0.03542697802186012, decouple_loss:0.026776282116770744
The modified gen p mean: 0.47146865725517273, gen p mean: 0.0, mean p set: 0.4521689713001251
loss_pred:0.03522473946213722, decouple_loss:0.026505907997488976
Iteration: 1162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.443381667137146, gen p mean: 0.0, mean p set: 0.45032763481140137
The modified gen p mean: 0.4456746280193329, gen p mean: 0.0, mean p set: 0.4531249403953552
The modified gen p mean: 0.4454670548439026, gen p mean: 0.0, mean p set: 0.4529826045036316
loss_pred:0.03517589345574379, decouple_loss:0.02588413842022419
loss_pred:0.0355101078748703, decouple_loss:0.02694297395646572
loss_pred:0.03483879938721657, decouple_loss:0.02568688616156578
Iteration: 1163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4323670268058777, gen p mean: 0.0, mean p set: 0.45284944772720337
The modified gen p mean: 0.4395751357078552, gen p mean: 0.0, mean p set: 0.45202744007110596
The modified gen p mean: 0.4342987537384033, gen p mean: 0.0, mean p set: 0.4520201086997986
loss_pred:0.03534790873527527, decouple_loss:0.026516219601035118
loss_pred:0.035608042031526566, decouple_loss:0.02550191432237625
loss_pred:0.03409041091799736, decouple_loss:0.02595384418964386
Iteration: 1164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46130144596099854, gen p mean: 0.0, mean p set: 0.4535359740257263
The modified gen p mean: 0.4628933370113373, gen p mean: 0.0, mean p set: 0.4535941779613495
The modified gen p mean: 0.46252554655075073, gen p mean: 0.0, mean p set: 0.45278608798980713
loss_pred:0.03557624667882919, decouple_loss:0.02591022476553917
loss_pred:0.03498370572924614, decouple_loss:0.025461915880441666
loss_pred:0.03649531304836273, decouple_loss:0.02566838264465332
Iteration: 1165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4591536223888397, gen p mean: 0.0, mean p set: 0.4517933130264282
The modified gen p mean: 0.4587164521217346, gen p mean: 0.0, mean p set: 0.45064473152160645
The modified gen p mean: 0.4608706533908844, gen p mean: 0.0, mean p set: 0.4503157436847687
loss_pred:0.034487057477235794, decouple_loss:0.025530949234962463
loss_pred:0.03512829542160034, decouple_loss:0.026017460972070694
loss_pred:0.03383352607488632, decouple_loss:0.025104722008109093
Iteration: 1166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4423971474170685, gen p mean: 0.0, mean p set: 0.4503115713596344
The modified gen p mean: 0.44957104325294495, gen p mean: 0.0, mean p set: 0.45255225896835327
The modified gen p mean: 0.4462566673755646, gen p mean: 0.0, mean p set: 0.45227110385894775
loss_pred:0.03417903929948807, decouple_loss:0.025573566555976868
loss_pred:0.0326959528028965, decouple_loss:0.026416918262839317
loss_pred:0.034771230071783066, decouple_loss:0.024903256446123123
Iteration: 1167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4427124559879303, gen p mean: 0.0, mean p set: 0.45111966133117676
The modified gen p mean: 0.44573846459388733, gen p mean: 0.0, mean p set: 0.4521452486515045
The modified gen p mean: 0.4452481269836426, gen p mean: 0.0, mean p set: 0.45321333408355713
loss_pred:0.03418188914656639, decouple_loss:0.025684742256999016
loss_pred:0.034725870937108994, decouple_loss:0.02438448742032051
loss_pred:0.034923914819955826, decouple_loss:0.025821056216955185
Iteration: 1168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4555940628051758, gen p mean: 0.0, mean p set: 0.45385733246803284
The modified gen p mean: 0.4532610774040222, gen p mean: 0.0, mean p set: 0.45158782601356506
The modified gen p mean: 0.4538721442222595, gen p mean: 0.0, mean p set: 0.45284631848335266
loss_pred:0.03551558777689934, decouple_loss:0.024714991450309753
loss_pred:0.03418341279029846, decouple_loss:0.024561842903494835
loss_pred:0.03365310654044151, decouple_loss:0.025351285934448242
Iteration: 1169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494915008544922, gen p mean: 0.0, mean p set: 0.4535471498966217
The modified gen p mean: 0.4548527002334595, gen p mean: 0.0, mean p set: 0.45234790444374084
The modified gen p mean: 0.4582597613334656, gen p mean: 0.0, mean p set: 0.453212171792984
loss_pred:0.03475264832377434, decouple_loss:0.025647025555372238loss_pred:0.03427655249834061, decouple_loss:0.026025166735053062
loss_pred:0.03539307415485382, decouple_loss:0.025163672864437103
Iteration: 1170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45951181650161743, gen p mean: 0.0, mean p set: 0.45210960507392883
The modified gen p mean: 0.4629024863243103, gen p mean: 0.0, mean p set: 0.45243576169013977
The modified gen p mean: 0.4607774615287781, gen p mean: 0.0, mean p set: 0.45288509130477905
loss_pred:0.03236740455031395, decouple_loss:0.02542264200747013
loss_pred:0.03524600341916084, decouple_loss:0.023996565490961075
loss_pred:0.03321931138634682, decouple_loss:0.02496829256415367
2023-05-02 22:12:45 testing...
The modified gen p mean: 0.44449156522750854, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.43802961707115173, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4476190209388733, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.033073265105485916, decouple_loss:0.0268572848290205
loss_pred:0.03394978865981102, decouple_loss:0.027705686166882515
loss_pred:0.03242506459355354, decouple_loss:0.026833705604076385
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03450598567724228, avg_mse: 0.03750667721033096
current test mse: 0.037507
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 1171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44508299231529236, gen p mean: 0.0, mean p set: 0.4471467435359955
The modified gen p mean: 0.44547155499458313, gen p mean: 0.0, mean p set: 0.44807347655296326
loss_pred:0.03260856494307518, decouple_loss:0.027757620438933372
loss_pred:0.032442595809698105, decouple_loss:0.027123214676976204
The modified gen p mean: 0.4472618103027344, gen p mean: 0.0, mean p set: 0.44706007838249207
loss_pred:0.03242120519280434, decouple_loss:0.027109669521450996
Iteration: 1172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42882204055786133, gen p mean: 0.0, mean p set: 0.44709545373916626
The modified gen p mean: 0.43191367387771606, gen p mean: 0.0, mean p set: 0.4471500515937805
The modified gen p mean: 0.4351108968257904, gen p mean: 0.0, mean p set: 0.4469999372959137
loss_pred:0.03193366527557373, decouple_loss:0.027028782293200493
loss_pred:0.03299761563539505, decouple_loss:0.02690533734858036
loss_pred:0.03265993297100067, decouple_loss:0.026861144229769707
Iteration: 1173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529268741607666, gen p mean: 0.0, mean p set: 0.446819543838501
The modified gen p mean: 0.45160970091819763, gen p mean: 0.0, mean p set: 0.446846604347229
The modified gen p mean: 0.4566832482814789, gen p mean: 0.0, mean p set: 0.44704607129096985
loss_pred:0.034093886613845825, decouple_loss:0.026701847091317177
loss_pred:0.03364986181259155, decouple_loss:0.027097167447209358
loss_pred:0.032232195138931274, decouple_loss:0.026669805869460106
Iteration: 1174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4600660502910614, gen p mean: 0.0, mean p set: 0.44659578800201416
The modified gen p mean: 0.45835497975349426, gen p mean: 0.0, mean p set: 0.44658660888671875
The modified gen p mean: 0.4576094448566437, gen p mean: 0.0, mean p set: 0.44729331135749817
loss_pred:0.03264797851443291, decouple_loss:0.026348737999796867
loss_pred:0.033058058470487595, decouple_loss:0.02583177387714386
loss_pred:0.03364183008670807, decouple_loss:0.026209702715277672
Iteration: 1175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457571804523468, gen p mean: 0.0, mean p set: 0.4474572241306305
The modified gen p mean: 0.44112926721572876, gen p mean: 0.0, mean p set: 0.4465794563293457
The modified gen p mean: 0.44297724962234497, gen p mean: 0.0, mean p set: 0.4475364685058594
loss_pred:0.03196296468377113, decouple_loss:0.025098659098148346
loss_pred:0.03301495313644409, decouple_loss:0.025674810633063316
loss_pred:0.03141277655959129, decouple_loss:0.02456013672053814
Iteration: 1176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4377378523349762, gen p mean: 0.0, mean p set: 0.4477333426475525
The modified gen p mean: 0.4318068027496338, gen p mean: 0.0, mean p set: 0.44728177785873413
The modified gen p mean: 0.43801814317703247, gen p mean: 0.0, mean p set: 0.4476316571235657
loss_pred:0.03382720798254013, decouple_loss:0.02530144900083542
loss_pred:0.031982798129320145, decouple_loss:0.02507716976106167
loss_pred:0.033042553812265396, decouple_loss:0.025202520191669464
Iteration: 1177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4553779363632202, gen p mean: 0.0, mean p set: 0.44647684693336487
The modified gen p mean: 0.4582363963127136, gen p mean: 0.0, mean p set: 0.4471038281917572
The modified gen p mean: 0.453414648771286, gen p mean: 0.0, mean p set: 0.44719746708869934
loss_pred:0.0345488078892231, decouple_loss:0.024088939651846886
loss_pred:0.03228631243109703, decouple_loss:0.024095717817544937
loss_pred:0.033540282398462296, decouple_loss:0.024789487943053246
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45568886399269104, gen p mean: 0.0, mean p set: 0.445857435464859
The modified gen p mean: 0.44908758997917175, gen p mean: 0.0, mean p set: 0.44842633605003357
The modified gen p mean: 0.45269036293029785, gen p mean: 0.0, mean p set: 0.447183758020401
loss_pred:0.033634498715400696, decouple_loss:0.02429642528295517
loss_pred:0.0324493832886219, decouple_loss:0.025569239631295204
loss_pred:0.032937441021203995, decouple_loss:0.024182038381695747
Iteration: 1179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43268054723739624, gen p mean: 0.0, mean p set: 0.44727569818496704
The modified gen p mean: 0.42696863412857056, gen p mean: 0.0, mean p set: 0.44748565554618835
The modified gen p mean: 0.4303922951221466, gen p mean: 0.0, mean p set: 0.44653791189193726
loss_pred:0.032504238188266754, decouple_loss:0.025689834728837013
loss_pred:0.03247414901852608, decouple_loss:0.024319874122738838
loss_pred:0.032764650881290436, decouple_loss:0.02473611570894718
Iteration: 1180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485400319099426, gen p mean: 0.0, mean p set: 0.44746461510658264
The modified gen p mean: 0.45163634419441223, gen p mean: 0.0, mean p set: 0.44818106293678284
The modified gen p mean: 0.4470987915992737, gen p mean: 0.0, mean p set: 0.4474301338195801
loss_pred:0.03140121325850487, decouple_loss:0.024478502571582794
loss_pred:0.0322938933968544, decouple_loss:0.025180121883749962
loss_pred:0.03336682915687561, decouple_loss:0.024291273206472397
2023-05-02 22:17:04 testing...
The modified gen p mean: 0.46383482217788696, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4699997007846832, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4729107618331909, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.033644597977399826, decouple_loss:0.02568271942436695
loss_pred:0.03281456604599953, decouple_loss:0.024980619549751282
loss_pred:0.032057199627161026, decouple_loss:0.025676114484667778
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03411111235618591, avg_mse: 0.03678233176469803
current test mse: 0.036782
Iteration: 1181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4685094952583313, gen p mean: 0.0, mean p set: 0.44699564576148987
The modified gen p mean: 0.4704515337944031, gen p mean: 0.0, mean p set: 0.4482450783252716
loss_pred:0.0328039713203907, decouple_loss:0.02461533062160015
loss_pred:0.03179332613945007, decouple_loss:0.024211779236793518
The modified gen p mean: 0.47059541940689087, gen p mean: 0.0, mean p set: 0.44722166657447815
loss_pred:0.03305929899215698, decouple_loss:0.024710027500987053
Iteration: 1182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44363436102867126, gen p mean: 0.0, mean p set: 0.4465474784374237
The modified gen p mean: 0.44055771827697754, gen p mean: 0.0, mean p set: 0.44728413224220276
The modified gen p mean: 0.44323650002479553, gen p mean: 0.0, mean p set: 0.4456845819950104
loss_pred:0.03226121515035629, decouple_loss:0.024454183876514435
loss_pred:0.03163772448897362, decouple_loss:0.024036796763539314
loss_pred:0.032879963517189026, decouple_loss:0.024243127554655075
Iteration: 1183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42353692650794983, gen p mean: 0.0, mean p set: 0.44749704003334045
The modified gen p mean: 0.4213806986808777, gen p mean: 0.0, mean p set: 0.4473608434200287
The modified gen p mean: 0.4258342385292053, gen p mean: 0.0, mean p set: 0.4466037154197693
loss_pred:0.033598437905311584, decouple_loss:0.024332407861948013
loss_pred:0.032795269042253494, decouple_loss:0.0243217796087265
loss_pred:0.03290669620037079, decouple_loss:0.023509446531534195
Iteration: 1184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45328056812286377, gen p mean: 0.0, mean p set: 0.44682133197784424
The modified gen p mean: 0.45742905139923096, gen p mean: 0.0, mean p set: 0.4473183751106262
The modified gen p mean: 0.45842644572257996, gen p mean: 0.0, mean p set: 0.4480440020561218
loss_pred:0.03238130360841751, decouple_loss:0.02416772022843361
loss_pred:0.03214900940656662, decouple_loss:0.023161156103014946
loss_pred:0.031105266883969307, decouple_loss:0.023554744198918343
Iteration: 1185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46673014760017395, gen p mean: 0.0, mean p set: 0.44753265380859375
The modified gen p mean: 0.4590912461280823, gen p mean: 0.0, mean p set: 0.44782721996307373
loss_pred:0.03169572725892067, decouple_loss:0.02359297126531601
The modified gen p mean: 0.46219924092292786, gen p mean: 0.0, mean p set: 0.4470020830631256
loss_pred:0.03145160898566246, decouple_loss:0.023502960801124573
loss_pred:0.03113272786140442, decouple_loss:0.022930912673473358
Iteration: 1186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4356679916381836, gen p mean: 0.0, mean p set: 0.4477251172065735
The modified gen p mean: 0.43946555256843567, gen p mean: 0.0, mean p set: 0.4471670687198639
The modified gen p mean: 0.4364015460014343, gen p mean: 0.0, mean p set: 0.44806838035583496
loss_pred:0.03299820423126221, decouple_loss:0.023179035633802414
loss_pred:0.03210844472050667, decouple_loss:0.023816686123609543
loss_pred:0.031221061944961548, decouple_loss:0.022992415353655815
Iteration: 1187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4406633973121643, gen p mean: 0.0, mean p set: 0.44726231694221497
The modified gen p mean: 0.4434169828891754, gen p mean: 0.0, mean p set: 0.44730156660079956
The modified gen p mean: 0.4430657923221588, gen p mean: 0.0, mean p set: 0.44578808546066284
loss_pred:0.03168536350131035, decouple_loss:0.02305353246629238
loss_pred:0.03206232562661171, decouple_loss:0.022837547585368156
loss_pred:0.032112542539834976, decouple_loss:0.023489952087402344
Iteration: 1188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487074613571167, gen p mean: 0.0, mean p set: 0.4472668468952179
The modified gen p mean: 0.45123958587646484, gen p mean: 0.0, mean p set: 0.44691362977027893
The modified gen p mean: 0.45614930987358093, gen p mean: 0.0, mean p set: 0.44760966300964355
loss_pred:0.031161345541477203, decouple_loss:0.02358309179544449
loss_pred:0.032282017171382904, decouple_loss:0.023683946579694748
loss_pred:0.033230870962142944, decouple_loss:0.022725550457835197
Iteration: 1189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475591480731964, gen p mean: 0.0, mean p set: 0.44680705666542053
The modified gen p mean: 0.4494127333164215, gen p mean: 0.0, mean p set: 0.4473506212234497
The modified gen p mean: 0.44910097122192383, gen p mean: 0.0, mean p set: 0.4489297568798065
loss_pred:0.03255018964409828, decouple_loss:0.02395368367433548
loss_pred:0.032337743788957596, decouple_loss:0.02328290045261383
loss_pred:0.032005827873945236, decouple_loss:0.024184631183743477
Iteration: 1190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43611231446266174, gen p mean: 0.0, mean p set: 0.44691479206085205
The modified gen p mean: 0.4398401975631714, gen p mean: 0.0, mean p set: 0.44565579295158386
The modified gen p mean: 0.43641191720962524, gen p mean: 0.0, mean p set: 0.4461512565612793
loss_pred:0.0322558768093586, decouple_loss:0.02376594953238964loss_pred:0.0317281037569046, decouple_loss:0.02386486530303955
loss_pred:0.03240812197327614, decouple_loss:0.02361251413822174
2023-05-02 22:20:42 testing...
The modified gen p mean: 0.444344699382782, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45058923959732056, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.454061359167099, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.033360064029693604, decouple_loss:0.02526702545583248
loss_pred:0.03246970847249031, decouple_loss:0.024372898042201996
loss_pred:0.03164957836270332, decouple_loss:0.024942586198449135
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03373616188764572, avg_mse: 0.03641052544116974
current test mse: 0.036411
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
NaN value num: 0
Iteration: 1191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489036798477173, gen p mean: 0.0, mean p set: 0.4527163803577423
The modified gen p mean: 0.44628602266311646, gen p mean: 0.0, mean p set: 0.45409834384918213
loss_pred:0.03367237001657486, decouple_loss:0.029428811743855476
loss_pred:0.03223598003387451, decouple_loss:0.02837175875902176
The modified gen p mean: 0.4534505605697632, gen p mean: 0.0, mean p set: 0.4499339163303375
loss_pred:0.03344322741031647, decouple_loss:0.027746811509132385
Iteration: 1192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4692218005657196, gen p mean: 0.0, mean p set: 0.4505026042461395
The modified gen p mean: 0.47059473395347595, gen p mean: 0.0, mean p set: 0.452614963054657
The modified gen p mean: 0.4701288044452667, gen p mean: 0.0, mean p set: 0.45116573572158813
loss_pred:0.03323974832892418, decouple_loss:0.027799945324659348
loss_pred:0.033320967108011246, decouple_loss:0.0296167004853487
loss_pred:0.03348930552601814, decouple_loss:0.028473656624555588
Iteration: 1193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518352150917053, gen p mean: 0.0, mean p set: 0.45079126954078674
The modified gen p mean: 0.44489675760269165, gen p mean: 0.0, mean p set: 0.4539874494075775
The modified gen p mean: 0.4543115496635437, gen p mean: 0.0, mean p set: 0.4517900347709656
loss_pred:0.03246372193098068, decouple_loss:0.02820148505270481
loss_pred:0.031445398926734924, decouple_loss:0.028373897075653076
loss_pred:0.03281184285879135, decouple_loss:0.027946030721068382
Iteration: 1194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43990638852119446, gen p mean: 0.0, mean p set: 0.45102712512016296
The modified gen p mean: 0.4382144808769226, gen p mean: 0.0, mean p set: 0.45110899209976196
The modified gen p mean: 0.4392649233341217, gen p mean: 0.0, mean p set: 0.4508635997772217
loss_pred:0.032875172793865204, decouple_loss:0.02655407041311264
loss_pred:0.03364243358373642, decouple_loss:0.02619394287467003
loss_pred:0.03276580199599266, decouple_loss:0.02626763842999935
Iteration: 1195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520241916179657, gen p mean: 0.0, mean p set: 0.45247623324394226
The modified gen p mean: 0.4520663917064667, gen p mean: 0.0, mean p set: 0.453212171792984
The modified gen p mean: 0.4507185220718384, gen p mean: 0.0, mean p set: 0.4522095024585724
loss_pred:0.03296232223510742, decouple_loss:0.02631491795182228
loss_pred:0.03271620720624924, decouple_loss:0.027480371296405792
loss_pred:0.03327545151114464, decouple_loss:0.026261726394295692
Iteration: 1196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46818357706069946, gen p mean: 0.0, mean p set: 0.4528922438621521
The modified gen p mean: 0.46849891543388367, gen p mean: 0.0, mean p set: 0.4523157775402069
The modified gen p mean: 0.4715384542942047, gen p mean: 0.0, mean p set: 0.450886607170105
loss_pred:0.0325382798910141, decouple_loss:0.025343159213662148
loss_pred:0.033012714236974716, decouple_loss:0.025602934882044792
loss_pred:0.0342579111456871, decouple_loss:0.02598104067146778
Iteration: 1197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740256667137146, gen p mean: 0.0, mean p set: 0.45340198278427124
The modified gen p mean: 0.4506908059120178, gen p mean: 0.0, mean p set: 0.4513225853443146
The modified gen p mean: 0.4530024230480194, gen p mean: 0.0, mean p set: 0.45114725828170776
loss_pred:0.030627744272351265, decouple_loss:0.02678663097321987
loss_pred:0.03194449469447136, decouple_loss:0.02593012899160385
loss_pred:0.032604482024908066, decouple_loss:0.026663096621632576
Iteration: 1198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4337475597858429, gen p mean: 0.0, mean p set: 0.45174357295036316
The modified gen p mean: 0.43846625089645386, gen p mean: 0.0, mean p set: 0.44988977909088135
The modified gen p mean: 0.43476828932762146, gen p mean: 0.0, mean p set: 0.4539388418197632
loss_pred:0.0333007276058197, decouple_loss:0.02538321539759636
loss_pred:0.033479705452919006, decouple_loss:0.026832643896341324
loss_pred:0.03248516470193863, decouple_loss:0.025860220193862915
Iteration: 1199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4610998034477234, gen p mean: 0.0, mean p set: 0.4524938464164734
The modified gen p mean: 0.459091454744339, gen p mean: 0.0, mean p set: 0.45081186294555664
The modified gen p mean: 0.45848774909973145, gen p mean: 0.0, mean p set: 0.4522283971309662
loss_pred:0.032383691519498825, decouple_loss:0.02597757987678051
loss_pred:0.0328235998749733, decouple_loss:0.025758789852261543
loss_pred:0.03139864653348923, decouple_loss:0.025939740240573883
Iteration: 1200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4655230939388275, gen p mean: 0.0, mean p set: 0.4507386088371277
The modified gen p mean: 0.46672797203063965, gen p mean: 0.0, mean p set: 0.45107758045196533
The modified gen p mean: 0.4608911871910095, gen p mean: 0.0, mean p set: 0.4528115391731262
loss_pred:0.032917506992816925, decouple_loss:0.025421973317861557
loss_pred:0.032260119915008545, decouple_loss:0.025896798819303513
loss_pred:0.033087536692619324, decouple_loss:0.02592751570045948
2023-05-02 22:24:57 testing...
The modified gen p mean: 0.4339343309402466, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4397684633731842, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44296807050704956, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.0337890200316906, decouple_loss:0.028186509385704994
loss_pred:0.032720137387514114, decouple_loss:0.027063656598329544
loss_pred:0.032014597207307816, decouple_loss:0.02746957167983055
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03421991690993309, avg_mse: 0.03702331334352493
current test mse: 0.037023
Iteration: 1201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43982693552970886, gen p mean: 0.0, mean p set: 0.4513719379901886
The modified gen p mean: 0.4434376657009125, gen p mean: 0.0, mean p set: 0.45072096586227417
loss_pred:0.032307449728250504, decouple_loss:0.025974109768867493
loss_pred:0.033530402928590775, decouple_loss:0.02573939599096775
The modified gen p mean: 0.44141680002212524, gen p mean: 0.0, mean p set: 0.45013684034347534
loss_pred:0.03320853412151337, decouple_loss:0.02590348944067955
Iteration: 1202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.431051641702652, gen p mean: 0.0, mean p set: 0.45375579595565796
The modified gen p mean: 0.43824294209480286, gen p mean: 0.0, mean p set: 0.45219701528549194
The modified gen p mean: 0.44041740894317627, gen p mean: 0.0, mean p set: 0.45129746198654175
loss_pred:0.03166830539703369, decouple_loss:0.026426786556839943
loss_pred:0.030986804515123367, decouple_loss:0.026593875139951706
loss_pred:0.03360752761363983, decouple_loss:0.02478676848113537
Iteration: 1203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46881675720214844, gen p mean: 0.0, mean p set: 0.4521334171295166
The modified gen p mean: 0.4627259075641632, gen p mean: 0.0, mean p set: 0.4538503587245941
The modified gen p mean: 0.4701880216598511, gen p mean: 0.0, mean p set: 0.4526708722114563
loss_pred:0.032653793692588806, decouple_loss:0.024974599480628967
loss_pred:0.03004457987844944, decouple_loss:0.02524309605360031
loss_pred:0.03219689801335335, decouple_loss:0.024472909048199654
Iteration: 1204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46252676844596863, gen p mean: 0.0, mean p set: 0.45249712467193604
The modified gen p mean: 0.46377989649772644, gen p mean: 0.0, mean p set: 0.4500125050544739
The modified gen p mean: 0.46354955434799194, gen p mean: 0.0, mean p set: 0.45117518305778503
loss_pred:0.03249440714716911, decouple_loss:0.024223577231168747
loss_pred:0.03284221142530441, decouple_loss:0.02433978207409382
loss_pred:0.03135225921869278, decouple_loss:0.02395646646618843
Iteration: 1205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4372991621494293, gen p mean: 0.0, mean p set: 0.45250123739242554
The modified gen p mean: 0.4379733204841614, gen p mean: 0.0, mean p set: 0.4495995044708252
The modified gen p mean: 0.436997652053833, gen p mean: 0.0, mean p set: 0.4525359272956848
loss_pred:0.03193928673863411, decouple_loss:0.02530777081847191
loss_pred:0.033057015389204025, decouple_loss:0.025356438010931015
loss_pred:0.03180224075913429, decouple_loss:0.024497855454683304
Iteration: 1206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43982994556427, gen p mean: 0.0, mean p set: 0.452647864818573
The modified gen p mean: 0.4421233534812927, gen p mean: 0.0, mean p set: 0.4518507122993469
The modified gen p mean: 0.4409930408000946, gen p mean: 0.0, mean p set: 0.4508056044578552
loss_pred:0.03097042441368103, decouple_loss:0.02500547282397747
loss_pred:0.032872095704078674, decouple_loss:0.024205153807997704
loss_pred:0.03288422152400017, decouple_loss:0.0236769150942564
Iteration: 1207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4629557430744171, gen p mean: 0.0, mean p set: 0.4534553289413452
The modified gen p mean: 0.4645123779773712, gen p mean: 0.0, mean p set: 0.4524913430213928
The modified gen p mean: 0.466714084148407, gen p mean: 0.0, mean p set: 0.4511038064956665
loss_pred:0.03177404776215553, decouple_loss:0.02446630597114563
loss_pred:0.03273557126522064, decouple_loss:0.02465922012925148
loss_pred:0.032050181180238724, decouple_loss:0.025447137653827667
Iteration: 1208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46164271235466003, gen p mean: 0.0, mean p set: 0.4520528018474579
The modified gen p mean: 0.4631232023239136, gen p mean: 0.0, mean p set: 0.4520423710346222
The modified gen p mean: 0.4580060839653015, gen p mean: 0.0, mean p set: 0.45323994755744934
loss_pred:0.0319482646882534, decouple_loss:0.02428167499601841
loss_pred:0.03136998787522316, decouple_loss:0.02324671857059002
loss_pred:0.03205205127596855, decouple_loss:0.023940294981002808
Iteration: 1209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4358643889427185, gen p mean: 0.0, mean p set: 0.4505784809589386
The modified gen p mean: 0.43988266587257385, gen p mean: 0.0, mean p set: 0.45226943492889404
The modified gen p mean: 0.43703335523605347, gen p mean: 0.0, mean p set: 0.45376312732696533
loss_pred:0.031420350074768066, decouple_loss:0.025757456198334694
loss_pred:0.03229333832859993, decouple_loss:0.024567535147070885
loss_pred:0.03154628723859787, decouple_loss:0.025767726823687553
Iteration: 1210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44507676362991333, gen p mean: 0.0, mean p set: 0.45339396595954895The modified gen p mean: 0.4512319266796112, gen p mean: 0.0, mean p set: 0.44895628094673157
The modified gen p mean: 0.4464544951915741, gen p mean: 0.0, mean p set: 0.45101380348205566
loss_pred:0.0325724221765995, decouple_loss:0.02549806237220764loss_pred:0.031179411336779594, decouple_loss:0.024766691029071808
loss_pred:0.03151891753077507, decouple_loss:0.025116994976997375
2023-05-02 22:28:38 testing...
The modified gen p mean: 0.45781078934669495, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.46721944212913513, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.46387791633605957, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03363184258341789, decouple_loss:0.026895763352513313
loss_pred:0.03197018429636955, decouple_loss:0.026386704295873642
loss_pred:0.03260559216141701, decouple_loss:0.025675976648926735
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03405185043811798, avg_mse: 0.03701901435852051
current test mse: 0.037019
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
NaN value num: 0
Iteration: 1211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45926418900489807, gen p mean: 0.0, mean p set: 0.4516648054122925
The modified gen p mean: 0.4639420509338379, gen p mean: 0.0, mean p set: 0.45122823119163513
loss_pred:0.031204083934426308, decouple_loss:0.02641751803457737
loss_pred:0.0345940887928009, decouple_loss:0.02770015224814415
The modified gen p mean: 0.46744272112846375, gen p mean: 0.0, mean p set: 0.45016559958457947
loss_pred:0.03158952295780182, decouple_loss:0.026883620768785477
Iteration: 1212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4570100009441376, gen p mean: 0.0, mean p set: 0.4497554302215576
The modified gen p mean: 0.4581146240234375, gen p mean: 0.0, mean p set: 0.45056816935539246
The modified gen p mean: 0.4554996192455292, gen p mean: 0.0, mean p set: 0.450838565826416
loss_pred:0.032684531062841415, decouple_loss:0.02604755200445652
loss_pred:0.03308435529470444, decouple_loss:0.026178518310189247
loss_pred:0.034448590129613876, decouple_loss:0.02646404132246971
Iteration: 1213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43718528747558594, gen p mean: 0.0, mean p set: 0.4500464200973511
The modified gen p mean: 0.4387374818325043, gen p mean: 0.0, mean p set: 0.4512195587158203
The modified gen p mean: 0.44455769658088684, gen p mean: 0.0, mean p set: 0.44914230704307556
loss_pred:0.03234246000647545, decouple_loss:0.026021650061011314
loss_pred:0.03369636461138725, decouple_loss:0.02535443939268589
loss_pred:0.032835062593221664, decouple_loss:0.024684133008122444
Iteration: 1214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44394776225090027, gen p mean: 0.0, mean p set: 0.44983211159706116
The modified gen p mean: 0.4414275288581848, gen p mean: 0.0, mean p set: 0.45083242654800415
The modified gen p mean: 0.4397045075893402, gen p mean: 0.0, mean p set: 0.4518575668334961
loss_pred:0.031902335584163666, decouple_loss:0.02440401166677475
loss_pred:0.032360367476940155, decouple_loss:0.025735264644026756
loss_pred:0.03360689803957939, decouple_loss:0.026226840913295746
Iteration: 1215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45414993166923523, gen p mean: 0.0, mean p set: 0.45222997665405273
The modified gen p mean: 0.4620459973812103, gen p mean: 0.0, mean p set: 0.4488857686519623
The modified gen p mean: 0.4559347927570343, gen p mean: 0.0, mean p set: 0.4502442479133606
loss_pred:0.033425260335206985, decouple_loss:0.02743624523282051
loss_pred:0.03375566005706787, decouple_loss:0.02477801963686943
loss_pred:0.03275495395064354, decouple_loss:0.026316288858652115
Iteration: 1216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4550820291042328, gen p mean: 0.0, mean p set: 0.4517081081867218
The modified gen p mean: 0.4578613042831421, gen p mean: 0.0, mean p set: 0.45372650027275085
The modified gen p mean: 0.4581010341644287, gen p mean: 0.0, mean p set: 0.45137470960617065
loss_pred:0.03380707651376724, decouple_loss:0.027017846703529358
loss_pred:0.030869459733366966, decouple_loss:0.026456711813807487
loss_pred:0.034097060561180115, decouple_loss:0.02537202462553978
Iteration: 1217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479321837425232, gen p mean: 0.0, mean p set: 0.4491777718067169
The modified gen p mean: 0.45318809151649475, gen p mean: 0.0, mean p set: 0.4501582682132721
The modified gen p mean: 0.451314777135849, gen p mean: 0.0, mean p set: 0.44852298498153687
loss_pred:0.03237343207001686, decouple_loss:0.024423101916909218
loss_pred:0.031781092286109924, decouple_loss:0.024223890155553818
loss_pred:0.033538807183504105, decouple_loss:0.024426570162177086
Iteration: 1218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44048768281936646, gen p mean: 0.0, mean p set: 0.4506514370441437
The modified gen p mean: 0.43842199444770813, gen p mean: 0.0, mean p set: 0.4523109793663025
The modified gen p mean: 0.4374661147594452, gen p mean: 0.0, mean p set: 0.45138633251190186
loss_pred:0.03228135406970978, decouple_loss:0.024544570595026016
loss_pred:0.03338317945599556, decouple_loss:0.02606666460633278
loss_pred:0.03172300010919571, decouple_loss:0.02454831264913082
Iteration: 1219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509543478488922, gen p mean: 0.0, mean p set: 0.45141419768333435
The modified gen p mean: 0.451237291097641, gen p mean: 0.0, mean p set: 0.45191308856010437
The modified gen p mean: 0.45891278982162476, gen p mean: 0.0, mean p set: 0.4492046535015106
loss_pred:0.03177236393094063, decouple_loss:0.024510297924280167
loss_pred:0.03347693011164665, decouple_loss:0.02543390356004238
loss_pred:0.03347443416714668, decouple_loss:0.024093778803944588
Iteration: 1220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524843394756317, gen p mean: 0.0, mean p set: 0.45026880502700806
The modified gen p mean: 0.45249029994010925, gen p mean: 0.0, mean p set: 0.45056024193763733
The modified gen p mean: 0.4500536024570465, gen p mean: 0.0, mean p set: 0.45243194699287415
loss_pred:0.03286874294281006, decouple_loss:0.02471798285841942
loss_pred:0.032848529517650604, decouple_loss:0.025127055123448372
loss_pred:0.033998191356658936, decouple_loss:0.025625821202993393
2023-05-02 22:32:55 testing...
The modified gen p mean: 0.44523516297340393, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45507630705833435, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.451773077249527, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03336343169212341, decouple_loss:0.026411257684230804
loss_pred:0.03181220591068268, decouple_loss:0.026412488892674446
loss_pred:0.03245644271373749, decouple_loss:0.025957658886909485
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03385705128312111, avg_mse: 0.036815095692873
current test mse: 0.036815
Iteration: 1221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776949286460876, gen p mean: 0.0, mean p set: 0.45325756072998047
loss_pred:0.031761717051267624, decouple_loss:0.024599863216280937
The modified gen p mean: 0.44712746143341064, gen p mean: 0.0, mean p set: 0.4512555003166199
loss_pred:0.03370814025402069, decouple_loss:0.024334760382771492
The modified gen p mean: 0.4493241310119629, gen p mean: 0.0, mean p set: 0.4514155387878418
loss_pred:0.03246628865599632, decouple_loss:0.025007575750350952
Iteration: 1222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45580312609672546, gen p mean: 0.0, mean p set: 0.4506521224975586
The modified gen p mean: 0.45237550139427185, gen p mean: 0.0, mean p set: 0.4522458016872406
The modified gen p mean: 0.4511178433895111, gen p mean: 0.0, mean p set: 0.4495377540588379
loss_pred:0.032365333288908005, decouple_loss:0.024934232234954834
loss_pred:0.03429686278104782, decouple_loss:0.025070253759622574
loss_pred:0.03204796835780144, decouple_loss:0.024744099006056786
Iteration: 1223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4579329192638397, gen p mean: 0.0, mean p set: 0.45118266344070435
The modified gen p mean: 0.45584672689437866, gen p mean: 0.0, mean p set: 0.45333564281463623
The modified gen p mean: 0.4573294520378113, gen p mean: 0.0, mean p set: 0.4511326253414154
loss_pred:0.03283575177192688, decouple_loss:0.02415282279253006
loss_pred:0.031010279431939125, decouple_loss:0.02422681264579296
loss_pred:0.033619269728660583, decouple_loss:0.0245898999273777
Iteration: 1224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.461135596036911, gen p mean: 0.0, mean p set: 0.4499705135822296
The modified gen p mean: 0.4504915475845337, gen p mean: 0.0, mean p set: 0.4529488980770111
The modified gen p mean: 0.45345765352249146, gen p mean: 0.0, mean p set: 0.45292070508003235
loss_pred:0.031229455024003983, decouple_loss:0.023288628086447716
loss_pred:0.0322096012532711, decouple_loss:0.02396445907652378
loss_pred:0.03409840911626816, decouple_loss:0.023942330852150917
Iteration: 1225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43997180461883545, gen p mean: 0.0, mean p set: 0.4531644284725189
The modified gen p mean: 0.4432038962841034, gen p mean: 0.0, mean p set: 0.4513501822948456
The modified gen p mean: 0.44097888469696045, gen p mean: 0.0, mean p set: 0.45197030901908875
loss_pred:0.03082353249192238, decouple_loss:0.025200890377163887
loss_pred:0.03311238810420036, decouple_loss:0.024051813408732414
loss_pred:0.032711684703826904, decouple_loss:0.02449706569314003
Iteration: 1226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44367384910583496, gen p mean: 0.0, mean p set: 0.4507836401462555The modified gen p mean: 0.44344982504844666, gen p mean: 0.0, mean p set: 0.4506361782550812
The modified gen p mean: 0.43996360898017883, gen p mean: 0.0, mean p set: 0.4518985152244568
loss_pred:0.03259779140353203, decouple_loss:0.025050150230526924loss_pred:0.033439211547374725, decouple_loss:0.02473745122551918
loss_pred:0.0316099114716053, decouple_loss:0.024921104311943054
Iteration: 1227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4563332200050354, gen p mean: 0.0, mean p set: 0.4512436091899872
The modified gen p mean: 0.4607689082622528, gen p mean: 0.0, mean p set: 0.44881677627563477
The modified gen p mean: 0.4568776488304138, gen p mean: 0.0, mean p set: 0.4518345892429352
loss_pred:0.032632015645504, decouple_loss:0.02578599750995636
loss_pred:0.0328797772526741, decouple_loss:0.024753203615546227
loss_pred:0.03279851749539375, decouple_loss:0.024486472830176353
Iteration: 1228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46073928475379944, gen p mean: 0.0, mean p set: 0.4503801465034485
The modified gen p mean: 0.46030035614967346, gen p mean: 0.0, mean p set: 0.45297905802726746
The modified gen p mean: 0.4583621919155121, gen p mean: 0.0, mean p set: 0.451333224773407
loss_pred:0.03196471929550171, decouple_loss:0.02475706674158573
loss_pred:0.0338260680437088, decouple_loss:0.024256594479084015
loss_pred:0.03118225932121277, decouple_loss:0.02349497377872467
Iteration: 1229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45713260769844055, gen p mean: 0.0, mean p set: 0.4487107992172241
The modified gen p mean: 0.449258029460907, gen p mean: 0.0, mean p set: 0.451697438955307
The modified gen p mean: 0.4523564577102661, gen p mean: 0.0, mean p set: 0.4504671096801758
loss_pred:0.032685864716768265, decouple_loss:0.02362864650785923
loss_pred:0.03317940607666969, decouple_loss:0.023574108257889748
loss_pred:0.03205026313662529, decouple_loss:0.024270176887512207
Iteration: 1230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4367228150367737, gen p mean: 0.0, mean p set: 0.4519991874694824
The modified gen p mean: 0.4373238682746887, gen p mean: 0.0, mean p set: 0.4501744508743286
The modified gen p mean: 0.44180819392204285, gen p mean: 0.0, mean p set: 0.4507121443748474
loss_pred:0.033645108342170715, decouple_loss:0.024339551106095314
loss_pred:0.032203420996665955, decouple_loss:0.024260034784674644
loss_pred:0.031956981867551804, decouple_loss:0.02319873869419098
2023-05-02 22:36:33 testing...
The modified gen p mean: 0.4434279799461365, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4533054828643799, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44995376467704773, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03362223505973816, decouple_loss:0.02539839968085289
loss_pred:0.03200150281190872, decouple_loss:0.02555161342024803
loss_pred:0.03273367881774902, decouple_loss:0.024956002831459045
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03405090793967247, avg_mse: 0.0372842475771904
current test mse: 0.037284
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
Iteration: 1231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453144967556, gen p mean: 0.0, mean p set: 0.4482952058315277
The modified gen p mean: 0.4468819200992584, gen p mean: 0.0, mean p set: 0.4480067491531372
loss_pred:0.03375254571437836, decouple_loss:0.025438712909817696
loss_pred:0.03409363701939583, decouple_loss:0.025564558804035187
The modified gen p mean: 0.44564029574394226, gen p mean: 0.0, mean p set: 0.44763314723968506
loss_pred:0.034087833017110825, decouple_loss:0.026084192097187042
Iteration: 1232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4557168185710907, gen p mean: 0.0, mean p set: 0.4479668438434601
The modified gen p mean: 0.45193246006965637, gen p mean: 0.0, mean p set: 0.4477778375148773
The modified gen p mean: 0.4504816234111786, gen p mean: 0.0, mean p set: 0.4486115872859955
loss_pred:0.0351407565176487, decouple_loss:0.02565607614815235
loss_pred:0.03216920420527458, decouple_loss:0.02526278980076313
loss_pred:0.033684175461530685, decouple_loss:0.024969663470983505
Iteration: 1233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700726866722107, gen p mean: 0.0, mean p set: 0.4478038251399994
The modified gen p mean: 0.4474249482154846, gen p mean: 0.0, mean p set: 0.4479702413082123
The modified gen p mean: 0.4534372389316559, gen p mean: 0.0, mean p set: 0.44777771830558777
loss_pred:0.03341967612504959, decouple_loss:0.025126861408352852
loss_pred:0.03281407058238983, decouple_loss:0.025667961686849594
loss_pred:0.03401367366313934, decouple_loss:0.02541131153702736
Iteration: 1234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45732393860816956, gen p mean: 0.0, mean p set: 0.44768041372299194
The modified gen p mean: 0.46094369888305664, gen p mean: 0.0, mean p set: 0.4478713572025299
The modified gen p mean: 0.46238279342651367, gen p mean: 0.0, mean p set: 0.44771143794059753
loss_pred:0.03206788748502731, decouple_loss:0.0244283489882946
loss_pred:0.03438111022114754, decouple_loss:0.024478858336806297
loss_pred:0.0336884930729866, decouple_loss:0.025225363671779633
Iteration: 1235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44683441519737244, gen p mean: 0.0, mean p set: 0.4485156238079071
The modified gen p mean: 0.4460858106613159, gen p mean: 0.0, mean p set: 0.4490697383880615
The modified gen p mean: 0.448345810174942, gen p mean: 0.0, mean p set: 0.44767072796821594
loss_pred:0.03098425641655922, decouple_loss:0.02386772260069847
loss_pred:0.03143288195133209, decouple_loss:0.02410571463406086
loss_pred:0.03449003025889397, decouple_loss:0.023953620344400406
Iteration: 1236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43539664149284363, gen p mean: 0.0, mean p set: 0.4490669369697571
The modified gen p mean: 0.4404568076133728, gen p mean: 0.0, mean p set: 0.4481000304222107
The modified gen p mean: 0.43672874569892883, gen p mean: 0.0, mean p set: 0.4480361342430115
loss_pred:0.032306771725416183, decouple_loss:0.02350061759352684
loss_pred:0.033460475504398346, decouple_loss:0.023857971653342247
loss_pred:0.03374017775058746, decouple_loss:0.023545486852526665
Iteration: 1237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44179946184158325, gen p mean: 0.0, mean p set: 0.4482216238975525
The modified gen p mean: 0.4419068694114685, gen p mean: 0.0, mean p set: 0.44783589243888855
The modified gen p mean: 0.439975768327713, gen p mean: 0.0, mean p set: 0.4483889639377594
loss_pred:0.03173982352018356, decouple_loss:0.023724546656012535
loss_pred:0.03373563662171364, decouple_loss:0.023340709507465363
loss_pred:0.032306697219610214, decouple_loss:0.023273659870028496
Iteration: 1238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.456371009349823, gen p mean: 0.0, mean p set: 0.44713303446769714
The modified gen p mean: 0.45859402418136597, gen p mean: 0.0, mean p set: 0.44725102186203003
The modified gen p mean: 0.4598528742790222, gen p mean: 0.0, mean p set: 0.4475988745689392
loss_pred:0.03149872273206711, decouple_loss:0.023107873275876045
loss_pred:0.031859882175922394, decouple_loss:0.02336214855313301
loss_pred:0.03312227502465248, decouple_loss:0.02380092442035675
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471813142299652, gen p mean: 0.0, mean p set: 0.4480603337287903
The modified gen p mean: 0.44788873195648193, gen p mean: 0.0, mean p set: 0.4482428729534149
The modified gen p mean: 0.4444422423839569, gen p mean: 0.0, mean p set: 0.44767072796821594
loss_pred:0.0331055112183094, decouple_loss:0.02429303340613842
loss_pred:0.03286242112517357, decouple_loss:0.024457842111587524
loss_pred:0.03380275145173073, decouple_loss:0.02282678708434105
Iteration: 1240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4402467608451843, gen p mean: 0.0, mean p set: 0.4476645588874817
The modified gen p mean: 0.4371444582939148, gen p mean: 0.0, mean p set: 0.44758090376853943
The modified gen p mean: 0.43722671270370483, gen p mean: 0.0, mean p set: 0.4486217796802521
loss_pred:0.033549826592206955, decouple_loss:0.023147931322455406
loss_pred:0.03292515128850937, decouple_loss:0.023266997188329697
loss_pred:0.032913271337747574, decouple_loss:0.02376602031290531
2023-05-02 22:40:57 testing...
The modified gen p mean: 0.4471789300441742, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4569271206855774, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4534938633441925, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03301551565527916, decouple_loss:0.024506503716111183
loss_pred:0.03151290863752365, decouple_loss:0.024121074005961418
loss_pred:0.03224907070398331, decouple_loss:0.02352694794535637
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03346174210309982, avg_mse: 0.03643130883574486
current test mse: 0.036431
Iteration: 1241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45584386587142944, gen p mean: 0.0, mean p set: 0.4482730031013489
The modified gen p mean: 0.4544409215450287, gen p mean: 0.0, mean p set: 0.44793930649757385
loss_pred:0.03225056827068329, decouple_loss:0.022333094850182533
loss_pred:0.0335119403898716, decouple_loss:0.023652447387576103
The modified gen p mean: 0.45489761233329773, gen p mean: 0.0, mean p set: 0.44678664207458496
loss_pred:0.03223944082856178, decouple_loss:0.0236127320677042
Iteration: 1242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.460870623588562, gen p mean: 0.0, mean p set: 0.4480897784233093
The modified gen p mean: 0.4627351760864258, gen p mean: 0.0, mean p set: 0.4481445848941803
The modified gen p mean: 0.46125033497810364, gen p mean: 0.0, mean p set: 0.44781771302223206
loss_pred:0.03310726210474968, decouple_loss:0.023358933627605438
loss_pred:0.03202126547694206, decouple_loss:0.022213034331798553
loss_pred:0.03367779031395912, decouple_loss:0.024205751717090607
Iteration: 1243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44445642828941345, gen p mean: 0.0, mean p set: 0.4476606547832489
The modified gen p mean: 0.44735071063041687, gen p mean: 0.0, mean p set: 0.44739648699760437
The modified gen p mean: 0.443539559841156, gen p mean: 0.0, mean p set: 0.44833505153656006
loss_pred:0.033830296248197556, decouple_loss:0.022487586364150047
loss_pred:0.03439180925488472, decouple_loss:0.023415695875883102
loss_pred:0.032830674201250076, decouple_loss:0.024077454581856728
Iteration: 1244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42822888493537903, gen p mean: 0.0, mean p set: 0.44848695397377014
The modified gen p mean: 0.43008479475975037, gen p mean: 0.0, mean p set: 0.44824355840682983
The modified gen p mean: 0.4337196946144104, gen p mean: 0.0, mean p set: 0.44729599356651306
loss_pred:0.033660102635622025, decouple_loss:0.022929759696125984
loss_pred:0.033400602638721466, decouple_loss:0.023048842325806618
loss_pred:0.03174958750605583, decouple_loss:0.022913675755262375
Iteration: 1245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481443166732788, gen p mean: 0.0, mean p set: 0.4482708275318146
The modified gen p mean: 0.45152008533477783, gen p mean: 0.0, mean p set: 0.4481123387813568
The modified gen p mean: 0.453116238117218, gen p mean: 0.0, mean p set: 0.44806763529777527
loss_pred:0.03424183651804924, decouple_loss:0.022114651277661324
loss_pred:0.031041093170642853, decouple_loss:0.02214071713387966
loss_pred:0.0331248864531517, decouple_loss:0.023742064833641052
Iteration: 1246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4631856679916382, gen p mean: 0.0, mean p set: 0.4474641680717468
The modified gen p mean: 0.46206972002983093, gen p mean: 0.0, mean p set: 0.4467572569847107
The modified gen p mean: 0.4602673649787903, gen p mean: 0.0, mean p set: 0.4481448233127594
loss_pred:0.03483007103204727, decouple_loss:0.023110995069146156
loss_pred:0.03127095103263855, decouple_loss:0.022530531510710716
loss_pred:0.03370928019285202, decouple_loss:0.022382663562893867
Iteration: 1247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535287916660309, gen p mean: 0.0, mean p set: 0.44749921560287476
The modified gen p mean: 0.44685137271881104, gen p mean: 0.0, mean p set: 0.44792598485946655
The modified gen p mean: 0.4503439962863922, gen p mean: 0.0, mean p set: 0.44807714223861694
loss_pred:0.03407633304595947, decouple_loss:0.022560348734259605
loss_pred:0.03269195184111595, decouple_loss:0.02270885743200779
loss_pred:0.03239763155579567, decouple_loss:0.023024994879961014
Iteration: 1248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.437550812959671, gen p mean: 0.0, mean p set: 0.44774720072746277
The modified gen p mean: 0.4373898506164551, gen p mean: 0.0, mean p set: 0.4488099217414856
The modified gen p mean: 0.44339799880981445, gen p mean: 0.0, mean p set: 0.447443425655365
loss_pred:0.03183481842279434, decouple_loss:0.02190585993230343
loss_pred:0.034380387514829636, decouple_loss:0.021997805684804916
loss_pred:0.03216991573572159, decouple_loss:0.021574841812253
Iteration: 1249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471507668495178, gen p mean: 0.0, mean p set: 0.44649389386177063
The modified gen p mean: 0.446074515581131, gen p mean: 0.0, mean p set: 0.44820162653923035
The modified gen p mean: 0.4460788667201996, gen p mean: 0.0, mean p set: 0.4480176270008087
loss_pred:0.031024856492877007, decouple_loss:0.021253952756524086
loss_pred:0.03368702158331871, decouple_loss:0.021676301956176758
loss_pred:0.033202920109033585, decouple_loss:0.022036626935005188
Iteration: 1250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4441092312335968, gen p mean: 0.0, mean p set: 0.44800713658332825
The modified gen p mean: 0.45056819915771484, gen p mean: 0.0, mean p set: 0.44702383875846863
The modified gen p mean: 0.45099937915802, gen p mean: 0.0, mean p set: 0.44755926728248596
loss_pred:0.033019013702869415, decouple_loss:0.022800926119089127
loss_pred:0.032346948981285095, decouple_loss:0.021876150742173195
loss_pred:0.03394344821572304, decouple_loss:0.023297365754842758
2023-05-02 22:44:37 testing...
The modified gen p mean: 0.44814181327819824, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44207337498664856, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4512135088443756, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03202509507536888, decouple_loss:0.022919172421097755
loss_pred:0.03285042569041252, decouple_loss:0.02355191670358181
loss_pred:0.03126825764775276, decouple_loss:0.0233356561511755
WV_0_PC_0_EH_0_PS_40_6, loss: 0.033211372792720795, avg_mse: 0.03618916496634483
current test mse: 0.036189
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
NaN value num: 0
Iteration: 1251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515092670917511, gen p mean: 0.0, mean p set: 0.4482291042804718
The modified gen p mean: 0.446874737739563, gen p mean: 0.0, mean p set: 0.44910410046577454
loss_pred:0.03282555937767029, decouple_loss:0.023143956437706947
loss_pred:0.032344918698072433, decouple_loss:0.02215830609202385
The modified gen p mean: 0.4446929395198822, gen p mean: 0.0, mean p set: 0.45003825426101685
loss_pred:0.03130977973341942, decouple_loss:0.022335654124617577
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4404444396495819, gen p mean: 0.0, mean p set: 0.44910916686058044
The modified gen p mean: 0.4415837228298187, gen p mean: 0.0, mean p set: 0.4485251009464264
The modified gen p mean: 0.44382065534591675, gen p mean: 0.0, mean p set: 0.4492001235485077
loss_pred:0.032413024455308914, decouple_loss:0.0221681110560894
loss_pred:0.03168350085616112, decouple_loss:0.02258935011923313
loss_pred:0.031408362090587616, decouple_loss:0.02322119101881981
Iteration: 1253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502400755882263, gen p mean: 0.0, mean p set: 0.4484765827655792
The modified gen p mean: 0.4479883313179016, gen p mean: 0.0, mean p set: 0.449685275554657
The modified gen p mean: 0.45306992530822754, gen p mean: 0.0, mean p set: 0.4492258131504059
loss_pred:0.03201165795326233, decouple_loss:0.02205924317240715
loss_pred:0.03147692605853081, decouple_loss:0.021816594526171684
loss_pred:0.03139859810471535, decouple_loss:0.022187577560544014
Iteration: 1254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46716633439064026, gen p mean: 0.0, mean p set: 0.44804278016090393
The modified gen p mean: 0.4698624312877655, gen p mean: 0.0, mean p set: 0.44871124625205994
The modified gen p mean: 0.4675353467464447, gen p mean: 0.0, mean p set: 0.4483604431152344
loss_pred:0.03287026658654213, decouple_loss:0.022836511954665184
loss_pred:0.03215184062719345, decouple_loss:0.022490693256258965
loss_pred:0.03140963241457939, decouple_loss:0.022338036447763443
Iteration: 1255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476931691169739, gen p mean: 0.0, mean p set: 0.4482443630695343
The modified gen p mean: 0.44974496960639954, gen p mean: 0.0, mean p set: 0.4494262933731079
The modified gen p mean: 0.44928085803985596, gen p mean: 0.0, mean p set: 0.4476754069328308
loss_pred:0.031897883862257004, decouple_loss:0.021761978045105934
loss_pred:0.031617842614650726, decouple_loss:0.022723382338881493
loss_pred:0.03155312314629555, decouple_loss:0.021017204970121384
Iteration: 1256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4307599663734436, gen p mean: 0.0, mean p set: 0.4480650722980499
The modified gen p mean: 0.42575815320014954, gen p mean: 0.0, mean p set: 0.4491156041622162
The modified gen p mean: 0.42495572566986084, gen p mean: 0.0, mean p set: 0.44925105571746826
loss_pred:0.03208004683256149, decouple_loss:0.021919263526797295
loss_pred:0.03224657475948334, decouple_loss:0.02164306305348873
loss_pred:0.03184482827782631, decouple_loss:0.022076962515711784
Iteration: 1257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4384976029396057, gen p mean: 0.0, mean p set: 0.44930675625801086
The modified gen p mean: 0.44124871492385864, gen p mean: 0.0, mean p set: 0.4486922323703766
The modified gen p mean: 0.4367501735687256, gen p mean: 0.0, mean p set: 0.4492073655128479
loss_pred:0.03131683170795441, decouple_loss:0.022092828527092934
loss_pred:0.0318291075527668, decouple_loss:0.021816985681653023
loss_pred:0.030070114880800247, decouple_loss:0.02253979817032814
Iteration: 1258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4651952087879181, gen p mean: 0.0, mean p set: 0.44926580786705017
The modified gen p mean: 0.46463239192962646, gen p mean: 0.0, mean p set: 0.4488835632801056
The modified gen p mean: 0.4636632800102234, gen p mean: 0.0, mean p set: 0.44924765825271606
loss_pred:0.031908415257930756, decouple_loss:0.02145167626440525
loss_pred:0.03180600702762604, decouple_loss:0.02185968868434429
loss_pred:0.03059542365372181, decouple_loss:0.02214311994612217
Iteration: 1259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4696301817893982, gen p mean: 0.0, mean p set: 0.447873055934906
The modified gen p mean: 0.463113933801651, gen p mean: 0.0, mean p set: 0.44785305857658386
The modified gen p mean: 0.4619230329990387, gen p mean: 0.0, mean p set: 0.4486883282661438
loss_pred:0.032521896064281464, decouple_loss:0.022739272564649582
loss_pred:0.03202277421951294, decouple_loss:0.021031947806477547
loss_pred:0.03180032968521118, decouple_loss:0.021751701831817627
Iteration: 1260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4369751513004303, gen p mean: 0.0, mean p set: 0.44856706261634827
The modified gen p mean: 0.4376508891582489, gen p mean: 0.0, mean p set: 0.44855865836143494
The modified gen p mean: 0.437804251909256, gen p mean: 0.0, mean p set: 0.4479973018169403
loss_pred:0.03229334205389023, decouple_loss:0.021840790286660194
loss_pred:0.0320810042321682, decouple_loss:0.02096557803452015
loss_pred:0.032298002392053604, decouple_loss:0.022446658462285995
2023-05-02 22:48:58 testing...
The modified gen p mean: 0.4370318651199341, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.43091103434562683, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44008758664131165, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03187806159257889, decouple_loss:0.02264638990163803
loss_pred:0.032945483922958374, decouple_loss:0.02354886569082737
loss_pred:0.03130039572715759, decouple_loss:0.023395290598273277
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03320115804672241, avg_mse: 0.036124955862760544
current test mse: 0.036125
Iteration: 1261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43649134039878845, gen p mean: 0.0, mean p set: 0.44714176654815674
loss_pred:0.03200274705886841, decouple_loss:0.022022921591997147
The modified gen p mean: 0.43679675459861755, gen p mean: 0.0, mean p set: 0.44981372356414795
loss_pred:0.03140399232506752, decouple_loss:0.022983478382229805
The modified gen p mean: 0.4334905445575714, gen p mean: 0.0, mean p set: 0.4486764669418335
loss_pred:0.031649038195610046, decouple_loss:0.022065313532948494
Iteration: 1262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4577291011810303, gen p mean: 0.0, mean p set: 0.44887199997901917
The modified gen p mean: 0.4569742977619171, gen p mean: 0.0, mean p set: 0.4491857588291168
The modified gen p mean: 0.45607858896255493, gen p mean: 0.0, mean p set: 0.4484924077987671
loss_pred:0.03173098713159561, decouple_loss:0.02187265455722809
loss_pred:0.032075539231300354, decouple_loss:0.02144826017320156
loss_pred:0.031277403235435486, decouple_loss:0.02140299417078495
Iteration: 1263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4548399746417999, gen p mean: 0.0, mean p set: 0.4494645595550537
The modified gen p mean: 0.4567009210586548, gen p mean: 0.0, mean p set: 0.4479115903377533
The modified gen p mean: 0.4518667161464691, gen p mean: 0.0, mean p set: 0.4487766921520233
loss_pred:0.031912170350551605, decouple_loss:0.0220955740660429
loss_pred:0.031451836228370667, decouple_loss:0.022580305114388466
loss_pred:0.032287295907735825, decouple_loss:0.02223193645477295
Iteration: 1264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44583413004875183, gen p mean: 0.0, mean p set: 0.4492553174495697
The modified gen p mean: 0.44466379284858704, gen p mean: 0.0, mean p set: 0.4490547776222229
The modified gen p mean: 0.44267797470092773, gen p mean: 0.0, mean p set: 0.44995051622390747
loss_pred:0.030892767012119293, decouple_loss:0.02294551022350788
loss_pred:0.03131048008799553, decouple_loss:0.02253037318587303
loss_pred:0.031369149684906006, decouple_loss:0.02258901856839657
Iteration: 1265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45119190216064453, gen p mean: 0.0, mean p set: 0.44916975498199463
The modified gen p mean: 0.45298248529434204, gen p mean: 0.0, mean p set: 0.44853806495666504
The modified gen p mean: 0.448933482170105, gen p mean: 0.0, mean p set: 0.4477364122867584
loss_pred:0.03243615850806236, decouple_loss:0.02072538249194622
loss_pred:0.030905617401003838, decouple_loss:0.021836569532752037
loss_pred:0.03215084969997406, decouple_loss:0.02108645811676979
Iteration: 1266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513188302516937, gen p mean: 0.0, mean p set: 0.44861912727355957
The modified gen p mean: 0.45145273208618164, gen p mean: 0.0, mean p set: 0.4496248662471771
The modified gen p mean: 0.45133069157600403, gen p mean: 0.0, mean p set: 0.44683340191841125
loss_pred:0.0317477248609066, decouple_loss:0.02158454991877079
loss_pred:0.031229160726070404, decouple_loss:0.021700125187635422
loss_pred:0.03184156492352486, decouple_loss:0.02097359672188759
Iteration: 1267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4416065514087677, gen p mean: 0.0, mean p set: 0.4490397274494171
The modified gen p mean: 0.437873899936676, gen p mean: 0.0, mean p set: 0.450029194355011
The modified gen p mean: 0.4387277364730835, gen p mean: 0.0, mean p set: 0.44917428493499756
loss_pred:0.031884994357824326, decouple_loss:0.021958008408546448
loss_pred:0.03125590458512306, decouple_loss:0.022068601101636887
loss_pred:0.03157714009284973, decouple_loss:0.021040761843323708
Iteration: 1268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861409068107605, gen p mean: 0.0, mean p set: 0.4488137364387512
The modified gen p mean: 0.45021459460258484, gen p mean: 0.0, mean p set: 0.44937053322792053
The modified gen p mean: 0.4465208053588867, gen p mean: 0.0, mean p set: 0.4484313726425171
loss_pred:0.030934015288949013, decouple_loss:0.02168268710374832
loss_pred:0.032619308680295944, decouple_loss:0.021991804242134094
loss_pred:0.031112227588891983, decouple_loss:0.021988237276673317
Iteration: 1269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531998634338379, gen p mean: 0.0, mean p set: 0.44906941056251526
The modified gen p mean: 0.45243433117866516, gen p mean: 0.0, mean p set: 0.44895440340042114
The modified gen p mean: 0.4541585445404053, gen p mean: 0.0, mean p set: 0.44898921251296997
loss_pred:0.0318446159362793, decouple_loss:0.021816840395331383
loss_pred:0.031220145523548126, decouple_loss:0.02238290198147297
loss_pred:0.030378302559256554, decouple_loss:0.021294981241226196
Iteration: 1270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4565916955471039, gen p mean: 0.0, mean p set: 0.44911760091781616
The modified gen p mean: 0.45882511138916016, gen p mean: 0.0, mean p set: 0.4482038617134094
The modified gen p mean: 0.4524597227573395, gen p mean: 0.0, mean p set: 0.4483354985713959
loss_pred:0.032341089099645615, decouple_loss:0.022065909579396248
loss_pred:0.03197766840457916, decouple_loss:0.023193811997771263
loss_pred:0.03195928409695625, decouple_loss:0.02216595970094204
2023-05-02 22:52:40 testing...
The modified gen p mean: 0.4383661448955536, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44755369424819946, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4444902539253235, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.032802216708660126, decouple_loss:0.02306213788688183
loss_pred:0.031114822253584862, decouple_loss:0.022734813392162323
loss_pred:0.03181486949324608, decouple_loss:0.022418353706598282
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03304755687713623, avg_mse: 0.03606070578098297
current test mse: 0.036061
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
NaN value num: 0
Iteration: 1271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694167375564575, gen p mean: 0.0, mean p set: 0.4510918855667114
The modified gen p mean: 0.44272729754447937, gen p mean: 0.0, mean p set: 0.4518677592277527
loss_pred:0.031998638063669205, decouple_loss:0.026897430419921875
loss_pred:0.03279003128409386, decouple_loss:0.026133175939321518
The modified gen p mean: 0.4424235224723816, gen p mean: 0.0, mean p set: 0.452862411737442
loss_pred:0.03293221443891525, decouple_loss:0.027715720236301422
Iteration: 1272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470127522945404, gen p mean: 0.0, mean p set: 0.4518711566925049
The modified gen p mean: 0.44883859157562256, gen p mean: 0.0, mean p set: 0.4525795578956604
The modified gen p mean: 0.4532112777233124, gen p mean: 0.0, mean p set: 0.451375812292099
loss_pred:0.03217652067542076, decouple_loss:0.02626647800207138
loss_pred:0.03280513733625412, decouple_loss:0.026359986513853073
loss_pred:0.03346812725067139, decouple_loss:0.026121992617845535
Iteration: 1273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45933347940444946, gen p mean: 0.0, mean p set: 0.45299410820007324
The modified gen p mean: 0.4586407244205475, gen p mean: 0.0, mean p set: 0.4517892897129059
The modified gen p mean: 0.4577063024044037, gen p mean: 0.0, mean p set: 0.4523775279521942
loss_pred:0.03258369490504265, decouple_loss:0.025079287588596344
loss_pred:0.03181875869631767, decouple_loss:0.025059131905436516
loss_pred:0.03192688524723053, decouple_loss:0.024684451520442963
Iteration: 1274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45516180992126465, gen p mean: 0.0, mean p set: 0.45170727372169495
The modified gen p mean: 0.4532278776168823, gen p mean: 0.0, mean p set: 0.45321789383888245
The modified gen p mean: 0.4570651352405548, gen p mean: 0.0, mean p set: 0.45228198170661926
loss_pred:0.031090419739484787, decouple_loss:0.024066884070634842
loss_pred:0.032177604734897614, decouple_loss:0.024250369518995285
loss_pred:0.033440202474594116, decouple_loss:0.025762086734175682
Iteration: 1275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715616106987, gen p mean: 0.0, mean p set: 0.45089107751846313
The modified gen p mean: 0.44610288739204407, gen p mean: 0.0, mean p set: 0.4531055986881256
The modified gen p mean: 0.44479578733444214, gen p mean: 0.0, mean p set: 0.45381149649620056
loss_pred:0.03240957856178284, decouple_loss:0.02382536418735981
loss_pred:0.032462701201438904, decouple_loss:0.024252325296401978
loss_pred:0.03296433389186859, decouple_loss:0.025579676032066345
Iteration: 1276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213747024536133, gen p mean: 0.0, mean p set: 0.45412078499794006
The modified gen p mean: 0.44820868968963623, gen p mean: 0.0, mean p set: 0.4520549178123474
The modified gen p mean: 0.449117511510849, gen p mean: 0.0, mean p set: 0.4534555673599243
loss_pred:0.032697953283786774, decouple_loss:0.024689920246601105
loss_pred:0.03383639082312584, decouple_loss:0.025286169722676277
loss_pred:0.03276127949357033, decouple_loss:0.024675782769918442
Iteration: 1277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4587620794773102, gen p mean: 0.0, mean p set: 0.45300236344337463
The modified gen p mean: 0.45028141140937805, gen p mean: 0.0, mean p set: 0.45368802547454834
The modified gen p mean: 0.4531363546848297, gen p mean: 0.0, mean p set: 0.45181846618652344
loss_pred:0.032253604382276535, decouple_loss:0.0243972335010767
loss_pred:0.03322112187743187, decouple_loss:0.025513580068945885
loss_pred:0.03158939257264137, decouple_loss:0.02536933496594429
Iteration: 1278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013320446014404, gen p mean: 0.0, mean p set: 0.4527551829814911
The modified gen p mean: 0.4495568871498108, gen p mean: 0.0, mean p set: 0.4530409872531891
The modified gen p mean: 0.4514608085155487, gen p mean: 0.0, mean p set: 0.4513013958930969
loss_pred:0.03263159096240997, decouple_loss:0.025247644633054733
loss_pred:0.03255750238895416, decouple_loss:0.02525383234024048
loss_pred:0.03159254044294357, decouple_loss:0.02429751306772232
Iteration: 1279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524666965007782, gen p mean: 0.0, mean p set: 0.45121341943740845
The modified gen p mean: 0.45615872740745544, gen p mean: 0.0, mean p set: 0.4515622556209564
The modified gen p mean: 0.44821998476982117, gen p mean: 0.0, mean p set: 0.4528955817222595
loss_pred:0.03101225756108761, decouple_loss:0.0243640448898077
loss_pred:0.03241441026329994, decouple_loss:0.024390878155827522
loss_pred:0.032714951783418655, decouple_loss:0.025757109746336937
Iteration: 1280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45185917615890503, gen p mean: 0.0, mean p set: 0.45254209637641907
The modified gen p mean: 0.45357418060302734, gen p mean: 0.0, mean p set: 0.45142796635627747
loss_pred:0.03272572532296181, decouple_loss:0.023886533454060555
The modified gen p mean: 0.4497559666633606, gen p mean: 0.0, mean p set: 0.45143428444862366
loss_pred:0.03128677234053612, decouple_loss:0.024512099102139473
loss_pred:0.03068060800433159, decouple_loss:0.024004731327295303
2023-05-02 22:56:57 testing...
The modified gen p mean: 0.4429624378681183, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44952481985092163, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4525206387042999, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03305727243423462, decouple_loss:0.027409400790929794
loss_pred:0.03219400346279144, decouple_loss:0.026087254285812378
loss_pred:0.03138284012675285, decouple_loss:0.026889482513070107
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03355114161968231, avg_mse: 0.03663034364581108
current test mse: 0.03663
Iteration: 1281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.459272563457489, gen p mean: 0.0, mean p set: 0.4535618722438812
The modified gen p mean: 0.4574170708656311, gen p mean: 0.0, mean p set: 0.45309609174728394
loss_pred:0.03141621872782707, decouple_loss:0.023716945201158524
loss_pred:0.03253282234072685, decouple_loss:0.023765593767166138
The modified gen p mean: 0.4526492953300476, gen p mean: 0.0, mean p set: 0.4525703489780426
loss_pred:0.03125835955142975, decouple_loss:0.024334290996193886
Iteration: 1282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448473185300827, gen p mean: 0.0, mean p set: 0.45237478613853455
The modified gen p mean: 0.44797995686531067, gen p mean: 0.0, mean p set: 0.4507977068424225
The modified gen p mean: 0.4512459933757782, gen p mean: 0.0, mean p set: 0.45189008116722107
loss_pred:0.03330644592642784, decouple_loss:0.02316097728908062
loss_pred:0.03185149282217026, decouple_loss:0.024425309151411057
loss_pred:0.03250133991241455, decouple_loss:0.023254292085766792
Iteration: 1283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448638379573822, gen p mean: 0.0, mean p set: 0.45315417647361755
The modified gen p mean: 0.4492940902709961, gen p mean: 0.0, mean p set: 0.4516338109970093
The modified gen p mean: 0.44540929794311523, gen p mean: 0.0, mean p set: 0.45124828815460205
loss_pred:0.032136011868715286, decouple_loss:0.02364189550280571
loss_pred:0.031841859221458435, decouple_loss:0.02352035418152809
loss_pred:0.03187187388539314, decouple_loss:0.024835113435983658
Iteration: 1284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052003860473633, gen p mean: 0.0, mean p set: 0.4526480436325073
The modified gen p mean: 0.45105957984924316, gen p mean: 0.0, mean p set: 0.45258164405822754
The modified gen p mean: 0.45447155833244324, gen p mean: 0.0, mean p set: 0.45390620827674866
loss_pred:0.03214368224143982, decouple_loss:0.023030003532767296
loss_pred:0.03205208480358124, decouple_loss:0.024294530972838402
loss_pred:0.03280838578939438, decouple_loss:0.022885633632540703
Iteration: 1285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4546814262866974, gen p mean: 0.0, mean p set: 0.4519580900669098
The modified gen p mean: 0.46478161215782166, gen p mean: 0.0, mean p set: 0.45172739028930664
The modified gen p mean: 0.45937809348106384, gen p mean: 0.0, mean p set: 0.45344221591949463
loss_pred:0.03244251385331154, decouple_loss:0.02329554595053196
loss_pred:0.031695228070020676, decouple_loss:0.022454436868429184
loss_pred:0.03323281183838844, decouple_loss:0.023788200691342354
Iteration: 1286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451949805021286, gen p mean: 0.0, mean p set: 0.45360562205314636
The modified gen p mean: 0.45196813344955444, gen p mean: 0.0, mean p set: 0.4514986276626587
The modified gen p mean: 0.44845032691955566, gen p mean: 0.0, mean p set: 0.4522334337234497
loss_pred:0.032719120383262634, decouple_loss:0.024001067504286766
loss_pred:0.032093316316604614, decouple_loss:0.02268093079328537
loss_pred:0.03153304383158684, decouple_loss:0.022645272314548492
Iteration: 1287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491577446460724, gen p mean: 0.0, mean p set: 0.45151615142822266
The modified gen p mean: 0.4493129551410675, gen p mean: 0.0, mean p set: 0.45124077796936035
The modified gen p mean: 0.45087045431137085, gen p mean: 0.0, mean p set: 0.4532724618911743
loss_pred:0.03087027557194233, decouple_loss:0.023202184587717056
loss_pred:0.03014943189918995, decouple_loss:0.022289197891950607
loss_pred:0.032241545617580414, decouple_loss:0.022825153544545174
Iteration: 1288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473241865634918, gen p mean: 0.0, mean p set: 0.4526018798351288
The modified gen p mean: 0.44831305742263794, gen p mean: 0.0, mean p set: 0.4536888301372528
The modified gen p mean: 0.4517596960067749, gen p mean: 0.0, mean p set: 0.45285117626190186
loss_pred:0.03140821307897568, decouple_loss:0.023319538682699203
loss_pred:0.03308556228876114, decouple_loss:0.023560019209980965
loss_pred:0.03192448243498802, decouple_loss:0.02387600764632225
Iteration: 1289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4549793004989624, gen p mean: 0.0, mean p set: 0.4507158100605011
The modified gen p mean: 0.4493441879749298, gen p mean: 0.0, mean p set: 0.45191919803619385
The modified gen p mean: 0.4575730562210083, gen p mean: 0.0, mean p set: 0.4536671042442322
loss_pred:0.03031901642680168, decouple_loss:0.02266508713364601
loss_pred:0.030930934473872185, decouple_loss:0.022389773279428482
loss_pred:0.03137575089931488, decouple_loss:0.02233003079891205
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 1290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4412630796432495, gen p mean: 0.0, mean p set: 0.4475838840007782
The modified gen p mean: 0.45037177205085754, gen p mean: 0.0, mean p set: 0.44745346903800964
The modified gen p mean: 0.4464309811592102, gen p mean: 0.0, mean p set: 0.4469849467277527
loss_pred:0.03263000026345253, decouple_loss:0.02492482215166092
loss_pred:0.03176877647638321, decouple_loss:0.02532428875565529
loss_pred:0.031141942366957664, decouple_loss:0.02468106895685196
2023-05-02 23:01:17 testing...
The modified gen p mean: 0.4437866806983948, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45057451725006104, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4532313942909241, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03283707797527313, decouple_loss:0.025223383679986
loss_pred:0.03191365674138069, decouple_loss:0.023974891752004623
loss_pred:0.031200235709547997, decouple_loss:0.024699127301573753
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03321528434753418, avg_mse: 0.0363609753549099
current test mse: 0.036361
Iteration: 1291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471275806427002, gen p mean: 0.0, mean p set: 0.44785624742507935
The modified gen p mean: 0.45045313239097595, gen p mean: 0.0, mean p set: 0.44750016927719116
loss_pred:0.03074479103088379, decouple_loss:0.023669183254241943
loss_pred:0.03269454091787338, decouple_loss:0.02448469027876854
The modified gen p mean: 0.45241156220436096, gen p mean: 0.0, mean p set: 0.447516530752182
loss_pred:0.03268967196345329, decouple_loss:0.02467944845557213
Iteration: 1292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44894710183143616, gen p mean: 0.0, mean p set: 0.4472208023071289
The modified gen p mean: 0.44765704870224, gen p mean: 0.0, mean p set: 0.4475100040435791
The modified gen p mean: 0.445247083902359, gen p mean: 0.0, mean p set: 0.44815176725387573
loss_pred:0.031079135835170746, decouple_loss:0.023425672203302383
loss_pred:0.030717018991708755, decouple_loss:0.02280956506729126
loss_pred:0.031068608164787292, decouple_loss:0.02332579903304577
Iteration: 1293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464245140552521, gen p mean: 0.0, mean p set: 0.44787725806236267
The modified gen p mean: 0.446309894323349, gen p mean: 0.0, mean p set: 0.4460061490535736
The modified gen p mean: 0.44406792521476746, gen p mean: 0.0, mean p set: 0.4468908905982971
loss_pred:0.032394763082265854, decouple_loss:0.022881537675857544
loss_pred:0.031133189797401428, decouple_loss:0.022908929735422134
loss_pred:0.030774999409914017, decouple_loss:0.022529207170009613
Iteration: 1294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521375298500061, gen p mean: 0.0, mean p set: 0.44875821471214294
The modified gen p mean: 0.44980981945991516, gen p mean: 0.0, mean p set: 0.44829845428466797
The modified gen p mean: 0.44843217730522156, gen p mean: 0.0, mean p set: 0.44693562388420105
loss_pred:0.032752737402915955, decouple_loss:0.02380414307117462
loss_pred:0.031232064589858055, decouple_loss:0.02287091501057148
loss_pred:0.030482636764645576, decouple_loss:0.023455549031496048
Iteration: 1295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058393478393555, gen p mean: 0.0, mean p set: 0.44678959250450134
The modified gen p mean: 0.44942861795425415, gen p mean: 0.0, mean p set: 0.44594070315361023
The modified gen p mean: 0.44698116183280945, gen p mean: 0.0, mean p set: 0.4474697411060333
loss_pred:0.03062421828508377, decouple_loss:0.02185741625726223
loss_pred:0.030531184747815132, decouple_loss:0.022654272615909576
loss_pred:0.030637266114354134, decouple_loss:0.02212763950228691
Iteration: 1296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4439806044101715, gen p mean: 0.0, mean p set: 0.4466158449649811
The modified gen p mean: 0.44095155596733093, gen p mean: 0.0, mean p set: 0.44771912693977356
The modified gen p mean: 0.4472077190876007, gen p mean: 0.0, mean p set: 0.4471677839756012
loss_pred:0.03060956858098507, decouple_loss:0.02267901785671711
loss_pred:0.03140876814723015, decouple_loss:0.022428754717111588
loss_pred:0.0311757680028677, decouple_loss:0.02293984405696392
Iteration: 1297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451328217983246, gen p mean: 0.0, mean p set: 0.44964826107025146
The modified gen p mean: 0.4441547691822052, gen p mean: 0.0, mean p set: 0.44875115156173706
The modified gen p mean: 0.4465547204017639, gen p mean: 0.0, mean p set: 0.4469926357269287
loss_pred:0.03067787177860737, decouple_loss:0.02354349195957184
loss_pred:0.03198018670082092, decouple_loss:0.022700531408190727
loss_pred:0.03240180388092995, decouple_loss:0.022562149912118912
Iteration: 1298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007890462875366, gen p mean: 0.0, mean p set: 0.44740432500839233
The modified gen p mean: 0.45338162779808044, gen p mean: 0.0, mean p set: 0.447966605424881
The modified gen p mean: 0.45289188623428345, gen p mean: 0.0, mean p set: 0.4470318555831909
loss_pred:0.030714569613337517, decouple_loss:0.022472810000181198
loss_pred:0.030273674055933952, decouple_loss:0.022733086720108986
loss_pred:0.03078429214656353, decouple_loss:0.022232158109545708
Iteration: 1299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475846588611603, gen p mean: 0.0, mean p set: 0.4471312463283539
The modified gen p mean: 0.4489525258541107, gen p mean: 0.0, mean p set: 0.44834670424461365
The modified gen p mean: 0.4465200901031494, gen p mean: 0.0, mean p set: 0.4472857117652893
loss_pred:0.03060326911509037, decouple_loss:0.022551938891410828
loss_pred:0.03158697485923767, decouple_loss:0.022085832431912422
loss_pred:0.030429815873503685, decouple_loss:0.022275136783719063
Iteration: 1300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44032514095306396, gen p mean: 0.0, mean p set: 0.44762295484542847
The modified gen p mean: 0.4421040713787079, gen p mean: 0.0, mean p set: 0.44786328077316284
The modified gen p mean: 0.44420579075813293, gen p mean: 0.0, mean p set: 0.44892388582229614
loss_pred:0.03023148886859417, decouple_loss:0.021556220948696136loss_pred:0.03161872923374176, decouple_loss:0.02224116213619709
loss_pred:0.03265232965350151, decouple_loss:0.022641178220510483
2023-05-02 23:04:56 testing...
The modified gen p mean: 0.4449286460876465, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4547094702720642, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4516811966896057, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03259677067399025, decouple_loss:0.023109089583158493
loss_pred:0.03111494891345501, decouple_loss:0.022909825667738914
loss_pred:0.03166143596172333, decouple_loss:0.022490888833999634
WV_0_PC_0_EH_0_PS_40_6, loss: 0.032932884991168976, avg_mse: 0.03610599786043167
current test mse: 0.036106
Iteration: 1301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460587501525879, gen p mean: 0.0, mean p set: 0.44739779829978943
The modified gen p mean: 0.4462866187095642, gen p mean: 0.0, mean p set: 0.44777220487594604
loss_pred:0.031060567125678062, decouple_loss:0.02286524325609207
loss_pred:0.0310741625726223, decouple_loss:0.021801123395562172
The modified gen p mean: 0.4509675204753876, gen p mean: 0.0, mean p set: 0.4473719894886017
loss_pred:0.03174426034092903, decouple_loss:0.021805116906762123
Iteration: 1302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487118422985077, gen p mean: 0.0, mean p set: 0.44681257009506226
The modified gen p mean: 0.4480797052383423, gen p mean: 0.0, mean p set: 0.44973060488700867
The modified gen p mean: 0.44955170154571533, gen p mean: 0.0, mean p set: 0.4485260546207428
loss_pred:0.030736152082681656, decouple_loss:0.021593330428004265
loss_pred:0.030759211629629135, decouple_loss:0.021793479099869728
loss_pred:0.032114166766405106, decouple_loss:0.02187763899564743
Iteration: 1303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530973434448242, gen p mean: 0.0, mean p set: 0.44887736439704895
The modified gen p mean: 0.4503214657306671, gen p mean: 0.0, mean p set: 0.4492546021938324
The modified gen p mean: 0.45176583528518677, gen p mean: 0.0, mean p set: 0.44709280133247375
loss_pred:0.031277868896722794, decouple_loss:0.02102978527545929
loss_pred:0.030519364401698112, decouple_loss:0.021167555823922157
loss_pred:0.031244739890098572, decouple_loss:0.020740961655974388
Iteration: 1304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45486778020858765, gen p mean: 0.0, mean p set: 0.4475601017475128
The modified gen p mean: 0.44937649369239807, gen p mean: 0.0, mean p set: 0.448056697845459
The modified gen p mean: 0.4523569345474243, gen p mean: 0.0, mean p set: 0.4463326036930084
loss_pred:0.03151381015777588, decouple_loss:0.021664520725607872
loss_pred:0.030796457082033157, decouple_loss:0.02208215929567814
loss_pred:0.029773198068141937, decouple_loss:0.021717330440878868
Iteration: 1305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699913263320923, gen p mean: 0.0, mean p set: 0.44783279299736023
The modified gen p mean: 0.4428975582122803, gen p mean: 0.0, mean p set: 0.44703078269958496
The modified gen p mean: 0.44814932346343994, gen p mean: 0.0, mean p set: 0.44765836000442505
loss_pred:0.030586151406168938, decouple_loss:0.022093024104833603
loss_pred:0.03147866576910019, decouple_loss:0.02210874855518341
loss_pred:0.030799925327301025, decouple_loss:0.021752864122390747
Iteration: 1306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4417802095413208, gen p mean: 0.0, mean p set: 0.44924843311309814
The modified gen p mean: 0.4399752914905548, gen p mean: 0.0, mean p set: 0.4478478729724884
The modified gen p mean: 0.43638530373573303, gen p mean: 0.0, mean p set: 0.44834285974502563
loss_pred:0.03057611547410488, decouple_loss:0.021143725141882896
loss_pred:0.03058050386607647, decouple_loss:0.021628091111779213
loss_pred:0.03110606037080288, decouple_loss:0.022167949005961418
Iteration: 1307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499988555908203, gen p mean: 0.0, mean p set: 0.44718244671821594
The modified gen p mean: 0.45162543654441833, gen p mean: 0.0, mean p set: 0.4481556713581085
The modified gen p mean: 0.45277583599090576, gen p mean: 0.0, mean p set: 0.4466286599636078
loss_pred:0.030333686619997025, decouple_loss:0.021297773346304893
loss_pred:0.030787454918026924, decouple_loss:0.02167901210486889
loss_pred:0.03018351085484028, decouple_loss:0.021573802456259727
Iteration: 1308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44885218143463135, gen p mean: 0.0, mean p set: 0.4471190571784973
The modified gen p mean: 0.4524940252304077, gen p mean: 0.0, mean p set: 0.44864004850387573
The modified gen p mean: 0.44941285252571106, gen p mean: 0.0, mean p set: 0.44845691323280334
loss_pred:0.030290823429822922, decouple_loss:0.021176302805542946
loss_pred:0.031279053539037704, decouple_loss:0.021261395886540413
loss_pred:0.031621053814888, decouple_loss:0.020591454580426216
Iteration: 1309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739222526550293, gen p mean: 0.0, mean p set: 0.4480137526988983
The modified gen p mean: 0.4491133987903595, gen p mean: 0.0, mean p set: 0.4481663107872009
The modified gen p mean: 0.44669532775878906, gen p mean: 0.0, mean p set: 0.44600710272789
loss_pred:0.030908258631825447, decouple_loss:0.020811231806874275
loss_pred:0.031544871628284454, decouple_loss:0.0210488960146904
loss_pred:0.03162151202559471, decouple_loss:0.021009748801589012
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
NaN value num: 0
Iteration: 1310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44941598176956177, gen p mean: 0.0, mean p set: 0.4499594569206238
The modified gen p mean: 0.4509361684322357, gen p mean: 0.0, mean p set: 0.45222434401512146
The modified gen p mean: 0.448539137840271, gen p mean: 0.0, mean p set: 0.45091089606285095
loss_pred:0.03198744356632233, decouple_loss:0.0261993408203125
loss_pred:0.03178549185395241, decouple_loss:0.02612430416047573
loss_pred:0.03156055882573128, decouple_loss:0.026000317186117172
2023-05-02 23:09:29 testing...
The modified gen p mean: 0.4432504177093506, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4503178596496582, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45315539836883545, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.032566726207733154, decouple_loss:0.022760353982448578
loss_pred:0.03152243047952652, decouple_loss:0.0220122542232275
loss_pred:0.030939077958464622, decouple_loss:0.02260277420282364
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03279900178313255, avg_mse: 0.035980939865112305
current test mse: 0.035981
Iteration: 1311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500023126602173, gen p mean: 0.0, mean p set: 0.45202508568763733
The modified gen p mean: 0.4511730968952179, gen p mean: 0.0, mean p set: 0.4515767991542816
loss_pred:0.03477985039353371, decouple_loss:0.024860387668013573
loss_pred:0.030954882502555847, decouple_loss:0.024886278435587883
The modified gen p mean: 0.4519132375717163, gen p mean: 0.0, mean p set: 0.44901934266090393
loss_pred:0.03177144378423691, decouple_loss:0.024672793224453926
Iteration: 1312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4544639587402344, gen p mean: 0.0, mean p set: 0.4497230052947998
The modified gen p mean: 0.4544450044631958, gen p mean: 0.0, mean p set: 0.44993579387664795
The modified gen p mean: 0.4544695019721985, gen p mean: 0.0, mean p set: 0.45072001218795776
loss_pred:0.03185500577092171, decouple_loss:0.023184575140476227
loss_pred:0.03154908865690231, decouple_loss:0.023451324552297592
loss_pred:0.03225450962781906, decouple_loss:0.02414846420288086
Iteration: 1313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447099506855011, gen p mean: 0.0, mean p set: 0.4478597342967987
The modified gen p mean: 0.45036402344703674, gen p mean: 0.0, mean p set: 0.44904619455337524
The modified gen p mean: 0.4512254595756531, gen p mean: 0.0, mean p set: 0.4486435651779175
loss_pred:0.03279953822493553, decouple_loss:0.023475831374526024
loss_pred:0.03286927193403244, decouple_loss:0.023657510057091713
loss_pred:0.031197858974337578, decouple_loss:0.022772906348109245
Iteration: 1314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44407954812049866, gen p mean: 0.0, mean p set: 0.450888991355896
The modified gen p mean: 0.4457033574581146, gen p mean: 0.0, mean p set: 0.44829264283180237
The modified gen p mean: 0.44538500905036926, gen p mean: 0.0, mean p set: 0.45154598355293274
loss_pred:0.03168869391083717, decouple_loss:0.023895489051938057
loss_pred:0.032333966344594955, decouple_loss:0.02321033924818039
loss_pred:0.03161326423287392, decouple_loss:0.022821476683020592
Iteration: 1315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450745552778244, gen p mean: 0.0, mean p set: 0.4502522349357605
The modified gen p mean: 0.4500654637813568, gen p mean: 0.0, mean p set: 0.45127037167549133
The modified gen p mean: 0.4515480697154999, gen p mean: 0.0, mean p set: 0.44784078001976013
loss_pred:0.030772851780056953, decouple_loss:0.02410721406340599
loss_pred:0.03186986967921257, decouple_loss:0.022754352539777756
loss_pred:0.031805094331502914, decouple_loss:0.023436332121491432
Iteration: 1316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696080684661865, gen p mean: 0.0, mean p set: 0.4513324499130249
The modified gen p mean: 0.4463067352771759, gen p mean: 0.0, mean p set: 0.45031946897506714
The modified gen p mean: 0.44668594002723694, gen p mean: 0.0, mean p set: 0.4519057869911194
loss_pred:0.03213759884238243, decouple_loss:0.023460205644369125
loss_pred:0.03209271654486656, decouple_loss:0.023824552074074745
loss_pred:0.034613292664289474, decouple_loss:0.02273622900247574
Iteration: 1317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4609382450580597, gen p mean: 0.0, mean p set: 0.44943416118621826
The modified gen p mean: 0.45837029814720154, gen p mean: 0.0, mean p set: 0.4478350281715393
The modified gen p mean: 0.4587358832359314, gen p mean: 0.0, mean p set: 0.4494428038597107
loss_pred:0.031114758923649788, decouple_loss:0.022300828248262405
loss_pred:0.03217358514666557, decouple_loss:0.023407792672514915
loss_pred:0.03169599175453186, decouple_loss:0.022955911234021187
Iteration: 1318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487220346927643, gen p mean: 0.0, mean p set: 0.44967135787010193
The modified gen p mean: 0.4475523829460144, gen p mean: 0.0, mean p set: 0.4504237771034241
The modified gen p mean: 0.4488602578639984, gen p mean: 0.0, mean p set: 0.45075252652168274
loss_pred:0.03181583061814308, decouple_loss:0.02395811304450035
loss_pred:0.0312720350921154, decouple_loss:0.02332238107919693
loss_pred:0.03206321969628334, decouple_loss:0.023628737777471542
Iteration: 1319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4415992200374603, gen p mean: 0.0, mean p set: 0.44948288798332214
The modified gen p mean: 0.44603461027145386, gen p mean: 0.0, mean p set: 0.45079630613327026
The modified gen p mean: 0.44166988134384155, gen p mean: 0.0, mean p set: 0.44829609990119934
loss_pred:0.02995167300105095, decouple_loss:0.023148566484451294
loss_pred:0.030580606311559677, decouple_loss:0.022908009588718414
loss_pred:0.032538194209337234, decouple_loss:0.02409534528851509
Iteration: 1320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44373664259910583, gen p mean: 0.0, mean p set: 0.4509376883506775
The modified gen p mean: 0.44980934262275696, gen p mean: 0.0, mean p set: 0.4483225345611572
The modified gen p mean: 0.4493453800678253, gen p mean: 0.0, mean p set: 0.4489456117153168
loss_pred:0.032155923545360565, decouple_loss:0.02278139255940914
loss_pred:0.03294014558196068, decouple_loss:0.022892000153660774
loss_pred:0.031082430854439735, decouple_loss:0.022165557369589806
2023-05-02 23:13:11 testing...
The modified gen p mean: 0.4471077620983124, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4401765465736389, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44996902346611023, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.031741850078105927, decouple_loss:0.02433343231678009
loss_pred:0.03260073438286781, decouple_loss:0.025431077927350998
loss_pred:0.031121350824832916, decouple_loss:0.02488163858652115
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03306541591882706, avg_mse: 0.03636244311928749
current test mse: 0.036362
Iteration: 1321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521671235561371, gen p mean: 0.0, mean p set: 0.4483667314052582
The modified gen p mean: 0.4504953920841217, gen p mean: 0.0, mean p set: 0.44812071323394775
loss_pred:0.0322648249566555, decouple_loss:0.02222042717039585
loss_pred:0.03248918801546097, decouple_loss:0.021918242797255516
The modified gen p mean: 0.45355620980262756, gen p mean: 0.0, mean p set: 0.4496145248413086
loss_pred:0.032972730696201324, decouple_loss:0.022499293088912964
Iteration: 1322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113807916641235, gen p mean: 0.0, mean p set: 0.44971367716789246
The modified gen p mean: 0.4495411515235901, gen p mean: 0.0, mean p set: 0.45020708441734314
The modified gen p mean: 0.4491901099681854, gen p mean: 0.0, mean p set: 0.451111376285553
loss_pred:0.03294995799660683, decouple_loss:0.023045284673571587
loss_pred:0.03246605768799782, decouple_loss:0.02283291332423687
loss_pred:0.03068535402417183, decouple_loss:0.022349214181303978
Iteration: 1323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45423346757888794, gen p mean: 0.0, mean p set: 0.44938766956329346
The modified gen p mean: 0.455137699842453, gen p mean: 0.0, mean p set: 0.44937264919281006
The modified gen p mean: 0.4499058127403259, gen p mean: 0.0, mean p set: 0.4500446021556854
loss_pred:0.03078772872686386, decouple_loss:0.021709265187382698
loss_pred:0.03252505883574486, decouple_loss:0.022521287202835083
loss_pred:0.031280841678380966, decouple_loss:0.022939521819353104
Iteration: 1324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510670304298401, gen p mean: 0.0, mean p set: 0.44940370321273804
The modified gen p mean: 0.44593697786331177, gen p mean: 0.0, mean p set: 0.4500221312046051
The modified gen p mean: 0.4450516998767853, gen p mean: 0.0, mean p set: 0.45161086320877075
loss_pred:0.03217553347349167, decouple_loss:0.022337015718221664
loss_pred:0.029766948893666267, decouple_loss:0.022778145968914032
loss_pred:0.031551435589790344, decouple_loss:0.022511176764965057
Iteration: 1325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452962577342987, gen p mean: 0.0, mean p set: 0.4492756426334381
The modified gen p mean: 0.4381415843963623, gen p mean: 0.0, mean p set: 0.4499596655368805
The modified gen p mean: 0.43932318687438965, gen p mean: 0.0, mean p set: 0.4509623348712921
loss_pred:0.03308388963341713, decouple_loss:0.021616937592625618
loss_pred:0.03046758845448494, decouple_loss:0.022079389542341232
loss_pred:0.032331433147192, decouple_loss:0.022945305332541466
Iteration: 1326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45793431997299194, gen p mean: 0.0, mean p set: 0.4491138160228729
The modified gen p mean: 0.45857492089271545, gen p mean: 0.0, mean p set: 0.4499855935573578
The modified gen p mean: 0.4517143666744232, gen p mean: 0.0, mean p set: 0.45080891251564026
loss_pred:0.031621165573596954, decouple_loss:0.022964226081967354
loss_pred:0.030595915392041206, decouple_loss:0.02196512185037136
loss_pred:0.033202867954969406, decouple_loss:0.023944329470396042
Iteration: 1327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4591723382472992, gen p mean: 0.0, mean p set: 0.4482741951942444
The modified gen p mean: 0.45858731865882874, gen p mean: 0.0, mean p set: 0.45131269097328186
The modified gen p mean: 0.45899057388305664, gen p mean: 0.0, mean p set: 0.4526497423648834
loss_pred:0.03173607215285301, decouple_loss:0.02186444401741028
loss_pred:0.029603393748402596, decouple_loss:0.021812018007040024
loss_pred:0.030351856723427773, decouple_loss:0.02197383902966976
Iteration: 1328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4412133991718292, gen p mean: 0.0, mean p set: 0.4487208127975464
The modified gen p mean: 0.4399677515029907, gen p mean: 0.0, mean p set: 0.4508056342601776
The modified gen p mean: 0.43619123101234436, gen p mean: 0.0, mean p set: 0.45041805505752563
loss_pred:0.031345319002866745, decouple_loss:0.022378114983439445
loss_pred:0.029797567054629326, decouple_loss:0.021976813673973083
loss_pred:0.03083687834441662, decouple_loss:0.022223923355340958
Iteration: 1329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488689601421356, gen p mean: 0.0, mean p set: 0.4507228434085846
The modified gen p mean: 0.44779980182647705, gen p mean: 0.0, mean p set: 0.45011985301971436
The modified gen p mean: 0.44836732745170593, gen p mean: 0.0, mean p set: 0.4515925347805023
loss_pred:0.031702086329460144, decouple_loss:0.022469354793429375
loss_pred:0.030238846316933632, decouple_loss:0.021790040656924248
loss_pred:0.030429568141698837, decouple_loss:0.021202977746725082
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
NaN value num: 0
Iteration: 1330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45320025086402893, gen p mean: 0.0, mean p set: 0.4491514265537262
The modified gen p mean: 0.4538143575191498, gen p mean: 0.0, mean p set: 0.44829070568084717
The modified gen p mean: 0.4517914652824402, gen p mean: 0.0, mean p set: 0.4480431377887726
loss_pred:0.03302887827157974, decouple_loss:0.025669317692518234
loss_pred:0.03299049660563469, decouple_loss:0.025622691959142685
loss_pred:0.031077204272150993, decouple_loss:0.025124095380306244
2023-05-02 23:17:32 testing...
The modified gen p mean: 0.44567185640335083, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4524002969264984, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4554208517074585, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.032598160207271576, decouple_loss:0.02405235543847084
loss_pred:0.03181713446974754, decouple_loss:0.023334037512540817
loss_pred:0.031111549586057663, decouple_loss:0.02354288287460804
WV_0_PC_0_EH_0_PS_40_6, loss: 0.033024437725543976, avg_mse: 0.03640463203191757
current test mse: 0.036405
Iteration: 1331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026084780693054, gen p mean: 0.0, mean p set: 0.4470527172088623
The modified gen p mean: 0.44948551058769226, gen p mean: 0.0, mean p set: 0.44620317220687866
loss_pred:0.034499380737543106, decouple_loss:0.02431274577975273
loss_pred:0.031961288303136826, decouple_loss:0.02404954470694065
The modified gen p mean: 0.45195040106773376, gen p mean: 0.0, mean p set: 0.4463379681110382
loss_pred:0.03252122923731804, decouple_loss:0.02389136329293251
Iteration: 1332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507704973220825, gen p mean: 0.0, mean p set: 0.4467698633670807
The modified gen p mean: 0.44878047704696655, gen p mean: 0.0, mean p set: 0.44849663972854614
The modified gen p mean: 0.4446309506893158, gen p mean: 0.0, mean p set: 0.4489297568798065
loss_pred:0.0330042839050293, decouple_loss:0.02352888323366642
loss_pred:0.032664719969034195, decouple_loss:0.023005858063697815
loss_pred:0.03127654269337654, decouple_loss:0.023949528113007545
Iteration: 1333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45545607805252075, gen p mean: 0.0, mean p set: 0.4471152722835541
The modified gen p mean: 0.4553031921386719, gen p mean: 0.0, mean p set: 0.44753962755203247
The modified gen p mean: 0.45173874497413635, gen p mean: 0.0, mean p set: 0.4484526515007019
loss_pred:0.032540254294872284, decouple_loss:0.023661112412810326
loss_pred:0.03262292221188545, decouple_loss:0.023548400029540062
loss_pred:0.032418183982372284, decouple_loss:0.022917570546269417
Iteration: 1334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4353329539299011, gen p mean: 0.0, mean p set: 0.44858479499816895
The modified gen p mean: 0.4315514862537384, gen p mean: 0.0, mean p set: 0.44939130544662476
The modified gen p mean: 0.4346412122249603, gen p mean: 0.0, mean p set: 0.4481962025165558
loss_pred:0.03193213790655136, decouple_loss:0.022756103426218033
loss_pred:0.03246935456991196, decouple_loss:0.02296484261751175
loss_pred:0.033072520047426224, decouple_loss:0.022382725030183792
Iteration: 1335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43547677993774414, gen p mean: 0.0, mean p set: 0.4473547637462616
The modified gen p mean: 0.4409371018409729, gen p mean: 0.0, mean p set: 0.44693848490715027
The modified gen p mean: 0.44250985980033875, gen p mean: 0.0, mean p set: 0.44834673404693604
loss_pred:0.030814742669463158, decouple_loss:0.02296954020857811
loss_pred:0.032812800258398056, decouple_loss:0.02216506563127041
loss_pred:0.03209204599261284, decouple_loss:0.022660313174128532
Iteration: 1336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4559049606323242, gen p mean: 0.0, mean p set: 0.4483281373977661
The modified gen p mean: 0.4661751389503479, gen p mean: 0.0, mean p set: 0.44820523262023926
The modified gen p mean: 0.46181076765060425, gen p mean: 0.0, mean p set: 0.44660601019859314
loss_pred:0.03229477256536484, decouple_loss:0.024180818349123
loss_pred:0.03325508162379265, decouple_loss:0.023030314594507217
loss_pred:0.030846944078803062, decouple_loss:0.02292921021580696
Iteration: 1337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4567314386367798, gen p mean: 0.0, mean p set: 0.44836893677711487
The modified gen p mean: 0.45578664541244507, gen p mean: 0.0, mean p set: 0.44682762026786804
The modified gen p mean: 0.45460420846939087, gen p mean: 0.0, mean p set: 0.44728490710258484
loss_pred:0.03179561346769333, decouple_loss:0.02197679504752159
loss_pred:0.0306403785943985, decouple_loss:0.023887874558568
loss_pred:0.030902456492185593, decouple_loss:0.023930778726935387
Iteration: 1338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43518978357315063, gen p mean: 0.0, mean p set: 0.4471314251422882
The modified gen p mean: 0.43659961223602295, gen p mean: 0.0, mean p set: 0.447655588388443
The modified gen p mean: 0.44030243158340454, gen p mean: 0.0, mean p set: 0.44717973470687866
loss_pred:0.03162095695734024, decouple_loss:0.024139579385519028
loss_pred:0.032664697617292404, decouple_loss:0.0235336571931839
loss_pred:0.03303656727075577, decouple_loss:0.022767452523112297
Iteration: 1339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44071465730667114, gen p mean: 0.0, mean p set: 0.44701069593429565
The modified gen p mean: 0.4458601176738739, gen p mean: 0.0, mean p set: 0.44771823287010193
The modified gen p mean: 0.4470410645008087, gen p mean: 0.0, mean p set: 0.44684910774230957
loss_pred:0.030794089660048485, decouple_loss:0.022907793521881104
loss_pred:0.0326453298330307, decouple_loss:0.022636687383055687
loss_pred:0.03212844952940941, decouple_loss:0.022435039281845093
Iteration: 1340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538646936416626, gen p mean: 0.0, mean p set: 0.44859179854393005
The modified gen p mean: 0.4529135525226593, gen p mean: 0.0, mean p set: 0.44750040769577026
The modified gen p mean: 0.45123523473739624, gen p mean: 0.0, mean p set: 0.4482213854789734
loss_pred:0.030735088512301445, decouple_loss:0.02251889556646347
loss_pred:0.03251845762133598, decouple_loss:0.022084916010499
loss_pred:0.030576439574360847, decouple_loss:0.023295637220144272
2023-05-02 23:21:17 testing...
The modified gen p mean: 0.4439973533153534, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4474567770957947, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.43748462200164795, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.03145335987210274, decouple_loss:0.023090727627277374
loss_pred:0.03080163709819317, decouple_loss:0.023881228640675545
loss_pred:0.03239560127258301, decouple_loss:0.023244807496666908
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03272048383951187, avg_mse: 0.03598760813474655
current test mse: 0.035988
Iteration: 1341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4392516016960144, gen p mean: 0.0, mean p set: 0.4477632939815521
The modified gen p mean: 0.4392755627632141, gen p mean: 0.0, mean p set: 0.4495074450969696
loss_pred:0.03209461644291878, decouple_loss:0.023107293993234634
loss_pred:0.03185346722602844, decouple_loss:0.023624077439308167
The modified gen p mean: 0.4420853555202484, gen p mean: 0.0, mean p set: 0.448716402053833
loss_pred:0.030174849554896355, decouple_loss:0.02295982837677002
Iteration: 1342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469786584377289, gen p mean: 0.0, mean p set: 0.44789600372314453
The modified gen p mean: 0.4511456787586212, gen p mean: 0.0, mean p set: 0.4486939311027527
The modified gen p mean: 0.4514547288417816, gen p mean: 0.0, mean p set: 0.4483358860015869
loss_pred:0.03257359564304352, decouple_loss:0.023048892617225647
loss_pred:0.03286067023873329, decouple_loss:0.022021716460585594
loss_pred:0.0322430245578289, decouple_loss:0.021943984553217888
Iteration: 1343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45479536056518555, gen p mean: 0.0, mean p set: 0.4482572078704834
The modified gen p mean: 0.4481201767921448, gen p mean: 0.0, mean p set: 0.44750818610191345
The modified gen p mean: 0.45309963822364807, gen p mean: 0.0, mean p set: 0.447354793548584
loss_pred:0.032875705510377884, decouple_loss:0.021543221548199654
loss_pred:0.0312541164457798, decouple_loss:0.022390171885490417
loss_pred:0.03308027982711792, decouple_loss:0.022310569882392883
Iteration: 1344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483921229839325, gen p mean: 0.0, mean p set: 0.4473206102848053
The modified gen p mean: 0.453101247549057, gen p mean: 0.0, mean p set: 0.4484597444534302
The modified gen p mean: 0.44416987895965576, gen p mean: 0.0, mean p set: 0.4475308060646057
loss_pred:0.03324361518025398, decouple_loss:0.022219428792595863
loss_pred:0.03229375556111336, decouple_loss:0.021478751674294472
loss_pred:0.031242281198501587, decouple_loss:0.022838424891233444
Iteration: 1345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4405278265476227, gen p mean: 0.0, mean p set: 0.44742879271507263
The modified gen p mean: 0.4447479248046875, gen p mean: 0.0, mean p set: 0.4476478397846222
The modified gen p mean: 0.43918541073799133, gen p mean: 0.0, mean p set: 0.4473278820514679
loss_pred:0.033323053270578384, decouple_loss:0.022106029093265533
loss_pred:0.03218573331832886, decouple_loss:0.02182108536362648
loss_pred:0.03252425417304039, decouple_loss:0.02174854464828968
Iteration: 1346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4393542408943176, gen p mean: 0.0, mean p set: 0.4475935399532318
The modified gen p mean: 0.44135767221450806, gen p mean: 0.0, mean p set: 0.44764068722724915
The modified gen p mean: 0.44150206446647644, gen p mean: 0.0, mean p set: 0.448288232088089
loss_pred:0.03129196539521217, decouple_loss:0.022512415423989296
loss_pred:0.03112730383872986, decouple_loss:0.02297223173081875
loss_pred:0.03142081946134567, decouple_loss:0.023412391543388367
Iteration: 1347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4570468068122864, gen p mean: 0.0, mean p set: 0.4489063620567322
The modified gen p mean: 0.4629141390323639, gen p mean: 0.0, mean p set: 0.44863173365592957
The modified gen p mean: 0.46152833104133606, gen p mean: 0.0, mean p set: 0.4473547041416168
loss_pred:0.032179273664951324, decouple_loss:0.022250106558203697
loss_pred:0.03139379620552063, decouple_loss:0.02184976264834404
loss_pred:0.03200840950012207, decouple_loss:0.021278677508234978
Iteration: 1348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782933592796326, gen p mean: 0.0, mean p set: 0.4480331242084503
The modified gen p mean: 0.4449552297592163, gen p mean: 0.0, mean p set: 0.4478229880332947
The modified gen p mean: 0.4439205527305603, gen p mean: 0.0, mean p set: 0.44940972328186035
loss_pred:0.030668742954730988, decouple_loss:0.021594181656837463
loss_pred:0.03089483082294464, decouple_loss:0.021338529884815216
loss_pred:0.030591167509555817, decouple_loss:0.0221102274954319
Iteration: 1349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44430652260780334, gen p mean: 0.0, mean p set: 0.4475752115249634
The modified gen p mean: 0.453436940908432, gen p mean: 0.0, mean p set: 0.44824421405792236
The modified gen p mean: 0.4480070471763611, gen p mean: 0.0, mean p set: 0.4481023848056793
loss_pred:0.03060322068631649, decouple_loss:0.020902186632156372
loss_pred:0.0329974964261055, decouple_loss:0.02117258682847023
loss_pred:0.0323328822851181, decouple_loss:0.0217719916254282
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 1350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45803678035736084, gen p mean: 0.0, mean p set: 0.44830334186553955
The modified gen p mean: 0.4579150378704071, gen p mean: 0.0, mean p set: 0.44770386815071106
The modified gen p mean: 0.45350906252861023, gen p mean: 0.0, mean p set: 0.44762441515922546
loss_pred:0.03166695311665535, decouple_loss:0.022031987085938454loss_pred:0.03201153129339218, decouple_loss:0.024584364145994186
loss_pred:0.0324753001332283, decouple_loss:0.02325419709086418
2023-05-02 23:25:42 testing...
The modified gen p mean: 0.4366052746772766, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4430178105831146, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4468853175640106, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03224441036581993, decouple_loss:0.022198036313056946
loss_pred:0.03133057430386543, decouple_loss:0.021795140579342842
loss_pred:0.030669696629047394, decouple_loss:0.02250790223479271
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03252324461936951, avg_mse: 0.035859331488609314
current test mse: 0.035859
Iteration: 1351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452303349971771, gen p mean: 0.0, mean p set: 0.44737890362739563
The modified gen p mean: 0.44183409214019775, gen p mean: 0.0, mean p set: 0.448443204164505
loss_pred:0.031850218772888184, decouple_loss:0.023497331887483597
loss_pred:0.030704418197274208, decouple_loss:0.02284444309771061
The modified gen p mean: 0.44595468044281006, gen p mean: 0.0, mean p set: 0.4474763870239258
loss_pred:0.0323881097137928, decouple_loss:0.02293064258992672
Iteration: 1352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4385364353656769, gen p mean: 0.0, mean p set: 0.4472118318080902The modified gen p mean: 0.438402384519577, gen p mean: 0.0, mean p set: 0.4470519721508026
The modified gen p mean: 0.4388335347175598, gen p mean: 0.0, mean p set: 0.44800183176994324
loss_pred:0.03155644237995148, decouple_loss:0.022831056267023087loss_pred:0.03194035589694977, decouple_loss:0.02202165685594082
loss_pred:0.0318748876452446, decouple_loss:0.021836960688233376
Iteration: 1353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4546535313129425, gen p mean: 0.0, mean p set: 0.44888588786125183
The modified gen p mean: 0.44945865869522095, gen p mean: 0.0, mean p set: 0.4482389986515045
The modified gen p mean: 0.4497203826904297, gen p mean: 0.0, mean p set: 0.4477570950984955
loss_pred:0.030858412384986877, decouple_loss:0.023165961727499962
loss_pred:0.03137094900012016, decouple_loss:0.02148214541375637
loss_pred:0.032497238367795944, decouple_loss:0.02262304164469242
Iteration: 1354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45426538586616516, gen p mean: 0.0, mean p set: 0.4476523995399475
The modified gen p mean: 0.4556705355644226, gen p mean: 0.0, mean p set: 0.448486864566803
The modified gen p mean: 0.4550614655017853, gen p mean: 0.0, mean p set: 0.4490576982498169
loss_pred:0.032224420458078384, decouple_loss:0.02192450873553753
loss_pred:0.031079543754458427, decouple_loss:0.022357670590281487
loss_pred:0.0304615069180727, decouple_loss:0.02170802839100361
Iteration: 1355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44562920928001404, gen p mean: 0.0, mean p set: 0.4478378891944885
The modified gen p mean: 0.44340696930885315, gen p mean: 0.0, mean p set: 0.44783034920692444
The modified gen p mean: 0.4430941045284271, gen p mean: 0.0, mean p set: 0.44794946908950806
loss_pred:0.031145991757512093, decouple_loss:0.020985234528779984
loss_pred:0.03170597925782204, decouple_loss:0.021433819085359573
loss_pred:0.03129211813211441, decouple_loss:0.02257666550576687
Iteration: 1356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722050428390503, gen p mean: 0.0, mean p set: 0.44966015219688416
The modified gen p mean: 0.44469940662384033, gen p mean: 0.0, mean p set: 0.44869139790534973
The modified gen p mean: 0.44044405221939087, gen p mean: 0.0, mean p set: 0.448304146528244
loss_pred:0.03066365234553814, decouple_loss:0.02277260832488537
loss_pred:0.03026505559682846, decouple_loss:0.022402286529541016
loss_pred:0.03193054720759392, decouple_loss:0.022330068051815033
Iteration: 1357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520524740219116, gen p mean: 0.0, mean p set: 0.44759440422058105
The modified gen p mean: 0.45508596301078796, gen p mean: 0.0, mean p set: 0.4471273422241211
The modified gen p mean: 0.45526859164237976, gen p mean: 0.0, mean p set: 0.44860947132110596
loss_pred:0.030992833897471428, decouple_loss:0.021144362166523933
loss_pred:0.032063860446214676, decouple_loss:0.021838169544935226
loss_pred:0.030924353748559952, decouple_loss:0.021853791549801826
Iteration: 1358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502679109573364, gen p mean: 0.0, mean p set: 0.44866064190864563
The modified gen p mean: 0.44986429810523987, gen p mean: 0.0, mean p set: 0.447422593832016
The modified gen p mean: 0.44697681069374084, gen p mean: 0.0, mean p set: 0.4476398825645447
loss_pred:0.031034793704748154, decouple_loss:0.021501487120985985
loss_pred:0.031040864065289497, decouple_loss:0.021471286192536354
loss_pred:0.03100561909377575, decouple_loss:0.020230187103152275
Iteration: 1359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4388470947742462, gen p mean: 0.0, mean p set: 0.448910653591156
The modified gen p mean: 0.4407106339931488, gen p mean: 0.0, mean p set: 0.4486064314842224
The modified gen p mean: 0.43277493119239807, gen p mean: 0.0, mean p set: 0.4487426280975342
loss_pred:0.030666830018162727, decouple_loss:0.021365100517868996
loss_pred:0.029993325471878052, decouple_loss:0.021421357989311218
loss_pred:0.031857702881097794, decouple_loss:0.021729452535510063
Iteration: 1360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065340399742126, gen p mean: 0.0, mean p set: 0.44896969199180603
The modified gen p mean: 0.4510038495063782, gen p mean: 0.0, mean p set: 0.4473787844181061
The modified gen p mean: 0.4519917070865631, gen p mean: 0.0, mean p set: 0.4469318985939026
loss_pred:0.031118014827370644, decouple_loss:0.02188517339527607
loss_pred:0.031711332499980927, decouple_loss:0.02165163680911064
loss_pred:0.03266340494155884, decouple_loss:0.021940240636467934
2023-05-02 23:29:23 testing...
The modified gen p mean: 0.46041032671928406, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4540514349937439, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4642582833766937, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03107418306171894, decouple_loss:0.021120229735970497
loss_pred:0.03199927881360054, decouple_loss:0.02155451662838459
loss_pred:0.030409110710024834, decouple_loss:0.02148059941828251
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03223011642694473, avg_mse: 0.035470619797706604
current test mse: 0.035471
Iteration: 1361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4558973014354706, gen p mean: 0.0, mean p set: 0.4477013349533081
The modified gen p mean: 0.4637244939804077, gen p mean: 0.0, mean p set: 0.4471501410007477
loss_pred:0.031194141134619713, decouple_loss:0.02071181684732437
loss_pred:0.031471796333789825, decouple_loss:0.022141696885228157
The modified gen p mean: 0.4582001268863678, gen p mean: 0.0, mean p set: 0.44768473505973816
loss_pred:0.03183184564113617, decouple_loss:0.021386263892054558
Iteration: 1362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466615617275238, gen p mean: 0.0, mean p set: 0.4477039873600006
The modified gen p mean: 0.44271716475486755, gen p mean: 0.0, mean p set: 0.4491487443447113
The modified gen p mean: 0.44461071491241455, gen p mean: 0.0, mean p set: 0.449325829744339
loss_pred:0.02982117421925068, decouple_loss:0.02080615982413292
loss_pred:0.030793597921729088, decouple_loss:0.02110867202281952
loss_pred:0.02995448373258114, decouple_loss:0.021837100386619568
Iteration: 1363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4376169741153717, gen p mean: 0.0, mean p set: 0.44800394773483276The modified gen p mean: 0.4369787275791168, gen p mean: 0.0, mean p set: 0.44758692383766174
The modified gen p mean: 0.43612417578697205, gen p mean: 0.0, mean p set: 0.4481172263622284
loss_pred:0.03205360099673271, decouple_loss:0.020462773740291595loss_pred:0.032379213720560074, decouple_loss:0.021459482610225677
loss_pred:0.03115065023303032, decouple_loss:0.02079162374138832
Iteration: 1364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45818617939949036, gen p mean: 0.0, mean p set: 0.44789108633995056
The modified gen p mean: 0.45699456334114075, gen p mean: 0.0, mean p set: 0.448081910610199
The modified gen p mean: 0.4566866159439087, gen p mean: 0.0, mean p set: 0.4481918513774872
loss_pred:0.0325721800327301, decouple_loss:0.02266586199402809
loss_pred:0.03218274563550949, decouple_loss:0.020350094884634018
loss_pred:0.031120959669351578, decouple_loss:0.02108984999358654
Iteration: 1365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45648083090782166, gen p mean: 0.0, mean p set: 0.4486024081707001
The modified gen p mean: 0.45599958300590515, gen p mean: 0.0, mean p set: 0.44830429553985596
The modified gen p mean: 0.4596455693244934, gen p mean: 0.0, mean p set: 0.4476620554924011
loss_pred:0.031474966555833817, decouple_loss:0.02028924785554409
loss_pred:0.030420957133173943, decouple_loss:0.02101658284664154
loss_pred:0.032079312950372696, decouple_loss:0.02086411789059639
Iteration: 1366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.438519686460495, gen p mean: 0.0, mean p set: 0.44924864172935486
The modified gen p mean: 0.44021186232566833, gen p mean: 0.0, mean p set: 0.4477090537548065
The modified gen p mean: 0.4419378936290741, gen p mean: 0.0, mean p set: 0.4479982852935791
loss_pred:0.03071286343038082, decouple_loss:0.02092886157333851
loss_pred:0.030508313328027725, decouple_loss:0.020307810977101326
loss_pred:0.029835235327482224, decouple_loss:0.020360669121146202
Iteration: 1367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4388061463832855, gen p mean: 0.0, mean p set: 0.4485662877559662
The modified gen p mean: 0.43546780943870544, gen p mean: 0.0, mean p set: 0.4483886957168579
The modified gen p mean: 0.4424739480018616, gen p mean: 0.0, mean p set: 0.4482576549053192
loss_pred:0.03014720417559147, decouple_loss:0.02028215304017067
loss_pred:0.03076590783894062, decouple_loss:0.020727986469864845
loss_pred:0.03179466351866722, decouple_loss:0.0201796256005764
Iteration: 1368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.455383837223053, gen p mean: 0.0, mean p set: 0.4473388195037842
The modified gen p mean: 0.4589274823665619, gen p mean: 0.0, mean p set: 0.44941452145576477
The modified gen p mean: 0.4552532136440277, gen p mean: 0.0, mean p set: 0.44853144884109497
loss_pred:0.03091863915324211, decouple_loss:0.02095990628004074
loss_pred:0.030747458338737488, decouple_loss:0.02048332802951336
loss_pred:0.03105088882148266, decouple_loss:0.02116367779672146
Iteration: 1369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45552709698677063, gen p mean: 0.0, mean p set: 0.4485197067260742
The modified gen p mean: 0.4482303261756897, gen p mean: 0.0, mean p set: 0.44880568981170654
The modified gen p mean: 0.45308586955070496, gen p mean: 0.0, mean p set: 0.44897186756134033
loss_pred:0.02954789809882641, decouple_loss:0.019994482398033142
loss_pred:0.030761215835809708, decouple_loss:0.020545510575175285
loss_pred:0.03190556541085243, decouple_loss:0.021062703803181648
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
NaN value num: 0
Iteration: 1370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43997588753700256, gen p mean: 0.0, mean p set: 0.45130327343940735
The modified gen p mean: 0.44474202394485474, gen p mean: 0.0, mean p set: 0.4518289566040039
The modified gen p mean: 0.43637749552726746, gen p mean: 0.0, mean p set: 0.4493304491043091
loss_pred:0.029335185885429382, decouple_loss:0.02428625337779522
loss_pred:0.030743634328246117, decouple_loss:0.02387542836368084
loss_pred:0.03079003468155861, decouple_loss:0.02270124852657318
2023-05-02 23:33:47 testing...
The modified gen p mean: 0.45393291115760803, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4605499804019928, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.46385306119918823, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.032027795910835266, decouple_loss:0.02102341130375862
loss_pred:0.03113723173737526, decouple_loss:0.020957181230187416
loss_pred:0.030575541779398918, decouple_loss:0.021058741956949234
WV_0_PC_0_EH_0_PS_40_6, loss: 0.032297514379024506, avg_mse: 0.03567706048488617
current test mse: 0.035677
Iteration: 1371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46092063188552856, gen p mean: 0.0, mean p set: 0.45195427536964417
loss_pred:0.029681727290153503, decouple_loss:0.02321644499897957
The modified gen p mean: 0.4574412703514099, gen p mean: 0.0, mean p set: 0.4533640444278717
loss_pred:0.03041507676243782, decouple_loss:0.023169362917542458
The modified gen p mean: 0.4653792381286621, gen p mean: 0.0, mean p set: 0.4506407380104065
loss_pred:0.030261779204010963, decouple_loss:0.023370342329144478
Iteration: 1372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518558084964752, gen p mean: 0.0, mean p set: 0.4501676559448242
The modified gen p mean: 0.45585355162620544, gen p mean: 0.0, mean p set: 0.45162567496299744
The modified gen p mean: 0.4525434076786041, gen p mean: 0.0, mean p set: 0.44922778010368347
loss_pred:0.03128772974014282, decouple_loss:0.02261413261294365
loss_pred:0.03159467875957489, decouple_loss:0.02289150469005108
loss_pred:0.030543692409992218, decouple_loss:0.021507710218429565
Iteration: 1373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4428975582122803, gen p mean: 0.0, mean p set: 0.44940266013145447
The modified gen p mean: 0.4422588348388672, gen p mean: 0.0, mean p set: 0.4498729407787323
The modified gen p mean: 0.4434524476528168, gen p mean: 0.0, mean p set: 0.4517051577568054
loss_pred:0.029849469661712646, decouple_loss:0.021836932748556137
loss_pred:0.031409576535224915, decouple_loss:0.021307513117790222
loss_pred:0.029882419854402542, decouple_loss:0.022741209715604782
Iteration: 1374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.443379282951355, gen p mean: 0.0, mean p set: 0.45075374841690063
The modified gen p mean: 0.4415779411792755, gen p mean: 0.0, mean p set: 0.4516025483608246
The modified gen p mean: 0.44936203956604004, gen p mean: 0.0, mean p set: 0.4514331519603729
loss_pred:0.031320732086896896, decouple_loss:0.021488912403583527
loss_pred:0.03149691969156265, decouple_loss:0.022501878440380096
loss_pred:0.029998308047652245, decouple_loss:0.021585162729024887
Iteration: 1375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46475034952163696, gen p mean: 0.0, mean p set: 0.4517160654067993
The modified gen p mean: 0.462467759847641, gen p mean: 0.0, mean p set: 0.44998836517333984
The modified gen p mean: 0.46205592155456543, gen p mean: 0.0, mean p set: 0.45333418250083923
loss_pred:0.03061784617602825, decouple_loss:0.021760521456599236
loss_pred:0.030688650906085968, decouple_loss:0.020764915272593498
loss_pred:0.02975766733288765, decouple_loss:0.021476125344634056
Iteration: 1376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44573748111724854, gen p mean: 0.0, mean p set: 0.45208731293678284
The modified gen p mean: 0.4466477334499359, gen p mean: 0.0, mean p set: 0.4498688280582428
The modified gen p mean: 0.4469833970069885, gen p mean: 0.0, mean p set: 0.45198073983192444
loss_pred:0.031051339581608772, decouple_loss:0.02214958518743515
loss_pred:0.030045708641409874, decouple_loss:0.020093053579330444
loss_pred:0.030706867575645447, decouple_loss:0.022661272436380386
Iteration: 1377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457312226295471, gen p mean: 0.0, mean p set: 0.4512324035167694
The modified gen p mean: 0.4464244544506073, gen p mean: 0.0, mean p set: 0.4501752555370331
The modified gen p mean: 0.4402436316013336, gen p mean: 0.0, mean p set: 0.4504731595516205
loss_pred:0.02984076924622059, decouple_loss:0.021219536662101746
loss_pred:0.030852600932121277, decouple_loss:0.022266745567321777
loss_pred:0.030852289870381355, decouple_loss:0.021211065351963043
Iteration: 1378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4607553780078888, gen p mean: 0.0, mean p set: 0.4498332440853119
The modified gen p mean: 0.45126408338546753, gen p mean: 0.0, mean p set: 0.4509674608707428
The modified gen p mean: 0.4545339345932007, gen p mean: 0.0, mean p set: 0.45029211044311523
loss_pred:0.030098596587777138, decouple_loss:0.021349705755710602
loss_pred:0.03040732443332672, decouple_loss:0.021319905295968056
loss_pred:0.03079931065440178, decouple_loss:0.02141398750245571
Iteration: 1379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45376119017601013, gen p mean: 0.0, mean p set: 0.45326003432273865
The modified gen p mean: 0.45490631461143494, gen p mean: 0.0, mean p set: 0.4524591267108917
The modified gen p mean: 0.44735825061798096, gen p mean: 0.0, mean p set: 0.4504474103450775
loss_pred:0.030522223562002182, decouple_loss:0.021532170474529266
loss_pred:0.030050845816731453, decouple_loss:0.021240558475255966
loss_pred:0.03026939183473587, decouple_loss:0.021892249584197998
Iteration: 1380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530825614929199, gen p mean: 0.0, mean p set: 0.4517599642276764
The modified gen p mean: 0.44886672496795654, gen p mean: 0.0, mean p set: 0.45262959599494934
The modified gen p mean: 0.4473063349723816, gen p mean: 0.0, mean p set: 0.4516368806362152
loss_pred:0.02918391302227974, decouple_loss:0.022704187780618668
loss_pred:0.02996348962187767, decouple_loss:0.021907877177000046
loss_pred:0.03128547593951225, decouple_loss:0.02214209921658039
2023-05-02 23:37:31 testing...
The modified gen p mean: 0.4445439279079437, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45355692505836487, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.45066434144973755, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03209303691983223, decouple_loss:0.02308673970401287
loss_pred:0.03054800070822239, decouple_loss:0.023062745109200478
loss_pred:0.03112308494746685, decouple_loss:0.022902799770236015
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03240558132529259, avg_mse: 0.035799380391836166
current test mse: 0.035799
Iteration: 1381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485016167163849, gen p mean: 0.0, mean p set: 0.4519321024417877
loss_pred:0.03047565370798111, decouple_loss:0.02163523994386196
The modified gen p mean: 0.44959479570388794, gen p mean: 0.0, mean p set: 0.45026808977127075
loss_pred:0.03066173754632473, decouple_loss:0.02082058973610401
The modified gen p mean: 0.44757792353630066, gen p mean: 0.0, mean p set: 0.4510645270347595
loss_pred:0.030348755419254303, decouple_loss:0.020960073918104172
Iteration: 1382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529590308666229, gen p mean: 0.0, mean p set: 0.44862014055252075
The modified gen p mean: 0.45910340547561646, gen p mean: 0.0, mean p set: 0.45197638869285583
The modified gen p mean: 0.45495277643203735, gen p mean: 0.0, mean p set: 0.4519873261451721
loss_pred:0.030159547924995422, decouple_loss:0.021254971623420715
loss_pred:0.029174743220210075, decouple_loss:0.02096385508775711
loss_pred:0.031194819137454033, decouple_loss:0.020887410268187523
Iteration: 1383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45155298709869385, gen p mean: 0.0, mean p set: 0.4518211781978607
The modified gen p mean: 0.4533441364765167, gen p mean: 0.0, mean p set: 0.4503476321697235
The modified gen p mean: 0.44798925518989563, gen p mean: 0.0, mean p set: 0.45039960741996765
loss_pred:0.03100336715579033, decouple_loss:0.022165466099977493
loss_pred:0.02948700077831745, decouple_loss:0.020999159663915634
loss_pred:0.030699821189045906, decouple_loss:0.020875530317425728
Iteration: 1384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.439692884683609, gen p mean: 0.0, mean p set: 0.45022279024124146
The modified gen p mean: 0.43975144624710083, gen p mean: 0.0, mean p set: 0.449952095746994
The modified gen p mean: 0.4379987120628357, gen p mean: 0.0, mean p set: 0.4533170461654663
loss_pred:0.03028079867362976, decouple_loss:0.020186344161629677
loss_pred:0.029520917683839798, decouple_loss:0.020694198086857796
loss_pred:0.02952134609222412, decouple_loss:0.020595643669366837
Iteration: 1385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862568378448486, gen p mean: 0.0, mean p set: 0.45087674260139465
The modified gen p mean: 0.4522767961025238, gen p mean: 0.0, mean p set: 0.4516620337963104
The modified gen p mean: 0.4427567720413208, gen p mean: 0.0, mean p set: 0.45022377371788025
loss_pred:0.03134985268115997, decouple_loss:0.020547622814774513
loss_pred:0.029264124110341072, decouple_loss:0.021604903042316437
loss_pred:0.030082769691944122, decouple_loss:0.0206123236566782
Iteration: 1386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46776482462882996, gen p mean: 0.0, mean p set: 0.4520314931869507
The modified gen p mean: 0.47037383913993835, gen p mean: 0.0, mean p set: 0.44953182339668274
The modified gen p mean: 0.4687172770500183, gen p mean: 0.0, mean p set: 0.45175832509994507
loss_pred:0.02980703115463257, decouple_loss:0.02111120894551277
loss_pred:0.02966148592531681, decouple_loss:0.02154572121798992
loss_pred:0.030425310134887695, decouple_loss:0.020394159480929375
Iteration: 1387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044320821762085, gen p mean: 0.0, mean p set: 0.4518939256668091
The modified gen p mean: 0.45611536502838135, gen p mean: 0.0, mean p set: 0.4497356712818146
The modified gen p mean: 0.45106104016304016, gen p mean: 0.0, mean p set: 0.4521452486515045
loss_pred:0.030324334278702736, decouple_loss:0.020687516778707504
loss_pred:0.029308781027793884, decouple_loss:0.02057020552456379
loss_pred:0.029968973249197006, decouple_loss:0.01985243149101734
Iteration: 1388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4325233995914459, gen p mean: 0.0, mean p set: 0.448142409324646
The modified gen p mean: 0.4339970052242279, gen p mean: 0.0, mean p set: 0.45028162002563477
The modified gen p mean: 0.43473199009895325, gen p mean: 0.0, mean p set: 0.4499163329601288
loss_pred:0.030644841492176056, decouple_loss:0.02076219581067562
loss_pred:0.030711933970451355, decouple_loss:0.02041974477469921
loss_pred:0.031485434621572495, decouple_loss:0.02035083808004856
Iteration: 1389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080259442329407, gen p mean: 0.0, mean p set: 0.4523191750049591
The modified gen p mean: 0.45433446764945984, gen p mean: 0.0, mean p set: 0.44951876997947693
The modified gen p mean: 0.45032188296318054, gen p mean: 0.0, mean p set: 0.4495701789855957
loss_pred:0.030622681602835655, decouple_loss:0.02046218141913414
loss_pred:0.029410602524876595, decouple_loss:0.020409652963280678
loss_pred:0.030844347551465034, decouple_loss:0.019907869398593903
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
NaN value num: 0
Iteration: 1390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4621347188949585, gen p mean: 0.0, mean p set: 0.4520217776298523
The modified gen p mean: 0.4580099582672119, gen p mean: 0.0, mean p set: 0.4526849389076233
The modified gen p mean: 0.4597282409667969, gen p mean: 0.0, mean p set: 0.4525681734085083
loss_pred:0.031805846840143204, decouple_loss:0.02257579378783703
loss_pred:0.030576037243008614, decouple_loss:0.021957125514745712
loss_pred:0.03077491745352745, decouple_loss:0.023648355156183243
2023-05-02 23:41:57 testing...
The modified gen p mean: 0.4410441517829895, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45067650079727173, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44756680727005005, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03213959559798241, decouple_loss:0.022428249940276146
loss_pred:0.030573956668376923, decouple_loss:0.022436361759901047
loss_pred:0.031065914779901505, decouple_loss:0.022095980122685432
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03237583488225937, avg_mse: 0.035883061587810516
current test mse: 0.035883
Iteration: 1391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44614940881729126, gen p mean: 0.0, mean p set: 0.4506986141204834
The modified gen p mean: 0.44673559069633484, gen p mean: 0.0, mean p set: 0.4504498541355133
loss_pred:0.03177790716290474, decouple_loss:0.022184116765856743
loss_pred:0.031960245221853256, decouple_loss:0.023223644122481346
The modified gen p mean: 0.45236316323280334, gen p mean: 0.0, mean p set: 0.4531611502170563
loss_pred:0.031748902052640915, decouple_loss:0.022219989448785782
Iteration: 1392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44967952370643616, gen p mean: 0.0, mean p set: 0.45107343792915344
The modified gen p mean: 0.4453233480453491, gen p mean: 0.0, mean p set: 0.4506409764289856
The modified gen p mean: 0.4496627151966095, gen p mean: 0.0, mean p set: 0.45301249623298645
loss_pred:0.030759748071432114, decouple_loss:0.02302691712975502
loss_pred:0.03094571642577648, decouple_loss:0.02259388379752636
loss_pred:0.030619114637374878, decouple_loss:0.023038821294903755
Iteration: 1393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4560410976409912, gen p mean: 0.0, mean p set: 0.4528560936450958
The modified gen p mean: 0.45376619696617126, gen p mean: 0.0, mean p set: 0.45044317841529846
The modified gen p mean: 0.45242834091186523, gen p mean: 0.0, mean p set: 0.45078444480895996
loss_pred:0.03098911978304386, decouple_loss:0.02196040190756321
loss_pred:0.031152622774243355, decouple_loss:0.02231060527265072
loss_pred:0.031483083963394165, decouple_loss:0.022439830005168915
Iteration: 1394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46126705408096313, gen p mean: 0.0, mean p set: 0.4523874819278717
The modified gen p mean: 0.454196959733963, gen p mean: 0.0, mean p set: 0.450456827878952
The modified gen p mean: 0.4580191373825073, gen p mean: 0.0, mean p set: 0.45133426785469055
loss_pred:0.02993876114487648, decouple_loss:0.02287139557301998
loss_pred:0.031898826360702515, decouple_loss:0.021969452500343323
loss_pred:0.03182755410671234, decouple_loss:0.021748214960098267
Iteration: 1395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671630859375, gen p mean: 0.0, mean p set: 0.4526509940624237
The modified gen p mean: 0.4513712525367737, gen p mean: 0.0, mean p set: 0.45420756936073303
The modified gen p mean: 0.442859023809433, gen p mean: 0.0, mean p set: 0.45114099979400635
loss_pred:0.03258778899908066, decouple_loss:0.022177591919898987
loss_pred:0.03040459007024765, decouple_loss:0.023025279864668846
loss_pred:0.031025893986225128, decouple_loss:0.022302798926830292
Iteration: 1396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448331743478775, gen p mean: 0.0, mean p set: 0.45141491293907166
The modified gen p mean: 0.447004497051239, gen p mean: 0.0, mean p set: 0.45133084058761597
The modified gen p mean: 0.44511938095092773, gen p mean: 0.0, mean p set: 0.45079126954078674
loss_pred:0.030608145520091057, decouple_loss:0.021810824051499367
loss_pred:0.03146054223179817, decouple_loss:0.021421978250145912
loss_pred:0.031438324600458145, decouple_loss:0.022083943709731102
Iteration: 1397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45228856801986694, gen p mean: 0.0, mean p set: 0.45149174332618713
The modified gen p mean: 0.45546573400497437, gen p mean: 0.0, mean p set: 0.4505482017993927
The modified gen p mean: 0.4522591233253479, gen p mean: 0.0, mean p set: 0.4504525363445282
loss_pred:0.030755147337913513, decouple_loss:0.02143874019384384
loss_pred:0.030886217951774597, decouple_loss:0.02083197981119156
loss_pred:0.031167320907115936, decouple_loss:0.02119642309844494
Iteration: 1398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45778387784957886, gen p mean: 0.0, mean p set: 0.45171812176704407
The modified gen p mean: 0.45670947432518005, gen p mean: 0.0, mean p set: 0.4516444504261017
The modified gen p mean: 0.4534440040588379, gen p mean: 0.0, mean p set: 0.4505741000175476
loss_pred:0.03191458061337471, decouple_loss:0.020522844046354294
loss_pred:0.03232691064476967, decouple_loss:0.02119121141731739
loss_pred:0.03135532885789871, decouple_loss:0.02175627276301384
Iteration: 1399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518522024154663, gen p mean: 0.0, mean p set: 0.4523571729660034
The modified gen p mean: 0.44608867168426514, gen p mean: 0.0, mean p set: 0.4502184987068176
The modified gen p mean: 0.4516439139842987, gen p mean: 0.0, mean p set: 0.45195385813713074
loss_pred:0.030007176101207733, decouple_loss:0.021614378318190575
loss_pred:0.03140214830636978, decouple_loss:0.02090694010257721
loss_pred:0.029167111963033676, decouple_loss:0.021476062014698982
Iteration: 1400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499722421169281, gen p mean: 0.0, mean p set: 0.451566606760025
The modified gen p mean: 0.4480695128440857, gen p mean: 0.0, mean p set: 0.4527009129524231
The modified gen p mean: 0.44633957743644714, gen p mean: 0.0, mean p set: 0.4509464502334595
loss_pred:0.032407715916633606, decouple_loss:0.02025049924850464loss_pred:0.02935812622308731, decouple_loss:0.0211371760815382
loss_pred:0.030273407697677612, decouple_loss:0.022375261411070824
2023-05-02 23:45:40 testing...
The modified gen p mean: 0.4493712782859802, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4432229697704315, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45295703411102295, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03106033056974411, decouple_loss:0.022187840193510056
loss_pred:0.03210078552365303, decouple_loss:0.023148540407419205
loss_pred:0.030468234792351723, decouple_loss:0.022890837863087654
WV_0_PC_0_EH_0_PS_40_6, loss: 0.032346904277801514, avg_mse: 0.035865478217601776
current test mse: 0.035865
Iteration: 1401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450692743062973, gen p mean: 0.0, mean p set: 0.4507681429386139
The modified gen p mean: 0.45217183232307434, gen p mean: 0.0, mean p set: 0.4511401653289795
loss_pred:0.03033529967069626, decouple_loss:0.02084708958864212
loss_pred:0.031211450695991516, decouple_loss:0.02105213701725006
The modified gen p mean: 0.44759419560432434, gen p mean: 0.0, mean p set: 0.4508858919143677
loss_pred:0.03070487454533577, decouple_loss:0.021348515525460243
Iteration: 1402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849875569343567, gen p mean: 0.0, mean p set: 0.45123252272605896
The modified gen p mean: 0.45164555311203003, gen p mean: 0.0, mean p set: 0.45437467098236084
The modified gen p mean: 0.4473690390586853, gen p mean: 0.0, mean p set: 0.4510670304298401
loss_pred:0.031209714710712433, decouple_loss:0.021076750010252
loss_pred:0.029488101601600647, decouple_loss:0.022321585565805435
loss_pred:0.03003930300474167, decouple_loss:0.021339893341064453
Iteration: 1403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45413729548454285, gen p mean: 0.0, mean p set: 0.45086002349853516
The modified gen p mean: 0.4539681673049927, gen p mean: 0.0, mean p set: 0.45055627822875977
The modified gen p mean: 0.4556082785129547, gen p mean: 0.0, mean p set: 0.4505917727947235
loss_pred:0.031274449080228806, decouple_loss:0.021024931222200394
loss_pred:0.03056032769382, decouple_loss:0.02066815085709095
loss_pred:0.030085979029536247, decouple_loss:0.02106642723083496
Iteration: 1404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4589971601963043, gen p mean: 0.0, mean p set: 0.452638179063797
The modified gen p mean: 0.4557712972164154, gen p mean: 0.0, mean p set: 0.450752317905426
The modified gen p mean: 0.4591794013977051, gen p mean: 0.0, mean p set: 0.45267269015312195
loss_pred:0.031382687389850616, decouple_loss:0.02091594785451889
loss_pred:0.029885197058320045, decouple_loss:0.020110977813601494
loss_pred:0.029343340545892715, decouple_loss:0.020114239305257797
Iteration: 1405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45083343982696533, gen p mean: 0.0, mean p set: 0.4527396559715271
The modified gen p mean: 0.445538729429245, gen p mean: 0.0, mean p set: 0.45116284489631653
The modified gen p mean: 0.449036568403244, gen p mean: 0.0, mean p set: 0.45281288027763367
loss_pred:0.029948532581329346, decouple_loss:0.020238494500517845
loss_pred:0.031133366748690605, decouple_loss:0.021248262375593185
loss_pred:0.032788343727588654, decouple_loss:0.021112915128469467
Iteration: 1406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523131847381592, gen p mean: 0.0, mean p set: 0.45144933462142944
The modified gen p mean: 0.4489379823207855, gen p mean: 0.0, mean p set: 0.4529861509799957
The modified gen p mean: 0.4456557035446167, gen p mean: 0.0, mean p set: 0.45045205950737
loss_pred:0.029022429138422012, decouple_loss:0.020546726882457733
loss_pred:0.029905172064900398, decouple_loss:0.021192362532019615
loss_pred:0.03023279644548893, decouple_loss:0.020518841221928596
Iteration: 1407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503657817840576, gen p mean: 0.0, mean p set: 0.4510722756385803
The modified gen p mean: 0.4503220319747925, gen p mean: 0.0, mean p set: 0.45140859484672546
The modified gen p mean: 0.4471595585346222, gen p mean: 0.0, mean p set: 0.45065951347351074
loss_pred:0.030836379155516624, decouple_loss:0.02031760849058628
loss_pred:0.03212335705757141, decouple_loss:0.020540578290820122
loss_pred:0.029604550451040268, decouple_loss:0.020670609548687935
Iteration: 1408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4558333456516266, gen p mean: 0.0, mean p set: 0.4512914717197418
The modified gen p mean: 0.4508683979511261, gen p mean: 0.0, mean p set: 0.45105183124542236
The modified gen p mean: 0.4535529613494873, gen p mean: 0.0, mean p set: 0.4500705301761627
loss_pred:0.029903728514909744, decouple_loss:0.020275715738534927
loss_pred:0.031654033809900284, decouple_loss:0.019581111147999763
loss_pred:0.030107686296105385, decouple_loss:0.02063843049108982
Iteration: 1409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4570119380950928, gen p mean: 0.0, mean p set: 0.4494965374469757
The modified gen p mean: 0.45395055413246155, gen p mean: 0.0, mean p set: 0.4513775408267975
The modified gen p mean: 0.45818087458610535, gen p mean: 0.0, mean p set: 0.453996479511261
loss_pred:0.03161256015300751, decouple_loss:0.020612306892871857
loss_pred:0.029827019199728966, decouple_loss:0.020281149074435234
loss_pred:0.029325133189558983, decouple_loss:0.020670855417847633
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
NaN value num: 0
Iteration: 1410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491621255874634, gen p mean: 0.0, mean p set: 0.450754314661026
The modified gen p mean: 0.4479769170284271, gen p mean: 0.0, mean p set: 0.449457585811615
The modified gen p mean: 0.44532662630081177, gen p mean: 0.0, mean p set: 0.44912293553352356
loss_pred:0.03344399854540825, decouple_loss:0.02269253134727478
loss_pred:0.03434217348694801, decouple_loss:0.023911843076348305
loss_pred:0.03341438248753548, decouple_loss:0.02268124558031559
2023-05-02 23:50:03 testing...
The modified gen p mean: 0.43935006856918335, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4459216892719269, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44969284534454346, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.032095082104206085, decouple_loss:0.02237587608397007
loss_pred:0.030990546569228172, decouple_loss:0.021640684455633163
loss_pred:0.030390137806534767, decouple_loss:0.02220063842833042
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03226220980286598, avg_mse: 0.03577594459056854
current test mse: 0.035776
Iteration: 1411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451300799846649, gen p mean: 0.0, mean p set: 0.45012786984443665
The modified gen p mean: 0.448178768157959, gen p mean: 0.0, mean p set: 0.45190247893333435
loss_pred:0.03193660452961922, decouple_loss:0.021187832579016685
loss_pred:0.033359650522470474, decouple_loss:0.021937187761068344
The modified gen p mean: 0.4474142789840698, gen p mean: 0.0, mean p set: 0.45108816027641296
loss_pred:0.031469058245420456, decouple_loss:0.02066570520401001
Iteration: 1412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.455169677734375, gen p mean: 0.0, mean p set: 0.45032259821891785
The modified gen p mean: 0.4507155418395996, gen p mean: 0.0, mean p set: 0.4495159983634949
The modified gen p mean: 0.4565585255622864, gen p mean: 0.0, mean p set: 0.45007210969924927
loss_pred:0.033031217753887177, decouple_loss:0.02141413651406765
loss_pred:0.03320123627781868, decouple_loss:0.022207750007510185
loss_pred:0.031578850001096725, decouple_loss:0.021362382918596268
Iteration: 1413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756215810775757, gen p mean: 0.0, mean p set: 0.4508536458015442
The modified gen p mean: 0.44495347142219543, gen p mean: 0.0, mean p set: 0.4502537250518799
The modified gen p mean: 0.44813865423202515, gen p mean: 0.0, mean p set: 0.4502260982990265
loss_pred:0.03244587406516075, decouple_loss:0.02148537151515484
loss_pred:0.03229266405105591, decouple_loss:0.020942136645317078
loss_pred:0.03301042318344116, decouple_loss:0.02141333930194378
Iteration: 1414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44367527961730957, gen p mean: 0.0, mean p set: 0.4508011043071747
The modified gen p mean: 0.4457951486110687, gen p mean: 0.0, mean p set: 0.45220738649368286
The modified gen p mean: 0.4426453411579132, gen p mean: 0.0, mean p set: 0.44950413703918457
loss_pred:0.032546717673540115, decouple_loss:0.020152313634753227
loss_pred:0.032623209059238434, decouple_loss:0.02077210508286953
loss_pred:0.0336429663002491, decouple_loss:0.02169608697295189
Iteration: 1415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45589885115623474, gen p mean: 0.0, mean p set: 0.45255526900291443
The modified gen p mean: 0.45124852657318115, gen p mean: 0.0, mean p set: 0.44990405440330505
The modified gen p mean: 0.4600016176700592, gen p mean: 0.0, mean p set: 0.45025599002838135
loss_pred:0.03293723240494728, decouple_loss:0.02033742144703865
loss_pred:0.03220420330762863, decouple_loss:0.020838705822825432
loss_pred:0.032133251428604126, decouple_loss:0.020803222432732582
Iteration: 1416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003923773765564, gen p mean: 0.0, mean p set: 0.4495038390159607
The modified gen p mean: 0.45439618825912476, gen p mean: 0.0, mean p set: 0.45092108845710754
loss_pred:0.03230356425046921, decouple_loss:0.02180016227066517
The modified gen p mean: 0.45833736658096313, gen p mean: 0.0, mean p set: 0.44910579919815063
loss_pred:0.033686090260744095, decouple_loss:0.021793697029352188
loss_pred:0.033317308872938156, decouple_loss:0.02122901938855648
Iteration: 1417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866156578063965, gen p mean: 0.0, mean p set: 0.4500577449798584
The modified gen p mean: 0.44908374547958374, gen p mean: 0.0, mean p set: 0.4494173526763916
loss_pred:0.031873274594545364, decouple_loss:0.02053246460855007
The modified gen p mean: 0.45554211735725403, gen p mean: 0.0, mean p set: 0.44967761635780334
loss_pred:0.032771725207567215, decouple_loss:0.021233858540654182
loss_pred:0.032230574637651443, decouple_loss:0.021435284987092018
Iteration: 1418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457753002643585, gen p mean: 0.0, mean p set: 0.44981908798217773
The modified gen p mean: 0.44061633944511414, gen p mean: 0.0, mean p set: 0.45016080141067505
The modified gen p mean: 0.4357666075229645, gen p mean: 0.0, mean p set: 0.4492502808570862
loss_pred:0.032026052474975586, decouple_loss:0.02074485830962658
loss_pred:0.03223670274019241, decouple_loss:0.020678944885730743
loss_pred:0.032658569514751434, decouple_loss:0.021229790523648262
Iteration: 1419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4431273937225342, gen p mean: 0.0, mean p set: 0.4497132897377014
The modified gen p mean: 0.4524637460708618, gen p mean: 0.0, mean p set: 0.45093461871147156
The modified gen p mean: 0.44941940903663635, gen p mean: 0.0, mean p set: 0.4485178589820862
loss_pred:0.032383184880018234, decouple_loss:0.02114204317331314
loss_pred:0.0329786017537117, decouple_loss:0.021480729803442955
loss_pred:0.031814467161893845, decouple_loss:0.02081628516316414
Iteration: 1420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45958006381988525, gen p mean: 0.0, mean p set: 0.4499862790107727
The modified gen p mean: 0.45027580857276917, gen p mean: 0.0, mean p set: 0.4500654339790344
The modified gen p mean: 0.46374526619911194, gen p mean: 0.0, mean p set: 0.44988563656806946
loss_pred:0.03233169764280319, decouple_loss:0.02031499147415161
loss_pred:0.03191498667001724, decouple_loss:0.02098572440445423
loss_pred:0.03239211440086365, decouple_loss:0.020343169569969177
2023-05-02 23:53:47 testing...
The modified gen p mean: 0.44693079590797424, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45335423946380615, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45712754130363464, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03204348683357239, decouple_loss:0.022832447662949562
loss_pred:0.03117159567773342, decouple_loss:0.021985676139593124
loss_pred:0.030532585456967354, decouple_loss:0.022398626431822777
WV_0_PC_0_EH_0_PS_40_6, loss: 0.032369501888751984, avg_mse: 0.03591613844037056
current test mse: 0.035916
Iteration: 1421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841018319129944, gen p mean: 0.0, mean p set: 0.44992440938949585
The modified gen p mean: 0.4597285985946655, gen p mean: 0.0, mean p set: 0.45046865940093994
loss_pred:0.031580593436956406, decouple_loss:0.020309729501605034
loss_pred:0.03200631961226463, decouple_loss:0.020986123010516167
The modified gen p mean: 0.4569455683231354, gen p mean: 0.0, mean p set: 0.4511137008666992
loss_pred:0.03197849914431572, decouple_loss:0.0203500147908926
Iteration: 1422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480551481246948, gen p mean: 0.0, mean p set: 0.4500959813594818
The modified gen p mean: 0.4416756331920624, gen p mean: 0.0, mean p set: 0.4497425854206085
The modified gen p mean: 0.44500383734703064, gen p mean: 0.0, mean p set: 0.4505922794342041
loss_pred:0.03265189006924629, decouple_loss:0.021456502377986908
loss_pred:0.03226834163069725, decouple_loss:0.020597679540514946
loss_pred:0.0316711850464344, decouple_loss:0.020689329132437706
Iteration: 1423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44244855642318726, gen p mean: 0.0, mean p set: 0.4502915143966675
The modified gen p mean: 0.44245362281799316, gen p mean: 0.0, mean p set: 0.45026183128356934
The modified gen p mean: 0.44480571150779724, gen p mean: 0.0, mean p set: 0.4510369300842285
loss_pred:0.032083965837955475, decouple_loss:0.020950159057974815
loss_pred:0.032413966953754425, decouple_loss:0.019970690831542015
loss_pred:0.03285864368081093, decouple_loss:0.020897137001156807
Iteration: 1424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4572374224662781, gen p mean: 0.0, mean p set: 0.4491018056869507
The modified gen p mean: 0.46094653010368347, gen p mean: 0.0, mean p set: 0.4507102370262146
The modified gen p mean: 0.46026235818862915, gen p mean: 0.0, mean p set: 0.4496959447860718
loss_pred:0.032961711287498474, decouple_loss:0.020640576258301735
loss_pred:0.03284313529729843, decouple_loss:0.02018679492175579
loss_pred:0.033301591873168945, decouple_loss:0.02114807441830635
Iteration: 1425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450575053691864, gen p mean: 0.0, mean p set: 0.44858694076538086The modified gen p mean: 0.4521191418170929, gen p mean: 0.0, mean p set: 0.4506663978099823
The modified gen p mean: 0.44068869948387146, gen p mean: 0.0, mean p set: 0.4494756758213043
loss_pred:0.03360651433467865, decouple_loss:0.02081925794482231
loss_pred:0.03199242427945137, decouple_loss:0.02035059779882431
loss_pred:0.03250911086797714, decouple_loss:0.02105570025742054
Iteration: 1426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43553468585014343, gen p mean: 0.0, mean p set: 0.45070680975914
The modified gen p mean: 0.43990811705589294, gen p mean: 0.0, mean p set: 0.45040687918663025
The modified gen p mean: 0.43704017996788025, gen p mean: 0.0, mean p set: 0.44986405968666077
loss_pred:0.03291533514857292, decouple_loss:0.02078050561249256
loss_pred:0.032724812626838684, decouple_loss:0.019844338297843933
loss_pred:0.0321311429142952, decouple_loss:0.020318984985351562
Iteration: 1427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45511752367019653, gen p mean: 0.0, mean p set: 0.44986429810523987
The modified gen p mean: 0.4467955529689789, gen p mean: 0.0, mean p set: 0.45033276081085205
The modified gen p mean: 0.4529903531074524, gen p mean: 0.0, mean p set: 0.4500441253185272
loss_pred:0.03179081156849861, decouple_loss:0.020037749782204628
loss_pred:0.031945452094078064, decouple_loss:0.021934708580374718
loss_pred:0.03276923671364784, decouple_loss:0.019977914169430733
Iteration: 1428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4684523642063141, gen p mean: 0.0, mean p set: 0.4501130282878876
The modified gen p mean: 0.46615973114967346, gen p mean: 0.0, mean p set: 0.4492204785346985
The modified gen p mean: 0.4665547311306, gen p mean: 0.0, mean p set: 0.4507644772529602
loss_pred:0.03211429342627525, decouple_loss:0.01981089636683464
loss_pred:0.032425057142972946, decouple_loss:0.020834611728787422
loss_pred:0.03319334238767624, decouple_loss:0.020519692450761795
Iteration: 1429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43413418531417847, gen p mean: 0.0, mean p set: 0.450285404920578
The modified gen p mean: 0.4432944059371948, gen p mean: 0.0, mean p set: 0.45051151514053345
The modified gen p mean: 0.44786956906318665, gen p mean: 0.0, mean p set: 0.45008236169815063
loss_pred:0.03206335008144379, decouple_loss:0.02079835534095764
loss_pred:0.03213953599333763, decouple_loss:0.019579051062464714
loss_pred:0.03265444189310074, decouple_loss:0.02093891054391861
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
NaN value num: 0
Iteration: 1430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4430598318576813, gen p mean: 0.0, mean p set: 0.4533340632915497
The modified gen p mean: 0.44379356503486633, gen p mean: 0.0, mean p set: 0.45328083634376526
The modified gen p mean: 0.4421698749065399, gen p mean: 0.0, mean p set: 0.45311427116394043
loss_pred:0.030059434473514557, decouple_loss:0.021687202155590057
loss_pred:0.029607918113470078, decouple_loss:0.02366676926612854
loss_pred:0.030576316639780998, decouple_loss:0.021717842668294907
2023-05-02 23:58:06 testing...
The modified gen p mean: 0.45617568492889404, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45963621139526367, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4503185451030731, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.031018400564789772, decouple_loss:0.021463532000780106
loss_pred:0.030466971918940544, decouple_loss:0.02188778482377529
loss_pred:0.03205510228872299, decouple_loss:0.02204982005059719
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03227017819881439, avg_mse: 0.035940270870923996
current test mse: 0.03594
Iteration: 1431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45968571305274963, gen p mean: 0.0, mean p set: 0.45254871249198914
The modified gen p mean: 0.4605669379234314, gen p mean: 0.0, mean p set: 0.45023927092552185
loss_pred:0.031143303960561752, decouple_loss:0.021066943183541298
loss_pred:0.03084464929997921, decouple_loss:0.02127159759402275
The modified gen p mean: 0.4620409905910492, gen p mean: 0.0, mean p set: 0.45257216691970825
loss_pred:0.029874226078391075, decouple_loss:0.021382678300142288
Iteration: 1432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45503538846969604, gen p mean: 0.0, mean p set: 0.44997847080230713
The modified gen p mean: 0.4517998993396759, gen p mean: 0.0, mean p set: 0.45260855555534363
The modified gen p mean: 0.4581487476825714, gen p mean: 0.0, mean p set: 0.45080041885375977
loss_pred:0.030675888061523438, decouple_loss:0.021066859364509583
loss_pred:0.029498588293790817, decouple_loss:0.02141691744327545
loss_pred:0.03083791770040989, decouple_loss:0.021641213446855545
Iteration: 1433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4389170706272125, gen p mean: 0.0, mean p set: 0.4555578827857971
The modified gen p mean: 0.4426444172859192, gen p mean: 0.0, mean p set: 0.45165982842445374
The modified gen p mean: 0.4428248703479767, gen p mean: 0.0, mean p set: 0.4506414532661438
loss_pred:0.03075762651860714, decouple_loss:0.02166750282049179
loss_pred:0.0304391011595726, decouple_loss:0.020778419449925423
loss_pred:0.030250372365117073, decouple_loss:0.021155552938580513
Iteration: 1434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097777247428894, gen p mean: 0.0, mean p set: 0.4517159163951874
The modified gen p mean: 0.45045748353004456, gen p mean: 0.0, mean p set: 0.4521520435810089
The modified gen p mean: 0.45548152923583984, gen p mean: 0.0, mean p set: 0.4519054889678955
loss_pred:0.03147329390048981, decouple_loss:0.021310128271579742
loss_pred:0.029543420299887657, decouple_loss:0.021591903641819954
loss_pred:0.029801927506923676, decouple_loss:0.02076813206076622
Iteration: 1435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495880603790283, gen p mean: 0.0, mean p set: 0.4516180753707886
The modified gen p mean: 0.46036583185195923, gen p mean: 0.0, mean p set: 0.4527343511581421
The modified gen p mean: 0.46401822566986084, gen p mean: 0.0, mean p set: 0.4522334337234497
loss_pred:0.029698824509978294, decouple_loss:0.021769428625702858
loss_pred:0.029400017112493515, decouple_loss:0.020960165187716484
loss_pred:0.02995968982577324, decouple_loss:0.02030535228550434
Iteration: 1436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519062936306, gen p mean: 0.0, mean p set: 0.4516242742538452
The modified gen p mean: 0.45230770111083984, gen p mean: 0.0, mean p set: 0.4530309736728668
The modified gen p mean: 0.4495108723640442, gen p mean: 0.0, mean p set: 0.45246621966362
loss_pred:0.029689624905586243, decouple_loss:0.019795700907707214
loss_pred:0.030075963586568832, decouple_loss:0.021379970014095306
loss_pred:0.028899529948830605, decouple_loss:0.02065393514931202
Iteration: 1437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494817554950714, gen p mean: 0.0, mean p set: 0.45294511318206787
The modified gen p mean: 0.44237077236175537, gen p mean: 0.0, mean p set: 0.44974127411842346
The modified gen p mean: 0.44709107279777527, gen p mean: 0.0, mean p set: 0.45306602120399475
loss_pred:0.028455236926674843, decouple_loss:0.020857907831668854
loss_pred:0.03030574321746826, decouple_loss:0.021201536059379578
loss_pred:0.029896993190050125, decouple_loss:0.020043088123202324
Iteration: 1438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495689868927002, gen p mean: 0.0, mean p set: 0.4525352716445923
The modified gen p mean: 0.4448153078556061, gen p mean: 0.0, mean p set: 0.45108485221862793
The modified gen p mean: 0.44935497641563416, gen p mean: 0.0, mean p set: 0.4513528347015381
loss_pred:0.031091798096895218, decouple_loss:0.02118620090186596
loss_pred:0.029503950849175453, decouple_loss:0.02142508327960968
loss_pred:0.031057119369506836, decouple_loss:0.0213540680706501
Iteration: 1439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45790717005729675, gen p mean: 0.0, mean p set: 0.45374393463134766
The modified gen p mean: 0.45769262313842773, gen p mean: 0.0, mean p set: 0.4540724456310272
The modified gen p mean: 0.4627937078475952, gen p mean: 0.0, mean p set: 0.45324212312698364
loss_pred:0.029433179646730423, decouple_loss:0.020972201600670815
loss_pred:0.03009406477212906, decouple_loss:0.021420123055577278
loss_pred:0.028686247766017914, decouple_loss:0.02076844871044159
Iteration: 1440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4559359550476074, gen p mean: 0.0, mean p set: 0.45148876309394836
The modified gen p mean: 0.45575839281082153, gen p mean: 0.0, mean p set: 0.4514535665512085
loss_pred:0.03030301257967949, decouple_loss:0.019609203562140465
The modified gen p mean: 0.45328691601753235, gen p mean: 0.0, mean p set: 0.45295095443725586
loss_pred:0.029989734292030334, decouple_loss:0.01939699426293373
loss_pred:0.02901739440858364, decouple_loss:0.02079060859978199
2023-05-03 00:01:49 testing...
The modified gen p mean: 0.4416232705116272, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45166245102882385, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44783782958984375, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03210189566016197, decouple_loss:0.02266848273575306
loss_pred:0.030417144298553467, decouple_loss:0.02236347459256649
loss_pred:0.030996397137641907, decouple_loss:0.02197674848139286
WV_0_PC_0_EH_0_PS_40_6, loss: 0.032288625836372375, avg_mse: 0.03596329689025879
current test mse: 0.035963
Iteration: 1441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509938359260559, gen p mean: 0.0, mean p set: 0.4505091905593872
loss_pred:0.030998749658465385, decouple_loss:0.01994403824210167
The modified gen p mean: 0.4556187689304352, gen p mean: 0.0, mean p set: 0.4524320662021637
loss_pred:0.029463229700922966, decouple_loss:0.02003738470375538
The modified gen p mean: 0.4552712142467499, gen p mean: 0.0, mean p set: 0.4530712962150574
loss_pred:0.028663793578743935, decouple_loss:0.020026912912726402
Iteration: 1442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476681351661682, gen p mean: 0.0, mean p set: 0.4512145519256592
The modified gen p mean: 0.44826021790504456, gen p mean: 0.0, mean p set: 0.44959282875061035
The modified gen p mean: 0.4510853588581085, gen p mean: 0.0, mean p set: 0.45316070318222046
loss_pred:0.03124695084989071, decouple_loss:0.021067898720502853
loss_pred:0.03086281754076481, decouple_loss:0.02066342905163765
loss_pred:0.029700594022870064, decouple_loss:0.021216077730059624
Iteration: 1443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446981281042099, gen p mean: 0.0, mean p set: 0.4521713852882385
The modified gen p mean: 0.4508255422115326, gen p mean: 0.0, mean p set: 0.45375576615333557
The modified gen p mean: 0.45230793952941895, gen p mean: 0.0, mean p set: 0.45177099108695984
loss_pred:0.02963746339082718, decouple_loss:0.0199657641351223
loss_pred:0.029203791171312332, decouple_loss:0.01871768943965435
loss_pred:0.029641704633831978, decouple_loss:0.020125003531575203
Iteration: 1444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44582387804985046, gen p mean: 0.0, mean p set: 0.4509062170982361
The modified gen p mean: 0.45093849301338196, gen p mean: 0.0, mean p set: 0.4521639347076416
The modified gen p mean: 0.45142829418182373, gen p mean: 0.0, mean p set: 0.45252999663352966
loss_pred:0.031005701050162315, decouple_loss:0.01988903619349003
loss_pred:0.030419228598475456, decouple_loss:0.02010815590620041
loss_pred:0.029903467744588852, decouple_loss:0.019979754462838173
Iteration: 1445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44518980383872986, gen p mean: 0.0, mean p set: 0.4520109295845032
The modified gen p mean: 0.453388512134552, gen p mean: 0.0, mean p set: 0.45317476987838745
The modified gen p mean: 0.45715245604515076, gen p mean: 0.0, mean p set: 0.4517918825149536
loss_pred:0.02942354790866375, decouple_loss:0.021140320226550102
loss_pred:0.0292520709335804, decouple_loss:0.019552791491150856
loss_pred:0.02948785200715065, decouple_loss:0.019832197576761246
Iteration: 1446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450015664100647, gen p mean: 0.0, mean p set: 0.4513835310935974
The modified gen p mean: 0.4525867700576782, gen p mean: 0.0, mean p set: 0.4516550898551941
The modified gen p mean: 0.45878952741622925, gen p mean: 0.0, mean p set: 0.4500231444835663
loss_pred:0.030311156064271927, decouple_loss:0.020918577909469604
loss_pred:0.030277084559202194, decouple_loss:0.02041269838809967
loss_pred:0.031173907220363617, decouple_loss:0.02117946185171604
Iteration: 1447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4559696912765503, gen p mean: 0.0, mean p set: 0.4544260501861572
The modified gen p mean: 0.4594806134700775, gen p mean: 0.0, mean p set: 0.4530937969684601
The modified gen p mean: 0.4468875229358673, gen p mean: 0.0, mean p set: 0.4512959122657776
loss_pred:0.030006643384695053, decouple_loss:0.019271984696388245
loss_pred:0.02943900041282177, decouple_loss:0.019428227096796036
loss_pred:0.02892606146633625, decouple_loss:0.020322808995842934
Iteration: 1448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488127827644348, gen p mean: 0.0, mean p set: 0.45166051387786865
The modified gen p mean: 0.4474128484725952, gen p mean: 0.0, mean p set: 0.45280560851097107
The modified gen p mean: 0.45301470160484314, gen p mean: 0.0, mean p set: 0.4501282274723053
loss_pred:0.029442276805639267, decouple_loss:0.01948133111000061
loss_pred:0.029382091015577316, decouple_loss:0.01909356378018856
loss_pred:0.031245486810803413, decouple_loss:0.020178750157356262
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 1449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499712884426117, gen p mean: 0.0, mean p set: 0.4480433166027069
The modified gen p mean: 0.4519151449203491, gen p mean: 0.0, mean p set: 0.4482308626174927
The modified gen p mean: 0.450860857963562, gen p mean: 0.0, mean p set: 0.44831904768943787
loss_pred:0.03202080354094505, decouple_loss:0.022130649536848068
loss_pred:0.031933169811964035, decouple_loss:0.02248608134686947
loss_pred:0.030983660370111465, decouple_loss:0.021632801741361618
Iteration: 1450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44620028138160706, gen p mean: 0.0, mean p set: 0.4477475583553314
The modified gen p mean: 0.45034730434417725, gen p mean: 0.0, mean p set: 0.4483511745929718
The modified gen p mean: 0.4441286027431488, gen p mean: 0.0, mean p set: 0.4480080008506775
loss_pred:0.031077396124601364, decouple_loss:0.02183016575872898
loss_pred:0.03149343281984329, decouple_loss:0.021782729774713516
loss_pred:0.03134157881140709, decouple_loss:0.022309323772788048
2023-05-03 00:06:29 testing...
The modified gen p mean: 0.4336329996585846, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4406270682811737, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4446367621421814, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03213119879364967, decouple_loss:0.021665025502443314
loss_pred:0.031040526926517487, decouple_loss:0.02108994498848915
loss_pred:0.030363038182258606, decouple_loss:0.021723885089159012
WV_0_PC_0_EH_0_PS_40_6, loss: 0.032252900302410126, avg_mse: 0.03606678172945976
current test mse: 0.036067
Iteration: 1451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4427075982093811, gen p mean: 0.0, mean p set: 0.44760891795158386
The modified gen p mean: 0.4441208839416504, gen p mean: 0.0, mean p set: 0.4483618438243866
loss_pred:0.032049451023340225, decouple_loss:0.022039275616407394
loss_pred:0.030720999464392662, decouple_loss:0.02185840904712677
The modified gen p mean: 0.4401150047779083, gen p mean: 0.0, mean p set: 0.4493274986743927
loss_pred:0.031486086547374725, decouple_loss:0.02191953919827938
Iteration: 1452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497899115085602, gen p mean: 0.0, mean p set: 0.4477456510066986
The modified gen p mean: 0.4487607777118683, gen p mean: 0.0, mean p set: 0.44877755641937256
The modified gen p mean: 0.44922640919685364, gen p mean: 0.0, mean p set: 0.4487678110599518
loss_pred:0.03189011663198471, decouple_loss:0.02071135863661766
loss_pred:0.032334864139556885, decouple_loss:0.020564209669828415
loss_pred:0.030680764466524124, decouple_loss:0.020458150655031204
Iteration: 1453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530487656593323, gen p mean: 0.0, mean p set: 0.4476131498813629
The modified gen p mean: 0.4510069489479065, gen p mean: 0.0, mean p set: 0.44846081733703613
The modified gen p mean: 0.45915544033050537, gen p mean: 0.0, mean p set: 0.4488621652126312
loss_pred:0.03098675236105919, decouple_loss:0.020404215902090073
loss_pred:0.03131311759352684, decouple_loss:0.020511221140623093
loss_pred:0.031883519142866135, decouple_loss:0.019725602120161057
Iteration: 1454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4370906949043274, gen p mean: 0.0, mean p set: 0.4479289650917053
The modified gen p mean: 0.4422951340675354, gen p mean: 0.0, mean p set: 0.4471800923347473
The modified gen p mean: 0.4440583288669586, gen p mean: 0.0, mean p set: 0.44821682572364807
loss_pred:0.03180716559290886, decouple_loss:0.020022915676236153
loss_pred:0.03192025050520897, decouple_loss:0.019594576209783554
loss_pred:0.03203469514846802, decouple_loss:0.020192699506878853
Iteration: 1455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454536736011505, gen p mean: 0.0, mean p set: 0.4486466944217682
The modified gen p mean: 0.44076383113861084, gen p mean: 0.0, mean p set: 0.44785353541374207
The modified gen p mean: 0.4436131417751312, gen p mean: 0.0, mean p set: 0.4492107927799225
loss_pred:0.03103613294661045, decouple_loss:0.02105679363012314
loss_pred:0.031025510281324387, decouple_loss:0.020858053117990494
loss_pred:0.031866930425167084, decouple_loss:0.020984388887882233
Iteration: 1456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4552610516548157, gen p mean: 0.0, mean p set: 0.44828295707702637
The modified gen p mean: 0.46160364151000977, gen p mean: 0.0, mean p set: 0.4487457573413849
The modified gen p mean: 0.46114668250083923, gen p mean: 0.0, mean p set: 0.4472944438457489
loss_pred:0.03177889809012413, decouple_loss:0.01959294080734253
loss_pred:0.03177445009350777, decouple_loss:0.020010681822896004
loss_pred:0.03137107938528061, decouple_loss:0.020009314641356468
Iteration: 1457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4551667273044586, gen p mean: 0.0, mean p set: 0.4482864737510681
The modified gen p mean: 0.45099693536758423, gen p mean: 0.0, mean p set: 0.4481387734413147
The modified gen p mean: 0.4526784420013428, gen p mean: 0.0, mean p set: 0.44814959168434143
loss_pred:0.03062637522816658, decouple_loss:0.019977321848273277
loss_pred:0.031331855803728104, decouple_loss:0.021101972088217735
loss_pred:0.03059326857328415, decouple_loss:0.019982805475592613
Iteration: 1458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4404178261756897, gen p mean: 0.0, mean p set: 0.4493890404701233
The modified gen p mean: 0.44273313879966736, gen p mean: 0.0, mean p set: 0.44731831550598145
The modified gen p mean: 0.4430028796195984, gen p mean: 0.0, mean p set: 0.44660380482673645
loss_pred:0.031073912978172302, decouple_loss:0.02020666003227234
loss_pred:0.031199580058455467, decouple_loss:0.01999741792678833
loss_pred:0.03166263550519943, decouple_loss:0.020010042935609818
Iteration: 1459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4442920386791229, gen p mean: 0.0, mean p set: 0.4478210508823395
The modified gen p mean: 0.44063815474510193, gen p mean: 0.0, mean p set: 0.4494889974594116
The modified gen p mean: 0.4409860372543335, gen p mean: 0.0, mean p set: 0.4482399523258209
loss_pred:0.03156054764986038, decouple_loss:0.01965395174920559
loss_pred:0.031093696132302284, decouple_loss:0.020040661096572876
loss_pred:0.03180832788348198, decouple_loss:0.01979900896549225
Iteration: 1460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4428946077823639, gen p mean: 0.0, mean p set: 0.44806867837905884
The modified gen p mean: 0.4454708695411682, gen p mean: 0.0, mean p set: 0.44819164276123047
The modified gen p mean: 0.4506777822971344, gen p mean: 0.0, mean p set: 0.4488186836242676
loss_pred:0.03078502044081688, decouple_loss:0.02033184841275215
loss_pred:0.030353831127285957, decouple_loss:0.020081685855984688
loss_pred:0.031154049560427666, decouple_loss:0.02005113661289215
2023-05-03 00:10:13 testing...
The modified gen p mean: 0.4489585757255554, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44251611828804016, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4530251920223236, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03071415051817894, decouple_loss:0.0196036659181118
loss_pred:0.031678229570388794, decouple_loss:0.0198347270488739
loss_pred:0.030082428827881813, decouple_loss:0.019941499456763268
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03181460127234459, avg_mse: 0.035455092787742615
current test mse: 0.035455
Iteration: 1461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469432234764099, gen p mean: 0.0, mean p set: 0.4480248689651489
loss_pred:0.030248548835515976, decouple_loss:0.01970868743956089
The modified gen p mean: 0.4474753141403198, gen p mean: 0.0, mean p set: 0.4477413594722748
loss_pred:0.031140552833676338, decouple_loss:0.01954302377998829
The modified gen p mean: 0.446533203125, gen p mean: 0.0, mean p set: 0.44754406809806824
loss_pred:0.03131360560655594, decouple_loss:0.01993711292743683
Iteration: 1462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4603644013404846, gen p mean: 0.0, mean p set: 0.4478406012058258
The modified gen p mean: 0.45669952034950256, gen p mean: 0.0, mean p set: 0.44770246744155884
The modified gen p mean: 0.46044573187828064, gen p mean: 0.0, mean p set: 0.44706112146377563
loss_pred:0.03146786987781525, decouple_loss:0.01947217620909214
loss_pred:0.030524486675858498, decouple_loss:0.01959952898323536
loss_pred:0.03128465637564659, decouple_loss:0.019489958882331848
Iteration: 1463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520736634731293, gen p mean: 0.0, mean p set: 0.4482089579105377
The modified gen p mean: 0.4490164518356323, gen p mean: 0.0, mean p set: 0.44761648774147034
The modified gen p mean: 0.44981032609939575, gen p mean: 0.0, mean p set: 0.44823944568634033
loss_pred:0.0312572717666626, decouple_loss:0.020108476281166077
loss_pred:0.030790554359555244, decouple_loss:0.01958954893052578
loss_pred:0.03121843934059143, decouple_loss:0.019609425216913223
Iteration: 1464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.436894953250885, gen p mean: 0.0, mean p set: 0.44792893528938293
The modified gen p mean: 0.43509820103645325, gen p mean: 0.0, mean p set: 0.4478645324707031
The modified gen p mean: 0.4343951940536499, gen p mean: 0.0, mean p set: 0.44745007157325745
loss_pred:0.03137180954217911, decouple_loss:0.019003557041287422loss_pred:0.030575284734368324, decouple_loss:0.020827770233154297
loss_pred:0.030465131625533104, decouple_loss:0.020180227234959602
Iteration: 1465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876039028167725, gen p mean: 0.0, mean p set: 0.44771865010261536
The modified gen p mean: 0.4493619501590729, gen p mean: 0.0, mean p set: 0.44904205203056335
The modified gen p mean: 0.4517636299133301, gen p mean: 0.0, mean p set: 0.44870179891586304
loss_pred:0.03025735914707184, decouple_loss:0.019237792119383812
loss_pred:0.03024819679558277, decouple_loss:0.01970352977514267
loss_pred:0.030187156051397324, decouple_loss:0.01945948787033558
Iteration: 1466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45100489258766174, gen p mean: 0.0, mean p set: 0.44879069924354553
The modified gen p mean: 0.4508381187915802, gen p mean: 0.0, mean p set: 0.4482249617576599
The modified gen p mean: 0.4504859745502472, gen p mean: 0.0, mean p set: 0.44742754101753235
loss_pred:0.0303859394043684, decouple_loss:0.01900131069123745
loss_pred:0.0301725585013628, decouple_loss:0.018836060538887978
loss_pred:0.03018929436802864, decouple_loss:0.019275598227977753
Iteration: 1467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081856846809387, gen p mean: 0.0, mean p set: 0.44855615496635437
The modified gen p mean: 0.4483937919139862, gen p mean: 0.0, mean p set: 0.4478244483470917
The modified gen p mean: 0.44653740525245667, gen p mean: 0.0, mean p set: 0.4480917155742645
loss_pred:0.030488058924674988, decouple_loss:0.019365059211850166
loss_pred:0.031149648129940033, decouple_loss:0.019343694671988487
loss_pred:0.03130913898348808, decouple_loss:0.019023332744836807
Iteration: 1468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071759819984436, gen p mean: 0.0, mean p set: 0.44802039861679077
The modified gen p mean: 0.4537401497364044, gen p mean: 0.0, mean p set: 0.44665300846099854
The modified gen p mean: 0.44619396328926086, gen p mean: 0.0, mean p set: 0.4479069411754608
loss_pred:0.029878685250878334, decouple_loss:0.018762310966849327
loss_pred:0.030977901071310043, decouple_loss:0.019694555550813675
loss_pred:0.031295351684093475, decouple_loss:0.019567418843507767
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 1469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506511688232422, gen p mean: 0.0, mean p set: 0.4496645927429199
The modified gen p mean: 0.4553465247154236, gen p mean: 0.0, mean p set: 0.4488740861415863
The modified gen p mean: 0.4528605341911316, gen p mean: 0.0, mean p set: 0.4497663974761963
loss_pred:0.03091983124613762, decouple_loss:0.01917261630296707
loss_pred:0.031474605202674866, decouple_loss:0.019396459683775902
loss_pred:0.030317192897200584, decouple_loss:0.019150326028466225
Iteration: 1470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4441564083099365, gen p mean: 0.0, mean p set: 0.4501734673976898
The modified gen p mean: 0.4456131160259247, gen p mean: 0.0, mean p set: 0.44934147596359253
The modified gen p mean: 0.4457153081893921, gen p mean: 0.0, mean p set: 0.4497673809528351
loss_pred:0.03131440281867981, decouple_loss:0.018901007249951363
loss_pred:0.03155898302793503, decouple_loss:0.01930146850645542
loss_pred:0.030760381370782852, decouple_loss:0.019343066960573196
2023-05-03 00:14:39 testing...
The modified gen p mean: 0.4373641908168793, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44347554445266724, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44758161902427673, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03131163865327835, decouple_loss:0.018684139475226402
loss_pred:0.02971758134663105, decouple_loss:0.018996557220816612loss_pred:0.030293121933937073, decouple_loss:0.018680443987250328
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03138013184070587, avg_mse: 0.03494621440768242
current test mse: 0.034946
Iteration: 1471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44333940744400024, gen p mean: 0.0, mean p set: 0.4494198262691498
loss_pred:0.031073858961462975, decouple_loss:0.019158057868480682
The modified gen p mean: 0.44370681047439575, gen p mean: 0.0, mean p set: 0.45130491256713867
loss_pred:0.03097384423017502, decouple_loss:0.019478294998407364
The modified gen p mean: 0.4447689354419708, gen p mean: 0.0, mean p set: 0.448993444442749
loss_pred:0.030929777771234512, decouple_loss:0.01880168542265892
Iteration: 1472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45412367582321167, gen p mean: 0.0, mean p set: 0.44884949922561646
The modified gen p mean: 0.4545058608055115, gen p mean: 0.0, mean p set: 0.45066767930984497
The modified gen p mean: 0.45048242807388306, gen p mean: 0.0, mean p set: 0.45013657212257385
loss_pred:0.03158686310052872, decouple_loss:0.018497124314308167
loss_pred:0.031746119260787964, decouple_loss:0.01858656480908394
loss_pred:0.030775614082813263, decouple_loss:0.01870695874094963
Iteration: 1473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4593772292137146, gen p mean: 0.0, mean p set: 0.4506046175956726
The modified gen p mean: 0.45579198002815247, gen p mean: 0.0, mean p set: 0.4495089054107666
The modified gen p mean: 0.45736074447631836, gen p mean: 0.0, mean p set: 0.4507763385772705
loss_pred:0.03136426582932472, decouple_loss:0.018871475011110306
loss_pred:0.031114118173718452, decouple_loss:0.018891969695687294
loss_pred:0.030597861856222153, decouple_loss:0.019706567749381065
Iteration: 1474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4411281645298004, gen p mean: 0.0, mean p set: 0.449221134185791
The modified gen p mean: 0.44405028223991394, gen p mean: 0.0, mean p set: 0.45017269253730774
The modified gen p mean: 0.44993361830711365, gen p mean: 0.0, mean p set: 0.4505905210971832
loss_pred:0.030902456492185593, decouple_loss:0.019590478390455246
loss_pred:0.030301138758659363, decouple_loss:0.01883542537689209
loss_pred:0.030662596225738525, decouple_loss:0.0185953751206398
Iteration: 1475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44222280383110046, gen p mean: 0.0, mean p set: 0.4495182931423187
The modified gen p mean: 0.4484688341617584, gen p mean: 0.0, mean p set: 0.45138660073280334
The modified gen p mean: 0.44798851013183594, gen p mean: 0.0, mean p set: 0.4497552812099457
loss_pred:0.031100580468773842, decouple_loss:0.019401196390390396
loss_pred:0.030430618673563004, decouple_loss:0.018555650487542152
loss_pred:0.030378593131899834, decouple_loss:0.019290190190076828
Iteration: 1476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523314833641052, gen p mean: 0.0, mean p set: 0.44995465874671936
The modified gen p mean: 0.44958457350730896, gen p mean: 0.0, mean p set: 0.4505513906478882
The modified gen p mean: 0.4552026093006134, gen p mean: 0.0, mean p set: 0.451143354177475
loss_pred:0.030441608279943466, decouple_loss:0.01915084756910801
loss_pred:0.03052855283021927, decouple_loss:0.019355563446879387
loss_pred:0.031175481155514717, decouple_loss:0.0187288336455822
Iteration: 1477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953835010528564, gen p mean: 0.0, mean p set: 0.44967731833457947
The modified gen p mean: 0.4487960636615753, gen p mean: 0.0, mean p set: 0.45026013255119324
The modified gen p mean: 0.4499601721763611, gen p mean: 0.0, mean p set: 0.4496835172176361
loss_pred:0.03029627539217472, decouple_loss:0.01896888203918934
loss_pred:0.030960625037550926, decouple_loss:0.019081436097621918
loss_pred:0.03059966303408146, decouple_loss:0.018702758476138115
Iteration: 1478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44327473640441895, gen p mean: 0.0, mean p set: 0.44991418719291687
The modified gen p mean: 0.44377103447914124, gen p mean: 0.0, mean p set: 0.4508661925792694
The modified gen p mean: 0.4444241523742676, gen p mean: 0.0, mean p set: 0.4504837691783905
loss_pred:0.030716752633452415, decouple_loss:0.018751509487628937
loss_pred:0.03055223822593689, decouple_loss:0.019035808742046356
loss_pred:0.031044557690620422, decouple_loss:0.018830901011824608
Iteration: 1479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4599677622318268, gen p mean: 0.0, mean p set: 0.4497511684894562The modified gen p mean: 0.4559612274169922, gen p mean: 0.0, mean p set: 0.45070981979370117
The modified gen p mean: 0.45947450399398804, gen p mean: 0.0, mean p set: 0.45129016041755676
loss_pred:0.030442828312516212, decouple_loss:0.018192220479249954loss_pred:0.031351279467344284, decouple_loss:0.02001890540122986
loss_pred:0.031115448102355003, decouple_loss:0.017847150564193726
Iteration: 1480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45752376317977905, gen p mean: 0.0, mean p set: 0.4491119980812073
The modified gen p mean: 0.452948659658432, gen p mean: 0.0, mean p set: 0.4489458501338959
The modified gen p mean: 0.4565822184085846, gen p mean: 0.0, mean p set: 0.44813892245292664
loss_pred:0.03151911124587059, decouple_loss:0.01979278214275837
loss_pred:0.030759142711758614, decouple_loss:0.01925969310104847
loss_pred:0.03200957179069519, decouple_loss:0.019771426916122437
2023-05-03 00:18:21 testing...
The modified gen p mean: 0.4247358441352844, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.43165358901023865, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4361301064491272, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.031509388238191605, decouple_loss:0.019643373787403107
loss_pred:0.030422888696193695, decouple_loss:0.019098661839962006loss_pred:0.02978437952697277, decouple_loss:0.019635258242487907
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03154517710208893, avg_mse: 0.0351523794233799
current test mse: 0.035152
Iteration: 1481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.432648628950119, gen p mean: 0.0, mean p set: 0.4493071436882019
The modified gen p mean: 0.42985180020332336, gen p mean: 0.0, mean p set: 0.4502677023410797
loss_pred:0.031357668340206146, decouple_loss:0.019470786675810814
loss_pred:0.03116864338517189, decouple_loss:0.01904599741101265
The modified gen p mean: 0.43082475662231445, gen p mean: 0.0, mean p set: 0.4506189823150635
loss_pred:0.03073900006711483, decouple_loss:0.018966911360621452
Iteration: 1482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4564529359340668, gen p mean: 0.0, mean p set: 0.44906798005104065
The modified gen p mean: 0.4539342522621155, gen p mean: 0.0, mean p set: 0.4493984878063202
The modified gen p mean: 0.4555330276489258, gen p mean: 0.0, mean p set: 0.44851261377334595
loss_pred:0.03066861256957054, decouple_loss:0.019161248579621315
loss_pred:0.03133373335003853, decouple_loss:0.018735511228442192
loss_pred:0.029662376269698143, decouple_loss:0.019258374348282814
Iteration: 1483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45894595980644226, gen p mean: 0.0, mean p set: 0.4498424530029297
The modified gen p mean: 0.46094104647636414, gen p mean: 0.0, mean p set: 0.44870686531066895
The modified gen p mean: 0.4566481411457062, gen p mean: 0.0, mean p set: 0.44996631145477295
loss_pred:0.030950576066970825, decouple_loss:0.01874430663883686
loss_pred:0.03203149884939194, decouple_loss:0.018582090735435486
loss_pred:0.030122794210910797, decouple_loss:0.018818151205778122
Iteration: 1484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694921374320984, gen p mean: 0.0, mean p set: 0.45013123750686646
The modified gen p mean: 0.44656166434288025, gen p mean: 0.0, mean p set: 0.4497471749782562
The modified gen p mean: 0.44745534658432007, gen p mean: 0.0, mean p set: 0.44959837198257446
loss_pred:0.031237797811627388, decouple_loss:0.01817023754119873
loss_pred:0.02928079664707184, decouple_loss:0.01865868829190731
loss_pred:0.03152542561292648, decouple_loss:0.018512750044465065
Iteration: 1485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451851487159729, gen p mean: 0.0, mean p set: 0.4503171145915985
The modified gen p mean: 0.45620691776275635, gen p mean: 0.0, mean p set: 0.4493391215801239
The modified gen p mean: 0.45476874709129333, gen p mean: 0.0, mean p set: 0.4485381245613098
loss_pred:0.030216919258236885, decouple_loss:0.017973756417632103
loss_pred:0.030530711635947227, decouple_loss:0.017926951870322227
loss_pred:0.03173232451081276, decouple_loss:0.0181816928088665
Iteration: 1486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44427093863487244, gen p mean: 0.0, mean p set: 0.44908788800239563
The modified gen p mean: 0.4412846863269806, gen p mean: 0.0, mean p set: 0.4497183561325073
The modified gen p mean: 0.44373276829719543, gen p mean: 0.0, mean p set: 0.44850999116897583
loss_pred:0.031610723584890366, decouple_loss:0.01785951294004917
loss_pred:0.03126533702015877, decouple_loss:0.017755739390850067
loss_pred:0.031168455258011818, decouple_loss:0.01847788505256176
Iteration: 1487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4416298270225525, gen p mean: 0.0, mean p set: 0.4496765732765198
The modified gen p mean: 0.44376257061958313, gen p mean: 0.0, mean p set: 0.44885316491127014
The modified gen p mean: 0.44558480381965637, gen p mean: 0.0, mean p set: 0.4501534700393677
loss_pred:0.03108508698642254, decouple_loss:0.018930619582533836
loss_pred:0.03137357905507088, decouple_loss:0.018205581232905388
loss_pred:0.030950108543038368, decouple_loss:0.018668536096811295
Iteration: 1488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4600770175457001, gen p mean: 0.0, mean p set: 0.44845327734947205
The modified gen p mean: 0.46051526069641113, gen p mean: 0.0, mean p set: 0.45106619596481323
The modified gen p mean: 0.4566555321216583, gen p mean: 0.0, mean p set: 0.44949063658714294
loss_pred:0.030140025541186333, decouple_loss:0.01863923668861389
loss_pred:0.029598519206047058, decouple_loss:0.01785004697740078
loss_pred:0.030121255666017532, decouple_loss:0.01827152818441391
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
NaN value num: 0
Iteration: 1489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4431003928184509, gen p mean: 0.0, mean p set: 0.45106494426727295
The modified gen p mean: 0.45185109972953796, gen p mean: 0.0, mean p set: 0.45330584049224854
The modified gen p mean: 0.45277467370033264, gen p mean: 0.0, mean p set: 0.45127683877944946
loss_pred:0.03189383074641228, decouple_loss:0.022143984213471413
loss_pred:0.03096279688179493, decouple_loss:0.020399272441864014
loss_pred:0.02988535165786743, decouple_loss:0.020448198541998863
Iteration: 1490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43871456384658813, gen p mean: 0.0, mean p set: 0.4507175385951996
The modified gen p mean: 0.43652427196502686, gen p mean: 0.0, mean p set: 0.45042943954467773
The modified gen p mean: 0.44104087352752686, gen p mean: 0.0, mean p set: 0.4496786296367645
loss_pred:0.03034786880016327, decouple_loss:0.020271671935915947
loss_pred:0.03086041659116745, decouple_loss:0.02071680687367916
loss_pred:0.02990378998219967, decouple_loss:0.02104213647544384
2023-05-03 00:22:40 testing...
The modified gen p mean: 0.456289678812027, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4669257402420044, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.46277767419815063, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03123234584927559, decouple_loss:0.019735943526029587
loss_pred:0.029712729156017303, decouple_loss:0.019564682617783546
loss_pred:0.030180560424923897, decouple_loss:0.018958058208227158
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03134618699550629, avg_mse: 0.034955792129039764
current test mse: 0.034956
Iteration: 1491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4674748182296753, gen p mean: 0.0, mean p set: 0.4495096802711487
The modified gen p mean: 0.4673927426338196, gen p mean: 0.0, mean p set: 0.4497094452381134
loss_pred:0.030924538150429726, decouple_loss:0.0190399382263422
loss_pred:0.03012060560286045, decouple_loss:0.019849298521876335
The modified gen p mean: 0.46595147252082825, gen p mean: 0.0, mean p set: 0.450222373008728
loss_pred:0.030150210484862328, decouple_loss:0.01905893348157406
Iteration: 1492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46153756976127625, gen p mean: 0.0, mean p set: 0.45220720767974854
The modified gen p mean: 0.4588943123817444, gen p mean: 0.0, mean p set: 0.44880592823028564
The modified gen p mean: 0.46019914746284485, gen p mean: 0.0, mean p set: 0.44961294531822205
loss_pred:0.030967770144343376, decouple_loss:0.01999121718108654
loss_pred:0.02948816306889057, decouple_loss:0.01944354921579361
loss_pred:0.030485058203339577, decouple_loss:0.01983204483985901
Iteration: 1493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4258192181587219, gen p mean: 0.0, mean p set: 0.4497845768928528
The modified gen p mean: 0.429386705160141, gen p mean: 0.0, mean p set: 0.44914600253105164
The modified gen p mean: 0.42809489369392395, gen p mean: 0.0, mean p set: 0.45097601413726807
loss_pred:0.03166471794247627, decouple_loss:0.01930755190551281
loss_pred:0.030853459611535072, decouple_loss:0.020141789689660072
loss_pred:0.03127691149711609, decouple_loss:0.01936732977628708
Iteration: 1494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44159385561943054, gen p mean: 0.0, mean p set: 0.4502660930156708
The modified gen p mean: 0.4445144236087799, gen p mean: 0.0, mean p set: 0.4524822235107422
The modified gen p mean: 0.4451215863227844, gen p mean: 0.0, mean p set: 0.45162320137023926
loss_pred:0.030083905905485153, decouple_loss:0.018874458968639374
loss_pred:0.030279947444796562, decouple_loss:0.021099688485264778
loss_pred:0.030458196997642517, decouple_loss:0.020751135423779488
Iteration: 1495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4597824811935425, gen p mean: 0.0, mean p set: 0.45030519366264343
The modified gen p mean: 0.45820140838623047, gen p mean: 0.0, mean p set: 0.4495759904384613
The modified gen p mean: 0.4609767496585846, gen p mean: 0.0, mean p set: 0.4487481415271759
loss_pred:0.02966858074069023, decouple_loss:0.019086454063653946
loss_pred:0.03100288286805153, decouple_loss:0.018595771864056587
loss_pred:0.03058963641524315, decouple_loss:0.01942979171872139
Iteration: 1496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45629894733428955, gen p mean: 0.0, mean p set: 0.4491318166255951
The modified gen p mean: 0.46025875210762024, gen p mean: 0.0, mean p set: 0.45373791456222534
The modified gen p mean: 0.4583909809589386, gen p mean: 0.0, mean p set: 0.4496016502380371
loss_pred:0.02839190699160099, decouple_loss:0.019045047461986542
loss_pred:0.031853195279836655, decouple_loss:0.02064036950469017
loss_pred:0.030291158705949783, decouple_loss:0.019137248396873474
Iteration: 1497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45369085669517517, gen p mean: 0.0, mean p set: 0.45194050669670105
The modified gen p mean: 0.4499785006046295, gen p mean: 0.0, mean p set: 0.45149263739585876
The modified gen p mean: 0.45159608125686646, gen p mean: 0.0, mean p set: 0.45147207379341125
loss_pred:0.03127141296863556, decouple_loss:0.019906803965568542
loss_pred:0.029707632958889008, decouple_loss:0.01954946108162403
loss_pred:0.03171467408537865, decouple_loss:0.020559465512633324
Iteration: 1498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510922133922577, gen p mean: 0.0, mean p set: 0.4507306218147278
The modified gen p mean: 0.45019882917404175, gen p mean: 0.0, mean p set: 0.44938743114471436
The modified gen p mean: 0.4523373246192932, gen p mean: 0.0, mean p set: 0.45097923278808594
loss_pred:0.030579162761569023, decouple_loss:0.01946251094341278
loss_pred:0.02937648445367813, decouple_loss:0.019276199862360954
loss_pred:0.02924225479364395, decouple_loss:0.019069762900471687
Iteration: 1499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4405162036418915, gen p mean: 0.0, mean p set: 0.4489399194717407
The modified gen p mean: 0.44203564524650574, gen p mean: 0.0, mean p set: 0.4529705345630646
The modified gen p mean: 0.44453302025794983, gen p mean: 0.0, mean p set: 0.44929495453834534
loss_pred:0.028650036081671715, decouple_loss:0.0189250186085701
loss_pred:0.03029545396566391, decouple_loss:0.01968689076602459
loss_pred:0.029776738956570625, decouple_loss:0.01897798664867878
Iteration: 1500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44137871265411377, gen p mean: 0.0, mean p set: 0.4489029347896576
The modified gen p mean: 0.4439052641391754, gen p mean: 0.0, mean p set: 0.45026499032974243
The modified gen p mean: 0.4425130784511566, gen p mean: 0.0, mean p set: 0.4500787556171417
loss_pred:0.028615139424800873, decouple_loss:0.01836877129971981
loss_pred:0.02883833274245262, decouple_loss:0.01961361989378929
loss_pred:0.03082943521440029, decouple_loss:0.01860957406461239
2023-05-03 00:26:23 testing...
The modified gen p mean: 0.4438868463039398, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4500634968280792, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4535371661186218, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03140633925795555, decouple_loss:0.021483128890395164
loss_pred:0.030361711978912354, decouple_loss:0.020928803831338882
loss_pred:0.029766859486699104, decouple_loss:0.021337004378437996
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03157412260770798, avg_mse: 0.0352238304913044
current test mse: 0.035224
Iteration: 1501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4563601613044739, gen p mean: 0.0, mean p set: 0.4515989124774933
The modified gen p mean: 0.4565731883049011, gen p mean: 0.0, mean p set: 0.4495715796947479
loss_pred:0.030943075194954872, decouple_loss:0.020096754655241966
loss_pred:0.03053658828139305, decouple_loss:0.02048301510512829
The modified gen p mean: 0.4564712345600128, gen p mean: 0.0, mean p set: 0.4494609236717224
loss_pred:0.030524134635925293, decouple_loss:0.02058308757841587
Iteration: 1502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4556863307952881, gen p mean: 0.0, mean p set: 0.4493706524372101
The modified gen p mean: 0.4540956914424896, gen p mean: 0.0, mean p set: 0.44892165064811707
The modified gen p mean: 0.4550721347332001, gen p mean: 0.0, mean p set: 0.4515543580055237
loss_pred:0.029508095234632492, decouple_loss:0.01865779235959053
loss_pred:0.03044421412050724, decouple_loss:0.02010391838848591
loss_pred:0.03131639584898949, decouple_loss:0.02056085504591465
Iteration: 1503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469030499458313, gen p mean: 0.0, mean p set: 0.4501922130584717
The modified gen p mean: 0.4522719383239746, gen p mean: 0.0, mean p set: 0.450965940952301
The modified gen p mean: 0.4444098174571991, gen p mean: 0.0, mean p set: 0.45005717873573303
loss_pred:0.030002888292074203, decouple_loss:0.018853751942515373
loss_pred:0.031131213530898094, decouple_loss:0.020308934152126312
loss_pred:0.030339650809764862, decouple_loss:0.019294951111078262
Iteration: 1504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454323947429657, gen p mean: 0.0, mean p set: 0.4517059326171875
The modified gen p mean: 0.4541766941547394, gen p mean: 0.0, mean p set: 0.45004913210868835
The modified gen p mean: 0.4531068801879883, gen p mean: 0.0, mean p set: 0.4513741731643677
loss_pred:0.030978510156273842, decouple_loss:0.020392360165715218
loss_pred:0.03048710711300373, decouple_loss:0.019533872604370117
loss_pred:0.029983919113874435, decouple_loss:0.01923156902194023
Iteration: 1505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447892427444458, gen p mean: 0.0, mean p set: 0.44999220967292786
The modified gen p mean: 0.44587549567222595, gen p mean: 0.0, mean p set: 0.4497406780719757
The modified gen p mean: 0.44870734214782715, gen p mean: 0.0, mean p set: 0.45222410559654236
loss_pred:0.030484510585665703, decouple_loss:0.018811596557497978
loss_pred:0.02886468544602394, decouple_loss:0.0184487234801054
loss_pred:0.03086777590215206, decouple_loss:0.019550886005163193
Iteration: 1506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474274218082428, gen p mean: 0.0, mean p set: 0.4533670246601105
The modified gen p mean: 0.4393687844276428, gen p mean: 0.0, mean p set: 0.45067140460014343
The modified gen p mean: 0.4482261836528778, gen p mean: 0.0, mean p set: 0.4490891993045807
loss_pred:0.030535444617271423, decouple_loss:0.019410602748394012
loss_pred:0.029922446236014366, decouple_loss:0.018937550485134125
loss_pred:0.030711812898516655, decouple_loss:0.01846511848270893
Iteration: 1507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45527228713035583, gen p mean: 0.0, mean p set: 0.4505888819694519
The modified gen p mean: 0.456796795129776, gen p mean: 0.0, mean p set: 0.45148617029190063
The modified gen p mean: 0.45373138785362244, gen p mean: 0.0, mean p set: 0.4496089518070221
loss_pred:0.030832564458251, decouple_loss:0.019904058426618576
loss_pred:0.030010158196091652, decouple_loss:0.019137393683195114
loss_pred:0.031340427696704865, decouple_loss:0.019627230241894722
Iteration: 1508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45315098762512207, gen p mean: 0.0, mean p set: 0.4503369629383087
The modified gen p mean: 0.45827555656433105, gen p mean: 0.0, mean p set: 0.45101216435432434
The modified gen p mean: 0.45826825499534607, gen p mean: 0.0, mean p set: 0.45125457644462585
loss_pred:0.029537571594119072, decouple_loss:0.019160930067300797
loss_pred:0.029244406148791313, decouple_loss:0.01885388046503067
loss_pred:0.029768608510494232, decouple_loss:0.018532786518335342
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 1509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44191014766693115, gen p mean: 0.0, mean p set: 0.44819772243499756
The modified gen p mean: 0.44320738315582275, gen p mean: 0.0, mean p set: 0.44735097885131836
The modified gen p mean: 0.44246968626976013, gen p mean: 0.0, mean p set: 0.44718724489212036
loss_pred:0.03053215518593788, decouple_loss:0.02155422605574131
loss_pred:0.03130658343434334, decouple_loss:0.021395057439804077
loss_pred:0.03199435770511627, decouple_loss:0.021501831710338593
Iteration: 1510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465799629688263, gen p mean: 0.0, mean p set: 0.44724246859550476
The modified gen p mean: 0.44218629598617554, gen p mean: 0.0, mean p set: 0.4478035867214203
The modified gen p mean: 0.44501420855522156, gen p mean: 0.0, mean p set: 0.4476585388183594
loss_pred:0.030310476198792458, decouple_loss:0.020919175818562508
loss_pred:0.030423466116189957, decouple_loss:0.020817779004573822
loss_pred:0.030119076371192932, decouple_loss:0.020536253228783607
2023-05-03 00:30:46 testing...
The modified gen p mean: 0.4557410478591919, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4491596221923828, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45867928862571716, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.030213627964258194, decouple_loss:0.020014189183712006
loss_pred:0.031279876828193665, decouple_loss:0.02080336958169937
loss_pred:0.02967105619609356, decouple_loss:0.020318930968642235
WV_0_PC_0_EH_0_PS_40_6, loss: 0.031407129019498825, avg_mse: 0.0349772572517395
current test mse: 0.034977
Iteration: 1511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45908722281455994, gen p mean: 0.0, mean p set: 0.44658011198043823
The modified gen p mean: 0.4528217911720276, gen p mean: 0.0, mean p set: 0.4474363923072815
loss_pred:0.031377196311950684, decouple_loss:0.020083963871002197
loss_pred:0.030224334448575974, decouple_loss:0.020418938249349594
The modified gen p mean: 0.4547736942768097, gen p mean: 0.0, mean p set: 0.4474417567253113
loss_pred:0.030087251216173172, decouple_loss:0.01997353509068489
Iteration: 1512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4412652850151062, gen p mean: 0.0, mean p set: 0.44850221276283264
The modified gen p mean: 0.44894939661026, gen p mean: 0.0, mean p set: 0.4466211497783661
The modified gen p mean: 0.44274047017097473, gen p mean: 0.0, mean p set: 0.4478381872177124
loss_pred:0.029928887262940407, decouple_loss:0.01996173895895481
loss_pred:0.03048902563750744, decouple_loss:0.0193728506565094
loss_pred:0.029634155333042145, decouple_loss:0.019622687250375748
Iteration: 1513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43916431069374084, gen p mean: 0.0, mean p set: 0.44829118251800537
The modified gen p mean: 0.442885160446167, gen p mean: 0.0, mean p set: 0.44783177971839905
The modified gen p mean: 0.4417664110660553, gen p mean: 0.0, mean p set: 0.4464643895626068
loss_pred:0.03071681782603264, decouple_loss:0.019350146874785423
loss_pred:0.030816372483968735, decouple_loss:0.01936759613454342
loss_pred:0.03083220310509205, decouple_loss:0.019119450822472572
Iteration: 1514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452122151851654, gen p mean: 0.0, mean p set: 0.4474670886993408
The modified gen p mean: 0.4492920935153961, gen p mean: 0.0, mean p set: 0.4477064609527588
The modified gen p mean: 0.4463338255882263, gen p mean: 0.0, mean p set: 0.44731974601745605
loss_pred:0.029193084686994553, decouple_loss:0.018582357093691826
loss_pred:0.0296750720590353, decouple_loss:0.018782678991556168
loss_pred:0.02967376448214054, decouple_loss:0.019517580047249794
Iteration: 1515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527480900287628, gen p mean: 0.0, mean p set: 0.44692397117614746
The modified gen p mean: 0.44642728567123413, gen p mean: 0.0, mean p set: 0.44930580258369446
The modified gen p mean: 0.45478302240371704, gen p mean: 0.0, mean p set: 0.4474965035915375
loss_pred:0.030060162767767906, decouple_loss:0.01831209473311901
loss_pred:0.029646560549736023, decouple_loss:0.018923506140708923
loss_pred:0.02943340875208378, decouple_loss:0.018745463341474533
Iteration: 1516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776850938796997, gen p mean: 0.0, mean p set: 0.44772762060165405
The modified gen p mean: 0.4450550973415375, gen p mean: 0.0, mean p set: 0.4483036994934082
The modified gen p mean: 0.44958260655403137, gen p mean: 0.0, mean p set: 0.44806966185569763
loss_pred:0.028719983994960785, decouple_loss:0.01861627958714962
loss_pred:0.029217513278126717, decouple_loss:0.01966845989227295
loss_pred:0.029570942744612694, decouple_loss:0.018515940755605698
Iteration: 1517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671830534935, gen p mean: 0.0, mean p set: 0.4465442895889282
The modified gen p mean: 0.4422350823879242, gen p mean: 0.0, mean p set: 0.448570191860199
The modified gen p mean: 0.4479982256889343, gen p mean: 0.0, mean p set: 0.4474518895149231
loss_pred:0.029933055862784386, decouple_loss:0.018949218094348907
loss_pred:0.03062635473906994, decouple_loss:0.018385162577033043
loss_pred:0.030187983065843582, decouple_loss:0.01933417282998562
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076456665992737, gen p mean: 0.0, mean p set: 0.4476762115955353
The modified gen p mean: 0.45029163360595703, gen p mean: 0.0, mean p set: 0.44724223017692566
The modified gen p mean: 0.4480825662612915, gen p mean: 0.0, mean p set: 0.447585791349411
loss_pred:0.029388681054115295, decouple_loss:0.018477868288755417
loss_pred:0.029777493327856064, decouple_loss:0.018718352541327477
loss_pred:0.029569653794169426, decouple_loss:0.018354592844843864
Iteration: 1519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4567165970802307, gen p mean: 0.0, mean p set: 0.4481275677680969
The modified gen p mean: 0.4561616778373718, gen p mean: 0.0, mean p set: 0.446504145860672
The modified gen p mean: 0.45437759160995483, gen p mean: 0.0, mean p set: 0.4475627839565277
loss_pred:0.02990826405584812, decouple_loss:0.01812594197690487
loss_pred:0.03029591217637062, decouple_loss:0.018805911764502525
loss_pred:0.028263721615076065, decouple_loss:0.01777138002216816
Iteration: 1520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4344825744628906, gen p mean: 0.0, mean p set: 0.44833290576934814
The modified gen p mean: 0.4404652714729309, gen p mean: 0.0, mean p set: 0.44651639461517334
The modified gen p mean: 0.4380553364753723, gen p mean: 0.0, mean p set: 0.4472809433937073
loss_pred:0.029692115262150764, decouple_loss:0.0174818504601717
loss_pred:0.030342359095811844, decouple_loss:0.018138227984309196
loss_pred:0.030238788574934006, decouple_loss:0.017886647954583168
2023-05-03 00:34:26 testing...
The modified gen p mean: 0.445149302482605, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4348762631416321, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4416142404079437, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.029462864622473717, decouple_loss:0.018733486533164978
loss_pred:0.031000949442386627, decouple_loss:0.01929820142686367
loss_pred:0.029943201690912247, decouple_loss:0.01875905692577362
WV_0_PC_0_EH_0_PS_40_6, loss: 0.031082183122634888, avg_mse: 0.03470712900161743
current test mse: 0.034707
Iteration: 1521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4366273283958435, gen p mean: 0.0, mean p set: 0.4479915201663971
The modified gen p mean: 0.44317319989204407, gen p mean: 0.0, mean p set: 0.4465225338935852
loss_pred:0.029466813430190086, decouple_loss:0.018891217187047005
loss_pred:0.029804790392518044, decouple_loss:0.017673984169960022
The modified gen p mean: 0.43918436765670776, gen p mean: 0.0, mean p set: 0.4473459720611572
loss_pred:0.02968553453683853, decouple_loss:0.018572915345430374
Iteration: 1522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.463328093290329, gen p mean: 0.0, mean p set: 0.44700121879577637
The modified gen p mean: 0.4604248106479645, gen p mean: 0.0, mean p set: 0.447593629360199
The modified gen p mean: 0.4591922163963318, gen p mean: 0.0, mean p set: 0.44738972187042236
loss_pred:0.029613712802529335, decouple_loss:0.018332544714212418
loss_pred:0.02915692701935768, decouple_loss:0.01757689379155636
loss_pred:0.030548367649316788, decouple_loss:0.018196003511548042
Iteration: 1523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481850266456604, gen p mean: 0.0, mean p set: 0.44856566190719604
The modified gen p mean: 0.44918954372406006, gen p mean: 0.0, mean p set: 0.44846251606941223
The modified gen p mean: 0.4533574879169464, gen p mean: 0.0, mean p set: 0.4467797577381134
loss_pred:0.029199618846178055, decouple_loss:0.018067050725221634
loss_pred:0.028915848582983017, decouple_loss:0.017855484038591385
loss_pred:0.02968347817659378, decouple_loss:0.01771843247115612
Iteration: 1524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4433317184448242, gen p mean: 0.0, mean p set: 0.4471836984157562
The modified gen p mean: 0.44115716218948364, gen p mean: 0.0, mean p set: 0.44673141837120056
The modified gen p mean: 0.4410432279109955, gen p mean: 0.0, mean p set: 0.44702303409576416
loss_pred:0.03003760240972042, decouple_loss:0.017465827986598015
loss_pred:0.030604027211666107, decouple_loss:0.017100133001804352
loss_pred:0.029783571138978004, decouple_loss:0.017057931050658226
Iteration: 1525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450632631778717, gen p mean: 0.0, mean p set: 0.447394996881485
The modified gen p mean: 0.44162827730178833, gen p mean: 0.0, mean p set: 0.44701918959617615
The modified gen p mean: 0.44782429933547974, gen p mean: 0.0, mean p set: 0.447368860244751
loss_pred:0.02947366051375866, decouple_loss:0.016581835225224495
loss_pred:0.029825791716575623, decouple_loss:0.017550917342305183
loss_pred:0.030016329139471054, decouple_loss:0.016623640432953835
Iteration: 1526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464136064052582, gen p mean: 0.0, mean p set: 0.4475724399089813
The modified gen p mean: 0.44699826836586, gen p mean: 0.0, mean p set: 0.4470658302307129
The modified gen p mean: 0.4510919153690338, gen p mean: 0.0, mean p set: 0.44767507910728455
loss_pred:0.02849077433347702, decouple_loss:0.016647059470415115
loss_pred:0.030706293880939484, decouple_loss:0.017204079777002335
loss_pred:0.02858499065041542, decouple_loss:0.01726437732577324
Iteration: 1527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44345152378082275, gen p mean: 0.0, mean p set: 0.44781920313835144
The modified gen p mean: 0.4447050392627716, gen p mean: 0.0, mean p set: 0.4463328719139099
The modified gen p mean: 0.4426119923591614, gen p mean: 0.0, mean p set: 0.4475339949131012
loss_pred:0.029716450721025467, decouple_loss:0.01689966209232807
loss_pred:0.02997463569045067, decouple_loss:0.016775012016296387
loss_pred:0.02966618910431862, decouple_loss:0.01741608791053295
Iteration: 1528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44223108887672424, gen p mean: 0.0, mean p set: 0.4489026963710785
The modified gen p mean: 0.4509720802307129, gen p mean: 0.0, mean p set: 0.4466512203216553
The modified gen p mean: 0.4501933157444, gen p mean: 0.0, mean p set: 0.4475582242012024
loss_pred:0.02914891578257084, decouple_loss:0.01767137087881565
loss_pred:0.03116988204419613, decouple_loss:0.01711207441985607
loss_pred:0.02862967737019062, decouple_loss:0.017572712153196335
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
NaN value num: 0
Iteration: 1529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45634719729423523, gen p mean: 0.0, mean p set: 0.45273926854133606
The modified gen p mean: 0.4604979455471039, gen p mean: 0.0, mean p set: 0.45219212770462036
The modified gen p mean: 0.45999908447265625, gen p mean: 0.0, mean p set: 0.45176076889038086
loss_pred:0.030456773936748505, decouple_loss:0.021000610664486885
loss_pred:0.030115317553281784, decouple_loss:0.02101999893784523
loss_pred:0.028794949874281883, decouple_loss:0.020169774070382118
Iteration: 1530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4573451578617096, gen p mean: 0.0, mean p set: 0.4531923532485962
The modified gen p mean: 0.46480390429496765, gen p mean: 0.0, mean p set: 0.452399343252182
The modified gen p mean: 0.45609089732170105, gen p mean: 0.0, mean p set: 0.4549979567527771
loss_pred:0.030642926692962646, decouple_loss:0.020344644784927368
loss_pred:0.030403567478060722, decouple_loss:0.0201861672103405
loss_pred:0.03161041438579559, decouple_loss:0.021289274096488953
2023-05-03 00:38:43 testing...
The modified gen p mean: 0.44198572635650635, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4355403780937195, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44553014636039734, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.029909338802099228, decouple_loss:0.01873946003615856
loss_pred:0.0310035552829504, decouple_loss:0.019360791891813278
loss_pred:0.02945924736559391, decouple_loss:0.018746232613921165
WV_0_PC_0_EH_0_PS_40_6, loss: 0.031071489676833153, avg_mse: 0.03476991876959801
current test mse: 0.03477
Iteration: 1531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462810158729553, gen p mean: 0.0, mean p set: 0.45298275351524353
The modified gen p mean: 0.44330278038978577, gen p mean: 0.0, mean p set: 0.45208826661109924
loss_pred:0.03105769492685795, decouple_loss:0.02089010924100876
loss_pred:0.02908286824822426, decouple_loss:0.018751436844468117
The modified gen p mean: 0.44373470544815063, gen p mean: 0.0, mean p set: 0.45377665758132935
loss_pred:0.029461313039064407, decouple_loss:0.02000778540968895
Iteration: 1532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847372174263, gen p mean: 0.0, mean p set: 0.4529195725917816
The modified gen p mean: 0.4516178369522095, gen p mean: 0.0, mean p set: 0.4508306682109833
The modified gen p mean: 0.44902610778808594, gen p mean: 0.0, mean p set: 0.45506227016448975
loss_pred:0.030382780358195305, decouple_loss:0.019029324874281883
loss_pred:0.030635541304945946, decouple_loss:0.019094256684184074
loss_pred:0.03104248456656933, decouple_loss:0.01971990056335926
Iteration: 1533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46016427874565125, gen p mean: 0.0, mean p set: 0.45203670859336853
The modified gen p mean: 0.45896074175834656, gen p mean: 0.0, mean p set: 0.4540198743343353
The modified gen p mean: 0.45715442299842834, gen p mean: 0.0, mean p set: 0.4543079137802124
loss_pred:0.03112061694264412, decouple_loss:0.018864603713154793
loss_pred:0.03056276962161064, decouple_loss:0.01935509964823723
loss_pred:0.03088383749127388, decouple_loss:0.01940087601542473
Iteration: 1534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44577649235725403, gen p mean: 0.0, mean p set: 0.45484670996665955
The modified gen p mean: 0.45091626048088074, gen p mean: 0.0, mean p set: 0.45417800545692444
The modified gen p mean: 0.4493626058101654, gen p mean: 0.0, mean p set: 0.4538169205188751
loss_pred:0.03001057542860508, decouple_loss:0.019583947956562042
loss_pred:0.03048958070576191, decouple_loss:0.019640589132905006
loss_pred:0.02870151586830616, decouple_loss:0.019358942285180092
Iteration: 1535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453195184469223, gen p mean: 0.0, mean p set: 0.45412477850914
The modified gen p mean: 0.44424253702163696, gen p mean: 0.0, mean p set: 0.4530661106109619
The modified gen p mean: 0.44837066531181335, gen p mean: 0.0, mean p set: 0.4530290365219116
loss_pred:0.030612092465162277, decouple_loss:0.019750095903873444
loss_pred:0.02968043088912964, decouple_loss:0.019381308928132057
loss_pred:0.029887109994888306, decouple_loss:0.01884961873292923
Iteration: 1536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46046945452690125, gen p mean: 0.0, mean p set: 0.4524010717868805
The modified gen p mean: 0.4593033492565155, gen p mean: 0.0, mean p set: 0.4548746943473816
The modified gen p mean: 0.458665668964386, gen p mean: 0.0, mean p set: 0.453119158744812
loss_pred:0.031198225915431976, decouple_loss:0.020610768347978592
loss_pred:0.030469195917248726, decouple_loss:0.019801896065473557
loss_pred:0.031145457178354263, decouple_loss:0.02084752544760704
Iteration: 1537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.455823689699173, gen p mean: 0.0, mean p set: 0.45306292176246643
The modified gen p mean: 0.46159443259239197, gen p mean: 0.0, mean p set: 0.45351678133010864
The modified gen p mean: 0.4595705568790436, gen p mean: 0.0, mean p set: 0.4533842206001282
loss_pred:0.03103064000606537, decouple_loss:0.0199931338429451
loss_pred:0.030220424756407738, decouple_loss:0.01895255036652088
loss_pred:0.03135993331670761, decouple_loss:0.019618341699242592
Iteration: 1538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44383159279823303, gen p mean: 0.0, mean p set: 0.4535352885723114
The modified gen p mean: 0.4473876655101776, gen p mean: 0.0, mean p set: 0.4528021812438965
The modified gen p mean: 0.44640490412712097, gen p mean: 0.0, mean p set: 0.45214447379112244
loss_pred:0.030264699831604958, decouple_loss:0.0194453876465559
loss_pred:0.031603991985321045, decouple_loss:0.019449951127171516
loss_pred:0.031406134366989136, decouple_loss:0.019255144521594048
Iteration: 1539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519241750240326, gen p mean: 0.0, mean p set: 0.45232921838760376
The modified gen p mean: 0.4519108831882477, gen p mean: 0.0, mean p set: 0.4520424008369446
The modified gen p mean: 0.4498116374015808, gen p mean: 0.0, mean p set: 0.45278772711753845
loss_pred:0.030090510845184326, decouple_loss:0.019108209758996964
loss_pred:0.031397681683301926, decouple_loss:0.01982167363166809
loss_pred:0.03157879412174225, decouple_loss:0.01926739700138569
Iteration: 1540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477424919605255, gen p mean: 0.0, mean p set: 0.4532190263271332
The modified gen p mean: 0.4471823573112488, gen p mean: 0.0, mean p set: 0.45405256748199463
The modified gen p mean: 0.4534631371498108, gen p mean: 0.0, mean p set: 0.4524155259132385
loss_pred:0.029616257175803185, decouple_loss:0.019138149917125702
loss_pred:0.03045113943517208, decouple_loss:0.018964307382702827
loss_pred:0.030136676505208015, decouple_loss:0.019307635724544525
2023-05-03 00:42:22 testing...
The modified gen p mean: 0.4526907801628113, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4467184543609619, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4555940330028534, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.030203890055418015, decouple_loss:0.020186325535178185
loss_pred:0.03124493733048439, decouple_loss:0.020724643021821976
loss_pred:0.029731227084994316, decouple_loss:0.02058110013604164
WV_0_PC_0_EH_0_PS_40_6, loss: 0.031418219208717346, avg_mse: 0.03533102944493294
current test mse: 0.035331
Iteration: 1541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45456019043922424, gen p mean: 0.0, mean p set: 0.4522961974143982
The modified gen p mean: 0.45314279198646545, gen p mean: 0.0, mean p set: 0.45331934094429016
loss_pred:0.0309627465903759, decouple_loss:0.018460813909769058
loss_pred:0.03020709566771984, decouple_loss:0.018134821206331253
The modified gen p mean: 0.45601508021354675, gen p mean: 0.0, mean p set: 0.4538425803184509
loss_pred:0.03129992634057999, decouple_loss:0.018013717606663704
Iteration: 1542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4550103545188904, gen p mean: 0.0, mean p set: 0.45272231101989746
The modified gen p mean: 0.453040212392807, gen p mean: 0.0, mean p set: 0.45156678557395935
The modified gen p mean: 0.45917826890945435, gen p mean: 0.0, mean p set: 0.4536438286304474
loss_pred:0.029098475351929665, decouple_loss:0.01836114563047886
loss_pred:0.030856577679514885, decouple_loss:0.018321368843317032
loss_pred:0.030585722997784615, decouple_loss:0.019590001553297043
Iteration: 1543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492236077785492, gen p mean: 0.0, mean p set: 0.4522446393966675
The modified gen p mean: 0.44713589549064636, gen p mean: 0.0, mean p set: 0.4531553387641907
The modified gen p mean: 0.44639408588409424, gen p mean: 0.0, mean p set: 0.45522719621658325
loss_pred:0.03112797997891903, decouple_loss:0.01852722279727459
loss_pred:0.029859634116292, decouple_loss:0.01830316334962845
loss_pred:0.030749604105949402, decouple_loss:0.01863592490553856
Iteration: 1544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537924528121948, gen p mean: 0.0, mean p set: 0.4541594386100769
The modified gen p mean: 0.4555509388446808, gen p mean: 0.0, mean p set: 0.45248425006866455
The modified gen p mean: 0.45514047145843506, gen p mean: 0.0, mean p set: 0.45362505316734314
loss_pred:0.03026263788342476, decouple_loss:0.01901857554912567
loss_pred:0.029902547597885132, decouple_loss:0.01756170205771923
loss_pred:0.030782898887991905, decouple_loss:0.01873197965323925
Iteration: 1545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45838499069213867, gen p mean: 0.0, mean p set: 0.45221033692359924
The modified gen p mean: 0.4591265916824341, gen p mean: 0.0, mean p set: 0.45251336693763733
The modified gen p mean: 0.45593228936195374, gen p mean: 0.0, mean p set: 0.454429566860199
loss_pred:0.028990210965275764, decouple_loss:0.017688963562250137
loss_pred:0.03151862695813179, decouple_loss:0.0189680065959692
loss_pred:0.029907839372754097, decouple_loss:0.01837165839970112
Iteration: 1546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45449575781822205, gen p mean: 0.0, mean p set: 0.4523732364177704
The modified gen p mean: 0.4532392919063568, gen p mean: 0.0, mean p set: 0.45280152559280396
The modified gen p mean: 0.4485763907432556, gen p mean: 0.0, mean p set: 0.4537392258644104
loss_pred:0.031124833971261978, decouple_loss:0.018081974238157272
loss_pred:0.030507802963256836, decouple_loss:0.018769521266222
loss_pred:0.030591584742069244, decouple_loss:0.01827341690659523
Iteration: 1547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758230447769165, gen p mean: 0.0, mean p set: 0.452383428812027
The modified gen p mean: 0.4491228461265564, gen p mean: 0.0, mean p set: 0.4522660970687866
The modified gen p mean: 0.4488358199596405, gen p mean: 0.0, mean p set: 0.45158764719963074
loss_pred:0.03074272908270359, decouple_loss:0.017245281487703323
loss_pred:0.03154895082116127, decouple_loss:0.018340369686484337
loss_pred:0.030450746417045593, decouple_loss:0.017265718430280685
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
NaN value num: 0
Iteration: 1548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533173143863678, gen p mean: 0.0, mean p set: 0.45129647850990295
The modified gen p mean: 0.44946014881134033, gen p mean: 0.0, mean p set: 0.44948065280914307
The modified gen p mean: 0.4501529037952423, gen p mean: 0.0, mean p set: 0.4492340683937073
loss_pred:0.031061645597219467, decouple_loss:0.019156955182552338
loss_pred:0.03171997889876366, decouple_loss:0.01906774751842022
loss_pred:0.03035801090300083, decouple_loss:0.018281934782862663
Iteration: 1549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477013647556305, gen p mean: 0.0, mean p set: 0.4498836100101471
The modified gen p mean: 0.44765013456344604, gen p mean: 0.0, mean p set: 0.44923514127731323
The modified gen p mean: 0.44545820355415344, gen p mean: 0.0, mean p set: 0.4487510621547699
loss_pred:0.031172197312116623, decouple_loss:0.019055714830756187
loss_pred:0.03192848712205887, decouple_loss:0.01993456482887268
loss_pred:0.03103530965745449, decouple_loss:0.01869248040020466
Iteration: 1550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44013741612434387, gen p mean: 0.0, mean p set: 0.44837433099746704
The modified gen p mean: 0.4432584047317505, gen p mean: 0.0, mean p set: 0.4494612514972687
loss_pred:0.030967365950345993, decouple_loss:0.019149839878082275
The modified gen p mean: 0.4474288523197174, gen p mean: 0.0, mean p set: 0.4489240050315857
loss_pred:0.031060026958584785, decouple_loss:0.01906668022274971
loss_pred:0.03040993958711624, decouple_loss:0.019546177238225937
2023-05-03 00:46:41 testing...
The modified gen p mean: 0.4545464515686035, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4483412206172943, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4576149880886078, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.030082155019044876, decouple_loss:0.01980735920369625
loss_pred:0.031134571880102158, decouple_loss:0.020460031926631927
loss_pred:0.029612137004733086, decouple_loss:0.020025651901960373
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03128117322921753, avg_mse: 0.03513294830918312
current test mse: 0.035133
Iteration: 1551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45742711424827576, gen p mean: 0.0, mean p set: 0.4528312385082245
loss_pred:0.029137516394257545, decouple_loss:0.018644552677869797
The modified gen p mean: 0.45707061886787415, gen p mean: 0.0, mean p set: 0.44954103231430054
loss_pred:0.030285730957984924, decouple_loss:0.018471859395503998
The modified gen p mean: 0.4550287425518036, gen p mean: 0.0, mean p set: 0.4502134323120117
loss_pred:0.029697706922888756, decouple_loss:0.01832634024322033
Iteration: 1552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521926939487457, gen p mean: 0.0, mean p set: 0.45197123289108276
The modified gen p mean: 0.45160767436027527, gen p mean: 0.0, mean p set: 0.450508713722229
The modified gen p mean: 0.45454493165016174, gen p mean: 0.0, mean p set: 0.4517812132835388
loss_pred:0.03151609003543854, decouple_loss:0.01827584207057953
loss_pred:0.028473474085330963, decouple_loss:0.018087085336446762
loss_pred:0.030726760625839233, decouple_loss:0.018001873046159744
Iteration: 1553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44999730587005615, gen p mean: 0.0, mean p set: 0.4502566158771515
The modified gen p mean: 0.45496150851249695, gen p mean: 0.0, mean p set: 0.4513488709926605
The modified gen p mean: 0.4546738862991333, gen p mean: 0.0, mean p set: 0.44873207807540894
loss_pred:0.030918197706341743, decouple_loss:0.018248548731207848
loss_pred:0.029880039393901825, decouple_loss:0.017971958965063095
loss_pred:0.029830005019903183, decouple_loss:0.01841271109879017
Iteration: 1554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450865387916565, gen p mean: 0.0, mean p set: 0.4494549334049225
The modified gen p mean: 0.4449618458747864, gen p mean: 0.0, mean p set: 0.44886186718940735
The modified gen p mean: 0.44525307416915894, gen p mean: 0.0, mean p set: 0.4494513273239136
loss_pred:0.03083541989326477, decouple_loss:0.018114451318979263
loss_pred:0.03027511015534401, decouple_loss:0.017955154180526733
loss_pred:0.031192712485790253, decouple_loss:0.018672900274395943
Iteration: 1555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4434904456138611, gen p mean: 0.0, mean p set: 0.450663685798645
The modified gen p mean: 0.4425758719444275, gen p mean: 0.0, mean p set: 0.44809725880622864
The modified gen p mean: 0.44700995087623596, gen p mean: 0.0, mean p set: 0.4488198161125183
loss_pred:0.028754036873579025, decouple_loss:0.017446191981434822
loss_pred:0.030314382165670395, decouple_loss:0.017899958416819572
loss_pred:0.03210956230759621, decouple_loss:0.01802259124815464
Iteration: 1556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45429733395576477, gen p mean: 0.0, mean p set: 0.4495103359222412
The modified gen p mean: 0.45140284299850464, gen p mean: 0.0, mean p set: 0.45059719681739807
The modified gen p mean: 0.4505927562713623, gen p mean: 0.0, mean p set: 0.45067182183265686
loss_pred:0.0319586843252182, decouple_loss:0.018768128007650375
loss_pred:0.02937745302915573, decouple_loss:0.018514521420001984
loss_pred:0.02950974740087986, decouple_loss:0.017878474667668343
Iteration: 1557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454308748245239, gen p mean: 0.0, mean p set: 0.45223987102508545
The modified gen p mean: 0.4440573453903198, gen p mean: 0.0, mean p set: 0.45099538564682007
The modified gen p mean: 0.4457840025424957, gen p mean: 0.0, mean p set: 0.4507533609867096
loss_pred:0.02909017726778984, decouple_loss:0.018093999475240707
loss_pred:0.029031390324234962, decouple_loss:0.01804661937057972
loss_pred:0.02899535559117794, decouple_loss:0.017620356753468513
Iteration: 1558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4554680585861206, gen p mean: 0.0, mean p set: 0.45017653703689575
The modified gen p mean: 0.45448073744773865, gen p mean: 0.0, mean p set: 0.44862303137779236
The modified gen p mean: 0.45393437147140503, gen p mean: 0.0, mean p set: 0.4495765268802643
loss_pred:0.030849412083625793, decouple_loss:0.01832258142530918
loss_pred:0.030232207849621773, decouple_loss:0.017885467037558556
loss_pred:0.030626771971583366, decouple_loss:0.0179938692599535
Iteration: 1559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4568135440349579, gen p mean: 0.0, mean p set: 0.4513806104660034
The modified gen p mean: 0.4620097875595093, gen p mean: 0.0, mean p set: 0.4494934380054474
The modified gen p mean: 0.4595058560371399, gen p mean: 0.0, mean p set: 0.4499092102050781
loss_pred:0.029112493619322777, decouple_loss:0.01833733730018139
loss_pred:0.029769210144877434, decouple_loss:0.017688950523734093
loss_pred:0.02885456010699272, decouple_loss:0.017430242151021957
Iteration: 1560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44537588953971863, gen p mean: 0.0, mean p set: 0.45149844884872437
The modified gen p mean: 0.4461473524570465, gen p mean: 0.0, mean p set: 0.45071372389793396
The modified gen p mean: 0.44772985577583313, gen p mean: 0.0, mean p set: 0.4495048522949219
loss_pred:0.029729630798101425, decouple_loss:0.01765316352248192
loss_pred:0.029295623302459717, decouple_loss:0.017916180193424225
loss_pred:0.031529150903224945, decouple_loss:0.017840489745140076
2023-05-03 00:50:23 testing...
The modified gen p mean: 0.4327390789985657, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.43949803709983826, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44288626313209534, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03120223991572857, decouple_loss:0.020375000312924385
loss_pred:0.03004310093820095, decouple_loss:0.019766755402088165loss_pred:0.02953893318772316, decouple_loss:0.020013077184557915
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03126400709152222, avg_mse: 0.03507836535573006
current test mse: 0.035078
Iteration: 1561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44315874576568604, gen p mean: 0.0, mean p set: 0.4499458968639374
The modified gen p mean: 0.44039663672447205, gen p mean: 0.0, mean p set: 0.45234742760658264
loss_pred:0.031029371544718742, decouple_loss:0.017800502479076385
loss_pred:0.0289886686950922, decouple_loss:0.017663411796092987
The modified gen p mean: 0.4409254193305969, gen p mean: 0.0, mean p set: 0.45011773705482483
loss_pred:0.03123042732477188, decouple_loss:0.018174810335040092
Iteration: 1562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45368459820747375, gen p mean: 0.0, mean p set: 0.45117899775505066
The modified gen p mean: 0.45294639468193054, gen p mean: 0.0, mean p set: 0.45014408230781555
The modified gen p mean: 0.45033541321754456, gen p mean: 0.0, mean p set: 0.449567049741745
loss_pred:0.029283707961440086, decouple_loss:0.017615770921111107
loss_pred:0.03107050433754921, decouple_loss:0.018088972195982933
loss_pred:0.031039388850331306, decouple_loss:0.018217260017991066
Iteration: 1563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537844955921173, gen p mean: 0.0, mean p set: 0.4500344693660736
The modified gen p mean: 0.45060861110687256, gen p mean: 0.0, mean p set: 0.4529503583908081
The modified gen p mean: 0.4503754675388336, gen p mean: 0.0, mean p set: 0.4511091411113739
loss_pred:0.03145110234618187, decouple_loss:0.017035596072673798
loss_pred:0.03022160567343235, decouple_loss:0.017580071464180946
loss_pred:0.029632769525051117, decouple_loss:0.017416754737496376
Iteration: 1564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45666632056236267, gen p mean: 0.0, mean p set: 0.4498039484024048
The modified gen p mean: 0.456550270318985, gen p mean: 0.0, mean p set: 0.4527266025543213
The modified gen p mean: 0.4586813151836395, gen p mean: 0.0, mean p set: 0.4502924084663391
loss_pred:0.030323928222060204, decouple_loss:0.017126524820923805
loss_pred:0.030481085181236267, decouple_loss:0.017358267679810524
loss_pred:0.029251601547002792, decouple_loss:0.017149673774838448
Iteration: 1565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482010304927826, gen p mean: 0.0, mean p set: 0.4493871033191681
The modified gen p mean: 0.44975173473358154, gen p mean: 0.0, mean p set: 0.4492347836494446
The modified gen p mean: 0.4510536789894104, gen p mean: 0.0, mean p set: 0.44981491565704346
loss_pred:0.02995367720723152, decouple_loss:0.017562996596097946
loss_pred:0.029823845252394676, decouple_loss:0.017812801524996758
loss_pred:0.031404610723257065, decouple_loss:0.016867201775312424
Iteration: 1566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4398874044418335, gen p mean: 0.0, mean p set: 0.4489700198173523
The modified gen p mean: 0.4338335394859314, gen p mean: 0.0, mean p set: 0.44860586524009705
The modified gen p mean: 0.43720561265945435, gen p mean: 0.0, mean p set: 0.4499289393424988
loss_pred:0.03025173395872116, decouple_loss:0.017674675211310387
loss_pred:0.031219560652971268, decouple_loss:0.018094386905431747
loss_pred:0.030214374884963036, decouple_loss:0.01707059144973755
Iteration: 1567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4615223705768585, gen p mean: 0.0, mean p set: 0.4491738975048065
The modified gen p mean: 0.4600597321987152, gen p mean: 0.0, mean p set: 0.45038262009620667
The modified gen p mean: 0.45380619168281555, gen p mean: 0.0, mean p set: 0.4523291289806366
loss_pred:0.03168848529458046, decouple_loss:0.017028747126460075
loss_pred:0.030076073482632637, decouple_loss:0.01699412241578102
loss_pred:0.029461128637194633, decouple_loss:0.01686132699251175
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
NaN value num: 0
Iteration: 1568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191341638565063, gen p mean: 0.0, mean p set: 0.45135921239852905
The modified gen p mean: 0.4492630362510681, gen p mean: 0.0, mean p set: 0.4526314437389374
The modified gen p mean: 0.4542137086391449, gen p mean: 0.0, mean p set: 0.4518622159957886
loss_pred:0.0296131931245327, decouple_loss:0.019829941913485527
loss_pred:0.029058029875159264, decouple_loss:0.01870524138212204
loss_pred:0.03079478070139885, decouple_loss:0.019115103408694267
Iteration: 1569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4371687173843384, gen p mean: 0.0, mean p set: 0.4531586468219757
The modified gen p mean: 0.43881839513778687, gen p mean: 0.0, mean p set: 0.4510255753993988
The modified gen p mean: 0.4398307800292969, gen p mean: 0.0, mean p set: 0.45174074172973633
loss_pred:0.029376352205872536, decouple_loss:0.019954849034547806
loss_pred:0.029903188347816467, decouple_loss:0.01909411884844303
loss_pred:0.029164081439375877, decouple_loss:0.018757343292236328
Iteration: 1570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527813494205475, gen p mean: 0.0, mean p set: 0.45375457406044006
The modified gen p mean: 0.4488798677921295, gen p mean: 0.0, mean p set: 0.45253023505210876
The modified gen p mean: 0.45574021339416504, gen p mean: 0.0, mean p set: 0.4518847167491913
loss_pred:0.030438639223575592, decouple_loss:0.019154973328113556
loss_pred:0.02980503998696804, decouple_loss:0.01991243287920952
loss_pred:0.028727304190397263, decouple_loss:0.01880156248807907
2023-05-03 00:54:41 testing...
The modified gen p mean: 0.46442535519599915, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4742712080478668, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4706425666809082, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.031087398529052734, decouple_loss:0.019863469526171684
loss_pred:0.029764747247099876, decouple_loss:0.019900470972061157
loss_pred:0.030186882242560387, decouple_loss:0.01934133656322956
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03133143112063408, avg_mse: 0.03521395102143288
current test mse: 0.035214
Iteration: 1571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4701331555843353, gen p mean: 0.0, mean p set: 0.45144835114479065
The modified gen p mean: 0.4708147943019867, gen p mean: 0.0, mean p set: 0.4501703083515167
loss_pred:0.02917211316525936, decouple_loss:0.018091319128870964
loss_pred:0.028071409091353416, decouple_loss:0.01802898198366165
The modified gen p mean: 0.4717436730861664, gen p mean: 0.0, mean p set: 0.4504260718822479
loss_pred:0.031336866319179535, decouple_loss:0.018981298431754112
Iteration: 1572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44287294149398804, gen p mean: 0.0, mean p set: 0.45205995440483093
The modified gen p mean: 0.4455738663673401, gen p mean: 0.0, mean p set: 0.4507897198200226
loss_pred:0.02915521338582039, decouple_loss:0.018535470589995384
The modified gen p mean: 0.4434114098548889, gen p mean: 0.0, mean p set: 0.45147067308425903
loss_pred:0.02871159464120865, decouple_loss:0.0174880251288414
loss_pred:0.030096424743533134, decouple_loss:0.018709367141127586
Iteration: 1573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4382883906364441, gen p mean: 0.0, mean p set: 0.45228278636932373
The modified gen p mean: 0.4328034818172455, gen p mean: 0.0, mean p set: 0.45224204659461975
The modified gen p mean: 0.4385642111301422, gen p mean: 0.0, mean p set: 0.4505949914455414
loss_pred:0.028277501463890076, decouple_loss:0.01835467293858528
loss_pred:0.029487786814570427, decouple_loss:0.01810944639146328
loss_pred:0.03027055598795414, decouple_loss:0.017973128706216812
Iteration: 1574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45553889870643616, gen p mean: 0.0, mean p set: 0.45104217529296875
The modified gen p mean: 0.455209344625473, gen p mean: 0.0, mean p set: 0.4488172233104706
The modified gen p mean: 0.4570823609828949, gen p mean: 0.0, mean p set: 0.45125675201416016
loss_pred:0.029281172901391983, decouple_loss:0.01767282374203205
loss_pred:0.030155634507536888, decouple_loss:0.019213009625673294
loss_pred:0.029142538085579872, decouple_loss:0.018641412258148193
Iteration: 1575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4590364992618561, gen p mean: 0.0, mean p set: 0.4507984220981598
The modified gen p mean: 0.4568937420845032, gen p mean: 0.0, mean p set: 0.4496879279613495
The modified gen p mean: 0.4564455449581146, gen p mean: 0.0, mean p set: 0.45284903049468994
loss_pred:0.03076813742518425, decouple_loss:0.018660124391317368
loss_pred:0.031554464250802994, decouple_loss:0.018804296851158142
loss_pred:0.03036283329129219, decouple_loss:0.018377868458628654
Iteration: 1576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787999987602234, gen p mean: 0.0, mean p set: 0.45187288522720337
The modified gen p mean: 0.449072003364563, gen p mean: 0.0, mean p set: 0.4517684876918793
The modified gen p mean: 0.4495188295841217, gen p mean: 0.0, mean p set: 0.45167064666748047
loss_pred:0.029663942754268646, decouple_loss:0.018446093425154686
loss_pred:0.02873426117002964, decouple_loss:0.01872735284268856
loss_pred:0.028409702703356743, decouple_loss:0.01852232962846756
Iteration: 1577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45785585045814514, gen p mean: 0.0, mean p set: 0.4514783024787903
The modified gen p mean: 0.4541918933391571, gen p mean: 0.0, mean p set: 0.4514361619949341
The modified gen p mean: 0.44833219051361084, gen p mean: 0.0, mean p set: 0.45244479179382324
loss_pred:0.030673926696181297, decouple_loss:0.01841396652162075
loss_pred:0.028123732656240463, decouple_loss:0.018147258087992668
loss_pred:0.02922115847468376, decouple_loss:0.018495434895157814
Iteration: 1578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487771987915039, gen p mean: 0.0, mean p set: 0.4502032399177551
The modified gen p mean: 0.4422838091850281, gen p mean: 0.0, mean p set: 0.45220106840133667
The modified gen p mean: 0.44508349895477295, gen p mean: 0.0, mean p set: 0.45362117886543274
loss_pred:0.030828019604086876, decouple_loss:0.018728356808423996
loss_pred:0.029489140957593918, decouple_loss:0.018460635095834732
loss_pred:0.029858656227588654, decouple_loss:0.017960233613848686
Iteration: 1579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45091021060943604, gen p mean: 0.0, mean p set: 0.4498947560787201
The modified gen p mean: 0.4484250843524933, gen p mean: 0.0, mean p set: 0.4514505863189697
The modified gen p mean: 0.45139554142951965, gen p mean: 0.0, mean p set: 0.4518887996673584
loss_pred:0.029119327664375305, decouple_loss:0.018614118918776512loss_pred:0.030293874442577362, decouple_loss:0.018617108464241028
loss_pred:0.02804686315357685, decouple_loss:0.018217148259282112
Iteration: 1580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45376941561698914, gen p mean: 0.0, mean p set: 0.4523625671863556
The modified gen p mean: 0.457633376121521, gen p mean: 0.0, mean p set: 0.45096179842948914
The modified gen p mean: 0.45468538999557495, gen p mean: 0.0, mean p set: 0.45248204469680786
loss_pred:0.030712025240063667, decouple_loss:0.017386678606271744
loss_pred:0.03008108399808407, decouple_loss:0.017160914838314056
loss_pred:0.028140069916844368, decouple_loss:0.0179816372692585
2023-05-03 00:58:23 testing...
The modified gen p mean: 0.4585701823234558, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4483576714992523, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4550895690917969, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.0294349305331707, decouple_loss:0.020070267841219902
loss_pred:0.03090723417699337, decouple_loss:0.019940752536058426
loss_pred:0.02989433892071247, decouple_loss:0.01947031542658806
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03107019141316414, avg_mse: 0.034986406564712524
current test mse: 0.034986
Iteration: 1581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4559504985809326, gen p mean: 0.0, mean p set: 0.4508242905139923
The modified gen p mean: 0.4540593922138214, gen p mean: 0.0, mean p set: 0.4511524438858032
loss_pred:0.02883242443203926, decouple_loss:0.017546162009239197
loss_pred:0.030047794803977013, decouple_loss:0.01794739067554474
The modified gen p mean: 0.45669615268707275, gen p mean: 0.0, mean p set: 0.45149585604667664
loss_pred:0.029020722955465317, decouple_loss:0.017767813056707382
Iteration: 1582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44335702061653137, gen p mean: 0.0, mean p set: 0.45129311084747314
The modified gen p mean: 0.4474674165248871, gen p mean: 0.0, mean p set: 0.45217567682266235
The modified gen p mean: 0.44686073064804077, gen p mean: 0.0, mean p set: 0.4499072730541229
loss_pred:0.02797369286417961, decouple_loss:0.017717843875288963
loss_pred:0.02923652157187462, decouple_loss:0.017385011538863182
loss_pred:0.02742672711610794, decouple_loss:0.017412787303328514
Iteration: 1583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445293128490448, gen p mean: 0.0, mean p set: 0.45057356357574463The modified gen p mean: 0.44328537583351135, gen p mean: 0.0, mean p set: 0.4510226845741272
The modified gen p mean: 0.44592323899269104, gen p mean: 0.0, mean p set: 0.4509369432926178
loss_pred:0.03070019744336605, decouple_loss:0.017774168401956558
loss_pred:0.028586989268660545, decouple_loss:0.01697247289121151
loss_pred:0.0286459531635046, decouple_loss:0.017645476385951042
Iteration: 1584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45648232102394104, gen p mean: 0.0, mean p set: 0.4513106644153595
The modified gen p mean: 0.4573303461074829, gen p mean: 0.0, mean p set: 0.4499543607234955
The modified gen p mean: 0.4543541669845581, gen p mean: 0.0, mean p set: 0.4513586759567261
loss_pred:0.028290480375289917, decouple_loss:0.016464149579405785
loss_pred:0.028201507404446602, decouple_loss:0.016424262896180153
loss_pred:0.02877846360206604, decouple_loss:0.017063431441783905
Iteration: 1585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45835769176483154, gen p mean: 0.0, mean p set: 0.45053830742836
The modified gen p mean: 0.4563548266887665, gen p mean: 0.0, mean p set: 0.45099693536758423
The modified gen p mean: 0.4538908004760742, gen p mean: 0.0, mean p set: 0.45217224955558777
loss_pred:0.028908459469676018, decouple_loss:0.01640533097088337
loss_pred:0.028624016791582108, decouple_loss:0.017033154144883156
loss_pred:0.02909921668469906, decouple_loss:0.01816464401781559
Iteration: 1586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487167000770569, gen p mean: 0.0, mean p set: 0.44960182905197144
The modified gen p mean: 0.44711971282958984, gen p mean: 0.0, mean p set: 0.4514320194721222
The modified gen p mean: 0.4427865743637085, gen p mean: 0.0, mean p set: 0.4523402452468872
loss_pred:0.030811067670583725, decouple_loss:0.01797248050570488
loss_pred:0.030070532113313675, decouple_loss:0.017986081540584564
loss_pred:0.029530450701713562, decouple_loss:0.017311668023467064
Iteration: 1587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44383570551872253, gen p mean: 0.0, mean p set: 0.449554443359375
The modified gen p mean: 0.44710657000541687, gen p mean: 0.0, mean p set: 0.45071083307266235
The modified gen p mean: 0.4469183683395386, gen p mean: 0.0, mean p set: 0.4510842561721802
loss_pred:0.031209567561745644, decouple_loss:0.017608020454645157
loss_pred:0.02883828431367874, decouple_loss:0.016327109187841415
loss_pred:0.027983611449599266, decouple_loss:0.016664650291204453
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
NaN value num: 0
Iteration: 1588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517870247364044, gen p mean: 0.0, mean p set: 0.4520357549190521
The modified gen p mean: 0.44817495346069336, gen p mean: 0.0, mean p set: 0.45267003774642944
The modified gen p mean: 0.45024624466896057, gen p mean: 0.0, mean p set: 0.451865553855896
loss_pred:0.029966119676828384, decouple_loss:0.017675457522273064
loss_pred:0.02986159734427929, decouple_loss:0.018531210720539093
loss_pred:0.029447030276060104, decouple_loss:0.01853327266871929
Iteration: 1589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.455756813287735, gen p mean: 0.0, mean p set: 0.45328596234321594
The modified gen p mean: 0.45644405484199524, gen p mean: 0.0, mean p set: 0.45266470313072205
The modified gen p mean: 0.4569631814956665, gen p mean: 0.0, mean p set: 0.452752947807312
loss_pred:0.03145070746541023, decouple_loss:0.01874125935137272
loss_pred:0.02910265512764454, decouple_loss:0.017752094194293022
loss_pred:0.030644558370113373, decouple_loss:0.018674004822969437
Iteration: 1590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45562300086021423, gen p mean: 0.0, mean p set: 0.4516959488391876
The modified gen p mean: 0.4503155052661896, gen p mean: 0.0, mean p set: 0.4522242546081543
The modified gen p mean: 0.45716404914855957, gen p mean: 0.0, mean p set: 0.45405787229537964
loss_pred:0.028374573215842247, decouple_loss:0.017887132242321968
loss_pred:0.028374332934617996, decouple_loss:0.018707292154431343
loss_pred:0.02965395525097847, decouple_loss:0.018452133983373642
2023-05-03 01:02:52 testing...
The modified gen p mean: 0.4396224319934845, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44619131088256836, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.449881911277771, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03122493252158165, decouple_loss:0.019574802368879318
loss_pred:0.030031533911824226, decouple_loss:0.01926257275044918
loss_pred:0.02946639247238636, decouple_loss:0.01959232985973358
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03121478110551834, avg_mse: 0.03521653637290001
current test mse: 0.035217
Iteration: 1591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44629713892936707, gen p mean: 0.0, mean p set: 0.451306015253067
The modified gen p mean: 0.4470005929470062, gen p mean: 0.0, mean p set: 0.45137453079223633
loss_pred:0.031014015898108482, decouple_loss:0.018571913242340088
loss_pred:0.030258355662226677, decouple_loss:0.017976509407162666
The modified gen p mean: 0.4445886015892029, gen p mean: 0.0, mean p set: 0.45367300510406494
loss_pred:0.03146258369088173, decouple_loss:0.018360115587711334
Iteration: 1592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45625945925712585, gen p mean: 0.0, mean p set: 0.45298269391059875
The modified gen p mean: 0.4516412317752838, gen p mean: 0.0, mean p set: 0.4523301124572754
The modified gen p mean: 0.4557473361492157, gen p mean: 0.0, mean p set: 0.4528812766075134
loss_pred:0.030051717534661293, decouple_loss:0.01716519147157669
loss_pred:0.02982364594936371, decouple_loss:0.01729874685406685
loss_pred:0.030475236475467682, decouple_loss:0.017168531194329262
Iteration: 1593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.464346319437027, gen p mean: 0.0, mean p set: 0.45365968346595764
The modified gen p mean: 0.4611322581768036, gen p mean: 0.0, mean p set: 0.4515356123447418
The modified gen p mean: 0.4632434546947479, gen p mean: 0.0, mean p set: 0.45153874158859253
loss_pred:0.02955424226820469, decouple_loss:0.016718726605176926
loss_pred:0.03019406460225582, decouple_loss:0.017246799543499947
loss_pred:0.028858128935098648, decouple_loss:0.01704992726445198
Iteration: 1594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514404535293579, gen p mean: 0.0, mean p set: 0.4520217776298523
The modified gen p mean: 0.447051465511322, gen p mean: 0.0, mean p set: 0.45055609941482544
The modified gen p mean: 0.4485826790332794, gen p mean: 0.0, mean p set: 0.4518068730831146
loss_pred:0.029329512268304825, decouple_loss:0.0181015245616436
loss_pred:0.030717378482222557, decouple_loss:0.017847318202257156
loss_pred:0.029499052092432976, decouple_loss:0.017665402963757515
Iteration: 1595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4381512403488159, gen p mean: 0.0, mean p set: 0.45189085602760315
The modified gen p mean: 0.4346235990524292, gen p mean: 0.0, mean p set: 0.4521217942237854
The modified gen p mean: 0.43209967017173767, gen p mean: 0.0, mean p set: 0.45293402671813965
loss_pred:0.029324347153306007, decouple_loss:0.017974279820919037
loss_pred:0.030909482389688492, decouple_loss:0.01853885129094124
loss_pred:0.031105509027838707, decouple_loss:0.017697399482131004
Iteration: 1596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542676508426666, gen p mean: 0.0, mean p set: 0.45153123140335083
The modified gen p mean: 0.45466509461402893, gen p mean: 0.0, mean p set: 0.4500395953655243
The modified gen p mean: 0.45166856050491333, gen p mean: 0.0, mean p set: 0.451384037733078
loss_pred:0.028164897114038467, decouple_loss:0.01761649176478386
loss_pred:0.027916889637708664, decouple_loss:0.01844199374318123
loss_pred:0.027646955102682114, decouple_loss:0.01769864186644554
Iteration: 1597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4640968143939972, gen p mean: 0.0, mean p set: 0.45189085602760315
The modified gen p mean: 0.46657177805900574, gen p mean: 0.0, mean p set: 0.45337265729904175
The modified gen p mean: 0.46535831689834595, gen p mean: 0.0, mean p set: 0.4507259726524353
loss_pred:0.028696276247501373, decouple_loss:0.01706087775528431
loss_pred:0.028494318947196007, decouple_loss:0.017208384349942207
loss_pred:0.028972052037715912, decouple_loss:0.018093230202794075
Iteration: 1598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45538195967674255, gen p mean: 0.0, mean p set: 0.45049792528152466
The modified gen p mean: 0.45261484384536743, gen p mean: 0.0, mean p set: 0.45193058252334595
The modified gen p mean: 0.4454248547554016, gen p mean: 0.0, mean p set: 0.45247751474380493
loss_pred:0.02873830311000347, decouple_loss:0.017797239124774933
loss_pred:0.0286908820271492, decouple_loss:0.01713637448847294
loss_pred:0.029995089396834373, decouple_loss:0.017740299925208092
Iteration: 1599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4445534944534302, gen p mean: 0.0, mean p set: 0.4514019787311554
The modified gen p mean: 0.44736382365226746, gen p mean: 0.0, mean p set: 0.4518103301525116
The modified gen p mean: 0.4490838646888733, gen p mean: 0.0, mean p set: 0.45075303316116333
loss_pred:0.02772163599729538, decouple_loss:0.016491753980517387
loss_pred:0.028110601007938385, decouple_loss:0.01641325280070305
loss_pred:0.028198366984725, decouple_loss:0.016534416005015373
Iteration: 1600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453967213630676, gen p mean: 0.0, mean p set: 0.45214059948921204
The modified gen p mean: 0.44259440898895264, gen p mean: 0.0, mean p set: 0.4523863196372986
The modified gen p mean: 0.44163253903388977, gen p mean: 0.0, mean p set: 0.4522145688533783
loss_pred:0.02947438694536686, decouple_loss:0.017220374196767807
loss_pred:0.028105899691581726, decouple_loss:0.016992194578051567
loss_pred:0.031044308096170425, decouple_loss:0.0183311365544796
2023-05-03 01:06:36 testing...
The modified gen p mean: 0.44989487528800964, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.443242609500885, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4534606337547302, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.029700109735131264, decouple_loss:0.019008155912160873
loss_pred:0.030843134969472885, decouple_loss:0.019344910979270935
loss_pred:0.029220661148428917, decouple_loss:0.019497325643897057
WV_0_PC_0_EH_0_PS_40_6, loss: 0.030885476619005203, avg_mse: 0.034811925143003464
current test mse: 0.034812
Iteration: 1601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4565473198890686, gen p mean: 0.0, mean p set: 0.4539310038089752
loss_pred:0.02864554338157177, decouple_loss:0.016426850110292435
The modified gen p mean: 0.4483797252178192, gen p mean: 0.0, mean p set: 0.45151403546333313
loss_pred:0.028678297996520996, decouple_loss:0.017299603670835495
The modified gen p mean: 0.4524863064289093, gen p mean: 0.0, mean p set: 0.4509764611721039
loss_pred:0.02790132723748684, decouple_loss:0.01693078875541687
Iteration: 1602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4564051628112793, gen p mean: 0.0, mean p set: 0.4529041349887848
The modified gen p mean: 0.4486652910709381, gen p mean: 0.0, mean p set: 0.4521753489971161
The modified gen p mean: 0.45801904797554016, gen p mean: 0.0, mean p set: 0.453027606010437
loss_pred:0.0282328799366951, decouple_loss:0.016583286225795746
loss_pred:0.029621900990605354, decouple_loss:0.01756994053721428
loss_pred:0.02802884392440319, decouple_loss:0.016317885369062424
Iteration: 1603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534226953983307, gen p mean: 0.0, mean p set: 0.4528064429759979
The modified gen p mean: 0.44765621423721313, gen p mean: 0.0, mean p set: 0.4523584544658661
The modified gen p mean: 0.4573253393173218, gen p mean: 0.0, mean p set: 0.45359519124031067
loss_pred:0.028373241424560547, decouple_loss:0.01702594757080078
loss_pred:0.02938145212829113, decouple_loss:0.01726427488029003
loss_pred:0.02870888262987137, decouple_loss:0.017339417710900307
Iteration: 1604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45505717396736145, gen p mean: 0.0, mean p set: 0.4514599144458771
The modified gen p mean: 0.460910826921463, gen p mean: 0.0, mean p set: 0.4503691494464874
The modified gen p mean: 0.45703959465026855, gen p mean: 0.0, mean p set: 0.45216134190559387
loss_pred:0.02951648272573948, decouple_loss:0.016972314566373825
loss_pred:0.028096992522478104, decouple_loss:0.016161682084202766
loss_pred:0.029823051765561104, decouple_loss:0.017821935936808586
Iteration: 1605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491049647331238, gen p mean: 0.0, mean p set: 0.45279279351234436
The modified gen p mean: 0.4470623731613159, gen p mean: 0.0, mean p set: 0.452322781085968
The modified gen p mean: 0.44643643498420715, gen p mean: 0.0, mean p set: 0.45036500692367554
loss_pred:0.030667869374155998, decouple_loss:0.017537817358970642
loss_pred:0.030379215255379677, decouple_loss:0.017777102068066597
loss_pred:0.027746636420488358, decouple_loss:0.016519349068403244
Iteration: 1606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468042850494385, gen p mean: 0.0, mean p set: 0.4517495334148407
The modified gen p mean: 0.4396193027496338, gen p mean: 0.0, mean p set: 0.4521616995334625
The modified gen p mean: 0.44952481985092163, gen p mean: 0.0, mean p set: 0.45199838280677795
loss_pred:0.028937265276908875, decouple_loss:0.01649458520114422
loss_pred:0.029103321954607964, decouple_loss:0.016868149861693382
loss_pred:0.029546868056058884, decouple_loss:0.016655519604682922
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
NaN value num: 0
Iteration: 1607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45386195182800293, gen p mean: 0.0, mean p set: 0.44780290126800537
The modified gen p mean: 0.4535209834575653, gen p mean: 0.0, mean p set: 0.44712138175964355
The modified gen p mean: 0.45667484402656555, gen p mean: 0.0, mean p set: 0.44736701250076294
loss_pred:0.03221626952290535, decouple_loss:0.019075866788625717
loss_pred:0.03243014216423035, decouple_loss:0.019814657047390938
loss_pred:0.03228362649679184, decouple_loss:0.01882355846464634
Iteration: 1608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45413684844970703, gen p mean: 0.0, mean p set: 0.44875606894493103
The modified gen p mean: 0.44911324977874756, gen p mean: 0.0, mean p set: 0.44724392890930176
The modified gen p mean: 0.4479236602783203, gen p mean: 0.0, mean p set: 0.449957937002182
loss_pred:0.031142089515924454, decouple_loss:0.018095755949616432
loss_pred:0.03262430056929588, decouple_loss:0.017915034666657448
loss_pred:0.031392380595207214, decouple_loss:0.018171435222029686
Iteration: 1609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4366391897201538, gen p mean: 0.0, mean p set: 0.4478435218334198
The modified gen p mean: 0.4330282211303711, gen p mean: 0.0, mean p set: 0.4496566355228424
The modified gen p mean: 0.43522337079048157, gen p mean: 0.0, mean p set: 0.4491124749183655
loss_pred:0.03214845061302185, decouple_loss:0.01806354522705078
loss_pred:0.03235857933759689, decouple_loss:0.017599118873476982
loss_pred:0.031314317137002945, decouple_loss:0.017907604575157166
Iteration: 1610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495200514793396, gen p mean: 0.0, mean p set: 0.44740378856658936
The modified gen p mean: 0.4551779627799988, gen p mean: 0.0, mean p set: 0.44905006885528564
The modified gen p mean: 0.4514225125312805, gen p mean: 0.0, mean p set: 0.44756776094436646
loss_pred:0.03128262236714363, decouple_loss:0.018215570598840714
loss_pred:0.03105061501264572, decouple_loss:0.018071966245770454
loss_pred:0.031704023480415344, decouple_loss:0.018099090084433556
2023-05-03 01:10:55 testing...
The modified gen p mean: 0.45786330103874207, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.46746620535850525, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4641106426715851, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.030916623771190643, decouple_loss:0.0182337686419487loss_pred:0.029426658526062965, decouple_loss:0.018271779641509056
loss_pred:0.029946453869342804, decouple_loss:0.017965711653232574
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03100443445146084, avg_mse: 0.03505600243806839
current test mse: 0.035056
Iteration: 1611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4606953561306, gen p mean: 0.0, mean p set: 0.4477372169494629
The modified gen p mean: 0.4655188024044037, gen p mean: 0.0, mean p set: 0.44848722219467163
loss_pred:0.03154909983277321, decouple_loss:0.017141234129667282
loss_pred:0.030657675117254257, decouple_loss:0.017498424276709557
The modified gen p mean: 0.46597421169281006, gen p mean: 0.0, mean p set: 0.44875475764274597
loss_pred:0.031174946576356888, decouple_loss:0.017870793119072914
Iteration: 1612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43320903182029724, gen p mean: 0.0, mean p set: 0.4488883912563324
The modified gen p mean: 0.44092512130737305, gen p mean: 0.0, mean p set: 0.4486234486103058
The modified gen p mean: 0.43269217014312744, gen p mean: 0.0, mean p set: 0.4482364058494568
loss_pred:0.031742122024297714, decouple_loss:0.019014708697795868
loss_pred:0.031097711995244026, decouple_loss:0.01731409877538681
loss_pred:0.031191563233733177, decouple_loss:0.018527548760175705
Iteration: 1613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44127315282821655, gen p mean: 0.0, mean p set: 0.4476177394390106
The modified gen p mean: 0.43287867307662964, gen p mean: 0.0, mean p set: 0.449065238237381
The modified gen p mean: 0.4420873820781708, gen p mean: 0.0, mean p set: 0.4480498135089874
loss_pred:0.031331244856119156, decouple_loss:0.018037542700767517
loss_pred:0.031610097736120224, decouple_loss:0.018662892282009125
loss_pred:0.031989604234695435, decouple_loss:0.017582260072231293
Iteration: 1614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521116614341736, gen p mean: 0.0, mean p set: 0.45058512687683105
The modified gen p mean: 0.45118632912635803, gen p mean: 0.0, mean p set: 0.44704464077949524
The modified gen p mean: 0.458885133266449, gen p mean: 0.0, mean p set: 0.4476620852947235
loss_pred:0.031075097620487213, decouple_loss:0.01797417737543583
loss_pred:0.030784808099269867, decouple_loss:0.018190819770097733
loss_pred:0.03177255019545555, decouple_loss:0.017698602750897408
Iteration: 1615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45727789402008057, gen p mean: 0.0, mean p set: 0.4478999078273773
The modified gen p mean: 0.4534659683704376, gen p mean: 0.0, mean p set: 0.44756510853767395
The modified gen p mean: 0.4560105800628662, gen p mean: 0.0, mean p set: 0.4473875164985657
loss_pred:0.03191914036870003, decouple_loss:0.016982994973659515
loss_pred:0.03039815090596676, decouple_loss:0.017990462481975555
loss_pred:0.03277122601866722, decouple_loss:0.01785227470099926
Iteration: 1616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4419553279876709, gen p mean: 0.0, mean p set: 0.4485994875431061
The modified gen p mean: 0.44426825642585754, gen p mean: 0.0, mean p set: 0.447747141122818
The modified gen p mean: 0.4501879811286926, gen p mean: 0.0, mean p set: 0.4481465220451355
loss_pred:0.031027723103761673, decouple_loss:0.0177361611276865
loss_pred:0.030632952228188515, decouple_loss:0.017573976889252663
loss_pred:0.030901404097676277, decouple_loss:0.01773485355079174
Iteration: 1617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519525170326233, gen p mean: 0.0, mean p set: 0.44844627380371094
The modified gen p mean: 0.44847747683525085, gen p mean: 0.0, mean p set: 0.44890812039375305
The modified gen p mean: 0.4493429958820343, gen p mean: 0.0, mean p set: 0.44726279377937317
loss_pred:0.03132069855928421, decouple_loss:0.017828484997153282
loss_pred:0.02995835244655609, decouple_loss:0.01849016360938549
loss_pred:0.03234574943780899, decouple_loss:0.017106445506215096
Iteration: 1618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456110894680023, gen p mean: 0.0, mean p set: 0.4480472505092621
The modified gen p mean: 0.4441296458244324, gen p mean: 0.0, mean p set: 0.44827520847320557
The modified gen p mean: 0.44500938057899475, gen p mean: 0.0, mean p set: 0.4467800557613373
loss_pred:0.03146982565522194, decouple_loss:0.018155256286263466
loss_pred:0.031704701483249664, decouple_loss:0.017755839973688126
loss_pred:0.03207021951675415, decouple_loss:0.016954505816102028
Iteration: 1619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443959891796112, gen p mean: 0.0, mean p set: 0.4475730061531067
The modified gen p mean: 0.4465107321739197, gen p mean: 0.0, mean p set: 0.44698062539100647
The modified gen p mean: 0.4475348889827728, gen p mean: 0.0, mean p set: 0.4461957514286041
loss_pred:0.03103729337453842, decouple_loss:0.01740415021777153
loss_pred:0.03147442266345024, decouple_loss:0.01687827706336975
loss_pred:0.030702859163284302, decouple_loss:0.017984449863433838
Iteration: 1620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510182738304138, gen p mean: 0.0, mean p set: 0.4478892683982849
The modified gen p mean: 0.44639500975608826, gen p mean: 0.0, mean p set: 0.4469883143901825
The modified gen p mean: 0.4457436203956604, gen p mean: 0.0, mean p set: 0.4469945430755615
loss_pred:0.03056422993540764, decouple_loss:0.017730722203850746
loss_pred:0.03148689866065979, decouple_loss:0.01660700887441635
loss_pred:0.03138372674584389, decouple_loss:0.01774483546614647
2023-05-03 01:14:35 testing...
The modified gen p mean: 0.4469183683395386, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4410243332386017, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45013052225112915, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.029736651107668877, decouple_loss:0.01761053316295147
loss_pred:0.030794573947787285, decouple_loss:0.0178840309381485
loss_pred:0.02931998111307621, decouple_loss:0.018221035599708557
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03084566257894039, avg_mse: 0.03493877872824669
current test mse: 0.034939
Iteration: 1621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44603395462036133, gen p mean: 0.0, mean p set: 0.4475059509277344
loss_pred:0.03191487491130829, decouple_loss:0.017238536849617958
The modified gen p mean: 0.44179457426071167, gen p mean: 0.0, mean p set: 0.4493309259414673
loss_pred:0.031019408255815506, decouple_loss:0.018162546679377556
The modified gen p mean: 0.44749730825424194, gen p mean: 0.0, mean p set: 0.44688549637794495
loss_pred:0.03294525295495987, decouple_loss:0.01697319559752941
Iteration: 1622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45323532819747925, gen p mean: 0.0, mean p set: 0.446577250957489
The modified gen p mean: 0.45074617862701416, gen p mean: 0.0, mean p set: 0.44734886288642883
The modified gen p mean: 0.4511285126209259, gen p mean: 0.0, mean p set: 0.44810381531715393
loss_pred:0.030844084918498993, decouple_loss:0.01686391793191433
loss_pred:0.03125574812293053, decouple_loss:0.017064426094293594
loss_pred:0.031906064599752426, decouple_loss:0.01664448156952858
Iteration: 1623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44498568773269653, gen p mean: 0.0, mean p set: 0.4480447769165039
The modified gen p mean: 0.4435516893863678, gen p mean: 0.0, mean p set: 0.44817039370536804
The modified gen p mean: 0.44374939799308777, gen p mean: 0.0, mean p set: 0.44789931178092957
loss_pred:0.03040090762078762, decouple_loss:0.017438586801290512
loss_pred:0.03016783855855465, decouple_loss:0.01764518767595291
loss_pred:0.030513344332575798, decouple_loss:0.016846993938088417
Iteration: 1624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4421500861644745, gen p mean: 0.0, mean p set: 0.44700849056243896
The modified gen p mean: 0.44821619987487793, gen p mean: 0.0, mean p set: 0.4473509192466736
The modified gen p mean: 0.4465107321739197, gen p mean: 0.0, mean p set: 0.44628363847732544
loss_pred:0.03140469267964363, decouple_loss:0.0168263278901577
loss_pred:0.03192204236984253, decouple_loss:0.01697179302573204
loss_pred:0.030803099274635315, decouple_loss:0.01756446249783039
Iteration: 1625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45735636353492737, gen p mean: 0.0, mean p set: 0.4485313296318054
The modified gen p mean: 0.4586997926235199, gen p mean: 0.0, mean p set: 0.4487774670124054
The modified gen p mean: 0.4576098322868347, gen p mean: 0.0, mean p set: 0.44834578037261963
loss_pred:0.0304526649415493, decouple_loss:0.016892656683921814
loss_pred:0.03000508062541485, decouple_loss:0.016959071159362793
loss_pred:0.03067166730761528, decouple_loss:0.017010606825351715
Iteration: 1626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4416581094264984, gen p mean: 0.0, mean p set: 0.4496842920780182
The modified gen p mean: 0.4431120455265045, gen p mean: 0.0, mean p set: 0.4470905661582947
The modified gen p mean: 0.4426279067993164, gen p mean: 0.0, mean p set: 0.44720491766929626
loss_pred:0.03032558038830757, decouple_loss:0.017214501276612282
loss_pred:0.031268160790205, decouple_loss:0.01672414503991604
loss_pred:0.0322059765458107, decouple_loss:0.016586849465966225
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
NaN value num: 0
Iteration: 1627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4449203908443451, gen p mean: 0.0, mean p set: 0.4517534077167511
The modified gen p mean: 0.4509870111942291, gen p mean: 0.0, mean p set: 0.4543021321296692
The modified gen p mean: 0.4508283734321594, gen p mean: 0.0, mean p set: 0.45378997921943665
loss_pred:0.028832145035266876, decouple_loss:0.01978136971592903
loss_pred:0.02857053466141224, decouple_loss:0.01907428354024887
loss_pred:0.028742216527462006, decouple_loss:0.020325789228081703
Iteration: 1628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467778205871582, gen p mean: 0.0, mean p set: 0.45297572016716003
The modified gen p mean: 0.44936853647232056, gen p mean: 0.0, mean p set: 0.45238205790519714
The modified gen p mean: 0.4446878135204315, gen p mean: 0.0, mean p set: 0.4516587555408478
loss_pred:0.029941849410533905, decouple_loss:0.019134311005473137
loss_pred:0.029061894863843918, decouple_loss:0.019047336652874947
loss_pred:0.028866693377494812, decouple_loss:0.01937194913625717
Iteration: 1629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4580061137676239, gen p mean: 0.0, mean p set: 0.4505046308040619
The modified gen p mean: 0.4604094624519348, gen p mean: 0.0, mean p set: 0.4527439475059509
The modified gen p mean: 0.4504891633987427, gen p mean: 0.0, mean p set: 0.45302614569664
loss_pred:0.028318777680397034, decouple_loss:0.01815488375723362
loss_pred:0.028623564168810844, decouple_loss:0.018420806154608727
loss_pred:0.028757799416780472, decouple_loss:0.018524162471294403
Iteration: 1630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46620404720306396, gen p mean: 0.0, mean p set: 0.4540506899356842
The modified gen p mean: 0.46366676688194275, gen p mean: 0.0, mean p set: 0.4515247046947479
The modified gen p mean: 0.4629201292991638, gen p mean: 0.0, mean p set: 0.4525293707847595
loss_pred:0.028919178992509842, decouple_loss:0.017614901065826416
loss_pred:0.028901357203722, decouple_loss:0.01802424155175686
loss_pred:0.029272735118865967, decouple_loss:0.017528556287288666
2023-05-03 01:18:56 testing...
The modified gen p mean: 0.4392893612384796, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4492865204811096, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44582420587539673, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.03103804960846901, decouple_loss:0.01878887414932251
loss_pred:0.029551900923252106, decouple_loss:0.01881062053143978
loss_pred:0.030019359663128853, decouple_loss:0.01851501502096653
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0311383455991745, avg_mse: 0.03538016602396965
current test mse: 0.03538
Iteration: 1631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109742879867554, gen p mean: 0.0, mean p set: 0.452427476644516
The modified gen p mean: 0.44239547848701477, gen p mean: 0.0, mean p set: 0.4542112350463867
loss_pred:0.02899423986673355, decouple_loss:0.01708769053220749
loss_pred:0.029468486085534096, decouple_loss:0.01810912787914276
The modified gen p mean: 0.4516601860523224, gen p mean: 0.0, mean p set: 0.4532904326915741
loss_pred:0.028927169740200043, decouple_loss:0.017257971689105034
Iteration: 1632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4334222078323364, gen p mean: 0.0, mean p set: 0.4521428048610687
The modified gen p mean: 0.43825143575668335, gen p mean: 0.0, mean p set: 0.45258408784866333
The modified gen p mean: 0.4379862844944, gen p mean: 0.0, mean p set: 0.4526262879371643
loss_pred:0.027261093258857727, decouple_loss:0.017435602843761444
loss_pred:0.029885249212384224, decouple_loss:0.016811931505799294
loss_pred:0.028072835877537727, decouple_loss:0.017287803813815117
Iteration: 1633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45782187581062317, gen p mean: 0.0, mean p set: 0.45371225476264954
The modified gen p mean: 0.4540545642375946, gen p mean: 0.0, mean p set: 0.45117396116256714
The modified gen p mean: 0.45173829793930054, gen p mean: 0.0, mean p set: 0.4534578025341034
loss_pred:0.028645841404795647, decouple_loss:0.016864247620105743
loss_pred:0.02863934449851513, decouple_loss:0.017484288662672043
loss_pred:0.028552869334816933, decouple_loss:0.017078960314393044
Iteration: 1634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4678197503089905, gen p mean: 0.0, mean p set: 0.45406821370124817
The modified gen p mean: 0.46529823541641235, gen p mean: 0.0, mean p set: 0.453043133020401
The modified gen p mean: 0.46039602160453796, gen p mean: 0.0, mean p set: 0.4541327655315399
loss_pred:0.028620721772313118, decouple_loss:0.01744827814400196
loss_pred:0.028464388102293015, decouple_loss:0.016961179673671722
loss_pred:0.02942201867699623, decouple_loss:0.017062555998563766
Iteration: 1635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926542043685913, gen p mean: 0.0, mean p set: 0.4533679187297821
The modified gen p mean: 0.4534422755241394, gen p mean: 0.0, mean p set: 0.4528374671936035
The modified gen p mean: 0.4542965292930603, gen p mean: 0.0, mean p set: 0.45299163460731506
loss_pred:0.028342802077531815, decouple_loss:0.015954481437802315
loss_pred:0.028739698231220245, decouple_loss:0.016583414748311043
loss_pred:0.02782324142754078, decouple_loss:0.016491957008838654
Iteration: 1636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45207396149635315, gen p mean: 0.0, mean p set: 0.450962096452713
The modified gen p mean: 0.44665756821632385, gen p mean: 0.0, mean p set: 0.4511880576610565
The modified gen p mean: 0.44791245460510254, gen p mean: 0.0, mean p set: 0.4529651403427124
loss_pred:0.028525175526738167, decouple_loss:0.016746195033192635
loss_pred:0.029375093057751656, decouple_loss:0.01683417148888111
loss_pred:0.028236551210284233, decouple_loss:0.016164029017090797
Iteration: 1637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45242202281951904, gen p mean: 0.0, mean p set: 0.4508254826068878
The modified gen p mean: 0.45844054222106934, gen p mean: 0.0, mean p set: 0.45356857776641846
The modified gen p mean: 0.45238107442855835, gen p mean: 0.0, mean p set: 0.45178741216659546
loss_pred:0.029035598039627075, decouple_loss:0.016877122223377228
loss_pred:0.027586977928876877, decouple_loss:0.01608762890100479
loss_pred:0.028185846284031868, decouple_loss:0.016768181696534157
Iteration: 1638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4415818452835083, gen p mean: 0.0, mean p set: 0.4523839056491852
The modified gen p mean: 0.4409458041191101, gen p mean: 0.0, mean p set: 0.45397165417671204
The modified gen p mean: 0.4423372447490692, gen p mean: 0.0, mean p set: 0.4535069465637207
loss_pred:0.028324728831648827, decouple_loss:0.01624670997262001
loss_pred:0.02805906906723976, decouple_loss:0.016294462606310844
loss_pred:0.027999084442853928, decouple_loss:0.016044560819864273
Iteration: 1639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4577014148235321, gen p mean: 0.0, mean p set: 0.4507599174976349
The modified gen p mean: 0.4554988443851471, gen p mean: 0.0, mean p set: 0.4534248113632202
The modified gen p mean: 0.45284798741340637, gen p mean: 0.0, mean p set: 0.45464667677879333
loss_pred:0.02812797576189041, decouple_loss:0.016394706442952156
loss_pred:0.02869456633925438, decouple_loss:0.016631703823804855
loss_pred:0.028819479048252106, decouple_loss:0.016809619963169098
Iteration: 1640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.464095801115036, gen p mean: 0.0, mean p set: 0.45199844241142273
The modified gen p mean: 0.4617001712322235, gen p mean: 0.0, mean p set: 0.4532560408115387
The modified gen p mean: 0.45915675163269043, gen p mean: 0.0, mean p set: 0.4517782926559448
loss_pred:0.028786713257431984, decouple_loss:0.016561981290578842
loss_pred:0.028118332847952843, decouple_loss:0.016100747510790825
loss_pred:0.029570700600743294, decouple_loss:0.01612432673573494
2023-05-03 01:22:39 testing...
The modified gen p mean: 0.44675368070602417, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4400934875011444, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4503692388534546, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.029800018295645714, decouple_loss:0.018305759876966476
loss_pred:0.030799884349107742, decouple_loss:0.018557483330368996
loss_pred:0.029225066304206848, decouple_loss:0.01851867139339447
WV_0_PC_0_EH_0_PS_40_6, loss: 0.030864685773849487, avg_mse: 0.03505038842558861
current test mse: 0.03505
Iteration: 1641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793620705604553, gen p mean: 0.0, mean p set: 0.4541240334510803
The modified gen p mean: 0.45229998230934143, gen p mean: 0.0, mean p set: 0.45263591408729553
loss_pred:0.02850491926074028, decouple_loss:0.016141103580594063
loss_pred:0.028003457933664322, decouple_loss:0.01642589457333088
The modified gen p mean: 0.4494265615940094, gen p mean: 0.0, mean p set: 0.4515807330608368
loss_pred:0.02935038134455681, decouple_loss:0.01661221869289875
Iteration: 1642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919171929359436, gen p mean: 0.0, mean p set: 0.4527541399002075
The modified gen p mean: 0.4509981870651245, gen p mean: 0.0, mean p set: 0.45400142669677734
The modified gen p mean: 0.4515557885169983, gen p mean: 0.0, mean p set: 0.4539869725704193
loss_pred:0.02951096184551716, decouple_loss:0.01644076779484749
loss_pred:0.028677668422460556, decouple_loss:0.016109338030219078
loss_pred:0.029301520437002182, decouple_loss:0.016321735456585884
Iteration: 1643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496011734008789, gen p mean: 0.0, mean p set: 0.4534684121608734
The modified gen p mean: 0.44317013025283813, gen p mean: 0.0, mean p set: 0.45174646377563477
The modified gen p mean: 0.4474327862262726, gen p mean: 0.0, mean p set: 0.45324504375457764
loss_pred:0.028010215610265732, decouple_loss:0.0159015953540802
loss_pred:0.02946222387254238, decouple_loss:0.015836555510759354
loss_pred:0.028828980401158333, decouple_loss:0.015733975917100906
Iteration: 1644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46067360043525696, gen p mean: 0.0, mean p set: 0.4523538649082184
The modified gen p mean: 0.4597099721431732, gen p mean: 0.0, mean p set: 0.4539780914783478
The modified gen p mean: 0.46123552322387695, gen p mean: 0.0, mean p set: 0.4503670632839203
loss_pred:0.028564447537064552, decouple_loss:0.016380302608013153
loss_pred:0.028855163604021072, decouple_loss:0.015541096217930317
loss_pred:0.027748016640543938, decouple_loss:0.016718463972210884
Iteration: 1645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45307403802871704, gen p mean: 0.0, mean p set: 0.45317909121513367
The modified gen p mean: 0.4549235999584198, gen p mean: 0.0, mean p set: 0.4511021673679352
The modified gen p mean: 0.45379525423049927, gen p mean: 0.0, mean p set: 0.4532091021537781
loss_pred:0.028175966814160347, decouple_loss:0.015941167250275612
loss_pred:0.028917910531163216, decouple_loss:0.016352234408259392
loss_pred:0.02960725501179695, decouple_loss:0.015637613832950592
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
NaN value num: 0
Iteration: 1646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43929630517959595, gen p mean: 0.0, mean p set: 0.45311251282691956
The modified gen p mean: 0.43764054775238037, gen p mean: 0.0, mean p set: 0.44856709241867065
The modified gen p mean: 0.43621233105659485, gen p mean: 0.0, mean p set: 0.4501332640647888
loss_pred:0.030657941475510597, decouple_loss:0.017575068399310112
loss_pred:0.03026345558464527, decouple_loss:0.017742544412612915
loss_pred:0.028060827404260635, decouple_loss:0.018095962703227997
Iteration: 1647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.468007892370224, gen p mean: 0.0, mean p set: 0.4539194405078888
The modified gen p mean: 0.45838022232055664, gen p mean: 0.0, mean p set: 0.45176732540130615
The modified gen p mean: 0.4599567949771881, gen p mean: 0.0, mean p set: 0.4543490707874298
loss_pred:0.02855421043932438, decouple_loss:0.017785945907235146
loss_pred:0.030173184350132942, decouple_loss:0.017866240814328194
loss_pred:0.0286713819950819, decouple_loss:0.017251428216695786
Iteration: 1648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4558323621749878, gen p mean: 0.0, mean p set: 0.44850653409957886
The modified gen p mean: 0.45485764741897583, gen p mean: 0.0, mean p set: 0.45210903882980347
The modified gen p mean: 0.4573052227497101, gen p mean: 0.0, mean p set: 0.4509917199611664
loss_pred:0.030144691467285156, decouple_loss:0.017024384811520576
loss_pred:0.02961694821715355, decouple_loss:0.016392748802900314
loss_pred:0.02834955044090748, decouple_loss:0.01679890975356102
Iteration: 1649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44065365195274353, gen p mean: 0.0, mean p set: 0.4501151144504547
The modified gen p mean: 0.44850924611091614, gen p mean: 0.0, mean p set: 0.4541688859462738
The modified gen p mean: 0.4444025456905365, gen p mean: 0.0, mean p set: 0.45088011026382446
loss_pred:0.02994888462126255, decouple_loss:0.01753704622387886
loss_pred:0.02883620373904705, decouple_loss:0.016849534586071968
loss_pred:0.028884820640087128, decouple_loss:0.017454586923122406
Iteration: 1650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468821585178375, gen p mean: 0.0, mean p set: 0.45195209980010986
The modified gen p mean: 0.4414571225643158, gen p mean: 0.0, mean p set: 0.4540169835090637
The modified gen p mean: 0.4439784288406372, gen p mean: 0.0, mean p set: 0.4523541033267975
loss_pred:0.029325271025300026, decouple_loss:0.017058605328202248
loss_pred:0.028608126565814018, decouple_loss:0.016658278182148933
loss_pred:0.029138624668121338, decouple_loss:0.01657990925014019
2023-05-03 01:26:54 testing...
The modified gen p mean: 0.455609530210495, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4491778016090393, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.459073543548584, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02965967357158661, decouple_loss:0.01810378022491932
loss_pred:0.03066159598529339, decouple_loss:0.018180271610617638
loss_pred:0.029183873906731606, decouple_loss:0.01828669384121895
WV_0_PC_0_EH_0_PS_40_6, loss: 0.030744563788175583, avg_mse: 0.03493586555123329
current test mse: 0.034936
Iteration: 1651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541451334953308, gen p mean: 0.0, mean p set: 0.44942015409469604
loss_pred:0.02958018332719803, decouple_loss:0.016865355893969536
The modified gen p mean: 0.4532703161239624, gen p mean: 0.0, mean p set: 0.4489629566669464
loss_pred:0.029819518327713013, decouple_loss:0.016930317506194115
The modified gen p mean: 0.45365414023399353, gen p mean: 0.0, mean p set: 0.45186808705329895
loss_pred:0.02762226015329361, decouple_loss:0.016594676300883293
Iteration: 1652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.459346204996109, gen p mean: 0.0, mean p set: 0.4532664716243744
The modified gen p mean: 0.4575155973434448, gen p mean: 0.0, mean p set: 0.4507615268230438
The modified gen p mean: 0.46321359276771545, gen p mean: 0.0, mean p set: 0.45262858271598816
loss_pred:0.028699224814772606, decouple_loss:0.016661187633872032
loss_pred:0.03005574457347393, decouple_loss:0.01689097099006176
loss_pred:0.029659276828169823, decouple_loss:0.017051445320248604
Iteration: 1653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520401656627655, gen p mean: 0.0, mean p set: 0.4495220482349396
The modified gen p mean: 0.4574669301509857, gen p mean: 0.0, mean p set: 0.4533843994140625
The modified gen p mean: 0.4531650245189667, gen p mean: 0.0, mean p set: 0.4518432915210724
loss_pred:0.029829194769263268, decouple_loss:0.016909455880522728
loss_pred:0.030159438028931618, decouple_loss:0.01665273681282997
loss_pred:0.02862067148089409, decouple_loss:0.016717571765184402
Iteration: 1654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728294014930725, gen p mean: 0.0, mean p set: 0.4495052993297577
The modified gen p mean: 0.447001576423645, gen p mean: 0.0, mean p set: 0.45262470841407776
The modified gen p mean: 0.44685739278793335, gen p mean: 0.0, mean p set: 0.45018160343170166
loss_pred:0.029923811554908752, decouple_loss:0.016797896474599838
loss_pred:0.02882974036037922, decouple_loss:0.016334494575858116
loss_pred:0.02990482933819294, decouple_loss:0.016666794195771217
Iteration: 1655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44368064403533936, gen p mean: 0.0, mean p set: 0.4498278796672821
The modified gen p mean: 0.4458619952201843, gen p mean: 0.0, mean p set: 0.45075568556785583
The modified gen p mean: 0.44788873195648193, gen p mean: 0.0, mean p set: 0.4495377540588379
loss_pred:0.029849441722035408, decouple_loss:0.0163432490080595
loss_pred:0.02874038927257061, decouple_loss:0.01659223809838295
loss_pred:0.02964884601533413, decouple_loss:0.01654393970966339
Iteration: 1656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44473302364349365, gen p mean: 0.0, mean p set: 0.45237189531326294
The modified gen p mean: 0.4462851583957672, gen p mean: 0.0, mean p set: 0.4510028660297394
The modified gen p mean: 0.4421060085296631, gen p mean: 0.0, mean p set: 0.44952961802482605
loss_pred:0.02904275245964527, decouple_loss:0.01669241487979889
loss_pred:0.027811909094452858, decouple_loss:0.016207823529839516
loss_pred:0.029898256063461304, decouple_loss:0.01539676170796156
Iteration: 1657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45880985260009766, gen p mean: 0.0, mean p set: 0.4524628818035126
The modified gen p mean: 0.4558728337287903, gen p mean: 0.0, mean p set: 0.450724720954895
The modified gen p mean: 0.45426610112190247, gen p mean: 0.0, mean p set: 0.45060133934020996
loss_pred:0.028950557112693787, decouple_loss:0.016239380463957787
loss_pred:0.028363985940814018, decouple_loss:0.016827166080474854
loss_pred:0.027945352718234062, decouple_loss:0.015799641609191895
Iteration: 1658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541727602481842, gen p mean: 0.0, mean p set: 0.45197993516921997
The modified gen p mean: 0.4499454200267792, gen p mean: 0.0, mean p set: 0.45164522528648376
The modified gen p mean: 0.4505203664302826, gen p mean: 0.0, mean p set: 0.45157068967819214
loss_pred:0.029121369123458862, decouple_loss:0.016036808490753174
loss_pred:0.02959059551358223, decouple_loss:0.01622752845287323
loss_pred:0.028636856004595757, decouple_loss:0.01654629036784172
Iteration: 1659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963428378105164, gen p mean: 0.0, mean p set: 0.45417720079421997
The modified gen p mean: 0.44751831889152527, gen p mean: 0.0, mean p set: 0.4499378204345703
The modified gen p mean: 0.4495719373226166, gen p mean: 0.0, mean p set: 0.45325586199760437
loss_pred:0.03047911450266838, decouple_loss:0.01697901263833046
loss_pred:0.02912594936788082, decouple_loss:0.01594843901693821
loss_pred:0.028769833967089653, decouple_loss:0.016566183418035507
Iteration: 1660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4591483771800995, gen p mean: 0.0, mean p set: 0.4499515891075134
The modified gen p mean: 0.45923280715942383, gen p mean: 0.0, mean p set: 0.4508405923843384
The modified gen p mean: 0.45719149708747864, gen p mean: 0.0, mean p set: 0.44843316078186035
loss_pred:0.02928292751312256, decouple_loss:0.01610109955072403
loss_pred:0.027903877198696136, decouple_loss:0.015459315851330757
loss_pred:0.029815366491675377, decouple_loss:0.01586073450744152
2023-05-03 01:30:35 testing...
The modified gen p mean: 0.44911885261535645, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4401319921016693, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4461250305175781, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.029153520241379738, decouple_loss:0.01742343045771122
loss_pred:0.030745534226298332, decouple_loss:0.017332790419459343
loss_pred:0.02971591241657734, decouple_loss:0.01722879149019718
WV_0_PC_0_EH_0_PS_40_6, loss: 0.030738074332475662, avg_mse: 0.035039324313402176
current test mse: 0.035039
Iteration: 1661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455094635486603, gen p mean: 0.0, mean p set: 0.4516671597957611
The modified gen p mean: 0.4465654790401459, gen p mean: 0.0, mean p set: 0.4482481777667999
loss_pred:0.03012719191610813, decouple_loss:0.01563839428126812
loss_pred:0.02974053844809532, decouple_loss:0.016010930761694908
The modified gen p mean: 0.44793564081192017, gen p mean: 0.0, mean p set: 0.44964808225631714
loss_pred:0.02986821159720421, decouple_loss:0.015777908265590668
Iteration: 1662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43519341945648193, gen p mean: 0.0, mean p set: 0.448453426361084
The modified gen p mean: 0.43926599621772766, gen p mean: 0.0, mean p set: 0.4528384804725647
The modified gen p mean: 0.4431004822254181, gen p mean: 0.0, mean p set: 0.4532550275325775
loss_pred:0.02985433302819729, decouple_loss:0.01560789905488491
loss_pred:0.02825017459690571, decouple_loss:0.01661102846264839
loss_pred:0.028148621320724487, decouple_loss:0.016109507530927658
Iteration: 1663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45796534419059753, gen p mean: 0.0, mean p set: 0.4538205564022064
The modified gen p mean: 0.45500755310058594, gen p mean: 0.0, mean p set: 0.4530285596847534
The modified gen p mean: 0.45277878642082214, gen p mean: 0.0, mean p set: 0.45113280415534973
loss_pred:0.03047250024974346, decouple_loss:0.016320930793881416
loss_pred:0.028510676696896553, decouple_loss:0.016190260648727417
loss_pred:0.02781614661216736, decouple_loss:0.015543930232524872
Iteration: 1664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45524463057518005, gen p mean: 0.0, mean p set: 0.45009464025497437
The modified gen p mean: 0.46167945861816406, gen p mean: 0.0, mean p set: 0.452727735042572
The modified gen p mean: 0.45657798647880554, gen p mean: 0.0, mean p set: 0.45162856578826904
loss_pred:0.02924472466111183, decouple_loss:0.016103290021419525
loss_pred:0.027741944417357445, decouple_loss:0.015857605263590813
loss_pred:0.02745637856423855, decouple_loss:0.015890631824731827
Iteration: 1665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449879914522171, gen p mean: 0.0, mean p set: 0.44883227348327637
The modified gen p mean: 0.45064404606819153, gen p mean: 0.0, mean p set: 0.4520629048347473
The modified gen p mean: 0.450448602437973, gen p mean: 0.0, mean p set: 0.4525880217552185
loss_pred:0.029872652143239975, decouple_loss:0.01643751561641693
loss_pred:0.028723176568746567, decouple_loss:0.016619712114334106
loss_pred:0.028375517576932907, decouple_loss:0.016370728611946106
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
NaN value num: 0
Iteration: 1666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45979511737823486, gen p mean: 0.0, mean p set: 0.4520733654499054
The modified gen p mean: 0.46144554018974304, gen p mean: 0.0, mean p set: 0.45176488161087036
The modified gen p mean: 0.4604843258857727, gen p mean: 0.0, mean p set: 0.45116788148880005
loss_pred:0.028916312381625175, decouple_loss:0.016838816925883293
loss_pred:0.029165197163820267, decouple_loss:0.018106214702129364
loss_pred:0.029229436069726944, decouple_loss:0.0172425527125597
Iteration: 1667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469003677368164, gen p mean: 0.0, mean p set: 0.4525846242904663
The modified gen p mean: 0.4431973397731781, gen p mean: 0.0, mean p set: 0.4517459571361542
The modified gen p mean: 0.4427424967288971, gen p mean: 0.0, mean p set: 0.450788289308548
loss_pred:0.028527479618787766, decouple_loss:0.01725311018526554
loss_pred:0.028588376939296722, decouple_loss:0.017142504453659058
loss_pred:0.02894214354455471, decouple_loss:0.017259690910577774
Iteration: 1668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43994590640068054, gen p mean: 0.0, mean p set: 0.45026299357414246
The modified gen p mean: 0.44215506315231323, gen p mean: 0.0, mean p set: 0.45116758346557617
The modified gen p mean: 0.43774762749671936, gen p mean: 0.0, mean p set: 0.4502086043357849
loss_pred:0.029635999351739883, decouple_loss:0.017481734976172447
loss_pred:0.028761493042111397, decouple_loss:0.017567189410328865
loss_pred:0.028633490204811096, decouple_loss:0.016844704747200012
Iteration: 1669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4609246253967285, gen p mean: 0.0, mean p set: 0.45124995708465576
The modified gen p mean: 0.45797306299209595, gen p mean: 0.0, mean p set: 0.45109736919403076
The modified gen p mean: 0.4573448598384857, gen p mean: 0.0, mean p set: 0.45134058594703674
loss_pred:0.02830374427139759, decouple_loss:0.017274633049964905
loss_pred:0.02866303361952305, decouple_loss:0.016652526333928108
loss_pred:0.028226029127836227, decouple_loss:0.017108922824263573
Iteration: 1670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4586210548877716, gen p mean: 0.0, mean p set: 0.4533045291900635
The modified gen p mean: 0.45776113867759705, gen p mean: 0.0, mean p set: 0.4524940252304077
The modified gen p mean: 0.45602765679359436, gen p mean: 0.0, mean p set: 0.4523225724697113
loss_pred:0.02817627228796482, decouple_loss:0.016678106039762497
loss_pred:0.027203897014260292, decouple_loss:0.017521759495139122
loss_pred:0.027513308450579643, decouple_loss:0.017089834436774254
2023-05-03 01:34:52 testing...
The modified gen p mean: 0.44382426142692566, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.43734875321388245, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44739454984664917, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02947608195245266, decouple_loss:0.018113458529114723
loss_pred:0.03046218492090702, decouple_loss:0.018355747684836388
loss_pred:0.02897762507200241, decouple_loss:0.01845778152346611
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03055408224463463, avg_mse: 0.034697599709033966
current test mse: 0.034698
Iteration: 1671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476829469203949, gen p mean: 0.0, mean p set: 0.4515168070793152
loss_pred:0.028532128781080246, decouple_loss:0.016484854742884636
The modified gen p mean: 0.44913244247436523, gen p mean: 0.0, mean p set: 0.4515817165374756
loss_pred:0.02935686707496643, decouple_loss:0.017230652272701263
The modified gen p mean: 0.44736447930336, gen p mean: 0.0, mean p set: 0.45164093375205994
loss_pred:0.027643568813800812, decouple_loss:0.0163554884493351
Iteration: 1672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809165596961975, gen p mean: 0.0, mean p set: 0.4508955478668213
The modified gen p mean: 0.45007556676864624, gen p mean: 0.0, mean p set: 0.4497600495815277
The modified gen p mean: 0.44838884472846985, gen p mean: 0.0, mean p set: 0.45094895362854004
loss_pred:0.02819201536476612, decouple_loss:0.016486968845129013
loss_pred:0.029500359669327736, decouple_loss:0.016492847353219986
loss_pred:0.028895607218146324, decouple_loss:0.016519637778401375
Iteration: 1673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077621936798096, gen p mean: 0.0, mean p set: 0.45010724663734436
The modified gen p mean: 0.44940367341041565, gen p mean: 0.0, mean p set: 0.45128652453422546
The modified gen p mean: 0.45201990008354187, gen p mean: 0.0, mean p set: 0.4516802132129669
loss_pred:0.028698468580842018, decouple_loss:0.015681834891438484
loss_pred:0.028275562450289726, decouple_loss:0.017104459926486015
loss_pred:0.027446476742625237, decouple_loss:0.01602644845843315
Iteration: 1674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915321469306946, gen p mean: 0.0, mean p set: 0.45044055581092834
The modified gen p mean: 0.45203277468681335, gen p mean: 0.0, mean p set: 0.4523712396621704
The modified gen p mean: 0.4506126940250397, gen p mean: 0.0, mean p set: 0.4518023431301117
loss_pred:0.029566554352641106, decouple_loss:0.015451094135642052
loss_pred:0.029841650277376175, decouple_loss:0.016409192234277725
loss_pred:0.027540871873497963, decouple_loss:0.016152000054717064
Iteration: 1675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516720175743103, gen p mean: 0.0, mean p set: 0.45177337527275085
The modified gen p mean: 0.44631969928741455, gen p mean: 0.0, mean p set: 0.4523715376853943
The modified gen p mean: 0.452287495136261, gen p mean: 0.0, mean p set: 0.45150282979011536
loss_pred:0.02889143116772175, decouple_loss:0.015937810763716698
loss_pred:0.027747081592679024, decouple_loss:0.017056714743375778
loss_pred:0.028163088485598564, decouple_loss:0.01705344207584858
Iteration: 1676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4584243893623352, gen p mean: 0.0, mean p set: 0.45229440927505493
The modified gen p mean: 0.45877963304519653, gen p mean: 0.0, mean p set: 0.45367616415023804
The modified gen p mean: 0.45792657136917114, gen p mean: 0.0, mean p set: 0.45218244194984436
loss_pred:0.029909227043390274, decouple_loss:0.016629407182335854
loss_pred:0.029346294701099396, decouple_loss:0.016627077013254166
loss_pred:0.029140198603272438, decouple_loss:0.016308527439832687
Iteration: 1677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711822271347046, gen p mean: 0.0, mean p set: 0.45335304737091064
The modified gen p mean: 0.4437493085861206, gen p mean: 0.0, mean p set: 0.4529889225959778
The modified gen p mean: 0.4465973973274231, gen p mean: 0.0, mean p set: 0.4519391357898712
loss_pred:0.02971474640071392, decouple_loss:0.015992725268006325
loss_pred:0.02768569067120552, decouple_loss:0.016620736569166183
loss_pred:0.02688908763229847, decouple_loss:0.015926046296954155
Iteration: 1678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508950412273407, gen p mean: 0.0, mean p set: 0.4524218738079071
The modified gen p mean: 0.45378023386001587, gen p mean: 0.0, mean p set: 0.45169830322265625
The modified gen p mean: 0.4457404315471649, gen p mean: 0.0, mean p set: 0.4509281814098358
loss_pred:0.027587534859776497, decouple_loss:0.01585482805967331
loss_pred:0.027845026925206184, decouple_loss:0.015813758596777916
loss_pred:0.02886318415403366, decouple_loss:0.016320543363690376
Iteration: 1679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45981138944625854, gen p mean: 0.0, mean p set: 0.45220664143562317
The modified gen p mean: 0.45679059624671936, gen p mean: 0.0, mean p set: 0.45310890674591064
The modified gen p mean: 0.4600517153739929, gen p mean: 0.0, mean p set: 0.4523092210292816
loss_pred:0.02783217467367649, decouple_loss:0.01612924225628376
loss_pred:0.027678485959768295, decouple_loss:0.016241319477558136
loss_pred:0.02845001593232155, decouple_loss:0.015907367691397667
Iteration: 1680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763174653053284, gen p mean: 0.0, mean p set: 0.45303553342819214
The modified gen p mean: 0.44998258352279663, gen p mean: 0.0, mean p set: 0.45034632086753845
The modified gen p mean: 0.44637420773506165, gen p mean: 0.0, mean p set: 0.4505651295185089
loss_pred:0.028072530403733253, decouple_loss:0.016003675758838654
loss_pred:0.028292393311858177, decouple_loss:0.016365638002753258
loss_pred:0.028291836380958557, decouple_loss:0.015911895781755447
2023-05-03 01:38:35 testing...
The modified gen p mean: 0.4495793879032135, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4394417703151703, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44586238265037537, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.0289139486849308, decouple_loss:0.01761498674750328
loss_pred:0.030462268739938736, decouple_loss:0.01781468652188778
loss_pred:0.029466494917869568, decouple_loss:0.017556602135300636
WV_0_PC_0_EH_0_PS_40_6, loss: 0.030497342348098755, avg_mse: 0.03465864807367325
current test mse: 0.034659
Iteration: 1681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45047494769096375, gen p mean: 0.0, mean p set: 0.4538613259792328
The modified gen p mean: 0.4499022960662842, gen p mean: 0.0, mean p set: 0.45042940974235535
loss_pred:0.0284113772213459, decouple_loss:0.015485817566514015
loss_pred:0.029510822147130966, decouple_loss:0.015398924238979816
The modified gen p mean: 0.4451732933521271, gen p mean: 0.0, mean p set: 0.45093876123428345
loss_pred:0.02806106209754944, decouple_loss:0.016191130504012108
Iteration: 1682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45753124356269836, gen p mean: 0.0, mean p set: 0.45104846358299255
The modified gen p mean: 0.4612804651260376, gen p mean: 0.0, mean p set: 0.4510599374771118
The modified gen p mean: 0.45898115634918213, gen p mean: 0.0, mean p set: 0.45235851407051086
loss_pred:0.02834099903702736, decouple_loss:0.01533059123903513
loss_pred:0.028477996587753296, decouple_loss:0.015872271731495857
loss_pred:0.029049942269921303, decouple_loss:0.015768829733133316
Iteration: 1683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486534893512726, gen p mean: 0.0, mean p set: 0.4507088363170624
The modified gen p mean: 0.4444032609462738, gen p mean: 0.0, mean p set: 0.45155444741249084
The modified gen p mean: 0.4500843286514282, gen p mean: 0.0, mean p set: 0.45251214504241943
loss_pred:0.028400583192706108, decouple_loss:0.015447988174855709
loss_pred:0.028049971908330917, decouple_loss:0.015597275458276272
loss_pred:0.028885377570986748, decouple_loss:0.015659112483263016
Iteration: 1684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43768274784088135, gen p mean: 0.0, mean p set: 0.4527246057987213
The modified gen p mean: 0.44344210624694824, gen p mean: 0.0, mean p set: 0.45130568742752075
The modified gen p mean: 0.4381881356239319, gen p mean: 0.0, mean p set: 0.45268896222114563
loss_pred:0.027569729834794998, decouple_loss:0.01591411419212818
loss_pred:0.028227681294083595, decouple_loss:0.015065108425915241
loss_pred:0.02771805040538311, decouple_loss:0.016667259857058525
Iteration: 1685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4590672254562378, gen p mean: 0.0, mean p set: 0.45239993929862976
The modified gen p mean: 0.4548884630203247, gen p mean: 0.0, mean p set: 0.4523046314716339
The modified gen p mean: 0.45842379331588745, gen p mean: 0.0, mean p set: 0.4519527554512024
loss_pred:0.02871887758374214, decouple_loss:0.014991062693297863
loss_pred:0.02844853512942791, decouple_loss:0.015745460987091064
loss_pred:0.027654943987727165, decouple_loss:0.015922335907816887
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 1686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4571516513824463, gen p mean: 0.0, mean p set: 0.4489942789077759
The modified gen p mean: 0.45446187257766724, gen p mean: 0.0, mean p set: 0.4484281837940216
The modified gen p mean: 0.45640498399734497, gen p mean: 0.0, mean p set: 0.4484524726867676
loss_pred:0.0306434016674757, decouple_loss:0.017260687425732613
loss_pred:0.029088467359542847, decouple_loss:0.016965055838227272
loss_pred:0.02940424717962742, decouple_loss:0.01683526113629341
Iteration: 1687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489589333534241, gen p mean: 0.0, mean p set: 0.4480552673339844
The modified gen p mean: 0.45308634638786316, gen p mean: 0.0, mean p set: 0.4485248327255249
The modified gen p mean: 0.45025497674942017, gen p mean: 0.0, mean p set: 0.44810861349105835
loss_pred:0.029436418786644936, decouple_loss:0.01609545573592186
loss_pred:0.028486503288149834, decouple_loss:0.01600588671863079
loss_pred:0.02923072874546051, decouple_loss:0.01609490066766739
Iteration: 1688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482840597629547, gen p mean: 0.0, mean p set: 0.44850608706474304
The modified gen p mean: 0.44784149527549744, gen p mean: 0.0, mean p set: 0.4477500915527344
The modified gen p mean: 0.4492000937461853, gen p mean: 0.0, mean p set: 0.4488039016723633
loss_pred:0.02777547761797905, decouple_loss:0.015233220532536507
loss_pred:0.0298982635140419, decouple_loss:0.015973282977938652
loss_pred:0.02751239575445652, decouple_loss:0.015494205988943577
Iteration: 1689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4402107298374176, gen p mean: 0.0, mean p set: 0.4491024613380432
The modified gen p mean: 0.43943291902542114, gen p mean: 0.0, mean p set: 0.44895458221435547
The modified gen p mean: 0.4396970272064209, gen p mean: 0.0, mean p set: 0.4499613046646118
loss_pred:0.028628619387745857, decouple_loss:0.01522394735366106
loss_pred:0.029028186574578285, decouple_loss:0.015430701896548271
loss_pred:0.029066085815429688, decouple_loss:0.01594662107527256
Iteration: 1690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43493443727493286, gen p mean: 0.0, mean p set: 0.45025789737701416
The modified gen p mean: 0.4393658936023712, gen p mean: 0.0, mean p set: 0.44874149560928345
The modified gen p mean: 0.4353814125061035, gen p mean: 0.0, mean p set: 0.44859424233436584
loss_pred:0.028809649869799614, decouple_loss:0.01599935069680214
loss_pred:0.027869023382663727, decouple_loss:0.015226945281028748
loss_pred:0.03023754246532917, decouple_loss:0.016004027798771858
2023-05-03 01:42:59 testing...
The modified gen p mean: 0.46602678298950195, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45954591035842896, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4692009389400482, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.029265522956848145, decouple_loss:0.016414977610111237
loss_pred:0.030278854072093964, decouple_loss:0.017102627083659172
loss_pred:0.0289031770080328, decouple_loss:0.016245361417531967
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03031190112233162, avg_mse: 0.03441842272877693
current test mse: 0.034418
Iteration: 1691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46818986535072327, gen p mean: 0.0, mean p set: 0.44876906275749207
The modified gen p mean: 0.4634246826171875, gen p mean: 0.0, mean p set: 0.44815701246261597
loss_pred:0.0281403586268425, decouple_loss:0.015372025780379772
loss_pred:0.029773211106657982, decouple_loss:0.015930509194731712
The modified gen p mean: 0.4670558571815491, gen p mean: 0.0, mean p set: 0.447747141122818
loss_pred:0.028697699308395386, decouple_loss:0.01607447676360607
Iteration: 1692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46392908692359924, gen p mean: 0.0, mean p set: 0.4482302665710449
The modified gen p mean: 0.4600618779659271, gen p mean: 0.0, mean p set: 0.44693389534950256
The modified gen p mean: 0.4580126404762268, gen p mean: 0.0, mean p set: 0.4483965039253235
loss_pred:0.028091957792639732, decouple_loss:0.015285185538232327
loss_pred:0.02909737452864647, decouple_loss:0.015950750559568405
loss_pred:0.02917085401713848, decouple_loss:0.01640741527080536
Iteration: 1693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4309018552303314, gen p mean: 0.0, mean p set: 0.4472673535346985
The modified gen p mean: 0.4347229301929474, gen p mean: 0.0, mean p set: 0.4489155113697052
The modified gen p mean: 0.43414488434791565, gen p mean: 0.0, mean p set: 0.44827526807785034
loss_pred:0.02953917160630226, decouple_loss:0.016241172328591347
loss_pred:0.02900954894721508, decouple_loss:0.01636451669037342
loss_pred:0.029550863429903984, decouple_loss:0.015826614573597908
Iteration: 1694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44585657119750977, gen p mean: 0.0, mean p set: 0.448875367641449
The modified gen p mean: 0.4482736587524414, gen p mean: 0.0, mean p set: 0.4485850930213928
The modified gen p mean: 0.4414101243019104, gen p mean: 0.0, mean p set: 0.44735386967658997
loss_pred:0.0291723795235157, decouple_loss:0.016025187447667122
loss_pred:0.02784569375216961, decouple_loss:0.01505760196596384
loss_pred:0.030190132558345795, decouple_loss:0.016020100563764572
Iteration: 1695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463731050491333, gen p mean: 0.0, mean p set: 0.44841110706329346
The modified gen p mean: 0.45289701223373413, gen p mean: 0.0, mean p set: 0.44738268852233887
The modified gen p mean: 0.4476880729198456, gen p mean: 0.0, mean p set: 0.44829997420310974
loss_pred:0.03022117353975773, decouple_loss:0.015324568375945091
loss_pred:0.029529958963394165, decouple_loss:0.01565873622894287
loss_pred:0.02951337769627571, decouple_loss:0.015285152941942215
Iteration: 1696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44181275367736816, gen p mean: 0.0, mean p set: 0.44905540347099304
The modified gen p mean: 0.45134326815605164, gen p mean: 0.0, mean p set: 0.4486396908760071
The modified gen p mean: 0.4518086910247803, gen p mean: 0.0, mean p set: 0.4498293101787567
loss_pred:0.029221419245004654, decouple_loss:0.016071844846010208
loss_pred:0.02943560667335987, decouple_loss:0.015061679296195507
loss_pred:0.028666354715824127, decouple_loss:0.015424104407429695
Iteration: 1697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4551870822906494, gen p mean: 0.0, mean p set: 0.4476827085018158
The modified gen p mean: 0.4571233093738556, gen p mean: 0.0, mean p set: 0.44665467739105225
The modified gen p mean: 0.45218604803085327, gen p mean: 0.0, mean p set: 0.44791606068611145
loss_pred:0.029037095606327057, decouple_loss:0.015342006459832191
loss_pred:0.0297226682305336, decouple_loss:0.015392154455184937
loss_pred:0.02930726669728756, decouple_loss:0.015201540663838387
Iteration: 1698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514596462249756, gen p mean: 0.0, mean p set: 0.4478446841239929
The modified gen p mean: 0.44431230425834656, gen p mean: 0.0, mean p set: 0.4473487436771393
The modified gen p mean: 0.4515988826751709, gen p mean: 0.0, mean p set: 0.44846752285957336
loss_pred:0.029268406331539154, decouple_loss:0.015259292908012867
loss_pred:0.02926429733633995, decouple_loss:0.015758704394102097
loss_pred:0.028058959171175957, decouple_loss:0.015013162977993488
Iteration: 1699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44287776947021484, gen p mean: 0.0, mean p set: 0.4470857083797455
The modified gen p mean: 0.4384306073188782, gen p mean: 0.0, mean p set: 0.4486897885799408
The modified gen p mean: 0.4416976273059845, gen p mean: 0.0, mean p set: 0.4476391673088074
loss_pred:0.029741745442152023, decouple_loss:0.01460566371679306
loss_pred:0.02889050357043743, decouple_loss:0.014784724451601505
loss_pred:0.028699159622192383, decouple_loss:0.01485688891261816
Iteration: 1700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45699191093444824, gen p mean: 0.0, mean p set: 0.44846025109291077
The modified gen p mean: 0.44944432377815247, gen p mean: 0.0, mean p set: 0.4478660821914673
loss_pred:0.027931097894906998, decouple_loss:0.014713929034769535
The modified gen p mean: 0.45073485374450684, gen p mean: 0.0, mean p set: 0.44740498065948486
loss_pred:0.02903798781335354, decouple_loss:0.014700919389724731
loss_pred:0.028540272265672684, decouple_loss:0.0147293945774436
2023-05-03 01:46:40 testing...
The modified gen p mean: 0.45173290371894836, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4454282224178314, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4554063081741333, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028999008238315582, decouple_loss:0.014925915747880936
loss_pred:0.030071720480918884, decouple_loss:0.015470687299966812
loss_pred:0.02860296703875065, decouple_loss:0.01485571451485157
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02997877076268196, avg_mse: 0.034052252769470215
current test mse: 0.034052
Iteration: 1701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914016127586365, gen p mean: 0.0, mean p set: 0.4473954439163208
The modified gen p mean: 0.453757107257843, gen p mean: 0.0, mean p set: 0.4494676887989044
loss_pred:0.02975556068122387, decouple_loss:0.014413435943424702
loss_pred:0.028631165623664856, decouple_loss:0.015233502723276615
The modified gen p mean: 0.4530634582042694, gen p mean: 0.0, mean p set: 0.44826218485832214
loss_pred:0.028771236538887024, decouple_loss:0.014448908157646656
Iteration: 1702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43840524554252625, gen p mean: 0.0, mean p set: 0.4488346576690674
The modified gen p mean: 0.43680474162101746, gen p mean: 0.0, mean p set: 0.44813862442970276
The modified gen p mean: 0.43278196454048157, gen p mean: 0.0, mean p set: 0.4479939937591553
loss_pred:0.029270026832818985, decouple_loss:0.015420304611325264loss_pred:0.02967344969511032, decouple_loss:0.014613471925258636
loss_pred:0.02907005324959755, decouple_loss:0.014233608730137348
Iteration: 1703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4570925831794739, gen p mean: 0.0, mean p set: 0.4496593773365021
The modified gen p mean: 0.45763176679611206, gen p mean: 0.0, mean p set: 0.44716405868530273
The modified gen p mean: 0.45744016766548157, gen p mean: 0.0, mean p set: 0.44761136174201965
loss_pred:0.02822500467300415, decouple_loss:0.014281434938311577
loss_pred:0.028233332559466362, decouple_loss:0.01403631642460823
loss_pred:0.02834967151284218, decouple_loss:0.014158348552882671
Iteration: 1704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482673108577728, gen p mean: 0.0, mean p set: 0.4483831226825714
The modified gen p mean: 0.4505922198295593, gen p mean: 0.0, mean p set: 0.4482366442680359
The modified gen p mean: 0.44331151247024536, gen p mean: 0.0, mean p set: 0.44691917300224304
loss_pred:0.028484167531132698, decouple_loss:0.01412409357726574
loss_pred:0.027892904356122017, decouple_loss:0.014796464703977108
loss_pred:0.029381947591900826, decouple_loss:0.015271274372935295
Iteration: 1705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445760041475296, gen p mean: 0.0, mean p set: 0.449484258890152
The modified gen p mean: 0.43644365668296814, gen p mean: 0.0, mean p set: 0.4481002688407898
The modified gen p mean: 0.44893357157707214, gen p mean: 0.0, mean p set: 0.4474572539329529
loss_pred:0.02855612151324749, decouple_loss:0.014879175461828709
loss_pred:0.028997715562582016, decouple_loss:0.015118398703634739
loss_pred:0.028706898912787437, decouple_loss:0.01482987217605114
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
NaN value num: 0
Iteration: 1706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4558665156364441, gen p mean: 0.0, mean p set: 0.45006507635116577
The modified gen p mean: 0.46343883872032166, gen p mean: 0.0, mean p set: 0.4507491886615753
The modified gen p mean: 0.45655766129493713, gen p mean: 0.0, mean p set: 0.45048198103904724
loss_pred:0.029426755383610725, decouple_loss:0.017901290208101273
loss_pred:0.028857335448265076, decouple_loss:0.016620852053165436
loss_pred:0.03019030950963497, decouple_loss:0.0168014969676733
Iteration: 1707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45826661586761475, gen p mean: 0.0, mean p set: 0.45089852809906006
The modified gen p mean: 0.45559629797935486, gen p mean: 0.0, mean p set: 0.4489981234073639
The modified gen p mean: 0.4532295763492584, gen p mean: 0.0, mean p set: 0.4503287672996521
loss_pred:0.029511068016290665, decouple_loss:0.017181243747472763
loss_pred:0.028582129627466202, decouple_loss:0.016219625249505043
loss_pred:0.029831718653440475, decouple_loss:0.015906106680631638
Iteration: 1708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43339982628822327, gen p mean: 0.0, mean p set: 0.44811883568763733
The modified gen p mean: 0.4414522647857666, gen p mean: 0.0, mean p set: 0.4493641257286072
The modified gen p mean: 0.4370374083518982, gen p mean: 0.0, mean p set: 0.45045650005340576
loss_pred:0.029046131297945976, decouple_loss:0.01603514701128006
loss_pred:0.028347786515951157, decouple_loss:0.01586678996682167
loss_pred:0.028564313426613808, decouple_loss:0.01551875751465559
Iteration: 1709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.437850683927536, gen p mean: 0.0, mean p set: 0.4489381015300751
The modified gen p mean: 0.4442676603794098, gen p mean: 0.0, mean p set: 0.451458215713501
The modified gen p mean: 0.4427790939807892, gen p mean: 0.0, mean p set: 0.4482189118862152
loss_pred:0.029014531522989273, decouple_loss:0.01578083261847496
loss_pred:0.029013484716415405, decouple_loss:0.01598171517252922
loss_pred:0.02997283823788166, decouple_loss:0.0155754080042243
Iteration: 1710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46269288659095764, gen p mean: 0.0, mean p set: 0.45105084776878357
The modified gen p mean: 0.45820751786231995, gen p mean: 0.0, mean p set: 0.44865939021110535
The modified gen p mean: 0.452970027923584, gen p mean: 0.0, mean p set: 0.44903138279914856
loss_pred:0.029298873618245125, decouple_loss:0.016421565786004066
loss_pred:0.02884398214519024, decouple_loss:0.015225682407617569
loss_pred:0.029003430157899857, decouple_loss:0.015755223110318184
2023-05-03 01:51:00 testing...
The modified gen p mean: 0.4457201361656189, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.43955060839653015, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4492952227592468, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.03030683659017086, decouple_loss:0.017285341396927834
loss_pred:0.029275590553879738, decouple_loss:0.016641253605484962
loss_pred:0.028815751895308495, decouple_loss:0.017279595136642456
WV_0_PC_0_EH_0_PS_40_6, loss: 0.030319496989250183, avg_mse: 0.03441848233342171
current test mse: 0.034418
Iteration: 1711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449014812707901, gen p mean: 0.0, mean p set: 0.45025986433029175
loss_pred:0.02870829403400421, decouple_loss:0.015066107735037804
The modified gen p mean: 0.44978904724121094, gen p mean: 0.0, mean p set: 0.44936051964759827
loss_pred:0.028654001653194427, decouple_loss:0.01533476822078228
The modified gen p mean: 0.4490155577659607, gen p mean: 0.0, mean p set: 0.448642760515213
loss_pred:0.03000389039516449, decouple_loss:0.01566588506102562
Iteration: 1712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46045440435409546, gen p mean: 0.0, mean p set: 0.4508446753025055
The modified gen p mean: 0.4549955725669861, gen p mean: 0.0, mean p set: 0.44934722781181335
loss_pred:0.028746765106916428, decouple_loss:0.0158113781362772
The modified gen p mean: 0.45548588037490845, gen p mean: 0.0, mean p set: 0.4486430585384369
loss_pred:0.02922099083662033, decouple_loss:0.015254048630595207
loss_pred:0.028478942811489105, decouple_loss:0.015450981445610523
Iteration: 1713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461103081703186, gen p mean: 0.0, mean p set: 0.44860365986824036
The modified gen p mean: 0.4478267431259155, gen p mean: 0.0, mean p set: 0.4509223401546478
The modified gen p mean: 0.448220819234848, gen p mean: 0.0, mean p set: 0.44840651750564575
loss_pred:0.02893849089741707, decouple_loss:0.015036973170936108
loss_pred:0.028840674087405205, decouple_loss:0.01602960377931595
loss_pred:0.029677370563149452, decouple_loss:0.015598747879266739
Iteration: 1714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4344469904899597, gen p mean: 0.0, mean p set: 0.4524003565311432
The modified gen p mean: 0.4391394257545471, gen p mean: 0.0, mean p set: 0.44919705390930176
The modified gen p mean: 0.43346041440963745, gen p mean: 0.0, mean p set: 0.4476113021373749
loss_pred:0.028768114745616913, decouple_loss:0.015560457482933998
loss_pred:0.02884167991578579, decouple_loss:0.014908146113157272
loss_pred:0.030133621767163277, decouple_loss:0.015202172100543976
Iteration: 1715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44929414987564087, gen p mean: 0.0, mean p set: 0.4502054452896118
The modified gen p mean: 0.45296618342399597, gen p mean: 0.0, mean p set: 0.4497230648994446
The modified gen p mean: 0.45129960775375366, gen p mean: 0.0, mean p set: 0.45005226135253906
loss_pred:0.02906656451523304, decouple_loss:0.01484481617808342
loss_pred:0.029084863141179085, decouple_loss:0.015032592229545116
loss_pred:0.029290439561009407, decouple_loss:0.014930026605725288
Iteration: 1716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4629015624523163, gen p mean: 0.0, mean p set: 0.4483916759490967
The modified gen p mean: 0.4605695605278015, gen p mean: 0.0, mean p set: 0.450085312128067
The modified gen p mean: 0.45920509099960327, gen p mean: 0.0, mean p set: 0.4528099000453949
loss_pred:0.029378831386566162, decouple_loss:0.014994638040661812
loss_pred:0.028536435216665268, decouple_loss:0.014850812032818794
loss_pred:0.028197379782795906, decouple_loss:0.01493003498762846
Iteration: 1717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43985825777053833, gen p mean: 0.0, mean p set: 0.4503563344478607
The modified gen p mean: 0.44309982657432556, gen p mean: 0.0, mean p set: 0.45076125860214233
The modified gen p mean: 0.4398548901081085, gen p mean: 0.0, mean p set: 0.44939908385276794
loss_pred:0.02809056267142296, decouple_loss:0.01529683731496334
loss_pred:0.028474442660808563, decouple_loss:0.014932154677808285
loss_pred:0.028099246323108673, decouple_loss:0.015249603427946568
Iteration: 1718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504338502883911, gen p mean: 0.0, mean p set: 0.45113739371299744
The modified gen p mean: 0.4543760418891907, gen p mean: 0.0, mean p set: 0.44938188791275024
The modified gen p mean: 0.4515150785446167, gen p mean: 0.0, mean p set: 0.448630690574646
loss_pred:0.028286928310990334, decouple_loss:0.015208659693598747
loss_pred:0.028088388964533806, decouple_loss:0.014182367362082005
loss_pred:0.027983402833342552, decouple_loss:0.014659279026091099
Iteration: 1719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45785996317863464, gen p mean: 0.0, mean p set: 0.44955018162727356
The modified gen p mean: 0.4612378776073456, gen p mean: 0.0, mean p set: 0.45063650608062744
The modified gen p mean: 0.458865761756897, gen p mean: 0.0, mean p set: 0.45000073313713074
loss_pred:0.029373040422797203, decouple_loss:0.01458949688822031
loss_pred:0.0292715635150671, decouple_loss:0.015032399445772171
loss_pred:0.028853757306933403, decouple_loss:0.01444914285093546
Iteration: 1720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4355872571468353, gen p mean: 0.0, mean p set: 0.4499492049217224
The modified gen p mean: 0.43901288509368896, gen p mean: 0.0, mean p set: 0.45045000314712524
The modified gen p mean: 0.4415782392024994, gen p mean: 0.0, mean p set: 0.4511106312274933
loss_pred:0.0278923399746418, decouple_loss:0.014251182787120342
loss_pred:0.029248589649796486, decouple_loss:0.014291169121861458
loss_pred:0.029167303815484047, decouple_loss:0.014998562633991241
2023-05-03 01:54:42 testing...
The modified gen p mean: 0.43461906909942627, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44081565737724304, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44414234161376953, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.030331244692206383, decouple_loss:0.01656515896320343
loss_pred:0.02922186627984047, decouple_loss:0.015916120260953903
loss_pred:0.02878866344690323, decouple_loss:0.01653163507580757
WV_0_PC_0_EH_0_PS_40_6, loss: 0.030264142900705338, avg_mse: 0.03446638584136963
current test mse: 0.034466
Iteration: 1721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4418453276157379, gen p mean: 0.0, mean p set: 0.4506036043167114
The modified gen p mean: 0.4452868103981018, gen p mean: 0.0, mean p set: 0.4503055810928345
loss_pred:0.029281651601195335, decouple_loss:0.014479347504675388
loss_pred:0.029353275895118713, decouple_loss:0.014370867051184177
The modified gen p mean: 0.44046297669410706, gen p mean: 0.0, mean p set: 0.4500850439071655
loss_pred:0.029145872220396996, decouple_loss:0.014327995479106903
Iteration: 1722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46272385120391846, gen p mean: 0.0, mean p set: 0.4497860372066498
The modified gen p mean: 0.45437657833099365, gen p mean: 0.0, mean p set: 0.44930049777030945
The modified gen p mean: 0.4612922966480255, gen p mean: 0.0, mean p set: 0.44841670989990234
loss_pred:0.029377005994319916, decouple_loss:0.014539663679897785
loss_pred:0.02850065752863884, decouple_loss:0.015260174870491028
loss_pred:0.02844311110675335, decouple_loss:0.014790010638535023
Iteration: 1723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4546971917152405, gen p mean: 0.0, mean p set: 0.45084071159362793
The modified gen p mean: 0.4551142454147339, gen p mean: 0.0, mean p set: 0.45061561465263367
The modified gen p mean: 0.455705463886261, gen p mean: 0.0, mean p set: 0.4517301619052887
loss_pred:0.027612632140517235, decouple_loss:0.014792272821068764loss_pred:0.02816358208656311, decouple_loss:0.014399196952581406
loss_pred:0.028344104066491127, decouple_loss:0.015016792342066765
Iteration: 1724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462553560733795, gen p mean: 0.0, mean p set: 0.44931453466415405
The modified gen p mean: 0.44491666555404663, gen p mean: 0.0, mean p set: 0.4506600499153137
The modified gen p mean: 0.44410356879234314, gen p mean: 0.0, mean p set: 0.4510374367237091
loss_pred:0.02956393174827099, decouple_loss:0.014353995211422443
loss_pred:0.029170453548431396, decouple_loss:0.014040522277355194
loss_pred:0.0282124150544405, decouple_loss:0.014760441146790981
Iteration: 1725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868117570877075, gen p mean: 0.0, mean p set: 0.44827285408973694
The modified gen p mean: 0.45210716128349304, gen p mean: 0.0, mean p set: 0.45007678866386414
The modified gen p mean: 0.45441532135009766, gen p mean: 0.0, mean p set: 0.4509299099445343
loss_pred:0.02930385246872902, decouple_loss:0.015293010510504246
loss_pred:0.029802700504660606, decouple_loss:0.014436187222599983
loss_pred:0.02857941947877407, decouple_loss:0.014631908386945724
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
NaN value num: 0
Iteration: 1726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481324851512909, gen p mean: 0.0, mean p set: 0.452515572309494
The modified gen p mean: 0.44963496923446655, gen p mean: 0.0, mean p set: 0.45191019773483276
The modified gen p mean: 0.4454939663410187, gen p mean: 0.0, mean p set: 0.4525927007198334
loss_pred:0.02929729036986828, decouple_loss:0.01613258384168148
loss_pred:0.02867720276117325, decouple_loss:0.016573982313275337
loss_pred:0.02973335236310959, decouple_loss:0.01668407954275608
Iteration: 1727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748544692993164, gen p mean: 0.0, mean p set: 0.4524637460708618
The modified gen p mean: 0.4454811215400696, gen p mean: 0.0, mean p set: 0.4503213167190552
The modified gen p mean: 0.440583199262619, gen p mean: 0.0, mean p set: 0.4504547715187073
loss_pred:0.03032769449055195, decouple_loss:0.01573815755546093
loss_pred:0.02838798053562641, decouple_loss:0.01585305668413639
loss_pred:0.03147486597299576, decouple_loss:0.016302533447742462
Iteration: 1728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45387062430381775, gen p mean: 0.0, mean p set: 0.45034095644950867
The modified gen p mean: 0.45306533575057983, gen p mean: 0.0, mean p set: 0.4502466022968292
The modified gen p mean: 0.4530911445617676, gen p mean: 0.0, mean p set: 0.450737327337265
loss_pred:0.03046782687306404, decouple_loss:0.016244929283857346
loss_pred:0.030736658722162247, decouple_loss:0.01614978350698948
loss_pred:0.03038059175014496, decouple_loss:0.016168657690286636
Iteration: 1729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4548940062522888, gen p mean: 0.0, mean p set: 0.45219019055366516
The modified gen p mean: 0.45611411333084106, gen p mean: 0.0, mean p set: 0.44915124773979187
The modified gen p mean: 0.4573076069355011, gen p mean: 0.0, mean p set: 0.4506123960018158
loss_pred:0.029307054355740547, decouple_loss:0.015168609097599983
loss_pred:0.028590774163603783, decouple_loss:0.015731483697891235
loss_pred:0.029484830796718597, decouple_loss:0.015933707356452942
Iteration: 1730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447384774684906, gen p mean: 0.0, mean p set: 0.4497171640396118
The modified gen p mean: 0.446590781211853, gen p mean: 0.0, mean p set: 0.45335903763771057
The modified gen p mean: 0.4442860186100006, gen p mean: 0.0, mean p set: 0.4504959285259247
loss_pred:0.028363706544041634, decouple_loss:0.015763942152261734
loss_pred:0.02911563776433468, decouple_loss:0.015986835584044456
loss_pred:0.030430912971496582, decouple_loss:0.015541045926511288
2023-05-03 01:59:02 testing...
The modified gen p mean: 0.4484858214855194, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4585360288619995, gen p mean: 0.0, mean p set: 0.45035696029663086The modified gen p mean: 0.4550507962703705, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.030164627358317375, decouple_loss:0.017064174637198448
loss_pred:0.028630927205085754, decouple_loss:0.016751594841480255
loss_pred:0.029049109667539597, decouple_loss:0.016665389761328697
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03012290596961975, avg_mse: 0.034243762493133545
current test mse: 0.034244
Iteration: 1731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536280035972595, gen p mean: 0.0, mean p set: 0.45074281096458435
The modified gen p mean: 0.45182493329048157, gen p mean: 0.0, mean p set: 0.4523504674434662
loss_pred:0.03031279891729355, decouple_loss:0.01482328400015831
loss_pred:0.02972118742763996, decouple_loss:0.016698196530342102
The modified gen p mean: 0.46122416853904724, gen p mean: 0.0, mean p set: 0.45036324858665466
loss_pred:0.028065070509910583, decouple_loss:0.015236125327646732
Iteration: 1732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492344558238983, gen p mean: 0.0, mean p set: 0.44929152727127075
The modified gen p mean: 0.45443764328956604, gen p mean: 0.0, mean p set: 0.4524324834346771
The modified gen p mean: 0.4496285617351532, gen p mean: 0.0, mean p set: 0.45021387934684753
loss_pred:0.029643001034855843, decouple_loss:0.01561486441642046
loss_pred:0.028784962370991707, decouple_loss:0.01592140644788742
loss_pred:0.029794462025165558, decouple_loss:0.015294842422008514
Iteration: 1733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4347720146179199, gen p mean: 0.0, mean p set: 0.4494739770889282
The modified gen p mean: 0.4353387951850891, gen p mean: 0.0, mean p set: 0.4499017596244812
The modified gen p mean: 0.4371817708015442, gen p mean: 0.0, mean p set: 0.44993001222610474
loss_pred:0.029649125412106514, decouple_loss:0.015483305789530277
loss_pred:0.03032672218978405, decouple_loss:0.015604451298713684
loss_pred:0.028471728786826134, decouple_loss:0.01522981096059084
Iteration: 1734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4592866599559784, gen p mean: 0.0, mean p set: 0.4495861530303955
The modified gen p mean: 0.46384888887405396, gen p mean: 0.0, mean p set: 0.4507834315299988
The modified gen p mean: 0.45645663142204285, gen p mean: 0.0, mean p set: 0.45218008756637573
loss_pred:0.029864782467484474, decouple_loss:0.015850378200411797
loss_pred:0.028036149218678474, decouple_loss:0.015226451680064201
loss_pred:0.030138717964291573, decouple_loss:0.016824454069137573
Iteration: 1735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4619396924972534, gen p mean: 0.0, mean p set: 0.4524017870426178
The modified gen p mean: 0.46103352308273315, gen p mean: 0.0, mean p set: 0.44989094138145447
The modified gen p mean: 0.46111175417900085, gen p mean: 0.0, mean p set: 0.45188307762145996
loss_pred:0.028337229043245316, decouple_loss:0.01574527472257614
loss_pred:0.028664635494351387, decouple_loss:0.01497594267129898
loss_pred:0.030625490471720695, decouple_loss:0.015672627836465836
Iteration: 1736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43437403440475464, gen p mean: 0.0, mean p set: 0.4504155218601227
The modified gen p mean: 0.4363408386707306, gen p mean: 0.0, mean p set: 0.449949711561203
The modified gen p mean: 0.43630391359329224, gen p mean: 0.0, mean p set: 0.4507574439048767
loss_pred:0.03159743919968605, decouple_loss:0.015179887413978577
loss_pred:0.027825139462947845, decouple_loss:0.014772241935133934
loss_pred:0.030612586066126823, decouple_loss:0.015347091481089592
Iteration: 1737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468669295310974, gen p mean: 0.0, mean p set: 0.45281848311424255
The modified gen p mean: 0.449390172958374, gen p mean: 0.0, mean p set: 0.4493626356124878
The modified gen p mean: 0.4534894824028015, gen p mean: 0.0, mean p set: 0.452744722366333
loss_pred:0.028836211189627647, decouple_loss:0.015396895818412304
loss_pred:0.02846384420990944, decouple_loss:0.015260717831552029
loss_pred:0.028444139286875725, decouple_loss:0.015265369787812233
Iteration: 1738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45298275351524353, gen p mean: 0.0, mean p set: 0.4498138427734375
The modified gen p mean: 0.45543596148490906, gen p mean: 0.0, mean p set: 0.45288676023483276
The modified gen p mean: 0.4534865617752075, gen p mean: 0.0, mean p set: 0.4503243863582611
loss_pred:0.027812665328383446, decouple_loss:0.0144349355250597
loss_pred:0.029979636892676353, decouple_loss:0.015000238083302975
loss_pred:0.028532009571790695, decouple_loss:0.014775257557630539
Iteration: 1739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45655760169029236, gen p mean: 0.0, mean p set: 0.45171716809272766
The modified gen p mean: 0.45366013050079346, gen p mean: 0.0, mean p set: 0.4521923363208771
The modified gen p mean: 0.4532702565193176, gen p mean: 0.0, mean p set: 0.4513484537601471
loss_pred:0.030306532979011536, decouple_loss:0.014954897575080395
loss_pred:0.029349828138947487, decouple_loss:0.014613979496061802
loss_pred:0.028835486620664597, decouple_loss:0.014348399825394154
Iteration: 1740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45236366987228394, gen p mean: 0.0, mean p set: 0.4522422254085541
The modified gen p mean: 0.45411714911460876, gen p mean: 0.0, mean p set: 0.4521242678165436
The modified gen p mean: 0.44979849457740784, gen p mean: 0.0, mean p set: 0.4492310881614685
loss_pred:0.028626414015889168, decouple_loss:0.014371408149600029
loss_pred:0.030357038602232933, decouple_loss:0.014407753013074398
loss_pred:0.029670177027583122, decouple_loss:0.014579261653125286
2023-05-03 02:02:45 testing...
The modified gen p mean: 0.43566790223121643, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44208765029907227, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4455939829349518, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.030505703762173653, decouple_loss:0.016370823606848717
loss_pred:0.0292569100856781, decouple_loss:0.01618015207350254
loss_pred:0.02883830852806568, decouple_loss:0.016264641657471657
WV_0_PC_0_EH_0_PS_40_6, loss: 0.03034723550081253, avg_mse: 0.03478704392910004
current test mse: 0.034787
Iteration: 1741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44481852650642395, gen p mean: 0.0, mean p set: 0.4506973326206207
loss_pred:0.028790278360247612, decouple_loss:0.01517636701464653
The modified gen p mean: 0.43998590111732483, gen p mean: 0.0, mean p set: 0.45270055532455444
loss_pred:0.029139993712306023, decouple_loss:0.015335253439843655
The modified gen p mean: 0.44061049818992615, gen p mean: 0.0, mean p set: 0.4503864049911499
loss_pred:0.03125286102294922, decouple_loss:0.01519328635185957
Iteration: 1742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4554063379764557, gen p mean: 0.0, mean p set: 0.44997072219848633
The modified gen p mean: 0.4579544961452484, gen p mean: 0.0, mean p set: 0.4527881443500519
The modified gen p mean: 0.4551505148410797, gen p mean: 0.0, mean p set: 0.4521697759628296
loss_pred:0.030082982033491135, decouple_loss:0.015004766173660755
loss_pred:0.02970103733241558, decouple_loss:0.014423070475459099
loss_pred:0.028676724061369896, decouple_loss:0.01422320306301117
Iteration: 1743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46216821670532227, gen p mean: 0.0, mean p set: 0.45195919275283813
The modified gen p mean: 0.46142542362213135, gen p mean: 0.0, mean p set: 0.4509148597717285
The modified gen p mean: 0.45725202560424805, gen p mean: 0.0, mean p set: 0.4525114893913269
loss_pred:0.029123082756996155, decouple_loss:0.014542588964104652
loss_pred:0.028250059112906456, decouple_loss:0.014144760556519032
loss_pred:0.029514523223042488, decouple_loss:0.014636313542723656
Iteration: 1744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44662341475486755, gen p mean: 0.0, mean p set: 0.4527750313282013
The modified gen p mean: 0.4467414319515228, gen p mean: 0.0, mean p set: 0.4525245130062103
The modified gen p mean: 0.44363176822662354, gen p mean: 0.0, mean p set: 0.4494730830192566
loss_pred:0.028652990236878395, decouple_loss:0.014737781137228012
loss_pred:0.028226815164089203, decouple_loss:0.014546224847435951
loss_pred:0.029299389570951462, decouple_loss:0.014818942174315453
Iteration: 1745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44365182518959045, gen p mean: 0.0, mean p set: 0.4519013464450836
The modified gen p mean: 0.44594165682792664, gen p mean: 0.0, mean p set: 0.45275044441223145
The modified gen p mean: 0.4509879946708679, gen p mean: 0.0, mean p set: 0.45274588465690613
loss_pred:0.02885330654680729, decouple_loss:0.014168156310915947
loss_pred:0.028956487774848938, decouple_loss:0.01471313089132309
loss_pred:0.027938444167375565, decouple_loss:0.014505165629088879
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
NaN value num: 0
Iteration: 1746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490959942340851, gen p mean: 0.0, mean p set: 0.45195385813713074
The modified gen p mean: 0.45067527890205383, gen p mean: 0.0, mean p set: 0.45301321148872375
The modified gen p mean: 0.4492550790309906, gen p mean: 0.0, mean p set: 0.4515700936317444
loss_pred:0.02958964742720127, decouple_loss:0.016548361629247665
loss_pred:0.030289024114608765, decouple_loss:0.01607528328895569
loss_pred:0.028523001819849014, decouple_loss:0.0165704432874918
Iteration: 1747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4546568989753723, gen p mean: 0.0, mean p set: 0.4512908160686493
The modified gen p mean: 0.45797234773635864, gen p mean: 0.0, mean p set: 0.4514661431312561
The modified gen p mean: 0.45101287961006165, gen p mean: 0.0, mean p set: 0.4516153931617737
loss_pred:0.028344159945845604, decouple_loss:0.01598149910569191
loss_pred:0.029064331203699112, decouple_loss:0.016694102436304092
loss_pred:0.029654769226908684, decouple_loss:0.016852207481861115
Iteration: 1748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511033594608307, gen p mean: 0.0, mean p set: 0.4516604542732239
The modified gen p mean: 0.44865092635154724, gen p mean: 0.0, mean p set: 0.4520820379257202
The modified gen p mean: 0.4491964876651764, gen p mean: 0.0, mean p set: 0.45377078652381897
loss_pred:0.02860698290169239, decouple_loss:0.014944948256015778
loss_pred:0.029420189559459686, decouple_loss:0.015361017547547817
loss_pred:0.028562361374497414, decouple_loss:0.015175910666584969
Iteration: 1749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4578559100627899, gen p mean: 0.0, mean p set: 0.4522160291671753
The modified gen p mean: 0.4588102698326111, gen p mean: 0.0, mean p set: 0.4542403817176819
The modified gen p mean: 0.4566437900066376, gen p mean: 0.0, mean p set: 0.4538784623146057
loss_pred:0.028325287625193596, decouple_loss:0.015657171607017517
loss_pred:0.029072826728224754, decouple_loss:0.015542368404567242
loss_pred:0.028294337913393974, decouple_loss:0.014985364861786366
Iteration: 1750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45412677526474, gen p mean: 0.0, mean p set: 0.45350101590156555
The modified gen p mean: 0.450935423374176, gen p mean: 0.0, mean p set: 0.4521671235561371
The modified gen p mean: 0.4537801444530487, gen p mean: 0.0, mean p set: 0.4523128271102905
loss_pred:0.029285380616784096, decouple_loss:0.014901473186910152
loss_pred:0.028578897938132286, decouple_loss:0.016042020171880722
loss_pred:0.029316755011677742, decouple_loss:0.01578189618885517
2023-05-03 02:07:04 testing...
The modified gen p mean: 0.4434976577758789, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4535938799381256, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4499507248401642, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.030186302959918976, decouple_loss:0.017971975728869438
loss_pred:0.028646579012274742, decouple_loss:0.017923986539244652
loss_pred:0.029109979048371315, decouple_loss:0.017521029338240623
WV_0_PC_0_EH_0_PS_40_6, loss: 0.030204569920897484, avg_mse: 0.0344228520989418
current test mse: 0.034423
Iteration: 1751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45043283700942993, gen p mean: 0.0, mean p set: 0.4521442651748657
The modified gen p mean: 0.4413115084171295, gen p mean: 0.0, mean p set: 0.45130833983421326
loss_pred:0.028770290315151215, decouple_loss:0.016130829229950905
loss_pred:0.029111724346876144, decouple_loss:0.01613163761794567
The modified gen p mean: 0.4438721239566803, gen p mean: 0.0, mean p set: 0.4520816504955292
loss_pred:0.02939661592245102, decouple_loss:0.015782933682203293
Iteration: 1752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488392472267151, gen p mean: 0.0, mean p set: 0.4519789516925812
The modified gen p mean: 0.44650447368621826, gen p mean: 0.0, mean p set: 0.45217666029930115
The modified gen p mean: 0.45155417919158936, gen p mean: 0.0, mean p set: 0.4524403214454651
loss_pred:0.02947346866130829, decouple_loss:0.015349164605140686
loss_pred:0.028225691989064217, decouple_loss:0.016411995515227318
loss_pred:0.028594862669706345, decouple_loss:0.014642258174717426
Iteration: 1753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4682566523551941, gen p mean: 0.0, mean p set: 0.4500984251499176
The modified gen p mean: 0.4582325518131256, gen p mean: 0.0, mean p set: 0.4519124925136566
The modified gen p mean: 0.45877590775489807, gen p mean: 0.0, mean p set: 0.4510558545589447
loss_pred:0.028492474928498268, decouple_loss:0.016747599467635155
loss_pred:0.030063316226005554, decouple_loss:0.016224492341279984
loss_pred:0.029531804844737053, decouple_loss:0.016168812289834023
Iteration: 1754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44581323862075806, gen p mean: 0.0, mean p set: 0.45170560479164124
The modified gen p mean: 0.4434894323348999, gen p mean: 0.0, mean p set: 0.4525096118450165
The modified gen p mean: 0.44559013843536377, gen p mean: 0.0, mean p set: 0.4522245526313782
loss_pred:0.028357019647955894, decouple_loss:0.016116946935653687
loss_pred:0.0285478588193655, decouple_loss:0.016224468126893044
loss_pred:0.02787056565284729, decouple_loss:0.016069654375314713
Iteration: 1755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45283690094947815, gen p mean: 0.0, mean p set: 0.44945603609085083
The modified gen p mean: 0.4463628828525543, gen p mean: 0.0, mean p set: 0.45318397879600525
The modified gen p mean: 0.4471427798271179, gen p mean: 0.0, mean p set: 0.4530283212661743
loss_pred:0.027584990486502647, decouple_loss:0.016079818829894066
loss_pred:0.02873961068689823, decouple_loss:0.014419307000935078
loss_pred:0.028853969648480415, decouple_loss:0.015668140724301338
Iteration: 1756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497968256473541, gen p mean: 0.0, mean p set: 0.4525170624256134
The modified gen p mean: 0.4579344093799591, gen p mean: 0.0, mean p set: 0.451017826795578
The modified gen p mean: 0.45698896050453186, gen p mean: 0.0, mean p set: 0.4506395757198334
loss_pred:0.028676271438598633, decouple_loss:0.01488626841455698
loss_pred:0.028083544224500656, decouple_loss:0.015558348968625069
loss_pred:0.02900882065296173, decouple_loss:0.01548711210489273
Iteration: 1757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514407515525818, gen p mean: 0.0, mean p set: 0.4523266553878784
The modified gen p mean: 0.44773757457733154, gen p mean: 0.0, mean p set: 0.4518510699272156
The modified gen p mean: 0.4595412313938141, gen p mean: 0.0, mean p set: 0.4506586492061615
loss_pred:0.02918674796819687, decouple_loss:0.015298641286790371
loss_pred:0.02908564917743206, decouple_loss:0.015503257513046265
loss_pred:0.02844466269016266, decouple_loss:0.01531496737152338
Iteration: 1758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489637315273285, gen p mean: 0.0, mean p set: 0.4512523412704468
The modified gen p mean: 0.4425468146800995, gen p mean: 0.0, mean p set: 0.4544433653354645
The modified gen p mean: 0.44613805413246155, gen p mean: 0.0, mean p set: 0.4517892897129059
loss_pred:0.02974126674234867, decouple_loss:0.015175818465650082loss_pred:0.029126746580004692, decouple_loss:0.015229648910462856
loss_pred:0.02812056988477707, decouple_loss:0.01484624668955803
Iteration: 1759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450190931558609, gen p mean: 0.0, mean p set: 0.4519975483417511
The modified gen p mean: 0.44744744896888733, gen p mean: 0.0, mean p set: 0.4532662332057953
The modified gen p mean: 0.44989457726478577, gen p mean: 0.0, mean p set: 0.45046815276145935
loss_pred:0.028361450880765915, decouple_loss:0.015079974196851254
loss_pred:0.028440818190574646, decouple_loss:0.014911448583006859
loss_pred:0.0279331523925066, decouple_loss:0.015148159116506577
Iteration: 1760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4557233452796936, gen p mean: 0.0, mean p set: 0.452386736869812
The modified gen p mean: 0.45647549629211426, gen p mean: 0.0, mean p set: 0.45088884234428406
The modified gen p mean: 0.462322473526001, gen p mean: 0.0, mean p set: 0.4501498341560364
loss_pred:0.029646985232830048, decouple_loss:0.015022524632513523
loss_pred:0.03015381656587124, decouple_loss:0.015447244048118591
loss_pred:0.028538864105939865, decouple_loss:0.014459563419222832
2023-05-03 02:10:44 testing...
The modified gen p mean: 0.4464074969291687, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4530893862247467, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4567718803882599, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.0303055290132761, decouple_loss:0.0173354335129261
loss_pred:0.029258543625473976, decouple_loss:0.01689823903143406
loss_pred:0.02885523997247219, decouple_loss:0.017145195975899696
WV_0_PC_0_EH_0_PS_40_6, loss: 0.030329421162605286, avg_mse: 0.03474033251404762
current test mse: 0.03474
Iteration: 1761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45742473006248474, gen p mean: 0.0, mean p set: 0.4494180977344513
loss_pred:0.02744438871741295, decouple_loss:0.014971159398555756
The modified gen p mean: 0.4491443634033203, gen p mean: 0.0, mean p set: 0.45047152042388916
loss_pred:0.02769007347524166, decouple_loss:0.014549437910318375
The modified gen p mean: 0.4498506188392639, gen p mean: 0.0, mean p set: 0.4530230164527893
loss_pred:0.028652023524045944, decouple_loss:0.014795923605561256
Iteration: 1762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4354609251022339, gen p mean: 0.0, mean p set: 0.452349454164505
The modified gen p mean: 0.43665164709091187, gen p mean: 0.0, mean p set: 0.4517205059528351
The modified gen p mean: 0.4412776827812195, gen p mean: 0.0, mean p set: 0.45143604278564453
loss_pred:0.028454741463065147, decouple_loss:0.015663595870137215
loss_pred:0.02975459210574627, decouple_loss:0.01588955894112587
loss_pred:0.028411807492375374, decouple_loss:0.015183018520474434
Iteration: 1763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46498987078666687, gen p mean: 0.0, mean p set: 0.4510838985443115
The modified gen p mean: 0.45909541845321655, gen p mean: 0.0, mean p set: 0.45172688364982605
The modified gen p mean: 0.4612480401992798, gen p mean: 0.0, mean p set: 0.4525661766529083
loss_pred:0.02953488379716873, decouple_loss:0.014970151707530022
loss_pred:0.030408749356865883, decouple_loss:0.01562841795384884
loss_pred:0.02883528172969818, decouple_loss:0.014870107173919678
Iteration: 1764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703081250190735, gen p mean: 0.0, mean p set: 0.4518203139305115
The modified gen p mean: 0.44416356086730957, gen p mean: 0.0, mean p set: 0.45227286219596863
The modified gen p mean: 0.4442741274833679, gen p mean: 0.0, mean p set: 0.4523616135120392
loss_pred:0.029846930876374245, decouple_loss:0.015093980357050896
loss_pred:0.028509892523288727, decouple_loss:0.014770174399018288
loss_pred:0.029174204915761948, decouple_loss:0.015027409419417381
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 1765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010730624198914, gen p mean: 0.0, mean p set: 0.4487411379814148
The modified gen p mean: 0.455206960439682, gen p mean: 0.0, mean p set: 0.44879457354545593
The modified gen p mean: 0.45769837498664856, gen p mean: 0.0, mean p set: 0.4482579529285431
loss_pred:0.0289031732827425, decouple_loss:0.016299042850732803loss_pred:0.028866125270724297, decouple_loss:0.016130290925502777
loss_pred:0.027712903916835785, decouple_loss:0.01746491901576519
Iteration: 1766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106229186058044, gen p mean: 0.0, mean p set: 0.4495646357536316
The modified gen p mean: 0.45630499720573425, gen p mean: 0.0, mean p set: 0.4485826790332794
The modified gen p mean: 0.45324447751045227, gen p mean: 0.0, mean p set: 0.4490965008735657
loss_pred:0.028774859383702278, decouple_loss:0.016910482197999954
loss_pred:0.028747549280524254, decouple_loss:0.01634056121110916
loss_pred:0.029152125120162964, decouple_loss:0.016175320371985435
Iteration: 1767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44370827078819275, gen p mean: 0.0, mean p set: 0.44796544313430786
The modified gen p mean: 0.4502560794353485, gen p mean: 0.0, mean p set: 0.44780102372169495
The modified gen p mean: 0.4502915143966675, gen p mean: 0.0, mean p set: 0.4488862454891205
loss_pred:0.02928631380200386, decouple_loss:0.01611913926899433
loss_pred:0.029614346101880074, decouple_loss:0.01660086214542389
loss_pred:0.02981136552989483, decouple_loss:0.016044994816184044
Iteration: 1768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4361041486263275, gen p mean: 0.0, mean p set: 0.4481477439403534
The modified gen p mean: 0.4371899664402008, gen p mean: 0.0, mean p set: 0.44844454526901245
The modified gen p mean: 0.43779364228248596, gen p mean: 0.0, mean p set: 0.4480714499950409
loss_pred:0.029901836067438126, decouple_loss:0.015259302221238613
loss_pred:0.02842211350798607, decouple_loss:0.015287462621927261
loss_pred:0.02761775627732277, decouple_loss:0.015251881442964077
Iteration: 1769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471164345741272, gen p mean: 0.0, mean p set: 0.4485265016555786
The modified gen p mean: 0.4506362974643707, gen p mean: 0.0, mean p set: 0.449319064617157
The modified gen p mean: 0.44576549530029297, gen p mean: 0.0, mean p set: 0.4487343728542328
loss_pred:0.027682242915034294, decouple_loss:0.015155994333326817
loss_pred:0.029161009937524796, decouple_loss:0.014868533238768578
loss_pred:0.02986086532473564, decouple_loss:0.015387602150440216
Iteration: 1770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45981812477111816, gen p mean: 0.0, mean p set: 0.4492718279361725
The modified gen p mean: 0.45827025175094604, gen p mean: 0.0, mean p set: 0.44971415400505066
The modified gen p mean: 0.4644951820373535, gen p mean: 0.0, mean p set: 0.44883567094802856
loss_pred:0.029097633436322212, decouple_loss:0.01551370695233345loss_pred:0.028775392100214958, decouple_loss:0.015381949953734875
loss_pred:0.029513603076338768, decouple_loss:0.014922535978257656
2023-05-03 02:15:01 testing...
The modified gen p mean: 0.44078895449638367, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44417744874954224, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4344165623188019, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.02896329201757908, decouple_loss:0.015554592944681644
loss_pred:0.02848193794488907, decouple_loss:0.015670934692025185
loss_pred:0.029996827244758606, decouple_loss:0.01600114442408085
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029934464022517204, avg_mse: 0.03419055417180061
current test mse: 0.034191
Iteration: 1771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.434312105178833, gen p mean: 0.0, mean p set: 0.44775673747062683
The modified gen p mean: 0.4432286024093628, gen p mean: 0.0, mean p set: 0.4492274820804596
loss_pred:0.028186263516545296, decouple_loss:0.015905937179923058
loss_pred:0.028775395825505257, decouple_loss:0.016232801601290703
The modified gen p mean: 0.4415050148963928, gen p mean: 0.0, mean p set: 0.44663533568382263
loss_pred:0.028319640085101128, decouple_loss:0.01635058969259262
Iteration: 1772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447483092546463, gen p mean: 0.0, mean p set: 0.44885557889938354
The modified gen p mean: 0.4385182857513428, gen p mean: 0.0, mean p set: 0.4472724497318268
The modified gen p mean: 0.44486546516418457, gen p mean: 0.0, mean p set: 0.44988885521888733
loss_pred:0.0281794723123312, decouple_loss:0.015455126762390137
loss_pred:0.028673185035586357, decouple_loss:0.01536564715206623
loss_pred:0.029151324182748795, decouple_loss:0.015390257351100445
Iteration: 1773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46685704588890076, gen p mean: 0.0, mean p set: 0.44830387830734253
The modified gen p mean: 0.4630439281463623, gen p mean: 0.0, mean p set: 0.4501021206378937
The modified gen p mean: 0.46323198080062866, gen p mean: 0.0, mean p set: 0.4483499228954315
loss_pred:0.029839269816875458, decouple_loss:0.015381711535155773
loss_pred:0.02843872644007206, decouple_loss:0.01535848155617714
loss_pred:0.027748016640543938, decouple_loss:0.015109511092305183
Iteration: 1774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464626908302307, gen p mean: 0.0, mean p set: 0.4513660967350006
The modified gen p mean: 0.4469340741634369, gen p mean: 0.0, mean p set: 0.44876742362976074
The modified gen p mean: 0.4460994601249695, gen p mean: 0.0, mean p set: 0.44804564118385315
loss_pred:0.02887181006371975, decouple_loss:0.014637733809649944
loss_pred:0.028611255809664726, decouple_loss:0.014693629927933216
loss_pred:0.02834138087928295, decouple_loss:0.01488297339528799
Iteration: 1775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42760688066482544, gen p mean: 0.0, mean p set: 0.4486563205718994
The modified gen p mean: 0.4297904074192047, gen p mean: 0.0, mean p set: 0.446990966796875
The modified gen p mean: 0.4307177662849426, gen p mean: 0.0, mean p set: 0.44696733355522156
loss_pred:0.028403257951140404, decouple_loss:0.0143873430788517
loss_pred:0.028397992253303528, decouple_loss:0.015015501528978348
loss_pred:0.027733059599995613, decouple_loss:0.014586752280592918
Iteration: 1776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507814645767212, gen p mean: 0.0, mean p set: 0.44895556569099426
The modified gen p mean: 0.45269444584846497, gen p mean: 0.0, mean p set: 0.4491168260574341
The modified gen p mean: 0.45308175683021545, gen p mean: 0.0, mean p set: 0.4482734203338623
loss_pred:0.02914329431951046, decouple_loss:0.01448032446205616loss_pred:0.029339799657464027, decouple_loss:0.01474948599934578
loss_pred:0.027735859155654907, decouple_loss:0.014004233293235302
Iteration: 1777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46387460827827454, gen p mean: 0.0, mean p set: 0.44866693019866943
The modified gen p mean: 0.46369707584381104, gen p mean: 0.0, mean p set: 0.4482307732105255
The modified gen p mean: 0.46367523074150085, gen p mean: 0.0, mean p set: 0.45066288113594055
loss_pred:0.02832859382033348, decouple_loss:0.014722447842359543
loss_pred:0.027721639722585678, decouple_loss:0.014383861795067787
loss_pred:0.028695520013570786, decouple_loss:0.014122385531663895
Iteration: 1778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532875716686249, gen p mean: 0.0, mean p set: 0.44854292273521423
The modified gen p mean: 0.4478187561035156, gen p mean: 0.0, mean p set: 0.4478631317615509
The modified gen p mean: 0.4542224109172821, gen p mean: 0.0, mean p set: 0.44913890957832336
loss_pred:0.02813667431473732, decouple_loss:0.014451340772211552
loss_pred:0.028097759932279587, decouple_loss:0.013865922577679157
loss_pred:0.02801329642534256, decouple_loss:0.015207621268928051
Iteration: 1779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456183612346649, gen p mean: 0.0, mean p set: 0.44919851422309875
The modified gen p mean: 0.44322171807289124, gen p mean: 0.0, mean p set: 0.450685054063797
The modified gen p mean: 0.4460277259349823, gen p mean: 0.0, mean p set: 0.4488143026828766
loss_pred:0.028883300721645355, decouple_loss:0.014824839308857918
loss_pred:0.028779709711670876, decouple_loss:0.014073655940592289
loss_pred:0.028086718171834946, decouple_loss:0.013998196460306644
Iteration: 1780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4411865174770355, gen p mean: 0.0, mean p set: 0.4480225145816803
The modified gen p mean: 0.43508318066596985, gen p mean: 0.0, mean p set: 0.4488264322280884
The modified gen p mean: 0.4392695426940918, gen p mean: 0.0, mean p set: 0.4485855996608734
loss_pred:0.02894907258450985, decouple_loss:0.014579561538994312
loss_pred:0.028248660266399384, decouple_loss:0.013976152054965496
loss_pred:0.028842300176620483, decouple_loss:0.014368182048201561
2023-05-03 02:18:45 testing...
The modified gen p mean: 0.44251909852027893, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.43628010153770447, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44581910967826843, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028827423229813576, decouple_loss:0.01477359700948
loss_pred:0.029773768037557602, decouple_loss:0.01514025591313839
loss_pred:0.02836769074201584, decouple_loss:0.014691494405269623
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029733050614595413, avg_mse: 0.03388941287994385
current test mse: 0.033889
Iteration: 1781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478122591972351, gen p mean: 0.0, mean p set: 0.4492424428462982
The modified gen p mean: 0.43852731585502625, gen p mean: 0.0, mean p set: 0.44755133986473083
loss_pred:0.02816157415509224, decouple_loss:0.014273349195718765
loss_pred:0.02756591886281967, decouple_loss:0.014607195742428303
The modified gen p mean: 0.44533246755599976, gen p mean: 0.0, mean p set: 0.44920095801353455
loss_pred:0.028542667627334595, decouple_loss:0.014164327643811703
Iteration: 1782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526998996734619, gen p mean: 0.0, mean p set: 0.448408842086792
The modified gen p mean: 0.456632524728775, gen p mean: 0.0, mean p set: 0.4468747675418854
The modified gen p mean: 0.4537477493286133, gen p mean: 0.0, mean p set: 0.44836726784706116
loss_pred:0.028820935636758804, decouple_loss:0.014403335750102997
loss_pred:0.028665171936154366, decouple_loss:0.014772471971809864
loss_pred:0.027338795363903046, decouple_loss:0.014257753267884254
Iteration: 1783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4588259160518646, gen p mean: 0.0, mean p set: 0.44809263944625854
The modified gen p mean: 0.459871381521225, gen p mean: 0.0, mean p set: 0.4492388665676117
The modified gen p mean: 0.45531365275382996, gen p mean: 0.0, mean p set: 0.4487667679786682
loss_pred:0.0284564271569252, decouple_loss:0.01412883959710598
loss_pred:0.027537750080227852, decouple_loss:0.013915621675550938
loss_pred:0.02804618887603283, decouple_loss:0.01361610647290945
Iteration: 1784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44778674840927124, gen p mean: 0.0, mean p set: 0.44704070687294006
The modified gen p mean: 0.4481806755065918, gen p mean: 0.0, mean p set: 0.44898515939712524
The modified gen p mean: 0.4515446722507477, gen p mean: 0.0, mean p set: 0.44983553886413574
loss_pred:0.027627428993582726, decouple_loss:0.015002062544226646
loss_pred:0.027836311608552933, decouple_loss:0.014373763464391232
loss_pred:0.028304221108555794, decouple_loss:0.014652607031166553
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
NaN value num: 0
Iteration: 1785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44102707505226135, gen p mean: 0.0, mean p set: 0.45125120878219604
The modified gen p mean: 0.43811944127082825, gen p mean: 0.0, mean p set: 0.4501340985298157
The modified gen p mean: 0.4423525929450989, gen p mean: 0.0, mean p set: 0.4509201943874359
loss_pred:0.029048193246126175, decouple_loss:0.016210755333304405
loss_pred:0.028863409534096718, decouple_loss:0.016132071614265442
loss_pred:0.028615202754735947, decouple_loss:0.016329502686858177
Iteration: 1786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4553770422935486, gen p mean: 0.0, mean p set: 0.4507034122943878
The modified gen p mean: 0.4530065953731537, gen p mean: 0.0, mean p set: 0.45187634229660034
The modified gen p mean: 0.45585447549819946, gen p mean: 0.0, mean p set: 0.4508971571922302
loss_pred:0.028400154784321785, decouple_loss:0.015474778600037098
loss_pred:0.028270842507481575, decouple_loss:0.01570206880569458
loss_pred:0.02814307250082493, decouple_loss:0.015522646717727184
Iteration: 1787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45432043075561523, gen p mean: 0.0, mean p set: 0.4511701166629791
The modified gen p mean: 0.453977108001709, gen p mean: 0.0, mean p set: 0.4510606527328491
The modified gen p mean: 0.4560762941837311, gen p mean: 0.0, mean p set: 0.4507932960987091
loss_pred:0.02782898023724556, decouple_loss:0.01486882008612156
loss_pred:0.028274601325392723, decouple_loss:0.014829112216830254
loss_pred:0.027493871748447418, decouple_loss:0.014469738118350506
Iteration: 1788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460487365722656, gen p mean: 0.0, mean p set: 0.4531055688858032
The modified gen p mean: 0.44877558946609497, gen p mean: 0.0, mean p set: 0.449937105178833
The modified gen p mean: 0.44496846199035645, gen p mean: 0.0, mean p set: 0.4509181082248688
loss_pred:0.02889607660472393, decouple_loss:0.015511063858866692
loss_pred:0.02742791548371315, decouple_loss:0.015050065703690052
loss_pred:0.028442902490496635, decouple_loss:0.014698680490255356
Iteration: 1789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514792859554291, gen p mean: 0.0, mean p set: 0.45207569003105164
The modified gen p mean: 0.4488210082054138, gen p mean: 0.0, mean p set: 0.4513859152793884
The modified gen p mean: 0.4491639733314514, gen p mean: 0.0, mean p set: 0.45191025733947754
loss_pred:0.027984460815787315, decouple_loss:0.01423500757664442
loss_pred:0.02906280942261219, decouple_loss:0.014336934313178062
loss_pred:0.02778010442852974, decouple_loss:0.014792528003454208
Iteration: 1790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536050856113434, gen p mean: 0.0, mean p set: 0.45067504048347473
The modified gen p mean: 0.45370444655418396, gen p mean: 0.0, mean p set: 0.4537335932254791
The modified gen p mean: 0.4560154974460602, gen p mean: 0.0, mean p set: 0.45072323083877563
loss_pred:0.027709849178791046, decouple_loss:0.014188441447913647
loss_pred:0.028535403311252594, decouple_loss:0.015272259712219238
loss_pred:0.027301352471113205, decouple_loss:0.014694113284349442
2023-05-03 02:23:05 testing...
The modified gen p mean: 0.44915899634361267, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44250544905662537, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45253685116767883, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02893637679517269, decouple_loss:0.016479190438985825
loss_pred:0.030021080747246742, decouple_loss:0.016929859295487404
loss_pred:0.02850445732474327, decouple_loss:0.01664409600198269
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02998819202184677, avg_mse: 0.034278418868780136
current test mse: 0.034278
Iteration: 1791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966888427734375, gen p mean: 0.0, mean p set: 0.4502705931663513
The modified gen p mean: 0.4491170048713684, gen p mean: 0.0, mean p set: 0.44963446259498596
loss_pred:0.027496855705976486, decouple_loss:0.013953514397144318
loss_pred:0.028066208586096764, decouple_loss:0.014759090729057789
The modified gen p mean: 0.4520396292209625, gen p mean: 0.0, mean p set: 0.45309871435165405
loss_pred:0.02842307835817337, decouple_loss:0.014927021227777004
Iteration: 1792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519940912723541, gen p mean: 0.0, mean p set: 0.45110225677490234
The modified gen p mean: 0.4517745077610016, gen p mean: 0.0, mean p set: 0.4498852789402008
The modified gen p mean: 0.45080310106277466, gen p mean: 0.0, mean p set: 0.4522497057914734
loss_pred:0.02747681550681591, decouple_loss:0.014703127555549145
loss_pred:0.029423842206597328, decouple_loss:0.014683851040899754
loss_pred:0.028749721124768257, decouple_loss:0.01507482398301363
Iteration: 1793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478245675563812, gen p mean: 0.0, mean p set: 0.4505070447921753
The modified gen p mean: 0.4398168921470642, gen p mean: 0.0, mean p set: 0.45055902004241943
The modified gen p mean: 0.44400492310523987, gen p mean: 0.0, mean p set: 0.4537356197834015
loss_pred:0.02987672947347164, decouple_loss:0.014867957681417465
loss_pred:0.029101265594363213, decouple_loss:0.01472825463861227
loss_pred:0.028268568217754364, decouple_loss:0.015134699642658234
Iteration: 1794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4546144902706146, gen p mean: 0.0, mean p set: 0.44983193278312683
The modified gen p mean: 0.455156147480011, gen p mean: 0.0, mean p set: 0.45008277893066406
The modified gen p mean: 0.4496196210384369, gen p mean: 0.0, mean p set: 0.44968703389167786
loss_pred:0.029431872069835663, decouple_loss:0.014301922172307968
loss_pred:0.02842864580452442, decouple_loss:0.01435817126184702
loss_pred:0.028353935107588768, decouple_loss:0.01422427874058485
Iteration: 1795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45387083292007446, gen p mean: 0.0, mean p set: 0.4524039626121521
The modified gen p mean: 0.4577118754386902, gen p mean: 0.0, mean p set: 0.4510236978530884
The modified gen p mean: 0.4527193009853363, gen p mean: 0.0, mean p set: 0.4525485932826996
loss_pred:0.027640124782919884, decouple_loss:0.013908746652305126
loss_pred:0.027883777394890785, decouple_loss:0.01433628425002098
loss_pred:0.028545312583446503, decouple_loss:0.014197899028658867
Iteration: 1796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455758333206177, gen p mean: 0.0, mean p set: 0.45340150594711304
The modified gen p mean: 0.44217684864997864, gen p mean: 0.0, mean p set: 0.4530709385871887
The modified gen p mean: 0.44535914063453674, gen p mean: 0.0, mean p set: 0.4496982991695404
loss_pred:0.02812393195927143, decouple_loss:0.014394008554518223
loss_pred:0.028050679713487625, decouple_loss:0.014404674991965294
loss_pred:0.02747405879199505, decouple_loss:0.013943583704531193
Iteration: 1797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454845666885376, gen p mean: 0.0, mean p set: 0.4504829943180084
The modified gen p mean: 0.4517127573490143, gen p mean: 0.0, mean p set: 0.45347464084625244
The modified gen p mean: 0.4553203880786896, gen p mean: 0.0, mean p set: 0.45156341791152954
loss_pred:0.026618292555212975, decouple_loss:0.014145013876259327
loss_pred:0.02803281880915165, decouple_loss:0.014018394984304905
loss_pred:0.027992727234959602, decouple_loss:0.014202337712049484
Iteration: 1798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45498132705688477, gen p mean: 0.0, mean p set: 0.44999685883522034
The modified gen p mean: 0.44833803176879883, gen p mean: 0.0, mean p set: 0.45186319947242737
The modified gen p mean: 0.44788655638694763, gen p mean: 0.0, mean p set: 0.4505563974380493
loss_pred:0.027346983551979065, decouple_loss:0.014185642823576927
loss_pred:0.028722133487462997, decouple_loss:0.014856971800327301
loss_pred:0.02948368899524212, decouple_loss:0.013881001621484756
Iteration: 1799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45292824506759644, gen p mean: 0.0, mean p set: 0.45054012537002563
The modified gen p mean: 0.4495701789855957, gen p mean: 0.0, mean p set: 0.4518035352230072
The modified gen p mean: 0.4500312805175781, gen p mean: 0.0, mean p set: 0.4523652195930481
loss_pred:0.02841685712337494, decouple_loss:0.013867232948541641
loss_pred:0.02834155037999153, decouple_loss:0.013806339353322983
loss_pred:0.02900715172290802, decouple_loss:0.013981989584863186
Iteration: 1800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45672348141670227, gen p mean: 0.0, mean p set: 0.4506555497646332
The modified gen p mean: 0.4584865868091583, gen p mean: 0.0, mean p set: 0.45097947120666504
The modified gen p mean: 0.4593992233276367, gen p mean: 0.0, mean p set: 0.45311927795410156
loss_pred:0.02799924835562706, decouple_loss:0.014201200567185879
loss_pred:0.0282017569988966, decouple_loss:0.013883469626307487
loss_pred:0.028161751106381416, decouple_loss:0.014127416536211967
2023-05-03 02:26:44 testing...
The modified gen p mean: 0.44565871357917786, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45288148522377014, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4564003646373749, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.0299195796251297, decouple_loss:0.016133246943354607
loss_pred:0.028866874054074287, decouple_loss:0.015720834955573082
loss_pred:0.028466511517763138, decouple_loss:0.015864524990320206
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029879633337259293, avg_mse: 0.03431471809744835
current test mse: 0.034315
Iteration: 1801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45278802514076233, gen p mean: 0.0, mean p set: 0.45318400859832764
The modified gen p mean: 0.45328807830810547, gen p mean: 0.0, mean p set: 0.4519140422344208
loss_pred:0.028153717517852783, decouple_loss:0.014206679537892342
loss_pred:0.02867717109620571, decouple_loss:0.013799570500850677
The modified gen p mean: 0.4533369243144989, gen p mean: 0.0, mean p set: 0.4509105384349823
loss_pred:0.02795790135860443, decouple_loss:0.013856465928256512
Iteration: 1802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454357922077179, gen p mean: 0.0, mean p set: 0.4512505531311035
The modified gen p mean: 0.4419402778148651, gen p mean: 0.0, mean p set: 0.450441837310791
The modified gen p mean: 0.44369345903396606, gen p mean: 0.0, mean p set: 0.45068085193634033
loss_pred:0.029273977503180504, decouple_loss:0.014190562069416046
loss_pred:0.028273148462176323, decouple_loss:0.01402340829372406
loss_pred:0.026827633380889893, decouple_loss:0.01446109265089035
Iteration: 1803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462173879146576, gen p mean: 0.0, mean p set: 0.45262065529823303
The modified gen p mean: 0.4507221579551697, gen p mean: 0.0, mean p set: 0.4504503011703491
The modified gen p mean: 0.45032793283462524, gen p mean: 0.0, mean p set: 0.4508511424064636
loss_pred:0.027787763625383377, decouple_loss:0.01362752914428711
loss_pred:0.028679199516773224, decouple_loss:0.013595039024949074
loss_pred:0.027907729148864746, decouple_loss:0.013616952113807201
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
NaN value num: 0
Iteration: 1804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4573279619216919, gen p mean: 0.0, mean p set: 0.45278200507164
The modified gen p mean: 0.45589351654052734, gen p mean: 0.0, mean p set: 0.45166081190109253
The modified gen p mean: 0.45041677355766296, gen p mean: 0.0, mean p set: 0.4507710039615631
loss_pred:0.029001230373978615, decouple_loss:0.014926465228199959
loss_pred:0.029323628172278404, decouple_loss:0.014801905490458012
loss_pred:0.0304057989269495, decouple_loss:0.014814634807407856
Iteration: 1805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501689374446869, gen p mean: 0.0, mean p set: 0.45105281472206116
The modified gen p mean: 0.4425642192363739, gen p mean: 0.0, mean p set: 0.4498913586139679
The modified gen p mean: 0.4441402554512024, gen p mean: 0.0, mean p set: 0.45052260160446167
loss_pred:0.027350792661309242, decouple_loss:0.014833892695605755
loss_pred:0.02788374200463295, decouple_loss:0.015485553070902824
loss_pred:0.028460253030061722, decouple_loss:0.01531270518898964
Iteration: 1806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475497305393219, gen p mean: 0.0, mean p set: 0.4515374004840851
The modified gen p mean: 0.45263800024986267, gen p mean: 0.0, mean p set: 0.45187801122665405
The modified gen p mean: 0.45188483595848083, gen p mean: 0.0, mean p set: 0.4511229395866394
loss_pred:0.030036386102437973, decouple_loss:0.014969534240663052
loss_pred:0.03024917095899582, decouple_loss:0.015007718466222286
loss_pred:0.029435548931360245, decouple_loss:0.014661098830401897
Iteration: 1807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46628138422966003, gen p mean: 0.0, mean p set: 0.451505571603775
The modified gen p mean: 0.4668377935886383, gen p mean: 0.0, mean p set: 0.4520331025123596
The modified gen p mean: 0.4693045914173126, gen p mean: 0.0, mean p set: 0.45088016986846924
loss_pred:0.029757335782051086, decouple_loss:0.014251573011279106
loss_pred:0.030762722715735435, decouple_loss:0.014562562108039856
loss_pred:0.029237378388643265, decouple_loss:0.0141690568998456
Iteration: 1808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4449647068977356, gen p mean: 0.0, mean p set: 0.45222604274749756
The modified gen p mean: 0.4439188539981842, gen p mean: 0.0, mean p set: 0.45158541202545166
The modified gen p mean: 0.44772869348526, gen p mean: 0.0, mean p set: 0.4513946771621704
loss_pred:0.030959950760006905, decouple_loss:0.014824381098151207
loss_pred:0.029906023293733597, decouple_loss:0.014670279808342457
loss_pred:0.028863662853837013, decouple_loss:0.01429329439997673
Iteration: 1809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4403786361217499, gen p mean: 0.0, mean p set: 0.4516793489456177
The modified gen p mean: 0.43724510073661804, gen p mean: 0.0, mean p set: 0.45337486267089844
The modified gen p mean: 0.43225860595703125, gen p mean: 0.0, mean p set: 0.45181164145469666
loss_pred:0.03058769553899765, decouple_loss:0.01528989989310503
loss_pred:0.02864679880440235, decouple_loss:0.015165501274168491
loss_pred:0.031105434522032738, decouple_loss:0.015294471755623817
Iteration: 1810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4614924192428589, gen p mean: 0.0, mean p set: 0.4532400667667389
The modified gen p mean: 0.4670703411102295, gen p mean: 0.0, mean p set: 0.4512137174606323
The modified gen p mean: 0.46160265803337097, gen p mean: 0.0, mean p set: 0.4511098861694336
loss_pred:0.031001485884189606, decouple_loss:0.01485674362629652
loss_pred:0.02764921821653843, decouple_loss:0.014875891618430614
loss_pred:0.03086494468152523, decouple_loss:0.014859368093311787
2023-05-03 02:30:56 testing...
The modified gen p mean: 0.4482223391532898, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45515304803848267, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.458391398191452, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02996571734547615, decouple_loss:0.01652327924966812
loss_pred:0.028815241530537605, decouple_loss:0.01627703569829464
loss_pred:0.028506740927696228, decouple_loss:0.01626698672771454
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02991368994116783, avg_mse: 0.03429121524095535
current test mse: 0.034291
Iteration: 1811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.456708163022995, gen p mean: 0.0, mean p set: 0.4515029489994049
The modified gen p mean: 0.45496973395347595, gen p mean: 0.0, mean p set: 0.4517945945262909
loss_pred:0.027588067576289177, decouple_loss:0.014655932784080505
loss_pred:0.027395717799663544, decouple_loss:0.014796155504882336
The modified gen p mean: 0.4537442624568939, gen p mean: 0.0, mean p set: 0.45076268911361694
loss_pred:0.03050648234784603, decouple_loss:0.014809834770858288
Iteration: 1812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43300381302833557, gen p mean: 0.0, mean p set: 0.45154067873954773
The modified gen p mean: 0.4381450414657593, gen p mean: 0.0, mean p set: 0.4510160982608795
The modified gen p mean: 0.4386006295681, gen p mean: 0.0, mean p set: 0.45338475704193115
loss_pred:0.031310271471738815, decouple_loss:0.01672208309173584
loss_pred:0.030097221955657005, decouple_loss:0.015586242079734802
loss_pred:0.030035249888896942, decouple_loss:0.015419207513332367
Iteration: 1813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4737972617149353, gen p mean: 0.0, mean p set: 0.4528633952140808
The modified gen p mean: 0.4719183146953583, gen p mean: 0.0, mean p set: 0.45258012413978577
The modified gen p mean: 0.46941637992858887, gen p mean: 0.0, mean p set: 0.4508439898490906
loss_pred:0.02890811115503311, decouple_loss:0.015086842700839043
loss_pred:0.02982580102980137, decouple_loss:0.014966930262744427
loss_pred:0.027376580983400345, decouple_loss:0.01495132502168417
Iteration: 1814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45489588379859924, gen p mean: 0.0, mean p set: 0.45288771390914917
The modified gen p mean: 0.4569619297981262, gen p mean: 0.0, mean p set: 0.45181748270988464
The modified gen p mean: 0.450084924697876, gen p mean: 0.0, mean p set: 0.45172742009162903
loss_pred:0.030997848138213158, decouple_loss:0.014849596656858921
loss_pred:0.030202656984329224, decouple_loss:0.015044382773339748
loss_pred:0.030127551406621933, decouple_loss:0.015714503824710846
Iteration: 1815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4333125054836273, gen p mean: 0.0, mean p set: 0.4519181549549103
The modified gen p mean: 0.43553826212882996, gen p mean: 0.0, mean p set: 0.4518622159957886
The modified gen p mean: 0.4314590096473694, gen p mean: 0.0, mean p set: 0.45239561796188354
loss_pred:0.02729249931871891, decouple_loss:0.014455868862569332
loss_pred:0.028836648911237717, decouple_loss:0.01455377321690321
loss_pred:0.028744036331772804, decouple_loss:0.0144071439281106
Iteration: 1816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134732127189636, gen p mean: 0.0, mean p set: 0.4514080286026001
The modified gen p mean: 0.45130160450935364, gen p mean: 0.0, mean p set: 0.4522937834262848
The modified gen p mean: 0.45059528946876526, gen p mean: 0.0, mean p set: 0.45174819231033325
loss_pred:0.03059672936797142, decouple_loss:0.014429707080125809
loss_pred:0.026994479820132256, decouple_loss:0.014452766627073288
loss_pred:0.02987390011548996, decouple_loss:0.01513706985861063
Iteration: 1817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504539370536804, gen p mean: 0.0, mean p set: 0.4513830542564392
The modified gen p mean: 0.4624076783657074, gen p mean: 0.0, mean p set: 0.4512825310230255
The modified gen p mean: 0.4598619341850281, gen p mean: 0.0, mean p set: 0.45108845829963684
loss_pred:0.030110005289316177, decouple_loss:0.014633430168032646
loss_pred:0.028240680694580078, decouple_loss:0.014850703999400139
loss_pred:0.028774147853255272, decouple_loss:0.014528538100421429
Iteration: 1818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4565560817718506, gen p mean: 0.0, mean p set: 0.45203498005867004
The modified gen p mean: 0.4594220519065857, gen p mean: 0.0, mean p set: 0.45164790749549866
The modified gen p mean: 0.45662713050842285, gen p mean: 0.0, mean p set: 0.45141565799713135
loss_pred:0.030095655471086502, decouple_loss:0.014950537122786045
loss_pred:0.02909751422703266, decouple_loss:0.014104034751653671
loss_pred:0.030176537111401558, decouple_loss:0.014633315615355968
Iteration: 1819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832760095596313, gen p mean: 0.0, mean p set: 0.4529227614402771
The modified gen p mean: 0.44866541028022766, gen p mean: 0.0, mean p set: 0.4514998197555542
The modified gen p mean: 0.45141056180000305, gen p mean: 0.0, mean p set: 0.45197105407714844
loss_pred:0.02962169237434864, decouple_loss:0.014562881551682949
loss_pred:0.03091309778392315, decouple_loss:0.01446706335991621
loss_pred:0.02884557656943798, decouple_loss:0.014095223508775234
Iteration: 1820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482795000076294, gen p mean: 0.0, mean p set: 0.45269879698753357
The modified gen p mean: 0.45054277777671814, gen p mean: 0.0, mean p set: 0.4528789222240448
The modified gen p mean: 0.44991958141326904, gen p mean: 0.0, mean p set: 0.4520242512226105
loss_pred:0.028179720044136047, decouple_loss:0.01392513606697321
loss_pred:0.028193365782499313, decouple_loss:0.014029118232429028
loss_pred:0.02802044339478016, decouple_loss:0.014261945150792599
2023-05-03 02:34:35 testing...
The modified gen p mean: 0.4440110921859741, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4374871551990509, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4475046694278717, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02881791815161705, decouple_loss:0.01548340916633606
loss_pred:0.029881972819566727, decouple_loss:0.015936950221657753
loss_pred:0.028460238128900528, decouple_loss:0.015535500831902027
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029835974797606468, avg_mse: 0.034270331263542175
current test mse: 0.03427
Iteration: 1821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44368475675582886, gen p mean: 0.0, mean p set: 0.45108652114868164
The modified gen p mean: 0.44572368264198303, gen p mean: 0.0, mean p set: 0.45145145058631897
loss_pred:0.030809009447693825, decouple_loss:0.014908473938703537
loss_pred:0.02865774743258953, decouple_loss:0.013977043330669403
The modified gen p mean: 0.4395821690559387, gen p mean: 0.0, mean p set: 0.45211273431777954
loss_pred:0.030196906998753548, decouple_loss:0.014809834770858288
Iteration: 1822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531918466091156, gen p mean: 0.0, mean p set: 0.45239734649658203
The modified gen p mean: 0.45101574063301086, gen p mean: 0.0, mean p set: 0.4516860842704773
The modified gen p mean: 0.45410436391830444, gen p mean: 0.0, mean p set: 0.4515528082847595
loss_pred:0.02768801711499691, decouple_loss:0.013976017013192177
loss_pred:0.029116876423358917, decouple_loss:0.014302500523626804
loss_pred:0.03069838508963585, decouple_loss:0.013972749933600426
Iteration: 1823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4642503559589386, gen p mean: 0.0, mean p set: 0.45148617029190063
The modified gen p mean: 0.46194955706596375, gen p mean: 0.0, mean p set: 0.45197397470474243
The modified gen p mean: 0.45881059765815735, gen p mean: 0.0, mean p set: 0.4514060616493225
loss_pred:0.028572168201208115, decouple_loss:0.01378959883004427
loss_pred:0.026308689266443253, decouple_loss:0.013661938719451427
loss_pred:0.030392076820135117, decouple_loss:0.014427397400140762
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
NaN value num: 0
Iteration: 1824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539315104484558, gen p mean: 0.0, mean p set: 0.4486878216266632
The modified gen p mean: 0.451233446598053, gen p mean: 0.0, mean p set: 0.44849133491516113
The modified gen p mean: 0.4496614933013916, gen p mean: 0.0, mean p set: 0.4487301707267761
loss_pred:0.03027205355465412, decouple_loss:0.01538613811135292
loss_pred:0.030611274763941765, decouple_loss:0.01623089797794819
loss_pred:0.030535271391272545, decouple_loss:0.015234365127980709
Iteration: 1825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679442048072815, gen p mean: 0.0, mean p set: 0.4485076069831848
The modified gen p mean: 0.4470267593860626, gen p mean: 0.0, mean p set: 0.44883406162261963
The modified gen p mean: 0.44372841715812683, gen p mean: 0.0, mean p set: 0.44830331206321716
loss_pred:0.03068319894373417, decouple_loss:0.014676504768431187
loss_pred:0.02941509336233139, decouple_loss:0.014476167038083076
loss_pred:0.030550481751561165, decouple_loss:0.0156816728413105
Iteration: 1826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44303303956985474, gen p mean: 0.0, mean p set: 0.4499121904373169
The modified gen p mean: 0.4420660734176636, gen p mean: 0.0, mean p set: 0.4487864673137665
The modified gen p mean: 0.4438130259513855, gen p mean: 0.0, mean p set: 0.4472479820251465
loss_pred:0.029495393857359886, decouple_loss:0.014361226931214333
loss_pred:0.030126703903079033, decouple_loss:0.014744440093636513
loss_pred:0.030535725876688957, decouple_loss:0.014680503867566586
Iteration: 1827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4439709782600403, gen p mean: 0.0, mean p set: 0.44984182715415955
The modified gen p mean: 0.4527150094509125, gen p mean: 0.0, mean p set: 0.448240727186203
The modified gen p mean: 0.44542744755744934, gen p mean: 0.0, mean p set: 0.4482775628566742
loss_pred:0.02930179424583912, decouple_loss:0.014171366579830647
loss_pred:0.02887541428208351, decouple_loss:0.015138693153858185
loss_pred:0.029883764684200287, decouple_loss:0.014052796177566051
Iteration: 1828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506838619709015, gen p mean: 0.0, mean p set: 0.44779375195503235
The modified gen p mean: 0.44497916102409363, gen p mean: 0.0, mean p set: 0.4491157829761505
The modified gen p mean: 0.4527319073677063, gen p mean: 0.0, mean p set: 0.44909751415252686
loss_pred:0.030528239905834198, decouple_loss:0.014002187177538872
loss_pred:0.028415827080607414, decouple_loss:0.015079268254339695
loss_pred:0.029876407235860825, decouple_loss:0.014838536269962788
Iteration: 1829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514716565608978, gen p mean: 0.0, mean p set: 0.44815659523010254
The modified gen p mean: 0.4503328204154968, gen p mean: 0.0, mean p set: 0.4492185115814209
loss_pred:0.030482042580842972, decouple_loss:0.014772861264646053
The modified gen p mean: 0.45323681831359863, gen p mean: 0.0, mean p set: 0.4496051073074341
loss_pred:0.029649389907717705, decouple_loss:0.01481628231704235
loss_pred:0.028463397175073624, decouple_loss:0.01446599792689085
Iteration: 1830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466871917247772, gen p mean: 0.0, mean p set: 0.4500986337661743
The modified gen p mean: 0.4470118582248688, gen p mean: 0.0, mean p set: 0.4478336274623871
The modified gen p mean: 0.4453895092010498, gen p mean: 0.0, mean p set: 0.44850850105285645
loss_pred:0.029261626303195953, decouple_loss:0.014394949190318584
loss_pred:0.030849197879433632, decouple_loss:0.014174633659422398
loss_pred:0.030395260080695152, decouple_loss:0.014536432921886444
2023-05-03 02:38:54 testing...
The modified gen p mean: 0.4515032470226288, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4452989995479584, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45483678579330444, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028653107583522797, decouple_loss:0.014795678667724133
loss_pred:0.02970896102488041, decouple_loss:0.014957024715840816
loss_pred:0.02828017994761467, decouple_loss:0.014945750124752522
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029625725001096725, avg_mse: 0.03402188420295715
current test mse: 0.034022
Iteration: 1831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500978887081146, gen p mean: 0.0, mean p set: 0.44831374287605286
loss_pred:0.02937464788556099, decouple_loss:0.014599118381738663
The modified gen p mean: 0.4526219964027405, gen p mean: 0.0, mean p set: 0.44736447930336
loss_pred:0.03023586980998516, decouple_loss:0.01433177012950182
The modified gen p mean: 0.4498709440231323, gen p mean: 0.0, mean p set: 0.44802385568618774
loss_pred:0.03024609386920929, decouple_loss:0.014878812246024609
Iteration: 1832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138004422187805, gen p mean: 0.0, mean p set: 0.4488562047481537
The modified gen p mean: 0.45224884152412415, gen p mean: 0.0, mean p set: 0.44831764698028564
The modified gen p mean: 0.4480228126049042, gen p mean: 0.0, mean p set: 0.4499753415584564
loss_pred:0.030315309762954712, decouple_loss:0.013733883388340473
loss_pred:0.02992207370698452, decouple_loss:0.014292808249592781
loss_pred:0.028802864253520966, decouple_loss:0.014437749050557613
Iteration: 1833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4407515525817871, gen p mean: 0.0, mean p set: 0.4489891827106476
The modified gen p mean: 0.43779388070106506, gen p mean: 0.0, mean p set: 0.4504074156284332
The modified gen p mean: 0.44317254424095154, gen p mean: 0.0, mean p set: 0.44931817054748535
loss_pred:0.03018472157418728, decouple_loss:0.013732402585446835
loss_pred:0.02880825474858284, decouple_loss:0.014189979992806911
loss_pred:0.02981039695441723, decouple_loss:0.014199897646903992
Iteration: 1834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.444771409034729, gen p mean: 0.0, mean p set: 0.44871172308921814
The modified gen p mean: 0.4456537365913391, gen p mean: 0.0, mean p set: 0.4490949809551239
The modified gen p mean: 0.44556352496147156, gen p mean: 0.0, mean p set: 0.44974657893180847
loss_pred:0.030877472832798958, decouple_loss:0.01327261608093977
loss_pred:0.028295939788222313, decouple_loss:0.014352834783494473
loss_pred:0.030009988695383072, decouple_loss:0.0141553720459342
Iteration: 1835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45611572265625, gen p mean: 0.0, mean p set: 0.4480896592140198
The modified gen p mean: 0.4622180461883545, gen p mean: 0.0, mean p set: 0.44840967655181885
The modified gen p mean: 0.4630289375782013, gen p mean: 0.0, mean p set: 0.44806647300720215
loss_pred:0.03002227284014225, decouple_loss:0.014381958171725273
loss_pred:0.028723234310746193, decouple_loss:0.014942936599254608
loss_pred:0.028419602662324905, decouple_loss:0.015138589777052402
Iteration: 1836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622448086738586, gen p mean: 0.0, mean p set: 0.4483693838119507
The modified gen p mean: 0.45021703839302063, gen p mean: 0.0, mean p set: 0.4488738775253296
The modified gen p mean: 0.4446622431278229, gen p mean: 0.0, mean p set: 0.44868478178977966
loss_pred:0.029581356793642044, decouple_loss:0.013778514228761196
loss_pred:0.028664886951446533, decouple_loss:0.01393428910523653
loss_pred:0.030553432181477547, decouple_loss:0.014251952059566975
Iteration: 1837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43984273076057434, gen p mean: 0.0, mean p set: 0.448641300201416
The modified gen p mean: 0.4424198865890503, gen p mean: 0.0, mean p set: 0.44834303855895996
The modified gen p mean: 0.449404776096344, gen p mean: 0.0, mean p set: 0.4485318660736084
loss_pred:0.028353339061141014, decouple_loss:0.013858773745596409
loss_pred:0.028973106294870377, decouple_loss:0.01392257958650589
loss_pred:0.028689134865999222, decouple_loss:0.013567670248448849
Iteration: 1838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45038342475891113, gen p mean: 0.0, mean p set: 0.4485383629798889
The modified gen p mean: 0.44637906551361084, gen p mean: 0.0, mean p set: 0.4505901634693146
The modified gen p mean: 0.4537922739982605, gen p mean: 0.0, mean p set: 0.44842690229415894
loss_pred:0.028756678104400635, decouple_loss:0.013797338120639324
loss_pred:0.02848890982568264, decouple_loss:0.013860217295587063
loss_pred:0.02846747264266014, decouple_loss:0.013467362150549889
Iteration: 1839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45000141859054565, gen p mean: 0.0, mean p set: 0.4498783349990845
The modified gen p mean: 0.4411163032054901, gen p mean: 0.0, mean p set: 0.4492875933647156
The modified gen p mean: 0.4474484920501709, gen p mean: 0.0, mean p set: 0.44853708148002625
loss_pred:0.02845516987144947, decouple_loss:0.013241482898592949
loss_pred:0.02867908962070942, decouple_loss:0.014024498872458935
loss_pred:0.03051869384944439, decouple_loss:0.013390840031206608
Iteration: 1840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520343542098999, gen p mean: 0.0, mean p set: 0.4482342600822449
The modified gen p mean: 0.4534206986427307, gen p mean: 0.0, mean p set: 0.44851937890052795
The modified gen p mean: 0.4469758868217468, gen p mean: 0.0, mean p set: 0.44892963767051697
loss_pred:0.02964753843843937, decouple_loss:0.01388299185782671loss_pred:0.02992149256169796, decouple_loss:0.01293235644698143
loss_pred:0.03037162311375141, decouple_loss:0.014403088949620724
2023-05-03 02:42:33 testing...
The modified gen p mean: 0.446469247341156, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.455575555562973, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4522041976451874, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02972882054746151, decouple_loss:0.014495563693344593
loss_pred:0.028414206579327583, decouple_loss:0.01434566080570221
loss_pred:0.02868104726076126, decouple_loss:0.014241757802665234
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029659409075975418, avg_mse: 0.034086596220731735
current test mse: 0.034087
Iteration: 1841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45510929822921753, gen p mean: 0.0, mean p set: 0.4490722715854645
The modified gen p mean: 0.4536128342151642, gen p mean: 0.0, mean p set: 0.44839733839035034
loss_pred:0.02920488826930523, decouple_loss:0.01425446942448616
loss_pred:0.029833322390913963, decouple_loss:0.013950730673968792
The modified gen p mean: 0.4517498314380646, gen p mean: 0.0, mean p set: 0.44839203357696533
loss_pred:0.030053099617362022, decouple_loss:0.01332810241729021
Iteration: 1842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4408460557460785, gen p mean: 0.0, mean p set: 0.4486587643623352
The modified gen p mean: 0.4384145438671112, gen p mean: 0.0, mean p set: 0.4495508372783661
The modified gen p mean: 0.437854528427124, gen p mean: 0.0, mean p set: 0.4502195119857788
loss_pred:0.0293875802308321, decouple_loss:0.013560662046074867
loss_pred:0.029695216566324234, decouple_loss:0.013983814045786858
loss_pred:0.028516897931694984, decouple_loss:0.013516309671103954
Iteration: 1843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463108777999878, gen p mean: 0.0, mean p set: 0.44850072264671326
The modified gen p mean: 0.44678208231925964, gen p mean: 0.0, mean p set: 0.4499904215335846
The modified gen p mean: 0.4471162259578705, gen p mean: 0.0, mean p set: 0.44759565591812134
loss_pred:0.029694925993680954, decouple_loss:0.012930076569318771
loss_pred:0.027528511360287666, decouple_loss:0.013598235324025154
loss_pred:0.02943761833012104, decouple_loss:0.013130217790603638
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
NaN value num: 0
Iteration: 1844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45587193965911865, gen p mean: 0.0, mean p set: 0.45299920439720154
The modified gen p mean: 0.46424785256385803, gen p mean: 0.0, mean p set: 0.450419545173645
The modified gen p mean: 0.4591991901397705, gen p mean: 0.0, mean p set: 0.45005589723587036
loss_pred:0.030051065608859062, decouple_loss:0.013850119896233082
loss_pred:0.028704235330224037, decouple_loss:0.013672418892383575
loss_pred:0.028602400794625282, decouple_loss:0.014520448632538319
Iteration: 1845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508085548877716, gen p mean: 0.0, mean p set: 0.4517989158630371
The modified gen p mean: 0.4489324986934662, gen p mean: 0.0, mean p set: 0.452269583940506
The modified gen p mean: 0.44699209928512573, gen p mean: 0.0, mean p set: 0.44996097683906555
loss_pred:0.028963981196284294, decouple_loss:0.013807711191475391
loss_pred:0.027777375653386116, decouple_loss:0.014328215271234512
loss_pred:0.028392989188432693, decouple_loss:0.01300133392214775
Iteration: 1846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4384037256240845, gen p mean: 0.0, mean p set: 0.45049911737442017
The modified gen p mean: 0.4437794089317322, gen p mean: 0.0, mean p set: 0.45113492012023926
The modified gen p mean: 0.44378358125686646, gen p mean: 0.0, mean p set: 0.45221641659736633
loss_pred:0.02818920463323593, decouple_loss:0.014044437557458878
loss_pred:0.029149245470762253, decouple_loss:0.01346705574542284
loss_pred:0.02807834930717945, decouple_loss:0.013787626288831234
Iteration: 1847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45662814378738403, gen p mean: 0.0, mean p set: 0.45266276597976685
The modified gen p mean: 0.45799100399017334, gen p mean: 0.0, mean p set: 0.45129111409187317
The modified gen p mean: 0.4609166979789734, gen p mean: 0.0, mean p set: 0.45179659128189087
loss_pred:0.028112251311540604, decouple_loss:0.01410677656531334
loss_pred:0.028371358290314674, decouple_loss:0.013618419878184795
loss_pred:0.028895553201436996, decouple_loss:0.01429656706750393
Iteration: 1848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45422765612602234, gen p mean: 0.0, mean p set: 0.45224812626838684
The modified gen p mean: 0.4542720913887024, gen p mean: 0.0, mean p set: 0.45244714617729187
The modified gen p mean: 0.4584021270275116, gen p mean: 0.0, mean p set: 0.4522860050201416
loss_pred:0.027214743196964264, decouple_loss:0.01336393691599369
loss_pred:0.02791350707411766, decouple_loss:0.013511575758457184
loss_pred:0.02736257202923298, decouple_loss:0.013228140771389008
Iteration: 1849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45117345452308655, gen p mean: 0.0, mean p set: 0.4505843222141266
The modified gen p mean: 0.4506686329841614, gen p mean: 0.0, mean p set: 0.4521104097366333
The modified gen p mean: 0.44640013575553894, gen p mean: 0.0, mean p set: 0.45496177673339844
loss_pred:0.029534965753555298, decouple_loss:0.0131950369104743
loss_pred:0.02716352976858616, decouple_loss:0.01300269365310669
loss_pred:0.028125476092100143, decouple_loss:0.014183283783495426
Iteration: 1850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4439863860607147, gen p mean: 0.0, mean p set: 0.4550555646419525
The modified gen p mean: 0.447847843170166, gen p mean: 0.0, mean p set: 0.4520516097545624
The modified gen p mean: 0.4424026310443878, gen p mean: 0.0, mean p set: 0.4506944417953491
loss_pred:0.027417967095971107, decouple_loss:0.014466427266597748
loss_pred:0.027036743238568306, decouple_loss:0.01298732403665781
loss_pred:0.02866484969854355, decouple_loss:0.013563071377575397
2023-05-03 02:46:54 testing...
The modified gen p mean: 0.45674100518226624, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45132842659950256, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.46001583337783813, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028777655214071274, decouple_loss:0.014819983392953873
loss_pred:0.029736166819930077, decouple_loss:0.014978216961026192
loss_pred:0.02835306152701378, decouple_loss:0.014676340855658054
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02969687059521675, avg_mse: 0.034289535135030746
current test mse: 0.03429
Iteration: 1851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45696234703063965, gen p mean: 0.0, mean p set: 0.44990074634552
loss_pred:0.028536204248666763, decouple_loss:0.01343638077378273
The modified gen p mean: 0.4586792588233948, gen p mean: 0.0, mean p set: 0.4516713619232178
loss_pred:0.02859453484416008, decouple_loss:0.013582141138613224
The modified gen p mean: 0.45700889825820923, gen p mean: 0.0, mean p set: 0.45101335644721985
loss_pred:0.02881045639514923, decouple_loss:0.013579604215919971
Iteration: 1852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45699378848075867, gen p mean: 0.0, mean p set: 0.45084720849990845
The modified gen p mean: 0.4513424336910248, gen p mean: 0.0, mean p set: 0.44987502694129944
The modified gen p mean: 0.4555853605270386, gen p mean: 0.0, mean p set: 0.4501844644546509
loss_pred:0.028663353994488716, decouple_loss:0.013297561556100845
loss_pred:0.02850601263344288, decouple_loss:0.013084888458251953
loss_pred:0.029268329963088036, decouple_loss:0.013667521066963673
Iteration: 1853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628605246543884, gen p mean: 0.0, mean p set: 0.45173338055610657
The modified gen p mean: 0.4428899884223938, gen p mean: 0.0, mean p set: 0.4489463269710541
The modified gen p mean: 0.44237253069877625, gen p mean: 0.0, mean p set: 0.45230618119239807
loss_pred:0.0287967287003994, decouple_loss:0.013917557895183563loss_pred:0.028484689071774483, decouple_loss:0.0131932832300663
loss_pred:0.02967722713947296, decouple_loss:0.01347302459180355
Iteration: 1854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44450798630714417, gen p mean: 0.0, mean p set: 0.4523661732673645
The modified gen p mean: 0.44719401001930237, gen p mean: 0.0, mean p set: 0.4513033628463745
The modified gen p mean: 0.4434508979320526, gen p mean: 0.0, mean p set: 0.4539635181427002
loss_pred:0.028815340250730515, decouple_loss:0.01315738819539547
loss_pred:0.028184672817587852, decouple_loss:0.013356903567910194
loss_pred:0.027727583423256874, decouple_loss:0.013790801167488098
Iteration: 1855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4583897888660431, gen p mean: 0.0, mean p set: 0.4536796808242798
The modified gen p mean: 0.45703426003456116, gen p mean: 0.0, mean p set: 0.4520919919013977
The modified gen p mean: 0.45963335037231445, gen p mean: 0.0, mean p set: 0.45086869597435
loss_pred:0.028268244117498398, decouple_loss:0.014088468626141548
loss_pred:0.02773876115679741, decouple_loss:0.013907395303249359
loss_pred:0.02950584515929222, decouple_loss:0.013382288627326488
Iteration: 1856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4555129408836365, gen p mean: 0.0, mean p set: 0.45079267024993896The modified gen p mean: 0.4578222930431366, gen p mean: 0.0, mean p set: 0.45171278715133667
The modified gen p mean: 0.4600989818572998, gen p mean: 0.0, mean p set: 0.4521867632865906
loss_pred:0.028954362496733665, decouple_loss:0.012892804108560085
loss_pred:0.028503064066171646, decouple_loss:0.013389923609793186
loss_pred:0.027657123282551765, decouple_loss:0.0135685745626688
Iteration: 1857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466637969017029, gen p mean: 0.0, mean p set: 0.4528714418411255
The modified gen p mean: 0.44613581895828247, gen p mean: 0.0, mean p set: 0.452201247215271
The modified gen p mean: 0.4451978802680969, gen p mean: 0.0, mean p set: 0.45245081186294556
loss_pred:0.0277850404381752, decouple_loss:0.013356935232877731
loss_pred:0.0288316011428833, decouple_loss:0.013176043517887592
loss_pred:0.02817746438086033, decouple_loss:0.013341370038688183
Iteration: 1858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4435426592826843, gen p mean: 0.0, mean p set: 0.4500890374183655
The modified gen p mean: 0.445039302110672, gen p mean: 0.0, mean p set: 0.4519573748111725
The modified gen p mean: 0.4453336000442505, gen p mean: 0.0, mean p set: 0.45333370566368103
loss_pred:0.02734791301190853, decouple_loss:0.013477960601449013loss_pred:0.02852209284901619, decouple_loss:0.012842384167015553
loss_pred:0.028504688292741776, decouple_loss:0.013428211212158203
Iteration: 1859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4595358967781067, gen p mean: 0.0, mean p set: 0.4539616107940674
The modified gen p mean: 0.4595518708229065, gen p mean: 0.0, mean p set: 0.44890692830085754
The modified gen p mean: 0.46259647607803345, gen p mean: 0.0, mean p set: 0.45096486806869507
loss_pred:0.029129957780241966, decouple_loss:0.012981301173567772
loss_pred:0.028886113315820694, decouple_loss:0.013425850309431553
loss_pred:0.029295872896909714, decouple_loss:0.013679069466888905
Iteration: 1860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799044728279114, gen p mean: 0.0, mean p set: 0.4505594074726105
The modified gen p mean: 0.45230379700660706, gen p mean: 0.0, mean p set: 0.4534992575645447
The modified gen p mean: 0.45442715287208557, gen p mean: 0.0, mean p set: 0.45194417238235474
loss_pred:0.02774098701775074, decouple_loss:0.013508732430636883
loss_pred:0.028372664004564285, decouple_loss:0.012717493809759617
loss_pred:0.02815823443233967, decouple_loss:0.013230656273663044
2023-05-03 02:50:37 testing...
The modified gen p mean: 0.43942391872406006, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4449191689491272, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44816961884498596, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.029653381556272507, decouple_loss:0.015192140825092793
loss_pred:0.028637263923883438, decouple_loss:0.014812878333032131
loss_pred:0.028304340317845345, decouple_loss:0.014758201315999031
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029611049219965935, avg_mse: 0.034040771424770355
current test mse: 0.034041
Iteration: 1861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484129846096039, gen p mean: 0.0, mean p set: 0.4517273008823395
The modified gen p mean: 0.4433930218219757, gen p mean: 0.0, mean p set: 0.45564278960227966
loss_pred:0.028028033673763275, decouple_loss:0.01347985491156578
loss_pred:0.02698688395321369, decouple_loss:0.013691890984773636
The modified gen p mean: 0.44939905405044556, gen p mean: 0.0, mean p set: 0.45095011591911316
loss_pred:0.027914486825466156, decouple_loss:0.013789764605462551
Iteration: 1862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4558238387107849, gen p mean: 0.0, mean p set: 0.45056599378585815
The modified gen p mean: 0.44969382882118225, gen p mean: 0.0, mean p set: 0.45197439193725586
The modified gen p mean: 0.452450692653656, gen p mean: 0.0, mean p set: 0.45149728655815125
loss_pred:0.02977677248418331, decouple_loss:0.013296297751367092
loss_pred:0.028079288080334663, decouple_loss:0.012914583086967468
loss_pred:0.02927328273653984, decouple_loss:0.013161719776690006
Iteration: 1863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45239177346229553, gen p mean: 0.0, mean p set: 0.450576514005661
The modified gen p mean: 0.45819762349128723, gen p mean: 0.0, mean p set: 0.4514580965042114
The modified gen p mean: 0.46030357480049133, gen p mean: 0.0, mean p set: 0.4503606855869293
loss_pred:0.02771437168121338, decouple_loss:0.01279646810144186
loss_pred:0.028336036950349808, decouple_loss:0.01309921219944954
loss_pred:0.02939724549651146, decouple_loss:0.013010365888476372
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
NaN value num: 0
Iteration: 1864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4399139881134033, gen p mean: 0.0, mean p set: 0.45287367701530457
The modified gen p mean: 0.44225946068763733, gen p mean: 0.0, mean p set: 0.45195239782333374
The modified gen p mean: 0.4485265016555786, gen p mean: 0.0, mean p set: 0.4512217342853546
loss_pred:0.02872406877577305, decouple_loss:0.014088308438658714
loss_pred:0.027819843962788582, decouple_loss:0.014507516287267208
loss_pred:0.027485467493534088, decouple_loss:0.013599881902337074
Iteration: 1865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992515444755554, gen p mean: 0.0, mean p set: 0.4531908929347992
The modified gen p mean: 0.4496470093727112, gen p mean: 0.0, mean p set: 0.4526279866695404
The modified gen p mean: 0.44580185413360596, gen p mean: 0.0, mean p set: 0.45221495628356934
loss_pred:0.027595140039920807, decouple_loss:0.013264818117022514
loss_pred:0.029250914230942726, decouple_loss:0.013934236019849777
loss_pred:0.028546186164021492, decouple_loss:0.014385943301022053
Iteration: 1866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4639606475830078, gen p mean: 0.0, mean p set: 0.45241400599479675
The modified gen p mean: 0.45419052243232727, gen p mean: 0.0, mean p set: 0.4537212550640106
The modified gen p mean: 0.4608008563518524, gen p mean: 0.0, mean p set: 0.4523969888687134
loss_pred:0.02791624888777733, decouple_loss:0.013912733644247055
loss_pred:0.028021592646837234, decouple_loss:0.014381976798176765
loss_pred:0.027972960844635963, decouple_loss:0.013533157296478748
Iteration: 1867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45558422803878784, gen p mean: 0.0, mean p set: 0.4522169232368469
The modified gen p mean: 0.4504287540912628, gen p mean: 0.0, mean p set: 0.4523479640483856
The modified gen p mean: 0.4536080062389374, gen p mean: 0.0, mean p set: 0.451114296913147
loss_pred:0.028283702209591866, decouple_loss:0.013631660491228104
loss_pred:0.027473920956254005, decouple_loss:0.013787603937089443
loss_pred:0.02863137051463127, decouple_loss:0.013889307156205177
Iteration: 1868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4447826147079468, gen p mean: 0.0, mean p set: 0.4519937038421631
The modified gen p mean: 0.4476642310619354, gen p mean: 0.0, mean p set: 0.45171958208084106
The modified gen p mean: 0.44682788848876953, gen p mean: 0.0, mean p set: 0.453741192817688
loss_pred:0.02790653333067894, decouple_loss:0.013208604417741299
loss_pred:0.027813619002699852, decouple_loss:0.01350653637200594
loss_pred:0.027941012755036354, decouple_loss:0.014103805646300316
Iteration: 1869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45885834097862244, gen p mean: 0.0, mean p set: 0.45386558771133423
The modified gen p mean: 0.45945316553115845, gen p mean: 0.0, mean p set: 0.45358291268348694
The modified gen p mean: 0.4613756835460663, gen p mean: 0.0, mean p set: 0.4540221691131592
loss_pred:0.026938892900943756, decouple_loss:0.014121371321380138
loss_pred:0.026506347581744194, decouple_loss:0.014697156846523285
loss_pred:0.026957044377923012, decouple_loss:0.014270204119384289
Iteration: 1870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496065676212311, gen p mean: 0.0, mean p set: 0.4530986547470093
The modified gen p mean: 0.4542313516139984, gen p mean: 0.0, mean p set: 0.4528920352458954
The modified gen p mean: 0.4531348645687103, gen p mean: 0.0, mean p set: 0.45181983709335327
loss_pred:0.027434956282377243, decouple_loss:0.01388446893543005
loss_pred:0.028391504660248756, decouple_loss:0.013575511984527111
loss_pred:0.02952922321856022, decouple_loss:0.014735331758856773
2023-05-03 02:54:56 testing...
The modified gen p mean: 0.42881059646606445, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4348925054073334, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.43789562582969666, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.029669027775526047, decouple_loss:0.015975918620824814
loss_pred:0.02860165201127529, decouple_loss:0.015511346980929375
loss_pred:0.028195422142744064, decouple_loss:0.015561884269118309
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029606185853481293, avg_mse: 0.03396406024694443
current test mse: 0.033964
Iteration: 1871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4410858452320099, gen p mean: 0.0, mean p set: 0.4525179862976074
The modified gen p mean: 0.43354830145835876, gen p mean: 0.0, mean p set: 0.4513972997665405
loss_pred:0.027405280619859695, decouple_loss:0.013446484692394733
loss_pred:0.027860622853040695, decouple_loss:0.014019617810845375
The modified gen p mean: 0.4392000138759613, gen p mean: 0.0, mean p set: 0.4518786072731018
loss_pred:0.02925603836774826, decouple_loss:0.014633332379162312
Iteration: 1872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45650890469551086, gen p mean: 0.0, mean p set: 0.4526466727256775
The modified gen p mean: 0.45044705271720886, gen p mean: 0.0, mean p set: 0.4531596302986145
The modified gen p mean: 0.45617806911468506, gen p mean: 0.0, mean p set: 0.4508371949195862
loss_pred:0.028527723625302315, decouple_loss:0.013438088819384575
loss_pred:0.027445849031209946, decouple_loss:0.013849101960659027
loss_pred:0.02831757813692093, decouple_loss:0.013609142042696476
Iteration: 1873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.47014933824539185, gen p mean: 0.0, mean p set: 0.4519711136817932
The modified gen p mean: 0.4714289903640747, gen p mean: 0.0, mean p set: 0.45150119066238403
The modified gen p mean: 0.4730393886566162, gen p mean: 0.0, mean p set: 0.45306316018104553
loss_pred:0.029297668486833572, decouple_loss:0.014433500356972218
loss_pred:0.029566902667284012, decouple_loss:0.013767395168542862
loss_pred:0.028371434658765793, decouple_loss:0.013488848693668842
Iteration: 1874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495026171207428, gen p mean: 0.0, mean p set: 0.45289722084999084
The modified gen p mean: 0.44491463899612427, gen p mean: 0.0, mean p set: 0.4516848623752594
The modified gen p mean: 0.44878989458084106, gen p mean: 0.0, mean p set: 0.45403215289115906
loss_pred:0.027507061138749123, decouple_loss:0.013104621320962906
loss_pred:0.028490867465734482, decouple_loss:0.01330921147018671
loss_pred:0.026679953560233116, decouple_loss:0.013239647261798382
Iteration: 1875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4374580979347229, gen p mean: 0.0, mean p set: 0.4526461064815521
The modified gen p mean: 0.4359467625617981, gen p mean: 0.0, mean p set: 0.45145025849342346
The modified gen p mean: 0.43690839409828186, gen p mean: 0.0, mean p set: 0.4538623094558716
loss_pred:0.028166012838482857, decouple_loss:0.013233575038611889
loss_pred:0.028666118159890175, decouple_loss:0.01307652611285448
loss_pred:0.028096549212932587, decouple_loss:0.013614404015243053
Iteration: 1876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46004533767700195, gen p mean: 0.0, mean p set: 0.45114362239837646
The modified gen p mean: 0.45925840735435486, gen p mean: 0.0, mean p set: 0.45256444811820984
The modified gen p mean: 0.4595893919467926, gen p mean: 0.0, mean p set: 0.4526858329772949
loss_pred:0.02701842226088047, decouple_loss:0.01348780281841755
loss_pred:0.027451425790786743, decouple_loss:0.013166776858270168
loss_pred:0.02845590189099312, decouple_loss:0.012463168241083622
Iteration: 1877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4556386470794678, gen p mean: 0.0, mean p set: 0.45362168550491333
The modified gen p mean: 0.4573328495025635, gen p mean: 0.0, mean p set: 0.4531313478946686
The modified gen p mean: 0.45387256145477295, gen p mean: 0.0, mean p set: 0.4525260329246521
loss_pred:0.02685018815100193, decouple_loss:0.01373249851167202
loss_pred:0.027992689982056618, decouple_loss:0.013515087775886059
loss_pred:0.028894376009702682, decouple_loss:0.013025782071053982
Iteration: 1878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4355763792991638, gen p mean: 0.0, mean p set: 0.453777015209198
The modified gen p mean: 0.44531679153442383, gen p mean: 0.0, mean p set: 0.452355295419693
The modified gen p mean: 0.44427141547203064, gen p mean: 0.0, mean p set: 0.45228806138038635
loss_pred:0.027624860405921936, decouple_loss:0.014846679754555225
loss_pred:0.027607768774032593, decouple_loss:0.013391390442848206
loss_pred:0.027730610221624374, decouple_loss:0.013480414636433125
Iteration: 1879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4630393981933594, gen p mean: 0.0, mean p set: 0.4511723518371582
The modified gen p mean: 0.46023863554000854, gen p mean: 0.0, mean p set: 0.4513482451438904
The modified gen p mean: 0.4604179263114929, gen p mean: 0.0, mean p set: 0.45198309421539307
loss_pred:0.028841355815529823, decouple_loss:0.01324066799134016
loss_pred:0.02760852873325348, decouple_loss:0.012993299402296543
loss_pred:0.028383707627654076, decouple_loss:0.012910266406834126
Iteration: 1880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4608950614929199, gen p mean: 0.0, mean p set: 0.45240697264671326
The modified gen p mean: 0.4570324420928955, gen p mean: 0.0, mean p set: 0.45393162965774536
The modified gen p mean: 0.4603128731250763, gen p mean: 0.0, mean p set: 0.4529043138027191
loss_pred:0.02692617103457451, decouple_loss:0.012704327702522278
loss_pred:0.027784496545791626, decouple_loss:0.013124678283929825
loss_pred:0.026933787390589714, decouple_loss:0.012780437245965004
2023-05-03 02:58:36 testing...
The modified gen p mean: 0.43626078963279724, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.43906843662261963, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4301042854785919, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.028706490993499756, decouple_loss:0.014994336292147636
loss_pred:0.028253450989723206, decouple_loss:0.014961840584874153
loss_pred:0.029933074489235878, decouple_loss:0.015356754884123802
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029719553887844086, avg_mse: 0.034305959939956665
current test mse: 0.034306
Iteration: 1881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43716201186180115, gen p mean: 0.0, mean p set: 0.4517561197280884
The modified gen p mean: 0.44059693813323975, gen p mean: 0.0, mean p set: 0.45228642225265503
loss_pred:0.028644924983382225, decouple_loss:0.013754550367593765
loss_pred:0.027733011171221733, decouple_loss:0.013064699247479439
The modified gen p mean: 0.44091638922691345, gen p mean: 0.0, mean p set: 0.452574759721756
loss_pred:0.02764781378209591, decouple_loss:0.013129044324159622
Iteration: 1882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457211494445801, gen p mean: 0.0, mean p set: 0.4528461992740631
The modified gen p mean: 0.4463740587234497, gen p mean: 0.0, mean p set: 0.45172953605651855
The modified gen p mean: 0.4404069185256958, gen p mean: 0.0, mean p set: 0.4531821608543396
loss_pred:0.02775326929986477, decouple_loss:0.012976004742085934
loss_pred:0.027410103008151054, decouple_loss:0.01327870786190033
loss_pred:0.02738809399306774, decouple_loss:0.013654694892466068
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 1883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45815184712409973, gen p mean: 0.0, mean p set: 0.4492034912109375
The modified gen p mean: 0.4588741958141327, gen p mean: 0.0, mean p set: 0.44901934266090393
The modified gen p mean: 0.45730042457580566, gen p mean: 0.0, mean p set: 0.44887539744377136
loss_pred:0.028881313279271126, decouple_loss:0.01380867138504982
loss_pred:0.028251783922314644, decouple_loss:0.015239434316754341
loss_pred:0.029812544584274292, decouple_loss:0.014734389260411263
Iteration: 1884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4566386044025421, gen p mean: 0.0, mean p set: 0.449317067861557
The modified gen p mean: 0.45745059847831726, gen p mean: 0.0, mean p set: 0.449893593788147
The modified gen p mean: 0.46267297863960266, gen p mean: 0.0, mean p set: 0.4481314718723297
loss_pred:0.028271589428186417, decouple_loss:0.014014961197972298
loss_pred:0.028476078063249588, decouple_loss:0.013276726938784122
loss_pred:0.030158672481775284, decouple_loss:0.014514492824673653
Iteration: 1885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4394232928752899, gen p mean: 0.0, mean p set: 0.4480117857456207
The modified gen p mean: 0.4451914429664612, gen p mean: 0.0, mean p set: 0.4491572082042694
The modified gen p mean: 0.4403687119483948, gen p mean: 0.0, mean p set: 0.4484424889087677
loss_pred:0.029024718329310417, decouple_loss:0.014321074821054935
loss_pred:0.028748707845807076, decouple_loss:0.014182685874402523
loss_pred:0.02918054722249508, decouple_loss:0.014613848179578781
Iteration: 1886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449508398771286, gen p mean: 0.0, mean p set: 0.4492361843585968
The modified gen p mean: 0.4475756287574768, gen p mean: 0.0, mean p set: 0.4493674635887146
The modified gen p mean: 0.4491974711418152, gen p mean: 0.0, mean p set: 0.44768157601356506
loss_pred:0.02767021209001541, decouple_loss:0.013775292783975601
loss_pred:0.02904791757464409, decouple_loss:0.013704282231628895
loss_pred:0.02913232520222664, decouple_loss:0.013750314712524414
Iteration: 1887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44340288639068604, gen p mean: 0.0, mean p set: 0.44810163974761963
The modified gen p mean: 0.445957213640213, gen p mean: 0.0, mean p set: 0.4483141601085663
The modified gen p mean: 0.4504944086074829, gen p mean: 0.0, mean p set: 0.4485989212989807
loss_pred:0.028678743168711662, decouple_loss:0.013529947027564049
loss_pred:0.028928736224770546, decouple_loss:0.013200540095567703
loss_pred:0.030179187655448914, decouple_loss:0.014139814302325249
Iteration: 1888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523932933807373, gen p mean: 0.0, mean p set: 0.44870755076408386
The modified gen p mean: 0.4496142864227295, gen p mean: 0.0, mean p set: 0.4481810927391052
The modified gen p mean: 0.4431993365287781, gen p mean: 0.0, mean p set: 0.44901350140571594
loss_pred:0.028128163889050484, decouple_loss:0.01400232408195734
loss_pred:0.030053630471229553, decouple_loss:0.013986850157380104
loss_pred:0.028403569012880325, decouple_loss:0.013779637403786182
Iteration: 1889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45140352845191956, gen p mean: 0.0, mean p set: 0.4484889805316925
The modified gen p mean: 0.4482647776603699, gen p mean: 0.0, mean p set: 0.45032650232315063
The modified gen p mean: 0.4482494294643402, gen p mean: 0.0, mean p set: 0.44773876667022705
loss_pred:0.02918403595685959, decouple_loss:0.01356230303645134
loss_pred:0.02848040871322155, decouple_loss:0.013459453359246254
loss_pred:0.02878759615123272, decouple_loss:0.01364464033395052
Iteration: 1890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521926939487457, gen p mean: 0.0, mean p set: 0.4486178159713745
The modified gen p mean: 0.4524393379688263, gen p mean: 0.0, mean p set: 0.44836267828941345
The modified gen p mean: 0.4539964497089386, gen p mean: 0.0, mean p set: 0.44730639457702637
loss_pred:0.02816193178296089, decouple_loss:0.013578825630247593
loss_pred:0.02883082814514637, decouple_loss:0.013796376064419746
loss_pred:0.028765112161636353, decouple_loss:0.01384754478931427
2023-05-03 03:02:57 testing...
The modified gen p mean: 0.44238904118537903, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44873854517936707, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45189177989959717, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.029520994052290916, decouple_loss:0.013760531321167946
loss_pred:0.028534216806292534, decouple_loss:0.013625269755721092
loss_pred:0.028141377493739128, decouple_loss:0.013745655305683613
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029417719691991806, avg_mse: 0.03394334018230438
current test mse: 0.033943
Iteration: 1891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732266664505005, gen p mean: 0.0, mean p set: 0.44909700751304626
The modified gen p mean: 0.4514912962913513, gen p mean: 0.0, mean p set: 0.4487088918685913
loss_pred:0.027751384302973747, decouple_loss:0.013441536575555801
loss_pred:0.028277188539505005, decouple_loss:0.013756679370999336
The modified gen p mean: 0.44933196902275085, gen p mean: 0.0, mean p set: 0.44884148240089417
loss_pred:0.02793056145310402, decouple_loss:0.013583594933152199
Iteration: 1892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4420863091945648, gen p mean: 0.0, mean p set: 0.44917547702789307
The modified gen p mean: 0.44238680601119995, gen p mean: 0.0, mean p set: 0.449893057346344
The modified gen p mean: 0.44855451583862305, gen p mean: 0.0, mean p set: 0.44933751225471497
loss_pred:0.02901294082403183, decouple_loss:0.013322258368134499
loss_pred:0.028273366391658783, decouple_loss:0.01306838821619749
loss_pred:0.02866796962916851, decouple_loss:0.013235925696790218
Iteration: 1893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4435049891471863, gen p mean: 0.0, mean p set: 0.4491303265094757
The modified gen p mean: 0.44869211316108704, gen p mean: 0.0, mean p set: 0.4488604962825775
The modified gen p mean: 0.4473409354686737, gen p mean: 0.0, mean p set: 0.4502778649330139
loss_pred:0.028321078047156334, decouple_loss:0.01350718829780817
loss_pred:0.027777666226029396, decouple_loss:0.014022618532180786
loss_pred:0.02971045672893524, decouple_loss:0.013871956616640091
Iteration: 1894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45884761214256287, gen p mean: 0.0, mean p set: 0.44804272055625916
The modified gen p mean: 0.44745758175849915, gen p mean: 0.0, mean p set: 0.4497707486152649
The modified gen p mean: 0.45354601740837097, gen p mean: 0.0, mean p set: 0.449482798576355
loss_pred:0.027849530801177025, decouple_loss:0.013884061016142368
loss_pred:0.028514519333839417, decouple_loss:0.013166320510208607
loss_pred:0.028786728158593178, decouple_loss:0.012943894602358341
Iteration: 1895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514629542827606, gen p mean: 0.0, mean p set: 0.44766971468925476The modified gen p mean: 0.44791921973228455, gen p mean: 0.0, mean p set: 0.44912344217300415
The modified gen p mean: 0.45079267024993896, gen p mean: 0.0, mean p set: 0.4477550983428955
loss_pred:0.02667577750980854, decouple_loss:0.013657156378030777
loss_pred:0.029100075364112854, decouple_loss:0.014006395824253559
loss_pred:0.028567103669047356, decouple_loss:0.014070299454033375
Iteration: 1896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44383808970451355, gen p mean: 0.0, mean p set: 0.4494136571884155
The modified gen p mean: 0.4393160343170166, gen p mean: 0.0, mean p set: 0.4499812126159668
The modified gen p mean: 0.4409900903701782, gen p mean: 0.0, mean p set: 0.44948384165763855
loss_pred:0.027106884866952896, decouple_loss:0.013883990235626698
loss_pred:0.02798500470817089, decouple_loss:0.013672263361513615
loss_pred:0.02912127785384655, decouple_loss:0.013986073434352875
Iteration: 1897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44952794909477234, gen p mean: 0.0, mean p set: 0.44801095128059387
The modified gen p mean: 0.4536415934562683, gen p mean: 0.0, mean p set: 0.44762104749679565
The modified gen p mean: 0.44689685106277466, gen p mean: 0.0, mean p set: 0.4488602578639984
loss_pred:0.02834249660372734, decouple_loss:0.013582554645836353
loss_pred:0.029012612998485565, decouple_loss:0.013733239844441414
loss_pred:0.027717383578419685, decouple_loss:0.013708136044442654
Iteration: 1898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45933982729911804, gen p mean: 0.0, mean p set: 0.44830194115638733
The modified gen p mean: 0.45441901683807373, gen p mean: 0.0, mean p set: 0.44933804869651794
The modified gen p mean: 0.45926010608673096, gen p mean: 0.0, mean p set: 0.4499293565750122
loss_pred:0.028454797342419624, decouple_loss:0.013554156757891178
loss_pred:0.02711876854300499, decouple_loss:0.013049195520579815
loss_pred:0.028661001473665237, decouple_loss:0.013582156039774418
Iteration: 1899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508422911167145, gen p mean: 0.0, mean p set: 0.45008060336112976
The modified gen p mean: 0.4478105306625366, gen p mean: 0.0, mean p set: 0.4480784237384796
The modified gen p mean: 0.4477059543132782, gen p mean: 0.0, mean p set: 0.4492538273334503
loss_pred:0.02806972898542881, decouple_loss:0.012846553698182106
loss_pred:0.028956733644008636, decouple_loss:0.013095725327730179
loss_pred:0.028003109619021416, decouple_loss:0.0132087841629982
Iteration: 1900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43195152282714844, gen p mean: 0.0, mean p set: 0.4497983753681183
The modified gen p mean: 0.43411269783973694, gen p mean: 0.0, mean p set: 0.448948472738266
The modified gen p mean: 0.43408164381980896, gen p mean: 0.0, mean p set: 0.44941920042037964
loss_pred:0.02879524417221546, decouple_loss:0.013181814923882484
loss_pred:0.02851630561053753, decouple_loss:0.01328813936561346
loss_pred:0.029385404661297798, decouple_loss:0.012911785393953323
2023-05-03 03:06:42 testing...
The modified gen p mean: 0.4439248740673065, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45268312096595764, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44972020387649536, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02913173846900463, decouple_loss:0.013513505458831787
loss_pred:0.02771475724875927, decouple_loss:0.013439219444990158
loss_pred:0.02820541337132454, decouple_loss:0.013446783646941185
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02902396023273468, avg_mse: 0.03334319218993187
current test mse: 0.033343
Iteration: 1901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785773754119873, gen p mean: 0.0, mean p set: 0.4496924579143524
The modified gen p mean: 0.4487670361995697, gen p mean: 0.0, mean p set: 0.44836223125457764
loss_pred:0.02729044109582901, decouple_loss:0.013061624020338058
loss_pred:0.02861311100423336, decouple_loss:0.013398170471191406
The modified gen p mean: 0.45146769285202026, gen p mean: 0.0, mean p set: 0.4483092129230499
loss_pred:0.02806607261300087, decouple_loss:0.012966832146048546
Iteration: 1902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4622865617275238, gen p mean: 0.0, mean p set: 0.44847777485847473
The modified gen p mean: 0.4641360640525818, gen p mean: 0.0, mean p set: 0.44789305329322815
The modified gen p mean: 0.46807897090911865, gen p mean: 0.0, mean p set: 0.4485621154308319
loss_pred:0.029240824282169342, decouple_loss:0.013100308366119862
loss_pred:0.029135122895240784, decouple_loss:0.0136101134121418
loss_pred:0.028349826112389565, decouple_loss:0.014001737348735332
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
NaN value num: 0
Iteration: 1903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481028616428375, gen p mean: 0.0, mean p set: 0.4509435296058655
The modified gen p mean: 0.44330060482025146, gen p mean: 0.0, mean p set: 0.4506766200065613
The modified gen p mean: 0.44867265224456787, gen p mean: 0.0, mean p set: 0.44958674907684326
loss_pred:0.02896958589553833, decouple_loss:0.016506830230355263
loss_pred:0.029324347153306007, decouple_loss:0.015204026363790035
loss_pred:0.029054081067442894, decouple_loss:0.015229192562401295
Iteration: 1904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443536698818207, gen p mean: 0.0, mean p set: 0.4498059153556824
The modified gen p mean: 0.44201284646987915, gen p mean: 0.0, mean p set: 0.44910821318626404
The modified gen p mean: 0.4446416199207306, gen p mean: 0.0, mean p set: 0.4496335983276367
loss_pred:0.02968462184071541, decouple_loss:0.014180930331349373
loss_pred:0.029127929359674454, decouple_loss:0.014097534120082855
loss_pred:0.027769042178988457, decouple_loss:0.01398482546210289
Iteration: 1905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500125050544739, gen p mean: 0.0, mean p set: 0.45100319385528564
The modified gen p mean: 0.44899964332580566, gen p mean: 0.0, mean p set: 0.45134806632995605
The modified gen p mean: 0.4475158452987671, gen p mean: 0.0, mean p set: 0.45154935121536255
loss_pred:0.028278477489948273, decouple_loss:0.013773364946246147
loss_pred:0.028277259320020676, decouple_loss:0.014019384980201721
loss_pred:0.029369713738560677, decouple_loss:0.014544692821800709
Iteration: 1906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174670219421387, gen p mean: 0.0, mean p set: 0.4512770175933838
The modified gen p mean: 0.4498732388019562, gen p mean: 0.0, mean p set: 0.45137593150138855
The modified gen p mean: 0.4486857056617737, gen p mean: 0.0, mean p set: 0.45081907510757446
loss_pred:0.028599444776773453, decouple_loss:0.014122641645371914
loss_pred:0.02924586646258831, decouple_loss:0.01438200194388628
loss_pred:0.028638912364840508, decouple_loss:0.014105970039963722
Iteration: 1907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4545612931251526, gen p mean: 0.0, mean p set: 0.4479064345359802
The modified gen p mean: 0.4502447247505188, gen p mean: 0.0, mean p set: 0.451107382774353
The modified gen p mean: 0.45150792598724365, gen p mean: 0.0, mean p set: 0.4511445164680481
loss_pred:0.028926340863108635, decouple_loss:0.013695202767848969
loss_pred:0.027468010783195496, decouple_loss:0.014391215518116951
loss_pred:0.029257379472255707, decouple_loss:0.01398851815611124
Iteration: 1908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45763882994651794, gen p mean: 0.0, mean p set: 0.44962990283966064
The modified gen p mean: 0.45644283294677734, gen p mean: 0.0, mean p set: 0.4491001069545746
The modified gen p mean: 0.45823124051094055, gen p mean: 0.0, mean p set: 0.44978588819503784
loss_pred:0.029985228553414345, decouple_loss:0.013717349618673325
loss_pred:0.02865014597773552, decouple_loss:0.013900731690227985
loss_pred:0.0298905149102211, decouple_loss:0.013441954739391804
Iteration: 1909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492427408695221, gen p mean: 0.0, mean p set: 0.4491093158721924
The modified gen p mean: 0.44556230306625366, gen p mean: 0.0, mean p set: 0.451210081577301
The modified gen p mean: 0.4492425322532654, gen p mean: 0.0, mean p set: 0.450238436460495
loss_pred:0.029232602566480637, decouple_loss:0.014035156928002834
loss_pred:0.02897149883210659, decouple_loss:0.013532166369259357
loss_pred:0.028910642489790916, decouple_loss:0.01415589451789856
Iteration: 1910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44414061307907104, gen p mean: 0.0, mean p set: 0.4503363370895386
The modified gen p mean: 0.441081166267395, gen p mean: 0.0, mean p set: 0.4507073163986206
The modified gen p mean: 0.43802884221076965, gen p mean: 0.0, mean p set: 0.45069611072540283
loss_pred:0.02902435138821602, decouple_loss:0.013261263258755207
loss_pred:0.028888102620840073, decouple_loss:0.0135802635923028
loss_pred:0.028141621500253677, decouple_loss:0.013842029497027397
2023-05-03 03:11:10 testing...
The modified gen p mean: 0.44676873087882996, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44126254320144653, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45017582178115845, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028402304276823997, decouple_loss:0.014723760075867176
loss_pred:0.029330803081393242, decouple_loss:0.014981672167778015
loss_pred:0.027975643053650856, decouple_loss:0.014724304899573326
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029310081154108047, avg_mse: 0.033772557973861694
current test mse: 0.033773
Iteration: 1911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452388882637024, gen p mean: 0.0, mean p set: 0.4507302939891815
loss_pred:0.02889573760330677, decouple_loss:0.013483968563377857
The modified gen p mean: 0.4475032687187195, gen p mean: 0.0, mean p set: 0.45025497674942017
loss_pred:0.028801871463656425, decouple_loss:0.012870627455413342
The modified gen p mean: 0.44881758093833923, gen p mean: 0.0, mean p set: 0.4503605365753174
loss_pred:0.028341006487607956, decouple_loss:0.01332931686192751
Iteration: 1912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.455599308013916, gen p mean: 0.0, mean p set: 0.45119279623031616
The modified gen p mean: 0.45995354652404785, gen p mean: 0.0, mean p set: 0.4497242569923401
The modified gen p mean: 0.4609551727771759, gen p mean: 0.0, mean p set: 0.4495084881782532
loss_pred:0.027710560709238052, decouple_loss:0.013080021366477013
loss_pred:0.029338384047150612, decouple_loss:0.012692907825112343
loss_pred:0.028484484180808067, decouple_loss:0.013220027089118958
Iteration: 1913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4556042551994324, gen p mean: 0.0, mean p set: 0.4507790505886078
The modified gen p mean: 0.4559585154056549, gen p mean: 0.0, mean p set: 0.44910016655921936
The modified gen p mean: 0.4552246332168579, gen p mean: 0.0, mean p set: 0.451691210269928
loss_pred:0.028800688683986664, decouple_loss:0.0134291872382164
loss_pred:0.028582217171788216, decouple_loss:0.01288609579205513
loss_pred:0.02825990319252014, decouple_loss:0.013191170990467072
Iteration: 1914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4438243508338928, gen p mean: 0.0, mean p set: 0.449710875749588
The modified gen p mean: 0.4384669065475464, gen p mean: 0.0, mean p set: 0.451090544462204
The modified gen p mean: 0.4421725869178772, gen p mean: 0.0, mean p set: 0.4498521387577057
loss_pred:0.029199644923210144, decouple_loss:0.013053545728325844
loss_pred:0.027350109070539474, decouple_loss:0.013674266636371613
loss_pred:0.029612604528665543, decouple_loss:0.013096623122692108
Iteration: 1915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44662752747535706, gen p mean: 0.0, mean p set: 0.4508344829082489
The modified gen p mean: 0.4485529363155365, gen p mean: 0.0, mean p set: 0.4513164758682251
The modified gen p mean: 0.4433426260948181, gen p mean: 0.0, mean p set: 0.45060214400291443
loss_pred:0.028133703395724297, decouple_loss:0.013184509240090847
loss_pred:0.028340009972453117, decouple_loss:0.012483404017984867
loss_pred:0.028443777933716774, decouple_loss:0.012813425622880459
Iteration: 1916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4608868658542633, gen p mean: 0.0, mean p set: 0.45060789585113525
The modified gen p mean: 0.46025899052619934, gen p mean: 0.0, mean p set: 0.4493708908557892
The modified gen p mean: 0.45702260732650757, gen p mean: 0.0, mean p set: 0.45140841603279114
loss_pred:0.028853770345449448, decouple_loss:0.013123542070388794
loss_pred:0.029364245012402534, decouple_loss:0.012723565101623535
loss_pred:0.02869810163974762, decouple_loss:0.012452183291316032
Iteration: 1917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44941794872283936, gen p mean: 0.0, mean p set: 0.45066148042678833
The modified gen p mean: 0.4548875689506531, gen p mean: 0.0, mean p set: 0.4502485692501068
The modified gen p mean: 0.44924360513687134, gen p mean: 0.0, mean p set: 0.44924622774124146
loss_pred:0.027814973145723343, decouple_loss:0.012770771980285645
loss_pred:0.028782803565263748, decouple_loss:0.01215344574302435
loss_pred:0.028341488912701607, decouple_loss:0.01308909896761179
Iteration: 1918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.442199170589447, gen p mean: 0.0, mean p set: 0.4508116841316223
The modified gen p mean: 0.4373093247413635, gen p mean: 0.0, mean p set: 0.4514552056789398
The modified gen p mean: 0.4391525983810425, gen p mean: 0.0, mean p set: 0.4492696523666382
loss_pred:0.028922835364937782, decouple_loss:0.013113175518810749
loss_pred:0.028984710574150085, decouple_loss:0.012942112050950527
loss_pred:0.028437675908207893, decouple_loss:0.012782419100403786
Iteration: 1919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450093537569046, gen p mean: 0.0, mean p set: 0.4510233402252197
The modified gen p mean: 0.44939643144607544, gen p mean: 0.0, mean p set: 0.4503205716609955
The modified gen p mean: 0.4478818476200104, gen p mean: 0.0, mean p set: 0.45112112164497375
loss_pred:0.0285760760307312, decouple_loss:0.012220451608300209
loss_pred:0.028345514088869095, decouple_loss:0.013100632466375828
loss_pred:0.027463283389806747, decouple_loss:0.012881162576377392
Iteration: 1920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4577656388282776, gen p mean: 0.0, mean p set: 0.45120275020599365
The modified gen p mean: 0.46570122241973877, gen p mean: 0.0, mean p set: 0.45084407925605774
The modified gen p mean: 0.463411420583725, gen p mean: 0.0, mean p set: 0.4514020085334778
loss_pred:0.027337195351719856, decouple_loss:0.012519817799329758
loss_pred:0.028946856036782265, decouple_loss:0.012415576726198196
loss_pred:0.028551436960697174, decouple_loss:0.012851645238697529
2023-05-03 03:14:53 testing...
The modified gen p mean: 0.44987303018569946, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4444843530654907, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45271334052085876, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028220288455486298, decouple_loss:0.014193442650139332
loss_pred:0.02924175001680851, decouple_loss:0.014486496336758137
loss_pred:0.02784627489745617, decouple_loss:0.014011337421834469
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029147624969482422, avg_mse: 0.03361894562840462
current test mse: 0.033619
Iteration: 1921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474949538707733, gen p mean: 0.0, mean p set: 0.45035505294799805
loss_pred:0.028365330770611763, decouple_loss:0.012342458590865135
The modified gen p mean: 0.44908639788627625, gen p mean: 0.0, mean p set: 0.4513210952281952
loss_pred:0.027432430535554886, decouple_loss:0.012255722656846046
The modified gen p mean: 0.446262001991272, gen p mean: 0.0, mean p set: 0.4509302079677582
loss_pred:0.027832873165607452, decouple_loss:0.012911195866763592
Iteration: 1922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4426286518573761, gen p mean: 0.0, mean p set: 0.45191389322280884
The modified gen p mean: 0.44644060730934143, gen p mean: 0.0, mean p set: 0.4480571150779724
The modified gen p mean: 0.4468652009963989, gen p mean: 0.0, mean p set: 0.4502963423728943
loss_pred:0.02774771675467491, decouple_loss:0.012103276327252388
loss_pred:0.028245851397514343, decouple_loss:0.01260838657617569
loss_pred:0.027779188007116318, decouple_loss:0.012897685170173645
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
NaN value num: 0
Iteration: 1923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45417267084121704, gen p mean: 0.0, mean p set: 0.4506807327270508
The modified gen p mean: 0.4519449472427368, gen p mean: 0.0, mean p set: 0.4513396918773651
The modified gen p mean: 0.45016345381736755, gen p mean: 0.0, mean p set: 0.44856342673301697
loss_pred:0.027250373736023903, decouple_loss:0.012400132603943348
loss_pred:0.027862880378961563, decouple_loss:0.013182617723941803
loss_pred:0.02742667868733406, decouple_loss:0.012427478097379208
Iteration: 1924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45119091868400574, gen p mean: 0.0, mean p set: 0.4487653374671936
The modified gen p mean: 0.4509766399860382, gen p mean: 0.0, mean p set: 0.44882118701934814
The modified gen p mean: 0.44416195154190063, gen p mean: 0.0, mean p set: 0.4511985182762146
loss_pred:0.02804623171687126, decouple_loss:0.012590671889483929
loss_pred:0.027927670627832413, decouple_loss:0.012606849893927574
loss_pred:0.02700689621269703, decouple_loss:0.012858138419687748
Iteration: 1925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452401340007782, gen p mean: 0.0, mean p set: 0.4482796788215637
The modified gen p mean: 0.4484737813472748, gen p mean: 0.0, mean p set: 0.45235374569892883
The modified gen p mean: 0.45388126373291016, gen p mean: 0.0, mean p set: 0.44929447770118713
loss_pred:0.027552971616387367, decouple_loss:0.0126526253297925
loss_pred:0.02693050168454647, decouple_loss:0.01278674602508545
loss_pred:0.027734624221920967, decouple_loss:0.012270121835172176
Iteration: 1926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497221112251282, gen p mean: 0.0, mean p set: 0.4491298198699951
The modified gen p mean: 0.44851240515708923, gen p mean: 0.0, mean p set: 0.45044276118278503
The modified gen p mean: 0.44778668880462646, gen p mean: 0.0, mean p set: 0.4514223337173462
loss_pred:0.027515055611729622, decouple_loss:0.012499955482780933
loss_pred:0.027031417936086655, decouple_loss:0.012516084127128124
loss_pred:0.027482744306325912, decouple_loss:0.012918727472424507
Iteration: 1927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478355050086975, gen p mean: 0.0, mean p set: 0.45059797167778015
The modified gen p mean: 0.44168928265571594, gen p mean: 0.0, mean p set: 0.4521687626838684
The modified gen p mean: 0.4457818865776062, gen p mean: 0.0, mean p set: 0.4509415924549103
loss_pred:0.02814176306128502, decouple_loss:0.012591066770255566loss_pred:0.028099698945879936, decouple_loss:0.01207374781370163
loss_pred:0.027410948649048805, decouple_loss:0.012304275296628475
Iteration: 1928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45977526903152466, gen p mean: 0.0, mean p set: 0.44880905747413635
The modified gen p mean: 0.45798444747924805, gen p mean: 0.0, mean p set: 0.4516487121582031
The modified gen p mean: 0.4589920938014984, gen p mean: 0.0, mean p set: 0.45026326179504395
loss_pred:0.02763964608311653, decouple_loss:0.01254930067807436
loss_pred:0.028006264939904213, decouple_loss:0.011888477019965649
loss_pred:0.02860877849161625, decouple_loss:0.012522963806986809
Iteration: 1929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782036542892456, gen p mean: 0.0, mean p set: 0.45205825567245483
The modified gen p mean: 0.4493962824344635, gen p mean: 0.0, mean p set: 0.45027294754981995
The modified gen p mean: 0.44523364305496216, gen p mean: 0.0, mean p set: 0.4521893560886383
loss_pred:0.027884887531399727, decouple_loss:0.0122825400903821
loss_pred:0.02789890579879284, decouple_loss:0.012309460900723934
loss_pred:0.027332555502653122, decouple_loss:0.012516343034803867
Iteration: 1930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44447487592697144, gen p mean: 0.0, mean p set: 0.44907721877098083
The modified gen p mean: 0.4456777274608612, gen p mean: 0.0, mean p set: 0.45157620310783386
The modified gen p mean: 0.44487088918685913, gen p mean: 0.0, mean p set: 0.45155924558639526
loss_pred:0.027926219627261162, decouple_loss:0.01208966039121151
loss_pred:0.028126951307058334, decouple_loss:0.011900697834789753
loss_pred:0.02787848375737667, decouple_loss:0.012018009088933468
2023-05-03 03:19:16 testing...
The modified gen p mean: 0.45010092854499817, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45555758476257324, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4588280916213989, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.0293839443475008, decouple_loss:0.013859583996236324
loss_pred:0.028369620442390442, decouple_loss:0.013782234862446785
loss_pred:0.027881601825356483, decouple_loss:0.013806943781673908
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02923586778342724, avg_mse: 0.03382899984717369
current test mse: 0.033829
Iteration: 1931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4586159586906433, gen p mean: 0.0, mean p set: 0.4520282447338104
The modified gen p mean: 0.4550694525241852, gen p mean: 0.0, mean p set: 0.4512050449848175
loss_pred:0.027755189687013626, decouple_loss:0.012132491916418076
loss_pred:0.02736278437077999, decouple_loss:0.012627694755792618
The modified gen p mean: 0.45524781942367554, gen p mean: 0.0, mean p set: 0.4485791027545929
loss_pred:0.028124826028943062, decouple_loss:0.011988040991127491
Iteration: 1932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525121748447418, gen p mean: 0.0, mean p set: 0.4491605758666992
The modified gen p mean: 0.4508545398712158, gen p mean: 0.0, mean p set: 0.4497029781341553
loss_pred:0.02732330560684204, decouple_loss:0.011911517940461636
The modified gen p mean: 0.4506423771381378, gen p mean: 0.0, mean p set: 0.4505334198474884
loss_pred:0.02687579020857811, decouple_loss:0.012346695177257061
loss_pred:0.028177494183182716, decouple_loss:0.01261200662702322
Iteration: 1933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446441113948822, gen p mean: 0.0, mean p set: 0.44900739192962646
The modified gen p mean: 0.444989413022995, gen p mean: 0.0, mean p set: 0.4510902166366577
The modified gen p mean: 0.4396045207977295, gen p mean: 0.0, mean p set: 0.45250096917152405
loss_pred:0.02798902615904808, decouple_loss:0.012100297026336193
loss_pred:0.027640771120786667, decouple_loss:0.012317048385739326
loss_pred:0.02806459181010723, decouple_loss:0.012552724219858646
Iteration: 1934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454196035861969, gen p mean: 0.0, mean p set: 0.45001283288002014
The modified gen p mean: 0.4554280936717987, gen p mean: 0.0, mean p set: 0.449969619512558
The modified gen p mean: 0.4557665288448334, gen p mean: 0.0, mean p set: 0.44841381907463074
loss_pred:0.027432454749941826, decouple_loss:0.012235463596880436
loss_pred:0.02845245972275734, decouple_loss:0.011901125311851501
loss_pred:0.02701873704791069, decouple_loss:0.012145164422690868
Iteration: 1935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053496956825256, gen p mean: 0.0, mean p set: 0.44922852516174316
The modified gen p mean: 0.4526832401752472, gen p mean: 0.0, mean p set: 0.44883993268013
The modified gen p mean: 0.45305517315864563, gen p mean: 0.0, mean p set: 0.4506383240222931
loss_pred:0.027900569140911102, decouple_loss:0.011828230693936348
loss_pred:0.02730463817715645, decouple_loss:0.012106765061616898
loss_pred:0.028014985844492912, decouple_loss:0.012555093504488468
Iteration: 1936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4374701678752899, gen p mean: 0.0, mean p set: 0.45108291506767273The modified gen p mean: 0.43370360136032104, gen p mean: 0.0, mean p set: 0.44887110590934753
The modified gen p mean: 0.43574059009552, gen p mean: 0.0, mean p set: 0.45073628425598145
loss_pred:0.02766120620071888, decouple_loss:0.011954845860600471
loss_pred:0.02764798142015934, decouple_loss:0.011858753859996796
loss_pred:0.02752908319234848, decouple_loss:0.012017578817903996
Iteration: 1937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45251452922821045, gen p mean: 0.0, mean p set: 0.45093685388565063
The modified gen p mean: 0.4531387984752655, gen p mean: 0.0, mean p set: 0.4502235949039459
The modified gen p mean: 0.44994354248046875, gen p mean: 0.0, mean p set: 0.45188701152801514
loss_pred:0.028010867536067963, decouple_loss:0.011818119324743748
loss_pred:0.028163598850369453, decouple_loss:0.011871966533362865
loss_pred:0.0268502589315176, decouple_loss:0.012398647144436836
Iteration: 1938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4562705457210541, gen p mean: 0.0, mean p set: 0.4511696398258209
The modified gen p mean: 0.4599851667881012, gen p mean: 0.0, mean p set: 0.4517004191875458
The modified gen p mean: 0.45780906081199646, gen p mean: 0.0, mean p set: 0.4515781104564667
loss_pred:0.027807405218482018, decouple_loss:0.012093884870409966loss_pred:0.0276000015437603, decouple_loss:0.012615067884325981
loss_pred:0.02779638208448887, decouple_loss:0.01260178629308939
Iteration: 1939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481236934661865, gen p mean: 0.0, mean p set: 0.4521230459213257
The modified gen p mean: 0.4488617777824402, gen p mean: 0.0, mean p set: 0.45262959599494934
The modified gen p mean: 0.4479115903377533, gen p mean: 0.0, mean p set: 0.45137983560562134
loss_pred:0.02769019827246666, decouple_loss:0.012825006619095802
loss_pred:0.02675827220082283, decouple_loss:0.012433242984116077
loss_pred:0.027306193485856056, decouple_loss:0.01280023530125618
Iteration: 1940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823402166366577, gen p mean: 0.0, mean p set: 0.450398713350296
The modified gen p mean: 0.4489111602306366, gen p mean: 0.0, mean p set: 0.44812753796577454
The modified gen p mean: 0.4479959011077881, gen p mean: 0.0, mean p set: 0.44957149028778076
loss_pred:0.02743133343756199, decouple_loss:0.012189828790724277
loss_pred:0.02784852311015129, decouple_loss:0.012645971029996872
loss_pred:0.028264330700039864, decouple_loss:0.01256069540977478
2023-05-03 03:22:58 testing...
The modified gen p mean: 0.44397279620170593, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45251789689064026, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44948989152908325, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.029632147401571274, decouple_loss:0.014184840023517609
loss_pred:0.028187880292534828, decouple_loss:0.013985765166580677
loss_pred:0.02853160910308361, decouple_loss:0.014004569500684738
WV_0_PC_0_EH_0_PS_40_6, loss: 0.029486797749996185, avg_mse: 0.03434855863451958
current test mse: 0.034349
Iteration: 1941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45130640268325806, gen p mean: 0.0, mean p set: 0.4502636790275574
The modified gen p mean: 0.4479714334011078, gen p mean: 0.0, mean p set: 0.45258763432502747
loss_pred:0.027145031839609146, decouple_loss:0.012153040617704391
loss_pred:0.02796349674463272, decouple_loss:0.012755005620419979
The modified gen p mean: 0.45181968808174133, gen p mean: 0.0, mean p set: 0.4494839310646057
loss_pred:0.027372591197490692, decouple_loss:0.0125202015042305
Iteration: 1942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518890976905823, gen p mean: 0.0, mean p set: 0.44848257303237915
The modified gen p mean: 0.45179682970046997, gen p mean: 0.0, mean p set: 0.45085906982421875
The modified gen p mean: 0.44921380281448364, gen p mean: 0.0, mean p set: 0.45187318325042725
loss_pred:0.027278412133455276, decouple_loss:0.012623083777725697
loss_pred:0.02808302454650402, decouple_loss:0.012806772254407406
loss_pred:0.027650391682982445, decouple_loss:0.012533048167824745
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 1943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968381524086, gen p mean: 0.0, mean p set: 0.4485572874546051
The modified gen p mean: 0.45144522190093994, gen p mean: 0.0, mean p set: 0.4477371871471405
The modified gen p mean: 0.4472446143627167, gen p mean: 0.0, mean p set: 0.44885799288749695
loss_pred:0.02825223281979561, decouple_loss:0.014296473935246468
loss_pred:0.0289080161601305, decouple_loss:0.013623924925923347
loss_pred:0.029149005189538002, decouple_loss:0.014057272113859653
Iteration: 1944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057201385498047, gen p mean: 0.0, mean p set: 0.44859644770622253
The modified gen p mean: 0.44592997431755066, gen p mean: 0.0, mean p set: 0.44867774844169617
The modified gen p mean: 0.4516576826572418, gen p mean: 0.0, mean p set: 0.4502353370189667
loss_pred:0.027942096814513206, decouple_loss:0.013766699470579624
loss_pred:0.028671298176050186, decouple_loss:0.014011058025062084
loss_pred:0.027879679575562477, decouple_loss:0.013680800795555115
Iteration: 1945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939520955085754, gen p mean: 0.0, mean p set: 0.44889771938323975
The modified gen p mean: 0.4499647915363312, gen p mean: 0.0, mean p set: 0.4505176842212677
The modified gen p mean: 0.44579148292541504, gen p mean: 0.0, mean p set: 0.4477499723434448
loss_pred:0.029012586921453476, decouple_loss:0.013373828493058681
loss_pred:0.027050210162997246, decouple_loss:0.013488740660250187
loss_pred:0.029195619747042656, decouple_loss:0.013705822639167309
Iteration: 1946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443180561065674, gen p mean: 0.0, mean p set: 0.4495624303817749
The modified gen p mean: 0.44132548570632935, gen p mean: 0.0, mean p set: 0.4494233727455139
The modified gen p mean: 0.44253626465797424, gen p mean: 0.0, mean p set: 0.4475933015346527
loss_pred:0.027921944856643677, decouple_loss:0.014007522724568844
loss_pred:0.02869170717895031, decouple_loss:0.013774181716144085
loss_pred:0.02956850454211235, decouple_loss:0.013948572799563408
Iteration: 1947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480772316455841, gen p mean: 0.0, mean p set: 0.4479774832725525The modified gen p mean: 0.45182254910469055, gen p mean: 0.0, mean p set: 0.4479128420352936
The modified gen p mean: 0.44973716139793396, gen p mean: 0.0, mean p set: 0.4483363628387451
loss_pred:0.02747979760169983, decouple_loss:0.013439939357340336loss_pred:0.028094150125980377, decouple_loss:0.01363975927233696
loss_pred:0.02870919741690159, decouple_loss:0.0132517721503973
Iteration: 1948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4571395814418793, gen p mean: 0.0, mean p set: 0.44867458939552307
The modified gen p mean: 0.4484763443470001, gen p mean: 0.0, mean p set: 0.45020073652267456
The modified gen p mean: 0.45367974042892456, gen p mean: 0.0, mean p set: 0.4502794146537781
loss_pred:0.029152730479836464, decouple_loss:0.013768970035016537
loss_pred:0.026865746825933456, decouple_loss:0.013784213922917843
loss_pred:0.02861992083489895, decouple_loss:0.01374178845435381
Iteration: 1949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44548299908638, gen p mean: 0.0, mean p set: 0.449176549911499
The modified gen p mean: 0.4470497667789459, gen p mean: 0.0, mean p set: 0.4493841528892517
The modified gen p mean: 0.44750723242759705, gen p mean: 0.0, mean p set: 0.4492860734462738
loss_pred:0.02836674079298973, decouple_loss:0.013257662765681744
loss_pred:0.028019001707434654, decouple_loss:0.013759016990661621
loss_pred:0.028133941814303398, decouple_loss:0.013805201277136803
Iteration: 1950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.443534255027771, gen p mean: 0.0, mean p set: 0.4494149386882782
The modified gen p mean: 0.4490838050842285, gen p mean: 0.0, mean p set: 0.4481402039527893
The modified gen p mean: 0.4504324495792389, gen p mean: 0.0, mean p set: 0.4480287730693817
loss_pred:0.0277643371373415, decouple_loss:0.013489346951246262
loss_pred:0.027882317081093788, decouple_loss:0.012861008755862713
loss_pred:0.02933594211935997, decouple_loss:0.012554088607430458
2023-05-03 03:27:16 testing...
The modified gen p mean: 0.4538237750530243, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4506133496761322, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4449603855609894, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.027795450761914253, decouple_loss:0.013850894756615162
loss_pred:0.028273269534111023, decouple_loss:0.013491952791810036
loss_pred:0.029299091547727585, decouple_loss:0.01393803209066391
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02914395183324814, avg_mse: 0.033682506531476974
current test mse: 0.033683
Iteration: 1951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45181402564048767, gen p mean: 0.0, mean p set: 0.44786569476127625The modified gen p mean: 0.44755876064300537, gen p mean: 0.0, mean p set: 0.44867387413978577
loss_pred:0.027843737974762917, decouple_loss:0.013221880421042442
loss_pred:0.02796831727027893, decouple_loss:0.01349705271422863
The modified gen p mean: 0.44911879301071167, gen p mean: 0.0, mean p set: 0.4521370232105255
loss_pred:0.027962207794189453, decouple_loss:0.013612426817417145
Iteration: 1952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933339953422546, gen p mean: 0.0, mean p set: 0.44782793521881104
The modified gen p mean: 0.444253534078598, gen p mean: 0.0, mean p set: 0.44884639978408813
The modified gen p mean: 0.44647952914237976, gen p mean: 0.0, mean p set: 0.4478965699672699
loss_pred:0.028267869725823402, decouple_loss:0.012389810755848885
loss_pred:0.027423856779932976, decouple_loss:0.013157760724425316
loss_pred:0.028356431052088737, decouple_loss:0.012900064699351788
Iteration: 1953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451150119304657, gen p mean: 0.0, mean p set: 0.44843384623527527
The modified gen p mean: 0.4554615318775177, gen p mean: 0.0, mean p set: 0.447748064994812
The modified gen p mean: 0.4543265104293823, gen p mean: 0.0, mean p set: 0.44814345240592957
loss_pred:0.02880670130252838, decouple_loss:0.012801610864698887
loss_pred:0.02728472836315632, decouple_loss:0.012261170893907547
loss_pred:0.02860606648027897, decouple_loss:0.01289243996143341
Iteration: 1954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45137789845466614, gen p mean: 0.0, mean p set: 0.44803765416145325
The modified gen p mean: 0.44551751017570496, gen p mean: 0.0, mean p set: 0.45009157061576843
The modified gen p mean: 0.4471948742866516, gen p mean: 0.0, mean p set: 0.4479064643383026
loss_pred:0.02811962179839611, decouple_loss:0.012613463215529919
loss_pred:0.027396870777010918, decouple_loss:0.01303173042833805
loss_pred:0.028802508488297462, decouple_loss:0.01328262034803629
Iteration: 1955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44523191452026367, gen p mean: 0.0, mean p set: 0.44833314418792725
The modified gen p mean: 0.4383904039859772, gen p mean: 0.0, mean p set: 0.45023879408836365
The modified gen p mean: 0.44499626755714417, gen p mean: 0.0, mean p set: 0.447394996881485
loss_pred:0.028475992381572723, decouple_loss:0.012434076517820358
loss_pred:0.028257254511117935, decouple_loss:0.013091013766825199
loss_pred:0.02674936130642891, decouple_loss:0.012446021661162376
Iteration: 1956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44227221608161926, gen p mean: 0.0, mean p set: 0.44887375831604004
The modified gen p mean: 0.44321301579475403, gen p mean: 0.0, mean p set: 0.4488815367221832
The modified gen p mean: 0.43932899832725525, gen p mean: 0.0, mean p set: 0.44920656085014343
loss_pred:0.029914850369095802, decouple_loss:0.013040918856859207
loss_pred:0.029740484431385994, decouple_loss:0.0128006087616086
loss_pred:0.027820643037557602, decouple_loss:0.012955622747540474
Iteration: 1957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46127253770828247, gen p mean: 0.0, mean p set: 0.4481779932975769
The modified gen p mean: 0.45817410945892334, gen p mean: 0.0, mean p set: 0.44923779368400574
The modified gen p mean: 0.457332968711853, gen p mean: 0.0, mean p set: 0.4498351216316223
loss_pred:0.028890416026115417, decouple_loss:0.01214610319584608
loss_pred:0.02892293781042099, decouple_loss:0.012720976024866104
loss_pred:0.02701355703175068, decouple_loss:0.012798961251974106
Iteration: 1958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628646969795227, gen p mean: 0.0, mean p set: 0.4494871497154236
The modified gen p mean: 0.4552125334739685, gen p mean: 0.0, mean p set: 0.449554443359375
The modified gen p mean: 0.4457036554813385, gen p mean: 0.0, mean p set: 0.4496042728424072
loss_pred:0.025479022413492203, decouple_loss:0.013397583737969398
loss_pred:0.02806897647678852, decouple_loss:0.013084565289318562
loss_pred:0.02566991187632084, decouple_loss:0.01325487345457077
Iteration: 1959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4447569251060486, gen p mean: 0.0, mean p set: 0.44904303550720215
The modified gen p mean: 0.4400760233402252, gen p mean: 0.0, mean p set: 0.4493279755115509
The modified gen p mean: 0.44048449397087097, gen p mean: 0.0, mean p set: 0.4496400058269501
loss_pred:0.028019489720463753, decouple_loss:0.012290970422327518
loss_pred:0.02568919211626053, decouple_loss:0.012700394727289677
loss_pred:0.027331115677952766, decouple_loss:0.012575604021549225
Iteration: 1960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45164865255355835, gen p mean: 0.0, mean p set: 0.4472704529762268
The modified gen p mean: 0.45318603515625, gen p mean: 0.0, mean p set: 0.44910773634910583
The modified gen p mean: 0.4517258107662201, gen p mean: 0.0, mean p set: 0.44846272468566895
loss_pred:0.02885613404214382, decouple_loss:0.012840830720961094
loss_pred:0.026688067242503166, decouple_loss:0.012689454481005669
loss_pred:0.025992868468165398, decouple_loss:0.012579896487295628
2023-05-03 03:30:59 testing...
The modified gen p mean: 0.4543202817440033, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.445540189743042, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45099085569381714, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.027703095227479935, decouple_loss:0.012909816578030586
loss_pred:0.028991619125008583, decouple_loss:0.013117661699652672loss_pred:0.028047529980540276, decouple_loss:0.01263500191271305
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02889179065823555, avg_mse: 0.033399663865566254
current test mse: 0.0334
Iteration: 1961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521987736225128, gen p mean: 0.0, mean p set: 0.45123034715652466
The modified gen p mean: 0.4569823145866394, gen p mean: 0.0, mean p set: 0.45067334175109863
loss_pred:0.027151435613632202, decouple_loss:0.012450089678168297
loss_pred:0.027397047728300095, decouple_loss:0.012761843390762806
The modified gen p mean: 0.44668930768966675, gen p mean: 0.0, mean p set: 0.4493709206581116
loss_pred:0.02747151628136635, decouple_loss:0.01257593184709549
Iteration: 1962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44498711824417114, gen p mean: 0.0, mean p set: 0.447174608707428
The modified gen p mean: 0.4447695314884186, gen p mean: 0.0, mean p set: 0.44910797476768494
The modified gen p mean: 0.45342856645584106, gen p mean: 0.0, mean p set: 0.4504365622997284
loss_pred:0.02914973720908165, decouple_loss:0.013056066818535328
loss_pred:0.026691241189837456, decouple_loss:0.012353555299341679
loss_pred:0.02629944682121277, decouple_loss:0.012569703161716461
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
NaN value num: 0
Iteration: 1963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485638439655304, gen p mean: 0.0, mean p set: 0.44677734375
The modified gen p mean: 0.4481621980667114, gen p mean: 0.0, mean p set: 0.4480871260166168
The modified gen p mean: 0.44525304436683655, gen p mean: 0.0, mean p set: 0.4465934634208679
loss_pred:0.029378017410635948, decouple_loss:0.013722042553126812
loss_pred:0.02889571711421013, decouple_loss:0.013829302042722702
loss_pred:0.029132526367902756, decouple_loss:0.013430560939013958
Iteration: 1964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512849748134613, gen p mean: 0.0, mean p set: 0.4477900266647339
The modified gen p mean: 0.44784271717071533, gen p mean: 0.0, mean p set: 0.4483503997325897
loss_pred:0.029092079028487206, decouple_loss:0.013593077659606934
The modified gen p mean: 0.44254404306411743, gen p mean: 0.0, mean p set: 0.4473479390144348
loss_pred:0.02874748781323433, decouple_loss:0.01364511251449585
loss_pred:0.029818831011652946, decouple_loss:0.014339673332870007
Iteration: 1965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44499287009239197, gen p mean: 0.0, mean p set: 0.44828227162361145
The modified gen p mean: 0.4465036690235138, gen p mean: 0.0, mean p set: 0.44818708300590515
The modified gen p mean: 0.44563645124435425, gen p mean: 0.0, mean p set: 0.44717922806739807
loss_pred:0.03031868487596512, decouple_loss:0.013818849809467793
loss_pred:0.02915508672595024, decouple_loss:0.013452974148094654
loss_pred:0.029720120131969452, decouple_loss:0.0133687574416399
Iteration: 1966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654855132102966, gen p mean: 0.0, mean p set: 0.44829463958740234
The modified gen p mean: 0.4526241719722748, gen p mean: 0.0, mean p set: 0.44743436574935913
The modified gen p mean: 0.4488758444786072, gen p mean: 0.0, mean p set: 0.4484359920024872
loss_pred:0.02988334372639656, decouple_loss:0.013445936143398285
loss_pred:0.028074832633137703, decouple_loss:0.012824691832065582
loss_pred:0.028537172824144363, decouple_loss:0.012963799759745598
Iteration: 1967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873175024986267, gen p mean: 0.0, mean p set: 0.44776445627212524The modified gen p mean: 0.4522496461868286, gen p mean: 0.0, mean p set: 0.44839179515838623
The modified gen p mean: 0.44815880060195923, gen p mean: 0.0, mean p set: 0.4464368224143982
loss_pred:0.03024590201675892, decouple_loss:0.012848650105297565
loss_pred:0.02883794903755188, decouple_loss:0.013470211066305637
loss_pred:0.0290377177298069, decouple_loss:0.013594899326562881
Iteration: 1968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4413225054740906, gen p mean: 0.0, mean p set: 0.4478640854358673
The modified gen p mean: 0.43615978956222534, gen p mean: 0.0, mean p set: 0.4469445049762726
The modified gen p mean: 0.44246330857276917, gen p mean: 0.0, mean p set: 0.4461243748664856
loss_pred:0.0295033548027277, decouple_loss:0.0129051199182868
loss_pred:0.02866802178323269, decouple_loss:0.013185431249439716
loss_pred:0.028932683169841766, decouple_loss:0.012992811389267445
Iteration: 1969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959378242492676, gen p mean: 0.0, mean p set: 0.44774138927459717
The modified gen p mean: 0.4389130473136902, gen p mean: 0.0, mean p set: 0.44746658205986023
The modified gen p mean: 0.4446278512477875, gen p mean: 0.0, mean p set: 0.44863349199295044
loss_pred:0.029686283320188522, decouple_loss:0.01290271058678627
loss_pred:0.029532717540860176, decouple_loss:0.013355809263885021
loss_pred:0.02879299409687519, decouple_loss:0.012520787306129932
Iteration: 1970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4574753940105438, gen p mean: 0.0, mean p set: 0.44735562801361084
The modified gen p mean: 0.45990100502967834, gen p mean: 0.0, mean p set: 0.44848719239234924
The modified gen p mean: 0.46003785729408264, gen p mean: 0.0, mean p set: 0.4474555552005768
loss_pred:0.02847459353506565, decouple_loss:0.012607068754732609loss_pred:0.029034188017249107, decouple_loss:0.013352146372199059
loss_pred:0.029369710013270378, decouple_loss:0.012872204184532166
2023-05-03 03:35:21 testing...
The modified gen p mean: 0.4575209319591522, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4484090209007263, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4540780186653137, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.027660483494400978, decouple_loss:0.013260689564049244
loss_pred:0.02806163765490055, decouple_loss:0.013042720034718513loss_pred:0.028997430577874184, decouple_loss:0.013540223240852356
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028903912752866745, avg_mse: 0.03345465287566185
current test mse: 0.033455
Iteration: 1971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201563835144043, gen p mean: 0.0, mean p set: 0.4481818377971649
The modified gen p mean: 0.45240816473960876, gen p mean: 0.0, mean p set: 0.4459685981273651
loss_pred:0.02896314300596714, decouple_loss:0.012759702280163765
loss_pred:0.028614254668354988, decouple_loss:0.012672727927565575
The modified gen p mean: 0.4550541043281555, gen p mean: 0.0, mean p set: 0.44690072536468506
loss_pred:0.028742380440235138, decouple_loss:0.012879797257483006
Iteration: 1972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4385928213596344, gen p mean: 0.0, mean p set: 0.4478198289871216
The modified gen p mean: 0.43822088837623596, gen p mean: 0.0, mean p set: 0.4477398097515106
The modified gen p mean: 0.43279072642326355, gen p mean: 0.0, mean p set: 0.4475182592868805
loss_pred:0.0279935821890831, decouple_loss:0.01216703187674284
loss_pred:0.029840145260095596, decouple_loss:0.012150337919592857
loss_pred:0.029809925705194473, decouple_loss:0.012873356230556965
Iteration: 1973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44541019201278687, gen p mean: 0.0, mean p set: 0.44849371910095215
The modified gen p mean: 0.4468819200992584, gen p mean: 0.0, mean p set: 0.448914498090744
The modified gen p mean: 0.4454370439052582, gen p mean: 0.0, mean p set: 0.44874683022499084
loss_pred:0.029071686789393425, decouple_loss:0.012098259292542934
loss_pred:0.028872789815068245, decouple_loss:0.012733661569654942
loss_pred:0.028345515951514244, decouple_loss:0.012227206490933895
Iteration: 1974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076531171798706, gen p mean: 0.0, mean p set: 0.44857561588287354
The modified gen p mean: 0.44927939772605896, gen p mean: 0.0, mean p set: 0.4469192922115326
The modified gen p mean: 0.44302627444267273, gen p mean: 0.0, mean p set: 0.446853369474411
loss_pred:0.030251169577240944, decouple_loss:0.012690002098679543
loss_pred:0.0286289993673563, decouple_loss:0.012574269436299801
loss_pred:0.029074471443891525, decouple_loss:0.012742712162435055
Iteration: 1975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520170986652374, gen p mean: 0.0, mean p set: 0.44915181398391724
The modified gen p mean: 0.449727326631546, gen p mean: 0.0, mean p set: 0.4480923116207123
The modified gen p mean: 0.45497751235961914, gen p mean: 0.0, mean p set: 0.4465792179107666
loss_pred:0.028731193393468857, decouple_loss:0.012567952275276184
loss_pred:0.029231583699584007, decouple_loss:0.012465416453778744
loss_pred:0.028890514746308327, decouple_loss:0.012477494776248932
Iteration: 1976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4447267949581146, gen p mean: 0.0, mean p set: 0.44721341133117676
The modified gen p mean: 0.4471767544746399, gen p mean: 0.0, mean p set: 0.4469434916973114
The modified gen p mean: 0.44385841488838196, gen p mean: 0.0, mean p set: 0.4482823610305786
loss_pred:0.028851794078946114, decouple_loss:0.012183458544313908
loss_pred:0.029240991920232773, decouple_loss:0.012363455258309841
loss_pred:0.02867264486849308, decouple_loss:0.012221244163811207
Iteration: 1977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446828156709671, gen p mean: 0.0, mean p set: 0.4474962055683136
The modified gen p mean: 0.4480273425579071, gen p mean: 0.0, mean p set: 0.4466714859008789
The modified gen p mean: 0.4444577991962433, gen p mean: 0.0, mean p set: 0.4475840926170349
loss_pred:0.02927941270172596, decouple_loss:0.01239319983869791
loss_pred:0.028572918847203255, decouple_loss:0.011558378115296364
loss_pred:0.027987675741314888, decouple_loss:0.012293540872633457
Iteration: 1978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507547914981842, gen p mean: 0.0, mean p set: 0.4483303725719452
The modified gen p mean: 0.4494781196117401, gen p mean: 0.0, mean p set: 0.44722142815589905
The modified gen p mean: 0.45250117778778076, gen p mean: 0.0, mean p set: 0.4469677805900574
loss_pred:0.02895260602235794, decouple_loss:0.011374253779649734
loss_pred:0.029913585633039474, decouple_loss:0.012382695451378822
loss_pred:0.02880135178565979, decouple_loss:0.012358500622212887
Iteration: 1979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469475746154785, gen p mean: 0.0, mean p set: 0.4465617835521698
The modified gen p mean: 0.4469480812549591, gen p mean: 0.0, mean p set: 0.44712120294570923
loss_pred:0.028586339205503464, decouple_loss:0.011610514484345913
The modified gen p mean: 0.4425521492958069, gen p mean: 0.0, mean p set: 0.44747358560562134
loss_pred:0.02970769815146923, decouple_loss:0.011892198584973812
loss_pred:0.028613725677132607, decouple_loss:0.012085887603461742
Iteration: 1980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43732550740242004, gen p mean: 0.0, mean p set: 0.4478553533554077
The modified gen p mean: 0.44589391350746155, gen p mean: 0.0, mean p set: 0.446098268032074
The modified gen p mean: 0.4455454349517822, gen p mean: 0.0, mean p set: 0.4476066827774048
loss_pred:0.029450759291648865, decouple_loss:0.011885597370564938
loss_pred:0.02833583392202854, decouple_loss:0.011839003302156925
loss_pred:0.02817823737859726, decouple_loss:0.01258997991681099
2023-05-03 03:39:05 testing...
The modified gen p mean: 0.4493994414806366, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4439529478549957, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45257866382598877, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027962900698184967, decouple_loss:0.012504657730460167
loss_pred:0.028948873281478882, decouple_loss:0.012912825681269169
loss_pred:0.027568204328417778, decouple_loss:0.012517805211246014
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02879224717617035, avg_mse: 0.03337208554148674
current test mse: 0.033372
Iteration: 1981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470798075199127, gen p mean: 0.0, mean p set: 0.44842231273651123
The modified gen p mean: 0.4503299295902252, gen p mean: 0.0, mean p set: 0.44727540016174316
loss_pred:0.02976793423295021, decouple_loss:0.011719860136508942
loss_pred:0.028501935303211212, decouple_loss:0.012296291999518871
The modified gen p mean: 0.4462257921695709, gen p mean: 0.0, mean p set: 0.4482041299343109
loss_pred:0.027797071263194084, decouple_loss:0.0115518094971776
Iteration: 1982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4585646986961365, gen p mean: 0.0, mean p set: 0.4474189281463623
The modified gen p mean: 0.4516833424568176, gen p mean: 0.0, mean p set: 0.44789573550224304
loss_pred:0.028504373505711555, decouple_loss:0.01180317159742117
The modified gen p mean: 0.4548286199569702, gen p mean: 0.0, mean p set: 0.44704926013946533
loss_pred:0.02932295948266983, decouple_loss:0.011414878070354462
loss_pred:0.029280059039592743, decouple_loss:0.011577864177525043
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
Iteration: 1983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449413925409317, gen p mean: 0.0, mean p set: 0.44852498173713684
The modified gen p mean: 0.45010533928871155, gen p mean: 0.0, mean p set: 0.44840726256370544
The modified gen p mean: 0.44586876034736633, gen p mean: 0.0, mean p set: 0.44817250967025757
loss_pred:0.028551390394568443, decouple_loss:0.01213984377682209
loss_pred:0.028418967500329018, decouple_loss:0.012598929926753044
loss_pred:0.028562350198626518, decouple_loss:0.011924263089895248
Iteration: 1984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4408676326274872, gen p mean: 0.0, mean p set: 0.447822630405426
The modified gen p mean: 0.44120824337005615, gen p mean: 0.0, mean p set: 0.44792816042900085
The modified gen p mean: 0.4383624792098999, gen p mean: 0.0, mean p set: 0.44775745272636414
loss_pred:0.02761160582304001, decouple_loss:0.011987322941422462
loss_pred:0.027505148202180862, decouple_loss:0.011729077436029911
loss_pred:0.02772883139550686, decouple_loss:0.01217564195394516
Iteration: 1985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45266181230545044, gen p mean: 0.0, mean p set: 0.4486773908138275
The modified gen p mean: 0.4513784348964691, gen p mean: 0.0, mean p set: 0.447177916765213
loss_pred:0.02766789123415947, decouple_loss:0.01149856485426426
The modified gen p mean: 0.448408305644989, gen p mean: 0.0, mean p set: 0.4477651119232178
loss_pred:0.027491983026266098, decouple_loss:0.011927308514714241
loss_pred:0.028021611273288727, decouple_loss:0.011486045084893703
Iteration: 1986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453718900680542, gen p mean: 0.0, mean p set: 0.44832247495651245
The modified gen p mean: 0.4497399628162384, gen p mean: 0.0, mean p set: 0.44843369722366333
The modified gen p mean: 0.4498940408229828, gen p mean: 0.0, mean p set: 0.4465450048446655
loss_pred:0.02871558628976345, decouple_loss:0.011376675218343735
loss_pred:0.027711806818842888, decouple_loss:0.011762971058487892
loss_pred:0.028359780088067055, decouple_loss:0.011835508979856968
Iteration: 1987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4383274018764496, gen p mean: 0.0, mean p set: 0.449113667011261
The modified gen p mean: 0.44495365023612976, gen p mean: 0.0, mean p set: 0.4491317868232727
The modified gen p mean: 0.44693461060523987, gen p mean: 0.0, mean p set: 0.4467467665672302
loss_pred:0.028595754876732826, decouple_loss:0.011943737976253033
loss_pred:0.027691779658198357, decouple_loss:0.011451390571892262
loss_pred:0.02792907878756523, decouple_loss:0.012045483104884624
Iteration: 1988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479963779449463, gen p mean: 0.0, mean p set: 0.44857946038246155
The modified gen p mean: 0.4503166973590851, gen p mean: 0.0, mean p set: 0.44713273644447327
The modified gen p mean: 0.4452875554561615, gen p mean: 0.0, mean p set: 0.44667288661003113
loss_pred:0.027430029585957527, decouple_loss:0.011146902106702328
loss_pred:0.027979684993624687, decouple_loss:0.011215576902031898
loss_pred:0.02779650129377842, decouple_loss:0.011576644144952297
Iteration: 1989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832727313041687, gen p mean: 0.0, mean p set: 0.4478101134300232
The modified gen p mean: 0.45199495553970337, gen p mean: 0.0, mean p set: 0.4479508101940155
The modified gen p mean: 0.4464253783226013, gen p mean: 0.0, mean p set: 0.4468037486076355
loss_pred:0.028279293328523636, decouple_loss:0.011549707502126694
loss_pred:0.02821182832121849, decouple_loss:0.011698685586452484
loss_pred:0.02847944013774395, decouple_loss:0.011599224992096424
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44312387704849243, gen p mean: 0.0, mean p set: 0.4485393166542053
The modified gen p mean: 0.44389307498931885, gen p mean: 0.0, mean p set: 0.4471621811389923
The modified gen p mean: 0.44864797592163086, gen p mean: 0.0, mean p set: 0.4460587203502655
loss_pred:0.02788069099187851, decouple_loss:0.012167789041996002
loss_pred:0.028274761512875557, decouple_loss:0.012220903299748898
loss_pred:0.027468586340546608, decouple_loss:0.012036058120429516
2023-05-03 03:43:25 testing...
The modified gen p mean: 0.44437792897224426, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4527740478515625, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4496996998786926, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.028909774497151375, decouple_loss:0.012274217791855335
loss_pred:0.02762407250702381, decouple_loss:0.012222308665513992
loss_pred:0.027933066710829735, decouple_loss:0.01200422178953886
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028763985261321068, avg_mse: 0.033361177891492844
current test mse: 0.033361
Iteration: 1991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521850645542145, gen p mean: 0.0, mean p set: 0.4481382668018341
loss_pred:0.027698423713445663, decouple_loss:0.011556465178728104
The modified gen p mean: 0.45274782180786133, gen p mean: 0.0, mean p set: 0.4469052851200104
loss_pred:0.027757225558161736, decouple_loss:0.012109371833503246
The modified gen p mean: 0.4475865364074707, gen p mean: 0.0, mean p set: 0.44780153036117554
loss_pred:0.029309803619980812, decouple_loss:0.011749562807381153
Iteration: 1992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44598388671875, gen p mean: 0.0, mean p set: 0.446336567401886
The modified gen p mean: 0.44353336095809937, gen p mean: 0.0, mean p set: 0.44781988859176636
The modified gen p mean: 0.4482111632823944, gen p mean: 0.0, mean p set: 0.44834527373313904
loss_pred:0.02730235457420349, decouple_loss:0.011441371403634548
loss_pred:0.028579778969287872, decouple_loss:0.011276337318122387
loss_pred:0.028372013941407204, decouple_loss:0.011271452531218529
Iteration: 1993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4445894658565521, gen p mean: 0.0, mean p set: 0.4471730887889862
The modified gen p mean: 0.44957271218299866, gen p mean: 0.0, mean p set: 0.4485742151737213
The modified gen p mean: 0.44297051429748535, gen p mean: 0.0, mean p set: 0.4477926790714264
loss_pred:0.028655599802732468, decouple_loss:0.011613178998231888
loss_pred:0.02717769332230091, decouple_loss:0.01143546961247921
loss_pred:0.027902329340577126, decouple_loss:0.011298488825559616
Iteration: 1994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479827284812927, gen p mean: 0.0, mean p set: 0.4484725892543793
The modified gen p mean: 0.44844868779182434, gen p mean: 0.0, mean p set: 0.44832614064216614
The modified gen p mean: 0.4485267102718353, gen p mean: 0.0, mean p set: 0.4486536979675293
loss_pred:0.027199212461709976, decouple_loss:0.01131288893520832
loss_pred:0.02705118991434574, decouple_loss:0.011690613813698292
loss_pred:0.027297042310237885, decouple_loss:0.01124984584748745
Iteration: 1995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44135451316833496, gen p mean: 0.0, mean p set: 0.44715774059295654
The modified gen p mean: 0.443340003490448, gen p mean: 0.0, mean p set: 0.4471103250980377
The modified gen p mean: 0.4411187171936035, gen p mean: 0.0, mean p set: 0.44811320304870605
loss_pred:0.02811047062277794, decouple_loss:0.011199143715202808
loss_pred:0.029258860275149345, decouple_loss:0.011166701093316078
loss_pred:0.02756318636238575, decouple_loss:0.011481272988021374
Iteration: 1996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45998334884643555, gen p mean: 0.0, mean p set: 0.44764673709869385
The modified gen p mean: 0.46039220690727234, gen p mean: 0.0, mean p set: 0.44820424914360046
The modified gen p mean: 0.4606451988220215, gen p mean: 0.0, mean p set: 0.4480930268764496
loss_pred:0.028301501646637917, decouple_loss:0.011552862823009491
loss_pred:0.0283331461250782, decouple_loss:0.011727687902748585
loss_pred:0.029067011550068855, decouple_loss:0.011350436136126518
Iteration: 1997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502250850200653, gen p mean: 0.0, mean p set: 0.4483456313610077
The modified gen p mean: 0.44578731060028076, gen p mean: 0.0, mean p set: 0.44875964522361755
The modified gen p mean: 0.44876742362976074, gen p mean: 0.0, mean p set: 0.4474954903125763
loss_pred:0.027958018705248833, decouple_loss:0.011465109884738922
loss_pred:0.027087820693850517, decouple_loss:0.011037002317607403
loss_pred:0.028976112604141235, decouple_loss:0.01109982654452324
Iteration: 1998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43199899792671204, gen p mean: 0.0, mean p set: 0.44810402393341064
The modified gen p mean: 0.4395328760147095, gen p mean: 0.0, mean p set: 0.4485970735549927
loss_pred:0.027121542021632195, decouple_loss:0.011157786473631859
The modified gen p mean: 0.4353468716144562, gen p mean: 0.0, mean p set: 0.44860827922821045
loss_pred:0.02718246914446354, decouple_loss:0.011308765970170498
loss_pred:0.027918467298150063, decouple_loss:0.011447455734014511
Iteration: 1999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468435049057007, gen p mean: 0.0, mean p set: 0.4473235309123993
The modified gen p mean: 0.45180806517601013, gen p mean: 0.0, mean p set: 0.4476746618747711
The modified gen p mean: 0.4522576928138733, gen p mean: 0.0, mean p set: 0.44799429178237915
loss_pred:0.028159460052847862, decouple_loss:0.011232079938054085
loss_pred:0.027966545894742012, decouple_loss:0.011493753641843796
loss_pred:0.027214206755161285, decouple_loss:0.011363771744072437
Iteration: 2000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46173420548439026, gen p mean: 0.0, mean p set: 0.44651728868484497
The modified gen p mean: 0.4604460299015045, gen p mean: 0.0, mean p set: 0.4488171935081482
The modified gen p mean: 0.46015840768814087, gen p mean: 0.0, mean p set: 0.4480171501636505
loss_pred:0.02748066373169422, decouple_loss:0.011743605136871338
loss_pred:0.027439307421445847, decouple_loss:0.011325247585773468
loss_pred:0.02829187549650669, decouple_loss:0.011061623692512512
2023-05-03 03:47:05 itr: 2000
training loss: [0.02884496 0.02800557 0.02806784]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_0_EH_0_PS_40_6/model_2000.ckpt
2023-05-03 03:47:10 testing...
The modified gen p mean: 0.4384887218475342, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4468870162963867, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4442022442817688, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.028958909213542938, decouple_loss:0.012258708477020264
loss_pred:0.027568567544221878, decouple_loss:0.01201996486634016
loss_pred:0.027974406257271767, decouple_loss:0.01179700531065464
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02876855432987213, avg_mse: 0.03342749923467636
current test mse: 0.033428
Iteration: 2001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43946531414985657, gen p mean: 0.0, mean p set: 0.44830334186553955
The modified gen p mean: 0.444859117269516, gen p mean: 0.0, mean p set: 0.44773492217063904
loss_pred:0.027739616110920906, decouple_loss:0.011883881874382496
loss_pred:0.02780880033969879, decouple_loss:0.010937856510281563
The modified gen p mean: 0.44144928455352783, gen p mean: 0.0, mean p set: 0.447241872549057
loss_pred:0.028210368007421494, decouple_loss:0.011705799028277397
Iteration: 2002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4370840787887573, gen p mean: 0.0, mean p set: 0.44781628251075745
The modified gen p mean: 0.4344209134578705, gen p mean: 0.0, mean p set: 0.4486377537250519
The modified gen p mean: 0.4436798393726349, gen p mean: 0.0, mean p set: 0.4487995207309723
loss_pred:0.028667237609624863, decouple_loss:0.011505809612572193
loss_pred:0.028034498915076256, decouple_loss:0.011445024982094765
loss_pred:0.028719676658511162, decouple_loss:0.011790004558861256
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
NaN value num: 0
Iteration: 2003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537591338157654, gen p mean: 0.0, mean p set: 0.4466691315174103
The modified gen p mean: 0.4561976492404938, gen p mean: 0.0, mean p set: 0.4466463625431061
The modified gen p mean: 0.4558517038822174, gen p mean: 0.0, mean p set: 0.4476608335971832
loss_pred:0.030345937237143517, decouple_loss:0.012327275238931179
loss_pred:0.02759840153157711, decouple_loss:0.011596840806305408
loss_pred:0.03006475232541561, decouple_loss:0.012251731008291245
Iteration: 2004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45250189304351807, gen p mean: 0.0, mean p set: 0.4479246735572815
The modified gen p mean: 0.45226162672042847, gen p mean: 0.0, mean p set: 0.4478538930416107
The modified gen p mean: 0.45310407876968384, gen p mean: 0.0, mean p set: 0.44854697585105896
loss_pred:0.030867354944348335, decouple_loss:0.011912207119166851
loss_pred:0.028886878862977028, decouple_loss:0.011382759548723698
loss_pred:0.03014180064201355, decouple_loss:0.012698543258011341
Iteration: 2005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4424164593219757, gen p mean: 0.0, mean p set: 0.447025865316391
The modified gen p mean: 0.44293612241744995, gen p mean: 0.0, mean p set: 0.44863274693489075
loss_pred:0.028107918798923492, decouple_loss:0.011441359296441078
The modified gen p mean: 0.4457249641418457, gen p mean: 0.0, mean p set: 0.44877323508262634
loss_pred:0.030015146359801292, decouple_loss:0.011912052519619465
loss_pred:0.029769307002425194, decouple_loss:0.0121691282838583
Iteration: 2006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43530750274658203, gen p mean: 0.0, mean p set: 0.4480341970920563
The modified gen p mean: 0.4413313567638397, gen p mean: 0.0, mean p set: 0.4482869803905487
The modified gen p mean: 0.4374275207519531, gen p mean: 0.0, mean p set: 0.4479101598262787
loss_pred:0.03130139783024788, decouple_loss:0.01245955377817154
loss_pred:0.029656294733285904, decouple_loss:0.0121331587433815
loss_pred:0.031149066984653473, decouple_loss:0.012322108261287212
Iteration: 2007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45531344413757324, gen p mean: 0.0, mean p set: 0.4479345977306366
The modified gen p mean: 0.4555707573890686, gen p mean: 0.0, mean p set: 0.44771403074264526
The modified gen p mean: 0.456026166677475, gen p mean: 0.0, mean p set: 0.44612136483192444
loss_pred:0.029889924451708794, decouple_loss:0.011728784069418907
loss_pred:0.029581747949123383, decouple_loss:0.012130429036915302
loss_pred:0.02989085391163826, decouple_loss:0.01185267511755228
Iteration: 2008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504414200782776, gen p mean: 0.0, mean p set: 0.448962926864624
The modified gen p mean: 0.4518698453903198, gen p mean: 0.0, mean p set: 0.44744452834129333
The modified gen p mean: 0.45283573865890503, gen p mean: 0.0, mean p set: 0.4480665326118469
loss_pred:0.030172860249876976, decouple_loss:0.011459046974778175
loss_pred:0.02937270514667034, decouple_loss:0.01151188462972641
loss_pred:0.027838990092277527, decouple_loss:0.011429625563323498
Iteration: 2009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4390178620815277, gen p mean: 0.0, mean p set: 0.44977301359176636
The modified gen p mean: 0.4388185441493988, gen p mean: 0.0, mean p set: 0.4471576511859894
The modified gen p mean: 0.43896934390068054, gen p mean: 0.0, mean p set: 0.44760507345199585
loss_pred:0.029384639114141464, decouple_loss:0.01174455787986517
loss_pred:0.029273707419633865, decouple_loss:0.01130727119743824
loss_pred:0.028073318302631378, decouple_loss:0.011481573805212975
Iteration: 2010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730642437934875, gen p mean: 0.0, mean p set: 0.4469749927520752
The modified gen p mean: 0.4462142288684845, gen p mean: 0.0, mean p set: 0.4481455683708191
The modified gen p mean: 0.44800063967704773, gen p mean: 0.0, mean p set: 0.448795348405838
loss_pred:0.030400069430470467, decouple_loss:0.011657889932394028
loss_pred:0.030308164656162262, decouple_loss:0.012230979278683662
loss_pred:0.029154621064662933, decouple_loss:0.011539445258677006
2023-05-03 03:51:35 testing...
The modified gen p mean: 0.45533376932144165, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4503123164176941, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45762577652931213, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028061790391802788, decouple_loss:0.012439506128430367
loss_pred:0.029041824862360954, decouple_loss:0.012782922014594078
loss_pred:0.027648819610476494, decouple_loss:0.012374245561659336
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028877422213554382, avg_mse: 0.03359195962548256
current test mse: 0.033592
Iteration: 2011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4598318636417389, gen p mean: 0.0, mean p set: 0.44879260659217834
The modified gen p mean: 0.4540756344795227, gen p mean: 0.0, mean p set: 0.4488610029220581
loss_pred:0.029924051836133003, decouple_loss:0.011974983848631382
loss_pred:0.030755287036299706, decouple_loss:0.01185123436152935
The modified gen p mean: 0.4564020335674286, gen p mean: 0.0, mean p set: 0.44866740703582764
loss_pred:0.029308298602700233, decouple_loss:0.011696855537593365
Iteration: 2012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4437480568885803, gen p mean: 0.0, mean p set: 0.44819167256355286
The modified gen p mean: 0.4444410502910614, gen p mean: 0.0, mean p set: 0.44635701179504395
The modified gen p mean: 0.4452084004878998, gen p mean: 0.0, mean p set: 0.44661614298820496
loss_pred:0.030360398814082146, decouple_loss:0.011499131098389626
loss_pred:0.029866591095924377, decouple_loss:0.011914213187992573
loss_pred:0.03033575788140297, decouple_loss:0.01171210128813982
Iteration: 2013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44330349564552307, gen p mean: 0.0, mean p set: 0.4473411440849304
The modified gen p mean: 0.44079867005348206, gen p mean: 0.0, mean p set: 0.44791483879089355
The modified gen p mean: 0.4431808292865753, gen p mean: 0.0, mean p set: 0.4476872384548187
loss_pred:0.029279764741659164, decouple_loss:0.011684590950608253
loss_pred:0.03079954907298088, decouple_loss:0.011738637462258339
loss_pred:0.029279042035341263, decouple_loss:0.012128185480833054
Iteration: 2014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488024115562439, gen p mean: 0.0, mean p set: 0.4471881687641144
The modified gen p mean: 0.45377013087272644, gen p mean: 0.0, mean p set: 0.44886404275894165
The modified gen p mean: 0.44625595211982727, gen p mean: 0.0, mean p set: 0.44697946310043335
loss_pred:0.02942248061299324, decouple_loss:0.011474793776869774
loss_pred:0.0298050194978714, decouple_loss:0.01161261834204197
loss_pred:0.029684389010071754, decouple_loss:0.011675100773572922
Iteration: 2015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514726996421814, gen p mean: 0.0, mean p set: 0.44764822721481323
The modified gen p mean: 0.4520895779132843, gen p mean: 0.0, mean p set: 0.44956785440444946
The modified gen p mean: 0.4527708888053894, gen p mean: 0.0, mean p set: 0.4475422501564026
loss_pred:0.02900097146630287, decouple_loss:0.01138325221836567
loss_pred:0.029201125726103783, decouple_loss:0.011083181947469711
loss_pred:0.029098933562636375, decouple_loss:0.011364679783582687
Iteration: 2016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471232295036316, gen p mean: 0.0, mean p set: 0.4472349286079407
The modified gen p mean: 0.4496275782585144, gen p mean: 0.0, mean p set: 0.44717782735824585
The modified gen p mean: 0.44707390666007996, gen p mean: 0.0, mean p set: 0.4477194845676422
loss_pred:0.02972438558936119, decouple_loss:0.011361836455762386
loss_pred:0.028915194794535637, decouple_loss:0.01130084227770567
loss_pred:0.02879241853952408, decouple_loss:0.011474508792161942
Iteration: 2017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44020017981529236, gen p mean: 0.0, mean p set: 0.4479401111602783
The modified gen p mean: 0.443854421377182, gen p mean: 0.0, mean p set: 0.4474906623363495
The modified gen p mean: 0.4437601566314697, gen p mean: 0.0, mean p set: 0.44779476523399353
loss_pred:0.030523136258125305, decouple_loss:0.011394424363970757
loss_pred:0.02762417308986187, decouple_loss:0.011516071856021881
loss_pred:0.02713734842836857, decouple_loss:0.011279353871941566
Iteration: 2018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463903307914734, gen p mean: 0.0, mean p set: 0.4492153227329254
The modified gen p mean: 0.44841650128364563, gen p mean: 0.0, mean p set: 0.4469953775405884
The modified gen p mean: 0.44433528184890747, gen p mean: 0.0, mean p set: 0.44808605313301086
loss_pred:0.030234772711992264, decouple_loss:0.011413403786718845
loss_pred:0.03049933724105358, decouple_loss:0.011867989785969257
loss_pred:0.030299624428153038, decouple_loss:0.01251225359737873
Iteration: 2019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45642009377479553, gen p mean: 0.0, mean p set: 0.4474611282348633
The modified gen p mean: 0.4502779543399811, gen p mean: 0.0, mean p set: 0.4475582540035248
The modified gen p mean: 0.4543526768684387, gen p mean: 0.0, mean p set: 0.4493623375892639
loss_pred:0.02882414497435093, decouple_loss:0.01094193384051323
loss_pred:0.03032144531607628, decouple_loss:0.011234934441745281
loss_pred:0.028533151373267174, decouple_loss:0.011668874882161617
Iteration: 2020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44698891043663025, gen p mean: 0.0, mean p set: 0.4475629925727844
The modified gen p mean: 0.44797220826148987, gen p mean: 0.0, mean p set: 0.44756677746772766
The modified gen p mean: 0.45012667775154114, gen p mean: 0.0, mean p set: 0.44862115383148193
loss_pred:0.028810832649469376, decouple_loss:0.011067795567214489
loss_pred:0.029801202937960625, decouple_loss:0.011520890519022942
loss_pred:0.02941521257162094, decouple_loss:0.01115020178258419
2023-05-03 03:55:20 testing...
The modified gen p mean: 0.4452474117279053, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44017156958580017, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4480270445346832, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027991630136966705, decouple_loss:0.0117695527151227
loss_pred:0.028956208378076553, decouple_loss:0.012217373587191105
loss_pred:0.027547519654035568, decouple_loss:0.011710030026733875
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028760068118572235, avg_mse: 0.03342460095882416
current test mse: 0.033425
Iteration: 2021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44431909918785095, gen p mean: 0.0, mean p set: 0.4480704367160797
The modified gen p mean: 0.4470047056674957, gen p mean: 0.0, mean p set: 0.4460543990135193
loss_pred:0.02865089289844036, decouple_loss:0.01117294654250145
loss_pred:0.02958855777978897, decouple_loss:0.011560957878828049
The modified gen p mean: 0.4458431899547577, gen p mean: 0.0, mean p set: 0.44881540536880493
loss_pred:0.029064176604151726, decouple_loss:0.010668324306607246
Iteration: 2022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480327069759369, gen p mean: 0.0, mean p set: 0.4479564428329468
The modified gen p mean: 0.44637688994407654, gen p mean: 0.0, mean p set: 0.44857820868492126
The modified gen p mean: 0.4466060996055603, gen p mean: 0.0, mean p set: 0.4477544128894806
loss_pred:0.029823705554008484, decouple_loss:0.011063613928854465
loss_pred:0.029445819556713104, decouple_loss:0.011077091097831726
loss_pred:0.029399167746305466, decouple_loss:0.011321600526571274
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 2023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498814344406128, gen p mean: 0.0, mean p set: 0.45062586665153503
The modified gen p mean: 0.45128723978996277, gen p mean: 0.0, mean p set: 0.4500381648540497
The modified gen p mean: 0.4493195712566376, gen p mean: 0.0, mean p set: 0.4508611261844635
loss_pred:0.028079912066459656, decouple_loss:0.011434782296419144
loss_pred:0.029373105615377426, decouple_loss:0.012035156600177288
loss_pred:0.028088562190532684, decouple_loss:0.01155298762023449
Iteration: 2024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664955139160156, gen p mean: 0.0, mean p set: 0.45038241147994995
The modified gen p mean: 0.44814833998680115, gen p mean: 0.0, mean p set: 0.45067691802978516
The modified gen p mean: 0.44609418511390686, gen p mean: 0.0, mean p set: 0.4507182538509369
loss_pred:0.028510892763733864, decouple_loss:0.011601361446082592
loss_pred:0.028960276395082474, decouple_loss:0.012073157355189323
loss_pred:0.02828928455710411, decouple_loss:0.011639408767223358
Iteration: 2025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4566924571990967, gen p mean: 0.0, mean p set: 0.4507621228694916
The modified gen p mean: 0.4505101442337036, gen p mean: 0.0, mean p set: 0.4491656422615051
The modified gen p mean: 0.4540349841117859, gen p mean: 0.0, mean p set: 0.45036831498146057
loss_pred:0.028640765696763992, decouple_loss:0.011507132090628147loss_pred:0.029081109911203384, decouple_loss:0.011782408691942692
loss_pred:0.028070753440260887, decouple_loss:0.011998201720416546
Iteration: 2026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45785900950431824, gen p mean: 0.0, mean p set: 0.4504148066043854
The modified gen p mean: 0.45230644941329956, gen p mean: 0.0, mean p set: 0.45116761326789856
The modified gen p mean: 0.45175701379776, gen p mean: 0.0, mean p set: 0.45014673471450806
loss_pred:0.02874678559601307, decouple_loss:0.011271294206380844
loss_pred:0.02933051437139511, decouple_loss:0.011489118449389935
loss_pred:0.027680302038788795, decouple_loss:0.011096321046352386
Iteration: 2027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44618791341781616, gen p mean: 0.0, mean p set: 0.4512575566768646
The modified gen p mean: 0.44511520862579346, gen p mean: 0.0, mean p set: 0.4491928219795227
The modified gen p mean: 0.4510717988014221, gen p mean: 0.0, mean p set: 0.4493815302848816
loss_pred:0.027938324958086014, decouple_loss:0.010756358504295349
loss_pred:0.027633560821413994, decouple_loss:0.011166844516992569
loss_pred:0.028482217341661453, decouple_loss:0.011059867218136787
Iteration: 2028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4438683092594147, gen p mean: 0.0, mean p set: 0.45092761516571045
The modified gen p mean: 0.4419102966785431, gen p mean: 0.0, mean p set: 0.44988352060317993
The modified gen p mean: 0.4442199468612671, gen p mean: 0.0, mean p set: 0.44944941997528076
loss_pred:0.02820102497935295, decouple_loss:0.011209143325686455
loss_pred:0.02743501216173172, decouple_loss:0.010788043960928917
loss_pred:0.027937280014157295, decouple_loss:0.010778848081827164
Iteration: 2029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490378797054291, gen p mean: 0.0, mean p set: 0.45073747634887695
The modified gen p mean: 0.4556525647640228, gen p mean: 0.0, mean p set: 0.4498307704925537
The modified gen p mean: 0.45502495765686035, gen p mean: 0.0, mean p set: 0.4498143792152405
loss_pred:0.029066238552331924, decouple_loss:0.011791414581239223
loss_pred:0.028552787378430367, decouple_loss:0.011544764041900635
loss_pred:0.02854154445230961, decouple_loss:0.01127146277576685
Iteration: 2030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4567446708679199, gen p mean: 0.0, mean p set: 0.45006564259529114
The modified gen p mean: 0.4508107602596283, gen p mean: 0.0, mean p set: 0.4508230984210968
The modified gen p mean: 0.4530905485153198, gen p mean: 0.0, mean p set: 0.4511975646018982
loss_pred:0.028194865211844444, decouple_loss:0.01082304585725069
loss_pred:0.028281036764383316, decouple_loss:0.011330260895192623
loss_pred:0.02795310690999031, decouple_loss:0.011368594132363796
2023-05-03 03:59:39 testing...
The modified gen p mean: 0.45060259103775024, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4532729983329773, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4454133212566376, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.02770177274942398, decouple_loss:0.011264326982200146
loss_pred:0.02740006148815155, decouple_loss:0.011673510074615479
loss_pred:0.028631022199988365, decouple_loss:0.011443303897976875
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02848397195339203, avg_mse: 0.03310628980398178
current test mse: 0.033106
Iteration: 2031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628801941871643, gen p mean: 0.0, mean p set: 0.4502823054790497
The modified gen p mean: 0.45092085003852844, gen p mean: 0.0, mean p set: 0.4492048919200897
loss_pred:0.02789936400949955, decouple_loss:0.010804358869791031
loss_pred:0.027368176728487015, decouple_loss:0.010998989455401897
The modified gen p mean: 0.44916847348213196, gen p mean: 0.0, mean p set: 0.4506498873233795
loss_pred:0.028634369373321533, decouple_loss:0.011454116553068161
Iteration: 2032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45196712017059326, gen p mean: 0.0, mean p set: 0.4498307406902313
The modified gen p mean: 0.44561925530433655, gen p mean: 0.0, mean p set: 0.450583815574646
The modified gen p mean: 0.45109862089157104, gen p mean: 0.0, mean p set: 0.4503425657749176
loss_pred:0.028750663623213768, decouple_loss:0.010909590870141983loss_pred:0.02743949554860592, decouple_loss:0.01110533531755209
loss_pred:0.027868004515767097, decouple_loss:0.010866275988519192
Iteration: 2033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859668612480164, gen p mean: 0.0, mean p set: 0.4506319463253021
The modified gen p mean: 0.44333046674728394, gen p mean: 0.0, mean p set: 0.4513084292411804
The modified gen p mean: 0.4427328109741211, gen p mean: 0.0, mean p set: 0.4501415491104126
loss_pred:0.02846543677151203, decouple_loss:0.01085188239812851
loss_pred:0.028450394049286842, decouple_loss:0.011027530767023563
loss_pred:0.02820448949933052, decouple_loss:0.010830259881913662
Iteration: 2034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4544610381126404, gen p mean: 0.0, mean p set: 0.4499199688434601
The modified gen p mean: 0.45594605803489685, gen p mean: 0.0, mean p set: 0.44973650574684143
The modified gen p mean: 0.453305184841156, gen p mean: 0.0, mean p set: 0.4510757029056549
loss_pred:0.027921414002776146, decouple_loss:0.01105304155498743
loss_pred:0.02830207347869873, decouple_loss:0.01124867144972086
loss_pred:0.02898482047021389, decouple_loss:0.011246827431023121
Iteration: 2035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4629460573196411, gen p mean: 0.0, mean p set: 0.44972866773605347
The modified gen p mean: 0.4573718309402466, gen p mean: 0.0, mean p set: 0.4509483277797699
The modified gen p mean: 0.46213915944099426, gen p mean: 0.0, mean p set: 0.4495888352394104
loss_pred:0.028577378019690514, decouple_loss:0.011403150856494904
loss_pred:0.03000069223344326, decouple_loss:0.01129238773137331
loss_pred:0.02776247262954712, decouple_loss:0.011195136234164238
Iteration: 2036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4421738386154175, gen p mean: 0.0, mean p set: 0.451102077960968
The modified gen p mean: 0.44156670570373535, gen p mean: 0.0, mean p set: 0.4490925073623657
The modified gen p mean: 0.4446520507335663, gen p mean: 0.0, mean p set: 0.4496990144252777
loss_pred:0.02745959907770157, decouple_loss:0.011023754253983498
loss_pred:0.028883587568998337, decouple_loss:0.010880752466619015
loss_pred:0.02923263981938362, decouple_loss:0.010851835831999779
Iteration: 2037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44296517968177795, gen p mean: 0.0, mean p set: 0.4498342275619507
The modified gen p mean: 0.44326266646385193, gen p mean: 0.0, mean p set: 0.44995349645614624
The modified gen p mean: 0.43678805232048035, gen p mean: 0.0, mean p set: 0.4510018229484558
loss_pred:0.027992239221930504, decouple_loss:0.010753661394119263
loss_pred:0.028012268245220184, decouple_loss:0.010588782839477062
loss_pred:0.029916882514953613, decouple_loss:0.010826261714100838
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45642468333244324, gen p mean: 0.0, mean p set: 0.4502556622028351
The modified gen p mean: 0.4518311023712158, gen p mean: 0.0, mean p set: 0.45127072930336
The modified gen p mean: 0.4574134647846222, gen p mean: 0.0, mean p set: 0.4496159553527832
loss_pred:0.02840648591518402, decouple_loss:0.01093362644314766
loss_pred:0.028688285499811172, decouple_loss:0.011127185076475143
loss_pred:0.02834034524857998, decouple_loss:0.010801211930811405
Iteration: 2039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45311814546585083, gen p mean: 0.0, mean p set: 0.4491916298866272
The modified gen p mean: 0.452518105506897, gen p mean: 0.0, mean p set: 0.4502067267894745
The modified gen p mean: 0.4537235498428345, gen p mean: 0.0, mean p set: 0.44952836632728577
loss_pred:0.027678122743964195, decouple_loss:0.010910836979746819
loss_pred:0.027685968205332756, decouple_loss:0.01099264994263649
loss_pred:0.027340533211827278, decouple_loss:0.010817033238708973
Iteration: 2040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44547972083091736, gen p mean: 0.0, mean p set: 0.45056453347206116
The modified gen p mean: 0.44440603256225586, gen p mean: 0.0, mean p set: 0.44988662004470825
The modified gen p mean: 0.4492521584033966, gen p mean: 0.0, mean p set: 0.450135201215744
loss_pred:0.029399331659078598, decouple_loss:0.010805269703269005
loss_pred:0.027354592457413673, decouple_loss:0.01104220375418663
loss_pred:0.02786223776638508, decouple_loss:0.010625473223626614

2023-05-03 04:03:23 testing...
The modified gen p mean: 0.4482955038547516, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45600342750549316, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4535064399242401, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.028435325250029564, decouple_loss:0.011326692067086697
loss_pred:0.02718164399266243, decouple_loss:0.01143691223114729
loss_pred:0.02746603637933731, decouple_loss:0.011142571456730366
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028259437531232834, avg_mse: 0.03273017331957817
current test mse: 0.03273
Iteration: 2041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106449723243713, gen p mean: 0.0, mean p set: 0.45017993450164795
The modified gen p mean: 0.45297175645828247, gen p mean: 0.0, mean p set: 0.4486955404281616
loss_pred:0.02775992825627327, decouple_loss:0.010903777554631233
loss_pred:0.028471527621150017, decouple_loss:0.010538391768932343
The modified gen p mean: 0.45138561725616455, gen p mean: 0.0, mean p set: 0.4498046338558197
loss_pred:0.028230497613549232, decouple_loss:0.01099557988345623
Iteration: 2042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490939974784851, gen p mean: 0.0, mean p set: 0.45058757066726685
The modified gen p mean: 0.44964170455932617, gen p mean: 0.0, mean p set: 0.448609322309494
The modified gen p mean: 0.44538572430610657, gen p mean: 0.0, mean p set: 0.4506154954433441
loss_pred:0.02778521738946438, decouple_loss:0.010778381489217281
loss_pred:0.02843543514609337, decouple_loss:0.010476280935108662
loss_pred:0.027955135330557823, decouple_loss:0.010428198613226414
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
NaN value num: 0
Iteration: 2043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469720721244812, gen p mean: 0.0, mean p set: 0.44811415672302246
The modified gen p mean: 0.44934916496276855, gen p mean: 0.0, mean p set: 0.44756564497947693
The modified gen p mean: 0.4555114507675171, gen p mean: 0.0, mean p set: 0.4474250078201294
loss_pred:0.027755042538046837, decouple_loss:0.011011157184839249
loss_pred:0.029950592666864395, decouple_loss:0.012008465826511383
loss_pred:0.02970508486032486, decouple_loss:0.011727861128747463
Iteration: 2044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497818350791931, gen p mean: 0.0, mean p set: 0.44641000032424927
The modified gen p mean: 0.4583282172679901, gen p mean: 0.0, mean p set: 0.4478082060813904
The modified gen p mean: 0.4530830681324005, gen p mean: 0.0, mean p set: 0.44826972484588623
loss_pred:0.028764838352799416, decouple_loss:0.01119100209325552
loss_pred:0.02874162793159485, decouple_loss:0.012425596825778484
loss_pred:0.028187405318021774, decouple_loss:0.011488739401102066
Iteration: 2045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4352230727672577, gen p mean: 0.0, mean p set: 0.4478208124637604
The modified gen p mean: 0.4388653337955475, gen p mean: 0.0, mean p set: 0.44684502482414246
The modified gen p mean: 0.4365924000740051, gen p mean: 0.0, mean p set: 0.44662904739379883
loss_pred:0.02977587655186653, decouple_loss:0.01134890504181385
loss_pred:0.028321150690317154, decouple_loss:0.010683371685445309
loss_pred:0.02858317829668522, decouple_loss:0.011223833076655865
Iteration: 2046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43849605321884155, gen p mean: 0.0, mean p set: 0.4466526508331299
The modified gen p mean: 0.44700145721435547, gen p mean: 0.0, mean p set: 0.44906821846961975
The modified gen p mean: 0.44301551580429077, gen p mean: 0.0, mean p set: 0.44883307814598083
loss_pred:0.02817806787788868, decouple_loss:0.010777019895613194
loss_pred:0.02878686413168907, decouple_loss:0.011430736631155014
loss_pred:0.03055621311068535, decouple_loss:0.011551227420568466
Iteration: 2047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45127883553504944, gen p mean: 0.0, mean p set: 0.4489694833755493
The modified gen p mean: 0.4538646936416626, gen p mean: 0.0, mean p set: 0.4468248784542084
The modified gen p mean: 0.4556751549243927, gen p mean: 0.0, mean p set: 0.44882747530937195
loss_pred:0.030067885294556618, decouple_loss:0.011849015951156616
loss_pred:0.028276855126023293, decouple_loss:0.010998152196407318
loss_pred:0.030076829716563225, decouple_loss:0.011546405963599682
Iteration: 2048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4583141505718231, gen p mean: 0.0, mean p set: 0.44828951358795166
The modified gen p mean: 0.4539865553379059, gen p mean: 0.0, mean p set: 0.44762495160102844
The modified gen p mean: 0.45357459783554077, gen p mean: 0.0, mean p set: 0.4492294192314148
loss_pred:0.028406791388988495, decouple_loss:0.011525008827447891
loss_pred:0.028271062299609184, decouple_loss:0.011755787767469883
loss_pred:0.029971694573760033, decouple_loss:0.011327599175274372
Iteration: 2049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44191980361938477, gen p mean: 0.0, mean p set: 0.4487190544605255
The modified gen p mean: 0.4439142644405365, gen p mean: 0.0, mean p set: 0.4467630088329315
The modified gen p mean: 0.44065627455711365, gen p mean: 0.0, mean p set: 0.448250949382782
loss_pred:0.03002854995429516, decouple_loss:0.011645989492535591
loss_pred:0.028536321595311165, decouple_loss:0.011324791237711906
loss_pred:0.029814017936587334, decouple_loss:0.010728657245635986
Iteration: 2050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4425824284553528, gen p mean: 0.0, mean p set: 0.44799190759658813
The modified gen p mean: 0.43975991010665894, gen p mean: 0.0, mean p set: 0.44824743270874023
The modified gen p mean: 0.4426332414150238, gen p mean: 0.0, mean p set: 0.4468485414981842
loss_pred:0.027864865958690643, decouple_loss:0.0112066138535738
loss_pred:0.030218910425901413, decouple_loss:0.01090987492352724
loss_pred:0.028254548087716103, decouple_loss:0.010878872126340866
2023-05-03 04:07:44 testing...
The modified gen p mean: 0.4476715326309204, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4427473545074463, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4505782723426819, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02772187627851963, decouple_loss:0.011214401572942734
loss_pred:0.028662964701652527, decouple_loss:0.011682660318911076
loss_pred:0.027437882497906685, decouple_loss:0.011378852650523186
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028512172400951385, avg_mse: 0.03318260237574577
current test mse: 0.033183
Iteration: 2051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742074608802795, gen p mean: 0.0, mean p set: 0.446742981672287
loss_pred:0.02918454445898533, decouple_loss:0.011039573699235916
The modified gen p mean: 0.4478274881839752, gen p mean: 0.0, mean p set: 0.44726744294166565
loss_pred:0.02845686301589012, decouple_loss:0.01098587829619646
The modified gen p mean: 0.44724681973457336, gen p mean: 0.0, mean p set: 0.448001891374588
loss_pred:0.029989976435899734, decouple_loss:0.010706708766520023
Iteration: 2052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45352497696876526, gen p mean: 0.0, mean p set: 0.44707152247428894
The modified gen p mean: 0.4509577751159668, gen p mean: 0.0, mean p set: 0.4462752044200897
The modified gen p mean: 0.4535187780857086, gen p mean: 0.0, mean p set: 0.446553498506546
loss_pred:0.02819581888616085, decouple_loss:0.010815626941621304
loss_pred:0.029019180685281754, decouple_loss:0.01086569856852293
loss_pred:0.02844623103737831, decouple_loss:0.010875636711716652
Iteration: 2053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783201813697815, gen p mean: 0.0, mean p set: 0.449388325214386
The modified gen p mean: 0.44114840030670166, gen p mean: 0.0, mean p set: 0.44934335350990295
The modified gen p mean: 0.4418852627277374, gen p mean: 0.0, mean p set: 0.44730156660079956
loss_pred:0.029965080320835114, decouple_loss:0.011800965294241905
loss_pred:0.03034321404993534, decouple_loss:0.011854100041091442
loss_pred:0.02925034984946251, decouple_loss:0.01123920176178217
Iteration: 2054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497988224029541, gen p mean: 0.0, mean p set: 0.4492022693157196
The modified gen p mean: 0.4498478174209595, gen p mean: 0.0, mean p set: 0.4484969973564148
The modified gen p mean: 0.45360323786735535, gen p mean: 0.0, mean p set: 0.4466968774795532
loss_pred:0.029766812920570374, decouple_loss:0.011766400188207626
loss_pred:0.030238576233386993, decouple_loss:0.01129736378788948
loss_pred:0.02885415405035019, decouple_loss:0.01107498537749052
Iteration: 2055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871485233306885, gen p mean: 0.0, mean p set: 0.4473387897014618
The modified gen p mean: 0.45851901173591614, gen p mean: 0.0, mean p set: 0.4474022090435028
The modified gen p mean: 0.45518162846565247, gen p mean: 0.0, mean p set: 0.44737857580184937
loss_pred:0.028010966256260872, decouple_loss:0.011113492771983147
loss_pred:0.02929401583969593, decouple_loss:0.01149259228259325
loss_pred:0.029658600687980652, decouple_loss:0.011494435369968414
Iteration: 2056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43936121463775635, gen p mean: 0.0, mean p set: 0.4467707574367523
The modified gen p mean: 0.43877506256103516, gen p mean: 0.0, mean p set: 0.44682982563972473
The modified gen p mean: 0.4402119219303131, gen p mean: 0.0, mean p set: 0.4472139775753021
loss_pred:0.028868764638900757, decouple_loss:0.01085503026843071
loss_pred:0.02888377010822296, decouple_loss:0.010940132662653923
loss_pred:0.028350062668323517, decouple_loss:0.01159533578902483
Iteration: 2057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44118040800094604, gen p mean: 0.0, mean p set: 0.4474903643131256
The modified gen p mean: 0.4479214549064636, gen p mean: 0.0, mean p set: 0.4471668004989624
The modified gen p mean: 0.4411841034889221, gen p mean: 0.0, mean p set: 0.44666171073913574
loss_pred:0.028082225471735, decouple_loss:0.010861819609999657
loss_pred:0.028844133019447327, decouple_loss:0.011325905099511147
loss_pred:0.0283119548112154, decouple_loss:0.010762293823063374
Iteration: 2058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510264992713928, gen p mean: 0.0, mean p set: 0.4482557475566864
The modified gen p mean: 0.45482686161994934, gen p mean: 0.0, mean p set: 0.44670480489730835
The modified gen p mean: 0.4528059959411621, gen p mean: 0.0, mean p set: 0.4473620653152466
loss_pred:0.029567964375019073, decouple_loss:0.011062280274927616
loss_pred:0.028272457420825958, decouple_loss:0.010515150614082813
loss_pred:0.029253453016281128, decouple_loss:0.010909225791692734
Iteration: 2059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796618819236755, gen p mean: 0.0, mean p set: 0.44756606221199036
The modified gen p mean: 0.45053544640541077, gen p mean: 0.0, mean p set: 0.4486643373966217
The modified gen p mean: 0.44500240683555603, gen p mean: 0.0, mean p set: 0.44780007004737854
loss_pred:0.02776908501982689, decouple_loss:0.010766109451651573
loss_pred:0.0303623229265213, decouple_loss:0.011347022838890553
loss_pred:0.02853386290371418, decouple_loss:0.011149916797876358
Iteration: 2060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482637047767639, gen p mean: 0.0, mean p set: 0.44877323508262634
The modified gen p mean: 0.44749903678894043, gen p mean: 0.0, mean p set: 0.44724777340888977
The modified gen p mean: 0.4446188807487488, gen p mean: 0.0, mean p set: 0.4466361403465271
loss_pred:0.02965393103659153, decouple_loss:0.01145491749048233
loss_pred:0.027888279408216476, decouple_loss:0.010661535896360874
loss_pred:0.028382210060954094, decouple_loss:0.010769965127110481
2023-05-03 04:11:28 testing...
The modified gen p mean: 0.45243844389915466, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44745108485221863, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45538878440856934, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027841536328196526, decouple_loss:0.011216428130865097
loss_pred:0.028753316029906273, decouple_loss:0.011541295796632767
loss_pred:0.027422411367297173, decouple_loss:0.011450794525444508
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028575897216796875, avg_mse: 0.03331197798252106
current test mse: 0.033312
Iteration: 2061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498119652271271, gen p mean: 0.0, mean p set: 0.4467627704143524
loss_pred:0.02822529524564743, decouple_loss:0.010656685568392277
The modified gen p mean: 0.4557412564754486, gen p mean: 0.0, mean p set: 0.44648540019989014
loss_pred:0.02903980016708374, decouple_loss:0.011131693609058857
The modified gen p mean: 0.4507941007614136, gen p mean: 0.0, mean p set: 0.4474048614501953
loss_pred:0.028408631682395935, decouple_loss:0.0107538141310215
Iteration: 2062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4375390112400055, gen p mean: 0.0, mean p set: 0.44801223278045654
The modified gen p mean: 0.439715713262558, gen p mean: 0.0, mean p set: 0.4474782347679138
The modified gen p mean: 0.4441884458065033, gen p mean: 0.0, mean p set: 0.44876134395599365
loss_pred:0.029096761718392372, decouple_loss:0.011175408959388733
loss_pred:0.028011556714773178, decouple_loss:0.010487060993909836
loss_pred:0.030453834682703018, decouple_loss:0.011083685792982578
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 2063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466744363307953, gen p mean: 0.0, mean p set: 0.4508443772792816
The modified gen p mean: 0.44155043363571167, gen p mean: 0.0, mean p set: 0.4507039785385132
The modified gen p mean: 0.4451413154602051, gen p mean: 0.0, mean p set: 0.45046308636665344
loss_pred:0.027849992737174034, decouple_loss:0.012437144294381142
loss_pred:0.027714885771274567, decouple_loss:0.012801045551896095
loss_pred:0.027737250551581383, decouple_loss:0.012962563894689083
Iteration: 2064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4568519592285156, gen p mean: 0.0, mean p set: 0.45079106092453003The modified gen p mean: 0.46040505170822144, gen p mean: 0.0, mean p set: 0.4512903094291687
The modified gen p mean: 0.46073105931282043, gen p mean: 0.0, mean p set: 0.451661616563797
loss_pred:0.027117501944303513, decouple_loss:0.012700074352324009
loss_pred:0.029092783108353615, decouple_loss:0.012973165139555931
loss_pred:0.02854873798787594, decouple_loss:0.012558535672724247
Iteration: 2065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45454126596450806, gen p mean: 0.0, mean p set: 0.44909584522247314
The modified gen p mean: 0.4595831036567688, gen p mean: 0.0, mean p set: 0.4508165121078491
The modified gen p mean: 0.455075204372406, gen p mean: 0.0, mean p set: 0.44931429624557495
loss_pred:0.027235254645347595, decouple_loss:0.012427840381860733
loss_pred:0.027203604578971863, decouple_loss:0.012664532288908958
loss_pred:0.029082119464874268, decouple_loss:0.012517164461314678
Iteration: 2066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4420918822288513, gen p mean: 0.0, mean p set: 0.4504653811454773
The modified gen p mean: 0.44172435998916626, gen p mean: 0.0, mean p set: 0.45040175318717957
The modified gen p mean: 0.4461292624473572, gen p mean: 0.0, mean p set: 0.45175716280937195
loss_pred:0.026939067989587784, decouple_loss:0.011912290006875992
loss_pred:0.027305182069540024, decouple_loss:0.012111593037843704
loss_pred:0.02801821380853653, decouple_loss:0.012037472799420357
Iteration: 2067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021432638168335, gen p mean: 0.0, mean p set: 0.4513188898563385
The modified gen p mean: 0.4455498158931732, gen p mean: 0.0, mean p set: 0.4493492543697357
The modified gen p mean: 0.4486808180809021, gen p mean: 0.0, mean p set: 0.44937294721603394
loss_pred:0.027913661673665047, decouple_loss:0.012059451080858707
loss_pred:0.02829095907509327, decouple_loss:0.012593877501785755
loss_pred:0.026618709787726402, decouple_loss:0.011876504868268967
Iteration: 2068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452608525753021, gen p mean: 0.0, mean p set: 0.45031872391700745
The modified gen p mean: 0.4418397843837738, gen p mean: 0.0, mean p set: 0.45058220624923706
The modified gen p mean: 0.4488638639450073, gen p mean: 0.0, mean p set: 0.4507562518119812
loss_pred:0.027636434882879257, decouple_loss:0.011836129240691662
loss_pred:0.027788983657956123, decouple_loss:0.01212268229573965
loss_pred:0.027487991377711296, decouple_loss:0.012229911051690578
Iteration: 2069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45472872257232666, gen p mean: 0.0, mean p set: 0.44870832562446594
The modified gen p mean: 0.45192667841911316, gen p mean: 0.0, mean p set: 0.45061951875686646
The modified gen p mean: 0.45099255442619324, gen p mean: 0.0, mean p set: 0.45151427388191223
loss_pred:0.02884218655526638, decouple_loss:0.012179438956081867
loss_pred:0.027304913848638535, decouple_loss:0.011392215266823769
loss_pred:0.028590302914381027, decouple_loss:0.01194019429385662
Iteration: 2070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46009060740470886, gen p mean: 0.0, mean p set: 0.45005032420158386
The modified gen p mean: 0.460004597902298, gen p mean: 0.0, mean p set: 0.4506286382675171
The modified gen p mean: 0.4542643129825592, gen p mean: 0.0, mean p set: 0.44983693957328796
loss_pred:0.02714410237967968, decouple_loss:0.011525008827447891
loss_pred:0.026674909517169, decouple_loss:0.011918684467673302
loss_pred:0.02810901775956154, decouple_loss:0.012572228908538818
2023-05-03 04:15:46 testing...
The modified gen p mean: 0.4403518736362457, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4351693391799927, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44274190068244934, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027907874435186386, decouple_loss:0.012550854124128819
loss_pred:0.02892271801829338, decouple_loss:0.012783297337591648
loss_pred:0.02733958326280117, decouple_loss:0.012581009417772293
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028688644990324974, avg_mse: 0.03341839089989662
current test mse: 0.033418
Iteration: 2071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4422728717327118, gen p mean: 0.0, mean p set: 0.4499933123588562
The modified gen p mean: 0.44676822423934937, gen p mean: 0.0, mean p set: 0.4487225413322449
loss_pred:0.027274856343865395, decouple_loss:0.01199755072593689
loss_pred:0.0270175002515316, decouple_loss:0.012050552293658257
The modified gen p mean: 0.4476601481437683, gen p mean: 0.0, mean p set: 0.4490794241428375
loss_pred:0.02775704674422741, decouple_loss:0.011921016499400139
Iteration: 2072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520426392555237, gen p mean: 0.0, mean p set: 0.4502848982810974
The modified gen p mean: 0.4470372200012207, gen p mean: 0.0, mean p set: 0.4500750005245209
The modified gen p mean: 0.4479992985725403, gen p mean: 0.0, mean p set: 0.45099109411239624
loss_pred:0.027622390538454056, decouple_loss:0.011835304088890553
loss_pred:0.027543092146515846, decouple_loss:0.011356381699442863
loss_pred:0.02741638384759426, decouple_loss:0.011748543940484524
Iteration: 2073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45585763454437256, gen p mean: 0.0, mean p set: 0.4505939483642578
The modified gen p mean: 0.4509372413158417, gen p mean: 0.0, mean p set: 0.4516618549823761
The modified gen p mean: 0.4506416916847229, gen p mean: 0.0, mean p set: 0.4488380551338196
loss_pred:0.027703460305929184, decouple_loss:0.011987908743321896
loss_pred:0.027537241578102112, decouple_loss:0.011919132433831692
loss_pred:0.02765851467847824, decouple_loss:0.011804415844380856
Iteration: 2074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4410506784915924, gen p mean: 0.0, mean p set: 0.4509795904159546
The modified gen p mean: 0.44636988639831543, gen p mean: 0.0, mean p set: 0.4514269232749939
The modified gen p mean: 0.44383102655410767, gen p mean: 0.0, mean p set: 0.44931018352508545
loss_pred:0.027472706511616707, decouple_loss:0.012096140533685684
loss_pred:0.02766183204948902, decouple_loss:0.011584418825805187
loss_pred:0.02806861698627472, decouple_loss:0.012019866146147251
Iteration: 2075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44611456990242004, gen p mean: 0.0, mean p set: 0.45104461908340454
The modified gen p mean: 0.4528835117816925, gen p mean: 0.0, mean p set: 0.45045775175094604
The modified gen p mean: 0.4503655433654785, gen p mean: 0.0, mean p set: 0.45081597566604614
loss_pred:0.027772370725870132, decouple_loss:0.011766214855015278
loss_pred:0.026554128155112267, decouple_loss:0.01109999231994152
loss_pred:0.026856455951929092, decouple_loss:0.012074174359440804
Iteration: 2076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4573046565055847, gen p mean: 0.0, mean p set: 0.4512398838996887
The modified gen p mean: 0.4573226571083069, gen p mean: 0.0, mean p set: 0.45067667961120605
loss_pred:0.02806018479168415, decouple_loss:0.011483984999358654
The modified gen p mean: 0.4618803560733795, gen p mean: 0.0, mean p set: 0.45067429542541504
loss_pred:0.026761075481772423, decouple_loss:0.011482168920338154
loss_pred:0.02742929756641388, decouple_loss:0.011298460885882378
Iteration: 2077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474808871746063, gen p mean: 0.0, mean p set: 0.4498820900917053
The modified gen p mean: 0.4443434178829193, gen p mean: 0.0, mean p set: 0.4503445625305176
The modified gen p mean: 0.445029079914093, gen p mean: 0.0, mean p set: 0.45033547282218933
loss_pred:0.027072349563241005, decouple_loss:0.011365432292222977
loss_pred:0.027733489871025085, decouple_loss:0.012167027220129967
loss_pred:0.02780124358832836, decouple_loss:0.012059065513312817
Iteration: 2078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4436227083206177, gen p mean: 0.0, mean p set: 0.4506531357765198
The modified gen p mean: 0.44302618503570557, gen p mean: 0.0, mean p set: 0.4506239891052246
The modified gen p mean: 0.4457055926322937, gen p mean: 0.0, mean p set: 0.4514070451259613
loss_pred:0.027234725654125214, decouple_loss:0.010910426266491413
loss_pred:0.026679890230298042, decouple_loss:0.01105699222534895
loss_pred:0.02785651572048664, decouple_loss:0.01145932823419571
Iteration: 2079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45697614550590515, gen p mean: 0.0, mean p set: 0.4490005075931549
The modified gen p mean: 0.4545205533504486, gen p mean: 0.0, mean p set: 0.4512932300567627
The modified gen p mean: 0.45408570766448975, gen p mean: 0.0, mean p set: 0.4487698972225189
loss_pred:0.027454618364572525, decouple_loss:0.011542946100234985
loss_pred:0.0269293412566185, decouple_loss:0.010815282352268696
loss_pred:0.028384996578097343, decouple_loss:0.011672762222588062
Iteration: 2080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542696177959442, gen p mean: 0.0, mean p set: 0.44937488436698914
The modified gen p mean: 0.455697625875473, gen p mean: 0.0, mean p set: 0.44945380091667175
The modified gen p mean: 0.4523489773273468, gen p mean: 0.0, mean p set: 0.44993993639945984
loss_pred:0.027367085218429565, decouple_loss:0.010871618054807186
loss_pred:0.02733697183430195, decouple_loss:0.010894734412431717
loss_pred:0.027674488723278046, decouple_loss:0.011058387346565723
2023-05-03 04:19:29 testing...
The modified gen p mean: 0.4349324703216553, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4298371374607086, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.43768230080604553, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02789340727031231, decouple_loss:0.01222115196287632
loss_pred:0.028959041461348534, decouple_loss:0.01251200120896101
loss_pred:0.027528662234544754, decouple_loss:0.01215733028948307
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028741877526044846, avg_mse: 0.033546920865774155
current test mse: 0.033547
Iteration: 2081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4404531717300415, gen p mean: 0.0, mean p set: 0.45064401626586914
The modified gen p mean: 0.43896859884262085, gen p mean: 0.0, mean p set: 0.45053014159202576
loss_pred:0.027350930497050285, decouple_loss:0.01138520147651434
loss_pred:0.026872243732213974, decouple_loss:0.011024895124137402
The modified gen p mean: 0.4402337968349457, gen p mean: 0.0, mean p set: 0.449493408203125
loss_pred:0.02773151732981205, decouple_loss:0.010737142525613308
Iteration: 2082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45207399129867554, gen p mean: 0.0, mean p set: 0.4503578245639801
The modified gen p mean: 0.4595299959182739, gen p mean: 0.0, mean p set: 0.44908347725868225
The modified gen p mean: 0.45543375611305237, gen p mean: 0.0, mean p set: 0.44908758997917175
loss_pred:0.028071604669094086, decouple_loss:0.011482235975563526
loss_pred:0.026942115277051926, decouple_loss:0.01112271286547184
loss_pred:0.028461411595344543, decouple_loss:0.01170499436557293
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
NaN value num: 0
Iteration: 2083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45416778326034546, gen p mean: 0.0, mean p set: 0.45223915576934814
The modified gen p mean: 0.45417332649230957, gen p mean: 0.0, mean p set: 0.4520907402038574
The modified gen p mean: 0.45435959100723267, gen p mean: 0.0, mean p set: 0.4539281725883484
loss_pred:0.02624662220478058, decouple_loss:0.011600615456700325
loss_pred:0.026019254699349403, decouple_loss:0.012045389972627163
loss_pred:0.026727281510829926, decouple_loss:0.011868547648191452
Iteration: 2084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4393326938152313, gen p mean: 0.0, mean p set: 0.45250189304351807
The modified gen p mean: 0.4398689568042755, gen p mean: 0.0, mean p set: 0.45107436180114746
The modified gen p mean: 0.44163867831230164, gen p mean: 0.0, mean p set: 0.4516795575618744
loss_pred:0.026202702894806862, decouple_loss:0.012286604382097721
loss_pred:0.02653026394546032, decouple_loss:0.011728961020708084
loss_pred:0.026729419827461243, decouple_loss:0.01162217278033495
Iteration: 2085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4573366641998291, gen p mean: 0.0, mean p set: 0.4518086314201355
The modified gen p mean: 0.46004852652549744, gen p mean: 0.0, mean p set: 0.45400553941726685
The modified gen p mean: 0.45928579568862915, gen p mean: 0.0, mean p set: 0.45168986916542053
loss_pred:0.027150124311447144, decouple_loss:0.011834421195089817
loss_pred:0.02604437991976738, decouple_loss:0.01178824808448553
loss_pred:0.02624300681054592, decouple_loss:0.011421865783631802
Iteration: 2086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4585503041744232, gen p mean: 0.0, mean p set: 0.4513179063796997
The modified gen p mean: 0.4585891366004944, gen p mean: 0.0, mean p set: 0.4505713880062103
The modified gen p mean: 0.45706894993782043, gen p mean: 0.0, mean p set: 0.45134520530700684
loss_pred:0.02699311263859272, decouple_loss:0.011435728520154953
loss_pred:0.026399660855531693, decouple_loss:0.011667756363749504
loss_pred:0.026674017310142517, decouple_loss:0.010787634178996086
Iteration: 2087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43324247002601624, gen p mean: 0.0, mean p set: 0.45252230763435364
The modified gen p mean: 0.4355176091194153, gen p mean: 0.0, mean p set: 0.45178526639938354
The modified gen p mean: 0.4404728412628174, gen p mean: 0.0, mean p set: 0.45181941986083984
loss_pred:0.026848623529076576, decouple_loss:0.012876923196017742
loss_pred:0.02674449235200882, decouple_loss:0.011619637720286846
loss_pred:0.026700301095843315, decouple_loss:0.011874085292220116
Iteration: 2088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882437586784363, gen p mean: 0.0, mean p set: 0.4531228840351105
The modified gen p mean: 0.4525628089904785, gen p mean: 0.0, mean p set: 0.45155712962150574
The modified gen p mean: 0.45198920369148254, gen p mean: 0.0, mean p set: 0.4509810209274292
loss_pred:0.026784688234329224, decouple_loss:0.011852924712002277
loss_pred:0.0259059090167284, decouple_loss:0.011324137449264526
loss_pred:0.027324961498379707, decouple_loss:0.01145726814866066
Iteration: 2089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.467297226190567, gen p mean: 0.0, mean p set: 0.4518158733844757
The modified gen p mean: 0.46519941091537476, gen p mean: 0.0, mean p set: 0.45160529017448425
The modified gen p mean: 0.46658918261528015, gen p mean: 0.0, mean p set: 0.45374795794487
loss_pred:0.02681492082774639, decouple_loss:0.011337748728692532
loss_pred:0.026242105290293694, decouple_loss:0.011286457069218159
loss_pred:0.025893744081258774, decouple_loss:0.011765616945922375
Iteration: 2090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450829416513443, gen p mean: 0.0, mean p set: 0.45131972432136536
The modified gen p mean: 0.4526560604572296, gen p mean: 0.0, mean p set: 0.45218291878700256
The modified gen p mean: 0.4505169093608856, gen p mean: 0.0, mean p set: 0.4517635107040405
loss_pred:0.026387261226773262, decouple_loss:0.011128442361950874
loss_pred:0.026624515652656555, decouple_loss:0.011128481477499008
loss_pred:0.02567434124648571, decouple_loss:0.011402406729757786
2023-05-03 04:23:48 testing...
The modified gen p mean: 0.43299630284309387, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4279038608074188, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.43566271662712097, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02787530981004238, decouple_loss:0.012474100105464458
loss_pred:0.028989536687731743, decouple_loss:0.012817293405532837
loss_pred:0.027400141581892967, decouple_loss:0.01255741622298956
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028719142079353333, avg_mse: 0.03347724676132202
current test mse: 0.033477
Iteration: 2091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4399428963661194, gen p mean: 0.0, mean p set: 0.45446687936782837
The modified gen p mean: 0.43468594551086426, gen p mean: 0.0, mean p set: 0.45192527770996094
loss_pred:0.025902463123202324, decouple_loss:0.01141221821308136
loss_pred:0.026844937354326248, decouple_loss:0.011852570809423923
The modified gen p mean: 0.4362823963165283, gen p mean: 0.0, mean p set: 0.4519648849964142
loss_pred:0.02677086554467678, decouple_loss:0.011542877182364464
Iteration: 2092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504917860031128, gen p mean: 0.0, mean p set: 0.45163676142692566
The modified gen p mean: 0.44912636280059814, gen p mean: 0.0, mean p set: 0.4526068866252899
The modified gen p mean: 0.4494241774082184, gen p mean: 0.0, mean p set: 0.4524551033973694
loss_pred:0.02615612931549549, decouple_loss:0.011179253458976746
loss_pred:0.026528678834438324, decouple_loss:0.011679321527481079
loss_pred:0.026253605261445045, decouple_loss:0.012015461921691895
Iteration: 2093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4564272463321686, gen p mean: 0.0, mean p set: 0.4520235061645508
The modified gen p mean: 0.4512718915939331, gen p mean: 0.0, mean p set: 0.45103341341018677
The modified gen p mean: 0.45455822348594666, gen p mean: 0.0, mean p set: 0.453857421875
loss_pred:0.025923041626811028, decouple_loss:0.011192049831151962
loss_pred:0.02652261033654213, decouple_loss:0.01107532437890768
loss_pred:0.025756776332855225, decouple_loss:0.011366776190698147
Iteration: 2094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4649581015110016, gen p mean: 0.0, mean p set: 0.45200681686401367
The modified gen p mean: 0.4669449031352997, gen p mean: 0.0, mean p set: 0.45079749822616577
The modified gen p mean: 0.46516332030296326, gen p mean: 0.0, mean p set: 0.4521290957927704
loss_pred:0.025983639061450958, decouple_loss:0.011288752779364586
loss_pred:0.026533596217632294, decouple_loss:0.011521318927407265
loss_pred:0.02557225339114666, decouple_loss:0.01082147378474474
Iteration: 2095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507080018520355, gen p mean: 0.0, mean p set: 0.4526367783546448
The modified gen p mean: 0.4542998969554901, gen p mean: 0.0, mean p set: 0.45124444365501404
The modified gen p mean: 0.44842594861984253, gen p mean: 0.0, mean p set: 0.4520774185657501
loss_pred:0.026072708889842033, decouple_loss:0.0115624675527215
loss_pred:0.02705698274075985, decouple_loss:0.011502145789563656
loss_pred:0.026381628587841988, decouple_loss:0.012505872175097466
Iteration: 2096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44297948479652405, gen p mean: 0.0, mean p set: 0.45171689987182617
The modified gen p mean: 0.4438265264034271, gen p mean: 0.0, mean p set: 0.45212632417678833
The modified gen p mean: 0.4379892349243164, gen p mean: 0.0, mean p set: 0.4526348412036896
loss_pred:0.02710358425974846, decouple_loss:0.010679574683308601
loss_pred:0.02508753165602684, decouple_loss:0.010964538902044296
loss_pred:0.026725489646196365, decouple_loss:0.01139172725379467
Iteration: 2097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44630861282348633, gen p mean: 0.0, mean p set: 0.45116350054740906
The modified gen p mean: 0.4489741921424866, gen p mean: 0.0, mean p set: 0.4512788653373718
The modified gen p mean: 0.44736719131469727, gen p mean: 0.0, mean p set: 0.45171838998794556
loss_pred:0.026425229385495186, decouple_loss:0.010893714614212513
loss_pred:0.02672150917351246, decouple_loss:0.010612083598971367
loss_pred:0.026455963030457497, decouple_loss:0.010582877323031425
Iteration: 2098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46153488755226135, gen p mean: 0.0, mean p set: 0.45309484004974365
The modified gen p mean: 0.4611349403858185, gen p mean: 0.0, mean p set: 0.4521616995334625
The modified gen p mean: 0.4589613378047943, gen p mean: 0.0, mean p set: 0.452288955450058
loss_pred:0.025755567476153374, decouple_loss:0.010638142004609108
loss_pred:0.026191653683781624, decouple_loss:0.010521317832171917
loss_pred:0.02596188150346279, decouple_loss:0.010932547971606255
Iteration: 2099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488525390625, gen p mean: 0.0, mean p set: 0.45129284262657166
The modified gen p mean: 0.45249688625335693, gen p mean: 0.0, mean p set: 0.45282885432243347
The modified gen p mean: 0.4487537145614624, gen p mean: 0.0, mean p set: 0.4513914883136749
loss_pred:0.026088926941156387, decouple_loss:0.010800475254654884
loss_pred:0.025448331609368324, decouple_loss:0.011038929224014282
loss_pred:0.025608614087104797, decouple_loss:0.010869331657886505
Iteration: 2100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44125649333000183, gen p mean: 0.0, mean p set: 0.4532293677330017
The modified gen p mean: 0.44322454929351807, gen p mean: 0.0, mean p set: 0.4533538818359375
The modified gen p mean: 0.44011548161506653, gen p mean: 0.0, mean p set: 0.45412924885749817
loss_pred:0.025622719898819923, decouple_loss:0.011088207364082336
loss_pred:0.025890495628118515, decouple_loss:0.011331276968121529
loss_pred:0.0258466899394989, decouple_loss:0.011215394362807274
2023-05-03 04:27:31 testing...
The modified gen p mean: 0.45306524634361267, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.46097344160079956, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.45821279287338257, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.028843099251389503, decouple_loss:0.012642130255699158
loss_pred:0.02727377600967884, decouple_loss:0.012359486892819405
loss_pred:0.02770027332007885, decouple_loss:0.012355780228972435
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028561672195792198, avg_mse: 0.03332129493355751
current test mse: 0.033321
Iteration: 2101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46485602855682373, gen p mean: 0.0, mean p set: 0.45084527134895325
The modified gen p mean: 0.46714967489242554, gen p mean: 0.0, mean p set: 0.45193883776664734
loss_pred:0.027354514226317406, decouple_loss:0.01083726342767477
loss_pred:0.02666953019797802, decouple_loss:0.010510405525565147
The modified gen p mean: 0.4645395278930664, gen p mean: 0.0, mean p set: 0.4534603953361511
loss_pred:0.02541056089103222, decouple_loss:0.010698609054088593
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 2102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458961486816406, gen p mean: 0.0, mean p set: 0.4489799737930298
The modified gen p mean: 0.45176807045936584, gen p mean: 0.0, mean p set: 0.44865697622299194
The modified gen p mean: 0.4473797678947449, gen p mean: 0.0, mean p set: 0.44844159483909607
loss_pred:0.027884790673851967, decouple_loss:0.01216709055006504
loss_pred:0.027229884639382362, decouple_loss:0.011957414448261261
loss_pred:0.02765619568526745, decouple_loss:0.012145395390689373
Iteration: 2103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43480348587036133, gen p mean: 0.0, mean p set: 0.4482114315032959
The modified gen p mean: 0.43645185232162476, gen p mean: 0.0, mean p set: 0.4492571949958801
The modified gen p mean: 0.43525058031082153, gen p mean: 0.0, mean p set: 0.4488280117511749
loss_pred:0.02708098478615284, decouple_loss:0.011542955413460732
loss_pred:0.027714619413018227, decouple_loss:0.011771033518016338
loss_pred:0.02730344980955124, decouple_loss:0.011813363060355186
Iteration: 2104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520519971847534, gen p mean: 0.0, mean p set: 0.4497953951358795
The modified gen p mean: 0.45296671986579895, gen p mean: 0.0, mean p set: 0.44777724146842957
The modified gen p mean: 0.4523159861564636, gen p mean: 0.0, mean p set: 0.4479329288005829
loss_pred:0.02729911543428898, decouple_loss:0.011448236182332039
loss_pred:0.028773320838809013, decouple_loss:0.011949743144214153
loss_pred:0.026846375316381454, decouple_loss:0.011303234845399857
Iteration: 2105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4576027989387512, gen p mean: 0.0, mean p set: 0.44856035709381104
The modified gen p mean: 0.457130491733551, gen p mean: 0.0, mean p set: 0.4490780532360077
The modified gen p mean: 0.454522967338562, gen p mean: 0.0, mean p set: 0.4485870599746704
loss_pred:0.02760271728038788, decouple_loss:0.011519736610352993
loss_pred:0.027536587789654732, decouple_loss:0.011549149639904499
loss_pred:0.026554562151432037, decouple_loss:0.011682786978781223
Iteration: 2106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44479134678840637, gen p mean: 0.0, mean p set: 0.4487045109272003
The modified gen p mean: 0.44833382964134216, gen p mean: 0.0, mean p set: 0.44816192984580994
The modified gen p mean: 0.4489894509315491, gen p mean: 0.0, mean p set: 0.44771671295166016
loss_pred:0.027216801419854164, decouple_loss:0.011398762464523315
loss_pred:0.02691044472157955, decouple_loss:0.011606089770793915
loss_pred:0.02857118472456932, decouple_loss:0.011757324449717999
Iteration: 2107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4449766278266907, gen p mean: 0.0, mean p set: 0.44784268736839294
The modified gen p mean: 0.44692784547805786, gen p mean: 0.0, mean p set: 0.4477514326572418
The modified gen p mean: 0.4420837461948395, gen p mean: 0.0, mean p set: 0.4475710391998291
loss_pred:0.028779292479157448, decouple_loss:0.011591142043471336
loss_pred:0.027902843430638313, decouple_loss:0.011636503040790558
loss_pred:0.026782188564538956, decouple_loss:0.011210194788873196
Iteration: 2108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45332881808280945, gen p mean: 0.0, mean p set: 0.4485081434249878
The modified gen p mean: 0.45252496004104614, gen p mean: 0.0, mean p set: 0.4486263692378998
The modified gen p mean: 0.45427799224853516, gen p mean: 0.0, mean p set: 0.4481014907360077
loss_pred:0.028055507689714432, decouple_loss:0.011154094710946083
loss_pred:0.02764817140996456, decouple_loss:0.011047624051570892
loss_pred:0.02739095687866211, decouple_loss:0.011140581220388412
Iteration: 2109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44502899050712585, gen p mean: 0.0, mean p set: 0.4477945566177368
The modified gen p mean: 0.44236424565315247, gen p mean: 0.0, mean p set: 0.4488582909107208
The modified gen p mean: 0.4440018832683563, gen p mean: 0.0, mean p set: 0.44793590903282166
loss_pred:0.0280170775949955, decouple_loss:0.011224147863686085
loss_pred:0.027139611542224884, decouple_loss:0.01101126242429018
loss_pred:0.027577074244618416, decouple_loss:0.01122125145047903
Iteration: 2110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43369221687316895, gen p mean: 0.0, mean p set: 0.4479498863220215
The modified gen p mean: 0.43405285477638245, gen p mean: 0.0, mean p set: 0.4479990005493164
The modified gen p mean: 0.4336821734905243, gen p mean: 0.0, mean p set: 0.4495420455932617
loss_pred:0.02659052051603794, decouple_loss:0.011381212621927261
loss_pred:0.026329508051276207, decouple_loss:0.01118037011474371
loss_pred:0.02659149095416069, decouple_loss:0.011368458159267902
2023-05-03 04:31:47 testing...
The modified gen p mean: 0.45793092250823975, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4524390995502472, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4610399901866913, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027395108714699745, decouple_loss:0.011114552617073059
loss_pred:0.028367698192596436, decouple_loss:0.011595169082283974
loss_pred:0.026987016201019287, decouple_loss:0.01117666158825159
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028148047626018524, avg_mse: 0.03277067467570305
current test mse: 0.032771
Iteration: 2111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45618823170661926, gen p mean: 0.0, mean p set: 0.44776979088783264
loss_pred:0.026633430272340775, decouple_loss:0.010695223696529865
The modified gen p mean: 0.456015408039093, gen p mean: 0.0, mean p set: 0.4489966928958893
loss_pred:0.027841847389936447, decouple_loss:0.010947511531412601
The modified gen p mean: 0.45878714323043823, gen p mean: 0.0, mean p set: 0.4486351013183594
loss_pred:0.0268307626247406, decouple_loss:0.01108132116496563
Iteration: 2112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4668913185596466, gen p mean: 0.0, mean p set: 0.4498658776283264
The modified gen p mean: 0.46412357687950134, gen p mean: 0.0, mean p set: 0.449133038520813
The modified gen p mean: 0.4662322700023651, gen p mean: 0.0, mean p set: 0.4474125802516937
loss_pred:0.027219705283641815, decouple_loss:0.011044575832784176
loss_pred:0.027259275317192078, decouple_loss:0.01081929076462984
loss_pred:0.026671504601836205, decouple_loss:0.01065951306372881
Iteration: 2113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4391239583492279, gen p mean: 0.0, mean p set: 0.44759488105773926
The modified gen p mean: 0.43661507964134216, gen p mean: 0.0, mean p set: 0.44811877608299255
The modified gen p mean: 0.4393434226512909, gen p mean: 0.0, mean p set: 0.4488586187362671
loss_pred:0.027736574411392212, decouple_loss:0.011046700179576874
loss_pred:0.026622595265507698, decouple_loss:0.010759437456727028
loss_pred:0.02714807726442814, decouple_loss:0.010776870884001255
Iteration: 2114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43794119358062744, gen p mean: 0.0, mean p set: 0.4489794969558716
The modified gen p mean: 0.44147366285324097, gen p mean: 0.0, mean p set: 0.4488556683063507
The modified gen p mean: 0.4388096034526825, gen p mean: 0.0, mean p set: 0.44763508439064026
loss_pred:0.026985911652445793, decouple_loss:0.010720300488173962
loss_pred:0.027423448860645294, decouple_loss:0.010458114556968212
loss_pred:0.027092644944787025, decouple_loss:0.010721064172685146
Iteration: 2115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503723680973053, gen p mean: 0.0, mean p set: 0.44860297441482544
The modified gen p mean: 0.4505825340747833, gen p mean: 0.0, mean p set: 0.4488038718700409
The modified gen p mean: 0.4548889398574829, gen p mean: 0.0, mean p set: 0.44803711771965027
loss_pred:0.026382876560091972, decouple_loss:0.010493826121091843
loss_pred:0.026478607207536697, decouple_loss:0.010577432811260223
loss_pred:0.027980510145425797, decouple_loss:0.011034316383302212
Iteration: 2116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932934641838074, gen p mean: 0.0, mean p set: 0.4489099383354187
The modified gen p mean: 0.4502336382865906, gen p mean: 0.0, mean p set: 0.4470933675765991
The modified gen p mean: 0.45124098658561707, gen p mean: 0.0, mean p set: 0.4495067000389099
loss_pred:0.026365984231233597, decouple_loss:0.010198315605521202
loss_pred:0.027112683281302452, decouple_loss:0.010356471873819828
loss_pred:0.025950929149985313, decouple_loss:0.01074797473847866
Iteration: 2117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443930685520172, gen p mean: 0.0, mean p set: 0.44905373454093933
The modified gen p mean: 0.4474199116230011, gen p mean: 0.0, mean p set: 0.4482528567314148
The modified gen p mean: 0.4434002935886383, gen p mean: 0.0, mean p set: 0.44894084334373474
loss_pred:0.027889305725693703, decouple_loss:0.010767132043838501
loss_pred:0.02649274468421936, decouple_loss:0.010354466736316681
loss_pred:0.02671470120549202, decouple_loss:0.010497543029487133
Iteration: 2118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45723873376846313, gen p mean: 0.0, mean p set: 0.44812890887260437
The modified gen p mean: 0.4515504837036133, gen p mean: 0.0, mean p set: 0.4485073983669281
The modified gen p mean: 0.4580825865268707, gen p mean: 0.0, mean p set: 0.44784215092658997
loss_pred:0.027508489787578583, decouple_loss:0.011019045487046242
loss_pred:0.02671028859913349, decouple_loss:0.010817115195095539
loss_pred:0.027162624523043633, decouple_loss:0.010960884392261505
Iteration: 2119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900447130203247, gen p mean: 0.0, mean p set: 0.4484385848045349
The modified gen p mean: 0.4459904730319977, gen p mean: 0.0, mean p set: 0.44825834035873413
The modified gen p mean: 0.4405888617038727, gen p mean: 0.0, mean p set: 0.44843214750289917
loss_pred:0.026531819254159927, decouple_loss:0.010515841655433178
loss_pred:0.02699143998324871, decouple_loss:0.010786212980747223
loss_pred:0.026580002158880234, decouple_loss:0.01066246535629034
Iteration: 2120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4401003122329712, gen p mean: 0.0, mean p set: 0.4477807283401489
The modified gen p mean: 0.44216617941856384, gen p mean: 0.0, mean p set: 0.44798383116722107
The modified gen p mean: 0.44005677103996277, gen p mean: 0.0, mean p set: 0.44921019673347473
loss_pred:0.027686964720487595, decouple_loss:0.01081573124974966
loss_pred:0.028429223224520683, decouple_loss:0.010922827757894993
loss_pred:0.02603060007095337, decouple_loss:0.01104010920971632
2023-05-03 04:35:30 testing...
The modified gen p mean: 0.4524345099925995, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.447562575340271, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4554236829280853, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027293626219034195, decouple_loss:0.010629952885210514
loss_pred:0.028327984735369682, decouple_loss:0.010941185988485813
loss_pred:0.027038102969527245, decouple_loss:0.010771743953227997
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028092285618185997, avg_mse: 0.032684002071619034
current test mse: 0.032684
Iteration: 2121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482976794242859, gen p mean: 0.0, mean p set: 0.4488692879676819
The modified gen p mean: 0.4527815580368042, gen p mean: 0.0, mean p set: 0.44773516058921814
loss_pred:0.026998573914170265, decouple_loss:0.010418303310871124
loss_pred:0.027854790911078453, decouple_loss:0.010995477437973022
The modified gen p mean: 0.45410239696502686, gen p mean: 0.0, mean p set: 0.4486044645309448
loss_pred:0.026315292343497276, decouple_loss:0.01053593959659338
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
NaN value num: 0
Iteration: 2122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4570319652557373, gen p mean: 0.0, mean p set: 0.4491589367389679
The modified gen p mean: 0.45692628622055054, gen p mean: 0.0, mean p set: 0.4488662779331207
The modified gen p mean: 0.45110973715782166, gen p mean: 0.0, mean p set: 0.4493860900402069
loss_pred:0.02877006120979786, decouple_loss:0.010909191332757473
loss_pred:0.02889617532491684, decouple_loss:0.01302353199571371
loss_pred:0.028731094673275948, decouple_loss:0.011400515213608742
Iteration: 2123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.444598525762558, gen p mean: 0.0, mean p set: 0.4497022032737732
The modified gen p mean: 0.4407559335231781, gen p mean: 0.0, mean p set: 0.4494177997112274
The modified gen p mean: 0.4394945204257965, gen p mean: 0.0, mean p set: 0.44906121492385864
loss_pred:0.029899684712290764, decouple_loss:0.01202956773340702
loss_pred:0.02912621945142746, decouple_loss:0.011192688718438148
loss_pred:0.029531171545386314, decouple_loss:0.012312564998865128
Iteration: 2124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45175567269325256, gen p mean: 0.0, mean p set: 0.4488941431045532
The modified gen p mean: 0.4452502429485321, gen p mean: 0.0, mean p set: 0.44917523860931396
The modified gen p mean: 0.4479389190673828, gen p mean: 0.0, mean p set: 0.45026108622550964
loss_pred:0.027748147025704384, decouple_loss:0.010670634917914867
loss_pred:0.0282379649579525, decouple_loss:0.011520062573254108
loss_pred:0.02918144315481186, decouple_loss:0.011018048971891403
Iteration: 2125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45413535833358765, gen p mean: 0.0, mean p set: 0.4503500759601593
The modified gen p mean: 0.45431944727897644, gen p mean: 0.0, mean p set: 0.4497818946838379
The modified gen p mean: 0.44916093349456787, gen p mean: 0.0, mean p set: 0.4479599893093109
loss_pred:0.028103327378630638, decouple_loss:0.011523119173943996
loss_pred:0.029873473569750786, decouple_loss:0.011135334149003029
loss_pred:0.02896292135119438, decouple_loss:0.01123220007866621
Iteration: 2126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039844512939453, gen p mean: 0.0, mean p set: 0.4500845670700073
The modified gen p mean: 0.44871240854263306, gen p mean: 0.0, mean p set: 0.4504399299621582
The modified gen p mean: 0.4498327672481537, gen p mean: 0.0, mean p set: 0.44953852891921997
loss_pred:0.02759118750691414, decouple_loss:0.010858294554054737
loss_pred:0.027741314843297005, decouple_loss:0.010431855916976929
loss_pred:0.02963290736079216, decouple_loss:0.010994849726557732
Iteration: 2127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469611346721649, gen p mean: 0.0, mean p set: 0.44863176345825195
The modified gen p mean: 0.44891753792762756, gen p mean: 0.0, mean p set: 0.44927293062210083
The modified gen p mean: 0.44928571581840515, gen p mean: 0.0, mean p set: 0.45080816745758057
loss_pred:0.028888048604130745, decouple_loss:0.011538446880877018
loss_pred:0.028725601732730865, decouple_loss:0.011023505590856075
loss_pred:0.028688905760645866, decouple_loss:0.011196495965123177
Iteration: 2128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498397409915924, gen p mean: 0.0, mean p set: 0.45021507143974304
The modified gen p mean: 0.44532322883605957, gen p mean: 0.0, mean p set: 0.4484170973300934
The modified gen p mean: 0.44899919629096985, gen p mean: 0.0, mean p set: 0.44847577810287476
loss_pred:0.028882281854748726, decouple_loss:0.011671767570078373
loss_pred:0.028907328844070435, decouple_loss:0.011175689287483692
loss_pred:0.02888568490743637, decouple_loss:0.011151761747896671
Iteration: 2129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783082604408264, gen p mean: 0.0, mean p set: 0.44893211126327515
The modified gen p mean: 0.4513886272907257, gen p mean: 0.0, mean p set: 0.4492657780647278
The modified gen p mean: 0.44710567593574524, gen p mean: 0.0, mean p set: 0.44797325134277344
loss_pred:0.028825286775827408, decouple_loss:0.010389176197350025
loss_pred:0.02868199348449707, decouple_loss:0.010681631043553352
loss_pred:0.029210396111011505, decouple_loss:0.010883335955440998
Iteration: 2130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506203234195709, gen p mean: 0.0, mean p set: 0.4502998888492584
The modified gen p mean: 0.44623011350631714, gen p mean: 0.0, mean p set: 0.45017367601394653
The modified gen p mean: 0.44881945848464966, gen p mean: 0.0, mean p set: 0.44812440872192383
loss_pred:0.027572335675358772, decouple_loss:0.010361363179981709
loss_pred:0.028008047491312027, decouple_loss:0.01030745729804039
loss_pred:0.02778506465256214, decouple_loss:0.010906670242547989
2023-05-03 04:39:53 testing...
The modified gen p mean: 0.451368510723114, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4543018937110901, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4465748071670532, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.02741607092320919, decouple_loss:0.01124292891472578
loss_pred:0.026979446411132812, decouple_loss:0.011487229727208614
loss_pred:0.028420697897672653, decouple_loss:0.011582178063690662
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028177279978990555, avg_mse: 0.032867588102817535
current test mse: 0.032868
Iteration: 2131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527937173843384, gen p mean: 0.0, mean p set: 0.448575496673584
loss_pred:0.028785109519958496, decouple_loss:0.010854296386241913
The modified gen p mean: 0.4529498517513275, gen p mean: 0.0, mean p set: 0.4507031738758087
loss_pred:0.028309829533100128, decouple_loss:0.01058332622051239
The modified gen p mean: 0.4521329700946808, gen p mean: 0.0, mean p set: 0.45026645064353943
loss_pred:0.027524778619408607, decouple_loss:0.010661367326974869
Iteration: 2132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4446166753768921, gen p mean: 0.0, mean p set: 0.44855284690856934
The modified gen p mean: 0.44559192657470703, gen p mean: 0.0, mean p set: 0.44910046458244324
The modified gen p mean: 0.44659703969955444, gen p mean: 0.0, mean p set: 0.45083382725715637
loss_pred:0.028012488037347794, decouple_loss:0.010888622142374516
loss_pred:0.028869062662124634, decouple_loss:0.011191211640834808
loss_pred:0.02794787660241127, decouple_loss:0.010661869309842587
Iteration: 2133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489140212535858, gen p mean: 0.0, mean p set: 0.4499320983886719
The modified gen p mean: 0.448745995759964, gen p mean: 0.0, mean p set: 0.4501916468143463
The modified gen p mean: 0.4460967481136322, gen p mean: 0.0, mean p set: 0.4501113295555115
loss_pred:0.02796916663646698, decouple_loss:0.010401402600109577
loss_pred:0.029318857938051224, decouple_loss:0.010718906298279762
loss_pred:0.027926525101065636, decouple_loss:0.010316513478755951
Iteration: 2134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450041800737381, gen p mean: 0.0, mean p set: 0.4491029977798462
The modified gen p mean: 0.4537615180015564, gen p mean: 0.0, mean p set: 0.450064092874527
The modified gen p mean: 0.4530249834060669, gen p mean: 0.0, mean p set: 0.44868043065071106
loss_pred:0.02915772795677185, decouple_loss:0.01054118201136589
loss_pred:0.028376564383506775, decouple_loss:0.010267350822687149
loss_pred:0.028150182217359543, decouple_loss:0.010339743457734585
Iteration: 2135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529261589050293, gen p mean: 0.0, mean p set: 0.44944456219673157
The modified gen p mean: 0.44898271560668945, gen p mean: 0.0, mean p set: 0.4496472179889679
The modified gen p mean: 0.4514710605144501, gen p mean: 0.0, mean p set: 0.4487886428833008
loss_pred:0.028340229764580727, decouple_loss:0.010026455856859684
loss_pred:0.029219988733530045, decouple_loss:0.010494698770344257
loss_pred:0.02843400463461876, decouple_loss:0.010270399041473866
Iteration: 2136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4438655972480774, gen p mean: 0.0, mean p set: 0.44844523072242737
The modified gen p mean: 0.4423440992832184, gen p mean: 0.0, mean p set: 0.44934555888175964
The modified gen p mean: 0.44426214694976807, gen p mean: 0.0, mean p set: 0.4478487968444824
loss_pred:0.028436116874217987, decouple_loss:0.01083757821470499
loss_pred:0.028804827481508255, decouple_loss:0.011195720173418522
loss_pred:0.02858831360936165, decouple_loss:0.010408833622932434
Iteration: 2137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453965723514557, gen p mean: 0.0, mean p set: 0.4507019817829132
The modified gen p mean: 0.4424840211868286, gen p mean: 0.0, mean p set: 0.4514707326889038
The modified gen p mean: 0.4463472366333008, gen p mean: 0.0, mean p set: 0.4505065083503723
loss_pred:0.027768682688474655, decouple_loss:0.010755262337625027
loss_pred:0.027494341135025024, decouple_loss:0.01047357078641653
loss_pred:0.028150690719485283, decouple_loss:0.010310965590178967
Iteration: 2138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.455441951751709, gen p mean: 0.0, mean p set: 0.4492282271385193
The modified gen p mean: 0.4501877725124359, gen p mean: 0.0, mean p set: 0.4509304463863373
The modified gen p mean: 0.4546414315700531, gen p mean: 0.0, mean p set: 0.4487546980381012
loss_pred:0.028912842273712158, decouple_loss:0.010599883273243904
loss_pred:0.027915798127651215, decouple_loss:0.010512365959584713
loss_pred:0.028146089985966682, decouple_loss:0.01020465325564146
Iteration: 2139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4561616778373718, gen p mean: 0.0, mean p set: 0.4489196836948395
The modified gen p mean: 0.4521265923976898, gen p mean: 0.0, mean p set: 0.4493875503540039
The modified gen p mean: 0.45530611276626587, gen p mean: 0.0, mean p set: 0.4481256306171417
loss_pred:0.027373434975743294, decouple_loss:0.010157853364944458
loss_pred:0.02890699729323387, decouple_loss:0.010567172430455685
loss_pred:0.028237732127308846, decouple_loss:0.010295341722667217
Iteration: 2140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867169857025146, gen p mean: 0.0, mean p set: 0.4491797089576721
The modified gen p mean: 0.4524242877960205, gen p mean: 0.0, mean p set: 0.44888144731521606
loss_pred:0.028314130380749702, decouple_loss:0.010130712762475014
The modified gen p mean: 0.45256495475769043, gen p mean: 0.0, mean p set: 0.44993606209754944
loss_pred:0.028043733909726143, decouple_loss:0.01013733260333538
loss_pred:0.02801193669438362, decouple_loss:0.01044460665434599
2023-05-03 04:43:33 testing...
The modified gen p mean: 0.4358729124069214, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4435781240463257, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4406706690788269, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02879253774881363, decouple_loss:0.010954326018691063
loss_pred:0.027407212182879448, decouple_loss:0.011188250035047531
loss_pred:0.027752727270126343, decouple_loss:0.01076364517211914
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028532594442367554, avg_mse: 0.0334942564368248
current test mse: 0.033494
Iteration: 2141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43961042165756226, gen p mean: 0.0, mean p set: 0.4503753185272217
The modified gen p mean: 0.44374534487724304, gen p mean: 0.0, mean p set: 0.4483988583087921
loss_pred:0.027933159843087196, decouple_loss:0.010224811732769012
loss_pred:0.028249526396393776, decouple_loss:0.010101488791406155
The modified gen p mean: 0.4389111399650574, gen p mean: 0.0, mean p set: 0.45078352093696594
loss_pred:0.02838488481938839, decouple_loss:0.010298021137714386
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
NaN value num: 0
Iteration: 2142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452044367790222, gen p mean: 0.0, mean p set: 0.4512208104133606
The modified gen p mean: 0.4418452978134155, gen p mean: 0.0, mean p set: 0.45452621579170227
The modified gen p mean: 0.4406589865684509, gen p mean: 0.0, mean p set: 0.4524688422679901
loss_pred:0.02617490291595459, decouple_loss:0.012054765596985817
loss_pred:0.027051912620663643, decouple_loss:0.011480491608381271
loss_pred:0.027234220877289772, decouple_loss:0.011598492972552776
Iteration: 2143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4620911478996277, gen p mean: 0.0, mean p set: 0.4509033262729645
The modified gen p mean: 0.46217650175094604, gen p mean: 0.0, mean p set: 0.4535713791847229
The modified gen p mean: 0.46862557530403137, gen p mean: 0.0, mean p set: 0.45086169242858887
loss_pred:0.02759138122200966, decouple_loss:0.012115785852074623
loss_pred:0.027485309168696404, decouple_loss:0.012347124516963959
loss_pred:0.02913760207593441, decouple_loss:0.012283068150281906
Iteration: 2144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4621502459049225, gen p mean: 0.0, mean p set: 0.45090457797050476
The modified gen p mean: 0.4578185975551605, gen p mean: 0.0, mean p set: 0.4553443193435669
The modified gen p mean: 0.46176838874816895, gen p mean: 0.0, mean p set: 0.451071560382843
loss_pred:0.026831423863768578, decouple_loss:0.011743769980967045
loss_pred:0.026531899347901344, decouple_loss:0.012252187356352806
loss_pred:0.027293380349874496, decouple_loss:0.011958777904510498
Iteration: 2145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678521156311035, gen p mean: 0.0, mean p set: 0.45382463932037354
The modified gen p mean: 0.44603559374809265, gen p mean: 0.0, mean p set: 0.4510650634765625
The modified gen p mean: 0.4428737163543701, gen p mean: 0.0, mean p set: 0.4527818560600281
loss_pred:0.02793133072555065, decouple_loss:0.01175263524055481
loss_pred:0.027279751375317574, decouple_loss:0.011535321362316608
loss_pred:0.027074795216321945, decouple_loss:0.011311119422316551
Iteration: 2146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4429885149002075, gen p mean: 0.0, mean p set: 0.45018270611763
The modified gen p mean: 0.44302093982696533, gen p mean: 0.0, mean p set: 0.4510363042354584
The modified gen p mean: 0.44473472237586975, gen p mean: 0.0, mean p set: 0.4523443579673767
loss_pred:0.026370609179139137, decouple_loss:0.011354828253388405
loss_pred:0.02696586586534977, decouple_loss:0.011439010500907898
loss_pred:0.027018742635846138, decouple_loss:0.011848055757582188
Iteration: 2147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542676508426666, gen p mean: 0.0, mean p set: 0.45209503173828125
The modified gen p mean: 0.4571850597858429, gen p mean: 0.0, mean p set: 0.45165497064590454
The modified gen p mean: 0.45110711455345154, gen p mean: 0.0, mean p set: 0.4524455666542053
loss_pred:0.0264381542801857, decouple_loss:0.011988540180027485
loss_pred:0.028318602591753006, decouple_loss:0.011530092917382717
loss_pred:0.026949048042297363, decouple_loss:0.011860390193760395
Iteration: 2148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45014461874961853, gen p mean: 0.0, mean p set: 0.45431381464004517
The modified gen p mean: 0.451612263917923, gen p mean: 0.0, mean p set: 0.4505993127822876
The modified gen p mean: 0.4539957046508789, gen p mean: 0.0, mean p set: 0.45338064432144165
loss_pred:0.02688194438815117, decouple_loss:0.011899027042090893
loss_pred:0.027640273794531822, decouple_loss:0.011744890362024307
loss_pred:0.027646571397781372, decouple_loss:0.012171793729066849
Iteration: 2149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45575088262557983, gen p mean: 0.0, mean p set: 0.45276156067848206
The modified gen p mean: 0.4572661519050598, gen p mean: 0.0, mean p set: 0.45265111327171326
The modified gen p mean: 0.4579824209213257, gen p mean: 0.0, mean p set: 0.4516505002975464
loss_pred:0.02639875002205372, decouple_loss:0.011927570216357708
loss_pred:0.027182701975107193, decouple_loss:0.012200756929814816
loss_pred:0.026447126641869545, decouple_loss:0.011890187859535217
Iteration: 2150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.458339124917984, gen p mean: 0.0, mean p set: 0.4516817331314087
The modified gen p mean: 0.45535463094711304, gen p mean: 0.0, mean p set: 0.45025137066841125
The modified gen p mean: 0.4534417688846588, gen p mean: 0.0, mean p set: 0.45288947224617004
loss_pred:0.02665850706398487, decouple_loss:0.012217473238706589
loss_pred:0.026752041652798653, decouple_loss:0.012294914573431015
loss_pred:0.0269412063062191, decouple_loss:0.012083440087735653
2023-05-03 04:47:59 testing...
The modified gen p mean: 0.4339667856693268, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44177332520484924, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.43937933444976807, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02893955074250698, decouple_loss:0.012812681496143341
loss_pred:0.027384581044316292, decouple_loss:0.01275963056832552
loss_pred:0.027726372703909874, decouple_loss:0.01250129658728838
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028651397675275803, avg_mse: 0.033584270626306534
current test mse: 0.033584
Iteration: 2151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4435715079307556, gen p mean: 0.0, mean p set: 0.4504178762435913
loss_pred:0.026936253532767296, decouple_loss:0.011898619122803211
The modified gen p mean: 0.4427436292171478, gen p mean: 0.0, mean p set: 0.453921914100647
loss_pred:0.02708912082016468, decouple_loss:0.01179183553904295
The modified gen p mean: 0.440346896648407, gen p mean: 0.0, mean p set: 0.45222437381744385
loss_pred:0.02683948539197445, decouple_loss:0.012217109091579914
Iteration: 2152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4426801800727844, gen p mean: 0.0, mean p set: 0.45086991786956787
The modified gen p mean: 0.44298306107521057, gen p mean: 0.0, mean p set: 0.4517882466316223
The modified gen p mean: 0.44371992349624634, gen p mean: 0.0, mean p set: 0.4498787522315979
loss_pred:0.026931151747703552, decouple_loss:0.012003243900835514
loss_pred:0.027067722752690315, decouple_loss:0.012184873223304749
loss_pred:0.025692831724882126, decouple_loss:0.012147804722189903
Iteration: 2153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.457923948764801, gen p mean: 0.0, mean p set: 0.45358556509017944
The modified gen p mean: 0.4676329493522644, gen p mean: 0.0, mean p set: 0.45231500267982483
The modified gen p mean: 0.4645490050315857, gen p mean: 0.0, mean p set: 0.4519164264202118
loss_pred:0.027251554653048515, decouple_loss:0.012318052351474762
loss_pred:0.02620791085064411, decouple_loss:0.011776984669268131
loss_pred:0.027364540845155716, decouple_loss:0.011468280106782913
Iteration: 2154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45682576298713684, gen p mean: 0.0, mean p set: 0.45006391406059265
The modified gen p mean: 0.457306444644928, gen p mean: 0.0, mean p set: 0.45088624954223633
The modified gen p mean: 0.46473273634910583, gen p mean: 0.0, mean p set: 0.45105352997779846
loss_pred:0.025487862527370453, decouple_loss:0.011396259069442749
loss_pred:0.027144039049744606, decouple_loss:0.011377029120922089
loss_pred:0.027969837188720703, decouple_loss:0.01142534427344799
Iteration: 2155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4351419508457184, gen p mean: 0.0, mean p set: 0.4537295699119568
The modified gen p mean: 0.4291609823703766, gen p mean: 0.0, mean p set: 0.4535963535308838
The modified gen p mean: 0.4388852119445801, gen p mean: 0.0, mean p set: 0.453065425157547
loss_pred:0.026489054784178734, decouple_loss:0.011985736899077892
loss_pred:0.026700757443904877, decouple_loss:0.01169588416814804
loss_pred:0.027318324893712997, decouple_loss:0.011416593566536903
Iteration: 2156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45387735962867737, gen p mean: 0.0, mean p set: 0.45249199867248535
The modified gen p mean: 0.45405980944633484, gen p mean: 0.0, mean p set: 0.4528190791606903
The modified gen p mean: 0.45447656512260437, gen p mean: 0.0, mean p set: 0.4532093107700348
loss_pred:0.027194861322641373, decouple_loss:0.010875078849494457
loss_pred:0.02635154314339161, decouple_loss:0.011240512132644653
loss_pred:0.02619156986474991, decouple_loss:0.011598971672356129
Iteration: 2157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46070483326911926, gen p mean: 0.0, mean p set: 0.45321348309516907
The modified gen p mean: 0.4624413549900055, gen p mean: 0.0, mean p set: 0.451235830783844
The modified gen p mean: 0.46478134393692017, gen p mean: 0.0, mean p set: 0.4533047676086426
loss_pred:0.02652711421251297, decouple_loss:0.011244416236877441
loss_pred:0.025847434997558594, decouple_loss:0.011267300695180893
loss_pred:0.027231741696596146, decouple_loss:0.010946153663098812
Iteration: 2158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904449582099915, gen p mean: 0.0, mean p set: 0.451716810464859
The modified gen p mean: 0.44913145899772644, gen p mean: 0.0, mean p set: 0.45252126455307007
The modified gen p mean: 0.4475453197956085, gen p mean: 0.0, mean p set: 0.4507260322570801
loss_pred:0.026643013581633568, decouple_loss:0.01140427403151989
loss_pred:0.026060989126563072, decouple_loss:0.011093847453594208
loss_pred:0.02701253816485405, decouple_loss:0.011415892280638218
Iteration: 2159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473717212677002, gen p mean: 0.0, mean p set: 0.4499439597129822
The modified gen p mean: 0.4492902159690857, gen p mean: 0.0, mean p set: 0.45108428597450256
The modified gen p mean: 0.44628822803497314, gen p mean: 0.0, mean p set: 0.4524182975292206
loss_pred:0.026524201035499573, decouple_loss:0.01142768282443285
loss_pred:0.027660032734274864, decouple_loss:0.011258577927947044
loss_pred:0.026801835745573044, decouple_loss:0.011334529146552086
Iteration: 2160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4555959105491638, gen p mean: 0.0, mean p set: 0.4520728290081024
The modified gen p mean: 0.4539787173271179, gen p mean: 0.0, mean p set: 0.45306864380836487
The modified gen p mean: 0.4510343074798584, gen p mean: 0.0, mean p set: 0.4545804262161255
loss_pred:0.025833699852228165, decouple_loss:0.010929533280432224
loss_pred:0.02697317861020565, decouple_loss:0.011219961568713188
loss_pred:0.027476634830236435, decouple_loss:0.011808195151388645
2023-05-03 04:51:40 testing...
The modified gen p mean: 0.45053356885910034, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44224900007247925, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44761016964912415, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.027107758447527885, decouple_loss:0.012067367322742939
loss_pred:0.028590034693479538, decouple_loss:0.01213741209357977
loss_pred:0.0274336077272892, decouple_loss:0.011889179237186909
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02831203304231167, avg_mse: 0.03308330103754997
current test mse: 0.033083
Iteration: 2161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465620219707489, gen p mean: 0.0, mean p set: 0.45452532172203064
loss_pred:0.02744642272591591, decouple_loss:0.011204218491911888
The modified gen p mean: 0.4501969814300537, gen p mean: 0.0, mean p set: 0.4515113830566406
loss_pred:0.02663811482489109, decouple_loss:0.011084182187914848
The modified gen p mean: 0.4485292136669159, gen p mean: 0.0, mean p set: 0.45242658257484436
loss_pred:0.026738958433270454, decouple_loss:0.01096299011260271
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
NaN value num: 0
Iteration: 2162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652310013771057, gen p mean: 0.0, mean p set: 0.4484156668186188
The modified gen p mean: 0.45184949040412903, gen p mean: 0.0, mean p set: 0.44871607422828674
The modified gen p mean: 0.45171552896499634, gen p mean: 0.0, mean p set: 0.4469790756702423
loss_pred:0.02851056680083275, decouple_loss:0.011755989864468575
loss_pred:0.027913592755794525, decouple_loss:0.01234445534646511
loss_pred:0.027578528970479965, decouple_loss:0.012400797568261623
Iteration: 2163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45383957028388977, gen p mean: 0.0, mean p set: 0.44952526688575745
The modified gen p mean: 0.4496820867061615, gen p mean: 0.0, mean p set: 0.44714057445526123
The modified gen p mean: 0.45233115553855896, gen p mean: 0.0, mean p set: 0.44681212306022644
loss_pred:0.028062336146831512, decouple_loss:0.012076379731297493loss_pred:0.027387579903006554, decouple_loss:0.011350313201546669
loss_pred:0.028291381895542145, decouple_loss:0.0118937399238348
Iteration: 2164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527057111263275, gen p mean: 0.0, mean p set: 0.44918572902679443
The modified gen p mean: 0.4489249289035797, gen p mean: 0.0, mean p set: 0.44640052318573
The modified gen p mean: 0.4510999321937561, gen p mean: 0.0, mean p set: 0.4467185139656067
loss_pred:0.02818208374083042, decouple_loss:0.011334876529872417
loss_pred:0.02770337648689747, decouple_loss:0.011536521837115288
loss_pred:0.028348200023174286, decouple_loss:0.01116728875786066
Iteration: 2165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4413462281227112, gen p mean: 0.0, mean p set: 0.44777223467826843
The modified gen p mean: 0.4354797899723053, gen p mean: 0.0, mean p set: 0.44926485419273376
The modified gen p mean: 0.4372684359550476, gen p mean: 0.0, mean p set: 0.44728726148605347
loss_pred:0.028547456488013268, decouple_loss:0.01208171434700489
loss_pred:0.028304792940616608, decouple_loss:0.011483830399811268
loss_pred:0.027179908007383347, decouple_loss:0.011205595917999744
Iteration: 2166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481595754623413, gen p mean: 0.0, mean p set: 0.44858571887016296
The modified gen p mean: 0.44516998529434204, gen p mean: 0.0, mean p set: 0.4482261538505554
The modified gen p mean: 0.4447372555732727, gen p mean: 0.0, mean p set: 0.4487701654434204
loss_pred:0.028601983562111855, decouple_loss:0.011429106816649437
loss_pred:0.02717677876353264, decouple_loss:0.011267360299825668
loss_pred:0.027625855058431625, decouple_loss:0.01121522206813097
Iteration: 2167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4586330056190491, gen p mean: 0.0, mean p set: 0.4487886130809784The modified gen p mean: 0.45660504698753357, gen p mean: 0.0, mean p set: 0.4480617940425873
The modified gen p mean: 0.45283976197242737, gen p mean: 0.0, mean p set: 0.4461691081523895
loss_pred:0.02841869369149208, decouple_loss:0.010961607098579407
loss_pred:0.028241124004125595, decouple_loss:0.01106209959834814
loss_pred:0.027653846889734268, decouple_loss:0.011140023358166218
Iteration: 2168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44327908754348755, gen p mean: 0.0, mean p set: 0.446366548538208
The modified gen p mean: 0.4497794508934021, gen p mean: 0.0, mean p set: 0.4493609070777893
The modified gen p mean: 0.44937631487846375, gen p mean: 0.0, mean p set: 0.4461515247821808
loss_pred:0.027166111394762993, decouple_loss:0.011043991893529892
loss_pred:0.028387725353240967, decouple_loss:0.011137467809021473
loss_pred:0.02717951498925686, decouple_loss:0.011423063464462757
Iteration: 2169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4321978688240051, gen p mean: 0.0, mean p set: 0.4468950033187866
The modified gen p mean: 0.43809446692466736, gen p mean: 0.0, mean p set: 0.44680410623550415
The modified gen p mean: 0.43716874718666077, gen p mean: 0.0, mean p set: 0.4469743072986603
loss_pred:0.026934633031487465, decouple_loss:0.011168278753757477
loss_pred:0.027318254113197327, decouple_loss:0.011234092526137829
loss_pred:0.028172126039862633, decouple_loss:0.010812006890773773
Iteration: 2170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452201783657074, gen p mean: 0.0, mean p set: 0.4485533535480499
The modified gen p mean: 0.45341911911964417, gen p mean: 0.0, mean p set: 0.4477316439151764
The modified gen p mean: 0.44929391145706177, gen p mean: 0.0, mean p set: 0.4480063021183014
loss_pred:0.028339078649878502, decouple_loss:0.010823932476341724
loss_pred:0.027857890352606773, decouple_loss:0.010733610950410366
loss_pred:0.02690964750945568, decouple_loss:0.010953841730952263
2023-05-03 04:56:05 testing...
The modified gen p mean: 0.4558054506778717, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45083749294281006, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4585917592048645, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02742861770093441, decouple_loss:0.011236966587603092
loss_pred:0.028445111587643623, decouple_loss:0.011526022106409073
loss_pred:0.027193741872906685, decouple_loss:0.011311894282698631
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02825707197189331, avg_mse: 0.033100441098213196
current test mse: 0.0331
Iteration: 2171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45419391989707947, gen p mean: 0.0, mean p set: 0.44728389382362366
The modified gen p mean: 0.4574628174304962, gen p mean: 0.0, mean p set: 0.44684743881225586
loss_pred:0.02777632139623165, decouple_loss:0.010850858874619007
loss_pred:0.02791304513812065, decouple_loss:0.010254817083477974
The modified gen p mean: 0.45619437098503113, gen p mean: 0.0, mean p set: 0.44678995013237
loss_pred:0.02799784019589424, decouple_loss:0.010475530289113522
Iteration: 2172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4429778456687927, gen p mean: 0.0, mean p set: 0.44636404514312744
The modified gen p mean: 0.44258344173431396, gen p mean: 0.0, mean p set: 0.44588136672973633
The modified gen p mean: 0.44326505064964294, gen p mean: 0.0, mean p set: 0.44586169719696045
loss_pred:0.027250219136476517, decouple_loss:0.01068966742604971
loss_pred:0.028310246765613556, decouple_loss:0.010515263304114342
loss_pred:0.027083953842520714, decouple_loss:0.010834649205207825
Iteration: 2173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43843692541122437, gen p mean: 0.0, mean p set: 0.446968138217926
The modified gen p mean: 0.4367454946041107, gen p mean: 0.0, mean p set: 0.447811096906662
The modified gen p mean: 0.4356738030910492, gen p mean: 0.0, mean p set: 0.4476713538169861
loss_pred:0.0281196478754282, decouple_loss:0.00992574729025364
loss_pred:0.027038298547267914, decouple_loss:0.011080501601099968
loss_pred:0.027323037385940552, decouple_loss:0.01072698924690485
Iteration: 2174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4538182318210602, gen p mean: 0.0, mean p set: 0.44609320163726807
The modified gen p mean: 0.4510522782802582, gen p mean: 0.0, mean p set: 0.44657647609710693
The modified gen p mean: 0.4530755877494812, gen p mean: 0.0, mean p set: 0.44781720638275146
loss_pred:0.02598358504474163, decouple_loss:0.010696127079427242
loss_pred:0.026710117235779762, decouple_loss:0.010768362320959568
loss_pred:0.02738390862941742, decouple_loss:0.010465643368661404
Iteration: 2175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45190438628196716, gen p mean: 0.0, mean p set: 0.4465305209159851
The modified gen p mean: 0.4502132833003998, gen p mean: 0.0, mean p set: 0.4464896619319916
The modified gen p mean: 0.44992703199386597, gen p mean: 0.0, mean p set: 0.4461638331413269
loss_pred:0.027690080925822258, decouple_loss:0.010266706347465515
loss_pred:0.027091898024082184, decouple_loss:0.010548876598477364
loss_pred:0.02739088423550129, decouple_loss:0.010586143471300602
Iteration: 2176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465838670730591, gen p mean: 0.0, mean p set: 0.4470517337322235
The modified gen p mean: 0.44321301579475403, gen p mean: 0.0, mean p set: 0.4475530982017517
The modified gen p mean: 0.4450850486755371, gen p mean: 0.0, mean p set: 0.4476267099380493
loss_pred:0.027851680293679237, decouple_loss:0.010189469903707504
loss_pred:0.028408775106072426, decouple_loss:0.01034847553819418
loss_pred:0.02817981317639351, decouple_loss:0.010231655091047287
Iteration: 2177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206940174102783, gen p mean: 0.0, mean p set: 0.44664642214775085
The modified gen p mean: 0.4516620934009552, gen p mean: 0.0, mean p set: 0.4458634853363037
The modified gen p mean: 0.45152747631073, gen p mean: 0.0, mean p set: 0.4475557208061218
loss_pred:0.027369827032089233, decouple_loss:0.010185075923800468
loss_pred:0.02674342505633831, decouple_loss:0.010329896584153175
loss_pred:0.028198804706335068, decouple_loss:0.010106532834470272
Iteration: 2178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4393129050731659, gen p mean: 0.0, mean p set: 0.4471185803413391
The modified gen p mean: 0.4419870972633362, gen p mean: 0.0, mean p set: 0.44727084040641785
The modified gen p mean: 0.4426749646663666, gen p mean: 0.0, mean p set: 0.44641271233558655
loss_pred:0.02734684944152832, decouple_loss:0.010155980475246906loss_pred:0.02716066502034664, decouple_loss:0.0102595379576087
loss_pred:0.027014341205358505, decouple_loss:0.009847866371273994
Iteration: 2179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4360669255256653, gen p mean: 0.0, mean p set: 0.44770559668540955
The modified gen p mean: 0.43281394243240356, gen p mean: 0.0, mean p set: 0.44963929057121277
The modified gen p mean: 0.4375358819961548, gen p mean: 0.0, mean p set: 0.4478236734867096
loss_pred:0.027171842753887177, decouple_loss:0.00996945146471262
loss_pred:0.027821339666843414, decouple_loss:0.01033711340278387
loss_pred:0.027806391939520836, decouple_loss:0.009812558069825172
Iteration: 2180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4601493775844574, gen p mean: 0.0, mean p set: 0.446418434381485
The modified gen p mean: 0.4572802782058716, gen p mean: 0.0, mean p set: 0.44760608673095703
The modified gen p mean: 0.45916250348091125, gen p mean: 0.0, mean p set: 0.4475998878479004
loss_pred:0.02795252948999405, decouple_loss:0.009835307486355305
loss_pred:0.027717845514416695, decouple_loss:0.009915302507579327
loss_pred:0.02843746542930603, decouple_loss:0.010625536553561687
2023-05-03 04:59:48 testing...
The modified gen p mean: 0.4571050703525543, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45960885286331177, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4519038796424866, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.027265114709734917, decouple_loss:0.010616094805300236
loss_pred:0.027052123099565506, decouple_loss:0.010813461616635323
loss_pred:0.028357913717627525, decouple_loss:0.010829239152371883
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0280960313975811, avg_mse: 0.03291274234652519
current test mse: 0.032913
Iteration: 2181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537149667739868, gen p mean: 0.0, mean p set: 0.44987761974334717
loss_pred:0.02657565288245678, decouple_loss:0.009978133253753185
The modified gen p mean: 0.45562508702278137, gen p mean: 0.0, mean p set: 0.4480586051940918
loss_pred:0.027850408107042313, decouple_loss:0.010705847293138504
The modified gen p mean: 0.45891517400741577, gen p mean: 0.0, mean p set: 0.4487777352333069
loss_pred:0.027949105948209763, decouple_loss:0.010145633481442928
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 2182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457300901412964, gen p mean: 0.0, mean p set: 0.44941237568855286
The modified gen p mean: 0.44130024313926697, gen p mean: 0.0, mean p set: 0.4496983587741852
The modified gen p mean: 0.4389403164386749, gen p mean: 0.0, mean p set: 0.4494885504245758
loss_pred:0.02893943339586258, decouple_loss:0.011589769273996353
loss_pred:0.029633091762661934, decouple_loss:0.011388623155653477
loss_pred:0.030153941363096237, decouple_loss:0.011272634379565716
Iteration: 2183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463496804237366, gen p mean: 0.0, mean p set: 0.4487136900424957
The modified gen p mean: 0.44521433115005493, gen p mean: 0.0, mean p set: 0.450310081243515
The modified gen p mean: 0.4443609416484833, gen p mean: 0.0, mean p set: 0.4492739737033844
loss_pred:0.03002571500837803, decouple_loss:0.0113268056884408
loss_pred:0.02910134755074978, decouple_loss:0.011143726296722889
loss_pred:0.028886612504720688, decouple_loss:0.010943112894892693
Iteration: 2184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536780118942261, gen p mean: 0.0, mean p set: 0.44842392206192017
The modified gen p mean: 0.45487335324287415, gen p mean: 0.0, mean p set: 0.4494836926460266
The modified gen p mean: 0.45401614904403687, gen p mean: 0.0, mean p set: 0.4504038989543915
loss_pred:0.02780478447675705, decouple_loss:0.010722261853516102
loss_pred:0.02722245827317238, decouple_loss:0.010888485237956047
loss_pred:0.02812918648123741, decouple_loss:0.010476919822394848
Iteration: 2185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113155245780945, gen p mean: 0.0, mean p set: 0.4483579099178314
The modified gen p mean: 0.44711655378341675, gen p mean: 0.0, mean p set: 0.4499303698539734
The modified gen p mean: 0.44947442412376404, gen p mean: 0.0, mean p set: 0.4490082263946533
loss_pred:0.027434509247541428, decouple_loss:0.010727494955062866
loss_pred:0.029319312423467636, decouple_loss:0.011208932846784592
loss_pred:0.027074208483099937, decouple_loss:0.01116146706044674
Iteration: 2186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44129449129104614, gen p mean: 0.0, mean p set: 0.44991445541381836
The modified gen p mean: 0.44326820969581604, gen p mean: 0.0, mean p set: 0.4489958584308624
The modified gen p mean: 0.44312402606010437, gen p mean: 0.0, mean p set: 0.4480412006378174
loss_pred:0.027681587263941765, decouple_loss:0.010450046509504318
loss_pred:0.029003160074353218, decouple_loss:0.01091537531465292
loss_pred:0.02783031016588211, decouple_loss:0.011279218830168247
Iteration: 2187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537796378135681, gen p mean: 0.0, mean p set: 0.4493550956249237
The modified gen p mean: 0.45630699396133423, gen p mean: 0.0, mean p set: 0.44848892092704773
The modified gen p mean: 0.4551592469215393, gen p mean: 0.0, mean p set: 0.45003435015678406
loss_pred:0.028052443638443947, decouple_loss:0.010772719979286194
loss_pred:0.029266955330967903, decouple_loss:0.010969853028655052
loss_pred:0.027277454733848572, decouple_loss:0.010140667669475079
Iteration: 2188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4556804597377777, gen p mean: 0.0, mean p set: 0.450520396232605
The modified gen p mean: 0.4533848464488983, gen p mean: 0.0, mean p set: 0.449236124753952
The modified gen p mean: 0.4586213529109955, gen p mean: 0.0, mean p set: 0.4515393376350403
loss_pred:0.02864064648747444, decouple_loss:0.010982224717736244
loss_pred:0.02713576704263687, decouple_loss:0.01012529619038105
loss_pred:0.02913961000740528, decouple_loss:0.011067934334278107
Iteration: 2189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454764723777771, gen p mean: 0.0, mean p set: 0.44901344180107117
The modified gen p mean: 0.4443139433860779, gen p mean: 0.0, mean p set: 0.4484051764011383
The modified gen p mean: 0.44062477350234985, gen p mean: 0.0, mean p set: 0.44899484515190125
loss_pred:0.028432980179786682, decouple_loss:0.01077946461737156loss_pred:0.028536677360534668, decouple_loss:0.01076554786413908
loss_pred:0.029158776625990868, decouple_loss:0.010578447952866554
Iteration: 2190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4441990256309509, gen p mean: 0.0, mean p set: 0.44971972703933716
The modified gen p mean: 0.43951237201690674, gen p mean: 0.0, mean p set: 0.45059165358543396
The modified gen p mean: 0.4434257745742798, gen p mean: 0.0, mean p set: 0.4495154023170471
loss_pred:0.027737600728869438, decouple_loss:0.01033418532460928
loss_pred:0.02789851650595665, decouple_loss:0.010169150307774544
loss_pred:0.027749093249440193, decouple_loss:0.010604209266602993
2023-05-03 05:04:15 testing...
The modified gen p mean: 0.44748392701148987, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45271551609039307, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45525801181793213, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02827174961566925, decouple_loss:0.010806024074554443
loss_pred:0.02721930295228958, decouple_loss:0.010485655628144741
loss_pred:0.02688697539269924, decouple_loss:0.010454836301505566
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027988452464342117, avg_mse: 0.032786425203084946
current test mse: 0.032786
Iteration: 2191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45454180240631104, gen p mean: 0.0, mean p set: 0.4493807256221771
The modified gen p mean: 0.4546646177768707, gen p mean: 0.0, mean p set: 0.4491713047027588
loss_pred:0.0279865600168705, decouple_loss:0.010757263749837875
loss_pred:0.028566308319568634, decouple_loss:0.010641454719007015
The modified gen p mean: 0.45817577838897705, gen p mean: 0.0, mean p set: 0.44977647066116333
loss_pred:0.02836930938065052, decouple_loss:0.010457172989845276
Iteration: 2192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906720519065857, gen p mean: 0.0, mean p set: 0.4484458863735199
The modified gen p mean: 0.4474274516105652, gen p mean: 0.0, mean p set: 0.4495515525341034
The modified gen p mean: 0.44772157073020935, gen p mean: 0.0, mean p set: 0.44850850105285645
loss_pred:0.027711601927876472, decouple_loss:0.010538836009800434
loss_pred:0.02692023664712906, decouple_loss:0.009899593889713287
loss_pred:0.027570845559239388, decouple_loss:0.010277943685650826
Iteration: 2193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443061947822571, gen p mean: 0.0, mean p set: 0.4495806396007538
The modified gen p mean: 0.44870346784591675, gen p mean: 0.0, mean p set: 0.4488753378391266
The modified gen p mean: 0.447537362575531, gen p mean: 0.0, mean p set: 0.4488248825073242
loss_pred:0.027110552415251732, decouple_loss:0.01037722546607256
loss_pred:0.028933187946677208, decouple_loss:0.01080819871276617
loss_pred:0.028300181031227112, decouple_loss:0.01057366468012333
Iteration: 2194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071059465408325, gen p mean: 0.0, mean p set: 0.44829061627388
The modified gen p mean: 0.4558543562889099, gen p mean: 0.0, mean p set: 0.44910016655921936
The modified gen p mean: 0.4536347985267639, gen p mean: 0.0, mean p set: 0.4485754370689392
loss_pred:0.02878471650183201, decouple_loss:0.010111999697983265
loss_pred:0.02764183096587658, decouple_loss:0.009961385279893875
loss_pred:0.029218871146440506, decouple_loss:0.010364312678575516
Iteration: 2195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803425669670105, gen p mean: 0.0, mean p set: 0.44871246814727783
The modified gen p mean: 0.44890424609184265, gen p mean: 0.0, mean p set: 0.4487546384334564
The modified gen p mean: 0.44765257835388184, gen p mean: 0.0, mean p set: 0.4497894048690796
loss_pred:0.028140051290392876, decouple_loss:0.01002492569386959
loss_pred:0.02909133769571781, decouple_loss:0.01014792826026678
loss_pred:0.02729378454387188, decouple_loss:0.009803042747080326
Iteration: 2196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4439188241958618, gen p mean: 0.0, mean p set: 0.4499305486679077
The modified gen p mean: 0.4477209746837616, gen p mean: 0.0, mean p set: 0.44927287101745605
The modified gen p mean: 0.44533756375312805, gen p mean: 0.0, mean p set: 0.44996556639671326
loss_pred:0.0268165934830904, decouple_loss:0.00962821114808321
loss_pred:0.02850363776087761, decouple_loss:0.009952373802661896
loss_pred:0.028323015198111534, decouple_loss:0.01038414891809225
Iteration: 2197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45348602533340454, gen p mean: 0.0, mean p set: 0.44964277744293213
The modified gen p mean: 0.44668900966644287, gen p mean: 0.0, mean p set: 0.44910159707069397
The modified gen p mean: 0.4488571882247925, gen p mean: 0.0, mean p set: 0.44897210597991943
loss_pred:0.028937367722392082, decouple_loss:0.010298042558133602
loss_pred:0.028444591909646988, decouple_loss:0.010140995495021343
loss_pred:0.028790803626179695, decouple_loss:0.010515719652175903
Iteration: 2198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4571192264556885, gen p mean: 0.0, mean p set: 0.4500153958797455
The modified gen p mean: 0.45989617705345154, gen p mean: 0.0, mean p set: 0.4494929015636444
The modified gen p mean: 0.4571431875228882, gen p mean: 0.0, mean p set: 0.44834738969802856
loss_pred:0.026871059089899063, decouple_loss:0.010087464936077595
loss_pred:0.028182584792375565, decouple_loss:0.00965227372944355
loss_pred:0.027307093143463135, decouple_loss:0.009900215081870556
Iteration: 2199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45341047644615173, gen p mean: 0.0, mean p set: 0.4497624933719635
The modified gen p mean: 0.4488009810447693, gen p mean: 0.0, mean p set: 0.45004376769065857
The modified gen p mean: 0.44682928919792175, gen p mean: 0.0, mean p set: 0.44832560420036316
loss_pred:0.028212066739797592, decouple_loss:0.01007205992937088
loss_pred:0.026572389528155327, decouple_loss:0.009752489626407623
loss_pred:0.027075696736574173, decouple_loss:0.010406882502138615
Iteration: 2200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4384617209434509, gen p mean: 0.0, mean p set: 0.44986000657081604
The modified gen p mean: 0.4388602674007416, gen p mean: 0.0, mean p set: 0.45054665207862854
The modified gen p mean: 0.4384845495223999, gen p mean: 0.0, mean p set: 0.451172411441803
loss_pred:0.02851528860628605, decouple_loss:0.010076194070279598
loss_pred:0.028269389644265175, decouple_loss:0.010225721634924412
loss_pred:0.02876712568104267, decouple_loss:0.010305370204150677
2023-05-03 05:07:57 testing...
The modified gen p mean: 0.44064006209373474, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4459230899810791, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.448994517326355, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028263747692108154, decouple_loss:0.010861268267035484
loss_pred:0.027166305109858513, decouple_loss:0.010356379672884941
loss_pred:0.02671694941818714, decouple_loss:0.010250219143927097
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02790679782629013, avg_mse: 0.03270677477121353
current test mse: 0.032707
Iteration: 2201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44512343406677246, gen p mean: 0.0, mean p set: 0.4500974118709564
The modified gen p mean: 0.4468228816986084, gen p mean: 0.0, mean p set: 0.4503089487552643
loss_pred:0.028335990384221077, decouple_loss:0.010177918709814548
loss_pred:0.0267472006380558, decouple_loss:0.010067402385175228
The modified gen p mean: 0.4453095495700836, gen p mean: 0.0, mean p set: 0.44933852553367615
loss_pred:0.026839924976229668, decouple_loss:0.010333484970033169
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 2202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4554632306098938, gen p mean: 0.0, mean p set: 0.4472888708114624
The modified gen p mean: 0.4549205005168915, gen p mean: 0.0, mean p set: 0.44736430048942566
The modified gen p mean: 0.4524843394756317, gen p mean: 0.0, mean p set: 0.4484843611717224
loss_pred:0.027674371376633644, decouple_loss:0.011459183879196644
loss_pred:0.027493204921483994, decouple_loss:0.010926120914518833
loss_pred:0.027513761073350906, decouple_loss:0.010475640185177326
Iteration: 2203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948557019233704, gen p mean: 0.0, mean p set: 0.4479072690010071
The modified gen p mean: 0.45289623737335205, gen p mean: 0.0, mean p set: 0.4476010799407959
The modified gen p mean: 0.4522663950920105, gen p mean: 0.0, mean p set: 0.4477294087409973
loss_pred:0.027146385982632637, decouple_loss:0.011117669753730297
loss_pred:0.027736347168684006, decouple_loss:0.010630892589688301
loss_pred:0.028630957007408142, decouple_loss:0.010464731603860855
Iteration: 2204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453190863132477, gen p mean: 0.0, mean p set: 0.4485948383808136
The modified gen p mean: 0.44158074259757996, gen p mean: 0.0, mean p set: 0.44708749651908875
The modified gen p mean: 0.44302618503570557, gen p mean: 0.0, mean p set: 0.4478473961353302
loss_pred:0.028084149584174156, decouple_loss:0.01036305632442236
loss_pred:0.028748780488967896, decouple_loss:0.0105905095115304
loss_pred:0.028884805738925934, decouple_loss:0.010588194243609905
Iteration: 2205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490855038166046, gen p mean: 0.0, mean p set: 0.4486437737941742
The modified gen p mean: 0.44690340757369995, gen p mean: 0.0, mean p set: 0.44802361726760864
The modified gen p mean: 0.4427242577075958, gen p mean: 0.0, mean p set: 0.44723477959632874
loss_pred:0.027330219745635986, decouple_loss:0.010427795350551605
loss_pred:0.02759336307644844, decouple_loss:0.01006754394620657
loss_pred:0.028301242738962173, decouple_loss:0.010090969502925873
Iteration: 2206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45329779386520386, gen p mean: 0.0, mean p set: 0.4481446444988251
The modified gen p mean: 0.4458927810192108, gen p mean: 0.0, mean p set: 0.4472969174385071
The modified gen p mean: 0.4501305818557739, gen p mean: 0.0, mean p set: 0.44742023944854736
loss_pred:0.028827257454395294, decouple_loss:0.00999865960329771
loss_pred:0.02684652991592884, decouple_loss:0.010319600813090801
loss_pred:0.027681471779942513, decouple_loss:0.00984566193073988
Iteration: 2207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44202473759651184, gen p mean: 0.0, mean p set: 0.4482421875
The modified gen p mean: 0.4390077590942383, gen p mean: 0.0, mean p set: 0.4471310079097748
The modified gen p mean: 0.4406495690345764, gen p mean: 0.0, mean p set: 0.44880321621894836
loss_pred:0.027284221723675728, decouple_loss:0.010257679969072342
loss_pred:0.026914315298199654, decouple_loss:0.010240904986858368
loss_pred:0.0276961550116539, decouple_loss:0.010522982105612755
Iteration: 2208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477706849575043, gen p mean: 0.0, mean p set: 0.44817429780960083
The modified gen p mean: 0.44813042879104614, gen p mean: 0.0, mean p set: 0.4478357136249542
The modified gen p mean: 0.45312172174453735, gen p mean: 0.0, mean p set: 0.44871804118156433
loss_pred:0.027298714965581894, decouple_loss:0.010590226389467716
loss_pred:0.02680840529501438, decouple_loss:0.0102846659719944
loss_pred:0.028205182403326035, decouple_loss:0.010452188551425934
Iteration: 2209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45349180698394775, gen p mean: 0.0, mean p set: 0.44780635833740234
The modified gen p mean: 0.45651310682296753, gen p mean: 0.0, mean p set: 0.4480918347835541
The modified gen p mean: 0.45808425545692444, gen p mean: 0.0, mean p set: 0.4481441080570221
loss_pred:0.02834443189203739, decouple_loss:0.010706284083425999
loss_pred:0.02885337360203266, decouple_loss:0.01034822128713131
loss_pred:0.027187924832105637, decouple_loss:0.010474622249603271
Iteration: 2210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4410187900066376, gen p mean: 0.0, mean p set: 0.4488847255706787
The modified gen p mean: 0.4435008764266968, gen p mean: 0.0, mean p set: 0.4472491443157196
The modified gen p mean: 0.4455070197582245, gen p mean: 0.0, mean p set: 0.4476657211780548
loss_pred:0.026945604011416435, decouple_loss:0.010749300010502338
loss_pred:0.0275759007781744, decouple_loss:0.010635141283273697
loss_pred:0.027159597724676132, decouple_loss:0.010639778338372707
2023-05-03 05:12:17 testing...
The modified gen p mean: 0.44890281558036804, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44018322229385376, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4456833600997925, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.026876073330640793, decouple_loss:0.010333480313420296
loss_pred:0.027241384610533714, decouple_loss:0.010251165367662907loss_pred:0.02829815074801445, decouple_loss:0.010505085811018944
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027990031987428665, avg_mse: 0.032799188047647476
current test mse: 0.032799
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43835633993148804, gen p mean: 0.0, mean p set: 0.4497888684272766
The modified gen p mean: 0.4445105493068695, gen p mean: 0.0, mean p set: 0.44771599769592285
loss_pred:0.026019010692834854, decouple_loss:0.010903422720730305
loss_pred:0.02670481614768505, decouple_loss:0.010642454028129578
The modified gen p mean: 0.44693994522094727, gen p mean: 0.0, mean p set: 0.44862401485443115
loss_pred:0.028313111513853073, decouple_loss:0.010004457086324692
Iteration: 2212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012134313583374, gen p mean: 0.0, mean p set: 0.44736161828041077
The modified gen p mean: 0.4546574354171753, gen p mean: 0.0, mean p set: 0.4475705623626709
The modified gen p mean: 0.45531997084617615, gen p mean: 0.0, mean p set: 0.44842514395713806
loss_pred:0.026314161717891693, decouple_loss:0.010010145604610443
loss_pred:0.026814229786396027, decouple_loss:0.009775125421583652
loss_pred:0.027890793979167938, decouple_loss:0.009950404986739159
Iteration: 2213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803979992866516, gen p mean: 0.0, mean p set: 0.4482831358909607
The modified gen p mean: 0.4486447870731354, gen p mean: 0.0, mean p set: 0.4477914571762085
The modified gen p mean: 0.45516419410705566, gen p mean: 0.0, mean p set: 0.4478200376033783
loss_pred:0.027050526812672615, decouple_loss:0.009911825880408287
loss_pred:0.027053071185946465, decouple_loss:0.010339573957026005
loss_pred:0.028119245544075966, decouple_loss:0.010085765272378922
Iteration: 2214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4428638517856598, gen p mean: 0.0, mean p set: 0.4477764964103699
The modified gen p mean: 0.43806764483451843, gen p mean: 0.0, mean p set: 0.4490325152873993
The modified gen p mean: 0.4415636360645294, gen p mean: 0.0, mean p set: 0.4477703869342804
loss_pred:0.0269903764128685, decouple_loss:0.01057168934494257
loss_pred:0.0260496623814106, decouple_loss:0.010330691002309322
loss_pred:0.02819664590060711, decouple_loss:0.01027615461498499
Iteration: 2215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44655126333236694, gen p mean: 0.0, mean p set: 0.44822028279304504
The modified gen p mean: 0.44683098793029785, gen p mean: 0.0, mean p set: 0.4484269320964813
The modified gen p mean: 0.45258352160453796, gen p mean: 0.0, mean p set: 0.4470870792865753
loss_pred:0.026556290686130524, decouple_loss:0.010346037335693836
loss_pred:0.026677686721086502, decouple_loss:0.010413914918899536
loss_pred:0.028485935181379318, decouple_loss:0.010170858353376389
Iteration: 2216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453908771276474, gen p mean: 0.0, mean p set: 0.44747352600097656
The modified gen p mean: 0.45682817697525024, gen p mean: 0.0, mean p set: 0.4479181170463562
The modified gen p mean: 0.4506073296070099, gen p mean: 0.0, mean p set: 0.44930416345596313
loss_pred:0.027683014050126076, decouple_loss:0.010041797533631325
loss_pred:0.027279408648610115, decouple_loss:0.009489240124821663
loss_pred:0.02671062760055065, decouple_loss:0.009958488866686821
Iteration: 2217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743582606315613, gen p mean: 0.0, mean p set: 0.44728556275367737
The modified gen p mean: 0.44776204228401184, gen p mean: 0.0, mean p set: 0.44701075553894043
The modified gen p mean: 0.4498048424720764, gen p mean: 0.0, mean p set: 0.4483122229576111
loss_pred:0.028064945712685585, decouple_loss:0.010009240359067917
loss_pred:0.02742837369441986, decouple_loss:0.00995321199297905
loss_pred:0.027064524590969086, decouple_loss:0.009734504856169224
Iteration: 2218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43879520893096924, gen p mean: 0.0, mean p set: 0.44843074679374695
The modified gen p mean: 0.44330599904060364, gen p mean: 0.0, mean p set: 0.4477572739124298
The modified gen p mean: 0.44184789061546326, gen p mean: 0.0, mean p set: 0.44793686270713806
loss_pred:0.028009852394461632, decouple_loss:0.009775456041097641
loss_pred:0.02853495627641678, decouple_loss:0.009805501438677311
loss_pred:0.027381109073758125, decouple_loss:0.010034383274614811
Iteration: 2219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4440456032752991, gen p mean: 0.0, mean p set: 0.44910916686058044
The modified gen p mean: 0.4379003047943115, gen p mean: 0.0, mean p set: 0.4487501382827759
The modified gen p mean: 0.4420519471168518, gen p mean: 0.0, mean p set: 0.44737330079078674
loss_pred:0.028281448408961296, decouple_loss:0.010149424895644188
loss_pred:0.02650371380150318, decouple_loss:0.010021669790148735
loss_pred:0.02668529562652111, decouple_loss:0.0099366819486022
Iteration: 2220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4623595178127289, gen p mean: 0.0, mean p set: 0.44670602679252625
The modified gen p mean: 0.4576476514339447, gen p mean: 0.0, mean p set: 0.44782111048698425
The modified gen p mean: 0.45901554822921753, gen p mean: 0.0, mean p set: 0.44864028692245483
loss_pred:0.028136873617768288, decouple_loss:0.009953116066753864
loss_pred:0.02740788646042347, decouple_loss:0.00990323256701231
loss_pred:0.02783336490392685, decouple_loss:0.009965936653316021
2023-05-03 05:16:00 testing...
The modified gen p mean: 0.4542504847049713, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4489847719669342, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45704153180122375, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026928182691335678, decouple_loss:0.009973673149943352
loss_pred:0.027952831238508224, decouple_loss:0.010140537284314632
loss_pred:0.026689212769269943, decouple_loss:0.01015522051602602
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027694566175341606, avg_mse: 0.03243624046444893
current test mse: 0.032436
Iteration: 2221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118090510368347, gen p mean: 0.0, mean p set: 0.4473079442977905
loss_pred:0.026901425793766975, decouple_loss:0.010202041827142239
The modified gen p mean: 0.4520348310470581, gen p mean: 0.0, mean p set: 0.4476999342441559
loss_pred:0.027425281703472137, decouple_loss:0.009641903452575207
The modified gen p mean: 0.45592159032821655, gen p mean: 0.0, mean p set: 0.4479510188102722
loss_pred:0.027453020215034485, decouple_loss:0.009543057531118393
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 2222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44088324904441833, gen p mean: 0.0, mean p set: 0.4478902518749237
The modified gen p mean: 0.44406548142433167, gen p mean: 0.0, mean p set: 0.44694095849990845
The modified gen p mean: 0.4388520419597626, gen p mean: 0.0, mean p set: 0.4465861916542053
loss_pred:0.02666000835597515, decouple_loss:0.010282333940267563
loss_pred:0.028172267600893974, decouple_loss:0.010101276449859142
loss_pred:0.027707139030098915, decouple_loss:0.01020744163542986
Iteration: 2223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44252803921699524, gen p mean: 0.0, mean p set: 0.4477542042732239
The modified gen p mean: 0.4428468346595764, gen p mean: 0.0, mean p set: 0.44721704721450806
The modified gen p mean: 0.4374217092990875, gen p mean: 0.0, mean p set: 0.448209285736084
loss_pred:0.028108105063438416, decouple_loss:0.009633641690015793
loss_pred:0.02684713527560234, decouple_loss:0.009651966392993927
loss_pred:0.026828376576304436, decouple_loss:0.009807203896343708
Iteration: 2224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508701264858246, gen p mean: 0.0, mean p set: 0.44876447319984436
The modified gen p mean: 0.4515185058116913, gen p mean: 0.0, mean p set: 0.4469318985939026
The modified gen p mean: 0.4473634660243988, gen p mean: 0.0, mean p set: 0.4476804733276367
loss_pred:0.026341142132878304, decouple_loss:0.009647835977375507
loss_pred:0.027581440284848213, decouple_loss:0.00967426784336567
loss_pred:0.028549164533615112, decouple_loss:0.010013251565396786
Iteration: 2225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531889855861664, gen p mean: 0.0, mean p set: 0.44680383801460266
The modified gen p mean: 0.44970154762268066, gen p mean: 0.0, mean p set: 0.44838783144950867
The modified gen p mean: 0.45296651124954224, gen p mean: 0.0, mean p set: 0.4490286707878113
loss_pred:0.026891661807894707, decouple_loss:0.009524010121822357
loss_pred:0.026811691001057625, decouple_loss:0.009491431526839733
loss_pred:0.027675773948431015, decouple_loss:0.00966530293226242
Iteration: 2226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44219937920570374, gen p mean: 0.0, mean p set: 0.44758957624435425
The modified gen p mean: 0.4419061243534088, gen p mean: 0.0, mean p set: 0.44696754217147827
The modified gen p mean: 0.44276735186576843, gen p mean: 0.0, mean p set: 0.4467789828777313
loss_pred:0.02692316472530365, decouple_loss:0.009653746150434017
loss_pred:0.025963980704545975, decouple_loss:0.010121453553438187
loss_pred:0.027296192944049835, decouple_loss:0.009608488529920578
Iteration: 2227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45047175884246826, gen p mean: 0.0, mean p set: 0.44635844230651855
The modified gen p mean: 0.4476601183414459, gen p mean: 0.0, mean p set: 0.4454576373100281
The modified gen p mean: 0.4516872465610504, gen p mean: 0.0, mean p set: 0.44861549139022827
loss_pred:0.02722124569118023, decouple_loss:0.009941725991666317
loss_pred:0.0273872260004282, decouple_loss:0.009881335310637951
loss_pred:0.02700730599462986, decouple_loss:0.00926123932003975
Iteration: 2228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524235129356384, gen p mean: 0.0, mean p set: 0.4483581483364105
The modified gen p mean: 0.45076727867126465, gen p mean: 0.0, mean p set: 0.44716206192970276
The modified gen p mean: 0.45240435004234314, gen p mean: 0.0, mean p set: 0.44710773229599
loss_pred:0.02605746127665043, decouple_loss:0.00932553131133318
loss_pred:0.027345120906829834, decouple_loss:0.009727220050990582
loss_pred:0.027228012681007385, decouple_loss:0.00915202870965004
Iteration: 2229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645121693611145, gen p mean: 0.0, mean p set: 0.4476129114627838
The modified gen p mean: 0.4456248879432678, gen p mean: 0.0, mean p set: 0.4463306665420532
The modified gen p mean: 0.442585289478302, gen p mean: 0.0, mean p set: 0.44598105549812317
loss_pred:0.027597719803452492, decouple_loss:0.009845794178545475
loss_pred:0.026699379086494446, decouple_loss:0.009619317017495632
loss_pred:0.02688315138220787, decouple_loss:0.009579136036336422
Iteration: 2230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43427860736846924, gen p mean: 0.0, mean p set: 0.44549062848091125
The modified gen p mean: 0.43712642788887024, gen p mean: 0.0, mean p set: 0.44907715916633606
The modified gen p mean: 0.435476154088974, gen p mean: 0.0, mean p set: 0.446456640958786
loss_pred:0.026764025911688805, decouple_loss:0.009349772706627846
loss_pred:0.026438185945153236, decouple_loss:0.009374494664371014
loss_pred:0.026076819747686386, decouple_loss:0.009508366696536541
2023-05-03 05:20:21 testing...
The modified gen p mean: 0.4458874762058258, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45148012042045593, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45434534549713135, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028059719130396843, decouple_loss:0.009880109690129757
loss_pred:0.02709568850696087, decouple_loss:0.00949894916266203
loss_pred:0.026669498533010483, decouple_loss:0.00959889218211174
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027757933363318443, avg_mse: 0.03265305981040001
current test mse: 0.032653
Iteration: 2231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471740424633026, gen p mean: 0.0, mean p set: 0.44692835211753845
The modified gen p mean: 0.44815248250961304, gen p mean: 0.0, mean p set: 0.44802701473236084
loss_pred:0.026533691212534904, decouple_loss:0.009229188784956932
loss_pred:0.025409545749425888, decouple_loss:0.009118681773543358
The modified gen p mean: 0.44686952233314514, gen p mean: 0.0, mean p set: 0.44717955589294434
loss_pred:0.026628004387021065, decouple_loss:0.009422414936125278
Iteration: 2232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4576578736305237, gen p mean: 0.0, mean p set: 0.446748286485672
The modified gen p mean: 0.4577621817588806, gen p mean: 0.0, mean p set: 0.44775307178497314
The modified gen p mean: 0.4533277750015259, gen p mean: 0.0, mean p set: 0.44769522547721863
loss_pred:0.02669169008731842, decouple_loss:0.00938428845256567
loss_pred:0.025505350902676582, decouple_loss:0.009348278865218163
loss_pred:0.026768088340759277, decouple_loss:0.00951496884226799
Iteration: 2233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44898733496665955, gen p mean: 0.0, mean p set: 0.44708412885665894
The modified gen p mean: 0.45316269993782043, gen p mean: 0.0, mean p set: 0.44741740822792053
The modified gen p mean: 0.4554014801979065, gen p mean: 0.0, mean p set: 0.44744551181793213
loss_pred:0.026458976790308952, decouple_loss:0.009371096268296242
loss_pred:0.02783174254000187, decouple_loss:0.009407039731740952
loss_pred:0.026941603049635887, decouple_loss:0.009353632107377052
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4395506680011749, gen p mean: 0.0, mean p set: 0.4495137631893158
The modified gen p mean: 0.44017747044563293, gen p mean: 0.0, mean p set: 0.44808200001716614
loss_pred:0.027411002665758133, decouple_loss:0.009299986995756626
The modified gen p mean: 0.440288245677948, gen p mean: 0.0, mean p set: 0.4470267593860626
loss_pred:0.025505103170871735, decouple_loss:0.008980972692370415
loss_pred:0.02750634029507637, decouple_loss:0.009455124847590923
Iteration: 2235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4446820020675659, gen p mean: 0.0, mean p set: 0.44834378361701965
The modified gen p mean: 0.44381624460220337, gen p mean: 0.0, mean p set: 0.4460590183734894
The modified gen p mean: 0.44468915462493896, gen p mean: 0.0, mean p set: 0.4474574029445648
loss_pred:0.026236163452267647, decouple_loss:0.009362888522446156
loss_pred:0.026854678988456726, decouple_loss:0.009332670830190182
loss_pred:0.027110667899250984, decouple_loss:0.009469598531723022
Iteration: 2236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46003198623657227, gen p mean: 0.0, mean p set: 0.44690370559692383
The modified gen p mean: 0.4550640285015106, gen p mean: 0.0, mean p set: 0.4481981694698334
The modified gen p mean: 0.4567241966724396, gen p mean: 0.0, mean p set: 0.4474954903125763
loss_pred:0.02717600204050541, decouple_loss:0.009249039925634861
loss_pred:0.027786199003458023, decouple_loss:0.01006536278873682
loss_pred:0.02729610726237297, decouple_loss:0.00947839580476284
Iteration: 2237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4409654140472412, gen p mean: 0.0, mean p set: 0.4479331374168396
The modified gen p mean: 0.44114992022514343, gen p mean: 0.0, mean p set: 0.44739776849746704
The modified gen p mean: 0.4444308280944824, gen p mean: 0.0, mean p set: 0.44831427931785583
loss_pred:0.026902737095952034, decouple_loss:0.00931123923510313
loss_pred:0.027092620730400085, decouple_loss:0.009133288636803627
loss_pred:0.02695292979478836, decouple_loss:0.009399497881531715
Iteration: 2238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4388194680213928, gen p mean: 0.0, mean p set: 0.44771286845207214
The modified gen p mean: 0.43826767802238464, gen p mean: 0.0, mean p set: 0.44844114780426025
The modified gen p mean: 0.44387272000312805, gen p mean: 0.0, mean p set: 0.448009192943573
loss_pred:0.026932626962661743, decouple_loss:0.008950289338827133
loss_pred:0.02728724479675293, decouple_loss:0.009215088561177254
loss_pred:0.027621876448392868, decouple_loss:0.008920769207179546
Iteration: 2239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45604029297828674, gen p mean: 0.0, mean p set: 0.448881059885025The modified gen p mean: 0.4578389525413513, gen p mean: 0.0, mean p set: 0.4462839961051941
The modified gen p mean: 0.45864665508270264, gen p mean: 0.0, mean p set: 0.44729292392730713
loss_pred:0.02682979591190815, decouple_loss:0.009185940027236938
loss_pred:0.026600820943713188, decouple_loss:0.00940703321248293
loss_pred:0.027853354811668396, decouple_loss:0.00868541281670332
Iteration: 2240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543411135673523, gen p mean: 0.0, mean p set: 0.44716131687164307
The modified gen p mean: 0.4520834982395172, gen p mean: 0.0, mean p set: 0.4470905363559723
The modified gen p mean: 0.45327112078666687, gen p mean: 0.0, mean p set: 0.44858217239379883
loss_pred:0.027956601232290268, decouple_loss:0.008770858868956566
loss_pred:0.026314768940210342, decouple_loss:0.009016835130751133
loss_pred:0.026296207681298256, decouple_loss:0.008854681625962257
2023-05-03 05:24:03 testing...
The modified gen p mean: 0.4272752106189728, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4326076805591583, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.43567371368408203, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028010975569486618, decouple_loss:0.00975154247134924
loss_pred:0.026987992227077484, decouple_loss:0.009223178029060364
loss_pred:0.026679597795009613, decouple_loss:0.009294862858951092
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027697350829839706, avg_mse: 0.03248864784836769
current test mse: 0.032489
Iteration: 2241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4298269748687744, gen p mean: 0.0, mean p set: 0.4477007985115051
The modified gen p mean: 0.42992720007896423, gen p mean: 0.0, mean p set: 0.4467063546180725
loss_pred:0.027501385658979416, decouple_loss:0.009077232331037521
loss_pred:0.02711293287575245, decouple_loss:0.008973457850515842
The modified gen p mean: 0.4284090995788574, gen p mean: 0.0, mean p set: 0.44793781638145447
loss_pred:0.028204480186104774, decouple_loss:0.009628992527723312
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
NaN value num: 0
Iteration: 2242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867807626724243, gen p mean: 0.0, mean p set: 0.4488913118839264
The modified gen p mean: 0.4530114531517029, gen p mean: 0.0, mean p set: 0.4473893940448761
The modified gen p mean: 0.45069214701652527, gen p mean: 0.0, mean p set: 0.44891470670700073
loss_pred:0.02820759452879429, decouple_loss:0.009958036243915558
loss_pred:0.02670583687722683, decouple_loss:0.009665673598647118
loss_pred:0.027607161551713943, decouple_loss:0.009574005380272865
Iteration: 2243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45992881059646606, gen p mean: 0.0, mean p set: 0.4486440122127533
The modified gen p mean: 0.4572255611419678, gen p mean: 0.0, mean p set: 0.4480820298194885
The modified gen p mean: 0.4619671106338501, gen p mean: 0.0, mean p set: 0.44836878776550293
loss_pred:0.02836570516228676, decouple_loss:0.009651217609643936
loss_pred:0.028144007548689842, decouple_loss:0.009855198673903942
loss_pred:0.027437997981905937, decouple_loss:0.009329511784017086
Iteration: 2244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4446297287940979, gen p mean: 0.0, mean p set: 0.44628140330314636
The modified gen p mean: 0.4422254264354706, gen p mean: 0.0, mean p set: 0.4480300843715668
The modified gen p mean: 0.44636788964271545, gen p mean: 0.0, mean p set: 0.4484068751335144
loss_pred:0.027866370975971222, decouple_loss:0.009832837618887424
loss_pred:0.026511166244745255, decouple_loss:0.00980344507843256
loss_pred:0.027419336140155792, decouple_loss:0.009605653584003448
Iteration: 2245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4394446313381195, gen p mean: 0.0, mean p set: 0.44800424575805664
The modified gen p mean: 0.4444388449192047, gen p mean: 0.0, mean p set: 0.4483754336833954
The modified gen p mean: 0.4429514706134796, gen p mean: 0.0, mean p set: 0.4465877413749695
loss_pred:0.026425454765558243, decouple_loss:0.009611883200705051
loss_pred:0.028178637847304344, decouple_loss:0.009815748780965805
loss_pred:0.02765618823468685, decouple_loss:0.010001723654568195
Iteration: 2246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527301788330078, gen p mean: 0.0, mean p set: 0.4488873779773712
The modified gen p mean: 0.45356348156929016, gen p mean: 0.0, mean p set: 0.44776758551597595
loss_pred:0.028001250699162483, decouple_loss:0.009769759140908718
The modified gen p mean: 0.45211347937583923, gen p mean: 0.0, mean p set: 0.45008379220962524
loss_pred:0.02802184596657753, decouple_loss:0.009679663926362991
loss_pred:0.026666298508644104, decouple_loss:0.00985802337527275
Iteration: 2247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455356299877167, gen p mean: 0.0, mean p set: 0.4475806653499603
The modified gen p mean: 0.4449780285358429, gen p mean: 0.0, mean p set: 0.44894686341285706
The modified gen p mean: 0.4419979453086853, gen p mean: 0.0, mean p set: 0.44994887709617615
loss_pred:0.027520865201950073, decouple_loss:0.009676673449575901
loss_pred:0.027036083862185478, decouple_loss:0.00963914766907692
loss_pred:0.02716490998864174, decouple_loss:0.009662908501923084
Iteration: 2248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4420580565929413, gen p mean: 0.0, mean p set: 0.44735774397850037
The modified gen p mean: 0.44093212485313416, gen p mean: 0.0, mean p set: 0.4469138979911804
The modified gen p mean: 0.4399043321609497, gen p mean: 0.0, mean p set: 0.44748660922050476
loss_pred:0.027363568544387817, decouple_loss:0.009722511284053326
loss_pred:0.030137334018945694, decouple_loss:0.00980773102492094
loss_pred:0.027014603838324547, decouple_loss:0.009685411117970943
Iteration: 2249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838374853134155, gen p mean: 0.0, mean p set: 0.4486467242240906
The modified gen p mean: 0.44731906056404114, gen p mean: 0.0, mean p set: 0.4483628571033478
The modified gen p mean: 0.44806918501853943, gen p mean: 0.0, mean p set: 0.44876575469970703
loss_pred:0.027907470241189003, decouple_loss:0.009890356101095676
loss_pred:0.029453188180923462, decouple_loss:0.009656393900513649
loss_pred:0.0275521669536829, decouple_loss:0.009923402220010757
Iteration: 2250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4546058475971222, gen p mean: 0.0, mean p set: 0.44758832454681396
The modified gen p mean: 0.45383888483047485, gen p mean: 0.0, mean p set: 0.44795146584510803
The modified gen p mean: 0.45220983028411865, gen p mean: 0.0, mean p set: 0.4479452073574066
loss_pred:0.029617803171277046, decouple_loss:0.009544466622173786
loss_pred:0.02781091071665287, decouple_loss:0.009564442560076714
loss_pred:0.026363415643572807, decouple_loss:0.009843122214078903
2023-05-03 05:28:25 testing...
The modified gen p mean: 0.4473789632320404, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45227763056755066, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45477837324142456, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02825462818145752, decouple_loss:0.01042198110371828
loss_pred:0.027276208624243736, decouple_loss:0.01019345410168171
loss_pred:0.026898682117462158, decouple_loss:0.01035386137664318
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02799266204237938, avg_mse: 0.033029019832611084
current test mse: 0.033029
Iteration: 2251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503147304058075, gen p mean: 0.0, mean p set: 0.4477272629737854
loss_pred:0.027558110654354095, decouple_loss:0.009844661690294743
The modified gen p mean: 0.4472903609275818, gen p mean: 0.0, mean p set: 0.448015421628952
loss_pred:0.02635064907371998, decouple_loss:0.009765529073774815
The modified gen p mean: 0.4451453983783722, gen p mean: 0.0, mean p set: 0.4480130672454834
loss_pred:0.027425656095147133, decouple_loss:0.009605880826711655
Iteration: 2252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859084486961365, gen p mean: 0.0, mean p set: 0.4492984712123871
The modified gen p mean: 0.447099506855011, gen p mean: 0.0, mean p set: 0.44811269640922546
The modified gen p mean: 0.45010122656822205, gen p mean: 0.0, mean p set: 0.44844383001327515
loss_pred:0.026200076565146446, decouple_loss:0.009760387241840363
loss_pred:0.02785627730190754, decouple_loss:0.009869289584457874
loss_pred:0.02666124328970909, decouple_loss:0.009647930972278118
Iteration: 2253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451363682746887, gen p mean: 0.0, mean p set: 0.44823703169822693
The modified gen p mean: 0.450202614068985, gen p mean: 0.0, mean p set: 0.4482339918613434
The modified gen p mean: 0.45092901587486267, gen p mean: 0.0, mean p set: 0.4460088610649109
loss_pred:0.02947583980858326, decouple_loss:0.009535337798297405
loss_pred:0.026686852797865868, decouple_loss:0.009755250997841358
loss_pred:0.027757126837968826, decouple_loss:0.010307824239134789
Iteration: 2254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4403698146343231, gen p mean: 0.0, mean p set: 0.44747960567474365
The modified gen p mean: 0.44330599904060364, gen p mean: 0.0, mean p set: 0.44804099202156067
The modified gen p mean: 0.4423849284648895, gen p mean: 0.0, mean p set: 0.4494989514350891
loss_pred:0.026668962091207504, decouple_loss:0.009436874650418758
loss_pred:0.027893375605344772, decouple_loss:0.010089907795190811
loss_pred:0.02762296237051487, decouple_loss:0.010277553461492062
Iteration: 2255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4448986053466797, gen p mean: 0.0, mean p set: 0.44744521379470825
The modified gen p mean: 0.44276735186576843, gen p mean: 0.0, mean p set: 0.4487498700618744
The modified gen p mean: 0.44612160325050354, gen p mean: 0.0, mean p set: 0.4469919800758362
loss_pred:0.027449246495962143, decouple_loss:0.009709847159683704
loss_pred:0.026641802862286568, decouple_loss:0.009664494544267654
loss_pred:0.02963348850607872, decouple_loss:0.009555933997035027
Iteration: 2256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4557718336582184, gen p mean: 0.0, mean p set: 0.4473235011100769
The modified gen p mean: 0.45571038126945496, gen p mean: 0.0, mean p set: 0.4480408728122711
The modified gen p mean: 0.45579344034194946, gen p mean: 0.0, mean p set: 0.44846805930137634
loss_pred:0.0294827651232481, decouple_loss:0.00975847989320755
loss_pred:0.028547171503305435, decouple_loss:0.009617475792765617
loss_pred:0.027986086905002594, decouple_loss:0.009935321286320686
Iteration: 2257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45554858446121216, gen p mean: 0.0, mean p set: 0.4495314955711365
The modified gen p mean: 0.4526153802871704, gen p mean: 0.0, mean p set: 0.4474983811378479
The modified gen p mean: 0.4567546844482422, gen p mean: 0.0, mean p set: 0.4481058716773987
loss_pred:0.027547281235456467, decouple_loss:0.010084505192935467
loss_pred:0.027861686423420906, decouple_loss:0.009886028245091438
loss_pred:0.027057208120822906, decouple_loss:0.009768297895789146
Iteration: 2258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4408056437969208, gen p mean: 0.0, mean p set: 0.44883236289024353
The modified gen p mean: 0.43819770216941833, gen p mean: 0.0, mean p set: 0.44839391112327576
The modified gen p mean: 0.4372634291648865, gen p mean: 0.0, mean p set: 0.4480586349964142
loss_pred:0.027724111452698708, decouple_loss:0.009790202602744102
loss_pred:0.026232320815324783, decouple_loss:0.010282977484166622
loss_pred:0.027507267892360687, decouple_loss:0.009712516330182552
Iteration: 2259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4407999515533447, gen p mean: 0.0, mean p set: 0.4489644169807434
The modified gen p mean: 0.4437335431575775, gen p mean: 0.0, mean p set: 0.4473629891872406
The modified gen p mean: 0.4466152489185333, gen p mean: 0.0, mean p set: 0.4485074579715729
loss_pred:0.02650098130106926, decouple_loss:0.009369156323373318
loss_pred:0.02673289179801941, decouple_loss:0.009517177008092403
loss_pred:0.027218185365200043, decouple_loss:0.009743880480527878
Iteration: 2260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45244601368904114, gen p mean: 0.0, mean p set: 0.44834744930267334
The modified gen p mean: 0.4480133056640625, gen p mean: 0.0, mean p set: 0.44797322154045105
The modified gen p mean: 0.4523429572582245, gen p mean: 0.0, mean p set: 0.448879599571228
loss_pred:0.027557795867323875, decouple_loss:0.010114568285644054
loss_pred:0.028047960251569748, decouple_loss:0.009612083435058594
loss_pred:0.026676394045352936, decouple_loss:0.009731844998896122
2023-05-03 05:32:04 testing...
The modified gen p mean: 0.4489468038082123, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45397835969924927, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45659229159355164, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02816978096961975, decouple_loss:0.01025434024631977
loss_pred:0.02713976427912712, decouple_loss:0.010039844550192356
loss_pred:0.026881719008088112, decouple_loss:0.010283855721354485
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02790672332048416, avg_mse: 0.03293757140636444
current test mse: 0.032938
Iteration: 2261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785478711128235, gen p mean: 0.0, mean p set: 0.44817492365837097
The modified gen p mean: 0.4513346552848816, gen p mean: 0.0, mean p set: 0.4480629861354828
loss_pred:0.025753170251846313, decouple_loss:0.009900875389575958
loss_pred:0.027733881026506424, decouple_loss:0.009547282941639423
The modified gen p mean: 0.4463987946510315, gen p mean: 0.0, mean p set: 0.44834810495376587
loss_pred:0.027196642011404037, decouple_loss:0.009608803316950798
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 2262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45374688506126404, gen p mean: 0.0, mean p set: 0.44916436076164246
The modified gen p mean: 0.450458288192749, gen p mean: 0.0, mean p set: 0.4478180706501007
The modified gen p mean: 0.45242244005203247, gen p mean: 0.0, mean p set: 0.44965940713882446
loss_pred:0.027833599597215652, decouple_loss:0.010700715705752373
loss_pred:0.026915905997157097, decouple_loss:0.011014031246304512
loss_pred:0.02701311744749546, decouple_loss:0.009950155392289162
Iteration: 2263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532466530799866, gen p mean: 0.0, mean p set: 0.4481671154499054
The modified gen p mean: 0.4509105086326599, gen p mean: 0.0, mean p set: 0.4480898678302765
The modified gen p mean: 0.4491262137889862, gen p mean: 0.0, mean p set: 0.4486420452594757
loss_pred:0.027542410418391228, decouple_loss:0.01079206820577383
loss_pred:0.027375180274248123, decouple_loss:0.011039446108043194
loss_pred:0.02785520628094673, decouple_loss:0.010260422714054585
Iteration: 2264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831523299217224, gen p mean: 0.0, mean p set: 0.44913092255592346
The modified gen p mean: 0.4460484981536865, gen p mean: 0.0, mean p set: 0.449429988861084
The modified gen p mean: 0.4429784119129181, gen p mean: 0.0, mean p set: 0.44932955503463745
loss_pred:0.026811592280864716, decouple_loss:0.010448773391544819
loss_pred:0.027509726583957672, decouple_loss:0.010328059084713459
loss_pred:0.028186554089188576, decouple_loss:0.010361970402300358
Iteration: 2265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4418712854385376, gen p mean: 0.0, mean p set: 0.450207382440567
The modified gen p mean: 0.44616952538490295, gen p mean: 0.0, mean p set: 0.44992080330848694
loss_pred:0.02708033099770546, decouple_loss:0.010439773090183735
The modified gen p mean: 0.4415338635444641, gen p mean: 0.0, mean p set: 0.44900044798851013
loss_pred:0.028362736105918884, decouple_loss:0.010080140084028244
loss_pred:0.026902301236987114, decouple_loss:0.010560780763626099
Iteration: 2266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471502900123596, gen p mean: 0.0, mean p set: 0.4492858350276947
The modified gen p mean: 0.44614750146865845, gen p mean: 0.0, mean p set: 0.44834965467453003
The modified gen p mean: 0.4482426941394806, gen p mean: 0.0, mean p set: 0.45019209384918213
loss_pred:0.027017515152692795, decouple_loss:0.009745528921484947
loss_pred:0.027426671236753464, decouple_loss:0.010217733681201935
loss_pred:0.027701763436198235, decouple_loss:0.010128939524292946
Iteration: 2267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45193853974342346, gen p mean: 0.0, mean p set: 0.4488871097564697
The modified gen p mean: 0.45650336146354675, gen p mean: 0.0, mean p set: 0.4480970501899719
The modified gen p mean: 0.4544887840747833, gen p mean: 0.0, mean p set: 0.4484882652759552
loss_pred:0.02731597237288952, decouple_loss:0.010238044895231724
loss_pred:0.026684366166591644, decouple_loss:0.01019407156854868
loss_pred:0.027004243806004524, decouple_loss:0.010198276489973068
Iteration: 2268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113295316696167, gen p mean: 0.0, mean p set: 0.44866296648979187
The modified gen p mean: 0.45769837498664856, gen p mean: 0.0, mean p set: 0.4481886029243469
The modified gen p mean: 0.45859789848327637, gen p mean: 0.0, mean p set: 0.44971105456352234
loss_pred:0.027824901044368744, decouple_loss:0.010831532999873161
loss_pred:0.02659660577774048, decouple_loss:0.010092565789818764
loss_pred:0.027288848534226418, decouple_loss:0.010402399115264416
Iteration: 2269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462401568889618, gen p mean: 0.0, mean p set: 0.4490225911140442
The modified gen p mean: 0.43941807746887207, gen p mean: 0.0, mean p set: 0.449150025844574
The modified gen p mean: 0.44230741262435913, gen p mean: 0.0, mean p set: 0.44883859157562256
loss_pred:0.02697739750146866, decouple_loss:0.010406539775431156loss_pred:0.026983726769685745, decouple_loss:0.010027085430920124
loss_pred:0.026980649679899216, decouple_loss:0.010342122055590153
Iteration: 2270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44147172570228577, gen p mean: 0.0, mean p set: 0.4479256868362427
The modified gen p mean: 0.44439536333084106, gen p mean: 0.0, mean p set: 0.4489034116268158
The modified gen p mean: 0.4412597715854645, gen p mean: 0.0, mean p set: 0.4486553370952606
loss_pred:0.02669687755405903, decouple_loss:0.01045309193432331loss_pred:0.027349460870027542, decouple_loss:0.011130372993648052
loss_pred:0.027375977486371994, decouple_loss:0.010412442497909069
2023-05-03 05:36:24 testing...
The modified gen p mean: 0.45087993144989014, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45344778895378113, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4459155201911926, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.026915598660707474, decouple_loss:0.009885982610285282
loss_pred:0.02664146199822426, decouple_loss:0.010026710107922554
loss_pred:0.027932316064834595, decouple_loss:0.01005280390381813
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027662551030516624, avg_mse: 0.03251584246754646
current test mse: 0.032516
Iteration: 2271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4449269473552704, gen p mean: 0.0, mean p set: 0.4476362466812134
loss_pred:0.027752982452511787, decouple_loss:0.010410989634692669
The modified gen p mean: 0.44662848114967346, gen p mean: 0.0, mean p set: 0.4496510326862335
loss_pred:0.02719665877521038, decouple_loss:0.010165989398956299
The modified gen p mean: 0.45524004101753235, gen p mean: 0.0, mean p set: 0.4492567181587219
loss_pred:0.026812119409441948, decouple_loss:0.010049024596810341
Iteration: 2272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4580460488796234, gen p mean: 0.0, mean p set: 0.44993188977241516
The modified gen p mean: 0.45965853333473206, gen p mean: 0.0, mean p set: 0.44841691851615906
The modified gen p mean: 0.45614445209503174, gen p mean: 0.0, mean p set: 0.4488309919834137
loss_pred:0.026824994012713432, decouple_loss:0.009987754747271538
loss_pred:0.02601437084376812, decouple_loss:0.009860748425126076
loss_pred:0.02777964249253273, decouple_loss:0.010043364018201828
Iteration: 2273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628942012786865, gen p mean: 0.0, mean p set: 0.4485659599304199
The modified gen p mean: 0.4470636546611786, gen p mean: 0.0, mean p set: 0.4492400586605072
The modified gen p mean: 0.4456333816051483, gen p mean: 0.0, mean p set: 0.4490686058998108
loss_pred:0.026950359344482422, decouple_loss:0.009893281385302544
loss_pred:0.027401592582464218, decouple_loss:0.009802871383726597
loss_pred:0.027806945145130157, decouple_loss:0.009878410957753658
Iteration: 2274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4406859278678894, gen p mean: 0.0, mean p set: 0.44856372475624084
The modified gen p mean: 0.43963366746902466, gen p mean: 0.0, mean p set: 0.4484257698059082
The modified gen p mean: 0.4407346844673157, gen p mean: 0.0, mean p set: 0.44945937395095825
loss_pred:0.026796063408255577, decouple_loss:0.00965386163443327
loss_pred:0.026630545035004616, decouple_loss:0.009570172987878323
loss_pred:0.026071734726428986, decouple_loss:0.009448896162211895
Iteration: 2275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45491862297058105, gen p mean: 0.0, mean p set: 0.44840162992477417
The modified gen p mean: 0.4531077444553375, gen p mean: 0.0, mean p set: 0.4483124613761902
The modified gen p mean: 0.4506465196609497, gen p mean: 0.0, mean p set: 0.44905519485473633
loss_pred:0.026787931099534035, decouple_loss:0.009849275462329388
loss_pred:0.025876421481370926, decouple_loss:0.009390980936586857
loss_pred:0.02719363383948803, decouple_loss:0.01019267551600933
Iteration: 2276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45873719453811646, gen p mean: 0.0, mean p set: 0.44919553399086
The modified gen p mean: 0.4575119912624359, gen p mean: 0.0, mean p set: 0.44930222630500793
The modified gen p mean: 0.4541652798652649, gen p mean: 0.0, mean p set: 0.44830384850502014
loss_pred:0.02758573554456234, decouple_loss:0.010319310240447521
loss_pred:0.027107378467917442, decouple_loss:0.010385267436504364
loss_pred:0.02601037174463272, decouple_loss:0.009292125701904297
Iteration: 2277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4407348334789276, gen p mean: 0.0, mean p set: 0.44943690299987793
The modified gen p mean: 0.43675410747528076, gen p mean: 0.0, mean p set: 0.44925642013549805
The modified gen p mean: 0.4396321773529053, gen p mean: 0.0, mean p set: 0.44832542538642883
loss_pred:0.02604653127491474, decouple_loss:0.009352277964353561
loss_pred:0.027191534638404846, decouple_loss:0.009345963597297668
loss_pred:0.026913899928331375, decouple_loss:0.009901457466185093
Iteration: 2278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4394853413105011, gen p mean: 0.0, mean p set: 0.4499247372150421
The modified gen p mean: 0.43799152970314026, gen p mean: 0.0, mean p set: 0.4488929510116577
The modified gen p mean: 0.44110432267189026, gen p mean: 0.0, mean p set: 0.4488828480243683
loss_pred:0.02629423886537552, decouple_loss:0.009605711326003075
loss_pred:0.02691532112658024, decouple_loss:0.009380541741847992
loss_pred:0.02712782844901085, decouple_loss:0.0099329287186265
Iteration: 2279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4578351676464081, gen p mean: 0.0, mean p set: 0.4504498541355133The modified gen p mean: 0.4589248299598694, gen p mean: 0.0, mean p set: 0.44930025935173035
The modified gen p mean: 0.4600001871585846, gen p mean: 0.0, mean p set: 0.44897738099098206
loss_pred:0.026490015909075737, decouple_loss:0.009238961152732372loss_pred:0.027507081627845764, decouple_loss:0.009531145915389061
loss_pred:0.02647789753973484, decouple_loss:0.009430409409105778
Iteration: 2280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4563906192779541, gen p mean: 0.0, mean p set: 0.4506753385066986
The modified gen p mean: 0.46074584126472473, gen p mean: 0.0, mean p set: 0.4496217370033264
The modified gen p mean: 0.45723897218704224, gen p mean: 0.0, mean p set: 0.4479579031467438
loss_pred:0.02657419443130493, decouple_loss:0.009631138294935226
loss_pred:0.02705082856118679, decouple_loss:0.009419112466275692
loss_pred:0.02687835320830345, decouple_loss:0.009899928234517574
2023-05-03 05:40:05 testing...
The modified gen p mean: 0.4376199245452881, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44572514295578003, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4428645968437195, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02786453440785408, decouple_loss:0.00984193105250597
loss_pred:0.026461627334356308, decouple_loss:0.009567908942699432
loss_pred:0.02674858830869198, decouple_loss:0.009690776467323303
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02750992774963379, avg_mse: 0.03232967481017113
current test mse: 0.03233
Iteration: 2281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43947020173072815, gen p mean: 0.0, mean p set: 0.4490663409233093
loss_pred:0.026866398751735687, decouple_loss:0.009462539106607437
The modified gen p mean: 0.44355952739715576, gen p mean: 0.0, mean p set: 0.4497077465057373
loss_pred:0.02621595561504364, decouple_loss:0.009188245981931686
The modified gen p mean: 0.43991124629974365, gen p mean: 0.0, mean p set: 0.448469340801239
loss_pred:0.026973169296979904, decouple_loss:0.009874709881842136
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
NaN value num: 0
Iteration: 2282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443209171295166, gen p mean: 0.0, mean p set: 0.4480881989002228
The modified gen p mean: 0.44497784972190857, gen p mean: 0.0, mean p set: 0.44772669672966003
The modified gen p mean: 0.44299551844596863, gen p mean: 0.0, mean p set: 0.4480046033859253
loss_pred:0.027176547795534134, decouple_loss:0.01036228146404028
loss_pred:0.026661096140742302, decouple_loss:0.010348918847739697
loss_pred:0.027310743927955627, decouple_loss:0.010362561792135239
Iteration: 2283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4563096761703491, gen p mean: 0.0, mean p set: 0.4478755593299866
The modified gen p mean: 0.45578163862228394, gen p mean: 0.0, mean p set: 0.4476010203361511
loss_pred:0.02710539475083351, decouple_loss:0.009853411465883255
The modified gen p mean: 0.4512783885002136, gen p mean: 0.0, mean p set: 0.4473438560962677
loss_pred:0.02741965278983116, decouple_loss:0.009613503701984882
loss_pred:0.027976255863904953, decouple_loss:0.010513453744351864
Iteration: 2284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492615759372711, gen p mean: 0.0, mean p set: 0.4489684998989105
The modified gen p mean: 0.4506433606147766, gen p mean: 0.0, mean p set: 0.4452835023403168
The modified gen p mean: 0.4465593993663788, gen p mean: 0.0, mean p set: 0.44744715094566345
loss_pred:0.026853784918785095, decouple_loss:0.00982930138707161
loss_pred:0.02818855084478855, decouple_loss:0.0098978690803051
loss_pred:0.0286239106208086, decouple_loss:0.009890194050967693
Iteration: 2285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4367521405220032, gen p mean: 0.0, mean p set: 0.4474547207355499
The modified gen p mean: 0.43824753165245056, gen p mean: 0.0, mean p set: 0.4472973346710205
The modified gen p mean: 0.43970465660095215, gen p mean: 0.0, mean p set: 0.44777825474739075
loss_pred:0.02740035206079483, decouple_loss:0.009937170892953873
loss_pred:0.027288181707262993, decouple_loss:0.009671622887253761
loss_pred:0.028333470225334167, decouple_loss:0.010387664660811424
Iteration: 2286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44570809602737427, gen p mean: 0.0, mean p set: 0.44852742552757263
The modified gen p mean: 0.4417116641998291, gen p mean: 0.0, mean p set: 0.4477783739566803
The modified gen p mean: 0.4497744143009186, gen p mean: 0.0, mean p set: 0.4449867010116577
loss_pred:0.028493626043200493, decouple_loss:0.010125922039151192
loss_pred:0.028612948954105377, decouple_loss:0.01001101266592741
loss_pred:0.02832813188433647, decouple_loss:0.009784945286810398
Iteration: 2287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478147029876709, gen p mean: 0.0, mean p set: 0.44710254669189453
The modified gen p mean: 0.45348820090293884, gen p mean: 0.0, mean p set: 0.4469830095767975
The modified gen p mean: 0.451869934797287, gen p mean: 0.0, mean p set: 0.4454438388347626
loss_pred:0.028498118743300438, decouple_loss:0.0098107336089015
loss_pred:0.027570117264986038, decouple_loss:0.009896554984152317
loss_pred:0.02786106802523136, decouple_loss:0.009751512669026852
Iteration: 2288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453307092189789, gen p mean: 0.0, mean p set: 0.4489658772945404
The modified gen p mean: 0.44363197684288025, gen p mean: 0.0, mean p set: 0.4488775134086609
The modified gen p mean: 0.44442111253738403, gen p mean: 0.0, mean p set: 0.44853606820106506
loss_pred:0.028062358498573303, decouple_loss:0.009884350001811981
loss_pred:0.026902806013822556, decouple_loss:0.009984360076487064
loss_pred:0.027357198297977448, decouple_loss:0.01013876125216484
Iteration: 2289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4550861120223999, gen p mean: 0.0, mean p set: 0.44780823588371277
The modified gen p mean: 0.4508323669433594, gen p mean: 0.0, mean p set: 0.44805940985679626
The modified gen p mean: 0.451958566904068, gen p mean: 0.0, mean p set: 0.4472050368785858
loss_pred:0.02646026574075222, decouple_loss:0.009634092450141907
loss_pred:0.026962552219629288, decouple_loss:0.009687901474535465
loss_pred:0.02816089801490307, decouple_loss:0.00984590221196413
Iteration: 2290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670090079307556, gen p mean: 0.0, mean p set: 0.4471317529678345
The modified gen p mean: 0.4437123239040375, gen p mean: 0.0, mean p set: 0.44859054684638977
The modified gen p mean: 0.44939759373664856, gen p mean: 0.0, mean p set: 0.4449447691440582
loss_pred:0.028138019144535065, decouple_loss:0.009459749795496464
loss_pred:0.026993583887815475, decouple_loss:0.009603877551853657
loss_pred:0.028258727863430977, decouple_loss:0.009589090012013912
2023-05-03 05:44:25 testing...
The modified gen p mean: 0.43814289569854736, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44555923342704773, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4430919587612152, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.028112009167671204, decouple_loss:0.010355026461184025
loss_pred:0.026773804798722267, decouple_loss:0.01001898106187582
loss_pred:0.027105536311864853, decouple_loss:0.010047797113656998
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02783748134970665, avg_mse: 0.032900620251894
current test mse: 0.032901
Iteration: 2291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4421209692955017, gen p mean: 0.0, mean p set: 0.44860225915908813
The modified gen p mean: 0.4420524835586548, gen p mean: 0.0, mean p set: 0.44847550988197327
loss_pred:0.028056783601641655, decouple_loss:0.00949410442262888
loss_pred:0.027260996401309967, decouple_loss:0.009854268282651901
The modified gen p mean: 0.4413473606109619, gen p mean: 0.0, mean p set: 0.44791650772094727
loss_pred:0.027465760707855225, decouple_loss:0.009249100461602211
Iteration: 2292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488285779953003, gen p mean: 0.0, mean p set: 0.4472928047180176
The modified gen p mean: 0.44775649905204773, gen p mean: 0.0, mean p set: 0.4475955367088318
The modified gen p mean: 0.4458513557910919, gen p mean: 0.0, mean p set: 0.447741836309433
loss_pred:0.02801920659840107, decouple_loss:0.009531070478260517
loss_pred:0.0262463316321373, decouple_loss:0.009763357229530811
loss_pred:0.027674125507473946, decouple_loss:0.00966279674321413
Iteration: 2293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539909362792969, gen p mean: 0.0, mean p set: 0.44738152623176575
The modified gen p mean: 0.45214277505874634, gen p mean: 0.0, mean p set: 0.4479779005050659
The modified gen p mean: 0.4517190456390381, gen p mean: 0.0, mean p set: 0.44849109649658203
loss_pred:0.027675291523337364, decouple_loss:0.009347853250801563
loss_pred:0.028618281707167625, decouple_loss:0.009129427373409271
loss_pred:0.027148663997650146, decouple_loss:0.009545660577714443
Iteration: 2294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726741313934326, gen p mean: 0.0, mean p set: 0.4476911425590515
The modified gen p mean: 0.4425473213195801, gen p mean: 0.0, mean p set: 0.4476792514324188
The modified gen p mean: 0.4471437633037567, gen p mean: 0.0, mean p set: 0.44885969161987305
loss_pred:0.026882311329245567, decouple_loss:0.009219657629728317
loss_pred:0.028067301958799362, decouple_loss:0.009425402618944645
loss_pred:0.027250293642282486, decouple_loss:0.009477192535996437
Iteration: 2295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448651522397995, gen p mean: 0.0, mean p set: 0.44790738821029663
The modified gen p mean: 0.4478926658630371, gen p mean: 0.0, mean p set: 0.4481930732727051
The modified gen p mean: 0.4441988468170166, gen p mean: 0.0, mean p set: 0.4479292929172516
loss_pred:0.026536859571933746, decouple_loss:0.00913385208696127
loss_pred:0.02784499153494835, decouple_loss:0.009323948994278908
loss_pred:0.027170762419700623, decouple_loss:0.009713561274111271
Iteration: 2296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513186514377594, gen p mean: 0.0, mean p set: 0.4481572210788727
The modified gen p mean: 0.45169052481651306, gen p mean: 0.0, mean p set: 0.44791924953460693
The modified gen p mean: 0.45091167092323303, gen p mean: 0.0, mean p set: 0.4483644366264343
loss_pred:0.027615919709205627, decouple_loss:0.009274905547499657
loss_pred:0.02706395462155342, decouple_loss:0.009365587495267391
loss_pred:0.02693638578057289, decouple_loss:0.009213341400027275
Iteration: 2297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44447970390319824, gen p mean: 0.0, mean p set: 0.4473651349544525
The modified gen p mean: 0.4453555643558502, gen p mean: 0.0, mean p set: 0.4476243257522583
The modified gen p mean: 0.4466049373149872, gen p mean: 0.0, mean p set: 0.448689341545105
loss_pred:0.02698567323386669, decouple_loss:0.009377890266478062
loss_pred:0.027738556265830994, decouple_loss:0.00939215812832117
loss_pred:0.026576437056064606, decouple_loss:0.009485237300395966
Iteration: 2298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4447353780269623, gen p mean: 0.0, mean p set: 0.44883349537849426
The modified gen p mean: 0.4448324739933014, gen p mean: 0.0, mean p set: 0.4487268626689911
The modified gen p mean: 0.44510790705680847, gen p mean: 0.0, mean p set: 0.4473983943462372
loss_pred:0.026654686778783798, decouple_loss:0.009240669198334217
loss_pred:0.02711642161011696, decouple_loss:0.009351965971291065
loss_pred:0.02660355716943741, decouple_loss:0.008988271467387676
Iteration: 2299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537197947502136, gen p mean: 0.0, mean p set: 0.44602203369140625
The modified gen p mean: 0.45194610953330994, gen p mean: 0.0, mean p set: 0.4472196698188782
The modified gen p mean: 0.4549098014831543, gen p mean: 0.0, mean p set: 0.4481865465641022
loss_pred:0.027693333104252815, decouple_loss:0.009420448914170265
loss_pred:0.026966383680701256, decouple_loss:0.009559737518429756
loss_pred:0.026229096576571465, decouple_loss:0.009154189378023148
Iteration: 2300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453542232513428, gen p mean: 0.0, mean p set: 0.44650891423225403
The modified gen p mean: 0.44355326890945435, gen p mean: 0.0, mean p set: 0.44734519720077515
The modified gen p mean: 0.4438265562057495, gen p mean: 0.0, mean p set: 0.44847017526626587
loss_pred:0.027022670954465866, decouple_loss:0.009459179826080799
loss_pred:0.027445118874311447, decouple_loss:0.00918855331838131
loss_pred:0.027078045532107353, decouple_loss:0.008867204189300537
2023-05-03 05:48:09 testing...
The modified gen p mean: 0.4459207355976105, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44366785883903503, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.43864238262176514, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.02654576301574707, decouple_loss:0.009355215355753899
loss_pred:0.026849711313843727, decouple_loss:0.009462087415158749
loss_pred:0.027795910835266113, decouple_loss:0.009619995951652527
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027537751942873, avg_mse: 0.03249511122703552
current test mse: 0.032495
Iteration: 2301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4405493438243866, gen p mean: 0.0, mean p set: 0.4466627538204193
The modified gen p mean: 0.44524672627449036, gen p mean: 0.0, mean p set: 0.44765937328338623
loss_pred:0.028378084301948547, decouple_loss:0.009367273189127445
loss_pred:0.026384469121694565, decouple_loss:0.009068424813449383
The modified gen p mean: 0.44441795349121094, gen p mean: 0.0, mean p set: 0.44870737195014954
loss_pred:0.026615899056196213, decouple_loss:0.009010561741888523
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
NaN value num: 0
Iteration: 2302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532553553581238, gen p mean: 0.0, mean p set: 0.45351067185401917
The modified gen p mean: 0.45239901542663574, gen p mean: 0.0, mean p set: 0.4530753493309021
The modified gen p mean: 0.4516710042953491, gen p mean: 0.0, mean p set: 0.4528070092201233
loss_pred:0.026799533516168594, decouple_loss:0.009521995671093464
loss_pred:0.02652125433087349, decouple_loss:0.00968891941010952
loss_pred:0.027080951258540154, decouple_loss:0.00990399532020092
Iteration: 2303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528091549873352, gen p mean: 0.0, mean p set: 0.45251479744911194
The modified gen p mean: 0.4532829821109772, gen p mean: 0.0, mean p set: 0.45359036326408386
The modified gen p mean: 0.45517829060554504, gen p mean: 0.0, mean p set: 0.4526323080062866
loss_pred:0.02701137214899063, decouple_loss:0.00957738608121872
loss_pred:0.027442939579486847, decouple_loss:0.009867783635854721
loss_pred:0.026887360960245132, decouple_loss:0.009886798448860645
Iteration: 2304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45209866762161255, gen p mean: 0.0, mean p set: 0.45157214999198914
The modified gen p mean: 0.4512448310852051, gen p mean: 0.0, mean p set: 0.4539449214935303
The modified gen p mean: 0.4523342549800873, gen p mean: 0.0, mean p set: 0.4533127248287201
loss_pred:0.02701379917562008, decouple_loss:0.009714217856526375
loss_pred:0.02638578787446022, decouple_loss:0.00992603600025177
loss_pred:0.026519864797592163, decouple_loss:0.010161889716982841
Iteration: 2305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45430412888526917, gen p mean: 0.0, mean p set: 0.45211559534072876
The modified gen p mean: 0.4506131410598755, gen p mean: 0.0, mean p set: 0.4543859660625458
The modified gen p mean: 0.4518817365169525, gen p mean: 0.0, mean p set: 0.4513516426086426
loss_pred:0.02689889445900917, decouple_loss:0.009697100147604942
loss_pred:0.025963298976421356, decouple_loss:0.009600157849490643
loss_pred:0.02636326104402542, decouple_loss:0.009728160686790943
Iteration: 2306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45404794812202454, gen p mean: 0.0, mean p set: 0.4531856179237366
The modified gen p mean: 0.4576326608657837, gen p mean: 0.0, mean p set: 0.4529772400856018
The modified gen p mean: 0.45563897490501404, gen p mean: 0.0, mean p set: 0.45203009247779846
loss_pred:0.025862952694296837, decouple_loss:0.009975466877222061
loss_pred:0.02669326402246952, decouple_loss:0.009492306970059872
loss_pred:0.025982722640037537, decouple_loss:0.009399652481079102
Iteration: 2307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4547070562839508, gen p mean: 0.0, mean p set: 0.45328548550605774
The modified gen p mean: 0.4509332478046417, gen p mean: 0.0, mean p set: 0.4529498815536499
The modified gen p mean: 0.4580253064632416, gen p mean: 0.0, mean p set: 0.45133963227272034
loss_pred:0.026171889156103134, decouple_loss:0.010047326795756817
loss_pred:0.025784188881516457, decouple_loss:0.010262838564813137
loss_pred:0.0266781747341156, decouple_loss:0.009819737635552883
Iteration: 2308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473446309566498, gen p mean: 0.0, mean p set: 0.4521603584289551
The modified gen p mean: 0.4481668770313263, gen p mean: 0.0, mean p set: 0.45190730690956116
The modified gen p mean: 0.4494871497154236, gen p mean: 0.0, mean p set: 0.4518042206764221
loss_pred:0.026469295844435692, decouple_loss:0.009605955332517624
loss_pred:0.02658257447183132, decouple_loss:0.009777164086699486
loss_pred:0.025891222059726715, decouple_loss:0.009735163301229477
Iteration: 2309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500940442085266, gen p mean: 0.0, mean p set: 0.45294633507728577
The modified gen p mean: 0.44424715638160706, gen p mean: 0.0, mean p set: 0.45005518198013306
The modified gen p mean: 0.44513070583343506, gen p mean: 0.0, mean p set: 0.451394259929657
loss_pred:0.02634289115667343, decouple_loss:0.009853502735495567
loss_pred:0.02696262300014496, decouple_loss:0.010359018109738827
loss_pred:0.02644314058125019, decouple_loss:0.010124700143933296
Iteration: 2310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983527064323425, gen p mean: 0.0, mean p set: 0.45306456089019775
The modified gen p mean: 0.45071613788604736, gen p mean: 0.0, mean p set: 0.4511864483356476
The modified gen p mean: 0.4517262876033783, gen p mean: 0.0, mean p set: 0.45614469051361084
loss_pred:0.026790719479322433, decouple_loss:0.009687517769634724
loss_pred:0.027268122881650925, decouple_loss:0.009647523052990437
loss_pred:0.026005124673247337, decouple_loss:0.010000749491155148
2023-05-03 05:52:32 testing...
The modified gen p mean: 0.46050161123275757, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.46579450368881226, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4685140550136566, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02819421887397766, decouple_loss:0.010568722151219845
loss_pred:0.02728382870554924, decouple_loss:0.01056766789406538
loss_pred:0.02696569822728634, decouple_loss:0.010458795353770256
WV_0_PC_0_EH_0_PS_40_6, loss: 0.028007835149765015, avg_mse: 0.03295931592583656
current test mse: 0.032959
Iteration: 2311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4683547616004944, gen p mean: 0.0, mean p set: 0.45267021656036377
loss_pred:0.027003290131688118, decouple_loss:0.01003311201930046
The modified gen p mean: 0.4660416543483734, gen p mean: 0.0, mean p set: 0.45085322856903076
loss_pred:0.02768717333674431, decouple_loss:0.009621238335967064
The modified gen p mean: 0.4658921957015991, gen p mean: 0.0, mean p set: 0.4552163779735565
loss_pred:0.027022549882531166, decouple_loss:0.009935053996741772
Iteration: 2312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463130533695221, gen p mean: 0.0, mean p set: 0.45077502727508545
The modified gen p mean: 0.44761404395103455, gen p mean: 0.0, mean p set: 0.45073044300079346
The modified gen p mean: 0.44752705097198486, gen p mean: 0.0, mean p set: 0.4523029327392578
loss_pred:0.027341634035110474, decouple_loss:0.00924922525882721
loss_pred:0.026922646909952164, decouple_loss:0.009350152686238289
loss_pred:0.026146918535232544, decouple_loss:0.009749043732881546
Iteration: 2313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44526228308677673, gen p mean: 0.0, mean p set: 0.4498353600502014
The modified gen p mean: 0.439683735370636, gen p mean: 0.0, mean p set: 0.45148760080337524
The modified gen p mean: 0.4436188340187073, gen p mean: 0.0, mean p set: 0.45016953349113464
loss_pred:0.027309948578476906, decouple_loss:0.009574179537594318
loss_pred:0.0267722737044096, decouple_loss:0.009268131107091904
loss_pred:0.026435982435941696, decouple_loss:0.009552111849188805
Iteration: 2314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45116695761680603, gen p mean: 0.0, mean p set: 0.4518008232116699
The modified gen p mean: 0.4499395191669464, gen p mean: 0.0, mean p set: 0.45334672927856445
The modified gen p mean: 0.44725629687309265, gen p mean: 0.0, mean p set: 0.453070729970932
loss_pred:0.025902854278683662, decouple_loss:0.009510530158877373
loss_pred:0.027020500972867012, decouple_loss:0.009661411866545677
loss_pred:0.025922613218426704, decouple_loss:0.010412923991680145
Iteration: 2315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4615529179573059, gen p mean: 0.0, mean p set: 0.4534425735473633
The modified gen p mean: 0.46008291840553284, gen p mean: 0.0, mean p set: 0.4514629542827606
The modified gen p mean: 0.45846423506736755, gen p mean: 0.0, mean p set: 0.45269668102264404
loss_pred:0.026731621474027634, decouple_loss:0.009629245847463608
loss_pred:0.026485517621040344, decouple_loss:0.009597554802894592
loss_pred:0.02640642784535885, decouple_loss:0.009430923499166965
Iteration: 2316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522149860858917, gen p mean: 0.0, mean p set: 0.45215752720832825
The modified gen p mean: 0.4515243470668793, gen p mean: 0.0, mean p set: 0.452870637178421
The modified gen p mean: 0.45017293095588684, gen p mean: 0.0, mean p set: 0.45353925228118896
loss_pred:0.02703661099076271, decouple_loss:0.009332254528999329
loss_pred:0.02730356901884079, decouple_loss:0.009852265939116478
loss_pred:0.02625012956559658, decouple_loss:0.009740058332681656
Iteration: 2317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866374135017395, gen p mean: 0.0, mean p set: 0.4532485604286194
The modified gen p mean: 0.4505824148654938, gen p mean: 0.0, mean p set: 0.45125651359558105
The modified gen p mean: 0.4516817033290863, gen p mean: 0.0, mean p set: 0.45180368423461914
loss_pred:0.027155689895153046, decouple_loss:0.010008770041167736
loss_pred:0.02571735717356205, decouple_loss:0.009653081186115742
loss_pred:0.02578909322619438, decouple_loss:0.00988852884620428
Iteration: 2318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515690505504608, gen p mean: 0.0, mean p set: 0.4528656601905823
The modified gen p mean: 0.45312026143074036, gen p mean: 0.0, mean p set: 0.452517032623291
loss_pred:0.026716897264122963, decouple_loss:0.009683835320174694
The modified gen p mean: 0.4486488103866577, gen p mean: 0.0, mean p set: 0.45189061760902405
loss_pred:0.02607669308781624, decouple_loss:0.009372226893901825
loss_pred:0.026038026437163353, decouple_loss:0.009465617127716541
Iteration: 2319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777950644493103, gen p mean: 0.0, mean p set: 0.45348870754241943
The modified gen p mean: 0.44387200474739075, gen p mean: 0.0, mean p set: 0.4530124366283417
The modified gen p mean: 0.4510901868343353, gen p mean: 0.0, mean p set: 0.452976793050766
loss_pred:0.026174219325184822, decouple_loss:0.009259979240596294
loss_pred:0.026265012100338936, decouple_loss:0.00973900593817234
loss_pred:0.026714717969298363, decouple_loss:0.009371627122163773
Iteration: 2320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454655259847641, gen p mean: 0.0, mean p set: 0.45536860823631287
The modified gen p mean: 0.45749393105506897, gen p mean: 0.0, mean p set: 0.45254912972450256
The modified gen p mean: 0.45634785294532776, gen p mean: 0.0, mean p set: 0.4543078541755676
loss_pred:0.025645993649959564, decouple_loss:0.009327889420092106
loss_pred:0.026109997183084488, decouple_loss:0.008964012376964092
loss_pred:0.026325194165110588, decouple_loss:0.009737813845276833
2023-05-03 05:56:14 testing...
The modified gen p mean: 0.4532153606414795, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45855480432510376, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.461430162191391, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.028129607439041138, decouple_loss:0.010474427603185177
loss_pred:0.027126220986247063, decouple_loss:0.01047291699796915
loss_pred:0.02679934725165367, decouple_loss:0.010522480122745037
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027876224368810654, avg_mse: 0.032961636781692505
current test mse: 0.032962
Iteration: 2321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45712214708328247, gen p mean: 0.0, mean p set: 0.4505777657032013
The modified gen p mean: 0.4531219005584717, gen p mean: 0.0, mean p set: 0.451773464679718
loss_pred:0.026619646698236465, decouple_loss:0.009587465785443783
loss_pred:0.0266520157456398, decouple_loss:0.009696665219962597
The modified gen p mean: 0.4614741802215576, gen p mean: 0.0, mean p set: 0.45227131247520447
loss_pred:0.026047082617878914, decouple_loss:0.00896506104618311
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
NaN value num: 0
Iteration: 2322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503139555454254, gen p mean: 0.0, mean p set: 0.4470764696598053
The modified gen p mean: 0.44721755385398865, gen p mean: 0.0, mean p set: 0.4473523199558258
The modified gen p mean: 0.4464361071586609, gen p mean: 0.0, mean p set: 0.4465733468532562
loss_pred:0.026706267148256302, decouple_loss:0.01005316898226738
loss_pred:0.027886105701327324, decouple_loss:0.009912407957017422
loss_pred:0.027807405218482018, decouple_loss:0.009819758124649525
Iteration: 2323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44190168380737305, gen p mean: 0.0, mean p set: 0.44716089963912964
The modified gen p mean: 0.44163811206817627, gen p mean: 0.0, mean p set: 0.4461705982685089
The modified gen p mean: 0.4434030055999756, gen p mean: 0.0, mean p set: 0.44694146513938904
loss_pred:0.026624346151947975, decouple_loss:0.009621423669159412
loss_pred:0.028451522812247276, decouple_loss:0.00974227860569954
loss_pred:0.027319207787513733, decouple_loss:0.009562307968735695
Iteration: 2324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44015711545944214, gen p mean: 0.0, mean p set: 0.44841480255126953
The modified gen p mean: 0.43851345777511597, gen p mean: 0.0, mean p set: 0.4468180239200592
The modified gen p mean: 0.44420555233955383, gen p mean: 0.0, mean p set: 0.4467245936393738
loss_pred:0.026473604142665863, decouple_loss:0.00961951445788145
loss_pred:0.02819378860294819, decouple_loss:0.009190713055431843
loss_pred:0.02756020985543728, decouple_loss:0.009208866395056248
Iteration: 2325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45482245087623596, gen p mean: 0.0, mean p set: 0.4468151926994324
The modified gen p mean: 0.45542505383491516, gen p mean: 0.0, mean p set: 0.4459622800350189
The modified gen p mean: 0.4555905759334564, gen p mean: 0.0, mean p set: 0.4479721784591675
loss_pred:0.027564356103539467, decouple_loss:0.009171996265649796
loss_pred:0.02753019705414772, decouple_loss:0.00953450333327055
loss_pred:0.026578037068247795, decouple_loss:0.009432214312255383
Iteration: 2326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44300249218940735, gen p mean: 0.0, mean p set: 0.4464716613292694
The modified gen p mean: 0.4399479031562805, gen p mean: 0.0, mean p set: 0.4472929835319519
The modified gen p mean: 0.44058170914649963, gen p mean: 0.0, mean p set: 0.4473839998245239
loss_pred:0.026424158364534378, decouple_loss:0.009286457672715187
loss_pred:0.026275917887687683, decouple_loss:0.0093871233984828
loss_pred:0.026481857523322105, decouple_loss:0.009080041199922562
Iteration: 2327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499441981315613, gen p mean: 0.0, mean p set: 0.44626984000205994
The modified gen p mean: 0.44392338395118713, gen p mean: 0.0, mean p set: 0.4469212293624878
The modified gen p mean: 0.4451097548007965, gen p mean: 0.0, mean p set: 0.44770586490631104
loss_pred:0.027821291238069534, decouple_loss:0.009764832444489002
loss_pred:0.02647581323981285, decouple_loss:0.009720927104353905
loss_pred:0.026888906955718994, decouple_loss:0.00890936516225338
Iteration: 2328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760632514953613, gen p mean: 0.0, mean p set: 0.44648122787475586
The modified gen p mean: 0.4473135471343994, gen p mean: 0.0, mean p set: 0.44733378291130066
The modified gen p mean: 0.45079731941223145, gen p mean: 0.0, mean p set: 0.4485476016998291
loss_pred:0.027413032948970795, decouple_loss:0.009873714298009872
loss_pred:0.028214244171977043, decouple_loss:0.009784387424588203
loss_pred:0.026140905916690826, decouple_loss:0.009353065863251686
Iteration: 2329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071956515312195, gen p mean: 0.0, mean p set: 0.44859790802001953
The modified gen p mean: 0.44980186223983765, gen p mean: 0.0, mean p set: 0.44707679748535156
The modified gen p mean: 0.45024409890174866, gen p mean: 0.0, mean p set: 0.44636544585227966
loss_pred:0.02660815417766571, decouple_loss:0.009780415333807468
loss_pred:0.02753238007426262, decouple_loss:0.009436232969164848
loss_pred:0.027116918936371803, decouple_loss:0.00898052379488945
Iteration: 2330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485314190387726, gen p mean: 0.0, mean p set: 0.4461663067340851
The modified gen p mean: 0.44179925322532654, gen p mean: 0.0, mean p set: 0.44810721278190613
The modified gen p mean: 0.44579073786735535, gen p mean: 0.0, mean p set: 0.44691601395606995
loss_pred:0.027792833745479584, decouple_loss:0.009354478679597378
loss_pred:0.026461688801646233, decouple_loss:0.009479369968175888
loss_pred:0.027999799698591232, decouple_loss:0.009305460378527641
2023-05-03 06:00:33 testing...
The modified gen p mean: 0.43964236974716187, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44489166140556335, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4475553631782532, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027976714074611664, decouple_loss:0.009684354066848755
loss_pred:0.02689116634428501, decouple_loss:0.009438831359148026
loss_pred:0.02658826671540737, decouple_loss:0.00959495734423399
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02763068489730358, avg_mse: 0.032629817724227905
current test mse: 0.03263
Iteration: 2331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44040244817733765, gen p mean: 0.0, mean p set: 0.44744330644607544
loss_pred:0.0264385174959898, decouple_loss:0.009257118217647076
The modified gen p mean: 0.44438236951828003, gen p mean: 0.0, mean p set: 0.4468507766723633
loss_pred:0.02609443850815296, decouple_loss:0.009065374732017517
The modified gen p mean: 0.4468276798725128, gen p mean: 0.0, mean p set: 0.4472403824329376
loss_pred:0.027655677869915962, decouple_loss:0.009202848188579082
Iteration: 2332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971543550491333, gen p mean: 0.0, mean p set: 0.4469703137874603
The modified gen p mean: 0.4446631669998169, gen p mean: 0.0, mean p set: 0.44630083441734314
The modified gen p mean: 0.44678857922554016, gen p mean: 0.0, mean p set: 0.44634416699409485
loss_pred:0.027481842786073685, decouple_loss:0.008834155276417732
loss_pred:0.027329707518219948, decouple_loss:0.009032479487359524
loss_pred:0.027501843869686127, decouple_loss:0.009059970267117023
Iteration: 2333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452166259288788, gen p mean: 0.0, mean p set: 0.4466760754585266
The modified gen p mean: 0.4465477764606476, gen p mean: 0.0, mean p set: 0.4474280774593353
The modified gen p mean: 0.44534173607826233, gen p mean: 0.0, mean p set: 0.4468543529510498
loss_pred:0.027387991547584534, decouple_loss:0.009202143177390099
loss_pred:0.027401931583881378, decouple_loss:0.009072142653167248
loss_pred:0.027912145480513573, decouple_loss:0.00905835721641779
Iteration: 2334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522034525871277, gen p mean: 0.0, mean p set: 0.4462999701499939
The modified gen p mean: 0.4461567997932434, gen p mean: 0.0, mean p set: 0.44792690873146057
The modified gen p mean: 0.44406184554100037, gen p mean: 0.0, mean p set: 0.44728702306747437
loss_pred:0.027632014825940132, decouple_loss:0.008796555921435356
loss_pred:0.027040207758545876, decouple_loss:0.009217225946485996
loss_pred:0.027108849957585335, decouple_loss:0.009374591521918774
Iteration: 2335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476560652256012, gen p mean: 0.0, mean p set: 0.44611287117004395
The modified gen p mean: 0.4456821382045746, gen p mean: 0.0, mean p set: 0.4469709098339081
The modified gen p mean: 0.44679275155067444, gen p mean: 0.0, mean p set: 0.4461488425731659
loss_pred:0.026485279202461243, decouple_loss:0.009202739223837852
loss_pred:0.028206823393702507, decouple_loss:0.009509951807558537
loss_pred:0.027734316885471344, decouple_loss:0.009338362142443657
Iteration: 2336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947320222854614, gen p mean: 0.0, mean p set: 0.44667208194732666
The modified gen p mean: 0.44654732942581177, gen p mean: 0.0, mean p set: 0.44621503353118896
The modified gen p mean: 0.442665696144104, gen p mean: 0.0, mean p set: 0.4480360448360443
loss_pred:0.02700839564204216, decouple_loss:0.009124183095991611
loss_pred:0.026667563244700432, decouple_loss:0.009177089668810368
loss_pred:0.025903083384037018, decouple_loss:0.00968650821596384
Iteration: 2337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490823745727539, gen p mean: 0.0, mean p set: 0.4493277370929718
The modified gen p mean: 0.44596853852272034, gen p mean: 0.0, mean p set: 0.4479944705963135
The modified gen p mean: 0.4475872814655304, gen p mean: 0.0, mean p set: 0.4466996490955353
loss_pred:0.02608606591820717, decouple_loss:0.009485716931521893
loss_pred:0.027104901149868965, decouple_loss:0.009754610247910023
loss_pred:0.02786581963300705, decouple_loss:0.00906306691467762
Iteration: 2338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44026145339012146, gen p mean: 0.0, mean p set: 0.44677287340164185
The modified gen p mean: 0.4453250467777252, gen p mean: 0.0, mean p set: 0.4467623829841614
The modified gen p mean: 0.44445693492889404, gen p mean: 0.0, mean p set: 0.44912847876548767
loss_pred:0.027888605371117592, decouple_loss:0.00929932203143835
loss_pred:0.02791757322847843, decouple_loss:0.00954077485948801
loss_pred:0.02602761797606945, decouple_loss:0.009569664485752583
Iteration: 2339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106130838394165, gen p mean: 0.0, mean p set: 0.4464380145072937
The modified gen p mean: 0.445855975151062, gen p mean: 0.0, mean p set: 0.44872260093688965
The modified gen p mean: 0.44310399889945984, gen p mean: 0.0, mean p set: 0.44760826230049133
loss_pred:0.026114681735634804, decouple_loss:0.00872769020497799
loss_pred:0.026221569627523422, decouple_loss:0.00901311356574297
loss_pred:0.027420353144407272, decouple_loss:0.00931743998080492
Iteration: 2340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45577144622802734, gen p mean: 0.0, mean p set: 0.4471311867237091
The modified gen p mean: 0.4527549743652344, gen p mean: 0.0, mean p set: 0.44749733805656433
The modified gen p mean: 0.4550788104534149, gen p mean: 0.0, mean p set: 0.4460771083831787
loss_pred:0.02675543911755085, decouple_loss:0.008688278496265411
loss_pred:0.027745652943849564, decouple_loss:0.009296593256294727
loss_pred:0.027306323871016502, decouple_loss:0.009141801856458187
2023-05-03 06:04:16 testing...
The modified gen p mean: 0.4416694939136505, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4467257261276245, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44975319504737854, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027966000139713287, decouple_loss:0.009550545364618301
loss_pred:0.026902679353952408, decouple_loss:0.009461220353841782
loss_pred:0.026745473966002464, decouple_loss:0.009411212056875229
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027678435668349266, avg_mse: 0.0327640026807785
current test mse: 0.032764
Iteration: 2341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4433572292327881, gen p mean: 0.0, mean p set: 0.4474653899669647
loss_pred:0.027566155418753624, decouple_loss:0.009329396300017834
The modified gen p mean: 0.44620823860168457, gen p mean: 0.0, mean p set: 0.4466344118118286
loss_pred:0.027449334040284157, decouple_loss:0.009022642858326435
The modified gen p mean: 0.4440445005893707, gen p mean: 0.0, mean p set: 0.4474627375602722
loss_pred:0.027941707521677017, decouple_loss:0.00920352153480053
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
NaN value num: 0
Iteration: 2342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44455084204673767, gen p mean: 0.0, mean p set: 0.4533900320529938
The modified gen p mean: 0.44572699069976807, gen p mean: 0.0, mean p set: 0.4510560631752014
The modified gen p mean: 0.44510310888290405, gen p mean: 0.0, mean p set: 0.4518337547779083
loss_pred:0.026618575677275658, decouple_loss:0.010213294997811317
loss_pred:0.027305543422698975, decouple_loss:0.010810772888362408
loss_pred:0.026226617395877838, decouple_loss:0.011081094853579998
Iteration: 2343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912633299827576, gen p mean: 0.0, mean p set: 0.4521554708480835
The modified gen p mean: 0.44745519757270813, gen p mean: 0.0, mean p set: 0.45147183537483215
The modified gen p mean: 0.4510510265827179, gen p mean: 0.0, mean p set: 0.45152246952056885
loss_pred:0.02744954638183117, decouple_loss:0.010642622597515583
loss_pred:0.026586193591356277, decouple_loss:0.010059366934001446
loss_pred:0.028323182836174965, decouple_loss:0.010780067183077335
Iteration: 2344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45587947964668274, gen p mean: 0.0, mean p set: 0.45206722617149353
The modified gen p mean: 0.4588087499141693, gen p mean: 0.0, mean p set: 0.45187854766845703
The modified gen p mean: 0.46420371532440186, gen p mean: 0.0, mean p set: 0.452898770570755
loss_pred:0.027709463611245155, decouple_loss:0.010482223704457283
loss_pred:0.027538537979125977, decouple_loss:0.010248029604554176
loss_pred:0.027142703533172607, decouple_loss:0.010822370648384094
Iteration: 2345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46118131279945374, gen p mean: 0.0, mean p set: 0.4521616995334625
The modified gen p mean: 0.45351681113243103, gen p mean: 0.0, mean p set: 0.4514085352420807
The modified gen p mean: 0.4575473368167877, gen p mean: 0.0, mean p set: 0.4516139328479767
loss_pred:0.027445591986179352, decouple_loss:0.01035518478602171
loss_pred:0.02632914111018181, decouple_loss:0.01000883337110281
loss_pred:0.027148591354489326, decouple_loss:0.010101891122758389
Iteration: 2346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4436377286911011, gen p mean: 0.0, mean p set: 0.4510124921798706
The modified gen p mean: 0.4424198567867279, gen p mean: 0.0, mean p set: 0.4515584707260132
The modified gen p mean: 0.44248250126838684, gen p mean: 0.0, mean p set: 0.45099735260009766
loss_pred:0.026629069820046425, decouple_loss:0.010470210574567318
loss_pred:0.027793625369668007, decouple_loss:0.010535352863371372
loss_pred:0.02622600831091404, decouple_loss:0.010525910183787346
Iteration: 2347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44243890047073364, gen p mean: 0.0, mean p set: 0.45063820481300354
The modified gen p mean: 0.44443681836128235, gen p mean: 0.0, mean p set: 0.45225754380226135
The modified gen p mean: 0.44729602336883545, gen p mean: 0.0, mean p set: 0.45075303316116333
loss_pred:0.027039257809519768, decouple_loss:0.01002001017332077
loss_pred:0.027299506589770317, decouple_loss:0.010398886166512966
loss_pred:0.026182567700743675, decouple_loss:0.010672814212739468
Iteration: 2348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4580528736114502, gen p mean: 0.0, mean p set: 0.4515230059623718
The modified gen p mean: 0.458023339509964, gen p mean: 0.0, mean p set: 0.4523589313030243
The modified gen p mean: 0.45683935284614563, gen p mean: 0.0, mean p set: 0.45066869258880615
loss_pred:0.026222998276352882, decouple_loss:0.009897205978631973
loss_pred:0.026537615805864334, decouple_loss:0.010518496856093407
loss_pred:0.02697819471359253, decouple_loss:0.010035919025540352
Iteration: 2349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4575633704662323, gen p mean: 0.0, mean p set: 0.4512766897678375
The modified gen p mean: 0.4572213292121887, gen p mean: 0.0, mean p set: 0.45121413469314575
The modified gen p mean: 0.4554494321346283, gen p mean: 0.0, mean p set: 0.4512709379196167
loss_pred:0.02730783261358738, decouple_loss:0.010194863192737103
loss_pred:0.026610268279910088, decouple_loss:0.01027920376509428
loss_pred:0.02687652036547661, decouple_loss:0.010211286135017872
Iteration: 2350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706958532333374, gen p mean: 0.0, mean p set: 0.4502072036266327
The modified gen p mean: 0.44457709789276123, gen p mean: 0.0, mean p set: 0.4517157971858978
The modified gen p mean: 0.446659654378891, gen p mean: 0.0, mean p set: 0.4524179995059967
loss_pred:0.02688983641564846, decouple_loss:0.01003031525760889
loss_pred:0.02738179825246334, decouple_loss:0.009859993122518063
loss_pred:0.026836827397346497, decouple_loss:0.010434282943606377
2023-05-03 06:08:38 testing...
The modified gen p mean: 0.43832144141197205, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4434560239315033, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4462299942970276, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02813182771205902, decouple_loss:0.010742341168224812
loss_pred:0.02700190059840679, decouple_loss:0.010595468804240227
loss_pred:0.026709165424108505, decouple_loss:0.01087725255638361
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02781788259744644, avg_mse: 0.03291585296392441
current test mse: 0.032916
Iteration: 2351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933947920799255, gen p mean: 0.0, mean p set: 0.4523850381374359
loss_pred:0.027306271716952324, decouple_loss:0.010369786992669106
The modified gen p mean: 0.44641393423080444, gen p mean: 0.0, mean p set: 0.4519473612308502
loss_pred:0.027601325884461403, decouple_loss:0.010512169450521469
The modified gen p mean: 0.44146648049354553, gen p mean: 0.0, mean p set: 0.4510093629360199
loss_pred:0.026478977873921394, decouple_loss:0.009791308082640171
Iteration: 2352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4561097025871277, gen p mean: 0.0, mean p set: 0.45158323645591736
The modified gen p mean: 0.4541434645652771, gen p mean: 0.0, mean p set: 0.4513293206691742
The modified gen p mean: 0.4555935859680176, gen p mean: 0.0, mean p set: 0.452073335647583
loss_pred:0.027708427980542183, decouple_loss:0.010342112742364407
loss_pred:0.026610875502228737, decouple_loss:0.009868026711046696
loss_pred:0.026709241792559624, decouple_loss:0.009672509506344795
Iteration: 2353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4546474516391754, gen p mean: 0.0, mean p set: 0.4512738585472107
The modified gen p mean: 0.4589642286300659, gen p mean: 0.0, mean p set: 0.4515573978424072
The modified gen p mean: 0.45586442947387695, gen p mean: 0.0, mean p set: 0.45016512274742126
loss_pred:0.027187487110495567, decouple_loss:0.009857040829956532
loss_pred:0.025987647473812103, decouple_loss:0.010381177067756653
loss_pred:0.027053171768784523, decouple_loss:0.00976690836250782
Iteration: 2354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838792085647583, gen p mean: 0.0, mean p set: 0.4509367048740387
The modified gen p mean: 0.44801074266433716, gen p mean: 0.0, mean p set: 0.451976478099823
The modified gen p mean: 0.4467732310295105, gen p mean: 0.0, mean p set: 0.45159196853637695
loss_pred:0.025651702657341957, decouple_loss:0.009861519560217857
loss_pred:0.02671724557876587, decouple_loss:0.0098193334415555
loss_pred:0.026920033618807793, decouple_loss:0.009581037797033787
Iteration: 2355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4429052770137787, gen p mean: 0.0, mean p set: 0.4522736966609955
The modified gen p mean: 0.44249287247657776, gen p mean: 0.0, mean p set: 0.45285114645957947
The modified gen p mean: 0.44337254762649536, gen p mean: 0.0, mean p set: 0.4526248872280121
loss_pred:0.0262824147939682, decouple_loss:0.009494352154433727
loss_pred:0.02650230936706066, decouple_loss:0.00960585381835699
loss_pred:0.027225041761994362, decouple_loss:0.009504040703177452
Iteration: 2356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489920139312744, gen p mean: 0.0, mean p set: 0.4516545534133911
The modified gen p mean: 0.4501803517341614, gen p mean: 0.0, mean p set: 0.45129165053367615
The modified gen p mean: 0.4465237557888031, gen p mean: 0.0, mean p set: 0.45200711488723755
loss_pred:0.02703820914030075, decouple_loss:0.009875131770968437
loss_pred:0.02625304087996483, decouple_loss:0.009651429019868374
loss_pred:0.027212489396333694, decouple_loss:0.010191048495471478
Iteration: 2357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46434423327445984, gen p mean: 0.0, mean p set: 0.4535543620586395
The modified gen p mean: 0.4679417908191681, gen p mean: 0.0, mean p set: 0.4507089853286743
The modified gen p mean: 0.46425721049308777, gen p mean: 0.0, mean p set: 0.45150890946388245
loss_pred:0.025741321966052055, decouple_loss:0.009822825901210308
loss_pred:0.026025716215372086, decouple_loss:0.009822145104408264
loss_pred:0.025915514677762985, decouple_loss:0.009675492532551289
Iteration: 2358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501345455646515, gen p mean: 0.0, mean p set: 0.45111268758773804
The modified gen p mean: 0.45844146609306335, gen p mean: 0.0, mean p set: 0.45058155059814453
The modified gen p mean: 0.44793087244033813, gen p mean: 0.0, mean p set: 0.450882226228714
loss_pred:0.02562178485095501, decouple_loss:0.009585583582520485
loss_pred:0.02641310729086399, decouple_loss:0.009744279086589813
loss_pred:0.02601514384150505, decouple_loss:0.009567223489284515
Iteration: 2359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44516056776046753, gen p mean: 0.0, mean p set: 0.45040586590766907
The modified gen p mean: 0.4444584250450134, gen p mean: 0.0, mean p set: 0.4506221413612366
loss_pred:0.026140080764889717, decouple_loss:0.009602171368896961
The modified gen p mean: 0.44470450282096863, gen p mean: 0.0, mean p set: 0.4528968930244446
loss_pred:0.02661633864045143, decouple_loss:0.009747897274792194
loss_pred:0.025497445836663246, decouple_loss:0.009795675985515118
Iteration: 2360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43985867500305176, gen p mean: 0.0, mean p set: 0.45146840810775757
The modified gen p mean: 0.4455236494541168, gen p mean: 0.0, mean p set: 0.4514089822769165
The modified gen p mean: 0.44223663210868835, gen p mean: 0.0, mean p set: 0.4510968327522278
loss_pred:0.02703026309609413, decouple_loss:0.009559600614011288
loss_pred:0.026151245459914207, decouple_loss:0.009406998753547668
loss_pred:0.026910554617643356, decouple_loss:0.009509358555078506
2023-05-03 06:12:17 testing...
The modified gen p mean: 0.44930848479270935, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4572828710079193, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.45449018478393555, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.027863943949341774, decouple_loss:0.010254132561385632
loss_pred:0.026479415595531464, decouple_loss:0.010223934426903725
loss_pred:0.026825740933418274, decouple_loss:0.009938439354300499
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0275633092969656, avg_mse: 0.03252684697508812
current test mse: 0.032527
Iteration: 2361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4605991542339325, gen p mean: 0.0, mean p set: 0.450682133436203
The modified gen p mean: 0.4568488299846649, gen p mean: 0.0, mean p set: 0.4517492651939392
loss_pred:0.027151260524988174, decouple_loss:0.00915901456028223
loss_pred:0.02554510347545147, decouple_loss:0.009325162507593632
The modified gen p mean: 0.4594360589981079, gen p mean: 0.0, mean p set: 0.4522019624710083
loss_pred:0.02657853439450264, decouple_loss:0.00934330839663744
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 2362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497443437576294, gen p mean: 0.0, mean p set: 0.4480628967285156
The modified gen p mean: 0.4544413685798645, gen p mean: 0.0, mean p set: 0.44752857089042664
The modified gen p mean: 0.4558437764644623, gen p mean: 0.0, mean p set: 0.44803139567375183
loss_pred:0.027684947475790977, decouple_loss:0.009762797504663467
loss_pred:0.028000613674521446, decouple_loss:0.009987195953726768
loss_pred:0.0275388453155756, decouple_loss:0.009958789683878422
Iteration: 2363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43934693932533264, gen p mean: 0.0, mean p set: 0.44736534357070923
The modified gen p mean: 0.44218796491622925, gen p mean: 0.0, mean p set: 0.4469609558582306
The modified gen p mean: 0.44494739174842834, gen p mean: 0.0, mean p set: 0.4477604627609253
loss_pred:0.028019215911626816, decouple_loss:0.010952531360089779
loss_pred:0.026664549484848976, decouple_loss:0.009848742745816708
loss_pred:0.02742546983063221, decouple_loss:0.009866130538284779
Iteration: 2364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44518449902534485, gen p mean: 0.0, mean p set: 0.4468221068382263
The modified gen p mean: 0.44215771555900574, gen p mean: 0.0, mean p set: 0.44846174120903015
The modified gen p mean: 0.4398113489151001, gen p mean: 0.0, mean p set: 0.44807443022727966
loss_pred:0.02703157439827919, decouple_loss:0.011154822073876858
loss_pred:0.027134841307997704, decouple_loss:0.009429503232240677
loss_pred:0.026240274310112, decouple_loss:0.009622580371797085
Iteration: 2365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502478837966919, gen p mean: 0.0, mean p set: 0.4500883221626282
The modified gen p mean: 0.4480222463607788, gen p mean: 0.0, mean p set: 0.449098140001297
The modified gen p mean: 0.45348766446113586, gen p mean: 0.0, mean p set: 0.4476413428783417
loss_pred:0.026505909860134125, decouple_loss:0.009655926376581192
loss_pred:0.027721714228391647, decouple_loss:0.009339063428342342
loss_pred:0.02750045619904995, decouple_loss:0.00939110666513443
Iteration: 2366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45324498414993286, gen p mean: 0.0, mean p set: 0.4477183520793915
The modified gen p mean: 0.45128950476646423, gen p mean: 0.0, mean p set: 0.4474082589149475
The modified gen p mean: 0.45133176445961, gen p mean: 0.0, mean p set: 0.4481140077114105
loss_pred:0.028834473341703415, decouple_loss:0.009429327212274075
loss_pred:0.02833080105483532, decouple_loss:0.009427856653928757
loss_pred:0.02660408988595009, decouple_loss:0.009322120808064938
Iteration: 2367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45011207461357117, gen p mean: 0.0, mean p set: 0.44890403747558594
The modified gen p mean: 0.4547581076622009, gen p mean: 0.0, mean p set: 0.44714486598968506
The modified gen p mean: 0.44989874958992004, gen p mean: 0.0, mean p set: 0.44703981280326843
loss_pred:0.026717109605669975, decouple_loss:0.009393904358148575
loss_pred:0.026467811316251755, decouple_loss:0.009227241389453411
loss_pred:0.027969883754849434, decouple_loss:0.009815042838454247
Iteration: 2368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711294770240784, gen p mean: 0.0, mean p set: 0.4471592903137207
The modified gen p mean: 0.4426776170730591, gen p mean: 0.0, mean p set: 0.44813334941864014
The modified gen p mean: 0.4451879560947418, gen p mean: 0.0, mean p set: 0.44989389181137085
loss_pred:0.02667778544127941, decouple_loss:0.009607302956283092
loss_pred:0.027151919901371002, decouple_loss:0.009471766650676727
loss_pred:0.026795340701937675, decouple_loss:0.009532456286251545
Iteration: 2369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4447824954986572, gen p mean: 0.0, mean p set: 0.4478605389595032
The modified gen p mean: 0.43857714533805847, gen p mean: 0.0, mean p set: 0.44897395372390747
The modified gen p mean: 0.4466248154640198, gen p mean: 0.0, mean p set: 0.4479648470878601
loss_pred:0.028208764269948006, decouple_loss:0.009000287391245365
loss_pred:0.02726547047495842, decouple_loss:0.009341412223875523
loss_pred:0.027422962710261345, decouple_loss:0.009208614006638527
Iteration: 2370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518892168998718, gen p mean: 0.0, mean p set: 0.44699788093566895
The modified gen p mean: 0.4524052143096924, gen p mean: 0.0, mean p set: 0.44802284240722656
The modified gen p mean: 0.45215460658073425, gen p mean: 0.0, mean p set: 0.4489316940307617
loss_pred:0.027221359312534332, decouple_loss:0.00945161934942007
loss_pred:0.027497144415974617, decouple_loss:0.009031425230205059
loss_pred:0.02693074382841587, decouple_loss:0.009131761267781258
2023-05-03 06:16:40 testing...
The modified gen p mean: 0.45456862449645996, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4456945061683655, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4514506459236145, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.027599219232797623, decouple_loss:0.00955907441675663
loss_pred:0.026262637227773666, decouple_loss:0.009171984158456326
loss_pred:0.026619218289852142, decouple_loss:0.009228890761733055
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027293024584650993, avg_mse: 0.032251499593257904
current test mse: 0.032252
Iteration: 2371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502039849758148, gen p mean: 0.0, mean p set: 0.44728177785873413
The modified gen p mean: 0.4536092281341553, gen p mean: 0.0, mean p set: 0.4474294185638428
loss_pred:0.027602460235357285, decouple_loss:0.009462897665798664
loss_pred:0.02610274776816368, decouple_loss:0.0091190030798316
The modified gen p mean: 0.4512423872947693, gen p mean: 0.0, mean p set: 0.4473989009857178
loss_pred:0.028065621852874756, decouple_loss:0.008885784074664116
Iteration: 2372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800442457199097, gen p mean: 0.0, mean p set: 0.4471484422683716
The modified gen p mean: 0.4496033787727356, gen p mean: 0.0, mean p set: 0.44737815856933594
The modified gen p mean: 0.4445328712463379, gen p mean: 0.0, mean p set: 0.44753316044807434
loss_pred:0.02691434696316719, decouple_loss:0.00917557068169117
loss_pred:0.02709094062447548, decouple_loss:0.008669166825711727
loss_pred:0.02786424197256565, decouple_loss:0.00866351556032896
Iteration: 2373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4389169216156006, gen p mean: 0.0, mean p set: 0.4494958221912384
The modified gen p mean: 0.43998363614082336, gen p mean: 0.0, mean p set: 0.4482575058937073
The modified gen p mean: 0.4375380873680115, gen p mean: 0.0, mean p set: 0.4487859904766083
loss_pred:0.026883555576205254, decouple_loss:0.00914384052157402
loss_pred:0.027566682547330856, decouple_loss:0.009106893092393875
loss_pred:0.02686409279704094, decouple_loss:0.008682525716722012
Iteration: 2374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497881233692169, gen p mean: 0.0, mean p set: 0.4497283697128296
The modified gen p mean: 0.4480619728565216, gen p mean: 0.0, mean p set: 0.44899824261665344
The modified gen p mean: 0.4468366801738739, gen p mean: 0.0, mean p set: 0.448797345161438
loss_pred:0.026674553751945496, decouple_loss:0.008805697783827782
loss_pred:0.026816094294190407, decouple_loss:0.008795122615993023
loss_pred:0.027550866827368736, decouple_loss:0.008899614214897156
Iteration: 2375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45476800203323364, gen p mean: 0.0, mean p set: 0.44861525297164917The modified gen p mean: 0.45712077617645264, gen p mean: 0.0, mean p set: 0.44820234179496765
The modified gen p mean: 0.4562458395957947, gen p mean: 0.0, mean p set: 0.4470820426940918
loss_pred:0.027757348492741585, decouple_loss:0.008760636672377586
loss_pred:0.027172178030014038, decouple_loss:0.008599379099905491
loss_pred:0.02651262655854225, decouple_loss:0.009254621341824532
Iteration: 2376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540432095527649, gen p mean: 0.0, mean p set: 0.4473569989204407
The modified gen p mean: 0.45104914903640747, gen p mean: 0.0, mean p set: 0.4469473958015442
The modified gen p mean: 0.4494406282901764, gen p mean: 0.0, mean p set: 0.4487267732620239
loss_pred:0.02619694359600544, decouple_loss:0.008864304982125759
loss_pred:0.027287527918815613, decouple_loss:0.009070766158401966
loss_pred:0.027188023552298546, decouple_loss:0.008876676671206951
Iteration: 2377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44398608803749084, gen p mean: 0.0, mean p set: 0.4478318989276886
The modified gen p mean: 0.44727009534835815, gen p mean: 0.0, mean p set: 0.44751542806625366
The modified gen p mean: 0.443410724401474, gen p mean: 0.0, mean p set: 0.4471015930175781
loss_pred:0.02809121273458004, decouple_loss:0.00859145913273096
loss_pred:0.02660091407597065, decouple_loss:0.008739477954804897
loss_pred:0.02861962467432022, decouple_loss:0.009080581367015839
Iteration: 2378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4400385022163391, gen p mean: 0.0, mean p set: 0.4481104910373688
The modified gen p mean: 0.44454053044319153, gen p mean: 0.0, mean p set: 0.44798544049263
The modified gen p mean: 0.44384801387786865, gen p mean: 0.0, mean p set: 0.44744372367858887
loss_pred:0.02613919973373413, decouple_loss:0.008536083623766899
loss_pred:0.027390144765377045, decouple_loss:0.008476676419377327
loss_pred:0.027028240263462067, decouple_loss:0.0088261179625988
Iteration: 2379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669443368911743, gen p mean: 0.0, mean p set: 0.4481060206890106
The modified gen p mean: 0.4472438395023346, gen p mean: 0.0, mean p set: 0.4473494589328766
The modified gen p mean: 0.45079806447029114, gen p mean: 0.0, mean p set: 0.44738900661468506
loss_pred:0.027689587324857712, decouple_loss:0.00843094289302826
loss_pred:0.028775721788406372, decouple_loss:0.008738436736166477
loss_pred:0.026218784973025322, decouple_loss:0.008465409278869629
Iteration: 2380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476418197154999, gen p mean: 0.0, mean p set: 0.4484897553920746
The modified gen p mean: 0.4495421350002289, gen p mean: 0.0, mean p set: 0.4468388855457306
The modified gen p mean: 0.4455447196960449, gen p mean: 0.0, mean p set: 0.4484971761703491
loss_pred:0.026875771582126617, decouple_loss:0.008798493072390556
loss_pred:0.027048269286751747, decouple_loss:0.00871095061302185
loss_pred:0.02606872469186783, decouple_loss:0.008601758629083633
2023-05-03 06:20:21 testing...
The modified gen p mean: 0.4502313435077667, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4475092887878418, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4420020878314972, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.02609427087008953, decouple_loss:0.00869886577129364
loss_pred:0.026463594287633896, decouple_loss:0.008759314194321632
loss_pred:0.027469336986541748, decouple_loss:0.009107934311032295
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02711850218474865, avg_mse: 0.031980279833078384
current test mse: 0.03198
Iteration: 2381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507753849029541, gen p mean: 0.0, mean p set: 0.44733917713165283
The modified gen p mean: 0.4479406476020813, gen p mean: 0.0, mean p set: 0.44677209854125977
loss_pred:0.027057291939854622, decouple_loss:0.008541624061763287
loss_pred:0.02710367739200592, decouple_loss:0.009138209745287895
The modified gen p mean: 0.44445711374282837, gen p mean: 0.0, mean p set: 0.4482457637786865
loss_pred:0.026710936799645424, decouple_loss:0.008754781447350979
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
NaN value num: 0
Iteration: 2382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4558945894241333, gen p mean: 0.0, mean p set: 0.45297008752822876
The modified gen p mean: 0.45423510670661926, gen p mean: 0.0, mean p set: 0.45060494542121887The modified gen p mean: 0.4536435008049011, gen p mean: 0.0, mean p set: 0.4482645094394684
loss_pred:0.027757396921515465, decouple_loss:0.00963581632822752loss_pred:0.027473151683807373, decouple_loss:0.009526662528514862
loss_pred:0.025937825441360474, decouple_loss:0.009533063508570194
Iteration: 2383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45644044876098633, gen p mean: 0.0, mean p set: 0.45275649428367615
The modified gen p mean: 0.4511581063270569, gen p mean: 0.0, mean p set: 0.4494827091693878
The modified gen p mean: 0.4525945782661438, gen p mean: 0.0, mean p set: 0.449381947517395
loss_pred:0.02601562812924385, decouple_loss:0.009455225430428982
loss_pred:0.02688147872686386, decouple_loss:0.009343568235635757
loss_pred:0.0270158089697361, decouple_loss:0.009262791834771633
Iteration: 2384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44251102209091187, gen p mean: 0.0, mean p set: 0.4502033293247223
The modified gen p mean: 0.4397224485874176, gen p mean: 0.0, mean p set: 0.45247551798820496
The modified gen p mean: 0.4453755021095276, gen p mean: 0.0, mean p set: 0.45030689239501953
loss_pred:0.025851799175143242, decouple_loss:0.009293947368860245
loss_pred:0.025543028488755226, decouple_loss:0.009424084797501564
loss_pred:0.026010284200310707, decouple_loss:0.008957363665103912
Iteration: 2385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470100402832031, gen p mean: 0.0, mean p set: 0.44958722591400146
The modified gen p mean: 0.44661447405815125, gen p mean: 0.0, mean p set: 0.4518527686595917
The modified gen p mean: 0.4427058696746826, gen p mean: 0.0, mean p set: 0.4494905471801758
loss_pred:0.026395253837108612, decouple_loss:0.009033952839672565
loss_pred:0.02565957047045231, decouple_loss:0.009190715849399567
loss_pred:0.026265611872076988, decouple_loss:0.009605283848941326
Iteration: 2386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513762593269348, gen p mean: 0.0, mean p set: 0.44908812642097473
The modified gen p mean: 0.455804705619812, gen p mean: 0.0, mean p set: 0.4522479474544525
The modified gen p mean: 0.45460665225982666, gen p mean: 0.0, mean p set: 0.44900739192962646
loss_pred:0.02582671120762825, decouple_loss:0.009291503578424454
loss_pred:0.025651751086115837, decouple_loss:0.009708433412015438
loss_pred:0.027107346802949905, decouple_loss:0.008936314843595028
Iteration: 2387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45557889342308044, gen p mean: 0.0, mean p set: 0.4505264163017273
The modified gen p mean: 0.4566081464290619, gen p mean: 0.0, mean p set: 0.4507688283920288
The modified gen p mean: 0.4517996311187744, gen p mean: 0.0, mean p set: 0.4490666687488556
loss_pred:0.0251165684312582, decouple_loss:0.00945513416081667
loss_pred:0.026814162731170654, decouple_loss:0.008806183934211731
loss_pred:0.02591046690940857, decouple_loss:0.008970702067017555
Iteration: 2388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45526573061943054, gen p mean: 0.0, mean p set: 0.4498515725135803
The modified gen p mean: 0.4532310962677002, gen p mean: 0.0, mean p set: 0.45065850019454956
The modified gen p mean: 0.45536109805107117, gen p mean: 0.0, mean p set: 0.4509258568286896
loss_pred:0.025582898408174515, decouple_loss:0.009381852112710476
loss_pred:0.025456149131059647, decouple_loss:0.009456626139581203
loss_pred:0.02651015669107437, decouple_loss:0.009822843596339226
Iteration: 2389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44156771898269653, gen p mean: 0.0, mean p set: 0.44911783933639526
The modified gen p mean: 0.44434529542922974, gen p mean: 0.0, mean p set: 0.4495079815387726
The modified gen p mean: 0.43877193331718445, gen p mean: 0.0, mean p set: 0.44809824228286743
loss_pred:0.02620556950569153, decouple_loss:0.00920032151043415
loss_pred:0.026253633201122284, decouple_loss:0.008975944481790066
loss_pred:0.0254872664809227, decouple_loss:0.009086402133107185
Iteration: 2390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44138088822364807, gen p mean: 0.0, mean p set: 0.45024624466896057
The modified gen p mean: 0.4440065324306488, gen p mean: 0.0, mean p set: 0.4518917500972748
The modified gen p mean: 0.4427633583545685, gen p mean: 0.0, mean p set: 0.45017367601394653
loss_pred:0.025857647880911827, decouple_loss:0.009120874106884003
loss_pred:0.02522650547325611, decouple_loss:0.009112207219004631
loss_pred:0.025798652321100235, decouple_loss:0.009095854125916958
2023-05-03 06:24:40 testing...
The modified gen p mean: 0.46264663338661194, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.45457375049591064, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4601704776287079, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.026333408430218697, decouple_loss:0.009562521241605282
loss_pred:0.0276827160269022, decouple_loss:0.009850888513028622
loss_pred:0.02663365937769413, decouple_loss:0.009567360393702984
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0273662768304348, avg_mse: 0.03230750933289528
current test mse: 0.032308
Iteration: 2391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4610534906387329, gen p mean: 0.0, mean p set: 0.4526459276676178
The modified gen p mean: 0.45450660586357117, gen p mean: 0.0, mean p set: 0.44993945956230164
loss_pred:0.025628777220845222, decouple_loss:0.009116990491747856
loss_pred:0.02525128796696663, decouple_loss:0.008827933110296726
The modified gen p mean: 0.45655587315559387, gen p mean: 0.0, mean p set: 0.4504929184913635
loss_pred:0.0261551383882761, decouple_loss:0.009089522063732147
Iteration: 2392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522477686405182, gen p mean: 0.0, mean p set: 0.4499800503253937
The modified gen p mean: 0.45232853293418884, gen p mean: 0.0, mean p set: 0.45045995712280273
The modified gen p mean: 0.44917231798171997, gen p mean: 0.0, mean p set: 0.4518038034439087
loss_pred:0.02708522044122219, decouple_loss:0.009499331004917622
loss_pred:0.0256754532456398, decouple_loss:0.009135083295404911
loss_pred:0.02491978369653225, decouple_loss:0.009387802332639694
Iteration: 2393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503311514854431, gen p mean: 0.0, mean p set: 0.45156213641166687
The modified gen p mean: 0.45606303215026855, gen p mean: 0.0, mean p set: 0.4505072236061096
The modified gen p mean: 0.45187297463417053, gen p mean: 0.0, mean p set: 0.45140528678894043
loss_pred:0.026778725907206535, decouple_loss:0.00930944737046957
loss_pred:0.025837024673819542, decouple_loss:0.008910533972084522
loss_pred:0.025013860315084457, decouple_loss:0.009086758829653263
Iteration: 2394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44537055492401123, gen p mean: 0.0, mean p set: 0.4505738615989685
The modified gen p mean: 0.44492340087890625, gen p mean: 0.0, mean p set: 0.44941338896751404
The modified gen p mean: 0.4578884541988373, gen p mean: 0.0, mean p set: 0.44963955879211426
loss_pred:0.02534601278603077, decouple_loss:0.008916119113564491
loss_pred:0.02559160254895687, decouple_loss:0.009442704729735851
loss_pred:0.02699478343129158, decouple_loss:0.008897438645362854
Iteration: 2395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466313421726227, gen p mean: 0.0, mean p set: 0.4507831633090973
The modified gen p mean: 0.44755488634109497, gen p mean: 0.0, mean p set: 0.45264333486557007
The modified gen p mean: 0.44554662704467773, gen p mean: 0.0, mean p set: 0.4509424567222595
loss_pred:0.02651742473244667, decouple_loss:0.008989252150058746
loss_pred:0.025537412613630295, decouple_loss:0.008874302729964256
loss_pred:0.025838175788521767, decouple_loss:0.00879251305013895
Iteration: 2396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694530963897705, gen p mean: 0.0, mean p set: 0.4518826901912689
The modified gen p mean: 0.44669318199157715, gen p mean: 0.0, mean p set: 0.4506358802318573
The modified gen p mean: 0.4503726065158844, gen p mean: 0.0, mean p set: 0.4483596682548523
loss_pred:0.02662883885204792, decouple_loss:0.008699391037225723
loss_pred:0.02666539140045643, decouple_loss:0.008571040816605091
loss_pred:0.027288345620036125, decouple_loss:0.008754860609769821
Iteration: 2397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4570395052433014, gen p mean: 0.0, mean p set: 0.4522995054721832
The modified gen p mean: 0.45628514885902405, gen p mean: 0.0, mean p set: 0.4510234594345093
The modified gen p mean: 0.45542842149734497, gen p mean: 0.0, mean p set: 0.451885849237442
loss_pred:0.02531600371003151, decouple_loss:0.009180767461657524
loss_pred:0.027018945664167404, decouple_loss:0.009011813439428806
loss_pred:0.026204220950603485, decouple_loss:0.008652763441205025
Iteration: 2398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.442751944065094, gen p mean: 0.0, mean p set: 0.45026248693466187
The modified gen p mean: 0.44692403078079224, gen p mean: 0.0, mean p set: 0.45152729749679565
The modified gen p mean: 0.44629335403442383, gen p mean: 0.0, mean p set: 0.44952380657196045
loss_pred:0.026581106707453728, decouple_loss:0.008888009935617447
loss_pred:0.025691388174891472, decouple_loss:0.008939829654991627
loss_pred:0.026006082072854042, decouple_loss:0.008966190740466118
Iteration: 2399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451516270637512, gen p mean: 0.0, mean p set: 0.4519214332103729
The modified gen p mean: 0.45222753286361694, gen p mean: 0.0, mean p set: 0.4504006803035736
The modified gen p mean: 0.45159444212913513, gen p mean: 0.0, mean p set: 0.4497814178466797
loss_pred:0.02492569200694561, decouple_loss:0.008931315504014492
loss_pred:0.026473525911569595, decouple_loss:0.008676273748278618
loss_pred:0.026832643896341324, decouple_loss:0.008463853970170021
Iteration: 2400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45987117290496826, gen p mean: 0.0, mean p set: 0.4510088264942169
The modified gen p mean: 0.4523395299911499, gen p mean: 0.0, mean p set: 0.45193883776664734
The modified gen p mean: 0.45629557967185974, gen p mean: 0.0, mean p set: 0.44976404309272766
loss_pred:0.025633394718170166, decouple_loss:0.008329002186655998
loss_pred:0.02572210133075714, decouple_loss:0.008926453068852425
loss_pred:0.02622538059949875, decouple_loss:0.008260377682745457
2023-05-03 06:28:21 testing...
The modified gen p mean: 0.45030319690704346, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44184204936027527, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44756650924682617, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.026219360530376434, decouple_loss:0.009226461872458458
loss_pred:0.02761949971318245, decouple_loss:0.00938565656542778
loss_pred:0.026526479050517082, decouple_loss:0.009204735979437828
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027252061292529106, avg_mse: 0.032305389642715454
current test mse: 0.032305
Iteration: 2401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018884539604187, gen p mean: 0.0, mean p set: 0.4490615427494049
The modified gen p mean: 0.44137823581695557, gen p mean: 0.0, mean p set: 0.45023781061172485
loss_pred:0.02708333358168602, decouple_loss:0.00859122071415186
loss_pred:0.026086071506142616, decouple_loss:0.008631140924990177
The modified gen p mean: 0.4513768255710602, gen p mean: 0.0, mean p set: 0.4533156752586365
loss_pred:0.026683947071433067, decouple_loss:0.008666195906698704
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
NaN value num: 0
Iteration: 2402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4447482228279114, gen p mean: 0.0, mean p set: 0.4526795446872711
The modified gen p mean: 0.44801101088523865, gen p mean: 0.0, mean p set: 0.45342111587524414
The modified gen p mean: 0.4462190568447113, gen p mean: 0.0, mean p set: 0.45501336455345154
loss_pred:0.025847777724266052, decouple_loss:0.009115573950111866
loss_pred:0.02654171548783779, decouple_loss:0.009137112647294998
loss_pred:0.027233697474002838, decouple_loss:0.009640478529036045
Iteration: 2403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45538970828056335, gen p mean: 0.0, mean p set: 0.4522015452384949
The modified gen p mean: 0.45932313799858093, gen p mean: 0.0, mean p set: 0.4535783529281616
The modified gen p mean: 0.45633360743522644, gen p mean: 0.0, mean p set: 0.4532153010368347
loss_pred:0.02727332152426243, decouple_loss:0.009223755449056625
loss_pred:0.026264268904924393, decouple_loss:0.009518967941403389
loss_pred:0.0271567702293396, decouple_loss:0.009557576850056648
Iteration: 2404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4614841341972351, gen p mean: 0.0, mean p set: 0.4514826238155365
The modified gen p mean: 0.4623885750770569, gen p mean: 0.0, mean p set: 0.4532998204231262
The modified gen p mean: 0.4609657824039459, gen p mean: 0.0, mean p set: 0.453086256980896
loss_pred:0.027106143534183502, decouple_loss:0.009699939750134945
loss_pred:0.026381606236100197, decouple_loss:0.009232236072421074
loss_pred:0.026718543842434883, decouple_loss:0.009273383766412735
Iteration: 2405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4435408115386963, gen p mean: 0.0, mean p set: 0.4535493850708008
The modified gen p mean: 0.43924278020858765, gen p mean: 0.0, mean p set: 0.4530949294567108
The modified gen p mean: 0.43927568197250366, gen p mean: 0.0, mean p set: 0.4527115225791931
loss_pred:0.026325643062591553, decouple_loss:0.009253909811377525
loss_pred:0.026884252205491066, decouple_loss:0.009304511360824108
loss_pred:0.026627687737345695, decouple_loss:0.009282874874770641
Iteration: 2406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975826144218445, gen p mean: 0.0, mean p set: 0.4539981782436371
The modified gen p mean: 0.44801387190818787, gen p mean: 0.0, mean p set: 0.45401036739349365
loss_pred:0.02639351785182953, decouple_loss:0.009012952446937561
The modified gen p mean: 0.45000308752059937, gen p mean: 0.0, mean p set: 0.45200714468955994
loss_pred:0.026495812460780144, decouple_loss:0.009113484062254429
loss_pred:0.02761058136820793, decouple_loss:0.009306085295975208
Iteration: 2407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4656095802783966, gen p mean: 0.0, mean p set: 0.4531163275241852
The modified gen p mean: 0.468405544757843, gen p mean: 0.0, mean p set: 0.45440778136253357
The modified gen p mean: 0.4643334746360779, gen p mean: 0.0, mean p set: 0.45228859782218933
loss_pred:0.026833081617951393, decouple_loss:0.009351390413939953
loss_pred:0.026443740352988243, decouple_loss:0.008812468498945236
loss_pred:0.027397766709327698, decouple_loss:0.009175840765237808
Iteration: 2408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44320914149284363, gen p mean: 0.0, mean p set: 0.45439663529396057
The modified gen p mean: 0.44439753890037537, gen p mean: 0.0, mean p set: 0.4542265832424164
The modified gen p mean: 0.4463346302509308, gen p mean: 0.0, mean p set: 0.4516305923461914
loss_pred:0.02627691999077797, decouple_loss:0.00898428913205862
loss_pred:0.027029510587453842, decouple_loss:0.009125186130404472
loss_pred:0.028150228783488274, decouple_loss:0.008928332477807999
Iteration: 2409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4446447491645813, gen p mean: 0.0, mean p set: 0.45260608196258545
The modified gen p mean: 0.4467240571975708, gen p mean: 0.0, mean p set: 0.4513874351978302
The modified gen p mean: 0.44375675916671753, gen p mean: 0.0, mean p set: 0.45425722002983093
loss_pred:0.02782815881073475, decouple_loss:0.008976892568171024
loss_pred:0.02737572230398655, decouple_loss:0.009132549166679382
loss_pred:0.02695281431078911, decouple_loss:0.00939545501023531
Iteration: 2410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4622913897037506, gen p mean: 0.0, mean p set: 0.4542624056339264
The modified gen p mean: 0.4623391628265381, gen p mean: 0.0, mean p set: 0.45420005917549133
The modified gen p mean: 0.4590227007865906, gen p mean: 0.0, mean p set: 0.4538586437702179
loss_pred:0.028114253655076027, decouple_loss:0.008926894515752792
loss_pred:0.026180215179920197, decouple_loss:0.008435160852968693
loss_pred:0.02702823095023632, decouple_loss:0.008820530958473682
2023-05-03 06:32:35 testing...
The modified gen p mean: 0.4450039863586426, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4534006714820862, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4505140781402588, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.026555532589554787, decouple_loss:0.009871698915958405
loss_pred:0.0279587060213089, decouple_loss:0.010100126266479492
loss_pred:0.026860758662223816, decouple_loss:0.009836491197347641
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027621805667877197, avg_mse: 0.03288933262228966
current test mse: 0.032889
Iteration: 2411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4559935927391052, gen p mean: 0.0, mean p set: 0.45383843779563904
loss_pred:0.026889709755778313, decouple_loss:0.00884299911558628
The modified gen p mean: 0.4574649930000305, gen p mean: 0.0, mean p set: 0.452952116727829
loss_pred:0.0273919515311718, decouple_loss:0.009081990458071232
The modified gen p mean: 0.45559874176979065, gen p mean: 0.0, mean p set: 0.45317837595939636
loss_pred:0.0265020951628685, decouple_loss:0.009156803600490093
Iteration: 2412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831037521362305, gen p mean: 0.0, mean p set: 0.4537944197654724
The modified gen p mean: 0.44519689679145813, gen p mean: 0.0, mean p set: 0.45256906747817993
The modified gen p mean: 0.44785311818122864, gen p mean: 0.0, mean p set: 0.45406532287597656
loss_pred:0.0277789868414402, decouple_loss:0.009617333300411701
loss_pred:0.027717527002096176, decouple_loss:0.00963954534381628
loss_pred:0.02641214057803154, decouple_loss:0.009480247274041176
Iteration: 2413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4628187417984009, gen p mean: 0.0, mean p set: 0.45368504524230957
The modified gen p mean: 0.4661816358566284, gen p mean: 0.0, mean p set: 0.45263317227363586
The modified gen p mean: 0.4668801724910736, gen p mean: 0.0, mean p set: 0.4518945813179016
loss_pred:0.027657633647322655, decouple_loss:0.009779270738363266
loss_pred:0.026614513248205185, decouple_loss:0.009799574501812458
loss_pred:0.027363130822777748, decouple_loss:0.009562741033732891
Iteration: 2414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45510727167129517, gen p mean: 0.0, mean p set: 0.4535987377166748
The modified gen p mean: 0.458522766828537, gen p mean: 0.0, mean p set: 0.4544689953327179
The modified gen p mean: 0.45930975675582886, gen p mean: 0.0, mean p set: 0.4534760117530823
loss_pred:0.0265383068472147, decouple_loss:0.010424917563796043
loss_pred:0.026826830580830574, decouple_loss:0.010246912017464638
loss_pred:0.02683625929057598, decouple_loss:0.010116446763277054
Iteration: 2415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4351373016834259, gen p mean: 0.0, mean p set: 0.45306307077407837
The modified gen p mean: 0.43784859776496887, gen p mean: 0.0, mean p set: 0.4524872601032257
The modified gen p mean: 0.433881014585495, gen p mean: 0.0, mean p set: 0.4527394771575928
loss_pred:0.027209656313061714, decouple_loss:0.010358135215938091
loss_pred:0.026776615530252457, decouple_loss:0.01012602262198925
loss_pred:0.027298159897327423, decouple_loss:0.010099301114678383
Iteration: 2416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455254375934601, gen p mean: 0.0, mean p set: 0.4550575017929077
The modified gen p mean: 0.4464833736419678, gen p mean: 0.0, mean p set: 0.4534352123737335
The modified gen p mean: 0.44437986612319946, gen p mean: 0.0, mean p set: 0.45374566316604614
loss_pred:0.026192916557192802, decouple_loss:0.010284819640219212
loss_pred:0.02755451574921608, decouple_loss:0.00973033532500267
loss_pred:0.02695799618959427, decouple_loss:0.010190192610025406
Iteration: 2417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4653070271015167, gen p mean: 0.0, mean p set: 0.45261943340301514
The modified gen p mean: 0.4676535129547119, gen p mean: 0.0, mean p set: 0.45378226041793823
The modified gen p mean: 0.4676418602466583, gen p mean: 0.0, mean p set: 0.45264583826065063
loss_pred:0.027274053543806076, decouple_loss:0.010394149459898472
loss_pred:0.026630500331521034, decouple_loss:0.010211807675659657
loss_pred:0.02652924321591854, decouple_loss:0.010000007227063179
Iteration: 2418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45967134833335876, gen p mean: 0.0, mean p set: 0.45210132002830505
The modified gen p mean: 0.46018412709236145, gen p mean: 0.0, mean p set: 0.45464229583740234
The modified gen p mean: 0.45958006381988525, gen p mean: 0.0, mean p set: 0.4526006579399109
loss_pred:0.027107158675789833, decouple_loss:0.010312594473361969
loss_pred:0.02644919604063034, decouple_loss:0.010271565057337284
loss_pred:0.027264229953289032, decouple_loss:0.010197741910815239
Iteration: 2419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475962519645691, gen p mean: 0.0, mean p set: 0.45290088653564453
The modified gen p mean: 0.44562649726867676, gen p mean: 0.0, mean p set: 0.45427173376083374
The modified gen p mean: 0.44670313596725464, gen p mean: 0.0, mean p set: 0.4531364440917969
loss_pred:0.027463773265480995, decouple_loss:0.010358775034546852
loss_pred:0.02625250071287155, decouple_loss:0.010515891946852207
loss_pred:0.027610423043370247, decouple_loss:0.010460161603987217
Iteration: 2420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457167088985443, gen p mean: 0.0, mean p set: 0.4547651410102844
The modified gen p mean: 0.447564035654068, gen p mean: 0.0, mean p set: 0.45476964116096497
The modified gen p mean: 0.44767633080482483, gen p mean: 0.0, mean p set: 0.4528234302997589
loss_pred:0.026488633826375008, decouple_loss:0.010200274176895618
loss_pred:0.02652108296751976, decouple_loss:0.009761014021933079
loss_pred:0.027155892923474312, decouple_loss:0.009783352725207806
2023-05-03 06:36:15 testing...
The modified gen p mean: 0.445847749710083, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4539165496826172, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4511922299861908, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.028099223971366882, decouple_loss:0.010927246883511543
loss_pred:0.02666766196489334, decouple_loss:0.010721263475716114
loss_pred:0.02700301818549633, decouple_loss:0.010694073513150215
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02779567800462246, avg_mse: 0.033045411109924316
current test mse: 0.033045
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
NaN value num: 0
Iteration: 2421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519875645637512, gen p mean: 0.0, mean p set: 0.44839873909950256
The modified gen p mean: 0.4474233090877533, gen p mean: 0.0, mean p set: 0.447712779045105
loss_pred:0.028273770585656166, decouple_loss:0.010828045196831226
loss_pred:0.027437465265393257, decouple_loss:0.01115204207599163
The modified gen p mean: 0.45174527168273926, gen p mean: 0.0, mean p set: 0.4483359158039093
loss_pred:0.027033919468522072, decouple_loss:0.011076115071773529
Iteration: 2422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472767114639282, gen p mean: 0.0, mean p set: 0.44781461358070374
The modified gen p mean: 0.4474204182624817, gen p mean: 0.0, mean p set: 0.4487583637237549
The modified gen p mean: 0.44363078474998474, gen p mean: 0.0, mean p set: 0.4482678174972534
loss_pred:0.027976984158158302, decouple_loss:0.01052883267402649
loss_pred:0.027727633714675903, decouple_loss:0.010518519207835197
loss_pred:0.027065319940447807, decouple_loss:0.010859128087759018
Iteration: 2423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519447982311249, gen p mean: 0.0, mean p set: 0.44848933815956116
The modified gen p mean: 0.4511510729789734, gen p mean: 0.0, mean p set: 0.4484493136405945
The modified gen p mean: 0.4500191807746887, gen p mean: 0.0, mean p set: 0.447892427444458
loss_pred:0.026660531759262085, decouple_loss:0.010477583855390549
loss_pred:0.02664705365896225, decouple_loss:0.010389546863734722
loss_pred:0.027951089665293694, decouple_loss:0.010084280744194984
Iteration: 2424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448716402053833, gen p mean: 0.0, mean p set: 0.448335200548172
The modified gen p mean: 0.4512954354286194, gen p mean: 0.0, mean p set: 0.4485422670841217
The modified gen p mean: 0.44872546195983887, gen p mean: 0.0, mean p set: 0.44864511489868164
loss_pred:0.025860754773020744, decouple_loss:0.010033056139945984
loss_pred:0.026724712923169136, decouple_loss:0.01014595478773117
loss_pred:0.02679656445980072, decouple_loss:0.010055049322545528
Iteration: 2425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756677746772766, gen p mean: 0.0, mean p set: 0.4490111172199249
The modified gen p mean: 0.4448203146457672, gen p mean: 0.0, mean p set: 0.44810402393341064
The modified gen p mean: 0.4447556436061859, gen p mean: 0.0, mean p set: 0.4492388963699341
loss_pred:0.02612227201461792, decouple_loss:0.009910537861287594
loss_pred:0.026200512424111366, decouple_loss:0.010103739798069
loss_pred:0.026609601452946663, decouple_loss:0.009903962723910809
Iteration: 2426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4441116154193878, gen p mean: 0.0, mean p set: 0.4478394687175751
The modified gen p mean: 0.44266277551651, gen p mean: 0.0, mean p set: 0.4483374059200287
The modified gen p mean: 0.44827795028686523, gen p mean: 0.0, mean p set: 0.44823122024536133
loss_pred:0.027634045109152794, decouple_loss:0.010213719680905342
loss_pred:0.025938615202903748, decouple_loss:0.010053986683487892
loss_pred:0.027220306918025017, decouple_loss:0.010056361556053162
Iteration: 2427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008721947669983, gen p mean: 0.0, mean p set: 0.4470512866973877
The modified gen p mean: 0.4487515389919281, gen p mean: 0.0, mean p set: 0.44831880927085876
The modified gen p mean: 0.4516202509403229, gen p mean: 0.0, mean p set: 0.44664737582206726
loss_pred:0.027485648170113564, decouple_loss:0.010415618307888508
loss_pred:0.026927288621664047, decouple_loss:0.010166794992983341
loss_pred:0.027503466233611107, decouple_loss:0.010574542917311192
Iteration: 2428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469476640224457, gen p mean: 0.0, mean p set: 0.44870471954345703
The modified gen p mean: 0.44434234499931335, gen p mean: 0.0, mean p set: 0.4475124180316925
The modified gen p mean: 0.44763684272766113, gen p mean: 0.0, mean p set: 0.44845762848854065
loss_pred:0.026755118742585182, decouple_loss:0.010229668579995632
loss_pred:0.026883432641625404, decouple_loss:0.010199110023677349
loss_pred:0.025722021237015724, decouple_loss:0.010234540328383446
Iteration: 2429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4437926113605499, gen p mean: 0.0, mean p set: 0.4488029479980469
The modified gen p mean: 0.44443410634994507, gen p mean: 0.0, mean p set: 0.4484356641769409
The modified gen p mean: 0.4472443461418152, gen p mean: 0.0, mean p set: 0.44938814640045166
loss_pred:0.026033006608486176, decouple_loss:0.009924602694809437
loss_pred:0.027726173400878906, decouple_loss:0.009797698818147182
loss_pred:0.02763015776872635, decouple_loss:0.009797034785151482
Iteration: 2430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45530086755752563, gen p mean: 0.0, mean p set: 0.44740280508995056
The modified gen p mean: 0.45809152722358704, gen p mean: 0.0, mean p set: 0.4489271342754364
The modified gen p mean: 0.45418474078178406, gen p mean: 0.0, mean p set: 0.4481017291545868
loss_pred:0.026770522817969322, decouple_loss:0.009362136013805866
loss_pred:0.025893984362483025, decouple_loss:0.009581757709383965
loss_pred:0.026438245549798012, decouple_loss:0.00952119193971157
2023-05-03 06:40:39 testing...
The modified gen p mean: 0.450074166059494, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4446541368961334, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4529748558998108, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026643870398402214, decouple_loss:0.009522911161184311
loss_pred:0.027594277635216713, decouple_loss:0.00970663595944643
loss_pred:0.026232197880744934, decouple_loss:0.009523558430373669
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027302667498588562, avg_mse: 0.03233508765697479
current test mse: 0.032335
Iteration: 2431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488373398780823, gen p mean: 0.0, mean p set: 0.4483935534954071
The modified gen p mean: 0.4515085816383362, gen p mean: 0.0, mean p set: 0.44724538922309875
loss_pred:0.02593560330569744, decouple_loss:0.009295118041336536
loss_pred:0.02730146050453186, decouple_loss:0.009085044264793396
The modified gen p mean: 0.44811442494392395, gen p mean: 0.0, mean p set: 0.4486865699291229
loss_pred:0.026685824617743492, decouple_loss:0.009314618073403835
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43546780943870544, gen p mean: 0.0, mean p set: 0.4479339122772217
The modified gen p mean: 0.43689948320388794, gen p mean: 0.0, mean p set: 0.44748347997665405
The modified gen p mean: 0.4400666356086731, gen p mean: 0.0, mean p set: 0.44871973991394043
loss_pred:0.02699710614979267, decouple_loss:0.009472335688769817
loss_pred:0.02671026811003685, decouple_loss:0.009543264284729958
loss_pred:0.02651846408843994, decouple_loss:0.009525098837912083
Iteration: 2433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469412863254547, gen p mean: 0.0, mean p set: 0.44936102628707886
The modified gen p mean: 0.45382511615753174, gen p mean: 0.0, mean p set: 0.4479440450668335
The modified gen p mean: 0.45031917095184326, gen p mean: 0.0, mean p set: 0.44878846406936646
loss_pred:0.025708284229040146, decouple_loss:0.010012133978307247
loss_pred:0.026680486276745796, decouple_loss:0.009575800970196724
loss_pred:0.02598361112177372, decouple_loss:0.009301643818616867
Iteration: 2434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45489493012428284, gen p mean: 0.0, mean p set: 0.4482938349246979
The modified gen p mean: 0.4575948119163513, gen p mean: 0.0, mean p set: 0.44857192039489746
The modified gen p mean: 0.4538566470146179, gen p mean: 0.0, mean p set: 0.44800689816474915
loss_pred:0.026797596365213394, decouple_loss:0.0093918452039361
loss_pred:0.027392765507102013, decouple_loss:0.009556940756738186
loss_pred:0.02631724625825882, decouple_loss:0.009447540156543255
Iteration: 2435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45200955867767334, gen p mean: 0.0, mean p set: 0.4478871822357178
The modified gen p mean: 0.44847503304481506, gen p mean: 0.0, mean p set: 0.4485013484954834
The modified gen p mean: 0.4510778784751892, gen p mean: 0.0, mean p set: 0.44872552156448364
loss_pred:0.02745741605758667, decouple_loss:0.009056420996785164
loss_pred:0.02639884129166603, decouple_loss:0.009498571045696735
loss_pred:0.027189839631319046, decouple_loss:0.009364096447825432
Iteration: 2436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4426687955856323, gen p mean: 0.0, mean p set: 0.44829073548316956
The modified gen p mean: 0.44418811798095703, gen p mean: 0.0, mean p set: 0.44685330986976624
The modified gen p mean: 0.44204363226890564, gen p mean: 0.0, mean p set: 0.448603093624115
loss_pred:0.027155801653862, decouple_loss:0.008669496513903141
loss_pred:0.026796335354447365, decouple_loss:0.00880642794072628
loss_pred:0.026393946260213852, decouple_loss:0.008956864476203918
Iteration: 2437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44235414266586304, gen p mean: 0.0, mean p set: 0.44911372661590576
The modified gen p mean: 0.4469386339187622, gen p mean: 0.0, mean p set: 0.44864311814308167
The modified gen p mean: 0.44131937623023987, gen p mean: 0.0, mean p set: 0.44920313358306885
loss_pred:0.025876356288790703, decouple_loss:0.008905968628823757
loss_pred:0.02611507661640644, decouple_loss:0.008885265327990055
loss_pred:0.025762101635336876, decouple_loss:0.008831962011754513
Iteration: 2438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44994673132896423, gen p mean: 0.0, mean p set: 0.44927188754081726
The modified gen p mean: 0.44926679134368896, gen p mean: 0.0, mean p set: 0.4492678940296173
The modified gen p mean: 0.4531552195549011, gen p mean: 0.0, mean p set: 0.44869464635849
loss_pred:0.026093631982803345, decouple_loss:0.00868250709027052
loss_pred:0.025934604927897453, decouple_loss:0.008801104500889778
loss_pred:0.026494964957237244, decouple_loss:0.008848773315548897
Iteration: 2439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492219388484955, gen p mean: 0.0, mean p set: 0.4485968351364136
The modified gen p mean: 0.4552701711654663, gen p mean: 0.0, mean p set: 0.4483031630516052
The modified gen p mean: 0.45230209827423096, gen p mean: 0.0, mean p set: 0.44831034541130066
loss_pred:0.025560544803738594, decouple_loss:0.009183616377413273
loss_pred:0.026874324306845665, decouple_loss:0.008625109679996967
loss_pred:0.027356890961527824, decouple_loss:0.008870843797922134
Iteration: 2440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477667808532715, gen p mean: 0.0, mean p set: 0.44850432872772217
The modified gen p mean: 0.4462515711784363, gen p mean: 0.0, mean p set: 0.4477825164794922
The modified gen p mean: 0.4472644329071045, gen p mean: 0.0, mean p set: 0.44858577847480774
loss_pred:0.02595558762550354, decouple_loss:0.008920654654502869
loss_pred:0.026749487966299057, decouple_loss:0.00903137493878603
loss_pred:0.026090528815984726, decouple_loss:0.00903498474508524
2023-05-03 06:44:20 testing...
The modified gen p mean: 0.4435179829597473, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45195356011390686, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.44904303550720215, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.027405891567468643, decouple_loss:0.00891143549233675
loss_pred:0.026172151789069176, decouple_loss:0.008795446716248989
loss_pred:0.026420248672366142, decouple_loss:0.008779536932706833
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027107536792755127, avg_mse: 0.032153237611055374
current test mse: 0.032153
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
NaN value num: 0
Iteration: 2441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4560724198818207, gen p mean: 0.0, mean p set: 0.44860953092575073
The modified gen p mean: 0.4536776840686798, gen p mean: 0.0, mean p set: 0.44904738664627075
loss_pred:0.026147618889808655, decouple_loss:0.010520632378757
loss_pred:0.026533817872405052, decouple_loss:0.009686063975095749
The modified gen p mean: 0.45456749200820923, gen p mean: 0.0, mean p set: 0.4507155418395996
loss_pred:0.02524613030254841, decouple_loss:0.010063756257295609
Iteration: 2442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041680335998535, gen p mean: 0.0, mean p set: 0.4494599997997284
The modified gen p mean: 0.44531694054603577, gen p mean: 0.0, mean p set: 0.4488237500190735
The modified gen p mean: 0.44955453276634216, gen p mean: 0.0, mean p set: 0.4506658911705017
loss_pred:0.026288868859410286, decouple_loss:0.00959746353328228
loss_pred:0.02643926627933979, decouple_loss:0.009739791974425316
loss_pred:0.026282059028744698, decouple_loss:0.009994037449359894
Iteration: 2443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4425935447216034, gen p mean: 0.0, mean p set: 0.45086273550987244
The modified gen p mean: 0.44359323382377625, gen p mean: 0.0, mean p set: 0.4492228329181671
The modified gen p mean: 0.44466856122016907, gen p mean: 0.0, mean p set: 0.4497472941875458
loss_pred:0.02670719474554062, decouple_loss:0.009672019630670547
loss_pred:0.026728717610239983, decouple_loss:0.009707770310342312
loss_pred:0.026362866163253784, decouple_loss:0.009298305958509445
Iteration: 2444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922536611557007, gen p mean: 0.0, mean p set: 0.4488722085952759
The modified gen p mean: 0.44363459944725037, gen p mean: 0.0, mean p set: 0.4492338001728058
The modified gen p mean: 0.4475908875465393, gen p mean: 0.0, mean p set: 0.44780394434928894
loss_pred:0.025859525427222252, decouple_loss:0.009331502951681614
loss_pred:0.02631944604218006, decouple_loss:0.009400499053299427
loss_pred:0.02591307833790779, decouple_loss:0.009509355761110783
Iteration: 2445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44601234793663025, gen p mean: 0.0, mean p set: 0.4484439492225647
The modified gen p mean: 0.4527375400066376, gen p mean: 0.0, mean p set: 0.44999319314956665
The modified gen p mean: 0.45110276341438293, gen p mean: 0.0, mean p set: 0.44994959235191345
loss_pred:0.026072870939970016, decouple_loss:0.009244135580956936
loss_pred:0.026164064183831215, decouple_loss:0.009078572504222393
loss_pred:0.02652951329946518, decouple_loss:0.009258665144443512
Iteration: 2446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45682546496391296, gen p mean: 0.0, mean p set: 0.4499356150627136
The modified gen p mean: 0.453372985124588, gen p mean: 0.0, mean p set: 0.4506763517856598
loss_pred:0.02551993913948536, decouple_loss:0.009100601077079773
The modified gen p mean: 0.45263004302978516, gen p mean: 0.0, mean p set: 0.4514385461807251
loss_pred:0.026034334674477577, decouple_loss:0.009029985405504704
loss_pred:0.026689164340496063, decouple_loss:0.009256877936422825
Iteration: 2447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4448976516723633, gen p mean: 0.0, mean p set: 0.4495784640312195
The modified gen p mean: 0.441200315952301, gen p mean: 0.0, mean p set: 0.44984734058380127
The modified gen p mean: 0.4477105140686035, gen p mean: 0.0, mean p set: 0.4505022168159485
loss_pred:0.026247991248965263, decouple_loss:0.0089401975274086
loss_pred:0.026613006368279457, decouple_loss:0.00905112735927105
loss_pred:0.02644985169172287, decouple_loss:0.00948665477335453
Iteration: 2448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44561314582824707, gen p mean: 0.0, mean p set: 0.4498175084590912
The modified gen p mean: 0.447866290807724, gen p mean: 0.0, mean p set: 0.44999101758003235
The modified gen p mean: 0.4508211612701416, gen p mean: 0.0, mean p set: 0.45064541697502136
loss_pred:0.026348380371928215, decouple_loss:0.009488839656114578
loss_pred:0.026164254173636436, decouple_loss:0.00865943729877472
loss_pred:0.026132814586162567, decouple_loss:0.008922389708459377
Iteration: 2449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4563380181789398, gen p mean: 0.0, mean p set: 0.4491414725780487
The modified gen p mean: 0.45472756028175354, gen p mean: 0.0, mean p set: 0.4481392800807953
The modified gen p mean: 0.45368099212646484, gen p mean: 0.0, mean p set: 0.45078325271606445
loss_pred:0.026482025161385536, decouple_loss:0.009261026047170162
loss_pred:0.025590727105736732, decouple_loss:0.009232361800968647
loss_pred:0.026012351736426353, decouple_loss:0.009196602739393711
Iteration: 2450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720014929771423, gen p mean: 0.0, mean p set: 0.44827306270599365
The modified gen p mean: 0.44624796509742737, gen p mean: 0.0, mean p set: 0.4493105113506317
The modified gen p mean: 0.44342026114463806, gen p mean: 0.0, mean p set: 0.4490853548049927
loss_pred:0.025994254276156425, decouple_loss:0.00931931845843792
loss_pred:0.026197262108325958, decouple_loss:0.00865884032100439
loss_pred:0.025850240141153336, decouple_loss:0.009169516153633595
2023-05-03 06:48:41 testing...
The modified gen p mean: 0.43975064158439636, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44505035877227783, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4478570818901062, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02758754976093769, decouple_loss:0.009709331206977367
loss_pred:0.026552053168416023, decouple_loss:0.009502917528152466
loss_pred:0.02613675408065319, decouple_loss:0.009527070447802544
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027237772941589355, avg_mse: 0.03229245916008949
current test mse: 0.032292
Iteration: 2451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499964714050293, gen p mean: 0.0, mean p set: 0.4505808651447296
The modified gen p mean: 0.44868311285972595, gen p mean: 0.0, mean p set: 0.44983452558517456
loss_pred:0.02609650045633316, decouple_loss:0.009073624387383461
loss_pred:0.025897055864334106, decouple_loss:0.009060671553015709
The modified gen p mean: 0.4443937838077545, gen p mean: 0.0, mean p set: 0.4497326612472534
loss_pred:0.027015836909413338, decouple_loss:0.009141070768237114
Iteration: 2452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529254734516144, gen p mean: 0.0, mean p set: 0.4488454759120941
The modified gen p mean: 0.4564826488494873, gen p mean: 0.0, mean p set: 0.4509481191635132
The modified gen p mean: 0.45723381638526917, gen p mean: 0.0, mean p set: 0.4504702091217041
loss_pred:0.02609274536371231, decouple_loss:0.008817515335977077
loss_pred:0.025963690131902695, decouple_loss:0.008789222687482834
loss_pred:0.02609061449766159, decouple_loss:0.009012537077069283
Iteration: 2453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446907639503479, gen p mean: 0.0, mean p set: 0.45093539357185364
The modified gen p mean: 0.4486968219280243, gen p mean: 0.0, mean p set: 0.4499700367450714
The modified gen p mean: 0.4482991099357605, gen p mean: 0.0, mean p set: 0.45121368765830994
loss_pred:0.02689736895263195, decouple_loss:0.00900983065366745
loss_pred:0.026174219325184822, decouple_loss:0.008735081180930138
loss_pred:0.02419925108551979, decouple_loss:0.00869207363575697
Iteration: 2454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468391537666321, gen p mean: 0.0, mean p set: 0.45137009024620056
The modified gen p mean: 0.4464413821697235, gen p mean: 0.0, mean p set: 0.44887450337409973
The modified gen p mean: 0.4446268379688263, gen p mean: 0.0, mean p set: 0.45098215341567993
loss_pred:0.023582497611641884, decouple_loss:0.008703051134943962
loss_pred:0.02499854564666748, decouple_loss:0.008614457212388515
loss_pred:0.026511533185839653, decouple_loss:0.008732528425753117
Iteration: 2455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45433980226516724, gen p mean: 0.0, mean p set: 0.45167189836502075
The modified gen p mean: 0.45311039686203003, gen p mean: 0.0, mean p set: 0.44921573996543884
The modified gen p mean: 0.45249730348587036, gen p mean: 0.0, mean p set: 0.45034751296043396
loss_pred:0.024250773712992668, decouple_loss:0.008597888052463531
loss_pred:0.025503698736429214, decouple_loss:0.008859829977154732
loss_pred:0.02677842043340206, decouple_loss:0.00870126485824585
Iteration: 2456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516781270503998, gen p mean: 0.0, mean p set: 0.44889989495277405
The modified gen p mean: 0.45288988947868347, gen p mean: 0.0, mean p set: 0.4492644667625427
The modified gen p mean: 0.453711599111557, gen p mean: 0.0, mean p set: 0.44899222254753113
loss_pred:0.02576613239943981, decouple_loss:0.00849070493131876
loss_pred:0.02545010671019554, decouple_loss:0.008810917846858501
loss_pred:0.02460661716759205, decouple_loss:0.008372314274311066
Iteration: 2457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462749660015106, gen p mean: 0.0, mean p set: 0.4505395293235779
The modified gen p mean: 0.44587257504463196, gen p mean: 0.0, mean p set: 0.45048466324806213
The modified gen p mean: 0.4426356554031372, gen p mean: 0.0, mean p set: 0.44936615228652954
loss_pred:0.027004586532711983, decouple_loss:0.009105908684432507
loss_pred:0.025802625343203545, decouple_loss:0.008444487117230892
loss_pred:0.025595033541321754, decouple_loss:0.008443226106464863
Iteration: 2458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4433278441429138, gen p mean: 0.0, mean p set: 0.44876495003700256
The modified gen p mean: 0.44652751088142395, gen p mean: 0.0, mean p set: 0.4505380690097809
The modified gen p mean: 0.44586166739463806, gen p mean: 0.0, mean p set: 0.4509085714817047
loss_pred:0.025399884209036827, decouple_loss:0.008502466604113579
loss_pred:0.025222254917025566, decouple_loss:0.00852806307375431
loss_pred:0.025876490399241447, decouple_loss:0.008666296489536762
Iteration: 2459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45287567377090454, gen p mean: 0.0, mean p set: 0.44861045479774475
The modified gen p mean: 0.45324164628982544, gen p mean: 0.0, mean p set: 0.44903048872947693
The modified gen p mean: 0.4602404832839966, gen p mean: 0.0, mean p set: 0.44955530762672424
loss_pred:0.025989025831222534, decouple_loss:0.008570551872253418
loss_pred:0.02578791417181492, decouple_loss:0.00862868968397379
loss_pred:0.025355136021971703, decouple_loss:0.008543831296265125
Iteration: 2460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44403600692749023, gen p mean: 0.0, mean p set: 0.44978684186935425
The modified gen p mean: 0.44608911871910095, gen p mean: 0.0, mean p set: 0.4496622681617737
The modified gen p mean: 0.4456831216812134, gen p mean: 0.0, mean p set: 0.450225830078125
loss_pred:0.02560051716864109, decouple_loss:0.008972277864813805
loss_pred:0.025410868227481842, decouple_loss:0.008580517023801804
loss_pred:0.027338720858097076, decouple_loss:0.008837960660457611
2023-05-03 06:52:23 testing...
The modified gen p mean: 0.4432101249694824, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4375535845756531, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44645264744758606, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026462005451321602, decouple_loss:0.009225067682564259
loss_pred:0.027527563273906708, decouple_loss:0.009531056508421898
loss_pred:0.02612619288265705, decouple_loss:0.009420635178685188
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027174867689609528, avg_mse: 0.032258544117212296
current test mse: 0.032259
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
NaN value num: 0
Iteration: 2461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44332218170166016, gen p mean: 0.0, mean p set: 0.4498359262943268
The modified gen p mean: 0.4476148188114166, gen p mean: 0.0, mean p set: 0.45061564445495605
loss_pred:0.026614617556333542, decouple_loss:0.00901617482304573
loss_pred:0.02574077621102333, decouple_loss:0.008320546709001064
The modified gen p mean: 0.44509831070899963, gen p mean: 0.0, mean p set: 0.4502233564853668
loss_pred:0.026381555944681168, decouple_loss:0.008244732394814491
Iteration: 2462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46011584997177124, gen p mean: 0.0, mean p set: 0.4528670310974121
The modified gen p mean: 0.46182429790496826, gen p mean: 0.0, mean p set: 0.4503673017024994
The modified gen p mean: 0.458554744720459, gen p mean: 0.0, mean p set: 0.44922199845314026
loss_pred:0.02583427168428898, decouple_loss:0.00922391563653946
loss_pred:0.02566635236144066, decouple_loss:0.008174784481525421
loss_pred:0.02645650878548622, decouple_loss:0.008555135689675808
Iteration: 2463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45238804817199707, gen p mean: 0.0, mean p set: 0.4493563175201416
The modified gen p mean: 0.45306453108787537, gen p mean: 0.0, mean p set: 0.44989991188049316
The modified gen p mean: 0.4484460949897766, gen p mean: 0.0, mean p set: 0.450061172246933
loss_pred:0.027208413928747177, decouple_loss:0.00864811148494482
loss_pred:0.02650815062224865, decouple_loss:0.008585956878960133
loss_pred:0.027646763250231743, decouple_loss:0.008642151951789856
Iteration: 2464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43669113516807556, gen p mean: 0.0, mean p set: 0.4495299756526947
The modified gen p mean: 0.434029757976532, gen p mean: 0.0, mean p set: 0.4505075514316559
The modified gen p mean: 0.438706636428833, gen p mean: 0.0, mean p set: 0.45193424820899963
loss_pred:0.02702849917113781, decouple_loss:0.008553501218557358
loss_pred:0.02776988409459591, decouple_loss:0.008740570396184921
loss_pred:0.027062274515628815, decouple_loss:0.008837427012622356
Iteration: 2465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45499542355537415, gen p mean: 0.0, mean p set: 0.45068490505218506
The modified gen p mean: 0.4533623158931732, gen p mean: 0.0, mean p set: 0.4519580006599426
The modified gen p mean: 0.4512748122215271, gen p mean: 0.0, mean p set: 0.4486272633075714
loss_pred:0.026593118906021118, decouple_loss:0.008591292425990105
loss_pred:0.026513900607824326, decouple_loss:0.00886455737054348
loss_pred:0.026464764028787613, decouple_loss:0.008556414395570755
Iteration: 2466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46198171377182007, gen p mean: 0.0, mean p set: 0.45213228464126587
The modified gen p mean: 0.46533679962158203, gen p mean: 0.0, mean p set: 0.4501486122608185
The modified gen p mean: 0.4654487669467926, gen p mean: 0.0, mean p set: 0.44973790645599365
loss_pred:0.02592475712299347, decouple_loss:0.008913074620068073
loss_pred:0.026389652863144875, decouple_loss:0.008200408890843391
loss_pred:0.025708861649036407, decouple_loss:0.00793030858039856
Iteration: 2467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4428381621837616, gen p mean: 0.0, mean p set: 0.4508603513240814
The modified gen p mean: 0.4444493353366852, gen p mean: 0.0, mean p set: 0.44979190826416016
The modified gen p mean: 0.44607114791870117, gen p mean: 0.0, mean p set: 0.45137903094291687
loss_pred:0.026982050389051437, decouple_loss:0.008224672637879848
loss_pred:0.026664987206459045, decouple_loss:0.00822424329817295
loss_pred:0.026975510641932487, decouple_loss:0.008354833349585533
Iteration: 2468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43786898255348206, gen p mean: 0.0, mean p set: 0.45088836550712585
The modified gen p mean: 0.4403912425041199, gen p mean: 0.0, mean p set: 0.45104068517684937
The modified gen p mean: 0.44184303283691406, gen p mean: 0.0, mean p set: 0.4490962028503418
loss_pred:0.026175471022725105, decouple_loss:0.008492665365338326
loss_pred:0.026161065325140953, decouple_loss:0.008050507865846157
loss_pred:0.026261597871780396, decouple_loss:0.008031277917325497
Iteration: 2469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45578327775001526, gen p mean: 0.0, mean p set: 0.4496554732322693
The modified gen p mean: 0.4586607813835144, gen p mean: 0.0, mean p set: 0.4514475464820862
The modified gen p mean: 0.4500774145126343, gen p mean: 0.0, mean p set: 0.4513118267059326
loss_pred:0.026271244511008263, decouple_loss:0.0079925786703825
loss_pred:0.02668008580803871, decouple_loss:0.008318417705595493
loss_pred:0.02576605975627899, decouple_loss:0.008278540335595608
Iteration: 2470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45061030983924866, gen p mean: 0.0, mean p set: 0.45085835456848145
The modified gen p mean: 0.45335355401039124, gen p mean: 0.0, mean p set: 0.45169559121131897
The modified gen p mean: 0.45148777961730957, gen p mean: 0.0, mean p set: 0.45221027731895447
loss_pred:0.02638084441423416, decouple_loss:0.008801950141787529
loss_pred:0.027010031044483185, decouple_loss:0.00863565132021904
loss_pred:0.026084987446665764, decouple_loss:0.008647103793919086
2023-05-03 06:56:41 testing...
The modified gen p mean: 0.44336575269699097, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45222458243370056, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4490855932235718, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02740377001464367, decouple_loss:0.009347492828965187
loss_pred:0.026071319356560707, decouple_loss:0.009255661629140377
loss_pred:0.026372194290161133, decouple_loss:0.009043507277965546
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027076540514826775, avg_mse: 0.03215434029698372
current test mse: 0.032154
Iteration: 2471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733911752700806, gen p mean: 0.0, mean p set: 0.4490193724632263
The modified gen p mean: 0.4516710638999939, gen p mean: 0.0, mean p set: 0.4524524509906769
loss_pred:0.02547011338174343, decouple_loss:0.008420752361416817
loss_pred:0.02507300302386284, decouple_loss:0.00849241390824318
The modified gen p mean: 0.45316436886787415, gen p mean: 0.0, mean p set: 0.45071205496788025
loss_pred:0.026006463915109634, decouple_loss:0.008263926953077316
Iteration: 2472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4549638032913208, gen p mean: 0.0, mean p set: 0.44957631826400757
The modified gen p mean: 0.4578189253807068, gen p mean: 0.0, mean p set: 0.4503108859062195
The modified gen p mean: 0.45458072423934937, gen p mean: 0.0, mean p set: 0.44998228549957275
loss_pred:0.026385469362139702, decouple_loss:0.008856994099915028
loss_pred:0.026431847363710403, decouple_loss:0.008146537467837334
loss_pred:0.026442935690283775, decouple_loss:0.008588760159909725
Iteration: 2473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669750332832336, gen p mean: 0.0, mean p set: 0.4508640468120575
The modified gen p mean: 0.44646063446998596, gen p mean: 0.0, mean p set: 0.45002463459968567
The modified gen p mean: 0.44544848799705505, gen p mean: 0.0, mean p set: 0.44917601346969604
loss_pred:0.0264445673674345, decouple_loss:0.007959732785820961
loss_pred:0.02579200454056263, decouple_loss:0.008157222531735897
loss_pred:0.026187049224972725, decouple_loss:0.007948312908411026
Iteration: 2474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558486342430115, gen p mean: 0.0, mean p set: 0.4537885785102844
The modified gen p mean: 0.4467160105705261, gen p mean: 0.0, mean p set: 0.4502647817134857
The modified gen p mean: 0.4460132420063019, gen p mean: 0.0, mean p set: 0.45067617297172546
loss_pred:0.024673843756318092, decouple_loss:0.00815978180617094
loss_pred:0.026347056031227112, decouple_loss:0.007659008726477623
loss_pred:0.025334807112812996, decouple_loss:0.00792722124606371
Iteration: 2475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45246878266334534, gen p mean: 0.0, mean p set: 0.4507634937763214
The modified gen p mean: 0.4492408037185669, gen p mean: 0.0, mean p set: 0.4527532756328583
The modified gen p mean: 0.4494011104106903, gen p mean: 0.0, mean p set: 0.4530515968799591
loss_pred:0.026603790000081062, decouple_loss:0.00832494255155325
loss_pred:0.02641270123422146, decouple_loss:0.008417010307312012
loss_pred:0.026072727516293526, decouple_loss:0.008286363445222378
Iteration: 2476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504222571849823, gen p mean: 0.0, mean p set: 0.4499586224555969
The modified gen p mean: 0.4528267979621887, gen p mean: 0.0, mean p set: 0.45047301054000854
The modified gen p mean: 0.4510968029499054, gen p mean: 0.0, mean p set: 0.4505055248737335
loss_pred:0.026256263256072998, decouple_loss:0.008467432111501694
loss_pred:0.027182824909687042, decouple_loss:0.008840383030474186
loss_pred:0.026202905923128128, decouple_loss:0.008288058452308178
Iteration: 2477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4555470049381256, gen p mean: 0.0, mean p set: 0.4526490569114685
The modified gen p mean: 0.4566662311553955, gen p mean: 0.0, mean p set: 0.45301464200019836
The modified gen p mean: 0.45839500427246094, gen p mean: 0.0, mean p set: 0.44999533891677856
loss_pred:0.02543571963906288, decouple_loss:0.00803014449775219
loss_pred:0.025852179154753685, decouple_loss:0.008806092664599419
loss_pred:0.026468191295862198, decouple_loss:0.008119641803205013
Iteration: 2478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44573795795440674, gen p mean: 0.0, mean p set: 0.4506552517414093
The modified gen p mean: 0.45034050941467285, gen p mean: 0.0, mean p set: 0.45078805088996887
The modified gen p mean: 0.4487551748752594, gen p mean: 0.0, mean p set: 0.4507381319999695
loss_pred:0.027332473546266556, decouple_loss:0.00857643224298954
loss_pred:0.02644740231335163, decouple_loss:0.008047218434512615
loss_pred:0.026031050831079483, decouple_loss:0.008215841837227345
Iteration: 2479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4399740695953369, gen p mean: 0.0, mean p set: 0.450395405292511
The modified gen p mean: 0.4448007047176361, gen p mean: 0.0, mean p set: 0.4529832601547241
The modified gen p mean: 0.44311442971229553, gen p mean: 0.0, mean p set: 0.4504907429218292
loss_pred:0.025236671790480614, decouple_loss:0.008405639789998531
loss_pred:0.02472715824842453, decouple_loss:0.00792645663022995
loss_pred:0.0272155050188303, decouple_loss:0.008327540941536427
Iteration: 2480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45765548944473267, gen p mean: 0.0, mean p set: 0.4503227472305298
The modified gen p mean: 0.4570448100566864, gen p mean: 0.0, mean p set: 0.44996383786201477
The modified gen p mean: 0.455802857875824, gen p mean: 0.0, mean p set: 0.4497922658920288
loss_pred:0.026336248964071274, decouple_loss:0.007857048884034157
loss_pred:0.02700633928179741, decouple_loss:0.008020760491490364
loss_pred:0.026489632204174995, decouple_loss:0.008137019351124763
2023-05-03 07:00:23 testing...
The modified gen p mean: 0.45083582401275635, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4590867757797241, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.45623764395713806, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02751195803284645, decouple_loss:0.008963537402451038
loss_pred:0.02613045461475849, decouple_loss:0.008869403973221779
loss_pred:0.02641204744577408, decouple_loss:0.00865184422582388
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027126234024763107, avg_mse: 0.03227803111076355
current test mse: 0.032278
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
NaN value num: 0
Iteration: 2481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4608427584171295, gen p mean: 0.0, mean p set: 0.44944292306900024
loss_pred:0.0255801510065794, decouple_loss:0.008522887714207172
The modified gen p mean: 0.4623003900051117, gen p mean: 0.0, mean p set: 0.45075103640556335
loss_pred:0.02527565136551857, decouple_loss:0.008460146375000477
The modified gen p mean: 0.4611278772354126, gen p mean: 0.0, mean p set: 0.4497469365596771
loss_pred:0.025701070204377174, decouple_loss:0.008305148221552372
Iteration: 2482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43534839153289795, gen p mean: 0.0, mean p set: 0.4496713876724243
The modified gen p mean: 0.43872079253196716, gen p mean: 0.0, mean p set: 0.4515463411808014
The modified gen p mean: 0.4308132827281952, gen p mean: 0.0, mean p set: 0.44956985116004944
loss_pred:0.026195557788014412, decouple_loss:0.008610592223703861
loss_pred:0.025610527023673058, decouple_loss:0.008369005285203457
loss_pred:0.025576094165444374, decouple_loss:0.008478380739688873
Iteration: 2483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43556541204452515, gen p mean: 0.0, mean p set: 0.45029953122138977
The modified gen p mean: 0.44652992486953735, gen p mean: 0.0, mean p set: 0.4495818316936493
The modified gen p mean: 0.4408645033836365, gen p mean: 0.0, mean p set: 0.4498935639858246
loss_pred:0.02588762156665325, decouple_loss:0.008533424697816372
loss_pred:0.02620134875178337, decouple_loss:0.008581333793699741
loss_pred:0.02581534907221794, decouple_loss:0.008365850895643234
Iteration: 2484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46716392040252686, gen p mean: 0.0, mean p set: 0.4503568708896637
The modified gen p mean: 0.4669618606567383, gen p mean: 0.0, mean p set: 0.4504949152469635
The modified gen p mean: 0.4680893123149872, gen p mean: 0.0, mean p set: 0.45029497146606445
loss_pred:0.02594734914600849, decouple_loss:0.008156668394804
loss_pred:0.025387516245245934, decouple_loss:0.008400116115808487
loss_pred:0.025417638942599297, decouple_loss:0.008448216132819653
Iteration: 2485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.458406537771225, gen p mean: 0.0, mean p set: 0.44886115193367004
The modified gen p mean: 0.45372292399406433, gen p mean: 0.0, mean p set: 0.45036759972572327
The modified gen p mean: 0.4559071362018585, gen p mean: 0.0, mean p set: 0.4500047266483307
loss_pred:0.025568887591362, decouple_loss:0.008240207098424435
loss_pred:0.025840476155281067, decouple_loss:0.008147325366735458
loss_pred:0.02585931494832039, decouple_loss:0.008079341612756252
Iteration: 2486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43737664818763733, gen p mean: 0.0, mean p set: 0.4523356258869171
The modified gen p mean: 0.4262140691280365, gen p mean: 0.0, mean p set: 0.45081138610839844
The modified gen p mean: 0.436685711145401, gen p mean: 0.0, mean p set: 0.450996994972229
loss_pred:0.0250429417937994, decouple_loss:0.008305204100906849
loss_pred:0.026109665632247925, decouple_loss:0.008434385992586613
loss_pred:0.025235377252101898, decouple_loss:0.008437901735305786
Iteration: 2487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500492513179779, gen p mean: 0.0, mean p set: 0.45241379737854004
The modified gen p mean: 0.44646814465522766, gen p mean: 0.0, mean p set: 0.45262953639030457
loss_pred:0.02528930827975273, decouple_loss:0.00848659873008728
The modified gen p mean: 0.44521257281303406, gen p mean: 0.0, mean p set: 0.4506879150867462
loss_pred:0.025566373020410538, decouple_loss:0.008373145945370197
loss_pred:0.026117319241166115, decouple_loss:0.008278604596853256
Iteration: 2488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4572967290878296, gen p mean: 0.0, mean p set: 0.4505685865879059
The modified gen p mean: 0.46187305450439453, gen p mean: 0.0, mean p set: 0.4508519768714905
The modified gen p mean: 0.46222588419914246, gen p mean: 0.0, mean p set: 0.4504052996635437
loss_pred:0.026988668367266655, decouple_loss:0.009031975641846657
loss_pred:0.024197589606046677, decouple_loss:0.008081156760454178
loss_pred:0.02543015591800213, decouple_loss:0.008285787887871265
Iteration: 2489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134449005126953, gen p mean: 0.0, mean p set: 0.4497208595275879
The modified gen p mean: 0.45070764422416687, gen p mean: 0.0, mean p set: 0.45098140835762024
The modified gen p mean: 0.44771328568458557, gen p mean: 0.0, mean p set: 0.45075175166130066
loss_pred:0.02612992934882641, decouple_loss:0.008249860256910324
loss_pred:0.025398293510079384, decouple_loss:0.008412000723183155
loss_pred:0.027024725452065468, decouple_loss:0.008886096999049187
Iteration: 2490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517640471458435, gen p mean: 0.0, mean p set: 0.4506444036960602
The modified gen p mean: 0.44428348541259766, gen p mean: 0.0, mean p set: 0.449592649936676
The modified gen p mean: 0.4474208950996399, gen p mean: 0.0, mean p set: 0.45051753520965576
loss_pred:0.024885011836886406, decouple_loss:0.008123729377985
loss_pred:0.024857841432094574, decouple_loss:0.008344655856490135
loss_pred:0.025688394904136658, decouple_loss:0.00838665571063757
2023-05-03 07:04:50 testing...
The modified gen p mean: 0.4438167214393616, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4489516615867615, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45175713300704956, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02757211960852146, decouple_loss:0.009256776422262192
loss_pred:0.026459911838173866, decouple_loss:0.009112609550356865
loss_pred:0.026097172871232033, decouple_loss:0.009076906368136406
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027167174965143204, avg_mse: 0.03223699331283569
current test mse: 0.032237
Iteration: 2491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956520199775696, gen p mean: 0.0, mean p set: 0.45068684220314026
The modified gen p mean: 0.4509422779083252, gen p mean: 0.0, mean p set: 0.4502204656600952
loss_pred:0.025087986141443253, decouple_loss:0.0084335096180439
loss_pred:0.025501767173409462, decouple_loss:0.008279556408524513
The modified gen p mean: 0.4518525302410126, gen p mean: 0.0, mean p set: 0.45081067085266113
loss_pred:0.02503245323896408, decouple_loss:0.008621705695986748
Iteration: 2492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884777069091797, gen p mean: 0.0, mean p set: 0.4494975507259369
The modified gen p mean: 0.4436603784561157, gen p mean: 0.0, mean p set: 0.45115405321121216
The modified gen p mean: 0.4516977369785309, gen p mean: 0.0, mean p set: 0.45038288831710815
loss_pred:0.02533665858209133, decouple_loss:0.008026356808841228
loss_pred:0.024116838350892067, decouple_loss:0.007941530086100101
loss_pred:0.025683172047138214, decouple_loss:0.008397112600505352
Iteration: 2493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852322340011597, gen p mean: 0.0, mean p set: 0.45045042037963867
The modified gen p mean: 0.45230230689048767, gen p mean: 0.0, mean p set: 0.4512108564376831
The modified gen p mean: 0.4483339190483093, gen p mean: 0.0, mean p set: 0.45110228657722473
loss_pred:0.025565868243575096, decouple_loss:0.008161569945514202
loss_pred:0.025284437462687492, decouple_loss:0.008206227794289589
loss_pred:0.027064524590969086, decouple_loss:0.008390462026000023
Iteration: 2494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513467848300934, gen p mean: 0.0, mean p set: 0.45151498913764954
The modified gen p mean: 0.45807698369026184, gen p mean: 0.0, mean p set: 0.45207199454307556
The modified gen p mean: 0.460742712020874, gen p mean: 0.0, mean p set: 0.4488658010959625
loss_pred:0.026214614510536194, decouple_loss:0.008818713948130608
loss_pred:0.02553049847483635, decouple_loss:0.008145132102072239
loss_pred:0.02570052072405815, decouple_loss:0.008017521351575851
Iteration: 2495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450884610414505, gen p mean: 0.0, mean p set: 0.4500291645526886
The modified gen p mean: 0.45363518595695496, gen p mean: 0.0, mean p set: 0.4514326751232147
The modified gen p mean: 0.45296475291252136, gen p mean: 0.0, mean p set: 0.44943130016326904
loss_pred:0.025215202942490578, decouple_loss:0.008214011788368225
loss_pred:0.02453823760151863, decouple_loss:0.00824404414743185
loss_pred:0.025572441518306732, decouple_loss:0.008083246648311615
Iteration: 2496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4409363567829132, gen p mean: 0.0, mean p set: 0.4516029953956604
The modified gen p mean: 0.44316038489341736, gen p mean: 0.0, mean p set: 0.45116233825683594
The modified gen p mean: 0.4411351680755615, gen p mean: 0.0, mean p set: 0.4504128098487854
loss_pred:0.025487808510661125, decouple_loss:0.007924545556306839
loss_pred:0.0251527801156044, decouple_loss:0.007897509261965752
loss_pred:0.025325806811451912, decouple_loss:0.007971342653036118
Iteration: 2497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45124372839927673, gen p mean: 0.0, mean p set: 0.4495031237602234
The modified gen p mean: 0.4464346766471863, gen p mean: 0.0, mean p set: 0.45183131098747253
The modified gen p mean: 0.45037251710891724, gen p mean: 0.0, mean p set: 0.4523118734359741
loss_pred:0.025035297498106956, decouple_loss:0.007895679213106632
loss_pred:0.023646153509616852, decouple_loss:0.007803867571055889
loss_pred:0.025590017437934875, decouple_loss:0.00791339110583067
Iteration: 2498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46140167117118835, gen p mean: 0.0, mean p set: 0.4509684145450592
The modified gen p mean: 0.4526626169681549, gen p mean: 0.0, mean p set: 0.45123711228370667
The modified gen p mean: 0.4554978907108307, gen p mean: 0.0, mean p set: 0.4501529335975647
loss_pred:0.025751477107405663, decouple_loss:0.00809360109269619
loss_pred:0.02623968943953514, decouple_loss:0.008708360604941845
loss_pred:0.025154773145914078, decouple_loss:0.00817633792757988
Iteration: 2499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45887839794158936, gen p mean: 0.0, mean p set: 0.45179483294487
The modified gen p mean: 0.456360787153244, gen p mean: 0.0, mean p set: 0.4497842490673065
The modified gen p mean: 0.4525233805179596, gen p mean: 0.0, mean p set: 0.45027947425842285
loss_pred:0.02527693659067154, decouple_loss:0.007998614571988583
loss_pred:0.025289122015237808, decouple_loss:0.008062546141445637
loss_pred:0.025306282564997673, decouple_loss:0.00822946522384882
Iteration: 2500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44158998131752014, gen p mean: 0.0, mean p set: 0.4505689740180969
The modified gen p mean: 0.4439920485019684, gen p mean: 0.0, mean p set: 0.4506988525390625
The modified gen p mean: 0.44584861397743225, gen p mean: 0.0, mean p set: 0.4506790041923523
loss_pred:0.025353722274303436, decouple_loss:0.008004814386367798
loss_pred:0.02480616234242916, decouple_loss:0.00817618053406477
loss_pred:0.024923890829086304, decouple_loss:0.008166322484612465
2023-05-03 07:08:32 testing...
The modified gen p mean: 0.44295647740364075, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.43816938996315, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4459711015224457, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02634490095078945, decouple_loss:0.008820815943181515
loss_pred:0.02745494432747364, decouple_loss:0.00899778213351965
loss_pred:0.02603108063340187, decouple_loss:0.008832206018269062
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02705448865890503, avg_mse: 0.03216071426868439
current test mse: 0.032161
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
NaN value num: 0
Iteration: 2501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44268959760665894, gen p mean: 0.0, mean p set: 0.45093417167663574
The modified gen p mean: 0.44324275851249695, gen p mean: 0.0, mean p set: 0.45062994956970215
loss_pred:0.025786852464079857, decouple_loss:0.008678806945681572
loss_pred:0.026572998613119125, decouple_loss:0.008743074722588062
The modified gen p mean: 0.44468793272972107, gen p mean: 0.0, mean p set: 0.4520759880542755
loss_pred:0.025398489087820053, decouple_loss:0.008491083048284054
Iteration: 2502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45281246304512024, gen p mean: 0.0, mean p set: 0.4507933557033539
The modified gen p mean: 0.45267051458358765, gen p mean: 0.0, mean p set: 0.4518631398677826
The modified gen p mean: 0.45921429991722107, gen p mean: 0.0, mean p set: 0.45179006457328796
loss_pred:0.025473959743976593, decouple_loss:0.008338969200849533
loss_pred:0.027142446488142014, decouple_loss:0.009381369687616825
loss_pred:0.025921445339918137, decouple_loss:0.008481951430439949
Iteration: 2503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528806805610657, gen p mean: 0.0, mean p set: 0.45286911725997925
The modified gen p mean: 0.4517016112804413, gen p mean: 0.0, mean p set: 0.4525797963142395
The modified gen p mean: 0.46049630641937256, gen p mean: 0.0, mean p set: 0.4518493115901947
loss_pred:0.025578608736395836, decouple_loss:0.008479601703584194
loss_pred:0.0252196304500103, decouple_loss:0.008243940770626068
loss_pred:0.026619786396622658, decouple_loss:0.008401600643992424
Iteration: 2504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4574739933013916, gen p mean: 0.0, mean p set: 0.45201605558395386
The modified gen p mean: 0.4488908052444458, gen p mean: 0.0, mean p set: 0.4510243833065033
The modified gen p mean: 0.4571031332015991, gen p mean: 0.0, mean p set: 0.451449453830719
loss_pred:0.026132378727197647, decouple_loss:0.008462033234536648
loss_pred:0.026367364451289177, decouple_loss:0.00857126247137785
loss_pred:0.024924231693148613, decouple_loss:0.00853461492806673
Iteration: 2505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45223838090896606, gen p mean: 0.0, mean p set: 0.4506874978542328
The modified gen p mean: 0.45215150713920593, gen p mean: 0.0, mean p set: 0.45038551092147827
The modified gen p mean: 0.4469689726829529, gen p mean: 0.0, mean p set: 0.451722115278244
loss_pred:0.027109967544674873, decouple_loss:0.00827944278717041
loss_pred:0.025534629821777344, decouple_loss:0.00834399089217186
loss_pred:0.026820536702871323, decouple_loss:0.009122117422521114
Iteration: 2506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502229690551758, gen p mean: 0.0, mean p set: 0.4504954218864441
The modified gen p mean: 0.4409104287624359, gen p mean: 0.0, mean p set: 0.45011407136917114
The modified gen p mean: 0.4508446455001831, gen p mean: 0.0, mean p set: 0.4505161941051483
loss_pred:0.02581021375954151, decouple_loss:0.0079120472073555
loss_pred:0.026060597971081734, decouple_loss:0.008158116601407528
loss_pred:0.025496389716863632, decouple_loss:0.008118695579469204
Iteration: 2507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445168137550354, gen p mean: 0.0, mean p set: 0.45218396186828613
The modified gen p mean: 0.4466095566749573, gen p mean: 0.0, mean p set: 0.451358824968338
The modified gen p mean: 0.4427967071533203, gen p mean: 0.0, mean p set: 0.45289358496665955
loss_pred:0.027067041024565697, decouple_loss:0.008502575568854809
loss_pred:0.025435760617256165, decouple_loss:0.008097116835415363
loss_pred:0.025066090747714043, decouple_loss:0.008234928362071514
Iteration: 2508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46049273014068604, gen p mean: 0.0, mean p set: 0.4521932005882263
The modified gen p mean: 0.45985284447669983, gen p mean: 0.0, mean p set: 0.4509580433368683
The modified gen p mean: 0.453430712223053, gen p mean: 0.0, mean p set: 0.4514811336994171
loss_pred:0.026219505816698074, decouple_loss:0.00826165173202753
loss_pred:0.02568855509161949, decouple_loss:0.008165855892002583
loss_pred:0.026483204215765, decouple_loss:0.00808163546025753
Iteration: 2509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4562608599662781, gen p mean: 0.0, mean p set: 0.4511570930480957
The modified gen p mean: 0.4504546523094177, gen p mean: 0.0, mean p set: 0.4499463438987732
The modified gen p mean: 0.45138704776763916, gen p mean: 0.0, mean p set: 0.45116883516311646
loss_pred:0.02637379616498947, decouple_loss:0.008026612922549248
loss_pred:0.026605401188135147, decouple_loss:0.008168911561369896
loss_pred:0.026731258258223534, decouple_loss:0.008340314961969852
Iteration: 2510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45014333724975586, gen p mean: 0.0, mean p set: 0.4522396922111511
The modified gen p mean: 0.4403976500034332, gen p mean: 0.0, mean p set: 0.4524238109588623
The modified gen p mean: 0.4442463517189026, gen p mean: 0.0, mean p set: 0.45156532526016235
loss_pred:0.025416681542992592, decouple_loss:0.008215446025133133
loss_pred:0.025070536881685257, decouple_loss:0.008245167322456837
loss_pred:0.024359531700611115, decouple_loss:0.008259140886366367
2023-05-03 07:12:51 testing...
The modified gen p mean: 0.4400424063205719, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44525882601737976, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4479636251926422, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02753082849085331, decouple_loss:0.00940098986029625
loss_pred:0.0264491718262434, decouple_loss:0.009050164371728897
loss_pred:0.026034826412796974, decouple_loss:0.00904610101133585
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027129899710416794, avg_mse: 0.032266877591609955
current test mse: 0.032267
Iteration: 2511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45162272453308105, gen p mean: 0.0, mean p set: 0.45182737708091736
The modified gen p mean: 0.4506103992462158, gen p mean: 0.0, mean p set: 0.4509766697883606
loss_pred:0.025287164375185966, decouple_loss:0.0082341143861413
loss_pred:0.026319464668631554, decouple_loss:0.00794424582272768
The modified gen p mean: 0.44722312688827515, gen p mean: 0.0, mean p set: 0.45062902569770813
loss_pred:0.025637662038207054, decouple_loss:0.008053973317146301
Iteration: 2512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46032220125198364, gen p mean: 0.0, mean p set: 0.45218998193740845
The modified gen p mean: 0.4561980962753296, gen p mean: 0.0, mean p set: 0.4507540166378021
The modified gen p mean: 0.45349135994911194, gen p mean: 0.0, mean p set: 0.45289894938468933
loss_pred:0.026261605322360992, decouple_loss:0.008046207949519157
loss_pred:0.02602490782737732, decouple_loss:0.007891431450843811
loss_pred:0.025317739695310593, decouple_loss:0.008317703381180763
Iteration: 2513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4552401602268219, gen p mean: 0.0, mean p set: 0.4511346220970154
The modified gen p mean: 0.45654651522636414, gen p mean: 0.0, mean p set: 0.4508115351200104
The modified gen p mean: 0.45319855213165283, gen p mean: 0.0, mean p set: 0.45175471901893616
loss_pred:0.026257798075675964, decouple_loss:0.007938231341540813
loss_pred:0.02522493340075016, decouple_loss:0.008181676268577576
loss_pred:0.025388583540916443, decouple_loss:0.00819995068013668
Iteration: 2514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4401768743991852, gen p mean: 0.0, mean p set: 0.45354846119880676
The modified gen p mean: 0.444545716047287, gen p mean: 0.0, mean p set: 0.4514252245426178
The modified gen p mean: 0.44037187099456787, gen p mean: 0.0, mean p set: 0.45223185420036316
loss_pred:0.0245487242937088, decouple_loss:0.008075864054262638
loss_pred:0.025656186044216156, decouple_loss:0.007919084280729294
loss_pred:0.02522718906402588, decouple_loss:0.008127040229737759
Iteration: 2515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764262437820435, gen p mean: 0.0, mean p set: 0.45154494047164917
The modified gen p mean: 0.45133551955223083, gen p mean: 0.0, mean p set: 0.4520973861217499
The modified gen p mean: 0.4444275200366974, gen p mean: 0.0, mean p set: 0.452742338180542
loss_pred:0.024270320311188698, decouple_loss:0.00837063230574131
loss_pred:0.026176856830716133, decouple_loss:0.007924395613372326
loss_pred:0.024430299177765846, decouple_loss:0.008241585455834866
Iteration: 2516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46189311146736145, gen p mean: 0.0, mean p set: 0.45155417919158936
The modified gen p mean: 0.45638883113861084, gen p mean: 0.0, mean p set: 0.45140039920806885
The modified gen p mean: 0.46170035004615784, gen p mean: 0.0, mean p set: 0.4528786242008209
loss_pred:0.026167189702391624, decouple_loss:0.007972120307385921
loss_pred:0.02516411989927292, decouple_loss:0.00807212945073843
loss_pred:0.025701789185404778, decouple_loss:0.008067185059189796
Iteration: 2517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529387354850769, gen p mean: 0.0, mean p set: 0.45134201645851135
The modified gen p mean: 0.4541187882423401, gen p mean: 0.0, mean p set: 0.452263206243515
The modified gen p mean: 0.455021470785141, gen p mean: 0.0, mean p set: 0.4514739513397217
loss_pred:0.02610795572400093, decouple_loss:0.00811007246375084
loss_pred:0.025550477206707, decouple_loss:0.0080190971493721
loss_pred:0.025617172941565514, decouple_loss:0.007999547757208347
Iteration: 2518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44433626532554626, gen p mean: 0.0, mean p set: 0.45077693462371826
The modified gen p mean: 0.44924458861351013, gen p mean: 0.0, mean p set: 0.4530864953994751
The modified gen p mean: 0.443526029586792, gen p mean: 0.0, mean p set: 0.4516936242580414
loss_pred:0.025881679728627205, decouple_loss:0.007633666507899761loss_pred:0.024890948086977005, decouple_loss:0.008221509866416454
loss_pred:0.026455676183104515, decouple_loss:0.008333886973559856
Iteration: 2519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45182567834854126, gen p mean: 0.0, mean p set: 0.4503083825111389
The modified gen p mean: 0.4526802599430084, gen p mean: 0.0, mean p set: 0.44992655515670776
The modified gen p mean: 0.45103585720062256, gen p mean: 0.0, mean p set: 0.453481525182724
loss_pred:0.026403116062283516, decouple_loss:0.00811965111643076
loss_pred:0.02612241543829441, decouple_loss:0.008017621003091335
loss_pred:0.024611996486783028, decouple_loss:0.007740572560578585
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
NaN value num: 0
Iteration: 2520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528849124908447, gen p mean: 0.0, mean p set: 0.4505631625652313
The modified gen p mean: 0.44844284653663635, gen p mean: 0.0, mean p set: 0.45094767212867737
The modified gen p mean: 0.4475039541721344, gen p mean: 0.0, mean p set: 0.44944655895233154
loss_pred:0.028803110122680664, decouple_loss:0.009183713234961033
loss_pred:0.025123445317149162, decouple_loss:0.008359125815331936
loss_pred:0.025768760591745377, decouple_loss:0.008616192266345024
2023-05-03 07:17:16 testing...
The modified gen p mean: 0.44703173637390137, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44144904613494873, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44958412647247314, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026389578357338905, decouple_loss:0.008870481513440609
loss_pred:0.027461234480142593, decouple_loss:0.00923963449895382
loss_pred:0.02599017508327961, decouple_loss:0.008934177458286285
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027064401656389236, avg_mse: 0.032201044261455536
current test mse: 0.032201
Iteration: 2521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44574207067489624, gen p mean: 0.0, mean p set: 0.4506370425224304
loss_pred:0.028749579563736916, decouple_loss:0.008927714079618454
The modified gen p mean: 0.4458489716053009, gen p mean: 0.0, mean p set: 0.44932547211647034
loss_pred:0.02677653171122074, decouple_loss:0.008260643109679222
The modified gen p mean: 0.4528730809688568, gen p mean: 0.0, mean p set: 0.4523966908454895
loss_pred:0.02552187070250511, decouple_loss:0.008227069862186909
Iteration: 2522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4561108648777008, gen p mean: 0.0, mean p set: 0.4528287649154663
The modified gen p mean: 0.45364460349082947, gen p mean: 0.0, mean p set: 0.452788382768631
The modified gen p mean: 0.45386362075805664, gen p mean: 0.0, mean p set: 0.4523853361606598
loss_pred:0.025506358593702316, decouple_loss:0.008173944428563118
loss_pred:0.025859812274575233, decouple_loss:0.008309311233460903
loss_pred:0.02622358687222004, decouple_loss:0.00852076057344675
Iteration: 2523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694769382476807, gen p mean: 0.0, mean p set: 0.4515089690685272
The modified gen p mean: 0.44900044798851013, gen p mean: 0.0, mean p set: 0.44963186979293823
loss_pred:0.026595409959554672, decouple_loss:0.008243073709309101
The modified gen p mean: 0.4588641822338104, gen p mean: 0.0, mean p set: 0.4523797929286957
loss_pred:0.028105441480875015, decouple_loss:0.008731923066079617
loss_pred:0.026071647182106972, decouple_loss:0.008191492408514023
Iteration: 2524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966933131217957, gen p mean: 0.0, mean p set: 0.45037025213241577
The modified gen p mean: 0.45744451880455017, gen p mean: 0.0, mean p set: 0.4509114921092987
The modified gen p mean: 0.4515314996242523, gen p mean: 0.0, mean p set: 0.4501945972442627
loss_pred:0.026632502675056458, decouple_loss:0.008673167787492275
loss_pred:0.025204919278621674, decouple_loss:0.008236411027610302
loss_pred:0.02709445357322693, decouple_loss:0.00848868116736412
Iteration: 2525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452211558818817, gen p mean: 0.0, mean p set: 0.4506132900714874
The modified gen p mean: 0.4464338719844818, gen p mean: 0.0, mean p set: 0.4507678747177124
The modified gen p mean: 0.44695159792900085, gen p mean: 0.0, mean p set: 0.4492642879486084
loss_pred:0.02712199278175831, decouple_loss:0.008165506646037102
loss_pred:0.025580409914255142, decouple_loss:0.00839114747941494
loss_pred:0.02617085911333561, decouple_loss:0.008485477417707443
Iteration: 2526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44106754660606384, gen p mean: 0.0, mean p set: 0.45010891556739807
The modified gen p mean: 0.44949284195899963, gen p mean: 0.0, mean p set: 0.4506262540817261
The modified gen p mean: 0.4457795023918152, gen p mean: 0.0, mean p set: 0.45049622654914856
loss_pred:0.026648959144949913, decouple_loss:0.008451132103800774
loss_pred:0.024721920490264893, decouple_loss:0.008086178451776505
loss_pred:0.027182569727301598, decouple_loss:0.008259108290076256
Iteration: 2527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4566466808319092, gen p mean: 0.0, mean p set: 0.4515781104564667
The modified gen p mean: 0.45631587505340576, gen p mean: 0.0, mean p set: 0.4521786570549011
The modified gen p mean: 0.4533783197402954, gen p mean: 0.0, mean p set: 0.44889846444129944
loss_pred:0.024652132764458656, decouple_loss:0.008586372248828411
loss_pred:0.024548286572098732, decouple_loss:0.008379590697586536
loss_pred:0.02796482853591442, decouple_loss:0.008511213585734367
Iteration: 2528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463886022567749, gen p mean: 0.0, mean p set: 0.45023679733276367
The modified gen p mean: 0.44281890988349915, gen p mean: 0.0, mean p set: 0.4503953158855438
The modified gen p mean: 0.44789189100265503, gen p mean: 0.0, mean p set: 0.45037439465522766
loss_pred:0.026430277153849602, decouple_loss:0.008171174675226212
loss_pred:0.02647698111832142, decouple_loss:0.008343844674527645
loss_pred:0.026036810129880905, decouple_loss:0.008483308367431164
Iteration: 2529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45738691091537476, gen p mean: 0.0, mean p set: 0.4508816599845886
The modified gen p mean: 0.45221444964408875, gen p mean: 0.0, mean p set: 0.45276302099227905
loss_pred:0.024775227531790733, decouple_loss:0.008756674826145172
The modified gen p mean: 0.45300188660621643, gen p mean: 0.0, mean p set: 0.4517871141433716
loss_pred:0.0263209231197834, decouple_loss:0.00878057535737753
loss_pred:0.025803031399846077, decouple_loss:0.008630530908703804
Iteration: 2530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512806236743927, gen p mean: 0.0, mean p set: 0.44978898763656616
The modified gen p mean: 0.44828590750694275, gen p mean: 0.0, mean p set: 0.4504729211330414
The modified gen p mean: 0.4492972791194916, gen p mean: 0.0, mean p set: 0.4500194787979126
loss_pred:0.02546972967684269, decouple_loss:0.008179076947271824
loss_pred:0.02604922093451023, decouple_loss:0.008221304044127464
loss_pred:0.025904087349772453, decouple_loss:0.008196955546736717
2023-05-03 07:20:58 testing...
The modified gen p mean: 0.4476392865180969, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44211453199386597, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.450236052274704, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026377206668257713, decouple_loss:0.00875741895288229
loss_pred:0.027385961264371872, decouple_loss:0.008896473795175552
loss_pred:0.025981688871979713, decouple_loss:0.008767242543399334
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027021972462534904, avg_mse: 0.03226446732878685
current test mse: 0.032264
Iteration: 2531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4447702169418335, gen p mean: 0.0, mean p set: 0.45180633664131165
The modified gen p mean: 0.45221689343452454, gen p mean: 0.0, mean p set: 0.4503283202648163
loss_pred:0.026788564398884773, decouple_loss:0.008457708172500134
loss_pred:0.02496430091559887, decouple_loss:0.008518275804817677
The modified gen p mean: 0.4448191821575165, gen p mean: 0.0, mean p set: 0.4517803192138672
loss_pred:0.027497846633195877, decouple_loss:0.008779975585639477
Iteration: 2532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45133325457572937, gen p mean: 0.0, mean p set: 0.4510500431060791
The modified gen p mean: 0.45097532868385315, gen p mean: 0.0, mean p set: 0.4507118761539459
The modified gen p mean: 0.45322540402412415, gen p mean: 0.0, mean p set: 0.44904741644859314
loss_pred:0.026292288675904274, decouple_loss:0.008345586247742176
loss_pred:0.026187680661678314, decouple_loss:0.0082477405667305
loss_pred:0.02812124602496624, decouple_loss:0.008265902288258076
Iteration: 2533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4555504322052002, gen p mean: 0.0, mean p set: 0.4494556486606598
The modified gen p mean: 0.4511924982070923, gen p mean: 0.0, mean p set: 0.4512340724468231
The modified gen p mean: 0.45750829577445984, gen p mean: 0.0, mean p set: 0.4518067240715027
loss_pred:0.02570767141878605, decouple_loss:0.008387641981244087
loss_pred:0.026946689933538437, decouple_loss:0.008413669653236866
loss_pred:0.024388642981648445, decouple_loss:0.008264260366559029
Iteration: 2534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474785029888153, gen p mean: 0.0, mean p set: 0.451625794172287
The modified gen p mean: 0.44193199276924133, gen p mean: 0.0, mean p set: 0.4517802298069
The modified gen p mean: 0.44268718361854553, gen p mean: 0.0, mean p set: 0.4506323039531708
loss_pred:0.024606328457593918, decouple_loss:0.008259142749011517
loss_pred:0.02555464394390583, decouple_loss:0.008549179881811142
loss_pred:0.02632395178079605, decouple_loss:0.007864103652536869
Iteration: 2535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484439194202423, gen p mean: 0.0, mean p set: 0.452411413192749
The modified gen p mean: 0.4545457661151886, gen p mean: 0.0, mean p set: 0.4516959488391876
The modified gen p mean: 0.44634300470352173, gen p mean: 0.0, mean p set: 0.45142364501953125
loss_pred:0.026087777689099312, decouple_loss:0.00849109049886465
loss_pred:0.025250690057873726, decouple_loss:0.008065365254878998
loss_pred:0.026158779859542847, decouple_loss:0.00812044832855463
Iteration: 2536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542884826660156, gen p mean: 0.0, mean p set: 0.45006316900253296
The modified gen p mean: 0.4578476846218109, gen p mean: 0.0, mean p set: 0.4504021108150482
The modified gen p mean: 0.456432044506073, gen p mean: 0.0, mean p set: 0.4508860111236572
loss_pred:0.02617771364748478, decouple_loss:0.008265902288258076
loss_pred:0.027800342068076134, decouple_loss:0.008229486644268036
loss_pred:0.025992248207330704, decouple_loss:0.008259429596364498
Iteration: 2537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469962418079376, gen p mean: 0.0, mean p set: 0.45060670375823975
The modified gen p mean: 0.44577834010124207, gen p mean: 0.0, mean p set: 0.449785053730011
The modified gen p mean: 0.4580821692943573, gen p mean: 0.0, mean p set: 0.4518364667892456
loss_pred:0.02664739452302456, decouple_loss:0.007859064266085625
loss_pred:0.026469282805919647, decouple_loss:0.007779066916555166
loss_pred:0.025737129151821136, decouple_loss:0.007894806563854218
Iteration: 2538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452187716960907, gen p mean: 0.0, mean p set: 0.4519183933734894
The modified gen p mean: 0.4485905170440674, gen p mean: 0.0, mean p set: 0.44928696751594543
The modified gen p mean: 0.45211881399154663, gen p mean: 0.0, mean p set: 0.4520488977432251
loss_pred:0.024474050849676132, decouple_loss:0.007791496813297272
loss_pred:0.024724401533603668, decouple_loss:0.008135037496685982
loss_pred:0.02525082416832447, decouple_loss:0.007912601344287395
Iteration: 2539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461524188518524, gen p mean: 0.0, mean p set: 0.45217210054397583
The modified gen p mean: 0.44626274704933167, gen p mean: 0.0, mean p set: 0.45208439230918884
The modified gen p mean: 0.4428013563156128, gen p mean: 0.0, mean p set: 0.4498198330402374
loss_pred:0.026054931804537773, decouple_loss:0.008206629194319248
loss_pred:0.025614924728870392, decouple_loss:0.008474722504615784
loss_pred:0.02639513462781906, decouple_loss:0.008046960458159447
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 2540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44898346066474915, gen p mean: 0.0, mean p set: 0.44739529490470886
The modified gen p mean: 0.45298418402671814, gen p mean: 0.0, mean p set: 0.44713205099105835
The modified gen p mean: 0.4467301666736603, gen p mean: 0.0, mean p set: 0.44717565178871155
loss_pred:0.02664119191467762, decouple_loss:0.009450414218008518
loss_pred:0.02566259354352951, decouple_loss:0.008686777204275131
loss_pred:0.027239587157964706, decouple_loss:0.008727476000785828
2023-05-03 07:25:28 testing...
The modified gen p mean: 0.4440551698207855, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495783746242523, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4521287977695465, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027305206283926964, decouple_loss:0.008768892847001553
loss_pred:0.026321738958358765, decouple_loss:0.008671844378113747
loss_pred:0.026033524423837662, decouple_loss:0.008624870330095291
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026987917721271515, avg_mse: 0.03224347159266472
current test mse: 0.032243
Iteration: 2541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756805896759033, gen p mean: 0.0, mean p set: 0.447934627532959
The modified gen p mean: 0.44644656777381897, gen p mean: 0.0, mean p set: 0.4473738372325897
loss_pred:0.027025623247027397, decouple_loss:0.008607679978013039
loss_pred:0.025857077911496162, decouple_loss:0.008570064790546894
The modified gen p mean: 0.4511995315551758, gen p mean: 0.0, mean p set: 0.44872787594795227
loss_pred:0.025571998208761215, decouple_loss:0.008446339517831802
Iteration: 2542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501468539237976, gen p mean: 0.0, mean p set: 0.44785767793655396
The modified gen p mean: 0.454097718000412, gen p mean: 0.0, mean p set: 0.4465774595737457
The modified gen p mean: 0.4507231116294861, gen p mean: 0.0, mean p set: 0.4486611485481262
loss_pred:0.02785778045654297, decouple_loss:0.008485839702188969
loss_pred:0.0273137204349041, decouple_loss:0.008441203273832798
loss_pred:0.026115430518984795, decouple_loss:0.008689964190125465
Iteration: 2543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065638422966003, gen p mean: 0.0, mean p set: 0.44786933064460754
The modified gen p mean: 0.445608526468277, gen p mean: 0.0, mean p set: 0.44708362221717834
The modified gen p mean: 0.4452100396156311, gen p mean: 0.0, mean p set: 0.4471038579940796
loss_pred:0.026938894763588905, decouple_loss:0.008357792161405087
loss_pred:0.02632533200085163, decouple_loss:0.007981972768902779
loss_pred:0.028160201385617256, decouple_loss:0.00802688580006361
Iteration: 2544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4384475648403168, gen p mean: 0.0, mean p set: 0.44662564992904663
The modified gen p mean: 0.4348798394203186, gen p mean: 0.0, mean p set: 0.4471111297607422
The modified gen p mean: 0.44270530343055725, gen p mean: 0.0, mean p set: 0.44814640283584595
loss_pred:0.02658025175333023, decouple_loss:0.008302345871925354
loss_pred:0.02623772621154785, decouple_loss:0.008208959363400936
loss_pred:0.026714013889431953, decouple_loss:0.007963758893311024
Iteration: 2545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473198354244232, gen p mean: 0.0, mean p set: 0.44765499234199524
The modified gen p mean: 0.45166149735450745, gen p mean: 0.0, mean p set: 0.44860100746154785
The modified gen p mean: 0.44595861434936523, gen p mean: 0.0, mean p set: 0.4479525089263916
loss_pred:0.026773378252983093, decouple_loss:0.007979560643434525
loss_pred:0.026482412591576576, decouple_loss:0.008277383632957935
loss_pred:0.02625194936990738, decouple_loss:0.00787193514406681
Iteration: 2546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4560799300670624, gen p mean: 0.0, mean p set: 0.4485190510749817
The modified gen p mean: 0.4598786234855652, gen p mean: 0.0, mean p set: 0.4486280083656311
The modified gen p mean: 0.4646025598049164, gen p mean: 0.0, mean p set: 0.44764676690101624
loss_pred:0.027087880298495293, decouple_loss:0.008045267313718796
loss_pred:0.026124238967895508, decouple_loss:0.008056449703872204
loss_pred:0.026924429461359978, decouple_loss:0.007928446866571903
Iteration: 2547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44049301743507385, gen p mean: 0.0, mean p set: 0.4471876323223114
The modified gen p mean: 0.4436684250831604, gen p mean: 0.0, mean p set: 0.4476470947265625
The modified gen p mean: 0.4469625949859619, gen p mean: 0.0, mean p set: 0.44869264960289
loss_pred:0.02686481736600399, decouple_loss:0.008009299635887146
loss_pred:0.026179704815149307, decouple_loss:0.008174589835107327
loss_pred:0.0262447502464056, decouple_loss:0.008279765956103802
Iteration: 2548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43751060962677, gen p mean: 0.0, mean p set: 0.4475066065788269
The modified gen p mean: 0.438630610704422, gen p mean: 0.0, mean p set: 0.44923636317253113
The modified gen p mean: 0.43567824363708496, gen p mean: 0.0, mean p set: 0.4472716748714447
loss_pred:0.025031886994838715, decouple_loss:0.008194757625460625
loss_pred:0.026150081306695938, decouple_loss:0.00801561027765274
loss_pred:0.027304116636514664, decouple_loss:0.00824583787471056
Iteration: 2549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45397505164146423, gen p mean: 0.0, mean p set: 0.4477977156639099
The modified gen p mean: 0.4498138725757599, gen p mean: 0.0, mean p set: 0.4478755593299866
The modified gen p mean: 0.45796462893486023, gen p mean: 0.0, mean p set: 0.4471050798892975
loss_pred:0.026581203565001488, decouple_loss:0.007995573803782463
loss_pred:0.026714587584137917, decouple_loss:0.00827795173972845
loss_pred:0.026753608137369156, decouple_loss:0.008253371343016624
Iteration: 2550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45095914602279663, gen p mean: 0.0, mean p set: 0.44743743538856506
The modified gen p mean: 0.4486794173717499, gen p mean: 0.0, mean p set: 0.44715800881385803
The modified gen p mean: 0.44854646921157837, gen p mean: 0.0, mean p set: 0.4473371207714081
loss_pred:0.026903295889496803, decouple_loss:0.008701302111148834
loss_pred:0.025209523737430573, decouple_loss:0.008282595314085484
loss_pred:0.02519066259264946, decouple_loss:0.008165452629327774
2023-05-03 07:29:12 testing...
The modified gen p mean: 0.4369164705276489, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44173747301101685, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44420379400253296, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02731594629585743, decouple_loss:0.008377986028790474
loss_pred:0.026273293420672417, decouple_loss:0.008372361771762371
loss_pred:0.025817302986979485, decouple_loss:0.008341542445123196
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02688704803586006, avg_mse: 0.03208167105913162
current test mse: 0.032082
Iteration: 2551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459783136844635, gen p mean: 0.0, mean p set: 0.44862768054008484
The modified gen p mean: 0.44409650564193726, gen p mean: 0.0, mean p set: 0.4477759003639221
loss_pred:0.02586396038532257, decouple_loss:0.007970320992171764
loss_pred:0.026744581758975983, decouple_loss:0.00837982539087534
The modified gen p mean: 0.44254326820373535, gen p mean: 0.0, mean p set: 0.4470026195049286
loss_pred:0.026378512382507324, decouple_loss:0.008131919428706169
Iteration: 2552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4437439739704132, gen p mean: 0.0, mean p set: 0.44817930459976196
The modified gen p mean: 0.43903157114982605, gen p mean: 0.0, mean p set: 0.4482881724834442
The modified gen p mean: 0.44653913378715515, gen p mean: 0.0, mean p set: 0.4477570950984955
loss_pred:0.026900138705968857, decouple_loss:0.007855228148400784
loss_pred:0.026776164770126343, decouple_loss:0.008255962282419205
loss_pred:0.026657819747924805, decouple_loss:0.0077829002402722836
Iteration: 2553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478159546852112, gen p mean: 0.0, mean p set: 0.447416752576828
The modified gen p mean: 0.4450577199459076, gen p mean: 0.0, mean p set: 0.44764021039009094
The modified gen p mean: 0.4445141851902008, gen p mean: 0.0, mean p set: 0.44832831621170044
loss_pred:0.026506593450903893, decouple_loss:0.007762017659842968
loss_pred:0.027615420520305634, decouple_loss:0.008045644499361515
loss_pred:0.026591073721647263, decouple_loss:0.008265800774097443
Iteration: 2554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45501166582107544, gen p mean: 0.0, mean p set: 0.44888240098953247
The modified gen p mean: 0.45640671253204346, gen p mean: 0.0, mean p set: 0.4465501010417938
The modified gen p mean: 0.4552547335624695, gen p mean: 0.0, mean p set: 0.44688504934310913
loss_pred:0.026502501219511032, decouple_loss:0.00840197317302227
loss_pred:0.026721207424998283, decouple_loss:0.008321921341121197
loss_pred:0.026287348940968513, decouple_loss:0.008057507686316967
Iteration: 2555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456048905849457, gen p mean: 0.0, mean p set: 0.4480327367782593
The modified gen p mean: 0.45152023434638977, gen p mean: 0.0, mean p set: 0.4476739168167114
The modified gen p mean: 0.44678306579589844, gen p mean: 0.0, mean p set: 0.4470112919807434
loss_pred:0.026594264432787895, decouple_loss:0.008338725194334984
loss_pred:0.0270072091370821, decouple_loss:0.008289379999041557
loss_pred:0.02571471780538559, decouple_loss:0.008215521462261677
Iteration: 2556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794905185699463, gen p mean: 0.0, mean p set: 0.44732168316841125
The modified gen p mean: 0.4487433135509491, gen p mean: 0.0, mean p set: 0.4477759599685669
The modified gen p mean: 0.4500890374183655, gen p mean: 0.0, mean p set: 0.4476735293865204
loss_pred:0.025807838886976242, decouple_loss:0.008013772778213024
loss_pred:0.02672732248902321, decouple_loss:0.008086234331130981
loss_pred:0.026870733126997948, decouple_loss:0.007743840105831623
Iteration: 2557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452061355113983, gen p mean: 0.0, mean p set: 0.44801655411720276
The modified gen p mean: 0.44031044840812683, gen p mean: 0.0, mean p set: 0.4468553960323334
The modified gen p mean: 0.4473128914833069, gen p mean: 0.0, mean p set: 0.4486927390098572
loss_pred:0.0250517800450325, decouple_loss:0.007777287159115076
loss_pred:0.02655845507979393, decouple_loss:0.008167876861989498
loss_pred:0.02645185962319374, decouple_loss:0.0080363554880023
Iteration: 2558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44067245721817017, gen p mean: 0.0, mean p set: 0.44842812418937683
The modified gen p mean: 0.440599650144577, gen p mean: 0.0, mean p set: 0.44751641154289246
The modified gen p mean: 0.44444674253463745, gen p mean: 0.0, mean p set: 0.44768741726875305
loss_pred:0.026603471487760544, decouple_loss:0.007894979789853096
loss_pred:0.026109972968697548, decouple_loss:0.007900482974946499
loss_pred:0.026278628036379814, decouple_loss:0.007919525727629662
Iteration: 2559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986310601234436, gen p mean: 0.0, mean p set: 0.4476839005947113
The modified gen p mean: 0.449919730424881, gen p mean: 0.0, mean p set: 0.4477875828742981
The modified gen p mean: 0.44889652729034424, gen p mean: 0.0, mean p set: 0.4474334716796875
loss_pred:0.025182122364640236, decouple_loss:0.008126812055706978
loss_pred:0.026583118364214897, decouple_loss:0.008036640472710133
loss_pred:0.026504607871174812, decouple_loss:0.007951666601002216
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 2560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519815146923065, gen p mean: 0.0, mean p set: 0.4473998546600342
The modified gen p mean: 0.44851943850517273, gen p mean: 0.0, mean p set: 0.44573795795440674
The modified gen p mean: 0.4482523798942566, gen p mean: 0.0, mean p set: 0.4478095471858978
loss_pred:0.02611701563000679, decouple_loss:0.008917172439396381
loss_pred:0.025633828714489937, decouple_loss:0.008395175449550152
loss_pred:0.026489976793527603, decouple_loss:0.008511661551892757
2023-05-03 07:33:33 testing...
The modified gen p mean: 0.44820666313171387, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4530391991138458, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45550939440727234, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027354437857866287, decouple_loss:0.008207707665860653
loss_pred:0.02636389248073101, decouple_loss:0.008124462328851223
loss_pred:0.025942211970686913, decouple_loss:0.008172973059117794
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026961933821439743, avg_mse: 0.0322364866733551
current test mse: 0.032236
Iteration: 2561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526171386241913, gen p mean: 0.0, mean p set: 0.44651132822036743
The modified gen p mean: 0.4492957293987274, gen p mean: 0.0, mean p set: 0.4457697868347168
loss_pred:0.027576299384236336, decouple_loss:0.008642200380563736
loss_pred:0.025868931785225868, decouple_loss:0.008701784536242485
The modified gen p mean: 0.45150136947631836, gen p mean: 0.0, mean p set: 0.44782623648643494
loss_pred:0.026469435542821884, decouple_loss:0.008775866590440273
Iteration: 2562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45124825835227966, gen p mean: 0.0, mean p set: 0.44712045788764954
The modified gen p mean: 0.44976985454559326, gen p mean: 0.0, mean p set: 0.44673389196395874
The modified gen p mean: 0.45234453678131104, gen p mean: 0.0, mean p set: 0.44787678122520447
loss_pred:0.0261419378221035, decouple_loss:0.00862197857350111
loss_pred:0.026425208896398544, decouple_loss:0.008300712332129478
loss_pred:0.026936722919344902, decouple_loss:0.008858746849000454
Iteration: 2563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4409409761428833, gen p mean: 0.0, mean p set: 0.44680535793304443
The modified gen p mean: 0.4375254213809967, gen p mean: 0.0, mean p set: 0.44794052839279175
The modified gen p mean: 0.43658629059791565, gen p mean: 0.0, mean p set: 0.448486864566803
loss_pred:0.02600751630961895, decouple_loss:0.008596294559538364
loss_pred:0.025741329416632652, decouple_loss:0.008332391269505024
loss_pred:0.027396272867918015, decouple_loss:0.008723188191652298
Iteration: 2564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43901893496513367, gen p mean: 0.0, mean p set: 0.448073148727417
The modified gen p mean: 0.4406163990497589, gen p mean: 0.0, mean p set: 0.44689324498176575
The modified gen p mean: 0.43815916776657104, gen p mean: 0.0, mean p set: 0.4469289183616638
loss_pred:0.026614218950271606, decouple_loss:0.008465947583317757
loss_pred:0.02767868898808956, decouple_loss:0.008425497449934483
loss_pred:0.025700530037283897, decouple_loss:0.008377112448215485
Iteration: 2565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4572804272174835, gen p mean: 0.0, mean p set: 0.4471011161804199
The modified gen p mean: 0.4617711305618286, gen p mean: 0.0, mean p set: 0.44725558161735535
The modified gen p mean: 0.4598068296909332, gen p mean: 0.0, mean p set: 0.44858697056770325
loss_pred:0.026044469326734543, decouple_loss:0.008311997167766094
loss_pred:0.026194149628281593, decouple_loss:0.008037270978093147
loss_pred:0.02601495198905468, decouple_loss:0.00847146101295948
Iteration: 2566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4560267925262451, gen p mean: 0.0, mean p set: 0.44799599051475525
The modified gen p mean: 0.45616111159324646, gen p mean: 0.0, mean p set: 0.4484470784664154
The modified gen p mean: 0.45576003193855286, gen p mean: 0.0, mean p set: 0.4482913017272949
loss_pred:0.025522274896502495, decouple_loss:0.00838017463684082
loss_pred:0.025932667776942253, decouple_loss:0.008153362199664116
loss_pred:0.02610190398991108, decouple_loss:0.008810692466795444
Iteration: 2567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4284256100654602, gen p mean: 0.0, mean p set: 0.4490543007850647
The modified gen p mean: 0.43452292680740356, gen p mean: 0.0, mean p set: 0.4471926689147949
The modified gen p mean: 0.43080100417137146, gen p mean: 0.0, mean p set: 0.4461652636528015
loss_pred:0.027395352721214294, decouple_loss:0.009768936783075333
loss_pred:0.02705017849802971, decouple_loss:0.008526373654603958
loss_pred:0.02672920562326908, decouple_loss:0.00857385154813528
Iteration: 2568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44338417053222656, gen p mean: 0.0, mean p set: 0.4461599588394165
The modified gen p mean: 0.4470985233783722, gen p mean: 0.0, mean p set: 0.4464118480682373
The modified gen p mean: 0.44382113218307495, gen p mean: 0.0, mean p set: 0.44752782583236694
loss_pred:0.025779101997613907, decouple_loss:0.008462999947369099
loss_pred:0.02697055973112583, decouple_loss:0.008238987997174263
loss_pred:0.026997927576303482, decouple_loss:0.008271330036222935
Iteration: 2569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46257689595222473, gen p mean: 0.0, mean p set: 0.44647401571273804
The modified gen p mean: 0.4594686031341553, gen p mean: 0.0, mean p set: 0.44668781757354736
The modified gen p mean: 0.4564923346042633, gen p mean: 0.0, mean p set: 0.4471711814403534
loss_pred:0.02700693905353546, decouple_loss:0.00849292241036892
loss_pred:0.02713349275290966, decouple_loss:0.008118374273180962
loss_pred:0.026211075484752655, decouple_loss:0.007983794435858727
Iteration: 2570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4418415129184723, gen p mean: 0.0, mean p set: 0.44868341088294983
The modified gen p mean: 0.4457571804523468, gen p mean: 0.0, mean p set: 0.447951078414917
The modified gen p mean: 0.4413132965564728, gen p mean: 0.0, mean p set: 0.44931700825691223
loss_pred:0.026099087670445442, decouple_loss:0.008707140572369099
loss_pred:0.026104947552084923, decouple_loss:0.00819783378392458
loss_pred:0.026029415428638458, decouple_loss:0.008875911124050617
2023-05-03 07:37:13 testing...
The modified gen p mean: 0.43977493047714233, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.43480244278907776, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44265106320381165, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026063797995448112, decouple_loss:0.008168754167854786
loss_pred:0.027039824053645134, decouple_loss:0.00817415863275528
loss_pred:0.025780772790312767, decouple_loss:0.008402743376791477
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026707224547863007, avg_mse: 0.031746264547109604
current test mse: 0.031746
Iteration: 2571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43921971321105957, gen p mean: 0.0, mean p set: 0.44630563259124756
loss_pred:0.025751471519470215, decouple_loss:0.007984858006238937
The modified gen p mean: 0.43670105934143066, gen p mean: 0.0, mean p set: 0.4477439522743225
loss_pred:0.0260179303586483, decouple_loss:0.008081602863967419
The modified gen p mean: 0.43936410546302795, gen p mean: 0.0, mean p set: 0.4465752840042114
loss_pred:0.026587599888443947, decouple_loss:0.008215880952775478
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521811008453369, gen p mean: 0.0, mean p set: 0.447246253490448
The modified gen p mean: 0.45299872756004333, gen p mean: 0.0, mean p set: 0.44630685448646545
The modified gen p mean: 0.44749829173088074, gen p mean: 0.0, mean p set: 0.4486584961414337
loss_pred:0.026110922917723656, decouple_loss:0.007859966717660427
loss_pred:0.026781288906931877, decouple_loss:0.008243654854595661
loss_pred:0.025724874809384346, decouple_loss:0.008217607624828815
Iteration: 2573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45394667983055115, gen p mean: 0.0, mean p set: 0.4467838406562805
The modified gen p mean: 0.44815707206726074, gen p mean: 0.0, mean p set: 0.4487825632095337
The modified gen p mean: 0.4526968002319336, gen p mean: 0.0, mean p set: 0.44808098673820496
loss_pred:0.02577158249914646, decouple_loss:0.007804469671100378
loss_pred:0.025937722995877266, decouple_loss:0.008454405702650547
loss_pred:0.02630225569009781, decouple_loss:0.0081006595864892
Iteration: 2574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4437052011489868, gen p mean: 0.0, mean p set: 0.4473566710948944
The modified gen p mean: 0.4394964873790741, gen p mean: 0.0, mean p set: 0.44907623529434204
The modified gen p mean: 0.44349586963653564, gen p mean: 0.0, mean p set: 0.4473665952682495
loss_pred:0.02722606249153614, decouple_loss:0.008766889572143555
loss_pred:0.02597743645310402, decouple_loss:0.007798110134899616
loss_pred:0.026449719443917274, decouple_loss:0.008006289601325989
Iteration: 2575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048925280570984, gen p mean: 0.0, mean p set: 0.44758522510528564
The modified gen p mean: 0.4476265013217926, gen p mean: 0.0, mean p set: 0.4479255974292755
The modified gen p mean: 0.4525524973869324, gen p mean: 0.0, mean p set: 0.4466271698474884
loss_pred:0.025876885280013084, decouple_loss:0.007713679689913988
loss_pred:0.027087537571787834, decouple_loss:0.00792208407074213
loss_pred:0.026371492072939873, decouple_loss:0.007855753414332867
Iteration: 2576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199280977249146, gen p mean: 0.0, mean p set: 0.4467402696609497
The modified gen p mean: 0.44874829053878784, gen p mean: 0.0, mean p set: 0.4473038911819458
The modified gen p mean: 0.4507496953010559, gen p mean: 0.0, mean p set: 0.44695523381233215
loss_pred:0.026827046647667885, decouple_loss:0.008123497478663921
loss_pred:0.025641417130827904, decouple_loss:0.007846346125006676
loss_pred:0.025413278490304947, decouple_loss:0.00801856629550457
Iteration: 2577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.441977858543396, gen p mean: 0.0, mean p set: 0.44625577330589294
The modified gen p mean: 0.4373299777507782, gen p mean: 0.0, mean p set: 0.4478280544281006
The modified gen p mean: 0.43700018525123596, gen p mean: 0.0, mean p set: 0.44952791929244995
loss_pred:0.026890648528933525, decouple_loss:0.0076903533190488815
loss_pred:0.025438787415623665, decouple_loss:0.008050589822232723
loss_pred:0.025728754699230194, decouple_loss:0.008194035850465298
Iteration: 2578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4428289830684662, gen p mean: 0.0, mean p set: 0.44694921374320984
The modified gen p mean: 0.4442594349384308, gen p mean: 0.0, mean p set: 0.4476941227912903
The modified gen p mean: 0.44068145751953125, gen p mean: 0.0, mean p set: 0.44927704334259033
loss_pred:0.025977859273552895, decouple_loss:0.007745578419417143
loss_pred:0.026571903377771378, decouple_loss:0.008199878968298435
loss_pred:0.025874312967061996, decouple_loss:0.008280930109322071
Iteration: 2579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4581013023853302, gen p mean: 0.0, mean p set: 0.44715940952301025
The modified gen p mean: 0.45668745040893555, gen p mean: 0.0, mean p set: 0.44865259528160095
The modified gen p mean: 0.4551372528076172, gen p mean: 0.0, mean p set: 0.44933852553367615
loss_pred:0.02650446444749832, decouple_loss:0.007673696149140596
loss_pred:0.02546977996826172, decouple_loss:0.007930567488074303
loss_pred:0.026777740567922592, decouple_loss:0.00833535473793745
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
NaN value num: 0
Iteration: 2580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540433883666992, gen p mean: 0.0, mean p set: 0.44948363304138184
The modified gen p mean: 0.4553292691707611, gen p mean: 0.0, mean p set: 0.44988682866096497
The modified gen p mean: 0.4603862762451172, gen p mean: 0.0, mean p set: 0.4501173794269562
loss_pred:0.025231225416064262, decouple_loss:0.008444804698228836
loss_pred:0.02554343082010746, decouple_loss:0.008740371093153954
loss_pred:0.02636364847421646, decouple_loss:0.00862694252282381
2023-05-03 07:41:39 testing...
The modified gen p mean: 0.44355037808418274, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4391423165798187, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4460603892803192, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02620692364871502, decouple_loss:0.007817180827260017
loss_pred:0.027279136702418327, decouple_loss:0.0077717420645058155
loss_pred:0.02588006854057312, decouple_loss:0.008026598952710629
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026848968118429184, avg_mse: 0.03214288875460625
current test mse: 0.032143
Iteration: 2581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44062328338623047, gen p mean: 0.0, mean p set: 0.450480192899704
The modified gen p mean: 0.4459017515182495, gen p mean: 0.0, mean p set: 0.44983911514282227
loss_pred:0.026104949414730072, decouple_loss:0.008539525792002678
loss_pred:0.02603076957166195, decouple_loss:0.008303356356918812
The modified gen p mean: 0.44333991408348083, gen p mean: 0.0, mean p set: 0.45070016384124756
loss_pred:0.025632094591856003, decouple_loss:0.008334027603268623
Iteration: 2582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44362470507621765, gen p mean: 0.0, mean p set: 0.44952985644340515
The modified gen p mean: 0.4356982707977295, gen p mean: 0.0, mean p set: 0.4500705897808075
The modified gen p mean: 0.4400073289871216, gen p mean: 0.0, mean p set: 0.44916728138923645
loss_pred:0.025670640170574188, decouple_loss:0.0082122553139925
loss_pred:0.024985695257782936, decouple_loss:0.008599777705967426
loss_pred:0.024895472452044487, decouple_loss:0.008176407776772976
Iteration: 2583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542620778083801, gen p mean: 0.0, mean p set: 0.4487202763557434
The modified gen p mean: 0.45504310727119446, gen p mean: 0.0, mean p set: 0.4485691785812378
The modified gen p mean: 0.4527168869972229, gen p mean: 0.0, mean p set: 0.44902974367141724
loss_pred:0.024867169559001923, decouple_loss:0.008225160650908947
loss_pred:0.0251344982534647, decouple_loss:0.008399625308811665
loss_pred:0.026011981070041656, decouple_loss:0.00851247925311327
Iteration: 2584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45749443769454956, gen p mean: 0.0, mean p set: 0.45015186071395874
The modified gen p mean: 0.45344555377960205, gen p mean: 0.0, mean p set: 0.4505566358566284
The modified gen p mean: 0.45829179883003235, gen p mean: 0.0, mean p set: 0.4505636692047119
loss_pred:0.0267050638794899, decouple_loss:0.008355448953807354
loss_pred:0.024912154302001, decouple_loss:0.008340952917933464
loss_pred:0.02538960427045822, decouple_loss:0.008126297034323215
Iteration: 2585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44927978515625, gen p mean: 0.0, mean p set: 0.4515438675880432The modified gen p mean: 0.45081743597984314, gen p mean: 0.0, mean p set: 0.44850265979766846
The modified gen p mean: 0.44474315643310547, gen p mean: 0.0, mean p set: 0.45067599415779114
loss_pred:0.027019813656806946, decouple_loss:0.008229674771428108
loss_pred:0.02508731000125408, decouple_loss:0.008229226805269718
loss_pred:0.02483789622783661, decouple_loss:0.008035069331526756
Iteration: 2586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4422852098941803, gen p mean: 0.0, mean p set: 0.44967490434646606
The modified gen p mean: 0.44505074620246887, gen p mean: 0.0, mean p set: 0.4488218426704407
The modified gen p mean: 0.4406810402870178, gen p mean: 0.0, mean p set: 0.4498702585697174
loss_pred:0.0247822105884552, decouple_loss:0.008087143301963806
loss_pred:0.026730600744485855, decouple_loss:0.00817197933793068
loss_pred:0.02592836506664753, decouple_loss:0.007971306331455708
Iteration: 2587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503001868724823, gen p mean: 0.0, mean p set: 0.4495418667793274
The modified gen p mean: 0.4446322023868561, gen p mean: 0.0, mean p set: 0.4504591226577759
The modified gen p mean: 0.44889137148857117, gen p mean: 0.0, mean p set: 0.4500848054885864
loss_pred:0.024842282757163048, decouple_loss:0.007847284898161888
loss_pred:0.02545246295630932, decouple_loss:0.008198248222470284
loss_pred:0.026458928361535072, decouple_loss:0.007961029186844826
Iteration: 2588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44576016068458557, gen p mean: 0.0, mean p set: 0.4501064419746399
The modified gen p mean: 0.4490499496459961, gen p mean: 0.0, mean p set: 0.4503614604473114
The modified gen p mean: 0.45396310091018677, gen p mean: 0.0, mean p set: 0.4497474730014801
loss_pred:0.025208517909049988, decouple_loss:0.008596235886216164
loss_pred:0.02534465119242668, decouple_loss:0.008682009764015675
loss_pred:0.02538386732339859, decouple_loss:0.008133258670568466
Iteration: 2589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45550665259361267, gen p mean: 0.0, mean p set: 0.4481101632118225
The modified gen p mean: 0.45917993783950806, gen p mean: 0.0, mean p set: 0.450359970331192
The modified gen p mean: 0.4541317820549011, gen p mean: 0.0, mean p set: 0.44938161969184875
loss_pred:0.024432480335235596, decouple_loss:0.008132418617606163
loss_pred:0.02490607649087906, decouple_loss:0.008048269897699356
loss_pred:0.024464283138513565, decouple_loss:0.008255434222519398
Iteration: 2590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491514265537262, gen p mean: 0.0, mean p set: 0.44831863045692444
The modified gen p mean: 0.4460204541683197, gen p mean: 0.0, mean p set: 0.44816452264785767
The modified gen p mean: 0.4487082362174988, gen p mean: 0.0, mean p set: 0.4487801790237427
loss_pred:0.026355547830462456, decouple_loss:0.007925824262201786
loss_pred:0.02604145184159279, decouple_loss:0.008075022138655186
loss_pred:0.024456733837723732, decouple_loss:0.007882065139710903
2023-05-03 07:45:20 testing...
The modified gen p mean: 0.43810784816741943, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4459924101829529, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4430740475654602, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.027261091396212578, decouple_loss:0.008613868616521358
loss_pred:0.025877701118588448, decouple_loss:0.008707450702786446
loss_pred:0.026163341477513313, decouple_loss:0.008609883487224579
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026866232976317406, avg_mse: 0.032067716121673584
current test mse: 0.032068
Iteration: 2591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44421637058258057, gen p mean: 0.0, mean p set: 0.4490301311016083
loss_pred:0.024897495284676552, decouple_loss:0.007916956208646297
The modified gen p mean: 0.441455602645874, gen p mean: 0.0, mean p set: 0.44845086336135864
loss_pred:0.02624323219060898, decouple_loss:0.007896379567682743
The modified gen p mean: 0.4422219395637512, gen p mean: 0.0, mean p set: 0.4500495493412018
loss_pred:0.026128558441996574, decouple_loss:0.007905879989266396
Iteration: 2592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449081152677536, gen p mean: 0.0, mean p set: 0.4511880874633789
The modified gen p mean: 0.4471815526485443, gen p mean: 0.0, mean p set: 0.4497811496257782
The modified gen p mean: 0.4450094401836395, gen p mean: 0.0, mean p set: 0.4507721960544586
loss_pred:0.026203475892543793, decouple_loss:0.008318658918142319
loss_pred:0.02662525698542595, decouple_loss:0.007873959839344025
loss_pred:0.025689486414194107, decouple_loss:0.00798432994633913
Iteration: 2593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858911633491516, gen p mean: 0.0, mean p set: 0.450813353061676
The modified gen p mean: 0.4545307755470276, gen p mean: 0.0, mean p set: 0.4496253430843353
The modified gen p mean: 0.45535358786582947, gen p mean: 0.0, mean p set: 0.45058029890060425
loss_pred:0.02468794398009777, decouple_loss:0.007754414342343807
loss_pred:0.024850333109498024, decouple_loss:0.007674980442970991
loss_pred:0.0264515932649374, decouple_loss:0.008219887502491474
Iteration: 2594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481709897518158, gen p mean: 0.0, mean p set: 0.449349045753479
The modified gen p mean: 0.44973307847976685, gen p mean: 0.0, mean p set: 0.4504770338535309
The modified gen p mean: 0.4552602171897888, gen p mean: 0.0, mean p set: 0.44972777366638184
loss_pred:0.025814127177000046, decouple_loss:0.007860124111175537
loss_pred:0.024495821446180344, decouple_loss:0.007728562690317631
loss_pred:0.024943921715021133, decouple_loss:0.007598110008984804
Iteration: 2595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45341336727142334, gen p mean: 0.0, mean p set: 0.4498787224292755
The modified gen p mean: 0.446879118680954, gen p mean: 0.0, mean p set: 0.44963738322257996
The modified gen p mean: 0.44952818751335144, gen p mean: 0.0, mean p set: 0.45089972019195557
loss_pred:0.0246279239654541, decouple_loss:0.0077462042681872845
loss_pred:0.024708976969122887, decouple_loss:0.008116908371448517
loss_pred:0.025313373655080795, decouple_loss:0.007988347671926022
Iteration: 2596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44449546933174133, gen p mean: 0.0, mean p set: 0.4500916600227356
The modified gen p mean: 0.4432853162288666, gen p mean: 0.0, mean p set: 0.45079004764556885
The modified gen p mean: 0.4471418857574463, gen p mean: 0.0, mean p set: 0.4495586156845093
loss_pred:0.024726226925849915, decouple_loss:0.007831995375454426
loss_pred:0.024983663111925125, decouple_loss:0.007998129352927208
loss_pred:0.026435425505042076, decouple_loss:0.007855841889977455
Iteration: 2597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45410892367362976, gen p mean: 0.0, mean p set: 0.44911229610443115
The modified gen p mean: 0.45043519139289856, gen p mean: 0.0, mean p set: 0.4495590031147003
The modified gen p mean: 0.4521094560623169, gen p mean: 0.0, mean p set: 0.44821181893348694
loss_pred:0.02488534338772297, decouple_loss:0.007660211063921452
loss_pred:0.0255507193505764, decouple_loss:0.008183406665921211
loss_pred:0.024589622393250465, decouple_loss:0.007697709836065769
Iteration: 2598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450905978679657, gen p mean: 0.0, mean p set: 0.4484533667564392
The modified gen p mean: 0.4503704309463501, gen p mean: 0.0, mean p set: 0.45010754466056824
The modified gen p mean: 0.4487205147743225, gen p mean: 0.0, mean p set: 0.4493407607078552
loss_pred:0.026020431891083717, decouple_loss:0.007617926690727472
loss_pred:0.025504937395453453, decouple_loss:0.007540058344602585
loss_pred:0.025596916675567627, decouple_loss:0.00778260687366128
Iteration: 2599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527290463447571, gen p mean: 0.0, mean p set: 0.45041564106941223
The modified gen p mean: 0.4528079032897949, gen p mean: 0.0, mean p set: 0.45082634687423706
The modified gen p mean: 0.4509103000164032, gen p mean: 0.0, mean p set: 0.45131051540374756
loss_pred:0.025171194225549698, decouple_loss:0.007880372926592827
loss_pred:0.02504652924835682, decouple_loss:0.007758089806884527
loss_pred:0.026351384818553925, decouple_loss:0.007984563708305359
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
NaN value num: 0
Iteration: 2600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44476813077926636, gen p mean: 0.0, mean p set: 0.452203631401062
The modified gen p mean: 0.44235727190971375, gen p mean: 0.0, mean p set: 0.4498387575149536
The modified gen p mean: 0.44544708728790283, gen p mean: 0.0, mean p set: 0.4513210654258728
loss_pred:0.026571977883577347, decouple_loss:0.008432075381278992
loss_pred:0.02617436833679676, decouple_loss:0.007636409718543291
loss_pred:0.02644946612417698, decouple_loss:0.007956990972161293
2023-05-03 07:49:42 testing...
The modified gen p mean: 0.45002543926239014, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44522273540496826, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45282256603240967, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026019129902124405, decouple_loss:0.008379388600587845
loss_pred:0.027020303532481194, decouple_loss:0.008383184671401978
loss_pred:0.025720752775669098, decouple_loss:0.008418460376560688
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026673078536987305, avg_mse: 0.03189299255609512
current test mse: 0.031893
Iteration: 2601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45266082882881165, gen p mean: 0.0, mean p set: 0.4501630365848541
The modified gen p mean: 0.45046910643577576, gen p mean: 0.0, mean p set: 0.4502951502799988
loss_pred:0.02502095326781273, decouple_loss:0.007958569563925266
loss_pred:0.02521827258169651, decouple_loss:0.007566147483885288
The modified gen p mean: 0.45036816596984863, gen p mean: 0.0, mean p set: 0.4498836398124695
loss_pred:0.026028746739029884, decouple_loss:0.007952237501740456
Iteration: 2602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45685768127441406, gen p mean: 0.0, mean p set: 0.4497682452201843
The modified gen p mean: 0.459608793258667, gen p mean: 0.0, mean p set: 0.450778603553772
The modified gen p mean: 0.45761317014694214, gen p mean: 0.0, mean p set: 0.451905757188797
loss_pred:0.02621348202228546, decouple_loss:0.007673026528209448
loss_pred:0.026300493627786636, decouple_loss:0.007695745676755905
loss_pred:0.02579994685947895, decouple_loss:0.007798477075994015
Iteration: 2603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755131006240845, gen p mean: 0.0, mean p set: 0.45079872012138367
The modified gen p mean: 0.447873592376709, gen p mean: 0.0, mean p set: 0.4516623318195343
The modified gen p mean: 0.4503633975982666, gen p mean: 0.0, mean p set: 0.4513498842716217
loss_pred:0.02686150372028351, decouple_loss:0.008049680851399899
loss_pred:0.025136690586805344, decouple_loss:0.0075338478200137615
loss_pred:0.025091972202062607, decouple_loss:0.007861902937293053
Iteration: 2604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4402325749397278, gen p mean: 0.0, mean p set: 0.4515727162361145
The modified gen p mean: 0.43670397996902466, gen p mean: 0.0, mean p set: 0.45172062516212463
The modified gen p mean: 0.44202572107315063, gen p mean: 0.0, mean p set: 0.4507746696472168
loss_pred:0.025484958663582802, decouple_loss:0.007695966400206089
loss_pred:0.026907024905085564, decouple_loss:0.007832718081772327
loss_pred:0.02712305076420307, decouple_loss:0.007858122698962688
Iteration: 2605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4547309875488281, gen p mean: 0.0, mean p set: 0.4515630006790161
The modified gen p mean: 0.4541829228401184, gen p mean: 0.0, mean p set: 0.45010536909103394
The modified gen p mean: 0.4563514292240143, gen p mean: 0.0, mean p set: 0.44993916153907776
loss_pred:0.025239018723368645, decouple_loss:0.00739078875631094
loss_pred:0.02534244954586029, decouple_loss:0.0073226322419941425
loss_pred:0.025392116978764534, decouple_loss:0.007910403423011303
Iteration: 2606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4566344618797302, gen p mean: 0.0, mean p set: 0.4521428644657135
The modified gen p mean: 0.45772311091423035, gen p mean: 0.0, mean p set: 0.4504096210002899
loss_pred:0.02476056106388569, decouple_loss:0.007524152752012014
The modified gen p mean: 0.4546078145503998, gen p mean: 0.0, mean p set: 0.45135000348091125loss_pred:0.02613980509340763, decouple_loss:0.007957546971738338
loss_pred:0.02546457201242447, decouple_loss:0.008190563879907131
Iteration: 2607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889453053474426, gen p mean: 0.0, mean p set: 0.4522954225540161
The modified gen p mean: 0.45197540521621704, gen p mean: 0.0, mean p set: 0.4509831368923187
The modified gen p mean: 0.45271310210227966, gen p mean: 0.0, mean p set: 0.45166799426078796
loss_pred:0.025310449302196503, decouple_loss:0.008009925484657288
loss_pred:0.026550250127911568, decouple_loss:0.007906578481197357
loss_pred:0.025854840874671936, decouple_loss:0.007815010845661163
Iteration: 2608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485551416873932, gen p mean: 0.0, mean p set: 0.4520223140716553
The modified gen p mean: 0.44883036613464355, gen p mean: 0.0, mean p set: 0.45228299498558044
The modified gen p mean: 0.44674646854400635, gen p mean: 0.0, mean p set: 0.4502543807029724
loss_pred:0.02588488720357418, decouple_loss:0.0075927902944386005
loss_pred:0.0257208701223135, decouple_loss:0.007710584904998541
loss_pred:0.02699708193540573, decouple_loss:0.008006769232451916
Iteration: 2609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461624324321747, gen p mean: 0.0, mean p set: 0.45199474692344666
The modified gen p mean: 0.44724801182746887, gen p mean: 0.0, mean p set: 0.4525899887084961
The modified gen p mean: 0.447163462638855, gen p mean: 0.0, mean p set: 0.4532740116119385
loss_pred:0.02489674836397171, decouple_loss:0.007897323928773403
loss_pred:0.025102850049734116, decouple_loss:0.007705025374889374
loss_pred:0.025214966386556625, decouple_loss:0.00771360844373703
Iteration: 2610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4550340473651886, gen p mean: 0.0, mean p set: 0.452263742685318
The modified gen p mean: 0.4563737213611603, gen p mean: 0.0, mean p set: 0.4515514075756073
The modified gen p mean: 0.4536292552947998, gen p mean: 0.0, mean p set: 0.45147088170051575
loss_pred:0.025197261944413185, decouple_loss:0.007361775264143944
loss_pred:0.02650996670126915, decouple_loss:0.0077834040857851505
loss_pred:0.024946043267846107, decouple_loss:0.008044352754950523
2023-05-03 07:53:21 testing...
The modified gen p mean: 0.45356714725494385, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4486338198184967, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4561038315296173, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026129335165023804, decouple_loss:0.008259017020463943
loss_pred:0.02710636332631111, decouple_loss:0.008352802135050297
loss_pred:0.025782229378819466, decouple_loss:0.008334601297974586
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026755083352327347, avg_mse: 0.03199129179120064
current test mse: 0.031991
Iteration: 2611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45391082763671875, gen p mean: 0.0, mean p set: 0.449973464012146
The modified gen p mean: 0.45469605922698975, gen p mean: 0.0, mean p set: 0.45007672905921936
loss_pred:0.026119913905858994, decouple_loss:0.007699197623878717
loss_pred:0.025807902216911316, decouple_loss:0.007387015502899885
The modified gen p mean: 0.4579325318336487, gen p mean: 0.0, mean p set: 0.45418456196784973
loss_pred:0.025557981804013252, decouple_loss:0.00775125902146101
Iteration: 2612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468035101890564, gen p mean: 0.0, mean p set: 0.4525294005870819
The modified gen p mean: 0.4474216103553772, gen p mean: 0.0, mean p set: 0.4517904818058014
The modified gen p mean: 0.44761621952056885, gen p mean: 0.0, mean p set: 0.4509834945201874
loss_pred:0.025457613170146942, decouple_loss:0.00762300007045269
loss_pred:0.026607835665345192, decouple_loss:0.007743544410914183
loss_pred:0.02566838636994362, decouple_loss:0.00763738201931119
Iteration: 2613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018211007118225, gen p mean: 0.0, mean p set: 0.45361581444740295
The modified gen p mean: 0.4495601952075958, gen p mean: 0.0, mean p set: 0.45220157504081726
The modified gen p mean: 0.45150160789489746, gen p mean: 0.0, mean p set: 0.45082080364227295
loss_pred:0.02546650357544422, decouple_loss:0.008030850440263748
loss_pred:0.02508660778403282, decouple_loss:0.0074189770966768265
loss_pred:0.025037772953510284, decouple_loss:0.007854017429053783
Iteration: 2614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45144543051719666, gen p mean: 0.0, mean p set: 0.45251601934432983
The modified gen p mean: 0.4524042308330536, gen p mean: 0.0, mean p set: 0.4529906213283539
The modified gen p mean: 0.4475458860397339, gen p mean: 0.0, mean p set: 0.4509196877479553
loss_pred:0.02526020258665085, decouple_loss:0.007426402997225523
loss_pred:0.02512967586517334, decouple_loss:0.0075837355107069016
loss_pred:0.02600681781768799, decouple_loss:0.007899363525211811
Iteration: 2615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541996419429779, gen p mean: 0.0, mean p set: 0.45054367184638977
The modified gen p mean: 0.45705896615982056, gen p mean: 0.0, mean p set: 0.45029133558273315
The modified gen p mean: 0.4524238407611847, gen p mean: 0.0, mean p set: 0.4516597390174866
loss_pred:0.024704715237021446, decouple_loss:0.0073834797367453575
loss_pred:0.026556050404906273, decouple_loss:0.007493333425372839
loss_pred:0.024931367486715317, decouple_loss:0.007568245753645897
Iteration: 2616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505668878555298, gen p mean: 0.0, mean p set: 0.45241761207580566
The modified gen p mean: 0.451076477766037, gen p mean: 0.0, mean p set: 0.453868567943573
The modified gen p mean: 0.449156254529953, gen p mean: 0.0, mean p set: 0.4504365921020508
loss_pred:0.025615954771637917, decouple_loss:0.007268986664712429
loss_pred:0.02537108212709427, decouple_loss:0.00773098599165678
loss_pred:0.024965837597846985, decouple_loss:0.0075656636618077755
Iteration: 2617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45125502347946167, gen p mean: 0.0, mean p set: 0.45294854044914246
The modified gen p mean: 0.450532466173172, gen p mean: 0.0, mean p set: 0.4513280689716339
The modified gen p mean: 0.4514090120792389, gen p mean: 0.0, mean p set: 0.45101073384284973
loss_pred:0.02502833679318428, decouple_loss:0.007618417032063007
loss_pred:0.02495002932846546, decouple_loss:0.007486775051802397
loss_pred:0.026551607996225357, decouple_loss:0.007656151428818703
Iteration: 2618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44420722126960754, gen p mean: 0.0, mean p set: 0.4521483778953552
The modified gen p mean: 0.4508056342601776, gen p mean: 0.0, mean p set: 0.4522424042224884
The modified gen p mean: 0.45065340399742126, gen p mean: 0.0, mean p set: 0.4522706866264343
loss_pred:0.026381568983197212, decouple_loss:0.007751410361379385
loss_pred:0.02514473907649517, decouple_loss:0.0074070654809474945
loss_pred:0.02610122412443161, decouple_loss:0.007292196154594421
Iteration: 2619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519261121749878, gen p mean: 0.0, mean p set: 0.4503602981567383
The modified gen p mean: 0.45165300369262695, gen p mean: 0.0, mean p set: 0.44987794756889343
The modified gen p mean: 0.44591251015663147, gen p mean: 0.0, mean p set: 0.45190224051475525
loss_pred:0.02550695836544037, decouple_loss:0.007507902104407549
loss_pred:0.026000097393989563, decouple_loss:0.007813793607056141
loss_pred:0.026249608024954796, decouple_loss:0.007719175890088081
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
NaN value num: 0
Iteration: 2620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4590108394622803, gen p mean: 0.0, mean p set: 0.4513612687587738
The modified gen p mean: 0.45657655596733093, gen p mean: 0.0, mean p set: 0.45152872800827026The modified gen p mean: 0.457368403673172, gen p mean: 0.0, mean p set: 0.4513053894042969
loss_pred:0.02563912235200405, decouple_loss:0.007446317467838526loss_pred:0.02597794681787491, decouple_loss:0.007819627411663532
loss_pred:0.02614608034491539, decouple_loss:0.007948732934892178
2023-05-03 07:58:05 testing...
The modified gen p mean: 0.4484298527240753, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4432825744152069, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45109978318214417, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026055393740534782, decouple_loss:0.008017568849027157
loss_pred:0.02710026130080223, decouple_loss:0.008054337464272976
loss_pred:0.025699572637677193, decouple_loss:0.008040676824748516
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026686951518058777, avg_mse: 0.03200386092066765
current test mse: 0.032004
Iteration: 2621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512993097305298, gen p mean: 0.0, mean p set: 0.4508335292339325
The modified gen p mean: 0.4515073895454407, gen p mean: 0.0, mean p set: 0.45199018716812134
loss_pred:0.026129722595214844, decouple_loss:0.007474204059690237
loss_pred:0.025909150019288063, decouple_loss:0.007751767989248037
The modified gen p mean: 0.4513401389122009, gen p mean: 0.0, mean p set: 0.45048442482948303
loss_pred:0.026658082380890846, decouple_loss:0.007541855797171593
Iteration: 2622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720250368118286, gen p mean: 0.0, mean p set: 0.4511536657810211
The modified gen p mean: 0.44377821683883667, gen p mean: 0.0, mean p set: 0.4503689110279083
The modified gen p mean: 0.44741591811180115, gen p mean: 0.0, mean p set: 0.45139408111572266
loss_pred:0.025672243908047676, decouple_loss:0.007725329138338566
loss_pred:0.026910005137324333, decouple_loss:0.007893454283475876
loss_pred:0.026455115526914597, decouple_loss:0.007641481701284647
Iteration: 2623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494056701660156, gen p mean: 0.0, mean p set: 0.45083388686180115
The modified gen p mean: 0.4482748210430145, gen p mean: 0.0, mean p set: 0.45229944586753845
The modified gen p mean: 0.44578176736831665, gen p mean: 0.0, mean p set: 0.4509296715259552
loss_pred:0.026805005967617035, decouple_loss:0.007554223295301199
loss_pred:0.025784838944673538, decouple_loss:0.007258836179971695
loss_pred:0.027845317497849464, decouple_loss:0.0074859848245978355
Iteration: 2624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45264390110969543, gen p mean: 0.0, mean p set: 0.45218974351882935
The modified gen p mean: 0.4499915540218353, gen p mean: 0.0, mean p set: 0.4495851993560791
The modified gen p mean: 0.45068198442459106, gen p mean: 0.0, mean p set: 0.4520775377750397
loss_pred:0.026382414624094963, decouple_loss:0.007290493231266737
loss_pred:0.026452619582414627, decouple_loss:0.0074313124641776085
loss_pred:0.025327501818537712, decouple_loss:0.00748148700222373
Iteration: 2625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.457248330116272, gen p mean: 0.0, mean p set: 0.45176616311073303
The modified gen p mean: 0.4569888710975647, gen p mean: 0.0, mean p set: 0.4509739875793457
The modified gen p mean: 0.45794910192489624, gen p mean: 0.0, mean p set: 0.45139649510383606
loss_pred:0.02628513053059578, decouple_loss:0.0075696357525885105
loss_pred:0.026317693293094635, decouple_loss:0.007258164696395397
loss_pred:0.02730373665690422, decouple_loss:0.007557351142168045
Iteration: 2626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489833116531372, gen p mean: 0.0, mean p set: 0.4505757987499237
The modified gen p mean: 0.44877350330352783, gen p mean: 0.0, mean p set: 0.45300063490867615
The modified gen p mean: 0.4500266909599304, gen p mean: 0.0, mean p set: 0.4505978226661682
loss_pred:0.025664513930678368, decouple_loss:0.007448240183293819
loss_pred:0.025093285366892815, decouple_loss:0.007486594375222921
loss_pred:0.025710489600896835, decouple_loss:0.0072504556737840176
Iteration: 2627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478169083595276, gen p mean: 0.0, mean p set: 0.4523037374019623
The modified gen p mean: 0.4461217224597931, gen p mean: 0.0, mean p set: 0.45144134759902954
The modified gen p mean: 0.44373783469200134, gen p mean: 0.0, mean p set: 0.4511551260948181
loss_pred:0.02621886320412159, decouple_loss:0.007338554132729769
loss_pred:0.025995099917054176, decouple_loss:0.0075391908176243305
loss_pred:0.027617765590548515, decouple_loss:0.007473294157534838
Iteration: 2628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4548758566379547, gen p mean: 0.0, mean p set: 0.45208606123924255
The modified gen p mean: 0.4541065990924835, gen p mean: 0.0, mean p set: 0.45161738991737366
The modified gen p mean: 0.45412498712539673, gen p mean: 0.0, mean p set: 0.450858473777771
loss_pred:0.026753222569823265, decouple_loss:0.007518867962062359
loss_pred:0.025027191266417503, decouple_loss:0.007778608705848455
loss_pred:0.0267495047301054, decouple_loss:0.007303951308131218
Iteration: 2629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531775414943695, gen p mean: 0.0, mean p set: 0.45150595903396606
The modified gen p mean: 0.45459458231925964, gen p mean: 0.0, mean p set: 0.4518546462059021
The modified gen p mean: 0.45231154561042786, gen p mean: 0.0, mean p set: 0.4510516822338104
loss_pred:0.025643952190876007, decouple_loss:0.007459750398993492
loss_pred:0.025864925235509872, decouple_loss:0.0076352632604539394
loss_pred:0.025587426498532295, decouple_loss:0.0071178097277879715
Iteration: 2630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497829079627991, gen p mean: 0.0, mean p set: 0.4510355293750763
The modified gen p mean: 0.4473867416381836, gen p mean: 0.0, mean p set: 0.45063063502311707
The modified gen p mean: 0.4500329792499542, gen p mean: 0.0, mean p set: 0.45139533281326294
loss_pred:0.02575289085507393, decouple_loss:0.008137611672282219
loss_pred:0.025837324559688568, decouple_loss:0.007567342836409807
loss_pred:0.02586735226213932, decouple_loss:0.007365133613348007
2023-05-03 08:01:47 testing...
The modified gen p mean: 0.44094592332839966, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44865724444389343, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4459973871707916, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.026959776878356934, decouple_loss:0.0081586679443717
loss_pred:0.02566753886640072, decouple_loss:0.008175953291356564
loss_pred:0.025956813246011734, decouple_loss:0.008224895223975182
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02660403773188591, avg_mse: 0.03186808526515961
current test mse: 0.031868
Iteration: 2631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497512876987457, gen p mean: 0.0, mean p set: 0.4513244926929474
The modified gen p mean: 0.4477722942829132, gen p mean: 0.0, mean p set: 0.4516811966896057
loss_pred:0.026397649198770523, decouple_loss:0.007653462700545788
loss_pred:0.0258627962321043, decouple_loss:0.007942247204482555
The modified gen p mean: 0.4441711902618408, gen p mean: 0.0, mean p set: 0.450283020734787
loss_pred:0.025353258475661278, decouple_loss:0.0073556904681026936
Iteration: 2632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45310235023498535, gen p mean: 0.0, mean p set: 0.45135459303855896
The modified gen p mean: 0.44986164569854736, gen p mean: 0.0, mean p set: 0.4505697786808014
The modified gen p mean: 0.45621269941329956, gen p mean: 0.0, mean p set: 0.45141053199768066
loss_pred:0.025272727012634277, decouple_loss:0.007181168999522924
loss_pred:0.027623526751995087, decouple_loss:0.007364947348833084
loss_pred:0.027333838865160942, decouple_loss:0.007454248610883951
Iteration: 2633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45042291283607483, gen p mean: 0.0, mean p set: 0.4507925808429718
The modified gen p mean: 0.4518016576766968, gen p mean: 0.0, mean p set: 0.4511867165565491
The modified gen p mean: 0.45274102687835693, gen p mean: 0.0, mean p set: 0.4510705769062042
loss_pred:0.025665082037448883, decouple_loss:0.0071481927298009396
loss_pred:0.027129292488098145, decouple_loss:0.007502734661102295
loss_pred:0.025657350197434425, decouple_loss:0.007338165305554867
Iteration: 2634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45122143626213074, gen p mean: 0.0, mean p set: 0.4492678940296173
The modified gen p mean: 0.4482216238975525, gen p mean: 0.0, mean p set: 0.44927823543548584
The modified gen p mean: 0.45194265246391296, gen p mean: 0.0, mean p set: 0.4516315758228302
loss_pred:0.026355203241109848, decouple_loss:0.0072726053185760975
loss_pred:0.026642529293894768, decouple_loss:0.007318425457924604
loss_pred:0.02646033652126789, decouple_loss:0.007627945858985186
Iteration: 2635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469372034072876, gen p mean: 0.0, mean p set: 0.45259371399879456
The modified gen p mean: 0.44856560230255127, gen p mean: 0.0, mean p set: 0.4519176781177521
The modified gen p mean: 0.44500866532325745, gen p mean: 0.0, mean p set: 0.45128458738327026
loss_pred:0.025568494573235512, decouple_loss:0.00757491635158658
loss_pred:0.025706719607114792, decouple_loss:0.007609226740896702
loss_pred:0.027062132954597473, decouple_loss:0.007447466719895601
Iteration: 2636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472391605377197, gen p mean: 0.0, mean p set: 0.4507865309715271
The modified gen p mean: 0.4506872296333313, gen p mean: 0.0, mean p set: 0.4511035680770874
The modified gen p mean: 0.44576209783554077, gen p mean: 0.0, mean p set: 0.4505924582481384
loss_pred:0.025144366547465324, decouple_loss:0.007145414594560862
loss_pred:0.026637321338057518, decouple_loss:0.007492839824408293
loss_pred:0.025499720126390457, decouple_loss:0.007030408829450607
Iteration: 2637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4571366310119629, gen p mean: 0.0, mean p set: 0.4518486559391022
The modified gen p mean: 0.45872703194618225, gen p mean: 0.0, mean p set: 0.4513457417488098
The modified gen p mean: 0.45365726947784424, gen p mean: 0.0, mean p set: 0.4505743086338043
loss_pred:0.024735411629080772, decouple_loss:0.007487092167139053
loss_pred:0.027489040046930313, decouple_loss:0.007432638201862574
loss_pred:0.02662980742752552, decouple_loss:0.007103767711669207
Iteration: 2638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45295149087905884, gen p mean: 0.0, mean p set: 0.45265302062034607
The modified gen p mean: 0.4527024030685425, gen p mean: 0.0, mean p set: 0.4508259892463684
The modified gen p mean: 0.453538179397583, gen p mean: 0.0, mean p set: 0.45078244805336
loss_pred:0.025078443810343742, decouple_loss:0.007325335405766964
loss_pred:0.02517826296389103, decouple_loss:0.007099078502506018
loss_pred:0.025795910507440567, decouple_loss:0.007122531533241272
Iteration: 2639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4429245591163635, gen p mean: 0.0, mean p set: 0.4502687156200409
The modified gen p mean: 0.4466794431209564, gen p mean: 0.0, mean p set: 0.4512987732887268
The modified gen p mean: 0.44640475511550903, gen p mean: 0.0, mean p set: 0.45174556970596313
loss_pred:0.025218751281499863, decouple_loss:0.006772516295313835
loss_pred:0.025667961686849594, decouple_loss:0.007413312792778015
loss_pred:0.026585672050714493, decouple_loss:0.007163898088037968
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 2640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44516521692276, gen p mean: 0.0, mean p set: 0.44755110144615173
The modified gen p mean: 0.44454777240753174, gen p mean: 0.0, mean p set: 0.4482479691505432
The modified gen p mean: 0.4508702754974365, gen p mean: 0.0, mean p set: 0.44665804505348206
loss_pred:0.026098575443029404, decouple_loss:0.007964634336531162
loss_pred:0.025794710963964462, decouple_loss:0.008286615833640099
loss_pred:0.02653616853058338, decouple_loss:0.007936171256005764
2023-05-03 08:06:22 testing...
The modified gen p mean: 0.4478573203086853, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45273658633232117, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45554983615875244, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02696358785033226, decouple_loss:0.007902581244707108
loss_pred:0.02603728137910366, decouple_loss:0.007882775738835335
loss_pred:0.025713695213198662, decouple_loss:0.007870309986174107
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02663244865834713, avg_mse: 0.031911980360746384
current test mse: 0.031912
Iteration: 2641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501432180404663, gen p mean: 0.0, mean p set: 0.4487282633781433
The modified gen p mean: 0.44895994663238525, gen p mean: 0.0, mean p set: 0.4474853575229645
loss_pred:0.02631312794983387, decouple_loss:0.00783606804907322
loss_pred:0.024994615465402603, decouple_loss:0.007992512546479702
The modified gen p mean: 0.4496901035308838, gen p mean: 0.0, mean p set: 0.45018208026885986
loss_pred:0.024240028113126755, decouple_loss:0.0078831622377038
Iteration: 2642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878265261650085, gen p mean: 0.0, mean p set: 0.44860541820526123
The modified gen p mean: 0.4475592076778412, gen p mean: 0.0, mean p set: 0.44841471314430237
The modified gen p mean: 0.44992372393608093, gen p mean: 0.0, mean p set: 0.4484834671020508
loss_pred:0.026415657252073288, decouple_loss:0.007645494304597378
loss_pred:0.026649076491594315, decouple_loss:0.007647076155990362
loss_pred:0.025822144001722336, decouple_loss:0.007601943798363209
Iteration: 2643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486124813556671, gen p mean: 0.0, mean p set: 0.4480707347393036
The modified gen p mean: 0.4516368508338928, gen p mean: 0.0, mean p set: 0.44904476404190063
The modified gen p mean: 0.4494713544845581, gen p mean: 0.0, mean p set: 0.4488431215286255
loss_pred:0.02671952359378338, decouple_loss:0.008279153145849705
loss_pred:0.026100819930434227, decouple_loss:0.007421757094562054
loss_pred:0.02536846324801445, decouple_loss:0.008183345198631287
Iteration: 2644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4417054355144501, gen p mean: 0.0, mean p set: 0.44750893115997314
The modified gen p mean: 0.44738295674324036, gen p mean: 0.0, mean p set: 0.44726231694221497
The modified gen p mean: 0.44369322061538696, gen p mean: 0.0, mean p set: 0.44952166080474854
loss_pred:0.025457153096795082, decouple_loss:0.00773793226107955
loss_pred:0.027234837412834167, decouple_loss:0.007859131321310997
loss_pred:0.02546085976064205, decouple_loss:0.007995445281267166
Iteration: 2645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443044066429138, gen p mean: 0.0, mean p set: 0.44871997833251953
The modified gen p mean: 0.4432102143764496, gen p mean: 0.0, mean p set: 0.4489106833934784
The modified gen p mean: 0.44535696506500244, gen p mean: 0.0, mean p set: 0.4485693573951721
loss_pred:0.02509922906756401, decouple_loss:0.007792633958160877
loss_pred:0.02589067630469799, decouple_loss:0.008581898175179958
loss_pred:0.024860261008143425, decouple_loss:0.007824650965631008
Iteration: 2646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45412105321884155, gen p mean: 0.0, mean p set: 0.4476448595523834
The modified gen p mean: 0.4560796320438385, gen p mean: 0.0, mean p set: 0.4505683481693268
The modified gen p mean: 0.45698291063308716, gen p mean: 0.0, mean p set: 0.4500364065170288
loss_pred:0.026045674458146095, decouple_loss:0.007372845895588398
loss_pred:0.02436487004160881, decouple_loss:0.00755406403914094
loss_pred:0.024713387712836266, decouple_loss:0.007445857860147953
Iteration: 2647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493733048439026, gen p mean: 0.0, mean p set: 0.4477330446243286
The modified gen p mean: 0.44770458340644836, gen p mean: 0.0, mean p set: 0.44929543137550354
The modified gen p mean: 0.44941651821136475, gen p mean: 0.0, mean p set: 0.4473358392715454
loss_pred:0.02566547505557537, decouple_loss:0.007837836630642414loss_pred:0.025584731251001358, decouple_loss:0.0076957219280302525
loss_pred:0.02502143196761608, decouple_loss:0.007419159635901451
Iteration: 2648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44056904315948486, gen p mean: 0.0, mean p set: 0.448472261428833The modified gen p mean: 0.444579541683197, gen p mean: 0.0, mean p set: 0.4488097131252289
The modified gen p mean: 0.4400792121887207, gen p mean: 0.0, mean p set: 0.4473958909511566
loss_pred:0.025840861722826958, decouple_loss:0.0075222463347017765loss_pred:0.024899745360016823, decouple_loss:0.0073282732628285885
loss_pred:0.025782637298107147, decouple_loss:0.007675578817725182
Iteration: 2649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502694308757782, gen p mean: 0.0, mean p set: 0.447368323802948
The modified gen p mean: 0.45283040404319763, gen p mean: 0.0, mean p set: 0.4480155408382416
loss_pred:0.025846395641565323, decouple_loss:0.00755162863060832
The modified gen p mean: 0.4496821463108063, gen p mean: 0.0, mean p set: 0.4497232735157013
loss_pred:0.027178747579455376, decouple_loss:0.007802947890013456
loss_pred:0.024636557325720787, decouple_loss:0.007652503903955221
Iteration: 2650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500565826892853, gen p mean: 0.0, mean p set: 0.4487214982509613
The modified gen p mean: 0.4501068592071533, gen p mean: 0.0, mean p set: 0.44869574904441833
The modified gen p mean: 0.4510842561721802, gen p mean: 0.0, mean p set: 0.4481089115142822
loss_pred:0.02571282908320427, decouple_loss:0.0072863404639065266
loss_pred:0.02614538185298443, decouple_loss:0.007854432798922062
loss_pred:0.026190752163529396, decouple_loss:0.007961614057421684
2023-05-03 08:10:01 testing...
The modified gen p mean: 0.4427928924560547, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45042669773101807, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4476935863494873, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.026779904961586, decouple_loss:0.007760472130030394
loss_pred:0.025560759007930756, decouple_loss:0.007788278162479401
loss_pred:0.025805966928601265, decouple_loss:0.007653713691979647
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02643558382987976, avg_mse: 0.031591761857271194
current test mse: 0.031592
Iteration: 2651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44508931040763855, gen p mean: 0.0, mean p set: 0.4471263289451599
loss_pred:0.024968212470412254, decouple_loss:0.007552675902843475
The modified gen p mean: 0.4422444701194763, gen p mean: 0.0, mean p set: 0.4479025602340698
loss_pred:0.02495800331234932, decouple_loss:0.007339394651353359
The modified gen p mean: 0.4447251856327057, gen p mean: 0.0, mean p set: 0.4485537111759186
loss_pred:0.02675514854490757, decouple_loss:0.007810164708644152
Iteration: 2652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44539278745651245, gen p mean: 0.0, mean p set: 0.4488748610019684
The modified gen p mean: 0.4437578022480011, gen p mean: 0.0, mean p set: 0.4506426155567169
The modified gen p mean: 0.44588613510131836, gen p mean: 0.0, mean p set: 0.449665904045105
loss_pred:0.025802450254559517, decouple_loss:0.0082091074436903
loss_pred:0.02423466183245182, decouple_loss:0.008372468873858452
loss_pred:0.024317028000950813, decouple_loss:0.007558047771453857
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45681795477867126, gen p mean: 0.0, mean p set: 0.44900330901145935
The modified gen p mean: 0.4519796669483185, gen p mean: 0.0, mean p set: 0.4475356340408325
The modified gen p mean: 0.45319604873657227, gen p mean: 0.0, mean p set: 0.44819900393486023
loss_pred:0.024830959737300873, decouple_loss:0.007401614915579557
loss_pred:0.02521798387169838, decouple_loss:0.007693117950111628
loss_pred:0.025168143212795258, decouple_loss:0.007313126232475042
Iteration: 2654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44556838274002075, gen p mean: 0.0, mean p set: 0.4480571746826172
The modified gen p mean: 0.45142731070518494, gen p mean: 0.0, mean p set: 0.4481905400753021
The modified gen p mean: 0.4518842101097107, gen p mean: 0.0, mean p set: 0.4476125240325928
loss_pred:0.025602303445339203, decouple_loss:0.00753155117854476
loss_pred:0.025792833417654037, decouple_loss:0.007491676136851311
loss_pred:0.025502774864435196, decouple_loss:0.007709283847361803
Iteration: 2655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4419339597225189, gen p mean: 0.0, mean p set: 0.4485156238079071
The modified gen p mean: 0.4455673098564148, gen p mean: 0.0, mean p set: 0.4466237425804138
The modified gen p mean: 0.44253239035606384, gen p mean: 0.0, mean p set: 0.4481564164161682
loss_pred:0.024977872148156166, decouple_loss:0.007348106242716312
loss_pred:0.025327973067760468, decouple_loss:0.007895110175013542
loss_pred:0.02568487450480461, decouple_loss:0.007297945208847523
Iteration: 2656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501892924308777, gen p mean: 0.0, mean p set: 0.4486992359161377
The modified gen p mean: 0.44952285289764404, gen p mean: 0.0, mean p set: 0.4478845000267029
The modified gen p mean: 0.4522347152233124, gen p mean: 0.0, mean p set: 0.4468948543071747
loss_pred:0.02579164318740368, decouple_loss:0.007651083637028933
loss_pred:0.024786226451396942, decouple_loss:0.007420757785439491
loss_pred:0.024696292355656624, decouple_loss:0.00764109380543232
Iteration: 2657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44428563117980957, gen p mean: 0.0, mean p set: 0.4499242305755615
The modified gen p mean: 0.44622674584388733, gen p mean: 0.0, mean p set: 0.447110116481781
The modified gen p mean: 0.44374823570251465, gen p mean: 0.0, mean p set: 0.44832107424736023
loss_pred:0.024410875514149666, decouple_loss:0.007777272257953882
loss_pred:0.026492826640605927, decouple_loss:0.007397249806672335
loss_pred:0.026195891201496124, decouple_loss:0.007809563539922237
Iteration: 2658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44070184230804443, gen p mean: 0.0, mean p set: 0.4483180344104767
The modified gen p mean: 0.4456132650375366, gen p mean: 0.0, mean p set: 0.447309285402298
The modified gen p mean: 0.44442886114120483, gen p mean: 0.0, mean p set: 0.4490198791027069
loss_pred:0.026263024657964706, decouple_loss:0.007760105188935995
loss_pred:0.024584896862506866, decouple_loss:0.007375551853328943
loss_pred:0.025792671367526054, decouple_loss:0.007422019261866808
Iteration: 2659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4557904899120331, gen p mean: 0.0, mean p set: 0.4482649564743042
The modified gen p mean: 0.4584922194480896, gen p mean: 0.0, mean p set: 0.44636374711990356
The modified gen p mean: 0.4576563537120819, gen p mean: 0.0, mean p set: 0.44843170046806335
loss_pred:0.02545086294412613, decouple_loss:0.007398170419037342
loss_pred:0.02522948570549488, decouple_loss:0.007620261516422033
loss_pred:0.02470041811466217, decouple_loss:0.007285464555025101
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
NaN value num: 0
Iteration: 2660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4585011303424835, gen p mean: 0.0, mean p set: 0.4508790671825409
The modified gen p mean: 0.4565637409687042, gen p mean: 0.0, mean p set: 0.4515224099159241
The modified gen p mean: 0.45136570930480957, gen p mean: 0.0, mean p set: 0.4500034749507904
loss_pred:0.027137063443660736, decouple_loss:0.008732604794204235
loss_pred:0.02690351940691471, decouple_loss:0.008097157813608646
loss_pred:0.026483602821826935, decouple_loss:0.008142364211380482
2023-05-03 08:14:37 testing...
The modified gen p mean: 0.4345843493938446, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.43927496671676636, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4418714642524719, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026776965707540512, decouple_loss:0.007611366454511881
loss_pred:0.02573242597281933, decouple_loss:0.007463620509952307
loss_pred:0.02545192837715149, decouple_loss:0.007649013306945562
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026365838944911957, avg_mse: 0.03151223435997963
current test mse: 0.031512
Iteration: 2661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466659426689148, gen p mean: 0.0, mean p set: 0.45027193427085876
The modified gen p mean: 0.44389817118644714, gen p mean: 0.0, mean p set: 0.45200514793395996
loss_pred:0.026569748297333717, decouple_loss:0.008254039101302624
loss_pred:0.02609870955348015, decouple_loss:0.008201707154512405
The modified gen p mean: 0.4428049623966217, gen p mean: 0.0, mean p set: 0.44922736287117004
loss_pred:0.026691744104027748, decouple_loss:0.008685899898409843
Iteration: 2662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44004565477371216, gen p mean: 0.0, mean p set: 0.44954198598861694
The modified gen p mean: 0.44307711720466614, gen p mean: 0.0, mean p set: 0.44904735684394836
The modified gen p mean: 0.44282588362693787, gen p mean: 0.0, mean p set: 0.45227932929992676
loss_pred:0.026132948696613312, decouple_loss:0.007969417609274387
loss_pred:0.024710407480597496, decouple_loss:0.007690551225095987
loss_pred:0.02676956169307232, decouple_loss:0.008532672189176083
Iteration: 2663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519895315170288, gen p mean: 0.0, mean p set: 0.4495026767253876
The modified gen p mean: 0.4528917968273163, gen p mean: 0.0, mean p set: 0.45253291726112366
The modified gen p mean: 0.44925081729888916, gen p mean: 0.0, mean p set: 0.450647234916687
loss_pred:0.02472495846450329, decouple_loss:0.007603690959513187
loss_pred:0.025743599981069565, decouple_loss:0.008548812009394169
loss_pred:0.02597888372838497, decouple_loss:0.007827876135706902
Iteration: 2664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4601227343082428, gen p mean: 0.0, mean p set: 0.45171138644218445
The modified gen p mean: 0.4573941230773926, gen p mean: 0.0, mean p set: 0.4523826837539673
The modified gen p mean: 0.4588146507740021, gen p mean: 0.0, mean p set: 0.45227181911468506
loss_pred:0.02616625279188156, decouple_loss:0.008087954483926296
loss_pred:0.02530617080628872, decouple_loss:0.008465448394417763
loss_pred:0.026259195059537888, decouple_loss:0.008325699716806412
Iteration: 2665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477037191390991, gen p mean: 0.0, mean p set: 0.45084765553474426
The modified gen p mean: 0.44664645195007324, gen p mean: 0.0, mean p set: 0.4498482048511505
The modified gen p mean: 0.4486645758152008, gen p mean: 0.0, mean p set: 0.44908010959625244
loss_pred:0.025064589455723763, decouple_loss:0.007876524701714516
loss_pred:0.02604653500020504, decouple_loss:0.008015824481844902
loss_pred:0.026105759665369987, decouple_loss:0.008088456466794014
Iteration: 2666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790181517601013, gen p mean: 0.0, mean p set: 0.4527186155319214
The modified gen p mean: 0.44312784075737, gen p mean: 0.0, mean p set: 0.44988757371902466
The modified gen p mean: 0.4503069221973419, gen p mean: 0.0, mean p set: 0.4531742036342621
loss_pred:0.025671593844890594, decouple_loss:0.008032509125769138
loss_pred:0.02480252832174301, decouple_loss:0.008416794240474701
loss_pred:0.026391884312033653, decouple_loss:0.00812890287488699
Iteration: 2667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531342089176178, gen p mean: 0.0, mean p set: 0.4497041702270508
The modified gen p mean: 0.45107460021972656, gen p mean: 0.0, mean p set: 0.44988515973091125
The modified gen p mean: 0.45190903544425964, gen p mean: 0.0, mean p set: 0.4509873688220978
loss_pred:0.02522064372897148, decouple_loss:0.007716273423284292
loss_pred:0.02601342648267746, decouple_loss:0.007907514460384846
loss_pred:0.025485746562480927, decouple_loss:0.00765483221039176
Iteration: 2668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45256704092025757, gen p mean: 0.0, mean p set: 0.4494488537311554
The modified gen p mean: 0.45005860924720764, gen p mean: 0.0, mean p set: 0.45008331537246704
The modified gen p mean: 0.4579552710056305, gen p mean: 0.0, mean p set: 0.4525914490222931
loss_pred:0.024939246475696564, decouple_loss:0.007347394246608019
loss_pred:0.025515863671898842, decouple_loss:0.007946035824716091
loss_pred:0.026389775797724724, decouple_loss:0.007661366835236549
Iteration: 2669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458501636981964, gen p mean: 0.0, mean p set: 0.4508911669254303
The modified gen p mean: 0.44797077775001526, gen p mean: 0.0, mean p set: 0.44910362362861633
loss_pred:0.02593126893043518, decouple_loss:0.00792662613093853
The modified gen p mean: 0.44407039880752563, gen p mean: 0.0, mean p set: 0.4497282803058624
loss_pred:0.02524152770638466, decouple_loss:0.007415668107569218
loss_pred:0.025552015751600266, decouple_loss:0.00769464299082756
Iteration: 2670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4559832215309143, gen p mean: 0.0, mean p set: 0.45089030265808105
The modified gen p mean: 0.453891783952713, gen p mean: 0.0, mean p set: 0.45189690589904785
The modified gen p mean: 0.45303329825401306, gen p mean: 0.0, mean p set: 0.4519574046134949
loss_pred:0.026944978162646294, decouple_loss:0.007821525447070599
loss_pred:0.02497696503996849, decouple_loss:0.00771856214851141
loss_pred:0.026038017123937607, decouple_loss:0.007543678395450115
2023-05-03 08:18:19 testing...
The modified gen p mean: 0.4384706914424896, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4460656940937042, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4432947635650635, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02701912634074688, decouple_loss:0.008365561254322529
loss_pred:0.02556859515607357, decouple_loss:0.008145147934556007
loss_pred:0.025968337431550026, decouple_loss:0.008178171701729298
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026596834883093834, avg_mse: 0.03188273310661316
current test mse: 0.031883
Iteration: 2671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453979730606079, gen p mean: 0.0, mean p set: 0.4505097270011902
loss_pred:0.025497056543827057, decouple_loss:0.007755831349641085
The modified gen p mean: 0.4514404535293579, gen p mean: 0.0, mean p set: 0.4514676034450531
loss_pred:0.026440907269716263, decouple_loss:0.007730511017143726
The modified gen p mean: 0.4504874348640442, gen p mean: 0.0, mean p set: 0.4500472843647003
loss_pred:0.026043247431516647, decouple_loss:0.007795928977429867
Iteration: 2672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881346821784973, gen p mean: 0.0, mean p set: 0.45156344771385193The modified gen p mean: 0.4511793255805969, gen p mean: 0.0, mean p set: 0.45348381996154785
The modified gen p mean: 0.44063493609428406, gen p mean: 0.0, mean p set: 0.4503830373287201
loss_pred:0.025400623679161072, decouple_loss:0.007541488856077194
loss_pred:0.02624104730784893, decouple_loss:0.0075662885792553425
loss_pred:0.02453366480767727, decouple_loss:0.0076772673055529594
Iteration: 2673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489230215549469, gen p mean: 0.0, mean p set: 0.45094096660614014
The modified gen p mean: 0.45952171087265015, gen p mean: 0.0, mean p set: 0.45286887884140015
The modified gen p mean: 0.45004260540008545, gen p mean: 0.0, mean p set: 0.4495048522949219
loss_pred:0.024931680411100388, decouple_loss:0.007497729733586311
loss_pred:0.02506265603005886, decouple_loss:0.008142967708408833
loss_pred:0.02588813565671444, decouple_loss:0.007770810276269913
Iteration: 2674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526909589767456, gen p mean: 0.0, mean p set: 0.4504542350769043
The modified gen p mean: 0.45488911867141724, gen p mean: 0.0, mean p set: 0.44988009333610535
The modified gen p mean: 0.4570351541042328, gen p mean: 0.0, mean p set: 0.45228907465934753
loss_pred:0.025606989860534668, decouple_loss:0.007549649104475975
loss_pred:0.024560829624533653, decouple_loss:0.0074109723791480064
loss_pred:0.02567017264664173, decouple_loss:0.00790130440145731
Iteration: 2675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44478639960289, gen p mean: 0.0, mean p set: 0.45006799697875977
The modified gen p mean: 0.44852665066719055, gen p mean: 0.0, mean p set: 0.45194414258003235
The modified gen p mean: 0.44710829854011536, gen p mean: 0.0, mean p set: 0.4524949789047241
loss_pred:0.024691877886652946, decouple_loss:0.007368679158389568
loss_pred:0.025923922657966614, decouple_loss:0.007520617917180061
loss_pred:0.0253283828496933, decouple_loss:0.008007354103028774
Iteration: 2676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4549752175807953, gen p mean: 0.0, mean p set: 0.450985848903656
The modified gen p mean: 0.45439422130584717, gen p mean: 0.0, mean p set: 0.45023199915885925
The modified gen p mean: 0.46074363589286804, gen p mean: 0.0, mean p set: 0.45013532042503357
loss_pred:0.025255070999264717, decouple_loss:0.007182254455983639
loss_pred:0.02511257492005825, decouple_loss:0.007210300303995609
loss_pred:0.027095239609479904, decouple_loss:0.007679069880396128
Iteration: 2677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45082494616508484, gen p mean: 0.0, mean p set: 0.4493463933467865
The modified gen p mean: 0.4481048882007599, gen p mean: 0.0, mean p set: 0.45107173919677734
The modified gen p mean: 0.4525669813156128, gen p mean: 0.0, mean p set: 0.45282456278800964
loss_pred:0.027309691533446312, decouple_loss:0.0075484081171453
loss_pred:0.02577490545809269, decouple_loss:0.0071038189344108105
loss_pred:0.026095425710082054, decouple_loss:0.007451135665178299
Iteration: 2678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4404936730861664, gen p mean: 0.0, mean p set: 0.45011085271835327The modified gen p mean: 0.4410024881362915, gen p mean: 0.0, mean p set: 0.44935014843940735
The modified gen p mean: 0.4432082772254944, gen p mean: 0.0, mean p set: 0.45068594813346863
loss_pred:0.026037540286779404, decouple_loss:0.007260160055011511
loss_pred:0.024072885513305664, decouple_loss:0.007037636823952198
loss_pred:0.02583715319633484, decouple_loss:0.007139734923839569
Iteration: 2679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45259732007980347, gen p mean: 0.0, mean p set: 0.45232194662094116
The modified gen p mean: 0.45227888226509094, gen p mean: 0.0, mean p set: 0.4500887989997864
The modified gen p mean: 0.4544112980365753, gen p mean: 0.0, mean p set: 0.4504234194755554
loss_pred:0.02606985531747341, decouple_loss:0.007378467824310064
loss_pred:0.02583097480237484, decouple_loss:0.0069552757777273655
loss_pred:0.027138106524944305, decouple_loss:0.007333984598517418
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 2680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475841522216797, gen p mean: 0.0, mean p set: 0.44779494404792786
The modified gen p mean: 0.4452437162399292, gen p mean: 0.0, mean p set: 0.4468752145767212
The modified gen p mean: 0.44734323024749756, gen p mean: 0.0, mean p set: 0.4478980302810669
loss_pred:0.02566141076385975, decouple_loss:0.008302407339215279
loss_pred:0.02584126591682434, decouple_loss:0.00817316584289074
loss_pred:0.026651205494999886, decouple_loss:0.00820840522646904
2023-05-03 08:22:57 testing...
The modified gen p mean: 0.4413996636867523, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44936248660087585, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4464239478111267, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.026828421279788017, decouple_loss:0.00816524401307106
loss_pred:0.02550712786614895, decouple_loss:0.007871908135712147
loss_pred:0.025819774717092514, decouple_loss:0.007854283787310123
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026449967175722122, avg_mse: 0.03170434758067131
current test mse: 0.031704
Iteration: 2681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622156023979187, gen p mean: 0.0, mean p set: 0.4469371736049652
The modified gen p mean: 0.4459119737148285, gen p mean: 0.0, mean p set: 0.4477405250072479
loss_pred:0.025732465088367462, decouple_loss:0.008059562183916569
loss_pred:0.025669265538454056, decouple_loss:0.00790676660835743
The modified gen p mean: 0.44463324546813965, gen p mean: 0.0, mean p set: 0.44820359349250793
loss_pred:0.02581523358821869, decouple_loss:0.00806367676705122
Iteration: 2682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074987411499023, gen p mean: 0.0, mean p set: 0.4481947124004364
The modified gen p mean: 0.45367300510406494, gen p mean: 0.0, mean p set: 0.4485294818878174
The modified gen p mean: 0.44995102286338806, gen p mean: 0.0, mean p set: 0.4468367099761963
loss_pred:0.0270300954580307, decouple_loss:0.00768498657271266
loss_pred:0.027018418535590172, decouple_loss:0.007492057513445616
loss_pred:0.02593054063618183, decouple_loss:0.007727835793048143
Iteration: 2683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859081506729126, gen p mean: 0.0, mean p set: 0.44746798276901245The modified gen p mean: 0.4522182047367096, gen p mean: 0.0, mean p set: 0.4477635622024536
The modified gen p mean: 0.4481991231441498, gen p mean: 0.0, mean p set: 0.44663766026496887
loss_pred:0.02593911625444889, decouple_loss:0.007917280308902264
loss_pred:0.02552267350256443, decouple_loss:0.007642167620360851
loss_pred:0.0256053376942873, decouple_loss:0.007738164626061916
Iteration: 2684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43708863854408264, gen p mean: 0.0, mean p set: 0.4466695487499237
The modified gen p mean: 0.4411671459674835, gen p mean: 0.0, mean p set: 0.4477180242538452
The modified gen p mean: 0.43200618028640747, gen p mean: 0.0, mean p set: 0.447569340467453
loss_pred:0.026163671165704727, decouple_loss:0.007612917106598616
loss_pred:0.027162877842783928, decouple_loss:0.00751302158460021
loss_pred:0.02610096149146557, decouple_loss:0.008049185387790203
Iteration: 2685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472050666809082, gen p mean: 0.0, mean p set: 0.44742920994758606
The modified gen p mean: 0.44218459725379944, gen p mean: 0.0, mean p set: 0.4474208950996399
The modified gen p mean: 0.4460904002189636, gen p mean: 0.0, mean p set: 0.4474751055240631
loss_pred:0.025829676538705826, decouple_loss:0.007906084880232811
loss_pred:0.025605881586670876, decouple_loss:0.007717431522905827
loss_pred:0.02512912079691887, decouple_loss:0.007553424220532179
Iteration: 2686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4618028998374939, gen p mean: 0.0, mean p set: 0.44805875420570374
The modified gen p mean: 0.4578719437122345, gen p mean: 0.0, mean p set: 0.44777578115463257
The modified gen p mean: 0.45779186487197876, gen p mean: 0.0, mean p set: 0.4476166069507599
loss_pred:0.02541789785027504, decouple_loss:0.007712989579886198
loss_pred:0.02534490078687668, decouple_loss:0.007810218725353479
loss_pred:0.025571288540959358, decouple_loss:0.007781236432492733
Iteration: 2687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.441983699798584, gen p mean: 0.0, mean p set: 0.44709208607673645
The modified gen p mean: 0.44761788845062256, gen p mean: 0.0, mean p set: 0.44762900471687317
The modified gen p mean: 0.4433321952819824, gen p mean: 0.0, mean p set: 0.44808676838874817
loss_pred:0.025751261040568352, decouple_loss:0.007733466569334269
loss_pred:0.02538788877427578, decouple_loss:0.007581217680126429
loss_pred:0.025248413905501366, decouple_loss:0.007479915861040354
Iteration: 2688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068058371543884, gen p mean: 0.0, mean p set: 0.4489504396915436
The modified gen p mean: 0.4467275142669678, gen p mean: 0.0, mean p set: 0.44699984788894653
The modified gen p mean: 0.4483407437801361, gen p mean: 0.0, mean p set: 0.4464336037635803
loss_pred:0.026388950645923615, decouple_loss:0.007296760566532612
loss_pred:0.02590630203485489, decouple_loss:0.007526425179094076
loss_pred:0.025669638067483902, decouple_loss:0.007514467462897301
Iteration: 2689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794410467147827, gen p mean: 0.0, mean p set: 0.44783106446266174
The modified gen p mean: 0.4451707601547241, gen p mean: 0.0, mean p set: 0.44719216227531433
The modified gen p mean: 0.44448328018188477, gen p mean: 0.0, mean p set: 0.4478742182254791
loss_pred:0.025232350453734398, decouple_loss:0.007259484380483627
loss_pred:0.02524956688284874, decouple_loss:0.007342278957366943
loss_pred:0.02666863426566124, decouple_loss:0.008044295944273472
Iteration: 2690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44210609793663025, gen p mean: 0.0, mean p set: 0.44803011417388916
The modified gen p mean: 0.4359705150127411, gen p mean: 0.0, mean p set: 0.44953420758247375
The modified gen p mean: 0.4399634897708893, gen p mean: 0.0, mean p set: 0.4478749632835388
loss_pred:0.027661867439746857, decouple_loss:0.007902326993644238
loss_pred:0.026159996166825294, decouple_loss:0.008403437212109566
loss_pred:0.025291576981544495, decouple_loss:0.007267537526786327
2023-05-03 08:26:40 testing...
The modified gen p mean: 0.4542009234428406, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4496682286262512, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45693841576576233, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.025841381400823593, decouple_loss:0.007673877291381359
loss_pred:0.026851588860154152, decouple_loss:0.007836847566068172
loss_pred:0.02556324005126953, decouple_loss:0.007688672747462988
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02647206000983715, avg_mse: 0.03180000185966492
current test mse: 0.0318
Iteration: 2691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522174000740051, gen p mean: 0.0, mean p set: 0.44606053829193115
The modified gen p mean: 0.4530275762081146, gen p mean: 0.0, mean p set: 0.44769227504730225
loss_pred:0.024454224854707718, decouple_loss:0.0074508339166641235
loss_pred:0.02519221045076847, decouple_loss:0.007568602450191975
The modified gen p mean: 0.45609691739082336, gen p mean: 0.0, mean p set: 0.4480101466178894
loss_pred:0.025452636182308197, decouple_loss:0.0071626449935138226
Iteration: 2692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45552530884742737, gen p mean: 0.0, mean p set: 0.4478749930858612
The modified gen p mean: 0.4526068866252899, gen p mean: 0.0, mean p set: 0.4475148916244507
The modified gen p mean: 0.4514801800251007, gen p mean: 0.0, mean p set: 0.44729119539260864
loss_pred:0.025841880589723587, decouple_loss:0.007491271942853928
loss_pred:0.02511136792600155, decouple_loss:0.007640422321856022
loss_pred:0.025152476504445076, decouple_loss:0.007595325820147991
Iteration: 2693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44167760014533997, gen p mean: 0.0, mean p set: 0.448160856962204
The modified gen p mean: 0.4415316581726074, gen p mean: 0.0, mean p set: 0.448152095079422
The modified gen p mean: 0.4401000440120697, gen p mean: 0.0, mean p set: 0.44788476824760437
loss_pred:0.026082279160618782, decouple_loss:0.007565256208181381
loss_pred:0.02552073448896408, decouple_loss:0.0074480134062469006
loss_pred:0.024480286985635757, decouple_loss:0.007515283767133951
Iteration: 2694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44635844230651855, gen p mean: 0.0, mean p set: 0.44834375381469727
The modified gen p mean: 0.4459943175315857, gen p mean: 0.0, mean p set: 0.44762122631073
The modified gen p mean: 0.44347167015075684, gen p mean: 0.0, mean p set: 0.44780099391937256
loss_pred:0.02724193036556244, decouple_loss:0.007755321450531483
loss_pred:0.025397339835762978, decouple_loss:0.0073464964516460896
loss_pred:0.025150418281555176, decouple_loss:0.007366481237113476
Iteration: 2695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46092429757118225, gen p mean: 0.0, mean p set: 0.44742998480796814
The modified gen p mean: 0.44966527819633484, gen p mean: 0.0, mean p set: 0.44990822672843933
The modified gen p mean: 0.4538176655769348, gen p mean: 0.0, mean p set: 0.44701457023620605
loss_pred:0.027573995292186737, decouple_loss:0.007949317805469036
loss_pred:0.02594652771949768, decouple_loss:0.00834924727678299
loss_pred:0.025655271485447884, decouple_loss:0.007453600410372019
Iteration: 2696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664180278778076, gen p mean: 0.0, mean p set: 0.4466399550437927
The modified gen p mean: 0.44051650166511536, gen p mean: 0.0, mean p set: 0.44896718859672546
The modified gen p mean: 0.44591936469078064, gen p mean: 0.0, mean p set: 0.4477160573005676
loss_pred:0.02562534436583519, decouple_loss:0.0073623377829790115
loss_pred:0.025795355439186096, decouple_loss:0.007813085801899433
loss_pred:0.025315141305327415, decouple_loss:0.0072822957299649715
Iteration: 2697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458394944667816, gen p mean: 0.0, mean p set: 0.447546124458313
The modified gen p mean: 0.4373590648174286, gen p mean: 0.0, mean p set: 0.4461626410484314
The modified gen p mean: 0.4402211606502533, gen p mean: 0.0, mean p set: 0.44765612483024597
loss_pred:0.02739233896136284, decouple_loss:0.007283089682459831
loss_pred:0.024425694718956947, decouple_loss:0.00746625242754817
loss_pred:0.025479260832071304, decouple_loss:0.007509222719818354
Iteration: 2698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493008852005005, gen p mean: 0.0, mean p set: 0.448373407125473
The modified gen p mean: 0.44993171095848083, gen p mean: 0.0, mean p set: 0.44670340418815613
The modified gen p mean: 0.4532422423362732, gen p mean: 0.0, mean p set: 0.44807007908821106
loss_pred:0.025888187810778618, decouple_loss:0.007511831820011139
loss_pred:0.02490931935608387, decouple_loss:0.007167669478803873
loss_pred:0.025619186460971832, decouple_loss:0.007137425243854523
Iteration: 2699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45062682032585144, gen p mean: 0.0, mean p set: 0.44820722937583923
The modified gen p mean: 0.44861021637916565, gen p mean: 0.0, mean p set: 0.44723597168922424
The modified gen p mean: 0.44696325063705444, gen p mean: 0.0, mean p set: 0.4488895833492279
loss_pred:0.026462653651833534, decouple_loss:0.007375624030828476
loss_pred:0.02565164864063263, decouple_loss:0.007320932112634182
loss_pred:0.025909509509801865, decouple_loss:0.007900955155491829
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
NaN value num: 0
Iteration: 2700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999244213104, gen p mean: 0.0, mean p set: 0.44908249378204346
The modified gen p mean: 0.44492873549461365, gen p mean: 0.0, mean p set: 0.44682982563972473
The modified gen p mean: 0.44352373480796814, gen p mean: 0.0, mean p set: 0.447992742061615
loss_pred:0.02508927695453167, decouple_loss:0.007327836938202381
loss_pred:0.027779245749115944, decouple_loss:0.00781730655580759
loss_pred:0.026646923273801804, decouple_loss:0.00818781927227974
2023-05-03 08:31:29 testing...
The modified gen p mean: 0.4488750100135803, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4559885859489441, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.45351269841194153, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02671216055750847, decouple_loss:0.007782192900776863
loss_pred:0.02555549331009388, decouple_loss:0.007579553872346878
loss_pred:0.02575615607202053, decouple_loss:0.007549305912107229
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02638978883624077, avg_mse: 0.03170859441161156
current test mse: 0.031709
Iteration: 2701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495101571083069, gen p mean: 0.0, mean p set: 0.4473554790019989
The modified gen p mean: 0.45183494687080383, gen p mean: 0.0, mean p set: 0.44717806577682495
loss_pred:0.025404158979654312, decouple_loss:0.00709952088072896
loss_pred:0.027227263897657394, decouple_loss:0.007204368244856596
The modified gen p mean: 0.45345139503479004, gen p mean: 0.0, mean p set: 0.44754326343536377
loss_pred:0.026624085381627083, decouple_loss:0.007279196288436651
Iteration: 2702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44509580731391907, gen p mean: 0.0, mean p set: 0.4485495090484619
The modified gen p mean: 0.4484280049800873, gen p mean: 0.0, mean p set: 0.446774959564209
The modified gen p mean: 0.44432899355888367, gen p mean: 0.0, mean p set: 0.44934606552124023
loss_pred:0.028321396559476852, decouple_loss:0.007329324260354042
loss_pred:0.026692667976021767, decouple_loss:0.007071344647556543
loss_pred:0.027461744844913483, decouple_loss:0.007725224830210209
Iteration: 2703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44332727789878845, gen p mean: 0.0, mean p set: 0.4481232166290283
The modified gen p mean: 0.4420645534992218, gen p mean: 0.0, mean p set: 0.4484272003173828
The modified gen p mean: 0.4437442719936371, gen p mean: 0.0, mean p set: 0.44805458188056946
loss_pred:0.025353675708174706, decouple_loss:0.007047906052321196
loss_pred:0.027807680889964104, decouple_loss:0.00743653392419219
loss_pred:0.025179503485560417, decouple_loss:0.007035369984805584
Iteration: 2704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046815276145935, gen p mean: 0.0, mean p set: 0.4468069076538086
The modified gen p mean: 0.4531903564929962, gen p mean: 0.0, mean p set: 0.44743403792381287
The modified gen p mean: 0.4556177854537964, gen p mean: 0.0, mean p set: 0.44837686419487
loss_pred:0.02550429105758667, decouple_loss:0.0070840404368937016
loss_pred:0.02817622758448124, decouple_loss:0.007365304511040449
loss_pred:0.02769310399889946, decouple_loss:0.007225641515105963
Iteration: 2705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493040144443512, gen p mean: 0.0, mean p set: 0.4467964172363281
The modified gen p mean: 0.4516018331050873, gen p mean: 0.0, mean p set: 0.44778236746788025
The modified gen p mean: 0.4525074362754822, gen p mean: 0.0, mean p set: 0.4482615292072296
loss_pred:0.026161884889006615, decouple_loss:0.007515192497521639
loss_pred:0.02686244435608387, decouple_loss:0.007198723964393139
loss_pred:0.026778988540172577, decouple_loss:0.007106657139956951
Iteration: 2706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4368349611759186, gen p mean: 0.0, mean p set: 0.447386234998703
The modified gen p mean: 0.44000619649887085, gen p mean: 0.0, mean p set: 0.4473304748535156
The modified gen p mean: 0.4399777352809906, gen p mean: 0.0, mean p set: 0.44745010137557983
loss_pred:0.02608993463218212, decouple_loss:0.00734988646581769
loss_pred:0.026563990861177444, decouple_loss:0.007024961058050394
loss_pred:0.028422480449080467, decouple_loss:0.007223382592201233
Iteration: 2707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44285905361175537, gen p mean: 0.0, mean p set: 0.4495777189731598The modified gen p mean: 0.4496252238750458, gen p mean: 0.0, mean p set: 0.44843971729278564
The modified gen p mean: 0.44875460863113403, gen p mean: 0.0, mean p set: 0.4474692642688751
loss_pred:0.026732418686151505, decouple_loss:0.007004135753959417loss_pred:0.027128221467137337, decouple_loss:0.007457634899765253
loss_pred:0.027702366933226585, decouple_loss:0.0069979410618543625
Iteration: 2708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4579758942127228, gen p mean: 0.0, mean p set: 0.4480714499950409
The modified gen p mean: 0.4498549699783325, gen p mean: 0.0, mean p set: 0.4473590552806854
The modified gen p mean: 0.4566594958305359, gen p mean: 0.0, mean p set: 0.44841399788856506
loss_pred:0.026379209011793137, decouple_loss:0.006981377024203539
loss_pred:0.026045458391308784, decouple_loss:0.007085392717272043
loss_pred:0.026943448930978775, decouple_loss:0.007312936708331108
Iteration: 2709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44691002368927, gen p mean: 0.0, mean p set: 0.44811463356018066
The modified gen p mean: 0.44428858160972595, gen p mean: 0.0, mean p set: 0.44907209277153015
The modified gen p mean: 0.4467514753341675, gen p mean: 0.0, mean p set: 0.44816598296165466
loss_pred:0.027624089270830154, decouple_loss:0.0067457775585353374
loss_pred:0.02692851983010769, decouple_loss:0.00722212390974164
loss_pred:0.027657639235258102, decouple_loss:0.006948619149625301
Iteration: 2710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4391843378543854, gen p mean: 0.0, mean p set: 0.44910722970962524
The modified gen p mean: 0.4405064880847931, gen p mean: 0.0, mean p set: 0.4489823877811432
The modified gen p mean: 0.44114312529563904, gen p mean: 0.0, mean p set: 0.4470786452293396
loss_pred:0.026189696043729782, decouple_loss:0.007521295920014381
loss_pred:0.026529742404818535, decouple_loss:0.007425105199217796
loss_pred:0.026730181649327278, decouple_loss:0.006890512071549892
2023-05-03 08:35:09 testing...
The modified gen p mean: 0.4515199661254883, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45613929629325867, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45830264687538147, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026815541088581085, decouple_loss:0.0076033067889511585
loss_pred:0.025824982672929764, decouple_loss:0.007493066135793924
loss_pred:0.025598794221878052, decouple_loss:0.007505078334361315
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02645646594464779, avg_mse: 0.031843721866607666
current test mse: 0.031844
Iteration: 2711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525572955608368, gen p mean: 0.0, mean p set: 0.44819125533103943
The modified gen p mean: 0.45613420009613037, gen p mean: 0.0, mean p set: 0.4470323920249939
loss_pred:0.024961238726973534, decouple_loss:0.006948628928512335
loss_pred:0.02666718326508999, decouple_loss:0.00699628284201026
The modified gen p mean: 0.4562684893608093, gen p mean: 0.0, mean p set: 0.4478928744792938
loss_pred:0.02733120508491993, decouple_loss:0.006928914226591587
Iteration: 2712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027509331703186, gen p mean: 0.0, mean p set: 0.4485093653202057
The modified gen p mean: 0.45074957609176636, gen p mean: 0.0, mean p set: 0.4469875395298004
The modified gen p mean: 0.449435830116272, gen p mean: 0.0, mean p set: 0.44770732522010803
loss_pred:0.027628520503640175, decouple_loss:0.006916124373674393
loss_pred:0.0264512337744236, decouple_loss:0.007326431106775999
loss_pred:0.025464989244937897, decouple_loss:0.00706494739279151
Iteration: 2713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.439964234828949, gen p mean: 0.0, mean p set: 0.4474305510520935
The modified gen p mean: 0.43814295530319214, gen p mean: 0.0, mean p set: 0.4474595785140991
The modified gen p mean: 0.43962547183036804, gen p mean: 0.0, mean p set: 0.4483780562877655
loss_pred:0.0263530183583498, decouple_loss:0.007041710428893566
loss_pred:0.025099996477365494, decouple_loss:0.006803928408771753
loss_pred:0.026007430627942085, decouple_loss:0.0073085506446659565
Iteration: 2714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4446828365325928, gen p mean: 0.0, mean p set: 0.44732505083084106
The modified gen p mean: 0.4467523396015167, gen p mean: 0.0, mean p set: 0.4482417702674866
loss_pred:0.026533979922533035, decouple_loss:0.006804673932492733
The modified gen p mean: 0.44715696573257446, gen p mean: 0.0, mean p set: 0.44974398612976074
loss_pred:0.026659803465008736, decouple_loss:0.007234474178403616
loss_pred:0.026216570287942886, decouple_loss:0.007567681837826967
Iteration: 2715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4579980969429016, gen p mean: 0.0, mean p set: 0.4479750096797943
The modified gen p mean: 0.4570169746875763, gen p mean: 0.0, mean p set: 0.44786348938941956
loss_pred:0.027352694422006607, decouple_loss:0.006984715349972248
The modified gen p mean: 0.45918744802474976, gen p mean: 0.0, mean p set: 0.44709256291389465
loss_pred:0.02620287425816059, decouple_loss:0.006977392826229334
loss_pred:0.026334840804338455, decouple_loss:0.006932591553777456
Iteration: 2716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45038673281669617, gen p mean: 0.0, mean p set: 0.4484054148197174
The modified gen p mean: 0.4454544484615326, gen p mean: 0.0, mean p set: 0.4479442238807678
The modified gen p mean: 0.4474727511405945, gen p mean: 0.0, mean p set: 0.45040658116340637
loss_pred:0.02738967351615429, decouple_loss:0.007087418343871832
loss_pred:0.02567405067384243, decouple_loss:0.006791951600462198
loss_pred:0.02613779902458191, decouple_loss:0.007414130959659815
Iteration: 2717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4378511905670166, gen p mean: 0.0, mean p set: 0.4500185549259186
The modified gen p mean: 0.4399230480194092, gen p mean: 0.0, mean p set: 0.44914042949676514
The modified gen p mean: 0.43597185611724854, gen p mean: 0.0, mean p set: 0.447104811668396
loss_pred:0.026357831433415413, decouple_loss:0.007352248765528202
loss_pred:0.02721817046403885, decouple_loss:0.007049717009067535
loss_pred:0.025514312088489532, decouple_loss:0.007124130614101887
Iteration: 2718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45560982823371887, gen p mean: 0.0, mean p set: 0.4482884109020233
The modified gen p mean: 0.4525625705718994, gen p mean: 0.0, mean p set: 0.4484540522098541
The modified gen p mean: 0.44974285364151, gen p mean: 0.0, mean p set: 0.4472576081752777
loss_pred:0.025628510862588882, decouple_loss:0.0072094048373401165
loss_pred:0.02594035677611828, decouple_loss:0.007198946550488472
loss_pred:0.02568986639380455, decouple_loss:0.0070250811986625195
Iteration: 2719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45443636178970337, gen p mean: 0.0, mean p set: 0.4477509558200836
The modified gen p mean: 0.4563186466693878, gen p mean: 0.0, mean p set: 0.448116660118103
loss_pred:0.02844972163438797, decouple_loss:0.007198176346719265
The modified gen p mean: 0.4571663439273834, gen p mean: 0.0, mean p set: 0.448391854763031
loss_pred:0.027604123577475548, decouple_loss:0.007026950363069773
loss_pred:0.027311265468597412, decouple_loss:0.007167486939579248
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
NaN value num: 0
Iteration: 2720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453044831752777, gen p mean: 0.0, mean p set: 0.4479536712169647
The modified gen p mean: 0.44877928495407104, gen p mean: 0.0, mean p set: 0.44746968150138855
The modified gen p mean: 0.45125582814216614, gen p mean: 0.0, mean p set: 0.44862788915634155
loss_pred:0.02588420920073986, decouple_loss:0.007151837460696697
loss_pred:0.026458241045475006, decouple_loss:0.007314142305403948
loss_pred:0.0251458752900362, decouple_loss:0.007535937707871199
2023-05-03 08:39:54 testing...
The modified gen p mean: 0.43467584252357483, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4412230849266052, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.43902742862701416, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.026868954300880432, decouple_loss:0.007479647174477577
loss_pred:0.02550593391060829, decouple_loss:0.007445815484970808
loss_pred:0.02578778937458992, decouple_loss:0.007398427464067936
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026426291093230247, avg_mse: 0.031768571585416794
current test mse: 0.031769
Iteration: 2721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4392276406288147, gen p mean: 0.0, mean p set: 0.44798994064331055
The modified gen p mean: 0.44030821323394775, gen p mean: 0.0, mean p set: 0.44761213660240173
loss_pred:0.026113323867321014, decouple_loss:0.007605891674757004
loss_pred:0.027394935488700867, decouple_loss:0.007096072193235159
The modified gen p mean: 0.43847134709358215, gen p mean: 0.0, mean p set: 0.4484792649745941
loss_pred:0.026645077392458916, decouple_loss:0.007363766431808472
Iteration: 2722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44168412685394287, gen p mean: 0.0, mean p set: 0.4482274651527405
The modified gen p mean: 0.4394267201423645, gen p mean: 0.0, mean p set: 0.44820842146873474
The modified gen p mean: 0.4431900978088379, gen p mean: 0.0, mean p set: 0.44855955243110657
loss_pred:0.027200547978281975, decouple_loss:0.0071517592296004295
loss_pred:0.02649695798754692, decouple_loss:0.0072903139516711235
loss_pred:0.025793928653001785, decouple_loss:0.0070799849927425385
Iteration: 2723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534689486026764, gen p mean: 0.0, mean p set: 0.4476519823074341
The modified gen p mean: 0.45809832215309143, gen p mean: 0.0, mean p set: 0.44880858063697815
The modified gen p mean: 0.4539317488670349, gen p mean: 0.0, mean p set: 0.4477744400501251
loss_pred:0.024986712262034416, decouple_loss:0.0069832224398851395
loss_pred:0.025251196697354317, decouple_loss:0.007265663705766201
loss_pred:0.02528562769293785, decouple_loss:0.007568042725324631
Iteration: 2724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45126375555992126, gen p mean: 0.0, mean p set: 0.4491821527481079
The modified gen p mean: 0.4524189233779907, gen p mean: 0.0, mean p set: 0.4498717188835144
The modified gen p mean: 0.45352429151535034, gen p mean: 0.0, mean p set: 0.4497813284397125
loss_pred:0.024206984788179398, decouple_loss:0.00729687325656414
loss_pred:0.02642911672592163, decouple_loss:0.007777423597872257
loss_pred:0.026188278570771217, decouple_loss:0.007443387992680073
Iteration: 2725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479750394821167, gen p mean: 0.0, mean p set: 0.44964075088500977
The modified gen p mean: 0.4460790157318115, gen p mean: 0.0, mean p set: 0.44826775789260864
The modified gen p mean: 0.4470502734184265, gen p mean: 0.0, mean p set: 0.44840285181999207
loss_pred:0.0256517231464386, decouple_loss:0.007424098905175924
loss_pred:0.027365779504179955, decouple_loss:0.007171039003878832
loss_pred:0.026514213532209396, decouple_loss:0.007436056155711412
Iteration: 2726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44305741786956787, gen p mean: 0.0, mean p set: 0.4476097822189331
The modified gen p mean: 0.44066622853279114, gen p mean: 0.0, mean p set: 0.4475262761116028
The modified gen p mean: 0.4433698058128357, gen p mean: 0.0, mean p set: 0.44904273748397827
loss_pred:0.027283497154712677, decouple_loss:0.007477049715816975
loss_pred:0.026920167729258537, decouple_loss:0.0076577262952923775
loss_pred:0.024722084403038025, decouple_loss:0.007098820060491562
Iteration: 2727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475855827331543, gen p mean: 0.0, mean p set: 0.44966837763786316
The modified gen p mean: 0.4445738196372986, gen p mean: 0.0, mean p set: 0.448832243680954
The modified gen p mean: 0.445826917886734, gen p mean: 0.0, mean p set: 0.44745421409606934
loss_pred:0.025941947475075722, decouple_loss:0.007444560527801514
loss_pred:0.02776031196117401, decouple_loss:0.0072116851806640625
loss_pred:0.02566700056195259, decouple_loss:0.007281778380274773
Iteration: 2728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4549621045589447, gen p mean: 0.0, mean p set: 0.44738876819610596
The modified gen p mean: 0.45536816120147705, gen p mean: 0.0, mean p set: 0.447390615940094
The modified gen p mean: 0.4555974304676056, gen p mean: 0.0, mean p set: 0.45020791888237
loss_pred:0.027218760922551155, decouple_loss:0.0075766402296721935
loss_pred:0.02727380394935608, decouple_loss:0.007593578193336725
loss_pred:0.026039181277155876, decouple_loss:0.0069984011352062225
Iteration: 2729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719842076301575, gen p mean: 0.0, mean p set: 0.4487842917442322
The modified gen p mean: 0.4494713842868805, gen p mean: 0.0, mean p set: 0.44695067405700684
The modified gen p mean: 0.44829824566841125, gen p mean: 0.0, mean p set: 0.4494765102863312
loss_pred:0.026277603581547737, decouple_loss:0.00728587107732892
loss_pred:0.02654915116727352, decouple_loss:0.0074674589559435844
loss_pred:0.02384062297642231, decouple_loss:0.007312319707125425
Iteration: 2730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4419357478618622, gen p mean: 0.0, mean p set: 0.4478277862071991
The modified gen p mean: 0.4455932378768921, gen p mean: 0.0, mean p set: 0.45032617449760437
The modified gen p mean: 0.4460671544075012, gen p mean: 0.0, mean p set: 0.44835713505744934
loss_pred:0.026712851598858833, decouple_loss:0.007242984604090452
loss_pred:0.025831028819084167, decouple_loss:0.007552140858024359
loss_pred:0.026217203587293625, decouple_loss:0.0073320865631103516
2023-05-03 08:43:32 testing...
The modified gen p mean: 0.44496554136276245, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44970566034317017, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.451870858669281, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02684495784342289, decouple_loss:0.007514255121350288
loss_pred:0.025779075920581818, decouple_loss:0.007390410173684359
loss_pred:0.025454523041844368, decouple_loss:0.007423752453178167
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026398327201604843, avg_mse: 0.03168928623199463
current test mse: 0.031689
Iteration: 2731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532606303691864, gen p mean: 0.0, mean p set: 0.44927728176116943
The modified gen p mean: 0.44925549626350403, gen p mean: 0.0, mean p set: 0.44879916310310364
loss_pred:0.024689218029379845, decouple_loss:0.0070478119887411594
loss_pred:0.02626476250588894, decouple_loss:0.007396289613097906
The modified gen p mean: 0.4508756697177887, gen p mean: 0.0, mean p set: 0.44957301020622253
loss_pred:0.025685355067253113, decouple_loss:0.007479303050786257
Iteration: 2732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44257035851478577, gen p mean: 0.0, mean p set: 0.4470324218273163
The modified gen p mean: 0.4444690942764282, gen p mean: 0.0, mean p set: 0.44789421558380127
The modified gen p mean: 0.44518283009529114, gen p mean: 0.0, mean p set: 0.4474656283855438
loss_pred:0.025652196258306503, decouple_loss:0.007300160359591246
loss_pred:0.02582232467830181, decouple_loss:0.007093837019056082
loss_pred:0.024664077907800674, decouple_loss:0.0072420216165483
Iteration: 2733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456064701080322, gen p mean: 0.0, mean p set: 0.4479839503765106
The modified gen p mean: 0.4416285455226898, gen p mean: 0.0, mean p set: 0.45015189051628113
The modified gen p mean: 0.4392951726913452, gen p mean: 0.0, mean p set: 0.44708430767059326
loss_pred:0.027309617027640343, decouple_loss:0.0070598977617919445
loss_pred:0.026356572285294533, decouple_loss:0.007128285709768534
loss_pred:0.025740114971995354, decouple_loss:0.007070969790220261
Iteration: 2734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45799368619918823, gen p mean: 0.0, mean p set: 0.44789883494377136
The modified gen p mean: 0.4563017189502716, gen p mean: 0.0, mean p set: 0.44820311665534973
The modified gen p mean: 0.4574269652366638, gen p mean: 0.0, mean p set: 0.44779905676841736
loss_pred:0.027470283210277557, decouple_loss:0.007123177405446768
loss_pred:0.025931870564818382, decouple_loss:0.007196714635938406
loss_pred:0.026225771754980087, decouple_loss:0.0072349924594163895
Iteration: 2735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495762884616852, gen p mean: 0.0, mean p set: 0.44899317622184753
The modified gen p mean: 0.450570672750473, gen p mean: 0.0, mean p set: 0.4477371573448181
The modified gen p mean: 0.4528120160102844, gen p mean: 0.0, mean p set: 0.4491044282913208
loss_pred:0.024551337584853172, decouple_loss:0.006946789566427469
loss_pred:0.02507367730140686, decouple_loss:0.006913285702466965
loss_pred:0.025188447907567024, decouple_loss:0.007079817354679108
Iteration: 2736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43511781096458435, gen p mean: 0.0, mean p set: 0.447974294424057
The modified gen p mean: 0.4371618926525116, gen p mean: 0.0, mean p set: 0.4474024772644043
The modified gen p mean: 0.4356119930744171, gen p mean: 0.0, mean p set: 0.44765329360961914
loss_pred:0.02534816786646843, decouple_loss:0.0070734391920268536
loss_pred:0.02601695992052555, decouple_loss:0.0069367908872663975
loss_pred:0.02652813121676445, decouple_loss:0.007253734394907951
Iteration: 2737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501805603504181, gen p mean: 0.0, mean p set: 0.4496642053127289
The modified gen p mean: 0.4462815225124359, gen p mean: 0.0, mean p set: 0.44859588146209717
The modified gen p mean: 0.4496721625328064, gen p mean: 0.0, mean p set: 0.4491809606552124
loss_pred:0.02517176792025566, decouple_loss:0.007080418989062309
loss_pred:0.026160264387726784, decouple_loss:0.006901525892317295
loss_pred:0.025183318182826042, decouple_loss:0.006950808223336935
Iteration: 2738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4607861340045929, gen p mean: 0.0, mean p set: 0.44878458976745605
The modified gen p mean: 0.46374762058258057, gen p mean: 0.0, mean p set: 0.4496292173862457
The modified gen p mean: 0.4639136493206024, gen p mean: 0.0, mean p set: 0.44834980368614197
loss_pred:0.024151505902409554, decouple_loss:0.006599252577871084
loss_pred:0.025551343336701393, decouple_loss:0.006909979972988367
loss_pred:0.027677876874804497, decouple_loss:0.006796457339078188
Iteration: 2739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43860766291618347, gen p mean: 0.0, mean p set: 0.4473898112773895
The modified gen p mean: 0.4386043846607208, gen p mean: 0.0, mean p set: 0.44861429929733276
The modified gen p mean: 0.4435713589191437, gen p mean: 0.0, mean p set: 0.450667142868042
loss_pred:0.025022925809025764, decouple_loss:0.006648320239037275
loss_pred:0.024462008848786354, decouple_loss:0.006867069751024246
loss_pred:0.02576451003551483, decouple_loss:0.007000016514211893
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
NaN value num: 0
Iteration: 2740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4389587640762329, gen p mean: 0.0, mean p set: 0.4502742886543274
The modified gen p mean: 0.43949979543685913, gen p mean: 0.0, mean p set: 0.4490378499031067
The modified gen p mean: 0.44073647260665894, gen p mean: 0.0, mean p set: 0.45153409242630005
loss_pred:0.026657169684767723, decouple_loss:0.007986707612872124
loss_pred:0.02536482736468315, decouple_loss:0.008232587948441505
loss_pred:0.026946822181344032, decouple_loss:0.007543658372014761
2023-05-03 08:48:17 testing...
The modified gen p mean: 0.45296937227249146, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4580524265766144, gen p mean: 0.0, mean p set: 0.4500633478164673The modified gen p mean: 0.46043264865875244, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02665114961564541, decouple_loss:0.007699587382376194
loss_pred:0.025649357587099075, decouple_loss:0.007491967175155878
loss_pred:0.025390340015292168, decouple_loss:0.0074152350425720215
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026273727416992188, avg_mse: 0.031614650040864944
current test mse: 0.031615
Iteration: 2741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4610868990421295, gen p mean: 0.0, mean p set: 0.4505882263183594
loss_pred:0.026614731177687645, decouple_loss:0.0073477355763316154
The modified gen p mean: 0.4616706967353821, gen p mean: 0.0, mean p set: 0.4510430097579956
loss_pred:0.025568652898073196, decouple_loss:0.007725168485194445
The modified gen p mean: 0.45315468311309814, gen p mean: 0.0, mean p set: 0.4482121169567108
loss_pred:0.026126619428396225, decouple_loss:0.00733874412253499
Iteration: 2742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45906510949134827, gen p mean: 0.0, mean p set: 0.45074358582496643
The modified gen p mean: 0.4589146077632904, gen p mean: 0.0, mean p set: 0.4512166678905487
The modified gen p mean: 0.46044421195983887, gen p mean: 0.0, mean p set: 0.45134055614471436
loss_pred:0.026309402659535408, decouple_loss:0.007446145173162222
loss_pred:0.025493977591395378, decouple_loss:0.007599559612572193
loss_pred:0.027394775301218033, decouple_loss:0.00772485788911581
Iteration: 2743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4409129023551941, gen p mean: 0.0, mean p set: 0.4481086730957031
The modified gen p mean: 0.4386284053325653, gen p mean: 0.0, mean p set: 0.4476247727870941
The modified gen p mean: 0.43393465876579285, gen p mean: 0.0, mean p set: 0.4492231011390686
loss_pred:0.027341585606336594, decouple_loss:0.007804517168551683
loss_pred:0.027323195710778236, decouple_loss:0.007387128192931414
loss_pred:0.026798879727721214, decouple_loss:0.007306045386940241
Iteration: 2744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490991234779358, gen p mean: 0.0, mean p set: 0.4512411952018738
The modified gen p mean: 0.4469887912273407, gen p mean: 0.0, mean p set: 0.45032137632369995
The modified gen p mean: 0.44984662532806396, gen p mean: 0.0, mean p set: 0.45051300525665283
loss_pred:0.024331187829375267, decouple_loss:0.007551492191851139
loss_pred:0.026669349521398544, decouple_loss:0.007325869519263506
loss_pred:0.025998996570706367, decouple_loss:0.0072336699813604355
Iteration: 2745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45325160026550293, gen p mean: 0.0, mean p set: 0.4495622515678406
The modified gen p mean: 0.45102763175964355, gen p mean: 0.0, mean p set: 0.4485168755054474
The modified gen p mean: 0.45072901248931885, gen p mean: 0.0, mean p set: 0.44921740889549255
loss_pred:0.02695714496076107, decouple_loss:0.007217078935354948
loss_pred:0.026140792295336723, decouple_loss:0.0070148129016160965
loss_pred:0.027094507589936256, decouple_loss:0.007172952871769667
Iteration: 2746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948577880859375, gen p mean: 0.0, mean p set: 0.4499780237674713
The modified gen p mean: 0.4521312415599823, gen p mean: 0.0, mean p set: 0.44939300417900085
The modified gen p mean: 0.45289820432662964, gen p mean: 0.0, mean p set: 0.44845154881477356
loss_pred:0.027180327102541924, decouple_loss:0.0071791247464716434
loss_pred:0.026128705590963364, decouple_loss:0.007319177966564894
loss_pred:0.026885831728577614, decouple_loss:0.007068002596497536
Iteration: 2747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673964381217957, gen p mean: 0.0, mean p set: 0.4495069682598114
The modified gen p mean: 0.4448513686656952, gen p mean: 0.0, mean p set: 0.44758492708206177
The modified gen p mean: 0.4463316798210144, gen p mean: 0.0, mean p set: 0.4498141407966614
loss_pred:0.027989696711301804, decouple_loss:0.007190316915512085
loss_pred:0.02557205967605114, decouple_loss:0.006998676341027021
loss_pred:0.027097830548882484, decouple_loss:0.007098327856510878
Iteration: 2748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45022550225257874, gen p mean: 0.0, mean p set: 0.45073163509368896
The modified gen p mean: 0.4483267664909363, gen p mean: 0.0, mean p set: 0.4478309452533722
The modified gen p mean: 0.45089828968048096, gen p mean: 0.0, mean p set: 0.4510376751422882
loss_pred:0.026816245168447495, decouple_loss:0.006916895043104887
loss_pred:0.027241038158535957, decouple_loss:0.0067122820764780045
loss_pred:0.0264915619045496, decouple_loss:0.006912045180797577
Iteration: 2749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497045874595642, gen p mean: 0.0, mean p set: 0.4512731432914734
The modified gen p mean: 0.4487033188343048, gen p mean: 0.0, mean p set: 0.45043426752090454
The modified gen p mean: 0.4457172751426697, gen p mean: 0.0, mean p set: 0.44834598898887634
loss_pred:0.025158490985631943, decouple_loss:0.007005637511610985
loss_pred:0.02600795030593872, decouple_loss:0.007132616359740496
loss_pred:0.025956803932785988, decouple_loss:0.006751095410436392
Iteration: 2750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483967125415802, gen p mean: 0.0, mean p set: 0.44959574937820435
The modified gen p mean: 0.44667577743530273, gen p mean: 0.0, mean p set: 0.448770135641098
The modified gen p mean: 0.4460258483886719, gen p mean: 0.0, mean p set: 0.44997039437294006
loss_pred:0.026530783623456955, decouple_loss:0.00675161462277174loss_pred:0.026532026007771492, decouple_loss:0.006767360493540764
loss_pred:0.02669157274067402, decouple_loss:0.006927302107214928
2023-05-03 08:52:00 testing...
The modified gen p mean: 0.4504489600658417, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44492557644844055, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.453182190656662, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.025615720078349113, decouple_loss:0.007564057596027851
loss_pred:0.026728304103016853, decouple_loss:0.007738038897514343
loss_pred:0.025365442037582397, decouple_loss:0.007533449213951826
WV_0_PC_0_EH_0_PS_40_6, loss: 0.0262837465852499, avg_mse: 0.03165094926953316
current test mse: 0.031651
Iteration: 2751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515191614627838, gen p mean: 0.0, mean p set: 0.4512060284614563
The modified gen p mean: 0.4542689323425293, gen p mean: 0.0, mean p set: 0.4511849880218506
loss_pred:0.02510732412338257, decouple_loss:0.007180602755397558
loss_pred:0.025176644325256348, decouple_loss:0.007572364993393421
The modified gen p mean: 0.45434296131134033, gen p mean: 0.0, mean p set: 0.45011213421821594
loss_pred:0.02657042257487774, decouple_loss:0.006895877420902252
Iteration: 2752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480290114879608, gen p mean: 0.0, mean p set: 0.4488905668258667
The modified gen p mean: 0.44059932231903076, gen p mean: 0.0, mean p set: 0.44887641072273254
The modified gen p mean: 0.45054924488067627, gen p mean: 0.0, mean p set: 0.45125463604927063
loss_pred:0.02629840560257435, decouple_loss:0.0072078160010278225
loss_pred:0.026146477088332176, decouple_loss:0.007090577390044928
loss_pred:0.02435928024351597, decouple_loss:0.007356887683272362
Iteration: 2753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530658423900604, gen p mean: 0.0, mean p set: 0.44962626695632935
The modified gen p mean: 0.4515248239040375, gen p mean: 0.0, mean p set: 0.4506089687347412
The modified gen p mean: 0.45340049266815186, gen p mean: 0.0, mean p set: 0.4507790505886078
loss_pred:0.02685687690973282, decouple_loss:0.006759541109204292
loss_pred:0.026575418189167976, decouple_loss:0.006898089312016964
loss_pred:0.025609582662582397, decouple_loss:0.00698847696185112
Iteration: 2754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534822404384613, gen p mean: 0.0, mean p set: 0.4480978846549988
The modified gen p mean: 0.4532587230205536, gen p mean: 0.0, mean p set: 0.4498726725578308
The modified gen p mean: 0.4545140266418457, gen p mean: 0.0, mean p set: 0.44722285866737366
loss_pred:0.02698560804128647, decouple_loss:0.00688164820894599
loss_pred:0.027545984834432602, decouple_loss:0.0070737069472670555
loss_pred:0.02510019578039646, decouple_loss:0.0068520414642989635
Iteration: 2755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44105997681617737, gen p mean: 0.0, mean p set: 0.44721853733062744
The modified gen p mean: 0.4364190399646759, gen p mean: 0.0, mean p set: 0.44842615723609924
The modified gen p mean: 0.44045278429985046, gen p mean: 0.0, mean p set: 0.4501139223575592
loss_pred:0.025289783254265785, decouple_loss:0.006836873013526201
loss_pred:0.02614462375640869, decouple_loss:0.006928654853254557
loss_pred:0.026303105056285858, decouple_loss:0.006809717044234276
Iteration: 2756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4435960352420807, gen p mean: 0.0, mean p set: 0.44867488741874695
The modified gen p mean: 0.4494265615940094, gen p mean: 0.0, mean p set: 0.44889700412750244
The modified gen p mean: 0.4499797523021698, gen p mean: 0.0, mean p set: 0.44995033740997314
loss_pred:0.025980686768889427, decouple_loss:0.00682890135794878
loss_pred:0.026928503066301346, decouple_loss:0.006903165951371193
loss_pred:0.026679521426558495, decouple_loss:0.007351166568696499
Iteration: 2757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45527997612953186, gen p mean: 0.0, mean p set: 0.4512079358100891
The modified gen p mean: 0.4535790979862213, gen p mean: 0.0, mean p set: 0.4485437870025635
The modified gen p mean: 0.45759621262550354, gen p mean: 0.0, mean p set: 0.44960159063339233
loss_pred:0.024937205016613007, decouple_loss:0.007391378283500671
loss_pred:0.026607388630509377, decouple_loss:0.006917272694408894
loss_pred:0.025906816124916077, decouple_loss:0.006755612324923277
Iteration: 2758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460718035697937, gen p mean: 0.0, mean p set: 0.4490673840045929
The modified gen p mean: 0.4425988495349884, gen p mean: 0.0, mean p set: 0.449124276638031
The modified gen p mean: 0.4439995586872101, gen p mean: 0.0, mean p set: 0.45164018869400024
loss_pred:0.026696667075157166, decouple_loss:0.007473673205822706
loss_pred:0.025748251006007195, decouple_loss:0.007098368369042873
loss_pred:0.02452157624065876, decouple_loss:0.007255407515913248
Iteration: 2759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477606415748596, gen p mean: 0.0, mean p set: 0.4522051215171814
The modified gen p mean: 0.4487128257751465, gen p mean: 0.0, mean p set: 0.44817185401916504
The modified gen p mean: 0.4473879933357239, gen p mean: 0.0, mean p set: 0.4505128264427185
loss_pred:0.02476956509053707, decouple_loss:0.0072241476736962795
loss_pred:0.0272187702357769, decouple_loss:0.006906736642122269
loss_pred:0.02569814957678318, decouple_loss:0.007078845519572496
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 2760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4562814235687256, gen p mean: 0.0, mean p set: 0.44888749718666077
The modified gen p mean: 0.4565999507904053, gen p mean: 0.0, mean p set: 0.4477280378341675
The modified gen p mean: 0.45333802700042725, gen p mean: 0.0, mean p set: 0.44884711503982544
loss_pred:0.026181088760495186, decouple_loss:0.007423074450343847
loss_pred:0.02554895170032978, decouple_loss:0.007439454086124897
loss_pred:0.025280462577939034, decouple_loss:0.007492602802813053
2023-05-03 08:56:31 testing...
The modified gen p mean: 0.44019412994384766, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4477076530456543, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4451027810573578, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.026601921766996384, decouple_loss:0.007426190655678511
loss_pred:0.025282753631472588, decouple_loss:0.0071991258300840855
loss_pred:0.025618629530072212, decouple_loss:0.007197439670562744
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026198148727416992, avg_mse: 0.03154299780726433
current test mse: 0.031543
Iteration: 2761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44316011667251587, gen p mean: 0.0, mean p set: 0.44759562611579895
The modified gen p mean: 0.44375529885292053, gen p mean: 0.0, mean p set: 0.44816744327545166
loss_pred:0.025372810661792755, decouple_loss:0.0074446978978812695
loss_pred:0.026112468913197517, decouple_loss:0.007248808164149523
The modified gen p mean: 0.4431205689907074, gen p mean: 0.0, mean p set: 0.4478060305118561
loss_pred:0.025558646768331528, decouple_loss:0.007511439733207226
Iteration: 2762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44638311862945557, gen p mean: 0.0, mean p set: 0.44803258776664734
The modified gen p mean: 0.44134780764579773, gen p mean: 0.0, mean p set: 0.44724181294441223
The modified gen p mean: 0.44298088550567627, gen p mean: 0.0, mean p set: 0.4478125274181366
loss_pred:0.025518076494336128, decouple_loss:0.007300167810171843
loss_pred:0.0250223558396101, decouple_loss:0.007350877393037081
loss_pred:0.02502991445362568, decouple_loss:0.007250611204653978
Iteration: 2763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45369115471839905, gen p mean: 0.0, mean p set: 0.4481956660747528
The modified gen p mean: 0.45347467064857483, gen p mean: 0.0, mean p set: 0.44797375798225403
The modified gen p mean: 0.452192485332489, gen p mean: 0.0, mean p set: 0.4480046033859253
loss_pred:0.025331294164061546, decouple_loss:0.006950635928660631
loss_pred:0.02699107863008976, decouple_loss:0.007218987215310335
loss_pred:0.024857575073838234, decouple_loss:0.00694225775077939
Iteration: 2764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45088091492652893, gen p mean: 0.0, mean p set: 0.4477040469646454
The modified gen p mean: 0.4509963393211365, gen p mean: 0.0, mean p set: 0.4465283155441284
The modified gen p mean: 0.45301538705825806, gen p mean: 0.0, mean p set: 0.44837021827697754
loss_pred:0.02494027093052864, decouple_loss:0.006762853357940912
loss_pred:0.026250625029206276, decouple_loss:0.007141293026506901
loss_pred:0.025905946269631386, decouple_loss:0.006819295696914196
Iteration: 2765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4372979998588562, gen p mean: 0.0, mean p set: 0.4470813572406769
The modified gen p mean: 0.43894726037979126, gen p mean: 0.0, mean p set: 0.4484192430973053
The modified gen p mean: 0.43868130445480347, gen p mean: 0.0, mean p set: 0.4477818012237549
loss_pred:0.025433922186493874, decouple_loss:0.006819286849349737
loss_pred:0.02628469280898571, decouple_loss:0.006740165874361992
loss_pred:0.024977708235383034, decouple_loss:0.006885413080453873
Iteration: 2766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856494665145874, gen p mean: 0.0, mean p set: 0.4482816159725189
The modified gen p mean: 0.4440964162349701, gen p mean: 0.0, mean p set: 0.4485515058040619
The modified gen p mean: 0.4474931061267853, gen p mean: 0.0, mean p set: 0.44661951065063477
loss_pred:0.025883471593260765, decouple_loss:0.006942322012037039
loss_pred:0.02682892046868801, decouple_loss:0.007286738604307175
loss_pred:0.025508733466267586, decouple_loss:0.007127086166292429
Iteration: 2767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45703205466270447, gen p mean: 0.0, mean p set: 0.4487118422985077
The modified gen p mean: 0.4545764923095703, gen p mean: 0.0, mean p set: 0.4486413896083832
The modified gen p mean: 0.45300865173339844, gen p mean: 0.0, mean p set: 0.44719401001930237
loss_pred:0.025226423516869545, decouple_loss:0.006759986747056246
loss_pred:0.024673016741871834, decouple_loss:0.006792241707444191
loss_pred:0.026069551706314087, decouple_loss:0.0068761734291911125
Iteration: 2768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744452834129333, gen p mean: 0.0, mean p set: 0.44779056310653687
The modified gen p mean: 0.44861871004104614, gen p mean: 0.0, mean p set: 0.4477352201938629
The modified gen p mean: 0.4464470148086548, gen p mean: 0.0, mean p set: 0.44756636023521423
loss_pred:0.0247621089220047, decouple_loss:0.0070504918694496155
loss_pred:0.02581300400197506, decouple_loss:0.0069418856874108315
loss_pred:0.02539866976439953, decouple_loss:0.007121833972632885
Iteration: 2769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44520851969718933, gen p mean: 0.0, mean p set: 0.4485739767551422
The modified gen p mean: 0.44445478916168213, gen p mean: 0.0, mean p set: 0.44809025526046753
The modified gen p mean: 0.4417233467102051, gen p mean: 0.0, mean p set: 0.4486749470233917
loss_pred:0.02501074969768524, decouple_loss:0.006904176436364651
loss_pred:0.02522061951458454, decouple_loss:0.006806533318012953
loss_pred:0.026231903582811356, decouple_loss:0.007306019309908152
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953301548957825, gen p mean: 0.0, mean p set: 0.44765913486480713
The modified gen p mean: 0.4475705325603485, gen p mean: 0.0, mean p set: 0.44841933250427246
The modified gen p mean: 0.44886067509651184, gen p mean: 0.0, mean p set: 0.4490656852722168
loss_pred:0.025976870208978653, decouple_loss:0.006855891086161137loss_pred:0.026530472561717033, decouple_loss:0.006835226435214281
loss_pred:0.024966493248939514, decouple_loss:0.006914584431797266
2023-05-03 09:00:15 testing...
The modified gen p mean: 0.45025554299354553, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4460582733154297, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4529224932193756, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.025464791804552078, decouple_loss:0.006994067225605249
loss_pred:0.026356734335422516, decouple_loss:0.007233419921249151
loss_pred:0.025197811424732208, decouple_loss:0.007013753522187471
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02602713368833065, avg_mse: 0.031293924897909164
current test mse: 0.031294
Iteration: 2771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449022114276886, gen p mean: 0.0, mean p set: 0.4473138451576233
The modified gen p mean: 0.4491705000400543, gen p mean: 0.0, mean p set: 0.4468306601047516
loss_pred:0.025489816442131996, decouple_loss:0.00683624716475606
loss_pred:0.02422478049993515, decouple_loss:0.006933973636478186
The modified gen p mean: 0.44899019598960876, gen p mean: 0.0, mean p set: 0.447729229927063
loss_pred:0.02543005533516407, decouple_loss:0.006814759224653244
Iteration: 2772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479635953903198, gen p mean: 0.0, mean p set: 0.44802215695381165
The modified gen p mean: 0.45193102955818176, gen p mean: 0.0, mean p set: 0.4478640854358673
The modified gen p mean: 0.44724908471107483, gen p mean: 0.0, mean p set: 0.44820475578308105
loss_pred:0.02478789910674095, decouple_loss:0.006560512352734804
loss_pred:0.02493053302168846, decouple_loss:0.0070144119672477245
loss_pred:0.026159275323152542, decouple_loss:0.006992986425757408
Iteration: 2773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44564273953437805, gen p mean: 0.0, mean p set: 0.44638389348983765
The modified gen p mean: 0.44701483845710754, gen p mean: 0.0, mean p set: 0.4484681785106659
The modified gen p mean: 0.4446549713611603, gen p mean: 0.0, mean p set: 0.44746458530426025
loss_pred:0.024363230913877487, decouple_loss:0.00687800906598568
loss_pred:0.025610029697418213, decouple_loss:0.006878258194774389
loss_pred:0.02488447166979313, decouple_loss:0.00672133918851614
Iteration: 2774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44420740008354187, gen p mean: 0.0, mean p set: 0.44709837436676025
The modified gen p mean: 0.44176945090293884, gen p mean: 0.0, mean p set: 0.44691428542137146
The modified gen p mean: 0.4414694011211395, gen p mean: 0.0, mean p set: 0.4466179311275482
loss_pred:0.025582490488886833, decouple_loss:0.0068330527283251286
loss_pred:0.02545359544456005, decouple_loss:0.006900086998939514
loss_pred:0.02530079334974289, decouple_loss:0.006930574309080839
Iteration: 2775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44964221119880676, gen p mean: 0.0, mean p set: 0.4482135772705078
The modified gen p mean: 0.4497632682323456, gen p mean: 0.0, mean p set: 0.4479471743106842
The modified gen p mean: 0.44927510619163513, gen p mean: 0.0, mean p set: 0.4485728442668915
loss_pred:0.025516115128993988, decouple_loss:0.006808910984545946
loss_pred:0.025287820026278496, decouple_loss:0.006614003796130419
loss_pred:0.024962907657027245, decouple_loss:0.0066672442480921745
Iteration: 2776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4571123719215393, gen p mean: 0.0, mean p set: 0.4467509686946869
The modified gen p mean: 0.4571582078933716, gen p mean: 0.0, mean p set: 0.4481656849384308
The modified gen p mean: 0.45625045895576477, gen p mean: 0.0, mean p set: 0.4488631784915924
loss_pred:0.025681953877210617, decouple_loss:0.006976186763495207
loss_pred:0.025739949196577072, decouple_loss:0.006703331600874662
loss_pred:0.025692777708172798, decouple_loss:0.00700100464746356
Iteration: 2777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44471439719200134, gen p mean: 0.0, mean p set: 0.44838324189186096
The modified gen p mean: 0.44347819685935974, gen p mean: 0.0, mean p set: 0.44812464714050293
The modified gen p mean: 0.4444544315338135, gen p mean: 0.0, mean p set: 0.44797828793525696
loss_pred:0.02574428915977478, decouple_loss:0.006794879212975502
loss_pred:0.025163870304822922, decouple_loss:0.006698141805827618
loss_pred:0.025645378977060318, decouple_loss:0.006564411800354719
Iteration: 2778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44168171286582947, gen p mean: 0.0, mean p set: 0.44827502965927124
The modified gen p mean: 0.44014883041381836, gen p mean: 0.0, mean p set: 0.44642776250839233
The modified gen p mean: 0.44474300742149353, gen p mean: 0.0, mean p set: 0.44809815287590027
loss_pred:0.025324176996946335, decouple_loss:0.006505269091576338
loss_pred:0.025366684421896935, decouple_loss:0.006917381193488836
loss_pred:0.024529030546545982, decouple_loss:0.006809556391090155
Iteration: 2779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459039270877838, gen p mean: 0.0, mean p set: 0.44725507497787476
The modified gen p mean: 0.44416582584381104, gen p mean: 0.0, mean p set: 0.4470071494579315
The modified gen p mean: 0.4458378553390503, gen p mean: 0.0, mean p set: 0.44784313440322876
loss_pred:0.024976585060358047, decouple_loss:0.0066607119515538216
loss_pred:0.02525440789759159, decouple_loss:0.006626069080084562
loss_pred:0.025986317545175552, decouple_loss:0.006553278770297766
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 2780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522360563278198, gen p mean: 0.0, mean p set: 0.4466347098350525
The modified gen p mean: 0.4529285728931427, gen p mean: 0.0, mean p set: 0.44571492075920105
The modified gen p mean: 0.4530102610588074, gen p mean: 0.0, mean p set: 0.4460570514202118
loss_pred:0.024290582165122032, decouple_loss:0.006730492226779461
loss_pred:0.023855986073613167, decouple_loss:0.0068447282537817955
loss_pred:0.024942563846707344, decouple_loss:0.006726282183080912
2023-05-03 09:04:50 testing...
The modified gen p mean: 0.4505468010902405, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4438188970088959, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.448162704706192, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02507537417113781, decouple_loss:0.006810854654759169
loss_pred:0.026312651112675667, decouple_loss:0.007159590721130371
loss_pred:0.025391336530447006, decouple_loss:0.006964892148971558
WV_0_PC_0_EH_0_PS_40_6, loss: 0.025942042469978333, avg_mse: 0.031197715550661087
current test mse: 0.031198
Iteration: 2781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792836904525757, gen p mean: 0.0, mean p set: 0.4472406804561615
loss_pred:0.025638137012720108, decouple_loss:0.007126300595700741
The modified gen p mean: 0.44838863611221313, gen p mean: 0.0, mean p set: 0.44768208265304565
loss_pred:0.02450595423579216, decouple_loss:0.006510933395475149
The modified gen p mean: 0.4437006711959839, gen p mean: 0.0, mean p set: 0.44929662346839905
loss_pred:0.025266915559768677, decouple_loss:0.007381276693195105
Iteration: 2782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43978798389434814, gen p mean: 0.0, mean p set: 0.4489142596721649
The modified gen p mean: 0.4427332282066345, gen p mean: 0.0, mean p set: 0.4481431543827057
The modified gen p mean: 0.44150662422180176, gen p mean: 0.0, mean p set: 0.44949212670326233
loss_pred:0.025047138333320618, decouple_loss:0.007486292626708746
loss_pred:0.02473783679306507, decouple_loss:0.0064453622326254845
loss_pred:0.025071805343031883, decouple_loss:0.007682251278311014
Iteration: 2783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504125714302063, gen p mean: 0.0, mean p set: 0.44927650690078735
The modified gen p mean: 0.4478611350059509, gen p mean: 0.0, mean p set: 0.44742488861083984
The modified gen p mean: 0.4501849412918091, gen p mean: 0.0, mean p set: 0.44701406359672546
loss_pred:0.024220386520028114, decouple_loss:0.00706952391192317
loss_pred:0.026397056877613068, decouple_loss:0.007211384829133749
loss_pred:0.02601802349090576, decouple_loss:0.007520333863794804
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4579780697822571, gen p mean: 0.0, mean p set: 0.44777190685272217
The modified gen p mean: 0.4568116366863251, gen p mean: 0.0, mean p set: 0.4483067989349365
The modified gen p mean: 0.45113828778266907, gen p mean: 0.0, mean p set: 0.44754740595817566
loss_pred:0.02417275495827198, decouple_loss:0.006456190720200539
loss_pred:0.026597337797284126, decouple_loss:0.006868248805403709
loss_pred:0.025392191484570503, decouple_loss:0.007219419348984957
Iteration: 2785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455651342868805, gen p mean: 0.0, mean p set: 0.4485243558883667
The modified gen p mean: 0.44227293133735657, gen p mean: 0.0, mean p set: 0.44913914799690247
The modified gen p mean: 0.4427237808704376, gen p mean: 0.0, mean p set: 0.449090838432312
loss_pred:0.024063769727945328, decouple_loss:0.006639664992690086
loss_pred:0.025777801871299744, decouple_loss:0.006762838922441006
loss_pred:0.024596866220235825, decouple_loss:0.006811350584030151
Iteration: 2786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4441775679588318, gen p mean: 0.0, mean p set: 0.44873204827308655
The modified gen p mean: 0.44249555468559265, gen p mean: 0.0, mean p set: 0.44818755984306335
The modified gen p mean: 0.4414516091346741, gen p mean: 0.0, mean p set: 0.44717034697532654
loss_pred:0.023814329877495766, decouple_loss:0.006616545841097832
loss_pred:0.024848023429512978, decouple_loss:0.00666856300085783
loss_pred:0.025752320885658264, decouple_loss:0.007110229227691889
Iteration: 2787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519687592983246, gen p mean: 0.0, mean p set: 0.4488321542739868
The modified gen p mean: 0.4502560496330261, gen p mean: 0.0, mean p set: 0.4483468234539032
The modified gen p mean: 0.45027557015419006, gen p mean: 0.0, mean p set: 0.44778627157211304
loss_pred:0.024667544290423393, decouple_loss:0.006545176263898611
loss_pred:0.024583302438259125, decouple_loss:0.00657930551096797
loss_pred:0.025139061734080315, decouple_loss:0.006649359595030546
Iteration: 2788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45295053720474243, gen p mean: 0.0, mean p set: 0.44687098264694214
The modified gen p mean: 0.4540911316871643, gen p mean: 0.0, mean p set: 0.4477066397666931
The modified gen p mean: 0.45239579677581787, gen p mean: 0.0, mean p set: 0.4483872950077057
loss_pred:0.024714099243283272, decouple_loss:0.006624549627304077
loss_pred:0.025849733501672745, decouple_loss:0.007006180938333273
loss_pred:0.0250718854367733, decouple_loss:0.007206127047538757
Iteration: 2789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722047448158264, gen p mean: 0.0, mean p set: 0.4477138817310333
The modified gen p mean: 0.44595590233802795, gen p mean: 0.0, mean p set: 0.44651445746421814
The modified gen p mean: 0.447313517332077, gen p mean: 0.0, mean p set: 0.44859448075294495
loss_pred:0.025206759572029114, decouple_loss:0.006526113487780094
loss_pred:0.024059122428297997, decouple_loss:0.006680114660412073
loss_pred:0.026873605325818062, decouple_loss:0.006911476142704487
Iteration: 2790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4408263564109802, gen p mean: 0.0, mean p set: 0.44714486598968506
The modified gen p mean: 0.4377927780151367, gen p mean: 0.0, mean p set: 0.4486336410045624
The modified gen p mean: 0.4406740069389343, gen p mean: 0.0, mean p set: 0.44747447967529297
loss_pred:0.025709912180900574, decouple_loss:0.006417783442884684
loss_pred:0.024945717304944992, decouple_loss:0.006467142142355442
loss_pred:0.02517937868833542, decouple_loss:0.006945501547306776
2023-05-03 09:08:32 testing...
The modified gen p mean: 0.44682806730270386, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4537299871444702, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.45139357447624207, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02630143240094185, decouple_loss:0.0068534803576767445
loss_pred:0.02511868253350258, decouple_loss:0.006735741626471281
loss_pred:0.025313034653663635, decouple_loss:0.006684248801320791
WV_0_PC_0_EH_0_PS_40_6, loss: 0.025915607810020447, avg_mse: 0.031204286962747574
current test mse: 0.031204
Iteration: 2791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45267099142074585, gen p mean: 0.0, mean p set: 0.44649171829223633
loss_pred:0.02592950128018856, decouple_loss:0.006573295686393976
The modified gen p mean: 0.4512447714805603, gen p mean: 0.0, mean p set: 0.4486530125141144
loss_pred:0.026868317276239395, decouple_loss:0.006649632938206196
The modified gen p mean: 0.44630369544029236, gen p mean: 0.0, mean p set: 0.44823282957077026
loss_pred:0.025542091578245163, decouple_loss:0.006678379140794277
Iteration: 2792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45094671845436096, gen p mean: 0.0, mean p set: 0.4473552703857422
The modified gen p mean: 0.453422874212265, gen p mean: 0.0, mean p set: 0.4485151767730713
The modified gen p mean: 0.4521505832672119, gen p mean: 0.0, mean p set: 0.44772249460220337
loss_pred:0.024855729192495346, decouple_loss:0.0069252606481313705
loss_pred:0.0245063379406929, decouple_loss:0.006445486098527908
loss_pred:0.025217870250344276, decouple_loss:0.006727318745106459
Iteration: 2793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44601860642433167, gen p mean: 0.0, mean p set: 0.4475656747817993
The modified gen p mean: 0.4431675672531128, gen p mean: 0.0, mean p set: 0.4469250440597534
The modified gen p mean: 0.4436795115470886, gen p mean: 0.0, mean p set: 0.44687342643737793
loss_pred:0.024742402136325836, decouple_loss:0.006650911644101143
loss_pred:0.026250388473272324, decouple_loss:0.006983054801821709
loss_pred:0.025951294228434563, decouple_loss:0.006390852853655815
Iteration: 2794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797712564468384, gen p mean: 0.0, mean p set: 0.4479806125164032
The modified gen p mean: 0.44817033410072327, gen p mean: 0.0, mean p set: 0.44847849011421204
The modified gen p mean: 0.44647401571273804, gen p mean: 0.0, mean p set: 0.44928810000419617
loss_pred:0.024827877059578896, decouple_loss:0.006492152810096741
loss_pred:0.024625802412629128, decouple_loss:0.006570298224687576
loss_pred:0.025504544377326965, decouple_loss:0.006891979370266199
Iteration: 2795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464780390262604, gen p mean: 0.0, mean p set: 0.44710099697113037
The modified gen p mean: 0.4465316832065582, gen p mean: 0.0, mean p set: 0.4462227523326874
The modified gen p mean: 0.44638922810554504, gen p mean: 0.0, mean p set: 0.44803762435913086
loss_pred:0.024095119908452034, decouple_loss:0.006878802552819252
loss_pred:0.023920273408293724, decouple_loss:0.007097065448760986
loss_pred:0.025334930047392845, decouple_loss:0.0066433316096663475
Iteration: 2796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.444149374961853, gen p mean: 0.0, mean p set: 0.4464513063430786
The modified gen p mean: 0.4499836266040802, gen p mean: 0.0, mean p set: 0.4477720260620117
The modified gen p mean: 0.4459230303764343, gen p mean: 0.0, mean p set: 0.4475022256374359
loss_pred:0.0262001845985651, decouple_loss:0.006592330057173967
loss_pred:0.02549552172422409, decouple_loss:0.006856051739305258
loss_pred:0.024405330419540405, decouple_loss:0.00672928849235177
Iteration: 2797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475440979003906, gen p mean: 0.0, mean p set: 0.44815605878829956
The modified gen p mean: 0.44702523946762085, gen p mean: 0.0, mean p set: 0.4467092752456665
The modified gen p mean: 0.4517524540424347, gen p mean: 0.0, mean p set: 0.4479168951511383
loss_pred:0.02426934614777565, decouple_loss:0.0062175169587135315
loss_pred:0.02613210119307041, decouple_loss:0.006571980193257332
loss_pred:0.023929907009005547, decouple_loss:0.006221665069460869
Iteration: 2798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796067476272583, gen p mean: 0.0, mean p set: 0.44843539595603943
The modified gen p mean: 0.4470248222351074, gen p mean: 0.0, mean p set: 0.4487445652484894
The modified gen p mean: 0.4492480158805847, gen p mean: 0.0, mean p set: 0.44757208228111267
loss_pred:0.023979399353265762, decouple_loss:0.006219152826815844
loss_pred:0.024991728365421295, decouple_loss:0.006573319900780916
loss_pred:0.024013526737689972, decouple_loss:0.006315798033028841
Iteration: 2799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455835521221161, gen p mean: 0.0, mean p set: 0.44696107506752014
The modified gen p mean: 0.4457534849643707, gen p mean: 0.0, mean p set: 0.4486321210861206
The modified gen p mean: 0.44268980622291565, gen p mean: 0.0, mean p set: 0.4470709264278412
loss_pred:0.025474829599261284, decouple_loss:0.0065272715874016285
loss_pred:0.02470993995666504, decouple_loss:0.006245586555451155
loss_pred:0.025778889656066895, decouple_loss:0.006972304545342922
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
NaN value num: 0
Iteration: 2800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4573850929737091, gen p mean: 0.0, mean p set: 0.4529881477355957
The modified gen p mean: 0.4520759582519531, gen p mean: 0.0, mean p set: 0.4520479440689087
The modified gen p mean: 0.45269307494163513, gen p mean: 0.0, mean p set: 0.45205479860305786
loss_pred:0.02502889558672905, decouple_loss:0.007639523595571518
loss_pred:0.02501072734594345, decouple_loss:0.007559381891041994
loss_pred:0.026112349703907967, decouple_loss:0.008653761819005013
2023-05-03 09:13:18 testing...
The modified gen p mean: 0.4487166404724121, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44412195682525635, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45126861333847046, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.025363009423017502, decouple_loss:0.006924521643668413
loss_pred:0.02634110301733017, decouple_loss:0.0070110466331243515
loss_pred:0.025021307170391083, decouple_loss:0.00693188700824976
WV_0_PC_0_EH_0_PS_40_6, loss: 0.025922929868102074, avg_mse: 0.031191421672701836
current test mse: 0.031191
Iteration: 2801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4570017457008362, gen p mean: 0.0, mean p set: 0.452627569437027
loss_pred:0.02610551007091999, decouple_loss:0.00826643593609333
The modified gen p mean: 0.4566035866737366, gen p mean: 0.0, mean p set: 0.4525144100189209
loss_pred:0.025699295103549957, decouple_loss:0.008013611659407616
The modified gen p mean: 0.45465007424354553, gen p mean: 0.0, mean p set: 0.45061367750167847
loss_pred:0.026083150878548622, decouple_loss:0.007972988300025463
Iteration: 2802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466298222541809, gen p mean: 0.0, mean p set: 0.4518716335296631
The modified gen p mean: 0.44666290283203125, gen p mean: 0.0, mean p set: 0.45172441005706787
The modified gen p mean: 0.44553861021995544, gen p mean: 0.0, mean p set: 0.4526216387748718
loss_pred:0.025671634823083878, decouple_loss:0.007712965831160545
loss_pred:0.026609264314174652, decouple_loss:0.007835108786821365
loss_pred:0.025960734114050865, decouple_loss:0.007827396504580975
Iteration: 2803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751906394958496, gen p mean: 0.0, mean p set: 0.4527184069156647
The modified gen p mean: 0.44905418157577515, gen p mean: 0.0, mean p set: 0.4519905745983124
The modified gen p mean: 0.4476165771484375, gen p mean: 0.0, mean p set: 0.4518626928329468
loss_pred:0.0258723646402359, decouple_loss:0.007567112799733877
loss_pred:0.025380071252584457, decouple_loss:0.007425645366311073
loss_pred:0.025501864030957222, decouple_loss:0.007428437937051058
Iteration: 2804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.453908771276474, gen p mean: 0.0, mean p set: 0.45261338353157043
The modified gen p mean: 0.4521404802799225, gen p mean: 0.0, mean p set: 0.45184382796287537
The modified gen p mean: 0.45219355821609497, gen p mean: 0.0, mean p set: 0.451729416847229
loss_pred:0.02614159882068634, decouple_loss:0.0076353116892278194
loss_pred:0.024936124682426453, decouple_loss:0.007587537635117769
loss_pred:0.02597428485751152, decouple_loss:0.007412932347506285
Iteration: 2805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500082731246948, gen p mean: 0.0, mean p set: 0.4515860676765442
The modified gen p mean: 0.45493048429489136, gen p mean: 0.0, mean p set: 0.4499078094959259
The modified gen p mean: 0.453359454870224, gen p mean: 0.0, mean p set: 0.4521573483943939
loss_pred:0.02470977045595646, decouple_loss:0.00749585684388876
loss_pred:0.026148775592446327, decouple_loss:0.0076632192358374596
loss_pred:0.026050694286823273, decouple_loss:0.007442879024893045
Iteration: 2806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45148223638534546, gen p mean: 0.0, mean p set: 0.4523273706436157
The modified gen p mean: 0.45135244727134705, gen p mean: 0.0, mean p set: 0.45186206698417664
The modified gen p mean: 0.45319125056266785, gen p mean: 0.0, mean p set: 0.4510248601436615
loss_pred:0.025959739461541176, decouple_loss:0.007661749143153429
loss_pred:0.026318848133087158, decouple_loss:0.007477821782231331
loss_pred:0.026234406977891922, decouple_loss:0.007859241217374802
Iteration: 2807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532349407672882, gen p mean: 0.0, mean p set: 0.4520612061023712
The modified gen p mean: 0.45379072427749634, gen p mean: 0.0, mean p set: 0.45262742042541504
The modified gen p mean: 0.4506566524505615, gen p mean: 0.0, mean p set: 0.45244550704956055
loss_pred:0.026621395722031593, decouple_loss:0.007326918188482523
loss_pred:0.026563284918665886, decouple_loss:0.007456429302692413
loss_pred:0.025612223893404007, decouple_loss:0.007533309981226921
Iteration: 2808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44309407472610474, gen p mean: 0.0, mean p set: 0.45053553581237793
The modified gen p mean: 0.4440309405326843, gen p mean: 0.0, mean p set: 0.4516755938529968
The modified gen p mean: 0.4417600631713867, gen p mean: 0.0, mean p set: 0.4519910514354706
loss_pred:0.029701920226216316, decouple_loss:0.008520129136741161
loss_pred:0.02856585755944252, decouple_loss:0.008299526758491993
loss_pred:0.028752798214554787, decouple_loss:0.008247556164860725
Iteration: 2809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4430849254131317, gen p mean: 0.0, mean p set: 0.45243212580680847
The modified gen p mean: 0.4385756552219391, gen p mean: 0.0, mean p set: 0.4525282084941864
The modified gen p mean: 0.4458148777484894, gen p mean: 0.0, mean p set: 0.4527874290943146
loss_pred:0.028201796114444733, decouple_loss:0.008328479714691639
loss_pred:0.02786913327872753, decouple_loss:0.008480994962155819
loss_pred:0.02977643348276615, decouple_loss:0.008411847054958344
Iteration: 2810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4581892192363739, gen p mean: 0.0, mean p set: 0.45208823680877686
The modified gen p mean: 0.45774754881858826, gen p mean: 0.0, mean p set: 0.4520227611064911
The modified gen p mean: 0.4553990364074707, gen p mean: 0.0, mean p set: 0.4510296881198883
loss_pred:0.027424026280641556, decouple_loss:0.008616521954536438
loss_pred:0.02782468870282173, decouple_loss:0.008829113095998764
loss_pred:0.028944987803697586, decouple_loss:0.008895063772797585
2023-05-03 09:16:58 testing...
The modified gen p mean: 0.4549724757671356, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45023202896118164, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4574749171733856, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027423830702900887, decouple_loss:0.009497581049799919
loss_pred:0.028411386534571648, decouple_loss:0.009639241732656956
loss_pred:0.02708195149898529, decouple_loss:0.009590993635356426
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02811785414814949, avg_mse: 0.03370281308889389
current test mse: 0.033703
Iteration: 2811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.455718994140625, gen p mean: 0.0, mean p set: 0.4518454968929291
The modified gen p mean: 0.46217453479766846, gen p mean: 0.0, mean p set: 0.4531855285167694
loss_pred:0.027643444016575813, decouple_loss:0.009297746233642101
loss_pred:0.027699893340468407, decouple_loss:0.00924074649810791
The modified gen p mean: 0.46115002036094666, gen p mean: 0.0, mean p set: 0.45021140575408936
loss_pred:0.02797582745552063, decouple_loss:0.009322687052190304
Iteration: 2812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471527934074402, gen p mean: 0.0, mean p set: 0.45208021998405457
The modified gen p mean: 0.44600269198417664, gen p mean: 0.0, mean p set: 0.45219916105270386
The modified gen p mean: 0.4471229910850525, gen p mean: 0.0, mean p set: 0.45157474279403687
loss_pred:0.027059659361839294, decouple_loss:0.009849521331489086
loss_pred:0.028384309262037277, decouple_loss:0.010305891744792461
loss_pred:0.0278864037245512, decouple_loss:0.010174871422350407
Iteration: 2813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4407215118408203, gen p mean: 0.0, mean p set: 0.4526708424091339
The modified gen p mean: 0.44155603647232056, gen p mean: 0.0, mean p set: 0.45204487442970276
The modified gen p mean: 0.43978551030158997, gen p mean: 0.0, mean p set: 0.4504854083061218
loss_pred:0.027092820033431053, decouple_loss:0.009919901378452778
loss_pred:0.026418861001729965, decouple_loss:0.009704683907330036
loss_pred:0.027670318260788918, decouple_loss:0.009910446591675282
Iteration: 2814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4550829231739044, gen p mean: 0.0, mean p set: 0.4523274898529053
The modified gen p mean: 0.4604770243167877, gen p mean: 0.0, mean p set: 0.45211732387542725
The modified gen p mean: 0.4578302502632141, gen p mean: 0.0, mean p set: 0.4524872899055481
loss_pred:0.026653388515114784, decouple_loss:0.010581371374428272
loss_pred:0.027200540527701378, decouple_loss:0.010709196329116821
loss_pred:0.026719748973846436, decouple_loss:0.0107594458386302
Iteration: 2815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4580446481704712, gen p mean: 0.0, mean p set: 0.4534855782985687
The modified gen p mean: 0.45846033096313477, gen p mean: 0.0, mean p set: 0.452579140663147
The modified gen p mean: 0.4563737213611603, gen p mean: 0.0, mean p set: 0.4510330855846405
loss_pred:0.026894137263298035, decouple_loss:0.010885818861424923
loss_pred:0.02739737555384636, decouple_loss:0.010850152000784874
loss_pred:0.026606502011418343, decouple_loss:0.010685848072171211
Iteration: 2816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452270269393921, gen p mean: 0.0, mean p set: 0.45199981331825256
The modified gen p mean: 0.4439147710800171, gen p mean: 0.0, mean p set: 0.45209604501724243
The modified gen p mean: 0.44023597240448, gen p mean: 0.0, mean p set: 0.45134681463241577
loss_pred:0.02608717978000641, decouple_loss:0.010648508556187153
loss_pred:0.027142351493239403, decouple_loss:0.01121252216398716
loss_pred:0.02600417099893093, decouple_loss:0.011083814315497875
Iteration: 2817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4584190547466278, gen p mean: 0.0, mean p set: 0.4526340067386627
The modified gen p mean: 0.4495548605918884, gen p mean: 0.0, mean p set: 0.4525078237056732
The modified gen p mean: 0.45361170172691345, gen p mean: 0.0, mean p set: 0.4530870020389557
loss_pred:0.027048908174037933, decouple_loss:0.01129489578306675
loss_pred:0.026843955740332603, decouple_loss:0.01085617858916521
loss_pred:0.0271174143999815, decouple_loss:0.011109590530395508
Iteration: 2818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45956897735595703, gen p mean: 0.0, mean p set: 0.45249855518341064
The modified gen p mean: 0.4623335301876068, gen p mean: 0.0, mean p set: 0.4515799880027771
The modified gen p mean: 0.4633854031562805, gen p mean: 0.0, mean p set: 0.4501059055328369
loss_pred:0.027200251817703247, decouple_loss:0.010515906848013401
loss_pred:0.027281908318400383, decouple_loss:0.010455863550305367
loss_pred:0.02783394604921341, decouple_loss:0.010699276812374592
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
NaN value num: 0
Iteration: 2819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4421859681606293, gen p mean: 0.0, mean p set: 0.44895002245903015
The modified gen p mean: 0.4436333179473877, gen p mean: 0.0, mean p set: 0.4479822516441345
The modified gen p mean: 0.4401656687259674, gen p mean: 0.0, mean p set: 0.4493470788002014
loss_pred:0.028605325147509575, decouple_loss:0.010779855772852898
loss_pred:0.028007443994283676, decouple_loss:0.01117139682173729
loss_pred:0.028725771233439445, decouple_loss:0.011048602871596813
Iteration: 2820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44364333152770996, gen p mean: 0.0, mean p set: 0.44871240854263306
The modified gen p mean: 0.44499632716178894, gen p mean: 0.0, mean p set: 0.44777801632881165
The modified gen p mean: 0.44776391983032227, gen p mean: 0.0, mean p set: 0.44792336225509644
loss_pred:0.027674812823534012, decouple_loss:0.011021990329027176
loss_pred:0.02706950530409813, decouple_loss:0.010699138976633549
loss_pred:0.027381394058465958, decouple_loss:0.010809525847434998
2023-05-03 09:21:47 testing...
The modified gen p mean: 0.4459202289581299, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4508262872695923, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.453838050365448, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.027899939566850662, decouple_loss:0.010965523310005665
loss_pred:0.02698109671473503, decouple_loss:0.010888834483921528
loss_pred:0.026555772870779037, decouple_loss:0.010965424589812756
WV_0_PC_0_EH_0_PS_40_6, loss: 0.027692599222064018, avg_mse: 0.033408090472221375
current test mse: 0.033408
Iteration: 2821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45307689905166626, gen p mean: 0.0, mean p set: 0.4479075074195862
The modified gen p mean: 0.4508775472640991, gen p mean: 0.0, mean p set: 0.4477321207523346
loss_pred:0.02844281867146492, decouple_loss:0.010996581055223942
loss_pred:0.02860182523727417, decouple_loss:0.010791893117129803
The modified gen p mean: 0.45045554637908936, gen p mean: 0.0, mean p set: 0.44853898882865906
loss_pred:0.028125757351517677, decouple_loss:0.01111631840467453
Iteration: 2822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481566846370697, gen p mean: 0.0, mean p set: 0.4474940896034241
The modified gen p mean: 0.4413202702999115, gen p mean: 0.0, mean p set: 0.44808903336524963
The modified gen p mean: 0.44089043140411377, gen p mean: 0.0, mean p set: 0.4493922293186188
loss_pred:0.028072401881217957, decouple_loss:0.010326312854886055
loss_pred:0.027416838333010674, decouple_loss:0.010244610719382763
loss_pred:0.027400024235248566, decouple_loss:0.01025398075580597
Iteration: 2823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510713815689087, gen p mean: 0.0, mean p set: 0.4474784731864929
The modified gen p mean: 0.44988420605659485, gen p mean: 0.0, mean p set: 0.44863903522491455
The modified gen p mean: 0.4502924084663391, gen p mean: 0.0, mean p set: 0.4478082060813904
loss_pred:0.027461765334010124, decouple_loss:0.0099325617775321
loss_pred:0.027194363996386528, decouple_loss:0.009997021406888962
loss_pred:0.027175018563866615, decouple_loss:0.009985365904867649
Iteration: 2824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45582178235054016, gen p mean: 0.0, mean p set: 0.44897785782814026
The modified gen p mean: 0.4539932608604431, gen p mean: 0.0, mean p set: 0.44848933815956116
The modified gen p mean: 0.4535684287548065, gen p mean: 0.0, mean p set: 0.44855156540870667
loss_pred:0.027593392878770828, decouple_loss:0.0103720398619771
loss_pred:0.027585865929722786, decouple_loss:0.010404963977634907
loss_pred:0.02700689621269703, decouple_loss:0.010412495583295822
Iteration: 2825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458812177181244, gen p mean: 0.0, mean p set: 0.44883155822753906
The modified gen p mean: 0.4468366801738739, gen p mean: 0.0, mean p set: 0.4494416415691376
The modified gen p mean: 0.45008665323257446, gen p mean: 0.0, mean p set: 0.44774329662323
loss_pred:0.028117675334215164, decouple_loss:0.009585782885551453
loss_pred:0.027873480692505836, decouple_loss:0.009804340079426765
loss_pred:0.02717156708240509, decouple_loss:0.009856825694441795
Iteration: 2826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4395207166671753, gen p mean: 0.0, mean p set: 0.44894248247146606
The modified gen p mean: 0.43857458233833313, gen p mean: 0.0, mean p set: 0.4483153223991394
The modified gen p mean: 0.44130295515060425, gen p mean: 0.0, mean p set: 0.44898611307144165
loss_pred:0.027970558032393456, decouple_loss:0.009325597435235977
loss_pred:0.026893027126789093, decouple_loss:0.00937533937394619
loss_pred:0.027659466490149498, decouple_loss:0.009399248287081718
Iteration: 2827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535277783870697, gen p mean: 0.0, mean p set: 0.44843775033950806
The modified gen p mean: 0.44861382246017456, gen p mean: 0.0, mean p set: 0.44803571701049805
The modified gen p mean: 0.4474368095397949, gen p mean: 0.0, mean p set: 0.4483753740787506
loss_pred:0.026948651298880577, decouple_loss:0.00950916763395071
loss_pred:0.02597380243241787, decouple_loss:0.009616517461836338
loss_pred:0.02528800256550312, decouple_loss:0.009695545770227909
Iteration: 2828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45583096146583557, gen p mean: 0.0, mean p set: 0.44887417554855347
The modified gen p mean: 0.45562419295310974, gen p mean: 0.0, mean p set: 0.4484483003616333
The modified gen p mean: 0.4543148875236511, gen p mean: 0.0, mean p set: 0.44815748929977417
loss_pred:0.02626802958548069, decouple_loss:0.00973396934568882
loss_pred:0.027108408510684967, decouple_loss:0.009583966806530952
loss_pred:0.0275337565690279, decouple_loss:0.009616885334253311
Iteration: 2829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4430685043334961, gen p mean: 0.0, mean p set: 0.4482278525829315
The modified gen p mean: 0.4417230784893036, gen p mean: 0.0, mean p set: 0.44785749912261963
The modified gen p mean: 0.44702446460723877, gen p mean: 0.0, mean p set: 0.4478190541267395
loss_pred:0.026949387043714523, decouple_loss:0.009263632819056511loss_pred:0.027013568207621574, decouple_loss:0.009273961186408997
loss_pred:0.027062203735113144, decouple_loss:0.00937945581972599
Iteration: 2830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4441559314727783, gen p mean: 0.0, mean p set: 0.44894295930862427
The modified gen p mean: 0.4405618906021118, gen p mean: 0.0, mean p set: 0.44949179887771606
The modified gen p mean: 0.44028759002685547, gen p mean: 0.0, mean p set: 0.4489932656288147
loss_pred:0.02599811740219593, decouple_loss:0.009111348539590836
loss_pred:0.02667064778506756, decouple_loss:0.009069548919796944
loss_pred:0.026147309690713882, decouple_loss:0.009103354997932911
2023-05-03 09:25:29 testing...
The modified gen p mean: 0.4503319263458252, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45500653982162476, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45759332180023193, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026879549026489258, decouple_loss:0.008951506577432156
loss_pred:0.02598407119512558, decouple_loss:0.008803374134004116
loss_pred:0.02558431401848793, decouple_loss:0.00882088765501976
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02659223973751068, avg_mse: 0.031976379454135895
current test mse: 0.031976
Iteration: 2831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513288140296936, gen p mean: 0.0, mean p set: 0.449349969625473
The modified gen p mean: 0.45803970098495483, gen p mean: 0.0, mean p set: 0.44886863231658936
loss_pred:0.02563316747546196, decouple_loss:0.008645249530673027
loss_pred:0.02608628384768963, decouple_loss:0.008696283213794231
The modified gen p mean: 0.4540201723575592, gen p mean: 0.0, mean p set: 0.44894954562187195
loss_pred:0.02651139348745346, decouple_loss:0.008752577006816864
Iteration: 2832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529223144054413, gen p mean: 0.0, mean p set: 0.4482477605342865
The modified gen p mean: 0.45071685314178467, gen p mean: 0.0, mean p set: 0.4481523036956787
The modified gen p mean: 0.4552982449531555, gen p mean: 0.0, mean p set: 0.4480125904083252
loss_pred:0.02682090923190117, decouple_loss:0.008760184980928898
loss_pred:0.026551874354481697, decouple_loss:0.00835722591727972
loss_pred:0.026625651866197586, decouple_loss:0.008374838158488274
Iteration: 2833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.443322092294693, gen p mean: 0.0, mean p set: 0.4487318992614746
The modified gen p mean: 0.4389646351337433, gen p mean: 0.0, mean p set: 0.4481373429298401
The modified gen p mean: 0.4433751404285431, gen p mean: 0.0, mean p set: 0.4485030770301819
loss_pred:0.025335663929581642, decouple_loss:0.008426443673670292
loss_pred:0.027243999764323235, decouple_loss:0.008374355733394623
loss_pred:0.02636105939745903, decouple_loss:0.008502423763275146
Iteration: 2834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4411665201187134, gen p mean: 0.0, mean p set: 0.447996586561203
The modified gen p mean: 0.4430515170097351, gen p mean: 0.0, mean p set: 0.4487142562866211
The modified gen p mean: 0.44632428884506226, gen p mean: 0.0, mean p set: 0.44804492592811584
loss_pred:0.026635954156517982, decouple_loss:0.008135543204843998
loss_pred:0.0269964337348938, decouple_loss:0.008284799754619598
loss_pred:0.026496442034840584, decouple_loss:0.008124950341880322
Iteration: 2835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.457574725151062, gen p mean: 0.0, mean p set: 0.44867268204689026
The modified gen p mean: 0.4503975212574005, gen p mean: 0.0, mean p set: 0.44815871119499207
The modified gen p mean: 0.4574012756347656, gen p mean: 0.0, mean p set: 0.4479096829891205
loss_pred:0.02637074515223503, decouple_loss:0.007908276282250881
loss_pred:0.02644607611000538, decouple_loss:0.007987803779542446
loss_pred:0.027052240446209908, decouple_loss:0.008022626861929893
Iteration: 2836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522753059864044, gen p mean: 0.0, mean p set: 0.4482729434967041
The modified gen p mean: 0.45411327481269836, gen p mean: 0.0, mean p set: 0.4481372833251953
The modified gen p mean: 0.4536410868167877, gen p mean: 0.0, mean p set: 0.4488413631916046
loss_pred:0.026419833302497864, decouple_loss:0.008009480312466621
loss_pred:0.02789064310491085, decouple_loss:0.007732009049504995
loss_pred:0.026670532301068306, decouple_loss:0.007872129790484905
Iteration: 2837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4338398575782776, gen p mean: 0.0, mean p set: 0.44841820001602173
The modified gen p mean: 0.4372689425945282, gen p mean: 0.0, mean p set: 0.44845062494277954
The modified gen p mean: 0.4386664927005768, gen p mean: 0.0, mean p set: 0.4482739567756653
loss_pred:0.025682279840111732, decouple_loss:0.008032131008803844
loss_pred:0.026329701766371727, decouple_loss:0.007842937484383583
loss_pred:0.026520734652876854, decouple_loss:0.00779450498521328
Iteration: 2838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44689294695854187, gen p mean: 0.0, mean p set: 0.4488488733768463
The modified gen p mean: 0.44649600982666016, gen p mean: 0.0, mean p set: 0.4491376578807831
The modified gen p mean: 0.44500991702079773, gen p mean: 0.0, mean p set: 0.44842007756233215
loss_pred:0.027338534593582153, decouple_loss:0.008192833513021469
loss_pred:0.027464939281344414, decouple_loss:0.00782878790050745
loss_pred:0.026713291183114052, decouple_loss:0.007842364721000195
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
NaN value num: 0
Iteration: 2839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46277227997779846, gen p mean: 0.0, mean p set: 0.4497148096561432
The modified gen p mean: 0.4657779932022095, gen p mean: 0.0, mean p set: 0.45040273666381836
The modified gen p mean: 0.46273091435432434, gen p mean: 0.0, mean p set: 0.45265257358551025
loss_pred:0.026350971311330795, decouple_loss:0.00801777746528387
loss_pred:0.026401514187455177, decouple_loss:0.007865638472139835
loss_pred:0.025855615735054016, decouple_loss:0.008990336209535599
Iteration: 2840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028385519981384, gen p mean: 0.0, mean p set: 0.45031604170799255
The modified gen p mean: 0.4486197829246521, gen p mean: 0.0, mean p set: 0.4503326416015625
The modified gen p mean: 0.453612357378006, gen p mean: 0.0, mean p set: 0.4501686692237854
loss_pred:0.026683177798986435, decouple_loss:0.008425680920481682
loss_pred:0.0270541999489069, decouple_loss:0.008391323499381542
loss_pred:0.025990253314375877, decouple_loss:0.007962173782289028
2023-05-03 09:30:15 testing...
The modified gen p mean: 0.4294285774230957, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.43424177169799805, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.43730810284614563, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026810044422745705, decouple_loss:0.008154201321303844
loss_pred:0.025767721235752106, decouple_loss:0.00791068747639656
loss_pred:0.02545483224093914, decouple_loss:0.007892333902418613
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02641015313565731, avg_mse: 0.03182370960712433
current test mse: 0.031824
Iteration: 2841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44049984216690063, gen p mean: 0.0, mean p set: 0.45032599568367004
The modified gen p mean: 0.4359944760799408, gen p mean: 0.0, mean p set: 0.45096808671951294
loss_pred:0.02544613927602768, decouple_loss:0.007656828500330448
loss_pred:0.025249376893043518, decouple_loss:0.007711254525929689
The modified gen p mean: 0.43662136793136597, gen p mean: 0.0, mean p set: 0.4532198905944824
loss_pred:0.026240801438689232, decouple_loss:0.008518325164914131
Iteration: 2842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530375897884369, gen p mean: 0.0, mean p set: 0.4507025480270386
The modified gen p mean: 0.44645383954048157, gen p mean: 0.0, mean p set: 0.4502440094947815
The modified gen p mean: 0.44888749718666077, gen p mean: 0.0, mean p set: 0.4507887363433838
loss_pred:0.02682015672326088, decouple_loss:0.007713483180850744
loss_pred:0.027288217097520828, decouple_loss:0.007924575358629227
loss_pred:0.025212299078702927, decouple_loss:0.007713483180850744
Iteration: 2843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46190136671066284, gen p mean: 0.0, mean p set: 0.45087239146232605
The modified gen p mean: 0.45741990208625793, gen p mean: 0.0, mean p set: 0.45016786456108093
The modified gen p mean: 0.4618009328842163, gen p mean: 0.0, mean p set: 0.45061424374580383
loss_pred:0.02589804120361805, decouple_loss:0.007527798414230347
loss_pred:0.026699595153331757, decouple_loss:0.007716367021203041
loss_pred:0.025470221415162086, decouple_loss:0.007450046017765999
Iteration: 2844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931209087371826, gen p mean: 0.0, mean p set: 0.4531312584877014
The modified gen p mean: 0.45134076476097107, gen p mean: 0.0, mean p set: 0.4500143229961395
The modified gen p mean: 0.4492611587047577, gen p mean: 0.0, mean p set: 0.4516725242137909
loss_pred:0.025891980156302452, decouple_loss:0.007458297535777092loss_pred:0.026040052995085716, decouple_loss:0.008091338910162449
loss_pred:0.026323946192860603, decouple_loss:0.0075689745135605335
Iteration: 2845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44437190890312195, gen p mean: 0.0, mean p set: 0.4534589648246765
The modified gen p mean: 0.4381765127182007, gen p mean: 0.0, mean p set: 0.44903984665870667
The modified gen p mean: 0.4469192624092102, gen p mean: 0.0, mean p set: 0.45018163323402405
loss_pred:0.02554926648736, decouple_loss:0.008228893391788006
loss_pred:0.025749782100319862, decouple_loss:0.0079606082290411
loss_pred:0.0258664358407259, decouple_loss:0.007711994461715221
Iteration: 2846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4555146098136902, gen p mean: 0.0, mean p set: 0.45020267367362976
The modified gen p mean: 0.4543890655040741, gen p mean: 0.0, mean p set: 0.45352625846862793
The modified gen p mean: 0.4518967568874359, gen p mean: 0.0, mean p set: 0.44917213916778564
loss_pred:0.027224745601415634, decouple_loss:0.0075352247804403305
loss_pred:0.02562643028795719, decouple_loss:0.007676283363252878
loss_pred:0.025690604001283646, decouple_loss:0.007418137509375811
Iteration: 2847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451883465051651, gen p mean: 0.0, mean p set: 0.44894298911094666
The modified gen p mean: 0.4518876075744629, gen p mean: 0.0, mean p set: 0.4510722756385803
The modified gen p mean: 0.45848798751831055, gen p mean: 0.0, mean p set: 0.4500192403793335
loss_pred:0.02476077899336815, decouple_loss:0.007330306805670261
loss_pred:0.025412285700440407, decouple_loss:0.00730476900935173
loss_pred:0.026367932558059692, decouple_loss:0.007158489897847176
Iteration: 2848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846123456954956, gen p mean: 0.0, mean p set: 0.4521060883998871
The modified gen p mean: 0.4472324252128601, gen p mean: 0.0, mean p set: 0.45406150817871094
The modified gen p mean: 0.45182982087135315, gen p mean: 0.0, mean p set: 0.44982537627220154
loss_pred:0.02600313164293766, decouple_loss:0.007971365936100483
loss_pred:0.02506694197654724, decouple_loss:0.007569957058876753
loss_pred:0.02607818879187107, decouple_loss:0.007474999874830246
Iteration: 2849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45011642575263977, gen p mean: 0.0, mean p set: 0.4496527314186096
The modified gen p mean: 0.44926854968070984, gen p mean: 0.0, mean p set: 0.45330190658569336
The modified gen p mean: 0.44533756375312805, gen p mean: 0.0, mean p set: 0.4493206739425659
loss_pred:0.025726575404405594, decouple_loss:0.007322377059608698
loss_pred:0.025265129283070564, decouple_loss:0.007297708187252283
loss_pred:0.025422239676117897, decouple_loss:0.007079240866005421
Iteration: 2850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45043954253196716, gen p mean: 0.0, mean p set: 0.451905757188797
The modified gen p mean: 0.4512183368206024, gen p mean: 0.0, mean p set: 0.4528343677520752
The modified gen p mean: 0.45130106806755066, gen p mean: 0.0, mean p set: 0.4511836767196655
loss_pred:0.02549203485250473, decouple_loss:0.006967511028051376
loss_pred:0.025635315105319023, decouple_loss:0.0073967063799500465
loss_pred:0.02661868929862976, decouple_loss:0.007571832276880741
2023-05-03 09:33:58 testing...
The modified gen p mean: 0.44342517852783203, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45080041885375977, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4481566548347473, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.026613125577569008, decouple_loss:0.008040163666009903
loss_pred:0.02527361363172531, decouple_loss:0.007895870134234428
loss_pred:0.025685401633381844, decouple_loss:0.007748789619654417
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026252126321196556, avg_mse: 0.031727176159620285
current test mse: 0.031727
Iteration: 2851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499336779117584, gen p mean: 0.0, mean p set: 0.4510878920555115
The modified gen p mean: 0.4461897313594818, gen p mean: 0.0, mean p set: 0.4477446675300598
loss_pred:0.026670489460229874, decouple_loss:0.007393379230052233
loss_pred:0.025083310902118683, decouple_loss:0.007311293389648199
The modified gen p mean: 0.45164263248443604, gen p mean: 0.0, mean p set: 0.44966429471969604
loss_pred:0.02681512013077736, decouple_loss:0.007611837703734636
Iteration: 2852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45429515838623047, gen p mean: 0.0, mean p set: 0.45304545760154724
The modified gen p mean: 0.4542344808578491, gen p mean: 0.0, mean p set: 0.4531964957714081
The modified gen p mean: 0.4489114284515381, gen p mean: 0.0, mean p set: 0.4494048058986664
loss_pred:0.025449611246585846, decouple_loss:0.007710542995482683
loss_pred:0.025938130915164948, decouple_loss:0.007622954435646534
loss_pred:0.024708230048418045, decouple_loss:0.00705955782905221
Iteration: 2853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519825577735901, gen p mean: 0.0, mean p set: 0.45045459270477295
The modified gen p mean: 0.445833295583725, gen p mean: 0.0, mean p set: 0.45020797848701477
The modified gen p mean: 0.45214417576789856, gen p mean: 0.0, mean p set: 0.45028528571128845
loss_pred:0.024735992774367332, decouple_loss:0.007054441142827272
loss_pred:0.02610018476843834, decouple_loss:0.007670298218727112
loss_pred:0.02517325058579445, decouple_loss:0.007131635677069426
Iteration: 2854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4428451955318451, gen p mean: 0.0, mean p set: 0.44921332597732544
The modified gen p mean: 0.44620946049690247, gen p mean: 0.0, mean p set: 0.45219725370407104
The modified gen p mean: 0.447002112865448, gen p mean: 0.0, mean p set: 0.4517436623573303
loss_pred:0.026140939444303513, decouple_loss:0.0072060441598296165
loss_pred:0.024949798360466957, decouple_loss:0.007377737667411566
loss_pred:0.02629118412733078, decouple_loss:0.007337243761867285
Iteration: 2855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542483985424042, gen p mean: 0.0, mean p set: 0.450695663690567
The modified gen p mean: 0.44850918650627136, gen p mean: 0.0, mean p set: 0.44981902837753296
The modified gen p mean: 0.4534432888031006, gen p mean: 0.0, mean p set: 0.4502916932106018
loss_pred:0.02592601627111435, decouple_loss:0.007070580963045359
loss_pred:0.025519996881484985, decouple_loss:0.007390324026346207
loss_pred:0.02639191783964634, decouple_loss:0.007191985845565796
Iteration: 2856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4556020200252533, gen p mean: 0.0, mean p set: 0.44924721121788025
The modified gen p mean: 0.45800337195396423, gen p mean: 0.0, mean p set: 0.4520338773727417
The modified gen p mean: 0.45287519693374634, gen p mean: 0.0, mean p set: 0.4493838846683502
loss_pred:0.02574651502072811, decouple_loss:0.007083334494382143
loss_pred:0.025664247572422028, decouple_loss:0.007279005367308855
loss_pred:0.02610817365348339, decouple_loss:0.00718536926433444
Iteration: 2857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45090314745903015, gen p mean: 0.0, mean p set: 0.45364704728126526
The modified gen p mean: 0.44565948843955994, gen p mean: 0.0, mean p set: 0.4506070911884308
The modified gen p mean: 0.45103076100349426, gen p mean: 0.0, mean p set: 0.4499790072441101
loss_pred:0.025181084871292114, decouple_loss:0.007258475758135319
loss_pred:0.02615967020392418, decouple_loss:0.006977969314903021
loss_pred:0.025729099288582802, decouple_loss:0.006706357467919588
Iteration: 2858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825872778892517, gen p mean: 0.0, mean p set: 0.4534813165664673
The modified gen p mean: 0.44800877571105957, gen p mean: 0.0, mean p set: 0.4505581855773926
The modified gen p mean: 0.4476795494556427, gen p mean: 0.0, mean p set: 0.4505661725997925
loss_pred:0.026119789108633995, decouple_loss:0.007170391269028187
loss_pred:0.025531498715281487, decouple_loss:0.007046411279588938
loss_pred:0.024585386738181114, decouple_loss:0.006820325274020433
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 2859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527229070663452, gen p mean: 0.0, mean p set: 0.45275095105171204
The modified gen p mean: 0.4520931839942932, gen p mean: 0.0, mean p set: 0.4516623318195343
The modified gen p mean: 0.4501365125179291, gen p mean: 0.0, mean p set: 0.4526892900466919
loss_pred:0.025923464447259903, decouple_loss:0.007643829565495253
loss_pred:0.02526569738984108, decouple_loss:0.007329752668738365
loss_pred:0.02390880696475506, decouple_loss:0.007704166229814291
Iteration: 2860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515717923641205, gen p mean: 0.0, mean p set: 0.4515630006790161
The modified gen p mean: 0.4510827958583832, gen p mean: 0.0, mean p set: 0.4531942903995514
The modified gen p mean: 0.45333072543144226, gen p mean: 0.0, mean p set: 0.4519002437591553
loss_pred:0.026235105469822884, decouple_loss:0.0074797384440898895
loss_pred:0.024737928062677383, decouple_loss:0.007684484124183655
loss_pred:0.023758171126246452, decouple_loss:0.007772714365273714
2023-05-03 09:38:29 testing...
The modified gen p mean: 0.4499695599079132, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44470563530921936, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4527989625930786, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.025534192100167274, decouple_loss:0.007639010436832905
loss_pred:0.02651936560869217, decouple_loss:0.007895615883171558
loss_pred:0.02526172250509262, decouple_loss:0.0077568222768604755
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026159953325986862, avg_mse: 0.03160471096634865
current test mse: 0.031605
Iteration: 2861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45429185032844543, gen p mean: 0.0, mean p set: 0.4517904222011566
loss_pred:0.026761513203382492, decouple_loss:0.007382608018815517
The modified gen p mean: 0.4510456919670105, gen p mean: 0.0, mean p set: 0.4515043795108795
loss_pred:0.025701357051730156, decouple_loss:0.007648251485079527
The modified gen p mean: 0.45533865690231323, gen p mean: 0.0, mean p set: 0.4521775543689728
loss_pred:0.025647424161434174, decouple_loss:0.007251959294080734
Iteration: 2862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45390138030052185, gen p mean: 0.0, mean p set: 0.45324259996414185
The modified gen p mean: 0.4517597556114197, gen p mean: 0.0, mean p set: 0.4528883397579193
The modified gen p mean: 0.4532972276210785, gen p mean: 0.0, mean p set: 0.45318663120269775
loss_pred:0.023366650566458702, decouple_loss:0.007280036807060242
loss_pred:0.024580517783761024, decouple_loss:0.00725528784096241
loss_pred:0.023850303143262863, decouple_loss:0.007442119996994734
Iteration: 2863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024728775024414, gen p mean: 0.0, mean p set: 0.4518548846244812
The modified gen p mean: 0.457059383392334, gen p mean: 0.0, mean p set: 0.4510493874549866
The modified gen p mean: 0.4503328800201416, gen p mean: 0.0, mean p set: 0.45294755697250366
loss_pred:0.0256268922239542, decouple_loss:0.007136188447475433
loss_pred:0.026866627857089043, decouple_loss:0.0071402862668037415
loss_pred:0.024100100621581078, decouple_loss:0.007298693992197514
Iteration: 2864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44352617859840393, gen p mean: 0.0, mean p set: 0.451452374458313
The modified gen p mean: 0.44347330927848816, gen p mean: 0.0, mean p set: 0.45439326763153076
loss_pred:0.02537631243467331, decouple_loss:0.007119085639715195
The modified gen p mean: 0.4430104196071625, gen p mean: 0.0, mean p set: 0.4524921178817749
loss_pred:0.024459149688482285, decouple_loss:0.007297098636627197
loss_pred:0.024068374186754227, decouple_loss:0.0072541977278888226
Iteration: 2865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540018141269684, gen p mean: 0.0, mean p set: 0.45320072770118713
The modified gen p mean: 0.4497821033000946, gen p mean: 0.0, mean p set: 0.4518386423587799
The modified gen p mean: 0.449268639087677, gen p mean: 0.0, mean p set: 0.4535389542579651
loss_pred:0.024167487397789955, decouple_loss:0.007029794622212648
loss_pred:0.02553221397101879, decouple_loss:0.006991904228925705
loss_pred:0.024365631863474846, decouple_loss:0.007137682288885117
Iteration: 2866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46160322427749634, gen p mean: 0.0, mean p set: 0.4526309072971344
The modified gen p mean: 0.4621034860610962, gen p mean: 0.0, mean p set: 0.4513503611087799
The modified gen p mean: 0.4618971049785614, gen p mean: 0.0, mean p set: 0.4510186016559601
loss_pred:0.024644799530506134, decouple_loss:0.007048781029880047loss_pred:0.025697961449623108, decouple_loss:0.007089540362358093
loss_pred:0.025364741683006287, decouple_loss:0.007207952439785004
Iteration: 2867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534914493560791, gen p mean: 0.0, mean p set: 0.4514450132846832
The modified gen p mean: 0.450958251953125, gen p mean: 0.0, mean p set: 0.45152196288108826
The modified gen p mean: 0.4551789164543152, gen p mean: 0.0, mean p set: 0.4521760940551758
loss_pred:0.025230487808585167, decouple_loss:0.0074244095012545586loss_pred:0.025270605459809303, decouple_loss:0.007281685248017311
loss_pred:0.02504824288189411, decouple_loss:0.007187719456851482
Iteration: 2868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4444403648376465, gen p mean: 0.0, mean p set: 0.45229020714759827
The modified gen p mean: 0.445842444896698, gen p mean: 0.0, mean p set: 0.4511641561985016
The modified gen p mean: 0.4432082176208496, gen p mean: 0.0, mean p set: 0.4527444541454315
loss_pred:0.025415048003196716, decouple_loss:0.006791137624531984
loss_pred:0.023803377524018288, decouple_loss:0.007401922717690468
loss_pred:0.024804724380373955, decouple_loss:0.006892267148941755
Iteration: 2869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450787305831909, gen p mean: 0.0, mean p set: 0.45180612802505493
The modified gen p mean: 0.45172086358070374, gen p mean: 0.0, mean p set: 0.45182904601097107
The modified gen p mean: 0.4444153904914856, gen p mean: 0.0, mean p set: 0.4516349136829376
loss_pred:0.025450441986322403, decouple_loss:0.006873691454529762
loss_pred:0.02616591565310955, decouple_loss:0.006903182715177536
loss_pred:0.025496942922472954, decouple_loss:0.006883388385176659
Iteration: 2870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4568546712398529, gen p mean: 0.0, mean p set: 0.45268580317497253
The modified gen p mean: 0.457498699426651, gen p mean: 0.0, mean p set: 0.4534226953983307
The modified gen p mean: 0.453647255897522, gen p mean: 0.0, mean p set: 0.45096346735954285
loss_pred:0.0255716685205698, decouple_loss:0.006732499692589045
loss_pred:0.023799624294042587, decouple_loss:0.007134740240871906
loss_pred:0.025590457022190094, decouple_loss:0.007005386054515839
2023-05-03 09:42:11 testing...
The modified gen p mean: 0.44745180010795593, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45538946986198425, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4526048004627228, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.026528872549533844, decouple_loss:0.007767029572278261
loss_pred:0.025189582258462906, decouple_loss:0.0077512143179774284
loss_pred:0.025438738986849785, decouple_loss:0.007621933240443468
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02610473707318306, avg_mse: 0.031578294932842255
current test mse: 0.031578
Iteration: 2871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4566929042339325, gen p mean: 0.0, mean p set: 0.45319366455078125
The modified gen p mean: 0.45542284846305847, gen p mean: 0.0, mean p set: 0.4548146724700928
loss_pred:0.023021504282951355, decouple_loss:0.006962750572711229
loss_pred:0.023952506482601166, decouple_loss:0.007118718698620796
The modified gen p mean: 0.4540497064590454, gen p mean: 0.0, mean p set: 0.45281070470809937
loss_pred:0.024757269769906998, decouple_loss:0.007108950987458229
Iteration: 2872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44569748640060425, gen p mean: 0.0, mean p set: 0.4533170461654663
The modified gen p mean: 0.4470178484916687, gen p mean: 0.0, mean p set: 0.4527256488800049
The modified gen p mean: 0.45176172256469727, gen p mean: 0.0, mean p set: 0.4512292742729187
loss_pred:0.023913871496915817, decouple_loss:0.006940932944417
loss_pred:0.024147968739271164, decouple_loss:0.007206807378679514
loss_pred:0.02680460549890995, decouple_loss:0.006994382943958044
Iteration: 2873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4551355838775635, gen p mean: 0.0, mean p set: 0.4512959122657776
The modified gen p mean: 0.45350655913352966, gen p mean: 0.0, mean p set: 0.45270848274230957
The modified gen p mean: 0.45311298966407776, gen p mean: 0.0, mean p set: 0.4513244330883026
loss_pred:0.023943312466144562, decouple_loss:0.007252666633576155
loss_pred:0.02523522824048996, decouple_loss:0.007016871590167284
loss_pred:0.025467166677117348, decouple_loss:0.006973084527999163
Iteration: 2874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4576627016067505, gen p mean: 0.0, mean p set: 0.45146000385284424
The modified gen p mean: 0.4540536403656006, gen p mean: 0.0, mean p set: 0.45269855856895447
The modified gen p mean: 0.45487141609191895, gen p mean: 0.0, mean p set: 0.4525940418243408
loss_pred:0.02406339719891548, decouple_loss:0.006908278912305832
loss_pred:0.023664940148591995, decouple_loss:0.0068891942501068115
loss_pred:0.024351373314857483, decouple_loss:0.006765957921743393
Iteration: 2875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868114590644836, gen p mean: 0.0, mean p set: 0.45446059107780457
The modified gen p mean: 0.44739288091659546, gen p mean: 0.0, mean p set: 0.4503368139266968
The modified gen p mean: 0.4502509534358978, gen p mean: 0.0, mean p set: 0.45130228996276855
loss_pred:0.02332947961986065, decouple_loss:0.006946862209588289
loss_pred:0.02510831691324711, decouple_loss:0.006729381158947945
loss_pred:0.023618478327989578, decouple_loss:0.006864725146442652
Iteration: 2876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497765898704529, gen p mean: 0.0, mean p set: 0.45264923572540283
The modified gen p mean: 0.45073771476745605, gen p mean: 0.0, mean p set: 0.4519941210746765
The modified gen p mean: 0.45083850622177124, gen p mean: 0.0, mean p set: 0.4533042907714844
loss_pred:0.024233853444457054, decouple_loss:0.006902620196342468
loss_pred:0.024616165086627007, decouple_loss:0.006790934596210718
loss_pred:0.023956093937158585, decouple_loss:0.006624206434935331
Iteration: 2877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45672956109046936, gen p mean: 0.0, mean p set: 0.45297735929489136
The modified gen p mean: 0.454733282327652, gen p mean: 0.0, mean p set: 0.4541351795196533
The modified gen p mean: 0.45379260182380676, gen p mean: 0.0, mean p set: 0.45395946502685547
loss_pred:0.023568855598568916, decouple_loss:0.006640920881181955
loss_pred:0.02375035732984543, decouple_loss:0.006749880034476519
loss_pred:0.024042561650276184, decouple_loss:0.006740394048392773
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 2878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783660769462585, gen p mean: 0.0, mean p set: 0.44713470339775085
The modified gen p mean: 0.44930601119995117, gen p mean: 0.0, mean p set: 0.44744786620140076
The modified gen p mean: 0.4462377429008484, gen p mean: 0.0, mean p set: 0.44751712679862976
loss_pred:0.026540812104940414, decouple_loss:0.00747985765337944
loss_pred:0.026791488751769066, decouple_loss:0.007896235212683678
loss_pred:0.026594413444399834, decouple_loss:0.007701572496443987
Iteration: 2879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470253586769104, gen p mean: 0.0, mean p set: 0.4463140368461609
The modified gen p mean: 0.44453027844429016, gen p mean: 0.0, mean p set: 0.44799020886421204
The modified gen p mean: 0.44530820846557617, gen p mean: 0.0, mean p set: 0.4484979510307312
loss_pred:0.026392295956611633, decouple_loss:0.007539716083556414
loss_pred:0.025755800306797028, decouple_loss:0.007342385593801737
loss_pred:0.026609234511852264, decouple_loss:0.007476703263819218
Iteration: 2880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455842077732086, gen p mean: 0.0, mean p set: 0.44653645157814026
The modified gen p mean: 0.4436388313770294, gen p mean: 0.0, mean p set: 0.44851207733154297
The modified gen p mean: 0.44476377964019775, gen p mean: 0.0, mean p set: 0.447732150554657
loss_pred:0.025365862995386124, decouple_loss:0.007075242232531309
loss_pred:0.025470880791544914, decouple_loss:0.007733538281172514
loss_pred:0.025973115116357803, decouple_loss:0.007525954395532608
2023-05-03 09:46:49 testing...
The modified gen p mean: 0.4523119330406189, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44720155000686646, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4549005925655365, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.025434497743844986, decouple_loss:0.007053145673125982
loss_pred:0.026379212737083435, decouple_loss:0.007138876710087061
loss_pred:0.025111619383096695, decouple_loss:0.007168896496295929
WV_0_PC_0_EH_0_PS_40_6, loss: 0.025997793301939964, avg_mse: 0.03141658008098602
current test mse: 0.031417
Iteration: 2881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508659243583679, gen p mean: 0.0, mean p set: 0.4480991065502167
The modified gen p mean: 0.45245540142059326, gen p mean: 0.0, mean p set: 0.448323518037796
loss_pred:0.026057075709104538, decouple_loss:0.007034705486148596
loss_pred:0.026554863899946213, decouple_loss:0.007223436143249273
The modified gen p mean: 0.452316552400589, gen p mean: 0.0, mean p set: 0.44737792015075684
loss_pred:0.025788329541683197, decouple_loss:0.007165635470300913
Iteration: 2882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4446949064731598, gen p mean: 0.0, mean p set: 0.4473114311695099
The modified gen p mean: 0.44237926602363586, gen p mean: 0.0, mean p set: 0.447918564081192
The modified gen p mean: 0.44359245896339417, gen p mean: 0.0, mean p set: 0.4471801817417145
loss_pred:0.025259360671043396, decouple_loss:0.007007281761616468
loss_pred:0.025453025475144386, decouple_loss:0.007485818117856979
loss_pred:0.02693335711956024, decouple_loss:0.0070373304188251495
Iteration: 2883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523368179798126, gen p mean: 0.0, mean p set: 0.44616246223449707
The modified gen p mean: 0.44879138469696045, gen p mean: 0.0, mean p set: 0.4457741975784302
The modified gen p mean: 0.4494590759277344, gen p mean: 0.0, mean p set: 0.4467202425003052
loss_pred:0.027157047763466835, decouple_loss:0.006922973785549402
loss_pred:0.02575070969760418, decouple_loss:0.007078765891492367
loss_pred:0.02608928643167019, decouple_loss:0.0068635414354503155
Iteration: 2884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686245918273926, gen p mean: 0.0, mean p set: 0.44807806611061096
The modified gen p mean: 0.4483502507209778, gen p mean: 0.0, mean p set: 0.44702646136283875
The modified gen p mean: 0.4498119056224823, gen p mean: 0.0, mean p set: 0.44787484407424927
loss_pred:0.026357043534517288, decouple_loss:0.006721696816384792
loss_pred:0.025869445875287056, decouple_loss:0.007024289574474096
loss_pred:0.026031380519270897, decouple_loss:0.006886191200464964
Iteration: 2885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4440571069717407, gen p mean: 0.0, mean p set: 0.44813206791877747
The modified gen p mean: 0.4444983899593353, gen p mean: 0.0, mean p set: 0.44692856073379517
The modified gen p mean: 0.44426780939102173, gen p mean: 0.0, mean p set: 0.4465000033378601
loss_pred:0.02647029608488083, decouple_loss:0.006791303865611553
loss_pred:0.02535831741988659, decouple_loss:0.006751617416739464
loss_pred:0.02561393938958645, decouple_loss:0.006677782163023949
Iteration: 2886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4430771470069885, gen p mean: 0.0, mean p set: 0.4469307065010071
The modified gen p mean: 0.44164344668388367, gen p mean: 0.0, mean p set: 0.4470173120498657
The modified gen p mean: 0.44220656156539917, gen p mean: 0.0, mean p set: 0.44655176997184753
loss_pred:0.02659505605697632, decouple_loss:0.006666745524853468
loss_pred:0.025959575548768044, decouple_loss:0.006613525096327066
loss_pred:0.026284825056791306, decouple_loss:0.0065960753709077835
Iteration: 2887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495117962360382, gen p mean: 0.0, mean p set: 0.44640329480171204
The modified gen p mean: 0.45231589674949646, gen p mean: 0.0, mean p set: 0.4464031159877777
The modified gen p mean: 0.45062756538391113, gen p mean: 0.0, mean p set: 0.4484235644340515
loss_pred:0.02584335394203663, decouple_loss:0.0066580199636518955
loss_pred:0.026097627356648445, decouple_loss:0.006865073461085558
loss_pred:0.025334687903523445, decouple_loss:0.006915371399372816
Iteration: 2888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528075158596039, gen p mean: 0.0, mean p set: 0.4469420909881592
The modified gen p mean: 0.4489128589630127, gen p mean: 0.0, mean p set: 0.44695183634757996
The modified gen p mean: 0.45192259550094604, gen p mean: 0.0, mean p set: 0.4479850232601166
loss_pred:0.027028050273656845, decouple_loss:0.006857754196971655
loss_pred:0.026038527488708496, decouple_loss:0.00697345333173871
loss_pred:0.026233874261379242, decouple_loss:0.006928154267370701
Iteration: 2889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4403148889541626, gen p mean: 0.0, mean p set: 0.4470498263835907
The modified gen p mean: 0.44495272636413574, gen p mean: 0.0, mean p set: 0.44671353697776794
The modified gen p mean: 0.44232118129730225, gen p mean: 0.0, mean p set: 0.44888943433761597
loss_pred:0.024946624413132668, decouple_loss:0.006740152835845947
loss_pred:0.026127776131033897, decouple_loss:0.006743034813553095
loss_pred:0.02628241665661335, decouple_loss:0.007114039734005928
Iteration: 2890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716453552246094, gen p mean: 0.0, mean p set: 0.44725537300109863
The modified gen p mean: 0.44345441460609436, gen p mean: 0.0, mean p set: 0.44631776213645935
The modified gen p mean: 0.4451952278614044, gen p mean: 0.0, mean p set: 0.4463808834552765
loss_pred:0.02539096027612686, decouple_loss:0.006746480241417885
loss_pred:0.025522790849208832, decouple_loss:0.006747197359800339
loss_pred:0.025617338716983795, decouple_loss:0.006649938877671957
2023-05-03 09:50:30 testing...
The modified gen p mean: 0.4517551362514496, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4464606046676636, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4545024633407593, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02532820589840412, decouple_loss:0.006898068357259035
loss_pred:0.02630515582859516, decouple_loss:0.007031957618892193
loss_pred:0.02502768114209175, decouple_loss:0.006945018190890551
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02590160071849823, avg_mse: 0.031301915645599365
current test mse: 0.031302
Iteration: 2891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511762261390686, gen p mean: 0.0, mean p set: 0.448532372713089
The modified gen p mean: 0.4506429135799408, gen p mean: 0.0, mean p set: 0.44679760932922363
loss_pred:0.026069466024637222, decouple_loss:0.0066995383240282536
loss_pred:0.026265570893883705, decouple_loss:0.006610996089875698
The modified gen p mean: 0.45138996839523315, gen p mean: 0.0, mean p set: 0.4469846189022064
loss_pred:0.02686317451298237, decouple_loss:0.006589310243725777
Iteration: 2892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481504559516907, gen p mean: 0.0, mean p set: 0.4467087388038635
The modified gen p mean: 0.44549912214279175, gen p mean: 0.0, mean p set: 0.44809842109680176
The modified gen p mean: 0.44617030024528503, gen p mean: 0.0, mean p set: 0.44704657793045044
loss_pred:0.026680709794163704, decouple_loss:0.006720464210957289
loss_pred:0.02589665725827217, decouple_loss:0.007025201804935932
loss_pred:0.025870652869343758, decouple_loss:0.006283633876591921
Iteration: 2893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44538408517837524, gen p mean: 0.0, mean p set: 0.4469722807407379
The modified gen p mean: 0.4434230625629425, gen p mean: 0.0, mean p set: 0.4471932351589203
The modified gen p mean: 0.44540971517562866, gen p mean: 0.0, mean p set: 0.44669607281684875
loss_pred:0.025442227721214294, decouple_loss:0.00639722915366292
loss_pred:0.026360809803009033, decouple_loss:0.006448582746088505
loss_pred:0.025346826761960983, decouple_loss:0.006455857306718826
Iteration: 2894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44452932476997375, gen p mean: 0.0, mean p set: 0.44643494486808777
The modified gen p mean: 0.442759245634079, gen p mean: 0.0, mean p set: 0.4482622444629669
The modified gen p mean: 0.4459728002548218, gen p mean: 0.0, mean p set: 0.44788745045661926
loss_pred:0.02533501386642456, decouple_loss:0.00637491699308157
loss_pred:0.02646547183394432, decouple_loss:0.00678734015673399
loss_pred:0.026095855981111526, decouple_loss:0.006433515343815088
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974973797798157, gen p mean: 0.0, mean p set: 0.4462362825870514
The modified gen p mean: 0.4532213807106018, gen p mean: 0.0, mean p set: 0.4472399353981018
The modified gen p mean: 0.4506947100162506, gen p mean: 0.0, mean p set: 0.447105348110199
loss_pred:0.025258660316467285, decouple_loss:0.006548136938363314
loss_pred:0.026505308225750923, decouple_loss:0.006893811747431755
loss_pred:0.026376254856586456, decouple_loss:0.006599392741918564
Iteration: 2896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794419407844543, gen p mean: 0.0, mean p set: 0.4460800588130951
The modified gen p mean: 0.44610273838043213, gen p mean: 0.0, mean p set: 0.44667407870292664
The modified gen p mean: 0.4481074810028076, gen p mean: 0.0, mean p set: 0.44766902923583984
loss_pred:0.025657737627625465, decouple_loss:0.006601936183869839
loss_pred:0.026154890656471252, decouple_loss:0.006493172142654657
loss_pred:0.025920789688825607, decouple_loss:0.006872260943055153
Iteration: 2897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443562626838684, gen p mean: 0.0, mean p set: 0.4474559724330902
The modified gen p mean: 0.4412851333618164, gen p mean: 0.0, mean p set: 0.44775912165641785
The modified gen p mean: 0.44393765926361084, gen p mean: 0.0, mean p set: 0.44596222043037415
loss_pred:0.025320833548903465, decouple_loss:0.006854316685348749
loss_pred:0.026161957532167435, decouple_loss:0.006471697706729174
loss_pred:0.025509575381875038, decouple_loss:0.006556991953402758
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
NaN value num: 0
Iteration: 2898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059797167778015, gen p mean: 0.0, mean p set: 0.4504970610141754
The modified gen p mean: 0.4543289244174957, gen p mean: 0.0, mean p set: 0.45246466994285583
The modified gen p mean: 0.45384469628334045, gen p mean: 0.0, mean p set: 0.4521169364452362
loss_pred:0.02378164418041706, decouple_loss:0.007458993699401617
loss_pred:0.02402692660689354, decouple_loss:0.007702577859163284
loss_pred:0.025602106004953384, decouple_loss:0.007373922970145941
Iteration: 2899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513041079044342, gen p mean: 0.0, mean p set: 0.4504610598087311
The modified gen p mean: 0.45711052417755127, gen p mean: 0.0, mean p set: 0.45038190484046936
loss_pred:0.0253082774579525, decouple_loss:0.007515660021454096
The modified gen p mean: 0.45561885833740234, gen p mean: 0.0, mean p set: 0.4521903395652771
loss_pred:0.024982159957289696, decouple_loss:0.007431487552821636
loss_pred:0.024584200233221054, decouple_loss:0.007209396921098232
Iteration: 2900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915443658828735, gen p mean: 0.0, mean p set: 0.4498084783554077
The modified gen p mean: 0.44330379366874695, gen p mean: 0.0, mean p set: 0.44847941398620605
The modified gen p mean: 0.4506891667842865, gen p mean: 0.0, mean p set: 0.4514666199684143
loss_pred:0.025494426488876343, decouple_loss:0.007177126128226519
loss_pred:0.024451665580272675, decouple_loss:0.007371225859969854
loss_pred:0.025366296991705894, decouple_loss:0.007784734945744276
2023-05-03 09:55:07 testing...
The modified gen p mean: 0.4404873549938202, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44545599818229675, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4479426145553589, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.026306482031941414, decouple_loss:0.007169261574745178
loss_pred:0.025227095931768417, decouple_loss:0.007050404790788889
loss_pred:0.02496979758143425, decouple_loss:0.007034248672425747
WV_0_PC_0_EH_0_PS_40_6, loss: 0.025855358690023422, avg_mse: 0.031238866969943047
current test mse: 0.031239
Iteration: 2901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960352778434753, gen p mean: 0.0, mean p set: 0.45203638076782227
The modified gen p mean: 0.4527891278266907, gen p mean: 0.0, mean p set: 0.4521304666996002
loss_pred:0.02366829849779606, decouple_loss:0.007100295275449753
loss_pred:0.025051355361938477, decouple_loss:0.007060334552079439
The modified gen p mean: 0.45195668935775757, gen p mean: 0.0, mean p set: 0.4513375163078308
loss_pred:0.02475021407008171, decouple_loss:0.007463912479579449
Iteration: 2902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487813711166382, gen p mean: 0.0, mean p set: 0.4527328312397003
The modified gen p mean: 0.4463731348514557, gen p mean: 0.0, mean p set: 0.4497377276420593
The modified gen p mean: 0.4491584002971649, gen p mean: 0.0, mean p set: 0.45148730278015137
loss_pred:0.023875752463936806, decouple_loss:0.006761481985449791
loss_pred:0.024582406505942345, decouple_loss:0.007248076610267162
loss_pred:0.024952856823801994, decouple_loss:0.007094372995197773
Iteration: 2903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4419955015182495, gen p mean: 0.0, mean p set: 0.4497178792953491The modified gen p mean: 0.4481595456600189, gen p mean: 0.0, mean p set: 0.4515971541404724
The modified gen p mean: 0.4491884410381317, gen p mean: 0.0, mean p set: 0.45218411087989807
loss_pred:0.024249088019132614, decouple_loss:0.007195356767624617
loss_pred:0.02505979686975479, decouple_loss:0.007164992857724428
loss_pred:0.024200843647122383, decouple_loss:0.0066038332879543304
Iteration: 2904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45401009917259216, gen p mean: 0.0, mean p set: 0.4522576630115509
The modified gen p mean: 0.4492467939853668, gen p mean: 0.0, mean p set: 0.44944530725479126
The modified gen p mean: 0.4581369161605835, gen p mean: 0.0, mean p set: 0.4523736536502838
loss_pred:0.024079754948616028, decouple_loss:0.006565159652382135
loss_pred:0.024455638602375984, decouple_loss:0.007092237938195467
loss_pred:0.02385883592069149, decouple_loss:0.006783930119127035
Iteration: 2905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45668140053749084, gen p mean: 0.0, mean p set: 0.4495699107646942
The modified gen p mean: 0.4551524519920349, gen p mean: 0.0, mean p set: 0.4487546980381012
The modified gen p mean: 0.45769792795181274, gen p mean: 0.0, mean p set: 0.44983968138694763
loss_pred:0.02577916905283928, decouple_loss:0.00708487443625927
loss_pred:0.024613196030259132, decouple_loss:0.006712145637720823
loss_pred:0.023856082931160927, decouple_loss:0.00669394014403224
Iteration: 2906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134589076042175, gen p mean: 0.0, mean p set: 0.4520106315612793
The modified gen p mean: 0.45167702436447144, gen p mean: 0.0, mean p set: 0.45165911316871643
The modified gen p mean: 0.44903281331062317, gen p mean: 0.0, mean p set: 0.4513408839702606
loss_pred:0.02360784262418747, decouple_loss:0.0067170169204473495
loss_pred:0.024814553558826447, decouple_loss:0.0069080558605492115
loss_pred:0.02379710227251053, decouple_loss:0.006698330398648977
Iteration: 2907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451877474784851, gen p mean: 0.0, mean p set: 0.4519042372703552
The modified gen p mean: 0.44908735156059265, gen p mean: 0.0, mean p set: 0.45161959528923035
The modified gen p mean: 0.44665372371673584, gen p mean: 0.0, mean p set: 0.4505823850631714
loss_pred:0.024311579763889313, decouple_loss:0.006684647873044014
loss_pred:0.0253121480345726, decouple_loss:0.007023697718977928
loss_pred:0.02526034228503704, decouple_loss:0.007104482967406511
Iteration: 2908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44390401244163513, gen p mean: 0.0, mean p set: 0.45235124230384827
The modified gen p mean: 0.4478689432144165, gen p mean: 0.0, mean p set: 0.45078280568122864
The modified gen p mean: 0.4476943612098694, gen p mean: 0.0, mean p set: 0.45218491554260254
loss_pred:0.02436003088951111, decouple_loss:0.00644471263512969
loss_pred:0.024938290938735008, decouple_loss:0.006849708966910839
loss_pred:0.024501636624336243, decouple_loss:0.006713026203215122
Iteration: 2909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529745578765869, gen p mean: 0.0, mean p set: 0.451455295085907
The modified gen p mean: 0.4538869857788086, gen p mean: 0.0, mean p set: 0.45207884907722473
The modified gen p mean: 0.4480166733264923, gen p mean: 0.0, mean p set: 0.44927680492401123
loss_pred:0.024563197046518326, decouple_loss:0.006708567030727863
loss_pred:0.02382064424455166, decouple_loss:0.006437634117901325
loss_pred:0.026623858138918877, decouple_loss:0.006942471489310265
Iteration: 2910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4556190073490143, gen p mean: 0.0, mean p set: 0.4498288631439209
The modified gen p mean: 0.46036529541015625, gen p mean: 0.0, mean p set: 0.4517684876918793
The modified gen p mean: 0.45413193106651306, gen p mean: 0.0, mean p set: 0.4491320550441742
loss_pred:0.025021951645612717, decouple_loss:0.006943780463188887
loss_pred:0.024729285389184952, decouple_loss:0.006613130681216717
loss_pred:0.024941353127360344, decouple_loss:0.0066686044447124004
2023-05-03 09:58:50 testing...
The modified gen p mean: 0.44041651487350464, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.445607453584671, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44825220108032227, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02640656568109989, decouple_loss:0.007571945432573557
loss_pred:0.02533600851893425, decouple_loss:0.007302464917302132
loss_pred:0.02501918561756611, decouple_loss:0.0073495483957231045
WV_0_PC_0_EH_0_PS_40_6, loss: 0.025957655161619186, avg_mse: 0.03139893338084221
current test mse: 0.031399
Iteration: 2911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526017904281616, gen p mean: 0.0, mean p set: 0.4518391489982605
loss_pred:0.02416175790131092, decouple_loss:0.006330134347081184
The modified gen p mean: 0.4485924243927002, gen p mean: 0.0, mean p set: 0.4495277404785156
loss_pred:0.02483358606696129, decouple_loss:0.0068401857279241085
The modified gen p mean: 0.4464879035949707, gen p mean: 0.0, mean p set: 0.45044994354248047
loss_pred:0.023349415510892868, decouple_loss:0.006503928452730179
Iteration: 2912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44348618388175964, gen p mean: 0.0, mean p set: 0.45184803009033203
The modified gen p mean: 0.4400995075702667, gen p mean: 0.0, mean p set: 0.4499944746494293
The modified gen p mean: 0.4471774101257324, gen p mean: 0.0, mean p set: 0.45119374990463257
loss_pred:0.02376903034746647, decouple_loss:0.0063824946992099285
loss_pred:0.02497287467122078, decouple_loss:0.006682980805635452
loss_pred:0.024821344763040543, decouple_loss:0.006656238343566656
Iteration: 2913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45572802424430847, gen p mean: 0.0, mean p set: 0.45145851373672485
The modified gen p mean: 0.4555147588253021, gen p mean: 0.0, mean p set: 0.4509679973125458
The modified gen p mean: 0.45071136951446533, gen p mean: 0.0, mean p set: 0.44999441504478455
loss_pred:0.024443959817290306, decouple_loss:0.006625432521104813
loss_pred:0.025314703583717346, decouple_loss:0.006607472896575928
loss_pred:0.02589905820786953, decouple_loss:0.006561095826327801
Iteration: 2914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45106807351112366, gen p mean: 0.0, mean p set: 0.44848471879959106
The modified gen p mean: 0.4581756591796875, gen p mean: 0.0, mean p set: 0.452114462852478
The modified gen p mean: 0.45007798075675964, gen p mean: 0.0, mean p set: 0.44855502247810364
loss_pred:0.02454453893005848, decouple_loss:0.006544562987983227
loss_pred:0.024417823180556297, decouple_loss:0.006423372775316238
loss_pred:0.023807574063539505, decouple_loss:0.006648283451795578
Iteration: 2915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484771490097046, gen p mean: 0.0, mean p set: 0.4515382945537567
The modified gen p mean: 0.448312371969223, gen p mean: 0.0, mean p set: 0.45198163390159607
The modified gen p mean: 0.4452804625034332, gen p mean: 0.0, mean p set: 0.449951171875
loss_pred:0.023879792541265488, decouple_loss:0.006261860486119986
loss_pred:0.024675142019987106, decouple_loss:0.006278899498283863
loss_pred:0.02581426315009594, decouple_loss:0.006786529906094074
Iteration: 2916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922947883605957, gen p mean: 0.0, mean p set: 0.45028162002563477
The modified gen p mean: 0.45080018043518066, gen p mean: 0.0, mean p set: 0.45147234201431274
The modified gen p mean: 0.4531426727771759, gen p mean: 0.0, mean p set: 0.45091530680656433
loss_pred:0.025653809309005737, decouple_loss:0.006705936510115862
loss_pred:0.0236953217536211, decouple_loss:0.006168695632368326
loss_pred:0.024068888276815414, decouple_loss:0.006495378911495209
Iteration: 2917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4543715715408325, gen p mean: 0.0, mean p set: 0.4521912932395935
The modified gen p mean: 0.4547121524810791, gen p mean: 0.0, mean p set: 0.45111262798309326
The modified gen p mean: 0.45472919940948486, gen p mean: 0.0, mean p set: 0.4519319236278534
loss_pred:0.024666782468557358, decouple_loss:0.0067956154234707355
loss_pred:0.023513097316026688, decouple_loss:0.006464638747274876
loss_pred:0.024018529802560806, decouple_loss:0.006401804741472006
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
NaN value num: 0
Iteration: 2918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454910457134247, gen p mean: 0.0, mean p set: 0.44909143447875977
The modified gen p mean: 0.44672006368637085, gen p mean: 0.0, mean p set: 0.44977399706840515
The modified gen p mean: 0.4431159794330597, gen p mean: 0.0, mean p set: 0.45102187991142273
loss_pred:0.02500203624367714, decouple_loss:0.007014313712716103
loss_pred:0.02437063306570053, decouple_loss:0.007033216767013073
loss_pred:0.024780934676527977, decouple_loss:0.006963225081562996
Iteration: 2919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752541184425354, gen p mean: 0.0, mean p set: 0.45184415578842163
The modified gen p mean: 0.4502272605895996, gen p mean: 0.0, mean p set: 0.44991356134414673
The modified gen p mean: 0.4483756124973297, gen p mean: 0.0, mean p set: 0.4502002000808716
loss_pred:0.02353593148291111, decouple_loss:0.0068928953260183334
loss_pred:0.025018729269504547, decouple_loss:0.006730577442795038
loss_pred:0.02462102472782135, decouple_loss:0.006742996163666248
Iteration: 2920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4564651548862457, gen p mean: 0.0, mean p set: 0.4480479061603546
The modified gen p mean: 0.45468488335609436, gen p mean: 0.0, mean p set: 0.44885390996932983
The modified gen p mean: 0.45589664578437805, gen p mean: 0.0, mean p set: 0.44883257150650024
loss_pred:0.02508760429918766, decouple_loss:0.006687157321721315
loss_pred:0.02415357530117035, decouple_loss:0.007228831760585308
loss_pred:0.024271124973893166, decouple_loss:0.006925334222614765
2023-05-03 10:03:36 testing...
The modified gen p mean: 0.43898919224739075, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4443528652191162, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4467830955982208, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02645229548215866, decouple_loss:0.007434078026562929
loss_pred:0.025336487218737602, decouple_loss:0.0071698762476444244
loss_pred:0.025021718814969063, decouple_loss:0.0071874153800308704
WV_0_PC_0_EH_0_PS_40_6, loss: 0.025966688990592957, avg_mse: 0.03149567171931267
current test mse: 0.031496
Iteration: 2921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44540560245513916, gen p mean: 0.0, mean p set: 0.4520123302936554
The modified gen p mean: 0.44539937376976013, gen p mean: 0.0, mean p set: 0.45176324248313904
loss_pred:0.024233557283878326, decouple_loss:0.006956104189157486
loss_pred:0.023373223841190338, decouple_loss:0.006930607836693525
The modified gen p mean: 0.4472235143184662, gen p mean: 0.0, mean p set: 0.451536625623703
loss_pred:0.025042161345481873, decouple_loss:0.006742874160408974
Iteration: 2922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525667428970337, gen p mean: 0.0, mean p set: 0.4491817057132721
The modified gen p mean: 0.4519279897212982, gen p mean: 0.0, mean p set: 0.45073726773262024
The modified gen p mean: 0.45330509543418884, gen p mean: 0.0, mean p set: 0.4505615830421448
loss_pred:0.024131424725055695, decouple_loss:0.0069640339352190495
loss_pred:0.024500519037246704, decouple_loss:0.006751121953129768
loss_pred:0.02438276819884777, decouple_loss:0.006794195622205734
Iteration: 2923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473896026611328, gen p mean: 0.0, mean p set: 0.4476604163646698
The modified gen p mean: 0.4505751132965088, gen p mean: 0.0, mean p set: 0.4486050307750702
The modified gen p mean: 0.45176243782043457, gen p mean: 0.0, mean p set: 0.4492295980453491
loss_pred:0.025646960362792015, decouple_loss:0.007135452702641487
loss_pred:0.025208154693245888, decouple_loss:0.0064782374538481236
loss_pred:0.025059150531888008, decouple_loss:0.0066259331069886684
Iteration: 2924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4447905421257019, gen p mean: 0.0, mean p set: 0.44869256019592285
The modified gen p mean: 0.44629791378974915, gen p mean: 0.0, mean p set: 0.45017069578170776
The modified gen p mean: 0.4453187882900238, gen p mean: 0.0, mean p set: 0.45133325457572937
loss_pred:0.024536974728107452, decouple_loss:0.006745940074324608
loss_pred:0.02483576536178589, decouple_loss:0.0065383086912333965
loss_pred:0.025078417733311653, decouple_loss:0.006887988653033972
Iteration: 2925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540883004665375, gen p mean: 0.0, mean p set: 0.4500843286514282
The modified gen p mean: 0.4528045952320099, gen p mean: 0.0, mean p set: 0.4518480598926544
The modified gen p mean: 0.4531107246875763, gen p mean: 0.0, mean p set: 0.44805923104286194
loss_pred:0.02544330805540085, decouple_loss:0.006939789280295372
loss_pred:0.023165378719568253, decouple_loss:0.0067113544791936874
loss_pred:0.02439744584262371, decouple_loss:0.0068372213281691074
Iteration: 2926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44738274812698364, gen p mean: 0.0, mean p set: 0.44773074984550476
The modified gen p mean: 0.4480975866317749, gen p mean: 0.0, mean p set: 0.44775813817977905
The modified gen p mean: 0.449394553899765, gen p mean: 0.0, mean p set: 0.4504333436489105
loss_pred:0.02463286556303501, decouple_loss:0.006773191969841719
loss_pred:0.024249393492937088, decouple_loss:0.006620635278522968
loss_pred:0.023555252701044083, decouple_loss:0.006449930835515261
Iteration: 2927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453361928462982, gen p mean: 0.0, mean p set: 0.44803333282470703
The modified gen p mean: 0.44000595808029175, gen p mean: 0.0, mean p set: 0.45056405663490295
The modified gen p mean: 0.4458532929420471, gen p mean: 0.0, mean p set: 0.44962644577026367
loss_pred:0.02395942620933056, decouple_loss:0.006469222251325846
loss_pred:0.025365334004163742, decouple_loss:0.00725666806101799
loss_pred:0.024925678968429565, decouple_loss:0.006507268641144037
Iteration: 2928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4545830488204956, gen p mean: 0.0, mean p set: 0.4496413469314575
The modified gen p mean: 0.44993263483047485, gen p mean: 0.0, mean p set: 0.4504449665546417
The modified gen p mean: 0.451394647359848, gen p mean: 0.0, mean p set: 0.4520305097103119
loss_pred:0.025447025895118713, decouple_loss:0.006761390715837479
loss_pred:0.025050679221749306, decouple_loss:0.006795264780521393
loss_pred:0.02317562699317932, decouple_loss:0.00671086460351944
Iteration: 2929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496603310108185, gen p mean: 0.0, mean p set: 0.4527588486671448
The modified gen p mean: 0.45155102014541626, gen p mean: 0.0, mean p set: 0.44795873761177063
The modified gen p mean: 0.45735475420951843, gen p mean: 0.0, mean p set: 0.44921693205833435
loss_pred:0.02391797862946987, decouple_loss:0.006926518864929676
loss_pred:0.025401271879673004, decouple_loss:0.006627050694078207
loss_pred:0.024873487651348114, decouple_loss:0.006514981854707003
Iteration: 2930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45092272758483887, gen p mean: 0.0, mean p set: 0.45047977566719055
The modified gen p mean: 0.4513891637325287, gen p mean: 0.0, mean p set: 0.44976580142974854
loss_pred:0.023790691047906876, decouple_loss:0.006636966019868851
The modified gen p mean: 0.4537646174430847, gen p mean: 0.0, mean p set: 0.449136883020401
loss_pred:0.02486102655529976, decouple_loss:0.006585698574781418
loss_pred:0.025598082691431046, decouple_loss:0.006460001226514578
2023-05-03 10:07:17 testing...
The modified gen p mean: 0.434429407119751, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.44233793020248413, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.43992623686790466, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.02653283067047596, decouple_loss:0.00719533720985055
loss_pred:0.025071753188967705, decouple_loss:0.006943193729966879loss_pred:0.02538616955280304, decouple_loss:0.007019005715847015
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02601621113717556, avg_mse: 0.031536586582660675
current test mse: 0.031537
Iteration: 2931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44212809205055237, gen p mean: 0.0, mean p set: 0.44961604475975037
The modified gen p mean: 0.44018247723579407, gen p mean: 0.0, mean p set: 0.44855889678001404
loss_pred:0.02436121366918087, decouple_loss:0.006477405782788992
loss_pred:0.024880224838852882, decouple_loss:0.006826457101851702
The modified gen p mean: 0.4373127818107605, gen p mean: 0.0, mean p set: 0.4508877694606781
loss_pred:0.02493826299905777, decouple_loss:0.007362083066254854
Iteration: 2932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4434293806552887, gen p mean: 0.0, mean p set: 0.45025739073753357
The modified gen p mean: 0.4498786926269531, gen p mean: 0.0, mean p set: 0.4506881833076477
The modified gen p mean: 0.4510796070098877, gen p mean: 0.0, mean p set: 0.4505856931209564
loss_pred:0.02572239562869072, decouple_loss:0.0071739996783435345
loss_pred:0.02489001490175724, decouple_loss:0.0065076095052063465
loss_pred:0.024119455367326736, decouple_loss:0.006557263899594545
Iteration: 2933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524419903755188, gen p mean: 0.0, mean p set: 0.44778314232826233
The modified gen p mean: 0.4555421769618988, gen p mean: 0.0, mean p set: 0.4497537314891815
The modified gen p mean: 0.45869001746177673, gen p mean: 0.0, mean p set: 0.45185160636901855
loss_pred:0.025618257001042366, decouple_loss:0.007188501767814159
loss_pred:0.024622511118650436, decouple_loss:0.006430887151509523
loss_pred:0.025390520691871643, decouple_loss:0.006548326928168535
Iteration: 2934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4592711627483368, gen p mean: 0.0, mean p set: 0.44889137148857117
The modified gen p mean: 0.44701793789863586, gen p mean: 0.0, mean p set: 0.4526605010032654
The modified gen p mean: 0.4531674087047577, gen p mean: 0.0, mean p set: 0.45216912031173706
loss_pred:0.025376925244927406, decouple_loss:0.006344318389892578
loss_pred:0.023979028686881065, decouple_loss:0.0067960643209517
loss_pred:0.02428635209798813, decouple_loss:0.00693255802616477
Iteration: 2935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013874769210815, gen p mean: 0.0, mean p set: 0.45113611221313477
The modified gen p mean: 0.44250428676605225, gen p mean: 0.0, mean p set: 0.4478166699409485
The modified gen p mean: 0.4479495882987976, gen p mean: 0.0, mean p set: 0.4483462870121002
loss_pred:0.025197194889187813, decouple_loss:0.006746096536517143
loss_pred:0.025510288774967194, decouple_loss:0.006991676054894924
loss_pred:0.024388592690229416, decouple_loss:0.0067115831188857555
Iteration: 2936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4438934922218323, gen p mean: 0.0, mean p set: 0.4500448405742645
The modified gen p mean: 0.44612064957618713, gen p mean: 0.0, mean p set: 0.4503127932548523
The modified gen p mean: 0.4445916414260864, gen p mean: 0.0, mean p set: 0.45069968700408936
loss_pred:0.02446269616484642, decouple_loss:0.006386753171682358
loss_pred:0.023507440462708473, decouple_loss:0.006551552098244429
loss_pred:0.023711813613772392, decouple_loss:0.006497588474303484
Iteration: 2937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44807419180870056, gen p mean: 0.0, mean p set: 0.4521084129810333
The modified gen p mean: 0.4566986858844757, gen p mean: 0.0, mean p set: 0.45057329535484314
The modified gen p mean: 0.4538083076477051, gen p mean: 0.0, mean p set: 0.44826605916023254
loss_pred:0.024623773992061615, decouple_loss:0.006675568874925375
loss_pred:0.025286169722676277, decouple_loss:0.006523179356008768
loss_pred:0.02556748315691948, decouple_loss:0.006319736130535603
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
NaN value num: 0
Iteration: 2938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45616239309310913, gen p mean: 0.0, mean p set: 0.44745099544525146
The modified gen p mean: 0.4530273675918579, gen p mean: 0.0, mean p set: 0.4479012191295624
The modified gen p mean: 0.45430299639701843, gen p mean: 0.0, mean p set: 0.4483678936958313
loss_pred:0.02716817334294319, decouple_loss:0.006960813421756029
loss_pred:0.02648729272186756, decouple_loss:0.007145122159272432
loss_pred:0.02768898941576481, decouple_loss:0.007439058274030685
Iteration: 2939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44133222103118896, gen p mean: 0.0, mean p set: 0.4474199414253235
The modified gen p mean: 0.4382646679878235, gen p mean: 0.0, mean p set: 0.4480588138103485
The modified gen p mean: 0.44384631514549255, gen p mean: 0.0, mean p set: 0.44731420278549194
loss_pred:0.027719996869564056, decouple_loss:0.007257476449012756
loss_pred:0.026922404766082764, decouple_loss:0.006943869404494762
loss_pred:0.026705093681812286, decouple_loss:0.0070401704870164394
Iteration: 2940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4423728287220001, gen p mean: 0.0, mean p set: 0.4485665559768677
The modified gen p mean: 0.4450632631778717, gen p mean: 0.0, mean p set: 0.44733667373657227
The modified gen p mean: 0.443990558385849, gen p mean: 0.0, mean p set: 0.4494474530220032
loss_pred:0.02634335495531559, decouple_loss:0.006631898228079081
loss_pred:0.02795499376952648, decouple_loss:0.006951546762138605
loss_pred:0.026718620210886, decouple_loss:0.007205780129879713
2023-05-03 10:11:34 testing...
The modified gen p mean: 0.44999754428863525, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.44516754150390625, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.4522078335285187, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.025245774537324905, decouple_loss:0.006688190158456564
loss_pred:0.026295790448784828, decouple_loss:0.006794779095798731
loss_pred:0.024866292253136635, decouple_loss:0.006730170920491219
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02580617181956768, avg_mse: 0.03133195638656616
current test mse: 0.031332
Iteration: 2941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484913647174835, gen p mean: 0.0, mean p set: 0.44859373569488525
The modified gen p mean: 0.4478527307510376, gen p mean: 0.0, mean p set: 0.4459850490093231
loss_pred:0.02641892246901989, decouple_loss:0.006709042005240917
loss_pred:0.02639838680624962, decouple_loss:0.006760894786566496
The modified gen p mean: 0.4477003514766693, gen p mean: 0.0, mean p set: 0.4479162395000458
loss_pred:0.02663138322532177, decouple_loss:0.006725396495312452
Iteration: 2942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45421528816223145, gen p mean: 0.0, mean p set: 0.44724923372268677
The modified gen p mean: 0.4517170786857605, gen p mean: 0.0, mean p set: 0.44921690225601196
The modified gen p mean: 0.4500841200351715, gen p mean: 0.0, mean p set: 0.4468361735343933
loss_pred:0.026851972565054893, decouple_loss:0.006796940695494413
loss_pred:0.02615312859416008, decouple_loss:0.006915011443197727
loss_pred:0.026689527556300163, decouple_loss:0.006739208474755287
Iteration: 2943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760316610336304, gen p mean: 0.0, mean p set: 0.4485847055912018
The modified gen p mean: 0.44659316539764404, gen p mean: 0.0, mean p set: 0.44635969400405884
The modified gen p mean: 0.44977790117263794, gen p mean: 0.0, mean p set: 0.4475829601287842
loss_pred:0.026325466111302376, decouple_loss:0.006788244936615229
loss_pred:0.026423649862408638, decouple_loss:0.006849943194538355
loss_pred:0.025390014052391052, decouple_loss:0.006768376100808382
Iteration: 2944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44294917583465576, gen p mean: 0.0, mean p set: 0.44704747200012207
The modified gen p mean: 0.441941499710083, gen p mean: 0.0, mean p set: 0.4466424882411957
The modified gen p mean: 0.4416825771331787, gen p mean: 0.0, mean p set: 0.4484466016292572
loss_pred:0.026067031547427177, decouple_loss:0.006729330867528915
loss_pred:0.02703510969877243, decouple_loss:0.006754303816705942
loss_pred:0.026332736015319824, decouple_loss:0.006823777686804533
Iteration: 2945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4431312382221222, gen p mean: 0.0, mean p set: 0.44589856266975403
The modified gen p mean: 0.44264116883277893, gen p mean: 0.0, mean p set: 0.44864365458488464
The modified gen p mean: 0.4434613883495331, gen p mean: 0.0, mean p set: 0.4476500451564789
loss_pred:0.02676243707537651, decouple_loss:0.006899727042764425
loss_pred:0.026030635461211205, decouple_loss:0.006801208481192589
loss_pred:0.026745103299617767, decouple_loss:0.006722438149154186
Iteration: 2946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527912437915802, gen p mean: 0.0, mean p set: 0.44620171189308167
The modified gen p mean: 0.44579407572746277, gen p mean: 0.0, mean p set: 0.4459342360496521
The modified gen p mean: 0.4451707601547241, gen p mean: 0.0, mean p set: 0.44805923104286194
loss_pred:0.02742490917444229, decouple_loss:0.00684658857062459
loss_pred:0.025966349989175797, decouple_loss:0.006633100565522909
loss_pred:0.026426926255226135, decouple_loss:0.006630482152104378
Iteration: 2947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4572273790836334, gen p mean: 0.0, mean p set: 0.4466065764427185
The modified gen p mean: 0.45520851016044617, gen p mean: 0.0, mean p set: 0.4458599388599396
The modified gen p mean: 0.4529624879360199, gen p mean: 0.0, mean p set: 0.44818219542503357
loss_pred:0.026277724653482437, decouple_loss:0.006494980305433273
loss_pred:0.02578444592654705, decouple_loss:0.0064834896475076675
loss_pred:0.026201725006103516, decouple_loss:0.006671006791293621
Iteration: 2948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455149471759796, gen p mean: 0.0, mean p set: 0.44756653904914856
The modified gen p mean: 0.44666069746017456, gen p mean: 0.0, mean p set: 0.44609498977661133
The modified gen p mean: 0.4426085650920868, gen p mean: 0.0, mean p set: 0.44673120975494385
loss_pred:0.026013851165771484, decouple_loss:0.006443282589316368
loss_pred:0.026239274069666862, decouple_loss:0.006427306681871414
loss_pred:0.02616117149591446, decouple_loss:0.006677231751382351
Iteration: 2949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4351416230201721, gen p mean: 0.0, mean p set: 0.4457412362098694
The modified gen p mean: 0.43940383195877075, gen p mean: 0.0, mean p set: 0.4478325843811035
The modified gen p mean: 0.43822622299194336, gen p mean: 0.0, mean p set: 0.4471109211444855
loss_pred:0.026134034618735313, decouple_loss:0.006512294057756662
loss_pred:0.026820864528417587, decouple_loss:0.006572021637111902
loss_pred:0.026794830337166786, decouple_loss:0.00660103652626276
Iteration: 2950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843536615371704, gen p mean: 0.0, mean p set: 0.44691455364227295The modified gen p mean: 0.446333646774292, gen p mean: 0.0, mean p set: 0.4466082453727722
The modified gen p mean: 0.4474796652793884, gen p mean: 0.0, mean p set: 0.4467763900756836
loss_pred:0.025316892191767693, decouple_loss:0.006232734303921461
loss_pred:0.025527918711304665, decouple_loss:0.0065856995061039925
loss_pred:0.025910496711730957, decouple_loss:0.006527849938720465
2023-05-03 10:15:17 testing...
The modified gen p mean: 0.4554983377456665, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.45089465379714966, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45760849118232727, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.025258095934987068, decouple_loss:0.006874549202620983
loss_pred:0.026253338903188705, decouple_loss:0.006979064550250769
loss_pred:0.025135604664683342, decouple_loss:0.006839802023023367
WV_0_PC_0_EH_0_PS_40_6, loss: 0.02589390240609646, avg_mse: 0.03141438961029053
current test mse: 0.031414
Iteration: 2951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523584246635437, gen p mean: 0.0, mean p set: 0.4468995928764343
loss_pred:0.02656211517751217, decouple_loss:0.0066316816955804825
The modified gen p mean: 0.4549916088581085, gen p mean: 0.0, mean p set: 0.4476702809333801
loss_pred:0.026009658351540565, decouple_loss:0.006777816452085972
The modified gen p mean: 0.4557752311229706, gen p mean: 0.0, mean p set: 0.44682827591896057
loss_pred:0.026621533557772636, decouple_loss:0.006575968116521835
Iteration: 2952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496920704841614, gen p mean: 0.0, mean p set: 0.4482518434524536
The modified gen p mean: 0.45265400409698486, gen p mean: 0.0, mean p set: 0.4470962882041931
The modified gen p mean: 0.45183053612709045, gen p mean: 0.0, mean p set: 0.44789019227027893
loss_pred:0.026382936164736748, decouple_loss:0.006834240630269051
loss_pred:0.027641894295811653, decouple_loss:0.006769230123609304
loss_pred:0.026134910061955452, decouple_loss:0.006677796598523855
Iteration: 2953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4400279223918915, gen p mean: 0.0, mean p set: 0.4474896788597107
The modified gen p mean: 0.43821704387664795, gen p mean: 0.0, mean p set: 0.4484492540359497
The modified gen p mean: 0.4415225386619568, gen p mean: 0.0, mean p set: 0.4463336765766144
loss_pred:0.025857625529170036, decouple_loss:0.006676931399852037
loss_pred:0.02547326497733593, decouple_loss:0.00660394411534071
loss_pred:0.02629726193845272, decouple_loss:0.006866675801575184
Iteration: 2954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4389455318450928, gen p mean: 0.0, mean p set: 0.44814398884773254
The modified gen p mean: 0.4406149983406067, gen p mean: 0.0, mean p set: 0.44587424397468567
The modified gen p mean: 0.43773770332336426, gen p mean: 0.0, mean p set: 0.4483163356781006
loss_pred:0.025656485930085182, decouple_loss:0.006622407119721174
loss_pred:0.026749752461910248, decouple_loss:0.006753535941243172
loss_pred:0.026054909452795982, decouple_loss:0.00666202325373888
Iteration: 2955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45452743768692017, gen p mean: 0.0, mean p set: 0.44793352484703064
The modified gen p mean: 0.4546948969364166, gen p mean: 0.0, mean p set: 0.4483919143676758
The modified gen p mean: 0.45395776629447937, gen p mean: 0.0, mean p set: 0.44761335849761963
loss_pred:0.025665318593382835, decouple_loss:0.006367383524775505
loss_pred:0.025586774572730064, decouple_loss:0.006749898660928011
loss_pred:0.027456095442175865, decouple_loss:0.006381029728800058
Iteration: 2956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46165239810943604, gen p mean: 0.0, mean p set: 0.4463099241256714
The modified gen p mean: 0.45796704292297363, gen p mean: 0.0, mean p set: 0.44732820987701416
The modified gen p mean: 0.45713838934898376, gen p mean: 0.0, mean p set: 0.4465598464012146
loss_pred:0.02683551423251629, decouple_loss:0.006608388852328062
loss_pred:0.02745591662824154, decouple_loss:0.006544989533722401
loss_pred:0.026150379329919815, decouple_loss:0.006443176884204149
Iteration: 2957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43689462542533875, gen p mean: 0.0, mean p set: 0.44832971692085266
The modified gen p mean: 0.4367002546787262, gen p mean: 0.0, mean p set: 0.4471641182899475
The modified gen p mean: 0.4383792281150818, gen p mean: 0.0, mean p set: 0.4483541250228882
loss_pred:0.026426605880260468, decouple_loss:0.006627989001572132
loss_pred:0.026664769276976585, decouple_loss:0.006414920091629028
loss_pred:0.02624567039310932, decouple_loss:0.006511465180665255
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
NaN value num: 0
Iteration: 2958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4390099346637726, gen p mean: 0.0, mean p set: 0.44825538992881775
The modified gen p mean: 0.4417836666107178, gen p mean: 0.0, mean p set: 0.4487335979938507
The modified gen p mean: 0.4373347759246826, gen p mean: 0.0, mean p set: 0.44819530844688416
loss_pred:0.025303393602371216, decouple_loss:0.00657434668391943
loss_pred:0.02479194663465023, decouple_loss:0.006767800077795982
loss_pred:0.025820817798376083, decouple_loss:0.0064788623712956905
Iteration: 2959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493454694747925, gen p mean: 0.0, mean p set: 0.44832760095596313
The modified gen p mean: 0.4529575705528259, gen p mean: 0.0, mean p set: 0.4488394856452942
The modified gen p mean: 0.4491792917251587, gen p mean: 0.0, mean p set: 0.44895321130752563
loss_pred:0.025275819003582, decouple_loss:0.006591528654098511
loss_pred:0.02536262758076191, decouple_loss:0.006683927029371262
loss_pred:0.02441430278122425, decouple_loss:0.006598313804715872
Iteration: 2960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533274471759796, gen p mean: 0.0, mean p set: 0.447688490152359
The modified gen p mean: 0.45605868101119995, gen p mean: 0.0, mean p set: 0.44871145486831665
The modified gen p mean: 0.4523378014564514, gen p mean: 0.0, mean p set: 0.44918495416641235
loss_pred:0.025654321536421776, decouple_loss:0.006702277809381485
loss_pred:0.026912493631243706, decouple_loss:0.006732068955898285
loss_pred:0.024906836450099945, decouple_loss:0.0067047737538814545
2023-05-03 10:20:05 testing...
The modified gen p mean: 0.45107272267341614, gen p mean: 0.0, mean p set: 0.4502691626548767
The modified gen p mean: 0.45550769567489624, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.4576193392276764, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.02645018696784973, decouple_loss:0.006847428157925606
loss_pred:0.025404293090105057, decouple_loss:0.006651268340647221
loss_pred:0.025291085243225098, decouple_loss:0.006616802886128426
WV_0_PC_0_EH_0_PS_40_6, loss: 0.026050448417663574, avg_mse: 0.031756896525621414
current test mse: 0.031757
Iteration: 2961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45475834608078003, gen p mean: 0.0, mean p set: 0.44833654165267944
loss_pred:0.02594820223748684, decouple_loss:0.006421471945941448
The modified gen p mean: 0.45453059673309326, gen p mean: 0.0, mean p set: 0.44758591055870056
loss_pred:0.024909760802984238, decouple_loss:0.006481513846665621
The modified gen p mean: 0.4537544548511505, gen p mean: 0.0, mean p set: 0.44880983233451843
loss_pred:0.026613974943757057, decouple_loss:0.006775784771889448
Iteration: 2962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4373064637184143, gen p mean: 0.0, mean p set: 0.4488913416862488
The modified gen p mean: 0.4359450340270996, gen p mean: 0.0, mean p set: 0.4478192627429962
The modified gen p mean: 0.4358380138874054, gen p mean: 0.0, mean p set: 0.44820985198020935
loss_pred:0.02630605176091194, decouple_loss:0.006492427084594965
loss_pred:0.023640889674425125, decouple_loss:0.006363559514284134
loss_pred:0.025761356577277184, decouple_loss:0.00641177361831069
Iteration: 2963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815629720687866, gen p mean: 0.0, mean p set: 0.4482552707195282
The modified gen p mean: 0.445883184671402, gen p mean: 0.0, mean p set: 0.4489997327327728
The modified gen p mean: 0.4490501880645752, gen p mean: 0.0, mean p set: 0.44785773754119873
loss_pred:0.02694551646709442, decouple_loss:0.006455287337303162
loss_pred:0.02491341158747673, decouple_loss:0.0061895595863461494
loss_pred:0.0250412505120039, decouple_loss:0.0066576264798641205
Iteration: 2964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4566613435745239, gen p mean: 0.0, mean p set: 0.4476771950721741
The modified gen p mean: 0.4532119333744049, gen p mean: 0.0, mean p set: 0.44860783219337463
The modified gen p mean: 0.4557425081729889, gen p mean: 0.0, mean p set: 0.4481090009212494
loss_pred:0.027026979252696037, decouple_loss:0.006480286829173565
loss_pred:0.024622786790132523, decouple_loss:0.006355969700962305
loss_pred:0.024993686005473137, decouple_loss:0.0064446283504366875
Iteration: 2965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461590349674225, gen p mean: 0.0, mean p set: 0.4485079050064087
The modified gen p mean: 0.4462392330169678, gen p mean: 0.0, mean p set: 0.44789284467697144
The modified gen p mean: 0.44353199005126953, gen p mean: 0.0, mean p set: 0.4478755593299866
loss_pred:0.025433819741010666, decouple_loss:0.006764969788491726
loss_pred:0.025320693850517273, decouple_loss:0.00684356177225709
loss_pred:0.024052001535892487, decouple_loss:0.006390648428350687
Iteration: 2966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860389828681946, gen p mean: 0.0, mean p set: 0.4480244815349579
The modified gen p mean: 0.44637659192085266, gen p mean: 0.0, mean p set: 0.4496676027774811
The modified gen p mean: 0.450592577457428, gen p mean: 0.0, mean p set: 0.44799840450286865
loss_pred:0.024741124361753464, decouple_loss:0.006588864140212536
loss_pred:0.02586446702480316, decouple_loss:0.006686439737677574
loss_pred:0.026090942323207855, decouple_loss:0.0065636117942631245
Iteration: 2967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846484065055847, gen p mean: 0.0, mean p set: 0.4483044445514679
The modified gen p mean: 0.44586610794067383, gen p mean: 0.0, mean p set: 0.4496730864048004
The modified gen p mean: 0.4488712549209595, gen p mean: 0.0, mean p set: 0.44762876629829407
loss_pred:0.025954267010092735, decouple_loss:0.006799782160669565
loss_pred:0.025742271915078163, decouple_loss:0.0067692468874156475
loss_pred:0.02723539061844349, decouple_loss:0.006564058363437653
Iteration: 2968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454759359359741, gen p mean: 0.0, mean p set: 0.4499906599521637
The modified gen p mean: 0.4459567368030548, gen p mean: 0.0, mean p set: 0.4484177529811859
The modified gen p mean: 0.44760897755622864, gen p mean: 0.0, mean p set: 0.4475880563259125
loss_pred:0.025494078174233437, decouple_loss:0.0064703370444476604
loss_pred:0.026255616918206215, decouple_loss:0.006748900283128023
loss_pred:0.02509617805480957, decouple_loss:0.006664644461125135
Iteration: 2969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482048749923706, gen p mean: 0.0, mean p set: 0.44789400696754456
The modified gen p mean: 0.4484528601169586, gen p mean: 0.0, mean p set: 0.44922152161598206
The modified gen p mean: 0.4520598351955414, gen p mean: 0.0, mean p set: 0.44872695207595825
loss_pred:0.026072977110743523, decouple_loss:0.006617092527449131
loss_pred:0.025627994909882545, decouple_loss:0.006512741092592478
loss_pred:0.02611691877245903, decouple_loss:0.0064913989044725895
Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 349, in <module>
    if args.is_training:
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 277, in train_wrapper
    #     eta, real_input_flag = schedule_sampling(eta, itr)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/trainer.py", line 25, in train
    cost = model.train(ims, real_input_flag)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/models/model_factory_multiGPU.py", line 68, in train
    loss.mean().backward()
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/_tensor.py", line 396, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt