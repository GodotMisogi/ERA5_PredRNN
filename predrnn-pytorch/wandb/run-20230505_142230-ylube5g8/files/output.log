/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 124
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.0005885090213268995, gen p mean: 0.0, mean p set: 0.4484536051750183
The modified gen p mean: 0.0007664663717150688, gen p mean: 0.0, mean p set: 0.4480302929878235
loss_pred:0.21309901773929596, decouple_loss:0.05307912454009056loss_pred:0.21763154864311218, decouple_loss:0.05319976061582565
The modified gen p mean: 0.0006548850215040147, gen p mean: 0.0, mean p set: 0.4496367573738098
loss_pred:0.22829905152320862, decouple_loss:0.05301425978541374
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.003010326996445656, gen p mean: 0.0, mean p set: 0.448577344417572
loss_pred:0.22290512919425964, decouple_loss:0.15434794127941132
The modified gen p mean: 0.002952898619696498, gen p mean: 0.0, mean p set: 0.4494384229183197
loss_pred:0.22141523659229279, decouple_loss:0.1554902195930481
The modified gen p mean: 0.002982191974297166, gen p mean: 0.0, mean p set: 0.44901883602142334
loss_pred:0.21803879737854004, decouple_loss:0.1548064947128296
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.016523176804184914, gen p mean: 0.0, mean p set: 0.4496358335018158
The modified gen p mean: 0.016505584120750427, gen p mean: 0.0, mean p set: 0.4499538242816925
loss_pred:0.223190039396286, decouple_loss:0.339356005191803
loss_pred:0.22030150890350342, decouple_loss:0.3422143757343292
The modified gen p mean: 0.016467610374093056, gen p mean: 0.0, mean p set: 0.44956550002098083
loss_pred:0.22119857370853424, decouple_loss:0.34123876690864563
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.03218323737382889, gen p mean: 0.0, mean p set: 0.448492169380188
loss_pred:0.20275261998176575, decouple_loss:0.3540058732032776
The modified gen p mean: 0.03216991946101189, gen p mean: 0.0, mean p set: 0.4496401250362396
loss_pred:0.21067726612091064, decouple_loss:0.3554989993572235
The modified gen p mean: 0.03204135596752167, gen p mean: 0.0, mean p set: 0.4494735598564148
loss_pred:0.2077290266752243, decouple_loss:0.3496772050857544
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.03447441756725311, gen p mean: 0.0, mean p set: 0.4480241537094116
loss_pred:0.19949446618556976, decouple_loss:0.38872477412223816
The modified gen p mean: 0.034497831016778946, gen p mean: 0.0, mean p set: 0.4488937258720398
loss_pred:0.2021479457616806, decouple_loss:0.3887921869754791
The modified gen p mean: 0.03441200032830238, gen p mean: 0.0, mean p set: 0.4495936930179596
loss_pred:0.19578316807746887, decouple_loss:0.38551759719848633
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.038114845752716064, gen p mean: 0.0, mean p set: 0.4494089186191559
loss_pred:0.18851535022258759, decouple_loss:0.340349406003952
The modified gen p mean: 0.038091763854026794, gen p mean: 0.0, mean p set: 0.44972550868988037
loss_pred:0.19010154902935028, decouple_loss:0.34387969970703125
The modified gen p mean: 0.03800263628363609, gen p mean: 0.0, mean p set: 0.4490050673484802
loss_pred:0.1841668337583542, decouple_loss:0.3447818458080292
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.04970783740282059, gen p mean: 0.0, mean p set: 0.4480001628398895
loss_pred:0.1846698522567749, decouple_loss:0.3544820547103882
The modified gen p mean: 0.049727704375982285, gen p mean: 0.0, mean p set: 0.45005539059638977
loss_pred:0.18773512542247772, decouple_loss:0.3611285090446472
The modified gen p mean: 0.04969347268342972, gen p mean: 0.0, mean p set: 0.4498986005783081
loss_pred:0.18729792535305023, decouple_loss:0.36389392614364624
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.05457399785518646, gen p mean: 0.0, mean p set: 0.4491029977798462
loss_pred:0.18530400097370148, decouple_loss:0.3098216950893402
The modified gen p mean: 0.054551463574171066, gen p mean: 0.0, mean p set: 0.44951876997947693
loss_pred:0.17695923149585724, decouple_loss:0.314972847700119
The modified gen p mean: 0.05451525002717972, gen p mean: 0.0, mean p set: 0.4478098452091217
loss_pred:0.17856979370117188, decouple_loss:0.30766236782073975
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.058535605669021606, gen p mean: 0.0, mean p set: 0.44845834374427795
loss_pred:0.1792847067117691, decouple_loss:0.27501168847084045
The modified gen p mean: 0.05855385214090347, gen p mean: 0.0, mean p set: 0.44947290420532227
loss_pred:0.1757497936487198, decouple_loss:0.27665796875953674
The modified gen p mean: 0.05850386619567871, gen p mean: 0.0, mean p set: 0.44836896657943726
loss_pred:0.17505067586898804, decouple_loss:0.2780693471431732
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.065512515604496, gen p mean: 0.0, mean p set: 0.4488733410835266
loss_pred:0.18037603795528412, decouple_loss:0.24666716158390045
The modified gen p mean: 0.06572083383798599, gen p mean: 0.0, mean p set: 0.4486786425113678
loss_pred:0.1734294891357422, decouple_loss:0.24854908883571625
The modified gen p mean: 0.06566838175058365, gen p mean: 0.0, mean p set: 0.4494534134864807
loss_pred:0.1694030910730362, decouple_loss:0.24582265317440033
2023-05-05 14:27:32 testing...
The modified gen p mean: 0.07534389197826385, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.0753834918141365, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.16997119784355164, decouple_loss:0.26432326436042786
loss_pred:0.17858007550239563, decouple_loss:0.2655682861804962
The modified gen p mean: 0.07530736178159714, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.16890345513820648, decouple_loss:0.26546648144721985
WV_1_PC_0_EH_0_PS_40_6, loss: 0.1857408732175827, avg_mse: 0.17678314447402954
current test mse: 0.176783
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.07533025741577148, gen p mean: 0.0, mean p set: 0.4482733905315399
loss_pred:0.16859206557273865, decouple_loss:0.26723620295524597
The modified gen p mean: 0.07532329857349396, gen p mean: 0.0, mean p set: 0.4491669833660126
loss_pred:0.1662028580904007, decouple_loss:0.2696757912635803
The modified gen p mean: 0.07536468654870987, gen p mean: 0.0, mean p set: 0.4495360851287842
loss_pred:0.17783251404762268, decouple_loss:0.26535579562187195
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.08495540916919708, gen p mean: 0.0, mean p set: 0.44917774200439453
The modified gen p mean: 0.08502299338579178, gen p mean: 0.0, mean p set: 0.4486761689186096
loss_pred:0.16448286175727844, decouple_loss:0.2322731465101242
loss_pred:0.16845640540122986, decouple_loss:0.23406435549259186
The modified gen p mean: 0.08500548452138901, gen p mean: 0.0, mean p set: 0.4498666524887085
loss_pred:0.17012083530426025, decouple_loss:0.23528632521629333
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.09593327343463898, gen p mean: 0.0, mean p set: 0.4486406445503235
loss_pred:0.15922702848911285, decouple_loss:0.2225322723388672
The modified gen p mean: 0.09591291844844818, gen p mean: 0.0, mean p set: 0.4486114978790283
loss_pred:0.15997900068759918, decouple_loss:0.22313636541366577
The modified gen p mean: 0.09598009288311005, gen p mean: 0.0, mean p set: 0.44911903142929077
loss_pred:0.1595180183649063, decouple_loss:0.22414319217205048
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.10787675529718399, gen p mean: 0.0, mean p set: 0.449928879737854
The modified gen p mean: 0.10784800350666046, gen p mean: 0.0, mean p set: 0.4499637186527252
loss_pred:0.16438184678554535, decouple_loss:0.23699365556240082
loss_pred:0.1629023402929306, decouple_loss:0.23890568315982819
The modified gen p mean: 0.10785055160522461, gen p mean: 0.0, mean p set: 0.4500062167644501
loss_pred:0.16512100398540497, decouple_loss:0.2414369434118271
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.12193085998296738, gen p mean: 0.0, mean p set: 0.4489397704601288
loss_pred:0.15087515115737915, decouple_loss:0.22389626502990723
The modified gen p mean: 0.12189831584692001, gen p mean: 0.0, mean p set: 0.44951972365379333
loss_pred:0.15576018393039703, decouple_loss:0.226704940199852
The modified gen p mean: 0.12188836187124252, gen p mean: 0.0, mean p set: 0.4490435719490051
loss_pred:0.15876825153827667, decouple_loss:0.22811591625213623
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.13620610535144806, gen p mean: 0.0, mean p set: 0.4493010640144348
loss_pred:0.15564458072185516, decouple_loss:0.1933266818523407
The modified gen p mean: 0.13611151278018951, gen p mean: 0.0, mean p set: 0.44925159215927124
loss_pred:0.1485244631767273, decouple_loss:0.1939678192138672
The modified gen p mean: 0.13613364100456238, gen p mean: 0.0, mean p set: 0.4498598277568817
loss_pred:0.1565052568912506, decouple_loss:0.19642363488674164
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.1526910364627838, gen p mean: 0.0, mean p set: 0.4487597644329071
loss_pred:0.14466337859630585, decouple_loss:0.1995808333158493
The modified gen p mean: 0.15266937017440796, gen p mean: 0.0, mean p set: 0.4483001232147217
loss_pred:0.14522436261177063, decouple_loss:0.1993514746427536
The modified gen p mean: 0.15277308225631714, gen p mean: 0.0, mean p set: 0.44942986965179443
loss_pred:0.15092307329177856, decouple_loss:0.19987696409225464
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.16609394550323486, gen p mean: 0.0, mean p set: 0.44830653071403503
The modified gen p mean: 0.1658051460981369, gen p mean: 0.0, mean p set: 0.4488653242588043
loss_pred:0.13513197004795074, decouple_loss:0.18937434256076813
loss_pred:0.14725945889949799, decouple_loss:0.18805621564388275
The modified gen p mean: 0.16587667167186737, gen p mean: 0.0, mean p set: 0.4494372606277466
loss_pred:0.14643390476703644, decouple_loss:0.18766798079013824
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.18261513113975525, gen p mean: 0.0, mean p set: 0.44861117005348206
loss_pred:0.13470466434955597, decouple_loss:0.18813031911849976
The modified gen p mean: 0.18258003890514374, gen p mean: 0.0, mean p set: 0.4498789310455322
loss_pred:0.14158299565315247, decouple_loss:0.1908804178237915
The modified gen p mean: 0.18265141546726227, gen p mean: 0.0, mean p set: 0.4497752785682678
loss_pred:0.13879555463790894, decouple_loss:0.19063542783260345
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.19723133742809296, gen p mean: 0.0, mean p set: 0.4493670165538788
loss_pred:0.12850981950759888, decouple_loss:0.16870924830436707
The modified gen p mean: 0.19725076854228973, gen p mean: 0.0, mean p set: 0.4492647647857666
loss_pred:0.1295563280582428, decouple_loss:0.16912436485290527
The modified gen p mean: 0.19717970490455627, gen p mean: 0.0, mean p set: 0.44934189319610596
loss_pred:0.13106144964694977, decouple_loss:0.1693711131811142
2023-05-05 14:31:16 testing...
The modified gen p mean: 0.21275970339775085, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.13431517779827118, decouple_loss:0.1611611247062683
The modified gen p mean: 0.21284189820289612, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.12791219353675842, decouple_loss:0.16114744544029236
The modified gen p mean: 0.21273934841156006, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.12772631645202637, decouple_loss:0.15962116420269012
WV_1_PC_0_EH_0_PS_40_6, loss: 0.1380167305469513, avg_mse: 0.1323215812444687
current test mse: 0.132322
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.21258200705051422, gen p mean: 0.0, mean p set: 0.45244479179382324
loss_pred:0.1323966532945633, decouple_loss:0.16383205354213715
The modified gen p mean: 0.21279533207416534, gen p mean: 0.0, mean p set: 0.45096179842948914
loss_pred:0.12910866737365723, decouple_loss:0.16219423711299896
The modified gen p mean: 0.2127862423658371, gen p mean: 0.0, mean p set: 0.45053830742836
loss_pred:0.12604738771915436, decouple_loss:0.16054277122020721
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.22724094986915588, gen p mean: 0.0, mean p set: 0.4496879279613495
loss_pred:0.1272238940000534, decouple_loss:0.15443892776966095
The modified gen p mean: 0.22765113413333893, gen p mean: 0.0, mean p set: 0.4514505863189697
The modified gen p mean: 0.227518230676651, gen p mean: 0.0, mean p set: 0.45217224955558777
loss_pred:0.12567400932312012, decouple_loss:0.1523653119802475
loss_pred:0.1236991360783577, decouple_loss:0.15568886697292328
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.24178840219974518, gen p mean: 0.0, mean p set: 0.4526314437389374
loss_pred:0.12306176871061325, decouple_loss:0.1513778269290924
The modified gen p mean: 0.2416096180677414, gen p mean: 0.0, mean p set: 0.4511524438858032
loss_pred:0.12015461176633835, decouple_loss:0.15349732339382172
The modified gen p mean: 0.24163848161697388, gen p mean: 0.0, mean p set: 0.45253023505210876
loss_pred:0.12449567019939423, decouple_loss:0.15007497370243073
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.2559472620487213, gen p mean: 0.0, mean p set: 0.449554443359375
loss_pred:0.11886608600616455, decouple_loss:0.1423589140176773
The modified gen p mean: 0.25645649433135986, gen p mean: 0.0, mean p set: 0.45144835114479065
loss_pred:0.1143212765455246, decouple_loss:0.14162051677703857
The modified gen p mean: 0.25634458661079407, gen p mean: 0.0, mean p set: 0.4531586468219757
loss_pred:0.11613740772008896, decouple_loss:0.14156201481819153
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.2695212960243225, gen p mean: 0.0, mean p set: 0.45071083307266235
loss_pred:0.10940868407487869, decouple_loss:0.14055770635604858
The modified gen p mean: 0.2690806984901428, gen p mean: 0.0, mean p set: 0.4510842561721802
loss_pred:0.1113702729344368, decouple_loss:0.14115022122859955
The modified gen p mean: 0.26914742588996887, gen p mean: 0.0, mean p set: 0.45187288522720337
loss_pred:0.11451679468154907, decouple_loss:0.14045149087905884
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.28442102670669556, gen p mean: 0.0, mean p set: 0.45167064666748047
The modified gen p mean: 0.28443673253059387, gen p mean: 0.0, mean p set: 0.45248204469680786
loss_pred:0.10919947922229767, decouple_loss:0.1330767124891281loss_pred:0.10595787316560745, decouple_loss:0.13422785699367523
The modified gen p mean: 0.2842377722263336, gen p mean: 0.0, mean p set: 0.45284903049468994
loss_pred:0.1130988746881485, decouple_loss:0.13492125272750854
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.2969134747982025, gen p mean: 0.0, mean p set: 0.44960182905197144
loss_pred:0.10494732111692429, decouple_loss:0.13517014682292938
The modified gen p mean: 0.29581496119499207, gen p mean: 0.0, mean p set: 0.4518847167491913
The modified gen p mean: 0.2955518662929535, gen p mean: 0.0, mean p set: 0.4513106644153595
loss_pred:0.1054513081908226, decouple_loss:0.13405166566371918
loss_pred:0.10395317524671555, decouple_loss:0.13331909477710724
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.30814650654792786, gen p mean: 0.0, mean p set: 0.4504260718822479
loss_pred:0.10372418910264969, decouple_loss:0.12402397394180298
The modified gen p mean: 0.30812227725982666, gen p mean: 0.0, mean p set: 0.4517684876918793
The modified gen p mean: 0.3083207905292511, gen p mean: 0.0, mean p set: 0.4498947560787201
loss_pred:0.10402020812034607, decouple_loss:0.12404973059892654
loss_pred:0.10434912890195847, decouple_loss:0.12161695212125778
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.31772640347480774, gen p mean: 0.0, mean p set: 0.4523625671863556
loss_pred:0.102790966629982, decouple_loss:0.11346611380577087
The modified gen p mean: 0.3181162178516388, gen p mean: 0.0, mean p set: 0.45149585604667664
loss_pred:0.10034612566232681, decouple_loss:0.11645090579986572
The modified gen p mean: 0.3179236948490143, gen p mean: 0.0, mean p set: 0.45217567682266235
loss_pred:0.10016356408596039, decouple_loss:0.11561611294746399
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3273037374019623, gen p mean: 0.0, mean p set: 0.45099693536758423
loss_pred:0.09657379984855652, decouple_loss:0.11348028481006622
The modified gen p mean: 0.32841765880584717, gen p mean: 0.0, mean p set: 0.45224204659461975
loss_pred:0.1004863828420639, decouple_loss:0.1141531765460968
The modified gen p mean: 0.32856133580207825, gen p mean: 0.0, mean p set: 0.4509369432926178
loss_pred:0.09555451571941376, decouple_loss:0.11411476880311966
2023-05-05 14:35:59 testing...
The modified gen p mean: 0.3458350598812103, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.1018536239862442, decouple_loss:0.11650918424129486
The modified gen p mean: 0.3454868197441101, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.09854455292224884, decouple_loss:0.11630616337060928
The modified gen p mean: 0.3455652892589569, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.09723950177431107, decouple_loss:0.1152781993150711
WV_1_PC_0_EH_0_PS_40_6, loss: 0.10501411557197571, avg_mse: 0.10052073001861572
current test mse: 0.100521
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.34506866335868835, gen p mean: 0.0, mean p set: 0.4508242905139923
loss_pred:0.09689082205295563, decouple_loss:0.11336788535118103
The modified gen p mean: 0.3439171016216278, gen p mean: 0.0, mean p set: 0.4514783024787903
loss_pred:0.09828797727823257, decouple_loss:0.1122511699795723
The modified gen p mean: 0.34436434507369995, gen p mean: 0.0, mean p set: 0.4518622159957886
loss_pred:0.09671485424041748, decouple_loss:0.11427447199821472
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.35376277565956116, gen p mean: 0.0, mean p set: 0.45057356357574463
loss_pred:0.09378597140312195, decouple_loss:0.11232918500900269
The modified gen p mean: 0.35404056310653687, gen p mean: 0.0, mean p set: 0.4513586759567261
loss_pred:0.09245534241199493, decouple_loss:0.11129749566316605
The modified gen p mean: 0.3538150191307068, gen p mean: 0.0, mean p set: 0.45174074172973633
loss_pred:0.09394710510969162, decouple_loss:0.11125566065311432
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3616998493671417, gen p mean: 0.0, mean p set: 0.4514361619949341
loss_pred:0.0914243832230568, decouple_loss:0.10746902227401733
The modified gen p mean: 0.3621937036514282, gen p mean: 0.0, mean p set: 0.4499072730541229
The modified gen p mean: 0.3620487451553345, gen p mean: 0.0, mean p set: 0.4507897198200226
loss_pred:0.08882056921720505, decouple_loss:0.1074637621641159
loss_pred:0.0898573100566864, decouple_loss:0.10641852021217346
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.37149113416671753, gen p mean: 0.0, mean p set: 0.4501703083515167
loss_pred:0.08787135779857635, decouple_loss:0.10302577167749405
The modified gen p mean: 0.3702126443386078, gen p mean: 0.0, mean p set: 0.4505949914455414
The modified gen p mean: 0.3688724935054779, gen p mean: 0.0, mean p set: 0.45362117886543274
loss_pred:0.0944778323173523, decouple_loss:0.10533887892961502
loss_pred:0.0933346226811409, decouple_loss:0.10436859726905823
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.37484368681907654, gen p mean: 0.0, mean p set: 0.45125675201416016
loss_pred:0.09012264013290405, decouple_loss:0.10777837038040161
The modified gen p mean: 0.37536147236824036, gen p mean: 0.0, mean p set: 0.45104217529296875
loss_pred:0.08894003927707672, decouple_loss:0.10677532851696014
The modified gen p mean: 0.37414640188217163, gen p mean: 0.0, mean p set: 0.45220106840133667
loss_pred:0.09119422733783722, decouple_loss:0.10834312438964844
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.39226385951042175, gen p mean: 0.0, mean p set: 0.4507984220981598
loss_pred:0.08691857010126114, decouple_loss:0.10966833680868149
The modified gen p mean: 0.39230650663375854, gen p mean: 0.0, mean p set: 0.4510255753993988
loss_pred:0.08832288533449173, decouple_loss:0.1058959811925888
The modified gen p mean: 0.39146557450294495, gen p mean: 0.0, mean p set: 0.4514320194721222
loss_pred:0.09050988405942917, decouple_loss:0.10833615064620972
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.3861764967441559, gen p mean: 0.0, mean p set: 0.4518887996673584
loss_pred:0.08481185883283615, decouple_loss:0.09874393790960312
The modified gen p mean: 0.3850851356983185, gen p mean: 0.0, mean p set: 0.4488172233104706
loss_pred:0.08783045411109924, decouple_loss:0.09817168861627579
The modified gen p mean: 0.3858046531677246, gen p mean: 0.0, mean p set: 0.45135921239852905
loss_pred:0.08629089593887329, decouple_loss:0.09724398702383041
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.39037230610847473, gen p mean: 0.0, mean p set: 0.45205995440483093The modified gen p mean: 0.3893134593963623, gen p mean: 0.0, mean p set: 0.4523402452468872
loss_pred:0.08763810247182846, decouple_loss:0.0958772823214531
loss_pred:0.08640871196985245, decouple_loss:0.0973837822675705
The modified gen p mean: 0.3919658064842224, gen p mean: 0.0, mean p set: 0.45228278636932373
loss_pred:0.08277855813503265, decouple_loss:0.09517332911491394
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4064021706581116, gen p mean: 0.0, mean p set: 0.4510226845741272
loss_pred:0.08482973277568817, decouple_loss:0.09143812209367752
The modified gen p mean: 0.40488970279693604, gen p mean: 0.0, mean p set: 0.4502032399177551
loss_pred:0.0864744707942009, decouple_loss:0.09322512149810791
The modified gen p mean: 0.40572646260261536, gen p mean: 0.0, mean p set: 0.4499543607234955
loss_pred:0.0830734372138977, decouple_loss:0.09067942947149277
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4124217927455902, gen p mean: 0.0, mean p set: 0.45375457406044006
The modified gen p mean: 0.41261202096939087, gen p mean: 0.0, mean p set: 0.45129311084747314
loss_pred:0.08688671141862869, decouple_loss:0.09100828319787979
loss_pred:0.08376709371805191, decouple_loss:0.09179862588644028
The modified gen p mean: 0.4101802706718445, gen p mean: 0.0, mean p set: 0.45147067308425903
loss_pred:0.08665841817855835, decouple_loss:0.09247224777936935
2023-05-05 14:39:47 testing...
The modified gen p mean: 0.41232576966285706, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.09030583500862122, decouple_loss:0.0947091206908226
The modified gen p mean: 0.4122985601425171, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.08776677399873734, decouple_loss:0.09506893157958984
The modified gen p mean: 0.41171249747276306, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.08630427718162537, decouple_loss:0.09393962472677231
WV_1_PC_0_EH_0_PS_40_6, loss: 0.09285426139831543, avg_mse: 0.08857053518295288
current test mse: 0.088571
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4103460907936096, gen p mean: 0.0, mean p set: 0.4527588486671448
loss_pred:0.08836066722869873, decouple_loss:0.09272512048482895
The modified gen p mean: 0.41057297587394714, gen p mean: 0.0, mean p set: 0.45133325457572937
loss_pred:0.08543149381875992, decouple_loss:0.09067878872156143
The modified gen p mean: 0.4102689325809479, gen p mean: 0.0, mean p set: 0.44991356134414673
loss_pred:0.08595338463783264, decouple_loss:0.08989673107862473
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.41008925437927246, gen p mean: 0.0, mean p set: 0.44773074984550476
loss_pred:0.08545790612697601, decouple_loss:0.09055086970329285
The modified gen p mean: 0.4115636646747589, gen p mean: 0.0, mean p set: 0.44962644577026367
loss_pred:0.08514804393053055, decouple_loss:0.09087999165058136
The modified gen p mean: 0.41213640570640564, gen p mean: 0.0, mean p set: 0.45017069578170776
loss_pred:0.07973242551088333, decouple_loss:0.09081495553255081
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.41484642028808594, gen p mean: 0.0, mean p set: 0.44885390996932983
loss_pred:0.08893802016973495, decouple_loss:0.09088429063558578
The modified gen p mean: 0.40845605731010437, gen p mean: 0.0, mean p set: 0.4518480598926544
loss_pred:0.08297751843929291, decouple_loss:0.09103497862815857
The modified gen p mean: 0.4120102524757385, gen p mean: 0.0, mean p set: 0.44961604475975037
loss_pred:0.0803743377327919, decouple_loss:0.09098728746175766
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43096497654914856, gen p mean: 0.0, mean p set: 0.4486050307750702
loss_pred:0.0848836600780487, decouple_loss:0.09518475830554962
The modified gen p mean: 0.4311663806438446, gen p mean: 0.0, mean p set: 0.44889137148857117
The modified gen p mean: 0.4303162097930908, gen p mean: 0.0, mean p set: 0.4478166699409485
loss_pred:0.08437488228082657, decouple_loss:0.09551338851451874
loss_pred:0.09171074628829956, decouple_loss:0.09672658145427704
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42888906598091125, gen p mean: 0.0, mean p set: 0.4492295980453491
loss_pred:0.08019646257162094, decouple_loss:0.09783821552991867
The modified gen p mean: 0.42760738730430603, gen p mean: 0.0, mean p set: 0.45176324248313904
loss_pred:0.08255679905414581, decouple_loss:0.09884465485811234
The modified gen p mean: 0.4281376600265503, gen p mean: 0.0, mean p set: 0.4520305097103119
loss_pred:0.08196604251861572, decouple_loss:0.09888545423746109
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42922669649124146, gen p mean: 0.0, mean p set: 0.44803333282470703
The modified gen p mean: 0.4283866882324219, gen p mean: 0.0, mean p set: 0.44883257150650024
loss_pred:0.08261901140213013, decouple_loss:0.09570428729057312
loss_pred:0.08063057065010071, decouple_loss:0.09756603837013245
The modified gen p mean: 0.4292365312576294, gen p mean: 0.0, mean p set: 0.4504333436489105
loss_pred:0.07764691859483719, decouple_loss:0.0956033319234848
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4308294951915741, gen p mean: 0.0, mean p set: 0.45073726773262024
loss_pred:0.08215738087892532, decouple_loss:0.09159843623638153
The modified gen p mean: 0.42919471859931946, gen p mean: 0.0, mean p set: 0.44795873761177063
loss_pred:0.08772655576467514, decouple_loss:0.09073173254728317
The modified gen p mean: 0.42991775274276733, gen p mean: 0.0, mean p set: 0.4503127932548523
loss_pred:0.07848157733678818, decouple_loss:0.08954185992479324
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42951181530952454, gen p mean: 0.0, mean p set: 0.44869256019592285
loss_pred:0.08120566606521606, decouple_loss:0.08765792846679688
The modified gen p mean: 0.4294750392436981, gen p mean: 0.0, mean p set: 0.44909143447875977
loss_pred:0.079749695956707, decouple_loss:0.087262824177742
The modified gen p mean: 0.4289593994617462, gen p mean: 0.0, mean p set: 0.4500843286514282
loss_pred:0.07930146902799606, decouple_loss:0.08872019499540329
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42686936259269714, gen p mean: 0.0, mean p set: 0.4491817057132721
loss_pred:0.08204693347215652, decouple_loss:0.08660902827978134
The modified gen p mean: 0.42637184262275696, gen p mean: 0.0, mean p set: 0.4520123302936554
loss_pred:0.08262836933135986, decouple_loss:0.0859483927488327
The modified gen p mean: 0.4258567690849304, gen p mean: 0.0, mean p set: 0.4504449665546417
loss_pred:0.0815313383936882, decouple_loss:0.08600681275129318
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4273799955844879, gen p mean: 0.0, mean p set: 0.45184415578842163
loss_pred:0.07831479609012604, decouple_loss:0.08367114514112473
The modified gen p mean: 0.42688852548599243, gen p mean: 0.0, mean p set: 0.4476604163646698
loss_pred:0.08757459372282028, decouple_loss:0.08361653238534927
The modified gen p mean: 0.4276532530784607, gen p mean: 0.0, mean p set: 0.4496413469314575
loss_pred:0.07804054766893387, decouple_loss:0.0830632671713829
2023-05-05 14:44:20 testing...
The modified gen p mean: 0.4312862455844879, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.08603356778621674, decouple_loss:0.08228673785924911
The modified gen p mean: 0.4319818615913391, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.43071600794792175, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.08364451676607132, decouple_loss:0.08188918977975845
loss_pred:0.08242163807153702, decouple_loss:0.08153967559337616
WV_1_PC_0_EH_0_PS_40_6, loss: 0.08812849968671799, avg_mse: 0.08391891419887543
current test mse: 0.083919
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43062806129455566, gen p mean: 0.0, mean p set: 0.44977399706840515
loss_pred:0.08075594902038574, decouple_loss:0.07954876869916916
The modified gen p mean: 0.42837437987327576, gen p mean: 0.0, mean p set: 0.4497537314891815
loss_pred:0.08060687780380249, decouple_loss:0.08007808774709702
The modified gen p mean: 0.4301726520061493, gen p mean: 0.0, mean p set: 0.44976580142974854
loss_pred:0.07705967128276825, decouple_loss:0.07929274439811707
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42819178104400635, gen p mean: 0.0, mean p set: 0.4480479061603546
The modified gen p mean: 0.4278584420681, gen p mean: 0.0, mean p set: 0.4502002000808716
loss_pred:0.08180246502161026, decouple_loss:0.07820029556751251
loss_pred:0.07850898802280426, decouple_loss:0.07755022495985031
The modified gen p mean: 0.42814314365386963, gen p mean: 0.0, mean p set: 0.44775813817977905
loss_pred:0.07919701188802719, decouple_loss:0.07874328643083572
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42381173372268677, gen p mean: 0.0, mean p set: 0.4500448405742645
loss_pred:0.07954654842615128, decouple_loss:0.07905873656272888
The modified gen p mean: 0.4261266887187958, gen p mean: 0.0, mean p set: 0.4505615830421448
loss_pred:0.0746505856513977, decouple_loss:0.0780431404709816
The modified gen p mean: 0.4205746650695801, gen p mean: 0.0, mean p set: 0.45056405663490295
loss_pred:0.08096575736999512, decouple_loss:0.0796210989356041
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42865556478500366, gen p mean: 0.0, mean p set: 0.45069968700408936
The modified gen p mean: 0.4322203993797302, gen p mean: 0.0, mean p set: 0.4505856931209564loss_pred:0.07809067517518997, decouple_loss:0.07678908854722977
loss_pred:0.07925950735807419, decouple_loss:0.0766691043972969
The modified gen p mean: 0.4303472340106964, gen p mean: 0.0, mean p set: 0.4526605010032654
loss_pred:0.0859145075082779, decouple_loss:0.07593251019716263
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43710049986839294, gen p mean: 0.0, mean p set: 0.45102187991142273
loss_pred:0.07716574519872665, decouple_loss:0.07527695596218109
The modified gen p mean: 0.4370354115962982, gen p mean: 0.0, mean p set: 0.4483462870121002
loss_pred:0.0800614282488823, decouple_loss:0.07502948492765427
The modified gen p mean: 0.43808799982070923, gen p mean: 0.0, mean p set: 0.45216912031173706
loss_pred:0.08458392322063446, decouple_loss:0.0738203376531601
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4370381236076355, gen p mean: 0.0, mean p set: 0.451536625623703
loss_pred:0.07667446881532669, decouple_loss:0.07482665032148361
The modified gen p mean: 0.4358672499656677, gen p mean: 0.0, mean p set: 0.4506881833076477
loss_pred:0.07931343466043472, decouple_loss:0.07309921085834503
The modified gen p mean: 0.4373534023761749, gen p mean: 0.0, mean p set: 0.44921693205833435
loss_pred:0.07588066160678864, decouple_loss:0.07371117174625397
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4285311698913574, gen p mean: 0.0, mean p set: 0.449136883020401
loss_pred:0.07663142681121826, decouple_loss:0.07164780050516129
The modified gen p mean: 0.42862460017204285, gen p mean: 0.0, mean p set: 0.45185160636901855
loss_pred:0.07808640599250793, decouple_loss:0.07166794687509537
The modified gen p mean: 0.42756515741348267, gen p mean: 0.0, mean p set: 0.44855889678001404
loss_pred:0.081263467669487, decouple_loss:0.07518491894006729
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43277114629745483, gen p mean: 0.0, mean p set: 0.45057329535484314
loss_pred:0.07653430849313736, decouple_loss:0.0712074264883995
The modified gen p mean: 0.4337266981601715, gen p mean: 0.0, mean p set: 0.45113611221313477
loss_pred:0.0767921656370163, decouple_loss:0.07137427479028702
The modified gen p mean: 0.43183284997940063, gen p mean: 0.0, mean p set: 0.4521084129810333
loss_pred:0.08316192775964737, decouple_loss:0.07184199243783951
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43020784854888916, gen p mean: 0.0, mean p set: 0.45025739073753357
loss_pred:0.08199797570705414, decouple_loss:0.07119667530059814
The modified gen p mean: 0.4375777542591095, gen p mean: 0.0, mean p set: 0.44826605916023254
loss_pred:0.07985754311084747, decouple_loss:0.07037795335054398
The modified gen p mean: 0.4376337230205536, gen p mean: 0.0, mean p set: 0.44778314232826233
loss_pred:0.087448351085186, decouple_loss:0.07101218402385712
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43491077423095703, gen p mean: 0.0, mean p set: 0.44805923104286194
The modified gen p mean: 0.4370476305484772, gen p mean: 0.0, mean p set: 0.45047977566719055
loss_pred:0.08461055159568787, decouple_loss:0.0686759352684021
loss_pred:0.07685766369104385, decouple_loss:0.06816310435533524
The modified gen p mean: 0.4292563498020172, gen p mean: 0.0, mean p set: 0.4508877694606781
loss_pred:0.08391684293746948, decouple_loss:0.06923186779022217
2023-05-05 14:48:07 testing...
The modified gen p mean: 0.43029868602752686, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.08420177549123764, decouple_loss:0.07152412086725235
The modified gen p mean: 0.43035459518432617, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.42907387018203735, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.08177319914102554, decouple_loss:0.07086869329214096
loss_pred:0.08058846741914749, decouple_loss:0.0702347531914711
WV_1_PC_0_EH_0_PS_40_6, loss: 0.0857316106557846, avg_mse: 0.08205746859312057
current test mse: 0.082057
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4307938516139984, gen p mean: 0.0, mean p set: 0.4481372833251953
loss_pred:0.08245176076889038, decouple_loss:0.07255614548921585
The modified gen p mean: 0.4281597435474396, gen p mean: 0.0, mean p set: 0.44843775033950806
loss_pred:0.07952160388231277, decouple_loss:0.07413849979639053
The modified gen p mean: 0.43085476756095886, gen p mean: 0.0, mean p set: 0.4483153223991394
loss_pred:0.0829429104924202, decouple_loss:0.07193595916032791
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4357772767543793, gen p mean: 0.0, mean p set: 0.44883155822753906
loss_pred:0.08414224535226822, decouple_loss:0.07138797640800476
The modified gen p mean: 0.43535247445106506, gen p mean: 0.0, mean p set: 0.44855156540870667
The modified gen p mean: 0.43719932436943054, gen p mean: 0.0, mean p set: 0.44871240854263306
loss_pred:0.08292069286108017, decouple_loss:0.07410026341676712
loss_pred:0.08127491921186447, decouple_loss:0.06895573437213898
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4442553222179413, gen p mean: 0.0, mean p set: 0.44808903336524963
loss_pred:0.0845116376876831, decouple_loss:0.07110144942998886
The modified gen p mean: 0.4479472041130066, gen p mean: 0.0, mean p set: 0.44867268204689026
loss_pred:0.07834276556968689, decouple_loss:0.0722535103559494
The modified gen p mean: 0.44576144218444824, gen p mean: 0.0, mean p set: 0.44815871119499207
loss_pred:0.08034637570381165, decouple_loss:0.07095503062009811
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4376780688762665, gen p mean: 0.0, mean p set: 0.44897785782814026
loss_pred:0.07987844944000244, decouple_loss:0.06807578355073929
The modified gen p mean: 0.44057780504226685, gen p mean: 0.0, mean p set: 0.44774329662323
loss_pred:0.07860517501831055, decouple_loss:0.06865904480218887
The modified gen p mean: 0.43828287720680237, gen p mean: 0.0, mean p set: 0.44949179887771606
loss_pred:0.08208838105201721, decouple_loss:0.066870778799057
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4287874400615692, gen p mean: 0.0, mean p set: 0.4478190541267395
loss_pred:0.07836990803480148, decouple_loss:0.06883469223976135
The modified gen p mean: 0.430229514837265, gen p mean: 0.0, mean p set: 0.4489932656288147
loss_pred:0.08167174458503723, decouple_loss:0.07045524567365646
The modified gen p mean: 0.4296009838581085, gen p mean: 0.0, mean p set: 0.4480125904083252
loss_pred:0.07552214711904526, decouple_loss:0.06888195127248764
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4302973747253418, gen p mean: 0.0, mean p set: 0.4482739567756653
loss_pred:0.07592840492725372, decouple_loss:0.06806010007858276
The modified gen p mean: 0.4296264946460724, gen p mean: 0.0, mean p set: 0.4478082060813904
loss_pred:0.08085492253303528, decouple_loss:0.06958173960447311
The modified gen p mean: 0.4315973222255707, gen p mean: 0.0, mean p set: 0.44792336225509644
loss_pred:0.0762866735458374, decouple_loss:0.06804856657981873
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4344567656517029, gen p mean: 0.0, mean p set: 0.44887417554855347
loss_pred:0.0806921049952507, decouple_loss:0.06653550267219543The modified gen p mean: 0.4338977336883545, gen p mean: 0.0, mean p set: 0.44785749912261963
loss_pred:0.08300790935754776, decouple_loss:0.0655197873711586
The modified gen p mean: 0.43739157915115356, gen p mean: 0.0, mean p set: 0.4479096829891205
loss_pred:0.07505469769239426, decouple_loss:0.06479260325431824
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4381984770298004, gen p mean: 0.0, mean p set: 0.44886863231658936
loss_pred:0.07676570862531662, decouple_loss:0.06443772464990616
The modified gen p mean: 0.43609026074409485, gen p mean: 0.0, mean p set: 0.4481373429298401
loss_pred:0.07866595685482025, decouple_loss:0.06400768458843231
The modified gen p mean: 0.4341808259487152, gen p mean: 0.0, mean p set: 0.4488488733768463
loss_pred:0.08403234928846359, decouple_loss:0.06507819890975952
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4338070750236511, gen p mean: 0.0, mean p set: 0.4491376578807831
loss_pred:0.07762420922517776, decouple_loss:0.06361331790685654
The modified gen p mean: 0.4328431189060211, gen p mean: 0.0, mean p set: 0.4483753740787506
loss_pred:0.07799291610717773, decouple_loss:0.06441441178321838
The modified gen p mean: 0.4315805733203888, gen p mean: 0.0, mean p set: 0.449349969625473
loss_pred:0.07952826470136642, decouple_loss:0.06425762921571732
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43102583289146423, gen p mean: 0.0, mean p set: 0.44848933815956116
The modified gen p mean: 0.431344211101532, gen p mean: 0.0, mean p set: 0.4485030770301819
loss_pred:0.07968815416097641, decouple_loss:0.06279590725898743
loss_pred:0.07802555710077286, decouple_loss:0.06306016445159912
The modified gen p mean: 0.4293566346168518, gen p mean: 0.0, mean p set: 0.4474784731864929
loss_pred:0.07871945202350616, decouple_loss:0.06242953613400459
2023-05-05 14:52:48 testing...
The modified gen p mean: 0.4302103519439697, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.08171410858631134, decouple_loss:0.06141463667154312
The modified gen p mean: 0.43095695972442627, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.42969197034835815, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.07959150522947311, decouple_loss:0.06209618225693703
loss_pred:0.07832322269678116, decouple_loss:0.06099794805049896
WV_1_PC_0_EH_0_PS_40_6, loss: 0.08295142650604248, avg_mse: 0.07982219010591507
current test mse: 0.079822
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4308147132396698, gen p mean: 0.0, mean p set: 0.4482477605342865
loss_pred:0.07765515893697739, decouple_loss:0.06274889409542084
The modified gen p mean: 0.42870503664016724, gen p mean: 0.0, mean p set: 0.44853898882865906
loss_pred:0.08054216206073761, decouple_loss:0.05968795716762543
The modified gen p mean: 0.4282299876213074, gen p mean: 0.0, mean p set: 0.4493922293186188
loss_pred:0.07964561134576797, decouple_loss:0.06138206273317337
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4287973642349243, gen p mean: 0.0, mean p set: 0.44841820001602173
loss_pred:0.0783921629190445, decouple_loss:0.05957512557506561
The modified gen p mean: 0.4274613857269287, gen p mean: 0.0, mean p set: 0.4481523036956787
loss_pred:0.08217060565948486, decouple_loss:0.059221625328063965
The modified gen p mean: 0.43112561106681824, gen p mean: 0.0, mean p set: 0.4487318992614746
loss_pred:0.07787513732910156, decouple_loss:0.059370215982198715
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.431846022605896, gen p mean: 0.0, mean p set: 0.4477321207523346
loss_pred:0.07886172086000443, decouple_loss:0.057529229670763016
The modified gen p mean: 0.4334903061389923, gen p mean: 0.0, mean p set: 0.44804492592811584
loss_pred:0.07518661767244339, decouple_loss:0.05868630111217499
The modified gen p mean: 0.43168288469314575, gen p mean: 0.0, mean p set: 0.44842007756233215
loss_pred:0.07958414405584335, decouple_loss:0.058908358216285706
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42605507373809814, gen p mean: 0.0, mean p set: 0.44895002245903015
loss_pred:0.0805177092552185, decouple_loss:0.05636082589626312
The modified gen p mean: 0.4279700219631195, gen p mean: 0.0, mean p set: 0.44894248247146606
The modified gen p mean: 0.4271222651004791, gen p mean: 0.0, mean p set: 0.4488413631916046
loss_pred:0.0781586542725563, decouple_loss:0.057656604796648026
loss_pred:0.07530416548252106, decouple_loss:0.05674225464463234
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42720410227775574, gen p mean: 0.0, mean p set: 0.44894295930862427
loss_pred:0.07808558642864227, decouple_loss:0.05797910690307617
The modified gen p mean: 0.4251067340373993, gen p mean: 0.0, mean p set: 0.44777801632881165
The modified gen p mean: 0.4228019714355469, gen p mean: 0.0, mean p set: 0.4484483003616333
loss_pred:0.07940348982810974, decouple_loss:0.05706735700368881
loss_pred:0.07522347569465637, decouple_loss:0.057827726006507874
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43038246035575867, gen p mean: 0.0, mean p set: 0.447996586561203
loss_pred:0.07992366701364517, decouple_loss:0.05707255005836487
The modified gen p mean: 0.429641455411911, gen p mean: 0.0, mean p set: 0.44803571701049805
The modified gen p mean: 0.42907342314720154, gen p mean: 0.0, mean p set: 0.4479822516441345
loss_pred:0.07627732306718826, decouple_loss:0.05471384897828102
loss_pred:0.07740951329469681, decouple_loss:0.05550038814544678
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43287038803100586, gen p mean: 0.0, mean p set: 0.4482278525829315
loss_pred:0.07875387370586395, decouple_loss:0.055232517421245575
The modified gen p mean: 0.4352504014968872, gen p mean: 0.0, mean p set: 0.4474940896034241
loss_pred:0.07577924430370331, decouple_loss:0.055197861045598984
The modified gen p mean: 0.43396541476249695, gen p mean: 0.0, mean p set: 0.4487142562866211
loss_pred:0.07663606107234955, decouple_loss:0.056399278342723846
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4291694164276123, gen p mean: 0.0, mean p set: 0.44845062494277954
loss_pred:0.07591225206851959, decouple_loss:0.05367133766412735
The modified gen p mean: 0.42501068115234375, gen p mean: 0.0, mean p set: 0.44863903522491455
loss_pred:0.07832533866167068, decouple_loss:0.05338738486170769
The modified gen p mean: 0.4285193383693695, gen p mean: 0.0, mean p set: 0.44898611307144165
loss_pred:0.07713501900434494, decouple_loss:0.05382068455219269
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4249289333820343, gen p mean: 0.0, mean p set: 0.4494416415691376
loss_pred:0.08077073842287064, decouple_loss:0.05540776252746582
The modified gen p mean: 0.4271653890609741, gen p mean: 0.0, mean p set: 0.4493470788002014
loss_pred:0.07878190279006958, decouple_loss:0.05330592021346092
The modified gen p mean: 0.4279796779155731, gen p mean: 0.0, mean p set: 0.4479075074195862
loss_pred:0.07184149324893951, decouple_loss:0.05172697454690933
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4321112036705017, gen p mean: 0.0, mean p set: 0.44815748929977417
loss_pred:0.07423658668994904, decouple_loss:0.05099203810095787
The modified gen p mean: 0.42995938658714294, gen p mean: 0.0, mean p set: 0.44894954562187195
loss_pred:0.07966750115156174, decouple_loss:0.05508963018655777
The modified gen p mean: 0.43335673213005066, gen p mean: 0.0, mean p set: 0.4482729434967041
loss_pred:0.07609718292951584, decouple_loss:0.05428836867213249
2023-05-05 14:56:38 testing...
The modified gen p mean: 0.4340224266052246, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.07600118964910507, decouple_loss:0.05240795388817787
The modified gen p mean: 0.4346606731414795, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.07736596465110779, decouple_loss:0.05275033414363861
The modified gen p mean: 0.43428489565849304, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.07876797765493393, decouple_loss:0.05229131504893303
WV_1_PC_0_EH_0_PS_40_6, loss: 0.08000253885984421, avg_mse: 0.07726618647575378
current test mse: 0.077266
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4321354627609253, gen p mean: 0.0, mean p set: 0.4496292173862457
loss_pred:0.07901294529438019, decouple_loss:0.05297302082180977
The modified gen p mean: 0.4366946220397949, gen p mean: 0.0, mean p set: 0.44855955243110657
loss_pred:0.07482879608869553, decouple_loss:0.05457796901464462
The modified gen p mean: 0.4317416250705719, gen p mean: 0.0, mean p set: 0.44840285181999207
loss_pred:0.07676346600055695, decouple_loss:0.0514422245323658
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.42862844467163086, gen p mean: 0.0, mean p set: 0.4484792649745941
loss_pred:0.08020810782909393, decouple_loss:0.05288077890872955
The modified gen p mean: 0.4288051724433899, gen p mean: 0.0, mean p set: 0.450667142868042
loss_pred:0.08177722245454788, decouple_loss:0.05090402439236641
The modified gen p mean: 0.4319574236869812, gen p mean: 0.0, mean p set: 0.44927728176116943
loss_pred:0.07031770795583725, decouple_loss:0.05244046449661255
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4283306896686554, gen p mean: 0.0, mean p set: 0.44695067405700684
loss_pred:0.07827921956777573, decouple_loss:0.05395643413066864
The modified gen p mean: 0.4256262481212616, gen p mean: 0.0, mean p set: 0.45020791888237
loss_pred:0.07828646153211594, decouple_loss:0.05146237462759018
The modified gen p mean: 0.42945829033851624, gen p mean: 0.0, mean p set: 0.44878458976745605
loss_pred:0.07265017926692963, decouple_loss:0.05133096128702164
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4335993826389313, gen p mean: 0.0, mean p set: 0.44745421409606934
loss_pred:0.07345011830329895, decouple_loss:0.05189501866698265
The modified gen p mean: 0.4346201717853546, gen p mean: 0.0, mean p set: 0.44798994064331055
loss_pred:0.07583146542310715, decouple_loss:0.05263461917638779
The modified gen p mean: 0.4337872266769409, gen p mean: 0.0, mean p set: 0.44834980368614197
loss_pred:0.07599877566099167, decouple_loss:0.05088218301534653
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4383002519607544, gen p mean: 0.0, mean p set: 0.4470324218273163
loss_pred:0.07549554854631424, decouple_loss:0.051351889967918396
The modified gen p mean: 0.4373635947704315, gen p mean: 0.0, mean p set: 0.4476519823074341
loss_pred:0.07722994685173035, decouple_loss:0.049138251692056656
The modified gen p mean: 0.4384079575538635, gen p mean: 0.0, mean p set: 0.4491821527481079
loss_pred:0.07023634016513824, decouple_loss:0.049183040857315063
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43205150961875916, gen p mean: 0.0, mean p set: 0.44820311665534973
loss_pred:0.07242004573345184, decouple_loss:0.049855783581733704
The modified gen p mean: 0.43072178959846497, gen p mean: 0.0, mean p set: 0.45032617449760437
loss_pred:0.07719708234071732, decouple_loss:0.05078400671482086
The modified gen p mean: 0.4347343444824219, gen p mean: 0.0, mean p set: 0.44904273748397827
loss_pred:0.06914956867694855, decouple_loss:0.04838355630636215
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43388110399246216, gen p mean: 0.0, mean p set: 0.44862788915634155
loss_pred:0.07010740786790848, decouple_loss:0.04731804132461548
The modified gen p mean: 0.43078261613845825, gen p mean: 0.0, mean p set: 0.44789883494377136
loss_pred:0.07370716333389282, decouple_loss:0.048389311879873276
The modified gen p mean: 0.4317074418067932, gen p mean: 0.0, mean p set: 0.4497813284397125
loss_pred:0.07436161488294601, decouple_loss:0.04965892434120178
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4329943358898163, gen p mean: 0.0, mean p set: 0.4474656283855438
loss_pred:0.0708976462483406, decouple_loss:0.049709685146808624
The modified gen p mean: 0.4308798611164093, gen p mean: 0.0, mean p set: 0.44826775789260864
loss_pred:0.07720120996236801, decouple_loss:0.04943167045712471
The modified gen p mean: 0.4325711727142334, gen p mean: 0.0, mean p set: 0.44859588146209717
loss_pred:0.07583069801330566, decouple_loss:0.047382574528455734
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4362301826477051, gen p mean: 0.0, mean p set: 0.44880858063697815
loss_pred:0.06693893671035767, decouple_loss:0.0467410683631897
The modified gen p mean: 0.43535757064819336, gen p mean: 0.0, mean p set: 0.4479536712169647
loss_pred:0.07547850906848907, decouple_loss:0.04899239167571068
The modified gen p mean: 0.4345492124557495, gen p mean: 0.0, mean p set: 0.4473898112773895
loss_pred:0.07361719012260437, decouple_loss:0.047105226665735245
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43998900055885315, gen p mean: 0.0, mean p set: 0.4474024772644043
loss_pred:0.07267066091299057, decouple_loss:0.04638462886214256
The modified gen p mean: 0.4385940432548523, gen p mean: 0.0, mean p set: 0.448832243680954
loss_pred:0.0755174458026886, decouple_loss:0.046503789722919464
The modified gen p mean: 0.43832337856292725, gen p mean: 0.0, mean p set: 0.4475262761116028
loss_pred:0.07636181265115738, decouple_loss:0.0488056018948555
2023-05-05 15:01:08 testing...
The modified gen p mean: 0.43775683641433716, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.07496455311775208, decouple_loss:0.04852331057190895
The modified gen p mean: 0.4369015693664551, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.07352060824632645, decouple_loss:0.04834197461605072
The modified gen p mean: 0.4377630650997162, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.07226374745368958, decouple_loss:0.04843028262257576
WV_1_PC_0_EH_0_PS_40_6, loss: 0.07600456476211548, avg_mse: 0.07311920076608658
current test mse: 0.073119
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43610912561416626, gen p mean: 0.0, mean p set: 0.44835713505744934
loss_pred:0.07148875296115875, decouple_loss:0.046420637518167496
The modified gen p mean: 0.43860337138175964, gen p mean: 0.0, mean p set: 0.4477744400501251
loss_pred:0.07187448441982269, decouple_loss:0.04698129743337631
The modified gen p mean: 0.43771418929100037, gen p mean: 0.0, mean p set: 0.4491044282913208
loss_pred:0.07083234935998917, decouple_loss:0.04887984320521355
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43262481689453125, gen p mean: 0.0, mean p set: 0.44738876819610596
loss_pred:0.07530512660741806, decouple_loss:0.04968612268567085
The modified gen p mean: 0.43262171745300293, gen p mean: 0.0, mean p set: 0.4476097822189331
loss_pred:0.07070257514715195, decouple_loss:0.04649520292878151
The modified gen p mean: 0.43177035450935364, gen p mean: 0.0, mean p set: 0.4491809606552124
loss_pred:0.07147424668073654, decouple_loss:0.048594582825899124
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4345360994338989, gen p mean: 0.0, mean p set: 0.45015189051628113
loss_pred:0.07328368723392487, decouple_loss:0.04770687222480774
The modified gen p mean: 0.4355221688747406, gen p mean: 0.0, mean p set: 0.44765329360961914
loss_pred:0.06855719536542892, decouple_loss:0.04614420607686043
The modified gen p mean: 0.436472624540329, gen p mean: 0.0, mean p set: 0.44899317622184753
loss_pred:0.06929785758256912, decouple_loss:0.045020487159490585
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43725425004959106, gen p mean: 0.0, mean p set: 0.44879916310310364
loss_pred:0.07331836968660355, decouple_loss:0.04547831043601036
The modified gen p mean: 0.4414975941181183, gen p mean: 0.0, mean p set: 0.447390615940094
loss_pred:0.0732506588101387, decouple_loss:0.04845337197184563
The modified gen p mean: 0.44138213992118835, gen p mean: 0.0, mean p set: 0.4482274651527405
loss_pred:0.07493162155151367, decouple_loss:0.0470610186457634
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4410410225391388, gen p mean: 0.0, mean p set: 0.44708430767059326
loss_pred:0.07117079943418503, decouple_loss:0.045865170657634735
The modified gen p mean: 0.4407402575016022, gen p mean: 0.0, mean p set: 0.447974294424057
loss_pred:0.07299742847681046, decouple_loss:0.045937828719615936
The modified gen p mean: 0.43920689821243286, gen p mean: 0.0, mean p set: 0.4479839503765106
loss_pred:0.06892776489257812, decouple_loss:0.04490576684474945
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44140762090682983, gen p mean: 0.0, mean p set: 0.44820842146873474
loss_pred:0.07142983376979828, decouple_loss:0.04355120658874512
The modified gen p mean: 0.44178271293640137, gen p mean: 0.0, mean p set: 0.44789421558380127
loss_pred:0.06972955167293549, decouple_loss:0.045487720519304276
The modified gen p mean: 0.44260984659194946, gen p mean: 0.0, mean p set: 0.4478277862071991
loss_pred:0.07190822064876556, decouple_loss:0.04537467285990715
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44245317578315735, gen p mean: 0.0, mean p set: 0.44966837763786316
loss_pred:0.07280401885509491, decouple_loss:0.04484773799777031
The modified gen p mean: 0.4420003294944763, gen p mean: 0.0, mean p set: 0.44746968150138855
The modified gen p mean: 0.4446229934692383, gen p mean: 0.0, mean p set: 0.44861429929733276
loss_pred:0.06673689931631088, decouple_loss:0.043001506477594376
loss_pred:0.06720411777496338, decouple_loss:0.0435369648039341
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452381730079651, gen p mean: 0.0, mean p set: 0.44779905676841736
loss_pred:0.07037297636270523, decouple_loss:0.04595727473497391
The modified gen p mean: 0.4452747404575348, gen p mean: 0.0, mean p set: 0.4487842917442322
loss_pred:0.07086430490016937, decouple_loss:0.04575517773628235
The modified gen p mean: 0.44131502509117126, gen p mean: 0.0, mean p set: 0.4496642053127289
loss_pred:0.06911272555589676, decouple_loss:0.04812276363372803
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.442651629447937, gen p mean: 0.0, mean p set: 0.44761213660240173
loss_pred:0.06862274557352066, decouple_loss:0.043141283094882965
The modified gen p mean: 0.44008514285087585, gen p mean: 0.0, mean p set: 0.4477371573448181
loss_pred:0.06678934395313263, decouple_loss:0.04390775412321091
The modified gen p mean: 0.44206884503364563, gen p mean: 0.0, mean p set: 0.44964075088500977
loss_pred:0.06785855442285538, decouple_loss:0.04569771885871887
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4380939304828644, gen p mean: 0.0, mean p set: 0.4494765102863312
loss_pred:0.06384071707725525, decouple_loss:0.044984120875597
The modified gen p mean: 0.4366958737373352, gen p mean: 0.0, mean p set: 0.44957301020622253
loss_pred:0.06829101592302322, decouple_loss:0.04524030163884163
The modified gen p mean: 0.43605825304985046, gen p mean: 0.0, mean p set: 0.4498717188835144
loss_pred:0.07219405472278595, decouple_loss:0.044440947473049164
2023-05-05 15:04:53 testing...
The modified gen p mean: 0.4427396357059479, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.07166428118944168, decouple_loss:0.04585384950041771
The modified gen p mean: 0.44152089953422546, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.06957104057073593, decouple_loss:0.04627791792154312
The modified gen p mean: 0.4423958957195282, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.06879310309886932, decouple_loss:0.04592126980423927
WV_1_PC_0_EH_0_PS_40_6, loss: 0.07231035828590393, avg_mse: 0.06955596804618835
current test mse: 0.069556
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44154873490333557, gen p mean: 0.0, mean p set: 0.44803765416145325
loss_pred:0.06779065728187561, decouple_loss:0.047447241842746735
The modified gen p mean: 0.44673529267311096, gen p mean: 0.0, mean p set: 0.4505176842212677
loss_pred:0.06636650860309601, decouple_loss:0.0503942109644413
The modified gen p mean: 0.44137924909591675, gen p mean: 0.0, mean p set: 0.4472704529762268
loss_pred:0.07171063125133514, decouple_loss:0.047391876578330994
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4426632821559906, gen p mean: 0.0, mean p set: 0.45020073652267456
loss_pred:0.07049618661403656, decouple_loss:0.049624018371105194
The modified gen p mean: 0.44407039880752563, gen p mean: 0.0, mean p set: 0.4494149386882782
loss_pred:0.06906870007514954, decouple_loss:0.04774006828665733
The modified gen p mean: 0.44523027539253235, gen p mean: 0.0, mean p set: 0.4504365622997284
loss_pred:0.06445920467376709, decouple_loss:0.04912738502025604
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776883721351624, gen p mean: 0.0, mean p set: 0.447748064994812
loss_pred:0.06230967864394188, decouple_loss:0.04470747336745262
The modified gen p mean: 0.4477855861186981, gen p mean: 0.0, mean p set: 0.4483363628387451
loss_pred:0.06628700345754623, decouple_loss:0.045584890991449356
The modified gen p mean: 0.4486042261123657, gen p mean: 0.0, mean p set: 0.44884639978408813
loss_pred:0.06661912798881531, decouple_loss:0.04650507867336273
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445318341255188, gen p mean: 0.0, mean p set: 0.4481402039527893
loss_pred:0.06576182693243027, decouple_loss:0.0477411188185215
The modified gen p mean: 0.44598039984703064, gen p mean: 0.0, mean p set: 0.4493279755115509
The modified gen p mean: 0.44735845923423767, gen p mean: 0.0, mean p set: 0.44910797476768494
loss_pred:0.06627263873815536, decouple_loss:0.05155627802014351
loss_pred:0.0648154467344284, decouple_loss:0.048766717314720154
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4440946578979492, gen p mean: 0.0, mean p set: 0.44904303550720215
loss_pred:0.06576427817344666, decouple_loss:0.04682993143796921
The modified gen p mean: 0.4418039619922638, gen p mean: 0.0, mean p set: 0.4493841528892517
loss_pred:0.06543084979057312, decouple_loss:0.050948601216077805
The modified gen p mean: 0.4422134459018707, gen p mean: 0.0, mean p set: 0.447174608707428
loss_pred:0.07252629101276398, decouple_loss:0.04822392761707306
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4432300925254822, gen p mean: 0.0, mean p set: 0.44833314418792725
loss_pred:0.06374555081129074, decouple_loss:0.048145271837711334
The modified gen p mean: 0.4419640898704529, gen p mean: 0.0, mean p set: 0.4502794146537781
loss_pred:0.0641409382224083, decouple_loss:0.04791852459311485
The modified gen p mean: 0.44194674491882324, gen p mean: 0.0, mean p set: 0.4479128420352936
loss_pred:0.06112286448478699, decouple_loss:0.047481391578912735
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4448069632053375, gen p mean: 0.0, mean p set: 0.44786569476127625
loss_pred:0.0626034364104271, decouple_loss:0.047868840396404266
The modified gen p mean: 0.44288790225982666, gen p mean: 0.0, mean p set: 0.4479774832725525
loss_pred:0.06600332260131836, decouple_loss:0.0495658703148365
The modified gen p mean: 0.44486695528030396, gen p mean: 0.0, mean p set: 0.4478965699672699
loss_pred:0.06353823840618134, decouple_loss:0.04679606854915619
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501587748527527, gen p mean: 0.0, mean p set: 0.449554443359375
The modified gen p mean: 0.45290863513946533, gen p mean: 0.0, mean p set: 0.45123034715652466
loss_pred:0.06250031292438507, decouple_loss:0.0466412790119648
loss_pred:0.06444748491048813, decouple_loss:0.04921133443713188
The modified gen p mean: 0.450819194316864, gen p mean: 0.0, mean p set: 0.4494233727455139
loss_pred:0.06583628803491592, decouple_loss:0.047979455441236496
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020729303359985, gen p mean: 0.0, mean p set: 0.4496042728424072
loss_pred:0.06576376408338547, decouple_loss:0.04909082129597664
The modified gen p mean: 0.45106440782546997, gen p mean: 0.0, mean p set: 0.45023879408836365
loss_pred:0.06429179012775421, decouple_loss:0.046635985374450684
The modified gen p mean: 0.4519415497779846, gen p mean: 0.0, mean p set: 0.44867458939552307
loss_pred:0.062320105731487274, decouple_loss:0.04815270006656647
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487723410129547, gen p mean: 0.0, mean p set: 0.447394996881485
loss_pred:0.05949540063738823, decouple_loss:0.04514318332076073
The modified gen p mean: 0.4470185935497284, gen p mean: 0.0, mean p set: 0.45067334175109863
The modified gen p mean: 0.44758740067481995, gen p mean: 0.0, mean p set: 0.4481779932975769
loss_pred:0.06231500208377838, decouple_loss:0.04606790095567703
loss_pred:0.060494910925626755, decouple_loss:0.04764850065112114
2023-05-05 15:09:16 testing...
The modified gen p mean: 0.4422791600227356, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.06778693944215775, decouple_loss:0.04571870341897011
The modified gen p mean: 0.4415765404701233, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.06599143147468567, decouple_loss:0.046428382396698
The modified gen p mean: 0.44143596291542053, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.0653596967458725, decouple_loss:0.04550889879465103
WV_1_PC_0_EH_0_PS_40_6, loss: 0.06867362558841705, avg_mse: 0.06606230139732361
current test mse: 0.066062
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4429352283477783, gen p mean: 0.0, mean p set: 0.44867387413978577
loss_pred:0.06568347662687302, decouple_loss:0.04620574414730072
The modified gen p mean: 0.44034966826438904, gen p mean: 0.0, mean p set: 0.4498351216316223
loss_pred:0.0605161152780056, decouple_loss:0.04653764143586159
The modified gen p mean: 0.4396226704120636, gen p mean: 0.0, mean p set: 0.4494871497154236
loss_pred:0.06327658146619797, decouple_loss:0.04760710895061493
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.442126601934433, gen p mean: 0.0, mean p set: 0.4521370232105255
loss_pred:0.06467189639806747, decouple_loss:0.04697310924530029
The modified gen p mean: 0.4419839084148407, gen p mean: 0.0, mean p set: 0.44859644770622253
loss_pred:0.06293746083974838, decouple_loss:0.04704032093286514
The modified gen p mean: 0.44464507699012756, gen p mean: 0.0, mean p set: 0.44867774844169617
loss_pred:0.06691017746925354, decouple_loss:0.04508309066295624
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812631607055664, gen p mean: 0.0, mean p set: 0.44910773634910583
loss_pred:0.05935501307249069, decouple_loss:0.047010388225317
The modified gen p mean: 0.4502961039543152, gen p mean: 0.0, mean p set: 0.4475933015346527
The modified gen p mean: 0.4495050311088562, gen p mean: 0.0, mean p set: 0.4488815367221832
loss_pred:0.06370723247528076, decouple_loss:0.04599311947822571
loss_pred:0.06943649053573608, decouple_loss:0.04731760546565056
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510320723056793, gen p mean: 0.0, mean p set: 0.44782793521881104
loss_pred:0.06022217869758606, decouple_loss:0.04518076032400131
The modified gen p mean: 0.4500502645969391, gen p mean: 0.0, mean p set: 0.44846272468566895
loss_pred:0.0606200210750103, decouple_loss:0.04807470738887787
The modified gen p mean: 0.44935768842697144, gen p mean: 0.0, mean p set: 0.4492860734462738
loss_pred:0.061750318855047226, decouple_loss:0.047926414757966995
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975826144218445, gen p mean: 0.0, mean p set: 0.44889771938323975
loss_pred:0.061488378793001175, decouple_loss:0.04732556641101837
The modified gen p mean: 0.44496098160743713, gen p mean: 0.0, mean p set: 0.4495624303817749
loss_pred:0.06305089592933655, decouple_loss:0.04822021350264549
The modified gen p mean: 0.4469621777534485, gen p mean: 0.0, mean p set: 0.4479064643383026
loss_pred:0.06535276770591736, decouple_loss:0.0483052134513855
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448847234249115, gen p mean: 0.0, mean p set: 0.4496400058269501
loss_pred:0.05977153033018112, decouple_loss:0.045841291546821594
The modified gen p mean: 0.4478187561035156, gen p mean: 0.0, mean p set: 0.4477371871471405
loss_pred:0.05841366946697235, decouple_loss:0.04540237784385681
The modified gen p mean: 0.446972519159317, gen p mean: 0.0, mean p set: 0.44923779368400574
loss_pred:0.06541276723146439, decouple_loss:0.046941958367824554
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477865695953369, gen p mean: 0.0, mean p set: 0.45009157061576843
loss_pred:0.06268268823623657, decouple_loss:0.04582913592457771
The modified gen p mean: 0.45402055978775024, gen p mean: 0.0, mean p set: 0.44885799288749695
loss_pred:0.06244558095932007, decouple_loss:0.045266907662153244
The modified gen p mean: 0.45036160945892334, gen p mean: 0.0, mean p set: 0.44920656085014343
loss_pred:0.06305933743715286, decouple_loss:0.045543622225522995
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4616488814353943, gen p mean: 0.0, mean p set: 0.44843384623527527
loss_pred:0.0633624866604805, decouple_loss:0.04661557450890541
The modified gen p mean: 0.4596092104911804, gen p mean: 0.0, mean p set: 0.4485572874546051
The modified gen p mean: 0.4592711329460144, gen p mean: 0.0, mean p set: 0.449176549911499
loss_pred:0.06154882162809372, decouple_loss:0.046128444373607635
loss_pred:0.06144101545214653, decouple_loss:0.04676526039838791
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958359003067017, gen p mean: 0.0, mean p set: 0.4480287730693817The modified gen p mean: 0.45278772711753845, gen p mean: 0.0, mean p set: 0.4477499723434448
loss_pred:0.0638430193066597, decouple_loss:0.04641749709844589
loss_pred:0.06042123958468437, decouple_loss:0.04357551410794258
The modified gen p mean: 0.44969868659973145, gen p mean: 0.0, mean p set: 0.4502353370189667
loss_pred:0.05931605026125908, decouple_loss:0.0446225181221962
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465620219707489, gen p mean: 0.0, mean p set: 0.44814345240592957
loss_pred:0.05958566069602966, decouple_loss:0.04646121338009834
The modified gen p mean: 0.4456578493118286, gen p mean: 0.0, mean p set: 0.44887375831604004
loss_pred:0.06477081775665283, decouple_loss:0.04547378048300743
The modified gen p mean: 0.44182920455932617, gen p mean: 0.0, mean p set: 0.4493709206581116
loss_pred:0.0627199336886406, decouple_loss:0.04555325582623482
2023-05-05 15:13:03 testing...
The modified gen p mean: 0.4537332355976105, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.06496123224496841, decouple_loss:0.04467574506998062
The modified gen p mean: 0.45301881432533264, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.06344035267829895, decouple_loss:0.044508617371320724
The modified gen p mean: 0.45220479369163513, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.06394107639789581, decouple_loss:0.04566129669547081
WV_1_PC_0_EH_0_PS_40_6, loss: 0.06636165082454681, avg_mse: 0.06395614147186279
current test mse: 0.063956
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519036114215851, gen p mean: 0.0, mean p set: 0.4468391239643097
loss_pred:0.06312226504087448, decouple_loss:0.045343633741140366
The modified gen p mean: 0.4487780034542084, gen p mean: 0.0, mean p set: 0.4480014741420746
loss_pred:0.06218066066503525, decouple_loss:0.04575168713927269
The modified gen p mean: 0.44997426867485046, gen p mean: 0.0, mean p set: 0.4492167532444
loss_pred:0.06578690558671951, decouple_loss:0.04620745778083801
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507296681404114, gen p mean: 0.0, mean p set: 0.44850867986679077
loss_pred:0.06275274604558945, decouple_loss:0.04571324214339256
The modified gen p mean: 0.4540700614452362, gen p mean: 0.0, mean p set: 0.4488369822502136
loss_pred:0.06328220665454865, decouple_loss:0.04481301084160805
The modified gen p mean: 0.45128390192985535, gen p mean: 0.0, mean p set: 0.44645413756370544
loss_pred:0.06331854313611984, decouple_loss:0.04696959629654884
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459749162197113, gen p mean: 0.0, mean p set: 0.4479483664035797
The modified gen p mean: 0.44591763615608215, gen p mean: 0.0, mean p set: 0.448919415473938
loss_pred:0.06139128655195236, decouple_loss:0.04576005041599274
loss_pred:0.061878085136413574, decouple_loss:0.04502630606293678
The modified gen p mean: 0.44744041562080383, gen p mean: 0.0, mean p set: 0.44777119159698486
loss_pred:0.06546344608068466, decouple_loss:0.045294132083654404
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4384044408798218, gen p mean: 0.0, mean p set: 0.4488692581653595
loss_pred:0.06447655707597733, decouple_loss:0.045963745564222336
The modified gen p mean: 0.442745566368103, gen p mean: 0.0, mean p set: 0.44869908690452576
loss_pred:0.07057884335517883, decouple_loss:0.045198000967502594
The modified gen p mean: 0.44145333766937256, gen p mean: 0.0, mean p set: 0.4480428397655487
loss_pred:0.06224730238318443, decouple_loss:0.04565462842583656
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45245516300201416, gen p mean: 0.0, mean p set: 0.4486686885356903
loss_pred:0.06922740489244461, decouple_loss:0.04350932314991951
The modified gen p mean: 0.45567360520362854, gen p mean: 0.0, mean p set: 0.4490565061569214
loss_pred:0.06349717080593109, decouple_loss:0.04526662454009056
The modified gen p mean: 0.4476644992828369, gen p mean: 0.0, mean p set: 0.4476326107978821
loss_pred:0.06084214523434639, decouple_loss:0.04344973713159561
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4590226113796234, gen p mean: 0.0, mean p set: 0.4477252662181854
loss_pred:0.06295792013406754, decouple_loss:0.04571251571178436
The modified gen p mean: 0.46290355920791626, gen p mean: 0.0, mean p set: 0.44841864705085754
loss_pred:0.06091948226094246, decouple_loss:0.047094691544771194
The modified gen p mean: 0.4592757821083069, gen p mean: 0.0, mean p set: 0.44844329357147217
loss_pred:0.06900686025619507, decouple_loss:0.04624735191464424
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478995203971863, gen p mean: 0.0, mean p set: 0.4485113322734833
loss_pred:0.05937599390745163, decouple_loss:0.04394197836518288
The modified gen p mean: 0.44726458191871643, gen p mean: 0.0, mean p set: 0.4486646354198456
loss_pred:0.0629071593284607, decouple_loss:0.04358935356140137
The modified gen p mean: 0.44944503903388977, gen p mean: 0.0, mean p set: 0.4490351974964142
loss_pred:0.05996694788336754, decouple_loss:0.044111818075180054
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43019750714302063, gen p mean: 0.0, mean p set: 0.44780370593070984
loss_pred:0.06034775823354721, decouple_loss:0.045235130935907364
The modified gen p mean: 0.43367817997932434, gen p mean: 0.0, mean p set: 0.44847002625465393
The modified gen p mean: 0.4322763681411743, gen p mean: 0.0, mean p set: 0.4494354724884033
loss_pred:0.06264897435903549, decouple_loss:0.04420291259884834
loss_pred:0.06296718865633011, decouple_loss:0.04413105547428131
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4405863881111145, gen p mean: 0.0, mean p set: 0.4461473524570465
loss_pred:0.06667336076498032, decouple_loss:0.046630457043647766
The modified gen p mean: 0.4402868151664734, gen p mean: 0.0, mean p set: 0.4487389624118805
loss_pred:0.06215935945510864, decouple_loss:0.04563549533486366
The modified gen p mean: 0.44133275747299194, gen p mean: 0.0, mean p set: 0.4464397132396698
loss_pred:0.062460560351610184, decouple_loss:0.04448191076517105
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4584024250507355, gen p mean: 0.0, mean p set: 0.44826918840408325
loss_pred:0.06365016102790833, decouple_loss:0.04234298691153526
The modified gen p mean: 0.4604342579841614, gen p mean: 0.0, mean p set: 0.44944167137145996
loss_pred:0.0613861121237278, decouple_loss:0.045371901243925095
The modified gen p mean: 0.4582797586917877, gen p mean: 0.0, mean p set: 0.44764459133148193
loss_pred:0.061050377786159515, decouple_loss:0.04537925124168396
2023-05-05 15:17:27 testing...
The modified gen p mean: 0.45405110716819763, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.06126454100012779, decouple_loss:0.044681649655103683
The modified gen p mean: 0.4554893672466278, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.06382349878549576, decouple_loss:0.04441061243414879
The modified gen p mean: 0.45549342036247253, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.06087590008974075, decouple_loss:0.043651033192873
WV_1_PC_0_EH_0_PS_40_6, loss: 0.06420037150382996, avg_mse: 0.062217533588409424
current test mse: 0.062218
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45173379778862, gen p mean: 0.0, mean p set: 0.4467865526676178
loss_pred:0.06718876212835312, decouple_loss:0.0433039553463459
The modified gen p mean: 0.45457693934440613, gen p mean: 0.0, mean p set: 0.44967639446258545
loss_pred:0.0601254366338253, decouple_loss:0.04415299370884895
The modified gen p mean: 0.4506708085536957, gen p mean: 0.0, mean p set: 0.44689464569091797
loss_pred:0.06622006744146347, decouple_loss:0.043271955102682114
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4415642321109772, gen p mean: 0.0, mean p set: 0.44767823815345764
loss_pred:0.06160585582256317, decouple_loss:0.04442325234413147
The modified gen p mean: 0.44277724623680115, gen p mean: 0.0, mean p set: 0.448184072971344
The modified gen p mean: 0.4430004954338074, gen p mean: 0.0, mean p set: 0.44951605796813965
loss_pred:0.06114387884736061, decouple_loss:0.043391671031713486
loss_pred:0.06537999212741852, decouple_loss:0.04441084712743759
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461243748664856, gen p mean: 0.0, mean p set: 0.44889581203460693
loss_pred:0.06832018494606018, decouple_loss:0.04429033398628235
The modified gen p mean: 0.4425398111343384, gen p mean: 0.0, mean p set: 0.44812238216400146
loss_pred:0.06389109045267105, decouple_loss:0.04438629373908043
The modified gen p mean: 0.4396556615829468, gen p mean: 0.0, mean p set: 0.44645223021507263
loss_pred:0.06206820532679558, decouple_loss:0.04484858363866806
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44450289011001587, gen p mean: 0.0, mean p set: 0.44584187865257263
loss_pred:0.06256145983934402, decouple_loss:0.04431220889091492
The modified gen p mean: 0.4450186491012573, gen p mean: 0.0, mean p set: 0.4476655125617981
loss_pred:0.057095207273960114, decouple_loss:0.04211999475955963
The modified gen p mean: 0.443587064743042, gen p mean: 0.0, mean p set: 0.44985130429267883
loss_pred:0.06142372265458107, decouple_loss:0.044577643275260925
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539749324321747, gen p mean: 0.0, mean p set: 0.44930681586265564
The modified gen p mean: 0.45015978813171387, gen p mean: 0.0, mean p set: 0.4489421248435974
loss_pred:0.062541663646698, decouple_loss:0.042434029281139374
loss_pred:0.06079912558197975, decouple_loss:0.04376223310828209
The modified gen p mean: 0.45000115036964417, gen p mean: 0.0, mean p set: 0.4478928744792938
loss_pred:0.0623541958630085, decouple_loss:0.04362514242529869
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510023891925812, gen p mean: 0.0, mean p set: 0.4481014013290405
loss_pred:0.0636945590376854, decouple_loss:0.04356729984283447
The modified gen p mean: 0.44983986020088196, gen p mean: 0.0, mean p set: 0.4486868679523468
loss_pred:0.05979207158088684, decouple_loss:0.04300761967897415
The modified gen p mean: 0.449669748544693, gen p mean: 0.0, mean p set: 0.4489506781101227
loss_pred:0.06499006599187851, decouple_loss:0.04142964258790016
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470934569835663, gen p mean: 0.0, mean p set: 0.4480399191379547
loss_pred:0.057249825447797775, decouple_loss:0.04107962176203728
The modified gen p mean: 0.4498838186264038, gen p mean: 0.0, mean p set: 0.4473777115345001
loss_pred:0.06335727125406265, decouple_loss:0.0435200035572052
The modified gen p mean: 0.44897833466529846, gen p mean: 0.0, mean p set: 0.448468953371048
loss_pred:0.06301587074995041, decouple_loss:0.04138515517115593
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497830271720886, gen p mean: 0.0, mean p set: 0.44794782996177673
loss_pred:0.06398378312587738, decouple_loss:0.04178578779101372
The modified gen p mean: 0.4548470973968506, gen p mean: 0.0, mean p set: 0.44908660650253296
loss_pred:0.06762455403804779, decouple_loss:0.04511389881372452
The modified gen p mean: 0.44907256960868835, gen p mean: 0.0, mean p set: 0.44827160239219666
loss_pred:0.06240280717611313, decouple_loss:0.04327690228819847
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44486507773399353, gen p mean: 0.0, mean p set: 0.4487598240375519
The modified gen p mean: 0.4469679296016693, gen p mean: 0.0, mean p set: 0.4482314884662628
loss_pred:0.06022462993860245, decouple_loss:0.04248160496354103
loss_pred:0.059311557561159134, decouple_loss:0.04351814463734627
The modified gen p mean: 0.44621285796165466, gen p mean: 0.0, mean p set: 0.4475817382335663
loss_pred:0.060125838965177536, decouple_loss:0.043864935636520386
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4314027726650238, gen p mean: 0.0, mean p set: 0.44764280319213867
loss_pred:0.05834583193063736, decouple_loss:0.04428335651755333
The modified gen p mean: 0.43535876274108887, gen p mean: 0.0, mean p set: 0.4479406476020813
loss_pred:0.060304876416921616, decouple_loss:0.04169600456953049
The modified gen p mean: 0.43846845626831055, gen p mean: 0.0, mean p set: 0.4495036005973816
loss_pred:0.06272851675748825, decouple_loss:0.04259788244962692
2023-05-05 15:21:12 testing...
The modified gen p mean: 0.4411863088607788, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.062330108135938644, decouple_loss:0.042536165565252304
The modified gen p mean: 0.4410739541053772, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4409913420677185, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05979055538773537, decouple_loss:0.04233459755778313
loss_pred:0.05980931594967842, decouple_loss:0.0414707213640213
WV_1_PC_0_EH_0_PS_40_6, loss: 0.06274902075529099, avg_mse: 0.06156500056385994
current test mse: 0.061565
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43934378027915955, gen p mean: 0.0, mean p set: 0.44797900319099426
loss_pred:0.05936809256672859, decouple_loss:0.04312220960855484
The modified gen p mean: 0.44050782918930054, gen p mean: 0.0, mean p set: 0.4476796090602875
loss_pred:0.06227763369679451, decouple_loss:0.0436699315905571
The modified gen p mean: 0.43896719813346863, gen p mean: 0.0, mean p set: 0.44802939891815186
loss_pred:0.0614863745868206, decouple_loss:0.04419833794236183
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483618438243866, gen p mean: 0.0, mean p set: 0.44819650053977966
loss_pred:0.057605329900979996, decouple_loss:0.04523029550909996
The modified gen p mean: 0.4449712038040161, gen p mean: 0.0, mean p set: 0.4491655230522156
loss_pred:0.05778057128190994, decouple_loss:0.042317211627960205
The modified gen p mean: 0.4453634023666382, gen p mean: 0.0, mean p set: 0.4486139416694641
loss_pred:0.060233037918806076, decouple_loss:0.04516562074422836
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534434378147125, gen p mean: 0.0, mean p set: 0.4480193257331848
loss_pred:0.05693701282143593, decouple_loss:0.04560771957039833
The modified gen p mean: 0.45191892981529236, gen p mean: 0.0, mean p set: 0.44859370589256287
loss_pred:0.05837979540228844, decouple_loss:0.04386468231678009
The modified gen p mean: 0.4527108073234558, gen p mean: 0.0, mean p set: 0.4478999972343445
loss_pred:0.058471232652664185, decouple_loss:0.0438326820731163
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991543889045715, gen p mean: 0.0, mean p set: 0.4483139216899872
loss_pred:0.05800708755850792, decouple_loss:0.04326057806611061
The modified gen p mean: 0.4495364725589752, gen p mean: 0.0, mean p set: 0.44836533069610596
loss_pred:0.05875731259584427, decouple_loss:0.044290076941251755
The modified gen p mean: 0.4517611563205719, gen p mean: 0.0, mean p set: 0.4476061165332794
loss_pred:0.05908515676856041, decouple_loss:0.04476131126284599
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4421173632144928, gen p mean: 0.0, mean p set: 0.44792643189430237
loss_pred:0.058616481721401215, decouple_loss:0.04317411780357361
The modified gen p mean: 0.44232386350631714, gen p mean: 0.0, mean p set: 0.4482753276824951
loss_pred:0.058592788875103, decouple_loss:0.04335426166653633
The modified gen p mean: 0.4468207061290741, gen p mean: 0.0, mean p set: 0.448341965675354
loss_pred:0.06019178032875061, decouple_loss:0.043660253286361694
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4377745985984802, gen p mean: 0.0, mean p set: 0.44838467240333557
loss_pred:0.05683516710996628, decouple_loss:0.044249121099710464
The modified gen p mean: 0.4361928403377533, gen p mean: 0.0, mean p set: 0.44843557476997375
loss_pred:0.059282705187797546, decouple_loss:0.04335923120379448
The modified gen p mean: 0.4320823550224304, gen p mean: 0.0, mean p set: 0.448775053024292
loss_pred:0.05799420550465584, decouple_loss:0.04245854541659355
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4403124451637268, gen p mean: 0.0, mean p set: 0.4485950171947479
loss_pred:0.058017194271087646, decouple_loss:0.04378402233123779
The modified gen p mean: 0.4404452443122864, gen p mean: 0.0, mean p set: 0.4489077031612396
The modified gen p mean: 0.438514769077301, gen p mean: 0.0, mean p set: 0.4496433436870575
loss_pred:0.05665798857808113, decouple_loss:0.042556099593639374
loss_pred:0.058311302214860916, decouple_loss:0.044177211821079254
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44655972719192505, gen p mean: 0.0, mean p set: 0.4479960799217224
loss_pred:0.05656043440103531, decouple_loss:0.041570521891117096
The modified gen p mean: 0.447357714176178, gen p mean: 0.0, mean p set: 0.44828298687934875
loss_pred:0.05767752602696419, decouple_loss:0.04222540184855461
The modified gen p mean: 0.4500505328178406, gen p mean: 0.0, mean p set: 0.44847962260246277
loss_pred:0.059826720505952835, decouple_loss:0.04284759238362312
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46022915840148926, gen p mean: 0.0, mean p set: 0.4492427408695221
loss_pred:0.05677996203303337, decouple_loss:0.04069959744811058
The modified gen p mean: 0.45987561345100403, gen p mean: 0.0, mean p set: 0.4482157230377197
loss_pred:0.05855758115649223, decouple_loss:0.041194114834070206
The modified gen p mean: 0.46136292815208435, gen p mean: 0.0, mean p set: 0.44889721274375916
loss_pred:0.05525384470820427, decouple_loss:0.0440315380692482
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457596242427826, gen p mean: 0.0, mean p set: 0.44846177101135254
loss_pred:0.05689153075218201, decouple_loss:0.042292412370443344
The modified gen p mean: 0.44886845350265503, gen p mean: 0.0, mean p set: 0.448201984167099
loss_pred:0.05591879040002823, decouple_loss:0.040941547602415085
The modified gen p mean: 0.4483101963996887, gen p mean: 0.0, mean p set: 0.4484822154045105
loss_pred:0.05673836171627045, decouple_loss:0.04166291654109955
2023-05-05 15:25:39 testing...
The modified gen p mean: 0.43934035301208496, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.05941419303417206, decouple_loss:0.04231281578540802
The modified gen p mean: 0.4390813112258911, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.057513993233442307, decouple_loss:0.04337754100561142
The modified gen p mean: 0.43820276856422424, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05805506929755211, decouple_loss:0.042103152722120285
WV_1_PC_0_EH_0_PS_40_6, loss: 0.06045764684677124, avg_mse: 0.0594448521733284
current test mse: 0.059445
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4358186423778534, gen p mean: 0.0, mean p set: 0.44892874360084534
loss_pred:0.056552257388830185, decouple_loss:0.0420721173286438
The modified gen p mean: 0.4340149164199829, gen p mean: 0.0, mean p set: 0.44904080033302307
loss_pred:0.05499643087387085, decouple_loss:0.04294125363230705
The modified gen p mean: 0.4341946840286255, gen p mean: 0.0, mean p set: 0.44926151633262634
loss_pred:0.05828108638525009, decouple_loss:0.04406893625855446
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43991619348526, gen p mean: 0.0, mean p set: 0.44847777485847473
loss_pred:0.056352343410253525, decouple_loss:0.042598288506269455
The modified gen p mean: 0.4361811578273773, gen p mean: 0.0, mean p set: 0.4482516348361969
loss_pred:0.05691679194569588, decouple_loss:0.04187600687146187
The modified gen p mean: 0.4388139545917511, gen p mean: 0.0, mean p set: 0.44826412200927734
loss_pred:0.0541524738073349, decouple_loss:0.040956612676382065
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509449005126953, gen p mean: 0.0, mean p set: 0.44810721278190613
loss_pred:0.0569058433175087, decouple_loss:0.041348766535520554
The modified gen p mean: 0.44928914308547974, gen p mean: 0.0, mean p set: 0.4487065374851227
loss_pred:0.053686171770095825, decouple_loss:0.04070862755179405
The modified gen p mean: 0.45033755898475647, gen p mean: 0.0, mean p set: 0.44928398728370667
loss_pred:0.0590549036860466, decouple_loss:0.041445352137088776
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45615795254707336, gen p mean: 0.0, mean p set: 0.44789719581604004
loss_pred:0.0572030283510685, decouple_loss:0.04016765207052231
The modified gen p mean: 0.4561368227005005, gen p mean: 0.0, mean p set: 0.44776955246925354
The modified gen p mean: 0.4584607481956482, gen p mean: 0.0, mean p set: 0.4488312005996704
loss_pred:0.056884415447711945, decouple_loss:0.04134198650717735
loss_pred:0.057699840515851974, decouple_loss:0.039929863065481186
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45355793833732605, gen p mean: 0.0, mean p set: 0.44838589429855347
loss_pred:0.0544934906065464, decouple_loss:0.04048912227153778
The modified gen p mean: 0.4524509608745575, gen p mean: 0.0, mean p set: 0.44854554533958435
The modified gen p mean: 0.45291557908058167, gen p mean: 0.0, mean p set: 0.44799885153770447
loss_pred:0.05590339004993439, decouple_loss:0.04041063413023949
loss_pred:0.05302916839718819, decouple_loss:0.03947150707244873
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457976818084717, gen p mean: 0.0, mean p set: 0.44854387640953064
loss_pred:0.05415596067905426, decouple_loss:0.040770381689071655
The modified gen p mean: 0.44687026739120483, gen p mean: 0.0, mean p set: 0.44839832186698914
loss_pred:0.0547366626560688, decouple_loss:0.04111868143081665
The modified gen p mean: 0.4463215172290802, gen p mean: 0.0, mean p set: 0.4483332633972168
loss_pred:0.053209733217954636, decouple_loss:0.03944305703043938
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4433187246322632, gen p mean: 0.0, mean p set: 0.4479837417602539
loss_pred:0.05777978524565697, decouple_loss:0.038834258913993835
The modified gen p mean: 0.444597452878952, gen p mean: 0.0, mean p set: 0.44819343090057373
loss_pred:0.05604255944490433, decouple_loss:0.03807350993156433
The modified gen p mean: 0.44141075015068054, gen p mean: 0.0, mean p set: 0.44859760999679565
loss_pred:0.05599742755293846, decouple_loss:0.0399293452501297
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4440456032752991, gen p mean: 0.0, mean p set: 0.44859638810157776
loss_pred:0.056425027549266815, decouple_loss:0.03841032460331917
The modified gen p mean: 0.4399940073490143, gen p mean: 0.0, mean p set: 0.4485490918159485
The modified gen p mean: 0.4453085660934448, gen p mean: 0.0, mean p set: 0.4477587640285492
loss_pred:0.05499277263879776, decouple_loss:0.03823697566986084
loss_pred:0.05594408139586449, decouple_loss:0.03955017030239105
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44993579387664795, gen p mean: 0.0, mean p set: 0.4481166899204254
loss_pred:0.05422626808285713, decouple_loss:0.0380086824297905
The modified gen p mean: 0.4520816206932068, gen p mean: 0.0, mean p set: 0.4483576714992523
loss_pred:0.05443650484085083, decouple_loss:0.038576044142246246
The modified gen p mean: 0.4534362852573395, gen p mean: 0.0, mean p set: 0.448095440864563
loss_pred:0.05451629310846329, decouple_loss:0.039789896458387375
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510897397994995, gen p mean: 0.0, mean p set: 0.4488089084625244
loss_pred:0.057098325341939926, decouple_loss:0.040505725890398026
The modified gen p mean: 0.44784459471702576, gen p mean: 0.0, mean p set: 0.44843021035194397
The modified gen p mean: 0.4458564221858978, gen p mean: 0.0, mean p set: 0.44828253984451294
loss_pred:0.05160921812057495, decouple_loss:0.039331890642642975
loss_pred:0.0551108680665493, decouple_loss:0.03815627843141556
2023-05-05 15:29:26 testing...
The modified gen p mean: 0.45099520683288574, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.05711815878748894, decouple_loss:0.03999914228916168
The modified gen p mean: 0.4514351487159729, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4499419331550598, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05670342966914177, decouple_loss:0.03948597609996796
loss_pred:0.05771291255950928, decouple_loss:0.03933272883296013
WV_1_PC_0_EH_0_PS_40_6, loss: 0.05915846675634384, avg_mse: 0.05849038064479828
current test mse: 0.05849
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452122300863266, gen p mean: 0.0, mean p set: 0.4501415491104126
loss_pred:0.05607017129659653, decouple_loss:0.04027147591114044
The modified gen p mean: 0.448694109916687, gen p mean: 0.0, mean p set: 0.45058757066726685
loss_pred:0.05641130730509758, decouple_loss:0.04052865505218506
The modified gen p mean: 0.4510776400566101, gen p mean: 0.0, mean p set: 0.45017993450164795
loss_pred:0.05515593662858009, decouple_loss:0.04036462679505348
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4429910480976105, gen p mean: 0.0, mean p set: 0.4498046338558197
loss_pred:0.0548153780400753, decouple_loss:0.04139023646712303
The modified gen p mean: 0.4461686611175537, gen p mean: 0.0, mean p set: 0.4490925073623657
loss_pred:0.055344294756650925, decouple_loss:0.040881820023059845
The modified gen p mean: 0.44587984681129456, gen p mean: 0.0, mean p set: 0.45062586665153503
loss_pred:0.055843282490968704, decouple_loss:0.03952644392848015
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4561840891838074, gen p mean: 0.0, mean p set: 0.4498143792152405
The modified gen p mean: 0.4533655345439911, gen p mean: 0.0, mean p set: 0.4500381648540497loss_pred:0.05564960837364197, decouple_loss:0.03799324110150337
loss_pred:0.05342916399240494, decouple_loss:0.03981495276093483
The modified gen p mean: 0.4536353051662445, gen p mean: 0.0, mean p set: 0.4499199688434601
loss_pred:0.053338423371315, decouple_loss:0.039458975195884705
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45835718512535095, gen p mean: 0.0, mean p set: 0.4498307704925537
loss_pred:0.05480184033513069, decouple_loss:0.040674738585948944
The modified gen p mean: 0.4545430541038513, gen p mean: 0.0, mean p set: 0.4512575566768646
loss_pred:0.053869158029556274, decouple_loss:0.038882602006196976
The modified gen p mean: 0.4573409855365753, gen p mean: 0.0, mean p set: 0.45067691802978516
loss_pred:0.056211989372968674, decouple_loss:0.04049402475357056
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4411323368549347, gen p mean: 0.0, mean p set: 0.4506319463253021
loss_pred:0.05758495256304741, decouple_loss:0.039343155920505524
The modified gen p mean: 0.4396779537200928, gen p mean: 0.0, mean p set: 0.4510757029056549
loss_pred:0.05822126939892769, decouple_loss:0.04145306348800659
The modified gen p mean: 0.4424261450767517, gen p mean: 0.0, mean p set: 0.4496159553527832
loss_pred:0.05537499487400055, decouple_loss:0.038605183362960815
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881609082221985, gen p mean: 0.0, mean p set: 0.44988662004470825
loss_pred:0.05319932848215103, decouple_loss:0.039412856101989746
The modified gen p mean: 0.4488329589366913, gen p mean: 0.0, mean p set: 0.4502067267894745
loss_pred:0.05480391904711723, decouple_loss:0.041231267154216766
The modified gen p mean: 0.449922114610672, gen p mean: 0.0, mean p set: 0.4506498873233795
loss_pred:0.05742944777011871, decouple_loss:0.04274987429380417
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45794570446014404, gen p mean: 0.0, mean p set: 0.45038241147994995
loss_pred:0.055957380682229996, decouple_loss:0.040813133120536804
The modified gen p mean: 0.459844172000885, gen p mean: 0.0, mean p set: 0.45092761516571045
loss_pred:0.05633031204342842, decouple_loss:0.042431484907865524
The modified gen p mean: 0.45628780126571655, gen p mean: 0.0, mean p set: 0.4508611261844635
loss_pred:0.05754471197724342, decouple_loss:0.0414821021258831
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508625566959381, gen p mean: 0.0, mean p set: 0.44944941997528076
The modified gen p mean: 0.4484298825263977, gen p mean: 0.0, mean p set: 0.45127072930336
loss_pred:0.06020509451627731, decouple_loss:0.04133132845163345loss_pred:0.05455358698964119, decouple_loss:0.040124207735061646
The modified gen p mean: 0.45038869976997375, gen p mean: 0.0, mean p set: 0.44988352060317993
loss_pred:0.0537625327706337, decouple_loss:0.039823394268751144
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4386534094810486, gen p mean: 0.0, mean p set: 0.4491928219795227
loss_pred:0.0556442029774189, decouple_loss:0.04233602061867714
The modified gen p mean: 0.43999049067497253, gen p mean: 0.0, mean p set: 0.45014673471450806
loss_pred:0.052773866802453995, decouple_loss:0.03984550014138222
The modified gen p mean: 0.4393903911113739, gen p mean: 0.0, mean p set: 0.4517151713371277
loss_pred:0.05688818171620369, decouple_loss:0.04158337041735649
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446833074092865, gen p mean: 0.0, mean p set: 0.44995349645614624
loss_pred:0.05357182025909424, decouple_loss:0.039867956191301346
The modified gen p mean: 0.4474487900733948, gen p mean: 0.0, mean p set: 0.450135201215744
The modified gen p mean: 0.44782161712646484, gen p mean: 0.0, mean p set: 0.4492048919200897
loss_pred:0.05403778702020645, decouple_loss:0.041496045887470245
loss_pred:0.052536364644765854, decouple_loss:0.0399700365960598
2023-05-05 15:33:59 testing...
The modified gen p mean: 0.45257988572120667, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.05699772760272026, decouple_loss:0.041342951357364655
The modified gen p mean: 0.4519576132297516, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.05563521757721901, decouple_loss:0.04257075861096382
The modified gen p mean: 0.4510774612426758, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05622083321213722, decouple_loss:0.04091851785778999
WV_1_PC_0_EH_0_PS_40_6, loss: 0.05836513265967369, avg_mse: 0.05744864419102669
current test mse: 0.057449
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449557900428772, gen p mean: 0.0, mean p set: 0.4504148066043854
loss_pred:0.05469734966754913, decouple_loss:0.042792994529008865
The modified gen p mean: 0.4514153003692627, gen p mean: 0.0, mean p set: 0.4491656422615051
loss_pred:0.05394522473216057, decouple_loss:0.04113573953509331
The modified gen p mean: 0.4513246417045593, gen p mean: 0.0, mean p set: 0.4495888352394104
loss_pred:0.05400243028998375, decouple_loss:0.04139271378517151
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45376381278038025, gen p mean: 0.0, mean p set: 0.45116761326789856
loss_pred:0.057348404079675674, decouple_loss:0.0418696291744709
The modified gen p mean: 0.45140695571899414, gen p mean: 0.0, mean p set: 0.448609322309494
loss_pred:0.05304328724741936, decouple_loss:0.040869008749723434
The modified gen p mean: 0.4492890238761902, gen p mean: 0.0, mean p set: 0.450583815574646
loss_pred:0.056330349296331406, decouple_loss:0.03955874592065811
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45284029841423035, gen p mean: 0.0, mean p set: 0.4493815302848816
loss_pred:0.053165286779403687, decouple_loss:0.04178618639707565
The modified gen p mean: 0.45096147060394287, gen p mean: 0.0, mean p set: 0.4509483277797699
loss_pred:0.05807718634605408, decouple_loss:0.04130290448665619
The modified gen p mean: 0.4480046331882477, gen p mean: 0.0, mean p set: 0.44972866773605347
loss_pred:0.05364493280649185, decouple_loss:0.03989123925566673
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4562700390815735, gen p mean: 0.0, mean p set: 0.4498307406902313
loss_pred:0.05211028456687927, decouple_loss:0.03986968472599983
The modified gen p mean: 0.4551064074039459, gen p mean: 0.0, mean p set: 0.4513084292411804
loss_pred:0.05720273405313492, decouple_loss:0.041139595210552216
The modified gen p mean: 0.45325660705566406, gen p mean: 0.0, mean p set: 0.4508230984210968
loss_pred:0.054884590208530426, decouple_loss:0.041356801986694336
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537992775440216, gen p mean: 0.0, mean p set: 0.4502823054790497
loss_pred:0.05252077430486679, decouple_loss:0.040062498301267624
The modified gen p mean: 0.4583144783973694, gen p mean: 0.0, mean p set: 0.451102077960968
loss_pred:0.05517839267849922, decouple_loss:0.041920315474271774
The modified gen p mean: 0.45327651500701904, gen p mean: 0.0, mean p set: 0.4510018229484558
loss_pred:0.058204151690006256, decouple_loss:0.04120272770524025
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521092474460602, gen p mean: 0.0, mean p set: 0.45006564259529114
loss_pred:0.053310129791498184, decouple_loss:0.03974843770265579
The modified gen p mean: 0.44596201181411743, gen p mean: 0.0, mean p set: 0.45036831498146057
The modified gen p mean: 0.44637104868888855, gen p mean: 0.0, mean p set: 0.4491916298866272
loss_pred:0.05165938660502434, decouple_loss:0.04101547971367836
loss_pred:0.05269962549209595, decouple_loss:0.040059398859739304
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4435458183288574, gen p mean: 0.0, mean p set: 0.4507621228694916
loss_pred:0.0556437149643898, decouple_loss:0.040403373539447784
The modified gen p mean: 0.4415436387062073, gen p mean: 0.0, mean p set: 0.4506154954433441
loss_pred:0.054102823138237, decouple_loss:0.03763342276215553
The modified gen p mean: 0.44162148237228394, gen p mean: 0.0, mean p set: 0.4502556622028351
loss_pred:0.05406584590673447, decouple_loss:0.04128830507397652
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672322273254395, gen p mean: 0.0, mean p set: 0.4507182538509369
loss_pred:0.05164388194680214, decouple_loss:0.03935177996754646
The modified gen p mean: 0.4474778473377228, gen p mean: 0.0, mean p set: 0.4496990144252777
loss_pred:0.05366841331124306, decouple_loss:0.04009753093123436
The modified gen p mean: 0.44591161608695984, gen p mean: 0.0, mean p set: 0.45056453347206116
loss_pred:0.056728966534137726, decouple_loss:0.03860973194241524
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478785991668701, gen p mean: 0.0, mean p set: 0.4511975646018982
The modified gen p mean: 0.44597694277763367, gen p mean: 0.0, mean p set: 0.44952836632728577
loss_pred:0.05406014621257782, decouple_loss:0.03834269195795059
loss_pred:0.0507393553853035, decouple_loss:0.0396249033510685
The modified gen p mean: 0.44378629326820374, gen p mean: 0.0, mean p set: 0.4503425657749176
loss_pred:0.05072285979986191, decouple_loss:0.03855666145682335
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45348766446113586, gen p mean: 0.0, mean p set: 0.4498342275619507The modified gen p mean: 0.45901885628700256, gen p mean: 0.0, mean p set: 0.44973650574684143
loss_pred:0.05085267126560211, decouple_loss:0.03913206234574318
loss_pred:0.053275179117918015, decouple_loss:0.03963058441877365
The modified gen p mean: 0.4544520378112793, gen p mean: 0.0, mean p set: 0.4486955404281616
loss_pred:0.05274283140897751, decouple_loss:0.04015686362981796
2023-05-05 15:37:44 testing...
The modified gen p mean: 0.4587729275226593, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.0554276742041111, decouple_loss:0.04003974422812462
The modified gen p mean: 0.4591049551963806, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4587149918079376, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.054491207003593445, decouple_loss:0.04226130619645119
loss_pred:0.05534835532307625, decouple_loss:0.03983091562986374
WV_1_PC_0_EH_0_PS_40_6, loss: 0.05712461471557617, avg_mse: 0.056556154042482376
current test mse: 0.056556
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
NaN value num: 0
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4596590995788574, gen p mean: 0.0, mean p set: 0.4517611861228943
loss_pred:0.0581207349896431, decouple_loss:0.04816095530986786
The modified gen p mean: 0.46467798948287964, gen p mean: 0.0, mean p set: 0.4500918984413147
loss_pred:0.05779394879937172, decouple_loss:0.04647732153534889
The modified gen p mean: 0.46441975235939026, gen p mean: 0.0, mean p set: 0.4501960873603821
loss_pred:0.0588945597410202, decouple_loss:0.04380485787987709
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4622436463832855, gen p mean: 0.0, mean p set: 0.45144689083099365
loss_pred:0.056909892708063126, decouple_loss:0.04735589399933815
The modified gen p mean: 0.4638589024543762, gen p mean: 0.0, mean p set: 0.4512876868247986
loss_pred:0.05702551081776619, decouple_loss:0.04743083566427231
The modified gen p mean: 0.4630683362483978, gen p mean: 0.0, mean p set: 0.4512418508529663
loss_pred:0.05675715580582619, decouple_loss:0.048830512911081314
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4652230143547058, gen p mean: 0.0, mean p set: 0.4520154595375061
loss_pred:0.05886709690093994, decouple_loss:0.049195509403944016
The modified gen p mean: 0.45970267057418823, gen p mean: 0.0, mean p set: 0.45074760913848877
loss_pred:0.056812580674886703, decouple_loss:0.0466858334839344
The modified gen p mean: 0.45716774463653564, gen p mean: 0.0, mean p set: 0.4516952931880951
loss_pred:0.05749829113483429, decouple_loss:0.04747946187853813
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4583665132522583, gen p mean: 0.0, mean p set: 0.4522300362586975
loss_pred:0.05872976779937744, decouple_loss:0.048119910061359406
The modified gen p mean: 0.45691531896591187, gen p mean: 0.0, mean p set: 0.45258599519729614
loss_pred:0.0615849643945694, decouple_loss:0.04779098555445671
The modified gen p mean: 0.45247337222099304, gen p mean: 0.0, mean p set: 0.45086249709129333
loss_pred:0.05762426555156708, decouple_loss:0.04504253715276718
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493466019630432, gen p mean: 0.0, mean p set: 0.4512638449668884
loss_pred:0.056126080453395844, decouple_loss:0.047260582447052
The modified gen p mean: 0.4480160176753998, gen p mean: 0.0, mean p set: 0.4517151117324829
loss_pred:0.054149165749549866, decouple_loss:0.04633595794439316
The modified gen p mean: 0.44429218769073486, gen p mean: 0.0, mean p set: 0.4511202275753021
loss_pred:0.05762298032641411, decouple_loss:0.04502177983522415
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4569699168205261, gen p mean: 0.0, mean p set: 0.4502009153366089
loss_pred:0.05665065720677376, decouple_loss:0.047243520617485046
The modified gen p mean: 0.4525790512561798, gen p mean: 0.0, mean p set: 0.4512137174606323
loss_pred:0.057716138660907745, decouple_loss:0.04615166783332825
The modified gen p mean: 0.453168123960495, gen p mean: 0.0, mean p set: 0.45058155059814453
loss_pred:0.055247604846954346, decouple_loss:0.046994537115097046
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.460125207901001, gen p mean: 0.0, mean p set: 0.45143812894821167
loss_pred:0.056749600917100906, decouple_loss:0.0472237728536129
The modified gen p mean: 0.4604343771934509, gen p mean: 0.0, mean p set: 0.45133206248283386
loss_pred:0.056115612387657166, decouple_loss:0.04553760588169098
The modified gen p mean: 0.45356810092926025, gen p mean: 0.0, mean p set: 0.452357679605484
loss_pred:0.05348489060997963, decouple_loss:0.047002267092466354
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824445247650146, gen p mean: 0.0, mean p set: 0.4498090147972107
loss_pred:0.05573725327849388, decouple_loss:0.04527407884597778
The modified gen p mean: 0.43905946612358093, gen p mean: 0.0, mean p set: 0.4519709050655365
loss_pred:0.05650017783045769, decouple_loss:0.045890528708696365
The modified gen p mean: 0.44574880599975586, gen p mean: 0.0, mean p set: 0.45060768723487854
loss_pred:0.054953232407569885, decouple_loss:0.046184249222278595
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44517287611961365, gen p mean: 0.0, mean p set: 0.45130112767219543
loss_pred:0.0551333911716938, decouple_loss:0.044337786734104156
The modified gen p mean: 0.4386439323425293, gen p mean: 0.0, mean p set: 0.4524042010307312
The modified gen p mean: 0.4394804835319519, gen p mean: 0.0, mean p set: 0.45201170444488525
loss_pred:0.05410047620534897, decouple_loss:0.047177840024232864
loss_pred:0.05397568270564079, decouple_loss:0.045776043087244034
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44566985964775085, gen p mean: 0.0, mean p set: 0.45163068175315857
loss_pred:0.053347598761320114, decouple_loss:0.04535645991563797
The modified gen p mean: 0.4465551972389221, gen p mean: 0.0, mean p set: 0.45303085446357727
The modified gen p mean: 0.44473832845687866, gen p mean: 0.0, mean p set: 0.45030614733695984
loss_pred:0.05486765876412392, decouple_loss:0.044739414006471634
loss_pred:0.05571318417787552, decouple_loss:0.04490061476826668
2023-05-05 15:42:13 testing...
The modified gen p mean: 0.4506763517856598, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.05711520090699196, decouple_loss:0.04771256819367409
The modified gen p mean: 0.4499673545360565, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4508441388607025, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.0548531673848629, decouple_loss:0.048779215663671494
loss_pred:0.055662889033555984, decouple_loss:0.046971190720796585
WV_1_PC_0_EH_0_PS_40_6, loss: 0.058268141001462936, avg_mse: 0.05828465521335602
current test mse: 0.058285
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45440468192100525, gen p mean: 0.0, mean p set: 0.44992515444755554
loss_pred:0.053343575447797775, decouple_loss:0.04558618739247322
The modified gen p mean: 0.45375993847846985, gen p mean: 0.0, mean p set: 0.449899822473526
loss_pred:0.055493347346782684, decouple_loss:0.04511388763785362
The modified gen p mean: 0.4562514126300812, gen p mean: 0.0, mean p set: 0.45231279730796814
loss_pred:0.05797841027379036, decouple_loss:0.045024216175079346
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45676371455192566, gen p mean: 0.0, mean p set: 0.45189735293388367
The modified gen p mean: 0.45832037925720215, gen p mean: 0.0, mean p set: 0.4514442980289459
loss_pred:0.05730842053890228, decouple_loss:0.04563572257757187
loss_pred:0.05270354077219963, decouple_loss:0.04396223649382591
The modified gen p mean: 0.45782577991485596, gen p mean: 0.0, mean p set: 0.4522075653076172
loss_pred:0.05404374375939369, decouple_loss:0.04759596288204193
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4596921503543854, gen p mean: 0.0, mean p set: 0.4505466818809509
loss_pred:0.055865753442049026, decouple_loss:0.04398508742451668
The modified gen p mean: 0.4638511538505554, gen p mean: 0.0, mean p set: 0.4527982771396637
loss_pred:0.0593092106282711, decouple_loss:0.044482581317424774
The modified gen p mean: 0.46336257457733154, gen p mean: 0.0, mean p set: 0.4508068561553955
loss_pred:0.054624225944280624, decouple_loss:0.044498261064291
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4619004726409912, gen p mean: 0.0, mean p set: 0.45058050751686096
The modified gen p mean: 0.46270859241485596, gen p mean: 0.0, mean p set: 0.45178699493408203
loss_pred:0.05593815818428993, decouple_loss:0.04546455293893814
loss_pred:0.0556669682264328, decouple_loss:0.04427821934223175
The modified gen p mean: 0.45669466257095337, gen p mean: 0.0, mean p set: 0.4523555636405945
loss_pred:0.051876768469810486, decouple_loss:0.043174486607313156
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456670880317688, gen p mean: 0.0, mean p set: 0.4524562954902649
The modified gen p mean: 0.4443085193634033, gen p mean: 0.0, mean p set: 0.45281848311424255
loss_pred:0.05316336080431938, decouple_loss:0.042914923280477524
loss_pred:0.05186085402965546, decouple_loss:0.04419016093015671
The modified gen p mean: 0.4448806643486023, gen p mean: 0.0, mean p set: 0.4510760009288788
loss_pred:0.05498012155294418, decouple_loss:0.04223328456282616
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4416446387767792, gen p mean: 0.0, mean p set: 0.45317062735557556
loss_pred:0.05483615770936012, decouple_loss:0.04214082285761833
The modified gen p mean: 0.4407900869846344, gen p mean: 0.0, mean p set: 0.45034801959991455
loss_pred:0.05481132119894028, decouple_loss:0.04312136396765709
The modified gen p mean: 0.44170913100242615, gen p mean: 0.0, mean p set: 0.45031243562698364
loss_pred:0.053629159927368164, decouple_loss:0.04203063249588013
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4566043019294739, gen p mean: 0.0, mean p set: 0.45132210850715637
loss_pred:0.05619032680988312, decouple_loss:0.042471688240766525
The modified gen p mean: 0.4543086886405945, gen p mean: 0.0, mean p set: 0.4512922167778015
loss_pred:0.05496223270893097, decouple_loss:0.043694570660591125
The modified gen p mean: 0.4570571482181549, gen p mean: 0.0, mean p set: 0.45257672667503357
loss_pred:0.05181344971060753, decouple_loss:0.0427045114338398
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4580388367176056, gen p mean: 0.0, mean p set: 0.4502132534980774
loss_pred:0.053660206496715546, decouple_loss:0.04180143028497696
The modified gen p mean: 0.45489469170570374, gen p mean: 0.0, mean p set: 0.4508419334888458
The modified gen p mean: 0.4610216021537781, gen p mean: 0.0, mean p set: 0.4519175887107849
loss_pred:0.05318460240960121, decouple_loss:0.04137922823429108
loss_pred:0.05544022470712662, decouple_loss:0.04253453016281128
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502544105052948, gen p mean: 0.0, mean p set: 0.44991254806518555
loss_pred:0.05474398657679558, decouple_loss:0.04152260720729828
The modified gen p mean: 0.45115897059440613, gen p mean: 0.0, mean p set: 0.450173020362854
loss_pred:0.05583248287439346, decouple_loss:0.04181426018476486
The modified gen p mean: 0.4472760856151581, gen p mean: 0.0, mean p set: 0.451321005821228
loss_pred:0.0520600825548172, decouple_loss:0.042985301464796066
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516359269618988, gen p mean: 0.0, mean p set: 0.45131561160087585
loss_pred:0.05347394570708275, decouple_loss:0.04254953935742378
The modified gen p mean: 0.4559052586555481, gen p mean: 0.0, mean p set: 0.45013299584388733
loss_pred:0.05313840135931969, decouple_loss:0.04158991202712059
The modified gen p mean: 0.45564791560173035, gen p mean: 0.0, mean p set: 0.45052459836006165
loss_pred:0.05319032818078995, decouple_loss:0.04071606695652008
2023-05-05 15:45:58 testing...
The modified gen p mean: 0.45074695348739624, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.0564136728644371, decouple_loss:0.044437259435653687
The modified gen p mean: 0.4509095847606659, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4515880346298218, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05467525124549866, decouple_loss:0.04522361978888512
loss_pred:0.055767036974430084, decouple_loss:0.044255465269088745
WV_1_PC_0_EH_0_PS_40_6, loss: 0.05785059556365013, avg_mse: 0.05850224196910858
current test mse: 0.058502
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
NaN value num: 0
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44379767775535583, gen p mean: 0.0, mean p set: 0.4496089518070221
loss_pred:0.05795278772711754, decouple_loss:0.045044537633657455
The modified gen p mean: 0.4527624547481537, gen p mean: 0.0, mean p set: 0.4513741731643677
loss_pred:0.055314600467681885, decouple_loss:0.04415234550833702
The modified gen p mean: 0.4518251121044159, gen p mean: 0.0, mean p set: 0.4495096802711487
loss_pred:0.054443951696157455, decouple_loss:0.04527273029088974
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4414258301258087, gen p mean: 0.0, mean p set: 0.4489399194717407
loss_pred:0.052295126020908356, decouple_loss:0.04470502957701683
The modified gen p mean: 0.44221410155296326, gen p mean: 0.0, mean p set: 0.4515989124774933
The modified gen p mean: 0.4412743151187897, gen p mean: 0.0, mean p set: 0.44892165064811707
loss_pred:0.05403422936797142, decouple_loss:0.04767458513379097
loss_pred:0.05628430098295212, decouple_loss:0.04746325686573982
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44492509961128235, gen p mean: 0.0, mean p set: 0.4496786296367645
loss_pred:0.05465725436806679, decouple_loss:0.04637313261628151
The modified gen p mean: 0.4453743100166321, gen p mean: 0.0, mean p set: 0.45026499032974243
loss_pred:0.052663885056972504, decouple_loss:0.047224096953868866
The modified gen p mean: 0.4461996555328369, gen p mean: 0.0, mean p set: 0.45148617029190063
loss_pred:0.0565110445022583, decouple_loss:0.04720177501440048
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452950656414032, gen p mean: 0.0, mean p set: 0.45097923278808594
loss_pred:0.053469035774469376, decouple_loss:0.04623205214738846
The modified gen p mean: 0.4561046063899994, gen p mean: 0.0, mean p set: 0.45127683877944946
loss_pred:0.052690282464027405, decouple_loss:0.04483608901500702
The modified gen p mean: 0.4546799659729004, gen p mean: 0.0, mean p set: 0.45005717873573303
loss_pred:0.05655059963464737, decouple_loss:0.04619719833135605
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44035935401916504, gen p mean: 0.0, mean p set: 0.4533670246601105
loss_pred:0.05608777329325676, decouple_loss:0.04556868225336075
The modified gen p mean: 0.44019168615341187, gen p mean: 0.0, mean p set: 0.4517059326171875
loss_pred:0.05776616558432579, decouple_loss:0.04753560572862625
The modified gen p mean: 0.44277262687683105, gen p mean: 0.0, mean p set: 0.4487481415271759
loss_pred:0.052695248275995255, decouple_loss:0.04550569877028465
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464742839336395, gen p mean: 0.0, mean p set: 0.45373791456222534
loss_pred:0.05667303875088692, decouple_loss:0.04574257880449295
The modified gen p mean: 0.45006856322288513, gen p mean: 0.0, mean p set: 0.45194050669670105
loss_pred:0.05447212979197502, decouple_loss:0.046300631016492844
The modified gen p mean: 0.44374874234199524, gen p mean: 0.0, mean p set: 0.44914600253105164
loss_pred:0.05484391003847122, decouple_loss:0.04618404060602188
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454852432012558, gen p mean: 0.0, mean p set: 0.45097601413726807
loss_pred:0.0570310615003109, decouple_loss:0.04572390764951706
The modified gen p mean: 0.45555782318115234, gen p mean: 0.0, mean p set: 0.45330584049224854
loss_pred:0.055949434638023376, decouple_loss:0.046572886407375336
The modified gen p mean: 0.45590731501579285, gen p mean: 0.0, mean p set: 0.4493706524372101
loss_pred:0.0519765205681324, decouple_loss:0.044305142015218735
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4566877484321594, gen p mean: 0.0, mean p set: 0.4494609236717224
loss_pred:0.05705658718943596, decouple_loss:0.046017345041036606
The modified gen p mean: 0.4499835968017578, gen p mean: 0.0, mean p set: 0.45222410559654236
loss_pred:0.05448940396308899, decouple_loss:0.04507990926504135
The modified gen p mean: 0.45203039050102234, gen p mean: 0.0, mean p set: 0.4495759904384613
loss_pred:0.05545010417699814, decouple_loss:0.04418407380580902
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4380401372909546, gen p mean: 0.0, mean p set: 0.450965940952301
The modified gen p mean: 0.4348676800727844, gen p mean: 0.0, mean p set: 0.45067140460014343
loss_pred:0.05588395148515701, decouple_loss:0.045000188052654266
loss_pred:0.05630539730191231, decouple_loss:0.04428303241729736
The modified gen p mean: 0.44314512610435486, gen p mean: 0.0, mean p set: 0.4495715796947479
loss_pred:0.05564923584461212, decouple_loss:0.04495074227452278
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457375109195709, gen p mean: 0.0, mean p set: 0.45220720767974854
loss_pred:0.053342849016189575, decouple_loss:0.04543042927980423
The modified gen p mean: 0.43795937299728394, gen p mean: 0.0, mean p set: 0.45042943954467773
loss_pred:0.05368020012974739, decouple_loss:0.04490489140152931
The modified gen p mean: 0.4400305449962616, gen p mean: 0.0, mean p set: 0.4529705345630646
loss_pred:0.054420355707407, decouple_loss:0.04456798732280731
2023-05-05 15:50:23 testing...
The modified gen p mean: 0.45642152428627014, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05535989627242088, decouple_loss:0.04602493718266487
The modified gen p mean: 0.45650714635849, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.054619159549474716, decouple_loss:0.04720257222652435
The modified gen p mean: 0.45441484451293945, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.057210806757211685, decouple_loss:0.04595348611474037
WV_1_PC_0_EH_0_PS_40_6, loss: 0.05804964154958725, avg_mse: 0.05851448327302933
current test mse: 0.058514
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515245854854584, gen p mean: 0.0, mean p set: 0.45030519366264343
loss_pred:0.05321815609931946, decouple_loss:0.046837665140628815
The modified gen p mean: 0.4541817009449005, gen p mean: 0.0, mean p set: 0.45004913210868835
loss_pred:0.053055208176374435, decouple_loss:0.04451344162225723
The modified gen p mean: 0.4506050646305084, gen p mean: 0.0, mean p set: 0.44880592823028564
loss_pred:0.05263911560177803, decouple_loss:0.04580910503864288
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4435497224330902, gen p mean: 0.0, mean p set: 0.4497406780719757
loss_pred:0.05188737437129021, decouple_loss:0.04565467685461044
The modified gen p mean: 0.45066970586776733, gen p mean: 0.0, mean p set: 0.4501922130584717
loss_pred:0.054036062210798264, decouple_loss:0.044404126703739166
The modified gen p mean: 0.4458519518375397, gen p mean: 0.0, mean p set: 0.4503369629383087
loss_pred:0.05491569638252258, decouple_loss:0.04424091801047325
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457905888557434, gen p mean: 0.0, mean p set: 0.4490891993045807
The modified gen p mean: 0.4448164701461792, gen p mean: 0.0, mean p set: 0.45149263739585876
loss_pred:0.05351753905415535, decouple_loss:0.04520178586244583
loss_pred:0.052853379398584366, decouple_loss:0.04380372166633606
The modified gen p mean: 0.452776163816452, gen p mean: 0.0, mean p set: 0.45147207379341125
loss_pred:0.05442408099770546, decouple_loss:0.0460817888379097
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45810624957084656, gen p mean: 0.0, mean p set: 0.4507175385951996
loss_pred:0.05295317620038986, decouple_loss:0.04531845450401306
The modified gen p mean: 0.45499491691589355, gen p mean: 0.0, mean p set: 0.45106494426727295
loss_pred:0.05500895902514458, decouple_loss:0.044890329241752625
The modified gen p mean: 0.4579952657222748, gen p mean: 0.0, mean p set: 0.44999220967292786
loss_pred:0.05330614373087883, decouple_loss:0.04417896270751953
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499323070049286, gen p mean: 0.0, mean p set: 0.4489029347896576
The modified gen p mean: 0.4541100859642029, gen p mean: 0.0, mean p set: 0.45162320137023926
loss_pred:0.05068628117442131, decouple_loss:0.04297979548573494
loss_pred:0.054380204528570175, decouple_loss:0.04471807926893234
The modified gen p mean: 0.4541722536087036, gen p mean: 0.0, mean p set: 0.4524822235107422
loss_pred:0.05290444940328598, decouple_loss:0.04483605921268463
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455261826515198, gen p mean: 0.0, mean p set: 0.4497845768928528
loss_pred:0.054226551204919815, decouple_loss:0.04405006021261215
The modified gen p mean: 0.44513222575187683, gen p mean: 0.0, mean p set: 0.4496016502380371
The modified gen p mean: 0.44732335209846497, gen p mean: 0.0, mean p set: 0.4497094452381134
loss_pred:0.053408052772283554, decouple_loss:0.043273892253637314
loss_pred:0.052232611924409866, decouple_loss:0.042928364127874374
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44340837001800537, gen p mean: 0.0, mean p set: 0.44929495453834534
loss_pred:0.049851614981889725, decouple_loss:0.04263985529541969
The modified gen p mean: 0.44592970609664917, gen p mean: 0.0, mean p set: 0.4507306218147278
loss_pred:0.05315181985497475, decouple_loss:0.04427710920572281
The modified gen p mean: 0.44380173087120056, gen p mean: 0.0, mean p set: 0.44938743114471436
loss_pred:0.05030250549316406, decouple_loss:0.043437179177999496
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520317018032074, gen p mean: 0.0, mean p set: 0.44961294531822205
loss_pred:0.054494451731443405, decouple_loss:0.04302643612027168
The modified gen p mean: 0.4524597227573395, gen p mean: 0.0, mean p set: 0.4491318166255951
loss_pred:0.05023963376879692, decouple_loss:0.04277396947145462
The modified gen p mean: 0.45441293716430664, gen p mean: 0.0, mean p set: 0.4500787556171417
loss_pred:0.05176972225308418, decouple_loss:0.04423246532678604
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4429429769515991, gen p mean: 0.0, mean p set: 0.4502660930156708
loss_pred:0.0550081767141819, decouple_loss:0.04244670271873474
The modified gen p mean: 0.44287025928497314, gen p mean: 0.0, mean p set: 0.450222373008728
loss_pred:0.0515456348657608, decouple_loss:0.04341355338692665
The modified gen p mean: 0.45281028747558594, gen p mean: 0.0, mean p set: 0.4515543580055237
loss_pred:0.05435425415635109, decouple_loss:0.0458926260471344
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4374001920223236, gen p mean: 0.0, mean p set: 0.45125457644462585
loss_pred:0.052956193685531616, decouple_loss:0.043939460068941116
The modified gen p mean: 0.4344921410083771, gen p mean: 0.0, mean p set: 0.45101216435432434
loss_pred:0.05079019069671631, decouple_loss:0.04421466216444969
The modified gen p mean: 0.4419446587562561, gen p mean: 0.0, mean p set: 0.4505888819694519
loss_pred:0.05402181297540665, decouple_loss:0.04374344274401665
2023-05-05 15:54:07 testing...
The modified gen p mean: 0.46798235177993774, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.05647333711385727, decouple_loss:0.045557256788015366
The modified gen p mean: 0.4706343710422516, gen p mean: 0.0, mean p set: 0.4500633478164673
The modified gen p mean: 0.47087544202804565, gen p mean: 0.0, mean p set: 0.45035696029663086
loss_pred:0.053459763526916504, decouple_loss:0.045540522783994675
loss_pred:0.055010177195072174, decouple_loss:0.04489574581384659
WV_1_PC_0_EH_0_PS_40_6, loss: 0.057247649878263474, avg_mse: 0.057551637291908264
current test mse: 0.057552
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
NaN value num: 0
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.47142457962036133, gen p mean: 0.0, mean p set: 0.45073869824409485
loss_pred:0.05431026220321655, decouple_loss:0.047330621629953384
The modified gen p mean: 0.4626956582069397, gen p mean: 0.0, mean p set: 0.45203545689582825
loss_pred:0.0526750348508358, decouple_loss:0.04581550881266594
The modified gen p mean: 0.46766623854637146, gen p mean: 0.0, mean p set: 0.45248281955718994
loss_pred:0.05561009421944618, decouple_loss:0.04660008102655411
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45383381843566895, gen p mean: 0.0, mean p set: 0.4518350064754486
loss_pred:0.051671385765075684, decouple_loss:0.04382147639989853
The modified gen p mean: 0.4532300531864166, gen p mean: 0.0, mean p set: 0.4528692364692688
The modified gen p mean: 0.4627196788787842, gen p mean: 0.0, mean p set: 0.4523428976535797
loss_pred:0.05097438022494316, decouple_loss:0.04564367234706879
loss_pred:0.05300360545516014, decouple_loss:0.04535432904958725
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475061297416687, gen p mean: 0.0, mean p set: 0.4538889527320862
loss_pred:0.05200642719864845, decouple_loss:0.04415077716112137
The modified gen p mean: 0.44988927245140076, gen p mean: 0.0, mean p set: 0.45330876111984253
loss_pred:0.05118205398321152, decouple_loss:0.04465751349925995
The modified gen p mean: 0.4399245083332062, gen p mean: 0.0, mean p set: 0.45288369059562683
loss_pred:0.051199592649936676, decouple_loss:0.04549678415060043
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467995762825012, gen p mean: 0.0, mean p set: 0.45217597484588623
loss_pred:0.05064528435468674, decouple_loss:0.04524650797247887
The modified gen p mean: 0.443093478679657, gen p mean: 0.0, mean p set: 0.45283377170562744
loss_pred:0.05066027119755745, decouple_loss:0.04400424286723137
The modified gen p mean: 0.44923004508018494, gen p mean: 0.0, mean p set: 0.45403948426246643
loss_pred:0.049794916063547134, decouple_loss:0.04527714475989342
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.47070610523223877, gen p mean: 0.0, mean p set: 0.45145612955093384
loss_pred:0.05470823124051094, decouple_loss:0.04644434526562691
The modified gen p mean: 0.46040216088294983, gen p mean: 0.0, mean p set: 0.4521334171295166
loss_pred:0.05140029639005661, decouple_loss:0.04403858259320259
The modified gen p mean: 0.46775054931640625, gen p mean: 0.0, mean p set: 0.4529838562011719
loss_pred:0.05394674837589264, decouple_loss:0.04701642692089081
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45471641421318054, gen p mean: 0.0, mean p set: 0.4530635178089142
loss_pred:0.05009879916906357, decouple_loss:0.04443329572677612
The modified gen p mean: 0.45509523153305054, gen p mean: 0.0, mean p set: 0.45463061332702637
loss_pred:0.05036488547921181, decouple_loss:0.044909849762916565
The modified gen p mean: 0.45289719104766846, gen p mean: 0.0, mean p set: 0.45204824209213257
loss_pred:0.05307014286518097, decouple_loss:0.045279938727617264
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4444843828678131, gen p mean: 0.0, mean p set: 0.45232388377189636
loss_pred:0.048956576734781265, decouple_loss:0.04456101730465889
The modified gen p mean: 0.44468972086906433, gen p mean: 0.0, mean p set: 0.45402759313583374
loss_pred:0.053604088723659515, decouple_loss:0.044760968536138535
The modified gen p mean: 0.4393680691719055, gen p mean: 0.0, mean p set: 0.45229360461235046
loss_pred:0.0483405776321888, decouple_loss:0.04486297070980072
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534253180027008, gen p mean: 0.0, mean p set: 0.45439544320106506
loss_pred:0.05104054510593414, decouple_loss:0.04460636153817177
The modified gen p mean: 0.4557550251483917, gen p mean: 0.0, mean p set: 0.45404139161109924
loss_pred:0.05214414745569229, decouple_loss:0.044826097786426544
The modified gen p mean: 0.45251208543777466, gen p mean: 0.0, mean p set: 0.4525543749332428
loss_pred:0.04978448525071144, decouple_loss:0.042342085391283035
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4441823959350586, gen p mean: 0.0, mean p set: 0.45264187455177307
loss_pred:0.04985347017645836, decouple_loss:0.043860919773578644
The modified gen p mean: 0.44684821367263794, gen p mean: 0.0, mean p set: 0.45167189836502075
loss_pred:0.05083604156970978, decouple_loss:0.04355640709400177
The modified gen p mean: 0.4388769865036011, gen p mean: 0.0, mean p set: 0.4520726501941681
loss_pred:0.052851203829050064, decouple_loss:0.04484438896179199
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464845359325409, gen p mean: 0.0, mean p set: 0.45234808325767517
The modified gen p mean: 0.4410093426704407, gen p mean: 0.0, mean p set: 0.4523581564426422
loss_pred:0.052829813212156296, decouple_loss:0.04326312243938446
loss_pred:0.0529865063726902, decouple_loss:0.04653918743133545
The modified gen p mean: 0.4448121190071106, gen p mean: 0.0, mean p set: 0.4520886242389679
loss_pred:0.0532117523252964, decouple_loss:0.044369883835315704
2023-05-05 15:58:31 testing...
The modified gen p mean: 0.4718346893787384, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.055655792355537415, decouple_loss:0.04740406572818756
The modified gen p mean: 0.47875088453292847, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.475767582654953, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05380293354392052, decouple_loss:0.04792442545294762
loss_pred:0.05442536622285843, decouple_loss:0.04693353921175003
WV_1_PC_0_EH_0_PS_40_6, loss: 0.05699906498193741, avg_mse: 0.057822052389383316
current test mse: 0.057822
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4685876965522766, gen p mean: 0.0, mean p set: 0.45280906558036804
loss_pred:0.04992152005434036, decouple_loss:0.0430428571999073
The modified gen p mean: 0.4732998013496399, gen p mean: 0.0, mean p set: 0.4522865414619446
loss_pred:0.04770375043153763, decouple_loss:0.04273097589612007
The modified gen p mean: 0.47093528509140015, gen p mean: 0.0, mean p set: 0.45178544521331787
loss_pred:0.04895983263850212, decouple_loss:0.043317366391420364
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45937830209732056, gen p mean: 0.0, mean p set: 0.4518720209598541
loss_pred:0.05165205895900726, decouple_loss:0.04283425211906433
The modified gen p mean: 0.4610673189163208, gen p mean: 0.0, mean p set: 0.4534013867378235
loss_pred:0.05104867368936539, decouple_loss:0.04488762095570564
The modified gen p mean: 0.45857512950897217, gen p mean: 0.0, mean p set: 0.45085132122039795
loss_pred:0.05285751447081566, decouple_loss:0.04368671029806137
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44066867232322693, gen p mean: 0.0, mean p set: 0.4522179961204529
loss_pred:0.05129289999604225, decouple_loss:0.04203356057405472
The modified gen p mean: 0.44065287709236145, gen p mean: 0.0, mean p set: 0.45403069257736206
loss_pred:0.05196226015686989, decouple_loss:0.04453281685709953
The modified gen p mean: 0.44075796008110046, gen p mean: 0.0, mean p set: 0.4522091746330261
loss_pred:0.05308067053556442, decouple_loss:0.042571499943733215
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451636075973511, gen p mean: 0.0, mean p set: 0.4515085816383362
loss_pred:0.05279509350657463, decouple_loss:0.04385898634791374
The modified gen p mean: 0.4411083459854126, gen p mean: 0.0, mean p set: 0.452871710062027
loss_pred:0.049797073006629944, decouple_loss:0.04175272583961487
The modified gen p mean: 0.4401683807373047, gen p mean: 0.0, mean p set: 0.45275866985321045
loss_pred:0.052929725497961044, decouple_loss:0.04392029717564583
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4572441577911377, gen p mean: 0.0, mean p set: 0.45435523986816406
loss_pred:0.05012000352144241, decouple_loss:0.041853733360767365
The modified gen p mean: 0.4588005840778351, gen p mean: 0.0, mean p set: 0.45017948746681213
loss_pred:0.050131652504205704, decouple_loss:0.042071785777807236
The modified gen p mean: 0.46059784293174744, gen p mean: 0.0, mean p set: 0.4523204565048218
loss_pred:0.04750619828701019, decouple_loss:0.04197315871715546
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4708598554134369, gen p mean: 0.0, mean p set: 0.45185646414756775
loss_pred:0.05113524943590164, decouple_loss:0.041422825306653976
The modified gen p mean: 0.4619824290275574, gen p mean: 0.0, mean p set: 0.4536357522010803
loss_pred:0.04833080992102623, decouple_loss:0.04151390120387077
The modified gen p mean: 0.460459440946579, gen p mean: 0.0, mean p set: 0.4530721604824066
loss_pred:0.052224110811948776, decouple_loss:0.04368878901004791
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45790690183639526, gen p mean: 0.0, mean p set: 0.4519991874694824
loss_pred:0.04744253307580948, decouple_loss:0.04364248737692833
The modified gen p mean: 0.45223718881607056, gen p mean: 0.0, mean p set: 0.4515518248081207
loss_pred:0.048253875225782394, decouple_loss:0.043583374470472336
The modified gen p mean: 0.4551173150539398, gen p mean: 0.0, mean p set: 0.4514249265193939
loss_pred:0.04851679131388664, decouple_loss:0.043952204287052155
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4402250051498413, gen p mean: 0.0, mean p set: 0.45176082849502563
loss_pred:0.051331471651792526, decouple_loss:0.043629541993141174
The modified gen p mean: 0.4381990432739258, gen p mean: 0.0, mean p set: 0.45252567529678345
loss_pred:0.04821275919675827, decouple_loss:0.04236197471618652
The modified gen p mean: 0.43813470005989075, gen p mean: 0.0, mean p set: 0.45135995745658875
loss_pred:0.050403714179992676, decouple_loss:0.04264162480831146
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4647616446018219, gen p mean: 0.0, mean p set: 0.4528285562992096
loss_pred:0.05101059749722481, decouple_loss:0.04325046017765999
The modified gen p mean: 0.4609557092189789, gen p mean: 0.0, mean p set: 0.45207729935646057
loss_pred:0.051605474203825, decouple_loss:0.04239531606435776
The modified gen p mean: 0.465893030166626, gen p mean: 0.0, mean p set: 0.4529213011264801
loss_pred:0.050813354551792145, decouple_loss:0.042052462697029114
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4631621241569519, gen p mean: 0.0, mean p set: 0.4508443772792816
loss_pred:0.05129125714302063, decouple_loss:0.04355044290423393
The modified gen p mean: 0.46683406829833984, gen p mean: 0.0, mean p set: 0.4503445625305176
loss_pred:0.05560221150517464, decouple_loss:0.044359464198350906
The modified gen p mean: 0.4604179859161377, gen p mean: 0.0, mean p set: 0.45046308636665344
loss_pred:0.04944610968232155, decouple_loss:0.04238548502326012
2023-05-05 16:03:00 testing...
The modified gen p mean: 0.44659948348999023, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4418157935142517, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.053403619676828384, decouple_loss:0.04848352447152138
loss_pred:0.05566904693841934, decouple_loss:0.04794487729668617
The modified gen p mean: 0.4441715478897095, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.053451698273420334, decouple_loss:0.047178883105516434
WV_1_PC_0_EH_0_PS_40_6, loss: 0.056568246334791183, avg_mse: 0.05753914639353752
current test mse: 0.057539
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43505915999412537, gen p mean: 0.0, mean p set: 0.45040175318717957
loss_pred:0.04929163679480553, decouple_loss:0.04344302415847778
The modified gen p mean: 0.4440534710884094, gen p mean: 0.0, mean p set: 0.44908758997917175
loss_pred:0.05471913889050484, decouple_loss:0.046834833920001984
The modified gen p mean: 0.43561697006225586, gen p mean: 0.0, mean p set: 0.4512932300567627
loss_pred:0.049670539796352386, decouple_loss:0.044018812477588654
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43560677766799927, gen p mean: 0.0, mean p set: 0.4512398838996887
loss_pred:0.051303718239068985, decouple_loss:0.043244995176792145
The modified gen p mean: 0.44307708740234375, gen p mean: 0.0, mean p set: 0.45031872391700745
loss_pred:0.04805579036474228, decouple_loss:0.04209144413471222
The modified gen p mean: 0.4449956715106964, gen p mean: 0.0, mean p set: 0.4506286382675171
loss_pred:0.04784741625189781, decouple_loss:0.04201390594244003
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45450279116630554, gen p mean: 0.0, mean p set: 0.4498820900917053
loss_pred:0.05138861760497093, decouple_loss:0.04299014061689377
The modified gen p mean: 0.4555108845233917, gen p mean: 0.0, mean p set: 0.4500750005245209
loss_pred:0.05188492685556412, decouple_loss:0.04287439584732056
The modified gen p mean: 0.4477309286594391, gen p mean: 0.0, mean p set: 0.45067667961120605
loss_pred:0.049033619463443756, decouple_loss:0.042474448680877686
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44534000754356384, gen p mean: 0.0, mean p set: 0.4503578245639801
The modified gen p mean: 0.44965606927871704, gen p mean: 0.0, mean p set: 0.4513188898563385
loss_pred:0.05437566339969635, decouple_loss:0.04334576800465584
loss_pred:0.050520364195108414, decouple_loss:0.041197001934051514
The modified gen p mean: 0.4551922082901001, gen p mean: 0.0, mean p set: 0.44931429624557495
loss_pred:0.053212765604257584, decouple_loss:0.04212693125009537
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483000636100769, gen p mean: 0.0, mean p set: 0.4506531357765198
The modified gen p mean: 0.4481709897518158, gen p mean: 0.0, mean p set: 0.45045775175094604
loss_pred:0.04804133623838425, decouple_loss:0.040974926203489304
loss_pred:0.046618394553661346, decouple_loss:0.041371025145053864
The modified gen p mean: 0.4478311538696289, gen p mean: 0.0, mean p set: 0.451661616563797
loss_pred:0.05059438198804855, decouple_loss:0.04072926938533783
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46142277121543884, gen p mean: 0.0, mean p set: 0.4508165121078491
loss_pred:0.050968024879693985, decouple_loss:0.04143150523304939
The modified gen p mean: 0.4584558308124542, gen p mean: 0.0, mean p set: 0.45033547282218933
loss_pred:0.05225725844502449, decouple_loss:0.042159613221883774
The modified gen p mean: 0.45772165060043335, gen p mean: 0.0, mean p set: 0.45151427388191223
loss_pred:0.05139767378568649, decouple_loss:0.040631212294101715
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45661935210227966, gen p mean: 0.0, mean p set: 0.45005032420158386
loss_pred:0.045938413590192795, decouple_loss:0.04067223146557808
The modified gen p mean: 0.4582884609699249, gen p mean: 0.0, mean p set: 0.44909584522247314
loss_pred:0.04940330237150192, decouple_loss:0.04130151495337486
The modified gen p mean: 0.4578051269054413, gen p mean: 0.0, mean p set: 0.4506239891052246
loss_pred:0.04818819835782051, decouple_loss:0.04056237265467644
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4403609335422516, gen p mean: 0.0, mean p set: 0.4502848982810974
loss_pred:0.05186652019619942, decouple_loss:0.04197366535663605
The modified gen p mean: 0.44416841864585876, gen p mean: 0.0, mean p set: 0.44931018352508545
loss_pred:0.051251668483018875, decouple_loss:0.04290865734219551
The modified gen p mean: 0.43709132075309753, gen p mean: 0.0, mean p set: 0.45061951875686646
loss_pred:0.04725862294435501, decouple_loss:0.03877547010779381
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4412839412689209, gen p mean: 0.0, mean p set: 0.44983693957328796
loss_pred:0.05043867230415344, decouple_loss:0.04353860765695572
The modified gen p mean: 0.4324972927570343, gen p mean: 0.0, mean p set: 0.44937294721603394
The modified gen p mean: 0.4325941801071167, gen p mean: 0.0, mean p set: 0.45081597566604614
loss_pred:0.049419257789850235, decouple_loss:0.040438149124383926
loss_pred:0.04774317890405655, decouple_loss:0.03928425535559654
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44903814792633057, gen p mean: 0.0, mean p set: 0.45064401626586914
loss_pred:0.0475427471101284, decouple_loss:0.040298059582710266
The modified gen p mean: 0.4532254934310913, gen p mean: 0.0, mean p set: 0.4516618549823761
loss_pred:0.04934551566839218, decouple_loss:0.03951447829604149
The modified gen p mean: 0.45093801617622375, gen p mean: 0.0, mean p set: 0.4493492543697357
loss_pred:0.050465572625398636, decouple_loss:0.04076813533902168
2023-05-05 16:06:49 testing...
The modified gen p mean: 0.47956836223602295, gen p mean: 0.0, mean p set: 0.4502691626548767
loss_pred:0.0542387031018734, decouple_loss:0.044734954833984375
The modified gen p mean: 0.4840518832206726, gen p mean: 0.0, mean p set: 0.45035696029663086
The modified gen p mean: 0.4823525846004486, gen p mean: 0.0, mean p set: 0.4500633478164673
loss_pred:0.05238107219338417, decouple_loss:0.04366210475564003
loss_pred:0.05284610018134117, decouple_loss:0.043464455753564835
WV_1_PC_0_EH_0_PS_40_6, loss: 0.05535298213362694, avg_mse: 0.05646383762359619
current test mse: 0.056464
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.47681447863578796, gen p mean: 0.0, mean p set: 0.45053014159202576
loss_pred:0.04793182760477066, decouple_loss:0.03973451629281044
The modified gen p mean: 0.4817001223564148, gen p mean: 0.0, mean p set: 0.4499933123588562
loss_pred:0.04972241073846817, decouple_loss:0.04084979370236397
The modified gen p mean: 0.48181554675102234, gen p mean: 0.0, mean p set: 0.45175716280937195
loss_pred:0.048133622854948044, decouple_loss:0.04119180515408516
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4610370695590973, gen p mean: 0.0, mean p set: 0.45099109411239624
loss_pred:0.048250265419483185, decouple_loss:0.03909692540764809
The modified gen p mean: 0.46098077297210693, gen p mean: 0.0, mean p set: 0.45058220624923706
loss_pred:0.0505024679005146, decouple_loss:0.03968467190861702
The modified gen p mean: 0.4655621349811554, gen p mean: 0.0, mean p set: 0.4487698972225189
loss_pred:0.04761328175663948, decouple_loss:0.041127122938632965
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4403398334980011, gen p mean: 0.0, mean p set: 0.44870832562446594
loss_pred:0.051029641181230545, decouple_loss:0.04070311039686203
The modified gen p mean: 0.431370347738266, gen p mean: 0.0, mean p set: 0.44945380091667175
loss_pred:0.05000751465559006, decouple_loss:0.04120534285902977
The modified gen p mean: 0.42807137966156006, gen p mean: 0.0, mean p set: 0.4507039785385132
loss_pred:0.050693631172180176, decouple_loss:0.04054269939661026
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43554919958114624, gen p mean: 0.0, mean p set: 0.4512903094291687
loss_pred:0.050683774054050446, decouple_loss:0.04071399196982384
The modified gen p mean: 0.43568354845046997, gen p mean: 0.0, mean p set: 0.4514070451259613
loss_pred:0.0465838797390461, decouple_loss:0.04084819182753563
The modified gen p mean: 0.43092015385627747, gen p mean: 0.0, mean p set: 0.45079106092453003
loss_pred:0.047252971678972244, decouple_loss:0.039085861295461655
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4637397527694702, gen p mean: 0.0, mean p set: 0.44937488436698914
loss_pred:0.04936444014310837, decouple_loss:0.039752889424562454
The modified gen p mean: 0.4665827751159668, gen p mean: 0.0, mean p set: 0.44908347725868225
loss_pred:0.04929172620177269, decouple_loss:0.04129659757018089
The modified gen p mean: 0.46394965052604675, gen p mean: 0.0, mean p set: 0.4505939483642578
loss_pred:0.05032074451446533, decouple_loss:0.040053125470876694
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.46329694986343384, gen p mean: 0.0, mean p set: 0.449493408203125
loss_pred:0.05045436695218086, decouple_loss:0.038818538188934326
The modified gen p mean: 0.46333014965057373, gen p mean: 0.0, mean p set: 0.4507562518119812
loss_pred:0.049495816230773926, decouple_loss:0.039553459733724594
The modified gen p mean: 0.4590309262275696, gen p mean: 0.0, mean p set: 0.45104461908340454
loss_pred:0.049583300948143005, decouple_loss:0.03940286487340927
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45027318596839905, gen p mean: 0.0, mean p set: 0.4490005075931549
loss_pred:0.04832836985588074, decouple_loss:0.040147874504327774
The modified gen p mean: 0.44865143299102783, gen p mean: 0.0, mean p set: 0.45067429542541504
loss_pred:0.048001255840063095, decouple_loss:0.03835191950201988
The modified gen p mean: 0.44914674758911133, gen p mean: 0.0, mean p set: 0.4504653811454773
loss_pred:0.04600027576088905, decouple_loss:0.037628065794706345
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.43967896699905396, gen p mean: 0.0, mean p set: 0.4514269232749939
loss_pred:0.048217564821243286, decouple_loss:0.038208816200494766
The modified gen p mean: 0.43456384539604187, gen p mean: 0.0, mean p set: 0.44993993639945984
loss_pred:0.05153265595436096, decouple_loss:0.038667283952236176
The modified gen p mean: 0.4362635314464569, gen p mean: 0.0, mean p set: 0.4490794241428375
loss_pred:0.04858633130788803, decouple_loss:0.039934657514095306
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480023682117462, gen p mean: 0.0, mean p set: 0.4488380551338196
loss_pred:0.04735767841339111, decouple_loss:0.03933427482843399
The modified gen p mean: 0.4463614523410797, gen p mean: 0.0, mean p set: 0.4509795904159546
loss_pred:0.04852680489420891, decouple_loss:0.038994114845991135
The modified gen p mean: 0.4475685954093933, gen p mean: 0.0, mean p set: 0.4487225413322449
loss_pred:0.0475832037627697, decouple_loss:0.038890957832336426
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 350, in <module>
    train_wrapper(model)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 271, in train_wrapper
    ims = train_input_handle.get_batch()
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 133, in get_batch
    input_seq = self.input_batch()
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 128, in input_batch
    input_batch[i, :self.current_input_length, :, :, :] = data_slice
ValueError: could not broadcast input array from shape (56,3,720,1440) into shape (48,3,720,1440)
NaN value num: 0