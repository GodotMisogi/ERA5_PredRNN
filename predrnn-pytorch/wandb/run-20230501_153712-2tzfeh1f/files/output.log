load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 125
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990232586860657, gen p mean: -0.04198653623461723, mean p set: 0.45038262009620667
loss_pred:0.018143484368920326, decouple_loss:0.0033150101080536842
The modified gen p mean: 0.45186713337898254, gen p mean: -0.04393048956990242, mean p set: 0.45234742760658264
loss_pred:0.01753244735300541, decouple_loss:0.0031421128660440445
The modified gen p mean: 0.4486936330795288, gen p mean: -0.040640734136104584, mean p set: 0.4491738975048065
loss_pred:0.018704434856772423, decouple_loss:0.00337611953727901
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789403676986694, gen p mean: -0.025274423882365227, mean p set: 0.44837433099746704
The modified gen p mean: 0.44966378808021545, gen p mean: -0.02103506214916706, mean p set: 0.45014408230781555
loss_pred:0.025746356695890427, decouple_loss:0.0189657062292099
loss_pred:0.02571180649101734, decouple_loss:0.019193312153220177
The modified gen p mean: 0.4500284194946289, gen p mean: -0.0200286116451025, mean p set: 0.450508713722229
loss_pred:0.02458273246884346, decouple_loss:0.0192829929292202
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933462142944336, gen p mean: -0.03574836254119873, mean p set: 0.44981491565704346
The modified gen p mean: 0.4490245580673218, gen p mean: -0.009283909574151039, mean p set: 0.4495048522949219
The modified gen p mean: 0.4502730667591095, gen p mean: -0.010415369644761086, mean p set: 0.4507533609867096
loss_pred:0.020348485559225082, decouple_loss:0.01332777738571167
loss_pred:0.02204224094748497, decouple_loss:0.012929819524288177
loss_pred:0.021004825830459595, decouple_loss:0.013079400174319744
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497763216495514, gen p mean: -0.06175500527024269, mean p set: 0.4502566158771515
loss_pred:0.02935136668384075, decouple_loss:0.012620433233678341
The modified gen p mean: 0.44897106289863586, gen p mean: -0.06198141723871231, mean p set: 0.4494513273239136The modified gen p mean: 0.44963744282722473, gen p mean: -0.060982368886470795, mean p set: 0.45011773705482483
loss_pred:0.029547417536377907, decouple_loss:0.012430421076714993
loss_pred:0.029646197333931923, decouple_loss:0.012568840757012367
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518488347530365, gen p mean: -0.05991145223379135, mean p set: 0.4523291289806366
The modified gen p mean: 0.4476169943809509, gen p mean: -0.06271875649690628, mean p set: 0.44809725880622864
loss_pred:0.025464793667197227, decouple_loss:0.009919850155711174
loss_pred:0.025493567809462547, decouple_loss:0.009828906506299973The modified gen p mean: 0.452470064163208, gen p mean: -0.05923619866371155, mean p set: 0.4529503583908081
loss_pred:0.02624594047665596, decouple_loss:0.00996982678771019
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449812114238739, gen p mean: -0.06473755091428757, mean p set: 0.4502924084663391
The modified gen p mean: 0.44875484704971313, gen p mean: -0.06292131543159485, mean p set: 0.44923514127731323
loss_pred:0.02394477277994156, decouple_loss:0.005891850683838129
loss_pred:0.024835655465722084, decouple_loss:0.005978325381875038
The modified gen p mean: 0.448906809091568, gen p mean: -0.06273569166660309, mean p set: 0.4493871033191681
loss_pred:0.02361159771680832, decouple_loss:0.005879618227481842
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45023342967033386, gen p mean: -0.07508351653814316, mean p set: 0.45071372389793396
loss_pred:0.02406512387096882, decouple_loss:0.004110624082386494
The modified gen p mean: 0.4482707679271698, gen p mean: -0.07210874557495117, mean p set: 0.4487510621547699The modified gen p mean: 0.44969624280929565, gen p mean: -0.07492641359567642, mean p set: 0.45017653703689575
loss_pred:0.02491033636033535, decouple_loss:0.004130031913518906
loss_pred:0.024631483480334282, decouple_loss:0.004151998087763786
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900038838386536, gen p mean: -0.081389881670475, mean p set: 0.44948065280914307
The modified gen p mean: 0.4490131437778473, gen p mean: -0.08128564059734344, mean p set: 0.4494934380054474
loss_pred:0.022823845967650414, decouple_loss:0.005116921383887529
loss_pred:0.022352447733283043, decouple_loss:0.005021573044359684
The modified gen p mean: 0.4506986737251282, gen p mean: -0.07932404428720474, mean p set: 0.45117899775505066
loss_pred:0.022232661023736, decouple_loss:0.004899357445538044
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490300416946411, gen p mean: -0.09205381572246552, mean p set: 0.4495103359222412
The modified gen p mean: 0.45019155740737915, gen p mean: -0.09048710018396378, mean p set: 0.45067182183265686
loss_pred:0.02144765853881836, decouple_loss:0.0065040504559874535
loss_pred:0.020508412271738052, decouple_loss:0.006262841168791056
The modified gen p mean: 0.45149093866348267, gen p mean: -0.09066208451986313, mean p set: 0.45197123289108276
loss_pred:0.022323818877339363, decouple_loss:0.00635706027969718
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051509141921997, gen p mean: -0.09161531925201416, mean p set: 0.45099538564682007
The modified gen p mean: 0.4489809572696686, gen p mean: -0.09237752109766006, mean p set: 0.4494612514972687
loss_pred:0.019864996895194054, decouple_loss:0.00496803130954504
loss_pred:0.021084297448396683, decouple_loss:0.005271622911095619
The modified gen p mean: 0.4487544596195221, gen p mean: -0.088215671479702, mean p set: 0.4492347836494446
loss_pred:0.020183758810162544, decouple_loss:0.005184403154999018
2023-05-01 15:40:19 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.09525728970766068, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.08955774456262589, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.08789069205522537, mean p set: 0.45035696029663086
loss_pred:0.02135811373591423, decouple_loss:0.004834436345845461
loss_pred:0.020494775846600533, decouple_loss:0.004772162064909935
loss_pred:0.02032158337533474, decouple_loss:0.004723194520920515
WV_0_PC_1_EH_0_PS_40, loss: 0.020963653922080994, avg_mse: 0.028818296268582344
current test mse: 0.028818
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450116902589798, gen p mean: -0.08596134930849075, mean p set: 0.45059719681739807
loss_pred:0.01894550211727619, decouple_loss:0.0047503807581961155
The modified gen p mean: 0.44825175404548645, gen p mean: -0.08419157564640045, mean p set: 0.44873207807540894
The modified gen p mean: 0.44814273715019226, gen p mean: -0.08687829971313477, mean p set: 0.44862303137779236
loss_pred:0.01945427618920803, decouple_loss:0.004750519059598446
loss_pred:0.019784653559327126, decouple_loss:0.004823695402592421
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45175960659980774, gen p mean: -0.07699944078922272, mean p set: 0.45223987102508545
The modified gen p mean: 0.4506288170814514, gen p mean: -0.0803745687007904, mean p set: 0.4511091411113739
loss_pred:0.018604539334774017, decouple_loss:0.006306411698460579
loss_pred:0.019184106960892677, decouple_loss:0.006326420232653618
The modified gen p mean: 0.4493236839771271, gen p mean: -0.08010102063417435, mean p set: 0.4498039484024048
loss_pred:0.019332602620124817, decouple_loss:0.006152842193841934
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081618428230286, gen p mean: -0.06560101360082626, mean p set: 0.45129647850990295
The modified gen p mean: 0.4490867257118225, gen p mean: -0.07346852123737335, mean p set: 0.449567049741745
loss_pred:0.019327132031321526, decouple_loss:0.005660058930516243
loss_pred:0.02007344365119934, decouple_loss:0.005577272269874811
The modified gen p mean: 0.4494486451148987, gen p mean: -0.07678140699863434, mean p set: 0.4499289393424988
loss_pred:0.019418256357312202, decouple_loss:0.005391043610870838
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483394920825958, gen p mean: -0.06450455635786057, mean p set: 0.4488198161125183
The modified gen p mean: 0.4501833915710449, gen p mean: -0.06498861312866211, mean p set: 0.450663685798645
loss_pred:0.019807789474725723, decouple_loss:0.00410859938710928
loss_pred:0.01820605807006359, decouple_loss:0.004095931071788073
The modified gen p mean: 0.4523509442806244, gen p mean: -0.0658399909734726, mean p set: 0.4528312385082245
loss_pred:0.01813226193189621, decouple_loss:0.004301346372812986
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508685767650604, gen p mean: -0.05230240896344185, mean p set: 0.4513488709926605
The modified gen p mean: 0.449428915977478, gen p mean: -0.059431042522192, mean p set: 0.4499092102050781
loss_pred:0.01877858303487301, decouple_loss:0.00399217801168561
loss_pred:0.01795816794037819, decouple_loss:0.004050237126648426
The modified gen p mean: 0.4522462785243988, gen p mean: -0.059638842940330505, mean p set: 0.4527266025543213
loss_pred:0.019323406741023064, decouple_loss:0.0039926618337631226
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494033455848694, gen p mean: -0.05286407843232155, mean p set: 0.4498836100101471
The modified gen p mean: 0.44812560081481934, gen p mean: -0.06062845140695572, mean p set: 0.44860586524009705
loss_pred:0.019103506579995155, decouple_loss:0.004100960213690996
loss_pred:0.01907801255583763, decouple_loss:0.0042567444033920765
The modified gen p mean: 0.4484437108039856, gen p mean: -0.053821541368961334, mean p set: 0.4489240050315857
loss_pred:0.018369825556874275, decouple_loss:0.0040174624882638454
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495541751384735, gen p mean: -0.047320786863565445, mean p set: 0.4500344693660736
The modified gen p mean: 0.4487537443637848, gen p mean: -0.048098087310791016, mean p set: 0.4492340683937073
loss_pred:0.01895376481115818, decouple_loss:0.0035663791932165623
loss_pred:0.01900135912001133, decouple_loss:0.003514708951115608
The modified gen p mean: 0.44838157296180725, gen p mean: -0.04816880449652672, mean p set: 0.44886186718940735
loss_pred:0.0184330977499485, decouple_loss:0.003615227062255144
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509003162384033, gen p mean: -0.047527384012937546, mean p set: 0.4513806104660034
loss_pred:0.017767561599612236, decouple_loss:0.003764716675505042
The modified gen p mean: 0.4494656026363373, gen p mean: -0.04726194590330124, mean p set: 0.4499458968639374
The modified gen p mean: 0.45101815462112427, gen p mean: -0.0409846268594265, mean p set: 0.45149844884872437
loss_pred:0.017843931913375854, decouple_loss:0.0038016862235963345
loss_pred:0.018724719062447548, decouple_loss:0.003644537413492799
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484897255897522, gen p mean: -0.04695456847548485, mean p set: 0.4489700198173523
The modified gen p mean: 0.449733167886734, gen p mean: -0.0486171692609787, mean p set: 0.4502134323120117
loss_pred:0.017992941662669182, decouple_loss:0.0034172169398516417
loss_pred:0.017819847911596298, decouple_loss:0.0033453910145908594
The modified gen p mean: 0.4489746391773224, gen p mean: -0.04287511482834816, mean p set: 0.4494549334049225
loss_pred:0.018473191186785698, decouple_loss:0.003485157387331128
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490962624549866, gen p mean: -0.051037680357694626, mean p set: 0.4495765268802643
The modified gen p mean: 0.4513009190559387, gen p mean: -0.04455135762691498, mean p set: 0.4517812132835388
loss_pred:0.018317613750696182, decouple_loss:0.003063585376366973
loss_pred:0.01785917393863201, decouple_loss:0.002960626035928726
The modified gen p mean: 0.44906073808670044, gen p mean: -0.04788995161652565, mean p set: 0.44954103231430054
loss_pred:0.018173716962337494, decouple_loss:0.0029402405489236116
2023-05-01 15:42:14 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06098966673016548, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05603531002998352, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05513686686754227, mean p set: 0.45035696029663086
loss_pred:0.01964297518134117, decouple_loss:0.00297855818644166
loss_pred:0.018654366955161095, decouple_loss:0.00296475226059556
loss_pred:0.018514135852456093, decouple_loss:0.003033658256754279
WV_0_PC_1_EH_0_PS_40, loss: 0.019086776301264763, avg_mse: 0.026883509010076523
current test mse: 0.026884
At step 20, Best test: 0.026884
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487245976924896, gen p mean: -0.05695057660341263, mean p set: 0.4492048919200897
loss_pred:0.016684964299201965, decouple_loss:0.0029541433323174715
The modified gen p mean: 0.44821521639823914, gen p mean: -0.056591179221868515, mean p set: 0.4486955404281616The modified gen p mean: 0.44958531856536865, gen p mean: -0.05647703632712364, mean p set: 0.45006564259529114
loss_pred:0.01719653606414795, decouple_loss:0.003036638954654336
loss_pred:0.017157908529043198, decouple_loss:0.0029596774838864803
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498019814491272, gen p mean: -0.05973557382822037, mean p set: 0.4502823054790497
loss_pred:0.016779839992523193, decouple_loss:0.0029026949778199196
The modified gen p mean: 0.4501695930957794, gen p mean: -0.05886101350188255, mean p set: 0.4506498873233795The modified gen p mean: 0.4493243396282196, gen p mean: -0.05929342657327652, mean p set: 0.4498046338558197
loss_pred:0.017057839781045914, decouple_loss:0.0028263418935239315
loss_pred:0.017048759385943413, decouple_loss:0.002766689285635948
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068731904029846, gen p mean: -0.06036195531487465, mean p set: 0.45116761326789856
The modified gen p mean: 0.449334055185318, gen p mean: -0.061969660222530365, mean p set: 0.4498143792152405
loss_pred:0.01716497913002968, decouple_loss:0.00275897653773427
loss_pred:0.01676194742321968, decouple_loss:0.00267158099450171
The modified gen p mean: 0.44988805055618286, gen p mean: -0.05942060053348541, mean p set: 0.45036831498146057
loss_pred:0.01687539555132389, decouple_loss:0.0026430662255734205
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502818286418915, gen p mean: -0.05623219162225723, mean p set: 0.4507621228694916
loss_pred:0.016898563131690025, decouple_loss:0.0027146211359649897
The modified gen p mean: 0.4493504762649536, gen p mean: -0.0630633682012558, mean p set: 0.4498307406902313The modified gen p mean: 0.4496549367904663, gen p mean: -0.058491334319114685, mean p set: 0.450135201215744
loss_pred:0.01587621681392193, decouple_loss:0.002612135373055935
loss_pred:0.01634741947054863, decouple_loss:0.002613560762256384
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496612548828125, gen p mean: -0.06817331165075302, mean p set: 0.4501415491104126
The modified gen p mean: 0.4491085708141327, gen p mean: -0.05956285446882248, mean p set: 0.4495888352394104
The modified gen p mean: 0.4507904052734375, gen p mean: -0.06655995547771454, mean p set: 0.45127072930336loss_pred:0.016429033130407333, decouple_loss:0.002396326046437025
loss_pred:0.016345607116818428, decouple_loss:0.002298397244885564
loss_pred:0.016577059403061867, decouple_loss:0.0024660530034452677
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501456022262573, gen p mean: -0.061374977231025696, mean p set: 0.45062586665153503
The modified gen p mean: 0.4497753381729126, gen p mean: -0.06173991411924362, mean p set: 0.4502556622028351
loss_pred:0.01602713018655777, decouple_loss:0.0021950576920062304
loss_pred:0.016581909731030464, decouple_loss:0.0021215176675468683
The modified gen p mean: 0.45010730624198914, gen p mean: -0.06428434699773788, mean p set: 0.45058757066726685
loss_pred:0.01589388959109783, decouple_loss:0.00216054474003613
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505214989185333, gen p mean: -0.07249239087104797, mean p set: 0.4510018229484558
The modified gen p mean: 0.4487124979496002, gen p mean: -0.06686826795339584, mean p set: 0.4491928219795227
loss_pred:0.01715587079524994, decouple_loss:0.002065488835796714
loss_pred:0.01555075403302908, decouple_loss:0.002139144344255328
The modified gen p mean: 0.4487113654613495, gen p mean: -0.06292372196912766, mean p set: 0.4491916298866272
loss_pred:0.015990018844604492, decouple_loss:0.0021440477576106787
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861218333244324, gen p mean: -0.0594528429210186, mean p set: 0.4490925073623657
The modified gen p mean: 0.45025718212127686, gen p mean: -0.061946578323841095, mean p set: 0.45073747634887695
loss_pred:0.016153622418642044, decouple_loss:0.002142348326742649
loss_pred:0.016323218122124672, decouple_loss:0.002334139309823513
The modified gen p mean: 0.4503808617591858, gen p mean: -0.06020841374993324, mean p set: 0.4508611261844635
loss_pred:0.016299165785312653, decouple_loss:0.0022902097553014755
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508281350135803, gen p mean: -0.0652468279004097, mean p set: 0.4513084292411804
The modified gen p mean: 0.4504680335521698, gen p mean: -0.06157783418893814, mean p set: 0.4509483277797699
loss_pred:0.015594023279845715, decouple_loss:0.0022081632632762194
loss_pred:0.016427038237452507, decouple_loss:0.002243551192805171
The modified gen p mean: 0.44940319657325745, gen p mean: -0.05932139232754707, mean p set: 0.44988352060317993
loss_pred:0.015395318157970905, decouple_loss:0.0021749846637248993
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449248343706131, gen p mean: -0.056300632655620575, mean p set: 0.44972866773605347
The modified gen p mean: 0.45019662380218506, gen p mean: -0.05461650714278221, mean p set: 0.45067691802978516
loss_pred:0.015982775017619133, decouple_loss:0.0019467107485979795
loss_pred:0.016190633177757263, decouple_loss:0.002037384081631899
The modified gen p mean: 0.45008423924446106, gen p mean: -0.06331087648868561, mean p set: 0.45056453347206116
loss_pred:0.016334617510437965, decouple_loss:0.002006247639656067
2023-05-01 15:44:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.060567114502191544, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05653403326869011, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05527326092123985, mean p set: 0.45035696029663086
loss_pred:0.019231870770454407, decouple_loss:0.0019808264914900064
loss_pred:0.018112435936927795, decouple_loss:0.001947081065736711loss_pred:0.018111102283000946, decouple_loss:0.0020677587017416954
WV_0_PC_1_EH_0_PS_40, loss: 0.01858506351709366, avg_mse: 0.026539191603660583
current test mse: 0.026539
At step 30, Best test: 0.026539
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497264325618744, gen p mean: -0.05827653035521507, mean p set: 0.4502067267894745
loss_pred:0.015671001747250557, decouple_loss:0.002063712105154991
The modified gen p mean: 0.4489690959453583, gen p mean: -0.057525698095560074, mean p set: 0.44944941997528076The modified gen p mean: 0.4512348771095276, gen p mean: -0.054850708693265915, mean p set: 0.4517151713371277
loss_pred:0.015713414177298546, decouple_loss:0.0020005765836685896
loss_pred:0.015522916801273823, decouple_loss:0.0019441567128524184
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904807209968567, gen p mean: -0.054624997079372406, mean p set: 0.44952836632728577
loss_pred:0.015224901027977467, decouple_loss:0.0019640123937278986
The modified gen p mean: 0.4501516819000244, gen p mean: -0.051797982305288315, mean p set: 0.4506319463253021
The modified gen p mean: 0.4502379894256592, gen p mean: -0.05425916239619255, mean p set: 0.4507182538509369
loss_pred:0.015246285125613213, decouple_loss:0.0019425112986937165
loss_pred:0.015429561026394367, decouple_loss:0.0019611509051173925
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491356611251831, gen p mean: -0.05447664484381676, mean p set: 0.4496159553527832
loss_pred:0.015550490468740463, decouple_loss:0.0018479371210560203
The modified gen p mean: 0.4498622715473175, gen p mean: -0.054615940898656845, mean p set: 0.4503425657749176The modified gen p mean: 0.4507772922515869, gen p mean: -0.05212908983230591, mean p set: 0.4512575566768646
loss_pred:0.015152360312640667, decouple_loss:0.0018789834575727582
loss_pred:0.01528907660394907, decouple_loss:0.001781725324690342
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499345123767853, gen p mean: -0.04761232063174248, mean p set: 0.4504148066043854
loss_pred:0.015947552397847176, decouple_loss:0.001814028131775558
The modified gen p mean: 0.449557900428772, gen p mean: -0.0518217459321022, mean p set: 0.4500381648540497The modified gen p mean: 0.4506218135356903, gen p mean: -0.04960550367832184, mean p set: 0.451102077960968
loss_pred:0.01509737130254507, decouple_loss:0.0017250373493880033
loss_pred:0.014601659029722214, decouple_loss:0.0019044085638597608
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940629601478577, gen p mean: -0.0546196810901165, mean p set: 0.44988662004470825
loss_pred:0.014823738485574722, decouple_loss:0.0017044860869646072
The modified gen p mean: 0.44868531823158264, gen p mean: -0.0514775775372982, mean p set: 0.4491656422615051The modified gen p mean: 0.4494397044181824, gen p mean: -0.05125315114855766, mean p set: 0.4499199688434601
loss_pred:0.015432505868375301, decouple_loss:0.0016744578024372458
loss_pred:0.015303269028663635, decouple_loss:0.001790559501387179
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966641068458557, gen p mean: -0.052642401307821274, mean p set: 0.45014673471450806
The modified gen p mean: 0.4501035213470459, gen p mean: -0.06015334650874138, mean p set: 0.450583815574646
loss_pred:0.014885966666042805, decouple_loss:0.0017142069991678
loss_pred:0.01556891854852438, decouple_loss:0.0017163873417302966
The modified gen p mean: 0.45044729113578796, gen p mean: -0.04893718287348747, mean p set: 0.45092761516571045
loss_pred:0.014869878068566322, decouple_loss:0.0017046640859916806
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493539035320282, gen p mean: -0.05360917001962662, mean p set: 0.4498342275619507The modified gen p mean: 0.450135201215744, gen p mean: -0.06022118404507637, mean p set: 0.4506154954433441
loss_pred:0.015379011631011963, decouple_loss:0.0017207121709361672
loss_pred:0.015168252401053905, decouple_loss:0.0016736749093979597
The modified gen p mean: 0.4481290280818939, gen p mean: -0.053925082087516785, mean p set: 0.448609322309494
loss_pred:0.015446662902832031, decouple_loss:0.0016434341669082642
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492562413215637, gen p mean: -0.05622087046504021, mean p set: 0.44973650574684143
The modified gen p mean: 0.44990208745002747, gen p mean: -0.05592101439833641, mean p set: 0.45038241147994995loss_pred:0.015069225803017616, decouple_loss:0.0016033799620345235
The modified gen p mean: 0.4493504762649536, gen p mean: -0.052512649446725845, mean p set: 0.4498307704925537
loss_pred:0.015338263474404812, decouple_loss:0.0016012473497539759
loss_pred:0.015118463896214962, decouple_loss:0.001654168707318604
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507172703742981, gen p mean: -0.055209558457136154, mean p set: 0.4511975646018982
The modified gen p mean: 0.4489012062549591, gen p mean: -0.055560581386089325, mean p set: 0.4493815302848816
loss_pred:0.014653727412223816, decouple_loss:0.0016115139005705714
loss_pred:0.015498705208301544, decouple_loss:0.0015184985240921378
The modified gen p mean: 0.4503428041934967, gen p mean: -0.05959101766347885, mean p set: 0.4508230984210968
loss_pred:0.014928401447832584, decouple_loss:0.0015714284963905811
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947320222854614, gen p mean: -0.055128198117017746, mean p set: 0.44995349645614624
The modified gen p mean: 0.4505953788757324, gen p mean: -0.05536922812461853, mean p set: 0.4510757029056549
loss_pred:0.015551834367215633, decouple_loss:0.0019177270587533712
loss_pred:0.015617359429597855, decouple_loss:0.0016845072386786342
The modified gen p mean: 0.4492187201976776, gen p mean: -0.056870341300964355, mean p set: 0.4496990144252777
loss_pred:0.015839839354157448, decouple_loss:0.0016638742526993155
2023-05-01 15:46:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06283265352249146, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05878547579050064, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.057990558445453644, mean p set: 0.45035696029663086
loss_pred:0.019043559208512306, decouple_loss:0.0015206636162474751
loss_pred:0.017989346757531166, decouple_loss:0.0015165229560807347
loss_pred:0.017961012199521065, decouple_loss:0.001592784421518445
WV_0_PC_1_EH_0_PS_40, loss: 0.01840847358107567, avg_mse: 0.026447808369994164
current test mse: 0.026448
At step 40, Best test: 0.026448
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469147324562073, gen p mean: -0.05448401719331741, mean p set: 0.447394996881485
loss_pred:0.013562486506998539, decouple_loss:0.0015328068984672427
The modified gen p mean: 0.4500373601913452, gen p mean: -0.0512692928314209, mean p set: 0.4505176842212677The modified gen p mean: 0.4487262964248657, gen p mean: -0.059345975518226624, mean p set: 0.44920656085014343
loss_pred:0.013907461427152157, decouple_loss:0.0015644612722098827
loss_pred:0.013994247652590275, decouple_loss:0.001526474254205823
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44961124658584595, gen p mean: -0.06502595543861389, mean p set: 0.45009157061576843
The modified gen p mean: 0.4489430785179138, gen p mean: -0.06275150924921036, mean p set: 0.4494233727455139
loss_pred:0.013715575449168682, decouple_loss:0.0016737326513975859
loss_pred:0.014149818569421768, decouple_loss:0.001553929760120809
The modified gen p mean: 0.4475484788417816, gen p mean: -0.05753573402762413, mean p set: 0.4480287730693817
loss_pred:0.015067348256707191, decouple_loss:0.0014881643000990152
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836610555648804, gen p mean: -0.05912909284234047, mean p set: 0.44884639978408813
loss_pred:0.013758417218923569, decouple_loss:0.001454503508284688
The modified gen p mean: 0.4486962556838989, gen p mean: -0.056550268083810806, mean p set: 0.449176549911499The modified gen p mean: 0.4501930773258209, gen p mean: -0.0522395484149456, mean p set: 0.45067334175109863
loss_pred:0.014149829745292664, decouple_loss:0.001426019356586039
loss_pred:0.013877344317734241, decouple_loss:0.0014237634604796767
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474972188472748, gen p mean: -0.05794815719127655, mean p set: 0.4479774832725525
loss_pred:0.013621848076581955, decouple_loss:0.001493240357376635
The modified gen p mean: 0.4488906264305115, gen p mean: -0.06146784499287605, mean p set: 0.4493709206581116The modified gen p mean: 0.4471129775047302, gen p mean: -0.06526391208171844, mean p set: 0.4475933015346527
loss_pred:0.013964802958071232, decouple_loss:0.0014976997626945376
loss_pred:0.014158550649881363, decouple_loss:0.0017003255197778344
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839343428611755, gen p mean: -0.05715726688504219, mean p set: 0.44887375831604004
loss_pred:0.01448050793260336, decouple_loss:0.0014492871705442667
The modified gen p mean: 0.4490821361541748, gen p mean: -0.05592307448387146, mean p set: 0.4495624303817749The modified gen p mean: 0.44819745421409607, gen p mean: -0.061299487948417664, mean p set: 0.44867774844169617
loss_pred:0.013712020590901375, decouple_loss:0.001396011095494032
loss_pred:0.013831935822963715, decouple_loss:0.0015207638498395681
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811615347862244, gen p mean: -0.05759679153561592, mean p set: 0.44859644770622253
The modified gen p mean: 0.4472678005695343, gen p mean: -0.053796131163835526, mean p set: 0.447748064994812
loss_pred:0.013534199446439743, decouple_loss:0.0014162056613713503
loss_pred:0.01387652289122343, decouple_loss:0.0014874624321237206
The modified gen p mean: 0.4486274719238281, gen p mean: -0.05590594932436943, mean p set: 0.44910773634910583
loss_pred:0.01326676830649376, decouple_loss:0.0016166326822713017
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840124249458313, gen p mean: -0.05707241967320442, mean p set: 0.4488815367221832
loss_pred:0.014470845460891724, decouple_loss:0.001380676287226379
The modified gen p mean: 0.4497550427913666, gen p mean: -0.049745965749025345, mean p set: 0.4502353370189667The modified gen p mean: 0.4499562680721283, gen p mean: -0.04909622296690941, mean p set: 0.4504365622997284
loss_pred:0.013697709888219833, decouple_loss:0.001410901197232306
loss_pred:0.013406822457909584, decouple_loss:0.001374036306515336
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476976692676544, gen p mean: -0.05540924891829491, mean p set: 0.4481779932975769
loss_pred:0.014250645413994789, decouple_loss:0.0013270082417875528
The modified gen p mean: 0.44819360971450806, gen p mean: -0.06262000650167465, mean p set: 0.44867387413978577
The modified gen p mean: 0.4488057494163513, gen p mean: -0.052818357944488525, mean p set: 0.4492860734462738
loss_pred:0.013436391949653625, decouple_loss:0.0014197848504409194
loss_pred:0.01372904796153307, decouple_loss:0.0013592265313491225
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798243045806885, gen p mean: -0.057825036346912384, mean p set: 0.44846272468566895
loss_pred:0.012770128436386585, decouple_loss:0.0014869928127154708
The modified gen p mean: 0.44915971159935, gen p mean: -0.0602535717189312, mean p set: 0.4496400058269501The modified gen p mean: 0.4472696781158447, gen p mean: -0.0604277141392231, mean p set: 0.4477499723434448
loss_pred:0.014046432450413704, decouple_loss:0.0013872935669496655
loss_pred:0.013471214100718498, decouple_loss:0.0014188737841323018
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472569227218628, gen p mean: -0.05182112380862236, mean p set: 0.4477371871471405
The modified gen p mean: 0.44975852966308594, gen p mean: -0.058745406568050385, mean p set: 0.45023879408836365
loss_pred:0.013690920546650887, decouple_loss:0.0012641084613278508
loss_pred:0.01383847463876009, decouple_loss:0.0013308619381859899The modified gen p mean: 0.44841739535331726, gen p mean: -0.05407081916928291, mean p set: 0.44889771938323975
loss_pred:0.014217562042176723, decouple_loss:0.001334390719421208
2023-05-01 15:49:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.058868493884801865, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.054679401218891144, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05441911518573761, mean p set: 0.45035696029663086
loss_pred:0.019217856228351593, decouple_loss:0.0013645332073792815
loss_pred:0.018168922513723373, decouple_loss:0.0013575296616181731
loss_pred:0.018069515004754066, decouple_loss:0.001470469869673252
WV_0_PC_1_EH_0_PS_40, loss: 0.018555309623479843, avg_mse: 0.02685091830790043
current test mse: 0.026851
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488476812839508, gen p mean: -0.05841052532196045, mean p set: 0.4493279755115509
loss_pred:0.012562265619635582, decouple_loss:0.0014706716174259782
The modified gen p mean: 0.44755735993385315, gen p mean: -0.05330858752131462, mean p set: 0.44803765416145325The modified gen p mean: 0.44875746965408325, gen p mean: -0.055491089820861816, mean p set: 0.44923779368400574
loss_pred:0.013807810842990875, decouple_loss:0.0012947347713634372
loss_pred:0.01382395438849926, decouple_loss:0.0013299332931637764
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476599097251892, gen p mean: -0.05219244211912155, mean p set: 0.4481402039527893
The modified gen p mean: 0.4474261701107025, gen p mean: -0.055097077041864395, mean p set: 0.4479064643383026
loss_pred:0.01335558295249939, decouple_loss:0.0012784185819327831
loss_pred:0.013562457635998726, decouple_loss:0.0013598146615549922
The modified gen p mean: 0.44972047209739685, gen p mean: -0.057305242866277695, mean p set: 0.45020073652267456
loss_pred:0.012865656055510044, decouple_loss:0.0014409320428967476
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493548274040222, gen p mean: -0.04988938570022583, mean p set: 0.4498351216316223
loss_pred:0.013229502364993095, decouple_loss:0.0013903026701882482
The modified gen p mean: 0.4473476707935333, gen p mean: -0.047167420387268066, mean p set: 0.44782793521881104The modified gen p mean: 0.4478560984134674, gen p mean: -0.05287672579288483, mean p set: 0.4483363628387451
loss_pred:0.013572088442742825, decouple_loss:0.0013449398102238774
loss_pred:0.013858208432793617, decouple_loss:0.001349495374597609
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490068554878235, gen p mean: -0.0550965741276741, mean p set: 0.4494871497154236
loss_pred:0.012325971387326717, decouple_loss:0.001493875402957201
The modified gen p mean: 0.4489346146583557, gen p mean: -0.05323211848735809, mean p set: 0.4494149386882782The modified gen p mean: 0.44785284996032715, gen p mean: -0.04637732729315758, mean p set: 0.44833314418792725
loss_pred:0.013354365713894367, decouple_loss:0.0014991379575803876
loss_pred:0.013908798806369305, decouple_loss:0.0014647155767306685
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448076993227005, gen p mean: -0.046391814947128296, mean p set: 0.4485572874546051
loss_pred:0.013589708134531975, decouple_loss:0.0013128179125487804
The modified gen p mean: 0.4490741789340973, gen p mean: -0.04381818324327469, mean p set: 0.449554443359375The modified gen p mean: 0.449799120426178, gen p mean: -0.04990129545331001, mean p set: 0.4502794146537781
loss_pred:0.013453202322125435, decouple_loss:0.0012954466510564089
loss_pred:0.013823873363435268, decouple_loss:0.0013573792530223727
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467901289463043, gen p mean: -0.052432335913181305, mean p set: 0.4472704529762268
loss_pred:0.013461630791425705, decouple_loss:0.0014578643022105098
The modified gen p mean: 0.44837766885757446, gen p mean: -0.04985377565026283, mean p set: 0.44885799288749695The modified gen p mean: 0.4479535222053528, gen p mean: -0.05122394487261772, mean p set: 0.44843384623527527
loss_pred:0.013431651517748833, decouple_loss:0.0014419818762689829
loss_pred:0.013495380990207195, decouple_loss:0.0014626877382397652
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491240084171295, gen p mean: -0.05427681282162666, mean p set: 0.4496042728424072
The modified gen p mean: 0.448194295167923, gen p mean: -0.0485188253223896, mean p set: 0.44867458939552307
loss_pred:0.012266844511032104, decouple_loss:0.0014404843095690012
loss_pred:0.013808031566441059, decouple_loss:0.001421340275555849
The modified gen p mean: 0.4489038288593292, gen p mean: -0.045590080320835114, mean p set: 0.4493841528892517
loss_pred:0.013391563668847084, decouple_loss:0.0013241718988865614
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766315817832947, gen p mean: -0.045339394360780716, mean p set: 0.44814345240592957
The modified gen p mean: 0.4486277103424072, gen p mean: -0.051368098706007004, mean p set: 0.44910797476768494
The modified gen p mean: 0.4474325478076935, gen p mean: -0.045219939202070236, mean p set: 0.4479128420352936
loss_pred:0.013789447024464607, decouple_loss:0.001443268614821136
loss_pred:0.012721233069896698, decouple_loss:0.001407600473612547loss_pred:0.013077901676297188, decouple_loss:0.0013437236193567514
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474162757396698, gen p mean: -0.05046272650361061, mean p set: 0.4478965699672699
The modified gen p mean: 0.45075008273124695, gen p mean: -0.04465195909142494, mean p set: 0.45123034715652466
The modified gen p mean: 0.4516567587852478, gen p mean: -0.046885084360837936, mean p set: 0.4521370232105255
loss_pred:0.013193693943321705, decouple_loss:0.0013193885097280145
loss_pred:0.013374258764088154, decouple_loss:0.001335949171334505loss_pred:0.013072287663817406, decouple_loss:0.0013152624014765024
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669434428215027, gen p mean: -0.055129166692495346, mean p set: 0.447174608707428The modified gen p mean: 0.44856274127960205, gen p mean: -0.05109339579939842, mean p set: 0.44904303550720215
loss_pred:0.013654107227921486, decouple_loss:0.0013086110120639205
loss_pred:0.01401606760919094, decouple_loss:0.0012786546722054482
The modified gen p mean: 0.44738543033599854, gen p mean: -0.0471624992787838, mean p set: 0.44786569476127625
loss_pred:0.012767291627824306, decouple_loss:0.0011555968085303903
2023-05-01 15:51:31 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05462348088622093, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05060210078954697, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050466448068618774, mean p set: 0.45035696029663086
loss_pred:0.01921253465116024, decouple_loss:0.001459399121813476
loss_pred:0.018127143383026123, decouple_loss:0.0013648889726027846
loss_pred:0.018022047355771065, decouple_loss:0.0014798558549955487
WV_0_PC_1_EH_0_PS_40, loss: 0.01852564513683319, avg_mse: 0.026857666671276093
current test mse: 0.026858
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478738307952881, gen p mean: -0.053405988961458206, mean p set: 0.4483541250228882
loss_pred:0.01886940188705921, decouple_loss:0.0015980203170329332
The modified gen p mean: 0.4463558495044708, gen p mean: -0.0561431460082531, mean p set: 0.4468361735343933The modified gen p mean: 0.44685637950897217, gen p mean: -0.05026509240269661, mean p set: 0.44733667373657227
loss_pred:0.019660720601677895, decouple_loss:0.0015448697376996279
loss_pred:0.018963169306516647, decouple_loss:0.0014532044297084212
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474359452724457, gen p mean: -0.053307972848415375, mean p set: 0.4479162395000458
loss_pred:0.01857069320976734, decouple_loss:0.0013935217866674066
The modified gen p mean: 0.4461621940135956, gen p mean: -0.0532793328166008, mean p set: 0.4466424882411957The modified gen p mean: 0.447578489780426, gen p mean: -0.056898824870586395, mean p set: 0.4480588138103485
loss_pred:0.019039621576666832, decouple_loss:0.0013532013399526477
loss_pred:0.019007567316293716, decouple_loss:0.0014636500272899866
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461263120174408, gen p mean: -0.051661353558301926, mean p set: 0.4466065764427185
The modified gen p mean: 0.44663065671920776, gen p mean: -0.05764824524521828, mean p set: 0.4471109211444855
loss_pred:0.018304143100976944, decouple_loss:0.001302855322137475
loss_pred:0.01886303536593914, decouple_loss:0.0013314714888110757
The modified gen p mean: 0.44740989804267883, gen p mean: -0.05106571689248085, mean p set: 0.44789019227027893
loss_pred:0.018221957609057426, decouple_loss:0.0012506311759352684
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460795223712921, gen p mean: -0.053176406770944595, mean p set: 0.4465598464012146
The modified gen p mean: 0.4477715492248535, gen p mean: -0.05096760019659996, mean p set: 0.4482518434524536
loss_pred:0.018335191532969475, decouple_loss:0.0014448232250288129
The modified gen p mean: 0.44697073101997375, gen p mean: -0.050561483949422836, mean p set: 0.44745099544525146
loss_pred:0.018322117626667023, decouple_loss:0.0013085842365399003
loss_pred:0.018802719190716743, decouple_loss:0.0014223256148397923
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718998670578003, gen p mean: -0.05404026433825493, mean p set: 0.4476702809333801
The modified gen p mean: 0.4470862150192261, gen p mean: -0.051570404320955276, mean p set: 0.44756653904914856
loss_pred:0.017856311053037643, decouple_loss:0.0012235242174938321
loss_pred:0.018294807523489, decouple_loss:0.001341607770882547
The modified gen p mean: 0.44541826844215393, gen p mean: -0.04992903769016266, mean p set: 0.44589856266975403
loss_pred:0.018597014248371124, decouple_loss:0.001489669200964272
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44757890701293945, gen p mean: -0.05369002744555473, mean p set: 0.44805923104286194
The modified gen p mean: 0.44716978073120117, gen p mean: -0.05093356594443321, mean p set: 0.4476500451564789
loss_pred:0.01839987374842167, decouple_loss:0.0013906210660934448
loss_pred:0.018443897366523743, decouple_loss:0.0013683903962373734
The modified gen p mean: 0.445504754781723, gen p mean: -0.055110275745391846, mean p set: 0.4459850490093231
loss_pred:0.01780194230377674, decouple_loss:0.0013974602334201336
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641926884651184, gen p mean: -0.05095166340470314, mean p set: 0.4468995928764343
The modified gen p mean: 0.446615993976593, gen p mean: -0.04595398157835007, mean p set: 0.4470962882041931
loss_pred:0.01820305734872818, decouple_loss:0.001239382429048419
loss_pred:0.018979115411639214, decouple_loss:0.0012279052753001451
The modified gen p mean: 0.4478360414505005, gen p mean: -0.049894001334905624, mean p set: 0.4483163356781006
loss_pred:0.018041696399450302, decouple_loss:0.0012440163409337401
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873663783073425, gen p mean: -0.04895737022161484, mean p set: 0.44921690225601196
The modified gen p mean: 0.4471026360988617, gen p mean: -0.04975166171789169, mean p set: 0.4475829601287842
loss_pred:0.018146822229027748, decouple_loss:0.001450719777494669
loss_pred:0.0172722190618515, decouple_loss:0.0015444260789081454
The modified gen p mean: 0.4478875696659088, gen p mean: -0.05285709351301193, mean p set: 0.4483678936958313
loss_pred:0.018004635348916054, decouple_loss:0.00152412592433393
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452609717845917, gen p mean: -0.05632520467042923, mean p set: 0.4457412362098694
The modified gen p mean: 0.44643428921699524, gen p mean: -0.05081241577863693, mean p set: 0.44691455364227295
loss_pred:0.01800641044974327, decouple_loss:0.0013007292291149497
loss_pred:0.01758050173521042, decouple_loss:0.0013015145668759942
The modified gen p mean: 0.44537967443466187, gen p mean: -0.051439959555864334, mean p set: 0.4458599388599396
loss_pred:0.01773073524236679, decouple_loss:0.001241703750565648
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745323061943054, gen p mean: -0.05098915472626686, mean p set: 0.44793352484703064
The modified gen p mean: 0.44539394974708557, gen p mean: -0.05000683292746544, mean p set: 0.44587424397468567
loss_pred:0.017829442396759987, decouple_loss:0.0013452454004436731
loss_pred:0.018397800624370575, decouple_loss:0.0013219837564975023
The modified gen p mean: 0.4470093846321106, gen p mean: -0.04999507591128349, mean p set: 0.4474896788597107
loss_pred:0.01760169491171837, decouple_loss:0.0012521621538326144
2023-05-01 15:54:05 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.055652324110269547, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.051267120987176895, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050959840416908264, mean p set: 0.45035696029663086
loss_pred:0.01842515543103218, decouple_loss:0.0012583534698933363
loss_pred:0.017457475885748863, decouple_loss:0.001191668794490397loss_pred:0.01731346733868122, decouple_loss:0.0012792240595445037
WV_0_PC_1_EH_0_PS_40, loss: 0.017794188112020493, avg_mse: 0.02544085681438446
current test mse: 0.025441
At step 70, Best test: 0.025441
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479689598083496, gen p mean: -0.05464518815279007, mean p set: 0.4484492540359497
loss_pred:0.01743764616549015, decouple_loss:0.0012177805183455348
The modified gen p mean: 0.44784945249557495, gen p mean: -0.055951833724975586, mean p set: 0.44832971692085266The modified gen p mean: 0.4489671289920807, gen p mean: -0.05176883935928345, mean p set: 0.4494474530220032
loss_pred:0.018472349271178246, decouple_loss:0.0012497800635173917
loss_pred:0.01825135387480259, decouple_loss:0.0013460504123941064
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479115903377533, gen p mean: -0.05358368158340454, mean p set: 0.4483919143676758
The modified gen p mean: 0.4467689096927643, gen p mean: -0.04889093339443207, mean p set: 0.44724923372268677
loss_pred:0.017462797462940216, decouple_loss:0.001456062775105238
loss_pred:0.01821376197040081, decouple_loss:0.0014152273070067167
The modified gen p mean: 0.4473522901535034, gen p mean: -0.056881729513406754, mean p set: 0.4478325843811035
loss_pred:0.018455374985933304, decouple_loss:0.0013894912553951144
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458533823490143, gen p mean: -0.05678160488605499, mean p set: 0.4463336765766144
The modified gen p mean: 0.4481044113636017, gen p mean: -0.05615263059735298, mean p set: 0.4485847055912018
loss_pred:0.018071606755256653, decouple_loss:0.0014557178365066648
loss_pred:0.018031179904937744, decouple_loss:0.001174605218693614
The modified gen p mean: 0.4457213878631592, gen p mean: -0.05200513079762459, mean p set: 0.44620171189308167
loss_pred:0.01846613921225071, decouple_loss:0.0011710859835147858
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445453941822052, gen p mean: -0.06425604969263077, mean p set: 0.4459342360496521
The modified gen p mean: 0.44684791564941406, gen p mean: -0.05713457614183426, mean p set: 0.44732820987701416
loss_pred:0.017704028636217117, decouple_loss:0.001561663462780416
loss_pred:0.018678011372685432, decouple_loss:0.00145165144931525
The modified gen p mean: 0.44587939977645874, gen p mean: -0.06078629940748215, mean p set: 0.44635969400405884
loss_pred:0.017985407263040543, decouple_loss:0.001421703607775271
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446939617395401, gen p mean: -0.06184826418757439, mean p set: 0.4474199414253235
The modified gen p mean: 0.4461279511451721, gen p mean: -0.06611181050539017, mean p set: 0.4466082453727722
loss_pred:0.018681900575757027, decouple_loss:0.0011386319529265165
loss_pred:0.017362061887979507, decouple_loss:0.0011556950630620122
The modified gen p mean: 0.44625091552734375, gen p mean: -0.06735819578170776, mean p set: 0.44673120975494385
loss_pred:0.017871366813778877, decouple_loss:0.0011584965977817774
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466838240623474, gen p mean: -0.06427714973688126, mean p set: 0.4471641182899475
loss_pred:0.018228398635983467, decouple_loss:0.0013970494037494063
The modified gen p mean: 0.44656720757484436, gen p mean: -0.06150959059596062, mean p set: 0.44704747200012207The modified gen p mean: 0.4462960958480835, gen p mean: -0.06903258711099625, mean p set: 0.4467763900756836
loss_pred:0.01772790029644966, decouple_loss:0.0012946798233315349
loss_pred:0.01783713325858116, decouple_loss:0.0013890943955630064
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458296597003937, gen p mean: -0.05610988661646843, mean p set: 0.4463099241256714
loss_pred:0.018003469333052635, decouple_loss:0.0012334245257079601
The modified gen p mean: 0.44561466574668884, gen p mean: -0.05860089510679245, mean p set: 0.44609498977661133The modified gen p mean: 0.44811344146728516, gen p mean: -0.0638682171702385, mean p set: 0.44859373569488525
loss_pred:0.01782873272895813, decouple_loss:0.0011991034261882305
loss_pred:0.017760809510946274, decouple_loss:0.0011852034367620945
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766369462013245, gen p mean: -0.06309638917446136, mean p set: 0.44814398884773254
loss_pred:0.017705019563436508, decouple_loss:0.0011185124749317765
The modified gen p mean: 0.44713306427001953, gen p mean: -0.06198687478899956, mean p set: 0.44761335849761963The modified gen p mean: 0.44683387875556946, gen p mean: -0.06343582272529602, mean p set: 0.44731420278549194
loss_pred:0.01853278838098049, decouple_loss:0.0010991523740813136
loss_pred:0.01796979457139969, decouple_loss:0.001118274754844606
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463479518890381, gen p mean: -0.06425326317548752, mean p set: 0.44682827591896057
loss_pred:0.01831538788974285, decouple_loss:0.001223606406711042
The modified gen p mean: 0.4480862617492676, gen p mean: -0.06432361900806427, mean p set: 0.4485665559768677The modified gen p mean: 0.44816336035728455, gen p mean: -0.06547965854406357, mean p set: 0.44864365458488464
loss_pred:0.01751004159450531, decouple_loss:0.001050893566571176
loss_pred:0.017909467220306396, decouple_loss:0.001046364544890821
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474209249019623, gen p mean: -0.06376831978559494, mean p set: 0.4479012191295624
loss_pred:0.018097776919603348, decouple_loss:0.001077830558642745
The modified gen p mean: 0.4477018713951111, gen p mean: -0.06753247231245041, mean p set: 0.44818219542503357
The modified gen p mean: 0.4479663074016571, gen p mean: -0.06318970024585724, mean p set: 0.4484466016292572
loss_pred:0.017802931368350983, decouple_loss:0.0011931252665817738
loss_pred:0.018224727362394333, decouple_loss:0.0011159400455653667
2023-05-01 15:56:08 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06443846225738525, mean p set: 0.4502691626548767
loss_pred:0.018276922404766083, decouple_loss:0.0011830298462882638
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05966358259320259, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.059257395565509796, mean p set: 0.45035696029663086
loss_pred:0.017316574230790138, decouple_loss:0.0011701645562425256
loss_pred:0.017245424911379814, decouple_loss:0.0011795060709118843
WV_0_PC_1_EH_0_PS_40, loss: 0.017671853303909302, avg_mse: 0.025245357304811478
current test mse: 0.025245
At step 80, Best test: 0.025245
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502299427986145, gen p mean: -0.055305443704128265, mean p set: 0.4507102370262146
loss_pred:0.01833658665418625, decouple_loss:0.0010498067131265998
The modified gen p mean: 0.4495774507522583, gen p mean: -0.05908134952187538, mean p set: 0.4500577449798584
The modified gen p mean: 0.44964757561683655, gen p mean: -0.06226927042007446, mean p set: 0.45012786984443665
loss_pred:0.017575280740857124, decouple_loss:0.0010812582913786173
loss_pred:0.017639826983213425, decouple_loss:0.0010878928005695343
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492623209953308, gen p mean: -0.05670040100812912, mean p set: 0.4497425854206085
loss_pred:0.01802671328186989, decouple_loss:0.001157862483523786
The modified gen p mean: 0.4501861035823822, gen p mean: -0.05328996479511261, mean p set: 0.4506663978099823The modified gen p mean: 0.4497458040714264, gen p mean: -0.05752614140510559, mean p set: 0.4502260982990265
loss_pred:0.018321149051189423, decouple_loss:0.001163639361038804
loss_pred:0.018450096249580383, decouple_loss:0.0011914036003872752
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44959181547164917, gen p mean: -0.05187120661139488, mean p set: 0.45007210969924927
loss_pred:0.01747268997132778, decouple_loss:0.001122225308790803
The modified gen p mean: 0.44977566599845886, gen p mean: -0.05012480169534683, mean p set: 0.45025599002838135The modified gen p mean: 0.44919729232788086, gen p mean: -0.0520513691008091, mean p set: 0.44967761635780334
loss_pred:0.018216338008642197, decouple_loss:0.00107851205393672
loss_pred:0.018605461344122887, decouple_loss:0.00114156783092767
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864264130592346, gen p mean: -0.060097310692071915, mean p set: 0.44912293553352356
The modified gen p mean: 0.4489953815937042, gen p mean: -0.06284398585557938, mean p set: 0.4494756758213043
loss_pred:0.01958257332444191, decouple_loss:0.0011484462302178144
loss_pred:0.017551228404045105, decouple_loss:0.0010884767398238182
The modified gen p mean: 0.4495851397514343, gen p mean: -0.0602709986269474, mean p set: 0.4500654339790344
loss_pred:0.01800248958170414, decouple_loss:0.001140848733484745
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862550497055054, gen p mean: -0.054371148347854614, mean p set: 0.44910579919815063
The modified gen p mean: 0.44960206747055054, gen p mean: -0.04873259365558624, mean p set: 0.45008236169815063
The modified gen p mean: 0.4502265155315399, gen p mean: -0.05387086793780327, mean p set: 0.45070680975914
loss_pred:0.018660124391317368, decouple_loss:0.0012460823636502028
loss_pred:0.018506532534956932, decouple_loss:0.0010786586208269loss_pred:0.018814140930771828, decouple_loss:0.0011456409702077508
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938376545906067, gen p mean: -0.052192386239767075, mean p set: 0.44986405968666077
loss_pred:0.018279558047652245, decouple_loss:0.0009889588691294193The modified gen p mean: 0.4502841830253601, gen p mean: -0.056780654937028885, mean p set: 0.4507644772529602
The modified gen p mean: 0.44985243678092957, gen p mean: -0.060808032751083374, mean p set: 0.45033276081085205
loss_pred:0.018684640526771545, decouple_loss:0.0010951606091111898
loss_pred:0.018138598650693893, decouple_loss:0.0010895830346271396
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490238428115845, gen p mean: -0.059465114027261734, mean p set: 0.44950413703918457
The modified gen p mean: 0.4493839740753174, gen p mean: -0.056836340576410294, mean p set: 0.44986429810523987
The modified gen p mean: 0.44980505108833313, gen p mean: -0.058638785034418106, mean p set: 0.450285404920578
loss_pred:0.018994951620697975, decouple_loss:0.001101016765460372
loss_pred:0.01788043975830078, decouple_loss:0.0010178168304264545loss_pred:0.01787940040230751, decouple_loss:0.0011007260764017701
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505566358566284, gen p mean: -0.048982374370098114, mean p set: 0.4510369300842285
The modified gen p mean: 0.450111985206604, gen p mean: -0.04930276796221733, mean p set: 0.4505922794342041
loss_pred:0.01841912977397442, decouple_loss:0.0010424311039969325
loss_pred:0.01799682341516018, decouple_loss:0.0010317881824448705
The modified gen p mean: 0.4502740204334259, gen p mean: -0.04818713665008545, mean p set: 0.450754314661026
loss_pred:0.018444856628775597, decouple_loss:0.0010674074292182922
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486214816570282, gen p mean: -0.052671048790216446, mean p set: 0.4491018056869507
The modified gen p mean: 0.4481066167354584, gen p mean: -0.053526394069194794, mean p set: 0.44858694076538086
loss_pred:0.01828405261039734, decouple_loss:0.0010843498166650534
loss_pred:0.019035259261727333, decouple_loss:0.00101552065461874
The modified gen p mean: 0.45172709226608276, gen p mean: -0.05007846653461456, mean p set: 0.45220738649368286
loss_pred:0.018291907384991646, decouple_loss:0.0009633185109123588
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060786604881287, gen p mean: -0.05248725041747093, mean p set: 0.45108816027641296
loss_pred:0.017520179972052574, decouple_loss:0.0009543583146296442
The modified gen p mean: 0.45044082403182983, gen p mean: -0.05405445024371147, mean p set: 0.45092108845710754The modified gen p mean: 0.4495059847831726, gen p mean: -0.05564916133880615, mean p set: 0.4499862790107727
loss_pred:0.019045675173401833, decouple_loss:0.0010233554057776928
loss_pred:0.018104102462530136, decouple_loss:0.0009111986728385091
2023-05-01 15:58:47 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06075744703412056, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05622183904051781, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.056044623255729675, mean p set: 0.45035696029663086
loss_pred:0.01825961470603943, decouple_loss:0.0010453136637806892
loss_pred:0.017329463735222816, decouple_loss:0.001077211112715304
loss_pred:0.017267709597945213, decouple_loss:0.0011849594302475452
WV_0_PC_1_EH_0_PS_40, loss: 0.017674054950475693, avg_mse: 0.025272976607084274
current test mse: 0.025273
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498112201690674, gen p mean: -0.05180082842707634, mean p set: 0.4502915143966675
The modified gen p mean: 0.44984233379364014, gen p mean: -0.049842268228530884, mean p set: 0.45032259821891785
loss_pred:0.017963046208024025, decouple_loss:0.0009338052477687597
The modified gen p mean: 0.4496156871318817, gen p mean: -0.04739358276128769, mean p set: 0.4500959813594818
loss_pred:0.018427584320306778, decouple_loss:0.0010119271464645863
loss_pred:0.018372632563114166, decouple_loss:0.0010176664218306541
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492156505584717, gen p mean: -0.04823451116681099, mean p set: 0.4496959447860718
The modified gen p mean: 0.44978153705596924, gen p mean: -0.050426967442035675, mean p set: 0.45026183128356934
loss_pred:0.018527425825595856, decouple_loss:0.000983168720267713
loss_pred:0.018244020640850067, decouple_loss:0.0010182466357946396
The modified gen p mean: 0.44944414496421814, gen p mean: -0.0586206279695034, mean p set: 0.44992440938949585
loss_pred:0.017855700105428696, decouple_loss:0.0009797809179872274
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003122091293335, gen p mean: -0.05197839438915253, mean p set: 0.45051151514053345
loss_pred:0.01813172735273838, decouple_loss:0.000967100728303194
The modified gen p mean: 0.4489370584487915, gen p mean: -0.055611226707696915, mean p set: 0.4494173526763916The modified gen p mean: 0.44968053698539734, gen p mean: -0.05722188949584961, mean p set: 0.45016080141067505
loss_pred:0.01808081939816475, decouple_loss:0.0009669146966189146
loss_pred:0.01780814304947853, decouple_loss:0.0009310991154052317
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490235149860382, gen p mean: -0.057505469769239426, mean p set: 0.4495038390159607
The modified gen p mean: 0.4497734606266022, gen p mean: -0.053316231817007065, mean p set: 0.4502537250518799
loss_pred:0.017579147592186928, decouple_loss:0.0009469384676776826
The modified gen p mean: 0.44803759455680847, gen p mean: -0.05525970458984375, mean p set: 0.4485178589820862
loss_pred:0.01788952387869358, decouple_loss:0.0009196893079206347
loss_pred:0.017785001546144485, decouple_loss:0.0010053245350718498
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44942376017570496, gen p mean: -0.05735494941473007, mean p set: 0.44990405440330505
loss_pred:0.017732053995132446, decouple_loss:0.0010179682867601514
The modified gen p mean: 0.45207497477531433, gen p mean: -0.05036591365933418, mean p set: 0.45255526900291443The modified gen p mean: 0.4492329955101013, gen p mean: -0.06072402745485306, mean p set: 0.4497132897377014
loss_pred:0.017681587487459183, decouple_loss:0.0009741919348016381
loss_pred:0.018477408215403557, decouple_loss:0.0010639838874340057
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045432448387146, gen p mean: -0.048991408199071884, mean p set: 0.45093461871147156
loss_pred:0.01871856488287449, decouple_loss:0.0010645866859704256
The modified gen p mean: 0.45063337683677673, gen p mean: -0.05326801538467407, mean p set: 0.4511137008666992The modified gen p mean: 0.4493388235569, gen p mean: -0.05570399388670921, mean p set: 0.44981908798217773
loss_pred:0.01793605647981167, decouple_loss:0.0009554054122418165
loss_pred:0.017786407843232155, decouple_loss:0.0009755148785188794
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503733515739441, gen p mean: -0.05632048100233078, mean p set: 0.4508536458015442
The modified gen p mean: 0.44963276386260986, gen p mean: -0.054959822446107864, mean p set: 0.4501130282878876
loss_pred:0.017929185181856155, decouple_loss:0.0008729022229090333
loss_pred:0.017696483060717583, decouple_loss:0.0009414058877155185
The modified gen p mean: 0.44956380128860474, gen p mean: -0.057656072080135345, mean p set: 0.4500441253185272
loss_pred:0.01818510703742504, decouple_loss:0.0009180853958241642
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490357041358948, gen p mean: -0.05808024853467941, mean p set: 0.4495159983634949
The modified gen p mean: 0.4487402141094208, gen p mean: -0.05733712390065193, mean p set: 0.4492204785346985
loss_pred:0.01822853460907936, decouple_loss:0.001036040484905243
loss_pred:0.017944004386663437, decouple_loss:0.0010429734829813242
The modified gen p mean: 0.44998836517333984, gen p mean: -0.051842592656612396, mean p set: 0.45046865940093994
loss_pred:0.01790265552699566, decouple_loss:0.0010171127505600452
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487699568271637, gen p mean: -0.061821140348911285, mean p set: 0.4492502808570862
The modified gen p mean: 0.44992658495903015, gen p mean: -0.05149829015135765, mean p set: 0.45040687918663025
loss_pred:0.018030531704425812, decouple_loss:0.0009806877933442593
loss_pred:0.01816171035170555, decouple_loss:0.0009097321308217943
The modified gen p mean: 0.44940534234046936, gen p mean: -0.049622051417827606, mean p set: 0.44988563656806946
loss_pred:0.01757560856640339, decouple_loss:0.0009704552358016372
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142218470573425, gen p mean: -0.0538780502974987, mean p set: 0.45190247893333435
The modified gen p mean: 0.4503208100795746, gen p mean: -0.05087282136082649, mean p set: 0.4508011043071747
loss_pred:0.018788786605000496, decouple_loss:0.0009533235570415854
loss_pred:0.01776053011417389, decouple_loss:0.0009911233792081475The modified gen p mean: 0.4489773213863373, gen p mean: -0.05043981224298477, mean p set: 0.449457585811615
loss_pred:0.01870947703719139, decouple_loss:0.0009376865928061306
2023-05-01 16:00:42 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06125478446483612, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.056825295090675354, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.056703418493270874, mean p set: 0.45035696029663086
loss_pred:0.018261512741446495, decouple_loss:0.0009875115938484669
loss_pred:0.017345285043120384, decouple_loss:0.0009864267194643617
loss_pred:0.017231963574886322, decouple_loss:0.0009854352101683617
WV_0_PC_1_EH_0_PS_40, loss: 0.01766224391758442, avg_mse: 0.025271473452448845
current test mse: 0.025271
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951653480529785, gen p mean: -0.05033993721008301, mean p set: 0.44999685883522034
loss_pred:0.016069898381829262, decouple_loss:0.0009184422087855637
The modified gen p mean: 0.44996997714042664, gen p mean: -0.0495467483997345, mean p set: 0.4504503011703491The modified gen p mean: 0.45292118191719055, gen p mean: -0.04833289608359337, mean p set: 0.45340150594711304
loss_pred:0.01713070087134838, decouple_loss:0.0011030557798221707
loss_pred:0.016931572929024696, decouple_loss:0.0011837204219773412
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45261842012405396, gen p mean: -0.04889717698097229, mean p set: 0.45309871435165405
loss_pred:0.016627583652734756, decouple_loss:0.0009505182388238609
The modified gen p mean: 0.4525906443595886, gen p mean: -0.05739172175526619, mean p set: 0.4530709385871887The modified gen p mean: 0.45263898372650146, gen p mean: -0.04776189476251602, mean p set: 0.45311927795410156
loss_pred:0.01657792180776596, decouple_loss:0.0009604526567272842
loss_pred:0.016481313854455948, decouple_loss:0.0009723440743982792
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517694115638733, gen p mean: -0.04451005905866623, mean p set: 0.4522497057914734
loss_pred:0.016791164875030518, decouple_loss:0.0009135175496339798
The modified gen p mean: 0.4526252746582031, gen p mean: -0.04605640470981598, mean p set: 0.4531055688858032The modified gen p mean: 0.4504168927669525, gen p mean: -0.04504166543483734, mean p set: 0.4508971571922302
loss_pred:0.01692488044500351, decouple_loss:0.0009346467559225857
loss_pred:0.016493994742631912, decouple_loss:0.0010848878882825375
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532553255558014, gen p mean: -0.04342528432607651, mean p set: 0.4537356197834015
loss_pred:0.01675499603152275, decouple_loss:0.0010972346644848585
The modified gen p mean: 0.45138290524482727, gen p mean: -0.04927437752485275, mean p set: 0.45186319947242737The modified gen p mean: 0.44915416836738586, gen p mean: -0.04763885587453842, mean p set: 0.44963446259498596
loss_pred:0.016798822209239006, decouple_loss:0.0010392089607194066
loss_pred:0.016435595229268074, decouple_loss:0.001019827788695693
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504302144050598, gen p mean: -0.04421588405966759, mean p set: 0.4509105384349823
loss_pred:0.016673313453793526, decouple_loss:0.0010126051492989063
The modified gen p mean: 0.44960248470306396, gen p mean: -0.041665323078632355, mean p set: 0.45008277893066406The modified gen p mean: 0.45054343342781067, gen p mean: -0.042795535176992416, mean p set: 0.4510236978530884
loss_pred:0.016760854050517082, decouple_loss:0.000988343614153564
loss_pred:0.0160682313144207, decouple_loss:0.0009384625009261072
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500761032104492, gen p mean: -0.04217757284641266, mean p set: 0.4505563974380493
loss_pred:0.0172178503125906, decouple_loss:0.000920763413887471
The modified gen p mean: 0.4492179751396179, gen p mean: -0.044111255556344986, mean p set: 0.4496982991695404The modified gen p mean: 0.4515954256057739, gen p mean: -0.040839411318302155, mean p set: 0.45207569003105164
loss_pred:0.01601048931479454, decouple_loss:0.000980452517978847
loss_pred:0.016200270503759384, decouple_loss:0.0009372602798976004
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494049847126007, gen p mean: -0.0397755429148674, mean p set: 0.4498852789402008
loss_pred:0.017119208350777626, decouple_loss:0.001006823149509728
The modified gen p mean: 0.4513232409954071, gen p mean: -0.043042659759521484, mean p set: 0.4518035352230072The modified gen p mean: 0.450313001871109, gen p mean: -0.0398775190114975, mean p set: 0.4507932960987091
loss_pred:0.016570743173360825, decouple_loss:0.0009699647198431194
loss_pred:0.016089368611574173, decouple_loss:0.0008632526732981205
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532533288002014, gen p mean: -0.04149594157934189, mean p set: 0.4537335932254791
loss_pred:0.016655057668685913, decouple_loss:0.0009752484620548785
The modified gen p mean: 0.4518849551677704, gen p mean: -0.044628795236349106, mean p set: 0.4523652195930481The modified gen p mean: 0.45007872581481934, gen p mean: -0.04276671260595322, mean p set: 0.45055902004241943
loss_pred:0.01686720922589302, decouple_loss:0.0009377631940878928
loss_pred:0.01657266728579998, decouple_loss:0.0009453394450247288
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019471645355225, gen p mean: -0.04056272655725479, mean p set: 0.45067504048347473
loss_pred:0.01616721786558628, decouple_loss:0.000960187055170536
The modified gen p mean: 0.4500027298927307, gen p mean: -0.04281710460782051, mean p set: 0.4504829943180084The modified gen p mean: 0.45090562105178833, gen p mean: -0.0394422672688961, mean p set: 0.4513859152793884
loss_pred:0.015245682559907436, decouple_loss:0.0010898446198552847
loss_pred:0.016870150342583656, decouple_loss:0.0009830795461311936
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504377841949463, gen p mean: -0.045150939375162125, mean p set: 0.4509181082248688
loss_pred:0.016496896743774414, decouple_loss:0.0010209449101239443
The modified gen p mean: 0.4496537744998932, gen p mean: -0.04605940356850624, mean p set: 0.4501340985298157The modified gen p mean: 0.4507702589035034, gen p mean: -0.03630032390356064, mean p set: 0.4512505531311035
loss_pred:0.016679950058460236, decouple_loss:0.0010897574247792363
loss_pred:0.017159875482320786, decouple_loss:0.001035162596963346
2023-05-01 16:03:15 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.053171854466199875, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04934608191251755, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04934054985642433, mean p set: 0.45035696029663086
loss_pred:0.018281251192092896, decouple_loss:0.0010179177625104785
loss_pred:0.01734350249171257, decouple_loss:0.0009916732087731361
loss_pred:0.017214195802807808, decouple_loss:0.0010577625362202525
WV_0_PC_1_EH_0_PS_40, loss: 0.01766410656273365, avg_mse: 0.025286175310611725
current test mse: 0.025286
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024293661117554, gen p mean: -0.04094851389527321, mean p set: 0.45072323083877563
loss_pred:0.015844009816646576, decouple_loss:0.0010119089856743813
The modified gen p mean: 0.45299434661865234, gen p mean: -0.045418404042720795, mean p set: 0.45347464084625244The modified gen p mean: 0.4494568407535553, gen p mean: -0.04244404286146164, mean p set: 0.449937105178833
loss_pred:0.016306936740875244, decouple_loss:0.0009531388059258461
loss_pred:0.015613428317010403, decouple_loss:0.0008868530276231468
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502231180667877, gen p mean: -0.04045817255973816, mean p set: 0.4507034122943878
loss_pred:0.016412856057286263, decouple_loss:0.0010175618808716536
The modified gen p mean: 0.4497902989387512, gen p mean: -0.04254460334777832, mean p set: 0.4502705931663513The modified gen p mean: 0.45068979263305664, gen p mean: -0.041683897376060486, mean p set: 0.4511701166629791
loss_pred:0.01596347615122795, decouple_loss:0.0009352274355478585
loss_pred:0.016143182292580605, decouple_loss:0.0010439291363582015
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504398703575134, gen p mean: -0.04420561343431473, mean p set: 0.4509201943874359
loss_pred:0.016389407217502594, decouple_loss:0.0009670323925092816
The modified gen p mean: 0.4514337182044983, gen p mean: -0.04869673401117325, mean p set: 0.4519140422344208The modified gen p mean: 0.45062196254730225, gen p mean: -0.04071230813860893, mean p set: 0.45110225677490234
loss_pred:0.016817588359117508, decouple_loss:0.0009846448665484786
loss_pred:0.016253095120191574, decouple_loss:0.0010108704445883632
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142993330955505, gen p mean: -0.04470936208963394, mean p set: 0.45191025733947754
loss_pred:0.016145164147019386, decouple_loss:0.0009257401688955724
The modified gen p mean: 0.4504571557044983, gen p mean: -0.04631854593753815, mean p set: 0.450937420129776The modified gen p mean: 0.45139604806900024, gen p mean: -0.043294165283441544, mean p set: 0.45187634229660034
loss_pred:0.016538990661501884, decouple_loss:0.0009042561869136989
loss_pred:0.01643143966794014, decouple_loss:0.0009248509886674583
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45214036107063293, gen p mean: -0.05019787326455116, mean p set: 0.45262065529823303
loss_pred:0.016586199402809143, decouple_loss:0.0009441830334253609
The modified gen p mean: 0.4519236981868744, gen p mean: -0.04593441262841225, mean p set: 0.4524039626121521The modified gen p mean: 0.4503708481788635, gen p mean: -0.042831070721149445, mean p set: 0.4508511424064636
loss_pred:0.015939155593514442, decouple_loss:0.0009865029715001583
loss_pred:0.01640811562538147, decouple_loss:0.0009129535173997283
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520682990550995, gen p mean: -0.046081531792879105, mean p set: 0.4525485932826996
loss_pred:0.016382340341806412, decouple_loss:0.0009531452669762075
The modified gen p mean: 0.450580358505249, gen p mean: -0.04131107032299042, mean p set: 0.4510606527328491The modified gen p mean: 0.45020055770874023, gen p mean: -0.04085592180490494, mean p set: 0.45068085193634033
loss_pred:0.01641250029206276, decouple_loss:0.000923153362236917
loss_pred:0.01565014384686947, decouple_loss:0.0010190694592893124
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45049917697906494, gen p mean: -0.04142197594046593, mean p set: 0.45097947120666504
loss_pred:0.01648346334695816, decouple_loss:0.0008342606597580016
The modified gen p mean: 0.4499615430831909, gen p mean: -0.04000517353415489, mean p set: 0.450441837310791The modified gen p mean: 0.45077088475227356, gen p mean: -0.04255737364292145, mean p set: 0.45125120878219604
loss_pred:0.01637561433017254, decouple_loss:0.0009334345231764019
loss_pred:0.016528282314538956, decouple_loss:0.0008811167208477855
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500267207622528, gen p mean: -0.036412313580513, mean p set: 0.4505070447921753
loss_pred:0.017440037801861763, decouple_loss:0.0008368355338461697
The modified gen p mean: 0.4500598609447479, gen p mean: -0.042797453701496124, mean p set: 0.45054012537002563The modified gen p mean: 0.4527037441730499, gen p mean: -0.043144892901182175, mean p set: 0.45318400859832764
loss_pred:0.016677243635058403, decouple_loss:0.0008801930234767497
loss_pred:0.01681145839393139, decouple_loss:0.0009152385755442083
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108312368392944, gen p mean: -0.04349910467863083, mean p set: 0.45156341791152954
loss_pred:0.016288548707962036, decouple_loss:0.0009277018834836781
The modified gen p mean: 0.44935160875320435, gen p mean: -0.040116000920534134, mean p set: 0.44983193278312683The modified gen p mean: 0.4501752555370331, gen p mean: -0.044457484036684036, mean p set: 0.4506555497646332
loss_pred:0.017668625339865685, decouple_loss:0.0009571393020451069
loss_pred:0.016593871638178825, decouple_loss:0.0010464746737852693
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488731920719147, gen p mean: -0.050635963678359985, mean p set: 0.44935348629951477
loss_pred:0.014728943817317486, decouple_loss:0.0012636182364076376
The modified gen p mean: 0.447664350271225, gen p mean: -0.04933035001158714, mean p set: 0.4481446146965027The modified gen p mean: 0.4483393728733063, gen p mean: -0.04746905714273453, mean p set: 0.44881969690322876
loss_pred:0.015187320299446583, decouple_loss:0.001289288979023695
loss_pred:0.014942706562578678, decouple_loss:0.0012294523185119033
2023-05-01 16:05:45 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05243387445807457, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.048447877168655396, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0483594685792923, mean p set: 0.45035696029663086
loss_pred:0.018319739028811455, decouple_loss:0.0010364479385316372
loss_pred:0.0173712819814682, decouple_loss:0.0010296100517734885
loss_pred:0.017178956419229507, decouple_loss:0.0011044113198295236
WV_0_PC_1_EH_0_PS_40, loss: 0.01767616719007492, avg_mse: 0.025339560583233833
current test mse: 0.02534
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447870135307312, gen p mean: -0.04965487867593765, mean p set: 0.4483504593372345
loss_pred:0.014678004197776318, decouple_loss:0.0010244797449558973
The modified gen p mean: 0.4489864110946655, gen p mean: -0.045488081872463226, mean p set: 0.4494667053222656The modified gen p mean: 0.4493597447872162, gen p mean: -0.04579579830169678, mean p set: 0.44984006881713867
loss_pred:0.015024655498564243, decouple_loss:0.0010560305090621114
loss_pred:0.014102431014180183, decouple_loss:0.0009545971406623721
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682058691978455, gen p mean: -0.04814557731151581, mean p set: 0.44730088114738464
loss_pred:0.014108214527368546, decouple_loss:0.0013910823035985231
The modified gen p mean: 0.4480254054069519, gen p mean: -0.05254311114549637, mean p set: 0.448505699634552The modified gen p mean: 0.4474150538444519, gen p mean: -0.049364715814590454, mean p set: 0.4478953182697296
loss_pred:0.013962998986244202, decouple_loss:0.0014558953698724508
loss_pred:0.014229780063033104, decouple_loss:0.0013344084145501256
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486350119113922, gen p mean: -0.05379953235387802, mean p set: 0.4491152763366699
loss_pred:0.013764929957687855, decouple_loss:0.0011527093593031168
The modified gen p mean: 0.44823935627937317, gen p mean: -0.05195336043834686, mean p set: 0.44871968030929565The modified gen p mean: 0.44841331243515015, gen p mean: -0.05506758391857147, mean p set: 0.44889357686042786
loss_pred:0.013732368126511574, decouple_loss:0.0011823950335383415
loss_pred:0.013855598866939545, decouple_loss:0.001167170237749815
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815993309020996, gen p mean: -0.044077545404434204, mean p set: 0.44864022731781006
loss_pred:0.014352353289723396, decouple_loss:0.0014838723000138998
The modified gen p mean: 0.44821345806121826, gen p mean: -0.05168429762125015, mean p set: 0.44869375228881836The modified gen p mean: 0.4477507472038269, gen p mean: -0.04679127410054207, mean p set: 0.448231041431427
loss_pred:0.014218371361494064, decouple_loss:0.0012785341823473573
loss_pred:0.0137330312281847, decouple_loss:0.0011836658231914043
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481697380542755, gen p mean: -0.047536905854940414, mean p set: 0.448650062084198
loss_pred:0.014164493419229984, decouple_loss:0.0011302647180855274
The modified gen p mean: 0.4488052427768707, gen p mean: -0.05468996986746788, mean p set: 0.4492855668067932The modified gen p mean: 0.4477349817752838, gen p mean: -0.04735136032104492, mean p set: 0.4482152760028839
loss_pred:0.013446140103042126, decouple_loss:0.0010649892501533031
loss_pred:0.014193928800523281, decouple_loss:0.0011085679288953543
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854146242141724, gen p mean: -0.047452449798583984, mean p set: 0.44902175664901733
loss_pred:0.01412922888994217, decouple_loss:0.0012627228861674666
The modified gen p mean: 0.4487239420413971, gen p mean: -0.0550195686519146, mean p set: 0.4492042660713196The modified gen p mean: 0.44824087619781494, gen p mean: -0.05210895091295242, mean p set: 0.44872117042541504
loss_pred:0.014274327084422112, decouple_loss:0.0012543597258627415
loss_pred:0.013194109313189983, decouple_loss:0.0012020017020404339
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476039409637451, gen p mean: -0.05154445767402649, mean p set: 0.4480842351913452
loss_pred:0.01325621921569109, decouple_loss:0.0011680141324177384
The modified gen p mean: 0.4484677314758301, gen p mean: -0.0442027784883976, mean p set: 0.44894805550575256The modified gen p mean: 0.449165403842926, gen p mean: -0.05049922317266464, mean p set: 0.4496456980705261
loss_pred:0.01392385270446539, decouple_loss:0.001171532436273992
loss_pred:0.013620592653751373, decouple_loss:0.0011896888026967645
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482167363166809, gen p mean: -0.05247464403510094, mean p set: 0.4486970603466034
The modified gen p mean: 0.44843611121177673, gen p mean: -0.0542086623609066, mean p set: 0.44891637563705444
loss_pred:0.013952021487057209, decouple_loss:0.001310592284426093
The modified gen p mean: 0.44745129346847534, gen p mean: -0.04967392981052399, mean p set: 0.4479316174983978
loss_pred:0.013462211936712265, decouple_loss:0.001230043824762106
loss_pred:0.014094383455812931, decouple_loss:0.00122943299356848
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493885040283203, gen p mean: -0.05244810879230499, mean p set: 0.4498688280582428
loss_pred:0.01352414209395647, decouple_loss:0.001307853264734149
The modified gen p mean: 0.44679588079452515, gen p mean: -0.04616169258952141, mean p set: 0.44727620482444763The modified gen p mean: 0.448375940322876, gen p mean: -0.0518660768866539, mean p set: 0.4488562345504761
loss_pred:0.013788660056889057, decouple_loss:0.0013183727860450745
loss_pred:0.013644705526530743, decouple_loss:0.001273473841138184
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936540722846985, gen p mean: -0.046229492872953415, mean p set: 0.44984567165374756
loss_pred:0.01393127255141735, decouple_loss:0.001271428307518363
The modified gen p mean: 0.4476427733898163, gen p mean: -0.04543455317616463, mean p set: 0.4481230676174164The modified gen p mean: 0.4484662413597107, gen p mean: -0.04848124086856842, mean p set: 0.4489465653896332
loss_pred:0.013980028219521046, decouple_loss:0.0012047762284055352
loss_pred:0.013361371122300625, decouple_loss:0.001285497797653079
2023-05-01 16:07:41 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.048763155937194824, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.044970814138650894, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04506000876426697, mean p set: 0.45035696029663086
loss_pred:0.019119083881378174, decouple_loss:0.0013312360970303416
loss_pred:0.018101932480931282, decouple_loss:0.0013509899144992232
loss_pred:0.017923759296536446, decouple_loss:0.0015111606335267425
WV_0_PC_1_EH_0_PS_40, loss: 0.01845148205757141, avg_mse: 0.02679004892706871
current test mse: 0.02679
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480161666870117, gen p mean: -0.049515001475811005, mean p set: 0.4484964609146118
loss_pred:0.013072598725557327, decouple_loss:0.0014053145423531532
The modified gen p mean: 0.44861480593681335, gen p mean: -0.0400431789457798, mean p set: 0.44909510016441345The modified gen p mean: 0.44775041937828064, gen p mean: -0.040881913155317307, mean p set: 0.44823071360588074
loss_pred:0.01360051054507494, decouple_loss:0.001410352997481823
loss_pred:0.013749774545431137, decouple_loss:0.0013885846128687263
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484531879425049, gen p mean: -0.05136619508266449, mean p set: 0.4489334523677826
loss_pred:0.01323079876601696, decouple_loss:0.0012476362753659487
The modified gen p mean: 0.44844579696655273, gen p mean: -0.04314165934920311, mean p set: 0.44892609119415283The modified gen p mean: 0.4490232765674591, gen p mean: -0.042739901691675186, mean p set: 0.4495035707950592
loss_pred:0.013200069777667522, decouple_loss:0.0011781287612393498
loss_pred:0.013230398297309875, decouple_loss:0.001106601906940341
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44884786009788513, gen p mean: -0.051067620515823364, mean p set: 0.44932815432548523
loss_pred:0.013022861443459988, decouple_loss:0.0015608611283823848
The modified gen p mean: 0.44761529564857483, gen p mean: -0.04297712817788124, mean p set: 0.4480955898761749The modified gen p mean: 0.4474274516105652, gen p mean: -0.039203256368637085, mean p set: 0.4479077458381653
loss_pred:0.013747143559157848, decouple_loss:0.0014228335348889232
loss_pred:0.013470275327563286, decouple_loss:0.0013411454856395721
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050033926963806, gen p mean: -0.049065422266721725, mean p set: 0.45098060369491577
loss_pred:0.013368031941354275, decouple_loss:0.0013059728080406785
The modified gen p mean: 0.44832903146743774, gen p mean: -0.043881528079509735, mean p set: 0.44880932569503784The modified gen p mean: 0.4481566250324249, gen p mean: -0.04563705995678902, mean p set: 0.44863688945770264
loss_pred:0.01343831978738308, decouple_loss:0.0011425628326833248
loss_pred:0.01294538751244545, decouple_loss:0.0011830125004053116
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480617344379425, gen p mean: -0.03874756768345833, mean p set: 0.4485420286655426
loss_pred:0.01388236042112112, decouple_loss:0.0012341825058683753
The modified gen p mean: 0.4472561478614807, gen p mean: -0.046143099665641785, mean p set: 0.4477364122867584The modified gen p mean: 0.44795912504196167, gen p mean: -0.04360770434141159, mean p set: 0.44843941926956177
loss_pred:0.013546301051974297, decouple_loss:0.0012946416391059756
loss_pred:0.013819258660078049, decouple_loss:0.0013241255655884743
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889310002326965, gen p mean: -0.05057168006896973, mean p set: 0.44937342405319214
loss_pred:0.012783233076334, decouple_loss:0.0015010969946160913
The modified gen p mean: 0.4490513503551483, gen p mean: -0.0423237606883049, mean p set: 0.449531614780426The modified gen p mean: 0.4489331543445587, gen p mean: -0.046568457037210464, mean p set: 0.4494134187698364
loss_pred:0.013562366366386414, decouple_loss:0.0013916054740548134
loss_pred:0.012720350176095963, decouple_loss:0.00140039948746562
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505738615989685, gen p mean: -0.045194871723651886, mean p set: 0.4510541558265686
loss_pred:0.013535672798752785, decouple_loss:0.0011204355396330357
The modified gen p mean: 0.4481634199619293, gen p mean: -0.045999206602573395, mean p set: 0.4486437141895294The modified gen p mean: 0.4470297396183014, gen p mean: -0.045919910073280334, mean p set: 0.4475100636482239
loss_pred:0.013324621133506298, decouple_loss:0.0010936078615486622
loss_pred:0.013215211220085621, decouple_loss:0.0010752015514299273
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690385460853577, gen p mean: -0.041563041508197784, mean p set: 0.44738414883613586
loss_pred:0.013724270276725292, decouple_loss:0.0014125378802418709
The modified gen p mean: 0.4497413635253906, gen p mean: -0.04161012917757034, mean p set: 0.4502216577529907The modified gen p mean: 0.44814160466194153, gen p mean: -0.040696486830711365, mean p set: 0.448621928691864
loss_pred:0.013824733905494213, decouple_loss:0.00141573091968894
loss_pred:0.013655229471623898, decouple_loss:0.0014309686375781894
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485386908054352, gen p mean: -0.04034091532230377, mean p set: 0.44901901483535767The modified gen p mean: 0.4472508430480957, gen p mean: -0.04140695929527283, mean p set: 0.4477311074733734
loss_pred:0.01352701336145401, decouple_loss:0.0010304820025339723loss_pred:0.013387758284807205, decouple_loss:0.001045446377247572
The modified gen p mean: 0.4489436149597168, gen p mean: -0.03928780555725098, mean p set: 0.4494239091873169
loss_pred:0.013068413361907005, decouple_loss:0.0010643086861819029
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
NaN value num: 0
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502076506614685, gen p mean: -0.040625859051942825, mean p set: 0.4506879150867462
loss_pred:0.016422338783740997, decouple_loss:0.0012912862002849579
The modified gen p mean: 0.45159170031547546, gen p mean: -0.03957227244973183, mean p set: 0.45207199454307556The modified gen p mean: 0.4504881501197815, gen p mean: -0.03469280153512955, mean p set: 0.4509684145450592
loss_pred:0.01640486530959606, decouple_loss:0.0014889989979565144
loss_pred:0.016789330169558525, decouple_loss:0.0013414047425612807
2023-05-01 16:10:17 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04812666401267052, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04413200169801712, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04421158879995346, mean p set: 0.45035696029663086
loss_pred:0.018874546512961388, decouple_loss:0.0011558074038475752
loss_pred:0.017818009480834007, decouple_loss:0.0011676897993311286
loss_pred:0.017695780843496323, decouple_loss:0.0011601082514971495
WV_0_PC_1_EH_0_PS_40, loss: 0.01818750612437725, avg_mse: 0.02634059637784958
current test mse: 0.026341
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500882923603058, gen p mean: -0.03663185238838196, mean p set: 0.4505685865879059
The modified gen p mean: 0.44895100593566895, gen p mean: -0.03673125430941582, mean p set: 0.44943130016326904
loss_pred:0.01711106486618519, decouple_loss:0.0012549684615805745
The modified gen p mean: 0.4494132697582245, gen p mean: -0.042297445237636566, mean p set: 0.4498935639858246
loss_pred:0.01660630665719509, decouple_loss:0.0012172901770099998
loss_pred:0.016465332359075546, decouple_loss:0.0011895979987457395
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509523808956146, gen p mean: -0.03829440474510193, mean p set: 0.4514326751232147
loss_pred:0.015975166112184525, decouple_loss:0.0012003181036561728
The modified gen p mean: 0.45075684785842896, gen p mean: -0.038695137947797775, mean p set: 0.45123711228370667The modified gen p mean: 0.45193350315093994, gen p mean: -0.03574161231517792, mean p set: 0.45241379737854004
loss_pred:0.016997450962662697, decouple_loss:0.0010918420739471912
loss_pred:0.016315855085849762, decouple_loss:0.0011461869580671191
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838088750839233, gen p mean: -0.03760404884815216, mean p set: 0.44886115193367004
The modified gen p mean: 0.45214927196502686, gen p mean: -0.03999815136194229, mean p set: 0.45262953639030457
loss_pred:0.01615891046822071, decouple_loss:0.0011480204993858933
loss_pred:0.0162079855799675, decouple_loss:0.0011985939927399158
The modified gen p mean: 0.4511227011680603, gen p mean: -0.03969336301088333, mean p set: 0.4516029953956604
loss_pred:0.01621890254318714, decouple_loss:0.0011830729199573398
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493039548397064, gen p mean: -0.04284127429127693, mean p set: 0.4497842490673065
loss_pred:0.015864353626966476, decouple_loss:0.0011970908381044865
The modified gen p mean: 0.4495488703250885, gen p mean: -0.0376615896821022, mean p set: 0.4500291645526886The modified gen p mean: 0.44911232590675354, gen p mean: -0.04693484678864479, mean p set: 0.449592649936676
loss_pred:0.015638254582881927, decouple_loss:0.0011933163041248918
loss_pred:0.015872547402977943, decouple_loss:0.001099477056413889
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483855068683624, gen p mean: -0.036394257098436356, mean p set: 0.4488658010959625
loss_pred:0.0161416158080101, decouple_loss:0.0012353089405223727
The modified gen p mean: 0.45020654797554016, gen p mean: -0.043132901191711426, mean p set: 0.45068684220314026The modified gen p mean: 0.4501641094684601, gen p mean: -0.032694458961486816, mean p set: 0.4506444036960602
loss_pred:0.015593551099300385, decouple_loss:0.001235635601915419
loss_pred:0.015749193727970123, decouple_loss:0.00121049873996526
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45067375898361206, gen p mean: -0.043383218348026276, mean p set: 0.45115405321121216
The modified gen p mean: 0.4499701261520386, gen p mean: -0.03756605461239815, mean p set: 0.45045042037963867
loss_pred:0.015430335886776447, decouple_loss:0.0011055844370275736
loss_pred:0.0161038339138031, decouple_loss:0.0011440314119681716
The modified gen p mean: 0.4491910934448242, gen p mean: -0.03657461702823639, mean p set: 0.4496713876724243
loss_pred:0.016171975061297417, decouple_loss:0.0010985920671373606
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896262884140015, gen p mean: -0.036673784255981445, mean p set: 0.44944292306900024
The modified gen p mean: 0.4497401714324951, gen p mean: -0.038209494203329086, mean p set: 0.4502204656600952
loss_pred:0.015346904285252094, decouple_loss:0.0010491607245057821
loss_pred:0.015598209574818611, decouple_loss:0.0010621306719258428
The modified gen p mean: 0.4499249756336212, gen p mean: -0.029226236045360565, mean p set: 0.4504052996635437
loss_pred:0.01589994505047798, decouple_loss:0.0011070962063968182
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506820738315582, gen p mean: -0.034364789724349976, mean p set: 0.45116233825683594
The modified gen p mean: 0.451831579208374, gen p mean: -0.03302063047885895, mean p set: 0.4523118734359741
loss_pred:0.016000866889953613, decouple_loss:0.001308200997300446
loss_pred:0.01599651575088501, decouple_loss:0.0012429155176505446
The modified gen p mean: 0.4495244026184082, gen p mean: -0.03323397785425186, mean p set: 0.4500047266483307
loss_pred:0.01599574089050293, decouple_loss:0.001279854797758162
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45103469491004944, gen p mean: -0.03822191059589386, mean p set: 0.45151498913764954
The modified gen p mean: 0.45033106207847595, gen p mean: -0.040984924882650375, mean p set: 0.45081138610839844
loss_pred:0.01631256379187107, decouple_loss:0.0011867056600749493
loss_pred:0.015919670462608337, decouple_loss:0.00114499032497406
The modified gen p mean: 0.45135101675987244, gen p mean: -0.039456792175769806, mean p set: 0.45183131098747253
loss_pred:0.014857567846775055, decouple_loss:0.0011010741582140326
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500146210193634, gen p mean: -0.033274706453084946, mean p set: 0.4504949152469635
The modified gen p mean: 0.44981467723846436, gen p mean: -0.03448832035064697, mean p set: 0.45029497146606445
loss_pred:0.015946153551340103, decouple_loss:0.0012188039254397154
loss_pred:0.01561583112925291, decouple_loss:0.001263241982087493
The modified gen p mean: 0.44988730549812317, gen p mean: -0.03825721889734268, mean p set: 0.45036759972572327
loss_pred:0.016020163893699646, decouple_loss:0.001128885429352522
2023-05-01 16:12:13 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04753536358475685, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04348694905638695, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.043564170598983765, mean p set: 0.45035696029663086
loss_pred:0.018369223922491074, decouple_loss:0.0011192737147212029
loss_pred:0.017414433881640434, decouple_loss:0.0011114246444776654
loss_pred:0.017269432544708252, decouple_loss:0.0011455545900389552
WV_0_PC_1_EH_0_PS_40, loss: 0.017740635201334953, avg_mse: 0.025456147268414497
current test mse: 0.025456
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499325454235077, gen p mean: -0.0366719551384449, mean p set: 0.4504128098487854
The modified gen p mean: 0.4498765468597412, gen p mean: -0.0377102755010128, mean p set: 0.4503568708896637
loss_pred:0.01592906005680561, decouple_loss:0.0010967158013954759
The modified gen p mean: 0.4490172863006592, gen p mean: -0.03816758096218109, mean p set: 0.4494975507259369
loss_pred:0.01587698981165886, decouple_loss:0.0011058044619858265
loss_pred:0.01584942638874054, decouple_loss:0.0010868475073948503
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450730562210083, gen p mean: -0.037274401634931564, mean p set: 0.4512108564376831
The modified gen p mean: 0.45003724098205566, gen p mean: -0.03890952095389366, mean p set: 0.45051753520965576
loss_pred:0.015658510848879814, decouple_loss:0.0010626843431964517
loss_pred:0.01610546186566353, decouple_loss:0.001097308937460184
The modified gen p mean: 0.450371652841568, gen p mean: -0.03731180727481842, mean p set: 0.4508519768714905
loss_pred:0.014981813728809357, decouple_loss:0.0010494469897821546
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44908955693244934, gen p mean: -0.05012860149145126, mean p set: 0.44956985116004944
loss_pred:0.015561021864414215, decouple_loss:0.0010748030617833138
The modified gen p mean: 0.45062196254730225, gen p mean: -0.04205409437417984, mean p set: 0.45110228657722473The modified gen p mean: 0.44926661252975464, gen p mean: -0.04577383026480675, mean p set: 0.4497469365596771
loss_pred:0.01650433987379074, decouple_loss:0.001170100993476808
loss_pred:0.015714231878519058, decouple_loss:0.001114283106289804
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502185583114624, gen p mean: -0.041013725101947784, mean p set: 0.4506988525390625
loss_pred:0.015765579417347908, decouple_loss:0.0010214481735602021
The modified gen p mean: 0.4490228593349457, gen p mean: -0.04201377183198929, mean p set: 0.4495031237602234The modified gen p mean: 0.4491015374660492, gen p mean: -0.04419497773051262, mean p set: 0.4495818316936493
loss_pred:0.015360472723841667, decouple_loss:0.0010711118811741471
loss_pred:0.016043802723288536, decouple_loss:0.001025310717523098
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45185530185699463, gen p mean: -0.0444721058011055, mean p set: 0.4523356258869171
loss_pred:0.01566496305167675, decouple_loss:0.0010021786438301206
The modified gen p mean: 0.4505167007446289, gen p mean: -0.0437188446521759, mean p set: 0.450996994972229The modified gen p mean: 0.45050111413002014, gen p mean: -0.04635929316282272, mean p set: 0.45098140835762024
loss_pred:0.01593121886253357, decouple_loss:0.0009580716141499579
loss_pred:0.015411813743412495, decouple_loss:0.0010047807591035962
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990262389183044, gen p mean: -0.041845567524433136, mean p set: 0.45038288831710815
loss_pred:0.01629052497446537, decouple_loss:0.0009908020729199052
The modified gen p mean: 0.4500886797904968, gen p mean: -0.04848599433898926, mean p set: 0.4505689740180969The modified gen p mean: 0.45027074217796326, gen p mean: -0.044926390051841736, mean p set: 0.45075103640556335
loss_pred:0.015940235927700996, decouple_loss:0.000985311227850616
loss_pred:0.015584154054522514, decouple_loss:0.000991521286778152
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033037662506104, gen p mean: -0.04758825898170471, mean p set: 0.45081067085266113
loss_pred:0.015608244575560093, decouple_loss:0.0009870728245005012
The modified gen p mean: 0.4501987397670746, gen p mean: -0.04523172229528427, mean p set: 0.4506790041923523The modified gen p mean: 0.44981926679611206, gen p mean: -0.05427863076329231, mean p set: 0.45029953122138977
loss_pred:0.01561879925429821, decouple_loss:0.0009692363091744483
loss_pred:0.01545302290469408, decouple_loss:0.0009980243630707264
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510660469532013, gen p mean: -0.04554677754640579, mean p set: 0.4515463411808014
loss_pred:0.015808390453457832, decouple_loss:0.0010208247695118189
The modified gen p mean: 0.4492405652999878, gen p mean: -0.05161415785551071, mean p set: 0.4497208595275879The modified gen p mean: 0.45027145743370056, gen p mean: -0.04929785802960396, mean p set: 0.45075175166130066
loss_pred:0.016767721623182297, decouple_loss:0.0011758371256291866
loss_pred:0.016084304079413414, decouple_loss:0.0009469056967645884
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513145387172699, gen p mean: -0.04496980085968971, mean p set: 0.45179483294487
loss_pred:0.015805130824446678, decouple_loss:0.0009941173484548926
The modified gen p mean: 0.449672669172287, gen p mean: -0.049506597220897675, mean p set: 0.4501529335975647The modified gen p mean: 0.44979915022850037, gen p mean: -0.05223671346902847, mean p set: 0.45027947425842285
loss_pred:0.015421337448060513, decouple_loss:0.0010347443167120218
loss_pred:0.015441070310771465, decouple_loss:0.0010045911185443401
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
NaN value num: 0
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472469985485077, gen p mean: -0.05765984579920769, mean p set: 0.4477272629737854
loss_pred:0.016593974083662033, decouple_loss:0.0011739216279238462
The modified gen p mean: 0.44816645979881287, gen p mean: -0.05487588420510292, mean p set: 0.4486467242240906The modified gen p mean: 0.44835206866264343, gen p mean: -0.055390991270542145, mean p set: 0.44883236289024353
loss_pred:0.016838405281305313, decouple_loss:0.001134800841100514
loss_pred:0.01710353046655655, decouple_loss:0.0011666491627693176
2023-05-01 16:14:48 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.055876459926366806, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05173026770353317, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.051773231476545334, mean p set: 0.45035696029663086
loss_pred:0.018282964825630188, decouple_loss:0.001145647489465773
loss_pred:0.017337771132588387, decouple_loss:0.0010350481607019901loss_pred:0.01717076636850834, decouple_loss:0.0010291083017364144
WV_0_PC_1_EH_0_PS_40, loss: 0.01765066385269165, avg_mse: 0.02530110441148281
current test mse: 0.025301
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475497603416443, gen p mean: -0.052265677601099014, mean p set: 0.4480300843715668
loss_pred:0.016015714034438133, decouple_loss:0.0010404324857518077
The modified gen p mean: 0.44946858286857605, gen p mean: -0.05596538260579109, mean p set: 0.44994887709617615The modified gen p mean: 0.44687747955322266, gen p mean: -0.05616537481546402, mean p set: 0.44735774397850037
loss_pred:0.016322379931807518, decouple_loss:0.0010174281196668744loss_pred:0.016474884003400803, decouple_loss:0.0010382633190602064
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699928164482117, gen p mean: -0.0540924072265625, mean p set: 0.44747960567474365
loss_pred:0.01572224125266075, decouple_loss:0.0010708642657846212
The modified gen p mean: 0.44775670766830444, gen p mean: -0.055066969245672226, mean p set: 0.44823703169822693The modified gen p mean: 0.44791364669799805, gen p mean: -0.05168020352721214, mean p set: 0.44839391112327576
loss_pred:0.018039990216493607, decouple_loss:0.0010838565649464726
loss_pred:0.015907270833849907, decouple_loss:0.0011772658908739686
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44843438267707825, gen p mean: -0.051660701632499695, mean p set: 0.44891470670700073
loss_pred:0.01597151905298233, decouple_loss:0.0010128533467650414
The modified gen p mean: 0.4480271637439728, gen p mean: -0.04645419493317604, mean p set: 0.4485074579715729The modified gen p mean: 0.4475327730178833, gen p mean: -0.0534600093960762, mean p set: 0.4480130672454834
loss_pred:0.016603780910372734, decouple_loss:0.0010005524381995201
loss_pred:0.016554798930883408, decouple_loss:0.0010637373197823763
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763243198394775, gen p mean: -0.05116261541843414, mean p set: 0.44811269640922546
loss_pred:0.016781270503997803, decouple_loss:0.0010208804160356522
The modified gen p mean: 0.4477536678314209, gen p mean: -0.044085606932640076, mean p set: 0.4482339918613434The modified gen p mean: 0.44749295711517334, gen p mean: -0.051415182650089264, mean p set: 0.44797322154045105
loss_pred:0.016262855380773544, decouple_loss:0.0009811797644942999
loss_pred:0.016915714368224144, decouple_loss:0.000991009990684688
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475827217102051, gen p mean: -0.051033083349466324, mean p set: 0.4480629861354828
loss_pred:0.016847146674990654, decouple_loss:0.0009648145060054958
The modified gen p mean: 0.44752398133277893, gen p mean: -0.0517704077064991, mean p set: 0.44800424575805664The modified gen p mean: 0.4470180869102478, gen p mean: -0.049969498068094254, mean p set: 0.4474983811378479
loss_pred:0.01703702099621296, decouple_loss:0.0010228634346276522
loss_pred:0.015618827193975449, decouple_loss:0.0010323446476832032
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728732109069824, gen p mean: -0.04872439056634903, mean p set: 0.44776758551597595
loss_pred:0.016917338594794273, decouple_loss:0.0009815708035603166
The modified gen p mean: 0.44796356558799744, gen p mean: -0.046778805553913116, mean p set: 0.44844383001327515The modified gen p mean: 0.44746488332748413, gen p mean: -0.04876131936907768, mean p set: 0.4479452073574066
loss_pred:0.015952644869685173, decouple_loss:0.0009650801657699049
loss_pred:0.015797208994627, decouple_loss:0.0011927273590117693
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651171565055847, gen p mean: -0.04793336242437363, mean p set: 0.4469919800758362
loss_pred:0.01774510368704796, decouple_loss:0.001004540710709989
The modified gen p mean: 0.4481637179851532, gen p mean: -0.048078007996082306, mean p set: 0.4486440122127533The modified gen p mean: 0.44960346817970276, gen p mean: -0.04922345653176308, mean p set: 0.45008379220962524
loss_pred:0.015879271551966667, decouple_loss:0.0009712387691251934
loss_pred:0.016835568472743034, decouple_loss:0.0010391920804977417
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798776507377625, gen p mean: -0.051689162850379944, mean p set: 0.44846805930137634
loss_pred:0.016833243891596794, decouple_loss:0.0010057153413072228
The modified gen p mean: 0.449051171541214, gen p mean: -0.04806225746870041, mean p set: 0.4495314955711365The modified gen p mean: 0.4475351572036743, gen p mean: -0.04768400266766548, mean p set: 0.448015421628952
loss_pred:0.016665076836943626, decouple_loss:0.0010357880964875221
loss_pred:0.01563899777829647, decouple_loss:0.0010474282316863537
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479266107082367, gen p mean: -0.047350652515888214, mean p set: 0.4484068751335144
loss_pred:0.016524016857147217, decouple_loss:0.0010397655423730612
The modified gen p mean: 0.44696488976478577, gen p mean: -0.05293062701821327, mean p set: 0.44744521379470825The modified gen p mean: 0.4478885233402252, gen p mean: -0.048473771661520004, mean p set: 0.44836878776550293
loss_pred:0.016446692869067192, decouple_loss:0.0010975502664223313
loss_pred:0.016356930136680603, decouple_loss:0.0009976031724363565
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756072759628296, gen p mean: -0.051669731736183167, mean p set: 0.44804099202156067
loss_pred:0.016582632437348366, decouple_loss:0.0009759603999555111
The modified gen p mean: 0.447560578584671, gen p mean: -0.05309257283806801, mean p set: 0.4480408728122711The modified gen p mean: 0.4468826949596405, gen p mean: -0.05384683609008789, mean p set: 0.4473629891872406
loss_pred:0.01705195941030979, decouple_loss:0.001002704375423491
loss_pred:0.016302527859807014, decouple_loss:0.0009546858491376042
2023-05-01 16:16:43 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05346110463142395, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04932539910078049, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049238041043281555, mean p set: 0.45035696029663086
loss_pred:0.018283557146787643, decouple_loss:0.001050060149282217
loss_pred:0.01728072762489319, decouple_loss:0.0010116200428456068
loss_pred:0.017166372388601303, decouple_loss:0.0010366038186475635
WV_0_PC_1_EH_0_PS_40, loss: 0.01762852445244789, avg_mse: 0.025265876203775406
current test mse: 0.025266
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484841525554657, gen p mean: -0.05599997565150261, mean p set: 0.4489644169807434
loss_pred:0.015946419909596443, decouple_loss:0.0009632831788621843
The modified gen p mean: 0.4468432068824768, gen p mean: -0.05536327138543129, mean p set: 0.4473235011100769The modified gen p mean: 0.4478951692581177, gen p mean: -0.04944142326712608, mean p set: 0.4483754336833954
loss_pred:0.016578752547502518, decouple_loss:0.0009273120085708797
loss_pred:0.017856013029813766, decouple_loss:0.0009499754523858428
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786718487739563, gen p mean: -0.0523325614631176, mean p set: 0.44834744930267334
loss_pred:0.01664721593260765, decouple_loss:0.0010066005634143949
The modified gen p mean: 0.4464336335659027, gen p mean: -0.05221376195549965, mean p set: 0.4469138979911804The modified gen p mean: 0.44786784052848816, gen p mean: -0.05433756113052368, mean p set: 0.44834810495376587
loss_pred:0.017774706706404686, decouple_loss:0.0010249129263684154
loss_pred:0.016361871734261513, decouple_loss:0.001061500865034759
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455285668373108, gen p mean: -0.0505712665617466, mean p set: 0.4460088610649109
loss_pred:0.016490481793880463, decouple_loss:0.0010355997364968061
The modified gen p mean: 0.4478825330734253, gen p mean: -0.05434615537524223, mean p set: 0.4483628571033478The modified gen p mean: 0.446107417345047, gen p mean: -0.052963580936193466, mean p set: 0.4465877413749695
loss_pred:0.01758570224046707, decouple_loss:0.0008885988499969244
loss_pred:0.01639077439904213, decouple_loss:0.0009610750712454319
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484110474586487, gen p mean: -0.05545058101415634, mean p set: 0.4488913118839264
loss_pred:0.016384411603212357, decouple_loss:0.000912017363589257
The modified gen p mean: 0.44828546047210693, gen p mean: -0.05321042239665985, mean p set: 0.44876575469970703The modified gen p mean: 0.44700631499290466, gen p mean: -0.05168356001377106, mean p set: 0.44748660922050476
loss_pred:0.016305582597851753, decouple_loss:0.0008818723144941032
loss_pred:0.015774885192513466, decouple_loss:0.0008525206358171999
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710034132003784, gen p mean: -0.052221059799194336, mean p set: 0.4475806653499603
loss_pred:0.016358422115445137, decouple_loss:0.0009005162282846868
The modified gen p mean: 0.4488181471824646, gen p mean: -0.05156847462058067, mean p set: 0.4492984712123871The modified gen p mean: 0.44710806012153625, gen p mean: -0.05490245670080185, mean p set: 0.44758832454681396
loss_pred:0.015473446808755398, decouple_loss:0.0009467763011343777
loss_pred:0.017877841368317604, decouple_loss:0.0009382640128023922
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476946294307709, gen p mean: -0.053548168390989304, mean p set: 0.44817492365837097
loss_pred:0.015361553058028221, decouple_loss:0.0010269867489114404
The modified gen p mean: 0.4490186870098114, gen p mean: -0.0506373755633831, mean p set: 0.4494989514350891The modified gen p mean: 0.4475783109664917, gen p mean: -0.05669477954506874, mean p set: 0.4480586349964142
loss_pred:0.016162807121872902, decouple_loss:0.0008792576263658702
loss_pred:0.016526399180293083, decouple_loss:0.0009592712740413845
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760170578956604, gen p mean: -0.056435804814100266, mean p set: 0.4480820298194885
loss_pred:0.016441630199551582, decouple_loss:0.0010060647036880255
The modified gen p mean: 0.44840705394744873, gen p mean: -0.05341855809092522, mean p set: 0.4488873779773712The modified gen p mean: 0.44580113887786865, gen p mean: -0.051525428891181946, mean p set: 0.44628140330314636
loss_pred:0.01669423095881939, decouple_loss:0.0009830675553530455
loss_pred:0.016226820647716522, decouple_loss:0.000981403049081564
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469090700149536, gen p mean: -0.05145770683884621, mean p set: 0.4473893940448761
loss_pred:0.01661987230181694, decouple_loss:0.000856648723129183
The modified gen p mean: 0.4476255774497986, gen p mean: -0.04847538471221924, mean p set: 0.4481058716773987The modified gen p mean: 0.44846656918525696, gen p mean: -0.04788930341601372, mean p set: 0.44894686341285706
loss_pred:0.016064947471022606, decouple_loss:0.0008835477055981755
loss_pred:0.016290348023176193, decouple_loss:0.0008506234735250473
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747117161750793, gen p mean: -0.054486002773046494, mean p set: 0.44795146584510803
loss_pred:0.01655411906540394, decouple_loss:0.000851859396789223
The modified gen p mean: 0.4482695758342743, gen p mean: -0.05402669683098793, mean p set: 0.4487498700618744The modified gen p mean: 0.44839930534362793, gen p mean: -0.052153971046209335, mean p set: 0.448879599571228
loss_pred:0.015654075890779495, decouple_loss:0.0008201167802326381
loss_pred:0.01603838987648487, decouple_loss:0.0008633203688077629
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501243233680725, gen p mean: -0.04414388909935951, mean p set: 0.4506046175956726
loss_pred:0.01555607933551073, decouple_loss:0.0009242603555321693
The modified gen p mean: 0.4497798681259155, gen p mean: -0.04793114587664604, mean p set: 0.45026013255119324The modified gen p mean: 0.4496731758117676, gen p mean: -0.04543984681367874, mean p set: 0.4501534700393677
loss_pred:0.015401043929159641, decouple_loss:0.0009340049000456929
loss_pred:0.015530377626419067, decouple_loss:0.0009741989197209477
2023-05-01 16:19:21 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05246569216251373, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04809369146823883, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04797094687819481, mean p set: 0.45035696029663086
loss_pred:0.018261974677443504, decouple_loss:0.0009701890521682799
loss_pred:0.01728358492255211, decouple_loss:0.0010167493019253016
loss_pred:0.017174964770674706, decouple_loss:0.0010554030304774642
WV_0_PC_1_EH_0_PS_40, loss: 0.01762421429157257, avg_mse: 0.025276709347963333
current test mse: 0.025277
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893956184387207, gen p mean: -0.04809862747788429, mean p set: 0.4494198262691498
loss_pred:0.015360378660261631, decouple_loss:0.0010699012782424688
The modified gen p mean: 0.44948598742485046, gen p mean: -0.05204232409596443, mean p set: 0.44996631145477295The modified gen p mean: 0.4480297267436981, gen p mean: -0.05181514471769333, mean p set: 0.44850999116897583
loss_pred:0.01483948528766632, decouple_loss:0.000966794730629772
loss_pred:0.015242272987961769, decouple_loss:0.0010071533033624291
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492860734462738, gen p mean: -0.043330270797014236, mean p set: 0.4497663974761963
loss_pred:0.014839690178632736, decouple_loss:0.0008852690807543695
The modified gen p mean: 0.4493621289730072, gen p mean: -0.04832203686237335, mean p set: 0.4498424530029297The modified gen p mean: 0.4502295255661011, gen p mean: -0.04225979745388031, mean p set: 0.45070981979370117
loss_pred:0.01538950577378273, decouple_loss:0.0009329295717179775
loss_pred:0.015194430947303772, decouple_loss:0.000969982473179698
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449287086725235, gen p mean: -0.04627067968249321, mean p set: 0.4497673809528351
The modified gen p mean: 0.44903799891471863, gen p mean: -0.04850684106349945, mean p set: 0.4495182931423187
loss_pred:0.01504342071712017, decouple_loss:0.0010077869519591331
loss_pred:0.014659132808446884, decouple_loss:0.0010176608338952065
The modified gen p mean: 0.44947436451911926, gen p mean: -0.03950756415724754, mean p set: 0.44995465874671936
loss_pred:0.015018148347735405, decouple_loss:0.0010085824178531766
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919705390930176, gen p mean: -0.0456751249730587, mean p set: 0.44967731833457947
loss_pred:0.014338748529553413, decouple_loss:0.000977241899818182
The modified gen p mean: 0.44911807775497437, gen p mean: -0.039784226566553116, mean p set: 0.44959837198257446The modified gen p mean: 0.44822654128074646, gen p mean: -0.04360079765319824, mean p set: 0.44870686531066895
loss_pred:0.015547187067568302, decouple_loss:0.0010056339669972658
loss_pred:0.015344535931944847, decouple_loss:0.00095331174088642
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858768582344055, gen p mean: -0.042237456887960434, mean p set: 0.44906798005104065
loss_pred:0.01464061439037323, decouple_loss:0.0011535182129591703
The modified gen p mean: 0.44797298312187195, gen p mean: -0.040573205798864365, mean p set: 0.44845327734947205The modified gen p mean: 0.44836920499801636, gen p mean: -0.044050849974155426, mean p set: 0.44884949922561646
loss_pred:0.014988180249929428, decouple_loss:0.0010592773323878646
loss_pred:0.01422947272658348, decouple_loss:0.0011575811076909304
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919630885124207, gen p mean: -0.04006946086883545, mean p set: 0.4496765732765198
loss_pred:0.01483373623341322, decouple_loss:0.0010631221812218428
The modified gen p mean: 0.44803228974342346, gen p mean: -0.03799765184521675, mean p set: 0.44851261377334595The modified gen p mean: 0.44901031255722046, gen p mean: -0.03958435356616974, mean p set: 0.44949063658714294
loss_pred:0.013972481712698936, decouple_loss:0.0009511153912171721
loss_pred:0.01452434528619051, decouple_loss:0.0009930549422279
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492380619049072, gen p mean: -0.0408741794526577, mean p set: 0.4497183561325073
loss_pred:0.01478933822363615, decouple_loss:0.001055047963745892
The modified gen p mean: 0.45082464814186096, gen p mean: -0.03575285151600838, mean p set: 0.45130491256713867The modified gen p mean: 0.4492749571800232, gen p mean: -0.03306162357330322, mean p set: 0.4497552812099457
loss_pred:0.014514573849737644, decouple_loss:0.001000789226964116
loss_pred:0.014536779373884201, decouple_loss:0.00100360915530473
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500034749507904, gen p mean: -0.03817787393927574, mean p set: 0.4504837691783905
loss_pred:0.014584723860025406, decouple_loss:0.0010343700414523482
The modified gen p mean: 0.44846558570861816, gen p mean: -0.04796963557600975, mean p set: 0.4489458501338959The modified gen p mean: 0.4496931731700897, gen p mean: -0.04020243510603905, mean p set: 0.4501734673976898
loss_pred:0.01417000312358141, decouple_loss:0.0011392934247851372
loss_pred:0.01443956047296524, decouple_loss:0.0010247904574498534
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058587193489075, gen p mean: -0.03781319409608841, mean p set: 0.45106619596481323
loss_pred:0.013953828252851963, decouple_loss:0.001064164680428803
The modified gen p mean: 0.4480578303337097, gen p mean: -0.040473923087120056, mean p set: 0.4485381245613098The modified gen p mean: 0.4497874081134796, gen p mean: -0.04324847087264061, mean p set: 0.4502677023410797
loss_pred:0.01503461878746748, decouple_loss:0.0010763861937448382
loss_pred:0.014549199491739273, decouple_loss:0.0010564521653577685
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503858983516693, gen p mean: -0.03669663146138191, mean p set: 0.4508661925792694
loss_pred:0.014463160187005997, decouple_loss:0.0011263939086347818
The modified gen p mean: 0.4492708444595337, gen p mean: -0.043112561106681824, mean p set: 0.4497511684894562The modified gen p mean: 0.4486316740512848, gen p mean: -0.045660797506570816, mean p set: 0.4491119980812073
loss_pred:0.014490919187664986, decouple_loss:0.0010975096374750137
loss_pred:0.014715608209371567, decouple_loss:0.0011353385634720325
2023-05-01 16:21:17 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04767565429210663, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04375522956252098, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044038716703653336, mean p set: 0.45035696029663086
loss_pred:0.019154760986566544, decouple_loss:0.001215857220813632
loss_pred:0.01799766905605793, decouple_loss:0.0011313647264614701
loss_pred:0.01786963827908039, decouple_loss:0.00113739597145468
WV_0_PC_1_EH_0_PS_40, loss: 0.018398767337203026, avg_mse: 0.026722118258476257
current test mse: 0.026722
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943392276763916, gen p mean: -0.042912065982818604, mean p set: 0.44991418719291687
loss_pred:0.01443718746304512, decouple_loss:0.0010986634297296405
The modified gen p mean: 0.4491843283176422, gen p mean: -0.04077080264687538, mean p set: 0.4496645927429199The modified gen p mean: 0.44965624809265137, gen p mean: -0.04505541920661926, mean p set: 0.45013657212257385
loss_pred:0.014344797469675541, decouple_loss:0.0010724002495408058loss_pred:0.014100481756031513, decouple_loss:0.0011097860988229513
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080986618995667, gen p mean: -0.040641020983457565, mean p set: 0.45129016041755676
loss_pred:0.014351870864629745, decouple_loss:0.0011236226418986917
The modified gen p mean: 0.4489181935787201, gen p mean: -0.04499873146414757, mean p set: 0.4493984878063202The modified gen p mean: 0.45090633630752563, gen p mean: -0.0400288924574852, mean p set: 0.45138660073280334
loss_pred:0.014203215949237347, decouple_loss:0.0010935264872387052
loss_pred:0.014498048461973667, decouple_loss:0.001193165429867804
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488588273525238, gen p mean: -0.04158712178468704, mean p set: 0.4493391215801239
loss_pred:0.014358905144035816, decouple_loss:0.0010488961124792695
The modified gen p mean: 0.4502960443496704, gen p mean: -0.035661354660987854, mean p set: 0.4507763385772705The modified gen p mean: 0.4485131502151489, gen p mean: -0.04618366062641144, mean p set: 0.448993444442749
loss_pred:0.014101959764957428, decouple_loss:0.0010610731551423669
loss_pred:0.014234877191483974, decouple_loss:0.0011796938488259912
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501386880874634, gen p mean: -0.03917951136827469, mean p set: 0.4506189823150635
loss_pred:0.014134889468550682, decouple_loss:0.0012256954796612263
The modified gen p mean: 0.4488268494606018, gen p mean: -0.04335936903953552, mean p set: 0.4493071436882019The modified gen p mean: 0.4498368203639984, gen p mean: -0.047126658260822296, mean p set: 0.4503171145915985
loss_pred:0.014482175000011921, decouple_loss:0.0012032317463308573
loss_pred:0.01382104679942131, decouple_loss:0.0011771691497415304
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506630599498749, gen p mean: -0.039161331951618195, mean p set: 0.451143354177475
loss_pred:0.014340387657284737, decouple_loss:0.001112207304686308
The modified gen p mean: 0.4500710964202881, gen p mean: -0.03927856311202049, mean p set: 0.4505513906478882
The modified gen p mean: 0.44860759377479553, gen p mean: -0.04461711272597313, mean p set: 0.44908788800239563
loss_pred:0.013984879478812218, decouple_loss:0.0011059693060815334
loss_pred:0.014724018052220345, decouple_loss:0.00121441506780684
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969239830970764, gen p mean: -0.044598229229450226, mean p set: 0.45017269253730774
loss_pred:0.013907496817409992, decouple_loss:0.0011390710715204477
The modified gen p mean: 0.449203222990036, gen p mean: -0.04664584621787071, mean p set: 0.4496835172176361The modified gen p mean: 0.44837287068367004, gen p mean: -0.040079761296510696, mean p set: 0.44885316491127014
loss_pred:0.014537135139107704, decouple_loss:0.0010982915991917253
loss_pred:0.013911064714193344, decouple_loss:0.001097298925742507
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483937621116638, gen p mean: -0.03883286565542221, mean p set: 0.4488740861415863
loss_pred:0.014320015907287598, decouple_loss:0.001091205165721476
The modified gen p mean: 0.4490286111831665, gen p mean: -0.040412966161966324, mean p set: 0.4495089054107666The modified gen p mean: 0.45011022686958313, gen p mean: -0.036413468420505524, mean p set: 0.4505905210971832
loss_pred:0.01403710339218378, decouple_loss:0.0010980649385601282
loss_pred:0.01417425088584423, decouple_loss:0.0011447981232777238
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44965094327926636, gen p mean: -0.04027721658349037, mean p set: 0.45013123750686646
loss_pred:0.014315677806735039, decouple_loss:0.0011098842369392514
The modified gen p mean: 0.4501873850822449, gen p mean: -0.03839175030589104, mean p set: 0.45066767930984497The modified gen p mean: 0.4487408697605133, gen p mean: -0.048874083906412125, mean p set: 0.449221134185791
loss_pred:0.014550434425473213, decouple_loss:0.00110657699406147
loss_pred:0.013617264106869698, decouple_loss:0.0011870875023305416
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926688075065613, gen p mean: -0.040185507386922836, mean p set: 0.4497471749782562
loss_pred:0.013361821882426739, decouple_loss:0.0009975815191864967
The modified gen p mean: 0.4476586580276489, gen p mean: -0.044122364372015, mean p set: 0.44813892245292664The modified gen p mean: 0.44886115193367004, gen p mean: -0.039641011506319046, mean p set: 0.44934147596359253
loss_pred:0.01478670071810484, decouple_loss:0.0012017115950584412
loss_pred:0.014442717656493187, decouple_loss:0.0011147010372951627
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
NaN value num: 0
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462442994117737, gen p mean: -0.04856197163462639, mean p set: 0.4467245936393738
loss_pred:0.017549311742186546, decouple_loss:0.0012885810574516654
The modified gen p mean: 0.44588515162467957, gen p mean: -0.049191806465387344, mean p set: 0.44636544585227966The modified gen p mean: 0.4456902742385864, gen p mean: -0.04907490313053131, mean p set: 0.4461705982685089
loss_pred:0.01747692935168743, decouple_loss:0.0012898218119516969
loss_pred:0.018176253885030746, decouple_loss:0.0012229846324771643
2023-05-01 16:23:49 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04994562268257141, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04612361639738083, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04625742509961128, mean p set: 0.45035696029663086
loss_pred:0.01896316558122635, decouple_loss:0.0011237120488658547
loss_pred:0.017766308039426804, decouple_loss:0.0011683352058753371
loss_pred:0.017857544124126434, decouple_loss:0.001140446518547833
WV_0_PC_1_EH_0_PS_40, loss: 0.01825288124382496, avg_mse: 0.02647235244512558
current test mse: 0.026472
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694778323173523, gen p mean: -0.04695260524749756, mean p set: 0.4474280774593353
loss_pred:0.017792701721191406, decouple_loss:0.0012882858281955123
The modified gen p mean: 0.448067307472229, gen p mean: -0.046912942081689835, mean p set: 0.4485476016998291The modified gen p mean: 0.4467600882053375, gen p mean: -0.04629286006093025, mean p set: 0.4472403824329376
loss_pred:0.0166704673320055, decouple_loss:0.0012976931175217032
loss_pred:0.017691420391201973, decouple_loss:0.001150683150626719
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454820156097412, gen p mean: -0.050535667687654495, mean p set: 0.4459622800350189
loss_pred:0.017351973801851273, decouple_loss:0.0012672364246100187
The modified gen p mean: 0.446650892496109, gen p mean: -0.0480131134390831, mean p set: 0.4471311867237091The modified gen p mean: 0.4455968141555786, gen p mean: -0.05104203149676323, mean p set: 0.4460771083831787
loss_pred:0.0174221470952034, decouple_loss:0.0012318778317421675
loss_pred:0.01693837344646454, decouple_loss:0.0013576482888311148
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458196461200714, gen p mean: -0.04738543927669525, mean p set: 0.4462999701499939
loss_pred:0.01772017776966095, decouple_loss:0.0011409566504880786
The modified gen p mean: 0.44600093364715576, gen p mean: -0.052743397653102875, mean p set: 0.44648122787475586The modified gen p mean: 0.44690370559692383, gen p mean: -0.05352300778031349, mean p set: 0.4473839998245239
loss_pred:0.016742300242185593, decouple_loss:0.0011484711430966854
loss_pred:0.017540844157338142, decouple_loss:0.001235495787113905
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44811758399009705, gen p mean: -0.04891442134976387, mean p set: 0.44859790802001953
loss_pred:0.016611050814390182, decouple_loss:0.0012894731480628252
The modified gen p mean: 0.44637051224708557, gen p mean: -0.0506536029279232, mean p set: 0.4468507766723633The modified gen p mean: 0.4461541473865509, gen p mean: -0.05106658861041069, mean p set: 0.4466344118118286
loss_pred:0.016656288877129555, decouple_loss:0.0012363445712253451
loss_pred:0.01742035336792469, decouple_loss:0.001284059602767229
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488474428653717, gen p mean: -0.047638289630413055, mean p set: 0.4493277370929718
loss_pred:0.01624320074915886, decouple_loss:0.0011436890345066786
The modified gen p mean: 0.44701701402664185, gen p mean: -0.052245914936065674, mean p set: 0.44749733805656433The modified gen p mean: 0.4464409351348877, gen p mean: -0.052615292370319366, mean p set: 0.4469212293624878
loss_pred:0.017583195120096207, decouple_loss:0.0011747851967811584
loss_pred:0.016779199242591858, decouple_loss:0.0011693408014252782
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685351848602295, gen p mean: -0.04768215864896774, mean p set: 0.44733378291130066
loss_pred:0.017773425206542015, decouple_loss:0.0011955174850299954
The modified gen p mean: 0.4463377296924591, gen p mean: -0.05218823626637459, mean p set: 0.4468180239200592The modified gen p mean: 0.4486481547355652, gen p mean: -0.04766637086868286, mean p set: 0.44912847876548767
loss_pred:0.017191912978887558, decouple_loss:0.0012496871640905738
loss_pred:0.01635514199733734, decouple_loss:0.0011635258561000228
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696301221847534, gen p mean: -0.0493009090423584, mean p set: 0.44744330644607544
loss_pred:0.016577929258346558, decouple_loss:0.0011265514185652137
The modified gen p mean: 0.4462193548679352, gen p mean: -0.0467832013964653, mean p set: 0.4466996490955353The modified gen p mean: 0.4459577202796936, gen p mean: -0.04726549610495567, mean p set: 0.4464380145072937
loss_pred:0.01749294437468052, decouple_loss:0.001147130853496492
loss_pred:0.016450058668851852, decouple_loss:0.0011630753288045526
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468127191066742, gen p mean: -0.04550585150718689, mean p set: 0.4472929835319519
loss_pred:0.016401657834649086, decouple_loss:0.0010737866396084428
The modified gen p mean: 0.4472256004810333, gen p mean: -0.045814696699380875, mean p set: 0.44770586490631104The modified gen p mean: 0.44582054018974304, gen p mean: -0.04550175368785858, mean p set: 0.44630083441734314
loss_pred:0.016710760071873665, decouple_loss:0.0011162188602611423
loss_pred:0.017261119559407234, decouple_loss:0.00115240179002285
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447514146566391, gen p mean: -0.04379310458898544, mean p set: 0.4479944705963135
loss_pred:0.017163800075650215, decouple_loss:0.001263780053704977
The modified gen p mean: 0.445686012506485, gen p mean: -0.042884353548288345, mean p set: 0.4461663067340851The modified gen p mean: 0.44573476910591125, gen p mean: -0.04457942396402359, mean p set: 0.44621503353118896
loss_pred:0.01714329421520233, decouple_loss:0.0011616238625720143
loss_pred:0.016842389479279518, decouple_loss:0.0010546883568167686
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463348984718323, gen p mean: -0.04285403713583946, mean p set: 0.4468151926994324
loss_pred:0.01680823415517807, decouple_loss:0.0010999934747815132
The modified gen p mean: 0.44793447852134705, gen p mean: -0.05044502392411232, mean p set: 0.44841480255126953The modified gen p mean: 0.44563257694244385, gen p mean: -0.04409234598278999, mean p set: 0.44611287117004395
loss_pred:0.016008183360099792, decouple_loss:0.0011383525561541319
loss_pred:0.017253078520298004, decouple_loss:0.0011470098979771137
2023-05-01 16:25:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04769504815340042, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.043671611696481705, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04378962516784668, mean p set: 0.45035696029663086
loss_pred:0.01836954802274704, decouple_loss:0.001106465351767838
loss_pred:0.017410947009921074, decouple_loss:0.0011678747832775116loss_pred:0.017264174297451973, decouple_loss:0.001204360625706613
WV_0_PC_1_EH_0_PS_40, loss: 0.017739534378051758, avg_mse: 0.025458507239818573
current test mse: 0.025459
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465961754322052, gen p mean: -0.04347943514585495, mean p set: 0.4470764696598053
loss_pred:0.016895515844225883, decouple_loss:0.0010832548141479492
The modified gen p mean: 0.44586384296417236, gen p mean: -0.04476746916770935, mean p set: 0.44634416699409485
The modified gen p mean: 0.44712796807289124, gen p mean: -0.053180620074272156, mean p set: 0.44760826230049133
loss_pred:0.016995400190353394, decouple_loss:0.0010943138040602207
loss_pred:0.016766058281064034, decouple_loss:0.0010995946358889341
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44578954577445984, gen p mean: -0.04522925987839699, mean p set: 0.44626984000205994
loss_pred:0.017251266166567802, decouple_loss:0.001068353420123458
The modified gen p mean: 0.4474918842315674, gen p mean: -0.04627629742026329, mean p set: 0.4479721784591675The modified gen p mean: 0.44619181752204895, gen p mean: -0.04551476612687111, mean p set: 0.44667208194732666
loss_pred:0.016293315216898918, decouple_loss:0.0010254825465381145
loss_pred:0.016821276396512985, decouple_loss:0.0010431647533550858
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469824731349945, gen p mean: -0.049478914588689804, mean p set: 0.4474627375602722
loss_pred:0.01737090013921261, decouple_loss:0.0011369296116754413
The modified gen p mean: 0.44824230670928955, gen p mean: -0.0551258847117424, mean p set: 0.44872260093688965The modified gen p mean: 0.44628211855888367, gen p mean: -0.04976502060890198, mean p set: 0.4467623829841614
loss_pred:0.016143683344125748, decouple_loss:0.0011775791645050049
loss_pred:0.017531145364046097, decouple_loss:0.0011118423426523805
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649001955986023, gen p mean: -0.051664113998413086, mean p set: 0.4469703137874603
loss_pred:0.01698828488588333, decouple_loss:0.001019371789880097
The modified gen p mean: 0.44668063521385193, gen p mean: -0.05236772075295448, mean p set: 0.44716089963912964The modified gen p mean: 0.446490615606308, gen p mean: -0.05278477445244789, mean p set: 0.4469709098339081
loss_pred:0.016620753332972527, decouple_loss:0.0009611760615371168
loss_pred:0.016657277941703796, decouple_loss:0.0009566418593749404
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461958110332489, gen p mean: -0.0592450313270092, mean p set: 0.4466760754585266
loss_pred:0.01684683747589588, decouple_loss:0.0010073322337120771
The modified gen p mean: 0.44762691855430603, gen p mean: -0.0596751943230629, mean p set: 0.44810721278190613The modified gen p mean: 0.4463740587234497, gen p mean: -0.0577474944293499, mean p set: 0.4468543529510498
loss_pred:0.016331465914845467, decouple_loss:0.0010980950901284814
loss_pred:0.01711217127740383, decouple_loss:0.0010200132383033633
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475557506084442, gen p mean: -0.056598179042339325, mean p set: 0.4480360448360443
loss_pred:0.016429267823696136, decouple_loss:0.0010019694454967976
The modified gen p mean: 0.4468720257282257, gen p mean: -0.0586727149784565, mean p set: 0.4473523199558258The modified gen p mean: 0.44680672883987427, gen p mean: -0.06194223463535309, mean p set: 0.44728702306747437
loss_pred:0.0162204597145319, decouple_loss:0.0010397100122645497
loss_pred:0.016836775466799736, decouple_loss:0.0010364162735641003
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456685483455658, gen p mean: -0.05516127496957779, mean p set: 0.4461488425731659
loss_pred:0.016835158690810204, decouple_loss:0.0010173782939091325
The modified gen p mean: 0.44609305262565613, gen p mean: -0.05752016603946686, mean p set: 0.4465733468532562The modified gen p mean: 0.44646114110946655, gen p mean: -0.05300666764378548, mean p set: 0.44694146513938904
loss_pred:0.01690063439309597, decouple_loss:0.0009848927147686481
loss_pred:0.016677143052220345, decouple_loss:0.0009448513737879694
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469850957393646, gen p mean: -0.060467369854450226, mean p set: 0.4474653899669647
loss_pred:0.01712164096534252, decouple_loss:0.0009812937350943685
The modified gen p mean: 0.4474465847015381, gen p mean: -0.060009103268384933, mean p set: 0.44792690873146057The modified gen p mean: 0.44659650325775146, gen p mean: -0.05899325758218765, mean p set: 0.44707679748535156
loss_pred:0.016691837459802628, decouple_loss:0.0010045734234154224
loss_pred:0.01693151146173477, decouple_loss:0.001022512442432344
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459913671016693, gen p mean: -0.0578562393784523, mean p set: 0.4464716613292694
loss_pred:0.016237478703260422, decouple_loss:0.0009785646107047796
The modified gen p mean: 0.44643571972846985, gen p mean: -0.056132324039936066, mean p set: 0.44691601395606995The modified gen p mean: 0.44629260897636414, gen p mean: -0.05829785391688347, mean p set: 0.44677287340164185
loss_pred:0.017234306782484055, decouple_loss:0.0009510538075119257
loss_pred:0.01709168590605259, decouple_loss:0.0010127534624189138
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
NaN value num: 0
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904500246047974, gen p mean: -0.05276663973927498, mean p set: 0.44952526688575745
loss_pred:0.016175994649529457, decouple_loss:0.0009219303610734642
The modified gen p mean: 0.4459381699562073, gen p mean: -0.05415571853518486, mean p set: 0.446418434381485The modified gen p mean: 0.446571409702301, gen p mean: -0.050670698285102844, mean p set: 0.4470517337322235
loss_pred:0.01680517941713333, decouple_loss:0.00088324467651546
loss_pred:0.016491340473294258, decouple_loss:0.000942530226893723
2023-05-01 16:28:19 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05506905913352966, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05121332034468651, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0512578971683979, mean p set: 0.45035696029663086
loss_pred:0.018221180886030197, decouple_loss:0.0009776324732229114
loss_pred:0.01726550981402397, decouple_loss:0.000984457554295659loss_pred:0.017197366803884506, decouple_loss:0.000996374641545117
WV_0_PC_1_EH_0_PS_40, loss: 0.017610659822821617, avg_mse: 0.02524680085480213
current test mse: 0.025247
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463096857070923, gen p mean: -0.05338747426867485, mean p set: 0.44678995013237
loss_pred:0.016757091507315636, decouple_loss:0.000972133013419807
The modified gen p mean: 0.44722530245780945, gen p mean: -0.05233539268374443, mean p set: 0.44770559668540955The modified gen p mean: 0.4460093677043915, gen p mean: -0.053998030722141266, mean p set: 0.4464896619319916
loss_pred:0.01630757935345173, decouple_loss:0.0009917058050632477loss_pred:0.016286035999655724, decouple_loss:0.0009777265368029475
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733694195747375, gen p mean: -0.05221867561340332, mean p set: 0.44781720638275146
loss_pred:0.016511162742972374, decouple_loss:0.0009286458953283727
The modified gen p mean: 0.44807305932044983, gen p mean: -0.05252678692340851, mean p set: 0.4485533535480499The modified gen p mean: 0.44680696725845337, gen p mean: -0.05556792393326759, mean p set: 0.44728726148605347
loss_pred:0.016746846958994865, decouple_loss:0.0010040623601526022
loss_pred:0.015851523727178574, decouple_loss:0.000947119202464819
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939735531806946, gen p mean: -0.054570890963077545, mean p set: 0.44987761974334717
loss_pred:0.016253041103482246, decouple_loss:0.0009018348646350205
The modified gen p mean: 0.44540107250213623, gen p mean: -0.05165413022041321, mean p set: 0.44588136672973633The modified gen p mean: 0.44636714458465576, gen p mean: -0.049916379153728485, mean p set: 0.44684743881225586
loss_pred:0.016970301046967506, decouple_loss:0.0008825291879475117
loss_pred:0.016654664650559425, decouple_loss:0.0008755291346460581
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458862543106079, gen p mean: -0.05475165694952011, mean p set: 0.446366548538208
loss_pred:0.01618405058979988, decouple_loss:0.0008994150557555258
The modified gen p mean: 0.4464878439903259, gen p mean: -0.05085575208067894, mean p set: 0.446968138217926The modified gen p mean: 0.44915899634361267, gen p mean: -0.05383848398923874, mean p set: 0.44963929057121277
loss_pred:0.016656065359711647, decouple_loss:0.0008449042215943336
loss_pred:0.016686663031578064, decouple_loss:0.0009192583383992314
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459202289581299, gen p mean: -0.05375625938177109, mean p set: 0.44640052318573
loss_pred:0.016000809147953987, decouple_loss:0.0008931686752475798
The modified gen p mean: 0.44810542464256287, gen p mean: -0.051969993859529495, mean p set: 0.44858571887016296The modified gen p mean: 0.44680359959602356, gen p mean: -0.04978857561945915, mean p set: 0.44728389382362366
loss_pred:0.01672104373574257, decouple_loss:0.0009585185907781124
loss_pred:0.016716625541448593, decouple_loss:0.0008815597393549979
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456835389137268, gen p mean: -0.053238317370414734, mean p set: 0.4461638331413269
loss_pred:0.016230566427111626, decouple_loss:0.000902136554941535
The modified gen p mean: 0.4464147090911865, gen p mean: -0.05624023824930191, mean p set: 0.4468950033187866The modified gen p mean: 0.4456712305545807, gen p mean: -0.04863552004098892, mean p set: 0.4461515247821808
loss_pred:0.01591147668659687, decouple_loss:0.0008596149855293334
loss_pred:0.015889747068285942, decouple_loss:0.0008811160805635154
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482898712158203, gen p mean: -0.056208688765764236, mean p set: 0.4487701654434204
The modified gen p mean: 0.44609618186950684, gen p mean: -0.05524716153740883, mean p set: 0.44657647609710693
loss_pred:0.016279783099889755, decouple_loss:0.0008950491319410503
loss_pred:0.01583433896303177, decouple_loss:0.000882272666785866
The modified gen p mean: 0.4482974708080292, gen p mean: -0.050296057015657425, mean p set: 0.4487777352333069
loss_pred:0.016898732632398605, decouple_loss:0.0008818650967441499
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473434090614319, gen p mean: -0.05284183844923973, mean p set: 0.4478236734867096
The modified gen p mean: 0.4472513794898987, gen p mean: -0.054257795214653015, mean p set: 0.4477316439151764
loss_pred:0.016799239441752434, decouple_loss:0.0009126822114922106
loss_pred:0.016274362802505493, decouple_loss:0.000907551555428654The modified gen p mean: 0.44878455996513367, gen p mean: -0.05754301697015762, mean p set: 0.44926485419273376
loss_pred:0.016643011942505836, decouple_loss:0.000928638270124793
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453831911087036, gen p mean: -0.05800682678818703, mean p set: 0.4458634853363037
The modified gen p mean: 0.44870543479919434, gen p mean: -0.05130273476243019, mean p set: 0.44918572902679443
loss_pred:0.01559121161699295, decouple_loss:0.0008991135400719941
loss_pred:0.016661355271935463, decouple_loss:0.0009466188494116068
The modified gen p mean: 0.4488806128501892, gen p mean: -0.05015585944056511, mean p set: 0.4493609070777893
loss_pred:0.016986822709441185, decouple_loss:0.0008438419317826629
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446050226688385, gen p mean: -0.05005640536546707, mean p set: 0.4465305209159851
The modified gen p mean: 0.4462381899356842, gen p mean: -0.05252472311258316, mean p set: 0.4467185139656067
loss_pred:0.0163587536662817, decouple_loss:0.0009021275909617543
loss_pred:0.016695449128746986, decouple_loss:0.0008536751265637577
The modified gen p mean: 0.44793540239334106, gen p mean: -0.06005745008587837, mean p set: 0.4484156668186188
loss_pred:0.015668408945202827, decouple_loss:0.0008625967893749475
2023-05-01 16:30:15 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05690363794565201, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.053021084517240524, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05301888659596443, mean p set: 0.45035696029663086
loss_pred:0.01826183684170246, decouple_loss:0.0010195747017860413
loss_pred:0.017265159636735916, decouple_loss:0.0009705503471195698
loss_pred:0.0171860009431839, decouple_loss:0.0010047779651358724
WV_0_PC_1_EH_0_PS_40, loss: 0.017620913684368134, avg_mse: 0.02526955120265484
current test mse: 0.02527
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447072833776474, gen p mean: -0.0537107028067112, mean p set: 0.4475530982017517
loss_pred:0.016753848642110825, decouple_loss:0.0010605750139802694
The modified gen p mean: 0.44666028022766113, gen p mean: -0.0561758354306221, mean p set: 0.44714057445526123The modified gen p mean: 0.44729194045066833, gen p mean: -0.053422458469867706, mean p set: 0.44777223467826843
loss_pred:0.016561446711421013, decouple_loss:0.0009627171675674617
loss_pred:0.016597578302025795, decouple_loss:0.0009895473485812545
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633185863494873, gen p mean: -0.05622183158993721, mean p set: 0.44681212306022644
loss_pred:0.016643347218632698, decouple_loss:0.0008951518102549016
The modified gen p mean: 0.4471910297870636, gen p mean: -0.05378793925046921, mean p set: 0.4476713538169861
The modified gen p mean: 0.44712579250335693, gen p mean: -0.05275997892022133, mean p set: 0.44760608673095703
loss_pred:0.01662564091384411, decouple_loss:0.0009746832074597478
loss_pred:0.016067154705524445, decouple_loss:0.0009731841855682433
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464940130710602, gen p mean: -0.05190423130989075, mean p set: 0.4469743072986603
loss_pred:0.016694290563464165, decouple_loss:0.0009133522980846465
The modified gen p mean: 0.4464987814426422, gen p mean: -0.048964954912662506, mean p set: 0.4469790756702423The modified gen p mean: 0.4483083188533783, gen p mean: -0.04967870935797691, mean p set: 0.4487886130809784
loss_pred:0.016724305227398872, decouple_loss:0.0008529768674634397
loss_pred:0.01607203111052513, decouple_loss:0.001011005020700395
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44568878412246704, gen p mean: -0.055337317287921906, mean p set: 0.4461691081523895
loss_pred:0.0163288377225399, decouple_loss:0.0009738262742757797
The modified gen p mean: 0.44823578000068665, gen p mean: -0.04869493469595909, mean p set: 0.44871607422828674
The modified gen p mean: 0.4471195936203003, gen p mean: -0.05171714723110199, mean p set: 0.4475998878479004
loss_pred:0.016567867249250412, decouple_loss:0.0009148018434643745
loss_pred:0.016984082758426666, decouple_loss:0.000999842886812985
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44632381200790405, gen p mean: -0.04800233244895935, mean p set: 0.44680410623550415
loss_pred:0.01603066176176071, decouple_loss:0.0009425144526176155
The modified gen p mean: 0.44561290740966797, gen p mean: -0.050109729170799255, mean p set: 0.44609320163726807The modified gen p mean: 0.44593241810798645, gen p mean: -0.05267766863107681, mean p set: 0.44641271233558655
loss_pred:0.015975454822182655, decouple_loss:0.0009225895046256483
loss_pred:0.015255283564329147, decouple_loss:0.000948364264331758
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446638286113739, gen p mean: -0.0529971569776535, mean p set: 0.4471185803413391
The modified gen p mean: 0.4475814700126648, gen p mean: -0.05219670385122299, mean p set: 0.4480617940425873
loss_pred:0.01581793650984764, decouple_loss:0.0010396807920187712
loss_pred:0.016793768852949142, decouple_loss:0.0009590615518391132
The modified gen p mean: 0.44679054617881775, gen p mean: -0.0525980144739151, mean p set: 0.44727084040641785
loss_pred:0.01622789539396763, decouple_loss:0.0009576941374689341
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477458596229553, gen p mean: -0.05426870658993721, mean p set: 0.4482261538505554
loss_pred:0.015634074807167053, decouple_loss:0.001006162608973682
The modified gen p mean: 0.44538143277168274, gen p mean: -0.05287032201886177, mean p set: 0.44586169719696045The modified gen p mean: 0.44714638590812683, gen p mean: -0.04946929216384888, mean p set: 0.4476267099380493
loss_pred:0.016761263832449913, decouple_loss:0.0009286168497055769
loss_pred:0.016074949875473976, decouple_loss:0.0009784962749108672
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475260376930237, gen p mean: -0.05503574758768082, mean p set: 0.4480063021183014
loss_pred:0.015542631037533283, decouple_loss:0.0009151541744358838
The modified gen p mean: 0.44616612792015076, gen p mean: -0.05218110978603363, mean p set: 0.44664642214775085The modified gen p mean: 0.4475783109664917, gen p mean: -0.052801527082920074, mean p set: 0.4480586051940918
loss_pred:0.01626410521566868, decouple_loss:0.0009173642611131072
loss_pred:0.016417017206549644, decouple_loss:0.0009259500657208264
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473308324813843, gen p mean: -0.05105229839682579, mean p set: 0.447811096906662
loss_pred:0.015921233221888542, decouple_loss:0.0009308556909672916
The modified gen p mean: 0.44588375091552734, gen p mean: -0.049545418471097946, mean p set: 0.44636404514312744The modified gen p mean: 0.44707542657852173, gen p mean: -0.05107223987579346, mean p set: 0.4475557208061218
loss_pred:0.015904748812317848, decouple_loss:0.0008968003676272929
loss_pred:0.016685089096426964, decouple_loss:0.0008808497805148363
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
NaN value num: 0
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44652047753334045, gen p mean: -0.047670140862464905, mean p set: 0.44700080156326294
loss_pred:0.01763860695064068, decouple_loss:0.0008798757917247713
The modified gen p mean: 0.4483500123023987, gen p mean: -0.04778117313981056, mean p set: 0.4488303065299988The modified gen p mean: 0.44672706723213196, gen p mean: -0.04496343433856964, mean p set: 0.44720733165740967
loss_pred:0.01646512560546398, decouple_loss:0.0009309328743256629
loss_pred:0.016879891976714134, decouple_loss:0.0008926914306357503
2023-05-01 16:32:52 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05441669002175331, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05047387257218361, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050458747893571854, mean p set: 0.45035696029663086
loss_pred:0.018291084095835686, decouple_loss:0.0009397617541253567
loss_pred:0.01733289286494255, decouple_loss:0.0009311930043622851
loss_pred:0.01723058894276619, decouple_loss:0.0009526802459731698
WV_0_PC_1_EH_0_PS_40, loss: 0.017665250226855278, avg_mse: 0.025340909138321877
current test mse: 0.025341
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44899240136146545, gen p mean: -0.047279275953769684, mean p set: 0.44947269558906555
The modified gen p mean: 0.44772711396217346, gen p mean: -0.052836354821920395, mean p set: 0.44820740818977356
The modified gen p mean: 0.44583308696746826, gen p mean: -0.054742902517318726, mean p set: 0.44631341099739075
loss_pred:0.01658865250647068, decouple_loss:0.0009805754525586963
loss_pred:0.0168671403080225, decouple_loss:0.0009246726403944194
loss_pred:0.017548246309161186, decouple_loss:0.0009751425823196769
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481064975261688, gen p mean: -0.05452611297369003, mean p set: 0.4485867917537689
The modified gen p mean: 0.44889065623283386, gen p mean: -0.04778846725821495, mean p set: 0.44937095046043396
loss_pred:0.016728805378079414, decouple_loss:0.0009089709492400289
loss_pred:0.016887836158275604, decouple_loss:0.000896116835065186
The modified gen p mean: 0.44760385155677795, gen p mean: -0.05121493339538574, mean p set: 0.44808417558670044
loss_pred:0.017385931685566902, decouple_loss:0.0009430996142327785
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820618629455566, gen p mean: -0.04983391985297203, mean p set: 0.44868648052215576
The modified gen p mean: 0.44826894998550415, gen p mean: -0.05080292001366615, mean p set: 0.44874924421310425
loss_pred:0.016303297132253647, decouple_loss:0.0009429683559574187
loss_pred:0.01614987477660179, decouple_loss:0.0009530014940537512
The modified gen p mean: 0.44676050543785095, gen p mean: -0.05430354177951813, mean p set: 0.44724079966545105
loss_pred:0.017591895535588264, decouple_loss:0.0008785916143096983
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906744360923767, gen p mean: -0.052149929106235504, mean p set: 0.4495477080345154
The modified gen p mean: 0.4473567008972168, gen p mean: -0.04988718777894974, mean p set: 0.4478370249271393
The modified gen p mean: 0.4480680525302887, gen p mean: -0.05947708711028099, mean p set: 0.4485483467578888
loss_pred:0.01637003757059574, decouple_loss:0.0009571784175932407
loss_pred:0.017009936273097992, decouple_loss:0.0009643537923693657loss_pred:0.017033599317073822, decouple_loss:0.0011164433090016246
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475128948688507, gen p mean: -0.04986061900854111, mean p set: 0.4479931592941284
The modified gen p mean: 0.4474814534187317, gen p mean: -0.04909780994057655, mean p set: 0.4479617476463318
loss_pred:0.01618628203868866, decouple_loss:0.0009604803053662181
loss_pred:0.016251159831881523, decouple_loss:0.0009451305959373713
The modified gen p mean: 0.44806066155433655, gen p mean: -0.058245766907930374, mean p set: 0.44854092597961426
loss_pred:0.01700865663588047, decouple_loss:0.000992072862572968
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477001428604126, gen p mean: -0.04995124787092209, mean p set: 0.4481804668903351
The modified gen p mean: 0.44777607917785645, gen p mean: -0.053351324051618576, mean p set: 0.44825637340545654
loss_pred:0.01665591076016426, decouple_loss:0.0010374912526458502
loss_pred:0.016467353329062462, decouple_loss:0.0010432708077132702
The modified gen p mean: 0.4476563036441803, gen p mean: -0.05076878145337105, mean p set: 0.4481366276741028
loss_pred:0.016270656138658524, decouple_loss:0.0009124393109232187
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850054383277893, gen p mean: -0.05399826541543007, mean p set: 0.44898083806037903
The modified gen p mean: 0.44722896814346313, gen p mean: -0.05312943831086159, mean p set: 0.44770923256874084loss_pred:0.01681247167289257, decouple_loss:0.0011129938066005707
The modified gen p mean: 0.4467003345489502, gen p mean: -0.05557830259203911, mean p set: 0.4471806287765503
loss_pred:0.01732521504163742, decouple_loss:0.0011374983005225658
loss_pred:0.017043542116880417, decouple_loss:0.0011202399618923664
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482826292514801, gen p mean: -0.05983841419219971, mean p set: 0.4487628936767578
The modified gen p mean: 0.44796857237815857, gen p mean: -0.05805426836013794, mean p set: 0.4484488368034363
loss_pred:0.016980387270450592, decouple_loss:0.0010598504450172186
loss_pred:0.016515931114554405, decouple_loss:0.0009989835089072585
The modified gen p mean: 0.4481285512447357, gen p mean: -0.052581820636987686, mean p set: 0.4486088454723358
loss_pred:0.01644611731171608, decouple_loss:0.0009510029340162873
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476211667060852, gen p mean: -0.05282334238290787, mean p set: 0.4481014907360077
The modified gen p mean: 0.44753506779670715, gen p mean: -0.05121907219290733, mean p set: 0.44801533222198486
loss_pred:0.017314329743385315, decouple_loss:0.0013364567421376705
loss_pred:0.016199231147766113, decouple_loss:0.0013886630767956376
The modified gen p mean: 0.44812726974487305, gen p mean: -0.048492759466171265, mean p set: 0.44860756397247314
loss_pred:0.01596742868423462, decouple_loss:0.0013202577829360962
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472379982471466, gen p mean: -0.05100642144680023, mean p set: 0.4477182924747467
loss_pred:0.017521703615784645, decouple_loss:0.001038087299093604
The modified gen p mean: 0.448306679725647, gen p mean: -0.05359332263469696, mean p set: 0.44878700375556946The modified gen p mean: 0.4473099708557129, gen p mean: -0.055412113666534424, mean p set: 0.447790265083313
loss_pred:0.016593636944890022, decouple_loss:0.0011840519728139043
loss_pred:0.0169991422444582, decouple_loss:0.0011433553881943226

2023-05-01 16:34:48 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.056795742362737656, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05288372561335564, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05275150388479233, mean p set: 0.45035696029663086
loss_pred:0.01827058382332325, decouple_loss:0.0013605860294774175
loss_pred:0.017313117161393166, decouple_loss:0.0013953866437077522
loss_pred:0.01721997931599617, decouple_loss:0.0013212430058047175
WV_0_PC_1_EH_0_PS_40, loss: 0.017669180408120155, avg_mse: 0.025331832468509674
current test mse: 0.025332
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825199246406555, gen p mean: -0.05418320745229721, mean p set: 0.44873231649398804
The modified gen p mean: 0.45025894045829773, gen p mean: -0.05350129306316376, mean p set: 0.4507392346858978
loss_pred:0.016473345458507538, decouple_loss:0.001289114123210311
The modified gen p mean: 0.4488983452320099, gen p mean: -0.054016172885894775, mean p set: 0.4493786096572876
loss_pred:0.01607605442404747, decouple_loss:0.0013202321715652943
loss_pred:0.01634642668068409, decouple_loss:0.0013520886423066258
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721993803977966, gen p mean: -0.05406246706843376, mean p set: 0.44770026206970215
loss_pred:0.017378810793161392, decouple_loss:0.0012773587368428707
The modified gen p mean: 0.44918984174728394, gen p mean: -0.05252978578209877, mean p set: 0.44967013597488403The modified gen p mean: 0.4503829777240753, gen p mean: -0.053026486188173294, mean p set: 0.4508633017539978
loss_pred:0.015800099819898605, decouple_loss:0.001263232552446425
loss_pred:0.016017869114875793, decouple_loss:0.0012734447373077273
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461364448070526, gen p mean: -0.05360262840986252, mean p set: 0.4466167390346527
loss_pred:0.017338339239358902, decouple_loss:0.0010831771651282907
The modified gen p mean: 0.4490949809551239, gen p mean: -0.050016265362501144, mean p set: 0.449575275182724The modified gen p mean: 0.4465082287788391, gen p mean: -0.051674824208021164, mean p set: 0.4469884932041168
loss_pred:0.016851341351866722, decouple_loss:0.0011750177945941687
loss_pred:0.016560373827815056, decouple_loss:0.0011501439148560166
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461628794670105, gen p mean: -0.04983367770910263, mean p set: 0.4466431736946106
loss_pred:0.01727026328444481, decouple_loss:0.0010794253321364522
The modified gen p mean: 0.44710925221443176, gen p mean: -0.05691169947385788, mean p set: 0.44758954644203186The modified gen p mean: 0.44797593355178833, gen p mean: -0.05114885792136192, mean p set: 0.44845619797706604
loss_pred:0.01677655428647995, decouple_loss:0.0011542498832568526
loss_pred:0.015181796625256538, decouple_loss:0.0011969930492341518
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483039677143097, gen p mean: -0.05566774308681488, mean p set: 0.4487842321395874
loss_pred:0.016450095921754837, decouple_loss:0.0009669605060480535
The modified gen p mean: 0.4492214322090149, gen p mean: -0.05064332112669945, mean p set: 0.4497016966342926The modified gen p mean: 0.44801101088523865, gen p mean: -0.05114666372537613, mean p set: 0.44849130511283875
loss_pred:0.01677439734339714, decouple_loss:0.0009767482988536358
loss_pred:0.015806952491402626, decouple_loss:0.0009591928101144731
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485818147659302, gen p mean: -0.0558532178401947, mean p set: 0.4490620791912079
loss_pred:0.017049502581357956, decouple_loss:0.0010465949308127165
The modified gen p mean: 0.44797283411026, gen p mean: -0.053280752152204514, mean p set: 0.4484530985355377The modified gen p mean: 0.4470476508140564, gen p mean: -0.057439565658569336, mean p set: 0.4475279748439789
loss_pred:0.016007816419005394, decouple_loss:0.0010690120980143547
loss_pred:0.0172649584710598, decouple_loss:0.0011545562883839011
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478619396686554, gen p mean: -0.055170074105262756, mean p set: 0.4483422338962555
The modified gen p mean: 0.4480954706668854, gen p mean: -0.051068004220724106, mean p set: 0.4485757648944855
loss_pred:0.016591869294643402, decouple_loss:0.0010410025715827942
loss_pred:0.016086017712950706, decouple_loss:0.0009579731267876923
The modified gen p mean: 0.4467930793762207, gen p mean: -0.05413093417882919, mean p set: 0.4472734034061432
loss_pred:0.017393499612808228, decouple_loss:0.0010815334971994162
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44887346029281616, gen p mean: -0.05031057819724083, mean p set: 0.44935378432273865
loss_pred:0.01670387201011181, decouple_loss:0.0010692020878195763
The modified gen p mean: 0.44757699966430664, gen p mean: -0.05443642660975456, mean p set: 0.44805729389190674The modified gen p mean: 0.4495514929294586, gen p mean: -0.05067993700504303, mean p set: 0.4500318169593811
loss_pred:0.015833429992198944, decouple_loss:0.0011509987525641918
loss_pred:0.016421005129814148, decouple_loss:0.0012614707229658961
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448026180267334, gen p mean: -0.053634367883205414, mean p set: 0.4485064744949341
loss_pred:0.016668647527694702, decouple_loss:0.0011110604973509908
The modified gen p mean: 0.44938087463378906, gen p mean: -0.0546928308904171, mean p set: 0.44986119866371155The modified gen p mean: 0.44624578952789307, gen p mean: -0.05542353168129921, mean p set: 0.44672608375549316
loss_pred:0.016528382897377014, decouple_loss:0.0010972257005050778
loss_pred:0.016900673508644104, decouple_loss:0.0012207471299916506
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
NaN value num: 0
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450736403465271, gen p mean: -0.04386382922530174, mean p set: 0.4512166678905487
loss_pred:0.0170003492385149, decouple_loss:0.0010892354184761643
The modified gen p mean: 0.4505573809146881, gen p mean: -0.045008864253759384, mean p set: 0.4510376751422882The modified gen p mean: 0.4485575556755066, gen p mean: -0.04968797788023949, mean p set: 0.4490378499031067
loss_pred:0.017558757215738297, decouple_loss:0.001004739897325635
loss_pred:0.017764465883374214, decouple_loss:0.0011475511128082871
2023-05-01 16:37:23 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05567712336778641, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05165031552314758, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05159883201122284, mean p set: 0.45035696029663086
loss_pred:0.018369106575846672, decouple_loss:0.0012633029837161303
loss_pred:0.017371078953146935, decouple_loss:0.0010865001240745187
loss_pred:0.017229793593287468, decouple_loss:0.0012046883348375559
WV_0_PC_1_EH_0_PS_40, loss: 0.017715901136398315, avg_mse: 0.025427913293242455
current test mse: 0.025428
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449115514755249, gen p mean: -0.04424270614981651, mean p set: 0.44959574937820435
The modified gen p mean: 0.4486439526081085, gen p mean: -0.04521612450480461, mean p set: 0.449124276638031
The modified gen p mean: 0.44984108209609985, gen p mean: -0.05032111704349518, mean p set: 0.45032137632369995
loss_pred:0.017352281138300896, decouple_loss:0.0010467873653396964
loss_pred:0.01738697849214077, decouple_loss:0.0011340364580973983
loss_pred:0.017892388626933098, decouple_loss:0.0011302331695333123
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500325322151184, gen p mean: -0.04756743833422661, mean p set: 0.4505128264427185
The modified gen p mean: 0.44995397329330444, gen p mean: -0.047851186245679855, mean p set: 0.45043426752090454
loss_pred:0.017243575304746628, decouple_loss:0.0009879692224785686
loss_pred:0.017465613782405853, decouple_loss:0.0009628263069316745
The modified gen p mean: 0.4473506510257721, gen p mean: -0.04849289357662201, mean p set: 0.4478309452533722
loss_pred:0.018179085105657578, decouple_loss:0.0009756814106367528
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44819462299346924, gen p mean: -0.05610340088605881, mean p set: 0.44867488741874695
loss_pred:0.017308175563812256, decouple_loss:0.0011181613663211465
The modified gen p mean: 0.44912129640579224, gen p mean: -0.04371337220072746, mean p set: 0.44960159063339233The modified gen p mean: 0.4471445083618164, gen p mean: -0.05082836374640465, mean p set: 0.4476247727870941
loss_pred:0.017035437747836113, decouple_loss:0.0010750294895842671
loss_pred:0.01793617010116577, decouple_loss:0.0010551671730354428
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010796189308167, gen p mean: -0.050038088113069534, mean p set: 0.4505882263183594
loss_pred:0.017652073875069618, decouple_loss:0.0010921896900981665
The modified gen p mean: 0.4471046030521393, gen p mean: -0.0520898662507534, mean p set: 0.44758492708206177The modified gen p mean: 0.4517248272895813, gen p mean: -0.04706128314137459, mean p set: 0.4522051215171814
loss_pred:0.016921840608119965, decouple_loss:0.0009759420645423234
loss_pred:0.016369018703699112, decouple_loss:0.0011036139912903309
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484102725982666, gen p mean: -0.05169849470257759, mean p set: 0.4488905668258667
loss_pred:0.017541803419589996, decouple_loss:0.0010615959763526917
The modified gen p mean: 0.45086026191711426, gen p mean: -0.04736035317182541, mean p set: 0.45134055614471436The modified gen p mean: 0.4493338465690613, gen p mean: -0.05508936196565628, mean p set: 0.4498141407966614
loss_pred:0.017960771918296814, decouple_loss:0.001035692053847015
loss_pred:0.01808314584195614, decouple_loss:0.0010889339027926326
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482898414134979, gen p mean: -0.0479905791580677, mean p set: 0.448770135641098
loss_pred:0.017536375671625137, decouple_loss:0.0009423771407455206
The modified gen p mean: 0.44963181018829346, gen p mean: -0.04678179696202278, mean p set: 0.45011213421821594The modified gen p mean: 0.45115989446640015, gen p mean: -0.046981409192085266, mean p set: 0.45164018869400024
loss_pred:0.017646891996264458, decouple_loss:0.0010808482766151428loss_pred:0.01593744568526745, decouple_loss:0.0010578284272924066
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44794586300849915, gen p mean: -0.05632017180323601, mean p set: 0.44842615723609924
loss_pred:0.017172321677207947, decouple_loss:0.0009947880171239376
The modified gen p mean: 0.45077434182167053, gen p mean: -0.045735009014606476, mean p set: 0.45125463604927063The modified gen p mean: 0.4480366110801697, gen p mean: -0.05230624973773956, mean p set: 0.4485168755054474
loss_pred:0.01578587479889393, decouple_loss:0.000994118396192789
loss_pred:0.017266254872083664, decouple_loss:0.0009631541906856
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44891270995140076, gen p mean: -0.047689810395240784, mean p set: 0.44939300417900085
loss_pred:0.017307857051491737, decouple_loss:0.0009708749130368233
The modified gen p mean: 0.4476175904273987, gen p mean: -0.051652293652296066, mean p set: 0.4480978846549988The modified gen p mean: 0.44797125458717346, gen p mean: -0.04570264369249344, mean p set: 0.44845154881477356
loss_pred:0.017729001119732857, decouple_loss:0.0009840682614594698
loss_pred:0.017922669649124146, decouple_loss:0.0009560693870298564
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674256443977356, gen p mean: -0.04980286955833435, mean p set: 0.44722285866737366
loss_pred:0.017173929139971733, decouple_loss:0.0009504153858870268
The modified gen p mean: 0.44947001338005066, gen p mean: -0.044589564204216, mean p set: 0.44995033740997314The modified gen p mean: 0.4501286745071411, gen p mean: -0.04751409590244293, mean p set: 0.4506089687347412
loss_pred:0.017514832317829132, decouple_loss:0.0009607041720300913
loss_pred:0.01754016987979412, decouple_loss:0.0009419178823009133
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507276713848114, gen p mean: -0.04371758922934532, mean p set: 0.4512079358100891
loss_pred:0.01679103635251522, decouple_loss:0.0010133564937859774
The modified gen p mean: 0.4490267336368561, gen p mean: -0.044323213398456573, mean p set: 0.4495069682598114The modified gen p mean: 0.44673827290534973, gen p mean: -0.050585538148880005, mean p set: 0.44721853733062744
loss_pred:0.018459193408489227, decouple_loss:0.0010910399723798037
loss_pred:0.016835622489452362, decouple_loss:0.0010002796771004796
2023-05-01 16:39:21 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05295517295598984, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04897638410329819, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04906034469604492, mean p set: 0.45035696029663086
loss_pred:0.018351281061768532, decouple_loss:0.0010832403786480427
loss_pred:0.017317064106464386, decouple_loss:0.0010473949369043112
loss_pred:0.017173031345009804, decouple_loss:0.0010574266780167818
WV_0_PC_1_EH_0_PS_40, loss: 0.017666926607489586, avg_mse: 0.025319596752524376
current test mse: 0.02532
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487427771091461, gen p mean: -0.05429506301879883, mean p set: 0.4492231011390686
loss_pred:0.017843980342149734, decouple_loss:0.001002604840323329
The modified gen p mean: 0.4485870599746704, gen p mean: -0.045948028564453125, mean p set: 0.4490673840045929The modified gen p mean: 0.44769158959388733, gen p mean: -0.042124755680561066, mean p set: 0.44817185401916504
loss_pred:0.017832091078162193, decouple_loss:0.0009554081480018795
loss_pred:0.01768009550869465, decouple_loss:0.0009717440116219223
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45025137066841125, gen p mean: -0.04241606965661049, mean p set: 0.45073163509368896
loss_pred:0.0177127905189991, decouple_loss:0.0009664276731200516
The modified gen p mean: 0.4493924081325531, gen p mean: -0.047077253460884094, mean p set: 0.4498726725578308The modified gen p mean: 0.4502987563610077, gen p mean: -0.04275458678603172, mean p set: 0.4507790505886078
loss_pred:0.016898421570658684, decouple_loss:0.0010010716505348682
loss_pred:0.018285026773810387, decouple_loss:0.0009513736586086452
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914600253105164, gen p mean: -0.03931306302547455, mean p set: 0.44962626695632935
loss_pred:0.017912764102220535, decouple_loss:0.0010630053002387285
The modified gen p mean: 0.44839614629745483, gen p mean: -0.053351908922195435, mean p set: 0.44887641072273254The modified gen p mean: 0.44949010014533997, gen p mean: -0.04387650266289711, mean p set: 0.44997039437294006
loss_pred:0.01751970499753952, decouple_loss:0.001146358554251492
loss_pred:0.017740100622177124, decouple_loss:0.0010186306899413466
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496336281299591, gen p mean: -0.044063370674848557, mean p set: 0.4501139223575592
loss_pred:0.017464393749833107, decouple_loss:0.0009121100883930922
The modified gen p mean: 0.44841665029525757, gen p mean: -0.04017676040530205, mean p set: 0.44889700412750244The modified gen p mean: 0.4507047235965729, gen p mean: -0.038626059889793396, mean p set: 0.4511849880218506
loss_pred:0.018023695796728134, decouple_loss:0.0009714681073091924
loss_pred:0.016639670357108116, decouple_loss:0.0011263361666351557
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507609009742737, gen p mean: -0.04077184945344925, mean p set: 0.4512411952018738
loss_pred:0.01565353199839592, decouple_loss:0.0009488926734775305
The modified gen p mean: 0.4497940242290497, gen p mean: -0.04554620012640953, mean p set: 0.4502742886543274The modified gen p mean: 0.4507257342338562, gen p mean: -0.04201432690024376, mean p set: 0.4512060284614563
loss_pred:0.017742469906806946, decouple_loss:0.000930463895201683
loss_pred:0.01688515953719616, decouple_loss:0.0009753276826813817
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003271102905273, gen p mean: -0.042564328759908676, mean p set: 0.45051300525665283
loss_pred:0.016980484127998352, decouple_loss:0.0009704057592898607
The modified gen p mean: 0.4507928788661957, gen p mean: -0.04141688346862793, mean p set: 0.4512731432914734The modified gen p mean: 0.45105379819869995, gen p mean: -0.040507443249225616, mean p set: 0.45153409242630005
loss_pred:0.01636463962495327, decouple_loss:0.0009692901512607932
loss_pred:0.016327474266290665, decouple_loss:0.0009236925397999585
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786569476127625, gen p mean: -0.052527498453855515, mean p set: 0.44834598898887634
loss_pred:0.01714589074254036, decouple_loss:0.000984668149612844
The modified gen p mean: 0.4505627155303955, gen p mean: -0.043561965227127075, mean p set: 0.4510430097579956The modified gen p mean: 0.4476284086704254, gen p mean: -0.04270203784108162, mean p set: 0.4481086730957031
loss_pred:0.016644340008497238, decouple_loss:0.0010208338499069214
loss_pred:0.01794988475739956, decouple_loss:0.0009563990752212703
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026326179504395, gen p mean: -0.04662869870662689, mean p set: 0.45074358582496643
loss_pred:0.01726994477212429, decouple_loss:0.001016639405861497
The modified gen p mean: 0.4477318227291107, gen p mean: -0.05519144982099533, mean p set: 0.4482121169567108The modified gen p mean: 0.44873711466789246, gen p mean: -0.04587709903717041, mean p set: 0.44921740889549255
loss_pred:0.017197705805301666, decouple_loss:0.0010400203755125403
loss_pred:0.01791851781308651, decouple_loss:0.0009205688256770372
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490819573402405, gen p mean: -0.04842763766646385, mean p set: 0.4495622515678406
loss_pred:0.017911387607455254, decouple_loss:0.0008765354286879301
The modified gen p mean: 0.4480634927749634, gen p mean: -0.05048975721001625, mean p set: 0.4485437870025635The modified gen p mean: 0.4494977295398712, gen p mean: -0.04821058362722397, mean p set: 0.4499780237674713
loss_pred:0.017602115869522095, decouple_loss:0.0009406443568877876
loss_pred:0.01809384487569332, decouple_loss:0.0009218892664648592
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
NaN value num: 0
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468706548213959, gen p mean: -0.04990028589963913, mean p set: 0.4473509192466736
loss_pred:0.01800089329481125, decouple_loss:0.001019953517243266
The modified gen p mean: 0.44756948947906494, gen p mean: -0.053924158215522766, mean p set: 0.4480498135089874
The modified gen p mean: 0.447181761264801, gen p mean: -0.04896993190050125, mean p set: 0.4476620852947235
loss_pred:0.017960956320166588, decouple_loss:0.0010298548731952906
loss_pred:0.017480406910181046, decouple_loss:0.0009165445808321238
2023-05-01 16:41:55 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05589539185166359, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05197994410991669, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05222984403371811, mean p set: 0.45035696029663086
loss_pred:0.018270714208483696, decouple_loss:0.0009771602926775813
loss_pred:0.01727939397096634, decouple_loss:0.0009351527551189065
loss_pred:0.017128510400652885, decouple_loss:0.0009698767680674791
WV_0_PC_1_EH_0_PS_40, loss: 0.01760757714509964, avg_mse: 0.025225963443517685
current test mse: 0.025226
At step 280, Best test: 0.025226
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_0_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640523195266724, gen p mean: -0.049693431705236435, mean p set: 0.44688549637794495
loss_pred:0.01876104064285755, decouple_loss:0.000931879854761064
The modified gen p mean: 0.4460969567298889, gen p mean: -0.04988158866763115, mean p set: 0.446577250957489The modified gen p mean: 0.44664111733436584, gen p mean: -0.05082293599843979, mean p set: 0.44712138175964355
loss_pred:0.017049310728907585, decouple_loss:0.0009068948565982282
loss_pred:0.017868462949991226, decouple_loss:0.0009495969279669225
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010483264923096, gen p mean: -0.05192539840936661, mean p set: 0.45058512687683105
loss_pred:0.016890306025743484, decouple_loss:0.0009579808684065938
The modified gen p mean: 0.4471374452114105, gen p mean: -0.05095159634947777, mean p set: 0.4476177394390106The modified gen p mean: 0.4480510652065277, gen p mean: -0.04638952389359474, mean p set: 0.4485313296318054
loss_pred:0.017056012526154518, decouple_loss:0.0009289807640016079
loss_pred:0.01744420826435089, decouple_loss:0.0008943001157604158
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827577471733093, gen p mean: -0.045945048332214355, mean p set: 0.44875606894493103
loss_pred:0.01704965904355049, decouple_loss:0.0009306757710874081
The modified gen p mean: 0.44786545634269714, gen p mean: -0.04599473625421524, mean p set: 0.44834578037261963The modified gen p mean: 0.4485849440097809, gen p mean: -0.05404859781265259, mean p set: 0.449065238237381
loss_pred:0.017365938052535057, decouple_loss:0.0008994879317469895
loss_pred:0.017480462789535522, decouple_loss:0.0009435687679797411
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457154870033264, gen p mean: -0.04809087887406349, mean p set: 0.4461957514286041
loss_pred:0.017201948910951614, decouple_loss:0.0009107022196985781
The modified gen p mean: 0.44856974482536316, gen p mean: -0.04641688987612724, mean p set: 0.44905006885528564The modified gen p mean: 0.4475644528865814, gen p mean: -0.04915390536189079, mean p set: 0.4480447769165039
loss_pred:0.017257200554013252, decouple_loss:0.0008642561733722687
loss_pred:0.01741480454802513, decouple_loss:0.0009155267616733909
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686856865882874, gen p mean: -0.0495523139834404, mean p set: 0.44734886288642883
The modified gen p mean: 0.4469071924686432, gen p mean: -0.04990861192345619, mean p set: 0.4473875164985657
loss_pred:0.01700459234416485, decouple_loss:0.0009773016208782792
loss_pred:0.017861258238554, decouple_loss:0.0010008816607296467The modified gen p mean: 0.4470256268978119, gen p mean: -0.050088804215192795, mean p set: 0.4475059509277344
loss_pred:0.017674516886472702, decouple_loss:0.0009617098257876933
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708481431007385, gen p mean: -0.0548698827624321, mean p set: 0.44756510853767395
loss_pred:0.01687140017747879, decouple_loss:0.0009525417699478567
The modified gen p mean: 0.4476662278175354, gen p mean: -0.049287281930446625, mean p set: 0.4481465220451355The modified gen p mean: 0.4476235508918762, gen p mean: -0.052115894854068756, mean p set: 0.44810381531715393
loss_pred:0.017240460962057114, decouple_loss:0.0009062453173100948
loss_pred:0.017759140580892563, decouple_loss:0.0009355936199426651
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827449321746826, gen p mean: -0.048521772027015686, mean p set: 0.44875475764274597
loss_pred:0.0172744020819664, decouple_loss:0.0010787282371893525
The modified gen p mean: 0.4484080970287323, gen p mean: -0.05253279209136963, mean p set: 0.4488883912563324The modified gen p mean: 0.4472668468952179, gen p mean: -0.05521013215184212, mean p set: 0.447747141122818
loss_pred:0.017499880865216255, decouple_loss:0.0010516612092033029
loss_pred:0.017372339963912964, decouple_loss:0.0010047652758657932
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678249955177307, gen p mean: -0.05020606145262718, mean p set: 0.44726279377937317
loss_pred:0.0178094319999218, decouple_loss:0.0009441754082217813
The modified gen p mean: 0.44796597957611084, gen p mean: -0.04807676374912262, mean p set: 0.44844627380371094The modified gen p mean: 0.448119193315506, gen p mean: -0.05687616392970085, mean p set: 0.4485994875431061
loss_pred:0.017196618020534515, decouple_loss:0.0009620269993320107
loss_pred:0.01744927279651165, decouple_loss:0.0008731068228371441
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474196434020996, gen p mean: -0.051362887024879456, mean p set: 0.4478999078273773
loss_pred:0.01801205612719059, decouple_loss:0.001068297540768981
The modified gen p mean: 0.44769006967544556, gen p mean: -0.051057565957307816, mean p set: 0.44817039370536804The modified gen p mean: 0.4482971429824829, gen p mean: -0.05008909851312637, mean p set: 0.4487774670124054
loss_pred:0.01653372496366501, decouple_loss:0.0010406790534034371
loss_pred:0.01692936383187771, decouple_loss:0.0010030902922153473
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447566956281662, gen p mean: -0.05079277977347374, mean p set: 0.4480472505092621
The modified gen p mean: 0.44580334424972534, gen p mean: -0.046860989183187485, mean p set: 0.44628363847732544
loss_pred:0.016786649823188782, decouple_loss:0.0010967575944960117
loss_pred:0.01719454675912857, decouple_loss:0.0009661256917752326
The modified gen p mean: 0.44661030173301697, gen p mean: -0.05050543323159218, mean p set: 0.4470905661582947
loss_pred:0.017613422125577927, decouple_loss:0.0009679032955318689
2023-05-01 16:43:57 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.053416162729263306, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04973219707608223, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049784500151872635, mean p set: 0.45035696029663086
loss_pred:0.018284719437360764, decouple_loss:0.0010424716165289283
loss_pred:0.017194250598549843, decouple_loss:0.001025790348649025loss_pred:0.017327748239040375, decouple_loss:0.0009463123278692365
WV_0_PC_1_EH_0_PS_40, loss: 0.01765248365700245, avg_mse: 0.025312792509794235
current test mse: 0.025313
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44708743691444397, gen p mean: -0.04975605010986328, mean p set: 0.44756776094436646
The modified gen p mean: 0.4473632276058197, gen p mean: -0.050204113125801086, mean p set: 0.4478435218334198
loss_pred:0.017217373475432396, decouple_loss:0.000988045590929687
The modified gen p mean: 0.44676363468170166, gen p mean: -0.04998480901122093, mean p set: 0.44724392890930176
loss_pred:0.017637083306908607, decouple_loss:0.0009111089748330414
loss_pred:0.017427606508135796, decouple_loss:0.0008782196673564613
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447256863117218, gen p mean: -0.051228441298007965, mean p set: 0.4477372169494629
loss_pred:0.017558345571160316, decouple_loss:0.0009127428638748825
The modified gen p mean: 0.44652819633483887, gen p mean: -0.04979255050420761, mean p set: 0.44700849056243896The modified gen p mean: 0.4465142488479614, gen p mean: -0.04832985997200012, mean p set: 0.4469945430755615
loss_pred:0.017448216676712036, decouple_loss:0.0010318731656298041
loss_pred:0.017245816066861153, decouple_loss:0.0010142348473891616
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477561116218567, gen p mean: -0.05239667743444443, mean p set: 0.4482364058494568
The modified gen p mean: 0.4470927119255066, gen p mean: -0.050933197140693665, mean p set: 0.4475730061531067
loss_pred:0.016929935663938522, decouple_loss:0.0010016346350312233
loss_pred:0.017137249931693077, decouple_loss:0.0009464418399147689The modified gen p mean: 0.4491763710975647, gen p mean: -0.051378283649683, mean p set: 0.4496566355228424
loss_pred:0.01732126995921135, decouple_loss:0.0009493631077930331
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486321806907654, gen p mean: -0.04970384016633034, mean p set: 0.4491124749183655
The modified gen p mean: 0.4494776129722595, gen p mean: -0.048865143209695816, mean p set: 0.449957937002182
loss_pred:0.01714475080370903, decouple_loss:0.0009339998941868544
loss_pred:0.016346611082553864, decouple_loss:0.0009696594206616282
The modified gen p mean: 0.4477948546409607, gen p mean: -0.048887141048908234, mean p set: 0.44827520847320557
loss_pred:0.01744561642408371, decouple_loss:0.0009933680994436145
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44650033116340637, gen p mean: -0.04713017866015434, mean p set: 0.44698062539100647
The modified gen p mean: 0.4474089741706848, gen p mean: -0.04522746056318283, mean p set: 0.4478892683982849
loss_pred:0.017971662804484367, decouple_loss:0.0009199182968586683
loss_pred:0.016778413206338882, decouple_loss:0.0009749204036779702
The modified gen p mean: 0.4481431543827057, gen p mean: -0.04545414075255394, mean p set: 0.4486234486103058
loss_pred:0.01742330566048622, decouple_loss:0.0008793171728029847
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462997615337372, gen p mean: -0.0476657971739769, mean p set: 0.4467800557613373
The modified gen p mean: 0.44656434655189514, gen p mean: -0.05094374343752861, mean p set: 0.44704464077949524
loss_pred:0.017600785940885544, decouple_loss:0.0010073838056996465
loss_pred:0.01651805266737938, decouple_loss:0.0010667303577065468
The modified gen p mean: 0.4488506019115448, gen p mean: -0.05237622186541557, mean p set: 0.4493309259414673
loss_pred:0.01722855493426323, decouple_loss:0.0010778883006423712
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492039978504181, gen p mean: -0.05107341334223747, mean p set: 0.4496842920780182
loss_pred:0.016288550570607185, decouple_loss:0.0009536240249872208
The modified gen p mean: 0.44688671827316284, gen p mean: -0.0484609492123127, mean p set: 0.44736701250076294The modified gen p mean: 0.44800689816474915, gen p mean: -0.04342775419354439, mean p set: 0.44848722219467163
loss_pred:0.016965722665190697, decouple_loss:0.0009402048890478909
loss_pred:0.017747335135936737, decouple_loss:0.0009922663448378444
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44842782616615295, gen p mean: -0.05128677561879158, mean p set: 0.44890812039375305
The modified gen p mean: 0.4465080201625824, gen p mean: -0.0521395243704319, mean p set: 0.4469883143901825
loss_pred:0.016798868775367737, decouple_loss:0.0009541800827719271
loss_pred:0.017005866393446922, decouple_loss:0.0009981783805415034
The modified gen p mean: 0.4474189877510071, gen p mean: -0.0505811907351017, mean p set: 0.44789931178092957
loss_pred:0.016743216663599014, decouple_loss:0.0009692025487311184
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672462344169617, gen p mean: -0.05049550533294678, mean p set: 0.44720491766929626
The modified gen p mean: 0.4473225772380829, gen p mean: -0.053359080106019974, mean p set: 0.44780290126800537
loss_pred:0.017558906227350235, decouple_loss:0.000989986932836473
loss_pred:0.017633214592933655, decouple_loss:0.0009740655077621341
The modified gen p mean: 0.44692352414131165, gen p mean: -0.05159589275717735, mean p set: 0.44740378856658936
loss_pred:0.01732826791703701, decouple_loss:0.000960003468208015
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
NaN value num: 0
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018118619918823, gen p mean: -0.05254385992884636, mean p set: 0.45066148042678833
loss_pred:0.01610046997666359, decouple_loss:0.0011153920786455274
The modified gen p mean: 0.44930562376976013, gen p mean: -0.050217270851135254, mean p set: 0.44978588819503784The modified gen p mean: 0.45143356919288635, gen p mean: -0.052389103919267654, mean p set: 0.45191389322280884
loss_pred:0.01710166037082672, decouple_loss:0.0011394296307116747
loss_pred:0.01648624986410141, decouple_loss:0.00111010845284909
2023-05-01 16:46:45 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.055043257772922516, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05118338018655777, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.051192592829465866, mean p set: 0.45035696029663086
loss_pred:0.018305080011487007, decouple_loss:0.0010727716144174337
loss_pred:0.017350129783153534, decouple_loss:0.0010483399964869022
loss_pred:0.017229055985808372, decouple_loss:0.0010808169608935714
WV_0_PC_1_EH_0_PS_40, loss: 0.017681455239653587, avg_mse: 0.025382138788700104
current test mse: 0.025382
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910648465156555, gen p mean: -0.05109211057424545, mean p set: 0.44958674907684326
loss_pred:0.016531752422451973, decouple_loss:0.0010104686953127384
The modified gen p mean: 0.4486290216445923, gen p mean: -0.05366317927837372, mean p set: 0.4491093158721924The modified gen p mean: 0.4498802423477173, gen p mean: -0.048467881977558136, mean p set: 0.4503605365753174
loss_pred:0.01667552813887596, decouple_loss:0.0010248246835544705
loss_pred:0.016017630696296692, decouple_loss:0.0010065180249512196
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977468252182007, gen p mean: -0.05229208245873451, mean p set: 0.45025497674942017
The modified gen p mean: 0.44876593351364136, gen p mean: -0.05136869102716446, mean p set: 0.44924622774124146
loss_pred:0.0166325643658638, decouple_loss:0.001136991661041975
loss_pred:0.016002623364329338, decouple_loss:0.001001178752630949
The modified gen p mean: 0.4507297873497009, gen p mean: -0.05342021584510803, mean p set: 0.451210081577301
loss_pred:0.016233127564191818, decouple_loss:0.001155380392447114
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503313899040222, gen p mean: -0.048184555023908615, mean p set: 0.4508116841316223
The modified gen p mean: 0.4502499997615814, gen p mean: -0.051253337413072586, mean p set: 0.4507302939891815
loss_pred:0.01662503369152546, decouple_loss:0.0009728306904435158
loss_pred:0.016290728002786636, decouple_loss:0.0011372112203389406
The modified gen p mean: 0.4507967233657837, gen p mean: -0.052671726793050766, mean p set: 0.4512770175933838
loss_pred:0.01623854599893093, decouple_loss:0.0010203386191278696
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512108862400055, gen p mean: -0.04741649329662323, mean p set: 0.451691210269928
The modified gen p mean: 0.4504499137401581, gen p mean: -0.05437258258461952, mean p set: 0.4509302079677582
loss_pred:0.01593373715877533, decouple_loss:0.0010497795883566141
loss_pred:0.01609056629240513, decouple_loss:0.001294178538955748
The modified gen p mean: 0.45071253180503845, gen p mean: -0.05126073956489563, mean p set: 0.45119279623031616
loss_pred:0.015834417194128036, decouple_loss:0.0011758237378671765
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089560747146606, gen p mean: -0.050974614918231964, mean p set: 0.45137593150138855
The modified gen p mean: 0.4508408308029175, gen p mean: -0.050720103085041046, mean p set: 0.4513210952281952
loss_pred:0.016848690807819366, decouple_loss:0.001130780321545899
loss_pred:0.016067033633589745, decouple_loss:0.0010814781999215484
The modified gen p mean: 0.45106905698776245, gen p mean: -0.048959359526634216, mean p set: 0.45154935121536255
loss_pred:0.016841882839798927, decouple_loss:0.001127405441366136
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052289962768555, gen p mean: -0.046446409076452255, mean p set: 0.45100319385528564
The modified gen p mean: 0.450664222240448, gen p mean: -0.0486626923084259, mean p set: 0.4511445164680481
loss_pred:0.01594579592347145, decouple_loss:0.0011800110805779696
loss_pred:0.016548926010727882, decouple_loss:0.0012260879157111049
The modified gen p mean: 0.45036381483078003, gen p mean: -0.04321054741740227, mean p set: 0.45084407925605774
loss_pred:0.01686239428818226, decouple_loss:0.0012811843771487474
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498560428619385, gen p mean: -0.04589464142918587, mean p set: 0.4503363370895386
The modified gen p mean: 0.45054304599761963, gen p mean: -0.049581129103899, mean p set: 0.4510233402252197
loss_pred:0.016552390530705452, decouple_loss:0.0009803399443626404
loss_pred:0.016146743670105934, decouple_loss:0.0010899186599999666
The modified gen p mean: 0.4486198127269745, gen p mean: -0.047201380133628845, mean p set: 0.4491001069545746
loss_pred:0.01598343439400196, decouple_loss:0.0010334933176636696
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509749114513397, gen p mean: -0.04996061697602272, mean p set: 0.4514552056789398
loss_pred:0.01659374125301838, decouple_loss:0.0013526750262826681
The modified gen p mean: 0.4502987563610077, gen p mean: -0.04768628254532814, mean p set: 0.4507790505886078The modified gen p mean: 0.44987475872039795, gen p mean: -0.053058281540870667, mean p set: 0.45035505294799805
loss_pred:0.016423823311924934, decouple_loss:0.001319149392656982
loss_pred:0.0160740464925766, decouple_loss:0.001254637143574655
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488905966281891, gen p mean: -0.048643339425325394, mean p set: 0.4493708908557892
The modified gen p mean: 0.4502270221710205, gen p mean: -0.05049140378832817, mean p set: 0.4507073163986206
loss_pred:0.016663093119859695, decouple_loss:0.0010912567377090454
loss_pred:0.016489610075950623, decouple_loss:0.0011223192559555173
The modified gen p mean: 0.44862791895866394, gen p mean: -0.05011703073978424, mean p set: 0.44910821318626404
loss_pred:0.016144055873155594, decouple_loss:0.0011548759648576379
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450836181640625, gen p mean: -0.04680314287543297, mean p set: 0.4513164758682251
The modified gen p mean: 0.44932565093040466, gen p mean: -0.048323243856430054, mean p set: 0.4498059153556824
loss_pred:0.016262708231806755, decouple_loss:0.0013789919903501868
loss_pred:0.016378652304410934, decouple_loss:0.0012207154650241137
The modified gen p mean: 0.4501963257789612, gen p mean: -0.05377142131328583, mean p set: 0.4506766200065613
loss_pred:0.015899259597063065, decouple_loss:0.0016625188291072845
2023-05-01 16:48:41 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05381482467055321, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05028149113059044, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05043448135256767, mean p set: 0.45035696029663086
loss_pred:0.018445169553160667, decouple_loss:0.0011469053570181131
loss_pred:0.017448868602514267, decouple_loss:0.0010883761569857597
loss_pred:0.017217203974723816, decouple_loss:0.001115906168706715
WV_0_PC_1_EH_0_PS_40, loss: 0.017759600654244423, avg_mse: 0.025523314252495766
current test mse: 0.025523
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498160481452942, gen p mean: -0.049544334411621094, mean p set: 0.4502963423728943
The modified gen p mean: 0.4498402774333954, gen p mean: -0.0565483383834362, mean p set: 0.4503205716609955
loss_pred:0.015206149779260159, decouple_loss:0.0010498198680579662
The modified gen p mean: 0.45033878087997437, gen p mean: -0.05491654574871063, mean p set: 0.45081907510757446
loss_pred:0.01606125198304653, decouple_loss:0.0011975622037425637
loss_pred:0.01573965698480606, decouple_loss:0.0011279672617092729
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491533041000366, gen p mean: -0.05045250430703163, mean p set: 0.4496335983276367
The modified gen p mean: 0.4503542184829712, gen p mean: -0.0475340336561203, mean p set: 0.4508344829082489
loss_pred:0.015595070086419582, decouple_loss:0.0014343502698466182
loss_pred:0.016070671379566193, decouple_loss:0.0014096942031756043
The modified gen p mean: 0.45064085721969604, gen p mean: -0.05614091455936432, mean p set: 0.45112112164497375
loss_pred:0.015677664428949356, decouple_loss:0.001335280598141253
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497682750225067, gen p mean: -0.047006554901599884, mean p set: 0.4502485692501068
loss_pred:0.01614309847354889, decouple_loss:0.0011020404053851962
The modified gen p mean: 0.4474261403083801, gen p mean: -0.04869117587804794, mean p set: 0.4479064345359802The modified gen p mean: 0.4490281939506531, gen p mean: -0.04991467669606209, mean p set: 0.4495084881782532
loss_pred:0.01599426008760929, decouple_loss:0.001099247019737959
loss_pred:0.015892596915364265, decouple_loss:0.001101996167562902
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861987233161926, gen p mean: -0.04929414018988609, mean p set: 0.44910016655921936
loss_pred:0.01578623615205288, decouple_loss:0.0012289356673136353
The modified gen p mean: 0.45061028003692627, gen p mean: -0.054838720709085464, mean p set: 0.451090544462204The modified gen p mean: 0.45012181997299194, gen p mean: -0.05238695815205574, mean p set: 0.45060214400291443
loss_pred:0.015520515851676464, decouple_loss:0.0013862629421055317
loss_pred:0.016266927123069763, decouple_loss:0.0014163664309307933
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914960861206055, gen p mean: -0.046779077500104904, mean p set: 0.44962990283966064
loss_pred:0.016653696075081825, decouple_loss:0.0009695785702206194
The modified gen p mean: 0.4509217441082001, gen p mean: -0.050087638199329376, mean p set: 0.4514020085334778The modified gen p mean: 0.4487893283367157, gen p mean: -0.048989128321409225, mean p set: 0.4492696523666382
loss_pred:0.016261862590909004, decouple_loss:0.001103365677408874
loss_pred:0.01577109843492508, decouple_loss:0.0009940227027982473
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493718147277832, gen p mean: -0.04851507022976875, mean p set: 0.4498521387577057
loss_pred:0.01641886867582798, decouple_loss:0.0012291916646063328
The modified gen p mean: 0.4506271183490753, gen p mean: -0.05151323974132538, mean p set: 0.451107382774353The modified gen p mean: 0.45086774230003357, gen p mean: -0.049168914556503296, mean p set: 0.45134806632995605
loss_pred:0.01565934345126152, decouple_loss:0.0011484953574836254
loss_pred:0.01611681655049324, decouple_loss:0.0011926509905606508
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475768506526947, gen p mean: -0.045357845723629, mean p set: 0.4480571150779724
loss_pred:0.015965426340699196, decouple_loss:0.0009607980027794838
The modified gen p mean: 0.45072245597839355, gen p mean: -0.049368396401405334, mean p set: 0.45120275020599365The modified gen p mean: 0.4497581124305725, gen p mean: -0.04552348330616951, mean p set: 0.450238436460495
loss_pred:0.015622093342244625, decouple_loss:0.0009446243639104068
loss_pred:0.01584901101887226, decouple_loss:0.0009675796609371901
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45092812180519104, gen p mean: -0.04977568984031677, mean p set: 0.45140841603279114
loss_pred:0.016127826645970345, decouple_loss:0.0011286985827609897
The modified gen p mean: 0.45021581649780273, gen p mean: -0.05448845773935318, mean p set: 0.45069611072540283The modified gen p mean: 0.44924396276474, gen p mean: -0.04581904411315918, mean p set: 0.4497242569923401
loss_pred:0.01531902328133583, decouple_loss:0.001381619251333177
loss_pred:0.016422394663095474, decouple_loss:0.0010986835695803165
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504632353782654, gen p mean: -0.04714416339993477, mean p set: 0.4509435296058655
The modified gen p mean: 0.45012757182121277, gen p mean: -0.044600773602724075, mean p set: 0.45060789585113525
loss_pred:0.016061337664723396, decouple_loss:0.000953163078520447
The modified gen p mean: 0.4492305815219879, gen p mean: -0.04370075836777687, mean p set: 0.449710875749588
loss_pred:0.01626167632639408, decouple_loss:0.0009452020167373121
loss_pred:0.01637575961649418, decouple_loss:0.0009935623966157436
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
NaN value num: 0
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475539028644562, gen p mean: -0.046356767416000366, mean p set: 0.4480341970920563
loss_pred:0.01748453825712204, decouple_loss:0.0011572440853342414
The modified gen p mean: 0.4470103681087494, gen p mean: -0.04716459661722183, mean p set: 0.4474906623363495The modified gen p mean: 0.4468608498573303, gen p mean: -0.049635738134384155, mean p set: 0.4473411440849304
loss_pred:0.015375826507806778, decouple_loss:0.0011276945006102324
loss_pred:0.016481779515743256, decouple_loss:0.0010916173923760653
2023-05-01 16:51:16 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.052864234894514084, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04896088317036629, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049216657876968384, mean p set: 0.45035696029663086
loss_pred:0.018497398123145103, decouple_loss:0.001114873681217432
loss_pred:0.017481422051787376, decouple_loss:0.001063202740624547
loss_pred:0.017254775390028954, decouple_loss:0.0010459350887686014
WV_0_PC_1_EH_0_PS_40, loss: 0.01779826544225216, avg_mse: 0.0256184209138155
current test mse: 0.025618
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745978713035583, gen p mean: -0.050076406449079514, mean p set: 0.4479401111602783
The modified gen p mean: 0.4469808340072632, gen p mean: -0.047252122312784195, mean p set: 0.4474611282348633
loss_pred:0.01719832792878151, decouple_loss:0.0010102229425683618
The modified gen p mean: 0.44708651304244995, gen p mean: -0.04969150200486183, mean p set: 0.44756677746772766
loss_pred:0.015957221388816833, decouple_loss:0.0009745940333232284
loss_pred:0.016771839931607246, decouple_loss:0.0010325185721740127
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474444091320038, gen p mean: -0.05208219215273857, mean p set: 0.4479246735572815
The modified gen p mean: 0.44758620858192444, gen p mean: -0.04967071861028671, mean p set: 0.4480665326118469
loss_pred:0.017175283282995224, decouple_loss:0.0010964329121634364
loss_pred:0.015819258987903595, decouple_loss:0.001051075174473226
The modified gen p mean: 0.44669753313064575, gen p mean: -0.05355856195092201, mean p set: 0.44717782735824585
loss_pred:0.015960384160280228, decouple_loss:0.001178049249574542
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44587668776512146, gen p mean: -0.05440667271614075, mean p set: 0.44635701179504395
The modified gen p mean: 0.44716793298721313, gen p mean: -0.05364147946238518, mean p set: 0.44764822721481323
loss_pred:0.016916392371058464, decouple_loss:0.0011528782779350877
loss_pred:0.01599566638469696, decouple_loss:0.00111618940718472
The modified gen p mean: 0.4478066861629486, gen p mean: -0.05059798061847687, mean p set: 0.4482869803905487
loss_pred:0.016552472487092018, decouple_loss:0.001189929200336337
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44908756017684937, gen p mean: -0.04940982908010483, mean p set: 0.44956785440444946
The modified gen p mean: 0.44613581895828247, gen p mean: -0.05513811856508255, mean p set: 0.44661614298820496
loss_pred:0.016520418226718903, decouple_loss:0.0011170479701831937
loss_pred:0.016922585666179657, decouple_loss:0.0010627459269016981
The modified gen p mean: 0.4488821029663086, gen p mean: -0.0512351430952549, mean p set: 0.4493623375892639
loss_pred:0.01625009998679161, decouple_loss:0.0010774529073387384
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44649919867515564, gen p mean: -0.057013195008039474, mean p set: 0.44697946310043335
The modified gen p mean: 0.44815248250961304, gen p mean: -0.0517427921295166, mean p set: 0.44863274693489075
loss_pred:0.01662055402994156, decouple_loss:0.0012423604493960738
loss_pred:0.016405239701271057, decouple_loss:0.0010767803760245442
The modified gen p mean: 0.4474298357963562, gen p mean: -0.057140231132507324, mean p set: 0.4479101598262787
loss_pred:0.01685439981520176, decouple_loss:0.0012490543304011226
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461660385131836, gen p mean: -0.0516849160194397, mean p set: 0.4466463625431061
The modified gen p mean: 0.4470826983451843, gen p mean: -0.052937641739845276, mean p set: 0.4475629925727844
loss_pred:0.016802843660116196, decouple_loss:0.0010304233292117715
loss_pred:0.015771551057696342, decouple_loss:0.0009873812086880207
The modified gen p mean: 0.4487350285053253, gen p mean: -0.05418906733393669, mean p set: 0.4492153227329254
loss_pred:0.01689310371875763, decouple_loss:0.0010528520215302706
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473735988140106, gen p mean: -0.05303025245666504, mean p set: 0.4478538930416107
The modified gen p mean: 0.4483351409435272, gen p mean: -0.05080997571349144, mean p set: 0.44881540536880493
loss_pred:0.01577034592628479, decouple_loss:0.001041991519741714
loss_pred:0.01641942746937275, decouple_loss:0.00102416449226439
The modified gen p mean: 0.44806668162345886, gen p mean: -0.05014672130346298, mean p set: 0.44854697585105896
loss_pred:0.01686340756714344, decouple_loss:0.001121730892919004
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461888074874878, gen p mean: -0.05392596870660782, mean p set: 0.4466691315174103
The modified gen p mean: 0.44712474942207336, gen p mean: -0.05122403800487518, mean p set: 0.44760507345199585
loss_pred:0.016592804342508316, decouple_loss:0.0009870040230453014
loss_pred:0.01531368400901556, decouple_loss:0.0009786462178453803
The modified gen p mean: 0.4470779597759247, gen p mean: -0.053388554602861404, mean p set: 0.4475582540035248
loss_pred:0.016809513792395592, decouple_loss:0.000978413037955761
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448380708694458, gen p mean: -0.056559424847364426, mean p set: 0.4488610029220581
The modified gen p mean: 0.4455741345882416, gen p mean: -0.05133933201432228, mean p set: 0.4460543990135193
loss_pred:0.01684485748410225, decouple_loss:0.0009336147923022509
loss_pred:0.01646377146244049, decouple_loss:0.0009520449675619602
The modified gen p mean: 0.4464946985244751, gen p mean: -0.049867887049913406, mean p set: 0.4469749927520752
loss_pred:0.016973061487078667, decouple_loss:0.0009931165259331465
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475901424884796, gen p mean: -0.05690659210085869, mean p set: 0.4480704367160797
The modified gen p mean: 0.4472391903400421, gen p mean: -0.05602465569972992, mean p set: 0.4477194845676422
loss_pred:0.016048964112997055, decouple_loss:0.0011341514764353633
loss_pred:0.015480447560548782, decouple_loss:0.0011211459059268236
The modified gen p mean: 0.44720691442489624, gen p mean: -0.05415751412510872, mean p set: 0.4476872384548187
loss_pred:0.016057685017585754, decouple_loss:0.0010501645738258958
2023-05-01 16:53:11 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05631433427333832, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05267465114593506, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05308666080236435, mean p set: 0.45035696029663086
loss_pred:0.018471386283636093, decouple_loss:0.0010488909902051091
loss_pred:0.01749495230615139, decouple_loss:0.0010118621867150068
loss_pred:0.017294317483901978, decouple_loss:0.0010333191603422165
WV_0_PC_1_EH_0_PS_40, loss: 0.01780511997640133, avg_mse: 0.025646451860666275
current test mse: 0.025646
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829291105270386, gen p mean: -0.04948212951421738, mean p set: 0.44877323508262634
loss_pred:0.016556141898036003, decouple_loss:0.0009550806134939194
The modified gen p mean: 0.4476653039455414, gen p mean: -0.05473839119076729, mean p set: 0.4481455683708191The modified gen p mean: 0.44696420431137085, gen p mean: -0.05371614545583725, mean p set: 0.44744452834129333
loss_pred:0.016876742243766785, decouple_loss:0.0011056795483455062
loss_pred:0.016303010284900665, decouple_loss:0.001122217858210206
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44929268956184387, gen p mean: -0.05397489666938782, mean p set: 0.44977301359176636
The modified gen p mean: 0.4473145008087158, gen p mean: -0.052615705877542496, mean p set: 0.44779476523399353
loss_pred:0.01626734994351864, decouple_loss:0.00099706940818578
loss_pred:0.015260608866810799, decouple_loss:0.001015096204355359
The modified gen p mean: 0.4470619559288025, gen p mean: -0.05631793290376663, mean p set: 0.4475422501564026
loss_pred:0.01629917323589325, decouple_loss:0.0010597329819574952
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472741186618805, gen p mean: -0.061081405729055405, mean p set: 0.4477544128894806
loss_pred:0.016499696299433708, decouple_loss:0.0009363029967062175
The modified gen p mean: 0.4465456008911133, gen p mean: -0.05826692283153534, mean p set: 0.447025865316391The modified gen p mean: 0.44838374853134155, gen p mean: -0.051239509135484695, mean p set: 0.44886404275894165
loss_pred:0.015363822691142559, decouple_loss:0.0009931132663041353
loss_pred:0.016699790954589844, decouple_loss:0.0011266033397987485
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760578870773315, gen p mean: -0.05634516850113869, mean p set: 0.44808605313301086
loss_pred:0.01681322231888771, decouple_loss:0.0010624900460243225
The modified gen p mean: 0.4465150833129883, gen p mean: -0.05702279135584831, mean p set: 0.4469953775405884The modified gen p mean: 0.4467078745365143, gen p mean: -0.059736695140600204, mean p set: 0.4471881687641144
loss_pred:0.01688021421432495, decouple_loss:0.0010939092608168721
loss_pred:0.016343874856829643, decouple_loss:0.0009919963777065277
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718053936958313, gen p mean: -0.05302223935723305, mean p set: 0.4476608335971832
loss_pred:0.014952502213418484, decouple_loss:0.0009619441698305309
The modified gen p mean: 0.44831234216690063, gen p mean: -0.04980643093585968, mean p set: 0.44879260659217834The modified gen p mean: 0.44771137833595276, gen p mean: -0.05556630343198776, mean p set: 0.44819167256355286
loss_pred:0.016383761540055275, decouple_loss:0.0009317556396126747
loss_pred:0.016683153808116913, decouple_loss:0.0009464545291848481
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44564110040664673, gen p mean: -0.05785074084997177, mean p set: 0.44612136483192444
loss_pred:0.01651715114712715, decouple_loss:0.0011894690105691552
The modified gen p mean: 0.4466773569583893, gen p mean: -0.05658283829689026, mean p set: 0.4471576511859894The modified gen p mean: 0.4467546343803406, gen p mean: -0.05996057018637657, mean p set: 0.4472349286079407
loss_pred:0.01647191494703293, decouple_loss:0.0011188301723450422
loss_pred:0.016081947833299637, decouple_loss:0.0011662851320579648
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809791445732117, gen p mean: -0.05258774012327194, mean p set: 0.44857820868492126
loss_pred:0.016325710341334343, decouple_loss:0.0009661368676461279
The modified gen p mean: 0.44814085960388184, gen p mean: -0.053266316652297974, mean p set: 0.44862115383148193
The modified gen p mean: 0.4474761188030243, gen p mean: -0.05325760692358017, mean p set: 0.4479564428329468
loss_pred:0.01670527458190918, decouple_loss:0.0009813932701945305
loss_pred:0.016520598903298378, decouple_loss:0.0010230542393401265
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743454456329346, gen p mean: -0.05363244190812111, mean p set: 0.44791483879089355
The modified gen p mean: 0.44818711280822754, gen p mean: -0.05179581046104431, mean p set: 0.44866740703582764
loss_pred:0.016968054696917534, decouple_loss:0.0012151625705882907
loss_pred:0.016065940260887146, decouple_loss:0.0012174202129244804
The modified gen p mean: 0.44723373651504517, gen p mean: -0.05228646099567413, mean p set: 0.44771403074264526
loss_pred:0.016212809830904007, decouple_loss:0.0011817814083769917
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483150541782379, gen p mean: -0.049899060279130936, mean p set: 0.448795348405838
The modified gen p mean: 0.4474543035030365, gen p mean: -0.05320173501968384, mean p set: 0.4479345977306366
loss_pred:0.016037750989198685, decouple_loss:0.0012001373106613755
loss_pred:0.01613488234579563, decouple_loss:0.0010837465524673462
The modified gen p mean: 0.4484826624393463, gen p mean: -0.05172112584114075, mean p set: 0.448962926864624
loss_pred:0.01650262251496315, decouple_loss:0.0011740288464352489
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
NaN value num: 0
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502570331096649, gen p mean: -0.051740605384111404, mean p set: 0.450737327337265
loss_pred:0.01773330383002758, decouple_loss:0.0010174944764003158
The modified gen p mean: 0.4524064362049103, gen p mean: -0.04495153948664665, mean p set: 0.45288676023483276The modified gen p mean: 0.4501321315765381, gen p mean: -0.05148997902870178, mean p set: 0.4506123960018158
loss_pred:0.018087327480316162, decouple_loss:0.0010525143006816506
loss_pred:0.01714228466153145, decouple_loss:0.0010370602831244469
2023-05-01 16:55:46 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.053311675786972046, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.049772195518016815, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0500575453042984, mean p set: 0.45035696029663086
loss_pred:0.01838698610663414, decouple_loss:0.0011669573141261935
loss_pred:0.017380500212311745, decouple_loss:0.0011143810115754604
loss_pred:0.01719667762517929, decouple_loss:0.001130579737946391
WV_0_PC_1_EH_0_PS_40, loss: 0.017711587250232697, avg_mse: 0.02545325644314289
current test mse: 0.025453
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45204418897628784, gen p mean: -0.04500296711921692, mean p set: 0.4525245130062103
The modified gen p mean: 0.4489928185939789, gen p mean: -0.04652920365333557, mean p set: 0.4494730830192566
loss_pred:0.017231160774827003, decouple_loss:0.0010945521062240005
The modified gen p mean: 0.4492368698120117, gen p mean: -0.04822627454996109, mean p set: 0.4497171640396118
loss_pred:0.017813093960285187, decouple_loss:0.0010976101038977504
loss_pred:0.016728486865758896, decouple_loss:0.0011166144395247102
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493335485458374, gen p mean: -0.046936098486185074, mean p set: 0.4498138427734375
The modified gen p mean: 0.45123687386512756, gen p mean: -0.04082944244146347, mean p set: 0.45171716809272766
loss_pred:0.016721492633223534, decouple_loss:0.001040638075210154
loss_pred:0.018205156549811363, decouple_loss:0.0009930491214618087
The modified gen p mean: 0.449844092130661, gen p mean: -0.04807179048657417, mean p set: 0.4503243863582611
loss_pred:0.016885941848158836, decouple_loss:0.000927613815292716
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169979333877563, gen p mean: -0.04271902143955231, mean p set: 0.45218008756637573
loss_pred:0.017590653151273727, decouple_loss:0.0010879142209887505
The modified gen p mean: 0.4499744772911072, gen p mean: -0.050472624599933624, mean p set: 0.4504547715187073
The modified gen p mean: 0.45026251673698425, gen p mean: -0.05047421529889107, mean p set: 0.45074281096458435
loss_pred:0.01792156882584095, decouple_loss:0.0009941821917891502
loss_pred:0.018710877746343613, decouple_loss:0.0009981347247958183
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45142990350723267, gen p mean: -0.04031810536980629, mean p set: 0.45191019773483276
The modified gen p mean: 0.44976627826690674, gen p mean: -0.046885352581739426, mean p set: 0.4502466022968292
loss_pred:0.01743216998875141, decouple_loss:0.0009859083220362663
loss_pred:0.017708325758576393, decouple_loss:0.0008966498426161706
The modified gen p mean: 0.4514210820198059, gen p mean: -0.045743029564619064, mean p set: 0.4519013464450836
loss_pred:0.01751519925892353, decouple_loss:0.0009983971249312162
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522947669029236, gen p mean: -0.03852380812168121, mean p set: 0.4527750313282013
loss_pred:0.017112107947468758, decouple_loss:0.0010285357711836696
The modified gen p mean: 0.4489936828613281, gen p mean: -0.04834537208080292, mean p set: 0.4494739770889282The modified gen p mean: 0.4487507939338684, gen p mean: -0.045665595680475235, mean p set: 0.4492310881614685
loss_pred:0.017437366768717766, decouple_loss:0.0010617118095979095
loss_pred:0.01751745492219925, decouple_loss:0.001040299772284925
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517098665237427, gen p mean: -0.04364690184593201, mean p set: 0.45219019055366516
The modified gen p mean: 0.44944971799850464, gen p mean: -0.04456329345703125, mean p set: 0.44993001222610474loss_pred:0.01747485063970089, decouple_loss:0.0009745896677486598
The modified gen p mean: 0.4518701732158661, gen p mean: -0.040089745074510574, mean p set: 0.4523504674434662
loss_pred:0.01678837649524212, decouple_loss:0.0010534629691392183
loss_pred:0.01750076562166214, decouple_loss:0.0010487119434401393
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494214653968811, gen p mean: -0.046355169266462326, mean p set: 0.4499017596244812
The modified gen p mean: 0.45222026109695435, gen p mean: -0.038317617028951645, mean p set: 0.45270055532455444
loss_pred:0.017921896651387215, decouple_loss:0.00099963101092726
loss_pred:0.017268357798457146, decouple_loss:0.0010976585326716304
The modified gen p mean: 0.4504345655441284, gen p mean: -0.03990654647350311, mean p set: 0.4509148597717285
loss_pred:0.016757385805249214, decouple_loss:0.001049453392624855
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498606324195862, gen p mean: -0.0469411164522171, mean p set: 0.45034095644950867
The modified gen p mean: 0.4520311951637268, gen p mean: -0.04077262431383133, mean p set: 0.4525114893913269
loss_pred:0.017686912789940834, decouple_loss:0.0009648658451624215
loss_pred:0.017387935891747475, decouple_loss:0.0009624461526982486
The modified gen p mean: 0.451952189207077, gen p mean: -0.040821176022291183, mean p set: 0.4524324834346771
loss_pred:0.017157461494207382, decouple_loss:0.0010939891217276454
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203524827957153, gen p mean: -0.0412597730755806, mean p set: 0.452515572309494
The modified gen p mean: 0.4502771496772766, gen p mean: -0.04732170328497887, mean p set: 0.4507574439048767
loss_pred:0.01756758987903595, decouple_loss:0.0009890977526083589
loss_pred:0.018124833703041077, decouple_loss:0.0010659951949492097
The modified gen p mean: 0.4499061107635498, gen p mean: -0.04633815586566925, mean p set: 0.4503864049911499
loss_pred:0.018543623387813568, decouple_loss:0.0009558352758176625
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451761931180954, gen p mean: -0.04180043563246727, mean p set: 0.4522422254085541
The modified gen p mean: 0.4523381292819977, gen p mean: -0.04048962518572807, mean p set: 0.45281848311424255
loss_pred:0.017073312774300575, decouple_loss:0.00098394975066185
loss_pred:0.01677781529724598, decouple_loss:0.00111245340667665
The modified gen p mean: 0.45226559042930603, gen p mean: -0.036332130432128906, mean p set: 0.45274588465690613
loss_pred:0.016556762158870697, decouple_loss:0.0009806872112676501
2023-05-01 16:57:42 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05135367065668106, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.047516584396362305, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047758691012859344, mean p set: 0.45035696029663086
loss_pred:0.01829662173986435, decouple_loss:0.001080367132090032
loss_pred:0.017309226095676422, decouple_loss:0.0010675122030079365
loss_pred:0.017174284905195236, decouple_loss:0.0010616425424814224
WV_0_PC_1_EH_0_PS_40, loss: 0.017646869644522667, avg_mse: 0.025305159389972687
current test mse: 0.025305
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516895115375519, gen p mean: -0.04529600962996483, mean p set: 0.4521697759628296
loss_pred:0.01695626974105835, decouple_loss:0.0010670307092368603
The modified gen p mean: 0.450868159532547, gen p mean: -0.04267703741788864, mean p set: 0.4513484537601471The modified gen p mean: 0.4523078501224518, gen p mean: -0.043703265488147736, mean p set: 0.4527881443500519
loss_pred:0.017009953036904335, decouple_loss:0.0010555225890129805
loss_pred:0.017767617478966713, decouple_loss:0.0009685072000138462
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45140278339385986, gen p mean: -0.04128275811672211, mean p set: 0.45188307762145996
The modified gen p mean: 0.45030316710472107, gen p mean: -0.04186556860804558, mean p set: 0.4507834315299988
loss_pred:0.017840957269072533, decouple_loss:0.0009387598256580532
loss_pred:0.016651643440127373, decouple_loss:0.0009221534128300846
The modified gen p mean: 0.4522644281387329, gen p mean: -0.04213830456137657, mean p set: 0.452744722366333
loss_pred:0.01676584593951702, decouple_loss:0.0009704940603114665
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488823413848877, gen p mean: -0.049649927765131, mean p set: 0.4493626356124878
loss_pred:0.01686759479343891, decouple_loss:0.0009269918664358556
The modified gen p mean: 0.4491058588027954, gen p mean: -0.049752432852983475, mean p set: 0.4495861530303955The modified gen p mean: 0.4516439735889435, gen p mean: -0.04343052953481674, mean p set: 0.4521242678165436
loss_pred:0.017801322042942047, decouple_loss:0.000933111528865993
loss_pred:0.01810537278652191, decouple_loss:0.000921843689866364
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44993525743484497, gen p mean: -0.052841003984212875, mean p set: 0.4504155218601227
loss_pred:0.018992487341165543, decouple_loss:0.000903275387827307
The modified gen p mean: 0.44941064715385437, gen p mean: -0.05008438602089882, mean p set: 0.44989094138145447The modified gen p mean: 0.45021703839302063, gen p mean: -0.050945427268743515, mean p set: 0.4506973326206207
loss_pred:0.016731610521674156, decouple_loss:0.0010656946105882525
loss_pred:0.017172645777463913, decouple_loss:0.0010685508605092764
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949042797088623, gen p mean: -0.0519038662314415, mean p set: 0.44997072219848633
loss_pred:0.017591247335076332, decouple_loss:0.0008745086961425841
The modified gen p mean: 0.44988295435905457, gen p mean: -0.04354267194867134, mean p set: 0.45036324858665466The modified gen p mean: 0.45171207189559937, gen p mean: -0.047835465520620346, mean p set: 0.4521923363208771
loss_pred:0.016582723706960678, decouple_loss:0.0008967273752205074
loss_pred:0.017224382609128952, decouple_loss:0.0009238189668394625
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519215226173401, gen p mean: -0.042906664311885834, mean p set: 0.4524017870426178
The modified gen p mean: 0.4494694173336029, gen p mean: -0.05040740221738815, mean p set: 0.449949711561203
loss_pred:0.01664600521326065, decouple_loss:0.0009684694232419133
The modified gen p mean: 0.44881126284599304, gen p mean: -0.05031080171465874, mean p set: 0.44929152727127075
loss_pred:0.01652228832244873, decouple_loss:0.0009707087883725762
loss_pred:0.017143379896879196, decouple_loss:0.0009688128484413028
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227017998695374, gen p mean: -0.04416307434439659, mean p set: 0.45275044441223145
The modified gen p mean: 0.4519834518432617, gen p mean: -0.043505724519491196, mean p set: 0.4524637460708618
loss_pred:0.017111657187342644, decouple_loss:0.0010031257988885045
loss_pred:0.01779463142156601, decouple_loss:0.000922917970456183The modified gen p mean: 0.4528787434101105, gen p mean: -0.04442707821726799, mean p set: 0.45335903763771057
loss_pred:0.01702161878347397, decouple_loss:0.0010209620231762528
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147889852523804, gen p mean: -0.047445282340049744, mean p set: 0.45195919275283813
loss_pred:0.017641153186559677, decouple_loss:0.0009983559139072895
The modified gen p mean: 0.4521124064922333, gen p mean: -0.050122085958719254, mean p set: 0.4525927007198334The modified gen p mean: 0.44973355531692505, gen p mean: -0.04913954436779022, mean p set: 0.45021387934684753
loss_pred:0.01698632352054119, decouple_loss:0.0009866752661764622
loss_pred:0.016870670020580292, decouple_loss:0.0010320820147171617
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486709535121918, gen p mean: -0.05019911751151085, mean p set: 0.44915124773979187
The modified gen p mean: 0.4500156044960022, gen p mean: -0.04919937998056412, mean p set: 0.4504959285259247
loss_pred:0.016698451712727547, decouple_loss:0.0010325862094759941
loss_pred:0.017580341547727585, decouple_loss:0.000980588374659419
The modified gen p mean: 0.4498410224914551, gen p mean: -0.04588901996612549, mean p set: 0.4503213167190552
loss_pred:0.016425255686044693, decouple_loss:0.0010076717007905245
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
NaN value num: 0
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012199878692627, gen p mean: -0.04651668667793274, mean p set: 0.45060229301452637
loss_pred:0.015651514753699303, decouple_loss:0.0011502566048875451
The modified gen p mean: 0.44942229986190796, gen p mean: -0.04634195566177368, mean p set: 0.44990259408950806The modified gen p mean: 0.4498848021030426, gen p mean: -0.043584249913692474, mean p set: 0.4503651261329651
loss_pred:0.015960220247507095, decouple_loss:0.0011906137224286795
loss_pred:0.015907347202301025, decouple_loss:0.0010825005592778325
2023-05-01 17:00:25 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05366641283035278, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.049801845103502274, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0499347448348999, mean p set: 0.45035696029663086
loss_pred:0.018298732116818428, decouple_loss:0.0011306386440992355
loss_pred:0.017340408638119698, decouple_loss:0.001090984558686614
loss_pred:0.017195239663124084, decouple_loss:0.0010662877466529608
WV_0_PC_1_EH_0_PS_40, loss: 0.017666257917881012, avg_mse: 0.025326110422611237
current test mse: 0.025326
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502868950366974, gen p mean: -0.03952409327030182, mean p set: 0.4507671892642975
The modified gen p mean: 0.4489588439464569, gen p mean: -0.04496019706130028, mean p set: 0.449439138174057
loss_pred:0.016024813055992126, decouple_loss:0.001057573244906962
The modified gen p mean: 0.44965460896492004, gen p mean: -0.03763647750020027, mean p set: 0.45013487339019775
loss_pred:0.016049416735768318, decouple_loss:0.0009896436240524054
loss_pred:0.015865931287407875, decouple_loss:0.0011509815230965614
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447522908449173, gen p mean: -0.044380467385053635, mean p set: 0.44800323247909546
The modified gen p mean: 0.45023879408836365, gen p mean: -0.0414569228887558, mean p set: 0.45071908831596375
loss_pred:0.015873705968260765, decouple_loss:0.001069077174179256
loss_pred:0.016073206439614296, decouple_loss:0.0011576133547350764
The modified gen p mean: 0.44859281182289124, gen p mean: -0.04139009118080139, mean p set: 0.44907310605049133
loss_pred:0.01613849774003029, decouple_loss:0.0011060611577704549
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473850131034851, gen p mean: -0.03916720300912857, mean p set: 0.4478653073310852
The modified gen p mean: 0.4503134489059448, gen p mean: -0.03956277295947075, mean p set: 0.4507937431335449
loss_pred:0.016112685203552246, decouple_loss:0.0010366769274696708
loss_pred:0.015315522439777851, decouple_loss:0.00103418854996562
The modified gen p mean: 0.447441041469574, gen p mean: -0.04280905798077583, mean p set: 0.4479213356971741
loss_pred:0.01505777146667242, decouple_loss:0.001040446455590427
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007219910621643, gen p mean: -0.03697648271918297, mean p set: 0.45055249333381653
The modified gen p mean: 0.449121356010437, gen p mean: -0.04035729542374611, mean p set: 0.4496016502380371
loss_pred:0.01496428158134222, decouple_loss:0.0010789928492158651
loss_pred:0.016158327460289, decouple_loss:0.0011995083186775446
The modified gen p mean: 0.4478377103805542, gen p mean: -0.04046215862035751, mean p set: 0.4483179748058319
loss_pred:0.015801943838596344, decouple_loss:0.0010260619455948472
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44976675510406494, gen p mean: -0.03461146354675293, mean p set: 0.4502470791339874
loss_pred:0.01613765023648739, decouple_loss:0.001015830202959478
The modified gen p mean: 0.4481179416179657, gen p mean: -0.0345909409224987, mean p set: 0.4485982656478882The modified gen p mean: 0.4505457878112793, gen p mean: -0.03533157333731651, mean p set: 0.4510261118412018
loss_pred:0.01627075858414173, decouple_loss:0.0011506164446473122
loss_pred:0.015031637623906136, decouple_loss:0.001033024163916707
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44838857650756836, gen p mean: -0.038509514182806015, mean p set: 0.44886893033981323
The modified gen p mean: 0.4500086307525635, gen p mean: -0.032802075147628784, mean p set: 0.4504888951778412
The modified gen p mean: 0.447834849357605, gen p mean: -0.03677717223763466, mean p set: 0.4483151137828827
loss_pred:0.015881530940532684, decouple_loss:0.0011371939908713102
loss_pred:0.01491865050047636, decouple_loss:0.0010996083728969097
loss_pred:0.015728838741779327, decouple_loss:0.0009911818196997046
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817742705345154, gen p mean: -0.03857379034161568, mean p set: 0.44865772128105164
The modified gen p mean: 0.44747990369796753, gen p mean: -0.0444345660507679, mean p set: 0.4479601979255676
loss_pred:0.015302745625376701, decouple_loss:0.001132078468799591
loss_pred:0.014427111484110355, decouple_loss:0.0011347290128469467
The modified gen p mean: 0.4498419165611267, gen p mean: -0.03848029673099518, mean p set: 0.4503222107887268
loss_pred:0.015619966201484203, decouple_loss:0.001221235143020749
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847986102104187, gen p mean: -0.0358087494969368, mean p set: 0.44896015524864197
The modified gen p mean: 0.4486122727394104, gen p mean: -0.04112713038921356, mean p set: 0.4490925371646881
loss_pred:0.016164302825927734, decouple_loss:0.0011345073580741882
loss_pred:0.015504343435168266, decouple_loss:0.001050627208314836
The modified gen p mean: 0.447145938873291, gen p mean: -0.04338904097676277, mean p set: 0.4476262331008911
loss_pred:0.014440331608057022, decouple_loss:0.0010837041772902012
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450177401304245, gen p mean: -0.03798492252826691, mean p set: 0.4506576955318451
loss_pred:0.015322629362344742, decouple_loss:0.0011348928092047572
The modified gen p mean: 0.44985494017601013, gen p mean: -0.032501470297575, mean p set: 0.45033523440361023The modified gen p mean: 0.4500276744365692, gen p mean: -0.03703823685646057, mean p set: 0.4505079984664917
loss_pred:0.015711836516857147, decouple_loss:0.0010918030748143792
loss_pred:0.014982016757130623, decouple_loss:0.0011085435980930924
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502808153629303, gen p mean: -0.03831375390291214, mean p set: 0.4507611393928528
The modified gen p mean: 0.4497024118900299, gen p mean: -0.03371107578277588, mean p set: 0.4501826763153076
loss_pred:0.016053881496191025, decouple_loss:0.001226719468832016
loss_pred:0.014667591080069542, decouple_loss:0.0011580493301153183
The modified gen p mean: 0.4507506787776947, gen p mean: -0.037964411079883575, mean p set: 0.4512310028076172
loss_pred:0.014572618529200554, decouple_loss:0.0011155282845720649
2023-05-01 17:02:20 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.050825294107198715, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04733465984463692, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04763614386320114, mean p set: 0.45035696029663086
loss_pred:0.018626244738698006, decouple_loss:0.0012174679432064295
loss_pred:0.0173636581748724, decouple_loss:0.0011161771835759282loss_pred:0.017543014138936996, decouple_loss:0.0011374409077689052
WV_0_PC_1_EH_0_PS_40, loss: 0.017902158200740814, avg_mse: 0.02576206438243389
current test mse: 0.025762
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485941231250763, gen p mean: -0.044141728430986404, mean p set: 0.4490744471549988
The modified gen p mean: 0.45001155138015747, gen p mean: -0.0429983027279377, mean p set: 0.45049184560775757loss_pred:0.01535706128925085, decouple_loss:0.0011072243796661496
The modified gen p mean: 0.4481814205646515, gen p mean: -0.042124588042497635, mean p set: 0.4486616849899292
loss_pred:0.01589575968682766, decouple_loss:0.0011134831001982093
loss_pred:0.016270767897367477, decouple_loss:0.0011135900858789682
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44734182953834534, gen p mean: -0.04191422089934349, mean p set: 0.44782212376594543
loss_pred:0.015823323279619217, decouple_loss:0.00109192228410393
The modified gen p mean: 0.44839757680892944, gen p mean: -0.04089466854929924, mean p set: 0.44887787103652954The modified gen p mean: 0.44791412353515625, gen p mean: -0.04282219335436821, mean p set: 0.44839444756507874
loss_pred:0.014685788191854954, decouple_loss:0.0011198627762496471
loss_pred:0.01617930270731449, decouple_loss:0.0010955666657537222
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44850990176200867, gen p mean: -0.044464606791734695, mean p set: 0.44899022579193115
The modified gen p mean: 0.44778764247894287, gen p mean: -0.043518491089344025, mean p set: 0.4482679069042206
loss_pred:0.0152774378657341, decouple_loss:0.0011530760675668716
loss_pred:0.015549733303487301, decouple_loss:0.001091339741833508
The modified gen p mean: 0.44746989011764526, gen p mean: -0.042107027024030685, mean p set: 0.447950154542923
loss_pred:0.015460514463484287, decouple_loss:0.0011328427353873849
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44989433884620667, gen p mean: -0.03715711459517479, mean p set: 0.4503746032714844
The modified gen p mean: 0.4506209194660187, gen p mean: -0.03687455877661705, mean p set: 0.4511011838912964
loss_pred:0.015383617021143436, decouple_loss:0.0010828626109287143
loss_pred:0.015514872036874294, decouple_loss:0.0011913813650608063
The modified gen p mean: 0.4484219253063202, gen p mean: -0.03734895586967468, mean p set: 0.4489021897315979
loss_pred:0.015141167677938938, decouple_loss:0.0011147225741297007
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45067402720451355, gen p mean: -0.03844220191240311, mean p set: 0.45115435123443604
The modified gen p mean: 0.44774147868156433, gen p mean: -0.03435336798429489, mean p set: 0.44822174310684204
loss_pred:0.01585172861814499, decouple_loss:0.0011428267462179065
loss_pred:0.0161778274923563, decouple_loss:0.0011648274958133698
The modified gen p mean: 0.44818419218063354, gen p mean: -0.042684320360422134, mean p set: 0.44866451621055603
loss_pred:0.014940310269594193, decouple_loss:0.0012196670286357403
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900307059288025, gen p mean: -0.04067974165081978, mean p set: 0.44948336482048035
loss_pred:0.015860460698604584, decouple_loss:0.0010568861616775393
The modified gen p mean: 0.44726622104644775, gen p mean: -0.044137805700302124, mean p set: 0.44774648547172546The modified gen p mean: 0.448388010263443, gen p mean: -0.040127430111169815, mean p set: 0.4488682746887207
loss_pred:0.014617611654102802, decouple_loss:0.0011875955387949944
loss_pred:0.014652805402874947, decouple_loss:0.0010966080008074641
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968754053115845, gen p mean: -0.0313408263027668, mean p set: 0.45016783475875854
The modified gen p mean: 0.45013856887817383, gen p mean: -0.03917018696665764, mean p set: 0.4506188929080963
loss_pred:0.014855117537081242, decouple_loss:0.0012445671018213034
loss_pred:0.01511367503553629, decouple_loss:0.0011949826730415225
The modified gen p mean: 0.45033779740333557, gen p mean: -0.037483058869838715, mean p set: 0.45081809163093567
loss_pred:0.015319915488362312, decouple_loss:0.001385619631037116
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040223002433777, gen p mean: -0.0348874107003212, mean p set: 0.45088252425193787
loss_pred:0.0153254559263587, decouple_loss:0.0011413259198889136
The modified gen p mean: 0.45010942220687866, gen p mean: -0.03625112399458885, mean p set: 0.45058971643447876The modified gen p mean: 0.44740962982177734, gen p mean: -0.038988146930933, mean p set: 0.44788995385169983
loss_pred:0.01458453107625246, decouple_loss:0.0012355155777186155
loss_pred:0.014763139188289642, decouple_loss:0.001178749487735331
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44833803176879883, gen p mean: -0.03523225709795952, mean p set: 0.44881829619407654
loss_pred:0.015608458779752254, decouple_loss:0.001109811128117144
The modified gen p mean: 0.45063212513923645, gen p mean: -0.033783748745918274, mean p set: 0.45111238956451416The modified gen p mean: 0.4477819502353668, gen p mean: -0.03442416340112686, mean p set: 0.44826221466064453
loss_pred:0.015822097659111023, decouple_loss:0.0011194470571354032
loss_pred:0.015977025032043457, decouple_loss:0.0011808814015239477
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
NaN value num: 0
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504455626010895, gen p mean: -0.04155007004737854, mean p set: 0.4509258568286896
loss_pred:0.016533438116312027, decouple_loss:0.0012233441229909658
The modified gen p mean: 0.45227620005607605, gen p mean: -0.03559866175055504, mean p set: 0.45275649428367615The modified gen p mean: 0.4514411389827728, gen p mean: -0.04046843945980072, mean p set: 0.4519214332103729
loss_pred:0.015792906284332275, decouple_loss:0.001108974334783852
loss_pred:0.015834396705031395, decouple_loss:0.001029712031595409
2023-05-01 17:04:54 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04841111972928047, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.044644907116889954, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04505506157875061, mean p set: 0.45035696029663086
loss_pred:0.018525831401348114, decouple_loss:0.0012807269813492894
loss_pred:0.017482293769717216, decouple_loss:0.0012595218140631914
loss_pred:0.017331745475530624, decouple_loss:0.0012163969222456217
WV_0_PC_1_EH_0_PS_40, loss: 0.017842566594481468, avg_mse: 0.025678906589746475
current test mse: 0.025679
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975748658180237, gen p mean: -0.04711072891950607, mean p set: 0.45023781061172485
The modified gen p mean: 0.44997966289520264, gen p mean: -0.03776988387107849, mean p set: 0.45045995712280273
loss_pred:0.016200143843889236, decouple_loss:0.0012312893522903323
The modified gen p mean: 0.4513234794139862, gen p mean: -0.04302089661359787, mean p set: 0.4518038034439087
loss_pred:0.01628139056265354, decouple_loss:0.0012618120526894927
loss_pred:0.01569356396794319, decouple_loss:0.0011597552802413702
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945916533470154, gen p mean: -0.04778493568301201, mean p set: 0.44993945956230164
The modified gen p mean: 0.4510818123817444, gen p mean: -0.04104572534561157, mean p set: 0.45156213641166687
loss_pred:0.015847843140363693, decouple_loss:0.001022215699777007
loss_pred:0.017060955986380577, decouple_loss:0.0011016775388270617
The modified gen p mean: 0.448527067899704, gen p mean: -0.041582029312849045, mean p set: 0.44900739192962646
loss_pred:0.016414735466241837, decouple_loss:0.0011525623267516494
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45283541083335876, gen p mean: -0.035440314561128616, mean p set: 0.4533156752586365
loss_pred:0.016365280374884605, decouple_loss:0.001210482674650848
The modified gen p mean: 0.4505431652069092, gen p mean: -0.04567515105009079, mean p set: 0.4510234594345093The modified gen p mean: 0.44949978590011597, gen p mean: -0.03732291981577873, mean p set: 0.4499800503253937
loss_pred:0.016745634377002716, decouple_loss:0.0011482457630336285
loss_pred:0.016412895172834396, decouple_loss:0.0011608772911131382
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476179778575897, gen p mean: -0.05084016174077988, mean p set: 0.44809824228286743
loss_pred:0.0157272107899189, decouple_loss:0.0010819743620231748
The modified gen p mean: 0.4514024555683136, gen p mean: -0.04375232383608818, mean p set: 0.4518826901912689
The modified gen p mean: 0.45181918144226074, gen p mean: -0.03891842067241669, mean p set: 0.4522995054721832
loss_pred:0.01653604581952095, decouple_loss:0.001106112846173346
loss_pred:0.015294024720788002, decouple_loss:0.0011200139997527003
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890162348747253, gen p mean: -0.042727191001176834, mean p set: 0.449381947517395
The modified gen p mean: 0.45092496275901794, gen p mean: -0.04219576343894005, mean p set: 0.45140528678894043
loss_pred:0.01639058254659176, decouple_loss:0.001252475893124938
loss_pred:0.01565137691795826, decouple_loss:0.001218150369822979
The modified gen p mean: 0.45104700326919556, gen p mean: -0.04243525490164757, mean p set: 0.45152729749679565
loss_pred:0.016287345439195633, decouple_loss:0.0011302391067147255
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514114260673523, gen p mean: -0.04032033309340477, mean p set: 0.4518917500972748
loss_pred:0.015823548659682274, decouple_loss:0.0010665814625099301
The modified gen p mean: 0.4505285322666168, gen p mean: -0.043509796261787415, mean p set: 0.4510088264942169The modified gen p mean: 0.4500935971736908, gen p mean: -0.0500083863735199, mean p set: 0.4505738615989685
loss_pred:0.01515527255833149, decouple_loss:0.0010248897597193718
loss_pred:0.015439863316714764, decouple_loss:0.0010807029902935028
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497659504413605, gen p mean: -0.04838436469435692, mean p set: 0.45024624466896057
loss_pred:0.01588577777147293, decouple_loss:0.0011981164570897818
The modified gen p mean: 0.4501246213912964, gen p mean: -0.04548165947198868, mean p set: 0.45060494542121887The modified gen p mean: 0.4502885341644287, gen p mean: -0.04504787549376488, mean p set: 0.4507688283920288
loss_pred:0.016615845263004303, decouple_loss:0.0011506472947075963
loss_pred:0.016352280974388123, decouple_loss:0.0010995380580425262
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504621624946594, gen p mean: -0.041683897376060486, mean p set: 0.4509424567222595
loss_pred:0.016073191538453102, decouple_loss:0.0010716557735577226
The modified gen p mean: 0.451458603143692, gen p mean: -0.043506234884262085, mean p set: 0.45193883776664734The modified gen p mean: 0.4513724744319916, gen p mean: -0.042549893260002136, mean p set: 0.4518527686595917
loss_pred:0.015965953469276428, decouple_loss:0.0011367745464667678
loss_pred:0.015740131959319115, decouple_loss:0.0011240254389122128
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490024149417877, gen p mean: -0.04861432686448097, mean p set: 0.4494827091693878The modified gen p mean: 0.45216304063796997, gen p mean: -0.03911479189991951, mean p set: 0.45264333486557007
The modified gen p mean: 0.4486375153064728, gen p mean: -0.04426804184913635, mean p set: 0.44911783933639526
loss_pred:0.016154633834958076, decouple_loss:0.001092075603082776
loss_pred:0.01549268513917923, decouple_loss:0.0011531797936186194
loss_pred:0.015855111181735992, decouple_loss:0.0011652234243229032
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524897634983063, gen p mean: -0.042796675115823746, mean p set: 0.45297008752822876
The modified gen p mean: 0.44904351234436035, gen p mean: -0.04498739913105965, mean p set: 0.44952380657196045
loss_pred:0.01560308039188385, decouple_loss:0.0010515919420868158
loss_pred:0.015841837972402573, decouple_loss:0.0010770739754661918
The modified gen p mean: 0.45199528336524963, gen p mean: -0.045188963413238525, mean p set: 0.45247551798820496
loss_pred:0.015956301242113113, decouple_loss:0.0011460210662335157
2023-05-01 17:06:51 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04904007166624069, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04483876749873161, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04524834454059601, mean p set: 0.45035696029663086
loss_pred:0.01839173212647438, decouple_loss:0.0011321058264002204
loss_pred:0.017379915341734886, decouple_loss:0.0010910405544564128loss_pred:0.017239442095160484, decouple_loss:0.0010730961803346872
WV_0_PC_1_EH_0_PS_40, loss: 0.017725300043821335, avg_mse: 0.025467993691563606
current test mse: 0.025468
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493713080883026, gen p mean: -0.043694332242012024, mean p set: 0.4498515725135803
The modified gen p mean: 0.44969338178634644, gen p mean: -0.043391622602939606, mean p set: 0.45017367601394653
loss_pred:0.015359072014689445, decouple_loss:0.0010313917882740498
The modified gen p mean: 0.44860783219337463, gen p mean: -0.0502038449048996, mean p set: 0.44908812642097473
loss_pred:0.01580990105867386, decouple_loss:0.0010372831020504236
loss_pred:0.01554738637059927, decouple_loss:0.001138934982009232
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514055550098419, gen p mean: -0.04088960587978363, mean p set: 0.451885849237442
loss_pred:0.016201935708522797, decouple_loss:0.001056529232300818
The modified gen p mean: 0.4500460922718048, gen p mean: -0.03716393932700157, mean p set: 0.4505264163017273The modified gen p mean: 0.4517676532268524, gen p mean: -0.039547163993120193, mean p set: 0.4522479474544525
loss_pred:0.015585914254188538, decouple_loss:0.0010378104634582996
loss_pred:0.0152292400598526, decouple_loss:0.0010269354097545147
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485812485218048, gen p mean: -0.03570268675684929, mean p set: 0.4490615427494049
loss_pred:0.0170435830950737, decouple_loss:0.0012952173128724098
The modified gen p mean: 0.4521656334400177, gen p mean: -0.03761124610900879, mean p set: 0.4526459276676178The modified gen p mean: 0.44915926456451416, gen p mean: -0.034829869866371155, mean p set: 0.44963955879211426
loss_pred:0.015882616862654686, decouple_loss:0.0012303562834858894
loss_pred:0.016259690746665, decouple_loss:0.0011379144852980971
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478793740272522, gen p mean: -0.03531704470515251, mean p set: 0.4483596682548523
loss_pred:0.01700958050787449, decouple_loss:0.0010055392049252987
The modified gen p mean: 0.4490102231502533, gen p mean: -0.04706813767552376, mean p set: 0.4494905471801758The modified gen p mean: 0.4485863745212555, gen p mean: -0.04692908003926277, mean p set: 0.4490666687488556
loss_pred:0.015520799905061722, decouple_loss:0.0011610364308580756
loss_pred:0.015700191259384155, decouple_loss:0.0011171073419973254
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978219270706177, gen p mean: -0.04579010233283043, mean p set: 0.45026248693466187
The modified gen p mean: 0.44910693168640137, gen p mean: -0.04103586822748184, mean p set: 0.44958722591400146
loss_pred:0.016588186845183372, decouple_loss:0.001212393050082028
loss_pred:0.016197800636291504, decouple_loss:0.001109367934986949
The modified gen p mean: 0.4501555562019348, gen p mean: -0.04048812389373779, mean p set: 0.4506358802318573
loss_pred:0.016766082495450974, decouple_loss:0.0011731931008398533
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503028690814972, gen p mean: -0.03802141547203064, mean p set: 0.4507831633090973
The modified gen p mean: 0.44893309473991394, gen p mean: -0.0509626641869545, mean p set: 0.44941338896751404
loss_pred:0.01665346883237362, decouple_loss:0.0010098334169015288
The modified gen p mean: 0.4493011236190796, gen p mean: -0.03743068873882294, mean p set: 0.4497814178466797
loss_pred:0.015566396526992321, decouple_loss:0.001111758640035987
loss_pred:0.01650613732635975, decouple_loss:0.0009126245859079063
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500269293785095, gen p mean: -0.04292656481266022, mean p set: 0.4505072236061096
loss_pred:0.01574261300265789, decouple_loss:0.0010275308741256595
The modified gen p mean: 0.44928374886512756, gen p mean: -0.04306056350469589, mean p set: 0.44976404309272766The modified gen p mean: 0.45017823576927185, gen p mean: -0.04421533644199371, mean p set: 0.45065850019454956
loss_pred:0.016090355813503265, decouple_loss:0.0010307524353265762
loss_pred:0.01578153856098652, decouple_loss:0.0011708078673109412
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477841854095459, gen p mean: -0.04306744411587715, mean p set: 0.4482645094394684
loss_pred:0.01681475155055523, decouple_loss:0.0009948230581358075
The modified gen p mean: 0.44982659816741943, gen p mean: -0.04744107648730278, mean p set: 0.45030689239501953The modified gen p mean: 0.4500126540660858, gen p mean: -0.048490699380636215, mean p set: 0.4504929184913635
loss_pred:0.015608659014105797, decouple_loss:0.0009692818275652826
loss_pred:0.016063833609223366, decouple_loss:0.0009534519631415606
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490276575088501, gen p mean: -0.05057726427912712, mean p set: 0.4495079815387726
The modified gen p mean: 0.4497230648994446, gen p mean: -0.04876963049173355, mean p set: 0.4502033293247223
loss_pred:0.015867166221141815, decouple_loss:0.0009670629515312612
loss_pred:0.015900887548923492, decouple_loss:0.001126580173149705The modified gen p mean: 0.4499203860759735, gen p mean: -0.04259157553315163, mean p set: 0.4504006803035736
loss_pred:0.015987524762749672, decouple_loss:0.0011238900478929281
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484025537967682, gen p mean: -0.047884851694107056, mean p set: 0.4488828480243683
loss_pred:0.01456485129892826, decouple_loss:0.0011729965917766094
The modified gen p mean: 0.4484126567840576, gen p mean: -0.05332523584365845, mean p set: 0.4488929510116577The modified gen p mean: 0.44944050908088684, gen p mean: -0.05037185177206993, mean p set: 0.44992080330848694
loss_pred:0.014581715688109398, decouple_loss:0.0011221586028113961
loss_pred:0.015011937357485294, decouple_loss:0.0012533955741673708
2023-05-01 17:09:26 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05446723848581314, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.050378959625959396, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050604499876499176, mean p set: 0.45035696029663086
loss_pred:0.0184673760086298, decouple_loss:0.0011002118699252605
loss_pred:0.017313089221715927, decouple_loss:0.0011033698683604598loss_pred:0.017413031309843063, decouple_loss:0.0011131170904263854
WV_0_PC_1_EH_0_PS_40, loss: 0.01778644509613514, avg_mse: 0.02559531480073929
current test mse: 0.025595
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858604669570923, gen p mean: -0.05699415132403374, mean p set: 0.4490663409233093
loss_pred:0.014247264713048935, decouple_loss:0.0010822047479450703
The modified gen p mean: 0.44835829734802246, gen p mean: -0.057540278881788254, mean p set: 0.44883859157562256The modified gen p mean: 0.44881996512413025, gen p mean: -0.05514805018901825, mean p set: 0.44930025935173035
loss_pred:0.014062085188925266, decouple_loss:0.0010794950649142265
loss_pred:0.014396495185792446, decouple_loss:0.0010905270464718342
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485201835632324, gen p mean: -0.05429479107260704, mean p set: 0.44900044798851013
loss_pred:0.014456184580922127, decouple_loss:0.001097026513889432
The modified gen p mean: 0.4481617510318756, gen p mean: -0.05250263586640358, mean p set: 0.4486420452594757The modified gen p mean: 0.44895660877227783, gen p mean: -0.05338544398546219, mean p set: 0.44943690299987793
loss_pred:0.01401754841208458, decouple_loss:0.0010462709469720721
loss_pred:0.014805621467530727, decouple_loss:0.001135924831032753
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840681552886963, gen p mean: -0.055211663246154785, mean p set: 0.4488871097564697
loss_pred:0.014598165638744831, decouple_loss:0.0011963112046942115
The modified gen p mean: 0.4481826722621918, gen p mean: -0.05497583746910095, mean p set: 0.44866296648979187The modified gen p mean: 0.4478693902492523, gen p mean: -0.05527111142873764, mean p set: 0.44834965467453003
loss_pred:0.014420537278056145, decouple_loss:0.0014905735151842237
loss_pred:0.014443234540522099, decouple_loss:0.0016017648158594966
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44917911291122437, gen p mean: -0.05218752846121788, mean p set: 0.44965940713882446
loss_pred:0.0139889782294631, decouple_loss:0.0011700253235176206
The modified gen p mean: 0.4487597942352295, gen p mean: -0.05628523230552673, mean p set: 0.4492400586605072The modified gen p mean: 0.4471559524536133, gen p mean: -0.05737607181072235, mean p set: 0.4476362466812134
loss_pred:0.014633867889642715, decouple_loss:0.0011149771744385362
loss_pred:0.014506259001791477, decouple_loss:0.001102699083276093
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485422968864441, gen p mean: -0.052166648209095, mean p set: 0.4490225911140442
The modified gen p mean: 0.4497270882129669, gen p mean: -0.05361125245690346, mean p set: 0.450207382440567
loss_pred:0.014168575406074524, decouple_loss:0.001261051744222641
loss_pred:0.014118905179202557, decouple_loss:0.001357781933620572
The modified gen p mean: 0.4474776089191437, gen p mean: -0.06015727296471596, mean p set: 0.4479579031467438
loss_pred:0.014035518281161785, decouple_loss:0.0013770587975159287
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784513115882874, gen p mean: -0.051746923476457596, mean p set: 0.44832542538642883
The modified gen p mean: 0.448650598526001, gen p mean: -0.05131750926375389, mean p set: 0.44913092255592346
loss_pred:0.013871178030967712, decouple_loss:0.001413593883626163
loss_pred:0.0139312157407403, decouple_loss:0.0012714850017800927
The modified gen p mean: 0.4489496946334839, gen p mean: -0.04954571649432182, mean p set: 0.449429988861084
loss_pred:0.014311138540506363, decouple_loss:0.0012175660813227296
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485883116722107, gen p mean: -0.04983523488044739, mean p set: 0.4490686058998108
The modified gen p mean: 0.4480079710483551, gen p mean: -0.051370106637477875, mean p set: 0.4484882652759552
loss_pred:0.0148916682228446, decouple_loss:0.0012579836184158921
loss_pred:0.013901362195611, decouple_loss:0.001436615246348083
The modified gen p mean: 0.44793662428855896, gen p mean: -0.04535350576043129, mean p set: 0.44841691851615906
loss_pred:0.013751335442066193, decouple_loss:0.0012939471052959561
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477083086967468, gen p mean: -0.043404340744018555, mean p set: 0.4481886029243469
The modified gen p mean: 0.4480856657028198, gen p mean: -0.050007414072752, mean p set: 0.4485659599304199
loss_pred:0.013824138790369034, decouple_loss:0.0012555650901049376
loss_pred:0.013739722780883312, decouple_loss:0.0012984711211174726
The modified gen p mean: 0.4494444727897644, gen p mean: -0.04900268092751503, mean p set: 0.4499247372150421
loss_pred:0.013839829713106155, decouple_loss:0.0012447801418602467
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487764537334442, gen p mean: -0.046696022152900696, mean p set: 0.4492567181587219
The modified gen p mean: 0.44761672616004944, gen p mean: -0.04474424198269844, mean p set: 0.4480970501899719
loss_pred:0.013773668557405472, decouple_loss:0.0013685596641153097
loss_pred:0.013684882782399654, decouple_loss:0.0012829839251935482
The modified gen p mean: 0.44884926080703735, gen p mean: -0.04567313194274902, mean p set: 0.44932955503463745
loss_pred:0.014413081109523773, decouple_loss:0.0013379609445109963
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447609543800354, gen p mean: -0.04939828813076019, mean p set: 0.4480898678302765
loss_pred:0.013966552913188934, decouple_loss:0.00134747545234859
The modified gen p mean: 0.44923079013824463, gen p mean: -0.041030194610357285, mean p set: 0.44971105456352234The modified gen p mean: 0.44882193207740784, gen p mean: -0.04368480667471886, mean p set: 0.44930222630500793
loss_pred:0.014119323343038559, decouple_loss:0.0013377872528508306
loss_pred:0.014225278981029987, decouple_loss:0.0013884964864701033
2023-05-01 17:11:22 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.051475219428539276, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.047376323491334915, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04790287837386131, mean p set: 0.45035696029663086
loss_pred:0.01914197765290737, decouple_loss:0.001434515928849578
loss_pred:0.018030410632491112, decouple_loss:0.0013032209826633334
loss_pred:0.01795174553990364, decouple_loss:0.0013257123064249754
WV_0_PC_1_EH_0_PS_40, loss: 0.018442437052726746, avg_mse: 0.02679339610040188
current test mse: 0.026793
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476867914199829, gen p mean: -0.043017491698265076, mean p set: 0.4481671154499054
loss_pred:0.013774430379271507, decouple_loss:0.001200937433168292
The modified gen p mean: 0.4481750428676605, gen p mean: -0.05417301505804062, mean p set: 0.4486553370952606The modified gen p mean: 0.4486697316169739, gen p mean: -0.05542144179344177, mean p set: 0.449150025844574
loss_pred:0.013915261253714561, decouple_loss:0.001309809973463416
loss_pred:0.013814987614750862, decouple_loss:0.0013326940825209022
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868406653404236, gen p mean: -0.047435108572244644, mean p set: 0.44916436076164246
loss_pred:0.013426894322037697, decouple_loss:0.001376946223899722
The modified gen p mean: 0.44744542241096497, gen p mean: -0.056367021054029465, mean p set: 0.4479256868362427The modified gen p mean: 0.44782355427742004, gen p mean: -0.045877855271101, mean p set: 0.44830384850502014
loss_pred:0.013659455813467503, decouple_loss:0.0013707412872463465
loss_pred:0.013406054116785526, decouple_loss:0.0013282927684485912
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971179962158203, gen p mean: -0.050361890345811844, mean p set: 0.45019209384918213
loss_pred:0.014107748866081238, decouple_loss:0.0013021776685491204
The modified gen p mean: 0.4491414427757263, gen p mean: -0.04465113580226898, mean p set: 0.4496217370033264The modified gen p mean: 0.4491707384586334, gen p mean: -0.05727977678179741, mean p set: 0.4496510326862335
loss_pred:0.013813257217407227, decouple_loss:0.0012149045942351222
loss_pred:0.013655412010848522, decouple_loss:0.0013673232169821858
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478321671485901, gen p mean: -0.0468577966094017, mean p set: 0.4483124613761902
loss_pred:0.013381468132138252, decouple_loss:0.0013493428705260158
The modified gen p mean: 0.4487152397632599, gen p mean: -0.043496593832969666, mean p set: 0.44919553399086The modified gen p mean: 0.4479213058948517, gen p mean: -0.04631775990128517, mean p set: 0.44840162992477417
loss_pred:0.014123663306236267, decouple_loss:0.0014172500232234597
loss_pred:0.013705871067941189, decouple_loss:0.0013427708763629198
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488055109977722, gen p mean: -0.051274191588163376, mean p set: 0.4492858350276947
The modified gen p mean: 0.4479890763759613, gen p mean: -0.05936112254858017, mean p set: 0.448469340801239
loss_pred:0.013653354719281197, decouple_loss:0.0011872145114466548
loss_pred:0.013490269891917706, decouple_loss:0.0013078227639198303
The modified gen p mean: 0.4483506977558136, gen p mean: -0.053615082055330276, mean p set: 0.4488309919834137
loss_pred:0.013989129103720188, decouple_loss:0.0013205766445025802
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473377764225006, gen p mean: -0.05198350548744202, mean p set: 0.4478180706501007
loss_pred:0.013840893283486366, decouple_loss:0.0014306214870885015
The modified gen p mean: 0.44877612590789795, gen p mean: -0.05146816372871399, mean p set: 0.44925642013549805The modified gen p mean: 0.44849711656570435, gen p mean: -0.049151353538036346, mean p set: 0.44897738099098206
loss_pred:0.013801848515868187, decouple_loss:0.001316468114964664
loss_pred:0.013606568798422813, decouple_loss:0.0011891941539943218
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44945159554481506, gen p mean: -0.04714113101363182, mean p set: 0.44993188977241516
loss_pred:0.013504164293408394, decouple_loss:0.0012570865219458938
The modified gen p mean: 0.4492274224758148, gen p mean: -0.05008156970143318, mean p set: 0.4497077465057373The modified gen p mean: 0.4479454457759857, gen p mean: -0.05299753695726395, mean p set: 0.4484257698059082
loss_pred:0.013368507847189903, decouple_loss:0.0012201673816889524
loss_pred:0.013528283685445786, decouple_loss:0.001218958175741136
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501950442790985, gen p mean: -0.04548246040940285, mean p set: 0.4506753385066986
loss_pred:0.013904650695621967, decouple_loss:0.001105396426282823
The modified gen p mean: 0.4485749304294586, gen p mean: -0.04529589042067528, mean p set: 0.44905519485473633The modified gen p mean: 0.4499695599079132, gen p mean: -0.04771098122000694, mean p set: 0.4504498541355133
loss_pred:0.013518438674509525, decouple_loss:0.0012597661698237062
loss_pred:0.013908149674534798, decouple_loss:0.0011594081297516823
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897907972335815, gen p mean: -0.047461722046136856, mean p set: 0.44945937395095825
loss_pred:0.013116379268467426, decouple_loss:0.0011375261237844825
The modified gen p mean: 0.4484231173992157, gen p mean: -0.04632048308849335, mean p set: 0.4489034116268158The modified gen p mean: 0.44808343052864075, gen p mean: -0.04676882550120354, mean p set: 0.44856372475624084
loss_pred:0.013559950515627861, decouple_loss:0.0011305372463539243loss_pred:0.013723551295697689, decouple_loss:0.0012452845694497228
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721493124961853, gen p mean: -0.04879240691661835, mean p set: 0.44769522547721863
loss_pred:0.01382117997854948, decouple_loss:0.001200413447804749
The modified gen p mean: 0.4481351971626282, gen p mean: -0.04392475262284279, mean p set: 0.44861549139022827The modified gen p mean: 0.44786348938941956, gen p mean: -0.04307594895362854, mean p set: 0.44834378361701965
loss_pred:0.0141086271032691, decouple_loss:0.0011426445562392473
loss_pred:0.013781832531094551, decouple_loss:0.0013572400202974677
2023-05-01 17:14:03 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04641575366258621, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0424162931740284, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04287627339363098, mean p set: 0.45035696029663086
loss_pred:0.01909516006708145, decouple_loss:0.001354940701276064
loss_pred:0.017959333956241608, decouple_loss:0.0012878653360530734
loss_pred:0.017881466075778008, decouple_loss:0.0012779850512742996
WV_0_PC_1_EH_0_PS_40, loss: 0.018377333879470825, avg_mse: 0.026713041588664055
current test mse: 0.026713
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447200208902359, gen p mean: -0.04595116898417473, mean p set: 0.4476804733276367
loss_pred:0.014769380912184715, decouple_loss:0.0012219720520079136
The modified gen p mean: 0.44783398509025574, gen p mean: -0.041592955589294434, mean p set: 0.44831427931785583The modified gen p mean: 0.44760170578956604, gen p mean: -0.047146521508693695, mean p set: 0.44808200001716614
loss_pred:0.013998400419950485, decouple_loss:0.0012172128772363067
loss_pred:0.013056041672825813, decouple_loss:0.0012309971498325467
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475288987159729, gen p mean: -0.037148043513298035, mean p set: 0.448009192943573
loss_pred:0.014577782712876797, decouple_loss:0.0012463239254429936
The modified gen p mean: 0.4470152258872986, gen p mean: -0.04464432969689369, mean p set: 0.4474954903125763The modified gen p mean: 0.44669926166534424, gen p mean: -0.0434492826461792, mean p set: 0.44717955589294434
loss_pred:0.014301960356533527, decouple_loss:0.0012501999735832214
loss_pred:0.013526320457458496, decouple_loss:0.0012107258662581444
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477290213108063, gen p mean: -0.043889667838811874, mean p set: 0.448209285736084
loss_pred:0.01374851819127798, decouple_loss:0.0011784899979829788
The modified gen p mean: 0.4466809928417206, gen p mean: -0.0426471084356308, mean p set: 0.44716131687164307The modified gen p mean: 0.4466274380683899, gen p mean: -0.04124552011489868, mean p set: 0.44710773229599
loss_pred:0.014345238916575909, decouple_loss:0.001054519321769476
loss_pred:0.014048733748495579, decouple_loss:0.0011193701066076756
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485968351364136, gen p mean: -0.044804830104112625, mean p set: 0.44907715916633606
loss_pred:0.013724611140787601, decouple_loss:0.001204740023240447
The modified gen p mean: 0.4477178752422333, gen p mean: -0.04764261841773987, mean p set: 0.4481981694698334The modified gen p mean: 0.44501036405563354, gen p mean: -0.04999160021543503, mean p set: 0.44549062848091125
loss_pred:0.01435831654816866, decouple_loss:0.0013775292318314314
loss_pred:0.013733075931668282, decouple_loss:0.0013500505592674017
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642341136932373, gen p mean: -0.040649231523275375, mean p set: 0.44690370559692383
loss_pred:0.014065581373870373, decouple_loss:0.0011223254259675741
The modified gen p mean: 0.44754672050476074, gen p mean: -0.04900003969669342, mean p set: 0.44802701473236084The modified gen p mean: 0.445803701877594, gen p mean: -0.0460042841732502, mean p set: 0.4462839961051941
loss_pred:0.01271867100149393, decouple_loss:0.001153566176071763
loss_pred:0.013942556455731392, decouple_loss:0.0011275068391114473
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790753722190857, gen p mean: -0.04879455268383026, mean p set: 0.44838783144950867
The modified gen p mean: 0.44796085357666016, gen p mean: -0.046035878360271454, mean p set: 0.44844114780426025
loss_pred:0.013813931494951248, decouple_loss:0.0010629199678078294
loss_pred:0.013727668672800064, decouple_loss:0.0011078562820330262
The modified gen p mean: 0.4459763467311859, gen p mean: -0.048266537487506866, mean p set: 0.446456640958786
loss_pred:0.013500440865755081, decouple_loss:0.0011376107577234507
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810187816619873, gen p mean: -0.04905019700527191, mean p set: 0.44858217239379883
loss_pred:0.01375635340809822, decouple_loss:0.0011240504682064056
The modified gen p mean: 0.4472738802433014, gen p mean: -0.041949667036533356, mean p set: 0.4477542042732239The modified gen p mean: 0.4478778541088104, gen p mean: -0.04763898625969887, mean p set: 0.4483581483364105
loss_pred:0.014581895433366299, decouple_loss:0.0011151630897074938
loss_pred:0.013307813555002213, decouple_loss:0.0012332290643826127
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44727274775505066, gen p mean: -0.046651601791381836, mean p set: 0.44775307178497314
The modified gen p mean: 0.44710928201675415, gen p mean: -0.04932907968759537, mean p set: 0.44758957624435425
loss_pred:0.012850195169448853, decouple_loss:0.001055220258422196
loss_pred:0.013813498429954052, decouple_loss:0.001055021770298481
The modified gen p mean: 0.4469771385192871, gen p mean: -0.04826303571462631, mean p set: 0.4474574029445648
loss_pred:0.013788673095405102, decouple_loss:0.001147701870650053
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461059272289276, gen p mean: -0.049158282577991486, mean p set: 0.4465861916542053
loss_pred:0.013389578089118004, decouple_loss:0.0012116099242120981
The modified gen p mean: 0.44622603058815, gen p mean: -0.048222318291664124, mean p set: 0.4467063546180725The modified gen p mean: 0.4474099576473236, gen p mean: -0.04527544975280762, mean p set: 0.4478902518749237
loss_pred:0.014050032012164593, decouple_loss:0.0013356946874409914
loss_pred:0.013857617974281311, decouple_loss:0.0011813290184363723
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722050428390503, gen p mean: -0.047266390174627304, mean p set: 0.4477007985115051
loss_pred:0.013777499087154865, decouple_loss:0.0011023352853953838
The modified gen p mean: 0.44644805788993835, gen p mean: -0.050625402480363846, mean p set: 0.44692835211753845The modified gen p mean: 0.44713258743286133, gen p mean: -0.04628181457519531, mean p set: 0.4476129114627838
loss_pred:0.01326805166900158, decouple_loss:0.00118011306039989
loss_pred:0.01409018225967884, decouple_loss:0.0012073579709976912
2023-05-01 17:15:59 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04712517932057381, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04315436631441116, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04366593062877655, mean p set: 0.45035696029663086
loss_pred:0.01911991275846958, decouple_loss:0.0012221223441883922
loss_pred:0.01796727068722248, decouple_loss:0.001274989335797727
loss_pred:0.017893793061375618, decouple_loss:0.0012482467573136091
WV_0_PC_1_EH_0_PS_40, loss: 0.018389414995908737, avg_mse: 0.02676532045006752
current test mse: 0.026765
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474528133869171, gen p mean: -0.04786648601293564, mean p set: 0.4479331374168396
loss_pred:0.013650698587298393, decouple_loss:0.0011230078525841236
The modified gen p mean: 0.44745752215385437, gen p mean: -0.04796016216278076, mean p set: 0.44793781638145447The modified gen p mean: 0.44691744446754456, gen p mean: -0.04499288648366928, mean p set: 0.44739776849746704
loss_pred:0.014248889870941639, decouple_loss:0.0010543983662500978loss_pred:0.013864950276911259, decouple_loss:0.0011456276988610625
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696521759033203, gen p mean: -0.04179865121841431, mean p set: 0.44744551181793213
loss_pred:0.013552520424127579, decouple_loss:0.0011499623069539666
The modified gen p mean: 0.4484007954597473, gen p mean: -0.04610307514667511, mean p set: 0.448881059885025The modified gen p mean: 0.4455787241458893, gen p mean: -0.04263993725180626, mean p set: 0.4460590183734894
loss_pred:0.013500990346074104, decouple_loss:0.0011692240368574858
loss_pred:0.01379436906427145, decouple_loss:0.0012747739674523473
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462679922580719, gen p mean: -0.0447460375726223, mean p set: 0.446748286485672
loss_pred:0.013693331740796566, decouple_loss:0.0011211195960640907
The modified gen p mean: 0.4465464651584625, gen p mean: -0.04507416859269142, mean p set: 0.4470267593860626The modified gen p mean: 0.4466817378997803, gen p mean: -0.04442724213004112, mean p set: 0.44716206192970276
loss_pred:0.01373362634330988, decouple_loss:0.0011838424252346158
loss_pred:0.01371555682271719, decouple_loss:0.0010868462268263102
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723257422447205, gen p mean: -0.04452410340309143, mean p set: 0.44771286845207214
loss_pred:0.013400946743786335, decouple_loss:0.0011669411323964596
The modified gen p mean: 0.44828417897224426, gen p mean: -0.04531678557395935, mean p set: 0.44876447319984436The modified gen p mean: 0.44681262969970703, gen p mean: -0.0422663614153862, mean p set: 0.44729292392730713
loss_pred:0.013279999606311321, decouple_loss:0.001193115022033453
loss_pred:0.014240494929254055, decouple_loss:0.0011499181855469942
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464872479438782, gen p mean: -0.04923844337463379, mean p set: 0.44696754217147827
loss_pred:0.012702126987278461, decouple_loss:0.0012627384858205914
The modified gen p mean: 0.4485483765602112, gen p mean: -0.041934624314308167, mean p set: 0.4490286707878113The modified gen p mean: 0.4469371438026428, gen p mean: -0.0460815466940403, mean p set: 0.44741740822792053
loss_pred:0.01406443677842617, decouple_loss:0.0011200106237083673
loss_pred:0.014147262088954449, decouple_loss:0.0012338411761447787
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44646063446998596, gen p mean: -0.045219071209430695, mean p set: 0.44694095849990845
loss_pred:0.014376433566212654, decouple_loss:0.0010549640282988548
The modified gen p mean: 0.4462986886501312, gen p mean: -0.04562439024448395, mean p set: 0.4467789828777313The modified gen p mean: 0.4478619396686554, gen p mean: -0.048917580395936966, mean p set: 0.4483422338962555
loss_pred:0.01361747644841671, decouple_loss:0.001106568262912333
loss_pred:0.01359132956713438, decouple_loss:0.0010585876880213618
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464516043663025, gen p mean: -0.046666219830513, mean p set: 0.4469318985939026
loss_pred:0.013733436353504658, decouple_loss:0.0011559980921447277
The modified gen p mean: 0.4458503723144531, gen p mean: -0.04872182384133339, mean p set: 0.4463306665420532The modified gen p mean: 0.44587817788124084, gen p mean: -0.05084054917097092, mean p set: 0.44635844230651855
loss_pred:0.013337299227714539, decouple_loss:0.0011340416967868805
loss_pred:0.013710069470107555, decouple_loss:0.0012309993617236614
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44497737288475037, gen p mean: -0.0539696030318737, mean p set: 0.4454576373100281
loss_pred:0.013735692016780376, decouple_loss:0.001054437831044197
The modified gen p mean: 0.44673675298690796, gen p mean: -0.04526804760098457, mean p set: 0.44721704721450806The modified gen p mean: 0.4463235139846802, gen p mean: -0.04871169477701187, mean p set: 0.44680383801460266
loss_pred:0.013530797325074673, decouple_loss:0.000975645671132952
loss_pred:0.013678320683538914, decouple_loss:0.0010377048747614026
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466102123260498, gen p mean: -0.04937359318137169, mean p set: 0.4470905363559723
loss_pred:0.013126816600561142, decouple_loss:0.0011227214708924294
The modified gen p mean: 0.4455007314682007, gen p mean: -0.05666990950703621, mean p set: 0.44598105549812317The modified gen p mean: 0.4490334689617157, gen p mean: -0.04790843278169632, mean p set: 0.4495137631893158
loss_pred:0.013339479453861713, decouple_loss:0.001131092431023717
loss_pred:0.013611367903649807, decouple_loss:0.0011744871735572815
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
NaN value num: 0
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475136697292328, gen p mean: -0.049939028918743134, mean p set: 0.4479939937591553
loss_pred:0.013468991965055466, decouple_loss:0.0011984537122771144
The modified gen p mean: 0.4482094943523407, gen p mean: -0.04906214028596878, mean p set: 0.4486897885799408The modified gen p mean: 0.44811391830444336, gen p mean: -0.04567759111523628, mean p set: 0.44859424233436584
loss_pred:0.01340971514582634, decouple_loss:0.0011399828363209963
loss_pred:0.013654384762048721, decouple_loss:0.0010368418879806995
2023-05-01 17:18:31 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.050087522715330124, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04630795866250992, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04656772315502167, mean p set: 0.45035696029663086
loss_pred:0.019063275307416916, decouple_loss:0.001233333838172257
loss_pred:0.017948148772120476, decouple_loss:0.0011446377029642463
loss_pred:0.017905794084072113, decouple_loss:0.0011460102396085858
WV_0_PC_1_EH_0_PS_40, loss: 0.018364472314715385, avg_mse: 0.026741264387965202
current test mse: 0.026741
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480445683002472, gen p mean: -0.042379606515169144, mean p set: 0.4485248327255249
loss_pred:0.013371257111430168, decouple_loss:0.0011498687090352178
The modified gen p mean: 0.449349045753479, gen p mean: -0.04383239150047302, mean p set: 0.4498293101787567The modified gen p mean: 0.44900399446487427, gen p mean: -0.04512760415673256, mean p set: 0.449484258890152
loss_pred:0.013497757725417614, decouple_loss:0.0012763321865350008
loss_pred:0.013685578480362892, decouple_loss:0.0012389125768095255
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743579626083374, gen p mean: -0.05092594772577286, mean p set: 0.44791606068611145
loss_pred:0.013213440775871277, decouple_loss:0.001170168281532824
The modified gen p mean: 0.44781965017318726, gen p mean: -0.050262466073036194, mean p set: 0.44829997420310974The modified gen p mean: 0.4483235776424408, gen p mean: -0.04239491745829582, mean p set: 0.4488039016723633
loss_pred:0.012951948679983616, decouple_loss:0.0011259353486821055
loss_pred:0.013511545024812222, decouple_loss:0.0011584998574107885
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477563798427582, gen p mean: -0.04972752556204796, mean p set: 0.4482366442680359
loss_pred:0.012753982096910477, decouple_loss:0.0010654742363840342
The modified gen p mean: 0.4476199746131897, gen p mean: -0.057132091373205185, mean p set: 0.4481002688407898The modified gen p mean: 0.44826120138168335, gen p mean: -0.043203454464673996, mean p set: 0.44874149560928345
loss_pred:0.013336622156202793, decouple_loss:0.0012928926153108478
loss_pred:0.013047165237367153, decouple_loss:0.001053330721333623
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479478597640991, gen p mean: -0.04911060258746147, mean p set: 0.4484281837940216
loss_pred:0.014098132029175758, decouple_loss:0.0010576783679425716
The modified gen p mean: 0.44617438316345215, gen p mean: -0.04569592326879501, mean p set: 0.44665467739105225The modified gen p mean: 0.4489873945713043, gen p mean: -0.047697097063064575, mean p set: 0.4494676887989044
loss_pred:0.01377776451408863, decouple_loss:0.0010229672770947218
loss_pred:0.013201355002820492, decouple_loss:0.0011764555238187313
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44645360112190247, gen p mean: -0.047525133937597275, mean p set: 0.44693389534950256
loss_pred:0.0134031493216753, decouple_loss:0.0010110423900187016
The modified gen p mean: 0.4473644196987152, gen p mean: -0.04783971607685089, mean p set: 0.4478446841239929The modified gen p mean: 0.44778189063072205, gen p mean: -0.04803159832954407, mean p set: 0.44826218485832214
loss_pred:0.013558687642216682, decouple_loss:0.001120029715821147
loss_pred:0.013158543966710567, decouple_loss:0.0010948461713269353
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449179083108902, gen p mean: -0.04897896572947502, mean p set: 0.4496593773365021
loss_pred:0.01291783805936575, decouple_loss:0.0009397080866619945
The modified gen p mean: 0.44643887877464294, gen p mean: -0.052544768899679184, mean p set: 0.44691917300224304The modified gen p mean: 0.4469151496887207, gen p mean: -0.05156414210796356, mean p set: 0.4473954439163208
loss_pred:0.013467535376548767, decouple_loss:0.001018407056108117
loss_pred:0.01358925923705101, decouple_loss:0.0010863736970350146
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797995686531067, gen p mean: -0.04374903067946434, mean p set: 0.44846025109291077
loss_pred:0.01304324809461832, decouple_loss:0.0010525465477257967
The modified gen p mean: 0.44779494404792786, gen p mean: -0.04740310460329056, mean p set: 0.44827526807785034The modified gen p mean: 0.44851401448249817, gen p mean: -0.052111346274614334, mean p set: 0.4489942789077759
loss_pred:0.013091820292174816, decouple_loss:0.001018902170471847
loss_pred:0.013700224459171295, decouple_loss:0.0010444760555401444
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762831926345825, gen p mean: -0.04731058329343796, mean p set: 0.44810861349105835
loss_pred:0.013095683418214321, decouple_loss:0.0010301809525117278
The modified gen p mean: 0.4471588730812073, gen p mean: -0.050166960805654526, mean p set: 0.4476391673088074
The modified gen p mean: 0.448159396648407, gen p mean: -0.04712769016623497, mean p set: 0.4486396908760071
loss_pred:0.012961437925696373, decouple_loss:0.0010781429009512067
loss_pred:0.013413225300610065, decouple_loss:0.0010464823571965098
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483543634414673, gen p mean: -0.045617636293172836, mean p set: 0.4488346576690674
loss_pred:0.013406697660684586, decouple_loss:0.0010648876195773482
The modified gen p mean: 0.44828876852989197, gen p mean: -0.04428664594888687, mean p set: 0.44876906275749207The modified gen p mean: 0.44692468643188477, gen p mean: -0.04534395411610603, mean p set: 0.44740498065948486
loss_pred:0.012624907307326794, decouple_loss:0.0010720794089138508
loss_pred:0.013151860795915127, decouple_loss:0.0010117896599695086
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468684494495392, gen p mean: -0.05324395373463631, mean p set: 0.4473487436771393
The modified gen p mean: 0.44847428798675537, gen p mean: -0.04335430637001991, mean p set: 0.44895458221435547
loss_pred:0.013110882602632046, decouple_loss:0.0009429478086531162
loss_pred:0.012799713760614395, decouple_loss:0.0009395860251970589
The modified gen p mean: 0.44765836000442505, gen p mean: -0.044506482779979706, mean p set: 0.44813862442970276
loss_pred:0.013728753663599491, decouple_loss:0.0009460257133468986
2023-05-01 17:20:27 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04962993040680885, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.046195611357688904, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.046337008476257324, mean p set: 0.45035696029663086
loss_pred:0.019057760015130043, decouple_loss:0.0011839178623631597
loss_pred:0.017904603853821754, decouple_loss:0.0011106780730187893loss_pred:0.017926227301359177, decouple_loss:0.0010898793116211891
WV_0_PC_1_EH_0_PS_40, loss: 0.018352605402469635, avg_mse: 0.026738611981272697
current test mse: 0.026739
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44668376445770264, gen p mean: -0.04729615896940231, mean p set: 0.44716405868530273
loss_pred:0.013079780153930187, decouple_loss:0.0010622466215863824
The modified gen p mean: 0.4466054141521454, gen p mean: -0.04122921824455261, mean p set: 0.4470857083797455The modified gen p mean: 0.44767674803733826, gen p mean: -0.04925527796149254, mean p set: 0.44815701246261597
loss_pred:0.013514332473278046, decouple_loss:0.0010194837814196944loss_pred:0.013205217197537422, decouple_loss:0.001183370011858642
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479027986526489, gen p mean: -0.048652470111846924, mean p set: 0.4483831226825714
loss_pred:0.013045844621956348, decouple_loss:0.0010257360991090536
The modified gen p mean: 0.4479871988296509, gen p mean: -0.04966745898127556, mean p set: 0.44846752285957336The modified gen p mean: 0.447916179895401, gen p mean: -0.04846134036779404, mean p set: 0.4483965039253235
loss_pred:0.012709960341453552, decouple_loss:0.001065715216100216
loss_pred:0.013055837713181973, decouple_loss:0.001020062598399818
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469769597053528, gen p mean: -0.04465944692492485, mean p set: 0.4474572539329529
loss_pred:0.013064692728221416, decouple_loss:0.0010360617889091372
The modified gen p mean: 0.4483950734138489, gen p mean: -0.045844461768865585, mean p set: 0.448875367641449The modified gen p mean: 0.4484352171421051, gen p mean: -0.046988677233457565, mean p set: 0.4489155113697052
loss_pred:0.013044149614870548, decouple_loss:0.0010517670307308435
loss_pred:0.013245227746665478, decouple_loss:0.001043892465531826
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486221671104431, gen p mean: -0.041844695806503296, mean p set: 0.4491024613380432
loss_pred:0.01281178742647171, decouple_loss:0.0009322367259301245
The modified gen p mean: 0.4467870593070984, gen p mean: -0.04638434201478958, mean p set: 0.4472673535346985The modified gen p mean: 0.4472697675228119, gen p mean: -0.0453072190284729, mean p set: 0.4477500915527344
loss_pred:0.013330419547855854, decouple_loss:0.0009629732230678201
loss_pred:0.013118219561874866, decouple_loss:0.0009731851168908179
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477499723434448, gen p mean: -0.042159728705883026, mean p set: 0.4482302665710449
The modified gen p mean: 0.4472668170928955, gen p mean: -0.046007927507162094, mean p set: 0.447747141122818
loss_pred:0.012931686826050282, decouple_loss:0.0010244168806821108
loss_pred:0.012882579118013382, decouple_loss:0.0009089288068935275
The modified gen p mean: 0.4473857879638672, gen p mean: -0.045863546431064606, mean p set: 0.4478660821914673
loss_pred:0.013153130188584328, decouple_loss:0.001048836624249816
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481048285961151, gen p mean: -0.04327092319726944, mean p set: 0.4485850930213928
loss_pred:0.012655936181545258, decouple_loss:0.0009605116210877895
The modified gen p mean: 0.44802582263946533, gen p mean: -0.043654587119817734, mean p set: 0.44850608706474304The modified gen p mean: 0.4479721784591675, gen p mean: -0.047783564776182175, mean p set: 0.4484524726867676
loss_pred:0.012665691785514355, decouple_loss:0.0009320161771029234
loss_pred:0.013257920742034912, decouple_loss:0.0009199351770803332
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948098063468933, gen p mean: -0.04674987867474556, mean p set: 0.4499613046646118
loss_pred:0.012892238795757294, decouple_loss:0.0009489549556747079
The modified gen p mean: 0.44713106751441956, gen p mean: -0.04855603724718094, mean p set: 0.44761136174201965The modified gen p mean: 0.4475749433040619, gen p mean: -0.04679131507873535, mean p set: 0.4480552673339844
loss_pred:0.012899806722998619, decouple_loss:0.0009268239955417812
loss_pred:0.013025254011154175, decouple_loss:0.0009543502237647772
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977760314941406, gen p mean: -0.048437826335430145, mean p set: 0.45025789737701416
loss_pred:0.012662116438150406, decouple_loss:0.0009219871135428548
The modified gen p mean: 0.4472024142742157, gen p mean: -0.04795590043067932, mean p set: 0.4476827085018158The modified gen p mean: 0.4468735456466675, gen p mean: -0.05156492441892624, mean p set: 0.44735386967658997
loss_pred:0.013420886360108852, decouple_loss:0.0009121011826209724
loss_pred:0.013151719234883785, decouple_loss:0.0009247457492165267
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690242409706116, gen p mean: -0.04402412101626396, mean p set: 0.44738268852233887
loss_pred:0.013469544239342213, decouple_loss:0.0010571061866357923
The modified gen p mean: 0.44857507944107056, gen p mean: -0.056395452469587326, mean p set: 0.44905540347099304The modified gen p mean: 0.44793081283569336, gen p mean: -0.049987878650426865, mean p set: 0.44841110706329346
loss_pred:0.012953967787325382, decouple_loss:0.0010057087056338787
loss_pred:0.013705451972782612, decouple_loss:0.0009521398460492492
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
NaN value num: 0
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048776268959045, gen p mean: -0.04732885956764221, mean p set: 0.45096808671951294
loss_pred:0.016747459769248962, decouple_loss:0.0009498789440840483
The modified gen p mean: 0.4497276842594147, gen p mean: -0.05408356711268425, mean p set: 0.45020797848701477The modified gen p mean: 0.4523540735244751, gen p mean: -0.039665695279836655, mean p set: 0.4528343677520752
loss_pred:0.017567483708262444, decouple_loss:0.0011204656912013888
loss_pred:0.01727244257926941, decouple_loss:0.0010982380481436849
2023-05-01 17:23:01 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0516398549079895, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04812316596508026, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04828367009758949, mean p set: 0.45035696029663086
loss_pred:0.018845580518245697, decouple_loss:0.001377543667331338
loss_pred:0.017751086503267288, decouple_loss:0.0012256648624315858
loss_pred:0.017724085599184036, decouple_loss:0.001294260728172958
WV_0_PC_1_EH_0_PS_40, loss: 0.018171876668930054, avg_mse: 0.026363085955381393
current test mse: 0.026363
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530010521411896, gen p mean: -0.04161390662193298, mean p set: 0.4534813165664673
loss_pred:0.017623282968997955, decouple_loss:0.0012257059570401907
The modified gen p mean: 0.4506075978279114, gen p mean: -0.04331353306770325, mean p set: 0.4510878920555115The modified gen p mean: 0.4491724371910095, gen p mean: -0.04104023799300194, mean p set: 0.4496527314186096
loss_pred:0.017985498532652855, decouple_loss:0.0011173576349392533
loss_pred:0.01751982420682907, decouple_loss:0.0012718875659629703
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45171698927879333, gen p mean: -0.03825998306274414, mean p set: 0.45219725370407104
loss_pred:0.01654680445790291, decouple_loss:0.001233487157151103
The modified gen p mean: 0.451625794172287, gen p mean: -0.04337283596396446, mean p set: 0.4521060883998871The modified gen p mean: 0.4498523473739624, gen p mean: -0.04455437511205673, mean p set: 0.4503326416015625
loss_pred:0.017869628965854645, decouple_loss:0.0011137289693579078
loss_pred:0.017322342842817307, decouple_loss:0.0010778368450701237
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449763685464859, gen p mean: -0.05034550651907921, mean p set: 0.4502440094947815
loss_pred:0.017943423241376877, decouple_loss:0.0012259607901796699
The modified gen p mean: 0.44953402876853943, gen p mean: -0.04138977825641632, mean p set: 0.4500143229961395The modified gen p mean: 0.44984570145606995, gen p mean: -0.03973989188671112, mean p set: 0.45032599568367004
loss_pred:0.016811620444059372, decouple_loss:0.0011624003527686
loss_pred:0.01657998189330101, decouple_loss:0.0011690763058140874
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527161717414856, gen p mean: -0.040630076080560684, mean p set: 0.4531964957714081
loss_pred:0.017105799168348312, decouple_loss:0.0011919818352907896
The modified gen p mean: 0.44855958223342896, gen p mean: -0.05202801525592804, mean p set: 0.44903984665870667
The modified gen p mean: 0.4501267969608307, gen p mean: -0.052302103489637375, mean p set: 0.4506070911884308
loss_pred:0.016677506268024445, decouple_loss:0.0012043638853356242
loss_pred:0.016990717500448227, decouple_loss:0.001170571893453598
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496883749961853, gen p mean: -0.03882559761404991, mean p set: 0.4501686692237854
loss_pred:0.01673027314245701, decouple_loss:0.0011660645250231028
The modified gen p mean: 0.44980499148368835, gen p mean: -0.04263332858681679, mean p set: 0.45028528571128845The modified gen p mean: 0.4511922299861908, gen p mean: -0.045935485512018204, mean p set: 0.4516725242137909
loss_pred:0.016248926520347595, decouple_loss:0.0011988255428150296
loss_pred:0.01733008585870266, decouple_loss:0.0012008149642497301
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869181513786316, gen p mean: -0.04651506617665291, mean p set: 0.44917213916778564
loss_pred:0.01667194813489914, decouple_loss:0.001148519804701209
The modified gen p mean: 0.44933873414993286, gen p mean: -0.05017076060175896, mean p set: 0.44981902837753296
The modified gen p mean: 0.45013394951820374, gen p mean: -0.03931171074509621, mean p set: 0.45061424374580383
loss_pred:0.016537383198738098, decouple_loss:0.001188339781947434
loss_pred:0.016618212684988976, decouple_loss:0.0011464871931821108
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495389461517334, gen p mean: -0.040159083902835846, mean p set: 0.4500192403793335
loss_pred:0.01688971184194088, decouple_loss:0.0011095457011833787
The modified gen p mean: 0.4512633979320526, gen p mean: -0.04379832744598389, mean p set: 0.4517436623573303The modified gen p mean: 0.45007792115211487, gen p mean: -0.03866438567638397, mean p set: 0.4505581855773926
loss_pred:0.017468245700001717, decouple_loss:0.0011202626628801227
loss_pred:0.01696530170738697, decouple_loss:0.001166604459285736
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876691699028015, gen p mean: -0.04804733768105507, mean p set: 0.44924721121788025
loss_pred:0.016583163291215897, decouple_loss:0.001108041382394731
The modified gen p mean: 0.44846266508102417, gen p mean: -0.052866797894239426, mean p set: 0.44894298911094666The modified gen p mean: 0.4526509642601013, gen p mean: -0.04486336559057236, mean p set: 0.4531312584877014
loss_pred:0.015998469665646553, decouple_loss:0.0011422316310927272
loss_pred:0.017211362719535828, decouple_loss:0.0011476055951789021
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890356063842773, gen p mean: -0.05225657299160957, mean p set: 0.4493838846683502
loss_pred:0.01725413277745247, decouple_loss:0.0012384657748043537
The modified gen p mean: 0.4502222537994385, gen p mean: -0.04193772375583649, mean p set: 0.4507025480270386The modified gen p mean: 0.4514254629611969, gen p mean: -0.04732731729745865, mean p set: 0.451905757188797
loss_pred:0.017341550439596176, decouple_loss:0.001157561899162829
loss_pred:0.016483858227729797, decouple_loss:0.0011533903889358044
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44873303174972534, gen p mean: -0.04827376455068588, mean p set: 0.44921332597732544
loss_pred:0.01707131415605545, decouple_loss:0.0010486689861863852
The modified gen p mean: 0.44934505224227905, gen p mean: -0.043598685413599014, mean p set: 0.44982537627220154The modified gen p mean: 0.4492344856262207, gen p mean: -0.04713010787963867, mean p set: 0.4497148096561432
loss_pred:0.017008375376462936, decouple_loss:0.0010293088853359222
loss_pred:0.016808193176984787, decouple_loss:0.0010245740413665771
2023-05-01 17:24:56 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0546158105134964, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.05089534819126129, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05118435248732567, mean p set: 0.45035696029663086
loss_pred:0.018370361998677254, decouple_loss:0.0012015923857688904
loss_pred:0.017302125692367554, decouple_loss:0.0011147320037707686
loss_pred:0.017242953181266785, decouple_loss:0.0011323528597131371
WV_0_PC_1_EH_0_PS_40, loss: 0.01769595965743065, avg_mse: 0.02538939006626606
current test mse: 0.025389
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45304596424102783, gen p mean: -0.048226889222860336, mean p set: 0.45352625846862793
loss_pred:0.01671980693936348, decouple_loss:0.001192331314086914
The modified gen p mean: 0.44892454147338867, gen p mean: -0.052600570023059845, mean p set: 0.4494048058986664The modified gen p mean: 0.44726434350013733, gen p mean: -0.05547456443309784, mean p set: 0.4477446675300598
loss_pred:0.016007481142878532, decouple_loss:0.001194896176457405
loss_pred:0.015911554917693138, decouple_loss:0.0011892742477357388
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496876001358032, gen p mean: -0.05099344626069069, mean p set: 0.45016786456108093
loss_pred:0.01737961173057556, decouple_loss:0.0013282898580655456
The modified gen p mean: 0.45039206743240356, gen p mean: -0.04082944616675377, mean p set: 0.45087239146232605The modified gen p mean: 0.4498113691806793, gen p mean: -0.051650211215019226, mean p set: 0.4502916932106018
loss_pred:0.017107579857110977, decouple_loss:0.0012200187193229795
loss_pred:0.01679139956831932, decouple_loss:0.001220137346535921
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970133900642395, gen p mean: -0.0461733415722847, mean p set: 0.45018163323402405
loss_pred:0.016962995752692223, decouple_loss:0.0011131670325994492
The modified gen p mean: 0.44918400049209595, gen p mean: -0.04755975678563118, mean p set: 0.44966429471969604The modified gen p mean: 0.4507034122943878, gen p mean: -0.046855777502059937, mean p set: 0.4511836767196655
loss_pred:0.017348622903227806, decouple_loss:0.0011461504036560655
loss_pred:0.017253955826163292, decouple_loss:0.0011299285106360912
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45282161235809326, gen p mean: -0.04877490922808647, mean p set: 0.45330190658569336
loss_pred:0.016422154381871223, decouple_loss:0.0012444437015801668
The modified gen p mean: 0.45358121395111084, gen p mean: -0.05216964706778526, mean p set: 0.45406150817871094The modified gen p mean: 0.4502153992652893, gen p mean: -0.05020955577492714, mean p set: 0.450695663690567
loss_pred:0.016112834215164185, decouple_loss:0.001274104812182486
loss_pred:0.017149576917290688, decouple_loss:0.0010889330878853798
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515535533428192, gen p mean: -0.0459589846432209, mean p set: 0.4520338773727417
loss_pred:0.016916770488023758, decouple_loss:0.0011560230050235987
The modified gen p mean: 0.44983574748039246, gen p mean: -0.05059036612510681, mean p set: 0.45031604170799255The modified gen p mean: 0.45297864079475403, gen p mean: -0.04961914196610451, mean p set: 0.4534589648246765
loss_pred:0.017088938504457474, decouple_loss:0.0011573145166039467
loss_pred:0.01629822887480259, decouple_loss:0.0012181279016658664
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997432827949524, gen p mean: -0.04866456240415573, mean p set: 0.45045459270477295
loss_pred:0.016011688858270645, decouple_loss:0.0011393525637686253
The modified gen p mean: 0.4503084123134613, gen p mean: -0.05068838596343994, mean p set: 0.4507887363433838The modified gen p mean: 0.45217227935791016, gen p mean: -0.04622841626405716, mean p set: 0.45265257358551025
loss_pred:0.01645045354962349, decouple_loss:0.001181745552457869
loss_pred:0.016050981357693672, decouple_loss:0.0011287388624623418
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531667232513428, gen p mean: -0.04535030201077461, mean p set: 0.45364704728126526
loss_pred:0.016342559829354286, decouple_loss:0.001253601280041039
The modified gen p mean: 0.4488403797149658, gen p mean: -0.04950394481420517, mean p set: 0.4493206739425659The modified gen p mean: 0.44949871301651, gen p mean: -0.04594498872756958, mean p set: 0.4499790072441101
loss_pred:0.016283920034766197, decouple_loss:0.00123123312368989
loss_pred:0.017096109688282013, decouple_loss:0.0011335688177496195
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45256516337394714, gen p mean: -0.041811808943748474, mean p set: 0.45304545760154724
loss_pred:0.016862530261278152, decouple_loss:0.001170649193227291
The modified gen p mean: 0.44992244243621826, gen p mean: -0.04061884805560112, mean p set: 0.45040273666381836The modified gen p mean: 0.4500858783721924, gen p mean: -0.042816855013370514, mean p set: 0.4505661725997925
loss_pred:0.01666160672903061, decouple_loss:0.0010963964741677046
loss_pred:0.016064990311861038, decouple_loss:0.0010738444980233908
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972240924835205, gen p mean: -0.043444253504276276, mean p set: 0.45020267367362976
loss_pred:0.017694441601634026, decouple_loss:0.001029577455483377
The modified gen p mean: 0.45273956656455994, gen p mean: -0.04109715670347214, mean p set: 0.4532198905944824The modified gen p mean: 0.4505919814109802, gen p mean: -0.04715936258435249, mean p set: 0.4510722756385803
loss_pred:0.017146965488791466, decouple_loss:0.0011408915743231773
loss_pred:0.016407007351517677, decouple_loss:0.0011748992837965488
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
NaN value num: 0
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493712782859802, gen p mean: -0.04546434059739113, mean p set: 0.4498515725135803
loss_pred:0.014465724118053913, decouple_loss:0.0010433978168293834
The modified gen p mean: 0.4490276277065277, gen p mean: -0.04816829413175583, mean p set: 0.4495079815387726The modified gen p mean: 0.45141148567199707, gen p mean: -0.040616724640131, mean p set: 0.4518917500972748
loss_pred:0.014859763905405998, decouple_loss:0.001088207121938467
loss_pred:0.01470939815044403, decouple_loss:0.0011896399082615972
2023-05-01 17:27:28 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.04949723929166794, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.04612519219517708, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04622500017285347, mean p set: 0.45035696029663086
loss_pred:0.018387343734502792, decouple_loss:0.0012843561125919223
loss_pred:0.017314942553639412, decouple_loss:0.0011742179049178958
loss_pred:0.017259854823350906, decouple_loss:0.0012044648174196482
WV_0_PC_1_EH_0_PS_40, loss: 0.017715096473693848, avg_mse: 0.025391092523932457
current test mse: 0.025391
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504621624946594, gen p mean: -0.04063139855861664, mean p set: 0.4509424567222595
loss_pred:0.015125601552426815, decouple_loss:0.0010700409766286612
The modified gen p mean: 0.44761791825294495, gen p mean: -0.049783166497945786, mean p set: 0.44809824228286743The modified gen p mean: 0.44904351234436035, gen p mean: -0.044870615005493164, mean p set: 0.44952380657196045
loss_pred:0.014688950963318348, decouple_loss:0.0010875953594222665
loss_pred:0.015078139491379261, decouple_loss:0.0010484695667400956
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017823576927185, gen p mean: -0.042517852038145065, mean p set: 0.45065850019454956
The modified gen p mean: 0.4486375153064728, gen p mean: -0.04268183931708336, mean p set: 0.44911783933639526
loss_pred:0.014874426648020744, decouple_loss:0.0010290138889104128
loss_pred:0.015001773834228516, decouple_loss:0.0011406478006392717
The modified gen p mean: 0.44945916533470154, gen p mean: -0.048575617372989655, mean p set: 0.44993945956230164
loss_pred:0.014568506740033627, decouple_loss:0.0010427050292491913
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45216304063796997, gen p mean: -0.03782351687550545, mean p set: 0.45264333486557007
The modified gen p mean: 0.4517676532268524, gen p mean: -0.042606815695762634, mean p set: 0.4522479474544525
loss_pred:0.014695110730826855, decouple_loss:0.0010390763636678457
loss_pred:0.014596126973628998, decouple_loss:0.0010996846249327064
The modified gen p mean: 0.4514055550098419, gen p mean: -0.0429421104490757, mean p set: 0.451885849237442
loss_pred:0.015329798683524132, decouple_loss:0.0010552096646279097
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485812485218048, gen p mean: -0.04008735343813896, mean p set: 0.4490615427494049
The modified gen p mean: 0.4501246511936188, gen p mean: -0.04493094980716705, mean p set: 0.45060494542121887
loss_pred:0.016000648960471153, decouple_loss:0.001064774696715176
loss_pred:0.015264504589140415, decouple_loss:0.0010996842756867409
The modified gen p mean: 0.4521656036376953, gen p mean: -0.04172411933541298, mean p set: 0.4526459276676178
loss_pred:0.014881781302392483, decouple_loss:0.0010320701403543353
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928374886512756, gen p mean: -0.04418940097093582, mean p set: 0.44976404309272766
loss_pred:0.01509047206491232, decouple_loss:0.0010395623976364732
The modified gen p mean: 0.4500269293785095, gen p mean: -0.04340483993291855, mean p set: 0.4505072236061096The modified gen p mean: 0.4489331543445587, gen p mean: -0.05258769914507866, mean p set: 0.44941338896751404
loss_pred:0.014627044089138508, decouple_loss:0.001011063577607274
loss_pred:0.014369781129062176, decouple_loss:0.0011750358389690518
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500935971736908, gen p mean: -0.0502731092274189, mean p set: 0.4505738615989685
loss_pred:0.014344749040901661, decouple_loss:0.001108527067117393
The modified gen p mean: 0.45145854353904724, gen p mean: -0.04430082440376282, mean p set: 0.45193883776664734The modified gen p mean: 0.44969335198402405, gen p mean: -0.0443735271692276, mean p set: 0.45017367601394653
loss_pred:0.014856833033263683, decouple_loss:0.0011246782960370183
loss_pred:0.014551821164786816, decouple_loss:0.0011271430412307382
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915929436683655, gen p mean: -0.038605570793151855, mean p set: 0.44963955879211426
loss_pred:0.015101533383131027, decouple_loss:0.0010452590649947524
The modified gen p mean: 0.4485863745212555, gen p mean: -0.04925588518381119, mean p set: 0.4490666687488556The modified gen p mean: 0.4528353810310364, gen p mean: -0.03680315241217613, mean p set: 0.4533156752586365
loss_pred:0.014568226411938667, decouple_loss:0.0010199748212471604
loss_pred:0.015059885568916798, decouple_loss:0.0010925553506240249
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504455626010895, gen p mean: -0.04302491992712021, mean p set: 0.4509258568286896
The modified gen p mean: 0.45092499256134033, gen p mean: -0.040684767067432404, mean p set: 0.45140528678894043
loss_pred:0.014834695495665073, decouple_loss:0.0011259724851697683
loss_pred:0.01430602092295885, decouple_loss:0.0011853764299303293
The modified gen p mean: 0.4497821629047394, gen p mean: -0.047534894198179245, mean p set: 0.45026248693466187
loss_pred:0.01521221548318863, decouple_loss:0.0010683630825951695
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890162348747253, gen p mean: -0.04263877123594284, mean p set: 0.449381947517395
The modified gen p mean: 0.4514023959636688, gen p mean: -0.04339517280459404, mean p set: 0.4518826901912689loss_pred:0.015107600949704647, decouple_loss:0.001073568593710661
The modified gen p mean: 0.4490102529525757, gen p mean: -0.049970608204603195, mean p set: 0.4494905471801758
loss_pred:0.015157724730670452, decouple_loss:0.0011382990051060915
loss_pred:0.014270447194576263, decouple_loss:0.0012454914394766092
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104700326919556, gen p mean: -0.042201247066259384, mean p set: 0.45152729749679565
loss_pred:0.014930764213204384, decouple_loss:0.001189082395285368
The modified gen p mean: 0.4510818123817444, gen p mean: -0.04363858327269554, mean p set: 0.45156213641166687
The modified gen p mean: 0.44910693168640137, gen p mean: -0.04326381906867027, mean p set: 0.44958722591400146
loss_pred:0.015348758548498154, decouple_loss:0.0011493127094581723
loss_pred:0.01500489842146635, decouple_loss:0.0010852328268811107
2023-05-01 17:29:26 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.04993760213255882, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04623799026012421, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987669587135315, gen p mean: -0.046540532261133194, mean p set: 0.45035696029663086
loss_pred:0.018623221665620804, decouple_loss:0.0013060392811894417
loss_pred:0.017545292153954506, decouple_loss:0.001137965708039701
loss_pred:0.017454838380217552, decouple_loss:0.001170442788861692
WV_0_PC_1_EH_0_PS_40, loss: 0.01793469302356243, avg_mse: 0.025873292237520218
current test mse: 0.025873
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975754618644714, gen p mean: -0.0492263063788414, mean p set: 0.45023781061172485
loss_pred:0.014654885046184063, decouple_loss:0.0010947089176625013
The modified gen p mean: 0.45248979330062866, gen p mean: -0.04251673072576523, mean p set: 0.45297008752822876The modified gen p mean: 0.45181918144226074, gen p mean: -0.039352718740701675, mean p set: 0.4522995054721832
loss_pred:0.014379672706127167, decouple_loss:0.0010458579054102302
loss_pred:0.01415977906435728, decouple_loss:0.0010522016091272235
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478793740272522, gen p mean: -0.038743823766708374, mean p set: 0.4483596682548523
loss_pred:0.015682091936469078, decouple_loss:0.0010958112543448806
The modified gen p mean: 0.4513724744319916, gen p mean: -0.043214958161115646, mean p set: 0.4518527686595917The modified gen p mean: 0.45144110918045044, gen p mean: -0.04308701306581497, mean p set: 0.4519214332103729
loss_pred:0.014297242276370525, decouple_loss:0.0011082238052040339
loss_pred:0.014608865603804588, decouple_loss:0.0010871230624616146
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44860783219337463, gen p mean: -0.052492834627628326, mean p set: 0.44908812642097473
loss_pred:0.014272458851337433, decouple_loss:0.0010856547160074115
The modified gen p mean: 0.4490024149417877, gen p mean: -0.04927864298224449, mean p set: 0.4494827091693878The modified gen p mean: 0.44997966289520264, gen p mean: -0.0407346710562706, mean p set: 0.45045995712280273
loss_pred:0.014712601900100708, decouple_loss:0.0010856441222131252
loss_pred:0.01467516552656889, decouple_loss:0.0011218431172892451
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199519395828247, gen p mean: -0.04741475358605385, mean p set: 0.45247551798820496
loss_pred:0.014485299587249756, decouple_loss:0.001134722726419568
The modified gen p mean: 0.4500126242637634, gen p mean: -0.048700299113988876, mean p set: 0.4504929184913635The modified gen p mean: 0.44852709770202637, gen p mean: -0.04568704962730408, mean p set: 0.44900739192962646
loss_pred:0.01486996654421091, decouple_loss:0.0011315016308799386
loss_pred:0.01503810565918684, decouple_loss:0.0011997617548331618
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505431354045868, gen p mean: -0.048160161823034286, mean p set: 0.4510234594345093
loss_pred:0.015126531943678856, decouple_loss:0.00106298946775496
The modified gen p mean: 0.4505285322666168, gen p mean: -0.04453537240624428, mean p set: 0.4510088264942169The modified gen p mean: 0.4503028690814972, gen p mean: -0.040830157697200775, mean p set: 0.4507831633090973
loss_pred:0.01404649205505848, decouple_loss:0.0009730049641802907
loss_pred:0.01524015236645937, decouple_loss:0.0009908038191497326
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502885043621063, gen p mean: -0.04405904561281204, mean p set: 0.4507688283920288
loss_pred:0.015240117907524109, decouple_loss:0.001056444481946528
The modified gen p mean: 0.4497659504413605, gen p mean: -0.04766875132918358, mean p set: 0.45024624466896057The modified gen p mean: 0.4497230648994446, gen p mean: -0.045504290610551834, mean p set: 0.4502033293247223
loss_pred:0.014451513066887856, decouple_loss:0.0011037957156077027
loss_pred:0.014669339172542095, decouple_loss:0.0010165616404265165
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44949978590011597, gen p mean: -0.03771321475505829, mean p set: 0.4499800503253937
loss_pred:0.015197564847767353, decouple_loss:0.0010267180623486638
The modified gen p mean: 0.4513234794139862, gen p mean: -0.04419521987438202, mean p set: 0.4518038034439087The modified gen p mean: 0.4493011236190796, gen p mean: -0.038677629083395004, mean p set: 0.4497814178466797
loss_pred:0.014251861721277237, decouple_loss:0.0010977364145219326
loss_pred:0.015175937674939632, decouple_loss:0.0010922671062871814
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227620005607605, gen p mean: -0.03574932739138603, mean p set: 0.45275649428367615
loss_pred:0.014372996054589748, decouple_loss:0.0010431783739477396
The modified gen p mean: 0.4501555562019348, gen p mean: -0.04129793867468834, mean p set: 0.4506358802318573The modified gen p mean: 0.4500461518764496, gen p mean: -0.03862234205007553, mean p set: 0.4505264163017273
loss_pred:0.01523725874722004, decouple_loss:0.001041841460391879
loss_pred:0.013917246833443642, decouple_loss:0.001075579784810543
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982656836509705, gen p mean: -0.04476470127701759, mean p set: 0.45030689239501953
loss_pred:0.014184060506522655, decouple_loss:0.0009355327347293496
The modified gen p mean: 0.4477842450141907, gen p mean: -0.040450986474752426, mean p set: 0.4482645094394684The modified gen p mean: 0.4499203860759735, gen p mean: -0.03945108875632286, mean p set: 0.4504006803035736
loss_pred:0.015533164143562317, decouple_loss:0.001019293093122542
loss_pred:0.014691673219203949, decouple_loss:0.0009850276401266456
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528367221355438, gen p mean: -0.04251626506447792, mean p set: 0.4533170461654663
loss_pred:0.015925049781799316, decouple_loss:0.0012607573298737407
The modified gen p mean: 0.45227065682411194, gen p mean: -0.03604387864470482, mean p set: 0.45275095105171204The modified gen p mean: 0.45082202553749084, gen p mean: -0.03975086286664009, mean p set: 0.45130228996276855
loss_pred:0.01572541333734989, decouple_loss:0.0012873634696006775
loss_pred:0.01587865501642227, decouple_loss:0.001354289473965764
2023-05-01 17:32:00 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.049956064671278, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04587505757808685, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04606053605675697, mean p set: 0.45035696029663086
loss_pred:0.0186116062104702, decouple_loss:0.0011234262492507696
loss_pred:0.017547035589814186, decouple_loss:0.0010765129700303078
loss_pred:0.017472634091973305, decouple_loss:0.0010924824746325612
WV_0_PC_1_EH_0_PS_40, loss: 0.017931966111063957, avg_mse: 0.025886617600917816
current test mse: 0.025887
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505383372306824, gen p mean: -0.03944174572825432, mean p set: 0.4510186016559601
The modified gen p mean: 0.4513258635997772, gen p mean: -0.04484856128692627, mean p set: 0.45180612802505493
The modified gen p mean: 0.4508700370788574, gen p mean: -0.03779687359929085, mean p set: 0.4513503611087799
loss_pred:0.01710917428135872, decouple_loss:0.0010665231384336948
loss_pred:0.016765832901000977, decouple_loss:0.0011562320869415998
loss_pred:0.016986455768346786, decouple_loss:0.0010529359569773078
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527190923690796, gen p mean: -0.04177563264966011, mean p set: 0.4531993865966797
The modified gen p mean: 0.4527140259742737, gen p mean: -0.04000558704137802, mean p set: 0.4531942903995514
loss_pred:0.0159628726541996, decouple_loss:0.0010884026996791363
loss_pred:0.016607267782092094, decouple_loss:0.0011367292609065771
The modified gen p mean: 0.45276227593421936, gen p mean: -0.04045061394572258, mean p set: 0.45324259996414185
loss_pred:0.015536392107605934, decouple_loss:0.0010411071125417948
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522641897201538, gen p mean: -0.041897740215063095, mean p set: 0.4527444541454315
The modified gen p mean: 0.45398029685020447, gen p mean: -0.03826434537768364, mean p set: 0.45446059107780457
loss_pred:0.016271106898784637, decouple_loss:0.0010614850325509906
loss_pred:0.015410914085805416, decouple_loss:0.0011456062784418464
The modified gen p mean: 0.45294246077537537, gen p mean: -0.0428595170378685, mean p set: 0.4534226953983307
loss_pred:0.015913045033812523, decouple_loss:0.001035414170473814
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513101279735565, gen p mean: -0.042435016483068466, mean p set: 0.4517904222011566
The modified gen p mean: 0.45221829414367676, gen p mean: -0.04212493076920509, mean p set: 0.45269855856895447
loss_pred:0.017242373898625374, decouple_loss:0.0012179448967799544
loss_pred:0.015807634219527245, decouple_loss:0.0011260374449193478
The modified gen p mean: 0.4522453844547272, gen p mean: -0.044642750173807144, mean p set: 0.4527256488800049
loss_pred:0.016339261084794998, decouple_loss:0.001203159336000681
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536548852920532, gen p mean: -0.039807721972465515, mean p set: 0.4541351795196533
The modified gen p mean: 0.4516957700252533, gen p mean: -0.04000171273946762, mean p set: 0.4521760940551758
The modified gen p mean: 0.4510827362537384, gen p mean: -0.04497874528169632, mean p set: 0.4515630006790161
loss_pred:0.015631821006536484, decouple_loss:0.0011627105996012688
loss_pred:0.017404302954673767, decouple_loss:0.0013279553968459368loss_pred:0.01656246930360794, decouple_loss:0.001117949141189456
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510241150856018, gen p mean: -0.05009206756949425, mean p set: 0.4515043795108795
The modified gen p mean: 0.4521506130695343, gen p mean: -0.044702958315610886, mean p set: 0.4526309072971344
loss_pred:0.017024269327521324, decouple_loss:0.001142296358011663
loss_pred:0.01638231985270977, decouple_loss:0.0010300620924681425
The modified gen p mean: 0.45097970962524414, gen p mean: -0.0426897369325161, mean p set: 0.45146000385284424
loss_pred:0.015885550528764725, decouple_loss:0.0011967056198045611
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511820375919342, gen p mean: -0.047613222151994705, mean p set: 0.4516623318195343
The modified gen p mean: 0.4520118236541748, gen p mean: -0.051350146532058716, mean p set: 0.4524921178817749
loss_pred:0.016672642901539803, decouple_loss:0.0011093590874224901
loss_pred:0.016100497916340828, decouple_loss:0.0010488651460036635
The modified gen p mean: 0.45271334052085876, gen p mean: -0.04459245130419731, mean p set: 0.45319366455078125
loss_pred:0.01483207754790783, decouple_loss:0.0011966631282120943
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104166865348816, gen p mean: -0.05374695360660553, mean p set: 0.45152196288108826The modified gen p mean: 0.45141997933387756, gen p mean: -0.043653592467308044, mean p set: 0.4519002437591553
loss_pred:0.016743715852499008, decouple_loss:0.001084494637325406
loss_pred:0.015422282740473747, decouple_loss:0.001092634629458189
The modified gen p mean: 0.4509720802307129, gen p mean: -0.047404851764440536, mean p set: 0.451452374458313
loss_pred:0.016425741836428642, decouple_loss:0.0010358039289712906
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524080455303192, gen p mean: -0.049340713769197464, mean p set: 0.4528883397579193
The modified gen p mean: 0.4508156180381775, gen p mean: -0.04482163488864899, mean p set: 0.4512959122657776
loss_pred:0.016029909253120422, decouple_loss:0.0010685034794732928
loss_pred:0.015668421983718872, decouple_loss:0.0010909428820014
The modified gen p mean: 0.45233041048049927, gen p mean: -0.050569381564855576, mean p set: 0.45281070470809937
loss_pred:0.016354568302631378, decouple_loss:0.0010801246389746666
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516972601413727, gen p mean: -0.04454444348812103, mean p set: 0.4521775543689728
The modified gen p mean: 0.453058660030365, gen p mean: -0.04839432239532471, mean p set: 0.4535389542579651
loss_pred:0.016851425170898438, decouple_loss:0.0010443737264722586
loss_pred:0.016282828524708748, decouple_loss:0.0010468552354723215
The modified gen p mean: 0.45048317313194275, gen p mean: -0.051794618368148804, mean p set: 0.45096346735954285
loss_pred:0.016853131353855133, decouple_loss:0.0010636020451784134
2023-05-01 17:33:56 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05743616446852684, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830237865448, gen p mean: -0.053428445011377335, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05314556509256363, mean p set: 0.45035696029663086
loss_pred:0.018466388806700706, decouple_loss:0.0014044196577742696
loss_pred:0.0174118559807539, decouple_loss:0.0013456743909046054
loss_pred:0.01728249527513981, decouple_loss:0.0014954018406569958
WV_0_PC_1_EH_0_PS_40, loss: 0.017791006714105606, avg_mse: 0.025523388758301735
current test mse: 0.025523
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507489502429962, gen p mean: -0.04510834068059921, mean p set: 0.4512292742729187
loss_pred:0.017898598685860634, decouple_loss:0.0012487564235925674
The modified gen p mean: 0.45056912302970886, gen p mean: -0.04229800030589104, mean p set: 0.4510493874549866The modified gen p mean: 0.45134875178337097, gen p mean: -0.03976452350616455, mean p set: 0.45182904601097107
loss_pred:0.017443358898162842, decouple_loss:0.001183000742457807loss_pred:0.017143741250038147, decouple_loss:0.0011404150864109397
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508441388607025, gen p mean: -0.0506390742957592, mean p set: 0.4513244330883026
The modified gen p mean: 0.4506838619709015, gen p mean: -0.04289648309350014, mean p set: 0.4511641561985016
loss_pred:0.016835510730743408, decouple_loss:0.0010225920705124736
loss_pred:0.015679234638810158, decouple_loss:0.0010511489817872643
The modified gen p mean: 0.45347917079925537, gen p mean: -0.046480465680360794, mean p set: 0.45395946502685547
loss_pred:0.015554018318653107, decouple_loss:0.0011827885173261166
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180991291999817, gen p mean: -0.04619830101728439, mean p set: 0.45229020714759827
The modified gen p mean: 0.45096471905708313, gen p mean: -0.04795822128653526, mean p set: 0.4514450132846832
loss_pred:0.016798846423625946, decouple_loss:0.0009737196960486472
loss_pred:0.01654362678527832, decouple_loss:0.0010734639363363385
The modified gen p mean: 0.4539129436016083, gen p mean: -0.04134633392095566, mean p set: 0.45439326763153076
loss_pred:0.01587926410138607, decouple_loss:0.0011369760613888502
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272040367126465, gen p mean: -0.04576856270432472, mean p set: 0.45320072770118713
loss_pred:0.01601945236325264, decouple_loss:0.001103269518353045
The modified gen p mean: 0.45246726274490356, gen p mean: -0.04990911856293678, mean p set: 0.45294755697250366The modified gen p mean: 0.4522090256214142, gen p mean: -0.046593617647886276, mean p set: 0.4526892900466919
loss_pred:0.016408827155828476, decouple_loss:0.0012068701907992363
loss_pred:0.01584000326693058, decouple_loss:0.0010627229930832982
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521689713001251, gen p mean: -0.04564313217997551, mean p set: 0.45264923572540283
The modified gen p mean: 0.45270633697509766, gen p mean: -0.04479704424738884, mean p set: 0.45318663120269775
loss_pred:0.0161216352134943, decouple_loss:0.0010530452709645033
loss_pred:0.015719838440418243, decouple_loss:0.0010150595335289836
The modified gen p mean: 0.45220547914505005, gen p mean: -0.04681592062115669, mean p set: 0.45268580317497253
loss_pred:0.017025331035256386, decouple_loss:0.0012058764696121216
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511546194553375, gen p mean: -0.04833424091339111, mean p set: 0.4516349136829376
loss_pred:0.016831686720252037, decouple_loss:0.0011570705100893974
The modified gen p mean: 0.4521137475967407, gen p mean: -0.04394756257534027, mean p set: 0.4525940418243408The modified gen p mean: 0.4543343782424927, gen p mean: -0.04176432266831398, mean p set: 0.4548146724700928
loss_pred:0.016186902299523354, decouple_loss:0.000995559268631041
loss_pred:0.015596579760313034, decouple_loss:0.0010393895208835602
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513583779335022, gen p mean: -0.0489572249352932, mean p set: 0.4518386423587799
The modified gen p mean: 0.45249706506729126, gen p mean: -0.04391549900174141, mean p set: 0.45297735929489136
loss_pred:0.01671372540295124, decouple_loss:0.00111102475784719
loss_pred:0.01552771870046854, decouple_loss:0.0013423572527244687
The modified gen p mean: 0.4528239965438843, gen p mean: -0.044088274240493774, mean p set: 0.4533042907714844
loss_pred:0.015730012208223343, decouple_loss:0.0011285931104794145
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515138268470764, gen p mean: -0.044178783893585205, mean p set: 0.4519941210746765
loss_pred:0.01618555560708046, decouple_loss:0.0011629733489826322
The modified gen p mean: 0.4522281885147095, gen p mean: -0.048384569585323334, mean p set: 0.45270848274230957The modified gen p mean: 0.4498565196990967, gen p mean: -0.050949692726135254, mean p set: 0.4503368139266968
loss_pred:0.016612855717539787, decouple_loss:0.0011460853274911642
loss_pred:0.016532374545931816, decouple_loss:0.0012352218618616462
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
NaN value num: 0
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521111249923706, gen p mean: -0.0424378477036953, mean p set: 0.4525914490222931
loss_pred:0.017335250973701477, decouple_loss:0.0012647727271541953
The modified gen p mean: 0.4496085047721863, gen p mean: -0.04639225825667381, mean p set: 0.4500887989997864The modified gen p mean: 0.4503987729549408, gen p mean: -0.045146409422159195, mean p set: 0.4508790671825409
loss_pred:0.016936903819441795, decouple_loss:0.0011926700826734304
loss_pred:0.01708225905895233, decouple_loss:0.0012417889665812254
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862332940101624, gen p mean: -0.04955735802650452, mean p set: 0.44910362362861633
The modified gen p mean: 0.4495670199394226, gen p mean: -0.04859016090631485, mean p set: 0.4500472843647003
loss_pred:0.016510754823684692, decouple_loss:0.0010086627444252372
loss_pred:0.017341267317533493, decouple_loss:0.0012014935491606593
The modified gen p mean: 0.45041003823280334, gen p mean: -0.04589054360985756, mean p set: 0.45089030265808105
loss_pred:0.01779426448047161, decouple_loss:0.0011060686083510518
2023-05-01 17:36:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.059880152344703674, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830237865448, gen p mean: -0.056008677929639816, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05565653741359711, mean p set: 0.45035696029663086
loss_pred:0.01832231692969799, decouple_loss:0.0012161163613200188
loss_pred:0.01717260479927063, decouple_loss:0.0011069078464061022loss_pred:0.017328044399619102, decouple_loss:0.0011981336865574121
WV_0_PC_1_EH_0_PS_40, loss: 0.017666339874267578, avg_mse: 0.025326404720544815
current test mse: 0.025326
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179909467697144, gen p mean: -0.04885847866535187, mean p set: 0.45227932929992676
The modified gen p mean: 0.45036736130714417, gen p mean: -0.05176149308681488, mean p set: 0.45084765553474426
loss_pred:0.016309337690472603, decouple_loss:0.0011672929394990206
The modified gen p mean: 0.4519024193286896, gen p mean: -0.05152665078639984, mean p set: 0.4523826837539673
loss_pred:0.017301950603723526, decouple_loss:0.0011667314684018493
loss_pred:0.016702480614185333, decouple_loss:0.0011933980276808143
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495231807231903, gen p mean: -0.05517782270908356, mean p set: 0.4500034749507904
loss_pred:0.017497211694717407, decouple_loss:0.0010720883728936315
The modified gen p mean: 0.45123109221458435, gen p mean: -0.048621661961078644, mean p set: 0.45171138644218445The modified gen p mean: 0.45046067237854004, gen p mean: -0.05643517151474953, mean p set: 0.45094096660614014
loss_pred:0.016521675512194633, decouple_loss:0.0011611504014581442
loss_pred:0.017166072502732277, decouple_loss:0.001013196655549109
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44924798607826233, gen p mean: -0.05309363827109337, mean p set: 0.4497282803058624
The modified gen p mean: 0.45238858461380005, gen p mean: -0.044624630361795425, mean p set: 0.45286887884140015
loss_pred:0.016629580408334732, decouple_loss:0.0011232462711632252
loss_pred:0.016203003004193306, decouple_loss:0.001045423443429172
The modified gen p mean: 0.4499431252479553, gen p mean: -0.04946074262261391, mean p set: 0.4504234194755554
loss_pred:0.018121233209967613, decouple_loss:0.001112153404392302
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975170493125916, gen p mean: -0.05068788304924965, mean p set: 0.45023199915885925
loss_pred:0.016366614028811455, decouple_loss:0.0009668614948168397
The modified gen p mean: 0.4514771103858948, gen p mean: -0.05086848884820938, mean p set: 0.4519574046134949The modified gen p mean: 0.4509873390197754, gen p mean: -0.04640284925699234, mean p set: 0.4514676034450531
loss_pred:0.016915837302803993, decouple_loss:0.0010257334215566516
loss_pred:0.017427528277039528, decouple_loss:0.0011043703416362405
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522383213043213, gen p mean: -0.048156142234802246, mean p set: 0.4527186155319214
The modified gen p mean: 0.4490223824977875, gen p mean: -0.05041763558983803, mean p set: 0.4495026767253876loss_pred:0.01653510145843029, decouple_loss:0.0009620365453884006
The modified gen p mean: 0.45108312368392944, gen p mean: -0.04956469312310219, mean p set: 0.45156344771385193
loss_pred:0.0159655399620533, decouple_loss:0.000984717858955264
loss_pred:0.016654333099722862, decouple_loss:0.000955279974732548
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960302114486694, gen p mean: -0.05154174938797951, mean p set: 0.45008331537246704
loss_pred:0.016286330297589302, decouple_loss:0.0011861288221552968
The modified gen p mean: 0.4500294327735901, gen p mean: -0.05525417998433113, mean p set: 0.4505097270011902The modified gen p mean: 0.4505070447921753, gen p mean: -0.052258070558309555, mean p set: 0.4509873688220978
loss_pred:0.016610797494649887, decouple_loss:0.001089519471861422
loss_pred:0.016504205763339996, decouple_loss:0.0011722245253622532
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906169176101685, gen p mean: -0.05149967595934868, mean p set: 0.44954198598861694
loss_pred:0.016854731366038322, decouple_loss:0.0008949294569902122
The modified gen p mean: 0.45179152488708496, gen p mean: -0.04673616960644722, mean p set: 0.45227181911468506The modified gen p mean: 0.45020562410354614, gen p mean: -0.045240368694067, mean p set: 0.45068594813346863
loss_pred:0.017106803134083748, decouple_loss:0.0010699870763346553
loss_pred:0.016674192622303963, decouple_loss:0.0010501956567168236
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499739408493042, gen p mean: -0.05460766330361366, mean p set: 0.4504542350769043
The modified gen p mean: 0.4515248239040375, gen p mean: -0.04850548133254051, mean p set: 0.45200514793395996
loss_pred:0.016885753720998764, decouple_loss:0.001004120334982872
loss_pred:0.017028827220201492, decouple_loss:0.000977145740762353
The modified gen p mean: 0.44940486550331116, gen p mean: -0.04976443946361542, mean p set: 0.44988515973091125
loss_pred:0.01665167324244976, decouple_loss:0.0009725497802719474
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452693909406662, gen p mean: -0.04547512158751488, mean p set: 0.4531742036342621
The modified gen p mean: 0.452014684677124, gen p mean: -0.04559063911437988, mean p set: 0.4524949789047241
loss_pred:0.01693042740225792, decouple_loss:0.001016060123220086
loss_pred:0.016347842290997505, decouple_loss:0.0010446318192407489
The modified gen p mean: 0.45300352573394775, gen p mean: -0.04244492948055267, mean p set: 0.45348381996154785
loss_pred:0.01719106175005436, decouple_loss:0.001060127280652523
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940727949142456, gen p mean: -0.05158581957221031, mean p set: 0.44988757371902466
loss_pred:0.01596403867006302, decouple_loss:0.0009311657631769776
The modified gen p mean: 0.45184168219566345, gen p mean: -0.04557330906391144, mean p set: 0.45232194662094116The modified gen p mean: 0.45205265283584595, gen p mean: -0.04143461212515831, mean p set: 0.45253291726112366
loss_pred:0.016612853854894638, decouple_loss:0.0009478566353209317
loss_pred:0.016898106783628464, decouple_loss:0.0009321438265033066
2023-05-01 17:38:21 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05516178905963898, mean p set: 0.4502691626548767
The modified gen p mean: 0.44987666606903076, gen p mean: -0.050833892077207565, mean p set: 0.45035696029663086
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0509500578045845, mean p set: 0.4500633478164673
loss_pred:0.01830766722559929, decouple_loss:0.0011090830666944385
loss_pred:0.017197873443365097, decouple_loss:0.0010405657812952995
loss_pred:0.017308758571743965, decouple_loss:0.001060446142219007
WV_0_PC_1_EH_0_PS_40, loss: 0.01765826903283596, avg_mse: 0.025332201272249222
current test mse: 0.025332
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902458786964417, gen p mean: -0.04588361456990242, mean p set: 0.4495048522949219
loss_pred:0.016853928565979004, decouple_loss:0.001058924593962729
The modified gen p mean: 0.45146384835243225, gen p mean: -0.042907096445560455, mean p set: 0.45194414258003235The modified gen p mean: 0.44922390580177307, gen p mean: -0.047028448432683945, mean p set: 0.4497041702270508
loss_pred:0.016895582899451256, decouple_loss:0.0009438790148124099
loss_pred:0.016006045043468475, decouple_loss:0.000949488312471658
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939979910850525, gen p mean: -0.04697899520397186, mean p set: 0.44988009333610535
The modified gen p mean: 0.4489685595035553, gen p mean: -0.042596835643053055, mean p set: 0.4494488537311554
loss_pred:0.015624812804162502, decouple_loss:0.0008614424150437117
loss_pred:0.01615092158317566, decouple_loss:0.0009393304353579879
The modified gen p mean: 0.44979164004325867, gen p mean: -0.04117989540100098, mean p set: 0.45027193427085876
loss_pred:0.01679493859410286, decouple_loss:0.0009644535603001714
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990274310112, gen p mean: -0.05156102031469345, mean p set: 0.4503830373287201
The modified gen p mean: 0.45234429836273193, gen p mean: -0.04204362630844116, mean p set: 0.45282456278800964
loss_pred:0.016019156202673912, decouple_loss:0.0010098505299538374
loss_pred:0.017134087160229683, decouple_loss:0.0009486905764788389
The modified gen p mean: 0.4493679106235504, gen p mean: -0.0491231232881546, mean p set: 0.4498482048511505
loss_pred:0.01685180887579918, decouple_loss:0.0009286574786528945
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510420858860016, gen p mean: -0.046085506677627563, mean p set: 0.4515224099159241
The modified gen p mean: 0.4505055844783783, gen p mean: -0.052116408944129944, mean p set: 0.450985848903656
loss_pred:0.017239773645997047, decouple_loss:0.0009336600196547806
loss_pred:0.016558054834604263, decouple_loss:0.0009039564174599946
The modified gen p mean: 0.45141661167144775, gen p mean: -0.044740624725818634, mean p set: 0.45189690589904785
loss_pred:0.016136908903717995, decouple_loss:0.0009167782263830304
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886985421180725, gen p mean: -0.045899465680122375, mean p set: 0.44935014843940735
loss_pred:0.015519630163908005, decouple_loss:0.0009402072755619884
The modified gen p mean: 0.4485670328140259, gen p mean: -0.045906804502010345, mean p set: 0.44904735684394836The modified gen p mean: 0.44874706864356995, gen p mean: -0.050484996289014816, mean p set: 0.44922736287117004
loss_pred:0.0169171541929245, decouple_loss:0.0010424205102026463
loss_pred:0.015783600509166718, decouple_loss:0.0009965142235159874
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859984517097473, gen p mean: -0.05277053639292717, mean p set: 0.44908010959625244
The modified gen p mean: 0.4501669406890869, gen p mean: -0.05047024413943291, mean p set: 0.450647234916687
loss_pred:0.016912762075662613, decouple_loss:0.0008934605284593999
loss_pred:0.01663028821349144, decouple_loss:0.0008744808728806674
The modified gen p mean: 0.4496549963951111, gen p mean: -0.047349583357572556, mean p set: 0.45013532042503357
loss_pred:0.01760663278400898, decouple_loss:0.0009163281065411866
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180878043174744, gen p mean: -0.04928777366876602, mean p set: 0.45228907465934753
The modified gen p mean: 0.4496305584907532, gen p mean: -0.05046271160244942, mean p set: 0.45011085271835327
loss_pred:0.016668779775500298, decouple_loss:0.001238232827745378
loss_pred:0.017139313742518425, decouple_loss:0.0011050996836274862
The modified gen p mean: 0.45059144496917725, gen p mean: -0.04777245596051216, mean p set: 0.45107173919677734
loss_pred:0.016667108982801437, decouple_loss:0.0009248077403753996
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504108428955078, gen p mean: -0.053222838789224625, mean p set: 0.4508911669254303
loss_pred:0.016619615256786346, decouple_loss:0.001060739392414689
The modified gen p mean: 0.44958770275115967, gen p mean: -0.051485951989889145, mean p set: 0.45006799697875977The modified gen p mean: 0.448866069316864, gen p mean: -0.05094873532652855, mean p set: 0.4493463933467865
loss_pred:0.016005845740437508, decouple_loss:0.0009040149161592126
loss_pred:0.01789223402738571, decouple_loss:0.001070809317752719
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44530779123306274, gen p mean: -0.06063024699687958, mean p set: 0.44578808546066284
loss_pred:0.014663674868643284, decouple_loss:0.0010644736466929317
The modified gen p mean: 0.44705238938331604, gen p mean: -0.057721350342035294, mean p set: 0.44753265380859375The modified gen p mean: 0.4466697573661804, gen p mean: -0.0592794306576252, mean p set: 0.4471500515937805
loss_pred:0.014883473515510559, decouple_loss:0.0010199698153883219
loss_pred:0.015131944790482521, decouple_loss:0.0010226457379758358
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468380808830261, gen p mean: -0.05810913071036339, mean p set: 0.4473183751106262
loss_pred:0.01484570000320673, decouple_loss:0.0011455172207206488
The modified gen p mean: 0.4461233913898468, gen p mean: -0.055576879531145096, mean p set: 0.4466037154197693The modified gen p mean: 0.4469769299030304, gen p mean: -0.05898258835077286, mean p set: 0.4474572241306305
loss_pred:0.01467117015272379, decouple_loss:0.0011559476843103766
loss_pred:0.015037821605801582, decouple_loss:0.001178388250991702
2023-05-01 17:40:49 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05919068306684494, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.055177733302116394, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.055099084973335266, mean p set: 0.45035696029663086
loss_pred:0.018444305285811424, decouple_loss:0.0011357017792761326
loss_pred:0.01742956042289734, decouple_loss:0.0011388579150661826
loss_pred:0.017351720482110977, decouple_loss:0.0011822764063253999
WV_0_PC_1_EH_0_PS_40, loss: 0.01779947802424431, avg_mse: 0.02557332254946232
current test mse: 0.025573
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467865526676178, gen p mean: -0.0623161606490612, mean p set: 0.4472668468952179
The modified gen p mean: 0.44758808612823486, gen p mean: -0.053083550184965134, mean p set: 0.44806838035583496
loss_pred:0.014062950387597084, decouple_loss:0.0010279981652274728
The modified gen p mean: 0.4466868042945862, gen p mean: -0.051096443086862564, mean p set: 0.4471670687198639
loss_pred:0.014523668214678764, decouple_loss:0.0010524659883230925
loss_pred:0.014882891438901424, decouple_loss:0.0010390894021838903
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44517549872398376, gen p mean: -0.05561138689517975, mean p set: 0.44565579295158386
The modified gen p mean: 0.44632676243782043, gen p mean: -0.05678967013955116, mean p set: 0.44680705666542053
loss_pred:0.014391162432730198, decouple_loss:0.00126485840883106
loss_pred:0.014701933600008488, decouple_loss:0.0012372677447274327
The modified gen p mean: 0.44605761766433716, gen p mean: -0.05223911628127098, mean p set: 0.44653791189193726
loss_pred:0.014663067646324635, decouple_loss:0.0012756793294101954
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643449783325195, gen p mean: -0.05072515830397606, mean p set: 0.44691479206085205
The modified gen p mean: 0.4465217888355255, gen p mean: -0.05167042464017868, mean p set: 0.4470020830631256
loss_pred:0.01475352793931961, decouple_loss:0.001178750186227262
loss_pred:0.014212056063115597, decouple_loss:0.0011722980998456478
The modified gen p mean: 0.44700536131858826, gen p mean: -0.052241161465644836, mean p set: 0.44748565554618835
loss_pred:0.014119181782007217, decouple_loss:0.0011863993713632226
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464333653450012, gen p mean: -0.05211187154054642, mean p set: 0.44691362977027893
The modified gen p mean: 0.4460991322994232, gen p mean: -0.05051736533641815, mean p set: 0.4465794563293457
loss_pred:0.01443895511329174, decouple_loss:0.0012989976676180959
loss_pred:0.014619564637541771, decouple_loss:0.001180493738502264
The modified gen p mean: 0.44740480184555054, gen p mean: -0.04751507565379143, mean p set: 0.44788506627082825
loss_pred:0.014303532429039478, decouple_loss:0.0011644825572147965
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452042877674103, gen p mean: -0.04776310920715332, mean p set: 0.4456845819950104
The modified gen p mean: 0.4468703269958496, gen p mean: -0.047712501138448715, mean p set: 0.4473506212234497
loss_pred:0.014134191907942295, decouple_loss:0.0013362831668928266
loss_pred:0.014305957593023777, decouple_loss:0.001306980149820447
The modified gen p mean: 0.4472530484199524, gen p mean: -0.04535728693008423, mean p set: 0.4477333426475525
loss_pred:0.014977362006902695, decouple_loss:0.0012245284160599113
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678202271461487, gen p mean: -0.04764923080801964, mean p set: 0.44726231694221497
loss_pred:0.014067225158214569, decouple_loss:0.0011977949179708958
The modified gen p mean: 0.4466151297092438, gen p mean: -0.04995645582675934, mean p set: 0.44709545373916626The modified gen p mean: 0.44712939858436584, gen p mean: -0.04412407800555229, mean p set: 0.44760966300964355
loss_pred:0.013851040974259377, decouple_loss:0.001205087173730135
loss_pred:0.014610282145440578, decouple_loss:0.0011686417274177074
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756370782852173, gen p mean: -0.044517070055007935, mean p set: 0.4480440020561218
loss_pred:0.013809354975819588, decouple_loss:0.0011654088739305735
The modified gen p mean: 0.4470561742782593, gen p mean: -0.04469432681798935, mean p set: 0.4475364685058594The modified gen p mean: 0.44610631465911865, gen p mean: -0.04807831719517708, mean p set: 0.44658660888671875
loss_pred:0.01413703616708517, decouple_loss:0.001301019685342908
loss_pred:0.013895365409553051, decouple_loss:0.001142180641181767
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465797543525696, gen p mean: -0.047030575573444366, mean p set: 0.44706007838249207
loss_pred:0.013785935007035732, decouple_loss:0.0013136031338945031
The modified gen p mean: 0.4468129873275757, gen p mean: -0.047768447548151016, mean p set: 0.44729331135749817The modified gen p mean: 0.44794607162475586, gen p mean: -0.05064038187265396, mean p set: 0.44842633605003357
loss_pred:0.013752961531281471, decouple_loss:0.001429253607057035
loss_pred:0.014162706211209297, decouple_loss:0.0014089838368818164
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634103775024414, gen p mean: -0.0515536330640316, mean p set: 0.44682133197784424
loss_pred:0.0138740548864007, decouple_loss:0.001279932796023786
The modified gen p mean: 0.4463663399219513, gen p mean: -0.04847578704357147, mean p set: 0.446846604347229The modified gen p mean: 0.4465153217315674, gen p mean: -0.04903025180101395, mean p set: 0.44699564576148987
loss_pred:0.01411824207752943, decouple_loss:0.0011896374635398388
loss_pred:0.01400809083133936, decouple_loss:0.0012850349303334951
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679540395736694, gen p mean: -0.04547521099448204, mean p set: 0.44727569818496704
loss_pred:0.01390742976218462, decouple_loss:0.0012696129269897938
The modified gen p mean: 0.4477007985115051, gen p mean: -0.04321478679776192, mean p set: 0.44818106293678284The modified gen p mean: 0.4477648138999939, gen p mean: -0.04384465143084526, mean p set: 0.4482450783252716
loss_pred:0.013942844234406948, decouple_loss:0.0012476606061682105
loss_pred:0.01368148997426033, decouple_loss:0.001324950368143618
2023-05-01 17:42:44 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.049809638410806656, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.0459463931620121, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04572375491261482, mean p set: 0.45035696029663086
loss_pred:0.019143806770443916, decouple_loss:0.0015370966866612434
loss_pred:0.018053708598017693, decouple_loss:0.0014322332572191954
loss_pred:0.018057815730571747, decouple_loss:0.0015232970472425222
WV_0_PC_1_EH_0_PS_40, loss: 0.018493320792913437, avg_mse: 0.026886574923992157
current test mse: 0.026887
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459965229034424, gen p mean: -0.04886428639292717, mean p set: 0.44647684693336487
loss_pred:0.014591147191822529, decouple_loss:0.0013058234471827745
The modified gen p mean: 0.44759318232536316, gen p mean: -0.047690797597169876, mean p set: 0.44807347655296326The modified gen p mean: 0.4453771710395813, gen p mean: -0.04938383772969246, mean p set: 0.445857435464859
loss_pred:0.013781464658677578, decouple_loss:0.0012938434956595302
loss_pred:0.01417466625571251, decouple_loss:0.0013140204828232527
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484494626522064, gen p mean: -0.049313273280858994, mean p set: 0.4489297568798065
The modified gen p mean: 0.4463392496109009, gen p mean: -0.05102790519595146, mean p set: 0.446819543838501
loss_pred:0.013622814789414406, decouple_loss:0.0012699663639068604
loss_pred:0.014068268239498138, decouple_loss:0.001193856238387525
The modified gen p mean: 0.44680383801460266, gen p mean: -0.0492221899330616, mean p set: 0.44728413224220276
loss_pred:0.013622473925352097, decouple_loss:0.0011802579974755645
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694983959198, gen p mean: -0.049824733287096024, mean p set: 0.4474301338195801
The modified gen p mean: 0.4468805491924286, gen p mean: -0.05069971829652786, mean p set: 0.4473608434200287
loss_pred:0.013856842182576656, decouple_loss:0.0013024287763983011
loss_pred:0.013723745942115784, decouple_loss:0.0013807577779516578
The modified gen p mean: 0.44734692573547363, gen p mean: -0.053823646157979965, mean p set: 0.44782721996307373
loss_pred:0.013576035387814045, decouple_loss:0.001244585495442152
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461154639720917, gen p mean: -0.053392522037029266, mean p set: 0.44659578800201416
The modified gen p mean: 0.4466235041618347, gen p mean: -0.04708370193839073, mean p set: 0.4471038281917572
loss_pred:0.0135974595323205, decouple_loss:0.00131885870359838
loss_pred:0.01375296339392662, decouple_loss:0.001164205139502883
The modified gen p mean: 0.4460671544075012, gen p mean: -0.05043233931064606, mean p set: 0.4465474784374237
loss_pred:0.013815189711749554, decouple_loss:0.0013521749060600996
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674137234687805, gen p mean: -0.05216061696410179, mean p set: 0.44722166657447815
The modified gen p mean: 0.44680145382881165, gen p mean: -0.05424334853887558, mean p set: 0.44728177785873413loss_pred:0.013605901040136814, decouple_loss:0.0013008954701945186
The modified gen p mean: 0.446666419506073, gen p mean: -0.048872485756874084, mean p set: 0.4471467435359955
loss_pred:0.013603376224637032, decouple_loss:0.0013582883402705193
loss_pred:0.013673698529601097, decouple_loss:0.001329077291302383
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472448229789734, gen p mean: -0.047176167368888855, mean p set: 0.4477251172065735
loss_pred:0.013698688708245754, decouple_loss:0.001320388400927186
The modified gen p mean: 0.44698432087898254, gen p mean: -0.049903541803359985, mean p set: 0.44746461510658264The modified gen p mean: 0.44701674580574036, gen p mean: -0.04521499201655388, mean p set: 0.44749704003334045
loss_pred:0.013539091683924198, decouple_loss:0.0013386545469984412
loss_pred:0.014407027512788773, decouple_loss:0.0012914080871269107
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44656580686569214, gen p mean: -0.04265782609581947, mean p set: 0.44704607129096985
The modified gen p mean: 0.4456709921360016, gen p mean: -0.04908718913793564, mean p set: 0.4461512565612793
loss_pred:0.01372508704662323, decouple_loss:0.0011543295113369823
loss_pred:0.013809050433337688, decouple_loss:0.0011547033209353685
The modified gen p mean: 0.44671717286109924, gen p mean: -0.04780270904302597, mean p set: 0.44719746708869934
loss_pred:0.013864029198884964, decouple_loss:0.0011561691062524915
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446519672870636, gen p mean: -0.04493841901421547, mean p set: 0.4469999372959137
loss_pred:0.013808559626340866, decouple_loss:0.0012555420398712158
The modified gen p mean: 0.4467034637928009, gen p mean: -0.04507865011692047, mean p set: 0.447183758020401The modified gen p mean: 0.4471513032913208, gen p mean: -0.04304253309965134, mean p set: 0.4476316571235657
loss_pred:0.014052830636501312, decouple_loss:0.0012439037673175335
loss_pred:0.013795970007777214, decouple_loss:0.0012635202147066593
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
NaN value num: 0
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45154979825019836, gen p mean: -0.04320208355784416, mean p set: 0.45203009247779846
loss_pred:0.016701867803931236, decouple_loss:0.0012016926193609834
The modified gen p mean: 0.45163533091545105, gen p mean: -0.03979945927858353, mean p set: 0.45211559534072876The modified gen p mean: 0.4523903429508209, gen p mean: -0.04288109019398689, mean p set: 0.452870637178421
loss_pred:0.01711980067193508, decouple_loss:0.0012737197102978826
loss_pred:0.01763978600502014, decouple_loss:0.0013099061325192451
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45258423686027527, gen p mean: -0.04076569899916649, mean p set: 0.45306456089019775
The modified gen p mean: 0.45029473304748535, gen p mean: -0.04466455057263374, mean p set: 0.45077502727508545
loss_pred:0.0169070977717638, decouple_loss:0.001249753637239337
loss_pred:0.017420684918761253, decouple_loss:0.0012214680900797248
The modified gen p mean: 0.4539056420326233, gen p mean: -0.04305694252252579, mean p set: 0.4543859660625458
loss_pred:0.016420533880591393, decouple_loss:0.0012151953997090459
2023-05-01 17:45:17 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.048273973166942596, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.044705383479595184, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.044634923338890076, mean p set: 0.45035696029663086
loss_pred:0.01869950257241726, decouple_loss:0.0014319951878860593
loss_pred:0.017702315002679825, decouple_loss:0.0013393244007602334
loss_pred:0.0176425538957119, decouple_loss:0.0013937073526903987
WV_0_PC_1_EH_0_PS_40, loss: 0.0180842075496912, avg_mse: 0.026132021099328995
current test mse: 0.026132
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45382753014564514, gen p mean: -0.03842892125248909, mean p set: 0.4543078541755676
The modified gen p mean: 0.45037293434143066, gen p mean: -0.045687638223171234, mean p set: 0.45085322856903076
loss_pred:0.016846083104610443, decouple_loss:0.0012584386859089136
The modified gen p mean: 0.4525321424007416, gen p mean: -0.047847144305706024, mean p set: 0.4530124366283417
loss_pred:0.01762635074555874, decouple_loss:0.0012102038599550724
loss_pred:0.016437754034996033, decouple_loss:0.0014963103458285332
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45270535349845886, gen p mean: -0.04673777148127556, mean p set: 0.4531856179237366
The modified gen p mean: 0.45238539576530457, gen p mean: -0.037650421261787415, mean p set: 0.4528656601905823
loss_pred:0.016318853944540024, decouple_loss:0.0013632106129080057
loss_pred:0.016791317611932755, decouple_loss:0.001188852940686047
The modified gen p mean: 0.44957488775253296, gen p mean: -0.04643627256155014, mean p set: 0.45005518198013306
loss_pred:0.01682056114077568, decouple_loss:0.0011910144239664078
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521898925304413, gen p mean: -0.03618190810084343, mean p set: 0.45267021656036377
The modified gen p mean: 0.44968923926353455, gen p mean: -0.048584114760160446, mean p set: 0.45016953349113464
loss_pred:0.016893574967980385, decouple_loss:0.0011857034405693412
loss_pred:0.016707001253962517, decouple_loss:0.0011525735026225448
The modified gen p mean: 0.4507061243057251, gen p mean: -0.05033665895462036, mean p set: 0.4511864483356476
loss_pred:0.017365191131830215, decouple_loss:0.0011458797380328178
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534645974636078, gen p mean: -0.04583584517240524, mean p set: 0.4539449214935303
The modified gen p mean: 0.4523267447948456, gen p mean: -0.047138046473264694, mean p set: 0.4528070092201233
The modified gen p mean: 0.4510918855667114, gen p mean: -0.045930907130241394, mean p set: 0.45157214999198914
loss_pred:0.01651272550225258, decouple_loss:0.0011967485770583153
loss_pred:0.016891585662961006, decouple_loss:0.0011437380453571677loss_pred:0.016508720815181732, decouple_loss:0.0011245888890698552
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077621936798096, gen p mean: -0.0461595393717289, mean p set: 0.45125651359558105
The modified gen p mean: 0.45025017857551575, gen p mean: -0.048708923161029816, mean p set: 0.45073044300079346
loss_pred:0.01612989231944084, decouple_loss:0.0012747520813718438
loss_pred:0.016952773556113243, decouple_loss:0.00122668850235641
The modified gen p mean: 0.4530589282512665, gen p mean: -0.04857311025261879, mean p set: 0.45353925228118896
loss_pred:0.016288375481963158, decouple_loss:0.0012801096308976412
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45167723298072815, gen p mean: -0.0473325178027153, mean p set: 0.45215752720832825
The modified gen p mean: 0.4548882842063904, gen p mean: -0.04666086658835411, mean p set: 0.45536860823631287loss_pred:0.016605079174041748, decouple_loss:0.0011111415224149823
The modified gen p mean: 0.4521520137786865, gen p mean: -0.04225236922502518, mean p set: 0.4526323080062866
loss_pred:0.016035668551921844, decouple_loss:0.0011297636665403843
loss_pred:0.016698364168405533, decouple_loss:0.0011918164091184735
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508713483810425, gen p mean: -0.04884133115410805, mean p set: 0.4513516426086426
loss_pred:0.016443965956568718, decouple_loss:0.00130954768974334
The modified gen p mean: 0.4520688056945801, gen p mean: -0.045252468436956406, mean p set: 0.45254912972450256The modified gen p mean: 0.45203450322151184, gen p mean: -0.04974563047289848, mean p set: 0.45251479744911194
loss_pred:0.01660073921084404, decouple_loss:0.0012917483691126108
loss_pred:0.01629256270825863, decouple_loss:0.0013808642979711294
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45141032338142395, gen p mean: -0.050290536135435104, mean p set: 0.45189061760902405
loss_pred:0.01636294089257717, decouple_loss:0.0013371638488024473
The modified gen p mean: 0.45221641659736633, gen p mean: -0.0505187027156353, mean p set: 0.45269668102264404The modified gen p mean: 0.4509139657020569, gen p mean: -0.044650476425886154, mean p set: 0.451394259929657
loss_pred:0.01649584248661995, decouple_loss:0.0010514917084947228
loss_pred:0.016518738120794296, decouple_loss:0.0011179194552823901
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45085933804512024, gen p mean: -0.04899264872074127, mean p set: 0.45133963227272034
loss_pred:0.016454622149467468, decouple_loss:0.0011393730528652668
The modified gen p mean: 0.4512932002544403, gen p mean: -0.05475970357656479, mean p set: 0.451773464679718The modified gen p mean: 0.451790988445282, gen p mean: -0.04790537431836128, mean p set: 0.45227131247520447
loss_pred:0.016794156283140182, decouple_loss:0.0011827507987618446
loss_pred:0.016334205865859985, decouple_loss:0.001125137321650982
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45283243060112, gen p mean: -0.04301966726779938, mean p set: 0.4533127248287201
The modified gen p mean: 0.45303037762641907, gen p mean: -0.04326312988996506, mean p set: 0.45351067185401917
loss_pred:0.01634186878800392, decouple_loss:0.0013548729475587606
loss_pred:0.01629488728940487, decouple_loss:0.0013502473011612892
The modified gen p mean: 0.4500975012779236, gen p mean: -0.05207955092191696, mean p set: 0.4505777657032013
loss_pred:0.016577551141381264, decouple_loss:0.0011217502178624272
2023-05-01 17:47:12 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.053194839507341385, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.049678556621074677, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049365609884262085, mean p set: 0.45035696029663086
loss_pred:0.018409760668873787, decouple_loss:0.001251770881935954
loss_pred:0.017360912635922432, decouple_loss:0.001256842166185379loss_pred:0.01747693493962288, decouple_loss:0.0011878410587087274
WV_0_PC_1_EH_0_PS_40, loss: 0.01781081035733223, avg_mse: 0.02558285742998123
current test mse: 0.025583
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524969458580017, gen p mean: -0.04679805412888527, mean p set: 0.4529772400856018
The modified gen p mean: 0.4529622793197632, gen p mean: -0.04491492360830307, mean p set: 0.4534425735473633loss_pred:0.016412751749157906, decouple_loss:0.0012257506605237722
The modified gen p mean: 0.4509826600551605, gen p mean: -0.043871864676475525, mean p set: 0.4514629542827606
loss_pred:0.016498740762472153, decouple_loss:0.0011509567266330123
loss_pred:0.016363881528377533, decouple_loss:0.00116248510312289
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45300838351249695, gen p mean: -0.04826930910348892, mean p set: 0.45348870754241943
The modified gen p mean: 0.45566442608833313, gen p mean: -0.046536851674318314, mean p set: 0.45614469051361084
loss_pred:0.01632191427052021, decouple_loss:0.0011415279004722834
loss_pred:0.016167782247066498, decouple_loss:0.0011524534784257412
The modified gen p mean: 0.4524695873260498, gen p mean: -0.056599199771881104, mean p set: 0.4529498815536499
loss_pred:0.01572488248348236, decouple_loss:0.0012292766477912664
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451323926448822, gen p mean: -0.04451587796211243, mean p set: 0.4518042206764221
The modified gen p mean: 0.451680064201355, gen p mean: -0.04848030209541321, mean p set: 0.4521603584289551
loss_pred:0.016017954796552658, decouple_loss:0.0012411479838192463
loss_pred:0.01635713316500187, decouple_loss:0.001166702713817358
The modified gen p mean: 0.4493550658226013, gen p mean: -0.04855295643210411, mean p set: 0.4498353600502014
loss_pred:0.01701604388654232, decouple_loss:0.0012408860493451357
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45311006903648376, gen p mean: -0.04657880216836929, mean p set: 0.45359036326408386
The modified gen p mean: 0.45132339000701904, gen p mean: -0.04612833634018898, mean p set: 0.45180368423461914
loss_pred:0.017136940732598305, decouple_loss:0.0011801384389400482
loss_pred:0.016186412423849106, decouple_loss:0.0012539757881313562
The modified gen p mean: 0.4527682662010193, gen p mean: -0.04666662588715553, mean p set: 0.4532485604286194
loss_pred:0.01710706762969494, decouple_loss:0.0011992091313004494
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452595055103302, gen p mean: -0.04386031627655029, mean p set: 0.4530753493309021
The modified gen p mean: 0.45203670859336853, gen p mean: -0.03887079656124115, mean p set: 0.452517032623291
loss_pred:0.01648590713739395, decouple_loss:0.0010834044078364968
loss_pred:0.016485169529914856, decouple_loss:0.0011438188375905156
The modified gen p mean: 0.45142698287963867, gen p mean: -0.045567043125629425, mean p set: 0.45190730690956116
loss_pred:0.016482479870319366, decouple_loss:0.0011696486035361886
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513205289840698, gen p mean: -0.05012108385562897, mean p set: 0.4518008232116699
The modified gen p mean: 0.4524964988231659, gen p mean: -0.042320866137742996, mean p set: 0.452976793050766
loss_pred:0.016203781589865685, decouple_loss:0.0011431885650381446
loss_pred:0.01657220907509327, decouple_loss:0.0010867922101169825
The modified gen p mean: 0.4518226385116577, gen p mean: -0.05017436668276787, mean p set: 0.4523029327392578
loss_pred:0.016258804127573967, decouple_loss:0.001085755997337401
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525904655456543, gen p mean: -0.05362337455153465, mean p set: 0.453070729970932
The modified gen p mean: 0.45246604084968567, gen p mean: -0.03750770911574364, mean p set: 0.45294633507728577
loss_pred:0.016120556741952896, decouple_loss:0.0011814732570201159
loss_pred:0.016440976411104202, decouple_loss:0.001065821386873722
The modified gen p mean: 0.45286643505096436, gen p mean: -0.047702908515930176, mean p set: 0.45334672927856445
loss_pred:0.01669735088944435, decouple_loss:0.00105289148632437
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45280522108078003, gen p mean: -0.049593161791563034, mean p set: 0.45328548550605774
The modified gen p mean: 0.45473605394363403, gen p mean: -0.0436365120112896, mean p set: 0.4552163779735565
loss_pred:0.016496025025844574, decouple_loss:0.0011749553959816694
loss_pred:0.01646624505519867, decouple_loss:0.0010773753747344017
The modified gen p mean: 0.45100727677345276, gen p mean: -0.05255608260631561, mean p set: 0.45148760080337524
loss_pred:0.016352199018001556, decouple_loss:0.0010557123459875584
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
NaN value num: 0
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475797116756439, gen p mean: -0.0501224659383297, mean p set: 0.4480600357055664
loss_pred:0.01769717037677765, decouple_loss:0.0010480026248842478
The modified gen p mean: 0.44611889123916626, gen p mean: -0.05302049592137337, mean p set: 0.44659915566444397The modified gen p mean: 0.4483610987663269, gen p mean: -0.055798985064029694, mean p set: 0.4488413631916046
loss_pred:0.016689956188201904, decouple_loss:0.0011175910476595163
loss_pred:0.017223898321390152, decouple_loss:0.001081577269360423
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44638708233833313, gen p mean: -0.05172720551490784, mean p set: 0.4468673765659332
The modified gen p mean: 0.4475308656692505, gen p mean: -0.05081040784716606, mean p set: 0.4480111598968506
loss_pred:0.01694547012448311, decouple_loss:0.0010640708496794105
loss_pred:0.017313435673713684, decouple_loss:0.0010290199425071478
The modified gen p mean: 0.4465527832508087, gen p mean: -0.05034427344799042, mean p set: 0.4470330774784088
loss_pred:0.016011476516723633, decouple_loss:0.0010892323916777968
2023-05-01 17:49:43 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.052824750542640686, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04921656474471092, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.04869939759373665, mean p set: 0.45035696029663086
loss_pred:0.0183497853577137, decouple_loss:0.001114420359954238
loss_pred:0.017348216846585274, decouple_loss:0.0010617797961458564
loss_pred:0.017246725037693977, decouple_loss:0.0010653671342879534
WV_0_PC_1_EH_0_PS_40, loss: 0.017702270299196243, avg_mse: 0.025410210713744164
current test mse: 0.02541
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480065107345581, gen p mean: -0.048022136092185974, mean p set: 0.4484868049621582
The modified gen p mean: 0.4503892958164215, gen p mean: -0.05559643730521202, mean p set: 0.450869619846344
loss_pred:0.0180550254881382, decouple_loss:0.0011459577362984419
The modified gen p mean: 0.44679969549179077, gen p mean: -0.051720913499593735, mean p set: 0.44727998971939087
loss_pred:0.015745103359222412, decouple_loss:0.0009936377173289657
loss_pred:0.017137564718723297, decouple_loss:0.00104907073546201
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44696497917175293, gen p mean: -0.05432687699794769, mean p set: 0.4474453032016754
The modified gen p mean: 0.4470677375793457, gen p mean: -0.05329885706305504, mean p set: 0.4475480318069458
loss_pred:0.016502683982253075, decouple_loss:0.000995866721495986
loss_pred:0.016802500933408737, decouple_loss:0.0009958663722500205
The modified gen p mean: 0.44626855850219727, gen p mean: -0.05451485142111778, mean p set: 0.44674885272979736
loss_pred:0.016439197584986687, decouple_loss:0.0010238763643428683
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44419872760772705, gen p mean: -0.05567071959376335, mean p set: 0.44467902183532715
The modified gen p mean: 0.4476396441459656, gen p mean: -0.05356138199567795, mean p set: 0.4481199383735657
loss_pred:0.01705331727862358, decouple_loss:0.0010149094741791487
loss_pred:0.016533127054572105, decouple_loss:0.0010491205612197518
The modified gen p mean: 0.44540050625801086, gen p mean: -0.05555243417620659, mean p set: 0.44588083028793335
loss_pred:0.01647900603711605, decouple_loss:0.0009715373744256794
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483136534690857, gen p mean: -0.058051664382219315, mean p set: 0.4487939476966858
loss_pred:0.01702418178319931, decouple_loss:0.000972183421254158
The modified gen p mean: 0.44514530897140503, gen p mean: -0.05891863629221916, mean p set: 0.4456256330013275The modified gen p mean: 0.44583219289779663, gen p mean: -0.05583837628364563, mean p set: 0.4463125169277191
loss_pred:0.016961555927991867, decouple_loss:0.000952518021222204
loss_pred:0.016772614791989326, decouple_loss:0.000998021219857037
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679737091064453, gen p mean: -0.058192163705825806, mean p set: 0.447277694940567
loss_pred:0.017125077545642853, decouple_loss:0.0009355511283501983
The modified gen p mean: 0.44767454266548157, gen p mean: -0.05804819241166115, mean p set: 0.44815483689308167The modified gen p mean: 0.44580167531967163, gen p mean: -0.05468231067061424, mean p set: 0.44628193974494934
loss_pred:0.016879083588719368, decouple_loss:0.0009511735988780856
loss_pred:0.016362838447093964, decouple_loss:0.0010195545619353652
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44594669342041016, gen p mean: -0.06676771491765976, mean p set: 0.44642698764801025
loss_pred:0.016383055597543716, decouple_loss:0.0009455058607272804
The modified gen p mean: 0.4481664299964905, gen p mean: -0.06343653798103333, mean p set: 0.4486467242240906The modified gen p mean: 0.44864144921302795, gen p mean: -0.06202705577015877, mean p set: 0.44912174344062805
loss_pred:0.016715528443455696, decouple_loss:0.001084470422938466
loss_pred:0.016749301925301552, decouple_loss:0.001101633650250733
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448137491941452, gen p mean: -0.05516279488801956, mean p set: 0.4486178159713745
The modified gen p mean: 0.44763484597206116, gen p mean: -0.05751894786953926, mean p set: 0.44811511039733887
loss_pred:0.01742478646337986, decouple_loss:0.0010056059109047055
loss_pred:0.01737053506076336, decouple_loss:0.0009142825729213655
The modified gen p mean: 0.4471827447414398, gen p mean: -0.0594344437122345, mean p set: 0.4476630687713623
loss_pred:0.016441641375422478, decouple_loss:0.0009688747231848538
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468501806259155, gen p mean: -0.05956802889704704, mean p set: 0.4473304748535156
The modified gen p mean: 0.44722214341163635, gen p mean: -0.05932796746492386, mean p set: 0.44770243763923645
loss_pred:0.016550149768590927, decouple_loss:0.0010068487608805299
loss_pred:0.016985276713967323, decouple_loss:0.0010051459539681673
The modified gen p mean: 0.4452667832374573, gen p mean: -0.06364253163337708, mean p set: 0.4457470774650574
loss_pred:0.016140133142471313, decouple_loss:0.0009145207586698234
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473021924495697, gen p mean: -0.054837122559547424, mean p set: 0.4477825164794922
loss_pred:0.016624050214886665, decouple_loss:0.0009671208681538701
The modified gen p mean: 0.44610947370529175, gen p mean: -0.057415757328271866, mean p set: 0.44658976793289185The modified gen p mean: 0.4499937891960144, gen p mean: -0.059605780988931656, mean p set: 0.4504740536212921
loss_pred:0.015817362815141678, decouple_loss:0.000937481177970767
loss_pred:0.016275228932499886, decouple_loss:0.0010097749764099717
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479103982448578, gen p mean: -0.05572846531867981, mean p set: 0.4483906924724579
loss_pred:0.01699579693377018, decouple_loss:0.0009439160348847508
The modified gen p mean: 0.44587594270706177, gen p mean: -0.054312560707330704, mean p set: 0.44635626673698425The modified gen p mean: 0.44670698046684265, gen p mean: -0.0673038512468338, mean p set: 0.44718730449676514
loss_pred:0.016126707196235657, decouple_loss:0.0009649915737099946
loss_pred:0.016316261142492294, decouple_loss:0.0009606233215890825
2023-05-01 17:51:38 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05715802311897278, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05362273007631302, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05319444462656975, mean p set: 0.45035696029663086
loss_pred:0.018367495387792587, decouple_loss:0.0010809565428644419
loss_pred:0.017318177968263626, decouple_loss:0.0010628956370055676
loss_pred:0.017260245978832245, decouple_loss:0.0010689226910471916
WV_0_PC_1_EH_0_PS_40, loss: 0.017702186480164528, avg_mse: 0.0254215020686388
current test mse: 0.025422
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449760377407074, gen p mean: -0.05394969880580902, mean p set: 0.4502406716346741
loss_pred:0.016069497913122177, decouple_loss:0.0010876769665628672
The modified gen p mean: 0.4481680393218994, gen p mean: -0.05651369318366051, mean p set: 0.4486483037471771The modified gen p mean: 0.44793251156806946, gen p mean: -0.05237039923667908, mean p set: 0.44841283559799194
loss_pred:0.017377018928527832, decouple_loss:0.0010231004562228918
loss_pred:0.016868775710463524, decouple_loss:0.0010753903770819306
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480220079421997, gen p mean: -0.05426442623138428, mean p set: 0.4485023021697998The modified gen p mean: 0.44853469729423523, gen p mean: -0.05067170783877373, mean p set: 0.4490150213241577
loss_pred:0.016888482496142387, decouple_loss:0.000955591443926096
loss_pred:0.0174623504281044, decouple_loss:0.0011314116418361664
The modified gen p mean: 0.4444916844367981, gen p mean: -0.05651929974555969, mean p set: 0.4449720084667206
loss_pred:0.016824986785650253, decouple_loss:0.0009494959376752377
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465605318546295, gen p mean: -0.049992311745882034, mean p set: 0.4470408260822296
The modified gen p mean: 0.448622465133667, gen p mean: -0.05222597345709801, mean p set: 0.4491027295589447
loss_pred:0.01623118482530117, decouple_loss:0.0010146561544388533
loss_pred:0.01675872877240181, decouple_loss:0.0009362266282550991
The modified gen p mean: 0.44529518485069275, gen p mean: -0.05470864474773407, mean p set: 0.44577544927597046
loss_pred:0.016097594052553177, decouple_loss:0.0009592765709385276
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476720690727234, gen p mean: -0.050570785999298096, mean p set: 0.4481523334980011
The modified gen p mean: 0.4492434859275818, gen p mean: -0.054071057587862015, mean p set: 0.4497237801551819
loss_pred:0.01671171933412552, decouple_loss:0.0009827842004597187
The modified gen p mean: 0.4495728313922882, gen p mean: -0.05816368758678436, mean p set: 0.4500530958175659
loss_pred:0.01647822931408882, decouple_loss:0.0009397772373631597
loss_pred:0.015176776796579361, decouple_loss:0.000994918285869062
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909387826919556, gen p mean: -0.05770254135131836, mean p set: 0.44957417249679565
The modified gen p mean: 0.4457978904247284, gen p mean: -0.05290728434920311, mean p set: 0.4462781846523285
loss_pred:0.0153126185759902, decouple_loss:0.000949316076003015
loss_pred:0.01675848290324211, decouple_loss:0.0009491994860582054
The modified gen p mean: 0.44702309370040894, gen p mean: -0.053417570888996124, mean p set: 0.44750338792800903
loss_pred:0.01627473719418049, decouple_loss:0.0009424937306903303
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447294682264328, gen p mean: -0.05591064691543579, mean p set: 0.4477749764919281
The modified gen p mean: 0.4474874436855316, gen p mean: -0.05293586105108261, mean p set: 0.4479677379131317
loss_pred:0.01721099019050598, decouple_loss:0.0010337353451177478
loss_pred:0.01724550686776638, decouple_loss:0.0010335056576877832
The modified gen p mean: 0.4464915096759796, gen p mean: -0.05409618839621544, mean p set: 0.4469718039035797
loss_pred:0.016302986070513725, decouple_loss:0.001053628046065569
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.444752037525177, gen p mean: -0.060520440340042114, mean p set: 0.4452323615550995
The modified gen p mean: 0.4467149078845978, gen p mean: -0.05623583495616913, mean p set: 0.4471952021121979loss_pred:0.016011465340852737, decouple_loss:0.0009076657588593662
The modified gen p mean: 0.44663774967193604, gen p mean: -0.0643325001001358, mean p set: 0.44711804389953613
loss_pred:0.016039414331316948, decouple_loss:0.000886055117007345
loss_pred:0.016345607116818428, decouple_loss:0.0009281850652769208
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445483535528183, gen p mean: -0.06393100321292877, mean p set: 0.4459638297557831
The modified gen p mean: 0.448302686214447, gen p mean: -0.06229817494750023, mean p set: 0.4487829804420471
loss_pred:0.016533253714442253, decouple_loss:0.0011296083685010672
loss_pred:0.01620030775666237, decouple_loss:0.0010932596633210778
The modified gen p mean: 0.4492722451686859, gen p mean: -0.06267993897199631, mean p set: 0.449752539396286
loss_pred:0.015899643301963806, decouple_loss:0.0011466320138424635
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
NaN value num: 0
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500060975551605, gen p mean: -0.053508415818214417, mean p set: 0.4504863917827606
loss_pred:0.01695515587925911, decouple_loss:0.0010775288101285696
The modified gen p mean: 0.4491664469242096, gen p mean: -0.04996071383357048, mean p set: 0.4496467411518097The modified gen p mean: 0.4508325159549713, gen p mean: -0.04956958815455437, mean p set: 0.4513128101825714
loss_pred:0.01738603785634041, decouple_loss:0.0010705165332183242
loss_pred:0.016467036679387093, decouple_loss:0.0010732942027971148
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498096704483032, gen p mean: -0.04668020084500313, mean p set: 0.45028993487358093
The modified gen p mean: 0.4508225917816162, gen p mean: -0.05244927108287811, mean p set: 0.4513028562068939
loss_pred:0.01650678552687168, decouple_loss:0.000993307214230299
loss_pred:0.0163788590580225, decouple_loss:0.0009598643518984318
The modified gen p mean: 0.4506491422653198, gen p mean: -0.05105654150247574, mean p set: 0.4511294364929199
loss_pred:0.017033128067851067, decouple_loss:0.0010672276839613914
2023-05-01 17:54:05 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05889633297920227, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05531391128897667, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05460582673549652, mean p set: 0.45035696029663086
loss_pred:0.01832609437406063, decouple_loss:0.0012220341013744473
loss_pred:0.017340317368507385, decouple_loss:0.0011847637360915542
loss_pred:0.017215512692928314, decouple_loss:0.001193671952933073
WV_0_PC_1_EH_0_PS_40, loss: 0.017687316983938217, avg_mse: 0.025363899767398834
current test mse: 0.025364
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503765404224396, gen p mean: -0.0452348068356514, mean p set: 0.4508568048477173
loss_pred:0.016600584611296654, decouple_loss:0.001082520466297865
The modified gen p mean: 0.44994717836380005, gen p mean: -0.048026084899902344, mean p set: 0.45042750239372253The modified gen p mean: 0.45088908076286316, gen p mean: -0.05188081040978432, mean p set: 0.45136934518814087
loss_pred:0.016419023275375366, decouple_loss:0.0011116680689156055
loss_pred:0.016820546239614487, decouple_loss:0.0010306197218596935
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45033180713653564, gen p mean: -0.04702119901776314, mean p set: 0.45081210136413574
The modified gen p mean: 0.45051419734954834, gen p mean: -0.04657982289791107, mean p set: 0.4509945213794708
loss_pred:0.01613147184252739, decouple_loss:0.0010905616218224168
loss_pred:0.016075918450951576, decouple_loss:0.0010592396138235927
The modified gen p mean: 0.450418084859848, gen p mean: -0.04540953040122986, mean p set: 0.4508983790874481
loss_pred:0.016304994001984596, decouple_loss:0.0010652326745912433
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932761788368225, gen p mean: -0.042342573404312134, mean p set: 0.44980788230895996
loss_pred:0.016707587987184525, decouple_loss:0.0010492211440578103
The modified gen p mean: 0.44989699125289917, gen p mean: -0.04080803319811821, mean p set: 0.45037728548049927The modified gen p mean: 0.4498754143714905, gen p mean: -0.047744330018758774, mean p set: 0.4503557085990906
loss_pred:0.01607639715075493, decouple_loss:0.0010470491833984852
loss_pred:0.017304833978414536, decouple_loss:0.001110945944674313
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507041871547699, gen p mean: -0.05107409879565239, mean p set: 0.4511845111846924
The modified gen p mean: 0.45097866654396057, gen p mean: -0.044990912079811096, mean p set: 0.45145899057388306
loss_pred:0.015675339847803116, decouple_loss:0.0010179916862398386
loss_pred:0.017218269407749176, decouple_loss:0.0010636805091053247
The modified gen p mean: 0.45042118430137634, gen p mean: -0.04263903573155403, mean p set: 0.45090147852897644
loss_pred:0.017047127708792686, decouple_loss:0.0010038031032308936
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505537748336792, gen p mean: -0.044072479009628296, mean p set: 0.4510340988636017
The modified gen p mean: 0.44932082295417786, gen p mean: -0.04433844983577728, mean p set: 0.44980117678642273
loss_pred:0.016394272446632385, decouple_loss:0.001043003867380321
loss_pred:0.016332855448126793, decouple_loss:0.0010310399811714888
The modified gen p mean: 0.4500775933265686, gen p mean: -0.04694685339927673, mean p set: 0.4505578577518463
loss_pred:0.016152776777744293, decouple_loss:0.0010536080226302147
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502016305923462, gen p mean: -0.04880877211689949, mean p set: 0.4506819546222687
The modified gen p mean: 0.4498710632324219, gen p mean: -0.04477280005812645, mean p set: 0.450351357460022
loss_pred:0.01571662165224552, decouple_loss:0.0010901924688369036
loss_pred:0.016417769715189934, decouple_loss:0.0009530390962027013
The modified gen p mean: 0.45182010531425476, gen p mean: -0.044702645391225815, mean p set: 0.45230039954185486
loss_pred:0.016602151095867157, decouple_loss:0.0009013903909362853
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506174921989441, gen p mean: -0.05309082940220833, mean p set: 0.4510977864265442
The modified gen p mean: 0.4491346776485443, gen p mean: -0.0486602857708931, mean p set: 0.4496149718761444
loss_pred:0.015965888276696205, decouple_loss:0.0010285070165991783
loss_pred:0.016520047560334206, decouple_loss:0.0009354875655844808
The modified gen p mean: 0.4493100941181183, gen p mean: -0.04550075903534889, mean p set: 0.4497903883457184
loss_pred:0.01681818999350071, decouple_loss:0.0010614119237288833
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45079562067985535, gen p mean: -0.05135735496878624, mean p set: 0.45127591490745544
loss_pred:0.016889439895749092, decouple_loss:0.0009853083174675703
The modified gen p mean: 0.4497908651828766, gen p mean: -0.05122841149568558, mean p set: 0.4502711296081543The modified gen p mean: 0.4500710070133209, gen p mean: -0.05372060835361481, mean p set: 0.4505513310432434
loss_pred:0.015561382286250591, decouple_loss:0.0009648899431340396
loss_pred:0.015573319047689438, decouple_loss:0.0009314370690844953
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45057016611099243, gen p mean: -0.052839647978544235, mean p set: 0.45105046033859253
The modified gen p mean: 0.44938963651657104, gen p mean: -0.04928203299641609, mean p set: 0.44986993074417114
loss_pred:0.017406916245818138, decouple_loss:0.0009550486574880779
loss_pred:0.016590077430009842, decouple_loss:0.0010505999671295285
The modified gen p mean: 0.450862318277359, gen p mean: -0.0466935932636261, mean p set: 0.4513426423072815
loss_pred:0.01695333793759346, decouple_loss:0.0010369163937866688
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982007145881653, gen p mean: -0.04756025969982147, mean p set: 0.4503003656864166
loss_pred:0.016520492732524872, decouple_loss:0.00098382867872715
The modified gen p mean: 0.45032617449760437, gen p mean: -0.05248198285698891, mean p set: 0.45080649852752686
The modified gen p mean: 0.45001962780952454, gen p mean: -0.05017399787902832, mean p set: 0.45049992203712463
loss_pred:0.016094272956252098, decouple_loss:0.0010159824742004275
loss_pred:0.015981219708919525, decouple_loss:0.0010369312949478626
2023-05-01 17:56:00 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.06125069037079811, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.057542216032743454, mean p set: 0.4500633478164673
The modified gen p mean: 0.4498766362667084, gen p mean: -0.056908588856458664, mean p set: 0.45035696029663086
loss_pred:0.018460972234606743, decouple_loss:0.0013555961195379496
loss_pred:0.017490029335021973, decouple_loss:0.001223079045303166
loss_pred:0.0173397958278656, decouple_loss:0.0012320701498538256
WV_0_PC_1_EH_0_PS_40, loss: 0.0178271122276783, avg_mse: 0.02562481351196766
current test mse: 0.025625
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497521221637726, gen p mean: -0.04972473531961441, mean p set: 0.4502323865890503
loss_pred:0.01647437922656536, decouple_loss:0.0010760331060737371
The modified gen p mean: 0.45054006576538086, gen p mean: -0.052000317722558975, mean p set: 0.45102033019065857The modified gen p mean: 0.45013561844825745, gen p mean: -0.04802516847848892, mean p set: 0.45061591267585754
loss_pred:0.015933625400066376, decouple_loss:0.0011695973807945848
loss_pred:0.016039986163377762, decouple_loss:0.001016045338474214
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45124098658561707, gen p mean: -0.05296355485916138, mean p set: 0.4517212510108948
loss_pred:0.016034699976444244, decouple_loss:0.00113887176848948
The modified gen p mean: 0.4488238990306854, gen p mean: -0.04815640300512314, mean p set: 0.44930416345596313The modified gen p mean: 0.44957202672958374, gen p mean: -0.05240749567747116, mean p set: 0.45005232095718384
loss_pred:0.016600513830780983, decouple_loss:0.0011511578923091292
loss_pred:0.016098493710160255, decouple_loss:0.0011393281165510416
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912439584732056, gen p mean: -0.050992101430892944, mean p set: 0.44960469007492065
loss_pred:0.0166303887963295, decouple_loss:0.0010844245553016663
The modified gen p mean: 0.4504280090332031, gen p mean: -0.04834562540054321, mean p set: 0.45090827345848083The modified gen p mean: 0.45076221227645874, gen p mean: -0.05571778491139412, mean p set: 0.4512425363063812
loss_pred:0.015531119890511036, decouple_loss:0.0011888178996741772
loss_pred:0.016621140763163567, decouple_loss:0.0010099948849529028
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497341811656952, gen p mean: -0.048744168132543564, mean p set: 0.4502144455909729
loss_pred:0.016323350369930267, decouple_loss:0.0010690543567761779
The modified gen p mean: 0.45081645250320435, gen p mean: -0.052354469895362854, mean p set: 0.45129671692848206The modified gen p mean: 0.4482330083847046, gen p mean: -0.048999495804309845, mean p set: 0.4487132728099823
loss_pred:0.015818389132618904, decouple_loss:0.0011426068376749754
loss_pred:0.01642220839858055, decouple_loss:0.0011056670919060707
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490700662136078, gen p mean: -0.052985839545726776, mean p set: 0.4495503306388855
loss_pred:0.015907002612948418, decouple_loss:0.0010832141852006316
The modified gen p mean: 0.4505615234375, gen p mean: -0.05191705375909805, mean p set: 0.4510418474674225The modified gen p mean: 0.4509621262550354, gen p mean: -0.05489153042435646, mean p set: 0.4514424204826355
loss_pred:0.01622707210481167, decouple_loss:0.0010374661069363356
loss_pred:0.015121161937713623, decouple_loss:0.0010511872824281454
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072463154792786, gen p mean: -0.05040348321199417, mean p set: 0.45120492577552795
loss_pred:0.01696903631091118, decouple_loss:0.0009559340542182326
The modified gen p mean: 0.4488142728805542, gen p mean: -0.05204513669013977, mean p set: 0.4492945969104767The modified gen p mean: 0.45065775513648987, gen p mean: -0.054694559425115585, mean p set: 0.45113804936408997
loss_pred:0.016353948041796684, decouple_loss:0.0009467574418522418
loss_pred:0.015985757112503052, decouple_loss:0.0010296578984707594
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507591426372528, gen p mean: -0.05253875255584717, mean p set: 0.4512394070625305
loss_pred:0.01688709668815136, decouple_loss:0.0012086243368685246
The modified gen p mean: 0.44986680150032043, gen p mean: -0.05153480917215347, mean p set: 0.45034709572792053The modified gen p mean: 0.44991549849510193, gen p mean: -0.05223257839679718, mean p set: 0.450395792722702
loss_pred:0.01665341854095459, decouple_loss:0.0012424889719113708
loss_pred:0.016539862379431725, decouple_loss:0.0010804503690451384
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
NaN value num: 0
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45218250155448914, gen p mean: -0.05896613746881485, mean p set: 0.45266276597976685
loss_pred:0.01691005751490593, decouple_loss:0.001071327249519527
The modified gen p mean: 0.45149409770965576, gen p mean: -0.058282412588596344, mean p set: 0.45197439193725586The modified gen p mean: 0.45516249537467957, gen p mean: -0.059083130210638046, mean p set: 0.45564278960227966
loss_pred:0.017141278833150864, decouple_loss:0.0011438085930421948
loss_pred:0.016623258590698242, decouple_loss:0.001148977898992598
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45182591676712036, gen p mean: -0.05776246264576912, mean p set: 0.45230618119239807
The modified gen p mean: 0.44948065280914307, gen p mean: -0.05456927791237831, mean p set: 0.44996097683906555
loss_pred:0.018007826060056686, decouple_loss:0.0011462768306955695
loss_pred:0.016954666003584862, decouple_loss:0.001145632122643292
The modified gen p mean: 0.45123252272605896, gen p mean: -0.05710926651954651, mean p set: 0.45171278715133667
loss_pred:0.017530351877212524, decouple_loss:0.0011276433942839503
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45176780223846436, gen p mean: -0.05572034418582916, mean p set: 0.45224812626838684
The modified gen p mean: 0.45046982169151306, gen p mean: -0.042710017412900925, mean p set: 0.45095011591911316
loss_pred:0.01622118055820465, decouple_loss:0.001084132818505168
loss_pred:0.016748856753110886, decouple_loss:0.0011200481094419956
The modified gen p mean: 0.4500962197780609, gen p mean: -0.054714348167181015, mean p set: 0.450576514005661
loss_pred:0.016510214656591415, decouple_loss:0.0010683638975024223
2023-05-01 17:58:31 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.0560198538005352, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830237865448, gen p mean: -0.05171801522374153, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.051081351935863495, mean p set: 0.45035696029663086
loss_pred:0.018380550667643547, decouple_loss:0.0011904818238690495
loss_pred:0.017429230734705925, decouple_loss:0.0011893266346305609
loss_pred:0.017329290509223938, decouple_loss:0.0012242664815858006
WV_0_PC_1_EH_0_PS_40, loss: 0.017773091793060303, avg_mse: 0.02550329454243183
current test mse: 0.025503
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530189633369446, gen p mean: -0.04665172100067139, mean p set: 0.4534992575645447
The modified gen p mean: 0.45053309202194214, gen p mean: -0.04987405985593796, mean p set: 0.45101335644721985The modified gen p mean: 0.45131629705429077, gen p mean: -0.04572298005223274, mean p set: 0.45179659128189087
loss_pred:0.01715233363211155, decouple_loss:0.0011559227714315057
loss_pred:0.01733950525522232, decouple_loss:0.00114137411583215
loss_pred:0.017168326303362846, decouple_loss:0.0013497258769348264
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008569955825806, gen p mean: -0.043751850724220276, mean p set: 0.45056599378585815
The modified gen p mean: 0.4513186514377594, gen p mean: -0.04738539829850197, mean p set: 0.4517989158630371
loss_pred:0.018120912835001945, decouple_loss:0.001089316327124834
loss_pred:0.01714339852333069, decouple_loss:0.001040938077494502
The modified gen p mean: 0.45001882314682007, gen p mean: -0.053390804678201675, mean p set: 0.45049911737442017
loss_pred:0.016821039840579033, decouple_loss:0.0012630061246454716
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065465569496155, gen p mean: -0.04777151718735695, mean p set: 0.45113492012023926
The modified gen p mean: 0.4523911774158478, gen p mean: -0.04811503365635872, mean p set: 0.4528714418411255
loss_pred:0.01738274097442627, decouple_loss:0.001103295129723847
loss_pred:0.016473611816763878, decouple_loss:0.001112349797040224
The modified gen p mean: 0.45251888036727905, gen p mean: -0.04974478855729103, mean p set: 0.45299920439720154
loss_pred:0.016894018277525902, decouple_loss:0.0011459268862381577
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497041702270508, gen p mean: -0.0456954725086689, mean p set: 0.4501844644546509
The modified gen p mean: 0.45170649886131287, gen p mean: -0.04096212983131409, mean p set: 0.4521867632865906
The modified gen p mean: 0.45146384835243225, gen p mean: -0.046149495989084244, mean p set: 0.45194417238235474loss_pred:0.017632482573390007, decouple_loss:0.0011644865153357387
loss_pred:0.01678507961332798, decouple_loss:0.0010647793533280492
loss_pred:0.01688891276717186, decouple_loss:0.000993749825283885
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514771103858948, gen p mean: -0.05007753148674965, mean p set: 0.4519573748111725
The modified gen p mean: 0.44842663407325745, gen p mean: -0.04815152660012245, mean p set: 0.44890692830085754
loss_pred:0.01656152307987213, decouple_loss:0.0010307814227417111
loss_pred:0.017632942646741867, decouple_loss:0.001091232756152749
The modified gen p mean: 0.4517892897129059, gen p mean: -0.046879012137651443, mean p set: 0.452269583940506
loss_pred:0.016754301264882088, decouple_loss:0.0010339580476284027
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036688446998596, gen p mean: -0.04074304178357124, mean p set: 0.45084720849990845
loss_pred:0.016852451488375664, decouple_loss:0.000969457149039954
The modified gen p mean: 0.4509778320789337, gen p mean: -0.04392106831073761, mean p set: 0.4514580965042114The modified gen p mean: 0.449608713388443, gen p mean: -0.05103791505098343, mean p set: 0.4500890374183655
loss_pred:0.016644306480884552, decouple_loss:0.0009850433561950922
loss_pred:0.017422666773200035, decouple_loss:0.0009725381969474256
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515712857246399, gen p mean: -0.04419565200805664, mean p set: 0.4520516097545624
loss_pred:0.0162626001983881, decouple_loss:0.0010223498102277517
The modified gen p mean: 0.4503123462200165, gen p mean: -0.05031076818704605, mean p set: 0.45079267024993896The modified gen p mean: 0.451246976852417, gen p mean: -0.042917244136333466, mean p set: 0.4517273008823395
loss_pred:0.01676165498793125, decouple_loss:0.0010736874537542462
loss_pred:0.016530776396393776, decouple_loss:0.0009246955742128193
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534813165664673, gen p mean: -0.044811978936195374, mean p set: 0.4539616107940674
The modified gen p mean: 0.4516301155090332, gen p mean: -0.04259897768497467, mean p set: 0.4521104097366333
loss_pred:0.017698515206575394, decouple_loss:0.0010792758548632264
The modified gen p mean: 0.45048457384109497, gen p mean: -0.04503147676587105, mean p set: 0.45096486806869507
loss_pred:0.016412395983934402, decouple_loss:0.001046158722601831
loss_pred:0.017733503133058548, decouple_loss:0.0011109785409644246
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081081986427307, gen p mean: -0.04825321584939957, mean p set: 0.45129111409187317
loss_pred:0.017418576404452324, decouple_loss:0.0010453115683048964
The modified gen p mean: 0.4503884017467499, gen p mean: -0.04782715439796448, mean p set: 0.45086869597435The modified gen p mean: 0.451885849237442, gen p mean: -0.04991603642702103, mean p set: 0.4523661732673645
loss_pred:0.017559239640831947, decouple_loss:0.0010192657355219126
loss_pred:0.017144091427326202, decouple_loss:0.0010217505041509867
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508230984210968, gen p mean: -0.047970205545425415, mean p set: 0.4513033628463745
loss_pred:0.016927428543567657, decouple_loss:0.001002190401777625
The modified gen p mean: 0.44957560300827026, gen p mean: -0.051229506731033325, mean p set: 0.45005589723587036The modified gen p mean: 0.4511910676956177, gen p mean: -0.0492134653031826, mean p set: 0.4516713619232178
loss_pred:0.017104627564549446, decouple_loss:0.0009805192239582539
loss_pred:0.016779853031039238, decouple_loss:0.0010463889921084046
2023-05-01 18:00:27 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05587947368621826, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.0518966019153595, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05124182254076004, mean p set: 0.45035696029663086
loss_pred:0.018317552283406258, decouple_loss:0.0011104956502094865
loss_pred:0.01733388565480709, decouple_loss:0.0010849502868950367loss_pred:0.017250381410121918, decouple_loss:0.0011004703119397163
WV_0_PC_1_EH_0_PS_40, loss: 0.017688874155282974, avg_mse: 0.02537808194756508
current test mse: 0.025378
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45101702213287354, gen p mean: -0.04724555090069771, mean p set: 0.45149728655815125The modified gen p mean: 0.45196688175201416, gen p mean: -0.05473336949944496, mean p set: 0.45244714617729187
loss_pred:0.018131962046027184, decouple_loss:0.0009970958344638348
The modified gen p mean: 0.4502141773700714, gen p mean: -0.051841527223587036, mean p set: 0.4506944417953491
loss_pred:0.0167545098811388, decouple_loss:0.0010067586554214358
loss_pred:0.016739556565880775, decouple_loss:0.0009823503205552697
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939470291137695, gen p mean: -0.05370042100548744, mean p set: 0.44987502694129944
The modified gen p mean: 0.4501040279865265, gen p mean: -0.044752560555934906, mean p set: 0.4505843222141266
loss_pred:0.01726534031331539, decouple_loss:0.0011352483415976167
loss_pred:0.01789616234600544, decouple_loss:0.0010632681660354137The modified gen p mean: 0.4518056809902191, gen p mean: -0.04783613607287407, mean p set: 0.4522860050201416
loss_pred:0.016559908166527748, decouple_loss:0.0010294028325006366
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988036155700684, gen p mean: -0.04946165159344673, mean p set: 0.4503606855869293
loss_pred:0.017851844429969788, decouple_loss:0.0010749594075605273
The modified gen p mean: 0.45125308632850647, gen p mean: -0.05055428296327591, mean p set: 0.45173338055610657The modified gen p mean: 0.4545752704143524, gen p mean: -0.05259189382195473, mean p set: 0.4550555646419525
loss_pred:0.017131809145212173, decouple_loss:0.00111921108327806
loss_pred:0.016152549535036087, decouple_loss:0.0011272237170487642
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45007914304733276, gen p mean: -0.0559469535946846, mean p set: 0.4505594074726105
loss_pred:0.016378268599510193, decouple_loss:0.0011178737040609121
The modified gen p mean: 0.45173612236976624, gen p mean: -0.05264703929424286, mean p set: 0.45221641659736633The modified gen p mean: 0.4534832239151001, gen p mean: -0.04987045004963875, mean p set: 0.4539635181427002
loss_pred:0.016793392598628998, decouple_loss:0.0010767087806016207
loss_pred:0.016727615147829056, decouple_loss:0.0010601106332615018
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494204521179199, gen p mean: -0.04900490492582321, mean p set: 0.44990074634552
loss_pred:0.017089733853936195, decouple_loss:0.0010465949308127165
The modified gen p mean: 0.45197051763534546, gen p mean: -0.04414151608943939, mean p set: 0.45245081186294556The modified gen p mean: 0.448466032743454, gen p mean: -0.04891769215464592, mean p set: 0.4489463269710541
loss_pred:0.016834363341331482, decouple_loss:0.0010389096569269896
loss_pred:0.016809960827231407, decouple_loss:0.0010809508385136724
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531993865966797, gen p mean: -0.04814664274454117, mean p set: 0.4536796808242798
The modified gen p mean: 0.4516116976737976, gen p mean: -0.047362346202135086, mean p set: 0.4520919919013977
loss_pred:0.016705483198165894, decouple_loss:0.0009726024582050741
loss_pred:0.01653469353914261, decouple_loss:0.0009717863867990673
The modified gen p mean: 0.45285338163375854, gen p mean: -0.04193559288978577, mean p set: 0.45333370566368103
loss_pred:0.01659424416720867, decouple_loss:0.001010234816931188
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45448148250579834, gen p mean: -0.045551132410764694, mean p set: 0.45496177673339844
The modified gen p mean: 0.4517209827899933, gen p mean: -0.04008045792579651, mean p set: 0.452201247215271
loss_pred:0.016574136912822723, decouple_loss:0.0010651559568941593
loss_pred:0.017224596813321114, decouple_loss:0.0009588519460521638
The modified gen p mean: 0.4499392807483673, gen p mean: -0.03505585715174675, mean p set: 0.450419545173645
loss_pred:0.017865873873233795, decouple_loss:0.0009690385195426643
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
NaN value num: 0
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481632709503174, gen p mean: -0.03502864018082619, mean p set: 0.4486435651779175
loss_pred:0.015892647206783295, decouple_loss:0.0010089944116771221
The modified gen p mean: 0.44781580567359924, gen p mean: -0.03833566606044769, mean p set: 0.44829609990119934The modified gen p mean: 0.4489538371562958, gen p mean: -0.03794465586543083, mean p set: 0.44943416118621826
loss_pred:0.01666582189500332, decouple_loss:0.001060518785379827
loss_pred:0.015888258814811707, decouple_loss:0.0010682748397812247
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497719407081604, gen p mean: -0.03321787714958191, mean p set: 0.4502522349357605
loss_pred:0.015908347442746162, decouple_loss:0.0010839527240023017
The modified gen p mean: 0.4473547637462616, gen p mean: -0.03823510929942131, mean p set: 0.4478350281715393The modified gen p mean: 0.45113056898117065, gen p mean: -0.03367213159799576, mean p set: 0.45161086320877075
loss_pred:0.01664593629539013, decouple_loss:0.001083696843124926
loss_pred:0.01653232052922249, decouple_loss:0.0010143719846382737
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504087269306183, gen p mean: -0.03984709456562996, mean p set: 0.450888991355896The modified gen p mean: 0.44781234860420227, gen p mean: -0.04192488268017769, mean p set: 0.44829264283180237
loss_pred:0.016288908198475838, decouple_loss:0.0010738210985437036
loss_pred:0.0164162777364254, decouple_loss:0.001013947301544249
The modified gen p mean: 0.44892337918281555, gen p mean: -0.030508751049637794, mean p set: 0.44940370321273804
loss_pred:0.01671248860657215, decouple_loss:0.001062656519934535
2023-05-01 18:03:01 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.052096422761678696, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04823010414838791, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.047574613243341446, mean p set: 0.45035696029663086
loss_pred:0.018323613330721855, decouple_loss:0.0011467983713373542
loss_pred:0.017314881086349487, decouple_loss:0.0011704509379342198
loss_pred:0.017211679369211197, decouple_loss:0.0011843967949971557
WV_0_PC_1_EH_0_PS_40, loss: 0.017675084993243217, avg_mse: 0.025342999026179314
current test mse: 0.025343
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44994351267814636, gen p mean: -0.040813542902469635, mean p set: 0.4504237771034241
The modified gen p mean: 0.4495418071746826, gen p mean: -0.037669166922569275, mean p set: 0.4500221312046051
loss_pred:0.016448862850666046, decouple_loss:0.001027465332299471
The modified gen p mean: 0.4482405185699463, gen p mean: -0.041824061423540115, mean p set: 0.4487208127975464
loss_pred:0.015740547329187393, decouple_loss:0.0010355358244851232
loss_pred:0.015988953411579132, decouple_loss:0.0011700551258400083
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44993776082992554, gen p mean: -0.050904348492622375, mean p set: 0.45041805505752563
The modified gen p mean: 0.44846534729003906, gen p mean: -0.04762878641486168, mean p set: 0.4489456117153168
loss_pred:0.016169145703315735, decouple_loss:0.001002760836854577
loss_pred:0.016111690551042557, decouple_loss:0.0009581320337019861
The modified gen p mean: 0.4486335217952728, gen p mean: -0.04813891276717186, mean p set: 0.4491138160228729
loss_pred:0.016740946099162102, decouple_loss:0.0009824642911553383
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503285884857178, gen p mean: -0.057448677718639374, mean p set: 0.45080891251564026
The modified gen p mean: 0.44856590032577515, gen p mean: -0.049310389906167984, mean p set: 0.44904619455337524
loss_pred:0.016978001222014427, decouple_loss:0.0012531970860436559
loss_pred:0.017170840874314308, decouple_loss:0.0010716768447309732
The modified gen p mean: 0.448962539434433, gen p mean: -0.05045338347554207, mean p set: 0.4494428038597107
loss_pred:0.016576236113905907, decouple_loss:0.0010623144917190075
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495643079280853, gen p mean: -0.05553852394223213, mean p set: 0.4500446021556854
The modified gen p mean: 0.45023971796035767, gen p mean: -0.05347895994782448, mean p set: 0.45072001218795776
The modified gen p mean: 0.45154479146003723, gen p mean: -0.05604800954461098, mean p set: 0.45202508568763733
loss_pred:0.0165896974503994, decouple_loss:0.0010810296516865492
loss_pred:0.01805395819246769, decouple_loss:0.0010519279167056084
loss_pred:0.016686733812093735, decouple_loss:0.0010805415222421288
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510965049266815, gen p mean: -0.05342373251914978, mean p set: 0.4515767991542816
The modified gen p mean: 0.4514255225658417, gen p mean: -0.0602911002933979, mean p set: 0.4519057869911194
loss_pred:0.015617766417562962, decouple_loss:0.0011846612906083465
loss_pred:0.017511926591396332, decouple_loss:0.001103479415178299
The modified gen p mean: 0.4521694481372833, gen p mean: -0.051481619477272034, mean p set: 0.4526497423648834
loss_pred:0.016131168231368065, decouple_loss:0.0011852332390844822
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506310820579529, gen p mean: -0.05312298610806465, mean p set: 0.451111376285553
loss_pred:0.01581464149057865, decouple_loss:0.0010120156221091747
The modified gen p mean: 0.44788646697998047, gen p mean: -0.05428771674633026, mean p set: 0.4483667314052582The modified gen p mean: 0.45043063163757324, gen p mean: -0.054396357387304306, mean p set: 0.45091089606285095
loss_pred:0.016771595925092697, decouple_loss:0.0010530489962548018
loss_pred:0.015991169959306717, decouple_loss:0.0010567037388682365
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947919249534607, gen p mean: -0.05863070487976074, mean p set: 0.4499594569206238
The modified gen p mean: 0.4473794400691986, gen p mean: -0.05950423702597618, mean p set: 0.4478597342967987
loss_pred:0.016057968139648438, decouple_loss:0.0012357031228020787
loss_pred:0.016537277027964592, decouple_loss:0.0011716213775798678
The modified gen p mean: 0.44963958859443665, gen p mean: -0.0589294396340847, mean p set: 0.45011985301971436
loss_pred:0.01575865037739277, decouple_loss:0.0012230746215209365
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508521556854248, gen p mean: -0.0569717139005661, mean p set: 0.4513324499130249
loss_pred:0.015943236649036407, decouple_loss:0.001099982182495296
The modified gen p mean: 0.4502425789833069, gen p mean: -0.05594322457909584, mean p set: 0.4507228434085846The modified gen p mean: 0.4495052695274353, gen p mean: -0.052067145705223083, mean p set: 0.4499855935573578
loss_pred:0.01613689959049225, decouple_loss:0.001095415442250669
loss_pred:0.015856953337788582, decouple_loss:0.0010064468951895833
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477938711643219, gen p mean: -0.0538850836455822, mean p set: 0.4482741951942444
The modified gen p mean: 0.44972679018974304, gen p mean: -0.050027333199977875, mean p set: 0.45020708441734314
loss_pred:0.016425231471657753, decouple_loss:0.001166506321169436
loss_pred:0.016913050785660744, decouple_loss:0.001109758042730391
The modified gen p mean: 0.45106568932533264, gen p mean: -0.052484896034002304, mean p set: 0.45154598355293274
loss_pred:0.01610039733350277, decouple_loss:0.0011824548710137606
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764041900634766, gen p mean: -0.05245005711913109, mean p set: 0.44812071323394775
The modified gen p mean: 0.4487953186035156, gen p mean: -0.04591377452015877, mean p set: 0.4492756426334381
loss_pred:0.016727576032280922, decouple_loss:0.0010499715572223067
loss_pred:0.01735558919608593, decouple_loss:0.0010798523435369134
The modified gen p mean: 0.45027220249176025, gen p mean: -0.049083415418863297, mean p set: 0.45075252652168274
loss_pred:0.01649140939116478, decouple_loss:0.0011193501995876431
2023-05-01 18:04:57 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.058007609099149704, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05420274659991264, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.05397994816303253, mean p set: 0.45035696029663086
loss_pred:0.018419204279780388, decouple_loss:0.0014234046684578061
loss_pred:0.017331458628177643, decouple_loss:0.0012649809941649437
loss_pred:0.017230957746505737, decouple_loss:0.0012421895517036319
WV_0_PC_1_EH_0_PS_40, loss: 0.017726048827171326, avg_mse: 0.02540464699268341
current test mse: 0.025405
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45083239674568176, gen p mean: -0.04539884626865387, mean p set: 0.45131269097328186
The modified gen p mean: 0.44983917474746704, gen p mean: -0.052604496479034424, mean p set: 0.45031946897506714
loss_pred:0.015396686270833015, decouple_loss:0.0011561033315956593
The modified gen p mean: 0.45031604170799255, gen p mean: -0.04728115350008011, mean p set: 0.45079630613327026
loss_pred:0.016435954719781876, decouple_loss:0.0013105223188176751
loss_pred:0.015954002737998962, decouple_loss:0.0011903997510671616
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174404978752136, gen p mean: -0.04299662262201309, mean p set: 0.45222434401512146
The modified gen p mean: 0.4491342306137085, gen p mean: -0.04271916672587395, mean p set: 0.4496145248413086
loss_pred:0.016125459223985672, decouple_loss:0.0011929187458008528
loss_pred:0.01697821356356144, decouple_loss:0.0011508589377626777
The modified gen p mean: 0.4511122703552246, gen p mean: -0.047352384775877, mean p set: 0.4515925347805023
loss_pred:0.015500470995903015, decouple_loss:0.0011281355982646346
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44889235496520996, gen p mean: -0.041021060198545456, mean p set: 0.44937264919281006
loss_pred:0.016880640760064125, decouple_loss:0.001070450758561492
The modified gen p mean: 0.44736045598983765, gen p mean: -0.04989209026098251, mean p set: 0.44784078001976013The modified gen p mean: 0.44784224033355713, gen p mean: -0.04735037311911583, mean p set: 0.4483225345611572
loss_pred:0.016759300604462624, decouple_loss:0.0010908721014857292
loss_pred:0.015988420695066452, decouple_loss:0.001103810267522931
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890737533569336, gen p mean: -0.043743737041950226, mean p set: 0.44938766956329346
The modified gen p mean: 0.44945549964904785, gen p mean: -0.050430942326784134, mean p set: 0.44993579387664795loss_pred:0.01580079458653927, decouple_loss:0.00117833586409688
The modified gen p mean: 0.44853904843330383, gen p mean: -0.04825637489557266, mean p set: 0.44901934266090393
loss_pred:0.015935439616441727, decouple_loss:0.0011865090345963836
loss_pred:0.01618032343685627, decouple_loss:0.0011413266183808446
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504573941230774, gen p mean: -0.0519988015294075, mean p set: 0.4509376883506775
The modified gen p mean: 0.4494793713092804, gen p mean: -0.04825957491993904, mean p set: 0.4499596655368805
loss_pred:0.015979314222931862, decouple_loss:0.0011033936170861125
loss_pred:0.01569833979010582, decouple_loss:0.0011516837403178215
The modified gen p mean: 0.45079007744789124, gen p mean: -0.050195373594760895, mean p set: 0.45127037167549133
loss_pred:0.01634092442691326, decouple_loss:0.0011072533670812845
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503253102302551, gen p mean: -0.04522915929555893, mean p set: 0.4508056342601776
loss_pred:0.015426642261445522, decouple_loss:0.0010496393078938127
The modified gen p mean: 0.44919106364250183, gen p mean: -0.047172874212265015, mean p set: 0.44967135787010193The modified gen p mean: 0.44900259375572205, gen p mean: -0.048276301473379135, mean p set: 0.44948288798332214
loss_pred:0.015514747239649296, decouple_loss:0.001021615695208311
loss_pred:0.01634851098060608, decouple_loss:0.0011319145560264587
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492426812648773, gen p mean: -0.05215531587600708, mean p set: 0.4497230052947998
The modified gen p mean: 0.44923338294029236, gen p mean: -0.0475032664835453, mean p set: 0.44971367716789246
loss_pred:0.015844976529479027, decouple_loss:0.001287383260205388
loss_pred:0.016980111598968506, decouple_loss:0.0011448371224105358
The modified gen p mean: 0.4504820704460144, gen p mean: -0.052494585514068604, mean p set: 0.4509623348712921
loss_pred:0.01695987582206726, decouple_loss:0.0011050015455111861
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
NaN value num: 0
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864317774772644, gen p mean: -0.05942855402827263, mean p set: 0.44912344217300415
loss_pred:0.013557052239775658, decouple_loss:0.0012357317609712481
The modified gen p mean: 0.44984617829322815, gen p mean: -0.055175505578517914, mean p set: 0.45032650232315063The modified gen p mean: 0.4492904543876648, gen p mean: -0.061984479427337646, mean p set: 0.4497707486152649
loss_pred:0.014598889276385307, decouple_loss:0.0011927366722375154
loss_pred:0.014750251546502113, decouple_loss:0.0012818138347938657
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488871693611145, gen p mean: -0.053027328103780746, mean p set: 0.4493674635887146
loss_pred:0.014962381683290005, decouple_loss:0.001149345887824893
The modified gen p mean: 0.44753149151802063, gen p mean: -0.058554697781801224, mean p set: 0.4480117857456207The modified gen p mean: 0.44885778427124023, gen p mean: -0.05987664684653282, mean p set: 0.44933804869651794
loss_pred:0.013749171048402786, decouple_loss:0.0010068024275824428
loss_pred:0.014554417692124844, decouple_loss:0.0011471678735688329
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482285976409912, gen p mean: -0.04942634701728821, mean p set: 0.4487088918685913
loss_pred:0.014165427535772324, decouple_loss:0.001360720139928162
The modified gen p mean: 0.4494490623474121, gen p mean: -0.05261342227458954, mean p set: 0.4499293565750122The modified gen p mean: 0.44853904843330383, gen p mean: -0.05292403697967529, mean p set: 0.44901934266090393
loss_pred:0.01487754937261343, decouple_loss:0.0014411394950002432
loss_pred:0.01442183367908001, decouple_loss:0.001386884949170053
2023-05-01 18:07:29 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.05018207058310509, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04663310945034027, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.0463370718061924, mean p set: 0.45035696029663086
loss_pred:0.018649239093065262, decouple_loss:0.0012730781454592943
loss_pred:0.017648467794060707, decouple_loss:0.001275830203667283
loss_pred:0.01752299629151821, decouple_loss:0.0012573632411658764
WV_0_PC_1_EH_0_PS_40, loss: 0.0180036723613739, avg_mse: 0.02597283571958542
current test mse: 0.025973
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782891869544983, gen p mean: -0.05067697912454605, mean p set: 0.4483092129230499
loss_pred:0.014007742516696453, decouple_loss:0.0012024444295093417
The modified gen p mean: 0.4478338658809662, gen p mean: -0.04828132316470146, mean p set: 0.4483141601085663The modified gen p mean: 0.44796222448349, gen p mean: -0.0522850826382637, mean p set: 0.4484424889087677
loss_pred:0.014422805048525333, decouple_loss:0.0012600126210600138
loss_pred:0.014398918487131596, decouple_loss:0.0012535089626908302
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447651207447052, gen p mean: -0.044867102056741714, mean p set: 0.4481314718723297
The modified gen p mean: 0.44869518280029297, gen p mean: -0.04381835088133812, mean p set: 0.44917547702789307
The modified gen p mean: 0.4477007985115051, gen p mean: -0.042406078428030014, mean p set: 0.4481810927391052loss_pred:0.014656707644462585, decouple_loss:0.001203745137900114
loss_pred:0.014360885135829449, decouple_loss:0.001250008586794138
loss_pred:0.014981595799326897, decouple_loss:0.0013635079376399517
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782161712646484, gen p mean: -0.043015796691179276, mean p set: 0.44830194115638733
The modified gen p mean: 0.44799745082855225, gen p mean: -0.0438990481197834, mean p set: 0.44847777485847473
loss_pred:0.013848946429789066, decouple_loss:0.0013577466597780585
loss_pred:0.01459832675755024, decouple_loss:0.0013814298436045647
The modified gen p mean: 0.4494127631187439, gen p mean: -0.03865531459450722, mean p set: 0.449893057346344
loss_pred:0.014053932391107082, decouple_loss:0.0013000480830669403
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495009481906891, gen p mean: -0.04203610122203827, mean p set: 0.4499812126159668
The modified gen p mean: 0.4488367736339569, gen p mean: -0.039245571941137314, mean p set: 0.449317067861557
loss_pred:0.013692276552319527, decouple_loss:0.001352087245322764
loss_pred:0.013530286028981209, decouple_loss:0.0013143906835466623
The modified gen p mean: 0.4490025043487549, gen p mean: -0.03376574441790581, mean p set: 0.449482798576355
loss_pred:0.014366216957569122, decouple_loss:0.0011955894296988845
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487735331058502, gen p mean: -0.0408233143389225, mean p set: 0.4492538273334503
The modified gen p mean: 0.44853323698043823, gen p mean: -0.04225414991378784, mean p set: 0.44901350140571594
The modified gen p mean: 0.4486500322818756, gen p mean: -0.03922517970204353, mean p set: 0.4491303265094757
loss_pred:0.013958010822534561, decouple_loss:0.0013951791916042566
loss_pred:0.013620157726109028, decouple_loss:0.0013388347579166293
loss_pred:0.013585585169494152, decouple_loss:0.001369786448776722
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788235425949097, gen p mean: -0.04505452141165733, mean p set: 0.44836267828941345The modified gen p mean: 0.44718945026397705, gen p mean: -0.04351417347788811, mean p set: 0.44766971468925476
loss_pred:0.01415554154664278, decouple_loss:0.0013016152661293745
loss_pred:0.014404023066163063, decouple_loss:0.0012674242025241256
The modified gen p mean: 0.44682610034942627, gen p mean: -0.04441055655479431, mean p set: 0.44730639457702637
loss_pred:0.013817432336509228, decouple_loss:0.00128486892208457
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725847244262695, gen p mean: -0.045727092772722244, mean p set: 0.44773876667022705
loss_pred:0.013866626657545567, decouple_loss:0.0014471582835540175
The modified gen p mean: 0.44788190722465515, gen p mean: -0.04824746400117874, mean p set: 0.44836223125457764The modified gen p mean: 0.448137491941452, gen p mean: -0.045298974961042404, mean p set: 0.4486178159713745
loss_pred:0.01368646789342165, decouple_loss:0.0013621317921206355
loss_pred:0.014035680331289768, decouple_loss:0.0014276058645918965
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762134552001953, gen p mean: -0.046990927308797836, mean p set: 0.44810163974761963
loss_pred:0.013722093775868416, decouple_loss:0.0013149979058653116
The modified gen p mean: 0.447274774312973, gen p mean: -0.04971864074468613, mean p set: 0.4477550983428955The modified gen p mean: 0.4483799636363983, gen p mean: -0.044901084154844284, mean p set: 0.4488602578639984
loss_pred:0.013909879140555859, decouple_loss:0.0014495598152279854
loss_pred:0.013705785386264324, decouple_loss:0.001356440014205873
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836118817329407, gen p mean: -0.04303305968642235, mean p set: 0.44884148240089417
loss_pred:0.013469556346535683, decouple_loss:0.0012204115046188235
The modified gen p mean: 0.4487232267856598, gen p mean: -0.04439166188240051, mean p set: 0.4492034912109375The modified gen p mean: 0.44885721802711487, gen p mean: -0.03855398669838905, mean p set: 0.44933751225471497
loss_pred:0.013933570124208927, decouple_loss:0.001189635251648724
loss_pred:0.014067615382373333, decouple_loss:0.0011726500233635306
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480817914009094, gen p mean: -0.03457654267549515, mean p set: 0.4485621154308319
loss_pred:0.013886240310966969, decouple_loss:0.0015017181867733598
The modified gen p mean: 0.44900354743003845, gen p mean: -0.04586620256304741, mean p set: 0.44948384165763855The modified gen p mean: 0.44741275906562805, gen p mean: -0.04406934604048729, mean p set: 0.44789305329322815
loss_pred:0.014090149663388729, decouple_loss:0.0012747100554406643
loss_pred:0.014266283251345158, decouple_loss:0.0013377713039517403
2023-05-01 18:09:25 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.0468631274998188, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830535888672, gen p mean: -0.04317674785852432, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.042809002101421356, mean p set: 0.45035696029663086
loss_pred:0.01905314065515995, decouple_loss:0.0014113212237134576
loss_pred:0.018073737621307373, decouple_loss:0.0012629427947103977
loss_pred:0.017968636006116867, decouple_loss:0.001210409915074706
WV_0_PC_1_EH_0_PS_40, loss: 0.018429916352033615, avg_mse: 0.026810843497514725
current test mse: 0.026811
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487558901309967, gen p mean: -0.03795741870999336, mean p set: 0.4492361843585968
loss_pred:0.013521402142941952, decouple_loss:0.0012446079635992646
The modified gen p mean: 0.44759809970855713, gen p mean: -0.046217337250709534, mean p set: 0.4480784237384796The modified gen p mean: 0.44941335916519165, gen p mean: -0.045380160212516785, mean p set: 0.449893593788147
loss_pred:0.013950284570455551, decouple_loss:0.0011868200963363051
loss_pred:0.013877375051379204, decouple_loss:0.0012271336745470762
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492121636867523, gen p mean: -0.04377441480755806, mean p set: 0.4496924579143524
loss_pred:0.013503196649253368, decouple_loss:0.001210253220051527
The modified gen p mean: 0.44714075326919556, gen p mean: -0.04748663678765297, mean p set: 0.44762104749679565The modified gen p mean: 0.4483802318572998, gen p mean: -0.03762197867035866, mean p set: 0.4488604962825775
loss_pred:0.013785536400973797, decouple_loss:0.0012827899772673845
loss_pred:0.013414927758276463, decouple_loss:0.001227309345267713
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497976005077362, gen p mean: -0.04501553252339363, mean p set: 0.4502778649330139
loss_pred:0.014176182448863983, decouple_loss:0.001405275077559054
The modified gen p mean: 0.44753068685531616, gen p mean: -0.044497549533843994, mean p set: 0.44801095128059387The modified gen p mean: 0.4486769139766693, gen p mean: -0.03610707446932793, mean p set: 0.4491572082042694
loss_pred:0.013431076891720295, decouple_loss:0.0011964293662458658
loss_pred:0.013665967620909214, decouple_loss:0.001291565247811377
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960033893585205, gen p mean: -0.03834939002990723, mean p set: 0.45008060336112976
loss_pred:0.013751611113548279, decouple_loss:0.001187443151138723
The modified gen p mean: 0.44822725653648376, gen p mean: -0.035706959664821625, mean p set: 0.44870755076408386The modified gen p mean: 0.44756242632865906, gen p mean: -0.034635450690984726, mean p set: 0.44804272055625916
loss_pred:0.013445902615785599, decouple_loss:0.0013080666540190578
loss_pred:0.013642595149576664, decouple_loss:0.001245696097612381
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861671328544617, gen p mean: -0.044005367904901505, mean p set: 0.44909700751304626
loss_pred:0.013342556543648243, decouple_loss:0.0011699340539053082
The modified gen p mean: 0.4480086863040924, gen p mean: -0.04764267057180405, mean p set: 0.4484889805316925The modified gen p mean: 0.44893890619277954, gen p mean: -0.04777074605226517, mean p set: 0.44941920042037964
loss_pred:0.013969718478620052, decouple_loss:0.0011714452411979437
loss_pred:0.013769607059657574, decouple_loss:0.001221859478391707
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493180811405182, gen p mean: -0.04982566088438034, mean p set: 0.4497983753681183
loss_pred:0.013573841191828251, decouple_loss:0.001331597100943327
The modified gen p mean: 0.44839510321617126, gen p mean: -0.0485202930867672, mean p set: 0.44887539744377136The modified gen p mean: 0.4481185972690582, gen p mean: -0.04482322931289673, mean p set: 0.4485989212989807
loss_pred:0.01316079217940569, decouple_loss:0.0012745785061269999
loss_pred:0.014291365630924702, decouple_loss:0.0013190715108066797
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489333927631378, gen p mean: -0.04534612223505974, mean p set: 0.4494136571884155
loss_pred:0.01285017840564251, decouple_loss:0.00115761358756572
The modified gen p mean: 0.44720131158828735, gen p mean: -0.04736790433526039, mean p set: 0.44768157601356506The modified gen p mean: 0.4484681785106659, gen p mean: -0.04882977157831192, mean p set: 0.448948472738266
loss_pred:0.013593900948762894, decouple_loss:0.0011501836124807596
loss_pred:0.013673260807991028, decouple_loss:0.001214348478242755
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
NaN value num: 0
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503459930419922, gen p mean: -0.043962933123111725, mean p set: 0.45082634687423706
loss_pred:0.015893789008259773, decouple_loss:0.0012422461295500398
The modified gen p mean: 0.4492671489715576, gen p mean: -0.039480216801166534, mean p set: 0.4497474730014801The modified gen p mean: 0.4500763416290283, gen p mean: -0.04429681599140167, mean p set: 0.4505566358566284
loss_pred:0.016320494934916496, decouple_loss:0.0012525208294391632
loss_pred:0.015865182504057884, decouple_loss:0.0013454245636239648
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854944944381714, gen p mean: -0.04389004781842232, mean p set: 0.44902974367141724
loss_pred:0.016157731413841248, decouple_loss:0.0013229628093540668
The modified gen p mean: 0.4493008553981781, gen p mean: -0.03996476158499718, mean p set: 0.4497811496257782The modified gen p mean: 0.4507077932357788, gen p mean: -0.03781575337052345, mean p set: 0.4511880874633789
loss_pred:0.016918092966079712, decouple_loss:0.0012764593120664358
loss_pred:0.016823958605527878, decouple_loss:0.0012521008029580116
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479730725288391, gen p mean: -0.04065713658928871, mean p set: 0.4484533667564392
loss_pred:0.01630553789436817, decouple_loss:0.0013451918493956327
The modified gen p mean: 0.45019569993019104, gen p mean: -0.04103023186326027, mean p set: 0.45067599415779114The modified gen p mean: 0.44900333881378174, gen p mean: -0.03551439568400383, mean p set: 0.44948363304138184
loss_pred:0.015529753640294075, decouple_loss:0.001341597642749548
loss_pred:0.015918556600809097, decouple_loss:0.0013386362697929144
2023-05-01 18:11:56 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.040516383945941925, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.03715071454644203, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.03703790530562401, mean p set: 0.45035696029663086
loss_pred:0.018611501902341843, decouple_loss:0.0013678777031600475
loss_pred:0.017638253048062325, decouple_loss:0.0014211958041414618
loss_pred:0.017533086240291595, decouple_loss:0.0013737850822508335
WV_0_PC_1_EH_0_PS_40, loss: 0.01799699477851391, avg_mse: 0.025967370718717575
current test mse: 0.025967
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904953241348267, gen p mean: -0.03382616862654686, mean p set: 0.44952985644340515
loss_pred:0.015900928527116776, decouple_loss:0.0011933482019230723
The modified gen p mean: 0.4480888843536377, gen p mean: -0.037097979336977005, mean p set: 0.4485691785812378The modified gen p mean: 0.4491945803165436, gen p mean: -0.04464420676231384, mean p set: 0.44967490434646606
loss_pred:0.015477406792342663, decouple_loss:0.0015067094936966896
loss_pred:0.01536930724978447, decouple_loss:0.0013381937751546502
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797056913375854, gen p mean: -0.034905772656202316, mean p set: 0.44845086336135864
loss_pred:0.016058610752224922, decouple_loss:0.0013970916625112295
The modified gen p mean: 0.4495692253112793, gen p mean: -0.03360215947031975, mean p set: 0.4500495493412018The modified gen p mean: 0.4496261179447174, gen p mean: -0.039295412600040436, mean p set: 0.4501064419746399
loss_pred:0.01552183274179697, decouple_loss:0.0015928769716992974
loss_pred:0.016300905495882034, decouple_loss:0.001340519986115396
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500833749771118, gen p mean: -0.034863319247961044, mean p set: 0.4505636692047119
loss_pred:0.015515434555709362, decouple_loss:0.001293483073823154
The modified gen p mean: 0.4482399821281433, gen p mean: -0.03632295876741409, mean p set: 0.4487202763557434The modified gen p mean: 0.45033302903175354, gen p mean: -0.03594272956252098, mean p set: 0.450813353061676
loss_pred:0.014860451221466064, decouple_loss:0.0012156243901699781
loss_pred:0.015100398100912571, decouple_loss:0.0013382522156462073
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45083022117614746, gen p mean: -0.03257719799876213, mean p set: 0.45131051540374756
loss_pred:0.016426442191004753, decouple_loss:0.001273476518690586
The modified gen p mean: 0.4504193961620331, gen p mean: -0.03356150910258293, mean p set: 0.45089972019195557
The modified gen p mean: 0.449398398399353, gen p mean: -0.03248881176114082, mean p set: 0.4498787224292755
loss_pred:0.016124404966831207, decouple_loss:0.0012143756030127406
loss_pred:0.015153675340116024, decouple_loss:0.0012538435403257608
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488604664802551, gen p mean: -0.04023263230919838, mean p set: 0.4493407607078552
loss_pred:0.016165215522050858, decouple_loss:0.00123647041618824
The modified gen p mean: 0.44768425822257996, gen p mean: -0.040643926709890366, mean p set: 0.44816452264785767The modified gen p mean: 0.44868701696395874, gen p mean: -0.04353470727801323, mean p set: 0.44916728138923645
loss_pred:0.016344493255019188, decouple_loss:0.0011775449384003878
loss_pred:0.015061918646097183, decouple_loss:0.0012464086757972836
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499788284301758, gen p mean: -0.050872836261987686, mean p set: 0.4504591226577759
loss_pred:0.015578098595142365, decouple_loss:0.0013087890110909939
The modified gen p mean: 0.4496113359928131, gen p mean: -0.04124308377504349, mean p set: 0.4500916600227356The modified gen p mean: 0.44802236557006836, gen p mean: -0.04071245342493057, mean p set: 0.44850265979766846
loss_pred:0.015548977069556713, decouple_loss:0.0012714641634374857
loss_pred:0.015251302160322666, decouple_loss:0.001329371822066605
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890129566192627, gen p mean: -0.043063659220933914, mean p set: 0.44938161969184875
loss_pred:0.015327390283346176, decouple_loss:0.001177571713924408
The modified gen p mean: 0.4490615725517273, gen p mean: -0.044779665768146515, mean p set: 0.4495418667793274The modified gen p mean: 0.44999992847442627, gen p mean: -0.04622984305024147, mean p set: 0.450480192899704
loss_pred:0.015582709573209286, decouple_loss:0.001258694683201611
loss_pred:0.015908701345324516, decouple_loss:0.001207082299515605
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499353766441345, gen p mean: -0.04400806128978729, mean p set: 0.45041564106941223
loss_pred:0.015723565593361855, decouple_loss:0.001267871935851872
The modified gen p mean: 0.44940653443336487, gen p mean: -0.04747145250439644, mean p set: 0.44988682866096497The modified gen p mean: 0.45010000467300415, gen p mean: -0.0422900952398777, mean p set: 0.45058029890060425
loss_pred:0.015322688035666943, decouple_loss:0.0013210981851443648
loss_pred:0.01647244393825531, decouple_loss:0.001336560701020062
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495903253555298, gen p mean: -0.05523033067584038, mean p set: 0.4500705897808075
loss_pred:0.015151564963161945, decouple_loss:0.0012202824000269175
The modified gen p mean: 0.4482998549938202, gen p mean: -0.04778040200471878, mean p set: 0.4487801790237427The modified gen p mean: 0.45030972361564636, gen p mean: -0.05000019073486328, mean p set: 0.45079004764556885
loss_pred:0.014888502657413483, decouple_loss:0.0011571305803954601
loss_pred:0.01532640028744936, decouple_loss:0.0011470979079604149
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915708899497986, gen p mean: -0.04795379564166069, mean p set: 0.44963738322257996
loss_pred:0.015461321920156479, decouple_loss:0.0012667246628552675
The modified gen p mean: 0.4476298689842224, gen p mean: -0.04899538680911064, mean p set: 0.4481101632118225The modified gen p mean: 0.44863197207450867, gen p mean: -0.043374404311180115, mean p set: 0.44911229610443115
loss_pred:0.01498685497790575, decouple_loss:0.0011832267045974731
loss_pred:0.01554062683135271, decouple_loss:0.0014006190467625856
2023-05-01 18:13:53 testing...
The modified gen p mean: 0.449788898229599, gen p mean: -0.05372198298573494, mean p set: 0.4502691626548767
The modified gen p mean: 0.4495830833911896, gen p mean: -0.05021772161126137, mean p set: 0.4500633478164673
The modified gen p mean: 0.44987666606903076, gen p mean: -0.049746569246053696, mean p set: 0.45035696029663086
loss_pred:0.018499933183193207, decouple_loss:0.001330078230239451
loss_pred:0.01751657947897911, decouple_loss:0.0013214220525696874
loss_pred:0.01743183098733425, decouple_loss:0.0013303534360602498
WV_0_PC_1_EH_0_PS_40, loss: 0.01788247935473919, avg_mse: 0.02573699876666069
current test mse: 0.025737
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773149490356445, gen p mean: -0.04898931831121445, mean p set: 0.44821181893348694
loss_pred:0.015059119090437889, decouple_loss:0.0011988145997747779
The modified gen p mean: 0.44967153668403625, gen p mean: -0.05185580626130104, mean p set: 0.45015186071395874The modified gen p mean: 0.44924744963645935, gen p mean: -0.04480045288801193, mean p set: 0.44972777366638184
loss_pred:0.016249384731054306, decouple_loss:0.0011711650295183063
loss_pred:0.01545318029820919, decouple_loss:0.0011918446980416775
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021986961364746, gen p mean: -0.0454586036503315, mean p set: 0.45070016384124756
loss_pred:0.015421891584992409, decouple_loss:0.0012771013425663114
The modified gen p mean: 0.44960451126098633, gen p mean: -0.046814318746328354, mean p set: 0.4500848054885864The modified gen p mean: 0.44907867908477783, gen p mean: -0.048580288887023926, mean p set: 0.4495590031147003
loss_pred:0.016571354120969772, decouple_loss:0.0012357031228020787
loss_pred:0.015614401549100876, decouple_loss:0.0013615263160318136
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498811662197113, gen p mean: -0.04721170291304588, mean p set: 0.4503614604473114
loss_pred:0.015129881910979748, decouple_loss:0.0010377258295193315
The modified gen p mean: 0.44935885071754456, gen p mean: -0.04403430223464966, mean p set: 0.44983911514282227The modified gen p mean: 0.4490783214569092, gen p mean: -0.04316955432295799, mean p set: 0.4495586156845093
loss_pred:0.015581252053380013, decouple_loss:0.0010471016867086291
loss_pred:0.016456929966807365, decouple_loss:0.0010884471703320742
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485498070716858, gen p mean: -0.0416017547249794, mean p set: 0.4490301311016083
loss_pred:0.015357470139861107, decouple_loss:0.0011440987000241876
The modified gen p mean: 0.4502919018268585, gen p mean: -0.05575208738446236, mean p set: 0.4507721960544586The modified gen p mean: 0.4499967396259308, gen p mean: -0.046595267951488495, mean p set: 0.4504770338535309
loss_pred:0.015397890470921993, decouple_loss:0.0012396815000101924
loss_pred:0.015010363422334194, decouple_loss:0.0010972041636705399
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914501905441284, gen p mean: -0.04093978926539421, mean p set: 0.4496253430843353
loss_pred:0.015261993743479252, decouple_loss:0.0010145005071535707
The modified gen p mean: 0.4510635435581207, gen p mean: -0.04647279530763626, mean p set: 0.4515438675880432The modified gen p mean: 0.44962725043296814, gen p mean: -0.04559837281703949, mean p set: 0.45010754466056824
loss_pred:0.01626378484070301, decouple_loss:0.0011140259448438883
loss_pred:0.015602379105985165, decouple_loss:0.0011322696227580309
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963711500167847, gen p mean: -0.0390130914747715, mean p set: 0.4501173794269562
loss_pred:0.016208237037062645, decouple_loss:0.0013293608790263534
The modified gen p mean: 0.4483415484428406, gen p mean: -0.04543760418891907, mean p set: 0.4488218426704407The modified gen p mean: 0.4498796761035919, gen p mean: -0.03880525380373001, mean p set: 0.450359970331192
loss_pred:0.016028905287384987, decouple_loss:0.0011915378272533417
loss_pred:0.015124856494367123, decouple_loss:0.001146505237556994
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493899643421173, gen p mean: -0.0416836142539978, mean p set: 0.4498702585697174
loss_pred:0.01577664352953434, decouple_loss:0.001147642731666565
The modified gen p mean: 0.4488687813282013, gen p mean: -0.04463233798742294, mean p set: 0.449349045753479The modified gen p mean: 0.44783836603164673, gen p mean: -0.044367287307977676, mean p set: 0.44831863045692444
loss_pred:0.015817541629076004, decouple_loss:0.0011651200475171208
loss_pred:0.015948349609971046, decouple_loss:0.0011041986290365458
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 349, in <module>
    train_wrapper(model)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 259, in train_wrapper
    train_input_handle = datasets_factory.data_provider(
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/datasets_factory.py", line 48, in data_provider
    train_input_handle = datasets_map[dataset_name].InputHandle(train_input_param)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 26, in __init__
    self.load()
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 31, in load
    self.data['clips'] = dat_1['clips']
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/numpy/lib/npyio.py", line 260, in __getitem__
    raise KeyError("%s is not a file in the archive" % key)
KeyError: 'clips is not a file in the archive'