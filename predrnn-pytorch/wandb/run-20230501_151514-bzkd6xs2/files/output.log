
load model: /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012010_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012013_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
train_data_files nums: 125
mnist test iterator, Loading data from /scratch/09012/haoli1/ERA5/val_dataset/era5_train_09012020_3_24hr.npz
NaN value num: 0
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012019_3_24hr.npz
NaN value num: 0
Iteration: 1, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490041434764862, gen p mean: -0.10289089381694794, mean p set: 0.449579656124115
loss_pred:0.017301613464951515, decouple_loss:0.0006276149651966989
The modified gen p mean: 0.44928497076034546, gen p mean: -0.10510342568159103, mean p set: 0.4498618543148041
loss_pred:0.016268741339445114, decouple_loss:0.0005827823770232499
The modified gen p mean: 0.4490061104297638, gen p mean: -0.10739686340093613, mean p set: 0.44958263635635376
loss_pred:0.01710520312190056, decouple_loss:0.0006220662617124617
/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/torch/nn/parallel/_functions.py:68: UserWarning: Was asked to gather along dimension 0, but all input tensors were scalars; will instead unsqueeze and return a vector.
  warnings.warn('Was asked to gather along dimension 0, but all '
Iteration: 2, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735193252563477, gen p mean: -0.11413891613483429, mean p set: 0.4479283094406128
loss_pred:0.02138768509030342, decouple_loss:0.002597798127681017
The modified gen p mean: 0.450075626373291, gen p mean: -0.11409547924995422, mean p set: 0.45065340399742126
loss_pred:0.020696589723229408, decouple_loss:0.002773009706288576
The modified gen p mean: 0.4493929147720337, gen p mean: -0.11361544579267502, mean p set: 0.44996798038482666
loss_pred:0.021392028778791428, decouple_loss:0.002500704722478986
Iteration: 3, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44831183552742004, gen p mean: -0.10565560311079025, mean p set: 0.44888877868652344
loss_pred:0.01847175695002079, decouple_loss:0.0020379910711199045
The modified gen p mean: 0.45028653740882874, gen p mean: -0.1071636900305748, mean p set: 0.4508638381958008
loss_pred:0.016896408051252365, decouple_loss:0.001983095658943057
The modified gen p mean: 0.44687607884407043, gen p mean: -0.1044372022151947, mean p set: 0.44745081663131714
loss_pred:0.019111549481749535, decouple_loss:0.0019222027622163296
Iteration: 4, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468660354614258, gen p mean: -0.10211244225502014, mean p set: 0.4474412202835083
loss_pred:0.019344445317983627, decouple_loss:0.0016247564926743507
The modified gen p mean: 0.4494504928588867, gen p mean: -0.09249800443649292, mean p set: 0.45002689957618713
loss_pred:0.019623467698693275, decouple_loss:0.0018209019908681512
The modified gen p mean: 0.45008981227874756, gen p mean: -0.10174304246902466, mean p set: 0.45066434144973755
loss_pred:0.01920074224472046, decouple_loss:0.0019899082835763693
Iteration: 5, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786161184310913, gen p mean: -0.09886681288480759, mean p set: 0.4484367072582245
loss_pred:0.01992115005850792, decouple_loss:0.00192162673920393
The modified gen p mean: 0.44771111011505127, gen p mean: -0.10219252109527588, mean p set: 0.4482865631580353
loss_pred:0.02049998566508293, decouple_loss:0.0019194594351574779
The modified gen p mean: 0.44749441742897034, gen p mean: -0.10853113979101181, mean p set: 0.4480692446231842
loss_pred:0.019232435151934624, decouple_loss:0.0020542950369417667
Iteration: 6, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494899809360504, gen p mean: -0.11434222012758255, mean p set: 0.4500678777694702
loss_pred:0.01883023791015148, decouple_loss:0.0015129600651562214
The modified gen p mean: 0.44845739006996155, gen p mean: -0.10335681587457657, mean p set: 0.4490341246128082
loss_pred:0.018439238891005516, decouple_loss:0.0018033648375421762
The modified gen p mean: 0.44895899295806885, gen p mean: -0.11281563341617584, mean p set: 0.44953596591949463
loss_pred:0.018764149397611618, decouple_loss:0.0012533478438854218
Iteration: 7, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486449062824249, gen p mean: -0.10190936923027039, mean p set: 0.4492203891277313
loss_pred:0.01891300641000271, decouple_loss:0.0013372038956731558
The modified gen p mean: 0.44857877492904663, gen p mean: -0.10135398805141449, mean p set: 0.44915536046028137
loss_pred:0.018597766757011414, decouple_loss:0.0012824742589145899
The modified gen p mean: 0.44842278957366943, gen p mean: -0.109357088804245, mean p set: 0.4489997923374176
loss_pred:0.01940431259572506, decouple_loss:0.0012841856805607677
Iteration: 8, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486752450466156, gen p mean: -0.10302305221557617, mean p set: 0.44925177097320557
loss_pred:0.018728699535131454, decouple_loss:0.001402552123181522
The modified gen p mean: 0.44901007413864136, gen p mean: -0.1069120317697525, mean p set: 0.4495847821235657
loss_pred:0.018682371824979782, decouple_loss:0.001319958595559001
The modified gen p mean: 0.44901105761528015, gen p mean: -0.09974338114261627, mean p set: 0.4495871365070343
loss_pred:0.018595200031995773, decouple_loss:0.0015464024618268013
Iteration: 9, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480338990688324, gen p mean: -0.1036599799990654, mean p set: 0.44860872626304626
loss_pred:0.01802145503461361, decouple_loss:0.0009443979361094534
The modified gen p mean: 0.4502266049385071, gen p mean: -0.10921406000852585, mean p set: 0.45080211758613586
loss_pred:0.018733596429228783, decouple_loss:0.0011924065183848143
The modified gen p mean: 0.4479007422924042, gen p mean: -0.11484026163816452, mean p set: 0.44847843050956726
loss_pred:0.018808260560035706, decouple_loss:0.000860241474583745
Iteration: 10, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44944748282432556, gen p mean: -0.12096147239208221, mean p set: 0.45002496242523193
loss_pred:0.017684662714600563, decouple_loss:0.0008283077040687203
The modified gen p mean: 0.44779881834983826, gen p mean: -0.11954188346862793, mean p set: 0.44837674498558044
loss_pred:0.017527185380458832, decouple_loss:0.0008643618202768266
The modified gen p mean: 0.4488527178764343, gen p mean: -0.10904481261968613, mean p set: 0.4494294226169586
loss_pred:0.01912250556051731, decouple_loss:0.0009194154990836978
2023-05-01 15:18:45 testing...
The modified gen p mean: 0.44974106550216675, gen p mean: -0.12464646995067596, mean p set: 0.4502691626548767
loss_pred:0.018111614510416985, decouple_loss:0.0010301974834874272
The modified gen p mean: 0.44978001713752747, gen p mean: -0.11796396225690842, mean p set: 0.45035696029663086
loss_pred:0.017777109518647194, decouple_loss:0.0008730150875635445
The modified gen p mean: 0.4494871199131012, gen p mean: -0.1180955246090889, mean p set: 0.4500633478164673
loss_pred:0.017407383769750595, decouple_loss:0.0009500239975750446
WV_1_PC_1_EH_0_PS_40, loss: 0.017812922596931458, avg_mse: 0.02744920365512371
current test mse: 0.027449
Iteration: 11, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475584626197815, gen p mean: -0.11437809467315674, mean p set: 0.4481346309185028
loss_pred:0.01928987354040146, decouple_loss:0.000879080209415406
The modified gen p mean: 0.44891393184661865, gen p mean: -0.11778756231069565, mean p set: 0.44949114322662354
loss_pred:0.017629515379667282, decouple_loss:0.0008777864277362823
The modified gen p mean: 0.4506393074989319, gen p mean: -0.11952541768550873, mean p set: 0.451217383146286
loss_pred:0.01733146235346794, decouple_loss:0.0011299251345917583
Iteration: 12, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483109414577484, gen p mean: -0.13386006653308868, mean p set: 0.4488857388496399
loss_pred:0.018126510083675385, decouple_loss:0.0009131428669206798
The modified gen p mean: 0.44971582293510437, gen p mean: -0.13257677853107452, mean p set: 0.45029157400131226The modified gen p mean: 0.44906121492385864, gen p mean: -0.1317691206932068, mean p set: 0.44963809847831726
loss_pred:0.01786963641643524, decouple_loss:0.0009441478759981692loss_pred:0.01678531803190708, decouple_loss:0.0010111379669979215
Iteration: 13, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447214275598526, gen p mean: -0.1290113776922226, mean p set: 0.44778892397880554
The modified gen p mean: 0.44890159368515015, gen p mean: -0.1327006220817566, mean p set: 0.4494785666465759loss_pred:0.017616989091038704, decouple_loss:0.0014376395847648382
loss_pred:0.0187532939016819, decouple_loss:0.0008937875390984118
The modified gen p mean: 0.4477619528770447, gen p mean: -0.12879477441310883, mean p set: 0.44833892583847046
loss_pred:0.01892484910786152, decouple_loss:0.001160120009444654
Iteration: 14, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818612933158875, gen p mean: -0.15393733978271484, mean p set: 0.4487626254558563
The modified gen p mean: 0.44980522990226746, gen p mean: -0.14667144417762756, mean p set: 0.45037850737571716loss_pred:0.01763070560991764, decouple_loss:0.0008256664732471108
loss_pred:0.017196854576468468, decouple_loss:0.0007523336098529398
The modified gen p mean: 0.4469054639339447, gen p mean: -0.1508360356092453, mean p set: 0.4474814832210541
loss_pred:0.017779428511857986, decouple_loss:0.0007361735333688557
Iteration: 15, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499201476573944, gen p mean: -0.13923168182373047, mean p set: 0.4505000710487366
loss_pred:0.01763268932700157, decouple_loss:0.0008074724464677274
The modified gen p mean: 0.4486018419265747, gen p mean: -0.1435898393392563, mean p set: 0.44917726516723633
loss_pred:0.0176865067332983, decouple_loss:0.0006906930357217789
The modified gen p mean: 0.4500875174999237, gen p mean: -0.1454130858182907, mean p set: 0.4506652057170868
loss_pred:0.016543155536055565, decouple_loss:0.0008551967912353575
Iteration: 16, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484722316265106, gen p mean: -0.12952519953250885, mean p set: 0.44904592633247375
loss_pred:0.01844191737473011, decouple_loss:0.000865853508003056
The modified gen p mean: 0.44925159215927124, gen p mean: -0.13656893372535706, mean p set: 0.449830561876297
loss_pred:0.01770078018307686, decouple_loss:0.0007894303416833282
The modified gen p mean: 0.4483298659324646, gen p mean: -0.1376248300075531, mean p set: 0.4489073157310486
loss_pred:0.017661202698946, decouple_loss:0.0008099363185465336
Iteration: 17, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486170709133148, gen p mean: -0.1287289559841156, mean p set: 0.4491897523403168
loss_pred:0.01722247712314129, decouple_loss:0.0007896366296336055
The modified gen p mean: 0.4474197328090668, gen p mean: -0.13336555659770966, mean p set: 0.4479937255382538
loss_pred:0.017933815717697144, decouple_loss:0.0007652509957551956
The modified gen p mean: 0.4495300054550171, gen p mean: -0.13278208673000336, mean p set: 0.45010536909103394
loss_pred:0.017880871891975403, decouple_loss:0.0008088784525170922
Iteration: 18, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486563503742218, gen p mean: -0.13206806778907776, mean p set: 0.4492320418357849
loss_pred:0.017165953293442726, decouple_loss:0.0009107923833653331
The modified gen p mean: 0.44859692454338074, gen p mean: -0.12981152534484863, mean p set: 0.44917601346969604
loss_pred:0.018274208530783653, decouple_loss:0.000881207175552845
The modified gen p mean: 0.44912630319595337, gen p mean: -0.13379880785942078, mean p set: 0.44970032572746277
loss_pred:0.017146499827504158, decouple_loss:0.0007544195395894349
Iteration: 19, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968968629837036, gen p mean: -0.12817472219467163, mean p set: 0.4502682387828827
loss_pred:0.017764372751116753, decouple_loss:0.0007062500226311386
The modified gen p mean: 0.4493393003940582, gen p mean: -0.13128894567489624, mean p set: 0.44991692900657654
loss_pred:0.017919277772307396, decouple_loss:0.0007927337428554893
The modified gen p mean: 0.4492097795009613, gen p mean: -0.1309194713830948, mean p set: 0.449788898229599
loss_pred:0.017170628532767296, decouple_loss:0.0007969860453158617
Iteration: 20, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948628544807434, gen p mean: -0.12678693234920502, mean p set: 0.45006415247917175
loss_pred:0.018038682639598846, decouple_loss:0.0008443156257271767
The modified gen p mean: 0.44735977053642273, gen p mean: -0.12523803114891052, mean p set: 0.4479367434978485
loss_pred:0.01729775220155716, decouple_loss:0.0006971298134885728
The modified gen p mean: 0.4493435025215149, gen p mean: -0.1270308643579483, mean p set: 0.4499170780181885
loss_pred:0.016127536073327065, decouple_loss:0.0006151950219646096
2023-05-01 15:20:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13428974151611328, mean p set: 0.4502691626548767
loss_pred:0.017570875585079193, decouple_loss:0.0007328607025556266
The modified gen p mean: 0.4495362639427185, gen p mean: -0.12802308797836304, mean p set: 0.4500633478164673
loss_pred:0.016775986179709435, decouple_loss:0.000815806386526674
The modified gen p mean: 0.4497816860675812, gen p mean: -0.12797509133815765, mean p set: 0.45035696029663086
loss_pred:0.017156416550278664, decouple_loss:0.0007743012392893434
WV_1_PC_1_EH_0_PS_40, loss: 0.017206477001309395, avg_mse: 0.026631642132997513
current test mse: 0.026632
At step 20, Best test: 0.026632
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012014_3_24hr.npz
NaN value num: 0
Iteration: 21, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814333319664, gen p mean: -0.12319464236497879, mean p set: 0.4487190544605255
loss_pred:0.0173165425658226, decouple_loss:0.000888481386937201
The modified gen p mean: 0.4468269944190979, gen p mean: -0.11946951597929001, mean p set: 0.4474022090435028
loss_pred:0.017762791365385056, decouple_loss:0.0007553676841780543
The modified gen p mean: 0.4476761817932129, gen p mean: -0.12898382544517517, mean p set: 0.448250949382782
loss_pred:0.0179819967597723, decouple_loss:0.0008198170107789338
Iteration: 22, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44808757305145264, gen p mean: -0.12632247805595398, mean p set: 0.4486643373966217
loss_pred:0.01796194165945053, decouple_loss:0.0007522348314523697
The modified gen p mean: 0.4474335312843323, gen p mean: -0.13641950488090515, mean p set: 0.44801223278045654The modified gen p mean: 0.4481867551803589, gen p mean: -0.12560352683067322, mean p set: 0.44876134395599365
loss_pred:0.018140850588679314, decouple_loss:0.0009405646123923361
loss_pred:0.01780814304947853, decouple_loss:0.0007437066524289548
Iteration: 23, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742444157600403, gen p mean: -0.13316024839878082, mean p set: 0.448001891374588
loss_pred:0.01844511181116104, decouple_loss:0.000699697935488075
The modified gen p mean: 0.4488127827644348, gen p mean: -0.12785151600837708, mean p set: 0.449388325214386
loss_pred:0.01749766804277897, decouple_loss:0.0008545619202777743
The modified gen p mean: 0.4477119445800781, gen p mean: -0.12681515514850616, mean p set: 0.44828951358795166
loss_pred:0.01690623350441456, decouple_loss:0.0008238428272306919
Iteration: 24, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44608789682388306, gen p mean: -0.1334507316350937, mean p set: 0.44666171073913574
loss_pred:0.017395446076989174, decouple_loss:0.0007012567948549986
The modified gen p mean: 0.4482468366622925, gen p mean: -0.1345825046300888, mean p set: 0.44882747530937195
loss_pred:0.01748383231461048, decouple_loss:0.0007539587677456439
The modified gen p mean: 0.4458349347114563, gen p mean: -0.1378079205751419, mean p set: 0.44641000032424927
loss_pred:0.017045795917510986, decouple_loss:0.0006278435466811061
Iteration: 25, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462713599205017, gen p mean: -0.13463526964187622, mean p set: 0.4468485414981842
loss_pred:0.01636018045246601, decouple_loss:0.0007155466009862721
The modified gen p mean: 0.4457012712955475, gen p mean: -0.13810037076473236, mean p set: 0.4462752044200897
loss_pred:0.01746644638478756, decouple_loss:0.0007394517888315022
The modified gen p mean: 0.44618964195251465, gen p mean: -0.13206498324871063, mean p set: 0.4467630088329315
loss_pred:0.01770040951669216, decouple_loss:0.0007527898414991796
Iteration: 26, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460759162902832, gen p mean: -0.1339653730392456, mean p set: 0.4466526508331299
loss_pred:0.016863148659467697, decouple_loss:0.0007037378381937742
The modified gen p mean: 0.44619354605674744, gen p mean: -0.13109423220157623, mean p set: 0.4467707574367523
loss_pred:0.01729731075465679, decouple_loss:0.0005719696637243032
The modified gen p mean: 0.44667214155197144, gen p mean: -0.1272473782300949, mean p set: 0.44724777340888977
loss_pred:0.016701314598321915, decouple_loss:0.0006340124527923763
Iteration: 27, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690415263175964, gen p mean: -0.13043321669101715, mean p set: 0.4474782347679138
loss_pred:0.01757141202688217, decouple_loss:0.0005493922508321702
The modified gen p mean: 0.446691632270813, gen p mean: -0.12399262934923172, mean p set: 0.44726744294166565
loss_pred:0.01717047207057476, decouple_loss:0.0006938533624634147
The modified gen p mean: 0.4469892680644989, gen p mean: -0.12963438034057617, mean p set: 0.44756564497947693
loss_pred:0.01655424013733864, decouple_loss:0.0006321218679659069
Iteration: 28, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849157333374023, gen p mean: -0.11700747162103653, mean p set: 0.44906821846961975
loss_pred:0.01645771786570549, decouple_loss:0.000813244900200516
The modified gen p mean: 0.4476717412471771, gen p mean: -0.12599290907382965, mean p set: 0.44824743270874023
loss_pred:0.01803738996386528, decouple_loss:0.0008109332411549985
The modified gen p mean: 0.44597524404525757, gen p mean: -0.12639093399047852, mean p set: 0.446553498506546
loss_pred:0.01717018336057663, decouple_loss:0.0006525989156216383
Iteration: 29, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461294412612915, gen p mean: -0.12153377383947372, mean p set: 0.44670480489730835
loss_pred:0.016841601580381393, decouple_loss:0.0006870416109450161
The modified gen p mean: 0.4461865723133087, gen p mean: -0.12876303493976593, mean p set: 0.4467627704143524
loss_pred:0.017441323027014732, decouple_loss:0.0006462341989390552
The modified gen p mean: 0.4467623233795166, gen p mean: -0.1285475492477417, mean p set: 0.4473387897014618
loss_pred:0.0169218797236681, decouple_loss:0.0007406921358779073
Iteration: 30, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44768109917640686, gen p mean: -0.12584543228149414, mean p set: 0.4482557475566864
loss_pred:0.0172900203615427, decouple_loss:0.0006636361940763891
The modified gen p mean: 0.4465878903865814, gen p mean: -0.11567124724388123, mean p set: 0.4471668004989624
loss_pred:0.01718747988343239, decouple_loss:0.0006908882060088217
The modified gen p mean: 0.44683268666267395, gen p mean: -0.12623733282089233, mean p set: 0.4474048614501953
loss_pred:0.01748574897646904, decouple_loss:0.0007566744461655617
2023-05-01 15:23:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1314372420310974, mean p set: 0.4502691626548767
loss_pred:0.017407316714525223, decouple_loss:0.0007128444849513471
The modified gen p mean: 0.4495328366756439, gen p mean: -0.12534892559051514, mean p set: 0.4500633478164673
loss_pred:0.016639038920402527, decouple_loss:0.0007417895831167698
The modified gen p mean: 0.44977858662605286, gen p mean: -0.12481828033924103, mean p set: 0.45035696029663086
loss_pred:0.016937538981437683, decouple_loss:0.0007135823252610862
WV_1_PC_1_EH_0_PS_40, loss: 0.01703076809644699, avg_mse: 0.02639850415289402
current test mse: 0.026399
At step 30, Best test: 0.026399
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 31, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680339097976685, gen p mean: -0.11950311809778214, mean p set: 0.44737857580184937
loss_pred:0.017335176467895508, decouple_loss:0.0007142337271943688
The modified gen p mean: 0.4472246468067169, gen p mean: -0.12877826392650604, mean p set: 0.44780007004737854
loss_pred:0.01694052666425705, decouple_loss:0.0007683569565415382
The modified gen p mean: 0.448626309633255, gen p mean: -0.12324009835720062, mean p set: 0.4492022693157196
loss_pred:0.017319070175290108, decouple_loss:0.0009056386770680547
Iteration: 32, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469139575958252, gen p mean: -0.12327834218740463, mean p set: 0.4474903643131256
loss_pred:0.016866199672222137, decouple_loss:0.000830824370495975
The modified gen p mean: 0.4474184513092041, gen p mean: -0.1272193044424057, mean p set: 0.44799190759658813The modified gen p mean: 0.446167916059494, gen p mean: -0.1231355294585228, mean p set: 0.446742981672287
loss_pred:0.0163981132209301, decouple_loss:0.0008213836117647588
loss_pred:0.01732463762164116, decouple_loss:0.0008680814644321799
Iteration: 33, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44825541973114014, gen p mean: -0.12340850383043289, mean p set: 0.44883307814598083
loss_pred:0.017314648255705833, decouple_loss:0.0006533640553243458
The modified gen p mean: 0.44723084568977356, gen p mean: -0.11740203946828842, mean p set: 0.4478082060813904
loss_pred:0.016911974176764488, decouple_loss:0.0006678694044239819
The modified gen p mean: 0.44839558005332947, gen p mean: -0.12723803520202637, mean p set: 0.4489694833755493
loss_pred:0.0176151841878891, decouple_loss:0.0007466256502084434
Iteration: 34, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663941860198975, gen p mean: -0.12399040162563324, mean p set: 0.4472139775753021
loss_pred:0.016408151015639305, decouple_loss:0.0009823193540796638
The modified gen p mean: 0.4464966058731079, gen p mean: -0.1271926909685135, mean p set: 0.44707152247428894
loss_pred:0.01670723967254162, decouple_loss:0.0008788424893282354
The modified gen p mean: 0.44605088233947754, gen p mean: -0.13261890411376953, mean p set: 0.44662904739379883
loss_pred:0.01683661714196205, decouple_loss:0.0007710852660238743
Iteration: 35, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481939971446991, gen p mean: -0.11982006579637527, mean p set: 0.44877323508262634
loss_pred:0.016739916056394577, decouple_loss:0.0007432196289300919
The modified gen p mean: 0.4486532211303711, gen p mean: -0.121879942715168, mean p set: 0.4492294192314148
loss_pred:0.017249085009098053, decouple_loss:0.0007886168896220624
The modified gen p mean: 0.4462503492832184, gen p mean: -0.1276206225156784, mean p set: 0.4468248784542084
loss_pred:0.01710919849574566, decouple_loss:0.0007882456993684173
Iteration: 36, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479207992553711, gen p mean: -0.12252778559923172, mean p set: 0.4484969973564148
loss_pred:0.017826762050390244, decouple_loss:0.0007097215275280178
The modified gen p mean: 0.4475378692150116, gen p mean: -0.12745720148086548, mean p set: 0.44811415672302246
loss_pred:0.01745941862463951, decouple_loss:0.0006919233710505068
The modified gen p mean: 0.44672438502311707, gen p mean: -0.12665386497974396, mean p set: 0.44730156660079956
loss_pred:0.017385272309184074, decouple_loss:0.0007482274086214602
Iteration: 37, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699153304100037, gen p mean: -0.1253613829612732, mean p set: 0.44756606221199036
loss_pred:0.016772065311670303, decouple_loss:0.0008076178492046893
The modified gen p mean: 0.44591039419174194, gen p mean: -0.12174683809280396, mean p set: 0.44648540019989014
loss_pred:0.01770160347223282, decouple_loss:0.000987999141216278
The modified gen p mean: 0.44625359773635864, gen p mean: -0.12466367334127426, mean p set: 0.44682982563972473
loss_pred:0.017297543585300446, decouple_loss:0.0011020549573004246
Iteration: 38, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472449719905853, gen p mean: -0.12617729604244232, mean p set: 0.4478208124637604
loss_pred:0.017590099945664406, decouple_loss:0.0007287420448847115
The modified gen p mean: 0.4470493197441101, gen p mean: -0.11771107465028763, mean p set: 0.44762495160102844
loss_pred:0.016473393887281418, decouple_loss:0.0006456132978200912
The modified gen p mean: 0.44678816199302673, gen p mean: -0.1238001137971878, mean p set: 0.4473620653152466
loss_pred:0.017837565392255783, decouple_loss:0.0008389540598727763
Iteration: 39, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769448041915894, gen p mean: -0.11787503212690353, mean p set: 0.44826972484588623
loss_pred:0.01606866903603077, decouple_loss:0.0005531052593141794
The modified gen p mean: 0.4460601508617401, gen p mean: -0.12347176671028137, mean p set: 0.4466361403465271
loss_pred:0.016839228570461273, decouple_loss:0.0006699712248519063
The modified gen p mean: 0.4461204707622528, gen p mean: -0.11865618824958801, mean p set: 0.4466968774795532
loss_pred:0.01745588518679142, decouple_loss:0.0006832448416389525
Iteration: 40, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684863090515137, gen p mean: -0.11174917966127396, mean p set: 0.4474250078201294
loss_pred:0.017500489950180054, decouple_loss:0.0007332462701015174
The modified gen p mean: 0.44876906275749207, gen p mean: -0.12072738260030746, mean p set: 0.44934335350990295
loss_pred:0.017690079286694527, decouple_loss:0.0008063981076702476
The modified gen p mean: 0.4462696313858032, gen p mean: -0.11839539557695389, mean p set: 0.44684502482414246
loss_pred:0.016063908115029335, decouple_loss:0.000640243582893163
2023-05-01 15:25:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12341217696666718, mean p set: 0.4502691626548767
loss_pred:0.01728755421936512, decouple_loss:0.0006095266435295343
The modified gen p mean: 0.44953474402427673, gen p mean: -0.11717917770147324, mean p set: 0.4500633478164673
loss_pred:0.016619278118014336, decouple_loss:0.0007257359102368355
The modified gen p mean: 0.44978007674217224, gen p mean: -0.11691582202911377, mean p set: 0.45035696029663086
loss_pred:0.017052609473466873, decouple_loss:0.0006801395211368799
WV_1_PC_1_EH_0_PS_40, loss: 0.017020070925354958, avg_mse: 0.026395821943879128
current test mse: 0.026396
At step 40, Best test: 0.026396
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012003_3_24hr.npz
NaN value num: 0
Iteration: 41, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45132628083229065, gen p mean: -0.11353560537099838, mean p set: 0.451905757188797
loss_pred:0.015752485021948814, decouple_loss:0.0007988973520696163
The modified gen p mean: 0.4497552216053009, gen p mean: -0.11256642639636993, mean p set: 0.4503326416015625
loss_pred:0.01739090494811535, decouple_loss:0.0008710503461770713
The modified gen p mean: 0.45207422971725464, gen p mean: -0.10827566683292389, mean p set: 0.45265257358551025
loss_pred:0.016623694449663162, decouple_loss:0.0009432649821974337
Iteration: 42, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974014163017273, gen p mean: -0.10969603806734085, mean p set: 0.45031604170799255
The modified gen p mean: 0.4498746693134308, gen p mean: -0.11018482595682144, mean p set: 0.45045459270477295
loss_pred:0.015841012820601463, decouple_loss:0.0007185795693658292
loss_pred:0.015399555675685406, decouple_loss:0.0008195566479116678
The modified gen p mean: 0.45060768723487854, gen p mean: -0.11062971502542496, mean p set: 0.4511836767196655
loss_pred:0.017119962722063065, decouple_loss:0.000757460540626198
Iteration: 43, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867610931396484, gen p mean: -0.11710276454687119, mean p set: 0.44924721121788025
loss_pred:0.015292610041797161, decouple_loss:0.0011630246881395578
The modified gen p mean: 0.45255228877067566, gen p mean: -0.11035623401403427, mean p set: 0.4531312584877014
loss_pred:0.016537228599190712, decouple_loss:0.0009960937313735485
The modified gen p mean: 0.45225831866264343, gen p mean: -0.1092715635895729, mean p set: 0.4528343677520752
loss_pred:0.015939129516482353, decouple_loss:0.0008610527729615569
Iteration: 44, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515276253223419, gen p mean: -0.11529648303985596, mean p set: 0.4521060883998871
loss_pred:0.01586138643324375, decouple_loss:0.0009958455339074135
The modified gen p mean: 0.44998258352279663, gen p mean: -0.11216724663972855, mean p set: 0.4505581855773926
loss_pred:0.016151245683431625, decouple_loss:0.0006272272439673543
The modified gen p mean: 0.4528825283050537, gen p mean: -0.1104629784822464, mean p set: 0.4534589648246765
loss_pred:0.015979651361703873, decouple_loss:0.001005154917947948
Iteration: 45, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109668374061584, gen p mean: -0.11414778232574463, mean p set: 0.4516725242137909
loss_pred:0.016404300928115845, decouple_loss:0.0006402911967597902
The modified gen p mean: 0.4495963156223297, gen p mean: -0.10593104362487793, mean p set: 0.4501686692237854
loss_pred:0.015844322741031647, decouple_loss:0.0007339847506955266
The modified gen p mean: 0.4490891098976135, gen p mean: -0.11032439768314362, mean p set: 0.44966429471969604
loss_pred:0.016427302733063698, decouple_loss:0.0009030012879520655
Iteration: 46, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488072693347931, gen p mean: -0.11729365587234497, mean p set: 0.4493838846683502
loss_pred:0.016408681869506836, decouple_loss:0.0007974717882461846
The modified gen p mean: 0.45003944635391235, gen p mean: -0.10671454668045044, mean p set: 0.45061424374580383
loss_pred:0.015767985954880714, decouple_loss:0.0010811334941536188
The modified gen p mean: 0.45348602533340454, gen p mean: -0.1096128448843956, mean p set: 0.45406150817871094
loss_pred:0.015660570934414864, decouple_loss:0.0008032063487917185
Iteration: 47, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483672082424164, gen p mean: -0.11830900609493256, mean p set: 0.44894298911094666
loss_pred:0.01522713340818882, decouple_loss:0.0006993204005993903
The modified gen p mean: 0.45012742280960083, gen p mean: -0.10553466528654099, mean p set: 0.4507025480270386
loss_pred:0.01642387919127941, decouple_loss:0.0008737656171433628
The modified gen p mean: 0.4529472291469574, gen p mean: -0.10725749284029007, mean p set: 0.45352625846862793
loss_pred:0.015935495495796204, decouple_loss:0.0009024229366332293
Iteration: 48, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497127830982208, gen p mean: -0.11030402779579163, mean p set: 0.4502916932106018
loss_pred:0.016385512426495552, decouple_loss:0.0007155744242481887
The modified gen p mean: 0.4529052674770355, gen p mean: -0.10559703409671783, mean p set: 0.4534813165664673
loss_pred:0.01641259528696537, decouple_loss:0.000984994345344603
The modified gen p mean: 0.45246759057044983, gen p mean: -0.10551851242780685, mean p set: 0.45304545760154724
loss_pred:0.015760749578475952, decouple_loss:0.0008616934064775705
Iteration: 49, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982853531837463, gen p mean: -0.10145003348588943, mean p set: 0.45040273666381836
loss_pred:0.015805330127477646, decouple_loss:0.0009669272694736719
The modified gen p mean: 0.4516213834285736, gen p mean: -0.10409405827522278, mean p set: 0.45219725370407104
loss_pred:0.015290039591491222, decouple_loss:0.0010395556455478072
The modified gen p mean: 0.449709951877594, gen p mean: -0.10573533922433853, mean p set: 0.45028528571128845
loss_pred:0.015238862484693527, decouple_loss:0.0009137915913015604
Iteration: 50, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502968490123749, gen p mean: -0.1044612005352974, mean p set: 0.45087239146232605
loss_pred:0.015929823741316795, decouple_loss:0.0007297521806322038
The modified gen p mean: 0.45002779364585876, gen p mean: -0.11735603213310242, mean p set: 0.4506070911884308
loss_pred:0.016330406069755554, decouple_loss:0.001272567082196474
The modified gen p mean: 0.4494447410106659, gen p mean: -0.1040421798825264, mean p set: 0.4500192403793335
loss_pred:0.015962794423103333, decouple_loss:0.0008242612821049988
2023-05-01 15:28:39 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11951310932636261, mean p set: 0.4502691626548767
loss_pred:0.01739838719367981, decouple_loss:0.0006598480395041406
The modified gen p mean: 0.44953545928001404, gen p mean: -0.11321908235549927, mean p set: 0.4500633478164673
loss_pred:0.016616227105259895, decouple_loss:0.0007177750230766833
The modified gen p mean: 0.44978067278862, gen p mean: -0.11273438483476639, mean p set: 0.45035696029663086
loss_pred:0.017002318054437637, decouple_loss:0.0006512536201626062
WV_1_PC_1_EH_0_PS_40, loss: 0.017039459198713303, avg_mse: 0.026467017829418182
current test mse: 0.026467
Iteration: 51, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45264244079589844, gen p mean: -0.10547300428152084, mean p set: 0.4532198905944824
loss_pred:0.01613604463636875, decouple_loss:0.0009569783578626812
The modified gen p mean: 0.4497508108615875, gen p mean: -0.1039004772901535, mean p set: 0.45032599568367004The modified gen p mean: 0.44863852858543396, gen p mean: -0.11146967113018036, mean p set: 0.44921332597732544
loss_pred:0.015337314456701279, decouple_loss:0.0007686486351303756
loss_pred:0.016066288575530052, decouple_loss:0.0007336543640121818
Iteration: 52, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44924265146255493, gen p mean: -0.11141306161880493, mean p set: 0.44981902837753296
The modified gen p mean: 0.4492488503456116, gen p mean: -0.10287956148386002, mean p set: 0.44982537627220154
loss_pred:0.01563512720167637, decouple_loss:0.0010603925911709666
loss_pred:0.015997853130102158, decouple_loss:0.0008156112162396312
The modified gen p mean: 0.4502129554748535, gen p mean: -0.10499691963195801, mean p set: 0.4507887363433838
loss_pred:0.014990587718784809, decouple_loss:0.0009517981088720262
Iteration: 53, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966667890548706, gen p mean: -0.10986980050802231, mean p set: 0.4502440094947815
loss_pred:0.016754480078816414, decouple_loss:0.000987158971838653
The modified gen p mean: 0.4499881863594055, gen p mean: -0.10458776354789734, mean p set: 0.4505661725997925
loss_pred:0.015058756805956364, decouple_loss:0.0008874310296960175
The modified gen p mean: 0.448594868183136, gen p mean: -0.10964391380548477, mean p set: 0.44917213916778564
loss_pred:0.015091671608388424, decouple_loss:0.0009017575066536665
Iteration: 54, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471651017665863, gen p mean: -0.11213836818933487, mean p set: 0.4477446675300598
loss_pred:0.015274821780622005, decouple_loss:0.0006705481791868806
The modified gen p mean: 0.448745995759964, gen p mean: -0.10800434648990631, mean p set: 0.4493206739425659
loss_pred:0.015241285786032677, decouple_loss:0.0006985567160882056
The modified gen p mean: 0.4530729353427887, gen p mean: -0.10012451559305191, mean p set: 0.45364704728126526
loss_pred:0.015855146571993828, decouple_loss:0.0007040809723548591
Iteration: 55, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963398575782776, gen p mean: -0.1139712706208229, mean p set: 0.45020797848701477
loss_pred:0.01590210199356079, decouple_loss:0.0008055706857703626
The modified gen p mean: 0.44907647371292114, gen p mean: -0.1054021492600441, mean p set: 0.4496527314186096
loss_pred:0.01599295437335968, decouple_loss:0.0008104132721200585
The modified gen p mean: 0.4488270878791809, gen p mean: -0.11078012734651566, mean p set: 0.4494048058986664
loss_pred:0.01483902893960476, decouple_loss:0.0007724089664407074
Iteration: 56, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45011740922927856, gen p mean: -0.10538816452026367, mean p set: 0.450695663690567
loss_pred:0.01571129634976387, decouple_loss:0.0006173718720674515
The modified gen p mean: 0.4511680006980896, gen p mean: -0.10563557595014572, mean p set: 0.4517436623573303
loss_pred:0.01612703874707222, decouple_loss:0.0007901406497694552
The modified gen p mean: 0.4514576494693756, gen p mean: -0.10325351357460022, mean p set: 0.4520338773727417
loss_pred:0.01581190526485443, decouple_loss:0.0008045199792832136
Iteration: 57, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491378664970398, gen p mean: -0.10787513852119446, mean p set: 0.4497148096561432
loss_pred:0.01541479304432869, decouple_loss:0.0008865967392921448
The modified gen p mean: 0.44959402084350586, gen p mean: -0.10800415277481079, mean p set: 0.45016786456108093
loss_pred:0.01628194749355316, decouple_loss:0.0008854886400513351
The modified gen p mean: 0.44846493005752563, gen p mean: -0.11311967670917511, mean p set: 0.44903984665870667
loss_pred:0.015865659341216087, decouple_loss:0.0011812186567112803
Iteration: 58, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503919780254364, gen p mean: -0.10918295383453369, mean p set: 0.45096808671951294
loss_pred:0.014842426404356956, decouple_loss:0.0007103568059392273
The modified gen p mean: 0.4496261477470398, gen p mean: -0.1085587665438652, mean p set: 0.45020267367362976
loss_pred:0.016512596979737282, decouple_loss:0.000651502690743655
The modified gen p mean: 0.44960469007492065, gen p mean: -0.10629579424858093, mean p set: 0.45018163323402405
loss_pred:0.015836672857403755, decouple_loss:0.0006690880400128663
Iteration: 59, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505101442337036, gen p mean: -0.1093541756272316, mean p set: 0.4510878920555115
loss_pred:0.01622370257973671, decouple_loss:0.0009753280319273472
The modified gen p mean: 0.4526214301586151, gen p mean: -0.10337274521589279, mean p set: 0.4531964957714081
loss_pred:0.015684854239225388, decouple_loss:0.000868763483595103
The modified gen p mean: 0.4494364261627197, gen p mean: -0.10502899438142776, mean p set: 0.4500143229961395
loss_pred:0.015686478465795517, decouple_loss:0.0010249814949929714
Iteration: 60, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940319657325745, gen p mean: -0.1080913171172142, mean p set: 0.4499790072441101
loss_pred:0.015911031514406204, decouple_loss:0.0007066468824632466
The modified gen p mean: 0.4527240991592407, gen p mean: -0.10437466949224472, mean p set: 0.45330190658569336
loss_pred:0.015294746495783329, decouple_loss:0.0008179808501154184
The modified gen p mean: 0.4504941701889038, gen p mean: -0.11299773305654526, mean p set: 0.4510722756385803
loss_pred:0.014913477003574371, decouple_loss:0.0005882748519070446
2023-05-01 15:30:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12161395698785782, mean p set: 0.4502691626548767
loss_pred:0.01735309511423111, decouple_loss:0.0007524163811467588
The modified gen p mean: 0.4495355188846588, gen p mean: -0.11521822959184647, mean p set: 0.4500633478164673
loss_pred:0.016581811010837555, decouple_loss:0.0009275977499783039
The modified gen p mean: 0.4497814476490021, gen p mean: -0.11482580006122589, mean p set: 0.45035696029663086
loss_pred:0.017011698335409164, decouple_loss:0.0007744273752905428
WV_1_PC_1_EH_0_PS_40, loss: 0.017023108899593353, avg_mse: 0.02648140676319599
current test mse: 0.026481
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012007_3_24hr.npz
NaN value num: 0
Iteration: 61, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771450757980347, gen p mean: -0.11805513501167297, mean p set: 0.448288232088089
loss_pred:0.01640632562339306, decouple_loss:0.0006578504107892513
The modified gen p mean: 0.4473196268081665, gen p mean: -0.11836173385381699, mean p set: 0.44789600372314453
loss_pred:0.017432216554880142, decouple_loss:0.0008975565433502197
The modified gen p mean: 0.4457598328590393, gen p mean: -0.11548198014497757, mean p set: 0.4463379681110382
loss_pred:0.01745711825788021, decouple_loss:0.0006955185090191662
Iteration: 62, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762206077575684, gen p mean: -0.11754011362791061, mean p set: 0.4481962025165558
The modified gen p mean: 0.448816180229187, gen p mean: -0.11978703737258911, mean p set: 0.44939130544662476loss_pred:0.017354045063257217, decouple_loss:0.0005956051172688603
loss_pred:0.0164156723767519, decouple_loss:0.0006030327640473843
The modified gen p mean: 0.44707632064819336, gen p mean: -0.11731954663991928, mean p set: 0.447655588388443
loss_pred:0.017484383657574654, decouple_loss:0.0006530208629556
Iteration: 63, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470004737377167, gen p mean: -0.12385746091604233, mean p set: 0.4475752115249634
loss_pred:0.01619214005768299, decouple_loss:0.0005951087805442512
The modified gen p mean: 0.4466066062450409, gen p mean: -0.11502504348754883, mean p set: 0.44717973470687866The modified gen p mean: 0.4478844106197357, gen p mean: -0.11471214145421982, mean p set: 0.4484597444534302
loss_pred:0.017701657488942146, decouple_loss:0.0007652113563381135
loss_pred:0.016838109120726585, decouple_loss:0.0005657879519276321
Iteration: 64, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44677913188934326, gen p mean: -0.11779113113880157, mean p set: 0.447354793548584
loss_pred:0.017741527408361435, decouple_loss:0.0007138255168683827
The modified gen p mean: 0.4480113387107849, gen p mean: -0.12003231793642044, mean p set: 0.44858479499816895
loss_pred:0.01643991656601429, decouple_loss:0.0006459123105742037
The modified gen p mean: 0.44811803102493286, gen p mean: -0.11216944456100464, mean p set: 0.4486939311027527
loss_pred:0.017052989453077316, decouple_loss:0.0006441517034545541
Iteration: 65, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44625404477119446, gen p mean: -0.1195826306939125, mean p set: 0.44682762026786804
loss_pred:0.016213836148381233, decouple_loss:0.0006946656503714621
The modified gen p mean: 0.4469284415245056, gen p mean: -0.1158272847533226, mean p set: 0.44750040769577026
loss_pred:0.017188670113682747, decouple_loss:0.0005972806247882545
The modified gen p mean: 0.4470188319683075, gen p mean: -0.12277542799711227, mean p set: 0.4475935399532318
loss_pred:0.01658269204199314, decouple_loss:0.0006391736096702516
Iteration: 66, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44619303941726685, gen p mean: -0.11320430040359497, mean p set: 0.4467698633670807
loss_pred:0.017412137240171432, decouple_loss:0.0006857140106149018
The modified gen p mean: 0.44813981652259827, gen p mean: -0.11985378712415695, mean p set: 0.448716402053833
loss_pred:0.015766317024827003, decouple_loss:0.0005347206606529653
The modified gen p mean: 0.4488336443901062, gen p mean: -0.12020502239465714, mean p set: 0.44940972328186035
loss_pred:0.01587029919028282, decouple_loss:0.000609455571975559
Iteration: 67, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463596045970917, gen p mean: -0.11360956728458405, mean p set: 0.44693848490715027
The modified gen p mean: 0.44766655564308167, gen p mean: -0.11082698404788971, mean p set: 0.44824421405792236
loss_pred:0.017815442755818367, decouple_loss:0.0005965288146398962
loss_pred:0.017156464979052544, decouple_loss:0.0006458510761149228
The modified gen p mean: 0.44833213090896606, gen p mean: -0.11684496700763702, mean p set: 0.4489063620567322
loss_pred:0.016460498794913292, decouple_loss:0.0008628820651210845
Iteration: 68, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792234897613525, gen p mean: -0.11722175776958466, mean p set: 0.44849663972854614
loss_pred:0.017033135518431664, decouple_loss:0.0006643742090091109
The modified gen p mean: 0.44746503233909607, gen p mean: -0.12370458245277405, mean p set: 0.4480431377887726
loss_pred:0.016900282353162766, decouple_loss:0.0005712555721402168
The modified gen p mean: 0.4465416669845581, gen p mean: -0.11537773907184601, mean p set: 0.4471152722835541
loss_pred:0.016815494745969772, decouple_loss:0.0006580108893103898
Iteration: 69, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674715399742126, gen p mean: -0.12173917144536972, mean p set: 0.4473206102848053
loss_pred:0.01709250546991825, decouple_loss:0.0006328791496343911
The modified gen p mean: 0.4467102587223053, gen p mean: -0.12275276333093643, mean p set: 0.44728490710258484
loss_pred:0.016434622928500175, decouple_loss:0.0006449787761084735
The modified gen p mean: 0.4470645785331726, gen p mean: -0.12279052287340164, mean p set: 0.44764068722724915
loss_pred:0.01672280579805374, decouple_loss:0.0006025820039212704
Iteration: 70, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465571641921997, gen p mean: -0.12541209161281586, mean p set: 0.4471314251422882
loss_pred:0.016792193055152893, decouple_loss:0.0008173396927304566
The modified gen p mean: 0.4464363157749176, gen p mean: -0.12452956289052963, mean p set: 0.44701069593429565
loss_pred:0.016647785902023315, decouple_loss:0.0006293588667176664
The modified gen p mean: 0.4477621912956238, gen p mean: -0.12064609676599503, mean p set: 0.4483358860015869
loss_pred:0.016756495460867882, decouple_loss:0.000752013293094933
2023-05-01 15:33:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12733544409275055, mean p set: 0.4502691626548767
loss_pred:0.017222361639142036, decouple_loss:0.0005638602306134999
The modified gen p mean: 0.449533611536026, gen p mean: -0.12058693170547485, mean p set: 0.4500633478164673
loss_pred:0.016590850427746773, decouple_loss:0.0007131201564334333
The modified gen p mean: 0.44978150725364685, gen p mean: -0.11987005174160004, mean p set: 0.45035696029663086
loss_pred:0.016935769468545914, decouple_loss:0.0007157240179367363
WV_1_PC_1_EH_0_PS_40, loss: 0.016949540004134178, avg_mse: 0.026325184851884842
current test mse: 0.026325
At step 70, Best test: 0.026325
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 71, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456305205821991, gen p mean: -0.11950323730707169, mean p set: 0.44620317220687866
loss_pred:0.01691131852567196, decouple_loss:0.0005048166494816542
The modified gen p mean: 0.4469643235206604, gen p mean: -0.11830752342939377, mean p set: 0.44753962755203247
loss_pred:0.016884135082364082, decouple_loss:0.0005431679310277104
The modified gen p mean: 0.4480544328689575, gen p mean: -0.1196792870759964, mean p set: 0.44863173365592957
loss_pred:0.01631464622914791, decouple_loss:0.0005017471848987043
Iteration: 72, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44718775153160095, gen p mean: -0.12398619204759598, mean p set: 0.4477632939815521
loss_pred:0.017842162400484085, decouple_loss:0.0005658661248162389
The modified gen p mean: 0.44768384099006653, gen p mean: -0.1208166629076004, mean p set: 0.4482572078704834The modified gen p mean: 0.4471427798271179, gen p mean: -0.11884211003780365, mean p set: 0.44771823287010193
loss_pred:0.017014022916555405, decouple_loss:0.0004911386058665812
loss_pred:0.01746833138167858, decouple_loss:0.0006372721400111914
Iteration: 73, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835686683654785, gen p mean: -0.1212049201130867, mean p set: 0.4489297568798065
loss_pred:0.015901796519756317, decouple_loss:0.0005342279328033328
The modified gen p mean: 0.4469509422779083, gen p mean: -0.12551382184028625, mean p set: 0.4475308060646057
loss_pred:0.017109723761677742, decouple_loss:0.0006800257251597941
The modified gen p mean: 0.44893085956573486, gen p mean: -0.1203639805316925, mean p set: 0.4495074450969696
loss_pred:0.01645571179687977, decouple_loss:0.00052981375483796
Iteration: 74, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724541902542114, gen p mean: -0.12544368207454681, mean p set: 0.4478229880332947
loss_pred:0.016102632507681847, decouple_loss:0.000655126292258501
The modified gen p mean: 0.44777101278305054, gen p mean: -0.1193147599697113, mean p set: 0.44834673404693604
loss_pred:0.016497433185577393, decouple_loss:0.0007716998225077987
The modified gen p mean: 0.4480148255825043, gen p mean: -0.12245969474315643, mean p set: 0.44859179854393005
loss_pred:0.01580921746790409, decouple_loss:0.0007594091002829373
Iteration: 75, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774898886680603, gen p mean: -0.12939314544200897, mean p set: 0.4483281373977661
loss_pred:0.017337847501039505, decouple_loss:0.0005780234350822866
The modified gen p mean: 0.4467523694038391, gen p mean: -0.12661103904247284, mean p set: 0.4473278820514679
loss_pred:0.016909779980778694, decouple_loss:0.0006458450225181878
The modified gen p mean: 0.4468505084514618, gen p mean: -0.12324199080467224, mean p set: 0.44742879271507263
loss_pred:0.01774531602859497, decouple_loss:0.0005854603950865567
Iteration: 76, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470703899860382, gen p mean: -0.11869579553604126, mean p set: 0.4476478397846222
loss_pred:0.016678493469953537, decouple_loss:0.0008341443026438355
The modified gen p mean: 0.44745707511901855, gen p mean: -0.12344110012054443, mean p set: 0.4480331242084503
loss_pred:0.016252413392066956, decouple_loss:0.0008858134387992322
The modified gen p mean: 0.4469341039657593, gen p mean: -0.1275019645690918, mean p set: 0.44750818610191345
loss_pred:0.01646810956299305, decouple_loss:0.0009356790687888861
Iteration: 77, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764629006385803, gen p mean: -0.12506194412708282, mean p set: 0.4482213854789734
loss_pred:0.015652164816856384, decouple_loss:0.0006412253133021295
The modified gen p mean: 0.4476296305656433, gen p mean: -0.11953993886709213, mean p set: 0.44820523262023926
loss_pred:0.017331933602690697, decouple_loss:0.0006746153230778873
The modified gen p mean: 0.44779297709465027, gen p mean: -0.12303575128316879, mean p set: 0.44836893677711487
loss_pred:0.016792090609669685, decouple_loss:0.0005723646027036011
Iteration: 78, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462711215019226, gen p mean: -0.12137112021446228, mean p set: 0.44684910774230957
loss_pred:0.017007892951369286, decouple_loss:0.0007583890110254288
The modified gen p mean: 0.4477163851261139, gen p mean: -0.12643851339817047, mean p set: 0.44829070568084717
loss_pred:0.018060414120554924, decouple_loss:0.0008406438282690942
The modified gen p mean: 0.4467765986919403, gen p mean: -0.12488533556461334, mean p set: 0.4473547637462616
loss_pred:0.01610841602087021, decouple_loss:0.0007069644052535295
Iteration: 79, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467771351337433, gen p mean: -0.12011616677045822, mean p set: 0.4473547041416168
loss_pred:0.016843250021338463, decouple_loss:0.0006939262966625392
The modified gen p mean: 0.44787585735321045, gen p mean: -0.12135039269924164, mean p set: 0.4484526515007019
The modified gen p mean: 0.4475274384021759, gen p mean: -0.11990845203399658, mean p set: 0.4481023848056793
loss_pred:0.016896886751055717, decouple_loss:0.0006856209365651011
loss_pred:0.017436780035495758, decouple_loss:0.0005802767118439078
Iteration: 80, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485774636268616, gen p mean: -0.12508442997932434, mean p set: 0.4491514265537262
loss_pred:0.01559681911021471, decouple_loss:0.0006784776924178004
The modified gen p mean: 0.44603216648101807, gen p mean: -0.12189549952745438, mean p set: 0.44660601019859314
loss_pred:0.016123730689287186, decouple_loss:0.0005285934894345701
The modified gen p mean: 0.4464772641658783, gen p mean: -0.1190008670091629, mean p set: 0.4470527172088623
loss_pred:0.017968274652957916, decouple_loss:0.000604363449383527
2023-05-01 15:35:42 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12912388145923615, mean p set: 0.4502691626548767
loss_pred:0.017335720360279083, decouple_loss:0.0005977907567285001
The modified gen p mean: 0.44953688979148865, gen p mean: -0.1222771480679512, mean p set: 0.4500633478164673
loss_pred:0.016604319214820862, decouple_loss:0.0006576410960406065
The modified gen p mean: 0.449779212474823, gen p mean: -0.12189977616071701, mean p set: 0.45035696029663086
loss_pred:0.016915254294872284, decouple_loss:0.0006183916702866554
WV_1_PC_1_EH_0_PS_40, loss: 0.016982994973659515, avg_mse: 0.02637428790330887
current test mse: 0.026374
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012005_3_24hr.npz
NaN value num: 0
Iteration: 81, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498153328895569, gen p mean: -0.12331791967153549, mean p set: 0.4503912329673767
loss_pred:0.0137820178642869, decouple_loss:0.0007220680708996952
The modified gen p mean: 0.45010778307914734, gen p mean: -0.12423646450042725, mean p set: 0.4506858289241791
loss_pred:0.014557452872395515, decouple_loss:0.000939413730520755
The modified gen p mean: 0.4506704807281494, gen p mean: -0.12110166251659393, mean p set: 0.4512515664100647
loss_pred:0.01467595063149929, decouple_loss:0.0008496001246385276
Iteration: 82, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960346817970276, gen p mean: -0.12672805786132812, mean p set: 0.45017769932746887
loss_pred:0.014431935735046864, decouple_loss:0.0004794929700437933
The modified gen p mean: 0.44923698902130127, gen p mean: -0.1306600272655487, mean p set: 0.4498126208782196The modified gen p mean: 0.45048168301582336, gen p mean: -0.12415057420730591, mean p set: 0.45106109976768494
loss_pred:0.01453263871371746, decouple_loss:0.0007000077166594565
loss_pred:0.013982703909277916, decouple_loss:0.0005729148397222161
Iteration: 83, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482751488685608, gen p mean: -0.13172027468681335, mean p set: 0.44884857535362244
loss_pred:0.01500081829726696, decouple_loss:0.0007254688534885645
The modified gen p mean: 0.44949817657470703, gen p mean: -0.12538644671440125, mean p set: 0.45007139444351196
loss_pred:0.015226691961288452, decouple_loss:0.0008345667738467455
The modified gen p mean: 0.44932451844215393, gen p mean: -0.12603455781936646, mean p set: 0.4499005675315857
loss_pred:0.01456085592508316, decouple_loss:0.0007081746007315814
Iteration: 84, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450123131275177, gen p mean: -0.1268986463546753, mean p set: 0.4507005214691162
loss_pred:0.01387935969978571, decouple_loss:0.0007712357328273356
The modified gen p mean: 0.4500677287578583, gen p mean: -0.12569470703601837, mean p set: 0.45064398646354675
loss_pred:0.013502535410225391, decouple_loss:0.0007479426567442715
The modified gen p mean: 0.4478599727153778, gen p mean: -0.1301744282245636, mean p set: 0.44843724370002747
loss_pred:0.014585050754249096, decouple_loss:0.0006839932175353169
Iteration: 85, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018836855888367, gen p mean: -0.1272006779909134, mean p set: 0.45076262950897217
loss_pred:0.014005517587065697, decouple_loss:0.0005537236575037241
The modified gen p mean: 0.4474327862262726, gen p mean: -0.12015338242053986, mean p set: 0.448009192943573
loss_pred:0.014255310408771038, decouple_loss:0.0005957531393505633
The modified gen p mean: 0.45018815994262695, gen p mean: -0.12217558920383453, mean p set: 0.4507656991481781
loss_pred:0.014179653488099575, decouple_loss:0.0007266758475452662
Iteration: 86, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489140212535858, gen p mean: -0.1184212937951088, mean p set: 0.44949066638946533
loss_pred:0.014794203452765942, decouple_loss:0.0007051097927615047
The modified gen p mean: 0.4494670033454895, gen p mean: -0.12174607813358307, mean p set: 0.4500423073768616
The modified gen p mean: 0.44883981347084045, gen p mean: -0.12176612764596939, mean p set: 0.4494141638278961
loss_pred:0.015171253122389317, decouple_loss:0.0008214611443690956
loss_pred:0.01505295280367136, decouple_loss:0.0005935645895078778
Iteration: 87, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489075839519501, gen p mean: -0.1258324533700943, mean p set: 0.4494830369949341
loss_pred:0.014210301451385021, decouple_loss:0.000571397424209863
The modified gen p mean: 0.45002317428588867, gen p mean: -0.12356182187795639, mean p set: 0.4505973160266876
loss_pred:0.01439518854022026, decouple_loss:0.0006065670168027282
The modified gen p mean: 0.4498342275619507, gen p mean: -0.12016474455595016, mean p set: 0.450408935546875
loss_pred:0.014045003801584244, decouple_loss:0.0005191063974052668
Iteration: 88, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905710220336914, gen p mean: -0.1272992193698883, mean p set: 0.4496326744556427
loss_pred:0.014477984979748726, decouple_loss:0.0007286532199941576
The modified gen p mean: 0.44895926117897034, gen p mean: -0.11627605557441711, mean p set: 0.44953563809394836
loss_pred:0.0142719317227602, decouple_loss:0.0008792415610514581
The modified gen p mean: 0.450350284576416, gen p mean: -0.12267079949378967, mean p set: 0.45092666149139404
loss_pred:0.014301169663667679, decouple_loss:0.0008112491341307759
Iteration: 89, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504987299442291, gen p mean: -0.1261790692806244, mean p set: 0.4510750472545624
loss_pred:0.014509987086057663, decouple_loss:0.0007853559218347073
The modified gen p mean: 0.4482148289680481, gen p mean: -0.1207151859998703, mean p set: 0.4487907588481903
loss_pred:0.01466102059930563, decouple_loss:0.0008962922147475183
The modified gen p mean: 0.4493456780910492, gen p mean: -0.13037221133708954, mean p set: 0.4499218463897705
loss_pred:0.014467878267168999, decouple_loss:0.0005451241740956903
Iteration: 90, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487730860710144, gen p mean: -0.12798994779586792, mean p set: 0.4493516683578491
loss_pred:0.015205662697553635, decouple_loss:0.0007991573074832559
The modified gen p mean: 0.45034080743789673, gen p mean: -0.12504786252975464, mean p set: 0.4509190618991852
loss_pred:0.014510094188153744, decouple_loss:0.0009198923944495618
The modified gen p mean: 0.44932183623313904, gen p mean: -0.12827904522418976, mean p set: 0.4498968720436096
loss_pred:0.01357970666140318, decouple_loss:0.0008750043343752623
2023-05-01 15:38:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13149109482765198, mean p set: 0.4502691626548767
loss_pred:0.017309026792645454, decouple_loss:0.0007837173761799932
The modified gen p mean: 0.4495357871055603, gen p mean: -0.12507542967796326, mean p set: 0.4500633478164673
loss_pred:0.01665118709206581, decouple_loss:0.0008110119961202145
The modified gen p mean: 0.4497808516025543, gen p mean: -0.1245528981089592, mean p set: 0.45035696029663086
loss_pred:0.016928017139434814, decouple_loss:0.0006900450098328292
WV_1_PC_1_EH_0_PS_40, loss: 0.017000824213027954, avg_mse: 0.026470234617590904
current test mse: 0.02647
Iteration: 91, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481564164161682, gen p mean: -0.12727569043636322, mean p set: 0.44873154163360596
loss_pred:0.014144274406135082, decouple_loss:0.0006449700449593365
The modified gen p mean: 0.4494149088859558, gen p mean: -0.12135832756757736, mean p set: 0.4499913156032562
loss_pred:0.013854676857590675, decouple_loss:0.0006389737827703357
The modified gen p mean: 0.4504406154155731, gen p mean: -0.12277188897132874, mean p set: 0.4510194957256317
loss_pred:0.013755731284618378, decouple_loss:0.0007119114161469042
Iteration: 92, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493100345134735, gen p mean: -0.1295415759086609, mean p set: 0.4498860538005829
loss_pred:0.014819355681538582, decouple_loss:0.0007814029813744128
The modified gen p mean: 0.44935062527656555, gen p mean: -0.12522007524967194, mean p set: 0.4499257802963257The modified gen p mean: 0.4497601091861725, gen p mean: -0.12176571041345596, mean p set: 0.4503350555896759
loss_pred:0.014476986601948738, decouple_loss:0.0007125093834474683
loss_pred:0.014312608167529106, decouple_loss:0.0007798208389431238
Iteration: 93, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488159418106079, gen p mean: -0.12093456089496613, mean p set: 0.44939103722572327
loss_pred:0.014727888628840446, decouple_loss:0.0006688568973913789
The modified gen p mean: 0.4495573341846466, gen p mean: -0.12113770842552185, mean p set: 0.4501335322856903The modified gen p mean: 0.44897910952568054, gen p mean: -0.12493695318698883, mean p set: 0.4495563805103302
loss_pred:0.013720677234232426, decouple_loss:0.0006767192389816046
loss_pred:0.0144735062494874, decouple_loss:0.0008728231186978519
Iteration: 94, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44867438077926636, gen p mean: -0.1120891347527504, mean p set: 0.4492511451244354
loss_pred:0.015348546206951141, decouple_loss:0.0007992882747203112
The modified gen p mean: 0.44865894317626953, gen p mean: -0.11244385689496994, mean p set: 0.4492337107658386
loss_pred:0.01393707375973463, decouple_loss:0.0007143591647036374
The modified gen p mean: 0.44900718331336975, gen p mean: -0.11903882026672363, mean p set: 0.44958579540252686
loss_pred:0.014570551924407482, decouple_loss:0.000878012680914253
Iteration: 95, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501449763774872, gen p mean: -0.11167638748884201, mean p set: 0.4507233798503876
loss_pred:0.014129968360066414, decouple_loss:0.000743289478123188
The modified gen p mean: 0.4477836489677429, gen p mean: -0.11153141409158707, mean p set: 0.44835996627807617
loss_pred:0.015132931061089039, decouple_loss:0.0007145979907363653
The modified gen p mean: 0.4488266706466675, gen p mean: -0.11397890001535416, mean p set: 0.4494022727012634
loss_pred:0.014980200678110123, decouple_loss:0.0005893475608900189
Iteration: 96, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502459466457367, gen p mean: -0.11343109607696533, mean p set: 0.4508228898048401
loss_pred:0.013597664423286915, decouple_loss:0.0005967429606243968
The modified gen p mean: 0.4485260844230652, gen p mean: -0.11150433868169785, mean p set: 0.4491027593612671
loss_pred:0.014481162652373314, decouple_loss:0.0007763747125864029
The modified gen p mean: 0.44913220405578613, gen p mean: -0.114502914249897, mean p set: 0.449707955121994
loss_pred:0.014293135143816471, decouple_loss:0.000731312669813633
Iteration: 97, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742122292518616, gen p mean: -0.11224915832281113, mean p set: 0.4479977786540985
The modified gen p mean: 0.44714441895484924, gen p mean: -0.1141272783279419, mean p set: 0.4477207064628601loss_pred:0.01405299361795187, decouple_loss:0.0007723069284111261
loss_pred:0.014218466356396675, decouple_loss:0.0008813224267214537
The modified gen p mean: 0.4499731659889221, gen p mean: -0.11337435245513916, mean p set: 0.4505492150783539
loss_pred:0.013681109994649887, decouple_loss:0.0007560834637843072
Iteration: 98, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764119386672974, gen p mean: -0.11163808405399323, mean p set: 0.4482172131538391
loss_pred:0.01408111210912466, decouple_loss:0.000535309431143105
The modified gen p mean: 0.44891098141670227, gen p mean: -0.12350252270698547, mean p set: 0.4494844079017639
The modified gen p mean: 0.449916809797287, gen p mean: -0.11394089460372925, mean p set: 0.4504936933517456
loss_pred:0.014791794121265411, decouple_loss:0.0006470499210990965
loss_pred:0.013320611789822578, decouple_loss:0.0006581883644685149
Iteration: 99, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471077620983124, gen p mean: -0.11618250608444214, mean p set: 0.4476839303970337
loss_pred:0.014152518473565578, decouple_loss:0.0005704661598429084
The modified gen p mean: 0.44835731387138367, gen p mean: -0.11233571171760559, mean p set: 0.4489321708679199
loss_pred:0.013844529166817665, decouple_loss:0.0007052216678857803
The modified gen p mean: 0.4492241442203522, gen p mean: -0.11822515726089478, mean p set: 0.4497992694377899
loss_pred:0.013955371454358101, decouple_loss:0.0006567261880263686
Iteration: 100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960296154022217, gen p mean: -0.11490520089864731, mean p set: 0.4501778185367584
loss_pred:0.014292138628661633, decouple_loss:0.0006806599558331072
The modified gen p mean: 0.44831642508506775, gen p mean: -0.11325737088918686, mean p set: 0.44889214634895325
loss_pred:0.014286108314990997, decouple_loss:0.0006781391566619277
The modified gen p mean: 0.45032355189323425, gen p mean: -0.11870856583118439, mean p set: 0.4508989155292511
loss_pred:0.013556145131587982, decouple_loss:0.0008824817487038672
2023-05-01 15:40:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12461239844560623, mean p set: 0.4502691626548767
loss_pred:0.01724686287343502, decouple_loss:0.0006723410333506763
The modified gen p mean: 0.4495328664779663, gen p mean: -0.11812373250722885, mean p set: 0.4500633478164673
loss_pred:0.016587717458605766, decouple_loss:0.0006360287079587579
The modified gen p mean: 0.44978266954421997, gen p mean: -0.11824482679367065, mean p set: 0.45035696029663086
loss_pred:0.016959045082330704, decouple_loss:0.0006667269044555724
WV_1_PC_1_EH_0_PS_40, loss: 0.016964126378297806, avg_mse: 0.0264410562813282
current test mse: 0.026441
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012019_3_24hr.npz
NaN value num: 0
Iteration: 101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44919055700302124, gen p mean: -0.1160021722316742, mean p set: 0.4497663974761963
loss_pred:0.014886301942169666, decouple_loss:0.0006998326280154288
The modified gen p mean: 0.44787701964378357, gen p mean: -0.11556648463010788, mean p set: 0.44845327734947205
loss_pred:0.014734302647411823, decouple_loss:0.0007405924261547625
The modified gen p mean: 0.44827353954315186, gen p mean: -0.11778289079666138, mean p set: 0.44884949922561646
loss_pred:0.015643484890460968, decouple_loss:0.0005997270345687866
Iteration: 102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491008520126343, gen p mean: -0.11933731287717819, mean p set: 0.44967731833457947
loss_pred:0.01501064095646143, decouple_loss:0.0007422997150570154
The modified gen p mean: 0.4491821825504303, gen p mean: -0.1110883429646492, mean p set: 0.4497552812099457The modified gen p mean: 0.4495769739151001, gen p mean: -0.11582675576210022, mean p set: 0.4501534700393677
loss_pred:0.014858982525765896, decouple_loss:0.0007756027043797076
loss_pred:0.015099744312465191, decouple_loss:0.0005805204273201525
Iteration: 103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864585995674133, gen p mean: -0.12257133424282074, mean p set: 0.449221134185791
loss_pred:0.015210067853331566, decouple_loss:0.0007734621758572757
The modified gen p mean: 0.45080727338790894, gen p mean: -0.11222551763057709, mean p set: 0.45138660073280334
loss_pred:0.014929321594536304, decouple_loss:0.0006971103721298277
The modified gen p mean: 0.44959530234336853, gen p mean: -0.11906354874372482, mean p set: 0.4501734673976898
loss_pred:0.015249011106789112, decouple_loss:0.0006628343835473061
Iteration: 104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479626417160034, gen p mean: -0.11273854225873947, mean p set: 0.4485381245613098
loss_pred:0.015911707654595375, decouple_loss:0.000743625801987946
The modified gen p mean: 0.4495603144168854, gen p mean: -0.11557085812091827, mean p set: 0.45013657212257385
loss_pred:0.014874388463795185, decouple_loss:0.0006533701089210808
The modified gen p mean: 0.4491084814071655, gen p mean: -0.1166277676820755, mean p set: 0.4496835172176361
loss_pred:0.015370030887424946, decouple_loss:0.0006525662611238658
Iteration: 105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500139355659485, gen p mean: -0.10343552380800247, mean p set: 0.4505905210971832
loss_pred:0.015298567712306976, decouple_loss:0.0005691745900548995
The modified gen p mean: 0.448417991399765, gen p mean: -0.11076255142688751, mean p set: 0.448993444442749
loss_pred:0.015153876505792141, decouple_loss:0.0006174563313834369
The modified gen p mean: 0.44829821586608887, gen p mean: -0.1051148995757103, mean p set: 0.4488740861415863
loss_pred:0.015124866738915443, decouple_loss:0.0005851240712217987
Iteration: 106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013266801834106, gen p mean: -0.10390375554561615, mean p set: 0.45070981979370117
The modified gen p mean: 0.4488227069377899, gen p mean: -0.11056268960237503, mean p set: 0.4493984878063202
loss_pred:0.014794821850955486, decouple_loss:0.0006653368473052979
loss_pred:0.015789037570357323, decouple_loss:0.0006713582552038133
The modified gen p mean: 0.4495949149131775, gen p mean: -0.11241501569747925, mean p set: 0.45017269253730774
loss_pred:0.015160303562879562, decouple_loss:0.00064432667568326
Iteration: 107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902312755584717, gen p mean: -0.10663550347089767, mean p set: 0.44959837198257446
loss_pred:0.015465976670384407, decouple_loss:0.0006431555957533419
The modified gen p mean: 0.4488458037376404, gen p mean: -0.10801083594560623, mean p set: 0.4494198262691498
loss_pred:0.01569388434290886, decouple_loss:0.0007868392276577652
The modified gen p mean: 0.44926607608795166, gen p mean: -0.1101890578866005, mean p set: 0.4498424530029297
loss_pred:0.015191092155873775, decouple_loss:0.000649514957331121
Iteration: 108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893357157707214, gen p mean: -0.10690105706453323, mean p set: 0.4495089054107666
loss_pred:0.014999466948211193, decouple_loss:0.0005118870758451521
The modified gen p mean: 0.45056721568107605, gen p mean: -0.1065533384680748, mean p set: 0.451143354177475
The modified gen p mean: 0.44853609800338745, gen p mean: -0.11001944541931152, mean p set: 0.4491119980812073
loss_pred:0.015064147301018238, decouple_loss:0.0006577134481631219
loss_pred:0.015893854200839996, decouple_loss:0.0008328850963152945
Iteration: 109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44908756017684937, gen p mean: -0.11158470064401627, mean p set: 0.4496645927429199
loss_pred:0.014846178703010082, decouple_loss:0.0005079714464955032
The modified gen p mean: 0.4491446912288666, gen p mean: -0.11438939720392227, mean p set: 0.4497183561325073
loss_pred:0.015408703126013279, decouple_loss:0.0007291193469427526
The modified gen p mean: 0.45004352927207947, gen p mean: -0.10880213230848312, mean p set: 0.4506189823150635
loss_pred:0.014901282265782356, decouple_loss:0.0006416024407371879
Iteration: 110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487627446651459, gen p mean: -0.1113879606127739, mean p set: 0.4493391215801239
loss_pred:0.014797122217714787, decouple_loss:0.000585032335948199
The modified gen p mean: 0.45028913021087646, gen p mean: -0.10771796852350235, mean p set: 0.4508661925792694
The modified gen p mean: 0.4483688175678253, gen p mean: -0.1190040111541748, mean p set: 0.4489458501338959
loss_pred:0.014796342700719833, decouple_loss:0.0006786820013076067
loss_pred:0.014792850241065025, decouple_loss:0.0007901713252067566
2023-05-01 15:43:20 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12256859987974167, mean p set: 0.4502691626548767
loss_pred:0.017234686762094498, decouple_loss:0.000761149451136589
The modified gen p mean: 0.44953373074531555, gen p mean: -0.11633405834436417, mean p set: 0.4500633478164673
loss_pred:0.016394400969147682, decouple_loss:0.0010215315269306302
The modified gen p mean: 0.4497794806957245, gen p mean: -0.11671771109104156, mean p set: 0.45035696029663086
loss_pred:0.016801534220576286, decouple_loss:0.0010099293431267142
WV_1_PC_1_EH_0_PS_40, loss: 0.016856752336025238, avg_mse: 0.026231568306684494
current test mse: 0.026232
At step 110, Best test: 0.026232
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499064087867737, gen p mean: -0.11372039467096329, mean p set: 0.4504837691783905
loss_pred:0.01494987029582262, decouple_loss:0.0008177841082215309
The modified gen p mean: 0.44916847348213196, gen p mean: -0.11294862627983093, mean p set: 0.4497471749782562
loss_pred:0.014295956119894981, decouple_loss:0.0007747841300442815
The modified gen p mean: 0.4501989781856537, gen p mean: -0.10833197087049484, mean p set: 0.4507763385772705
loss_pred:0.014534995891153812, decouple_loss:0.0009059359435923398
Iteration: 112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973909854888916, gen p mean: -0.12015974521636963, mean p set: 0.4503171145915985
loss_pred:0.014881490729749203, decouple_loss:0.000578943407163024
The modified gen p mean: 0.4491918087005615, gen p mean: -0.11513134092092514, mean p set: 0.4497673809528351The modified gen p mean: 0.4482775330543518, gen p mean: -0.11287025362253189, mean p set: 0.44885316491127014
loss_pred:0.015244835987687111, decouple_loss:0.0005670436657965183
loss_pred:0.015357209369540215, decouple_loss:0.0006331392796710134
Iteration: 113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937965273857117, gen p mean: -0.10997605323791504, mean p set: 0.44995465874671936
loss_pred:0.014691419899463654, decouple_loss:0.0009616916067898273
The modified gen p mean: 0.4479334354400635, gen p mean: -0.11572439968585968, mean p set: 0.44850999116897583
loss_pred:0.015181729570031166, decouple_loss:0.0008534760563634336
The modified gen p mean: 0.44997501373291016, gen p mean: -0.1098046600818634, mean p set: 0.4505513906478882
loss_pred:0.014439605176448822, decouple_loss:0.0009335341164842248
Iteration: 114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793766736984253, gen p mean: -0.11070942133665085, mean p set: 0.44851261377334595
loss_pred:0.014237778261303902, decouple_loss:0.0006791826453991234
The modified gen p mean: 0.4500914216041565, gen p mean: -0.10923517495393753, mean p set: 0.45066767930984497
loss_pred:0.015197086147964, decouple_loss:0.0006455574184656143
The modified gen p mean: 0.44894325733184814, gen p mean: -0.115024633705616, mean p set: 0.4495182931423187
loss_pred:0.01473424956202507, decouple_loss:0.0006789941107854247
Iteration: 115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072802901268005, gen p mean: -0.10996294766664505, mean p set: 0.45130491256713867
loss_pred:0.014654300175607204, decouple_loss:0.0006372132920660079
The modified gen p mean: 0.44851115345954895, gen p mean: -0.11416655033826828, mean p set: 0.44908788800239563
loss_pred:0.015770062804222107, decouple_loss:0.0006557736778631806
The modified gen p mean: 0.45003029704093933, gen p mean: -0.10827463865280151, mean p set: 0.4506046175956726
loss_pred:0.015108496882021427, decouple_loss:0.0005596947157755494
Iteration: 116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507131278514862, gen p mean: -0.10897752642631531, mean p set: 0.45129016041755676
loss_pred:0.01494715828448534, decouple_loss:0.0005104707670398057
The modified gen p mean: 0.44876569509506226, gen p mean: -0.11074189841747284, mean p set: 0.44934147596359253
loss_pred:0.015238158404827118, decouple_loss:0.0006169061525724828
The modified gen p mean: 0.4496931731700897, gen p mean: -0.11619972437620163, mean p set: 0.4502677023410797
loss_pred:0.015035404823720455, decouple_loss:0.0006865667528472841
Iteration: 117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484913647174835, gen p mean: -0.11224045604467392, mean p set: 0.44906798005104065
loss_pred:0.015064697712659836, decouple_loss:0.0008813595632091165
The modified gen p mean: 0.44917771220207214, gen p mean: -0.109873928129673, mean p set: 0.4497511684894562
The modified gen p mean: 0.4493378698825836, gen p mean: -0.11120573431253433, mean p set: 0.44991418719291687
loss_pred:0.015410948544740677, decouple_loss:0.0006711763562634587
loss_pred:0.014882655814290047, decouple_loss:0.0006418897537514567
Iteration: 118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939127564430237, gen p mean: -0.11426238715648651, mean p set: 0.44996631145477295
loss_pred:0.014562391676008701, decouple_loss:0.0005420797970145941
The modified gen p mean: 0.45049190521240234, gen p mean: -0.10694602876901627, mean p set: 0.45106619596481323
The modified gen p mean: 0.4487326145172119, gen p mean: -0.10741883516311646, mean p set: 0.4493071436882019
loss_pred:0.014179375022649765, decouple_loss:0.0007031001732684672
loss_pred:0.015589957125484943, decouple_loss:0.0007045618258416653
Iteration: 119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955477118492126, gen p mean: -0.10474202781915665, mean p set: 0.45013123750686646
loss_pred:0.014946093782782555, decouple_loss:0.000728597748093307
The modified gen p mean: 0.44813230633735657, gen p mean: -0.10847095400094986, mean p set: 0.44870686531066895
loss_pred:0.016108473762869835, decouple_loss:0.000610434275586158
The modified gen p mean: 0.44968393445014954, gen p mean: -0.11070788651704788, mean p set: 0.45026013255119324
loss_pred:0.01509220153093338, decouple_loss:0.0006121541955508292
Iteration: 120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489149749279022, gen p mean: -0.10949002951383591, mean p set: 0.44949063658714294
loss_pred:0.01479782909154892, decouple_loss:0.0005347098340280354
The modified gen p mean: 0.4491005539894104, gen p mean: -0.10519970208406448, mean p set: 0.4496765732765198
The modified gen p mean: 0.44756370782852173, gen p mean: -0.10669976472854614, mean p set: 0.44813892245292664
loss_pred:0.01550909224897623, decouple_loss:0.0006788731552660465
loss_pred:0.01587938703596592, decouple_loss:0.0006769789033569396
2023-05-01 15:45:34 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11590047180652618, mean p set: 0.4502691626548767
loss_pred:0.01723388209939003, decouple_loss:0.0007291071233339608
The modified gen p mean: 0.44953566789627075, gen p mean: -0.109922394156456, mean p set: 0.4500633478164673
loss_pred:0.01646924950182438, decouple_loss:0.0006215111934579909
The modified gen p mean: 0.4497808516025543, gen p mean: -0.10996390134096146, mean p set: 0.45035696029663086
loss_pred:0.016791198402643204, decouple_loss:0.0006456792470999062
WV_1_PC_1_EH_0_PS_40, loss: 0.0168647151440382, avg_mse: 0.026246927678585052
current test mse: 0.026247
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012016_3_24hr.npz
NaN value num: 0
Iteration: 121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465741813182831, gen p mean: -0.1064988449215889, mean p set: 0.4471484422683716
loss_pred:0.014561534859240055, decouple_loss:0.00079351756721735
The modified gen p mean: 0.4467734694480896, gen p mean: -0.11742442101240158, mean p set: 0.4473494589328766
loss_pred:0.016046512871980667, decouple_loss:0.0006773996283300221
The modified gen p mean: 0.44638609886169434, gen p mean: -0.10839028656482697, mean p set: 0.4469609558582306
loss_pred:0.01440015435218811, decouple_loss:0.0008471292676404119
Iteration: 122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44728416204452515, gen p mean: -0.11231137067079544, mean p set: 0.4478605389595032
loss_pred:0.015631556510925293, decouple_loss:0.001203028718009591
The modified gen p mean: 0.44891953468322754, gen p mean: -0.11474195867776871, mean p set: 0.4494958221912384The modified gen p mean: 0.44931715726852417, gen p mean: -0.1138414517045021, mean p set: 0.44989389181137085
loss_pred:0.015008773654699326, decouple_loss:0.0007706920732744038
loss_pred:0.01445810031145811, decouple_loss:0.0008826190605759621
Iteration: 123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465249180793762, gen p mean: -0.1204887107014656, mean p set: 0.4471015930175781
loss_pred:0.01625106856226921, decouple_loss:0.0014159902930259705
The modified gen p mean: 0.44693830609321594, gen p mean: -0.11473660171031952, mean p set: 0.44751542806625366
loss_pred:0.014605127274990082, decouple_loss:0.0009330084430985153
The modified gen p mean: 0.4465695321559906, gen p mean: -0.11495377868413925, mean p set: 0.44714486598968506
loss_pred:0.014215066097676754, decouple_loss:0.000879198603797704
Iteration: 124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471835792064667, gen p mean: -0.11742275208234787, mean p set: 0.4477604627609253
loss_pred:0.015250922180712223, decouple_loss:0.000733804190531373
The modified gen p mean: 0.44681254029273987, gen p mean: -0.1171816810965538, mean p set: 0.44738900661468506
loss_pred:0.014533020555973053, decouple_loss:0.0008112157229334116
The modified gen p mean: 0.44820651412010193, gen p mean: -0.12453382462263107, mean p set: 0.4487859904766083
loss_pred:0.015140562318265438, decouple_loss:0.0010887811658903956
Iteration: 125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822192192077637, gen p mean: -0.12375175952911377, mean p set: 0.448797345161438
loss_pred:0.015200985595583916, decouple_loss:0.000732665415853262
The modified gen p mean: 0.44619691371917725, gen p mean: -0.12446112930774689, mean p set: 0.44677209854125977
loss_pred:0.015112441033124924, decouple_loss:0.0008767127292230725
The modified gen p mean: 0.44637158513069153, gen p mean: -0.1240159347653389, mean p set: 0.4469473958015442
loss_pred:0.015125153586268425, decouple_loss:0.0007722651935182512
Iteration: 126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740861654281616, gen p mean: -0.11704233288764954, mean p set: 0.44798544049263
loss_pred:0.015667006373405457, decouple_loss:0.000741699303034693
The modified gen p mean: 0.4483291506767273, gen p mean: -0.1250404417514801, mean p set: 0.44890403747558594
The modified gen p mean: 0.44749972224235535, gen p mean: -0.12297993153333664, mean p set: 0.44807443022727966
loss_pred:0.014825725927948952, decouple_loss:0.0006634321762248874
loss_pred:0.014546401798725128, decouple_loss:0.000884905515704304
Iteration: 127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714343547821045, gen p mean: -0.11686774343252182, mean p set: 0.4477183520793915
loss_pred:0.016249563544988632, decouple_loss:0.001151934266090393
The modified gen p mean: 0.4474872052669525, gen p mean: -0.11786212027072906, mean p set: 0.4480628967285156
loss_pred:0.015122699551284313, decouple_loss:0.0007369054947048426
The modified gen p mean: 0.44951266050338745, gen p mean: -0.11660229414701462, mean p set: 0.4500883221626282
loss_pred:0.014414726756513119, decouple_loss:0.0006750121247023344
Iteration: 128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753652811050415, gen p mean: -0.11396690458059311, mean p set: 0.4481140077114105
loss_pred:0.014557264745235443, decouple_loss:0.000893810298293829
The modified gen p mean: 0.44839638471603394, gen p mean: -0.11641648411750793, mean p set: 0.44897395372390747
loss_pred:0.014977936632931232, decouple_loss:0.0006327069131657481
The modified gen p mean: 0.4481523036956787, gen p mean: -0.11387520283460617, mean p set: 0.4487267732620239
loss_pred:0.015023302286863327, decouple_loss:0.0006022442830726504
Iteration: 129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475569725036621, gen p mean: -0.11171936243772507, mean p set: 0.44813334941864014
loss_pred:0.014691313728690147, decouple_loss:0.0008636876591481268
The modified gen p mean: 0.44803759455680847, gen p mean: -0.10390213131904602, mean p set: 0.44861525297164917
The modified gen p mean: 0.4462626576423645, gen p mean: -0.11259258538484573, mean p set: 0.4468388855457306
loss_pred:0.01558429654687643, decouple_loss:0.0010655653895810246
loss_pred:0.015309764072299004, decouple_loss:0.0008260617032647133
Iteration: 130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44753190875053406, gen p mean: -0.10645542293787003, mean p set: 0.4481060206890106
loss_pred:0.015495572239160538, decouple_loss:0.0007709432393312454
The modified gen p mean: 0.4467623233795166, gen p mean: -0.10831674933433533, mean p set: 0.44733917713165283
The modified gen p mean: 0.44706225395202637, gen p mean: -0.10339397937059402, mean p set: 0.4476413428783417
loss_pred:0.015010751783847809, decouple_loss:0.000731924083083868
loss_pred:0.014806088991463184, decouple_loss:0.0006943496991880238
2023-05-01 15:48:18 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11488362401723862, mean p set: 0.4502691626548767
loss_pred:0.017307918518781662, decouple_loss:0.0005587275954894722
The modified gen p mean: 0.44953474402427673, gen p mean: -0.10879573225975037, mean p set: 0.4500633478164673
loss_pred:0.016433298587799072, decouple_loss:0.0007692212238907814
The modified gen p mean: 0.44978147745132446, gen p mean: -0.10910996794700623, mean p set: 0.45035696029663086
loss_pred:0.016797585412859917, decouple_loss:0.0006901532760821283
WV_1_PC_1_EH_0_PS_40, loss: 0.01687990128993988, avg_mse: 0.026270166039466858
current test mse: 0.02627
Iteration: 131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491531252861023, gen p mean: -0.11002608388662338, mean p set: 0.4497283697128296
loss_pred:0.01450855378061533, decouple_loss:0.0006441821460612118
The modified gen p mean: 0.4465057849884033, gen p mean: -0.1120629757642746, mean p set: 0.4470820426940918The modified gen p mean: 0.4479127526283264, gen p mean: -0.10863044112920761, mean p set: 0.4484897553920746
loss_pred:0.015075499191880226, decouple_loss:0.0006794088985770941
loss_pred:0.014916479587554932, decouple_loss:0.0006681571248918772
Iteration: 132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446461945772171, gen p mean: -0.11593682318925858, mean p set: 0.44703981280326843
loss_pred:0.015405185520648956, decouple_loss:0.0005454222555272281
The modified gen p mean: 0.44852301478385925, gen p mean: -0.10912098735570908, mean p set: 0.449098140001297The modified gen p mean: 0.44682419300079346, gen p mean: -0.11239781230688095, mean p set: 0.4473989009857178
loss_pred:0.014992006123065948, decouple_loss:0.0006013673264533281
loss_pred:0.015818607062101364, decouple_loss:0.0006069603259675205
Iteration: 133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788533449172974, gen p mean: -0.11126957088708878, mean p set: 0.44846174120903015
loss_pred:0.014922084286808968, decouple_loss:0.0008222091128118336
The modified gen p mean: 0.4462449252605438, gen p mean: -0.11349257826805115, mean p set: 0.4468221068382263
loss_pred:0.015068624168634415, decouple_loss:0.0007166267605498433
The modified gen p mean: 0.4484233260154724, gen p mean: -0.11247897148132324, mean p set: 0.44899824261665344
loss_pred:0.014530067332088947, decouple_loss:0.000712249951902777
Iteration: 134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745534658432007, gen p mean: -0.10583023726940155, mean p set: 0.44803139567375183
loss_pred:0.015256206505000591, decouple_loss:0.0007024710066616535
The modified gen p mean: 0.446781188249588, gen p mean: -0.10881024599075317, mean p set: 0.4473569989204407
loss_pred:0.01434471644461155, decouple_loss:0.0006487348000518978
The modified gen p mean: 0.44685259461402893, gen p mean: -0.10822398215532303, mean p set: 0.4474294185638428
loss_pred:0.014198651537299156, decouple_loss:0.0006282107206061482
Iteration: 135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766947627067566, gen p mean: -0.11396843940019608, mean p set: 0.4482457637786865
loss_pred:0.014471021480858326, decouple_loss:0.0009969191160053015
The modified gen p mean: 0.4476831555366516, gen p mean: -0.11269747465848923, mean p set: 0.4482575058937073
loss_pred:0.014954586513340473, decouple_loss:0.0008359416387975216
The modified gen p mean: 0.44670552015304565, gen p mean: -0.11136575788259506, mean p set: 0.44728177785873413
loss_pred:0.01542110275477171, decouple_loss:0.0006679645157419145
Iteration: 136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465826153755188, gen p mean: -0.10747718811035156, mean p set: 0.4471592903137207
loss_pred:0.014622526243329048, decouple_loss:0.0007619087700732052
The modified gen p mean: 0.44683265686035156, gen p mean: -0.11123671382665634, mean p set: 0.4474082589149475
loss_pred:0.015979325398802757, decouple_loss:0.0007676407694816589
The modified gen p mean: 0.44679051637649536, gen p mean: -0.11173204332590103, mean p set: 0.44736534357070923
loss_pred:0.015409192070364952, decouple_loss:0.0006746239960193634
Iteration: 137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725552201271057, gen p mean: -0.10363372415304184, mean p set: 0.4478318989276886
loss_pred:0.015521148219704628, decouple_loss:0.0005915946094319224
The modified gen p mean: 0.44835716485977173, gen p mean: -0.10548915714025497, mean p set: 0.4489316940307617
loss_pred:0.014375257305800915, decouple_loss:0.000529984594322741
The modified gen p mean: 0.4475357234477997, gen p mean: -0.10908739268779755, mean p set: 0.4481104910373688
loss_pred:0.01451899204403162, decouple_loss:0.0006070863455533981
Iteration: 138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468673765659332, gen p mean: -0.10691814124584198, mean p set: 0.44744372367858887
loss_pred:0.014969158917665482, decouple_loss:0.0006574966828338802
The modified gen p mean: 0.4473889172077179, gen p mean: -0.10269616544246674, mean p set: 0.4479648470878601
loss_pred:0.014871444553136826, decouple_loss:0.0006846655160188675
The modified gen p mean: 0.44744887948036194, gen p mean: -0.10349248349666595, mean p set: 0.44802284240722656
loss_pred:0.014544336125254631, decouple_loss:0.0006813451182097197
Iteration: 139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762498140335083, gen p mean: -0.10224788635969162, mean p set: 0.44820234179496765
loss_pred:0.015150540508329868, decouple_loss:0.0006408370099961758
The modified gen p mean: 0.4469511806964874, gen p mean: -0.10272930562496185, mean p set: 0.44752857089042664
The modified gen p mean: 0.44695672392845154, gen p mean: -0.1069091409444809, mean p set: 0.44753316044807434
loss_pred:0.014630635268986225, decouple_loss:0.0006913480465300381
loss_pred:0.015866093337535858, decouple_loss:0.0008674389100633562
Iteration: 140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642287492752075, gen p mean: -0.10913378745317459, mean p set: 0.44699788093566895
loss_pred:0.01508473139256239, decouple_loss:0.0005825026892125607
The modified gen p mean: 0.44791972637176514, gen p mean: -0.10800259560346603, mean p set: 0.4484971761703491
loss_pred:0.014217615127563477, decouple_loss:0.0008135073003359139
The modified gen p mean: 0.4468044340610504, gen p mean: -0.09991202503442764, mean p set: 0.44737815856933594
loss_pred:0.014797735027968884, decouple_loss:0.0006962853367440403
2023-05-01 15:50:24 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11127937585115433, mean p set: 0.4502691626548767
loss_pred:0.017269473522901535, decouple_loss:0.0008948272443376482
The modified gen p mean: 0.44953736662864685, gen p mean: -0.10506036877632141, mean p set: 0.4500633478164673
loss_pred:0.016454605385661125, decouple_loss:0.0008586156764067709
The modified gen p mean: 0.44978177547454834, gen p mean: -0.10532745718955994, mean p set: 0.45035696029663086
loss_pred:0.01681758090853691, decouple_loss:0.0007868396351113915
WV_1_PC_1_EH_0_PS_40, loss: 0.016889557242393494, avg_mse: 0.026249179616570473
current test mse: 0.026249
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012008_3_24hr.npz
NaN value num: 0
Iteration: 141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447467178106308, gen p mean: -0.10482492297887802, mean p set: 0.4480440020561218
loss_pred:0.014879727736115456, decouple_loss:0.000620295584667474
The modified gen p mean: 0.44678789377212524, gen p mean: -0.110554039478302, mean p set: 0.4473608434200287
loss_pred:0.015321831218898296, decouple_loss:0.0007704610470682383
The modified gen p mean: 0.44703394174575806, gen p mean: -0.10261121392250061, mean p set: 0.44760966300964355
loss_pred:0.01555639784783125, decouple_loss:0.0007111668237484992
Iteration: 142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642016291618347, gen p mean: -0.10789363831281662, mean p set: 0.44699564576148987
loss_pred:0.015324827283620834, decouple_loss:0.0008614140097051859
The modified gen p mean: 0.4469083845615387, gen p mean: -0.10947825759649277, mean p set: 0.44748565554618835The modified gen p mean: 0.44662004709243774, gen p mean: -0.1037462055683136, mean p set: 0.44719746708869934
loss_pred:0.014747447334229946, decouple_loss:0.0006512639229185879
loss_pred:0.015194868668913841, decouple_loss:0.0008875931962393224
Iteration: 143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44646960496902466, gen p mean: -0.09831808507442474, mean p set: 0.44704607129096985
loss_pred:0.014833370223641396, decouple_loss:0.0005836189957335591
The modified gen p mean: 0.4464259147644043, gen p mean: -0.10176590085029602, mean p set: 0.4470020830631256The modified gen p mean: 0.4476062059402466, gen p mean: -0.09955782443284988, mean p set: 0.44818106293678284
loss_pred:0.015166087076067924, decouple_loss:0.0006476130220107734
loss_pred:0.014823130331933498, decouple_loss:0.000677754869684577
Iteration: 144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44528159499168396, gen p mean: -0.10144012421369553, mean p set: 0.445857435464859
loss_pred:0.015503578819334507, decouple_loss:0.000749441678635776
The modified gen p mean: 0.4465723931789398, gen p mean: -0.1006053015589714, mean p set: 0.4471500515937805
loss_pred:0.01550164632499218, decouple_loss:0.000816959363874048
The modified gen p mean: 0.446027547121048, gen p mean: -0.0961562916636467, mean p set: 0.4466037154197693
loss_pred:0.015451082959771156, decouple_loss:0.000596347264945507
Iteration: 145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455774128437042, gen p mean: -0.10187884420156479, mean p set: 0.4461512565612793
loss_pred:0.014992848969995975, decouple_loss:0.000676013296470046
The modified gen p mean: 0.4459613263607025, gen p mean: -0.09847604483366013, mean p set: 0.44653791189193726
loss_pred:0.015160313807427883, decouple_loss:0.0005717157619073987
The modified gen p mean: 0.4465920627117157, gen p mean: -0.09769470989704132, mean p set: 0.4471670687198639
loss_pred:0.01467048842459917, decouple_loss:0.0005978298140689731
Iteration: 146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472518563270569, gen p mean: -0.10869846493005753, mean p set: 0.44782721996307373
loss_pred:0.01469641737639904, decouple_loss:0.00065652746707201
The modified gen p mean: 0.4470559358596802, gen p mean: -0.10179571062326431, mean p set: 0.4476316571235657
loss_pred:0.015358139760792255, decouple_loss:0.0006140985642559826
The modified gen p mean: 0.44651973247528076, gen p mean: -0.10653917491436005, mean p set: 0.44709545373916626
loss_pred:0.014993875287473202, decouple_loss:0.0006011186633259058
Iteration: 147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459723234176636, gen p mean: -0.10597381740808487, mean p set: 0.4465474784374237
loss_pred:0.014947804622352123, decouple_loss:0.0005970752099528909
The modified gen p mean: 0.44689011573791504, gen p mean: -0.10766136646270752, mean p set: 0.44746461510658264
loss_pred:0.014814568683505058, decouple_loss:0.0006694665062241256
The modified gen p mean: 0.4463364779949188, gen p mean: -0.10670065134763718, mean p set: 0.44691362977027893
loss_pred:0.015021342784166336, decouple_loss:0.0006120904581621289
Iteration: 148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44590139389038086, gen p mean: -0.10349433869123459, mean p set: 0.44647684693336487
loss_pred:0.0157772209495306, decouple_loss:0.0006226360565051436
The modified gen p mean: 0.4467400312423706, gen p mean: -0.10727714002132416, mean p set: 0.4473183751106262
loss_pred:0.015486758202314377, decouple_loss:0.0006919873994775116
The modified gen p mean: 0.44692081212997437, gen p mean: -0.10586480796337128, mean p set: 0.44749704003334045
loss_pred:0.015834346413612366, decouple_loss:0.0006364134605973959
Iteration: 149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464241862297058, gen p mean: -0.10782913118600845, mean p set: 0.4469999372959137
loss_pred:0.01515892893075943, decouple_loss:0.0005986823234707117
The modified gen p mean: 0.44600391387939453, gen p mean: -0.11026103049516678, mean p set: 0.4465794563293457
loss_pred:0.015051711350679398, decouple_loss:0.0005419838125817478
The modified gen p mean: 0.4469562768936157, gen p mean: -0.10639970749616623, mean p set: 0.44753265380859375
loss_pred:0.014662375673651695, decouple_loss:0.0005956055829301476
Iteration: 150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44648477435112, gen p mean: -0.1062990352511406, mean p set: 0.44706007838249207
loss_pred:0.014409493654966354, decouple_loss:0.0006015754770487547
The modified gen p mean: 0.44677409529685974, gen p mean: -0.1071750596165657, mean p set: 0.4473506212234497
loss_pred:0.01518043503165245, decouple_loss:0.000611462164670229
The modified gen p mean: 0.4474932551383972, gen p mean: -0.10424827039241791, mean p set: 0.44806838035583496
loss_pred:0.014380301348865032, decouple_loss:0.0006169724510982633
2023-05-01 15:53:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11007338762283325, mean p set: 0.4502691626548767
loss_pred:0.017261315137147903, decouple_loss:0.0007448256365023553
The modified gen p mean: 0.44953370094299316, gen p mean: -0.10385645925998688, mean p set: 0.4500633478164673
loss_pred:0.016451604664325714, decouple_loss:0.0005761015345342457
The modified gen p mean: 0.4497798681259155, gen p mean: -0.10386285185813904, mean p set: 0.45035696029663086
loss_pred:0.01683763414621353, decouple_loss:0.0006156766321510077
WV_1_PC_1_EH_0_PS_40, loss: 0.016882462427020073, avg_mse: 0.02625158429145813
current test mse: 0.026252
Iteration: 151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467151463031769, gen p mean: -0.10516335070133209, mean p set: 0.44729331135749817
loss_pred:0.015130865387618542, decouple_loss:0.000679788354318589
The modified gen p mean: 0.44601115584373474, gen p mean: -0.10716260224580765, mean p set: 0.44658660888671875The modified gen p mean: 0.44835275411605835, gen p mean: -0.10784279555082321, mean p set: 0.4489297568798065
loss_pred:0.01505015604197979, decouple_loss:0.0006438713171519339
loss_pred:0.014348897151648998, decouple_loss:0.0007721618749201298
Iteration: 152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469623863697052, gen p mean: -0.10192865878343582, mean p set: 0.4475364685058594
loss_pred:0.014457681216299534, decouple_loss:0.0005611932720057666
The modified gen p mean: 0.44602057337760925, gen p mean: -0.10740914940834045, mean p set: 0.44659578800201416The modified gen p mean: 0.4467100203037262, gen p mean: -0.1055048257112503, mean p set: 0.44728413224220276
loss_pred:0.014774315990507603, decouple_loss:0.0005708331009373069
loss_pred:0.014823472127318382, decouple_loss:0.0007148648728616536
Iteration: 153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465278685092926, gen p mean: -0.10012967139482498, mean p set: 0.4471038281917572
loss_pred:0.01525923702865839, decouple_loss:0.000483269221149385
The modified gen p mean: 0.446570485830307, gen p mean: -0.1039382591843605, mean p set: 0.4471467435359955
loss_pred:0.014636545442044735, decouple_loss:0.00047614998766221106
The modified gen p mean: 0.4468543827533722, gen p mean: -0.10148829221725464, mean p set: 0.4474301338195801
loss_pred:0.014774716459214687, decouple_loss:0.0006301000830717385
Iteration: 154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476725459098816, gen p mean: -0.1041804626584053, mean p set: 0.4482450783252716
loss_pred:0.0147771704941988, decouple_loss:0.0005464092246256769
The modified gen p mean: 0.44624611735343933, gen p mean: -0.10661165416240692, mean p set: 0.44682133197784424
loss_pred:0.014835327863693237, decouple_loss:0.00063751928973943
The modified gen p mean: 0.4471570551395416, gen p mean: -0.10316570103168488, mean p set: 0.4477333426475525
loss_pred:0.015747692435979843, decouple_loss:0.0006139270844869316
Iteration: 155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463426172733307, gen p mean: -0.10722985118627548, mean p set: 0.44691479206085205
loss_pred:0.015913330018520355, decouple_loss:0.0007375102140940726
The modified gen p mean: 0.44730687141418457, gen p mean: -0.10612606257200241, mean p set: 0.44788506627082825
loss_pred:0.014693452045321465, decouple_loss:0.000520176428835839
The modified gen p mean: 0.4466836750507355, gen p mean: -0.11122078448534012, mean p set: 0.44726231694221497
loss_pred:0.014645585790276527, decouple_loss:0.00059890141710639
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44507962465286255, gen p mean: -0.11209068447351456, mean p set: 0.44565579295158386
loss_pred:0.014761771075427532, decouple_loss:0.000677116506267339
The modified gen p mean: 0.4462703764438629, gen p mean: -0.11031972616910934, mean p set: 0.446846604347229
loss_pred:0.014782747253775597, decouple_loss:0.0005957361427135766
The modified gen p mean: 0.44784829020500183, gen p mean: -0.11632053554058075, mean p set: 0.44842633605003357
loss_pred:0.014178379438817501, decouple_loss:0.0008225430501624942
Iteration: 157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44624197483062744, gen p mean: -0.11544527858495712, mean p set: 0.446819543838501
loss_pred:0.014962756074965, decouple_loss:0.0007439692271873355
The modified gen p mean: 0.4451080858707428, gen p mean: -0.1126198098063469, mean p set: 0.4456845819950104
loss_pred:0.014958024024963379, decouple_loss:0.0005581398727372289
The modified gen p mean: 0.44660860300064087, gen p mean: -0.11249380558729172, mean p set: 0.447183758020401
loss_pred:0.014986059628427029, decouple_loss:0.0006708005676046014
Iteration: 158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670188426971436, gen p mean: -0.11127568781375885, mean p set: 0.44727569818496704
loss_pred:0.0144431097432971, decouple_loss:0.0006723495898768306
The modified gen p mean: 0.4462343752384186, gen p mean: -0.11656585335731506, mean p set: 0.44680705666542053
loss_pred:0.014942721463739872, decouple_loss:0.0006152009591460228
The modified gen p mean: 0.44664573669433594, gen p mean: -0.11740309000015259, mean p set: 0.44722166657447815
loss_pred:0.014936727471649647, decouple_loss:0.0005617525312118232
Iteration: 159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471496343612671, gen p mean: -0.11157163232564926, mean p set: 0.4477251172065735
loss_pred:0.014863663353025913, decouple_loss:0.0005502861458808184
The modified gen p mean: 0.44670459628105164, gen p mean: -0.1169096827507019, mean p set: 0.44728177785873413
loss_pred:0.014611239545047283, decouple_loss:0.000649428169708699
The modified gen p mean: 0.4467242360115051, gen p mean: -0.11214467883110046, mean p set: 0.44730156660079956
loss_pred:0.014769312925636768, decouple_loss:0.0006910936208441854
Iteration: 160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44521331787109375, gen p mean: -0.11249330639839172, mean p set: 0.44578808546066284
loss_pred:0.014687229879200459, decouple_loss:0.0006239183130674064
The modified gen p mean: 0.4468805193901062, gen p mean: -0.11150792986154556, mean p set: 0.4474572241306305
The modified gen p mean: 0.44750115275382996, gen p mean: -0.11053793132305145, mean p set: 0.44807347655296326
loss_pred:0.01471942663192749, decouple_loss:0.0006262903334572911
loss_pred:0.01458465214818716, decouple_loss:0.0006624574889428914
2023-05-01 15:55:12 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11579985916614532, mean p set: 0.4502691626548767
loss_pred:0.017189912497997284, decouple_loss:0.0006902563036419451
The modified gen p mean: 0.4495345652103424, gen p mean: -0.10993259400129318, mean p set: 0.4500633478164673
loss_pred:0.016518201678991318, decouple_loss:0.0006667835987173021
The modified gen p mean: 0.4497804045677185, gen p mean: -0.10951760411262512, mean p set: 0.45035696029663086
loss_pred:0.016837477684020996, decouple_loss:0.0006637475453317165
WV_1_PC_1_EH_0_PS_40, loss: 0.016882210969924927, avg_mse: 0.02631325274705887
current test mse: 0.026313
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012018_3_24hr.npz
NaN value num: 0
Iteration: 161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44788557291030884, gen p mean: -0.11042983829975128, mean p set: 0.44846177101135254
loss_pred:0.01538094412535429, decouple_loss:0.0007193016936071217
The modified gen p mean: 0.44832202792167664, gen p mean: -0.10803955793380737, mean p set: 0.44889721274375916
loss_pred:0.015201280824840069, decouple_loss:0.0007494358578696847
The modified gen p mean: 0.4471033811569214, gen p mean: -0.11579285562038422, mean p set: 0.4476796090602875
loss_pred:0.015675775706768036, decouple_loss:0.0006837739492766559
Iteration: 162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476987421512604, gen p mean: -0.11438760906457901, mean p set: 0.4482753276824951
loss_pred:0.015964185819029808, decouple_loss:0.0006413990631699562
The modified gen p mean: 0.4477907717227936, gen p mean: -0.11259390413761139, mean p set: 0.44836533069610596The modified gen p mean: 0.44744279980659485, gen p mean: -0.10685072094202042, mean p set: 0.4480193257331848
loss_pred:0.015605096705257893, decouple_loss:0.0006367659661918879loss_pred:0.015328253619372845, decouple_loss:0.0007326138438656926
Iteration: 163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474228620529175, gen p mean: -0.1090935692191124, mean p set: 0.44799885153770447
loss_pred:0.014984474517405033, decouple_loss:0.0006611680728383362
The modified gen p mean: 0.447541207075119, gen p mean: -0.10998789221048355, mean p set: 0.4481166899204254
loss_pred:0.01585342362523079, decouple_loss:0.0006412434740923345
The modified gen p mean: 0.44868525862693787, gen p mean: -0.11471033096313477, mean p set: 0.44926151633262634
loss_pred:0.015296869911253452, decouple_loss:0.0005978973349556327
Iteration: 164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473204016685486, gen p mean: -0.10677428543567657, mean p set: 0.44789719581604004
loss_pred:0.015015569515526295, decouple_loss:0.0005787695408798754
The modified gen p mean: 0.44761574268341064, gen p mean: -0.11087868362665176, mean p set: 0.44819343090057373
loss_pred:0.015428634360432625, decouple_loss:0.0006731861503794789
The modified gen p mean: 0.44763922691345215, gen p mean: -0.11343516409397125, mean p set: 0.4482157230377197
loss_pred:0.015406847931444645, decouple_loss:0.000738124072086066
Iteration: 165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776514172554016, gen p mean: -0.11375986784696579, mean p set: 0.448341965675354
loss_pred:0.015668077394366264, decouple_loss:0.0005922929267399013
The modified gen p mean: 0.4474075734615326, gen p mean: -0.11380985379219055, mean p set: 0.4479837417602539
loss_pred:0.015588875859975815, decouple_loss:0.000770294398535043
The modified gen p mean: 0.4480188488960266, gen p mean: -0.1124902069568634, mean p set: 0.4485950171947479
loss_pred:0.015907442197203636, decouple_loss:0.0006766802398487926
Iteration: 166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479031264781952, gen p mean: -0.11463727802038193, mean p set: 0.44847962260246277
loss_pred:0.015878431499004364, decouple_loss:0.0006450562505051494
The modified gen p mean: 0.44786131381988525, gen p mean: -0.1157086193561554, mean p set: 0.44843557476997375
loss_pred:0.015326960943639278, decouple_loss:0.0006994344876147807
The modified gen p mean: 0.44770675897598267, gen p mean: -0.11354433000087738, mean p set: 0.44828298687934875
loss_pred:0.015999827533960342, decouple_loss:0.0005582812591455877
Iteration: 167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781050086021423, gen p mean: -0.11053692549467087, mean p set: 0.44838589429855347
loss_pred:0.015731319785118103, decouple_loss:0.000717832357622683
The modified gen p mean: 0.44802168011665344, gen p mean: -0.1104230210185051, mean p set: 0.44859760999679565
loss_pred:0.015942052006721497, decouple_loss:0.0007550045847892761
The modified gen p mean: 0.4477563798427582, gen p mean: -0.10945186018943787, mean p set: 0.4483332633972168
loss_pred:0.015358076430857182, decouple_loss:0.0005740662454627454
Iteration: 168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44835469126701355, gen p mean: -0.10977008193731308, mean p set: 0.44892874360084534
loss_pred:0.015100432559847832, decouple_loss:0.0005964563461020589
The modified gen p mean: 0.4477790296077728, gen p mean: -0.11252205818891525, mean p set: 0.4483576714992523
loss_pred:0.015692058950662613, decouple_loss:0.0007243651780299842
The modified gen p mean: 0.44858840107917786, gen p mean: -0.11058325320482254, mean p set: 0.4491655230522156
loss_pred:0.015018876641988754, decouple_loss:0.0009183185175061226
Iteration: 169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790399074554443, gen p mean: -0.10702928155660629, mean p set: 0.4484822154045105
loss_pred:0.015122873708605766, decouple_loss:0.0005675453576259315
The modified gen p mean: 0.44770604372024536, gen p mean: -0.11173010617494583, mean p set: 0.44828253984451294
loss_pred:0.015259791165590286, decouple_loss:0.0006780739640817046
The modified gen p mean: 0.44790342450141907, gen p mean: -0.11386924982070923, mean p set: 0.44847777485847473
loss_pred:0.015220485627651215, decouple_loss:0.0006711661699227989
Iteration: 170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797396659851074, gen p mean: -0.10884120315313339, mean p set: 0.4485490918159485
loss_pred:0.01594928465783596, decouple_loss:0.0007640240946784616
The modified gen p mean: 0.44761738181114197, gen p mean: -0.11195340752601624, mean p set: 0.44819650053977966
loss_pred:0.014702655375003815, decouple_loss:0.0008161414880305529
The modified gen p mean: 0.44782140851020813, gen p mean: -0.10970456153154373, mean p set: 0.44839832186698914
loss_pred:0.014889302663505077, decouple_loss:0.0006580016342923045
2023-05-01 15:57:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11763036996126175, mean p set: 0.4502691626548767
loss_pred:0.017160288989543915, decouple_loss:0.0007002669735811651
The modified gen p mean: 0.4495351314544678, gen p mean: -0.11178404837846756, mean p set: 0.4500633478164673
loss_pred:0.016362382099032402, decouple_loss:0.0007323519675992429
The modified gen p mean: 0.44977959990501404, gen p mean: -0.11135896295309067, mean p set: 0.45035696029663086
loss_pred:0.016817262396216393, decouple_loss:0.0006789289182052016
WV_1_PC_1_EH_0_PS_40, loss: 0.016815170645713806, avg_mse: 0.026194777339696884
current test mse: 0.026195
At step 170, Best test: 0.026195
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796741008758545, gen p mean: -0.11383633315563202, mean p set: 0.44854554533958435
loss_pred:0.014403636567294598, decouple_loss:0.0006245705881156027
The modified gen p mean: 0.44803768396377563, gen p mean: -0.11714792251586914, mean p set: 0.4486139416694641
loss_pred:0.015112897381186485, decouple_loss:0.0006169326952658594
The modified gen p mean: 0.44719231128692627, gen p mean: -0.11808270961046219, mean p set: 0.44776955246925354
loss_pred:0.015304695814847946, decouple_loss:0.0008011923055164516
Iteration: 172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475177526473999, gen p mean: -0.1163499504327774, mean p set: 0.448095440864563
loss_pred:0.014774399809539318, decouple_loss:0.0006394126685336232
The modified gen p mean: 0.44846174120903015, gen p mean: -0.11325395852327347, mean p set: 0.44904080033302307The modified gen p mean: 0.4474567174911499, gen p mean: -0.11879543215036392, mean p set: 0.44802939891815186
loss_pred:0.014657688327133656, decouple_loss:0.0006058390717953444
loss_pred:0.015468569472432137, decouple_loss:0.0006768283201381564
Iteration: 173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780874252319336, gen p mean: -0.11614721268415451, mean p set: 0.44838467240333557
loss_pred:0.014951860532164574, decouple_loss:0.0006502316100522876
The modified gen p mean: 0.44906672835350037, gen p mean: -0.11361081153154373, mean p set: 0.4496433436870575
loss_pred:0.015138239599764347, decouple_loss:0.0005066400044597685
The modified gen p mean: 0.4486657679080963, gen p mean: -0.11254822462797165, mean p set: 0.4492427408695221
loss_pred:0.015026110224425793, decouple_loss:0.0005440089735202491
Iteration: 174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762733578681946, gen p mean: -0.1141081303358078, mean p set: 0.448201984167099
loss_pred:0.01462938729673624, decouple_loss:0.0006378074176609516
The modified gen p mean: 0.44767510890960693, gen p mean: -0.11510637402534485, mean p set: 0.4482516348361969
loss_pred:0.01558563020080328, decouple_loss:0.0008063093991950154
The modified gen p mean: 0.4475317895412445, gen p mean: -0.11584559828042984, mean p set: 0.44810721278190613
loss_pred:0.01517404429614544, decouple_loss:0.0007360813324339688
Iteration: 175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482561945915222, gen p mean: -0.11244089901447296, mean p set: 0.4488312005996704
loss_pred:0.014635779894888401, decouple_loss:0.0005994357052259147
The modified gen p mean: 0.44741958379745483, gen p mean: -0.11229414492845535, mean p set: 0.4479960799217224
loss_pred:0.015412063337862492, decouple_loss:0.0006905161426402628
The modified gen p mean: 0.4481993019580841, gen p mean: -0.11263670772314072, mean p set: 0.448775053024292
loss_pred:0.01587725058197975, decouple_loss:0.000675230985507369
Iteration: 176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471825063228607, gen p mean: -0.11577517539262772, mean p set: 0.4477587640285492
loss_pred:0.015330083668231964, decouple_loss:0.0006446900079026818
The modified gen p mean: 0.4474046230316162, gen p mean: -0.11161871999502182, mean p set: 0.44797900319099426
loss_pred:0.015542144887149334, decouple_loss:0.0006801411509513855
The modified gen p mean: 0.4480186998844147, gen p mean: -0.11172749102115631, mean p set: 0.44859370589256287
loss_pred:0.015337632037699223, decouple_loss:0.001062273746356368
Iteration: 177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480222463607788, gen p mean: -0.11867430806159973, mean p set: 0.44859638810157776
loss_pred:0.01570228487253189, decouple_loss:0.0006119493045844138
The modified gen p mean: 0.44732218980789185, gen p mean: -0.11601567268371582, mean p set: 0.4478999972343445
The modified gen p mean: 0.44773855805397034, gen p mean: -0.11131229251623154, mean p set: 0.4483139216899872
loss_pred:0.015277961269021034, decouple_loss:0.0006073268014006317
loss_pred:0.014830955304205418, decouple_loss:0.0009123733616434038
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870707392692566, gen p mean: -0.11607743799686432, mean p set: 0.44928398728370667
loss_pred:0.015598616562783718, decouple_loss:0.0006958551239222288
The modified gen p mean: 0.4473487436771393, gen p mean: -0.11501150578260422, mean p set: 0.44792643189430237
loss_pred:0.015382868237793446, decouple_loss:0.0006288303411565721
The modified gen p mean: 0.44809672236442566, gen p mean: -0.11806558817625046, mean p set: 0.4486706554889679
loss_pred:0.014663339592516422, decouple_loss:0.0006196105969138443
Iteration: 179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481317102909088, gen p mean: -0.1124427542090416, mean p set: 0.4487065374851227
loss_pred:0.014881745912134647, decouple_loss:0.0007748196367174387
The modified gen p mean: 0.4478560984134674, gen p mean: -0.1118079423904419, mean p set: 0.44843021035194397
loss_pred:0.014864751137793064, decouple_loss:0.0007855459116399288
The modified gen p mean: 0.4476889669895172, gen p mean: -0.11711082607507706, mean p set: 0.44826412200927734
loss_pred:0.015321692451834679, decouple_loss:0.0008012304897420108
Iteration: 180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482317268848419, gen p mean: -0.11415789276361465, mean p set: 0.4488089084625244
loss_pred:0.01534836832433939, decouple_loss:0.0008165718172676861
The modified gen p mean: 0.44703030586242676, gen p mean: -0.1183028519153595, mean p set: 0.4476061165332794
loss_pred:0.015237279236316681, decouple_loss:0.0006212325533851981
The modified gen p mean: 0.44833171367645264, gen p mean: -0.12197023630142212, mean p set: 0.4489077031612396
loss_pred:0.014466994442045689, decouple_loss:0.000675290240906179
2023-05-01 16:00:08 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.11929871141910553, mean p set: 0.4502691626548767
loss_pred:0.017128415405750275, decouple_loss:0.0006791197811253369
The modified gen p mean: 0.44953474402427673, gen p mean: -0.1129186749458313, mean p set: 0.4500633478164673
loss_pred:0.01635609194636345, decouple_loss:0.0007180374232120812
The modified gen p mean: 0.44978225231170654, gen p mean: -0.1124238446354866, mean p set: 0.45035696029663086
loss_pred:0.016826419159770012, decouple_loss:0.0007349973893724382
WV_1_PC_1_EH_0_PS_40, loss: 0.016805846244096756, avg_mse: 0.026146750897169113
current test mse: 0.026147
At step 180, Best test: 0.026147
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012002_3_24hr.npz
NaN value num: 0
Iteration: 181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457089602947235, gen p mean: -0.11595368385314941, mean p set: 0.44628050923347473
loss_pred:0.016602858901023865, decouple_loss:0.0008074771612882614
The modified gen p mean: 0.44653767347335815, gen p mean: -0.1148274689912796, mean p set: 0.44711199402809143
loss_pred:0.01719428226351738, decouple_loss:0.0008198461146093905
The modified gen p mean: 0.4469851851463318, gen p mean: -0.11697424948215485, mean p set: 0.4475610554218292
loss_pred:0.016475725919008255, decouple_loss:0.0008114283555187285
Iteration: 182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468604028224945, gen p mean: -0.10675448179244995, mean p set: 0.44743549823760986
loss_pred:0.016802901402115822, decouple_loss:0.000654781237244606
The modified gen p mean: 0.44867807626724243, gen p mean: -0.11042766273021698, mean p set: 0.44925111532211304The modified gen p mean: 0.44645145535469055, gen p mean: -0.11369737237691879, mean p set: 0.44702741503715515
loss_pred:0.01632869243621826, decouple_loss:0.0006678119534626603
loss_pred:0.01640063337981701, decouple_loss:0.0007513580494560301
Iteration: 183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44685080647468567, gen p mean: -0.10559012740850449, mean p set: 0.44742733240127563
loss_pred:0.01657077670097351, decouple_loss:0.0006090521928854287
The modified gen p mean: 0.4489644169807434, gen p mean: -0.1089811772108078, mean p set: 0.44954198598861694
loss_pred:0.01657712832093239, decouple_loss:0.0008644412737339735
The modified gen p mean: 0.4475753605365753, gen p mean: -0.11217301338911057, mean p set: 0.44815075397491455
loss_pred:0.01622381992638111, decouple_loss:0.0007134742336347699
Iteration: 184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779473543167114, gen p mean: -0.10840577632188797, mean p set: 0.4483734667301178
loss_pred:0.016577238216996193, decouple_loss:0.000622610270511359
The modified gen p mean: 0.44680458307266235, gen p mean: -0.10654991120100021, mean p set: 0.44738173484802246
loss_pred:0.017241718247532845, decouple_loss:0.000614285352639854
The modified gen p mean: 0.4466925263404846, gen p mean: -0.1061917096376419, mean p set: 0.44727015495300293
loss_pred:0.016807973384857178, decouple_loss:0.0005792442825622857
Iteration: 185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661110639572144, gen p mean: -0.10640545934438705, mean p set: 0.4471885859966278
loss_pred:0.016305657103657722, decouple_loss:0.0005323778023011982
The modified gen p mean: 0.44621697068214417, gen p mean: -0.09977322816848755, mean p set: 0.44679397344589233
loss_pred:0.01713494397699833, decouple_loss:0.000558250758331269
The modified gen p mean: 0.4468497633934021, gen p mean: -0.10846879333257675, mean p set: 0.4474274814128876
loss_pred:0.015646472573280334, decouple_loss:0.0008264881907962263
Iteration: 186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458441734313965, gen p mean: -0.10927530378103256, mean p set: 0.4464176893234253
loss_pred:0.016013557091355324, decouple_loss:0.0005203175242058933
The modified gen p mean: 0.4459872543811798, gen p mean: -0.10325303673744202, mean p set: 0.446562796831131
loss_pred:0.016425175592303276, decouple_loss:0.0006450439104810357
The modified gen p mean: 0.44677969813346863, gen p mean: -0.10896988958120346, mean p set: 0.44735464453697205
loss_pred:0.015886373817920685, decouple_loss:0.0006490021478384733
Iteration: 187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463692009449005, gen p mean: -0.10956015437841415, mean p set: 0.446946382522583
loss_pred:0.016841400414705276, decouple_loss:0.0006796478992328048
The modified gen p mean: 0.4471075236797333, gen p mean: -0.10735888034105301, mean p set: 0.4476877748966217
loss_pred:0.01650071144104004, decouple_loss:0.0005985758034512401
The modified gen p mean: 0.4464971721172333, gen p mean: -0.1085299700498581, mean p set: 0.4470725357532501
loss_pred:0.016788991168141365, decouple_loss:0.0006034914404153824
Iteration: 188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671741127967834, gen p mean: -0.11571770906448364, mean p set: 0.44729360938072205
loss_pred:0.01624736562371254, decouple_loss:0.000561965280212462
The modified gen p mean: 0.4463985860347748, gen p mean: -0.1149243488907814, mean p set: 0.44697561860084534
The modified gen p mean: 0.4459458887577057, gen p mean: -0.11615591496229172, mean p set: 0.44652286171913147
loss_pred:0.01623590663075447, decouple_loss:0.0006537495646625757
loss_pred:0.01651044748723507, decouple_loss:0.0006442947778850794
Iteration: 189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44650378823280334, gen p mean: -0.11561569571495056, mean p set: 0.44708189368247986
loss_pred:0.0167158842086792, decouple_loss:0.0005436112987808883
The modified gen p mean: 0.4470236003398895, gen p mean: -0.1218903660774231, mean p set: 0.44760003685951233
The modified gen p mean: 0.4478333592414856, gen p mean: -0.12119214981794357, mean p set: 0.44841188192367554
loss_pred:0.01659815013408661, decouple_loss:0.0004978359793312848
loss_pred:0.016116313636302948, decouple_loss:0.0005718416068702936
Iteration: 190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609618186950684, gen p mean: -0.11879657953977585, mean p set: 0.446674108505249
loss_pred:0.016283895820379257, decouple_loss:0.0006278135697357357
The modified gen p mean: 0.44711652398109436, gen p mean: -0.12296406179666519, mean p set: 0.44769448041915894
loss_pred:0.01597917266190052, decouple_loss:0.0006179509218782187
The modified gen p mean: 0.44819748401641846, gen p mean: -0.12308542430400848, mean p set: 0.448774129152298
loss_pred:0.016523011028766632, decouple_loss:0.0007654319051653147
2023-05-01 16:02:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12601837515830994, mean p set: 0.4502691626548767
loss_pred:0.01729561947286129, decouple_loss:0.000609341892413795
The modified gen p mean: 0.44953417778015137, gen p mean: -0.11951442062854767, mean p set: 0.4500633478164673
loss_pred:0.016503797844052315, decouple_loss:0.0006383823347277939
The modified gen p mean: 0.4497799277305603, gen p mean: -0.11951276659965515, mean p set: 0.45035696029663086
loss_pred:0.016875335946679115, decouple_loss:0.0006543154595419765
WV_1_PC_1_EH_0_PS_40, loss: 0.01692328415811062, avg_mse: 0.02628953382372856
current test mse: 0.02629
Iteration: 191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44711992144584656, gen p mean: -0.12090142071247101, mean p set: 0.4476989805698395
loss_pred:0.0163375623524189, decouple_loss:0.0005265953950583935
The modified gen p mean: 0.4483892023563385, gen p mean: -0.12140904366970062, mean p set: 0.44896358251571655The modified gen p mean: 0.44621166586875916, gen p mean: -0.12603159248828888, mean p set: 0.44678524136543274
loss_pred:0.016281723976135254, decouple_loss:0.0005687546217814088loss_pred:0.016216591000556946, decouple_loss:0.0006021946901455522
Iteration: 192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477073550224304, gen p mean: -0.12720561027526855, mean p set: 0.4482870399951935
loss_pred:0.016521930694580078, decouple_loss:0.0007410428952425718
The modified gen p mean: 0.4477039873600006, gen p mean: -0.12444433569908142, mean p set: 0.4482783079147339The modified gen p mean: 0.44607028365135193, gen p mean: -0.12326620519161224, mean p set: 0.446643590927124
loss_pred:0.016079166904091835, decouple_loss:0.0007480005151592195
loss_pred:0.016363685950636864, decouple_loss:0.0006094523705542088
Iteration: 193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446265310049057, gen p mean: -0.12241224199533463, mean p set: 0.4468423128128052
loss_pred:0.016584288328886032, decouple_loss:0.0005552938091568649
The modified gen p mean: 0.44756144285202026, gen p mean: -0.12641799449920654, mean p set: 0.4481349289417267
loss_pred:0.01655985414981842, decouple_loss:0.0008805975667200983
The modified gen p mean: 0.4455443322658539, gen p mean: -0.12010306864976883, mean p set: 0.44611674547195435
loss_pred:0.01635630987584591, decouple_loss:0.0006359662511385977
Iteration: 194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742366671562195, gen p mean: -0.1300310343503952, mean p set: 0.4479977488517761
loss_pred:0.016792284324765205, decouple_loss:0.0006105920765548944
The modified gen p mean: 0.44577810168266296, gen p mean: -0.12553466856479645, mean p set: 0.44635435938835144
loss_pred:0.015293045900762081, decouple_loss:0.0005987629410810769
The modified gen p mean: 0.44576364755630493, gen p mean: -0.12559346854686737, mean p set: 0.44634005427360535
loss_pred:0.016752053052186966, decouple_loss:0.0006055615958757699
Iteration: 195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44872891902923584, gen p mean: -0.1235087513923645, mean p set: 0.4493103623390198
loss_pred:0.016007088124752045, decouple_loss:0.0008022389374673367
The modified gen p mean: 0.44551390409469604, gen p mean: -0.12402984499931335, mean p set: 0.44608867168426514
loss_pred:0.01657812111079693, decouple_loss:0.0005889461608603597
The modified gen p mean: 0.4461228549480438, gen p mean: -0.1226249411702156, mean p set: 0.4466998875141144
loss_pred:0.01617177575826645, decouple_loss:0.0006045568734407425
Iteration: 196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456065595149994, gen p mean: -0.12237979471683502, mean p set: 0.4461832046508789
loss_pred:0.0164645966142416, decouple_loss:0.0007961480296216905
The modified gen p mean: 0.44628095626831055, gen p mean: -0.12089592963457108, mean p set: 0.4468569755554199
loss_pred:0.016422506421804428, decouple_loss:0.000984896207228303
The modified gen p mean: 0.4459712505340576, gen p mean: -0.117982417345047, mean p set: 0.44654545187950134
loss_pred:0.016661304980516434, decouple_loss:0.0006076160352677107
Iteration: 197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495798945426941, gen p mean: -0.12162824720144272, mean p set: 0.4501565396785736
loss_pred:0.015865148976445198, decouple_loss:0.0005686982767656446
The modified gen p mean: 0.4466330111026764, gen p mean: -0.1272820234298706, mean p set: 0.4472094774246216
loss_pred:0.015327204018831253, decouple_loss:0.0006413648370653391
The modified gen p mean: 0.4471001625061035, gen p mean: -0.12257064133882523, mean p set: 0.447676420211792
loss_pred:0.016530733555555344, decouple_loss:0.0009392790379934013
Iteration: 198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494433104991913, gen p mean: -0.1189676895737648, mean p set: 0.45001867413520813
loss_pred:0.016152217984199524, decouple_loss:0.0007500929059460759
The modified gen p mean: 0.4456336200237274, gen p mean: -0.12359852343797684, mean p set: 0.44620731472969055
loss_pred:0.01707347296178341, decouple_loss:0.0009240145445801318
The modified gen p mean: 0.44565925002098083, gen p mean: -0.12164159119129181, mean p set: 0.4462357461452484
loss_pred:0.016859326511621475, decouple_loss:0.0008016389911063015
Iteration: 199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486694931983948, gen p mean: -0.12234808504581451, mean p set: 0.4492454528808594
loss_pred:0.016544921323657036, decouple_loss:0.0005145702743902802
The modified gen p mean: 0.4456270933151245, gen p mean: -0.12032004445791245, mean p set: 0.44620129466056824
loss_pred:0.01603999175131321, decouple_loss:0.0006210107239894569
The modified gen p mean: 0.44622012972831726, gen p mean: -0.12092310190200806, mean p set: 0.44679519534111023
loss_pred:0.01596374437212944, decouple_loss:0.0005698406603187323
Iteration: 200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724977016448975, gen p mean: -0.12362781912088394, mean p set: 0.4478275179862976
loss_pred:0.015798714011907578, decouple_loss:0.0008134610252454877
The modified gen p mean: 0.4485201835632324, gen p mean: -0.12424896657466888, mean p set: 0.44909629225730896
loss_pred:0.016723757609725, decouple_loss:0.0007267250912263989
The modified gen p mean: 0.44681429862976074, gen p mean: -0.12302746623754501, mean p set: 0.44739121198654175
loss_pred:0.016375554725527763, decouple_loss:0.0006142515921965241
2023-05-01 16:04:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12751561403274536, mean p set: 0.4502691626548767
loss_pred:0.017248131334781647, decouple_loss:0.0006044832989573479
The modified gen p mean: 0.4495363235473633, gen p mean: -0.12141069769859314, mean p set: 0.4500633478164673
loss_pred:0.016534000635147095, decouple_loss:0.0006570240366272628
The modified gen p mean: 0.4497802257537842, gen p mean: -0.12128060311079025, mean p set: 0.45035696029663086
loss_pred:0.016835439950227737, decouple_loss:0.0007426138618029654
WV_1_PC_1_EH_0_PS_40, loss: 0.016905926167964935, avg_mse: 0.026321832090616226
current test mse: 0.026322
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012011_3_24hr.npz
NaN value num: 0
Iteration: 201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737622141838074, gen p mean: -0.1258138120174408, mean p set: 0.447951078414917
loss_pred:0.01521117240190506, decouple_loss:0.0006127366214059293
The modified gen p mean: 0.44741982221603394, gen p mean: -0.12878422439098358, mean p set: 0.44799599051475525
loss_pred:0.015022440813481808, decouple_loss:0.0006273904000408947
The modified gen p mean: 0.4472522735595703, gen p mean: -0.12089775502681732, mean p set: 0.44782623648643494
loss_pred:0.015255727805197239, decouple_loss:0.000799802946858108
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654399156570435, gen p mean: -0.12384223192930222, mean p set: 0.44712045788764954
loss_pred:0.015580564737319946, decouple_loss:0.0005695708678103983
The modified gen p mean: 0.44716763496398926, gen p mean: -0.12675270438194275, mean p set: 0.4477439522743225The modified gen p mean: 0.4466707408428192, gen p mean: -0.11981695890426636, mean p set: 0.447246253490448
loss_pred:0.01512936782091856, decouple_loss:0.0005832617753185332
loss_pred:0.015101885423064232, decouple_loss:0.0005594117101281881
Iteration: 203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458364248275757, gen p mean: -0.12123074382543564, mean p set: 0.4464118480682373
loss_pred:0.01625067926943302, decouple_loss:0.0006010009092278779
The modified gen p mean: 0.44678932428359985, gen p mean: -0.12693199515342712, mean p set: 0.4473665952682495
loss_pred:0.015499623492360115, decouple_loss:0.0006823702715337276
The modified gen p mean: 0.4474961459636688, gen p mean: -0.12466300278902054, mean p set: 0.448073148727417
loss_pred:0.015640288591384888, decouple_loss:0.0009349785395897925
Iteration: 204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44611039757728577, gen p mean: -0.12239400297403336, mean p set: 0.44668781757354736
loss_pred:0.016080031171441078, decouple_loss:0.0006121621117927134
The modified gen p mean: 0.44725385308265686, gen p mean: -0.1265287548303604, mean p set: 0.4478280544281006
loss_pred:0.015494905412197113, decouple_loss:0.0006481821765191853
The modified gen p mean: 0.4466821849346161, gen p mean: -0.1243203729391098, mean p set: 0.44725558161735535
loss_pred:0.01545995008200407, decouple_loss:0.0006564290961250663
Iteration: 205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876036047935486, gen p mean: -0.1266714483499527, mean p set: 0.44933852553367615
loss_pred:0.01591886393725872, decouple_loss:0.0006600667838938534
The modified gen p mean: 0.4468270242214203, gen p mean: -0.12493760883808136, mean p set: 0.4473998546600342
loss_pred:0.015006832778453827, decouple_loss:0.0006436097319237888
The modified gen p mean: 0.44637900590896606, gen p mean: -0.12010134756565094, mean p set: 0.44695523381233215
loss_pred:0.015164058655500412, decouple_loss:0.0005944891599938273
Iteration: 206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458979368209839, gen p mean: -0.12058304995298386, mean p set: 0.44647401571273804
loss_pred:0.015759114176034927, decouple_loss:0.0006757301744073629
The modified gen p mean: 0.4457258880138397, gen p mean: -0.12329016625881195, mean p set: 0.44630685448646545
loss_pred:0.01568872481584549, decouple_loss:0.0007622162229381502
The modified gen p mean: 0.4487029016017914, gen p mean: -0.12890693545341492, mean p set: 0.44927704334259033
loss_pred:0.015457970090210438, decouple_loss:0.0006553037674166262
Iteration: 207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480813443660736, gen p mean: -0.1328580677509308, mean p set: 0.4486584961414337
loss_pred:0.015142354182898998, decouple_loss:0.0007990974700078368
The modified gen p mean: 0.4456804096698761, gen p mean: -0.12771278619766235, mean p set: 0.44625577330589294
loss_pred:0.015402261167764664, decouple_loss:0.0006044874899089336
The modified gen p mean: 0.4484821557998657, gen p mean: -0.13287951052188873, mean p set: 0.4490543007850647
loss_pred:0.015639005228877068, decouple_loss:0.0006631540600210428
Iteration: 208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44623255729675293, gen p mean: -0.13260005414485931, mean p set: 0.44680535793304443
loss_pred:0.014888349920511246, decouple_loss:0.0006270979065448046
The modified gen p mean: 0.44635212421417236, gen p mean: -0.13347063958644867, mean p set: 0.4469289183616638
loss_pred:0.015085116028785706, decouple_loss:0.0005155442049726844
The modified gen p mean: 0.44711583852767944, gen p mean: -0.13228468596935272, mean p set: 0.4476941227912903
loss_pred:0.01541903056204319, decouple_loss:0.0006909603253006935
Iteration: 209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44750699400901794, gen p mean: -0.13261008262634277, mean p set: 0.44808098673820496
loss_pred:0.015577595680952072, decouple_loss:0.0006421092548407614
The modified gen p mean: 0.4473522901535034, gen p mean: -0.13466930389404297, mean p set: 0.4479255974292755
loss_pred:0.015530867502093315, decouple_loss:0.0008357560145668685
The modified gen p mean: 0.4472315013408661, gen p mean: -0.13943879306316376, mean p set: 0.4478095471858978
loss_pred:0.015275401063263416, decouple_loss:0.0005886814324185252
Iteration: 210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484989047050476, gen p mean: -0.1310563087463379, mean p set: 0.44907623529434204
loss_pred:0.01583646610379219, decouple_loss:0.0012019574642181396
The modified gen p mean: 0.44701167941093445, gen p mean: -0.12698520720005035, mean p set: 0.44758522510528564
loss_pred:0.015347742475569248, decouple_loss:0.0005982965230941772
The modified gen p mean: 0.4460509121417999, gen p mean: -0.12405264377593994, mean p set: 0.4466271698474884
loss_pred:0.015056581236422062, decouple_loss:0.0009262314415536821
2023-05-01 16:07:42 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13150490820407867, mean p set: 0.4502691626548767
loss_pred:0.017118681222200394, decouple_loss:0.0006341805565170944
The modified gen p mean: 0.4495353400707245, gen p mean: -0.12530101835727692, mean p set: 0.4500633478164673
loss_pred:0.016505932435393333, decouple_loss:0.0007247750763781369
The modified gen p mean: 0.44978034496307373, gen p mean: -0.12507738173007965, mean p set: 0.45035696029663086
loss_pred:0.016855204477906227, decouple_loss:0.000663203012663871
WV_1_PC_1_EH_0_PS_40, loss: 0.01686030998826027, avg_mse: 0.02626400999724865
current test mse: 0.026264
Iteration: 211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461686611175537, gen p mean: -0.12409190833568573, mean p set: 0.4467402696609497
loss_pred:0.01576174423098564, decouple_loss:0.0006397701217792928
The modified gen p mean: 0.44695478677749634, gen p mean: -0.13064804673194885, mean p set: 0.44752782583236694
loss_pred:0.015422717668116093, decouple_loss:0.000923641724511981
The modified gen p mean: 0.4463757574558258, gen p mean: -0.12828989326953888, mean p set: 0.44694921374320984
loss_pred:0.01527715940028429, decouple_loss:0.0010256166569888592
Iteration: 212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448738157749176, gen p mean: -0.1319778859615326, mean p set: 0.44931700825691223
loss_pred:0.015133057720959187, decouple_loss:0.000906810921151191
The modified gen p mean: 0.4466145932674408, gen p mean: -0.1261010318994522, mean p set: 0.4471926689147949The modified gen p mean: 0.4463171660900116, gen p mean: -0.1288519948720932, mean p set: 0.44689324498176575
loss_pred:0.015735717490315437, decouple_loss:0.000902791041880846loss_pred:0.015250504948198795, decouple_loss:0.0009325211285613477
Iteration: 213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451928436756134, gen p mean: -0.1337125152349472, mean p set: 0.4457697868347168
loss_pred:0.015279310755431652, decouple_loss:0.0010969678405672312
The modified gen p mean: 0.4451638460159302, gen p mean: -0.13268543779850006, mean p set: 0.44573795795440674
loss_pred:0.015182562172412872, decouple_loss:0.0010179742239415646
The modified gen p mean: 0.44807860255241394, gen p mean: -0.1302901655435562, mean p set: 0.44865259528160095
loss_pred:0.014835822395980358, decouple_loss:0.0009540729806758463
Iteration: 214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44736817479133606, gen p mean: -0.13529431819915771, mean p set: 0.44794052839279175
loss_pred:0.014960093423724174, decouple_loss:0.0008511170744895935
The modified gen p mean: 0.44558823108673096, gen p mean: -0.13608255982398987, mean p set: 0.4461652636528015
loss_pred:0.015344640240073204, decouple_loss:0.0007117392960935831
The modified gen p mean: 0.4482036530971527, gen p mean: -0.13332979381084442, mean p set: 0.4487825632095337
loss_pred:0.015193643979728222, decouple_loss:0.0014521669363602996
Iteration: 215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44593319296836853, gen p mean: -0.1249982938170433, mean p set: 0.44651132822036743
loss_pred:0.01600000075995922, decouple_loss:0.0013859152095392346
The modified gen p mean: 0.4473014175891876, gen p mean: -0.12385719269514084, mean p set: 0.44787678122520447
loss_pred:0.015476811677217484, decouple_loss:0.001540317782200873
The modified gen p mean: 0.4479122459888458, gen p mean: -0.13137486577033997, mean p set: 0.448486864566803
loss_pred:0.015357094816863537, decouple_loss:0.0012254576431587338
Iteration: 216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44572943449020386, gen p mean: -0.12718342244625092, mean p set: 0.44630563259124756
loss_pred:0.014702722430229187, decouple_loss:0.0008939803810790181
The modified gen p mean: 0.4461749196052551, gen p mean: -0.12771709263324738, mean p set: 0.44675159454345703
The modified gen p mean: 0.44811028242111206, gen p mean: -0.12973998486995697, mean p set: 0.44868341088294983
loss_pred:0.01505444385111332, decouple_loss:0.0010315485997125506
loss_pred:0.014987912960350513, decouple_loss:0.0011389019200578332
Iteration: 217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455845057964325, gen p mean: -0.13354702293872833, mean p set: 0.4461599588394165
loss_pred:0.015439941547811031, decouple_loss:0.0007182606495916843
The modified gen p mean: 0.44620877504348755, gen p mean: -0.12641996145248413, mean p set: 0.4467838406562805
loss_pred:0.014757392928004265, decouple_loss:0.0006660203216597438
The modified gen p mean: 0.4465840756893158, gen p mean: -0.12801876664161682, mean p set: 0.44715940952301025
loss_pred:0.015376375056803226, decouple_loss:0.0007247801986522973
Iteration: 218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480084478855133, gen p mean: -0.12787821888923645, mean p set: 0.44858697056770325
loss_pred:0.015204843133687973, decouple_loss:0.0008735830779187381
The modified gen p mean: 0.448949933052063, gen p mean: -0.12809614837169647, mean p set: 0.44952791929244995
The modified gen p mean: 0.44672691822052, gen p mean: -0.12756341695785522, mean p set: 0.4473038911819458
loss_pred:0.014840085990726948, decouple_loss:0.0010791157837957144
loss_pred:0.014961902052164078, decouple_loss:0.0009411241044290364
Iteration: 219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460006654262543, gen p mean: -0.12014889717102051, mean p set: 0.4465752840042114
loss_pred:0.015221853740513325, decouple_loss:0.0008706249645911157
The modified gen p mean: 0.4478704631328583, gen p mean: -0.1254136711359024, mean p set: 0.4484470784664154
loss_pred:0.015264220535755157, decouple_loss:0.0006524721975438297
The modified gen p mean: 0.44615980982780457, gen p mean: -0.12382286041975021, mean p set: 0.44673389196395874
loss_pred:0.01480327732861042, decouple_loss:0.0008730160188861191
Iteration: 220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771498441696167, gen p mean: -0.12112394720315933, mean p set: 0.4482913017272949
loss_pred:0.014895658940076828, decouple_loss:0.0008345591486431658
The modified gen p mean: 0.446525901556015, gen p mean: -0.12454576045274734, mean p set: 0.4471011161804199
loss_pred:0.015403259545564651, decouple_loss:0.0007561413221992552
The modified gen p mean: 0.44678235054016113, gen p mean: -0.12088193744421005, mean p set: 0.4473566710948944
loss_pred:0.014805242419242859, decouple_loss:0.0007254896918311715
2023-05-01 16:09:48 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.121192067861557, mean p set: 0.4502691626548767
loss_pred:0.0171565730124712, decouple_loss:0.0008523683645762503
The modified gen p mean: 0.4495333433151245, gen p mean: -0.11533483862876892, mean p set: 0.4500633478164673
loss_pred:0.016534481197595596, decouple_loss:0.0008964065928012133
The modified gen p mean: 0.44978073239326477, gen p mean: -0.11517400294542313, mean p set: 0.45035696029663086
loss_pred:0.016902422532439232, decouple_loss:0.0007904332014732063
WV_1_PC_1_EH_0_PS_40, loss: 0.01690681278705597, avg_mse: 0.02637564204633236
current test mse: 0.026376
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012000_3_24hr.npz
NaN value num: 0
Iteration: 221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474150538444519, gen p mean: -0.11943826079368591, mean p set: 0.44798991084098816
loss_pred:0.01397255714982748, decouple_loss:0.0008375509642064571
The modified gen p mean: 0.446088582277298, gen p mean: -0.11562976986169815, mean p set: 0.4466628134250641
loss_pred:0.015106520615518093, decouple_loss:0.0009919641306623816
The modified gen p mean: 0.4476599097251892, gen p mean: -0.11233773082494736, mean p set: 0.44823670387268066
loss_pred:0.014431058429181576, decouple_loss:0.0009571961709298193
Iteration: 222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473908543586731, gen p mean: -0.11968854069709778, mean p set: 0.4479677379131317
loss_pred:0.014055288396775723, decouple_loss:0.0005619694129563868
The modified gen p mean: 0.4485015273094177, gen p mean: -0.11498123407363892, mean p set: 0.449078768491745The modified gen p mean: 0.4472748935222626, gen p mean: -0.11035814136266708, mean p set: 0.44784975051879883
loss_pred:0.014182042330503464, decouple_loss:0.0007252169889397919
loss_pred:0.014215006493031979, decouple_loss:0.0008140520076267421
Iteration: 223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478408396244049, gen p mean: -0.11076623201370239, mean p set: 0.44841745495796204
loss_pred:0.013926356099545956, decouple_loss:0.000846324663143605
The modified gen p mean: 0.4487561583518982, gen p mean: -0.11665138602256775, mean p set: 0.4493320882320404
loss_pred:0.014363573864102364, decouple_loss:0.0007882873178459704
The modified gen p mean: 0.4477977454662323, gen p mean: -0.11783528327941895, mean p set: 0.4483746588230133
loss_pred:0.014515860937535763, decouple_loss:0.0008767860126681626
Iteration: 224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480893909931183, gen p mean: -0.11917656660079956, mean p set: 0.44866541028022766
loss_pred:0.014613241888582706, decouple_loss:0.0008812964661046863
The modified gen p mean: 0.4490056335926056, gen p mean: -0.11542877554893494, mean p set: 0.4495809078216553
loss_pred:0.014241241849958897, decouple_loss:0.0007428474491462111
The modified gen p mean: 0.4486183822154999, gen p mean: -0.12361790239810944, mean p set: 0.4491964280605316
loss_pred:0.014163306914269924, decouple_loss:0.0007621442782692611
Iteration: 225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44993993639945984, gen p mean: -0.11893326789140701, mean p set: 0.4505167305469513
loss_pred:0.014664465561509132, decouple_loss:0.00076991633977741
The modified gen p mean: 0.4486730694770813, gen p mean: -0.12352100759744644, mean p set: 0.44924888014793396
loss_pred:0.014217628166079521, decouple_loss:0.0007177275838330388
The modified gen p mean: 0.44793257117271423, gen p mean: -0.12021907418966293, mean p set: 0.4485096037387848
loss_pred:0.014511127956211567, decouple_loss:0.0009586972300894558
Iteration: 226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773489236831665, gen p mean: -0.11677422374486923, mean p set: 0.4483111500740051
loss_pred:0.014782845973968506, decouple_loss:0.0009212780278176069
The modified gen p mean: 0.44724810123443604, gen p mean: -0.11527910083532333, mean p set: 0.44782590866088867
loss_pred:0.0146781699731946, decouple_loss:0.0005981050198897719
The modified gen p mean: 0.4463590383529663, gen p mean: -0.12172453105449677, mean p set: 0.4469376802444458
loss_pred:0.01475325133651495, decouple_loss:0.0007386048091575503
Iteration: 227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716396927833557, gen p mean: -0.12192308902740479, mean p set: 0.4477404057979584
loss_pred:0.014508120715618134, decouple_loss:0.0011107450118288398
The modified gen p mean: 0.4500975012779236, gen p mean: -0.1161394715309143, mean p set: 0.4506722390651703
loss_pred:0.013970721513032913, decouple_loss:0.0006124711944721639
The modified gen p mean: 0.44683602452278137, gen p mean: -0.12242447584867477, mean p set: 0.44741132855415344
loss_pred:0.014835206791758537, decouple_loss:0.0011427417630329728
Iteration: 228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478481709957123, gen p mean: -0.11927196383476257, mean p set: 0.44842419028282166
loss_pred:0.014190977439284325, decouple_loss:0.0005188697250559926
The modified gen p mean: 0.4489307701587677, gen p mean: -0.11958298087120056, mean p set: 0.44950512051582336
The modified gen p mean: 0.44805750250816345, gen p mean: -0.12404224276542664, mean p set: 0.44863414764404297
loss_pred:0.01398029550909996, decouple_loss:0.0005676744040101767
loss_pred:0.014033033512532711, decouple_loss:0.000554009631741792
Iteration: 229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473131000995636, gen p mean: -0.11723620444536209, mean p set: 0.4478890001773834
loss_pred:0.0143921272829175, decouple_loss:0.0006502891192212701
The modified gen p mean: 0.44818115234375, gen p mean: -0.12364976853132248, mean p set: 0.4487580358982086
loss_pred:0.013590879738330841, decouple_loss:0.000712406006641686
The modified gen p mean: 0.4472178816795349, gen p mean: -0.12248467653989792, mean p set: 0.4477921724319458
loss_pred:0.014405912719666958, decouple_loss:0.0006096218712627888
Iteration: 230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706782698631287, gen p mean: -0.12128982692956924, mean p set: 0.4476434886455536
loss_pred:0.014197468757629395, decouple_loss:0.0007075165631249547
The modified gen p mean: 0.44923514127731323, gen p mean: -0.11592138558626175, mean p set: 0.4498105049133301
The modified gen p mean: 0.4469178318977356, gen p mean: -0.11749370396137238, mean p set: 0.44749414920806885
loss_pred:0.014643381349742413, decouple_loss:0.0007166692521423101
loss_pred:0.014668073505163193, decouple_loss:0.0007571536698378623
2023-05-01 16:12:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12329035997390747, mean p set: 0.4502691626548767
loss_pred:0.01714354194700718, decouple_loss:0.0009948915103450418
The modified gen p mean: 0.4495382606983185, gen p mean: -0.117869071662426, mean p set: 0.4500633478164673
loss_pred:0.016408640891313553, decouple_loss:0.0008317981846630573
The modified gen p mean: 0.4497799575328827, gen p mean: -0.1174544245004654, mean p set: 0.45035696029663086
loss_pred:0.01688612811267376, decouple_loss:0.0006715948111377656
WV_1_PC_1_EH_0_PS_40, loss: 0.016854409128427505, avg_mse: 0.026234295219182968
current test mse: 0.026234
Iteration: 231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465165436267853, gen p mean: -0.12098605930805206, mean p set: 0.44709157943725586
loss_pred:0.014325542375445366, decouple_loss:0.0006682005478069186
The modified gen p mean: 0.4491947591304779, gen p mean: -0.11658748239278793, mean p set: 0.44976967573165894
loss_pred:0.013956368900835514, decouple_loss:0.0007760760490782559
The modified gen p mean: 0.44878220558166504, gen p mean: -0.12298514693975449, mean p set: 0.4493577182292938
loss_pred:0.013780399225652218, decouple_loss:0.0008247678051702678
Iteration: 232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486701786518097, gen p mean: -0.11579146236181259, mean p set: 0.44924619793891907
loss_pred:0.014210673980414867, decouple_loss:0.0005948205944150686
The modified gen p mean: 0.4468332827091217, gen p mean: -0.1222752034664154, mean p set: 0.44741183519363403
The modified gen p mean: 0.44728904962539673, gen p mean: -0.12113137543201447, mean p set: 0.44786572456359863
loss_pred:0.014302674680948257, decouple_loss:0.0006951148970983922
loss_pred:0.013932483270764351, decouple_loss:0.00048179810983128846
Iteration: 233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44821086525917053, gen p mean: -0.11866093426942825, mean p set: 0.44878509640693665
loss_pred:0.014300107024610043, decouple_loss:0.0007374182459898293
The modified gen p mean: 0.4491201341152191, gen p mean: -0.11486024409532547, mean p set: 0.44969815015792847
loss_pred:0.01422810833901167, decouple_loss:0.0006541666225530207
The modified gen p mean: 0.44677281379699707, gen p mean: -0.12131132930517197, mean p set: 0.4473493695259094
loss_pred:0.014500034041702747, decouple_loss:0.0005798571510240436
Iteration: 234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447561651468277, gen p mean: -0.11720902472734451, mean p set: 0.4481384754180908
loss_pred:0.013585667125880718, decouple_loss:0.0008004262344911695
The modified gen p mean: 0.44814562797546387, gen p mean: -0.1186574399471283, mean p set: 0.4487197697162628
loss_pred:0.014298059977591038, decouple_loss:0.0008217878639698029
The modified gen p mean: 0.4491315186023712, gen p mean: -0.12169269472360611, mean p set: 0.4497106075286865
loss_pred:0.01417845394462347, decouple_loss:0.000540665874723345
Iteration: 235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879889488220215, gen p mean: -0.11827989667654037, mean p set: 0.4493766129016876
loss_pred:0.014066584408283234, decouple_loss:0.0005725406808778644
The modified gen p mean: 0.4491017162799835, gen p mean: -0.12082581222057343, mean p set: 0.4496791362762451
loss_pred:0.01420368067920208, decouple_loss:0.0006253407918848097
The modified gen p mean: 0.44592294096946716, gen p mean: -0.11587508767843246, mean p set: 0.4464992880821228
loss_pred:0.014694350771605968, decouple_loss:0.0006730234599672258
Iteration: 236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482246935367584, gen p mean: -0.12406422942876816, mean p set: 0.44880014657974243
loss_pred:0.01353303249925375, decouple_loss:0.000603397493250668
The modified gen p mean: 0.44928085803985596, gen p mean: -0.11814805865287781, mean p set: 0.44985491037368774
loss_pred:0.014279915951192379, decouple_loss:0.0006650104187428951
The modified gen p mean: 0.4470974802970886, gen p mean: -0.1222650408744812, mean p set: 0.4476757347583771
loss_pred:0.014183598570525646, decouple_loss:0.0006424188613891602
Iteration: 237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496256113052368, gen p mean: -0.11877112090587616, mean p set: 0.45020049810409546
loss_pred:0.013817962259054184, decouple_loss:0.0006618077168241143
The modified gen p mean: 0.44813272356987, gen p mean: -0.12412349134683609, mean p set: 0.4487130343914032
loss_pred:0.014093340374529362, decouple_loss:0.0006598328473046422
The modified gen p mean: 0.44756388664245605, gen p mean: -0.12129872292280197, mean p set: 0.4481406807899475
loss_pred:0.014216583222150803, decouple_loss:0.0005770896677859128
Iteration: 238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471847712993622, gen p mean: -0.11545499414205551, mean p set: 0.447760671377182
loss_pred:0.014250112697482109, decouple_loss:0.0005673267878592014
The modified gen p mean: 0.44890934228897095, gen p mean: -0.11361188441514969, mean p set: 0.44948315620422363
loss_pred:0.014260691590607166, decouple_loss:0.0004926153924316168
The modified gen p mean: 0.44630756974220276, gen p mean: -0.11574779450893402, mean p set: 0.4468816816806793
loss_pred:0.014720357023179531, decouple_loss:0.0006373891956172884
Iteration: 239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448322057723999, gen p mean: -0.11395244300365448, mean p set: 0.4488963484764099
loss_pred:0.014143808744847775, decouple_loss:0.0010260691633448005
The modified gen p mean: 0.44873666763305664, gen p mean: -0.1189529225230217, mean p set: 0.4493098258972168
loss_pred:0.013695333153009415, decouple_loss:0.0007272441871464252
The modified gen p mean: 0.44780853390693665, gen p mean: -0.10967805981636047, mean p set: 0.44838523864746094
loss_pred:0.014669523574411869, decouple_loss:0.0006816234672442079
Iteration: 240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484826922416687, gen p mean: -0.11389840394258499, mean p set: 0.44906049966812134
loss_pred:0.013921328820288181, decouple_loss:0.0006252700695767999
The modified gen p mean: 0.44696006178855896, gen p mean: -0.11742918938398361, mean p set: 0.44753846526145935
The modified gen p mean: 0.4469507336616516, gen p mean: -0.11951270699501038, mean p set: 0.44752633571624756
loss_pred:0.0144600635394454, decouple_loss:0.0005878412630409002
loss_pred:0.013473994098603725, decouple_loss:0.0007317255367524922
2023-05-01 16:14:36 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.1238081082701683, mean p set: 0.4502691626548767
loss_pred:0.017145497724413872, decouple_loss:0.0007131429738365114
The modified gen p mean: 0.44953611493110657, gen p mean: -0.11833885312080383, mean p set: 0.4500633478164673
loss_pred:0.01644425466656685, decouple_loss:0.0007642198470421135
The modified gen p mean: 0.44978398084640503, gen p mean: -0.11795185506343842, mean p set: 0.45035696029663086
loss_pred:0.016887765377759933, decouple_loss:0.0006285776617005467
WV_1_PC_1_EH_0_PS_40, loss: 0.01686093769967556, avg_mse: 0.026282453909516335
current test mse: 0.026282
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012002_3_24hr.npz
NaN value num: 0
Iteration: 241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450103759765625, gen p mean: -0.11429169774055481, mean p set: 0.45067763328552246
loss_pred:0.015598473139107227, decouple_loss:0.0008215883281081915
The modified gen p mean: 0.4488637149333954, gen p mean: -0.11316961795091629, mean p set: 0.4494384825229645
loss_pred:0.01526319794356823, decouple_loss:0.0006083882763050497
The modified gen p mean: 0.4497852027416229, gen p mean: -0.11431057751178741, mean p set: 0.4503614008426666
loss_pred:0.015835249796509743, decouple_loss:0.0007942518568597734
Iteration: 242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494311511516571, gen p mean: -0.1107906848192215, mean p set: 0.4500085711479187
loss_pred:0.01645761728286743, decouple_loss:0.0008474236819893122
The modified gen p mean: 0.45130443572998047, gen p mean: -0.10590115934610367, mean p set: 0.4518806040287018The modified gen p mean: 0.4490453898906708, gen p mean: -0.12037816643714905, mean p set: 0.4496227502822876
loss_pred:0.01597130112349987, decouple_loss:0.0007132859900593758loss_pred:0.014385541900992393, decouple_loss:0.0011580438585951924
Iteration: 243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493362009525299, gen p mean: -0.11085169017314911, mean p set: 0.44991159439086914
loss_pred:0.014841838739812374, decouple_loss:0.0006753088673576713
The modified gen p mean: 0.4497840404510498, gen p mean: -0.12030483782291412, mean p set: 0.4503604471683502
loss_pred:0.014624913223087788, decouple_loss:0.0006161616765893996
The modified gen p mean: 0.4494318664073944, gen p mean: -0.10895760357379913, mean p set: 0.4500081539154053
loss_pred:0.015872180461883545, decouple_loss:0.0006162557401694357
Iteration: 244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511757791042328, gen p mean: -0.1120656356215477, mean p set: 0.45175236463546753
loss_pred:0.01629316806793213, decouple_loss:0.0008111561182886362
The modified gen p mean: 0.44938528537750244, gen p mean: -0.10410811007022858, mean p set: 0.44996196031570435
loss_pred:0.01642777770757675, decouple_loss:0.0007757946732454002
The modified gen p mean: 0.4490374028682709, gen p mean: -0.11400050669908524, mean p set: 0.44961148500442505
loss_pred:0.015273362398147583, decouple_loss:0.0007554666372016072
Iteration: 245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489082396030426, gen p mean: -0.10540502518415451, mean p set: 0.44948339462280273
loss_pred:0.015621150843799114, decouple_loss:0.0007440249319188297
The modified gen p mean: 0.4492834806442261, gen p mean: -0.11014844477176666, mean p set: 0.4498610198497772
loss_pred:0.016348306089639664, decouple_loss:0.0006154952570796013
The modified gen p mean: 0.44981470704078674, gen p mean: -0.10871953517198563, mean p set: 0.45039013028144836
loss_pred:0.015876220539212227, decouple_loss:0.000601524137891829
Iteration: 246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517558217048645, gen p mean: -0.11050260812044144, mean p set: 0.45233187079429626
loss_pred:0.016492748633027077, decouple_loss:0.0006634212913922966
The modified gen p mean: 0.4511709213256836, gen p mean: -0.11376581341028214, mean p set: 0.45174553990364075
loss_pred:0.016217363998293877, decouple_loss:0.0012957280268892646
The modified gen p mean: 0.4500776529312134, gen p mean: -0.11457813531160355, mean p set: 0.45065566897392273
loss_pred:0.01577640138566494, decouple_loss:0.0006914343102835119
Iteration: 247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503624141216278, gen p mean: -0.11403036117553711, mean p set: 0.45093992352485657
loss_pred:0.016300227493047714, decouple_loss:0.0007031558197923005
The modified gen p mean: 0.4495828449726105, gen p mean: -0.12419562041759491, mean p set: 0.4501604735851288
loss_pred:0.01454021967947483, decouple_loss:0.0007842066115699708
The modified gen p mean: 0.4517630636692047, gen p mean: -0.10544935613870621, mean p set: 0.4523402154445648
loss_pred:0.016479382291436195, decouple_loss:0.0006591131677851081
Iteration: 248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495519995689392, gen p mean: -0.12432517111301422, mean p set: 0.4501286447048187
loss_pred:0.014056590385735035, decouple_loss:0.0007074489258229733
The modified gen p mean: 0.4496626555919647, gen p mean: -0.11706561595201492, mean p set: 0.4502403438091278
loss_pred:0.014783189631998539, decouple_loss:0.0005670164828188717
The modified gen p mean: 0.4504026472568512, gen p mean: -0.1114138513803482, mean p set: 0.4509774148464203
loss_pred:0.016368597745895386, decouple_loss:0.0006652691517956555
Iteration: 249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499398469924927, gen p mean: -0.11646117269992828, mean p set: 0.45051491260528564
loss_pred:0.015010288916528225, decouple_loss:0.0006835818057879806
The modified gen p mean: 0.4492059648036957, gen p mean: -0.11687406152486801, mean p set: 0.4497832953929901
loss_pred:0.016114016994833946, decouple_loss:0.0007421407499350607
The modified gen p mean: 0.4489322006702423, gen p mean: -0.1111823096871376, mean p set: 0.44950950145721436
loss_pred:0.015840638428926468, decouple_loss:0.0007252602372318506
Iteration: 250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498005509376526, gen p mean: -0.11499837040901184, mean p set: 0.4503765404224396
loss_pred:0.015810202807188034, decouple_loss:0.0007790143718011677
The modified gen p mean: 0.4520764648914337, gen p mean: -0.11670906841754913, mean p set: 0.45265159010887146
loss_pred:0.015452365390956402, decouple_loss:0.0010436043376103044
The modified gen p mean: 0.4525034725666046, gen p mean: -0.11776979267597198, mean p set: 0.4530782699584961
loss_pred:0.01597652956843376, decouple_loss:0.0009572014096193016
2023-05-01 16:17:18 testing...
The modified gen p mean: 0.4497782289981842, gen p mean: -0.1169155165553093, mean p set: 0.45035696029663086
loss_pred:0.016838770359754562, decouple_loss:0.000615977100096643
The modified gen p mean: 0.4495353400707245, gen p mean: -0.1175851970911026, mean p set: 0.4500633478164673
loss_pred:0.01653992012143135, decouple_loss:0.000724207959137857
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12316982448101044, mean p set: 0.4502691626548767
loss_pred:0.01717817410826683, decouple_loss:0.0008160397410392761
WV_1_PC_1_EH_0_PS_40, loss: 0.016888225451111794, avg_mse: 0.02623113989830017
current test mse: 0.026231
Iteration: 251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920632243156433, gen p mean: -0.11355003714561462, mean p set: 0.44978389143943787
loss_pred:0.014558140188455582, decouple_loss:0.0007124068215489388
The modified gen p mean: 0.44962623715400696, gen p mean: -0.11378149688243866, mean p set: 0.45020246505737305
loss_pred:0.0158906988799572, decouple_loss:0.0005716804298572242
The modified gen p mean: 0.4505302906036377, gen p mean: -0.11242859810590744, mean p set: 0.4511072635650635
loss_pred:0.015878984704613686, decouple_loss:0.0007190341129899025
Iteration: 252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502260386943817, gen p mean: -0.10965777188539505, mean p set: 0.45080122351646423
loss_pred:0.01592639461159706, decouple_loss:0.000705779530107975
The modified gen p mean: 0.44899922609329224, gen p mean: -0.10614006221294403, mean p set: 0.44957494735717773
loss_pred:0.01481130626052618, decouple_loss:0.0006609554402530193
The modified gen p mean: 0.4492359757423401, gen p mean: -0.11348463594913483, mean p set: 0.4498123526573181
loss_pred:0.015605089254677296, decouple_loss:0.000676181516610086
Iteration: 253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514988958835602, gen p mean: -0.09363570064306259, mean p set: 0.45207321643829346
loss_pred:0.016083870083093643, decouple_loss:0.0006241155206225812
The modified gen p mean: 0.4507007896900177, gen p mean: -0.10490293055772781, mean p set: 0.4512771964073181
loss_pred:0.015900496393442154, decouple_loss:0.0006245378172025084
The modified gen p mean: 0.4511222839355469, gen p mean: -0.10116968303918839, mean p set: 0.45169880986213684
loss_pred:0.015906691551208496, decouple_loss:0.0005659459275193512
Iteration: 254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491342604160309, gen p mean: -0.10201086848974228, mean p set: 0.44970813393592834
loss_pred:0.015215054154396057, decouple_loss:0.0007633772911503911
The modified gen p mean: 0.4490930438041687, gen p mean: -0.10649455338716507, mean p set: 0.4496690630912781
loss_pred:0.015014042146503925, decouple_loss:0.0006194169400259852
The modified gen p mean: 0.44962799549102783, gen p mean: -0.10198209434747696, mean p set: 0.45020341873168945
loss_pred:0.01593518629670143, decouple_loss:0.0007892976282164454
Iteration: 255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496995806694031, gen p mean: -0.10981027036905289, mean p set: 0.450275719165802
loss_pred:0.014078045263886452, decouple_loss:0.0006265122210606933
The modified gen p mean: 0.4510461986064911, gen p mean: -0.09841770678758621, mean p set: 0.4516216814517975
loss_pred:0.015908030793070793, decouple_loss:0.0006324605201371014
The modified gen p mean: 0.45110005140304565, gen p mean: -0.10450088232755661, mean p set: 0.451677143573761
loss_pred:0.01610647328197956, decouple_loss:0.0010244754375889897
Iteration: 256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44924604892730713, gen p mean: -0.09864161908626556, mean p set: 0.44982221722602844
loss_pred:0.01618417538702488, decouple_loss:0.0009788228198885918
The modified gen p mean: 0.44936487078666687, gen p mean: -0.11008188128471375, mean p set: 0.44994187355041504
loss_pred:0.014915182255208492, decouple_loss:0.000602046144194901
The modified gen p mean: 0.44898083806037903, gen p mean: -0.11140510439872742, mean p set: 0.4495577812194824
loss_pred:0.015429352410137653, decouple_loss:0.0006714441115036607
Iteration: 257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45102617144584656, gen p mean: -0.10508417338132858, mean p set: 0.4516032636165619
loss_pred:0.015365353785455227, decouple_loss:0.0006543630152009428
The modified gen p mean: 0.4498083293437958, gen p mean: -0.10529916733503342, mean p set: 0.4503854513168335
loss_pred:0.014491892419755459, decouple_loss:0.0006548275705426931
The modified gen p mean: 0.449004203081131, gen p mean: -0.11443682760000229, mean p set: 0.44958019256591797
loss_pred:0.01476624421775341, decouple_loss:0.0006218710914254189
Iteration: 258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490160048007965, gen p mean: -0.1066444143652916, mean p set: 0.4495929181575775
The modified gen p mean: 0.44999852776527405, gen p mean: -0.10762516409158707, mean p set: 0.4505756199359894
loss_pred:0.015576881356537342, decouple_loss:0.0005688476376235485
loss_pred:0.015977930277585983, decouple_loss:0.0005485094152390957
The modified gen p mean: 0.4514870047569275, gen p mean: -0.10967720299959183, mean p set: 0.45206427574157715
loss_pred:0.016078686341643333, decouple_loss:0.0007332355598919094
Iteration: 259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501416087150574, gen p mean: -0.11200384050607681, mean p set: 0.45071735978126526
loss_pred:0.014631998725235462, decouple_loss:0.0005949301412329078
The modified gen p mean: 0.44949033856391907, gen p mean: -0.10557228326797485, mean p set: 0.45006775856018066
loss_pred:0.015735672786831856, decouple_loss:0.0006915323319844902
The modified gen p mean: 0.4512968361377716, gen p mean: -0.11225799471139908, mean p set: 0.45187583565711975
loss_pred:0.016107361763715744, decouple_loss:0.0008650830714032054
Iteration: 260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915780425071716, gen p mean: -0.10630281269550323, mean p set: 0.4497336745262146
loss_pred:0.015412457287311554, decouple_loss:0.0006049108924344182
The modified gen p mean: 0.44968339800834656, gen p mean: -0.11238967627286911, mean p set: 0.4502619802951813
loss_pred:0.0157950296998024, decouple_loss:0.0006860781577415764
The modified gen p mean: 0.45142441987991333, gen p mean: -0.10622380673885345, mean p set: 0.45200085639953613
loss_pred:0.015370422042906284, decouple_loss:0.0006538846646435559
2023-05-01 16:19:24 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12013349682092667, mean p set: 0.4502691626548767
loss_pred:0.01718364842236042, decouple_loss:0.0007328367792069912
The modified gen p mean: 0.44953402876853943, gen p mean: -0.11388663947582245, mean p set: 0.4500633478164673
loss_pred:0.016628693789243698, decouple_loss:0.0007245113956741989
The modified gen p mean: 0.449781209230423, gen p mean: -0.11336402595043182, mean p set: 0.45035696029663086
loss_pred:0.01690845564007759, decouple_loss:0.0007826790097169578
WV_1_PC_1_EH_0_PS_40, loss: 0.016944266855716705, avg_mse: 0.026282398030161858
current test mse: 0.026282
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012008_3_24hr.npz
NaN value num: 0
Iteration: 261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517458975315094, gen p mean: -0.10741744935512543, mean p set: 0.45232194662094116
loss_pred:0.015752233564853668, decouple_loss:0.0007887176470831037
The modified gen p mean: 0.448650985956192, gen p mean: -0.1098140999674797, mean p set: 0.44922736287117004
loss_pred:0.015964368358254433, decouple_loss:0.0006889241049066186
The modified gen p mean: 0.4504944980144501, gen p mean: -0.10606198012828827, mean p set: 0.45107173919677734
loss_pred:0.015474686399102211, decouple_loss:0.0005707189557142556
Iteration: 262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44942906498908997, gen p mean: -0.11206869035959244, mean p set: 0.4500034749507904
loss_pred:0.01633613184094429, decouple_loss:0.0005999438581056893
The modified gen p mean: 0.45136600732803345, gen p mean: -0.10581670701503754, mean p set: 0.45194414258003235The modified gen p mean: 0.450891375541687, gen p mean: -0.10137521475553513, mean p set: 0.4514676034450531
loss_pred:0.015221156179904938, decouple_loss:0.000631794158834964
loss_pred:0.015506736002862453, decouple_loss:0.000605102046392858
Iteration: 263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44950544834136963, gen p mean: -0.10576756298542023, mean p set: 0.45008331537246704
loss_pred:0.015154743567109108, decouple_loss:0.0006336691440083086
The modified gen p mean: 0.449847936630249, gen p mean: -0.10202092677354813, mean p set: 0.4504234194755554The modified gen p mean: 0.4504099190235138, gen p mean: -0.11029758304357529, mean p set: 0.450985848903656
loss_pred:0.01662055216729641, decouple_loss:0.0005515048978850245
loss_pred:0.015482222661376, decouple_loss:0.0005752516444772482
Iteration: 264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489281475543976, gen p mean: -0.10728926956653595, mean p set: 0.4495048522949219
loss_pred:0.015452280640602112, decouple_loss:0.0007257849792949855
The modified gen p mean: 0.4503134489059448, gen p mean: -0.09908251464366913, mean p set: 0.45089030265808105
loss_pred:0.015824351459741592, decouple_loss:0.0006236245390027761
The modified gen p mean: 0.4495607316493988, gen p mean: -0.0994725301861763, mean p set: 0.45013532042503357
loss_pred:0.016316387802362442, decouple_loss:0.0006899898289702833
Iteration: 265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525955319404602, gen p mean: -0.10259826481342316, mean p set: 0.4531742036342621
loss_pred:0.016112715005874634, decouple_loss:0.00084729737136513
The modified gen p mean: 0.449308842420578, gen p mean: -0.10594461858272552, mean p set: 0.44988515973091125
loss_pred:0.015442539937794209, decouple_loss:0.0005844560218974948
The modified gen p mean: 0.4494907557964325, gen p mean: -0.10724852979183197, mean p set: 0.45006799697875977
loss_pred:0.014745965600013733, decouple_loss:0.0006280594388954341
Iteration: 266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953322410583496, gen p mean: -0.10259102284908295, mean p set: 0.45011085271835327
loss_pred:0.016565890982747078, decouple_loss:0.0011037997901439667
The modified gen p mean: 0.4498067796230316, gen p mean: -0.11241182684898376, mean p set: 0.4503830373287201
loss_pred:0.014560219831764698, decouple_loss:0.0008250087848864496
The modified gen p mean: 0.4503635764122009, gen p mean: -0.11203034967184067, mean p set: 0.45094096660614014
loss_pred:0.015281359665095806, decouple_loss:0.0007074452005326748
Iteration: 267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517040252685547, gen p mean: -0.10376003384590149, mean p set: 0.45227932929992676
loss_pred:0.016148094087839127, decouple_loss:0.0007233024807646871
The modified gen p mean: 0.44892558455467224, gen p mean: -0.10859886556863785, mean p set: 0.4495026767253876
The modified gen p mean: 0.44929975271224976, gen p mean: -0.109540194272995, mean p set: 0.44988009333610535
loss_pred:0.014635969884693623, decouple_loss:0.0007215171353891492
loss_pred:0.01451647374778986, decouple_loss:0.0007851708796806633
Iteration: 268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45030295848846436, gen p mean: -0.10523763298988342, mean p set: 0.4508790671825409
loss_pred:0.01563362590968609, decouple_loss:0.0006973172421567142
The modified gen p mean: 0.44877177476882935, gen p mean: -0.10657890141010284, mean p set: 0.4493463933467865
The modified gen p mean: 0.4503169357776642, gen p mean: -0.11274044215679169, mean p set: 0.4508911669254303
loss_pred:0.016094034537672997, decouple_loss:0.0008415383053943515
loss_pred:0.015192234888672829, decouple_loss:0.0007927154074423015
Iteration: 269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113304257392883, gen p mean: -0.10785696655511856, mean p set: 0.45171138644218445
loss_pred:0.01573825441300869, decouple_loss:0.0006739210220985115
The modified gen p mean: 0.451919823884964, gen p mean: -0.11266496032476425, mean p set: 0.4524949789047241
loss_pred:0.015176067128777504, decouple_loss:0.0006750316242687404
The modified gen p mean: 0.4491550326347351, gen p mean: -0.11476725339889526, mean p set: 0.4497282803058624
loss_pred:0.015214317478239536, decouple_loss:0.0007135531050153077
Iteration: 270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518042504787445, gen p mean: -0.11434642225503922, mean p set: 0.4523826837539673
loss_pred:0.015810756012797356, decouple_loss:0.0005917052621953189
The modified gen p mean: 0.45229166746139526, gen p mean: -0.10433924198150635, mean p set: 0.45286887884140015
loss_pred:0.01523180864751339, decouple_loss:0.0009033908136188984
The modified gen p mean: 0.450267493724823, gen p mean: -0.11406803876161575, mean p set: 0.45084765553474426
loss_pred:0.015047566033899784, decouple_loss:0.0005460805259644985
2023-05-01 16:22:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12317817658185959, mean p set: 0.4502691626548767
loss_pred:0.017141956835985184, decouple_loss:0.000754546606913209
The modified gen p mean: 0.4495347738265991, gen p mean: -0.11662469804286957, mean p set: 0.4500633478164673
loss_pred:0.016660554334521294, decouple_loss:0.0006138408207334578
The modified gen p mean: 0.4497791826725006, gen p mean: -0.11674904078245163, mean p set: 0.45035696029663086
loss_pred:0.016960155218839645, decouple_loss:0.0006652576266787946
WV_1_PC_1_EH_0_PS_40, loss: 0.016954783350229263, avg_mse: 0.026311544701457024
current test mse: 0.026312
Iteration: 271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509463906288147, gen p mean: -0.10790587961673737, mean p set: 0.4515224099159241
loss_pred:0.01606043428182602, decouple_loss:0.0006247891578823328
The modified gen p mean: 0.44896578788757324, gen p mean: -0.11407961696386337, mean p set: 0.44954198598861694The modified gen p mean: 0.44931188225746155, gen p mean: -0.1214057058095932, mean p set: 0.44988757371902466
loss_pred:0.015627168118953705, decouple_loss:0.000616850215010345
loss_pred:0.014561686664819717, decouple_loss:0.0006510089733637869
Iteration: 272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498775005340576, gen p mean: -0.11956848949193954, mean p set: 0.4504542350769043
loss_pred:0.01526015717536211, decouple_loss:0.0006969929090701044
The modified gen p mean: 0.4484723210334778, gen p mean: -0.11245068907737732, mean p set: 0.44904735684394836The modified gen p mean: 0.4501108229160309, gen p mean: -0.10935748368501663, mean p set: 0.45068594813346863
loss_pred:0.014607503078877926, decouple_loss:0.0005952260689809918
loss_pred:0.015073848888278008, decouple_loss:0.0007665797602385283
Iteration: 273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45195454359054565, gen p mean: -0.1037888377904892, mean p set: 0.45253291726112366
loss_pred:0.015459854155778885, decouple_loss:0.0006554697756655514
The modified gen p mean: 0.45290714502334595, gen p mean: -0.10480528324842453, mean p set: 0.45348381996154785
loss_pred:0.015716949477791786, decouple_loss:0.0007428661920130253
The modified gen p mean: 0.4495122730731964, gen p mean: -0.10550131648778915, mean p set: 0.4500887989997864
loss_pred:0.015165158547461033, decouple_loss:0.000525340554304421
Iteration: 274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485261142253876, gen p mean: -0.11263338476419449, mean p set: 0.44910362362861633
loss_pred:0.0151596087962389, decouple_loss:0.0006059419829398394
The modified gen p mean: 0.44912999868392944, gen p mean: -0.11501013487577438, mean p set: 0.4497041702270508
loss_pred:0.014773567207157612, decouple_loss:0.0006094968412071466
The modified gen p mean: 0.45040959119796753, gen p mean: -0.11587843298912048, mean p set: 0.4509873688220978
loss_pred:0.014821208082139492, decouple_loss:0.0007049643900245428
Iteration: 275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487732946872711, gen p mean: -0.11292897164821625, mean p set: 0.44935014843940735
loss_pred:0.014419111423194408, decouple_loss:0.0008866574498824775
The modified gen p mean: 0.4516904354095459, gen p mean: -0.10932982712984085, mean p set: 0.45227181911468506
loss_pred:0.015698052942752838, decouple_loss:0.0007442450732924044
The modified gen p mean: 0.45098811388015747, gen p mean: -0.10734609514474869, mean p set: 0.45156344771385193
loss_pred:0.015414208173751831, decouple_loss:0.0007169452728703618
Iteration: 276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499324560165405, gen p mean: -0.11696155369281769, mean p set: 0.4505097270011902
loss_pred:0.015109502710402012, decouple_loss:0.0006957201403565705
The modified gen p mean: 0.45132094621658325, gen p mean: -0.10556274652481079, mean p set: 0.45189690589904785
loss_pred:0.014850231818854809, decouple_loss:0.0005977822002023458
The modified gen p mean: 0.4514288902282715, gen p mean: -0.10970492660999298, mean p set: 0.45200514793395996
loss_pred:0.015643032267689705, decouple_loss:0.0005351900472305715
Iteration: 277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522482454776764, gen p mean: -0.09846901893615723, mean p set: 0.45282456278800964
loss_pred:0.015516377054154873, decouple_loss:0.0008468451560474932
The modified gen p mean: 0.448504239320755, gen p mean: -0.10510081052780151, mean p set: 0.44908010959625244
The modified gen p mean: 0.4520138204097748, gen p mean: -0.09573382884263992, mean p set: 0.4525914490222931
loss_pred:0.01561855711042881, decouple_loss:0.0006240612710826099
loss_pred:0.01561789307743311, decouple_loss:0.0009404640295542777
Iteration: 278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492727220058441, gen p mean: -0.10219799727201462, mean p set: 0.4498482048511505
loss_pred:0.015614577569067478, decouple_loss:0.0006824322044849396
The modified gen p mean: 0.4496942460536957, gen p mean: -0.0977666899561882, mean p set: 0.45027193427085876
loss_pred:0.015584642067551613, decouple_loss:0.000640943821053952
The modified gen p mean: 0.4488730728626251, gen p mean: -0.10040707141160965, mean p set: 0.4494488537311554
loss_pred:0.014722527004778385, decouple_loss:0.000528522243257612
Iteration: 279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947147369384766, gen p mean: -0.09491803497076035, mean p set: 0.4500472843647003
loss_pred:0.015943655744194984, decouple_loss:0.0006455489783547819
The modified gen p mean: 0.44965410232543945, gen p mean: -0.10152143985033035, mean p set: 0.45023199915885925
loss_pred:0.014787514694035053, decouple_loss:0.0005491261836141348
The modified gen p mean: 0.45214179158210754, gen p mean: -0.0961420014500618, mean p set: 0.4527186155319214
loss_pred:0.014926041476428509, decouple_loss:0.000571375829167664
Iteration: 280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500728249549866, gen p mean: -0.09812839329242706, mean p set: 0.450647234916687
loss_pred:0.015288346447050571, decouple_loss:0.0008597932755947113
The modified gen p mean: 0.45171019434928894, gen p mean: -0.09757416695356369, mean p set: 0.45228907465934753
loss_pred:0.015489733777940273, decouple_loss:0.0009950974490493536
The modified gen p mean: 0.45138126611709595, gen p mean: -0.09544535726308823, mean p set: 0.4519574046134949
loss_pred:0.015454164706170559, decouple_loss:0.0008086665184237063
2023-05-01 16:24:14 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11321492493152618, mean p set: 0.4502691626548767
loss_pred:0.01716245338320732, decouple_loss:0.0006804823642596602
The modified gen p mean: 0.44953712821006775, gen p mean: -0.10684772580862045, mean p set: 0.4500633478164673
loss_pred:0.016635458916425705, decouple_loss:0.000621605315245688
The modified gen p mean: 0.44978195428848267, gen p mean: -0.10687784105539322, mean p set: 0.45035696029663086
loss_pred:0.016938477754592896, decouple_loss:0.0006810508784838021
WV_1_PC_1_EH_0_PS_40, loss: 0.016945183277130127, avg_mse: 0.026290474459528923
current test mse: 0.02629
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012015_3_24hr.npz
NaN value num: 0
Iteration: 281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471937119960785, gen p mean: -0.11012880504131317, mean p set: 0.44777119159698486
loss_pred:0.01607346162199974, decouple_loss:0.0007491011056117713
The modified gen p mean: 0.4472285211086273, gen p mean: -0.10231184959411621, mean p set: 0.44780370593070984
loss_pred:0.01617700234055519, decouple_loss:0.0007120636873878539
The modified gen p mean: 0.4476566016674042, gen p mean: -0.11107306182384491, mean p set: 0.4482314884662628
loss_pred:0.015415860339999199, decouple_loss:0.0006373252836056054
Iteration: 282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476976692676544, gen p mean: -0.10895881801843643, mean p set: 0.44827160239219666
loss_pred:0.016445640474557877, decouple_loss:0.0008975300588645041
The modified gen p mean: 0.44886428117752075, gen p mean: -0.10282094031572342, mean p set: 0.44944167137145996The modified gen p mean: 0.44894158840179443, gen p mean: -0.11002908647060394, mean p set: 0.44951605796813965
loss_pred:0.01537672895938158, decouple_loss:0.0006948314257897437
loss_pred:0.015268255956470966, decouple_loss:0.0006347706657834351
Iteration: 283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44631829857826233, gen p mean: -0.11941856890916824, mean p set: 0.44689464569091797
loss_pred:0.015905002132058144, decouple_loss:0.0006360238767229021
The modified gen p mean: 0.4480920135974884, gen p mean: -0.11604222655296326, mean p set: 0.4486686885356903
loss_pred:0.01591484062373638, decouple_loss:0.0007791714160703123
The modified gen p mean: 0.44705867767333984, gen p mean: -0.116339311003685, mean p set: 0.4476326107978821
loss_pred:0.015030457638204098, decouple_loss:0.0007050479180179536
Iteration: 284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478914439678192, gen p mean: -0.12069136649370193, mean p set: 0.448468953371048
loss_pred:0.015856390818953514, decouple_loss:0.0006865771720185876
The modified gen p mean: 0.4482608735561371, gen p mean: -0.11901049315929413, mean p set: 0.4488369822502136
loss_pred:0.01538671925663948, decouple_loss:0.0006604889058507979
The modified gen p mean: 0.44927528500556946, gen p mean: -0.11740577965974808, mean p set: 0.44985130429267883
loss_pred:0.01524936594069004, decouple_loss:0.0006219060742296278
Iteration: 285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452666640281677, gen p mean: -0.11904910206794739, mean p set: 0.44584187865257263
loss_pred:0.015882164239883423, decouple_loss:0.0007140632951632142
The modified gen p mean: 0.44845905900001526, gen p mean: -0.11471692472696304, mean p set: 0.4490351974964142
loss_pred:0.015032267197966576, decouple_loss:0.0007079582428559661
The modified gen p mean: 0.44714921712875366, gen p mean: -0.11484593152999878, mean p set: 0.4477252662181854
loss_pred:0.016008617356419563, decouple_loss:0.0006906978087499738
Iteration: 286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470040500164032, gen p mean: -0.10787998139858246, mean p set: 0.4475817382335663
loss_pred:0.015508271753787994, decouple_loss:0.0007310455548577011
The modified gen p mean: 0.4478939473628998, gen p mean: -0.10467499494552612, mean p set: 0.44847002625465393
loss_pred:0.015597891993820667, decouple_loss:0.0006313486956059933
The modified gen p mean: 0.44892698526382446, gen p mean: -0.10689380764961243, mean p set: 0.4495036005973816
loss_pred:0.01583990827202797, decouple_loss:0.0005888778832741082
Iteration: 287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478650391101837, gen p mean: -0.11182387918233871, mean p set: 0.44844329357147217
loss_pred:0.015714973211288452, decouple_loss:0.0009475238039158285
The modified gen p mean: 0.4483754634857178, gen p mean: -0.11118525266647339, mean p set: 0.4489506781101227
loss_pred:0.015626635402441025, decouple_loss:0.0008101509301923215
The modified gen p mean: 0.4487323760986328, gen p mean: -0.1041535809636116, mean p set: 0.44930681586265564
loss_pred:0.015698539093136787, decouple_loss:0.0005469894967973232
Iteration: 288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476933181285858, gen p mean: -0.1125878319144249, mean p set: 0.44826918840408325
loss_pred:0.015621580183506012, decouple_loss:0.0005788962007500231
The modified gen p mean: 0.4474269151687622, gen p mean: -0.11060531437397003, mean p set: 0.4480014741420746
The modified gen p mean: 0.4470687508583069, gen p mean: -0.11050903797149658, mean p set: 0.44764459133148193
loss_pred:0.015178271569311619, decouple_loss:0.0007758327410556376
loss_pred:0.014839617535471916, decouple_loss:0.0006669563008472323
Iteration: 289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483194649219513, gen p mean: -0.11567163467407227, mean p set: 0.44889581203460693
loss_pred:0.015738707035779953, decouple_loss:0.0008359863422811031
The modified gen p mean: 0.44812270998954773, gen p mean: -0.11672310531139374, mean p set: 0.44869908690452576
The modified gen p mean: 0.44736379384994507, gen p mean: -0.11116161197423935, mean p set: 0.4479406476020813
loss_pred:0.015228659845888615, decouple_loss:0.0008229191298596561
loss_pred:0.015334048308432102, decouple_loss:0.0007204116554930806
Iteration: 290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470672607421875, gen p mean: -0.11314841359853745, mean p set: 0.44764280319213867
loss_pred:0.015590295195579529, decouple_loss:0.0008342172368429601
The modified gen p mean: 0.44848278164863586, gen p mean: -0.1177758127450943, mean p set: 0.4490565061569214
The modified gen p mean: 0.4455733299255371, gen p mean: -0.12374444305896759, mean p set: 0.4461473524570465
loss_pred:0.01500486396253109, decouple_loss:0.0007787490612827241
loss_pred:0.015777135267853737, decouple_loss:0.0007869229884818196
2023-05-01 16:26:55 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11307094991207123, mean p set: 0.4502691626548767
loss_pred:0.017589155584573746, decouple_loss:0.0006190018611960113
The modified gen p mean: 0.4495348632335663, gen p mean: -0.1068616658449173, mean p set: 0.4500633478164673
loss_pred:0.016860704869031906, decouple_loss:0.0007351903477683663
The modified gen p mean: 0.4497818052768707, gen p mean: -0.1068454459309578, mean p set: 0.45035696029663086
loss_pred:0.017348971217870712, decouple_loss:0.0007188071613200009
WV_1_PC_1_EH_0_PS_40, loss: 0.01730082742869854, avg_mse: 0.02713310718536377
current test mse: 0.027133
Iteration: 291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479342997074127, gen p mean: -0.10393232852220535, mean p set: 0.4485113322734833
loss_pred:0.015173179097473621, decouple_loss:0.0007612841436639428
The modified gen p mean: 0.4462103545665741, gen p mean: -0.11104702949523926, mean p set: 0.4467865526676178The modified gen p mean: 0.4482930302619934, gen p mean: -0.10215163230895996, mean p set: 0.4488692581653595
loss_pred:0.016308870166540146, decouple_loss:0.0007953832391649485loss_pred:0.015828825533390045, decouple_loss:0.0006168018444441259
Iteration: 292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784238934516907, gen p mean: -0.11911199986934662, mean p set: 0.44841864705085754
loss_pred:0.015593953430652618, decouple_loss:0.0005782856605947018
The modified gen p mean: 0.448368102312088, gen p mean: -0.12046850472688675, mean p set: 0.4489421248435974The modified gen p mean: 0.4470893442630768, gen p mean: -0.115872822701931, mean p set: 0.4476655125617981
loss_pred:0.015825210139155388, decouple_loss:0.000662134843878448loss_pred:0.015246506780385971, decouple_loss:0.0005643964977934957
Iteration: 293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481600522994995, gen p mean: -0.10114342719316483, mean p set: 0.4487389624118805
loss_pred:0.01596362516283989, decouple_loss:0.0006464799516834319
The modified gen p mean: 0.4481833875179291, gen p mean: -0.10570274293422699, mean p set: 0.4487598240375519
loss_pred:0.015769314020872116, decouple_loss:0.0007149883895181119
The modified gen p mean: 0.44808709621429443, gen p mean: -0.11076081544160843, mean p set: 0.4486646354198456
loss_pred:0.015273776836693287, decouple_loss:0.0008828591089695692
Iteration: 294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473154842853546, gen p mean: -0.11507272720336914, mean p set: 0.4478928744792938
loss_pred:0.015301872044801712, decouple_loss:0.0006797745591029525
The modified gen p mean: 0.4458640515804291, gen p mean: -0.11389943212270737, mean p set: 0.4464397132396698
loss_pred:0.016336336731910706, decouple_loss:0.0006513458210974932
The modified gen p mean: 0.4476095139980316, gen p mean: -0.11544444411993027, mean p set: 0.448184072971344
loss_pred:0.016001304611563683, decouple_loss:0.0007853565039113164
Iteration: 295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737139344215393, gen p mean: -0.1132851094007492, mean p set: 0.44794782996177673
loss_pred:0.016365010291337967, decouple_loss:0.0008020031382329762
The modified gen p mean: 0.44810909032821655, gen p mean: -0.11167237907648087, mean p set: 0.4486868679523468
loss_pred:0.015559195540845394, decouple_loss:0.0007097346824593842
The modified gen p mean: 0.4474654495716095, gen p mean: -0.1141003891825676, mean p set: 0.4480428397655487
loss_pred:0.014875606633722782, decouple_loss:0.0005991394282318652
Iteration: 296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473729133605957, gen p mean: -0.11296522617340088, mean p set: 0.4479483664035797
loss_pred:0.015281233936548233, decouple_loss:0.0006788524915464222
The modified gen p mean: 0.4458761215209961, gen p mean: -0.11440012603998184, mean p set: 0.44645413756370544
The modified gen p mean: 0.44680318236351013, gen p mean: -0.11284271627664566, mean p set: 0.4473777115345001
loss_pred:0.01535477489233017, decouple_loss:0.0007769106305204332
loss_pred:0.016383836045861244, decouple_loss:0.0007148170843720436
Iteration: 297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44910046458244324, gen p mean: -0.09904269874095917, mean p set: 0.44967639446258545
loss_pred:0.01526304055005312, decouple_loss:0.0006623328663408756
The modified gen p mean: 0.4488590657711029, gen p mean: -0.10125076770782471, mean p set: 0.4494354724884033
loss_pred:0.015530575066804886, decouple_loss:0.0008104181615635753
The modified gen p mean: 0.4485103189945221, gen p mean: -0.1055893748998642, mean p set: 0.44908660650253296
loss_pred:0.01562698744237423, decouple_loss:0.0012574767461046576
Iteration: 298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746455550193787, gen p mean: -0.09720408171415329, mean p set: 0.4480399191379547
loss_pred:0.015231379307806492, decouple_loss:0.0006438510026782751
The modified gen p mean: 0.44864070415496826, gen p mean: -0.09966905415058136, mean p set: 0.4492167532444
loss_pred:0.016193130984902382, decouple_loss:0.0007266582688316703
The modified gen p mean: 0.44587475061416626, gen p mean: -0.1085173487663269, mean p set: 0.44645223021507263
loss_pred:0.01591508649289608, decouple_loss:0.0007836411241441965
Iteration: 299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834351539611816, gen p mean: -0.10656438767910004, mean p set: 0.448919415473938
loss_pred:0.015810715034604073, decouple_loss:0.000652334769256413
The modified gen p mean: 0.44626352190971375, gen p mean: -0.10658128559589386, mean p set: 0.4468391239643097
loss_pred:0.015772320330142975, decouple_loss:0.0006682424573227763
The modified gen p mean: 0.4479323625564575, gen p mean: -0.10710128396749496, mean p set: 0.44850867986679077
loss_pred:0.015368309803307056, decouple_loss:0.000845668779220432
Iteration: 300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44710010290145874, gen p mean: -0.11637290567159653, mean p set: 0.44767823815345764
loss_pred:0.015381917357444763, decouple_loss:0.0008007328142412007
The modified gen p mean: 0.44752758741378784, gen p mean: -0.11447939276695251, mean p set: 0.4481014013290405
loss_pred:0.01586906425654888, decouple_loss:0.0008722814382053912
The modified gen p mean: 0.4475437104701996, gen p mean: -0.11750762909650803, mean p set: 0.44812238216400146
loss_pred:0.015800513327121735, decouple_loss:0.0009233230957761407
2023-05-01 16:29:02 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13714075088500977, mean p set: 0.4502691626548767
loss_pred:0.017829792574048042, decouple_loss:0.0007210054900497198
The modified gen p mean: 0.4495331048965454, gen p mean: -0.13131660223007202, mean p set: 0.4500633478164673
loss_pred:0.017059719190001488, decouple_loss:0.0007531610899604857
The modified gen p mean: 0.44978275895118713, gen p mean: -0.13155582547187805, mean p set: 0.45035696029663086
loss_pred:0.017491333186626434, decouple_loss:0.0007636258378624916
WV_1_PC_1_EH_0_PS_40, loss: 0.017497576773166656, avg_mse: 0.027151085436344147
current test mse: 0.027151
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012020_3_24hr.npz
NaN value num: 0
Iteration: 301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502878487110138, gen p mean: -0.12904655933380127, mean p set: 0.4508611261844635
loss_pred:0.017494164407253265, decouple_loss:0.0007243038271553814
The modified gen p mean: 0.44915157556533813, gen p mean: -0.12935060262680054, mean p set: 0.44972866773605347
loss_pred:0.01792796701192856, decouple_loss:0.0007603822159580886
The modified gen p mean: 0.44956445693969727, gen p mean: -0.1379600614309311, mean p set: 0.4501415491104126
loss_pred:0.017170194536447525, decouple_loss:0.000691401946824044
Iteration: 302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44861769676208496, gen p mean: -0.13518370687961578, mean p set: 0.4491928219795227
loss_pred:0.016880685463547707, decouple_loss:0.0008181027369573712
The modified gen p mean: 0.4490111172199249, gen p mean: -0.127627894282341, mean p set: 0.4495888352394104The modified gen p mean: 0.4485132098197937, gen p mean: -0.1299038678407669, mean p set: 0.4490925073623657
loss_pred:0.01713346503674984, decouple_loss:0.0007722448790445924
loss_pred:0.017738942056894302, decouple_loss:0.0007825461216270924
Iteration: 303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005521178245544, gen p mean: -0.12449584901332855, mean p set: 0.4506319463253021
loss_pred:0.01710771955549717, decouple_loss:0.0007156103965826333
The modified gen p mean: 0.4493100345134735, gen p mean: -0.1281968504190445, mean p set: 0.44988352060317993
loss_pred:0.01594075933098793, decouple_loss:0.0006491707172244787
The modified gen p mean: 0.45004090666770935, gen p mean: -0.13261789083480835, mean p set: 0.4506154954433441
loss_pred:0.017255036160349846, decouple_loss:0.0006862590671516955
Iteration: 304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45000937581062317, gen p mean: -0.12761236727237701, mean p set: 0.450583815574646
loss_pred:0.017414504662156105, decouple_loss:0.0006401995779015124
The modified gen p mean: 0.4503718912601471, gen p mean: -0.11785738915205002, mean p set: 0.4509483277797699
loss_pred:0.017950085923075676, decouple_loss:0.0006828230107203126
The modified gen p mean: 0.4495592415332794, gen p mean: -0.11665564775466919, mean p set: 0.450135201215744
loss_pred:0.016252143308520317, decouple_loss:0.0007353760302066803
Iteration: 305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504985213279724, gen p mean: -0.10805366933345795, mean p set: 0.4510757029056549
loss_pred:0.017758574336767197, decouple_loss:0.0008137947879731655
The modified gen p mean: 0.45000919699668884, gen p mean: -0.1136227548122406, mean p set: 0.45058757066726685
loss_pred:0.017035314813256264, decouple_loss:0.000741350871976465
The modified gen p mean: 0.4494921565055847, gen p mean: -0.11168468743562698, mean p set: 0.45006564259529114
loss_pred:0.016790246590971947, decouple_loss:0.000621875689830631
Iteration: 306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498056471347809, gen p mean: -0.10640155524015427, mean p set: 0.45038241147994995
loss_pred:0.016706300899386406, decouple_loss:0.0006350356852635741
The modified gen p mean: 0.45042699575424194, gen p mean: -0.11093945056200027, mean p set: 0.4510018229484558
The modified gen p mean: 0.450072705745697, gen p mean: -0.10389132797718048, mean p set: 0.4506498873233795
loss_pred:0.017308581620454788, decouple_loss:0.0007227039895951748
loss_pred:0.01780862547457218, decouple_loss:0.0006700953817926347
Iteration: 307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934406876564026, gen p mean: -0.11032922565937042, mean p set: 0.4499199688434601
loss_pred:0.016484567895531654, decouple_loss:0.0006534166168421507
The modified gen p mean: 0.44925546646118164, gen p mean: -0.10496891289949417, mean p set: 0.4498307704925537
The modified gen p mean: 0.45016300678253174, gen p mean: -0.11020676046609879, mean p set: 0.45073747634887695
loss_pred:0.016971852630376816, decouple_loss:0.0008469121530652046
loss_pred:0.017546197399497032, decouple_loss:0.0007658976246602833
Iteration: 308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052388310432434, gen p mean: -0.1067533865571022, mean p set: 0.451102077960968
loss_pred:0.016742758452892303, decouple_loss:0.000717617163900286
The modified gen p mean: 0.448629766702652, gen p mean: -0.11165036261081696, mean p set: 0.4492048919200897
loss_pred:0.016310347244143486, decouple_loss:0.0005941737326793373
The modified gen p mean: 0.45058807730674744, gen p mean: -0.10847008228302002, mean p set: 0.45116761326789856
loss_pred:0.01734830252826214, decouple_loss:0.0007383002084679902
Iteration: 309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491603970527649, gen p mean: -0.11186594516038895, mean p set: 0.44973650574684143
loss_pred:0.016474878415465355, decouple_loss:0.0006105875945650041
The modified gen p mean: 0.44946226477622986, gen p mean: -0.11456377804279327, mean p set: 0.4500381648540497
loss_pred:0.0164190623909235, decouple_loss:0.000671320769470185
The modified gen p mean: 0.4488060772418976, gen p mean: -0.1122886911034584, mean p set: 0.4493815302848816
loss_pred:0.0167644452303648, decouple_loss:0.0007056064205244184
Iteration: 310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449682354927063, gen p mean: -0.10764464735984802, mean p set: 0.4502556622028351
loss_pred:0.01695232093334198, decouple_loss:0.0006183286313898861
The modified gen p mean: 0.45034945011138916, gen p mean: -0.10763063281774521, mean p set: 0.45092761516571045
loss_pred:0.017105313017964363, decouple_loss:0.0006496583227999508
The modified gen p mean: 0.4506213963031769, gen p mean: -0.10982441902160645, mean p set: 0.4511975646018982
loss_pred:0.01615220494568348, decouple_loss:0.000679848191794008
2023-05-01 16:31:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11796501278877258, mean p set: 0.4502691626548767
loss_pred:0.017204534262418747, decouple_loss:0.0006709994049742818
The modified gen p mean: 0.4495343565940857, gen p mean: -0.11226557195186615, mean p set: 0.4500633478164673
loss_pred:0.016585255041718483, decouple_loss:0.001053297077305615
The modified gen p mean: 0.44978123903274536, gen p mean: -0.11199727654457092, mean p set: 0.45035696029663086
loss_pred:0.01689429208636284, decouple_loss:0.0006793316570110619
WV_1_PC_1_EH_0_PS_40, loss: 0.016934756189584732, avg_mse: 0.02626163139939308
current test mse: 0.026262
Iteration: 311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44803208112716675, gen p mean: -0.11481031030416489, mean p set: 0.448609322309494
loss_pred:0.017104368656873703, decouple_loss:0.0005924737779423594
The modified gen p mean: 0.4497661590576172, gen p mean: -0.1160794273018837, mean p set: 0.4503425657749176The modified gen p mean: 0.4489501416683197, gen p mean: -0.11493997275829315, mean p set: 0.44952836632728577
loss_pred:0.016081321984529495, decouple_loss:0.0006210494902916253
loss_pred:0.016267303377389908, decouple_loss:0.0006667001871392131
Iteration: 312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490404725074768, gen p mean: -0.11404503136873245, mean p set: 0.4496159553527832
loss_pred:0.01662684604525566, decouple_loss:0.0007415760774165392
The modified gen p mean: 0.4491216242313385, gen p mean: -0.11125312745571136, mean p set: 0.4496990144252777The modified gen p mean: 0.4492269456386566, gen p mean: -0.1126805767416954, mean p set: 0.4498046338558197
loss_pred:0.01721753552556038, decouple_loss:0.0006549714598804712
loss_pred:0.017127277329564095, decouple_loss:0.0007350688683800399
Iteration: 313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502435624599457, gen p mean: -0.11433342099189758, mean p set: 0.4508230984210968
loss_pred:0.016893165186047554, decouple_loss:0.0007504489040002227
The modified gen p mean: 0.4493778944015503, gen p mean: -0.10920945554971695, mean p set: 0.44995349645614624
loss_pred:0.016730614006519318, decouple_loss:0.0006198387709446251
The modified gen p mean: 0.45068076252937317, gen p mean: -0.11204534769058228, mean p set: 0.4512575566768646
loss_pred:0.017014261335134506, decouple_loss:0.0006506183417513967
Iteration: 314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970613718032837, gen p mean: -0.11346442252397537, mean p set: 0.4502823054790497
loss_pred:0.01667114719748497, decouple_loss:0.0007871488924138248
The modified gen p mean: 0.4500527083873749, gen p mean: -0.1130639836192131, mean p set: 0.45062586665153503
loss_pred:0.017186734825372696, decouple_loss:0.0006208068807609379
The modified gen p mean: 0.4499877095222473, gen p mean: -0.11491422355175018, mean p set: 0.45056453347206116
loss_pred:0.017247622832655907, decouple_loss:0.0007627617451362312
Iteration: 315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44960302114486694, gen p mean: -0.11484028398990631, mean p set: 0.45017993450164795
loss_pred:0.01667502336204052, decouple_loss:0.0005228783120401204
The modified gen p mean: 0.4492393732070923, gen p mean: -0.11644689738750458, mean p set: 0.4498143792152405
loss_pred:0.016632013022899628, decouple_loss:0.0006398219848051667
The modified gen p mean: 0.4492560625076294, gen p mean: -0.1176561564207077, mean p set: 0.4498307406902313
loss_pred:0.016183046624064445, decouple_loss:0.0005290978588163853
Iteration: 316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495685398578644, gen p mean: -0.11881326884031296, mean p set: 0.45014673471450806
loss_pred:0.01647578552365303, decouple_loss:0.000739996088668704
The modified gen p mean: 0.4497922956943512, gen p mean: -0.11681578308343887, mean p set: 0.45036831498146057
The modified gen p mean: 0.44925689697265625, gen p mean: -0.11891711503267288, mean p set: 0.4498342275619507
loss_pred:0.016474995762109756, decouple_loss:0.0008788140839897096
loss_pred:0.01652206853032112, decouple_loss:0.0007611991604790092
Iteration: 317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44983723759651184, gen p mean: -0.11411412805318832, mean p set: 0.4504148066043854
loss_pred:0.0170473400503397, decouple_loss:0.0007124590338207781
The modified gen p mean: 0.45009827613830566, gen p mean: -0.11310359835624695, mean p set: 0.45067691802978516
loss_pred:0.016875654458999634, decouple_loss:0.0009276923956349492
The modified gen p mean: 0.4507324695587158, gen p mean: -0.12496508657932281, mean p set: 0.4513084292411804
loss_pred:0.016925107687711716, decouple_loss:0.0007240063278004527
Iteration: 318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45018690824508667, gen p mean: -0.11437530070543289, mean p set: 0.4507621228694916
loss_pred:0.01708194613456726, decouple_loss:0.0007416955777443945
The modified gen p mean: 0.44811955094337463, gen p mean: -0.11992627382278442, mean p set: 0.4486955404281616
loss_pred:0.016773922368884087, decouple_loss:0.0007685015443712473
The modified gen p mean: 0.4493086040019989, gen p mean: -0.1224825382232666, mean p set: 0.44988662004470825
loss_pred:0.01599927432835102, decouple_loss:0.0006623910157941282
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488738775253296, gen p mean: -0.11847926676273346, mean p set: 0.44944941997528076
loss_pred:0.016682714223861694, decouple_loss:0.0008287944947369397
The modified gen p mean: 0.4486157298088074, gen p mean: -0.11659973114728928, mean p set: 0.4491916298866272
loss_pred:0.016782809048891068, decouple_loss:0.0007768228533677757
The modified gen p mean: 0.45069602131843567, gen p mean: -0.12299274653196335, mean p set: 0.45127072930336
loss_pred:0.016925450414419174, decouple_loss:0.0008397219353355467
Iteration: 320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45014071464538574, gen p mean: -0.11389967054128647, mean p set: 0.4507182538509369
loss_pred:0.016197582706809044, decouple_loss:0.0006703201797790825
The modified gen p mean: 0.45113763213157654, gen p mean: -0.1130160316824913, mean p set: 0.4517151713371277
The modified gen p mean: 0.4496302306652069, gen p mean: -0.11680834740400314, mean p set: 0.4502067267894745
loss_pred:0.016849786043167114, decouple_loss:0.000795120547991246
loss_pred:0.016139207407832146, decouple_loss:0.000721181626431644
2023-05-01 16:33:51 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12008299678564072, mean p set: 0.4502691626548767
loss_pred:0.017091630026698112, decouple_loss:0.000698834948707372
The modified gen p mean: 0.4495367407798767, gen p mean: -0.11477671563625336, mean p set: 0.4500633478164673
loss_pred:0.016438886523246765, decouple_loss:0.0006597855826839805
The modified gen p mean: 0.44977959990501404, gen p mean: -0.11403865367174149, mean p set: 0.45035696029663086
loss_pred:0.016766376793384552, decouple_loss:0.0005908190505579114
WV_1_PC_1_EH_0_PS_40, loss: 0.016798121854662895, avg_mse: 0.026042092591524124
current test mse: 0.026042
At step 320, Best test: 0.026042
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012002_3_24hr.npz
NaN value num: 0
Iteration: 321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44854259490966797, gen p mean: -0.11517027020454407, mean p set: 0.44911783933639526
loss_pred:0.015596291050314903, decouple_loss:0.0008816029876470566
The modified gen p mean: 0.44999533891677856, gen p mean: -0.11895764619112015, mean p set: 0.4505738615989685
loss_pred:0.015186580829322338, decouple_loss:0.0009368137689307332
The modified gen p mean: 0.4513438045978546, gen p mean: -0.1142241582274437, mean p set: 0.4519214332103729
loss_pred:0.014702660962939262, decouple_loss:0.0007951477309688926
Iteration: 322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44966232776641846, gen p mean: -0.12070602923631668, mean p set: 0.45023781061172485
The modified gen p mean: 0.448513001203537, gen p mean: -0.12034902721643448, mean p set: 0.44908812642097473
loss_pred:0.015516049228608608, decouple_loss:0.0008242911426350474
loss_pred:0.015984145924448967, decouple_loss:0.0007866742671467364
The modified gen p mean: 0.4520666301250458, gen p mean: -0.10915807634592056, mean p set: 0.45264333486557007
loss_pred:0.015080700628459454, decouple_loss:0.000717712682671845
Iteration: 323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508267045021057, gen p mean: -0.11125290393829346, mean p set: 0.45140528678894043
loss_pred:0.015186864882707596, decouple_loss:0.0008486898732371628
The modified gen p mean: 0.4520688056945801, gen p mean: -0.1128542572259903, mean p set: 0.4526459276676178The modified gen p mean: 0.4496269226074219, gen p mean: -0.11402217298746109, mean p set: 0.4502033293247223
loss_pred:0.015275122597813606, decouple_loss:0.0008008647710084915
loss_pred:0.01556179765611887, decouple_loss:0.0009590661502443254
Iteration: 324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489026963710785, gen p mean: -0.11249078065156937, mean p set: 0.4494827091693878
loss_pred:0.016105229035019875, decouple_loss:0.0009088461520150304
The modified gen p mean: 0.45019054412841797, gen p mean: -0.10874011367559433, mean p set: 0.4507688283920288
loss_pred:0.016241544857621193, decouple_loss:0.0007277077529579401
The modified gen p mean: 0.45239269733428955, gen p mean: -0.10933354496955872, mean p set: 0.45297008752822876
loss_pred:0.01524305623024702, decouple_loss:0.0007762889144942164
Iteration: 325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752126932144165, gen p mean: -0.11429458856582642, mean p set: 0.44809824228286743
The modified gen p mean: 0.44940128922462463, gen p mean: -0.10347557067871094, mean p set: 0.4499800503253937
loss_pred:0.015407846309244633, decouple_loss:0.0006896679406054318
loss_pred:0.016440531238913536, decouple_loss:0.0006851786747574806
The modified gen p mean: 0.44891464710235596, gen p mean: -0.11437784135341644, mean p set: 0.4494905471801758
loss_pred:0.015545707195997238, decouple_loss:0.0009117230656556785
Iteration: 326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45171818137168884, gen p mean: -0.10717356950044632, mean p set: 0.4522995054721832
loss_pred:0.015385027974843979, decouple_loss:0.0009989923564717174
The modified gen p mean: 0.4513622224330902, gen p mean: -0.11233210563659668, mean p set: 0.45193883776664734
loss_pred:0.014966326765716076, decouple_loss:0.0008464910206384957
The modified gen p mean: 0.4512765407562256, gen p mean: -0.11169107258319855, mean p set: 0.4518527686595917
loss_pred:0.015092678368091583, decouple_loss:0.0008825419936329126
Iteration: 327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44849124550819397, gen p mean: -0.11596573144197464, mean p set: 0.4490666687488556
loss_pred:0.01567767560482025, decouple_loss:0.0008478851523250341
The modified gen p mean: 0.44968801736831665, gen p mean: -0.117246113717556, mean p set: 0.45026248693466187
loss_pred:0.015897782519459724, decouple_loss:0.0008731612470000982
The modified gen p mean: 0.4509836435317993, gen p mean: -0.10931304842233658, mean p set: 0.45156213641166687
loss_pred:0.016097093001008034, decouple_loss:0.0008104242733679712
Iteration: 328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45006170868873596, gen p mean: -0.11341679096221924, mean p set: 0.4506358802318573
loss_pred:0.016288384795188904, decouple_loss:0.0005598413408733904
The modified gen p mean: 0.4513133764266968, gen p mean: -0.11067090928554535, mean p set: 0.4518917500972748
loss_pred:0.01518569327890873, decouple_loss:0.0008916924125514925
The modified gen p mean: 0.4512270390987396, gen p mean: -0.117937371134758, mean p set: 0.4518038034439087
loss_pred:0.01463183481246233, decouple_loss:0.0007235833909362555
Iteration: 329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44973134994506836, gen p mean: -0.11872328817844391, mean p set: 0.45030689239501953
loss_pred:0.015538761392235756, decouple_loss:0.0006952994735911489
The modified gen p mean: 0.4476892650127411, gen p mean: -0.12124472856521606, mean p set: 0.4482645094394684
loss_pred:0.016311582177877426, decouple_loss:0.000993934809230268
The modified gen p mean: 0.4521782100200653, gen p mean: -0.11297162622213364, mean p set: 0.45275649428367615
loss_pred:0.015006235800683498, decouple_loss:0.0007711776997894049
Iteration: 330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518967270851135, gen p mean: -0.12386387586593628, mean p set: 0.45247551798820496
loss_pred:0.015102825127542019, decouple_loss:0.0009703910909593105
The modified gen p mean: 0.44967061281204224, gen p mean: -0.12243325263261795, mean p set: 0.45024624466896057
loss_pred:0.0153345987200737, decouple_loss:0.0007722376612946391
The modified gen p mean: 0.45036742091178894, gen p mean: -0.1188552975654602, mean p set: 0.4509424567222595
loss_pred:0.01536548975855112, decouple_loss:0.0008203122415579855
2023-05-01 16:36:37 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12714843451976776, mean p set: 0.4502691626548767
loss_pred:0.017305349931120872, decouple_loss:0.0007159868837334216
The modified gen p mean: 0.44953805208206177, gen p mean: -0.12242560088634491, mean p set: 0.4500633478164673
loss_pred:0.016578657552599907, decouple_loss:0.0006696473574265838
The modified gen p mean: 0.4497836232185364, gen p mean: -0.12174966931343079, mean p set: 0.45035696029663086
loss_pred:0.016844836995005608, decouple_loss:0.0006540430476889014
WV_1_PC_1_EH_0_PS_40, loss: 0.016943611204624176, avg_mse: 0.026380345225334167
current test mse: 0.02638
Iteration: 331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920456409454346, gen p mean: -0.11237732321023941, mean p set: 0.4497814178466797
loss_pred:0.015766944736242294, decouple_loss:0.0007229134207591414
The modified gen p mean: 0.450448215007782, gen p mean: -0.11969702690839767, mean p set: 0.4510234594345093The modified gen p mean: 0.44843238592147827, gen p mean: -0.12352203577756882, mean p set: 0.44900739192962646
loss_pred:0.016323179006576538, decouple_loss:0.0006332034827210009
loss_pred:0.01568962261080742, decouple_loss:0.0006919358856976032
Iteration: 332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45095229148864746, gen p mean: -0.11464524269104004, mean p set: 0.45152729749679565
The modified gen p mean: 0.4477849304676056, gen p mean: -0.11496163159608841, mean p set: 0.4483596682548523
loss_pred:0.015314484015107155, decouple_loss:0.0008999657584354281
loss_pred:0.016288861632347107, decouple_loss:0.0008244618657045066
The modified gen p mean: 0.4499194920063019, gen p mean: -0.12081204354763031, mean p set: 0.4504929184913635
loss_pred:0.015525215305387974, decouple_loss:0.0007613603956997395
Iteration: 333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499327838420868, gen p mean: -0.1096445843577385, mean p set: 0.4505072236061096
The modified gen p mean: 0.45131197571754456, gen p mean: -0.1105976477265358, mean p set: 0.451885849237442
loss_pred:0.015455338172614574, decouple_loss:0.0008909744210541248
loss_pred:0.015626097097992897, decouple_loss:0.0006052114767953753
The modified gen p mean: 0.44982436299324036, gen p mean: -0.10847734659910202, mean p set: 0.4504006803035736
loss_pred:0.015378103591501713, decouple_loss:0.00079852290218696
Iteration: 334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45020633935928345, gen p mean: -0.10676085203886032, mean p set: 0.4507831633090973
loss_pred:0.01600475236773491, decouple_loss:0.000516836007591337
The modified gen p mean: 0.45273855328559875, gen p mean: -0.1056593507528305, mean p set: 0.4533156752586365
loss_pred:0.015585280023515224, decouple_loss:0.0006054198602214456
The modified gen p mean: 0.4500792622566223, gen p mean: -0.11253930628299713, mean p set: 0.45065850019454956
loss_pred:0.014966316521167755, decouple_loss:0.0006866094772703946
Iteration: 335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449008584022522, gen p mean: -0.10943159461021423, mean p set: 0.44958722591400146
loss_pred:0.015642281621694565, decouple_loss:0.0005902037373743951
The modified gen p mean: 0.4503507614135742, gen p mean: -0.10924600809812546, mean p set: 0.4509258568286896
loss_pred:0.015136881731450558, decouple_loss:0.0010144992265850306
The modified gen p mean: 0.4516688287258148, gen p mean: -0.10981801897287369, mean p set: 0.4522479474544525
loss_pred:0.0151443500071764, decouple_loss:0.001147579401731491
Iteration: 336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499502182006836, gen p mean: -0.10852418839931488, mean p set: 0.4505264163017273
loss_pred:0.014996012672781944, decouple_loss:0.0007355540292337537
The modified gen p mean: 0.4504311978816986, gen p mean: -0.10883913189172745, mean p set: 0.4510088264942169
loss_pred:0.015110621228814125, decouple_loss:0.0005626587080769241
The modified gen p mean: 0.4513062536716461, gen p mean: -0.10731229931116104, mean p set: 0.4518826901912689
loss_pred:0.015759607776999474, decouple_loss:0.0009193964651785791
Iteration: 337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44883331656455994, gen p mean: -0.11960013955831528, mean p set: 0.44941338896751404
The modified gen p mean: 0.44959884881973267, gen p mean: -0.11288484930992126, mean p set: 0.45017367601394653
loss_pred:0.015280690975487232, decouple_loss:0.0007205722504295409
loss_pred:0.015285073779523373, decouple_loss:0.0007971278973855078
The modified gen p mean: 0.44848692417144775, gen p mean: -0.11109237372875214, mean p set: 0.4490615427494049
loss_pred:0.016340240836143494, decouple_loss:0.0007081437506712973
Iteration: 338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489465355873108, gen p mean: -0.1192895695567131, mean p set: 0.44952380657196045
loss_pred:0.015277145430445671, decouple_loss:0.0007553615723736584
The modified gen p mean: 0.4490625262260437, gen p mean: -0.10672261565923691, mean p set: 0.44963955879211426
loss_pred:0.015607974492013454, decouple_loss:0.0006916355341672897
The modified gen p mean: 0.4488080143928528, gen p mean: -0.11659534275531769, mean p set: 0.449381947517395
loss_pred:0.015483242459595203, decouple_loss:0.00075622828444466
Iteration: 339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498807489871979, gen p mean: -0.11472304165363312, mean p set: 0.45045995712280273
The modified gen p mean: 0.4493626058101654, gen p mean: -0.12399674952030182, mean p set: 0.44993945956230164
loss_pred:0.01566719077527523, decouple_loss:0.000626134395133704
loss_pred:0.014840340241789818, decouple_loss:0.0007054392481222749
The modified gen p mean: 0.449278324842453, gen p mean: -0.11932054162025452, mean p set: 0.4498515725135803
loss_pred:0.015276456251740456, decouple_loss:0.000568586983717978
Iteration: 340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489281475543976, gen p mean: -0.12332608550786972, mean p set: 0.4495079815387726
The modified gen p mean: 0.4500296413898468, gen p mean: -0.120799720287323, mean p set: 0.45060494542121887
loss_pred:0.015537873841822147, decouple_loss:0.0008148831548169255
loss_pred:0.01547288242727518, decouple_loss:0.0008992354851216078
The modified gen p mean: 0.44919055700302124, gen p mean: -0.11955517530441284, mean p set: 0.44976404309272766
loss_pred:0.01577417366206646, decouple_loss:0.0005926177836954594
2023-05-01 16:38:42 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1300480216741562, mean p set: 0.4502691626548767
loss_pred:0.017295321449637413, decouple_loss:0.0006608186522498727
The modified gen p mean: 0.4495357871055603, gen p mean: -0.12449245154857635, mean p set: 0.4500633478164673
loss_pred:0.016634134575724602, decouple_loss:0.0007251002825796604
The modified gen p mean: 0.4497799277305603, gen p mean: -0.12370623648166656, mean p set: 0.45035696029663086
loss_pred:0.01690448448061943, decouple_loss:0.0006322026019915938
WV_1_PC_1_EH_0_PS_40, loss: 0.01697828434407711, avg_mse: 0.02641574665904045
current test mse: 0.026416
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012020_3_24hr.npz
NaN value num: 0
Iteration: 341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505709111690521, gen p mean: -0.11969217658042908, mean p set: 0.45114725828170776
loss_pred:0.01641656644642353, decouple_loss:0.0008920200052671134
The modified gen p mean: 0.4504503905773163, gen p mean: -0.1196369081735611, mean p set: 0.45102712512016296
loss_pred:0.01662272773683071, decouple_loss:0.0008958216640166938
The modified gen p mean: 0.4532732665538788, gen p mean: -0.12124761193990707, mean p set: 0.4538503587245941
loss_pred:0.015749942511320114, decouple_loss:0.0009309821762144566
Iteration: 342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528256952762604, gen p mean: -0.11851593106985092, mean p set: 0.45340198278427124
The modified gen p mean: 0.4507429003715515, gen p mean: -0.11991899460554123, mean p set: 0.4513225853443146
loss_pred:0.015740539878606796, decouple_loss:0.0007746086339466274
loss_pred:0.01565464958548546, decouple_loss:0.0006755702779628336
The modified gen p mean: 0.45287856459617615, gen p mean: -0.12011756747961044, mean p set: 0.4534553289413452
loss_pred:0.015685545280575752, decouple_loss:0.0006520029855892062
Iteration: 343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493566155433655, gen p mean: -0.11254141479730606, mean p set: 0.4499339163303375
loss_pred:0.016805119812488556, decouple_loss:0.0006698135402984917
The modified gen p mean: 0.4490237832069397, gen p mean: -0.11680792272090912, mean p set: 0.4495995044708252The modified gen p mean: 0.4519006311893463, gen p mean: -0.11351830512285233, mean p set: 0.45247623324394226
loss_pred:0.016283860430121422, decouple_loss:0.0008610847289673984
loss_pred:0.01638513058423996, decouple_loss:0.0009067055070772767
Iteration: 344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519231617450714, gen p mean: -0.10493689775466919, mean p set: 0.45250123739242554
loss_pred:0.015701141208410263, decouple_loss:0.0011159968562424183
The modified gen p mean: 0.45023584365844727, gen p mean: -0.11659325659275055, mean p set: 0.45081186294555664
loss_pred:0.016340801492333412, decouple_loss:0.0006766056176275015
The modified gen p mean: 0.45030897855758667, gen p mean: -0.11106395721435547, mean p set: 0.450886607170105
loss_pred:0.016220083460211754, decouple_loss:0.0006281516398303211
Iteration: 345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052626729011536, gen p mean: -0.10485577583312988, mean p set: 0.4511038064956665
loss_pred:0.015513364225625992, decouple_loss:0.000875124882441014
The modified gen p mean: 0.4533618688583374, gen p mean: -0.10176967829465866, mean p set: 0.4539388418197632
loss_pred:0.015729611739516258, decouple_loss:0.0011581691214814782
The modified gen p mean: 0.4507962465286255, gen p mean: -0.10482962429523468, mean p set: 0.4513719379901886
loss_pred:0.016307329759001732, decouple_loss:0.000823407550342381
Iteration: 346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514661133289337, gen p mean: -0.0983346477150917, mean p set: 0.4520423710346222
loss_pred:0.015021305531263351, decouple_loss:0.0005437614163383842
The modified gen p mean: 0.4505007266998291, gen p mean: -0.10605165362358093, mean p set: 0.45107758045196533
loss_pred:0.015586084686219692, decouple_loss:0.0006608748226426542
The modified gen p mean: 0.4519180357456207, gen p mean: -0.09753537178039551, mean p set: 0.4524938464164734
loss_pred:0.015594223514199257, decouple_loss:0.0006238865316845477
Iteration: 347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515586197376251, gen p mean: -0.10331037640571594, mean p set: 0.4521334171295166
loss_pred:0.015421112067997456, decouple_loss:0.0007771159871481359
The modified gen p mean: 0.45203837752342224, gen p mean: -0.10378235578536987, mean p set: 0.452614963054657
loss_pred:0.015529941767454147, decouple_loss:0.000662497419398278
The modified gen p mean: 0.45014381408691406, gen p mean: -0.10411098599433899, mean p set: 0.45072096586227417
loss_pred:0.01619807630777359, decouple_loss:0.000731207022909075
Iteration: 348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516202211380005, gen p mean: -0.10429194569587708, mean p set: 0.45219701528549194
The modified gen p mean: 0.45072224736213684, gen p mean: -0.10128743946552277, mean p set: 0.45129746198654175
loss_pred:0.016336709260940552, decouple_loss:0.0007263424922712147
loss_pred:0.01670963503420353, decouple_loss:0.0005236847791820765
The modified gen p mean: 0.4535214602947235, gen p mean: -0.11042287200689316, mean p set: 0.45409834384918213
loss_pred:0.015738025307655334, decouple_loss:0.0008119602571241558
Iteration: 349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516931474208832, gen p mean: -0.10551813244819641, mean p set: 0.45226943492889404
loss_pred:0.015553418546915054, decouple_loss:0.000889929011464119
The modified gen p mean: 0.45191407203674316, gen p mean: -0.10743935406208038, mean p set: 0.4524913430213928
loss_pred:0.016752028837800026, decouple_loss:0.0007824221975170076
The modified gen p mean: 0.4512736201286316, gen p mean: -0.1050466001033783, mean p set: 0.4518507122993469
loss_pred:0.016511499881744385, decouple_loss:0.0006925126654095948
Iteration: 350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504374563694, gen p mean: -0.10441537201404572, mean p set: 0.45101380348205566
The modified gen p mean: 0.45058730244636536, gen p mean: -0.10883073508739471, mean p set: 0.45116573572158813
loss_pred:0.016068456694483757, decouple_loss:0.000829036405775696
loss_pred:0.015379968099296093, decouple_loss:0.000665404018945992
The modified gen p mean: 0.4499240815639496, gen p mean: -0.1053585559129715, mean p set: 0.4505026042461395
loss_pred:0.01617511361837387, decouple_loss:0.000646017084363848
2023-05-01 16:41:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11340644210577011, mean p set: 0.4502691626548767
loss_pred:0.01717458665370941, decouple_loss:0.000555901147890836
The modified gen p mean: 0.449535608291626, gen p mean: -0.10771573334932327, mean p set: 0.4500633478164673
loss_pred:0.016673849895596504, decouple_loss:0.000786790216807276
The modified gen p mean: 0.44977959990501404, gen p mean: -0.10696983337402344, mean p set: 0.45035696029663086
loss_pred:0.01695742830634117, decouple_loss:0.0007498090271838009
WV_1_PC_1_EH_0_PS_40, loss: 0.016970163211226463, avg_mse: 0.026262348517775536
current test mse: 0.026262
Iteration: 351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45223233103752136, gen p mean: -0.10279350727796555, mean p set: 0.4528115391731262
loss_pred:0.016228847205638885, decouple_loss:0.0012878815177828074
The modified gen p mean: 0.4521385133266449, gen p mean: -0.10253037512302399, mean p set: 0.4527163803577423
loss_pred:0.01613422855734825, decouple_loss:0.000880299077834934
The modified gen p mean: 0.4494358003139496, gen p mean: -0.10207908600568771, mean p set: 0.4500125050544739
loss_pred:0.01597195863723755, decouple_loss:0.000818165426608175
Iteration: 352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516320526599884, gen p mean: -0.09825507551431656, mean p set: 0.4522095024585724
loss_pred:0.016187142580747604, decouple_loss:0.0006555115687660873
The modified gen p mean: 0.4526344835758209, gen p mean: -0.09615068137645721, mean p set: 0.453212171792984The modified gen p mean: 0.45021578669548035, gen p mean: -0.09791253507137299, mean p set: 0.45079126954078674
loss_pred:0.016268422827124596, decouple_loss:0.0007888993131928146
loss_pred:0.015781469643115997, decouple_loss:0.0010187213774770498
Iteration: 353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511670172214508, gen p mean: -0.09423419833183289, mean p set: 0.45174357295036316
loss_pred:0.016233308240771294, decouple_loss:0.0007799939485266805
The modified gen p mean: 0.44838061928749084, gen p mean: -0.09913312643766403, mean p set: 0.44895628094673157
loss_pred:0.016044847667217255, decouple_loss:0.0006959699676372111
The modified gen p mean: 0.45147764682769775, gen p mean: -0.09651660919189453, mean p set: 0.4520528018474579
loss_pred:0.016000740230083466, decouple_loss:0.0007493546581827104
Iteration: 354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45207124948501587, gen p mean: -0.09229842573404312, mean p set: 0.452647864818573
loss_pred:0.015567515045404434, decouple_loss:0.0009514091652818024
The modified gen p mean: 0.4505316913127899, gen p mean: -0.09617248922586441, mean p set: 0.45110899209976196
loss_pred:0.016209401190280914, decouple_loss:0.0008722885977476835
The modified gen p mean: 0.4493134021759033, gen p mean: -0.10086333006620407, mean p set: 0.44988977909088135
loss_pred:0.01599806174635887, decouple_loss:0.0007586571155115962
Iteration: 355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45022910833358765, gen p mean: -0.09552767872810364, mean p set: 0.4508056044578552
loss_pred:0.015898441895842552, decouple_loss:0.0008232954423874617
The modified gen p mean: 0.45165330171585083, gen p mean: -0.0929408147931099, mean p set: 0.4522283971309662
loss_pred:0.015742288902401924, decouple_loss:0.0008590965298935771
The modified gen p mean: 0.4495597183704376, gen p mean: -0.09941733628511429, mean p set: 0.45013684034347534
loss_pred:0.016021572053432465, decouple_loss:0.0005724327056668699
Iteration: 356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45192012190818787, gen p mean: -0.09755908697843552, mean p set: 0.45249712467193604
loss_pred:0.015283363871276379, decouple_loss:0.0008876051288098097
The modified gen p mean: 0.4501606523990631, gen p mean: -0.1033155769109726, mean p set: 0.4507386088371277
The modified gen p mean: 0.4523158073425293, gen p mean: -0.09941240400075912, mean p set: 0.4528922438621521
loss_pred:0.01530154887586832, decouple_loss:0.0009670833242125809
loss_pred:0.015766652300953865, decouple_loss:0.0007035217131488025
Iteration: 357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505968987941742, gen p mean: -0.10389812290668488, mean p set: 0.45117518305778503
The modified gen p mean: 0.4520941972732544, gen p mean: -0.09767819195985794, mean p set: 0.4526708722114563
loss_pred:0.014899701811373234, decouple_loss:0.0008739972254261374
loss_pred:0.014944794587790966, decouple_loss:0.0010044535156339407
The modified gen p mean: 0.4526621401309967, gen p mean: -0.10650122910737991, mean p set: 0.45323994755744934
loss_pred:0.016104131937026978, decouple_loss:0.000625668908469379
Iteration: 358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528171122074127, gen p mean: -0.10761130601167679, mean p set: 0.45339396595954895
The modified gen p mean: 0.4519602060317993, gen p mean: -0.10630489885807037, mean p set: 0.4525359272956848
loss_pred:0.015908781439065933, decouple_loss:0.0007185024442151189
loss_pred:0.015605217777192593, decouple_loss:0.0006722784601151943
The modified gen p mean: 0.4517386555671692, gen p mean: -0.10817564278841019, mean p set: 0.4523157775402069
loss_pred:0.016100343316793442, decouple_loss:0.0007152562611736357
Iteration: 359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531847834587097, gen p mean: -0.11190153658390045, mean p set: 0.45376312732696533
The modified gen p mean: 0.4502878189086914, gen p mean: -0.11831305176019669, mean p set: 0.4508635997772217
loss_pred:0.015319048427045345, decouple_loss:0.00100889359600842
loss_pred:0.015831083059310913, decouple_loss:0.0011616356205195189
The modified gen p mean: 0.45000195503234863, gen p mean: -0.11165206879377365, mean p set: 0.4505784809589386
loss_pred:0.016238974407315254, decouple_loss:0.0010533601744100451
Iteration: 360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534110724925995, gen p mean: -0.113001748919487, mean p set: 0.4539874494075775
The modified gen p mean: 0.45317697525024414, gen p mean: -0.1139032170176506, mean p set: 0.45375579595565796
loss_pred:0.01521865651011467, decouple_loss:0.0015123625053092837
loss_pred:0.015539450570940971, decouple_loss:0.0014790584100410342
The modified gen p mean: 0.4512137174606323, gen p mean: -0.10659141093492508, mean p set: 0.4517900347709656
loss_pred:0.014874001033604145, decouple_loss:0.0010536187328398228
2023-05-01 16:43:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11387896537780762, mean p set: 0.4502691626548767
loss_pred:0.017219098284840584, decouple_loss:0.0007016582530923188
The modified gen p mean: 0.4495343267917633, gen p mean: -0.10795736312866211, mean p set: 0.4500633478164673
loss_pred:0.01671340875327587, decouple_loss:0.0009379961993545294
The modified gen p mean: 0.44977977871894836, gen p mean: -0.10707005858421326, mean p set: 0.45035696029663086
loss_pred:0.017112871631979942, decouple_loss:0.0008235510322265327
WV_1_PC_1_EH_0_PS_40, loss: 0.01705618016421795, avg_mse: 0.026392554864287376
current test mse: 0.026393
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012017_3_24hr.npz
NaN value num: 0
Iteration: 361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751355051994324, gen p mean: -0.11297047883272171, mean p set: 0.44808903336524963
loss_pred:0.017338858917355537, decouple_loss:0.0008031693869270384
The modified gen p mean: 0.44769784808158875, gen p mean: -0.10618788003921509, mean p set: 0.4482739567756653
loss_pred:0.01715804450213909, decouple_loss:0.0008197978022508323
The modified gen p mean: 0.44787466526031494, gen p mean: -0.10864033550024033, mean p set: 0.44845062494277954
loss_pred:0.017071615904569626, decouple_loss:0.0007889728876762092
Iteration: 362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720253348350525, gen p mean: -0.10319951921701431, mean p set: 0.44777801632881165
loss_pred:0.017154350876808167, decouple_loss:0.0010214948561042547
The modified gen p mean: 0.4476955533027649, gen p mean: -0.10611560195684433, mean p set: 0.4482729434967041The modified gen p mean: 0.44745782017707825, gen p mean: -0.11061539500951767, mean p set: 0.44803571701049805
loss_pred:0.017133716493844986, decouple_loss:0.0008035922655835748
loss_pred:0.01714562065899372, decouple_loss:0.0008973864023573697
Iteration: 363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785943627357483, gen p mean: -0.10266092419624329, mean p set: 0.44843775033950806
loss_pred:0.017238762229681015, decouple_loss:0.0009442628361284733
The modified gen p mean: 0.44733279943466187, gen p mean: -0.09347545355558395, mean p set: 0.4479096829891205
loss_pred:0.017496053129434586, decouple_loss:0.0009348674211651087
The modified gen p mean: 0.44784197211265564, gen p mean: -0.10375507175922394, mean p set: 0.44841820001602173
loss_pred:0.015950635075569153, decouple_loss:0.0008901496767066419
Iteration: 364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469012916088104, gen p mean: -0.09844553470611572, mean p set: 0.4474784731864929
loss_pred:0.01700083538889885, decouple_loss:0.000973702291958034
The modified gen p mean: 0.44855961203575134, gen p mean: -0.09656435251235962, mean p set: 0.4491376578807831
loss_pred:0.01785568706691265, decouple_loss:0.0008867933065630496
The modified gen p mean: 0.44815486669540405, gen p mean: -0.09595109522342682, mean p set: 0.4487318992614746
loss_pred:0.017033524811267853, decouple_loss:0.0009188988478854299
Iteration: 365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479166865348816, gen p mean: -0.1018240675330162, mean p set: 0.44848933815956116
loss_pred:0.016824863851070404, decouple_loss:0.0007539577782154083
The modified gen p mean: 0.4478454291820526, gen p mean: -0.10374248772859573, mean p set: 0.44842007756233215
loss_pred:0.016583891585469246, decouple_loss:0.000600579020101577
The modified gen p mean: 0.4475827217102051, gen p mean: -0.10097797214984894, mean p set: 0.44815748929977417
loss_pred:0.017368486151099205, decouple_loss:0.001046812511049211
Iteration: 366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482556879520416, gen p mean: -0.11056896299123764, mean p set: 0.44883155822753906
loss_pred:0.017208654433488846, decouple_loss:0.0008471051696687937
The modified gen p mean: 0.44715821743011475, gen p mean: -0.1056814193725586, mean p set: 0.4477321207523346
loss_pred:0.01804179698228836, decouple_loss:0.0008326272363774478
The modified gen p mean: 0.44891655445098877, gen p mean: -0.11280479282140732, mean p set: 0.44949179887771606
loss_pred:0.016652323305606842, decouple_loss:0.0008355394820682704
Iteration: 367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479765295982361, gen p mean: -0.11842792481184006, mean p set: 0.44855156540870667
loss_pred:0.015917940065264702, decouple_loss:0.0006927927606739104
The modified gen p mean: 0.4480629563331604, gen p mean: -0.11498059332370758, mean p set: 0.44863903522491455
loss_pred:0.017056286334991455, decouple_loss:0.0007937770569697022
The modified gen p mean: 0.4474049508571625, gen p mean: -0.10956557840108871, mean p set: 0.4479822516441345
loss_pred:0.017836347222328186, decouple_loss:0.0008997422410175204
Iteration: 368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475763440132141, gen p mean: -0.12155842036008835, mean p set: 0.4481523036956787
loss_pred:0.016816217452287674, decouple_loss:0.0005695509607903659
The modified gen p mean: 0.4481387138366699, gen p mean: -0.11505907773971558, mean p set: 0.4487142562866211
The modified gen p mean: 0.4476706385612488, gen p mean: -0.11854419112205505, mean p set: 0.4482477605342865
loss_pred:0.017209984362125397, decouple_loss:0.0008351796423085034
loss_pred:0.016649916768074036, decouple_loss:0.0008638458093628287
Iteration: 369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478015899658203, gen p mean: -0.1235550194978714, mean p set: 0.4483753740787506
loss_pred:0.015463978983461857, decouple_loss:0.0010650584008544683
The modified gen p mean: 0.4483749568462372, gen p mean: -0.11802145093679428, mean p set: 0.44895002245903015
loss_pred:0.017114605754613876, decouple_loss:0.0009220773354172707
The modified gen p mean: 0.44836485385894775, gen p mean: -0.11701904982328415, mean p set: 0.44894295930862427
loss_pred:0.016990769654512405, decouple_loss:0.0008452738984487951
Iteration: 370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877028465270996, gen p mean: -0.11257930099964142, mean p set: 0.4493470788002014
loss_pred:0.017196157947182655, decouple_loss:0.0007909896085038781
The modified gen p mean: 0.4483664333820343, gen p mean: -0.1104578822851181, mean p set: 0.44894248247146606
The modified gen p mean: 0.44787275791168213, gen p mean: -0.11510709673166275, mean p set: 0.4484483003616333
loss_pred:0.01701345108449459, decouple_loss:0.0006597739993594587
loss_pred:0.016840549185872078, decouple_loss:0.0008859536028467119
2023-05-01 16:46:25 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11577162146568298, mean p set: 0.4502691626548767
loss_pred:0.01731097139418125, decouple_loss:0.0006433447124436498
The modified gen p mean: 0.44953659176826477, gen p mean: -0.10963106900453568, mean p set: 0.4500633478164673
loss_pred:0.016691919416189194, decouple_loss:0.0007193118217401206
The modified gen p mean: 0.4497791826725006, gen p mean: -0.10854291915893555, mean p set: 0.45035696029663086
loss_pred:0.01692083477973938, decouple_loss:0.0006130888941697776
WV_1_PC_1_EH_0_PS_40, loss: 0.017007505521178246, avg_mse: 0.026418428868055344
current test mse: 0.026418
Iteration: 371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471670389175415, gen p mean: -0.10785305500030518, mean p set: 0.44774329662323
loss_pred:0.016685552895069122, decouple_loss:0.0006622540531679988
The modified gen p mean: 0.44756150245666504, gen p mean: -0.11127004772424698, mean p set: 0.4481372833251953The modified gen p mean: 0.4482980966567993, gen p mean: -0.11129755526781082, mean p set: 0.44887417554855347
loss_pred:0.017388949170708656, decouple_loss:0.0005617144051939249
loss_pred:0.01625901274383068, decouple_loss:0.0007416058797389269
Iteration: 372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488164186477661, gen p mean: -0.1106538325548172, mean p set: 0.4493922293186188
loss_pred:0.01696017198264599, decouple_loss:0.001006210339255631The modified gen p mean: 0.44829270243644714, gen p mean: -0.10433949530124664, mean p set: 0.44886863231658936
loss_pred:0.016910620033740997, decouple_loss:0.0009063993929885328
The modified gen p mean: 0.4476505517959595, gen p mean: -0.11044057458639145, mean p set: 0.4482278525829315
loss_pred:0.016354789957404137, decouple_loss:0.0005756382597610354
Iteration: 373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472845494747162, gen p mean: -0.11389733850955963, mean p set: 0.44785749912261963
loss_pred:0.017118949443101883, decouple_loss:0.0011814817553386092
The modified gen p mean: 0.44774049520492554, gen p mean: -0.11149968951940536, mean p set: 0.4483153223991394
loss_pred:0.016651131212711334, decouple_loss:0.0009978741873055696
The modified gen p mean: 0.44841518998146057, gen p mean: -0.11521665751934052, mean p set: 0.4489932656288147
loss_pred:0.016924899071455002, decouple_loss:0.0011738722678273916
Iteration: 374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724342226982117, gen p mean: -0.11065838485956192, mean p set: 0.4478190541267395
loss_pred:0.01724378764629364, decouple_loss:0.00102318380959332
The modified gen p mean: 0.44840195775032043, gen p mean: -0.11008071899414062, mean p set: 0.44897785782814026
loss_pred:0.01668471284210682, decouple_loss:0.0007567316642962396
The modified gen p mean: 0.4474225342273712, gen p mean: -0.11416696757078171, mean p set: 0.447996586561203
loss_pred:0.01727588288486004, decouple_loss:0.0010129683651030064
Iteration: 375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484075605869293, gen p mean: -0.11378931254148483, mean p set: 0.44898611307144165
loss_pred:0.016849886626005173, decouple_loss:0.0006194660090841353
The modified gen p mean: 0.4473484456539154, gen p mean: -0.1093859151005745, mean p set: 0.44792336225509644
loss_pred:0.01698094978928566, decouple_loss:0.0007301434525288641
The modified gen p mean: 0.4479611814022064, gen p mean: -0.11411716043949127, mean p set: 0.44853898882865906
loss_pred:0.016706006601452827, decouple_loss:0.0009037944837473333
Iteration: 376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474385380744934, gen p mean: -0.11002686619758606, mean p set: 0.4480125904083252
loss_pred:0.01683131419122219, decouple_loss:0.0007204163703136146
The modified gen p mean: 0.44746971130371094, gen p mean: -0.11092012375593185, mean p set: 0.44804492592811584
loss_pred:0.01673845387995243, decouple_loss:0.0009440330904908478
The modified gen p mean: 0.4469190239906311, gen p mean: -0.11171756684780121, mean p set: 0.4474940896034241
loss_pred:0.016948414966464043, decouple_loss:0.0009320104727521539
Iteration: 377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481375813484192, gen p mean: -0.11328885704278946, mean p set: 0.44871240854263306
loss_pred:0.01772155985236168, decouple_loss:0.0007176410872489214
The modified gen p mean: 0.4487719237804413, gen p mean: -0.1175941675901413, mean p set: 0.449349969625473
loss_pred:0.015978239476680756, decouple_loss:0.0007066187681630254
The modified gen p mean: 0.44827407598495483, gen p mean: -0.11265641450881958, mean p set: 0.4488488733768463
loss_pred:0.01689274050295353, decouple_loss:0.0007741107838228345
Iteration: 378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837430119514465, gen p mean: -0.11682328581809998, mean p set: 0.44894954562187195
The modified gen p mean: 0.44886550307273865, gen p mean: -0.11533511430025101, mean p set: 0.4494416415691376loss_pred:0.016323182731866837, decouple_loss:0.0005646899808198214
loss_pred:0.016965270042419434, decouple_loss:0.00054943683790043
The modified gen p mean: 0.44758233428001404, gen p mean: -0.12021639943122864, mean p set: 0.44815871119499207
loss_pred:0.01654103957116604, decouple_loss:0.000558209081646055
Iteration: 379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44809678196907043, gen p mean: -0.1163715198636055, mean p set: 0.44867268204689026
loss_pred:0.017153481021523476, decouple_loss:0.0007266030297614634
The modified gen p mean: 0.4479258060455322, gen p mean: -0.12182261794805527, mean p set: 0.4485030770301819
loss_pred:0.016343599185347557, decouple_loss:0.0006704253610223532
The modified gen p mean: 0.4472317695617676, gen p mean: -0.12171994149684906, mean p set: 0.4478082060813904
loss_pred:0.01692732609808445, decouple_loss:0.0008411305607296526
Iteration: 380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473310112953186, gen p mean: -0.11654911935329437, mean p set: 0.4479075074195862
loss_pred:0.01677137054502964, decouple_loss:0.000950378249399364
The modified gen p mean: 0.44826680421829224, gen p mean: -0.1231982409954071, mean p set: 0.4488413631916046
loss_pred:0.017042960971593857, decouple_loss:0.0009731707395985723
The modified gen p mean: 0.4475608766078949, gen p mean: -0.1253369003534317, mean p set: 0.4481373429298401
loss_pred:0.015242536552250385, decouple_loss:0.0008101637358777225
2023-05-01 16:48:31 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1271892488002777, mean p set: 0.4502691626548767
loss_pred:0.017226194962859154, decouple_loss:0.0006511289975605905
The modified gen p mean: 0.4495336711406708, gen p mean: -0.12061658501625061, mean p set: 0.4500633478164673
loss_pred:0.016562925651669502, decouple_loss:0.0007809714297764003
The modified gen p mean: 0.44978034496307373, gen p mean: -0.1197991669178009, mean p set: 0.45035696029663086
loss_pred:0.01688363030552864, decouple_loss:0.0006528960075229406
WV_1_PC_1_EH_0_PS_40, loss: 0.016925668343901634, avg_mse: 0.026294855400919914
current test mse: 0.026295
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012020_3_24hr.npz
NaN value num: 0
Iteration: 381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45348942279815674, gen p mean: -0.11094114184379578, mean p set: 0.45406532287597656
loss_pred:0.016344916075468063, decouple_loss:0.0008006775751709938
The modified gen p mean: 0.4532606303691864, gen p mean: -0.10912153124809265, mean p set: 0.45383843779563904
loss_pred:0.016974657773971558, decouple_loss:0.0008849706500768661
The modified gen p mean: 0.45448270440101624, gen p mean: -0.10992566496133804, mean p set: 0.4550575017929077
loss_pred:0.01653127744793892, decouple_loss:0.0008369594579562545
Iteration: 382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45343464612960815, gen p mean: -0.10608447343111038, mean p set: 0.45401036739349365
loss_pred:0.016605809330940247, decouple_loss:0.0008850074955262244
The modified gen p mean: 0.452324241399765, gen p mean: -0.10031557828187943, mean p set: 0.45290088653564453The modified gen p mean: 0.45260143280029297, gen p mean: -0.10859086364507675, mean p set: 0.45317837595939636
loss_pred:0.017620285972952843, decouple_loss:0.0008411029702983797
loss_pred:0.017420746386051178, decouple_loss:0.0008886682917363942
Iteration: 383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519101083278656, gen p mean: -0.10220063477754593, mean p set: 0.4524872601032257
loss_pred:0.016922948881983757, decouple_loss:0.0006482828175649047
The modified gen p mean: 0.45364969968795776, gen p mean: -0.10985550284385681, mean p set: 0.4542265832424164
loss_pred:0.01609337516129017, decouple_loss:0.0008696556906215847
The modified gen p mean: 0.45206668972969055, gen p mean: -0.10368628799915314, mean p set: 0.45264583826065063
loss_pred:0.016410555690526962, decouple_loss:0.0006780451512895525
Iteration: 384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536786675453186, gen p mean: -0.10881191492080688, mean p set: 0.45425722002983093
loss_pred:0.016570305451750755, decouple_loss:0.0008821800001896918
The modified gen p mean: 0.4538189172744751, gen p mean: -0.11019635200500488, mean p set: 0.45439663529396057
loss_pred:0.01591520383954048, decouple_loss:0.0007040390046313405
The modified gen p mean: 0.45213550329208374, gen p mean: -0.10999206453561783, mean p set: 0.4527115225791931
loss_pred:0.016419053077697754, decouple_loss:0.0009205968235619366
Iteration: 385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509071707725525, gen p mean: -0.10418638586997986, mean p set: 0.4514826238155365
loss_pred:0.01677027717232704, decouple_loss:0.0010914030717685819
The modified gen p mean: 0.4515240490436554, gen p mean: -0.10786515474319458, mean p set: 0.45210132002830505
loss_pred:0.01622171141207218, decouple_loss:0.0011234087869524956
The modified gen p mean: 0.4525368809700012, gen p mean: -0.10800854116678238, mean p set: 0.4531163275241852
loss_pred:0.016630547121167183, decouple_loss:0.0010881307534873486
Iteration: 386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4541883170604706, gen p mean: -0.11083382368087769, mean p set: 0.4547651410102844
loss_pred:0.016008593142032623, decouple_loss:0.0008169427164830267
The modified gen p mean: 0.4532069265842438, gen p mean: -0.10692501068115234, mean p set: 0.45378226041793823
loss_pred:0.016166342422366142, decouple_loss:0.000876970705576241
The modified gen p mean: 0.45389264822006226, gen p mean: -0.1067039966583252, mean p set: 0.4544689953327179
loss_pred:0.016147999092936516, decouple_loss:0.0007777607534080744
Iteration: 387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203015208244324, gen p mean: -0.1037716343998909, mean p set: 0.45260608196258545
loss_pred:0.016955045983195305, decouple_loss:0.0007522282539866865
The modified gen p mean: 0.45205748081207275, gen p mean: -0.10114583373069763, mean p set: 0.45263317227363586
loss_pred:0.016737962141633034, decouple_loss:0.0007561700185760856
The modified gen p mean: 0.4521608054637909, gen p mean: -0.1070730909705162, mean p set: 0.4527394771575928
loss_pred:0.017174744978547096, decouple_loss:0.0006526123615913093
Iteration: 388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524857997894287, gen p mean: -0.10452820360660553, mean p set: 0.45306307077407837
loss_pred:0.01688949577510357, decouple_loss:0.0006796244415454566
The modified gen p mean: 0.45204296708106995, gen p mean: -0.10809003561735153, mean p set: 0.45261943340301514
loss_pred:0.016951756551861763, decouple_loss:0.0010744542814791203
The modified gen p mean: 0.4541488587856293, gen p mean: -0.10693769156932831, mean p set: 0.45472750067710876
loss_pred:0.016012102365493774, decouple_loss:0.0008911775657907128
Iteration: 389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45302072167396545, gen p mean: -0.1078055202960968, mean p set: 0.4535987377166748
loss_pred:0.016181346029043198, decouple_loss:0.0009752162732183933
The modified gen p mean: 0.4531075358390808, gen p mean: -0.10546906292438507, mean p set: 0.45368504524230957
loss_pred:0.01766997203230858, decouple_loss:0.0006508110673166811
The modified gen p mean: 0.45443615317344666, gen p mean: -0.10744576156139374, mean p set: 0.45501336455345154
loss_pred:0.016543861478567123, decouple_loss:0.0006634143646806479
Iteration: 390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526376724243164, gen p mean: -0.10645491629838943, mean p set: 0.4532153010368347
loss_pred:0.01710319332778454, decouple_loss:0.0008541800198145211
The modified gen p mean: 0.45297279953956604, gen p mean: -0.10649126768112183, mean p set: 0.4535493850708008
The modified gen p mean: 0.4510526657104492, gen p mean: -0.10318651050329208, mean p set: 0.4516305923461914
loss_pred:0.0161186121404171, decouple_loss:0.0006725738057866693
loss_pred:0.01762252114713192, decouple_loss:0.0007721299771219492
2023-05-01 16:51:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12615542113780975, mean p set: 0.4502691626548767
loss_pred:0.017404165118932724, decouple_loss:0.0009237773483619094
The modified gen p mean: 0.44953545928001404, gen p mean: -0.11973758786916733, mean p set: 0.4500633478164673
loss_pred:0.016698133200407028, decouple_loss:0.0007008836837485433
The modified gen p mean: 0.4497826099395752, gen p mean: -0.11891534179449081, mean p set: 0.45035696029663086
loss_pred:0.016954293474555016, decouple_loss:0.0006769847823306918
WV_1_PC_1_EH_0_PS_40, loss: 0.017057225108146667, avg_mse: 0.026502475142478943
current test mse: 0.026502
Iteration: 391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513164162635803, gen p mean: -0.10339070111513138, mean p set: 0.4518945813179016
loss_pred:0.017026247456669807, decouple_loss:0.0007917477050796151
The modified gen p mean: 0.45143014192581177, gen p mean: -0.10410632193088531, mean p set: 0.45200714468955994The modified gen p mean: 0.45256027579307556, gen p mean: -0.10152754932641983, mean p set: 0.4531364440917969
loss_pred:0.01725076697766781, decouple_loss:0.000882165040820837
loss_pred:0.016789179295301437, decouple_loss:0.0009182923240587115
Iteration: 392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45251840353012085, gen p mean: -0.11098716408014297, mean p set: 0.4530949294567108
loss_pred:0.016732018440961838, decouple_loss:0.0007791924872435629
The modified gen p mean: 0.4522448778152466, gen p mean: -0.10823799669742584, mean p set: 0.4528234302997589The modified gen p mean: 0.4525122344493866, gen p mean: -0.10999822616577148, mean p set: 0.453086256980896
loss_pred:0.016232701018452644, decouple_loss:0.0009767418960109353loss_pred:0.016773849725723267, decouple_loss:0.0007654845830984414
Iteration: 393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45210427045822144, gen p mean: -0.10994316637516022, mean p set: 0.4526795446872711
loss_pred:0.01667964458465576, decouple_loss:0.0007193801575340331
The modified gen p mean: 0.4538326859474182, gen p mean: -0.10797137022018433, mean p set: 0.45440778136253357
loss_pred:0.01636560447514057, decouple_loss:0.0007896015886217356
The modified gen p mean: 0.45342233777046204, gen p mean: -0.10717089474201202, mean p set: 0.4539981782436371
loss_pred:0.01609252579510212, decouple_loss:0.000718817813321948
Iteration: 394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45369386672973633, gen p mean: -0.11190976947546005, mean p set: 0.45427173376083374
loss_pred:0.01617331989109516, decouple_loss:0.0008413650211878121
The modified gen p mean: 0.4519917666912079, gen p mean: -0.11154055595397949, mean p set: 0.45256906747817993
loss_pred:0.017127081751823425, decouple_loss:0.0006578476168215275
The modified gen p mean: 0.4530010521411896, gen p mean: -0.10615868866443634, mean p set: 0.4535783529281616
loss_pred:0.01595383696258068, decouple_loss:0.0006765805301256478
Iteration: 395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4540649354457855, gen p mean: -0.10875733196735382, mean p set: 0.45464229583740234
loss_pred:0.01601216569542885, decouple_loss:0.0007675915840081871
The modified gen p mean: 0.45081114768981934, gen p mean: -0.1046435534954071, mean p set: 0.4513874351978302
loss_pred:0.01649843342602253, decouple_loss:0.0006103119812905788
The modified gen p mean: 0.45162433385849, gen p mean: -0.10616429895162582, mean p set: 0.4522015452384949
loss_pred:0.017164960503578186, decouple_loss:0.000841004541143775
Iteration: 396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45328038930892944, gen p mean: -0.10798466205596924, mean p set: 0.4538586437702179
loss_pred:0.016438772901892662, decouple_loss:0.0007874713628552854
The modified gen p mean: 0.4528569281101227, gen p mean: -0.10262114554643631, mean p set: 0.4534352123737335
loss_pred:0.017217708751559258, decouple_loss:0.0006541472976095974
The modified gen p mean: 0.45419320464134216, gen p mean: -0.10450403392314911, mean p set: 0.45476964116096497
loss_pred:0.016314692795276642, decouple_loss:0.0008300977060571313
Iteration: 397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45272204279899597, gen p mean: -0.10068569332361221, mean p set: 0.4532998204231262
loss_pred:0.016314567998051643, decouple_loss:0.0007007434032857418
The modified gen p mean: 0.4523732364177704, gen p mean: -0.10046267509460449, mean p set: 0.452952116727829
loss_pred:0.016908664256334305, decouple_loss:0.0006098763551563025
The modified gen p mean: 0.45317813754081726, gen p mean: -0.10471487045288086, mean p set: 0.45375412702560425
loss_pred:0.015867767855525017, decouple_loss:0.0006963714258745313
Iteration: 398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45202353596687317, gen p mean: -0.10077788680791855, mean p set: 0.4526006579399109
loss_pred:0.01639336533844471, decouple_loss:0.0007455354207195342
The modified gen p mean: 0.4517129063606262, gen p mean: -0.10423853993415833, mean p set: 0.45228859782218933
The modified gen p mean: 0.4531687796115875, gen p mean: -0.1048414334654808, mean p set: 0.45374566316604614
loss_pred:0.016549285501241684, decouple_loss:0.0007418874884024262
loss_pred:0.016530316323041916, decouple_loss:0.0007035053567960858
Iteration: 399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536239802837372, gen p mean: -0.10581827908754349, mean p set: 0.45420005917549133
loss_pred:0.01574251614511013, decouple_loss:0.0007410568650811911
The modified gen p mean: 0.4528433680534363, gen p mean: -0.10832635313272476, mean p set: 0.45342111587524414
loss_pred:0.01596193201839924, decouple_loss:0.0009215467725880444
The modified gen p mean: 0.4532195031642914, gen p mean: -0.10263237357139587, mean p set: 0.4537944197654724
loss_pred:0.016332650557160378, decouple_loss:0.0006628044066019356
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012003_3_24hr.npz
NaN value num: 0
Iteration: 400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44751715660095215, gen p mean: -0.1169644370675087, mean p set: 0.4480896592140198
loss_pred:0.017626842483878136, decouple_loss:0.0008256779401563108
The modified gen p mean: 0.4479602575302124, gen p mean: -0.11502427607774734, mean p set: 0.4485383629798889
The modified gen p mean: 0.4495219588279724, gen p mean: -0.11468105763196945, mean p set: 0.4500986337661743
loss_pred:0.01683337427675724, decouple_loss:0.000841377885080874
loss_pred:0.01639713905751705, decouple_loss:0.0008773822337388992
2023-05-01 16:53:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12426621466875076, mean p set: 0.4502691626548767
loss_pred:0.01735696941614151, decouple_loss:0.0007299126009456813
The modified gen p mean: 0.44953465461730957, gen p mean: -0.11798714101314545, mean p set: 0.4500633478164673
loss_pred:0.016605518758296967, decouple_loss:0.0006406534230336547
The modified gen p mean: 0.44978079199790955, gen p mean: -0.11718422174453735, mean p set: 0.45035696029663086
loss_pred:0.01693388819694519, decouple_loss:0.0006219694041647017
WV_1_PC_1_EH_0_PS_40, loss: 0.016998667269945145, avg_mse: 0.02640019915997982
current test mse: 0.0264
Iteration: 401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44902878999710083, gen p mean: -0.12224060297012329, mean p set: 0.4496051073074341
loss_pred:0.017062736675143242, decouple_loss:0.0006824712618254125
The modified gen p mean: 0.44813814759254456, gen p mean: -0.1135420873761177, mean p set: 0.44871172308921814
loss_pred:0.01818794384598732, decouple_loss:0.0007652827189303935
The modified gen p mean: 0.44849422574043274, gen p mean: -0.11394549906253815, mean p set: 0.4490722715854645
loss_pred:0.017197726294398308, decouple_loss:0.0005998686538077891
Iteration: 402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483528435230255, gen p mean: -0.11955281347036362, mean p set: 0.44892963767051697
loss_pred:0.017567919567227364, decouple_loss:0.0007289000786840916
The modified gen p mean: 0.4478355050086975, gen p mean: -0.11969389766454697, mean p set: 0.44840967655181885The modified gen p mean: 0.4485400319099426, gen p mean: -0.122292160987854, mean p set: 0.4491157829761505
loss_pred:0.016462387517094612, decouple_loss:0.0008152176160365343
loss_pred:0.0165230855345726, decouple_loss:0.0008525388548150659
Iteration: 403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772592186927795, gen p mean: -0.1185612827539444, mean p set: 0.44830331206321716
loss_pred:0.017074741423130035, decouple_loss:0.0007534471806138754
The modified gen p mean: 0.4491673409938812, gen p mean: -0.11760381609201431, mean p set: 0.44974657893180847
loss_pred:0.01722773350775242, decouple_loss:0.0007293148082681
The modified gen p mean: 0.44852137565612793, gen p mean: -0.12189019471406937, mean p set: 0.4490949809551239
loss_pred:0.016652436926960945, decouple_loss:0.000798193970695138
Iteration: 404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774290919303894, gen p mean: -0.11696382611989975, mean p set: 0.44831764698028564
loss_pred:0.016617638990283012, decouple_loss:0.0007978067151270807
The modified gen p mean: 0.4467901885509491, gen p mean: -0.11205825954675674, mean p set: 0.44736447930336
loss_pred:0.017272016033530235, decouple_loss:0.0007243581931106746
The modified gen p mean: 0.4477917551994324, gen p mean: -0.11371704190969467, mean p set: 0.4483693838119507
loss_pred:0.016670851036906242, decouple_loss:0.0006878561107441783
Iteration: 405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477381408214569, gen p mean: -0.11690226942300797, mean p set: 0.44831374287605286
loss_pred:0.01627379283308983, decouple_loss:0.000667189946398139
The modified gen p mean: 0.45001447200775146, gen p mean: -0.12115776538848877, mean p set: 0.4505901634693146
loss_pred:0.01605435647070408, decouple_loss:0.000680267927236855
The modified gen p mean: 0.4472210109233856, gen p mean: -0.11455731093883514, mean p set: 0.44779375195503235
loss_pred:0.01711595617234707, decouple_loss:0.0006236971239559352
Iteration: 406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44964319467544556, gen p mean: -0.12348010390996933, mean p set: 0.4502195119857788
loss_pred:0.01570723205804825, decouple_loss:0.0006529877427965403
The modified gen p mean: 0.44810912013053894, gen p mean: -0.11625117063522339, mean p set: 0.44868478178977966
The modified gen p mean: 0.4466709494590759, gen p mean: -0.1130177453160286, mean p set: 0.4472479820251465
loss_pred:0.017024125903844833, decouple_loss:0.000577285944018513
loss_pred:0.016664225608110428, decouple_loss:0.0006654648459516466
Iteration: 407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481533467769623, gen p mean: -0.12154359370470047, mean p set: 0.4487301707267761
loss_pred:0.017105206847190857, decouple_loss:0.0006339285173453391
The modified gen p mean: 0.4470212161540985, gen p mean: -0.1157619059085846, mean p set: 0.44759565591812134
The modified gen p mean: 0.44748982787132263, gen p mean: -0.11965781450271606, mean p set: 0.44806647300720215
loss_pred:0.016263866797089577, decouple_loss:0.0005995928659103811
loss_pred:0.01602807082235813, decouple_loss:0.0007276645046658814
Iteration: 408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478148818016052, gen p mean: -0.118799589574337, mean p set: 0.44839203357696533
loss_pred:0.016338611021637917, decouple_loss:0.0005993366939947009
The modified gen p mean: 0.44758057594299316, gen p mean: -0.11871302127838135, mean p set: 0.44815659523010254
loss_pred:0.017003923654556274, decouple_loss:0.0006338789826259017
The modified gen p mean: 0.4479297995567322, gen p mean: -0.11677023023366928, mean p set: 0.4485076069831848
loss_pred:0.016995465382933617, decouple_loss:0.0007070534047670662
Iteration: 409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897258281707764, gen p mean: -0.11913952231407166, mean p set: 0.4495508372783661
loss_pred:0.016339300200343132, decouple_loss:0.001061666407622397
The modified gen p mean: 0.4472573697566986, gen p mean: -0.11043611168861389, mean p set: 0.4478336274623871
loss_pred:0.017636122182011604, decouple_loss:0.0008036062936298549
The modified gen p mean: 0.4494174122810364, gen p mean: -0.12037158012390137, mean p set: 0.4499904215335846
loss_pred:0.015648646280169487, decouple_loss:0.0006835515960119665
Iteration: 410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874194264411926, gen p mean: -0.1154991090297699, mean p set: 0.44931817054748535
loss_pred:0.01678103767335415, decouple_loss:0.0006648567505180836
The modified gen p mean: 0.44793227314949036, gen p mean: -0.11775270104408264, mean p set: 0.44850850105285645
loss_pred:0.017170703038573265, decouple_loss:0.0008445713319815695
The modified gen p mean: 0.44795656204223633, gen p mean: -0.1152939423918724, mean p set: 0.4485318660736084
loss_pred:0.016330258920788765, decouple_loss:0.0009579051984474063
2023-05-01 16:56:00 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12439507991075516, mean p set: 0.4502691626548767
loss_pred:0.017261650413274765, decouple_loss:0.000936169526539743
The modified gen p mean: 0.4495353400707245, gen p mean: -0.11796879768371582, mean p set: 0.4500633478164673
loss_pred:0.01649484410881996, decouple_loss:0.0007288617198355496
The modified gen p mean: 0.44977766275405884, gen p mean: -0.11684519797563553, mean p set: 0.45035696029663086
loss_pred:0.01690714620053768, decouple_loss:0.0007483773515559733
WV_1_PC_1_EH_0_PS_40, loss: 0.01692810468375683, avg_mse: 0.02627171389758587
current test mse: 0.026272
Iteration: 411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449301540851593, gen p mean: -0.11388935893774033, mean p set: 0.4498783349990845
loss_pred:0.0159946046769619, decouple_loss:0.0008649752708151937
The modified gen p mean: 0.44791802763938904, gen p mean: -0.11837312579154968, mean p set: 0.44849133491516113
loss_pred:0.016555512323975563, decouple_loss:0.0008982475847005844
The modified gen p mean: 0.44766542315483093, gen p mean: -0.1160457581281662, mean p set: 0.448240727186203
loss_pred:0.01592680625617504, decouple_loss:0.0007833261042833328
Iteration: 412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479256272315979, gen p mean: -0.11771009117364883, mean p set: 0.44850072264671326
loss_pred:0.01714562065899372, decouple_loss:0.0006258898647502065
The modified gen p mean: 0.44852423667907715, gen p mean: -0.11325126886367798, mean p set: 0.44909751415252686The modified gen p mean: 0.4479617476463318, gen p mean: -0.11213894933462143, mean p set: 0.44853708148002625
loss_pred:0.017444267868995667, decouple_loss:0.0007871550624258816
loss_pred:0.016996677964925766, decouple_loss:0.0006739622331224382
Iteration: 413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477001428604126, gen p mean: -0.11224590986967087, mean p set: 0.4482775628566742
loss_pred:0.016659094020724297, decouple_loss:0.000690982851665467
The modified gen p mean: 0.4478493630886078, gen p mean: -0.1174343153834343, mean p set: 0.44842690229415894
loss_pred:0.01608368195593357, decouple_loss:0.0010371953248977661
The modified gen p mean: 0.44871219992637634, gen p mean: -0.12040683627128601, mean p set: 0.4492875933647156
loss_pred:0.016775239259004593, decouple_loss:0.0008950087940320373
Iteration: 414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474487006664276, gen p mean: -0.11488903313875198, mean p set: 0.44802385568618774
loss_pred:0.017022043466567993, decouple_loss:0.0005653714179061353
The modified gen p mean: 0.44829797744750977, gen p mean: -0.11451562494039536, mean p set: 0.4488738775253296
loss_pred:0.015478774905204773, decouple_loss:0.0005832298193126917
The modified gen p mean: 0.44794294238090515, gen p mean: -0.11287514120340347, mean p set: 0.44851937890052795
loss_pred:0.01709953509271145, decouple_loss:0.0007486538961529732
Iteration: 415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478223919868469, gen p mean: -0.11448146402835846, mean p set: 0.44839733839035034
The modified gen p mean: 0.44776803255081177, gen p mean: -0.11925240606069565, mean p set: 0.44834303855895996
loss_pred:0.01685434952378273, decouple_loss:0.0007799426093697548
loss_pred:0.016337517648935318, decouple_loss:0.0008504778961651027
The modified gen p mean: 0.448111891746521, gen p mean: -0.11817574501037598, mean p set: 0.4486878216266632
loss_pred:0.016480183228850365, decouple_loss:0.0009118284797295928
Iteration: 416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498292803764343, gen p mean: -0.12465602159500122, mean p set: 0.4504074156284332
loss_pred:0.016329899430274963, decouple_loss:0.0008648104267194867
The modified gen p mean: 0.4493997097015381, gen p mean: -0.12695670127868652, mean p set: 0.4499753415584564
loss_pred:0.016473738476634026, decouple_loss:0.0009845838649198413
The modified gen p mean: 0.44926366209983826, gen p mean: -0.1252979040145874, mean p set: 0.44984182715415955
loss_pred:0.016045071184635162, decouple_loss:0.0011450863676145673
Iteration: 417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828251004219055, gen p mean: -0.12415870279073715, mean p set: 0.4488562047481537
loss_pred:0.0172042865306139, decouple_loss:0.0006704410188831389
The modified gen p mean: 0.44808512926101685, gen p mean: -0.12476447224617004, mean p set: 0.4486587643623352
loss_pred:0.01659421995282173, decouple_loss:0.0008120493730530143
The modified gen p mean: 0.4482117295265198, gen p mean: -0.12655581533908844, mean p set: 0.4487864673137665
loss_pred:0.016406036913394928, decouple_loss:0.0006460609147325158
Iteration: 418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864076375961304, gen p mean: -0.12641441822052002, mean p set: 0.4492185115814209
loss_pred:0.016420407220721245, decouple_loss:0.000800722511485219
The modified gen p mean: 0.4480665624141693, gen p mean: -0.12858925759792328, mean p set: 0.448641300201416
loss_pred:0.01633882150053978, decouple_loss:0.0008799338829703629
The modified gen p mean: 0.448256254196167, gen p mean: -0.1267206221818924, mean p set: 0.44883406162261963
loss_pred:0.01651378720998764, decouple_loss:0.0011057740775868297
Iteration: 419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44933342933654785, gen p mean: -0.12378917634487152, mean p set: 0.4499121904373169
loss_pred:0.01610403135418892, decouple_loss:0.0006883124588057399
The modified gen p mean: 0.4476568102836609, gen p mean: -0.12018457055091858, mean p set: 0.4482342600822449
The modified gen p mean: 0.44841238856315613, gen p mean: -0.12349193543195724, mean p set: 0.4489891827106476
loss_pred:0.01613241247832775, decouple_loss:0.000676007941365242
loss_pred:0.016839131712913513, decouple_loss:0.0006245951517485082
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012002_3_24hr.npz
NaN value num: 0
Iteration: 420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468143582344055, gen p mean: -0.11628884077072144, mean p set: 0.447394996881485
loss_pred:0.014810779131948948, decouple_loss:0.000723556790035218
The modified gen p mean: 0.44729042053222656, gen p mean: -0.11671027541160583, mean p set: 0.44786569476127625
The modified gen p mean: 0.4489116668701172, gen p mean: -0.12825177609920502, mean p set: 0.4494871497154236
loss_pred:0.014905097894370556, decouple_loss:0.0006379785481840372
loss_pred:0.01359584555029869, decouple_loss:0.0008328683325089514
2023-05-01 16:58:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12737885117530823, mean p set: 0.4502691626548767
loss_pred:0.01717294007539749, decouple_loss:0.00076707435073331
The modified gen p mean: 0.44953587651252747, gen p mean: -0.12105005979537964, mean p set: 0.4500633478164673
loss_pred:0.016429105773568153, decouple_loss:0.0006447130581364036
The modified gen p mean: 0.44977980852127075, gen p mean: -0.11991729587316513, mean p set: 0.45035696029663086
loss_pred:0.01692247949540615, decouple_loss:0.0007294627139344811
WV_1_PC_1_EH_0_PS_40, loss: 0.016877196729183197, avg_mse: 0.026239247992634773
current test mse: 0.026239
Iteration: 421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474645256996155, gen p mean: -0.11830990016460419, mean p set: 0.44803765416145325
loss_pred:0.015039459802210331, decouple_loss:0.0007276024552993476
The modified gen p mean: 0.4500970244407654, gen p mean: -0.11508005857467651, mean p set: 0.45067334175109863The modified gen p mean: 0.4476054906845093, gen p mean: -0.11421473324298859, mean p set: 0.4481779932975769
loss_pred:0.015687668696045876, decouple_loss:0.0008454222697764635loss_pred:0.014360840432345867, decouple_loss:0.0008608476491644979
Iteration: 422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483207166194916, gen p mean: -0.11840666830539703, mean p set: 0.44889771938323975
loss_pred:0.01573764719069004, decouple_loss:0.0005969739286229014
The modified gen p mean: 0.4475618302822113, gen p mean: -0.11986784636974335, mean p set: 0.4481402039527893The modified gen p mean: 0.4482801854610443, gen p mean: -0.12133590131998062, mean p set: 0.44885799288749695
loss_pred:0.014747085981070995, decouple_loss:0.0005490515031851828loss_pred:0.014646151103079319, decouple_loss:0.0006514004780910909
Iteration: 423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44898733496665955, gen p mean: -0.12242630124092102, mean p set: 0.4495624303817749
loss_pred:0.014398219995200634, decouple_loss:0.0010772678069770336
The modified gen p mean: 0.44733095169067383, gen p mean: -0.12561017274856567, mean p set: 0.4479064643383026
loss_pred:0.014754855073988438, decouple_loss:0.0007083668024279177
The modified gen p mean: 0.4485355615615845, gen p mean: -0.11788172274827957, mean p set: 0.44910773634910583
loss_pred:0.014232627116143703, decouple_loss:0.001011678366921842
Iteration: 424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515635669231415, gen p mean: -0.12358148396015167, mean p set: 0.4521370232105255
loss_pred:0.014531527645885944, decouple_loss:0.0010387669317424297
The modified gen p mean: 0.4499404728412628, gen p mean: -0.11990591138601303, mean p set: 0.4505176842212677
loss_pred:0.013931108638644218, decouple_loss:0.0010971687734127045
The modified gen p mean: 0.4485998749732971, gen p mean: -0.12132863700389862, mean p set: 0.449176549911499
loss_pred:0.014901435934007168, decouple_loss:0.0009388140751980245
Iteration: 425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740092754364014, gen p mean: -0.1279551237821579, mean p set: 0.4479774832725525
loss_pred:0.014383814297616482, decouple_loss:0.0006516680005006492
The modified gen p mean: 0.44966232776641846, gen p mean: -0.13170114159584045, mean p set: 0.45023879408836365
loss_pred:0.015000599436461926, decouple_loss:0.0007048184634186327
The modified gen p mean: 0.44863182306289673, gen p mean: -0.12971965968608856, mean p set: 0.44920656085014343
loss_pred:0.014867193065583706, decouple_loss:0.0006950329407118261
Iteration: 426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44830626249313354, gen p mean: -0.12754087150096893, mean p set: 0.4488815367221832
loss_pred:0.015827590599656105, decouple_loss:0.0007970969309099019
The modified gen p mean: 0.44881099462509155, gen p mean: -0.12577342987060547, mean p set: 0.4493841528892517
The modified gen p mean: 0.4471696615219116, gen p mean: -0.12425930798053741, mean p set: 0.447748064994812
loss_pred:0.014601372182369232, decouple_loss:0.0007325532496906817
loss_pred:0.014511927962303162, decouple_loss:0.0006926335045136511
Iteration: 427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44725245237350464, gen p mean: -0.12382687628269196, mean p set: 0.44782793521881104
loss_pred:0.015002640895545483, decouple_loss:0.0007068227860145271
The modified gen p mean: 0.4492569863796234, gen p mean: -0.12642060220241547, mean p set: 0.4498351216316223
The modified gen p mean: 0.4477598965167999, gen p mean: -0.1251041740179062, mean p set: 0.44833314418792725
loss_pred:0.014405370689928532, decouple_loss:0.0008294439176097512
loss_pred:0.015125507488846779, decouple_loss:0.0006294336053542793
Iteration: 428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745126366615295, gen p mean: -0.11927863210439682, mean p set: 0.4480287730693817
loss_pred:0.015395807102322578, decouple_loss:0.0005307360552251339
The modified gen p mean: 0.44660118222236633, gen p mean: -0.13002590835094452, mean p set: 0.447174608707428
The modified gen p mean: 0.44788795709609985, gen p mean: -0.12295449525117874, mean p set: 0.44846272468566895
loss_pred:0.015330101363360882, decouple_loss:0.0008139284327626228
loss_pred:0.013567770831286907, decouple_loss:0.0007914815214462578
Iteration: 429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732072949409485, gen p mean: -0.11759857833385468, mean p set: 0.4478965699672699
loss_pred:0.014801510609686375, decouple_loss:0.0010131191229447722
The modified gen p mean: 0.447160929441452, gen p mean: -0.11203556507825851, mean p set: 0.4477371871471405
loss_pred:0.01465850044041872, decouple_loss:0.0008121953578665853
The modified gen p mean: 0.4487496018409729, gen p mean: -0.1237960159778595, mean p set: 0.4493279755115509
loss_pred:0.013659950345754623, decouple_loss:0.001030031475238502
Iteration: 430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44870996475219727, gen p mean: -0.10940626263618469, mean p set: 0.4492860734462738
loss_pred:0.014558547176420689, decouple_loss:0.0006864781025797129
The modified gen p mean: 0.448660284280777, gen p mean: -0.11524142324924469, mean p set: 0.44923779368400574
The modified gen p mean: 0.44883808493614197, gen p mean: -0.11962410062551498, mean p set: 0.4494149386882782
loss_pred:0.01497685071080923, decouple_loss:0.0008252090192399919
loss_pred:0.014877398498356342, decouple_loss:0.000646280066575855
2023-05-01 17:00:47 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12109978497028351, mean p set: 0.4502691626548767
loss_pred:0.01717115007340908, decouple_loss:0.0006919563165865839
The modified gen p mean: 0.44953545928001404, gen p mean: -0.11442594975233078, mean p set: 0.4500633478164673
loss_pred:0.016360986977815628, decouple_loss:0.000806553871370852
The modified gen p mean: 0.4497794210910797, gen p mean: -0.11368472129106522, mean p set: 0.45035696029663086
loss_pred:0.016875527799129486, decouple_loss:0.0007012563291937113
WV_1_PC_1_EH_0_PS_40, loss: 0.016839219257235527, avg_mse: 0.02621990069746971
current test mse: 0.02622
Iteration: 431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470173418521881, gen p mean: -0.12038050591945648, mean p set: 0.4475933015346527
loss_pred:0.015030943788588047, decouple_loss:0.0006295544444583356
The modified gen p mean: 0.44809776544570923, gen p mean: -0.12023895233869553, mean p set: 0.44867387413978577The modified gen p mean: 0.4484669268131256, gen p mean: -0.11641427129507065, mean p set: 0.44904303550720215
loss_pred:0.015122441574931145, decouple_loss:0.0007806725334376097loss_pred:0.01475808396935463, decouple_loss:0.0008174387039616704
Iteration: 432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065274834632874, gen p mean: -0.11471816897392273, mean p set: 0.45123034715652466
loss_pred:0.014153472147881985, decouple_loss:0.0007691175560466945
The modified gen p mean: 0.44884946942329407, gen p mean: -0.11980687081813812, mean p set: 0.4494233727455139The modified gen p mean: 0.44756707549095154, gen p mean: -0.11411163210868835, mean p set: 0.44814345240592957
loss_pred:0.014753910712897778, decouple_loss:0.0006188193801790476
loss_pred:0.015143947675824165, decouple_loss:0.0007416729931719601
Iteration: 433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44827425479888916, gen p mean: -0.12211082875728607, mean p set: 0.44884639978408813
loss_pred:0.01440168172121048, decouple_loss:0.0008071109186857939
The modified gen p mean: 0.4495164752006531, gen p mean: -0.12318174540996552, mean p set: 0.45009157061576843
loss_pred:0.013661147095263004, decouple_loss:0.0007004716899245977
The modified gen p mean: 0.44798094034194946, gen p mean: -0.11557883769273758, mean p set: 0.4485572874546051
loss_pred:0.014818242751061916, decouple_loss:0.0007706655305810273
Iteration: 434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490286111831665, gen p mean: -0.1313963532447815, mean p set: 0.4496042728424072
loss_pred:0.013253730721771717, decouple_loss:0.0006425416795536876
The modified gen p mean: 0.4481014907360077, gen p mean: -0.12168297171592712, mean p set: 0.44867458939552307
loss_pred:0.01513068936765194, decouple_loss:0.001173697179183364
The modified gen p mean: 0.4482977092266083, gen p mean: -0.12130451947450638, mean p set: 0.44887375831604004
loss_pred:0.015354357659816742, decouple_loss:0.0009117285371758044
Iteration: 435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44962307810783386, gen p mean: -0.12826742231845856, mean p set: 0.45020073652267456
loss_pred:0.013660863041877747, decouple_loss:0.0008209160296246409
The modified gen p mean: 0.4490644335746765, gen p mean: -0.12492445111274719, mean p set: 0.4496400058269501
loss_pred:0.014179673977196217, decouple_loss:0.0006778744282200933
The modified gen p mean: 0.4478590190410614, gen p mean: -0.12204277515411377, mean p set: 0.44843384623527527
loss_pred:0.014655346982181072, decouple_loss:0.0007925323443487287
Iteration: 436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496607184410095, gen p mean: -0.11195608228445053, mean p set: 0.4502353370189667
loss_pred:0.014096121303737164, decouple_loss:0.0009256625780835748
The modified gen p mean: 0.44733405113220215, gen p mean: -0.11355836689472198, mean p set: 0.4479128420352936
loss_pred:0.014249596744775772, decouple_loss:0.0008130111964419484
The modified gen p mean: 0.448794424533844, gen p mean: -0.12451139092445374, mean p set: 0.4493709206581116
loss_pred:0.01460348442196846, decouple_loss:0.0008110514027066529
Iteration: 437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497041404247284, gen p mean: -0.11669536679983139, mean p set: 0.4502794146537781
loss_pred:0.014477191492915154, decouple_loss:0.0006141301128081977
The modified gen p mean: 0.4477582573890686, gen p mean: -0.11634338647127151, mean p set: 0.4483363628387451
loss_pred:0.014801202341914177, decouple_loss:0.0006786824087612331
The modified gen p mean: 0.4480186998844147, gen p mean: -0.11476559937000275, mean p set: 0.44859644770622253
loss_pred:0.01451293658465147, decouple_loss:0.0005533878575079143
Iteration: 438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853100180625916, gen p mean: -0.1181023120880127, mean p set: 0.44910797476768494
loss_pred:0.013904426246881485, decouple_loss:0.0006139545002952218
The modified gen p mean: 0.4481010138988495, gen p mean: -0.12179594486951828, mean p set: 0.44867774844169617
The modified gen p mean: 0.44985711574554443, gen p mean: -0.11141643673181534, mean p set: 0.4504365622997284
loss_pred:0.014678300358355045, decouple_loss:0.0009443158633075655
loss_pred:0.013620436191558838, decouple_loss:0.0006007296615280211
Iteration: 439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717609882354736, gen p mean: -0.11681927740573883, mean p set: 0.4477499723434448
loss_pred:0.014466051943600178, decouple_loss:0.0008220586460083723
The modified gen p mean: 0.4489780366420746, gen p mean: -0.10814981162548065, mean p set: 0.449554443359375
The modified gen p mean: 0.44669589400291443, gen p mean: -0.11840608716011047, mean p set: 0.4472704529762268
loss_pred:0.014258909970521927, decouple_loss:0.0005869158776476979
loss_pred:0.014506668783724308, decouple_loss:0.0006682947278022766
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012001_3_24hr.npz
NaN value num: 0
Iteration: 440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44627144932746887, gen p mean: -0.11387397348880768, mean p set: 0.44684743881225586
loss_pred:0.016797645017504692, decouple_loss:0.0007766251801513135
The modified gen p mean: 0.4465659558773041, gen p mean: -0.11980127543210983, mean p set: 0.44714057445526123
The modified gen p mean: 0.4452901780605316, gen p mean: -0.1203911304473877, mean p set: 0.4458634853363037
loss_pred:0.017734652385115623, decouple_loss:0.0007265793392434716
loss_pred:0.016579944640398026, decouple_loss:0.0006943126209080219
2023-05-01 17:03:31 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12211306393146515, mean p set: 0.4502691626548767
loss_pred:0.017191508784890175, decouple_loss:0.0006405416061170399
The modified gen p mean: 0.4495358467102051, gen p mean: -0.11541438102722168, mean p set: 0.4500633478164673
loss_pred:0.016428101807832718, decouple_loss:0.0007826086948625743
The modified gen p mean: 0.44978153705596924, gen p mean: -0.11487934738397598, mean p set: 0.45035696029663086
loss_pred:0.016827067360281944, decouple_loss:0.0007568506989628077
WV_1_PC_1_EH_0_PS_40, loss: 0.016851894557476044, avg_mse: 0.026262298226356506
current test mse: 0.026262
Iteration: 441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467078149318695, gen p mean: -0.11614090204238892, mean p set: 0.44728389382362366
loss_pred:0.017136013135313988, decouple_loss:0.0007308052154257894
The modified gen p mean: 0.44530683755874634, gen p mean: -0.11758051067590714, mean p set: 0.44588136672973633The modified gen p mean: 0.4472431242465973, gen p mean: -0.11645422130823135, mean p set: 0.44781720638275146
loss_pred:0.017131652683019638, decouple_loss:0.0006458532297983766
loss_pred:0.016819478943943977, decouple_loss:0.0006019679130986333
Iteration: 442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476469159126282, gen p mean: -0.11778101325035095, mean p set: 0.4482261538505554
loss_pred:0.016849374398589134, decouple_loss:0.0007180068641901016
The modified gen p mean: 0.4471549987792969, gen p mean: -0.11133228242397308, mean p set: 0.4477316439151764The modified gen p mean: 0.4461413621902466, gen p mean: -0.11115726083517075, mean p set: 0.4467185139656067
loss_pred:0.016830695793032646, decouple_loss:0.0006469278014265001
loss_pred:0.017153417691588402, decouple_loss:0.0008652106043882668
Iteration: 443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460720121860504, gen p mean: -0.11236544698476791, mean p set: 0.44664642214775085
loss_pred:0.016907699406147003, decouple_loss:0.0007545899716205895
The modified gen p mean: 0.44698023796081543, gen p mean: -0.11048246920108795, mean p set: 0.4475530982017517
loss_pred:0.01749352179467678, decouple_loss:0.0006068607326596975
The modified gen p mean: 0.44813793897628784, gen p mean: -0.10650765150785446, mean p set: 0.44871607422828674
loss_pred:0.016918940469622612, decouple_loss:0.0006255944026634097
Iteration: 444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490621089935303, gen p mean: -0.11545435339212418, mean p set: 0.44963929057121277
loss_pred:0.017405224964022636, decouple_loss:0.0007841400802135468
The modified gen p mean: 0.4459543526172638, gen p mean: -0.10878278315067291, mean p set: 0.4465305209159851
loss_pred:0.017072049900889397, decouple_loss:0.0006194901652634144
The modified gen p mean: 0.44654396176338196, gen p mean: -0.11446861177682877, mean p set: 0.4471185803413391
loss_pred:0.016681428998708725, decouple_loss:0.0009883182356134057
Iteration: 445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44558897614479065, gen p mean: -0.1141112744808197, mean p set: 0.4461638331413269
loss_pred:0.016504177823662758, decouple_loss:0.0006412986549548805
The modified gen p mean: 0.44930022954940796, gen p mean: -0.11488306522369385, mean p set: 0.44987761974334717
loss_pred:0.01631416194140911, decouple_loss:0.0006832380313426256
The modified gen p mean: 0.4481945335865021, gen p mean: -0.11520112305879593, mean p set: 0.4487701654434204
loss_pred:0.01630542427301407, decouple_loss:0.0007016887539066374
Iteration: 446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723397493362427, gen p mean: -0.11465033888816833, mean p set: 0.447811096906662
loss_pred:0.016478365287184715, decouple_loss:0.0005871733301319182
The modified gen p mean: 0.44869112968444824, gen p mean: -0.11725417524576187, mean p set: 0.44926485419273376
loss_pred:0.016778472810983658, decouple_loss:0.0006110880640335381
The modified gen p mean: 0.4459148645401001, gen p mean: -0.11699188500642776, mean p set: 0.4464896619319916
loss_pred:0.016697226092219353, decouple_loss:0.0005811818991787732
Iteration: 447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639095664024353, gen p mean: -0.11166657507419586, mean p set: 0.446968138217926
loss_pred:0.016643425449728966, decouple_loss:0.0006958741578273475
The modified gen p mean: 0.44600042700767517, gen p mean: -0.11636493355035782, mean p set: 0.44657647609710693
The modified gen p mean: 0.4470232129096985, gen p mean: -0.11402708292007446, mean p set: 0.4475998878479004
loss_pred:0.016589513048529625, decouple_loss:0.0009228899143636227
loss_pred:0.01752275601029396, decouple_loss:0.0006851342623122036
Iteration: 448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458431899547577, gen p mean: -0.11306504905223846, mean p set: 0.446418434381485
loss_pred:0.01668310910463333, decouple_loss:0.0006093950942158699
The modified gen p mean: 0.4457874596118927, gen p mean: -0.11934659630060196, mean p set: 0.446366548538208
loss_pred:0.017013195902109146, decouple_loss:0.0006937356083653867
The modified gen p mean: 0.4455953538417816, gen p mean: -0.11879675835371017, mean p set: 0.4461691081523895
loss_pred:0.016929954290390015, decouple_loss:0.0007901149219833314
Iteration: 449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44621479511260986, gen p mean: -0.11314105987548828, mean p set: 0.44678995013237
loss_pred:0.016572806984186172, decouple_loss:0.0008381460793316364
The modified gen p mean: 0.4480096101760864, gen p mean: -0.11310800909996033, mean p set: 0.44858571887016296
loss_pred:0.017476212233304977, decouple_loss:0.0010098249185830355
The modified gen p mean: 0.4452883303165436, gen p mean: -0.11485745012760162, mean p set: 0.44586169719696045
loss_pred:0.016438409686088562, decouple_loss:0.0007055829046294093
Iteration: 450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486081302165985, gen p mean: -0.11323116719722748, mean p set: 0.44918572902679443
The modified gen p mean: 0.448947936296463, gen p mean: -0.11183846741914749, mean p set: 0.44952526688575745
loss_pred:0.01705043762922287, decouple_loss:0.0006790363695472479
loss_pred:0.01614602841436863, decouple_loss:0.0005219331360422075
The modified gen p mean: 0.44557517766952515, gen p mean: -0.11032731086015701, mean p set: 0.4461515247821808
loss_pred:0.016541266813874245, decouple_loss:0.0006468729698099196
2023-05-01 17:05:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12434719502925873, mean p set: 0.4502691626548767
loss_pred:0.017382925376296043, decouple_loss:0.0005365778924897313
The modified gen p mean: 0.44953685998916626, gen p mean: -0.1180352121591568, mean p set: 0.4500633478164673
loss_pred:0.01661359705030918, decouple_loss:0.0007104505784809589
The modified gen p mean: 0.44978073239326477, gen p mean: -0.11771519482135773, mean p set: 0.45035696029663086
loss_pred:0.016994450241327286, decouple_loss:0.0007105389959178865
WV_1_PC_1_EH_0_PS_40, loss: 0.017029616981744766, avg_mse: 0.02646256983280182
current test mse: 0.026463
Iteration: 451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719716906547546, gen p mean: -0.11768791079521179, mean p set: 0.44777223467826843
loss_pred:0.017024807631969452, decouple_loss:0.0005476911901496351
The modified gen p mean: 0.44742876291275024, gen p mean: -0.12363553047180176, mean p set: 0.4480063021183014The modified gen p mean: 0.44669318199157715, gen p mean: -0.11862122267484665, mean p set: 0.44727084040641785
loss_pred:0.0165563952177763, decouple_loss:0.0005345185054466128loss_pred:0.016351735219359398, decouple_loss:0.00065939238993451
Iteration: 452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640013575553894, gen p mean: -0.12318436056375504, mean p set: 0.4469790756702423
loss_pred:0.016371143981814384, decouple_loss:0.0008308784454129636
The modified gen p mean: 0.4462340474128723, gen p mean: -0.12852557003498077, mean p set: 0.44681212306022644The modified gen p mean: 0.4470977187156677, gen p mean: -0.12816205620765686, mean p set: 0.4476713538169861
loss_pred:0.016812676563858986, decouple_loss:0.0006434578681364655
loss_pred:0.016983261331915855, decouple_loss:0.0007687819306738675
Iteration: 453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784262776374817, gen p mean: -0.13607196509838104, mean p set: 0.4484156668186188
loss_pred:0.016569573432207108, decouple_loss:0.0004840633482672274
The modified gen p mean: 0.4463188052177429, gen p mean: -0.13531352579593658, mean p set: 0.4468950033187866
loss_pred:0.016336606815457344, decouple_loss:0.0005411094753071666
The modified gen p mean: 0.4474834203720093, gen p mean: -0.13050168752670288, mean p set: 0.4480586051940918
loss_pred:0.01648162119090557, decouple_loss:0.0005691525875590742
Iteration: 454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748589396476746, gen p mean: -0.1289164125919342, mean p set: 0.4480617940425873
loss_pred:0.016577012836933136, decouple_loss:0.0007323558093048632
The modified gen p mean: 0.4458247423171997, gen p mean: -0.13299717009067535, mean p set: 0.44640052318573
loss_pred:0.01633947342634201, decouple_loss:0.0006130055407993495
The modified gen p mean: 0.4458366334438324, gen p mean: -0.12959888577461243, mean p set: 0.44641271233558655
loss_pred:0.016458729282021523, decouple_loss:0.0005879286327399313
Iteration: 455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878605008125305, gen p mean: -0.12034296989440918, mean p set: 0.4493609070777893
loss_pred:0.01680877059698105, decouple_loss:0.0006229021237231791
The modified gen p mean: 0.4469808340072632, gen p mean: -0.1268506497144699, mean p set: 0.4475557208061218
loss_pred:0.017391234636306763, decouple_loss:0.0006429979111999273
The modified gen p mean: 0.4470294713973999, gen p mean: -0.12722466886043549, mean p set: 0.44760608673095703
loss_pred:0.017695648595690727, decouple_loss:0.0007014459115453064
Iteration: 456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44712942838668823, gen p mean: -0.1232578232884407, mean p set: 0.44770559668540955
loss_pred:0.016041545197367668, decouple_loss:0.0005867306026630104
The modified gen p mean: 0.44671306014060974, gen p mean: -0.12793514132499695, mean p set: 0.44728726148605347
loss_pred:0.016331933438777924, decouple_loss:0.0006091112736612558
The modified gen p mean: 0.4479776620864868, gen p mean: -0.12307707220315933, mean p set: 0.4485533535480499
loss_pred:0.016750764101743698, decouple_loss:0.0006619663327001035
Iteration: 457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724932312965393, gen p mean: -0.12009243667125702, mean p set: 0.4478236734867096
loss_pred:0.017312010750174522, decouple_loss:0.0007733295788057148
The modified gen p mean: 0.44821104407310486, gen p mean: -0.11645221710205078, mean p set: 0.4487886130809784
loss_pred:0.01631363481283188, decouple_loss:0.0005408926517702639
The modified gen p mean: 0.4470505118370056, gen p mean: -0.11965178698301315, mean p set: 0.4476267099380493
loss_pred:0.017566028982400894, decouple_loss:0.000688268686644733
Iteration: 458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464016258716583, gen p mean: -0.11959875375032425, mean p set: 0.4469743072986603
loss_pred:0.01673247665166855, decouple_loss:0.0006217596237547696
The modified gen p mean: 0.4464760720729828, gen p mean: -0.11793375760316849, mean p set: 0.4470517337322235
The modified gen p mean: 0.44578778743743896, gen p mean: -0.12192423641681671, mean p set: 0.44636404514312744
loss_pred:0.01682894676923752, decouple_loss:0.0005740039050579071
loss_pred:0.016889890655875206, decouple_loss:0.0006065985071472824
Iteration: 459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820061326026917, gen p mean: -0.11943835765123367, mean p set: 0.4487777352333069
loss_pred:0.016694528982043266, decouple_loss:0.0005592736415565014
The modified gen p mean: 0.44622477889060974, gen p mean: -0.11839283257722855, mean p set: 0.44680410623550415
The modified gen p mean: 0.44551771879196167, gen p mean: -0.12246552854776382, mean p set: 0.44609320163726807
loss_pred:0.016487611457705498, decouple_loss:0.0008499829564243555
loss_pred:0.01586511917412281, decouple_loss:0.0006564366049133241
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012015_3_24hr.npz
NaN value num: 0
Iteration: 460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501418173313141, gen p mean: -0.12043839693069458, mean p set: 0.4507175385951996
loss_pred:0.015719139948487282, decouple_loss:0.0006353150820359588
The modified gen p mean: 0.45239487290382385, gen p mean: -0.11548599600791931, mean p set: 0.4529705345630646
The modified gen p mean: 0.45112869143486023, gen p mean: -0.1122705340385437, mean p set: 0.4517059326171875
loss_pred:0.016443554311990738, decouple_loss:0.0009159405599348247
loss_pred:0.01797165349125862, decouple_loss:0.0010050999699160457
2023-05-01 17:08:18 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12666289508342743, mean p set: 0.4502691626548767
loss_pred:0.017277004197239876, decouple_loss:0.0005750029813498259
The modified gen p mean: 0.4495355188846588, gen p mean: -0.12017983943223953, mean p set: 0.4500633478164673
loss_pred:0.0165887288749218, decouple_loss:0.0006912669050507247
The modified gen p mean: 0.4497813582420349, gen p mean: -0.11941391229629517, mean p set: 0.45035696029663086
loss_pred:0.01693621836602688, decouple_loss:0.0006317308871075511
WV_1_PC_1_EH_0_PS_40, loss: 0.01696561649441719, avg_mse: 0.026452019810676575
current test mse: 0.026452
Iteration: 461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900065660476685, gen p mean: -0.11584597826004028, mean p set: 0.4495759904384613
loss_pred:0.017033834010362625, decouple_loss:0.0007293683593161404
The modified gen p mean: 0.4495007395744324, gen p mean: -0.1161264032125473, mean p set: 0.4500787556171417
The modified gen p mean: 0.44985365867614746, gen p mean: -0.11576006561517715, mean p set: 0.45042943954467773
loss_pred:0.016694795340299606, decouple_loss:0.0006314908969216049
loss_pred:0.016413673758506775, decouple_loss:0.0006066975765861571
Iteration: 462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048800110816956, gen p mean: -0.12307097762823105, mean p set: 0.45106494426727295
loss_pred:0.01578577421605587, decouple_loss:0.0006497107679024339
The modified gen p mean: 0.4527307450771332, gen p mean: -0.10763202607631683, mean p set: 0.45330584049224854The modified gen p mean: 0.45090994238853455, gen p mean: -0.10890531539916992, mean p set: 0.45148617029190063
loss_pred:0.016955701634287834, decouple_loss:0.0007888289401307702
loss_pred:0.017113620415329933, decouple_loss:0.000726877769920975
Iteration: 463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487195312976837, gen p mean: -0.11336041241884232, mean p set: 0.44929495453834534
loss_pred:0.016039803624153137, decouple_loss:0.0006816041423007846
The modified gen p mean: 0.4531625211238861, gen p mean: -0.10959070920944214, mean p set: 0.45373791456222534
loss_pred:0.017213381826877594, decouple_loss:0.0007929307175800204
The modified gen p mean: 0.4491301476955414, gen p mean: -0.11695051938295364, mean p set: 0.4497094452381134
loss_pred:0.01603100635111332, decouple_loss:0.0008046982693485916
Iteration: 464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497295320034027, gen p mean: -0.11551161855459213, mean p set: 0.45030519366264343
loss_pred:0.01537903118878603, decouple_loss:0.0007263529696501791
The modified gen p mean: 0.44902533292770386, gen p mean: -0.11607563495635986, mean p set: 0.4496016502380371
loss_pred:0.01605532132089138, decouple_loss:0.0005954534863121808
The modified gen p mean: 0.44910192489624023, gen p mean: -0.11321640759706497, mean p set: 0.4496786296367645
loss_pred:0.015864180400967598, decouple_loss:0.0006772751221433282
Iteration: 465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516476094722748, gen p mean: -0.10675425082445145, mean p set: 0.45222410559654236
loss_pred:0.0166360754519701, decouple_loss:0.000795306172221899
The modified gen p mean: 0.44964441657066345, gen p mean: -0.11338821053504944, mean p set: 0.450222373008728
loss_pred:0.015923043712973595, decouple_loss:0.0007646839949302375
The modified gen p mean: 0.4497627317905426, gen p mean: -0.11856534332036972, mean p set: 0.4503369629383087
loss_pred:0.016129229217767715, decouple_loss:0.000663568964228034
Iteration: 466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481716454029083, gen p mean: -0.11597695201635361, mean p set: 0.4487481415271759
loss_pred:0.015976501628756523, decouple_loss:0.0008250399259850383
The modified gen p mean: 0.44899365305900574, gen p mean: -0.11188726127147675, mean p set: 0.4495715796947479
The modified gen p mean: 0.45001220703125, gen p mean: -0.1075287014245987, mean p set: 0.4505888819694519
loss_pred:0.015828890725970268, decouple_loss:0.0008283468778245151
loss_pred:0.016549982130527496, decouple_loss:0.0008710509864613414
Iteration: 467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506794512271881, gen p mean: -0.10878487676382065, mean p set: 0.45125457644462585
loss_pred:0.016105417162179947, decouple_loss:0.0009213934536091983
The modified gen p mean: 0.4504360854625702, gen p mean: -0.11056609451770782, mean p set: 0.45101216435432434
The modified gen p mean: 0.45104649662971497, gen p mean: -0.10869823396205902, mean p set: 0.45162320137023926
loss_pred:0.016184493899345398, decouple_loss:0.0008557807304896414
loss_pred:0.016329091042280197, decouple_loss:0.0010221751872450113
Iteration: 468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507986307144165, gen p mean: -0.10961662232875824, mean p set: 0.4513741731643677
loss_pred:0.015406060963869095, decouple_loss:0.0006267623975872993
The modified gen p mean: 0.4491628110408783, gen p mean: -0.11633343994617462, mean p set: 0.4497406780719757
loss_pred:0.015321504324674606, decouple_loss:0.0006544313509948552
The modified gen p mean: 0.4485122859477997, gen p mean: -0.10532069206237793, mean p set: 0.4490891993045807
loss_pred:0.01650608703494072, decouple_loss:0.0007590127643197775
Iteration: 469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496895670890808, gen p mean: -0.11418738216161728, mean p set: 0.4502660930156708
The modified gen p mean: 0.44888389110565186, gen p mean: -0.10737594217061996, mean p set: 0.4494609236717224
loss_pred:0.01589115895330906, decouple_loss:0.0007095338078215718
loss_pred:0.016061479225754738, decouple_loss:0.0007761567831039429
The modified gen p mean: 0.4509149491786957, gen p mean: -0.10480037331581116, mean p set: 0.45149263739585876
loss_pred:0.015629474073648453, decouple_loss:0.0007668556645512581
Iteration: 470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832736253738403, gen p mean: -0.10890966653823853, mean p set: 0.4489029347896576
loss_pred:0.01542839128524065, decouple_loss:0.000803764967713505
The modified gen p mean: 0.4503896236419678, gen p mean: -0.098939448595047, mean p set: 0.450965940952301
loss_pred:0.01594848744571209, decouple_loss:0.000988540006801486
The modified gen p mean: 0.4483465552330017, gen p mean: -0.10944536328315735, mean p set: 0.44892165064811707
loss_pred:0.015942756086587906, decouple_loss:0.0006844978197477758
2023-05-01 17:10:23 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1136278286576271, mean p set: 0.4502691626548767
loss_pred:0.017332928255200386, decouple_loss:0.0007125803385861218
The modified gen p mean: 0.44953396916389465, gen p mean: -0.10763304680585861, mean p set: 0.4500633478164673
loss_pred:0.016664866358041763, decouple_loss:0.0007792972610332072
The modified gen p mean: 0.4497809112071991, gen p mean: -0.10725601017475128, mean p set: 0.45035696029663086
loss_pred:0.01702600158751011, decouple_loss:0.0007730990764684975
WV_1_PC_1_EH_0_PS_40, loss: 0.017045682296156883, avg_mse: 0.02643183432519436
current test mse: 0.026432
Iteration: 471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855546951293945, gen p mean: -0.10546387732028961, mean p set: 0.4491318166255951
loss_pred:0.016108915209770203, decouple_loss:0.0007056204485706985
The modified gen p mean: 0.45102161169052124, gen p mean: -0.09745293855667114, mean p set: 0.4515989124774933
loss_pred:0.016971509903669357, decouple_loss:0.0008257405133917928
The modified gen p mean: 0.44948041439056396, gen p mean: -0.10700534284114838, mean p set: 0.45005717873573303
loss_pred:0.016139600425958633, decouple_loss:0.0006735377246513963
Iteration: 472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44941437244415283, gen p mean: -0.09924082458019257, mean p set: 0.44999220967292786
loss_pred:0.015442004427313805, decouple_loss:0.0006282873218879104
The modified gen p mean: 0.45089367032051086, gen p mean: -0.0880901962518692, mean p set: 0.45147207379341125The modified gen p mean: 0.44961535930633545, gen p mean: -0.10273522883653641, mean p set: 0.4501922130584717
loss_pred:0.01660213991999626, decouple_loss:0.0007570666493847966loss_pred:0.015831993892788887, decouple_loss:0.0006246304837986827
Iteration: 473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485678970813751, gen p mean: -0.09500422328710556, mean p set: 0.44914600253105164
loss_pred:0.01583646982908249, decouple_loss:0.0007176861981861293
The modified gen p mean: 0.45040199160575867, gen p mean: -0.0981641560792923, mean p set: 0.45097601413726807
loss_pred:0.01687253825366497, decouple_loss:0.0007874878356233239
The modified gen p mean: 0.449473112821579, gen p mean: -0.0940704345703125, mean p set: 0.45004913210868835
loss_pred:0.016469677910208702, decouple_loss:0.0006907120696268976
Iteration: 474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487950801849365, gen p mean: -0.10105414688587189, mean p set: 0.4493706524372101
loss_pred:0.01581021212041378, decouple_loss:0.0007949290447868407
The modified gen p mean: 0.45015376806259155, gen p mean: -0.10438782721757889, mean p set: 0.4507306218147278
loss_pred:0.01563667319715023, decouple_loss:0.0006966367946006358
The modified gen p mean: 0.44880956411361694, gen p mean: -0.10129109770059586, mean p set: 0.44938743114471436
loss_pred:0.015530092641711235, decouple_loss:0.0006278252112679183
Iteration: 475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45162972807884216, gen p mean: -0.0972616970539093, mean p set: 0.45220720767974854
loss_pred:0.01628226414322853, decouple_loss:0.0008444157429039478
The modified gen p mean: 0.4519057869911194, gen p mean: -0.10212177783250809, mean p set: 0.4524822235107422
loss_pred:0.01643209159374237, decouple_loss:0.0016220168909057975
The modified gen p mean: 0.45136386156082153, gen p mean: -0.0916251689195633, mean p set: 0.45194050669670105
loss_pred:0.016348425298929214, decouple_loss:0.0010338736465200782
Iteration: 476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893479347229004, gen p mean: -0.10867823660373688, mean p set: 0.4495096802711487
loss_pred:0.015743453055620193, decouple_loss:0.0005696275038644671
The modified gen p mean: 0.4500945806503296, gen p mean: -0.1124873161315918, mean p set: 0.45067140460014343
loss_pred:0.01564795710146427, decouple_loss:0.0006756434449926019
The modified gen p mean: 0.4507036805152893, gen p mean: -0.10484883934259415, mean p set: 0.45127683877944946
loss_pred:0.01524229347705841, decouple_loss:0.0006963607156649232
Iteration: 477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527878165245056, gen p mean: -0.1014881506562233, mean p set: 0.4533670246601105
loss_pred:0.015934988856315613, decouple_loss:0.0009065840858966112
The modified gen p mean: 0.4509783387184143, gen p mean: -0.09236279875040054, mean p set: 0.4515543580055237
loss_pred:0.016614029183983803, decouple_loss:0.0012238462222740054
The modified gen p mean: 0.44903695583343506, gen p mean: -0.10553411394357681, mean p set: 0.44961294531822205
loss_pred:0.01613398641347885, decouple_loss:0.0008946398738771677
Iteration: 478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968706369400024, gen p mean: -0.10415428131818771, mean p set: 0.45026499032974243
loss_pred:0.01490819826722145, decouple_loss:0.0008543424191884696
The modified gen p mean: 0.4490339457988739, gen p mean: -0.10015714913606644, mean p set: 0.4496089518070221
loss_pred:0.016981452703475952, decouple_loss:0.0011458918452262878
The modified gen p mean: 0.44822967052459717, gen p mean: -0.10567228496074677, mean p set: 0.44880592823028564
loss_pred:0.015846718102693558, decouple_loss:0.0010467772372066975
Iteration: 479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040208101272583, gen p mean: -0.09966651350259781, mean p set: 0.45097923278808594
loss_pred:0.015632476657629013, decouple_loss:0.0007444758084602654
The modified gen p mean: 0.4483638405799866, gen p mean: -0.10265382379293442, mean p set: 0.4489399194717407
The modified gen p mean: 0.4492076337337494, gen p mean: -0.1034708023071289, mean p set: 0.4497845768928528
loss_pred:0.015412122011184692, decouple_loss:0.0006661378429271281
loss_pred:0.01647147350013256, decouple_loss:0.0005936344969086349
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012008_3_24hr.npz
NaN value num: 0
Iteration: 480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501972198486328, gen p mean: -0.10987360775470734, mean p set: 0.4507721960544586
loss_pred:0.015901310369372368, decouple_loss:0.001132567529566586
The modified gen p mean: 0.45021697878837585, gen p mean: -0.10935299098491669, mean p set: 0.45079004764556885
The modified gen p mean: 0.44920435547828674, gen p mean: -0.10256519168615341, mean p set: 0.4497811496257782
loss_pred:0.01596376672387123, decouple_loss:0.001251462148502469
loss_pred:0.01703021675348282, decouple_loss:0.001333461725153029
2023-05-01 17:13:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11331469565629959, mean p set: 0.4502691626548767
loss_pred:0.017250219359993935, decouple_loss:0.0010513645829632878
The modified gen p mean: 0.4495351314544678, gen p mean: -0.10684197396039963, mean p set: 0.4500633478164673
loss_pred:0.016639744862914085, decouple_loss:0.0013592260656878352
The modified gen p mean: 0.4497816264629364, gen p mean: -0.10621815919876099, mean p set: 0.45035696029663086
loss_pred:0.01694376766681671, decouple_loss:0.0016097506741061807
WV_1_PC_1_EH_0_PS_40, loss: 0.017011582851409912, avg_mse: 0.02636777237057686
current test mse: 0.026368
Iteration: 481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507330358028412, gen p mean: -0.10531679540872574, mean p set: 0.45131051540374756
loss_pred:0.0172963235527277, decouple_loss:0.0013539890060201287
The modified gen p mean: 0.4477420747280121, gen p mean: -0.10481850057840347, mean p set: 0.44831863045692444
loss_pred:0.017085064202547073, decouple_loss:0.001425000256858766
The modified gen p mean: 0.44787734746932983, gen p mean: -0.10400249063968658, mean p set: 0.4484533667564392
loss_pred:0.01668446511030197, decouple_loss:0.0011615755502134562
Iteration: 482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482020139694214, gen p mean: -0.10476700216531754, mean p set: 0.4487801790237427
loss_pred:0.015514102764427662, decouple_loss:0.0008137951954267919
The modified gen p mean: 0.44898125529289246, gen p mean: -0.10486488789319992, mean p set: 0.4495590031147003The modified gen p mean: 0.4493032991886139, gen p mean: -0.09985911101102829, mean p set: 0.4498787224292755
loss_pred:0.01632879674434662, decouple_loss:0.0008264884236268699
loss_pred:0.015457389876246452, decouple_loss:0.0007581544923596084
Iteration: 483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905954599380493, gen p mean: -0.1078328937292099, mean p set: 0.44963738322257996
loss_pred:0.015869304537773132, decouple_loss:0.0011332996655255556
The modified gen p mean: 0.44763413071632385, gen p mean: -0.10409120470285416, mean p set: 0.44821181893348694
loss_pred:0.015660002827644348, decouple_loss:0.0009932967368513346
The modified gen p mean: 0.44990336894989014, gen p mean: -0.10953861474990845, mean p set: 0.450480192899704
loss_pred:0.016484295949339867, decouple_loss:0.0013228440657258034
Iteration: 484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978436827659607, gen p mean: -0.10017754882574081, mean p set: 0.450359970331192
loss_pred:0.015201452188193798, decouple_loss:0.0010698015103116632
The modified gen p mean: 0.4485352337360382, gen p mean: -0.10134246945381165, mean p set: 0.44911229610443115
loss_pred:0.015963107347488403, decouple_loss:0.0008907492738217115
The modified gen p mean: 0.449152410030365, gen p mean: -0.10018658638000488, mean p set: 0.44972777366638184
loss_pred:0.015848740935325623, decouple_loss:0.0009962221374735236
Iteration: 485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759097695350647, gen p mean: -0.10945338755846024, mean p set: 0.44816452264785767
loss_pred:0.016337284818291664, decouple_loss:0.0010815749410539865
The modified gen p mean: 0.4495086073875427, gen p mean: -0.10831500589847565, mean p set: 0.4500848054885864
loss_pred:0.016977816820144653, decouple_loss:0.0008236488793045282
The modified gen p mean: 0.4475356340408325, gen p mean: -0.10958269238471985, mean p set: 0.4481101632118225
loss_pred:0.01560151670128107, decouple_loss:0.0006738755037076771
Iteration: 486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450248658657074, gen p mean: -0.11123894155025482, mean p set: 0.45082634687423706
loss_pred:0.015314494259655476, decouple_loss:0.0007958066998980939
The modified gen p mean: 0.4494945704936981, gen p mean: -0.11886676400899887, mean p set: 0.4500705897808075
loss_pred:0.01539553701877594, decouple_loss:0.0007980928639881313
The modified gen p mean: 0.448590487241745, gen p mean: -0.11602302640676498, mean p set: 0.44916728138923645
loss_pred:0.015200331807136536, decouple_loss:0.000685810693539679
Iteration: 487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491012692451477, gen p mean: -0.12186004221439362, mean p set: 0.44967490434646606
loss_pred:0.015076244249939919, decouple_loss:0.0008034678758122027
The modified gen p mean: 0.4484524428844452, gen p mean: -0.11480128020048141, mean p set: 0.4490301311016083
loss_pred:0.015630794689059258, decouple_loss:0.0013866579392924905
The modified gen p mean: 0.44877415895462036, gen p mean: -0.12148972600698471, mean p set: 0.449349045753479
loss_pred:0.016679221764206886, decouple_loss:0.0008255485445261002
Iteration: 488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501240849494934, gen p mean: -0.11698445677757263, mean p set: 0.45070016384124756
loss_pred:0.015565428882837296, decouple_loss:0.0011302289785817266
The modified gen p mean: 0.4479258060455322, gen p mean: -0.11676909029483795, mean p set: 0.44850265979766846
loss_pred:0.01565255969762802, decouple_loss:0.0011470293393358588
The modified gen p mean: 0.4509674608707428, gen p mean: -0.1204146221280098, mean p set: 0.4515438675880432
loss_pred:0.017157573252916336, decouple_loss:0.0009444541065022349
Iteration: 489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495316445827484, gen p mean: -0.11529938131570816, mean p set: 0.45010754466056824
loss_pred:0.01595057174563408, decouple_loss:0.0005537254619412124
The modified gen p mean: 0.44845589995384216, gen p mean: -0.11503534764051437, mean p set: 0.44902974367141724
loss_pred:0.01629408448934555, decouple_loss:0.0006708100554533303
The modified gen p mean: 0.44876354932785034, gen p mean: -0.11529472470283508, mean p set: 0.4493407607078552
loss_pred:0.01635115034878254, decouple_loss:0.000603379390668124
Iteration: 490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44989994168281555, gen p mean: -0.1098712757229805, mean p set: 0.4504770338535309The modified gen p mean: 0.4488024115562439, gen p mean: -0.10782447457313538, mean p set: 0.44938161969184875
loss_pred:0.01559928897768259, decouple_loss:0.0006091957329772413
loss_pred:0.015279386192560196, decouple_loss:0.0008365950779989362
The modified gen p mean: 0.4498828649520874, gen p mean: -0.11258279532194138, mean p set: 0.4504591226577759
loss_pred:0.015512184239923954, decouple_loss:0.0010216253576800227
2023-05-01 17:15:18 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1135062649846077, mean p set: 0.4502691626548767
loss_pred:0.017268138006329536, decouple_loss:0.0005408304859884083
The modified gen p mean: 0.44953617453575134, gen p mean: -0.10753223299980164, mean p set: 0.4500633478164673
loss_pred:0.01662343554198742, decouple_loss:0.0009615194285288453
The modified gen p mean: 0.4497799575328827, gen p mean: -0.10676153004169464, mean p set: 0.45035696029663086
loss_pred:0.017030468210577965, decouple_loss:0.0011705080978572369
WV_1_PC_1_EH_0_PS_40, loss: 0.01701856404542923, avg_mse: 0.026387549936771393
current test mse: 0.026388
Iteration: 491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953134655952454, gen p mean: -0.11288773268461227, mean p set: 0.4501064419746399
loss_pred:0.015523522160947323, decouple_loss:0.0006725391722284257
The modified gen p mean: 0.4489637613296509, gen p mean: -0.10767441242933273, mean p set: 0.4495418667793274
The modified gen p mean: 0.44917118549346924, gen p mean: -0.10251469165086746, mean p set: 0.4497474730014801
loss_pred:0.016018571332097054, decouple_loss:0.000720266776625067
loss_pred:0.015955526381731033, decouple_loss:0.0007123930263333023
Iteration: 492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814521074295044, gen p mean: -0.1069607064127922, mean p set: 0.4487202763557434
loss_pred:0.015140791423618793, decouple_loss:0.0006213808082975447
The modified gen p mean: 0.44787439703941345, gen p mean: -0.10857276618480682, mean p set: 0.44845086336135864The modified gen p mean: 0.4506109356880188, gen p mean: -0.10300570726394653, mean p set: 0.4511880874633789
loss_pred:0.01666836068034172, decouple_loss:0.0009981794282793999
loss_pred:0.01628919132053852, decouple_loss:0.0007505050161853433
Iteration: 493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492618143558502, gen p mean: -0.10427983850240707, mean p set: 0.44983911514282227
loss_pred:0.015810975804924965, decouple_loss:0.00065714301308617
The modified gen p mean: 0.4489087760448456, gen p mean: -0.1104777455329895, mean p set: 0.44948363304138184
loss_pred:0.015629425644874573, decouple_loss:0.0005846098065376282
The modified gen p mean: 0.45000365376472473, gen p mean: -0.10456353425979614, mean p set: 0.45058029890060425
loss_pred:0.016365721821784973, decouple_loss:0.0006241577211767435
Iteration: 494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44951537251472473, gen p mean: -0.1125996932387352, mean p set: 0.4500916600227356
loss_pred:0.015685545280575752, decouple_loss:0.0006142636411823332
The modified gen p mean: 0.4495406150817871, gen p mean: -0.10702874511480331, mean p set: 0.4501173794269562
loss_pred:0.016259698197245598, decouple_loss:0.0009042538003996015
The modified gen p mean: 0.44997867941856384, gen p mean: -0.11493910104036331, mean p set: 0.4505566358566284
loss_pred:0.015446152538061142, decouple_loss:0.0006569979013875127
Iteration: 495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44904905557632446, gen p mean: -0.10997682809829712, mean p set: 0.4496253430843353
loss_pred:0.01506174635142088, decouple_loss:0.0009265667176805437
The modified gen p mean: 0.44984307885169983, gen p mean: -0.10967397689819336, mean p set: 0.45041564106941223
loss_pred:0.01563124917447567, decouple_loss:0.0009810012998059392
The modified gen p mean: 0.44895491003990173, gen p mean: -0.10910281538963318, mean p set: 0.44952985644340515
loss_pred:0.01580280065536499, decouple_loss:0.0007932776352390647
Iteration: 496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503234326839447, gen p mean: -0.11367936432361603, mean p set: 0.45089972019195557
loss_pred:0.01587681844830513, decouple_loss:0.0007459394400939345
The modified gen p mean: 0.4479920268058777, gen p mean: -0.11301479488611221, mean p set: 0.4485691785812378
loss_pred:0.01544209010899067, decouple_loss:0.0005625937483273447
The modified gen p mean: 0.4489837884902954, gen p mean: -0.11253310739994049, mean p set: 0.4495586156845093
loss_pred:0.01674293912947178, decouple_loss:0.0006347873131744564
Iteration: 497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824638962745667, gen p mean: -0.11458659172058105, mean p set: 0.4488218426704407
loss_pred:0.016989443451166153, decouple_loss:0.00119311036542058
The modified gen p mean: 0.44929686188697815, gen p mean: -0.11720117926597595, mean p set: 0.4498702585697174
loss_pred:0.016563454642891884, decouple_loss:0.0009031973895616829
The modified gen p mean: 0.44998466968536377, gen p mean: -0.11565281450748444, mean p set: 0.4505636692047119
loss_pred:0.015829624608159065, decouple_loss:0.0009132648701779544
Iteration: 498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930943846702576, gen p mean: -0.12011543661355972, mean p set: 0.44988682866096497
loss_pred:0.01596352830529213, decouple_loss:0.0007005696534179151
The modified gen p mean: 0.4494715929031372, gen p mean: -0.11828383803367615, mean p set: 0.4500495493412018
loss_pred:0.016323043033480644, decouple_loss:0.0005678552552126348
The modified gen p mean: 0.4497859477996826, gen p mean: -0.1160207986831665, mean p set: 0.4503614604473114
loss_pred:0.015609475784003735, decouple_loss:0.0006445660837925971
Iteration: 499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502401053905487, gen p mean: -0.11947058886289597, mean p set: 0.450813353061676
loss_pred:0.015774313360452652, decouple_loss:0.0006026099435985088
The modified gen p mean: 0.4495736062526703, gen p mean: -0.11751756817102432, mean p set: 0.45015186071395874
loss_pred:0.016750825569033623, decouple_loss:0.0007518869824707508
The modified gen p mean: 0.4500966966152191, gen p mean: -0.11891540884971619, mean p set: 0.45067599415779114
loss_pred:0.01527593843638897, decouple_loss:0.0005426472635008395
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012013_3_24hr.npz
NaN value num: 0
Iteration: 500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467790424823761, gen p mean: -0.1154865249991417, mean p set: 0.44735562801361084
loss_pred:0.016523592174053192, decouple_loss:0.0012830072082579136
The modified gen p mean: 0.4477747082710266, gen p mean: -0.1192743107676506, mean p set: 0.4483503997325897
loss_pred:0.016593163833022118, decouple_loss:0.0007662299904040992
The modified gen p mean: 0.44688835740089417, gen p mean: -0.12704430520534515, mean p set: 0.44746658205986023
loss_pred:0.017932280898094177, decouple_loss:0.0012427608016878366
2023-05-01 17:18:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12452446669340134, mean p set: 0.4502691626548767
loss_pred:0.017282819375395775, decouple_loss:0.0009432881488464773
The modified gen p mean: 0.4495354890823364, gen p mean: -0.11843368411064148, mean p set: 0.4500633478164673
loss_pred:0.01657605916261673, decouple_loss:0.0010848031379282475
The modified gen p mean: 0.44978195428848267, gen p mean: -0.1178479790687561, mean p set: 0.45035696029663086
loss_pred:0.01700950413942337, decouple_loss:0.001224188948981464
WV_1_PC_1_EH_0_PS_40, loss: 0.017010333016514778, avg_mse: 0.026450008153915405
current test mse: 0.02645
Iteration: 501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716811180114746, gen p mean: -0.11333536356687546, mean p set: 0.44774138927459717
loss_pred:0.017602402716875076, decouple_loss:0.0009592563728801906
The modified gen p mean: 0.4478568434715271, gen p mean: -0.11788289994001389, mean p set: 0.4484359920024872The modified gen p mean: 0.446393758058548, gen p mean: -0.11335214227437973, mean p set: 0.4469677805900574
loss_pred:0.016567599028348923, decouple_loss:0.0008661632309667766
loss_pred:0.01719251088798046, decouple_loss:0.0009380905539728701
Iteration: 502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460170269012451, gen p mean: -0.12380169332027435, mean p set: 0.4465934634208679
loss_pred:0.01629188470542431, decouple_loss:0.0006532144034281373
The modified gen p mean: 0.44552168250083923, gen p mean: -0.12103278189897537, mean p set: 0.446098268032074The modified gen p mean: 0.4472411572933197, gen p mean: -0.1213388741016388, mean p set: 0.4478198289871216
loss_pred:0.017389215528964996, decouple_loss:0.0007382361800409853
loss_pred:0.016380425542593002, decouple_loss:0.000615203520283103
Iteration: 503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669902324676514, gen p mean: -0.12273755669593811, mean p set: 0.44727540016174316
loss_pred:0.0166371688246727, decouple_loss:0.0006143917562440038
The modified gen p mean: 0.4476100206375122, gen p mean: -0.1217428669333458, mean p set: 0.44818708300590515
loss_pred:0.016780639067292213, decouple_loss:0.0012285959674045444
The modified gen p mean: 0.4475192129611969, gen p mean: -0.1250547170639038, mean p set: 0.4480923116207123
loss_pred:0.01664542593061924, decouple_loss:0.0007198795210570097
Iteration: 504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660061597824097, gen p mean: -0.12243179231882095, mean p set: 0.44717922806739807
loss_pred:0.016854476183652878, decouple_loss:0.0007323960890062153
The modified gen p mean: 0.4466365575790405, gen p mean: -0.12541605532169342, mean p set: 0.44721341133117676
loss_pred:0.0163244791328907, decouple_loss:0.0005816460470668972
The modified gen p mean: 0.44762691855430603, gen p mean: -0.12608203291893005, mean p set: 0.4482041299343109
loss_pred:0.0160234197974205, decouple_loss:0.0010305877076461911
Iteration: 505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700759649276733, gen p mean: -0.1271326094865799, mean p set: 0.4475840926170349
loss_pred:0.01619444228708744, decouple_loss:0.0011893399059772491
The modified gen p mean: 0.4479981064796448, gen p mean: -0.12249024957418442, mean p set: 0.44857561588287354
loss_pred:0.016073454171419144, decouple_loss:0.0007876748568378389
The modified gen p mean: 0.44784682989120483, gen p mean: -0.12529891729354858, mean p set: 0.44842231273651123
loss_pred:0.016722826287150383, decouple_loss:0.0006692742463201284
Iteration: 506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473223090171814, gen p mean: -0.12749336659908295, mean p set: 0.44789573550224304
loss_pred:0.016665322706103325, decouple_loss:0.0008907436858862638
The modified gen p mean: 0.44684070348739624, gen p mean: -0.1233113631606102, mean p set: 0.4474189281463623
loss_pred:0.017480820417404175, decouple_loss:0.0008962612482719123
The modified gen p mean: 0.4460044205188751, gen p mean: -0.12370326370000839, mean p set: 0.4465792179107666
loss_pred:0.017089897766709328, decouple_loss:0.0007309079519473016
Iteration: 507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702982902526855, gen p mean: -0.12551531195640564, mean p set: 0.4476066827774048
loss_pred:0.016772553324699402, decouple_loss:0.0007972453604452312
The modified gen p mean: 0.4475107789039612, gen p mean: -0.12832501530647278, mean p set: 0.4480871260166168
loss_pred:0.01650271937251091, decouple_loss:0.0008324761874973774
The modified gen p mean: 0.4468575417995453, gen p mean: -0.12551110982894897, mean p set: 0.44743436574935913
loss_pred:0.016131822019815445, decouple_loss:0.000813220685813576
Iteration: 508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465445280075073, gen p mean: -0.13324891030788422, mean p set: 0.44712120294570923
loss_pred:0.017432283610105515, decouple_loss:0.001411293400451541
The modified gen p mean: 0.44620048999786377, gen p mean: -0.13011713325977325, mean p set: 0.44677734375
loss_pred:0.016658591106534004, decouple_loss:0.0006549342069774866
The modified gen p mean: 0.4468967616558075, gen p mean: -0.14055195450782776, mean p set: 0.44747358560562134
loss_pred:0.01726818084716797, decouple_loss:0.000603333639446646
Iteration: 509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485746920108795, gen p mean: -0.13090583682060242, mean p set: 0.44915181398391724
loss_pred:0.016462266445159912, decouple_loss:0.0010120737133547664
The modified gen p mean: 0.44694143533706665, gen p mean: -0.13804461061954498, mean p set: 0.4475182592868805
loss_pred:0.017314739525318146, decouple_loss:0.0006573107093572617
The modified gen p mean: 0.4477079510688782, gen p mean: -0.13204824924468994, mean p set: 0.44828227162361145
loss_pred:0.017585722729563713, decouple_loss:0.0006239244830794632
Iteration: 510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781482219696045, gen p mean: -0.12989425659179688, mean p set: 0.44839179515838623
loss_pred:0.016149476170539856, decouple_loss:0.0008986667962744832
The modified gen p mean: 0.4462750554084778, gen p mean: -0.1389591097831726, mean p set: 0.446853369474411
loss_pred:0.01717660389840603, decouple_loss:0.0007248694309964776
The modified gen p mean: 0.4472162127494812, gen p mean: -0.12704677879810333, mean p set: 0.4477900266647339
loss_pred:0.016275135800242424, decouple_loss:0.0008949695038609207

2023-05-01 17:20:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1355920284986496, mean p set: 0.4502691626548767
loss_pred:0.01721063069999218, decouple_loss:0.0007353448309004307
The modified gen p mean: 0.4495362341403961, gen p mean: -0.1295139044523239, mean p set: 0.4500633478164673
loss_pred:0.016517886891961098, decouple_loss:0.0005956236273050308
The modified gen p mean: 0.4497799575328827, gen p mean: -0.128504678606987, mean p set: 0.45035696029663086
loss_pred:0.016919473186135292, decouple_loss:0.0006921048043295741
WV_1_PC_1_EH_0_PS_40, loss: 0.016916383057832718, avg_mse: 0.026294171810150146
current test mse: 0.026294
Iteration: 511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44598710536956787, gen p mean: -0.13521882891654968, mean p set: 0.4465617835521698
loss_pred:0.016409510746598244, decouple_loss:0.0007544695399701595
The modified gen p mean: 0.44728928804397583, gen p mean: -0.1313520073890686, mean p set: 0.4478640854358673The modified gen p mean: 0.44609740376472473, gen p mean: -0.12907321751117706, mean p set: 0.4466714859008789
loss_pred:0.01723819598555565, decouple_loss:0.000635395641438663
loss_pred:0.01639227196574211, decouple_loss:0.0009692897438071668
Iteration: 512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467693567276001, gen p mean: -0.13238167762756348, mean p set: 0.4473479390144348
loss_pred:0.017238089814782143, decouple_loss:0.0008270088583230972
The modified gen p mean: 0.4471878111362457, gen p mean: -0.12828025221824646, mean p set: 0.44776445627212524The modified gen p mean: 0.4464723765850067, gen p mean: -0.12603677809238434, mean p set: 0.44704926013946533
loss_pred:0.01714288629591465, decouple_loss:0.0006835134699940681
loss_pred:0.017425918951630592, decouple_loss:0.0007394716958515346
Iteration: 513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688042998313904, gen p mean: -0.1251250058412552, mean p set: 0.4474555552005768
loss_pred:0.017296161502599716, decouple_loss:0.0007285048486664891
The modified gen p mean: 0.4483398199081421, gen p mean: -0.12503530085086823, mean p set: 0.448914498090744
loss_pred:0.016136568039655685, decouple_loss:0.000575545069295913
The modified gen p mean: 0.4481692910194397, gen p mean: -0.12877194583415985, mean p set: 0.44874683022499084
loss_pred:0.0162032637745142, decouple_loss:0.0006860870053060353
Iteration: 514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458613395690918, gen p mean: -0.13249443471431732, mean p set: 0.4464368224143982
loss_pred:0.017239054664969444, decouple_loss:0.000954287126660347
The modified gen p mean: 0.447717547416687, gen p mean: -0.13077108561992645, mean p set: 0.44829463958740234
loss_pred:0.017147855833172798, decouple_loss:0.0006192252039909363
The modified gen p mean: 0.4463418126106262, gen p mean: -0.12746137380599976, mean p set: 0.4469192922115326
loss_pred:0.01816406287252903, decouple_loss:0.0006137212621979415
Iteration: 515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469169080257416, gen p mean: -0.12845303118228912, mean p set: 0.4474962055683136
loss_pred:0.017055055126547813, decouple_loss:0.0007878107135184109
The modified gen p mean: 0.4471617043018341, gen p mean: -0.12525033950805664, mean p set: 0.4477398097515106
loss_pred:0.016903366893529892, decouple_loss:0.0005202986649237573
The modified gen p mean: 0.44554850459098816, gen p mean: -0.12571513652801514, mean p set: 0.4461243748664856
loss_pred:0.016338089480996132, decouple_loss:0.00074043805943802
Iteration: 516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479188621044159, gen p mean: -0.12279883772134781, mean p set: 0.44849371910095215
loss_pred:0.016089823096990585, decouple_loss:0.0008572207880206406
The modified gen p mean: 0.4479130208492279, gen p mean: -0.11671257019042969, mean p set: 0.44848719239234924
loss_pred:0.016261819750070572, decouple_loss:0.0008538395049981773
The modified gen p mean: 0.4477565586566925, gen p mean: -0.12227760255336761, mean p set: 0.4483303725719452
loss_pred:0.01650257036089897, decouple_loss:0.0008591293008066714
Iteration: 517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448060005903244, gen p mean: -0.1275419294834137, mean p set: 0.44863349199295044
loss_pred:0.016577115282416344, decouple_loss:0.0005147429765202105
The modified gen p mean: 0.446367472410202, gen p mean: -0.12237254530191422, mean p set: 0.4469434916973114
loss_pred:0.017065957188606262, decouple_loss:0.0005343299708329141
The modified gen p mean: 0.44632527232170105, gen p mean: -0.12070981413125992, mean p set: 0.44690072536468506
loss_pred:0.016148952767252922, decouple_loss:0.0007395141874440014
Iteration: 518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770726561546326, gen p mean: -0.1317809820175171, mean p set: 0.4482823610305786
loss_pred:0.017027977854013443, decouple_loss:0.0006652139127254486
The modified gen p mean: 0.4453955888748169, gen p mean: -0.12621654570102692, mean p set: 0.4459685981273651
loss_pred:0.016830136999487877, decouple_loss:0.0007436192245222628
The modified gen p mean: 0.44636616110801697, gen p mean: -0.13151274621486664, mean p set: 0.4469445049762726
loss_pred:0.016883889213204384, decouple_loss:0.0006560178007930517
Iteration: 519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760844111442566, gen p mean: -0.12457603961229324, mean p set: 0.4481818377971649
loss_pred:0.0168690774589777, decouple_loss:0.0006732200272381306
The modified gen p mean: 0.44664639234542847, gen p mean: -0.12289079278707504, mean p set: 0.44722142815589905
loss_pred:0.017510589212179184, decouple_loss:0.0007578144432045519
The modified gen p mean: 0.4472784996032715, gen p mean: -0.1328483372926712, mean p set: 0.4478553533554077
loss_pred:0.01761242374777794, decouple_loss:0.0008955739322118461
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012004_3_24hr.npz
NaN value num: 0
Iteration: 520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511941075325012, gen p mean: -0.11790576577186584, mean p set: 0.45177412033081055
The modified gen p mean: 0.4507100582122803, gen p mean: -0.11349263042211533, mean p set: 0.45128580927848816
loss_pred:0.015522853471338749, decouple_loss:0.0007954404572956264
loss_pred:0.015709877014160156, decouple_loss:0.0006945145432837307
The modified gen p mean: 0.4521191418170929, gen p mean: -0.11803756654262543, mean p set: 0.45269572734832764
loss_pred:0.015414108522236347, decouple_loss:0.0007564119878225029
2023-05-01 17:22:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1300058364868164, mean p set: 0.4502691626548767
loss_pred:0.01712937280535698, decouple_loss:0.0006567617529071867
The modified gen p mean: 0.44953638315200806, gen p mean: -0.12392468005418777, mean p set: 0.4500633478164673
loss_pred:0.01649671047925949, decouple_loss:0.000665618572384119
The modified gen p mean: 0.44978076219558716, gen p mean: -0.12337782979011536, mean p set: 0.45035696029663086
loss_pred:0.01699410192668438, decouple_loss:0.0006808650796301663
WV_1_PC_1_EH_0_PS_40, loss: 0.01690678298473358, avg_mse: 0.02626473270356655
current test mse: 0.026265
Iteration: 521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515136182308197, gen p mean: -0.11610216647386551, mean p set: 0.452089786529541
loss_pred:0.015065072104334831, decouple_loss:0.0005863593542017043
The modified gen p mean: 0.4491409957408905, gen p mean: -0.11386524885892868, mean p set: 0.44971778988838196The modified gen p mean: 0.4505017101764679, gen p mean: -0.11301098018884659, mean p set: 0.45107904076576233
loss_pred:0.015741681680083275, decouple_loss:0.0006456064875237644
loss_pred:0.015726204961538315, decouple_loss:0.0006057032151147723
Iteration: 522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484606981277466, gen p mean: -0.11570365726947784, mean p set: 0.4490357041358948
loss_pred:0.015448088757693768, decouple_loss:0.0006517324363812804
The modified gen p mean: 0.4506790339946747, gen p mean: -0.11179491132497787, mean p set: 0.45125362277030945The modified gen p mean: 0.45041847229003906, gen p mean: -0.12051289528608322, mean p set: 0.45099470019340515
loss_pred:0.01596098765730858, decouple_loss:0.0010526655241847038loss_pred:0.015554764308035374, decouple_loss:0.0006206182297319174
Iteration: 523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492920935153961, gen p mean: -0.11195284128189087, mean p set: 0.4498707354068756
loss_pred:0.01581590808928013, decouple_loss:0.0007336405105888844
The modified gen p mean: 0.45361462235450745, gen p mean: -0.10880426317453384, mean p set: 0.4541929364204407
loss_pred:0.015966057777404785, decouple_loss:0.0006297886138781905
The modified gen p mean: 0.4511491358280182, gen p mean: -0.10834123194217682, mean p set: 0.4517255127429962
loss_pred:0.015616336837410927, decouple_loss:0.0006954308482818305
Iteration: 524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530646800994873, gen p mean: -0.10703718662261963, mean p set: 0.4536430835723877
loss_pred:0.015984652563929558, decouple_loss:0.0007084363023750484
The modified gen p mean: 0.4503359794616699, gen p mean: -0.11451836675405502, mean p set: 0.45091211795806885
loss_pred:0.01577196829020977, decouple_loss:0.0005413374747149646
The modified gen p mean: 0.44969967007637024, gen p mean: -0.11337459832429886, mean p set: 0.4502776563167572
loss_pred:0.015430440194904804, decouple_loss:0.0008019684464670718
Iteration: 525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503615200519562, gen p mean: -0.10282851755619049, mean p set: 0.4509369134902954
loss_pred:0.016236737370491028, decouple_loss:0.0006292727193795145
The modified gen p mean: 0.44902101159095764, gen p mean: -0.10588720440864563, mean p set: 0.44959568977355957
loss_pred:0.015744466334581375, decouple_loss:0.0006586948875337839
The modified gen p mean: 0.44968220591545105, gen p mean: -0.11363458633422852, mean p set: 0.4502570331096649
loss_pred:0.01617944799363613, decouple_loss:0.0006792406202293932
Iteration: 526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915831089019775, gen p mean: -0.10989907383918762, mean p set: 0.4497344493865967
loss_pred:0.01589811034500599, decouple_loss:0.0007114445324987173
The modified gen p mean: 0.4496494233608246, gen p mean: -0.11778996139764786, mean p set: 0.45022767782211304
loss_pred:0.015641892328858376, decouple_loss:0.0005739033222198486
The modified gen p mean: 0.4514908194541931, gen p mean: -0.11083396524190903, mean p set: 0.45206621289253235
loss_pred:0.015324592590332031, decouple_loss:0.000855353195220232
Iteration: 527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499514102935791, gen p mean: -0.11957094818353653, mean p set: 0.45052674412727356
loss_pred:0.015355321578681469, decouple_loss:0.0007758791907690465
The modified gen p mean: 0.44844850897789, gen p mean: -0.1183161586523056, mean p set: 0.44902369379997253
loss_pred:0.0156678706407547, decouple_loss:0.000673117523547262
The modified gen p mean: 0.45076045393943787, gen p mean: -0.11089163273572922, mean p set: 0.45133697986602783
loss_pred:0.015574646182358265, decouple_loss:0.0007992741884663701
Iteration: 528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450877845287323, gen p mean: -0.11598470062017441, mean p set: 0.4514558017253876
loss_pred:0.015497909858822823, decouple_loss:0.0006367135792970657
The modified gen p mean: 0.4512070119380951, gen p mean: -0.11929196119308472, mean p set: 0.45178547501564026
loss_pred:0.015283278189599514, decouple_loss:0.000926688255276531
The modified gen p mean: 0.4504240155220032, gen p mean: -0.11431126296520233, mean p set: 0.45099982619285583
loss_pred:0.01566680334508419, decouple_loss:0.0007965659024193883
Iteration: 529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520394206047058, gen p mean: -0.11594991385936737, mean p set: 0.45261847972869873
The modified gen p mean: 0.450752854347229, gen p mean: -0.11609793454408646, mean p set: 0.45132896304130554loss_pred:0.015531554818153381, decouple_loss:0.0006500930176116526
loss_pred:0.015989238396286964, decouple_loss:0.0006480308948084712
The modified gen p mean: 0.45044225454330444, gen p mean: -0.11624734848737717, mean p set: 0.4510199725627899
loss_pred:0.015725161880254745, decouple_loss:0.0007859073230065405
Iteration: 530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488511383533478, gen p mean: -0.11938802897930145, mean p set: 0.4494280517101288
loss_pred:0.014976677484810352, decouple_loss:0.0010119442595168948
The modified gen p mean: 0.4514484107494354, gen p mean: -0.12026914954185486, mean p set: 0.4520263373851776
loss_pred:0.015031613409519196, decouple_loss:0.0006045476184226573
The modified gen p mean: 0.45256561040878296, gen p mean: -0.1144796684384346, mean p set: 0.45314162969589233
loss_pred:0.01566481404006481, decouple_loss:0.0009324524435214698
2023-05-01 17:24:56 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12713976204395294, mean p set: 0.4502691626548767
loss_pred:0.017150484025478363, decouple_loss:0.0006576802115887403
The modified gen p mean: 0.44953420758247375, gen p mean: -0.12103988230228424, mean p set: 0.4500633478164673
loss_pred:0.016607578843832016, decouple_loss:0.0008512816857546568
The modified gen p mean: 0.4497811794281006, gen p mean: -0.12096128612756729, mean p set: 0.45035696029663086
loss_pred:0.01699843816459179, decouple_loss:0.0007173673948273063
WV_1_PC_1_EH_0_PS_40, loss: 0.016955940052866936, avg_mse: 0.02633180469274521
current test mse: 0.026332
Iteration: 531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45124173164367676, gen p mean: -0.11170915514230728, mean p set: 0.4518203139305115
loss_pred:0.015349777415394783, decouple_loss:0.0006718406220898032
The modified gen p mean: 0.44959285855293274, gen p mean: -0.1092064306139946, mean p set: 0.4501683712005615
loss_pred:0.015752319246530533, decouple_loss:0.0006400226266123354
The modified gen p mean: 0.45226919651031494, gen p mean: -0.11727280914783478, mean p set: 0.45284390449523926
loss_pred:0.015420913696289062, decouple_loss:0.0007822224288247526
Iteration: 532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45172685384750366, gen p mean: -0.10821753740310669, mean p set: 0.4523043632507324
loss_pred:0.015228910371661186, decouple_loss:0.0009155094739980996
The modified gen p mean: 0.4516337215900421, gen p mean: -0.11574117839336395, mean p set: 0.45221275091171265The modified gen p mean: 0.4511610269546509, gen p mean: -0.11117523163557053, mean p set: 0.451738178730011
loss_pred:0.015420809388160706, decouple_loss:0.0006288571748882532loss_pred:0.015484226867556572, decouple_loss:0.0007738837157376111
Iteration: 533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487878680229187, gen p mean: -0.10874420404434204, mean p set: 0.4493648409843445
loss_pred:0.01535235159099102, decouple_loss:0.0006410520290955901
The modified gen p mean: 0.45260992646217346, gen p mean: -0.10645057260990143, mean p set: 0.45318490266799927
loss_pred:0.015807097777724266, decouple_loss:0.0006277788197621703
The modified gen p mean: 0.45146429538726807, gen p mean: -0.109051913022995, mean p set: 0.4520416855812073
loss_pred:0.015570825897157192, decouple_loss:0.0007704540621489286
Iteration: 534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45207151770591736, gen p mean: -0.10848166048526764, mean p set: 0.4526461362838745
loss_pred:0.014878662303090096, decouple_loss:0.0008365534013137221
The modified gen p mean: 0.4513244330883026, gen p mean: -0.10658872872591019, mean p set: 0.4519027769565582
loss_pred:0.014889229089021683, decouple_loss:0.0008196941344067454
The modified gen p mean: 0.45262545347213745, gen p mean: -0.10349535197019577, mean p set: 0.45320096611976624
loss_pred:0.015468297526240349, decouple_loss:0.0007572934846393764
Iteration: 535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513966739177704, gen p mean: -0.10176188498735428, mean p set: 0.4519725739955902
loss_pred:0.01604289934039116, decouple_loss:0.0006207805126905441
The modified gen p mean: 0.4519772231578827, gen p mean: -0.10534060746431351, mean p set: 0.4525558054447174
loss_pred:0.015221795998513699, decouple_loss:0.000710303196683526
The modified gen p mean: 0.44950389862060547, gen p mean: -0.10818860679864883, mean p set: 0.450082391500473
loss_pred:0.015223653055727482, decouple_loss:0.0006919315783306956
Iteration: 536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45067042112350464, gen p mean: -0.1032467857003212, mean p set: 0.45124614238739014
loss_pred:0.015816060826182365, decouple_loss:0.000637277087662369
The modified gen p mean: 0.4490133821964264, gen p mean: -0.10470090806484222, mean p set: 0.4495902955532074
loss_pred:0.01522183045744896, decouple_loss:0.0007072380976751447
The modified gen p mean: 0.4498431384563446, gen p mean: -0.11384819447994232, mean p set: 0.4504190683364868
loss_pred:0.01581825315952301, decouple_loss:0.0008446648716926575
Iteration: 537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495871365070343, gen p mean: -0.11383334547281265, mean p set: 0.4501636028289795
loss_pred:0.015345553867518902, decouple_loss:0.0007968501886352897
The modified gen p mean: 0.45124945044517517, gen p mean: -0.10340749472379684, mean p set: 0.45182791352272034
loss_pred:0.01602211408317089, decouple_loss:0.0005467945011332631
The modified gen p mean: 0.45139867067337036, gen p mean: -0.10510528832674026, mean p set: 0.451975017786026
loss_pred:0.015533113852143288, decouple_loss:0.001171326031908393
Iteration: 538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45115989446640015, gen p mean: -0.10930833965539932, mean p set: 0.4517350196838379
loss_pred:0.01507782656699419, decouple_loss:0.0008341008797287941
The modified gen p mean: 0.4486011862754822, gen p mean: -0.11057577282190323, mean p set: 0.44918093085289
loss_pred:0.01521344669163227, decouple_loss:0.0007552733877673745
The modified gen p mean: 0.45311564207077026, gen p mean: -0.10324744880199432, mean p set: 0.4536963999271393
loss_pred:0.015690892934799194, decouple_loss:0.0007254367228597403
Iteration: 539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45216119289398193, gen p mean: -0.10695680230855942, mean p set: 0.45273545384407043
loss_pred:0.01563008688390255, decouple_loss:0.0006557226297445595
The modified gen p mean: 0.4504301846027374, gen p mean: -0.11501288414001465, mean p set: 0.45100730657577515
loss_pred:0.015668746083974838, decouple_loss:0.0007934977184049785
The modified gen p mean: 0.4493115246295929, gen p mean: -0.11031106859445572, mean p set: 0.4498874545097351
loss_pred:0.014930831268429756, decouple_loss:0.0007754998514428735
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012015_3_24hr.npz
NaN value num: 0
Iteration: 540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505496621131897, gen p mean: -0.10773808509111404, mean p set: 0.4511294364929199
loss_pred:0.016351960599422455, decouple_loss:0.000959094031713903
The modified gen p mean: 0.4481362998485565, gen p mean: -0.10793210566043854, mean p set: 0.4487132728099823
loss_pred:0.01625421829521656, decouple_loss:0.0008168303756974638
The modified gen p mean: 0.45044267177581787, gen p mean: -0.11074353754520416, mean p set: 0.45102033019065857
loss_pred:0.016175173223018646, decouple_loss:0.0011086012236773968
2023-05-01 17:27:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12090044468641281, mean p set: 0.4502691626548767
loss_pred:0.017217500135302544, decouple_loss:0.0006390497437678277
The modified gen p mean: 0.44953453540802, gen p mean: -0.11450420320034027, mean p set: 0.4500633478164673
loss_pred:0.016631033271551132, decouple_loss:0.0006879348075017333
The modified gen p mean: 0.44978249073028564, gen p mean: -0.11451444774866104, mean p set: 0.45035696029663086
loss_pred:0.01694226823747158, decouple_loss:0.0006540127214975655
WV_1_PC_1_EH_0_PS_40, loss: 0.016963284462690353, avg_mse: 0.026316581293940544
current test mse: 0.026317
Iteration: 541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978052377700806, gen p mean: -0.1071351021528244, mean p set: 0.4503557085990906
loss_pred:0.01598447561264038, decouple_loss:0.0009626376559026539
The modified gen p mean: 0.4496389925479889, gen p mean: -0.10594963282346725, mean p set: 0.4502144455909729The modified gen p mean: 0.4506988823413849, gen p mean: -0.11132244765758514, mean p set: 0.45127591490745544
loss_pred:0.015661505982279778, decouple_loss:0.0007170445169322193
loss_pred:0.016322392970323563, decouple_loss:0.0006766935694031417
Iteration: 542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052212476730347, gen p mean: -0.11031443625688553, mean p set: 0.4510977864265442
loss_pred:0.015541370958089828, decouple_loss:0.0006524272030219436
The modified gen p mean: 0.4507941007614136, gen p mean: -0.1097148209810257, mean p set: 0.45136934518814087The modified gen p mean: 0.4498531222343445, gen p mean: -0.10655909031629562, mean p set: 0.45042750239372253
loss_pred:0.015688879415392876, decouple_loss:0.0005349022103473544loss_pred:0.016097912564873695, decouple_loss:0.0006601618370041251
Iteration: 543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897159934043884, gen p mean: -0.10808373242616653, mean p set: 0.4495491087436676
loss_pred:0.015961935743689537, decouple_loss:0.0008289352990686893
The modified gen p mean: 0.4499821960926056, gen p mean: -0.10751690715551376, mean p set: 0.4505578577518463
loss_pred:0.01589600369334221, decouple_loss:0.000890856608748436
The modified gen p mean: 0.4506668746471405, gen p mean: -0.11145737767219543, mean p set: 0.4512425363063812
loss_pred:0.01583721861243248, decouple_loss:0.0009211640572175384
Iteration: 544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448728084564209, gen p mean: -0.10506807267665863, mean p set: 0.44930416345596313
loss_pred:0.016223231330513954, decouple_loss:0.000795216765254736
The modified gen p mean: 0.4500379264354706, gen p mean: -0.10711374133825302, mean p set: 0.45061591267585754
loss_pred:0.015572315081954002, decouple_loss:0.0007144520059227943
The modified gen p mean: 0.4498008191585541, gen p mean: -0.10033325850963593, mean p set: 0.45037728548049927
loss_pred:0.016297951340675354, decouple_loss:0.0006757891387678683
Iteration: 545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492109715938568, gen p mean: -0.1004982441663742, mean p set: 0.4497903883457184
loss_pred:0.016259755939245224, decouple_loss:0.0005855417693965137
The modified gen p mean: 0.4492947459220886, gen p mean: -0.1059977188706398, mean p set: 0.44986993074417114
loss_pred:0.016084013506770134, decouple_loss:0.0006310085882432759
The modified gen p mean: 0.4496563673019409, gen p mean: -0.10296972095966339, mean p set: 0.4502323865890503
loss_pred:0.016398517414927483, decouple_loss:0.0005868726875633001
Iteration: 546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071735978126526, gen p mean: -0.10367557406425476, mean p set: 0.45129671692848206
loss_pred:0.015594321303069592, decouple_loss:0.0006116724689491093
The modified gen p mean: 0.4499761760234833, gen p mean: -0.10528173297643661, mean p set: 0.4505513310432434
The modified gen p mean: 0.4508654475212097, gen p mean: -0.10597015917301178, mean p set: 0.4514424204826355
loss_pred:0.015113206580281258, decouple_loss:0.0007228532340377569
loss_pred:0.014696324244141579, decouple_loss:0.0009112445986829698
Iteration: 547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502345621585846, gen p mean: -0.10182151198387146, mean p set: 0.45081210136413574
loss_pred:0.015509680844843388, decouple_loss:0.0005843429244123399
The modified gen p mean: 0.4504740536212921, gen p mean: -0.10674081742763519, mean p set: 0.45105046033859253
loss_pred:0.016344480216503143, decouple_loss:0.0005879825912415981
The modified gen p mean: 0.44969406723976135, gen p mean: -0.10477285087108612, mean p set: 0.4502711296081543
loss_pred:0.015201542526483536, decouple_loss:0.0006140374462120235
Iteration: 548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871824979782104, gen p mean: -0.10154730826616287, mean p set: 0.4492945969104767
loss_pred:0.015590257942676544, decouple_loss:0.0008414064068347216
The modified gen p mean: 0.45032188296318054, gen p mean: -0.10396619141101837, mean p set: 0.4508983790874481
loss_pred:0.016613086685538292, decouple_loss:0.0009414031519554555
The modified gen p mean: 0.4498201310634613, gen p mean: -0.10435960441827774, mean p set: 0.450395792722702
loss_pred:0.016206275671720505, decouple_loss:0.001045226352289319
Iteration: 549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45066341757774353, gen p mean: -0.10861397534608841, mean p set: 0.4512394070625305
loss_pred:0.0167866013944149, decouple_loss:0.0007116304477676749
The modified gen p mean: 0.45114412903785706, gen p mean: -0.10776658356189728, mean p set: 0.4517212510108948
loss_pred:0.01540935505181551, decouple_loss:0.0008723668288439512
The modified gen p mean: 0.4507278800010681, gen p mean: -0.10977523773908615, mean p set: 0.4513028562068939
loss_pred:0.01593233086168766, decouple_loss:0.000653466850053519
Iteration: 550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041942596435547, gen p mean: -0.10811655223369598, mean p set: 0.4509945213794708
loss_pred:0.015546249225735664, decouple_loss:0.0006135881994850934
The modified gen p mean: 0.45023107528686523, gen p mean: -0.10973586142063141, mean p set: 0.45080649852752686
loss_pred:0.01563333161175251, decouple_loss:0.0006999063189141452
The modified gen p mean: 0.44992536306381226, gen p mean: -0.10987520962953568, mean p set: 0.45049992203712463
loss_pred:0.015540927648544312, decouple_loss:0.000721850898116827
2023-05-01 17:29:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12118930369615555, mean p set: 0.4502691626548767
loss_pred:0.01726125180721283, decouple_loss:0.0006461187149398029
The modified gen p mean: 0.44953668117523193, gen p mean: -0.11510930955410004, mean p set: 0.4500633478164673
loss_pred:0.01666344702243805, decouple_loss:0.0010200684191659093
The modified gen p mean: 0.4497794806957245, gen p mean: -0.11515680700540543, mean p set: 0.45035696029663086
loss_pred:0.01699863374233246, decouple_loss:0.0009664840763434768
WV_1_PC_1_EH_0_PS_40, loss: 0.01701832190155983, avg_mse: 0.02641291357576847
current test mse: 0.026413
Iteration: 551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45172184705734253, gen p mean: -0.10382112115621567, mean p set: 0.45230039954185486
loss_pred:0.016411203891038895, decouple_loss:0.0007814389537088573
The modified gen p mean: 0.44947654008865356, gen p mean: -0.11137194186449051, mean p set: 0.45005232095718384The modified gen p mean: 0.4507347643375397, gen p mean: -0.10633814334869385, mean p set: 0.4513128101825714
loss_pred:0.015981564298272133, decouple_loss:0.0009647046099416912
loss_pred:0.016272010281682014, decouple_loss:0.001075793756172061
Iteration: 552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45055902004241943, gen p mean: -0.10817060619592667, mean p set: 0.45113804936408997
loss_pred:0.015619391575455666, decouple_loss:0.000829627737402916
The modified gen p mean: 0.44902798533439636, gen p mean: -0.10677914321422577, mean p set: 0.44960469007492065The modified gen p mean: 0.4499107003211975, gen p mean: -0.10910941660404205, mean p set: 0.4504863917827606
loss_pred:0.01619645580649376, decouple_loss:0.0008311029523611069
loss_pred:0.01624392531812191, decouple_loss:0.0008915939833968878
Iteration: 553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489777982234955, gen p mean: -0.10688682645559311, mean p set: 0.4495503306388855
loss_pred:0.015941372141242027, decouple_loss:0.0007411398109979928
The modified gen p mean: 0.44977542757987976, gen p mean: -0.1037897914648056, mean p set: 0.450351357460022
loss_pred:0.015965178608894348, decouple_loss:0.0006154908332973719
The modified gen p mean: 0.4504658579826355, gen p mean: -0.1059684008359909, mean p set: 0.4510418474674225
loss_pred:0.015781059861183167, decouple_loss:0.0006095039425417781
Iteration: 554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45045554637908936, gen p mean: -0.10127084702253342, mean p set: 0.4510340988636017
loss_pred:0.016095547005534172, decouple_loss:0.00070576136931777
The modified gen p mean: 0.4492248296737671, gen p mean: -0.10179751366376877, mean p set: 0.44980117678642273
loss_pred:0.016440263018012047, decouple_loss:0.0009338780655525625
The modified gen p mean: 0.44923135638237, gen p mean: -0.10231577605009079, mean p set: 0.44980788230895996
loss_pred:0.01612870953977108, decouple_loss:0.0008439196390099823
Iteration: 555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44976910948753357, gen p mean: -0.10372309386730194, mean p set: 0.45034709572792053
loss_pred:0.016406947746872902, decouple_loss:0.0006077273283153772
The modified gen p mean: 0.4490378201007843, gen p mean: -0.1042538583278656, mean p set: 0.4496149718761444
loss_pred:0.01593126356601715, decouple_loss:0.0009357404196634889
The modified gen p mean: 0.450629860162735, gen p mean: -0.10170029103755951, mean p set: 0.45120492577552795
loss_pred:0.016697978600859642, decouple_loss:0.0010559199145063758
Iteration: 556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501063823699951, gen p mean: -0.10601199418306351, mean p set: 0.4506819546222687
loss_pred:0.015403429046273232, decouple_loss:0.000837641186080873
The modified gen p mean: 0.45060884952545166, gen p mean: -0.10894975811243057, mean p set: 0.4511845111846924
loss_pred:0.01546053308993578, decouple_loss:0.0007872937712818384
The modified gen p mean: 0.4497239589691162, gen p mean: -0.10159861296415329, mean p set: 0.4503003656864166
loss_pred:0.016262918710708618, decouple_loss:0.0007144298288039863
Iteration: 557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028156042099, gen p mean: -0.102076955139637, mean p set: 0.4508568048477173
loss_pred:0.01616096869111061, decouple_loss:0.0009459586581215262
The modified gen p mean: 0.4490702152252197, gen p mean: -0.10558625310659409, mean p set: 0.4496467411518097
The modified gen p mean: 0.44971418380737305, gen p mean: -0.1043037697672844, mean p set: 0.45028993487358093
loss_pred:0.017062028869986534, decouple_loss:0.0008537076064385474
loss_pred:0.016099505126476288, decouple_loss:0.0006440795259550214
Iteration: 558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450765460729599, gen p mean: -0.10218881070613861, mean p set: 0.4513426423072815
loss_pred:0.01613028161227703, decouple_loss:0.0009435889078304172
The modified gen p mean: 0.4508829414844513, gen p mean: -0.10827522724866867, mean p set: 0.45145899057388306
The modified gen p mean: 0.4503258466720581, gen p mean: -0.10235263407230377, mean p set: 0.45090147852897644
loss_pred:0.016084112226963043, decouple_loss:0.0009759142412804067
loss_pred:0.016582095995545387, decouple_loss:0.0008326738607138395
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012010_3_24hr.npz
NaN value num: 0
Iteration: 559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797536730766296, gen p mean: -0.11886429786682129, mean p set: 0.4485495090484619
loss_pred:0.01762041263282299, decouple_loss:0.0007530705770477653
The modified gen p mean: 0.4462319612503052, gen p mean: -0.1203644871711731, mean p set: 0.4468069076538086
The modified gen p mean: 0.44728729128837585, gen p mean: -0.11550014466047287, mean p set: 0.44786348938941956
loss_pred:0.016331972554326057, decouple_loss:0.0006786480080336332
loss_pred:0.016624609008431435, decouple_loss:0.0008909192983992398
Iteration: 560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473992884159088, gen p mean: -0.1164829358458519, mean p set: 0.4479750096797943
loss_pred:0.017518403008580208, decouple_loss:0.0006275750929489732
The modified gen p mean: 0.446254163980484, gen p mean: -0.12084128707647324, mean p set: 0.44682982563972473
The modified gen p mean: 0.4467829167842865, gen p mean: -0.1252089887857437, mean p set: 0.4473590552806854
loss_pred:0.015529565513134003, decouple_loss:0.000660812365822494
loss_pred:0.01664240099489689, decouple_loss:0.0006296310457400978
2023-05-01 17:32:26 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12419924139976501, mean p set: 0.4502691626548767
loss_pred:0.017211830243468285, decouple_loss:0.0006147390813566744
The modified gen p mean: 0.44953492283821106, gen p mean: -0.1177704781293869, mean p set: 0.4500633478164673
loss_pred:0.016586696729063988, decouple_loss:0.0005699610337615013
The modified gen p mean: 0.4497824013233185, gen p mean: -0.11719197034835815, mean p set: 0.45035696029663086
loss_pred:0.016870537772774696, decouple_loss:0.0005722498171962798
WV_1_PC_1_EH_0_PS_40, loss: 0.01691897213459015, avg_mse: 0.026334263384342194
current test mse: 0.026334
Iteration: 561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783130288124084, gen p mean: -0.11598025262355804, mean p set: 0.4484054148197174
loss_pred:0.017680102959275246, decouple_loss:0.0008636814309284091
The modified gen p mean: 0.4487716555595398, gen p mean: -0.12083940953016281, mean p set: 0.44934606552124023The modified gen p mean: 0.44677844643592834, gen p mean: -0.12217041105031967, mean p set: 0.4473554790019989
loss_pred:0.017132049426436424, decouple_loss:0.0006752236513420939loss_pred:0.016115061938762665, decouple_loss:0.0007141556707210839
Iteration: 562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465177059173584, gen p mean: -0.11774207651615143, mean p set: 0.44709256291389465
loss_pred:0.01687544211745262, decouple_loss:0.0007525149849243462
The modified gen p mean: 0.44650155305862427, gen p mean: -0.12111277133226395, mean p set: 0.4470786452293396The modified gen p mean: 0.4478783905506134, gen p mean: -0.1188301369547844, mean p set: 0.4484540522098541
loss_pred:0.016795208677649498, decouple_loss:0.0005312730208970606
loss_pred:0.016484737396240234, decouple_loss:0.0006450897199101746
Iteration: 563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475362002849579, gen p mean: -0.11295491456985474, mean p set: 0.44811463356018066
loss_pred:0.01791861653327942, decouple_loss:0.0008916317019611597
The modified gen p mean: 0.4484065771102905, gen p mean: -0.11785367876291275, mean p set: 0.4489823877811432The modified gen p mean: 0.44899964332580566, gen p mean: -0.11902430653572083, mean p set: 0.4495777189731598
loss_pred:0.01672089286148548, decouple_loss:0.0007143907132558525loss_pred:0.01693241111934185, decouple_loss:0.0007170369499363005
Iteration: 564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44675689935684204, gen p mean: -0.1158641129732132, mean p set: 0.4473304748535156
loss_pred:0.016784032806754112, decouple_loss:0.0006613324512727559
The modified gen p mean: 0.44668033719062805, gen p mean: -0.12280964106321335, mean p set: 0.4472576081752777
loss_pred:0.016322210431098938, decouple_loss:0.000579161336645484
The modified gen p mean: 0.44766631722450256, gen p mean: -0.11883756518363953, mean p set: 0.4482417702674866
loss_pred:0.016800647601485252, decouple_loss:0.0006304357084445655
Iteration: 565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447838693857193, gen p mean: -0.1167069524526596, mean p set: 0.44841399788856506
loss_pred:0.01720193400979042, decouple_loss:0.0007913692388683558
The modified gen p mean: 0.44681090116500854, gen p mean: -0.12175463140010834, mean p set: 0.447386234998703
loss_pred:0.016334960237145424, decouple_loss:0.000554979604203254
The modified gen p mean: 0.44780296087265015, gen p mean: -0.12095589935779572, mean p set: 0.4483780562877655
loss_pred:0.016454096883535385, decouple_loss:0.000665636733174324
Iteration: 566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465288519859314, gen p mean: -0.12593717873096466, mean p set: 0.447104811668396
loss_pred:0.016070395708084106, decouple_loss:0.000585757486987859
The modified gen p mean: 0.44717660546302795, gen p mean: -0.12150341272354126, mean p set: 0.4477509558200836
loss_pred:0.01782253198325634, decouple_loss:0.0006240332149900496
The modified gen p mean: 0.446897953748703, gen p mean: -0.11483847349882126, mean p set: 0.4474692642688751
loss_pred:0.01740913651883602, decouple_loss:0.0005878162337467074
Iteration: 567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468587636947632, gen p mean: -0.11814142763614655, mean p set: 0.44743403792381287
loss_pred:0.017373623326420784, decouple_loss:0.0005711310659535229
The modified gen p mean: 0.44731491804122925, gen p mean: -0.1155456006526947, mean p set: 0.4478928744792938
The modified gen p mean: 0.4474778473377228, gen p mean: -0.12447217106819153, mean p set: 0.44805458188056946
loss_pred:0.017727231606841087, decouple_loss:0.0005833064788021147
loss_pred:0.015743782743811607, decouple_loss:0.000563292414881289
Iteration: 568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474964141845703, gen p mean: -0.11505722254514694, mean p set: 0.4480714499950409
loss_pred:0.016314081847667694, decouple_loss:0.0006576806190423667
The modified gen p mean: 0.4462193548679352, gen p mean: -0.12092141807079315, mean p set: 0.4467964172363281
The modified gen p mean: 0.4473673701286316, gen p mean: -0.12095678597688675, mean p set: 0.4479442238807678
loss_pred:0.016416847705841064, decouple_loss:0.000806716678198427
loss_pred:0.01666877418756485, decouple_loss:0.0008558826521039009
Iteration: 569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44856327772140503, gen p mean: -0.1206170842051506, mean p set: 0.44914042949676514
loss_pred:0.017232809215784073, decouple_loss:0.000596562516875565
The modified gen p mean: 0.4476870894432068, gen p mean: -0.1167370080947876, mean p set: 0.4482615292072296
loss_pred:0.016986733302474022, decouple_loss:0.0006048863288015127
The modified gen p mean: 0.4477136433124542, gen p mean: -0.11658064275979996, mean p set: 0.4482884109020233
loss_pred:0.016283687204122543, decouple_loss:0.0006189206033013761
Iteration: 570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448529452085495, gen p mean: -0.12114882469177246, mean p set: 0.44910722970962524
loss_pred:0.01691802591085434, decouple_loss:0.0010294847888872027
The modified gen p mean: 0.4475395679473877, gen p mean: -0.11612807214260101, mean p set: 0.448116660118103
loss_pred:0.018009673804044724, decouple_loss:0.0007101668161340058
The modified gen p mean: 0.44685256481170654, gen p mean: -0.11895012855529785, mean p set: 0.4474305510520935
loss_pred:0.017100151628255844, decouple_loss:0.0006851932848803699
2023-05-01 17:34:33 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1273725926876068, mean p set: 0.4502691626548767
loss_pred:0.017172155901789665, decouple_loss:0.0007314669783227146
The modified gen p mean: 0.4495357275009155, gen p mean: -0.12108702957630157, mean p set: 0.4500633478164673
loss_pred:0.016623567789793015, decouple_loss:0.0008038695668801665
The modified gen p mean: 0.44978028535842896, gen p mean: -0.12067694962024689, mean p set: 0.45035696029663086
loss_pred:0.016812382265925407, decouple_loss:0.0010039483895525336
WV_1_PC_1_EH_0_PS_40, loss: 0.016911691054701805, avg_mse: 0.026282792910933495
current test mse: 0.026283
Iteration: 571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472059905529022, gen p mean: -0.1221175491809845, mean p set: 0.44778236746788025
loss_pred:0.016926245763897896, decouple_loss:0.0006547202356159687
The modified gen p mean: 0.4471319019794464, gen p mean: -0.12627850472927094, mean p set: 0.44770732522010803
The modified gen p mean: 0.447935551404953, gen p mean: -0.12441310286521912, mean p set: 0.4485093653202057
loss_pred:0.016010362654924393, decouple_loss:0.0006066228379495442
loss_pred:0.01739361137151718, decouple_loss:0.0007918591145426035
Iteration: 572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660067558288574, gen p mean: -0.1252042055130005, mean p set: 0.44717806577682495
loss_pred:0.016939915716648102, decouple_loss:0.0005585739854723215
The modified gen p mean: 0.44944068789482117, gen p mean: -0.12704023718833923, mean p set: 0.4500185549259186The modified gen p mean: 0.4475485384464264, gen p mean: -0.12957003712654114, mean p set: 0.4481232166290283
loss_pred:0.01640722155570984, decouple_loss:0.0006092283292673528loss_pred:0.015946799889206886, decouple_loss:0.0005450742901302874
Iteration: 573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464561343193054, gen p mean: -0.12300930172204971, mean p set: 0.4470323920249939
loss_pred:0.016973141580820084, decouple_loss:0.0006681953091174364
The modified gen p mean: 0.44688600301742554, gen p mean: -0.1281254142522812, mean p set: 0.4474595785140991
loss_pred:0.015808960422873497, decouple_loss:0.0005057331873103976
The modified gen p mean: 0.44850867986679077, gen p mean: -0.1230747178196907, mean p set: 0.44908249378204346
loss_pred:0.0165291428565979, decouple_loss:0.0009465166367590427
Iteration: 574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759035110473633, gen p mean: -0.12201212346553802, mean p set: 0.44816598296165466
loss_pred:0.017440538853406906, decouple_loss:0.0006361097912304103
The modified gen p mean: 0.44761422276496887, gen p mean: -0.12727373838424683, mean p set: 0.44819125533103943
loss_pred:0.015478917397558689, decouple_loss:0.0005545608582906425
The modified gen p mean: 0.4484966993331909, gen p mean: -0.12332151085138321, mean p set: 0.44907209277153015
loss_pred:0.016977719962596893, decouple_loss:0.0008478586096316576
Iteration: 575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478009343147278, gen p mean: -0.12033551186323166, mean p set: 0.44837686419487
loss_pred:0.01722496747970581, decouple_loss:0.0005982390139251947
The modified gen p mean: 0.4498312473297119, gen p mean: -0.12283444404602051, mean p set: 0.45040658116340637
loss_pred:0.016179287806153297, decouple_loss:0.0005821521044708788
The modified gen p mean: 0.4491680860519409, gen p mean: -0.121619313955307, mean p set: 0.44974398612976074
loss_pred:0.01592690870165825, decouple_loss:0.0005375571781769395
Iteration: 576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781818985939026, gen p mean: -0.11837024241685867, mean p set: 0.448391854763031
loss_pred:0.016915438696742058, decouple_loss:0.0007866036030463874
The modified gen p mean: 0.4469678997993469, gen p mean: -0.11666525900363922, mean p set: 0.44754326343536377
loss_pred:0.01700996421277523, decouple_loss:0.0007106655393727124
The modified gen p mean: 0.4464116394519806, gen p mean: -0.11963587999343872, mean p set: 0.4469875395298004
loss_pred:0.01691800355911255, decouple_loss:0.0008679357706569135
Iteration: 577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478645622730255, gen p mean: -0.1145397499203682, mean p set: 0.44843971729278564
loss_pred:0.016282325610518456, decouple_loss:0.0007757849525660276
The modified gen p mean: 0.44784805178642273, gen p mean: -0.12399186939001083, mean p set: 0.4484272003173828
loss_pred:0.017128190025687218, decouple_loss:0.0007517275516875088
The modified gen p mean: 0.446749746799469, gen p mean: -0.12154391407966614, mean p set: 0.44732505083084106
loss_pred:0.016492635011672974, decouple_loss:0.0007963643874973059
Iteration: 578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474160373210907, gen p mean: -0.12222447991371155, mean p set: 0.447992742061615
loss_pred:0.017413603141903877, decouple_loss:0.0005976729444228113
The modified gen p mean: 0.4468752145767212, gen p mean: -0.11895382404327393, mean p set: 0.44745010137557983
loss_pred:0.017531774938106537, decouple_loss:0.0005006302380934358
The modified gen p mean: 0.44619864225387573, gen p mean: -0.11740146577358246, mean p set: 0.446774959564209
loss_pred:0.01681928150355816, decouple_loss:0.0006308414158411324
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012010_3_24hr.npz
NaN value num: 0
Iteration: 579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481154978275299, gen p mean: -0.11701289564371109, mean p set: 0.44869139790534973
loss_pred:0.01477170642465353, decouple_loss:0.0008387182606384158
The modified gen p mean: 0.44761666655540466, gen p mean: -0.11654254049062729, mean p set: 0.4481918513774872
loss_pred:0.014815610833466053, decouple_loss:0.0006017365376465023
The modified gen p mean: 0.44839465618133545, gen p mean: -0.11817942559719086, mean p set: 0.44897186756134033
loss_pred:0.014732527546584606, decouple_loss:0.0006554535357281566
Iteration: 580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44742825627326965, gen p mean: -0.12466505169868469, mean p set: 0.44800394773483276
loss_pred:0.015246395952999592, decouple_loss:0.0008060158579610288
The modified gen p mean: 0.44822943210601807, gen p mean: -0.12791694700717926, mean p set: 0.44880568981170654
loss_pred:0.01493876613676548, decouple_loss:0.0006753302877768874
The modified gen p mean: 0.44663581252098083, gen p mean: -0.12084223330020905, mean p set: 0.4472118318080902
loss_pred:0.01487528532743454, decouple_loss:0.0008094288059510291
2023-05-01 17:37:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1279759556055069, mean p set: 0.4502691626548767
loss_pred:0.01718025654554367, decouple_loss:0.000511196325533092
The modified gen p mean: 0.44977837800979614, gen p mean: -0.12116965651512146, mean p set: 0.45035696029663086
loss_pred:0.01685396209359169, decouple_loss:0.0007262983708642423
The modified gen p mean: 0.4495367109775543, gen p mean: -0.12163341790437698, mean p set: 0.4500633478164673
loss_pred:0.016614919528365135, decouple_loss:0.000641469843685627
WV_1_PC_1_EH_0_PS_40, loss: 0.016914362087845802, avg_mse: 0.026376845315098763
current test mse: 0.026377
Iteration: 581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484802782535553, gen p mean: -0.12612606585025787, mean p set: 0.4490576982498169
loss_pred:0.014386828057467937, decouple_loss:0.0005146382027305663
The modified gen p mean: 0.44706371426582336, gen p mean: -0.12617893517017365, mean p set: 0.4476398825645447
loss_pred:0.015277646481990814, decouple_loss:0.0005374556058086455
The modified gen p mean: 0.4471072256565094, gen p mean: -0.12361239641904831, mean p set: 0.44768473505973816
loss_pred:0.015015101060271263, decouple_loss:0.0006976064178161323
Iteration: 582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701045751571655, gen p mean: -0.1293540894985199, mean p set: 0.44758692383766174
loss_pred:0.015698231756687164, decouple_loss:0.0008459847886115313
The modified gen p mean: 0.44830939173698425, gen p mean: -0.11807353794574738, mean p set: 0.44888588786125183The modified gen p mean: 0.44816526770591736, gen p mean: -0.12768813967704773, mean p set: 0.4487426280975342
loss_pred:0.014544259756803513, decouple_loss:0.0008755051530897617
loss_pred:0.01520587969571352, decouple_loss:0.0005597715498879552
Iteration: 583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707605242729187, gen p mean: -0.12070072442293167, mean p set: 0.4476523995399475
loss_pred:0.015443054027855396, decouple_loss:0.00055249611614272
The modified gen p mean: 0.44833579659461975, gen p mean: -0.11693453788757324, mean p set: 0.448910653591156
loss_pred:0.014127161353826523, decouple_loss:0.0006902428576722741
The modified gen p mean: 0.4468022882938385, gen p mean: -0.11911420524120331, mean p set: 0.44737890362739563
loss_pred:0.015025751665234566, decouple_loss:0.0006698562647216022
Iteration: 584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486753046512604, gen p mean: -0.11421895027160645, mean p set: 0.44924864172935486
loss_pred:0.014094698242843151, decouple_loss:0.0005871553439646959
The modified gen p mean: 0.44839221239089966, gen p mean: -0.11304543167352676, mean p set: 0.44896969199180603
loss_pred:0.014755497686564922, decouple_loss:0.0005066710291430354
The modified gen p mean: 0.4471316933631897, gen p mean: -0.11083275824785233, mean p set: 0.4477090537548065
loss_pred:0.014706438407301903, decouple_loss:0.0007324551697820425
Iteration: 585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684743881225586, gen p mean: -0.11200126260519028, mean p set: 0.447422593832016
loss_pred:0.014911296777427197, decouple_loss:0.0009605356608517468
The modified gen p mean: 0.44883793592453003, gen p mean: -0.11101477593183517, mean p set: 0.44941452145576477
The modified gen p mean: 0.4470859467983246, gen p mean: -0.10866144299507141, mean p set: 0.4476620554924011
loss_pred:0.014594987966120243, decouple_loss:0.0005784612149000168
loss_pred:0.014873198233544827, decouple_loss:0.0007395869470201433
Iteration: 586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731616973876953, gen p mean: -0.11654705554246902, mean p set: 0.44789108633995056
loss_pred:0.015485779382288456, decouple_loss:0.0005856815841980278
The modified gen p mean: 0.4477284550666809, gen p mean: -0.1119745597243309, mean p set: 0.44830429553985596
loss_pred:0.014407956041395664, decouple_loss:0.0005900950636714697
The modified gen p mean: 0.4475058913230896, gen p mean: -0.11521882563829422, mean p set: 0.448081910610199
loss_pred:0.015456929802894592, decouple_loss:0.0007378734298981726
Iteration: 587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766172766685486, gen p mean: -0.11937268078327179, mean p set: 0.4482389986515045
loss_pred:0.014724531210958958, decouple_loss:0.0005673668929375708
The modified gen p mean: 0.4474222660064697, gen p mean: -0.11533093452453613, mean p set: 0.4479982852935791
loss_pred:0.014235607348382473, decouple_loss:0.0005647584912367165
The modified gen p mean: 0.4485718905925751, gen p mean: -0.11650514602661133, mean p set: 0.4491487443447113
loss_pred:0.01423403900116682, decouple_loss:0.0006218197522684932
Iteration: 588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465526342391968, gen p mean: -0.1237584576010704, mean p set: 0.4471273422241211
loss_pred:0.0153529467061162, decouple_loss:0.000617113197222352
The modified gen p mean: 0.4470479190349579, gen p mean: -0.11955371499061584, mean p set: 0.44762441515922546
loss_pred:0.01456496398895979, decouple_loss:0.0007514663157053292
The modified gen p mean: 0.4472562074661255, gen p mean: -0.12146425992250443, mean p set: 0.44783034920692444
loss_pred:0.014722689986228943, decouple_loss:0.0006361542618833482
Iteration: 589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471839368343353, gen p mean: -0.11621537059545517, mean p set: 0.4477570950984955
loss_pred:0.014857643283903599, decouple_loss:0.0005200015148147941
The modified gen p mean: 0.44657352566719055, gen p mean: -0.11650072038173676, mean p set: 0.4471501410007477
The modified gen p mean: 0.44808724522590637, gen p mean: -0.11696341633796692, mean p set: 0.44866064190864563
loss_pred:0.015021705068647861, decouple_loss:0.0008430861053057015
loss_pred:0.014736639335751534, decouple_loss:0.0005659621674567461
Iteration: 590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468032717704773, gen p mean: -0.11659345775842667, mean p set: 0.4473787844181061
loss_pred:0.014639398083090782, decouple_loss:0.0005002425168640912
The modified gen p mean: 0.4480304419994354, gen p mean: -0.11643471568822861, mean p set: 0.4486064314842224
The modified gen p mean: 0.44803160429000854, gen p mean: -0.11668893694877625, mean p set: 0.44860947132110596
loss_pred:0.014328892342746258, decouple_loss:0.0005336194299161434
loss_pred:0.014412076212465763, decouple_loss:0.0006428430788218975
2023-05-01 17:39:21 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.1181340143084526, mean p set: 0.4502691626548767
loss_pred:0.017187753692269325, decouple_loss:0.0006295128259807825
The modified gen p mean: 0.44953399896621704, gen p mean: -0.11249616742134094, mean p set: 0.4500633478164673
loss_pred:0.01645948924124241, decouple_loss:0.0006529878592118621
The modified gen p mean: 0.44978153705596924, gen p mean: -0.11249783635139465, mean p set: 0.45035696029663086
loss_pred:0.01689421944320202, decouple_loss:0.0005860866513103247
WV_1_PC_1_EH_0_PS_40, loss: 0.016878299415111542, avg_mse: 0.02627669647336006
current test mse: 0.026277
Iteration: 591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701865315437317, gen p mean: -0.11787699908018112, mean p set: 0.44759440422058105
loss_pred:0.014433120377361774, decouple_loss:0.0006426581530831754
The modified gen p mean: 0.44712528586387634, gen p mean: -0.12065369635820389, mean p set: 0.4477013349533081
loss_pred:0.015098385512828827, decouple_loss:0.0005408491124399006
The modified gen p mean: 0.44772401452064514, gen p mean: -0.11622123420238495, mean p set: 0.448304146528244
loss_pred:0.01451374776661396, decouple_loss:0.0006231874576769769
Iteration: 592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475399851799011, gen p mean: -0.11797898262739182, mean p set: 0.4481172263622284
loss_pred:0.015008325688540936, decouple_loss:0.000504584691952914
The modified gen p mean: 0.4471289813518524, gen p mean: -0.11458353698253632, mean p set: 0.44770386815071106The modified gen p mean: 0.4487515687942505, gen p mean: -0.1137709766626358, mean p set: 0.449325829744339
loss_pred:0.014722349122166634, decouple_loss:0.0005248464876785874
loss_pred:0.013422476127743721, decouple_loss:0.0005642385804094374
Iteration: 593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479101598262787, gen p mean: -0.11322031170129776, mean p set: 0.448486864566803
loss_pred:0.014334342442452908, decouple_loss:0.00048390377196483314
The modified gen p mean: 0.44768092036247253, gen p mean: -0.11357052624225616, mean p set: 0.4482576549053192
loss_pred:0.01467407587915659, decouple_loss:0.0004754756228066981
The modified gen p mean: 0.4467635452747345, gen p mean: -0.11925569921731949, mean p set: 0.4473388195037842
loss_pred:0.01452208124101162, decouple_loss:0.000505062926094979
Iteration: 594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690218567848206, gen p mean: -0.11267324537038803, mean p set: 0.4474763870239258
loss_pred:0.014823605306446552, decouple_loss:0.0005700101028196514
The modified gen p mean: 0.4478670060634613, gen p mean: -0.11592461168766022, mean p set: 0.448443204164505
loss_pred:0.014299671165645123, decouple_loss:0.0007594686467200518
The modified gen p mean: 0.44712620973587036, gen p mean: -0.1167585477232933, mean p set: 0.4477039873600006
loss_pred:0.013966795057058334, decouple_loss:0.0005597695708274841
Iteration: 595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447812557220459, gen p mean: -0.12032831460237503, mean p set: 0.4483886957168579
loss_pred:0.014584347605705261, decouple_loss:0.0006482136668637395
The modified gen p mean: 0.4463551640510559, gen p mean: -0.11806698888540268, mean p set: 0.4469318985939026
loss_pred:0.015573292970657349, decouple_loss:0.0006238851347006857
The modified gen p mean: 0.4480257034301758, gen p mean: -0.1160704717040062, mean p set: 0.4486024081707001
loss_pred:0.01455507893115282, decouple_loss:0.0006228104466572404
Iteration: 596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479449987411499, gen p mean: -0.11539056897163391, mean p set: 0.4485197067260742
loss_pred:0.014151395298540592, decouple_loss:0.0006271180463954806
The modified gen p mean: 0.4464752674102783, gen p mean: -0.11350400745868683, mean p set: 0.4470519721508026
loss_pred:0.014576305635273457, decouple_loss:0.0005058564711362123
The modified gen p mean: 0.44742506742477417, gen p mean: -0.11583449691534042, mean p set: 0.44800183176994324
loss_pred:0.014505013823509216, decouple_loss:0.0007128234137780964
Iteration: 597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799280166625977, gen p mean: -0.1173645555973053, mean p set: 0.4485662877559662
loss_pred:0.01427949033677578, decouple_loss:0.0005311294225975871
The modified gen p mean: 0.4472612142562866, gen p mean: -0.11740216612815857, mean p set: 0.4478378891944885
loss_pred:0.014289876446127892, decouple_loss:0.0005345071549527347
The modified gen p mean: 0.44795656204223633, gen p mean: -0.12169152498245239, mean p set: 0.44853144884109497
loss_pred:0.014458307065069675, decouple_loss:0.0005364400567486882
Iteration: 598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772690534591675, gen p mean: -0.11596477776765823, mean p set: 0.44830334186553955
loss_pred:0.014904114417731762, decouple_loss:0.0005754290614277124
The modified gen p mean: 0.44737327098846436, gen p mean: -0.11885348707437515, mean p set: 0.44794946908950806
loss_pred:0.014205988496541977, decouple_loss:0.0005280967452563345
The modified gen p mean: 0.44908326864242554, gen p mean: -0.11474330723285675, mean p set: 0.44966015219688416
loss_pred:0.013720190152525902, decouple_loss:0.0005187179194763303
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012010_3_24hr.npz
NaN value num: 0
Iteration: 599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44715312123298645, gen p mean: -0.11631666868925095, mean p set: 0.4477280378341675
loss_pred:0.015468097291886806, decouple_loss:0.0005360151408240199The modified gen p mean: 0.44831234216690063, gen p mean: -0.11988144367933273, mean p set: 0.44888749718666077
loss_pred:0.015010613016784191, decouple_loss:0.0006026201881468296
The modified gen p mean: 0.4471280872821808, gen p mean: -0.11765901744365692, mean p set: 0.4477040469646454
loss_pred:0.015553880482912064, decouple_loss:0.0006164431688375771
Iteration: 600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44813621044158936, gen p mean: -0.11477558314800262, mean p set: 0.4487118422985077
loss_pred:0.015186699107289314, decouple_loss:0.0006582101923413575
The modified gen p mean: 0.44736942648887634, gen p mean: -0.11673036217689514, mean p set: 0.4479471743106842
loss_pred:0.01615327224135399, decouple_loss:0.0005155180115252733
The modified gen p mean: 0.4483749568462372, gen p mean: -0.1138770580291748, mean p set: 0.448952317237854
loss_pred:0.015170530416071415, decouple_loss:0.0007874484290368855
2023-05-01 17:42:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11396370828151703, mean p set: 0.4502691626548767
loss_pred:0.017124716192483902, decouple_loss:0.0007535491022281349
The modified gen p mean: 0.4495370090007782, gen p mean: -0.10844442993402481, mean p set: 0.4500633478164673
loss_pred:0.016419103369116783, decouple_loss:0.0006489774095825851
The modified gen p mean: 0.44977959990501404, gen p mean: -0.10819878429174423, mean p set: 0.45035696029663086
loss_pred:0.016785478219389915, decouple_loss:0.0008072719792835414
WV_1_PC_1_EH_0_PS_40, loss: 0.016813263297080994, avg_mse: 0.02616572007536888
current test mse: 0.026166
Iteration: 601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740164279937744, gen p mean: -0.11102582514286041, mean p set: 0.44797828793525696
loss_pred:0.016077179461717606, decouple_loss:0.0005101697752252221
The modified gen p mean: 0.447286993265152, gen p mean: -0.10624219477176666, mean p set: 0.4478640854358673The modified gen p mean: 0.4472145140171051, gen p mean: -0.11382382363080978, mean p set: 0.44779056310653687
loss_pred:0.014819244854152203, decouple_loss:0.0006021693116053939loss_pred:0.014930147677659988, decouple_loss:0.0007758642896078527
Iteration: 602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473969042301178, gen p mean: -0.11169786006212234, mean p set: 0.44797375798225403
loss_pred:0.016685642302036285, decouple_loss:0.0005821585655212402
The modified gen p mean: 0.44806477427482605, gen p mean: -0.10891488194465637, mean p set: 0.4486413896083832The modified gen p mean: 0.44799646735191345, gen p mean: -0.10991460084915161, mean p set: 0.4485739767551422
loss_pred:0.014847522601485252, decouple_loss:0.0006951234536245465
loss_pred:0.01521451584994793, decouple_loss:0.0006251237355172634
Iteration: 603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482846260070801, gen p mean: -0.11094044148921967, mean p set: 0.4488631784915924
loss_pred:0.015367299318313599, decouple_loss:0.0005583788151852787
The modified gen p mean: 0.44751495122909546, gen p mean: -0.10787064582109451, mean p set: 0.44809025526046753
loss_pred:0.015331999398767948, decouple_loss:0.0006523809279315174
The modified gen p mean: 0.44661861658096313, gen p mean: -0.11011506617069244, mean p set: 0.44719401001930237
loss_pred:0.016148176044225693, decouple_loss:0.0005365730612538755
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720786809921265, gen p mean: -0.11379214376211166, mean p set: 0.4477818012237549
The modified gen p mean: 0.44667848944664, gen p mean: -0.11534187197685242, mean p set: 0.44725507497787476
loss_pred:0.01543810497969389, decouple_loss:0.0005542535218410194
loss_pred:0.015387027524411678, decouple_loss:0.0005600354634225368
The modified gen p mean: 0.44708171486854553, gen p mean: -0.11045941710472107, mean p set: 0.44765913486480713
loss_pred:0.01556000579148531, decouple_loss:0.0005340421921573579
Iteration: 605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702035188674927, gen p mean: -0.11427807062864304, mean p set: 0.44759562611579895
The modified gen p mean: 0.44769906997680664, gen p mean: -0.11489907652139664, mean p set: 0.44827502965927124
loss_pred:0.014960113912820816, decouple_loss:0.0005495803197845817
loss_pred:0.015545825473964214, decouple_loss:0.000565520953387022
The modified gen p mean: 0.44652318954467773, gen p mean: -0.11259747296571732, mean p set: 0.44709837436676025
loss_pred:0.01604042947292328, decouple_loss:0.0005824732943437994
Iteration: 606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477071166038513, gen p mean: -0.10778522491455078, mean p set: 0.4482816159725189
loss_pred:0.015579783357679844, decouple_loss:0.0006351688061840832
The modified gen p mean: 0.44744428992271423, gen p mean: -0.11184688657522202, mean p set: 0.44802215695381165
loss_pred:0.01509538758546114, decouple_loss:0.000581703963689506
The modified gen p mean: 0.4472309350967407, gen p mean: -0.11605092883110046, mean p set: 0.4478060305118561
loss_pred:0.015489662066102028, decouple_loss:0.0006091829854995012
Iteration: 607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44826874136924744, gen p mean: -0.10802098363637924, mean p set: 0.44884711503982544
loss_pred:0.015745894983410835, decouple_loss:0.0006411127978935838
The modified gen p mean: 0.4472369849681854, gen p mean: -0.11016897857189178, mean p set: 0.4478125274181366
loss_pred:0.015072403475642204, decouple_loss:0.0006008332711644471
The modified gen p mean: 0.4465057849884033, gen p mean: -0.1105947270989418, mean p set: 0.4470813572406769
loss_pred:0.015106999315321445, decouple_loss:0.000554432685021311
Iteration: 608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476175606250763, gen p mean: -0.1059398278594017, mean p set: 0.4481956660747528
loss_pred:0.015436515212059021, decouple_loss:0.0006210376741364598
The modified gen p mean: 0.4475230872631073, gen p mean: -0.10340840369462967, mean p set: 0.44809815287590027
loss_pred:0.01468894723802805, decouple_loss:0.00047917276970110834
The modified gen p mean: 0.4468876123428345, gen p mean: -0.11209724098443985, mean p set: 0.44746458530426025
loss_pred:0.015519746579229832, decouple_loss:0.000501937756780535
Iteration: 609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460434913635254, gen p mean: -0.11440712213516235, mean p set: 0.44661951065063477
The modified gen p mean: 0.4476297199726105, gen p mean: -0.1127864345908165, mean p set: 0.44820475578308105
loss_pred:0.01564197801053524, decouple_loss:0.0005043283454142511
loss_pred:0.01588224060833454, decouple_loss:0.0006003537564538419
The modified gen p mean: 0.4474582374095917, gen p mean: -0.10420366376638412, mean p set: 0.44803258776664734
loss_pred:0.015161165036261082, decouple_loss:0.0005127505282871425
Iteration: 610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446666955947876, gen p mean: -0.11462078988552094, mean p set: 0.44724181294441223
loss_pred:0.015008817426860332, decouple_loss:0.0005691041587851942
The modified gen p mean: 0.44584956765174866, gen p mean: -0.11603939533233643, mean p set: 0.44642776250839233
loss_pred:0.015282063744962215, decouple_loss:0.0005800601793453097
The modified gen p mean: 0.44643065333366394, gen p mean: -0.11534944921731949, mean p set: 0.4470071494579315
loss_pred:0.015209791250526905, decouple_loss:0.0005688082310371101
2023-05-01 17:44:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11543017625808716, mean p set: 0.4502691626548767
loss_pred:0.017166225239634514, decouple_loss:0.0006132423877716064
The modified gen p mean: 0.44953417778015137, gen p mean: -0.11032263189554214, mean p set: 0.4500633478164673
loss_pred:0.01646270789206028, decouple_loss:0.0005718503380194306
The modified gen p mean: 0.44977930188179016, gen p mean: -0.11032511293888092, mean p set: 0.45035696029663086
loss_pred:0.016826802864670753, decouple_loss:0.0006197873735800385
WV_1_PC_1_EH_0_PS_40, loss: 0.01684866100549698, avg_mse: 0.02622721530497074
current test mse: 0.026227
Iteration: 611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673916697502136, gen p mean: -0.11718109250068665, mean p set: 0.4473138451576233
loss_pred:0.015535534359514713, decouple_loss:0.0006452286033891141
The modified gen p mean: 0.44763901829719543, gen p mean: -0.11438053101301193, mean p set: 0.4482135772705078
loss_pred:0.015344582498073578, decouple_loss:0.0007326449849642813
The modified gen p mean: 0.4474303126335144, gen p mean: -0.11663676053285599, mean p set: 0.4480046033859253
loss_pred:0.014942005276679993, decouple_loss:0.0005667961086146533
Iteration: 612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448098748922348, gen p mean: -0.1153508648276329, mean p set: 0.4486749470233917
loss_pred:0.015708843246102333, decouple_loss:0.0005113559891469777
The modified gen p mean: 0.4478435516357422, gen p mean: -0.11312281340360641, mean p set: 0.4484192430973053The modified gen p mean: 0.4472656548023224, gen p mean: -0.11026851087808609, mean p set: 0.44784313440322876
loss_pred:0.015727166086435318, decouple_loss:0.0005445146816782653
loss_pred:0.015974130481481552, decouple_loss:0.0005976110696792603
Iteration: 613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445953369140625, gen p mean: -0.11379319429397583, mean p set: 0.4465283155441284
loss_pred:0.01597812958061695, decouple_loss:0.0006024440517649055
The modified gen p mean: 0.4479965567588806, gen p mean: -0.11069871485233307, mean p set: 0.4485728442668915
loss_pred:0.015277869068086147, decouple_loss:0.0005647658254019916
The modified gen p mean: 0.447807252407074, gen p mean: -0.11330077797174454, mean p set: 0.44838324189186096
loss_pred:0.015361137688159943, decouple_loss:0.0006522407638840377
Iteration: 614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44604021310806274, gen p mean: -0.11536794900894165, mean p set: 0.4466179311275482
loss_pred:0.015285348519682884, decouple_loss:0.0005806433036923409
The modified gen p mean: 0.44789087772369385, gen p mean: -0.11222832649946213, mean p set: 0.4484681785106659
loss_pred:0.015348018147051334, decouple_loss:0.0006047249771654606
The modified gen p mean: 0.44758981466293335, gen p mean: -0.11383964121341705, mean p set: 0.4481656849384308
loss_pred:0.01559637300670147, decouple_loss:0.0004997931537218392
Iteration: 615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447160005569458, gen p mean: -0.1071988120675087, mean p set: 0.4477352201938629
loss_pred:0.015832578763365746, decouple_loss:0.0006272611790336668
The modified gen p mean: 0.4458083212375641, gen p mean: -0.11399561166763306, mean p set: 0.44638389348983765
loss_pred:0.014574471861124039, decouple_loss:0.0005829032743349671
The modified gen p mean: 0.4484880268573761, gen p mean: -0.11048687994480133, mean p set: 0.4490656852722168
loss_pred:0.015234892256557941, decouple_loss:0.000802443188149482
Iteration: 616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447793185710907, gen p mean: -0.10684718191623688, mean p set: 0.44837021827697754
loss_pred:0.015352942980825901, decouple_loss:0.000603059190325439
The modified gen p mean: 0.4463399052619934, gen p mean: -0.1110391765832901, mean p set: 0.44691428542137146
The modified gen p mean: 0.44625526666641235, gen p mean: -0.10987688601016998, mean p set: 0.4468306601047516
loss_pred:0.015624388121068478, decouple_loss:0.0006293923943303525
loss_pred:0.014359230175614357, decouple_loss:0.000564122456125915
Iteration: 617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461754858493805, gen p mean: -0.10914646834135056, mean p set: 0.4467509686946869
loss_pred:0.01562722772359848, decouple_loss:0.0005857991054654121
The modified gen p mean: 0.4475460648536682, gen p mean: -0.11102912575006485, mean p set: 0.44812464714050293
The modified gen p mean: 0.44715410470962524, gen p mean: -0.11117725074291229, mean p set: 0.447729229927063
loss_pred:0.015433544293045998, decouple_loss:0.0006125649088062346
loss_pred:0.015443583019077778, decouple_loss:0.00051515968516469
Iteration: 618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699177145957947, gen p mean: -0.11445124447345734, mean p set: 0.44756636023521423
loss_pred:0.015167804434895515, decouple_loss:0.0005298132891766727
The modified gen p mean: 0.44797658920288086, gen p mean: -0.11379531025886536, mean p set: 0.4485515058040619
The modified gen p mean: 0.44759154319763184, gen p mean: -0.10899972915649414, mean p set: 0.44816744327545166
loss_pred:0.01580372452735901, decouple_loss:0.0004710209323093295
loss_pred:0.01560667809098959, decouple_loss:0.000495971878990531
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012013_3_24hr.npz
NaN value num: 0
Iteration: 619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468163251876831, gen p mean: -0.10463324934244156, mean p set: 0.44739410281181335
loss_pred:0.016027171164751053, decouple_loss:0.0005852407775819302
The modified gen p mean: 0.4473147988319397, gen p mean: -0.10606609284877777, mean p set: 0.4478895962238312
The modified gen p mean: 0.44790178537368774, gen p mean: -0.1145944744348526, mean p set: 0.4484758675098419
loss_pred:0.014408395625650883, decouple_loss:0.0006526916986331344
loss_pred:0.014913516119122505, decouple_loss:0.000662928563542664
Iteration: 620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488201141357422, gen p mean: -0.10420827567577362, mean p set: 0.4493965804576874
loss_pred:0.014394555240869522, decouple_loss:0.0008577439584769309
The modified gen p mean: 0.4476732015609741, gen p mean: -0.11439386010169983, mean p set: 0.44824886322021484
The modified gen p mean: 0.44765955209732056, gen p mean: -0.11215755343437195, mean p set: 0.4482361972332001
loss_pred:0.014714651741087437, decouple_loss:0.0005049646715633571
loss_pred:0.014919026754796505, decouple_loss:0.0006033187382854521
2023-05-01 17:47:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11439111083745956, mean p set: 0.4502691626548767
loss_pred:0.017125802114605904, decouple_loss:0.0008222155156545341
The modified gen p mean: 0.4495358467102051, gen p mean: -0.10879641026258469, mean p set: 0.4500633478164673
loss_pred:0.016480011865496635, decouple_loss:0.0006478879367932677
The modified gen p mean: 0.44978195428848267, gen p mean: -0.10840214788913727, mean p set: 0.45035696029663086
loss_pred:0.016833875328302383, decouple_loss:0.0006477152346633375
WV_1_PC_1_EH_0_PS_40, loss: 0.016848526895046234, avg_mse: 0.026242243126034737
current test mse: 0.026242
Iteration: 621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486071467399597, gen p mean: -0.10674495249986649, mean p set: 0.449184387922287
loss_pred:0.014732267707586288, decouple_loss:0.0006620239582844079
The modified gen p mean: 0.44838687777519226, gen p mean: -0.10971098393201828, mean p set: 0.4489628076553345
loss_pred:0.014673979952931404, decouple_loss:0.0005160197615623474
The modified gen p mean: 0.44660666584968567, gen p mean: -0.1077406108379364, mean p set: 0.4471812844276428
loss_pred:0.015292098745703697, decouple_loss:0.0005717583117075264
Iteration: 622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472247362136841, gen p mean: -0.11569531261920929, mean p set: 0.4478025436401367
loss_pred:0.014668439514935017, decouple_loss:0.0009745674324221909
The modified gen p mean: 0.4469975531101227, gen p mean: -0.10749134421348572, mean p set: 0.4475743770599365The modified gen p mean: 0.44735103845596313, gen p mean: -0.1086326614022255, mean p set: 0.4479270875453949
loss_pred:0.01606116257607937, decouple_loss:0.0009743653354234993
loss_pred:0.01450658030807972, decouple_loss:0.0008737962925806642
Iteration: 623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461774230003357, gen p mean: -0.10493826121091843, mean p set: 0.44675159454345703
loss_pred:0.01556861586868763, decouple_loss:0.0007121505914255977
The modified gen p mean: 0.4478033185005188, gen p mean: -0.1057254895567894, mean p set: 0.4483802020549774
loss_pred:0.014418363571166992, decouple_loss:0.0006201353971846402
The modified gen p mean: 0.4478030800819397, gen p mean: -0.10372673720121384, mean p set: 0.4483778774738312
loss_pred:0.014818789437413216, decouple_loss:0.0005917982198297977
Iteration: 624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694897532463074, gen p mean: -0.11051256954669952, mean p set: 0.4475267231464386The modified gen p mean: 0.447165310382843, gen p mean: -0.1174452006816864, mean p set: 0.4477385878562927
loss_pred:0.014982180669903755, decouple_loss:0.0006281810929067433
loss_pred:0.01516543049365282, decouple_loss:0.000604163680691272
The modified gen p mean: 0.4484405517578125, gen p mean: -0.10801622271537781, mean p set: 0.4490176737308502
loss_pred:0.01466393657028675, decouple_loss:0.0006320630782283843
Iteration: 625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44790101051330566, gen p mean: -0.11237085610628128, mean p set: 0.4484791159629822
loss_pred:0.014764511957764626, decouple_loss:0.0005254650022834539
The modified gen p mean: 0.44699084758758545, gen p mean: -0.11593613028526306, mean p set: 0.44756677746772766
loss_pred:0.015075881965458393, decouple_loss:0.0006384308217093349
The modified gen p mean: 0.4480394721031189, gen p mean: -0.11245947331190109, mean p set: 0.4486168920993805
loss_pred:0.014557250775396824, decouple_loss:0.0007197766099125147
Iteration: 626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478953778743744, gen p mean: -0.10715776681900024, mean p set: 0.44847285747528076
loss_pred:0.014400949701666832, decouple_loss:0.0007614052155986428
The modified gen p mean: 0.44618985056877136, gen p mean: -0.1049017533659935, mean p set: 0.44676467776298523
loss_pred:0.014414136298000813, decouple_loss:0.0006179951597005129
The modified gen p mean: 0.44866496324539185, gen p mean: -0.09729910641908646, mean p set: 0.44924309849739075
loss_pred:0.014960492961108685, decouple_loss:0.0009230145369656384
Iteration: 627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44879844784736633, gen p mean: -0.10173702239990234, mean p set: 0.44937291741371155
loss_pred:0.014566075056791306, decouple_loss:0.0005319338524714112
The modified gen p mean: 0.4473612904548645, gen p mean: -0.11223951727151871, mean p set: 0.44793838262557983
loss_pred:0.014804554171860218, decouple_loss:0.0008215681882575154
The modified gen p mean: 0.44699519872665405, gen p mean: -0.10436651110649109, mean p set: 0.44756919145584106
loss_pred:0.01576276123523712, decouple_loss:0.00063374760793522
Iteration: 628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653189182281494, gen p mean: -0.10658678412437439, mean p set: 0.447108656167984
loss_pred:0.014091230928897858, decouple_loss:0.0006259357905946672
The modified gen p mean: 0.44717490673065186, gen p mean: -0.11167944222688675, mean p set: 0.4477514624595642
loss_pred:0.014468188397586346, decouple_loss:0.0006745313294231892
The modified gen p mean: 0.44809454679489136, gen p mean: -0.10605569183826447, mean p set: 0.4486709535121918
loss_pred:0.014066582545638084, decouple_loss:0.0006977677112445235
Iteration: 629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44672220945358276, gen p mean: -0.11473923921585083, mean p set: 0.44729676842689514
loss_pred:0.014923137612640858, decouple_loss:0.0005744204390794039
The modified gen p mean: 0.4464187026023865, gen p mean: -0.10802137851715088, mean p set: 0.4469953179359436
The modified gen p mean: 0.4468294680118561, gen p mean: -0.10930611193180084, mean p set: 0.4474049210548401
loss_pred:0.01472263690084219, decouple_loss:0.000563858775421977
loss_pred:0.014818011783063412, decouple_loss:0.0006586050731129944
Iteration: 630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471460282802582, gen p mean: -0.11407657712697983, mean p set: 0.44772061705589294
loss_pred:0.01479858998209238, decouple_loss:0.0006579115870408714
The modified gen p mean: 0.4470183253288269, gen p mean: -0.11655791848897934, mean p set: 0.44759422540664673
The modified gen p mean: 0.4480668902397156, gen p mean: -0.1040802001953125, mean p set: 0.4486429989337921
loss_pred:0.014619109220802784, decouple_loss:0.0005840871599502861
loss_pred:0.014551309868693352, decouple_loss:0.0006046358030289412
2023-05-01 17:49:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11736806482076645, mean p set: 0.4502691626548767
loss_pred:0.01707114465534687, decouple_loss:0.0005829345318488777
The modified gen p mean: 0.4495352506637573, gen p mean: -0.11143308877944946, mean p set: 0.4500633478164673
loss_pred:0.016392890363931656, decouple_loss:0.0008022973779588938
The modified gen p mean: 0.44977861642837524, gen p mean: -0.11130153387784958, mean p set: 0.45035696029663086
loss_pred:0.016822604462504387, decouple_loss:0.0009156591258943081
WV_1_PC_1_EH_0_PS_40, loss: 0.016800563782453537, avg_mse: 0.026180103421211243
current test mse: 0.02618
Iteration: 631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486857056617737, gen p mean: -0.11547442525625229, mean p set: 0.44926023483276367
loss_pred:0.01458195224404335, decouple_loss:0.0008580933208577335
The modified gen p mean: 0.4473735988140106, gen p mean: -0.1156650185585022, mean p set: 0.44795170426368713
The modified gen p mean: 0.44642502069473267, gen p mean: -0.11785387247800827, mean p set: 0.44700247049331665
loss_pred:0.014652997255325317, decouple_loss:0.000541136774700135
loss_pred:0.015253645367920399, decouple_loss:0.0007928363047540188
Iteration: 632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447534441947937, gen p mean: -0.10876259207725525, mean p set: 0.4481112062931061
loss_pred:0.015439514070749283, decouple_loss:0.0007569958688691258
The modified gen p mean: 0.4474315047264099, gen p mean: -0.11537334322929382, mean p set: 0.44800853729248047
The modified gen p mean: 0.4471176564693451, gen p mean: -0.11559266597032547, mean p set: 0.4476914703845978
loss_pred:0.014822146855294704, decouple_loss:0.0006258079083636403
loss_pred:0.014883202500641346, decouple_loss:0.0008007221040315926
Iteration: 633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44620099663734436, gen p mean: -0.11965716630220413, mean p set: 0.44677630066871643
loss_pred:0.015281164087355137, decouple_loss:0.0006959200836718082
The modified gen p mean: 0.4464534521102905, gen p mean: -0.11472079902887344, mean p set: 0.4470299780368805
loss_pred:0.015400461852550507, decouple_loss:0.0005932418280281126
The modified gen p mean: 0.44674643874168396, gen p mean: -0.12416713684797287, mean p set: 0.4473215639591217
loss_pred:0.015131217427551746, decouple_loss:0.0006622221553698182
Iteration: 634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44662392139434814, gen p mean: -0.12284961342811584, mean p set: 0.4471994936466217
loss_pred:0.015017358586192131, decouple_loss:0.0007678189431317151
The modified gen p mean: 0.44820481538772583, gen p mean: -0.11450539529323578, mean p set: 0.44877946376800537
loss_pred:0.013995987363159657, decouple_loss:0.0009067293722182512
The modified gen p mean: 0.4482950270175934, gen p mean: -0.11317901313304901, mean p set: 0.4488696753978729
loss_pred:0.014049162156879902, decouple_loss:0.0006614848389290273
Iteration: 635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474135637283325, gen p mean: -0.11453481018543243, mean p set: 0.44798827171325684
loss_pred:0.014193444512784481, decouple_loss:0.0007467325776815414
The modified gen p mean: 0.4479493498802185, gen p mean: -0.121010422706604, mean p set: 0.4485274851322174
loss_pred:0.014690219424664974, decouple_loss:0.0007888239924795926
The modified gen p mean: 0.44721558690071106, gen p mean: -0.1150464341044426, mean p set: 0.44779151678085327
loss_pred:0.014566176570951939, decouple_loss:0.000877921876963228
Iteration: 636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446828156709671, gen p mean: -0.1125582829117775, mean p set: 0.4474024176597595
loss_pred:0.01457675639539957, decouple_loss:0.0005072515341453254
The modified gen p mean: 0.44778624176979065, gen p mean: -0.11717876046895981, mean p set: 0.44836175441741943
loss_pred:0.014446527697145939, decouple_loss:0.000775681110098958
The modified gen p mean: 0.4473308324813843, gen p mean: -0.11700192838907242, mean p set: 0.44790735840797424
loss_pred:0.014604832977056503, decouple_loss:0.0006920001469552517
Iteration: 637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476938247680664, gen p mean: -0.11585710197687149, mean p set: 0.44827136397361755
loss_pred:0.014380458742380142, decouple_loss:0.0005835027550347149
The modified gen p mean: 0.44707784056663513, gen p mean: -0.11732393503189087, mean p set: 0.44765228033065796
loss_pred:0.015038030222058296, decouple_loss:0.000715677160769701
The modified gen p mean: 0.4477520287036896, gen p mean: -0.11185276508331299, mean p set: 0.44832685589790344
loss_pred:0.014567463658750057, decouple_loss:0.0008264532661996782
Iteration: 638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44737330079078674, gen p mean: -0.11220137029886246, mean p set: 0.4479469656944275
loss_pred:0.014797748066484928, decouple_loss:0.0005408977740444243
The modified gen p mean: 0.4466829299926758, gen p mean: -0.11462398618459702, mean p set: 0.44725939631462097
loss_pred:0.014905787073075771, decouple_loss:0.0008302276837639511
The modified gen p mean: 0.4479905068874359, gen p mean: -0.10577253252267838, mean p set: 0.4485653042793274
loss_pred:0.013903295621275902, decouple_loss:0.0007596688810735941
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012008_3_24hr.npz
NaN value num: 0
Iteration: 639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463419020175934, gen p mean: -0.11202400922775269, mean p set: 0.4469212293624878
loss_pred:0.01652604714035988, decouple_loss:0.0006041968008503318
The modified gen p mean: 0.44550156593322754, gen p mean: -0.10971880704164505, mean p set: 0.4460771083831787
loss_pred:0.017835095524787903, decouple_loss:0.0006617262843064964
The modified gen p mean: 0.4468095600605011, gen p mean: -0.1156265139579773, mean p set: 0.4473839998245239
loss_pred:0.016780396923422813, decouple_loss:0.0008328593103215098
Iteration: 640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44557273387908936, gen p mean: -0.1095140278339386, mean p set: 0.4461488425731659
loss_pred:0.016918092966079712, decouple_loss:0.0007350950036197901
The modified gen p mean: 0.4457269608974457, gen p mean: -0.10861190408468246, mean p set: 0.44630083441734314
loss_pred:0.01680753380060196, decouple_loss:0.0009129768586717546
The modified gen p mean: 0.4473522901535034, gen p mean: -0.11418543010950089, mean p set: 0.44792690873146057
loss_pred:0.017364047467708588, decouple_loss:0.0008121769642457366
2023-05-01 17:51:54 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11302682012319565, mean p set: 0.4502691626548767
loss_pred:0.017050212249159813, decouple_loss:0.0011051048059016466
The modified gen p mean: 0.44978034496307373, gen p mean: -0.10747510194778442, mean p set: 0.45035696029663086
loss_pred:0.016673998907208443, decouple_loss:0.0006814268417656422
The modified gen p mean: 0.4495336711406708, gen p mean: -0.10746253281831741, mean p set: 0.4500633478164673
loss_pred:0.016374101862311363, decouple_loss:0.000697018695063889
WV_1_PC_1_EH_0_PS_40, loss: 0.0167408287525177, avg_mse: 0.02597535215318203
current test mse: 0.025975
At step 640, Best test: 0.025975
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44688501954078674, gen p mean: -0.10398681461811066, mean p set: 0.4474627375602722
loss_pred:0.017234517261385918, decouple_loss:0.0008765308302827179
The modified gen p mean: 0.44610118865966797, gen p mean: -0.11016793549060822, mean p set: 0.4466760754585266
loss_pred:0.01723788119852543, decouple_loss:0.0006941561587154865
The modified gen p mean: 0.4463978111743927, gen p mean: -0.1075662299990654, mean p set: 0.4469709098339081
loss_pred:0.016468094661831856, decouple_loss:0.0007954423199407756
Iteration: 642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797036051750183, gen p mean: -0.10726041346788406, mean p set: 0.4485476016998291
loss_pred:0.015808379277586937, decouple_loss:0.0005380562506616116
The modified gen p mean: 0.44559451937675476, gen p mean: -0.10951811075210571, mean p set: 0.4461705982685089The modified gen p mean: 0.446394145488739, gen p mean: -0.10863489657640457, mean p set: 0.4469703137874603
loss_pred:0.017319630831480026, decouple_loss:0.0005719645414501429
loss_pred:0.016961272805929184, decouple_loss:0.000517379492521286
Iteration: 643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487503468990326, gen p mean: -0.10578882694244385, mean p set: 0.4493277370929718
loss_pred:0.015676362439990044, decouple_loss:0.000873722427058965
The modified gen p mean: 0.44627586007118225, gen p mean: -0.10993403196334839, mean p set: 0.4468543529510498
loss_pred:0.017469137907028198, decouple_loss:0.0007100969087332487
The modified gen p mean: 0.4465557932853699, gen p mean: -0.1085749939084053, mean p set: 0.4471311867237091
loss_pred:0.016475923359394073, decouple_loss:0.000902974046766758
Iteration: 644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609588384628296, gen p mean: -0.1093510091304779, mean p set: 0.44667208194732666
The modified gen p mean: 0.4485517740249634, gen p mean: -0.10869354754686356, mean p set: 0.44912847876548767
loss_pred:0.0169324092566967, decouple_loss:0.0007885442464612424
loss_pred:0.01575915887951851, decouple_loss:0.0010898708133026958
The modified gen p mean: 0.44636601209640503, gen p mean: -0.10703554004430771, mean p set: 0.44694146513938904
loss_pred:0.01671946793794632, decouple_loss:0.0006680559599772096
Iteration: 645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453863203525543, gen p mean: -0.11094433069229126, mean p set: 0.4459622800350189
loss_pred:0.01753300614655018, decouple_loss:0.0006560588371939957
The modified gen p mean: 0.4467589557170868, gen p mean: -0.10841672867536545, mean p set: 0.44733378291130066
loss_pred:0.01752019114792347, decouple_loss:0.000622810039203614
The modified gen p mean: 0.4468526840209961, gen p mean: -0.10980912297964096, mean p set: 0.4474280774593353
loss_pred:0.016848847270011902, decouple_loss:0.0006692620809189975
Iteration: 646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44612568616867065, gen p mean: -0.11635875701904297, mean p set: 0.4466996490955353
loss_pred:0.017035912722349167, decouple_loss:0.0008138656266964972
The modified gen p mean: 0.4465022683143616, gen p mean: -0.11831682175397873, mean p set: 0.44707679748535156
loss_pred:0.017430493608117104, decouple_loss:0.0010702027939260006
The modified gen p mean: 0.44677650928497314, gen p mean: -0.119684137403965, mean p set: 0.4473523199558258
loss_pred:0.016116097569465637, decouple_loss:0.0009655877365730703
Iteration: 647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44624099135398865, gen p mean: -0.12706851959228516, mean p set: 0.4468180239200592
loss_pred:0.01740998961031437, decouple_loss:0.0009457420092076063
The modified gen p mean: 0.4461980164051056, gen p mean: -0.12309294939041138, mean p set: 0.44677287340164185
loss_pred:0.017602555453777313, decouple_loss:0.0009724972187541425
The modified gen p mean: 0.4461895227432251, gen p mean: -0.1159331426024437, mean p set: 0.4467623829841614
loss_pred:0.017424937337636948, decouple_loss:0.0007162198307923973
Iteration: 648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606104493141174, gen p mean: -0.12028577923774719, mean p set: 0.4466344118118286
loss_pred:0.017800472676753998, decouple_loss:0.0006418324774131179
The modified gen p mean: 0.44623804092407227, gen p mean: -0.12087942659854889, mean p set: 0.4468151926994324
The modified gen p mean: 0.4457661211490631, gen p mean: -0.1192513108253479, mean p set: 0.44634416699409485
loss_pred:0.016505615785717964, decouple_loss:0.0006814097869209945
loss_pred:0.016827428713440895, decouple_loss:0.0007937715272419155
Iteration: 649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447836697101593, gen p mean: -0.12672191858291626, mean p set: 0.44841480255126953
loss_pred:0.015796469524502754, decouple_loss:0.0007083653472363949
The modified gen p mean: 0.4469200372695923, gen p mean: -0.12010393291711807, mean p set: 0.44749733805656433
loss_pred:0.01712878607213497, decouple_loss:0.0006625760579481721
The modified gen p mean: 0.44703611731529236, gen p mean: -0.1295490264892578, mean p set: 0.44760826230049133
loss_pred:0.017363963648676872, decouple_loss:0.0006191226420924067
Iteration: 650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44599679112434387, gen p mean: -0.1231665387749672, mean p set: 0.4465733468532562
loss_pred:0.01679299958050251, decouple_loss:0.0006542853079736233
The modified gen p mean: 0.4458922743797302, gen p mean: -0.12254692614078522, mean p set: 0.4464716613292694
loss_pred:0.016460612416267395, decouple_loss:0.0007353877299465239
The modified gen p mean: 0.4466651678085327, gen p mean: -0.12076976150274277, mean p set: 0.4472403824329376
loss_pred:0.0170085858553648, decouple_loss:0.0006393690127879381
2023-05-01 17:54:05 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12651567161083221, mean p set: 0.4502691626548767
loss_pred:0.01712452806532383, decouple_loss:0.000641827704384923
The modified gen p mean: 0.44953519105911255, gen p mean: -0.12121324241161346, mean p set: 0.4500633478164673
loss_pred:0.016544368118047714, decouple_loss:0.0006013877573423088
The modified gen p mean: 0.44978275895118713, gen p mean: -0.12088858336210251, mean p set: 0.45035696029663086
loss_pred:0.016872957348823547, decouple_loss:0.0005682334885932505
WV_1_PC_1_EH_0_PS_40, loss: 0.01687747612595558, avg_mse: 0.026191791519522667
current test mse: 0.026192
Iteration: 651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461517632007599, gen p mean: -0.12589050829410553, mean p set: 0.4467245936393738
loss_pred:0.0178716778755188, decouple_loss:0.0005737761966884136
The modified gen p mean: 0.4468653202056885, gen p mean: -0.12448545545339584, mean p set: 0.44744330644607544The modified gen p mean: 0.4463425278663635, gen p mean: -0.12006908655166626, mean p set: 0.44691601395606995
loss_pred:0.016448045149445534, decouple_loss:0.0005260299658402801loss_pred:0.017834622412919998, decouple_loss:0.0005492268828675151
Iteration: 652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473996162414551, gen p mean: -0.12077635526657104, mean p set: 0.4479721784591675
loss_pred:0.015755247324705124, decouple_loss:0.0007510617724619806
The modified gen p mean: 0.4467184245586395, gen p mean: -0.1246592104434967, mean p set: 0.4472929835319519The modified gen p mean: 0.44712895154953003, gen p mean: -0.12514206767082214, mean p set: 0.44770586490631104
loss_pred:0.016383539885282516, decouple_loss:0.0006311078905127943
loss_pred:0.017247365787625313, decouple_loss:0.0006758354720659554
Iteration: 653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44586122035980225, gen p mean: -0.12328597903251648, mean p set: 0.4464380145072937
loss_pred:0.01584618166089058, decouple_loss:0.0006563236238434911
The modified gen p mean: 0.4465021789073944, gen p mean: -0.11950092762708664, mean p set: 0.4470764696598053
loss_pred:0.016951831057667732, decouple_loss:0.0006068329093977809
The modified gen p mean: 0.44559046626091003, gen p mean: -0.12167137116193771, mean p set: 0.4461663067340851
loss_pred:0.017448991537094116, decouple_loss:0.0006937074358575046
Iteration: 654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459059536457062, gen p mean: -0.12377925962209702, mean p set: 0.44648122787475586
loss_pred:0.016526484861969948, decouple_loss:0.0007236988167278469
The modified gen p mean: 0.44801977276802063, gen p mean: -0.12242169678211212, mean p set: 0.44859790802001953
loss_pred:0.015548079274594784, decouple_loss:0.0007502230582758784
The modified gen p mean: 0.44578877091407776, gen p mean: -0.12594975531101227, mean p set: 0.44636544585227966
loss_pred:0.01701805554330349, decouple_loss:0.0005226582870818675
Iteration: 655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448147177696228, gen p mean: -0.131754532456398, mean p set: 0.44872260093688965
loss_pred:0.015840468928217888, decouple_loss:0.0006796689704060555
The modified gen p mean: 0.44689008593559265, gen p mean: -0.12874814867973328, mean p set: 0.4474653899669647
loss_pred:0.016711920499801636, decouple_loss:0.0006854650564491749
The modified gen p mean: 0.44564029574394226, gen p mean: -0.12913505733013153, mean p set: 0.44621503353118896
loss_pred:0.016185801476240158, decouple_loss:0.0006527866935357451
Iteration: 656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467100501060486, gen p mean: -0.13529495894908905, mean p set: 0.44728702306747437
loss_pred:0.017648926004767418, decouple_loss:0.0007875626324675977
The modified gen p mean: 0.4465821385383606, gen p mean: -0.12742233276367188, mean p set: 0.44716089963912964
loss_pred:0.016523364931344986, decouple_loss:0.0006239990470930934
The modified gen p mean: 0.4456949234008789, gen p mean: -0.1264192909002304, mean p set: 0.44626984000205994
loss_pred:0.01662365347146988, decouple_loss:0.0009172807331196964
Iteration: 657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44627249240875244, gen p mean: -0.13273704051971436, mean p set: 0.4468507766723633
loss_pred:0.016730986535549164, decouple_loss:0.0006592869758605957
The modified gen p mean: 0.44741517305374146, gen p mean: -0.1302061676979065, mean p set: 0.4479944705963135
The modified gen p mean: 0.4474605321884155, gen p mean: -0.1326485276222229, mean p set: 0.4480360448360443
loss_pred:0.016402259469032288, decouple_loss:0.0006602118373848498
loss_pred:0.01590413972735405, decouple_loss:0.000704670324921608
Iteration: 658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457244277000427, gen p mean: -0.12971751391887665, mean p set: 0.4462999701499939
loss_pred:0.01799820177257061, decouple_loss:0.0007352161919698119
The modified gen p mean: 0.44753342866897583, gen p mean: -0.1324630230665207, mean p set: 0.44810721278190613
loss_pred:0.01584232784807682, decouple_loss:0.0007113934843800962
The modified gen p mean: 0.44553685188293457, gen p mean: -0.12994134426116943, mean p set: 0.44611287117004395
loss_pred:0.016831452026963234, decouple_loss:0.0006620527128688991
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012016_3_24hr.npz
NaN value num: 0
Iteration: 659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44639769196510315, gen p mean: -0.1228238046169281, mean p set: 0.4469749927520752
The modified gen p mean: 0.44607067108154297, gen p mean: -0.12457803636789322, mean p set: 0.4466463625431061
loss_pred:0.017476897686719894, decouple_loss:0.0006908769137226045
loss_pred:0.0179152674973011, decouple_loss:0.0006987046217545867
The modified gen p mean: 0.4474952220916748, gen p mean: -0.12808050215244293, mean p set: 0.4480704367160797
loss_pred:0.017010841518640518, decouple_loss:0.0006193559383973479
Iteration: 660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469635784626007, gen p mean: -0.12252301722764969, mean p set: 0.4475422501564026
loss_pred:0.017089443281292915, decouple_loss:0.0006820468115620315
The modified gen p mean: 0.44644981622695923, gen p mean: -0.12547340989112854, mean p set: 0.447025865316391
loss_pred:0.016714030876755714, decouple_loss:0.0007610255852341652
The modified gen p mean: 0.4472755193710327, gen p mean: -0.12689383327960968, mean p set: 0.4478538930416107
loss_pred:0.016932984814047813, decouple_loss:0.000606947869528085
2023-05-01 17:56:44 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12785059213638306, mean p set: 0.4502691626548767
loss_pred:0.01717882789671421, decouple_loss:0.0006789001054130495
The modified gen p mean: 0.44953402876853943, gen p mean: -0.1224876418709755, mean p set: 0.4500633478164673
loss_pred:0.0164866354316473, decouple_loss:0.0007082429947331548
The modified gen p mean: 0.44977858662605286, gen p mean: -0.12199442088603973, mean p set: 0.45035696029663086
loss_pred:0.016822827979922295, decouple_loss:0.0006473254179582
WV_1_PC_1_EH_0_PS_40, loss: 0.01686333864927292, avg_mse: 0.026226721704006195
current test mse: 0.026227
Iteration: 661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761645793914795, gen p mean: -0.1204463541507721, mean p set: 0.44819167256355286
loss_pred:0.017128577455878258, decouple_loss:0.0005795928300358355
The modified gen p mean: 0.44714248180389404, gen p mean: -0.12592729926109314, mean p set: 0.4477194845676422The modified gen p mean: 0.4474915564060211, gen p mean: -0.12081330269575119, mean p set: 0.4480665326118469
loss_pred:0.017022131010890007, decouple_loss:0.0006175750750117004
loss_pred:0.016420893371105194, decouple_loss:0.0005364395910874009
Iteration: 662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44722113013267517, gen p mean: -0.12134365737438202, mean p set: 0.44779476523399353
loss_pred:0.016017485409975052, decouple_loss:0.0005830141017213464
The modified gen p mean: 0.4473385810852051, gen p mean: -0.12131539732217789, mean p set: 0.44791483879089355The modified gen p mean: 0.44756945967674255, gen p mean: -0.11912744492292404, mean p set: 0.4481455683708191
loss_pred:0.01753648743033409, decouple_loss:0.0005669646197929978
loss_pred:0.01720575802028179, decouple_loss:0.0005322119686752558
Iteration: 663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482169449329376, gen p mean: -0.11237961798906326, mean p set: 0.44879260659217834
loss_pred:0.016969939693808556, decouple_loss:0.0006025747279636562
The modified gen p mean: 0.44707292318344116, gen p mean: -0.12200706452131271, mean p set: 0.44764822721481323
loss_pred:0.01738067902624607, decouple_loss:0.0006506964564323425
The modified gen p mean: 0.44804468750953674, gen p mean: -0.12078382074832916, mean p set: 0.44862115383148193
loss_pred:0.017463041469454765, decouple_loss:0.0005871616885997355
Iteration: 664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469831585884094, gen p mean: -0.12379534542560577, mean p set: 0.4475629925727844
loss_pred:0.0170673206448555, decouple_loss:0.0007220590487122536
The modified gen p mean: 0.4470837712287903, gen p mean: -0.12320186197757721, mean p set: 0.4476608335971832
loss_pred:0.015966832637786865, decouple_loss:0.0005797534249722958
The modified gen p mean: 0.4470270276069641, gen p mean: -0.12577664852142334, mean p set: 0.44760507345199585
loss_pred:0.016111325472593307, decouple_loss:0.0005529557820409536
Iteration: 665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44640403985977173, gen p mean: -0.1272817701101303, mean p set: 0.44697946310043335
loss_pred:0.017660854384303093, decouple_loss:0.0005359690985642374
The modified gen p mean: 0.4487866163253784, gen p mean: -0.12000136077404022, mean p set: 0.4493623375892639
loss_pred:0.017034931108355522, decouple_loss:0.0005905958823859692
The modified gen p mean: 0.448639452457428, gen p mean: -0.12549881637096405, mean p set: 0.4492153227329254
loss_pred:0.017552336677908897, decouple_loss:0.000656057265587151
Iteration: 666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446914941072464, gen p mean: -0.12672953307628632, mean p set: 0.4474906623363495
loss_pred:0.016012612730264664, decouple_loss:0.0007692380459047854
The modified gen p mean: 0.44734811782836914, gen p mean: -0.12444786727428436, mean p set: 0.4479246735572815
loss_pred:0.01711888238787651, decouple_loss:0.0007195856887847185
The modified gen p mean: 0.44838473200798035, gen p mean: -0.12428400665521622, mean p set: 0.448962926864624
loss_pred:0.017465991899371147, decouple_loss:0.0007383300107903779
Iteration: 667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800183176994324, gen p mean: -0.12518388032913208, mean p set: 0.44857820868492126
loss_pred:0.017006412148475647, decouple_loss:0.0007126186974346638
The modified gen p mean: 0.4482845067977905, gen p mean: -0.1282111406326294, mean p set: 0.4488610029220581
loss_pred:0.017918305471539497, decouple_loss:0.0006408125627785921
The modified gen p mean: 0.4455467760562897, gen p mean: -0.12339236587285995, mean p set: 0.44612136483192444
loss_pred:0.01799679361283779, decouple_loss:0.0007390009704977274
Iteration: 668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482395350933075, gen p mean: -0.12633301317691803, mean p set: 0.44881540536880493
loss_pred:0.017239805310964584, decouple_loss:0.0005468180170282722
The modified gen p mean: 0.44688791036605835, gen p mean: -0.1245189905166626, mean p set: 0.4474611282348633
loss_pred:0.01624053716659546, decouple_loss:0.000724960002116859
The modified gen p mean: 0.4482174515724182, gen p mean: -0.12129473686218262, mean p set: 0.448795348405838
loss_pred:0.016503073275089264, decouple_loss:0.0006098240846768022
Iteration: 669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686827063560486, gen p mean: -0.12941883504390717, mean p set: 0.44744452834129333
loss_pred:0.016905540600419044, decouple_loss:0.0006146228988654912
The modified gen p mean: 0.44750818610191345, gen p mean: -0.12698638439178467, mean p set: 0.44808605313301086
loss_pred:0.01711050048470497, decouple_loss:0.0009402442956343293
The modified gen p mean: 0.44899240136146545, gen p mean: -0.12329211086034775, mean p set: 0.44956785440444946
loss_pred:0.017150240018963814, decouple_loss:0.0007061634096316993
Iteration: 670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473666250705719, gen p mean: -0.12825655937194824, mean p set: 0.4479401111602783
loss_pred:0.017181459814310074, decouple_loss:0.0008321851491928101
The modified gen p mean: 0.4465802311897278, gen p mean: -0.12997643649578094, mean p set: 0.4471576511859894
loss_pred:0.017057090997695923, decouple_loss:0.0004956854390911758
The modified gen p mean: 0.4469834566116333, gen p mean: -0.1289978325366974, mean p set: 0.4475582540035248
loss_pred:0.01788581721484661, decouple_loss:0.0006142397760413587
2023-05-01 17:58:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1308198720216751, mean p set: 0.4502691626548767
loss_pred:0.017134107649326324, decouple_loss:0.0006135297007858753
The modified gen p mean: 0.44953474402427673, gen p mean: -0.12540870904922485, mean p set: 0.4500633478164673
loss_pred:0.016473980620503426, decouple_loss:0.0009245036635547876
The modified gen p mean: 0.4497809410095215, gen p mean: -0.12503859400749207, mean p set: 0.45035696029663086
loss_pred:0.016777321696281433, decouple_loss:0.0008268968667834997
WV_1_PC_1_EH_0_PS_40, loss: 0.016834553331136703, avg_mse: 0.026176689192652702
current test mse: 0.026177
Iteration: 671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466012716293335, gen p mean: -0.12751133739948273, mean p set: 0.44717782735824585
loss_pred:0.01659327559173107, decouple_loss:0.000819919747300446
The modified gen p mean: 0.44698911905288696, gen p mean: -0.12595625221729279, mean p set: 0.44756677746772766
loss_pred:0.01725407876074314, decouple_loss:0.0010998386424034834
The modified gen p mean: 0.4460383951663971, gen p mean: -0.12485141307115555, mean p set: 0.44661614298820496
loss_pred:0.01779521442949772, decouple_loss:0.0007428255630657077
Iteration: 672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460931420326233, gen p mean: -0.12365172058343887, mean p set: 0.4466691315174103
loss_pred:0.01733420044183731, decouple_loss:0.0006555660511367023
The modified gen p mean: 0.44771263003349304, gen p mean: -0.11714433878660202, mean p set: 0.4482869803905487The modified gen p mean: 0.44713759422302246, gen p mean: -0.12516260147094727, mean p set: 0.44771403074264526
loss_pred:0.017042119055986404, decouple_loss:0.0007347321370616555loss_pred:0.0170904491096735, decouple_loss:0.0008272987906821072
Iteration: 673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44735944271087646, gen p mean: -0.1214534118771553, mean p set: 0.4479345977306366
loss_pred:0.01744317077100277, decouple_loss:0.0006516758585348725
The modified gen p mean: 0.4474581182003021, gen p mean: -0.12081652134656906, mean p set: 0.4480341970920563The modified gen p mean: 0.4471113085746765, gen p mean: -0.12539692223072052, mean p set: 0.4476872384548187
loss_pred:0.017713511362671852, decouple_loss:0.0007926513208076358loss_pred:0.01708335243165493, decouple_loss:0.0007899511256255209
Iteration: 674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641926884651184, gen p mean: -0.11989612132310867, mean p set: 0.4469953775405884
loss_pred:0.017694320529699326, decouple_loss:0.0006028612260706723
The modified gen p mean: 0.4479692578315735, gen p mean: -0.11865857988595963, mean p set: 0.44854697585105896
loss_pred:0.017112771049141884, decouple_loss:0.0009354805806651711
The modified gen p mean: 0.44547849893569946, gen p mean: -0.12098677456378937, mean p set: 0.4460543990135193
loss_pred:0.0173780620098114, decouple_loss:0.0006920347223058343
Iteration: 675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44676560163497925, gen p mean: -0.12315648049116135, mean p set: 0.4473411440849304
loss_pred:0.016635410487651825, decouple_loss:0.0006255286280065775
The modified gen p mean: 0.44666194915771484, gen p mean: -0.12402655929327011, mean p set: 0.4472349286079407
loss_pred:0.017118610441684723, decouple_loss:0.000713270390406251
The modified gen p mean: 0.4480542838573456, gen p mean: -0.11954714357852936, mean p set: 0.44863274693489075
loss_pred:0.016872800886631012, decouple_loss:0.0006232797168195248
Iteration: 676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480917751789093, gen p mean: -0.12028618901968002, mean p set: 0.44866740703582764
loss_pred:0.016649644821882248, decouple_loss:0.0007423940696753561
The modified gen p mean: 0.44919976592063904, gen p mean: -0.11853115260601044, mean p set: 0.44977301359176636
loss_pred:0.016961723566055298, decouple_loss:0.0007931658183224499
The modified gen p mean: 0.4473799765110016, gen p mean: -0.1205095499753952, mean p set: 0.4479564428329468
loss_pred:0.017167789861559868, decouple_loss:0.0007844679639674723
Iteration: 677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481969475746155, gen p mean: -0.11472237855195999, mean p set: 0.44877323508262634
loss_pred:0.016788087785243988, decouple_loss:0.000964861421380192
The modified gen p mean: 0.4473346173763275, gen p mean: -0.12326276302337646, mean p set: 0.4479101598262787
loss_pred:0.017601078376173973, decouple_loss:0.0006346957525238395
The modified gen p mean: 0.446614146232605, gen p mean: -0.12097685039043427, mean p set: 0.4471881687641144
loss_pred:0.017093878239393234, decouple_loss:0.0007543700048699975
Iteration: 678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457795023918152, gen p mean: -0.11919707804918289, mean p set: 0.44635701179504395
loss_pred:0.01721855066716671, decouple_loss:0.0007203027489595115
The modified gen p mean: 0.447178453207016, gen p mean: -0.12228158861398697, mean p set: 0.4477544128894806
loss_pred:0.017455115914344788, decouple_loss:0.000793586194049567
The modified gen p mean: 0.44828835129737854, gen p mean: -0.11148242652416229, mean p set: 0.44886404275894165
loss_pred:0.017279144376516342, decouple_loss:0.0006086594075895846
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012001_3_24hr.npz
NaN value num: 0
Iteration: 679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501597583293915, gen p mean: -0.11547917127609253, mean p set: 0.45073628425598145
loss_pred:0.01573372259736061, decouple_loss:0.0006848376942798495
The modified gen p mean: 0.4482435882091522, gen p mean: -0.11252107471227646, mean p set: 0.44882118701934814
The modified gen p mean: 0.4485006332397461, gen p mean: -0.11853236705064774, mean p set: 0.44907721877098083
loss_pred:0.01586015522480011, decouple_loss:0.0009454739047214389
loss_pred:0.015971258282661438, decouple_loss:0.0007994113839231431
Iteration: 680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45006099343299866, gen p mean: -0.10756257176399231, mean p set: 0.4506383240222931
loss_pred:0.01550380140542984, decouple_loss:0.0007645060541108251
The modified gen p mean: 0.44784045219421387, gen p mean: -0.11559973657131195, mean p set: 0.44841381907463074
loss_pred:0.015254193916916847, decouple_loss:0.0006421147263608873
The modified gen p mean: 0.4520494043827057, gen p mean: -0.11300325393676758, mean p set: 0.45262959599494934
loss_pred:0.014942350797355175, decouple_loss:0.0006758127128705382
2023-05-01 18:01:37 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11700661480426788, mean p set: 0.4502691626548767
loss_pred:0.017222290858626366, decouple_loss:0.000774424581322819
The modified gen p mean: 0.44953399896621704, gen p mean: -0.11165443807840347, mean p set: 0.4500633478164673
loss_pred:0.016540059819817543, decouple_loss:0.0009457113337703049
The modified gen p mean: 0.4497816860675812, gen p mean: -0.11105238646268845, mean p set: 0.45035696029663086
loss_pred:0.01688140258193016, decouple_loss:0.0007952678133733571
WV_1_PC_1_EH_0_PS_40, loss: 0.016923174262046814, avg_mse: 0.026355959475040436
current test mse: 0.026356
Iteration: 681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45084884762763977, gen p mean: -0.11121739447116852, mean p set: 0.4514223337173462
loss_pred:0.015767604112625122, decouple_loss:0.0006275685736909509
The modified gen p mean: 0.4475536048412323, gen p mean: -0.10748853534460068, mean p set: 0.44812753796577454
loss_pred:0.016326891258358955, decouple_loss:0.0006452362868003547
The modified gen p mean: 0.45161351561546326, gen p mean: -0.1122874841094017, mean p set: 0.4521893560886383
loss_pred:0.01596684753894806, decouple_loss:0.0006901455344632268
Iteration: 682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45112350583076477, gen p mean: -0.11047209799289703, mean p set: 0.4517004191875458
loss_pred:0.015392805449664593, decouple_loss:0.0009040793520398438
The modified gen p mean: 0.4510010778903961, gen p mean: -0.11265593767166138, mean p set: 0.4515781104564667The modified gen p mean: 0.45010387897491455, gen p mean: -0.10647791624069214, mean p set: 0.4506807327270508
loss_pred:0.015932027250528336, decouple_loss:0.0007625075522810221loss_pred:0.015320305712521076, decouple_loss:0.000952401664108038
Iteration: 683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496857821941376, gen p mean: -0.11413411796092987, mean p set: 0.4502636790275574
loss_pred:0.015183484181761742, decouple_loss:0.0006732384208589792
The modified gen p mean: 0.45076432824134827, gen p mean: -0.11748629808425903, mean p set: 0.4513396918773651
loss_pred:0.01511693187057972, decouple_loss:0.0005450116004794836
The modified gen p mean: 0.45177528262138367, gen p mean: -0.11858074367046356, mean p set: 0.45235374569892883
loss_pred:0.014754973351955414, decouple_loss:0.0007125866832211614
Iteration: 684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44890880584716797, gen p mean: -0.11467190831899643, mean p set: 0.4494839310646057
loss_pred:0.015395868569612503, decouple_loss:0.0007234322256408632
The modified gen p mean: 0.4493947923183441, gen p mean: -0.11478874832391739, mean p set: 0.449969619512558
loss_pred:0.01612134464085102, decouple_loss:0.0008299440960399806
The modified gen p mean: 0.4515444040298462, gen p mean: -0.12030266225337982, mean p set: 0.4521230459213257
loss_pred:0.015395741909742355, decouple_loss:0.0011440740199759603
Iteration: 685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520086348056793, gen p mean: -0.12513042986392975, mean p set: 0.45258763432502747
loss_pred:0.01618257723748684, decouple_loss:0.0007600236567668617
The modified gen p mean: 0.45061877369880676, gen p mean: -0.12492231279611588, mean p set: 0.4511985182762146
loss_pred:0.015542655251920223, decouple_loss:0.0007836928707547486
The modified gen p mean: 0.45148107409477234, gen p mean: -0.1180756688117981, mean p set: 0.45205825567245483
loss_pred:0.015985431149601936, decouple_loss:0.0008642345201224089
Iteration: 686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481872320175171, gen p mean: -0.11448086053133011, mean p set: 0.4487653374671936
loss_pred:0.015675287693738937, decouple_loss:0.0007106804405339062
The modified gen p mean: 0.447907030582428, gen p mean: -0.11980194598436356, mean p set: 0.44848257303237915
The modified gen p mean: 0.4489959478378296, gen p mean: -0.11780885607004166, mean p set: 0.44957149028778076
loss_pred:0.015317565761506557, decouple_loss:0.0007638970855623484
loss_pred:0.016185864806175232, decouple_loss:0.0008513153879903257
Iteration: 687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44858667254447937, gen p mean: -0.11950014531612396, mean p set: 0.4491605758666992
loss_pred:0.015441511757671833, decouple_loss:0.0008332572760991752
The modified gen p mean: 0.4482923150062561, gen p mean: -0.12225684523582458, mean p set: 0.44887110590934753
The modified gen p mean: 0.4484330713748932, gen p mean: -0.11610708385705948, mean p set: 0.44900739192962646
loss_pred:0.016233760863542557, decouple_loss:0.000769161619246006
loss_pred:0.01597805880010128, decouple_loss:0.0010561003582552075
Iteration: 688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477045238018036, gen p mean: -0.12060146778821945, mean p set: 0.4482796788215637
loss_pred:0.015308238565921783, decouple_loss:0.000619434576947242
The modified gen p mean: 0.4519236087799072, gen p mean: -0.1267099529504776, mean p set: 0.45250096917152405
loss_pred:0.015856564044952393, decouple_loss:0.0008360681240446866
The modified gen p mean: 0.45098331570625305, gen p mean: -0.12090950459241867, mean p set: 0.45155924558639526
loss_pred:0.01550542563199997, decouple_loss:0.0006572427810169756
Iteration: 689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500204622745514, gen p mean: -0.11596563458442688, mean p set: 0.45059797167778015
loss_pred:0.015580188482999802, decouple_loss:0.000971276022028178
The modified gen p mean: 0.45080506801605225, gen p mean: -0.12510152161121368, mean p set: 0.45137983560562134
The modified gen p mean: 0.44912588596343994, gen p mean: -0.12205430120229721, mean p set: 0.4497029781341553
loss_pred:0.01554089318960905, decouple_loss:0.0008903004927560687
loss_pred:0.015209048986434937, decouple_loss:0.001088607357814908
Iteration: 690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943472743034363, gen p mean: -0.11772245913743973, mean p set: 0.45001283288002014
loss_pred:0.015192795544862747, decouple_loss:0.0010739839635789394
The modified gen p mean: 0.4506269097328186, gen p mean: -0.12127402424812317, mean p set: 0.4512050449848175
The modified gen p mean: 0.4503622055053711, gen p mean: -0.11452513188123703, mean p set: 0.45093685388565063
loss_pred:0.015490325167775154, decouple_loss:0.0006761619006283581
loss_pred:0.015930116176605225, decouple_loss:0.0009855034295469522
2023-05-01 18:03:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12243810296058655, mean p set: 0.4502691626548767
loss_pred:0.017279425635933876, decouple_loss:0.0007555319461971521
The modified gen p mean: 0.4495360553264618, gen p mean: -0.11659754067659378, mean p set: 0.4500633478164673
loss_pred:0.016645969823002815, decouple_loss:0.0008214872214011848
The modified gen p mean: 0.4497789144515991, gen p mean: -0.11588342487812042, mean p set: 0.45035696029663086
loss_pred:0.016878493130207062, decouple_loss:0.000860976695548743
WV_1_PC_1_EH_0_PS_40, loss: 0.016975264996290207, avg_mse: 0.026405734941363335
current test mse: 0.026406
Iteration: 691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145276188850403, gen p mean: -0.11589454859495163, mean p set: 0.4520282447338104
loss_pred:0.01536473911255598, decouple_loss:0.0008501374395564198
The modified gen p mean: 0.4498668611049652, gen p mean: -0.11510874330997467, mean p set: 0.45044276118278503The modified gen p mean: 0.44826430082321167, gen p mean: -0.11185018718242645, mean p set: 0.44883993268013
loss_pred:0.015562590211629868, decouple_loss:0.0008732950664125383
loss_pred:0.015127677470445633, decouple_loss:0.0008758357726037502
Iteration: 692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496482014656067, gen p mean: -0.11113207787275314, mean p set: 0.4502235949039459
loss_pred:0.015608620829880238, decouple_loss:0.0010117068886756897
The modified gen p mean: 0.447986900806427, gen p mean: -0.1148364320397377, mean p set: 0.44856342673301697The modified gen p mean: 0.45059362053871155, gen p mean: -0.11779061704874039, mean p set: 0.4511696398258209
loss_pred:0.015000103041529655, decouple_loss:0.0009046339546330273
loss_pred:0.015870286151766777, decouple_loss:0.001357976347208023
Iteration: 693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502800405025482, gen p mean: -0.11132404208183289, mean p set: 0.45085906982421875
loss_pred:0.015485880896449089, decouple_loss:0.0009074065019376576
The modified gen p mean: 0.4505158066749573, gen p mean: -0.11147217452526093, mean p set: 0.4510902166366577
loss_pred:0.015092278830707073, decouple_loss:0.0010759878205135465
The modified gen p mean: 0.4487170875072479, gen p mean: -0.11173772811889648, mean p set: 0.44929447770118713
loss_pred:0.015428382903337479, decouple_loss:0.0008977364632301033
Iteration: 694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45130103826522827, gen p mean: -0.11104366928339005, mean p set: 0.45187318325042725
loss_pred:0.01536883320659399, decouple_loss:0.0007772012613713741
The modified gen p mean: 0.4496850371360779, gen p mean: -0.10679535567760468, mean p set: 0.45026326179504395
loss_pred:0.015707436949014664, decouple_loss:0.0006518528098240495
The modified gen p mean: 0.449957937002182, gen p mean: -0.10745096206665039, mean p set: 0.4505334198474884
loss_pred:0.015649575740098953, decouple_loss:0.0007633917848579586
Iteration: 695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503639042377472, gen p mean: -0.11040938645601273, mean p set: 0.4509415924549103
loss_pred:0.015339214354753494, decouple_loss:0.0006723493570461869
The modified gen p mean: 0.4510710537433624, gen p mean: -0.10723407566547394, mean p set: 0.4516487121582031
loss_pred:0.015526422299444675, decouple_loss:0.0006018988788127899
The modified gen p mean: 0.4510000944137573, gen p mean: -0.10716460645198822, mean p set: 0.45157620310783386
loss_pred:0.015551007352769375, decouple_loss:0.0005813764873892069
Iteration: 696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855621457099915, gen p mean: -0.10527297109365463, mean p set: 0.4491298198699951
loss_pred:0.015215711668133736, decouple_loss:0.0009211375727318227
The modified gen p mean: 0.4480029046535492, gen p mean: -0.1112951785326004, mean p set: 0.4485791027545929
loss_pred:0.015278821811079979, decouple_loss:0.0007973684696480632
The modified gen p mean: 0.4505043625831604, gen p mean: -0.10585836321115494, mean p set: 0.45108291506767273
loss_pred:0.015350104309618473, decouple_loss:0.0007006914238445461
Iteration: 697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513114094734192, gen p mean: -0.1109694316983223, mean p set: 0.45188701152801514
loss_pred:0.014633053913712502, decouple_loss:0.000595754652749747
The modified gen p mean: 0.45159000158309937, gen p mean: -0.11374712735414505, mean p set: 0.4521687626838684
loss_pred:0.015615250915288925, decouple_loss:0.0009123703930526972
The modified gen p mean: 0.44982418417930603, gen p mean: -0.10869117826223373, mean p set: 0.450398713350296
loss_pred:0.015402013435959816, decouple_loss:0.0006417774711735547
Iteration: 698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823476672172546, gen p mean: -0.11208214610815048, mean p set: 0.44880905747413635
loss_pred:0.015496333129703999, decouple_loss:0.0006101412582211196
The modified gen p mean: 0.4496949315071106, gen p mean: -0.10875963419675827, mean p set: 0.45027294754981995
loss_pred:0.01593107357621193, decouple_loss:0.0006734752096235752
The modified gen p mean: 0.44865331053733826, gen p mean: -0.11213669180870056, mean p set: 0.44922852516174316
loss_pred:0.01511766854673624, decouple_loss:0.0005767443799413741
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012005_3_24hr.npz
NaN value num: 0
Iteration: 699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506455063819885, gen p mean: -0.11049200594425201, mean p set: 0.4512208104133606The modified gen p mean: 0.45248883962631226, gen p mean: -0.10724733769893646, mean p set: 0.45306864380836487
loss_pred:0.01620759814977646, decouple_loss:0.0007041733479127288loss_pred:0.016818618401885033, decouple_loss:0.0006945987697690725
The modified gen p mean: 0.45133793354034424, gen p mean: -0.10498569905757904, mean p set: 0.4519164264202118
loss_pred:0.01611734926700592, decouple_loss:0.0006948087830096483
Iteration: 700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45046132802963257, gen p mean: -0.11648169904947281, mean p set: 0.4510363042354584
loss_pred:0.01572035253047943, decouple_loss:0.0008122929721139371
The modified gen p mean: 0.45149683952331543, gen p mean: -0.10635405778884888, mean p set: 0.4520728290081024
The modified gen p mean: 0.4523162543773651, gen p mean: -0.11089589446783066, mean p set: 0.45288947224617004
loss_pred:0.015482339076697826, decouple_loss:0.0007563797989860177
loss_pred:0.015712032094597816, decouple_loss:0.000811057339888066
2023-05-01 18:06:23 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11651713401079178, mean p set: 0.4502691626548767
loss_pred:0.017231665551662445, decouple_loss:0.0006487157079391181
The modified gen p mean: 0.4495350122451782, gen p mean: -0.11041434109210968, mean p set: 0.4500633478164673
loss_pred:0.016582656651735306, decouple_loss:0.0008549734484404325
The modified gen p mean: 0.4497815668582916, gen p mean: -0.10959970206022263, mean p set: 0.45035696029663086
loss_pred:0.016846494749188423, decouple_loss:0.0008319492335431278
WV_1_PC_1_EH_0_PS_40, loss: 0.016925867646932602, avg_mse: 0.026292653754353523
current test mse: 0.026293
Iteration: 701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504956603050232, gen p mean: -0.10168229788541794, mean p set: 0.451071560382843
loss_pred:0.015507914125919342, decouple_loss:0.0008191113593056798
The modified gen p mean: 0.45300787687301636, gen p mean: -0.10981550067663193, mean p set: 0.45358556509017944The modified gen p mean: 0.45194658637046814, gen p mean: -0.09803403168916702, mean p set: 0.45252126455307007
loss_pred:0.015415480360388756, decouple_loss:0.0007624666905030608loss_pred:0.01515977643430233, decouple_loss:0.0006727607687935233
Iteration: 702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502868354320526, gen p mean: -0.09320642054080963, mean p set: 0.45086169242858887
loss_pred:0.015963636338710785, decouple_loss:0.0011322873178869486
The modified gen p mean: 0.45218414068222046, gen p mean: -0.10014291107654572, mean p set: 0.45276156067848206The modified gen p mean: 0.4512120485305786, gen p mean: -0.09950223565101624, mean p set: 0.4517882466316223
loss_pred:0.015544628724455833, decouple_loss:0.000844372611027211
loss_pred:0.01628326065838337, decouple_loss:0.0009019669378176332
Iteration: 703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44936737418174744, gen p mean: -0.10316808521747589, mean p set: 0.4499439597129822
loss_pred:0.015158863738179207, decouple_loss:0.0005520045524463058
The modified gen p mean: 0.4518507719039917, gen p mean: -0.10336770117282867, mean p set: 0.45242658257484436
loss_pred:0.015855157747864723, decouple_loss:0.0008213662658818066
The modified gen p mean: 0.45164668560028076, gen p mean: -0.10497581958770752, mean p set: 0.45222437381744385
loss_pred:0.016131676733493805, decouple_loss:0.000677647243719548
Iteration: 704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45334476232528687, gen p mean: -0.10531934350728989, mean p set: 0.453921914100647
loss_pred:0.01647392474114895, decouple_loss:0.0008468656451441348
The modified gen p mean: 0.45015203952789307, gen p mean: -0.10693351924419403, mean p set: 0.4507260322570801
loss_pred:0.016045931726694107, decouple_loss:0.0006707078428007662
The modified gen p mean: 0.4529937505722046, gen p mean: -0.10302308201789856, mean p set: 0.4535713791847229
loss_pred:0.01589018478989601, decouple_loss:0.0007522974046878517
Iteration: 705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44930219650268555, gen p mean: -0.11141867190599442, mean p set: 0.4498787522315979
loss_pred:0.01482386700809002, decouple_loss:0.0006283441907726228
The modified gen p mean: 0.45047527551651, gen p mean: -0.09963777661323547, mean p set: 0.45105352997779846
loss_pred:0.01652412861585617, decouple_loss:0.0006807446479797363
The modified gen p mean: 0.4526352882385254, gen p mean: -0.10865834355354309, mean p set: 0.45321348309516907
loss_pred:0.015889713540673256, decouple_loss:0.0010180273093283176
Iteration: 706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45002222061157227, gen p mean: -0.10933716595172882, mean p set: 0.4505993127822876
loss_pred:0.015762127935886383, decouple_loss:0.0007874942966736853
The modified gen p mean: 0.4527996778488159, gen p mean: -0.10134192556142807, mean p set: 0.45338064432144165
loss_pred:0.016956347972154617, decouple_loss:0.0007011297275312245
The modified gen p mean: 0.45272591710090637, gen p mean: -0.10359299927949905, mean p set: 0.4533047676086426
loss_pred:0.016399847343564034, decouple_loss:0.0011033779010176659
Iteration: 707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048731565475464, gen p mean: -0.11187887191772461, mean p set: 0.4510650634765625
loss_pred:0.015224005095660686, decouple_loss:0.0006046299822628498
The modified gen p mean: 0.45394405722618103, gen p mean: -0.11164377629756927, mean p set: 0.45452532172203064
loss_pred:0.01570364087820053, decouple_loss:0.0007402024930343032
The modified gen p mean: 0.4503272473812103, gen p mean: -0.11158863455057144, mean p set: 0.4509033262729645
loss_pred:0.015200329013168812, decouple_loss:0.000662398524582386
Iteration: 708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4539479911327362, gen p mean: -0.11384869366884232, mean p set: 0.45452621579170227
loss_pred:0.014945666305720806, decouple_loss:0.0009216326870955527
The modified gen p mean: 0.4510788917541504, gen p mean: -0.10283815115690231, mean p set: 0.45165497064590454
The modified gen p mean: 0.4509340524673462, gen p mean: -0.11134752631187439, mean p set: 0.4515113830566406
loss_pred:0.016298534348607063, decouple_loss:0.0009925358463078737
loss_pred:0.015442311763763428, decouple_loss:0.0007334192050620914
Iteration: 709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45186877250671387, gen p mean: -0.11345832794904709, mean p set: 0.4524455666542053
loss_pred:0.015511421486735344, decouple_loss:0.0007577246287837625
The modified gen p mean: 0.4511395990848541, gen p mean: -0.10876788198947906, mean p set: 0.451716810464859
loss_pred:0.01563122123479843, decouple_loss:0.0008129924535751343
The modified gen p mean: 0.45263198018074036, gen p mean: -0.11093387007713318, mean p set: 0.4532093107700348
loss_pred:0.015964636579155922, decouple_loss:0.0007515987963415682
Iteration: 710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518921673297882, gen p mean: -0.1112758219242096, mean p set: 0.4524688422679901
loss_pred:0.015399991534650326, decouple_loss:0.0006678930367343128
The modified gen p mean: 0.44948622584342957, gen p mean: -0.10946353524923325, mean p set: 0.45006391406059265
loss_pred:0.01486785989254713, decouple_loss:0.0008054786594584584
The modified gen p mean: 0.4503289759159088, gen p mean: -0.11184342950582504, mean p set: 0.45090457797050476
loss_pred:0.01508095022290945, decouple_loss:0.0007582743419334292
2023-05-01 18:08:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11335530132055283, mean p set: 0.4502691626548767
loss_pred:0.01722610555589199, decouple_loss:0.0005917701055295765
The modified gen p mean: 0.4495360255241394, gen p mean: -0.10758408904075623, mean p set: 0.4500633478164673
loss_pred:0.016687726601958275, decouple_loss:0.0006440805736929178
The modified gen p mean: 0.44978079199790955, gen p mean: -0.10685405135154724, mean p set: 0.45035696029663086
loss_pred:0.016845718026161194, decouple_loss:0.0006333715282380581
WV_1_PC_1_EH_0_PS_40, loss: 0.016951004043221474, avg_mse: 0.02627861127257347
current test mse: 0.026279
Iteration: 711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524865448474884, gen p mean: -0.09693948924541473, mean p set: 0.453065425157547
loss_pred:0.016063490882515907, decouple_loss:0.0006952665280550718
The modified gen p mean: 0.4518422484397888, gen p mean: -0.10277109593153, mean p set: 0.4524182975292206The modified gen p mean: 0.45399999618530273, gen p mean: -0.10225259512662888, mean p set: 0.4545804262161255
loss_pred:0.015904273837804794, decouple_loss:0.0007716922555118799
loss_pred:0.016004178673028946, decouple_loss:0.0007733490783721209
Iteration: 712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4547690153121948, gen p mean: -0.10086551308631897, mean p set: 0.4553443193435669
loss_pred:0.01560225896537304, decouple_loss:0.0007521857623942196
The modified gen p mean: 0.4511075019836426, gen p mean: -0.09545187652111053, mean p set: 0.4516817331314087The modified gen p mean: 0.4502919018268585, gen p mean: -0.09645406901836395, mean p set: 0.45086991786956787
loss_pred:0.01599668711423874, decouple_loss:0.0007778569706715643
loss_pred:0.015366668812930584, decouple_loss:0.000688013678882271
Iteration: 713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449676513671875, gen p mean: -0.10049593448638916, mean p set: 0.45025137066841125
loss_pred:0.015260670334100723, decouple_loss:0.0007381484028883278
The modified gen p mean: 0.4498405158519745, gen p mean: -0.09683971852064133, mean p set: 0.4504178762435913
loss_pred:0.015426209196448326, decouple_loss:0.0006443244637921453
The modified gen p mean: 0.45030996203422546, gen p mean: -0.09690060466527939, mean p set: 0.45088624954223633
loss_pred:0.016342131420969963, decouple_loss:0.0008511397754773498
Iteration: 714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45224204659461975, gen p mean: -0.09502954035997391, mean p set: 0.4528190791606903
loss_pred:0.0153462253510952, decouple_loss:0.0006745046703144908
The modified gen p mean: 0.45373719930648804, gen p mean: -0.09860342741012573, mean p set: 0.45431381464004517
loss_pred:0.01596030220389366, decouple_loss:0.000900520128197968
The modified gen p mean: 0.45065873861312866, gen p mean: -0.10074017941951752, mean p set: 0.451235830783844
loss_pred:0.014408471062779427, decouple_loss:0.0005780903738923371
Iteration: 715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510723054409027, gen p mean: -0.09588983654975891, mean p set: 0.4516505002975464
loss_pred:0.015111596323549747, decouple_loss:0.00071842095348984
The modified gen p mean: 0.45151764154434204, gen p mean: -0.09566234052181244, mean p set: 0.45209503173828125
loss_pred:0.014953521080315113, decouple_loss:0.0008024150738492608
The modified gen p mean: 0.4517379701137543, gen p mean: -0.09575872868299484, mean p set: 0.45231500267982483
loss_pred:0.015049607492983341, decouple_loss:0.0006733760237693787
Iteration: 716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530203640460968, gen p mean: -0.10917780548334122, mean p set: 0.4535963535308838
The modified gen p mean: 0.4532473683357239, gen p mean: -0.09625286608934402, mean p set: 0.45382463932037354
loss_pred:0.014930966310203075, decouple_loss:0.000625557848252356
loss_pred:0.01624433323740959, decouple_loss:0.0006178449839353561
The modified gen p mean: 0.45207515358924866, gen p mean: -0.09746269136667252, mean p set: 0.45265111327171326
loss_pred:0.01602492481470108, decouple_loss:0.000780714675784111
Iteration: 717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449606329202652, gen p mean: -0.10921768099069595, mean p set: 0.45018270611763
loss_pred:0.014593803323805332, decouple_loss:0.000762874202337116
The modified gen p mean: 0.4531540274620056, gen p mean: -0.10144650191068649, mean p set: 0.4537295699119568
The modified gen p mean: 0.4522060751914978, gen p mean: -0.10336028784513474, mean p set: 0.4527818560600281
loss_pred:0.016014277935028076, decouple_loss:0.000872484059073031
loss_pred:0.015027858316898346, decouple_loss:0.001106435782276094
Iteration: 718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505079686641693, gen p mean: -0.100774385035038, mean p set: 0.45108428597450256
loss_pred:0.01581156998872757, decouple_loss:0.0006149390246719122
The modified gen p mean: 0.4519149363040924, gen p mean: -0.10571568459272385, mean p set: 0.45249199867248535
loss_pred:0.015940004959702492, decouple_loss:0.0006728218868374825
The modified gen p mean: 0.4517679214477539, gen p mean: -0.10524119436740875, mean p set: 0.4523443579673767
loss_pred:0.015812676399946213, decouple_loss:0.0007368915830738842
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012001_3_24hr.npz
NaN value num: 0
Iteration: 719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498191773891449, gen p mean: -0.11244320124387741, mean p set: 0.450398713350296
loss_pred:0.014899537898600101, decouple_loss:0.0008261112961918116
The modified gen p mean: 0.45051461458206177, gen p mean: -0.11143029481172562, mean p set: 0.4510902166366577
The modified gen p mean: 0.4510008692741394, gen p mean: -0.1117948442697525, mean p set: 0.4515781104564667
loss_pred:0.014476330019533634, decouple_loss:0.0009749298333190382
loss_pred:0.015360687859356403, decouple_loss:0.0006019060965627432
Iteration: 720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45112279057502747, gen p mean: -0.11398111283779144, mean p set: 0.4517004191875458
loss_pred:0.014547272585332394, decouple_loss:0.000541270652320236
The modified gen p mean: 0.4487158954143524, gen p mean: -0.11416912823915482, mean p set: 0.44929447770118713
loss_pred:0.015054748393595219, decouple_loss:0.0008109252084977925
The modified gen p mean: 0.45131009817123413, gen p mean: -0.1153150200843811, mean p set: 0.45188701152801514
loss_pred:0.014032860286533833, decouple_loss:0.0007213889621198177
2023-05-01 18:11:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1250799149274826, mean p set: 0.4502691626548767
loss_pred:0.017305878922343254, decouple_loss:0.0012383171124383807
The modified gen p mean: 0.4495353102684021, gen p mean: -0.11939279735088348, mean p set: 0.4500633478164673
loss_pred:0.016636887565255165, decouple_loss:0.0010201148688793182
The modified gen p mean: 0.44977983832359314, gen p mean: -0.11835237592458725, mean p set: 0.45035696029663086
loss_pred:0.016943946480751038, decouple_loss:0.0007492303848266602
WV_1_PC_1_EH_0_PS_40, loss: 0.01701236516237259, avg_mse: 0.02639421820640564
current test mse: 0.026394
Iteration: 721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45177727937698364, gen p mean: -0.12043005973100662, mean p set: 0.45235374569892883
loss_pred:0.014007008634507656, decouple_loss:0.0008015994681045413
The modified gen p mean: 0.4491247832775116, gen p mean: -0.12011975049972534, mean p set: 0.4497029781341553The modified gen p mean: 0.4506200850009918, gen p mean: -0.1222526952624321, mean p set: 0.4511985182762146
loss_pred:0.014604693278670311, decouple_loss:0.0007069152779877186
loss_pred:0.014939780347049236, decouple_loss:0.000879461586009711
Iteration: 722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448584645986557, gen p mean: -0.11983104795217514, mean p set: 0.4491605758666992
loss_pred:0.014620923437178135, decouple_loss:0.0009183716028928757
The modified gen p mean: 0.4501050114631653, gen p mean: -0.11575491726398468, mean p set: 0.4506807327270508The modified gen p mean: 0.45205339789390564, gen p mean: -0.12077983468770981, mean p set: 0.45262959599494934
loss_pred:0.014528325758874416, decouple_loss:0.0006231274455785751
loss_pred:0.013938194140791893, decouple_loss:0.0007571760797873139
Iteration: 723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44770538806915283, gen p mean: -0.1238265186548233, mean p set: 0.4482796788215637
loss_pred:0.014620411209762096, decouple_loss:0.000586830428801477
The modified gen p mean: 0.4506305456161499, gen p mean: -0.1253177374601364, mean p set: 0.4512050449848175
loss_pred:0.014510164968669415, decouple_loss:0.0007333328248932958
The modified gen p mean: 0.4505924582481384, gen p mean: -0.12758904695510864, mean p set: 0.4511696398258209
loss_pred:0.01504986360669136, decouple_loss:0.0010158646618947387
Iteration: 724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45002102851867676, gen p mean: -0.12138942629098892, mean p set: 0.45059797167778015
loss_pred:0.014782410115003586, decouple_loss:0.0008986604516394436
The modified gen p mean: 0.4485545754432678, gen p mean: -0.1226881742477417, mean p set: 0.4491298198699951
loss_pred:0.014432770200073719, decouple_loss:0.0009331271867267787
The modified gen p mean: 0.44850239157676697, gen p mean: -0.12792806327342987, mean p set: 0.44907721877098083
loss_pred:0.014662635512650013, decouple_loss:0.001068608369678259
Iteration: 725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502834677696228, gen p mean: -0.12726154923439026, mean p set: 0.45085906982421875
loss_pred:0.014611613936722279, decouple_loss:0.0007635960355401039
The modified gen p mean: 0.44783756136894226, gen p mean: -0.13143768906593323, mean p set: 0.44841381907463074
loss_pred:0.014437775127589703, decouple_loss:0.0006667050183750689
The modified gen p mean: 0.44823387265205383, gen p mean: -0.1290370225906372, mean p set: 0.44880905747413635
loss_pred:0.014643099159002304, decouple_loss:0.0006857701810076833
Iteration: 726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45036110281944275, gen p mean: -0.1264965981245041, mean p set: 0.45093685388565063
loss_pred:0.014998792670667171, decouple_loss:0.0006661997176706791
The modified gen p mean: 0.44943711161613464, gen p mean: -0.13047823309898376, mean p set: 0.45001283288002014
loss_pred:0.014347330667078495, decouple_loss:0.0005383269744925201
The modified gen p mean: 0.45016053318977356, gen p mean: -0.13042603433132172, mean p set: 0.45073628425598145
loss_pred:0.014829847030341625, decouple_loss:0.0006023175083100796
Iteration: 727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129504799842834, gen p mean: -0.1314857453107834, mean p set: 0.45187318325042725
loss_pred:0.014741851016879082, decouple_loss:0.0010091993026435375
The modified gen p mean: 0.4508468806743622, gen p mean: -0.13136911392211914, mean p set: 0.4514223337173462
loss_pred:0.014790459536015987, decouple_loss:0.0009698490030132234
The modified gen p mean: 0.44818708300590515, gen p mean: -0.12560701370239258, mean p set: 0.4487653374671936
loss_pred:0.015210632234811783, decouple_loss:0.0008356852340511978
Iteration: 728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493916630744934, gen p mean: -0.1304529458284378, mean p set: 0.449969619512558
loss_pred:0.015045315027236938, decouple_loss:0.0007366518257185817
The modified gen p mean: 0.44995540380477905, gen p mean: -0.13031785190105438, mean p set: 0.4505334198474884
The modified gen p mean: 0.4514794945716858, gen p mean: -0.13055884838104248, mean p set: 0.45205825567245483
loss_pred:0.014510883018374443, decouple_loss:0.000884386885445565
loss_pred:0.0148008419200778, decouple_loss:0.0008228473016060889
Iteration: 729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201316475868225, gen p mean: -0.13708071410655975, mean p set: 0.45258763432502747
loss_pred:0.01494818739593029, decouple_loss:0.0010358791332691908
The modified gen p mean: 0.44964951276779175, gen p mean: -0.1301708221435547, mean p set: 0.4502235949039459
loss_pred:0.014681392349302769, decouple_loss:0.0009366776212118566
The modified gen p mean: 0.44798728823661804, gen p mean: -0.13492435216903687, mean p set: 0.44856342673301697
loss_pred:0.01400786079466343, decouple_loss:0.0008486711885780096
Iteration: 730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486527144908905, gen p mean: -0.13118386268615723, mean p set: 0.44922852516174316
loss_pred:0.014090139418840408, decouple_loss:0.0006831766804680228
The modified gen p mean: 0.44826722145080566, gen p mean: -0.12765364348888397, mean p set: 0.44883993268013
The modified gen p mean: 0.4505046010017395, gen p mean: -0.12742698192596436, mean p set: 0.45108291506767273
loss_pred:0.014033765532076359, decouple_loss:0.0007158568478189409
loss_pred:0.014417445287108421, decouple_loss:0.00111646787263453
2023-05-01 18:13:22 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.1343434751033783, mean p set: 0.4502691626548767
loss_pred:0.017494643107056618, decouple_loss:0.0008753843139857054
The modified gen p mean: 0.4495363235473633, gen p mean: -0.1284952163696289, mean p set: 0.4500633478164673
loss_pred:0.01682310365140438, decouple_loss:0.0007762473542243242
The modified gen p mean: 0.44977864623069763, gen p mean: -0.12788309156894684, mean p set: 0.45035696029663086
loss_pred:0.017014017328619957, decouple_loss:0.0006380656268447638
WV_1_PC_1_EH_0_PS_40, loss: 0.01714874990284443, avg_mse: 0.02670205570757389
current test mse: 0.026702
Iteration: 731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509976804256439, gen p mean: -0.12539030611515045, mean p set: 0.45157620310783386
The modified gen p mean: 0.44899800419807434, gen p mean: -0.12553063035011292, mean p set: 0.44957149028778076loss_pred:0.01457994431257248, decouple_loss:0.0009752797777764499
loss_pred:0.015060258097946644, decouple_loss:0.0006174369482323527
The modified gen p mean: 0.4496843218803406, gen p mean: -0.12496170401573181, mean p set: 0.45026326179504395
loss_pred:0.014514686539769173, decouple_loss:0.0006533021805807948
Iteration: 732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45107048749923706, gen p mean: -0.12253587692975998, mean p set: 0.4516487121582031
The modified gen p mean: 0.4509832262992859, gen p mean: -0.1244194507598877, mean p set: 0.45155924558639526
loss_pred:0.014522946439683437, decouple_loss:0.0005426416173577309
loss_pred:0.014448658563196659, decouple_loss:0.0005770221468992531
The modified gen p mean: 0.4496857523918152, gen p mean: -0.12425976246595383, mean p set: 0.4502636790275574
loss_pred:0.014175452291965485, decouple_loss:0.0007596818031743169
Iteration: 733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503657817840576, gen p mean: -0.12547855079174042, mean p set: 0.4509415924549103
loss_pred:0.014254727400839329, decouple_loss:0.000743658107239753
The modified gen p mean: 0.45080018043518066, gen p mean: -0.12857145071029663, mean p set: 0.45137983560562134
loss_pred:0.014405589550733566, decouple_loss:0.0008134691743180156
The modified gen p mean: 0.44824445247650146, gen p mean: -0.12025298923254013, mean p set: 0.44882118701934814
loss_pred:0.01476476714015007, decouple_loss:0.000893532473128289
Iteration: 734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479069113731384, gen p mean: -0.12328390032052994, mean p set: 0.44848257303237915
loss_pred:0.01424280647188425, decouple_loss:0.0008808390120975673
The modified gen p mean: 0.4519214630126953, gen p mean: -0.12890394032001495, mean p set: 0.45250096917152405
loss_pred:0.014920452609658241, decouple_loss:0.001046965830028057
The modified gen p mean: 0.44842979311943054, gen p mean: -0.11922570317983627, mean p set: 0.44900739192962646
loss_pred:0.014848573133349419, decouple_loss:0.0009286110289394855
Iteration: 735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969457387924194, gen p mean: -0.1215379536151886, mean p set: 0.45027294754981995
loss_pred:0.014876174740493298, decouple_loss:0.0007049383129924536
The modified gen p mean: 0.45161497592926025, gen p mean: -0.12500524520874023, mean p set: 0.4521893560886383
loss_pred:0.014584573917090893, decouple_loss:0.0006552152335643768
The modified gen p mean: 0.4480022192001343, gen p mean: -0.12563320994377136, mean p set: 0.4485791027545929
loss_pred:0.014190513640642166, decouple_loss:0.0006687315762974322
Iteration: 736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755280017852783, gen p mean: -0.1219971776008606, mean p set: 0.44812753796577454
loss_pred:0.01502053253352642, decouple_loss:0.0008650498930364847
The modified gen p mean: 0.4507622718811035, gen p mean: -0.12721692025661469, mean p set: 0.4513396918773651
loss_pred:0.01413696724921465, decouple_loss:0.0008935302612371743
The modified gen p mean: 0.45006075501441956, gen p mean: -0.1203133687376976, mean p set: 0.4506383240222931
loss_pred:0.014343193732202053, decouple_loss:0.0007116472697816789
Iteration: 737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829410314559937, gen p mean: -0.12660229206085205, mean p set: 0.44887110590934753
The modified gen p mean: 0.45159441232681274, gen p mean: -0.128765270113945, mean p set: 0.4521687626838684
loss_pred:0.015230017714202404, decouple_loss:0.0007688089972361922
loss_pred:0.014762075617909431, decouple_loss:0.000772254541516304
The modified gen p mean: 0.45154666900634766, gen p mean: -0.12770767509937286, mean p set: 0.4521230459213257
loss_pred:0.014236845076084137, decouple_loss:0.0009299962548539042
Iteration: 738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514489769935608, gen p mean: -0.1264665275812149, mean p set: 0.4520282447338104
loss_pred:0.01433576736599207, decouple_loss:0.0007413651910610497
The modified gen p mean: 0.4498644769191742, gen p mean: -0.12547415494918823, mean p set: 0.45044276118278503
loss_pred:0.014405216090381145, decouple_loss:0.000728737679310143
The modified gen p mean: 0.44890522956848145, gen p mean: -0.12412257492542267, mean p set: 0.4494839310646057
loss_pred:0.014243986457586288, decouple_loss:0.0006494830595329404
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012007_3_24hr.npz
NaN value num: 0
Iteration: 739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500880539417267, gen p mean: -0.11846091598272324, mean p set: 0.4506658911705017
loss_pred:0.015960615128278732, decouple_loss:0.0007640051771886647
The modified gen p mean: 0.4508615732192993, gen p mean: -0.12230107933282852, mean p set: 0.4514385461807251
The modified gen p mean: 0.44829651713371277, gen p mean: -0.11762906610965729, mean p set: 0.4488722085952759
loss_pred:0.016512181609869003, decouple_loss:0.0007166331051848829
loss_pred:0.01633642613887787, decouple_loss:0.0009991078404709697
Iteration: 740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483203887939453, gen p mean: -0.11310047656297684, mean p set: 0.44889989495277405
loss_pred:0.01598742976784706, decouple_loss:0.0011706380173563957
The modified gen p mean: 0.44941481947898865, gen p mean: -0.11492077261209488, mean p set: 0.44999101758003235
loss_pred:0.015887560322880745, decouple_loss:0.0009255700861103833
The modified gen p mean: 0.4480339288711548, gen p mean: -0.11269944161176682, mean p set: 0.44860953092575073
loss_pred:0.015700796619057655, decouple_loss:0.0009298278600908816
2023-05-01 18:16:05 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11985845118761063, mean p set: 0.4502691626548767
loss_pred:0.017221005633473396, decouple_loss:0.0012723329709842801
The modified gen p mean: 0.44953587651252747, gen p mean: -0.11396019905805588, mean p set: 0.4500633478164673
loss_pred:0.01660766266286373, decouple_loss:0.0010425250511616468
The modified gen p mean: 0.4497801959514618, gen p mean: -0.11346608400344849, mean p set: 0.45035696029663086
loss_pred:0.01685149222612381, decouple_loss:0.0008964902372099459
WV_1_PC_1_EH_0_PS_40, loss: 0.016946909949183464, avg_mse: 0.0263504795730114
current test mse: 0.02635
Iteration: 741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494172930717468, gen p mean: -0.10587681084871292, mean p set: 0.44999319314956665
loss_pred:0.016018720343708992, decouple_loss:0.0007563222898170352
The modified gen p mean: 0.4501401484012604, gen p mean: -0.10572118312120438, mean p set: 0.4507155418395996
loss_pred:0.015447746962308884, decouple_loss:0.0008519637049175799
The modified gen p mean: 0.45035937428474426, gen p mean: -0.10827973484992981, mean p set: 0.45093539357185364
loss_pred:0.01649533398449421, decouple_loss:0.000983526580967009
Iteration: 742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915756583213806, gen p mean: -0.10740441828966141, mean p set: 0.4497326612472534
loss_pred:0.016723088920116425, decouple_loss:0.0008172779344022274
The modified gen p mean: 0.4499075412750244, gen p mean: -0.10601046681404114, mean p set: 0.45048466324806213The modified gen p mean: 0.4486887753009796, gen p mean: -0.10439568758010864, mean p set: 0.4492644667625427
loss_pred:0.01501471921801567, decouple_loss:0.0009192909928970039
loss_pred:0.015210079960525036, decouple_loss:0.0007876643212512136
Iteration: 743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486568570137024, gen p mean: -0.10851484537124634, mean p set: 0.4492338001728058
loss_pred:0.01551570650190115, decouple_loss:0.0008195556001737714
The modified gen p mean: 0.45079582929611206, gen p mean: -0.1028859093785286, mean p set: 0.45137009024620056
loss_pred:0.014508013613522053, decouple_loss:0.0007455167942680418
The modified gen p mean: 0.4499608278274536, gen p mean: -0.1005294919013977, mean p set: 0.4505380690097809
loss_pred:0.015586051158607006, decouple_loss:0.0007440203335136175
Iteration: 744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472278654575348, gen p mean: -0.10099714994430542, mean p set: 0.44780394434928894
loss_pred:0.015416940674185753, decouple_loss:0.0007128521683625877
The modified gen p mean: 0.4503331184387207, gen p mean: -0.1031072661280632, mean p set: 0.4509085714817047
loss_pred:0.015384072437882423, decouple_loss:0.0009092850959859788
The modified gen p mean: 0.44847092032432556, gen p mean: -0.1036570817232132, mean p set: 0.44904738664627075
loss_pred:0.015862014144659042, decouple_loss:0.0009663011296652257
Iteration: 745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992464780807495, gen p mean: -0.1076560765504837, mean p set: 0.4505022168159485
loss_pred:0.015611080452799797, decouple_loss:0.0008850694866850972
The modified gen p mean: 0.4482693076133728, gen p mean: -0.10800696909427643, mean p set: 0.4488454759120941
loss_pred:0.015741363167762756, decouple_loss:0.0006860253633931279
The modified gen p mean: 0.45109397172927856, gen p mean: -0.10733798891305923, mean p set: 0.45167189836502075
loss_pred:0.015328089706599712, decouple_loss:0.0008275675936602056
Iteration: 746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502081274986267, gen p mean: -0.11283671110868454, mean p set: 0.45078325271606445
loss_pred:0.015111500397324562, decouple_loss:0.0006286283605732024
The modified gen p mean: 0.44989460706710815, gen p mean: -0.10814056545495987, mean p set: 0.4504702091217041
loss_pred:0.015745703130960464, decouple_loss:0.000623048865236342
The modified gen p mean: 0.44925886392593384, gen p mean: -0.10783098638057709, mean p set: 0.44983452558517456
loss_pred:0.015795405954122543, decouple_loss:0.0007364356424659491
Iteration: 747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028483867645264, gen p mean: -0.1108226329088211, mean p set: 0.45086273550987244
loss_pred:0.01562008261680603, decouple_loss:0.0006644538952969015
The modified gen p mean: 0.4491692781448364, gen p mean: -0.11157047748565674, mean p set: 0.4497472941875458
loss_pred:0.015623950399458408, decouple_loss:0.0009525992791168392
The modified gen p mean: 0.44864118099212646, gen p mean: -0.10812659561634064, mean p set: 0.44921573996543884
loss_pred:0.014582553878426552, decouple_loss:0.0006520113092847168
Iteration: 748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888484477996826, gen p mean: -0.1062222495675087, mean p set: 0.4494599997997284
loss_pred:0.015511611476540565, decouple_loss:0.0006051524542272091
The modified gen p mean: 0.4493940472602844, gen p mean: -0.10967686772346497, mean p set: 0.4499700367450714
loss_pred:0.015936747193336487, decouple_loss:0.0007773662218824029
The modified gen p mean: 0.4490024745464325, gen p mean: -0.11027827858924866, mean p set: 0.4495784640312195
loss_pred:0.016168469563126564, decouple_loss:0.0006483425386250019
Iteration: 749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450003057718277, gen p mean: -0.10771908611059189, mean p set: 0.4505808651447296
loss_pred:0.015448450110852718, decouple_loss:0.0008648218354210258
The modified gen p mean: 0.4503716230392456, gen p mean: -0.10826551914215088, mean p set: 0.4509481191635132
loss_pred:0.015550064854323864, decouple_loss:0.0007687050965614617
The modified gen p mean: 0.4482973515987396, gen p mean: -0.1108657717704773, mean p set: 0.44887450337409973
loss_pred:0.014818370342254639, decouple_loss:0.0006917603895999491
Iteration: 750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45006871223449707, gen p mean: -0.10788705945014954, mean p set: 0.45064541697502136
loss_pred:0.016202138736844063, decouple_loss:0.0009591595735400915
The modified gen p mean: 0.44851043820381165, gen p mean: -0.11143562197685242, mean p set: 0.4490853548049927
loss_pred:0.015538379549980164, decouple_loss:0.0009674063185229897
The modified gen p mean: 0.44824838638305664, gen p mean: -0.10808824747800827, mean p set: 0.4488237500190735
loss_pred:0.016002550721168518, decouple_loss:0.0006739855743944645
2023-05-01 18:18:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11904037743806839, mean p set: 0.4502691626548767
loss_pred:0.017418736591935158, decouple_loss:0.0007633319473825395
The modified gen p mean: 0.44978320598602295, gen p mean: -0.113148033618927, mean p set: 0.45035696029663086
loss_pred:0.016946768388152122, decouple_loss:0.0009740882669575512
The modified gen p mean: 0.44953620433807373, gen p mean: -0.11360615491867065, mean p set: 0.4500633478164673
loss_pred:0.016749639064073563, decouple_loss:0.0008288685930892825
WV_1_PC_1_EH_0_PS_40, loss: 0.017081154510378838, avg_mse: 0.026440763846039772
current test mse: 0.026441
Iteration: 751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489794373512268, gen p mean: -0.10609297454357147, mean p set: 0.44955530762672424
loss_pred:0.01564939320087433, decouple_loss:0.0011723011266440153
The modified gen p mean: 0.4480333924293518, gen p mean: -0.11164160817861557, mean p set: 0.44861045479774475
loss_pred:0.015899529680609703, decouple_loss:0.000774499261751771
The modified gen p mean: 0.4487890601158142, gen p mean: -0.11235333979129791, mean p set: 0.44936615228652954
loss_pred:0.015411476604640484, decouple_loss:0.0009151322883553803
Iteration: 752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481903910636902, gen p mean: -0.10865215212106705, mean p set: 0.44876495003700256
loss_pred:0.015143048018217087, decouple_loss:0.00070850586052984
The modified gen p mean: 0.449241042137146, gen p mean: -0.10904400795698166, mean p set: 0.4498175084590912The modified gen p mean: 0.45063844323158264, gen p mean: -0.10616558790206909, mean p set: 0.45121368765830994
loss_pred:0.015961775556206703, decouple_loss:0.0006039069266989827
loss_pred:0.01454766746610403, decouple_loss:0.0007239855476655066
Iteration: 753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841691851615906, gen p mean: -0.10289692878723145, mean p set: 0.44899222254753113
loss_pred:0.014258552342653275, decouple_loss:0.0005193465622141957
The modified gen p mean: 0.44873329997062683, gen p mean: -0.10500731319189072, mean p set: 0.4493105113506317
loss_pred:0.015892304480075836, decouple_loss:0.0006884667673148215
The modified gen p mean: 0.45040765404701233, gen p mean: -0.10341016948223114, mean p set: 0.45098215341567993
loss_pred:0.01589166559278965, decouple_loss:0.000687690160702914
Iteration: 754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44786685705184937, gen p mean: -0.10457845032215118, mean p set: 0.4484439492225647
loss_pred:0.01574440859258175, decouple_loss:0.0008426623535342515
The modified gen p mean: 0.44920969009399414, gen p mean: -0.10383584350347519, mean p set: 0.44978684186935425
loss_pred:0.015287867747247219, decouple_loss:0.0010519693605601788
The modified gen p mean: 0.4493604302406311, gen p mean: -0.09639245271682739, mean p set: 0.4499356150627136
loss_pred:0.015938760712742805, decouple_loss:0.0008264467469416559
Iteration: 755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44845253229141235, gen p mean: -0.10576073080301285, mean p set: 0.44903048872947693
loss_pred:0.016179518774151802, decouple_loss:0.0007944350363686681
The modified gen p mean: 0.447561651468277, gen p mean: -0.10397738218307495, mean p set: 0.4481392800807953
loss_pred:0.015471203252673149, decouple_loss:0.0007955078035593033
The modified gen p mean: 0.44856616854667664, gen p mean: -0.1010570079088211, mean p set: 0.4491414725780487
loss_pred:0.015914712101221085, decouple_loss:0.0006700843805447221
Iteration: 756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44964995980262756, gen p mean: -0.11074536293745041, mean p set: 0.450225830078125
loss_pred:0.01668700762093067, decouple_loss:0.0007527041016146541
The modified gen p mean: 0.4492720663547516, gen p mean: -0.10880323499441147, mean p set: 0.44984734058380127
loss_pred:0.015977073460817337, decouple_loss:0.000689875683747232
The modified gen p mean: 0.4490848481655121, gen p mean: -0.10840747505426407, mean p set: 0.4496622681617737
loss_pred:0.01511437352746725, decouple_loss:0.000701433455105871
Iteration: 757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45009902119636536, gen p mean: -0.10909142345190048, mean p set: 0.4506763517856598
loss_pred:0.015496304258704185, decouple_loss:0.000550459255464375
The modified gen p mean: 0.44996175169944763, gen p mean: -0.10801747441291809, mean p set: 0.4505395293235779
loss_pred:0.01654578186571598, decouple_loss:0.0009231427684426308
The modified gen p mean: 0.4493747651576996, gen p mean: -0.10475880652666092, mean p set: 0.44994959235191345
loss_pred:0.015385943464934826, decouple_loss:0.0005892558838240802
Iteration: 758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447696328163147, gen p mean: -0.09999098628759384, mean p set: 0.44827306270599365
loss_pred:0.015248531475663185, decouple_loss:0.000806036579888314
The modified gen p mean: 0.44864770770072937, gen p mean: -0.1035885363817215, mean p set: 0.4492228329181671
The modified gen p mean: 0.4497724771499634, gen p mean: -0.10499615222215652, mean p set: 0.45034751296043396
loss_pred:0.01560379471629858, decouple_loss:0.0006406573229469359
loss_pred:0.01586119458079338, decouple_loss:0.0006181370699778199
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012009_3_24hr.npz
NaN value num: 0
Iteration: 759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969499111175537, gen p mean: -0.10814866423606873, mean p set: 0.4502703547477722
loss_pred:0.01570182666182518, decouple_loss:0.000892586016561836
The modified gen p mean: 0.44938093423843384, gen p mean: -0.10383009165525436, mean p set: 0.4499533474445343
The modified gen p mean: 0.4489811658859253, gen p mean: -0.10843359678983688, mean p set: 0.4495595097541809
loss_pred:0.015451868064701557, decouple_loss:0.0005210819654166698
loss_pred:0.015695340931415558, decouple_loss:0.0006597278988920152
Iteration: 760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44866234064102173, gen p mean: -0.10246602445840836, mean p set: 0.4492368996143341
loss_pred:0.015280394814908504, decouple_loss:0.0006372242933139205
The modified gen p mean: 0.4465259909629822, gen p mean: -0.1150093749165535, mean p set: 0.44710251688957214
loss_pred:0.015282067470252514, decouple_loss:0.0006239445065148175
The modified gen p mean: 0.449179083108902, gen p mean: -0.10870500653982162, mean p set: 0.44975459575653076
loss_pred:0.015229631215333939, decouple_loss:0.0005727927200496197
2023-05-01 18:20:49 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12013398110866547, mean p set: 0.4502691626548767
loss_pred:0.017251860350370407, decouple_loss:0.0008221823372878134
The modified gen p mean: 0.4495350420475006, gen p mean: -0.11462928354740143, mean p set: 0.4500633478164673
loss_pred:0.01666114293038845, decouple_loss:0.0006110814865678549
The modified gen p mean: 0.44978067278862, gen p mean: -0.11405221372842789, mean p set: 0.45035696029663086
loss_pred:0.01695781946182251, decouple_loss:0.0006148162065073848
WV_1_PC_1_EH_0_PS_40, loss: 0.01699107699096203, avg_mse: 0.026442868635058403
current test mse: 0.026443
Iteration: 761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489249289035797, gen p mean: -0.11554203927516937, mean p set: 0.44949984550476074
loss_pred:0.015376393683254719, decouple_loss:0.0005855071940459311
The modified gen p mean: 0.44943082332611084, gen p mean: -0.11982820183038712, mean p set: 0.4500042200088501
loss_pred:0.01555867213755846, decouple_loss:0.0005790386931039393
The modified gen p mean: 0.44747915863990784, gen p mean: -0.11379245668649673, mean p set: 0.448056697845459
loss_pred:0.014624559320509434, decouple_loss:0.0005811366136185825
Iteration: 762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487709403038025, gen p mean: -0.12393250316381454, mean p set: 0.4493459463119507
The modified gen p mean: 0.44988518953323364, gen p mean: -0.11811255663633347, mean p set: 0.45046207308769226loss_pred:0.01584608480334282, decouple_loss:0.0006348613533191383
loss_pred:0.015000930987298489, decouple_loss:0.0005420428933575749
The modified gen p mean: 0.4477963149547577, gen p mean: -0.11576905101537704, mean p set: 0.44837456941604614
loss_pred:0.01522013545036316, decouple_loss:0.0005779985804110765
Iteration: 763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501086473464966, gen p mean: -0.12265237420797348, mean p set: 0.450682133436203
loss_pred:0.015154779888689518, decouple_loss:0.0005160022992640734
The modified gen p mean: 0.44801419973373413, gen p mean: -0.11564093083143234, mean p set: 0.4485895335674286
loss_pred:0.014606799930334091, decouple_loss:0.0005556318792514503
The modified gen p mean: 0.44972264766693115, gen p mean: -0.12086538970470428, mean p set: 0.45029905438423157
loss_pred:0.015423975884914398, decouple_loss:0.0006242442177608609
Iteration: 764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483674168586731, gen p mean: -0.1194644644856453, mean p set: 0.448943167924881
loss_pred:0.015063515864312649, decouple_loss:0.0006090675015002489
The modified gen p mean: 0.4480546712875366, gen p mean: -0.12044904381036758, mean p set: 0.448634535074234
loss_pred:0.014989454299211502, decouple_loss:0.0006255821790546179
The modified gen p mean: 0.44926297664642334, gen p mean: -0.128749817609787, mean p set: 0.44983842968940735
loss_pred:0.01579122431576252, decouple_loss:0.0006552240811288357
Iteration: 765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800126552581787, gen p mean: -0.11891118437051773, mean p set: 0.4485769271850586
loss_pred:0.014681125059723854, decouple_loss:0.0004968760185874999
The modified gen p mean: 0.4480143189430237, gen p mean: -0.11658371984958649, mean p set: 0.4485909342765808
loss_pred:0.015738945454359055, decouple_loss:0.00055829988559708
The modified gen p mean: 0.4488809406757355, gen p mean: -0.12169373035430908, mean p set: 0.44945788383483887
loss_pred:0.01474641915410757, decouple_loss:0.0005333407898433506
Iteration: 766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44840896129608154, gen p mean: -0.122091144323349, mean p set: 0.44898566603660583
The modified gen p mean: 0.4498075246810913, gen p mean: -0.11854438483715057, mean p set: 0.4503842294216156
loss_pred:0.014922244474291801, decouple_loss:0.0006540288450196385
loss_pred:0.015232528559863567, decouple_loss:0.0005849989829584956
The modified gen p mean: 0.4486536979675293, gen p mean: -0.12191708385944366, mean p set: 0.4492279887199402
loss_pred:0.014595352113246918, decouple_loss:0.0004727542691398412
Iteration: 767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480399787425995, gen p mean: -0.11258634924888611, mean p set: 0.44861605763435364
loss_pred:0.014903898350894451, decouple_loss:0.0004805809003300965
The modified gen p mean: 0.4484513998031616, gen p mean: -0.11683792620897293, mean p set: 0.44902855157852173
loss_pred:0.015409999527037144, decouple_loss:0.0005505278240889311
The modified gen p mean: 0.4496494233608246, gen p mean: -0.11361566931009293, mean p set: 0.45022737979888916
loss_pred:0.015389139764010906, decouple_loss:0.0005094113876111805
Iteration: 768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492627680301666, gen p mean: -0.11293824017047882, mean p set: 0.4498407244682312
loss_pred:0.015184287913143635, decouple_loss:0.0005956204840913415
The modified gen p mean: 0.4476332664489746, gen p mean: -0.11420603841543198, mean p set: 0.44820865988731384
loss_pred:0.015076762065291405, decouple_loss:0.0005559387500397861
The modified gen p mean: 0.44902437925338745, gen p mean: -0.11704251915216446, mean p set: 0.4495994448661804
loss_pred:0.01525881513953209, decouple_loss:0.0006085471832193434
Iteration: 769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493468701839447, gen p mean: -0.10777799785137177, mean p set: 0.4499235153198242
loss_pred:0.01539625134319067, decouple_loss:0.00044248768244870007
The modified gen p mean: 0.44777536392211914, gen p mean: -0.11221443861722946, mean p set: 0.4483490288257599
loss_pred:0.014766511507332325, decouple_loss:0.0005764191155321896
The modified gen p mean: 0.4491116404533386, gen p mean: -0.1153850331902504, mean p set: 0.449687123298645
loss_pred:0.015580505132675171, decouple_loss:0.0005917705711908638
Iteration: 770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503105878829956, gen p mean: -0.11238466948270798, mean p set: 0.4508882462978363
loss_pred:0.014755865558981895, decouple_loss:0.0006864668102934957
The modified gen p mean: 0.44901177287101746, gen p mean: -0.11569784581661224, mean p set: 0.44958946108818054
loss_pred:0.014901785179972649, decouple_loss:0.0005929739563725889
The modified gen p mean: 0.44843366742134094, gen p mean: -0.11384560167789459, mean p set: 0.44900989532470703
loss_pred:0.015021700412034988, decouple_loss:0.0005267327069304883
2023-05-01 18:22:55 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12330957502126694, mean p set: 0.4502691626548767
loss_pred:0.017240555956959724, decouple_loss:0.0005755749298259616
The modified gen p mean: 0.44953587651252747, gen p mean: -0.11811462789773941, mean p set: 0.4500633478164673
loss_pred:0.01651102863252163, decouple_loss:0.0006011340883560479
The modified gen p mean: 0.44977888464927673, gen p mean: -0.1175718903541565, mean p set: 0.45035696029663086
loss_pred:0.01689903996884823, decouple_loss:0.0006927590584382415
WV_1_PC_1_EH_0_PS_40, loss: 0.016914699226617813, avg_mse: 0.0263192281126976
current test mse: 0.026319
Iteration: 771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779255986213684, gen p mean: -0.11523972451686859, mean p set: 0.4483669102191925
loss_pred:0.014967706985771656, decouple_loss:0.0005784292006865144
The modified gen p mean: 0.4500535726547241, gen p mean: -0.11498396098613739, mean p set: 0.45063140988349915
loss_pred:0.014885927550494671, decouple_loss:0.0005865215207450092
The modified gen p mean: 0.44829002022743225, gen p mean: -0.12334351241588593, mean p set: 0.4488680362701416
loss_pred:0.014491172507405281, decouple_loss:0.0006550926482304931
Iteration: 772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906720519065857, gen p mean: -0.12000156939029694, mean p set: 0.44964301586151123
loss_pred:0.015331041999161243, decouple_loss:0.0007342072203755379
The modified gen p mean: 0.44928959012031555, gen p mean: -0.11739280819892883, mean p set: 0.4498685300350189The modified gen p mean: 0.44754621386528015, gen p mean: -0.12212595343589783, mean p set: 0.4481198489665985
loss_pred:0.015405899845063686, decouple_loss:0.0005810743314214051
loss_pred:0.014764024876058102, decouple_loss:0.0006771957851015031
Iteration: 773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490374028682709, gen p mean: -0.12396815419197083, mean p set: 0.4496126174926758
loss_pred:0.014404096640646458, decouple_loss:0.0006955508142709732
The modified gen p mean: 0.4485599994659424, gen p mean: -0.12494511902332306, mean p set: 0.449137419462204
loss_pred:0.015003440901637077, decouple_loss:0.000566632894333452
The modified gen p mean: 0.4487130045890808, gen p mean: -0.12414445728063583, mean p set: 0.449288934469223
loss_pred:0.015074078924953938, decouple_loss:0.0005286313826218247
Iteration: 774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487469494342804, gen p mean: -0.12346401065587997, mean p set: 0.44932347536087036
loss_pred:0.014534265734255314, decouple_loss:0.0006282258545979857
The modified gen p mean: 0.44873374700546265, gen p mean: -0.12745000422000885, mean p set: 0.44930922985076904
loss_pred:0.014672991819679737, decouple_loss:0.000577746715862304
The modified gen p mean: 0.4500578045845032, gen p mean: -0.12097413092851639, mean p set: 0.4506332576274872
loss_pred:0.014308384619653225, decouple_loss:0.0008631194359622896
Iteration: 775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44948655366897583, gen p mean: -0.1260318160057068, mean p set: 0.4500616788864136
loss_pred:0.014908199198544025, decouple_loss:0.0005248475936241448
The modified gen p mean: 0.4493052065372467, gen p mean: -0.12346624583005905, mean p set: 0.44987955689430237
loss_pred:0.014831147156655788, decouple_loss:0.0006855878164060414
The modified gen p mean: 0.44846394658088684, gen p mean: -0.12975022196769714, mean p set: 0.44904085993766785
loss_pred:0.014615043066442013, decouple_loss:0.0005911083426326513
Iteration: 776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471515119075775, gen p mean: -0.11971292644739151, mean p set: 0.4477255642414093
loss_pred:0.014426109381020069, decouple_loss:0.0005292303976602852
The modified gen p mean: 0.4463922679424286, gen p mean: -0.12557464838027954, mean p set: 0.4469698667526245
loss_pred:0.014618432149291039, decouple_loss:0.0006333174533210695
The modified gen p mean: 0.4483833312988281, gen p mean: -0.12604890763759613, mean p set: 0.44896194338798523
loss_pred:0.015297663398087025, decouple_loss:0.0008456591749563813
Iteration: 777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472908675670624, gen p mean: -0.12440343201160431, mean p set: 0.4478663504123688
loss_pred:0.014775567688047886, decouple_loss:0.0005396245396696031
The modified gen p mean: 0.4487856328487396, gen p mean: -0.12284161895513535, mean p set: 0.44936034083366394
loss_pred:0.014699782244861126, decouple_loss:0.0006550285615958273
The modified gen p mean: 0.4483044445514679, gen p mean: -0.11065966635942459, mean p set: 0.44888070225715637
loss_pred:0.014283452183008194, decouple_loss:0.0005620804731734097
Iteration: 778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486047327518463, gen p mean: -0.11678088456392288, mean p set: 0.44917967915534973
loss_pred:0.014779417775571346, decouple_loss:0.0006857179687358439
The modified gen p mean: 0.4478718936443329, gen p mean: -0.10983294248580933, mean p set: 0.44844722747802734
loss_pred:0.01513163186609745, decouple_loss:0.0006780627300031483
The modified gen p mean: 0.4476308226585388, gen p mean: -0.11810735613107681, mean p set: 0.44820713996887207
loss_pred:0.015303323976695538, decouple_loss:0.0006995194707997143
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012014_3_24hr.npz
NaN value num: 0
Iteration: 779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45315834879875183, gen p mean: -0.1012442335486412, mean p set: 0.4537356197834015
loss_pred:0.015980854630470276, decouple_loss:0.0008638587896712124
The modified gen p mean: 0.45048439502716064, gen p mean: -0.10615198314189911, mean p set: 0.4510606527328491
loss_pred:0.01620105654001236, decouple_loss:0.0007550196023657918
The modified gen p mean: 0.45007798075675964, gen p mean: -0.10824936628341675, mean p set: 0.4506555497646332
loss_pred:0.015275842510163784, decouple_loss:0.0006234740139916539
Iteration: 780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513327479362488, gen p mean: -0.10166497528553009, mean p set: 0.45191025733947754
loss_pred:0.015900732949376106, decouple_loss:0.0009914090624079108
The modified gen p mean: 0.45044660568237305, gen p mean: -0.10173322260379791, mean p set: 0.4510236978530884
loss_pred:0.015794407576322556, decouple_loss:0.0006603900110349059
The modified gen p mean: 0.45315563678741455, gen p mean: -0.10090163350105286, mean p set: 0.4537335932254791
loss_pred:0.016192615032196045, decouple_loss:0.0006009908393025398
2023-05-01 18:25:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10797029733657837, mean p set: 0.4502691626548767
loss_pred:0.017152089625597, decouple_loss:0.0007626601145602763
The modified gen p mean: 0.44953352212905884, gen p mean: -0.10270624607801437, mean p set: 0.4500633478164673
loss_pred:0.016445834189653397, decouple_loss:0.0007448207470588386
The modified gen p mean: 0.44978171586990356, gen p mean: -0.10232944041490555, mean p set: 0.45035696029663086
loss_pred:0.016783863306045532, decouple_loss:0.0007216387894004583
WV_1_PC_1_EH_0_PS_40, loss: 0.016831081360578537, avg_mse: 0.026111697778105736
current test mse: 0.026112
Iteration: 781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492557942867279, gen p mean: -0.09243980795145035, mean p set: 0.44983193278312683
loss_pred:0.01697392761707306, decouple_loss:0.0006545050418935716
The modified gen p mean: 0.44987350702285767, gen p mean: -0.09577462822198868, mean p set: 0.4504503011703491The modified gen p mean: 0.45067447423934937, gen p mean: -0.09084519743919373, mean p set: 0.4512505531311035
loss_pred:0.01594134047627449, decouple_loss:0.0006454057875089347
loss_pred:0.016578616574406624, decouple_loss:0.0005833528121002018
Iteration: 782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44905856251716614, gen p mean: -0.09647008031606674, mean p set: 0.44963446259498596
loss_pred:0.015935327857732773, decouple_loss:0.0007525815162807703
The modified gen p mean: 0.4491105377674103, gen p mean: -0.09729628264904022, mean p set: 0.44968703389167786The modified gen p mean: 0.45014750957489014, gen p mean: -0.09413442015647888, mean p set: 0.45072323083877563
loss_pred:0.015925196930766106, decouple_loss:0.00073335348861292
loss_pred:0.015615861862897873, decouple_loss:0.0007116106571629643
Iteration: 783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45252877473831177, gen p mean: -0.0968497097492218, mean p set: 0.4531055688858032
loss_pred:0.016325676813721657, decouple_loss:0.0005786957917734981
The modified gen p mean: 0.44986629486083984, gen p mean: -0.09232503175735474, mean p set: 0.450441837310791The modified gen p mean: 0.4495571255683899, gen p mean: -0.1017785519361496, mean p set: 0.4501340985298157
loss_pred:0.01564851775765419, decouple_loss:0.0005432912730611861
loss_pred:0.016268311068415642, decouple_loss:0.0008150404901243746
Iteration: 784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509873390197754, gen p mean: -0.10174093395471573, mean p set: 0.45156341791152954
loss_pred:0.015683623030781746, decouple_loss:0.0007019825861789286
The modified gen p mean: 0.4501030445098877, gen p mean: -0.10196150094270706, mean p set: 0.45068085193634033
loss_pred:0.015266883186995983, decouple_loss:0.0006452727247960865
The modified gen p mean: 0.4512884020805359, gen p mean: -0.10694967955350876, mean p set: 0.45186319947242737
loss_pred:0.016164615750312805, decouple_loss:0.0007043234654702246
Iteration: 785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512982666492462, gen p mean: -0.10256920009851456, mean p set: 0.45187634229660034
loss_pred:0.015754863619804382, decouple_loss:0.0005502512212842703
The modified gen p mean: 0.4499630630016327, gen p mean: -0.10366587340831757, mean p set: 0.45054012537002563
loss_pred:0.01604566164314747, decouple_loss:0.0009623361402191222
The modified gen p mean: 0.45254138112068176, gen p mean: -0.10027269273996353, mean p set: 0.45311927795410156
loss_pred:0.015766512602567673, decouple_loss:0.0006444370956160128
Iteration: 786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499828517436981, gen p mean: -0.10470828413963318, mean p set: 0.45055902004241943
loss_pred:0.015998737886548042, decouple_loss:0.0006666663684882224
The modified gen p mean: 0.45149725675582886, gen p mean: -0.10108354687690735, mean p set: 0.45207569003105164
loss_pred:0.015334340743720531, decouple_loss:0.0006715651252306998
The modified gen p mean: 0.4508100748062134, gen p mean: -0.09980994462966919, mean p set: 0.4513859152793884
loss_pred:0.016026364639401436, decouple_loss:0.000611887953709811
Iteration: 787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505923092365265, gen p mean: -0.10357409715652466, mean p set: 0.4511701166629791
loss_pred:0.016066119074821472, decouple_loss:0.0006297465297393501
The modified gen p mean: 0.452607661485672, gen p mean: -0.1009596437215805, mean p set: 0.45318400859832764
loss_pred:0.01681174710392952, decouple_loss:0.0005714588914997876
The modified gen p mean: 0.4516706168651581, gen p mean: -0.09921517968177795, mean p set: 0.4522497057914734
loss_pred:0.015875378623604774, decouple_loss:0.0005418505170382559
Iteration: 788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45182764530181885, gen p mean: -0.10654107481241226, mean p set: 0.4524039626121521
The modified gen p mean: 0.45197105407714844, gen p mean: -0.10821354389190674, mean p set: 0.4525485932826996
loss_pred:0.015697548165917397, decouple_loss:0.000786227232310921
loss_pred:0.01598910428583622, decouple_loss:0.0007670805789530277
The modified gen p mean: 0.4503204822540283, gen p mean: -0.10476425290107727, mean p set: 0.4508971571922302
loss_pred:0.016284720972180367, decouple_loss:0.0007555733318440616
Iteration: 789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499324560165405, gen p mean: -0.10011915862560272, mean p set: 0.4505070447921753
loss_pred:0.01652347296476364, decouple_loss:0.0005729505210183561
The modified gen p mean: 0.44930851459503174, gen p mean: -0.10553542524576187, mean p set: 0.4498852789402008
The modified gen p mean: 0.4495065212249756, gen p mean: -0.10581614077091217, mean p set: 0.45008277893066406
loss_pred:0.016786498948931694, decouple_loss:0.0005605671321973205
loss_pred:0.01618107222020626, decouple_loss:0.0005678670131601393
Iteration: 790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500974416732788, gen p mean: -0.10835999250411987, mean p set: 0.45067504048347473
The modified gen p mean: 0.44997698068618774, gen p mean: -0.11012089252471924, mean p set: 0.4505563974380493
loss_pred:0.015680551528930664, decouple_loss:0.0008997313561849296
loss_pred:0.01639549992978573, decouple_loss:0.0007100552902556956
The modified gen p mean: 0.44936075806617737, gen p mean: -0.10800671577453613, mean p set: 0.449937105178833
loss_pred:0.014915632084012032, decouple_loss:0.0007416144362650812
2023-05-01 18:27:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12202008068561554, mean p set: 0.4502691626548767
loss_pred:0.017283044755458832, decouple_loss:0.0006504214834421873
The modified gen p mean: 0.4495340883731842, gen p mean: -0.11658742278814316, mean p set: 0.4500633478164673
loss_pred:0.016561774536967278, decouple_loss:0.0006751619512215257
The modified gen p mean: 0.4497785270214081, gen p mean: -0.11640218645334244, mean p set: 0.45035696029663086
loss_pred:0.01679897867143154, decouple_loss:0.0006813342333771288
WV_1_PC_1_EH_0_PS_40, loss: 0.016914715990424156, avg_mse: 0.026272613555192947
current test mse: 0.026273
Iteration: 791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496931731700897, gen p mean: -0.10934628546237946, mean p set: 0.4502705931663513
loss_pred:0.01554762665182352, decouple_loss:0.0006086574285291135
The modified gen p mean: 0.45067599415779114, gen p mean: -0.11269742250442505, mean p set: 0.45125120878219604
loss_pred:0.015501738525927067, decouple_loss:0.0006404640735127032
The modified gen p mean: 0.4499059021472931, gen p mean: -0.11175709217786789, mean p set: 0.4504829943180084
loss_pred:0.014691134914755821, decouple_loss:0.0006027497001923621
Iteration: 792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512294828891754, gen p mean: -0.11425945907831192, mean p set: 0.4518035352230072
loss_pred:0.015637854114174843, decouple_loss:0.0005995818064548075
The modified gen p mean: 0.45034554600715637, gen p mean: -0.11255408823490143, mean p set: 0.4509201943874359The modified gen p mean: 0.45012643933296204, gen p mean: -0.10715071111917496, mean p set: 0.4507034122943878
loss_pred:0.01574249565601349, decouple_loss:0.0006021765875630081
loss_pred:0.015279337763786316, decouple_loss:0.0006634484743699431
Iteration: 793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513375163078308, gen p mean: -0.11146476864814758, mean p set: 0.4519140422344208
loss_pred:0.016174932941794395, decouple_loss:0.0006432042573578656
The modified gen p mean: 0.4517883360385895, gen p mean: -0.11333426833152771, mean p set: 0.4523652195930481
loss_pred:0.016664158552885056, decouple_loss:0.0006900893058627844
The modified gen p mean: 0.45034146308898926, gen p mean: -0.11221061646938324, mean p set: 0.4509181082248688
loss_pred:0.015451591461896896, decouple_loss:0.0007116168271750212
Iteration: 794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45035865902900696, gen p mean: -0.10801977664232254, mean p set: 0.450937420129776
loss_pred:0.01605745404958725, decouple_loss:0.0005671348189935088
The modified gen p mean: 0.4502733647823334, gen p mean: -0.1053890660405159, mean p set: 0.4508511424064636
loss_pred:0.015328160487115383, decouple_loss:0.0006886620540171862
The modified gen p mean: 0.4502146542072296, gen p mean: -0.10674893110990524, mean p set: 0.4507932960987091
loss_pred:0.015392203815281391, decouple_loss:0.0006103226915001869
Iteration: 795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524935781955719, gen p mean: -0.11152933537960052, mean p set: 0.4530709385871887
loss_pred:0.015638086944818497, decouple_loss:0.000664921011775732
The modified gen p mean: 0.4503374695777893, gen p mean: -0.10647763311862946, mean p set: 0.4509105384349823
loss_pred:0.015886971727013588, decouple_loss:0.0006912093376740813
The modified gen p mean: 0.44941890239715576, gen p mean: -0.10535264015197754, mean p set: 0.44999685883522034
loss_pred:0.015327238477766514, decouple_loss:0.0006002439768053591
Iteration: 796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505261778831482, gen p mean: -0.10443940758705139, mean p set: 0.45110225677490234
loss_pred:0.016072925180196762, decouple_loss:0.0006048064096830785
The modified gen p mean: 0.4491216242313385, gen p mean: -0.10481332242488861, mean p set: 0.4496982991695404
The modified gen p mean: 0.45204219222068787, gen p mean: -0.10804922878742218, mean p set: 0.45262065529823303
loss_pred:0.014927025884389877, decouple_loss:0.0009715362684801221
loss_pred:0.016363393515348434, decouple_loss:0.0007154887425713241
Iteration: 797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040231943130493, gen p mean: -0.10182390362024307, mean p set: 0.45097947120666504
The modified gen p mean: 0.45289328694343567, gen p mean: -0.10472013056278229, mean p set: 0.45347464084625244
loss_pred:0.016427025198936462, decouple_loss:0.0006170590640977025
loss_pred:0.01575666293501854, decouple_loss:0.000558332831133157
The modified gen p mean: 0.4528246223926544, gen p mean: -0.10265877842903137, mean p set: 0.45340150594711304
loss_pred:0.01549253799021244, decouple_loss:0.0010429879184812307
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012014_3_24hr.npz
NaN value num: 0
Iteration: 798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467202126979828, gen p mean: -0.11051405966281891, mean p set: 0.4472944438457489
loss_pred:0.01554094161838293, decouple_loss:0.0009076377609744668
The modified gen p mean: 0.44764041900634766, gen p mean: -0.10701149702072144, mean p set: 0.44821682572364807
The modified gen p mean: 0.4467427730560303, gen p mean: -0.10301956534385681, mean p set: 0.44731831550598145
loss_pred:0.015972567722201347, decouple_loss:0.0006551685510203242
loss_pred:0.01596345752477646, decouple_loss:0.0008175794500857592
Iteration: 799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447041392326355, gen p mean: -0.11352318525314331, mean p set: 0.44761648774147034
loss_pred:0.015178901143372059, decouple_loss:0.0007513051386922598
The modified gen p mean: 0.4486342668533325, gen p mean: -0.1049693375825882, mean p set: 0.4492107927799225
The modified gen p mean: 0.4484664797782898, gen p mean: -0.10996895283460617, mean p set: 0.44904205203056335
loss_pred:0.015920056030154228, decouple_loss:0.0006980830803513527
loss_pred:0.015496674925088882, decouple_loss:0.0011382454540580511
Iteration: 800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473547339439392, gen p mean: -0.11240057647228241, mean p set: 0.4479289650917053
loss_pred:0.015876665711402893, decouple_loss:0.0008156566182151437
The modified gen p mean: 0.4460272192955017, gen p mean: -0.10482510924339294, mean p set: 0.44660380482673645
loss_pred:0.015942582860589027, decouple_loss:0.0009558499441482127
The modified gen p mean: 0.44761550426483154, gen p mean: -0.11060290038585663, mean p set: 0.44819164276123047
loss_pred:0.015251399949193, decouple_loss:0.0006176337483339012
2023-05-01 18:30:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11480213701725006, mean p set: 0.4502691626548767
loss_pred:0.017200982198119164, decouple_loss:0.0007572422618977726
The modified gen p mean: 0.44953617453575134, gen p mean: -0.10877605527639389, mean p set: 0.4500633478164673
loss_pred:0.01650974340736866, decouple_loss:0.0008142373990267515
The modified gen p mean: 0.4497836232185364, gen p mean: -0.1084049865603447, mean p set: 0.45035696029663086
loss_pred:0.01681159809231758, decouple_loss:0.0007060927455313504
WV_1_PC_1_EH_0_PS_40, loss: 0.016878735274076462, avg_mse: 0.026287125423550606
current test mse: 0.026287
Iteration: 801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477759897708893, gen p mean: -0.10914261639118195, mean p set: 0.4483511745929718
loss_pred:0.015137131325900555, decouple_loss:0.0005925988079980016
The modified gen p mean: 0.44716763496398926, gen p mean: -0.1078963652253151, mean p set: 0.4477413594722748The modified gen p mean: 0.4468536674976349, gen p mean: -0.11339990049600601, mean p set: 0.44742754101753235
loss_pred:0.015716588124632835, decouple_loss:0.0006960650207474828
loss_pred:0.015039550140500069, decouple_loss:0.0008692413102835417
Iteration: 802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470340609550476, gen p mean: -0.10769710689783096, mean p set: 0.44760891795158386
loss_pred:0.015875518321990967, decouple_loss:0.0007974214968271554
The modified gen p mean: 0.4472888112068176, gen p mean: -0.11440110206604004, mean p set: 0.4478645324707031The modified gen p mean: 0.4476493299007416, gen p mean: -0.11755184829235077, mean p set: 0.4482249617576599
loss_pred:0.015211106278002262, decouple_loss:0.0008457893854938447loss_pred:0.015325144864618778, decouple_loss:0.0008075449150055647
Iteration: 803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44743314385414124, gen p mean: -0.12029078602790833, mean p set: 0.4480080008506775
loss_pred:0.01567493937909603, decouple_loss:0.0006714349729008973
The modified gen p mean: 0.4469704329967499, gen p mean: -0.11891382187604904, mean p set: 0.44754406809806824The modified gen p mean: 0.44751492142677307, gen p mean: -0.11804896593093872, mean p set: 0.4480917155742645
loss_pred:0.015313156880438328, decouple_loss:0.0007527495035901666loss_pred:0.015891583636403084, decouple_loss:0.0006241612136363983
Iteration: 804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482139050960541, gen p mean: -0.12172441929578781, mean p set: 0.44879069924354553
loss_pred:0.014837936498224735, decouple_loss:0.0006783594144508243
The modified gen p mean: 0.4481922388076782, gen p mean: -0.11968769878149033, mean p set: 0.4487678110599518
loss_pred:0.01535001676529646, decouple_loss:0.000797341694124043
The modified gen p mean: 0.4471692144870758, gen p mean: -0.12266328930854797, mean p set: 0.4477456510066986
loss_pred:0.01573352888226509, decouple_loss:0.0007413995917886496
Iteration: 805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475753605365753, gen p mean: -0.12173248827457428, mean p set: 0.44814959168434143
loss_pred:0.015108893625438213, decouple_loss:0.0005844963015988469
The modified gen p mean: 0.44648510217666626, gen p mean: -0.12298689782619476, mean p set: 0.44706112146377563
loss_pred:0.015635758638381958, decouple_loss:0.0006182555225677788
The modified gen p mean: 0.4473514258861542, gen p mean: -0.1247015967965126, mean p set: 0.44792893528938293
loss_pred:0.01575341261923313, decouple_loss:0.0005453731864690781
Iteration: 806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477423429489136, gen p mean: -0.1259116530418396, mean p set: 0.44831904768943787
loss_pred:0.01581750065088272, decouple_loss:0.000743915094062686
The modified gen p mean: 0.44607508182525635, gen p mean: -0.12433400750160217, mean p set: 0.44665300846099854
loss_pred:0.015463370829820633, decouple_loss:0.000732510699890554
The modified gen p mean: 0.4474464952945709, gen p mean: -0.1266603022813797, mean p set: 0.44802039861679077
loss_pred:0.015022269450128078, decouple_loss:0.0007963810348883271
Iteration: 807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477061331272125, gen p mean: -0.1321374922990799, mean p set: 0.44828295707702637
loss_pred:0.01580842398107052, decouple_loss:0.00074654386844486
The modified gen p mean: 0.4474932849407196, gen p mean: -0.12935498356819153, mean p set: 0.44806867837905884
loss_pred:0.015165068209171295, decouple_loss:0.0007958891219459474
The modified gen p mean: 0.44687506556510925, gen p mean: -0.12644551694393158, mean p set: 0.44745007157325745
loss_pred:0.014623898081481457, decouple_loss:0.0008292911224998534
Iteration: 808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881346821784973, gen p mean: -0.11956911534070969, mean p set: 0.4493890404701233
loss_pred:0.015045376494526863, decouple_loss:0.0005445560673251748
The modified gen p mean: 0.4474494159221649, gen p mean: -0.12275231629610062, mean p set: 0.4480248689651489
loss_pred:0.015004318207502365, decouple_loss:0.0006705043488182127
The modified gen p mean: 0.4476314187049866, gen p mean: -0.12017184495925903, mean p set: 0.4482089579105377
loss_pred:0.015519383363425732, decouple_loss:0.0007932177977636456
Iteration: 809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482020139694214, gen p mean: -0.11784038692712784, mean p set: 0.44877755641937256
loss_pred:0.015649739652872086, decouple_loss:0.0007773882243782282
The modified gen p mean: 0.44660013914108276, gen p mean: -0.12012342363595963, mean p set: 0.4471800923347473
The modified gen p mean: 0.44726476073265076, gen p mean: -0.11969360709190369, mean p set: 0.4478406012058258
loss_pred:0.015809981152415276, decouple_loss:0.0007831461844034493
loss_pred:0.01547605637460947, decouple_loss:0.0008321984205394983
Iteration: 810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447787880897522, gen p mean: -0.10928202420473099, mean p set: 0.4483618438243866
loss_pred:0.015234630554914474, decouple_loss:0.000575760961510241
The modified gen p mean: 0.4481698274612427, gen p mean: -0.11458861082792282, mean p set: 0.4487457573413849
loss_pred:0.015523561276495457, decouple_loss:0.0006178295589052141
The modified gen p mean: 0.4472767412662506, gen p mean: -0.11492684483528137, mean p set: 0.44785353541374207
loss_pred:0.015134155750274658, decouple_loss:0.0005123555311001837
2023-05-01 18:32:34 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12022944539785385, mean p set: 0.4502691626548767
loss_pred:0.017163891345262527, decouple_loss:0.0006574756116606295
The modified gen p mean: 0.4495336711406708, gen p mean: -0.11452993750572205, mean p set: 0.4500633478164673
loss_pred:0.016543060541152954, decouple_loss:0.0006981291808187962
The modified gen p mean: 0.449780136346817, gen p mean: -0.11389589309692383, mean p set: 0.45035696029663086
loss_pred:0.01679087057709694, decouple_loss:0.0007458252366632223
WV_1_PC_1_EH_0_PS_40, loss: 0.016867632046341896, avg_mse: 0.02616022154688835
current test mse: 0.02616
Iteration: 811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482446610927582, gen p mean: -0.11331750452518463, mean p set: 0.4488186836242676
loss_pred:0.015259668231010437, decouple_loss:0.0008918540552258492
The modified gen p mean: 0.44746601581573486, gen p mean: -0.1159176379442215, mean p set: 0.4480433166027069The modified gen p mean: 0.44875144958496094, gen p mean: -0.11614088714122772, mean p set: 0.4493274986743927
loss_pred:0.014316530898213387, decouple_loss:0.0007470196578651667
loss_pred:0.015425331890583038, decouple_loss:0.0007415408617816865
Iteration: 812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714289903640747, gen p mean: -0.11665593087673187, mean p set: 0.44771865010261536
loss_pred:0.014618096873164177, decouple_loss:0.00060517608653754
The modified gen p mean: 0.447562575340271, gen p mean: -0.1165333092212677, mean p set: 0.4481387734413147The modified gen p mean: 0.4472475051879883, gen p mean: -0.11515573412179947, mean p set: 0.4478244483470917
loss_pred:0.015321114100515842, decouple_loss:0.0006371433264575899
loss_pred:0.015190580859780312, decouple_loss:0.0006187912658788264
Iteration: 813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472447335720062, gen p mean: -0.11257965862751007, mean p set: 0.4478210508823395
loss_pred:0.015654144808650017, decouple_loss:0.0005438107182271779
The modified gen p mean: 0.44732943177223206, gen p mean: -0.11754317581653595, mean p set: 0.4479069411754608
loss_pred:0.01569613255560398, decouple_loss:0.0006228972342796624
The modified gen p mean: 0.4480680823326111, gen p mean: -0.10892891883850098, mean p set: 0.4486466944217682
loss_pred:0.015363378450274467, decouple_loss:0.0007262147264555097
Iteration: 814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479779303073883, gen p mean: -0.11877134442329407, mean p set: 0.44855615496635437
loss_pred:0.015183431096374989, decouple_loss:0.0007789475494064391
The modified gen p mean: 0.44788554310798645, gen p mean: -0.12008009105920792, mean p set: 0.44846081733703613
loss_pred:0.014905431307852268, decouple_loss:0.0009804223664104939
The modified gen p mean: 0.44766345620155334, gen p mean: -0.1175834909081459, mean p set: 0.4482399523258209
loss_pred:0.01561233215034008, decouple_loss:0.0007849752437323332
Iteration: 815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470365643501282, gen p mean: -0.1191292479634285, mean p set: 0.4476131498813629
loss_pred:0.014406969770789146, decouple_loss:0.0006885494804009795
The modified gen p mean: 0.4471263885498047, gen p mean: -0.11890997737646103, mean p set: 0.44770246744155884
loss_pred:0.015099056996405125, decouple_loss:0.000605325389187783
The modified gen p mean: 0.4489138126373291, gen p mean: -0.11591552942991257, mean p set: 0.4494889974594116
loss_pred:0.014479153789579868, decouple_loss:0.0004384657077025622
Iteration: 816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717174768447876, gen p mean: -0.11454689502716064, mean p set: 0.4477475583553314
loss_pred:0.014780878089368343, decouple_loss:0.0005215406999923289
The modified gen p mean: 0.44766318798065186, gen p mean: -0.11754671484231949, mean p set: 0.44823944568634033
loss_pred:0.015322786755859852, decouple_loss:0.0006239706999622285
The modified gen p mean: 0.447654664516449, gen p mean: -0.11904698610305786, mean p set: 0.4482308626174927
loss_pred:0.015232988633215427, decouple_loss:0.0005287570529617369
Iteration: 817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477086663246155, gen p mean: -0.11714857071638107, mean p set: 0.4482864737510681
loss_pred:0.015183727256953716, decouple_loss:0.0008273679413832724
The modified gen p mean: 0.44828319549560547, gen p mean: -0.11483275145292282, mean p set: 0.4488621652126312
loss_pred:0.015656955540180206, decouple_loss:0.0005669439560733736
The modified gen p mean: 0.4481259286403656, gen p mean: -0.1112854927778244, mean p set: 0.44870179891586304
loss_pred:0.015771599486470222, decouple_loss:0.0007794718840159476
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012012_3_24hr.npz
NaN value num: 0
Iteration: 818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010828971862793, gen p mean: -0.10685591399669647, mean p set: 0.45068490505218506
loss_pred:0.01621505618095398, decouple_loss:0.0008155643008649349
The modified gen p mean: 0.4515552818775177, gen p mean: -0.11031364649534225, mean p set: 0.45213228464126587
loss_pred:0.01591619662940502, decouple_loss:0.0009223352535627782
The modified gen p mean: 0.449321985244751, gen p mean: -0.10782157629728317, mean p set: 0.44989991188049316
loss_pred:0.01603800617158413, decouple_loss:0.0007832990377210081
Iteration: 819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449928343296051, gen p mean: -0.10721535980701447, mean p set: 0.4505055248737335
loss_pred:0.015641890466213226, decouple_loss:0.0005678679444827139
The modified gen p mean: 0.4502820670604706, gen p mean: -0.10647895187139511, mean p set: 0.45085835456848145
loss_pred:0.01617811992764473, decouple_loss:0.0006075802957639098
The modified gen p mean: 0.4497342109680176, gen p mean: -0.10256855934858322, mean p set: 0.4503108859062195
loss_pred:0.016370020806789398, decouple_loss:0.0005449099116958678
Iteration: 820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496467113494873, gen p mean: -0.10413877665996552, mean p set: 0.4502233564853668
loss_pred:0.015761811286211014, decouple_loss:0.0006386449094861746
The modified gen p mean: 0.45073556900024414, gen p mean: -0.10945390909910202, mean p set: 0.4513118267059326
The modified gen p mean: 0.45080268383026123, gen p mean: -0.0986098125576973, mean p set: 0.45137903094291687
loss_pred:0.015742221847176552, decouple_loss:0.0005511033814400434
loss_pred:0.017007093876600266, decouple_loss:0.0009840592974796891
2023-05-01 18:35:18 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10999578982591629, mean p set: 0.4502691626548767
loss_pred:0.017240051180124283, decouple_loss:0.0007704260642640293
The modified gen p mean: 0.44953417778015137, gen p mean: -0.10479214787483215, mean p set: 0.4500633478164673
loss_pred:0.01650061272084713, decouple_loss:0.0006053128745406866
The modified gen p mean: 0.449781596660614, gen p mean: -0.10430791974067688, mean p set: 0.45035696029663086
loss_pred:0.016818294301629066, decouple_loss:0.0006870314828120172
WV_1_PC_1_EH_0_PS_40, loss: 0.016887366771697998, avg_mse: 0.026265384629368782
current test mse: 0.026265
Iteration: 821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524068534374237, gen p mean: -0.0982561782002449, mean p set: 0.4529832601547241
loss_pred:0.014998695813119411, decouple_loss:0.0006295981584116817
The modified gen p mean: 0.45021146535873413, gen p mean: -0.0951298400759697, mean p set: 0.45078805088996887The modified gen p mean: 0.44992920756340027, gen p mean: -0.10009340196847916, mean p set: 0.4505075514316559
loss_pred:0.016094151884317398, decouple_loss:0.0008832734310999513
loss_pred:0.016367368400096893, decouple_loss:0.0010056188330054283
Iteration: 822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492172598838806, gen p mean: -0.09508562088012695, mean p set: 0.44979190826416016
loss_pred:0.015813345089554787, decouple_loss:0.0006460330332629383
The modified gen p mean: 0.4489995837211609, gen p mean: -0.09983450174331665, mean p set: 0.44957631826400757The modified gen p mean: 0.4494840204715729, gen p mean: -0.10008641332387924, mean p set: 0.450061172246933
loss_pred:0.015949999913573265, decouple_loss:0.0007977490313351154
loss_pred:0.016703277826309204, decouple_loss:0.0008346550748683512
Iteration: 823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500386416912079, gen p mean: -0.09914670884609222, mean p set: 0.45061564445495605
loss_pred:0.015662288293242455, decouple_loss:0.0009255516924895346
The modified gen p mean: 0.45217403769493103, gen p mean: -0.09838355332612991, mean p set: 0.4527532756328583
loss_pred:0.015901105478405952, decouple_loss:0.0011018721852451563
The modified gen p mean: 0.449404239654541, gen p mean: -0.10170106589794159, mean p set: 0.44998228549957275
loss_pred:0.016002018004655838, decouple_loss:0.0010661164997145534
Iteration: 824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44878068566322327, gen p mean: -0.10679219663143158, mean p set: 0.4493563175201416
loss_pred:0.016222340986132622, decouple_loss:0.0006401427090167999
The modified gen p mean: 0.4485206604003906, gen p mean: -0.10580254346132278, mean p set: 0.4490962028503418
loss_pred:0.01565334014594555, decouple_loss:0.0006553552811965346
The modified gen p mean: 0.44938766956329346, gen p mean: -0.10419972985982895, mean p set: 0.44996383786201477
loss_pred:0.01629725471138954, decouple_loss:0.0007314828690141439
Iteration: 825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489530026912689, gen p mean: -0.11078209429979324, mean p set: 0.4495299756526947
loss_pred:0.016150247305631638, decouple_loss:0.0006610240670852363
The modified gen p mean: 0.4500768780708313, gen p mean: -0.1132197231054306, mean p set: 0.4506552517414093
loss_pred:0.01658741943538189, decouple_loss:0.0011568126501515508
The modified gen p mean: 0.45243602991104126, gen p mean: -0.10940702259540558, mean p set: 0.45301464200019836
loss_pred:0.01572383940219879, decouple_loss:0.000759253918658942
Iteration: 826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44921383261680603, gen p mean: -0.1126500591635704, mean p set: 0.4497922658920288
loss_pred:0.01583809033036232, decouple_loss:0.0005861162208020687
The modified gen p mean: 0.4508725106716156, gen p mean: -0.10854595899581909, mean p set: 0.4514475464820862
loss_pred:0.016361718997359276, decouple_loss:0.0007284253952093422
The modified gen p mean: 0.45321211218833923, gen p mean: -0.11325757950544357, mean p set: 0.4537885785102844
loss_pred:0.015047705732285976, decouple_loss:0.0006591889541596174
Iteration: 827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524749517440796, gen p mean: -0.10898781567811966, mean p set: 0.4530515968799591
loss_pred:0.015921292826533318, decouple_loss:0.0006966253858990967
The modified gen p mean: 0.4484459161758423, gen p mean: -0.11891167610883713, mean p set: 0.4490193724632263
loss_pred:0.015441127121448517, decouple_loss:0.0008825649856589735
The modified gen p mean: 0.44957390427589417, gen p mean: -0.10796084254980087, mean p set: 0.4501486122608185
loss_pred:0.015791883692145348, decouple_loss:0.0005890148459002376
Iteration: 828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45187443494796753, gen p mean: -0.11234039813280106, mean p set: 0.4524524509906769
The modified gen p mean: 0.44968655705451965, gen p mean: -0.10941094905138016, mean p set: 0.4502647817134857
loss_pred:0.015396821312606335, decouple_loss:0.0007507409900426865
loss_pred:0.0158639308065176, decouple_loss:0.0005347418482415378
The modified gen p mean: 0.4498201310634613, gen p mean: -0.11864498257637024, mean p set: 0.450395405292511
loss_pred:0.015230134129524231, decouple_loss:0.0005847777356393635
Iteration: 829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028600096702576, gen p mean: -0.10961827635765076, mean p set: 0.4508640468120575
loss_pred:0.01568046398460865, decouple_loss:0.0005276446463540196
The modified gen p mean: 0.44938433170318604, gen p mean: -0.1149057000875473, mean p set: 0.4499586224555969
loss_pred:0.015425742603838444, decouple_loss:0.0006426166510209441
The modified gen p mean: 0.45229068398475647, gen p mean: -0.11228247731924057, mean p set: 0.4528670310974121
loss_pred:0.015968794003129005, decouple_loss:0.0007104745018295944
Iteration: 830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497889578342438, gen p mean: -0.11179187893867493, mean p set: 0.4503673017024994
loss_pred:0.015190642327070236, decouple_loss:0.000640392245259136
The modified gen p mean: 0.44944724440574646, gen p mean: -0.11044623702764511, mean p set: 0.45002463459968567
loss_pred:0.015437875874340534, decouple_loss:0.0009272872121073306
The modified gen p mean: 0.4491596221923828, gen p mean: -0.10974856466054916, mean p set: 0.44973790645599365
loss_pred:0.01523665338754654, decouple_loss:0.0007411409169435501
2023-05-01 18:37:23 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12515081465244293, mean p set: 0.4502691626548767
loss_pred:0.017376037314534187, decouple_loss:0.0007776665152050555
The modified gen p mean: 0.44953620433807373, gen p mean: -0.1202201098203659, mean p set: 0.4500633478164673
loss_pred:0.016579819843173027, decouple_loss:0.0007325794431380928
The modified gen p mean: 0.44977959990501404, gen p mean: -0.1195983961224556, mean p set: 0.45035696029663086
loss_pred:0.01689404621720314, decouple_loss:0.0007788344519212842
WV_1_PC_1_EH_0_PS_40, loss: 0.01698811911046505, avg_mse: 0.026330964639782906
current test mse: 0.026331
Iteration: 831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498964548110962, gen p mean: -0.11363420635461807, mean p set: 0.45047301054000854
loss_pred:0.016421906650066376, decouple_loss:0.0006198898772709072
The modified gen p mean: 0.45013660192489624, gen p mean: -0.11248128861188889, mean p set: 0.45071205496788025
loss_pred:0.01588483154773712, decouple_loss:0.0006812593783251941
The modified gen p mean: 0.4485996663570404, gen p mean: -0.11221696436405182, mean p set: 0.44917601346969604
loss_pred:0.015481946058571339, decouple_loss:0.0004775700799655169
Iteration: 832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864651560783386, gen p mean: -0.11985936760902405, mean p set: 0.44922199845314026
loss_pred:0.01577649638056755, decouple_loss:0.0006403051665984094
The modified gen p mean: 0.4480496644973755, gen p mean: -0.1205284520983696, mean p set: 0.4486272633075714The modified gen p mean: 0.44908082485198975, gen p mean: -0.11447301506996155, mean p set: 0.4496554732322693
loss_pred:0.016121799126267433, decouple_loss:0.0006509302766062319
loss_pred:0.01563606783747673, decouple_loss:0.0005857594660483301
Iteration: 833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45031341910362244, gen p mean: -0.12286868691444397, mean p set: 0.45088836550712585
loss_pred:0.015992367640137672, decouple_loss:0.0006589706754311919
The modified gen p mean: 0.4516328275203705, gen p mean: -0.11744002997875214, mean p set: 0.45221027731895447
loss_pred:0.016141049563884735, decouple_loss:0.0007740796427242458
The modified gen p mean: 0.44974592328071594, gen p mean: -0.11832290887832642, mean p set: 0.4503227472305298
loss_pred:0.01557184662669897, decouple_loss:0.0007671914645470679
Iteration: 834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502856731414795, gen p mean: -0.11921650916337967, mean p set: 0.4508603513240814
loss_pred:0.016325363889336586, decouple_loss:0.0007753298850730062
The modified gen p mean: 0.4492586553096771, gen p mean: -0.12081759423017502, mean p set: 0.4498359262943268
loss_pred:0.01593892090022564, decouple_loss:0.0005734279984608293
The modified gen p mean: 0.4511193335056305, gen p mean: -0.11555981636047363, mean p set: 0.45169559121131897
loss_pred:0.016437700018286705, decouple_loss:0.0007194143254309893
Iteration: 835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45135870575904846, gen p mean: -0.11651556938886642, mean p set: 0.45193424820899963
loss_pred:0.016223076730966568, decouple_loss:0.0006421848083846271
The modified gen p mean: 0.4501626193523407, gen p mean: -0.12100006639957428, mean p set: 0.4507381319999695
loss_pred:0.01572686806321144, decouple_loss:0.0007513090968132019
The modified gen p mean: 0.44941967725753784, gen p mean: -0.11960139125585556, mean p set: 0.44999533891677856
loss_pred:0.0160419549793005, decouple_loss:0.000553706893697381
Iteration: 836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499156177043915, gen p mean: -0.12011586129665375, mean p set: 0.4504907429218292
loss_pred:0.01658529043197632, decouple_loss:0.0006741237593814731
The modified gen p mean: 0.4513794779777527, gen p mean: -0.11746416240930557, mean p set: 0.4519580006599426
The modified gen p mean: 0.45019012689590454, gen p mean: -0.11439023911952972, mean p set: 0.4507634937763214
loss_pred:0.016272924840450287, decouple_loss:0.0009481377783231437
loss_pred:0.01606365479528904, decouple_loss:0.0006639562780037522
Iteration: 837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45207479596138, gen p mean: -0.11137990653514862, mean p set: 0.4526490569114685
loss_pred:0.01519438810646534, decouple_loss:0.0006521258037537336
The modified gen p mean: 0.45046553015708923, gen p mean: -0.11328352987766266, mean p set: 0.45104068517684937
loss_pred:0.015830591320991516, decouple_loss:0.0007606560830026865
The modified gen p mean: 0.45009973645210266, gen p mean: -0.11283039301633835, mean p set: 0.45067617297172546
loss_pred:0.015100042335689068, decouple_loss:0.0006241254741325974
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012006_3_24hr.npz
NaN value num: 0
Iteration: 838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44801923632621765, gen p mean: -0.1180565133690834, mean p set: 0.44859588146209717
loss_pred:0.017619479447603226, decouple_loss:0.0005654566339217126
The modified gen p mean: 0.44905340671539307, gen p mean: -0.11747333407402039, mean p set: 0.4496292173862457
The modified gen p mean: 0.4496307075023651, gen p mean: -0.11644504219293594, mean p set: 0.45020791888237
loss_pred:0.016312250867486, decouple_loss:0.0005772611475549638
loss_pred:0.01620546169579029, decouple_loss:0.0006185327656567097
Iteration: 839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687846302986145, gen p mean: -0.11627133935689926, mean p set: 0.44745421409606934
loss_pred:0.016315868124365807, decouple_loss:0.0005892663029953837
The modified gen p mean: 0.44716107845306396, gen p mean: -0.11618191748857498, mean p set: 0.4477371573448181
The modified gen p mean: 0.4482566714286804, gen p mean: -0.11832098662853241, mean p set: 0.448832243680954
loss_pred:0.016647232696413994, decouple_loss:0.0006944697815924883
loss_pred:0.01819942705333233, decouple_loss:0.0007897772011347115
Iteration: 840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694897532463074, gen p mean: -0.12053325027227402, mean p set: 0.4475262761116028
loss_pred:0.017569905146956444, decouple_loss:0.000654865987598896
The modified gen p mean: 0.4484177231788635, gen p mean: -0.1262008547782898, mean p set: 0.44899317622184753
loss_pred:0.016082672402262688, decouple_loss:0.000576836580876261
The modified gen p mean: 0.44769373536109924, gen p mean: -0.12311743944883347, mean p set: 0.44826775789260864
loss_pred:0.01807861216366291, decouple_loss:0.000793152954429388
2023-05-01 18:40:09 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12758615612983704, mean p set: 0.4502691626548767
loss_pred:0.017236903309822083, decouple_loss:0.0005702006164938211
The modified gen p mean: 0.4495372772216797, gen p mean: -0.12213150411844254, mean p set: 0.4500633478164673
loss_pred:0.01651952788233757, decouple_loss:0.0006124624633230269
The modified gen p mean: 0.4497777819633484, gen p mean: -0.12162767350673676, mean p set: 0.45035696029663086
loss_pred:0.01677994802594185, decouple_loss:0.0006660236977040768
WV_1_PC_1_EH_0_PS_40, loss: 0.01687627099454403, avg_mse: 0.02623262070119381
current test mse: 0.026233
Iteration: 841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731763005256653, gen p mean: -0.12524153292179108, mean p set: 0.44789421558380127
loss_pred:0.016621975228190422, decouple_loss:0.000750151404645294
The modified gen p mean: 0.44763126969337463, gen p mean: -0.1263926476240158, mean p set: 0.44820842146873474
loss_pred:0.016716189682483673, decouple_loss:0.0006867718184366822
The modified gen p mean: 0.44909214973449707, gen p mean: -0.12024001777172089, mean p set: 0.44966837763786316
loss_pred:0.01626804657280445, decouple_loss:0.0006829263875260949
Iteration: 842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482077658176422, gen p mean: -0.12577998638153076, mean p set: 0.4487842917442322
loss_pred:0.016956208273768425, decouple_loss:0.0006744208512827754
The modified gen p mean: 0.44688880443573, gen p mean: -0.1300252079963684, mean p set: 0.4474656283855438The modified gen p mean: 0.44732528924942017, gen p mean: -0.12411924451589584, mean p set: 0.44789883494377136
loss_pred:0.016170062124729156, decouple_loss:0.0007263266597874463
loss_pred:0.016960384324193, decouple_loss:0.0006101702456362545
Iteration: 843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906267523765564, gen p mean: -0.12470734864473343, mean p set: 0.44964075088500977
loss_pred:0.01579427532851696, decouple_loss:0.0006347774178721011
The modified gen p mean: 0.44777145981788635, gen p mean: -0.12369704246520996, mean p set: 0.44834980368614197
loss_pred:0.01774183101952076, decouple_loss:0.0005494117503985763
The modified gen p mean: 0.4477814733982086, gen p mean: -0.12467247992753983, mean p set: 0.44835713505744934
loss_pred:0.01614021696150303, decouple_loss:0.00053134880727157
Iteration: 844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681310653686523, gen p mean: -0.12607480585575104, mean p set: 0.44738876819610596
The modified gen p mean: 0.4468141198158264, gen p mean: -0.1239534318447113, mean p set: 0.447390615940094loss_pred:0.018030529841780663, decouple_loss:0.0008265055366791785
loss_pred:0.018160216510295868, decouple_loss:0.000914043455850333
The modified gen p mean: 0.4495749771595001, gen p mean: -0.12826067209243774, mean p set: 0.45015189051628113
loss_pred:0.016564631834626198, decouple_loss:0.0005951658240519464
Iteration: 845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476276636123657, gen p mean: -0.12680774927139282, mean p set: 0.44820311665534973
loss_pred:0.01634235680103302, decouple_loss:0.0005574208917096257
The modified gen p mean: 0.4468291997909546, gen p mean: -0.12426416575908661, mean p set: 0.4474024772644043
loss_pred:0.016638394445180893, decouple_loss:0.0006835033418610692
The modified gen p mean: 0.4487030506134033, gen p mean: -0.12202496081590652, mean p set: 0.44927728176116943
loss_pred:0.016109388321638107, decouple_loss:0.0007029654225334525
Iteration: 846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470348358154297, gen p mean: -0.12380858510732651, mean p set: 0.44761213660240173
loss_pred:0.017079856246709824, decouple_loss:0.0005028987652622163
The modified gen p mean: 0.4485298693180084, gen p mean: -0.12293365597724915, mean p set: 0.4491044282913208
loss_pred:0.01578047126531601, decouple_loss:0.0007243347936309874
The modified gen p mean: 0.4468129873275757, gen p mean: -0.1307566612958908, mean p set: 0.4473898112773895
loss_pred:0.016147036105394363, decouple_loss:0.0007149066659621894
Iteration: 847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480534791946411, gen p mean: -0.12322644889354706, mean p set: 0.44862788915634155
The modified gen p mean: 0.44890087842941284, gen p mean: -0.13493813574314117, mean p set: 0.4494765102863312
loss_pred:0.015806395560503006, decouple_loss:0.0006683351821266115
loss_pred:0.015568709000945091, decouple_loss:0.0007675906526856124
The modified gen p mean: 0.4464559555053711, gen p mean: -0.13512453436851501, mean p set: 0.4470324218273163
loss_pred:0.016915349289774895, decouple_loss:0.0007528171990998089
Iteration: 848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44822219014167786, gen p mean: -0.12981030344963074, mean p set: 0.44879916310310364
The modified gen p mean: 0.4484647810459137, gen p mean: -0.12702272832393646, mean p set: 0.44904273748397827
loss_pred:0.016307370737195015, decouple_loss:0.0005076403613202274
loss_pred:0.016179434955120087, decouple_loss:0.0005807916168123484
The modified gen p mean: 0.44703367352485657, gen p mean: -0.1269131898880005, mean p set: 0.4476097822189331
loss_pred:0.016629083082079887, decouple_loss:0.0005392908933572471
Iteration: 849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782590866088867, gen p mean: -0.12399612367153168, mean p set: 0.44840285181999207
The modified gen p mean: 0.44741225242614746, gen p mean: -0.11920572817325592, mean p set: 0.44798994064331055
loss_pred:0.016335083171725273, decouple_loss:0.0005839275545440614
loss_pred:0.016919855028390884, decouple_loss:0.0007255899836309254
The modified gen p mean: 0.4473990797996521, gen p mean: -0.12285088002681732, mean p set: 0.447974294424057
loss_pred:0.01632525771856308, decouple_loss:0.0005698617314919829
Iteration: 850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465096592903137, gen p mean: -0.12209960073232651, mean p set: 0.44708430767059326
loss_pred:0.016866227611899376, decouple_loss:0.0007249259506352246
The modified gen p mean: 0.44719934463500977, gen p mean: -0.12089285254478455, mean p set: 0.4477744400501251
loss_pred:0.016824789345264435, decouple_loss:0.0007741207955405116
The modified gen p mean: 0.4470776319503784, gen p mean: -0.11344283074140549, mean p set: 0.44765329360961914
loss_pred:0.016576625406742096, decouple_loss:0.0006590550765395164
2023-05-01 18:42:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11707234382629395, mean p set: 0.4502691626548767
loss_pred:0.017190534621477127, decouple_loss:0.0006191767752170563
The modified gen p mean: 0.44953495264053345, gen p mean: -0.11152585595846176, mean p set: 0.4500633478164673
loss_pred:0.016625599935650826, decouple_loss:0.0006222055526450276
The modified gen p mean: 0.4497789740562439, gen p mean: -0.11128560453653336, mean p set: 0.45035696029663086
loss_pred:0.016845474019646645, decouple_loss:0.0006118266610428691
WV_1_PC_1_EH_0_PS_40, loss: 0.016918091103434563, avg_mse: 0.02627607248723507
current test mse: 0.026276
Iteration: 851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492977261543274, gen p mean: -0.11524694412946701, mean p set: 0.4498717188835144
loss_pred:0.016076013445854187, decouple_loss:0.000623533152975142
The modified gen p mean: 0.45009103417396545, gen p mean: -0.11259616166353226, mean p set: 0.450667142868042
loss_pred:0.016342317685484886, decouple_loss:0.0005456359358504415
The modified gen p mean: 0.4482074975967407, gen p mean: -0.1189480796456337, mean p set: 0.44878458976745605
loss_pred:0.015406003221869469, decouple_loss:0.0006235465407371521
Iteration: 852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823551177978516, gen p mean: -0.10871775448322296, mean p set: 0.44880858063697815
The modified gen p mean: 0.4497503936290741, gen p mean: -0.11210249364376068, mean p set: 0.45032617449760437
loss_pred:0.016559498384594917, decouple_loss:0.000618541322182864
loss_pred:0.01626639813184738, decouple_loss:0.0006401428254321218
The modified gen p mean: 0.4479023218154907, gen p mean: -0.112961545586586, mean p set: 0.4484792649745941
loss_pred:0.016760356724262238, decouple_loss:0.0007557857898063958
Iteration: 853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707727432250977, gen p mean: -0.11934823542833328, mean p set: 0.4476519823074341
loss_pred:0.015870682895183563, decouple_loss:0.0006019554566591978
The modified gen p mean: 0.44765183329582214, gen p mean: -0.11515077203512192, mean p set: 0.4482274651527405
loss_pred:0.01718871295452118, decouple_loss:0.0006865323521196842
The modified gen p mean: 0.4489964246749878, gen p mean: -0.11619427800178528, mean p set: 0.44957301020622253
loss_pred:0.015748295933008194, decouple_loss:0.0006496002315543592
Iteration: 854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44920510053634644, gen p mean: -0.11674962937831879, mean p set: 0.4497813284397125
loss_pred:0.01540779136121273, decouple_loss:0.0007463539368472993
The modified gen p mean: 0.4473784863948822, gen p mean: -0.12151901423931122, mean p set: 0.4479536712169647
loss_pred:0.016954194754362106, decouple_loss:0.0006320467800833285
The modified gen p mean: 0.4479843080043793, gen p mean: -0.11595630645751953, mean p set: 0.44855955243110657
loss_pred:0.016568724066019058, decouple_loss:0.000627877889201045
Iteration: 855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44908833503723145, gen p mean: -0.12111756950616837, mean p set: 0.4496642053127289
loss_pred:0.015392451547086239, decouple_loss:0.0007992930477485061
The modified gen p mean: 0.4486085772514343, gen p mean: -0.11855212599039078, mean p set: 0.4491809606552124
loss_pred:0.01575576700270176, decouple_loss:0.000827136158477515
The modified gen p mean: 0.4468933045864105, gen p mean: -0.12051074951887131, mean p set: 0.44746968150138855
loss_pred:0.01614825241267681, decouple_loss:0.0005402398528531194
Iteration: 856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480353891849518, gen p mean: -0.1285325288772583, mean p set: 0.44861429929733276
loss_pred:0.016307838261127472, decouple_loss:0.0006440907600335777
The modified gen p mean: 0.44637712836265564, gen p mean: -0.12007024139165878, mean p set: 0.44695067405700684
The modified gen p mean: 0.44722431898117065, gen p mean: -0.11861387640237808, mean p set: 0.44779905676841736
loss_pred:0.017217857763171196, decouple_loss:0.0007135779014788568
loss_pred:0.016639215871691704, decouple_loss:0.000601051258854568
Iteration: 857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474083185195923, gen p mean: -0.11813998222351074, mean p set: 0.4479839503765106
The modified gen p mean: 0.44860875606536865, gen p mean: -0.1252586394548416, mean p set: 0.4491821527481079
loss_pred:0.01667112670838833, decouple_loss:0.0005825509433634579
loss_pred:0.015472518280148506, decouple_loss:0.00047779097803868353
The modified gen p mean: 0.44725301861763, gen p mean: -0.1241755336523056, mean p set: 0.4478277862071991
loss_pred:0.017069295048713684, decouple_loss:0.000602677115239203
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012016_3_24hr.npz
NaN value num: 0
Iteration: 858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500606656074524, gen p mean: -0.112006776034832, mean p set: 0.45063650608062744
loss_pred:0.016036486253142357, decouple_loss:0.000845724658574909
The modified gen p mean: 0.45026955008506775, gen p mean: -0.11005772650241852, mean p set: 0.4508446753025055
The modified gen p mean: 0.44963136315345764, gen p mean: -0.11319536715745926, mean p set: 0.4502054452896118
loss_pred:0.015946093946695328, decouple_loss:0.001400923589244485
loss_pred:0.016543574631214142, decouple_loss:0.0008388950955122709
Iteration: 859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977715611457825, gen p mean: -0.12072838097810745, mean p set: 0.4503563344478607
The modified gen p mean: 0.4504755437374115, gen p mean: -0.1107715293765068, mean p set: 0.45105084776878357
loss_pred:0.015082340687513351, decouple_loss:0.000626445806119591
loss_pred:0.016094481572508812, decouple_loss:0.0008671883260831237
The modified gen p mean: 0.4511543810367584, gen p mean: -0.1162356287240982, mean p set: 0.4517301619052887
loss_pred:0.01600571535527706, decouple_loss:0.0009008576162159443
Iteration: 860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449751079082489, gen p mean: -0.11345584690570831, mean p set: 0.4503287672996521
loss_pred:0.015875035896897316, decouple_loss:0.0007988677243702114
The modified gen p mean: 0.4478415846824646, gen p mean: -0.11501144617795944, mean p set: 0.44841670989990234
loss_pred:0.015686392784118652, decouple_loss:0.0011991012142971158
The modified gen p mean: 0.4470353126525879, gen p mean: -0.12079814821481705, mean p set: 0.4476113021373749
loss_pred:0.01623205468058586, decouple_loss:0.0010662077693268657
2023-05-01 18:44:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12494077533483505, mean p set: 0.4502691626548767
loss_pred:0.01716705970466137, decouple_loss:0.001137582934461534
The modified gen p mean: 0.44953596591949463, gen p mean: -0.11945975571870804, mean p set: 0.4500633478164673
loss_pred:0.016568496823310852, decouple_loss:0.0010448083048686385
The modified gen p mean: 0.44978466629981995, gen p mean: -0.11940844357013702, mean p set: 0.45035696029663086
loss_pred:0.016899600625038147, decouple_loss:0.0010358309373259544
WV_1_PC_1_EH_0_PS_40, loss: 0.01693202182650566, avg_mse: 0.02630707249045372
current test mse: 0.026307
Iteration: 861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45002779364585876, gen p mean: -0.1128489077091217, mean p set: 0.4506036043167114
loss_pred:0.01610034890472889, decouple_loss:0.0007586429710499942
The modified gen p mean: 0.449503093957901, gen p mean: -0.11060929298400879, mean p set: 0.45007678866386414
loss_pred:0.01648576743900776, decouple_loss:0.000829345837701112
The modified gen p mean: 0.45046141743659973, gen p mean: -0.10916228592395782, mean p set: 0.4510374367237091
loss_pred:0.015346275642514229, decouple_loss:0.0008516045636497438
Iteration: 862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802770018577576, gen p mean: -0.1099000945687294, mean p set: 0.44860365986824036
loss_pred:0.015564479865133762, decouple_loss:0.0007303236634470522
The modified gen p mean: 0.4480840265750885, gen p mean: -0.10884563624858856, mean p set: 0.44865939021110535The modified gen p mean: 0.4487375319004059, gen p mean: -0.10959926247596741, mean p set: 0.44931453466415405
loss_pred:0.01526213064789772, decouple_loss:0.0008302235510200262
loss_pred:0.01593923382461071, decouple_loss:0.0005489823524840176
Iteration: 863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498766362667084, gen p mean: -0.10780871659517288, mean p set: 0.45045000314712524
loss_pred:0.016029762104153633, decouple_loss:0.0007138487999327481
The modified gen p mean: 0.450181782245636, gen p mean: -0.11496429890394211, mean p set: 0.45076125860214233
loss_pred:0.01506888773292303, decouple_loss:0.0007068125996738672
The modified gen p mean: 0.448723167181015, gen p mean: -0.1208610087633133, mean p set: 0.44930049777030945
loss_pred:0.015735559165477753, decouple_loss:0.0006463214522227645
Iteration: 864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449423611164093, gen p mean: -0.11682768911123276, mean p set: 0.45000073313713074
loss_pred:0.015812493860721588, decouple_loss:0.0008267238736152649
The modified gen p mean: 0.4487849473953247, gen p mean: -0.11508262902498245, mean p set: 0.44936051964759827
loss_pred:0.015393917448818684, decouple_loss:0.0006179082556627691
The modified gen p mean: 0.4500398337841034, gen p mean: -0.11912932991981506, mean p set: 0.45061561465263367
loss_pred:0.014949765987694263, decouple_loss:0.0006249315338209271
Iteration: 865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480530619621277, gen p mean: -0.12127381563186646, mean p set: 0.448630690574646
loss_pred:0.014801038429141045, decouple_loss:0.0006198476767167449
The modified gen p mean: 0.4498831331729889, gen p mean: -0.12373360991477966, mean p set: 0.45045650005340576
loss_pred:0.01506050769239664, decouple_loss:0.0007303508464246988
The modified gen p mean: 0.4505600035190582, gen p mean: -0.11973968893289566, mean p set: 0.45113739371299744
loss_pred:0.015556907281279564, decouple_loss:0.0007546608685515821
Iteration: 866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480661451816559, gen p mean: -0.12320129573345184, mean p set: 0.448642760515213
loss_pred:0.016352646052837372, decouple_loss:0.0007610455504618585
The modified gen p mean: 0.44950807094573975, gen p mean: -0.12552568316459656, mean p set: 0.450085312128067
loss_pred:0.015752246603369713, decouple_loss:0.0006955318967811763
The modified gen p mean: 0.44882360100746155, gen p mean: -0.13022007048130035, mean p set: 0.44939908385276794
loss_pred:0.014788246713578701, decouple_loss:0.0007357143913395703
Iteration: 867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947507977485657, gen p mean: -0.12066791206598282, mean p set: 0.45005226135253906
loss_pred:0.016284890472888947, decouple_loss:0.000571194221265614
The modified gen p mean: 0.44880643486976624, gen p mean: -0.12038193643093109, mean p set: 0.44938188791275024
The modified gen p mean: 0.44897475838661194, gen p mean: -0.12789542973041534, mean p set: 0.44955018162727356
loss_pred:0.01518089696764946, decouple_loss:0.0006085755885578692
loss_pred:0.01607266440987587, decouple_loss:0.000667380343656987
Iteration: 868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495109021663666, gen p mean: -0.12244323641061783, mean p set: 0.4500850439071655
The modified gen p mean: 0.4503456652164459, gen p mean: -0.11685869842767715, mean p set: 0.4509223401546478loss_pred:0.015402382239699364, decouple_loss:0.0008528713951818645
loss_pred:0.01556275226175785, decouple_loss:0.0008231739629991353
The modified gen p mean: 0.45088326930999756, gen p mean: -0.1197788193821907, mean p set: 0.451458215713501
loss_pred:0.015521679073572159, decouple_loss:0.000736493500880897
Iteration: 869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480668008327484, gen p mean: -0.11669322103261948, mean p set: 0.4486430585384369
loss_pred:0.01495254784822464, decouple_loss:0.0007396764121949673
The modified gen p mean: 0.45223405957221985, gen p mean: -0.11942121386528015, mean p set: 0.4528099000453949
loss_pred:0.015058284625411034, decouple_loss:0.0005722239729948342
The modified gen p mean: 0.4476962685585022, gen p mean: -0.12394025176763535, mean p set: 0.44827285408973694
loss_pred:0.01581704244017601, decouple_loss:0.0007432977436110377
Iteration: 870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45053282380104065, gen p mean: -0.11281738430261612, mean p set: 0.4511106312274933
The modified gen p mean: 0.44921085238456726, gen p mean: -0.11244291812181473, mean p set: 0.4497860372066498
loss_pred:0.01596287079155445, decouple_loss:0.0009313754271715879
loss_pred:0.015486549586057663, decouple_loss:0.0007884694496169686
The modified gen p mean: 0.4484575390815735, gen p mean: -0.12044219672679901, mean p set: 0.44903138279914856
loss_pred:0.015592996962368488, decouple_loss:0.0007473446312360466
2023-05-01 18:47:05 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12393459677696228, mean p set: 0.4502691626548767
loss_pred:0.017193127423524857, decouple_loss:0.0008082787389867008
The modified gen p mean: 0.44953653216362, gen p mean: -0.1185804009437561, mean p set: 0.4500633478164673
loss_pred:0.01657121255993843, decouple_loss:0.0007796706049703062
The modified gen p mean: 0.4497801959514618, gen p mean: -0.11870690435171127, mean p set: 0.45035696029663086
loss_pred:0.016872184351086617, decouple_loss:0.0007924775709398091
WV_1_PC_1_EH_0_PS_40, loss: 0.016918515786528587, avg_mse: 0.026283403858542442
current test mse: 0.026283
Iteration: 871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484185576438904, gen p mean: -0.11386724561452866, mean p set: 0.4489981234073639
loss_pred:0.015247173607349396, decouple_loss:0.0006505906349048018
The modified gen p mean: 0.45008254051208496, gen p mean: -0.10731504112482071, mean p set: 0.4506600499153137
loss_pred:0.015557377599179745, decouple_loss:0.0006109671667218208
The modified gen p mean: 0.44781365990638733, gen p mean: -0.1081438958644867, mean p set: 0.4483916759490967
loss_pred:0.016115177422761917, decouple_loss:0.0006219866336323321
Iteration: 872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478325843811035, gen p mean: -0.10921558737754822, mean p set: 0.44840651750564575
loss_pred:0.015972493216395378, decouple_loss:0.0007883451180532575
The modified gen p mean: 0.4497281610965729, gen p mean: -0.10553916543722153, mean p set: 0.4503055810928345The modified gen p mean: 0.4503217935562134, gen p mean: -0.10405707359313965, mean p set: 0.45089852809906006
loss_pred:0.015487371943891048, decouple_loss:0.0005335381720215082
loss_pred:0.016089944168925285, decouple_loss:0.0006820113048888743
Iteration: 873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487721025943756, gen p mean: -0.10932337492704391, mean p set: 0.44934722781181335
loss_pred:0.01579354703426361, decouple_loss:0.0005639001028612256
The modified gen p mean: 0.4486199617385864, gen p mean: -0.10713522136211395, mean p set: 0.44919705390930176The modified gen p mean: 0.4483615756034851, gen p mean: -0.11884937435388565, mean p set: 0.4489381015300751
loss_pred:0.015268881805241108, decouple_loss:0.0005115794483572245
loss_pred:0.016243482008576393, decouple_loss:0.0006680019432678819
Iteration: 874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990700483322144, gen p mean: -0.11325860023498535, mean p set: 0.45048198103904724
loss_pred:0.014981322921812534, decouple_loss:0.0005625212215818465
The modified gen p mean: 0.4476434588432312, gen p mean: -0.11516311019659042, mean p set: 0.4482189118862152
loss_pred:0.016079097986221313, decouple_loss:0.0008093190263025463
The modified gen p mean: 0.449146568775177, gen p mean: -0.108470618724823, mean p set: 0.4497230648994446
loss_pred:0.01589149422943592, decouple_loss:0.0005335673922672868
Iteration: 875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448788583278656, gen p mean: -0.11246121674776077, mean p set: 0.4493641257286072
loss_pred:0.014781194739043713, decouple_loss:0.0006954320706427097
The modified gen p mean: 0.44948822259902954, gen p mean: -0.11308954656124115, mean p set: 0.45006507635116577
loss_pred:0.016664765775203705, decouple_loss:0.00057315913727507
The modified gen p mean: 0.44937410950660706, gen p mean: -0.1214296817779541, mean p set: 0.4499492049217224
loss_pred:0.01488192193210125, decouple_loss:0.0006902081076987088
Iteration: 876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501737058162689, gen p mean: -0.10796806216239929, mean p set: 0.4507491886615753
loss_pred:0.015633733943104744, decouple_loss:0.0008186941267922521
The modified gen p mean: 0.451822429895401, gen p mean: -0.11426848918199539, mean p set: 0.4524003565311432
loss_pred:0.015982476994395256, decouple_loss:0.0006986425723880529
The modified gen p mean: 0.44968411326408386, gen p mean: -0.11383388191461563, mean p set: 0.45025986433029175
loss_pred:0.015007562935352325, decouple_loss:0.0005043220007792115
Iteration: 877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475420415401459, gen p mean: -0.11921165883541107, mean p set: 0.44811883568763733
loss_pred:0.015469261445105076, decouple_loss:0.0005509398179128766
The modified gen p mean: 0.4503523111343384, gen p mean: -0.10956602543592453, mean p set: 0.4509299099445343
loss_pred:0.015549956820905209, decouple_loss:0.0007594283088110387
The modified gen p mean: 0.45026278495788574, gen p mean: -0.11511891335248947, mean p set: 0.45084071159362793
loss_pred:0.014607630670070648, decouple_loss:0.0005954980733804405
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012005_3_24hr.npz
NaN value num: 0
Iteration: 878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493611454963684, gen p mean: -0.11281304061412811, mean p set: 0.44993606209754944
loss_pred:0.016702206805348396, decouple_loss:0.0006283079856075346
The modified gen p mean: 0.4483034610748291, gen p mean: -0.11480213701725006, mean p set: 0.44888144731521606
The modified gen p mean: 0.4486977159976959, gen p mean: -0.11261163651943207, mean p set: 0.44927293062210083
loss_pred:0.016722772270441055, decouple_loss:0.0007876403396949172
loss_pred:0.01712803542613983, decouple_loss:0.0006400004494935274
Iteration: 879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479999840259552, gen p mean: -0.10973067581653595, mean p set: 0.448575496673584
loss_pred:0.017714910209178925, decouple_loss:0.0006542530027218163
The modified gen p mean: 0.4497215449810028, gen p mean: -0.10996971279382706, mean p set: 0.4502998888492584
loss_pred:0.015931174159049988, decouple_loss:0.0005655449931509793
The modified gen p mean: 0.44860151410102844, gen p mean: -0.1135200783610344, mean p set: 0.4491797089576721
loss_pred:0.016987212002277374, decouple_loss:0.0009178285836242139
Iteration: 880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448771595954895, gen p mean: -0.10876549780368805, mean p set: 0.44934555888175964
loss_pred:0.017137400805950165, decouple_loss:0.001289081177674234
The modified gen p mean: 0.449929416179657, gen p mean: -0.10648838430643082, mean p set: 0.4505065083503723
loss_pred:0.016197066754102707, decouple_loss:0.0009100909810513258
The modified gen p mean: 0.4475513994693756, gen p mean: -0.10861280560493469, mean p set: 0.4481256306171417
loss_pred:0.01661454327404499, decouple_loss:0.0009161913767457008
2023-05-01 18:49:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11383518576622009, mean p set: 0.4502691626548767
loss_pred:0.017102817073464394, decouple_loss:0.0007557788630947471
The modified gen p mean: 0.44953465461730957, gen p mean: -0.10861462354660034, mean p set: 0.4500633478164673
loss_pred:0.01647203043103218, decouple_loss:0.0006312721525318921
The modified gen p mean: 0.4497809410095215, gen p mean: -0.10862107574939728, mean p set: 0.45035696029663086
loss_pred:0.016779795289039612, decouple_loss:0.0005954646621830761
WV_1_PC_1_EH_0_PS_40, loss: 0.01681792363524437, avg_mse: 0.026192225515842438
current test mse: 0.026192
Iteration: 881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448055237531662, gen p mean: -0.1098078116774559, mean p set: 0.44863176345825195
loss_pred:0.01757681928575039, decouple_loss:0.0006014335667714477
The modified gen p mean: 0.44953635334968567, gen p mean: -0.10828413814306259, mean p set: 0.4501113295555115The modified gen p mean: 0.4497728943824768, gen p mean: -0.10449834167957306, mean p set: 0.4503500759601593
loss_pred:0.016320114955306053, decouple_loss:0.0006514309206977487
loss_pred:0.016112126410007477, decouple_loss:0.000800846260972321
Iteration: 882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496854543685913, gen p mean: -0.11034142225980759, mean p set: 0.45026108622550964
The modified gen p mean: 0.450125515460968, gen p mean: -0.11274535953998566, mean p set: 0.4507031738758087loss_pred:0.016822321340441704, decouple_loss:0.0005663860938511789
loss_pred:0.016751624643802643, decouple_loss:0.0005722458008676767
The modified gen p mean: 0.4485272467136383, gen p mean: -0.11236554384231567, mean p set: 0.4491029977798462
loss_pred:0.017126210033893585, decouple_loss:0.0006156423478387296
Iteration: 883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886699318885803, gen p mean: -0.11561134457588196, mean p set: 0.44944456219673157
loss_pred:0.017045732587575912, decouple_loss:0.0006974000716581941
The modified gen p mean: 0.45012611150741577, gen p mean: -0.11808688193559647, mean p set: 0.4507019817829132The modified gen p mean: 0.448582261800766, gen p mean: -0.11782902479171753, mean p set: 0.4491589367389679
loss_pred:0.016226813197135925, decouple_loss:0.0008603462483733892
loss_pred:0.016849303618073463, decouple_loss:0.0009897943818941712
Iteration: 884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44782254099845886, gen p mean: -0.121981181204319, mean p set: 0.4483988583087921
loss_pred:0.01608460210263729, decouple_loss:0.0006599896587431431
The modified gen p mean: 0.4502544105052948, gen p mean: -0.12345219403505325, mean p set: 0.45083382725715637
loss_pred:0.016475897282361984, decouple_loss:0.0006685421685688198
The modified gen p mean: 0.44959402084350586, gen p mean: -0.12555424869060516, mean p set: 0.45017367601394653
loss_pred:0.01585463434457779, decouple_loss:0.0005444437847472727
Iteration: 885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449616014957428, gen p mean: -0.12351620942354202, mean p set: 0.4501916468143463
loss_pred:0.017770729959011078, decouple_loss:0.0009692627936601639
The modified gen p mean: 0.4497976005077362, gen p mean: -0.1279040426015854, mean p set: 0.4503753185272217
loss_pred:0.015724927186965942, decouple_loss:0.0007120634545572102
The modified gen p mean: 0.448290079832077, gen p mean: -0.12541061639785767, mean p set: 0.4488662779331207
loss_pred:0.01638348214328289, decouple_loss:0.0006513576954603195
Iteration: 886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498647451400757, gen p mean: -0.12917408347129822, mean p set: 0.4504399299621582
The modified gen p mean: 0.449505478143692, gen p mean: -0.12463551759719849, mean p set: 0.4500845670700073
loss_pred:0.015459833666682243, decouple_loss:0.0007240373524837196
loss_pred:0.016487380489706993, decouple_loss:0.0008101350395008922
The modified gen p mean: 0.449489027261734, gen p mean: -0.12673865258693695, mean p set: 0.450064092874527
loss_pred:0.016996029764413834, decouple_loss:0.0010093289893120527
Iteration: 887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490708112716675, gen p mean: -0.13051313161849976, mean p set: 0.4496472179889679
loss_pred:0.017172936350107193, decouple_loss:0.000602784042712301
The modified gen p mean: 0.44869276881217957, gen p mean: -0.1281227171421051, mean p set: 0.4492657780647278
loss_pred:0.016950001940131187, decouple_loss:0.0005668867379426956
The modified gen p mean: 0.4491260051727295, gen p mean: -0.12515147030353546, mean p set: 0.4497022032737732
loss_pred:0.01710391230881214, decouple_loss:0.0005253985873423517
Iteration: 888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44859734177589417, gen p mean: -0.13201726973056793, mean p set: 0.44917523860931396
loss_pred:0.016906501725316048, decouple_loss:0.0008028668235056102
The modified gen p mean: 0.4488072693347931, gen p mean: -0.12937848269939423, mean p set: 0.4493875503540039
The modified gen p mean: 0.44848552346229553, gen p mean: -0.12700027227401733, mean p set: 0.44906121492385864
loss_pred:0.01712965779006481, decouple_loss:0.000791857426520437
loss_pred:0.016736658290028572, decouple_loss:0.0007388177909888327
Iteration: 889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472714960575104, gen p mean: -0.13059744238853455, mean p set: 0.4478487968444824
loss_pred:0.016561206430196762, decouple_loss:0.0008469505701214075
The modified gen p mean: 0.4481056332588196, gen p mean: -0.12720724940299988, mean p set: 0.44868043065071106
The modified gen p mean: 0.44738152623176575, gen p mean: -0.1308741569519043, mean p set: 0.4479599893093109
loss_pred:0.01657230593264103, decouple_loss:0.0007277419208548963
loss_pred:0.01699964329600334, decouple_loss:0.0009031546069309115
Iteration: 890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489629566669464, gen p mean: -0.12063352018594742, mean p set: 0.44953852891921997
loss_pred:0.01711992733180523, decouple_loss:0.0006944668712094426
The modified gen p mean: 0.4503539800643921, gen p mean: -0.12707914412021637, mean p set: 0.4509304463863373
loss_pred:0.016191354021430016, decouple_loss:0.0009452240774407983
The modified gen p mean: 0.45089736580848694, gen p mean: -0.12835277616977692, mean p set: 0.4514707326889038
loss_pred:0.016033193096518517, decouple_loss:0.0008614335674792528
2023-05-01 18:51:56 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1302974671125412, mean p set: 0.4502691626548767
loss_pred:0.017147423699498177, decouple_loss:0.0009880628203973174
The modified gen p mean: 0.4495343565940857, gen p mean: -0.12465973943471909, mean p set: 0.4500633478164673
loss_pred:0.0164787657558918, decouple_loss:0.0009538047597743571
The modified gen p mean: 0.44978171586990356, gen p mean: -0.1246497631072998, mean p set: 0.45035696029663086
loss_pred:0.01679941639304161, decouple_loss:0.0008708278182893991
WV_1_PC_1_EH_0_PS_40, loss: 0.01685541495680809, avg_mse: 0.026252608746290207
current test mse: 0.026253
Iteration: 891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969046115875244, gen p mean: -0.11936686187982559, mean p set: 0.45026645064353943
The modified gen p mean: 0.4486503601074219, gen p mean: -0.12106376886367798, mean p set: 0.4492282271385193
loss_pred:0.01641220785677433, decouple_loss:0.0006532312254421413
loss_pred:0.016970431432127953, decouple_loss:0.0008180501172319055
The modified gen p mean: 0.4488411247730255, gen p mean: -0.12416697293519974, mean p set: 0.4494177997112274
loss_pred:0.01683710515499115, decouple_loss:0.0008240471943281591
Iteration: 892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449356347322464, gen p mean: -0.12347683310508728, mean p set: 0.4499320983886719
loss_pred:0.016356302425265312, decouple_loss:0.0005705544608645141
The modified gen p mean: 0.449205219745636, gen p mean: -0.12167180329561234, mean p set: 0.4497818946838379The modified gen p mean: 0.4482153356075287, gen p mean: -0.12279090285301208, mean p set: 0.4487886428833008
loss_pred:0.017333902418613434, decouple_loss:0.0005953724612481892
loss_pred:0.01648978888988495, decouple_loss:0.0005225097411312163
Iteration: 893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44963571429252625, gen p mean: -0.12710228562355042, mean p set: 0.45021507143974304
loss_pred:0.016524026170372963, decouple_loss:0.0006954035488888621
The modified gen p mean: 0.45020928978919983, gen p mean: -0.12596088647842407, mean p set: 0.45078352093696594
loss_pred:0.0157322995364666, decouple_loss:0.0007211527554318309
The modified gen p mean: 0.44786813855171204, gen p mean: -0.1284397691488266, mean p set: 0.44844523072242737
loss_pred:0.01662452705204487, decouple_loss:0.0006655590841546655
Iteration: 894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483424127101898, gen p mean: -0.13030849397182465, mean p set: 0.4489196836948395
loss_pred:0.016494279727339745, decouple_loss:0.000660455843899399
The modified gen p mean: 0.44784197211265564, gen p mean: -0.13489627838134766, mean p set: 0.4484170973300934
loss_pred:0.017001166939735413, decouple_loss:0.0006298769148997962
The modified gen p mean: 0.4475497603416443, gen p mean: -0.12876051664352417, mean p set: 0.44812440872192383
loss_pred:0.016535187140107155, decouple_loss:0.000680594181176275
Iteration: 895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739940762519836, gen p mean: -0.13400478661060333, mean p set: 0.44797325134277344
loss_pred:0.01746680587530136, decouple_loss:0.0005397810018621385
The modified gen p mean: 0.4478994309902191, gen p mean: -0.12992729246616364, mean p set: 0.44847577810287476
loss_pred:0.01690906658768654, decouple_loss:0.0005714714643545449
The modified gen p mean: 0.45023107528686523, gen p mean: -0.13118906319141388, mean p set: 0.45080816745758057
loss_pred:0.016810977831482887, decouple_loss:0.0004546801501419395
Iteration: 896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44797372817993164, gen p mean: -0.1338905245065689, mean p set: 0.44855284690856934
loss_pred:0.016490468755364418, decouple_loss:0.0009583866340108216
The modified gen p mean: 0.44852215051651, gen p mean: -0.12923704087734222, mean p set: 0.44910046458244324
loss_pred:0.016761360689997673, decouple_loss:0.0007976241176947951
The modified gen p mean: 0.44831597805023193, gen p mean: -0.12734095752239227, mean p set: 0.4488941431045532
loss_pred:0.01624859683215618, decouple_loss:0.0006313828052952886
Iteration: 897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818180799484253, gen p mean: -0.12640249729156494, mean p set: 0.4487546980381012
loss_pred:0.016689879819750786, decouple_loss:0.0005257343291305006
The modified gen p mean: 0.448356568813324, gen p mean: -0.13045750558376312, mean p set: 0.44893211126327515
loss_pred:0.016449326649308205, decouple_loss:0.0005858659860678017
The modified gen p mean: 0.44880980253219604, gen p mean: -0.1284196823835373, mean p set: 0.4493860900402069
loss_pred:0.016552522778511047, decouple_loss:0.0006247889250516891
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012004_3_24hr.npz
NaN value num: 0
Iteration: 898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44744330644607544, gen p mean: -0.13107416033744812, mean p set: 0.4480225145816803
loss_pred:0.015633460134267807, decouple_loss:0.0006094888085499406
The modified gen p mean: 0.4486628472805023, gen p mean: -0.12833330035209656, mean p set: 0.4492388665676117
loss_pred:0.01426868885755539, decouple_loss:0.000929005560465157
The modified gen p mean: 0.44669607281684875, gen p mean: -0.13175949454307556, mean p set: 0.4472724497318268
loss_pred:0.015021195635199547, decouple_loss:0.0008211577078327537
Iteration: 899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475703537464142, gen p mean: -0.127090185880661, mean p set: 0.4481477439403534
loss_pred:0.01509004458785057, decouple_loss:0.0008205310441553593
The modified gen p mean: 0.4475199580192566, gen p mean: -0.12655140459537506, mean p set: 0.44809263944625854
loss_pred:0.014600415714085102, decouple_loss:0.0008714430150575936
The modified gen p mean: 0.44914066791534424, gen p mean: -0.13534891605377197, mean p set: 0.44971415400505066
loss_pred:0.015364624559879303, decouple_loss:0.0006552882259711623
Iteration: 900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464639723300934, gen p mean: -0.13091252744197845, mean p set: 0.44704070687294006
loss_pred:0.014325418509542942, decouple_loss:0.0006173860747367144
The modified gen p mean: 0.4476551413536072, gen p mean: -0.1293310821056366, mean p set: 0.4482307732105255
loss_pred:0.014610636048018932, decouple_loss:0.0005291945417411625
The modified gen p mean: 0.447773277759552, gen p mean: -0.1305491030216217, mean p set: 0.4483499228954315
loss_pred:0.01482541486620903, decouple_loss:0.000562331813853234
2023-05-01 18:54:40 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13116030395030975, mean p set: 0.4502691626548767
loss_pred:0.017211375758051872, decouple_loss:0.0008595095714554191
The modified gen p mean: 0.4497796893119812, gen p mean: -0.12535443902015686, mean p set: 0.45035696029663086
loss_pred:0.016924457624554634, decouple_loss:0.0008499542600475252
The modified gen p mean: 0.44953295588493347, gen p mean: -0.12550584971904755, mean p set: 0.4500633478164673
loss_pred:0.01650017499923706, decouple_loss:0.0008143470622599125
WV_1_PC_1_EH_0_PS_40, loss: 0.01692073419690132, avg_mse: 0.02638574317097664
current test mse: 0.026386
Iteration: 901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449524462223053, gen p mean: -0.12975072860717773, mean p set: 0.4501021206378937
loss_pred:0.014801845885813236, decouple_loss:0.0007101736264303327
The modified gen p mean: 0.4472237229347229, gen p mean: -0.1259012222290039, mean p set: 0.44780102372169495
loss_pred:0.01568964682519436, decouple_loss:0.0009270370355807245
The modified gen p mean: 0.4480797052383423, gen p mean: -0.13195866346359253, mean p set: 0.4486563205718994
loss_pred:0.014099315740168095, decouple_loss:0.0005438972730189562
Iteration: 902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482194185256958, gen p mean: -0.12477538734674454, mean p set: 0.44879457354545593
loss_pred:0.014610757119953632, decouple_loss:0.0006053316174075007
The modified gen p mean: 0.4486256539821625, gen p mean: -0.12062318623065948, mean p set: 0.44920095801353455The modified gen p mean: 0.44638845324516296, gen p mean: -0.13010181486606598, mean p set: 0.44696733355522156
loss_pred:0.01435561291873455, decouple_loss:0.0006429465138353407loss_pred:0.014602914452552795, decouple_loss:0.0006563441129401326
Iteration: 903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485636353492737, gen p mean: -0.11806687712669373, mean p set: 0.44913890957832336
loss_pred:0.014675972983241081, decouple_loss:0.0005801702500320971
The modified gen p mean: 0.4464137852191925, gen p mean: -0.13420766592025757, mean p set: 0.446990966796875
loss_pred:0.014877947978675365, decouple_loss:0.0007077615591697395
The modified gen p mean: 0.44831299781799316, gen p mean: -0.12294305115938187, mean p set: 0.4488862454891205
loss_pred:0.014909022487699986, decouple_loss:0.0005809841095469892
Iteration: 904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44717931747436523, gen p mean: -0.13469138741493225, mean p set: 0.44775673747062683
loss_pred:0.014420176856219769, decouple_loss:0.0005873237387277186
The modified gen p mean: 0.4476993978023529, gen p mean: -0.12929220497608185, mean p set: 0.4482734203338623
loss_pred:0.01463377196341753, decouple_loss:0.0006667113630101085
The modified gen p mean: 0.4474964141845703, gen p mean: -0.1285075843334198, mean p set: 0.4480714499950409
loss_pred:0.014266653917729855, decouple_loss:0.0006754300557076931
Iteration: 905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469773769378662, gen p mean: -0.1367533951997757, mean p set: 0.44755133986473083
loss_pred:0.014113669283688068, decouple_loss:0.0006353954668156803
The modified gen p mean: 0.44898712635040283, gen p mean: -0.13288189470767975, mean p set: 0.4495646357536316
loss_pred:0.014741015620529652, decouple_loss:0.0006629356648772955
The modified gen p mean: 0.4485395550727844, gen p mean: -0.12983356416225433, mean p set: 0.4491168260574341
loss_pred:0.015164852142333984, decouple_loss:0.0007590199238620698
Iteration: 906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472876489162445, gen p mean: -0.1357402801513672, mean p set: 0.4478631317615509
loss_pred:0.014891690574586391, decouple_loss:0.0006471132510341704
The modified gen p mean: 0.4481649100780487, gen p mean: -0.13667213916778564, mean p set: 0.4487411379814148
loss_pred:0.014210601337254047, decouple_loss:0.0005798946367576718
The modified gen p mean: 0.44739264249801636, gen p mean: -0.1316555142402649, mean p set: 0.44796544313430786
loss_pred:0.014595908112823963, decouple_loss:0.0005520132835954428
Iteration: 907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500848948955536, gen p mean: -0.13127009570598602, mean p set: 0.45066288113594055
loss_pred:0.014411966316401958, decouple_loss:0.0004984764964319766
The modified gen p mean: 0.4485187828540802, gen p mean: -0.13319668173789978, mean p set: 0.4490965008735657
loss_pred:0.014827526174485683, decouple_loss:0.000672502676025033
The modified gen p mean: 0.44809046387672424, gen p mean: -0.12981554865837097, mean p set: 0.44866693019866943
loss_pred:0.01473444513976574, decouple_loss:0.0006886085029691458
Iteration: 908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484081268310547, gen p mean: -0.12373945116996765, mean p set: 0.44898515939712524
loss_pred:0.014448237605392933, decouple_loss:0.0006248007994145155
The modified gen p mean: 0.44925984740257263, gen p mean: -0.12238726019859314, mean p set: 0.44983553886413574
The modified gen p mean: 0.44772660732269287, gen p mean: -0.12768176198005676, mean p set: 0.44830387830734253
loss_pred:0.014751388691365719, decouple_loss:0.0006705214618705213
loss_pred:0.01564512774348259, decouple_loss:0.0006304069538600743
Iteration: 909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800639152526855, gen p mean: -0.1228194609284401, mean p set: 0.4485826790332794
loss_pred:0.014493138529360294, decouple_loss:0.0006052302778698504
The modified gen p mean: 0.4462985396385193, gen p mean: -0.1318841129541397, mean p set: 0.4468747675418854
loss_pred:0.015117255970835686, decouple_loss:0.0006806548917666078
The modified gen p mean: 0.44862401485443115, gen p mean: -0.11988591402769089, mean p set: 0.44919851422309875
loss_pred:0.01449295412749052, decouple_loss:0.0008665071800351143
Iteration: 910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44931337237358093, gen p mean: -0.11894147843122482, mean p set: 0.44988885521888733
loss_pred:0.015010381117463112, decouple_loss:0.0005784926470369101
The modified gen p mean: 0.4479638934135437, gen p mean: -0.11717171221971512, mean p set: 0.44854292273521423
loss_pred:0.014350942336022854, decouple_loss:0.0005085825687274337
The modified gen p mean: 0.44866424798965454, gen p mean: -0.1149686947464943, mean p set: 0.4492424428462982
loss_pred:0.014271141961216927, decouple_loss:0.0005094613297842443
2023-05-01 18:56:47 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12871497869491577, mean p set: 0.4502691626548767
loss_pred:0.017114024609327316, decouple_loss:0.0007068048580549657
The modified gen p mean: 0.44953399896621704, gen p mean: -0.12300556898117065, mean p set: 0.4500633478164673
loss_pred:0.016461806371808052, decouple_loss:0.000673854083288461
The modified gen p mean: 0.44977882504463196, gen p mean: -0.12279127538204193, mean p set: 0.45035696029663086
loss_pred:0.01685752160847187, decouple_loss:0.0007506219553761184
WV_1_PC_1_EH_0_PS_40, loss: 0.016846638172864914, avg_mse: 0.026198819279670715
current test mse: 0.026199
Iteration: 911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480104148387909, gen p mean: -0.12486326694488525, mean p set: 0.4485855996608734
loss_pred:0.014636442996561527, decouple_loss:0.0005401811213232577
The modified gen p mean: 0.4477924108505249, gen p mean: -0.1306716650724411, mean p set: 0.44836726784706116The modified gen p mean: 0.4482489228248596, gen p mean: -0.1303936392068863, mean p set: 0.4488264322280884
loss_pred:0.013952569104731083, decouple_loss:0.0006311217439360917loss_pred:0.014361018314957619, decouple_loss:0.0005612790700979531
Iteration: 912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45010679960250854, gen p mean: -0.12538926303386688, mean p set: 0.450685054063797
loss_pred:0.014728574082255363, decouple_loss:0.0005152125377207994
The modified gen p mean: 0.4482371509075165, gen p mean: -0.1225159764289856, mean p set: 0.4488143026828766The modified gen p mean: 0.4507906138896942, gen p mean: -0.12493323534727097, mean p set: 0.4513660967350006
loss_pred:0.014592267572879791, decouple_loss:0.00046118174213916063loss_pred:0.014485708437860012, decouple_loss:0.0005729314871132374
Iteration: 913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486936926841736, gen p mean: -0.13200052082538605, mean p set: 0.4492718279361725
loss_pred:0.014865633100271225, decouple_loss:0.0007464785012416542
The modified gen p mean: 0.44825929403305054, gen p mean: -0.12357477843761444, mean p set: 0.44883567094802856The modified gen p mean: 0.44606131315231323, gen p mean: -0.1296740621328354, mean p set: 0.44663533568382263
loss_pred:0.01493876427412033, decouple_loss:0.00045659448369406164
loss_pred:0.014508936554193497, decouple_loss:0.000689648324623704
Iteration: 914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483824074268341, gen p mean: -0.1316554695367813, mean p set: 0.44895556569099426
loss_pred:0.01514510903507471, decouple_loss:0.0005174455582164228
The modified gen p mean: 0.4479527175426483, gen p mean: -0.12720613181591034, mean p set: 0.4485265016555786
loss_pred:0.013982185162603855, decouple_loss:0.0006871474324725568
The modified gen p mean: 0.4481610953807831, gen p mean: -0.12858466804027557, mean p set: 0.4487343728542328
loss_pred:0.015374084934592247, decouple_loss:0.0006109706009738147
Iteration: 915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474703371524811, gen p mean: -0.1305462121963501, mean p set: 0.44804564118385315
loss_pred:0.014736748300492764, decouple_loss:0.0006159328040666878
The modified gen p mean: 0.44865185022354126, gen p mean: -0.12108229100704193, mean p set: 0.4492274820804596
loss_pred:0.014197579585015774, decouple_loss:0.0006140145123936236
The modified gen p mean: 0.4476797878742218, gen p mean: -0.12100201100111008, mean p set: 0.4482579529285431
loss_pred:0.014576191082596779, decouple_loss:0.0006201503565534949
Iteration: 916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448281466960907, gen p mean: -0.11957648396492004, mean p set: 0.44885557889938354
The modified gen p mean: 0.4478704333305359, gen p mean: -0.12253675609827042, mean p set: 0.44844454526901245
loss_pred:0.014187349006533623, decouple_loss:0.0005030586034990847
loss_pred:0.01402372494339943, decouple_loss:0.0005400926456786692
The modified gen p mean: 0.44819191098213196, gen p mean: -0.12192142754793167, mean p set: 0.44876742362976074
loss_pred:0.014680256135761738, decouple_loss:0.0006281291134655476
Iteration: 917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44874173402786255, gen p mean: -0.11487600207328796, mean p set: 0.449319064617157
The modified gen p mean: 0.448189377784729, gen p mean: -0.12514673173427582, mean p set: 0.4487667679786682
loss_pred:0.014550485648214817, decouple_loss:0.000701493991073221
loss_pred:0.014510169625282288, decouple_loss:0.0005006614956073463
The modified gen p mean: 0.44783300161361694, gen p mean: -0.11822538077831268, mean p set: 0.448408842086792
loss_pred:0.014810512773692608, decouple_loss:0.0006018665735609829
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012015_3_24hr.npz
NaN value num: 0
Iteration: 918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44846272468566895, gen p mean: -0.11308542639017105, mean p set: 0.4490378499031067
loss_pred:0.016163578256964684, decouple_loss:0.0008500056574121118
The modified gen p mean: 0.44664111733436584, gen p mean: -0.11843809485435486, mean p set: 0.44721853733062744
The modified gen p mean: 0.44794049859046936, gen p mean: -0.11625929921865463, mean p set: 0.4485168755054474
loss_pred:0.015880161896348, decouple_loss:0.0006471308297477663
loss_pred:0.016228774562478065, decouple_loss:0.0011143741430714726
Iteration: 919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45062944293022156, gen p mean: -0.11265348643064499, mean p set: 0.4512079358100891
loss_pred:0.015454606153070927, decouple_loss:0.0006997695309109986
The modified gen p mean: 0.45046761631965637, gen p mean: -0.11268901824951172, mean p set: 0.4510430097579956
loss_pred:0.015671147033572197, decouple_loss:0.0006200621137395501
The modified gen p mean: 0.44796741008758545, gen p mean: -0.1170336902141571, mean p set: 0.4485437870025635
loss_pred:0.016728460788726807, decouple_loss:0.0008963237050920725
Iteration: 920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447007417678833, gen p mean: -0.11676111072301865, mean p set: 0.44758492708206177
The modified gen p mean: 0.44974285364151, gen p mean: -0.11234133690595627, mean p set: 0.45032137632369995
loss_pred:0.01591707020998001, decouple_loss:0.0008345916867256165
loss_pred:0.016616441309452057, decouple_loss:0.0007024193764664233
The modified gen p mean: 0.4506089687347412, gen p mean: -0.1099671870470047, mean p set: 0.4511849880218506
loss_pred:0.016086479648947716, decouple_loss:0.0008784671663306653
2023-05-01 18:59:31 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12092055380344391, mean p set: 0.4502691626548767
loss_pred:0.01714169606566429, decouple_loss:0.0006980028701946139
The modified gen p mean: 0.4495338201522827, gen p mean: -0.11554186046123505, mean p set: 0.4500633478164673
loss_pred:0.016504699364304543, decouple_loss:0.0006960181053727865
The modified gen p mean: 0.4497804641723633, gen p mean: -0.11548084765672684, mean p set: 0.45035696029663086
loss_pred:0.016825547441840172, decouple_loss:0.000721635646186769
WV_1_PC_1_EH_0_PS_40, loss: 0.01685924082994461, avg_mse: 0.026214849203824997
current test mse: 0.026215
Iteration: 921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506984055042267, gen p mean: -0.10913335531949997, mean p set: 0.4512731432914734
loss_pred:0.015632743015885353, decouple_loss:0.0008535265806131065
The modified gen p mean: 0.4490184485912323, gen p mean: -0.10733616352081299, mean p set: 0.44959574937820435
loss_pred:0.016124770045280457, decouple_loss:0.0007357446593232453
The modified gen p mean: 0.44969597458839417, gen p mean: -0.10921697318553925, mean p set: 0.4502742886543274
loss_pred:0.016552500426769257, decouple_loss:0.0007607410079799592
Iteration: 922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832170009613037, gen p mean: -0.10737907886505127, mean p set: 0.44889700412750244
loss_pred:0.017137888818979263, decouple_loss:0.0005954189109615982
The modified gen p mean: 0.4490506052970886, gen p mean: -0.10624554753303528, mean p set: 0.44962626695632935The modified gen p mean: 0.45015615224838257, gen p mean: -0.11095274239778519, mean p set: 0.45073163509368896
loss_pred:0.016931328922510147, decouple_loss:0.0005869330489076674
loss_pred:0.017215289175510406, decouple_loss:0.000639705453068018
Iteration: 923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500114321708679, gen p mean: -0.11120437830686569, mean p set: 0.4505882263183594
loss_pred:0.016290055587887764, decouple_loss:0.0006748979794792831
The modified gen p mean: 0.44725489616394043, gen p mean: -0.11431341618299484, mean p set: 0.4478309452533722
loss_pred:0.01705668307840824, decouple_loss:0.0005625822814181447
The modified gen p mean: 0.44892969727516174, gen p mean: -0.11172593384981155, mean p set: 0.4495069682598114
loss_pred:0.017027603462338448, decouple_loss:0.0006752717890776694
Iteration: 924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44864556193351746, gen p mean: -0.12118999660015106, mean p set: 0.4492231011390686
loss_pred:0.016974108293652534, decouple_loss:0.0006117868470028043
The modified gen p mean: 0.448988139629364, gen p mean: -0.11222198605537415, mean p set: 0.4495622515678406
loss_pred:0.0167226605117321, decouple_loss:0.0005106625612825155
The modified gen p mean: 0.4502018988132477, gen p mean: -0.11431622505187988, mean p set: 0.4507790505886078
loss_pred:0.0162571519613266, decouple_loss:0.0005073270294815302
Iteration: 925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483145475387573, gen p mean: -0.1171550527215004, mean p set: 0.4488905668258667
loss_pred:0.016407819464802742, decouple_loss:0.0007695573731325567
The modified gen p mean: 0.449934184551239, gen p mean: -0.11350268125534058, mean p set: 0.4505128264427185
loss_pred:0.015878407284617424, decouple_loss:0.0006557726301252842
The modified gen p mean: 0.45066389441490173, gen p mean: -0.11334645003080368, mean p set: 0.4512411952018738
loss_pred:0.014686638489365578, decouple_loss:0.000708076695445925
Iteration: 926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506402909755707, gen p mean: -0.11298348009586334, mean p set: 0.4512166678905487
loss_pred:0.015819266438484192, decouple_loss:0.0007051544962450862
The modified gen p mean: 0.44864198565483093, gen p mean: -0.11621515452861786, mean p set: 0.44921740889549255
loss_pred:0.0169078316539526, decouple_loss:0.0006314234342426062
The modified gen p mean: 0.4510643482208252, gen p mean: -0.11330459266901016, mean p set: 0.45164018869400024
loss_pred:0.014904731884598732, decouple_loss:0.0007902021170593798
Iteration: 927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705042243003845, gen p mean: -0.12026870995759964, mean p set: 0.4476247727870941
loss_pred:0.0169138815253973, decouple_loss:0.0005915688816457987
The modified gen p mean: 0.45062756538391113, gen p mean: -0.1173163428902626, mean p set: 0.4512060284614563
loss_pred:0.016092073172330856, decouple_loss:0.0005609106156043708
The modified gen p mean: 0.4492362439632416, gen p mean: -0.11689173430204391, mean p set: 0.4498141407966614
loss_pred:0.016659468412399292, decouple_loss:0.0007570715388283134
Iteration: 928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953539967536926, gen p mean: -0.11677678674459457, mean p set: 0.4501139223575592
loss_pred:0.016089657321572304, decouple_loss:0.0005299490876495838
The modified gen p mean: 0.44787514209747314, gen p mean: -0.11264724284410477, mean p set: 0.44845154881477356
loss_pred:0.016473015770316124, decouple_loss:0.0007135025807656348
The modified gen p mean: 0.44759637117385864, gen p mean: -0.11457395553588867, mean p set: 0.44817185401916504
loss_pred:0.01670387014746666, decouple_loss:0.0006136426236480474
Iteration: 929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810134172439575, gen p mean: -0.11841573566198349, mean p set: 0.44867488741874695
The modified gen p mean: 0.44752100110054016, gen p mean: -0.11743269860744476, mean p set: 0.4480978846549988
loss_pred:0.016249168664216995, decouple_loss:0.0005704317591153085
loss_pred:0.016739429906010628, decouple_loss:0.0008188433712348342
The modified gen p mean: 0.44763538241386414, gen p mean: -0.12242060154676437, mean p set: 0.4482121169567108
loss_pred:0.016561422497034073, decouple_loss:0.0006568446406163275
Iteration: 930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45003068447113037, gen p mean: -0.11099012196063995, mean p set: 0.4506089687347412
loss_pred:0.01615370810031891, decouple_loss:0.0005427073920145631
The modified gen p mean: 0.4498569369316101, gen p mean: -0.11334449052810669, mean p set: 0.45043426752090454
The modified gen p mean: 0.4494016468524933, gen p mean: -0.11450181901454926, mean p set: 0.4499780237674713
loss_pred:0.015870854258537292, decouple_loss:0.0007440626504831016
loss_pred:0.01667984016239643, decouple_loss:0.0006541696493513882
2023-05-01 19:01:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12242402136325836, mean p set: 0.4502691626548767
loss_pred:0.017184482887387276, decouple_loss:0.0008166329353116453
The modified gen p mean: 0.4495321810245514, gen p mean: -0.11675136536359787, mean p set: 0.4500633478164673
loss_pred:0.016452988609671593, decouple_loss:0.0008526751771569252
The modified gen p mean: 0.449779748916626, gen p mean: -0.11661365628242493, mean p set: 0.45035696029663086
loss_pred:0.016874998807907104, decouple_loss:0.0009542812476865947
WV_1_PC_1_EH_0_PS_40, loss: 0.016881216317415237, avg_mse: 0.026244115084409714
current test mse: 0.026244
Iteration: 931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481935501098633, gen p mean: -0.11097472161054611, mean p set: 0.448770135641098
The modified gen p mean: 0.4490278661251068, gen p mean: -0.10701461881399155, mean p set: 0.44960159063339233loss_pred:0.016690414398908615, decouple_loss:0.0006688421708531678
loss_pred:0.01592063158750534, decouple_loss:0.0007826362852938473
The modified gen p mean: 0.4493733048439026, gen p mean: -0.10896546393632889, mean p set: 0.44995033740997314
loss_pred:0.016522016376256943, decouple_loss:0.0005892997141927481
Iteration: 932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776999950408936, gen p mean: -0.12049814313650131, mean p set: 0.44834598898887634
loss_pred:0.015960099175572395, decouple_loss:0.0007276179967448115
The modified gen p mean: 0.45067688822746277, gen p mean: -0.11385585367679596, mean p set: 0.45125463604927063The modified gen p mean: 0.44939470291137695, gen p mean: -0.11844363808631897, mean p set: 0.44997039437294006
loss_pred:0.014564256183803082, decouple_loss:0.0008725132211111486
loss_pred:0.016089841723442078, decouple_loss:0.0005909723695367575
Iteration: 933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44881778955459595, gen p mean: -0.11748628318309784, mean p set: 0.44939300417900085
loss_pred:0.01609104871749878, decouple_loss:0.0007117018685676157
The modified gen p mean: 0.44753286242485046, gen p mean: -0.11523125320672989, mean p set: 0.4481086730957031
loss_pred:0.016942765563726425, decouple_loss:0.0007556158234365284
The modified gen p mean: 0.44830042123794556, gen p mean: -0.12710195779800415, mean p set: 0.44887641072273254
loss_pred:0.01652269996702671, decouple_loss:0.0008137109107337892
Iteration: 934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44664862751960754, gen p mean: -0.1218649223446846, mean p set: 0.44722285866737366
loss_pred:0.01576916128396988, decouple_loss:0.0005307368119247258
The modified gen p mean: 0.4495355784893036, gen p mean: -0.11716296523809433, mean p set: 0.45011213421821594
loss_pred:0.01670628972351551, decouple_loss:0.00070113007677719
The modified gen p mean: 0.44784989953041077, gen p mean: -0.1272905021905899, mean p set: 0.44842615723609924
loss_pred:0.016712022945284843, decouple_loss:0.0008590962970629334
Iteration: 935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45076194405555725, gen p mean: -0.11768796294927597, mean p set: 0.45134055614471436
loss_pred:0.016973786056041718, decouple_loss:0.0006086917710490525
The modified gen p mean: 0.4485485851764679, gen p mean: -0.11846865713596344, mean p set: 0.449124276638031
loss_pred:0.015945320948958397, decouple_loss:0.00048780886572785676
The modified gen p mean: 0.4504620432853699, gen p mean: -0.11855871975421906, mean p set: 0.4510376751422882
loss_pred:0.01614171452820301, decouple_loss:0.0005236819270066917
Iteration: 936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096245408058167, gen p mean: -0.11819075047969818, mean p set: 0.45153409242630005
loss_pred:0.015184856951236725, decouple_loss:0.0008864884148351848
The modified gen p mean: 0.4501647651195526, gen p mean: -0.11901125311851501, mean p set: 0.45074358582496643
loss_pred:0.016034245491027832, decouple_loss:0.0005378430359996855
The modified gen p mean: 0.44849178194999695, gen p mean: -0.11762699484825134, mean p set: 0.4490673840045929
loss_pred:0.016250774264335632, decouple_loss:0.0007521791849285364
Iteration: 937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163172483444214, gen p mean: -0.1198292151093483, mean p set: 0.4522051215171814
The modified gen p mean: 0.4492962062358856, gen p mean: -0.12010275572538376, mean p set: 0.4498726725578308
loss_pred:0.01537459995597601, decouple_loss:0.000714994384907186
loss_pred:0.01708853244781494, decouple_loss:0.000696920498739928
The modified gen p mean: 0.4499373733997345, gen p mean: -0.1165805235505104, mean p set: 0.45051300525665283
loss_pred:0.01570805348455906, decouple_loss:0.0005730441189371049
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012016_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474903345108032, gen p mean: -0.12497768551111221, mean p set: 0.44806763529777527
The modified gen p mean: 0.44736260175704956, gen p mean: -0.12308767437934875, mean p set: 0.44793930649757385
loss_pred:0.01589425839483738, decouple_loss:0.0009372847271151841
loss_pred:0.016697507351636887, decouple_loss:0.000679963908623904
The modified gen p mean: 0.44748640060424805, gen p mean: -0.1273914873600006, mean p set: 0.4480603337287903
loss_pred:0.01606988161802292, decouple_loss:0.0009213910670951009
Iteration: 939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44719958305358887, gen p mean: -0.12263567745685577, mean p set: 0.4477778375148773
loss_pred:0.015551520511507988, decouple_loss:0.0007436600280925632
The modified gen p mean: 0.446719229221344, gen p mean: -0.1240079328417778, mean p set: 0.44729599356651306
loss_pred:0.01542328204959631, decouple_loss:0.0005415167543105781
The modified gen p mean: 0.44667673110961914, gen p mean: -0.12034958600997925, mean p set: 0.44725102186203003
loss_pred:0.015379301272332668, decouple_loss:0.0005427757860161364
Iteration: 940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44702157378196716, gen p mean: -0.11633194237947464, mean p set: 0.4475988745689392
loss_pred:0.01568836346268654, decouple_loss:0.0008653267286717892
The modified gen p mean: 0.44766610860824585, gen p mean: -0.12220343947410583, mean p set: 0.4482428729534149
loss_pred:0.015828896313905716, decouple_loss:0.0007663547876290977
The modified gen p mean: 0.447084903717041, gen p mean: -0.11854277551174164, mean p set: 0.4476606547832489
loss_pred:0.016215531155467033, decouple_loss:0.0006062163738533854
2023-05-01 19:04:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11872024089097977, mean p set: 0.4502691626548767
loss_pred:0.01721428520977497, decouple_loss:0.0007291557267308235
The modified gen p mean: 0.44953829050064087, gen p mean: -0.11357484757900238, mean p set: 0.4500633478164673
loss_pred:0.016499171033501625, decouple_loss:0.0006585129885934293
The modified gen p mean: 0.4497821033000946, gen p mean: -0.11346938461065292, mean p set: 0.45035696029663086
loss_pred:0.01688816398382187, decouple_loss:0.0006194539600983262
WV_1_PC_1_EH_0_PS_40, loss: 0.01690065860748291, avg_mse: 0.026351818814873695
current test mse: 0.026352
Iteration: 941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746172428131104, gen p mean: -0.11402331292629242, mean p set: 0.4480361342430115
loss_pred:0.016042277216911316, decouple_loss:0.0006446245824918151
The modified gen p mean: 0.44739052653312683, gen p mean: -0.11259045451879501, mean p set: 0.4479668438434601
loss_pred:0.016693228855729103, decouple_loss:0.0008022693218663335
The modified gen p mean: 0.4465559124946594, gen p mean: -0.11694701015949249, mean p set: 0.44713303446769714
loss_pred:0.015376780182123184, decouple_loss:0.0007474002195522189
Iteration: 942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475678503513336, gen p mean: -0.11228576302528381, mean p set: 0.4481445848941803
The modified gen p mean: 0.44705864787101746, gen p mean: -0.11323986202478409, mean p set: 0.44763314723968506
loss_pred:0.015686912462115288, decouple_loss:0.0006134281284175813
loss_pred:0.016481226310133934, decouple_loss:0.0007719661225564778
The modified gen p mean: 0.4470919966697693, gen p mean: -0.11340180784463882, mean p set: 0.4476645588874817
loss_pred:0.01604093424975872, decouple_loss:0.0007035781163722277
Iteration: 943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476698637008667, gen p mean: -0.11940662562847137, mean p set: 0.44824355840682983
loss_pred:0.016256222501397133, decouple_loss:0.0006231547449715436
The modified gen p mean: 0.44823434948921204, gen p mean: -0.11777202785015106, mean p set: 0.4488099217414856
loss_pred:0.016410399228334427, decouple_loss:0.0005307905958034098
The modified gen p mean: 0.4468706250190735, gen p mean: -0.11608000844717026, mean p set: 0.447443425655365
loss_pred:0.015574357472360134, decouple_loss:0.0005063708522357047
Iteration: 944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44769424200057983, gen p mean: -0.12704063951969147, mean p set: 0.4482708275318146
loss_pred:0.016644872725009918, decouple_loss:0.0006675050244666636
The modified gen p mean: 0.447521448135376, gen p mean: -0.12227064371109009, mean p set: 0.4481000304222107
loss_pred:0.015909604728221893, decouple_loss:0.0007284384919330478
The modified gen p mean: 0.44742777943611145, gen p mean: -0.1263638287782669, mean p set: 0.4480043649673462
loss_pred:0.016167083755135536, decouple_loss:0.0006268165307119489
Iteration: 945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756925106048584, gen p mean: -0.12965428829193115, mean p set: 0.4481448233127594
loss_pred:0.015830442309379578, decouple_loss:0.0006141128251329064
The modified gen p mean: 0.44698184728622437, gen p mean: -0.12244053930044174, mean p set: 0.44755926728248596
loss_pred:0.0167311392724514, decouple_loss:0.0008412315510213375
The modified gen p mean: 0.44681859016418457, gen p mean: -0.13020408153533936, mean p set: 0.44739648699760437
loss_pred:0.016430437564849854, decouple_loss:0.0006467157509177923
Iteration: 946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44781291484832764, gen p mean: -0.1280204802751541, mean p set: 0.4483889639377594
loss_pred:0.01541176624596119, decouple_loss:0.0005942971329204738
The modified gen p mean: 0.44709524512290955, gen p mean: -0.1333787441253662, mean p set: 0.44767072796821594
The modified gen p mean: 0.447913259267807, gen p mean: -0.13400980830192566, mean p set: 0.44848695397377014
loss_pred:0.01601569354534149, decouple_loss:0.0008351184078492224
loss_pred:0.01545763947069645, decouple_loss:0.0007784456829540431
Iteration: 947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716978073120117, gen p mean: -0.13310280442237854, mean p set: 0.44774720072746277
loss_pred:0.01515156775712967, decouple_loss:0.0007815842400304973
The modified gen p mean: 0.44591692090034485, gen p mean: -0.13063739240169525, mean p set: 0.44649389386177063
loss_pred:0.015054014511406422, decouple_loss:0.0007132820901460946
The modified gen p mean: 0.4477165937423706, gen p mean: -0.13610222935676575, mean p set: 0.4482952058315277
loss_pred:0.015418216586112976, decouple_loss:0.0008589282515458763
Iteration: 948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472391903400421, gen p mean: -0.12563489377498627, mean p set: 0.44781771302223206
loss_pred:0.01617508754134178, decouple_loss:0.0007444671937264502
The modified gen p mean: 0.4474327564239502, gen p mean: -0.13194824755191803, mean p set: 0.44800713658332825
The modified gen p mean: 0.44617998600006104, gen p mean: -0.12755241990089417, mean p set: 0.4467572569847107
loss_pred:0.015414996072649956, decouple_loss:0.0006642222288064659
loss_pred:0.01479670125991106, decouple_loss:0.0005410096491687
Iteration: 949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762662053108215, gen p mean: -0.1262831687927246, mean p set: 0.44820162653923035
loss_pred:0.016078276559710503, decouple_loss:0.0006561733898706734
The modified gen p mean: 0.4476456046104431, gen p mean: -0.1259773075580597, mean p set: 0.4482216238975525
loss_pred:0.016388585790991783, decouple_loss:0.0005880538956262171
The modified gen p mean: 0.4462106227874756, gen p mean: -0.12814849615097046, mean p set: 0.44678664207458496
loss_pred:0.01519348006695509, decouple_loss:0.0006651981384493411
Iteration: 950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474320113658905, gen p mean: -0.13026632368564606, mean p set: 0.4480067491531372
loss_pred:0.01572069525718689, decouple_loss:0.0007897850009612739
The modified gen p mean: 0.44753527641296387, gen p mean: -0.1261073648929596, mean p set: 0.4481123387813568
loss_pred:0.015017077326774597, decouple_loss:0.0009058169671334326
The modified gen p mean: 0.4473929703235626, gen p mean: -0.12572284042835236, mean p set: 0.4479702413082123
loss_pred:0.01551100704818964, decouple_loss:0.001076555228792131
2023-05-01 19:06:24 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13050082325935364, mean p set: 0.4502691626548767
loss_pred:0.017096975818276405, decouple_loss:0.0008211642852984369
The modified gen p mean: 0.44953468441963196, gen p mean: -0.12525002658367157, mean p set: 0.4500633478164673
loss_pred:0.016394881531596184, decouple_loss:0.0008014122722670436
The modified gen p mean: 0.449780136346817, gen p mean: -0.12501643598079681, mean p set: 0.45035696029663086
loss_pred:0.016812115907669067, decouple_loss:0.0011105535086244345
WV_1_PC_1_EH_0_PS_40, loss: 0.016813544556498528, avg_mse: 0.026198578998446465
current test mse: 0.026199
Iteration: 951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475128948688507, gen p mean: -0.12446656823158264, mean p set: 0.4480897784233093
loss_pred:0.015536922961473465, decouple_loss:0.0006707254215143621
The modified gen p mean: 0.4480346441268921, gen p mean: -0.126297727227211, mean p set: 0.4486115872859955The modified gen p mean: 0.44776228070259094, gen p mean: -0.12751662731170654, mean p set: 0.44833505153656006
loss_pred:0.015703413635492325, decouple_loss:0.0007350535015575588
loss_pred:0.01568615436553955, decouple_loss:0.0008352145669050515
Iteration: 952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484933018684387, gen p mean: -0.13400094211101532, mean p set: 0.4490697383880615
loss_pred:0.015237713232636452, decouple_loss:0.0006621344946324825
The modified gen p mean: 0.4476982057094574, gen p mean: -0.12760505080223083, mean p set: 0.4482730031013489The modified gen p mean: 0.44709500670433044, gen p mean: -0.1289452612400055, mean p set: 0.44767072796821594
loss_pred:0.015303467400372028, decouple_loss:0.0006187275284901261
loss_pred:0.015947073698043823, decouple_loss:0.0006854405510239303
Iteration: 953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472275674343109, gen p mean: -0.1291045844554901, mean p set: 0.4478038251399994
loss_pred:0.015436518006026745, decouple_loss:0.00094091787468642
The modified gen p mean: 0.44689029455184937, gen p mean: -0.12564031779766083, mean p set: 0.4474641680717468
loss_pred:0.01660475693643093, decouple_loss:0.0008069589384831488
The modified gen p mean: 0.4472027122974396, gen p mean: -0.1278996616601944, mean p set: 0.44777771830558777
loss_pred:0.01592276804149151, decouple_loss:0.0009387456811964512
Iteration: 954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713398814201355, gen p mean: -0.1303185075521469, mean p set: 0.44771143794059753
loss_pred:0.01613340899348259, decouple_loss:0.0010589448502287269
The modified gen p mean: 0.4471043646335602, gen p mean: -0.1340772807598114, mean p set: 0.44768041372299194
loss_pred:0.01502001192420721, decouple_loss:0.0008524672011844814
The modified gen p mean: 0.4484961926937103, gen p mean: -0.13558827340602875, mean p set: 0.4490669369697571
loss_pred:0.015311953611671925, decouple_loss:0.0008505673031322658
Iteration: 955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480435848236084, gen p mean: -0.13263379037380219, mean p set: 0.4486217796802521
loss_pred:0.015171256847679615, decouple_loss:0.0006191755528561771
The modified gen p mean: 0.44644883275032043, gen p mean: -0.12905576825141907, mean p set: 0.44702383875846863
loss_pred:0.015154906548559666, decouple_loss:0.0007335048285312951
The modified gen p mean: 0.44794318079948425, gen p mean: -0.1316678673028946, mean p set: 0.4485156238079071
loss_pred:0.01476258784532547, decouple_loss:0.0006950685055926442
Iteration: 956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44692376255989075, gen p mean: -0.124897800385952, mean p set: 0.44749921560287476
loss_pred:0.015774570405483246, decouple_loss:0.0006006921175867319
The modified gen p mean: 0.44735267758369446, gen p mean: -0.1275535225868225, mean p set: 0.44792598485946655
loss_pred:0.015700628980994225, decouple_loss:0.0007994732004590333
The modified gen p mean: 0.44750431180000305, gen p mean: -0.12732039391994476, mean p set: 0.44807714223861694
loss_pred:0.015588992275297642, decouple_loss:0.0008071719203144312
Iteration: 957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44700339436531067, gen p mean: -0.12904739379882812, mean p set: 0.44758090376853943
loss_pred:0.015194854699075222, decouple_loss:0.0007217954262159765
The modified gen p mean: 0.44744378328323364, gen p mean: -0.12143173068761826, mean p set: 0.4480176270008087
loss_pred:0.015681110322475433, decouple_loss:0.0006569091347046196
The modified gen p mean: 0.44729527831077576, gen p mean: -0.11750075966119766, mean p set: 0.4478713572025299
loss_pred:0.015901854261755943, decouple_loss:0.0009345169528387487
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012003_3_24hr.npz
NaN value num: 0
Iteration: 958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521089494228363, gen p mean: -0.11199424415826797, mean p set: 0.45268896222114563
loss_pred:0.014777268283069134, decouple_loss:0.0010686266468837857
The modified gen p mean: 0.4527757465839386, gen p mean: -0.11032767593860626, mean p set: 0.45335304737091064
loss_pred:0.01607155241072178, decouple_loss:0.0014935123035684228
The modified gen p mean: 0.4503510594367981, gen p mean: -0.11937414854764938, mean p set: 0.4509281814098358
loss_pred:0.015308988280594349, decouple_loss:0.0006617347244173288
Iteration: 959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45048385858535767, gen p mean: -0.10655508190393448, mean p set: 0.4510599374771118
loss_pred:0.015521104447543621, decouple_loss:0.0007420744514092803
The modified gen p mean: 0.45272862911224365, gen p mean: -0.10666443407535553, mean p set: 0.4533045291900635
loss_pred:0.01502777636051178, decouple_loss:0.0005737576866522431
The modified gen p mean: 0.4510038495063782, gen p mean: -0.10627786815166473, mean p set: 0.4515817165374756
loss_pred:0.015768900513648987, decouple_loss:0.0006954530254006386
Iteration: 960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44918474555015564, gen p mean: -0.10304013639688492, mean p set: 0.4497600495815277
loss_pred:0.015392551198601723, decouple_loss:0.0008064546273089945
The modified gen p mean: 0.44998762011528015, gen p mean: -0.10597221553325653, mean p set: 0.4505651295185089
loss_pred:0.015022970736026764, decouple_loss:0.001349311787635088
The modified gen p mean: 0.45058947801589966, gen p mean: -0.10372081398963928, mean p set: 0.45116758346557617
loss_pred:0.015514910221099854, decouple_loss:0.0007409091922454536
2023-05-01 19:09:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11502441018819809, mean p set: 0.4502691626548767
loss_pred:0.01711304858326912, decouple_loss:0.001367099117487669
The modified gen p mean: 0.4495353400707245, gen p mean: -0.1092890202999115, mean p set: 0.4500633478164673
loss_pred:0.01633114367723465, decouple_loss:0.0012838770635426044
The modified gen p mean: 0.4497815668582916, gen p mean: -0.10947845131158829, mean p set: 0.45035696029663086
loss_pred:0.016722146421670914, decouple_loss:0.0009021129226312041
WV_1_PC_1_EH_0_PS_40, loss: 0.016781331971287727, avg_mse: 0.026093732565641403
current test mse: 0.026094
Iteration: 961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525317847728729, gen p mean: -0.10170318186283112, mean p set: 0.45310890674591064
loss_pred:0.015255062840878963, decouple_loss:0.0016002123011276126
The modified gen p mean: 0.45051851868629456, gen p mean: -0.10618230700492859, mean p set: 0.45109736919403076
The modified gen p mean: 0.4517315626144409, gen p mean: -0.10079171508550644, mean p set: 0.4523092210292816
loss_pred:0.014915832318365574, decouple_loss:0.001097386353649199
loss_pred:0.014928624033927917, decouple_loss:0.0011699484894052148
Iteration: 962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509395956993103, gen p mean: -0.10413738340139389, mean p set: 0.4515168070793152
loss_pred:0.015432528220117092, decouple_loss:0.0007837821030989289
The modified gen p mean: 0.45241352915763855, gen p mean: -0.10295011103153229, mean p set: 0.4529889225959778
The modified gen p mean: 0.45149651169776917, gen p mean: -0.10503759235143661, mean p set: 0.4520733654499054
loss_pred:0.01481961365789175, decouple_loss:0.0013830033130943775
loss_pred:0.015399739146232605, decouple_loss:0.0009941001189872622
Iteration: 963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45092588663101196, gen p mean: -0.10312476009130478, mean p set: 0.45150282979011536
loss_pred:0.01547494437545538, decouple_loss:0.0005843968829140067
The modified gen p mean: 0.4505927562713623, gen p mean: -0.10430853813886642, mean p set: 0.45116788148880005
loss_pred:0.01615293137729168, decouple_loss:0.0006913065444678068
The modified gen p mean: 0.4503196179866791, gen p mean: -0.10804858803749084, mean p set: 0.4508955478668213
loss_pred:0.014785818755626678, decouple_loss:0.0006206585676409304
Iteration: 964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44977203011512756, gen p mean: -0.11060500144958496, mean p set: 0.45034632086753845
loss_pred:0.015449552796781063, decouple_loss:0.0007561097154393792
The modified gen p mean: 0.4513610899448395, gen p mean: -0.10628322511911392, mean p set: 0.4519391357898712
loss_pred:0.014815560542047024, decouple_loss:0.0006681085797026753
The modified gen p mean: 0.4496336579322815, gen p mean: -0.11187027394771576, mean p set: 0.4502086043357849
loss_pred:0.015126186423003674, decouple_loss:0.0006249413127079606
Iteration: 965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45179474353790283, gen p mean: -0.11206019669771194, mean p set: 0.4523715376853943
loss_pred:0.014863625168800354, decouple_loss:0.0009396140812896192
The modified gen p mean: 0.4532851576805115, gen p mean: -0.11060696840286255, mean p set: 0.4538613259792328
loss_pred:0.01531137153506279, decouple_loss:0.0008255423163063824
The modified gen p mean: 0.4511689245700836, gen p mean: -0.11389923840761185, mean p set: 0.4517459571361542
loss_pred:0.01576499082148075, decouple_loss:0.0007842379272915423
Iteration: 966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986408948898315, gen p mean: -0.11047650128602982, mean p set: 0.45044055581092834
loss_pred:0.015517311170697212, decouple_loss:0.0008663991466164589
The modified gen p mean: 0.4511021077632904, gen p mean: -0.10932247340679169, mean p set: 0.4516802132129669
loss_pred:0.014616554602980614, decouple_loss:0.0006647423724643886
The modified gen p mean: 0.45163077116012573, gen p mean: -0.1140659898519516, mean p set: 0.45220664143562317
loss_pred:0.014971869066357613, decouple_loss:0.0007975358166731894
Iteration: 967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45112404227256775, gen p mean: -0.10205410420894623, mean p set: 0.45169830322265625
loss_pred:0.015011236071586609, decouple_loss:0.0005486326990649104
The modified gen p mean: 0.44968804717063904, gen p mean: -0.10608329623937607, mean p set: 0.45026299357414246
loss_pred:0.015327662229537964, decouple_loss:0.0005241930484771729
The modified gen p mean: 0.4517929255962372, gen p mean: -0.10258755832910538, mean p set: 0.4523712396621704
loss_pred:0.01559047494083643, decouple_loss:0.0008356884936802089
Iteration: 968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118725299835205, gen p mean: -0.10114689916372299, mean p set: 0.45176488161087036
loss_pred:0.015151849016547203, decouple_loss:0.0008621462620794773
The modified gen p mean: 0.4516051113605499, gen p mean: -0.09946104139089584, mean p set: 0.45218244194984436
The modified gen p mean: 0.45214778184890747, gen p mean: -0.10387308895587921, mean p set: 0.4527246057987213
loss_pred:0.015402842313051224, decouple_loss:0.0006474637775681913
loss_pred:0.015734480693936348, decouple_loss:0.0011134565575048327
Iteration: 969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502130150794983, gen p mean: -0.10408346354961395, mean p set: 0.450788289308548
loss_pred:0.014940031804144382, decouple_loss:0.0009170538396574557
The modified gen p mean: 0.4517838954925537, gen p mean: -0.09713877737522125, mean p set: 0.45235851407051086
loss_pred:0.015258903615176678, decouple_loss:0.0009714846382848918
The modified gen p mean: 0.45047250390052795, gen p mean: -0.09908445179462433, mean p set: 0.45104846358299255
loss_pred:0.014658302068710327, decouple_loss:0.0006252366001717746
Iteration: 970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524598717689514, gen p mean: -0.09713297337293625, mean p set: 0.45303553342819214
loss_pred:0.015114709734916687, decouple_loss:0.00045196450082585216
The modified gen p mean: 0.4503619372844696, gen p mean: -0.09566658735275269, mean p set: 0.45093876123428345
loss_pred:0.015230320394039154, decouple_loss:0.0006981322076171637
The modified gen p mean: 0.4517160952091217, gen p mean: -0.09456262737512589, mean p set: 0.45229440927505493
loss_pred:0.015622510574758053, decouple_loss:0.0005769793060608208
2023-05-01 19:11:14 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11162153631448746, mean p set: 0.4502691626548767
loss_pred:0.01715605892241001, decouple_loss:0.000547349511180073
The modified gen p mean: 0.44953516125679016, gen p mean: -0.10654015094041824, mean p set: 0.4500633478164673
loss_pred:0.016528384760022163, decouple_loss:0.0009461833396926522
The modified gen p mean: 0.44978025555610657, gen p mean: -0.1065320298075676, mean p set: 0.45035696029663086
loss_pred:0.016806548461318016, decouple_loss:0.0007501528016291559
WV_1_PC_1_EH_0_PS_40, loss: 0.016867727041244507, avg_mse: 0.026246562600135803
current test mse: 0.026247
Iteration: 971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45200619101524353, gen p mean: -0.0985289216041565, mean p set: 0.4525846242904663
loss_pred:0.015483522787690163, decouple_loss:0.0006148657412268221
The modified gen p mean: 0.4507293403148651, gen p mean: -0.10027052462100983, mean p set: 0.45130568742752075The modified gen p mean: 0.4495304822921753, gen p mean: -0.10088799893856049, mean p set: 0.45010724663734436
loss_pred:0.015172972343862057, decouple_loss:0.0006081751198507845
loss_pred:0.01511298306286335, decouple_loss:0.0006484693731181324
Iteration: 972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511975646018982, gen p mean: -0.10632900148630142, mean p set: 0.45177337527275085
loss_pred:0.0152026591822505, decouple_loss:0.000554294150788337
The modified gen p mean: 0.45122671127319336, gen p mean: -0.10157692432403564, mean p set: 0.4518023431301117The modified gen p mean: 0.45067229866981506, gen p mean: -0.10104353725910187, mean p set: 0.45124995708465576
loss_pred:0.014821149408817291, decouple_loss:0.0008510461775586009loss_pred:0.014786266721785069, decouple_loss:0.0008173120440915227
Iteration: 973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45174938440322876, gen p mean: -0.10980921238660812, mean p set: 0.4523225724697113
loss_pred:0.014852362684905529, decouple_loss:0.0005757720791734755
The modified gen p mean: 0.4503730833530426, gen p mean: -0.1093548983335495, mean p set: 0.45094895362854004
loss_pred:0.014997033402323723, decouple_loss:0.0004888182156719267
The modified gen p mean: 0.4510638117790222, gen p mean: -0.10930854082107544, mean p set: 0.45164093375205994
loss_pred:0.014375963248312473, decouple_loss:0.0006680760998278856
Iteration: 974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513767659664154, gen p mean: -0.10757149755954742, mean p set: 0.4519527554512024
loss_pred:0.015048343688249588, decouple_loss:0.0007942566880956292
The modified gen p mean: 0.44985461235046387, gen p mean: -0.10879997164011002, mean p set: 0.45042940974235535
loss_pred:0.015509632416069508, decouple_loss:0.0008722548373043537
The modified gen p mean: 0.45076480507850647, gen p mean: -0.11395556479692459, mean p set: 0.45134058594703674
loss_pred:0.014795427210628986, decouple_loss:0.0006331261247396469
Iteration: 975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45309722423553467, gen p mean: -0.10671785473823547, mean p set: 0.45367616415023804
loss_pred:0.015679119154810905, decouple_loss:0.0007134790066629648
The modified gen p mean: 0.45182305574417114, gen p mean: -0.11020288616418839, mean p set: 0.45239993929862976
loss_pred:0.015226871706545353, decouple_loss:0.0007032995927147567
The modified gen p mean: 0.45184648036956787, gen p mean: -0.10792971402406693, mean p set: 0.4524218738079071
loss_pred:0.015297718346118927, decouple_loss:0.0007180069806054235
Iteration: 976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519351124763489, gen p mean: -0.10531794279813766, mean p set: 0.45251214504241943
loss_pred:0.015273591503500938, decouple_loss:0.0007739787106402218
The modified gen p mean: 0.4517275094985962, gen p mean: -0.10749848186969757, mean p set: 0.4523046314716339
loss_pred:0.015475567430257797, decouple_loss:0.0008155576651915908
The modified gen p mean: 0.45071136951446533, gen p mean: -0.10685435682535172, mean p set: 0.45128652453422546
loss_pred:0.01536973100155592, decouple_loss:0.0007574407500214875
Iteration: 977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013222098350525, gen p mean: -0.10829652100801468, mean p set: 0.4507088363170624
loss_pred:0.015162518247961998, decouple_loss:0.0005545373423956335
The modified gen p mean: 0.4509783089160919, gen p mean: -0.10812600702047348, mean p set: 0.45155444741249084
loss_pred:0.015256687067449093, decouple_loss:0.0008772442233748734
The modified gen p mean: 0.45191624760627747, gen p mean: -0.10371879488229752, mean p set: 0.4524940252304077
loss_pred:0.01468641310930252, decouple_loss:0.0008156037074513733
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012007_3_24hr.npz
NaN value num: 0
Iteration: 978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476774036884308, gen p mean: -0.11244000494480133, mean p set: 0.4482528567314148
loss_pred:0.01410831231623888, decouple_loss:0.0007726605399511755
The modified gen p mean: 0.44768133759498596, gen p mean: -0.11356934905052185, mean p set: 0.44825834035873413
The modified gen p mean: 0.448293000459671, gen p mean: -0.12151411175727844, mean p set: 0.4488692879676819
loss_pred:0.015610994771122932, decouple_loss:0.0005911106709390879
loss_pred:0.014813778921961784, decouple_loss:0.0006997383898124099
Iteration: 979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44755247235298157, gen p mean: -0.1145344227552414, mean p set: 0.44812890887260437
loss_pred:0.015134398825466633, decouple_loss:0.0010522980010136962
The modified gen p mean: 0.4480500817298889, gen p mean: -0.11735090613365173, mean p set: 0.4486263692378998
loss_pred:0.015536556951701641, decouple_loss:0.0005337685579434037
The modified gen p mean: 0.44683751463890076, gen p mean: -0.11551252007484436, mean p set: 0.4474125802516937
loss_pred:0.014825807884335518, decouple_loss:0.000564555695746094
Iteration: 980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802799820899963, gen p mean: -0.11494311690330505, mean p set: 0.4486044645309448
loss_pred:0.014273762702941895, decouple_loss:0.0006238281494006515
The modified gen p mean: 0.4474596381187439, gen p mean: -0.11477136611938477, mean p set: 0.44803711771965027
loss_pred:0.015716122463345528, decouple_loss:0.0005439803935587406
The modified gen p mean: 0.4482283592224121, gen p mean: -0.12147097289562225, mean p set: 0.4488038718700409
loss_pred:0.014480982907116413, decouple_loss:0.0006099632591940463
2023-05-01 19:14:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12359123677015305, mean p set: 0.4502691626548767
loss_pred:0.01711164228618145, decouple_loss:0.0005800818325951695
The modified gen p mean: 0.449535071849823, gen p mean: -0.11819826811552048, mean p set: 0.4500633478164673
loss_pred:0.016490962356328964, decouple_loss:0.0009015785763040185
The modified gen p mean: 0.4497813284397125, gen p mean: -0.11848457157611847, mean p set: 0.45035696029663086
loss_pred:0.01683896780014038, decouple_loss:0.0005660707829520106
WV_1_PC_1_EH_0_PS_40, loss: 0.016847986727952957, avg_mse: 0.026189260184764862
current test mse: 0.026189
Iteration: 981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473761320114136, gen p mean: -0.11793051660060883, mean p set: 0.4479498863220215
loss_pred:0.014429038390517235, decouple_loss:0.0004634668002836406
The modified gen p mean: 0.44842153787612915, gen p mean: -0.11744067817926407, mean p set: 0.4489966928958893The modified gen p mean: 0.4473624527454376, gen p mean: -0.1176430806517601, mean p set: 0.44793590903282166
loss_pred:0.01497742347419262, decouple_loss:0.0007183293928392231
loss_pred:0.015021156519651413, decouple_loss:0.0005742684588767588
Iteration: 982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475431442260742, gen p mean: -0.12308551371097565, mean p set: 0.44811877608299255
loss_pred:0.01431194320321083, decouple_loss:0.0005883226403966546
The modified gen p mean: 0.4486333429813385, gen p mean: -0.12511733174324036, mean p set: 0.44921019673347473The modified gen p mean: 0.4484032392501831, gen p mean: -0.12421561777591705, mean p set: 0.4489794969558716
loss_pred:0.01477065309882164, decouple_loss:0.0008761727367527783
loss_pred:0.014834004454314709, decouple_loss:0.0006396333919838071
Iteration: 983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928789138793945, gen p mean: -0.12117495387792587, mean p set: 0.4498658776283264
loss_pred:0.014587046578526497, decouple_loss:0.0006001462461426854
The modified gen p mean: 0.4478658139705658, gen p mean: -0.12290827184915543, mean p set: 0.4484385848045349
loss_pred:0.0142490454018116, decouple_loss:0.0005319462507031858
The modified gen p mean: 0.4473542273044586, gen p mean: -0.1281713843345642, mean p set: 0.4479329288005829
loss_pred:0.014098841696977615, decouple_loss:0.000566817179787904
Iteration: 984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471396505832672, gen p mean: -0.12587620317935944, mean p set: 0.44771671295166016
loss_pred:0.015193684957921505, decouple_loss:0.0006296529318206012
The modified gen p mean: 0.44705766439437866, gen p mean: -0.12630251049995422, mean p set: 0.44763508439064026
loss_pred:0.014223665930330753, decouple_loss:0.0005408392753452063
The modified gen p mean: 0.4489278197288513, gen p mean: -0.12663161754608154, mean p set: 0.4495067000389099
loss_pred:0.013601095415651798, decouple_loss:0.0005007366999052465
Iteration: 985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828322529792786, gen p mean: -0.1262977570295334, mean p set: 0.4488586187362671
loss_pred:0.014426318928599358, decouple_loss:0.0005959040718153119
The modified gen p mean: 0.447217732667923, gen p mean: -0.12476639449596405, mean p set: 0.4477945566177368
loss_pred:0.014855328015983105, decouple_loss:0.0006550268153659999
The modified gen p mean: 0.4475882649421692, gen p mean: -0.12735594809055328, mean p set: 0.44816192984580994
loss_pred:0.014130914583802223, decouple_loss:0.0005625729681923985
Iteration: 986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470207691192627, gen p mean: -0.1253521591424942, mean p set: 0.44759488105773926
loss_pred:0.015297328121960163, decouple_loss:0.0005572566296905279
The modified gen p mean: 0.44752320647239685, gen p mean: -0.1289336234331131, mean p set: 0.4481014907360077
loss_pred:0.014493254944682121, decouple_loss:0.0007336155395023525
The modified gen p mean: 0.44855448603630066, gen p mean: -0.12828204035758972, mean p set: 0.449133038520813
loss_pred:0.014841971918940544, decouple_loss:0.000625378277618438
Iteration: 987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699469208717346, gen p mean: -0.13110215961933136, mean p set: 0.4475710391998291
loss_pred:0.014407534152269363, decouple_loss:0.0007404431235045195
The modified gen p mean: 0.4479833245277405, gen p mean: -0.12424717098474503, mean p set: 0.44856035709381104
loss_pred:0.01411067508161068, decouple_loss:0.0007274260278791189
The modified gen p mean: 0.4474065601825714, gen p mean: -0.12484206259250641, mean p set: 0.44798383116722107
loss_pred:0.01580684445798397, decouple_loss:0.0005654464475810528
Iteration: 988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486810564994812, gen p mean: -0.12334813177585602, mean p set: 0.4492571949958801
loss_pred:0.014168601483106613, decouple_loss:0.00048305391101166606
The modified gen p mean: 0.4479299783706665, gen p mean: -0.12893231213092804, mean p set: 0.4485073983669281
loss_pred:0.014446576125919819, decouple_loss:0.0006199491326697171
The modified gen p mean: 0.4482528567314148, gen p mean: -0.1271861493587494, mean p set: 0.4488280117511749
loss_pred:0.014721383340656757, decouple_loss:0.0005144580500200391
Iteration: 989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465184211730957, gen p mean: -0.12712864577770233, mean p set: 0.4470933675765991
loss_pred:0.014651897363364697, decouple_loss:0.0010026775998994708
The modified gen p mean: 0.4476347267627716, gen p mean: -0.12868143618106842, mean p set: 0.4482114315032959
loss_pred:0.014095291495323181, decouple_loss:0.0005402089445851743
The modified gen p mean: 0.44720321893692017, gen p mean: -0.12333792448043823, mean p set: 0.44777724146842957
loss_pred:0.015440232120454311, decouple_loss:0.0006238853093236685
Iteration: 990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828006625175476, gen p mean: -0.11956179141998291, mean p set: 0.4488556683063507
loss_pred:0.01493062637746334, decouple_loss:0.000615874829236418
The modified gen p mean: 0.44812649488449097, gen p mean: -0.1256369799375534, mean p set: 0.4487045109272003
The modified gen p mean: 0.4471566379070282, gen p mean: -0.12308567017316818, mean p set: 0.44773516058921814
loss_pred:0.014316543005406857, decouple_loss:0.0007805402274243534
loss_pred:0.015309514477849007, decouple_loss:0.0007685089949518442
2023-05-01 19:16:09 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1280234307050705, mean p set: 0.4502691626548767
loss_pred:0.017069358378648758, decouple_loss:0.0006576744490303099
The modified gen p mean: 0.44953328371047974, gen p mean: -0.12250254303216934, mean p set: 0.4500633478164673
loss_pred:0.016423510387539864, decouple_loss:0.0006060547893866897
The modified gen p mean: 0.44978225231170654, gen p mean: -0.12247602641582489, mean p set: 0.45035696029663086
loss_pred:0.016755905002355576, decouple_loss:0.0005117023829370737
WV_1_PC_1_EH_0_PS_40, loss: 0.016779182478785515, avg_mse: 0.026096152141690254
current test mse: 0.026096
Iteration: 991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896578788757324, gen p mean: -0.12262218445539474, mean p set: 0.4495420455932617
The modified gen p mean: 0.44850417971611023, gen p mean: -0.12034279853105545, mean p set: 0.4490780532360077
loss_pred:0.01393051166087389, decouple_loss:0.0005186020280234516
loss_pred:0.0143858902156353, decouple_loss:0.0007629830506630242The modified gen p mean: 0.4492204487323761, gen p mean: -0.11933211982250214, mean p set: 0.4497953951358795
loss_pred:0.014510277658700943, decouple_loss:0.0006372281932272017
Iteration: 992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480096697807312, gen p mean: -0.12815041840076447, mean p set: 0.4485870599746704
The modified gen p mean: 0.44785627722740173, gen p mean: -0.1311367303133011, mean p set: 0.44843214750289917
loss_pred:0.014109939336776733, decouple_loss:0.0006301907123997808
loss_pred:0.014342068694531918, decouple_loss:0.0005859309458173811
The modified gen p mean: 0.4483650326728821, gen p mean: -0.12759828567504883, mean p set: 0.44894084334373474
loss_pred:0.01453496515750885, decouple_loss:0.0005410367157310247
Iteration: 993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472658634185791, gen p mean: -0.11934152990579605, mean p set: 0.44784268736839294
loss_pred:0.015641504898667336, decouple_loss:0.0008850893937051296
The modified gen p mean: 0.44717535376548767, gen p mean: -0.11398008465766907, mean p set: 0.4477514326572418
loss_pred:0.01529864501208067, decouple_loss:0.0009032386005856097
The modified gen p mean: 0.44720467925071716, gen p mean: -0.12137322127819061, mean p set: 0.4477807283401489
loss_pred:0.015013735741376877, decouple_loss:0.0008077661623246968
Iteration: 994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471935033798218, gen p mean: -0.13801288604736328, mean p set: 0.44776979088783264
loss_pred:0.01431118231266737, decouple_loss:0.001212337170727551
The modified gen p mean: 0.4482813775539398, gen p mean: -0.12908083200454712, mean p set: 0.4488582909107208
loss_pred:0.015138035640120506, decouple_loss:0.0008671561372466385
The modified gen p mean: 0.4483325183391571, gen p mean: -0.1362117975950241, mean p set: 0.4489099383354187
loss_pred:0.014190677553415298, decouple_loss:0.0009273907053284347
Iteration: 995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484768211841583, gen p mean: -0.13613973557949066, mean p set: 0.44905373454093933
loss_pred:0.015969449654221535, decouple_loss:0.000680495286360383
The modified gen p mean: 0.44802722334861755, gen p mean: -0.14302800595760345, mean p set: 0.44860297441482544
loss_pred:0.015295098535716534, decouple_loss:0.0008364635286852717
The modified gen p mean: 0.44807884097099304, gen p mean: -0.13889141380786896, mean p set: 0.44865697622299194
loss_pred:0.015764111652970314, decouple_loss:0.000607242516707629
Iteration: 996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480603337287903, gen p mean: -0.1213776096701622, mean p set: 0.4486351013183594
loss_pred:0.016150061041116714, decouple_loss:0.0008519125985912979
The modified gen p mean: 0.44742193818092346, gen p mean: -0.12126211076974869, mean p set: 0.4479990005493164
The modified gen p mean: 0.44786402583122253, gen p mean: -0.12902270257472992, mean p set: 0.44844159483909607
loss_pred:0.015799347311258316, decouple_loss:0.0006648910348303616
loss_pred:0.015916474163532257, decouple_loss:0.0007713183294981718
Iteration: 997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44726523756980896, gen p mean: -0.10999206453561783, mean p set: 0.44784215092658997
loss_pred:0.016398513689637184, decouple_loss:0.0009562802733853459
The modified gen p mean: 0.44793424010276794, gen p mean: -0.11140729486942291, mean p set: 0.4485081434249878
loss_pred:0.017148686572909355, decouple_loss:0.0006679342477582395
The modified gen p mean: 0.44840413331985474, gen p mean: -0.12173119932413101, mean p set: 0.4489799737930298
loss_pred:0.017128344625234604, decouple_loss:0.0008872357429936528
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012009_3_24hr.npz
NaN value num: 0
Iteration: 998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504965543746948, gen p mean: -0.10582556575536728, mean p set: 0.4510754346847534
The modified gen p mean: 0.45150595903396606, gen p mean: -0.10203162580728531, mean p set: 0.4520801901817322
loss_pred:0.01725921221077442, decouple_loss:0.0009334188653156161
loss_pred:0.017805742099881172, decouple_loss:0.0009041514713317156
The modified gen p mean: 0.4514053165912628, gen p mean: -0.10642565786838531, mean p set: 0.4519835412502289
loss_pred:0.01722319796681404, decouple_loss:0.0008911537006497383
Iteration: 999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497263431549072, gen p mean: -0.10033456981182098, mean p set: 0.4503021836280823
loss_pred:0.017652522772550583, decouple_loss:0.0007565135601907969
The modified gen p mean: 0.4506111443042755, gen p mean: -0.09629441052675247, mean p set: 0.4511864483356476
The modified gen p mean: 0.45043352246284485, gen p mean: -0.10444997251033783, mean p set: 0.4510097801685333
loss_pred:0.018360067158937454, decouple_loss:0.0007587292930111289
loss_pred:0.017380665987730026, decouple_loss:0.0007415007567033172
Iteration: 1000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191341638565063, gen p mean: -0.10534302145242691, mean p set: 0.45249274373054504
loss_pred:0.018908638507127762, decouple_loss:0.0008117057150229812
The modified gen p mean: 0.4533097743988037, gen p mean: -0.10639055073261261, mean p set: 0.45388877391815186
The modified gen p mean: 0.4506884515285492, gen p mean: -0.10336019098758698, mean p set: 0.45126447081565857
loss_pred:0.01847677119076252, decouple_loss:0.0006686252309009433
loss_pred:0.017346033826470375, decouple_loss:0.0007129953592084348
2023-05-01 19:18:54 itr: 1000
training loss: [0.01738168 0.01894922 0.0185102 ]
2023-05-01 19:18:54 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.12565654516220093, mean p set: 0.4502691626548767
loss_pred:0.018957288935780525, decouple_loss:0.0008186872582882643
The modified gen p mean: 0.44953426718711853, gen p mean: -0.12027691304683685, mean p set: 0.4500633478164673
loss_pred:0.018405470997095108, decouple_loss:0.0012379417894408107
The modified gen p mean: 0.449781596660614, gen p mean: -0.12054393440485, mean p set: 0.45035696029663086
loss_pred:0.018550490960478783, decouple_loss:0.0010572598548606038
WV_1_PC_1_EH_0_PS_40, loss: 0.018689647316932678, avg_mse: 0.029181208461523056
current test mse: 0.029181
Iteration: 1001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515319764614105, gen p mean: -0.11110874265432358, mean p set: 0.452106237411499
loss_pred:0.01751239225268364, decouple_loss:0.0010631633922457695
The modified gen p mean: 0.45129823684692383, gen p mean: -0.11576979607343674, mean p set: 0.45187628269195557The modified gen p mean: 0.4523577094078064, gen p mean: -0.11064562201499939, mean p set: 0.45293283462524414
loss_pred:0.01746741682291031, decouple_loss:0.001164175570011139loss_pred:0.017721405252814293, decouple_loss:0.000734624220058322
Iteration: 1002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45190736651420593, gen p mean: -0.110943503677845, mean p set: 0.4524848163127899
loss_pred:0.016703102737665176, decouple_loss:0.0010819023009389639
The modified gen p mean: 0.45001420378685, gen p mean: -0.11420808732509613, mean p set: 0.4505898058414459The modified gen p mean: 0.4505980610847473, gen p mean: -0.10617686808109283, mean p set: 0.45117807388305664
loss_pred:0.01713152416050434, decouple_loss:0.0011768399272114038
loss_pred:0.016722386702895164, decouple_loss:0.0007259364938363433
Iteration: 1003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511561095714569, gen p mean: -0.10185203701257706, mean p set: 0.451731413602829
loss_pred:0.017867466434836388, decouple_loss:0.001166176749393344
The modified gen p mean: 0.4484143555164337, gen p mean: -0.10553402453660965, mean p set: 0.44899213314056396
loss_pred:0.01645498536527157, decouple_loss:0.0008327632676810026
The modified gen p mean: 0.4505978524684906, gen p mean: -0.10754922032356262, mean p set: 0.45117560029029846
loss_pred:0.015694310888648033, decouple_loss:0.0008128670160658658
Iteration: 1004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45233187079429626, gen p mean: -0.10974089056253433, mean p set: 0.452907919883728
loss_pred:0.017121832817792892, decouple_loss:0.0011151207145303488
The modified gen p mean: 0.44931960105895996, gen p mean: -0.10946860164403915, mean p set: 0.4498981535434723
loss_pred:0.016388684511184692, decouple_loss:0.000782345945481211
The modified gen p mean: 0.44981634616851807, gen p mean: -0.10714127868413925, mean p set: 0.45039525628089905
loss_pred:0.016857929527759552, decouple_loss:0.0008792533189989626
Iteration: 1005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490281343460083, gen p mean: -0.09756945073604584, mean p set: 0.44960349798202515
loss_pred:0.01675683632493019, decouple_loss:0.0008243640186265111
The modified gen p mean: 0.4509769082069397, gen p mean: -0.097489133477211, mean p set: 0.4515541195869446
loss_pred:0.016433820128440857, decouple_loss:0.0009347415762022138
The modified gen p mean: 0.4518377184867859, gen p mean: -0.09744825214147568, mean p set: 0.4524140954017639
loss_pred:0.016802622005343437, decouple_loss:0.0010759637225419283
Iteration: 1006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515295624732971, gen p mean: -0.10576440393924713, mean p set: 0.45210859179496765
loss_pred:0.016889022663235664, decouple_loss:0.0007713902159593999
The modified gen p mean: 0.4529806971549988, gen p mean: -0.10019928961992264, mean p set: 0.45355916023254395
loss_pred:0.016962727531790733, decouple_loss:0.0007529145805165172
The modified gen p mean: 0.4524705111980438, gen p mean: -0.10351146012544632, mean p set: 0.45304831862449646
loss_pred:0.017338169738650322, decouple_loss:0.0008583953022025526
Iteration: 1007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482874274253845, gen p mean: -0.09802480787038803, mean p set: 0.4488649070262909
loss_pred:0.016383927315473557, decouple_loss:0.0008553062798455358
The modified gen p mean: 0.4511071741580963, gen p mean: -0.09144369512796402, mean p set: 0.4516826570034027
loss_pred:0.017135262489318848, decouple_loss:0.0007186608854681253
The modified gen p mean: 0.4517911374568939, gen p mean: -0.08987756073474884, mean p set: 0.45236828923225403
loss_pred:0.017736176028847694, decouple_loss:0.0007487481343559921
Iteration: 1008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509797990322113, gen p mean: -0.10249267518520355, mean p set: 0.4515576958656311
loss_pred:0.016551049426198006, decouple_loss:0.000699028663802892
The modified gen p mean: 0.45142337679862976, gen p mean: -0.10761161893606186, mean p set: 0.45199936628341675
loss_pred:0.017699386924505234, decouple_loss:0.0008263895288109779
The modified gen p mean: 0.4522090554237366, gen p mean: -0.10764571279287338, mean p set: 0.45278817415237427
loss_pred:0.017849482595920563, decouple_loss:0.0007760055013932288
Iteration: 1009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512059688568115, gen p mean: -0.11877802014350891, mean p set: 0.4517843425273895
loss_pred:0.018772562965750694, decouple_loss:0.00079597212607041
The modified gen p mean: 0.4510553777217865, gen p mean: -0.12353522330522537, mean p set: 0.4516323506832123
The modified gen p mean: 0.45104533433914185, gen p mean: -0.11964970082044601, mean p set: 0.4516221284866333
loss_pred:0.016935860738158226, decouple_loss:0.0008747329120524228
loss_pred:0.016284314915537834, decouple_loss:0.0008003479451872408
Iteration: 1010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024675130844116, gen p mean: -0.1327429860830307, mean p set: 0.45082327723503113
loss_pred:0.016967056319117546, decouple_loss:0.0008171867812052369
The modified gen p mean: 0.4508405327796936, gen p mean: -0.12118817865848541, mean p set: 0.45141345262527466
loss_pred:0.01756412908434868, decouple_loss:0.0007890421547926962
The modified gen p mean: 0.451384961605072, gen p mean: -0.12280403077602386, mean p set: 0.4519629180431366
loss_pred:0.015694458037614822, decouple_loss:0.0008400718215852976
2023-05-01 19:21:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.15034160017967224, mean p set: 0.4502691626548767
loss_pred:0.018127011135220528, decouple_loss:0.0007186330622062087
The modified gen p mean: 0.44953984022140503, gen p mean: -0.14520104229450226, mean p set: 0.4500633478164673
loss_pred:0.017517654225230217, decouple_loss:0.0008308977703563869
The modified gen p mean: 0.4497855007648468, gen p mean: -0.14452365040779114, mean p set: 0.45035696029663086
loss_pred:0.017654096707701683, decouple_loss:0.0007616484072059393
WV_1_PC_1_EH_0_PS_40, loss: 0.01780477538704872, avg_mse: 0.027753356844186783
current test mse: 0.027753
Iteration: 1011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45120149850845337, gen p mean: -0.13898244500160217, mean p set: 0.4517787992954254
loss_pred:0.01621589995920658, decouple_loss:0.0006569005781784654
The modified gen p mean: 0.44946572184562683, gen p mean: -0.1349683552980423, mean p set: 0.45004045963287354The modified gen p mean: 0.450972318649292, gen p mean: -0.1390862911939621, mean p set: 0.4515494108200073
loss_pred:0.01617218740284443, decouple_loss:0.0007894784212112427
loss_pred:0.016144100576639175, decouple_loss:0.0008419185760430992
Iteration: 1012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508838355541229, gen p mean: -0.13007406890392303, mean p set: 0.45146021246910095
loss_pred:0.016660552471876144, decouple_loss:0.0008441826794296503
The modified gen p mean: 0.45018962025642395, gen p mean: -0.1340002417564392, mean p set: 0.4507656991481781The modified gen p mean: 0.4535112977027893, gen p mean: -0.12958937883377075, mean p set: 0.45408543944358826
loss_pred:0.01747305504977703, decouple_loss:0.0009550358518026769
loss_pred:0.01662088744342327, decouple_loss:0.0008289850084111094
Iteration: 1013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45176345109939575, gen p mean: -0.13237056136131287, mean p set: 0.45234063267707825
loss_pred:0.017779599875211716, decouple_loss:0.0007776923011988401
The modified gen p mean: 0.45070698857307434, gen p mean: -0.12637843191623688, mean p set: 0.4512827396392822
loss_pred:0.016669986769557, decouple_loss:0.0007973504834808409
The modified gen p mean: 0.4508069157600403, gen p mean: -0.1286460906267166, mean p set: 0.45138245820999146
loss_pred:0.01677648164331913, decouple_loss:0.0008888646261766553
Iteration: 1014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449239581823349, gen p mean: -0.13666337728500366, mean p set: 0.44981685280799866
loss_pred:0.015902962535619736, decouple_loss:0.0009492456447333097
The modified gen p mean: 0.4510592520236969, gen p mean: -0.13617441058158875, mean p set: 0.45163723826408386
loss_pred:0.016846174374222755, decouple_loss:0.0009269675356335938
The modified gen p mean: 0.45061996579170227, gen p mean: -0.13602827489376068, mean p set: 0.4511964023113251
loss_pred:0.016428440809249878, decouple_loss:0.0009675964247435331
Iteration: 1015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505736827850342, gen p mean: -0.13904528319835663, mean p set: 0.4511508643627167
loss_pred:0.01639954373240471, decouple_loss:0.0007891355198808014
The modified gen p mean: 0.45137298107147217, gen p mean: -0.131196066737175, mean p set: 0.4519501030445099
loss_pred:0.01603730022907257, decouple_loss:0.0009713554754853249
The modified gen p mean: 0.4495479166507721, gen p mean: -0.13435713946819305, mean p set: 0.4501255452632904
loss_pred:0.015880145132541656, decouple_loss:0.0007954072207212448
Iteration: 1016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502274692058563, gen p mean: -0.12598872184753418, mean p set: 0.45080307126045227
loss_pred:0.016368484124541283, decouple_loss:0.0006822276627644897
The modified gen p mean: 0.45134982466697693, gen p mean: -0.12209013104438782, mean p set: 0.4519265294075012
loss_pred:0.01695815660059452, decouple_loss:0.000810515892226249
The modified gen p mean: 0.4498095214366913, gen p mean: -0.12732185423374176, mean p set: 0.4503856897354126
loss_pred:0.016713863238692284, decouple_loss:0.00063559744739905
Iteration: 1017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502177834510803, gen p mean: -0.1273077130317688, mean p set: 0.450794517993927
loss_pred:0.015810411423444748, decouple_loss:0.0009776543593034148
The modified gen p mean: 0.4493287205696106, gen p mean: -0.12015245109796524, mean p set: 0.44990551471710205
loss_pred:0.015522211790084839, decouple_loss:0.0007962986710481346
The modified gen p mean: 0.45187026262283325, gen p mean: -0.11704156547784805, mean p set: 0.4524483382701874
loss_pred:0.017149928957223892, decouple_loss:0.0009000530117191374
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012007_3_24hr.npz
NaN value num: 0
Iteration: 1018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516074061393738, gen p mean: -0.11881714314222336, mean p set: 0.4521867632865906
loss_pred:0.016078226268291473, decouple_loss:0.0007921528886072338
The modified gen p mean: 0.44992342591285706, gen p mean: -0.1292879283428192, mean p set: 0.45049911737442017
The modified gen p mean: 0.45055946707725525, gen p mean: -0.1254807859659195, mean p set: 0.45113492012023926
loss_pred:0.016757505014538765, decouple_loss:0.0009065984049811959
loss_pred:0.01739368960261345, decouple_loss:0.0008468604064546525
Iteration: 1019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45136794447898865, gen p mean: -0.1191660463809967, mean p set: 0.45194417238235474
loss_pred:0.016656266525387764, decouple_loss:0.0007429067045450211
The modified gen p mean: 0.45229101181030273, gen p mean: -0.11732377856969833, mean p set: 0.4528714418411255
loss_pred:0.016288673505187035, decouple_loss:0.0009744808776304126
The modified gen p mean: 0.4511364996433258, gen p mean: -0.11871132254600525, mean p set: 0.45171278715133667
loss_pred:0.01663372665643692, decouple_loss:0.0007199237588793039
Iteration: 1020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45138102769851685, gen p mean: -0.11899783462285995, mean p set: 0.4519573748111725
loss_pred:0.01605050265789032, decouple_loss:0.0011782185174524784
The modified gen p mean: 0.4497872591018677, gen p mean: -0.1134525015950203, mean p set: 0.4503606855869293
The modified gen p mean: 0.4502941370010376, gen p mean: -0.11562283337116241, mean p set: 0.45086869597435
loss_pred:0.017646245658397675, decouple_loss:0.0011241368483752012
loss_pred:0.017056509852409363, decouple_loss:0.0010080494685098529
2023-05-01 19:23:55 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12971846759319305, mean p set: 0.4502691626548767
loss_pred:0.017584702000021935, decouple_loss:0.0008094809600152075
The modified gen p mean: 0.44978034496307373, gen p mean: -0.12395890802145004, mean p set: 0.45035696029663086
loss_pred:0.017002221196889877, decouple_loss:0.0006863853777758777
The modified gen p mean: 0.4495372474193573, gen p mean: -0.12408804148435593, mean p set: 0.4500633478164673
loss_pred:0.016874128952622414, decouple_loss:0.0007780815358273685
WV_1_PC_1_EH_0_PS_40, loss: 0.017191585153341293, avg_mse: 0.02666909620165825
current test mse: 0.026669
Iteration: 1021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44832849502563477, gen p mean: -0.12275012582540512, mean p set: 0.44890692830085754
loss_pred:0.017164796590805054, decouple_loss:0.000802722352091223
The modified gen p mean: 0.4516254663467407, gen p mean: -0.12040924280881882, mean p set: 0.452201247215271
loss_pred:0.016731685027480125, decouple_loss:0.0008590915240347385
The modified gen p mean: 0.4527578353881836, gen p mean: -0.1216760128736496, mean p set: 0.45333370566368103
loss_pred:0.016587838530540466, decouple_loss:0.0007616100483573973
Iteration: 1022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492990970611572, gen p mean: -0.1240512952208519, mean p set: 0.44987502694129944
loss_pred:0.016697818413376808, decouple_loss:0.001123579335398972
The modified gen p mean: 0.4515332877635956, gen p mean: -0.11475658416748047, mean p set: 0.4521104097366333The modified gen p mean: 0.45242083072662354, gen p mean: -0.1250976324081421, mean p set: 0.45299920439720154
loss_pred:0.015527530573308468, decouple_loss:0.0006941682077012956
loss_pred:0.016234714537858963, decouple_loss:0.0008698073797859251
Iteration: 1023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114827156066895, gen p mean: -0.11902652680873871, mean p set: 0.4517273008823395
loss_pred:0.016258230432868004, decouple_loss:0.001012197113595903
The modified gen p mean: 0.4494815468788147, gen p mean: -0.12103014439344406, mean p set: 0.45005589723587036
loss_pred:0.016659853979945183, decouple_loss:0.0007875072187744081
The modified gen p mean: 0.45037394762039185, gen p mean: -0.11460903286933899, mean p set: 0.45095011591911316
loss_pred:0.01615048572421074, decouple_loss:0.0008395721088163555
Iteration: 1024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45167115330696106, gen p mean: -0.12481900304555893, mean p set: 0.45224812626838684
loss_pred:0.015142149291932583, decouple_loss:0.0007706160540692508
The modified gen p mean: 0.45438310503959656, gen p mean: -0.12446323037147522, mean p set: 0.45496177673339844
loss_pred:0.01647859439253807, decouple_loss:0.0011246221838518977
The modified gen p mean: 0.45072680711746216, gen p mean: -0.11778312921524048, mean p set: 0.4513033628463745
loss_pred:0.01600734144449234, decouple_loss:0.001130290562286973
Iteration: 1025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147401094436646, gen p mean: -0.12352961301803589, mean p set: 0.4520516097545624
The modified gen p mean: 0.45122382044792175, gen p mean: -0.123019278049469, mean p set: 0.4517989158630371
loss_pred:0.0155410747975111, decouple_loss:0.0008535247179679573
loss_pred:0.016344916075468063, decouple_loss:0.0009249775321222842
The modified gen p mean: 0.4544801712036133, gen p mean: -0.12735435366630554, mean p set: 0.4550555646419525
loss_pred:0.015541864559054375, decouple_loss:0.0010895502055063844
Iteration: 1026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517289400100708, gen p mean: -0.12960736453533173, mean p set: 0.45230618119239807
loss_pred:0.016804274171590805, decouple_loss:0.0007807087386026978
The modified gen p mean: 0.45021820068359375, gen p mean: -0.1312180757522583, mean p set: 0.45079267024993896
loss_pred:0.016071658581495285, decouple_loss:0.0010755762923508883
The modified gen p mean: 0.45139700174331665, gen p mean: -0.12815514206886292, mean p set: 0.45197439193725586
loss_pred:0.016187801957130432, decouple_loss:0.0008005650015547872
Iteration: 1027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498406946659088, gen p mean: -0.12197428941726685, mean p set: 0.450419545173645
loss_pred:0.017328117042779922, decouple_loss:0.0009915294358506799
The modified gen p mean: 0.4533814489841461, gen p mean: -0.12601345777511597, mean p set: 0.4539616107940674
loss_pred:0.01638728938996792, decouple_loss:0.0007273022783920169
The modified gen p mean: 0.4496074318885803, gen p mean: -0.12699545919895172, mean p set: 0.4501844644546509
loss_pred:0.016476156190037727, decouple_loss:0.0010356601560488343
Iteration: 1028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45338842272758484, gen p mean: -0.12782184779644012, mean p set: 0.4539635181427002
loss_pred:0.016176916658878326, decouple_loss:0.00078691600356251
The modified gen p mean: 0.4483688175678253, gen p mean: -0.12986765801906586, mean p set: 0.4489463269710541
loss_pred:0.01596824824810028, decouple_loss:0.0008391296723857522
The modified gen p mean: 0.45092326402664185, gen p mean: -0.12467677891254425, mean p set: 0.45149728655815125
loss_pred:0.017532996833324432, decouple_loss:0.0008548827026970685
Iteration: 1029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45151448249816895, gen p mean: -0.12980958819389343, mean p set: 0.4520919919013977
loss_pred:0.016151221469044685, decouple_loss:0.0006272548343986273
The modified gen p mean: 0.4550637900829315, gen p mean: -0.13031648099422455, mean p set: 0.45564278960227966
loss_pred:0.0156414695084095, decouple_loss:0.0007485190872102976
The modified gen p mean: 0.45178908109664917, gen p mean: -0.1274253875017166, mean p set: 0.4523661732673645
loss_pred:0.01637916825711727, decouple_loss:0.0006654384196735919
Iteration: 1030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45208391547203064, gen p mean: -0.13035821914672852, mean p set: 0.45266276597976685
loss_pred:0.015910163521766663, decouple_loss:0.0008819187642075121
The modified gen p mean: 0.45000749826431274, gen p mean: -0.12196996062994003, mean p set: 0.4505843222141266
loss_pred:0.017190339043736458, decouple_loss:0.0008800172945484519
The modified gen p mean: 0.45169246196746826, gen p mean: -0.12878577411174774, mean p set: 0.452269583940506
loss_pred:0.01600688137114048, decouple_loss:0.0007864198414608836
2023-05-01 19:26:02 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1298084557056427, mean p set: 0.4502691626548767
loss_pred:0.017432907596230507, decouple_loss:0.0009052371024154127
The modified gen p mean: 0.44953441619873047, gen p mean: -0.12367894500494003, mean p set: 0.4500633478164673
loss_pred:0.016790425404906273, decouple_loss:0.0008164101163856685
The modified gen p mean: 0.44977930188179016, gen p mean: -0.1236862987279892, mean p set: 0.45035696029663086
loss_pred:0.016885917633771896, decouple_loss:0.0006098089506849647
WV_1_PC_1_EH_0_PS_40, loss: 0.017075274139642715, avg_mse: 0.02651241235435009
current test mse: 0.026512
Iteration: 1031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495122730731964, gen p mean: -0.1257472038269043, mean p set: 0.4500890374183655
loss_pred:0.016602035611867905, decouple_loss:0.000677076808642596
The modified gen p mean: 0.4518747627735138, gen p mean: -0.11929990351200104, mean p set: 0.45245081186294556
loss_pred:0.016273435205221176, decouple_loss:0.0006591603741981089
The modified gen p mean: 0.45043858885765076, gen p mean: -0.12052954733371735, mean p set: 0.45101335644721985
loss_pred:0.016600245609879494, decouple_loss:0.000687643769197166
Iteration: 1032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163655281066895, gen p mean: -0.11716310679912567, mean p set: 0.45221641659736633
loss_pred:0.01588604226708412, decouple_loss:0.0007517461199313402
The modified gen p mean: 0.45088425278663635, gen p mean: -0.11266893893480301, mean p set: 0.4514580965042114The modified gen p mean: 0.4511561095714569, gen p mean: -0.11514002829790115, mean p set: 0.45173338055610657
loss_pred:0.016171306371688843, decouple_loss:0.0009549034875817597
loss_pred:0.01602335274219513, decouple_loss:0.00101237662602216
Iteration: 1033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109236240386963, gen p mean: -0.11702039837837219, mean p set: 0.4516713619232178
loss_pred:0.01595885306596756, decouple_loss:0.0009594435687176883
The modified gen p mean: 0.4529184103012085, gen p mean: -0.1162342056632042, mean p set: 0.4534992575645447
loss_pred:0.016290010884404182, decouple_loss:0.0007926951511763036
The modified gen p mean: 0.4502733647823334, gen p mean: -0.11251188814640045, mean p set: 0.45084720849990845
loss_pred:0.016040083020925522, decouple_loss:0.0008860972593538463
Iteration: 1034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938528537750244, gen p mean: -0.1255551427602768, mean p set: 0.44996097683906555
loss_pred:0.01579911820590496, decouple_loss:0.0007616368238814175
The modified gen p mean: 0.45000001788139343, gen p mean: -0.12713399529457092, mean p set: 0.450576514005661
loss_pred:0.015481093898415565, decouple_loss:0.0007480854983441532
The modified gen p mean: 0.451871782541275, gen p mean: -0.12421886622905731, mean p set: 0.45244714617729187
loss_pred:0.015600262209773064, decouple_loss:0.0006425312021747231
Iteration: 1035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4531010389328003, gen p mean: -0.1256694197654724, mean p set: 0.4536796808242798
loss_pred:0.01700923964381218, decouple_loss:0.0008388331043533981
The modified gen p mean: 0.4512169361114502, gen p mean: -0.1235399916768074, mean p set: 0.45179659128189087
loss_pred:0.01630989834666252, decouple_loss:0.0014162795851007104
The modified gen p mean: 0.4499891698360443, gen p mean: -0.12076142430305481, mean p set: 0.45056599378585815
loss_pred:0.017178921028971672, decouple_loss:0.0010013392893597484
Iteration: 1036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507150650024414, gen p mean: -0.12228035181760788, mean p set: 0.45129111409187317
The modified gen p mean: 0.4501180648803711, gen p mean: -0.1265261024236679, mean p set: 0.4506944417953491
loss_pred:0.01668357290327549, decouple_loss:0.0008922248962335289
loss_pred:0.016044393181800842, decouple_loss:0.0009237824124284089
The modified gen p mean: 0.45039185881614685, gen p mean: -0.12094052881002426, mean p set: 0.45096486806869507
loss_pred:0.01730668917298317, decouple_loss:0.0007596818613819778
Iteration: 1037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493221938610077, gen p mean: -0.12089788913726807, mean p set: 0.44990074634552
loss_pred:0.01624724082648754, decouple_loss:0.0006734131020493805
The modified gen p mean: 0.4499815106391907, gen p mean: -0.12459781765937805, mean p set: 0.4505594074726105
loss_pred:0.015955520793795586, decouple_loss:0.0006020460277795792
The modified gen p mean: 0.4517090320587158, gen p mean: -0.11607473343610764, mean p set: 0.4522860050201416
loss_pred:0.015933837741613388, decouple_loss:0.0007685322780162096
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012006_3_24hr.npz
NaN value num: 0
Iteration: 1038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784238934516907, gen p mean: -0.1182713657617569, mean p set: 0.44841691851615906
loss_pred:0.014632896520197392, decouple_loss:0.0005527418106794357
The modified gen p mean: 0.44875285029411316, gen p mean: -0.12074010819196701, mean p set: 0.44932955503463745
The modified gen p mean: 0.4482606053352356, gen p mean: -0.12601105868816376, mean p set: 0.44883859157562256
loss_pred:0.015610001049935818, decouple_loss:0.0008773668087087572
loss_pred:0.01472153514623642, decouple_loss:0.0007327204220928252
Iteration: 1039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791096448898315, gen p mean: -0.12217625975608826, mean p set: 0.4484882652759552
loss_pred:0.01497891265898943, decouple_loss:0.0007162908441387117
The modified gen p mean: 0.4490432143211365, gen p mean: -0.11726121604442596, mean p set: 0.4496217370033264
loss_pred:0.014579564332962036, decouple_loss:0.000661941827274859
The modified gen p mean: 0.44759273529052734, gen p mean: -0.1143488734960556, mean p set: 0.4481671154499054
loss_pred:0.015229640528559685, decouple_loss:0.0009926031343638897
Iteration: 1040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44789332151412964, gen p mean: -0.1228543221950531, mean p set: 0.448469340801239
loss_pred:0.015209132805466652, decouple_loss:0.0006275091436691582
The modified gen p mean: 0.4490823447704315, gen p mean: -0.1204586774110794, mean p set: 0.44965940713882446
loss_pred:0.014543922618031502, decouple_loss:0.0005161957233212888
The modified gen p mean: 0.44751420617103577, gen p mean: -0.11400176584720612, mean p set: 0.4480898678302765
loss_pred:0.015427148900926113, decouple_loss:0.0008212157990783453
2023-05-01 19:28:43 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12189158797264099, mean p set: 0.4502691626548767
loss_pred:0.017225192859768867, decouple_loss:0.0009909284999594092
The modified gen p mean: 0.4495331943035126, gen p mean: -0.11603157967329025, mean p set: 0.4500633478164673
loss_pred:0.016595987603068352, decouple_loss:0.0010974620236083865
The modified gen p mean: 0.4497782289981842, gen p mean: -0.11595474183559418, mean p set: 0.45035696029663086
loss_pred:0.016868336126208305, decouple_loss:0.0008648352813906968
WV_1_PC_1_EH_0_PS_40, loss: 0.016945727169513702, avg_mse: 0.02636985294520855
current test mse: 0.02637
Iteration: 1041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473484754562378, gen p mean: -0.12169115245342255, mean p set: 0.4479256868362427
loss_pred:0.015263729728758335, decouple_loss:0.0009439557907171547
The modified gen p mean: 0.4483112692832947, gen p mean: -0.12309007346630096, mean p set: 0.4488871097564697
The modified gen p mean: 0.448620468378067, gen p mean: -0.10994070023298264, mean p set: 0.44919553399086
loss_pred:0.01513525377959013, decouple_loss:0.0009967935038730502loss_pred:0.015280192717909813, decouple_loss:0.0010169947054237127
Iteration: 1042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44886285066604614, gen p mean: -0.117693230509758, mean p set: 0.44943690299987793
loss_pred:0.014945571310818195, decouple_loss:0.0009878664277493954
The modified gen p mean: 0.4477258324623108, gen p mean: -0.11474446952342987, mean p set: 0.44830384850502014The modified gen p mean: 0.44866424798965454, gen p mean: -0.1173839345574379, mean p set: 0.4492400586605072
loss_pred:0.014486060477793217, decouple_loss:0.0009878647979348898
loss_pred:0.015998518094420433, decouple_loss:0.0007992571336217225
Iteration: 1043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448492169380188, gen p mean: -0.11570168286561966, mean p set: 0.4490686058998108
loss_pred:0.015474917367100716, decouple_loss:0.0007299190037883818
The modified gen p mean: 0.4486815631389618, gen p mean: -0.11294634640216827, mean p set: 0.4492567181587219
loss_pred:0.01539444737136364, decouple_loss:0.0008760849013924599
The modified gen p mean: 0.4483182728290558, gen p mean: -0.11808531731367111, mean p set: 0.4488929510116577
loss_pred:0.015280216932296753, decouple_loss:0.0007991828606463969
Iteration: 1044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478254020214081, gen p mean: -0.11161808669567108, mean p set: 0.44840162992477417
loss_pred:0.014447871595621109, decouple_loss:0.0007637201342731714
The modified gen p mean: 0.44849032163619995, gen p mean: -0.11771107465028763, mean p set: 0.4490663409233093
loss_pred:0.014822895638644695, decouple_loss:0.0007875932496972382
The modified gen p mean: 0.44832703471183777, gen p mean: -0.11362149566411972, mean p set: 0.4489034116268158
loss_pred:0.014942222274839878, decouple_loss:0.0006612187717109919
Iteration: 1045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447381854057312, gen p mean: -0.11882933974266052, mean p set: 0.4479579031467438
loss_pred:0.015251381322741508, decouple_loss:0.0011162053560838103
The modified gen p mean: 0.44842249155044556, gen p mean: -0.1204332783818245, mean p set: 0.44900044798851013
loss_pred:0.014596949331462383, decouple_loss:0.0009524055640213192
The modified gen p mean: 0.44777175784111023, gen p mean: -0.11665861308574677, mean p set: 0.44834965467453003
loss_pred:0.0158251840621233, decouple_loss:0.0009067613282240927
Iteration: 1046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480848014354706, gen p mean: -0.1177707090973854, mean p set: 0.44866296648979187
The modified gen p mean: 0.4493435025215149, gen p mean: -0.11896658688783646, mean p set: 0.44992080330848694
loss_pred:0.015465357340872288, decouple_loss:0.00095896958373487
loss_pred:0.015942009165883064, decouple_loss:0.0007866492378525436
The modified gen p mean: 0.448726087808609, gen p mean: -0.1209712103009224, mean p set: 0.44930025935173035
loss_pred:0.01458374410867691, decouple_loss:0.0007082252413965762
Iteration: 1047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448708713054657, gen p mean: -0.11985519528388977, mean p set: 0.4492858350276947
The modified gen p mean: 0.4485887587070465, gen p mean: -0.12030061334371567, mean p set: 0.44916436076164246
loss_pred:0.01437606755644083, decouple_loss:0.0006071217358112335
loss_pred:0.014516488648951054, decouple_loss:0.0005616500275209546
The modified gen p mean: 0.44844579696655273, gen p mean: -0.12168341130018234, mean p set: 0.4490225911140442
loss_pred:0.015311569906771183, decouple_loss:0.000577061262447387
Iteration: 1048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44868090748786926, gen p mean: -0.12175654619932175, mean p set: 0.44925642013549805
The modified gen p mean: 0.4490746557712555, gen p mean: -0.12567420303821564, mean p set: 0.4496510326862335
loss_pred:0.015460996888577938, decouple_loss:0.0007098555215634406
loss_pred:0.015239614993333817, decouple_loss:0.0005802075611427426
The modified gen p mean: 0.4491315484046936, gen p mean: -0.12337696552276611, mean p set: 0.4497077465057373
loss_pred:0.014926951378583908, decouple_loss:0.000811741512734443
Iteration: 1049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483051896095276, gen p mean: -0.11376213282346725, mean p set: 0.4488828480243683
loss_pred:0.015292814932763577, decouple_loss:0.0008777151233516634
The modified gen p mean: 0.4478500187397003, gen p mean: -0.12160744518041611, mean p set: 0.4484257698059082
loss_pred:0.015229491516947746, decouple_loss:0.0007059400086291134
The modified gen p mean: 0.4488828182220459, gen p mean: -0.12018293887376785, mean p set: 0.44945937395095825
loss_pred:0.013800282962620258, decouple_loss:0.00062927434919402
Iteration: 1050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488552510738373, gen p mean: -0.11384855955839157, mean p set: 0.449429988861084
loss_pred:0.015578594990074635, decouple_loss:0.0006482740282081068
The modified gen p mean: 0.4477372467517853, gen p mean: -0.11161566525697708, mean p set: 0.4483124613761902
loss_pred:0.014525627717375755, decouple_loss:0.0005531377391889691
The modified gen p mean: 0.44913262128829956, gen p mean: -0.10790222883224487, mean p set: 0.44971105456352234
loss_pred:0.014816238544881344, decouple_loss:0.0006682042730972171
2023-05-01 19:30:50 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1153525561094284, mean p set: 0.4502691626548767
loss_pred:0.017207158729434013, decouple_loss:0.0006779498071409762
The modified gen p mean: 0.4495357573032379, gen p mean: -0.1099231019616127, mean p set: 0.4500633478164673
loss_pred:0.016601867973804474, decouple_loss:0.0005867353174835443
The modified gen p mean: 0.44978126883506775, gen p mean: -0.11002706736326218, mean p set: 0.45035696029663086
loss_pred:0.01685759797692299, decouple_loss:0.0006228885613381863
WV_1_PC_1_EH_0_PS_40, loss: 0.016920335590839386, avg_mse: 0.026279829442501068
current test mse: 0.02628
Iteration: 1051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448478639125824, gen p mean: -0.10775306820869446, mean p set: 0.44905519485473633
loss_pred:0.015033813193440437, decouple_loss:0.0006788491155020893
The modified gen p mean: 0.4477502405643463, gen p mean: -0.10864800959825516, mean p set: 0.44832542538642883
The modified gen p mean: 0.4485752582550049, gen p mean: -0.11670377850532532, mean p set: 0.449150025844574
loss_pred:0.015220209024846554, decouple_loss:0.0007394544081762433
loss_pred:0.014671439304947853, decouple_loss:0.0005603160243481398
Iteration: 1052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44934627413749695, gen p mean: -0.11170441657304764, mean p set: 0.4499247372150421
loss_pred:0.01411685161292553, decouple_loss:0.0007176560466177762
The modified gen p mean: 0.447613388299942, gen p mean: -0.1041785180568695, mean p set: 0.4481886029243469
The modified gen p mean: 0.4500991404056549, gen p mean: -0.10975566506385803, mean p set: 0.4506753385066986
loss_pred:0.01463061012327671, decouple_loss:0.0005339992349036038
loss_pred:0.014656150713562965, decouple_loss:0.0006638355553150177
Iteration: 1053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44855448603630066, gen p mean: -0.10564125329256058, mean p set: 0.44913092255592346
loss_pred:0.01477047149091959, decouple_loss:0.0006530123646371067
The modified gen p mean: 0.4484010636806488, gen p mean: -0.10899482667446136, mean p set: 0.44897738099098206
loss_pred:0.014364529401063919, decouple_loss:0.0006110339891165495
The modified gen p mean: 0.4479886293411255, gen p mean: -0.10557910054922104, mean p set: 0.4485659599304199
loss_pred:0.015084203332662582, decouple_loss:0.0007794373668730259
Iteration: 1054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44705823063850403, gen p mean: -0.1122073382139206, mean p set: 0.4476362466812134
loss_pred:0.01583070307970047, decouple_loss:0.0008587305201217532
The modified gen p mean: 0.4479847252368927, gen p mean: -0.10974810272455215, mean p set: 0.44856372475624084
loss_pred:0.014582564122974873, decouple_loss:0.0007423752103932202
The modified gen p mean: 0.44825372099876404, gen p mean: -0.11335461586713791, mean p set: 0.4488309919834137
loss_pred:0.01549132727086544, decouple_loss:0.0008417980861850083
Iteration: 1055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806623458862305, gen p mean: -0.11406970024108887, mean p set: 0.4486420452594757
loss_pred:0.015673698857426643, decouple_loss:0.0006727788713760674
The modified gen p mean: 0.4496302306652069, gen p mean: -0.11768396198749542, mean p set: 0.450207382440567
loss_pred:0.014355228282511234, decouple_loss:0.0006479597650468349
The modified gen p mean: 0.44872406125068665, gen p mean: -0.11063796281814575, mean p set: 0.44930222630500793
loss_pred:0.014917712658643723, decouple_loss:0.0007116998895071447
Iteration: 1056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987159967422485, gen p mean: -0.1193557158112526, mean p set: 0.4504498541355133
loss_pred:0.01456497423350811, decouple_loss:0.0006881646113470197
The modified gen p mean: 0.44935813546180725, gen p mean: -0.11687619984149933, mean p set: 0.44993188977241516
loss_pred:0.014883138239383698, decouple_loss:0.0010854944121092558
The modified gen p mean: 0.4480782151222229, gen p mean: -0.1213599219918251, mean p set: 0.4486553370952606
loss_pred:0.015198685228824615, decouple_loss:0.0007481619250029325
Iteration: 1057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496154487133026, gen p mean: -0.11846461147069931, mean p set: 0.45019209384918213
loss_pred:0.015288380905985832, decouple_loss:0.0007337958668358624
The modified gen p mean: 0.447521448135376, gen p mean: -0.11334706842899323, mean p set: 0.4480970501899719
loss_pred:0.014474818482995033, decouple_loss:0.0005011759931221604
The modified gen p mean: 0.44724324345588684, gen p mean: -0.1170240119099617, mean p set: 0.4478180706501007
loss_pred:0.015416989102959633, decouple_loss:0.0008031505858525634
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012017_3_24hr.npz
NaN value num: 0
Iteration: 1058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44851183891296387, gen p mean: -0.10797279328107834, mean p set: 0.44908758997917175The modified gen p mean: 0.44879820942878723, gen p mean: -0.11177914589643478, mean p set: 0.44937294721603394
loss_pred:0.016557127237319946, decouple_loss:0.000527645752299577
loss_pred:0.015539197251200676, decouple_loss:0.0006517544970847666
The modified gen p mean: 0.45004236698150635, gen p mean: -0.10966271162033081, mean p set: 0.45061951875686646
loss_pred:0.015813466161489487, decouple_loss:0.0006781885749660432
Iteration: 1059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448264479637146, gen p mean: -0.1047833189368248, mean p set: 0.4488380551338196
loss_pred:0.015449381433427334, decouple_loss:0.0009462853777222335
The modified gen p mean: 0.4502670466899872, gen p mean: -0.10207442939281464, mean p set: 0.4508443772792816
loss_pred:0.015646513551473618, decouple_loss:0.000879370782058686
The modified gen p mean: 0.4504150450229645, gen p mean: -0.10373920947313309, mean p set: 0.45099109411239624
loss_pred:0.015887878835201263, decouple_loss:0.0006186858518049121
Iteration: 1060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448423832654953, gen p mean: -0.097820945084095, mean p set: 0.4490005075931549
loss_pred:0.015511848963797092, decouple_loss:0.0006986856460571289
The modified gen p mean: 0.45046621561050415, gen p mean: -0.10539896786212921, mean p set: 0.45104461908340454
loss_pred:0.015785781666636467, decouple_loss:0.0006404419546015561
The modified gen p mean: 0.4493640065193176, gen p mean: -0.10438263416290283, mean p set: 0.44993993639945984
loss_pred:0.016669681295752525, decouple_loss:0.0005981116555631161
2023-05-01 19:33:31 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10820866376161575, mean p set: 0.4502691626548767
loss_pred:0.017243850976228714, decouple_loss:0.000599829712882638
The modified gen p mean: 0.44953492283821106, gen p mean: -0.10227541625499725, mean p set: 0.4500633478164673
loss_pred:0.016559338197112083, decouple_loss:0.0006843479932285845
The modified gen p mean: 0.4497792720794678, gen p mean: -0.10256877541542053, mean p set: 0.45035696029663086
loss_pred:0.016823934391140938, decouple_loss:0.0007122411043383181
WV_1_PC_1_EH_0_PS_40, loss: 0.016908980906009674, avg_mse: 0.026212438941001892
current test mse: 0.026212
Iteration: 1061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45071759819984436, gen p mean: -0.09883144497871399, mean p set: 0.4512932300567627
loss_pred:0.01559151615947485, decouple_loss:0.0007157339714467525
The modified gen p mean: 0.4485200047492981, gen p mean: -0.09864093363285065, mean p set: 0.44909584522247314
The modified gen p mean: 0.45004791021347046, gen p mean: -0.09764991700649261, mean p set: 0.4506239891052246
loss_pred:0.01525001972913742, decouple_loss:0.0006182727520354092
loss_pred:0.015444528311491013, decouple_loss:0.0005899646785110235
Iteration: 1062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44988173246383667, gen p mean: -0.09473801404237747, mean p set: 0.45045775175094604
loss_pred:0.015104271471500397, decouple_loss:0.0007211900083348155
The modified gen p mean: 0.4494980275630951, gen p mean: -0.09906122088432312, mean p set: 0.4500750005245209The modified gen p mean: 0.44926008582115173, gen p mean: -0.09925610572099686, mean p set: 0.44983693957328796
loss_pred:0.015673136338591576, decouple_loss:0.0005321856588125229
loss_pred:0.015475097112357616, decouple_loss:0.0007625973084941506
Iteration: 1063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487396776676178, gen p mean: -0.0959300845861435, mean p set: 0.44931429624557495
loss_pred:0.01644272357225418, decouple_loss:0.0006051981472410262
The modified gen p mean: 0.4494737684726715, gen p mean: -0.09924101084470749, mean p set: 0.45005032420158386
loss_pred:0.015058474615216255, decouple_loss:0.0006840198766440153
The modified gen p mean: 0.4499538838863373, gen p mean: -0.09939133375883102, mean p set: 0.45053014159202576
loss_pred:0.015218814834952354, decouple_loss:0.0005942321149632335
Iteration: 1064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511817991733551, gen p mean: -0.09467202425003052, mean p set: 0.45175716280937195
loss_pred:0.015712302178144455, decouple_loss:0.0005403126124292612
The modified gen p mean: 0.4498903155326843, gen p mean: -0.10571079701185226, mean p set: 0.4504653811454773
loss_pred:0.015345180407166481, decouple_loss:0.0006418839329853654
The modified gen p mean: 0.44982439279556274, gen p mean: -0.10201525688171387, mean p set: 0.45040175318717957
loss_pred:0.015085293911397457, decouple_loss:0.0008108188631013036
Iteration: 1065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485061466693878, gen p mean: -0.10683566331863403, mean p set: 0.4490794241428375
loss_pred:0.0155206099152565, decouple_loss:0.0006672322633676231
The modified gen p mean: 0.4494175314903259, gen p mean: -0.10903023183345795, mean p set: 0.4499933123588562
loss_pred:0.015323817729949951, decouple_loss:0.0007475034217350185
The modified gen p mean: 0.44891512393951416, gen p mean: -0.1086108610033989, mean p set: 0.449493408203125
loss_pred:0.0159250907599926, decouple_loss:0.0007581379031762481
Iteration: 1066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975966215133667, gen p mean: -0.114510677754879, mean p set: 0.45033547282218933
loss_pred:0.015719696879386902, decouple_loss:0.0006312343757599592
The modified gen p mean: 0.4497801959514618, gen p mean: -0.11579930037260056, mean p set: 0.4503578245639801
loss_pred:0.01650509610772133, decouple_loss:0.0007058993796817958
The modified gen p mean: 0.4500999450683594, gen p mean: -0.11193114519119263, mean p set: 0.45067667961120605
loss_pred:0.01530051976442337, decouple_loss:0.0005622224416583776
Iteration: 1067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971001148223877, gen p mean: -0.10890481621026993, mean p set: 0.4502848982810974
loss_pred:0.015620003454387188, decouple_loss:0.0007110050646588206
The modified gen p mean: 0.449768602848053, gen p mean: -0.12000782787799835, mean p set: 0.4503445625305176
loss_pred:0.016131427139043808, decouple_loss:0.0006492701941169798
The modified gen p mean: 0.44813141226768494, gen p mean: -0.10771424323320389, mean p set: 0.44870832562446594
loss_pred:0.015910141170024872, decouple_loss:0.0005975491949357092
Iteration: 1068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45066460967063904, gen p mean: -0.11549652367830276, mean p set: 0.4512398838996887
loss_pred:0.01575469598174095, decouple_loss:0.0007181726396083832
The modified gen p mean: 0.4508321285247803, gen p mean: -0.10810533165931702, mean p set: 0.4514070451259613
loss_pred:0.01613188348710537, decouple_loss:0.0007964872638694942
The modified gen p mean: 0.45007839798927307, gen p mean: -0.11453355103731155, mean p set: 0.4506531357765198
loss_pred:0.015767844393849373, decouple_loss:0.0007618688396178186
Iteration: 1069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450848788022995, gen p mean: -0.1052820160984993, mean p set: 0.4514269232749939
loss_pred:0.016056552529335022, decouple_loss:0.0007228830363601446
The modified gen p mean: 0.44879886507987976, gen p mean: -0.11542747914791107, mean p set: 0.44937488436698914
loss_pred:0.015384563244879246, decouple_loss:0.0006935811252333224
The modified gen p mean: 0.450099378824234, gen p mean: -0.10985148698091507, mean p set: 0.45067429542541504
loss_pred:0.015404395759105682, decouple_loss:0.000756677589379251
Iteration: 1070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44974350929260254, gen p mean: -0.11162258684635162, mean p set: 0.45031872391700745
loss_pred:0.015451201237738132, decouple_loss:0.0005265411455184221
The modified gen p mean: 0.4493075907230377, gen p mean: -0.11409050971269608, mean p set: 0.4498820900917053
loss_pred:0.015134411863982677, decouple_loss:0.0005805487744510174
The modified gen p mean: 0.4502410888671875, gen p mean: -0.10513853281736374, mean p set: 0.4508165121078491
loss_pred:0.015404091216623783, decouple_loss:0.000679831369780004
2023-05-01 19:35:37 testing...
The modified gen p mean: 0.4495353102684021, gen p mean: -0.11314605921506882, mean p set: 0.4500633478164673
loss_pred:0.016646694391965866, decouple_loss:0.0007513691671192646
The modified gen p mean: 0.44977980852127075, gen p mean: -0.11351563036441803, mean p set: 0.45035696029663086
loss_pred:0.016886254772543907, decouple_loss:0.0007241421844810247
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11909918487071991, mean p set: 0.4502691626548767
loss_pred:0.01727127470076084, decouple_loss:0.0007670951308682561
WV_1_PC_1_EH_0_PS_40, loss: 0.016972120851278305, avg_mse: 0.02633875608444214
current test mse: 0.026339
Iteration: 1071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45001745223999023, gen p mean: -0.10419702529907227, mean p set: 0.4505939483642578
loss_pred:0.01583069935441017, decouple_loss:0.0009432944352738559
The modified gen p mean: 0.45071253180503845, gen p mean: -0.1076139286160469, mean p set: 0.4512903094291687The modified gen p mean: 0.450126588344574, gen p mean: -0.11276896297931671, mean p set: 0.4507039785385132
loss_pred:0.01561794150620699, decouple_loss:0.0007321445737034082loss_pred:0.015267071314156055, decouple_loss:0.000817547261249274
Iteration: 1072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45074161887168884, gen p mean: -0.10256759822368622, mean p set: 0.4513188898563385
loss_pred:0.015535708516836166, decouple_loss:0.0010224594734609127
The modified gen p mean: 0.44873443245887756, gen p mean: -0.10381020605564117, mean p set: 0.44931018352508545The modified gen p mean: 0.4481462240219116, gen p mean: -0.1055680587887764, mean p set: 0.4487225413322449
loss_pred:0.01574864238500595, decouple_loss:0.000909541267901659
loss_pred:0.015318125486373901, decouple_loss:0.0008130142814479768
Iteration: 1073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498855769634247, gen p mean: -0.10234782844781876, mean p set: 0.45046308636665344
loss_pred:0.01570185460150242, decouple_loss:0.0008598173153586686
The modified gen p mean: 0.45006856322288513, gen p mean: -0.10186129063367844, mean p set: 0.45064401626586914
loss_pred:0.015685154125094414, decouple_loss:0.0007934427121654153
The modified gen p mean: 0.4487727880477905, gen p mean: -0.10975457727909088, mean p set: 0.4493492543697357
loss_pred:0.01570674404501915, decouple_loss:0.0006276571657508612
Iteration: 1074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448505163192749, gen p mean: -0.1038321927189827, mean p set: 0.44908347725868225
loss_pred:0.015250337310135365, decouple_loss:0.0007064586970955133
The modified gen p mean: 0.45040223002433777, gen p mean: -0.10621850937604904, mean p set: 0.4509795904159546
loss_pred:0.015311082825064659, decouple_loss:0.000707032042555511
The modified gen p mean: 0.44819486141204834, gen p mean: -0.10362805426120758, mean p set: 0.4487698972225189
loss_pred:0.015397880226373672, decouple_loss:0.0007076918845996261
Iteration: 1075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108485221862793, gen p mean: -0.1050887256860733, mean p set: 0.4516618549823761
loss_pred:0.015562488697469234, decouple_loss:0.0007013080175966024
The modified gen p mean: 0.4509373903274536, gen p mean: -0.10321415960788727, mean p set: 0.45151427388191223
loss_pred:0.015724290162324905, decouple_loss:0.0007168963202275336
The modified gen p mean: 0.4488774240016937, gen p mean: -0.10485896468162537, mean p set: 0.44945380091667175
loss_pred:0.015413956716656685, decouple_loss:0.0007143004331737757
Iteration: 1076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501801133155823, gen p mean: -0.09995310008525848, mean p set: 0.4507562518119812
loss_pred:0.01569419540464878, decouple_loss:0.00100412976462394
The modified gen p mean: 0.4510859251022339, gen p mean: -0.10126544535160065, mean p set: 0.451661616563797
loss_pred:0.016050320118665695, decouple_loss:0.0008011250174604356
The modified gen p mean: 0.45024117827415466, gen p mean: -0.10208567976951599, mean p set: 0.45081597566604614
loss_pred:0.015818122774362564, decouple_loss:0.0009865433676168323
Iteration: 1077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005303621292114, gen p mean: -0.10612128674983978, mean p set: 0.4506286382675171
loss_pred:0.015050811693072319, decouple_loss:0.0005374702159315348
The modified gen p mean: 0.4500073492527008, gen p mean: -0.10938261449337006, mean p set: 0.45058220624923706
loss_pred:0.015393211506307125, decouple_loss:0.0005803013918921351
The modified gen p mean: 0.4502161741256714, gen p mean: -0.10787905007600784, mean p set: 0.45079106092453003
loss_pred:0.015273581258952618, decouple_loss:0.0006903145113028586
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012006_3_24hr.npz
NaN value num: 0
Iteration: 1078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480670690536499, gen p mean: -0.11622416228055954, mean p set: 0.44864028692245483
loss_pred:0.016033444553613663, decouple_loss:0.000715204980224371
The modified gen p mean: 0.44736140966415405, gen p mean: -0.11549083143472672, mean p set: 0.44793686270713806
The modified gen p mean: 0.44721442461013794, gen p mean: -0.11806673556566238, mean p set: 0.4477914571762085
loss_pred:0.015716716647148132, decouple_loss:0.0005170595832169056
loss_pred:0.015288008376955986, decouple_loss:0.0007370836683548987
Iteration: 1079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472583532333374, gen p mean: -0.1194225549697876, mean p set: 0.4478357136249542
loss_pred:0.015494552440941334, decouple_loss:0.0007924580131657422
The modified gen p mean: 0.44872578978538513, gen p mean: -0.11964324861764908, mean p set: 0.44930416345596313
loss_pred:0.015505673363804817, decouple_loss:0.0006616642349399626
The modified gen p mean: 0.4481726288795471, gen p mean: -0.1239703819155693, mean p set: 0.4487501382827759
loss_pred:0.01521693542599678, decouple_loss:0.0006221574149094522
Iteration: 1080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651129841804504, gen p mean: -0.11984813958406448, mean p set: 0.4470870792865753
loss_pred:0.016128486022353172, decouple_loss:0.0010258633410558105
The modified gen p mean: 0.4477382302284241, gen p mean: -0.12195362895727158, mean p set: 0.4483122229576111
loss_pred:0.015374450944364071, decouple_loss:0.001023415825329721
The modified gen p mean: 0.44785061478614807, gen p mean: -0.12027450650930405, mean p set: 0.4484269320964813
loss_pred:0.015324735082685947, decouple_loss:0.0006616096943616867
2023-05-01 19:38:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.123856320977211, mean p set: 0.4502691626548767
loss_pred:0.017128165811300278, decouple_loss:0.0007410213002003729
The modified gen p mean: 0.449537068605423, gen p mean: -0.11774063855409622, mean p set: 0.4500633478164673
loss_pred:0.016493242233991623, decouple_loss:0.0011496287770569324
The modified gen p mean: 0.4497791528701782, gen p mean: -0.11791084706783295, mean p set: 0.45035696029663086
loss_pred:0.016794323921203613, decouple_loss:0.0010298307752236724
WV_1_PC_1_EH_0_PS_40, loss: 0.016853919252753258, avg_mse: 0.026181567460298538
current test mse: 0.026182
Iteration: 1081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464367628097534, gen p mean: -0.12386901676654816, mean p set: 0.44701075553894043
loss_pred:0.015553698875010014, decouple_loss:0.0012180303456261754
The modified gen p mean: 0.44810909032821655, gen p mean: -0.11613421142101288, mean p set: 0.44868743419647217
The modified gen p mean: 0.4467219114303589, gen p mean: -0.12437302619218826, mean p set: 0.4472969174385071
loss_pred:0.015161442570388317, decouple_loss:0.0007223195279948413
loss_pred:0.015024862252175808, decouple_loss:0.0010715125827118754
Iteration: 1082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673436880111694, gen p mean: -0.11878028512001038, mean p set: 0.4473079442977905
loss_pred:0.01543936412781477, decouple_loss:0.000765338831115514
The modified gen p mean: 0.44757145643234253, gen p mean: -0.11281642317771912, mean p set: 0.4481446444988251
The modified gen p mean: 0.4472714066505432, gen p mean: -0.12264459580183029, mean p set: 0.4478473961353302
loss_pred:0.01623939350247383, decouple_loss:0.0006168856634758413
loss_pred:0.015910176560282707, decouple_loss:0.0007996202912181616
Iteration: 1083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44699326157569885, gen p mean: -0.12167459726333618, mean p set: 0.4475705623626709
loss_pred:0.015147767029702663, decouple_loss:0.0007234687218442559
The modified gen p mean: 0.4475143849849701, gen p mean: -0.11655648797750473, mean p set: 0.4480918347835541
loss_pred:0.01608091965317726, decouple_loss:0.0009705465054139495
The modified gen p mean: 0.4468456208705902, gen p mean: -0.1219664067029953, mean p set: 0.44742023944854736
loss_pred:0.01524406485259533, decouple_loss:0.0008635988342575729
Iteration: 1084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477064311504364, gen p mean: -0.12348829954862595, mean p set: 0.4482831358909607
loss_pred:0.015237285755574703, decouple_loss:0.0009743871632963419
The modified gen p mean: 0.4470917284488678, gen p mean: -0.12280179560184479, mean p set: 0.4476657211780548
loss_pred:0.015139162540435791, decouple_loss:0.0006980042089708149
The modified gen p mean: 0.447126567363739, gen p mean: -0.12109104543924332, mean p set: 0.4476999342441559
loss_pred:0.015242543071508408, decouple_loss:0.001002133940346539
Iteration: 1085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473303556442261, gen p mean: -0.12518885731697083, mean p set: 0.4479072690010071
loss_pred:0.014837874099612236, decouple_loss:0.0007142994436435401
The modified gen p mean: 0.4476452171802521, gen p mean: -0.12047263234853745, mean p set: 0.44822028279304504
loss_pred:0.015139070339500904, decouple_loss:0.0008449332090094686
The modified gen p mean: 0.4467964172363281, gen p mean: -0.12075946480035782, mean p set: 0.44737330079078674
loss_pred:0.0152403200045228, decouple_loss:0.0008214752306230366
Iteration: 1086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44651085138320923, gen p mean: -0.12297115474939346, mean p set: 0.44708749651908875
The modified gen p mean: 0.4465557038784027, gen p mean: -0.12482991814613342, mean p set: 0.4471310079097748
loss_pred:0.01598425582051277, decouple_loss:0.000849211763124913
loss_pred:0.014782385900616646, decouple_loss:0.0007357397116720676
The modified gen p mean: 0.44845524430274963, gen p mean: -0.12876754999160767, mean p set: 0.4490325152873993
loss_pred:0.014828834682703018, decouple_loss:0.0007118245121091604
Iteration: 1087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472457468509674, gen p mean: -0.11581634730100632, mean p set: 0.44782111048698425
loss_pred:0.015601759776473045, decouple_loss:0.0007009647088125348
The modified gen p mean: 0.4480689465999603, gen p mean: -0.11528650671243668, mean p set: 0.4486437737941742
loss_pred:0.015090185217559338, decouple_loss:0.0007875647861510515
The modified gen p mean: 0.44613003730773926, gen p mean: -0.11700177192687988, mean p set: 0.44670602679252625
loss_pred:0.01596526987850666, decouple_loss:0.000640384154394269
Iteration: 1088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483071565628052, gen p mean: -0.1196877658367157, mean p set: 0.4488847255706787
loss_pred:0.014979894272983074, decouple_loss:0.0006572639103978872
The modified gen p mean: 0.44689813256263733, gen p mean: -0.11665086448192596, mean p set: 0.44747352600097656
loss_pred:0.015262165106832981, decouple_loss:0.000770623970311135
The modified gen p mean: 0.44822803139686584, gen p mean: -0.11876560747623444, mean p set: 0.44880321621894836
loss_pred:0.015366888605058193, decouple_loss:0.0006883213645778596
Iteration: 1089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470226764678955, gen p mean: -0.11635801941156387, mean p set: 0.4476010799407959
loss_pred:0.015445632860064507, decouple_loss:0.0006410131463780999
The modified gen p mean: 0.44737687706947327, gen p mean: -0.1104356050491333, mean p set: 0.4479510188102722
loss_pred:0.01575353741645813, decouple_loss:0.0007169576711021364
The modified gen p mean: 0.44678905606269836, gen p mean: -0.11567995697259903, mean p set: 0.44736430048942566
loss_pred:0.01515619270503521, decouple_loss:0.0009066296042874455
Iteration: 1090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671255350112915, gen p mean: -0.1239892840385437, mean p set: 0.4472888708114624
loss_pred:0.015144779346883297, decouple_loss:0.0009515008423477411
The modified gen p mean: 0.44756966829299927, gen p mean: -0.11491333693265915, mean p set: 0.4481441080570221
loss_pred:0.015038126148283482, decouple_loss:0.0008637126302346587
The modified gen p mean: 0.4485324025154114, gen p mean: -0.11674251407384872, mean p set: 0.44910916686058044
loss_pred:0.01555588748306036, decouple_loss:0.000826227362267673
2023-05-01 19:40:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1252327263355255, mean p set: 0.4502691626548767
loss_pred:0.017099570482969284, decouple_loss:0.0009316438809037209
The modified gen p mean: 0.4497823119163513, gen p mean: -0.11878464370965958, mean p set: 0.45035696029663086
loss_pred:0.01676405407488346, decouple_loss:0.0007469858392141759
The modified gen p mean: 0.4495353400707245, gen p mean: -0.11924013495445251, mean p set: 0.4500633478164673
loss_pred:0.016406970098614693, decouple_loss:0.0006194664747454226
WV_1_PC_1_EH_0_PS_40, loss: 0.016795167699456215, avg_mse: 0.026142524555325508
current test mse: 0.026143
Iteration: 1091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448144793510437, gen p mean: -0.11883702129125595, mean p set: 0.44871804118156433
loss_pred:0.015239469707012177, decouple_loss:0.0008059378596954048
The modified gen p mean: 0.4474475681781769, gen p mean: -0.12299584597349167, mean p set: 0.44802361726760864
loss_pred:0.01497725211083889, decouple_loss:0.0008326797396875918
The modified gen p mean: 0.44667258858680725, gen p mean: -0.12373866885900497, mean p set: 0.4472491443157196
loss_pred:0.015162697993218899, decouple_loss:0.000751859915908426
Iteration: 1092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44678807258605957, gen p mean: -0.12518981099128723, mean p set: 0.44736161828041077
loss_pred:0.014755744487047195, decouple_loss:0.0006874977261759341
The modified gen p mean: 0.4473421573638916, gen p mean: -0.11850305646657944, mean p set: 0.4479181170463562The modified gen p mean: 0.44766467809677124, gen p mean: -0.12588590383529663, mean p set: 0.4482421875
loss_pred:0.015006978064775467, decouple_loss:0.0007569078006781638loss_pred:0.015099416486918926, decouple_loss:0.0007749469368718565
Iteration: 1093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471396505832672, gen p mean: -0.12184865027666092, mean p set: 0.44771599769592285
loss_pred:0.015183128416538239, decouple_loss:0.0009595268056727946
The modified gen p mean: 0.44719448685646057, gen p mean: -0.12603582441806793, mean p set: 0.4477703869342804The modified gen p mean: 0.4492083787918091, gen p mean: -0.1317596435546875, mean p set: 0.4497888684272766
loss_pred:0.015567670576274395, decouple_loss:0.0007887926185503602
loss_pred:0.014730197377502918, decouple_loss:0.0009284454863518476
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480474293231964, gen p mean: -0.12434311956167221, mean p set: 0.44862401485443115
loss_pred:0.015568245202302933, decouple_loss:0.0007812791154719889
The modified gen p mean: 0.447198748588562, gen p mean: -0.12452086806297302, mean p set: 0.4477764964103699
loss_pred:0.015208188444375992, decouple_loss:0.0007326617487706244
The modified gen p mean: 0.4478485584259033, gen p mean: -0.12429293990135193, mean p set: 0.44842514395713806
loss_pred:0.015264075249433517, decouple_loss:0.0006882736925035715
Iteration: 1095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44785502552986145, gen p mean: -0.12763887643814087, mean p set: 0.44843074679374695
loss_pred:0.015236354433000088, decouple_loss:0.0005564045277424157
The modified gen p mean: 0.44759678840637207, gen p mean: -0.12796662747859955, mean p set: 0.44817429780960083
loss_pred:0.015288828872144222, decouple_loss:0.0009800256229937077
The modified gen p mean: 0.44722986221313477, gen p mean: -0.1292121261358261, mean p set: 0.44780635833740234
loss_pred:0.015719827264547348, decouple_loss:0.0007260384736582637
Iteration: 1096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44665858149528503, gen p mean: -0.12882424890995026, mean p set: 0.44723477959632874
loss_pred:0.015887165442109108, decouple_loss:0.0009287034044973552
The modified gen p mean: 0.4471847116947174, gen p mean: -0.1271774023771286, mean p set: 0.4477572739124298
loss_pred:0.01591344177722931, decouple_loss:0.00079039775300771
The modified gen p mean: 0.4467085301876068, gen p mean: -0.12934917211532593, mean p set: 0.44728556275367737
loss_pred:0.016193153336644173, decouple_loss:0.0009217253536917269
Iteration: 1097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724324345588684, gen p mean: -0.1233903244137764, mean p set: 0.4478200376033783
loss_pred:0.015618974342942238, decouple_loss:0.0005098358378745615
The modified gen p mean: 0.4479027986526489, gen p mean: -0.12635838985443115, mean p set: 0.4484843611717224
loss_pred:0.01502082496881485, decouple_loss:0.0005341009818948805
The modified gen p mean: 0.4471532106399536, gen p mean: -0.12789824604988098, mean p set: 0.4477294087409973
loss_pred:0.01562455203384161, decouple_loss:0.0004787864163517952
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012000_3_24hr.npz
NaN value num: 0
Iteration: 1098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.445857971906662, gen p mean: -0.1236710473895073, mean p set: 0.4464336037635803
loss_pred:0.016016777604818344, decouple_loss:0.0009241063962690532
The modified gen p mean: 0.4489540755748749, gen p mean: -0.1290310174226761, mean p set: 0.44953420758247375
The modified gen p mean: 0.4462624788284302, gen p mean: -0.12569659948349, mean p set: 0.4468367099761963
loss_pred:0.016679851338267326, decouple_loss:0.0009153891005553305
loss_pred:0.016368772834539413, decouple_loss:0.0009804164292290807
Iteration: 1099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474931061267853, gen p mean: -0.11727283149957657, mean p set: 0.44807007908821106
loss_pred:0.016072044149041176, decouple_loss:0.0006473245448432863
The modified gen p mean: 0.4477669596672058, gen p mean: -0.1184302344918251, mean p set: 0.44834375381469727
loss_pred:0.017017439007759094, decouple_loss:0.0006434647948481143
The modified gen p mean: 0.4493332803249359, gen p mean: -0.12630094587802887, mean p set: 0.44990822672843933
loss_pred:0.016488051041960716, decouple_loss:0.000802034861408174
Iteration: 1100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44839146733283997, gen p mean: -0.1207788735628128, mean p set: 0.44896718859672546
loss_pred:0.01671615242958069, decouple_loss:0.0005435963976196945
The modified gen p mean: 0.44636255502700806, gen p mean: -0.11383369565010071, mean p set: 0.4469371736049652
loss_pred:0.016119200736284256, decouple_loss:0.0004899222403764725
The modified gen p mean: 0.447627991437912, gen p mean: -0.12139910459518433, mean p set: 0.44820359349250793
loss_pred:0.015749037265777588, decouple_loss:0.0007207682938314974
2023-05-01 19:43:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1163601353764534, mean p set: 0.4502691626548767
loss_pred:0.017085706815123558, decouple_loss:0.0007945165853016078
The modified gen p mean: 0.449532687664032, gen p mean: -0.11005888134241104, mean p set: 0.4500633478164673
loss_pred:0.01637927256524563, decouple_loss:0.0006387185421772301
The modified gen p mean: 0.4497792720794678, gen p mean: -0.11024384200572968, mean p set: 0.45035696029663086
loss_pred:0.016704661771655083, decouple_loss:0.0006767960730940104
WV_1_PC_1_EH_0_PS_40, loss: 0.016758382320404053, avg_mse: 0.02608412876725197
current test mse: 0.026084
Iteration: 1101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474828541278839, gen p mean: -0.10854433476924896, mean p set: 0.44805875420570374
loss_pred:0.015779882669448853, decouple_loss:0.0008291585836559534
The modified gen p mean: 0.4470405876636505, gen p mean: -0.11704585701227188, mean p set: 0.4476166069507599The modified gen p mean: 0.44722482562065125, gen p mean: -0.11330538243055344, mean p set: 0.44780099391937256
loss_pred:0.016092687845230103, decouple_loss:0.0006023896276019514
loss_pred:0.016048099845647812, decouple_loss:0.0007970695733092725
Iteration: 1102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44763097167015076, gen p mean: -0.11156143993139267, mean p set: 0.44820722937583923
loss_pred:0.01662149652838707, decouple_loss:0.000639758596662432
The modified gen p mean: 0.44718703627586365, gen p mean: -0.10910070687532425, mean p set: 0.4477635622024536The modified gen p mean: 0.44671425223350525, gen p mean: -0.11516765505075455, mean p set: 0.44729119539260864
loss_pred:0.015718596056103706, decouple_loss:0.0008277214365079999
loss_pred:0.016329506412148476, decouple_loss:0.001037116628140211
Iteration: 1103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44693732261657715, gen p mean: -0.12076162546873093, mean p set: 0.4475148916244507
loss_pred:0.015572691336274147, decouple_loss:0.0006192791042849422
The modified gen p mean: 0.4476200342178345, gen p mean: -0.10979674011468887, mean p set: 0.4481947124004364The modified gen p mean: 0.4472995698451996, gen p mean: -0.11580950766801834, mean p set: 0.4478749632835388
loss_pred:0.01650378853082657, decouple_loss:0.0006354879587888718loss_pred:0.016162661835551262, decouple_loss:0.0006055636913515627
Iteration: 1104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462991952896118, gen p mean: -0.11992538720369339, mean p set: 0.4468752145767212
loss_pred:0.015967678278684616, decouple_loss:0.0005636774585582316
The modified gen p mean: 0.4471995532512665, gen p mean: -0.11929686367511749, mean p set: 0.44777578115463257
loss_pred:0.01614127680659294, decouple_loss:0.0005840605008415878
The modified gen p mean: 0.4469009041786194, gen p mean: -0.12044703215360641, mean p set: 0.4474751055240631
loss_pred:0.01582528091967106, decouple_loss:0.0006077619618736207
Iteration: 1105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471144676208496, gen p mean: -0.1202482357621193, mean p set: 0.44769227504730225
loss_pred:0.01579432375729084, decouple_loss:0.0007809372618794441
The modified gen p mean: 0.4474341869354248, gen p mean: -0.11698859184980392, mean p set: 0.4480101466178894
loss_pred:0.015405110083520412, decouple_loss:0.0005680596805177629
The modified gen p mean: 0.4475749433040619, gen p mean: -0.12414883822202682, mean p set: 0.448152095079422
loss_pred:0.015634967014193535, decouple_loss:0.000637643679510802
Iteration: 1106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470556974411011, gen p mean: -0.11943664401769638, mean p set: 0.44762900471687317
loss_pred:0.015120703727006912, decouple_loss:0.0005244886851869524
The modified gen p mean: 0.4470439851284027, gen p mean: -0.12250231206417084, mean p set: 0.44762122631073
The modified gen p mean: 0.4479539394378662, gen p mean: -0.11699995398521423, mean p set: 0.4485294818878174
loss_pred:0.015755563974380493, decouple_loss:0.0006911847740411758
loss_pred:0.016535568982362747, decouple_loss:0.0006508812657557428
Iteration: 1107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779691100120544, gen p mean: -0.12446079403162003, mean p set: 0.448373407125473
loss_pred:0.015442583709955215, decouple_loss:0.0007753378013148904
The modified gen p mean: 0.447078675031662, gen p mean: -0.12074562162160873, mean p set: 0.44765612483024597
loss_pred:0.01602131314575672, decouple_loss:0.0006258520879782736
The modified gen p mean: 0.446062296628952, gen p mean: -0.1212753877043724, mean p set: 0.44663766026496887
loss_pred:0.015954017639160156, decouple_loss:0.000676991418004036
Iteration: 1108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454843997955322, gen p mean: -0.12150681763887405, mean p set: 0.44606053829193115
loss_pred:0.016036393120884895, decouple_loss:0.0006547813536599278
The modified gen p mean: 0.4469957649707794, gen p mean: -0.12607145309448242, mean p set: 0.447569340467453
loss_pred:0.01616223156452179, decouple_loss:0.0007889095577411354
The modified gen p mean: 0.4472520351409912, gen p mean: -0.11782238632440567, mean p set: 0.44783106446266174
loss_pred:0.015381131321191788, decouple_loss:0.0006786870071664453
Iteration: 1109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44666266441345215, gen p mean: -0.12149053812026978, mean p set: 0.44723597168922424
The modified gen p mean: 0.4464380741119385, gen p mean: -0.11998356133699417, mean p set: 0.44701457023620605
loss_pred:0.016732390969991684, decouple_loss:0.0008964053122326732
loss_pred:0.01632978953421116, decouple_loss:0.0008266441291198134
The modified gen p mean: 0.4468531906604767, gen p mean: -0.11941526085138321, mean p set: 0.44742920994758606
loss_pred:0.015954909846186638, decouple_loss:0.0007292932132259011
Iteration: 1110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483134150505066, gen p mean: -0.12132639437913895, mean p set: 0.4488895833492279
The modified gen p mean: 0.4455886483192444, gen p mean: -0.12263326346874237, mean p set: 0.4461626410484314
loss_pred:0.015726953744888306, decouple_loss:0.0010580657981336117
loss_pred:0.015504580922424793, decouple_loss:0.0007000393816269934
The modified gen p mean: 0.44651591777801514, gen p mean: -0.12247636169195175, mean p set: 0.44709208607673645
loss_pred:0.01588214747607708, decouple_loss:0.000784739968366921
2023-05-01 19:45:18 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.126504048705101, mean p set: 0.4502691626548767
loss_pred:0.017090028151869774, decouple_loss:0.0008125546737574041
The modified gen p mean: 0.44953200221061707, gen p mean: -0.1204950287938118, mean p set: 0.4500633478164673
loss_pred:0.016548434272408485, decouple_loss:0.0008154779206961393
The modified gen p mean: 0.4497811794281006, gen p mean: -0.12067439407110214, mean p set: 0.45035696029663086
loss_pred:0.01675182394683361, decouple_loss:0.0009326623985543847
WV_1_PC_1_EH_0_PS_40, loss: 0.016839440912008286, avg_mse: 0.02621576376259327
current test mse: 0.026216
Iteration: 1111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758665561676025, gen p mean: -0.12003173679113388, mean p set: 0.448160856962204
loss_pred:0.01649376191198826, decouple_loss:0.0007984220283105969
The modified gen p mean: 0.44729870557785034, gen p mean: -0.12113822251558304, mean p set: 0.4478742182254791
loss_pred:0.01625344529747963, decouple_loss:0.0008625899790786207
The modified gen p mean: 0.44684475660324097, gen p mean: -0.12875501811504364, mean p set: 0.4474208950996399
loss_pred:0.01569281704723835, decouple_loss:0.0009640894713811576
Iteration: 1112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471401870250702, gen p mean: -0.11672049760818481, mean p set: 0.4477180242538452
The modified gen p mean: 0.4473051130771637, gen p mean: -0.12629328668117523, mean p set: 0.44788476824760437
loss_pred:0.01641486957669258, decouple_loss:0.0009201125940307975
loss_pred:0.015356973744928837, decouple_loss:0.0007641033735126257
The modified gen p mean: 0.44661545753479004, gen p mean: -0.1246427446603775, mean p set: 0.44719216227531433
loss_pred:0.01624307781457901, decouple_loss:0.0008010678575374186
Iteration: 1113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44714006781578064, gen p mean: -0.12183075398206711, mean p set: 0.4477160573005676
loss_pred:0.015768183395266533, decouple_loss:0.0006466080667451024
The modified gen p mean: 0.4472190737724304, gen p mean: -0.12014912813901901, mean p set: 0.44779494404792786
loss_pred:0.01625174656510353, decouple_loss:0.0006201150827109814
The modified gen p mean: 0.44696858525276184, gen p mean: -0.11331545561552048, mean p set: 0.447546124458313
loss_pred:0.01714840717613697, decouple_loss:0.0006416310789063573
Iteration: 1114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483731687068939, gen p mean: -0.11841025203466415, mean p set: 0.4489504396915436
loss_pred:0.01627380959689617, decouple_loss:0.0009614165755920112
The modified gen p mean: 0.4472973942756653, gen p mean: -0.12213791906833649, mean p set: 0.4478749930858612
loss_pred:0.01612057350575924, decouple_loss:0.0008603639435023069
The modified gen p mean: 0.44716402888298035, gen p mean: -0.12586097419261932, mean p set: 0.4477405250072479
loss_pred:0.015519361011683941, decouple_loss:0.0008301367051899433
Iteration: 1115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468899965286255, gen p mean: -0.12252447009086609, mean p set: 0.44746798276901245
loss_pred:0.016285128891468048, decouple_loss:0.0006994991563260555
The modified gen p mean: 0.4474533200263977, gen p mean: -0.11506853252649307, mean p set: 0.44803011417388916
loss_pred:0.016975142061710358, decouple_loss:0.0006478260038420558
The modified gen p mean: 0.44606733322143555, gen p mean: -0.11861258000135422, mean p set: 0.4466399550437927
loss_pred:0.01618312858045101, decouple_loss:0.0008712232229299843
Iteration: 1116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44609272480010986, gen p mean: -0.12055220454931259, mean p set: 0.4466695487499237
loss_pred:0.01643284596502781, decouple_loss:0.0006633162265643477
The modified gen p mean: 0.44612738490104675, gen p mean: -0.12304393202066422, mean p set: 0.44670340418815613
The modified gen p mean: 0.44751039147377014, gen p mean: -0.12226764112710953, mean p set: 0.44808676838874817
loss_pred:0.016101498156785965, decouple_loss:0.0006063462933525443
loss_pred:0.015876159071922302, decouple_loss:0.0007229693001136184
Iteration: 1117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468558430671692, gen p mean: -0.1089634969830513, mean p set: 0.44742998480796814
The modified gen p mean: 0.4464270770549774, gen p mean: -0.11853668093681335, mean p set: 0.44699984788894653
loss_pred:0.016963353380560875, decouple_loss:0.0011485303984954953
loss_pred:0.016286812722682953, decouple_loss:0.0007399378810077906
The modified gen p mean: 0.4473223090171814, gen p mean: -0.11768592149019241, mean p set: 0.4478980302810669
loss_pred:0.01576744206249714, decouple_loss:0.0008272569393739104
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012006_3_24hr.npz
NaN value num: 0
Iteration: 1118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521161913871765, gen p mean: -0.1188788041472435, mean p set: 0.45269668102264404
loss_pred:0.01594959758222103, decouple_loss:0.0007604280835948884
The modified gen p mean: 0.45158323645591736, gen p mean: -0.11324252188205719, mean p set: 0.45215752720832825
The modified gen p mean: 0.4519401490688324, gen p mean: -0.10878779739141464, mean p set: 0.452517032623291
loss_pred:0.016029857099056244, decouple_loss:0.001294981106184423
loss_pred:0.016388198360800743, decouple_loss:0.0009986626682803035
Iteration: 1119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508880078792572, gen p mean: -0.11430124938488007, mean p set: 0.4514629542827606
loss_pred:0.015936624258756638, decouple_loss:0.0005626391503028572
The modified gen p mean: 0.4529341757297516, gen p mean: -0.11371702700853348, mean p set: 0.45351067185401917
The modified gen p mean: 0.4524012506008148, gen p mean: -0.11627492308616638, mean p set: 0.4529772400856018
loss_pred:0.016019556671380997, decouple_loss:0.0006951690884307027
loss_pred:0.015737591311335564, decouple_loss:0.0006260181544348598
Iteration: 1120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4555671513080597, gen p mean: -0.11466332525014877, mean p set: 0.45614469051361084
loss_pred:0.01649133302271366, decouple_loss:0.0007045085076242685
The modified gen p mean: 0.45479077100753784, gen p mean: -0.11558035016059875, mean p set: 0.45536860823631287
The modified gen p mean: 0.4533677399158478, gen p mean: -0.11245144158601761, mean p set: 0.4539449214935303
loss_pred:0.0158616341650486, decouple_loss:0.0008522157440893352
loss_pred:0.016567327082157135, decouple_loss:0.0007554551120847464
2023-05-01 19:48:08 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12260664254426956, mean p set: 0.4502691626548767
loss_pred:0.017181841656565666, decouple_loss:0.0009992882842198014
The modified gen p mean: 0.4495337903499603, gen p mean: -0.11666557192802429, mean p set: 0.4500633478164673
loss_pred:0.016526220366358757, decouple_loss:0.0007870712433941662
The modified gen p mean: 0.44977685809135437, gen p mean: -0.11653514206409454, mean p set: 0.45035696029663086
loss_pred:0.016801489517092705, decouple_loss:0.000803969451226294
WV_1_PC_1_EH_0_PS_40, loss: 0.016879690811038017, avg_mse: 0.026283852756023407
current test mse: 0.026284
Iteration: 1121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492610692977905, gen p mean: -0.11517026275396347, mean p set: 0.4498353600502014
loss_pred:0.016100533306598663, decouple_loss:0.0008201816235668957
The modified gen p mean: 0.4508156180381775, gen p mean: -0.11581294983625412, mean p set: 0.451394259929657
loss_pred:0.016455519944429398, decouple_loss:0.0006048613577149808
The modified gen p mean: 0.45020028948783875, gen p mean: -0.11767899245023727, mean p set: 0.45077502727508545
loss_pred:0.016574108973145485, decouple_loss:0.0006207351107150316
Iteration: 1122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520944356918335, gen p mean: -0.10965754836797714, mean p set: 0.45267021656036377
loss_pred:0.01630578190088272, decouple_loss:0.0011389635037630796
The modified gen p mean: 0.45295944809913635, gen p mean: -0.11699797958135605, mean p set: 0.45353925228118896The modified gen p mean: 0.45000267028808594, gen p mean: -0.11995252221822739, mean p set: 0.4505777657032013
loss_pred:0.01622771844267845, decouple_loss:0.0013829405652359128
loss_pred:0.01621987670660019, decouple_loss:0.0006953677511774004
Iteration: 1123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528666138648987, gen p mean: -0.11507994681596756, mean p set: 0.4534425735473633
loss_pred:0.016474245116114616, decouple_loss:0.0006111786933615804
The modified gen p mean: 0.4506790339946747, gen p mean: -0.11696188896894455, mean p set: 0.45125651359558105
loss_pred:0.01584581471979618, decouple_loss:0.0006588888936676085
The modified gen p mean: 0.44959166646003723, gen p mean: -0.1256890594959259, mean p set: 0.45016953349113464
loss_pred:0.016338152810931206, decouple_loss:0.0006649577408097684
Iteration: 1124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494754374027252, gen p mean: -0.1253899335861206, mean p set: 0.45005518198013306
loss_pred:0.016051001846790314, decouple_loss:0.0006444345926865935
The modified gen p mean: 0.4537305533885956, gen p mean: -0.12083649635314941, mean p set: 0.4543078541755676
loss_pred:0.01631908491253853, decouple_loss:0.0006675473414361477
The modified gen p mean: 0.4523681700229645, gen p mean: -0.1142997071146965, mean p set: 0.45294633507728577
loss_pred:0.01633422262966633, decouple_loss:0.0006031028460711241
Iteration: 1125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514542520046234, gen p mean: -0.12539055943489075, mean p set: 0.45203009247779846
loss_pred:0.015696793794631958, decouple_loss:0.0008450403693132102
The modified gen p mean: 0.45133155584335327, gen p mean: -0.12256071716547012, mean p set: 0.45190730690956116
loss_pred:0.016518305987119675, decouple_loss:0.0009152073180302978
The modified gen p mean: 0.4512272775173187, gen p mean: -0.12148432433605194, mean p set: 0.4518042206764221
loss_pred:0.015898339450359344, decouple_loss:0.001021789270453155
Iteration: 1126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527086019515991, gen p mean: -0.12191057950258255, mean p set: 0.45328548550605774
loss_pred:0.01590547524392605, decouple_loss:0.0009038519347086549
The modified gen p mean: 0.45248836278915405, gen p mean: -0.11997481435537338, mean p set: 0.45306456089019775
loss_pred:0.015927629545331, decouple_loss:0.0009255271288566291
The modified gen p mean: 0.45243769884109497, gen p mean: -0.12464191019535065, mean p set: 0.4530124366283417
loss_pred:0.01615361124277115, decouple_loss:0.0008620797307230532
Iteration: 1127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524005949497223, gen p mean: -0.11199591308832169, mean p set: 0.452976793050766
loss_pred:0.016265761107206345, decouple_loss:0.0006805416196584702
The modified gen p mean: 0.4516938626766205, gen p mean: -0.1153864711523056, mean p set: 0.45227131247520447
The modified gen p mean: 0.4519731104373932, gen p mean: -0.11429441720247269, mean p set: 0.45254912972450256
loss_pred:0.01595008745789528, decouple_loss:0.0005930220941081643
loss_pred:0.016047412529587746, decouple_loss:0.0007094139000400901
Iteration: 1128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45267024636268616, gen p mean: -0.11635024100542068, mean p set: 0.4532485604286194
loss_pred:0.016754118725657463, decouple_loss:0.0006653142627328634
The modified gen p mean: 0.4506072700023651, gen p mean: -0.12127234786748886, mean p set: 0.4511864483356476
loss_pred:0.016850603744387627, decouple_loss:0.0006839272100478411
The modified gen p mean: 0.45015233755111694, gen p mean: -0.11815663427114487, mean p set: 0.45073044300079346
loss_pred:0.01619556173682213, decouple_loss:0.0005885401042178273
Iteration: 1129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099571347236633, gen p mean: -0.1153012365102768, mean p set: 0.45157214999198914
loss_pred:0.01640416495501995, decouple_loss:0.0006646487163379788
The modified gen p mean: 0.4524935781955719, gen p mean: -0.12201854586601257, mean p set: 0.453070729970932
loss_pred:0.01616717129945755, decouple_loss:0.0008849346195347607
The modified gen p mean: 0.45077505707740784, gen p mean: -0.1201404258608818, mean p set: 0.4513516426086426
loss_pred:0.016129717230796814, decouple_loss:0.0005488390452228487
Iteration: 1130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523758590221405, gen p mean: -0.12616553902626038, mean p set: 0.4529498815536499
loss_pred:0.016163397580385208, decouple_loss:0.0006660454091615975
The modified gen p mean: 0.45158296823501587, gen p mean: -0.12173362076282501, mean p set: 0.4521603584289551
loss_pred:0.015501579269766808, decouple_loss:0.000578997191041708
The modified gen p mean: 0.4524991810321808, gen p mean: -0.11683249473571777, mean p set: 0.4530753493309021
loss_pred:0.01571257784962654, decouple_loss:0.0005651352112181485
2023-05-01 19:50:14 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1323159635066986, mean p set: 0.4502691626548767
loss_pred:0.01728725992143154, decouple_loss:0.000796683132648468
The modified gen p mean: 0.4495355486869812, gen p mean: -0.12613153457641602, mean p set: 0.4500633478164673
loss_pred:0.016620177775621414, decouple_loss:0.000673456524964422
The modified gen p mean: 0.44978445768356323, gen p mean: -0.12629635632038116, mean p set: 0.45035696029663086
loss_pred:0.016862723976373672, decouple_loss:0.0006315528298728168
WV_1_PC_1_EH_0_PS_40, loss: 0.016958415508270264, avg_mse: 0.02646884322166443
current test mse: 0.026469
Iteration: 1131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517250061035156, gen p mean: -0.1285000443458557, mean p set: 0.4523029327392578
loss_pred:0.016096794977784157, decouple_loss:0.0006306851864792407
The modified gen p mean: 0.4519393742084503, gen p mean: -0.12565694749355316, mean p set: 0.45251479744911194
loss_pred:0.01570659689605236, decouple_loss:0.0005311512504704297
The modified gen p mean: 0.4507628381252289, gen p mean: -0.12357967346906662, mean p set: 0.45133963227272034
loss_pred:0.016229236498475075, decouple_loss:0.0006141113699413836
Iteration: 1132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511929750442505, gen p mean: -0.13586336374282837, mean p set: 0.451773464679718The modified gen p mean: 0.452060729265213, gen p mean: -0.1268383413553238, mean p set: 0.4526323080062866
loss_pred:0.016241764649748802, decouple_loss:0.0007561176316812634
loss_pred:0.016242975369095802, decouple_loss:0.0007341366726905107
The modified gen p mean: 0.4527342915534973, gen p mean: -0.12569822371006012, mean p set: 0.4533127248287201
loss_pred:0.016137393191456795, decouple_loss:0.0007414384162984788
Iteration: 1133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45291590690612793, gen p mean: -0.12657420337200165, mean p set: 0.45348870754241943
loss_pred:0.016072558239102364, decouple_loss:0.00057432014727965
The modified gen p mean: 0.4546404480934143, gen p mean: -0.12724238634109497, mean p set: 0.4552163779735565
loss_pred:0.016191834583878517, decouple_loss:0.000808091601356864
The modified gen p mean: 0.45260608196258545, gen p mean: -0.13035714626312256, mean p set: 0.4531856179237366
loss_pred:0.01580403931438923, decouple_loss:0.000789561599958688
Iteration: 1134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522278904914856, gen p mean: -0.1264784187078476, mean p set: 0.4528070092201233
loss_pred:0.016276422888040543, decouple_loss:0.0007156665087677538
The modified gen p mean: 0.45122814178466797, gen p mean: -0.12259810417890549, mean p set: 0.45180368423461914
loss_pred:0.015987224876880646, decouple_loss:0.0008021199028007686
The modified gen p mean: 0.45380574464797974, gen p mean: -0.1288115382194519, mean p set: 0.4543859660625458
loss_pred:0.01524304784834385, decouple_loss:0.0009240239742211998
Iteration: 1135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45122072100639343, gen p mean: -0.1280411183834076, mean p set: 0.4518008232116699
loss_pred:0.015738165006041527, decouple_loss:0.0007392782717943192
The modified gen p mean: 0.452769011259079, gen p mean: -0.12460709363222122, mean p set: 0.45334672927856445
loss_pred:0.016071584075689316, decouple_loss:0.0008438052027486265
The modified gen p mean: 0.4522918462753296, gen p mean: -0.12287769466638565, mean p set: 0.4528656601905823
loss_pred:0.016243332996964455, decouple_loss:0.0009265110711567104
Iteration: 1136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522930085659027, gen p mean: -0.1237102821469307, mean p set: 0.452870637178421
loss_pred:0.017031321302056313, decouple_loss:0.0006753772031515837
The modified gen p mean: 0.4530087113380432, gen p mean: -0.12491723150014877, mean p set: 0.45359036326408386
The modified gen p mean: 0.45090967416763306, gen p mean: -0.13074538111686707, mean p set: 0.45148760080337524
loss_pred:0.017241792753338814, decouple_loss:0.0005389064899645746
loss_pred:0.01574312150478363, decouple_loss:0.0006201055948622525
Iteration: 1137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502757489681244, gen p mean: -0.126016765832901, mean p set: 0.45085322856903076
loss_pred:0.016564538702368736, decouple_loss:0.000639130943454802
The modified gen p mean: 0.4513123035430908, gen p mean: -0.1256694346666336, mean p set: 0.45189061760902405
The modified gen p mean: 0.45153701305389404, gen p mean: -0.12275522202253342, mean p set: 0.45211559534072876
loss_pred:0.015827588737010956, decouple_loss:0.0010829436359927058
loss_pred:0.015957463532686234, decouple_loss:0.000644290295895189
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012001_3_24hr.npz
NaN value num: 0
Iteration: 1138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470655024051666, gen p mean: -0.13048073649406433, mean p set: 0.44764021039009094
The modified gen p mean: 0.4480873644351959, gen p mean: -0.1301531344652176, mean p set: 0.4486611485481262
loss_pred:0.015835130587220192, decouple_loss:0.0007517057238146663
loss_pred:0.015581036917865276, decouple_loss:0.0004457909963093698
The modified gen p mean: 0.4471128284931183, gen p mean: -0.1235511526465416, mean p set: 0.44768741726875305
loss_pred:0.014886130578815937, decouple_loss:0.0005813587922602892
Iteration: 1139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472801089286804, gen p mean: -0.1307978630065918, mean p set: 0.44785767793655396
loss_pred:0.015639448538422585, decouple_loss:0.0005884904530830681
The modified gen p mean: 0.44794344902038574, gen p mean: -0.13081184029579163, mean p set: 0.4485190510749817
loss_pred:0.0158429853618145, decouple_loss:0.0006152632413432002
The modified gen p mean: 0.4477483928203583, gen p mean: -0.1292715221643448, mean p set: 0.44832831621170044
loss_pred:0.01567564532160759, decouple_loss:0.000526638119481504
Iteration: 1140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44600486755371094, gen p mean: -0.13112367689609528, mean p set: 0.4465774595737457
loss_pred:0.015873832628130913, decouple_loss:0.00045766925904899836
The modified gen p mean: 0.44785499572753906, gen p mean: -0.12938585877418518, mean p set: 0.44842812418937683
loss_pred:0.015126904472708702, decouple_loss:0.0004988216096535325
The modified gen p mean: 0.4473002552986145, gen p mean: -0.13445641100406647, mean p set: 0.4478755593299866
loss_pred:0.015505212359130383, decouple_loss:0.0005786118563264608
2023-05-01 19:52:56 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13555361330509186, mean p set: 0.4502691626548767
loss_pred:0.017265019938349724, decouple_loss:0.0005526510649360716
The modified gen p mean: 0.4495334327220917, gen p mean: -0.12944717705249786, mean p set: 0.4500633478164673
loss_pred:0.01666579209268093, decouple_loss:0.0006194602465257049
The modified gen p mean: 0.4497798979282379, gen p mean: -0.1296653002500534, mean p set: 0.45035696029663086
loss_pred:0.016879579052329063, decouple_loss:0.0006354040233418345
WV_1_PC_1_EH_0_PS_40, loss: 0.0169669222086668, avg_mse: 0.026459982618689537
current test mse: 0.02646
Iteration: 1141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481526017189026, gen p mean: -0.12870487570762634, mean p set: 0.44872787594795227
loss_pred:0.014173581264913082, decouple_loss:0.00046241021482273936
The modified gen p mean: 0.44605153799057007, gen p mean: -0.13885898888111115, mean p set: 0.44662564992904663The modified gen p mean: 0.4470723569393158, gen p mean: -0.12878653407096863, mean p set: 0.4476470947265625
loss_pred:0.01577974483370781, decouple_loss:0.0007160407258197665loss_pred:0.014596905559301376, decouple_loss:0.0005327847902663052
Iteration: 1142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473772644996643, gen p mean: -0.13450470566749573, mean p set: 0.4479525089263916
loss_pred:0.01515598688274622, decouple_loss:0.000585159519687295
The modified gen p mean: 0.44660040736198425, gen p mean: -0.13401155173778534, mean p set: 0.44717565178871155The modified gen p mean: 0.44756725430488586, gen p mean: -0.12781861424446106, mean p set: 0.44814640283584595
loss_pred:0.015300841070711613, decouple_loss:0.0005900211399421096
loss_pred:0.015535972081124783, decouple_loss:0.0005340781644918025
Iteration: 1143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472002685070038, gen p mean: -0.12717381119728088, mean p set: 0.4477759599685669
loss_pred:0.015574079938232899, decouple_loss:0.000580135325435549
The modified gen p mean: 0.4481163024902344, gen p mean: -0.12194880843162537, mean p set: 0.4486927390098572
loss_pred:0.01430220901966095, decouple_loss:0.0005650047096423805
The modified gen p mean: 0.44655725359916687, gen p mean: -0.13251496851444244, mean p set: 0.44713205099105835
loss_pred:0.014893586747348309, decouple_loss:0.0006237688357941806
Iteration: 1144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468601644039154, gen p mean: -0.1299106925725937, mean p set: 0.44743743538856506
loss_pred:0.01517569925636053, decouple_loss:0.000536852516233921
The modified gen p mean: 0.44771161675453186, gen p mean: -0.12801697850227356, mean p set: 0.4482881724834442
loss_pred:0.015013058669865131, decouple_loss:0.0005040933610871434
The modified gen p mean: 0.44709715247154236, gen p mean: -0.12321324646472931, mean p set: 0.4476735293865204
loss_pred:0.0147536750882864, decouple_loss:0.0005871691391803324
Iteration: 1145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674918055534363, gen p mean: -0.12303176522254944, mean p set: 0.44732168316841125
loss_pred:0.014403305947780609, decouple_loss:0.0005081144627183676
The modified gen p mean: 0.4462818503379822, gen p mean: -0.13256299495697021, mean p set: 0.4468553960323334
loss_pred:0.014872596599161625, decouple_loss:0.0004382853803690523
The modified gen p mean: 0.4467996656894684, gen p mean: -0.12983252108097076, mean p set: 0.4473738372325897
loss_pred:0.014220747165381908, decouple_loss:0.00048052548663690686
Iteration: 1146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465290904045105, gen p mean: -0.11856681108474731, mean p set: 0.4471038579940796
loss_pred:0.015912922099232674, decouple_loss:0.0006407859618775547
The modified gen p mean: 0.44707030057907104, gen p mean: -0.1138959601521492, mean p set: 0.44764676690101624
The modified gen p mean: 0.4463083744049072, gen p mean: -0.11612438410520554, mean p set: 0.44688504934310913
loss_pred:0.01531257200986147, decouple_loss:0.0005815133918076754
loss_pred:0.014389006420969963, decouple_loss:0.0005151934456080198
Iteration: 1147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464271664619446, gen p mean: -0.1163242906332016, mean p set: 0.4470026195049286
loss_pred:0.015193384140729904, decouple_loss:0.0005265223444439471
The modified gen p mean: 0.44866082072257996, gen p mean: -0.11669759452342987, mean p set: 0.44923636317253113
loss_pred:0.014030317775905132, decouple_loss:0.0004943922394886613
The modified gen p mean: 0.44652917981147766, gen p mean: -0.11163041740655899, mean p set: 0.4471050798892975
loss_pred:0.014132709242403507, decouple_loss:0.0004934290191158652
Iteration: 1148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476030766963959, gen p mean: -0.11418668925762177, mean p set: 0.44817930459976196
loss_pred:0.014746651984751225, decouple_loss:0.0005144838360138237
The modified gen p mean: 0.4470783770084381, gen p mean: -0.1168149784207344, mean p set: 0.44765499234199524
loss_pred:0.015096454881131649, decouple_loss:0.0005835999036207795
The modified gen p mean: 0.4472200274467468, gen p mean: -0.11326756328344345, mean p set: 0.4477977156639099
loss_pred:0.01457105204463005, decouple_loss:0.0006061278400011361
Iteration: 1149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44653773307800293, gen p mean: -0.12515603005886078, mean p set: 0.4471111297607422
loss_pred:0.014480996876955032, decouple_loss:0.0006996821030043066
The modified gen p mean: 0.4480554163455963, gen p mean: -0.11689192056655884, mean p set: 0.4486280083656311
loss_pred:0.014176851138472557, decouple_loss:0.0006987053784541786
The modified gen p mean: 0.4474388062953949, gen p mean: -0.11427599936723709, mean p set: 0.44801655411720276
loss_pred:0.013723501935601234, decouple_loss:0.0008624481270089746
Iteration: 1150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471976161003113, gen p mean: -0.11723294854164124, mean p set: 0.4477759003639221
loss_pred:0.014466943219304085, decouple_loss:0.0005772307049483061
The modified gen p mean: 0.4467619061470032, gen p mean: -0.11883848905563354, mean p set: 0.4473371207714081
loss_pred:0.014098134823143482, decouple_loss:0.0007418986642733216
The modified gen p mean: 0.4471798241138458, gen p mean: -0.11502746492624283, mean p set: 0.4477570950984955
loss_pred:0.014464328065514565, decouple_loss:0.000621617364231497
2023-05-01 19:55:02 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1251271665096283, mean p set: 0.4502691626548767
loss_pred:0.0172539371997118, decouple_loss:0.000565296330023557
The modified gen p mean: 0.4495353400707245, gen p mean: -0.1188676655292511, mean p set: 0.4500633478164673
loss_pred:0.016555698588490486, decouple_loss:0.0006559536559507251
The modified gen p mean: 0.4497818946838379, gen p mean: -0.11885762214660645, mean p set: 0.45035696029663086
loss_pred:0.01683545857667923, decouple_loss:0.0006665484397672117
WV_1_PC_1_EH_0_PS_40, loss: 0.01691316068172455, avg_mse: 0.026334507390856743
current test mse: 0.026335
Iteration: 1151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480271637439728, gen p mean: -0.1174246147274971, mean p set: 0.44860100746154785
loss_pred:0.014343907125294209, decouple_loss:0.0006356798694469035
The modified gen p mean: 0.4464353322982788, gen p mean: -0.1195816621184349, mean p set: 0.4470112919807434The modified gen p mean: 0.4459728002548218, gen p mean: -0.12340535968542099, mean p set: 0.4465501010417938
loss_pred:0.013791747391223907, decouple_loss:0.0006307860021479428
loss_pred:0.014846681617200375, decouple_loss:0.0006244055111892521
Iteration: 1152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44682034850120544, gen p mean: -0.12270575761795044, mean p set: 0.44739529490470886
loss_pred:0.014460410922765732, decouple_loss:0.0006602506036870182
The modified gen p mean: 0.4474576711654663, gen p mean: -0.125589981675148, mean p set: 0.4480327367782593The modified gen p mean: 0.44721123576164246, gen p mean: -0.12262452393770218, mean p set: 0.4477875828742981
loss_pred:0.014545080251991749, decouple_loss:0.0010467196116223931
loss_pred:0.015174866653978825, decouple_loss:0.0008291619597002864
Iteration: 1153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694051146507263, gen p mean: -0.12129751592874527, mean p set: 0.44751641154289246
loss_pred:0.014569823630154133, decouple_loss:0.000605627428740263
The modified gen p mean: 0.44661232829093933, gen p mean: -0.12459506094455719, mean p set: 0.4471876323223114
loss_pred:0.01510298065841198, decouple_loss:0.0006222277879714966
The modified gen p mean: 0.44693148136138916, gen p mean: -0.1210893914103508, mean p set: 0.4475066065788269
loss_pred:0.013749923557043076, decouple_loss:0.0005762228975072503
Iteration: 1154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44709673523902893, gen p mean: -0.11472663283348083, mean p set: 0.4476739168167114
loss_pred:0.014904750511050224, decouple_loss:0.0005443572881631553
The modified gen p mean: 0.44811615347862244, gen p mean: -0.11453922092914581, mean p set: 0.44869264960289
loss_pred:0.014307400211691856, decouple_loss:0.0004578322113957256
The modified gen p mean: 0.4468594491481781, gen p mean: -0.12117414176464081, mean p set: 0.4474334716796875
loss_pred:0.014868318103253841, decouple_loss:0.0006231621955521405
Iteration: 1155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729509949684143, gen p mean: -0.11209968477487564, mean p set: 0.44786933064460754
loss_pred:0.014668039046227932, decouple_loss:0.0006812510546296835
The modified gen p mean: 0.44805172085762024, gen p mean: -0.11333536356687546, mean p set: 0.44862768054008484
loss_pred:0.014180673286318779, decouple_loss:0.0007054032175801694
The modified gen p mean: 0.44650784134864807, gen p mean: -0.116993747651577, mean p set: 0.44708362221717834
loss_pred:0.014540156349539757, decouple_loss:0.0006536839064210653
Iteration: 1156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483071267604828, gen p mean: -0.11417903006076813, mean p set: 0.44888240098953247
loss_pred:0.014207042753696442, decouple_loss:0.0005939272232353687
The modified gen p mean: 0.44658443331718445, gen p mean: -0.1183948889374733, mean p set: 0.44715800881385803
loss_pred:0.013622401282191277, decouple_loss:0.0007047959952615201
The modified gen p mean: 0.44735902547836304, gen p mean: -0.12193310260772705, mean p set: 0.447934627532959
loss_pred:0.015043916180729866, decouple_loss:0.0005389520665630698
Iteration: 1157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44684356451034546, gen p mean: -0.12011035531759262, mean p set: 0.447416752576828
loss_pred:0.014239722862839699, decouple_loss:0.0005502885323949158
The modified gen p mean: 0.44710978865623474, gen p mean: -0.12123261392116547, mean p set: 0.4476839005947113
The modified gen p mean: 0.4466950297355652, gen p mean: -0.12298785150051117, mean p set: 0.4472716748714447
loss_pred:0.013388531282544136, decouple_loss:0.000573451048694551
loss_pred:0.01554166991263628, decouple_loss:0.000645243504550308
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012001_3_24hr.npz
NaN value num: 0
Iteration: 1158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44564467668533325, gen p mean: -0.12762151658535004, mean p set: 0.4462227523326874
loss_pred:0.014619595371186733, decouple_loss:0.0007725260220468044
The modified gen p mean: 0.44649258255958557, gen p mean: -0.12514381110668182, mean p set: 0.4470709264278412
The modified gen p mean: 0.4471471309661865, gen p mean: -0.12402656674385071, mean p set: 0.44772249460220337
loss_pred:0.016295647248625755, decouple_loss:0.0005893191555514932
loss_pred:0.015443875454366207, decouple_loss:0.0006802612915635109
Iteration: 1159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816914200782776, gen p mean: -0.12214687466621399, mean p set: 0.4487445652484894
loss_pred:0.015252815559506416, decouple_loss:0.0005641773459501565
The modified gen p mean: 0.4463856518268585, gen p mean: -0.12195029854774475, mean p set: 0.44696107506752014
loss_pred:0.015570102259516716, decouple_loss:0.0005816038465127349
The modified gen p mean: 0.4480736553668976, gen p mean: -0.12042279541492462, mean p set: 0.4486530125141144
loss_pred:0.015718379989266396, decouple_loss:0.0004719111311715096
Iteration: 1160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474601149559021, gen p mean: -0.11654286086559296, mean p set: 0.44803762435913086
loss_pred:0.015275920741260052, decouple_loss:0.0006231617298908532
The modified gen p mean: 0.4469713866710663, gen p mean: -0.1176564022898674, mean p set: 0.44754740595817566
loss_pred:0.01566375233232975, decouple_loss:0.0006982148042879999
The modified gen p mean: 0.4454832375049591, gen p mean: -0.12266089767217636, mean p set: 0.4460570514202118
loss_pred:0.014591063372790813, decouple_loss:0.0006436418043449521
2023-05-01 19:57:47 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11587508022785187, mean p set: 0.4502691626548767
loss_pred:0.017117809504270554, decouple_loss:0.0006272670580074191
The modified gen p mean: 0.4495341181755066, gen p mean: -0.1099374070763588, mean p set: 0.4500633478164673
loss_pred:0.016402481123805046, decouple_loss:0.000774037791416049
The modified gen p mean: 0.44977909326553345, gen p mean: -0.10987704247236252, mean p set: 0.45035696029663086
loss_pred:0.016677750274538994, decouple_loss:0.0006519075250253081
WV_1_PC_1_EH_0_PS_40, loss: 0.016766902059316635, avg_mse: 0.026107406243681908
current test mse: 0.026107
Iteration: 1161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44815772771835327, gen p mean: -0.11502408981323242, mean p set: 0.44873204827308655
loss_pred:0.014518547803163528, decouple_loss:0.0007164219859987497
The modified gen p mean: 0.4471313953399658, gen p mean: -0.11120865494012833, mean p set: 0.4477066397666931
loss_pred:0.015167481265962124, decouple_loss:0.0006828681216575205
The modified gen p mean: 0.4475681483745575, gen p mean: -0.11354529112577438, mean p set: 0.4481431543827057
loss_pred:0.014788072556257248, decouple_loss:0.00048715865705162287
Iteration: 1162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44871217012405396, gen p mean: -0.11360902339220047, mean p set: 0.44928810000419617
loss_pred:0.015203247778117657, decouple_loss:0.0005710386321879923
The modified gen p mean: 0.44851598143577576, gen p mean: -0.11822906881570816, mean p set: 0.449090838432312The modified gen p mean: 0.44805818796157837, gen p mean: -0.11586233228445053, mean p set: 0.4486336410045624
loss_pred:0.014878017827868462, decouple_loss:0.0006075144628994167
loss_pred:0.015103277750313282, decouple_loss:0.0005130508216097951
Iteration: 1163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44740331172943115, gen p mean: -0.11443176120519638, mean p set: 0.4479806125164032
loss_pred:0.014665406197309494, decouple_loss:0.0008746222010813653
The modified gen p mean: 0.4468488395214081, gen p mean: -0.11791976541280746, mean p set: 0.44742488861083984
loss_pred:0.015916218981146812, decouple_loss:0.0007261783466674387
The modified gen p mean: 0.4469238519668579, gen p mean: -0.11614826321601868, mean p set: 0.4475022256374359
loss_pred:0.01501519326120615, decouple_loss:0.0006853258819319308
Iteration: 1164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4451390206813812, gen p mean: -0.12395606935024261, mean p set: 0.44571492075920105
loss_pred:0.01456044428050518, decouple_loss:0.0008177413837984204
The modified gen p mean: 0.4471055865287781, gen p mean: -0.11867482215166092, mean p set: 0.44768208265304565
loss_pred:0.014416594058275223, decouple_loss:0.0009162988280877471
The modified gen p mean: 0.44719359278678894, gen p mean: -0.11672186106443405, mean p set: 0.44777190685272217
loss_pred:0.014232110232114792, decouple_loss:0.0009115688153542578
Iteration: 1165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721123576164246, gen p mean: -0.12057836353778839, mean p set: 0.44778627157211304
loss_pred:0.01488130446523428, decouple_loss:0.0004890242707915604
The modified gen p mean: 0.4480566084384918, gen p mean: -0.12018900364637375, mean p set: 0.4486321210861206
loss_pred:0.014581527560949326, decouple_loss:0.0006281161913648248
The modified gen p mean: 0.4459379315376282, gen p mean: -0.12564004957675934, mean p set: 0.44651445746421814
loss_pred:0.014422371052205563, decouple_loss:0.0005720210028812289
Iteration: 1166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465353488922119, gen p mean: -0.11903883516788483, mean p set: 0.4471120834350586
The modified gen p mean: 0.44734203815460205, gen p mean: -0.11865784972906113, mean p set: 0.4479168951511383
loss_pred:0.015261398628354073, decouple_loss:0.0007856982410885394
loss_pred:0.014433490112423897, decouple_loss:0.0005916309892199934
The modified gen p mean: 0.4487023949623108, gen p mean: -0.12562133371829987, mean p set: 0.44927650690078735
loss_pred:0.014409705996513367, decouple_loss:0.0009244619868695736
Iteration: 1167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447198748588562, gen p mean: -0.11599041521549225, mean p set: 0.4477720260620117
loss_pred:0.014894286170601845, decouple_loss:0.0006022152956575155
The modified gen p mean: 0.44629737734794617, gen p mean: -0.12135416269302368, mean p set: 0.44687342643737793
The modified gen p mean: 0.4459187984466553, gen p mean: -0.11480171978473663, mean p set: 0.44649171829223633
loss_pred:0.015937065705657005, decouple_loss:0.0008997179102152586
loss_pred:0.015405734069645405, decouple_loss:0.00084578653331846
Iteration: 1168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479469656944275, gen p mean: -0.12031988799571991, mean p set: 0.4485243558883667
loss_pred:0.014513595029711723, decouple_loss:0.0004847435047850013
The modified gen p mean: 0.4483404755592346, gen p mean: -0.12144479155540466, mean p set: 0.4489142596721649
loss_pred:0.014768973924219608, decouple_loss:0.0005721785128116608
The modified gen p mean: 0.44786182045936584, gen p mean: -0.12011124193668365, mean p set: 0.44843539595603943
loss_pred:0.014357882551848888, decouple_loss:0.0005256583099253476
Iteration: 1169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777145981788635, gen p mean: -0.11957920342683792, mean p set: 0.4483468234539032
loss_pred:0.014313493855297565, decouple_loss:0.00047155076754279435
The modified gen p mean: 0.448258638381958, gen p mean: -0.11651250720024109, mean p set: 0.4488321542739868
loss_pred:0.014697771519422531, decouple_loss:0.0006072066607885063
The modified gen p mean: 0.44765549898147583, gen p mean: -0.12257266044616699, mean p set: 0.44823282957077026
loss_pred:0.01533488929271698, decouple_loss:0.00050310546066612
Iteration: 1170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758129119873047, gen p mean: -0.12166552245616913, mean p set: 0.44815605878829956
loss_pred:0.014794555492699146, decouple_loss:0.0007150555029511452
The modified gen p mean: 0.44891566038131714, gen p mean: -0.12414626777172089, mean p set: 0.44949212670326233
loss_pred:0.014537109062075615, decouple_loss:0.0006614921148866415
The modified gen p mean: 0.44713661074638367, gen p mean: -0.11954140663146973, mean p set: 0.4477138817310333
loss_pred:0.01472530048340559, decouple_loss:0.0005417850916273892
2023-05-01 19:59:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12477241456508636, mean p set: 0.4502691626548767
loss_pred:0.01708018220961094, decouple_loss:0.0006486957427114248
The modified gen p mean: 0.4495365619659424, gen p mean: -0.11864452809095383, mean p set: 0.4500633478164673
loss_pred:0.016487276181578636, decouple_loss:0.0005973714287392795
The modified gen p mean: 0.44978204369544983, gen p mean: -0.11849360167980194, mean p set: 0.45035696029663086
loss_pred:0.01678525097668171, decouple_loss:0.0005794401513412595
WV_1_PC_1_EH_0_PS_40, loss: 0.016814662143588066, avg_mse: 0.026214340701699257
current test mse: 0.026214
Iteration: 1171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465692341327667, gen p mean: -0.12264466285705566, mean p set: 0.44714486598968506
loss_pred:0.0152045376598835, decouple_loss:0.000626499589998275
The modified gen p mean: 0.44689902663230896, gen p mean: -0.12270413339138031, mean p set: 0.44747447967529297
loss_pred:0.01475229486823082, decouple_loss:0.0004871984419878572
The modified gen p mean: 0.4460591673851013, gen p mean: -0.12204888463020325, mean p set: 0.4466347098350525
loss_pred:0.014514289796352386, decouple_loss:0.000628241861704737
Iteration: 1172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479398727416992, gen p mean: -0.12190694361925125, mean p set: 0.4485151767730713
loss_pred:0.014551819302141666, decouple_loss:0.0005571949877776206
The modified gen p mean: 0.4458756148815155, gen p mean: -0.12510323524475098, mean p set: 0.4464513063430786The modified gen p mean: 0.44644036889076233, gen p mean: -0.12388880550861359, mean p set: 0.44701406359672546
loss_pred:0.015460802242159843, decouple_loss:0.0005847732536494732
loss_pred:0.015560554340481758, decouple_loss:0.0006309166783466935
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772869348526, gen p mean: -0.1183212623000145, mean p set: 0.4483067989349365
loss_pred:0.015402684919536114, decouple_loss:0.000765290460549295
The modified gen p mean: 0.4480200409889221, gen p mean: -0.11852391064167023, mean p set: 0.44859448075294495
loss_pred:0.015368448570370674, decouple_loss:0.00073035410605371
The modified gen p mean: 0.4478997588157654, gen p mean: -0.12336919456720352, mean p set: 0.44847849011421204
loss_pred:0.014627044089138508, decouple_loss:0.0007286175969056785
Iteration: 1174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780972599983215, gen p mean: -0.12254040688276291, mean p set: 0.4483872950077057
loss_pred:0.014636672101914883, decouple_loss:0.0009258475038222969
The modified gen p mean: 0.44699084758758545, gen p mean: -0.11973258852958679, mean p set: 0.4475656747817993
loss_pred:0.014834272675216198, decouple_loss:0.0007009095279499888
The modified gen p mean: 0.4485642611980438, gen p mean: -0.1253330260515213, mean p set: 0.44913914799690247
loss_pred:0.015184946358203888, decouple_loss:0.0005903441342525184
Iteration: 1175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469953179359436, gen p mean: -0.11696659028530121, mean p set: 0.44757208228111267
loss_pred:0.01455250009894371, decouple_loss:0.0006178061594255269
The modified gen p mean: 0.44761165976524353, gen p mean: -0.12074647843837738, mean p set: 0.44818755984306335
loss_pred:0.015043473802506924, decouple_loss:0.0005310750566422939
The modified gen p mean: 0.44635269045829773, gen p mean: -0.11696238815784454, mean p set: 0.4469250440597534
loss_pred:0.015892384573817253, decouple_loss:0.0005963296862319112
Iteration: 1176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465927183628082, gen p mean: -0.11827658861875534, mean p set: 0.44717034697532654
loss_pred:0.015695419162511826, decouple_loss:0.0008567117038182914
The modified gen p mean: 0.4487203061580658, gen p mean: -0.1189061775803566, mean p set: 0.44929662346839905
loss_pred:0.01450563594698906, decouple_loss:0.0008329062256962061
The modified gen p mean: 0.4462948441505432, gen p mean: -0.11718340963125229, mean p set: 0.44687098264694214
loss_pred:0.014276598580181599, decouple_loss:0.0006633177981711924
Iteration: 1177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44613415002822876, gen p mean: -0.1195889562368393, mean p set: 0.4467092752456665
loss_pred:0.015584792010486126, decouple_loss:0.0009019364952109754
The modified gen p mean: 0.446778267621994, gen p mean: -0.11776641756296158, mean p set: 0.4473552703857422
loss_pred:0.014864083379507065, decouple_loss:0.0007034202571958303
The modified gen p mean: 0.44666677713394165, gen p mean: -0.11455389112234116, mean p set: 0.4472406804561615
loss_pred:0.01485581323504448, decouple_loss:0.0006154656293801963
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012017_3_24hr.npz
NaN value num: 0
Iteration: 1178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45147591829299927, gen p mean: -0.11026152968406677, mean p set: 0.45205479860305786
The modified gen p mean: 0.4515126943588257, gen p mean: -0.10944647341966629, mean p set: 0.45208823680877686loss_pred:0.015733856707811356, decouple_loss:0.000843572139274329
loss_pred:0.016097163781523705, decouple_loss:0.0008116025128401816
The modified gen p mean: 0.45175158977508545, gen p mean: -0.11341822892427444, mean p set: 0.4523274898529053
loss_pred:0.016531968489289284, decouple_loss:0.0007294159149751067
Iteration: 1179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203709602355957, gen p mean: -0.10542906820774078, mean p set: 0.45261338353157043
loss_pred:0.01618058606982231, decouple_loss:0.0006079947925172746
The modified gen p mean: 0.45200133323669434, gen p mean: -0.10587745904922485, mean p set: 0.452579140663147
The modified gen p mean: 0.4514128863811493, gen p mean: -0.10779637843370438, mean p set: 0.4519910514354706
loss_pred:0.016040900722146034, decouple_loss:0.0005828379653394222
loss_pred:0.01641734316945076, decouple_loss:0.0008236549911089242
Iteration: 1180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514710605144501, gen p mean: -0.10623472929000854, mean p set: 0.4520479440689087
loss_pred:0.015806756913661957, decouple_loss:0.0010183167178183794
The modified gen p mean: 0.45099908113479614, gen p mean: -0.10717954486608505, mean p set: 0.45157474279403687
loss_pred:0.015886418521404266, decouple_loss:0.0011143374722450972
The modified gen p mean: 0.4512963593006134, gen p mean: -0.10394415259361267, mean p set: 0.4518716335296631
loss_pred:0.015816017985343933, decouple_loss:0.0009724338306114078
2023-05-01 20:02:35 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11993733793497086, mean p set: 0.4502691626548767
loss_pred:0.017018653452396393, decouple_loss:0.0012628573458641768
The modified gen p mean: 0.4495338201522827, gen p mean: -0.11425270885229111, mean p set: 0.4500633478164673
loss_pred:0.016395356506109238, decouple_loss:0.0011045847786590457
The modified gen p mean: 0.4497811198234558, gen p mean: -0.11410161852836609, mean p set: 0.45035696029663086
loss_pred:0.016729556024074554, decouple_loss:0.0011535262456163764
WV_1_PC_1_EH_0_PS_40, loss: 0.016773205250501633, avg_mse: 0.026077503338456154
current test mse: 0.026078
Iteration: 1181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45114731788635254, gen p mean: -0.10471602529287338, mean p set: 0.45172441005706787
loss_pred:0.016246745362877846, decouple_loss:0.0009518590522930026
The modified gen p mean: 0.4519505202770233, gen p mean: -0.11368292570114136, mean p set: 0.4525282084941864The modified gen p mean: 0.4519351124763489, gen p mean: -0.1030389666557312, mean p set: 0.4525144100189209
loss_pred:0.015897873789072037, decouple_loss:0.0012115545105189085
loss_pred:0.016206108033657074, decouple_loss:0.0011110889026895165
Iteration: 1182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519318640232086, gen p mean: -0.11036457866430283, mean p set: 0.4525078237056732
loss_pred:0.016288429498672485, decouple_loss:0.0006399635458365083
The modified gen p mean: 0.4522118866443634, gen p mean: -0.10170746594667435, mean p set: 0.4527874290943146The modified gen p mean: 0.4521408975124359, gen p mean: -0.10510142892599106, mean p set: 0.4527184069156647
loss_pred:0.016181327402591705, decouple_loss:0.0007705059833824635loss_pred:0.015907732769846916, decouple_loss:0.0006794545915909111
Iteration: 1183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45204296708106995, gen p mean: -0.1048828735947609, mean p set: 0.4526216387748718
loss_pred:0.01578923687338829, decouple_loss:0.0010760457953438163
The modified gen p mean: 0.45077070593833923, gen p mean: -0.1100841835141182, mean p set: 0.45134681463241577
loss_pred:0.015965357422828674, decouple_loss:0.0007533703465014696
The modified gen p mean: 0.4499576985836029, gen p mean: -0.10194026678800583, mean p set: 0.45053553581237793
loss_pred:0.01635873317718506, decouple_loss:0.0007750208023935556
Iteration: 1184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45100003480911255, gen p mean: -0.10336380451917648, mean p set: 0.4515799880027771
loss_pred:0.01638128235936165, decouple_loss:0.0012039581779390574
The modified gen p mean: 0.45126768946647644, gen p mean: -0.10811489820480347, mean p set: 0.45184382796287537
loss_pred:0.015556298196315765, decouple_loss:0.0011426557321101427
The modified gen p mean: 0.4524124264717102, gen p mean: -0.10312317311763763, mean p set: 0.4529881477355957
loss_pred:0.016516538336873055, decouple_loss:0.001411990262567997
Iteration: 1185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529072046279907, gen p mean: -0.10457424819469452, mean p set: 0.4534855782985687
loss_pred:0.015603049658238888, decouple_loss:0.0007690785569138825
The modified gen p mean: 0.45045533776283264, gen p mean: -0.1071489006280899, mean p set: 0.4510296881198883
loss_pred:0.01677844300866127, decouple_loss:0.0007072294829413295
The modified gen p mean: 0.450036883354187, gen p mean: -0.10058978199958801, mean p set: 0.45061367750167847
loss_pred:0.01618402637541294, decouple_loss:0.0006329619791358709
Iteration: 1186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520936906337738, gen p mean: -0.1068735122680664, mean p set: 0.4526708424091339
loss_pred:0.015744298696517944, decouple_loss:0.0007264454616233706
The modified gen p mean: 0.4514677822589874, gen p mean: -0.10296060144901276, mean p set: 0.45204487442970276
loss_pred:0.015343506820499897, decouple_loss:0.0007661347626708448
The modified gen p mean: 0.4510706663131714, gen p mean: -0.1060534417629242, mean p set: 0.45164716243743896
loss_pred:0.01601308397948742, decouple_loss:0.0007438502507284284
Iteration: 1187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520519971847534, gen p mean: -0.10589853674173355, mean p set: 0.45262742042541504The modified gen p mean: 0.4515805244445801, gen p mean: -0.10467606782913208, mean p set: 0.4521573483943939
loss_pred:0.015596587210893631, decouple_loss:0.0008431048481725156
loss_pred:0.01615624874830246, decouple_loss:0.0007931509171612561
The modified gen p mean: 0.4518697261810303, gen p mean: -0.11357270181179047, mean p set: 0.45244550704956055
loss_pred:0.015780668705701828, decouple_loss:0.0009912457317113876
Iteration: 1188, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514453709125519, gen p mean: -0.11257375031709671, mean p set: 0.4520227611064911
loss_pred:0.016042668372392654, decouple_loss:0.0007599256932735443
The modified gen p mean: 0.4510108232498169, gen p mean: -0.11109437048435211, mean p set: 0.4515860676765442
loss_pred:0.016416573897004128, decouple_loss:0.0006703677936457098
The modified gen p mean: 0.4510989785194397, gen p mean: -0.11081144213676453, mean p set: 0.4516755938529968
loss_pred:0.01572023704648018, decouple_loss:0.0006621703505516052
Iteration: 1189, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128798484802246, gen p mean: -0.11091721057891846, mean p set: 0.4518626928329468
The modified gen p mean: 0.4515030086040497, gen p mean: -0.10978168994188309, mean p set: 0.45208021998405457
loss_pred:0.016137784346938133, decouple_loss:0.0011618451680988073
loss_pred:0.01495075412094593, decouple_loss:0.0011681824689731002
The modified gen p mean: 0.45115140080451965, gen p mean: -0.11068058013916016, mean p set: 0.451729416847229
loss_pred:0.016156477853655815, decouple_loss:0.0012878546258434653
Iteration: 1190, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514826536178589, gen p mean: -0.10771719366312027, mean p set: 0.4520612061023712
loss_pred:0.016254262998700142, decouple_loss:0.0012638755142688751
The modified gen p mean: 0.45174941420555115, gen p mean: -0.11042610555887222, mean p set: 0.4523273706436157
loss_pred:0.0161301102489233, decouple_loss:0.0012562520569190383
The modified gen p mean: 0.4520566761493683, gen p mean: -0.108112633228302, mean p set: 0.4526340067386627
loss_pred:0.01572001911699772, decouple_loss:0.0009298837976530194
2023-05-01 20:04:40 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12348423153162003, mean p set: 0.4502691626548767
loss_pred:0.01716330647468567, decouple_loss:0.000804824463557452
The modified gen p mean: 0.44953668117523193, gen p mean: -0.11756287515163422, mean p set: 0.4500633478164673
loss_pred:0.01649094745516777, decouple_loss:0.0010652049677446485
The modified gen p mean: 0.4497809410095215, gen p mean: -0.11781666427850723, mean p set: 0.45035696029663086
loss_pred:0.016797181218862534, decouple_loss:0.0009924527257680893
WV_1_PC_1_EH_0_PS_40, loss: 0.016864854842424393, avg_mse: 0.02620980702340603
current test mse: 0.02621
Iteration: 1191, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128557085990906, gen p mean: -0.10896142572164536, mean p set: 0.45186206698417664
loss_pred:0.016233619302511215, decouple_loss:0.0008903952548280358
The modified gen p mean: 0.4514136016368866, gen p mean: -0.10656621307134628, mean p set: 0.4519905745983124The modified gen p mean: 0.4516224265098572, gen p mean: -0.11165042221546173, mean p set: 0.45219916105270386
loss_pred:0.015636270865797997, decouple_loss:0.0007892131106927991
loss_pred:0.01616649702191353, decouple_loss:0.0007419292815029621
Iteration: 1192, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191046595573425, gen p mean: -0.11326504498720169, mean p set: 0.4524872899055481
loss_pred:0.015632806345820427, decouple_loss:0.0008916243677958846
The modified gen p mean: 0.45250850915908813, gen p mean: -0.10765556246042252, mean p set: 0.4530870020389557The modified gen p mean: 0.4495283365249634, gen p mean: -0.10326224565505981, mean p set: 0.4501059055328369
loss_pred:0.015713239088654518, decouple_loss:0.0008140261052176356
loss_pred:0.01599659025669098, decouple_loss:0.0005837631179019809
Iteration: 1193, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991061091423035, gen p mean: -0.11291492730379105, mean p set: 0.4504854083061218
loss_pred:0.017344476655125618, decouple_loss:0.0007770590600557625
The modified gen p mean: 0.45126888155937195, gen p mean: -0.11162327229976654, mean p set: 0.4518454968929291
loss_pred:0.015971679240465164, decouple_loss:0.0005332131986506283
The modified gen p mean: 0.45142489671707153, gen p mean: -0.10546734929084778, mean p set: 0.45199981331825256
loss_pred:0.015352848917245865, decouple_loss:0.0009019612334668636
Iteration: 1194, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451541543006897, gen p mean: -0.10852921009063721, mean p set: 0.45211732387542725
loss_pred:0.0160648413002491, decouple_loss:0.0010157133219763637
The modified gen p mean: 0.4504493474960327, gen p mean: -0.10839454084634781, mean p set: 0.4510248601436615
loss_pred:0.015689335763454437, decouple_loss:0.0009374757064506412
The modified gen p mean: 0.4504580497741699, gen p mean: -0.114232137799263, mean p set: 0.4510330855846405
loss_pred:0.01586325652897358, decouple_loss:0.0009151751291938126
Iteration: 1195, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520518183708191, gen p mean: -0.11004000157117844, mean p set: 0.452627569437027
loss_pred:0.016568241640925407, decouple_loss:0.001699935644865036
The modified gen p mean: 0.45260924100875854, gen p mean: -0.11305022239685059, mean p set: 0.4531855285167694
loss_pred:0.01600700058043003, decouple_loss:0.0009249817812815309
The modified gen p mean: 0.449634313583374, gen p mean: -0.11087317019701004, mean p set: 0.45021140575408936
loss_pred:0.01631196402013302, decouple_loss:0.0006377818062901497
Iteration: 1196, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515204131603241, gen p mean: -0.11469754576683044, mean p set: 0.45209604501724243
loss_pred:0.016086768358945847, decouple_loss:0.0008575491374358535
The modified gen p mean: 0.449330598115921, gen p mean: -0.10753119736909866, mean p set: 0.4499078094959259
loss_pred:0.01614009216427803, decouple_loss:0.0008524743025191128
The modified gen p mean: 0.4518543779850006, gen p mean: -0.1109461635351181, mean p set: 0.45243212580680847
loss_pred:0.015977784991264343, decouple_loss:0.0007967686979100108
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012009_3_24hr.npz
NaN value num: 0
Iteration: 1197, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486994445323944, gen p mean: -0.11805269122123718, mean p set: 0.4492754638195038
loss_pred:0.01576121523976326, decouple_loss:0.001247196109034121
The modified gen p mean: 0.4472663998603821, gen p mean: -0.12301145493984222, mean p set: 0.44784191250801086
loss_pred:0.015699192881584167, decouple_loss:0.0013031404232606292
The modified gen p mean: 0.4484250247478485, gen p mean: -0.12065235525369644, mean p set: 0.44900041818618774
loss_pred:0.0150989955291152, decouple_loss:0.0008442496764473617
Iteration: 1198, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479386806488037, gen p mean: -0.11754631251096725, mean p set: 0.4485120475292206
loss_pred:0.01660347171127796, decouple_loss:0.00097891956102103
The modified gen p mean: 0.4476848840713501, gen p mean: -0.12199027836322784, mean p set: 0.44826194643974304
The modified gen p mean: 0.447030633687973, gen p mean: -0.1212908923625946, mean p set: 0.4476076066493988
loss_pred:0.015930861234664917, decouple_loss:0.0008153589442372322
loss_pred:0.015498116612434387, decouple_loss:0.0009376065572723746
Iteration: 1199, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671568274497986, gen p mean: -0.12351221591234207, mean p set: 0.4472885727882385
loss_pred:0.016505993902683258, decouple_loss:0.0010241193231195211
The modified gen p mean: 0.4453906714916229, gen p mean: -0.125360369682312, mean p set: 0.445966511964798
The modified gen p mean: 0.4463297128677368, gen p mean: -0.1238398626446724, mean p set: 0.4469049572944641
loss_pred:0.015837591141462326, decouple_loss:0.0006196168251335621
loss_pred:0.015727907419204712, decouple_loss:0.0006833428051322699
Iteration: 1200, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476410448551178, gen p mean: -0.12209596484899521, mean p set: 0.44821611046791077
loss_pred:0.015820980072021484, decouple_loss:0.001289710053242743
The modified gen p mean: 0.4467913806438446, gen p mean: -0.12031413614749908, mean p set: 0.44736772775650024
The modified gen p mean: 0.44811275601387024, gen p mean: -0.1227794736623764, mean p set: 0.44869065284729004
loss_pred:0.01537608914077282, decouple_loss:0.0013263142900541425
loss_pred:0.015343572944402695, decouple_loss:0.0013634380884468555
2023-05-01 20:07:23 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1267886608839035, mean p set: 0.4502691626548767
loss_pred:0.017105521634221077, decouple_loss:0.0013654133072122931
The modified gen p mean: 0.44953566789627075, gen p mean: -0.12083037942647934, mean p set: 0.4500633478164673
loss_pred:0.01652224175632, decouple_loss:0.0014298519818112254
The modified gen p mean: 0.44978001713752747, gen p mean: -0.1211981400847435, mean p set: 0.45035696029663086
loss_pred:0.016849515959620476, decouple_loss:0.0012143169296905398
WV_1_PC_1_EH_0_PS_40, loss: 0.016892587766051292, avg_mse: 0.02626519463956356
current test mse: 0.026265
Iteration: 1201, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482686221599579, gen p mean: -0.12481219321489334, mean p set: 0.4488462209701538
loss_pred:0.015475016087293625, decouple_loss:0.0013245547888800502
The modified gen p mean: 0.44821420311927795, gen p mean: -0.11785275489091873, mean p set: 0.4487912356853485The modified gen p mean: 0.44605153799057007, gen p mean: -0.12571752071380615, mean p set: 0.4466274678707123
loss_pred:0.01575986109673977, decouple_loss:0.0011704694479703903loss_pred:0.015623428858816624, decouple_loss:0.0012939866865053773
Iteration: 1202, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44841963052749634, gen p mean: -0.12229688465595245, mean p set: 0.4489942789077759
loss_pred:0.015283124521374702, decouple_loss:0.001308977953158319
The modified gen p mean: 0.4473319947719574, gen p mean: -0.12106499075889587, mean p set: 0.4479130506515503The modified gen p mean: 0.44731658697128296, gen p mean: -0.12225992977619171, mean p set: 0.44789430499076843
loss_pred:0.01512812077999115, decouple_loss:0.0010608521988615394
loss_pred:0.015331152826547623, decouple_loss:0.00104407814797014
Iteration: 1203, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471849799156189, gen p mean: -0.1263023018836975, mean p set: 0.44775715470314026
loss_pred:0.015453540720045567, decouple_loss:0.0007757616112940013
The modified gen p mean: 0.44683462381362915, gen p mean: -0.12996028363704681, mean p set: 0.44740915298461914
loss_pred:0.01579885184764862, decouple_loss:0.000706072140019387
The modified gen p mean: 0.44860368967056274, gen p mean: -0.1281469166278839, mean p set: 0.449184387922287
loss_pred:0.015108630992472172, decouple_loss:0.0008869401644915342
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1204, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774574041366577, gen p mean: -0.12131175398826599, mean p set: 0.4483223557472229
loss_pred:0.01495225727558136, decouple_loss:0.0010113100288435817
The modified gen p mean: 0.4471045732498169, gen p mean: -0.1267465054988861, mean p set: 0.44767752289772034
loss_pred:0.01528094056993723, decouple_loss:0.0007611024775542319
The modified gen p mean: 0.4485204219818115, gen p mean: -0.12321685999631882, mean p set: 0.44909462332725525
loss_pred:0.015017269179224968, decouple_loss:0.0008155563846230507
Iteration: 1205, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475196599960327, gen p mean: -0.12519405782222748, mean p set: 0.4480946362018585
loss_pred:0.015393154695630074, decouple_loss:0.0013314647367224097
The modified gen p mean: 0.44549354910850525, gen p mean: -0.1276649832725525, mean p set: 0.44606801867485046
loss_pred:0.01557551696896553, decouple_loss:0.001274001901037991
The modified gen p mean: 0.44719427824020386, gen p mean: -0.12075986713171005, mean p set: 0.4477689266204834
loss_pred:0.015747198835015297, decouple_loss:0.0013374664122238755
Iteration: 1206, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477204978466034, gen p mean: -0.12242340296506882, mean p set: 0.4482978880405426
loss_pred:0.015405120328068733, decouple_loss:0.0012190466513857245
The modified gen p mean: 0.4479226768016815, gen p mean: -0.12445007264614105, mean p set: 0.4484986364841461
The modified gen p mean: 0.4461429715156555, gen p mean: -0.12470067292451859, mean p set: 0.44671642780303955
loss_pred:0.015193488448858261, decouple_loss:0.0009977546287700534
loss_pred:0.015493891201913357, decouple_loss:0.0012175082229077816
Iteration: 1207, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469861686229706, gen p mean: -0.12288401275873184, mean p set: 0.447562575340271
loss_pred:0.015508020296692848, decouple_loss:0.0006358858081512153
The modified gen p mean: 0.4470435380935669, gen p mean: -0.12456213682889938, mean p set: 0.44761988520622253
loss_pred:0.015515272505581379, decouple_loss:0.0007248879410326481
The modified gen p mean: 0.44722840189933777, gen p mean: -0.11835562437772751, mean p set: 0.44780421257019043
loss_pred:0.01487723458558321, decouple_loss:0.000714952009730041
Iteration: 1208, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482996463775635, gen p mean: -0.1188211515545845, mean p set: 0.44887441396713257
loss_pred:0.015075495466589928, decouple_loss:0.0007164576090872288
The modified gen p mean: 0.44769808650016785, gen p mean: -0.11532613635063171, mean p set: 0.44827497005462646
loss_pred:0.014638669788837433, decouple_loss:0.0007886668317951262
The modified gen p mean: 0.44707128405570984, gen p mean: -0.11944743245840073, mean p set: 0.447646826505661
loss_pred:0.015268153510987759, decouple_loss:0.0006946593057364225
Iteration: 1209, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44606146216392517, gen p mean: -0.12569822371006012, mean p set: 0.4466353952884674
loss_pred:0.015069757588207722, decouple_loss:0.0008610694203525782
The modified gen p mean: 0.4465227425098419, gen p mean: -0.12619467079639435, mean p set: 0.44709834456443787
The modified gen p mean: 0.44688257575035095, gen p mean: -0.12314514815807343, mean p set: 0.44745954871177673
loss_pred:0.015466555021703243, decouple_loss:0.0008701689657755196
loss_pred:0.015323257073760033, decouple_loss:0.0009756837971508503
Iteration: 1210, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484507441520691, gen p mean: -0.11764473468065262, mean p set: 0.44902777671813965
loss_pred:0.01508279051631689, decouple_loss:0.0009427187615074217
The modified gen p mean: 0.44750767946243286, gen p mean: -0.12469367682933807, mean p set: 0.44808489084243774
loss_pred:0.015117676928639412, decouple_loss:0.0007980766822583973
The modified gen p mean: 0.44921281933784485, gen p mean: -0.12094231694936752, mean p set: 0.449787974357605
loss_pred:0.014980703592300415, decouple_loss:0.000687064602971077
2023-05-01 20:09:30 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12756900489330292, mean p set: 0.4502691626548767
loss_pred:0.017040589824318886, decouple_loss:0.000795571890193969
The modified gen p mean: 0.4495343565940857, gen p mean: -0.1219455823302269, mean p set: 0.4500633478164673
loss_pred:0.01648993045091629, decouple_loss:0.0009613033616915345
The modified gen p mean: 0.44977882504463196, gen p mean: -0.12191305309534073, mean p set: 0.45035696029663086
loss_pred:0.016789626330137253, decouple_loss:0.000833818397950381
WV_1_PC_1_EH_0_PS_40, loss: 0.01681656204164028, avg_mse: 0.02620026282966137
current test mse: 0.0262
Iteration: 1211, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473996162414551, gen p mean: -0.12332504242658615, mean p set: 0.4479758143424988
loss_pred:0.014572575688362122, decouple_loss:0.0007993853068910539
The modified gen p mean: 0.4460606873035431, gen p mean: -0.12713544070720673, mean p set: 0.4466356933116913The modified gen p mean: 0.4474395215511322, gen p mean: -0.11919659376144409, mean p set: 0.44801437854766846
loss_pred:0.015120419673621655, decouple_loss:0.0007667896570637822
loss_pred:0.01510262954980135, decouple_loss:0.0008466018480248749
Iteration: 1212, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473012387752533, gen p mean: -0.1272987723350525, mean p set: 0.4478735327720642The modified gen p mean: 0.44670286774635315, gen p mean: -0.1289399415254593, mean p set: 0.44727712869644165
loss_pred:0.015478067100048065, decouple_loss:0.0008247446967288852
loss_pred:0.014624550938606262, decouple_loss:0.0008795072208158672
The modified gen p mean: 0.446885347366333, gen p mean: -0.12386199086904526, mean p set: 0.4474617540836334
loss_pred:0.01513008400797844, decouple_loss:0.0006876722909510136
Iteration: 1213, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449734091758728, gen p mean: -0.1241331398487091, mean p set: 0.45031026005744934
loss_pred:0.015177140943706036, decouple_loss:0.001127825235016644
The modified gen p mean: 0.44793540239334106, gen p mean: -0.12369535118341446, mean p set: 0.44851356744766235
loss_pred:0.015246250666677952, decouple_loss:0.0006935750134289265
The modified gen p mean: 0.44934001564979553, gen p mean: -0.12533792853355408, mean p set: 0.4499136209487915
loss_pred:0.015230792574584484, decouple_loss:0.0011800291249528527
Iteration: 1214, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459962546825409, gen p mean: -0.13037754595279694, mean p set: 0.44656795263290405
The modified gen p mean: 0.4492955505847931, gen p mean: -0.12408046424388885, mean p set: 0.449869304895401
loss_pred:0.015479900874197483, decouple_loss:0.0007177625084295869
loss_pred:0.015215176157653332, decouple_loss:0.00061464449390769
The modified gen p mean: 0.4475758969783783, gen p mean: -0.12895792722702026, mean p set: 0.4481530487537384
loss_pred:0.01490756031125784, decouple_loss:0.0008103247382678092
Iteration: 1215, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474359452724457, gen p mean: -0.13287466764450073, mean p set: 0.44801008701324463
The modified gen p mean: 0.4482235908508301, gen p mean: -0.12899048626422882, mean p set: 0.4488007128238678
loss_pred:0.015022410079836845, decouple_loss:0.0005230093956924975
loss_pred:0.014896856620907784, decouple_loss:0.0005431896424852312
The modified gen p mean: 0.44673827290534973, gen p mean: -0.12859749794006348, mean p set: 0.4473150670528412
loss_pred:0.015942825004458427, decouple_loss:0.0008176590199582279
Iteration: 1216, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447510689496994, gen p mean: -0.13066299259662628, mean p set: 0.448087215423584
The modified gen p mean: 0.4471820890903473, gen p mean: -0.133652463555336, mean p set: 0.44775891304016113
loss_pred:0.014940931461751461, decouple_loss:0.0006554663414135575
loss_pred:0.015498613007366657, decouple_loss:0.0005442298715934157
The modified gen p mean: 0.4490024745464325, gen p mean: -0.1336224228143692, mean p set: 0.44957879185676575
loss_pred:0.01460889633744955, decouple_loss:0.0007482803193852305
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012011_3_24hr.npz
NaN value num: 0
Iteration: 1217, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460095167160034, gen p mean: -0.13118518888950348, mean p set: 0.4465877413749695
The modified gen p mean: 0.44825515151023865, gen p mean: -0.13041216135025024, mean p set: 0.44883236289024353
loss_pred:0.016905387863516808, decouple_loss:0.0009993371786549687
loss_pred:0.017057567834854126, decouple_loss:0.0007268209010362625
The modified gen p mean: 0.44783326983451843, gen p mean: -0.12397707998752594, mean p set: 0.4484068751335144
loss_pred:0.016529705375432968, decouple_loss:0.0010846867226064205
Iteration: 1218, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478682577610016, gen p mean: -0.12354058772325516, mean p set: 0.44844383001327515
loss_pred:0.01577274687588215, decouple_loss:0.0007295268005691469
The modified gen p mean: 0.4495066702365875, gen p mean: -0.12686960399150848, mean p set: 0.45008379220962524
loss_pred:0.016031211242079735, decouple_loss:0.0007233839714899659
The modified gen p mean: 0.4483899176120758, gen p mean: -0.13004423677921295, mean p set: 0.4489644169807434
loss_pred:0.015812009572982788, decouple_loss:0.0007271133363246918
Iteration: 1219, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687139987945557, gen p mean: -0.12295722216367722, mean p set: 0.44744521379470825
loss_pred:0.016776593402028084, decouple_loss:0.000819208100438118
The modified gen p mean: 0.44737154245376587, gen p mean: -0.1221606656908989, mean p set: 0.4479452073574066
loss_pred:0.01578579843044281, decouple_loss:0.0011958309914916754
The modified gen p mean: 0.4469105303287506, gen p mean: -0.12223333865404129, mean p set: 0.44748660922050476
loss_pred:0.016219615936279297, decouple_loss:0.0005598230636678636
Iteration: 1220, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475988447666168, gen p mean: -0.12290240079164505, mean p set: 0.44817492365837097
loss_pred:0.015661735087633133, decouple_loss:0.0008133650990203023
The modified gen p mean: 0.44779178500175476, gen p mean: -0.11709792912006378, mean p set: 0.44836878776550293
loss_pred:0.0162841584533453, decouple_loss:0.0005398445064201951
The modified gen p mean: 0.44806969165802, gen p mean: -0.12001833319664001, mean p set: 0.4486440122127533
loss_pred:0.01689717546105385, decouple_loss:0.0006299957167357206
2023-05-01 20:12:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12331501394510269, mean p set: 0.4502691626548767
loss_pred:0.01708698645234108, decouple_loss:0.0006620245985686779
The modified gen p mean: 0.44953638315200806, gen p mean: -0.11722283065319061, mean p set: 0.4500633478164673
loss_pred:0.016404416412115097, decouple_loss:0.0006050945958122611
The modified gen p mean: 0.4497787654399872, gen p mean: -0.11759740114212036, mean p set: 0.45035696029663086
loss_pred:0.016709862276911736, decouple_loss:0.0006788548780605197
WV_1_PC_1_EH_0_PS_40, loss: 0.01676618866622448, avg_mse: 0.026130616664886475
current test mse: 0.026131
Iteration: 1221, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477726221084595, gen p mean: -0.11732562631368637, mean p set: 0.44834744930267334
loss_pred:0.017104389145970345, decouple_loss:0.0005987284239381552
The modified gen p mean: 0.4474642276763916, gen p mean: -0.11923706531524658, mean p set: 0.4480408728122711The modified gen p mean: 0.4469059705734253, gen p mean: -0.12060227245092392, mean p set: 0.44747960567474365
loss_pred:0.017004812136292458, decouple_loss:0.0006250313599593937
loss_pred:0.01577318273484707, decouple_loss:0.0005977465771138668
Iteration: 1222, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746366143226624, gen p mean: -0.12197050452232361, mean p set: 0.44804099202156067
loss_pred:0.016388962045311928, decouple_loss:0.0006247568526305258
The modified gen p mean: 0.44831180572509766, gen p mean: -0.12638205289840698, mean p set: 0.4488913118839264The modified gen p mean: 0.4475342333316803, gen p mean: -0.12387105822563171, mean p set: 0.44811269640922546
loss_pred:0.016276709735393524, decouple_loss:0.0004970879526808858
loss_pred:0.01681065931916237, decouple_loss:0.0005426420830190182
Iteration: 1223, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474393129348755, gen p mean: -0.12931635975837708, mean p set: 0.4480130672454834
loss_pred:0.016451174393296242, decouple_loss:0.0007495361496694386
The modified gen p mean: 0.4474823772907257, gen p mean: -0.13034726679325104, mean p set: 0.4480586349964142
The modified gen p mean: 0.446921706199646, gen p mean: -0.1274387687444687, mean p set: 0.4474983811378479
loss_pred:0.016637736931443214, decouple_loss:0.0007910409476608038
loss_pred:0.016403671354055405, decouple_loss:0.0005201534950174391
Iteration: 1224, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44681262969970703, gen p mean: -0.12758910655975342, mean p set: 0.4473893940448761
loss_pred:0.0168901514261961, decouple_loss:0.0006103888154029846
The modified gen p mean: 0.44701483845710754, gen p mean: -0.12894652783870697, mean p set: 0.44758832454681396
loss_pred:0.01769818551838398, decouple_loss:0.0006520446040667593
The modified gen p mean: 0.44714638590812683, gen p mean: -0.13098227977752686, mean p set: 0.4477272629737854
loss_pred:0.01656530424952507, decouple_loss:0.000485242810100317
Iteration: 1225, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44837093353271484, gen p mean: -0.12474403530359268, mean p set: 0.44894686341285706
loss_pred:0.016479112207889557, decouple_loss:0.0006287541473284364
The modified gen p mean: 0.4479312002658844, gen p mean: -0.1242905706167221, mean p set: 0.4485074579715729
loss_pred:0.015876393765211105, decouple_loss:0.0006324254209175706
The modified gen p mean: 0.4471891522407532, gen p mean: -0.12861987948417664, mean p set: 0.44776758551597595
loss_pred:0.016639893874526024, decouple_loss:0.00048339396016672254
Iteration: 1226, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464171528816223, gen p mean: -0.12501537799835205, mean p set: 0.4469919800758362
loss_pred:0.017494408413767815, decouple_loss:0.0006434695678763092
The modified gen p mean: 0.44780027866363525, gen p mean: -0.12393809854984283, mean p set: 0.4483754336833954
The modified gen p mean: 0.44750747084617615, gen p mean: -0.13121411204338074, mean p set: 0.4480820298194885
loss_pred:0.016445476561784744, decouple_loss:0.0006475058034993708
loss_pred:0.016155503690242767, decouple_loss:0.00046740929246880114
Iteration: 1227, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470064342021942, gen p mean: -0.12517693638801575, mean p set: 0.4475806653499603
loss_pred:0.016158251091837883, decouple_loss:0.0005032928893342614
The modified gen p mean: 0.44807133078575134, gen p mean: -0.12728247046470642, mean p set: 0.4486467242240906
The modified gen p mean: 0.4467858374118805, gen p mean: -0.13053420186042786, mean p set: 0.4473629891872406
loss_pred:0.016656160354614258, decouple_loss:0.0006714424816891551
loss_pred:0.01645701937377453, decouple_loss:0.0005150826182216406
Iteration: 1228, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493708610534668, gen p mean: -0.12809784710407257, mean p set: 0.44994887709617615
The modified gen p mean: 0.4489203095436096, gen p mean: -0.12573061883449554, mean p set: 0.4494989514350891
loss_pred:0.0162035059183836, decouple_loss:0.0007656420930288732
loss_pred:0.016434425488114357, decouple_loss:0.0006352907512336969
The modified gen p mean: 0.4476620852947235, gen p mean: -0.12854938209056854, mean p set: 0.44823703169822693
loss_pred:0.017602967098355293, decouple_loss:0.0007162363617680967
Iteration: 1229, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481866955757141, gen p mean: -0.1253604292869568, mean p set: 0.44876575469970703
loss_pred:0.016086148098111153, decouple_loss:0.0006017791456542909
The modified gen p mean: 0.448303759098053, gen p mean: -0.12830513715744019, mean p set: 0.448879599571228
loss_pred:0.016288265585899353, decouple_loss:0.0005761430948041379
The modified gen p mean: 0.4474831819534302, gen p mean: -0.12725868821144104, mean p set: 0.4480629861354828
loss_pred:0.016289222985506058, decouple_loss:0.0005281575140543282
Iteration: 1230, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467829465866089, gen p mean: -0.1262350231409073, mean p set: 0.44735774397850037
loss_pred:0.01638939045369625, decouple_loss:0.0005526845925487578
The modified gen p mean: 0.4478908181190491, gen p mean: -0.12880688905715942, mean p set: 0.44846805930137634
The modified gen p mean: 0.4476606547832489, gen p mean: -0.12075894325971603, mean p set: 0.4482339918613434
loss_pred:0.016936078667640686, decouple_loss:0.0005333730368874967
loss_pred:0.016413209959864616, decouple_loss:0.0005633632536046207
2023-05-01 20:14:16 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1286630481481552, mean p set: 0.4502691626548767
loss_pred:0.01710701361298561, decouple_loss:0.0005977796972729266
The modified gen p mean: 0.44953590631484985, gen p mean: -0.1223703995347023, mean p set: 0.4500633478164673
loss_pred:0.01643501967191696, decouple_loss:0.0006188796833157539
The modified gen p mean: 0.44978049397468567, gen p mean: -0.12224529683589935, mean p set: 0.45035696029663086
loss_pred:0.016782093793153763, decouple_loss:0.0006268338765949011
WV_1_PC_1_EH_0_PS_40, loss: 0.016805432736873627, avg_mse: 0.02619873359799385
current test mse: 0.026199
Iteration: 1231, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44745540618896484, gen p mean: -0.1251925379037857, mean p set: 0.4480300843715668
loss_pred:0.015923019498586655, decouple_loss:0.0006483427132479846
The modified gen p mean: 0.446336030960083, gen p mean: -0.12258980423212051, mean p set: 0.4469138979911804The modified gen p mean: 0.447818785905838, gen p mean: -0.12668024003505707, mean p set: 0.44839391112327576
loss_pred:0.017445573583245277, decouple_loss:0.0006498552393168211
loss_pred:0.016070788726210594, decouple_loss:0.0006575543666258454
Iteration: 1232, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474318027496338, gen p mean: -0.12933969497680664, mean p set: 0.44800424575805664
loss_pred:0.01580817811191082, decouple_loss:0.0005875225178897381
The modified gen p mean: 0.4473746418952942, gen p mean: -0.12754975259304047, mean p set: 0.44795146584510803The modified gen p mean: 0.4483387768268585, gen p mean: -0.12558123469352722, mean p set: 0.44891470670700073
loss_pred:0.01628827676177025, decouple_loss:0.0005438299849629402
loss_pred:0.015657097101211548, decouple_loss:0.0006477290880866349
Iteration: 1233, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4454316198825836, gen p mean: -0.1265784353017807, mean p set: 0.4460088610649109
loss_pred:0.016748161986470222, decouple_loss:0.000513525097630918
The modified gen p mean: 0.4489552676677704, gen p mean: -0.1276112198829651, mean p set: 0.4495314955711365
loss_pred:0.01680118218064308, decouple_loss:0.0006504648481495678
The modified gen p mean: 0.44872111082077026, gen p mean: -0.1270209699869156, mean p set: 0.4492984712123871
loss_pred:0.015598285011947155, decouple_loss:0.0006077970610931516
Iteration: 1234, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44739797711372375, gen p mean: -0.13800255954265594, mean p set: 0.44797322154045105
loss_pred:0.016835331916809082, decouple_loss:0.0005455997306853533
The modified gen p mean: 0.4477858245372772, gen p mean: -0.13509993255138397, mean p set: 0.4483628571033478
loss_pred:0.01771262288093567, decouple_loss:0.0005884197889827192
The modified gen p mean: 0.447439968585968, gen p mean: -0.13542293012142181, mean p set: 0.448015421628952
loss_pred:0.0157079566270113, decouple_loss:0.0006439567659981549
Iteration: 1235, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475279152393341, gen p mean: -0.13522286713123322, mean p set: 0.4481058716773987
loss_pred:0.016155030578374863, decouple_loss:0.0005919667892158031
The modified gen p mean: 0.4467494785785675, gen p mean: -0.13999156653881073, mean p set: 0.4473235011100769
loss_pred:0.017575375735759735, decouple_loss:0.0005465237190946937
The modified gen p mean: 0.4477710723876953, gen p mean: -0.14088906347751617, mean p set: 0.44834810495376587
loss_pred:0.0164006557315588, decouple_loss:0.000718666473403573
Iteration: 1236, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44816941022872925, gen p mean: -0.14204736053943634, mean p set: 0.4487498700618744
loss_pred:0.01553573552519083, decouple_loss:0.0004544858820736408
The modified gen p mean: 0.44830983877182007, gen p mean: -0.14057408273220062, mean p set: 0.4488873779773712
The modified gen p mean: 0.44570857286453247, gen p mean: -0.14061588048934937, mean p set: 0.44628140330314636
loss_pred:0.01675945147871971, decouple_loss:0.0006004991009831429
loss_pred:0.016719389706850052, decouple_loss:0.0007292390801012516
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012012_3_24hr.npz
NaN value num: 0
Iteration: 1237, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44644322991371155, gen p mean: -0.13697482645511627, mean p set: 0.44701918959617615
loss_pred:0.015902573242783546, decouple_loss:0.0005526390741579235
The modified gen p mean: 0.4457581639289856, gen p mean: -0.13496330380439758, mean p set: 0.4463328719139099
The modified gen p mean: 0.44798603653907776, gen p mean: -0.13615354895591736, mean p set: 0.44856566190719604
loss_pred:0.015414129011332989, decouple_loss:0.0005384890246205032
loss_pred:0.0152223976328969, decouple_loss:0.000630208698567003
Iteration: 1238, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44620388746261597, gen p mean: -0.1298004686832428, mean p set: 0.4467797577381134
loss_pred:0.015674972906708717, decouple_loss:0.0005622783792205155
The modified gen p mean: 0.44634708762168884, gen p mean: -0.12875723838806152, mean p set: 0.44692397117614746
The modified gen p mean: 0.447255402803421, gen p mean: -0.12967081367969513, mean p set: 0.44783177971839905
loss_pred:0.015795135870575905, decouple_loss:0.0005372419254854321
loss_pred:0.015772292390465736, decouple_loss:0.0005002333782613277
Iteration: 1239, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44674253463745117, gen p mean: -0.1265949308872223, mean p set: 0.44731974601745605
loss_pred:0.015198210254311562, decouple_loss:0.0006439617718569934
The modified gen p mean: 0.44724366068840027, gen p mean: -0.1264507919549942, mean p set: 0.44781920313835144
loss_pred:0.01566876471042633, decouple_loss:0.0006597244064323604
The modified gen p mean: 0.4467701017856598, gen p mean: -0.12328212708234787, mean p set: 0.4473433792591095
loss_pred:0.015625914558768272, decouple_loss:0.0007226378074847162
Iteration: 1240, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469220042228699, gen p mean: -0.11852296441793442, mean p set: 0.4474965035915375
loss_pred:0.014999358914792538, decouple_loss:0.0005935418303124607
The modified gen p mean: 0.44755348563194275, gen p mean: -0.11765105277299881, mean p set: 0.4481275677680969
The modified gen p mean: 0.44700857996940613, gen p mean: -0.12148420512676239, mean p set: 0.447585791349411
loss_pred:0.015417742542922497, decouple_loss:0.0005212757387198508
loss_pred:0.015390641056001186, decouple_loss:0.000644655607175082
2023-05-01 20:16:58 testing...
The modified gen p mean: 0.4497888684272766, gen p mean: -0.12130806595087051, mean p set: 0.4502691626548767
loss_pred:0.0171210914850235, decouple_loss:0.0006353362114168704
The modified gen p mean: 0.4495357871055603, gen p mean: -0.11497812718153, mean p set: 0.4500633478164673
loss_pred:0.016352631151676178, decouple_loss:0.000694973103236407
The modified gen p mean: 0.44978150725364685, gen p mean: -0.11484833806753159, mean p set: 0.45035696029663086
loss_pred:0.01679426059126854, decouple_loss:0.0006598872132599354
WV_1_PC_1_EH_0_PS_40, loss: 0.016789166256785393, avg_mse: 0.026136063039302826
current test mse: 0.026136
Iteration: 1241, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44687846302986145, gen p mean: -0.11611519008874893, mean p set: 0.4474518895149231
loss_pred:0.015385590493679047, decouple_loss:0.0005855459603480995
The modified gen p mean: 0.4471544027328491, gen p mean: -0.1220969632267952, mean p set: 0.44772762060165405
loss_pred:0.014745257794857025, decouple_loss:0.0005677645094692707
The modified gen p mean: 0.4474165439605713, gen p mean: -0.1153111532330513, mean p set: 0.4479915201663971
loss_pred:0.014964515343308449, decouple_loss:0.0005159404827281833
Iteration: 1242, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472278654575348, gen p mean: -0.12232853472232819, mean p set: 0.4478035867214203
loss_pred:0.015478398650884628, decouple_loss:0.0005386938573792577
The modified gen p mean: 0.44604721665382385, gen p mean: -0.11328773945569992, mean p set: 0.4466211497783661The modified gen p mean: 0.4466099739074707, gen p mean: -0.115990050137043, mean p set: 0.44718724489212036
loss_pred:0.015198597684502602, decouple_loss:0.0005005590501241386
loss_pred:0.01567784696817398, decouple_loss:0.0005519500118680298
Iteration: 1243, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467681646347046, gen p mean: -0.11664871871471405, mean p set: 0.4473459720611572
loss_pred:0.015736626461148262, decouple_loss:0.0005792034207843244
The modified gen p mean: 0.4469955265522003, gen p mean: -0.12144076079130173, mean p set: 0.4475724399089813The modified gen p mean: 0.44726279377937317, gen p mean: -0.12016838043928146, mean p set: 0.4478381872177124
loss_pred:0.01505326572805643, decouple_loss:0.0005916355876252055
loss_pred:0.015290765091776848, decouple_loss:0.0006200004136189818
Iteration: 1244, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469831883907318, gen p mean: -0.12885276973247528, mean p set: 0.4475582242012024
loss_pred:0.01487952284514904, decouple_loss:0.0005865046987310052
The modified gen p mean: 0.44832780957221985, gen p mean: -0.13071773946285248, mean p set: 0.4489026963710785
loss_pred:0.014903098344802856, decouple_loss:0.00043568946421146393
The modified gen p mean: 0.44644755125045776, gen p mean: -0.12592850625514984, mean p set: 0.44702303409576416
loss_pred:0.015459401533007622, decouple_loss:0.0005769802955910563
Iteration: 1245, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701898097991943, gen p mean: -0.12971821427345276, mean p set: 0.447593629360199
loss_pred:0.015032357536256313, decouple_loss:0.0005506560555659235
The modified gen p mean: 0.44775670766830444, gen p mean: -0.12973757088184357, mean p set: 0.44833290576934814
loss_pred:0.01502883993089199, decouple_loss:0.0004912673030048609
The modified gen p mean: 0.44792598485946655, gen p mean: -0.13149039447307587, mean p set: 0.44850221276283264
loss_pred:0.014958824031054974, decouple_loss:0.0005204477929510176
Iteration: 1246, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469590187072754, gen p mean: -0.13055646419525146, mean p set: 0.4475339949131012
loss_pred:0.015811877325177193, decouple_loss:0.0006062985630705953
The modified gen p mean: 0.44872990250587463, gen p mean: -0.13691358268260956, mean p set: 0.44930580258369446
loss_pred:0.01483754999935627, decouple_loss:0.0006219087517820299
The modified gen p mean: 0.44708481431007385, gen p mean: -0.13171032071113586, mean p set: 0.4476585388183594
loss_pred:0.015412621200084686, decouple_loss:0.0006138902972452343
Iteration: 1247, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460091292858124, gen p mean: -0.1202327311038971, mean p set: 0.44658011198043823
loss_pred:0.01574629731476307, decouple_loss:0.0005563169252127409
The modified gen p mean: 0.4458889961242676, gen p mean: -0.12577497959136963, mean p set: 0.4464643895626068
The modified gen p mean: 0.446890652179718, gen p mean: -0.12784625589847565, mean p set: 0.4474670886993408
loss_pred:0.015279963612556458, decouple_loss:0.0005788468988612294
loss_pred:0.01481037400662899, decouple_loss:0.0005830214940942824
Iteration: 1248, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44594070315361023, gen p mean: -0.12529805302619934, mean p set: 0.44651639461517334
loss_pred:0.01554314699023962, decouple_loss:0.0005989182973280549
The modified gen p mean: 0.44660863280296326, gen p mean: -0.12251675128936768, mean p set: 0.4471836984157562
loss_pred:0.015524538233876228, decouple_loss:0.000514318177010864
The modified gen p mean: 0.4467736780643463, gen p mean: -0.12493540346622467, mean p set: 0.44735097885131836
loss_pred:0.015038440935313702, decouple_loss:0.0005813821917399764
Iteration: 1249, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468134939670563, gen p mean: -0.1198129802942276, mean p set: 0.44738972187042236
loss_pred:0.015367347747087479, decouple_loss:0.0006253808969631791
The modified gen p mean: 0.4477156400680542, gen p mean: -0.11987517029047012, mean p set: 0.44829118251800537
The modified gen p mean: 0.4467056691646576, gen p mean: -0.12236654758453369, mean p set: 0.4472809433937073
loss_pred:0.014940895140171051, decouple_loss:0.0005483095883391798
loss_pred:0.015453407540917397, decouple_loss:0.0006366865709424019
Iteration: 1250, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44592946767807007, gen p mean: -0.12023677676916122, mean p set: 0.446504145860672
loss_pred:0.015408099628984928, decouple_loss:0.0008729840046726167
The modified gen p mean: 0.44799187779426575, gen p mean: -0.11815765500068665, mean p set: 0.448570191860199
The modified gen p mean: 0.44788655638694763, gen p mean: -0.1196749359369278, mean p set: 0.44846251606941223
loss_pred:0.015006553381681442, decouple_loss:0.0006350335897877812
loss_pred:0.014811891131103039, decouple_loss:0.0005952222854830325
2023-05-01 20:19:04 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1192784383893013, mean p set: 0.4502691626548767
loss_pred:0.017031950876116753, decouple_loss:0.0008936906815506518
The modified gen p mean: 0.4495355188846588, gen p mean: -0.11383107304573059, mean p set: 0.4500633478164673
loss_pred:0.016310404986143112, decouple_loss:0.0008727856911718845
The modified gen p mean: 0.44977959990501404, gen p mean: -0.11386886239051819, mean p set: 0.45035696029663086
loss_pred:0.016735101118683815, decouple_loss:0.0008982433355413377
WV_1_PC_1_EH_0_PS_40, loss: 0.016736898571252823, avg_mse: 0.026102205738425255
current test mse: 0.026102
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1251, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470991790294647, gen p mean: -0.1169334352016449, mean p set: 0.4476762115955353
loss_pred:0.014662494882941246, decouple_loss:0.0007643630960956216
The modified gen p mean: 0.4468204975128174, gen p mean: -0.11789391189813614, mean p set: 0.447394996881485
loss_pred:0.01530604436993599, decouple_loss:0.0006493573891930282
The modified gen p mean: 0.4467928409576416, gen p mean: -0.11328799277544022, mean p set: 0.447368860244751
loss_pred:0.015444367192685604, decouple_loss:0.0007182297413237393
Iteration: 1252, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642385840415955, gen p mean: -0.12194731831550598, mean p set: 0.44700121879577637
loss_pred:0.015387759543955326, decouple_loss:0.0005153621314093471
The modified gen p mean: 0.44686412811279297, gen p mean: -0.11715111136436462, mean p set: 0.4474417567253113The modified gen p mean: 0.44749441742897034, gen p mean: -0.1175873801112175, mean p set: 0.44806966185569763
loss_pred:0.01541928667575121, decouple_loss:0.000531091180164367
loss_pred:0.014887006022036076, decouple_loss:0.0004676066746469587
Iteration: 1253, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44607433676719666, gen p mean: -0.11586451530456543, mean p set: 0.4466512203216553
loss_pred:0.01568923331797123, decouple_loss:0.0006204207893460989
The modified gen p mean: 0.4461599588394165, gen p mean: -0.11965043097734451, mean p set: 0.44673141837120056The modified gen p mean: 0.4466668367385864, gen p mean: -0.1215023472905159, mean p set: 0.44724246859550476
loss_pred:0.015639306977391243, decouple_loss:0.0006916197598911822
loss_pred:0.014947161078453064, decouple_loss:0.000652936811093241
Iteration: 1254, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469860792160034, gen p mean: -0.12621361017227173, mean p set: 0.4475627839565277
The modified gen p mean: 0.4471328556537628, gen p mean: -0.12161965668201447, mean p set: 0.4477064609527588
loss_pred:0.013934210874140263, decouple_loss:0.0005670054815709591
loss_pred:0.014624352566897869, decouple_loss:0.0006550568505190313
The modified gen p mean: 0.44594553112983704, gen p mean: -0.12215965241193771, mean p set: 0.4465225338935852
loss_pred:0.015178494155406952, decouple_loss:0.00047985624405555427
Iteration: 1255, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44597122073173523, gen p mean: -0.11839699000120163, mean p set: 0.4465442895889282
loss_pred:0.015299168415367603, decouple_loss:0.0005663015763275325
The modified gen p mean: 0.44666755199432373, gen p mean: -0.12632375955581665, mean p set: 0.44724223017692566
loss_pred:0.015425886027514935, decouple_loss:0.0005484492867253721
The modified gen p mean: 0.44685977697372437, gen p mean: -0.12119411677122116, mean p set: 0.4474363923072815
loss_pred:0.015101009979844093, decouple_loss:0.0005247684894129634
Iteration: 1256, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772887229919434, gen p mean: -0.12173528224229813, mean p set: 0.4483036994934082
loss_pred:0.014575564302504063, decouple_loss:0.0004538917273748666
The modified gen p mean: 0.446490079164505, gen p mean: -0.12139318883419037, mean p set: 0.4470658302307129
The modified gen p mean: 0.44762173295021057, gen p mean: -0.12301962077617645, mean p set: 0.44819772243499756
loss_pred:0.01531139574944973, decouple_loss:0.0005999443819746375
loss_pred:0.015457945875823498, decouple_loss:0.000613630807492882
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012007_3_24hr.npz
NaN value num: 0
Iteration: 1257, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523690342903137, gen p mean: -0.11152400821447372, mean p set: 0.45294755697250366
loss_pred:0.014862794429063797, decouple_loss:0.0006180877098813653
The modified gen p mean: 0.45038700103759766, gen p mean: -0.11034268885850906, mean p set: 0.45096346735954285
The modified gen p mean: 0.45388224720954895, gen p mean: -0.10690184682607651, mean p set: 0.45446059107780457
loss_pred:0.016845665872097015, decouple_loss:0.0008056726073846221
loss_pred:0.014928869903087616, decouple_loss:0.0010116520570591092
Iteration: 1258, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521489441394806, gen p mean: -0.10984945297241211, mean p set: 0.4527256488800049
loss_pred:0.015429718419909477, decouple_loss:0.00047759211156517267
The modified gen p mean: 0.4526175558567047, gen p mean: -0.10549784451723099, mean p set: 0.4531942903995514
loss_pred:0.015936732292175293, decouple_loss:0.0006326736183837056
The modified gen p mean: 0.4510856866836548, gen p mean: -0.10295681655406952, mean p set: 0.4516623318195343
loss_pred:0.01606697030365467, decouple_loss:0.0006752117769792676
Iteration: 1259, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520554840564728, gen p mean: -0.10436201840639114, mean p set: 0.4526309072971344
loss_pred:0.01528321672230959, decouple_loss:0.000560566782951355
The modified gen p mean: 0.45262372493743896, gen p mean: -0.10537552088499069, mean p set: 0.4531993865966797
The modified gen p mean: 0.4521110951900482, gen p mean: -0.10576804727315903, mean p set: 0.4526892900466919
loss_pred:0.01594645157456398, decouple_loss:0.0008558649569749832
loss_pred:0.0161067433655262, decouple_loss:0.0006218912312760949
Iteration: 1260, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45213088393211365, gen p mean: -0.1065918430685997, mean p set: 0.45270848274230957
loss_pred:0.015785319730639458, decouple_loss:0.0006788538303226233
The modified gen p mean: 0.45072102546691895, gen p mean: -0.10597999393939972, mean p set: 0.4512959122657776
The modified gen p mean: 0.45217224955558777, gen p mean: -0.10613694787025452, mean p set: 0.45275095105171204
loss_pred:0.01511278934776783, decouple_loss:0.0008719494217075408
loss_pred:0.015338152647018433, decouple_loss:0.0008245589560829103
2023-05-01 20:21:51 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12033544480800629, mean p set: 0.4502691626548767
loss_pred:0.017035944387316704, decouple_loss:0.0010122753446921706
The modified gen p mean: 0.4495353698730469, gen p mean: -0.11418914794921875, mean p set: 0.4500633478164673
loss_pred:0.016300365328788757, decouple_loss:0.0008364396635442972
The modified gen p mean: 0.4497801959514618, gen p mean: -0.11425215750932693, mean p set: 0.45035696029663086
loss_pred:0.016678400337696075, decouple_loss:0.0007796743884682655
WV_1_PC_1_EH_0_PS_40, loss: 0.01671537570655346, avg_mse: 0.026024574413895607
current test mse: 0.026025
Iteration: 1261, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45191675424575806, gen p mean: -0.11078532785177231, mean p set: 0.4524921178817749
loss_pred:0.014728940092027187, decouple_loss:0.0007329742074944079
The modified gen p mean: 0.45216891169548035, gen p mean: -0.10584655404090881, mean p set: 0.4527444541454315
loss_pred:0.015272535383701324, decouple_loss:0.000600910687353462
The modified gen p mean: 0.4514199197292328, gen p mean: -0.10359961539506912, mean p set: 0.4519941210746765
loss_pred:0.015699876472353935, decouple_loss:0.000734600645955652
Iteration: 1262, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45105868577957153, gen p mean: -0.1087065190076828, mean p set: 0.4516349136829376
loss_pred:0.016612229868769646, decouple_loss:0.0008925817674025893
The modified gen p mean: 0.4504725933074951, gen p mean: -0.0974835604429245, mean p set: 0.4510493874549866The modified gen p mean: 0.4533831775188446, gen p mean: -0.10763973742723465, mean p set: 0.45395946502685547
loss_pred:0.017133045941591263, decouple_loss:0.0006745135760866106
loss_pred:0.015054705552756786, decouple_loss:0.0005968139739707112
Iteration: 1263, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520729184150696, gen p mean: -0.10801512002944946, mean p set: 0.45264923572540283
loss_pred:0.01576179452240467, decouple_loss:0.0007187745068222284
The modified gen p mean: 0.4512803554534912, gen p mean: -0.10885600745677948, mean p set: 0.4518548846244812
loss_pred:0.016145028173923492, decouple_loss:0.0007326931809075177
The modified gen p mean: 0.4506534934043884, gen p mean: -0.1026582270860672, mean p set: 0.4512292742729187
loss_pred:0.016938060522079468, decouple_loss:0.000722728087566793
Iteration: 1264, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201677083969116, gen p mean: -0.11365889012813568, mean p set: 0.4525940418243408
The modified gen p mean: 0.4521094560623169, gen p mean: -0.11196581274271011, mean p set: 0.45268580317497253
loss_pred:0.015215221792459488, decouple_loss:0.0005586110055446625
loss_pred:0.015666469931602478, decouple_loss:0.0006022532470524311
The modified gen p mean: 0.45159944891929626, gen p mean: -0.10821317881345749, mean p set: 0.4521760940551758
loss_pred:0.01604326255619526, decouple_loss:0.0006987914093770087
Iteration: 1265, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45088469982147217, gen p mean: -0.11275949329137802, mean p set: 0.45146000385284424
loss_pred:0.01540871150791645, decouple_loss:0.0008857411448843777
The modified gen p mean: 0.451213538646698, gen p mean: -0.1099868193268776, mean p set: 0.4517904222011566
loss_pred:0.0160555187612772, decouple_loss:0.0008515790104866028
The modified gen p mean: 0.4527277946472168, gen p mean: -0.1143389418721199, mean p set: 0.4533042907714844
loss_pred:0.015188643708825111, decouple_loss:0.0008367228438146412
Iteration: 1266, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45231136679649353, gen p mean: -0.11853834241628647, mean p set: 0.4528883397579193
The modified gen p mean: 0.4516006112098694, gen p mean: -0.11278694868087769, mean p set: 0.4521775543689728
loss_pred:0.015072174370288849, decouple_loss:0.0006179364863783121
loss_pred:0.0164182111620903, decouple_loss:0.0007916086469776928
The modified gen p mean: 0.4512304365634918, gen p mean: -0.1157192811369896, mean p set: 0.45180612802505493
loss_pred:0.015967531129717827, decouple_loss:0.0008103231666609645
Iteration: 1267, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507478177547455, gen p mean: -0.11610206216573715, mean p set: 0.4513244330883026
loss_pred:0.016050955280661583, decouple_loss:0.0007626820588484406
The modified gen p mean: 0.4507250487804413, gen p mean: -0.11650899797677994, mean p set: 0.45130228996276855
loss_pred:0.015055591240525246, decouple_loss:0.0009490156662650406
The modified gen p mean: 0.4509265124797821, gen p mean: -0.11787162721157074, mean p set: 0.4515043795108795
loss_pred:0.016348006203770638, decouple_loss:0.0007638659444637597
Iteration: 1268, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45077401399612427, gen p mean: -0.11119967699050903, mean p set: 0.4513503611087799
loss_pred:0.01600678823888302, decouple_loss:0.0006321120890788734
The modified gen p mean: 0.4508761167526245, gen p mean: -0.11390526592731476, mean p set: 0.451452374458313
loss_pred:0.015659274533391, decouple_loss:0.0005571475485339761
The modified gen p mean: 0.45126211643218994, gen p mean: -0.11548181623220444, mean p set: 0.4518386423587799
loss_pred:0.015927014872431755, decouple_loss:0.0007906826213002205
Iteration: 1269, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45296046137809753, gen p mean: -0.11363378167152405, mean p set: 0.4535389542579651
loss_pred:0.01563332788646221, decouple_loss:0.0006128063541837037
The modified gen p mean: 0.450986385345459, gen p mean: -0.11283334344625473, mean p set: 0.4515630006790161
loss_pred:0.016547290608286858, decouple_loss:0.0007735905819572508
The modified gen p mean: 0.45274028182029724, gen p mean: -0.11712124943733215, mean p set: 0.4533170461654663
loss_pred:0.015061749145388603, decouple_loss:0.0006246779230423272
Iteration: 1270, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524015188217163, gen p mean: -0.10731075704097748, mean p set: 0.45297735929489136
loss_pred:0.014838896691799164, decouple_loss:0.0008536231471225619
The modified gen p mean: 0.4505866765975952, gen p mean: -0.11061355471611023, mean p set: 0.4511641561985016
The modified gen p mean: 0.4512525200843811, gen p mean: -0.09987786412239075, mean p set: 0.45182904601097107
loss_pred:0.014754200354218483, decouple_loss:0.0008724139770492911
loss_pred:0.016677945852279663, decouple_loss:0.0009406498284079134
2023-05-01 20:23:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12220389395952225, mean p set: 0.4502691626548767
loss_pred:0.017170896753668785, decouple_loss:0.0011075548827648163
The modified gen p mean: 0.4495333731174469, gen p mean: -0.11618944257497787, mean p set: 0.4500633478164673
loss_pred:0.016447804868221283, decouple_loss:0.001027237856760621
The modified gen p mean: 0.44978010654449463, gen p mean: -0.11596239358186722, mean p set: 0.45035696029663086
loss_pred:0.01684069260954857, decouple_loss:0.0009184320806525648
WV_1_PC_1_EH_0_PS_40, loss: 0.016870684921741486, avg_mse: 0.02626756951212883
current test mse: 0.026268
Iteration: 1271, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45094507932662964, gen p mean: -0.11124533414840698, mean p set: 0.45152196288108826
loss_pred:0.01621449738740921, decouple_loss:0.0008871608879417181
The modified gen p mean: 0.453558087348938, gen p mean: -0.10654082149267197, mean p set: 0.4541351795196533
loss_pred:0.014823637902736664, decouple_loss:0.0008846118580549955
The modified gen p mean: 0.4517117440700531, gen p mean: -0.1081099659204483, mean p set: 0.45229020714759827
loss_pred:0.015526172704994678, decouple_loss:0.0007263963925652206
Iteration: 1272, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513241648674011, gen p mean: -0.10487549751996994, mean p set: 0.4519002437591553
loss_pred:0.014622348360717297, decouple_loss:0.000886345689650625
The modified gen p mean: 0.4538184702396393, gen p mean: -0.10554434359073639, mean p set: 0.45439326763153076The modified gen p mean: 0.4542376399040222, gen p mean: -0.10432647168636322, mean p set: 0.4548146724700928
loss_pred:0.015189126133918762, decouple_loss:0.0005951470229774714
loss_pred:0.015197554603219032, decouple_loss:0.0006175214657559991
Iteration: 1273, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45212218165397644, gen p mean: -0.105353944003582, mean p set: 0.45269855856895447
loss_pred:0.015170604921877384, decouple_loss:0.0005906465230509639
The modified gen p mean: 0.4522308111190796, gen p mean: -0.10504496842622757, mean p set: 0.45281070470809937The modified gen p mean: 0.45261600613594055, gen p mean: -0.10483069717884064, mean p set: 0.45319366455078125
loss_pred:0.01555547397583723, decouple_loss:0.0005925484001636505
loss_pred:0.01416570134460926, decouple_loss:0.0006810324266552925
Iteration: 1274, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526118040084839, gen p mean: -0.10164548456668854, mean p set: 0.45318663120269775
loss_pred:0.0159881804138422, decouple_loss:0.000575627142097801
The modified gen p mean: 0.45266664028167725, gen p mean: -0.10213936120271683, mean p set: 0.45324259996414185
loss_pred:0.015071322210133076, decouple_loss:0.000594677054323256
The modified gen p mean: 0.4526263475418091, gen p mean: -0.10100169479846954, mean p set: 0.45320072770118713
loss_pred:0.015291746705770493, decouple_loss:0.0006779229152016342
Iteration: 1275, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45044201612472534, gen p mean: -0.09769134223461151, mean p set: 0.4510186016559601
loss_pred:0.015980079770088196, decouple_loss:0.0007210826152004302
The modified gen p mean: 0.45284444093704224, gen p mean: -0.0981769859790802, mean p set: 0.4534226953983307
loss_pred:0.014712696895003319, decouple_loss:0.0007289775530807674
The modified gen p mean: 0.449759304523468, gen p mean: -0.09949687868356705, mean p set: 0.4503368139266968
loss_pred:0.015896502882242203, decouple_loss:0.0006726767751388252
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012015_3_24hr.npz
NaN value num: 0
Iteration: 1276, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44537320733070374, gen p mean: -0.11172828078269958, mean p set: 0.4459480941295624
loss_pred:0.015895139425992966, decouple_loss:0.0006772593478672206
The modified gen p mean: 0.44786587357521057, gen p mean: -0.10761071741580963, mean p set: 0.4484444558620453
The modified gen p mean: 0.44695717096328735, gen p mean: -0.11580782383680344, mean p set: 0.4475320279598236
loss_pred:0.016530172899365425, decouple_loss:0.0005667632212862372
loss_pred:0.015429255552589893, decouple_loss:0.0006793377106077969
Iteration: 1277, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44600409269332886, gen p mean: -0.11709018796682358, mean p set: 0.4465799629688263
loss_pred:0.015540236607193947, decouple_loss:0.0005526011227630079
The modified gen p mean: 0.44608256220817566, gen p mean: -0.11468402296304703, mean p set: 0.4466569721698761
loss_pred:0.01596711203455925, decouple_loss:0.000724844925571233
The modified gen p mean: 0.44704994559288025, gen p mean: -0.11775362491607666, mean p set: 0.4476243555545807
loss_pred:0.015688391402363777, decouple_loss:0.000551702338270843
Iteration: 1278, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673866033554077, gen p mean: -0.12177686393260956, mean p set: 0.44731536507606506
loss_pred:0.01609639823436737, decouple_loss:0.0007325325277633965
The modified gen p mean: 0.44694778323173523, gen p mean: -0.12214644998311996, mean p set: 0.44752374291419983
loss_pred:0.0163484588265419, decouple_loss:0.0007939161732792854
The modified gen p mean: 0.4457347095012665, gen p mean: -0.12350426614284515, mean p set: 0.44631072878837585
loss_pred:0.015485036186873913, decouple_loss:0.0006409464403986931
Iteration: 1279, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44569963216781616, gen p mean: -0.12296298891305923, mean p set: 0.446274995803833
loss_pred:0.01598685421049595, decouple_loss:0.000771250925026834
The modified gen p mean: 0.44708073139190674, gen p mean: -0.13003481924533844, mean p set: 0.44765836000442505
The modified gen p mean: 0.4458622336387634, gen p mean: -0.12951774895191193, mean p set: 0.4464392364025116
loss_pred:0.015598151832818985, decouple_loss:0.0007187246810644865
loss_pred:0.015778422355651855, decouple_loss:0.0008454984636045992
Iteration: 1280, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706571102142334, gen p mean: -0.13229714334011078, mean p set: 0.4476405084133148
loss_pred:0.01557362824678421, decouple_loss:0.0005837780772708356
The modified gen p mean: 0.4448254704475403, gen p mean: -0.1265677511692047, mean p set: 0.4453986883163452
loss_pred:0.016540955752134323, decouple_loss:0.0005619973526336253
The modified gen p mean: 0.4464074969291687, gen p mean: -0.1316768079996109, mean p set: 0.446982741355896
loss_pred:0.015548735857009888, decouple_loss:0.00062327622435987
2023-05-01 20:26:55 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13259989023208618, mean p set: 0.4502691626548767
loss_pred:0.01721726357936859, decouple_loss:0.0005351014551706612
The modified gen p mean: 0.44953495264053345, gen p mean: -0.1266430914402008, mean p set: 0.4500633478164673
loss_pred:0.016529886052012444, decouple_loss:0.000626772060059011
The modified gen p mean: 0.4497823119163513, gen p mean: -0.1263798177242279, mean p set: 0.45035696029663086
loss_pred:0.016800152137875557, decouple_loss:0.0007084279786795378
WV_1_PC_1_EH_0_PS_40, loss: 0.016880273818969727, avg_mse: 0.026237644255161285
current test mse: 0.026238
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1281, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44686657190322876, gen p mean: -0.12733645737171173, mean p set: 0.44744303822517395
loss_pred:0.01575525663793087, decouple_loss:0.0005068775499239564
The modified gen p mean: 0.44650357961654663, gen p mean: -0.13303397595882416, mean p set: 0.44707778096199036
The modified gen p mean: 0.4458180069923401, gen p mean: -0.13101457059383392, mean p set: 0.44639402627944946
loss_pred:0.015632955357432365, decouple_loss:0.0007973710307851434
loss_pred:0.015367415733635426, decouple_loss:0.0006011573714204133
Iteration: 1282, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716212153434753, gen p mean: -0.12914159893989563, mean p set: 0.44773659110069275
loss_pred:0.0154267568141222, decouple_loss:0.0007151633035391569
The modified gen p mean: 0.44706109166145325, gen p mean: -0.1269049346446991, mean p set: 0.4476345181465149The modified gen p mean: 0.4465075135231018, gen p mean: -0.12866461277008057, mean p set: 0.4470827281475067
loss_pred:0.015388024039566517, decouple_loss:0.0005228553782217205loss_pred:0.015370538458228111, decouple_loss:0.0006976707372814417
Iteration: 1283, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44559842348098755, gen p mean: -0.12444314360618591, mean p set: 0.446174293756485
loss_pred:0.015610679984092712, decouple_loss:0.0006694134790450335
The modified gen p mean: 0.4455420672893524, gen p mean: -0.12092585861682892, mean p set: 0.44611749053001404
loss_pred:0.015486531890928745, decouple_loss:0.0007094414904713631
The modified gen p mean: 0.4462071657180786, gen p mean: -0.12318199872970581, mean p set: 0.44678211212158203
loss_pred:0.015447176061570644, decouple_loss:0.0005434707854874432
Iteration: 1284, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44608864188194275, gen p mean: -0.11324121057987213, mean p set: 0.44666188955307007
loss_pred:0.0156883355230093, decouple_loss:0.000633354764431715
The modified gen p mean: 0.4466611444950104, gen p mean: -0.1148899644613266, mean p set: 0.44723621010780334
loss_pred:0.015422143042087555, decouple_loss:0.0005571319488808513
The modified gen p mean: 0.44656407833099365, gen p mean: -0.11884476244449615, mean p set: 0.44714006781578064
loss_pred:0.01581372134387493, decouple_loss:0.0006053893594071269
Iteration: 1285, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44729021191596985, gen p mean: -0.11294466257095337, mean p set: 0.4478660225868225
loss_pred:0.016282351687550545, decouple_loss:0.0007682145806029439
The modified gen p mean: 0.4463224411010742, gen p mean: -0.11291041225194931, mean p set: 0.4468989372253418
loss_pred:0.015318848192691803, decouple_loss:0.00045465584844350815
The modified gen p mean: 0.4471307396888733, gen p mean: -0.11531765758991241, mean p set: 0.44770827889442444
loss_pred:0.015990732237696648, decouple_loss:0.0005977914552204311
Iteration: 1286, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44671815633773804, gen p mean: -0.1122666671872139, mean p set: 0.44729533791542053
loss_pred:0.015053560957312584, decouple_loss:0.0006770557956770062
The modified gen p mean: 0.4463808238506317, gen p mean: -0.11277898401021957, mean p set: 0.44695594906806946
The modified gen p mean: 0.44669967889785767, gen p mean: -0.11235414445400238, mean p set: 0.4472745358943939
loss_pred:0.01484125666320324, decouple_loss:0.000627328350674361
loss_pred:0.015226423740386963, decouple_loss:0.0006688140565529466
Iteration: 1287, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468311667442322, gen p mean: -0.11168021708726883, mean p set: 0.447405070066452
loss_pred:0.01525820791721344, decouple_loss:0.0006440766155719757
The modified gen p mean: 0.44576430320739746, gen p mean: -0.11265630275011063, mean p set: 0.4463409185409546
The modified gen p mean: 0.44538089632987976, gen p mean: -0.11272013932466507, mean p set: 0.44595643877983093
loss_pred:0.015170345082879066, decouple_loss:0.0006336462101899087
loss_pred:0.015401645563542843, decouple_loss:0.000557140854652971
Iteration: 1288, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446429044008255, gen p mean: -0.10966549068689346, mean p set: 0.447003036737442
loss_pred:0.01554922666400671, decouple_loss:0.00044993459596298635
The modified gen p mean: 0.4457852840423584, gen p mean: -0.11224057525396347, mean p set: 0.4463599622249603
loss_pred:0.015436401590704918, decouple_loss:0.0006683547981083393
The modified gen p mean: 0.4464367926120758, gen p mean: -0.11141140758991241, mean p set: 0.4470106363296509
loss_pred:0.015505505725741386, decouple_loss:0.0004983580438420177
Iteration: 1289, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462723433971405, gen p mean: -0.1156759038567543, mean p set: 0.4468485414981842
loss_pred:0.015361934900283813, decouple_loss:0.0005950845661573112
The modified gen p mean: 0.44646647572517395, gen p mean: -0.11511630564928055, mean p set: 0.4470418095588684
loss_pred:0.015362651087343693, decouple_loss:0.00047384665231220424
The modified gen p mean: 0.4459018111228943, gen p mean: -0.10908719152212143, mean p set: 0.44647544622421265
loss_pred:0.016040867194533348, decouple_loss:0.0007099290378391743
Iteration: 1290, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462318420410156, gen p mean: -0.11218278855085373, mean p set: 0.4468083381652832
loss_pred:0.015577813610434532, decouple_loss:0.0006024877657182515
The modified gen p mean: 0.44697368144989014, gen p mean: -0.1151452362537384, mean p set: 0.44754984974861145
loss_pred:0.015320997685194016, decouple_loss:0.0006021244917064905
The modified gen p mean: 0.4475308656692505, gen p mean: -0.11546455323696136, mean p set: 0.4481041729450226
loss_pred:0.016117587685585022, decouple_loss:0.000621758634224534
2023-05-01 20:29:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11867101490497589, mean p set: 0.4502691626548767
loss_pred:0.017189668491482735, decouple_loss:0.0005921683041378856
The modified gen p mean: 0.4495331048965454, gen p mean: -0.11264358460903168, mean p set: 0.4500633478164673
loss_pred:0.01648619771003723, decouple_loss:0.0006396816461347044
The modified gen p mean: 0.44978028535842896, gen p mean: -0.11215761303901672, mean p set: 0.45035696029663086
loss_pred:0.01675707846879959, decouple_loss:0.0008316236198879778
WV_1_PC_1_EH_0_PS_40, loss: 0.016845373436808586, avg_mse: 0.026219559833407402
current test mse: 0.02622
Iteration: 1291, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44661808013916016, gen p mean: -0.11844824999570847, mean p set: 0.44719311594963074
loss_pred:0.015318352729082108, decouple_loss:0.0005893400521017611
The modified gen p mean: 0.44755566120147705, gen p mean: -0.11214656382799149, mean p set: 0.44812965393066406
The modified gen p mean: 0.4454697370529175, gen p mean: -0.11915162950754166, mean p set: 0.44604605436325073
loss_pred:0.015726089477539062, decouple_loss:0.0005592106026597321
loss_pred:0.015169117599725723, decouple_loss:0.0006047470960766077
Iteration: 1292, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4450790584087372, gen p mean: -0.11902306228876114, mean p set: 0.4456527829170227
loss_pred:0.015119582414627075, decouple_loss:0.0004555634513963014
The modified gen p mean: 0.4469592273235321, gen p mean: -0.11230811476707458, mean p set: 0.4475346803665161The modified gen p mean: 0.44555842876434326, gen p mean: -0.11446204781532288, mean p set: 0.44613370299339294
loss_pred:0.016138596460223198, decouple_loss:0.0005347238620743155loss_pred:0.01512919832020998, decouple_loss:0.00047552675823681056
Iteration: 1293, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463792145252228, gen p mean: -0.11386735737323761, mean p set: 0.44695156812667847
loss_pred:0.015190856531262398, decouple_loss:0.0005067707970738411
The modified gen p mean: 0.44409388303756714, gen p mean: -0.11195683479309082, mean p set: 0.44466984272003174
loss_pred:0.01574007049202919, decouple_loss:0.0007233177893795073
The modified gen p mean: 0.4469207227230072, gen p mean: -0.12080325931310654, mean p set: 0.44749611616134644
loss_pred:0.015189746394753456, decouple_loss:0.0006435125251300633
Iteration: 1294, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463484287261963, gen p mean: -0.1136031225323677, mean p set: 0.4469238221645355
loss_pred:0.015744773671030998, decouple_loss:0.0005147629999555647
The modified gen p mean: 0.4469693601131439, gen p mean: -0.11093143373727798, mean p set: 0.4475449025630951
loss_pred:0.0157028716057539, decouple_loss:0.0005412512109614909
The modified gen p mean: 0.44656285643577576, gen p mean: -0.11946556717157364, mean p set: 0.44713932275772095
loss_pred:0.01526680588722229, decouple_loss:0.0005577087868005037
Iteration: 1295, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464566707611084, gen p mean: -0.11875492334365845, mean p set: 0.4470359981060028
loss_pred:0.015036159195005894, decouple_loss:0.0005902978591620922
The modified gen p mean: 0.4470580518245697, gen p mean: -0.10937360674142838, mean p set: 0.44763532280921936
loss_pred:0.015791069716215134, decouple_loss:0.0006238806527107954
The modified gen p mean: 0.44548800587654114, gen p mean: -0.1173471063375473, mean p set: 0.44606199860572815
loss_pred:0.015344069339334965, decouple_loss:0.0005863524856977165
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012006_3_24hr.npz
NaN value num: 0
Iteration: 1296, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45324987173080444, gen p mean: -0.10838010907173157, mean p set: 0.4538280665874481
loss_pred:0.01639837771654129, decouple_loss:0.0007587631698697805
The modified gen p mean: 0.45173102617263794, gen p mean: -0.10485270619392395, mean p set: 0.45230671763420105
loss_pred:0.016488928347826004, decouple_loss:0.0007811011164449155
The modified gen p mean: 0.452776163816452, gen p mean: -0.10397320240736008, mean p set: 0.4533534049987793
loss_pred:0.0161578431725502, decouple_loss:0.0009883459424600005
Iteration: 1297, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533901512622833, gen p mean: -0.11098261922597885, mean p set: 0.45396625995635986
loss_pred:0.016613664105534554, decouple_loss:0.0007857352029532194
The modified gen p mean: 0.45265865325927734, gen p mean: -0.10003688186407089, mean p set: 0.45323580503463745
loss_pred:0.015668779611587524, decouple_loss:0.0006611581775359809
The modified gen p mean: 0.45209887623786926, gen p mean: -0.10193708539009094, mean p set: 0.4526754915714264
loss_pred:0.016436368227005005, decouple_loss:0.0007356543210335076
Iteration: 1298, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4535261392593384, gen p mean: -0.1011081412434578, mean p set: 0.4541010856628418
loss_pred:0.015351361595094204, decouple_loss:0.0007311321096494794
The modified gen p mean: 0.45276737213134766, gen p mean: -0.10585246980190277, mean p set: 0.4533441960811615
loss_pred:0.016045408323407173, decouple_loss:0.0008920480613596737
The modified gen p mean: 0.4501689374446869, gen p mean: -0.0989937037229538, mean p set: 0.45074325799942017
loss_pred:0.015523655340075493, decouple_loss:0.0007402684423141181
Iteration: 1299, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45231688022613525, gen p mean: -0.1027408093214035, mean p set: 0.4528941214084625
loss_pred:0.015734277665615082, decouple_loss:0.0007156007923185825
The modified gen p mean: 0.45228198170661926, gen p mean: -0.10356453061103821, mean p set: 0.4528588652610779
loss_pred:0.01569971814751625, decouple_loss:0.0009177375468425453
The modified gen p mean: 0.4524722695350647, gen p mean: -0.10424768924713135, mean p set: 0.453046590089798
loss_pred:0.015954216942191124, decouple_loss:0.00077370012877509
Iteration: 1300, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45342931151390076, gen p mean: -0.0977315902709961, mean p set: 0.4540044963359833
loss_pred:0.01652310974895954, decouple_loss:0.0006872660014778376
The modified gen p mean: 0.45226138830184937, gen p mean: -0.10174744576215744, mean p set: 0.4528396725654602
loss_pred:0.015568877570331097, decouple_loss:0.0007546564447693527
The modified gen p mean: 0.452788382768631, gen p mean: -0.10001063346862793, mean p set: 0.45336446166038513
loss_pred:0.015889206901192665, decouple_loss:0.0006678930367343128
2023-05-01 20:31:46 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11781954765319824, mean p set: 0.4502691626548767
loss_pred:0.01718311943113804, decouple_loss:0.0007823678315617144
The modified gen p mean: 0.44953596591949463, gen p mean: -0.11201009154319763, mean p set: 0.4500633478164673
loss_pred:0.016497602686285973, decouple_loss:0.0007110328297130764
The modified gen p mean: 0.4497818052768707, gen p mean: -0.11175532639026642, mean p set: 0.45035696029663086
loss_pred:0.016851086169481277, decouple_loss:0.0008928068564273417
WV_1_PC_1_EH_0_PS_40, loss: 0.01688370853662491, avg_mse: 0.026259800419211388
current test mse: 0.02626
Iteration: 1301, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530760943889618, gen p mean: -0.10248863697052002, mean p set: 0.4536536633968353
loss_pred:0.016371773555874825, decouple_loss:0.0009047004859894514
The modified gen p mean: 0.45334911346435547, gen p mean: -0.10624822974205017, mean p set: 0.45392709970474243The modified gen p mean: 0.45299458503723145, gen p mean: -0.10795066505670547, mean p set: 0.4535713493824005
loss_pred:0.01606844738125801, decouple_loss:0.0008242832263931632
loss_pred:0.015602587722241879, decouple_loss:0.0006633050506934524
Iteration: 1302, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536479115486145, gen p mean: -0.11511985957622528, mean p set: 0.4542261064052582
loss_pred:0.015800664201378822, decouple_loss:0.001268922002054751
The modified gen p mean: 0.453260213136673, gen p mean: -0.10309436917304993, mean p set: 0.45383745431900024The modified gen p mean: 0.4522956609725952, gen p mean: -0.10090819746255875, mean p set: 0.4528715908527374
loss_pred:0.01588607020676136, decouple_loss:0.0010817275615409017loss_pred:0.014793681912124157, decouple_loss:0.0010114501928910613
Iteration: 1303, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45293375849723816, gen p mean: -0.10786544531583786, mean p set: 0.4535074532032013
The modified gen p mean: 0.45319199562072754, gen p mean: -0.1041889637708664, mean p set: 0.4537711441516876
loss_pred:0.014937639236450195, decouple_loss:0.000659517478197813
loss_pred:0.015841906890273094, decouple_loss:0.0007094733300618827
The modified gen p mean: 0.45377734303474426, gen p mean: -0.1017790138721466, mean p set: 0.45435431599617004
loss_pred:0.015779782086610794, decouple_loss:0.0007319166325032711
Iteration: 1304, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45206353068351746, gen p mean: -0.10760220885276794, mean p set: 0.45264074206352234
loss_pred:0.016016898676753044, decouple_loss:0.0007721887668594718
The modified gen p mean: 0.45241761207580566, gen p mean: -0.1100555881857872, mean p set: 0.45299461483955383
loss_pred:0.01584836095571518, decouple_loss:0.0008017307845875621
The modified gen p mean: 0.4533214569091797, gen p mean: -0.10849739611148834, mean p set: 0.4538998007774353
loss_pred:0.014929620549082756, decouple_loss:0.0008090424817055464
Iteration: 1305, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45333507657051086, gen p mean: -0.11374978721141815, mean p set: 0.4539128243923187
loss_pred:0.01564529351890087, decouple_loss:0.0007028071559034288
The modified gen p mean: 0.45403024554252625, gen p mean: -0.11096375435590744, mean p set: 0.45460760593414307
loss_pred:0.015708599239587784, decouple_loss:0.000768478843383491
The modified gen p mean: 0.45295271277427673, gen p mean: -0.11001160740852356, mean p set: 0.453529417514801
loss_pred:0.015575711615383625, decouple_loss:0.0007212029304355383
Iteration: 1306, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45346468687057495, gen p mean: -0.10871904343366623, mean p set: 0.4540416896343231
loss_pred:0.01531063113361597, decouple_loss:0.0006646027322858572
The modified gen p mean: 0.4536823034286499, gen p mean: -0.1148238331079483, mean p set: 0.45425495505332947
loss_pred:0.01617440953850746, decouple_loss:0.0007986513082869351
The modified gen p mean: 0.4523739218711853, gen p mean: -0.10773424804210663, mean p set: 0.45295077562332153
loss_pred:0.014885603450238705, decouple_loss:0.0007678830297663808
Iteration: 1307, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45287415385246277, gen p mean: -0.112116739153862, mean p set: 0.45345136523246765
loss_pred:0.01591644063591957, decouple_loss:0.0010451135458424687
The modified gen p mean: 0.453110933303833, gen p mean: -0.10122279822826385, mean p set: 0.45369112491607666
loss_pred:0.016533272340893745, decouple_loss:0.0010703958105295897
The modified gen p mean: 0.45380181074142456, gen p mean: -0.11735805869102478, mean p set: 0.4543784260749817
loss_pred:0.01614431105554104, decouple_loss:0.0008892370969988406
Iteration: 1308, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45312073826789856, gen p mean: -0.11201648414134979, mean p set: 0.4536985456943512
loss_pred:0.0157859455794096, decouple_loss:0.0006446316256187856
The modified gen p mean: 0.45449572801589966, gen p mean: -0.10894560068845749, mean p set: 0.45507341623306274
loss_pred:0.015227665193378925, decouple_loss:0.0005786565598100424
The modified gen p mean: 0.454206645488739, gen p mean: -0.11783543974161148, mean p set: 0.4547848105430603
loss_pred:0.015499221161007881, decouple_loss:0.0006917895516380668
Iteration: 1309, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536692500114441, gen p mean: -0.11384404450654984, mean p set: 0.4542456865310669
loss_pred:0.016046766191720963, decouple_loss:0.0006598922773264349
The modified gen p mean: 0.4543416202068329, gen p mean: -0.10891567915678024, mean p set: 0.45491892099380493
loss_pred:0.01568599045276642, decouple_loss:0.0006193670560605824
The modified gen p mean: 0.45290568470954895, gen p mean: -0.11432544887065887, mean p set: 0.453481525182724
loss_pred:0.016144143417477608, decouple_loss:0.0008984749438241124
Iteration: 1310, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45426756143569946, gen p mean: -0.10756714642047882, mean p set: 0.45484453439712524
loss_pred:0.015082811005413532, decouple_loss:0.0007964792312122881
The modified gen p mean: 0.4524541199207306, gen p mean: -0.11358475685119629, mean p set: 0.4530305862426758
The modified gen p mean: 0.4523538053035736, gen p mean: -0.11194960027933121, mean p set: 0.45293015241622925
loss_pred:0.015567747876048088, decouple_loss:0.0006817913381382823
loss_pred:0.014667116105556488, decouple_loss:0.0006084282067604363
2023-05-01 20:33:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12403328716754913, mean p set: 0.4502691626548767
loss_pred:0.01723060943186283, decouple_loss:0.0012048662174493074
The modified gen p mean: 0.4495333433151245, gen p mean: -0.11815514415502548, mean p set: 0.4500633478164673
loss_pred:0.01660860702395439, decouple_loss:0.0009200518834404647
The modified gen p mean: 0.4497791528701782, gen p mean: -0.11791842430830002, mean p set: 0.45035696029663086
loss_pred:0.016827162355184555, decouple_loss:0.0012020089197903872
WV_1_PC_1_EH_0_PS_40, loss: 0.016944242641329765, avg_mse: 0.026276161894202232
current test mse: 0.026276
Iteration: 1311, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45059633255004883, gen p mean: -0.10987353324890137, mean p set: 0.451170951128006
loss_pred:0.01522874552756548, decouple_loss:0.000639239267911762
The modified gen p mean: 0.45286980271339417, gen p mean: -0.111460842192173, mean p set: 0.4534461498260498
loss_pred:0.016009381040930748, decouple_loss:0.0006967323715798557
The modified gen p mean: 0.4501718282699585, gen p mean: -0.11084336787462234, mean p set: 0.4507507383823395
loss_pred:0.015426000580191612, decouple_loss:0.0008031679899431765
Iteration: 1312, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45304039120674133, gen p mean: -0.11115168035030365, mean p set: 0.45361828804016113
loss_pred:0.015158726833760738, decouple_loss:0.0006518235895782709
The modified gen p mean: 0.4517969787120819, gen p mean: -0.10813344269990921, mean p set: 0.45237207412719727The modified gen p mean: 0.452676385641098, gen p mean: -0.10435254126787186, mean p set: 0.45325344800949097
loss_pred:0.0155403483659029, decouple_loss:0.0005915630026720464
loss_pred:0.015198411419987679, decouple_loss:0.0007704060990363359
Iteration: 1313, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45341211557388306, gen p mean: -0.09696369618177414, mean p set: 0.453988641500473
loss_pred:0.01626722514629364, decouple_loss:0.0009258498321287334
The modified gen p mean: 0.4539213180541992, gen p mean: -0.10970860719680786, mean p set: 0.4544958472251892
loss_pred:0.015824420377612114, decouple_loss:0.0006536431610584259
The modified gen p mean: 0.4538285732269287, gen p mean: -0.10216834396123886, mean p set: 0.4544040560722351
loss_pred:0.016119813546538353, decouple_loss:0.000754486012738198
Iteration: 1314, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529353976249695, gen p mean: -0.10775534063577652, mean p set: 0.45351284742355347
loss_pred:0.015770763158798218, decouple_loss:0.000759924587327987
The modified gen p mean: 0.45286405086517334, gen p mean: -0.10704471170902252, mean p set: 0.4534422755241394
loss_pred:0.015539422631263733, decouple_loss:0.000884494511410594
The modified gen p mean: 0.45233404636383057, gen p mean: -0.10756953060626984, mean p set: 0.4529087543487549
loss_pred:0.016178548336029053, decouple_loss:0.0008136092219501734
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012014_3_24hr.npz
NaN value num: 0
Iteration: 1315, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865819811820984, gen p mean: -0.10886585712432861, mean p set: 0.4492347836494446The modified gen p mean: 0.44890376925468445, gen p mean: -0.10912163555622101, mean p set: 0.44948065280914307
loss_pred:0.016355935484170914, decouple_loss:0.0008873446495272219
loss_pred:0.01619199849665165, decouple_loss:0.0006280702073127031
The modified gen p mean: 0.44887807965278625, gen p mean: -0.10907204449176788, mean p set: 0.4494549334049225
loss_pred:0.016764702275395393, decouple_loss:0.0007891725981608033
Iteration: 1316, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44834765791893005, gen p mean: -0.11320039629936218, mean p set: 0.4489240050315857
loss_pred:0.016324862837791443, decouple_loss:0.0008084028959274292
The modified gen p mean: 0.44828546047210693, gen p mean: -0.11271404474973679, mean p set: 0.44886186718940735
The modified gen p mean: 0.44954514503479004, gen p mean: -0.11090601235628128, mean p set: 0.45011773705482483
loss_pred:0.016673773527145386, decouple_loss:0.0007234197109937668
loss_pred:0.016710352152585983, decouple_loss:0.001096113002859056
Iteration: 1317, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450094610452652, gen p mean: -0.11194675415754318, mean p set: 0.45067182183265686
loss_pred:0.015836242586374283, decouple_loss:0.0010141065577045083
The modified gen p mean: 0.4488847553730011, gen p mean: -0.11295277625322342, mean p set: 0.4494612514972687
loss_pred:0.016391601413488388, decouple_loss:0.000789384008385241
The modified gen p mean: 0.44817402958869934, gen p mean: -0.11212030798196793, mean p set: 0.4487510621547699
loss_pred:0.016532793641090393, decouple_loss:0.0008047837764024734
Iteration: 1318, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45237401127815247, gen p mean: -0.11387733370065689, mean p set: 0.4529503583908081
loss_pred:0.016105040907859802, decouple_loss:0.0009022029698826373
The modified gen p mean: 0.4517669081687927, gen p mean: -0.11629088968038559, mean p set: 0.45234742760658264
loss_pred:0.015860306099057198, decouple_loss:0.0010613588383421302
The modified gen p mean: 0.4505324959754944, gen p mean: -0.1151650995016098, mean p set: 0.4511091411113739
loss_pred:0.01609007455408573, decouple_loss:0.0009562718332745135
Iteration: 1319, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489358961582184, gen p mean: -0.11928631365299225, mean p set: 0.4495103359222412
loss_pred:0.016343923285603523, decouple_loss:0.0010264771990478039
The modified gen p mean: 0.44935187697410583, gen p mean: -0.12223301827907562, mean p set: 0.4499289393424988
loss_pred:0.01570233143866062, decouple_loss:0.000766951940022409
The modified gen p mean: 0.44933339953422546, gen p mean: -0.11741720139980316, mean p set: 0.4499092102050781
loss_pred:0.015467017889022827, decouple_loss:0.0006783890421502292
Iteration: 1320, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956833124160767, gen p mean: -0.12135326862335205, mean p set: 0.45014408230781555
loss_pred:0.01614336110651493, decouple_loss:0.0010258958209306002
The modified gen p mean: 0.4501394033432007, gen p mean: -0.12306613475084305, mean p set: 0.45071372389793396
loss_pred:0.015763089060783386, decouple_loss:0.0007961366791278124
The modified gen p mean: 0.45166105031967163, gen p mean: -0.11940798163414001, mean p set: 0.45223987102508545
loss_pred:0.015712862834334373, decouple_loss:0.0008149559143930674
2023-05-01 20:36:39 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13339684903621674, mean p set: 0.4502691626548767
loss_pred:0.017122505232691765, decouple_loss:0.0009826007299125195
The modified gen p mean: 0.449535608291626, gen p mean: -0.12731239199638367, mean p set: 0.4500633478164673
loss_pred:0.016559088602662086, decouple_loss:0.0009038706193678081
The modified gen p mean: 0.44978067278862, gen p mean: -0.1271078884601593, mean p set: 0.45035696029663086
loss_pred:0.01680457964539528, decouple_loss:0.001142194145359099
WV_1_PC_1_EH_0_PS_40, loss: 0.01687920279800892, avg_mse: 0.026221321895718575
current test mse: 0.026221
Iteration: 1321, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512031376361847, gen p mean: -0.12023989111185074, mean p set: 0.4517812132835388
loss_pred:0.016025478020310402, decouple_loss:0.0007777053979225457
The modified gen p mean: 0.44945669174194336, gen p mean: -0.12064757198095322, mean p set: 0.4500344693660736
loss_pred:0.016627704724669456, decouple_loss:0.0006508633377961814
The modified gen p mean: 0.45139309763908386, gen p mean: -0.12242032587528229, mean p set: 0.45197123289108276
loss_pred:0.01673038862645626, decouple_loss:0.0006394759984686971
Iteration: 1322, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060136914253235, gen p mean: -0.11871829628944397, mean p set: 0.45117899775505066
The modified gen p mean: 0.4517531096935272, gen p mean: -0.11966749280691147, mean p set: 0.4523291289806366
loss_pred:0.015462785959243774, decouple_loss:0.0006076653371565044
loss_pred:0.015948504209518433, decouple_loss:0.0005166978226043284
The modified gen p mean: 0.44960305094718933, gen p mean: -0.12241466343402863, mean p set: 0.45017653703689575
loss_pred:0.01680208183825016, decouple_loss:0.000764420663472265
Iteration: 1323, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865772128105164, gen p mean: -0.11865032464265823, mean p set: 0.4492340683937073
The modified gen p mean: 0.44967904686927795, gen p mean: -0.12069156020879745, mean p set: 0.4502566158771515
loss_pred:0.016588976606726646, decouple_loss:0.0004979342338629067
loss_pred:0.0170725230127573, decouple_loss:0.000728948856703937
The modified gen p mean: 0.448242723941803, gen p mean: -0.11526434868574142, mean p set: 0.4488198161125183
loss_pred:0.016750087961554527, decouple_loss:0.00048262366908602417
Iteration: 1324, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45008933544158936, gen p mean: -0.11483173072338104, mean p set: 0.450663685798645
loss_pred:0.015540486201643944, decouple_loss:0.0005749744595959783
The modified gen p mean: 0.45077207684516907, gen p mean: -0.10876196622848511, mean p set: 0.4513488709926605
loss_pred:0.01610541343688965, decouple_loss:0.0004929017159156501
The modified gen p mean: 0.44923919439315796, gen p mean: -0.11432525515556335, mean p set: 0.44981491565704346
loss_pred:0.017109058797359467, decouple_loss:0.0006009258213452995
Iteration: 1325, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489172101020813, gen p mean: -0.11225025355815887, mean p set: 0.4494934380054474
loss_pred:0.015582227148115635, decouple_loss:0.0006647158297710121
The modified gen p mean: 0.4485967457294464, gen p mean: -0.10861965268850327, mean p set: 0.4491738975048065
loss_pred:0.016673598438501358, decouple_loss:0.00045495465747080743
The modified gen p mean: 0.4521484971046448, gen p mean: -0.11542491614818573, mean p set: 0.4527266025543213
loss_pred:0.01638983190059662, decouple_loss:0.0005965402815490961
Iteration: 1326, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488791227340698, gen p mean: -0.11156702786684036, mean p set: 0.4494513273239136
loss_pred:0.016093166545033455, decouple_loss:0.0007557253120467067
The modified gen p mean: 0.44993311166763306, gen p mean: -0.11530102044343948, mean p set: 0.450508713722229
loss_pred:0.014749699272215366, decouple_loss:0.0005893384222872555
The modified gen p mean: 0.4493691921234131, gen p mean: -0.1145995557308197, mean p set: 0.4499458968639374
loss_pred:0.016105078160762787, decouple_loss:0.0005018707597628236
Iteration: 1327, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44896557927131653, gen p mean: -0.11380931735038757, mean p set: 0.44954103231430054
loss_pred:0.016635647043585777, decouple_loss:0.0006981115438975394
The modified gen p mean: 0.44815579056739807, gen p mean: -0.1156824380159378, mean p set: 0.44873207807540894
loss_pred:0.01628822833299637, decouple_loss:0.0008004954433999956
The modified gen p mean: 0.44839227199554443, gen p mean: -0.11616306751966476, mean p set: 0.4489700198173523
loss_pred:0.01599709875881672, decouple_loss:0.0006784471333958209
Iteration: 1328, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45225584506988525, gen p mean: -0.113153375685215, mean p set: 0.4528312385082245
loss_pred:0.015744289383292198, decouple_loss:0.0005096255335956812
The modified gen p mean: 0.4480317234992981, gen p mean: -0.12134556472301483, mean p set: 0.44860586524009705
The modified gen p mean: 0.44804924726486206, gen p mean: -0.11703317612409592, mean p set: 0.44862303137779236
loss_pred:0.01640067808330059, decouple_loss:0.0006739264936186373
loss_pred:0.01552759949117899, decouple_loss:0.000524565577507019
Iteration: 1329, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498065412044525, gen p mean: -0.11352189630270004, mean p set: 0.45038262009620667
loss_pred:0.016253069043159485, decouple_loss:0.0007654002401977777
The modified gen p mean: 0.4507211446762085, gen p mean: -0.10779789090156555, mean p set: 0.45129647850990295
loss_pred:0.0159719530493021, decouple_loss:0.0005991070647723973
The modified gen p mean: 0.4500170946121216, gen p mean: -0.11410430818796158, mean p set: 0.45059719681739807
loss_pred:0.015563677065074444, decouple_loss:0.0005922936252318323
Iteration: 1330, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475196301937103, gen p mean: -0.11717583984136581, mean p set: 0.44809725880622864
loss_pred:0.015766656026244164, decouple_loss:0.0005243517807684839
The modified gen p mean: 0.4486619234085083, gen p mean: -0.1110595166683197, mean p set: 0.44923514127731323
loss_pred:0.016388868913054466, decouple_loss:0.0008885546121746302
The modified gen p mean: 0.45041853189468384, gen p mean: -0.11440706998109818, mean p set: 0.45099538564682007
loss_pred:0.015592891722917557, decouple_loss:0.0005748645635321736
2023-05-01 20:38:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12490108609199524, mean p set: 0.4502691626548767
loss_pred:0.01718786358833313, decouple_loss:0.0009387626778334379
The modified gen p mean: 0.4495357275009155, gen p mean: -0.11910964548587799, mean p set: 0.4500633478164673
loss_pred:0.016486570239067078, decouple_loss:0.0008013139013200998
The modified gen p mean: 0.449781596660614, gen p mean: -0.11870867758989334, mean p set: 0.45035696029663086
loss_pred:0.01683022826910019, decouple_loss:0.0009478717693127692
WV_1_PC_1_EH_0_PS_40, loss: 0.01687968708574772, avg_mse: 0.02626514621078968
current test mse: 0.026265
Iteration: 1331, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44922739267349243, gen p mean: -0.11711160838603973, mean p set: 0.4498039484024048
loss_pred:0.016219012439250946, decouple_loss:0.00057352299336344
The modified gen p mean: 0.4488070607185364, gen p mean: -0.11295563727617264, mean p set: 0.4493871033191681The modified gen p mean: 0.4508035480976105, gen p mean: -0.11450795829296112, mean p set: 0.4513806104660034
loss_pred:0.015194032341241837, decouple_loss:0.0005764445522800088loss_pred:0.01565500721335411, decouple_loss:0.0008089255425147712
Iteration: 1332, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489985704421997, gen p mean: -0.11469145864248276, mean p set: 0.4495765268802643
loss_pred:0.01592673361301422, decouple_loss:0.0006237751222215593
The modified gen p mean: 0.4493085741996765, gen p mean: -0.11414802819490433, mean p set: 0.4498836100101471The modified gen p mean: 0.44899141788482666, gen p mean: -0.11200244724750519, mean p set: 0.449567049741745
loss_pred:0.01609896309673786, decouple_loss:0.0006362140411511064
loss_pred:0.016395237296819687, decouple_loss:0.0006986107327975333
Iteration: 1333, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509201943874359, gen p mean: -0.11003461480140686, mean p set: 0.45149844884872437
The modified gen p mean: 0.4501814544200897, gen p mean: -0.11471780389547348, mean p set: 0.4507533609867096loss_pred:0.01569826528429985, decouple_loss:0.000686542596668005
loss_pred:0.015513759106397629, decouple_loss:0.0007133003091439605
The modified gen p mean: 0.44971513748168945, gen p mean: -0.11624982953071594, mean p set: 0.4502924084663391
loss_pred:0.015478142537176609, decouple_loss:0.0006984492065384984
Iteration: 1334, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779568910598755, gen p mean: -0.11992278695106506, mean p set: 0.44837433099746704
loss_pred:0.015941197052598, decouple_loss:0.000613182142842561
The modified gen p mean: 0.44892948865890503, gen p mean: -0.1116805374622345, mean p set: 0.4495048522949219
loss_pred:0.016231736168265343, decouple_loss:0.0006064389017410576
The modified gen p mean: 0.449637770652771, gen p mean: -0.11762474477291107, mean p set: 0.4502134323120117
loss_pred:0.01546615269035101, decouple_loss:0.0007758729043416679
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012019_3_24hr.npz
NaN value num: 0
Iteration: 1335, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476976692676544, gen p mean: -0.1172795444726944, mean p set: 0.4482733905315399
loss_pred:0.016154538840055466, decouple_loss:0.0006170133128762245
The modified gen p mean: 0.4489443898200989, gen p mean: -0.12332414835691452, mean p set: 0.44951972365379333
loss_pred:0.01547191571444273, decouple_loss:0.0007663224823772907
The modified gen p mean: 0.4484325349330902, gen p mean: -0.11747092753648758, mean p set: 0.4490050673484802
loss_pred:0.01621384546160698, decouple_loss:0.0008332340512424707
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1336, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481838643550873, gen p mean: -0.11914633214473724, mean p set: 0.4487597644329071
loss_pred:0.015924900770187378, decouple_loss:0.00055840949062258
The modified gen p mean: 0.4488610029220581, gen p mean: -0.12664596736431122, mean p set: 0.4494372606277466
The modified gen p mean: 0.4493756592273712, gen p mean: -0.12111955881118774, mean p set: 0.4499538242816925
loss_pred:0.015560517087578773, decouple_loss:0.000698697054758668
loss_pred:0.015691082924604416, decouple_loss:0.0007204249850474298
Iteration: 1337, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44800329208374023, gen p mean: -0.12917333841323853, mean p set: 0.448577344417572
loss_pred:0.015936391428112984, decouple_loss:0.0005986634641885757
The modified gen p mean: 0.447425901889801, gen p mean: -0.12842756509780884, mean p set: 0.4480001628398895
The modified gen p mean: 0.447454035282135, gen p mean: -0.11850257962942123, mean p set: 0.4480302929878235
loss_pred:0.016232222318649292, decouple_loss:0.0006360876141116023
loss_pred:0.015889493748545647, decouple_loss:0.0007838882156647742
Iteration: 1338, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44779354333877563, gen p mean: -0.12288588285446167, mean p set: 0.44836896657943726
loss_pred:0.01624298095703125, decouple_loss:0.0006394032388925552
The modified gen p mean: 0.44919800758361816, gen p mean: -0.1258295476436615, mean p set: 0.4497752785682678
loss_pred:0.015170884318649769, decouple_loss:0.0006198101909831166
The modified gen p mean: 0.4491477310657501, gen p mean: -0.12454752624034882, mean p set: 0.44972550868988037
loss_pred:0.01542993076145649, decouple_loss:0.0005891674663871527
Iteration: 1339, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44844287633895874, gen p mean: -0.12121707201004028, mean p set: 0.44901883602142334
loss_pred:0.014922427944839, decouple_loss:0.0005466288421303034
The modified gen p mean: 0.4486868977546692, gen p mean: -0.12230483442544937, mean p set: 0.4492647647857666
loss_pred:0.01537584513425827, decouple_loss:0.0005091014900244772
The modified gen p mean: 0.44810351729393005, gen p mean: -0.11842720955610275, mean p set: 0.4486786425113678
loss_pred:0.016487928107380867, decouple_loss:0.0006960909231565893
Iteration: 1340, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488784074783325, gen p mean: -0.11978890001773834, mean p set: 0.4494534134864807
loss_pred:0.01516281720250845, decouple_loss:0.0006432168302126229
The modified gen p mean: 0.4480345845222473, gen p mean: -0.11604158580303192, mean p set: 0.4486114978790283
loss_pred:0.01626388542354107, decouple_loss:0.0006921656313352287
The modified gen p mean: 0.44885188341140747, gen p mean: -0.1245085597038269, mean p set: 0.44942986965179443
loss_pred:0.015497473999857903, decouple_loss:0.0005245734355412424
2023-05-01 20:41:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12191753834486008, mean p set: 0.4502691626548767
loss_pred:0.01707359217107296, decouple_loss:0.00054415303748101
The modified gen p mean: 0.44953566789627075, gen p mean: -0.11614010483026505, mean p set: 0.4500633478164673
loss_pred:0.016379516571760178, decouple_loss:0.0006326443981379271
The modified gen p mean: 0.4497803747653961, gen p mean: -0.11530555039644241, mean p set: 0.45035696029663086
loss_pred:0.0167523343116045, decouple_loss:0.0006090567912906408
WV_1_PC_1_EH_0_PS_40, loss: 0.016764912754297256, avg_mse: 0.026065297424793243
current test mse: 0.026065
Iteration: 1341, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481006860733032, gen p mean: -0.12082084268331528, mean p set: 0.4486761689186096
loss_pred:0.015805857256054878, decouple_loss:0.0007282853475771844
The modified gen p mean: 0.4478781819343567, gen p mean: -0.11424237489700317, mean p set: 0.4484536051750183The modified gen p mean: 0.4487910568714142, gen p mean: -0.11732391268014908, mean p set: 0.4493670165538788
loss_pred:0.01600332371890545, decouple_loss:0.0005413939361460507
loss_pred:0.015228763222694397, decouple_loss:0.0005644973716698587
Iteration: 1342, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806450605392456, gen p mean: -0.11064490675926208, mean p set: 0.4486406445503235
loss_pred:0.01601201295852661, decouple_loss:0.0006461417069658637
The modified gen p mean: 0.4482879638671875, gen p mean: -0.12117061018943787, mean p set: 0.4488653242588043The modified gen p mean: 0.4489588439464569, gen p mean: -0.1222887635231018, mean p set: 0.4495360851287842
loss_pred:0.015750644728541374, decouple_loss:0.00048372833407483995
loss_pred:0.01584666781127453, decouple_loss:0.0006105657084845006
Iteration: 1343, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829756021499634, gen p mean: -0.12453204393386841, mean p set: 0.4488733410835266
loss_pred:0.015713321045041084, decouple_loss:0.0005275830044411123
The modified gen p mean: 0.4489435851573944, gen p mean: -0.11921995133161545, mean p set: 0.44951876997947693
loss_pred:0.015575171448290348, decouple_loss:0.0005459017120301723
The modified gen p mean: 0.4480356276035309, gen p mean: -0.12445207685232162, mean p set: 0.44861117005348206
loss_pred:0.01569407247006893, decouple_loss:0.000644737621769309
Iteration: 1344, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493862986564636, gen p mean: -0.12638267874717712, mean p set: 0.4499637186527252
loss_pred:0.015458976849913597, decouple_loss:0.0008071562624536455
The modified gen p mean: 0.4494279623031616, gen p mean: -0.1323130577802658, mean p set: 0.4500062167644501
loss_pred:0.015395675785839558, decouple_loss:0.0007778158760629594
The modified gen p mean: 0.4490167200565338, gen p mean: -0.1263371706008911, mean p set: 0.4495936930179596
loss_pred:0.015270689502358437, decouple_loss:0.0006709480658173561
Iteration: 1345, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492858648300171, gen p mean: -0.12980343401432037, mean p set: 0.4498598277568817
loss_pred:0.015277693048119545, decouple_loss:0.000735912995878607
The modified gen p mean: 0.4486778974533081, gen p mean: -0.12437597662210464, mean p set: 0.44925159215927124
loss_pred:0.015422568656504154, decouple_loss:0.0006324384012259543
The modified gen p mean: 0.44905954599380493, gen p mean: -0.12341590970754623, mean p set: 0.4496358335018158
loss_pred:0.015890585258603096, decouple_loss:0.0006451779627241194
Iteration: 1346, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492902159690857, gen p mean: -0.12622305750846863, mean p set: 0.4498666524887085
The modified gen p mean: 0.44889670610427856, gen p mean: -0.11875621974468231, mean p set: 0.44947290420532227
loss_pred:0.0157802514731884, decouple_loss:0.0005364711978472769
loss_pred:0.01510176807641983, decouple_loss:0.0005323337973095477
The modified gen p mean: 0.44886213541030884, gen p mean: -0.11986559629440308, mean p set: 0.4494384229183197
loss_pred:0.014791174791753292, decouple_loss:0.0006952856201678514
Iteration: 1347, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485417902469635, gen p mean: -0.11574069410562515, mean p set: 0.44911903142929077
loss_pred:0.015333632007241249, decouple_loss:0.0006173965521156788
The modified gen p mean: 0.4477232098579407, gen p mean: -0.1179359182715416, mean p set: 0.4483001232147217
The modified gen p mean: 0.4474499523639679, gen p mean: -0.12184955179691315, mean p set: 0.4480241537094116
loss_pred:0.015682026743888855, decouple_loss:0.0008583871531300247
loss_pred:0.016049347817897797, decouple_loss:0.0007094363099895418
Iteration: 1348, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449477881193161, gen p mean: -0.1210426464676857, mean p set: 0.45005539059638977
loss_pred:0.015049826353788376, decouple_loss:0.0005364043754525483
The modified gen p mean: 0.449302077293396, gen p mean: -0.12386775016784668, mean p set: 0.4498789310455322
loss_pred:0.015727045014500618, decouple_loss:0.000673884991556406
The modified gen p mean: 0.4487234652042389, gen p mean: -0.12259688228368759, mean p set: 0.4493010640144348
loss_pred:0.015474342741072178, decouple_loss:0.0006010175566188991
Iteration: 1349, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44773370027542114, gen p mean: -0.11398165673017502, mean p set: 0.44830653071403503
loss_pred:0.015127438120543957, decouple_loss:0.0005777449696324766
The modified gen p mean: 0.4490591585636139, gen p mean: -0.12535740435123444, mean p set: 0.4496367573738098
loss_pred:0.015294763259589672, decouple_loss:0.0005976914544589818
The modified gen p mean: 0.44883498549461365, gen p mean: -0.12273747473955154, mean p set: 0.4494089186191559
loss_pred:0.015281478874385357, decouple_loss:0.0005964664160273969
Iteration: 1350, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44791659712791443, gen p mean: -0.11626151949167252, mean p set: 0.448492169380188
loss_pred:0.015688439831137657, decouple_loss:0.0008022239780984819
The modified gen p mean: 0.44876623153686523, gen p mean: -0.1224803701043129, mean p set: 0.44934189319610596
loss_pred:0.015546579845249653, decouple_loss:0.0006976262084208429
The modified gen p mean: 0.4493512213230133, gen p mean: -0.12549148499965668, mean p set: 0.449928879737854
loss_pred:0.015404770150780678, decouple_loss:0.0006938548176549375
2023-05-01 20:43:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12441614270210266, mean p set: 0.4502691626548767
loss_pred:0.017043450847268105, decouple_loss:0.0005203253822401166
The modified gen p mean: 0.4495340883731842, gen p mean: -0.11838209629058838, mean p set: 0.4500633478164673
loss_pred:0.016405528411269188, decouple_loss:0.0005955902161076665
The modified gen p mean: 0.4497823119163513, gen p mean: -0.11769497394561768, mean p set: 0.45035696029663086
loss_pred:0.016757329925894737, decouple_loss:0.0005547992768697441
WV_1_PC_1_EH_0_PS_40, loss: 0.01676328293979168, avg_mse: 0.026149334385991096
current test mse: 0.026149
Iteration: 1351, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493202269077301, gen p mean: -0.1249404028058052, mean p set: 0.4498986005783081
loss_pred:0.015620660036802292, decouple_loss:0.00060370221035555
The modified gen p mean: 0.4490651488304138, gen p mean: -0.1202489510178566, mean p set: 0.4496401250362396The modified gen p mean: 0.4485926032066345, gen p mean: -0.11633437126874924, mean p set: 0.4491669833660126
loss_pred:0.015777571126818657, decouple_loss:0.0006235709879547358
loss_pred:0.015208421275019646, decouple_loss:0.0005785472458228469
Iteration: 1352, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484652876853943, gen p mean: -0.121745266020298, mean p set: 0.4490435719490051
loss_pred:0.015162673778831959, decouple_loss:0.00040412016096524894
The modified gen p mean: 0.44787999987602234, gen p mean: -0.11928302049636841, mean p set: 0.44845834374427795The modified gen p mean: 0.44889864325523376, gen p mean: -0.11957719922065735, mean p set: 0.4494735598564148
loss_pred:0.015336754731833935, decouple_loss:0.0006527219666168094loss_pred:0.015038277953863144, decouple_loss:0.00049449602374807
Iteration: 1353, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447233647108078, gen p mean: -0.1137687936425209, mean p set: 0.4478098452091217
The modified gen p mean: 0.4485292434692383, gen p mean: -0.11575353890657425, mean p set: 0.4491029977798462loss_pred:0.01612854190170765, decouple_loss:0.0004946374683640897
loss_pred:0.015587668865919113, decouple_loss:0.00047667569015175104
The modified gen p mean: 0.4489908814430237, gen p mean: -0.11681373417377472, mean p set: 0.44956550002098083
loss_pred:0.01555818784981966, decouple_loss:0.00047517367056570947
Iteration: 1354, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44784650206565857, gen p mean: -0.11022653430700302, mean p set: 0.4484219551086426
The modified gen p mean: 0.4483618438243866, gen p mean: -0.11514312028884888, mean p set: 0.4489397704601288
loss_pred:0.015288379043340683, decouple_loss:0.0004821674374397844
loss_pred:0.01495982613414526, decouple_loss:0.0006109684472903609
The modified gen p mean: 0.4483156204223633, gen p mean: -0.11818497627973557, mean p set: 0.4488937258720398
loss_pred:0.015901220962405205, decouple_loss:0.000601528852712363
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012014_3_24hr.npz
NaN value num: 0
Iteration: 1355, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483131468296051, gen p mean: -0.12058085948228836, mean p set: 0.44888943433761597
loss_pred:0.015636354684829712, decouple_loss:0.000741884985473007
The modified gen p mean: 0.44582703709602356, gen p mean: -0.11515158414840698, mean p set: 0.4464031159877777
loss_pred:0.015529575757682323, decouple_loss:0.0005117630353197455
The modified gen p mean: 0.4464094936847687, gen p mean: -0.1201121136546135, mean p set: 0.4469846189022064
loss_pred:0.01635144092142582, decouple_loss:0.0005174637190066278
Iteration: 1356, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473099112510681, gen p mean: -0.12143738567829132, mean p set: 0.44788745045661926
loss_pred:0.016234012320637703, decouple_loss:0.0005126571631990373
The modified gen p mean: 0.4458617568016052, gen p mean: -0.12312968075275421, mean p set: 0.44643494486808777
The modified gen p mean: 0.44680196046829224, gen p mean: -0.12033390998840332, mean p set: 0.44737792015075684
loss_pred:0.015589372254908085, decouple_loss:0.0005631960812024772
loss_pred:0.015584781765937805, decouple_loss:0.0006052953540347517
Iteration: 1357, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44646885991096497, gen p mean: -0.1250673532485962, mean p set: 0.44704657793045044
The modified gen p mean: 0.4476865828037262, gen p mean: -0.12262755632400513, mean p set: 0.4482622444629669
loss_pred:0.01600596122443676, decouple_loss:0.0007792096585035324
loss_pred:0.015976611524820328, decouple_loss:0.0007121655507944524
The modified gen p mean: 0.4458265006542206, gen p mean: -0.1225067749619484, mean p set: 0.44640329480171204
loss_pred:0.015921887010335922, decouple_loss:0.0009231165749952197
Iteration: 1358, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44793465733528137, gen p mean: -0.12410730868577957, mean p set: 0.44851207733154297
The modified gen p mean: 0.4459240138530731, gen p mean: -0.12242966890335083, mean p set: 0.4465000033378601
loss_pred:0.01537842396646738, decouple_loss:0.0005443515256047249
loss_pred:0.015301138162612915, decouple_loss:0.0005548169719986618
The modified gen p mean: 0.445586234331131, gen p mean: -0.11744770407676697, mean p set: 0.44616246223449707
loss_pred:0.015787068754434586, decouple_loss:0.00048824033001437783
Iteration: 1359, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660356640815735, gen p mean: -0.12408331036567688, mean p set: 0.4471801817417145
The modified gen p mean: 0.44622182846069336, gen p mean: -0.12153416872024536, mean p set: 0.44679760932922363
loss_pred:0.01634157821536064, decouple_loss:0.0004973211907781661
loss_pred:0.01621578074991703, decouple_loss:0.0005116481333971024
The modified gen p mean: 0.4459778964519501, gen p mean: -0.12179914861917496, mean p set: 0.44655176997184753
loss_pred:0.016140254214406013, decouple_loss:0.0006336961523629725
Iteration: 1360, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446530818939209, gen p mean: -0.11749351769685745, mean p set: 0.447105348110199
loss_pred:0.015813784673810005, decouple_loss:0.0007269422058016062
The modified gen p mean: 0.4474150538444519, gen p mean: -0.11886727064847946, mean p set: 0.44799020886421204
loss_pred:0.015378601849079132, decouple_loss:0.0008040840621106327
The modified gen p mean: 0.4464726448059082, gen p mean: -0.11840229481458664, mean p set: 0.4470498263835907
loss_pred:0.014861036092042923, decouple_loss:0.0005859387456439435
2023-05-01 20:46:22 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1221710667014122, mean p set: 0.4502691626548767
loss_pred:0.01698741875588894, decouple_loss:0.0006818703841418028
The modified gen p mean: 0.4495355486869812, gen p mean: -0.11623091250658035, mean p set: 0.4500633478164673
loss_pred:0.01626845821738243, decouple_loss:0.0006837054388597608
The modified gen p mean: 0.44978341460227966, gen p mean: -0.11554387956857681, mean p set: 0.45035696029663086
loss_pred:0.01667940244078636, decouple_loss:0.0006716392817907035
WV_1_PC_1_EH_0_PS_40, loss: 0.01667904667556286, avg_mse: 0.02597115747630596
current test mse: 0.025971
At step 1360, Best test: 0.025971
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1361, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752275943756104, gen p mean: -0.119484543800354, mean p set: 0.44809842109680176
loss_pred:0.01578335650265217, decouple_loss:0.0005508935428224504
The modified gen p mean: 0.44635310769081116, gen p mean: -0.11941725760698318, mean p set: 0.44692856073379517
loss_pred:0.015228066593408585, decouple_loss:0.0006240741349756718
The modified gen p mean: 0.44609788060188293, gen p mean: -0.11852862685918808, mean p set: 0.44667407870292664
loss_pred:0.01610562950372696, decouple_loss:0.0005699534085579216
Iteration: 1362, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470927119255066, gen p mean: -0.11564557999372482, mean p set: 0.44766902923583984
loss_pred:0.015639284625649452, decouple_loss:0.0005800167564302683
The modified gen p mean: 0.44734206795692444, gen p mean: -0.11500013619661331, mean p set: 0.447918564081192The modified gen p mean: 0.4451984167098999, gen p mean: -0.11909279227256775, mean p set: 0.4457741975784302
loss_pred:0.01503231842070818, decouple_loss:0.0006236566114239395
loss_pred:0.015436056070029736, decouple_loss:0.0005059337709099054
Iteration: 1363, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472982883453369, gen p mean: -0.11148448288440704, mean p set: 0.44787484407424927
loss_pred:0.015338586643338203, decouple_loss:0.0007792419055476785
The modified gen p mean: 0.4471820592880249, gen p mean: -0.11758294701576233, mean p set: 0.44775912165641785
loss_pred:0.01615465059876442, decouple_loss:0.0006513426778838038
The modified gen p mean: 0.44792136549949646, gen p mean: -0.115058034658432, mean p set: 0.4484979510307312
loss_pred:0.01610281504690647, decouple_loss:0.0005130748613737524
Iteration: 1364, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673407077789307, gen p mean: -0.11466111987829208, mean p set: 0.4473114311695099
The modified gen p mean: 0.4466196894645691, gen p mean: -0.11847830563783646, mean p set: 0.4471932351589203
loss_pred:0.014938365668058395, decouple_loss:0.0006154094589874148
loss_pred:0.016453705728054047, decouple_loss:0.0006475074333138764
The modified gen p mean: 0.44795578718185425, gen p mean: -0.11640163511037827, mean p set: 0.448532372713089
loss_pred:0.015612089075148106, decouple_loss:0.0006648897542618215
Iteration: 1365, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478471577167511, gen p mean: -0.11906374990940094, mean p set: 0.4484235644340515
The modified gen p mean: 0.4453867971897125, gen p mean: -0.12237431854009628, mean p set: 0.44596222043037415
loss_pred:0.015144151635468006, decouple_loss:0.0007619569660164416
loss_pred:0.015406688675284386, decouple_loss:0.0005186423659324646
The modified gen p mean: 0.44613468647003174, gen p mean: -0.11787047982215881, mean p set: 0.4467087388038635
loss_pred:0.015801571309566498, decouple_loss:0.0004234200168866664
Iteration: 1366, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636720418930054, gen p mean: -0.11917025595903397, mean p set: 0.4469420909881592
loss_pred:0.015829643234610558, decouple_loss:0.0004400854231789708
The modified gen p mean: 0.44596046209335327, gen p mean: -0.11742942780256271, mean p set: 0.44653645157814026
loss_pred:0.014784729108214378, decouple_loss:0.000493233441375196
The modified gen p mean: 0.44639626145362854, gen p mean: -0.12243422865867615, mean p set: 0.4469722807407379
loss_pred:0.015436368063092232, decouple_loss:0.0005293178255669773
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1367, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468682110309601, gen p mean: -0.12064876407384872, mean p set: 0.44744786620140076
loss_pred:0.01582622341811657, decouple_loss:0.0004973690956830978
The modified gen p mean: 0.4466649889945984, gen p mean: -0.11825451254844666, mean p set: 0.4472399353981018
loss_pred:0.015831155702471733, decouple_loss:0.000524365168530494
The modified gen p mean: 0.4474110007286072, gen p mean: -0.1249881461262703, mean p set: 0.4479850232601166
loss_pred:0.01591896079480648, decouple_loss:0.0005259024328552186
Iteration: 1368, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455038607120514, gen p mean: -0.12958846986293793, mean p set: 0.4460800588130951
loss_pred:0.015230820514261723, decouple_loss:0.0005595640395767987
The modified gen p mean: 0.4463580250740051, gen p mean: -0.12624993920326233, mean p set: 0.4469307065010071
The modified gen p mean: 0.44668087363243103, gen p mean: -0.1259344220161438, mean p set: 0.44725537300109863
loss_pred:0.016379985958337784, decouple_loss:0.0004280673456378281
loss_pred:0.01522725448012352, decouple_loss:0.0005784632521681488
Iteration: 1369, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475032091140747, gen p mean: -0.12676161527633667, mean p set: 0.44807806611061096
loss_pred:0.01595580391585827, decouple_loss:0.0005779499770142138
The modified gen p mean: 0.4477474093437195, gen p mean: -0.1268862783908844, mean p set: 0.448323518037796
The modified gen p mean: 0.44643741846084595, gen p mean: -0.12466616183519363, mean p set: 0.4470142424106598
loss_pred:0.015726571902632713, decouple_loss:0.0006279294611886144
loss_pred:0.015192040242254734, decouple_loss:0.0005391285521909595
Iteration: 1370, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44694116711616516, gen p mean: -0.13190709054470062, mean p set: 0.44751712679862976
loss_pred:0.01607045903801918, decouple_loss:0.0004911418654955924
The modified gen p mean: 0.446138858795166, gen p mean: -0.1266511082649231, mean p set: 0.44671353697776794
loss_pred:0.01564738340675831, decouple_loss:0.000449454877525568
The modified gen p mean: 0.4475553333759308, gen p mean: -0.12805430591106415, mean p set: 0.44813206791877747
loss_pred:0.015609455294907093, decouple_loss:0.0004964390536770225
2023-05-01 20:48:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13252180814743042, mean p set: 0.4502691626548767
loss_pred:0.017048990353941917, decouple_loss:0.0005606614868156612
The modified gen p mean: 0.4495365023612976, gen p mean: -0.12632682919502258, mean p set: 0.4500633478164673
loss_pred:0.016389548778533936, decouple_loss:0.0005202216561883688
The modified gen p mean: 0.4497799575328827, gen p mean: -0.12605661153793335, mean p set: 0.45035696029663086
loss_pred:0.01668260060250759, decouple_loss:0.0005183618050068617
WV_1_PC_1_EH_0_PS_40, loss: 0.016733702272176743, avg_mse: 0.02611387148499489
current test mse: 0.026114
Iteration: 1371, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463751018047333, gen p mean: -0.13171450793743134, mean p set: 0.44695183634757996
loss_pred:0.015673421323299408, decouple_loss:0.0004755419213324785
The modified gen p mean: 0.44614309072494507, gen p mean: -0.12641611695289612, mean p set: 0.4467202425003052The modified gen p mean: 0.4457375407218933, gen p mean: -0.12713269889354706, mean p set: 0.4463140368461609
loss_pred:0.015565565787255764, decouple_loss:0.000489558617118746
loss_pred:0.015420163050293922, decouple_loss:0.0005727509851567447
Iteration: 1372, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461207687854767, gen p mean: -0.12263215333223343, mean p set: 0.44669607281684875
The modified gen p mean: 0.44574132561683655, gen p mean: -0.12966029345989227, mean p set: 0.44631776213645935
loss_pred:0.014996332116425037, decouple_loss:0.0005698108579963446
loss_pred:0.015153569169342518, decouple_loss:0.0004988618893548846
The modified gen p mean: 0.44645100831985474, gen p mean: -0.12506447732448578, mean p set: 0.44702646136283875
loss_pred:0.015203938819468021, decouple_loss:0.0005090645281597972
Iteration: 1373, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4458044171333313, gen p mean: -0.12544797360897064, mean p set: 0.4463808834552765
loss_pred:0.015549926087260246, decouple_loss:0.0005121073918417096
The modified gen p mean: 0.44644057750701904, gen p mean: -0.12648020684719086, mean p set: 0.4470173120498657
loss_pred:0.015372920781373978, decouple_loss:0.0005091965431347489
The modified gen p mean: 0.4471569359302521, gen p mean: -0.12363231182098389, mean p set: 0.447732150554657
loss_pred:0.015542056411504745, decouple_loss:0.0004372487310320139
Iteration: 1374, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4456627666950226, gen p mean: -0.12535397708415985, mean p set: 0.4462362825870514
loss_pred:0.014999299310147762, decouple_loss:0.00043285114225000143
The modified gen p mean: 0.44688278436660767, gen p mean: -0.1217128336429596, mean p set: 0.4474559724330902
loss_pred:0.015171432867646217, decouple_loss:0.0004402119666337967
The modified gen p mean: 0.4465602934360504, gen p mean: -0.12427274137735367, mean p set: 0.44713470339775085
loss_pred:0.015738576650619507, decouple_loss:0.0006473437533713877
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012019_3_24hr.npz
NaN value num: 0
Iteration: 1375, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45063260197639465, gen p mean: -0.11739064753055573, mean p set: 0.4512137174606323
loss_pred:0.01674753613770008, decouple_loss:0.0006480344454757869
The modified gen p mean: 0.4497714936733246, gen p mean: -0.11481892317533493, mean p set: 0.45034801959991455
loss_pred:0.01671350561082363, decouple_loss:0.0006776943919248879
The modified gen p mean: 0.45133960247039795, gen p mean: -0.11053885519504547, mean p set: 0.4519175887107849
loss_pred:0.01617172360420227, decouple_loss:0.0008147642947733402
Iteration: 1376, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502831995487213, gen p mean: -0.11560021340847015, mean p set: 0.45086249709129333
loss_pred:0.015878720209002495, decouple_loss:0.0007647968595847487
The modified gen p mean: 0.45073944330215454, gen p mean: -0.1075088307261467, mean p set: 0.45131561160087585
loss_pred:0.0161281730979681, decouple_loss:0.0006877201376482844
The modified gen p mean: 0.4493391513824463, gen p mean: -0.11706364154815674, mean p set: 0.44991254806518555
loss_pred:0.016708049923181534, decouple_loss:0.0006707605207338929
Iteration: 1377, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501718282699585, gen p mean: -0.11256768554449081, mean p set: 0.45074760913848877
loss_pred:0.016519024968147278, decouple_loss:0.0006503987242467701
The modified gen p mean: 0.45072561502456665, gen p mean: -0.10343129187822342, mean p set: 0.45130112767219543
loss_pred:0.016200734302401543, decouple_loss:0.0006985905929468572
The modified gen p mean: 0.4496261477470398, gen p mean: -0.11086812615394592, mean p set: 0.4502009153366089
loss_pred:0.016662735491991043, decouple_loss:0.0004969153669662774
Iteration: 1378, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45068979263305664, gen p mean: -0.11503063142299652, mean p set: 0.4512638449668884
The modified gen p mean: 0.4492316246032715, gen p mean: -0.1125522032380104, mean p set: 0.4498090147972107loss_pred:0.01581502892076969, decouple_loss:0.0006120223551988602
loss_pred:0.01722649112343788, decouple_loss:0.0006574442959390581
The modified gen p mean: 0.4517795443534851, gen p mean: -0.11419732868671417, mean p set: 0.4523555636405945
loss_pred:0.015400676056742668, decouple_loss:0.0006117793382145464
Iteration: 1379, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493500590324402, gen p mean: -0.1133747398853302, mean p set: 0.44992515444755554
loss_pred:0.016458379104733467, decouple_loss:0.00043784198351204395
The modified gen p mean: 0.45139291882514954, gen p mean: -0.11201606690883636, mean p set: 0.4519709050655365
loss_pred:0.016604391857981682, decouple_loss:0.000671340269036591
The modified gen p mean: 0.4502286911010742, gen p mean: -0.11443772166967392, mean p set: 0.4508068561553955
loss_pred:0.016677124425768852, decouple_loss:0.0005693095736205578
Iteration: 1380, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508678913116455, gen p mean: -0.11330607533454895, mean p set: 0.4514442980289459
loss_pred:0.01588347740471363, decouple_loss:0.0004996599163860083
The modified gen p mean: 0.4511187672615051, gen p mean: -0.11483751982450485, mean p set: 0.4516952931880951
loss_pred:0.015868209302425385, decouple_loss:0.0006116927834227681
The modified gen p mean: 0.4499679505825043, gen p mean: -0.12147416919469833, mean p set: 0.4505466818809509
loss_pred:0.016445619985461235, decouple_loss:0.000609192589763552
2023-05-01 20:51:16 testing...
The modified gen p mean: 0.44978880882263184, gen p mean: -0.1292756348848343, mean p set: 0.4502691626548767
loss_pred:0.01715223863720894, decouple_loss:0.0006179095944389701
The modified gen p mean: 0.4495365023612976, gen p mean: -0.12314597517251968, mean p set: 0.4500633478164673
loss_pred:0.016340138390660286, decouple_loss:0.0006858152919448912
The modified gen p mean: 0.4497801959514618, gen p mean: -0.12252108007669449, mean p set: 0.45035696029663086
loss_pred:0.01662266254425049, decouple_loss:0.0006399644771590829
WV_1_PC_1_EH_0_PS_40, loss: 0.016737408936023712, avg_mse: 0.02612239494919777
current test mse: 0.026122
Iteration: 1381, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508712589740753, gen p mean: -0.11861798912286758, mean p set: 0.45144689083099365
loss_pred:0.016685936599969864, decouple_loss:0.0005971047794446349
The modified gen p mean: 0.4516325294971466, gen p mean: -0.11460837721824646, mean p set: 0.4522075653076172
loss_pred:0.01619531773030758, decouple_loss:0.0005318228504620492
The modified gen p mean: 0.45118704438209534, gen p mean: -0.114161916077137, mean p set: 0.4517611861228943
loss_pred:0.016689226031303406, decouple_loss:0.0006456393748521805
Iteration: 1382, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514421820640564, gen p mean: -0.1141975075006485, mean p set: 0.4520154595375061
The modified gen p mean: 0.4518260061740875, gen p mean: -0.11762555688619614, mean p set: 0.4524042010307312
loss_pred:0.016169901937246323, decouple_loss:0.0004913472221232951
loss_pred:0.015307636931538582, decouple_loss:0.0005627403734251857
The modified gen p mean: 0.4517344832420349, gen p mean: -0.11907047778367996, mean p set: 0.45231279730796814
loss_pred:0.017673686146736145, decouple_loss:0.0005440039676614106
Iteration: 1383, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45105233788490295, gen p mean: -0.11355878412723541, mean p set: 0.45163068175315857
loss_pred:0.01619095914065838, decouple_loss:0.0005118980770930648
The modified gen p mean: 0.44959503412246704, gen p mean: -0.11583195626735687, mean p set: 0.450173020362854
loss_pred:0.016583528369665146, decouple_loss:0.0005174495745450258
The modified gen p mean: 0.45054638385772705, gen p mean: -0.12358055263757706, mean p set: 0.4511202275753021
loss_pred:0.01609719730913639, decouple_loss:0.0004885589005425572
Iteration: 1384, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050400495529175, gen p mean: -0.12572956085205078, mean p set: 0.4510760009288788
loss_pred:0.0157929677516222, decouple_loss:0.0005004905979149044
The modified gen p mean: 0.44963860511779785, gen p mean: -0.12077151238918304, mean p set: 0.4502132534980774
loss_pred:0.01711832359433174, decouple_loss:0.0005210090312175453
The modified gen p mean: 0.4525934159755707, gen p mean: -0.1160883903503418, mean p set: 0.45317062735557556
loss_pred:0.016664965078234673, decouple_loss:0.0005973222432658076
Iteration: 1385, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514339566230774, gen p mean: -0.11456507444381714, mean p set: 0.45201170444488525
loss_pred:0.015347633510828018, decouple_loss:0.0006253529572859406
The modified gen p mean: 0.44961827993392944, gen p mean: -0.12110632658004761, mean p set: 0.4501960873603821
loss_pred:0.01644882746040821, decouple_loss:0.00044441624777391553
The modified gen p mean: 0.4497303068637848, gen p mean: -0.11994507908821106, mean p set: 0.45030614733695984
loss_pred:0.01655259169638157, decouple_loss:0.0005486554000526667
Iteration: 1386, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113813877105713, gen p mean: -0.11148114502429962, mean p set: 0.4517151117324829
loss_pred:0.015890110284090042, decouple_loss:0.00047055352479219437
The modified gen p mean: 0.44994887709617615, gen p mean: -0.11894460022449493, mean p set: 0.45052459836006165
The modified gen p mean: 0.45003247261047363, gen p mean: -0.11888027936220169, mean p set: 0.45060768723487854
loss_pred:0.01604512706398964, decouple_loss:0.0005214754492044449
loss_pred:0.016300097107887268, decouple_loss:0.0004800376482307911
Iteration: 1387, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495171904563904, gen p mean: -0.1164884939789772, mean p set: 0.4500918984413147
loss_pred:0.016687991097569466, decouple_loss:0.00048565646284259856
The modified gen p mean: 0.4522205591201782, gen p mean: -0.11227693408727646, mean p set: 0.4527982771396637
loss_pred:0.016842735931277275, decouple_loss:0.0006146765081211925
The modified gen p mean: 0.45245561003685, gen p mean: -0.11082294583320618, mean p set: 0.45303085446357727
loss_pred:0.015960635617375374, decouple_loss:0.0006721566314809024
Iteration: 1388, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450745552778244, gen p mean: -0.10852236300706863, mean p set: 0.45132210850715637
loss_pred:0.016631152480840683, decouple_loss:0.0005712222191505134
The modified gen p mean: 0.450710266828537, gen p mean: -0.11171378195285797, mean p set: 0.4512876868247986
loss_pred:0.016505775973200798, decouple_loss:0.0006004292517900467
The modified gen p mean: 0.4507550299167633, gen p mean: -0.10733658820390701, mean p set: 0.45133206248283386
loss_pred:0.01669446937739849, decouple_loss:0.0006285168929025531
Iteration: 1389, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507150948047638, gen p mean: -0.11114833503961563, mean p set: 0.4512922167778015
loss_pred:0.016381138935685158, decouple_loss:0.0005401843809522688
The modified gen p mean: 0.4508642256259918, gen p mean: -0.1075882688164711, mean p set: 0.45143812894821167
loss_pred:0.01670318841934204, decouple_loss:0.0005833751056343317
The modified gen p mean: 0.451321542263031, gen p mean: -0.10641153156757355, mean p set: 0.45189735293388367
loss_pred:0.017409497871994972, decouple_loss:0.0006197685725055635
Iteration: 1390, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502655565738678, gen p mean: -0.11594089865684509, mean p set: 0.4508419334888458
loss_pred:0.01655663177371025, decouple_loss:0.0005067994352430105
The modified gen p mean: 0.4500039517879486, gen p mean: -0.11282680183649063, mean p set: 0.45058155059814453
The modified gen p mean: 0.45000457763671875, gen p mean: -0.11414812505245209, mean p set: 0.45058050751686096
loss_pred:0.01617990992963314, decouple_loss:0.0005615726113319397
loss_pred:0.016760248690843582, decouple_loss:0.0005530474008992314
2023-05-01 20:53:25 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12631693482398987, mean p set: 0.4502691626548767
loss_pred:0.017239708453416824, decouple_loss:0.0005234830314293504
The modified gen p mean: 0.4495348334312439, gen p mean: -0.12006361782550812, mean p set: 0.4500633478164673
loss_pred:0.016401341184973717, decouple_loss:0.0006026089540682733
The modified gen p mean: 0.44977912306785583, gen p mean: -0.11972764879465103, mean p set: 0.45035696029663086
loss_pred:0.016610650345683098, decouple_loss:0.0005790360155515373
WV_1_PC_1_EH_0_PS_40, loss: 0.016778986901044846, avg_mse: 0.026199007406830788
current test mse: 0.026199
Iteration: 1391, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44932305812835693, gen p mean: -0.11528972536325455, mean p set: 0.449899822473526
loss_pred:0.016002539545297623, decouple_loss:0.0004886447568424046
The modified gen p mean: 0.4520112872123718, gen p mean: -0.11395005881786346, mean p set: 0.45258599519729614The modified gen p mean: 0.4519997537136078, gen p mean: -0.10969583690166473, mean p set: 0.45257672667503357
loss_pred:0.016681522130966187, decouple_loss:0.0005689676036126912
loss_pred:0.01547982543706894, decouple_loss:0.0006464411271736026
Iteration: 1392, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518798887729645, gen p mean: -0.11689608544111252, mean p set: 0.4524562954902649
loss_pred:0.015709279105067253, decouple_loss:0.0005328226834535599
The modified gen p mean: 0.4497348666191101, gen p mean: -0.11929039657115936, mean p set: 0.45031243562698364The modified gen p mean: 0.4516519010066986, gen p mean: -0.11501192301511765, mean p set: 0.4522300362586975
loss_pred:0.016015468165278435, decouple_loss:0.0004738051793538034
loss_pred:0.016971530392766, decouple_loss:0.0004922469961456954
Iteration: 1393, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955378770828247, gen p mean: -0.12136594951152802, mean p set: 0.45013299584388733
loss_pred:0.01590505987405777, decouple_loss:0.0006894450634717941
The modified gen p mean: 0.4517807066440582, gen p mean: -0.11895560473203659, mean p set: 0.452357679605484
loss_pred:0.01550888828933239, decouple_loss:0.000505974458064884
The modified gen p mean: 0.450744092464447, gen p mean: -0.11455440521240234, mean p set: 0.451321005821228
loss_pred:0.01610424742102623, decouple_loss:0.0005753433797508478
Iteration: 1394, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45120954513549805, gen p mean: -0.11857126653194427, mean p set: 0.45178699493408203
loss_pred:0.0167061910033226, decouple_loss:0.0006548797246068716
The modified gen p mean: 0.4522421061992645, gen p mean: -0.1193893700838089, mean p set: 0.45281848311424255
loss_pred:0.015291276387870312, decouple_loss:0.0005361504736356437
The modified gen p mean: 0.4506644606590271, gen p mean: -0.11458305269479752, mean p set: 0.4512418508529663
loss_pred:0.015960846096277237, decouple_loss:0.000525292765814811
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012011_3_24hr.npz
NaN value num: 0
Iteration: 1395, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493861794471741, gen p mean: -0.11936987936496735, mean p set: 0.4499603509902954
loss_pred:0.014840155839920044, decouple_loss:0.0008841771050356328
The modified gen p mean: 0.4475953280925751, gen p mean: -0.12638112902641296, mean p set: 0.4481693506240845
loss_pred:0.015167523175477982, decouple_loss:0.0007155166240409017
The modified gen p mean: 0.44722840189933777, gen p mean: -0.1335267424583435, mean p set: 0.44780364632606506
loss_pred:0.015624540857970715, decouple_loss:0.0005950313643552363
Iteration: 1396, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701623916625977, gen p mean: -0.12339890003204346, mean p set: 0.4475933611392975
loss_pred:0.015739887952804565, decouple_loss:0.000633526942692697
The modified gen p mean: 0.4470406770706177, gen p mean: -0.12222442030906677, mean p set: 0.4476158618927002
loss_pred:0.015688909217715263, decouple_loss:0.0005889070453122258
The modified gen p mean: 0.4474800229072571, gen p mean: -0.12609416246414185, mean p set: 0.44805845618247986
loss_pred:0.015199529938399792, decouple_loss:0.0006107081426307559
Iteration: 1397, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465939402580261, gen p mean: -0.12639406323432922, mean p set: 0.4471684396266937
loss_pred:0.015607387758791447, decouple_loss:0.000530813354998827
The modified gen p mean: 0.4469332993030548, gen p mean: -0.12640102207660675, mean p set: 0.4475088119506836
loss_pred:0.015303960070014, decouple_loss:0.0006762230768799782
The modified gen p mean: 0.44718053936958313, gen p mean: -0.12783126533031464, mean p set: 0.44775503873825073
loss_pred:0.015180852264165878, decouple_loss:0.0006107377703301609
Iteration: 1398, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775447249412537, gen p mean: -0.12471312284469604, mean p set: 0.4483305513858795
loss_pred:0.015631020069122314, decouple_loss:0.0006162810605019331
The modified gen p mean: 0.447374552488327, gen p mean: -0.12279599159955978, mean p set: 0.4479523003101349
loss_pred:0.015788162127137184, decouple_loss:0.0005453220219351351
The modified gen p mean: 0.44725456833839417, gen p mean: -0.12707339227199554, mean p set: 0.44783204793930054
loss_pred:0.015129417181015015, decouple_loss:0.0005351550644263625
Iteration: 1399, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44764137268066406, gen p mean: -0.1240978017449379, mean p set: 0.44821614027023315
loss_pred:0.01557802315801382, decouple_loss:0.0005879413802176714
The modified gen p mean: 0.44748541712760925, gen p mean: -0.12033217400312424, mean p set: 0.4480615258216858
loss_pred:0.014748701825737953, decouple_loss:0.0005273257847875357
The modified gen p mean: 0.44788262248039246, gen p mean: -0.12722574174404144, mean p set: 0.44845813512802124
loss_pred:0.014383278787136078, decouple_loss:0.0005727836396545172
Iteration: 1400, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447649210691452, gen p mean: -0.11494095623493195, mean p set: 0.44822585582733154
loss_pred:0.015452899038791656, decouple_loss:0.0006406712927855551
The modified gen p mean: 0.4474383294582367, gen p mean: -0.11749812215566635, mean p set: 0.4480154812335968
loss_pred:0.014751186594367027, decouple_loss:0.0005013428744859993
The modified gen p mean: 0.44953134655952454, gen p mean: -0.11939562112092972, mean p set: 0.45010778307914734
loss_pred:0.014324208721518517, decouple_loss:0.0006445077597163618
2023-05-01 20:56:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1202029436826706, mean p set: 0.4502691626548767
loss_pred:0.01707994006574154, decouple_loss:0.0005680535105057061
The modified gen p mean: 0.4495333433151245, gen p mean: -0.11400924623012543, mean p set: 0.4500633478164673
loss_pred:0.016380218788981438, decouple_loss:0.0005675573484040797
The modified gen p mean: 0.449779212474823, gen p mean: -0.11381897330284119, mean p set: 0.45035696029663086
loss_pred:0.01672220043838024, decouple_loss:0.0005142804002389312
WV_1_PC_1_EH_0_PS_40, loss: 0.01675495132803917, avg_mse: 0.026133473962545395
current test mse: 0.026133
Iteration: 1401, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478452801704407, gen p mean: -0.11235232651233673, mean p set: 0.44842052459716797
loss_pred:0.01504948828369379, decouple_loss:0.000598370039369911
The modified gen p mean: 0.44710665941238403, gen p mean: -0.11410347372293472, mean p set: 0.44768205285072327
The modified gen p mean: 0.448013037443161, gen p mean: -0.11634698510169983, mean p set: 0.44859078526496887
loss_pred:0.01632159948348999, decouple_loss:0.000716527400072664
loss_pred:0.014564720913767815, decouple_loss:0.0005192151293158531
Iteration: 1402, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476911425590515, gen p mean: -0.11528933793306351, mean p set: 0.4482676684856415
loss_pred:0.014993341639637947, decouple_loss:0.000557932595256716
The modified gen p mean: 0.44694873690605164, gen p mean: -0.11204835772514343, mean p set: 0.4475235044956207
The modified gen p mean: 0.44759267568588257, gen p mean: -0.11902371793985367, mean p set: 0.44816869497299194
loss_pred:0.015061456710100174, decouple_loss:0.0005922481650486588
loss_pred:0.015527205541729927, decouple_loss:0.0005646948702633381
Iteration: 1403, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475538730621338, gen p mean: -0.11310499906539917, mean p set: 0.44812917709350586
loss_pred:0.015452465042471886, decouple_loss:0.0005498201353475451
The modified gen p mean: 0.44779306650161743, gen p mean: -0.1119198277592659, mean p set: 0.44836780428886414
loss_pred:0.01654667593538761, decouple_loss:0.0005335617461241782
The modified gen p mean: 0.4472932517528534, gen p mean: -0.11207539588212967, mean p set: 0.4478708505630493
loss_pred:0.014453320764005184, decouple_loss:0.0005102079594507813
Iteration: 1404, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474041759967804, gen p mean: -0.11505037546157837, mean p set: 0.44798195362091064
loss_pred:0.014738868921995163, decouple_loss:0.0005162936286069453
The modified gen p mean: 0.44805216789245605, gen p mean: -0.11757725477218628, mean p set: 0.44863179326057434
loss_pred:0.014627683907747269, decouple_loss:0.0007114624022506177
The modified gen p mean: 0.4484405517578125, gen p mean: -0.11408492922782898, mean p set: 0.4490176737308502
loss_pred:0.015023467130959034, decouple_loss:0.0004249340563546866
Iteration: 1405, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44670379161834717, gen p mean: -0.12145571410655975, mean p set: 0.4472792148590088
loss_pred:0.01525181531906128, decouple_loss:0.0006445125909522176
The modified gen p mean: 0.44794583320617676, gen p mean: -0.11820308864116669, mean p set: 0.4485217034816742
loss_pred:0.014874939806759357, decouple_loss:0.0007205507135950029
The modified gen p mean: 0.44696298241615295, gen p mean: -0.12582872807979584, mean p set: 0.44753962755203247
loss_pred:0.014971179887652397, decouple_loss:0.0006557796150445938
Iteration: 1406, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489918053150177, gen p mean: -0.11322330683469772, mean p set: 0.4495725929737091
loss_pred:0.015101569704711437, decouple_loss:0.0006484772311523557
The modified gen p mean: 0.44757118821144104, gen p mean: -0.12162064760923386, mean p set: 0.44814783334732056
loss_pred:0.014843124896287918, decouple_loss:0.0006828801124356687
The modified gen p mean: 0.4470844268798828, gen p mean: -0.12216063588857651, mean p set: 0.4476613700389862
loss_pred:0.014838239178061485, decouple_loss:0.0005141306901350617
Iteration: 1407, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472179412841797, gen p mean: -0.12414000183343887, mean p set: 0.4477936327457428
loss_pred:0.014732807874679565, decouple_loss:0.0005042047123424709
The modified gen p mean: 0.44674044847488403, gen p mean: -0.12567026913166046, mean p set: 0.4473148286342621
loss_pred:0.014930836856365204, decouple_loss:0.0005306420498527586
The modified gen p mean: 0.4489785432815552, gen p mean: -0.1172667145729065, mean p set: 0.4495594799518585
loss_pred:0.014722410589456558, decouple_loss:0.0006341199041344225
Iteration: 1408, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44848352670669556, gen p mean: -0.11916910856962204, mean p set: 0.44905948638916016
loss_pred:0.015487531200051308, decouple_loss:0.0004783722688443959
The modified gen p mean: 0.4486094117164612, gen p mean: -0.12002589553594589, mean p set: 0.44918543100357056
loss_pred:0.014436007477343082, decouple_loss:0.000655207724776119
The modified gen p mean: 0.44801685214042664, gen p mean: -0.12273231893777847, mean p set: 0.4485950767993927
loss_pred:0.014995942823588848, decouple_loss:0.000453604239737615
Iteration: 1409, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464401304721832, gen p mean: -0.11831607669591904, mean p set: 0.44701725244522095
loss_pred:0.015192325226962566, decouple_loss:0.0006737685762345791
The modified gen p mean: 0.44755902886390686, gen p mean: -0.12113647162914276, mean p set: 0.44813597202301025
loss_pred:0.015361086465418339, decouple_loss:0.0006823361036367714
The modified gen p mean: 0.4480281472206116, gen p mean: -0.11774095147848129, mean p set: 0.44860655069351196
loss_pred:0.014316820539534092, decouple_loss:0.0005020168609917164
Iteration: 1410, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487290382385254, gen p mean: -0.12314396351575851, mean p set: 0.449308842420578
loss_pred:0.0142352394759655, decouple_loss:0.0006494305562227964
The modified gen p mean: 0.447317898273468, gen p mean: -0.11324947327375412, mean p set: 0.4478912055492401
loss_pred:0.015910934656858444, decouple_loss:0.0006585881928913295
The modified gen p mean: 0.44853806495666504, gen p mean: -0.11500664800405502, mean p set: 0.4491148293018341
loss_pred:0.014680184423923492, decouple_loss:0.0005032150656916201
2023-05-01 20:58:19 testing...
The modified gen p mean: 0.44953617453575134, gen p mean: -0.1163855791091919, mean p set: 0.4500633478164673
loss_pred:0.01634185016155243, decouple_loss:0.0005145646282471716
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12234146893024445, mean p set: 0.4502691626548767
loss_pred:0.01707996428012848, decouple_loss:0.000447587895905599
The modified gen p mean: 0.44978007674217224, gen p mean: -0.11627853661775589, mean p set: 0.45035696029663086
loss_pred:0.016598070040345192, decouple_loss:0.0005983898881822824
WV_1_PC_1_EH_0_PS_40, loss: 0.016699304804205894, avg_mse: 0.026068976148962975
current test mse: 0.026069
Iteration: 1411, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798779487609863, gen p mean: -0.11393856257200241, mean p set: 0.44856393337249756
loss_pred:0.01573275960981846, decouple_loss:0.0004317864077165723
The modified gen p mean: 0.4470604360103607, gen p mean: -0.11617100238800049, mean p set: 0.4476364552974701The modified gen p mean: 0.44820085167884827, gen p mean: -0.11328423768281937, mean p set: 0.4487749934196472
loss_pred:0.015151171013712883, decouple_loss:0.00048118154518306255
loss_pred:0.015157148241996765, decouple_loss:0.0005436210776679218
Iteration: 1412, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478793442249298, gen p mean: -0.11699800938367844, mean p set: 0.44845467805862427
The modified gen p mean: 0.44806578755378723, gen p mean: -0.1187705248594284, mean p set: 0.4486410617828369
loss_pred:0.014169302769005299, decouple_loss:0.00044741565943695605
loss_pred:0.01485131960362196, decouple_loss:0.0006346292211674154
The modified gen p mean: 0.4477922320365906, gen p mean: -0.11650523543357849, mean p set: 0.4483700692653656
loss_pred:0.014503621496260166, decouple_loss:0.0005313441506586969
Iteration: 1413, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477095901966095, gen p mean: -0.11473143100738525, mean p set: 0.4482842683792114
loss_pred:0.015321625396609306, decouple_loss:0.0005107191973365843
The modified gen p mean: 0.4475988447666168, gen p mean: -0.11888737976551056, mean p set: 0.4481755197048187The modified gen p mean: 0.4471084773540497, gen p mean: -0.11642485857009888, mean p set: 0.4476836025714874
loss_pred:0.014623826369643211, decouple_loss:0.0005550626665353775
loss_pred:0.014035702683031559, decouple_loss:0.00048820703523233533
Iteration: 1414, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44766879081726074, gen p mean: -0.11432722210884094, mean p set: 0.44824254512786865
loss_pred:0.015318458899855614, decouple_loss:0.0004921953077428043
The modified gen p mean: 0.4485377073287964, gen p mean: -0.11419877409934998, mean p set: 0.4491144120693207
loss_pred:0.015187343582510948, decouple_loss:0.0005894698551855981
The modified gen p mean: 0.44680535793304443, gen p mean: -0.12286024540662766, mean p set: 0.4473792016506195
loss_pred:0.014907276257872581, decouple_loss:0.0005404640105552971
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012016_3_24hr.npz
NaN value num: 0
Iteration: 1415, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45234405994415283, gen p mean: -0.10545442253351212, mean p set: 0.45292118191719055The modified gen p mean: 0.45317935943603516, gen p mean: -0.11349519342184067, mean p set: 0.4537568688392639
loss_pred:0.01683776080608368, decouple_loss:0.000727239646948874loss_pred:0.015914762392640114, decouple_loss:0.0006432346999645233
The modified gen p mean: 0.4505500793457031, gen p mean: -0.10355467349290848, mean p set: 0.4511275291442871
loss_pred:0.016880955547094345, decouple_loss:0.000663581071421504
Iteration: 1416, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511450529098511, gen p mean: -0.11382261663675308, mean p set: 0.4517228305339813
loss_pred:0.01666974276304245, decouple_loss:0.0006753075867891312
The modified gen p mean: 0.4516489803791046, gen p mean: -0.11102817952632904, mean p set: 0.45222529768943787
loss_pred:0.016461621969938278, decouple_loss:0.0004822045739274472
The modified gen p mean: 0.4510207772254944, gen p mean: -0.11227425932884216, mean p set: 0.45159485936164856
loss_pred:0.0159437358379364, decouple_loss:0.0006067517097108066
Iteration: 1417, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513219892978668, gen p mean: -0.10637853294610977, mean p set: 0.4518997073173523
loss_pred:0.016864098608493805, decouple_loss:0.0005942410789430141
The modified gen p mean: 0.45146867632865906, gen p mean: -0.11572166532278061, mean p set: 0.45204612612724304
The modified gen p mean: 0.4526086151599884, gen p mean: -0.11324495822191238, mean p set: 0.45318475365638733
loss_pred:0.0155839454382658, decouple_loss:0.0005425636190921068
loss_pred:0.015724891796708107, decouple_loss:0.0006000957801006734
Iteration: 1418, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451046347618103, gen p mean: -0.11322727054357529, mean p set: 0.45162433385849
loss_pred:0.016856510192155838, decouple_loss:0.0007240268168970942
The modified gen p mean: 0.45216700434684753, gen p mean: -0.11167896538972855, mean p set: 0.45274466276168823
loss_pred:0.016757488250732422, decouple_loss:0.0007074226741679013
The modified gen p mean: 0.45102936029434204, gen p mean: -0.1112636849284172, mean p set: 0.45160651206970215
loss_pred:0.016792383044958115, decouple_loss:0.0006506384816020727
Iteration: 1419, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518733024597168, gen p mean: -0.10867016017436981, mean p set: 0.4524519443511963
loss_pred:0.016295315697789192, decouple_loss:0.0006506136269308627
The modified gen p mean: 0.4519725441932678, gen p mean: -0.10980281233787537, mean p set: 0.45254722237586975
loss_pred:0.015679357573390007, decouple_loss:0.0005890194443054497
The modified gen p mean: 0.4506976306438446, gen p mean: -0.10649093240499496, mean p set: 0.45127376914024353
loss_pred:0.01743600144982338, decouple_loss:0.0006432276568375528
Iteration: 1420, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506094455718994, gen p mean: -0.11152394860982895, mean p set: 0.45118778944015503
loss_pred:0.016422629356384277, decouple_loss:0.0004934004391543567
The modified gen p mean: 0.45137396454811096, gen p mean: -0.11060161143541336, mean p set: 0.45195040106773376
loss_pred:0.015672003850340843, decouple_loss:0.0006429040222428739
The modified gen p mean: 0.45134276151657104, gen p mean: -0.10795648396015167, mean p set: 0.4519197940826416
loss_pred:0.01640170067548752, decouple_loss:0.000584544031880796
2023-05-01 21:01:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11796364188194275, mean p set: 0.4502691626548767
loss_pred:0.01725461520254612, decouple_loss:0.0007254256051965058
The modified gen p mean: 0.4495353102684021, gen p mean: -0.11197113990783691, mean p set: 0.4500633478164673
loss_pred:0.016553634777665138, decouple_loss:0.0008262862684205174
The modified gen p mean: 0.4497825503349304, gen p mean: -0.11172938346862793, mean p set: 0.45035696029663086
loss_pred:0.016749754548072815, decouple_loss:0.000704737554769963
WV_1_PC_1_EH_0_PS_40, loss: 0.016890276223421097, avg_mse: 0.02629145048558712
current test mse: 0.026291
Iteration: 1421, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504714012145996, gen p mean: -0.10677458345890045, mean p set: 0.4510461390018463
loss_pred:0.017085431143641472, decouple_loss:0.0008684044005349278
The modified gen p mean: 0.4538756012916565, gen p mean: -0.10773579031229019, mean p set: 0.45445236563682556
loss_pred:0.016203133389353752, decouple_loss:0.0008015573839657009
The modified gen p mean: 0.45376354455947876, gen p mean: -0.10746727138757706, mean p set: 0.4543396830558777
loss_pred:0.016080446541309357, decouple_loss:0.0009707502322271466
Iteration: 1422, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041078329086304, gen p mean: -0.10668545961380005, mean p set: 0.45098650455474854
The modified gen p mean: 0.45243918895721436, gen p mean: -0.1063723936676979, mean p set: 0.45301714539527893
loss_pred:0.016536561772227287, decouple_loss:0.0007748360512778163
loss_pred:0.01545809954404831, decouple_loss:0.0008257253211922944
The modified gen p mean: 0.45107460021972656, gen p mean: -0.1083943173289299, mean p set: 0.45165136456489563
loss_pred:0.0159104336053133, decouple_loss:0.0006763319252058864
Iteration: 1423, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45012253522872925, gen p mean: -0.109209343791008, mean p set: 0.45069798827171326
loss_pred:0.015280552208423615, decouple_loss:0.0006633182056248188
The modified gen p mean: 0.4516601860523224, gen p mean: -0.11329065263271332, mean p set: 0.45223820209503174The modified gen p mean: 0.45063191652297974, gen p mean: -0.09992299973964691, mean p set: 0.45121118426322937
loss_pred:0.016143405809998512, decouple_loss:0.0006067368667572737
loss_pred:0.016964439302682877, decouple_loss:0.000822613132186234
Iteration: 1424, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512189030647278, gen p mean: -0.1108003780245781, mean p set: 0.4517951011657715
loss_pred:0.016420666128396988, decouple_loss:0.0005820198566652834
The modified gen p mean: 0.45217204093933105, gen p mean: -0.1122012734413147, mean p set: 0.4527485966682434
loss_pred:0.01587175764143467, decouple_loss:0.000689612643327564
The modified gen p mean: 0.4514470100402832, gen p mean: -0.11041487008333206, mean p set: 0.45202142000198364
loss_pred:0.016495849937200546, decouple_loss:0.0006529470556415617
Iteration: 1425, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45151546597480774, gen p mean: -0.11477243900299072, mean p set: 0.45209240913391113
The modified gen p mean: 0.4515034258365631, gen p mean: -0.11414256691932678, mean p set: 0.45208099484443665
loss_pred:0.0160247590392828, decouple_loss:0.0007770408410578966
loss_pred:0.01627788506448269, decouple_loss:0.0007828281377442181
The modified gen p mean: 0.451947420835495, gen p mean: -0.11508939415216446, mean p set: 0.4525245428085327
loss_pred:0.015474609099328518, decouple_loss:0.0008507812744937837
Iteration: 1426, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45098191499710083, gen p mean: -0.11608023196458817, mean p set: 0.4515587389469147
loss_pred:0.016466159373521805, decouple_loss:0.0007177400984801352
The modified gen p mean: 0.4511258900165558, gen p mean: -0.11595644801855087, mean p set: 0.4517037868499756
loss_pred:0.016545923426747322, decouple_loss:0.0007031244458630681
The modified gen p mean: 0.45216822624206543, gen p mean: -0.11541567742824554, mean p set: 0.45274418592453003
loss_pred:0.015555696561932564, decouple_loss:0.0006447191117331386
Iteration: 1427, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451507568359375, gen p mean: -0.10984679311513901, mean p set: 0.4520830810070038
The modified gen p mean: 0.4510616362094879, gen p mean: -0.11001961678266525, mean p set: 0.4516381621360779
loss_pred:0.016215790063142776, decouple_loss:0.0006176112219691277
loss_pred:0.016294484958052635, decouple_loss:0.0005387475830502808
The modified gen p mean: 0.4516943097114563, gen p mean: -0.1154785230755806, mean p set: 0.45226994156837463
loss_pred:0.01544434018433094, decouple_loss:0.0005890602478757501
Iteration: 1428, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505544900894165, gen p mean: -0.10884959995746613, mean p set: 0.4511306881904602
loss_pred:0.01568615809082985, decouple_loss:0.0005943372379988432
The modified gen p mean: 0.451282262802124, gen p mean: -0.10565926879644394, mean p set: 0.4518592655658722
loss_pred:0.01671251468360424, decouple_loss:0.0007868817774578929
The modified gen p mean: 0.4510837197303772, gen p mean: -0.11407233774662018, mean p set: 0.4516591429710388
loss_pred:0.01580362394452095, decouple_loss:0.0005527237080968916
Iteration: 1429, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533429443836212, gen p mean: -0.11180535703897476, mean p set: 0.4539199471473694
loss_pred:0.015457326546311378, decouple_loss:0.0006180702475830913
The modified gen p mean: 0.4506222903728485, gen p mean: -0.09834891557693481, mean p set: 0.45119786262512207
loss_pred:0.016727156937122345, decouple_loss:0.0006804957520216703
The modified gen p mean: 0.4501197040081024, gen p mean: -0.10699404031038284, mean p set: 0.4506949186325073
loss_pred:0.017375221475958824, decouple_loss:0.0006742312107235193
Iteration: 1430, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45192041993141174, gen p mean: -0.10331810265779495, mean p set: 0.4524966776371002
loss_pred:0.016963833943009377, decouple_loss:0.0008538552792742848
The modified gen p mean: 0.449797660112381, gen p mean: -0.11004947870969772, mean p set: 0.45037490129470825
loss_pred:0.016282523050904274, decouple_loss:0.0005976131069473922
The modified gen p mean: 0.45069578289985657, gen p mean: -0.11314482986927032, mean p set: 0.45127442479133606
loss_pred:0.016180559992790222, decouple_loss:0.0007064864039421082
2023-05-01 21:03:19 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12073535472154617, mean p set: 0.4502691626548767
loss_pred:0.017202449962496758, decouple_loss:0.0007780076703056693
The modified gen p mean: 0.4495336413383484, gen p mean: -0.1146247610449791, mean p set: 0.4500633478164673
loss_pred:0.016574667766690254, decouple_loss:0.0006947128567844629
The modified gen p mean: 0.44978010654449463, gen p mean: -0.11478960514068604, mean p set: 0.45035696029663086
loss_pred:0.01678241416811943, decouple_loss:0.0006930626695975661
WV_1_PC_1_EH_0_PS_40, loss: 0.01688927412033081, avg_mse: 0.026275673881173134
current test mse: 0.026276
Iteration: 1431, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45134076476097107, gen p mean: -0.11568717658519745, mean p set: 0.451918363571167
loss_pred:0.01588679850101471, decouple_loss:0.0008249933598563075
The modified gen p mean: 0.4531939625740051, gen p mean: -0.11023925989866257, mean p set: 0.4537709653377533
The modified gen p mean: 0.4505787193775177, gen p mean: -0.10759539902210236, mean p set: 0.4511549472808838
loss_pred:0.01590193621814251, decouple_loss:0.0007658627582713962
loss_pred:0.016465235501527786, decouple_loss:0.0007980915834195912
Iteration: 1432, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516919255256653, gen p mean: -0.1118154376745224, mean p set: 0.45226770639419556The modified gen p mean: 0.45229610800743103, gen p mean: -0.11202112585306168, mean p set: 0.45287254452705383
loss_pred:0.015203384682536125, decouple_loss:0.0006276931962929666loss_pred:0.01657559908926487, decouple_loss:0.0006288044969551265
The modified gen p mean: 0.45150676369667053, gen p mean: -0.11015231162309647, mean p set: 0.4520838260650635
loss_pred:0.016481537371873856, decouple_loss:0.0006534421117976308
Iteration: 1433, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513615667819977, gen p mean: -0.11197776347398758, mean p set: 0.45193958282470703
loss_pred:0.01602509245276451, decouple_loss:0.0007401069160550833
The modified gen p mean: 0.4521509110927582, gen p mean: -0.10839228332042694, mean p set: 0.4527277946472168
loss_pred:0.015970567241311073, decouple_loss:0.0008057612576521933
The modified gen p mean: 0.4531184434890747, gen p mean: -0.1101391464471817, mean p set: 0.453695684671402
loss_pred:0.01604609377682209, decouple_loss:0.000687075371388346
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012020_3_24hr.npz
NaN value num: 0
Iteration: 1434, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449384868144989, gen p mean: -0.1136874407529831, mean p set: 0.4499610364437103
loss_pred:0.017840474843978882, decouple_loss:0.0006586760864593089
The modified gen p mean: 0.44859930872917175, gen p mean: -0.11084742844104767, mean p set: 0.449175626039505
loss_pred:0.01702864095568657, decouple_loss:0.0007756337872706354
The modified gen p mean: 0.4486773610115051, gen p mean: -0.11576369404792786, mean p set: 0.44925400614738464
loss_pred:0.017074279487133026, decouple_loss:0.0008207235368900001
Iteration: 1435, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44979438185691833, gen p mean: -0.10804076492786407, mean p set: 0.4503738284111023
loss_pred:0.016529506072402, decouple_loss:0.0006715767667628825
The modified gen p mean: 0.44949525594711304, gen p mean: -0.11438102275133133, mean p set: 0.4500735104084015
loss_pred:0.017035311087965965, decouple_loss:0.000729080056771636
The modified gen p mean: 0.4491117596626282, gen p mean: -0.11308258026838303, mean p set: 0.4496876895427704
loss_pred:0.01748781092464924, decouple_loss:0.0006834378000348806
Iteration: 1436, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44912999868392944, gen p mean: -0.11029710620641708, mean p set: 0.4497062563896179
loss_pred:0.017068728804588318, decouple_loss:0.0007250893977470696
The modified gen p mean: 0.44980719685554504, gen p mean: -0.1093621551990509, mean p set: 0.450385719537735
loss_pred:0.016838232055306435, decouple_loss:0.0005565474857576191
The modified gen p mean: 0.44947531819343567, gen p mean: -0.10990156978368759, mean p set: 0.4500521421432495
loss_pred:0.016368063166737556, decouple_loss:0.0009334098431281745
Iteration: 1437, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496205449104309, gen p mean: -0.10730156302452087, mean p set: 0.45019885897636414
loss_pred:0.017358891665935516, decouple_loss:0.0008655272540636361
The modified gen p mean: 0.44862934947013855, gen p mean: -0.11035065352916718, mean p set: 0.44920605421066284
loss_pred:0.017458409070968628, decouple_loss:0.0006126595544628799
The modified gen p mean: 0.4496449828147888, gen p mean: -0.1129073053598404, mean p set: 0.4502195417881012
loss_pred:0.016982749104499817, decouple_loss:0.0006382677238434553
Iteration: 1438, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483952522277832, gen p mean: -0.11186329275369644, mean p set: 0.44897153973579407
loss_pred:0.017435280606150627, decouple_loss:0.0008629981894046068
The modified gen p mean: 0.4501858949661255, gen p mean: -0.11374597996473312, mean p set: 0.4507625102996826
loss_pred:0.01768609881401062, decouple_loss:0.0007297568372450769
The modified gen p mean: 0.44963309168815613, gen p mean: -0.11463028192520142, mean p set: 0.45020923018455505
loss_pred:0.016950061544775963, decouple_loss:0.0006334715872071683
Iteration: 1439, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486827850341797, gen p mean: -0.11650778353214264, mean p set: 0.44925686717033386
loss_pred:0.017058147117495537, decouple_loss:0.0006857633125036955
The modified gen p mean: 0.4497545659542084, gen p mean: -0.11369367688894272, mean p set: 0.45033130049705505
loss_pred:0.01676829345524311, decouple_loss:0.0008169030188582838
The modified gen p mean: 0.449202299118042, gen p mean: -0.11317668855190277, mean p set: 0.4497784972190857
loss_pred:0.018352117389440536, decouple_loss:0.0005102484137751162
Iteration: 1440, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449785441160202, gen p mean: -0.12321125715970993, mean p set: 0.45035961270332336
loss_pred:0.017504176124930382, decouple_loss:0.0005432821926660836
The modified gen p mean: 0.44908279180526733, gen p mean: -0.12081548571586609, mean p set: 0.44966015219688416
loss_pred:0.01699363999068737, decouple_loss:0.0006285535637289286
The modified gen p mean: 0.44989630579948425, gen p mean: -0.11342297494411469, mean p set: 0.4504740536212921
loss_pred:0.016372526064515114, decouple_loss:0.00048599159345030785
2023-05-01 21:06:04 testing...
The modified gen p mean: 0.44953563809394836, gen p mean: -0.12141025811433792, mean p set: 0.4500633478164673
loss_pred:0.01656975969672203, decouple_loss:0.0007651972700841725
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12730738520622253, mean p set: 0.4502691626548767
loss_pred:0.017131716012954712, decouple_loss:0.0008600141736678779
The modified gen p mean: 0.44978126883506775, gen p mean: -0.1212768480181694, mean p set: 0.45035696029663086
loss_pred:0.016704948619008064, decouple_loss:0.0008155603427439928
WV_1_PC_1_EH_0_PS_40, loss: 0.01684282347559929, avg_mse: 0.026150323450565338
current test mse: 0.02615
Iteration: 1441, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481607973575592, gen p mean: -0.11926870048046112, mean p set: 0.4487350583076477
loss_pred:0.016682136803865433, decouple_loss:0.0007643588469363749
The modified gen p mean: 0.44960591197013855, gen p mean: -0.12076827138662338, mean p set: 0.4501812756061554
loss_pred:0.017461121082305908, decouple_loss:0.0011237775906920433
The modified gen p mean: 0.4487156569957733, gen p mean: -0.1216592863202095, mean p set: 0.44929149746894836
loss_pred:0.017919518053531647, decouple_loss:0.0005966448807157576
Iteration: 1442, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484485983848572, gen p mean: -0.11931388825178146, mean p set: 0.44902318716049194
The modified gen p mean: 0.44953665137290955, gen p mean: -0.12369417399168015, mean p set: 0.450113981962204loss_pred:0.016979871317744255, decouple_loss:0.0005992298829369247
loss_pred:0.017815761268138885, decouple_loss:0.0008449482847936451
The modified gen p mean: 0.4480465352535248, gen p mean: -0.121841661632061, mean p set: 0.4486234188079834
loss_pred:0.01741090603172779, decouple_loss:0.0006828263285569847
Iteration: 1443, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486096501350403, gen p mean: -0.12320739030838013, mean p set: 0.4491855800151825
The modified gen p mean: 0.4478112757205963, gen p mean: -0.1251194328069687, mean p set: 0.4483890235424042
loss_pred:0.01690044067800045, decouple_loss:0.0005523567670024931
loss_pred:0.01697835512459278, decouple_loss:0.000740935152862221
The modified gen p mean: 0.44911813735961914, gen p mean: -0.13039687275886536, mean p set: 0.44969442486763
loss_pred:0.01770799420773983, decouple_loss:0.0005267439410090446
Iteration: 1444, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486778676509857, gen p mean: -0.12276554852724075, mean p set: 0.44925227761268616
loss_pred:0.016720695421099663, decouple_loss:0.0006510611274279654
The modified gen p mean: 0.44962266087532043, gen p mean: -0.12146880477666855, mean p set: 0.4501986801624298
loss_pred:0.016549784690141678, decouple_loss:0.0005717566818930209
The modified gen p mean: 0.44843119382858276, gen p mean: -0.12091070413589478, mean p set: 0.4490078091621399
loss_pred:0.0171488206833601, decouple_loss:0.0006629351410083473
Iteration: 1445, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448781281709671, gen p mean: -0.12614692747592926, mean p set: 0.4493584930896759
loss_pred:0.01767183654010296, decouple_loss:0.0004059053317178041
The modified gen p mean: 0.4495982825756073, gen p mean: -0.12504781782627106, mean p set: 0.45017439126968384
loss_pred:0.017932886257767677, decouple_loss:0.0006757642258889973
The modified gen p mean: 0.4498606026172638, gen p mean: -0.12468714267015457, mean p set: 0.45043838024139404
loss_pred:0.016328949481248856, decouple_loss:0.0006837332039140165
Iteration: 1446, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448845237493515, gen p mean: -0.12374813854694366, mean p set: 0.4494204819202423
loss_pred:0.017818240448832512, decouple_loss:0.0005899437237530947
The modified gen p mean: 0.4500764310359955, gen p mean: -0.12423751503229141, mean p set: 0.4506526291370392
loss_pred:0.017360903322696686, decouple_loss:0.0006372357020154595
The modified gen p mean: 0.4492606818675995, gen p mean: -0.12857180833816528, mean p set: 0.44983765482902527
loss_pred:0.016213247552514076, decouple_loss:0.0006124980864115059
Iteration: 1447, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028331875801086, gen p mean: -0.12771271169185638, mean p set: 0.45085832476615906
loss_pred:0.016536133363842964, decouple_loss:0.0005480553954839706
The modified gen p mean: 0.448955774307251, gen p mean: -0.12860693037509918, mean p set: 0.4495299160480499
loss_pred:0.017288533970713615, decouple_loss:0.0005752354045398533
The modified gen p mean: 0.4493709206581116, gen p mean: -0.1279824823141098, mean p set: 0.4499465525150299
loss_pred:0.01632389798760414, decouple_loss:0.0006258184439502656
Iteration: 1448, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44810181856155396, gen p mean: -0.12452754378318787, mean p set: 0.44867777824401855
loss_pred:0.01771758310496807, decouple_loss:0.0005780075443908572
The modified gen p mean: 0.449523001909256, gen p mean: -0.12613143026828766, mean p set: 0.45009905099868774
loss_pred:0.0166116151958704, decouple_loss:0.0005746378446929157
The modified gen p mean: 0.44807273149490356, gen p mean: -0.13177131116390228, mean p set: 0.44864723086357117
loss_pred:0.017388449981808662, decouple_loss:0.0005797433550469577
Iteration: 1449, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817450642585754, gen p mean: -0.12493214011192322, mean p set: 0.44875091314315796
loss_pred:0.016503822058439255, decouple_loss:0.000507431454025209
The modified gen p mean: 0.44854962825775146, gen p mean: -0.1250520497560501, mean p set: 0.4491247832775116
loss_pred:0.017310939729213715, decouple_loss:0.0005175338010303676
The modified gen p mean: 0.449555903673172, gen p mean: -0.12212801724672318, mean p set: 0.4501313269138336
loss_pred:0.01636408269405365, decouple_loss:0.00046493596164509654
Iteration: 1450, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488998055458069, gen p mean: -0.1203211173415184, mean p set: 0.4494764804840088
loss_pred:0.017194001004099846, decouple_loss:0.0005626897909678519
The modified gen p mean: 0.4483559727668762, gen p mean: -0.1186651811003685, mean p set: 0.4489312171936035
loss_pred:0.017042571678757668, decouple_loss:0.0006861506844870746
The modified gen p mean: 0.45003724098205566, gen p mean: -0.1173441931605339, mean p set: 0.45061272382736206
loss_pred:0.017530323937535286, decouple_loss:0.000979027128778398
2023-05-01 21:08:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12509962916374207, mean p set: 0.4502691626548767
loss_pred:0.017108023166656494, decouple_loss:0.0005445614224299788
The modified gen p mean: 0.4495350122451782, gen p mean: -0.11897275596857071, mean p set: 0.4500633478164673
loss_pred:0.016538910567760468, decouple_loss:0.0006736371433362365
The modified gen p mean: 0.44977837800979614, gen p mean: -0.11880216747522354, mean p set: 0.45035696029663086
loss_pred:0.016705172136425972, decouple_loss:0.0006284189876168966
WV_1_PC_1_EH_0_PS_40, loss: 0.016814813017845154, avg_mse: 0.026126297190785408
current test mse: 0.026126
Iteration: 1451, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493587613105774, gen p mean: -0.11450706422328949, mean p set: 0.4499370753765106
loss_pred:0.017097558826208115, decouple_loss:0.0005706539377570152
The modified gen p mean: 0.4490973651409149, gen p mean: -0.1139318123459816, mean p set: 0.44967401027679443The modified gen p mean: 0.4488486051559448, gen p mean: -0.1217515617609024, mean p set: 0.4494244158267975
loss_pred:0.01651383936405182, decouple_loss:0.000455756759038195
loss_pred:0.016071388497948647, decouple_loss:0.0005854233168065548
Iteration: 1452, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44956642389297485, gen p mean: -0.11939049512147903, mean p set: 0.4501429796218872
loss_pred:0.01653774455189705, decouple_loss:0.0006680168444290757
The modified gen p mean: 0.44965192675590515, gen p mean: -0.11754215508699417, mean p set: 0.4502294957637787The modified gen p mean: 0.4485698342323303, gen p mean: -0.12333212792873383, mean p set: 0.4491483271121979
loss_pred:0.017574695870280266, decouple_loss:0.0005204634508118033
loss_pred:0.017021382227540016, decouple_loss:0.0005832131137140095
Iteration: 1453, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44938454031944275, gen p mean: -0.11336464434862137, mean p set: 0.44995957612991333
loss_pred:0.016569146886467934, decouple_loss:0.0006839409470558167
The modified gen p mean: 0.4489738643169403, gen p mean: -0.12138446420431137, mean p set: 0.4495510160923004
loss_pred:0.017801158130168915, decouple_loss:0.0005862935213372111
The modified gen p mean: 0.44886133074760437, gen p mean: -0.11331503093242645, mean p set: 0.44943687319755554
loss_pred:0.01709114946424961, decouple_loss:0.0004826136282645166
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012018_3_24hr.npz
NaN value num: 0
Iteration: 1454, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485253393650055, gen p mean: -0.11119214445352554, mean p set: 0.44910016655921936The modified gen p mean: 0.4493889808654785, gen p mean: -0.1131570115685463, mean p set: 0.44996556639671326
loss_pred:0.016077803447842598, decouple_loss:0.000623814994469285
loss_pred:0.01540056150406599, decouple_loss:0.000637542805634439
The modified gen p mean: 0.44883620738983154, gen p mean: -0.11132899671792984, mean p set: 0.44941237568855286
loss_pred:0.015847308561205864, decouple_loss:0.0006103459745645523
Iteration: 1455, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44906648993492126, gen p mean: -0.10979178547859192, mean p set: 0.44964277744293213
loss_pred:0.015854360535740852, decouple_loss:0.0005718669854104519
The modified gen p mean: 0.4477141201496124, gen p mean: -0.12153889238834381, mean p set: 0.44829061627388
loss_pred:0.015666291117668152, decouple_loss:0.0005991542129777372
The modified gen p mean: 0.44912242889404297, gen p mean: -0.11565490067005157, mean p set: 0.4496983587741852
loss_pred:0.01589653268456459, decouple_loss:0.0007187812589108944
Iteration: 1456, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495199918746948, gen p mean: -0.11896016448736191, mean p set: 0.4500974118709564
loss_pred:0.015277210623025894, decouple_loss:0.0006422455189749599
The modified gen p mean: 0.44920220971107483, gen p mean: -0.11278977245092392, mean p set: 0.44977647066116333
loss_pred:0.015525522641837597, decouple_loss:0.0008746797684580088
The modified gen p mean: 0.45001572370529175, gen p mean: -0.12092652916908264, mean p set: 0.45059165358543396
loss_pred:0.015743721276521683, decouple_loss:0.0007188152521848679
Iteration: 1457, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484185576438904, gen p mean: -0.11677728593349457, mean p set: 0.44899484515190125
loss_pred:0.01653425581753254, decouple_loss:0.0005804268294014037
The modified gen p mean: 0.4478691816329956, gen p mean: -0.12054600566625595, mean p set: 0.4484458863735199
loss_pred:0.015568787232041359, decouple_loss:0.000832156278192997
The modified gen p mean: 0.4490043520927429, gen p mean: -0.11949963867664337, mean p set: 0.4495806396007538
loss_pred:0.014847898855805397, decouple_loss:0.0006850724457763135
Iteration: 1458, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499683976173401, gen p mean: -0.11107159405946732, mean p set: 0.45054665207862854
loss_pred:0.015129897743463516, decouple_loss:0.0008912119665183127
The modified gen p mean: 0.4487777650356293, gen p mean: -0.1207820251584053, mean p set: 0.4493550956249237
loss_pred:0.015175177715718746, decouple_loss:0.0005272399284876883
The modified gen p mean: 0.4485970139503479, gen p mean: -0.11486519873142242, mean p set: 0.4491713047027588
loss_pred:0.015874743461608887, decouple_loss:0.0007776193669997156
Iteration: 1459, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479137659072876, gen p mean: -0.12043696641921997, mean p set: 0.44848892092704773
The modified gen p mean: 0.44935449957847595, gen p mean: -0.1173241063952446, mean p set: 0.4499305486679077
loss_pred:0.015899162739515305, decouple_loss:0.0006619397317990661
loss_pred:0.014989661052823067, decouple_loss:0.0005663498304784298
The modified gen p mean: 0.44891357421875, gen p mean: -0.11604560166597366, mean p set: 0.4494885504245758
loss_pred:0.01618126407265663, decouple_loss:0.000670501496642828
Iteration: 1460, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44876036047935486, gen p mean: -0.12263565510511398, mean p set: 0.44933852553367615
loss_pred:0.015264764428138733, decouple_loss:0.00063273124396801
The modified gen p mean: 0.4491852819919586, gen p mean: -0.1125343069434166, mean p set: 0.4497624933719635
loss_pred:0.01547012384980917, decouple_loss:0.0007806936628185213
The modified gen p mean: 0.44813600182533264, gen p mean: -0.12195809930562973, mean p set: 0.44871246814727783
loss_pred:0.01573786698281765, decouple_loss:0.0006611369317397475
2023-05-01 21:10:56 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12482235580682755, mean p set: 0.4502691626548767
loss_pred:0.017133034765720367, decouple_loss:0.0005217571160756052
The modified gen p mean: 0.44953495264053345, gen p mean: -0.11834482848644257, mean p set: 0.4500633478164673
loss_pred:0.01649230532348156, decouple_loss:0.0005424968549050391
The modified gen p mean: 0.44977930188179016, gen p mean: -0.11763251572847366, mean p set: 0.45035696029663086
loss_pred:0.016739146783947945, decouple_loss:0.0005770628922618926
WV_1_PC_1_EH_0_PS_40, loss: 0.016815517097711563, avg_mse: 0.0261166300624609
current test mse: 0.026117
Iteration: 1461, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484315514564514, gen p mean: -0.12352483719587326, mean p set: 0.4490082263946533
loss_pred:0.01515782531350851, decouple_loss:0.000675905728712678
The modified gen p mean: 0.44935548305511475, gen p mean: -0.12055398523807526, mean p set: 0.4499303698539734
loss_pred:0.01590830273926258, decouple_loss:0.00064796581864357
The modified gen p mean: 0.44817858934402466, gen p mean: -0.12218526005744934, mean p set: 0.4487546384334564
loss_pred:0.01577882468700409, decouple_loss:0.0006107992376200855
Iteration: 1462, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474634826183319, gen p mean: -0.12238828092813492, mean p set: 0.4480412006378174
loss_pred:0.015534412115812302, decouple_loss:0.0006409797933883965
The modified gen p mean: 0.44921281933784485, gen p mean: -0.11480242758989334, mean p set: 0.4497894048690796The modified gen p mean: 0.44869694113731384, gen p mean: -0.11410852521657944, mean p set: 0.44927287101745605
loss_pred:0.015095269307494164, decouple_loss:0.0005853176116943359
loss_pred:0.015703046694397926, decouple_loss:0.0006775961956009269
Iteration: 1463, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479307234287262, gen p mean: -0.12071194499731064, mean p set: 0.44850850105285645
loss_pred:0.014841893687844276, decouple_loss:0.00047489182907156646
The modified gen p mean: 0.4497321546077728, gen p mean: -0.11215496808290482, mean p set: 0.450310081243515
loss_pred:0.015257985331118107, decouple_loss:0.0006377226673066616
The modified gen p mean: 0.4485282301902771, gen p mean: -0.11724437028169632, mean p set: 0.44910159707069397
loss_pred:0.01523785013705492, decouple_loss:0.000690760905854404
Iteration: 1464, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44824790954589844, gen p mean: -0.11526276171207428, mean p set: 0.4488248825073242
loss_pred:0.015346251428127289, decouple_loss:0.0005458295345306396
The modified gen p mean: 0.4494570195674896, gen p mean: -0.11644535511732101, mean p set: 0.45003435015678406
loss_pred:0.014991233125329018, decouple_loss:0.0005040225805714726
The modified gen p mean: 0.44890713691711426, gen p mean: -0.12164441496133804, mean p set: 0.4494836926460266
loss_pred:0.015218084678053856, decouple_loss:0.0006250105798244476
Iteration: 1465, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44943830370903015, gen p mean: -0.11491221934556961, mean p set: 0.4500153958797455
loss_pred:0.014516345225274563, decouple_loss:0.0006094136624597013
The modified gen p mean: 0.44914403557777405, gen p mean: -0.11591614037752151, mean p set: 0.44971972703933716
loss_pred:0.015018702484667301, decouple_loss:0.0005830286536365747
The modified gen p mean: 0.45059505105018616, gen p mean: -0.10956168174743652, mean p set: 0.451172411441803
loss_pred:0.015195733867585659, decouple_loss:0.0011100941337645054
Iteration: 1466, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478466510772705, gen p mean: -0.11771223694086075, mean p set: 0.44842392206192017
loss_pred:0.015047090128064156, decouple_loss:0.0005197692662477493
The modified gen p mean: 0.44891655445098877, gen p mean: -0.11006124317646027, mean p set: 0.4494929015636444
loss_pred:0.015267271548509598, decouple_loss:0.0004979547811672091
The modified gen p mean: 0.44982558488845825, gen p mean: -0.11905424296855927, mean p set: 0.4504038989543915
loss_pred:0.01490015722811222, decouple_loss:0.0004538542125374079
Iteration: 1467, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478285312652588, gen p mean: -0.11205987632274628, mean p set: 0.4484051764011383
loss_pred:0.015141313895583153, decouple_loss:0.0005076145171187818
The modified gen p mean: 0.44813698530197144, gen p mean: -0.11572179943323135, mean p set: 0.4487136900424957
loss_pred:0.015802428126335144, decouple_loss:0.0006246758857741952
The modified gen p mean: 0.448696494102478, gen p mean: -0.11574482172727585, mean p set: 0.4492739737033844
loss_pred:0.015603853389620781, decouple_loss:0.000720278185326606
Iteration: 1468, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44865700602531433, gen p mean: -0.12125246226787567, mean p set: 0.449236124753952
loss_pred:0.015056834556162357, decouple_loss:0.0005010414752177894
The modified gen p mean: 0.44933873414993286, gen p mean: -0.12173442542552948, mean p set: 0.44991445541381836
loss_pred:0.015202184207737446, decouple_loss:0.0005322055658325553
The modified gen p mean: 0.4489758312702179, gen p mean: -0.11891291290521622, mean p set: 0.4495515525341034
loss_pred:0.015244324691593647, decouple_loss:0.0005164528265595436
Iteration: 1469, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489400386810303, gen p mean: -0.11288630217313766, mean p set: 0.4495154023170471
The modified gen p mean: 0.4499433636665344, gen p mean: -0.11364514380693436, mean p set: 0.450520396232605
loss_pred:0.014512930065393448, decouple_loss:0.0004842916096094996
loss_pred:0.014883406460285187, decouple_loss:0.0006301591056399047
The modified gen p mean: 0.4483949840068817, gen p mean: -0.11463334411382675, mean p set: 0.44897210597991943
loss_pred:0.015324819833040237, decouple_loss:0.0005726318922825158
Iteration: 1470, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497332274913788, gen p mean: -0.11416412889957428, mean p set: 0.4503089487552643
loss_pred:0.014668257907032967, decouple_loss:0.000496376829687506
The modified gen p mean: 0.44829854369163513, gen p mean: -0.11124429851770401, mean p set: 0.4488753378391266
loss_pred:0.015400954522192478, decouple_loss:0.0006269566947594285
The modified gen p mean: 0.4492814242839813, gen p mean: -0.11100167036056519, mean p set: 0.44986000657081604
loss_pred:0.014992994256317616, decouple_loss:0.0005160730215720832
2023-05-01 21:13:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1204066202044487, mean p set: 0.4502691626548767
loss_pred:0.017111873254179955, decouple_loss:0.0005790875875391066
The modified gen p mean: 0.44953563809394836, gen p mean: -0.1141928881406784, mean p set: 0.4500633478164673
loss_pred:0.016445092856884003, decouple_loss:0.0005245428765192628
The modified gen p mean: 0.44978010654449463, gen p mean: -0.11352626979351044, mean p set: 0.45035696029663086
loss_pred:0.016756147146224976, decouple_loss:0.0005598323186859488
WV_1_PC_1_EH_0_PS_40, loss: 0.01679876260459423, avg_mse: 0.026161635294556618
current test mse: 0.026162
Iteration: 1471, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477832019329071, gen p mean: -0.11573820561170578, mean p set: 0.4483579099178314
loss_pred:0.014228548854589462, decouple_loss:0.0006328275776468217
The modified gen p mean: 0.45096394419670105, gen p mean: -0.10778949409723282, mean p set: 0.4515393376350403
loss_pred:0.015187877230346203, decouple_loss:0.0006447778432630002
The modified gen p mean: 0.4477721154689789, gen p mean: -0.11382800340652466, mean p set: 0.44834738969802856
loss_pred:0.014812019653618336, decouple_loss:0.0005391996237449348
Iteration: 1472, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477500319480896, gen p mean: -0.11874055117368698, mean p set: 0.44832560420036316
loss_pred:0.01508279051631689, decouple_loss:0.0005633967812173069
The modified gen p mean: 0.44843727350234985, gen p mean: -0.10654135793447495, mean p set: 0.44901344180107117The modified gen p mean: 0.4484196603298187, gen p mean: -0.10937097668647766, mean p set: 0.4489958584308624
loss_pred:0.015193402767181396, decouple_loss:0.0005072704516351223
loss_pred:0.0151761993765831, decouple_loss:0.0005967151373624802
Iteration: 1473, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799819588661194, gen p mean: -0.10668890178203583, mean p set: 0.4485754370689392
loss_pred:0.0156763456761837, decouple_loss:0.000650287140160799
The modified gen p mean: 0.44880327582359314, gen p mean: -0.10785849392414093, mean p set: 0.4493807256221771
loss_pred:0.014720861800014973, decouple_loss:0.0007620214018970728
The modified gen p mean: 0.4494653046131134, gen p mean: -0.10849269479513168, mean p set: 0.45004376769065857
loss_pred:0.013768423348665237, decouple_loss:0.0005054135108366609
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012018_3_24hr.npz
NaN value num: 0
Iteration: 1474, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45282259583473206, gen p mean: -0.10415785759687424, mean p set: 0.4534010887145996
loss_pred:0.01643085666000843, decouple_loss:0.0012466594344004989
The modified gen p mean: 0.4528410732746124, gen p mean: -0.09726929664611816, mean p set: 0.4534182846546173
loss_pred:0.01727203093469143, decouple_loss:0.0005476346123032272
The modified gen p mean: 0.4536604881286621, gen p mean: -0.10166996717453003, mean p set: 0.4542378783226013
loss_pred:0.01643451303243637, decouple_loss:0.00081500323722139
Iteration: 1475, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505113363265991, gen p mean: -0.09669576585292816, mean p set: 0.4510881304740906
loss_pred:0.016113553196191788, decouple_loss:0.0010079358471557498
The modified gen p mean: 0.44984379410743713, gen p mean: -0.10278408229351044, mean p set: 0.4504196047782898
loss_pred:0.01468199584633112, decouple_loss:0.000717506802175194
The modified gen p mean: 0.45229044556617737, gen p mean: -0.09376394748687744, mean p set: 0.45286890864372253
loss_pred:0.018070800229907036, decouple_loss:0.0005740938358940184
Iteration: 1476, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45186343789100647, gen p mean: -0.09325230866670609, mean p set: 0.4524429440498352
loss_pred:0.014964915812015533, decouple_loss:0.0006318891537375748
The modified gen p mean: 0.4520765244960785, gen p mean: -0.09808829426765442, mean p set: 0.452653169631958
loss_pred:0.017040591686964035, decouple_loss:0.0006621340871788561
The modified gen p mean: 0.4530632495880127, gen p mean: -0.09743881225585938, mean p set: 0.45363950729370117
loss_pred:0.015750819817185402, decouple_loss:0.0007110575679689646
Iteration: 1477, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504564106464386, gen p mean: -0.09849988669157028, mean p set: 0.4510316848754883
loss_pred:0.015478703193366528, decouple_loss:0.0005842807586304843
The modified gen p mean: 0.45169597864151, gen p mean: -0.09001566469669342, mean p set: 0.45227164030075073
loss_pred:0.016874942928552628, decouple_loss:0.000882281397935003
The modified gen p mean: 0.4495081603527069, gen p mean: -0.103312186896801, mean p set: 0.4500868618488312
loss_pred:0.014916115440428257, decouple_loss:0.0006930155213922262
Iteration: 1478, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511075019836426, gen p mean: -0.09601624310016632, mean p set: 0.45168498158454895
loss_pred:0.01618422567844391, decouple_loss:0.0007954161264933646
The modified gen p mean: 0.45406877994537354, gen p mean: -0.10078215599060059, mean p set: 0.454647958278656
loss_pred:0.015465919859707355, decouple_loss:0.0005093544605188072
The modified gen p mean: 0.45032626390457153, gen p mean: -0.10148702561855316, mean p set: 0.45090195536613464
loss_pred:0.015767045319080353, decouple_loss:0.0005846122512593865
Iteration: 1479, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45486804842948914, gen p mean: -0.10685812681913376, mean p set: 0.45544660091400146
loss_pred:0.015854256227612495, decouple_loss:0.0005825802218168974
The modified gen p mean: 0.4526350796222687, gen p mean: -0.10547120124101639, mean p set: 0.4532114863395691
The modified gen p mean: 0.45030853152275085, gen p mean: -0.10572046786546707, mean p set: 0.4508844316005707
loss_pred:0.015827912837266922, decouple_loss:0.0005291574052534997
loss_pred:0.015033895149827003, decouple_loss:0.0005169564392417669
Iteration: 1480, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517059028148651, gen p mean: -0.10183839499950409, mean p set: 0.452282190322876
The modified gen p mean: 0.45078450441360474, gen p mean: -0.1064777746796608, mean p set: 0.45136159658432007loss_pred:0.015172680839896202, decouple_loss:0.0004939681384712458
loss_pred:0.015126695856451988, decouple_loss:0.0005448583397082984
The modified gen p mean: 0.44978567957878113, gen p mean: -0.10735952109098434, mean p set: 0.4503626525402069
loss_pred:0.01551846694201231, decouple_loss:0.0007186877191998065
2023-05-01 21:15:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11909766495227814, mean p set: 0.4502691626548767
loss_pred:0.017052212730050087, decouple_loss:0.0005528227775357664
The modified gen p mean: 0.44953453540802, gen p mean: -0.11295090615749359, mean p set: 0.4500633478164673
loss_pred:0.01642824336886406, decouple_loss:0.0006191866123117507
The modified gen p mean: 0.4497798681259155, gen p mean: -0.11231031268835068, mean p set: 0.45035696029663086
loss_pred:0.016642967239022255, decouple_loss:0.0005863883998245001
WV_1_PC_1_EH_0_PS_40, loss: 0.016737116500735283, avg_mse: 0.026041321456432343
current test mse: 0.026041
Iteration: 1481, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536501467227936, gen p mean: -0.10576096922159195, mean p set: 0.45422741770744324
The modified gen p mean: 0.4518043100833893, gen p mean: -0.10671227425336838, mean p set: 0.45238202810287476loss_pred:0.01597617007791996, decouple_loss:0.0008827380370348692
loss_pred:0.014851575717329979, decouple_loss:0.0006504541961476207
The modified gen p mean: 0.4510402977466583, gen p mean: -0.10498656332492828, mean p set: 0.45161619782447815
loss_pred:0.01617157831788063, decouple_loss:0.0005693762213923037
Iteration: 1482, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533492624759674, gen p mean: -0.10899185389280319, mean p set: 0.4539260268211365
loss_pred:0.015286239795386791, decouple_loss:0.001265979721210897
The modified gen p mean: 0.45330068469047546, gen p mean: -0.10263219475746155, mean p set: 0.4538773000240326The modified gen p mean: 0.4501177966594696, gen p mean: -0.10732533782720566, mean p set: 0.4506944417953491
loss_pred:0.01731296442449093, decouple_loss:0.0005985513562336564
loss_pred:0.01705615408718586, decouple_loss:0.0007053789449855685
Iteration: 1483, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503187835216522, gen p mean: -0.09858275204896927, mean p set: 0.4508957266807556
loss_pred:0.015582918189466, decouple_loss:0.0006129792309366167
The modified gen p mean: 0.4531053602695465, gen p mean: -0.10851673781871796, mean p set: 0.4536832273006439
loss_pred:0.015853147953748703, decouple_loss:0.0011380619835108519
The modified gen p mean: 0.45325249433517456, gen p mean: -0.10091641545295715, mean p set: 0.4538283348083496
loss_pred:0.01672377809882164, decouple_loss:0.0005248121451586485
Iteration: 1484, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529809057712555, gen p mean: -0.10088250786066055, mean p set: 0.45355919003486633
loss_pred:0.017781805247068405, decouple_loss:0.000703481724485755
The modified gen p mean: 0.4514431655406952, gen p mean: -0.09380995482206345, mean p set: 0.4520170986652374
loss_pred:0.016810039058327675, decouple_loss:0.0007956823683343828
The modified gen p mean: 0.4539504647254944, gen p mean: -0.09681927412748337, mean p set: 0.4545283913612366
loss_pred:0.014785084873437881, decouple_loss:0.0006510865641757846
Iteration: 1485, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4547666311264038, gen p mean: -0.09667158871889114, mean p set: 0.45534548163414
loss_pred:0.014980570413172245, decouple_loss:0.000532487640157342
The modified gen p mean: 0.45340269804000854, gen p mean: -0.09375181049108505, mean p set: 0.45397984981536865
loss_pred:0.01455642469227314, decouple_loss:0.0006517664878629148
The modified gen p mean: 0.4513557255268097, gen p mean: -0.09817907214164734, mean p set: 0.4519317150115967
loss_pred:0.017204202711582184, decouple_loss:0.0006837256369180977
Iteration: 1486, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520275294780731, gen p mean: -0.09419383853673935, mean p set: 0.4526059925556183
loss_pred:0.017101136967539787, decouple_loss:0.0007247340399771929
The modified gen p mean: 0.45004281401634216, gen p mean: -0.09328590333461761, mean p set: 0.4506206214427948
loss_pred:0.01451398991048336, decouple_loss:0.0005559774581342936
The modified gen p mean: 0.4509035348892212, gen p mean: -0.09131575375795364, mean p set: 0.45147937536239624
loss_pred:0.015323430299758911, decouple_loss:0.00048043482820503414
Iteration: 1487, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520220160484314, gen p mean: -0.08907809853553772, mean p set: 0.45259830355644226
loss_pred:0.01602737233042717, decouple_loss:0.000807433680165559
The modified gen p mean: 0.45308929681777954, gen p mean: -0.08975137025117874, mean p set: 0.45366615056991577
The modified gen p mean: 0.4507550895214081, gen p mean: -0.0897073820233345, mean p set: 0.4513308107852936
loss_pred:0.017043326050043106, decouple_loss:0.0006585016963072121
loss_pred:0.015821214765310287, decouple_loss:0.0005345458630472422
Iteration: 1488, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529741704463959, gen p mean: -0.09904396533966064, mean p set: 0.4535527229309082
loss_pred:0.017373787239193916, decouple_loss:0.0007450107950717211
The modified gen p mean: 0.4527779221534729, gen p mean: -0.09998659789562225, mean p set: 0.4533534646034241
The modified gen p mean: 0.44954270124435425, gen p mean: -0.0969279408454895, mean p set: 0.45011797547340393
loss_pred:0.015868887305259705, decouple_loss:0.00051587272901088
loss_pred:0.014820343814790249, decouple_loss:0.0006074461853131652
Iteration: 1489, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44950035214424133, gen p mean: -0.09650088846683502, mean p set: 0.4500764310359955
loss_pred:0.015983635559678078, decouple_loss:0.0006197417969815433
The modified gen p mean: 0.45230183005332947, gen p mean: -0.09948056191205978, mean p set: 0.45287883281707764
The modified gen p mean: 0.4529901444911957, gen p mean: -0.1045638918876648, mean p set: 0.4535693824291229
loss_pred:0.01457997877150774, decouple_loss:0.0005518159014172852
loss_pred:0.015358595177531242, decouple_loss:0.0004394188290461898
Iteration: 1490, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517998993396759, gen p mean: -0.10362709313631058, mean p set: 0.4523768723011017
loss_pred:0.0146788340061903, decouple_loss:0.0004876336606685072
The modified gen p mean: 0.452482134103775, gen p mean: -0.10456579178571701, mean p set: 0.4530578553676605
The modified gen p mean: 0.4519718885421753, gen p mean: -0.10004419833421707, mean p set: 0.45254963636398315
loss_pred:0.017489563673734665, decouple_loss:0.001034366781823337
loss_pred:0.01632441021502018, decouple_loss:0.0007509134011343122
2023-05-01 21:17:51 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1167355328798294, mean p set: 0.4502691626548767
loss_pred:0.017165757715702057, decouple_loss:0.0006322708213701844
The modified gen p mean: 0.44953474402427673, gen p mean: -0.11043833196163177, mean p set: 0.4500633478164673
loss_pred:0.016521045938134193, decouple_loss:0.000895209435839206
The modified gen p mean: 0.44978228211402893, gen p mean: -0.10947015136480331, mean p set: 0.45035696029663086
loss_pred:0.016691088676452637, decouple_loss:0.0007972472812980413
WV_1_PC_1_EH_0_PS_40, loss: 0.016831375658512115, avg_mse: 0.02614012360572815
current test mse: 0.02614
Iteration: 1491, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45118167996406555, gen p mean: -0.10523015260696411, mean p set: 0.45175933837890625
loss_pred:0.014786899089813232, decouple_loss:0.0004877140745520592
The modified gen p mean: 0.45135796070098877, gen p mean: -0.10546392947435379, mean p set: 0.451936274766922
loss_pred:0.01602698676288128, decouple_loss:0.0005014424677938223
The modified gen p mean: 0.4529133141040802, gen p mean: -0.10306211560964584, mean p set: 0.453487753868103
loss_pred:0.01628386788070202, decouple_loss:0.0005353911546990275
Iteration: 1492, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45062145590782166, gen p mean: -0.09969533234834671, mean p set: 0.4511997699737549
loss_pred:0.015317211858928204, decouple_loss:0.000577209226321429
The modified gen p mean: 0.45319536328315735, gen p mean: -0.1043190136551857, mean p set: 0.4537713825702667The modified gen p mean: 0.4518587589263916, gen p mean: -0.10380620509386063, mean p set: 0.4524341821670532
loss_pred:0.015808653086423874, decouple_loss:0.0008417686331085861
loss_pred:0.015264760702848434, decouple_loss:0.00048579234862700105
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012012_3_24hr.npz
NaN value num: 0
Iteration: 1493, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772765040397644, gen p mean: -0.1086236760020256, mean p set: 0.4483039677143097
loss_pred:0.015161295421421528, decouple_loss:0.0008887220174074173
The modified gen p mean: 0.44745582342147827, gen p mean: -0.10758040845394135, mean p set: 0.4480327069759369The modified gen p mean: 0.44668489694595337, gen p mean: -0.10669326782226562, mean p set: 0.4472596049308777
loss_pred:0.014904459938406944, decouple_loss:0.0009177919127978384
loss_pred:0.015433713793754578, decouple_loss:0.0008741311030462384
Iteration: 1494, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44829440116882324, gen p mean: -0.11448970437049866, mean p set: 0.44886934757232666
The modified gen p mean: 0.446864515542984, gen p mean: -0.11400071531534195, mean p set: 0.4474402070045471
loss_pred:0.014937485568225384, decouple_loss:0.000610394577961415
loss_pred:0.015602693893015385, decouple_loss:0.0005776380421593785
The modified gen p mean: 0.4464535117149353, gen p mean: -0.11372251063585281, mean p set: 0.4470282196998596
loss_pred:0.015055389143526554, decouple_loss:0.0007217621896415949
Iteration: 1495, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760754704475403, gen p mean: -0.11329234391450882, mean p set: 0.4481825828552246
loss_pred:0.014826864935457706, decouple_loss:0.0005526166060008109
The modified gen p mean: 0.4467591941356659, gen p mean: -0.11851592361927032, mean p set: 0.4473342299461365
loss_pred:0.01536791492253542, decouple_loss:0.0005937573732808232
The modified gen p mean: 0.44739484786987305, gen p mean: -0.1161470040678978, mean p set: 0.4479711353778839
loss_pred:0.015376641415059566, decouple_loss:0.0006156478775665164
Iteration: 1496, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475584924221039, gen p mean: -0.12317007035017014, mean p set: 0.44813501834869385
loss_pred:0.015596350654959679, decouple_loss:0.000553859630599618
The modified gen p mean: 0.4474252462387085, gen p mean: -0.12169274687767029, mean p set: 0.44800058007240295
loss_pred:0.014561123214662075, decouple_loss:0.0005122758448123932
The modified gen p mean: 0.4473227560520172, gen p mean: -0.12096624076366425, mean p set: 0.44789940118789673
loss_pred:0.015727341175079346, decouple_loss:0.0006984961801208556
Iteration: 1497, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44857344031333923, gen p mean: -0.1298801302909851, mean p set: 0.4491502642631531
loss_pred:0.015373528003692627, decouple_loss:0.0005171365919522941
The modified gen p mean: 0.44719383120536804, gen p mean: -0.12910830974578857, mean p set: 0.4477671980857849
loss_pred:0.015324602834880352, decouple_loss:0.0008356525795534253
The modified gen p mean: 0.44692057371139526, gen p mean: -0.12890252470970154, mean p set: 0.4475003480911255
loss_pred:0.015114376321434975, decouple_loss:0.0004130932211410254
Iteration: 1498, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480782151222229, gen p mean: -0.12853455543518066, mean p set: 0.4486541748046875
loss_pred:0.015460974536836147, decouple_loss:0.0004902803339064121
The modified gen p mean: 0.4473387897014618, gen p mean: -0.13137097656726837, mean p set: 0.44791606068611145
loss_pred:0.015736408531665802, decouple_loss:0.0006332003395073116
The modified gen p mean: 0.4473447799682617, gen p mean: -0.13353721797466278, mean p set: 0.4479212760925293
loss_pred:0.014818443916738033, decouple_loss:0.0005506265442818403
Iteration: 1499, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468137323856354, gen p mean: -0.1364160031080246, mean p set: 0.4473881721496582
loss_pred:0.015171174891293049, decouple_loss:0.0006850918289273977
The modified gen p mean: 0.44763681292533875, gen p mean: -0.13125422596931458, mean p set: 0.4482133686542511
loss_pred:0.015217794105410576, decouple_loss:0.0005180009757168591
The modified gen p mean: 0.44693970680236816, gen p mean: -0.1331268846988678, mean p set: 0.4475173056125641
loss_pred:0.015237347222864628, decouple_loss:0.000516001891810447
Iteration: 1500, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483640491962433, gen p mean: -0.13486534357070923, mean p set: 0.448940247297287
loss_pred:0.015151992440223694, decouple_loss:0.0005887444131076336
The modified gen p mean: 0.44711068272590637, gen p mean: -0.13389204442501068, mean p set: 0.4476828873157501
loss_pred:0.014624301344156265, decouple_loss:0.0005267942324280739
The modified gen p mean: 0.4473300874233246, gen p mean: -0.12704144418239594, mean p set: 0.4479072690010071
loss_pred:0.015151127241551876, decouple_loss:0.000474627100629732
2023-05-01 21:20:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13514286279678345, mean p set: 0.4502691626548767
loss_pred:0.016984356567263603, decouple_loss:0.0005128335324116051
The modified gen p mean: 0.4495343863964081, gen p mean: -0.1285506933927536, mean p set: 0.4500633478164673
loss_pred:0.016459612175822258, decouple_loss:0.000571244687307626
The modified gen p mean: 0.44977906346321106, gen p mean: -0.12767495214939117, mean p set: 0.45035696029663086
loss_pred:0.01668187603354454, decouple_loss:0.0006317272782325745
WV_1_PC_1_EH_0_PS_40, loss: 0.016737211495637894, avg_mse: 0.02601485513150692
current test mse: 0.026015
Iteration: 1501, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485452175140381, gen p mean: -0.12409396469593048, mean p set: 0.4491216838359833
loss_pred:0.0147860087454319, decouple_loss:0.00047047276166267693
The modified gen p mean: 0.4480490982532501, gen p mean: -0.12807975709438324, mean p set: 0.44862261414527893The modified gen p mean: 0.44708698987960815, gen p mean: -0.1330794095993042, mean p set: 0.4476650059223175
loss_pred:0.014751770533621311, decouple_loss:0.0005650948151014745
loss_pred:0.01553895603865385, decouple_loss:0.0006093768170103431
Iteration: 1502, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478118121623993, gen p mean: -0.12717756628990173, mean p set: 0.44838836789131165
loss_pred:0.014494582079350948, decouple_loss:0.00047608668683096766
The modified gen p mean: 0.4472295343875885, gen p mean: -0.12802256643772125, mean p set: 0.44780340790748596The modified gen p mean: 0.4473779499530792, gen p mean: -0.12835519015789032, mean p set: 0.4479547441005707
loss_pred:0.014605440199375153, decouple_loss:0.00048174679977819324
loss_pred:0.015159612521529198, decouple_loss:0.0004769578517880291
Iteration: 1503, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483998417854309, gen p mean: -0.12239647656679153, mean p set: 0.44897761940956116
loss_pred:0.014811459928750992, decouple_loss:0.0004884706577286124
The modified gen p mean: 0.4471393823623657, gen p mean: -0.12349507957696915, mean p set: 0.4477144777774811
The modified gen p mean: 0.44867515563964844, gen p mean: -0.12343544512987137, mean p set: 0.44924822449684143
loss_pred:0.014805762097239494, decouple_loss:0.0004535184125415981
loss_pred:0.014668677002191544, decouple_loss:0.000496991619002074
Iteration: 1504, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476062059402466, gen p mean: -0.12339313328266144, mean p set: 0.4481835961341858
loss_pred:0.014989517629146576, decouple_loss:0.0005722740315832198
The modified gen p mean: 0.44780233502388, gen p mean: -0.12002722173929214, mean p set: 0.44837847352027893
loss_pred:0.014923115260899067, decouple_loss:0.0005323661025613546
The modified gen p mean: 0.44879376888275146, gen p mean: -0.12024403363466263, mean p set: 0.44937047362327576
loss_pred:0.015291370451450348, decouple_loss:0.0006145791849121451
Iteration: 1505, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475152790546417, gen p mean: -0.11532139033079147, mean p set: 0.4480895698070526
loss_pred:0.014550978317856789, decouple_loss:0.000492796185426414
The modified gen p mean: 0.4480215013027191, gen p mean: -0.11534257978200912, mean p set: 0.44860079884529114
loss_pred:0.01503126509487629, decouple_loss:0.00047636934323236346
The modified gen p mean: 0.44553571939468384, gen p mean: -0.11785029619932175, mean p set: 0.4461096227169037
loss_pred:0.014858960174024105, decouple_loss:0.0005430204328149557
Iteration: 1506, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772276282310486, gen p mean: -0.11744635552167892, mean p set: 0.4483005702495575
loss_pred:0.015463856048882008, decouple_loss:0.0006562754279002547
The modified gen p mean: 0.4478032886981964, gen p mean: -0.11627233773469925, mean p set: 0.4483788311481476
loss_pred:0.015238404273986816, decouple_loss:0.000626805704087019
The modified gen p mean: 0.4461866319179535, gen p mean: -0.11594841629266739, mean p set: 0.44676437973976135
loss_pred:0.014820175245404243, decouple_loss:0.0005831014132127166
Iteration: 1507, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628778100013733, gen p mean: -0.1174054741859436, mean p set: 0.4468632936477661
loss_pred:0.014938056468963623, decouple_loss:0.0006146188825368881
The modified gen p mean: 0.4476394057273865, gen p mean: -0.11607633531093597, mean p set: 0.44821637868881226
loss_pred:0.015123672783374786, decouple_loss:0.000935519055929035
The modified gen p mean: 0.4475999176502228, gen p mean: -0.11986546218395233, mean p set: 0.44817450642585754
loss_pred:0.015103042125701904, decouple_loss:0.0005796313052996993
Iteration: 1508, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485565721988678, gen p mean: -0.11354231834411621, mean p set: 0.44913291931152344
loss_pred:0.015199482440948486, decouple_loss:0.0008273983839899302
The modified gen p mean: 0.446778267621994, gen p mean: -0.1136847734451294, mean p set: 0.4473542869091034
loss_pred:0.014713902957737446, decouple_loss:0.0006063880282454193
The modified gen p mean: 0.4476883113384247, gen p mean: -0.11275241523981094, mean p set: 0.4482652246952057
loss_pred:0.014834458008408546, decouple_loss:0.0007123927935026586
Iteration: 1509, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485929012298584, gen p mean: -0.11345142871141434, mean p set: 0.44917070865631104
loss_pred:0.014959210529923439, decouple_loss:0.0004375985008664429
The modified gen p mean: 0.4479230046272278, gen p mean: -0.11119179427623749, mean p set: 0.4484962224960327
loss_pred:0.014944592490792274, decouple_loss:0.00044397456804290414
The modified gen p mean: 0.44762122631073, gen p mean: -0.11566999554634094, mean p set: 0.4481982886791229
loss_pred:0.014626421965658665, decouple_loss:0.000544854614418
Iteration: 1510, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44752949476242065, gen p mean: -0.1168639287352562, mean p set: 0.4481063485145569
loss_pred:0.015268298797309399, decouple_loss:0.0007632927154190838
The modified gen p mean: 0.4463822543621063, gen p mean: -0.11805013567209244, mean p set: 0.44695839285850525
loss_pred:0.01479931641370058, decouple_loss:0.0006026715273037553
The modified gen p mean: 0.4468434154987335, gen p mean: -0.11873161792755127, mean p set: 0.4474206268787384
loss_pred:0.014806805178523064, decouple_loss:0.0009475765400566161
2023-05-01 21:22:44 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12190865725278854, mean p set: 0.4502691626548767
loss_pred:0.017016345635056496, decouple_loss:0.0006695032934658229
The modified gen p mean: 0.4495354890823364, gen p mean: -0.11550101637840271, mean p set: 0.4500633478164673
loss_pred:0.016393199563026428, decouple_loss:0.000706821505445987
The modified gen p mean: 0.4497818946838379, gen p mean: -0.11526547372341156, mean p set: 0.45035696029663086
loss_pred:0.016684263944625854, decouple_loss:0.000870513787958771
WV_1_PC_1_EH_0_PS_40, loss: 0.016735384240746498, avg_mse: 0.0260330643504858
current test mse: 0.026033
Iteration: 1511, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669803977012634, gen p mean: -0.11710931360721588, mean p set: 0.44727250933647156
loss_pred:0.01487431675195694, decouple_loss:0.000607512891292572
The modified gen p mean: 0.4480226933956146, gen p mean: -0.11417094618082047, mean p set: 0.44860121607780457
The modified gen p mean: 0.4471917748451233, gen p mean: -0.12132067233324051, mean p set: 0.4477669298648834
loss_pred:0.014112398028373718, decouple_loss:0.0006076909485273063
loss_pred:0.015121783129870892, decouple_loss:0.0005150279612280428
Iteration: 1512, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44721099734306335, gen p mean: -0.11780685931444168, mean p set: 0.44778600335121155
loss_pred:0.014872606843709946, decouple_loss:0.0005868010339327157
The modified gen p mean: 0.44794365763664246, gen p mean: -0.11895380169153214, mean p set: 0.44852009415626526The modified gen p mean: 0.4458819031715393, gen p mean: -0.11513111740350723, mean p set: 0.44645851850509644
loss_pred:0.0146792558953166, decouple_loss:0.00048422443796880543loss_pred:0.014481920748949051, decouple_loss:0.00041339744348078966
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012004_3_24hr.npz
NaN value num: 0
Iteration: 1513, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4453892707824707, gen p mean: -0.12083686143159866, mean p set: 0.4459638297557831
loss_pred:0.016335297375917435, decouple_loss:0.0008514160290360451
The modified gen p mean: 0.4480728209018707, gen p mean: -0.11672444641590118, mean p set: 0.4486483037471771The modified gen p mean: 0.4467051923274994, gen p mean: -0.11725123226642609, mean p set: 0.44727998971939087
loss_pred:0.01717798039317131, decouple_loss:0.0008146435138769448
loss_pred:0.0166510920971632, decouple_loss:0.0006575091392733157
Iteration: 1514, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44629305601119995, gen p mean: -0.11620092391967773, mean p set: 0.4468673765659332
loss_pred:0.016411693766713142, decouple_loss:0.0005983131704851985
The modified gen p mean: 0.4479093849658966, gen p mean: -0.1122870072722435, mean p set: 0.4484868049621582
loss_pred:0.017727645114064217, decouple_loss:0.0006191171705722809
The modified gen p mean: 0.44748449325561523, gen p mean: -0.11337321251630783, mean p set: 0.4480600357055664
loss_pred:0.01713971048593521, decouple_loss:0.0006221085786819458
Iteration: 1515, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470881223678589, gen p mean: -0.11494996398687363, mean p set: 0.4476630687713623
loss_pred:0.01637442596256733, decouple_loss:0.0005272416165098548
The modified gen p mean: 0.44570648670196533, gen p mean: -0.1120406910777092, mean p set: 0.44628193974494934
loss_pred:0.016278529539704323, decouple_loss:0.000499134766869247
The modified gen p mean: 0.446756511926651, gen p mean: -0.11189692467451096, mean p set: 0.4473304748535156
loss_pred:0.01703537441790104, decouple_loss:0.00047823242493905127
Iteration: 1516, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460240304470062, gen p mean: -0.11290216445922852, mean p set: 0.44659915566444397
loss_pred:0.01633092761039734, decouple_loss:0.0006496428395621479
The modified gen p mean: 0.4475805461406708, gen p mean: -0.11028505861759186, mean p set: 0.44815483689308167
loss_pred:0.017270075157284737, decouple_loss:0.0008263086783699691
The modified gen p mean: 0.4482171833515167, gen p mean: -0.1135338619351387, mean p set: 0.4487939476966858
loss_pred:0.01642061211168766, decouple_loss:0.0009951833635568619
Iteration: 1517, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44654396176338196, gen p mean: -0.11734972894191742, mean p set: 0.44711804389953613
loss_pred:0.01653446815907955, decouple_loss:0.0006503341719508171
The modified gen p mean: 0.44517189264297485, gen p mean: -0.11438023298978806, mean p set: 0.4457470774650574
loss_pred:0.015956399962306023, decouple_loss:0.0005739277694374323
The modified gen p mean: 0.44661298394203186, gen p mean: -0.12030196189880371, mean p set: 0.44718730449676514
loss_pred:0.016377417370676994, decouple_loss:0.0006473356042988598
Iteration: 1518, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491477608680725, gen p mean: -0.11724163591861725, mean p set: 0.4497237801551819
loss_pred:0.016348212957382202, decouple_loss:0.0005383274401538074
The modified gen p mean: 0.4468704164028168, gen p mean: -0.11695612221956253, mean p set: 0.4474453032016754
loss_pred:0.01667202077805996, decouple_loss:0.0005190081428736448
The modified gen p mean: 0.44826358556747437, gen p mean: -0.11926229298114777, mean p set: 0.4488413631916046
loss_pred:0.01627378538250923, decouple_loss:0.0004855802108068019
Iteration: 1519, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464590549468994, gen p mean: -0.12068656831979752, mean p set: 0.4470330774784088
loss_pred:0.015694070607423782, decouple_loss:0.0009613025467842817
The modified gen p mean: 0.44783636927604675, gen p mean: -0.1150319054722786, mean p set: 0.44841283559799194
loss_pred:0.016519207507371902, decouple_loss:0.0007208628230728209
The modified gen p mean: 0.4472067356109619, gen p mean: -0.11459082365036011, mean p set: 0.4477825164794922
loss_pred:0.015817083418369293, decouple_loss:0.0007956495974212885
Iteration: 1520, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44792473316192627, gen p mean: -0.12091528624296188, mean p set: 0.4485023021697998
loss_pred:0.01768702268600464, decouple_loss:0.0006802473217248917
The modified gen p mean: 0.4482062757015228, gen p mean: -0.12750524282455444, mean p set: 0.4487829804420471
loss_pred:0.0158927571028471, decouple_loss:0.0006925751804374158
The modified gen p mean: 0.4457056224346161, gen p mean: -0.12321299314498901, mean p set: 0.4462781846523285
loss_pred:0.017571544274687767, decouple_loss:0.000763051095418632
2023-05-01 21:25:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12768948078155518, mean p set: 0.4502691626548767
loss_pred:0.01710209995508194, decouple_loss:0.0005823518731631339
The modified gen p mean: 0.4495338797569275, gen p mean: -0.12154737859964371, mean p set: 0.4500633478164673
loss_pred:0.016405871137976646, decouple_loss:0.0005688003147952259
The modified gen p mean: 0.4497794806957245, gen p mean: -0.12138418108224869, mean p set: 0.45035696029663086
loss_pred:0.0166921429336071, decouple_loss:0.0004982510581612587
WV_1_PC_1_EH_0_PS_40, loss: 0.01676086150109768, avg_mse: 0.026075609028339386
current test mse: 0.026076
Iteration: 1521, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44601452350616455, gen p mean: -0.1253293752670288, mean p set: 0.44658976793289185
loss_pred:0.016498247161507607, decouple_loss:0.0005176023114472628
The modified gen p mean: 0.44578254222869873, gen p mean: -0.12379150837659836, mean p set: 0.44635626673698425The modified gen p mean: 0.44806939363479614, gen p mean: -0.12677715718746185, mean p set: 0.4486467242240906
loss_pred:0.01627165637910366, decouple_loss:0.00047555271885357797
loss_pred:0.01626073755323887, decouple_loss:0.0004985422128811479
Iteration: 1522, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489974081516266, gen p mean: -0.13015896081924438, mean p set: 0.44957417249679565
loss_pred:0.015087033621966839, decouple_loss:0.0008481168188154697
The modified gen p mean: 0.4496663808822632, gen p mean: -0.12358389049768448, mean p set: 0.4502406716346741The modified gen p mean: 0.44739195704460144, gen p mean: -0.12231132388114929, mean p set: 0.4479677379131317
loss_pred:0.015302933752536774, decouple_loss:0.000980671844445169
loss_pred:0.01693126931786537, decouple_loss:0.0009323080885224044
Iteration: 1523, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44617128372192383, gen p mean: -0.12912137806415558, mean p set: 0.44674885272979736
loss_pred:0.016400130465626717, decouple_loss:0.0007158321095630527
The modified gen p mean: 0.4471261203289032, gen p mean: -0.12425500154495239, mean p set: 0.44770243763923645
loss_pred:0.016351308673620224, decouple_loss:0.0007793956901878119
The modified gen p mean: 0.44781187176704407, gen p mean: -0.12058896571397781, mean p set: 0.4483906924724579
loss_pred:0.0164254829287529, decouple_loss:0.0008748360560275614
Iteration: 1524, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464627802371979, gen p mean: -0.12188702076673508, mean p set: 0.4470408260822296
loss_pred:0.016040736809372902, decouple_loss:0.0005549285560846329
The modified gen p mean: 0.44804006814956665, gen p mean: -0.11766789108514786, mean p set: 0.4486178159713745
loss_pred:0.01672578603029251, decouple_loss:0.0007451247656717896
The modified gen p mean: 0.4472000002861023, gen p mean: -0.12139797955751419, mean p set: 0.4477749764919281
loss_pred:0.01735805720090866, decouple_loss:0.0006170520791783929
Iteration: 1525, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44439831376075745, gen p mean: -0.12008166313171387, mean p set: 0.4449720084667206
loss_pred:0.016648229211568832, decouple_loss:0.000702108780387789
The modified gen p mean: 0.4458518922328949, gen p mean: -0.12567634880542755, mean p set: 0.44642698764801025
loss_pred:0.016370413824915886, decouple_loss:0.0009930204832926393
The modified gen p mean: 0.4467030465602875, gen p mean: -0.1187208816409111, mean p set: 0.447277694940567
loss_pred:0.017278295010328293, decouple_loss:0.00046817390830256045
Iteration: 1526, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475761353969574, gen p mean: -0.11337782442569733, mean p set: 0.4481523334980011
loss_pred:0.015822825953364372, decouple_loss:0.0006540988688357174
The modified gen p mean: 0.4475407600402832, gen p mean: -0.11209216713905334, mean p set: 0.44811511039733887
The modified gen p mean: 0.44843775033950806, gen p mean: -0.11171554774045944, mean p set: 0.4490150213241577
loss_pred:0.016444608569145203, decouple_loss:0.0009554031421430409
loss_pred:0.017280373722314835, decouple_loss:0.0007414794526994228
Iteration: 1527, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4441029727458954, gen p mean: -0.11360014230012894, mean p set: 0.44467902183532715
loss_pred:0.016936806961894035, decouple_loss:0.0005875065107829869
The modified gen p mean: 0.44989487528800964, gen p mean: -0.11094489693641663, mean p set: 0.4504740536212921
loss_pred:0.01495548989623785, decouple_loss:0.0005644350894726813
The modified gen p mean: 0.4469282925128937, gen p mean: -0.11477696150541306, mean p set: 0.44750338792800903
loss_pred:0.016385110095143318, decouple_loss:0.0006137977470643818
Iteration: 1528, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469740092754364, gen p mean: -0.11156322062015533, mean p set: 0.4475480318069458
loss_pred:0.016621023416519165, decouple_loss:0.0005395738990046084
The modified gen p mean: 0.44743597507476807, gen p mean: -0.10920014977455139, mean p set: 0.4480111598968506
loss_pred:0.01635952852666378, decouple_loss:0.0004919535131193697
The modified gen p mean: 0.44465628266334534, gen p mean: -0.11299804598093033, mean p set: 0.4452323615550995
loss_pred:0.015941070392727852, decouple_loss:0.0006468993960879743
Iteration: 1529, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852617383003235, gen p mean: -0.10849673300981522, mean p set: 0.4491027295589447
loss_pred:0.016377048566937447, decouple_loss:0.0009415796375833452
The modified gen p mean: 0.445051372051239, gen p mean: -0.11324255168437958, mean p set: 0.4456256330013275
loss_pred:0.016593921929597855, decouple_loss:0.0007179005187936127
The modified gen p mean: 0.44917529821395874, gen p mean: -0.11363402754068375, mean p set: 0.449752539396286
loss_pred:0.015256966464221478, decouple_loss:0.0005480811814777553
Iteration: 1530, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44947734475135803, gen p mean: -0.11809190362691879, mean p set: 0.4500530958175659
loss_pred:0.014632176607847214, decouple_loss:0.0005880271783098578
The modified gen p mean: 0.4452016055583954, gen p mean: -0.11761833727359772, mean p set: 0.44577544927597046
loss_pred:0.015857569873332977, decouple_loss:0.0006484711775556207
The modified gen p mean: 0.448546439409256, gen p mean: -0.11496670544147491, mean p set: 0.44912174344062805
loss_pred:0.016181884333491325, decouple_loss:0.000644607120193541
2023-05-01 21:27:35 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1215788796544075, mean p set: 0.4502691626548767
loss_pred:0.017038514837622643, decouple_loss:0.0005292947171255946
The modified gen p mean: 0.44953370094299316, gen p mean: -0.11577332019805908, mean p set: 0.4500633478164673
loss_pred:0.01639299839735031, decouple_loss:0.0005984190502204001
The modified gen p mean: 0.44978222250938416, gen p mean: -0.11523453146219254, mean p set: 0.45035696029663086
loss_pred:0.01674293912947178, decouple_loss:0.0005771331489086151
WV_1_PC_1_EH_0_PS_40, loss: 0.01675323210656643, avg_mse: 0.02605973370373249
current test mse: 0.02606
Iteration: 1531, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457365572452545, gen p mean: -0.12149018794298172, mean p set: 0.4463125169277191
loss_pred:0.016970375552773476, decouple_loss:0.0005295391893014312
The modified gen p mean: 0.4502957761287689, gen p mean: -0.12064141780138016, mean p set: 0.450869619846344The modified gen p mean: 0.4475440979003906, gen p mean: -0.1231306716799736, mean p set: 0.4481199383735657
loss_pred:0.016345418989658356, decouple_loss:0.000593516742810607loss_pred:0.014898457564413548, decouple_loss:0.00045607078936882317
Iteration: 1532, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463950991630554, gen p mean: -0.12175300717353821, mean p set: 0.4469718039035797
loss_pred:0.016016583889722824, decouple_loss:0.0007243018480949104
The modified gen p mean: 0.44530606269836426, gen p mean: -0.12390732020139694, mean p set: 0.44588083028793335The modified gen p mean: 0.4466193914413452, gen p mean: -0.11800037324428558, mean p set: 0.4471952021121979
loss_pred:0.01591145619750023, decouple_loss:0.0005004140548408031
loss_pred:0.015825647860765457, decouple_loss:0.000628975045401603
/scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_09012003_3_24hr.npz
NaN value num: 0
Iteration: 1533, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44796642661094666, gen p mean: -0.11305820941925049, mean p set: 0.4485420286655426
loss_pred:0.015035531483590603, decouple_loss:0.0005416772910393775
The modified gen p mean: 0.44927114248275757, gen p mean: -0.11900777369737625, mean p set: 0.44984567165374756
The modified gen p mean: 0.44735583662986755, gen p mean: -0.11751765757799149, mean p set: 0.4479316174983978
loss_pred:0.014987499453127384, decouple_loss:0.00046226251288317144
loss_pred:0.015449317172169685, decouple_loss:0.0006382392020896077
Iteration: 1534, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812044501304626, gen p mean: -0.12383195757865906, mean p set: 0.44869375228881836
loss_pred:0.015165522694587708, decouple_loss:0.0005363980890251696
The modified gen p mean: 0.44777336716651917, gen p mean: -0.121597521007061, mean p set: 0.4483504593372345
loss_pred:0.01472171489149332, decouple_loss:0.000564462214242667
The modified gen p mean: 0.4480736255645752, gen p mean: -0.11953271180391312, mean p set: 0.448650062084198
loss_pred:0.015064273960888386, decouple_loss:0.0005555989919230342
Iteration: 1535, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468108117580414, gen p mean: -0.12373712658882141, mean p set: 0.44738414883613586
loss_pred:0.015484136529266834, decouple_loss:0.0006455254042521119
The modified gen p mean: 0.4481436014175415, gen p mean: -0.12802140414714813, mean p set: 0.44871968030929565
loss_pred:0.014457736164331436, decouple_loss:0.0005239722668193281
The modified gen p mean: 0.44786521792411804, gen p mean: -0.12407980859279633, mean p set: 0.44843941926956177
loss_pred:0.014623777940869331, decouple_loss:0.0004980209632776678
Iteration: 1536, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44733086228370667, gen p mean: -0.12313350290060043, mean p set: 0.4479077458381653
loss_pred:0.014556137844920158, decouple_loss:0.0006305857095867395
The modified gen p mean: 0.44836053252220154, gen p mean: -0.1329190880060196, mean p set: 0.4489334523677826
loss_pred:0.014616903848946095, decouple_loss:0.0004892956931143999
The modified gen p mean: 0.4482324719429016, gen p mean: -0.1280381679534912, mean p set: 0.44880932569503784
loss_pred:0.015006516128778458, decouple_loss:0.0005152869853191078
Iteration: 1537, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44756728410720825, gen p mean: -0.13305304944515228, mean p set: 0.4481446146965027
loss_pred:0.015659041702747345, decouple_loss:0.0007775608683004975
The modified gen p mean: 0.4490720331668854, gen p mean: -0.12990471720695496, mean p set: 0.4496456980705261
loss_pred:0.014358987100422382, decouple_loss:0.0006408219342119992
The modified gen p mean: 0.44750797748565674, gen p mean: -0.1316596418619156, mean p set: 0.4480842351913452
loss_pred:0.014696354046463966, decouple_loss:0.0008041638066060841
Iteration: 1538, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471549987792969, gen p mean: -0.12657342851161957, mean p set: 0.4477311074733734
loss_pred:0.014943228103220463, decouple_loss:0.0005403810646384954
The modified gen p mean: 0.4467257559299469, gen p mean: -0.1274935007095337, mean p set: 0.44730088114738464
loss_pred:0.014685861766338348, decouple_loss:0.0006126406951807439
The modified gen p mean: 0.4488476514816284, gen p mean: -0.12504883110523224, mean p set: 0.4494239091873169
loss_pred:0.013888614252209663, decouple_loss:0.0008059757528826594
Iteration: 1539, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44716131687164307, gen p mean: -0.12722891569137573, mean p set: 0.4477364122867584
loss_pred:0.014676815830171108, decouple_loss:0.0007143496186472476
The modified gen p mean: 0.44824591279029846, gen p mean: -0.12094584852457047, mean p set: 0.44881969690322876
loss_pred:0.015126979909837246, decouple_loss:0.0006597285391762853
The modified gen p mean: 0.44811782240867615, gen p mean: -0.1302458792924881, mean p set: 0.4486970603466034
loss_pred:0.015142697840929031, decouple_loss:0.0006049610674381256
Iteration: 1540, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44964516162872314, gen p mean: -0.12129347026348114, mean p set: 0.4502216577529907
loss_pred:0.014938438311219215, decouple_loss:0.0004976015770807862
The modified gen p mean: 0.4475461542606354, gen p mean: -0.12135947495698929, mean p set: 0.4481230676174164
loss_pred:0.014747134409844875, decouple_loss:0.0005154067184776068
The modified gen p mean: 0.44805869460105896, gen p mean: -0.12413852661848068, mean p set: 0.44863688945770264
loss_pred:0.014236727729439735, decouple_loss:0.0006054651457816362
2023-05-01 21:30:21 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12861935794353485, mean p set: 0.4502691626548767
loss_pred:0.017079604789614677, decouple_loss:0.0006280221859924495
The modified gen p mean: 0.44953492283821106, gen p mean: -0.1226399689912796, mean p set: 0.4500633478164673
loss_pred:0.016439275816082954, decouple_loss:0.0005765445530414581
The modified gen p mean: 0.4497784674167633, gen p mean: -0.1217368096113205, mean p set: 0.45035696029663086
loss_pred:0.01678566448390484, decouple_loss:0.0005905471625737846
WV_1_PC_1_EH_0_PS_40, loss: 0.016798101365566254, avg_mse: 0.02614743635058403
current test mse: 0.026147
Iteration: 1541, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446699857711792, gen p mean: -0.12166358530521393, mean p set: 0.44727620482444763
loss_pred:0.014943891204893589, decouple_loss:0.0006130835972726345
The modified gen p mean: 0.45040515065193176, gen p mean: -0.12965455651283264, mean p set: 0.45098060369491577The modified gen p mean: 0.4492954611778259, gen p mean: -0.12611360847949982, mean p set: 0.4498688280582428
loss_pred:0.01443931832909584, decouple_loss:0.0007554084877483547loss_pred:0.014381378889083862, decouple_loss:0.0007390382816083729
Iteration: 1542, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485180079936981, gen p mean: -0.11665955930948257, mean p set: 0.44909510016441345
loss_pred:0.014628244563937187, decouple_loss:0.0005105978343635798
The modified gen p mean: 0.4479311406612396, gen p mean: -0.12587970495224, mean p set: 0.448505699634552
The modified gen p mean: 0.44895637035369873, gen p mean: -0.12120205163955688, mean p set: 0.449531614780426
loss_pred:0.014420649036765099, decouple_loss:0.0006855296669527888
loss_pred:0.014800461940467358, decouple_loss:0.0007628315361216664
Iteration: 1543, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486294984817505, gen p mean: -0.1264520287513733, mean p set: 0.4492042660713196
loss_pred:0.013964332640171051, decouple_loss:0.0004094189789611846
The modified gen p mean: 0.44792038202285767, gen p mean: -0.12529700994491577, mean p set: 0.4484964609146118
loss_pred:0.014338759705424309, decouple_loss:0.0005407269927673042
The modified gen p mean: 0.4484451115131378, gen p mean: -0.11581160128116608, mean p set: 0.44902175664901733
loss_pred:0.014848422259092331, decouple_loss:0.0005599454161711037
Iteration: 1544, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483727216720581, gen p mean: -0.12610426545143127, mean p set: 0.4489465653896332
loss_pred:0.01448594406247139, decouple_loss:0.0005041955155320466
The modified gen p mean: 0.4488371014595032, gen p mean: -0.12766721844673157, mean p set: 0.4494134187698364
loss_pred:0.014048737473785877, decouple_loss:0.0004257666296325624
The modified gen p mean: 0.4480619728565216, gen p mean: -0.11594867706298828, mean p set: 0.44864022731781006
loss_pred:0.0148462587967515, decouple_loss:0.0006216382025741041
Iteration: 1545, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485379159450531, gen p mean: -0.13027703762054443, mean p set: 0.4491152763366699
loss_pred:0.014242996461689472, decouple_loss:0.00047163068666122854
The modified gen p mean: 0.4483705461025238, gen p mean: -0.11684004217386246, mean p set: 0.44894805550575256
loss_pred:0.014698616228997707, decouple_loss:0.0005372705636546016
The modified gen p mean: 0.4476549029350281, gen p mean: -0.1195693388581276, mean p set: 0.44823071360588074
loss_pred:0.014404387213289738, decouple_loss:0.0005221200990490615
Iteration: 1546, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44731730222702026, gen p mean: -0.1263342946767807, mean p set: 0.4478953182697296
loss_pred:0.01451784186065197, decouple_loss:0.0004883288056589663
The modified gen p mean: 0.44871121644973755, gen p mean: -0.13010235130786896, mean p set: 0.4492855668067932
loss_pred:0.014143147505819798, decouple_loss:0.0006315598729997873
The modified gen p mean: 0.44833847880363464, gen p mean: -0.12998022139072418, mean p set: 0.44891637563705444
loss_pred:0.014611119404435158, decouple_loss:0.0005488229799084365
Iteration: 1547, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44888976216316223, gen p mean: -0.12564675509929657, mean p set: 0.4494667053222656
loss_pred:0.013741359114646912, decouple_loss:0.0005484464345499873
The modified gen p mean: 0.4475201666355133, gen p mean: -0.12586519122123718, mean p set: 0.4480955898761749
loss_pred:0.01494819950312376, decouple_loss:0.0006862794398330152
The modified gen p mean: 0.4483494460582733, gen p mean: -0.12570299208164215, mean p set: 0.44892609119415283
loss_pred:0.01416932325810194, decouple_loss:0.0007155651692301035
Iteration: 1548, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481419324874878, gen p mean: -0.12955187261104584, mean p set: 0.44872117042541504
loss_pred:0.014947921968996525, decouple_loss:0.0005689474637620151
The modified gen p mean: 0.4469355046749115, gen p mean: -0.1314743310213089, mean p set: 0.4475100636482239
The modified gen p mean: 0.44828057289123535, gen p mean: -0.13436323404312134, mean p set: 0.4488562345504761
loss_pred:0.014421645551919937, decouple_loss:0.0006450701621361077
loss_pred:0.014584378339350224, decouple_loss:0.0007198991952463984
Iteration: 1549, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45047882199287415, gen p mean: -0.13182412087917328, mean p set: 0.4510541558265686
loss_pred:0.01431980449706316, decouple_loss:0.0007368550868704915
The modified gen p mean: 0.4487960636615753, gen p mean: -0.13349168002605438, mean p set: 0.44937342405319214
loss_pred:0.014197522774338722, decouple_loss:0.0005954919033683836
The modified gen p mean: 0.4480661153793335, gen p mean: -0.13289032876491547, mean p set: 0.4486437141895294
loss_pred:0.01450556144118309, decouple_loss:0.0006169562693685293
Iteration: 1550, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480465352535248, gen p mean: -0.12333764135837555, mean p set: 0.448621928691864
loss_pred:0.014760877937078476, decouple_loss:0.0006674324977211654
The modified gen p mean: 0.4484443962574005, gen p mean: -0.11951540410518646, mean p set: 0.44901901483535767
loss_pred:0.014968703500926495, decouple_loss:0.00055083935149014
The modified gen p mean: 0.44832029938697815, gen p mean: -0.13326580822467804, mean p set: 0.44889357686042786
loss_pred:0.014583932235836983, decouple_loss:0.000582580512855202
2023-05-01 21:32:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12950795888900757, mean p set: 0.4502691626548767
loss_pred:0.01713705249130726, decouple_loss:0.0006476806593127549
The modified gen p mean: 0.44953596591949463, gen p mean: -0.12371529638767242, mean p set: 0.4500633478164673
loss_pred:0.016405554488301277, decouple_loss:0.0006938649457879364
The modified gen p mean: 0.44978150725364685, gen p mean: -0.12295208871364594, mean p set: 0.45035696029663086
loss_pred:0.016738394275307655, decouple_loss:0.0007339314906857908
WV_1_PC_1_EH_0_PS_40, loss: 0.016794925555586815, avg_mse: 0.02614213153719902
current test mse: 0.026142
Iteration: 1551, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877955317497253, gen p mean: -0.1260160207748413, mean p set: 0.44935348629951477
loss_pred:0.014787032268941402, decouple_loss:0.0006663742824457586
The modified gen p mean: 0.44892656803131104, gen p mean: -0.12180668115615845, mean p set: 0.4495035707950592
loss_pred:0.013925319537520409, decouple_loss:0.0005661674658767879
The modified gen p mean: 0.44765573740005493, gen p mean: -0.1203213706612587, mean p set: 0.448231041431427
loss_pred:0.014603006653487682, decouple_loss:0.0007414332358166575
Iteration: 1552, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487508237361908, gen p mean: -0.12831160426139832, mean p set: 0.44932815432548523
loss_pred:0.014288335107266903, decouple_loss:0.0010232154745608568
The modified gen p mean: 0.44926461577415466, gen p mean: -0.11928337812423706, mean p set: 0.44984006881713867
The modified gen p mean: 0.44763821363449097, gen p mean: -0.11953837424516678, mean p set: 0.4482152760028839
loss_pred:0.014843928627669811, decouple_loss:0.0006338271778076887
loss_pred:0.014625205658376217, decouple_loss:0.0007193288183771074
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012020_3_24hr.npz
NaN value num: 0
Iteration: 1553, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526354670524597, gen p mean: -0.114534892141819, mean p set: 0.453212171792984
loss_pred:0.017474137246608734, decouple_loss:0.0009330534376204014
The modified gen p mean: 0.4509755074977875, gen p mean: -0.11844006925821304, mean p set: 0.45155251026153564
loss_pred:0.017159998416900635, decouple_loss:0.0008585950708948076
The modified gen p mean: 0.45024627447128296, gen p mean: -0.11553698033094406, mean p set: 0.4508230984210968
loss_pred:0.017739102244377136, decouple_loss:0.0010093667078763247
Iteration: 1554, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512498080730438, gen p mean: -0.11089695245027542, mean p set: 0.45182281732559204
loss_pred:0.017109371721744537, decouple_loss:0.0004888457478955388
The modified gen p mean: 0.4497383236885071, gen p mean: -0.11379943788051605, mean p set: 0.4503157436847687
loss_pred:0.017036644741892815, decouple_loss:0.0006948923110030591
The modified gen p mean: 0.45150095224380493, gen p mean: -0.11357947438955307, mean p set: 0.4520774781703949
loss_pred:0.016758888959884644, decouple_loss:0.0005927142919972539
Iteration: 1555, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019230246543884, gen p mean: -0.11612872779369354, mean p set: 0.450769305229187
loss_pred:0.016567673534154892, decouple_loss:0.0008471517357975245
The modified gen p mean: 0.4511392116546631, gen p mean: -0.10874036699533463, mean p set: 0.45171743631362915
loss_pred:0.016659291461110115, decouple_loss:0.0006597102619707584
The modified gen p mean: 0.4509974420070648, gen p mean: -0.11355748772621155, mean p set: 0.45157456398010254
loss_pred:0.016781166195869446, decouple_loss:0.0008367495029233396
Iteration: 1556, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45185884833335876, gen p mean: -0.10938333719968796, mean p set: 0.45243576169013977
loss_pred:0.016715770587325096, decouple_loss:0.0009735077037476003
The modified gen p mean: 0.4521636366844177, gen p mean: -0.11141475290060043, mean p set: 0.45274025201797485
loss_pred:0.016855761408805847, decouple_loss:0.0008171693771146238
The modified gen p mean: 0.45060548186302185, gen p mean: -0.11270304769277573, mean p set: 0.4511813521385193
loss_pred:0.01669037714600563, decouple_loss:0.0008479428361169994
Iteration: 1557, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500911235809326, gen p mean: -0.11334685981273651, mean p set: 0.45066869258880615
The modified gen p mean: 0.45240718126296997, gen p mean: -0.10974534600973129, mean p set: 0.4529826045036316
loss_pred:0.017690908163785934, decouple_loss:0.0005384866381064057
loss_pred:0.017056815326213837, decouple_loss:0.0006148713873699307
The modified gen p mean: 0.4515933692455292, gen p mean: -0.10887578129768372, mean p set: 0.4521689713001251
loss_pred:0.017114754766225815, decouple_loss:0.0006585365044884384
Iteration: 1558, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523274600505829, gen p mean: -0.10583939403295517, mean p set: 0.4529035687446594
loss_pred:0.016835715621709824, decouple_loss:0.0005590635119006038
The modified gen p mean: 0.4497508406639099, gen p mean: -0.11252420395612717, mean p set: 0.45032763481140137
loss_pred:0.017297817394137383, decouple_loss:0.0008985491585917771
The modified gen p mean: 0.4529344141483307, gen p mean: -0.1099085658788681, mean p set: 0.4535127878189087
loss_pred:0.016880910843610764, decouple_loss:0.0006715520285069942
Iteration: 1559, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497339725494385, gen p mean: -0.1183571144938469, mean p set: 0.4503115713596344
loss_pred:0.01635844260454178, decouple_loss:0.0007075852481648326
The modified gen p mean: 0.4517081379890442, gen p mean: -0.1166440099477768, mean p set: 0.4522883892059326
loss_pred:0.016402775421738625, decouple_loss:0.0006129321991465986
The modified gen p mean: 0.45027467608451843, gen p mean: -0.11450496315956116, mean p set: 0.4508522152900696
loss_pred:0.016732748597860336, decouple_loss:0.0007626095321029425
Iteration: 1560, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45296934247016907, gen p mean: -0.11828286945819855, mean p set: 0.4535471498966217
loss_pred:0.016358572989702225, decouple_loss:0.0005261421902105212
The modified gen p mean: 0.4515685737133026, gen p mean: -0.1106177344918251, mean p set: 0.4521452486515045
loss_pred:0.016855081543326378, decouple_loss:0.0007194324862211943
The modified gen p mean: 0.4523066282272339, gen p mean: -0.10949169844388962, mean p set: 0.45288509130477905
loss_pred:0.01645396277308464, decouple_loss:0.000726241385564208
2023-05-01 21:35:13 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12751337885856628, mean p set: 0.4502691626548767
loss_pred:0.017226234078407288, decouple_loss:0.0005884504644200206
The modified gen p mean: 0.44953426718711853, gen p mean: -0.12153564393520355, mean p set: 0.4500633478164673
loss_pred:0.01636158674955368, decouple_loss:0.0005438643274828792
The modified gen p mean: 0.44977906346321106, gen p mean: -0.12080149352550507, mean p set: 0.45035696029663086
loss_pred:0.016805266961455345, decouple_loss:0.0005207250360399485
WV_1_PC_1_EH_0_PS_40, loss: 0.016825247555971146, avg_mse: 0.02619500271975994
current test mse: 0.026195
Iteration: 1561, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498231112957001, gen p mean: -0.11486119031906128, mean p set: 0.45039960741996765
loss_pred:0.016974082216620445, decouple_loss:0.0008073436329141259
The modified gen p mean: 0.4530165493488312, gen p mean: -0.10882150381803513, mean p set: 0.4535941779613495
The modified gen p mean: 0.45128464698791504, gen p mean: -0.110956110060215, mean p set: 0.4518618583679199
loss_pred:0.017094682902097702, decouple_loss:0.0007396213477477431
loss_pred:0.01701914705336094, decouple_loss:0.0007598059601150453
Iteration: 1562, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975924491882324, gen p mean: -0.11210199445486069, mean p set: 0.450334757566452
loss_pred:0.017283622175455093, decouple_loss:0.0006113415001891553
The modified gen p mean: 0.4522724747657776, gen p mean: -0.11296715587377548, mean p set: 0.45284631848335266The modified gen p mean: 0.45203521847724915, gen p mean: -0.11011500656604767, mean p set: 0.45261165499687195
loss_pred:0.0165498498827219, decouple_loss:0.0005531706847250462
loss_pred:0.016043681651353836, decouple_loss:0.000934284704271704
Iteration: 1563, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518267512321472, gen p mean: -0.11571071296930313, mean p set: 0.45240524411201477
loss_pred:0.016595689579844475, decouple_loss:0.0008080813568085432
The modified gen p mean: 0.45195266604423523, gen p mean: -0.10865823924541473, mean p set: 0.4525289833545685
loss_pred:0.017049534246325493, decouple_loss:0.0006414991221390665
The modified gen p mean: 0.4527237117290497, gen p mean: -0.11103222519159317, mean p set: 0.4533001780509949
loss_pred:0.016627181321382523, decouple_loss:0.000560020562261343
Iteration: 1564, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45203328132629395, gen p mean: -0.11132675409317017, mean p set: 0.45260950922966003
loss_pred:0.01713869720697403, decouple_loss:0.0005821228260174394
The modified gen p mean: 0.4512154459953308, gen p mean: -0.10817519575357437, mean p set: 0.4517933130264282
loss_pred:0.017134355381131172, decouple_loss:0.001045644166879356
The modified gen p mean: 0.45254722237586975, gen p mean: -0.10825741291046143, mean p set: 0.4531249403953552
loss_pred:0.01707296632230282, decouple_loss:0.0006653456948697567
Iteration: 1565, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515336751937866, gen p mean: -0.10908068716526031, mean p set: 0.45210960507392883
loss_pred:0.01589805632829666, decouple_loss:0.0008083203574642539
The modified gen p mean: 0.4525038003921509, gen p mean: -0.11772206425666809, mean p set: 0.45307838916778564
loss_pred:0.016506334766745567, decouple_loss:0.0006339168758131564
The modified gen p mean: 0.45103463530540466, gen p mean: -0.11593639850616455, mean p set: 0.4516104459762573
loss_pred:0.01674533262848854, decouple_loss:0.000912057061214
Iteration: 1566, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451976478099823, gen p mean: -0.10629937797784805, mean p set: 0.45255225896835327
loss_pred:0.015814324840903282, decouple_loss:0.0005829429137520492
The modified gen p mean: 0.45054343342781067, gen p mean: -0.11259254813194275, mean p set: 0.45111966133117676
loss_pred:0.01711873523890972, decouple_loss:0.0006712581380270422
The modified gen p mean: 0.4518485963344574, gen p mean: -0.10343939065933228, mean p set: 0.4524257183074951
loss_pred:0.01748763583600521, decouple_loss:0.0008003516704775393
Iteration: 1567, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500671625137329, gen p mean: -0.11022357642650604, mean p set: 0.45064473152160645
loss_pred:0.017404993996024132, decouple_loss:0.0007986685377545655
The modified gen p mean: 0.4510127007961273, gen p mean: -0.11278590559959412, mean p set: 0.45158782601356506
loss_pred:0.017246417701244354, decouple_loss:0.0008553240913897753
The modified gen p mean: 0.4517722427845001, gen p mean: -0.11189042776823044, mean p set: 0.45234790444374084
loss_pred:0.016810927540063858, decouple_loss:0.0006501892348751426
Iteration: 1568, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490257799625397, gen p mean: -0.10794048011302948, mean p set: 0.4496026933193207
loss_pred:0.01762247085571289, decouple_loss:0.0010209151078015566
The modified gen p mean: 0.4508812725543976, gen p mean: -0.10495340824127197, mean p set: 0.4514564573764801
loss_pred:0.016474580392241478, decouple_loss:0.0007500802166759968
The modified gen p mean: 0.45052987337112427, gen p mean: -0.1099943295121193, mean p set: 0.4511050879955292
loss_pred:0.017280254513025284, decouple_loss:0.0005864620325155556
Iteration: 1569, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521438181400299, gen p mean: -0.10773348063230515, mean p set: 0.45271924138069153
loss_pred:0.015984846279025078, decouple_loss:0.0007647714810445905
The modified gen p mean: 0.4529576301574707, gen p mean: -0.10560817271471024, mean p set: 0.4535359740257263
loss_pred:0.01705237105488777, decouple_loss:0.0011486610164865851
The modified gen p mean: 0.45242437720298767, gen p mean: -0.10912108421325684, mean p set: 0.4530024528503418
loss_pred:0.016290592029690742, decouple_loss:0.0009330505854450166
Iteration: 1570, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45227131247520447, gen p mean: -0.10719645023345947, mean p set: 0.45284944772720337
loss_pred:0.016567915678024292, decouple_loss:0.0009729770245030522
The modified gen p mean: 0.4522078037261963, gen p mean: -0.10265976190567017, mean p set: 0.45278608798980713
loss_pred:0.0177006758749485, decouple_loss:0.0007713591912761331
The modified gen p mean: 0.45169544219970703, gen p mean: -0.1060703843832016, mean p set: 0.45227110385894775
loss_pred:0.01643635891377926, decouple_loss:0.0006580250919796526
2023-05-01 21:37:19 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12136423587799072, mean p set: 0.4502691626548767
loss_pred:0.017111215740442276, decouple_loss:0.0010379224549978971
The modified gen p mean: 0.44953441619873047, gen p mean: -0.11557548493146896, mean p set: 0.4500633478164673
loss_pred:0.016405751928687096, decouple_loss:0.001017955713905394
The modified gen p mean: 0.44977903366088867, gen p mean: -0.11474359780550003, mean p set: 0.45035696029663086
loss_pred:0.016697820276021957, decouple_loss:0.0008784830570220947
WV_1_PC_1_EH_0_PS_40, loss: 0.016787169501185417, avg_mse: 0.026139849796891212
current test mse: 0.02614
Iteration: 1571, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449624627828598, gen p mean: -0.11370580643415451, mean p set: 0.4502023756504059
loss_pred:0.01641654781997204, decouple_loss:0.0009411758510395885
The modified gen p mean: 0.4526362717151642, gen p mean: -0.11070451885461807, mean p set: 0.45321333408355713
The modified gen p mean: 0.45145076513290405, gen p mean: -0.10397752374410629, mean p set: 0.45202744007110596
loss_pred:0.016380591318011284, decouple_loss:0.0010151154128834605
loss_pred:0.01703047752380371, decouple_loss:0.0007937656482681632
Iteration: 1572, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45144185423851013, gen p mean: -0.10549451410770416, mean p set: 0.4520201086997986
loss_pred:0.01612553559243679, decouple_loss:0.0005635597044602036
The modified gen p mean: 0.45211857557296753, gen p mean: -0.10391061753034592, mean p set: 0.45269373059272766The modified gen p mean: 0.45327651500701904, gen p mean: -0.10832028090953827, mean p set: 0.45385733246803284
loss_pred:0.016698066145181656, decouple_loss:0.0007430815603584051
loss_pred:0.017955442890524864, decouple_loss:0.0006418188568204641
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012016_3_24hr.npz
NaN value num: 0
Iteration: 1573, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163223147392273, gen p mean: -0.11002922803163528, mean p set: 0.45220738649368286
loss_pred:0.01735708676278591, decouple_loss:0.0007443262729793787
The modified gen p mean: 0.4493279457092285, gen p mean: -0.11724702268838882, mean p set: 0.44990405440330505The modified gen p mean: 0.44975581765174866, gen p mean: -0.11625391989946365, mean p set: 0.45033276081085205
loss_pred:0.016740184277296066, decouple_loss:0.000624229374807328loss_pred:0.016655312851071358, decouple_loss:0.0007428851677104831
Iteration: 1574, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45034724473953247, gen p mean: -0.11198596656322479, mean p set: 0.45092108845710754
loss_pred:0.01800788938999176, decouple_loss:0.000780987087637186
The modified gen p mean: 0.4488990008831024, gen p mean: -0.11653552949428558, mean p set: 0.4494756758213043
loss_pred:0.016194431111216545, decouple_loss:0.000569873780477792
The modified gen p mean: 0.4505370259284973, gen p mean: -0.11372621357440948, mean p set: 0.4511137008666992
loss_pred:0.016479572281241417, decouple_loss:0.0006368675385601819
Iteration: 1575, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492875039577484, gen p mean: -0.1180398240685463, mean p set: 0.44986429810523987
loss_pred:0.01682879403233528, decouple_loss:0.0007249921909533441
The modified gen p mean: 0.44950535893440247, gen p mean: -0.1115054115653038, mean p set: 0.45008236169815063
loss_pred:0.017955804243683815, decouple_loss:0.000899955106433481
The modified gen p mean: 0.44916537404060364, gen p mean: -0.11372412741184235, mean p set: 0.4497425854206085
loss_pred:0.01631288416683674, decouple_loss:0.0006452918169088662
Iteration: 1576, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449516624212265, gen p mean: -0.11317883431911469, mean p set: 0.4500959813594818
loss_pred:0.017487598583102226, decouple_loss:0.0006315903156064451
The modified gen p mean: 0.4494978189468384, gen p mean: -0.11239047348499298, mean p set: 0.45007210969924927
loss_pred:0.016165457665920258, decouple_loss:0.0006337061640806496
The modified gen p mean: 0.4480094015598297, gen p mean: -0.11442140489816666, mean p set: 0.44858694076538086
loss_pred:0.017756208777427673, decouple_loss:0.0006683271494694054
Iteration: 1577, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928810000419617, gen p mean: -0.11408746987581253, mean p set: 0.44986405968666077
loss_pred:0.017026690766215324, decouple_loss:0.0005944716394878924
The modified gen p mean: 0.4494674503803253, gen p mean: -0.11881621181964874, mean p set: 0.4500441253185272
loss_pred:0.01705186441540718, decouple_loss:0.0007018055766820908
The modified gen p mean: 0.4495360553264618, gen p mean: -0.11620409786701202, mean p set: 0.4501130282878876
loss_pred:0.016415249556303024, decouple_loss:0.0007270792848430574
Iteration: 1578, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505099654197693, gen p mean: -0.11232379078865051, mean p set: 0.45108816027641296
loss_pred:0.016374824568629265, decouple_loss:0.0007503515807911754
The modified gen p mean: 0.4501878619194031, gen p mean: -0.11307387053966522, mean p set: 0.4507644772529602
loss_pred:0.01720375567674637, decouple_loss:0.0008896692306734622
The modified gen p mean: 0.4497462809085846, gen p mean: -0.11064325273036957, mean p set: 0.45032259821891785
loss_pred:0.01782868057489395, decouple_loss:0.0007455527666024864
Iteration: 1579, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498317837715149, gen p mean: -0.10843189060688019, mean p set: 0.45040687918663025
loss_pred:0.016952157020568848, decouple_loss:0.0004712439840659499
The modified gen p mean: 0.4491361081600189, gen p mean: -0.1172536313533783, mean p set: 0.4497132897377014
loss_pred:0.016541361808776855, decouple_loss:0.0007783005712553859
The modified gen p mean: 0.4500137269496918, gen p mean: -0.11043347418308258, mean p set: 0.4505922794342041
loss_pred:0.01651669107377529, decouple_loss:0.0005104672745801508
Iteration: 1580, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892922043800354, gen p mean: -0.11739432066679001, mean p set: 0.44950413703918457
loss_pred:0.01771475002169609, decouple_loss:0.0006579190376214683
The modified gen p mean: 0.4485447108745575, gen p mean: -0.11575819551944733, mean p set: 0.44912293553352356
loss_pred:0.017397960647940636, decouple_loss:0.0006251921877264977
The modified gen p mean: 0.45022547245025635, gen p mean: -0.10910946130752563, mean p set: 0.4508011043071747
loss_pred:0.01706702634692192, decouple_loss:0.0007233645883388817
2023-05-01 21:40:00 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12613941729068756, mean p set: 0.4502691626548767
loss_pred:0.01706407032907009, decouple_loss:0.0005351413274183869
The modified gen p mean: 0.44953498244285583, gen p mean: -0.12065648287534714, mean p set: 0.4500633478164673
loss_pred:0.01648690737783909, decouple_loss:0.0006600568303838372
The modified gen p mean: 0.44978025555610657, gen p mean: -0.11994823068380356, mean p set: 0.45035696029663086
loss_pred:0.016670159995555878, decouple_loss:0.0007235188968479633
WV_1_PC_1_EH_0_PS_40, loss: 0.016772357746958733, avg_mse: 0.026100168004631996
current test mse: 0.0261
Iteration: 1581, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958335161209106, gen p mean: -0.11590568721294403, mean p set: 0.45016080141067505
loss_pred:0.016432669013738632, decouple_loss:0.0008188373176380992
The modified gen p mean: 0.4501774311065674, gen p mean: -0.11347595602273941, mean p set: 0.450754314661026
The modified gen p mean: 0.44930964708328247, gen p mean: -0.1099485233426094, mean p set: 0.44988563656806946
loss_pred:0.017156638205051422, decouple_loss:0.0005871753091923892
loss_pred:0.01623002253472805, decouple_loss:0.0007033229921944439
Iteration: 1582, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45132654905319214, gen p mean: -0.11731686443090439, mean p set: 0.45190247893333435
loss_pred:0.017536861822009087, decouple_loss:0.0008187573403120041
The modified gen p mean: 0.4496767520904541, gen p mean: -0.11662019044160843, mean p set: 0.4502537250518799The modified gen p mean: 0.44864407181739807, gen p mean: -0.11758548021316528, mean p set: 0.4492204785346985
loss_pred:0.016200508922338486, decouple_loss:0.0006536344299092889
loss_pred:0.016633855178952217, decouple_loss:0.0006139404140412807
Iteration: 1583, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44940900802612305, gen p mean: -0.12252058833837509, mean p set: 0.4499862790107727
loss_pred:0.016314061358571053, decouple_loss:0.0006311425822786987
The modified gen p mean: 0.447944313287735, gen p mean: -0.12244144827127457, mean p set: 0.4485178589820862
loss_pred:0.016388338059186935, decouple_loss:0.0008027459844015539
The modified gen p mean: 0.44955238699913025, gen p mean: -0.12513765692710876, mean p set: 0.45012786984443665
loss_pred:0.016060877591371536, decouple_loss:0.0005342088988982141
Iteration: 1584, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501297175884247, gen p mean: -0.11708519607782364, mean p set: 0.45070680975914
loss_pred:0.01736539416015148, decouple_loss:0.0005410888115875423
The modified gen p mean: 0.45013341307640076, gen p mean: -0.11507254093885422, mean p set: 0.4507102370262146
loss_pred:0.016788486391305923, decouple_loss:0.0006897307466715574
The modified gen p mean: 0.44912078976631165, gen p mean: -0.11071932315826416, mean p set: 0.4496959447860718
loss_pred:0.017208104953169823, decouple_loss:0.0009688659920357168
Iteration: 1585, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44852739572525024, gen p mean: -0.11310777068138123, mean p set: 0.4491018056869507
loss_pred:0.01705760695040226, decouple_loss:0.0006003989255987108
The modified gen p mean: 0.4488391876220703, gen p mean: -0.11278919130563736, mean p set: 0.4494173526763916
loss_pred:0.0168214850127697, decouple_loss:0.0005752610741183162
The modified gen p mean: 0.44934505224227905, gen p mean: -0.11739683896303177, mean p set: 0.44992440938949585
loss_pred:0.0164779182523489, decouple_loss:0.0005792310694232583
Iteration: 1586, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504600167274475, gen p mean: -0.10813690721988678, mean p set: 0.4510369300842285
loss_pred:0.01718972437083721, decouple_loss:0.0005490460898727179
The modified gen p mean: 0.44867023825645447, gen p mean: -0.11480940878391266, mean p set: 0.4492502808570862
loss_pred:0.01678365282714367, decouple_loss:0.0006630179123021662
The modified gen p mean: 0.4497150480747223, gen p mean: -0.10866077244281769, mean p set: 0.4502915143966675
loss_pred:0.01670454815030098, decouple_loss:0.000584323366638273
Iteration: 1587, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971001148223877, gen p mean: -0.11107055097818375, mean p set: 0.450285404920578
loss_pred:0.016607001423835754, decouple_loss:0.0009398268302902579
The modified gen p mean: 0.4502779543399811, gen p mean: -0.10925658047199249, mean p set: 0.4508536458015442
loss_pred:0.016219113022089005, decouple_loss:0.0006605687085539103
The modified gen p mean: 0.45035725831985474, gen p mean: -0.10642524808645248, mean p set: 0.45093461871147156
loss_pred:0.017361603677272797, decouple_loss:0.000874976278282702
Iteration: 1588, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498928487300873, gen p mean: -0.10301201045513153, mean p set: 0.45046865940093994
loss_pred:0.016482021659612656, decouple_loss:0.0005678927409462631
The modified gen p mean: 0.4500912129878998, gen p mean: -0.10790043324232101, mean p set: 0.4506663978099823
loss_pred:0.016705093905329704, decouple_loss:0.0006888025091029704
The modified gen p mean: 0.44948098063468933, gen p mean: -0.1084926575422287, mean p set: 0.4500577449798584
loss_pred:0.015777384862303734, decouple_loss:0.0006518004811368883
Iteration: 1589, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519769549369812, gen p mean: -0.10621972382068634, mean p set: 0.45255526900291443
loss_pred:0.017305312678217888, decouple_loss:0.0006099313031882048
The modified gen p mean: 0.4496493339538574, gen p mean: -0.1069776713848114, mean p set: 0.4502260982990265
loss_pred:0.016505641862750053, decouple_loss:0.0006909709190949798
The modified gen p mean: 0.4494912028312683, gen p mean: -0.10947343707084656, mean p set: 0.4500654339790344
loss_pred:0.016568735241889954, decouple_loss:0.0006626088288612664
Iteration: 1590, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44853076338768005, gen p mean: -0.1095941886305809, mean p set: 0.44910579919815063
loss_pred:0.01675502583384514, decouple_loss:0.0007770936354063451
The modified gen p mean: 0.4488791823387146, gen p mean: -0.10410188138484955, mean p set: 0.449457585811615
loss_pred:0.01752506196498871, decouple_loss:0.0006560347974300385
The modified gen p mean: 0.44892674684524536, gen p mean: -0.11313506215810776, mean p set: 0.4495038390159607
loss_pred:0.016249215230345726, decouple_loss:0.0008306411327794194
2023-05-01 21:42:06 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12382107973098755, mean p set: 0.4502691626548767
loss_pred:0.017151305451989174, decouple_loss:0.0005223592161200941
The modified gen p mean: 0.44978150725364685, gen p mean: -0.11733101308345795, mean p set: 0.45035696029663086
loss_pred:0.016763051971793175, decouple_loss:0.0006460078293457627
The modified gen p mean: 0.4495336413383484, gen p mean: -0.11794038861989975, mean p set: 0.4500633478164673
loss_pred:0.016644975170493126, decouple_loss:0.00061078614089638
WV_1_PC_1_EH_0_PS_40, loss: 0.016882766038179398, avg_mse: 0.02626541443169117
current test mse: 0.026265
Iteration: 1591, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44968557357788086, gen p mean: -0.10857775807380676, mean p set: 0.45026183128356934
loss_pred:0.01695597916841507, decouple_loss:0.0005325666279532015
The modified gen p mean: 0.4496793746948242, gen p mean: -0.1132562980055809, mean p set: 0.45025599002838135The modified gen p mean: 0.4499340057373047, gen p mean: -0.10814269632101059, mean p set: 0.45051151514053345
loss_pred:0.016564615070819855, decouple_loss:0.0005684243515133858
loss_pred:0.017203934490680695, decouple_loss:0.0006450541550293565
Iteration: 1592, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492439925670624, gen p mean: -0.11607179045677185, mean p set: 0.44981908798217773
loss_pred:0.016420358791947365, decouple_loss:0.0006465287879109383
The modified gen p mean: 0.4491024911403656, gen p mean: -0.10971281677484512, mean p set: 0.44967761635780334The modified gen p mean: 0.4489401578903198, gen p mean: -0.11613424122333527, mean p set: 0.4495159983634949
loss_pred:0.017140047624707222, decouple_loss:0.000725463149137795loss_pred:0.01694084145128727, decouple_loss:0.0005141195142641664
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012002_3_24hr.npz
NaN value num: 0
Iteration: 1593, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44650837779045105, gen p mean: -0.12727750837802887, mean p set: 0.44708412885665894
loss_pred:0.015885060653090477, decouple_loss:0.0005890745669603348
The modified gen p mean: 0.44639065861701965, gen p mean: -0.12929871678352356, mean p set: 0.44696754217147827
loss_pred:0.01486511342227459, decouple_loss:0.0005382999661378562
The modified gen p mean: 0.44712600111961365, gen p mean: -0.12387554347515106, mean p set: 0.4477007985115051
loss_pred:0.015983140096068382, decouple_loss:0.0005982373841106892
Iteration: 1594, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44620469212532043, gen p mean: -0.12653709948062897, mean p set: 0.4467789828777313
loss_pred:0.015781758353114128, decouple_loss:0.0006034846301190555
The modified gen p mean: 0.44776612520217896, gen p mean: -0.12452711910009384, mean p set: 0.44834378361701965
loss_pred:0.015263586305081844, decouple_loss:0.0005920121329836547
The modified gen p mean: 0.4483039975166321, gen p mean: -0.1260853409767151, mean p set: 0.448881059885025
loss_pred:0.015587651170790195, decouple_loss:0.0006239282083697617
Iteration: 1595, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477365016937256, gen p mean: -0.1245269700884819, mean p set: 0.44831427931785583
loss_pred:0.015486232936382294, decouple_loss:0.0005867222789674997
The modified gen p mean: 0.448501855134964, gen p mean: -0.12610429525375366, mean p set: 0.44907715916633606
loss_pred:0.01525109726935625, decouple_loss:0.0005692177801392972
The modified gen p mean: 0.4473573863506317, gen p mean: -0.1258305460214615, mean p set: 0.4479331374168396
loss_pred:0.01574227400124073, decouple_loss:0.0005741802742704749
Iteration: 1596, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44622889161109924, gen p mean: -0.12557452917099, mean p set: 0.44680383801460266
loss_pred:0.015461972914636135, decouple_loss:0.0004842666385229677
The modified gen p mean: 0.4461318850517273, gen p mean: -0.1259642392396927, mean p set: 0.4467063546180725
loss_pred:0.015787838026881218, decouple_loss:0.0005124747985973954
The modified gen p mean: 0.44686973094940186, gen p mean: -0.12284518033266068, mean p set: 0.44744551181793213
loss_pred:0.015358088538050652, decouple_loss:0.0004279954591766
Iteration: 1597, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463665783405304, gen p mean: -0.11911245435476303, mean p set: 0.44694095849990845
loss_pred:0.016488397493958473, decouple_loss:0.0004912046133540571
The modified gen p mean: 0.4467160105705261, gen p mean: -0.12185053527355194, mean p set: 0.44729292392730713
loss_pred:0.015798037871718407, decouple_loss:0.0007382429903373122
The modified gen p mean: 0.4465310275554657, gen p mean: -0.12427039444446564, mean p set: 0.44710773229599
loss_pred:0.01585344225168228, decouple_loss:0.00045453227357938886
Iteration: 1598, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44570836424827576, gen p mean: -0.12549486756324768, mean p set: 0.4462839961051941
loss_pred:0.01525725144892931, decouple_loss:0.0005070557817816734
The modified gen p mean: 0.44762226939201355, gen p mean: -0.1271195411682129, mean p set: 0.4481981694698334
loss_pred:0.01613881252706051, decouple_loss:0.0006496437126770616
The modified gen p mean: 0.4473167657852173, gen p mean: -0.12350043654441833, mean p set: 0.4478902518749237
loss_pred:0.01597006246447563, decouple_loss:0.000779088179115206
Iteration: 1599, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471794366836548, gen p mean: -0.11561369895935059, mean p set: 0.4477542042732239
loss_pred:0.015897976234555244, decouple_loss:0.0005974303930997849
The modified gen p mean: 0.4457797110080719, gen p mean: -0.12424647063016891, mean p set: 0.44635844230651855
loss_pred:0.015439959242939949, decouple_loss:0.0004834771971218288
The modified gen p mean: 0.44548457860946655, gen p mean: -0.12230139225721359, mean p set: 0.4460590183734894
loss_pred:0.01559443213045597, decouple_loss:0.0006224705139175057
Iteration: 1600, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457552134990692, gen p mean: -0.12258486449718475, mean p set: 0.4463306665420532
loss_pred:0.015634242445230484, decouple_loss:0.0005998600390739739
The modified gen p mean: 0.44845330715179443, gen p mean: -0.12187080830335617, mean p set: 0.4490286707878113
loss_pred:0.015915682539343834, decouple_loss:0.0006433220696635544
The modified gen p mean: 0.44651368260383606, gen p mean: -0.12732821702957153, mean p set: 0.4470905363559723
loss_pred:0.015228497795760632, decouple_loss:0.0008227742509916425
2023-05-01 21:44:51 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12698481976985931, mean p set: 0.4502691626548767
loss_pred:0.017149295657873154, decouple_loss:0.0006337887025438249
The modified gen p mean: 0.44953474402427673, gen p mean: -0.12171489000320435, mean p set: 0.4500633478164673
loss_pred:0.016511712223291397, decouple_loss:0.0006258211797103286
The modified gen p mean: 0.44978296756744385, gen p mean: -0.12109897285699844, mean p set: 0.45035696029663086
loss_pred:0.016776278614997864, decouple_loss:0.0006195491878315806
WV_1_PC_1_EH_0_PS_40, loss: 0.016843749210238457, avg_mse: 0.026102427393198013
current test mse: 0.026102
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1601, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464513659477234, gen p mean: -0.12247199565172195, mean p set: 0.4470267593860626
loss_pred:0.015412747859954834, decouple_loss:0.0006387179018929601
The modified gen p mean: 0.4463534951210022, gen p mean: -0.12888838350772858, mean p set: 0.44692835211753845
loss_pred:0.015083170495927334, decouple_loss:0.0006546262884512544
The modified gen p mean: 0.4489383101463318, gen p mean: -0.12773530185222626, mean p set: 0.4495137631893158
loss_pred:0.015217537991702557, decouple_loss:0.0005657529691234231
Iteration: 1602, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481883943080902, gen p mean: -0.12288723140954971, mean p set: 0.44876447319984436
loss_pred:0.014894386753439903, decouple_loss:0.00044830545084550977
The modified gen p mean: 0.4471376836299896, gen p mean: -0.12260749936103821, mean p set: 0.44771286845207214The modified gen p mean: 0.4474329352378845, gen p mean: -0.11644916981458664, mean p set: 0.448009192943573
loss_pred:0.015293722972273827, decouple_loss:0.0006061943713575602
loss_pred:0.0156684722751379, decouple_loss:0.00048731706920079887
Iteration: 1603, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44635501503944397, gen p mean: -0.11770215630531311, mean p set: 0.4469318985939026
The modified gen p mean: 0.4478655457496643, gen p mean: -0.12158562242984772, mean p set: 0.44844114780426025
loss_pred:0.0158146470785141, decouple_loss:0.000570857897400856
loss_pred:0.015553126111626625, decouple_loss:0.0005694062565453351
The modified gen p mean: 0.44617173075675964, gen p mean: -0.12083930522203445, mean p set: 0.446748286485672
loss_pred:0.01604078710079193, decouple_loss:0.0005145333707332611
Iteration: 1604, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480408728122711, gen p mean: -0.11647786945104599, mean p set: 0.44861549139022827
loss_pred:0.015393170528113842, decouple_loss:0.0005104585434310138
The modified gen p mean: 0.44688060879707336, gen p mean: -0.11680976301431656, mean p set: 0.4474574029445648
loss_pred:0.015459488146007061, decouple_loss:0.00048050552140921354
The modified gen p mean: 0.4477824568748474, gen p mean: -0.11780445277690887, mean p set: 0.4483581483364105
loss_pred:0.01482446026057005, decouple_loss:0.0005206493078731
Iteration: 1605, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44776400923728943, gen p mean: -0.11701260507106781, mean p set: 0.4483422338962555
loss_pred:0.015381963923573494, decouple_loss:0.0005167319905012846
The modified gen p mean: 0.44684144854545593, gen p mean: -0.11333129554986954, mean p set: 0.44741740822792053
loss_pred:0.01627470925450325, decouple_loss:0.0005512199131771922
The modified gen p mean: 0.447013258934021, gen p mean: -0.11509121209383011, mean p set: 0.44758957624435425
loss_pred:0.015917647629976273, decouple_loss:0.00043581239879131317
Iteration: 1606, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466409981250763, gen p mean: -0.11361115425825119, mean p set: 0.44721704721450806The modified gen p mean: 0.4463292360305786, gen p mean: -0.11285369843244553, mean p set: 0.44690370559692383
loss_pred:0.014841419644653797, decouple_loss:0.000593123200815171
loss_pred:0.015133198350667953, decouple_loss:0.0005891771288588643
The modified gen p mean: 0.44781145453453064, gen p mean: -0.11765042692422867, mean p set: 0.44838783144950867
loss_pred:0.01531848032027483, decouple_loss:0.000532975303940475
Iteration: 1607, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470387399196625, gen p mean: -0.1144539937376976, mean p set: 0.4476129114627838
loss_pred:0.01601472683250904, decouple_loss:0.0006121555343270302
The modified gen p mean: 0.4473610520362854, gen p mean: -0.11717932671308517, mean p set: 0.44793781638145447
The modified gen p mean: 0.44692015647888184, gen p mean: -0.11731860786676407, mean p set: 0.4474954903125763
loss_pred:0.015973690897226334, decouple_loss:0.0004945264663547277
loss_pred:0.015437722206115723, decouple_loss:0.0004294566751923412
Iteration: 1608, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468232989311218, gen p mean: -0.11897893995046616, mean p set: 0.44739776849746704
loss_pred:0.01512946654111147, decouple_loss:0.0006785700097680092
The modified gen p mean: 0.4465833902359009, gen p mean: -0.11706194281578064, mean p set: 0.44716131687164307
loss_pred:0.01570313423871994, decouple_loss:0.0005745360977016389
The modified gen p mean: 0.44660264253616333, gen p mean: -0.11827187240123749, mean p set: 0.44717955589294434
loss_pred:0.015268729999661446, decouple_loss:0.0006308229640126228
Iteration: 1609, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480055868625641, gen p mean: -0.1192532479763031, mean p set: 0.44858217239379883
loss_pred:0.014977815560996532, decouple_loss:0.0005603539175353944
The modified gen p mean: 0.4471040368080139, gen p mean: -0.11638159304857254, mean p set: 0.4476804733276367
The modified gen p mean: 0.44745248556137085, gen p mean: -0.12412611395120621, mean p set: 0.44802701473236084
loss_pred:0.016028624027967453, decouple_loss:0.0005983015871606767
loss_pred:0.014052946120500565, decouple_loss:0.0004631471820175648
Iteration: 1610, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44588181376457214, gen p mean: -0.12139564752578735, mean p set: 0.446456640958786
loss_pred:0.015276034362614155, decouple_loss:0.0005946386372670531
The modified gen p mean: 0.44488412141799927, gen p mean: -0.12184213846921921, mean p set: 0.4454576373100281
loss_pred:0.015581050887703896, decouple_loss:0.0005374027532525361
The modified gen p mean: 0.44717758893966675, gen p mean: -0.11928152292966843, mean p set: 0.44775307178497314
loss_pred:0.014130091294646263, decouple_loss:0.0005968880141153932
2023-05-01 21:46:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11804329603910446, mean p set: 0.4502691626548767
loss_pred:0.017095090821385384, decouple_loss:0.0006162527715787292
The modified gen p mean: 0.44953271746635437, gen p mean: -0.11267157644033432, mean p set: 0.4500633478164673
loss_pred:0.01646389439702034, decouple_loss:0.0005475830403156579
The modified gen p mean: 0.4497823715209961, gen p mean: -0.11184663325548172, mean p set: 0.45035696029663086
loss_pred:0.016712980344891548, decouple_loss:0.0005687286611646414
WV_1_PC_1_EH_0_PS_40, loss: 0.016786199063062668, avg_mse: 0.02614247053861618
current test mse: 0.026142
Iteration: 1611, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44540703296661377, gen p mean: -0.12272454053163528, mean p set: 0.44598105549812317
loss_pred:0.01501670852303505, decouple_loss:0.0004334980621933937
The modified gen p mean: 0.4449150264263153, gen p mean: -0.1204046979546547, mean p set: 0.44549062848091125
The modified gen p mean: 0.4460132420063019, gen p mean: -0.11652801185846329, mean p set: 0.4465861916542053
loss_pred:0.014967776834964752, decouple_loss:0.0004904699744656682
loss_pred:0.015053308568894863, decouple_loss:0.0005716116284020245
Iteration: 1612, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465865194797516, gen p mean: -0.1132466271519661, mean p set: 0.44716206192970276
loss_pred:0.015693241730332375, decouple_loss:0.0007613051566295326
The modified gen p mean: 0.4471183121204376, gen p mean: -0.11840301752090454, mean p set: 0.44769522547721863The modified gen p mean: 0.4476322531700134, gen p mean: -0.11525419354438782, mean p set: 0.448209285736084
loss_pred:0.015442700125277042, decouple_loss:0.0006295550265349448
loss_pred:0.015055986121296883, decouple_loss:0.0004682239959947765
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012006_3_24hr.npz
NaN value num: 0
Iteration: 1613, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511924982070923, gen p mean: -0.09991864860057831, mean p set: 0.4517684876918793
loss_pred:0.016440298408269882, decouple_loss:0.0007867578533478081
The modified gen p mean: 0.45177406072616577, gen p mean: -0.1092514619231224, mean p set: 0.45235124230384827The modified gen p mean: 0.4507612884044647, gen p mean: -0.10822384804487228, mean p set: 0.4513408839702606
loss_pred:0.01568097434937954, decouple_loss:0.0006731306202709675
loss_pred:0.01519759465008974, decouple_loss:0.000546635186765343
Iteration: 1614, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518902897834778, gen p mean: -0.10784400254487991, mean p set: 0.45246466994285583
loss_pred:0.01519772782921791, decouple_loss:0.0006059185834601521
The modified gen p mean: 0.4513266384601593, gen p mean: -0.107182577252388, mean p set: 0.4519042372703552
loss_pred:0.015734748914837837, decouple_loss:0.0006121377809904516
The modified gen p mean: 0.45150160789489746, gen p mean: -0.10157440602779388, mean p set: 0.45207884907722473
loss_pred:0.01564277522265911, decouple_loss:0.0006071398383937776
Iteration: 1615, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45135441422462463, gen p mean: -0.10323014855384827, mean p set: 0.4519319236278534
loss_pred:0.015595470555126667, decouple_loss:0.0006443284219130874
The modified gen p mean: 0.4479086399078369, gen p mean: -0.11413082480430603, mean p set: 0.44848471879959106
loss_pred:0.015383176505565643, decouple_loss:0.0006241878145374358
The modified gen p mean: 0.45053577423095703, gen p mean: -0.10606003552675247, mean p set: 0.45111262798309326
loss_pred:0.015240299515426159, decouple_loss:0.0006785978330299258
Iteration: 1616, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503399431705475, gen p mean: -0.10610473901033401, mean p set: 0.45091530680656433
loss_pred:0.015356446616351604, decouple_loss:0.0005300471093505621
The modified gen p mean: 0.4514334797859192, gen p mean: -0.10622160136699677, mean p set: 0.4520106315612793
loss_pred:0.015379544347524643, decouple_loss:0.0005126529722474515
The modified gen p mean: 0.450615793466568, gen p mean: -0.10150820016860962, mean p set: 0.45119374990463257
loss_pred:0.015898196026682854, decouple_loss:0.0006460726726800203
Iteration: 1617, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925203919410706, gen p mean: -0.1106502115726471, mean p set: 0.4498288631439209
loss_pred:0.01602364145219326, decouple_loss:0.000622323015704751
The modified gen p mean: 0.4494192600250244, gen p mean: -0.11300332844257355, mean p set: 0.4499944746494293
loss_pred:0.015494443476200104, decouple_loss:0.0005507585592567921
The modified gen p mean: 0.44980597496032715, gen p mean: -0.10868183523416519, mean p set: 0.45038190484046936
loss_pred:0.015543335117399693, decouple_loss:0.0006024435278959572
Iteration: 1618, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489968419075012, gen p mean: -0.1112305223941803, mean p set: 0.4495699107646942
loss_pred:0.01633218675851822, decouple_loss:0.0005777058540843427
The modified gen p mean: 0.44870007038116455, gen p mean: -0.11176171153783798, mean p set: 0.44927680492401123
loss_pred:0.01720799133181572, decouple_loss:0.0005299841286614537
The modified gen p mean: 0.45000484585762024, gen p mean: -0.10541287809610367, mean p set: 0.4505823850631714
loss_pred:0.015829868614673615, decouple_loss:0.000631131581030786
Iteration: 1619, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4498851001262665, gen p mean: -0.11254856735467911, mean p set: 0.4504610598087311
loss_pred:0.015649868175387383, decouple_loss:0.0005667147925123572
The modified gen p mean: 0.4479786455631256, gen p mean: -0.1128893792629242, mean p set: 0.44855502247810364
loss_pred:0.01499397773295641, decouple_loss:0.0005927598685957491
The modified gen p mean: 0.44895243644714355, gen p mean: -0.10999605804681778, mean p set: 0.4495277404785156
loss_pred:0.015563185326755047, decouple_loss:0.0007225092267617583
Iteration: 1620, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516798257827759, gen p mean: -0.10306303948163986, mean p set: 0.4522576630115509
loss_pred:0.014922096394002438, decouple_loss:0.000580550346057862
The modified gen p mean: 0.451796293258667, gen p mean: -0.10202955454587936, mean p set: 0.4523736536502838
loss_pred:0.015858076512813568, decouple_loss:0.0006520992610603571
The modified gen p mean: 0.4492316246032715, gen p mean: -0.10442184656858444, mean p set: 0.4498084783554077
loss_pred:0.016160212457180023, decouple_loss:0.0007994907209649682
2023-05-01 21:49:46 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11445615440607071, mean p set: 0.4502691626548767
loss_pred:0.017100239172577858, decouple_loss:0.0008503397111780941
The modified gen p mean: 0.44953614473342896, gen p mean: -0.10882759839296341, mean p set: 0.4500633478164673
loss_pred:0.016571499407291412, decouple_loss:0.000998280243948102
The modified gen p mean: 0.4497818946838379, gen p mean: -0.1083168312907219, mean p set: 0.45035696029663086
loss_pred:0.016738587990403175, decouple_loss:0.0008364861714653671
WV_1_PC_1_EH_0_PS_40, loss: 0.01684819534420967, avg_mse: 0.026214703917503357
current test mse: 0.026215
Iteration: 1621, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44992005825042725, gen p mean: -0.10732381790876389, mean p set: 0.4504970610141754
loss_pred:0.015409301966428757, decouple_loss:0.000719204603228718
The modified gen p mean: 0.4510822296142578, gen p mean: -0.09920314699411392, mean p set: 0.45165911316871643
loss_pred:0.01562970131635666, decouple_loss:0.0006057887221686542
The modified gen p mean: 0.44915950298309326, gen p mean: -0.10292107611894608, mean p set: 0.4497377276420593
loss_pred:0.015594806522130966, decouple_loss:0.000590237439610064
Iteration: 1622, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45089471340179443, gen p mean: -0.10008314251899719, mean p set: 0.45147234201431274
loss_pred:0.014840945601463318, decouple_loss:0.0005686265649273992
The modified gen p mean: 0.4509594738483429, gen p mean: -0.10073990374803543, mean p set: 0.4515382945537567
The modified gen p mean: 0.45126330852508545, gen p mean: -0.09909319132566452, mean p set: 0.4518391489982605
loss_pred:0.015107741579413414, decouple_loss:0.0005344214732758701
loss_pred:0.015518507920205593, decouple_loss:0.0005337552283890545
Iteration: 1623, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503903388977051, gen p mean: -0.0956936776638031, mean p set: 0.4509679973125458
loss_pred:0.016271298751235008, decouple_loss:0.000739233277272433
The modified gen p mean: 0.4516136646270752, gen p mean: -0.09752535074949265, mean p set: 0.4521912932395935
The modified gen p mean: 0.45087873935699463, gen p mean: -0.09328306466341019, mean p set: 0.451455295085907
loss_pred:0.015507308766245842, decouple_loss:0.0006770111504010856
loss_pred:0.015493555925786495, decouple_loss:0.0006172823486849666
Iteration: 1624, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502064883708954, gen p mean: -0.09335571527481079, mean p set: 0.45078280568122864
loss_pred:0.01590823382139206, decouple_loss:0.0006298251682892442
The modified gen p mean: 0.4481784403324127, gen p mean: -0.10610195249319077, mean p set: 0.4487546980381012
loss_pred:0.015639545395970345, decouple_loss:0.0006480130250565708
The modified gen p mean: 0.4507601261138916, gen p mean: -0.09119251370429993, mean p set: 0.4513375163078308
loss_pred:0.015667129307985306, decouple_loss:0.0005276362062431872
Iteration: 1625, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512706995010376, gen p mean: -0.09762473404407501, mean p set: 0.45184803009033203
loss_pred:0.01510628405958414, decouple_loss:0.0005906943697482347
The modified gen p mean: 0.4516093134880066, gen p mean: -0.09589339047670364, mean p set: 0.45218491554260254
loss_pred:0.015504984185099602, decouple_loss:0.000500087218824774
The modified gen p mean: 0.4514603614807129, gen p mean: -0.09805617481470108, mean p set: 0.45203638076782227
loss_pred:0.01468968577682972, decouple_loss:0.00044345654896460474
Iteration: 1626, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45215514302253723, gen p mean: -0.0964595377445221, mean p set: 0.4527328312397003
loss_pred:0.015184762887656689, decouple_loss:0.0004723803431261331
The modified gen p mean: 0.44887059926986694, gen p mean: -0.10231288522481918, mean p set: 0.44944530725479126
loss_pred:0.014947294257581234, decouple_loss:0.0006335560465231538
The modified gen p mean: 0.4516075849533081, gen p mean: -0.09260958433151245, mean p set: 0.45218411087989807
loss_pred:0.015444591641426086, decouple_loss:0.0005403620307333767
Iteration: 1627, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970184564590454, gen p mean: -0.09899067133665085, mean p set: 0.45028162002563477
loss_pred:0.016098354011774063, decouple_loss:0.0005257920711301267
The modified gen p mean: 0.44790372252464294, gen p mean: -0.10363305360078812, mean p set: 0.44847941398620605
loss_pred:0.014889255166053772, decouple_loss:0.00049863156164065
The modified gen p mean: 0.45104119181632996, gen p mean: -0.09062478691339493, mean p set: 0.45161959528923035
loss_pred:0.015790071338415146, decouple_loss:0.0007142304093576968
Iteration: 1628, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492637813091278, gen p mean: -0.09825317561626434, mean p set: 0.44983968138694763
loss_pred:0.014756347984075546, decouple_loss:0.0004941227380186319
The modified gen p mean: 0.45155277848243713, gen p mean: -0.09639864414930344, mean p set: 0.4521304666996002
The modified gen p mean: 0.4494185149669647, gen p mean: -0.10311125218868256, mean p set: 0.44999441504478455
loss_pred:0.015524553135037422, decouple_loss:0.0005510765477083623
loss_pred:0.016020525246858597, decouple_loss:0.000563554756809026
Iteration: 1629, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44914209842681885, gen p mean: -0.10524144023656845, mean p set: 0.4497178792953491
loss_pred:0.015455866232514381, decouple_loss:0.0006221479852683842
The modified gen p mean: 0.45089027285575867, gen p mean: -0.09421216696500778, mean p set: 0.4514666199684143
loss_pred:0.015598616562783718, decouple_loss:0.0006894165417179465
The modified gen p mean: 0.45153966546058655, gen p mean: -0.09953878074884415, mean p set: 0.4521169364452362
loss_pred:0.014825000427663326, decouple_loss:0.0005019651143811643
Iteration: 1630, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45153847336769104, gen p mean: -0.09509678930044174, mean p set: 0.452114462852478
loss_pred:0.015565731562674046, decouple_loss:0.0005003854748792946
The modified gen p mean: 0.4509112536907196, gen p mean: -0.09695297479629517, mean p set: 0.45148730278015137
loss_pred:0.015442103147506714, decouple_loss:0.000499762361869216
The modified gen p mean: 0.45102226734161377, gen p mean: -0.0995967909693718, mean p set: 0.4515971541404724
loss_pred:0.015014498494565487, decouple_loss:0.0005751260323449969
2023-05-01 21:51:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1130688488483429, mean p set: 0.4502691626548767
loss_pred:0.017151471227407455, decouple_loss:0.0008465530117973685
The modified gen p mean: 0.4495338201522827, gen p mean: -0.10756036639213562, mean p set: 0.4500633478164673
loss_pred:0.01660924218595028, decouple_loss:0.0008606691844761372
The modified gen p mean: 0.4497801959514618, gen p mean: -0.10706459730863571, mean p set: 0.45035696029663086
loss_pred:0.016790639609098434, decouple_loss:0.0008064797730185091
WV_1_PC_1_EH_0_PS_40, loss: 0.016892345622181892, avg_mse: 0.026254937052726746
current test mse: 0.026255
Iteration: 1631, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45140212774276733, gen p mean: -0.10056131333112717, mean p set: 0.45198163390159607
loss_pred:0.015891721472144127, decouple_loss:0.0005072786007076502
The modified gen p mean: 0.44855597615242004, gen p mean: -0.10527311265468597, mean p set: 0.4491320550441742
The modified gen p mean: 0.4498753249645233, gen p mean: -0.10343372821807861, mean p set: 0.45044994354248047
loss_pred:0.015618585981428623, decouple_loss:0.0005440762033686042
loss_pred:0.014621581882238388, decouple_loss:0.0005604862235486507
Iteration: 1632, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493761360645294, gen p mean: -0.10325019806623459, mean p set: 0.449951171875
loss_pred:0.015943290665745735, decouple_loss:0.0006326552829705179
The modified gen p mean: 0.4516119360923767, gen p mean: -0.1009153500199318, mean p set: 0.4521903395652771
The modified gen p mean: 0.45088136196136475, gen p mean: -0.09653813391923904, mean p set: 0.45145851373672485
loss_pred:0.015473675914108753, decouple_loss:0.0006090096430853009
loss_pred:0.015232747420668602, decouple_loss:0.0005860769306309521
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012004_3_24hr.npz
NaN value num: 0
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1633, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44806283712387085, gen p mean: -0.10975565761327744, mean p set: 0.4486377537250519
loss_pred:0.015550111420452595, decouple_loss:0.0009373064967803657
The modified gen p mean: 0.44759702682495117, gen p mean: -0.10761433839797974, mean p set: 0.44817250967025757
The modified gen p mean: 0.4454839527606964, gen p mean: -0.10316958278417587, mean p set: 0.4460587203502655
loss_pred:0.015622653998434544, decouple_loss:0.0008508466999046504
loss_pred:0.015048177912831306, decouple_loss:0.0007140145753510296
Iteration: 1634, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476773738861084, gen p mean: -0.11141060292720795, mean p set: 0.4482541084289551
The modified gen p mean: 0.44724521040916443, gen p mean: -0.10408763587474823, mean p set: 0.44781988859176636
loss_pred:0.015687307342886925, decouple_loss:0.0006795285735279322
loss_pred:0.016159599646925926, decouple_loss:0.0005779893836006522
The modified gen p mean: 0.4472261071205139, gen p mean: -0.10712500661611557, mean p set: 0.44780153036117554
loss_pred:0.016494635492563248, decouple_loss:0.0008156230323947966
Iteration: 1635, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476272463798523, gen p mean: -0.09791591763496399, mean p set: 0.44820424914360046
loss_pred:0.015783384442329407, decouple_loss:0.0006289706798270345
The modified gen p mean: 0.44718828797340393, gen p mean: -0.09786074608564377, mean p set: 0.4477651119232178
loss_pred:0.015611614100635052, decouple_loss:0.0005367416888475418
The modified gen p mean: 0.447946161031723, gen p mean: -0.10176103562116623, mean p set: 0.44852498173713684
loss_pred:0.015614068135619164, decouple_loss:0.0006339643150568008
Iteration: 1636, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44783222675323486, gen p mean: -0.1019987240433693, mean p set: 0.44840726256370544
loss_pred:0.015460401773452759, decouple_loss:0.0006421178113669157
The modified gen p mean: 0.4472191035747528, gen p mean: -0.1076710969209671, mean p set: 0.4477926790714264
loss_pred:0.015601199120283127, decouple_loss:0.0006499547744169831
The modified gen p mean: 0.446582555770874, gen p mean: -0.10308626294136047, mean p set: 0.44715774059295654
loss_pred:0.015238406136631966, decouple_loss:0.0006178834591992199
Iteration: 1637, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44617024064064026, gen p mean: -0.10418295860290527, mean p set: 0.4467467665672302
The modified gen p mean: 0.446100115776062, gen p mean: -0.10703429579734802, mean p set: 0.44667288661003113
loss_pred:0.015179138630628586, decouple_loss:0.0006039830623194575
loss_pred:0.01517222449183464, decouple_loss:0.0004941808292642236
The modified gen p mean: 0.44853708148002625, gen p mean: -0.10498163104057312, mean p set: 0.449113667011261
loss_pred:0.015457456931471825, decouple_loss:0.0006844936870038509
Iteration: 1638, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474422335624695, gen p mean: -0.1095205619931221, mean p set: 0.4480171501636505
loss_pred:0.015727616846561432, decouple_loss:0.0008701838669367135
The modified gen p mean: 0.44818174839019775, gen p mean: -0.11577382683753967, mean p set: 0.44875964522361755
loss_pred:0.015447049401700497, decouple_loss:0.0008675142889842391
The modified gen p mean: 0.4469180405139923, gen p mean: -0.11143379658460617, mean p set: 0.4474954903125763
loss_pred:0.016197336837649345, decouple_loss:0.00068734708474949
Iteration: 1639, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470997154712677, gen p mean: -0.1160152480006218, mean p set: 0.4476746618747711
loss_pred:0.015320401638746262, decouple_loss:0.0005195848643779755
The modified gen p mean: 0.4462273120880127, gen p mean: -0.1228303387761116, mean p set: 0.4468037486076355
The modified gen p mean: 0.4480336904525757, gen p mean: -0.12020085006952286, mean p set: 0.44860827922821045
loss_pred:0.01568332314491272, decouple_loss:0.0005365637480281293
loss_pred:0.01502334326505661, decouple_loss:0.0006473317043855786
Iteration: 1640, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471838176250458, gen p mean: -0.1272629052400589, mean p set: 0.44775745272636414
loss_pred:0.015288221649825573, decouple_loss:0.0006724039558321238
The modified gen p mean: 0.44756051898002625, gen p mean: -0.12654702365398407, mean p set: 0.4481382668018341
loss_pred:0.015038314275443554, decouple_loss:0.0007343693287111819
The modified gen p mean: 0.44655731320381165, gen p mean: -0.12347186356782913, mean p set: 0.44713273644447327
loss_pred:0.015505795367062092, decouple_loss:0.0005301857017911971
2023-05-01 21:54:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1303194761276245, mean p set: 0.4502691626548767
loss_pred:0.017048098146915436, decouple_loss:0.0007018070900812745
The modified gen p mean: 0.4495353698730469, gen p mean: -0.12472796440124512, mean p set: 0.4500633478164673
loss_pred:0.016407055780291557, decouple_loss:0.0006409388734027743
The modified gen p mean: 0.4497814178466797, gen p mean: -0.12394019961357117, mean p set: 0.45035696029663086
loss_pred:0.016667760908603668, decouple_loss:0.0006174425361678004
WV_1_PC_1_EH_0_PS_40, loss: 0.016740307211875916, avg_mse: 0.026051906868815422
current test mse: 0.026052
Iteration: 1641, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44660240411758423, gen p mean: -0.12394930422306061, mean p set: 0.447177916765213
loss_pred:0.015044603496789932, decouple_loss:0.0006681845407001674
The modified gen p mean: 0.44822150468826294, gen p mean: -0.12078513950109482, mean p set: 0.4487995207309723The modified gen p mean: 0.4480014741420746, gen p mean: -0.12860701978206635, mean p set: 0.44857946038246155
loss_pred:0.015891388058662415, decouple_loss:0.0006185639067552984loss_pred:0.014840087853372097, decouple_loss:0.0006631170981563628
Iteration: 1642, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44823986291885376, gen p mean: -0.12610261142253876, mean p set: 0.4488171935081482
loss_pred:0.01511354185640812, decouple_loss:0.0005398911889642477
The modified gen p mean: 0.44707268476486206, gen p mean: -0.12181516736745834, mean p set: 0.44764673709869385The modified gen p mean: 0.44737449288368225, gen p mean: -0.12282547354698181, mean p set: 0.4479508101940155
loss_pred:0.01541902031749487, decouple_loss:0.0004940316430293024
loss_pred:0.015362297184765339, decouple_loss:0.0006873759557493031
Iteration: 1643, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447769433259964, gen p mean: -0.11901217699050903, mean p set: 0.4483456313610077
loss_pred:0.015322142280638218, decouple_loss:0.0004483087977860123
The modified gen p mean: 0.44810137152671814, gen p mean: -0.12008874863386154, mean p set: 0.4486773908138275
loss_pred:0.015043717809021473, decouple_loss:0.0005961774149909616
The modified gen p mean: 0.4465879499912262, gen p mean: -0.12180089205503464, mean p set: 0.4471621811389923
loss_pred:0.015280033461749554, decouple_loss:0.0006334125064313412
Iteration: 1644, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472433030605316, gen p mean: -0.12108837068080902, mean p set: 0.44781628251075745
The modified gen p mean: 0.44785764813423157, gen p mean: -0.12030944973230362, mean p set: 0.44843369722366333
loss_pred:0.01573611982166767, decouple_loss:0.0006177473696880043
loss_pred:0.014998763799667358, decouple_loss:0.0006264652474783361
The modified gen p mean: 0.44723448157310486, gen p mean: -0.12048075348138809, mean p set: 0.4478101134300232
loss_pred:0.015263981185853481, decouple_loss:0.0005989318597130477
Iteration: 1645, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459710121154785, gen p mean: -0.11718584597110748, mean p set: 0.4465450048446655
The modified gen p mean: 0.44735240936279297, gen p mean: -0.11271409690380096, mean p set: 0.44792816042900085
loss_pred:0.015088972635567188, decouple_loss:0.0004839751054532826
loss_pred:0.01470622606575489, decouple_loss:0.0006137845339253545
The modified gen p mean: 0.4459421932697296, gen p mean: -0.11297217756509781, mean p set: 0.44651728868484497
loss_pred:0.015122653916478157, decouple_loss:0.0005738876643590629
Iteration: 1646, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802117347717285, gen p mean: -0.11562436074018478, mean p set: 0.4485970735549927
loss_pred:0.014410385861992836, decouple_loss:0.0005109047051519156
The modified gen p mean: 0.44674795866012573, gen p mean: -0.11800537258386612, mean p set: 0.4473235309123993
loss_pred:0.015174048952758312, decouple_loss:0.0006885832990519702
The modified gen p mean: 0.447529673576355, gen p mean: -0.12224133312702179, mean p set: 0.44810402393341064
loss_pred:0.014875469729304314, decouple_loss:0.0007026014500297606
Iteration: 1647, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44772830605506897, gen p mean: -0.12364183366298676, mean p set: 0.44830334186553955
loss_pred:0.015022652223706245, decouple_loss:0.0005640403833240271
The modified gen p mean: 0.4475380480289459, gen p mean: -0.12240908294916153, mean p set: 0.44811320304870605
loss_pred:0.015047439374029636, decouple_loss:0.0006554023711942136
The modified gen p mean: 0.44855719804763794, gen p mean: -0.11648344993591309, mean p set: 0.4491317868232727
loss_pred:0.01460027415305376, decouple_loss:0.0005775236641056836
Iteration: 1648, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44724321365356445, gen p mean: -0.11649900674819946, mean p set: 0.447822630405426
loss_pred:0.014810167253017426, decouple_loss:0.00048628528020344675
The modified gen p mean: 0.44741883873939514, gen p mean: -0.11275221407413483, mean p set: 0.44799429178237915
loss_pred:0.014569582417607307, decouple_loss:0.00047043603262864053
The modified gen p mean: 0.44799649715423584, gen p mean: -0.1144503727555275, mean p set: 0.4485742151737213
loss_pred:0.015060186386108398, decouple_loss:0.0005682842456735671
Iteration: 1649, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466686546802521, gen p mean: -0.11453057825565338, mean p set: 0.447241872549057
loss_pred:0.015458377078175545, decouple_loss:0.0005159472930245101
The modified gen p mean: 0.446533203125, gen p mean: -0.11475314944982529, mean p set: 0.4471103250980377
The modified gen p mean: 0.44776949286460876, gen p mean: -0.10818493366241455, mean p set: 0.44834527373313904
loss_pred:0.01555959228426218, decouple_loss:0.0006004192982800305
loss_pred:0.015795564278960228, decouple_loss:0.0004954275791533291
Iteration: 1650, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775184988975525, gen p mean: -0.10948269814252853, mean p set: 0.44832614064216614
loss_pred:0.014300922863185406, decouple_loss:0.0005950020276941359
The modified gen p mean: 0.44796282052993774, gen p mean: -0.11054638028144836, mean p set: 0.4485393166542053
The modified gen p mean: 0.4463288187980652, gen p mean: -0.10669664293527603, mean p set: 0.4469052851200104
loss_pred:0.01445568073540926, decouple_loss:0.0005408775759860873
loss_pred:0.015043175779283047, decouple_loss:0.0005209253868088126
2023-05-01 21:57:00 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11395199596881866, mean p set: 0.4502691626548767
loss_pred:0.017106670886278152, decouple_loss:0.00048783194506540895
The modified gen p mean: 0.44953423738479614, gen p mean: -0.10823497921228409, mean p set: 0.4500633478164673
loss_pred:0.016433686017990112, decouple_loss:0.0005158840212970972
The modified gen p mean: 0.4497803747653961, gen p mean: -0.10752183198928833, mean p set: 0.45035696029663086
loss_pred:0.016733190044760704, decouple_loss:0.0005620191222988069
WV_1_PC_1_EH_0_PS_40, loss: 0.0167839452624321, avg_mse: 0.026182297617197037
current test mse: 0.026182
Iteration: 1651, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475182294845581, gen p mean: -0.10679736733436584, mean p set: 0.4480930268764496
loss_pred:0.015541575849056244, decouple_loss:0.0005100577836856246
The modified gen p mean: 0.44774484634399414, gen p mean: -0.10699812322854996, mean p set: 0.44832247495651245
The modified gen p mean: 0.44715961813926697, gen p mean: -0.11204631626605988, mean p set: 0.44773492217063904
loss_pred:0.015823867172002792, decouple_loss:0.0004901878419332206
loss_pred:0.014725995250046253, decouple_loss:0.0005039757816120982
Iteration: 1652, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478960335254669, gen p mean: -0.1137768104672432, mean p set: 0.4484725892543793
loss_pred:0.014567195437848568, decouple_loss:0.0004703523591160774
The modified gen p mean: 0.4480789601802826, gen p mean: -0.11371879279613495, mean p set: 0.4486536979675293The modified gen p mean: 0.4465957283973694, gen p mean: -0.11425027251243591, mean p set: 0.4471730887889862
loss_pred:0.014825510792434216, decouple_loss:0.0004496873007155955loss_pred:0.015252302400767803, decouple_loss:0.00045964118908159435
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012018_3_24hr.npz
NaN value num: 0
Iteration: 1653, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817647337913513, gen p mean: -0.11014465987682343, mean p set: 0.44874924421310425
loss_pred:0.016366226598620415, decouple_loss:0.0006015407852828503
The modified gen p mean: 0.4480102062225342, gen p mean: -0.11086717993021011, mean p set: 0.4485867917537689The modified gen p mean: 0.4481129050254822, gen p mean: -0.11069175601005554, mean p set: 0.44868648052215576
loss_pred:0.017174474895000458, decouple_loss:0.0004909126437269151
loss_pred:0.016478465870022774, decouple_loss:0.00045461993431672454
Iteration: 1654, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44713398814201355, gen p mean: -0.1101776733994484, mean p set: 0.44770923256874084
loss_pred:0.01731102168560028, decouple_loss:0.0005191928357817233
The modified gen p mean: 0.4477669596672058, gen p mean: -0.11153421550989151, mean p set: 0.4483422338962555
loss_pred:0.01675371639430523, decouple_loss:0.0005091456114314497
The modified gen p mean: 0.4494550824165344, gen p mean: -0.11284198611974716, mean p set: 0.4500318169593811
loss_pred:0.015912767499685287, decouple_loss:0.0005365887191146612
Iteration: 1655, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44642603397369385, gen p mean: -0.10826990008354187, mean p set: 0.44700080156326294
loss_pred:0.017179351300001144, decouple_loss:0.0006166992825455964
The modified gen p mean: 0.44928890466690063, gen p mean: -0.11433035135269165, mean p set: 0.44986119866371155
loss_pred:0.01733230985701084, decouple_loss:0.0005611107917502522
The modified gen p mean: 0.4464154541492462, gen p mean: -0.10679594427347183, mean p set: 0.4469884932041168
loss_pred:0.01718517392873764, decouple_loss:0.0006041147862561047
Iteration: 1656, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44799843430519104, gen p mean: -0.10943391919136047, mean p set: 0.4485757648944855
loss_pred:0.01641053706407547, decouple_loss:0.0006158651085570455
The modified gen p mean: 0.4479309618473053, gen p mean: -0.11029375344514847, mean p set: 0.4485064744949341
loss_pred:0.016370845958590508, decouple_loss:0.0004312266828492284
The modified gen p mean: 0.44747990369796753, gen p mean: -0.11428986489772797, mean p set: 0.44805729389190674
loss_pred:0.017405366525053978, decouple_loss:0.0004906142712570727
Iteration: 1657, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471420347690582, gen p mean: -0.10624171793460846, mean p set: 0.4477182924747467
loss_pred:0.017137793824076653, decouple_loss:0.0004290322249289602
The modified gen p mean: 0.4460415840148926, gen p mean: -0.10627772659063339, mean p set: 0.4466167390346527
loss_pred:0.017843585461378098, decouple_loss:0.0004713471862487495
The modified gen p mean: 0.44819018244743347, gen p mean: -0.11551235616207123, mean p set: 0.4487628936767578
loss_pred:0.0169898122549057, decouple_loss:0.00048638228327035904
Iteration: 1658, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475592374801636, gen p mean: -0.10695956647396088, mean p set: 0.4481366276741028
loss_pred:0.016483694314956665, decouple_loss:0.0006215149187482893
The modified gen p mean: 0.4478803277015686, gen p mean: -0.10859734565019608, mean p set: 0.44845619797706604
loss_pred:0.015800124034285545, decouple_loss:0.0005261071491986513
The modified gen p mean: 0.44666582345962524, gen p mean: -0.11071262508630753, mean p set: 0.44724079966545105
loss_pred:0.017501799389719963, decouple_loss:0.000490038248244673
Iteration: 1659, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44909295439720154, gen p mean: -0.10790282487869263, mean p set: 0.44967013597488403
loss_pred:0.016367532312870026, decouple_loss:0.0004470345447771251
The modified gen p mean: 0.4480322599411011, gen p mean: -0.10731162875890732, mean p set: 0.4486088454723358
loss_pred:0.016202503815293312, decouple_loss:0.0004297306004446
The modified gen p mean: 0.44750818610191345, gen p mean: -0.10394008457660675, mean p set: 0.44808417558670044
loss_pred:0.016774969175457954, decouple_loss:0.000523566675838083
Iteration: 1660, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44820907711982727, gen p mean: -0.1102655678987503, mean p set: 0.4487842321395874
loss_pred:0.016903357580304146, decouple_loss:0.00045371594023890793
The modified gen p mean: 0.44840386509895325, gen p mean: -0.10901312530040741, mean p set: 0.44898083806037903
loss_pred:0.016478156670928, decouple_loss:0.000456013047369197
The modified gen p mean: 0.44821199774742126, gen p mean: -0.10715390741825104, mean p set: 0.44878700375556946
loss_pred:0.016673751175403595, decouple_loss:0.0005026073777116835
2023-05-01 21:59:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11452703177928925, mean p set: 0.4502691626548767
loss_pred:0.01706819050014019, decouple_loss:0.0005751947173848748
The modified gen p mean: 0.44978269934654236, gen p mean: -0.10838163644075394, mean p set: 0.45035696029663086
loss_pred:0.01670503057539463, decouple_loss:0.000677483098115772
The modified gen p mean: 0.44953492283821106, gen p mean: -0.10901662707328796, mean p set: 0.4500633478164673
loss_pred:0.016390319913625717, decouple_loss:0.0007050182903185487
WV_1_PC_1_EH_0_PS_40, loss: 0.01675380766391754, avg_mse: 0.02610258013010025
current test mse: 0.026103
Iteration: 1661, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473845958709717, gen p mean: -0.10788829624652863, mean p set: 0.4479617476463318
loss_pred:0.01630469411611557, decouple_loss:0.0005150172510184348
The modified gen p mean: 0.4466313421726227, gen p mean: -0.10551970452070236, mean p set: 0.44720733165740967
loss_pred:0.016506703570485115, decouple_loss:0.0005953666404820979
The modified gen p mean: 0.4475271701812744, gen p mean: -0.10725899785757065, mean p set: 0.4481014907360077
loss_pred:0.016789918765425682, decouple_loss:0.0005025493446737528
Iteration: 1662, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466022849082947, gen p mean: -0.1098998412489891, mean p set: 0.4471806287765503
loss_pred:0.016735762357711792, decouple_loss:0.0004503543023020029
The modified gen p mean: 0.4491269588470459, gen p mean: -0.10449433326721191, mean p set: 0.4497016966342926The modified gen p mean: 0.44741904735565186, gen p mean: -0.10586037486791611, mean p set: 0.4479931592941284
loss_pred:0.01650015264749527, decouple_loss:0.0005180391017347574
loss_pred:0.016540005803108215, decouple_loss:0.0004858332104049623
Iteration: 1663, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44669556617736816, gen p mean: -0.10633718967437744, mean p set: 0.4472734034061432
loss_pred:0.01749589294195175, decouple_loss:0.0005468105664476752
The modified gen p mean: 0.44606631994247437, gen p mean: -0.1030069887638092, mean p set: 0.4466431736946106The modified gen p mean: 0.4472595155239105, gen p mean: -0.10601505637168884, mean p set: 0.4478370249271393
loss_pred:0.016792425885796547, decouple_loss:0.0004997278447262943
loss_pred:0.016829391941428185, decouple_loss:0.0005618279683403671
Iteration: 1664, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44877541065216064, gen p mean: -0.10596345365047455, mean p set: 0.44935378432273865
loss_pred:0.016248663887381554, decouple_loss:0.0005442024557851255
The modified gen p mean: 0.44573986530303955, gen p mean: -0.10759687423706055, mean p set: 0.44631341099739075
loss_pred:0.017512794584035873, decouple_loss:0.0005499549442902207
The modified gen p mean: 0.44744032621383667, gen p mean: -0.10850688070058823, mean p set: 0.44801533222198486
loss_pred:0.016593748703598976, decouple_loss:0.0004840670735575259
Iteration: 1665, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44614842534065247, gen p mean: -0.11043157428503036, mean p set: 0.44672608375549316
loss_pred:0.017561212182044983, decouple_loss:0.0005574132082983851
The modified gen p mean: 0.4478711187839508, gen p mean: -0.1159253716468811, mean p set: 0.4484488368034363
loss_pred:0.016266660764813423, decouple_loss:0.0005779634229838848
The modified gen p mean: 0.4487960934638977, gen p mean: -0.10681749880313873, mean p set: 0.44937095046043396
loss_pred:0.01682925783097744, decouple_loss:0.0005918187671341002
Iteration: 1666, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479725956916809, gen p mean: -0.12302449345588684, mean p set: 0.4485483467578888
loss_pred:0.01687285304069519, decouple_loss:0.0005915825604461133
The modified gen p mean: 0.44825348258018494, gen p mean: -0.11660640686750412, mean p set: 0.4488303065299988
loss_pred:0.016412897035479546, decouple_loss:0.0004930334398522973
The modified gen p mean: 0.45016607642173767, gen p mean: -0.11541202664375305, mean p set: 0.4507392346858978
loss_pred:0.015867602080106735, decouple_loss:0.00046790571650490165
Iteration: 1667, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469522535800934, gen p mean: -0.1181599497795105, mean p set: 0.4475279748439789
loss_pred:0.017336567863821983, decouple_loss:0.0005975441890768707
The modified gen p mean: 0.44763287901878357, gen p mean: -0.11931639164686203, mean p set: 0.44820740818977356
loss_pred:0.017411518841981888, decouple_loss:0.000642282422631979
The modified gen p mean: 0.4480333626270294, gen p mean: -0.11499978601932526, mean p set: 0.44860756397247314
loss_pred:0.01591169647872448, decouple_loss:0.0006653826567344368
Iteration: 1668, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479614198207855, gen p mean: -0.12719711661338806, mean p set: 0.44854092597961426
loss_pred:0.01697060465812683, decouple_loss:0.0005597664858214557
The modified gen p mean: 0.4479179084300995, gen p mean: -0.12087873369455338, mean p set: 0.44849130511283875
loss_pred:0.016205258667469025, decouple_loss:0.0006194012821651995
The modified gen p mean: 0.44848528504371643, gen p mean: -0.12104321271181107, mean p set: 0.4490620791912079
loss_pred:0.0172782763838768, decouple_loss:0.0005245064967311919
Iteration: 1669, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44701626896858215, gen p mean: -0.12520235776901245, mean p set: 0.44758954644203186
loss_pred:0.01721752993762493, decouple_loss:0.0006029505166225135
The modified gen p mean: 0.44880393147468567, gen p mean: -0.12378057837486267, mean p set: 0.4493786096572876
loss_pred:0.016050511971116066, decouple_loss:0.0004871193377766758
The modified gen p mean: 0.44815772771835327, gen p mean: -0.12400175631046295, mean p set: 0.44873231649398804
loss_pred:0.016506586223840714, decouple_loss:0.0005102775176055729
Iteration: 1670, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488942325115204, gen p mean: -0.12016614526510239, mean p set: 0.44947269558906555
loss_pred:0.016587821766734123, decouple_loss:0.0005322814104147255
The modified gen p mean: 0.4502878189086914, gen p mean: -0.12468372285366058, mean p set: 0.4508633017539978
loss_pred:0.015437507070600986, decouple_loss:0.0006417054682970047
The modified gen p mean: 0.4490003287792206, gen p mean: -0.12247756123542786, mean p set: 0.449575275182724
loss_pred:0.016492152586579323, decouple_loss:0.0005013045156374574
2023-05-01 22:01:48 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12921985983848572, mean p set: 0.4502691626548767
loss_pred:0.01707819290459156, decouple_loss:0.0005305190570652485
The modified gen p mean: 0.44953712821006775, gen p mean: -0.12374407798051834, mean p set: 0.4500633478164673
loss_pred:0.016382474452257156, decouple_loss:0.0005103184375911951
The modified gen p mean: 0.44977903366088867, gen p mean: -0.12240012735128403, mean p set: 0.45035696029663086
loss_pred:0.016599711030721664, decouple_loss:0.0005562546430155635
WV_1_PC_1_EH_0_PS_40, loss: 0.01671341061592102, avg_mse: 0.026054056361317635
current test mse: 0.026054
Iteration: 1671, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44760656356811523, gen p mean: -0.12154339998960495, mean p set: 0.4481804668903351
loss_pred:0.016056189313530922, decouple_loss:0.0005136859836056828
The modified gen p mean: 0.44712355732917786, gen p mean: -0.12226956337690353, mean p set: 0.44770026206970215The modified gen p mean: 0.4489724636077881, gen p mean: -0.12456999719142914, mean p set: 0.4495477080345154
loss_pred:0.017485763877630234, decouple_loss:0.0005026100552640855
loss_pred:0.016820406541228294, decouple_loss:0.0006017661071382463
Iteration: 1672, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44787853956222534, gen p mean: -0.12338470667600632, mean p set: 0.4484530985355377
loss_pred:0.016316240653395653, decouple_loss:0.0005025410791859031
The modified gen p mean: 0.4476809799671173, gen p mean: -0.12271832674741745, mean p set: 0.44825637340545654The modified gen p mean: 0.44721657037734985, gen p mean: -0.12253845483064651, mean p set: 0.447790265083313
loss_pred:0.016543827950954437, decouple_loss:0.0004252119979355484
loss_pred:0.016283679753541946, decouple_loss:0.0005062157288193703
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012014_3_24hr.npz
NaN value num: 0
Iteration: 1673, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44880858063697815, gen p mean: -0.11144332587718964, mean p set: 0.44938766956329346
loss_pred:0.015648128464818, decouple_loss:0.0007677670801058412
The modified gen p mean: 0.4498498737812042, gen p mean: -0.11223800480365753, mean p set: 0.4504237771034241
The modified gen p mean: 0.44885751605033875, gen p mean: -0.11716333031654358, mean p set: 0.44943416118621826
loss_pred:0.016395894810557365, decouple_loss:0.0010391705436632037
loss_pred:0.015442213043570518, decouple_loss:0.0010942226508632302
Iteration: 1674, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506939649581909, gen p mean: -0.11667855829000473, mean p set: 0.45127037167549133
loss_pred:0.01598399691283703, decouple_loss:0.0007610354223288596
The modified gen p mean: 0.4494463801383972, gen p mean: -0.11035564541816711, mean p set: 0.4500221312046051
loss_pred:0.015586215071380138, decouple_loss:0.0007332040695473552
The modified gen p mean: 0.45132747292518616, gen p mean: -0.11762604117393494, mean p set: 0.4519057869911194
loss_pred:0.01810344308614731, decouple_loss:0.000852515920996666
Iteration: 1675, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099976658821106, gen p mean: -0.11035793274641037, mean p set: 0.4515767991542816
loss_pred:0.015501485206186771, decouple_loss:0.0004991450696252286
The modified gen p mean: 0.44847095012664795, gen p mean: -0.10777939110994339, mean p set: 0.44904619455337524
loss_pred:0.017229119315743446, decouple_loss:0.0005181492888368666
The modified gen p mean: 0.4494093358516693, gen p mean: -0.10837412625551224, mean p set: 0.4499855935573578
loss_pred:0.015774322673678398, decouple_loss:0.0005012956098653376
Iteration: 1676, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502285420894623, gen p mean: -0.10664578527212143, mean p set: 0.4508056342601776
loss_pred:0.015066703781485558, decouple_loss:0.0007501913351006806
The modified gen p mean: 0.4488677978515625, gen p mean: -0.10690466314554214, mean p set: 0.4494428038597107
loss_pred:0.0160962101072073, decouple_loss:0.000615074357483536
The modified gen p mean: 0.45164844393730164, gen p mean: -0.10808766633272171, mean p set: 0.45222434401512146
loss_pred:0.015931451693177223, decouple_loss:0.0005556591204367578
Iteration: 1677, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488302171230316, gen p mean: -0.1003599464893341, mean p set: 0.44940370321273804
loss_pred:0.01647206023335457, decouple_loss:0.0005202112370170653
The modified gen p mean: 0.4491439461708069, gen p mean: -0.10990045964717865, mean p set: 0.4497230052947998
loss_pred:0.015465429052710533, decouple_loss:0.0005542727885767817
The modified gen p mean: 0.4490930438041687, gen p mean: -0.10312777012586594, mean p set: 0.44967135787010193
loss_pred:0.01651475578546524, decouple_loss:0.0006527957739308476
Iteration: 1678, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44869858026504517, gen p mean: -0.10161437839269638, mean p set: 0.4492756426334381
loss_pred:0.017250699922442436, decouple_loss:0.0006042381282895803
The modified gen p mean: 0.4509698152542114, gen p mean: -0.11033168435096741, mean p set: 0.45154598355293274
loss_pred:0.015453559346497059, decouple_loss:0.0005003963597118855
The modified gen p mean: 0.44962790608406067, gen p mean: -0.10453876852989197, mean p set: 0.45020708441734314
loss_pred:0.01686057820916176, decouple_loss:0.0007109169964678586
Iteration: 1679, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4485359489917755, gen p mean: -0.10782469063997269, mean p set: 0.4491138160228729
loss_pred:0.016054736450314522, decouple_loss:0.0005091052153147757
The modified gen p mean: 0.44879603385925293, gen p mean: -0.10466313362121582, mean p set: 0.44937264919281006
loss_pred:0.01669314317405224, decouple_loss:0.0007530067232437432
The modified gen p mean: 0.45014387369155884, gen p mean: -0.10678409039974213, mean p set: 0.45072001218795776
loss_pred:0.016377918422222137, decouple_loss:0.0007231367053464055
Iteration: 1680, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503112733364105, gen p mean: -0.11445189267396927, mean p set: 0.450888991355896
loss_pred:0.015653982758522034, decouple_loss:0.0006034105899743736
The modified gen p mean: 0.4503329396247864, gen p mean: -0.11173618584871292, mean p set: 0.45091089606285095
loss_pred:0.015575705096125603, decouple_loss:0.0006478840368799865
The modified gen p mean: 0.4502325654029846, gen p mean: -0.11440368741750717, mean p set: 0.45080891251564026
loss_pred:0.016680153086781502, decouple_loss:0.0006423972663469613
2023-05-01 22:04:31 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11945711821317673, mean p set: 0.4502691626548767
loss_pred:0.017116624861955643, decouple_loss:0.0007907054969109595
The modified gen p mean: 0.44953691959381104, gen p mean: -0.11397842317819595, mean p set: 0.4500633478164673
loss_pred:0.016473446041345596, decouple_loss:0.0006186022073961794
The modified gen p mean: 0.44978028535842896, gen p mean: -0.11260483413934708, mean p set: 0.45035696029663086
loss_pred:0.016800254583358765, decouple_loss:0.0006465897895395756
WV_1_PC_1_EH_0_PS_40, loss: 0.016831040382385254, avg_mse: 0.026163600385189056
current test mse: 0.026164
Iteration: 1681, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44774773716926575, gen p mean: -0.10564938932657242, mean p set: 0.4483225345611572
loss_pred:0.01635720208287239, decouple_loss:0.0007112555322237313
The modified gen p mean: 0.44936105608940125, gen p mean: -0.10787053406238556, mean p set: 0.44993579387664795The modified gen p mean: 0.44954362511634827, gen p mean: -0.11093535274267197, mean p set: 0.45011985301971436
loss_pred:0.01552848145365715, decouple_loss:0.0005814448813907802
loss_pred:0.01536548137664795, decouple_loss:0.0007145398412831128
Iteration: 1682, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450361967086792, gen p mean: -0.1090797707438469, mean p set: 0.4509376883506775
loss_pred:0.015463939867913723, decouple_loss:0.000699514988809824
The modified gen p mean: 0.4493829011917114, gen p mean: -0.10753381997346878, mean p set: 0.4499596655368805The modified gen p mean: 0.4491376280784607, gen p mean: -0.0998736172914505, mean p set: 0.44971367716789246
loss_pred:0.015502896159887314, decouple_loss:0.0005419456283561885
loss_pred:0.016738232225179672, decouple_loss:0.0005250234389677644
Iteration: 1683, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494664967060089, gen p mean: -0.10585194826126099, mean p set: 0.4500446021556854
loss_pred:0.01617375575006008, decouple_loss:0.0006325743743218482
The modified gen p mean: 0.4501769542694092, gen p mean: -0.09956032782793045, mean p set: 0.45075252652168274
loss_pred:0.01599450781941414, decouple_loss:0.0005763133522123098
The modified gen p mean: 0.45022106170654297, gen p mean: -0.10209615528583527, mean p set: 0.45079630613327026
loss_pred:0.015940841287374496, decouple_loss:0.0005733529687859118
Iteration: 1684, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477912485599518, gen p mean: -0.10053828358650208, mean p set: 0.4483667314052582
loss_pred:0.016167838126420975, decouple_loss:0.0005593718378804624
The modified gen p mean: 0.44771623611450195, gen p mean: -0.1077030599117279, mean p set: 0.44829264283180237
loss_pred:0.01581289805471897, decouple_loss:0.0007013026624917984
The modified gen p mean: 0.4493831694126129, gen p mean: -0.10677562654018402, mean p set: 0.4499594569206238
loss_pred:0.015389623120427132, decouple_loss:0.000604626489803195
Iteration: 1685, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44771912693977356, gen p mean: -0.11179035156965256, mean p set: 0.44829609990119934
loss_pred:0.01635131798684597, decouple_loss:0.0005651719984598458
The modified gen p mean: 0.4497438371181488, gen p mean: -0.10961203277111053, mean p set: 0.45031946897506714
loss_pred:0.01646542362868786, decouple_loss:0.0005616082344204187
The modified gen p mean: 0.44769784808158875, gen p mean: -0.10671024769544601, mean p set: 0.4482741951942444
loss_pred:0.016093336045742035, decouple_loss:0.0006702521350234747
Iteration: 1686, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481457769870758, gen p mean: -0.10662201046943665, mean p set: 0.4487208127975464
loss_pred:0.01588190160691738, decouple_loss:0.0007777878199703991
The modified gen p mean: 0.4489056468009949, gen p mean: -0.10871142894029617, mean p set: 0.44948288798332214
The modified gen p mean: 0.45207151770591736, gen p mean: -0.10626699030399323, mean p set: 0.4526497423648834
loss_pred:0.015370774082839489, decouple_loss:0.0007751000230200589
loss_pred:0.01581384800374508, decouple_loss:0.0006219534552656114
Iteration: 1687, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472852647304535, gen p mean: -0.11242389678955078, mean p set: 0.4478597342967987
loss_pred:0.016400599852204323, decouple_loss:0.0004956474294885993
The modified gen p mean: 0.4472598433494568, gen p mean: -0.10984236001968384, mean p set: 0.4478350281715393
loss_pred:0.015980934724211693, decouple_loss:0.0005211719544604421
The modified gen p mean: 0.45053455233573914, gen p mean: -0.10789647698402405, mean p set: 0.451111376285553
loss_pred:0.015261284075677395, decouple_loss:0.000611974042840302
Iteration: 1688, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510166347026825, gen p mean: -0.10817302018404007, mean p set: 0.4515925347805023
loss_pred:0.015175776556134224, decouple_loss:0.00043860793812200427
The modified gen p mean: 0.450143963098526, gen p mean: -0.10531827062368393, mean p set: 0.4507228434085846
loss_pred:0.015593577176332474, decouple_loss:0.0006822898867540061
The modified gen p mean: 0.4480670690536499, gen p mean: -0.10729453712701797, mean p set: 0.4486435651779175
loss_pred:0.015354379080235958, decouple_loss:0.0004917436745017767
Iteration: 1689, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475456178188324, gen p mean: -0.10603222250938416, mean p set: 0.44812071323394775
The modified gen p mean: 0.4503850042819977, gen p mean: -0.10358516871929169, mean p set: 0.4509623348712921
loss_pred:0.015766598284244537, decouple_loss:0.000694710819516331
loss_pred:0.016333943232893944, decouple_loss:0.0005572309019044042
The modified gen p mean: 0.4484430253505707, gen p mean: -0.10443533957004547, mean p set: 0.44901934266090393
loss_pred:0.015743698924779892, decouple_loss:0.0004156918148510158
Iteration: 1690, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472641050815582, gen p mean: -0.10370589792728424, mean p set: 0.44784078001976013
loss_pred:0.015612543560564518, decouple_loss:0.0008828590507619083
The modified gen p mean: 0.4496731758117676, gen p mean: -0.10111077129840851, mean p set: 0.4502522349357605
loss_pred:0.015384375117719173, decouple_loss:0.0006626436370424926
The modified gen p mean: 0.4514508843421936, gen p mean: -0.10284781455993652, mean p set: 0.45202508568763733
loss_pred:0.01825396530330181, decouple_loss:0.0006291004247032106
2023-05-01 22:06:39 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11344430595636368, mean p set: 0.4502691626548767
loss_pred:0.01715782843530178, decouple_loss:0.0006860040011815727
The modified gen p mean: 0.44953635334968567, gen p mean: -0.10753055661916733, mean p set: 0.4500633478164673
loss_pred:0.016487499698996544, decouple_loss:0.0007282618898898363
The modified gen p mean: 0.4497813582420349, gen p mean: -0.1063196137547493, mean p set: 0.45035696029663086
loss_pred:0.016727173700928688, decouple_loss:0.0007750779041089118
WV_1_PC_1_EH_0_PS_40, loss: 0.01682732254266739, avg_mse: 0.02615388296544552
current test mse: 0.026154
Iteration: 1691, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836896657943726, gen p mean: -0.10099224746227264, mean p set: 0.4489456117153168
loss_pred:0.015279427170753479, decouple_loss:0.00048518655239604414
The modified gen p mean: 0.4507352113723755, gen p mean: -0.09970735013484955, mean p set: 0.45131269097328186
loss_pred:0.015093003399670124, decouple_loss:0.0005836155614815652
The modified gen p mean: 0.4510340094566345, gen p mean: -0.10414303094148636, mean p set: 0.45161086320877075
loss_pred:0.01595195010304451, decouple_loss:0.0005625293124467134
Iteration: 1692, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490375220775604, gen p mean: -0.09419211745262146, mean p set: 0.4496145248413086
loss_pred:0.01693686656653881, decouple_loss:0.00045995824621059
The modified gen p mean: 0.4507562816143036, gen p mean: -0.10174516588449478, mean p set: 0.4513324499130249The modified gen p mean: 0.4498424530029297, gen p mean: -0.10655596852302551, mean p set: 0.45041805505752563
loss_pred:0.01554516889154911, decouple_loss:0.0006399596459232271
loss_pred:0.015099710784852505, decouple_loss:0.0004778209840878844
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012003_3_24hr.npz
NaN value num: 0
Iteration: 1693, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491380453109741, gen p mean: -0.10317412763834, mean p set: 0.4497148096561432
loss_pred:0.015713660046458244, decouple_loss:0.0006745451246388257
The modified gen p mean: 0.44963201880455017, gen p mean: -0.10930603742599487, mean p set: 0.45020797848701477
The modified gen p mean: 0.4484633803367615, gen p mean: -0.1079624742269516, mean p set: 0.44903984665870667
loss_pred:0.016412358731031418, decouple_loss:0.0006228925194591284
loss_pred:0.01617737114429474, decouple_loss:0.0006798701942898333
Iteration: 1694, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526205062866211, gen p mean: -0.10126406699419022, mean p set: 0.4531964957714081
loss_pred:0.015958456322550774, decouple_loss:0.0005496356752701104
The modified gen p mean: 0.45049363374710083, gen p mean: -0.10903402417898178, mean p set: 0.4510722756385803
loss_pred:0.015302781946957111, decouple_loss:0.0006606165552511811
The modified gen p mean: 0.4502111077308655, gen p mean: -0.10396169126033783, mean p set: 0.4507887363433838
loss_pred:0.01511596329510212, decouple_loss:0.0005736958119086921
Iteration: 1695, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45109331607818604, gen p mean: -0.11282289773225784, mean p set: 0.4516725242137909
loss_pred:0.016360005363821983, decouple_loss:0.0007800186867825687
The modified gen p mean: 0.4500282108783722, gen p mean: -0.11690093576908112, mean p set: 0.4506070911884308
loss_pred:0.016466384753584862, decouple_loss:0.0007098874775692821
The modified gen p mean: 0.44966772198677063, gen p mean: -0.11343467980623245, mean p set: 0.4502440094947815
loss_pred:0.016819989308714867, decouple_loss:0.0007620177930220962
Iteration: 1696, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505127966403961, gen p mean: -0.10899468511343002, mean p set: 0.4510878920555115
loss_pred:0.016466371715068817, decouple_loss:0.0006510799867101014
The modified gen p mean: 0.4494411051273346, gen p mean: -0.10428941994905472, mean p set: 0.4500192403793335
The modified gen p mean: 0.44974103569984436, gen p mean: -0.10745615512132645, mean p set: 0.45031604170799255
loss_pred:0.01582529954612255, decouple_loss:0.0006571121630258858
loss_pred:0.015959490090608597, decouple_loss:0.0007673289510421455
Iteration: 1697, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44907471537590027, gen p mean: -0.10951108485460281, mean p set: 0.4496527314186096
loss_pred:0.016169602051377296, decouple_loss:0.0006216922192834318
The modified gen p mean: 0.4526410400867462, gen p mean: -0.10839458554983139, mean p set: 0.4532198905944824
loss_pred:0.016115780919790268, decouple_loss:0.0006809568731114268
The modified gen p mean: 0.44880762696266174, gen p mean: -0.11645374447107315, mean p set: 0.4493838846683502
loss_pred:0.01643947884440422, decouple_loss:0.0005296598537825048
Iteration: 1698, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971194863319397, gen p mean: -0.10782648622989655, mean p set: 0.45028528571128845
loss_pred:0.015106463804841042, decouple_loss:0.000704259320627898
The modified gen p mean: 0.4497184455394745, gen p mean: -0.1126665398478508, mean p set: 0.4502916932106018
The modified gen p mean: 0.44987958669662476, gen p mean: -0.1078697144985199, mean p set: 0.45045459270477295
loss_pred:0.016458552330732346, decouple_loss:0.0006731112953275442
loss_pred:0.015006027184426785, decouple_loss:0.0007292669033631682
Iteration: 1699, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45152705907821655, gen p mean: -0.10988254100084305, mean p set: 0.4521060883998871
loss_pred:0.015759924426674843, decouple_loss:0.0007371979882009327
The modified gen p mean: 0.4529031813144684, gen p mean: -0.10653839260339737, mean p set: 0.4534813165664673
loss_pred:0.0163099467754364, decouple_loss:0.000634982658084482
The modified gen p mean: 0.45029765367507935, gen p mean: -0.10576532036066055, mean p set: 0.45087239146232605
loss_pred:0.01586676947772503, decouple_loss:0.0006036102422513068
Iteration: 1700, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496270716190338, gen p mean: -0.10885592550039291, mean p set: 0.45020267367362976
loss_pred:0.016412915661931038, decouple_loss:0.0006263373652473092
The modified gen p mean: 0.45133110880851746, gen p mean: -0.11012191325426102, mean p set: 0.451905757188797
loss_pred:0.015238890424370766, decouple_loss:0.0006122645572759211
The modified gen p mean: 0.45060768723487854, gen p mean: -0.10556494444608688, mean p set: 0.4511836767196655
loss_pred:0.016829514876008034, decouple_loss:0.000740408489946276
2023-05-01 22:09:33 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12213296443223953, mean p set: 0.4502691626548767
loss_pred:0.017298700287938118, decouple_loss:0.0006456404807977378
The modified gen p mean: 0.44953370094299316, gen p mean: -0.11590369790792465, mean p set: 0.4500633478164673
loss_pred:0.016655683517456055, decouple_loss:0.0005975094391033053
The modified gen p mean: 0.4497796297073364, gen p mean: -0.11495044827461243, mean p set: 0.45035696029663086
loss_pred:0.01680668443441391, decouple_loss:0.000576328719034791
WV_1_PC_1_EH_0_PS_40, loss: 0.016950681805610657, avg_mse: 0.026308484375476837
current test mse: 0.026308
Iteration: 1701, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44836872816085815, gen p mean: -0.11818813532590866, mean p set: 0.44894298911094666
loss_pred:0.015129952691495419, decouple_loss:0.0006153717986308038
The modified gen p mean: 0.4525544345378876, gen p mean: -0.10621368885040283, mean p set: 0.4531312584877014The modified gen p mean: 0.44999122619628906, gen p mean: -0.10898018628358841, mean p set: 0.4505661725997925
loss_pred:0.015984170138835907, decouple_loss:0.0006618633051402867
loss_pred:0.0149680245667696, decouple_loss:0.0004918865743093193
Iteration: 1702, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45116740465164185, gen p mean: -0.11196877062320709, mean p set: 0.4517436623573303
loss_pred:0.016058407723903656, decouple_loss:0.0006087260553613305
The modified gen p mean: 0.44943851232528687, gen p mean: -0.10801500827074051, mean p set: 0.4500143229961395The modified gen p mean: 0.4495900869369507, gen p mean: -0.1132260113954544, mean p set: 0.45016786456108093
loss_pred:0.01564052514731884, decouple_loss:0.0006823513540439308
loss_pred:0.015920501202344894, decouple_loss:0.0006992294220253825
Iteration: 1703, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527273178100586, gen p mean: -0.10743074119091034, mean p set: 0.45330190658569336
loss_pred:0.01542179100215435, decouple_loss:0.000893475313205272
The modified gen p mean: 0.44867220520973206, gen p mean: -0.11605019867420197, mean p set: 0.44924721121788025
loss_pred:0.014988008886575699, decouple_loss:0.00046662669046781957
The modified gen p mean: 0.45161911845207214, gen p mean: -0.10862486064434052, mean p set: 0.45219725370407104
loss_pred:0.015127051621675491, decouple_loss:0.0007038592011667788
Iteration: 1704, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44998010993003845, gen p mean: -0.11309874057769775, mean p set: 0.4505581855773926
loss_pred:0.015794001519680023, decouple_loss:0.0005230227252468467
The modified gen p mean: 0.449243426322937, gen p mean: -0.12020881474018097, mean p set: 0.44981902837753296
loss_pred:0.015484155155718327, decouple_loss:0.0006026144837960601
The modified gen p mean: 0.4522571563720703, gen p mean: -0.11155830323696136, mean p set: 0.4528343677520752
loss_pred:0.015389624983072281, decouple_loss:0.0005695536965504289
Iteration: 1705, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501202702522278, gen p mean: -0.1150735542178154, mean p set: 0.450695663690567
loss_pred:0.015570899471640587, decouple_loss:0.0006601499626412988
The modified gen p mean: 0.44959214329719543, gen p mean: -0.11047246307134628, mean p set: 0.4501686692237854
loss_pred:0.015595972537994385, decouple_loss:0.0006067377980798483
The modified gen p mean: 0.4514572024345398, gen p mean: -0.1143123209476471, mean p set: 0.4520338773727417
loss_pred:0.015592376701533794, decouple_loss:0.0005196077399887145
Iteration: 1706, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45207515358924866, gen p mean: -0.11269090324640274, mean p set: 0.45265257358551025
loss_pred:0.01551016978919506, decouple_loss:0.00057634012773633
The modified gen p mean: 0.4530666172504425, gen p mean: -0.11225003749132156, mean p set: 0.45364704728126526
loss_pred:0.015443201176822186, decouple_loss:0.000607338675763458
The modified gen p mean: 0.4529484212398529, gen p mean: -0.11444266885519028, mean p set: 0.45352625846862793
loss_pred:0.015474551357328892, decouple_loss:0.0007207489106804132
Iteration: 1707, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503915309906006, gen p mean: -0.12047392874956131, mean p set: 0.45096808671951294
loss_pred:0.014806872233748436, decouple_loss:0.0006232435698620975
The modified gen p mean: 0.45012471079826355, gen p mean: -0.11491020023822784, mean p set: 0.4507025480270386
loss_pred:0.01600523479282856, decouple_loss:0.0005920383846387267
The modified gen p mean: 0.45003825426101685, gen p mean: -0.11405780911445618, mean p set: 0.45061424374580383
loss_pred:0.015416747890412807, decouple_loss:0.0006186813116073608
Iteration: 1708, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471662938594818, gen p mean: -0.1232583299279213, mean p set: 0.4477446675300598
loss_pred:0.015023668296635151, decouple_loss:0.0006419004057534039
The modified gen p mean: 0.4524674117565155, gen p mean: -0.11367233097553253, mean p set: 0.45304545760154724
The modified gen p mean: 0.4494059085845947, gen p mean: -0.11404187232255936, mean p set: 0.4499790072441101
loss_pred:0.015447708778083324, decouple_loss:0.0007992915343493223
loss_pred:0.015675421804189682, decouple_loss:0.000560190761461854
Iteration: 1709, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44982877373695374, gen p mean: -0.10502426326274872, mean p set: 0.45040273666381836
loss_pred:0.015319520607590675, decouple_loss:0.0006438983837142587
The modified gen p mean: 0.44883009791374207, gen p mean: -0.11796458065509796, mean p set: 0.4494048058986664
loss_pred:0.01457330584526062, decouple_loss:0.0005640664021484554
The modified gen p mean: 0.449749231338501, gen p mean: -0.10907316207885742, mean p set: 0.45032599568367004
loss_pred:0.015150600112974644, decouple_loss:0.0005323808290995657
Iteration: 1710, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44925081729888916, gen p mean: -0.10745801776647568, mean p set: 0.44982537627220154
loss_pred:0.016002897173166275, decouple_loss:0.000552289595361799
The modified gen p mean: 0.4490891993045807, gen p mean: -0.10912971198558807, mean p set: 0.44966429471969604
loss_pred:0.01587502844631672, decouple_loss:0.0006948376540094614
The modified gen p mean: 0.4534820020198822, gen p mean: -0.10758602619171143, mean p set: 0.45406150817871094
loss_pred:0.014933538623154163, decouple_loss:0.0006928292568773031
2023-05-01 22:11:41 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12312325835227966, mean p set: 0.4502691626548767
loss_pred:0.017266439273953438, decouple_loss:0.0006912103272043169
The modified gen p mean: 0.44953370094299316, gen p mean: -0.11690598726272583, mean p set: 0.4500633478164673
loss_pred:0.016569338738918304, decouple_loss:0.0006708153523504734
The modified gen p mean: 0.44978177547454834, gen p mean: -0.11633997410535812, mean p set: 0.45035696029663086
loss_pred:0.016732750460505486, decouple_loss:0.0006120822508819401
WV_1_PC_1_EH_0_PS_40, loss: 0.01688907854259014, avg_mse: 0.026303233578801155
current test mse: 0.026303
Iteration: 1711, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44975754618644714, gen p mean: -0.11327800154685974, mean p set: 0.4503326416015625
loss_pred:0.01646069437265396, decouple_loss:0.0006308185402303934
The modified gen p mean: 0.44859543442726135, gen p mean: -0.11576494574546814, mean p set: 0.44917213916778564
loss_pred:0.01477766502648592, decouple_loss:0.0006274268380366266
The modified gen p mean: 0.45288482308387756, gen p mean: -0.10624909400939941, mean p set: 0.4534589648246765
loss_pred:0.015480570495128632, decouple_loss:0.0007434636354446411
Iteration: 1712, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44863688945770264, gen p mean: -0.11519201099872589, mean p set: 0.44921332597732544
loss_pred:0.01567269302904606, decouple_loss:0.0006053433753550053
The modified gen p mean: 0.44874417781829834, gen p mean: -0.11595027893781662, mean p set: 0.4493206739425659The modified gen p mean: 0.44960489869117737, gen p mean: -0.111582912504673, mean p set: 0.45018163323402405
loss_pred:0.0148925157263875, decouple_loss:0.0004685799067374319
loss_pred:0.015458702109754086, decouple_loss:0.0006697849603369832
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012001_3_24hr.npz
NaN value num: 0
Iteration: 1713, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489805996417999, gen p mean: -0.1133086085319519, mean p set: 0.4495590925216675
loss_pred:0.01579553447663784, decouple_loss:0.0007618633098900318
The modified gen p mean: 0.44906583428382874, gen p mean: -0.1154760867357254, mean p set: 0.4496413767337799
loss_pred:0.015700483694672585, decouple_loss:0.0007033837027847767
The modified gen p mean: 0.45008546113967896, gen p mean: -0.11286452412605286, mean p set: 0.45066389441490173
loss_pred:0.015762723982334137, decouple_loss:0.0008024335256777704
Iteration: 1714, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450809121131897, gen p mean: -0.11118154227733612, mean p set: 0.4513837993144989
loss_pred:0.015165953896939754, decouple_loss:0.0006529958918690681
The modified gen p mean: 0.45013758540153503, gen p mean: -0.10850600898265839, mean p set: 0.450714111328125
loss_pred:0.014869457110762596, decouple_loss:0.0007199375540949404
The modified gen p mean: 0.4504408538341522, gen p mean: -0.10980990529060364, mean p set: 0.451019287109375
loss_pred:0.015053456649184227, decouple_loss:0.0007242626743391156
Iteration: 1715, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44758132100105286, gen p mean: -0.11119583249092102, mean p set: 0.44815847277641296
loss_pred:0.014927207492291927, decouple_loss:0.0005709605757147074
The modified gen p mean: 0.44755440950393677, gen p mean: -0.11591944098472595, mean p set: 0.4481312930583954
loss_pred:0.015115087851881981, decouple_loss:0.0005535283708013594
The modified gen p mean: 0.44747433066368103, gen p mean: -0.11400959640741348, mean p set: 0.4480490982532501
loss_pred:0.0153556689620018, decouple_loss:0.0008527716854587197
Iteration: 1716, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496522545814514, gen p mean: -0.10662546008825302, mean p set: 0.4502274990081787
loss_pred:0.014651328325271606, decouple_loss:0.0005917202797718346
The modified gen p mean: 0.45019155740737915, gen p mean: -0.10782941430807114, mean p set: 0.4507685601711273
The modified gen p mean: 0.4502895772457123, gen p mean: -0.10421187430620193, mean p set: 0.45086413621902466
loss_pred:0.015101066790521145, decouple_loss:0.0007024223450571299
loss_pred:0.01482860092073679, decouple_loss:0.0005305269150994718
Iteration: 1717, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495113492012024, gen p mean: -0.10738207399845123, mean p set: 0.45008742809295654
loss_pred:0.015121596865355968, decouple_loss:0.0006702050450257957
The modified gen p mean: 0.44873151183128357, gen p mean: -0.10509523749351501, mean p set: 0.44930723309516907
loss_pred:0.015372060239315033, decouple_loss:0.0006101003964431584
The modified gen p mean: 0.4479886591434479, gen p mean: -0.1093313992023468, mean p set: 0.4485662281513214
loss_pred:0.015065658837556839, decouple_loss:0.000673022004775703
Iteration: 1718, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449968546628952, gen p mean: -0.10302881896495819, mean p set: 0.45054522156715393
loss_pred:0.01592782884836197, decouple_loss:0.0007588799926452339
The modified gen p mean: 0.4499172270298004, gen p mean: -0.108791284263134, mean p set: 0.45049232244491577
loss_pred:0.014720081351697445, decouple_loss:0.0006830898346379399
The modified gen p mean: 0.4504294991493225, gen p mean: -0.1075684130191803, mean p set: 0.45100489258766174
loss_pred:0.014796195551753044, decouple_loss:0.0008110603666864336
Iteration: 1719, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449192613363266, gen p mean: -0.1067381501197815, mean p set: 0.4497711658477783
loss_pred:0.01586228609085083, decouple_loss:0.0006211681175045669
The modified gen p mean: 0.44722700119018555, gen p mean: -0.11173821240663528, mean p set: 0.44780364632606506
loss_pred:0.01549894642084837, decouple_loss:0.0005296769668348134
The modified gen p mean: 0.4500851333141327, gen p mean: -0.10793232172727585, mean p set: 0.4506619870662689
loss_pred:0.01525882352143526, decouple_loss:0.0006629994022659957
Iteration: 1720, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449477881193161, gen p mean: -0.11380138248205185, mean p set: 0.4500511884689331
loss_pred:0.015409690327942371, decouple_loss:0.0008198608411476016
The modified gen p mean: 0.44963669776916504, gen p mean: -0.1112048551440239, mean p set: 0.45021358132362366
The modified gen p mean: 0.447415292263031, gen p mean: -0.11013076454401016, mean p set: 0.4479900598526001
loss_pred:0.014564411714673042, decouple_loss:0.0008189557702280581
loss_pred:0.016006076708436012, decouple_loss:0.0005622442695312202
2023-05-01 22:14:25 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12347408384084702, mean p set: 0.4502691626548767
loss_pred:0.017172427847981453, decouple_loss:0.0007254522060975432
The modified gen p mean: 0.44953301548957825, gen p mean: -0.11802811920642853, mean p set: 0.4500633478164673
loss_pred:0.016583222895860672, decouple_loss:0.000979242380708456
The modified gen p mean: 0.4497799277305603, gen p mean: -0.11728203296661377, mean p set: 0.45035696029663086
loss_pred:0.016905780881643295, decouple_loss:0.0007794059347361326
WV_1_PC_1_EH_0_PS_40, loss: 0.016928546130657196, avg_mse: 0.02631611004471779
current test mse: 0.026316
Iteration: 1721, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474186599254608, gen p mean: -0.11221595108509064, mean p set: 0.44799432158470154
loss_pred:0.014901787973940372, decouple_loss:0.0007473837467841804
The modified gen p mean: 0.450115829706192, gen p mean: -0.1141594722867012, mean p set: 0.45069149136543274The modified gen p mean: 0.45024406909942627, gen p mean: -0.1174577921628952, mean p set: 0.450818806886673
loss_pred:0.015307876281440258, decouple_loss:0.0006351282354444265
loss_pred:0.01575254648923874, decouple_loss:0.0006860675057396293
Iteration: 1722, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478703737258911, gen p mean: -0.11426009237766266, mean p set: 0.4484463632106781
loss_pred:0.01471774559468031, decouple_loss:0.0005199695006012917
The modified gen p mean: 0.4491260349750519, gen p mean: -0.11169160157442093, mean p set: 0.4497006833553314The modified gen p mean: 0.4496431350708008, gen p mean: -0.10709245502948761, mean p set: 0.4502197206020355
loss_pred:0.015829144045710564, decouple_loss:0.0006694181356579065
loss_pred:0.016036568209528923, decouple_loss:0.0006541836773976684
Iteration: 1723, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4481431543827057, gen p mean: -0.11615190654993057, mean p set: 0.44871723651885986
loss_pred:0.015098923817276955, decouple_loss:0.0005857680225744843
The modified gen p mean: 0.4477388858795166, gen p mean: -0.1095799058675766, mean p set: 0.44831526279449463
loss_pred:0.015487291850149632, decouple_loss:0.0006003840826451778
The modified gen p mean: 0.45002904534339905, gen p mean: -0.11122506111860275, mean p set: 0.4506039321422577
loss_pred:0.015298200771212578, decouple_loss:0.0005899912212044001
Iteration: 1724, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44732311367988586, gen p mean: -0.11525925993919373, mean p set: 0.44790026545524597
loss_pred:0.016166817396879196, decouple_loss:0.0005537162069231272
The modified gen p mean: 0.4472391605377197, gen p mean: -0.1096678227186203, mean p set: 0.44781580567359924
loss_pred:0.015370285138487816, decouple_loss:0.0007740925648249686
The modified gen p mean: 0.44983214139938354, gen p mean: -0.11382752656936646, mean p set: 0.4504070580005646
loss_pred:0.015361051075160503, decouple_loss:0.0006822891882620752
Iteration: 1725, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45113280415534973, gen p mean: -0.11338246613740921, mean p set: 0.4517087936401367
loss_pred:0.015557163394987583, decouple_loss:0.0005450448952615261
The modified gen p mean: 0.4487093687057495, gen p mean: -0.11024805158376694, mean p set: 0.4492831230163574
loss_pred:0.01503471564501524, decouple_loss:0.0006913093966431916
The modified gen p mean: 0.44783976674079895, gen p mean: -0.11069511622190475, mean p set: 0.4484158456325531
loss_pred:0.015040412545204163, decouple_loss:0.0005468496237881482
Iteration: 1726, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504382610321045, gen p mean: -0.10606065392494202, mean p set: 0.45101693272590637
loss_pred:0.014745805412530899, decouple_loss:0.0006725998828187585
The modified gen p mean: 0.4501248598098755, gen p mean: -0.10599293559789658, mean p set: 0.45069950819015503
loss_pred:0.014649638906121254, decouple_loss:0.0005789134302176535
The modified gen p mean: 0.45090898871421814, gen p mean: -0.10989948362112045, mean p set: 0.45148739218711853
loss_pred:0.015524148009717464, decouple_loss:0.0005793548189103603
Iteration: 1727, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474959075450897, gen p mean: -0.11184593290090561, mean p set: 0.4480723738670349
loss_pred:0.015105764381587505, decouple_loss:0.00043415071559138596
The modified gen p mean: 0.4474215507507324, gen p mean: -0.1112205758690834, mean p set: 0.44799768924713135
loss_pred:0.01546613872051239, decouple_loss:0.0004998465301468968
The modified gen p mean: 0.45023369789123535, gen p mean: -0.10840313136577606, mean p set: 0.45080679655075073
loss_pred:0.015589041635394096, decouple_loss:0.0006801511044614017
Iteration: 1728, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44780784845352173, gen p mean: -0.10376960039138794, mean p set: 0.448382169008255
loss_pred:0.015456432476639748, decouple_loss:0.0005769059062004089
The modified gen p mean: 0.4492852985858917, gen p mean: -0.1051403358578682, mean p set: 0.4498618245124817
The modified gen p mean: 0.45013776421546936, gen p mean: -0.11060798913240433, mean p set: 0.4507170021533966
loss_pred:0.014956815168261528, decouple_loss:0.0007417285814881325
loss_pred:0.015073795802891254, decouple_loss:0.000660078483633697
Iteration: 1729, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44759058952331543, gen p mean: -0.10649727284908295, mean p set: 0.44816699624061584
loss_pred:0.015080704353749752, decouple_loss:0.0005473548662848771
The modified gen p mean: 0.4479690492153168, gen p mean: -0.10791603475809097, mean p set: 0.4485446512699127
loss_pred:0.014805660583078861, decouple_loss:0.0007024445221759379
The modified gen p mean: 0.44810768961906433, gen p mean: -0.11321142315864563, mean p set: 0.44868484139442444
loss_pred:0.014809878543019295, decouple_loss:0.0006085083587095141
Iteration: 1730, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024582743644714, gen p mean: -0.11328820884227753, mean p set: 0.4508250057697296
loss_pred:0.015379054471850395, decouple_loss:0.0005573785165324807
The modified gen p mean: 0.44853928685188293, gen p mean: -0.10866409540176392, mean p set: 0.44911646842956543
The modified gen p mean: 0.44769495725631714, gen p mean: -0.11016031354665756, mean p set: 0.44827190041542053
loss_pred:0.015078297816216946, decouple_loss:0.0005421667010523379
loss_pred:0.014515053480863571, decouple_loss:0.0006307914736680686
2023-05-01 22:16:33 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12011612206697464, mean p set: 0.4502691626548767
loss_pred:0.017192186787724495, decouple_loss:0.0007518414058722556
The modified gen p mean: 0.44953426718711853, gen p mean: -0.1145920604467392, mean p set: 0.4500633478164673
loss_pred:0.016605081036686897, decouple_loss:0.0008015680941753089
The modified gen p mean: 0.44977957010269165, gen p mean: -0.11379966884851456, mean p set: 0.45035696029663086
loss_pred:0.01689513958990574, decouple_loss:0.0006811193889006972
WV_1_PC_1_EH_0_PS_40, loss: 0.01693471148610115, avg_mse: 0.026317376643419266
current test mse: 0.026317
Iteration: 1731, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44953975081443787, gen p mean: -0.10909874737262726, mean p set: 0.45011407136917114
loss_pred:0.015396730974316597, decouple_loss:0.0005193754332140088
The modified gen p mean: 0.44959694147109985, gen p mean: -0.10788360983133316, mean p set: 0.4501708745956421The modified gen p mean: 0.44827353954315186, gen p mean: -0.1098547950387001, mean p set: 0.44884851574897766
loss_pred:0.01508281473070383, decouple_loss:0.0006634612800553441
loss_pred:0.015308849513530731, decouple_loss:0.0005490835756063461
Iteration: 1732, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495950937271118, gen p mean: -0.106922447681427, mean p set: 0.45017489790916443
loss_pred:0.015023661777377129, decouple_loss:0.0005948245525360107
The modified gen p mean: 0.4479224383831024, gen p mean: -0.10599565505981445, mean p set: 0.4484984576702118The modified gen p mean: 0.4481160342693329, gen p mean: -0.11295913904905319, mean p set: 0.4486904740333557
loss_pred:0.014944365248084068, decouple_loss:0.0006471343222074211
loss_pred:0.014553071931004524, decouple_loss:0.000802554190158844
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012011_3_24hr.npz
NaN value num: 0
Iteration: 1733, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522971510887146, gen p mean: -0.11277605593204498, mean p set: 0.45287367701530457
loss_pred:0.015777919441461563, decouple_loss:0.0006329483003355563
The modified gen p mean: 0.45328572392463684, gen p mean: -0.10776770859956741, mean p set: 0.4538623094558716
The modified gen p mean: 0.4507719576358795, gen p mean: -0.11008027195930481, mean p set: 0.4513482451438904
loss_pred:0.01613033376634121, decouple_loss:0.0005539460689760745
loss_pred:0.016294240951538086, decouple_loss:0.0005945413722656667
Iteration: 1734, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517704248428345, gen p mean: -0.11208116263151169, mean p set: 0.4523479640483856
loss_pred:0.015467257238924503, decouple_loss:0.0005574513925239444
The modified gen p mean: 0.45082053542137146, gen p mean: -0.11129850894212723, mean p set: 0.4513972997665405
loss_pred:0.016730383038520813, decouple_loss:0.0007076127803884447
The modified gen p mean: 0.45124271512031555, gen p mean: -0.10910040140151978, mean p set: 0.45181983709335327
loss_pred:0.017223142087459564, decouple_loss:0.0006216863985173404
Iteration: 1735, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526026248931885, gen p mean: -0.10942190885543823, mean p set: 0.4531821608543396
loss_pred:0.0163857564330101, decouple_loss:0.0006652784650214016
The modified gen p mean: 0.45183175802230835, gen p mean: -0.10151687264442444, mean p set: 0.45240697264671326
loss_pred:0.015326817519962788, decouple_loss:0.0010851179249584675
The modified gen p mean: 0.45231351256370544, gen p mean: -0.10087473690509796, mean p set: 0.4528920352458954
loss_pred:0.016221249476075172, decouple_loss:0.0009111189283430576
Iteration: 1736, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520520865917206, gen p mean: -0.09772447496652603, mean p set: 0.4526279866695404
loss_pred:0.016420146450400352, decouple_loss:0.0006019794964231551
The modified gen p mean: 0.4531637132167816, gen p mean: -0.09625710546970367, mean p set: 0.453741192817688
loss_pred:0.015810202807188034, decouple_loss:0.0008449633605778217
The modified gen p mean: 0.4517093300819397, gen p mean: -0.09657224267721176, mean p set: 0.45228642225265503
loss_pred:0.016015060245990753, decouple_loss:0.0007333391695283353
Iteration: 1737, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45163917541503906, gen p mean: -0.09918517619371414, mean p set: 0.45221495628356934
loss_pred:0.016101866960525513, decouple_loss:0.0006808885373175144
The modified gen p mean: 0.4523282051086426, gen p mean: -0.09721653163433075, mean p set: 0.4529043138027191
The modified gen p mean: 0.4521094560623169, gen p mean: -0.0961093157529831, mean p set: 0.4526858329772949
loss_pred:0.01567671447992325, decouple_loss:0.0006703038234263659
loss_pred:0.016025938093662262, decouple_loss:0.0006006562616676092
Iteration: 1738, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505382776260376, gen p mean: -0.09754188358783722, mean p set: 0.451114296913147
loss_pred:0.01613643765449524, decouple_loss:0.0005410073790699244
The modified gen p mean: 0.4534558951854706, gen p mean: -0.0960480347275734, mean p set: 0.45403215289115906
loss_pred:0.01578042469918728, decouple_loss:0.000661198515444994
The modified gen p mean: 0.4516395032405853, gen p mean: -0.0957983061671257, mean p set: 0.4522169232368469
loss_pred:0.015914971008896828, decouple_loss:0.0006518675363622606
Iteration: 1739, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45329147577285767, gen p mean: -0.10081404447555542, mean p set: 0.45386558771133423
loss_pred:0.01534457691013813, decouple_loss:0.000837483094073832
The modified gen p mean: 0.4513013958930969, gen p mean: -0.10310173779726028, mean p set: 0.4518786072731018
loss_pred:0.016513608396053314, decouple_loss:0.0006371870986185968
The modified gen p mean: 0.451947420835495, gen p mean: -0.10403682291507721, mean p set: 0.4525260329246521
loss_pred:0.01634901948273182, decouple_loss:0.0007304535247385502
Iteration: 1740, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145416259765625, gen p mean: -0.10041369497776031, mean p set: 0.45203232765197754
loss_pred:0.016280023381114006, decouple_loss:0.00064626126550138
The modified gen p mean: 0.4523181915283203, gen p mean: -0.10045748203992844, mean p set: 0.45289722084999084
The modified gen p mean: 0.4519405663013458, gen p mean: -0.09905926138162613, mean p set: 0.4525179862976074
loss_pred:0.015250279568135738, decouple_loss:0.0006055152625776827
loss_pred:0.015007786452770233, decouple_loss:0.0005240525351837277
2023-05-01 22:19:15 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11364233493804932, mean p set: 0.4502691626548767
loss_pred:0.017197994515299797, decouple_loss:0.0007238452089950442
The modified gen p mean: 0.4495355188846588, gen p mean: -0.10839037597179413, mean p set: 0.4500633478164673
loss_pred:0.01650962606072426, decouple_loss:0.0008285306394100189
The modified gen p mean: 0.4497796893119812, gen p mean: -0.10700575262308121, mean p set: 0.45035696029663086
loss_pred:0.016799647361040115, decouple_loss:0.0006022949237376451
WV_1_PC_1_EH_0_PS_40, loss: 0.01687166839838028, avg_mse: 0.026259152218699455
current test mse: 0.026259
Iteration: 1741, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525822103023529, gen p mean: -0.10673114657402039, mean p set: 0.4531596302986145
loss_pred:0.015677468851208687, decouple_loss:0.0007233732612803578
The modified gen p mean: 0.4502594769001007, gen p mean: -0.09895008057355881, mean p set: 0.4508371949195862The modified gen p mean: 0.4525209069252014, gen p mean: -0.10385541617870331, mean p set: 0.4530986547470093
loss_pred:0.01600952446460724, decouple_loss:0.0005437430227175355loss_pred:0.015758221969008446, decouple_loss:0.0006941170431673527
Iteration: 1742, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519989490509033, gen p mean: -0.09607570618391037, mean p set: 0.452574759721756
loss_pred:0.015979113057255745, decouple_loss:0.0006547949742525816
The modified gen p mean: 0.45056673884391785, gen p mean: -0.09659821540117264, mean p set: 0.45114362239837646The modified gen p mean: 0.45304572582244873, gen p mean: -0.0996934175491333, mean p set: 0.45362168550491333
loss_pred:0.015305984765291214, decouple_loss:0.0007288487395271659
loss_pred:0.015291227027773857, decouple_loss:0.00075867201667279
Iteration: 1743, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45248645544052124, gen p mean: -0.09244047850370407, mean p set: 0.45306316018104553
loss_pred:0.01586235873401165, decouple_loss:0.0007415936561301351
The modified gen p mean: 0.4517113268375397, gen p mean: -0.09677471965551376, mean p set: 0.45228806138038635
loss_pred:0.015883268788456917, decouple_loss:0.0006483121542260051
The modified gen p mean: 0.4532025158405304, gen p mean: -0.10239122062921524, mean p set: 0.453777015209198
loss_pred:0.015504495240747929, decouple_loss:0.0006256607011891901
Iteration: 1744, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518227279186249, gen p mean: -0.09608488529920578, mean p set: 0.4523969888687134
loss_pred:0.016110187396407127, decouple_loss:0.000586630601901561
The modified gen p mean: 0.45137667655944824, gen p mean: -0.09870636463165283, mean p set: 0.45195239782333374
loss_pred:0.017070002853870392, decouple_loss:0.0006857113330624998
The modified gen p mean: 0.45092371106147766, gen p mean: -0.09367874264717102, mean p set: 0.45150119066238403
loss_pred:0.016220197081565857, decouple_loss:0.0005468579474836588
Iteration: 1745, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514073431491852, gen p mean: -0.09930465370416641, mean p set: 0.45198309421539307
loss_pred:0.016421915963292122, decouple_loss:0.0007668973412364721
The modified gen p mean: 0.4511522352695465, gen p mean: -0.09165399521589279, mean p set: 0.45172953605651855
loss_pred:0.015657585114240646, decouple_loss:0.0007266398752108216
The modified gen p mean: 0.45206907391548157, gen p mean: -0.09503930062055588, mean p set: 0.4526466727256775
loss_pred:0.01642732508480549, decouple_loss:0.0006111941183917224
Iteration: 1746, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534456431865692, gen p mean: -0.0958520844578743, mean p set: 0.4540221691131592
loss_pred:0.01512094121426344, decouple_loss:0.0007767219794914126
The modified gen p mean: 0.4526137709617615, gen p mean: -0.10001655668020248, mean p set: 0.4531908929347992
loss_pred:0.015343435108661652, decouple_loss:0.000741084513720125
The modified gen p mean: 0.45064523816108704, gen p mean: -0.09884843230247498, mean p set: 0.4512217342853546
loss_pred:0.015466203913092613, decouple_loss:0.000632396899163723
Iteration: 1747, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511786699295044, gen p mean: -0.10846282541751862, mean p set: 0.4517561197280884
loss_pred:0.016046136617660522, decouple_loss:0.0007753063109703362
The modified gen p mean: 0.45110848546028137, gen p mean: -0.10853785276412964, mean p set: 0.4516848623752594
The modified gen p mean: 0.4522695243358612, gen p mean: -0.10253604501485825, mean p set: 0.4528461992740631
loss_pred:0.015805622562766075, decouple_loss:0.0008624008623883128
loss_pred:0.01551890466362238, decouple_loss:0.000522429239936173
Iteration: 1748, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45314496755599976, gen p mean: -0.11415872722864151, mean p set: 0.4537212550640106
loss_pred:0.015764145180583, decouple_loss:0.0007049184059724212
The modified gen p mean: 0.45177939534187317, gen p mean: -0.10502783209085464, mean p set: 0.452355295419693
The modified gen p mean: 0.45059463381767273, gen p mean: -0.10766331106424332, mean p set: 0.4511723518371582
loss_pred:0.015612741932272911, decouple_loss:0.0006157873431220651
loss_pred:0.01561349630355835, decouple_loss:0.0005064584547653794
Iteration: 1749, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518390893936157, gen p mean: -0.10777821391820908, mean p set: 0.45241400599479675
loss_pred:0.015774834901094437, decouple_loss:0.000745281227864325
The modified gen p mean: 0.4519859850406647, gen p mean: -0.10894560068845749, mean p set: 0.45256444811820984
The modified gen p mean: 0.45114362239837646, gen p mean: -0.10886555165052414, mean p set: 0.45171958208084106
loss_pred:0.015477687120437622, decouple_loss:0.0005521798157133162
loss_pred:0.015602974221110344, decouple_loss:0.0007889590924605727
Iteration: 1750, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525580406188965, gen p mean: -0.10965746641159058, mean p set: 0.4531313478946686
loss_pred:0.01587582379579544, decouple_loss:0.0005296480958350003
The modified gen p mean: 0.4533565044403076, gen p mean: -0.11443542689085007, mean p set: 0.45393162965774536
loss_pred:0.015844084322452545, decouple_loss:0.000675243092700839
The modified gen p mean: 0.4514159560203552, gen p mean: -0.1107976958155632, mean p set: 0.4519937038421631
loss_pred:0.015695104375481606, decouple_loss:0.0005134561797603965
2023-05-01 22:21:21 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12213446199893951, mean p set: 0.4502691626548767
loss_pred:0.017212077975273132, decouple_loss:0.0006475368281826377
The modified gen p mean: 0.44953617453575134, gen p mean: -0.11674443632364273, mean p set: 0.4500633478164673
loss_pred:0.0164545439183712, decouple_loss:0.0007330040098167956
The modified gen p mean: 0.44977977871894836, gen p mean: -0.11553727090358734, mean p set: 0.45035696029663086
loss_pred:0.016811447218060493, decouple_loss:0.0006188953411765397
WV_1_PC_1_EH_0_PS_40, loss: 0.016859347000718117, avg_mse: 0.026184063404798508
current test mse: 0.026184
Iteration: 1751, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530046880245209, gen p mean: -0.10849268734455109, mean p set: 0.45358291268348694
loss_pred:0.014807388186454773, decouple_loss:0.000534232531208545
The modified gen p mean: 0.452067106962204, gen p mean: -0.11233580857515335, mean p set: 0.4526461064815521
loss_pred:0.015778111293911934, decouple_loss:0.0008799944771453738
The modified gen p mean: 0.4513947367668152, gen p mean: -0.11219599843025208, mean p set: 0.4519711136817932
loss_pred:0.01647748425602913, decouple_loss:0.0006274049519561231
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012012_3_24hr.npz
NaN value num: 0
Iteration: 1752, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513818919658661, gen p mean: -0.1135626807808876, mean p set: 0.4519580900669098
loss_pred:0.016191378235816956, decouple_loss:0.0007318614516407251
The modified gen p mean: 0.4523163437843323, gen p mean: -0.10997503250837326, mean p set: 0.4528955817222595The modified gen p mean: 0.4519929587841034, gen p mean: -0.109322689473629, mean p set: 0.4525703489780426
loss_pred:0.01607244275510311, decouple_loss:0.0007577773067168891
loss_pred:0.015678616240620613, decouple_loss:0.0008942077402025461
Iteration: 1753, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520016610622406, gen p mean: -0.10627225041389465, mean p set: 0.45258164405822754
loss_pred:0.015895579010248184, decouple_loss:0.0006491471431218088
The modified gen p mean: 0.45242634415626526, gen p mean: -0.10180787742137909, mean p set: 0.45300236344337463
loss_pred:0.015789693221449852, decouple_loss:0.0005178581923246384
The modified gen p mean: 0.4528665244579315, gen p mean: -0.10571298748254776, mean p set: 0.45344221591949463
loss_pred:0.015937404707074165, decouple_loss:0.0006375646917149425
Iteration: 1754, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506668448448181, gen p mean: -0.10521037876605988, mean p set: 0.45124077796936035
loss_pred:0.01475396379828453, decouple_loss:0.0007596950745210052
The modified gen p mean: 0.45217758417129517, gen p mean: -0.10912394523620605, mean p set: 0.4527551829814911
loss_pred:0.0159761942923069, decouple_loss:0.0007586940773762763
The modified gen p mean: 0.4514786899089813, gen p mean: -0.10424262285232544, mean p set: 0.4520549178123474
loss_pred:0.016722870990633965, decouple_loss:0.0006851323996670544
Iteration: 1755, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45013800263404846, gen p mean: -0.10494193434715271, mean p set: 0.4507158100605011
loss_pred:0.015070176683366299, decouple_loss:0.0008465481223538518
The modified gen p mean: 0.4506745934486389, gen p mean: -0.10124433785676956, mean p set: 0.45124828815460205
loss_pred:0.01542906928807497, decouple_loss:0.0005986992619000375
The modified gen p mean: 0.4532581567764282, gen p mean: -0.10665826499462128, mean p set: 0.45383426547050476
loss_pred:0.01660144329071045, decouple_loss:0.0008829903672449291
Iteration: 1756, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524666368961334, gen p mean: -0.10314923524856567, mean p set: 0.4530409872531891
loss_pred:0.015601045452058315, decouple_loss:0.00045858329394832253
The modified gen p mean: 0.45311400294303894, gen p mean: -0.10890254378318787, mean p set: 0.45368802547454834
loss_pred:0.01660786382853985, decouple_loss:0.0006229799473658204
The modified gen p mean: 0.4506380558013916, gen p mean: -0.10001528263092041, mean p set: 0.45121341943740845
loss_pred:0.015056991949677467, decouple_loss:0.0008536711102351546
Iteration: 1757, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520241320133209, gen p mean: -0.10708364844322205, mean p set: 0.4526018798351288
loss_pred:0.015920206904411316, decouple_loss:0.0005844371044076979
The modified gen p mean: 0.4522841274738312, gen p mean: -0.11101195961236954, mean p set: 0.452862411737442
The modified gen p mean: 0.4508577287197113, gen p mean: -0.10626939684152603, mean p set: 0.45143428444862366
loss_pred:0.015740670263767242, decouple_loss:0.0007353901164606214
loss_pred:0.014854103326797485, decouple_loss:0.0006800472619943321
Iteration: 1758, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503147006034851, gen p mean: -0.10265078395605087, mean p set: 0.45089107751846313
loss_pred:0.015582900494337082, decouple_loss:0.0006356003577820957
The modified gen p mean: 0.45354464650154114, gen p mean: -0.10490802675485611, mean p set: 0.45412078499794006
loss_pred:0.015099792741239071, decouple_loss:0.0008290421683341265
The modified gen p mean: 0.4512444734573364, gen p mean: -0.10748787969350815, mean p set: 0.45181846618652344
loss_pred:0.015506349503993988, decouple_loss:0.0007250153576023877
Iteration: 1759, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45051494240760803, gen p mean: -0.11072317510843277, mean p set: 0.4510918855667114
loss_pred:0.015157823450863361, decouple_loss:0.0007545545231550932
The modified gen p mean: 0.45251864194869995, gen p mean: -0.1041349545121193, mean p set: 0.45309609174728394
loss_pred:0.015963319689035416, decouple_loss:0.0007958075730130076
The modified gen p mean: 0.45179662108421326, gen p mean: -0.11194711923599243, mean p set: 0.45237478613853455
loss_pred:0.016182435676455498, decouple_loss:0.0007675505476072431
Iteration: 1760, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510561227798462, gen p mean: -0.10743915289640427, mean p set: 0.4516338109970093
loss_pred:0.015392150729894638, decouple_loss:0.0004936023615300655
The modified gen p mean: 0.4520711302757263, gen p mean: -0.11184772104024887, mean p set: 0.4526480436325073
loss_pred:0.015307927504181862, decouple_loss:0.00047969361185096204
The modified gen p mean: 0.45264336466789246, gen p mean: -0.11590826511383057, mean p set: 0.45321789383888245
loss_pred:0.015752539038658142, decouple_loss:0.0005549092893488705
2023-05-01 22:24:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12633070349693298, mean p set: 0.4502691626548767
loss_pred:0.017207643017172813, decouple_loss:0.0006615448510274291
The modified gen p mean: 0.449534147977829, gen p mean: -0.1206936314702034, mean p set: 0.4500633478164673
loss_pred:0.016502095386385918, decouple_loss:0.0007470393902622163
The modified gen p mean: 0.44978293776512146, gen p mean: -0.11951909959316254, mean p set: 0.45035696029663086
loss_pred:0.016859224066138268, decouple_loss:0.0006820840062573552
WV_1_PC_1_EH_0_PS_40, loss: 0.01689116656780243, avg_mse: 0.026204043999314308
current test mse: 0.026204
Iteration: 1761, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529830515384674, gen p mean: -0.11089614033699036, mean p set: 0.4535618722438812
loss_pred:0.015217308886349201, decouple_loss:0.0005884578567929566
The modified gen p mean: 0.45200198888778687, gen p mean: -0.11171039938926697, mean p set: 0.4525795578956604
loss_pred:0.015635577961802483, decouple_loss:0.0005304734804667532
The modified gen p mean: 0.45180031657218933, gen p mean: -0.11498893052339554, mean p set: 0.4523775279521942
loss_pred:0.01563270576298237, decouple_loss:0.0006447001942433417
Iteration: 1762, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45098650455474854, gen p mean: -0.10796625912189484, mean p set: 0.4515622556209564
loss_pred:0.016214584931731224, decouple_loss:0.00046452315291389823
The modified gen p mean: 0.452416330575943, gen p mean: -0.11400356143712997, mean p set: 0.45299410820007324The modified gen p mean: 0.452273964881897, gen p mean: -0.11558143049478531, mean p set: 0.45285117626190186
loss_pred:0.015494059771299362, decouple_loss:0.000613348965998739
loss_pred:0.0157961156219244, decouple_loss:0.0004554384795483202
Iteration: 1763, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526955783367157, gen p mean: -0.11149567365646362, mean p set: 0.4532724618911743
loss_pred:0.01575031504034996, decouple_loss:0.0006066694622859359
The modified gen p mean: 0.4513435959815979, gen p mean: -0.12147653847932816, mean p set: 0.45191919803619385The modified gen p mean: 0.45196613669395447, gen p mean: -0.11472612619400024, mean p set: 0.45254209637641907
loss_pred:0.015131875872612, decouple_loss:0.000683043384924531loss_pred:0.01557182427495718, decouple_loss:0.000575138779822737
Iteration: 1764, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451151579618454, gen p mean: -0.10728896409273148, mean p set: 0.45172739028930664
loss_pred:0.015466209501028061, decouple_loss:0.0005295752780511975
The modified gen p mean: 0.4530291259288788, gen p mean: -0.11134768277406693, mean p set: 0.45360562205314636
loss_pred:0.01564677432179451, decouple_loss:0.00047203112626448274
The modified gen p mean: 0.45309317111968994, gen p mean: -0.11195307224988937, mean p set: 0.4536671042442322
loss_pred:0.015314066782593727, decouple_loss:0.0006405931198969483
Iteration: 1765, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513130187988281, gen p mean: -0.11396005749702454, mean p set: 0.45189008116722107
loss_pred:0.016038671135902405, decouple_loss:0.0005195208359509706
The modified gen p mean: 0.45094022154808044, gen p mean: -0.10877116024494171, mean p set: 0.45151615142822266
loss_pred:0.015562969259917736, decouple_loss:0.0005075848312117159
The modified gen p mean: 0.45092353224754333, gen p mean: -0.11397957056760788, mean p set: 0.4514986276626587
loss_pred:0.01614191383123398, decouple_loss:0.0005383217940106988
Iteration: 1766, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507977366447449, gen p mean: -0.10207191854715347, mean p set: 0.451375812292099
loss_pred:0.016614608466625214, decouple_loss:0.0005803240346722305
The modified gen p mean: 0.4523571729660034, gen p mean: -0.10586835443973541, mean p set: 0.4529340863227844
loss_pred:0.016079815104603767, decouple_loss:0.000650604662951082
The modified gen p mean: 0.4512123465538025, gen p mean: -0.10580021888017654, mean p set: 0.4517892897129059
loss_pred:0.01541823334991932, decouple_loss:0.000579406158067286
Iteration: 1767, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128798484802246, gen p mean: -0.10444406419992447, mean p set: 0.4518677592277527
loss_pred:0.015430811792612076, decouple_loss:0.0007973728352226317
The modified gen p mean: 0.4516565501689911, gen p mean: -0.10708776116371155, mean p set: 0.4522334337234497
loss_pred:0.01565598137676716, decouple_loss:0.0008256591390818357
The modified gen p mean: 0.4528799057006836, gen p mean: -0.1008218452334404, mean p set: 0.4534555673599243
loss_pred:0.015334232710301876, decouple_loss:0.0005236223805695772
Iteration: 1768, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45022132992744446, gen p mean: -0.10656004399061203, mean p set: 0.4507977068424225
loss_pred:0.015580681152641773, decouple_loss:0.0007310499786399305
The modified gen p mean: 0.45072588324546814, gen p mean: -0.1023121029138565, mean p set: 0.4513013958930969
loss_pred:0.015407610684633255, decouple_loss:0.0005422772374004126
The modified gen p mean: 0.4525781571865082, gen p mean: -0.0979788526892662, mean p set: 0.45315417647361755
loss_pred:0.015484370291233063, decouple_loss:0.0006843816372565925
Iteration: 1769, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451295405626297, gen p mean: -0.10145557671785355, mean p set: 0.4518711566925049
loss_pred:0.015611001290380955, decouple_loss:0.0005231291288509965
The modified gen p mean: 0.4517044126987457, gen p mean: -0.10020758211612701, mean p set: 0.45228198170661926
loss_pred:0.01611935719847679, decouple_loss:0.0006452447269111872
The modified gen p mean: 0.4532332718372345, gen p mean: -0.10013587027788162, mean p set: 0.45381149649620056
loss_pred:0.015592056326568127, decouple_loss:0.0006026319460943341
Iteration: 1770, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4533277153968811, gen p mean: -0.09806686639785767, mean p set: 0.45390620827674866
loss_pred:0.015969956293702126, decouple_loss:0.0004592986369971186
The modified gen p mean: 0.4525284171104431, gen p mean: -0.09944417327642441, mean p set: 0.4531055986881256
loss_pred:0.01566021330654621, decouple_loss:0.0005235651042312384
The modified gen p mean: 0.45085132122039795, gen p mean: -0.10035686939954758, mean p set: 0.45142796635627747
loss_pred:0.014667998068034649, decouple_loss:0.00047175513464026153
2023-05-01 22:26:18 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.114555224776268, mean p set: 0.4502691626548767
loss_pred:0.01725771464407444, decouple_loss:0.0007339822477661073
The modified gen p mean: 0.4495351016521454, gen p mean: -0.10871388018131256, mean p set: 0.4500633478164673
loss_pred:0.016427110880613327, decouple_loss:0.0008621153538115323
The modified gen p mean: 0.44978079199790955, gen p mean: -0.10802968591451645, mean p set: 0.45035696029663086
loss_pred:0.016805682331323624, decouple_loss:0.0007748673087917268
WV_1_PC_1_EH_0_PS_40, loss: 0.016869686543941498, avg_mse: 0.02617243491113186
current test mse: 0.026172
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012018_3_24hr.npz
NaN value num: 0
Iteration: 1771, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502089321613312, gen p mean: -0.10502136498689651, mean p set: 0.4507836401462555
loss_pred:0.01688096486032009, decouple_loss:0.0006052766693755984
The modified gen p mean: 0.4495910704135895, gen p mean: -0.10463510453701019, mean p set: 0.45016559958457947
loss_pred:0.01516740582883358, decouple_loss:0.0007568238652311265
The modified gen p mean: 0.4506513774394989, gen p mean: -0.10489823669195175, mean p set: 0.45122823119163513
loss_pred:0.01770045794546604, decouple_loss:0.000658770848531276
Iteration: 1772, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511311948299408, gen p mean: -0.10822928696870804, mean p set: 0.4517081081867218
loss_pred:0.017148032784461975, decouple_loss:0.000636195414699614
The modified gen p mean: 0.45064446330070496, gen p mean: -0.10739534348249435, mean p set: 0.4512195587158203The modified gen p mean: 0.45237085223197937, gen p mean: -0.10671492666006088, mean p set: 0.4529488980770111
loss_pred:0.01760808192193508, decouple_loss:0.0005985648022033274
loss_pred:0.015891561284661293, decouple_loss:0.0007787382928654552
Iteration: 1773, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45060551166534424, gen p mean: -0.10730225592851639, mean p set: 0.45118266344070435
loss_pred:0.016765162348747253, decouple_loss:0.0006434920360334218
The modified gen p mean: 0.44959884881973267, gen p mean: -0.1187012642621994, mean p set: 0.4501744508743286
loss_pred:0.016636010259389877, decouple_loss:0.0006589011172764003
The modified gen p mean: 0.45077046751976013, gen p mean: -0.1045151874423027, mean p set: 0.4513501822948456
loss_pred:0.01760137639939785, decouple_loss:0.0007011255947872996
Iteration: 1774, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45275986194610596, gen p mean: -0.1168498769402504, mean p set: 0.45333564281463623
loss_pred:0.01519682165235281, decouple_loss:0.0008906160364858806
The modified gen p mean: 0.45267945528030396, gen p mean: -0.11560339480638504, mean p set: 0.45325756072998047
loss_pred:0.015880143269896507, decouple_loss:0.0009281480452045798
The modified gen p mean: 0.44831064343452454, gen p mean: -0.11359561234712601, mean p set: 0.4488857686519623
loss_pred:0.017057938501238823, decouple_loss:0.0007784870686009526
Iteration: 1775, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108863711357117, gen p mean: -0.11959144473075867, mean p set: 0.4516648054122925
loss_pred:0.015218125656247139, decouple_loss:0.0006711213500238955
The modified gen p mean: 0.4496684968471527, gen p mean: -0.12484105676412582, mean p set: 0.4502442479133606
loss_pred:0.01700470596551895, decouple_loss:0.0006980406469665468
The modified gen p mean: 0.4506674110889435, gen p mean: -0.12214377522468567, mean p set: 0.4512436091899872
loss_pred:0.016474969685077667, decouple_loss:0.0006312004989013076
Iteration: 1776, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4486013650894165, gen p mean: -0.11830522119998932, mean p set: 0.4491777718067169
loss_pred:0.016756359487771988, decouple_loss:0.000733479333575815
The modified gen p mean: 0.45132535696029663, gen p mean: -0.12456435710191727, mean p set: 0.4518985152244568
loss_pred:0.01624860242009163, decouple_loss:0.0006260644877329469
The modified gen p mean: 0.4498952031135559, gen p mean: -0.12351430207490921, mean p set: 0.4504671096801758
loss_pred:0.01706419140100479, decouple_loss:0.0005456414073705673
Iteration: 1777, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500761926174164, gen p mean: -0.11814499646425247, mean p set: 0.4506521224975586
loss_pred:0.01606830768287182, decouple_loss:0.0006465116748586297
The modified gen p mean: 0.4493923485279083, gen p mean: -0.1138688176870346, mean p set: 0.4499705135822296
loss_pred:0.0156116783618927, decouple_loss:0.0004939673817716539
The modified gen p mean: 0.45173415541648865, gen p mean: -0.1252315491437912, mean p set: 0.4523109793663025
loss_pred:0.016913771629333496, decouple_loss:0.0005977757391519845
Iteration: 1778, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44918179512023926, gen p mean: -0.12035980075597763, mean p set: 0.4497554302215576
The modified gen p mean: 0.45007339119911194, gen p mean: -0.1274787336587906, mean p set: 0.4506514370441437
loss_pred:0.016327260062098503, decouple_loss:0.0004940716899000108
loss_pred:0.016499144956469536, decouple_loss:0.0005416840431280434
The modified gen p mean: 0.44980481266975403, gen p mean: -0.13023540377616882, mean p set: 0.4503801465034485
loss_pred:0.01637740433216095, decouple_loss:0.0005107823526486754
Iteration: 1779, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45075905323028564, gen p mean: -0.1274900883436203, mean p set: 0.451333224773407
loss_pred:0.015916770324110985, decouple_loss:0.0004961967351846397
The modified gen p mean: 0.4511193335056305, gen p mean: -0.12705059349536896, mean p set: 0.451697438955307
loss_pred:0.01754535362124443, decouple_loss:0.0006133798742666841
The modified gen p mean: 0.4482411742210388, gen p mean: -0.1244133934378624, mean p set: 0.44881677627563477
loss_pred:0.01645788550376892, decouple_loss:0.0004560740489978343
Iteration: 1780, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45128199458122253, gen p mean: -0.12519454956054688, mean p set: 0.4518575668334961
loss_pred:0.01680406741797924, decouple_loss:0.000686909188516438
The modified gen p mean: 0.45083916187286377, gen p mean: -0.13225209712982178, mean p set: 0.4514155387878418
loss_pred:0.016786713153123856, decouple_loss:0.000581398606300354
The modified gen p mean: 0.4508369565010071, gen p mean: -0.12960676848888397, mean p set: 0.45141419768333435
loss_pred:0.016806991770863533, decouple_loss:0.0005707620875909925
2023-05-01 22:29:01 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13656489551067352, mean p set: 0.4502691626548767
loss_pred:0.01717197895050049, decouple_loss:0.0005597915151156485
The modified gen p mean: 0.44953832030296326, gen p mean: -0.1298246532678604, mean p set: 0.4500633478164673
loss_pred:0.016432782635092735, decouple_loss:0.0006265809061005712
The modified gen p mean: 0.4497813880443573, gen p mean: -0.12894584238529205, mean p set: 0.45035696029663086
loss_pred:0.016717620193958282, decouple_loss:0.0005927367019467056
WV_1_PC_1_EH_0_PS_40, loss: 0.01680377870798111, avg_mse: 0.02610076405107975
current test mse: 0.026101
Iteration: 1781, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506792724132538, gen p mean: -0.12762773036956787, mean p set: 0.4512555003166199
loss_pred:0.017482727766036987, decouple_loss:0.0006197931943461299
The modified gen p mean: 0.4485664367675781, gen p mean: -0.12463901937007904, mean p set: 0.44914230704307556
loss_pred:0.015879040583968163, decouple_loss:0.0005087726749479771
The modified gen p mean: 0.44863083958625793, gen p mean: -0.12182226032018661, mean p set: 0.4492046535015106
loss_pred:0.017000194638967514, decouple_loss:0.0004357704019639641
Iteration: 1782, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45164918899536133, gen p mean: -0.12598177790641785, mean p set: 0.45222997665405273
The modified gen p mean: 0.45025599002838135, gen p mean: -0.12651637196540833, mean p set: 0.45083242654800415
loss_pred:0.01655857264995575, decouple_loss:0.0008387166890315711
loss_pred:0.016304878517985344, decouple_loss:0.0008826287230476737
The modified gen p mean: 0.44969403743743896, gen p mean: -0.12818722426891327, mean p set: 0.45026880502700806
loss_pred:0.015968218445777893, decouple_loss:0.0005731899291276932
Iteration: 1783, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518555998802185, gen p mean: -0.11819691210985184, mean p set: 0.45243194699287415
loss_pred:0.01720852591097355, decouple_loss:0.0006307626608759165
The modified gen p mean: 0.4513361155986786, gen p mean: -0.12354092299938202, mean p set: 0.45191308856010437
loss_pred:0.01556349452584982, decouple_loss:0.000595780904404819
The modified gen p mean: 0.45006316900253296, gen p mean: -0.12414442747831345, mean p set: 0.4506361782550812
loss_pred:0.016572613269090652, decouple_loss:0.0006506893550977111
Iteration: 1784, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958147406578064, gen p mean: -0.10689456015825272, mean p set: 0.4501582682132721
loss_pred:0.015827259048819542, decouple_loss:0.0005333844455890357
The modified gen p mean: 0.4524008631706238, gen p mean: -0.11182238906621933, mean p set: 0.45297905802726746
loss_pred:0.017043761909008026, decouple_loss:0.0005398344364948571
The modified gen p mean: 0.44896262884140015, gen p mean: -0.11514734476804733, mean p set: 0.4495377540588379
loss_pred:0.016043230891227722, decouple_loss:0.00062899588374421
Iteration: 1785, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45125675201416016, gen p mean: -0.10859792679548264, mean p set: 0.4518345892429352
loss_pred:0.016392897814512253, decouple_loss:0.0006130248657427728
The modified gen p mean: 0.4505549967288971, gen p mean: -0.10738719254732132, mean p set: 0.4511326253414154
loss_pred:0.0174450371414423, decouple_loss:0.0007267645560204983
The modified gen p mean: 0.44998225569725037, gen p mean: -0.11074184626340866, mean p set: 0.45056024193763733
loss_pred:0.0167895145714283, decouple_loss:0.0005949574988335371
Iteration: 1786, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523443877696991, gen p mean: -0.10737103223800659, mean p set: 0.45292070508003235
loss_pred:0.017155280336737633, decouple_loss:0.000606402987614274
The modified gen p mean: 0.4479474723339081, gen p mean: -0.1094481572508812, mean p set: 0.44852298498153687
The modified gen p mean: 0.4508078992366791, gen p mean: -0.11542488634586334, mean p set: 0.45138633251190186
loss_pred:0.016451139003038406, decouple_loss:0.0005467889714054763
loss_pred:0.015608442947268486, decouple_loss:0.0005420553497970104
Iteration: 1787, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507972300052643, gen p mean: -0.11733386665582657, mean p set: 0.45137470960617065
loss_pred:0.01772666908800602, decouple_loss:0.0005284867947921157
The modified gen p mean: 0.44813773036003113, gen p mean: -0.11330296099185944, mean p set: 0.4487107992172241
The modified gen p mean: 0.4525878131389618, gen p mean: -0.12143893539905548, mean p set: 0.4531644284725189
loss_pred:0.016464054584503174, decouple_loss:0.0005961906281299889
loss_pred:0.0157153382897377, decouple_loss:0.0004541707457974553
Iteration: 1788, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451670378446579, gen p mean: -0.11767911165952682, mean p set: 0.4522458016872406
loss_pred:0.017443740740418434, decouple_loss:0.0009668383281677961
The modified gen p mean: 0.4499908983707428, gen p mean: -0.11834505200386047, mean p set: 0.45056816935539246
loss_pred:0.01635385863482952, decouple_loss:0.0009515982819721103
The modified gen p mean: 0.4501369595527649, gen p mean: -0.12173393368721008, mean p set: 0.4507121443748474
loss_pred:0.015548103488981724, decouple_loss:0.0008961287094280124
Iteration: 1789, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514194428920746, gen p mean: -0.12260106950998306, mean p set: 0.4519991874694824
loss_pred:0.017406407743692398, decouple_loss:0.0005893066991120577
The modified gen p mean: 0.450264036655426, gen p mean: -0.12601400911808014, mean p set: 0.450838565826416
loss_pred:0.01714177615940571, decouple_loss:0.0008348148548975587
The modified gen p mean: 0.45139506459236145, gen p mean: -0.12499355524778366, mean p set: 0.45197030901908875
loss_pred:0.016516953706741333, decouple_loss:0.0005494992365129292
Iteration: 1790, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494691789150238, gen p mean: -0.13434743881225586, mean p set: 0.4500464200973511
loss_pred:0.016215072944760323, decouple_loss:0.0005558458506129682
The modified gen p mean: 0.4492555856704712, gen p mean: -0.12683530151844025, mean p set: 0.44983211159706116
loss_pred:0.015799498185515404, decouple_loss:0.0006435011746361852
The modified gen p mean: 0.4531524181365967, gen p mean: -0.1308673471212387, mean p set: 0.45372650027275085
loss_pred:0.014635978266596794, decouple_loss:0.0011238614097237587
2023-05-01 22:31:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1375158727169037, mean p set: 0.4502691626548767
loss_pred:0.017147544771432877, decouple_loss:0.0006677549099549651
The modified gen p mean: 0.44953402876853943, gen p mean: -0.1307445913553238, mean p set: 0.4500633478164673
loss_pred:0.016368882730603218, decouple_loss:0.0008845390984788537
The modified gen p mean: 0.449781209230423, gen p mean: -0.13016408681869507, mean p set: 0.45035696029663086
loss_pred:0.01678772270679474, decouple_loss:0.0008273086277768016
WV_1_PC_1_EH_0_PS_40, loss: 0.016807710751891136, avg_mse: 0.026162341237068176
current test mse: 0.026162
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012019_3_24hr.npz
NaN value num: 0
Iteration: 1791, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45156723260879517, gen p mean: -0.12252014875411987, mean p set: 0.45214447379112244
loss_pred:0.01635628007352352, decouple_loss:0.000795341155026108
The modified gen p mean: 0.4516330361366272, gen p mean: -0.12084714323282242, mean p set: 0.45221033692359924
loss_pred:0.016260996460914612, decouple_loss:0.0007171202450990677
The modified gen p mean: 0.4544207751750946, gen p mean: -0.1263684332370758, mean p set: 0.4549979567527771
loss_pred:0.016666091978549957, decouple_loss:0.0007121477392502129
Iteration: 1792, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502531588077545, gen p mean: -0.11222431808710098, mean p set: 0.4508306682109833
loss_pred:0.016924764961004257, decouple_loss:0.0006782960845157504
The modified gen p mean: 0.4518091678619385, gen p mean: -0.11368659138679504, mean p set: 0.452383428812027The modified gen p mean: 0.45261555910110474, gen p mean: -0.11761783808469772, mean p set: 0.4531923532485962
loss_pred:0.01661357469856739, decouple_loss:0.0005642474279738963
loss_pred:0.016910633072257042, decouple_loss:0.0006151709822006524
Iteration: 1793, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45358502864837646, gen p mean: -0.11391772329807281, mean p set: 0.4541594386100769
loss_pred:0.01627536490559578, decouple_loss:0.0007692340877838433
The modified gen p mean: 0.45306670665740967, gen p mean: -0.10894198715686798, mean p set: 0.4536438286304474
loss_pred:0.01692144386470318, decouple_loss:0.0006803971482440829
The modified gen p mean: 0.4514661133289337, gen p mean: -0.10629542171955109, mean p set: 0.4520424008369446
loss_pred:0.017279326915740967, decouple_loss:0.0005784197710454464
Iteration: 1794, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4532660245895386, gen p mean: -0.10386409610509872, mean p set: 0.4538425803184509
loss_pred:0.016542665660381317, decouple_loss:0.0006438281270675361
The modified gen p mean: 0.4524056613445282, gen p mean: -0.10580779612064362, mean p set: 0.45298275351524353
loss_pred:0.016901586204767227, decouple_loss:0.0005453063640743494
The modified gen p mean: 0.4511832296848297, gen p mean: -0.1079811230301857, mean p set: 0.45176076889038086
loss_pred:0.015266447328031063, decouple_loss:0.0006168840918689966
Iteration: 1795, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45385080575942993, gen p mean: -0.10656428337097168, mean p set: 0.454429566860199
loss_pred:0.01589828170835972, decouple_loss:0.0005871234461665154
The modified gen p mean: 0.4522239863872528, gen p mean: -0.10088668763637543, mean p set: 0.45280152559280396
loss_pred:0.016665449365973473, decouple_loss:0.0005034604691900313
The modified gen p mean: 0.4517518877983093, gen p mean: -0.09495744854211807, mean p set: 0.45232921838760376
loss_pred:0.0159870907664299, decouple_loss:0.0005628140643239021
Iteration: 1796, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525412619113922, gen p mean: -0.1041795089840889, mean p set: 0.453119158744812
The modified gen p mean: 0.4509904980659485, gen p mean: -0.10571710765361786, mean p set: 0.45156678557395935
loss_pred:0.01661284640431404, decouple_loss:0.0005741816712543368
loss_pred:0.016773197799921036, decouple_loss:0.0005863246042281389
The modified gen p mean: 0.45222601294517517, gen p mean: -0.1028105691075325, mean p set: 0.4528021812438965
loss_pred:0.016583271324634552, decouple_loss:0.0005996410036459565
Iteration: 1797, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45145899057388306, gen p mean: -0.10321026295423508, mean p set: 0.45203670859336853
loss_pred:0.01699824258685112, decouple_loss:0.0006486072088591754
The modified gen p mean: 0.45293933153152466, gen p mean: -0.10266581922769547, mean p set: 0.45351678133010864
loss_pred:0.015869004651904106, decouple_loss:0.0007844173815101385
The modified gen p mean: 0.45304903388023376, gen p mean: -0.10486413538455963, mean p set: 0.45362505316734314
loss_pred:0.01634671911597252, decouple_loss:0.0007475110469385982
Iteration: 1798, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.454481840133667, gen p mean: -0.10661204159259796, mean p set: 0.45506227016448975
loss_pred:0.016361715272068977, decouple_loss:0.000614977499935776
The modified gen p mean: 0.4531607925891876, gen p mean: -0.106923907995224, mean p set: 0.4537392258644104
The modified gen p mean: 0.45354703068733215, gen p mean: -0.10472707450389862, mean p set: 0.45412477850914
loss_pred:0.01644948311150074, decouple_loss:0.0005162213928997517
loss_pred:0.015948431566357613, decouple_loss:0.0005610096850432456
Iteration: 1799, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516172707080841, gen p mean: -0.10786397010087967, mean p set: 0.45219212770462036
loss_pred:0.01602833718061447, decouple_loss:0.0009009067434817553
The modified gen p mean: 0.45280709862709045, gen p mean: -0.10994817316532135, mean p set: 0.4533842206001282
The modified gen p mean: 0.4518253207206726, gen p mean: -0.11106977611780167, mean p set: 0.4524010717868805
loss_pred:0.016323024407029152, decouple_loss:0.0006850522477179766
loss_pred:0.016655325889587402, decouple_loss:0.0007021894562058151
Iteration: 1800, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529622495174408, gen p mean: -0.11667890101671219, mean p set: 0.4535352885723114
loss_pred:0.01606912910938263, decouple_loss:0.0006965475622564554
The modified gen p mean: 0.45193642377853394, gen p mean: -0.10836411267518997, mean p set: 0.45251336693763733
The modified gen p mean: 0.4522077143192291, gen p mean: -0.11178537458181381, mean p set: 0.45278772711753845
loss_pred:0.017016489058732986, decouple_loss:0.0006298092193901539
loss_pred:0.017068788409233093, decouple_loss:0.0007669526967220008
2023-05-01 22:33:48 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12835614383220673, mean p set: 0.4502691626548767
loss_pred:0.01723036728799343, decouple_loss:0.000630875292699784
The modified gen p mean: 0.4495360255241394, gen p mean: -0.12208258360624313, mean p set: 0.4500633478164673
loss_pred:0.016457300633192062, decouple_loss:0.0008904156857170165
The modified gen p mean: 0.4497793912887573, gen p mean: -0.12150595337152481, mean p set: 0.45035696029663086
loss_pred:0.016782725229859352, decouple_loss:0.0007034807931631804
WV_1_PC_1_EH_0_PS_40, loss: 0.016860544681549072, avg_mse: 0.026265926659107208
current test mse: 0.026266
Iteration: 1801, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516676366329193, gen p mean: -0.10951302200555801, mean p set: 0.4522446393966675
loss_pred:0.016018277034163475, decouple_loss:0.0006115300348028541
The modified gen p mean: 0.4534415006637573, gen p mean: -0.11262189596891403, mean p set: 0.4540198743343353
loss_pred:0.015823446214199066, decouple_loss:0.0005449661402963102
The modified gen p mean: 0.45320019125938416, gen p mean: -0.11059563606977463, mean p set: 0.45377665758132935
loss_pred:0.015376871451735497, decouple_loss:0.0007179851527325809
Iteration: 1802, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542957544326782, gen p mean: -0.11497683823108673, mean p set: 0.4548746943473816
The modified gen p mean: 0.4537293314933777, gen p mean: -0.10996422171592712, mean p set: 0.4543079137802124
loss_pred:0.01619158312678337, decouple_loss:0.0007223163265734911
loss_pred:0.016804857179522514, decouple_loss:0.0007113085011951625
The modified gen p mean: 0.4521627724170685, gen p mean: -0.11457119882106781, mean p set: 0.45273926854133606
loss_pred:0.015972206369042397, decouple_loss:0.0005372102023102343
Iteration: 1803, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524869918823242, gen p mean: -0.11653441190719604, mean p set: 0.45306292176246643
loss_pred:0.016830315813422203, decouple_loss:0.0007111516315490007
The modified gen p mean: 0.4536016881465912, gen p mean: -0.11407842487096786, mean p set: 0.45417800545692444
loss_pred:0.01610029675066471, decouple_loss:0.0005617961287498474
The modified gen p mean: 0.4518202245235443, gen p mean: -0.11090071499347687, mean p set: 0.452399343252182
loss_pred:0.015967225655913353, decouple_loss:0.00044994792551733553
Iteration: 1804, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4534755051136017, gen p mean: -0.11414770781993866, mean p set: 0.45405256748199463
loss_pred:0.01642310991883278, decouple_loss:0.0004778165020979941
The modified gen p mean: 0.45101141929626465, gen p mean: -0.10822322964668274, mean p set: 0.45158764719963074
loss_pred:0.016269782558083534, decouple_loss:0.000454664696007967
The modified gen p mean: 0.45245280861854553, gen p mean: -0.11473298072814941, mean p set: 0.4530290365219116
loss_pred:0.016140703111886978, decouple_loss:0.0005250128451734781
Iteration: 1805, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517969489097595, gen p mean: -0.11033158004283905, mean p set: 0.4523732364177704
The modified gen p mean: 0.45085012912750244, gen p mean: -0.110985167324543, mean p set: 0.4514295160770416
loss_pred:0.016719389706850052, decouple_loss:0.0006918338476680219
loss_pred:0.016502274200320244, decouple_loss:0.0005519750411622226
The modified gen p mean: 0.45324066281318665, gen p mean: -0.11163888871669769, mean p set: 0.4538169205188751
loss_pred:0.015368515625596046, decouple_loss:0.0006093563279137015
Iteration: 1806, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4542701840400696, gen p mean: -0.11408388614654541, mean p set: 0.45484670996665955
loss_pred:0.0159127376973629, decouple_loss:0.0004906959948129952
The modified gen p mean: 0.4523426592350006, gen p mean: -0.11290094256401062, mean p set: 0.4529195725917816
loss_pred:0.016214903444051743, decouple_loss:0.000384373648557812
The modified gen p mean: 0.45151063799858093, gen p mean: -0.10996086895465851, mean p set: 0.45208826661109924
loss_pred:0.015810087323188782, decouple_loss:0.0004628187161870301
Iteration: 1807, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521447420120239, gen p mean: -0.10776259005069733, mean p set: 0.45272231101989746
loss_pred:0.01574675552546978, decouple_loss:0.0004074682656209916
The modified gen p mean: 0.451689749956131, gen p mean: -0.1015784963965416, mean p set: 0.4522660970687866
loss_pred:0.016807513311505318, decouple_loss:0.0007659068214707077
The modified gen p mean: 0.45183929800987244, gen p mean: -0.10178348422050476, mean p set: 0.4524155259132385
loss_pred:0.015835287049412727, decouple_loss:0.0005573517992161214
Iteration: 1808, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45274287462234497, gen p mean: -0.1155337318778038, mean p set: 0.45331934094429016
loss_pred:0.01526185218244791, decouple_loss:0.0008073143544606864
The modified gen p mean: 0.4546513855457306, gen p mean: -0.11164223402738571, mean p set: 0.45522719621658325
loss_pred:0.0164648424834013, decouple_loss:0.0005043132696300745
The modified gen p mean: 0.45248880982398987, gen p mean: -0.11438930779695511, mean p set: 0.4530661106109619
loss_pred:0.015763483941555023, decouple_loss:0.000656582007650286
Iteration: 1809, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45264190435409546, gen p mean: -0.11244166642427444, mean p set: 0.4532190263271332
loss_pred:0.015820108354091644, decouple_loss:0.000606527435593307
The modified gen p mean: 0.4525805115699768, gen p mean: -0.11551398038864136, mean p set: 0.4531553387641907
loss_pred:0.016297735273838043, decouple_loss:0.000491895480081439
The modified gen p mean: 0.4519084095954895, gen p mean: -0.1122056320309639, mean p set: 0.45248425006866455
loss_pred:0.01626940630376339, decouple_loss:0.0005291958805173635
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012011_3_24hr.npz
NaN value num: 0
Iteration: 1810, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44893163442611694, gen p mean: -0.1157330721616745, mean p set: 0.4495052993297577
loss_pred:0.01631603017449379, decouple_loss:0.0006448968779295683
The modified gen p mean: 0.45188719034194946, gen p mean: -0.1150374785065651, mean p set: 0.4524628818035126
The modified gen p mean: 0.45099079608917236, gen p mean: -0.12163440883159637, mean p set: 0.45157068967819214
loss_pred:0.015896443277597427, decouple_loss:0.0008109320770017803
loss_pred:0.01579452119767666, decouple_loss:0.0007254802621901035
2023-05-01 22:36:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13082082569599152, mean p set: 0.4502691626548767
loss_pred:0.017236728221178055, decouple_loss:0.0006858998094685376
The modified gen p mean: 0.4495375454425812, gen p mean: -0.12429095804691315, mean p set: 0.4500633478164673
loss_pred:0.01654794253408909, decouple_loss:0.000689297157805413
The modified gen p mean: 0.44978225231170654, gen p mean: -0.12417665868997574, mean p set: 0.45035696029663086
loss_pred:0.01681336760520935, decouple_loss:0.0006028024945408106
WV_1_PC_1_EH_0_PS_40, loss: 0.016898980364203453, avg_mse: 0.02628636546432972
current test mse: 0.026286
Iteration: 1811, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45129114389419556, gen p mean: -0.1256243884563446, mean p set: 0.45186808705329895
loss_pred:0.014968113973736763, decouple_loss:0.00045146982301957905
The modified gen p mean: 0.44798964262008667, gen p mean: -0.12224671989679337, mean p set: 0.44856709241867065The modified gen p mean: 0.4493619501590729, gen p mean: -0.11911345273256302, mean p set: 0.4499378204345703
loss_pred:0.016460908576846123, decouple_loss:0.0004802424809895456loss_pred:0.01615963876247406, decouple_loss:0.0005342781078070402
Iteration: 1812, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483845829963684, gen p mean: -0.12519392371177673, mean p set: 0.4489629566669464
The modified gen p mean: 0.45268961787223816, gen p mean: -0.12575127184391022, mean p set: 0.4532664716243744
loss_pred:0.016823388636112213, decouple_loss:0.0004828222154174
loss_pred:0.015744753181934357, decouple_loss:0.0006341084954328835
The modified gen p mean: 0.45106762647628784, gen p mean: -0.1259620189666748, mean p set: 0.45164522528648376
loss_pred:0.01624923013150692, decouple_loss:0.0005695497966371477
Iteration: 1813, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45177873969078064, gen p mean: -0.12419603019952774, mean p set: 0.4523541033267975
loss_pred:0.015526593662798405, decouple_loss:0.00045135687105357647
The modified gen p mean: 0.4520520865917206, gen p mean: -0.12173008918762207, mean p set: 0.45262858271598816
loss_pred:0.01579519547522068, decouple_loss:0.0005258615128695965
The modified gen p mean: 0.4533436894416809, gen p mean: -0.12230933457612991, mean p set: 0.4539194405078888
loss_pred:0.01535627618432045, decouple_loss:0.0006944288033992052
Iteration: 1814, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44894707202911377, gen p mean: -0.12796612083911896, mean p set: 0.4495220482349396
loss_pred:0.01625106856226921, decouple_loss:0.0004615040961652994
The modified gen p mean: 0.4495564103126526, gen p mean: -0.13142864406108856, mean p set: 0.4501332640647888
loss_pred:0.016399798914790154, decouple_loss:0.0004530359583441168
The modified gen p mean: 0.45280882716178894, gen p mean: -0.12050174921751022, mean p set: 0.4533843994140625
loss_pred:0.016291001811623573, decouple_loss:0.0005042583215981722
Iteration: 1815, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515286982059479, gen p mean: -0.12235791236162186, mean p set: 0.45210903882980347
loss_pred:0.01590111292898655, decouple_loss:0.0006092962576076388
The modified gen p mean: 0.452009916305542, gen p mean: -0.12482531368732452, mean p set: 0.4525880217552185
loss_pred:0.015053249895572662, decouple_loss:0.0005329179111868143
The modified gen p mean: 0.4493759572505951, gen p mean: -0.12497714161872864, mean p set: 0.4499515891075134
loss_pred:0.01625499315559864, decouple_loss:0.0005445397109724581
Iteration: 1816, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45359373092651367, gen p mean: -0.12248507887125015, mean p set: 0.4541688859462738
The modified gen p mean: 0.4478779435157776, gen p mean: -0.1253531277179718, mean p set: 0.448453426361084loss_pred:0.015516734682023525, decouple_loss:0.0006682135281153023
loss_pred:0.016273871064186096, decouple_loss:0.0005868229200132191
The modified gen p mean: 0.45002591609954834, gen p mean: -0.12519808113574982, mean p set: 0.45060133934020996
loss_pred:0.015063801780343056, decouple_loss:0.0005504125147126615
Iteration: 1817, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524507522583008, gen p mean: -0.12597845494747162, mean p set: 0.4530285596847534
loss_pred:0.015833303332328796, decouple_loss:0.0005750517593696713
The modified gen p mean: 0.45253416895866394, gen p mean: -0.12143786251544952, mean p set: 0.45311251282691956
loss_pred:0.014847184531390667, decouple_loss:0.0005430010496638715
The modified gen p mean: 0.45204874873161316, gen p mean: -0.12222161889076233, mean p set: 0.45262470841407776
loss_pred:0.015115607529878616, decouple_loss:0.000552553276065737
Iteration: 1818, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513748586177826, gen p mean: -0.1196611151099205, mean p set: 0.45195209980010986
loss_pred:0.015851348638534546, decouple_loss:0.0007474521989934146
The modified gen p mean: 0.45215198397636414, gen p mean: -0.12123299390077591, mean p set: 0.452727735042572
loss_pred:0.015507310628890991, decouple_loss:0.0007494785822927952
The modified gen p mean: 0.44895192980766296, gen p mean: -0.12177278101444244, mean p set: 0.44952961802482605
loss_pred:0.015986371785402298, decouple_loss:0.0006911710952408612
Iteration: 1819, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512653648853302, gen p mean: -0.11708734184503555, mean p set: 0.4518432915210724
loss_pred:0.015497962944209576, decouple_loss:0.00048250745749101043
The modified gen p mean: 0.45118850469589233, gen p mean: -0.12128382921218872, mean p set: 0.45176732540130615
loss_pred:0.015845701098442078, decouple_loss:0.0005579860298894346
The modified gen p mean: 0.4532438814640045, gen p mean: -0.11119688302278519, mean p set: 0.4538205564022064
loss_pred:0.016044465824961662, decouple_loss:0.000547800853382796
Iteration: 1820, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45104947686195374, gen p mean: -0.1207052692770958, mean p set: 0.45162856578826904
loss_pred:0.014721822924911976, decouple_loss:0.0006332703051157296
The modified gen p mean: 0.4503064453601837, gen p mean: -0.11726800352334976, mean p set: 0.45088011026382446
loss_pred:0.015328453853726387, decouple_loss:0.0005258916644379497
The modified gen p mean: 0.45148658752441406, gen p mean: -0.11584998667240143, mean p set: 0.4520629048347473
loss_pred:0.015502718277275562, decouple_loss:0.0005041484837420285
2023-05-01 22:38:33 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12468114495277405, mean p set: 0.4502691626548767
loss_pred:0.01715252920985222, decouple_loss:0.0006264233961701393
The modified gen p mean: 0.44953301548957825, gen p mean: -0.11878926306962967, mean p set: 0.4500633478164673
loss_pred:0.016490833833813667, decouple_loss:0.0005201090825721622
The modified gen p mean: 0.44978052377700806, gen p mean: -0.11855854839086533, mean p set: 0.45035696029663086
loss_pred:0.016679832711815834, decouple_loss:0.0004777622816618532
WV_1_PC_1_EH_0_PS_40, loss: 0.01680147275328636, avg_mse: 0.02620580606162548
current test mse: 0.026206
Iteration: 1821, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514005184173584, gen p mean: -0.10999032109975815, mean p set: 0.45197993516921997
loss_pred:0.015685753896832466, decouple_loss:0.0005174509133212268
The modified gen p mean: 0.4479304850101471, gen p mean: -0.11234588176012039, mean p set: 0.44850653409957886The modified gen p mean: 0.44785431027412415, gen p mean: -0.11223311722278595, mean p set: 0.44843316078186035
loss_pred:0.016105642542243004, decouple_loss:0.0005216738791204989
loss_pred:0.016568133607506752, decouple_loss:0.0005594668327830732
Iteration: 1822, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492526352405548, gen p mean: -0.11647381633520126, mean p set: 0.4498278796672821
loss_pred:0.016211535781621933, decouple_loss:0.0005260631442070007
The modified gen p mean: 0.4501858651638031, gen p mean: -0.11726674437522888, mean p set: 0.4507615268230438The modified gen p mean: 0.4476727247238159, gen p mean: -0.11814773827791214, mean p set: 0.4482481777667999
loss_pred:0.016097981482744217, decouple_loss:0.0005011687171645463
loss_pred:0.01631322130560875, decouple_loss:0.000527820666320622
Iteration: 1823, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501461982727051, gen p mean: -0.12271057814359665, mean p set: 0.450724720954895
loss_pred:0.015212872065603733, decouple_loss:0.0009610772249288857
The modified gen p mean: 0.44825685024261475, gen p mean: -0.11884497851133347, mean p set: 0.44883227348327637
loss_pred:0.01621118001639843, decouple_loss:0.0005645480705425143
The modified gen p mean: 0.4496069550514221, gen p mean: -0.12026398628950119, mean p set: 0.45018160343170166
loss_pred:0.016256505623459816, decouple_loss:0.0006899080472066998
Iteration: 1824, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448962539434433, gen p mean: -0.12423966079950333, mean p set: 0.4495377540588379
loss_pred:0.01624554768204689, decouple_loss:0.000523134192917496
The modified gen p mean: 0.4504271149635315, gen p mean: -0.11924825608730316, mean p set: 0.4510028660297394
loss_pred:0.01519029401242733, decouple_loss:0.0005636698333546519
The modified gen p mean: 0.4535980820655823, gen p mean: -0.11904652416706085, mean p set: 0.45417720079421997
loss_pred:0.01631404086947441, decouple_loss:0.0004499717033468187
Iteration: 1825, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517943561077118, gen p mean: -0.12897516787052155, mean p set: 0.45237189531326294
loss_pred:0.01610797643661499, decouple_loss:0.001214160700328648
The modified gen p mean: 0.4510912299156189, gen p mean: -0.12932629883289337, mean p set: 0.4516671597957611
loss_pred:0.016344668343663216, decouple_loss:0.0006828815094195306
The modified gen p mean: 0.4534420967102051, gen p mean: -0.1302289366722107, mean p set: 0.4540169835090637
loss_pred:0.015132647007703781, decouple_loss:0.0007266451139003038
Iteration: 1826, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44907188415527344, gen p mean: -0.12663941085338593, mean p set: 0.44964808225631714
loss_pred:0.016792036592960358, decouple_loss:0.0006404778687283397
The modified gen p mean: 0.45226189494132996, gen p mean: -0.12832045555114746, mean p set: 0.4528384804725647
loss_pred:0.015298432670533657, decouple_loss:0.0009915790287777781
The modified gen p mean: 0.4501781463623047, gen p mean: -0.12591223418712616, mean p set: 0.45075568556785583
loss_pred:0.015376881696283817, decouple_loss:0.0006546816439367831
Iteration: 1827, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45026567578315735, gen p mean: -0.12337367981672287, mean p set: 0.4508405923843384
loss_pred:0.015071551315486431, decouple_loss:0.0005127789918333292
The modified gen p mean: 0.45041248202323914, gen p mean: -0.12269327044487, mean p set: 0.4509917199611664
loss_pred:0.015510432422161102, decouple_loss:0.0005802974919788539
The modified gen p mean: 0.44884636998176575, gen p mean: -0.1301003396511078, mean p set: 0.44942015409469604
loss_pred:0.01644495129585266, decouple_loss:0.0005267012165859342
Iteration: 1828, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526766538619995, gen p mean: -0.12027803063392639, mean p set: 0.4532550275325775
loss_pred:0.015370642766356468, decouple_loss:0.0007371313986368477
The modified gen p mean: 0.44953984022140503, gen p mean: -0.12846656143665314, mean p set: 0.4501151144504547
loss_pred:0.01646120846271515, decouple_loss:0.0007375294808298349
The modified gen p mean: 0.4526787996292114, gen p mean: -0.12182136625051498, mean p set: 0.45325586199760437
loss_pred:0.015787824988365173, decouple_loss:0.0005866788560524583
Iteration: 1829, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4537748396396637, gen p mean: -0.12306918948888779, mean p set: 0.4543490707874298
loss_pred:0.015066380612552166, decouple_loss:0.0007163815316744149
The modified gen p mean: 0.4505550265312195, gen p mean: -0.12521585822105408, mean p set: 0.45113280415534973
loss_pred:0.014781461097300053, decouple_loss:0.0007337438291870058
The modified gen p mean: 0.4495176076889038, gen p mean: -0.12550164759159088, mean p set: 0.45009464025497437
loss_pred:0.01606600172817707, decouple_loss:0.0005893235211260617
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012005_3_24hr.npz
NaN value num: 0
Iteration: 1830, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511459767818451, gen p mean: -0.12193115055561066, mean p set: 0.45172742009162903The modified gen p mean: 0.4504391849040985, gen p mean: -0.121888168156147, mean p set: 0.4510160982608795
loss_pred:0.01688855141401291, decouple_loss:0.0006490438245236874loss_pred:0.01678885519504547, decouple_loss:0.0005994912353344262
The modified gen p mean: 0.4509594440460205, gen p mean: -0.12064998596906662, mean p set: 0.4515374004840851
loss_pred:0.017110982909798622, decouple_loss:0.0006196813192218542
2023-05-01 22:41:14 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1269657462835312, mean p set: 0.4502691626548767
loss_pred:0.01713480055332184, decouple_loss:0.0007839592872187495
The modified gen p mean: 0.4495340585708618, gen p mean: -0.12154403328895569, mean p set: 0.4500633478164673
loss_pred:0.016447272151708603, decouple_loss:0.0006475216359831393
The modified gen p mean: 0.4497830271720886, gen p mean: -0.12093458324670792, mean p set: 0.45035696029663086
loss_pred:0.0166741032153368, decouple_loss:0.000677995674777776
WV_1_PC_1_EH_0_PS_40, loss: 0.016787216067314148, avg_mse: 0.026162168011069298
current test mse: 0.026162
Iteration: 1831, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450828492641449, gen p mean: -0.11520395427942276, mean p set: 0.4514060616493225
loss_pred:0.017283432185649872, decouple_loss:0.0005448908195830882
The modified gen p mean: 0.45128700137138367, gen p mean: -0.1162608191370964, mean p set: 0.4518622159957886
loss_pred:0.01682157628238201, decouple_loss:0.0006688567227683961
The modified gen p mean: 0.4512358605861664, gen p mean: -0.11945585161447525, mean p set: 0.45181164145469666
loss_pred:0.017165319994091988, decouple_loss:0.0006052193930372596
Iteration: 1832, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4528052806854248, gen p mean: -0.11727600544691086, mean p set: 0.45338475704193115
loss_pred:0.01644209399819374, decouple_loss:0.0005922585842199624
The modified gen p mean: 0.45164865255355835, gen p mean: -0.11547844111919403, mean p set: 0.45222604274749756The modified gen p mean: 0.4518199861049652, gen p mean: -0.11887756735086441, mean p set: 0.45239734649658203
loss_pred:0.01676741987466812, decouple_loss:0.0006924201734364033loss_pred:0.017519818618893623, decouple_loss:0.0005472388002090156
Iteration: 1833, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45100802183151245, gen p mean: -0.11468885838985443, mean p set: 0.45158541202545166
loss_pred:0.016921894624829292, decouple_loss:0.0007908752304501832
The modified gen p mean: 0.4509246349334717, gen p mean: -0.11482514441013336, mean p set: 0.4514998197555542
loss_pred:0.016947496682405472, decouple_loss:0.0007631916669197381
The modified gen p mean: 0.4522055685520172, gen p mean: -0.11324883252382278, mean p set: 0.45278200507164
loss_pred:0.01633407548069954, decouple_loss:0.0007240864215418696
Iteration: 1834, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508289694786072, gen p mean: -0.11200334131717682, mean p set: 0.4514080286026001
loss_pred:0.017166772857308388, decouple_loss:0.0004841040354222059
The modified gen p mean: 0.45145851373672485, gen p mean: -0.11287086457014084, mean p set: 0.45203498005867004
loss_pred:0.016771607100963593, decouple_loss:0.0009132255800068378
The modified gen p mean: 0.4509308636188507, gen p mean: -0.11490065604448318, mean p set: 0.451505571603775
loss_pred:0.01650303602218628, decouple_loss:0.0005135498940944672
Iteration: 1835, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504750370979309, gen p mean: -0.11114051938056946, mean p set: 0.45105281472206116
loss_pred:0.015282402746379375, decouple_loss:0.0004880750784650445
The modified gen p mean: 0.45051029324531555, gen p mean: -0.11453843116760254, mean p set: 0.45108652114868164
loss_pred:0.01799345202744007, decouple_loss:0.0005955601809546351
The modified gen p mean: 0.45063692331314087, gen p mean: -0.11036595702171326, mean p set: 0.4512137174606323
loss_pred:0.015562605112791061, decouple_loss:0.0005297609022818506
Iteration: 1836, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511112868785858, gen p mean: -0.11685541272163391, mean p set: 0.4516860842704773
loss_pred:0.016638733446598053, decouple_loss:0.0007080719224177301
The modified gen p mean: 0.4515353739261627, gen p mean: -0.11664731800556183, mean p set: 0.45211273431777954
loss_pred:0.016992438584566116, decouple_loss:0.0006367899477481842
The modified gen p mean: 0.45080462098121643, gen p mean: -0.12228477746248245, mean p set: 0.4513830542564392
loss_pred:0.01694609969854355, decouple_loss:0.0010292684892192483
Iteration: 1837, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512188136577606, gen p mean: -0.1180802658200264, mean p set: 0.4517945945262909
loss_pred:0.015299219638109207, decouple_loss:0.0007047906401567161
The modified gen p mean: 0.45087429881095886, gen p mean: -0.1119493618607521, mean p set: 0.45145145058631897
loss_pred:0.01660040393471718, decouple_loss:0.00063773721922189
The modified gen p mean: 0.4493153691291809, gen p mean: -0.11864273995161057, mean p set: 0.4498913586139679
loss_pred:0.01581718400120735, decouple_loss:0.0005840783123858273
Iteration: 1838, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139744877815247, gen p mean: -0.1169547289609909, mean p set: 0.45197397470474243
loss_pred:0.015330269932746887, decouple_loss:0.0006209475104697049
The modified gen p mean: 0.4505300521850586, gen p mean: -0.11332786828279495, mean p set: 0.4511098861694336
loss_pred:0.017277685925364494, decouple_loss:0.0006386820459738374
The modified gen p mean: 0.45030486583709717, gen p mean: -0.10958439856767654, mean p set: 0.45088016986846924
loss_pred:0.016390075907111168, decouple_loss:0.000630141410510987
Iteration: 1839, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45146065950393677, gen p mean: -0.10861086845397949, mean p set: 0.4520331025123596
loss_pred:0.01674720272421837, decouple_loss:0.0005634268163703382
The modified gen p mean: 0.4509115219116211, gen p mean: -0.10524897277355194, mean p set: 0.45148617029190063
loss_pred:0.016385290771722794, decouple_loss:0.0006487980717793107
The modified gen p mean: 0.45212027430534363, gen p mean: -0.1145973950624466, mean p set: 0.45269879698753357
loss_pred:0.01590924710035324, decouple_loss:0.0006409207708202302
Iteration: 1840, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517172574996948, gen p mean: -0.1119610145688057, mean p set: 0.4522937834262848
loss_pred:0.015556680038571358, decouple_loss:0.0005630496307276189
The modified gen p mean: 0.4518192708492279, gen p mean: -0.11696216464042664, mean p set: 0.45239561796188354
loss_pred:0.015950173139572144, decouple_loss:0.0005526553723029792
The modified gen p mean: 0.4502677023410797, gen p mean: -0.11392645537853241, mean p set: 0.4508439898490906
loss_pred:0.015456557273864746, decouple_loss:0.0005720523186028004
2023-05-01 22:43:18 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1182778999209404, mean p set: 0.4502691626548767
loss_pred:0.01733403094112873, decouple_loss:0.0007568305591121316
The modified gen p mean: 0.44953596591949463, gen p mean: -0.11285790801048279, mean p set: 0.4500633478164673
loss_pred:0.016457574442029, decouple_loss:0.0006584427901543677
The modified gen p mean: 0.44977980852127075, gen p mean: -0.11255085468292236, mean p set: 0.45035696029663086
loss_pred:0.016720261424779892, decouple_loss:0.0006965083302929997
WV_1_PC_1_EH_0_PS_40, loss: 0.016872486099600792, avg_mse: 0.02622203901410103
current test mse: 0.026222
Iteration: 1841, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45081812143325806, gen p mean: -0.10365802049636841, mean p set: 0.4513946771621704
loss_pred:0.01615033857524395, decouple_loss:0.0006255985354073346
The modified gen p mean: 0.4505464434623718, gen p mean: -0.10861223191022873, mean p set: 0.4511229395866394
loss_pred:0.016756992787122726, decouple_loss:0.00046180235221982
The modified gen p mean: 0.45110225677490234, gen p mean: -0.10449451953172684, mean p set: 0.4516793489456177
loss_pred:0.017117878422141075, decouple_loss:0.0006126681691966951
Iteration: 1842, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45096075534820557, gen p mean: -0.1143094152212143, mean p set: 0.45154067873954773
loss_pred:0.016973700374364853, decouple_loss:0.0007610054453834891
The modified gen p mean: 0.45117321610450745, gen p mean: -0.10712537914514542, mean p set: 0.45174819231033325The modified gen p mean: 0.4514467418193817, gen p mean: -0.11195472627878189, mean p set: 0.4520242512226105
loss_pred:0.016902552917599678, decouple_loss:0.0008049504249356687
loss_pred:0.015794821083545685, decouple_loss:0.0006932695396244526
Iteration: 1843, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509276747703552, gen p mean: -0.11094299703836441, mean p set: 0.4515029489994049
The modified gen p mean: 0.45097437500953674, gen p mean: -0.11119082570075989, mean p set: 0.4515528082847595
loss_pred:0.015507392585277557, decouple_loss:0.00055612315190956
loss_pred:0.016984587535262108, decouple_loss:0.0006459287251345813The modified gen p mean: 0.451072096824646, gen p mean: -0.10887017846107483, mean p set: 0.45164790749549866
loss_pred:0.016352789476513863, decouple_loss:0.0005618679570034146
Iteration: 1844, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45019394159317017, gen p mean: -0.12163876742124557, mean p set: 0.4507710039615631
loss_pred:0.016696589067578316, decouple_loss:0.000545501068700105
The modified gen p mean: 0.4523441791534424, gen p mean: -0.11460086703300476, mean p set: 0.4529227614402771
loss_pred:0.016927754506468773, decouple_loss:0.0008637239807285368
The modified gen p mean: 0.44994866847991943, gen p mean: -0.11835825443267822, mean p set: 0.45052260160446167
loss_pred:0.016191771253943443, decouple_loss:0.00042375654447823763
Iteration: 1845, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523014426231384, gen p mean: -0.12521733343601227, mean p set: 0.4528789222240448
loss_pred:0.016296816989779472, decouple_loss:0.0004832417471334338
The modified gen p mean: 0.450509637594223, gen p mean: -0.11944132298231125, mean p set: 0.45108845829963684
loss_pred:0.016057249158620834, decouple_loss:0.0005734937149100006
The modified gen p mean: 0.45130130648612976, gen p mean: -0.12129167467355728, mean p set: 0.45187801122665405
loss_pred:0.017045916989445686, decouple_loss:0.0007086035911925137
Iteration: 1846, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513394832611084, gen p mean: -0.129985049366951, mean p set: 0.4519181549549103
The modified gen p mean: 0.45228564739227295, gen p mean: -0.12207689136266708, mean p set: 0.4528633952140808
loss_pred:0.015204194001853466, decouple_loss:0.0005775712779723108
loss_pred:0.01668216846883297, decouple_loss:0.0005816531484015286
The modified gen p mean: 0.4508408308029175, gen p mean: -0.12738069891929626, mean p set: 0.45141565799713135
loss_pred:0.016718057915568352, decouple_loss:0.0006691761664114892
Iteration: 1847, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501853585243225, gen p mean: -0.12960052490234375, mean p set: 0.45076268911361694
loss_pred:0.016899913549423218, decouple_loss:0.0004789730883203447
The modified gen p mean: 0.45139214396476746, gen p mean: -0.1253461092710495, mean p set: 0.45197105407714844
The modified gen p mean: 0.4510834217071533, gen p mean: -0.13259178400039673, mean p set: 0.45166081190109253
loss_pred:0.01652025431394577, decouple_loss:0.00044863420771434903
loss_pred:0.016416914761066437, decouple_loss:0.0004017619357910007
Iteration: 1848, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527977406978607, gen p mean: -0.1336740404367447, mean p set: 0.45337486267089844
loss_pred:0.0160142220556736, decouple_loss:0.0005564420716837049
The modified gen p mean: 0.45070916414260864, gen p mean: -0.12737178802490234, mean p set: 0.4512825310230255
loss_pred:0.015953224152326584, decouple_loss:0.000574135163333267
The modified gen p mean: 0.4526633620262146, gen p mean: -0.13161306083202362, mean p set: 0.4532400667667389
loss_pred:0.017354728654026985, decouple_loss:0.0005776408943347633
Iteration: 1849, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45123884081840515, gen p mean: -0.1293751746416092, mean p set: 0.45181748270988464
loss_pred:0.016823649406433105, decouple_loss:0.00046634802129119635
The modified gen p mean: 0.4523102641105652, gen p mean: -0.13331888616085052, mean p set: 0.45288771390914917
The modified gen p mean: 0.45200496912002563, gen p mean: -0.1322554349899292, mean p set: 0.45258012413978577
loss_pred:0.01728045381605625, decouple_loss:0.0005223996704444289
loss_pred:0.016440732404589653, decouple_loss:0.0006475806003436446
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012000_3_24hr.npz
NaN value num: 0
Iteration: 1850, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45317912101745605, gen p mean: -0.13003315031528473, mean p set: 0.45375457406044006
loss_pred:0.016286345198750496, decouple_loss:0.0008622719906270504
The modified gen p mean: 0.4507816433906555, gen p mean: -0.1310209333896637, mean p set: 0.4513586759567261
The modified gen p mean: 0.45042145252227783, gen p mean: -0.13023552298545837, mean p set: 0.45099693536758423
loss_pred:0.015457624569535255, decouple_loss:0.0005871045286767185
loss_pred:0.014864489436149597, decouple_loss:0.0005903973942622542
2023-05-01 22:46:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1367596834897995, mean p set: 0.4502691626548767
loss_pred:0.01723414845764637, decouple_loss:0.0007162707624956965
The modified gen p mean: 0.4495339095592499, gen p mean: -0.13064445555210114, mean p set: 0.4500633478164673
loss_pred:0.016448985785245895, decouple_loss:0.0007220583502203226
The modified gen p mean: 0.4497782588005066, gen p mean: -0.12968957424163818, mean p set: 0.45035696029663086
loss_pred:0.016673630103468895, decouple_loss:0.0007060041534714401
WV_1_PC_1_EH_0_PS_40, loss: 0.016821328550577164, avg_mse: 0.02622649446129799
current test mse: 0.026226
Iteration: 1851, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45091935992240906, gen p mean: -0.1236557587981224, mean p set: 0.45149585604667664
loss_pred:0.015871303156018257, decouple_loss:0.0006779576069675386
The modified gen p mean: 0.4498497247695923, gen p mean: -0.12489218264818192, mean p set: 0.4504260718822479
loss_pred:0.016048189252614975, decouple_loss:0.000723473378457129
The modified gen p mean: 0.4514850378036499, gen p mean: -0.12807147204875946, mean p set: 0.45205995440483093
loss_pred:0.015975676476955414, decouple_loss:0.0007847650558687747
Iteration: 1852, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517090320587158, gen p mean: -0.12178996205329895, mean p set: 0.45228278636932373
loss_pred:0.015031038783490658, decouple_loss:0.000582499778829515
The modified gen p mean: 0.4505753517150879, gen p mean: -0.1188497468829155, mean p set: 0.4511524438858032The modified gen p mean: 0.45085886120796204, gen p mean: -0.12232138216495514, mean p set: 0.4514361619949341
loss_pred:0.015536515973508358, decouple_loss:0.0006767780869267881
loss_pred:0.015228649601340294, decouple_loss:0.0006303715636022389
Iteration: 1853, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44897985458374023, gen p mean: -0.11803429573774338, mean p set: 0.449554443359375
loss_pred:0.016571899875998497, decouple_loss:0.0007640766561962664
The modified gen p mean: 0.45073261857032776, gen p mean: -0.11207688599824905, mean p set: 0.4513106644153595The modified gen p mean: 0.4503597915172577, gen p mean: -0.1187555119395256, mean p set: 0.4509369432926178
loss_pred:0.015179942362010479, decouple_loss:0.0006791570340283215
loss_pred:0.015012585557997227, decouple_loss:0.0005187063361518085
Iteration: 1854, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502236247062683, gen p mean: -0.11462963372468948, mean p set: 0.4507984220981598
loss_pred:0.015568198636174202, decouple_loss:0.0005276823067106307
The modified gen p mean: 0.4518645405769348, gen p mean: -0.11562373489141464, mean p set: 0.45244479179382324
loss_pred:0.015444538556039333, decouple_loss:0.0005505076260305941
The modified gen p mean: 0.44902628660202026, gen p mean: -0.11688312143087387, mean p set: 0.44960182905197144
loss_pred:0.016108322888612747, decouple_loss:0.000532556907273829
Iteration: 1855, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500185549259186, gen p mean: -0.11538044363260269, mean p set: 0.4505949914455414
loss_pred:0.016361162066459656, decouple_loss:0.0007946581463329494
The modified gen p mean: 0.4503853917121887, gen p mean: -0.11078827828168869, mean p set: 0.45096179842948914
loss_pred:0.015826312825083733, decouple_loss:0.0007235539960674942
The modified gen p mean: 0.4493773877620697, gen p mean: -0.11304346472024918, mean p set: 0.4499543607234955
loss_pred:0.015240615233778954, decouple_loss:0.0005336637259460986
Iteration: 1856, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519042372703552, gen p mean: -0.11768128722906113, mean p set: 0.45248204469680786
loss_pred:0.01505342312157154, decouple_loss:0.0005566783365793526
The modified gen p mean: 0.44962817430496216, gen p mean: -0.11636808514595032, mean p set: 0.4502032399177551
The modified gen p mean: 0.45128464698791504, gen p mean: -0.11514240503311157, mean p set: 0.4518622159957886
loss_pred:0.016127534210681915, decouple_loss:0.0005724625661969185
loss_pred:0.015674566850066185, decouple_loss:0.000484305783174932
Iteration: 1857, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501333236694336, gen p mean: -0.11425352841615677, mean p set: 0.45071083307266235
loss_pred:0.014800735749304295, decouple_loss:0.0007164409034885466
The modified gen p mean: 0.44910964369773865, gen p mean: -0.11932222545146942, mean p set: 0.4496879279613495
The modified gen p mean: 0.4506790339946747, gen p mean: -0.11317531019449234, mean p set: 0.45125675201416016
loss_pred:0.01627536676824093, decouple_loss:0.0007112015155144036
loss_pred:0.015340084210038185, decouple_loss:0.0007941280491650105
Iteration: 1858, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45195472240448, gen p mean: -0.11840701103210449, mean p set: 0.45253023505210876
loss_pred:0.01522985752671957, decouple_loss:0.0008420625235885382
The modified gen p mean: 0.4520522654056549, gen p mean: -0.12588666379451752, mean p set: 0.4526314437389374
The modified gen p mean: 0.45176103711128235, gen p mean: -0.12059488147497177, mean p set: 0.4523402452468872
loss_pred:0.015111520886421204, decouple_loss:0.0005566899199038744
loss_pred:0.015481877140700817, decouple_loss:0.0008316009771078825
Iteration: 1859, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502457082271576, gen p mean: -0.11817426234483719, mean p set: 0.4508242905139923
loss_pred:0.015034252777695656, decouple_loss:0.000713864341378212
The modified gen p mean: 0.4508573114871979, gen p mean: -0.12172669172286987, mean p set: 0.4514320194721222
The modified gen p mean: 0.45304277539253235, gen p mean: -0.11949509382247925, mean p set: 0.45362117886543274
loss_pred:0.015578300692141056, decouple_loss:0.0006285540293902159
loss_pred:0.015984583646059036, decouple_loss:0.0006286518182605505
Iteration: 1860, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510950744152069, gen p mean: -0.12299888581037521, mean p set: 0.45167064666748047
loss_pred:0.01501836534589529, decouple_loss:0.0008051355252973735
The modified gen p mean: 0.4499634802341461, gen p mean: -0.11948148906230927, mean p set: 0.45053830742836
loss_pred:0.01496891863644123, decouple_loss:0.0005457763327285647
The modified gen p mean: 0.4507816433906555, gen p mean: -0.1216990277171135, mean p set: 0.45135921239852905
loss_pred:0.015468518249690533, decouple_loss:0.0006188218831084669
2023-05-01 22:48:11 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13021263480186462, mean p set: 0.4502691626548767
loss_pred:0.01723727025091648, decouple_loss:0.00047480352804996073
The modified gen p mean: 0.4495333135128021, gen p mean: -0.12400614470243454, mean p set: 0.4500633478164673
loss_pred:0.016558554023504257, decouple_loss:0.0004723953315988183
The modified gen p mean: 0.4497821629047394, gen p mean: -0.12337769567966461, mean p set: 0.45035696029663086
loss_pred:0.016675632447004318, decouple_loss:0.0005269013927318156
WV_1_PC_1_EH_0_PS_40, loss: 0.01684838905930519, avg_mse: 0.026222631335258484
current test mse: 0.026223
Iteration: 1861, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522721469402313, gen p mean: -0.11882376670837402, mean p set: 0.45284903049468994
loss_pred:0.015807965770363808, decouple_loss:0.0005828731809742749
The modified gen p mean: 0.45166414976119995, gen p mean: -0.12478842586278915, mean p set: 0.45224204659461975
loss_pred:0.015011865645647049, decouple_loss:0.0006369065376929939
The modified gen p mean: 0.45129650831222534, gen p mean: -0.12001907825469971, mean p set: 0.45187288522720337
loss_pred:0.015478886663913727, decouple_loss:0.0006012577214278281
Iteration: 1862, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45050644874572754, gen p mean: -0.11421433836221695, mean p set: 0.4510842561721802
The modified gen p mean: 0.4493199288845062, gen p mean: -0.11676415801048279, mean p set: 0.4498947560787201
loss_pred:0.014615473337471485, decouple_loss:0.0005248327506706119
loss_pred:0.015568881295621395, decouple_loss:0.000648166227620095
The modified gen p mean: 0.4513114094734192, gen p mean: -0.11914490908384323, mean p set: 0.4518887996673584
loss_pred:0.014671353623270988, decouple_loss:0.0005798368365503848
Iteration: 1863, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45130863785743713, gen p mean: -0.11340439319610596, mean p set: 0.4518847167491913
The modified gen p mean: 0.45046553015708923, gen p mean: -0.1127382218837738, mean p set: 0.45104217529296875
loss_pred:0.015213888138532639, decouple_loss:0.00046822201693430543
loss_pred:0.015450595878064632, decouple_loss:0.0004150833992753178
The modified gen p mean: 0.4482435882091522, gen p mean: -0.11693666875362396, mean p set: 0.4488172233104706
loss_pred:0.015494517050683498, decouple_loss:0.0005521068815141916
Iteration: 1864, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525832533836365, gen p mean: -0.1093076542019844, mean p set: 0.4531586468219757
loss_pred:0.015229759737849236, decouple_loss:0.0006796086672693491
The modified gen p mean: 0.4511650502681732, gen p mean: -0.10675803571939468, mean p set: 0.45174074172973633
loss_pred:0.014837331138551235, decouple_loss:0.0005806077388115227
The modified gen p mean: 0.45044806599617004, gen p mean: -0.1092696487903595, mean p set: 0.4510226845741272
loss_pred:0.015104596503078938, decouple_loss:0.0006116896402090788
Iteration: 1865, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45119422674179077, gen p mean: -0.10932067036628723, mean p set: 0.4517684876918793
loss_pred:0.015068220905959606, decouple_loss:0.0006205104873515666
The modified gen p mean: 0.44933199882507324, gen p mean: -0.10759836435317993, mean p set: 0.4499072730541229
loss_pred:0.014793379232287407, decouple_loss:0.0004066916008014232
The modified gen p mean: 0.449593722820282, gen p mean: -0.10904671996831894, mean p set: 0.4501703083515167
loss_pred:0.014932060614228249, decouple_loss:0.00038255282561294734
Iteration: 1866, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159631967544556, gen p mean: -0.10993543267250061, mean p set: 0.45217224955558777
loss_pred:0.015079207718372345, decouple_loss:0.0005087308818474412
The modified gen p mean: 0.45045042037963867, gen p mean: -0.10921783000230789, mean p set: 0.4510255753993988
loss_pred:0.014883586205542088, decouple_loss:0.0007414042484015226
The modified gen p mean: 0.45159846544265747, gen p mean: -0.10589979588985443, mean p set: 0.45217567682266235
loss_pred:0.014988106675446033, decouple_loss:0.0004987391293980181
Iteration: 1867, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508954584598541, gen p mean: -0.11145841330289841, mean p set: 0.45147067308425903
The modified gen p mean: 0.4507184326648712, gen p mean: -0.11277281492948532, mean p set: 0.45129311084747314
loss_pred:0.014901121146976948, decouple_loss:0.000498725101351738
loss_pred:0.014887874945998192, decouple_loss:0.0004654557560570538
The modified gen p mean: 0.44999587535858154, gen p mean: -0.1111392229795456, mean p set: 0.45057356357574463
loss_pred:0.016211623325943947, decouple_loss:0.0005092042265459895
Iteration: 1868, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45021235942840576, gen p mean: -0.11173014342784882, mean p set: 0.4507897198200226
The modified gen p mean: 0.45087307691574097, gen p mean: -0.11347079277038574, mean p set: 0.45144835114479065
loss_pred:0.014906513504683971, decouple_loss:0.00046643902896903455
loss_pred:0.015543034300208092, decouple_loss:0.0006000633002258837
The modified gen p mean: 0.4508749544620514, gen p mean: -0.11760919541120529, mean p set: 0.4514505863189697
loss_pred:0.014890886843204498, decouple_loss:0.0004976936033926904
Iteration: 1869, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516226053237915, gen p mean: -0.119644895195961, mean p set: 0.45220106840133667The modified gen p mean: 0.45178693532943726, gen p mean: -0.11674626171588898, mean p set: 0.4523625671863556
loss_pred:0.015278241597115993, decouple_loss:0.0005758830811828375
loss_pred:0.015999382361769676, decouple_loss:0.0007532500312663615
The modified gen p mean: 0.45090073347091675, gen p mean: -0.11484780162572861, mean p set: 0.4514783024787903
loss_pred:0.015923840925097466, decouple_loss:0.0007703774608671665
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012009_3_24hr.npz
NaN value num: 0
Iteration: 1870, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470852315425873, gen p mean: -0.12295298278331757, mean p set: 0.4476620852947235
loss_pred:0.016893742606043816, decouple_loss:0.0005103925941511989
The modified gen p mean: 0.4473250210285187, gen p mean: -0.12676367163658142, mean p set: 0.4478999078273773
The modified gen p mean: 0.4473142623901367, gen p mean: -0.12441958487033844, mean p set: 0.4478892683982849
loss_pred:0.01772579737007618, decouple_loss:0.0006288749282248318
loss_pred:0.016638774424791336, decouple_loss:0.0004960824153386056
2023-05-01 22:50:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13642975687980652, mean p set: 0.4502691626548767
loss_pred:0.01723371259868145, decouple_loss:0.0006646016845479608
The modified gen p mean: 0.449533075094223, gen p mean: -0.13008321821689606, mean p set: 0.4500633478164673
loss_pred:0.01655675284564495, decouple_loss:0.0005487965536303818
The modified gen p mean: 0.44978460669517517, gen p mean: -0.12941806018352509, mean p set: 0.45035696029663086
loss_pred:0.016660645604133606, decouple_loss:0.0005217936122789979
WV_1_PC_1_EH_0_PS_40, loss: 0.016845956444740295, avg_mse: 0.026192309334874153
current test mse: 0.026192
Iteration: 1871, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471738040447235, gen p mean: -0.13624051213264465, mean p set: 0.447747141122818
loss_pred:0.017252732068300247, decouple_loss:0.0008552918443456292
The modified gen p mean: 0.4463057518005371, gen p mean: -0.12550285458564758, mean p set: 0.44688549637794495The modified gen p mean: 0.4471612572669983, gen p mean: -0.1304463893175125, mean p set: 0.4477372169494629
loss_pred:0.018770411610603333, decouple_loss:0.000724524725228548
loss_pred:0.017666514962911606, decouple_loss:0.0007240333943627775
Iteration: 1872, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462061822414398, gen p mean: -0.12978234887123108, mean p set: 0.4467800557613373
The modified gen p mean: 0.44802334904670715, gen p mean: -0.13863542675971985, mean p set: 0.4485994875431061loss_pred:0.017945382744073868, decouple_loss:0.0005855454946868122
loss_pred:0.01744469255208969, decouple_loss:0.0006055907579138875
The modified gen p mean: 0.4469905495643616, gen p mean: -0.1298106163740158, mean p set: 0.44756776094436646
loss_pred:0.01725887320935726, decouple_loss:0.0005765824462287128
Iteration: 1873, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44875478744506836, gen p mean: -0.13555918633937836, mean p set: 0.4493309259414673
loss_pred:0.01748151145875454, decouple_loss:0.0005730950506404042
The modified gen p mean: 0.44732046127319336, gen p mean: -0.13040468096733093, mean p set: 0.44789931178092957
loss_pred:0.016561221331357956, decouple_loss:0.0005800860235467553
The modified gen p mean: 0.4476594626903534, gen p mean: -0.1346900314092636, mean p set: 0.4482364058494568
loss_pred:0.01737924851477146, decouple_loss:0.0005770932766608894
Iteration: 1874, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44747021794319153, gen p mean: -0.12998946011066437, mean p set: 0.4480472505092621
loss_pred:0.016723856329917908, decouple_loss:0.000814920524135232
The modified gen p mean: 0.44938021898269653, gen p mean: -0.12878039479255676, mean p set: 0.449957937002182
loss_pred:0.015894101932644844, decouple_loss:0.0005946118617430329
The modified gen p mean: 0.4470415711402893, gen p mean: -0.12915052473545074, mean p set: 0.4476177394390106
loss_pred:0.016802193596959114, decouple_loss:0.0007867156527936459
Iteration: 1875, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484887421131134, gen p mean: -0.1368436962366104, mean p set: 0.449065238237381
The modified gen p mean: 0.44831374287605286, gen p mean: -0.13353025913238525, mean p set: 0.4488883912563324
loss_pred:0.017641689628362656, decouple_loss:0.0005176848499104381
loss_pred:0.01760368049144745, decouple_loss:0.0005239542224444449
The modified gen p mean: 0.44668540358543396, gen p mean: -0.12809845805168152, mean p set: 0.44726279377937317
loss_pred:0.017978908494114876, decouple_loss:0.0005252060946077108
Iteration: 1876, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474717080593109, gen p mean: -0.1308223456144333, mean p set: 0.4480498135089874
loss_pred:0.01704361103475094, decouple_loss:0.0004803637566510588
The modified gen p mean: 0.4475739002227783, gen p mean: -0.12768685817718506, mean p set: 0.4481465220451355
The modified gen p mean: 0.44911184906959534, gen p mean: -0.13230060040950775, mean p set: 0.4496842920780182
loss_pred:0.01638762280344963, decouple_loss:0.00047882605576887727
loss_pred:0.016083039343357086, decouple_loss:0.0005225445493124425
Iteration: 1877, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804736971855164, gen p mean: -0.12654219567775726, mean p set: 0.4486234486103058
loss_pred:0.016621828079223633, decouple_loss:0.0005078865215182304
The modified gen p mean: 0.44853731989860535, gen p mean: -0.13349364697933197, mean p set: 0.4491124749183655
loss_pred:0.016637047752738, decouple_loss:0.0007094620959833264
The modified gen p mean: 0.44677507877349854, gen p mean: -0.12497773766517639, mean p set: 0.4473509192466736
loss_pred:0.01737041398882866, decouple_loss:0.0004992732428945601
Iteration: 1878, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472251832485199, gen p mean: -0.12926875054836273, mean p set: 0.44780290126800537
loss_pred:0.01707008294761181, decouple_loss:0.0004802559269592166
The modified gen p mean: 0.4475270211696625, gen p mean: -0.129173144698143, mean p set: 0.44810381531715393
loss_pred:0.0169760063290596, decouple_loss:0.00042584093171171844
The modified gen p mean: 0.4500066637992859, gen p mean: -0.13042177259922028, mean p set: 0.45058512687683105
loss_pred:0.016409171745181084, decouple_loss:0.0006220005452632904
Iteration: 1879, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467739760875702, gen p mean: -0.12876580655574799, mean p set: 0.44734886288642883
loss_pred:0.016797207295894623, decouple_loss:0.000736334768589586
The modified gen p mean: 0.4469892084598541, gen p mean: -0.13591651618480682, mean p set: 0.44756510853767395
loss_pred:0.016360916197299957, decouple_loss:0.0006746564758941531
The modified gen p mean: 0.4465157687664032, gen p mean: -0.12810564041137695, mean p set: 0.4470905661582947
loss_pred:0.016971301287412643, decouple_loss:0.0005559340352192521
Iteration: 1880, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482004940509796, gen p mean: -0.12940584123134613, mean p set: 0.4487774670124054
loss_pred:0.0159145537763834, decouple_loss:0.0005755380843766034
The modified gen p mean: 0.4469280540943146, gen p mean: -0.1321587860584259, mean p set: 0.4475059509277344
loss_pred:0.017654765397310257, decouple_loss:0.0008610335062257946
The modified gen p mean: 0.44699719548225403, gen p mean: -0.12984317541122437, mean p set: 0.4475730061531067
loss_pred:0.016697976738214493, decouple_loss:0.000519883877132088
2023-05-01 22:52:58 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13578863441944122, mean p set: 0.4502691626548767
loss_pred:0.01718756929039955, decouple_loss:0.00046756156370975077
The modified gen p mean: 0.449535995721817, gen p mean: -0.12958376109600067, mean p set: 0.4500633478164673
loss_pred:0.01649346575140953, decouple_loss:0.0005009790183976293
The modified gen p mean: 0.4497778117656708, gen p mean: -0.1289478838443756, mean p set: 0.45035696029663086
loss_pred:0.016720840707421303, decouple_loss:0.0004814264248125255
WV_1_PC_1_EH_0_PS_40, loss: 0.016824791207909584, avg_mse: 0.02613036334514618
current test mse: 0.02613
Iteration: 1881, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44643306732177734, gen p mean: -0.12980791926383972, mean p set: 0.44700849056243896
loss_pred:0.017205635085701942, decouple_loss:0.0004522010567598045
The modified gen p mean: 0.4464074969291687, gen p mean: -0.1261528581380844, mean p set: 0.44698062539100647
loss_pred:0.017598483711481094, decouple_loss:0.0004966671112924814
The modified gen p mean: 0.4476969242095947, gen p mean: -0.12727715075016022, mean p set: 0.44827520847320557
loss_pred:0.017003297805786133, decouple_loss:0.00045904310536570847
Iteration: 1882, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464157521724701, gen p mean: -0.130558580160141, mean p set: 0.4469883143901825
loss_pred:0.01667884923517704, decouple_loss:0.0004954563919454813
The modified gen p mean: 0.4478732645511627, gen p mean: -0.12642621994018555, mean p set: 0.44844627380371094The modified gen p mean: 0.44682788848876953, gen p mean: -0.12941697239875793, mean p set: 0.44740378856658936
loss_pred:0.01653411239385605, decouple_loss:0.0005188246141187847
loss_pred:0.01676533743739128, decouple_loss:0.0005875923088751733
Iteration: 1883, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679275155067444, gen p mean: -0.12981128692626953, mean p set: 0.44736701250076294
loss_pred:0.017326194792985916, decouple_loss:0.0007116508786566556
The modified gen p mean: 0.44642195105552673, gen p mean: -0.1282392293214798, mean p set: 0.4469945430755615
loss_pred:0.016820693388581276, decouple_loss:0.0006191182183101773
The modified gen p mean: 0.4465450644493103, gen p mean: -0.1272890716791153, mean p set: 0.44712138175964355
loss_pred:0.017598871141672134, decouple_loss:0.0006478909053839743
Iteration: 1884, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4459975063800812, gen p mean: -0.12952765822410583, mean p set: 0.446577250957489
loss_pred:0.016475504264235497, decouple_loss:0.000460305018350482
The modified gen p mean: 0.4479580521583557, gen p mean: -0.12821370363235474, mean p set: 0.4485313296318054
loss_pred:0.01640486903488636, decouple_loss:0.00040166371036320925
The modified gen p mean: 0.4475903809070587, gen p mean: -0.13161058723926544, mean p set: 0.44817039370536804
loss_pred:0.01611911505460739, decouple_loss:0.0004915432655252516
Iteration: 1885, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44663265347480774, gen p mean: -0.13223005831241608, mean p set: 0.44720491766929626
loss_pred:0.017498550936579704, decouple_loss:0.0006056263227947056
The modified gen p mean: 0.44791439175605774, gen p mean: -0.1302535980939865, mean p set: 0.44848722219467163
loss_pred:0.016005782410502434, decouple_loss:0.0004890841082669795
The modified gen p mean: 0.44817861914634705, gen p mean: -0.13141724467277527, mean p set: 0.44875475764274597
loss_pred:0.016278475522994995, decouple_loss:0.0005150708020664752
Iteration: 1886, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44847363233566284, gen p mean: -0.13178864121437073, mean p set: 0.44905006885528564
loss_pred:0.016447311267256737, decouple_loss:0.0005628863000310957
The modified gen p mean: 0.4464681148529053, gen p mean: -0.1375899612903595, mean p set: 0.44704464077949524
loss_pred:0.01613866165280342, decouple_loss:0.00047416111920028925
The modified gen p mean: 0.4483320415019989, gen p mean: -0.1380590945482254, mean p set: 0.44890812039375305
loss_pred:0.015881448984146118, decouple_loss:0.0005656980210915208
Iteration: 1887, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468091130256653, gen p mean: -0.1379300206899643, mean p set: 0.4473875164985657
loss_pred:0.017888864502310753, decouple_loss:0.00045785726979374886
The modified gen p mean: 0.4456228017807007, gen p mean: -0.1361118108034134, mean p set: 0.4461957514286041
loss_pred:0.016275599598884583, decouple_loss:0.000450204563094303
The modified gen p mean: 0.4490796625614166, gen p mean: -0.142526313662529, mean p set: 0.4496566355228424
loss_pred:0.01674697920680046, decouple_loss:0.00048396908096037805
Iteration: 1888, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44746965169906616, gen p mean: -0.13792932033538818, mean p set: 0.4480447769165039
loss_pred:0.016378622502088547, decouple_loss:0.0005267602391541004
The modified gen p mean: 0.4481784999370575, gen p mean: -0.13491913676261902, mean p set: 0.44875606894493103
loss_pred:0.016349049285054207, decouple_loss:0.0006478563882410526
The modified gen p mean: 0.44666725397109985, gen p mean: -0.14089864492416382, mean p set: 0.44724392890930176
loss_pred:0.01702702045440674, decouple_loss:0.00042788274004124105
Iteration: 1889, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44570907950401306, gen p mean: -0.13769398629665375, mean p set: 0.44628363847732544
loss_pred:0.016548505052924156, decouple_loss:0.0004107229469809681
The modified gen p mean: 0.4472673833370209, gen p mean: -0.13854297995567322, mean p set: 0.4478435218334198
loss_pred:0.016912147402763367, decouple_loss:0.0006537105655297637
The modified gen p mean: 0.44777098298072815, gen p mean: -0.1405344009399414, mean p set: 0.44834578037261963
loss_pred:0.016176095232367516, decouple_loss:0.0005262033082544804
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012000_3_24hr.npz
NaN value num: 0
Iteration: 1890, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44748368859291077, gen p mean: -0.14991019666194916, mean p set: 0.448056697845459
loss_pred:0.015311898663640022, decouple_loss:0.00047483641537837684
The modified gen p mean: 0.4468746781349182, gen p mean: -0.141962468624115, mean p set: 0.44745346903800964
loss_pred:0.01633320562541485, decouple_loss:0.0005310671986080706
The modified gen p mean: 0.44659149646759033, gen p mean: -0.14084374904632568, mean p set: 0.4471677839756012
loss_pred:0.015161042101681232, decouple_loss:0.00040959962643682957
2023-05-01 22:55:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.14397400617599487, mean p set: 0.4502691626548767
loss_pred:0.017103523015975952, decouple_loss:0.0005421165260486305
The modified gen p mean: 0.4497808516025543, gen p mean: -0.1370737999677658, mean p set: 0.45035696029663086
loss_pred:0.016771463677287102, decouple_loss:0.0005327750695869327
The modified gen p mean: 0.44953709840774536, gen p mean: -0.13757716119289398, mean p set: 0.4500633478164673
loss_pred:0.016428565606474876, decouple_loss:0.0005208931397646666
WV_1_PC_1_EH_0_PS_40, loss: 0.016794446855783463, avg_mse: 0.026162873953580856
current test mse: 0.026163
Iteration: 1891, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468957781791687, gen p mean: -0.14195796847343445, mean p set: 0.4474697411060333
loss_pred:0.015300557017326355, decouple_loss:0.0007286107866093516
The modified gen p mean: 0.4474366307258606, gen p mean: -0.13763387501239777, mean p set: 0.4480137526988983The modified gen p mean: 0.4467996656894684, gen p mean: -0.14066855609416962, mean p set: 0.4473719894886017
loss_pred:0.015552202239632607, decouple_loss:0.0005661609466187656
loss_pred:0.015939993783831596, decouple_loss:0.0005054890643805265
Iteration: 1892, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446980744600296, gen p mean: -0.13719794154167175, mean p set: 0.4475601017475128
loss_pred:0.01572147198021412, decouple_loss:0.0007222010171972215
The modified gen p mean: 0.44759392738342285, gen p mean: -0.1385280042886734, mean p set: 0.4481663107872009The modified gen p mean: 0.44692742824554443, gen p mean: -0.13506722450256348, mean p set: 0.44750016927719116
loss_pred:0.01595432497560978, decouple_loss:0.0004679114790633321loss_pred:0.016824383288621902, decouple_loss:0.0005466541624628007
Iteration: 1893, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44641566276550293, gen p mean: -0.13491567969322205, mean p set: 0.4469926357269287
loss_pred:0.015622410923242569, decouple_loss:0.0004213391221128404
The modified gen p mean: 0.44788408279418945, gen p mean: -0.13375939428806305, mean p set: 0.44845691323280334
loss_pred:0.015523022972047329, decouple_loss:0.0005451125325635076
The modified gen p mean: 0.44645681977272034, gen p mean: -0.1349828541278839, mean p set: 0.4470318555831909
loss_pred:0.015249475836753845, decouple_loss:0.0005364774260669947
Iteration: 1894, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466070830821991, gen p mean: -0.1337559074163437, mean p set: 0.44718244671821594
loss_pred:0.015117338858544827, decouple_loss:0.0006014624377712607
The modified gen p mean: 0.44834792613983154, gen p mean: -0.13087362051010132, mean p set: 0.44892388582229614
loss_pred:0.016248418018221855, decouple_loss:0.0007794025004841387
The modified gen p mean: 0.44757720828056335, gen p mean: -0.13349895179271698, mean p set: 0.44815176725387573
loss_pred:0.015044918283820152, decouple_loss:0.0006057658465579152
Iteration: 1895, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44915416836738586, gen p mean: -0.13382725417613983, mean p set: 0.44973060488700867
loss_pred:0.015421869233250618, decouple_loss:0.0006731344037689269
The modified gen p mean: 0.44683125615119934, gen p mean: -0.1341855376958847, mean p set: 0.44740432500839233
loss_pred:0.015064990147948265, decouple_loss:0.0005410747253336012
The modified gen p mean: 0.44867148995399475, gen p mean: -0.13287517428398132, mean p set: 0.44924843311309814
loss_pred:0.01549895666539669, decouple_loss:0.0006895679980516434
Iteration: 1896, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44636067748069763, gen p mean: -0.13349920511245728, mean p set: 0.44693562388420105
loss_pred:0.015141752548515797, decouple_loss:0.0004947138950228691
The modified gen p mean: 0.4470062553882599, gen p mean: -0.13787874579429626, mean p set: 0.4475838840007782
loss_pred:0.015275654383003712, decouple_loss:0.0004913060110993683
The modified gen p mean: 0.4490737318992615, gen p mean: -0.13247138261795044, mean p set: 0.44964826107025146
loss_pred:0.015360930934548378, decouple_loss:0.00046538273454643786
Iteration: 1897, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479491412639618, gen p mean: -0.13152138888835907, mean p set: 0.4485260546207428
loss_pred:0.015349100343883038, decouple_loss:0.0005935149383731186
The modified gen p mean: 0.4470493495464325, gen p mean: -0.13661408424377441, mean p set: 0.44762295484542847
loss_pred:0.015038680285215378, decouple_loss:0.0006053220713511109
The modified gen p mean: 0.44543296098709106, gen p mean: -0.1341577023267746, mean p set: 0.44600710272789
loss_pred:0.015481018461287022, decouple_loss:0.0006005832692608237
Iteration: 1898, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4457544684410095, gen p mean: -0.13724614679813385, mean p set: 0.4463326036930084
loss_pred:0.014712724834680557, decouple_loss:0.0004680821148212999
The modified gen p mean: 0.4465441405773163, gen p mean: -0.13580720126628876, mean p set: 0.4471190571784973
loss_pred:0.01497816015034914, decouple_loss:0.000487388955662027
The modified gen p mean: 0.4467088580131531, gen p mean: -0.13664130866527557, mean p set: 0.4472857117652893
loss_pred:0.014842861331999302, decouple_loss:0.0005387390847317874
Iteration: 1899, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465155601501465, gen p mean: -0.1321711540222168, mean p set: 0.44709280133247375
loss_pred:0.015072634443640709, decouple_loss:0.00039704403025098145
The modified gen p mean: 0.4472809135913849, gen p mean: -0.13657355308532715, mean p set: 0.44785624742507935
loss_pred:0.014779150485992432, decouple_loss:0.00047984003322198987
The modified gen p mean: 0.44605398178100586, gen p mean: -0.13470345735549927, mean p set: 0.4466286599636078
loss_pred:0.015134116634726524, decouple_loss:0.00044333975529298186
Iteration: 1900, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465555250644684, gen p mean: -0.13438549637794495, mean p set: 0.4471312463283539
loss_pred:0.014959942549467087, decouple_loss:0.0007369433878920972
The modified gen p mean: 0.4468204975128174, gen p mean: -0.138090580701828, mean p set: 0.44739779829978943
loss_pred:0.015062454156577587, decouple_loss:0.000543572474271059
The modified gen p mean: 0.4460417926311493, gen p mean: -0.13368429243564606, mean p set: 0.4466158449649811
loss_pred:0.014799566008150578, decouple_loss:0.0008112161885946989
2023-05-01 22:57:52 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13715316355228424, mean p set: 0.4502691626548767
loss_pred:0.017024146392941475, decouple_loss:0.000513907871209085
The modified gen p mean: 0.4495331943035126, gen p mean: -0.1315375119447708, mean p set: 0.4500633478164673
loss_pred:0.01631697081029415, decouple_loss:0.0005184243782423437
The modified gen p mean: 0.4497807025909424, gen p mean: -0.13118886947631836, mean p set: 0.45035696029663086
loss_pred:0.01663959212601185, decouple_loss:0.0005108116893097758
WV_1_PC_1_EH_0_PS_40, loss: 0.016685955226421356, avg_mse: 0.025975128635764122
current test mse: 0.025975
Iteration: 1901, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471971094608307, gen p mean: -0.13897860050201416, mean p set: 0.44777220487594604
loss_pred:0.015112337656319141, decouple_loss:0.00048505989252589643
The modified gen p mean: 0.44727325439453125, gen p mean: -0.13547764718532562, mean p set: 0.4478478729724884The modified gen p mean: 0.4477201998233795, gen p mean: -0.13604797422885895, mean p set: 0.44829845428466797
loss_pred:0.014877795241773129, decouple_loss:0.0005206231726333499
loss_pred:0.014638252556324005, decouple_loss:0.00043500118772499263
Iteration: 1902, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463164508342743, gen p mean: -0.1382976621389389, mean p set: 0.4468908905982971
loss_pred:0.014896105974912643, decouple_loss:0.00043015764094889164
The modified gen p mean: 0.4469348192214966, gen p mean: -0.13763225078582764, mean p set: 0.4475100040435791The modified gen p mean: 0.4469437301158905, gen p mean: -0.13327541947364807, mean p set: 0.447516530752182
loss_pred:0.014567416161298752, decouple_loss:0.0005427318392321467
loss_pred:0.015647567808628082, decouple_loss:0.000546491879504174
Iteration: 1903, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44542914628982544, gen p mean: -0.13601411879062653, mean p set: 0.4460061490535736
loss_pred:0.015101226046681404, decouple_loss:0.0007649959297850728
The modified gen p mean: 0.4486773610115051, gen p mean: -0.1383049339056015, mean p set: 0.4492546021938324
loss_pred:0.015318154357373714, decouple_loss:0.001139851869083941
The modified gen p mean: 0.4473954439163208, gen p mean: -0.13856633007526398, mean p set: 0.447966605424881
loss_pred:0.014955068938434124, decouple_loss:0.00047058574273250997
Iteration: 1904, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44817212224006653, gen p mean: -0.1340857595205307, mean p set: 0.44875115156173706
loss_pred:0.01572742685675621, decouple_loss:0.000632050505373627
The modified gen p mean: 0.44777172803878784, gen p mean: -0.13469204306602478, mean p set: 0.44834670424461365
loss_pred:0.0155903035774827, decouple_loss:0.0003936525317840278
The modified gen p mean: 0.44714465737342834, gen p mean: -0.13444650173187256, mean p set: 0.44771912693977356
loss_pred:0.015102672390639782, decouple_loss:0.000515015097334981
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1905, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44634655117988586, gen p mean: -0.13466820120811462, mean p set: 0.44692057371139526
loss_pred:0.015124850906431675, decouple_loss:0.0004869264957960695
The modified gen p mean: 0.4464067220687866, gen p mean: -0.13562211394309998, mean p set: 0.4469849467277527
loss_pred:0.014753784984350204, decouple_loss:0.0005268554086796939
The modified gen p mean: 0.4472881555557251, gen p mean: -0.135964497923851, mean p set: 0.44786328077316284
loss_pred:0.014530333690345287, decouple_loss:0.0004522861272562295
Iteration: 1906, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44536805152893066, gen p mean: -0.1334494948387146, mean p set: 0.44594070315361023
loss_pred:0.014663265086710453, decouple_loss:0.0005257553420960903
The modified gen p mean: 0.44758063554763794, gen p mean: -0.13784821331501007, mean p set: 0.4481556713581085
loss_pred:0.014992708340287209, decouple_loss:0.000583767774514854
The modified gen p mean: 0.44708409905433655, gen p mean: -0.12855517864227295, mean p set: 0.44765836000442505
loss_pred:0.015911271795630455, decouple_loss:0.0005167915369383991
Iteration: 1907, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480609595775604, gen p mean: -0.1263645738363266, mean p set: 0.44864004850387573
loss_pred:0.01563395746052265, decouple_loss:0.0004552066093310714
The modified gen p mean: 0.446458637714386, gen p mean: -0.1318986564874649, mean p set: 0.44703078269958496
The modified gen p mean: 0.44830113649368286, gen p mean: -0.13161532580852509, mean p set: 0.44887736439704895
loss_pred:0.015014748089015484, decouple_loss:0.0005268535460345447
loss_pred:0.015594360418617725, decouple_loss:0.0005585997132584453
Iteration: 1908, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44818034768104553, gen p mean: -0.12999099493026733, mean p set: 0.44875821471214294
loss_pred:0.01564911939203739, decouple_loss:0.0006014793179929256
The modified gen p mean: 0.4477717876434326, gen p mean: -0.13254263997077942, mean p set: 0.44834285974502563
The modified gen p mean: 0.4462149143218994, gen p mean: -0.13192251324653625, mean p set: 0.44678959250450134
loss_pred:0.015240855515003204, decouple_loss:0.0008874828345142305
loss_pred:0.014674375765025616, decouple_loss:0.0005387753481045365
Iteration: 1909, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4472581148147583, gen p mean: -0.12910115718841553, mean p set: 0.44783279299736023
loss_pred:0.015168399550020695, decouple_loss:0.0004789247759617865
The modified gen p mean: 0.44623807072639465, gen p mean: -0.12947048246860504, mean p set: 0.44681257009506226
loss_pred:0.014715149998664856, decouple_loss:0.00046802402357570827
The modified gen p mean: 0.4473019540309906, gen p mean: -0.12839387357234955, mean p set: 0.44787725806236267
loss_pred:0.01586693339049816, decouple_loss:0.00046607732656411827
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012007_3_24hr.npz
NaN value num: 0
Iteration: 1910, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4479082226753235, gen p mean: -0.12769219279289246, mean p set: 0.4484834671020508
The modified gen p mean: 0.44793975353240967, gen p mean: -0.13033239543437958, mean p set: 0.4485156238079071
loss_pred:0.015211149118840694, decouple_loss:0.0006459442083723843
loss_pred:0.014857749454677105, decouple_loss:0.000532528618350625
The modified gen p mean: 0.448336124420166, gen p mean: -0.12896716594696045, mean p set: 0.4489106833934784
loss_pred:0.015248993411660194, decouple_loss:0.000561197753995657
2023-05-01 23:00:38 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1338443160057068, mean p set: 0.4502691626548767
loss_pred:0.01702762581408024, decouple_loss:0.0006174279260449111
The modified gen p mean: 0.4495350122451782, gen p mean: -0.12744010984897614, mean p set: 0.4500633478164673
loss_pred:0.016301803290843964, decouple_loss:0.0007903305231593549
The modified gen p mean: 0.44977760314941406, gen p mean: -0.12733997404575348, mean p set: 0.45035696029663086
loss_pred:0.016679132357239723, decouple_loss:0.0005965568707324564
WV_1_PC_1_EH_0_PS_40, loss: 0.016702925786376, avg_mse: 0.026036201044917107
current test mse: 0.026036
Iteration: 1911, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484420716762543, gen p mean: -0.13294194638729095, mean p set: 0.4490198791027069
loss_pred:0.015347783453762531, decouple_loss:0.0006802910356782377
The modified gen p mean: 0.4474823772907257, gen p mean: -0.13583645224571228, mean p set: 0.4480571746826172The modified gen p mean: 0.44753217697143555, gen p mean: -0.12802191078662872, mean p set: 0.4481089115142822
loss_pred:0.015552426688373089, decouple_loss:0.0004063712840434164
loss_pred:0.01584312506020069, decouple_loss:0.0006640413776040077
Iteration: 1912, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44814568758010864, gen p mean: -0.13053147494792938, mean p set: 0.4487214982509613
The modified gen p mean: 0.4481511116027832, gen p mean: -0.1295749843120575, mean p set: 0.4487282633781433
loss_pred:0.015703517943620682, decouple_loss:0.0006125837098807096
loss_pred:0.015276174061000347, decouple_loss:0.0005808810237795115
The modified gen p mean: 0.4479779899120331, gen p mean: -0.12599125504493713, mean p set: 0.4485537111759186
loss_pred:0.016454357653856277, decouple_loss:0.0005627116770483553
Iteration: 1913, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44761258363723755, gen p mean: -0.12395794689655304, mean p set: 0.4481905400753021
loss_pred:0.01533263735473156, decouple_loss:0.0007141901296563447
The modified gen p mean: 0.44653624296188354, gen p mean: -0.12359805405139923, mean p set: 0.447110116481781
loss_pred:0.01589622162282467, decouple_loss:0.0005063163698650897
The modified gen p mean: 0.44758233428001404, gen p mean: -0.12550264596939087, mean p set: 0.4481564164161682
loss_pred:0.014987296424806118, decouple_loss:0.0007311645313166082
Iteration: 1914, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474388659000397, gen p mean: -0.11991538852453232, mean p set: 0.4480155408382416
loss_pred:0.01655549742281437, decouple_loss:0.0007182309636846185
The modified gen p mean: 0.4477442502975464, gen p mean: -0.1223321408033371, mean p set: 0.44832107424736023
loss_pred:0.015754474326968193, decouple_loss:0.0007202207925729454
The modified gen p mean: 0.44812607765197754, gen p mean: -0.12075614184141159, mean p set: 0.4486992359161377
loss_pred:0.015706805512309074, decouple_loss:0.0009039226570166647
Iteration: 1915, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480309784412384, gen p mean: -0.11979369819164276, mean p set: 0.44860541820526123
loss_pred:0.015478275716304779, decouple_loss:0.0006568788667209446
The modified gen p mean: 0.45006245374679565, gen p mean: -0.12484865635633469, mean p set: 0.4506426155567169
loss_pred:0.014863332733511925, decouple_loss:0.0010627821320667863
The modified gen p mean: 0.44604945182800293, gen p mean: -0.12202269583940506, mean p set: 0.4466237425804138
loss_pred:0.015202026814222336, decouple_loss:0.0006621840293519199
Iteration: 1916, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44679105281829834, gen p mean: -0.1203324943780899, mean p set: 0.447368323802948
loss_pred:0.01518755592405796, decouple_loss:0.000555992650333792
The modified gen p mean: 0.4474959075450897, gen p mean: -0.12198612838983536, mean p set: 0.4480707347393036
The modified gen p mean: 0.4496065080165863, gen p mean: -0.12315987050533295, mean p set: 0.45018208026885986
loss_pred:0.015984416007995605, decouple_loss:0.0005640679737553
loss_pred:0.014119332656264305, decouple_loss:0.00043703915434889495
Iteration: 1917, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494628310203552, gen p mean: -0.12176208943128586, mean p set: 0.4500364065170288
loss_pred:0.014913610182702541, decouple_loss:0.000538086926098913
The modified gen p mean: 0.44774338603019714, gen p mean: -0.12437860667705536, mean p set: 0.4483180344104767
loss_pred:0.01568092219531536, decouple_loss:0.0005518302205018699
The modified gen p mean: 0.448466420173645, gen p mean: -0.12424975633621216, mean p set: 0.44904476404190063
loss_pred:0.015729742124676704, decouple_loss:0.0004449021362233907
Iteration: 1918, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4460826516151428, gen p mean: -0.12121403217315674, mean p set: 0.44665804505348206
loss_pred:0.014900324866175652, decouple_loss:0.00044220875133760273
The modified gen p mean: 0.44682133197784424, gen p mean: -0.12402496486902237, mean p set: 0.4473958909511566
loss_pred:0.015048759058117867, decouple_loss:0.00055248464923352
The modified gen p mean: 0.44811517000198364, gen p mean: -0.12077845633029938, mean p set: 0.44869574904441833
loss_pred:0.01547356229275465, decouple_loss:0.0007307398482225835
Iteration: 1919, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44690966606140137, gen p mean: -0.1274908035993576, mean p set: 0.4474853575229645
loss_pred:0.01457824744284153, decouple_loss:0.00043864347389899194
The modified gen p mean: 0.44934922456741333, gen p mean: -0.1246442049741745, mean p set: 0.4499242305755615
loss_pred:0.015166240744292736, decouple_loss:0.0006121662445366383
The modified gen p mean: 0.44909095764160156, gen p mean: -0.12591247260570526, mean p set: 0.449665904045105
loss_pred:0.014358836226165295, decouple_loss:0.0005552287329919636
Iteration: 1920, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469360113143921, gen p mean: -0.1262366771697998, mean p set: 0.44750893115997314
loss_pred:0.01489328220486641, decouple_loss:0.0003783111460506916
The modified gen p mean: 0.44882458448410034, gen p mean: -0.12358779460191727, mean p set: 0.44939976930618286
The modified gen p mean: 0.4466848075389862, gen p mean: -0.11829854547977448, mean p set: 0.44726231694221497
loss_pred:0.015125986188650131, decouple_loss:0.0006019549909979105
loss_pred:0.01593952439725399, decouple_loss:0.0005221918108873069
2023-05-01 23:02:47 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12474962323904037, mean p set: 0.4502691626548767
loss_pred:0.016965484246611595, decouple_loss:0.0005599973956122994
The modified gen p mean: 0.44953489303588867, gen p mean: -0.11862494796514511, mean p set: 0.4500633478164673
loss_pred:0.01632878929376602, decouple_loss:0.0005597125855274498
The modified gen p mean: 0.44978028535842896, gen p mean: -0.11864851415157318, mean p set: 0.45035696029663086
loss_pred:0.016583288088440895, decouple_loss:0.0005963488365523517
WV_1_PC_1_EH_0_PS_40, loss: 0.016654454171657562, avg_mse: 0.025936054065823555
current test mse: 0.025936
At step 1920, Best test: 0.025936
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1921, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446759968996048, gen p mean: -0.12369290739297867, mean p set: 0.4473358392715454
loss_pred:0.014886093325912952, decouple_loss:0.0005702084745280445
The modified gen p mean: 0.44826674461364746, gen p mean: -0.12168986350297928, mean p set: 0.4488431215286255
loss_pred:0.014741985127329826, decouple_loss:0.0005009524757042527
The modified gen p mean: 0.4465520977973938, gen p mean: -0.12386412918567657, mean p set: 0.4471263289451599
loss_pred:0.014553661458194256, decouple_loss:0.0004900341155007482
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 1922, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44730865955352783, gen p mean: -0.12345679849386215, mean p set: 0.4478845000267029
loss_pred:0.014503483660519123, decouple_loss:0.00039979099528864026
The modified gen p mean: 0.44829803705215454, gen p mean: -0.1195133849978447, mean p set: 0.4488748610019684The modified gen p mean: 0.44842758774757385, gen p mean: -0.12025198340415955, mean p set: 0.44900330901145935
loss_pred:0.015719324350357056, decouple_loss:0.0004517150518950075
loss_pred:0.014815966598689556, decouple_loss:0.000503143179230392
Iteration: 1923, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4478389322757721, gen p mean: -0.12246134877204895, mean p set: 0.44841471314430237
loss_pred:0.015305772423744202, decouple_loss:0.00038354858406819403
The modified gen p mean: 0.4478955864906311, gen p mean: -0.12460920214653015, mean p set: 0.448472261428833
loss_pred:0.014455906115472317, decouple_loss:0.00047574570635333657
The modified gen p mean: 0.44767361879348755, gen p mean: -0.1272282898426056, mean p set: 0.4482479691505432
loss_pred:0.015490718185901642, decouple_loss:0.0005634300759993494
Iteration: 1924, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44703441858291626, gen p mean: -0.12663857638835907, mean p set: 0.4476125240325928
loss_pred:0.015099543146789074, decouple_loss:0.0005566933541558683
The modified gen p mean: 0.44697606563568115, gen p mean: -0.1273028403520584, mean p set: 0.44755110144615173
loss_pred:0.015403668396174908, decouple_loss:0.0004195372748654336
The modified gen p mean: 0.4479937255382538, gen p mean: -0.12693949043750763, mean p set: 0.4485693573951721
loss_pred:0.014535429887473583, decouple_loss:0.0006208457052707672
Iteration: 1925, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469575881958008, gen p mean: -0.12964601814746857, mean p set: 0.4475356340408325
loss_pred:0.014905126765370369, decouple_loss:0.0006077647558413446
The modified gen p mean: 0.4482303261756897, gen p mean: -0.12466481328010559, mean p set: 0.4488097131252289
loss_pred:0.0151951489970088, decouple_loss:0.0004587792791426182
The modified gen p mean: 0.4476880431175232, gen p mean: -0.1261487901210785, mean p set: 0.4482649564743042
loss_pred:0.014986194670200348, decouple_loss:0.0007431156700477004
Iteration: 1926, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4491465985774994, gen p mean: -0.12736093997955322, mean p set: 0.4497232735157013
loss_pred:0.014731324277818203, decouple_loss:0.0006001158035360277
The modified gen p mean: 0.44785839319229126, gen p mean: -0.1267944723367691, mean p set: 0.44843170046806335
loss_pred:0.01469018217176199, decouple_loss:0.0004463851801119745
The modified gen p mean: 0.44732850790023804, gen p mean: -0.13129860162734985, mean p set: 0.4479025602340698
loss_pred:0.014624414034187794, decouple_loss:0.000513510312885046
Iteration: 1927, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44673392176628113, gen p mean: -0.13286949694156647, mean p set: 0.447309285402298
loss_pred:0.014485524967312813, decouple_loss:0.0004384019412100315
The modified gen p mean: 0.4476229250431061, gen p mean: -0.1272362470626831, mean p set: 0.44819900393486023
loss_pred:0.014880559407174587, decouple_loss:0.0007829138194210827
The modified gen p mean: 0.44715461134910583, gen p mean: -0.1259903609752655, mean p set: 0.4477330446243286
loss_pred:0.01500711590051651, decouple_loss:0.0006547810044139624
Iteration: 1928, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44706979393959045, gen p mean: -0.12727759778499603, mean p set: 0.4476448595523834
loss_pred:0.015281172469258308, decouple_loss:0.0005974522791802883
The modified gen p mean: 0.4457832872867584, gen p mean: -0.12467082589864731, mean p set: 0.44636374711990356
loss_pred:0.014815897680819035, decouple_loss:0.0006340256077237427
The modified gen p mean: 0.44632044434547424, gen p mean: -0.1292196363210678, mean p set: 0.4468948543071747
loss_pred:0.014850337989628315, decouple_loss:0.0005290697445161641
Iteration: 1929, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44894805550575256, gen p mean: -0.1277836710214615, mean p set: 0.44952166080474854
loss_pred:0.014786242507398129, decouple_loss:0.0006084548658691347
The modified gen p mean: 0.44999271631240845, gen p mean: -0.12677504122257233, mean p set: 0.4505683481693268
The modified gen p mean: 0.44871801137924194, gen p mean: -0.12635713815689087, mean p set: 0.44929543137550354
loss_pred:0.014221555553376675, decouple_loss:0.0007007464300841093
loss_pred:0.014833807945251465, decouple_loss:0.0006266486016102135
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012019_3_24hr.npz
NaN value num: 0
Iteration: 1930, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4506978690624237, gen p mean: -0.11072686314582825, mean p set: 0.4512738585472107
loss_pred:0.01651649735867977, decouple_loss:0.0008319492917507887
The modified gen p mean: 0.45075175166130066, gen p mean: -0.11229901015758514, mean p set: 0.4513293206691742
The modified gen p mean: 0.4508926570415497, gen p mean: -0.11416567116975784, mean p set: 0.45147183537483215
loss_pred:0.015718691051006317, decouple_loss:0.0006178381736390293
loss_pred:0.015587331727147102, decouple_loss:0.0005575352697633207
2023-05-01 23:05:34 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12588368356227875, mean p set: 0.4502691626548767
loss_pred:0.016942916437983513, decouple_loss:0.000494221574626863
The modified gen p mean: 0.4495375454425812, gen p mean: -0.12011870741844177, mean p set: 0.4500633478164673
loss_pred:0.01631551794707775, decouple_loss:0.000542005174793303
The modified gen p mean: 0.4497799277305603, gen p mean: -0.12007002532482147, mean p set: 0.45035696029663086
loss_pred:0.01653807982802391, decouple_loss:0.00047755270497873425
WV_1_PC_1_EH_0_PS_40, loss: 0.016624068841338158, avg_mse: 0.025850370526313782
current test mse: 0.02585
At step 1930, Best test: 0.02585
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_test_schedule_sampling_DynaMean.ckpt
Iteration: 1931, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45000505447387695, gen p mean: -0.10757236927747726, mean p set: 0.45058155059814453
loss_pred:0.016011573374271393, decouple_loss:0.0006433993694372475
The modified gen p mean: 0.45013242959976196, gen p mean: -0.10818749666213989, mean p set: 0.4507089853286743
loss_pred:0.015578744933009148, decouple_loss:0.0004372124094516039
The modified gen p mean: 0.4504198729991913, gen p mean: -0.11318613588809967, mean p set: 0.45099735260009766
loss_pred:0.01516528706997633, decouple_loss:0.00047354065463878214
Iteration: 1932, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496297240257263, gen p mean: -0.11395175755023956, mean p set: 0.4502072036266327
loss_pred:0.015820665284991264, decouple_loss:0.0006338973762467504
The modified gen p mean: 0.45149728655815125, gen p mean: -0.11256445944309235, mean p set: 0.452073335647583
The modified gen p mean: 0.450063019990921, gen p mean: -0.11670547723770142, mean p set: 0.45063820481300354
loss_pred:0.01568756252527237, decouple_loss:0.0006852117949165404
loss_pred:0.01558468583971262, decouple_loss:0.0004910275456495583
Iteration: 1933, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503081142902374, gen p mean: -0.12233968824148178, mean p set: 0.450882226228714
loss_pred:0.015074322000145912, decouple_loss:0.0005015560309402645
The modified gen p mean: 0.4511359930038452, gen p mean: -0.11719957739114761, mean p set: 0.4517157971858978
loss_pred:0.016163459047675133, decouple_loss:0.0006662427913397551
The modified gen p mean: 0.4506993889808655, gen p mean: -0.11400476843118668, mean p set: 0.4512766897678375
loss_pred:0.01576138474047184, decouple_loss:0.000653893977869302
Iteration: 1934, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501756727695465, gen p mean: -0.11740860342979431, mean p set: 0.45075303316116333
The modified gen p mean: 0.4520493745803833, gen p mean: -0.11978094279766083, mean p set: 0.4526248872280121
loss_pred:0.016523370519280434, decouple_loss:0.0006164141232147813
loss_pred:0.01578575372695923, decouple_loss:0.0005386983975768089
The modified gen p mean: 0.4506364166736603, gen p mean: -0.11657007038593292, mean p set: 0.45121413469314575
loss_pred:0.015812983736395836, decouple_loss:0.0005933864740654826
Iteration: 1935, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4516803026199341, gen p mean: -0.11925091594457626, mean p set: 0.45225754380226135
loss_pred:0.016832930967211723, decouple_loss:0.0006874476675875485
The modified gen p mean: 0.45035865902900696, gen p mean: -0.11903932690620422, mean p set: 0.4509367048740387
The modified gen p mean: 0.4509807825088501, gen p mean: -0.11738146841526031, mean p set: 0.4515584707260132
loss_pred:0.015676429495215416, decouple_loss:0.0004927872214466333
loss_pred:0.016568809747695923, decouple_loss:0.0004980540834367275
Iteration: 1936, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500936269760132, gen p mean: -0.12316194921731949, mean p set: 0.45066869258880615
The modified gen p mean: 0.45071670413017273, gen p mean: -0.1169205754995346, mean p set: 0.45129165053367615
loss_pred:0.016224229708313942, decouple_loss:0.0006056140991859138
loss_pred:0.015783175826072693, decouple_loss:0.00047495841863565147
The modified gen p mean: 0.4515851140022278, gen p mean: -0.11394932866096497, mean p set: 0.4521616995334625
loss_pred:0.016277756541967392, decouple_loss:0.0006598908803425729
Iteration: 1937, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097947120666504, gen p mean: -0.11175882816314697, mean p set: 0.4515573978424072
loss_pred:0.015469240956008434, decouple_loss:0.0007893514703027904
The modified gen p mean: 0.45149290561676025, gen p mean: -0.12013444304466248, mean p set: 0.45206722617149353
loss_pred:0.016082007437944412, decouple_loss:0.0007297918200492859
The modified gen p mean: 0.45130041241645813, gen p mean: -0.1168677806854248, mean p set: 0.45187854766845703
loss_pred:0.016153739765286446, decouple_loss:0.0005935956723988056
Iteration: 1938, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509294629096985, gen p mean: -0.1165073812007904, mean p set: 0.45150890946388245
loss_pred:0.015041260048747063, decouple_loss:0.0004734514222946018
The modified gen p mean: 0.4523191750049591, gen p mean: -0.11254972964525223, mean p set: 0.4528968930244446
The modified gen p mean: 0.4509451389312744, gen p mean: -0.10988181084394455, mean p set: 0.45152246952056885
loss_pred:0.015552465803921223, decouple_loss:0.0006359913386404514
loss_pred:0.016581499949097633, decouple_loss:0.0006078002625145018
Iteration: 1939, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451696515083313, gen p mean: -0.11635812371969223, mean p set: 0.4522736966609955
The modified gen p mean: 0.4509431719779968, gen p mean: -0.11353716254234314, mean p set: 0.4515230059623718
loss_pred:0.015604632906615734, decouple_loss:0.00043264846317470074
loss_pred:0.01527119055390358, decouple_loss:0.0004486051620915532
The modified gen p mean: 0.4495881199836731, gen p mean: -0.11562502384185791, mean p set: 0.45016512274742126
loss_pred:0.016235509887337685, decouple_loss:0.0007336125709116459
Iteration: 1940, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45162850618362427, gen p mean: -0.11352186650037766, mean p set: 0.4522019624710083
loss_pred:0.015989147126674652, decouple_loss:0.0006784826400689781
The modified gen p mean: 0.45083218812942505, gen p mean: -0.11271116882562637, mean p set: 0.4514089822769165
loss_pred:0.01560820359736681, decouple_loss:0.0005480239633470774
The modified gen p mean: 0.4508318603038788, gen p mean: -0.11717245727777481, mean p set: 0.4514085352420807
loss_pred:0.01495607104152441, decouple_loss:0.0005020469543524086
2023-05-01 23:07:46 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13084669411182404, mean p set: 0.4502691626548767
loss_pred:0.017060332000255585, decouple_loss:0.0005897810333408415
The modified gen p mean: 0.44953665137290955, gen p mean: -0.12487511336803436, mean p set: 0.4500633478164673
loss_pred:0.01632651872932911, decouple_loss:0.0006115376017987728
The modified gen p mean: 0.4497770667076111, gen p mean: -0.12476534396409988, mean p set: 0.45035696029663086
loss_pred:0.016694029793143272, decouple_loss:0.0006089322851039469
WV_1_PC_1_EH_0_PS_40, loss: 0.016723796725273132, avg_mse: 0.02597632445394993
current test mse: 0.025976
Iteration: 1941, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500463008880615, gen p mean: -0.115585558116436, mean p set: 0.4506221413612366
loss_pred:0.016019467264413834, decouple_loss:0.0006106680957600474
The modified gen p mean: 0.4504321813583374, gen p mean: -0.12346897274255753, mean p set: 0.4510093629360199
loss_pred:0.015529463067650795, decouple_loss:0.0004245676100254059
The modified gen p mean: 0.4501054883003235, gen p mean: -0.11678460240364075, mean p set: 0.450682133436203
loss_pred:0.0161037128418684, decouple_loss:0.00045278354082256556
Iteration: 1942, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45178142189979553, gen p mean: -0.12217902392148972, mean p set: 0.4523589313030243
The modified gen p mean: 0.4515787661075592, gen p mean: -0.11776302009820938, mean p set: 0.4521554708480835
loss_pred:0.015438159927725792, decouple_loss:0.0006566196097992361
loss_pred:0.016074860468506813, decouple_loss:0.000506782322190702
The modified gen p mean: 0.45043671131134033, gen p mean: -0.11953790485858917, mean p set: 0.4510124921798706
loss_pred:0.015306440182030201, decouple_loss:0.000766479060985148
Iteration: 1943, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45180779695510864, gen p mean: -0.11537440121173859, mean p set: 0.4523850381374359
loss_pred:0.01688624545931816, decouple_loss:0.0009115182911045849
The modified gen p mean: 0.45069190859794617, gen p mean: -0.11957015097141266, mean p set: 0.4512709379196167
loss_pred:0.015313531272113323, decouple_loss:0.0005448525189422071
The modified gen p mean: 0.4498320519924164, gen p mean: -0.11479473859071732, mean p set: 0.45040586590766907
loss_pred:0.015833623707294464, decouple_loss:0.0010758227435871959
Iteration: 1944, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4529760181903839, gen p mean: -0.11402534693479538, mean p set: 0.4535543620586395
loss_pred:0.015498817898333073, decouple_loss:0.0005762953078374267
The modified gen p mean: 0.45281317830085754, gen p mean: -0.11632511019706726, mean p set: 0.4533900320529938
loss_pred:0.01589159667491913, decouple_loss:0.0006204218952916563
The modified gen p mean: 0.450894832611084, gen p mean: -0.12031093239784241, mean p set: 0.45146840810775757
loss_pred:0.01600402407348156, decouple_loss:0.0005227854126133025
Iteration: 1945, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45139989256858826, gen p mean: -0.11014685034751892, mean p set: 0.451976478099823
loss_pred:0.016223061829805374, decouple_loss:0.0008352916338481009
The modified gen p mean: 0.45107918977737427, gen p mean: -0.11670966446399689, mean p set: 0.4516545534133911
loss_pred:0.016494279727339745, decouple_loss:0.0006321246037259698
The modified gen p mean: 0.4514281451702118, gen p mean: -0.11504710465669632, mean p set: 0.45200711488723755
loss_pred:0.01586972177028656, decouple_loss:0.0007394348504021764
Iteration: 1946, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4522736072540283, gen p mean: -0.11313708871603012, mean p set: 0.45285114645957947
loss_pred:0.01559456903487444, decouple_loss:0.0007898848270997405
The modified gen p mean: 0.4511709213256836, gen p mean: -0.11210069805383682, mean p set: 0.4517492651939392
loss_pred:0.014837571419775486, decouple_loss:0.000986253609880805
The modified gen p mean: 0.45103707909584045, gen p mean: -0.10846222937107086, mean p set: 0.4516139328479767
loss_pred:0.0159066841006279, decouple_loss:0.0007746529299765825
Iteration: 1947, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4518429934978485, gen p mean: -0.10614868253469467, mean p set: 0.4524179995059967
loss_pred:0.016076209023594856, decouple_loss:0.0006687509594485164
The modified gen p mean: 0.4505360424518585, gen p mean: -0.11503098160028458, mean p set: 0.45111268758773804
loss_pred:0.014640585519373417, decouple_loss:0.0005226938519626856
The modified gen p mean: 0.4513711631298065, gen p mean: -0.11022613942623138, mean p set: 0.4519473612308502
loss_pred:0.016300229355692863, decouple_loss:0.0007078258786350489
Iteration: 1948, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504793882369995, gen p mean: -0.10570287704467773, mean p set: 0.4510560631752014
loss_pred:0.015204022638499737, decouple_loss:0.0005293169524520636
The modified gen p mean: 0.4505210220813751, gen p mean: -0.10893283784389496, mean p set: 0.4510968327522278
loss_pred:0.01554907113313675, decouple_loss:0.0006270880694501102
The modified gen p mean: 0.45101454854011536, gen p mean: -0.11301889270544052, mean p set: 0.45159196853637695
loss_pred:0.01590397208929062, decouple_loss:0.0006483959150500596
Iteration: 1949, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512560963630676, gen p mean: -0.10897751897573471, mean p set: 0.4518337547779083
loss_pred:0.015923988074064255, decouple_loss:0.0009583557257428765
The modified gen p mean: 0.4510059058666229, gen p mean: -0.1076127365231514, mean p set: 0.45158323645591736
loss_pred:0.016597885638475418, decouple_loss:0.0008013812475837767
The modified gen p mean: 0.452321857213974, gen p mean: -0.1041683480143547, mean p set: 0.452898770570755
loss_pred:0.015960343182086945, decouple_loss:0.0007692039362154901
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012009_3_24hr.npz
NaN value num: 0
Iteration: 1950, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45166781544685364, gen p mean: -0.11197633296251297, mean p set: 0.4522424042224884
loss_pred:0.015935473144054413, decouple_loss:0.0006307786679826677
The modified gen p mean: 0.4502009153366089, gen p mean: -0.10908209532499313, mean p set: 0.450778603553772
The modified gen p mean: 0.45022180676460266, gen p mean: -0.11259707808494568, mean p set: 0.45079872012138367
loss_pred:0.01637471280992031, decouple_loss:0.0005353782325983047
loss_pred:0.016521092504262924, decouple_loss:0.0008192818495444953
2023-05-01 23:10:28 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12224801629781723, mean p set: 0.4502691626548767
loss_pred:0.017105482518672943, decouple_loss:0.0005860294331796467
The modified gen p mean: 0.44953471422195435, gen p mean: -0.11662500351667404, mean p set: 0.4500633478164673
loss_pred:0.0162420105189085, decouple_loss:0.0008150366484187543
The modified gen p mean: 0.4497807025909424, gen p mean: -0.11622366309165955, mean p set: 0.45035696029663086
loss_pred:0.01667693816125393, decouple_loss:0.0007928676204755902
WV_1_PC_1_EH_0_PS_40, loss: 0.01671137474477291, avg_mse: 0.0259803906083107
current test mse: 0.02598
Iteration: 1951, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971928000450134, gen p mean: -0.11356503516435623, mean p set: 0.4502951502799988
loss_pred:0.015389353036880493, decouple_loss:0.0008879769593477249
The modified gen p mean: 0.45241013169288635, gen p mean: -0.11226147413253784, mean p set: 0.4529906213283539
loss_pred:0.015150323510169983, decouple_loss:0.0008798502385616302
The modified gen p mean: 0.44930949807167053, gen p mean: -0.11400057375431061, mean p set: 0.4498836398124695
loss_pred:0.01555194053798914, decouple_loss:0.0009558232268318534
Iteration: 1952, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493641257286072, gen p mean: -0.11614926159381866, mean p set: 0.44993916153907776
The modified gen p mean: 0.45074987411499023, gen p mean: -0.11739762127399445, mean p set: 0.4513280689716339
loss_pred:0.0153932711109519, decouple_loss:0.0008891827892512083
loss_pred:0.01540540624409914, decouple_loss:0.0008169595967046916
The modified gen p mean: 0.4507445991039276, gen p mean: -0.11259186267852783, mean p set: 0.4513210654258728
loss_pred:0.015728913247585297, decouple_loss:0.0007032150169834495
Iteration: 1953, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4515625238418579, gen p mean: -0.12077226489782333, mean p set: 0.4521428644657135
loss_pred:0.014900261536240578, decouple_loss:0.0006173133733682334
The modified gen p mean: 0.4502433240413666, gen p mean: -0.11812680214643478, mean p set: 0.45082080364227295
loss_pred:0.015206241980195045, decouple_loss:0.0006246516713872552
The modified gen p mean: 0.4516267776489258, gen p mean: -0.11485888808965683, mean p set: 0.452203631401062
loss_pred:0.015683380886912346, decouple_loss:0.0006661050138063729
Iteration: 1954, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495888948440552, gen p mean: -0.11659187823534012, mean p set: 0.4501630365848541
loss_pred:0.014787535183131695, decouple_loss:0.0004431715642567724
The modified gen p mean: 0.4510922431945801, gen p mean: -0.11656932532787323, mean p set: 0.45166799426078796
loss_pred:0.01572691649198532, decouple_loss:0.0006067515350878239
The modified gen p mean: 0.451444149017334, gen p mean: -0.11810063570737839, mean p set: 0.4520223140716553
loss_pred:0.01567140221595764, decouple_loss:0.0007349232910200953
Iteration: 1955, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45043647289276123, gen p mean: -0.11776886135339737, mean p set: 0.45101073384284973
loss_pred:0.016174742951989174, decouple_loss:0.0004887340473942459
The modified gen p mean: 0.4512130618095398, gen p mean: -0.11420683562755585, mean p set: 0.4517904818058014
loss_pred:0.01633015275001526, decouple_loss:0.0004944948013871908
The modified gen p mean: 0.4495307207107544, gen p mean: -0.11931107193231583, mean p set: 0.45010536909103394
loss_pred:0.015131847001612186, decouple_loss:0.0004888497060164809
Iteration: 1956, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536096155643463, gen p mean: -0.11618614196777344, mean p set: 0.45418456196784973
loss_pred:0.015270126983523369, decouple_loss:0.0004506408586166799
The modified gen p mean: 0.4517157971858978, gen p mean: -0.12347095459699631, mean p set: 0.4522954225540161
loss_pred:0.015228978358209133, decouple_loss:0.00041510211303830147
The modified gen p mean: 0.45114395022392273, gen p mean: -0.12539809942245483, mean p set: 0.45172062516212463
loss_pred:0.01621178910136223, decouple_loss:0.0005599352298304439
Iteration: 1957, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510825574398041, gen p mean: -0.12298532575368881, mean p set: 0.4516597390174866
loss_pred:0.014970611780881882, decouple_loss:0.0005910026375204325
The modified gen p mean: 0.45089441537857056, gen p mean: -0.12096206098794937, mean p set: 0.45147088170051575
loss_pred:0.01521303877234459, decouple_loss:0.0005109524936415255
The modified gen p mean: 0.4509759843349457, gen p mean: -0.11944794654846191, mean p set: 0.4515514075756073
loss_pred:0.016116086393594742, decouple_loss:0.0005684292991645634
Iteration: 1958, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44996848702430725, gen p mean: -0.12164430320262909, mean p set: 0.45054367184638977
loss_pred:0.014962267130613327, decouple_loss:0.0004930794239044189
The modified gen p mean: 0.45108485221862793, gen p mean: -0.12319370359182358, mean p set: 0.4516623318195343
loss_pred:0.014870189130306244, decouple_loss:0.00048339032218791544
The modified gen p mean: 0.4498610496520996, gen p mean: -0.12248121947050095, mean p set: 0.4504365921020508
loss_pred:0.014720242470502853, decouple_loss:0.0005023560370318592
Iteration: 1959, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45169761776924133, gen p mean: -0.11932582408189774, mean p set: 0.4522706866264343
loss_pred:0.01599949039518833, decouple_loss:0.0005545322201214731
The modified gen p mean: 0.450406014919281, gen p mean: -0.12191398441791534, mean p set: 0.4509834945201874
loss_pred:0.015712996944785118, decouple_loss:0.0006347325979731977
The modified gen p mean: 0.4515705704689026, gen p mean: -0.12891513109207153, mean p set: 0.4521483778953552
loss_pred:0.015973970293998718, decouple_loss:0.0005136709078215063
Iteration: 1960, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45040878653526306, gen p mean: -0.12510551512241364, mean p set: 0.4509831368923187
loss_pred:0.016218746080994606, decouple_loss:0.0004846388183068484
The modified gen p mean: 0.4516253173351288, gen p mean: -0.12056496739387512, mean p set: 0.45220157504081726
loss_pred:0.01496302429586649, decouple_loss:0.000409332278650254
The modified gen p mean: 0.45195356011390686, gen p mean: -0.12068022787570953, mean p set: 0.4525294005870819
loss_pred:0.015370771288871765, decouple_loss:0.00044887338299304247
2023-05-01 23:12:32 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1329725980758667, mean p set: 0.4502691626548767
loss_pred:0.017056573182344437, decouple_loss:0.0005520646227523685
The modified gen p mean: 0.4495353400707245, gen p mean: -0.1269797831773758, mean p set: 0.4500633478164673
loss_pred:0.016313916072249413, decouple_loss:0.0007845380459912121
The modified gen p mean: 0.44977957010269165, gen p mean: -0.1265857219696045, mean p set: 0.45035696029663086
loss_pred:0.016616221517324448, decouple_loss:0.0007244583102874458
WV_1_PC_1_EH_0_PS_40, loss: 0.016696587204933167, avg_mse: 0.025983186438679695
current test mse: 0.025983
Iteration: 1961, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4494992196559906, gen p mean: -0.12310405820608139, mean p set: 0.45007672905921936
loss_pred:0.015523657202720642, decouple_loss:0.0006129248649813235
The modified gen p mean: 0.44939783215522766, gen p mean: -0.12669409811496735, mean p set: 0.449973464012146
loss_pred:0.015733174979686737, decouple_loss:0.0008219768642447889
The modified gen p mean: 0.44918954372406006, gen p mean: -0.12451647967100143, mean p set: 0.4497682452201843
loss_pred:0.015787851065397263, decouple_loss:0.0007242328720167279
Iteration: 1962, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452697217464447, gen p mean: -0.12859849631786346, mean p set: 0.4532740116119385
The modified gen p mean: 0.4532928764820099, gen p mean: -0.12522383034229279, mean p set: 0.453868567943573loss_pred:0.015105034224689007, decouple_loss:0.0005370064172893763
loss_pred:0.014969635754823685, decouple_loss:0.0006506107747554779The modified gen p mean: 0.4514198899269104, gen p mean: -0.12793739140033722, mean p set: 0.45199474692344666
loss_pred:0.014766393229365349, decouple_loss:0.0005986661417409778
Iteration: 1963, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509981870651245, gen p mean: -0.1248813048005104, mean p set: 0.4515727162361145
loss_pred:0.01503839809447527, decouple_loss:0.0006634749588556588
The modified gen p mean: 0.44930294156074524, gen p mean: -0.12656396627426147, mean p set: 0.44987794756889343
loss_pred:0.015973173081874847, decouple_loss:0.0007526918780058622
The modified gen p mean: 0.45019733905792236, gen p mean: -0.1219082623720169, mean p set: 0.4507746696472168
loss_pred:0.016210239380598068, decouple_loss:0.000568232499063015
Iteration: 1964, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4530348777770996, gen p mean: -0.12534499168395996, mean p set: 0.45361581444740295
loss_pred:0.015179834328591824, decouple_loss:0.0008697040029801428
The modified gen p mean: 0.4517046809196472, gen p mean: -0.12220294028520584, mean p set: 0.45228299498558044
loss_pred:0.01532991323620081, decouple_loss:0.0009133832645602524
The modified gen p mean: 0.4498334228992462, gen p mean: -0.12498138099908829, mean p set: 0.4504096210002899
loss_pred:0.0161464661359787, decouple_loss:0.0006355292862281203
Iteration: 1965, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45098668336868286, gen p mean: -0.1242072805762291, mean p set: 0.4515630006790161
loss_pred:0.015076730400323868, decouple_loss:0.0005591697408817708
The modified gen p mean: 0.45237240195274353, gen p mean: -0.12372388690710068, mean p set: 0.45294854044914246
loss_pred:0.014705254696309566, decouple_loss:0.000644268118776381
The modified gen p mean: 0.45132872462272644, gen p mean: -0.13149872422218323, mean p set: 0.45190224051475525
loss_pred:0.01622943766415119, decouple_loss:0.0005944604054093361
Iteration: 1966, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45168745517730713, gen p mean: -0.12682317197322845, mean p set: 0.452263742685318
The modified gen p mean: 0.4518413245677948, gen p mean: -0.1234424039721489, mean p set: 0.45241761207580566loss_pred:0.014915624633431435, decouple_loss:0.0007695738459005952
loss_pred:0.015370591543614864, decouple_loss:0.0005197515129111707
The modified gen p mean: 0.45077037811279297, gen p mean: -0.12220596522092819, mean p set: 0.4513498842716217
loss_pred:0.015102672390639782, decouple_loss:0.0005229486851021647
Iteration: 1967, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44971755146980286, gen p mean: -0.12417840212583542, mean p set: 0.45029133558273315
The modified gen p mean: 0.45201241970062256, gen p mean: -0.12608623504638672, mean p set: 0.4525899887084961
loss_pred:0.016295278444886208, decouple_loss:0.0007661191048100591
loss_pred:0.015187973156571388, decouple_loss:0.0005576756084337831
The modified gen p mean: 0.45034259557724, gen p mean: -0.12706826627254486, mean p set: 0.4509196877479553
loss_pred:0.01564330980181694, decouple_loss:0.000768020807299763
Iteration: 1968, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492619037628174, gen p mean: -0.12859274446964264, mean p set: 0.4498387575149536
loss_pred:0.015999292954802513, decouple_loss:0.00048567241174168885
The modified gen p mean: 0.4496762156486511, gen p mean: -0.12807200849056244, mean p set: 0.4502543807029724
loss_pred:0.015987250953912735, decouple_loss:0.0006446036277338862
The modified gen p mean: 0.4497845470905304, gen p mean: -0.1258191466331482, mean p set: 0.4503602981567383
loss_pred:0.01551620289683342, decouple_loss:0.0005532116047106683
Iteration: 1969, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45132601261138916, gen p mean: -0.12295280396938324, mean p set: 0.451905757188797
loss_pred:0.015589863993227482, decouple_loss:0.000753236236050725
The modified gen p mean: 0.4519391357898712, gen p mean: -0.1234784871339798, mean p set: 0.45251601934432983
loss_pred:0.015512071549892426, decouple_loss:0.0006660825456492603
The modified gen p mean: 0.45077136158943176, gen p mean: -0.12766458094120026, mean p set: 0.45135000348091125
loss_pred:0.015758585184812546, decouple_loss:0.0007831888506188989
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012000_3_24hr.npz
NaN value num: 0
Iteration: 1970, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45108526945114136, gen p mean: -0.12142125517129898, mean p set: 0.4516620337963104
loss_pred:0.015072051435709, decouple_loss:0.0006931413663551211
The modified gen p mean: 0.4511828124523163, gen p mean: -0.11856959015130997, mean p set: 0.45175832509994507
The modified gen p mean: 0.45131880044937134, gen p mean: -0.1225195974111557, mean p set: 0.4518939256668091
loss_pred:0.014888261444866657, decouple_loss:0.0008166888728737831
loss_pred:0.014958498999476433, decouple_loss:0.0007107413257472217
2023-05-01 23:15:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12916308641433716, mean p set: 0.4502691626548767
loss_pred:0.017071615904569626, decouple_loss:0.0005040431278757751
The modified gen p mean: 0.44953569769859314, gen p mean: -0.12321165204048157, mean p set: 0.4500633478164673
loss_pred:0.01630067266523838, decouple_loss:0.0005387538694776595
The modified gen p mean: 0.44977885484695435, gen p mean: -0.12343506515026093, mean p set: 0.45035696029663086
loss_pred:0.016568299382925034, decouple_loss:0.0006400777492672205
WV_1_PC_1_EH_0_PS_40, loss: 0.016674911603331566, avg_mse: 0.02603834494948387
current test mse: 0.026038
Iteration: 1971, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45072877407073975, gen p mean: -0.12140555679798126, mean p set: 0.45130327343940735
loss_pred:0.01475441362708807, decouple_loss:0.0005012291367165744
The modified gen p mean: 0.4517446756362915, gen p mean: -0.12073621898889542, mean p set: 0.4523191750049591The modified gen p mean: 0.45188048481941223, gen p mean: -0.11809194833040237, mean p set: 0.4524591267108917
loss_pred:0.015397205948829651, decouple_loss:0.0006421228172257543
loss_pred:0.014802183024585247, decouple_loss:0.0005867512663826346
Iteration: 1972, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504893124103546, gen p mean: -0.1245700791478157, mean p set: 0.4510645270347595
loss_pred:0.01474807783961296, decouple_loss:0.0005766358226537704
The modified gen p mean: 0.4500645399093628, gen p mean: -0.12060564011335373, mean p set: 0.4506407380104065The modified gen p mean: 0.4487553536891937, gen p mean: -0.1268465220928192, mean p set: 0.4493304491043091
loss_pred:0.015169414691627026, decouple_loss:0.0005972026847302914
loss_pred:0.015152744948863983, decouple_loss:0.0007153826882131398
Iteration: 1973, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44804444909095764, gen p mean: -0.12872065603733063, mean p set: 0.44862014055252075
loss_pred:0.014689348638057709, decouple_loss:0.0006470418302342296
The modified gen p mean: 0.4513576626777649, gen p mean: -0.12139885127544403, mean p set: 0.4519321024417877
loss_pred:0.014660367742180824, decouple_loss:0.0005114604136906564
The modified gen p mean: 0.450859010219574, gen p mean: -0.11857359111309052, mean p set: 0.4514331519603729
loss_pred:0.014908854849636555, decouple_loss:0.0006813775980845094
Iteration: 1974, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4489933252334595, gen p mean: -0.12363282591104507, mean p set: 0.4495701789855957
loss_pred:0.01552364882081747, decouple_loss:0.0005238026496954262
The modified gen p mean: 0.44929632544517517, gen p mean: -0.12271548062562943, mean p set: 0.4498729407787323
loss_pred:0.01590358465909958, decouple_loss:0.0004706623440142721
The modified gen p mean: 0.44959279894828796, gen p mean: -0.1312178373336792, mean p set: 0.4501676559448242
loss_pred:0.015246445313096046, decouple_loss:0.0004453594738151878
Iteration: 1975, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503946900367737, gen p mean: -0.12995502352714539, mean p set: 0.4509674608707428
loss_pred:0.014659194275736809, decouple_loss:0.0007671785424463451
The modified gen p mean: 0.45156973600387573, gen p mean: -0.12430203706026077, mean p set: 0.4521452486515045
loss_pred:0.014610080048441887, decouple_loss:0.0006165401428006589
The modified gen p mean: 0.45114123821258545, gen p mean: -0.12255409359931946, mean p set: 0.4517160654067993
loss_pred:0.01530684344470501, decouple_loss:0.0006995674921199679
Iteration: 1976, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510609209537506, gen p mean: -0.12498853355646133, mean p set: 0.4516368806362152
loss_pred:0.015233876183629036, decouple_loss:0.0006575451116077602
The modified gen p mean: 0.4493737816810608, gen p mean: -0.13346333801746368, mean p set: 0.449952095746994
loss_pred:0.014777039177715778, decouple_loss:0.0005172796081751585
The modified gen p mean: 0.449701726436615, gen p mean: -0.12622477114200592, mean p set: 0.45028162002563477
loss_pred:0.01571148820221424, decouple_loss:0.0006662984378635883
Iteration: 1977, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45140424370765686, gen p mean: -0.12556709349155426, mean p set: 0.45198073983192444
loss_pred:0.014704479835927486, decouple_loss:0.0005842957179993391
The modified gen p mean: 0.44987356662750244, gen p mean: -0.13243050873279572, mean p set: 0.4504474103450775
loss_pred:0.014912640675902367, decouple_loss:0.0005040386458858848
The modified gen p mean: 0.45137572288513184, gen p mean: -0.12433485686779022, mean p set: 0.45195427536964417
loss_pred:0.014488661661744118, decouple_loss:0.0004704498569481075
Iteration: 1978, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502972364425659, gen p mean: -0.1277758628129959, mean p set: 0.45087674260139465
loss_pred:0.015732118859887123, decouple_loss:0.000555862789042294
The modified gen p mean: 0.4512457549571991, gen p mean: -0.12717123329639435, mean p set: 0.4518211781978607
The modified gen p mean: 0.4494136869907379, gen p mean: -0.1300675868988037, mean p set: 0.44998836517333984
loss_pred:0.015552149154245853, decouple_loss:0.0006264892872422934
loss_pred:0.01499348133802414, decouple_loss:0.0005751607823185623
Iteration: 1979, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4526861906051636, gen p mean: -0.12647771835327148, mean p set: 0.45326003432273865
loss_pred:0.014603427611291409, decouple_loss:0.000666173524223268
The modified gen p mean: 0.4486505687236786, gen p mean: -0.13136537373065948, mean p set: 0.44922778010368347
The modified gen p mean: 0.4514564871788025, gen p mean: -0.1245916485786438, mean p set: 0.4520314931869507
loss_pred:0.015093034133315086, decouple_loss:0.0005080149858258665
loss_pred:0.014544718898832798, decouple_loss:0.0007158260559663177
Iteration: 1980, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4495968818664551, gen p mean: -0.12379682064056396, mean p set: 0.4501752555370331
loss_pred:0.014905826188623905, decouple_loss:0.0006594969891011715
The modified gen p mean: 0.4527408480644226, gen p mean: -0.12485533952713013, mean p set: 0.4533170461654663
loss_pred:0.014512678608298302, decouple_loss:0.0006024616304785013
The modified gen p mean: 0.4511287808418274, gen p mean: -0.12311109900474548, mean p set: 0.4517051577568054
loss_pred:0.015024933964014053, decouple_loss:0.0005303845973685384
2023-05-01 23:17:23 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13552866876125336, mean p set: 0.4502691626548767
loss_pred:0.017069436609745026, decouple_loss:0.0006258562207221985
The modified gen p mean: 0.44953295588493347, gen p mean: -0.12948277592658997, mean p set: 0.4500633478164673
loss_pred:0.016282590106129646, decouple_loss:0.0008006005082279444
The modified gen p mean: 0.44978010654449463, gen p mean: -0.1290939450263977, mean p set: 0.45035696029663086
loss_pred:0.01658535562455654, decouple_loss:0.0010523975361138582
WV_1_PC_1_EH_0_PS_40, loss: 0.01668710820376873, avg_mse: 0.025999877601861954
current test mse: 0.026
Iteration: 1981, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45017609000205994, gen p mean: -0.12691272795200348, mean p set: 0.45075374841690063
loss_pred:0.015096314251422882, decouple_loss:0.0006109545356594026
The modified gen p mean: 0.4513992369174957, gen p mean: -0.12228113412857056, mean p set: 0.45197638869285583The modified gen p mean: 0.44929414987564087, gen p mean: -0.12534268200397491, mean p set: 0.4498688280582428
loss_pred:0.014256391674280167, decouple_loss:0.00047623852151446044
loss_pred:0.014792023226618767, decouple_loss:0.0006478957366198301
Iteration: 1982, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44964417815208435, gen p mean: -0.137753427028656, mean p set: 0.45022377371788025
loss_pred:0.014837503433227539, decouple_loss:0.0004498146881815046
The modified gen p mean: 0.44989821314811707, gen p mean: -0.12992796301841736, mean p set: 0.4504731595516205The modified gen p mean: 0.45150911808013916, gen p mean: -0.12957565486431122, mean p set: 0.45208731293678284
loss_pred:0.014850755222141743, decouple_loss:0.0006257604691199958
loss_pred:0.014585656113922596, decouple_loss:0.0004934303578920662
Iteration: 1983, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44882577657699585, gen p mean: -0.13361062109470367, mean p set: 0.44940266013145447
loss_pred:0.014785148203372955, decouple_loss:0.0005100367707200348
The modified gen p mean: 0.4497680068016052, gen p mean: -0.13655796647071838, mean p set: 0.4503476321697235The modified gen p mean: 0.44894126057624817, gen p mean: -0.13333921134471893, mean p set: 0.44951876997947693
loss_pred:0.014768536202609539, decouple_loss:0.0004932968295179307loss_pred:0.014885833486914635, decouple_loss:0.000579262210521847
Iteration: 1984, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448952853679657, gen p mean: -0.13701823353767395, mean p set: 0.44953182339668274
loss_pred:0.014949627220630646, decouple_loss:0.0004875655868090689
The modified gen p mean: 0.449715256690979, gen p mean: -0.1355292946100235, mean p set: 0.45029211044311523
loss_pred:0.014887840487062931, decouple_loss:0.000521003152243793
The modified gen p mean: 0.4493398368358612, gen p mean: -0.13340266048908234, mean p set: 0.4499163329601288
loss_pred:0.01598937436938286, decouple_loss:0.00045117258559912443
Iteration: 1985, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510499835014343, gen p mean: -0.1325177699327469, mean p set: 0.45162567496299744
loss_pred:0.01509171910583973, decouple_loss:0.0004438491305336356
The modified gen p mean: 0.4492577016353607, gen p mean: -0.12735475599765778, mean p set: 0.4498332440853119
loss_pred:0.014931079000234604, decouple_loss:0.0005119746783748269
The modified gen p mean: 0.45275530219078064, gen p mean: -0.13070443272590637, mean p set: 0.45333418250083923
loss_pred:0.014119239524006844, decouple_loss:0.0006220306968316436
Iteration: 1986, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451181560754776, gen p mean: -0.13007768988609314, mean p set: 0.4517599642276764
loss_pred:0.014384149573743343, decouple_loss:0.000574530684389174
The modified gen p mean: 0.44756510853767395, gen p mean: -0.13767525553703308, mean p set: 0.448142409324646
The modified gen p mean: 0.45205074548721313, gen p mean: -0.1316230446100235, mean p set: 0.45262959599494934
loss_pred:0.015344674699008465, decouple_loss:0.0005317984614521265
loss_pred:0.014190364629030228, decouple_loss:0.00044825798249803483
Iteration: 1987, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514102339744568, gen p mean: -0.12974493205547333, mean p set: 0.4519873261451721
loss_pred:0.015156896784901619, decouple_loss:0.0005540736601687968
The modified gen p mean: 0.45065590739250183, gen p mean: -0.12404606491327286, mean p set: 0.4512324035167694
loss_pred:0.015056977979838848, decouple_loss:0.00048177794087678194
The modified gen p mean: 0.44915854930877686, gen p mean: -0.12534719705581665, mean p set: 0.4497356712818146
loss_pred:0.014532387256622314, decouple_loss:0.0005391602753661573
Iteration: 1988, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452790766954422, gen p mean: -0.12626658380031586, mean p set: 0.4533640444278717
loss_pred:0.014656564220786095, decouple_loss:0.0007228849572129548
The modified gen p mean: 0.4510246515274048, gen p mean: -0.12555958330631256, mean p set: 0.4516025483608246
The modified gen p mean: 0.4496460556983948, gen p mean: -0.1234804093837738, mean p set: 0.45022279024124146
loss_pred:0.01518575195223093, decouple_loss:0.0005724999355152249
loss_pred:0.01485496200621128, decouple_loss:0.0005130941863171756
Iteration: 1989, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44969162344932556, gen p mean: -0.12200281023979187, mean p set: 0.45026808977127075
loss_pred:0.015191776677966118, decouple_loss:0.0004241720016580075
The modified gen p mean: 0.4512499272823334, gen p mean: -0.12126772850751877, mean p set: 0.4518289566040039
loss_pred:0.013994128443300724, decouple_loss:0.0004363851621747017
The modified gen p mean: 0.44982287287712097, gen p mean: -0.1259944587945938, mean p set: 0.45039960741996765
loss_pred:0.015446474775671959, decouple_loss:0.0005014986963942647
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012017_3_24hr.npz
NaN value num: 0
Iteration: 1990, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45159322023391724, gen p mean: -0.11837825179100037, mean p set: 0.4521697759628296
loss_pred:0.01568891666829586, decouple_loss:0.0007114468608051538
The modified gen p mean: 0.45231175422668457, gen p mean: -0.11636289209127426, mean p set: 0.45288676023483276
The modified gen p mean: 0.44967082142829895, gen p mean: -0.11897441744804382, mean p set: 0.4502466022968292
loss_pred:0.016171369701623917, decouple_loss:0.0007920649950392544
loss_pred:0.01612064428627491, decouple_loss:0.0005001522949896753
2023-05-01 23:20:07 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12527628242969513, mean p set: 0.4502691626548767
loss_pred:0.017074191942811012, decouple_loss:0.00045924942241981626
The modified gen p mean: 0.44953465461730957, gen p mean: -0.11929415166378021, mean p set: 0.4500633478164673
loss_pred:0.016266297549009323, decouple_loss:0.0005543161532841623
The modified gen p mean: 0.4497806131839752, gen p mean: -0.11882980167865753, mean p set: 0.45035696029663086
loss_pred:0.016632860526442528, decouple_loss:0.0005554406670853496
WV_1_PC_1_EH_0_PS_40, loss: 0.01668393425643444, avg_mse: 0.02600575052201748
current test mse: 0.026006
Iteration: 1991, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450035959482193, gen p mean: -0.1155799999833107, mean p set: 0.4506123960018158
loss_pred:0.015725599601864815, decouple_loss:0.0007767045171931386
The modified gen p mean: 0.45177245140075684, gen p mean: -0.11136946082115173, mean p set: 0.4523504674434662The modified gen p mean: 0.4498124420642853, gen p mean: -0.11506791412830353, mean p set: 0.4503864049911499
loss_pred:0.016339555382728577, decouple_loss:0.0006473202956840396loss_pred:0.01650826260447502, decouple_loss:0.0005184931214898825
Iteration: 1992, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496382176876068, gen p mean: -0.118342824280262, mean p set: 0.45021387934684753
loss_pred:0.015625985339283943, decouple_loss:0.0006636035977862775
The modified gen p mean: 0.4521710276603699, gen p mean: -0.11126331984996796, mean p set: 0.45275044441223145The modified gen p mean: 0.4488982558250427, gen p mean: -0.11643875390291214, mean p set: 0.4494730830192566
loss_pred:0.016173390671610832, decouple_loss:0.0007106245611794293loss_pred:0.015640780329704285, decouple_loss:0.0005232597468420863
Iteration: 1993, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501665234565735, gen p mean: -0.12199264764785767, mean p set: 0.45074281096458435
loss_pred:0.01590672880411148, decouple_loss:0.0005307645187713206
The modified gen p mean: 0.44931575655937195, gen p mean: -0.11765223741531372, mean p set: 0.44989094138145447
loss_pred:0.015726732090115547, decouple_loss:0.0007034793379716575
The modified gen p mean: 0.45132434368133545, gen p mean: -0.12072723358869553, mean p set: 0.4519013464450836
loss_pred:0.015714334324002266, decouple_loss:0.000734569039195776
Iteration: 1994, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4488983154296875, gen p mean: -0.12987960875034332, mean p set: 0.4494739770889282
loss_pred:0.016432568430900574, decouple_loss:0.0005778541672043502
The modified gen p mean: 0.4518864154815674, gen p mean: -0.11872545629739761, mean p set: 0.4524637460708618
loss_pred:0.016284996643662453, decouple_loss:0.0005950351478531957
The modified gen p mean: 0.4515499472618103, gen p mean: -0.12033853679895401, mean p set: 0.4521242678165436
loss_pred:0.016168490052223206, decouple_loss:0.0006828810437582433
Iteration: 1995, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507724940776825, gen p mean: -0.12486174702644348, mean p set: 0.4513484537601471
loss_pred:0.015213320963084698, decouple_loss:0.000574638310354203
The modified gen p mean: 0.44974949955940247, gen p mean: -0.12509511411190033, mean p set: 0.4503243863582611
loss_pred:0.015434199012815952, decouple_loss:0.000656094285659492
The modified gen p mean: 0.4486553966999054, gen p mean: -0.1302776038646698, mean p set: 0.4492310881614685
loss_pred:0.016059959307312965, decouple_loss:0.0006839820416644216
Iteration: 1996, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449924111366272, gen p mean: -0.12319568544626236, mean p set: 0.4504959285259247
The modified gen p mean: 0.45219793915748596, gen p mean: -0.1203673779964447, mean p set: 0.4527750313282013
loss_pred:0.016062360256910324, decouple_loss:0.0008455726783722639
loss_pred:0.015452203340828419, decouple_loss:0.0008984653395600617
The modified gen p mean: 0.4518573582172394, gen p mean: -0.12268169224262238, mean p set: 0.4524324834346771
loss_pred:0.015467320568859577, decouple_loss:0.0009276011260226369
Iteration: 1997, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45221102237701416, gen p mean: -0.1190999448299408, mean p set: 0.4527881443500519
loss_pred:0.01609899289906025, decouple_loss:0.00047564980923198164
The modified gen p mean: 0.45193636417388916, gen p mean: -0.12039901316165924, mean p set: 0.452515572309494
loss_pred:0.01597723737359047, decouple_loss:0.000545448565389961
The modified gen p mean: 0.4497453570365906, gen p mean: -0.1202196255326271, mean p set: 0.4503213167190552
loss_pred:0.015188396908342838, decouple_loss:0.0005574806127697229
Iteration: 1998, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44937214255332947, gen p mean: -0.12123774737119675, mean p set: 0.449949711561203
loss_pred:0.01521969586610794, decouple_loss:0.00048693950520828366
The modified gen p mean: 0.4492339789867401, gen p mean: -0.11887515336275101, mean p set: 0.4498138427734375
loss_pred:0.01557439099997282, decouple_loss:0.0005694034043699503
The modified gen p mean: 0.45033928751945496, gen p mean: -0.11826549470424652, mean p set: 0.4509148597717285
loss_pred:0.014905902557075024, decouple_loss:0.0005058399401605129
Iteration: 1999, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521680474281311, gen p mean: -0.11148136109113693, mean p set: 0.45274588465690613
loss_pred:0.01516100112348795, decouple_loss:0.000741311174351722
The modified gen p mean: 0.4487873911857605, gen p mean: -0.12025774270296097, mean p set: 0.4493626356124878
loss_pred:0.0157710462808609, decouple_loss:0.0004719322023447603
The modified gen p mean: 0.4513857066631317, gen p mean: -0.1170286014676094, mean p set: 0.45195919275283813
loss_pred:0.015621027909219265, decouple_loss:0.0005533308140002191
Iteration: 2000, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45212700963020325, gen p mean: -0.1134423166513443, mean p set: 0.45270055532455444
loss_pred:0.01571042649447918, decouple_loss:0.0004904996603727341
The modified gen p mean: 0.4485762417316437, gen p mean: -0.1197810247540474, mean p set: 0.44915124773979187
loss_pred:0.015858620405197144, decouple_loss:0.00045085331657901406
The modified gen p mean: 0.4487179219722748, gen p mean: -0.12196050584316254, mean p set: 0.44929152727127075
loss_pred:0.016028471291065216, decouple_loss:0.000499651359859854
2023-05-01 23:22:13 itr: 2000
training loss: [0.01605345 0.01573495 0.01588116]
save model to /work/09012/haoli1/ls6/ERA5_PredRNN/checkpoints/WV_1_PC_1_EH_0_PS_40/model_2000.ckpt
2023-05-01 23:22:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12808755040168762, mean p set: 0.4502691626548767
loss_pred:0.017057541757822037, decouple_loss:0.000599536404479295
The modified gen p mean: 0.4495333433151245, gen p mean: -0.12203184515237808, mean p set: 0.4500633478164673
loss_pred:0.016298819333314896, decouple_loss:0.0005564359598793089
The modified gen p mean: 0.4497791528701782, gen p mean: -0.12167000770568848, mean p set: 0.45035696029663086
loss_pred:0.01666412502527237, decouple_loss:0.00048559653805568814
WV_1_PC_1_EH_0_PS_40, loss: 0.016700856387615204, avg_mse: 0.025985803455114365
current test mse: 0.025986
Iteration: 2001, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45201751589775085, gen p mean: -0.12009766697883606, mean p set: 0.4525927007198334
loss_pred:0.01489254180341959, decouple_loss:0.0005238950252532959
The modified gen p mean: 0.4501187205314636, gen p mean: -0.11663726717233658, mean p set: 0.4506973326206207
loss_pred:0.016060486435890198, decouple_loss:0.0005279342294670641
The modified gen p mean: 0.4511411786079407, gen p mean: -0.11455120891332626, mean p set: 0.45171716809272766
loss_pred:0.016101252287626266, decouple_loss:0.0006546584190800786
Iteration: 2002, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44939741492271423, gen p mean: -0.12164180725812912, mean p set: 0.44997072219848633
loss_pred:0.015891019254922867, decouple_loss:0.0005883678677491844
The modified gen p mean: 0.4493519365787506, gen p mean: -0.11900215595960617, mean p set: 0.44993001222610474The modified gen p mean: 0.45161306858062744, gen p mean: -0.11918769776821136, mean p set: 0.45219019055366516
loss_pred:0.015500513836741447, decouple_loss:0.000601599516812712
loss_pred:0.01558915339410305, decouple_loss:0.0006154118455015123
Iteration: 2003, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44978663325309753, gen p mean: -0.11328623443841934, mean p set: 0.45036324858665466
loss_pred:0.015007424168288708, decouple_loss:0.0006197744514793158
The modified gen p mean: 0.4516007602214813, gen p mean: -0.11337116360664368, mean p set: 0.45218008756637573
loss_pred:0.01627013273537159, decouple_loss:0.0006806719466112554
The modified gen p mean: 0.44983962178230286, gen p mean: -0.11929471790790558, mean p set: 0.4504155218601227
loss_pred:0.017185479402542114, decouple_loss:0.000545507064089179
Iteration: 2004, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45166635513305664, gen p mean: -0.11790511757135391, mean p set: 0.4522422254085541
loss_pred:0.015779973939061165, decouple_loss:0.0005449267919175327
The modified gen p mean: 0.44914087653160095, gen p mean: -0.1206078827381134, mean p set: 0.4497171640396118
loss_pred:0.015075529925525188, decouple_loss:0.0004768820363096893
The modified gen p mean: 0.4519454538822174, gen p mean: -0.12029663473367691, mean p set: 0.4525245130062103
loss_pred:0.01489600446075201, decouple_loss:0.0005919181858189404
Iteration: 2005, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450181245803833, gen p mean: -0.12542788684368134, mean p set: 0.4507574439048767
The modified gen p mean: 0.4522398114204407, gen p mean: -0.12081850320100784, mean p set: 0.45281848311424255
loss_pred:0.016270499676465988, decouple_loss:0.0005232684197835624
loss_pred:0.01579582318663597, decouple_loss:0.0005771723226644099
The modified gen p mean: 0.4516148865222931, gen p mean: -0.12196090817451477, mean p set: 0.4521923363208771
loss_pred:0.015850938856601715, decouple_loss:0.0004937389167025685
Iteration: 2006, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513367712497711, gen p mean: -0.11976882815361023, mean p set: 0.45191019773483276
loss_pred:0.015912042930722237, decouple_loss:0.00047259434359148145
The modified gen p mean: 0.4527817368507385, gen p mean: -0.11865393072366714, mean p set: 0.45335903763771057
The modified gen p mean: 0.44976332783699036, gen p mean: -0.12434739619493484, mean p set: 0.45034095644950867
loss_pred:0.015364904887974262, decouple_loss:0.0004746007325593382
loss_pred:0.016063719987869263, decouple_loss:0.00048620853340253234
Iteration: 2007, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4493270814418793, gen p mean: -0.1251772940158844, mean p set: 0.4499017596244812
The modified gen p mean: 0.4518233835697174, gen p mean: -0.1157219409942627, mean p set: 0.4524017870426178
loss_pred:0.016810908913612366, decouple_loss:0.0004905305686406791
loss_pred:0.015440848655998707, decouple_loss:0.0006451999070122838
The modified gen p mean: 0.4498768448829651, gen p mean: -0.12550970911979675, mean p set: 0.4504547715187073
loss_pred:0.016976386308670044, decouple_loss:0.0004580006352625787
Iteration: 2008, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44901350140571594, gen p mean: -0.12340546399354935, mean p set: 0.4495861530303955
loss_pred:0.01597847230732441, decouple_loss:0.00046766333980485797
The modified gen p mean: 0.450160950422287, gen p mean: -0.12491853535175323, mean p set: 0.450737327337265
loss_pred:0.01565437577664852, decouple_loss:0.0004505086690187454
The modified gen p mean: 0.45216572284698486, gen p mean: -0.11934736371040344, mean p set: 0.452744722366333
loss_pred:0.015196496620774269, decouple_loss:0.000602994579821825
Iteration: 2009, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4519346058368683, gen p mean: -0.11796635389328003, mean p set: 0.4525114893913269
loss_pred:0.016148598864674568, decouple_loss:0.0004748316714540124
The modified gen p mean: 0.4513086676597595, gen p mean: -0.11867030709981918, mean p set: 0.45188307762145996
loss_pred:0.01600339263677597, decouple_loss:0.0006229985738173127
The modified gen p mean: 0.4502083957195282, gen p mean: -0.11958813667297363, mean p set: 0.4507834315299988
loss_pred:0.015167833305895329, decouple_loss:0.0006043777102604508
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012015_3_24hr.npz
NaN value num: 0
Iteration: 2010, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4465886056423187, gen p mean: -0.12575609982013702, mean p set: 0.4471641182899475
The modified gen p mean: 0.44700634479522705, gen p mean: -0.12411367893218994, mean p set: 0.4475829601287842
loss_pred:0.016903625801205635, decouple_loss:0.0005821303930133581
loss_pred:0.01562429964542389, decouple_loss:0.0005274220602586865
The modified gen p mean: 0.4478713572025299, gen p mean: -0.12341979891061783, mean p set: 0.4484466016292572
loss_pred:0.01709955930709839, decouple_loss:0.0004782628093380481
2023-05-01 23:25:00 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13156768679618835, mean p set: 0.4502691626548767
loss_pred:0.017017895355820656, decouple_loss:0.000590896001085639
The modified gen p mean: 0.4495346248149872, gen p mean: -0.12519609928131104, mean p set: 0.4500633478164673
loss_pred:0.01627991907298565, decouple_loss:0.0006024055182933807
The modified gen p mean: 0.4497823715209961, gen p mean: -0.12490909546613693, mean p set: 0.45035696029663086
loss_pred:0.016674501821398735, decouple_loss:0.0005653098342008889
WV_1_PC_1_EH_0_PS_40, loss: 0.01668674871325493, avg_mse: 0.026011520996689796
current test mse: 0.026012
Iteration: 2011, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4452996253967285, gen p mean: -0.12698693573474884, mean p set: 0.44587424397468567
loss_pred:0.017886295914649963, decouple_loss:0.0005986174219287932
The modified gen p mean: 0.44652044773101807, gen p mean: -0.11982783675193787, mean p set: 0.4470962882041931The modified gen p mean: 0.44532257318496704, gen p mean: -0.12615206837654114, mean p set: 0.44589856266975403
loss_pred:0.017561858519911766, decouple_loss:0.0005848798900842667
loss_pred:0.016941724345088005, decouple_loss:0.0007973213796503842
Iteration: 2012, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446844220161438, gen p mean: -0.12166895717382431, mean p set: 0.4474199414253235
loss_pred:0.017316386103630066, decouple_loss:0.0006092606927268207
The modified gen p mean: 0.4475664496421814, gen p mean: -0.12251784652471542, mean p set: 0.44814398884773254The modified gen p mean: 0.44725868105888367, gen p mean: -0.12149327248334885, mean p set: 0.4478325843811035
loss_pred:0.016331294551491737, decouple_loss:0.0005709188990294933
loss_pred:0.01736394315958023, decouple_loss:0.0005070812767371535
Iteration: 2013, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470961093902588, gen p mean: -0.1206633523106575, mean p set: 0.4476702809333801
loss_pred:0.016400717198848724, decouple_loss:0.0006722344551235437
The modified gen p mean: 0.4469124972820282, gen p mean: -0.12021374702453613, mean p set: 0.4474896788597107
loss_pred:0.016182366758584976, decouple_loss:0.0005956360255368054
The modified gen p mean: 0.44787341356277466, gen p mean: -0.12121016532182693, mean p set: 0.4484492540359497
loss_pred:0.01600920408964157, decouple_loss:0.00076660281047225
Iteration: 2014, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455221891403198, gen p mean: -0.11632205545902252, mean p set: 0.44609498977661133
loss_pred:0.017058352008461952, decouple_loss:0.0005183363100513816
The modified gen p mean: 0.4451656937599182, gen p mean: -0.1257304549217224, mean p set: 0.4457412362098694
loss_pred:0.016886282712221146, decouple_loss:0.0004597421793732792
The modified gen p mean: 0.44687360525131226, gen p mean: -0.11775979399681091, mean p set: 0.44745099544525146
loss_pred:0.017181046307086945, decouple_loss:0.0007692875806242228
Iteration: 2015, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477393329143524, gen p mean: -0.11845604330301285, mean p set: 0.4483163356781006
loss_pred:0.016837632283568382, decouple_loss:0.00048216833965852857
The modified gen p mean: 0.44676172733306885, gen p mean: -0.11643014848232269, mean p set: 0.44733667373657227
loss_pred:0.017357422038912773, decouple_loss:0.0005127576878294349
The modified gen p mean: 0.44731277227401733, gen p mean: -0.1156671792268753, mean p set: 0.44789019227027893
loss_pred:0.01637663133442402, decouple_loss:0.000506042328197509
Iteration: 2016, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44603297114372253, gen p mean: -0.1169690415263176, mean p set: 0.4466065764427185
loss_pred:0.016047239303588867, decouple_loss:0.0006804629229009151
The modified gen p mean: 0.4467512369155884, gen p mean: -0.11489683389663696, mean p set: 0.44732820987701416
loss_pred:0.01768081821501255, decouple_loss:0.0005789449205622077
The modified gen p mean: 0.4457615315914154, gen p mean: -0.12156516313552856, mean p set: 0.4463336765766144
loss_pred:0.01713544689118862, decouple_loss:0.000701924494933337
Iteration: 2017, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4469912350177765, gen p mean: -0.12069620937108994, mean p set: 0.44756653904914856
loss_pred:0.016540152952075005, decouple_loss:0.0005563895101659
The modified gen p mean: 0.44578689336776733, gen p mean: -0.11961475014686584, mean p set: 0.44635969400405884
loss_pred:0.016368839889764786, decouple_loss:0.0004987643333151937
The modified gen p mean: 0.4474830627441406, gen p mean: -0.12410109490156174, mean p set: 0.44805923104286194
loss_pred:0.017205534502863884, decouple_loss:0.0006651973817497492
Iteration: 2018, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44633832573890686, gen p mean: -0.11989810317754745, mean p set: 0.44691455364227295
loss_pred:0.016446121037006378, decouple_loss:0.0006609710399061441
The modified gen p mean: 0.4454084634780884, gen p mean: -0.12495473772287369, mean p set: 0.4459850490093231
The modified gen p mean: 0.4462521970272064, gen p mean: -0.12110607326030731, mean p set: 0.44682827591896057
loss_pred:0.0168328657746315, decouple_loss:0.0005697156302630901
loss_pred:0.017690176144242287, decouple_loss:0.0007011007401160896
Iteration: 2019, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44707486033439636, gen p mean: -0.1217270940542221, mean p set: 0.4476500451564789
loss_pred:0.016665460541844368, decouple_loss:0.00081139977555722
The modified gen p mean: 0.44603440165519714, gen p mean: -0.12549501657485962, mean p set: 0.4466082453727722
loss_pred:0.016702845692634583, decouple_loss:0.0004332107782829553
The modified gen p mean: 0.44528818130493164, gen p mean: -0.12234490364789963, mean p set: 0.4458599388599396
loss_pred:0.01649668626487255, decouple_loss:0.0004818396409973502
Iteration: 2020, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44704025983810425, gen p mean: -0.12295068055391312, mean p set: 0.44761335849761963
loss_pred:0.01735537312924862, decouple_loss:0.0007158918888308108
The modified gen p mean: 0.44775235652923584, gen p mean: -0.12412914633750916, mean p set: 0.44832971692085266
loss_pred:0.017467621713876724, decouple_loss:0.0004576358769554645
The modified gen p mean: 0.4476046860218048, gen p mean: -0.1273263394832611, mean p set: 0.44818219542503357
loss_pred:0.016825200989842415, decouple_loss:0.0004966460401192307
2023-05-01 23:27:06 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13194167613983154, mean p set: 0.4502691626548767
loss_pred:0.017004666849970818, decouple_loss:0.000665439642034471
The modified gen p mean: 0.4495345652103424, gen p mean: -0.12582652270793915, mean p set: 0.4500633478164673
loss_pred:0.01632501371204853, decouple_loss:0.0006807669997215271
The modified gen p mean: 0.44977888464927673, gen p mean: -0.12579494714736938, mean p set: 0.45035696029663086
loss_pred:0.016662048175930977, decouple_loss:0.0006929085939191282
WV_1_PC_1_EH_0_PS_40, loss: 0.016697896644473076, avg_mse: 0.026027029380202293
current test mse: 0.026027
Iteration: 2021, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44647303223609924, gen p mean: -0.12342436611652374, mean p set: 0.44704747200012207
loss_pred:0.01624893769621849, decouple_loss:0.0005475100479088724
The modified gen p mean: 0.4473261833190918, gen p mean: -0.12548516690731049, mean p set: 0.4479012191295624
loss_pred:0.017160490155220032, decouple_loss:0.00043810997158288956
The modified gen p mean: 0.44562703371047974, gen p mean: -0.12013325095176697, mean p set: 0.44620171189308167
loss_pred:0.01726430281996727, decouple_loss:0.0005586964543908834
Iteration: 2022, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44777771830558777, gen p mean: -0.12494275718927383, mean p set: 0.4483541250228882
loss_pred:0.01660814695060253, decouple_loss:0.00047775395796634257
The modified gen p mean: 0.4453590512275696, gen p mean: -0.13327084481716156, mean p set: 0.4459342360496521The modified gen p mean: 0.4476768970489502, gen p mean: -0.12601681053638458, mean p set: 0.4482518434524536
loss_pred:0.01689204014837742, decouple_loss:0.0005307723768055439
loss_pred:0.016698190942406654, decouple_loss:0.0005020637763664126
Iteration: 2023, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461541473865509, gen p mean: -0.13443653285503387, mean p set: 0.44673120975494385
loss_pred:0.016919022426009178, decouple_loss:0.0005029449239373207
The modified gen p mean: 0.44598421454429626, gen p mean: -0.12989914417266846, mean p set: 0.4465598464012146The modified gen p mean: 0.4474797248840332, gen p mean: -0.13514691591262817, mean p set: 0.4480588138103485
loss_pred:0.016367003321647644, decouple_loss:0.0005190177471376956loss_pred:0.01736205443739891, decouple_loss:0.0004709556233137846
Iteration: 2024, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4462594985961914, gen p mean: -0.13423122465610504, mean p set: 0.4468361735343933
loss_pred:0.017406128346920013, decouple_loss:0.0005381152150221169
The modified gen p mean: 0.44807004928588867, gen p mean: -0.1304645985364914, mean p set: 0.44864365458488464
loss_pred:0.016159003600478172, decouple_loss:0.0005503610009327531
The modified gen p mean: 0.4457349181175232, gen p mean: -0.12399660050868988, mean p set: 0.4463099241256714
loss_pred:0.01697397790849209, decouple_loss:0.0005451526376418769
Iteration: 2025, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44620126485824585, gen p mean: -0.13854269683361053, mean p set: 0.4467763900756836
loss_pred:0.016994958743453026, decouple_loss:0.0005860743694938719
The modified gen p mean: 0.4478156268596649, gen p mean: -0.13193067908287048, mean p set: 0.4483919143676758
loss_pred:0.016069360077381134, decouple_loss:0.0005522329011000693
The modified gen p mean: 0.44863998889923096, gen p mean: -0.13068556785583496, mean p set: 0.44921690225601196
loss_pred:0.016442932188510895, decouple_loss:0.0005659058806486428
Iteration: 2026, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466738700866699, gen p mean: -0.12599776685237885, mean p set: 0.44724923372268677
loss_pred:0.016772352159023285, decouple_loss:0.00042559520807117224
The modified gen p mean: 0.44673818349838257, gen p mean: -0.1330188363790512, mean p set: 0.44731420278549194
The modified gen p mean: 0.44887274503707886, gen p mean: -0.13035543262958527, mean p set: 0.4494474530220032
loss_pred:0.017146073281764984, decouple_loss:0.0004809289239346981
loss_pred:0.01706632412970066, decouple_loss:0.00046304971328936517
Iteration: 2027, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4473414123058319, gen p mean: -0.13012497127056122, mean p set: 0.4479162395000458
loss_pred:0.01679966039955616, decouple_loss:0.0005968857440166175
The modified gen p mean: 0.4460650682449341, gen p mean: -0.13067734241485596, mean p set: 0.4466424882411957
loss_pred:0.017365142703056335, decouple_loss:0.0006906897178851068
The modified gen p mean: 0.44653430581092834, gen p mean: -0.13215181231498718, mean p set: 0.4471109211444855
loss_pred:0.017422357574105263, decouple_loss:0.0004329965158831328
Iteration: 2028, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.448018342256546, gen p mean: -0.12982158362865448, mean p set: 0.44859373569488525
loss_pred:0.016711223870515823, decouple_loss:0.000682872487232089
The modified gen p mean: 0.4480036199092865, gen p mean: -0.12612172961235046, mean p set: 0.4485847055912018
The modified gen p mean: 0.44735604524612427, gen p mean: -0.12984584271907806, mean p set: 0.44793352484703064
loss_pred:0.016662685200572014, decouple_loss:0.0005625631893053651
loss_pred:0.01643461175262928, decouple_loss:0.00053344143088907
Iteration: 2029, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4463212788105011, gen p mean: -0.12929032742977142, mean p set: 0.4468995928764343
loss_pred:0.016931572929024696, decouple_loss:0.0004433494759723544
The modified gen p mean: 0.4479927718639374, gen p mean: -0.12977947294712067, mean p set: 0.4485665559768677
The modified gen p mean: 0.4477912187576294, gen p mean: -0.12869203090667725, mean p set: 0.4483678936958313
loss_pred:0.016946936026215553, decouple_loss:0.0004907266702502966
loss_pred:0.016417233273386955, decouple_loss:0.00045298077748157084
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012012_3_24hr.npz
NaN value num: 0
Iteration: 2030, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45321136713027954, gen p mean: -0.128743976354599, mean p set: 0.4537888467311859
The modified gen p mean: 0.4503483474254608, gen p mean: -0.13327573239803314, mean p set: 0.45092687010765076
loss_pred:0.01610320806503296, decouple_loss:0.0005683570052497089
loss_pred:0.015605255030095577, decouple_loss:0.0007256034878082573
The modified gen p mean: 0.45285680890083313, gen p mean: -0.12886391580104828, mean p set: 0.4534335732460022
loss_pred:0.01500529795885086, decouple_loss:0.0006018420099280775
2023-05-01 23:29:51 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.13459892570972443, mean p set: 0.4502691626548767
loss_pred:0.016950998455286026, decouple_loss:0.0012099143350496888
The modified gen p mean: 0.44953709840774536, gen p mean: -0.12827832996845245, mean p set: 0.4500633478164673
loss_pred:0.016373028978705406, decouple_loss:0.0008670563693158329
The modified gen p mean: 0.4497778117656708, gen p mean: -0.12817378342151642, mean p set: 0.45035696029663086
loss_pred:0.016666153445839882, decouple_loss:0.0008393333991989493
WV_1_PC_1_EH_0_PS_40, loss: 0.016711998730897903, avg_mse: 0.02601516991853714
current test mse: 0.026015
Iteration: 2031, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45239272713661194, gen p mean: -0.12885256111621857, mean p set: 0.4529707729816437
loss_pred:0.015566942282021046, decouple_loss:0.0006502140313386917
The modified gen p mean: 0.4484865963459015, gen p mean: -0.12740136682987213, mean p set: 0.4490624964237213The modified gen p mean: 0.45093774795532227, gen p mean: -0.12652526795864105, mean p set: 0.45151469111442566
loss_pred:0.016291415318846703, decouple_loss:0.0005947950994595885
loss_pred:0.01624768227338791, decouple_loss:0.00048604680341668427
Iteration: 2032, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.452418714761734, gen p mean: -0.12426397204399109, mean p set: 0.45299485325813293
loss_pred:0.01638614386320114, decouple_loss:0.0007093321764841676
The modified gen p mean: 0.4508388340473175, gen p mean: -0.12641465663909912, mean p set: 0.4514155089855194The modified gen p mean: 0.4509177803993225, gen p mean: -0.12658502161502838, mean p set: 0.45149579644203186
loss_pred:0.015644574537873268, decouple_loss:0.0006999877514317632loss_pred:0.016111183911561966, decouple_loss:0.0004535847110673785
Iteration: 2033, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4487675130367279, gen p mean: -0.12810087203979492, mean p set: 0.4493427276611328
loss_pred:0.016583627089858055, decouple_loss:0.0005394932231865823
The modified gen p mean: 0.44991686940193176, gen p mean: -0.1276138722896576, mean p set: 0.4504922032356262
loss_pred:0.016197653487324715, decouple_loss:0.0005696084117516875
The modified gen p mean: 0.44808343052864075, gen p mean: -0.13306349515914917, mean p set: 0.4486609697341919
loss_pred:0.016703369095921516, decouple_loss:0.0005850121378898621
Iteration: 2034, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4482637941837311, gen p mean: -0.11743330955505371, mean p set: 0.4488401710987091
loss_pred:0.017276393249630928, decouple_loss:0.0005113480146974325
The modified gen p mean: 0.45280078053474426, gen p mean: -0.11414305120706558, mean p set: 0.45337799191474915
loss_pred:0.015842851251363754, decouple_loss:0.0006888771895319223
The modified gen p mean: 0.45061931014060974, gen p mean: -0.11727572977542877, mean p set: 0.45119625329971313
loss_pred:0.01730451174080372, decouple_loss:0.0007400461472570896
Iteration: 2035, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44798365235328674, gen p mean: -0.12655992805957794, mean p set: 0.44856053590774536
loss_pred:0.02047395333647728, decouple_loss:0.000511511112563312
The modified gen p mean: 0.4497971832752228, gen p mean: -0.1259235441684723, mean p set: 0.45037373900413513
loss_pred:0.01863398775458336, decouple_loss:0.0006732200272381306
The modified gen p mean: 0.45187467336654663, gen p mean: -0.12411049008369446, mean p set: 0.45245006680488586
loss_pred:0.01847582682967186, decouple_loss:0.0009427477489225566
Iteration: 2036, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504653513431549, gen p mean: -0.12914232909679413, mean p set: 0.45104163885116577
loss_pred:0.026762906461954117, decouple_loss:0.0009024737519212067
The modified gen p mean: 0.45003798604011536, gen p mean: -0.12462776154279709, mean p set: 0.45061448216438293
loss_pred:0.025785522535443306, decouple_loss:0.0006731273024342954
The modified gen p mean: 0.4508753716945648, gen p mean: -0.12756361067295074, mean p set: 0.45144885778427124
loss_pred:0.02640799805521965, decouple_loss:0.000747816520743072
Iteration: 2037, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502612054347992, gen p mean: -0.14137805998325348, mean p set: 0.4508368670940399
loss_pred:0.022305317223072052, decouple_loss:0.0008638224098831415
The modified gen p mean: 0.44976523518562317, gen p mean: -0.1488213837146759, mean p set: 0.4503386318683624
The modified gen p mean: 0.44939735531806946, gen p mean: -0.14385893940925598, mean p set: 0.4499734938144684
loss_pred:0.023597124963998795, decouple_loss:0.0007797172875143588
loss_pred:0.023508187383413315, decouple_loss:0.0008223348995670676
Iteration: 2038, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45195841789245605, gen p mean: -0.1461474448442459, mean p set: 0.45253270864486694
loss_pred:0.023459676653146744, decouple_loss:0.0007886540843173862
The modified gen p mean: 0.4505581855773926, gen p mean: -0.1486731916666031, mean p set: 0.4511338472366333
loss_pred:0.022609788924455643, decouple_loss:0.0007917514303699136
The modified gen p mean: 0.44996652007102966, gen p mean: -0.14629815518856049, mean p set: 0.4505384862422943
loss_pred:0.022518860176205635, decouple_loss:0.0007362025207839906
Iteration: 2039, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4484226703643799, gen p mean: -0.16559503972530365, mean p set: 0.44900277256965637
loss_pred:0.02430814504623413, decouple_loss:0.0010778586147353053
The modified gen p mean: 0.448467880487442, gen p mean: -0.1637861132621765, mean p set: 0.44904032349586487
The modified gen p mean: 0.4500911831855774, gen p mean: -0.16908733546733856, mean p set: 0.450665146112442
loss_pred:0.023890117183327675, decouple_loss:0.0010175136849284172
loss_pred:0.022871779277920723, decouple_loss:0.0010504849487915635
Iteration: 2040, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44862303137779236, gen p mean: -0.14292144775390625, mean p set: 0.4492030143737793
loss_pred:0.02403893880546093, decouple_loss:0.0013008262030780315
The modified gen p mean: 0.4492515027523041, gen p mean: -0.13585186004638672, mean p set: 0.449828565120697
The modified gen p mean: 0.4495016634464264, gen p mean: -0.13630330562591553, mean p set: 0.4500739574432373
loss_pred:0.023638015612959862, decouple_loss:0.0012764731654897332
loss_pred:0.02340823970735073, decouple_loss:0.0010509965941309929
2023-05-01 23:31:57 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10683800280094147, mean p set: 0.4502691626548767
loss_pred:0.02459452487528324, decouple_loss:0.0017235047416761518
The modified gen p mean: 0.44953539967536926, gen p mean: -0.10043840855360031, mean p set: 0.4500633478164673
loss_pred:0.02416311576962471, decouple_loss:0.0016937889158725739
The modified gen p mean: 0.44978106021881104, gen p mean: -0.10108522325754166, mean p set: 0.45035696029663086
loss_pred:0.024471446871757507, decouple_loss:0.0015344644198194146
WV_1_PC_1_EH_0_PS_40, loss: 0.02449222467839718, avg_mse: 0.035082533955574036
current test mse: 0.035083
Iteration: 2041, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44958022236824036, gen p mean: -0.09899280965328217, mean p set: 0.45015794038772583
loss_pred:0.02387116849422455, decouple_loss:0.0012646039249375463
The modified gen p mean: 0.4489262104034424, gen p mean: -0.10442448407411575, mean p set: 0.4495016634464264The modified gen p mean: 0.4503995180130005, gen p mean: -0.10267960280179977, mean p set: 0.45097532868385315
loss_pred:0.024548741057515144, decouple_loss:0.0013872543349862099
loss_pred:0.023178337141871452, decouple_loss:0.001416308106854558
Iteration: 2042, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507741332054138, gen p mean: -0.13331297039985657, mean p set: 0.45134952664375305
loss_pred:0.023630207404494286, decouple_loss:0.00157262256834656
The modified gen p mean: 0.4494606852531433, gen p mean: -0.13752183318138123, mean p set: 0.45003804564476013The modified gen p mean: 0.45188429951667786, gen p mean: -0.1348268836736679, mean p set: 0.45245808362960815
loss_pred:0.022938545793294907, decouple_loss:0.0013978430069983006
loss_pred:0.02230655960738659, decouple_loss:0.0017144266748800874
Iteration: 2043, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449226438999176, gen p mean: -0.13999338448047638, mean p set: 0.44980570673942566
loss_pred:0.02355940081179142, decouple_loss:0.0013257813407108188
The modified gen p mean: 0.45032188296318054, gen p mean: -0.13451309502124786, mean p set: 0.45089974999427795
loss_pred:0.022836966440081596, decouple_loss:0.001452016644179821
The modified gen p mean: 0.44962644577026367, gen p mean: -0.13778425753116608, mean p set: 0.45020779967308044
loss_pred:0.023525910452008247, decouple_loss:0.0017717122100293636
Iteration: 2044, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44926223158836365, gen p mean: -0.1120893731713295, mean p set: 0.4498375654220581
loss_pred:0.022702563554048538, decouple_loss:0.00120042753405869
The modified gen p mean: 0.450155645608902, gen p mean: -0.10982444137334824, mean p set: 0.4507328271865845
loss_pred:0.022580962628126144, decouple_loss:0.0012505501508712769
The modified gen p mean: 0.4501875042915344, gen p mean: -0.10639329254627228, mean p set: 0.4507652819156647
loss_pred:0.023153454065322876, decouple_loss:0.0013961653457954526
Iteration: 2045, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510020315647125, gen p mean: -0.09179133176803589, mean p set: 0.4515804052352905
loss_pred:0.02122330479323864, decouple_loss:0.001379287918098271
The modified gen p mean: 0.4489441514015198, gen p mean: -0.09552005678415298, mean p set: 0.4495201110839844
loss_pred:0.021478651091456413, decouple_loss:0.001314240274950862
The modified gen p mean: 0.4503449499607086, gen p mean: -0.09308484941720963, mean p set: 0.4509235620498657
loss_pred:0.02188466303050518, decouple_loss:0.0013581527164205909
Iteration: 2046, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44928956031799316, gen p mean: -0.10631509125232697, mean p set: 0.4498651623725891
loss_pred:0.02155655436217785, decouple_loss:0.0012940468732267618
The modified gen p mean: 0.44978997111320496, gen p mean: -0.10740174353122711, mean p set: 0.4503653943538666
loss_pred:0.020618030801415443, decouple_loss:0.0014704674249514937
The modified gen p mean: 0.4508659243583679, gen p mean: -0.11047176271677017, mean p set: 0.45144200325012207
loss_pred:0.020850470289587975, decouple_loss:0.001513980794698
Iteration: 2047, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972774386405945, gen p mean: -0.11700978130102158, mean p set: 0.45030441880226135
loss_pred:0.021059265360236168, decouple_loss:0.001509683788754046
The modified gen p mean: 0.44997915625572205, gen p mean: -0.11525455862283707, mean p set: 0.4505557417869568
loss_pred:0.021017687395215034, decouple_loss:0.0015171748818829656
The modified gen p mean: 0.4524996876716614, gen p mean: -0.12020832300186157, mean p set: 0.4530760943889618
loss_pred:0.020083334296941757, decouple_loss:0.0014909895835444331
Iteration: 2048, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4492999017238617, gen p mean: -0.1001875102519989, mean p set: 0.4498754143714905
loss_pred:0.02093810960650444, decouple_loss:0.001432899385690689
The modified gen p mean: 0.45265886187553406, gen p mean: -0.1019190102815628, mean p set: 0.45323646068573
loss_pred:0.019518708810210228, decouple_loss:0.0011812306474894285
The modified gen p mean: 0.45273569226264954, gen p mean: -0.10439424216747284, mean p set: 0.45331335067749023
loss_pred:0.01933978497982025, decouple_loss:0.0011307857930660248
Iteration: 2049, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4517907500267029, gen p mean: -0.11041389405727386, mean p set: 0.45236724615097046
loss_pred:0.020582757890224457, decouple_loss:0.0013904765946790576
The modified gen p mean: 0.44947418570518494, gen p mean: -0.1066320538520813, mean p set: 0.4500502049922943
loss_pred:0.02056725323200226, decouple_loss:0.001196533441543579
The modified gen p mean: 0.44987228512763977, gen p mean: -0.11044441908597946, mean p set: 0.4504478871822357
loss_pred:0.02136479876935482, decouple_loss:0.0011810923460870981
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012018_3_24hr.npz
NaN value num: 0
Iteration: 2050, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503702223300934, gen p mean: -0.11860663443803787, mean p set: 0.4509464502334595
loss_pred:0.02005831152200699, decouple_loss:0.001490120543166995
The modified gen p mean: 0.4504747986793518, gen p mean: -0.12959301471710205, mean p set: 0.45105183124542236
The modified gen p mean: 0.45181161165237427, gen p mean: -0.1121017336845398, mean p set: 0.4523874819278717
loss_pred:0.020930146798491478, decouple_loss:0.0011712235864251852
loss_pred:0.019706808030605316, decouple_loss:0.0012489043874666095
2023-05-01 23:34:40 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1445559412240982, mean p set: 0.4502691626548767
loss_pred:0.020973635837435722, decouple_loss:0.0013264957815408707
The modified gen p mean: 0.44953545928001404, gen p mean: -0.13710975646972656, mean p set: 0.4500633478164673
loss_pred:0.020535167306661606, decouple_loss:0.0014235808048397303
The modified gen p mean: 0.44978100061416626, gen p mean: -0.13580383360385895, mean p set: 0.45035696029663086
loss_pred:0.02068164385855198, decouple_loss:0.0013073980808258057
WV_1_PC_1_EH_0_PS_40, loss: 0.02079777419567108, avg_mse: 0.030704393982887268
current test mse: 0.030704
Iteration: 2051, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4513801336288452, gen p mean: -0.12313723564147949, mean p set: 0.45195385813713074
loss_pred:0.018977349624037743, decouple_loss:0.0012695518089458346
The modified gen p mean: 0.4520626664161682, gen p mean: -0.12653420865535736, mean p set: 0.452638179063797
The modified gen p mean: 0.4508327841758728, gen p mean: -0.13339844346046448, mean p set: 0.45140859484672546
loss_pred:0.020503059029579163, decouple_loss:0.001267097657546401
loss_pred:0.02059066854417324, decouple_loss:0.0013238758547231555
Iteration: 2052, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508713483810425, gen p mean: -0.10865355283021927, mean p set: 0.45144933462142944
loss_pred:0.01876762881875038, decouple_loss:0.0013535519829019904
The modified gen p mean: 0.4517778158187866, gen p mean: -0.11142858117818832, mean p set: 0.4523571729660034The modified gen p mean: 0.45223668217658997, gen p mean: -0.11786918342113495, mean p set: 0.45281288027763367
loss_pred:0.0192634966224432, decouple_loss:0.001252259942702949loss_pred:0.021351942792534828, decouple_loss:0.0011730460682883859
Iteration: 2053, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502083361148834, gen p mean: -0.10630384832620621, mean p set: 0.45078444480895996
loss_pred:0.019975850358605385, decouple_loss:0.001398423220962286
The modified gen p mean: 0.45075443387031555, gen p mean: -0.10098893195390701, mean p set: 0.45133084058761597
loss_pred:0.01925620622932911, decouple_loss:0.0016529691638424993
The modified gen p mean: 0.45199140906333923, gen p mean: -0.10352890938520432, mean p set: 0.4525681734085083
loss_pred:0.0194427277892828, decouple_loss:0.0013380424352362752
Iteration: 2054, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45099085569381714, gen p mean: -0.07913366705179214, mean p set: 0.451566606760025
loss_pred:0.01960606314241886, decouple_loss:0.0013464492512866855
The modified gen p mean: 0.44891998171806335, gen p mean: -0.08460042625665665, mean p set: 0.4494965374469757
The modified gen p mean: 0.4510685205459595, gen p mean: -0.08000603318214417, mean p set: 0.4516444504261017
loss_pred:0.018986912444233894, decouple_loss:0.0012362091802060604
loss_pred:0.019672762602567673, decouple_loss:0.0012176234740763903
Iteration: 2055, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44997161626815796, gen p mean: -0.07996539771556854, mean p set: 0.4505482017993927
loss_pred:0.019020427018404007, decouple_loss:0.001002592733129859
The modified gen p mean: 0.45017585158348083, gen p mean: -0.08556430786848068, mean p set: 0.450752317905426
loss_pred:0.018461337313055992, decouple_loss:0.0011742684291675687
The modified gen p mean: 0.4520948529243469, gen p mean: -0.08233596384525299, mean p set: 0.45267269015312195
loss_pred:0.018308868631720543, decouple_loss:0.0012245923280715942
Iteration: 2056, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45028549432754517, gen p mean: -0.0888959988951683, mean p set: 0.45086002349853516
loss_pred:0.019333377480506897, decouple_loss:0.0012275081826373935
The modified gen p mean: 0.45243415236473083, gen p mean: -0.08588156849145889, mean p set: 0.45301249623298645
loss_pred:0.018293865025043488, decouple_loss:0.0011016452917829156
The modified gen p mean: 0.450083464384079, gen p mean: -0.08726285398006439, mean p set: 0.45065951347351074
loss_pred:0.01868797466158867, decouple_loss:0.0014008410507813096
Iteration: 2057, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500620663166046, gen p mean: -0.08813014626502991, mean p set: 0.4506409764289856
loss_pred:0.01776922307908535, decouple_loss:0.0011788004776462913
The modified gen p mean: 0.4537968933582306, gen p mean: -0.08636704832315445, mean p set: 0.45437467098236084
The modified gen p mean: 0.44949543476104736, gen p mean: -0.08598457276821136, mean p set: 0.4500705301761627
loss_pred:0.01775045320391655, decouple_loss:0.001193386735394597
loss_pred:0.01911868527531624, decouple_loss:0.0011039285454899073
Iteration: 2058, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505629241466522, gen p mean: -0.09373025596141815, mean p set: 0.4511401653289795
loss_pred:0.018609873950481415, decouple_loss:0.001220741425640881
The modified gen p mean: 0.4534183144569397, gen p mean: -0.08892792463302612, mean p set: 0.453996479511261
The modified gen p mean: 0.44988009333610535, gen p mean: -0.0903136357665062, mean p set: 0.450456827878952
loss_pred:0.017812512814998627, decouple_loss:0.001159823965281248
loss_pred:0.01898103766143322, decouple_loss:0.0010946483816951513
Iteration: 2059, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44986674189567566, gen p mean: -0.09424709528684616, mean p set: 0.45044317841529846
loss_pred:0.01831784099340439, decouple_loss:0.0009235501638613641
The modified gen p mean: 0.45058611035346985, gen p mean: -0.09737006574869156, mean p set: 0.45116284489631653
loss_pred:0.017872627824544907, decouple_loss:0.0010331695666536689
The modified gen p mean: 0.4524085819721222, gen p mean: -0.08821515738964081, mean p set: 0.4529861509799957
loss_pred:0.017814699560403824, decouple_loss:0.00100634153932333
Iteration: 2060, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4521077573299408, gen p mean: -0.09389244019985199, mean p set: 0.4526849389076233
loss_pred:0.01793603040277958, decouple_loss:0.0011999793350696564
The modified gen p mean: 0.45212307572364807, gen p mean: -0.09923806041479111, mean p set: 0.4527009129524231
loss_pred:0.017009077593684196, decouple_loss:0.0009012618102133274
The modified gen p mean: 0.4504890739917755, gen p mean: -0.10239804536104202, mean p set: 0.4510670304298401
loss_pred:0.017607664689421654, decouple_loss:0.0011549298651516438
2023-05-01 23:36:46 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10839976370334625, mean p set: 0.4502691626548767
loss_pred:0.019351541996002197, decouple_loss:0.0009969872189685702
The modified gen p mean: 0.4495348632335663, gen p mean: -0.10118184983730316, mean p set: 0.4500633478164673
loss_pred:0.018665609881281853, decouple_loss:0.0010071247816085815
The modified gen p mean: 0.4497804045677185, gen p mean: -0.10018408298492432, mean p set: 0.45035696029663086
loss_pred:0.018950676545500755, decouple_loss:0.0010363290784880519
WV_1_PC_1_EH_0_PS_40, loss: 0.019039951264858246, avg_mse: 0.028549693524837494
current test mse: 0.02855
Iteration: 2061, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4500161409378052, gen p mean: -0.09627707302570343, mean p set: 0.4505917727947235
loss_pred:0.017393000423908234, decouple_loss:0.000996073824353516
The modified gen p mean: 0.45144492387771606, gen p mean: -0.08939439058303833, mean p set: 0.4520217776298523The modified gen p mean: 0.45021265745162964, gen p mean: -0.0999833419919014, mean p set: 0.45079126954078674
loss_pred:0.017350023612380028, decouple_loss:0.0008679424645379186
loss_pred:0.017430046573281288, decouple_loss:0.0009516843711026013
Iteration: 2062, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4536285698413849, gen p mean: -0.08581728488206863, mean p set: 0.45420756936073303
loss_pred:0.017208583652973175, decouple_loss:0.0011669714003801346
The modified gen p mean: 0.4498770833015442, gen p mean: -0.09392258524894714, mean p set: 0.4504525363445282The modified gen p mean: 0.4522792100906372, gen p mean: -0.09252633154392242, mean p set: 0.4528560936450958
loss_pred:0.017578789964318275, decouple_loss:0.001029765116982162
loss_pred:0.017746223136782646, decouple_loss:0.0012381330598145723
Iteration: 2063, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450496643781662, gen p mean: -0.09147129207849503, mean p set: 0.4510722756385803
The modified gen p mean: 0.45065411925315857, gen p mean: -0.08955942094326019, mean p set: 0.45123252272605896
loss_pred:0.018157189711928368, decouple_loss:0.0009210773860104382
loss_pred:0.017583470791578293, decouple_loss:0.0008015479543246329
The modified gen p mean: 0.4511414170265198, gen p mean: -0.08651209622621536, mean p set: 0.45171812176704407
loss_pred:0.01765487715601921, decouple_loss:0.0007950222352519631
Iteration: 2064, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499790072441101, gen p mean: -0.09012312442064285, mean p set: 0.45055627822875977
The modified gen p mean: 0.4521627128124237, gen p mean: -0.08878611028194427, mean p set: 0.4527396559715271
loss_pred:0.017055727541446686, decouple_loss:0.0009233086020685732
loss_pred:0.017283441498875618, decouple_loss:0.0009638566989451647
The modified gen p mean: 0.4499984681606293, gen p mean: -0.08857028931379318, mean p set: 0.4505741000175476
loss_pred:0.017494549974799156, decouple_loss:0.0009405947057530284
Iteration: 2065, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987285137176514, gen p mean: -0.0857650637626648, mean p set: 0.4504498541355133
loss_pred:0.017296260222792625, decouple_loss:0.0008337005856446922
The modified gen p mean: 0.4501931071281433, gen p mean: -0.0877428725361824, mean p set: 0.4507681429386139
loss_pred:0.01666860096156597, decouple_loss:0.0008915499201975763
The modified gen p mean: 0.4504963755607605, gen p mean: -0.08752469718456268, mean p set: 0.45107343792915344
loss_pred:0.01677234284579754, decouple_loss:0.0009334886563010514
Iteration: 2066, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520730972290039, gen p mean: -0.08060267567634583, mean p set: 0.4526509940624237
loss_pred:0.01828666403889656, decouple_loss:0.0010294269304722548
The modified gen p mean: 0.45071423053741455, gen p mean: -0.07706165313720703, mean p set: 0.4512914717197418
loss_pred:0.017165256664156914, decouple_loss:0.0009169768309220672
The modified gen p mean: 0.4509153366088867, gen p mean: -0.07881084829568863, mean p set: 0.45149174332618713
loss_pred:0.016718633472919464, decouple_loss:0.0009434506646357477
Iteration: 2067, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45083877444267273, gen p mean: -0.08316877484321594, mean p set: 0.45141491293907166
The modified gen p mean: 0.45075687766075134, gen p mean: -0.0817350447177887, mean p set: 0.45133426785469055
loss_pred:0.01731453463435173, decouple_loss:0.0011332357535138726
loss_pred:0.017093023285269737, decouple_loss:0.0009911488741636276
The modified gen p mean: 0.4496428668498993, gen p mean: -0.08332511782646179, mean p set: 0.4502184987068176
loss_pred:0.017249252647161484, decouple_loss:0.0009681847877800465
Iteration: 2068, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508013427257538, gen p mean: -0.0856839120388031, mean p set: 0.4513775408267975
loss_pred:0.016789361834526062, decouple_loss:0.0012619729386642575
The modified gen p mean: 0.45030778646469116, gen p mean: -0.08687761425971985, mean p set: 0.4508858919143677
The modified gen p mean: 0.4525824189186096, gen p mean: -0.07845005393028259, mean p set: 0.4531611502170563
loss_pred:0.016976971179246902, decouple_loss:0.0010654047364369035
loss_pred:0.01741776056587696, decouple_loss:0.0010244238656014204
Iteration: 2069, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44987574219703674, gen p mean: -0.08786839246749878, mean p set: 0.45045205950737
loss_pred:0.01678691804409027, decouple_loss:0.000759848568122834
The modified gen p mean: 0.4505636692047119, gen p mean: -0.08920243382453918, mean p set: 0.45114099979400635
The modified gen p mean: 0.4501214921474457, gen p mean: -0.087448850274086, mean p set: 0.4506986141204834
loss_pred:0.01658860221505165, decouple_loss:0.0009871992515400052
loss_pred:0.017085742205381393, decouple_loss:0.0009682021336629987
/scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_03012010_3_24hr.npz
NaN value num: 0
Iteration: 2070, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508661925792694, gen p mean: -0.08758290112018585, mean p set: 0.45144134759902954
loss_pred:0.018301088362932205, decouple_loss:0.0009086226928047836
The modified gen p mean: 0.4487041234970093, gen p mean: -0.09175711125135422, mean p set: 0.44927823543548584
The modified gen p mean: 0.4511699080467224, gen p mean: -0.08817967027425766, mean p set: 0.45174556970596313
loss_pred:0.017900828272104263, decouple_loss:0.0008482433622702956
loss_pred:0.017988570034503937, decouple_loss:0.0012829775223508477
2023-05-01 23:39:29 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10111009329557419, mean p set: 0.4502691626548767
loss_pred:0.01846020482480526, decouple_loss:0.00105630187317729
The modified gen p mean: 0.4495338797569275, gen p mean: -0.09413184225559235, mean p set: 0.4500633478164673
loss_pred:0.017686259001493454, decouple_loss:0.001560934935696423
The modified gen p mean: 0.44978007674217224, gen p mean: -0.09326066821813583, mean p set: 0.45035696029663086
loss_pred:0.017964327707886696, decouple_loss:0.0013615897623822093
WV_1_PC_1_EH_0_PS_40, loss: 0.01810324564576149, avg_mse: 0.02744647115468979
current test mse: 0.027446
Iteration: 2071, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45024973154067993, gen p mean: -0.09342699497938156, mean p set: 0.4508259892463684
loss_pred:0.017239023000001907, decouple_loss:0.0014272648841142654
The modified gen p mean: 0.45072221755981445, gen p mean: -0.08417035639286041, mean p set: 0.4512987732887268The modified gen p mean: 0.4502575099468231, gen p mean: -0.09024123847484589, mean p set: 0.45083388686180115
loss_pred:0.01801661029458046, decouple_loss:0.0011806638212874532
loss_pred:0.017702843993902206, decouple_loss:0.001151747303083539
Iteration: 2072, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4490096867084503, gen p mean: -0.09427745640277863, mean p set: 0.4495851993560791
loss_pred:0.017360825091600418, decouple_loss:0.0008950037299655378
The modified gen p mean: 0.45095276832580566, gen p mean: -0.09716174751520157, mean p set: 0.45152872800827026The modified gen p mean: 0.450818806886673, gen p mean: -0.0943334549665451, mean p set: 0.45139533281326294
loss_pred:0.018193356692790985, decouple_loss:0.0008371404837816954
loss_pred:0.017354732379317284, decouple_loss:0.0008421022212132812
Iteration: 2073, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44970783591270447, gen p mean: -0.10029811412096024, mean p set: 0.450283020734787
loss_pred:0.017183294519782066, decouple_loss:0.0009321378311142325
The modified gen p mean: 0.4507285952568054, gen p mean: -0.09577366709709167, mean p set: 0.4513053894042969
loss_pred:0.01674514077603817, decouple_loss:0.0008952136267907917
The modified gen p mean: 0.45082029700279236, gen p mean: -0.09446630626916885, mean p set: 0.45139408111572266
loss_pred:0.01862872578203678, decouple_loss:0.000972724927123636
Iteration: 2074, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499962329864502, gen p mean: -0.09991803765296936, mean p set: 0.4505697786808014
loss_pred:0.019171353429555893, decouple_loss:0.0009506698115728796
The modified gen p mean: 0.4507758915424347, gen p mean: -0.09369833767414093, mean p set: 0.45135459303855896
loss_pred:0.01663965731859207, decouple_loss:0.0007667469908483326
The modified gen p mean: 0.4507482349872589, gen p mean: -0.08985180407762527, mean p set: 0.4513244926929474
loss_pred:0.018402889370918274, decouple_loss:0.0013669865438714623
Iteration: 2075, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502810835838318, gen p mean: -0.09045816957950592, mean p set: 0.450858473777771
loss_pred:0.017700456082820892, decouple_loss:0.0009808836039155722
The modified gen p mean: 0.4497920870780945, gen p mean: -0.09477872401475906, mean p set: 0.4503689110279083
loss_pred:0.017434651032090187, decouple_loss:0.0007734867394901812
The modified gen p mean: 0.45242342352867126, gen p mean: -0.09429949522018433, mean p set: 0.45300063490867615
loss_pred:0.01682942546904087, decouple_loss:0.0009778832318261266
Iteration: 2076, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45061084628105164, gen p mean: -0.08831945806741714, mean p set: 0.4511867165565491
loss_pred:0.01862655021250248, decouple_loss:0.0008242237963713706
The modified gen p mean: 0.4514121413230896, gen p mean: -0.08513450622558594, mean p set: 0.45199018716812134
loss_pred:0.0175669863820076, decouple_loss:0.0012870525242760777
The modified gen p mean: 0.451613187789917, gen p mean: -0.08616649359464645, mean p set: 0.45218974351882935
loss_pred:0.017763400450348854, decouple_loss:0.0012547661317512393
Iteration: 2077, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504753351211548, gen p mean: -0.08739759027957916, mean p set: 0.4510516822338104
The modified gen p mean: 0.4505269229412079, gen p mean: -0.08570236712694168, mean p set: 0.4511035680770874
loss_pred:0.016702702268958092, decouple_loss:0.0008092275238595903
loss_pred:0.01765168458223343, decouple_loss:0.0008234533597715199
The modified gen p mean: 0.4513412415981293, gen p mean: -0.08646878600120544, mean p set: 0.4519176781177521
loss_pred:0.01714356243610382, decouple_loss:0.0012006305623799562
Iteration: 2078, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504932761192322, gen p mean: -0.08409412950277328, mean p set: 0.4510705769062042
loss_pred:0.016824796795845032, decouple_loss:0.0008847025455906987
The modified gen p mean: 0.45057806372642517, gen p mean: -0.09292028099298477, mean p set: 0.4511551260948181
loss_pred:0.018250126391649246, decouple_loss:0.0011678833980113268
The modified gen p mean: 0.4499991834163666, gen p mean: -0.08824313431978226, mean p set: 0.4505757987499237
loss_pred:0.016716616228222847, decouple_loss:0.0011101174168288708
Iteration: 2079, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039820671081543, gen p mean: -0.0863335132598877, mean p set: 0.4509739875793457
loss_pred:0.0167846716940403, decouple_loss:0.0012692614691331983
The modified gen p mean: 0.4500213861465454, gen p mean: -0.0860186293721199, mean p set: 0.4505978226661682
loss_pred:0.017396416515111923, decouple_loss:0.0011038122465834022
The modified gen p mean: 0.45105499029159546, gen p mean: -0.08512970805168152, mean p set: 0.4516315758228302
loss_pred:0.01777217909693718, decouple_loss:0.001165536930784583
Iteration: 2080, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45119133591651917, gen p mean: -0.08191843330860138, mean p set: 0.45176616311073303
loss_pred:0.017508845776319504, decouple_loss:0.0010970367584377527
The modified gen p mean: 0.4505765438079834, gen p mean: -0.08401385694742203, mean p set: 0.4511536657810211
loss_pred:0.016950614750385284, decouple_loss:0.0009519995073787868
The modified gen p mean: 0.4502559304237366, gen p mean: -0.08729590475559235, mean p set: 0.4508335292339325
loss_pred:0.016970884054899216, decouple_loss:0.0009429600322619081
2023-05-01 23:41:36 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.09463649988174438, mean p set: 0.4502691626548767
loss_pred:0.018023191019892693, decouple_loss:0.0007507457630708814
The modified gen p mean: 0.44953396916389465, gen p mean: -0.08780789375305176, mean p set: 0.4500633478164673
loss_pred:0.01725129224359989, decouple_loss:0.0009429709753021598
The modified gen p mean: 0.4497798681259155, gen p mean: -0.08698531240224838, mean p set: 0.45035696029663086
loss_pred:0.017544107511639595, decouple_loss:0.0008654113626107574
WV_1_PC_1_EH_0_PS_40, loss: 0.0176488496363163, avg_mse: 0.027051493525505066
current test mse: 0.027051
Iteration: 2081, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45150989294052124, gen p mean: -0.0843677967786789, mean p set: 0.45208606123924255
loss_pred:0.016884874552488327, decouple_loss:0.0007279912824742496
The modified gen p mean: 0.44869059324264526, gen p mean: -0.0838058590888977, mean p set: 0.4492678940296173The modified gen p mean: 0.4503515064716339, gen p mean: -0.08658420294523239, mean p set: 0.4509296715259552
loss_pred:0.016645386815071106, decouple_loss:0.0008672570111230016loss_pred:0.018579930067062378, decouple_loss:0.0010264082811772823
Iteration: 2082, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507855772972107, gen p mean: -0.08711951225996017, mean p set: 0.4513612687587738
loss_pred:0.01679888740181923, decouple_loss:0.0009119681781157851
The modified gen p mean: 0.45005327463150024, gen p mean: -0.08837626874446869, mean p set: 0.45063063502311707The modified gen p mean: 0.45207592844963074, gen p mean: -0.08875006437301636, mean p set: 0.45265302062034607
loss_pred:0.016993289813399315, decouple_loss:0.001008566003292799
loss_pred:0.016433235257864, decouple_loss:0.0009427216136828065
Iteration: 2083, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44990721344947815, gen p mean: -0.08649800717830658, mean p set: 0.45048442482948303
loss_pred:0.017010873183608055, decouple_loss:0.0010540960356593132
The modified gen p mean: 0.44999969005584717, gen p mean: -0.09282948076725006, mean p set: 0.4505743086338043
loss_pred:0.017761556431651115, decouple_loss:0.0007640026160515845
The modified gen p mean: 0.4508357644081116, gen p mean: -0.08661319315433502, mean p set: 0.45141053199768066
loss_pred:0.017074277624487877, decouple_loss:0.0011250133393332362
Iteration: 2084, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508199989795685, gen p mean: -0.089250847697258, mean p set: 0.45139649510383606
loss_pred:0.01718348078429699, decouple_loss:0.0010683586588129401
The modified gen p mean: 0.45021528005599976, gen p mean: -0.09268020838499069, mean p set: 0.4507925808429718
loss_pred:0.017240120097994804, decouple_loss:0.0007234486402012408
The modified gen p mean: 0.4502064883708954, gen p mean: -0.09266927093267441, mean p set: 0.45078244805336
loss_pred:0.017064634710550308, decouple_loss:0.0009547024383209646
Iteration: 2085, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507712125778198, gen p mean: -0.0885787084698677, mean p set: 0.4513457417488098
loss_pred:0.017337899655103683, decouple_loss:0.000893837888725102
The modified gen p mean: 0.450017511844635, gen p mean: -0.09462183713912964, mean p set: 0.4505924582481384
loss_pred:0.01702774502336979, decouple_loss:0.0007919849595054984
The modified gen p mean: 0.4512776732444763, gen p mean: -0.08809523284435272, mean p set: 0.4518546462059021
loss_pred:0.01720629446208477, decouple_loss:0.0007981554954312742
Iteration: 2086, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511038064956665, gen p mean: -0.09048965573310852, mean p set: 0.4516811966896057
loss_pred:0.01693062297999859, decouple_loss:0.0009014436509460211
The modified gen p mean: 0.45070746541023254, gen p mean: -0.09880799800157547, mean p set: 0.45128458738327026
loss_pred:0.01700422167778015, decouple_loss:0.0008886440191417933
The modified gen p mean: 0.4502089321613312, gen p mean: -0.09474758058786392, mean p set: 0.4507865309715271
loss_pred:0.016224274411797523, decouple_loss:0.0007949340506456792
Iteration: 2087, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4504601061344147, gen p mean: -0.09769129008054733, mean p set: 0.4510355293750763
loss_pred:0.01675730012357235, decouple_loss:0.0010918073821812868
The modified gen p mean: 0.4515019357204437, gen p mean: -0.10108550637960434, mean p set: 0.4520775377750397
loss_pred:0.016384486109018326, decouple_loss:0.0012048545759171247
The modified gen p mean: 0.45172742009162903, gen p mean: -0.09962671995162964, mean p set: 0.4523037374019623
loss_pred:0.016518181189894676, decouple_loss:0.0008200673037208617
Iteration: 2088, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4509289264678955, gen p mean: -0.10136041045188904, mean p set: 0.45150595903396606
loss_pred:0.01702319085597992, decouple_loss:0.0006127456435933709
The modified gen p mean: 0.4517216682434082, gen p mean: -0.09797730296850204, mean p set: 0.45229944586753845
loss_pred:0.01682463102042675, decouple_loss:0.0007353508844971657
The modified gen p mean: 0.44969087839126587, gen p mean: -0.10086183995008469, mean p set: 0.4502687156200409
loss_pred:0.016510609537363052, decouple_loss:0.0007688502664677799
Iteration: 2089, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520171880722046, gen p mean: -0.10014590620994568, mean p set: 0.45259371399879456
loss_pred:0.016769787296652794, decouple_loss:0.0008694755379110575
The modified gen p mean: 0.45103806257247925, gen p mean: -0.09973215311765671, mean p set: 0.45161738991737366
loss_pred:0.0163541492074728, decouple_loss:0.0008147857151925564
The modified gen p mean: 0.4512704610824585, gen p mean: -0.09881022572517395, mean p set: 0.4518486559391022
loss_pred:0.01639527827501297, decouple_loss:0.0007548414287157357
/scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_07012013_3_24hr.npz
NaN value num: 0
Iteration: 2090, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4461354911327362, gen p mean: -0.10307800769805908, mean p set: 0.446708619594574
The modified gen p mean: 0.4464111924171448, gen p mean: -0.10586299747228622, mean p set: 0.4469858705997467
loss_pred:0.016621550545096397, decouple_loss:0.0007752240053378046
loss_pred:0.01692853681743145, decouple_loss:0.0011396112386137247
The modified gen p mean: 0.4468766152858734, gen p mean: -0.1101178303360939, mean p set: 0.44745466113090515
loss_pred:0.016167448833584785, decouple_loss:0.000730309053324163
2023-05-01 23:44:21 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11141154915094376, mean p set: 0.4502691626548767
loss_pred:0.017613651230931282, decouple_loss:0.0006486543570645154
The modified gen p mean: 0.4495348334312439, gen p mean: -0.10396787524223328, mean p set: 0.4500633478164673
loss_pred:0.016956347972154617, decouple_loss:0.0006431315559893847
The modified gen p mean: 0.4497814476490021, gen p mean: -0.10330333560705185, mean p set: 0.45035696029663086
loss_pred:0.017322903499007225, decouple_loss:0.0006614645826630294
WV_1_PC_1_EH_0_PS_40, loss: 0.017330188304185867, avg_mse: 0.02665284276008606
current test mse: 0.026653
Iteration: 2091, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4475211203098297, gen p mean: -0.10078058391809464, mean p set: 0.4480966627597809
loss_pred:0.016591139137744904, decouple_loss:0.0007713963277637959
The modified gen p mean: 0.446170836687088, gen p mean: -0.10678813606500626, mean p set: 0.44674646854400635
The modified gen p mean: 0.4462127387523651, gen p mean: -0.10631732642650604, mean p set: 0.44678789377212524
loss_pred:0.015929771587252617, decouple_loss:0.0008896746439859271
loss_pred:0.015764186158776283, decouple_loss:0.0009531138930469751
Iteration: 2092, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4455668032169342, gen p mean: -0.10655432939529419, mean p set: 0.4461430609226227
loss_pred:0.017461106181144714, decouple_loss:0.0008057805825956166
The modified gen p mean: 0.446444571018219, gen p mean: -0.10253851115703583, mean p set: 0.4470199644565582The modified gen p mean: 0.44701382517814636, gen p mean: -0.1036907434463501, mean p set: 0.4475901126861572
loss_pred:0.016719289124011993, decouple_loss:0.000723889097571373loss_pred:0.01616811938583851, decouple_loss:0.0007091354345902801
begin: 1440, end: 1488
raw_dat shape: (1488, 3, 720, 1440)
Iteration: 2093, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474948048591614, gen p mean: -0.1056726723909378, mean p set: 0.4480704963207245
loss_pred:0.016565609723329544, decouple_loss:0.0008568982011638582
The modified gen p mean: 0.44598260521888733, gen p mean: -0.10089050978422165, mean p set: 0.4465586841106415
loss_pred:0.01661498285830021, decouple_loss:0.0008537555695511401
The modified gen p mean: 0.44662603735923767, gen p mean: -0.09954257309436798, mean p set: 0.4472024440765381
loss_pred:0.016416674479842186, decouple_loss:0.0008882298716343939
Iteration: 2094, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464913308620453, gen p mean: -0.10603196173906326, mean p set: 0.44706523418426514
loss_pred:0.016237083822488785, decouple_loss:0.0007542937528342009
The modified gen p mean: 0.4474393129348755, gen p mean: -0.1056649386882782, mean p set: 0.4480128884315491
loss_pred:0.017509037628769875, decouple_loss:0.0006461429293267429
The modified gen p mean: 0.445719450712204, gen p mean: -0.10338703542947769, mean p set: 0.4462953209877014
loss_pred:0.01560195628553629, decouple_loss:0.0006809329497627914
Iteration: 2095, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44616013765335083, gen p mean: -0.10575468838214874, mean p set: 0.4467359483242035
loss_pred:0.016464143991470337, decouple_loss:0.000826565723400563
The modified gen p mean: 0.44737523794174194, gen p mean: -0.10603027790784836, mean p set: 0.4479503035545349
loss_pred:0.015284419059753418, decouple_loss:0.0006205412209965289
The modified gen p mean: 0.447360634803772, gen p mean: -0.10241017490625381, mean p set: 0.4479365348815918
loss_pred:0.01650717668235302, decouple_loss:0.0008351837168447673
Iteration: 2096, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.446523517370224, gen p mean: -0.10546833276748657, mean p set: 0.44709739089012146
loss_pred:0.016859348863363266, decouple_loss:0.0006764219142496586
The modified gen p mean: 0.4456486403942108, gen p mean: -0.10818370431661606, mean p set: 0.44622352719306946
The modified gen p mean: 0.44642284512519836, gen p mean: -0.10543254762887955, mean p set: 0.4469989240169525
loss_pred:0.016468167304992676, decouple_loss:0.000815603940282017
loss_pred:0.01614074781537056, decouple_loss:0.0007374910055659711
Iteration: 2097, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466843605041504, gen p mean: -0.10723590850830078, mean p set: 0.44726207852363586
loss_pred:0.01598084531724453, decouple_loss:0.0007756781997159123
The modified gen p mean: 0.44741570949554443, gen p mean: -0.10292180627584457, mean p set: 0.4479900598526001
loss_pred:0.016543949022889137, decouple_loss:0.0006247870624065399
The modified gen p mean: 0.4462502896785736, gen p mean: -0.10537789762020111, mean p set: 0.4468272626399994
loss_pred:0.01656796969473362, decouple_loss:0.0008564955787733197
Iteration: 2098, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44602155685424805, gen p mean: -0.10614585876464844, mean p set: 0.44659891724586487
loss_pred:0.016219045966863632, decouple_loss:0.0007065874524414539
The modified gen p mean: 0.44712263345718384, gen p mean: -0.11062179505825043, mean p set: 0.4476989209651947
loss_pred:0.016348490491509438, decouple_loss:0.0005904457066208124
The modified gen p mean: 0.44668108224868774, gen p mean: -0.11311864852905273, mean p set: 0.44725584983825684
loss_pred:0.015737751498818398, decouple_loss:0.0006971451221033931
Iteration: 2099, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468615651130676, gen p mean: -0.11366698890924454, mean p set: 0.44743674993515015
loss_pred:0.015942910686135292, decouple_loss:0.0008675415883772075
The modified gen p mean: 0.447638601064682, gen p mean: -0.10240017622709274, mean p set: 0.44821488857269287
loss_pred:0.016013886779546738, decouple_loss:0.0006740788812749088
The modified gen p mean: 0.44726836681365967, gen p mean: -0.1123981848359108, mean p set: 0.4478432536125183
loss_pred:0.016274044290184975, decouple_loss:0.0006917002028785646
Iteration: 2100, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464332163333893, gen p mean: -0.10880916565656662, mean p set: 0.44700896739959717
loss_pred:0.015893686562776566, decouple_loss:0.0007001165067777038
The modified gen p mean: 0.44581031799316406, gen p mean: -0.10780983418226242, mean p set: 0.44638508558273315
loss_pred:0.01579825021326542, decouple_loss:0.000706099031958729
The modified gen p mean: 0.44638749957084656, gen p mean: -0.10799114406108856, mean p set: 0.44696730375289917
loss_pred:0.015686696395277977, decouple_loss:0.0006314704078249633
2023-05-01 23:46:27 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.10817629843950272, mean p set: 0.4502691626548767
loss_pred:0.017482250928878784, decouple_loss:0.0006737021030858159
The modified gen p mean: 0.44953399896621704, gen p mean: -0.1015937551856041, mean p set: 0.4500633478164673
loss_pred:0.016742978245019913, decouple_loss:0.0007122202659957111
The modified gen p mean: 0.44978106021881104, gen p mean: -0.10135388374328613, mean p set: 0.45035696029663086
loss_pred:0.017136763781309128, decouple_loss:0.0006999483448453248
WV_1_PC_1_EH_0_PS_40, loss: 0.01715542934834957, avg_mse: 0.02634716033935547
current test mse: 0.026347
Iteration: 2101, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464512765407562, gen p mean: -0.1014745756983757, mean p set: 0.44702792167663574
loss_pred:0.01585358753800392, decouple_loss:0.0006056744605302811
The modified gen p mean: 0.44715413451194763, gen p mean: -0.1012582927942276, mean p set: 0.44772863388061523The modified gen p mean: 0.44750985503196716, gen p mean: -0.10257713496685028, mean p set: 0.4480864405632019
loss_pred:0.015798388049006462, decouple_loss:0.0006970249232836068
loss_pred:0.015880824998021126, decouple_loss:0.0007785512716509402
Iteration: 2102, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468803107738495, gen p mean: -0.10159115493297577, mean p set: 0.44745591282844543
loss_pred:0.01585354469716549, decouple_loss:0.0006603682413697243
The modified gen p mean: 0.44659343361854553, gen p mean: -0.10365261882543564, mean p set: 0.44716861844062805
The modified gen p mean: 0.446993887424469, gen p mean: -0.10662899166345596, mean p set: 0.44756782054901123
loss_pred:0.015802590176463127, decouple_loss:0.0007828992092981935
loss_pred:0.015539105981588364, decouple_loss:0.0007690750644542277
Iteration: 2103, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471447169780731, gen p mean: -0.11038298904895782, mean p set: 0.4477214217185974
loss_pred:0.01584206521511078, decouple_loss:0.0007070099236443639
The modified gen p mean: 0.445495069026947, gen p mean: -0.10121791809797287, mean p set: 0.4460710883140564
loss_pred:0.01559231523424387, decouple_loss:0.0007588973385281861
The modified gen p mean: 0.44747617840766907, gen p mean: -0.10814245045185089, mean p set: 0.4480500817298889
loss_pred:0.015068162232637405, decouple_loss:0.0007300421711988747
Iteration: 2104, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464074671268463, gen p mean: -0.10395807772874832, mean p set: 0.44698208570480347
loss_pred:0.016883602365851402, decouple_loss:0.0006570171099156141
The modified gen p mean: 0.4468771815299988, gen p mean: -0.10000675916671753, mean p set: 0.44745174050331116
loss_pred:0.01616850681602955, decouple_loss:0.000928945722989738
The modified gen p mean: 0.44716131687164307, gen p mean: -0.10312777757644653, mean p set: 0.44773682951927185
loss_pred:0.015491963364183903, decouple_loss:0.0006844407762400806
Iteration: 2105, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44628965854644775, gen p mean: -0.10503501445055008, mean p set: 0.4468649923801422
loss_pred:0.01602381467819214, decouple_loss:0.0008154656970873475
The modified gen p mean: 0.4465700685977936, gen p mean: -0.11095497012138367, mean p set: 0.44714680314064026
loss_pred:0.01599637232720852, decouple_loss:0.0006955501739867032
The modified gen p mean: 0.4458935260772705, gen p mean: -0.1087104082107544, mean p set: 0.4464685022830963
loss_pred:0.016638880595564842, decouple_loss:0.00098920869641006
Iteration: 2106, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44775572419166565, gen p mean: -0.11021863669157028, mean p set: 0.4483300447463989
loss_pred:0.01610671728849411, decouple_loss:0.000860010099131614
The modified gen p mean: 0.44655439257621765, gen p mean: -0.1127014234662056, mean p set: 0.4471304714679718
The modified gen p mean: 0.4469467103481293, gen p mean: -0.10932518541812897, mean p set: 0.44752398133277893
loss_pred:0.016264544799923897, decouple_loss:0.0005213083932176232
loss_pred:0.015489271841943264, decouple_loss:0.0005082162679173052
Iteration: 2107, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447105348110199, gen p mean: -0.10963735729455948, mean p set: 0.44768035411834717
loss_pred:0.015632109716534615, decouple_loss:0.0006459918222390115
The modified gen p mean: 0.44691959023475647, gen p mean: -0.113055519759655, mean p set: 0.44749605655670166
loss_pred:0.016095880419015884, decouple_loss:0.000613987329415977
The modified gen p mean: 0.4461510479450226, gen p mean: -0.11498279124498367, mean p set: 0.44672611355781555
loss_pred:0.016344426199793816, decouple_loss:0.0007231875788420439
Iteration: 2108, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4466484487056732, gen p mean: -0.12118323147296906, mean p set: 0.44722431898117065
loss_pred:0.01581832952797413, decouple_loss:0.000935983145609498
The modified gen p mean: 0.44785717129707336, gen p mean: -0.1142057254910469, mean p set: 0.4484312832355499
loss_pred:0.015812374651432037, decouple_loss:0.0006276709609664977
The modified gen p mean: 0.44650715589523315, gen p mean: -0.11227913945913315, mean p set: 0.4470832645893097
loss_pred:0.015628766268491745, decouple_loss:0.0007695147069171071
Iteration: 2109, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44762125611305237, gen p mean: -0.11569365859031677, mean p set: 0.44819650053977966
loss_pred:0.015408048406243324, decouple_loss:0.0006177414325065911
The modified gen p mean: 0.4473080039024353, gen p mean: -0.11620990186929703, mean p set: 0.447883665561676
loss_pred:0.016669144853949547, decouple_loss:0.0005272359703667462
The modified gen p mean: 0.4469625949859619, gen p mean: -0.1147623360157013, mean p set: 0.4475388824939728
loss_pred:0.014684488996863365, decouple_loss:0.0006501672323793173
/scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_05012012_3_24hr.npz
NaN value num: 0
Iteration: 2110, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4447100758552551, gen p mean: -0.11041907966136932, mean p set: 0.4452835023403168
loss_pred:0.01730373688042164, decouple_loss:0.0005710247787646949
The modified gen p mean: 0.44729846715927124, gen p mean: -0.10785891115665436, mean p set: 0.4478755593299866
The modified gen p mean: 0.4465254247188568, gen p mean: -0.11292044073343277, mean p set: 0.44710254669189453
loss_pred:0.01649932749569416, decouple_loss:0.0007491573342122138
loss_pred:0.017592256888747215, decouple_loss:0.000649496738333255
2023-05-01 23:49:10 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11616932600736618, mean p set: 0.4502691626548767
loss_pred:0.0173739492893219, decouple_loss:0.000871962052769959
The modified gen p mean: 0.44953453540802, gen p mean: -0.10992874950170517, mean p set: 0.4500633478164673
loss_pred:0.01662532612681389, decouple_loss:0.000905663357116282
The modified gen p mean: 0.44977861642837524, gen p mean: -0.10967589914798737, mean p set: 0.45035696029663086
loss_pred:0.016968658193945885, decouple_loss:0.0008587456541135907
WV_1_PC_1_EH_0_PS_40, loss: 0.017033252865076065, avg_mse: 0.02628176100552082
current test mse: 0.026282
Iteration: 2111, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471496641635895, gen p mean: -0.10722994804382324, mean p set: 0.44772669672966003
loss_pred:0.01621820777654648, decouple_loss:0.0008138210396282375
The modified gen p mean: 0.44811391830444336, gen p mean: -0.10849688202142715, mean p set: 0.448689341545105The modified gen p mean: 0.44544753432273865, gen p mean: -0.11204201728105545, mean p set: 0.44602203369140625
loss_pred:0.016355199739336967, decouple_loss:0.000824781134724617
loss_pred:0.017076311632990837, decouple_loss:0.0006895546102896333
Iteration: 2112, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447483092546463, gen p mean: -0.11191412061452866, mean p set: 0.44805940985679626
loss_pred:0.016851264983415604, decouple_loss:0.0007936750771477818
The modified gen p mean: 0.44677120447158813, gen p mean: -0.11254160851240158, mean p set: 0.4473438560962677The modified gen p mean: 0.4474038779735565, gen p mean: -0.10877366364002228, mean p set: 0.4479779005050659
loss_pred:0.01698901876807213, decouple_loss:0.0005915038054808974
loss_pred:0.017739074304699898, decouple_loss:0.000904311949852854
Iteration: 2113, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44812995195388794, gen p mean: -0.10200754553079605, mean p set: 0.44870737195014954
loss_pred:0.016137655824422836, decouple_loss:0.0006473907269537449
The modified gen p mean: 0.4448692500591278, gen p mean: -0.10139039903879166, mean p set: 0.4454438388347626
loss_pred:0.017232611775398254, decouple_loss:0.0008174992981366813
The modified gen p mean: 0.4471037983894348, gen p mean: -0.11050435900688171, mean p set: 0.4476792514324188
loss_pred:0.017511991783976555, decouple_loss:0.0005600947770290077
Iteration: 2114, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44720131158828735, gen p mean: -0.10608426481485367, mean p set: 0.44777825474739075
loss_pred:0.017194366082549095, decouple_loss:0.0008993211667984724
The modified gen p mean: 0.4482830762863159, gen p mean: -0.10524482280015945, mean p set: 0.44885969161987305
loss_pred:0.016824988648295403, decouple_loss:0.0009014837560243905
The modified gen p mean: 0.44676855206489563, gen p mean: -0.10720806568861008, mean p set: 0.44734519720077515
loss_pred:0.017255885526537895, decouple_loss:0.0006359015824273229
Iteration: 2115, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4476127624511719, gen p mean: -0.10246480256319046, mean p set: 0.4481865465641022
loss_pred:0.015801481902599335, decouple_loss:0.0006743593257851899
The modified gen p mean: 0.4470471441745758, gen p mean: -0.1059136837720871, mean p set: 0.4476243257522583
loss_pred:0.017432840541005135, decouple_loss:0.0006120341713540256
The modified gen p mean: 0.4473326504230499, gen p mean: -0.10307920724153519, mean p set: 0.44790738821029663
loss_pred:0.016181068494915962, decouple_loss:0.0007479621563106775
Iteration: 2116, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4474295377731323, gen p mean: -0.10397839546203613, mean p set: 0.4480046033859253
loss_pred:0.01660403050482273, decouple_loss:0.0007966032135300338
The modified gen p mean: 0.44838735461235046, gen p mean: -0.10644809901714325, mean p set: 0.4489658772945404
The modified gen p mean: 0.4479003846645355, gen p mean: -0.10216298699378967, mean p set: 0.44847550988197327
loss_pred:0.017165884375572205, decouple_loss:0.0008801569347269833
loss_pred:0.01679915003478527, decouple_loss:0.0006799505790695548
Iteration: 2117, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44723135232925415, gen p mean: -0.10334096848964691, mean p set: 0.44780823588371277
loss_pred:0.015859544277191162, decouple_loss:0.0007631248445250094
The modified gen p mean: 0.44839170575141907, gen p mean: -0.10391869395971298, mean p set: 0.4489684998989105
loss_pred:0.016031021252274513, decouple_loss:0.0006236789049580693
The modified gen p mean: 0.4470239281654358, gen p mean: -0.10583772510290146, mean p set: 0.4476010203361511
loss_pred:0.016039108857512474, decouple_loss:0.0007404877105727792
Iteration: 2118, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44680851697921753, gen p mean: -0.11052938550710678, mean p set: 0.44738152623176575
loss_pred:0.017922520637512207, decouple_loss:0.0007808722439222038
The modified gen p mean: 0.4460850954055786, gen p mean: -0.11023998260498047, mean p set: 0.4466627538204193
The modified gen p mean: 0.4481494426727295, gen p mean: -0.11090849339962006, mean p set: 0.4487268626689911
loss_pred:0.017330607399344444, decouple_loss:0.0007957350462675095
loss_pred:0.017045576125383377, decouple_loss:0.0005898848176002502
Iteration: 2119, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4470185935497284, gen p mean: -0.11661429703235626, mean p set: 0.4475955367088318
loss_pred:0.015384274534881115, decouple_loss:0.000634071824606508
The modified gen p mean: 0.44664284586906433, gen p mean: -0.11390253156423569, mean p set: 0.4472196698188782
The modified gen p mean: 0.44593390822410583, gen p mean: -0.11518644541501999, mean p set: 0.44650891423225403
loss_pred:0.01662791334092617, decouple_loss:0.0007521366933360696
loss_pred:0.016907349228858948, decouple_loss:0.0008883319096639752
Iteration: 2120, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4471147954463959, gen p mean: -0.11550650000572205, mean p set: 0.4476911425590515
loss_pred:0.01598723791539669, decouple_loss:0.000547568139154464
The modified gen p mean: 0.4465557932853699, gen p mean: -0.1155732274055481, mean p set: 0.4471317529678345
loss_pred:0.01731952093541622, decouple_loss:0.0009859196143224835
The modified gen p mean: 0.44734400510787964, gen p mean: -0.1202976331114769, mean p set: 0.44791924953460693
loss_pred:0.016731934621930122, decouple_loss:0.0008020614623092115
2023-05-01 23:51:17 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.12139202654361725, mean p set: 0.4502691626548767
loss_pred:0.017359958961606026, decouple_loss:0.0006697264616377652
The modified gen p mean: 0.44953638315200806, gen p mean: -0.11495240032672882, mean p set: 0.4500633478164673
loss_pred:0.01658717729151249, decouple_loss:0.000718365830834955
The modified gen p mean: 0.4497794508934021, gen p mean: -0.11457131057977676, mean p set: 0.45035696029663086
loss_pred:0.01693694107234478, decouple_loss:0.000630789902061224
WV_1_PC_1_EH_0_PS_40, loss: 0.016995009034872055, avg_mse: 0.02634524181485176
current test mse: 0.026345
Iteration: 2121, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4477865397930145, gen p mean: -0.11643722653388977, mean p set: 0.4483644366264343
loss_pred:0.016016805544495583, decouple_loss:0.000832157616969198
The modified gen p mean: 0.4468705952167511, gen p mean: -0.11598183959722519, mean p set: 0.44744715094566345The modified gen p mean: 0.4478933811187744, gen p mean: -0.11524791270494461, mean p set: 0.44847017526626587
loss_pred:0.017373237758874893, decouple_loss:0.0006665660766884685loss_pred:0.016096128150820732, decouple_loss:0.0008690139511600137
Iteration: 2122, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4480170011520386, gen p mean: -0.11819027364253998, mean p set: 0.44859054684638977
loss_pred:0.017020225524902344, decouple_loss:0.0008268742822110653
The modified gen p mean: 0.4479616582393646, gen p mean: -0.11502014100551605, mean p set: 0.44853606820106506The modified gen p mean: 0.44688180088996887, gen p mean: -0.11433257907629013, mean p set: 0.4474547207355499
loss_pred:0.01673172600567341, decouple_loss:0.0007781080203130841
loss_pred:0.016602668911218643, decouple_loss:0.0006954747368581593
Iteration: 2123, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4467170536518097, gen p mean: -0.11407261341810226, mean p set: 0.4472928047180176
loss_pred:0.01712144911289215, decouple_loss:0.0005995900137349963
The modified gen p mean: 0.4470846652984619, gen p mean: -0.11225113272666931, mean p set: 0.44765937328338623
loss_pred:0.015880819410085678, decouple_loss:0.0005257361335679889
The modified gen p mean: 0.44734206795692444, gen p mean: -0.11391780525445938, mean p set: 0.44791650772094727
loss_pred:0.016946671530604362, decouple_loss:0.0007229078328236938
Iteration: 2124, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.447513222694397, gen p mean: -0.10994724929332733, mean p set: 0.4480881989002228
loss_pred:0.015513013117015362, decouple_loss:0.0007865757797844708
The modified gen p mean: 0.4475806951522827, gen p mean: -0.11001865565776825, mean p set: 0.4481572210788727
loss_pred:0.016872815787792206, decouple_loss:0.0009606845560483634
The modified gen p mean: 0.4467201232910156, gen p mean: -0.11370037496089935, mean p set: 0.4472973346710205
loss_pred:0.01656208746135235, decouple_loss:0.0008022308466024697
Iteration: 2125, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4464045763015747, gen p mean: -0.10840525478124619, mean p set: 0.4469830095767975
loss_pred:0.01695704646408558, decouple_loss:0.0005673677078448236
The modified gen p mean: 0.4482593834400177, gen p mean: -0.11523046344518661, mean p set: 0.44883349537849426
loss_pred:0.016394848003983498, decouple_loss:0.0006781069678254426
The modified gen p mean: 0.44678956270217896, gen p mean: -0.1105906292796135, mean p set: 0.4473651349544525
loss_pred:0.016066953539848328, decouple_loss:0.0006966567016206682
Iteration: 2126, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4443688988685608, gen p mean: -0.10681891441345215, mean p set: 0.4449447691440582
loss_pred:0.017332235351204872, decouple_loss:0.0007731288205832243
The modified gen p mean: 0.44662895798683167, gen p mean: -0.1103629320859909, mean p set: 0.4472050368785858
loss_pred:0.017255952581763268, decouple_loss:0.0007831691764295101
The modified gen p mean: 0.44791245460510254, gen p mean: -0.10856808722019196, mean p set: 0.44849109649658203
loss_pred:0.01601419970393181, decouple_loss:0.0005569928325712681
Iteration: 2127, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4483008086681366, gen p mean: -0.11560172587633133, mean p set: 0.4488775134086609
loss_pred:0.016977526247501373, decouple_loss:0.0005967878387309611
The modified gen p mean: 0.4476146101951599, gen p mean: -0.10942794382572174, mean p set: 0.4481930732727051
loss_pred:0.0170180331915617, decouple_loss:0.0005778729682788253
The modified gen p mean: 0.44735270738601685, gen p mean: -0.1114334911108017, mean p set: 0.4479292929172516
loss_pred:0.01660541445016861, decouple_loss:0.0005995194078423083
Iteration: 2128, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4468228816986084, gen p mean: -0.11647354066371918, mean p set: 0.4473983943462372
loss_pred:0.01600128412246704, decouple_loss:0.0005256556323729455
The modified gen p mean: 0.4444120228290558, gen p mean: -0.10980227589607239, mean p set: 0.4449867010116577
loss_pred:0.01713915728032589, decouple_loss:0.0006100977770984173
The modified gen p mean: 0.44795286655426025, gen p mean: -0.11254748702049255, mean p set: 0.44852742552757263
loss_pred:0.017505869269371033, decouple_loss:0.0007699860725551844
Iteration: 2129, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44802337884902954, gen p mean: -0.11247190088033676, mean p set: 0.44860225915908813
loss_pred:0.01687161810696125, decouple_loss:0.0008275919244624674
The modified gen p mean: 0.4472021758556366, gen p mean: -0.11699479073286057, mean p set: 0.4477783739566803
loss_pred:0.017248347401618958, decouple_loss:0.0006314741913229227
The modified gen p mean: 0.4471625089645386, gen p mean: -0.11535996198654175, mean p set: 0.447741836309433
loss_pred:0.01688622497022152, decouple_loss:0.000663040962535888
/scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_11012011_3_24hr.npz
NaN value num: 0
Iteration: 2130, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4496435225009918, gen p mean: -0.10931271314620972, mean p set: 0.4502204656600952The modified gen p mean: 0.45006778836250305, gen p mean: -0.09904996305704117, mean p set: 0.4506444036960602
loss_pred:0.015025070868432522, decouple_loss:0.0007726358599029481
loss_pred:0.016001759096980095, decouple_loss:0.0007050748681649566
The modified gen p mean: 0.45011991262435913, gen p mean: -0.103821761906147, mean p set: 0.4506988525390625
loss_pred:0.015530906617641449, decouple_loss:0.0007630179170519114
2023-05-01 23:54:03 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11221255362033844, mean p set: 0.4502691626548767
loss_pred:0.017305918037891388, decouple_loss:0.0006242766394279897
The modified gen p mean: 0.44953325390815735, gen p mean: -0.10547955334186554, mean p set: 0.4500633478164673
loss_pred:0.01652471162378788, decouple_loss:0.0005797010962851346
The modified gen p mean: 0.4497797191143036, gen p mean: -0.10512454807758331, mean p set: 0.45035696029663086
loss_pred:0.016841748729348183, decouple_loss:0.0005836407653987408
WV_1_PC_1_EH_0_PS_40, loss: 0.016920587047934532, avg_mse: 0.026239052414894104
current test mse: 0.026239
Iteration: 2131, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44900479912757874, gen p mean: -0.09912334382534027, mean p set: 0.4495818316936493
loss_pred:0.015886634588241577, decouple_loss:0.0008314837468788028
The modified gen p mean: 0.4506334960460663, gen p mean: -0.0993288904428482, mean p set: 0.4512108564376831The modified gen p mean: 0.44886690378189087, gen p mean: -0.10210081189870834, mean p set: 0.44944292306900024
loss_pred:0.015288661234080791, decouple_loss:0.0006776459631510079
loss_pred:0.015132096596062183, decouple_loss:0.0006879816646687686
Iteration: 2132, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449452668428421, gen p mean: -0.09504203498363495, mean p set: 0.4500291645526886
loss_pred:0.015230021439492702, decouple_loss:0.0006593132857233286
The modified gen p mean: 0.4502333402633667, gen p mean: -0.10181912779808044, mean p set: 0.45081138610839844The modified gen p mean: 0.4498063027858734, gen p mean: -0.0901966467499733, mean p set: 0.45038288831710815
loss_pred:0.015582408756017685, decouple_loss:0.0008650189847685397loss_pred:0.016043201088905334, decouple_loss:0.0006745184073224664
Iteration: 2133, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44828933477401733, gen p mean: -0.09060872346162796, mean p set: 0.4488658010959625
loss_pred:0.015213998965919018, decouple_loss:0.0008453396731056273
The modified gen p mean: 0.44994106888771057, gen p mean: -0.09249310195446014, mean p set: 0.45051753520965576
loss_pred:0.0155977513641119, decouple_loss:0.0005528294714167714
The modified gen p mean: 0.451497346162796, gen p mean: -0.09015589207410812, mean p set: 0.45207199454307556
loss_pred:0.015807777643203735, decouple_loss:0.0008009240846149623
Iteration: 2134, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44892510771751404, gen p mean: -0.09407568722963333, mean p set: 0.4494975507259369
loss_pred:0.015229043550789356, decouple_loss:0.0007963849348016083
The modified gen p mean: 0.4501110315322876, gen p mean: -0.09194716811180115, mean p set: 0.4506879150867462
loss_pred:0.015388457104563713, decouple_loss:0.0006515802233479917
The modified gen p mean: 0.4498293697834015, gen p mean: -0.08488418906927109, mean p set: 0.4504052996635437
loss_pred:0.0158169437199831, decouple_loss:0.0007619764073751867
Iteration: 2135, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45039233565330505, gen p mean: -0.0904945507645607, mean p set: 0.4509684145450592
loss_pred:0.01562844216823578, decouple_loss:0.000666336331050843
The modified gen p mean: 0.44901543855667114, gen p mean: -0.09981820732355118, mean p set: 0.449592649936676
loss_pred:0.01499608252197504, decouple_loss:0.0006476379930973053
The modified gen p mean: 0.4517354965209961, gen p mean: -0.09049652516841888, mean p set: 0.4523118734359741
loss_pred:0.015858257189393044, decouple_loss:0.000605863519012928
Iteration: 2136, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497808516025543, gen p mean: -0.09763876348733902, mean p set: 0.4503568708896637
loss_pred:0.014895784668624401, decouple_loss:0.0008502291748300195
The modified gen p mean: 0.4520523250102997, gen p mean: -0.09523819386959076, mean p set: 0.45262953639030457
loss_pred:0.015555405989289284, decouple_loss:0.0008051996701397002
The modified gen p mean: 0.44917038083076477, gen p mean: -0.09817596524953842, mean p set: 0.4497469365596771
loss_pred:0.01516480091959238, decouple_loss:0.0007922294898889959
Iteration: 2137, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45097044110298157, gen p mean: -0.09621256589889526, mean p set: 0.4515463411808014
loss_pred:0.015314634889364243, decouple_loss:0.0006771981716156006
The modified gen p mean: 0.4504042863845825, gen p mean: -0.09551171958446503, mean p set: 0.45098140835762024
loss_pred:0.015624810941517353, decouple_loss:0.0006274577463045716
The modified gen p mean: 0.4501762092113495, gen p mean: -0.09760327637195587, mean p set: 0.45075175166130066
loss_pred:0.016455214470624924, decouple_loss:0.0007731590885668993
Iteration: 2138, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.449836790561676, gen p mean: -0.10020406544208527, mean p set: 0.4504128098487854
loss_pred:0.015264073386788368, decouple_loss:0.0007485509268008173
The modified gen p mean: 0.44999319314956665, gen p mean: -0.09846796840429306, mean p set: 0.4505689740180969
loss_pred:0.015351002104580402, decouple_loss:0.0005219448357820511
The modified gen p mean: 0.44828400015830994, gen p mean: -0.09804599732160568, mean p set: 0.44886115193367004
loss_pred:0.014826081693172455, decouple_loss:0.0007765004993416369
Iteration: 2139, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501745402812958, gen p mean: -0.09510515630245209, mean p set: 0.45075103640556335
loss_pred:0.01566559448838234, decouple_loss:0.0007323170430026948
The modified gen p mean: 0.45125633478164673, gen p mean: -0.1018805131316185, mean p set: 0.45183131098747253
The modified gen p mean: 0.44909462332725525, gen p mean: -0.09553630650043488, mean p set: 0.4496713876724243
loss_pred:0.014608100987970829, decouple_loss:0.0008928524330258369
loss_pred:0.01523890346288681, decouple_loss:0.0006032201345078647
Iteration: 2140, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4505862295627594, gen p mean: -0.10224735736846924, mean p set: 0.45116233825683594
The modified gen p mean: 0.45183438062667847, gen p mean: -0.10206077247858047, mean p set: 0.45241379737854004
loss_pred:0.015474277548491955, decouple_loss:0.000707404688000679
loss_pred:0.015578200109302998, decouple_loss:0.0007438950124196708
The modified gen p mean: 0.44920966029167175, gen p mean: -0.10342169553041458, mean p set: 0.4497842490673065
loss_pred:0.014921773225069046, decouple_loss:0.0006132633425295353
2023-05-01 23:56:10 testing...
The modified gen p mean: 0.44953468441963196, gen p mean: -0.10291916877031326, mean p set: 0.4500633478164673
loss_pred:0.016743479296565056, decouple_loss:0.0007904878002591431
The modified gen p mean: 0.4497821033000946, gen p mean: -0.10214273631572723, mean p set: 0.45035696029663086
loss_pred:0.017101535573601723, decouple_loss:0.0007872484275139868
The modified gen p mean: 0.4497888386249542, gen p mean: -0.108926922082901, mean p set: 0.4502691626548767
loss_pred:0.01743401028215885, decouple_loss:0.0009054945548996329
WV_1_PC_1_EH_0_PS_40, loss: 0.017134396359324455, avg_mse: 0.02655802294611931
current test mse: 0.026558
Iteration: 2141, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497167468070984, gen p mean: -0.09695261716842651, mean p set: 0.45029497146606445
loss_pred:0.015579227358102798, decouple_loss:0.0006833353545516729
The modified gen p mean: 0.44885513186454773, gen p mean: -0.0955667793750763, mean p set: 0.44943130016326904
loss_pred:0.015447610057890415, decouple_loss:0.0009076757705770433
The modified gen p mean: 0.4497038424015045, gen p mean: -0.10182549804449081, mean p set: 0.45027947425842285
loss_pred:0.015428243204951286, decouple_loss:0.0007656383677385747
Iteration: 2142, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4502333700656891, gen p mean: -0.08922754228115082, mean p set: 0.45081067085266113
loss_pred:0.015655098482966423, decouple_loss:0.0011446115095168352
The modified gen p mean: 0.4489938020706177, gen p mean: -0.09664631634950638, mean p set: 0.44956985116004944The modified gen p mean: 0.4491443932056427, gen p mean: -0.09069684892892838, mean p set: 0.4497208595275879
loss_pred:0.015488093718886375, decouple_loss:0.0007887138635851443
loss_pred:0.015808772295713425, decouple_loss:0.0007974528707563877
Iteration: 2143, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45011231303215027, gen p mean: -0.0973624438047409, mean p set: 0.45068684220314026
loss_pred:0.01582856848835945, decouple_loss:0.000610905874054879
The modified gen p mean: 0.4505773186683655, gen p mean: -0.09913717955350876, mean p set: 0.45115405321121216
loss_pred:0.01570441946387291, decouple_loss:0.0006645511602982879
The modified gen p mean: 0.4508560001850128, gen p mean: -0.09134745597839355, mean p set: 0.4514326751232147
loss_pred:0.0151963010430336, decouple_loss:0.0006651841686107218
Iteration: 2144, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45052728056907654, gen p mean: -0.08221027255058289, mean p set: 0.45110228657722473The modified gen p mean: 0.4498739242553711, gen p mean: -0.08129199594259262, mean p set: 0.45045042037963867
loss_pred:0.01641187258064747, decouple_loss:0.0008956302772276103
loss_pred:0.015627333894371986, decouple_loss:0.000921462313272059
The modified gen p mean: 0.44931530952453613, gen p mean: -0.08524960279464722, mean p set: 0.4498935639858246
loss_pred:0.015578740276396275, decouple_loss:0.0009369404288008809
Iteration: 2145, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4499908983707428, gen p mean: -0.08690722286701202, mean p set: 0.4505685865879059
The modified gen p mean: 0.4494287073612213, gen p mean: -0.08514444530010223, mean p set: 0.4500047266483307
loss_pred:0.01657390408217907, decouple_loss:0.001058804104104638
loss_pred:0.015227326191961765, decouple_loss:0.0006566189113073051
The modified gen p mean: 0.4489281475543976, gen p mean: -0.08763553202152252, mean p set: 0.4495031237602234
loss_pred:0.014663840644061565, decouple_loss:0.0006988641107454896
Iteration: 2146, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4501035511493683, gen p mean: -0.09125443547964096, mean p set: 0.4506790041923523The modified gen p mean: 0.45093774795532227, gen p mean: -0.0991150364279747, mean p set: 0.45151498913764954
loss_pred:0.015501165762543678, decouple_loss:0.0010304455645382404
loss_pred:0.016509346663951874, decouple_loss:0.0008970362250693142
The modified gen p mean: 0.45027607679367065, gen p mean: -0.09292027354240417, mean p set: 0.4508519768714905
loss_pred:0.0147184943780303, decouple_loss:0.0009283348335884511
Iteration: 2147, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45065873861312866, gen p mean: -0.09740565717220306, mean p set: 0.45123711228370667
The modified gen p mean: 0.4499175250530243, gen p mean: -0.09599333256483078, mean p set: 0.4504949152469635
loss_pred:0.016609035432338715, decouple_loss:0.0009281379752792418
loss_pred:0.01528772059828043, decouple_loss:0.0009834114462137222
The modified gen p mean: 0.4512178301811218, gen p mean: -0.09304739534854889, mean p set: 0.45179483294487
loss_pred:0.015236882492899895, decouple_loss:0.0008786845137365162
Iteration: 2148, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44972479343414307, gen p mean: -0.10797010362148285, mean p set: 0.45029953122138977
loss_pred:0.015269429422914982, decouple_loss:0.0006865563336759806
The modified gen p mean: 0.44957685470581055, gen p mean: -0.10269034653902054, mean p set: 0.4501529335975647
loss_pred:0.015176486223936081, decouple_loss:0.0007762271561659873
The modified gen p mean: 0.44979044795036316, gen p mean: -0.1011994406580925, mean p set: 0.45036759972572327
loss_pred:0.01554043497890234, decouple_loss:0.0009399647242389619
Iteration: 2149, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45041918754577637, gen p mean: -0.1053868755698204, mean p set: 0.450996994972229
loss_pred:0.015826741233468056, decouple_loss:0.0006641747895628214
The modified gen p mean: 0.45175883173942566, gen p mean: -0.10566317290067673, mean p set: 0.4523356258869171
The modified gen p mean: 0.4510256350040436, gen p mean: -0.10659799724817276, mean p set: 0.4516029953956604
loss_pred:0.015044036321341991, decouple_loss:0.0008372971788048744
loss_pred:0.015530741773545742, decouple_loss:0.000907822628505528
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012013_3_24hr.npz
NaN value num: 0
Iteration: 2150, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507644772529602, gen p mean: -0.09606852382421494, mean p set: 0.45134201645851135
The modified gen p mean: 0.4516522288322449, gen p mean: -0.09840857237577438, mean p set: 0.45223185420036316
loss_pred:0.01620151475071907, decouple_loss:0.0007792170508764684
loss_pred:0.015772100538015366, decouple_loss:0.0009677950292825699
The modified gen p mean: 0.4503566324710846, gen p mean: -0.0996989980340004, mean p set: 0.45093417167663574
loss_pred:0.01637432351708412, decouple_loss:0.0008226195932365954
2023-05-01 23:58:53 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1093265637755394, mean p set: 0.4502691626548767
loss_pred:0.017504878342151642, decouple_loss:0.0006787838647142053
The modified gen p mean: 0.4495357275009155, gen p mean: -0.10270938277244568, mean p set: 0.4500633478164673
loss_pred:0.01678738184273243, decouple_loss:0.0011015457566827536
The modified gen p mean: 0.4497821629047394, gen p mean: -0.10223633795976639, mean p set: 0.45035696029663086
loss_pred:0.017150061205029488, decouple_loss:0.0009842952713370323
WV_1_PC_1_EH_0_PS_40, loss: 0.017193518579006195, avg_mse: 0.026546068489551544
current test mse: 0.026546
Iteration: 2151, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45216527581214905, gen p mean: -0.10368338972330093, mean p set: 0.452742338180542
loss_pred:0.01576514169573784, decouple_loss:0.0007516140467487276
The modified gen p mean: 0.4509054124355316, gen p mean: -0.10047315806150436, mean p set: 0.4514811336994171
The modified gen p mean: 0.45055925846099854, gen p mean: -0.09368045628070831, mean p set: 0.4511346220970154
loss_pred:0.016698267310857773, decouple_loss:0.0008877856307663023
loss_pred:0.01573910377919674, decouple_loss:0.0008070877520367503
Iteration: 2152, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45152047276496887, gen p mean: -0.08808821439743042, mean p set: 0.4520973861217499
loss_pred:0.016484715044498444, decouple_loss:0.0007512705633416772
The modified gen p mean: 0.45091402530670166, gen p mean: -0.092205710709095, mean p set: 0.451490581035614The modified gen p mean: 0.45161569118499756, gen p mean: -0.08971266448497772, mean p set: 0.4521932005882263
loss_pred:0.016061043366789818, decouple_loss:0.0006383249419741333loss_pred:0.016366783529520035, decouple_loss:0.0009799712570384145
Iteration: 2153, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45084893703460693, gen p mean: -0.09136262536048889, mean p set: 0.4514252245426178
The modified gen p mean: 0.45082348585128784, gen p mean: -0.09835460782051086, mean p set: 0.45140039920806885
loss_pred:0.01620427332818508, decouple_loss:0.0009257019264623523
loss_pred:0.015777070075273514, decouple_loss:0.0009082821779884398
The modified gen p mean: 0.4516872763633728, gen p mean: -0.09610281139612198, mean p set: 0.452263206243515
loss_pred:0.016060132533311844, decouple_loss:0.0006456749979406595
Iteration: 2154, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507812261581421, gen p mean: -0.10396739095449448, mean p set: 0.451358824968338
loss_pred:0.01574121229350567, decouple_loss:0.0010553442407399416
The modified gen p mean: 0.44980892539024353, gen p mean: -0.10153717547655106, mean p set: 0.45038551092147827
loss_pred:0.016053523868322372, decouple_loss:0.0007742379093542695
The modified gen p mean: 0.451288640499115, gen p mean: -0.1012721061706543, mean p set: 0.4518631398677826
loss_pred:0.017151160165667534, decouple_loss:0.0012812773929908872
Iteration: 2155, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45230162143707275, gen p mean: -0.09836962819099426, mean p set: 0.4528786242008209
loss_pred:0.01604805700480938, decouple_loss:0.0008482159464620054
The modified gen p mean: 0.4493504762649536, gen p mean: -0.10170494019985199, mean p set: 0.44992655515670776
loss_pred:0.017035353928804398, decouple_loss:0.0006181715871207416
The modified gen p mean: 0.4508969783782959, gen p mean: -0.09678931534290314, mean p set: 0.4514739513397217
loss_pred:0.01646166294813156, decouple_loss:0.0010773465037345886
Iteration: 2156, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514985680580139, gen p mean: -0.09969151020050049, mean p set: 0.4520759880542755
loss_pred:0.015514268539845943, decouple_loss:0.000706473714672029
The modified gen p mean: 0.45097875595092773, gen p mean: -0.09274443984031677, mean p set: 0.45155417919158936
loss_pred:0.016510434448719025, decouple_loss:0.0009725161944516003
The modified gen p mean: 0.45117881894111633, gen p mean: -0.09710358083248138, mean p set: 0.45175471901893616
loss_pred:0.016245093196630478, decouple_loss:0.0009620295604690909
Iteration: 2157, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4497314989566803, gen p mean: -0.10113479197025299, mean p set: 0.4503083825111389
loss_pred:0.016405541449785233, decouple_loss:0.0008343631634488702
The modified gen p mean: 0.4502003788948059, gen p mean: -0.09997682273387909, mean p set: 0.45077693462371826
loss_pred:0.015166114084422588, decouple_loss:0.0007493874290958047
The modified gen p mean: 0.45111802220344543, gen p mean: -0.10097178816795349, mean p set: 0.4516936242580414
loss_pred:0.01651882939040661, decouple_loss:0.0007721019210293889
Iteration: 2158, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4512518346309662, gen p mean: -0.09808482229709625, mean p set: 0.45182737708091736
loss_pred:0.01652885042130947, decouple_loss:0.0007955884211696684
The modified gen p mean: 0.45231571793556213, gen p mean: -0.10964302718639374, mean p set: 0.45289358496665955
loss_pred:0.01526063121855259, decouple_loss:0.0006233274471014738
The modified gen p mean: 0.45121273398399353, gen p mean: -0.098625048995018, mean p set: 0.45179006457328796
loss_pred:0.015887388959527016, decouple_loss:0.0005522475112229586
Iteration: 2159, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44991931319236755, gen p mean: -0.09815718978643417, mean p set: 0.4504954218864441
loss_pred:0.0160957220941782, decouple_loss:0.0006089493399485946
The modified gen p mean: 0.4529728591442108, gen p mean: -0.1055089458823204, mean p set: 0.45354846119880676
loss_pred:0.015418486669659615, decouple_loss:0.0007072942680679262
The modified gen p mean: 0.45184874534606934, gen p mean: -0.11012022197246552, mean p set: 0.4524238109588623
loss_pred:0.015636306256055832, decouple_loss:0.0005313500878401101
Iteration: 2160, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45058098435401917, gen p mean: -0.10032525658607483, mean p set: 0.4511570930480957
loss_pred:0.01660507172346115, decouple_loss:0.0005945331649854779
The modified gen p mean: 0.45021623373031616, gen p mean: -0.10664071887731552, mean p set: 0.4507933557033539
loss_pred:0.01573955826461315, decouple_loss:0.0005486179143190384
The modified gen p mean: 0.4525086283683777, gen p mean: -0.09940187633037567, mean p set: 0.4530864953994751
loss_pred:0.015855155885219574, decouple_loss:0.0005527680041268468
2023-05-02 00:00:59 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11400265246629715, mean p set: 0.4502691626548767
loss_pred:0.017423244193196297, decouple_loss:0.0006607980467379093
The modified gen p mean: 0.44978100061416626, gen p mean: -0.10723942518234253, mean p set: 0.45035696029663086
loss_pred:0.016893506050109863, decouple_loss:0.0006125402287580073
The modified gen p mean: 0.4495350122451782, gen p mean: -0.1075153797864914, mean p set: 0.4500633478164673
loss_pred:0.016656454652547836, decouple_loss:0.0006611574208363891
WV_1_PC_1_EH_0_PS_40, loss: 0.01702331006526947, avg_mse: 0.02637328766286373
current test mse: 0.026373
Iteration: 2161, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523238241672516, gen p mean: -0.10306406766176224, mean p set: 0.45289894938468933
loss_pred:0.01563042774796486, decouple_loss:0.000718470721039921
The modified gen p mean: 0.45038244128227234, gen p mean: -0.09947846829891205, mean p set: 0.4509580433368683The modified gen p mean: 0.45044589042663574, gen p mean: -0.10531171411275864, mean p set: 0.4510243833065033
loss_pred:0.015708278864622116, decouple_loss:0.000602398591581732
loss_pred:0.016186287626624107, decouple_loss:0.0008056964143179357
Iteration: 2162, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4508732557296753, gen p mean: -0.09788160026073456, mean p set: 0.451449453830719The modified gen p mean: 0.4511454701423645, gen p mean: -0.10282491892576218, mean p set: 0.451722115278244
loss_pred:0.01590803638100624, decouple_loss:0.0008164868922904134
loss_pred:0.01616057939827442, decouple_loss:0.0010416497243568301
The modified gen p mean: 0.4495369791984558, gen p mean: -0.10559169203042984, mean p set: 0.45011407136917114
loss_pred:0.016383271664381027, decouple_loss:0.0007127547869458795
Iteration: 2163, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450592577457428, gen p mean: -0.10348661243915558, mean p set: 0.45116883516311646
loss_pred:0.016277184709906578, decouple_loss:0.0006923320470377803
The modified gen p mean: 0.45010942220687866, gen p mean: -0.0989309772849083, mean p set: 0.4506874978542328
loss_pred:0.016399113461375237, decouple_loss:0.0006565373623743653
The modified gen p mean: 0.45161306858062744, gen p mean: -0.0947704166173935, mean p set: 0.45218998193740845
loss_pred:0.01618213579058647, decouple_loss:0.0007642749114893377
Iteration: 2164, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005103945732117, gen p mean: -0.10139090567827225, mean p set: 0.45062902569770813
loss_pred:0.015837058424949646, decouple_loss:0.0006233384483493865
The modified gen p mean: 0.450177937746048, gen p mean: -0.09867304563522339, mean p set: 0.4507540166378021
loss_pred:0.015840984880924225, decouple_loss:0.0005607565399259329
The modified gen p mean: 0.45099160075187683, gen p mean: -0.10299576073884964, mean p set: 0.45156532526016235
loss_pred:0.01487782597541809, decouple_loss:0.0006111086113378406
Iteration: 2165, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45005249977111816, gen p mean: -0.0983467772603035, mean p set: 0.45062994956970215
loss_pred:0.01644430309534073, decouple_loss:0.0007193474448285997
The modified gen p mean: 0.45166438817977905, gen p mean: -0.0945904478430748, mean p set: 0.4522396922111511
loss_pred:0.015560436993837357, decouple_loss:0.0006431977380998433
The modified gen p mean: 0.4509683847427368, gen p mean: -0.09857242554426193, mean p set: 0.45154494047164917
loss_pred:0.014833292923867702, decouple_loss:0.0006278727087192237
Iteration: 2166, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4520050883293152, gen p mean: -0.10301327705383301, mean p set: 0.4525797963142395
loss_pred:0.01534006092697382, decouple_loss:0.0005720026674680412
The modified gen p mean: 0.4493713676929474, gen p mean: -0.09907649457454681, mean p set: 0.4499463438987732
The modified gen p mean: 0.4502357542514801, gen p mean: -0.0980018600821495, mean p set: 0.4508115351200104
loss_pred:0.016374176368117332, decouple_loss:0.0005529117188416421
loss_pred:0.015444716438651085, decouple_loss:0.0005833276081830263
Iteration: 2167, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45229339599609375, gen p mean: -0.10155440866947174, mean p set: 0.45286911725997925
loss_pred:0.015479670837521553, decouple_loss:0.0007560333469882607
The modified gen p mean: 0.44993919134140015, gen p mean: -0.09659085422754288, mean p set: 0.4505161941051483
loss_pred:0.015665899962186813, decouple_loss:0.0006269394070841372
The modified gen p mean: 0.4503990709781647, gen p mean: -0.09495614469051361, mean p set: 0.4509766697883606
loss_pred:0.01581738516688347, decouple_loss:0.0006190104759298265
Iteration: 2168, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.451606422662735, gen p mean: -0.10115893185138702, mean p set: 0.45218396186828613
loss_pred:0.01670929417014122, decouple_loss:0.0008794051827862859
The modified gen p mean: 0.4529034197330475, gen p mean: -0.10480272769927979, mean p set: 0.453481525182724
The modified gen p mean: 0.4514411985874176, gen p mean: -0.09738799184560776, mean p set: 0.45201605558395386
loss_pred:0.014976982027292252, decouple_loss:0.0008110855706036091
loss_pred:0.016255274415016174, decouple_loss:0.0007040237542241812
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012009_3_24hr.npz
NaN value num: 0
Iteration: 2169, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45199501514434814, gen p mean: -0.10124897956848145, mean p set: 0.45257216691970825
loss_pred:0.014963294379413128, decouple_loss:0.0005819167708978057
The modified gen p mean: 0.4525865316390991, gen p mean: -0.10182622075080872, mean p set: 0.45316070318222046
loss_pred:0.015030535869300365, decouple_loss:0.0006690812297165394
The modified gen p mean: 0.44944635033607483, gen p mean: -0.1012839525938034, mean p set: 0.4500231444835663
loss_pred:0.0164235457777977, decouple_loss:0.0006111047114245594
Iteration: 2170, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4510810375213623, gen p mean: -0.10104656964540482, mean p set: 0.45165982842445374
loss_pred:0.015466231852769852, decouple_loss:0.0008757233154028654
The modified gen p mean: 0.45185425877571106, gen p mean: -0.09780626744031906, mean p set: 0.4524320662021637
loss_pred:0.015189261175692081, decouple_loss:0.0005514814401976764
The modified gen p mean: 0.4538494646549225, gen p mean: -0.10455357283353806, mean p set: 0.4544260501861572
loss_pred:0.015234358608722687, decouple_loss:0.0005944165168330073
2023-05-02 00:03:39 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.11757340282201767, mean p set: 0.4502691626548767
loss_pred:0.017290158197283745, decouple_loss:0.0006431527435779572
The modified gen p mean: 0.44953423738479614, gen p mean: -0.11075915396213531, mean p set: 0.4500633478164673
loss_pred:0.016586801037192345, decouple_loss:0.0006113098352216184
The modified gen p mean: 0.4497813880443573, gen p mean: -0.11072170734405518, mean p set: 0.45035696029663086
loss_pred:0.016902944073081017, decouple_loss:0.0006531045655719936
WV_1_PC_1_EH_0_PS_40, loss: 0.01695842854678631, avg_mse: 0.02626633085310459
current test mse: 0.026266
Iteration: 2171, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45195257663726807, gen p mean: -0.09749680757522583, mean p set: 0.45252999663352966
loss_pred:0.015074756927788258, decouple_loss:0.0005828369176015258
The modified gen p mean: 0.45107904076576233, gen p mean: -0.10622593015432358, mean p set: 0.4516550898551941The modified gen p mean: 0.44993144273757935, gen p mean: -0.10383839160203934, mean p set: 0.4505091905593872
loss_pred:0.01526093389838934, decouple_loss:0.000749173981603235
loss_pred:0.016501611098647118, decouple_loss:0.0006557833403348923
Iteration: 2172, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4525975286960602, gen p mean: -0.10965995490550995, mean p set: 0.45317476987838745
loss_pred:0.01506198849529028, decouple_loss:0.0006089250673539937
The modified gen p mean: 0.45165544748306274, gen p mean: -0.09955432265996933, mean p set: 0.4522334337234497The modified gen p mean: 0.4518897533416748, gen p mean: -0.10539334267377853, mean p set: 0.45246621966362
loss_pred:0.015502462163567543, decouple_loss:0.0009600301273167133loss_pred:0.015420904383063316, decouple_loss:0.0006811039056628942
Iteration: 2173, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4514348804950714, gen p mean: -0.10855656117200851, mean p set: 0.4520109295845032
loss_pred:0.015195379965007305, decouple_loss:0.0008683819323778152
The modified gen p mean: 0.45498013496398926, gen p mean: -0.10641230642795563, mean p set: 0.4555578827857971
loss_pred:0.015391377732157707, decouple_loss:0.0009529662202112377
The modified gen p mean: 0.44916582107543945, gen p mean: -0.1059914380311966, mean p set: 0.44974127411842346
loss_pred:0.015866195783019066, decouple_loss:0.0005779793136753142
Iteration: 2174, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45063847303390503, gen p mean: -0.10211019963026047, mean p set: 0.4512145519256592
loss_pred:0.015595436096191406, decouple_loss:0.0005692195845767856
The modified gen p mean: 0.4490164518356323, gen p mean: -0.10370693355798721, mean p set: 0.44959282875061035
loss_pred:0.015839826315641403, decouple_loss:0.000576225807890296
The modified gen p mean: 0.44940313696861267, gen p mean: -0.10207157582044601, mean p set: 0.44997847080230713
loss_pred:0.015562235377728939, decouple_loss:0.0005608118954114616
Iteration: 2175, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4523698687553406, gen p mean: -0.10074150562286377, mean p set: 0.45294511318206787
loss_pred:0.015033655799925327, decouple_loss:0.0008263206691481173
The modified gen p mean: 0.4510427415370941, gen p mean: -0.10752793401479721, mean p set: 0.4516180753707886
loss_pred:0.015107942745089531, decouple_loss:0.0005602682358585298
The modified gen p mean: 0.4499082565307617, gen p mean: -0.09849824011325836, mean p set: 0.4504847228527069
loss_pred:0.01675964705646038, decouple_loss:0.0005337484180927277
Iteration: 2176, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.450775682926178, gen p mean: -0.10232163965702057, mean p set: 0.4513528347015381
loss_pred:0.015970848500728607, decouple_loss:0.0006824919255450368
The modified gen p mean: 0.45159363746643066, gen p mean: -0.10580341517925262, mean p set: 0.4521713852882385
The modified gen p mean: 0.45266368985176086, gen p mean: -0.10444868355989456, mean p set: 0.45324212312698364
loss_pred:0.014735979028046131, decouple_loss:0.0006030924851074815
loss_pred:0.014645535498857498, decouple_loss:0.0005551407230086625
Iteration: 2177, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45121505856513977, gen p mean: -0.09900299459695816, mean p set: 0.4517918825149536
loss_pred:0.014936551451683044, decouple_loss:0.0006456851260736585
The modified gen p mean: 0.45316606760025024, gen p mean: -0.10614480078220367, mean p set: 0.45374393463134766
The modified gen p mean: 0.45157793164253235, gen p mean: -0.10291352868080139, mean p set: 0.4521520435810089
loss_pred:0.014691321179270744, decouple_loss:0.0005879716482013464
loss_pred:0.015366846695542336, decouple_loss:0.0007892323774285614
Iteration: 2178, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.44955137372016907, gen p mean: -0.1016310602426529, mean p set: 0.4501282274723053
loss_pred:0.015795445069670677, decouple_loss:0.000667672255076468
The modified gen p mean: 0.45253580808639526, gen p mean: -0.10747392475605011, mean p set: 0.45311427116394043
The modified gen p mean: 0.45113858580589294, gen p mean: -0.1051347404718399, mean p set: 0.4517159163951874
loss_pred:0.015019121579825878, decouple_loss:0.0006138105527497828
loss_pred:0.015807928517460823, decouple_loss:0.0006012558005750179
Iteration: 2179, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4527030885219574, gen p mean: -0.10565812140703201, mean p set: 0.45328083634376526
loss_pred:0.015546352602541447, decouple_loss:0.0006398611003533006
The modified gen p mean: 0.45087724924087524, gen p mean: -0.10603049397468567, mean p set: 0.4514535665512085
loss_pred:0.01563451625406742, decouple_loss:0.0006725277635268867
The modified gen p mean: 0.4521567225456238, gen p mean: -0.10968193411827087, mean p set: 0.4527343511581421
loss_pred:0.015580561012029648, decouple_loss:0.0006032417295500636
Iteration: 2180, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524941146373749, gen p mean: -0.09996774792671204, mean p set: 0.4530712962150574
loss_pred:0.014667365700006485, decouple_loss:0.0008290307596325874
The modified gen p mean: 0.45197170972824097, gen p mean: -0.09949859231710434, mean p set: 0.45254871249198914
loss_pred:0.016039591282606125, decouple_loss:0.0008550466736778617
The modified gen p mean: 0.4500637948513031, gen p mean: -0.10040115565061569, mean p set: 0.4506414532661438
loss_pred:0.01568806916475296, decouple_loss:0.0008509276085533202
2023-05-02 00:05:45 testing...
The modified gen p mean: 0.4497888386249542, gen p mean: -0.1149294376373291, mean p set: 0.4502691626548767
loss_pred:0.017267100512981415, decouple_loss:0.0008353809243999422
The modified gen p mean: 0.44953569769859314, gen p mean: -0.10866561532020569, mean p set: 0.4500633478164673
loss_pred:0.01671680621802807, decouple_loss:0.0006669615395367146
The modified gen p mean: 0.4497806131839752, gen p mean: -0.10857933759689331, mean p set: 0.45035696029663086
loss_pred:0.016995083540678024, decouple_loss:0.0007445489172823727
WV_1_PC_1_EH_0_PS_40, loss: 0.017030445858836174, avg_mse: 0.026364067569375038
current test mse: 0.026364
Iteration: 2181, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4507195055484772, gen p mean: -0.11113414913415909, mean p set: 0.4512959122657776
loss_pred:0.01483098603785038, decouple_loss:0.0009618831099942327
The modified gen p mean: 0.4510464072227478, gen p mean: -0.101883165538311, mean p set: 0.4516242742538452The modified gen p mean: 0.4523739218711853, gen p mean: -0.10616272687911987, mean p set: 0.45295095443725586
loss_pred:0.015634046867489815, decouple_loss:0.0005390457808971405
loss_pred:0.01501884963363409, decouple_loss:0.0005983589799143374
Iteration: 2182, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45318010449409485, gen p mean: -0.10415704548358917, mean p set: 0.45375576615333557
loss_pred:0.014614678919315338, decouple_loss:0.0007097705965861678
The modified gen p mean: 0.4527553915977478, gen p mean: -0.09853086620569229, mean p set: 0.4533340632915497The modified gen p mean: 0.45108452439308167, gen p mean: -0.10026122629642487, mean p set: 0.45166051387786865
loss_pred:0.015316389501094818, decouple_loss:0.0005690635298378766
loss_pred:0.014913879334926605, decouple_loss:0.0006175613962113857
Iteration: 2183, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4511944353580475, gen p mean: -0.107444629073143, mean p set: 0.45177099108695984
loss_pred:0.015492425300180912, decouple_loss:0.0007018524338491261
The modified gen p mean: 0.4520305395126343, gen p mean: -0.11403578519821167, mean p set: 0.45260855555534363
loss_pred:0.014582873322069645, decouple_loss:0.0004946882836520672
The modified gen p mean: 0.45022568106651306, gen p mean: -0.10707880556583405, mean p set: 0.45080041885375977
loss_pred:0.015629390254616737, decouple_loss:0.0007656423258595169
Iteration: 2184, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45080330967903137, gen p mean: -0.09802743047475815, mean p set: 0.4513835310935974
loss_pred:0.01578015647828579, decouple_loss:0.0009300061501562595
The modified gen p mean: 0.44966310262680054, gen p mean: -0.0946841835975647, mean p set: 0.45023927092552185
loss_pred:0.01659730076789856, decouple_loss:0.0006030673976056278
The modified gen p mean: 0.4522280693054199, gen p mean: -0.10093151777982712, mean p set: 0.45280560851097107
loss_pred:0.014699878171086311, decouple_loss:0.0006514736451208591
Iteration: 2185, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4503295123577118, gen p mean: -0.10023833811283112, mean p set: 0.4509062170982361
loss_pred:0.01615738682448864, decouple_loss:0.0007671496132388711
The modified gen p mean: 0.45349615812301636, gen p mean: -0.10286654531955719, mean p set: 0.4540724456310272
loss_pred:0.015262233093380928, decouple_loss:0.000707645493093878
The modified gen p mean: 0.45132866501808167, gen p mean: -0.0939033254981041, mean p set: 0.4519054889678955
loss_pred:0.014939766377210617, decouple_loss:0.0008438208024017513
Iteration: 2186, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.4524531364440918, gen p mean: -0.09369475394487381, mean p set: 0.4530309736728668
loss_pred:0.01519801001995802, decouple_loss:0.0007833869894966483
The modified gen p mean: 0.4509134590625763, gen p mean: -0.0908641591668129, mean p set: 0.45148876309394836
loss_pred:0.01557714119553566, decouple_loss:0.0004909032140858471
The modified gen p mean: 0.45158639550209045, gen p mean: -0.08724813908338547, mean p set: 0.4521639347076416
loss_pred:0.015244239009916782, decouple_loss:0.0006061683525331318
Iteration: 2187, ims.shape: (3, 48, 3, 720, 1440)
The modified gen p mean: 0.45251938700675964, gen p mean: -0.09741274267435074, mean p set: 0.4530937969684601
loss_pred:0.01534321904182434, decouple_loss:0.0005472938064485788
The modified gen p mean: 0.4505085349082947, gen p mean: -0.1071576327085495, mean p set: 0.45108485221862793
The modified gen p mean: 0.4519575536251068, gen p mean: -0.09867901355028152, mean p set: 0.4525352716445923
loss_pred:0.015079226344823837, decouple_loss:0.0006646048277616501
loss_pred:0.015531826764345169, decouple_loss:0.0007313961395993829
/scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
mnist train iterator, Loading data from /scratch/09012/haoli1/ERA5/dataset/era5_train_01012004_3_24hr.npz
Traceback (most recent call last):
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 349, in <module>
    train_wrapper(model)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/run1.py", line 259, in train_wrapper
    train_input_handle = datasets_factory.data_provider(
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/datasets_factory.py", line 48, in data_provider
    train_input_handle = datasets_map[dataset_name].InputHandle(train_input_param)
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 26, in __init__
    self.load()
  File "/work/09012/haoli1/ls6/ERA5_PredRNN/predrnn-pytorch/core/data_provider/mnist_new.py", line 31, in load
    self.data['clips'] = dat_1['clips']
  File "/work/09012/haoli1/ls6/Pyt/lib/python3.9/site-packages/numpy/lib/npyio.py", line 260, in __getitem__
    raise KeyError("%s is not a file in the archive" % key)
KeyError: 'clips is not a file in the archive'